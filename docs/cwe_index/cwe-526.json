[{"project":"ericcornelissen/shescape","dataset":"final","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_generators_fixed.js"}]},{"project":"ericcornelissen/shescape","dataset":"noise","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_noise_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/ericcornelissen_shescape/_generators_fixed.js"}]},{"project":"ericcornelissen/shescape","dataset":"noise_obfuscated","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/ericcornelissen_shescape/_generators_fixed.js"}]},{"project":"ericcornelissen/shescape","dataset":"obfuscated","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/ericcornelissen_shescape/_generators_fixed.js"}]},{"project":"ericcornelissen/shescape","dataset":"original","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_final_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/ericcornelissen_shescape/_generators_fixed.js"}]},{"project":"ericcornelissen/shescape","dataset":"prompt_injection","project_type":"Frontend","cve_ids":"CVE-2021-21384; CVE-2022-24725; CVE-2022-31179; CVE-2022-31180; CVE-2022-25918; CVE-2023-35931; CVE-2023-40185; CVE-2025-30222","commit_shas":"07a069a66423809cbedd61d980c11ca44a29ea2b; 66dcdcdd8e00839cd62050c9a70de7825f8adba1; 58fd30b43c05a42cbf8ccf7fd8732d058f02c6e1; 703f1301caa588bb111247473273d73ec9442bbd; c88bff521f4bbc4dd41919b870baccf73d470e1f; 552e8eab56861720b1d4e5474fb65741643358f9; 39a0176ce5afc13fcbf7c09ade2266bcfe44b3f7; d0fce70f987ac0d8331f93cb45d47e79436173ac; 099a92cc4b41f8c549fcf7b9d3ca9c28a72f4f59; 0b976dab645abf45ffd85e74a8c6e51ee2f42d63; 0a81f1eb077bab8caae283a2490cd7be9af179c6","publish_date":"2025-03-25","severity":"MEDIUM:32; LOW:6; CRITICAL:4; UNKNOWN:3; HIGH:2","summary":"shescape is a simple shell escape package for JavaScript. In shescape before version 1.1.3, anyone using _Shescape_ to defend against shell injection may still be vulnerable against shell injection if the attacker manages to insert a into the payload. For an example see the referenced GitHub Security Advisory. The problem has been patched in version 1.1.3. No further changes are required. || Shescape is a shell escape package for JavaScript. An issue in versions 1.4.0 to 1.5.1 allows for exposure of the home directory on Unix systems when using Bash with the `escape` or `escapeAll` functions from the _shescape_ API with the `interpolation` option set to `true`. Other tested shells, Dash and Zsh, are not affected. Depending on how the output of _shescape_ is used, directory traversal may be possible in the application using _shescape_. The issue was patched in version 1.5.1. As a workaround, manually escape all instances of the tilde character (`~`) using `arg.replace(/~/g, \"\\\\~\")`. || Shescape is a simple shell escape package for JavaScript. Versions prior to 1.5.8 were found to be subject to code injection on windows. This impacts users that use Shescape (any API function) to escape arguments for cmd.exe on Windows An attacker can omit all arguments following their input by including a line feed character (`'\\n'`) in the payload. This bug has been patched in [v1.5.8] which you can upgrade to now. No further changes are required. Alternatively, line feed characters (`'\\n'`) can be stripped out manually or the user input can be made the last argument (this only limits the impact). || Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions. || The package shescape from 1.5.10 and before 1.6.1 are vulnerable to Regular Expression Denial of Service (ReDoS) via the escape function in index.js, due to the usage of insecure regex in the escapeArgBash function. || Shescape is a simple shell escape library for JavaScript. An attacker may be able to get read-only access to environment variables. This bug has been patched in version 1.7.1.\n\n\n || shescape is simple shell escape library for JavaScript. This may impact users that use Shescape on Windows in a threaded context. The vulnerability can result in Shescape escaping (or quoting) for the wrong shell, thus allowing attackers to bypass protections depending on the combination of expected and used shell. This bug has been patched in version 1.7.4. || Shescape is a simple shell escape library for JavaScript. Versions 1.7.2 through 2.1.1 are vulnerable to potential environment variable exposure on Windows with CMD. This impact users of Shescape on Windows that explicitly configure `shell: 'cmd.exe'` or `shell: true` using any of `quote`/`quoteAll`/`escape`/`escapeAll`. An attacker may be able to get read-only access to environment variables. This bug has been patched in v2.1.2. For those who are already using v2 of Shescape, no further changes are required. Those who are are using v1 of Shescape should follow the migration guide to upgrade to v2. There is no plan to release a patch compatible with v1 of Shescape. As a workaround, users can remove all instances of `%` from user input before using Shescape.","files":[{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/unix_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/unix_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/win_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/win_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/unix.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/unix.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/win.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/win.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_macros_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_macros_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_5_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/escape.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/escape.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_6_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_common_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_common_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_7_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/cmd_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/cmd_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_8_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/testing_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/testing_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_9_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/exec-file.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/exec-file.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_10_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/exec.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/exec.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_11_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/spawn.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/spawn.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_12_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_13_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/executables_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/executables_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_14_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/options_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/options_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_15_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_constants_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_constants_fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_16_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/__vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/__fixed.js"},{"vulnerable_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/ericcornelissen-shescape/sample_17_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_generators_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/ericcornelissen_shescape/_generators_fixed.js"}]}]