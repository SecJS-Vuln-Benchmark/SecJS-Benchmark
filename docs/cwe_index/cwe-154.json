[{"project":"electron-userland/electron-builder","dataset":"final","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]},{"project":"electron-userland/electron-builder","dataset":"noise","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]},{"project":"electron-userland/electron-builder","dataset":"noise_obfuscated","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]},{"project":"electron-userland/electron-builder","dataset":"obfuscated","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]},{"project":"electron-userland/electron-builder","dataset":"original","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]},{"project":"electron-userland/electron-builder","dataset":"prompt_injection","project_type":"Frontend","cve_ids":"CVE-2024-39698","commit_shas":"ac2e6a25aa491c1ef5167a552c19fc2085cd427f; 106f800454d46db0670a175c79846f903bb1bc14","publish_date":"2024-07-09","severity":"HIGH:2","summary":"electron-updater allows for automatic updates for Electron apps. The file `packages/electron-updater/src/windowsExecutableCodeSignatureVerifier.ts` implements the signature validation routine for Electron applications on Windows. Because of the surrounding shell, a first pass by `cmd.exe` expands any environment variable found in command-line above. This creates a situation where `verifySignature()` can be tricked into validating the certificate of a different file than the one that was just downloaded. If the step is successful, the malicious update will be executed even if its signature is invalid. This attack assumes a compromised update manifest (server compromise, Man-in-the-Middle attack if fetched over HTTP, Cross-Site Scripting to point the application to a malicious updater server, etc.). The patch is available starting from 6.3.0-alpha.6.","files":[{"vulnerable_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/electron-userland-electron-builder/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/electron-userland_electron-builder/windowsExecutableCodeSignatureVerifier_fixed.js"}]}]