[{"project":"backstage/backstage","dataset":"final","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/readFrontendConfig_fixed.js"}]},{"project":"backstage/backstage","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_noise_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/backstage_backstage/readFrontendConfig_fixed.js"}]},{"project":"backstage/backstage","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/backstage_backstage/readFrontendConfig_fixed.js"}]},{"project":"backstage/backstage","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/backstage_backstage/readFrontendConfig_fixed.js"}]},{"project":"backstage/backstage","dataset":"original","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_final_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/backstage_backstage/readFrontendConfig_fixed.js"}]},{"project":"backstage/backstage","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2021-32662; CVE-2021-41151; CVE-2021-43783; CVE-2023-25571; CVE-2023-35926; CVE-2024-26150; CVE-2024-47762","commit_shas":"8cefadca04cbf01d0394b0cb1983247e5f1d6208; 6968962c920508eae19a4c1c200fa2c8980a4006; f9352ab606367cd9efc6ff048915c70ed3013b7f; 3d1371954512f7fa8bd0e2d357e00eada2c3e8a8; fb7375507d56faedcb7bb3665480070593c8949a; edf65d7d31e027599c2415f597d085ee84807871; 1ad2b1b61ebb430051f7d804b0cc7ebfe7922b6f; 78f892b3a84d63de2ba167928f171154c447b717; 323e6129073c5cb4cc106a1239eaec31a129554f","publish_date":"2024-10-03","severity":"MEDIUM:25; HIGH:12","summary":"Backstage is an open platform for building developer portals, and techdocs-common contains common functionalities for Backstage's TechDocs. In `@backstage/techdocs-common` versions prior to 0.6.3, a malicious actor could read sensitive files from the environment where TechDocs documentation is built and published by setting a particular path for `docs_dir` in `mkdocs.yml`. These files would then be available over the TechDocs backend API. This vulnerability is mitigated by the fact that an attacker would need access to modify the `mkdocs.yml` in the documentation source code, and would also need access to the TechDocs backend API. The vulnerability is patched in the `0.6.3` release of `@backstage/techdocs-common`. || Backstage is an open platform for building developer portals. In affected versions A malicious actor could read sensitive files from the environment where Scaffolder Tasks are run. The attack is executed by crafting a custom Scaffolder template with a `github:publish:pull-request` action and a particular source path. When the template is executed the sensitive files would be included in the published pull request. This vulnerability is mitigated by the fact that an attacker would need access to create and register templates in the Backstage catalog, and that the attack is very visible given that the exfiltration happens via a pull request. The vulnerability is patched in the `0.15.9` release of `@backstage/plugin-scaffolder-backend`. || @backstage/plugin-scaffolder-backend is the backend for the default Backstage software templates. In affected versions a malicious actor with write access to a registered scaffolder template is able to manipulate the template in a way that writes files to arbitrary paths on the scaffolder-backend host instance. This vulnerability can in some situation also be exploited through user input when executing a template, meaning you do not need write access to the templates. This method will not allow the attacker to control the contents of the injected file however, unless the template is also crafted in a specific way that gives control of the file contents. This vulnerability is fixed in version `0.15.14` of the `@backstage/plugin-scaffolder-backend`. This attack is mitigated by restricting access and requiring reviews when registering or modifying scaffolder templates. || Backstage is an open platform for building developer portals. `@backstage/catalog-model` prior to version 1.2.0, `@backstage/core-components` prior to 0.12.4, and `@backstage/plugin-catalog-backend` prior to 1.7.2 are affected by a cross-site scripting vulnerability. This vulnerability allows a malicious actor with access to add or modify content in an instance of the Backstage software catalog to inject script URLs in the entities stored in the catalog. If users of the catalog then click on said URLs, that can lead to an XSS attack.\n\nThis vulnerability has been patched in both the frontend and backend implementations. The default `Link` component from `@backstage/core-components` version 1.2.0 and greater will now reject `javascript:` URLs, and there is a global override of `window.open` to do the same. In addition, the catalog model v0.12.4 and greater as well as the catalog backend v1.7.2 and greater now has additional validation built in that prevents `javascript:` URLs in known annotations. As a workaround, the general practice of limiting access to modifying catalog content and requiring code reviews greatly help mitigate this vulnerability. || Backstage is an open platform for building developer portals. The Backstage scaffolder-backend plugin uses a templating library that requires sandbox, as it by design allows for code injection. The library used for this sandbox so far has been `vm2`, but in light of several past vulnerabilities and existing vulnerabilities  that may not have a fix, the plugin has switched to using a different sandbox library. A malicious actor with write access to a registered scaffolder template could manipulate the template in a way that allows for remote code execution on the scaffolder-backend instance. This was only exploitable in the template YAML definition itself and not by user input data. This is vulnerability is fixed in version 1.15.0 of `@backstage/plugin-scaffolder-backend`. || `@backstage/backend-common` is a common functionality library for backends for Backstage, an open platform for building developer portals. In `@backstage/backend-common` prior to versions 0.21.1, 0.20.2, and 0.19.10, paths checks with the `resolveSafeChildPath` utility were not exhaustive enough, leading to risk of path traversal vulnerabilities if symlinks can be injected by attackers. This issue is patched in `@backstage/backend-common` versions 0.21.1, 0.20.2, and 0.19.10. || Backstage is an open framework for building developer portals. Configuration supplied through APP_CONFIG_* environment variables, for example APP_CONFIG_backend_listen_port=7007, where unexpectedly ignoring the visibility defined in configuration schema. This occurred even if the configuration schema specified that they should have backend or secret visibility. This was an intended feature of the APP_CONFIG_* way of supplying configuration, but now clearly goes against the expected behavior of the configuration system. This behavior leads to a risk of potentially exposing sensitive configuration details intended to remain private or restricted to backend processes. The issue has been resolved in version 0.3.75 of the @backstage/plugin-app-backend package. As a temporary measure, avoid supplying secrets using the APP_CONFIG_ configuration pattern. Consider alternative methods for setting secrets, such as the environment substitution available for Backstage configuration.","files":[{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/helpers.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/helpers.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/helpers_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/helpers_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/techdocs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/techdocs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/.eslintrc_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/.eslintrc_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_5_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_5_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/write_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/write_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_6_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_6_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/log_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/log_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_7_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_7_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/template_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/template_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_8_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_8_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/githubPullRequest_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/githubPullRequest_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_9_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_9_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Link.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Link.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_10_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_10_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Link_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Link_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_11_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_11_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/integration.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/integration.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_12_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_12_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Stitcher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/Stitcher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_13_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_13_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/SecureTemplater_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/SecureTemplater_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_14_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_14_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/paths.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/paths.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_15_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_15_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/paths_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/paths_fixed.js"},{"vulnerable_path":"docs/cwe_samples/backstage-backstage/sample_16_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/backstage-backstage/sample_16_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/readFrontendConfig_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/backstage_backstage/readFrontendConfig_fixed.js"}]}]