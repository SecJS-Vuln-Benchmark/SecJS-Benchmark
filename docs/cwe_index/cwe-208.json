[{"project":"TryQuiet/quiet","dataset":"final","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"final","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"final","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"final","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"final","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/package_fixed.js"}]},{"project":"TryQuiet/quiet","dataset":"noise","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/isaacs_csrf-lite/package_fixed.js"}]},{"project":"TryQuiet/quiet","dataset":"noise_obfuscated","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/isaacs_csrf-lite/package_fixed.js"}]},{"project":"TryQuiet/quiet","dataset":"obfuscated","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/isaacs_csrf-lite/package_fixed.js"}]},{"project":"TryQuiet/quiet","dataset":"original","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"original","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"original","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"original","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"original","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/isaacs_csrf-lite/package_fixed.js"}]},{"project":"TryQuiet/quiet","dataset":"prompt_injection","project_type":"Frontend","cve_ids":"CVE-2025-53940","commit_shas":"451cd96784ddb5bd7b2cf288739b9608dac96864","publish_date":"2025-07-24","severity":"UNKNOWN:1","summary":"Quiet is an alternative to team chat apps like Slack, Discord, and Element that does not require trusting a central server or running one's own. In versions 6.1.0-alpha.4 and below, Quiet's API for backend/frontend communication was using an insecure, not constant-time comparison function for token verification. This allowed for a potential timing attack where an attacker would try different token values and observe tiny differences in the response time (wrong characters fail faster) to guess the whole token one character at a time. This is fixed in version 6.0.1.","files":[{"vulnerable_path":"docs/cwe_samples/tryquiet-quiet/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/tryquiet-quiet/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/TryQuiet_quiet/startConnection.saga_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/TryQuiet_quiet/startConnection.saga_fixed.js"}]},{"project":"expressjs/basic-auth-connect","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2024-47178","commit_shas":"bac1e6a8530e1efd0028800b9b588a37adb0d203","publish_date":"2024-09-30","severity":"MEDIUM:3","summary":"basic-auth-connect is Connect's Basic Auth middleware in its own module. basic-auth-connect < 1.1.0 uses a timing-unsafe equality comparison that can leak timing information. This issue has been fixed in basic-auth-connect 1.1.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_basic-auth-connect/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_basic-auth-connect/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/expressjs-basic-auth-connect/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_basic-auth-connect/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_basic-auth-connect/package_fixed.js"}]},{"project":"fastify/fastify-bearer-auth","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2022-31142","commit_shas":"39353b15409ee99474545f615ffb16180cf3b716; f921a0582dc83112039004a9b5041141b50c5b3f; 0c468a616d7e56126dc468150f6a5a92e530b8e4","publish_date":"2022-07-14","severity":"HIGH:18","summary":"@fastify/bearer-auth is a Fastify plugin to require bearer Authorization headers. @fastify/bearer-auth prior to versions 7.0.2 and 8.0.1 does not securely use crypto.timingSafeEqual. A malicious attacker could estimate the length of one valid bearer token. According to the corresponding RFC 6750, the bearer token has only base64 valid characters, reducing the range of characters for a brute force attack. Version 7.0.2 and 8.0.1 of @fastify/bearer-auth contain a patch. There are currently no known workarounds. The package fastify-bearer-auth, which covers versions 6.0.3 and prior, is also vulnerable starting at version 5.0.1. Users of fastify-bearer-auth should upgrade to a patched version of @fastify/bearer-auth.","files":[{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/plugin_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/plugin_fixed.js"},{"vulnerable_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/fastify-fastify-bearer-auth/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/decorate.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/fastify_fastify-bearer-auth/decorate.test_fixed.js"}]},{"project":"goauthentik/authentik","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2023-36456; CVE-2023-46249; CVE-2023-48228; CVE-2024-42490; CVE-2024-47070; CVE-2024-52289; CVE-2024-52307; CVE-2025-52553; CVE-2025-53942","commit_shas":"15026748d19d490eb2baf9a9566ead4f805f7dff; c07a48a3eccbd7b23026f72136d3392bbc6f795a; ea75741ec22ecef34bc7073f1163e17a8a2bf9fc; 261879022d25016d58867cf1f24e90b81ad618d0; cdb36b420a8520cad2377733e070a8756290758f; 3af77ab3821fe9c7df8055ba5eade3d1ecea03a6; 8fe02b2aafb54aae12fb135d65eceeebc4dfc8e9; b88e39411c12e3f9e04125a7887f12354f760a14; 6b9afed21f7c39f171a4a445654cfe415bba37d5; 7a2110e455a00a66eac860df2a37151952ea8fe2; 359b343f51524342a5ca03828e7c975a1d654b11; 19318d4c00bb02c4ec3c4f8f15ac2e1dbe8d846c; dd8f809161e738b25765797eb2a5c77a7d3fc2cf; 78f7b04d5a62b2a9d4316282a713c2c7857dbe29; 85bb638243c8d7ea42ddd3b15b3f51a90d2b8c54; 5ea4580884f99369f0ccfe484c04cb03a66e65b8; 0e07414e9739b318cff9401a413a5fe849545325; 7100d3c6741853f1cfe3ea2073ba01823ab55caa; 65373ab21711d58147b5cb9276c5b5876baaa5eb; c3629d12bfe3d32d3dc8f85c0ee1f087a55dde8f; 7a4c6b9b50f8b837133a7a1fd2cb9b7f18a145cd; ce3f9e3763c1778bf3a16b98c95d10f4091436ab","publish_date":"2025-07-23","severity":"HIGH:10; UNKNOWN:10; CRITICAL:4","summary":"authentik is an open-source Identity Provider. Prior to versions 2023.4.3 and 2023.5.5, authentik does not verify the source of the X-Forwarded-For and X-Real-IP headers, both in the Python code and the go code. Only authentik setups that are directly accessible by users without a reverse proxy are susceptible to this. Possible spoofing of IP addresses in logs, downstream applications proxied by (built in) outpost, IP bypassing in custom flows if used.\n\nThis poses a possible security risk when someone has flows or policies that check the user's IP address, e.g. when they want to ignore the user's 2 factor authentication when the user is connected to the company network. A second security risk is that the IP addresses in the logfiles and user sessions are not reliable anymore. Anybody can spoof this address and one cannot verify that the user has logged in from the IP address that is in their account's log. A third risk is that this header is passed on to the proxied application behind an outpost. The application may do any kind of verification, logging, blocking or rate limiting based on the IP address, and this IP address can be overridden by anybody that want to.\n\nVersions 2023.4.3 and 2023.5.5 contain a patch for this issue.\n || authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin. || authentik is an open-source identity provider. When initialising a oauth2 flow with a `code_challenge` and `code_method` (thus requesting PKCE), the single sign-on provider (authentik) must check if there is a matching and existing `code_verifier` during the token step. Prior to versions 2023.10.4 and 2023.8.5, authentik checks if the contents of `code_verifier` is matching only when it is provided. When it is left out completely, authentik simply accepts the token request with out it; even when the flow was started with a `code_challenge`. authentik 2023.8.5 and 2023.10.4 fix this issue. || authentik is an open-source Identity Provider. Several API endpoints can be accessed by users without correct authentication/authorization. The main API endpoints affected by this are /api/v3/crypto/certificatekeypairs/<uuid>/view_certificate/, /api/v3/crypto/certificatekeypairs/<uuid>/view_private_key/, and /api/v3/.../used_by/. Note that all of the affected API endpoints require the knowledge of the ID of an object, which especially for certificates is not accessible to an unprivileged user. Additionally the IDs for most objects are UUIDv4, meaning they are not easily guessable/enumerable. authentik 2024.4.4, 2024.6.4 and 2024.8.0 fix this issue. || authentik is an open-source identity provider. A vulnerability that exists in versions prior to 2024.8.3 and 2024.6.5 allows bypassing password login by adding X-Forwarded-For header with an unparsable IP address, e.g. `a`. This results in a possibility of logging into any account with a known login or email address. The vulnerability requires the authentik instance to trust X-Forwarded-For header provided by the attacker, thus it is not reproducible from external hosts on a properly configured environment.  The issue occurs due to the password stage having a policy bound to it, which skips the password stage if the Identification stage is setup to also contain a password stage. Due to the invalid X-Forwarded-For header, which does not get validated to be an IP Address early enough, the exception happens later and the policy fails. The default blueprint doesn't correctly set `failure_result` to `True` on the policy binding meaning that due to this exception the policy returns false and the password stage is skipped. Versions 2024.8.3 and 2024.6.5 fix this issue. || authentik is an open-source identity provider. Redirect URIs in the OAuth2 provider in authentik are checked by RegEx comparison.\nWhen no Redirect URIs are configured in a provider, authentik will automatically use the first redirect_uri value received as an allowed redirect URI, without escaping characters that have a special meaning in RegEx. Similarly, the documentation did not take this into consideration either. Given a provider with the Redirect URIs set to https://foo.example.com, an attacker can register a domain fooaexample.com, and it will correctly pass validation. authentik 2024.8.5 and 2024.10.3 fix this issue. As a workaround, When configuring OAuth2 providers, make sure to escape any wildcard characters that are not intended to function as a wildcard, for example replace `.` with `\\.`. || authentik is an open-source identity provider. Due to the usage of a non-constant time comparison for the /-/metrics/ endpoint it was possible to brute-force the SECRET_KEY, which is used to authenticate the endpoint. The /-/metrics/ endpoint returns Prometheus metrics and is not intended to be accessed directly, as the Go proxy running in the authentik server container fetches data from this endpoint and serves it on a separate port (9300 by default), which can be scraped by Prometheus without being exposed publicly. authentik 2024.8.5 and 2024.10.3 fix this issue. Since the /-/metrics/ endpoint is not intended to be accessed publicly, requests to the endpoint can be blocked by the reverse proxy/load balancer used in conjunction with authentik. || authentik is an open-source identity provider. After authorizing access to a RAC endpoint, authentik creates a token which is used for a single connection and is sent to the client in the URL. This token is intended to only be valid for the session of the user who authorized the connection, however this check is missing in versions prior to 2025.6.3 and 2025.4.3. When, for example, using RAC during a screenshare, a malicious user could access the same session by copying the URL from the shown browser. authentik 2025.4.3 and 2025.6.3 fix this issue. As a workaround, it is recommended to decrease the duration a token is valid for (in the RAC Provider settings, set Connection expiry to `minutes=5` for example). The maintainers of authentik also recommend enabling the option Delete authorization on disconnect. || authentik is an open-source Identity Provider that emphasizes flexibility and versatility, with support for a wide set of protocols. In versions 2025.4.4 and earlier, as well as versions 2025.6.0-rc1 through 2025.6.3, deactivated users who registered through OAuth/SAML or linked their accounts to OAuth/SAML providers can still retain partial access to the system despite their accounts being deactivated. They end up in a half-authenticated state where they cannot access the API but crucially they can authorize applications if they know the URL of the application. To workaround this issue, developers can add an expression policy to the user login stage on the respective authentication flow with the expression of return request.context[\"pending_user\"].is_active. This modification ensures that the return statement only activates the user login stage when the user is active. This issue is fixed in versions authentik 2025.4.4 and 2025.6.4.","files":[{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/sidebars_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/sidebars_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/OAuth2ProviderForm_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/OAuth2ProviderForm_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/HorizontalFormElement_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/HorizontalFormElement_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/docs_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/docs_fixed.js"},{"vulnerable_path":"docs/cwe_samples/goauthentik-authentik/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/goauthentik-authentik/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/sidebar_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/goauthentik_authentik/sidebar_fixed.js"}]},{"project":"isaacs/csrf-lite","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2016-10535","commit_shas":"e6dadd0c7764f1ee580d3a6d8776575087a68795","publish_date":"2018-05-31","severity":"MEDIUM:2","summary":"csrf-lite is a cross-site request forgery protection library for framework-less node sites. csrf-lite uses `===`, a fail first string comparison, instead of a time constant string comparison This enables an attacker to guess the secret in no more than (16*18)288 guesses, instead of the 16^18 guesses required were the timing attack not present.","files":[{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/isaacs_csrf-lite/csrf_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/isaacs_csrf-lite/csrf_fixed.js"},{"vulnerable_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/isaacs-csrf-lite/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/isaacs_csrf-lite/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/isaacs_csrf-lite/package_fixed.js"}]}]