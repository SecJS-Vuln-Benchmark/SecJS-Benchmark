[{"project":"denoland/deno","dataset":"final","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\r\r || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/sqlite_test_fixed.js"}]},{"project":"denoland/deno","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\n\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_noise_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/denoland_deno/sqlite_test_fixed.js"}]},{"project":"denoland/deno","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\n\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/denoland_deno/sqlite_test_fixed.js"}]},{"project":"denoland/deno","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\n\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/denoland_deno/sqlite_test_fixed.js"}]},{"project":"denoland/deno","dataset":"original","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\n\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/denoland_deno/sqlite_test_fixed.js"}]},{"project":"denoland/deno","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2023-26103; CVE-2024-27933; CVE-2024-27935; CVE-2025-24015; CVE-2025-48935","commit_shas":"cf06a7c7e672880e1b38598fe445e2c50b4a9d06; f0b072cf0c45ec07a58d42308a2acdf0b5cf5823; 5a91a065b882215dde209baf626247e54c21a392; 55fac9f5ead6d30996400e8597c969b675c5a22b; c37b9655b6a6ccff1cedc6e43d245fd55415d76f; 3e9fb8aafd9834ebacd27734cea4310caaf794c6; a4003a5292bd0affefad3ecb24a8732886900f67; 4f27d7cdc02e3edfb9d36275341fb8185d6e99ed; 0d1beed; 31a97803995bd94629528ba841b2418d3ca01860","publish_date":"2025-06-04","severity":"HIGH:17; MEDIUM:9; CRITICAL:1","summary":"Versions of the package deno before 1.31.0 are vulnerable to Regular Expression Denial of Service (ReDoS) due to the upgradeWebSocket function, which contains regexes in the form of /s*,s*/, used for splitting the Connection/Upgrade header. A specially crafted Connection/Upgrade header can be used to significantly slow down a web socket server.\n\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. In version 1.39.0, use of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors, allowing standard input to be re-opened as a different resource resulting in permission prompt bypass. Node child_process IPC relies on the JS side to pass the raw IPC file descriptor to `op_node_ipc_pipe()`, which returns a `IpcJsonStreamResource` ID associated with the file descriptor. On closing the resource, the raw file descriptor is closed together.\n\nUse of raw file descriptors in `op_node_ipc_pipe()` leads to premature close of arbitrary file descriptors. This allow standard input (fd 0) to be closed and re-opened for a different resource, which allows a silent permission prompt bypass. This is exploitable by an attacker controlling the code executed inside a Deno runtime to obtain arbitrary code execution on the host machine regardless of permissions.\n\nThis bug is known to be exploitable. There is a working exploit that achieves arbitrary code execution by bypassing prompts from zero permissions, additionally abusing the fact that Cache API lacks filesystem permission checks. The attack can be conducted silently as stderr can also be closed, suppressing all prompt outputs.\n\nVersion 1.39.1 fixes the bug.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 1.35.1 and prior to version 1.36.3, a vulnerability in Deno's Node.js compatibility runtime allows for cross-session data contamination during simultaneous asynchronous reads from Node.js streams sourced from sockets or files. The issue arises from the re-use of a global buffer (BUF) in stream_wrap.ts used as a performance optimization to limit allocations during these asynchronous read operations. This can lead to data intended for one session being received by another session, potentially resulting in data corruption and unexpected behavior. This affects all users of Deno that use the node.js compatibility layer for network communication or other streams, including packages that may require node.js libraries indirectly. Version 1.36.3 contains a patch for this issue.\n || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Versions 1.46.0 through 2.1.6 have an issue that affects AES-256-GCM and AES-128-GCM in Deno in which the authentication tag is not being validated. This means tampered ciphertexts or incorrect keys might not be detected, which breaks the guarantees expected from AES-GCM. Older versions of Deno correctly threw errors in such cases, as does Node.js. Without authentication tag verification, AES-GCM degrades to essentially CTR mode, removing integrity protection. Authenticated data set with set_aad is also affected, as it is incorporated into the GCM hash (ghash) but this too is not validated, rendering AAD checks ineffective. Version 2.1.7 includes a patch that addresses this issue. || Deno is a JavaScript, TypeScript, and WebAssembly runtime. Starting in version 2.2.0 and prior to versions 2.2.5, it is possible to bypass Deno's permission read/write db permission check by using `ATTACH DATABASE` statement. Version 2.2.5 contains a patch for the issue.","files":[{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/01_http_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/01_http_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/02_init_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/02_init_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/child_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/child_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/40_process_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/40_process_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_5_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_5_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/99_main_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/99_main_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_6_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_6_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/net_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/net_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_7_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_7_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/stream_wrap_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/stream_wrap_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_8_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_8_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/cipher_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/cipher_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_9_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_9_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/crypto_cipher_gcm_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/crypto_cipher_gcm_test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/denoland-deno/sample_10_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/denoland-deno/sample_10_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/sqlite_test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/denoland_deno/sqlite_test_fixed.js"}]}]