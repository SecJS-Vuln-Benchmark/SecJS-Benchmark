[{"project":"expressjs/express","dataset":"final","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"final","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/back.test_fixed.js"}]},{"project":"expressjs/express","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_noise_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/koajs_koa/back.test_fixed.js"}]},{"project":"expressjs/express","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/koajs_koa/back.test_fixed.js"}]},{"project":"expressjs/express","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/koajs_koa/back.test_fixed.js"}]},{"project":"expressjs/express","dataset":"original","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"original","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/koajs_koa/back.test_fixed.js"}]},{"project":"expressjs/express","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2024-43796","commit_shas":"0867302ddbde0e9463d0564fea5861feb708c2dd; 0b746953c4bd8e377123527db11f9cd866e39f94; 1f3832b32aa338a623f5c9cdb3a4efe8e53f9bcf; 54271f69b511fea198471e6ff3400ab805d6b553","publish_date":"2024-09-10","severity":"MEDIUM:16","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Express.js minimalist web framework for node. In express < 4.20.0, passing untrusted user input - even after sanitizing it - to response.redirect() may execute untrusted code. This issue is patched in express 4.20.0.","files":[{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/res.location_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/res.location_fixed.js"},{"vulnerable_path":"docs/cwe_samples/expressjs-express/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/expressjs-express/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/res.redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/expressjs_express/res.redirect_fixed.js"}]},{"project":"koajs/koa","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2024-29041; CVE-2025-25200; CVE-2025-32379; CVE-2025-8129","commit_shas":"926243bd3683ca1daf592665b7a3512bc148d3e3; 5054af6e31ffd451a4151a1fe144cef6e5d0d83c; 5f294bb1c7c8d9c61904378d250439a321bffd32; 93fe903fc966635a991bcf890cfc3427d33a1a08; ff25eb4a7f2392df46481fe86355161067687312; 422c551c63d00f24e2bbbdf492f262a5935bb1f0","publish_date":"2025-07-25","severity":"UNKNOWN:15; MEDIUM:7; LOW:3","summary":"Express.js minimalist web framework for node. Versions of Express.js prior to 4.19.0 and all pre-release alpha and beta versions of 5.0 are affected by an open redirect vulnerability using malformed URLs. When a user of Express performs a redirect using a user-provided URL Express performs an encode [using `encodeurl`](https://github.com/pillarjs/encodeurl) on the contents before passing it to the `location` header. This can cause malformed URLs to be evaluated in unexpected ways by common redirect allow list implementations in Express applications, leading to an Open Redirect via bypass of a properly implemented allow list. The main method impacted is `res.location()` but this is also called from within `res.redirect()`. The vulnerability is fixed in 4.19.2 and 5.0.0-beta.3. || Koa is expressive middleware for Node.js using ES2017 async functions. Prior to versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3, Koa uses an evil regex to parse the `X-Forwarded-Proto` and `X-Forwarded-Host` HTTP headers. This can be exploited to carry out a Denial-of-Service attack. Versions 0.21.2, 1.7.1, 2.15.4, and 3.0.0-alpha.3 fix the issue. || Koa is expressive middleware for Node.js using ES2017 async functions. In koa < 2.16.1 and < 3.0.0-alpha.5, passing untrusted user input to ctx.redirect() even after sanitizing it, may execute javascript code on the user who use the app. This issue is patched in 2.16.1 and 3.0.0-alpha.5. || A vulnerability, which was classified as problematic, was found in KoaJS Koa up to 3.0.0. Affected is the function back in the library lib/response.js of the component HTTP Header Handler. The manipulation of the argument Referrer leads to open redirect. It is possible to launch the attack remotely. The exploit has been disclosed to the public and may be used.","files":[{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/redirect_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/redirect_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/response_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/response_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/request_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/request_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/application_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/application_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_5_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_5_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/redirect.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/redirect.test_fixed.js"},{"vulnerable_path":"docs/cwe_samples/koajs-koa/sample_6_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/koajs-koa/sample_6_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/back.test_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/koajs_koa/back.test_fixed.js"}]}]