[{"project":"hedgedoc/hedgedoc","dataset":"final","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/htmlExport_fixed.js"}]},{"project":"hedgedoc/hedgedoc","dataset":"noise","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_noise_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_noise_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise/hedgedoc_hedgedoc/htmlExport_fixed.js"}]},{"project":"hedgedoc/hedgedoc","dataset":"noise_obfuscated","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_noise_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_noise_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/noise_obfuscated/hedgedoc_hedgedoc/htmlExport_fixed.js"}]},{"project":"hedgedoc/hedgedoc","dataset":"obfuscated","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_obfuscated_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_obfuscated_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/obfuscated/hedgedoc_hedgedoc/htmlExport_fixed.js"}]},{"project":"hedgedoc/hedgedoc","dataset":"original","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_final_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_final_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/code_files/hedgedoc_hedgedoc/htmlExport_fixed.js"}]},{"project":"hedgedoc/hedgedoc","dataset":"prompt_injection","project_type":"Backend","cve_ids":"CVE-2020-26286; CVE-2020-26287; CVE-2021-21259; CVE-2021-29475; CVE-2021-29503; CVE-2021-39175; CVE-2022-24837; CVE-2023-38487; CVE-2024-45308; CVE-2025-32391","commit_shas":"e9306991cdb5ff2752c1eeba3fedba42aec3c2d8; 58276ebbf4504a682454a3686dcaff88bc1069d4; 35b0d39a12aa35f27fba8c1f50b1886706e7efef; c1789474020a6d668d616464cb2da5e90e123f65; 01dad5821ee28377ebe640c6c72c3e0bb0d51ea7; f86fae3bd768db252887337f3ea89a920caeeee3; e6d167c63cdcd345eb00e1dccfbfad44d81c4965; 9e2f9e21e904c4a319e84265da7ef03b0a8e343a; 781263ab84255885e1fe60c7e92e2f8d611664d2; 380587b7fd65bc1eb71eef51a3aab324f9877650; 3f520ea59abf912c66d7443cb99f29a567c47748; d2585fbd3b398b3359f6f88aa1fda8f4ecf2f78d; 0636b5c20b7097afccfa6641830352ad068ef964","publish_date":"2025-04-10","severity":"MEDIUM:16; HIGH:12; CRITICAL:2","summary":"HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an unauthenticated attacker can upload arbitrary files to the upload storage backend including HTML, JS and PHP files. The problem is patched in HedgeDoc 1.7.1. You should however verify that your uploaded file storage only contains files that are allowed, as uploaded files might still be served. As workaround it's possible to block the `/uploadimage` endpoint on your instance using your reverse proxy. And/or restrict MIME-types and file names served from your upload file storage. || HedgeDoc is a collaborative platform for writing and sharing markdown. In HedgeDoc before version 1.7.1 an attacker can inject arbitrary `script` tags in HedgeDoc notes using mermaid diagrams. Our content security policy prevents loading scripts from most locations, but `www.google-analytics.com` is allowed. Using Google Tag Manger it is possible to inject arbitrary JavaScript and execute it on page load. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.1. As a workaround one can disallow `www.google-analytics.com` in the `Content-Security-Policy` header. Note that other ways to leverage the `script` tag injection might exist. || HedgeDoc is open source software which lets you create real-time collaborative markdown notes. In HedgeDoc before version 1.7.2, an attacker can inject arbitrary JavaScript into a HedgeDoc note, which is executed when the note is viewed in slide mode. Depending on the configuration of the instance, the attacker may not need authentication to create or edit notes. The problem is patched in HedgeDoc 1.7.2. As a workaround, disallow loading JavaScript from 3rd party sites using the `Content-Security-Policy` header. Note that this will break some embedded content. || HedgeDoc (formerly known as CodiMD) is an open-source collaborative markdown editor. An attacker is able to receive arbitrary files from the file system when exporting a note to PDF. Since the code injection has to take place as note content, there fore this exploit requires the attackers ability to modify a note. This will affect all instances, which have pdf export enabled. This issue has been fixed by https://github.com/hedgedoc/hedgedoc/commit/c1789474020a6d668d616464cb2da5e90e123f65 and is available in version 1.5.0. Starting the CodiMD/HedgeDoc instance with `CMD_ALLOW_PDF_EXPORT=false` or set `\"allowPDFExport\": false` in config.json can mitigate this issue for those who cannot upgrade. This exploit works because while PhantomJS doesn't actually render the `file:///` references to the PDF file itself, it still uses them internally, and exfiltration is possible, and easy through JavaScript rendering. The impact is pretty bad, as the attacker is able to read the CodiMD/HedgeDoc `config.json` file as well any other files on the filesystem. Even though the suggested Docker deploy option doesn't have many interesting files itself, the `config.json` still often contains sensitive information, database credentials, and maybe OAuth secrets among other things. || HedgeDoc is a platform to write and share markdown. HedgeDoc before version 1.8.2 is vulnerable to a cross-site scripting attack using the YAML-metadata of a note. An attacker with write access to a note can embed HTML tags in the Open Graph metadata section of the note, resulting in the frontend rendering the script tag as part of the `<head>` section. Unless your instance prevents guests from editing notes, this vulnerability allows unauthenticated attackers to inject JavaScript into notes that allow guest edits. If your instance prevents guests from editing notes, this vulnerability allows authenticated attackers to inject JavaScript into any note pages they have write-access to. This vulnerability is patched in version 1.8.2. As a workaround, one can disable guest edits until the next update. || HedgeDoc is a platform to write and share markdown. In versions prior to 1.9.0, an unauthenticated attacker can inject arbitrary JavaScript into the speaker-notes of the slide-mode feature by embedding an iframe hosting the malicious code into the slides or by embedding the HedgeDoc instance into another page. The problem is patched in version 1.9.0. There are no known workarounds aside from upgrading. || HedgeDoc is an open-source, web-based, self-hosted, collaborative markdown editor. Images uploaded with HedgeDoc version 1.9.1 and later have an enumerable filename after the upload, resulting in potential information leakage of uploaded documents. This is especially relevant for private notes and affects all upload backends, except Lutim and imgur. This issue is patched in version 1.9.3 by replacing the filename generation with UUIDv4. If you cannot upgrade to HedgeDoc 1.9.3, it is possible to block POST requests to `/uploadimage`, which will disable future uploads. || HedgeDoc is software for creating real-time collaborative markdown notes. Prior to version 1.9.9, the API of HedgeDoc 1 can be used to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one.\n\nWhen the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note by making a POST request to the `/new/<ALIAS>` API endpoint. The `<ALIAS>` parameter can be set to the ID of an existing note. HedgeDoc did not verify whether the provided `<ALIAS>` value corresponds to a valid ID of an existing note and always allowed creation of the new note. When a visitor tried to access the existing note, HedgeDoc will first search for a note with a matching alias before it searches using the ID, therefore only the new note can be accessed.\n\nDepending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database.\n\nThis issue was fixed in version 1.9.9. As a workaround, disabling freeURL mode prevents the exploitation of this issue. The impact can be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. When using HedgeDoc 1 with MySQL or MariaDB, it is possible to create notes with an alias matching the ID of existing notes. The affected existing note can then not be accessed anymore and is effectively hidden by the new one. When the freeURL feature is enabled (by setting the `allowFreeURL` config option or the `CMD_ALLOW_FREEURL` environment variable to `true`), any user with the appropriate permissions can create a note with an arbitrary alias, e.g. by accessing it in the browser. When MySQL or MariaDB are used, it is possible to create a new note with an alias that matches the lower-cased ID of a different note. HedgeDoc then always presents the new note to users, as these databases perform case-insensitive matching and the lower-cased alias is found first. This issue only affects HedgeDoc instances that use MySQL or MariaDB. Depending on the permission settings of the HedgeDoc instance, the issue can be exploited only by logged-in users or by all (including non-logged-in) users. The exploit requires knowledge of the ID of the target note. Attackers could use this issue to present a manipulated copy of the original note to the user, e.g. by replacing the links with malicious ones. Attackers can also use this issue to prevent access to the original note, causing a denial of service. No data is lost, as the original content of the affected notes is still present in the database. Users are advised to upgrade to version 1.10.0 which addresses this issue. Users unable to upgrade may disable freeURL mode which prevents the exploitation of this issue. The impact can also be limited by restricting freeURL note creation to trusted, logged-in users by enabling `requireFreeURLAuthentication`/`CMD_REQUIRE_FREEURL_AUTHENTICATION`. || HedgeDoc is an open source, real-time, collaborative, markdown notes application. Prior to 1.10.3, a malicious SVG file uploaded to HedgeDoc results in the possibility of XSS when opened in a new tab instead of the editor itself. The XSS is possible by exploiting the JSONP capabilities of GitHub Gist embeddings. Only instances with the local filesystem upload backend or special configurations, where the uploads are served from the same domain as HedgeDoc, are vulnerable. This vulnerability is fixed in 1.10.3. When upgrading to HedgeDoc 1.10.3 is not possible, instance owners could add the following headers for all routes under /uploads as a first-countermeasure: Content-Disposition: attachment and Content-Security-Policy: default-src 'none'. Additionally, the external URLs in the script-src attribute of the Content-Security-Policy header should be removed.","files":[{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_0_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/filesystem_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/filesystem_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_1_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/index_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/index_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_2_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/package_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/package_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_3_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/extra_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/extra_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_4_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/slide_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/slide_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_5_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/user_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/user_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_6_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/head_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/head_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_7_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/webpack.dev_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/webpack.dev_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_8_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/csp_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/csp_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_9_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/util_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/util_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_10_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/note_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/note_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_11_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/utils_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/utils_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_12_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/app_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/app_fixed.js"},{"vulnerable_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_prompt_injection_vuln.js","fixed_path":"docs/cwe_samples/hedgedoc-hedgedoc/sample_13_prompt_injection_fixed.js","original_vulnerable":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/htmlExport_vulnerable.js","original_fixed":"/data_hdd/lx20/fqy_workspace/js_vuln_benchmark/dataset/databackup/augmented_code_files/prompt_injection/hedgedoc_hedgedoc/htmlExport_fixed.js"}]}]