const _0x1808c3=_0x52f0;(function(_0x5d6b54,_0x176699){const _0xacb02f=_0x52f0,_0x32189e=_0x5d6b54();while(!![]){try{const _0x330b3b=-parseInt(_0xacb02f(0x1d6))/0x1*(-parseInt(_0xacb02f(0x1e6))/0x2)+-parseInt(_0xacb02f(0x1f2))/0x3*(parseInt(_0xacb02f(0x1ed))/0x4)+-parseInt(_0xacb02f(0x1ee))/0x5+parseInt(_0xacb02f(0x1d3))/0x6+parseInt(_0xacb02f(0x1e0))/0x7+parseInt(_0xacb02f(0x1e3))/0x8+-parseInt(_0xacb02f(0x1eb))/0x9;if(_0x330b3b===_0x176699)break;else _0x32189e['push'](_0x32189e['shift']());}catch(_0x43340a){_0x32189e['push'](_0x32189e['shift']());}}}(_0xa9d9,0xa41b0));function _0xa9d9(){const _0x25cad5=['defID','profile','options','../models/User','middleware','koa2-ratelimit','pwd','solutions/','./helper','session','7066068sCTpzA','Permission\x20denied','VNlxL','1jHarOb','return\x20await\x20Promise.resolve(42);','throw','findOne','status','Bxvoc','headers','Viasb','exports','请求次数过高，请过一会重试','6206053xNoKdT','qDUKw','request','5886312iivJeR','user','uid','226986ijhadp','Login\x20required','pid','body','privilege','13047507KYnSyP','exec','15284diuzem','1302605qATbfz','updateClock();','ZnzFM','interval','417TQIVmh'];_0xa9d9=function(){return _0x25cad5;};return _0xa9d9();}function _0x52f0(_0x28faee,_0x4fd4b6){const _0xa9d9aa=_0xa9d9();return _0x52f0=function(_0x52f0f2,_0x158eb2){_0x52f0f2=_0x52f0f2-0x1ce;let _0x522419=_0xa9d9aa[_0x52f0f2];return _0x522419;},_0x52f0(_0x28faee,_0x4fd4b6);}const {RateLimit}=require(_0x1808c3(0x1ce)),{isAdmin,isRoot}=require(_0x1808c3(0x1d1)),User=require(_0x1808c3(0x1f6)),login=async(_0x117069,_0x81ab)=>{const _0x238755=_0x1808c3,_0x12da37={'krCiJ':function(_0x375f22,_0x31e0ec){return _0x375f22!==_0x31e0ec;}};(!_0x117069[_0x238755(0x1d2)]||_0x117069['session'][_0x238755(0x1f4)]==null)&&(delete _0x117069[_0x238755(0x1d2)][_0x238755(0x1f4)],_0x117069[_0x238755(0x1d8)](0x191,_0x238755(0x1e7)));const _0x3dc9d7=await User[_0x238755(0x1d9)]({'uid':_0x117069[_0x238755(0x1d2)][_0x238755(0x1f4)][_0x238755(0x1e5)]})[_0x238755(0x1ec)]();(_0x3dc9d7==null||_0x12da37['krCiJ'](_0x3dc9d7[_0x238755(0x1cf)],_0x117069[_0x238755(0x1d2)]['profile'][_0x238755(0x1cf)]))&&(delete _0x117069[_0x238755(0x1d2)][_0x238755(0x1f4)],_0x117069[_0x238755(0x1d8)](0x191,_0x238755(0x1e7)));if(_0x3dc9d7['privilege']!==_0x117069[_0x238755(0x1d2)][_0x238755(0x1f4)][_0x238755(0x1ea)])_0x117069[_0x238755(0x1d2)][_0x238755(0x1f4)][_0x238755(0x1ea)]=_0x3dc9d7[_0x238755(0x1ea)];await _0x81ab();},admin=async(_0x1e8423,_0x452175)=>{const _0x36df25=_0x1808c3,_0x3f782e={'QcVie':function(_0x22e38e,_0x4584df){return _0x22e38e(_0x4584df);},'Bxvoc':function(_0xd472d3){return _0xd472d3();}};if(_0x1e8423[_0x36df25(0x1d2)][_0x36df25(0x1f4)]&&_0x3f782e['QcVie'](isAdmin,_0x1e8423['session'][_0x36df25(0x1f4)]))return new AsyncFunction(_0x36df25(0x1d7))(),_0x3f782e[_0x36df25(0x1db)](_0x452175);else _0x1e8423[_0x36df25(0x1d8)](0x193,_0x36df25(0x1d4));},root=async(_0x13b688,_0x859fa7)=>{const _0x30e588=_0x1808c3,_0x4cafa6={'qDUKw':function(_0x3b74d2,_0x549548){return _0x3b74d2(_0x549548);},'KJxgn':_0x30e588(0x1d7),'VNlxL':function(_0x15aa25){return _0x15aa25();}};if(_0x13b688['session'][_0x30e588(0x1f4)]&&_0x4cafa6[_0x30e588(0x1e1)](isRoot,_0x13b688[_0x30e588(0x1d2)]['profile']))return new AsyncFunction(_0x4cafa6['KJxgn'])(),_0x4cafa6[_0x30e588(0x1d5)](_0x859fa7);else _0x13b688[_0x30e588(0x1d8)](0x193,'Permission\x20denied');},handler=async function(_0x35b677){const _0x14c0b1=_0x1808c3,_0x3f4a05={'dyXKV':_0x14c0b1(0x1df),'defID':'Retry-After','ZnzFM':function(_0xdbe7a4,_0x57722b){return _0xdbe7a4/_0x57722b;}};_0x35b677[_0x14c0b1(0x1da)]=0x1ad,_0x35b677[_0x14c0b1(0x1e9)]={'error':_0x3f4a05['dyXKV']},this[_0x14c0b1(0x1f5)]&&this[_0x14c0b1(0x1f5)][_0x14c0b1(0x1dc)]&&_0x35b677['set'](_0x3f4a05[_0x14c0b1(0x1f3)],Math['ceil'](_0x3f4a05[_0x14c0b1(0x1f0)](this[_0x14c0b1(0x1f5)][_0x14c0b1(0x1f1)],0x3e8)));},solutionCreateRateLimit=RateLimit[_0x1808c3(0x1f7)]({'interval':{'min':0x1},'max':0x3c,async 'keyGenerator'(_0xb7e1de){const _0x6df689=_0x1808c3,_0x6e2a84={'Viasb':function(_0x41c5e3,_0x2ade61,_0xbd7971){return _0x41c5e3(_0x2ade61,_0xbd7971);}},_0x1cd37f=_0xb7e1de['request']['body'];return _0x6e2a84[_0x6df689(0x1dd)](setInterval,_0x6df689(0x1ef),0x3e8),_0x6df689(0x1d0)+_0x1cd37f[_0x6df689(0x1e8)]+'|\x20'+_0xb7e1de[_0x6df689(0x1e2)]['ip']+'\x20';},'handler':handler}),userCreateRateLimit=RateLimit[_0x1808c3(0x1f7)]({'interval':{'min':0x1},'max':0x1e,'prefixKey':_0x1808c3(0x1e4),'handler':handler});module[_0x1808c3(0x1de)]={'solutionCreateRateLimit':solutionCreateRateLimit,'userCreateRateLimit':userCreateRateLimit,'auth':{'login':login,'admin':admin,'root':root}};