'use strict';const _0x2701cf=_0x4b25;(function(_0x386277,_0x446aaf){const _0x5a5b1c=_0x4b25,_0xe1613a=_0x386277();while(!![]){try{const _0x5e2106=parseInt(_0x5a5b1c(0x127))/0x1+-parseInt(_0x5a5b1c(0x168))/0x2*(parseInt(_0x5a5b1c(0x13d))/0x3)+parseInt(_0x5a5b1c(0x147))/0x4+-parseInt(_0x5a5b1c(0x153))/0x5*(-parseInt(_0x5a5b1c(0x157))/0x6)+-parseInt(_0x5a5b1c(0x16b))/0x7*(-parseInt(_0x5a5b1c(0x16e))/0x8)+-parseInt(_0x5a5b1c(0x141))/0x9*(parseInt(_0x5a5b1c(0x133))/0xa)+parseInt(_0x5a5b1c(0x137))/0xb*(-parseInt(_0x5a5b1c(0x151))/0xc);if(_0x5e2106===_0x446aaf)break;else _0xe1613a['push'](_0xe1613a['shift']());}catch(_0x4268b0){_0xe1613a['push'](_0xe1613a['shift']());}}}(_0x2fba,0x3d7e2));function _0x2fba(){const _0x58ab6b=['Service','removeUserProjectScope','Resource','push','cDBRk','wJJXR','yyPAB','RcTmy','isAdmin','fSMOC','username','loginUser','VqiEk','ZvoLb','354318vfQlaQ','RVbui','createPasswordHashSalt','duplicateUsernameCheck','eWQwu','yJrMi','RqjNW','epjaU','NVYFO','find','2|3|4|0|1','atUgL','20KmtBTO','scopes','KOXip','The\x20last\x20user\x20can\x27t\x20be\x20removed\x20from\x20a\x20project.\x20If\x20you\x20want\x20to\x20delete\x20the\x20project,\x20please\x20do\x20so\x20explicitly','618519Cjwlgl','uCJXO','$or','DIhPi','UnUgY','validateToken','6eeLvbX','password','ProjectService','mergeOne','1509471diGYgB','erasV','tokens','jOueB','cleanUpTokens','findUser','911944wwXlBn','wCdin','keys','oRHEg','addUserProjectScope','\x22\x20found','WTFZf','split','TWctj','removeToken','24ujqhbE','users','5lAVvWQ','rUggH','ahKPF','string','2489178zaRGau','getUserById','EdBYz','kSOBA','removeUser','crypto','uGpei','updateUserById','makeUserAdmin','logoutUser','YcHnT','Entity','toLowerCase','DatabaseService','getObject','findToken','kmQMH','326202BNwRuI','scopes.','email','40327WJexwI','fullName','updateUser','40SAuVHg','hBYig','findOne','AkajA','nDDsw','GqtNZ','revokeTokens','User','getAllUsers','length','YNsur','jhPxq'];_0x2fba=function(){return _0x58ab6b;};return _0x2fba();}const Crypto=require(_0x2701cf(0x15c));class UserService{static async[_0x2701cf(0x146)](_0x15c5ee){const _0x51d4df=_0x2701cf,_0x1741cd={'atUgL':_0x51d4df(0x152),'DIhPi':function(_0x1b141b,_0x3b257b){return _0x1b141b<_0x3b257b;},'AkajA':function(_0x6c3094,_0x1e9ab3){return _0x6c3094+_0x1e9ab3;},'yJrMi':'No\x20user\x20\x22','TWctj':_0x51d4df(0x14c)};let _0x4ca0c1=await HashBrown[_0x51d4df(0x119)][_0x51d4df(0x164)][_0x51d4df(0x170)](_0x1741cd[_0x51d4df(0x132)],_0x51d4df(0x152),{'username':_0x15c5ee});if(!_0x4ca0c1||_0x1741cd[_0x51d4df(0x13a)](Object[_0x51d4df(0x149)](_0x4ca0c1)[_0x51d4df(0x116)],0x1))throw new Error(_0x1741cd[_0x51d4df(0x171)](_0x1741cd[_0x51d4df(0x12c)]+_0x15c5ee,_0x1741cd[_0x51d4df(0x14f)]));return new HashBrown[(_0x51d4df(0x162))][(_0x51d4df(0x11b))][(_0x51d4df(0x114))](_0x4ca0c1);}static async[_0x2701cf(0x113)](_0x417bef){const _0x4da8ca=_0x2701cf,_0x314ccf={'NXHSe':function(_0x4ad85c,_0x3b288c){return _0x4ad85c(_0x3b288c);}};let _0x5da778=await _0x314ccf['NXHSe'](findUser,_0x417bef);_0x5da778[_0x4da8ca(0x143)]=[],await this[_0x4da8ca(0x16d)](_0x417bef,_0x5da778['getObject']());}static async[_0x2701cf(0x124)](_0x3cbff5,_0x5ef51b,_0x435856){const _0x400d89=_0x2701cf,_0x13d4b9={'wJJXR':'Invalid\x20password'};let _0xb5c543=await this[_0x400d89(0x146)](_0x3cbff5);if(!_0xb5c543['validatePassword'](_0x5ef51b))throw new Error(_0x13d4b9[_0x400d89(0x11e)]);let _0x16a378=_0xb5c543['generateToken'](_0x435856);return _0xb5c543[_0x400d89(0x145)](),await this[_0x400d89(0x16d)](_0x3cbff5,_0xb5c543[_0x400d89(0x165)]()),_0x16a378;}static async[_0x2701cf(0x160)](_0x24e551){const _0xbf123=_0x2701cf;let _0x534b6f=await this['findToken'](_0x24e551);_0x534b6f[_0xbf123(0x150)](_0x24e551),await this[_0xbf123(0x16d)](_0x534b6f[_0xbf123(0x123)],_0x534b6f[_0xbf123(0x165)]());}static async[_0x2701cf(0x166)](_0x5ecda9){const _0x3bb307=_0x2701cf,_0x4a90c7={'EdBYz':_0x3bb307(0x152)};let _0x34a227=await HashBrown['Service'][_0x3bb307(0x164)][_0x3bb307(0x130)](_0x4a90c7[_0x3bb307(0x159)],_0x3bb307(0x152),{});for(let _0x46df78 of _0x34a227){let _0x4b58cb=new HashBrown[(_0x3bb307(0x162))]['Resource'][(_0x3bb307(0x114))](_0x46df78),_0x2e6c29=_0x4b58cb[_0x3bb307(0x13c)](_0x5ecda9);if(_0x2e6c29)return _0x4b58cb;}return null;}static async[_0x2701cf(0x15b)](_0x4646b9){const _0xbcd719=_0x2701cf;await HashBrown[_0xbcd719(0x119)][_0xbcd719(0x164)]['removeOne'](_0xbcd719(0x152),_0xbcd719(0x152),{'id':_0x4646b9});}static async[_0x2701cf(0x11a)](_0xd6d6b0,_0x3c46eb){const _0x21a604=_0x2701cf,_0x5754d5={'uCJXO':_0x21a604(0x169),'VqiEk':function(_0x46ab72,_0x9f90dc){return _0x46ab72<_0x9f90dc;},'ZvoLb':_0x21a604(0x12e),'RVbui':_0x21a604(0x152)};let _0x19129f=await HashBrown[_0x21a604(0x119)][_0x21a604(0x13f)]['getProject'](_0x3c46eb);if(_0x5754d5[_0x21a604(0x125)](_0x19129f[_0x21a604(0x152)][_0x21a604(0x116)],0x2)){if(_0x5754d5[_0x21a604(0x126)]!==_0x5754d5[_0x21a604(0x126)]){let _0x48b3aa={};_0x48b3aa[_0x5754d5[_0x21a604(0x138)]+_0x35a3e5]={'$exists':!![]};let _0x324e9c={'isAdmin':!![]};_0x28a028[_0x21a604(0x139)]=[_0x48b3aa,_0x324e9c];}else throw new Error(_0x21a604(0x136));}let _0x4661e4=await HashBrown[_0x21a604(0x119)]['DatabaseService'][_0x21a604(0x170)](_0x5754d5[_0x21a604(0x128)],_0x5754d5[_0x21a604(0x128)],{'id':_0xd6d6b0});delete _0x4661e4[_0x21a604(0x134)][_0x3c46eb],await HashBrown[_0x21a604(0x119)][_0x21a604(0x164)]['updateOne'](_0x5754d5[_0x21a604(0x128)],_0x21a604(0x152),{'id':_0xd6d6b0},_0x4661e4);}static async[_0x2701cf(0x14b)](_0x37a901,_0x23b4ef,_0x50e549){const _0x2492d0=_0x2701cf,_0x4ea8fe={'erasV':_0x2492d0(0x152)};let _0x276e77=await HashBrown[_0x2492d0(0x119)][_0x2492d0(0x164)][_0x2492d0(0x170)](_0x2492d0(0x152),_0x4ea8fe[_0x2492d0(0x142)],{'id':_0x37a901});_0x276e77[_0x2492d0(0x134)]=_0x276e77[_0x2492d0(0x134)]||{},_0x276e77[_0x2492d0(0x134)][_0x23b4ef]=_0x50e549||[],await this[_0x2492d0(0x15e)](_0x37a901,_0x276e77);}static async[_0x2701cf(0x12a)](_0x3a2e54,_0x5b54c2){const _0x4e0d09=_0x2701cf,_0x64349e={'NVYFO':'users','kmQMH':function(_0x59481f,_0x2b7578){return _0x59481f!==_0x2b7578;},'DbsND':function(_0xaaf016,_0x4e9d7e){return _0xaaf016+_0x4e9d7e;}};checkParam(_0x3a2e54,'id',String,!![]),checkParam(_0x5b54c2,_0x4e0d09(0x123),String,!![]);let _0x3dbb17=await HashBrown[_0x4e0d09(0x119)][_0x4e0d09(0x164)][_0x4e0d09(0x170)](_0x64349e['NVYFO'],_0x64349e[_0x4e0d09(0x12f)],{'username':_0x5b54c2});if(_0x3dbb17&&_0x64349e[_0x4e0d09(0x167)](_0x3dbb17['id'],_0x3a2e54))throw new Error(_0x64349e['DbsND']('Username\x20\x22'+_0x5b54c2,'\x22\x20is\x20already\x20taken'));}static async['createUser'](_0xd9d38,_0xdf41bc,_0x414ee9=![],_0x27dd8c={}){const _0x569f58=_0x2701cf,_0x5504c1={'ahKPF':function(_0x25dc11,_0x559709,_0x1a5056,_0x47127c,_0x2c61a4){return _0x25dc11(_0x559709,_0x1a5056,_0x47127c,_0x2c61a4);},'UnUgY':_0x569f58(0x123),'RqjNW':function(_0x59318d,_0x3871b7,_0x1a2b19,_0xf60e0e,_0x4b9274){return _0x59318d(_0x3871b7,_0x1a2b19,_0xf60e0e,_0x4b9274);},'eWQwu':function(_0x28d479,_0x5b3935){return _0x28d479!==_0x5b3935;},'YcHnT':_0x569f58(0x15d),'yyPAB':_0x569f58(0x14a),'fSMOC':_0x569f58(0x152)};_0x5504c1[_0x569f58(0x155)](checkParam,_0xd9d38,_0x5504c1[_0x569f58(0x13b)],String,!![]),_0x5504c1[_0x569f58(0x12d)](checkParam,_0xdf41bc,_0x569f58(0x13e),String,!![]),delete _0x27dd8c[_0x5504c1[_0x569f58(0x13b)]],delete _0x27dd8c[_0x569f58(0x13e)];let _0x1f272e=HashBrown[_0x569f58(0x162)][_0x569f58(0x11b)][_0x569f58(0x114)]['create'](_0xd9d38,_0xdf41bc);for(let _0xbf709e in _0x27dd8c){if(_0x5504c1[_0x569f58(0x12b)](_0x5504c1[_0x569f58(0x161)],_0x5504c1[_0x569f58(0x11f)]))_0x1f272e[_0xbf709e]=_0x27dd8c[_0xbf709e];else return 0x1;}return _0x1f272e[_0x569f58(0x121)]=_0x414ee9,await this['duplicateUsernameCheck'](_0x1f272e['id'],_0xd9d38),await HashBrown[_0x569f58(0x119)]['DatabaseService']['insertOne'](_0x5504c1[_0x569f58(0x122)],'users',_0x1f272e['getObject']()),_0x1f272e;}static async[_0x2701cf(0x15f)](_0x59dbe1){const _0x3db321=_0x2701cf;let _0x207bb7=await this['getUser'](_0x59dbe1);_0x207bb7[_0x3db321(0x121)]=!![],await this[_0x3db321(0x16d)](_0x59dbe1,_0x207bb7);}static async[_0x2701cf(0x115)](_0x9d4f04){const _0xed9ede=_0x2701cf,_0x5d5e63={'wCdin':'6|5|0|1|3|2|4','YNsur':function(_0x186c69,_0x5f474f){return _0x186c69<_0x5f474f;},'jOueB':_0xed9ede(0x152)};let _0x2e3d6d={};if(_0x9d4f04){let _0x13732e={};_0x13732e[_0xed9ede(0x169)+_0x9d4f04]={'$exists':!![]};let _0x4abe68={'isAdmin':!![]};_0x2e3d6d[_0xed9ede(0x139)]=[_0x13732e,_0x4abe68];}let _0x307669=await HashBrown[_0xed9ede(0x119)][_0xed9ede(0x164)][_0xed9ede(0x130)](_0xed9ede(0x152),_0x5d5e63[_0xed9ede(0x144)],_0x2e3d6d,{'tokens':0x0,'password':0x0}),_0x321279=[];_0x307669=_0x307669['sort']((_0x2f1d41,_0x20995a)=>{const _0x264748=_0xed9ede,_0x2453c4=_0x5d5e63[_0x264748(0x148)][_0x264748(0x14e)]('|');let _0x2eef2f=0x0;while(!![]){switch(_0x2453c4[_0x2eef2f++]){case'0':_0x2f1d41=_0x2f1d41['toLowerCase']();continue;case'1':_0x20995a=_0x20995a[_0x264748(0x163)]();continue;case'2':if(_0x2f1d41>_0x20995a)return 0x1;continue;case'3':if(_0x5d5e63[_0x264748(0x117)](_0x2f1d41,_0x20995a))return-0x1;continue;case'4':return 0x0;case'5':_0x20995a=_0x20995a[_0x264748(0x16c)]||_0x20995a[_0x264748(0x123)]||_0x20995a[_0x264748(0x16a)]||'';continue;case'6':_0x2f1d41=_0x2f1d41[_0x264748(0x16c)]||_0x2f1d41[_0x264748(0x123)]||_0x2f1d41[_0x264748(0x16a)]||'';continue;}break;}});for(let _0x5193bf of _0x307669){_0x321279[_0xed9ede(0x11c)](new HashBrown[(_0xed9ede(0x162))][(_0xed9ede(0x11b))][(_0xed9ede(0x114))](_0x5193bf));}return _0x321279;}static async[_0x2701cf(0x158)](_0x3de3c7){const _0x3ab88b=_0x2701cf,_0x455fcd={'kSOBA':function(_0x1e1320,_0x3db6da,_0x1a1814,_0x10d2a2){return _0x1e1320(_0x3db6da,_0x1a1814,_0x10d2a2);},'KOXip':_0x3ab88b(0x152)};_0x455fcd[_0x3ab88b(0x15a)](checkParam,_0x3de3c7,'id',String);let _0x472e2e={},_0x1f60ba=await HashBrown[_0x3ab88b(0x119)][_0x3ab88b(0x164)][_0x3ab88b(0x170)](_0x455fcd[_0x3ab88b(0x135)],_0x3ab88b(0x152),{'id':_0x3de3c7},{'tokens':0x0,'password':0x0});if(!_0x1f60ba)return null;return new HashBrown[(_0x3ab88b(0x162))][(_0x3ab88b(0x11b))]['User'](_0x1f60ba);}static async['getUser'](_0x2f7f2f){const _0x3a1ddd=_0x2701cf,_0x6c0636={'cEVYs':'users'};let _0x54d1bb={};return await HashBrown['Service']['DatabaseService']['findOne'](_0x3a1ddd(0x152),_0x6c0636['cEVYs'],{'username':_0x2f7f2f},{'tokens':0x0,'password':0x0});}static async[_0x2701cf(0x145)](_0x407b0c){const _0x2475b5=_0x2701cf,_0x6408f0={'rUggH':function(_0x9b6c3,_0x5b8d8f){return _0x9b6c3+_0x5b8d8f;}};let _0x5b025d=await this[_0x2475b5(0x146)](_0x407b0c);if(!_0x5b025d)throw new Error(_0x6408f0[_0x2475b5(0x154)](_0x6408f0[_0x2475b5(0x154)]('No\x20user\x20by\x20username\x20\x22',_0x407b0c),'\x22'));_0x5b025d[_0x2475b5(0x145)](),await this['updateUser'](_0x407b0c,_0x5b025d[_0x2475b5(0x165)]());}static async[_0x2701cf(0x15e)](_0x764c1d,_0x1d63eb){const _0x5a8d04=_0x2701cf,_0x39567d={'GqtNZ':_0x5a8d04(0x131),'WTFZf':_0x5a8d04(0x152),'RcTmy':function(_0x108e76,_0x41df4b){return _0x108e76>=_0x41df4b;},'cDBRk':function(_0x302e5a,_0x324085){return _0x302e5a===_0x324085;},'hBYig':_0x5a8d04(0x156)},_0x1f684f=_0x39567d[_0x5a8d04(0x112)][_0x5a8d04(0x14e)]('|');let _0x55f64c=0x0;while(!![]){switch(_0x1f684f[_0x55f64c++]){case'0':await HashBrown['Service'][_0x5a8d04(0x164)][_0x5a8d04(0x140)]('users',_0x39567d[_0x5a8d04(0x14d)],{'id':_0x764c1d},_0x1d63eb);continue;case'1':return new HashBrown[(_0x5a8d04(0x162))][(_0x5a8d04(0x11b))][(_0x5a8d04(0x114))](_0x1d63eb);case'2':_0x1d63eb[_0x5a8d04(0x13e)]&&_0x39567d[_0x5a8d04(0x120)](_0x1d63eb[_0x5a8d04(0x13e)][_0x5a8d04(0x116)],0x4)&&_0x39567d[_0x5a8d04(0x11d)](typeof _0x1d63eb['password'],_0x39567d[_0x5a8d04(0x16f)])&&(_0x1d63eb['password']=HashBrown[_0x5a8d04(0x162)][_0x5a8d04(0x11b)][_0x5a8d04(0x114)][_0x5a8d04(0x129)](_0x1d63eb[_0x5a8d04(0x13e)]));continue;case'3':delete _0x1d63eb['id'];continue;case'4':_0x1d63eb['username']&&await this[_0x5a8d04(0x12a)](_0x764c1d,_0x1d63eb[_0x5a8d04(0x123)]);continue;}break;}}static async['updateUser'](_0x3f9530,_0x50d3c6){const _0x144296=_0x2701cf,_0x57f8c9={'jhPxq':'string','nDDsw':'users'};_0x50d3c6[_0x144296(0x13e)]&&_0x50d3c6[_0x144296(0x13e)][_0x144296(0x116)]>=0x4&&typeof _0x50d3c6[_0x144296(0x13e)]===_0x57f8c9[_0x144296(0x118)]&&(_0x50d3c6['password']=HashBrown[_0x144296(0x162)][_0x144296(0x11b)][_0x144296(0x114)][_0x144296(0x129)](_0x50d3c6[_0x144296(0x13e)])),delete _0x50d3c6['id'],delete proeprties[_0x144296(0x123)],await HashBrown['Service'][_0x144296(0x164)][_0x144296(0x140)](_0x57f8c9[_0x144296(0x111)],_0x57f8c9[_0x144296(0x111)],{'username':_0x3f9530},_0x50d3c6);}}function _0x4b25(_0x175fc9,_0x4dc3c5){const _0x2fbac6=_0x2fba();return _0x4b25=function(_0x4b2539,_0x1963b5){_0x4b2539=_0x4b2539-0x111;let _0x1c7e25=_0x2fbac6[_0x4b2539];return _0x1c7e25;},_0x4b25(_0x175fc9,_0x4dc3c5);}module['exports']=UserService;