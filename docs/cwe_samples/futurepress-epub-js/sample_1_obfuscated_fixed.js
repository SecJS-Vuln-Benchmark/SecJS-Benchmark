'use strict';const _0x2060fb=_0x49f7;function _0x559b(){const _0x525863=['rewrite\x20location\x20headers','json','/api/this-has-data','OMoMW','test','http-errors','EeyGm','eeWfr','YfrsD','this\x20is\x20root','kaboom','/api/something','get','DELETE','response','MNdEU','9822lHiyfj','basic\x20proxy','ocBqQ','bMlsL','Nvotm','port','gmZrC','2993844GrDwgX','FSwSG','Transform','/this-has-data','qnzyQ','ymACD','this\x20is\x20root\x20for\x20origin2','address','gbwMY','fastify','giHaL','twCiB','preHandler','/api2','6594312RTkPSU','295225QmNfdJ','http://localhost:','GwpRx','TCnDE','/something','no\x20upstream\x20will\x20throw','proxy\x20request\x20timeout','ready','statusCode','3ojulcS','/api','WeiqE','SbSaU','toUpperCase','eaMIs','close','hjXRv','lrwzp','header','bHLrm','server','UtwcD','zinub','preHandler\x20gets\x20config','DMgSD','bind','world','assign','equal','passes\x20replyOptions\x20object\x20to\x20reply.from()\x20calls','KnqAe','Gateway\x20Timeout','/timeout','undici\x20POST','match','fail','11089575dQjzmg','register','POST','hello','KEFFe','send','BRTgy','/my-prefix/','/my-prefix','865LWTiFf','PxWqC','fcPwp','skip\x20proxying\x20the\x20incoming\x20payload','/my-prefix/a','BsKkv','location','ziFnz','post','posted','pipe','GXkBB','hTQkm','/api/a','tearDown','JJCVN','2795776RDCOar','COawH','XCjjs','push','this\x20is\x20/api2/a','statusMessage','PUT','/api2/a','Aqmpp','stream','qVXGw','cYwFg','GAOLy','body','xjWvA','../','RXnrp','Xwjuk','IELKY','716942kboLwB','bar','KUeOm','listen','TVjwc','prefixed\x20proxy','passes\x20onResponse\x20option\x20to\x20reply.from()\x20calls','toString','SpPxc','posting\x20stuff','this\x20is\x20a','AMpYE','NpsUJ','HEAD','GET','bOrzR','tap','Stzce','KHHqX','deepEqual','PATCH','fspJJ','zsmOv','message','gzFFD','YMQsW','Dbrfc','UZjUr'];_0x559b=function(){return _0x525863;};return _0x559b();}(function(_0x271533,_0x251ff7){const _0x540bba=_0x49f7,_0x4b2943=_0x271533();while(!![]){try{const _0x8905a4=parseInt(_0x540bba(0xe7))/0x1+-parseInt(_0x540bba(0x137))/0x2*(-parseInt(_0x540bba(0xf0))/0x3)+-parseInt(_0x540bba(0x124))/0x4+parseInt(_0x540bba(0x114))/0x5*(-parseInt(_0x540bba(0x163))/0x6)+parseInt(_0x540bba(0xd8))/0x7+-parseInt(_0x540bba(0xe6))/0x8+parseInt(_0x540bba(0x10b))/0x9;if(_0x8905a4===_0x251ff7)break;else _0x4b2943['push'](_0x4b2943['shift']());}catch(_0x52a4d5){_0x4b2943['push'](_0x4b2943['shift']());}}}(_0x559b,0x7bcf9));const {tearDown,test}=require(_0x2060fb(0x147)),Fastify=require(_0x2060fb(0xe1)),proxy=require(_0x2060fb(0x133)),got=require('got'),{Unauthorized}=require(_0x2060fb(0x158)),Transform=require(_0x2060fb(0x12d))[_0x2060fb(0xda)];async function run(){const _0x4a5cdd=_0x2060fb,_0x522c16={'UtwcD':_0x4a5cdd(0x15c),'TVjwc':_0x4a5cdd(0x156),'DMgSD':_0x4a5cdd(0x11a),'bHLrm':_0x4a5cdd(0xeb),'Hrere':_0x4a5cdd(0x11d),'bOrzR':_0x4a5cdd(0x128),'IELKY':'this\x20is\x20never\x20received','JJCVN':function(_0x10472e,_0xa1b763){return _0x10472e(_0xa1b763);},'ALupf':_0x4a5cdd(0x141),'EeyGm':_0x4a5cdd(0x116),'Xwjuk':function(_0x2b25c2){return _0x2b25c2();},'zinub':'upstream\x20must\x20be\x20specified','yIqKW':_0x4a5cdd(0x113),'MNdEU':function(_0x314294,_0x2d392e,_0x554cd6){return _0x314294(_0x2d392e,_0x554cd6);},'qVXGw':_0x4a5cdd(0x101),'twCiB':function(_0x952386){return _0x952386();},'ziFnz':function(_0x2f675c,_0x49f30e,_0x461e65){return _0x2f675c(_0x49f30e,_0x461e65);},'KnqAe':function(_0x423ebf,_0x46be3d){return _0x423ebf(_0x46be3d);},'AMpYE':function(_0x197cb3,_0xb3f81c){return _0x197cb3!==_0xb3f81c;},'GAOLy':_0x4a5cdd(0x143),'BRTgy':_0x4a5cdd(0x160),'giHaL':_0x4a5cdd(0x144),'SbSaU':_0x4a5cdd(0xf5),'FSwSG':'/api','SpPxc':_0x4a5cdd(0xe5),'GwpRx':function(_0x486a3a,_0x3cd95a){return _0x486a3a(_0x3cd95a);},'lrwzp':_0x4a5cdd(0xde),'TCnDE':_0x4a5cdd(0x10d),'UZjUr':function(_0x516214,_0x206ba1){return _0x516214!==_0x206ba1;},'ocBqQ':'THIS\x20IS\x20ROOT','gzFFD':function(_0xbe39e4,_0x5e7fb1,_0x253c15){return _0xbe39e4(_0x5e7fb1,_0x253c15);},'KEFFe':_0x4a5cdd(0x139),'RXnrp':_0x4a5cdd(0x106),'YMQsW':_0x4a5cdd(0x107),'YfrsD':_0x4a5cdd(0x164),'ymACD':function(_0x43b13d,_0x1c4886,_0x35948a){return _0x43b13d(_0x1c4886,_0x35948a);},'xjWvA':_0x4a5cdd(0xe4),'RRdzU':_0x4a5cdd(0xfe),'Nvotm':'multiple\x20prefixes\x20with\x20multiple\x20plugins','COawH':function(_0x330165,_0x26bb15,_0x20b63f){return _0x330165(_0x26bb15,_0x20b63f);},'PxWqC':_0x4a5cdd(0x104)},_0x5b8437=Fastify();_0x5b8437['get']('/',async(_0x588194,_0x21676b)=>{const _0x3d2e01=_0x4a5cdd,_0x3bcc19={'Vabgj':_0x522c16[_0x3d2e01(0xfc)]};return _0x3d2e01(0xe0)!==_0x3d2e01(0xe0)?_0x3bcc19['Vabgj']:_0x522c16[_0x3d2e01(0xfc)];}),_0x5b8437[_0x4a5cdd(0x15f)]('/a',async(_0x35729e,_0x336540)=>{return'this\x20is\x20a';}),_0x5b8437[_0x4a5cdd(0x11c)](_0x4a5cdd(0xdb),async(_0x13a5e8,_0x5b6e81)=>{const _0x4080f7=_0x4a5cdd;if(_0x13a5e8[_0x4080f7(0x131)][_0x4080f7(0x10e)]===_0x4080f7(0x101)){if(_0x522c16[_0x4080f7(0x13b)]===_0x4080f7(0xf2))_0x102cae['equal'](_0x3a99c4[_0x4080f7(0x161)][_0x4080f7(0xef)],0x191),_0x17a65c=!![];else return _0x5b6e81['header'](_0x522c16['DMgSD'],_0x522c16['bHLrm']),{'something':_0x522c16['Hrere']};}throw new Error(_0x4080f7(0x15d));}),_0x5b8437[_0x4a5cdd(0x15f)](_0x4a5cdd(0x12b),async(_0x12dcbd,_0x5ae7c5)=>{const _0x2047d6=_0x4a5cdd,_0x109944={'eeWfr':_0x2047d6(0x101),'Aqmpp':function(_0x455fee){return _0x455fee();}};if(_0x2047d6(0x11f)==='GXkBB')return _0x522c16[_0x2047d6(0x146)];else _0x382112['deepEqual'](_0x435f1f[_0x2047d6(0x131)],{'hello':_0x109944[_0x2047d6(0x15a)]}),_0x109944[_0x2047d6(0x12c)](_0x514781);}),_0x5b8437['get'](_0x522c16[_0x4a5cdd(0x150)],async(_0x5b01b5,_0x35b65d)=>{const _0x2e3c4e=_0x4a5cdd;return await new Promise(_0x326d53=>setTimeout(_0x326d53,0x258)),_0x522c16[_0x2e3c4e(0x136)];}),await _0x5b8437[_0x4a5cdd(0x13a)](0x0),tearDown(_0x5b8437['close'][_0x4a5cdd(0x100)](_0x5b8437)),test(_0x522c16[_0x4a5cdd(0x15b)],async _0x2d7ac6=>{const _0x410a14=_0x4a5cdd,_0x4134f6=Fastify();_0x4134f6['register'](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0x410a14(0xfb)][_0x410a14(0xdf)]()[_0x410a14(0xd6)]}),await _0x4134f6['listen'](0x0),_0x2d7ac6[_0x410a14(0x122)](_0x4134f6[_0x410a14(0xf6)][_0x410a14(0x100)](_0x4134f6));const _0x436c62=await got('http://localhost:'+_0x4134f6[_0x410a14(0xfb)][_0x410a14(0xdf)]()[_0x410a14(0xd6)]);_0x2d7ac6['equal'](_0x436c62[_0x410a14(0x131)],_0x410a14(0x15c));const _0x2c0758=await _0x522c16[_0x410a14(0x123)](got,_0x410a14(0xe8)+_0x4134f6[_0x410a14(0xfb)][_0x410a14(0xdf)]()[_0x410a14(0xd6)]+'/a');_0x2d7ac6[_0x410a14(0x103)](_0x2c0758[_0x410a14(0x131)],_0x522c16['ALupf']);}),_0x522c16['gzFFD'](test,_0x4a5cdd(0xec),async _0x312221=>{const _0x11ce68=_0x4a5cdd,_0x4c170={'BsKkv':_0x522c16[_0x11ce68(0xff)],'cYwFg':_0x11ce68(0xeb)};if(_0x522c16[_0x11ce68(0x159)]==='fcPwp'){const _0x58abd0=_0x522c16[_0x11ce68(0x135)](Fastify);_0x58abd0[_0x11ce68(0x10c)](proxy);try{await _0x58abd0[_0x11ce68(0xee)]();}catch(_0x18234b){_0x312221[_0x11ce68(0x103)](_0x18234b[_0x11ce68(0x14e)],_0x522c16[_0x11ce68(0xfd)]);return;}_0x312221['fail']();}else return _0x32d27e[_0x11ce68(0xf9)](_0x4c170[_0x11ce68(0x119)],_0x4c170[_0x11ce68(0x12f)]),{'something':_0x11ce68(0x11d)};}),test(_0x4a5cdd(0x13c),async _0x5caf1d=>{const _0x1989eb=_0x4a5cdd,_0x361c5d=_0x522c16[_0x1989eb(0x135)](Fastify);_0x361c5d[_0x1989eb(0x10c)](proxy,{'upstream':_0x1989eb(0xe8)+_0x5b8437['server'][_0x1989eb(0xdf)]()[_0x1989eb(0xd6)],'prefix':_0x522c16['yIqKW']}),await _0x361c5d['listen'](0x0),_0x5caf1d[_0x1989eb(0x122)](_0x361c5d[_0x1989eb(0xf6)][_0x1989eb(0x100)](_0x361c5d));const _0x499d49=await got(_0x1989eb(0xe8)+_0x361c5d['server']['address']()[_0x1989eb(0xd6)]+_0x1989eb(0x112));_0x5caf1d[_0x1989eb(0x103)](_0x499d49[_0x1989eb(0x131)],_0x522c16['UtwcD']);const _0x1ae6b5=await got(_0x1989eb(0xe8)+_0x361c5d['server'][_0x1989eb(0xdf)]()[_0x1989eb(0xd6)]+'/my-prefix');_0x5caf1d[_0x1989eb(0x103)](_0x1ae6b5[_0x1989eb(0x131)],_0x522c16[_0x1989eb(0xfc)]);const _0x1ce186=await got(_0x1989eb(0xe8)+_0x361c5d[_0x1989eb(0xfb)]['address']()[_0x1989eb(0xd6)]+_0x1989eb(0x118));_0x5caf1d[_0x1989eb(0x103)](_0x1ce186[_0x1989eb(0x131)],_0x522c16['ALupf']);}),test(_0x4a5cdd(0x140),async _0x4db6d5=>{const _0x1ad370=_0x4a5cdd,_0x47cafb=Fastify();_0x47cafb[_0x1ad370(0x10c)](proxy,{'upstream':_0x1ad370(0xe8)+_0x5b8437[_0x1ad370(0xfb)][_0x1ad370(0xdf)]()[_0x1ad370(0xd6)]}),await _0x47cafb[_0x1ad370(0x13a)](0x0),_0x4db6d5['tearDown'](_0x47cafb[_0x1ad370(0xf6)][_0x1ad370(0x100)](_0x47cafb));const _0x4162d0=await _0x522c16[_0x1ad370(0x162)](got,_0x1ad370(0xe8)+_0x47cafb['server'][_0x1ad370(0xdf)]()[_0x1ad370(0xd6)]+_0x1ad370(0xdb),{'method':_0x1ad370(0x10d),'json':{'hello':_0x522c16[_0x1ad370(0x12e)]},'responseType':_0x1ad370(0x154)});_0x4db6d5[_0x1ad370(0x14a)](_0x4162d0[_0x1ad370(0x131)],{'something':'posted'});}),test(_0x4a5cdd(0x117),async _0xccbe6e=>{const _0x4cda69=_0x4a5cdd,_0x514e25=_0x522c16[_0x4cda69(0x135)](Fastify);_0x514e25[_0x4cda69(0x10c)](proxy,{'upstream':_0x4cda69(0xe8)+_0x5b8437[_0x4cda69(0xfb)][_0x4cda69(0xdf)]()[_0x4cda69(0xd6)],'proxyPayloads':![],'preHandler'(_0x3a4c99,_0x1ddde3,_0x5f42ec){const _0x5262e3=_0x4cda69;_0xccbe6e[_0x5262e3(0x14a)](_0x3a4c99['body'],{'hello':_0x522c16[_0x5262e3(0x12e)]}),_0x522c16[_0x5262e3(0xe3)](_0x5f42ec);}}),await _0x514e25[_0x4cda69(0x13a)](0x0),_0xccbe6e[_0x4cda69(0x122)](_0x514e25[_0x4cda69(0xf6)][_0x4cda69(0x100)](_0x514e25)),await _0x522c16[_0x4cda69(0x11b)](got,_0x4cda69(0xe8)+_0x514e25[_0x4cda69(0xfb)][_0x4cda69(0xdf)]()[_0x4cda69(0xd6)]+_0x4cda69(0xdb),{'method':_0x4cda69(0x10d),'json':{'hello':_0x4cda69(0x101)},'responseType':_0x4cda69(0x154)});}),_0x522c16[_0x4a5cdd(0xdd)](test,_0x522c16[_0x4a5cdd(0x132)],async _0x429c38=>{const _0xe290ea=_0x4a5cdd,_0x1251d1={'gmZrC':function(_0x5d992a){return _0x5d992a();}},_0x5557d5=_0x522c16[_0xe290ea(0xe3)](Fastify);_0x5557d5[_0xe290ea(0x10c)](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0xe290ea(0xfb)][_0xe290ea(0xdf)]()[_0xe290ea(0xd6)],async 'preHandler'(_0x42ee72,_0x44747a){throw new Unauthorized();}}),await _0x5557d5[_0xe290ea(0x13a)](0x0),_0x429c38['tearDown'](_0x5557d5[_0xe290ea(0xf6)]['bind'](_0x5557d5));let _0x1b3a10=![];try{await got(_0xe290ea(0xe8)+_0x5557d5[_0xe290ea(0xfb)][_0xe290ea(0xdf)]()[_0xe290ea(0xd6)]);}catch(_0x11610a){_0x429c38['equal'](_0x11610a[_0xe290ea(0x161)]['statusCode'],0x191),_0x1b3a10=!![];}_0x429c38['ok'](_0x1b3a10),_0x1b3a10=![];try{await _0x522c16[_0xe290ea(0x105)](got,'http://localhost:'+_0x5557d5[_0xe290ea(0xfb)][_0xe290ea(0xdf)]()[_0xe290ea(0xd6)]+'/a');}catch(_0x3237c9){_0x522c16[_0xe290ea(0x142)](_0xe290ea(0x14d),_0x522c16[_0xe290ea(0x130)])?(_0x429c38[_0xe290ea(0x103)](_0x3237c9[_0xe290ea(0x161)][_0xe290ea(0xef)],0x191),_0x1b3a10=!![]):(this['push'](_0xf563e[_0xe290ea(0x13e)]()[_0xe290ea(0xf4)]()),_0x1251d1[_0xe290ea(0xd7)](_0x3d8485));}_0x429c38['ok'](_0x1b3a10);}),test(_0x522c16['RRdzU'],async _0xd6813e=>{const _0xe5f2de=_0x4a5cdd,_0x13155a={'GzmzB':_0x522c16[_0xe5f2de(0x111)],'KHHqX':_0x522c16[_0xe5f2de(0xe2)],'Dbrfc':_0xe5f2de(0x14b)},_0xc4f26e=Fastify();_0xc4f26e[_0xe5f2de(0x10c)](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0xe5f2de(0xfb)]['address']()[_0xe5f2de(0xd6)],'config':{'foo':_0xe5f2de(0x138)},async 'preHandler'(_0x1b6a3c,_0x2df576){const _0x3bd3ad=_0xe5f2de;_0xd6813e[_0x3bd3ad(0x14a)](_0x2df576['context']['config'],{'foo':_0x3bd3ad(0x138),'url':'/','method':[_0x13155a['GzmzB'],_0x3bd3ad(0x145),_0x13155a[_0x3bd3ad(0x149)],_0x13155a[_0x3bd3ad(0x151)],_0x3bd3ad(0x10d),_0x3bd3ad(0x12a),'OPTIONS']});throw new Unauthorized();}}),await _0xc4f26e['listen'](0x0),_0xd6813e[_0xe5f2de(0x122)](_0xc4f26e[_0xe5f2de(0xf6)][_0xe5f2de(0x100)](_0xc4f26e));let _0x2a5fb4=![];try{await got('http://localhost:'+_0xc4f26e['server'][_0xe5f2de(0xdf)]()['port']);}catch(_0x4068db){_0xe5f2de(0xf5)!==_0x522c16[_0xe5f2de(0xf3)]?_0x115eeb[_0xe5f2de(0xf6)]():(_0xd6813e[_0xe5f2de(0x103)](_0x4068db[_0xe5f2de(0x161)]['statusCode'],0x191),_0x2a5fb4=!![]);}_0xd6813e['ok'](_0x2a5fb4);}),_0x522c16['gzFFD'](test,_0x522c16[_0x4a5cdd(0xd5)],async _0x3e1173=>{const _0x3c4631=_0x4a5cdd,_0x3d84a5=_0x522c16[_0x3c4631(0xe3)](Fastify);_0x3d84a5[_0x3c4631(0x15f)]('/',async(_0x10ff1e,_0x1e514c)=>{const _0xdb7eea=_0x3c4631;return _0xdb7eea(0xde);}),await _0x3d84a5[_0x3c4631(0x13a)](0x0);const _0x56cd18=_0x522c16['Xwjuk'](Fastify);_0x56cd18['register'](proxy,{'upstream':_0x3c4631(0xe8)+_0x5b8437[_0x3c4631(0xfb)][_0x3c4631(0xdf)]()[_0x3c4631(0xd6)],'prefix':_0x522c16[_0x3c4631(0xd9)]}),_0x56cd18['register'](proxy,{'upstream':'http://localhost:'+_0x3d84a5[_0x3c4631(0xfb)][_0x3c4631(0xdf)]()[_0x3c4631(0xd6)],'prefix':_0x522c16[_0x3c4631(0x13f)]}),await _0x56cd18[_0x3c4631(0x13a)](0x0),_0x3e1173['tearDown'](()=>{const _0x54ccf0=_0x3c4631;_0x3d84a5[_0x54ccf0(0xf6)](),_0x56cd18[_0x54ccf0(0xf6)]();});const _0x46753a=await _0x522c16[_0x3c4631(0xe9)](got,'http://localhost:'+_0x56cd18[_0x3c4631(0xfb)]['address']()['port']+_0x3c4631(0xf1));_0x3e1173[_0x3c4631(0x103)](_0x46753a[_0x3c4631(0x131)],_0x522c16[_0x3c4631(0xfc)]);const _0x1a348c=await got('http://localhost:'+_0x56cd18[_0x3c4631(0xfb)][_0x3c4631(0xdf)]()['port']+'/api2');_0x3e1173[_0x3c4631(0x103)](_0x1a348c[_0x3c4631(0x131)],_0x522c16[_0x3c4631(0xf8)]);}),_0x522c16[_0x4a5cdd(0x125)](test,_0x522c16[_0x4a5cdd(0x115)],async _0x2bb1e7=>{const _0x4fb86c=_0x4a5cdd,_0x541e15=Fastify();_0x541e15[_0x4fb86c(0x10c)](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0x4fb86c(0xfb)][_0x4fb86c(0xdf)]()['port'],'prefix':_0x4fb86c(0xf1),'replyOptions':{'rewriteHeaders':_0x1176ff=>Object[_0x4fb86c(0x102)]({'x-test':_0x4fb86c(0x157)},_0x1176ff)}}),await _0x541e15[_0x4fb86c(0x13a)](0x0),_0x2bb1e7[_0x4fb86c(0x122)](()=>{const _0x1c8737=_0x4fb86c;_0x541e15[_0x1c8737(0xf6)]();});const {headers:_0x3ffc05}=await _0x522c16['GwpRx'](got,_0x4fb86c(0xe8)+_0x541e15[_0x4fb86c(0xfb)][_0x4fb86c(0xdf)]()[_0x4fb86c(0xd6)]+'/api');_0x2bb1e7['match'](_0x3ffc05,{'x-test':_0x4fb86c(0x157)});}),test('rewritePrefix',async _0x295597=>{const _0x5a913d=_0x4a5cdd,_0x626f3b=Fastify();_0x626f3b[_0x5a913d(0x10c)](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0x5a913d(0xfb)][_0x5a913d(0xdf)]()['port'],'prefix':_0x522c16['FSwSG'],'rewritePrefix':_0x522c16[_0x5a913d(0x13f)]}),await _0x626f3b[_0x5a913d(0x13a)](0x0),_0x295597[_0x5a913d(0x122)](()=>{_0x626f3b['close']();});const _0x4031e3=await got(_0x5a913d(0xe8)+_0x626f3b[_0x5a913d(0xfb)]['address']()['port']+_0x5a913d(0x121));_0x295597[_0x5a913d(0x103)](_0x4031e3[_0x5a913d(0x131)],_0x522c16['bOrzR']);}),test(_0x4a5cdd(0x153),async _0x41097c=>{const _0x21e7f9=_0x4a5cdd,_0x9b6665=Fastify();_0x9b6665[_0x21e7f9(0x10c)](proxy,{'upstream':_0x21e7f9(0xe8)+_0x5b8437[_0x21e7f9(0xfb)][_0x21e7f9(0xdf)]()[_0x21e7f9(0xd6)],'prefix':_0x21e7f9(0xf1)}),await _0x9b6665[_0x21e7f9(0x13a)](0x0),_0x41097c['tearDown'](()=>{_0x9b6665['close']();});const {headers:{location:_0xe027bd}}=await got(_0x21e7f9(0xe8)+_0x9b6665[_0x21e7f9(0xfb)][_0x21e7f9(0xdf)]()[_0x21e7f9(0xd6)]+_0x21e7f9(0x155),{'method':_0x522c16[_0x21e7f9(0xea)],'json':{'hello':_0x21e7f9(0x101)}});_0x41097c[_0x21e7f9(0x103)](_0xe027bd,_0x21e7f9(0x15e));}),test(_0x4a5cdd(0x13d),async _0x48a4ec=>{const _0x46baaa=_0x4a5cdd,_0x2dbfbb={'Stzce':function(_0x20dcb3,_0x174fa4){const _0x22d379=_0x49f7;return _0x522c16[_0x22d379(0x152)](_0x20dcb3,_0x174fa4);}},_0x1fb092=Fastify();_0x1fb092[_0x46baaa(0x10c)](proxy,{'upstream':_0x46baaa(0xe8)+_0x5b8437[_0x46baaa(0xfb)][_0x46baaa(0xdf)]()[_0x46baaa(0xd6)],'prefix':_0x46baaa(0xf1),'replyOptions':{'onResponse'(_0x4a6870,_0x55e29a,_0x411107){const _0x4ceae1=_0x46baaa,_0x435741={'QjDIK':function(_0x4d73c6,_0x5234af){const _0x3f9463=_0x49f7;return _0x2dbfbb[_0x3f9463(0x148)](_0x4d73c6,_0x5234af);},'qnzyQ':_0x4ceae1(0x126),'vuqVK':function(_0x259ed2){return _0x259ed2();}};if(_0x4ceae1(0x14c)===_0x4ceae1(0x14c))return _0x55e29a[_0x4ceae1(0x110)](_0x411107[_0x4ceae1(0x11e)](new Transform({'transform':function(_0x1bd513,_0x2372d1,_0x3df6ae){const _0x430c96=_0x4ceae1;_0x435741['QjDIK'](_0x430c96(0x126),_0x435741[_0x430c96(0xdc)])?_0x3e62eb[_0x430c96(0xf6)]():(this[_0x430c96(0x127)](_0x1bd513['toString']()[_0x430c96(0xf4)]()),_0x435741['vuqVK'](_0x3df6ae));}})));else _0x21c22d[_0x4ceae1(0xf6)]();}}}),await _0x1fb092[_0x46baaa(0x13a)](0x0),_0x48a4ec[_0x46baaa(0x122)](()=>{const _0x211040=_0x46baaa;'UIBAQ'!==_0x211040(0x120)?_0x1fb092[_0x211040(0xf6)]():_0x5519f9[_0x211040(0xf6)]();});const {body:_0x36b27d}=await got(_0x46baaa(0xe8)+_0x1fb092[_0x46baaa(0xfb)][_0x46baaa(0xdf)]()['port']+'/api');_0x48a4ec[_0x46baaa(0x109)](_0x36b27d,_0x522c16[_0x46baaa(0x165)]);}),test(_0x4a5cdd(0x108),async _0x2141fd=>{const _0x270ef8=_0x4a5cdd,_0x5cc58a=_0x522c16[_0x270ef8(0xe3)](Fastify);_0x5cc58a[_0x270ef8(0x10c)](proxy,{'upstream':'http://localhost:'+_0x5b8437[_0x270ef8(0xfb)][_0x270ef8(0xdf)]()['port'],'undici':!![]}),await _0x5cc58a[_0x270ef8(0x13a)](0x0),_0x2141fd[_0x270ef8(0x122)](()=>{const _0x2288d3=_0x270ef8;_0x5cc58a[_0x2288d3(0xf6)]();});const {headers:{location:_0x45c016}}=await got(_0x270ef8(0xe8)+_0x5cc58a[_0x270ef8(0xfb)][_0x270ef8(0xdf)]()[_0x270ef8(0xd6)]+'/this-has-data',{'method':_0x270ef8(0x10d),'json':{'hello':_0x270ef8(0x101)}});_0x2141fd[_0x270ef8(0x103)](_0x45c016,_0x522c16[_0x270ef8(0xfa)]);}),test(_0x4a5cdd(0xed),async _0x195d2e=>{const _0x5a9c2f=_0x4a5cdd,_0x26082f=Fastify();_0x26082f[_0x5a9c2f(0x10c)](proxy,{'upstream':_0x5a9c2f(0xe8)+_0x5b8437[_0x5a9c2f(0xfb)]['address']()[_0x5a9c2f(0xd6)],'http':{'requestOptions':{'timeout':0x12c}}}),await _0x26082f[_0x5a9c2f(0x13a)](0x0),_0x195d2e[_0x5a9c2f(0x122)](_0x26082f['close']['bind'](_0x26082f));try{_0x5a9c2f(0xd4)===_0x5a9c2f(0xf7)?(_0x632a5b[_0x5a9c2f(0xf6)](),_0x337a99['close']()):await _0x522c16[_0x5a9c2f(0x14f)](got,_0x5a9c2f(0xe8)+_0x26082f['server'][_0x5a9c2f(0xdf)]()[_0x5a9c2f(0xd6)]+_0x5a9c2f(0x107),{'retry':0x0});}catch(_0x4cfe64){if(_0x522c16[_0x5a9c2f(0x152)]('ElSZo',_0x522c16[_0x5a9c2f(0x10f)])){_0x195d2e[_0x5a9c2f(0x103)](_0x4cfe64['response'][_0x5a9c2f(0xef)],0x1f8),_0x195d2e['equal'](_0x4cfe64[_0x5a9c2f(0x161)][_0x5a9c2f(0x129)],_0x522c16[_0x5a9c2f(0x134)]);return;}else throw new _0xa6aadf();}_0x195d2e[_0x5a9c2f(0x10a)]();});}function _0x49f7(_0x126bdf,_0x2a78bc){const _0x559b2b=_0x559b();return _0x49f7=function(_0x49f718,_0x18d02e){_0x49f718=_0x49f718-0xd4;let _0x2cab7e=_0x559b2b[_0x49f718];return _0x2cab7e;},_0x49f7(_0x126bdf,_0x2a78bc);}run();