'use strict';var _0x408b92=_0x240a;(function(_0x1d2471,_0x2c7478){var _0x2cdd67=_0x240a,_0xb6fb44=_0x1d2471();while(!![]){try{var _0x43f493=-parseInt(_0x2cdd67(0x123))/0x1+-parseInt(_0x2cdd67(0x188))/0x2*(-parseInt(_0x2cdd67(0x15c))/0x3)+parseInt(_0x2cdd67(0x119))/0x4*(-parseInt(_0x2cdd67(0x124))/0x5)+parseInt(_0x2cdd67(0x157))/0x6+parseInt(_0x2cdd67(0x174))/0x7*(-parseInt(_0x2cdd67(0x11f))/0x8)+parseInt(_0x2cdd67(0x16d))/0x9+parseInt(_0x2cdd67(0x11a))/0xa;if(_0x43f493===_0x2c7478)break;else _0xb6fb44['push'](_0xb6fb44['shift']());}catch(_0x5d6ed6){_0xb6fb44['push'](_0xb6fb44['shift']());}}}(_0x2923,0x4227f));function _0x240a(_0x2d4464,_0x729173){var _0x29238d=_0x2923();return _0x240a=function(_0x240aed,_0x14e248){_0x240aed=_0x240aed-0x115;var _0x2471a0=_0x29238d[_0x240aed];return _0x2471a0;},_0x240a(_0x2d4464,_0x729173);}function _0x2923(){var _0x2949ab=['user','format','slSTB','fkJoT','Invalid\x20argument:\x20`response`\x20must\x20be\x20an\x20instance\x20of\x20Response','model','handle','Server\x20error:\x20`handle()`\x20did\x20not\x20return\x20a\x20`user`\x20object','0|1|2|4|3','getResponseType','lpHHE','length','EoKCO','2303199HshQpE','token','SAyOe','Unsupported\x20response\x20type:\x20`response_type`\x20is\x20not\x20supported','SQSmm','NurxG','parse','341992ajKDvf','body','Missing\x20parameter:\x20`client_id`','catch','ggCTz','includes','LnIGM','split','buildErrorRedirectUri','Invalid\x20scope:\x20Requested\x20scope\x20is\x20invalid','BXQei','../request','updateResponse','error','setRedirectUriParam','get','prototype','../response-types/code-response-type','UPOpl','options','2638JzLNgk','getRedirectUri','error_description','message','abBwF','../errors/invalid-client-error','Invalid\x20argument:\x20`request`\x20must\x20be\x20an\x20instance\x20of\x20Request','Yfyii','pZePD','implicit','nsvfw','query','allowed','RFNNY','lSqew','buildRedirectUri','call','name','getState','gbetd','Missing\x20parameter:\x20`model`','8JBDKbt','6986700ceFNuS','ppCgq','BQRPX','ZrGiA','Invalid\x20argument:\x20authenticateHandler\x20does\x20not\x20implement\x20`handle()`','64keGVEh','validateScope','../errors/unauthorized-client-error','Invalid\x20client:\x20`redirect_uri`\x20does\x20not\x20match\x20client\x20value','366294YaeaFx','23515TwUAun','Dejyx','all','buildSuccessRedirectUri','RyUWP','getClient','iNlFm','Invalid\x20argument:\x20model\x20does\x20not\x20implement\x20`getClient()`','VMtWb','getUser','authorization_code','PwNiW','VhcTm','BCvbk','state','../errors/oauth-error','lodash','getScope','Missing\x20parameter:\x20`response_type`','oOeGM','YnCtP','Invalid\x20client:\x20missing\x20client\x20`redirectUri`','client_id','sWZVP','grants','YhxkW','Unauthorized\x20client:\x20`grant_type`\x20is\x20invalid','response_type','Invalid\x20client:\x20missing\x20client\x20`grants`','../errors/invalid-argument-error','MNSaQ','../errors/invalid-request-error','Invalid\x20parameter:\x20`state`','redirectUris','vschar','kJFFi','NUXiD','allowEmptyState','uri','Invalid\x20parameter:\x20`client_id`','Missing\x20parameter:\x20`state`','Access\x20denied:\x20user\x20denied\x20access\x20to\x20application','promisify-any','scope','PlNMl','gTXne','PVyQd','then','authenticateHandler','reject','redirect','38640RjzEyr','zqMvG','../errors/access-denied-error','hNlzp','redirect_uri','174aHfvga','Invalid\x20request:\x20`redirect_uri`\x20is\x20not\x20a\x20valid\x20URI','use','bind'];_0x2923=function(){return _0x2949ab;};return _0x2923();}var _=require(_0x408b92(0x134)),AccessDeniedError=require(_0x408b92(0x159)),AuthenticateHandler=require('../handlers/authenticate-handler'),InvalidArgumentError=require(_0x408b92(0x141)),InvalidClientError=require(_0x408b92(0x18d)),InvalidRequestError=require(_0x408b92(0x143)),InvalidScopeError=require('../errors/invalid-scope-error'),UnsupportedResponseTypeError=require('../errors/unsupported-response-type-error'),OAuthError=require(_0x408b92(0x133)),Promise=require('bluebird'),promisify=require(_0x408b92(0x14e))[_0x408b92(0x15e)](Promise),Request=require(_0x408b92(0x17f)),Response=require('../response'),ServerError=require('../errors/server-error'),UnauthorizedClientError=require(_0x408b92(0x121)),is=require('../validator/is'),url=require('url'),responseTypes={'code':require(_0x408b92(0x185)),'token':require('../response-types/token-response-type')};function AuthorizeHandler(_0x1aedaf){var _0x1a9923=_0x408b92,_0x375444={'SQSmm':function(_0x3b7454,_0x1abb49){return _0x3b7454||_0x1abb49;},'gTXne':_0x1a9923(0x118)};_0x1aedaf=_0x375444[_0x1a9923(0x171)](_0x1aedaf,{});if(_0x1aedaf[_0x1a9923(0x154)]&&!_0x1aedaf[_0x1a9923(0x154)][_0x1a9923(0x166)])throw new InvalidArgumentError(_0x1a9923(0x11e));if(!_0x1aedaf[_0x1a9923(0x165)])throw new InvalidArgumentError(_0x375444[_0x1a9923(0x151)]);if(!_0x1aedaf[_0x1a9923(0x165)]['getClient'])throw new InvalidArgumentError(_0x1a9923(0x12b));this['options']=_0x1aedaf,this[_0x1a9923(0x149)]=_0x1aedaf['allowEmptyState'],this['authenticateHandler']=_0x1aedaf[_0x1a9923(0x154)]||new AuthenticateHandler(_0x1aedaf),this[_0x1a9923(0x165)]=_0x1aedaf[_0x1a9923(0x165)];}AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x166)]=function(_0x4cd5c8,_0x1d4012){var _0x362114=_0x408b92,_0x14bf09={'PwNiW':function(_0x827ab7,_0x22883a){return _0x827ab7===_0x22883a;},'Yfyii':function(_0x249711,_0xfbace4){return _0x249711 instanceof _0xfbace4;},'wqFiL':function(_0x16cefe,_0x476936){return _0x16cefe instanceof _0x476936;},'kJFFi':_0x362114(0x164),'ppCgq':'false','Dejyx':_0x362114(0x14d)};if(!_0x14bf09[_0x362114(0x18f)](_0x4cd5c8,Request))throw new InvalidArgumentError(_0x362114(0x18e));if(!_0x14bf09['wqFiL'](_0x1d4012,Response))throw new InvalidArgumentError(_0x14bf09[_0x362114(0x147)]);if(_0x14bf09[_0x362114(0x11b)]===_0x4cd5c8[_0x362114(0x193)][_0x362114(0x194)])return Promise[_0x362114(0x155)](new AccessDeniedError(_0x14bf09[_0x362114(0x125)]));this[_0x362114(0x165)]['request']=_0x4cd5c8;var _0x4e9c3d=[this[_0x362114(0x129)](_0x4cd5c8),this[_0x362114(0x12d)](_0x4cd5c8,_0x1d4012)];return Promise[_0x362114(0x126)](_0x4e9c3d)[_0x362114(0x15f)](this)['spread'](function(_0x408b95,_0x1b6f90){var _0xa4013d=_0x362114,_0x3297ed={'nsvfw':function(_0x4841f7,_0x43b6f3){var _0x1a0b12=_0x240a;return _0x14bf09[_0x1a0b12(0x12f)](_0x4841f7,_0x43b6f3);},'PVyQd':_0xa4013d(0x142),'NcONG':function(_0x5f96ef,_0x347dc3){var _0x5bf5a9=_0xa4013d;return _0x14bf09[_0x5bf5a9(0x18f)](_0x5f96ef,_0x347dc3);}},_0x423ea7,_0x23af18,_0x26c079,_0x3ad09c,_0x20b598=this[_0xa4013d(0x189)](_0x4cd5c8,_0x408b95);return Promise[_0xa4013d(0x15f)](this)['then'](function(){var _0xc5e9c7=_0xa4013d,_0x5e7b85=this['getScope'](_0x4cd5c8);return this[_0xc5e9c7(0x120)](_0x1b6f90,_0x408b95,_0x5e7b85);})[_0xa4013d(0x153)](function(_0x1046ac){var _0x246c43=_0xa4013d,_0x11c39e={'IBMUw':_0x246c43(0x122)};if(_0x3297ed[_0x246c43(0x192)](_0x246c43(0x138),_0x3297ed[_0x246c43(0x152)]))throw new _0x2d8503(_0x11c39e['IBMUw']);else return _0x423ea7=_0x1046ac,_0x23af18=this[_0x246c43(0x116)](_0x4cd5c8),_0x26c079=this[_0x246c43(0x169)](_0x4cd5c8,_0x408b95),_0x3ad09c=new _0x26c079(this['options']),_0x3ad09c[_0x246c43(0x166)](_0x4cd5c8,_0x408b95,_0x1b6f90,_0x20b598,_0x423ea7);})[_0xa4013d(0x153)](function(_0x730381){var _0x2a5cc8=_0xa4013d,_0x37fbce=this['buildSuccessRedirectUri'](_0x20b598,_0x3ad09c);return this[_0x2a5cc8(0x180)](_0x1d4012,_0x37fbce,_0x3ad09c,_0x23af18),_0x730381;})[_0xa4013d(0x177)](function(_0x4710bc){var _0x117374=_0xa4013d;!_0x3297ed['NcONG'](_0x4710bc,OAuthError)&&(_0x4710bc=new ServerError(_0x4710bc));var _0x4e5564=this[_0x117374(0x17c)](_0x20b598,_0x3ad09c,_0x4710bc);this[_0x117374(0x180)](_0x1d4012,_0x4e5564,_0x3ad09c,_0x23af18);throw _0x4710bc;});});},AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x129)]=function(_0x365837){var _0x2b48e3=_0x408b92,_0x17ec65={'sWZVP':function(_0x4e1331,_0x1d5b51){return _0x4e1331&&_0x1d5b51;},'YhxkW':_0x2b48e3(0x132),'hNlzp':'Invalid\x20client:\x20client\x20credentials\x20are\x20invalid','efPDO':_0x2b48e3(0x13e),'UPOpl':function(_0x431ff2,_0xce26bb){return _0x431ff2===_0xce26bb;},'pZePD':function(_0x39352c,_0x5da454){return _0x39352c===_0x5da454;},'lpHHE':'RLGBQ','iNlFm':_0x2b48e3(0x139),'BXQei':_0x2b48e3(0x122),'ggCTz':_0x2b48e3(0x176),'NurxG':_0x2b48e3(0x14b)},_0x4acf3c=_0x365837['body'][_0x2b48e3(0x13a)]||_0x365837[_0x2b48e3(0x193)]['client_id'];if(!_0x4acf3c)throw new InvalidRequestError(_0x17ec65[_0x2b48e3(0x178)]);if(!is[_0x2b48e3(0x146)](_0x4acf3c))throw new InvalidRequestError(_0x17ec65[_0x2b48e3(0x172)]);var _0x3492a6=_0x365837[_0x2b48e3(0x175)][_0x2b48e3(0x15b)]||_0x365837[_0x2b48e3(0x193)][_0x2b48e3(0x15b)];if(_0x3492a6&&!is[_0x2b48e3(0x14a)](_0x3492a6))throw new InvalidRequestError(_0x2b48e3(0x15d));return promisify(this['model'][_0x2b48e3(0x129)],0x2)[_0x2b48e3(0x198)](this['model'],_0x4acf3c,null)[_0x2b48e3(0x153)](function(_0x51f8ac){var _0x15c540=_0x2b48e3;if(!_0x51f8ac)throw new InvalidClientError(_0x17ec65[_0x15c540(0x15a)]);if(!_0x51f8ac[_0x15c540(0x13c)])throw new InvalidClientError(_0x15c540(0x140));if(!_[_0x15c540(0x179)](_0x51f8ac[_0x15c540(0x13c)],_0x15c540(0x12e)))throw new UnauthorizedClientError(_0x17ec65['efPDO']);if(!_0x51f8ac[_0x15c540(0x145)]||_0x17ec65[_0x15c540(0x186)](0x0,_0x51f8ac[_0x15c540(0x145)][_0x15c540(0x16b)])){if(_0x17ec65[_0x15c540(0x190)]('RLGBQ',_0x17ec65[_0x15c540(0x16a)]))throw new InvalidClientError(_0x17ec65[_0x15c540(0x12a)]);else{if(_0x17ec65[_0x15c540(0x13b)](_0x48e240,_0x41787c))_0x3f3935=_0x19cb55[_0x15c540(0x182)](_0x42c2ca,_0x17ec65[_0x15c540(0x13d)],_0x1e00cb);else _0x47e332&&(_0x672389[_0x15c540(0x193)]=_0x58a50a[_0x15c540(0x193)]||{},_0x41b1a5['query']['state']=_0x55a2fe);_0x27b547['redirect'](_0xf37380[_0x15c540(0x161)](_0x3c2d7b));}}if(_0x3492a6&&!_[_0x15c540(0x179)](_0x51f8ac[_0x15c540(0x145)],_0x3492a6))throw new InvalidClientError(_0x17ec65[_0x15c540(0x17e)]);return _0x51f8ac;});},AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x120)]=function(_0x59ff71,_0x340100,_0x30e33d){var _0x3467cd=_0x408b92,_0x4bf7a6={'RyUWP':_0x3467cd(0x17d)};return this[_0x3467cd(0x165)][_0x3467cd(0x120)]?promisify(this[_0x3467cd(0x165)][_0x3467cd(0x120)],0x3)[_0x3467cd(0x198)](this['model'],_0x59ff71,_0x340100,_0x30e33d)[_0x3467cd(0x153)](function(_0x1ba259){var _0x4834ca=_0x3467cd;if(!_0x1ba259)throw new InvalidScopeError(_0x4bf7a6[_0x4834ca(0x128)]);return _0x1ba259;}):Promise['resolve'](_0x30e33d);},AuthorizeHandler['prototype'][_0x408b92(0x135)]=function(_0x355234){var _0x6fb104=_0x408b92,_0x44fe7b={'gbetd':'Invalid\x20parameter:\x20`scope`'},_0x1de244=_0x355234[_0x6fb104(0x175)][_0x6fb104(0x14f)]||_0x355234['query'][_0x6fb104(0x14f)];if(!is['nqschar'](_0x1de244))throw new InvalidScopeError(_0x44fe7b[_0x6fb104(0x117)]);return _0x1de244;},AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x116)]=function(_0x5e2b17){var _0x29a270=_0x408b92,_0x3058d1={'EoKCO':_0x29a270(0x14c),'LnIGM':'Invalid\x20parameter:\x20`state`'},_0x109154=_0x5e2b17[_0x29a270(0x175)][_0x29a270(0x132)]||_0x5e2b17[_0x29a270(0x193)]['state'];if(!this['allowEmptyState']&&!_0x109154)throw new InvalidRequestError(_0x3058d1[_0x29a270(0x16c)]);if(!is['vschar'](_0x109154))throw new InvalidRequestError(_0x3058d1[_0x29a270(0x17a)]);return _0x109154;},AuthorizeHandler['prototype'][_0x408b92(0x12d)]=function(_0x5999e2,_0x253266){var _0x4c4da2=_0x408b92,_0x1cda23={'LrKVk':_0x4c4da2(0x14c),'SAyOe':function(_0x39b365,_0x39be22){return _0x39b365===_0x39be22;},'PlNMl':'tArRA','BQRPX':_0x4c4da2(0x167),'VhcTm':function(_0x3dc5f9,_0x31d701,_0x6d206e){return _0x3dc5f9(_0x31d701,_0x6d206e);}};if(this[_0x4c4da2(0x154)]instanceof AuthenticateHandler)return this[_0x4c4da2(0x154)][_0x4c4da2(0x166)](_0x5999e2,_0x253266)[_0x4c4da2(0x183)](_0x4c4da2(0x160));return _0x1cda23[_0x4c4da2(0x130)](promisify,this[_0x4c4da2(0x154)][_0x4c4da2(0x166)],0x2)(_0x5999e2,_0x253266)[_0x4c4da2(0x153)](function(_0x2f5984){var _0x7656a8=_0x4c4da2;if(!_0x2f5984){if(_0x1cda23[_0x7656a8(0x16f)](_0x7656a8(0x18c),_0x1cda23[_0x7656a8(0x150)])){var _0x56fe32=_0x165f7e['body'][_0x7656a8(0x132)]||_0x31ce9f[_0x7656a8(0x193)][_0x7656a8(0x132)];if(!this[_0x7656a8(0x149)]&&!_0x56fe32)throw new _0xc8866b(_0x1cda23['LrKVk']);if(!_0x10fece[_0x7656a8(0x146)](_0x56fe32))throw new _0x4ec530(_0x7656a8(0x144));return _0x56fe32;}else throw new ServerError(_0x1cda23[_0x7656a8(0x11c)]);}return _0x2f5984;});},AuthorizeHandler[_0x408b92(0x184)]['getRedirectUri']=function(_0x4088a0,_0x57111c){var _0x3412ad=_0x408b92;return _0x4088a0[_0x3412ad(0x175)]['redirect_uri']||_0x4088a0[_0x3412ad(0x193)][_0x3412ad(0x15b)]||_0x57111c['redirectUris'][0x0];},AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x169)]=function(_0x210e6a,_0x467950){var _0x47518c=_0x408b92,_0x1b7d75={'oKJjI':_0x47518c(0x168),'NUXiD':_0x47518c(0x136),'VMtWb':_0x47518c(0x191),'QLkdj':_0x47518c(0x13e)},_0x311128=_0x1b7d75['oKJjI'][_0x47518c(0x17b)]('|'),_0x245fe0=0x0;while(!![]){switch(_0x311128[_0x245fe0++]){case'0':var _0x2aab10=_0x210e6a[_0x47518c(0x175)][_0x47518c(0x13f)]||_0x210e6a[_0x47518c(0x193)]['response_type'];continue;case'1':if(!_0x2aab10)throw new InvalidRequestError(_0x1b7d75[_0x47518c(0x148)]);continue;case'2':if(!_['has'](responseTypes,_0x2aab10))throw new UnsupportedResponseTypeError(_0x47518c(0x170));continue;case'3':return responseTypes[_0x2aab10];case'4':if(_0x2aab10===_0x47518c(0x16e)&&(!_0x467950||!_[_0x47518c(0x179)](_0x467950['grants'],_0x1b7d75[_0x47518c(0x12c)])))throw new UnauthorizedClientError(_0x1b7d75['QLkdj']);continue;}break;}},AuthorizeHandler[_0x408b92(0x184)][_0x408b92(0x127)]=function(_0x440417,_0x30513f){var _0xeeb278=_0x408b92,_0x296445=url[_0xeeb278(0x173)](_0x440417);return _0x30513f[_0xeeb278(0x197)](_0x296445);},AuthorizeHandler[_0x408b92(0x184)]['buildErrorRedirectUri']=function(_0x414c48,_0xf0dc27,_0x5df559){var _0x1a8087=_0x408b92,_0x4e27f3={'Jjovi':_0x1a8087(0x11e),'slSTB':_0x1a8087(0x12b),'lSqew':_0x1a8087(0x181),'BCvbk':function(_0x527cbc,_0x336227){return _0x527cbc!==_0x336227;},'fkJoT':_0x1a8087(0x195)},_0x5400b0=url[_0x1a8087(0x173)](_0x414c48);if(_0xf0dc27)_0x5400b0=_0xf0dc27[_0x1a8087(0x182)](_0x5400b0,_0x4e27f3[_0x1a8087(0x196)],_0x5df559[_0x1a8087(0x115)]),_0x5df559[_0x1a8087(0x18b)]&&(_0x5400b0=_0xf0dc27[_0x1a8087(0x182)](_0x5400b0,_0x1a8087(0x18a),_0x5df559[_0x1a8087(0x18b)]));else{_0x5400b0[_0x1a8087(0x193)]={'error':_0x5df559['name']};if(_0x5df559['message']){if(_0x4e27f3[_0x1a8087(0x131)](_0x1a8087(0x195),_0x4e27f3[_0x1a8087(0x163)])){var _0xe4daa1='4|0|1|3|7|2|5|6'[_0x1a8087(0x17b)]('|'),_0x3ac6be=0x0;while(!![]){switch(_0xe4daa1[_0x3ac6be++]){case'0':if(_0x4d1fc5['authenticateHandler']&&!_0x477780[_0x1a8087(0x154)][_0x1a8087(0x166)])throw new _0xf8b85a(_0x4e27f3['Jjovi']);continue;case'1':if(!_0x5f39ab[_0x1a8087(0x165)])throw new _0x2bb83e('Missing\x20parameter:\x20`model`');continue;case'2':this[_0x1a8087(0x149)]=_0x45d219['allowEmptyState'];continue;case'3':if(!_0x5a18fe['model'][_0x1a8087(0x129)])throw new _0x58f2c2(_0x4e27f3[_0x1a8087(0x162)]);continue;case'4':_0x5dec72=_0x90b91d||{};continue;case'5':this[_0x1a8087(0x154)]=_0x1043fc[_0x1a8087(0x154)]||new _0x35c7f8(_0x378e3c);continue;case'6':this[_0x1a8087(0x165)]=_0x5e9820['model'];continue;case'7':this[_0x1a8087(0x187)]=_0x12a797;continue;}break;}}else _0x5400b0[_0x1a8087(0x193)][_0x1a8087(0x18a)]=_0x5df559[_0x1a8087(0x18b)];}}return _0x5400b0;},AuthorizeHandler[_0x408b92(0x184)]['updateResponse']=function(_0x25a0d3,_0x37caf4,_0x21d8b8,_0x152557){var _0x5d09ea=_0x408b92,_0x3b5e05={'zqMvG':_0x5d09ea(0x132),'oOeGM':_0x5d09ea(0x11d),'OcfUe':'AJgOB'};if(_0x21d8b8&&_0x152557)_0x37caf4=_0x21d8b8['setRedirectUriParam'](_0x37caf4,_0x3b5e05[_0x5d09ea(0x158)],_0x152557);else{if(_0x152557){if(_0x3b5e05[_0x5d09ea(0x137)]===_0x3b5e05['OcfUe'])throw new _0x333e61(_0x5d09ea(0x139));else _0x37caf4[_0x5d09ea(0x193)]=_0x37caf4['query']||{},_0x37caf4[_0x5d09ea(0x193)][_0x5d09ea(0x132)]=_0x152557;}}_0x25a0d3[_0x5d09ea(0x156)](url[_0x5d09ea(0x161)](_0x37caf4));},module['exports']=AuthorizeHandler;