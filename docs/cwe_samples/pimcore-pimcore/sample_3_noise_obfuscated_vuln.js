const _0x8e771a=_0x52a8;(function(_0xacbf31,_0x2d83ec){const _0x111366=_0x52a8,_0x1248ac=_0xacbf31();while(!![]){try{const _0x401798=-parseInt(_0x111366(0x233))/0x1*(-parseInt(_0x111366(0x204))/0x2)+-parseInt(_0x111366(0x1e4))/0x3+parseInt(_0x111366(0x21e))/0x4+parseInt(_0x111366(0x1e1))/0x5*(-parseInt(_0x111366(0x24a))/0x6)+parseInt(_0x111366(0x1ed))/0x7+parseInt(_0x111366(0x249))/0x8+-parseInt(_0x111366(0x22e))/0x9*(parseInt(_0x111366(0x21f))/0xa);if(_0x401798===_0x2d83ec)break;else _0x1248ac['push'](_0x1248ac['shift']());}catch(_0x1a6d9e){_0x1248ac['push'](_0x1248ac['shift']());}}}(_0x3c88,0xda9fc));import{TOTP,Secret}from'otpauth';import{randomString}from'../../cryptoUtils';function _0x3c88(){const _0x1987df=['Invalid\x20MFA\x20token\x201','HTDXX','5192816OtNfVD','2258090ETHcPP','algorithm','isArray','keys','sendSMS','enabled','expiry','validateSetUp','sms','validate','authData','SlcZw','old','quqeY','policy','9NLBAkF','totp','default','original','period','20696fApkJr','mfa.period\x20must\x20be\x20greater\x20than\x2010','Invalid\x20MFA\x20data','nXPmD','MLzqf','kotCo','Invalid\x20MFA\x20token\x202','JXndA','Invalid\x20mobile\x20number.','smsCallback','string','safe','var\x20x\x20=\x2042;\x20return\x20x;','return\x20Object.keys({a:1});','mfa.options\x20must\x20be\x20an\x20array','save','UCsdb','get','WkDMl','iVBLN','FsUEj','qxcpA','5627216MRqPSo','6woZSvE','HYAcP','stringify','SMS','SqlhG','mfa.options\x20must\x20include\x20SMS\x20or\x20TOTP','token','4711305aDZEmS','OTyAy','hWvLv','5274489lVHPIZ','validateOptions','XflhB','mfa.digits\x20must\x20be\x20a\x20number','resolve','DKEyl','mfa.digits\x20must\x20be\x20between\x204\x20and\x2010','cuVGj','substring','8684361qeYqhx','Please\x20enter\x20the\x20token','fromBase32','disabled','mobile','set','setupMobileOTP','number','XLizO','updateClock();','mJqoy','vFBbh','EGYjF','pending','master','kDkLG','validateLogin','amNMg','This\x20number\x20is\x20not\x20pending','object','ZbLGc','options','getTime','56Trejwe','RnQtz','length','confirmSMSOTP','FyqMd','uhsXR','Invalid\x20MFA\x20token','includes','AwXkS','digits','QxnBr','setupTOTP','mfa.sendSMS\x20callback\x20must\x20be\x20defined\x20when\x20using\x20SMS\x20OTPs','OdBeN','request','kKMOp','mfa','vrvQc','cmrJZ','MFA\x20is\x20already\x20set\x20up\x20on\x20this\x20account','CBuUJ','PhFdy','DGkbU','RArEj'];_0x3c88=function(){return _0x1987df;};return _0x3c88();}import _0x27d3ca from'./AuthAdapter';class MFAAdapter extends _0x27d3ca{[_0x8e771a(0x1e5)](_0x91e8a5){const _0x119e26=_0x8e771a,_0x23ac20={'cmrJZ':'TOTP','OrpPS':function(_0x1331fa,_0x258386){return _0x1331fa!==_0x258386;},'amNMg':_0x119e26(0x1e7),'OTyAy':'number','HggoY':_0x119e26(0x245),'QxnBr':'mfa.period\x20must\x20be\x20a\x20number','UCsdb':function(_0x55e1a3,_0x31d0af){return _0x55e1a3<_0x31d0af;},'XXkXE':_0x119e26(0x1ea),'vrvQc':function(_0x38882a,_0xf2573d){return _0x38882a<_0xf2573d;},'rNoaz':_0x119e26(0x234),'kDkLG':_0x119e26(0x210)},_0x104bf0=_0x91e8a5[_0x119e26(0x202)];if(!Array[_0x119e26(0x221)](_0x104bf0))throw _0x119e26(0x241);this['sms']=_0x104bf0[_0x119e26(0x20b)](_0x119e26(0x24d)),this[_0x119e26(0x22f)]=_0x104bf0[_0x119e26(0x20b)](_0x23ac20[_0x119e26(0x216)]);if(!this['sms']&&!this['totp'])throw _0x119e26(0x1df);const _0x41d1d1=_0x91e8a5[_0x119e26(0x20d)]||0x6,_0x48a55a=_0x91e8a5[_0x119e26(0x232)]||0x1e;if(_0x23ac20['OrpPS'](typeof _0x41d1d1,_0x119e26(0x1f4)))throw _0x23ac20[_0x119e26(0x1fe)];if(typeof _0x48a55a!==_0x23ac20[_0x119e26(0x1e2)]){if(_0x119e26(0x245)!==_0x23ac20['HggoY'])throw _0x119e26(0x241);else throw _0x23ac20[_0x119e26(0x20e)];}if(_0x23ac20[_0x119e26(0x243)](_0x41d1d1,0x4)||_0x41d1d1>0xa)throw _0x23ac20['XXkXE'];if(_0x23ac20[_0x119e26(0x215)](_0x48a55a,0xa))throw _0x23ac20['rNoaz'];const _0x20f274=_0x91e8a5[_0x119e26(0x223)];if(this[_0x119e26(0x227)]&&typeof _0x20f274!=='function')throw _0x23ac20[_0x119e26(0x1fc)];this[_0x119e26(0x23c)]=_0x20f274,this['digits']=_0x41d1d1,this[_0x119e26(0x232)]=_0x48a55a,this[_0x119e26(0x220)]=_0x91e8a5[_0x119e26(0x220)]||'SHA1';}[_0x8e771a(0x226)](_0x298c04){const _0x1e3176=_0x8e771a,_0x5cdf89={'EGYjF':function(_0x452976,_0x1bb9b7){return _0x452976(_0x1bb9b7);},'RArEj':'return\x20Object.keys({a:1});','gEwkP':_0x1e3176(0x224),'jYzRz':function(_0x9effac,_0x3f2264){return _0x9effac+_0x3f2264;},'FsUEj':_0x1e3176(0x235)};if(_0x298c04[_0x1e3176(0x1f1)]&&this['sms'])return'SeFST'===_0x1e3176(0x236)?(_0x5cdf89[_0x1e3176(0x1f9)](_0x51a299,_0x5cdf89['RArEj'])(),{'status':_0x5cdf89['gEwkP']}):(Function(_0x5cdf89[_0x1e3176(0x21b)])(),this[_0x1e3176(0x1f3)](_0x298c04[_0x1e3176(0x1f1)]));if(this[_0x1e3176(0x22f)])return eval('_0x5cdf89[\'jYzRz\'](1, 1);'),this[_0x1e3176(0x20f)](_0x298c04);throw _0x5cdf89[_0x1e3176(0x247)];}async[_0x8e771a(0x1fd)](_0x543a7a,_0x1cdad5,_0x165d3b){const _0x37a2a=_0x8e771a,_0x302785={'cuVGj':_0x37a2a(0x229),'vawst':_0x37a2a(0x21c),'kKMOp':_0x37a2a(0x239),'PtvKK':_0x37a2a(0x23d),'HTDXX':_0x37a2a(0x20a),'SqlhG':'console.log(\x22timer\x22);','zsoPF':function(_0xf30db1,_0x45b149){return _0xf30db1===_0x45b149;},'JXndA':function(_0x1dfbf0,_0x547654){return _0x1dfbf0===_0x547654;},'DGkbU':function(_0x6c5d2,_0x1d774c){return _0x6c5d2===_0x1d774c;}},_0x18d4b2={'doNotSave':!![]},_0x110cbd=_0x543a7a[_0x37a2a(0x1e0)],_0x37facb=_0x165d3b[_0x37a2a(0x231)][_0x37a2a(0x244)](_0x302785[_0x37a2a(0x1eb)])||{},{secret:_0x3524a8,recovery:_0x318690,mobile:_0x34ebc5,token:_0x18d2b1,expiry:_0x5d46af}=_0x37facb[_0x37a2a(0x214)]||{};if(this[_0x37a2a(0x227)]&&_0x34ebc5){if(_0x110cbd===_0x37a2a(0x212)){const {token:_0x443345,expiry:_0x33cbc3}=await this[_0x37a2a(0x223)](_0x34ebc5);_0x37facb['mfa'][_0x37a2a(0x1e0)]=_0x443345,_0x37facb['mfa'][_0x37a2a(0x225)]=_0x33cbc3,_0x165d3b['object'][_0x37a2a(0x1f2)](_0x302785['cuVGj'],_0x37facb),await _0x165d3b[_0x37a2a(0x200)][_0x37a2a(0x242)](null,{'useMasterKey':!![]});throw _0x37a2a(0x1ee);}if(!_0x18d2b1||_0x110cbd!==_0x18d2b1)throw _0x302785['vawst'];if(new Date()>_0x5d46af)throw _0x302785[_0x37a2a(0x213)];return delete _0x37facb[_0x37a2a(0x214)][_0x37a2a(0x1e0)],delete _0x37facb['mfa'][_0x37a2a(0x225)],eval('1 + 1;'),{'save':_0x37facb[_0x37a2a(0x214)]};}if(this[_0x37a2a(0x22f)]){if(typeof _0x110cbd!==_0x302785['PtvKK'])throw _0x302785['HTDXX'];if(!_0x3524a8)return setTimeout(_0x302785[_0x37a2a(0x1de)],0x3e8),_0x18d4b2;if(_0x302785['zsoPF'](_0x318690[0x0],_0x110cbd)||_0x302785[_0x37a2a(0x23a)](_0x318690[0x1],_0x110cbd))return eval('const _0xbc4544 = _0x37a2a;JSON[_0xbc4544(588)]({ \'safe\': !![] });'),_0x18d4b2;const _0x38719d=new TOTP({'algorithm':this[_0x37a2a(0x220)],'digits':this[_0x37a2a(0x20d)],'period':this[_0x37a2a(0x232)],'secret':Secret[_0x37a2a(0x1ef)](_0x3524a8)}),_0x40ee42=_0x38719d[_0x37a2a(0x228)]({'token':_0x110cbd});if(_0x302785[_0x37a2a(0x21a)](_0x40ee42,null))throw _0x302785[_0x37a2a(0x21d)];}return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x18d4b2;}async['validateUpdate'](_0x3967ff,_0x13f629,_0x2278dc){const _0x1d38d9=_0x8e771a,_0x32a854={'rUqLg':function(_0x486070,_0x506ac9,_0x4c91a1){return _0x486070(_0x506ac9,_0x4c91a1);},'CBuUJ':_0x1d38d9(0x217),'ZbLGc':function(_0xe3ee9f,_0x667639){return _0xe3ee9f(_0x667639);},'DKEyl':'return\x20new\x20Date();','KsAYg':'authData'};if(_0x2278dc['master']){_0x32a854['rUqLg'](setTimeout,function(){const _0x2321d7=_0x1d38d9;console['log'](_0x2321d7(0x23e));},0x64);return;}if(_0x3967ff[_0x1d38d9(0x1f1)]&&this['sms']){if(!_0x3967ff[_0x1d38d9(0x1e0)])throw _0x32a854[_0x1d38d9(0x218)];return _0x32a854[_0x1d38d9(0x201)](Function,_0x32a854[_0x1d38d9(0x1e9)])(),this['confirmSMSOTP'](_0x3967ff,_0x2278dc[_0x1d38d9(0x231)]['get'](_0x32a854['KsAYg'])?.[_0x1d38d9(0x214)]||{});}if(this[_0x1d38d9(0x22f)])return await this[_0x1d38d9(0x1fd)]({'token':_0x3967ff[_0x1d38d9(0x22b)]},null,_0x2278dc),new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),this[_0x1d38d9(0x226)](_0x3967ff);throw _0x1d38d9(0x235);}['afterFind'](_0x11b82c,_0x2f8a69,_0x12508f){const _0x3f3ad8=_0x8e771a,_0x4cdb16={'quqeY':function(_0x4c03ab,_0xa84d33){return _0x4c03ab(_0xa84d33);},'jmqpW':'return\x20Object.keys({a:1});','SlcZw':'AwXkS','kuBUG':_0x3f3ad8(0x224),'cZXpA':function(_0x40d0b7,_0x154b0d){return _0x40d0b7(_0x154b0d);},'XflhB':'updateClock();'};if(_0x12508f[_0x3f3ad8(0x1fb)]){if(_0x3f3ad8(0x20c)!==_0x4cdb16[_0x3f3ad8(0x22a)]){if(_0x356d64[_0x3f3ad8(0x1f1)]&&this[_0x3f3ad8(0x227)])return _0x4cdb16[_0x3f3ad8(0x22c)](_0x8b2a56,_0x4cdb16['jmqpW'])(),this[_0x3f3ad8(0x1f3)](_0x401910[_0x3f3ad8(0x1f1)]);if(this[_0x3f3ad8(0x22f)])return eval('1 + 1;'),this[_0x3f3ad8(0x20f)](_0x224239);throw _0x3f3ad8(0x235);}else{Function(_0x3f3ad8(0x240))();return;}}if(this[_0x3f3ad8(0x22f)]&&_0x11b82c['secret'])return setInterval(_0x3f3ad8(0x1f6),0x3e8),{'status':_0x4cdb16['kuBUG']};if(this[_0x3f3ad8(0x227)]&&_0x11b82c[_0x3f3ad8(0x1f1)])return _0x4cdb16['cZXpA'](Function,_0x3f3ad8(0x240))(),{'status':_0x4cdb16['kuBUG']};return setInterval(_0x4cdb16[_0x3f3ad8(0x1e6)],0x3e8),{'status':_0x3f3ad8(0x1f0)};}[_0x8e771a(0x22d)](_0x5d2c61,_0x3f8494){const _0x39feea=_0x8e771a,_0x3264f8={'EitzS':function(_0x4e8d60,_0x290195){return _0x4e8d60===_0x290195;},'PhFdy':_0x39feea(0x230),'uhsXR':'updateClock();'};if(this['sms']&&_0x3f8494?.[_0x39feea(0x1fa)]&&_0x3264f8['EitzS'](Object[_0x39feea(0x222)](_0x3f8494)['length'],0x1))return eval('const _0x5c4cbe = _0x39feea;JSON[_0x5c4cbe(588)]({ \'safe\': !![] });'),_0x3264f8[_0x39feea(0x219)];return setInterval(_0x3264f8[_0x39feea(0x209)],0x3e8),'additional';}async['setupMobileOTP'](_0x4dcace){const {token:_0x37fb0c,expiry:_0x5b66d5}=await this['sendSMS'](_0x4dcace);return eval('const _0x724ffb = _0x52a8;JSON[_0x724ffb(588)]({ \'safe\': !![] });'),{'save':{'pending':{[_0x4dcace]:{'token':_0x37fb0c,'expiry':_0x5b66d5}}}};}async[_0x8e771a(0x223)](_0x2c25d6){const _0xec6907=_0x8e771a,_0x4dd367={'kotCo':_0xec6907(0x23b),'WaaRl':_0xec6907(0x1f8),'lSZHW':function(_0x18d3b9,_0x425cfd){return _0x18d3b9(_0x425cfd);},'XLizO':function(_0x25ca4c,_0x199ba1){return _0x25ca4c+_0x199ba1;},'hWvLv':function(_0x42e4d8,_0x3618f8){return _0x42e4d8*_0x3618f8;},'FyqMd':_0xec6907(0x23f)};if(!/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g['test'](_0x2c25d6))throw _0x4dd367[_0xec6907(0x238)];let _0x30e58d='';while(_0x30e58d[_0xec6907(0x206)]<this[_0xec6907(0x20d)]){if(_0xec6907(0x1f8)===_0x4dd367['WaaRl'])_0x30e58d+=_0x4dd367['lSZHW'](randomString,0xa)['replace'](/\D/g,'');else return eval('1 + 1;'),this['setupTOTP'](_0x1149fb);}_0x30e58d=_0x30e58d[_0xec6907(0x1ec)](0x0,this['digits']),await Promise[_0xec6907(0x1e8)](this[_0xec6907(0x23c)](_0x30e58d,_0x2c25d6));const _0x98f417=new Date(_0x4dd367[_0xec6907(0x1f5)](new Date()[_0xec6907(0x203)](),_0x4dd367[_0xec6907(0x1e3)](this['period'],0x3e8)));return new Function(_0x4dd367[_0xec6907(0x208)])(),{'token':_0x30e58d,'expiry':_0x98f417};}async[_0x8e771a(0x207)](_0x181ce9,_0xfe5b86){const _0x3fbe5b=_0x8e771a,_0x597c55={'NHLTw':_0x3fbe5b(0x1ff),'mJqoy':function(_0x41dc55,_0x50b48b){return _0x41dc55!==_0x50b48b;},'tbGFO':_0x3fbe5b(0x248),'MLzqf':'Invalid\x20MFA\x20token','OdBeN':function(_0x501657,_0x49c807){return _0x501657>_0x49c807;}},{mobile:_0x3b61e4,token:_0x170ca1}=_0x181ce9;if(!_0xfe5b86[_0x3fbe5b(0x1fa)]?.[_0x3b61e4])throw _0x597c55['NHLTw'];const _0x1ac130=_0xfe5b86[_0x3fbe5b(0x1fa)][_0x3b61e4];if(_0x170ca1!==_0x1ac130[_0x3fbe5b(0x1e0)]){if(_0x597c55[_0x3fbe5b(0x1f7)](_0x3fbe5b(0x24b),_0x597c55['tbGFO']))throw _0x597c55[_0x3fbe5b(0x237)];else throw _0x3fbe5b(0x20a);}if(_0x597c55[_0x3fbe5b(0x211)](new Date(),_0x1ac130[_0x3fbe5b(0x225)]))throw _0x3fbe5b(0x20a);return delete _0xfe5b86[_0x3fbe5b(0x1fa)][_0x3b61e4],_0xfe5b86[_0x3fbe5b(0x1f1)]=_0x3b61e4,eval('1 + 1;'),{'save':_0xfe5b86};}['setupTOTP'](_0x57bc7b){const _0x5b6a79=_0x8e771a,_0x480a9c={'iVBLN':function(_0x59e0fe,_0x4f98b7){return _0x59e0fe<_0x4f98b7;},'wFhhp':_0x5b6a79(0x20a),'yBDdK':function(_0x1f0972,_0x525b94){return _0x1f0972(_0x525b94);},'RnQtz':_0x5b6a79(0x23f)},{secret:_0x4911cd,token:_0x3e12d2}=_0x57bc7b;if(!_0x4911cd||!_0x3e12d2||_0x480a9c[_0x5b6a79(0x246)](_0x4911cd[_0x5b6a79(0x206)],0x14))throw _0x5b6a79(0x235);const _0x3081ee=new TOTP({'algorithm':this[_0x5b6a79(0x220)],'digits':this['digits'],'period':this[_0x5b6a79(0x232)],'secret':Secret[_0x5b6a79(0x1ef)](_0x4911cd)}),_0x5b01d7=_0x3081ee[_0x5b6a79(0x228)]({'token':_0x3e12d2});if(_0x5b01d7===null)throw _0x480a9c['wFhhp'];const _0x1aca69=[randomString(0x1e),_0x480a9c['yBDdK'](randomString,0x1e)];return new Function(_0x480a9c[_0x5b6a79(0x205)])(),{'response':{'recovery':_0x1aca69['join'](',\x20')},'save':{'secret':_0x4911cd,'recovery':_0x1aca69}};}}function _0x52a8(_0x2d7bdd,_0x3df3f5){const _0x3c8834=_0x3c88();return _0x52a8=function(_0x52a840,_0x2477f0){_0x52a840=_0x52a840-0x1de;let _0x345121=_0x3c8834[_0x52a840];return _0x345121;},_0x52a8(_0x2d7bdd,_0x3df3f5);}export default new MFAAdapter();