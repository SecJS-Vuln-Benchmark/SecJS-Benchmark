function _0x16b7(_0x2d4058,_0x462d2a){const _0xbba411=_0xbba4();return _0x16b7=function(_0x16b732,_0x4cdef2){_0x16b732=_0x16b732-0x1f2;let _0xe0b59b=_0xbba411[_0x16b732];return _0xe0b59b;},_0x16b7(_0x2d4058,_0x462d2a);}const _0xb6014e=_0x16b7;function _0xbba4(){const _0x5cf7d5=['/users','/requestPasswordReset','http://localhost:8378/1/classes/_User/','10oaujCA','/users/me','poArl','hIHYa','zhqFW','status','6998540crTvkL','ECGsN','upNFu','195uTtacM','POST','ywOaK','deLZA','stringify','186426mhZHCP','vfBEj','toEqual','PZegd','iryKP','BGFnu','get','_email_verify_token','message','application/json','/apps/test/verify_email?token[$regex]=','http://localhost:8378/1','EUyHT','newpassword','iazCd','7040816jRJImP','lQpfk','should\x20not\x20work','RPakq','lQZbM','XfKEj','sessionToken','bSULh','headers','Query','1054746cjHmLa','test2','Error','QTXLs','rLzka','emailVerified','error','sglZT','WUybb','GAJlR','OBJECT_NOT_FOUND','26142QxfoIq','somepassword','IrRNJ','/apps/test/request_password_reset?token[$regex]=','leQfy','WjpcL','location','objectId','User','92bbb86d-bcda-49fa-8d79-aa0501078044','fWIBq','63bCNrzZ','lDHnJ','data','/apps/test/request_password_reset','fetch','731629PGBDXc','on\x20session\x20token','\x5c/choose\x5c_password\x5c?token\x5c=','logIn','284740aDMByh','guCbr','should\x20work\x20with\x20plain\x20token','GET','code','11cZNLdk','Sbonl','KRyWB','FSChV','test','someemail@somedomain.com','then','Invalid\x20username/password.','resolve','rALUQ','/apps/test/request_password_reset?token=','on\x20password\x20reset','should\x20not\x20work\x20with\x20regex'];_0xbba4=function(){return _0x5cf7d5;};return _0xbba4();}(function(_0x152037,_0x171ef5){const _0x574433=_0x16b7,_0x244cc1=_0x152037();while(!![]){try{const _0x3d36ad=-parseInt(_0x574433(0x225))/0x1+-parseInt(_0x574433(0x215))/0x2*(-parseInt(_0x574433(0x247))/0x3)+parseInt(_0x574433(0x229))/0x4*(-parseInt(_0x574433(0x23e))/0x5)+parseInt(_0x574433(0x24c))/0x6*(parseInt(_0x574433(0x220))/0x7)+parseInt(_0x574433(0x200))/0x8+parseInt(_0x574433(0x20a))/0x9+parseInt(_0x574433(0x244))/0xa*(-parseInt(_0x574433(0x22e))/0xb);if(_0x3d36ad===_0x171ef5)break;else _0x244cc1['push'](_0x244cc1['shift']());}catch(_0x4a3289){_0x244cc1['push'](_0x244cc1['shift']());}}}(_0xbba4,0x86ef9));const request=require('../lib/request'),serverURL=_0xb6014e(0x1fc),headers={'Content-Type':_0xb6014e(0x1fa)},keys={'_ApplicationId':_0xb6014e(0x232),'_JavaScriptKey':_0xb6014e(0x232)},emailAdapter={'sendVerificationEmail':()=>Promise['resolve'](),'sendPasswordResetEmail':()=>Promise[_0xb6014e(0x236)](),'sendMail':()=>{}},appName=_0xb6014e(0x232),publicServerURL=_0xb6014e(0x1fc);describe('Regex\x20Vulnerabilities',()=>{const _0x406212=_0xb6014e,_0x403671={'Ugkeh':function(_0x5b5828,_0x210d7c){return _0x5b5828(_0x210d7c);},'vfBEj':_0x406212(0x248),'XfKEj':_0x406212(0x233),'zhqFW':'GET','lQZbM':function(_0x5e2e22,_0x441eca){return _0x5e2e22(_0x441eca);},'hIHYa':function(_0x1abaa8,_0x2cec8c,_0x49938a){return _0x1abaa8(_0x2cec8c,_0x49938a);},'BGFnu':_0x406212(0x22b),'rALUQ':_0x406212(0x20f),'cpOKU':_0x406212(0x20b),'fWIBq':_0x406212(0x23a),'ECGsN':_0x406212(0x21e),'KRyWB':function(_0x370a9a,_0x36fd95){return _0x370a9a(_0x36fd95);},'kNdOi':'test','VUkRS':function(_0x218c39,_0x46d2c1){return _0x218c39(_0x46d2c1);},'Sbonl':function(_0x175028,_0x2d57f5){return _0x175028(_0x2d57f5);},'dIAYJ':function(_0x4cc52f,_0x332b24){return _0x4cc52f(_0x332b24);},'lQpfk':_0x406212(0x1fe),'ywOaK':function(_0x22f035,_0x2aca48){return _0x22f035(_0x2aca48);},'leQfy':_0x406212(0x202),'WjpcL':_0x406212(0x235),'IrRNJ':function(_0x538e97,_0x36a928){return _0x538e97(_0x36a928);},'upNFu':_0x406212(0x226),'PZegd':function(_0x581d94,_0x2ec5ab,_0x4cddfc){return _0x581d94(_0x2ec5ab,_0x4cddfc);},'EUyHT':_0x406212(0x239)};let _0x49fcee,_0x24b969,_0x5f0f64,_0x5d9276;_0x403671[_0x406212(0x217)](beforeEach,async()=>{const _0x16cfb1=_0x406212;await reconfigureServer({'maintenanceKey':'test2','verifyUserEmails':!![],'emailAdapter':emailAdapter,'appName':appName,'publicServerURL':publicServerURL});const _0x5a6f1c=await _0x403671['Ugkeh'](request,{'url':serverURL+_0x16cfb1(0x23b),'method':_0x403671[_0x16cfb1(0x1f2)],'headers':headers,'body':JSON[_0x16cfb1(0x24b)]({...keys,'_method':_0x16cfb1(0x248),'username':_0x16cfb1(0x233),'password':_0x16cfb1(0x216),'email':_0x403671['XfKEj']})});_0x49fcee=_0x5a6f1c['data'][_0x16cfb1(0x21c)],_0x24b969=_0x5a6f1c[_0x16cfb1(0x222)][_0x16cfb1(0x206)],_0x5f0f64=_0x24b969['slice'](0x0,0x3);}),describe(_0x403671[_0x406212(0x246)],()=>{const _0x31df27=_0x406212,_0x476aed={'QTXLs':function(_0x56ef7d,_0x7ca6d8){return _0x56ef7d(_0x7ca6d8);},'rLzka':_0x31df27(0x202),'poArl':_0x403671['zhqFW'],'bSULh':function(_0xdfb2c9,_0x5819da){const _0x49674b=_0x31df27;return _0x403671[_0x49674b(0x204)](_0xdfb2c9,_0x5819da);}};it(_0x31df27(0x23a),async()=>{const _0x5e2610=_0x31df27;try{await _0x476aed['QTXLs'](request,{'url':serverURL+_0x5e2610(0x23f),'method':_0x5e2610(0x248),'headers':headers,'body':JSON[_0x5e2610(0x24b)]({...keys,'_SessionToken':{'$regex':_0x5f0f64},'_method':_0x5e2610(0x22c)})}),fail(_0x476aed[_0x5e2610(0x20e)]);}catch(_0x221a0c){expect(_0x221a0c[_0x5e2610(0x222)][_0x5e2610(0x22d)])[_0x5e2610(0x1f3)](0xd1),expect(_0x221a0c[_0x5e2610(0x222)][_0x5e2610(0x210)])[_0x5e2610(0x1f3)]('Invalid\x20session\x20token');}}),_0x403671[_0x31df27(0x241)](it,_0x403671[_0x31df27(0x1f6)],async()=>{const _0x5dac86=_0x31df27,_0x177801=await request({'url':serverURL+_0x5dac86(0x23f),'method':_0x5dac86(0x248),'headers':headers,'body':JSON['stringify']({...keys,'_SessionToken':_0x24b969,'_method':_0x476aed[_0x5dac86(0x240)]})});_0x476aed[_0x5dac86(0x20d)](expect,_0x177801['data'][_0x5dac86(0x21c)])[_0x5dac86(0x1f3)](_0x49fcee),_0x476aed[_0x5dac86(0x207)](expect,_0x177801['data'][_0x5dac86(0x206)])[_0x5dac86(0x1f3)](_0x24b969);});}),_0x403671[_0x406212(0x1f4)](describe,'on\x20verify\x20e-mail',()=>{const _0x4c564=_0x406212,_0x1f5b27={'UvSju':function(_0x3a8060,_0x34b5a6){return _0x3a8060(_0x34b5a6);},'sglZT':_0x403671[_0x4c564(0x237)],'deLZA':_0x403671[_0x4c564(0x242)],'ebOXc':function(_0x49942d,_0x3874a5){return _0x49942d(_0x3874a5);},'GAJlR':_0x4c564(0x232),'iazCd':_0x403671['cpOKU'],'eacXf':function(_0x49e98e,_0x52de32){const _0x3fe363=_0x4c564;return _0x403671[_0x3fe363(0x204)](_0x49e98e,_0x52de32);}};_0x403671['lQZbM'](beforeEach,async function(){const _0x761915=_0x4c564,_0x1439a6=new Parse[(_0x761915(0x209))](Parse['User']);_0x5d9276=await _0x1439a6[_0x761915(0x1f7)](_0x49fcee,{'useMasterKey':!![]});}),it(_0x403671[_0x4c564(0x21f)],async()=>{const _0x3b21f7=_0x4c564;_0x1f5b27['UvSju'](expect,_0x5d9276[_0x3b21f7(0x1f7)](_0x1f5b27['sglZT']))[_0x3b21f7(0x1f3)](![]),await request({'url':serverURL+_0x3b21f7(0x1fb),'method':_0x1f5b27[_0x3b21f7(0x24a)]}),await _0x5d9276[_0x3b21f7(0x224)]({'useMasterKey':!![]}),_0x1f5b27['ebOXc'](expect,_0x5d9276['get'](_0x1f5b27[_0x3b21f7(0x211)]))[_0x3b21f7(0x1f3)](![]);}),it_id(_0x403671[_0x4c564(0x245)])(it)(_0x403671[_0x4c564(0x1f6)],async()=>{const _0x368b27=_0x4c564;expect(_0x5d9276['get'](_0x368b27(0x20f)))['toEqual'](![]);const _0x3bbd6a=await request({'method':_0x1f5b27[_0x368b27(0x24a)],'url':'http://localhost:8378/1/classes/_User/'+_0x5d9276['id'],'json':!![],'headers':{'X-Parse-Application-Id':_0x1f5b27[_0x368b27(0x213)],'X-Parse-Rest-API-Key':_0x368b27(0x232),'X-Parse-Maintenance-Key':_0x1f5b27[_0x368b27(0x1ff)],'Content-Type':_0x368b27(0x1fa)}})[_0x368b27(0x234)](_0x177df9=>_0x177df9[_0x368b27(0x222)]);await _0x1f5b27['UvSju'](request,{'url':serverURL+'/apps/test/verify_email?token='+_0x3bbd6a[_0x368b27(0x1f8)],'method':'GET'}),await _0x5d9276[_0x368b27(0x224)]({'useMasterKey':!![]}),_0x1f5b27['eacXf'](expect,_0x5d9276[_0x368b27(0x1f7)](_0x1f5b27[_0x368b27(0x211)]))['toEqual'](!![]);});}),describe(_0x403671[_0x406212(0x1fd)],()=>{const _0x27f3da=_0x406212,_0x4988e2={'lDHnJ':_0x27f3da(0x216),'FSChV':_0x27f3da(0x233),'WUybb':function(_0x35961d,_0x271017){const _0x4d1163=_0x27f3da;return _0x403671[_0x4d1163(0x249)](_0x35961d,_0x271017);},'iryKP':_0x27f3da(0x248),'guCbr':_0x27f3da(0x1fe),'ZZOeT':_0x403671[_0x27f3da(0x219)],'VmRkQ':function(_0x4b5f58,_0xeb09dd){return _0x4b5f58(_0xeb09dd);},'RPakq':_0x403671[_0x27f3da(0x21a)]};beforeEach(async()=>{const _0x345933=_0x27f3da;_0x5d9276=await Parse[_0x345933(0x21d)][_0x345933(0x228)](_0x345933(0x233),_0x4988e2[_0x345933(0x221)]);}),_0x403671[_0x27f3da(0x241)](it,_0x27f3da(0x23a),async()=>{const _0x473b3b=_0x27f3da;expect(_0x5d9276['id'])[_0x473b3b(0x1f3)](_0x49fcee),await request({'url':serverURL+_0x473b3b(0x23c),'method':'POST','headers':headers,'body':JSON['stringify']({...keys,'_method':_0x473b3b(0x248),'email':_0x4988e2[_0x473b3b(0x231)]})}),await _0x5d9276['fetch']({'useMasterKey':!![]});const _0x4bbb81=await request({'url':serverURL+_0x473b3b(0x218),'method':_0x473b3b(0x22c)});expect(_0x4bbb81['status'])[_0x473b3b(0x1f3)](0x12e),_0x4988e2['WUybb'](expect,_0x4bbb81[_0x473b3b(0x208)][_0x473b3b(0x21b)])['toMatch']('\x5c/invalid\x5c_link\x5c.html'),await _0x4988e2[_0x473b3b(0x212)](request,{'url':serverURL+_0x473b3b(0x223),'method':_0x4988e2[_0x473b3b(0x1f5)],'body':{'token':{'$regex':''},'username':_0x4988e2[_0x473b3b(0x231)],'new_password':_0x473b3b(0x1fe)}});try{await Parse[_0x473b3b(0x21d)][_0x473b3b(0x228)]('someemail@somedomain.com',_0x4988e2[_0x473b3b(0x22a)]),_0x4988e2[_0x473b3b(0x212)](fail,_0x4988e2['ZZOeT']);}catch(_0x2b6ab9){expect(_0x2b6ab9[_0x473b3b(0x22d)])[_0x473b3b(0x1f3)](Parse[_0x473b3b(0x20c)][_0x473b3b(0x214)]),_0x4988e2['VmRkQ'](expect,_0x2b6ab9[_0x473b3b(0x1f9)])[_0x473b3b(0x1f3)](_0x4988e2[_0x473b3b(0x203)]);}}),_0x403671[_0x27f3da(0x241)](it,_0x403671['BGFnu'],async()=>{const _0x1e4086=_0x27f3da;_0x403671[_0x1e4086(0x230)](expect,_0x5d9276['id'])[_0x1e4086(0x1f3)](_0x49fcee),await _0x403671['lQZbM'](request,{'url':serverURL+_0x1e4086(0x23c),'method':_0x403671[_0x1e4086(0x1f2)],'headers':headers,'body':JSON['stringify']({...keys,'_method':_0x403671[_0x1e4086(0x1f2)],'email':_0x403671[_0x1e4086(0x205)]})});const _0x34b32e=await _0x403671['lQZbM'](request,{'method':_0x403671[_0x1e4086(0x242)],'url':_0x1e4086(0x23d)+_0x5d9276['id'],'json':!![],'headers':{'X-Parse-Application-Id':_0x403671['kNdOi'],'X-Parse-Rest-API-Key':_0x1e4086(0x232),'X-Parse-Maintenance-Key':_0x1e4086(0x20b),'Content-Type':_0x1e4086(0x1fa)}})['then'](_0x1b43c5=>_0x1b43c5[_0x1e4086(0x222)]),_0x1d7564=_0x34b32e['_perishable_token'],_0x249ad4=await request({'url':serverURL+_0x1e4086(0x238)+_0x1d7564,'method':_0x403671[_0x1e4086(0x242)]});_0x403671['VUkRS'](expect,_0x249ad4[_0x1e4086(0x243)])[_0x1e4086(0x1f3)](0x12e),_0x403671[_0x1e4086(0x22f)](expect,_0x249ad4[_0x1e4086(0x208)][_0x1e4086(0x21b)])['toMatch'](_0x1e4086(0x227)+_0x1d7564+'\x5c&'),await _0x403671['dIAYJ'](request,{'url':serverURL+'/apps/test/request_password_reset','method':_0x403671['vfBEj'],'body':{'token':_0x1d7564,'username':_0x1e4086(0x233),'new_password':_0x403671[_0x1e4086(0x201)]}});const _0x520b1f=await Parse['User'][_0x1e4086(0x228)](_0x403671[_0x1e4086(0x205)],'newpassword');_0x403671['Sbonl'](expect,_0x520b1f['id'])[_0x1e4086(0x1f3)](_0x49fcee);});});});