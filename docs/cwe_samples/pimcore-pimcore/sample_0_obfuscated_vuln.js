'use strict';const _0x39ef93=_0x523b;(function(_0x5eb2d0,_0x5bbee8){const _0x1e8759=_0x523b,_0x253552=_0x5eb2d0();while(!![]){try{const _0x29bb05=parseInt(_0x1e8759(0xf7))/0x1*(-parseInt(_0x1e8759(0xd1))/0x2)+-parseInt(_0x1e8759(0xc9))/0x3+-parseInt(_0x1e8759(0xc1))/0x4+-parseInt(_0x1e8759(0xf3))/0x5+parseInt(_0x1e8759(0xdb))/0x6*(parseInt(_0x1e8759(0xec))/0x7)+parseInt(_0x1e8759(0xbd))/0x8+parseInt(_0x1e8759(0xef))/0x9;if(_0x29bb05===_0x5bbee8)break;else _0x253552['push'](_0x253552['shift']());}catch(_0x2a842b){_0x253552['push'](_0x253552['shift']());}}}(_0x396e,0xa49d8));var Parse=require(_0x39ef93(0xfb))[_0x39ef93(0xfd)];const https=require('https'),jwt=require(_0x39ef93(0xda)),authUtils=require('./utils'),TOKEN_ISSUER=_0x39ef93(0xf2),HTTPS_TOKEN_ISSUER=_0x39ef93(0xf5);let cache={};function getGoogleKeyByKeyId(_0x510c77){const _0x58a7cc=_0x39ef93,_0x41afb4={'BElvS':function(_0x2118b7,_0x1b1ed2){return _0x2118b7(_0x1b1ed2);},'nFYfZ':function(_0x4225b3,_0x139b34){return _0x4225b3>_0x139b34;}};if(cache[_0x510c77]&&_0x41afb4['nFYfZ'](cache[_0x58a7cc(0xea)],new Date()))return cache[_0x510c77];return new Promise((_0xac66ba,_0x3b31d2)=>{const _0x4ac22f=_0x58a7cc,_0x40b89f={'XVdEo':function(_0x5ec6f5,_0x294a63){return _0x5ec6f5+_0x294a63;},'eTJCO':function(_0x156771,_0x4077a1){const _0x4b09fd=_0x523b;return _0x41afb4[_0x4b09fd(0xcd)](_0x156771,_0x4077a1);}};https[_0x4ac22f(0xe5)](_0x4ac22f(0xd9),_0x44c324=>{const _0x230b0a=_0x4ac22f,_0x46d6d2={'DDgvF':_0x230b0a(0xfe),'BlBcu':function(_0x5cff94,_0x341e71){const _0x2adc66=_0x230b0a;return _0x40b89f[_0x2adc66(0xd4)](_0x5cff94,_0x341e71);},'HHHgl':function(_0x5e028b,_0x2458f6){const _0x5a5457=_0x230b0a;return _0x40b89f[_0x5a5457(0xbc)](_0x5e028b,_0x2458f6);}};let _0x11d818='';_0x44c324['on'](_0x230b0a(0xd8),_0x260922=>{const _0x453815=_0x230b0a;_0x11d818+=_0x260922[_0x453815(0xd6)](_0x453815(0xf4));}),_0x44c324['on'](_0x230b0a(0xbb),()=>{const _0x4289a9=_0x230b0a,{keys:_0x426cd2}=JSON[_0x4289a9(0xe9)](_0x11d818),_0x3c9475=_0x426cd2['reduce']((_0x4599c5,{n:_0x639685,e:_0x1507ce,kid:_0x426c07})=>Object['assign'](_0x4599c5,{[_0x426c07]:rsaPublicKeyToPEM(_0x639685,_0x1507ce)}),{});if(_0x44c324[_0x4289a9(0xca)][_0x46d6d2['DDgvF']]){var _0x60f921=_0x44c324[_0x4289a9(0xca)][_0x4289a9(0xfe)][_0x4289a9(0xc5)](/max-age=([0-9]+)/);_0x60f921&&(cache=Object[_0x4289a9(0xdc)]({},_0x3c9475,{'expiresAt':new Date(_0x46d6d2[_0x4289a9(0xe4)](new Date()['getTime'](),_0x46d6d2[_0x4289a9(0xc0)](Number,_0x60f921[0x1])*0x3e8))}));}_0xac66ba(_0x3c9475[_0x510c77]);});})['on'](_0x4ac22f(0xd0),_0x3b31d2);});}function _0x396e(){const _0x550cd1=['155lFiPiE','iss','id\x20token\x20not\x20authorized\x20for\x20this\x20clientId.','Error','parse/node','\x0a-----END\x20RSA\x20PUBLIC\x20KEY-----\x0a','Parse','cache-control','end','eTJCO','3265456IWqLUJ','\x20|\x20from:\x20','RDgyz','HHHgl','524988qpSJhk','-----BEGIN\x20RSA\x20PUBLIC\x20KEY-----\x0a','length','UZImi','match','HujWw','IavUk','VPXCA','3319251XCosbF','headers','OBJECT_NOT_FOUND','UlYtO','BElvS','id\x20token\x20is\x20invalid\x20for\x20this\x20user.','igwII','error','17062bmGrIH','resolve','cgJOy','XVdEo','cmcGp','toString','getTime','data','https://www.googleapis.com/oauth2/v3/certs','jsonwebtoken','6dyxjQw','assign','htdTP','qsvMh','join','XaeJw','message','\x20or\x20','coVZn','BlBcu','get','BbpnL','CHaAa','wMOim','parse','expiresAt','iqczZ','6573189McwyUG','exports','LHJNF','24226632tTQInP','sub','verify','accounts.google.com','4024120RBwDVf','utf8','https://accounts.google.com','uJTUv'];_0x396e=function(){return _0x550cd1;};return _0x396e();}async function verifyIdToken({id_token:_0x3d665a,id:_0x53e65d},{clientId:_0x3cddad}){const _0x21c877=_0x39ef93,_0x44e0aa={'BbpnL':function(_0xdc9be,_0x1ddd9b){return _0xdc9be!==_0x1ddd9b;},'qsvMh':function(_0x27cf20,_0x33bca9){return _0x27cf20!==_0x33bca9;}};if(!_0x3d665a)throw new Parse[(_0x21c877(0xfa))](Parse[_0x21c877(0xfa)][_0x21c877(0xcb)],_0x21c877(0xce));const {kid:_0x1c4904,alg:_0x510e75}=authUtils['getHeaderFromToken'](_0x3d665a);let _0x5c7e9a;const _0x5eccac=await getGoogleKeyByKeyId(_0x1c4904);try{_0x5c7e9a=jwt[_0x21c877(0xf1)](_0x3d665a,_0x5eccac,{'algorithms':_0x510e75,'audience':_0x3cddad});}catch(_0x128ce3){const _0xde6276=_0x128ce3[_0x21c877(0xe1)];throw new Parse[(_0x21c877(0xfa))](Parse[_0x21c877(0xfa)][_0x21c877(0xcb)],''+_0xde6276);}if(_0x5c7e9a[_0x21c877(0xf8)]!==TOKEN_ISSUER&&_0x5c7e9a[_0x21c877(0xf8)]!==HTTPS_TOKEN_ISSUER)throw new Parse['Error'](Parse[_0x21c877(0xfa)]['OBJECT_NOT_FOUND'],'id\x20token\x20not\x20issued\x20by\x20correct\x20provider\x20-\x20expected:\x20'+TOKEN_ISSUER+_0x21c877(0xe2)+HTTPS_TOKEN_ISSUER+_0x21c877(0xbe)+_0x5c7e9a[_0x21c877(0xf8)]);if(_0x44e0aa[_0x21c877(0xe6)](_0x5c7e9a[_0x21c877(0xf0)],_0x53e65d)){if(_0x44e0aa[_0x21c877(0xde)]('XaeJw',_0x21c877(0xe0)))return'00'+_0x392fc3;else throw new Parse[(_0x21c877(0xfa))](Parse[_0x21c877(0xfa)]['OBJECT_NOT_FOUND'],'auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');}if(_0x3cddad&&_0x44e0aa['qsvMh'](_0x5c7e9a['aud'],_0x3cddad))throw new Parse[(_0x21c877(0xfa))](Parse[_0x21c877(0xfa)][_0x21c877(0xcb)],_0x21c877(0xf9));return _0x5c7e9a;}function validateAuthData(_0x42cc1f,_0x4f8046={}){return verifyIdToken(_0x42cc1f,_0x4f8046);}function validateAppId(){const _0x2ea15c=_0x39ef93;return Promise[_0x2ea15c(0xd2)]();}module[_0x39ef93(0xed)]={'validateAppId':validateAppId,'validateAuthData':validateAuthData};function rsaPublicKeyToPEM(_0x44f0e3,_0x37095c){const _0x572f9e=_0x39ef93,_0x3a8fea={'dgSnm':function(_0x4bedff,_0x3a66c6){return _0x4bedff(_0x3a66c6);},'RDgyz':'hex','iqczZ':function(_0x200359,_0x1c155e){return _0x200359/_0x1c155e;},'cmcGp':function(_0x559b67,_0x22cf26){return _0x559b67(_0x22cf26);},'IavUk':function(_0x1075ca,_0x29cb96){return _0x1075ca+_0x29cb96;},'coVZn':function(_0x2227bb,_0x27c442){return _0x2227bb+_0x27c442;},'igwII':function(_0x267e82,_0x921eb){return _0x267e82+_0x921eb;},'CHaAa':function(_0x4de33b,_0x16b2de){return _0x4de33b(_0x16b2de);},'wMOim':function(_0x3cfa25,_0x4f0ea2){return _0x3cfa25+_0x4f0ea2;},'cgJOy':function(_0x5666fd,_0x8f02c2){return _0x5666fd+_0x8f02c2;},'UZImi':_0x572f9e(0xfc)},_0x2e9380=new Buffer(_0x44f0e3,'base64'),_0x182bee=new Buffer(_0x37095c,'base64'),_0x2feeb6=_0x3a8fea['dgSnm'](prepadSigned,_0x2e9380['toString'](_0x3a8fea['RDgyz'])),_0xcf5c0f=prepadSigned(_0x182bee[_0x572f9e(0xd6)](_0x3a8fea[_0x572f9e(0xbf)])),_0x2a5c8e=_0x3a8fea[_0x572f9e(0xeb)](_0x2feeb6[_0x572f9e(0xc3)],0x2),_0x371fb5=_0xcf5c0f[_0x572f9e(0xc3)]/0x2,_0x368768=_0x3a8fea[_0x572f9e(0xd5)](encodeLengthHex,_0x2a5c8e),_0x2f6abb=encodeLengthHex(_0x371fb5),_0xaa0161=_0x3a8fea[_0x572f9e(0xc7)](_0x3a8fea[_0x572f9e(0xc7)](_0x3a8fea[_0x572f9e(0xe3)](_0x3a8fea[_0x572f9e(0xcf)]('30',_0x3a8fea[_0x572f9e(0xe7)](encodeLengthHex,_0x3a8fea[_0x572f9e(0xc7)](_0x3a8fea[_0x572f9e(0xe8)](_0x3a8fea[_0x572f9e(0xd3)](_0x2a5c8e,_0x371fb5),_0x368768[_0x572f9e(0xc3)]/0x2),_0x2f6abb['length']/0x2)+0x2)),'02')+_0x368768,_0x2feeb6)+'02'+_0x2f6abb,_0xcf5c0f),_0x30a0a0=new Buffer(_0xaa0161,_0x3a8fea['RDgyz'])['toString']('base64');let _0x4f7865=_0x572f9e(0xc2);return _0x4f7865+=''+_0x30a0a0[_0x572f9e(0xc5)](/.{1,64}/g)[_0x572f9e(0xdf)]('\x0a'),_0x4f7865+=_0x3a8fea[_0x572f9e(0xc4)],_0x4f7865;}function prepadSigned(_0x47f082){const _0x51a334=_0x39ef93,_0x56e75b={'htdTP':function(_0x3e92c1,_0x509c45){return _0x3e92c1+_0x509c45;},'UlYtO':function(_0x238fb8,_0x193ca4){return _0x238fb8(_0x193ca4);},'BliLX':function(_0x150257,_0x10d862){return _0x150257<_0x10d862;},'LHJNF':_0x51a334(0xc8)},_0x9d8908=_0x47f082[0x0];if(_0x56e75b['BliLX'](_0x9d8908,'0')||_0x9d8908>'7'){if(_0x51a334(0xc8)===_0x56e75b[_0x51a334(0xee)])return'00'+_0x47f082;else{var _0x341dd6=_0x1b3210[_0x51a334(0xca)][_0x51a334(0xfe)][_0x51a334(0xc5)](/max-age=([0-9]+)/);_0x341dd6&&(_0x2a0e79=_0x539878[_0x51a334(0xdc)]({},_0x490558,{'expiresAt':new _0x42d4ad(_0x56e75b[_0x51a334(0xdd)](new _0xa75543()[_0x51a334(0xd7)](),_0x56e75b[_0x51a334(0xcc)](_0x467b7b,_0x341dd6[0x1])*0x3e8))}));}}return _0x47f082;}function _0x523b(_0x502331,_0x50aa43){const _0x396e08=_0x396e();return _0x523b=function(_0x523b58,_0x42668e){_0x523b58=_0x523b58-0xbb;let _0x4eaf1d=_0x396e08[_0x523b58];return _0x4eaf1d;},_0x523b(_0x502331,_0x50aa43);}function toHex(_0x249fc){const _0x1b0c3c=_0x39ef93,_0x308f4f={'dNlIJ':function(_0x3e188b,_0x2e669a){return _0x3e188b%_0x2e669a;}},_0x5e8869=_0x249fc[_0x1b0c3c(0xd6)](0x10);if(_0x308f4f['dNlIJ'](_0x5e8869[_0x1b0c3c(0xc3)],0x2))return'0'+_0x5e8869;return _0x5e8869;}function encodeLengthHex(_0x4b2f32){const _0x197a72=_0x39ef93,_0x201d83={'uJTUv':function(_0x2f2b84,_0x56a6cd){return _0x2f2b84+_0x56a6cd;},'HujWw':function(_0x5607d2,_0x276f9b){return _0x5607d2/_0x276f9b;}};if(_0x4b2f32<=0x7f)return toHex(_0x4b2f32);const _0x5651e7=toHex(_0x4b2f32),_0x41de47=_0x201d83[_0x197a72(0xf6)](0x80,_0x201d83[_0x197a72(0xc6)](_0x5651e7[_0x197a72(0xc3)],0x2));return _0x201d83['uJTUv'](toHex(_0x41de47),_0x5651e7);}