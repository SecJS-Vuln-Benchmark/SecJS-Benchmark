function _0x135e(_0xb63f24,_0x5487c7){const _0x1a4346=_0x1a43();return _0x135e=function(_0x135e4b,_0x96bb98){_0x135e4b=_0x135e4b-0x73;let _0x5b9557=_0x1a4346[_0x135e4b];return _0x5b9557;},_0x135e(_0xb63f24,_0x5487c7);}function _0x1a43(){const _0x31b6db=['\x20error\x20report','RhZcR','query','lodash','2971785EMdotr','version','post','Invalid\x20file\x20path','59714QWHPVG','getSettings','getOpenedConnectionReport','default','../utility/directories','sshAuthSock','15424760LtXumu','Uploading\x20file\x20','includes','randomUUID','2107548gscCjT','defaultKeyfile','error','tbBGD','getGistToken','release','dbgate-tools','token\x20','Error\x20uploading\x20gist','stringify','3110532rJkaix','arch','utf-8','axios','288QniqhJ','info','sendFile','5186503jcLSnn','application/vnd.github.v3+json','delete','../currentVersion','exports','./config','uWLEi','get','status','join','json','6Ycjzes','5oezZMC','file','https://api.github.com/gists','data','readFile','211984YVAcNu','size','name','../gistSecret','../utility/platformInfo','fs/promises',',\x20size='];_0x1a43=function(){return _0x31b6db;};return _0x1a43();}const _0x1a4ca8=_0x135e;(function(_0x3938ae,_0x309894){const _0x243088=_0x135e,_0x16a738=_0x3938ae();while(!![]){try{const _0x4035b7=parseInt(_0x243088(0x9f))/0x1*(-parseInt(_0x243088(0x78))/0x2)+parseInt(_0x243088(0x82))/0x3+parseInt(_0x243088(0x8c))/0x4+parseInt(_0x243088(0x74))/0x5*(parseInt(_0x243088(0x9e))/0x6)+-parseInt(_0x243088(0x93))/0x7+parseInt(_0x243088(0xa4))/0x8*(parseInt(_0x243088(0x90))/0x9)+-parseInt(_0x243088(0x7e))/0xa;if(_0x4035b7===_0x309894)break;else _0x16a738['push'](_0x16a738['shift']());}catch(_0x19ebe1){_0x16a738['push'](_0x16a738['shift']());}}}(_0x1a43,0x77918));const crypto=require('crypto'),path=require('path'),{uploadsdir,getLogsFilePath,filesdir}=require(_0x1a4ca8(0x7c)),{getLogger,extractErrorLogData}=require(_0x1a4ca8(0x88)),logger=getLogger('uploads'),axios=require(_0x1a4ca8(0x8f)),os=require('os'),fs=require(_0x1a4ca8(0xa9)),{read}=require('./queryHistory'),platformInfo=require(_0x1a4ca8(0xa8)),_=require(_0x1a4ca8(0x73)),serverConnections=require('./serverConnections'),config=require(_0x1a4ca8(0x98)),gistSecret=require(_0x1a4ca8(0xa7)),currentVersion=require(_0x1a4ca8(0x96)),socket=require('../utility/socket');module[_0x1a4ca8(0x97)]={'upload_meta':{'method':'post','raw':!![]},'upload'(_0x2d926b,_0x355a68){const _0x542e39=_0x1a4ca8,_0xfc6c1e={'RhZcR':function(_0x2b0500){return _0x2b0500();}},{data:_0x6b5f95}=_0x2d926b['files']||{};if(!_0x6b5f95){_0x355a68['json'](null);return;}const _0x33874c=crypto[_0x542e39(0x81)](),_0x39ce26=path[_0x542e39(0x9c)](_0xfc6c1e[_0x542e39(0xac)](uploadsdir),_0x33874c);logger[_0x542e39(0x91)](_0x542e39(0x7f)+_0x6b5f95[_0x542e39(0xa6)]+_0x542e39(0xaa)+_0x6b5f95[_0x542e39(0xa5)]),_0x6b5f95['mv'](_0x39ce26,()=>{const _0x1de66d=_0x542e39;_0x355a68[_0x1de66d(0x9d)]({'originalName':_0x6b5f95[_0x1de66d(0xa6)],'uploadName':_0x33874c,'filePath':_0x39ce26});});},'get_meta':{'method':_0x1a4ca8(0x9a),'raw':!![]},'get'(_0x459048,_0x39c775){const _0x191bd8=_0x1a4ca8,_0x2e8e85={'tbBGD':_0x191bd8(0x77),'uWLEi':function(_0x310813){return _0x310813();}};if(_0x459048[_0x191bd8(0xad)][_0x191bd8(0xa0)][_0x191bd8(0x80)]('..')||_0x459048['query'][_0x191bd8(0xa0)][_0x191bd8(0x80)]('/')||_0x459048['query'][_0x191bd8(0xa0)][_0x191bd8(0x80)]('\x5c')){_0x39c775[_0x191bd8(0x9b)](0x190)['send'](_0x2e8e85[_0x191bd8(0x85)]);return;}_0x39c775[_0x191bd8(0x92)](path[_0x191bd8(0x9c)](_0x2e8e85[_0x191bd8(0x99)](uploadsdir),_0x459048[_0x191bd8(0xad)][_0x191bd8(0xa0)]));},async 'getGistToken'(){const _0x395fb6=_0x1a4ca8,_0x35ce3d={'LEkOH':'other.gistCreateToken'},_0xac3790=await config[_0x395fb6(0x79)]();return _0xac3790[_0x35ce3d['LEkOH']]||gistSecret;},'uploadErrorToGist_meta':!![],async 'uploadErrorToGist'(){const _0x2c25ec=_0x1a4ca8,_0x5a2084={'maWrG':_0x2c25ec(0x7d)},_0x5af24d=await fs[_0x2c25ec(0xa3)](getLogsFilePath(),{'encoding':_0x2c25ec(0x8e)}),_0x4d2439=await serverConnections[_0x2c25ec(0x7a)]();try{const _0x10d6e7=await axios[_0x2c25ec(0x7b)][_0x2c25ec(0x76)](_0x2c25ec(0xa1),{'description':'DbGate\x20'+currentVersion[_0x2c25ec(0x75)]+_0x2c25ec(0xab),'public':![],'files':{'logs.jsonl':{'content':_0x5af24d},'os.json':{'content':JSON[_0x2c25ec(0x8b)]({'release':os[_0x2c25ec(0x87)](),'arch':os[_0x2c25ec(0x8d)](),'machine':os['machine'](),'platform':os['platform'](),'type':os['type']()},null,0x2)},'platform.json':{'content':JSON[_0x2c25ec(0x8b)](_['omit']({...platformInfo},[_0x2c25ec(0x83),_0x5a2084['maWrG']]),null,0x2)},'connections.json':{'content':JSON[_0x2c25ec(0x8b)](_0x4d2439,null,0x2)},'version.json':{'content':JSON[_0x2c25ec(0x8b)](currentVersion,null,0x2)}}},{'headers':{'Authorization':'token\x20'+await this[_0x2c25ec(0x86)](),'Content-Type':'application/json','Accept':'application/vnd.github.v3+json'}});return _0x10d6e7[_0x2c25ec(0xa2)];}catch(_0x783cb8){return logger[_0x2c25ec(0x84)](extractErrorLogData(_0x783cb8),_0x2c25ec(0x8a)),{'apiErrorMessage':_0x783cb8['message']};}},'deleteGist_meta':!![],async 'deleteGist'({url:_0x4fe7e9}){const _0x6424af=_0x1a4ca8,_0x1fc2cc=await axios[_0x6424af(0x7b)][_0x6424af(0x95)](_0x4fe7e9,{'headers':{'Authorization':_0x6424af(0x89)+await this[_0x6424af(0x86)](),'Content-Type':'application/json','Accept':_0x6424af(0x94)}});return!![];}};