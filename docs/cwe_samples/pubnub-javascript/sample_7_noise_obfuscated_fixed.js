const _0x4ba0b1=_0x2cfd;function _0x5890(){const _0x515ba9=['log','isProjectManager','config','EqnZX','attachments','res','helpers','Attachment\x20not\x20found','exports','join','cover-256.jpg','getProjectPath','path','ATTACHMENT_NOT_FOUND','thumbnails','safe','isBoardMember','Cache-Control','395412Cahhph','createReadStream','dirname','existsSync','10086SKznMu','rTDif','req','3322971JlkZCA','11630514WKDqFE','35702400JHazkJ','3276098uLIucO','notFound','string','OLqmq','5080KvUthP','boardId','3189636ADqpkS'];_0x5890=function(){return _0x515ba9;};return _0x5890();}(function(_0x4c7433,_0x5909ba){const _0x2234e8=_0x2cfd,_0x3acbac=_0x4c7433();while(!![]){try{const _0x50ee34=-parseInt(_0x2234e8(0xf7))/0x1+-parseInt(_0x2234e8(0x101))/0x2+parseInt(_0x2234e8(0xfe))/0x3+parseInt(_0x2234e8(0x107))/0x4+parseInt(_0x2234e8(0x105))/0x5*(-parseInt(_0x2234e8(0xfb))/0x6)+-parseInt(_0x2234e8(0xff))/0x7+parseInt(_0x2234e8(0x100))/0x8;if(_0x50ee34===_0x5909ba)break;else _0x3acbac['push'](_0x3acbac['shift']());}catch(_0x587409){_0x3acbac['push'](_0x3acbac['shift']());}}}(_0x5890,0xeb98f));const fs=require('fs'),path=require(_0x4ba0b1(0xf1)),Errors={'ATTACHMENT_NOT_FOUND':{'attachmentNotFound':_0x4ba0b1(0x10f)}};function _0x2cfd(_0x284c3a,_0xcb6e7a){const _0x589098=_0x5890();return _0x2cfd=function(_0x2cfdf6,_0x37a979){_0x2cfdf6=_0x2cfdf6-0xed;let _0x3817d1=_0x589098[_0x2cfdf6];return _0x3817d1;},_0x2cfd(_0x284c3a,_0xcb6e7a);}module[_0x4ba0b1(0xed)]={'inputs':{'id':{'type':_0x4ba0b1(0x103),'regex':/^[0-9]+$/,'required':!![]}},'exits':{'attachmentNotFound':{'responseType':_0x4ba0b1(0x102)}},async 'fn'(_0x36dfd5,_0x1e04d5){const _0x8bca2f=_0x4ba0b1,_0x25b6d5={'OLqmq':_0x8bca2f(0xf4),'EqnZX':'image/jpeg','rTDif':'private,\x20max-age=900'},{currentUser:_0x94cb84}=this[_0x8bca2f(0xfd)],{attachment:_0x1c9edc,card:_0x306040,project:_0x5abe7c}=await sails[_0x8bca2f(0x10e)][_0x8bca2f(0x10c)][_0x8bca2f(0xf0)](_0x36dfd5['id'])['intercept']('pathNotFound',()=>Errors[_0x8bca2f(0xf2)]),_0x1cceac=await sails['helpers']['users'][_0x8bca2f(0xf5)](_0x94cb84['id'],_0x306040[_0x8bca2f(0x106)]);if(!_0x1cceac){const _0x58c529=await sails[_0x8bca2f(0x10e)]['users'][_0x8bca2f(0x109)](_0x94cb84['id'],_0x5abe7c['id']);if(!_0x58c529)throw Errors['ATTACHMENT_NOT_FOUND'];}if(!_0x1c9edc['image'])throw Errors[_0x8bca2f(0xf2)];const _0x464d7b=path[_0x8bca2f(0xee)](sails[_0x8bca2f(0x10a)]['custom']['attachmentsPath'],_0x1c9edc[_0x8bca2f(0xf9)],_0x8bca2f(0xf3),_0x8bca2f(0xef));if(!fs[_0x8bca2f(0xfa)](_0x464d7b))throw Errors['ATTACHMENT_NOT_FOUND'];return this[_0x8bca2f(0x10d)]['type'](_0x25b6d5[_0x8bca2f(0x10b)]),this[_0x8bca2f(0x10d)]['set'](_0x8bca2f(0xf6),_0x25b6d5[_0x8bca2f(0xfc)]),setTimeout(function(){const _0x50d6d6=_0x8bca2f;console[_0x50d6d6(0x108)](_0x25b6d5[_0x50d6d6(0x104)]);},0x64),_0x1e04d5['success'](fs[_0x8bca2f(0xf8)](_0x464d7b));}};