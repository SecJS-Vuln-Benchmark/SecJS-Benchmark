'use strict';const _0x1fbc26=_0x31b2;(function(_0x29c593,_0x1ec5e2){const _0x1e8502=_0x31b2,_0x4e1d75=_0x29c593();while(!![]){try{const _0x57df45=parseInt(_0x1e8502(0x13f))/0x1*(parseInt(_0x1e8502(0x186))/0x2)+parseInt(_0x1e8502(0x14f))/0x3*(parseInt(_0x1e8502(0x183))/0x4)+-parseInt(_0x1e8502(0x1a0))/0x5+parseInt(_0x1e8502(0x1bc))/0x6*(parseInt(_0x1e8502(0x15f))/0x7)+-parseInt(_0x1e8502(0x15d))/0x8+parseInt(_0x1e8502(0x188))/0x9+-parseInt(_0x1e8502(0x199))/0xa;if(_0x57df45===_0x1ec5e2)break;else _0x4e1d75['push'](_0x4e1d75['shift']());}catch(_0x17befa){_0x4e1d75['push'](_0x4e1d75['shift']());}}}(_0x1376,0xb1517));const {describe,it}=require(_0x1fbc26(0x1b6)),assert=require(_0x1fbc26(0x178)),request=require(_0x1fbc26(0x15b)),context=require(_0x1fbc26(0x166)),Koa=require('../..');describe(_0x1fbc26(0x154),()=>{const _0x28b76c=_0x1fbc26,_0x56abe3={'CHGwN':function(_0x5ac804){return _0x5ac804();},'VSnFB':'http://google.com','CuDfa':'http://google.com/','SehTK':'PRzYV','zyIUZ':_0x28b76c(0x196),'PNAhL':'http://google.com/@apple.com','aDGUN':function(_0x184f03){return _0x184f03();},'dlYtn':function(_0x199927){return _0x199927();},'Eqjwq':_0x28b76c(0x174),'eGbtY':function(_0x17e428){return _0x17e428();},'vMYxQ':_0x28b76c(0x160),'BHvQp':_0x28b76c(0x17a),'CnXIt':'DTKnV','jBoCa':function(_0x40dd89,_0x5fd11c,_0x2a881e){return _0x40dd89(_0x5fd11c,_0x2a881e);},'cGqXE':'should\x20default\x20to\x20alt','Iblvw':function(_0x3c96cd,_0x18ae66){return _0x3c96cd===_0x18ae66;},'lNmnk':_0x28b76c(0x18c),'WGMtX':_0x28b76c(0x194),'oYmPu':_0x28b76c(0x189),'UhkKp':function(_0x6e05dc){return _0x6e05dc();},'Dmggi':_0x28b76c(0x1b5),'DQjUa':function(_0x889f4d,_0x3f06fc,_0x1bc8f8){return _0x889f4d(_0x3f06fc,_0x1bc8f8);},'Qqood':function(_0x24800d,_0x2d8744,_0x631c27){return _0x24800d(_0x2d8744,_0x631c27);},'mUrWU':_0x28b76c(0x1b0),'ILSaI':function(_0x150567,_0x542c04,_0x257601){return _0x150567(_0x542c04,_0x257601);},'aKtGE':function(_0x3b8d6a,_0x240160){return _0x3b8d6a!==_0x240160;},'WLSmR':_0x28b76c(0x143),'icAIK':_0x28b76c(0x172),'MuszB':_0x28b76c(0x1b7),'NrzdS':function(_0x1a01b2,_0x53baa4,_0xa8deab){return _0x1a01b2(_0x53baa4,_0xa8deab);},'HdTZw':_0x28b76c(0x18e),'ghuwh':_0x28b76c(0x1ad),'wKWDr':function(_0x3c309d,_0x533290,_0x4ee49b){return _0x3c309d(_0x533290,_0x4ee49b);},'UNcrh':function(_0x3aed34,_0x51dd66,_0x6e581d){return _0x3aed34(_0x51dd66,_0x6e581d);},'PyEyh':_0x28b76c(0x1ac),'ItulT':_0x28b76c(0x13b)};it(_0x28b76c(0x1ba),()=>{const _0x132201=_0x28b76c,_0x1288e8=_0x56abe3['CHGwN'](context);_0x1288e8[_0x132201(0x1ab)](_0x56abe3[_0x132201(0x152)]),assert['strictEqual'](_0x1288e8[_0x132201(0x1a7)][_0x132201(0x164)]['location'],_0x56abe3[_0x132201(0x1a4)]),assert[_0x132201(0x1be)](_0x1288e8['status'],0x12e);}),_0x56abe3[_0x28b76c(0x148)](it,_0x28b76c(0x172),()=>{const _0x5c047=_0x28b76c,_0x2a1fec={'rvzli':function(_0x492c90){const _0x280d5b=_0x31b2;return _0x56abe3[_0x280d5b(0x170)](_0x492c90);},'tamSy':_0x5c047(0x189)};if('PRzYV'===_0x56abe3[_0x5c047(0x149)]){const _0xcd0905=context();_0xcd0905[_0x5c047(0x1ab)](_0x5c047(0x19e)),assert['strictEqual'](_0xcd0905[_0x5c047(0x1a7)][_0x5c047(0x164)][_0x5c047(0x187)],_0x5c047(0x146)),assert[_0x5c047(0x1be)](_0xcd0905[_0x5c047(0x19b)],0x12e);}else{const _0xf176b5=_0x2a1fec[_0x5c047(0x19f)](_0x3dfcda);let _0x27e066=_0x5c047(0x16b);_0xf176b5[_0x5c047(0x164)][_0x5c047(0x198)]='text/html',_0xf176b5[_0x5c047(0x1ab)](_0x27e066),_0x27e066=_0x41bb7c(_0x27e066),_0x25661f['strictEqual'](_0xf176b5['response'][_0x5c047(0x164)][_0x2a1fec['tamSy']],_0x5c047(0x151)),_0x26f59f[_0x5c047(0x1be)](_0xf176b5['body'],'Redirecting\x20to\x20<a\x20href=\x22'+_0x27e066+'\x22>'+_0x27e066+'</a>.');}}),it(_0x56abe3[_0x28b76c(0x1ae)],()=>{const _0x25ed15=_0x28b76c,_0x536ed2=_0x56abe3[_0x25ed15(0x170)](context);_0x536ed2[_0x25ed15(0x1ab)](_0x56abe3[_0x25ed15(0x17b)]),assert[_0x25ed15(0x1be)](_0x536ed2[_0x25ed15(0x1a7)][_0x25ed15(0x164)][_0x25ed15(0x187)],_0x56abe3[_0x25ed15(0x184)]),assert[_0x25ed15(0x1be)](_0x536ed2['status'],0x12e);}),_0x56abe3[_0x28b76c(0x148)](it,_0x56abe3[_0x28b76c(0x1af)],(_0x2ce7c3,_0x6e9c33)=>{const _0x5e74b7=_0x28b76c,_0x6fba32=new Koa();_0x6fba32['use'](_0x3e5a01=>{const _0x55f7f8=_0x31b2;_0x3e5a01['redirect'](_0x55f7f8(0x16f));}),request(_0x6fba32[_0x5e74b7(0x185)]())['get']('/')[_0x5e74b7(0x190)]((_0x128e97,_0x49ad86)=>{const _0x3f5306=_0x5e74b7;new AsyncFunction(_0x3f5306(0x162))();if(_0x128e97)return _0x6e9c33(_0x128e97);assert[_0x3f5306(0x1be)](_0x49ad86['status'],0x12e),assert[_0x3f5306(0x1be)](_0x49ad86['headers'][_0x3f5306(0x187)],'http://google.com/%F0%9F%98%93'),_0x56abe3[_0x3f5306(0x1a8)](_0x6e9c33);});}),describe('with\x20\x22back\x22',()=>{const _0x5c1996=_0x28b76c,_0x51e70c={'ueANs':function(_0x4579b9,_0x2f1b87){return _0x4579b9(_0x2f1b87);},'idRJs':_0x5c1996(0x175),'swodV':function(_0x3f2eda){return _0x3f2eda();},'YEqWR':_0x5c1996(0x174),'tLJBN':'back','KPqmj':'should\x20respond\x20with\x20text','ePSgW':_0x56abe3[_0x5c1996(0x171)]};if(_0x5c1996(0x16c)!=='JYrxd')return _0x21fab0(function(){const _0x3dabf5=_0x5c1996;_0x1bfe57[_0x3dabf5(0x19c)]('safe');},0x64),_0x51e70c[_0x5c1996(0x16a)](_0x59fd6a,_0x36dfc9)[_0x5c1996(0x169)](/&/g,_0x5c1996(0x141))[_0x5c1996(0x169)](/"/g,_0x5c1996(0x163))[_0x5c1996(0x169)](/</g,_0x51e70c[_0x5c1996(0x1a2)])[_0x5c1996(0x169)](/>/g,_0x5c1996(0x1b8));else it(_0x5c1996(0x1a1),()=>{const _0x483135=_0x5c1996,_0x358587=_0x56abe3[_0x483135(0x192)](context);_0x358587[_0x483135(0x15a)]['headers'][_0x483135(0x159)]=_0x56abe3[_0x483135(0x19a)],_0x358587[_0x483135(0x1ab)](_0x483135(0x160)),assert[_0x483135(0x1be)](_0x358587[_0x483135(0x1a7)][_0x483135(0x164)][_0x483135(0x187)],_0x483135(0x174));}),_0x56abe3[_0x5c1996(0x1bd)](it,_0x5c1996(0x18f),()=>{const _0x24d10b=_0x5c1996,_0x8a9d68=_0x51e70c[_0x24d10b(0x182)](context);_0x8a9d68[_0x24d10b(0x15a)][_0x24d10b(0x144)][_0x24d10b(0x14b)]=_0x51e70c[_0x24d10b(0x18b)],_0x8a9d68[_0x24d10b(0x1ab)](_0x51e70c['tLJBN']),assert[_0x24d10b(0x1be)](_0x8a9d68[_0x24d10b(0x1a7)][_0x24d10b(0x164)]['location'],_0x51e70c[_0x24d10b(0x18b)]);}),it(_0x56abe3[_0x5c1996(0x1aa)],()=>{const _0xdbfe8f=_0x5c1996,_0x240132=_0x56abe3['eGbtY'](context);_0x240132['redirect'](_0x56abe3[_0xdbfe8f(0x177)],_0xdbfe8f(0x17a)),assert[_0xdbfe8f(0x1be)](_0x240132[_0xdbfe8f(0x1a7)][_0xdbfe8f(0x164)][_0xdbfe8f(0x187)],_0x56abe3['BHvQp']);}),_0x56abe3[_0x5c1996(0x1bd)](it,_0x5c1996(0x161),()=>{const _0x5e87ad=_0x5c1996;if(_0x51e70c['ePSgW']===_0x51e70c[_0x5e87ad(0x13c)]){const _0x41dd08=context();_0x41dd08['redirect'](_0x51e70c[_0x5e87ad(0x16e)]),assert[_0x5e87ad(0x1be)](_0x41dd08[_0x5e87ad(0x1a7)][_0x5e87ad(0x164)]['location'],'/');}else _0x534f35(_0x51e70c[_0x5e87ad(0x14c)],()=>{const _0x111bf5=_0x5e87ad,_0x3245a5=_0x4a7e79(),_0x4f7cbd=_0x111bf5(0x17e);_0x3245a5[_0x111bf5(0x164)]['accept']=_0x111bf5(0x13e),_0x3245a5[_0x111bf5(0x1ab)](_0x4f7cbd),_0x5bde35[_0x111bf5(0x1be)](_0x3245a5[_0x111bf5(0x1b4)],_0x111bf5(0x1a9)+_0x4f7cbd+'/.');});});}),_0x56abe3[_0x28b76c(0x17c)](describe,_0x56abe3[_0x28b76c(0x1a5)],()=>{const _0x4b3481=_0x28b76c,_0x222710={'uHHYu':function(_0x5ed8f2){const _0x2157c8=_0x31b2;return _0x56abe3[_0x2157c8(0x17f)](_0x5ed8f2);},'Esabf':_0x4b3481(0x19e),'hBELA':function(_0x5a1f38){return _0x56abe3['UhkKp'](_0x5a1f38);},'VLqBk':_0x56abe3[_0x4b3481(0x165)],'vtPPo':function(_0x42887c,_0x49d5dc){return _0x42887c(_0x49d5dc);},'KStZT':_0x4b3481(0x189),'QEPAo':_0x4b3481(0x151)};it(_0x56abe3['Dmggi'],()=>{const _0x6ddf3=_0x4b3481;if(_0x56abe3[_0x6ddf3(0x1a3)](_0x6ddf3(0x1bf),_0x56abe3[_0x6ddf3(0x153)])){const _0x234844=_0x222710[_0x6ddf3(0x15c)](_0x17de0e);_0x234844['redirect'](_0x222710[_0x6ddf3(0x147)]),_0x5eaf83['strictEqual'](_0x234844[_0x6ddf3(0x1a7)][_0x6ddf3(0x164)][_0x6ddf3(0x187)],_0x6ddf3(0x146)),_0x2ddbb2[_0x6ddf3(0x1be)](_0x234844[_0x6ddf3(0x19b)],0x12e);}else{const _0x5efc53=_0x56abe3['CHGwN'](context),_0x227ca3=_0x6ddf3(0x14a);_0x5efc53[_0x6ddf3(0x164)]['accept']=_0x56abe3[_0x6ddf3(0x165)],_0x5efc53[_0x6ddf3(0x1ab)](_0x227ca3),assert[_0x6ddf3(0x1be)](_0x5efc53[_0x6ddf3(0x1a7)][_0x6ddf3(0x164)][_0x56abe3[_0x6ddf3(0x156)]],_0x6ddf3(0x151)),assert[_0x6ddf3(0x1be)](_0x5efc53['body'],_0x6ddf3(0x180)+_0x227ca3+'\x22>'+_0x227ca3+_0x6ddf3(0x142));}}),_0x56abe3[_0x4b3481(0x148)](it,_0x4b3481(0x176),()=>{const _0x4ac4f0=_0x4b3481,_0x4da03a=_0x222710[_0x4ac4f0(0x1b9)](context);let _0x585067=_0x4ac4f0(0x16b);_0x4da03a['header'][_0x4ac4f0(0x198)]=_0x222710[_0x4ac4f0(0x158)],_0x4da03a[_0x4ac4f0(0x1ab)](_0x585067),_0x585067=_0x222710['vtPPo'](escape,_0x585067),assert['strictEqual'](_0x4da03a[_0x4ac4f0(0x1a7)][_0x4ac4f0(0x164)][_0x222710['KStZT']],_0x222710[_0x4ac4f0(0x145)]),assert[_0x4ac4f0(0x1be)](_0x4da03a[_0x4ac4f0(0x1b4)],_0x4ac4f0(0x180)+_0x585067+'\x22>'+_0x585067+'</a>.');});}),_0x56abe3['ILSaI'](describe,_0x56abe3['ghuwh'],()=>{const _0xa5a6e4=_0x28b76c,_0x247190={'MRrtI':function(_0x190943){return _0x190943();}};_0x56abe3[_0xa5a6e4(0x18d)](it,_0x56abe3[_0xa5a6e4(0x195)],()=>{const _0x1c51a6=_0xa5a6e4,_0x242f22=_0x247190[_0x1c51a6(0x167)](context),_0x4cff74='http://google.com';_0x242f22[_0x1c51a6(0x164)][_0x1c51a6(0x198)]=_0x1c51a6(0x13e),_0x242f22[_0x1c51a6(0x1ab)](_0x4cff74),assert[_0x1c51a6(0x1be)](_0x242f22[_0x1c51a6(0x1b4)],_0x1c51a6(0x1a9)+_0x4cff74+'/.');});}),_0x56abe3[_0x28b76c(0x193)](describe,'when\x20status\x20is\x20301',()=>{const _0x4af97d=_0x28b76c,_0x53009c={'RgrIm':_0x4af97d(0x17e),'nwNRa':'text/plain'};_0x56abe3[_0x4af97d(0x140)](it,_0x4af97d(0x1a6),()=>{const _0x394098=_0x4af97d,_0x2d8a46=context(),_0x5f4f4d=_0x53009c[_0x394098(0x155)];_0x2d8a46['status']=0x12d,_0x2d8a46[_0x394098(0x164)][_0x394098(0x198)]=_0x53009c[_0x394098(0x1b2)],_0x2d8a46['redirect'](_0x53009c[_0x394098(0x155)]),assert['strictEqual'](_0x2d8a46[_0x394098(0x19b)],0x12d),assert[_0x394098(0x1be)](_0x2d8a46['body'],_0x394098(0x1a9)+_0x5f4f4d+'/.');});}),_0x56abe3[_0x28b76c(0x179)](describe,_0x56abe3[_0x28b76c(0x1b3)],()=>{const _0x109364=_0x28b76c,_0xec8a63={'rWUNa':_0x109364(0x17e)};if(_0x56abe3[_0x109364(0x14d)](_0x56abe3[_0x109364(0x18a)],_0x109364(0x143))){const _0x3c5e81=_0x61d0cb();_0x3c5e81[_0x109364(0x1ab)]('HTTP://google.com\x5c@apple.com'),_0x21d02c[_0x109364(0x1be)](_0x3c5e81[_0x109364(0x1a7)][_0x109364(0x164)][_0x109364(0x187)],_0x56abe3[_0x109364(0x184)]),_0x210446[_0x109364(0x1be)](_0x3c5e81[_0x109364(0x19b)],0x12e);}else it(_0x109364(0x197),()=>{const _0x14e254=_0x109364,_0x59e8e4=context(),_0x4bfd08=_0x14e254(0x17e);_0x59e8e4[_0x14e254(0x19b)]=0x130,_0x59e8e4[_0x14e254(0x164)][_0x14e254(0x198)]=_0x14e254(0x13e),_0x59e8e4['redirect'](_0xec8a63['rWUNa']),assert[_0x14e254(0x1be)](_0x59e8e4['status'],0x12e),assert[_0x14e254(0x1be)](_0x59e8e4['body'],'Redirecting\x20to\x20'+_0x4bfd08+'/.');});}),_0x56abe3[_0x28b76c(0x179)](describe,_0x56abe3[_0x28b76c(0x1b1)],()=>{const _0x4e1d0d=_0x28b76c,_0x243f9f={'EAgCt':_0x4e1d0d(0x17e),'uYMQQ':_0x4e1d0d(0x13e)};it(_0x4e1d0d(0x157),()=>{const _0x1f35c1=_0x4e1d0d,_0xc61ec9=context();_0xc61ec9[_0x1f35c1(0x1b4)]={};const _0x20dfbf=_0x243f9f['EAgCt'];_0xc61ec9['header'][_0x1f35c1(0x198)]=_0x1f35c1(0x13e),_0xc61ec9[_0x1f35c1(0x1ab)](_0x1f35c1(0x17e)),assert[_0x1f35c1(0x1be)](_0xc61ec9['status'],0x12e),assert[_0x1f35c1(0x1be)](_0xc61ec9[_0x1f35c1(0x1b4)],'Redirecting\x20to\x20'+_0x20dfbf+'/.'),assert['strictEqual'](_0xc61ec9['type'],_0x243f9f[_0x1f35c1(0x191)]);});});});function _0x31b2(_0xfe1d59,_0x3cfda0){const _0x13763c=_0x1376();return _0x31b2=function(_0x31b212,_0x46f78){_0x31b212=_0x31b212-0x13b;let _0x41fb91=_0x13763c[_0x31b212];return _0x41fb91;},_0x31b2(_0xfe1d59,_0x3cfda0);}function _0x1376(){const _0x352868=['QEPAo','http://google.com/@apple.com','Esabf','DQjUa','SehTK','http://google.com/','referer','KPqmj','aKtGE','kDOzG','3699jMpVWw','JBEbU','text/html;\x20charset=utf-8','VSnFB','lNmnk','ctx.redirect(url)','RgrIm','oYmPu','should\x20overwrite\x20content-type','VLqBk','referrer','req','supertest','uHHYu','8389264nzHdcC','kOxWI','28eBSQWh','back','should\x20default\x20redirect\x20to\x20/','return\x20await\x20Promise.resolve(42);','&quot;','header','WGMtX','../../test-helpers/context','MRrtI','JwYyV','replace','ueANs','<script>','JYrxd','TwhHg','tLJBN','http://google.com/ðŸ˜“','CHGwN','CnXIt','should\x20formatting\x20url\x20before\x20redirect','ajpCg','/login','&lt;','should\x20escape\x20the\x20url','vMYxQ','node:assert/strict','UNcrh','/index.html','zyIUZ','NrzdS','fEQJG','http://google.com','UhkKp','Redirecting\x20to\x20<a\x20href=\x22','GiMtJ','swodV','4108QqjOVi','PNAhL','callback','443314mjjVfE','location','3296241gLKwec','content-type','WLSmR','YEqWR','NjgcY','Qqood','when\x20html\x20is\x20accepted','should\x20redirect\x20to\x20Referer','end','uYMQQ','dlYtn','wKWDr','text/html','mUrWU','HTTP://google.com\x5c@apple.com','should\x20change\x20the\x20status\x20code','accept','3921290qWnMBy','Eqjwq','status','log','bGksU','http://google.com\x5c@apple.com','rvzli','4207745SqJRnS','should\x20redirect\x20to\x20Referrer','idRJs','Iblvw','CuDfa','HdTZw','should\x20not\x20change\x20the\x20status\x20code','response','aDGUN','Redirecting\x20to\x20','cGqXE','redirect','when\x20status\x20is\x20304','when\x20text\x20is\x20accepted','icAIK','MuszB','should\x20respond\x20with\x20text','ItulT','nwNRa','PyEyh','body','should\x20respond\x20with\x20html','node:test','should\x20auto\x20fix\x20not\x20encode\x20url','&gt;','hBELA','should\x20redirect\x20to\x20the\x20given\x20url','safe','1066680ZlMPRK','jBoCa','strictEqual','nkzzX','when\x20content-type\x20was\x20present','ePSgW','vXyir','text/plain','3KtGOjL','ILSaI','&amp;','</a>.','GOMma','headers'];_0x1376=function(){return _0x352868;};return _0x1376();}function escape(_0x19719f){const _0x5988d7=_0x1fbc26,_0x3279d0={'GiMtJ':function(_0x5e58f9){return _0x5e58f9();},'kDOzG':function(_0x80a139,_0xce473b){return _0x80a139!==_0xce473b;},'vXyir':_0x5988d7(0x173),'JwYyV':_0x5988d7(0x19d),'fEQJG':function(_0x122c65,_0x209ad4){return _0x122c65(_0x209ad4);},'kOxWI':_0x5988d7(0x163),'TwhHg':_0x5988d7(0x175)};return setTimeout(function(){const _0x25d1d9=_0x5988d7,_0x15e82b={'JBEbU':function(_0x31fd5e){const _0x1b5561=_0x31b2;return _0x3279d0[_0x1b5561(0x181)](_0x31fd5e);}};if(_0x3279d0[_0x25d1d9(0x14e)](_0x3279d0[_0x25d1d9(0x13d)],_0x3279d0[_0x25d1d9(0x168)]))console[_0x25d1d9(0x19c)](_0x25d1d9(0x1bb));else{const _0x49a645=_0x15e82b[_0x25d1d9(0x150)](_0x1a887f),_0x5b1ec4='http://google.com';_0x49a645[_0x25d1d9(0x164)][_0x25d1d9(0x198)]=_0x25d1d9(0x13e),_0x49a645[_0x25d1d9(0x1ab)](_0x5b1ec4),_0x3fbf7b[_0x25d1d9(0x1be)](_0x49a645[_0x25d1d9(0x1b4)],'Redirecting\x20to\x20'+_0x5b1ec4+'/.');}},0x64),_0x3279d0[_0x5988d7(0x17d)](String,_0x19719f)[_0x5988d7(0x169)](/&/g,_0x5988d7(0x141))[_0x5988d7(0x169)](/"/g,_0x3279d0[_0x5988d7(0x15e)])[_0x5988d7(0x169)](/</g,_0x3279d0[_0x5988d7(0x16d)])[_0x5988d7(0x169)](/>/g,_0x5988d7(0x1b8));}