'use strict';function _0x4248(_0x41af9f,_0x18fa73){const _0x3f8325=_0x3f83();return _0x4248=function(_0x4248cc,_0x305ce6){_0x4248cc=_0x4248cc-0xab;let _0x1d70eb=_0x3f8325[_0x4248cc];return _0x1d70eb;},_0x4248(_0x41af9f,_0x18fa73);}const _0x1a1164=_0x4248;(function(_0x387b1c,_0x3ac0c3){const _0x15e5fc=_0x4248,_0x350c97=_0x387b1c();while(!![]){try{const _0x4290f0=parseInt(_0x15e5fc(0xdb))/0x1*(parseInt(_0x15e5fc(0xcc))/0x2)+parseInt(_0x15e5fc(0xc2))/0x3+parseInt(_0x15e5fc(0xd7))/0x4*(parseInt(_0x15e5fc(0xe8))/0x5)+parseInt(_0x15e5fc(0xb0))/0x6+-parseInt(_0x15e5fc(0xe7))/0x7*(parseInt(_0x15e5fc(0x101))/0x8)+-parseInt(_0x15e5fc(0xc5))/0x9*(-parseInt(_0x15e5fc(0xfc))/0xa)+-parseInt(_0x15e5fc(0xea))/0xb*(parseInt(_0x15e5fc(0xf3))/0xc);if(_0x4290f0===_0x3ac0c3)break;else _0x350c97['push'](_0x350c97['shift']());}catch(_0x1212d5){_0x350c97['push'](_0x350c97['shift']());}}}(_0x3f83,0xc935b));const assert=require(_0x1a1164(0xb3)),request=require('supertest'),context=require(_0x1a1164(0xac)),Koa=require(_0x1a1164(0xd4));function _0x3f83(){const _0x3c9094=['7260MbziRw','mfSCE','&quot;','EXKNM','mKOrs','ksreP','cyVjH','ZRFOB','rXtXz','49740NxLgkM','return\x20await\x20Promise.resolve(42);','PWgTt','iZRkO','aWVTw','136MwfxtG','oqXuv','when\x20text\x20is\x20accepted','should\x20default\x20redirect\x20to\x20/','txZlG','CUpdW','Redirecting\x20to\x20<a\x20href=\x22','req','UQFzg','status','should\x20change\x20the\x20status\x20code','strictEqual','HrlVW','xXdCK','/index.html','type','end','<script>','dXjSV','http://google.com','response','AoSMm','Byqpd','RhJqT','location','should\x20escape\x20the\x20url','Redirecting\x20to\x20','redirect','get','../../test-helpers/context','body','http://google.com/%F0%9F%98%93','when\x20status\x20is\x20301','2847804HohQHg','ziyDT','replace','assert','imKEj','should\x20redirect\x20to\x20the\x20given\x20url','/login','OphEx','when\x20status\x20is\x20304','gixZs','http://google.com/ðŸ˜“','should\x20default\x20to\x20alt','should\x20redirect\x20to\x20Referrer','NkRWN','eOzJT','QPRBb','tBfSe','header','1721967gQByyZ','pairr','back','2034BACmYw','kUUZF','&lt;','gPSYe','callback','when\x20content-type\x20was\x20present','iuDIs','930906VehvZR','should\x20overwrite\x20content-type','WyJeP','uRBqE','hKeym','GpEiU','accept','vhGUv','../..','ttfFt','rMCzC','12alpGVY','stringify','MFeHO','</a>.','3Nmlchb','CFVRJ','XfThX','&gt;','should\x20auto\x20fix\x20not\x20encode\x20url','Njmgv','should\x20respond\x20with\x20html','qfTjW','wmqBa','KyEFo','ARJek','wbogO','536599oZohTk','625055erOzxz','OsJjC','33033wbvsrl','ktTRx','&amp;','MyvUt','HcgDz','headers','text/html;\x20charset=utf-8','jxJze','text/html'];_0x3f83=function(){return _0x3c9094;};return _0x3f83();}describe('ctx.redirect(url)',()=>{const _0x48f842=_0x1a1164,_0x1dec9e={'AoSMm':function(_0x59ea2b){return _0x59ea2b();},'vhGUv':'http://google.com','HcgDz':_0x48f842(0xba),'ttfFt':function(_0x322e6b,_0x58db41){return _0x322e6b(_0x58db41);},'imKEj':_0x48f842(0xb6),'gixZs':_0x48f842(0xc4),'WyJeP':function(_0x4457cd){return _0x4457cd();},'QPRBb':_0x48f842(0x10f),'aWVTw':function(_0x5b2bb8,_0x2f1164,_0x594514){return _0x5b2bb8(_0x2f1164,_0x594514);},'tBfSe':function(_0x457a9c,_0x388c06,_0xa03921){return _0x457a9c(_0x388c06,_0xa03921);},'txZlG':'should\x20redirect\x20to\x20Referer','qfTjW':_0x48f842(0xbb),'uRBqE':function(_0x3c17cb,_0x246017){return _0x3c17cb!==_0x246017;},'jxJze':_0x48f842(0xe0),'MyvUt':function(_0x5d764e){return _0x5d764e();},'XfThX':_0x48f842(0xf2),'rMCzC':'content-type','cyVjH':function(_0x1f6024,_0xb99faa,_0x116480){return _0x1f6024(_0xb99faa,_0x116480);},'hKeym':_0x48f842(0xe1),'wmqBa':_0x48f842(0x11a),'RhJqT':_0x48f842(0x106),'eOzJT':'text/html;\x20charset=utf-8','HrlVW':'text/plain','ZRFOB':'vsoJv','GWatj':function(_0x2c3bb1,_0x266623,_0x222e52){return _0x2c3bb1(_0x266623,_0x222e52);},'gPSYe':'should\x20not\x20change\x20the\x20status\x20code','ziyDT':function(_0x547800,_0x21f106,_0x4692c2){return _0x547800(_0x21f106,_0x4692c2);},'Rvcrn':'&gt;','mfSCE':_0x48f842(0xcd),'IKlzV':_0x48f842(0xb5),'OsJjC':'with\x20\x22back\x22','CFVRJ':_0x48f842(0x103),'XlIfS':_0x48f842(0xca)};_0x1dec9e[_0x48f842(0x100)](it,_0x1dec9e['IKlzV'],()=>{const _0x299112=_0x48f842,_0x35f42e=_0x1dec9e[_0x299112(0x116)](context);_0x35f42e[_0x299112(0x11c)](_0x1dec9e[_0x299112(0xd3)]),assert['strictEqual'](_0x35f42e[_0x299112(0x115)]['header']['location'],_0x1dec9e[_0x299112(0xd3)]),assert['strictEqual'](_0x35f42e['status'],0x12e);}),_0x1dec9e[_0x48f842(0xc0)](it,_0x48f842(0xdf),_0x1520bc=>{const _0xe3c6fe=_0x48f842,_0xa90a0f=new Koa();_0xa90a0f['use'](_0x1d0aee=>{const _0x29872c=_0x4248;_0x1d0aee[_0x29872c(0x11c)](_0x1dec9e[_0x29872c(0xee)]);}),request(_0xa90a0f[_0xe3c6fe(0xc9)]())[_0xe3c6fe(0xab)]('/')[_0xe3c6fe(0x111)]((_0xe1dd24,_0x4a8a14)=>{const _0x6609e=_0xe3c6fe;eval('const _0x8242ce = _0x4248;JSON[_0x8242ce(216)]({ \'safe\': !![] });');if(_0xe1dd24)return _0x1dec9e[_0x6609e(0xd5)](_0x1520bc,_0xe1dd24);assert[_0x6609e(0x10c)](_0x4a8a14[_0x6609e(0x10a)],0x12e),assert[_0x6609e(0x10c)](_0x4a8a14[_0x6609e(0xef)][_0x6609e(0x119)],_0x6609e(0xae)),_0x1520bc();});}),describe(_0x1dec9e[_0x48f842(0xe9)],()=>{const _0x207288=_0x48f842,_0x1345fe={'mKOrs':function(_0x46749d){const _0x23b257=_0x4248;return _0x1dec9e[_0x23b257(0xce)](_0x46749d);},'ksreP':_0x1dec9e['imKEj'],'ihvSp':_0x207288(0xc4),'wbogO':_0x1dec9e[_0x207288(0xbf)]};_0x1dec9e[_0x207288(0x100)](it,_0x207288(0xbc),()=>{const _0x1808e8=_0x207288,_0x46e99b=_0x1345fe[_0x1808e8(0xf7)](context);_0x46e99b['req'][_0x1808e8(0xef)]['referrer']=_0x1345fe[_0x1808e8(0xf8)],_0x46e99b[_0x1808e8(0x11c)](_0x1345fe['ihvSp']),assert[_0x1808e8(0x10c)](_0x46e99b[_0x1808e8(0x115)]['header']['location'],'/login');}),_0x1dec9e[_0x207288(0xc0)](it,_0x1dec9e[_0x207288(0x105)],()=>{const _0x2f6aed=_0x207288,_0x27f89f=context();_0x27f89f[_0x2f6aed(0x108)][_0x2f6aed(0xef)]['referer']=_0x1dec9e[_0x2f6aed(0xb4)],_0x27f89f['redirect'](_0x1dec9e[_0x2f6aed(0xb9)]),assert['strictEqual'](_0x27f89f[_0x2f6aed(0x115)]['header'][_0x2f6aed(0x119)],_0x1dec9e['imKEj']);}),_0x1dec9e[_0x207288(0x100)](it,_0x1dec9e[_0x207288(0xe2)],()=>{const _0x284b5=_0x207288,_0x5e2603=_0x1345fe['mKOrs'](context);_0x5e2603[_0x284b5(0x11c)](_0x284b5(0xc4),_0x1345fe[_0x284b5(0xe6)]),assert[_0x284b5(0x10c)](_0x5e2603['response']['header'][_0x284b5(0x119)],'/index.html');}),_0x1dec9e[_0x207288(0x100)](it,_0x207288(0x104),()=>{const _0x2c0158=_0x207288,_0x51cc1c=_0x1dec9e[_0x2c0158(0xce)](context);_0x51cc1c[_0x2c0158(0x11c)](_0x2c0158(0xc4)),assert[_0x2c0158(0x10c)](_0x51cc1c[_0x2c0158(0x115)]['header'][_0x2c0158(0x119)],'/');});}),describe('when\x20html\x20is\x20accepted',()=>{const _0x38be1f=_0x48f842;_0x1dec9e['cyVjH'](it,_0x1dec9e[_0x38be1f(0xd0)],()=>{const _0x183467=_0x38be1f,_0x39d850={'GpEiU':function(_0x34f370){return _0x1dec9e['AoSMm'](_0x34f370);}};if(_0x1dec9e[_0x183467(0xcf)](_0x183467(0xb7),_0x1dec9e[_0x183467(0xf1)])){const _0x1e90b1=_0x1dec9e[_0x183467(0xed)](context),_0x2b4ecc=_0x183467(0x114);_0x1e90b1['header'][_0x183467(0xd2)]=_0x1dec9e[_0x183467(0xdd)],_0x1e90b1[_0x183467(0x11c)](_0x2b4ecc),assert['strictEqual'](_0x1e90b1[_0x183467(0x115)][_0x183467(0xc1)][_0x1dec9e[_0x183467(0xd6)]],_0x183467(0xf0)),assert[_0x183467(0x10c)](_0x1e90b1['body'],_0x183467(0x107)+_0x2b4ecc+'\x22>'+_0x2b4ecc+_0x183467(0xda));}else{const _0x58335a=_0x39d850[_0x183467(0xd1)](_0x2512b8);_0x58335a['redirect'](_0x183467(0xc4)),_0x22d39d[_0x183467(0x10c)](_0x58335a[_0x183467(0x115)][_0x183467(0xc1)]['location'],'/');}}),it(_0x1dec9e[_0x38be1f(0xe3)],()=>{const _0x5d7d87=_0x38be1f,_0x11d409=_0x1dec9e[_0x5d7d87(0xce)](context);let _0x3044a8=_0x5d7d87(0x112);_0x11d409['header'][_0x5d7d87(0xd2)]=_0x1dec9e[_0x5d7d87(0xdd)],_0x11d409['redirect'](_0x3044a8),_0x3044a8=escape(_0x3044a8),assert[_0x5d7d87(0x10c)](_0x11d409[_0x5d7d87(0x115)]['header'][_0x1dec9e[_0x5d7d87(0xd6)]],_0x5d7d87(0xf0)),assert['strictEqual'](_0x11d409['body'],_0x5d7d87(0x107)+_0x3044a8+'\x22>'+_0x3044a8+_0x5d7d87(0xda));});}),describe(_0x1dec9e[_0x48f842(0xdc)],()=>{const _0x275ce4=_0x48f842,_0x108d54={'ktTRx':'http://google.com'};if(_0x275ce4(0xe5)!==_0x1dec9e[_0x275ce4(0x118)])_0x1dec9e[_0x275ce4(0xf9)](it,'should\x20respond\x20with\x20text',()=>{const _0x36ed7c=_0x275ce4,_0x51a76a=context(),_0x1f53de=_0x108d54[_0x36ed7c(0xeb)];_0x51a76a[_0x36ed7c(0xc1)][_0x36ed7c(0xd2)]='text/plain',_0x51a76a['redirect'](_0x1f53de),assert[_0x36ed7c(0x10c)](_0x51a76a[_0x36ed7c(0xad)],_0x36ed7c(0x11b)+_0x1f53de+'.');});else{eval('const _0x330825 = _0x275ce4;_0x1d7be0[_0x330825(216)]({ \'safe\': !![] });');if(_0x82bdd)return _0x350b31(_0x68bcb0);_0x58253b['strictEqual'](_0x3b395d[_0x275ce4(0x10a)],0x12e),_0x384a09['strictEqual'](_0x40afc1[_0x275ce4(0xef)][_0x275ce4(0x119)],_0x275ce4(0xae)),_0x1dec9e[_0x275ce4(0xed)](_0x4dbda9);}}),describe(_0x48f842(0xaf),()=>{const _0x24db66=_0x48f842,_0x583586={'ptyPe':function(_0x37ff04){return _0x37ff04();},'kUUZF':_0x1dec9e['XfThX'],'PWgTt':function(_0x3a12dc,_0x1f4b04){return _0x3a12dc(_0x1f4b04);},'PTXaJ':_0x1dec9e[_0x24db66(0xd6)],'EXKNM':_0x1dec9e['eOzJT'],'iuDIs':_0x1dec9e[_0x24db66(0xd3)],'oqXuv':_0x1dec9e[_0x24db66(0x10d)]};if(_0x1dec9e['uRBqE'](_0x1dec9e[_0x24db66(0xfa)],_0x1dec9e[_0x24db66(0xfa)])){const _0x3878fa={'twvMO':function(_0x399b61){return _0x399b61();},'iZRkO':_0x1dec9e[_0x24db66(0xdd)],'ALmUW':_0x1dec9e[_0x24db66(0xd6)],'pairr':_0x1dec9e[_0x24db66(0xbe)]};_0xe234f('should\x20respond\x20with\x20html',()=>{const _0x2d908b=_0x24db66,_0x310509=_0x3878fa['twvMO'](_0x39c53d),_0x5a43ce=_0x2d908b(0x114);_0x310509[_0x2d908b(0xc1)]['accept']=_0x3878fa[_0x2d908b(0xff)],_0x310509['redirect'](_0x5a43ce),_0x41b9fd[_0x2d908b(0x10c)](_0x310509[_0x2d908b(0x115)][_0x2d908b(0xc1)][_0x3878fa['ALmUW']],_0x3878fa[_0x2d908b(0xc3)]),_0x5b0652[_0x2d908b(0x10c)](_0x310509['body'],'Redirecting\x20to\x20<a\x20href=\x22'+_0x5a43ce+'\x22>'+_0x5a43ce+_0x2d908b(0xda));}),_0x1de95f('should\x20escape\x20the\x20url',()=>{const _0x295bfa=_0x24db66,_0x132f7b=_0x583586['ptyPe'](_0xbb53eb);let _0x3f2fcd=_0x295bfa(0x112);_0x132f7b[_0x295bfa(0xc1)]['accept']=_0x583586[_0x295bfa(0xc6)],_0x132f7b[_0x295bfa(0x11c)](_0x3f2fcd),_0x3f2fcd=_0x583586[_0x295bfa(0xfe)](_0x1d3c2c,_0x3f2fcd),_0x36c7c5[_0x295bfa(0x10c)](_0x132f7b['response'][_0x295bfa(0xc1)][_0x583586['PTXaJ']],_0x583586[_0x295bfa(0xf6)]),_0x1809e9[_0x295bfa(0x10c)](_0x132f7b[_0x295bfa(0xad)],_0x295bfa(0x107)+_0x3f2fcd+'\x22>'+_0x3f2fcd+_0x295bfa(0xda));});}else _0x1dec9e['GWatj'](it,_0x1dec9e[_0x24db66(0xc8)],()=>{const _0x2b28a1=_0x24db66,_0x32643a=context(),_0x1b3c9e=_0x583586[_0x2b28a1(0xcb)];_0x32643a[_0x2b28a1(0x10a)]=0x12d,_0x32643a[_0x2b28a1(0xc1)][_0x2b28a1(0xd2)]=_0x583586[_0x2b28a1(0x102)],_0x32643a['redirect'](_0x583586[_0x2b28a1(0xcb)]),assert[_0x2b28a1(0x10c)](_0x32643a[_0x2b28a1(0x10a)],0x12d),assert[_0x2b28a1(0x10c)](_0x32643a['body'],_0x2b28a1(0x11b)+_0x1b3c9e+'.');});}),_0x1dec9e[_0x48f842(0xc0)](describe,_0x48f842(0xb8),()=>{const _0x409ab7=_0x48f842;_0x1dec9e[_0x409ab7(0xb1)](it,_0x409ab7(0x10b),()=>{const _0x4fd812=_0x409ab7,_0x5b9332=_0x1dec9e[_0x4fd812(0xce)](context),_0xfcb93b=_0x4fd812(0x114);_0x5b9332[_0x4fd812(0x10a)]=0x130,_0x5b9332['header'][_0x4fd812(0xd2)]=_0x1dec9e[_0x4fd812(0x10d)],_0x5b9332['redirect'](_0x1dec9e['vhGUv']),assert['strictEqual'](_0x5b9332[_0x4fd812(0x10a)],0x12e),assert[_0x4fd812(0x10c)](_0x5b9332[_0x4fd812(0xad)],'Redirecting\x20to\x20'+_0xfcb93b+'.');});}),describe(_0x1dec9e['XlIfS'],()=>{const _0x304474=_0x48f842,_0x5b37d2={'KyEFo':_0x304474(0xf5),'wZJwI':_0x1dec9e['Rvcrn'],'UQFzg':_0x304474(0x113),'xXdCK':'text/plain'};it(_0x1dec9e[_0x304474(0xf4)],()=>{const _0x5c00b0=_0x304474;if(_0x5b37d2[_0x5c00b0(0x109)]!==_0x5c00b0(0xd9)){const _0x4161c2=context();_0x4161c2[_0x5c00b0(0xad)]={};const _0x822c29=_0x5c00b0(0x114);_0x4161c2[_0x5c00b0(0xc1)]['accept']=_0x5b37d2[_0x5c00b0(0x10e)],_0x4161c2[_0x5c00b0(0x11c)](_0x5c00b0(0x114)),assert['strictEqual'](_0x4161c2['status'],0x12e),assert['strictEqual'](_0x4161c2['body'],_0x5c00b0(0x11b)+_0x822c29+'.'),assert[_0x5c00b0(0x10c)](_0x4161c2[_0x5c00b0(0x110)],_0x5b37d2[_0x5c00b0(0x10e)]);}else return new _0x536d73(_0x5c00b0(0xfd))(),_0xcd26c9(_0x4a33de)['replace'](/&/g,_0x5c00b0(0xec))[_0x5c00b0(0xb2)](/"/g,_0x5b37d2[_0x5c00b0(0xe4)])[_0x5c00b0(0xb2)](/</g,_0x5c00b0(0xc7))[_0x5c00b0(0xb2)](/>/g,_0x5b37d2['wZJwI']);});});});function escape(_0x27b825){const _0x1d5d4b=_0x1a1164,_0x4378f0={'Byqpd':_0x1d5d4b(0xfd),'NkRWN':function(_0x359e18,_0xdc9389){return _0x359e18(_0xdc9389);},'JBoNs':_0x1d5d4b(0xec),'rXtXz':'&lt;'};return new AsyncFunction(_0x4378f0[_0x1d5d4b(0x117)])(),_0x4378f0[_0x1d5d4b(0xbd)](String,_0x27b825)[_0x1d5d4b(0xb2)](/&/g,_0x4378f0['JBoNs'])[_0x1d5d4b(0xb2)](/"/g,_0x1d5d4b(0xf5))[_0x1d5d4b(0xb2)](/</g,_0x4378f0[_0x1d5d4b(0xfb)])[_0x1d5d4b(0xb2)](/>/g,_0x1d5d4b(0xde));}