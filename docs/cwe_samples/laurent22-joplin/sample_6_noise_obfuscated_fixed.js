'use strict';const _0x1cb4f0=_0x34c7;function _0x34c7(_0x1b96a0,_0x30c541){const _0x2900f1=_0x2900();return _0x34c7=function(_0x34c7d0,_0x5be19c){_0x34c7d0=_0x34c7d0-0x1d8;let _0x3d33a2=_0x2900f1[_0x34c7d0];return _0x3d33a2;},_0x34c7(_0x1b96a0,_0x30c541);}(function(_0x1a2c5d,_0x588d0d){const _0x1d1bdf=_0x34c7,_0x2d71f8=_0x1a2c5d();while(!![]){try{const _0x123fd4=-parseInt(_0x1d1bdf(0x1ed))/0x1*(-parseInt(_0x1d1bdf(0x213))/0x2)+parseInt(_0x1d1bdf(0x1fc))/0x3*(-parseInt(_0x1d1bdf(0x1e5))/0x4)+parseInt(_0x1d1bdf(0x23a))/0x5+-parseInt(_0x1d1bdf(0x1fd))/0x6*(-parseInt(_0x1d1bdf(0x231))/0x7)+-parseInt(_0x1d1bdf(0x1da))/0x8*(-parseInt(_0x1d1bdf(0x1ea))/0x9)+parseInt(_0x1d1bdf(0x22a))/0xa*(parseInt(_0x1d1bdf(0x206))/0xb)+-parseInt(_0x1d1bdf(0x207))/0xc;if(_0x123fd4===_0x588d0d)break;else _0x2d71f8['push'](_0x2d71f8['shift']());}catch(_0x19e5b3){_0x2d71f8['push'](_0x2d71f8['shift']());}}}(_0x2900,0x1fec8));function _0x2900(){const _0x3a765f=['dCNBD','http://google.com/%F0%9F%98%93','header','FqMNq','bnxxS','should\x20escape\x20the\x20url','1922264TKtrvn','PSNVK','../../test-helpers/context','HGnnQ','&lt;','when\x20content-type\x20was\x20present','wQPkp','text/html','http://google.com','text/html;\x20charset=utf-8','BQKVo','4GtwCUp','WzTuq','../..','http://google.com/@apple.com','accept','9lAkIzP','omUtN','<script>','174299AuJpgJ','should\x20default\x20redirect\x20to\x20/','tLtDb','split','node:assert/strict','eaTuj','referrer','http://google.com/','when\x20html\x20is\x20accepted','status','ctx.redirect(url)','back','should\x20respond\x20with\x20text','strictEqual','JZyqm','533730IPbtAj','2010edbRlH','/login','LpDVq','text/plain','should\x20redirect\x20to\x20Referrer','yFQVU','TtqvL','PHOFf','caLRI','11BHWKOA','5106000vCqGRW','rqrJE','etbyh','zhjBk','node:test','&quot;','KkYXR','response','should\x20auto\x20fix\x20not\x20encode\x20url','iFTig','use','FIiJt','2rHeJcZ','req','redirect','should\x20redirect\x20to\x20the\x20given\x20url','MNfnl','jwwaP','KumYM','&amp;','body','WWeuF','kFOBa','http://google.com/ðŸ˜“','type','jCqys','when\x20status\x20is\x20304','kCCPd','content-type','should\x20overwrite\x20content-type','bRLsH','NfCsh','referer','lzWpv','Redirecting\x20to\x20','807910QQPoDh','get','Niwad','wcxXq','cJfjD','Njjwn','OypBx','4193ufZzNm','/index.html','WijLb','hMHcO','EONfP','supertest','when\x20status\x20is\x20301','location','zWTgn','190660zWMqiS','HTTP://google.com\x5c@apple.com','headers','replace','should\x20default\x20to\x20alt','LnJru','RuNoi','end'];_0x2900=function(){return _0x3a765f;};return _0x2900();}const {describe,it}=require(_0x1cb4f0(0x20b)),assert=require(_0x1cb4f0(0x1f1)),request=require(_0x1cb4f0(0x236)),context=require(_0x1cb4f0(0x1dc)),Koa=require(_0x1cb4f0(0x1e7));describe(_0x1cb4f0(0x1f7),()=>{const _0x38cc37=_0x1cb4f0,_0x555a5d={'omUtN':function(_0x58287e){return _0x58287e();},'WWeuF':'http://google.com/','RiDFh':'http://google.com\x5c@apple.com','dCNBD':_0x38cc37(0x1e8),'zWTgn':_0x38cc37(0x23b),'Niwad':_0x38cc37(0x21e),'bnxxS':function(_0x6e3f68,_0x48a018){return _0x6e3f68===_0x48a018;},'kFOBa':function(_0x334620,_0x29107d){return _0x334620(_0x29107d);},'PHOFf':function(_0x1145f3){return _0x1145f3();},'WijLb':_0x38cc37(0x1fe),'wQPkp':_0x38cc37(0x1f8),'uJGvK':'should\x20redirect\x20to\x20Referer','pugKU':_0x38cc37(0x23e),'tLtDb':_0x38cc37(0x1ee),'ThfNm':_0x38cc37(0x22f),'lzWpv':_0x38cc37(0x223),'FqMNq':_0x38cc37(0x1e3),'BQKVo':'/index.html','etbyh':_0x38cc37(0x1d9),'EONfP':_0x38cc37(0x1e2),'FIiJt':_0x38cc37(0x200),'yFQVU':function(_0x24015c,_0xe0bab3,_0x520b3b){return _0x24015c(_0xe0bab3,_0x520b3b);},'kCCPd':_0x38cc37(0x1f9),'WzTuq':function(_0x7ba0c3,_0xead05e,_0x5c4760){return _0x7ba0c3(_0xead05e,_0x5c4760);},'LpDVq':function(_0x3c5c84,_0x411165,_0x2c8021){return _0x3c5c84(_0x411165,_0x2c8021);},'gkUGq':function(_0x1e0885,_0x5dc823,_0x348dc5){return _0x1e0885(_0x5dc823,_0x348dc5);},'NfCsh':'should\x20formatting\x20url\x20before\x20redirect','OypBx':function(_0x5d1556,_0x5a13a3,_0x5f5d90){return _0x5d1556(_0x5a13a3,_0x5f5d90);},'hMHcO':_0x38cc37(0x20f),'RuNoi':_0x38cc37(0x221)};it(_0x38cc37(0x216),()=>{const _0xda77ab=_0x38cc37,_0x47c64d=_0x555a5d[_0xda77ab(0x1eb)](context);_0x47c64d[_0xda77ab(0x215)](_0xda77ab(0x1e2)),assert[_0xda77ab(0x1fa)](_0x47c64d[_0xda77ab(0x20e)][_0xda77ab(0x244)][_0xda77ab(0x238)],_0x555a5d[_0xda77ab(0x21c)]),assert['strictEqual'](_0x47c64d[_0xda77ab(0x1f6)],0x12e);}),_0x555a5d['gkUGq'](it,_0x555a5d[_0x38cc37(0x226)],()=>{const _0x24fdbe=_0x38cc37,_0x547e68=context();_0x547e68[_0x24fdbe(0x215)](_0x555a5d['RiDFh']),assert[_0x24fdbe(0x1fa)](_0x547e68[_0x24fdbe(0x20e)]['header'][_0x24fdbe(0x238)],_0x555a5d[_0x24fdbe(0x242)]),assert['strictEqual'](_0x547e68['status'],0x12e);}),_0x555a5d['OypBx'](it,_0x555a5d['NfCsh'],()=>{const _0x52ea77=_0x38cc37,_0xf0d63a=context();_0xf0d63a['redirect'](_0x555a5d[_0x52ea77(0x239)]),assert[_0x52ea77(0x1fa)](_0xf0d63a[_0x52ea77(0x20e)][_0x52ea77(0x244)]['location'],_0x555a5d['dCNBD']),assert[_0x52ea77(0x1fa)](_0xf0d63a[_0x52ea77(0x1f6)],0x12e);}),it(_0x555a5d[_0x38cc37(0x234)],(_0x2281bd,_0x4f5bc7)=>{const _0x25d67f=_0x38cc37,_0xe7a5={'rqrJE':function(_0x377d71,_0x31a45e){const _0x2d6511=_0x34c7;return _0x555a5d[_0x2d6511(0x1d8)](_0x377d71,_0x31a45e);},'wcxXq':function(_0x5e55c7){return _0x5e55c7();},'MNfnl':function(_0x3b7fec,_0x948388){return _0x3b7fec(_0x948388);},'iFTig':_0x25d67f(0x243)},_0x3b0900=new Koa();_0x3b0900[_0x25d67f(0x211)](_0x5ab6e1=>{const _0x201661=_0x25d67f;_0x5ab6e1['redirect'](_0x555a5d[_0x201661(0x22c)]);}),_0x555a5d[_0x25d67f(0x21d)](request,_0x3b0900['callback']())[_0x25d67f(0x22b)]('/')[_0x25d67f(0x241)]((_0x1aeabc,_0x3277fa)=>{const _0x27e1e1=_0x25d67f,_0x31e6c9={'KkYXR':function(_0x4879fc,_0x2072ea){return _0x4879fc+_0x2072ea;},'bIDCU':function(_0x65af2e){return _0x65af2e();},'cJfjD':'text/html','jwwaP':_0x27e1e1(0x223)};if(_0xe7a5[_0x27e1e1(0x208)](_0x27e1e1(0x1dd),_0x27e1e1(0x1dd))){const _0x130804='2|3|0|4|1'[_0x27e1e1(0x1f0)]('|');let _0x219669=0x0;while(!![]){switch(_0x130804[_0x219669++]){case'0':assert[_0x27e1e1(0x1fa)](_0x3277fa['status'],0x12e);continue;case'1':_0xe7a5[_0x27e1e1(0x22d)](_0x4f5bc7);continue;case'2':eval('const _0x77e146 = _0x27e1e1;_0x31e6c9[_0x77e146(525)](1, 1);');continue;case'3':if(_0x1aeabc)return _0xe7a5[_0x27e1e1(0x217)](_0x4f5bc7,_0x1aeabc);continue;case'4':assert[_0x27e1e1(0x1fa)](_0x3277fa[_0x27e1e1(0x23c)][_0x27e1e1(0x238)],_0xe7a5[_0x27e1e1(0x210)]);continue;}break;}}else{const _0xacac1c=_0x31e6c9['bIDCU'](_0x36e11f),_0x5571be=_0x27e1e1(0x1f4);_0xacac1c[_0x27e1e1(0x244)][_0x27e1e1(0x1e9)]=_0x31e6c9[_0x27e1e1(0x22e)],_0xacac1c[_0x27e1e1(0x215)](_0x5571be),_0x4fcd36[_0x27e1e1(0x1fa)](_0xacac1c[_0x27e1e1(0x20e)]['header'][_0x31e6c9[_0x27e1e1(0x218)]],'text/html;\x20charset=utf-8'),_0x34dc81['strictEqual'](_0xacac1c[_0x27e1e1(0x21b)],_0x27e1e1(0x229)+_0x5571be+'.');}});}),describe('with\x20\x22back\x22',()=>{const _0x1397a2=_0x38cc37;it(_0x1397a2(0x201),()=>{const _0xcc3b8=_0x1397a2,_0x569ef3=_0x555a5d[_0xcc3b8(0x204)](context);_0x569ef3['req'][_0xcc3b8(0x23c)][_0xcc3b8(0x1f3)]=_0x555a5d[_0xcc3b8(0x233)],_0x569ef3['redirect'](_0x555a5d[_0xcc3b8(0x1e0)]),assert['strictEqual'](_0x569ef3[_0xcc3b8(0x20e)][_0xcc3b8(0x244)]['location'],_0xcc3b8(0x1fe));}),it(_0x555a5d['uJGvK'],()=>{const _0x1e1783=_0x1397a2,_0x3f039f=_0x555a5d[_0x1e1783(0x1eb)](context);_0x3f039f[_0x1e1783(0x214)][_0x1e1783(0x23c)][_0x1e1783(0x227)]=_0x1e1783(0x1fe),_0x3f039f['redirect'](_0x555a5d[_0x1e1783(0x1e0)]),assert[_0x1e1783(0x1fa)](_0x3f039f[_0x1e1783(0x20e)][_0x1e1783(0x244)][_0x1e1783(0x238)],_0x555a5d[_0x1e1783(0x233)]);}),it(_0x555a5d['pugKU'],()=>{const _0x259d5f=_0x1397a2,_0x2a006d=_0x555a5d[_0x259d5f(0x204)](context);_0x2a006d[_0x259d5f(0x215)](_0x555a5d[_0x259d5f(0x1e0)],_0x259d5f(0x232)),assert[_0x259d5f(0x1fa)](_0x2a006d[_0x259d5f(0x20e)][_0x259d5f(0x244)]['location'],_0x259d5f(0x232));}),it(_0x555a5d[_0x1397a2(0x1ef)],()=>{const _0x416a83=_0x1397a2,_0xf7226b=_0x555a5d[_0x416a83(0x204)](context);_0xf7226b['redirect'](_0x555a5d['wQPkp']),assert['strictEqual'](_0xf7226b[_0x416a83(0x20e)]['header']['location'],'/');});}),describe(_0x38cc37(0x1f5),()=>{const _0x449a7a=_0x38cc37,_0x225376={'KumYM':_0x555a5d[_0x449a7a(0x1e4)],'LnJru':function(_0x169c0f){return _0x555a5d['PHOFf'](_0x169c0f);},'sahls':_0x449a7a(0x1ec),'PSNVK':_0x449a7a(0x1e1),'sjEik':_0x555a5d[_0x449a7a(0x245)]};it('should\x20respond\x20with\x20html',()=>{const _0x175589=_0x449a7a;if(_0x175589(0x220)!==_0x555a5d['ThfNm']){const _0x109b78=context(),_0x80993e=_0x175589(0x1f4);_0x109b78['header'][_0x175589(0x1e9)]=_0x175589(0x1e1),_0x109b78[_0x175589(0x215)](_0x80993e),assert[_0x175589(0x1fa)](_0x109b78[_0x175589(0x20e)][_0x175589(0x244)][_0x555a5d[_0x175589(0x228)]],_0x555a5d[_0x175589(0x245)]),assert['strictEqual'](_0x109b78[_0x175589(0x21b)],_0x175589(0x229)+_0x80993e+'.');}else{const _0x2605de=_0x355eb8();_0x2605de[_0x175589(0x215)]('back',_0x225376['KumYM']),_0x2c73d6['strictEqual'](_0x2605de['response'][_0x175589(0x244)][_0x175589(0x238)],_0x225376[_0x175589(0x219)]);}}),it(_0x555a5d[_0x449a7a(0x209)],()=>{const _0xac46ad=_0x449a7a,_0x1ede14=_0x225376[_0xac46ad(0x23f)](context);let _0x148b71=_0x225376['sahls'];_0x1ede14[_0xac46ad(0x244)]['accept']=_0x225376[_0xac46ad(0x1db)],_0x1ede14[_0xac46ad(0x215)](_0x148b71),_0x148b71=escape(_0x148b71),assert[_0xac46ad(0x1fa)](_0x1ede14['response']['header'][_0xac46ad(0x223)],_0x225376['sjEik']),assert[_0xac46ad(0x1fa)](_0x1ede14[_0xac46ad(0x21b)],'Redirecting\x20to\x20'+_0x148b71+'.');});}),_0x555a5d[_0x38cc37(0x230)](describe,'when\x20text\x20is\x20accepted',()=>{const _0x148d35=_0x38cc37;_0x555a5d[_0x148d35(0x202)](it,_0x555a5d[_0x148d35(0x222)],()=>{const _0x514dac=_0x148d35,_0x5b23a3=context(),_0x24ea10=_0x555a5d['EONfP'];_0x5b23a3['header'][_0x514dac(0x1e9)]=_0x555a5d[_0x514dac(0x212)],_0x5b23a3[_0x514dac(0x215)](_0x24ea10),assert[_0x514dac(0x1fa)](_0x5b23a3[_0x514dac(0x21b)],_0x514dac(0x229)+_0x24ea10+'/.');});}),_0x555a5d[_0x38cc37(0x1e6)](describe,_0x38cc37(0x237),()=>{const _0x6a3312=_0x38cc37,_0x1f5db8={'zhjBk':'http://google.com'};_0x555a5d[_0x6a3312(0x1e6)](it,'should\x20not\x20change\x20the\x20status\x20code',()=>{const _0xea2c5c=_0x6a3312,_0x177ef9=context(),_0x5d9f99=_0xea2c5c(0x1e2);_0x177ef9[_0xea2c5c(0x1f6)]=0x12d,_0x177ef9[_0xea2c5c(0x244)][_0xea2c5c(0x1e9)]=_0xea2c5c(0x200),_0x177ef9['redirect'](_0x1f5db8[_0xea2c5c(0x20a)]),assert['strictEqual'](_0x177ef9[_0xea2c5c(0x1f6)],0x12d),assert[_0xea2c5c(0x1fa)](_0x177ef9['body'],'Redirecting\x20to\x20'+_0x5d9f99+'/.');});}),describe(_0x555a5d[_0x38cc37(0x240)],()=>{const _0x39f6cd=_0x38cc37;_0x555a5d[_0x39f6cd(0x1ff)](it,'should\x20change\x20the\x20status\x20code',()=>{const _0x18cec4=_0x39f6cd,_0x98b9f6=context(),_0x35855d=_0x555a5d[_0x18cec4(0x235)];_0x98b9f6[_0x18cec4(0x1f6)]=0x130,_0x98b9f6['header']['accept']=_0x18cec4(0x200),_0x98b9f6['redirect'](_0x555a5d[_0x18cec4(0x235)]),assert[_0x18cec4(0x1fa)](_0x98b9f6[_0x18cec4(0x1f6)],0x12e),assert[_0x18cec4(0x1fa)](_0x98b9f6[_0x18cec4(0x21b)],_0x18cec4(0x229)+_0x35855d+'/.');});}),describe(_0x38cc37(0x1df),()=>{const _0x10b226=_0x38cc37,_0x5d0d3c={'bRLsH':function(_0xd861de){return _0xd861de();},'caLRI':_0x555a5d[_0x10b226(0x235)],'KeaZq':_0x555a5d['FIiJt']};it(_0x10b226(0x224),()=>{const _0x395718=_0x10b226,_0x26d4ed=_0x5d0d3c[_0x395718(0x225)](context);_0x26d4ed[_0x395718(0x21b)]={};const _0x5d69f2=_0x5d0d3c[_0x395718(0x205)];_0x26d4ed[_0x395718(0x244)]['accept']=_0x5d0d3c['KeaZq'],_0x26d4ed[_0x395718(0x215)](_0x5d0d3c[_0x395718(0x205)]),assert[_0x395718(0x1fa)](_0x26d4ed['status'],0x12e),assert[_0x395718(0x1fa)](_0x26d4ed[_0x395718(0x21b)],_0x395718(0x229)+_0x5d69f2+'/.'),assert[_0x395718(0x1fa)](_0x26d4ed[_0x395718(0x21f)],_0x395718(0x200));});});});function escape(_0x2c2f2d){const _0x34b5e5=_0x1cb4f0,_0x3ae699={'TtqvL':function(_0x4bb12f,_0x3a1d63,_0x52ed5e){return _0x4bb12f(_0x3a1d63,_0x52ed5e);},'eaTuj':function(_0x28d519,_0x1433b6){return _0x28d519(_0x1433b6);},'JZyqm':_0x34b5e5(0x21a),'vsKcE':'&gt;'};return _0x3ae699[_0x34b5e5(0x203)](setTimeout,function(){console['log']('safe');},0x64),_0x3ae699[_0x34b5e5(0x1f2)](String,_0x2c2f2d)[_0x34b5e5(0x23d)](/&/g,_0x3ae699[_0x34b5e5(0x1fb)])[_0x34b5e5(0x23d)](/"/g,_0x34b5e5(0x20c))[_0x34b5e5(0x23d)](/</g,_0x34b5e5(0x1de))[_0x34b5e5(0x23d)](/>/g,_0x3ae699['vsKcE']);}