'use strict';const _0x2e0581=_0xea48;function _0xea48(_0x477481,_0x390ec5){const _0x449bc=_0x449b();return _0xea48=function(_0xea480e,_0x1b8cd7){_0xea480e=_0xea480e-0x192;let _0x5a1f47=_0x449bc[_0xea480e];return _0x5a1f47;},_0xea48(_0x477481,_0x390ec5);}(function(_0x3f2c89,_0x3fe2df){const _0x32cc87=_0xea48,_0x334029=_0x3f2c89();while(!![]){try{const _0x10fcf5=parseInt(_0x32cc87(0x1b0))/0x1+-parseInt(_0x32cc87(0x1a4))/0x2+parseInt(_0x32cc87(0x1a2))/0x3*(parseInt(_0x32cc87(0x19a))/0x4)+-parseInt(_0x32cc87(0x1bb))/0x5*(parseInt(_0x32cc87(0x1a5))/0x6)+parseInt(_0x32cc87(0x1a7))/0x7*(parseInt(_0x32cc87(0x1aa))/0x8)+parseInt(_0x32cc87(0x194))/0x9+-parseInt(_0x32cc87(0x19d))/0xa*(parseInt(_0x32cc87(0x1ac))/0xb);if(_0x10fcf5===_0x3fe2df)break;else _0x334029['push'](_0x334029['shift']());}catch(_0x41d315){_0x334029['push'](_0x334029['shift']());}}}(_0x449b,0xe54d8));const {describe,it}=require(_0x2e0581(0x1af)),assert=require(_0x2e0581(0x1b5)),context=require(_0x2e0581(0x199));function _0x449b(){const _0x329fce=['req','location','fGPFy','3CwzsZq','GWqgx','3649496dyDWiz','26112dBKmuP','CbBAr','3710WGCcyj','Idlyz','equal','9896vBhjpN','example.com','521961srTOxr','host','should\x20redirect\x20to\x20Referer','node:test','1567920LJQJyj','should\x20redirect\x20to\x20root\x20if\x20the\x20same\x20origin\x20referrer\x20is\x20not\x20present','/index.html','JFJFk','ElptA','node:assert/strict','referer','lInNt','BBnpF','header','/login','70YbuXCX','headers','JAJhM','6385212rnSWQN','response','XVXAG','should\x20redirect\x20to\x20the\x20same\x20origin\x20referrer','referrer','../../test-helpers/context','4312708zgjURm','back','https://example.com/login','250qtvGvs','ctx.back([alt])'];_0x449b=function(){return _0x329fce;};return _0x449b();}describe(_0x2e0581(0x19e),()=>{const _0x1ee466=_0x2e0581,_0x1c64f6={'JFJFk':_0x1ee466(0x1ba),'Idlyz':_0x1ee466(0x19c),'ElptA':function(_0x2abfb3){return _0x2abfb3();},'BBnpF':_0x1ee466(0x1ab),'bqKQR':_0x1ee466(0x1b2),'JAJhM':function(_0x6d0ac3){return _0x6d0ac3();},'CbBAr':function(_0x1e6642,_0x227d68,_0x59e9df){return _0x1e6642(_0x227d68,_0x59e9df);},'lInNt':_0x1ee466(0x197),'GWqgx':function(_0x117c30,_0x6861dd,_0x112655){return _0x117c30(_0x6861dd,_0x112655);},'GvuYJ':function(_0x13420f,_0x365ef2,_0x546276){return _0x13420f(_0x365ef2,_0x546276);},'XVXAG':'should\x20default\x20to\x20alt','fGPFy':function(_0xd6a33b,_0x4100be,_0xcefc30){return _0xd6a33b(_0x4100be,_0xcefc30);},'fTjZT':'should\x20default\x20redirect\x20to\x20/'};it('should\x20redirect\x20to\x20Referrer',()=>{const _0x276b60=_0x1ee466,_0x57c88d=context();_0x57c88d[_0x276b60(0x19f)][_0x276b60(0x192)][_0x276b60(0x198)]='/login',_0x57c88d[_0x276b60(0x19b)](),assert[_0x276b60(0x1a9)](_0x57c88d[_0x276b60(0x195)][_0x276b60(0x1b9)][_0x276b60(0x1a0)],_0x1c64f6[_0x276b60(0x1b3)]);}),_0x1c64f6[_0x1ee466(0x1a6)](it,_0x1c64f6[_0x1ee466(0x1b7)],()=>{const _0x4429fb=_0x1ee466,_0x771a65=context();_0x771a65[_0x4429fb(0x19f)][_0x4429fb(0x192)][_0x4429fb(0x1ad)]=_0x4429fb(0x1ab),_0x771a65[_0x4429fb(0x19f)][_0x4429fb(0x192)][_0x4429fb(0x198)]=_0x1c64f6[_0x4429fb(0x1a8)],_0x771a65[_0x4429fb(0x19b)](),assert[_0x4429fb(0x1a9)](_0x771a65[_0x4429fb(0x195)][_0x4429fb(0x1b9)][_0x4429fb(0x1a0)],_0x1c64f6[_0x4429fb(0x1a8)]);}),_0x1c64f6[_0x1ee466(0x1a3)](it,_0x1ee466(0x1b1),()=>{const _0x25f11b=_0x1ee466,_0x2aa575=_0x1c64f6[_0x25f11b(0x1b4)](context);_0x2aa575[_0x25f11b(0x19f)][_0x25f11b(0x192)][_0x25f11b(0x1ad)]=_0x1c64f6[_0x25f11b(0x1b8)],_0x2aa575[_0x25f11b(0x19f)][_0x25f11b(0x192)]['referrer']='https://other.com/login',_0x2aa575[_0x25f11b(0x19b)](),assert[_0x25f11b(0x1a9)](_0x2aa575['response']['header']['location'],'/');}),_0x1c64f6['GvuYJ'](it,_0x1ee466(0x1ae),()=>{const _0x42ca4a=_0x1ee466,_0x5d2f98=context();_0x5d2f98['req'][_0x42ca4a(0x192)][_0x42ca4a(0x1b6)]=_0x1c64f6[_0x42ca4a(0x1b3)],_0x5d2f98['back'](),assert[_0x42ca4a(0x1a9)](_0x5d2f98[_0x42ca4a(0x195)][_0x42ca4a(0x1b9)][_0x42ca4a(0x1a0)],_0x42ca4a(0x1ba));}),it(_0x1c64f6[_0x1ee466(0x196)],()=>{const _0x4813d4=_0x1ee466,_0x29d589=context();_0x29d589[_0x4813d4(0x19b)](_0x4813d4(0x1b2)),assert[_0x4813d4(0x1a9)](_0x29d589[_0x4813d4(0x195)][_0x4813d4(0x1b9)]['location'],_0x1c64f6['bqKQR']);}),_0x1c64f6[_0x1ee466(0x1a1)](it,_0x1c64f6['fTjZT'],()=>{const _0x21ba83=_0x1ee466,_0x5db926=_0x1c64f6[_0x21ba83(0x193)](context);_0x5db926[_0x21ba83(0x19b)](),assert[_0x21ba83(0x1a9)](_0x5db926[_0x21ba83(0x195)][_0x21ba83(0x1b9)][_0x21ba83(0x1a0)],'/');});});