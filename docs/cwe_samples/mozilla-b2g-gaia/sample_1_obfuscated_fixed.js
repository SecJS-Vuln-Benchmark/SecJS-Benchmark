function _0x17b3(_0xd3147c,_0x483733){const _0x5bcae2=_0x5bca();return _0x17b3=function(_0x17b3cc,_0x2cda20){_0x17b3cc=_0x17b3cc-0x160;let _0x2f7fed=_0x5bcae2[_0x17b3cc];return _0x2f7fed;},_0x17b3(_0xd3147c,_0x483733);}const _0x27f178=_0x17b3;(function(_0x3e2b77,_0x5be071){const _0x1dd2c9=_0x17b3,_0x5ddd4c=_0x3e2b77();while(!![]){try{const _0x222092=parseInt(_0x1dd2c9(0x174))/0x1+-parseInt(_0x1dd2c9(0x250))/0x2*(-parseInt(_0x1dd2c9(0x293))/0x3)+parseInt(_0x1dd2c9(0x1d2))/0x4+parseInt(_0x1dd2c9(0x230))/0x5+-parseInt(_0x1dd2c9(0x185))/0x6+-parseInt(_0x1dd2c9(0x171))/0x7+parseInt(_0x1dd2c9(0x28c))/0x8;if(_0x222092===_0x5be071)break;else _0x5ddd4c['push'](_0x5ddd4c['shift']());}catch(_0x42a277){_0x5ddd4c['push'](_0x5ddd4c['shift']());}}}(_0x5bca,0x45590),process[_0x27f178(0x2af)][_0x27f178(0x1a5)]===_0x27f178(0x160)?require('dotenv')['config']({'path':_0x27f178(0x28d)+process[_0x27f178(0x2af)][_0x27f178(0x1a5)]}):require(_0x27f178(0x27b))['config']());const {viewLocalFiles,normalizePath,isWithin}=require(_0x27f178(0x29b)),{purgeDocument,purgeFolder}=require('../utils/files/purgeDocument'),{getVectorDbClass}=require(_0x27f178(0x27e)),{updateENV,dumpENV}=require(_0x27f178(0x19f)),{reqBody,makeJWT,userFromSession,multiUserMode,queryParams}=require('../utils/http'),{handleAssetUpload,handlePfpUpload}=require(_0x27f178(0x1ec)),{v4}=require(_0x27f178(0x291)),{SystemSettings}=require('../models/systemSettings'),{User}=require(_0x27f178(0x2b2)),{validatedRequest}=require(_0x27f178(0x19c)),fs=require('fs'),path=require('path'),{getDefaultFilename,determineLogoFilepath,fetchLogo,validFilename,renameLogoFile,removeCustomLogo,LOGO_FILENAME,isDefaultFilename}=require('../utils/files/logo'),{Telemetry}=require(_0x27f178(0x1e0)),{WelcomeMessages}=require(_0x27f178(0x235)),{ApiKey}=require(_0x27f178(0x238)),{getCustomModels}=require(_0x27f178(0x209)),{WorkspaceChats}=require(_0x27f178(0x246)),{flexUserRoleValid,ROLES,isMultiUserSetup}=require(_0x27f178(0x1e5)),{fetchPfp,determinePfpFilepath}=require('../utils/files/pfp'),{exportChatsAsType}=require('../utils/helpers/chat/convertTo'),{EventLogs}=require('../models/eventLogs'),{CollectorApi}=require(_0x27f178(0x28e)),{recoverAccount,resetPassword,generateRecoveryCodes}=require(_0x27f178(0x1f3)),{SlashCommandPresets}=require('../models/slashCommandsPresets'),{EncryptionManager}=require(_0x27f178(0x21f)),{BrowserExtensionApiKey}=require(_0x27f178(0x274)),{chatHistoryViewable}=require(_0x27f178(0x219)),{simpleSSOEnabled}=require('../utils/middleware/simpleSSOEnabled'),{TemporaryAuthToken}=require(_0x27f178(0x217));function systemEndpoints(_0x7047ce){const _0x325e92=_0x27f178,_0x23ab36={'rpcwD':_0x325e92(0x2b3),'lZSlW':function(_0x2b7e4a,_0x40a9e9){return _0x2b7e4a!==_0x40a9e9;},'PwUPP':_0x325e92(0x223),'DCSAt':function(_0x3bd0aa){return _0x3bd0aa();},'xvQzJ':_0x325e92(0x1bd),'WFodz':'tHOkz','ZGogg':_0x325e92(0x2b0),'dcyBJ':_0x325e92(0x19e),'KOapZ':function(_0x4101bd,_0x5bbaf0){return _0x4101bd(_0x5bbaf0);},'ALypo':'failed_login_invalid_username','KoFpJ':_0x325e92(0x18a),'gQtuN':function(_0x381791,_0x16482f){return _0x381791||_0x16482f;},'rGxWA':_0x325e92(0x265),'htUtA':_0x325e92(0x1e4),'gbwId':function(_0x408ee6,_0x3a5c5a){return _0x408ee6||_0x3a5c5a;},'pmSgN':_0x325e92(0x208),'QmEaD':function(_0x1226f4,_0x5ba3e9){return _0x1226f4(_0x5ba3e9);},'Ayhvp':function(_0x46d75e,_0x267837,_0x2cb729){return _0x46d75e(_0x267837,_0x2cb729);},'OMhQB':_0x325e92(0x204),'STVng':_0x325e92(0x234),'zvFDZ':'login_event','nQkaY':'QLCKW','QkkuR':_0x325e92(0x21a),'BsSPV':function(_0x2f883f,_0x3c825c){return _0x2f883f(_0x3c825c);},'QgooK':_0x325e92(0x162),'cGvAH':function(_0x3b96fd,_0x3acdc8){return _0x3b96fd(_0x3acdc8);},'rzDZd':function(_0x5c8e33,_0x41f64e,_0x19803c,_0x3b143a){return _0x5c8e33(_0x41f64e,_0x19803c,_0x3b143a);},'UfUSQ':_0x325e92(0x280),'CyYjk':'xLmts','CCPoY':function(_0xb563b8,_0x279403){return _0xb563b8===_0x279403;},'bSDYp':function(_0x734761,_0x3606b5){return _0x734761(_0x3606b5);},'PhsVW':function(_0x461155,_0x164be4){return _0x461155===_0x164be4;},'nBeWF':_0x325e92(0x1c1),'nxYub':function(_0x2e22a8,_0x2ed770){return _0x2e22a8===_0x2ed770;},'vdsJR':_0x325e92(0x227),'jNqJC':'CYImT','Bzsxs':_0x325e92(0x1b9),'rDTGy':function(_0x312f1b,_0x508aa2){return _0x312f1b(_0x508aa2);},'QIBxl':function(_0x5e2026,_0x2449eb){return _0x5e2026(_0x2449eb);},'VazgE':function(_0x33ea23){return _0x33ea23();},'KWcfa':_0x325e92(0x284),'KvskC':'cLoaS','gbOwE':_0x325e92(0x1f6),'pkCFB':_0x325e92(0x17e),'HavCU':'enabled_multi_user_mode','NJGuH':_0x325e92(0x1ff),'mDYqW':'mOpkl','ZxjJu':function(_0x532687,_0x57f13c){return _0x532687(_0x57f13c);},'BXZIj':'image/png','ESrWh':function(_0x1d7bd6,_0x16f7d1){return _0x1d7bd6!==_0x16f7d1;},'UKWHO':'CThRy','EkLnI':_0x325e92(0x267),'fSpqR':'Error\x20fetching\x20footer\x20data:','AgkKx':_0x325e92(0x1cd),'VREwY':'support_email','AmobF':function(_0x48e3cc,_0x12a604){return _0x48e3cc===_0x12a604;},'ujRpn':_0x325e92(0x197),'AWYRL':_0x325e92(0x187),'gNKnu':_0x325e92(0x1e2),'isbVc':function(_0x1ad32f,_0x408e1c){return _0x1ad32f(_0x408e1c);},'SrNuE':'base64','zVWYF':_0x325e92(0x1c0),'gGEel':'No\x20updates\x20provided','JFEuq':'NLkaN','bnWqt':_0x325e92(0x22f),'rMZiH':function(_0x55d7f9,_0x1c0ec3){return _0x55d7f9!==_0x1c0ec3;},'HjCSV':'../storage/assets/pfp','UGJME':_0x325e92(0x24a),'kRCFk':_0x325e92(0x180),'FUVuN':function(_0x1d42c7,_0x7ae2f){return _0x1d42c7||_0x7ae2f;},'dSCDS':function(_0x2f4b2d,_0x1f1af6){return _0x2f4b2d(_0x1f1af6);},'beIPD':_0x325e92(0x16f),'rJoDU':function(_0x33e58b,_0x628594){return _0x33e58b!==_0x628594;},'kITvO':'ZTUQF','Kxupi':_0x325e92(0x210),'VNJaf':_0x325e92(0x200),'winTD':_0x325e92(0x164),'DrFku':_0x325e92(0x288),'YtFMq':function(_0x17d823,_0x318c7b){return _0x17d823!==_0x318c7b;},'dNQYM':_0x325e92(0x1cb),'efUcm':function(_0x5eafed,_0x15d0fd){return _0x5eafed===_0x15d0fd;},'MZsEO':'cejQX','sSamN':_0x325e92(0x1b2),'BpXEY':'Error\x20processing\x20the\x20logo\x20removal:','PBlcF':_0x325e92(0x23d),'hZsAa':function(_0x4d557f,_0x199eb2){return _0x4d557f!==_0x199eb2;},'drQKF':_0x325e92(0x232),'FfdfP':function(_0x1eea51,_0x241c85){return _0x1eea51===_0x241c85;},'XzlVk':function(_0x4193b7,_0x3a3c22){return _0x4193b7>_0x3a3c22;},'cwssU':function(_0x4989fe,_0x23cf0a){return _0x4989fe*_0x23cf0a;},'fEIhD':_0x325e92(0x261),'wqYUe':_0x325e92(0x1f7),'dxnws':function(_0xf4542b,_0x1c78ea){return _0xf4542b===_0x1c78ea;},'SRtlN':function(_0x2fdc48,_0x5234da){return _0x2fdc48(_0x5234da);},'JNiFP':_0x325e92(0x27d),'HQZMm':_0x325e92(0x1e9),'WftUN':_0x325e92(0x28b),'ECjIm':function(_0x1b2257,_0x5488d2,_0x11655a){return _0x1b2257(_0x5488d2,_0x11655a);},'yPbYB':function(_0x540873,_0x292164){return _0x540873(_0x292164);},'Qhwdg':function(_0x1e824c,_0x2657cd){return _0x1e824c(_0x2657cd);},'SZLsr':_0x325e92(0x18c),'YejXv':_0x325e92(0x201),'brbqr':'Failed\x20to\x20create\x20preset','TnbFr':function(_0x5b1a7d,_0x52b906){return _0x5b1a7d(_0x52b906);},'xaDdO':_0x325e92(0x176),'ltozl':function(_0xca857c,_0x2c7b10){return _0xca857c(_0x2c7b10);},'afBUb':_0x325e92(0x259),'DSRuB':function(_0x351018,_0x593e32){return _0x351018(_0x593e32);},'DMnMN':_0x325e92(0x18d),'fNXOj':_0x325e92(0x29a),'zjEFt':_0x325e92(0x25e),'caAvG':_0x325e92(0x282),'AXPcY':_0x325e92(0x212),'CyBeR':_0x325e92(0x1c7),'CeUJw':_0x325e92(0x1a1),'ejYjp':function(_0x4a2f1a,_0x48daaa){return _0x4a2f1a(_0x48daaa);},'Evjub':_0x325e92(0x215),'NsIEV':_0x325e92(0x166),'ScmEn':'/system/document-processing-status','JRxAi':_0x325e92(0x1fc),'dtrKs':_0x325e92(0x20f),'xWqGP':_0x325e92(0x22a),'OhgZc':'/system/logo','SoeGI':'/system/support-email','VzpqM':function(_0x18988,_0x3d5f7b){return _0x18988(_0x3d5f7b);},'UlxWK':_0x325e92(0x1f1),'ZoDiA':'/system/api-keys','CdQeF':_0x325e92(0x1dc),'Vvqtk':_0x325e92(0x1eb),'hDuhe':function(_0x3dea66,_0x343e4a){return _0x3dea66(_0x343e4a);},'Xbwuv':_0x325e92(0x1c9),'rmmxG':_0x325e92(0x17d),'tqnVz':_0x325e92(0x2ab)};if(!_0x7047ce)return;_0x7047ce[_0x325e92(0x268)](_0x23ab36['DMnMN'],(_0x3c69cd,_0x1b2976)=>{const _0x54e84c=_0x325e92;_0x54e84c(0x25b)!==_0x54e84c(0x25b)?(_0x1518aa[_0x54e84c(0x17b)]('Error\x20processing\x20the\x20logo\x20upload:',_0x2fce58),_0x2d709e[_0x54e84c(0x169)](0x1f4)[_0x54e84c(0x213)]({'message':_0x23ab36[_0x54e84c(0x163)]})):_0x1b2976[_0x54e84c(0x169)](0xc8)[_0x54e84c(0x213)]({'online':!![]});}),_0x7047ce[_0x325e92(0x268)](_0x325e92(0x20a),async(_0x599526,_0x39ee1b)=>{const _0x5282c4=_0x325e92;_0x39ee1b[_0x5282c4(0x276)](0xc8);}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x1f4)],async(_0x511539,_0x2ad4b4)=>{const _0x1eba72=_0x325e92;if(_0x23ab36[_0x1eba72(0x1de)](process[_0x1eba72(0x2af)]['NODE_ENV'],_0x23ab36['PwUPP']))return _0x2ad4b4['sendStatus'](0xc8)[_0x1eba72(0x203)]();_0x23ab36[_0x1eba72(0x16c)](dumpENV),_0x2ad4b4[_0x1eba72(0x276)](0xc8)['end']();}),_0x7047ce['get']('/setup-complete',async(_0x5477b0,_0x4e0ea6)=>{const _0x58453c=_0x325e92;try{const _0xc91e1a=await SystemSettings[_0x58453c(0x2a2)]();_0x4e0ea6[_0x58453c(0x169)](0xc8)[_0x58453c(0x213)]({'results':_0xc91e1a});}catch(_0x537805){console['error'](_0x537805[_0x58453c(0x1d4)],_0x537805),_0x4e0ea6[_0x58453c(0x276)](0x1f4)[_0x58453c(0x203)]();}}),_0x7047ce['get'](_0x23ab36[_0x325e92(0x1da)],[validatedRequest],async(_0x41c340,_0x39d183)=>{const _0x1646df=_0x325e92;try{if(_0x23ab36['xvQzJ']!==_0x23ab36[_0x1646df(0x1f9)]){if(multiUserMode(_0x39d183)){const _0x120f24=await userFromSession(_0x41c340,_0x39d183);if(!_0x120f24||_0x120f24[_0x1646df(0x16b)]){if(_0x23ab36[_0x1646df(0x2b4)]!=='VIGJl')_0x1c3d3a[_0x1646df(0x1e3)]=_0x57689c(_0x1f23ba);else{_0x39d183['sendStatus'](0x193)['end']();return;}}_0x39d183[_0x1646df(0x276)](0xc8)[_0x1646df(0x203)]();return;}_0x39d183['sendStatus'](0xc8)[_0x1646df(0x203)]();}else _0x4f25e5[_0x1646df(0x17b)](_0x9b4e15[_0x1646df(0x1d4)],_0x3b4173),_0x17a3ab[_0x1646df(0x276)](0x1f4)['end']();}catch(_0x2129a7){console[_0x1646df(0x17b)](_0x2129a7[_0x1646df(0x1d4)],_0x2129a7),_0x39d183[_0x1646df(0x276)](0x1f4)[_0x1646df(0x203)]();}}),_0x7047ce['post'](_0x23ab36[_0x325e92(0x248)],async(_0x1973ab,_0x342b7d)=>{const _0x15081f=_0x325e92;if(_0x23ab36['dcyBJ']===_0x23ab36[_0x15081f(0x278)])try{const _0x38a9f1=_0x23ab36[_0x15081f(0x1ce)](require,_0x15081f(0x266));if(await SystemSettings['isMultiUserMode']()){const {username:_0x2c8de1,password:_0x282f43}=_0x23ab36[_0x15081f(0x1ce)](reqBody,_0x1973ab),_0x189366=await User['_get']({'username':String(_0x2c8de1)});if(!_0x189366){await EventLogs[_0x15081f(0x2ae)](_0x23ab36['ALypo'],{'ip':_0x1973ab['ip']||'Unknown\x20IP','username':_0x2c8de1||_0x15081f(0x265)},_0x189366?.['id']),_0x342b7d[_0x15081f(0x169)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x15081f(0x1af)});return;}if(!_0x38a9f1[_0x15081f(0x262)](String(_0x282f43),_0x189366[_0x15081f(0x1e3)])){await EventLogs['logEvent'](_0x15081f(0x26f),{'ip':_0x1973ab['ip']||_0x23ab36[_0x15081f(0x222)],'username':_0x23ab36[_0x15081f(0x1ab)](_0x2c8de1,_0x23ab36['rGxWA'])},_0x189366?.['id']),_0x342b7d[_0x15081f(0x169)](0xc8)[_0x15081f(0x213)]({'user':null,'valid':![],'token':null,'message':_0x15081f(0x1a4)});return;}if(_0x189366['suspended']){await EventLogs['logEvent'](_0x23ab36[_0x15081f(0x23a)],{'ip':_0x1973ab['ip']||'Unknown\x20IP','username':_0x23ab36[_0x15081f(0x2a0)](_0x2c8de1,_0x15081f(0x265))},_0x189366?.['id']),_0x342b7d[_0x15081f(0x169)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x15081f(0x214)});return;}await Telemetry['sendTelemetry']('login_event',{'multiUserMode':![]},_0x189366?.['id']),await EventLogs[_0x15081f(0x2ae)](_0x15081f(0x202),{'ip':_0x1973ab['ip']||_0x15081f(0x18a),'username':_0x189366['username']||_0x15081f(0x265)},_0x189366?.['id']);if(!_0x189366[_0x15081f(0x2b1)]){if(_0x23ab36[_0x15081f(0x2a7)]!==_0x23ab36[_0x15081f(0x2a7)]){_0x54c30f[_0x15081f(0x276)](0x193)[_0x15081f(0x203)]();return;}else{const _0x491668=await _0x23ab36[_0x15081f(0x1c6)](generateRecoveryCodes,_0x189366['id']);_0x342b7d[_0x15081f(0x169)](0xc8)[_0x15081f(0x213)]({'valid':!![],'user':User[_0x15081f(0x1b7)](_0x189366),'token':_0x23ab36[_0x15081f(0x175)](makeJWT,{'id':_0x189366['id'],'username':_0x189366['username']},_0x15081f(0x204)),'message':null,'recoveryCodes':_0x491668});return;}}_0x342b7d['status'](0xc8)[_0x15081f(0x213)]({'valid':!![],'user':User[_0x15081f(0x1b7)](_0x189366),'token':makeJWT({'id':_0x189366['id'],'username':_0x189366[_0x15081f(0x241)]},_0x23ab36['OMhQB']),'message':null});return;}else{if(_0x23ab36['lZSlW'](_0x15081f(0x234),_0x23ab36['STVng']))_0x35693f[_0x15081f(0x17b)](_0x4ba563['message'],_0x231bdd),_0x3c2e92[_0x15081f(0x276)](0x1f4)['end']();else{const {password:_0x3499d2}=reqBody(_0x1973ab);if(!_0x38a9f1[_0x15081f(0x262)](_0x3499d2,_0x38a9f1[_0x15081f(0x2a9)](process['env'][_0x15081f(0x22b)],0xa))){await EventLogs[_0x15081f(0x2ae)]('failed_login_invalid_password',{'ip':_0x1973ab['ip']||_0x23ab36[_0x15081f(0x222)],'multiUserMode':![]}),_0x342b7d['status'](0x191)['json']({'valid':![],'token':null,'message':_0x15081f(0x270)});return;}await Telemetry[_0x15081f(0x27a)](_0x23ab36[_0x15081f(0x244)],{'multiUserMode':![]}),await EventLogs[_0x15081f(0x2ae)](_0x23ab36[_0x15081f(0x244)],{'ip':_0x1973ab['ip']||_0x23ab36['KoFpJ'],'multiUserMode':![]}),_0x342b7d[_0x15081f(0x169)](0xc8)[_0x15081f(0x213)]({'valid':!![],'token':makeJWT({'p':new EncryptionManager()[_0x15081f(0x1b5)](_0x3499d2)},_0x23ab36[_0x15081f(0x24e)]),'message':null});}}}catch(_0x48c0c0){_0x23ab36[_0x15081f(0x1ad)]!==_0x15081f(0x29e)?(_0x52df65[_0x15081f(0x17b)]('Error\x20recovering\x20account:',_0x4e70cd),_0xac6788[_0x15081f(0x169)](0x1f4)[_0x15081f(0x213)]({'success':![],'message':'Internal\x20server\x20error'})):(console[_0x15081f(0x17b)](_0x48c0c0[_0x15081f(0x1d4)],_0x48c0c0),_0x342b7d['sendStatus'](0x1f4)[_0x15081f(0x203)]());}else _0x4d25ed[_0x15081f(0x169)](0x190)[_0x15081f(0x213)]({'success':_0x2e14ce,'error':_0x11fd4f});}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x195)],[simpleSSOEnabled],async(_0x556e32,_0x567b97)=>{const _0x3ea0d5=_0x325e92,{token:_0x3fcd0c}=_0x556e32[_0x3ea0d5(0x26a)],{sessionToken:_0x513ad0,token:_0x9e2815,error:_0x3ca12c}=await TemporaryAuthToken['validate'](_0x3fcd0c);if(_0x3ca12c)return await EventLogs['logEvent'](_0x23ab36[_0x3ea0d5(0x1df)],{'ip':_0x556e32['ip']||_0x23ab36['KoFpJ'],'multiUserMode':!![]}),_0x567b97[_0x3ea0d5(0x169)](0x191)[_0x3ea0d5(0x213)]({'valid':![],'token':null,'message':_0x3ea0d5(0x255)+_0x3ca12c});await Telemetry['sendTelemetry'](_0x23ab36['zvFDZ'],{'multiUserMode':!![]},_0x9e2815[_0x3ea0d5(0x193)]['id']),await EventLogs[_0x3ea0d5(0x2ae)](_0x23ab36[_0x3ea0d5(0x244)],{'ip':_0x556e32['ip']||_0x3ea0d5(0x18a),'username':_0x9e2815[_0x3ea0d5(0x193)][_0x3ea0d5(0x241)]||_0x23ab36[_0x3ea0d5(0x1c5)]},_0x9e2815[_0x3ea0d5(0x193)]['id']),_0x567b97[_0x3ea0d5(0x169)](0xc8)[_0x3ea0d5(0x213)]({'valid':!![],'user':User[_0x3ea0d5(0x1b7)](_0x9e2815['user']),'token':_0x513ad0,'message':null});}),_0x7047ce[_0x325e92(0x165)](_0x23ab36[_0x325e92(0x19a)],[isMultiUserSetup],async(_0x1929eb,_0x43e3de)=>{const _0x446a81=_0x325e92;try{const {username:_0x4a2035,recoveryCodes:_0x57d6da}=_0x23ab36[_0x446a81(0x19b)](reqBody,_0x1929eb),{success:_0x11749c,resetToken:_0xa212cd,error:_0x1e0e10}=await recoverAccount(_0x4a2035,_0x57d6da);_0x11749c?_0x43e3de[_0x446a81(0x169)](0xc8)['json']({'success':_0x11749c,'resetToken':_0xa212cd}):_0x43e3de[_0x446a81(0x169)](0x190)[_0x446a81(0x213)]({'success':_0x11749c,'message':_0x1e0e10});}catch(_0x316c96){console[_0x446a81(0x17b)]('Error\x20recovering\x20account:',_0x316c96),_0x43e3de[_0x446a81(0x169)](0x1f4)[_0x446a81(0x213)]({'success':![],'message':_0x23ab36['QgooK']});}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x181),[isMultiUserSetup],async(_0x5283b1,_0x305e31)=>{const _0x1fff4d=_0x325e92;try{const {token:_0x265e96,newPassword:_0x3d18a5,confirmPassword:_0x1a210f}=_0x23ab36[_0x1fff4d(0x1c4)](reqBody,_0x5283b1),{success:_0x31837a,message:_0x4b66df,error:_0x31408c}=await _0x23ab36['rzDZd'](resetPassword,_0x265e96,_0x3d18a5,_0x1a210f);_0x31837a?_0x305e31[_0x1fff4d(0x169)](0xc8)[_0x1fff4d(0x213)]({'success':_0x31837a,'message':_0x4b66df}):_0x305e31[_0x1fff4d(0x169)](0x190)[_0x1fff4d(0x213)]({'success':_0x31837a,'error':_0x31408c});}catch(_0x3bf4e4){console[_0x1fff4d(0x17b)](_0x23ab36[_0x1fff4d(0x1d6)],_0x3bf4e4),_0x305e31['status'](0x1f4)['json']({'success':![],'message':_0x3bf4e4['message']});}}),_0x7047ce['get']('/system/system-vectors',[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0xc2d64f,_0x5a3b3b)=>{const _0x503801=_0x325e92,_0x147f7d={'OArfL':_0x503801(0x22f)};try{if(_0x23ab36[_0x503801(0x1de)](_0x503801(0x271),_0x23ab36[_0x503801(0x199)]))return _0x444ac3['status'](0x190)[_0x503801(0x213)]({'message':_0x147f7d['OArfL']});else{const _0x5631aa=queryParams(_0xc2d64f),_0x21939d=getVectorDbClass(),_0x585ab9=!!_0x5631aa[_0x503801(0x167)]?await _0x21939d[_0x503801(0x22c)](_0x5631aa[_0x503801(0x167)]):await _0x21939d[_0x503801(0x1d0)]();_0x5a3b3b[_0x503801(0x169)](0xc8)[_0x503801(0x213)]({'vectorCount':_0x585ab9});}}catch(_0x4ba866){console[_0x503801(0x17b)](_0x4ba866[_0x503801(0x1d4)],_0x4ba866),_0x5a3b3b[_0x503801(0x276)](0x1f4)[_0x503801(0x203)]();}}),_0x7047ce['delete'](_0x23ab36[_0x325e92(0x287)],[validatedRequest,_0x23ab36[_0x325e92(0x295)](flexUserRoleValid,[ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0x2b5c60,_0x5e5447)=>{const _0x15a9c6=_0x325e92;if(_0x23ab36[_0x15a9c6(0x17c)](_0x15a9c6(0x26c),_0x15a9c6(0x275)))_0x4cc9e2['status'](0x190)[_0x15a9c6(0x213)]({'success':_0x1bf1bb,'message':_0x51f953});else try{const {name:_0x1fec25}=_0x23ab36[_0x15a9c6(0x19b)](reqBody,_0x2b5c60);await _0x23ab36['bSDYp'](purgeDocument,_0x1fec25),_0x5e5447[_0x15a9c6(0x276)](0xc8)['end']();}catch(_0x3f24eb){console[_0x15a9c6(0x17b)](_0x3f24eb[_0x15a9c6(0x1d4)],_0x3f24eb),_0x5e5447['sendStatus'](0x1f4)['end']();}}),_0x7047ce[_0x325e92(0x231)](_0x23ab36[_0x325e92(0x1ef)],[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0x34f0d9,_0x2f0c49)=>{const _0x39f754=_0x325e92;if(_0x23ab36[_0x39f754(0x1bc)](_0x39f754(0x1c1),_0x23ab36[_0x39f754(0x1d9)]))try{const {names:_0x4b18de}=_0x23ab36[_0x39f754(0x1c6)](reqBody,_0x34f0d9);for await(const _0x35de52 of _0x4b18de)await purgeDocument(_0x35de52);_0x2f0c49[_0x39f754(0x276)](0xc8)[_0x39f754(0x203)]();}catch(_0x4ffd0a){console[_0x39f754(0x17b)](_0x4ffd0a[_0x39f754(0x1d4)],_0x4ffd0a),_0x2f0c49[_0x39f754(0x276)](0x1f4)[_0x39f754(0x203)]();}else return _0x121dfd[_0x39f754(0x169)](0x190)[_0x39f754(0x213)]({'success':![],'message':'Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.'});}),_0x7047ce[_0x325e92(0x231)](_0x23ab36[_0x325e92(0x264)],[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0xd5234e,_0x410d22)=>{const _0x5ae4c2=_0x325e92;try{const {name:_0x363d64}=reqBody(_0xd5234e);await purgeFolder(_0x363d64),_0x410d22[_0x5ae4c2(0x276)](0xc8)['end']();}catch(_0x44ad9a){console[_0x5ae4c2(0x17b)](_0x44ad9a[_0x5ae4c2(0x1d4)],_0x44ad9a),_0x410d22['sendStatus'](0x1f4)[_0x5ae4c2(0x203)]();}}),_0x7047ce['get']('/system/local-files',[validatedRequest,_0x23ab36[_0x325e92(0x225)](flexUserRoleValid,[ROLES['admin'],ROLES[_0x325e92(0x1a0)]])],async(_0x52ead2,_0x44db49)=>{const _0x5217c4=_0x325e92;try{if(_0x23ab36[_0x5217c4(0x23b)](_0x23ab36['vdsJR'],_0x5217c4(0x227))){const _0x97fd09=await viewLocalFiles();_0x44db49[_0x5217c4(0x169)](0xc8)[_0x5217c4(0x213)]({'localFiles':_0x97fd09});}else _0x1c974f[_0x5217c4(0x17b)](_0xe6e82c[_0x5217c4(0x1d4)],_0x32b757),_0x102cd8['sendStatus'](0x1f4)[_0x5217c4(0x203)]();}catch(_0xe70872){console[_0x5217c4(0x17b)](_0xe70872[_0x5217c4(0x1d4)],_0xe70872),_0x44db49[_0x5217c4(0x276)](0x1f4)[_0x5217c4(0x203)]();}}),_0x7047ce['get'](_0x23ab36[_0x325e92(0x188)],[validatedRequest],async(_0x464a63,_0x382ee9)=>{const _0xa74284=_0x325e92;if(_0x23ab36[_0xa74284(0x17c)]('IDRIC',_0x23ab36['jNqJC']))_0x10efa5[_0xa74284(0x17b)](_0x5465aa[_0xa74284(0x1d4)],_0x452fb3),_0x41fb64['sendStatus'](0x1f4)[_0xa74284(0x203)]();else try{const _0xa37080=await new CollectorApi()[_0xa74284(0x1d3)]();_0x382ee9['sendStatus'](_0xa37080?0xc8:0x1f7);}catch(_0x13dca1){console[_0xa74284(0x17b)](_0x13dca1['message'],_0x13dca1),_0x382ee9[_0xa74284(0x276)](0x1f4)[_0xa74284(0x203)]();}}),_0x7047ce[_0x325e92(0x268)](_0x23ab36['JRxAi'],[validatedRequest],async(_0x10ff25,_0x7e08e3)=>{const _0x256b9a=_0x325e92;try{const _0xb9cdfc=await new CollectorApi()['acceptedFileTypes']();if(!_0xb9cdfc){_0x7e08e3[_0x256b9a(0x276)](0x194)['end']();return;}_0x7e08e3[_0x256b9a(0x169)](0xc8)['json']({'types':_0xb9cdfc});}catch(_0x2d2fde){console[_0x256b9a(0x17b)](_0x2d2fde[_0x256b9a(0x1d4)],_0x2d2fde),_0x7e08e3[_0x256b9a(0x276)](0x1f4)[_0x256b9a(0x203)]();}}),_0x7047ce['post'](_0x23ab36[_0x325e92(0x220)],[validatedRequest,flexUserRoleValid([ROLES['admin']])],async(_0xb26935,_0x264b4f)=>{const _0x455348=_0x325e92;try{const _0x5680fe=reqBody(_0xb26935),{newValues:_0x2295db,error:_0x44dcdb}=await updateENV(_0x5680fe,![],_0x264b4f?.[_0x455348(0x1bb)]?.['user']?.['id']);_0x264b4f[_0x455348(0x169)](0xc8)[_0x455348(0x213)]({'newValues':_0x2295db,'error':_0x44dcdb});}catch(_0x565f6e){console['error'](_0x565f6e[_0x455348(0x1d4)],_0x565f6e),_0x264b4f['sendStatus'](0x1f4)[_0x455348(0x203)]();}}),_0x7047ce[_0x325e92(0x165)](_0x23ab36[_0x325e92(0x21c)],[validatedRequest],async(_0x49e028,_0x1e0caf)=>{const _0xb5824a=_0x325e92;try{if(_0x23ab36['Bzsxs']===_0xb5824a(0x1ae)){_0x16481a[_0xb5824a(0x276)](0x194)[_0xb5824a(0x203)]();return;}else{if(_0x23ab36[_0xb5824a(0x161)](multiUserMode,_0x1e0caf)){_0x1e0caf[_0xb5824a(0x276)](0x191)['end']();return;}let _0x1cf1e2=null;const {usePassword:_0x16a73d,newPassword:_0x1a9938}=_0x23ab36[_0xb5824a(0x205)](reqBody,_0x49e028);!_0x16a73d?(process[_0xb5824a(0x2af)][_0xb5824a(0x22b)]='',process['env'][_0xb5824a(0x24b)]=''):_0x1cf1e2=await updateENV({'AuthToken':_0x1a9938,'JWTSecret':_0x23ab36[_0xb5824a(0x292)](v4)},!![])?.[_0xb5824a(0x17b)],_0x1e0caf[_0xb5824a(0x169)](0xc8)[_0xb5824a(0x213)]({'success':!_0x1cf1e2,'error':_0x1cf1e2});}}catch(_0x374521){console[_0xb5824a(0x17b)](_0x374521['message'],_0x374521),_0x1e0caf[_0xb5824a(0x276)](0x1f4)[_0xb5824a(0x203)]();}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x263),[validatedRequest],async(_0x164a84,_0x141a05)=>{const _0x149306=_0x325e92,_0xb9ef36={'DAdXI':_0x23ab36['KWcfa']};try{if(_0x23ab36[_0x149306(0x1bc)](_0x23ab36[_0x149306(0x20e)],_0x149306(0x1cc))){if(_0x141a05['locals']['multiUserMode']){_0x141a05[_0x149306(0x169)](0xc8)[_0x149306(0x213)]({'success':![],'error':_0x23ab36[_0x149306(0x21b)]});return;}const {username:_0x10f570,password:_0x2e1cab}=reqBody(_0x164a84),{user:_0x367430,error:_0x17f25a}=await User[_0x149306(0x29c)]({'username':_0x10f570,'password':_0x2e1cab,'role':ROLES[_0x149306(0x24d)]});if(_0x17f25a||!_0x367430){if(_0x149306(0x17e)===_0x23ab36[_0x149306(0x243)]){_0x141a05[_0x149306(0x169)](0x190)[_0x149306(0x213)]({'success':![],'error':_0x17f25a||'Failed\x20to\x20enable\x20multi-user\x20mode.'});return;}else _0x5456c6[_0x149306(0x241)]=_0x11a45c[_0x149306(0x294)][_0x149306(0x241)](_0x23ab36[_0x149306(0x205)](_0x5c06a1,_0x19b331));}await SystemSettings[_0x149306(0x299)]({'multi_user_mode':!![]}),await BrowserExtensionApiKey[_0x149306(0x1e7)](_0x367430['id']),await _0x23ab36[_0x149306(0x175)](updateENV,{'JWTSecret':process[_0x149306(0x2af)][_0x149306(0x24b)]||_0x23ab36[_0x149306(0x16c)](v4)},!![]),await Telemetry[_0x149306(0x27a)](_0x23ab36['HavCU'],{'multiUserMode':!![]}),await EventLogs[_0x149306(0x2ae)](_0x149306(0x17f),{},_0x367430?.['id']),_0x141a05[_0x149306(0x169)](0xc8)[_0x149306(0x213)]({'success':!!_0x367430,'error':_0x17f25a});}else _0x1a7967[_0x149306(0x17b)](_0xb9ef36[_0x149306(0x23c)],_0x2c6739),_0x1c7bf3['status'](0x1f4)[_0x149306(0x213)]({'message':_0x149306(0x162)});}catch(_0x5053d6){await User[_0x149306(0x231)]({}),await SystemSettings[_0x149306(0x299)]({'multi_user_mode':![]}),console[_0x149306(0x17b)](_0x5053d6[_0x149306(0x1d4)],_0x5053d6),_0x141a05[_0x149306(0x276)](0x1f4)[_0x149306(0x203)]();}}),_0x7047ce['get'](_0x325e92(0x1fa),async(_0x2c952d,_0x504875)=>{const _0x543a23=_0x325e92,_0x2de106={'JPrco':_0x543a23(0x18e)};try{if(_0x23ab36[_0x543a23(0x237)]===_0x543a23(0x1ff)){const _0x1c4428=await SystemSettings[_0x543a23(0x18f)]();_0x504875[_0x543a23(0x169)](0xc8)[_0x543a23(0x213)]({'multiUserMode':_0x1c4428});}else _0x228e18[_0x543a23(0x17b)](_0x5365b0),_0x3a63b1[_0x543a23(0x276)](0x1f4)['end']();}catch(_0x599c89){_0x23ab36[_0x543a23(0x23b)](_0x543a23(0x1ee),_0x23ab36['mDYqW'])?(console[_0x543a23(0x17b)](_0x599c89[_0x543a23(0x1d4)],_0x599c89),_0x504875[_0x543a23(0x276)](0x1f4)[_0x543a23(0x203)]()):(_0x22039e[_0x543a23(0x17b)](_0x15a109),_0x239240[_0x543a23(0x169)](0x1f4)[_0x543a23(0x213)]({'apiKey':null,'error':_0x2de106[_0x543a23(0x240)]}));}}),_0x7047ce['get'](_0x23ab36[_0x325e92(0x1b3)],async function(_0x4da9be,_0x35b013){const _0x98e4b9=_0x325e92;try{const _0x1b470e=!_0x4da9be?.[_0x98e4b9(0x26a)]?.['theme']||_0x23ab36['PhsVW'](_0x4da9be?.[_0x98e4b9(0x26a)]?.[_0x98e4b9(0x20d)],_0x98e4b9(0x207)),_0x1de88f=_0x23ab36['ZxjJu'](getDefaultFilename,_0x1b470e),_0x40e2f8=await determineLogoFilepath(_0x1de88f),{found:_0x10d2f0,buffer:_0x31e394,size:_0x39bbc9,mime:_0x2004a4}=fetchLogo(_0x40e2f8);if(!_0x10d2f0){_0x35b013[_0x98e4b9(0x276)](0xcc)[_0x98e4b9(0x203)]();return;}const _0x49505f=await SystemSettings[_0x98e4b9(0x1a7)]();_0x35b013['writeHead'](0xc8,{'Access-Control-Expose-Headers':_0x98e4b9(0x29f),'Content-Type':_0x2004a4||_0x23ab36[_0x98e4b9(0x27f)],'Content-Disposition':_0x98e4b9(0x249)+path[_0x98e4b9(0x1fb)](_0x40e2f8),'Content-Length':_0x39bbc9,'X-Is-Custom-Logo':_0x23ab36[_0x98e4b9(0x226)](_0x49505f,null)&&_0x49505f!==_0x1de88f&&!_0x23ab36[_0x98e4b9(0x1c6)](isDefaultFilename,_0x49505f)}),_0x35b013[_0x98e4b9(0x203)](Buffer[_0x98e4b9(0x258)](_0x31e394,_0x98e4b9(0x183)));return;}catch(_0x3aeaa9){console[_0x98e4b9(0x17b)](_0x98e4b9(0x1c0),_0x3aeaa9),_0x35b013['status'](0x1f4)[_0x98e4b9(0x213)]({'message':_0x23ab36[_0x98e4b9(0x198)]});}}),_0x7047ce[_0x325e92(0x268)](_0x325e92(0x189),[validatedRequest],async(_0x5ad62a,_0x58855c)=>{const _0x5abde1=_0x325e92;if(_0x23ab36[_0x5abde1(0x1fe)]!==_0x23ab36[_0x5abde1(0x1fe)])_0x3ecb57[_0x5abde1(0x17b)](_0x406348[_0x5abde1(0x1d4)],_0x227aed),_0x1459e2[_0x5abde1(0x276)](0x1f4)['end']();else try{const _0x1cbdb8=(await SystemSettings[_0x5abde1(0x268)]({'label':'footer_data'}))?.[_0x5abde1(0x1ba)]??JSON[_0x5abde1(0x289)]([]);_0x58855c[_0x5abde1(0x169)](0xc8)[_0x5abde1(0x213)]({'footerData':_0x1cbdb8});}catch(_0x39f9b6){_0x23ab36[_0x5abde1(0x226)](_0x23ab36['EkLnI'],'KXfqD')?(_0x4d468c[_0x5abde1(0x17b)](_0x5abde1(0x23d),_0x3ce9b9),_0x28630f[_0x5abde1(0x169)](0x1f4)['json']({'success':!![],'message':'Error\x20saving\x20the\x20welcome\x20messages.'})):(console[_0x5abde1(0x17b)](_0x23ab36[_0x5abde1(0x1f5)],_0x39f9b6),_0x58855c['status'](0x1f4)[_0x5abde1(0x213)]({'message':'Internal\x20server\x20error'}));}}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x1d1)],[validatedRequest],async(_0x5c4d62,_0x1705e6)=>{const _0x2fdc4c=_0x325e92;if(_0x23ab36[_0x2fdc4c(0x1de)]('vIdKW',_0x23ab36[_0x2fdc4c(0x1aa)]))try{const _0x20b8fc=(await SystemSettings[_0x2fdc4c(0x268)]({'label':_0x23ab36['VREwY']}))?.['value']??null;_0x1705e6[_0x2fdc4c(0x169)](0xc8)['json']({'supportEmail':_0x20b8fc});}catch(_0xf418f){if(_0x23ab36[_0x2fdc4c(0x21e)](_0x2fdc4c(0x1b8),_0x2fdc4c(0x1b8)))console[_0x2fdc4c(0x17b)]('Error\x20fetching\x20support\x20email:',_0xf418f),_0x1705e6[_0x2fdc4c(0x169)](0x1f4)[_0x2fdc4c(0x213)]({'message':'Internal\x20server\x20error'});else return _0x2637aa[_0x2fdc4c(0x276)](0x191)[_0x2fdc4c(0x203)]();}else _0x498a37['error'](_0x218ea2[_0x2fdc4c(0x1d4)],_0x385f40),_0xa3280c[_0x2fdc4c(0x276)](0x1f4)[_0x2fdc4c(0x203)]();}),_0x7047ce['get'](_0x325e92(0x273),async(_0x3a0deb,_0x2c2790)=>{const _0x43611a=_0x325e92;try{if(_0x43611a(0x20c)!==_0x23ab36[_0x43611a(0x172)]){const _0x446a62=(await SystemSettings[_0x43611a(0x268)]({'label':_0x23ab36[_0x43611a(0x254)]}))?.['value']??null;_0x2c2790['status'](0xc8)['json']({'customAppName':_0x446a62});}else _0x41b7eb[_0x43611a(0x17b)](_0x3a7399[_0x43611a(0x1d4)],_0x53d662),_0x282ff0[_0x43611a(0x276)](0x1f4)[_0x43611a(0x203)]();}catch(_0x2e3c52){console[_0x43611a(0x17b)](_0x43611a(0x16a),_0x2e3c52),_0x2c2790['status'](0x1f4)[_0x43611a(0x213)]({'message':_0x43611a(0x162)});}}),_0x7047ce['get'](_0x325e92(0x16d),[validatedRequest,_0x23ab36[_0x325e92(0x25f)](flexUserRoleValid,[ROLES['all']])],async function(_0xbf3fd6,_0x33af17){const _0x5c527f=_0x325e92;try{if(_0x5c527f(0x194)===_0x5c527f(0x194)){const {id:_0x5c8890}=_0xbf3fd6['params'];if(_0x23ab36[_0x5c527f(0x226)](_0x33af17[_0x5c527f(0x1bb)]?.[_0x5c527f(0x193)]?.['id'],_0x23ab36[_0x5c527f(0x161)](Number,_0x5c8890)))return _0x33af17[_0x5c527f(0x276)](0xcc)[_0x5c527f(0x203)]();const _0x121f49=await _0x23ab36[_0x5c527f(0x29d)](determinePfpFilepath,_0x5c8890);if(!_0x121f49)return _0x33af17['sendStatus'](0xcc)[_0x5c527f(0x203)]();const {found:_0x4685bf,buffer:_0x5a91f4,size:_0x482802,mime:_0x5d1539}=fetchPfp(_0x121f49);if(!_0x4685bf)return _0x33af17['sendStatus'](0xcc)[_0x5c527f(0x203)]();_0x33af17[_0x5c527f(0x25c)](0xc8,{'Content-Type':_0x5d1539||_0x5c527f(0x285),'Content-Disposition':_0x5c527f(0x249)+path[_0x5c527f(0x1fb)](_0x121f49),'Content-Length':_0x482802}),_0x33af17[_0x5c527f(0x203)](Buffer[_0x5c527f(0x258)](_0x5a91f4,_0x23ab36[_0x5c527f(0x1c2)]));return;}else _0x506bc3[_0x5c527f(0x17b)](_0x23ab36[_0x5c527f(0x279)],_0x31807a),_0x26ebb4[_0x5c527f(0x169)](0x1f4)[_0x5c527f(0x213)]({'message':'Internal\x20server\x20error'});}catch(_0x4e09b4){console[_0x5c527f(0x17b)](_0x5c527f(0x1c0),_0x4e09b4),_0x33af17[_0x5c527f(0x169)](0x1f4)[_0x5c527f(0x213)]({'message':_0x23ab36['QgooK']});}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x1dd),[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x1a8)]]),handlePfpUpload],async function(_0x503a9a,_0x534f09){const _0x4f9ec7=_0x325e92;if(_0x23ab36[_0x4f9ec7(0x226)]('hSyDA',_0x4f9ec7(0x2ad)))try{if(_0x4f9ec7(0x2a3)===_0x23ab36['JFEuq']){const _0xa0da5e=await _0x23ab36[_0x4f9ec7(0x175)](userFromSession,_0x503a9a,_0x534f09),_0x352036=_0x503a9a[_0x4f9ec7(0x1f0)];if(!_0x352036)return _0x534f09[_0x4f9ec7(0x169)](0x190)['json']({'message':_0x23ab36[_0x4f9ec7(0x22e)]});const _0x4cc5a3=await User['get']({'id':_0xa0da5e['id']}),_0x202b23=_0x4cc5a3[_0x4f9ec7(0x1cf)];if(_0x202b23){if(_0x23ab36['rMZiH'](_0x4f9ec7(0x173),_0x4f9ec7(0x173)))_0x1c5516['error'](_0x23ab36[_0x4f9ec7(0x224)],_0x5a3854),_0x2a4d4e[_0x4f9ec7(0x169)](0x1f4)[_0x4f9ec7(0x213)]({'message':_0x4f9ec7(0x162)});else{const _0x1f1eeb=path['join'](__dirname,_0x23ab36['HjCSV']),_0x16ef7c=path[_0x4f9ec7(0x177)](_0x1f1eeb,_0x23ab36[_0x4f9ec7(0x2a5)](normalizePath,_0x4cc5a3[_0x4f9ec7(0x1cf)]));if(!_0x23ab36[_0x4f9ec7(0x175)](isWithin,path[_0x4f9ec7(0x1e6)](_0x1f1eeb),path['resolve'](_0x16ef7c)))throw new Error(_0x23ab36[_0x4f9ec7(0x221)]);if(fs['existsSync'](_0x16ef7c))fs[_0x4f9ec7(0x25d)](_0x16ef7c);}}const {success:_0x679a70,error:_0x5e609f}=await User[_0x4f9ec7(0x281)](_0xa0da5e['id'],{'pfpFilename':_0x352036});return _0x534f09[_0x4f9ec7(0x169)](_0x679a70?0xc8:0x1f4)[_0x4f9ec7(0x213)]({'message':_0x679a70?_0x23ab36[_0x4f9ec7(0x25a)]:_0x23ab36[_0x4f9ec7(0x2a1)](_0x5e609f,_0x4f9ec7(0x1db))});}else{_0x5f398e[_0x4f9ec7(0x169)](0x190)['json']({'success':![],'error':_0x23ab36['gGEel']});return;}}catch(_0xc46cf){if(_0x23ab36[_0x4f9ec7(0x260)](_0x4f9ec7(0x2ac),_0x4f9ec7(0x2ac))){_0x5aa37b[_0x4f9ec7(0x169)](0xc8)[_0x4f9ec7(0x213)]({'success':![],'error':_0x4f9ec7(0x1f6)});return;}else console[_0x4f9ec7(0x17b)](_0x4f9ec7(0x2a8),_0xc46cf),_0x534f09['status'](0x1f4)[_0x4f9ec7(0x213)]({'message':_0x23ab36[_0x4f9ec7(0x198)]});}else _0x15f4e2['error'](_0x4f9ec7(0x16a),_0x71b7fc),_0x872604[_0x4f9ec7(0x169)](0x1f4)[_0x4f9ec7(0x213)]({'message':_0x23ab36[_0x4f9ec7(0x198)]});}),_0x7047ce['delete'](_0x325e92(0x182),[validatedRequest,_0x23ab36['QmEaD'](flexUserRoleValid,[ROLES[_0x325e92(0x1a8)]])],async function(_0x1dd8ea,_0x549383){const _0x2df26f=_0x325e92;try{const _0x264a3a=await userFromSession(_0x1dd8ea,_0x549383),_0x1a89a4=await User[_0x2df26f(0x268)]({'id':_0x264a3a['id']}),_0x3128d5=_0x1a89a4['pfpFilename'];if(_0x3128d5){const _0x12525e=path['join'](__dirname,_0x2df26f(0x1d7)),_0x231759=path[_0x2df26f(0x177)](_0x12525e,_0x23ab36[_0x2df26f(0x25f)](normalizePath,_0x3128d5));if(!isWithin(path[_0x2df26f(0x1e6)](_0x12525e),path[_0x2df26f(0x1e6)](_0x231759)))throw new Error(_0x2df26f(0x24a));if(fs[_0x2df26f(0x2a6)](_0x231759))fs[_0x2df26f(0x25d)](_0x231759);}const {success:_0x42708c,error:_0x4654d5}=await User[_0x2df26f(0x281)](_0x264a3a['id'],{'pfpFilename':null});return _0x549383['status'](_0x42708c?0xc8:0x1f4)[_0x2df26f(0x213)]({'message':_0x42708c?_0x23ab36[_0x2df26f(0x27c)]:_0x23ab36['gQtuN'](_0x4654d5,_0x2df26f(0x2a4))});}catch(_0xf38f1f){console[_0x2df26f(0x17b)](_0x2df26f(0x21d),_0xf38f1f),_0x549383['status'](0x1f4)['json']({'message':_0x23ab36[_0x2df26f(0x198)]});}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x251),[validatedRequest,_0x23ab36[_0x325e92(0x1c3)](flexUserRoleValid,[ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]]),handleAssetUpload],async(_0x423c59,_0x2b610c)=>{const _0x35d263=_0x325e92;if(!_0x423c59?.['file']||!_0x423c59?.['file'][_0x35d263(0x216)]){if(_0x23ab36[_0x35d263(0x168)](_0x23ab36['kITvO'],_0x23ab36[_0x35d263(0x23f)]))return _0x2b610c['status'](0x190)[_0x35d263(0x213)]({'message':'No\x20logo\x20file\x20provided.'});else _0x1c16cf['error'](_0x35d263(0x1c0),_0x225a60),_0x33e277[_0x35d263(0x169)](0x1f4)[_0x35d263(0x213)]({'message':_0x23ab36[_0x35d263(0x198)]});}if(!validFilename(_0x423c59[_0x35d263(0x233)]['originalname']))return _0x2b610c['status'](0x190)[_0x35d263(0x213)]({'message':'Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.'});try{const _0x12210c=await renameLogoFile(_0x423c59[_0x35d263(0x233)][_0x35d263(0x216)]),_0x118f3f=await SystemSettings[_0x35d263(0x1a7)]();await _0x23ab36['bSDYp'](removeCustomLogo,_0x118f3f);const {success:_0x5006f7,error:_0xf03775}=await SystemSettings[_0x35d263(0x299)]({'logo_filename':_0x12210c});return _0x2b610c[_0x35d263(0x169)](_0x5006f7?0xc8:0x1f4)[_0x35d263(0x213)]({'message':_0x5006f7?_0x23ab36[_0x35d263(0x1ed)]:_0xf03775||_0x23ab36[_0x35d263(0x17a)]});}catch(_0x58b4b5){if(_0x35d263(0x192)!==_0x23ab36[_0x35d263(0x179)])console[_0x35d263(0x17b)]('Error\x20processing\x20the\x20logo\x20upload:',_0x58b4b5),_0x2b610c[_0x35d263(0x169)](0x1f4)[_0x35d263(0x213)]({'message':_0x23ab36[_0x35d263(0x163)]});else{const _0x58bffe=_0x305cf4['join'](_0x4f52b0,_0x23ab36[_0x35d263(0x1a3)]),_0x525896=_0x17ff82['join'](_0x58bffe,_0x3f5101(_0x161a30[_0x35d263(0x1cf)]));if(!_0x23ab36[_0x35d263(0x175)](_0x5448ae,_0x5cbead['resolve'](_0x58bffe),_0x22b787[_0x35d263(0x1e6)](_0x525896)))throw new _0x59e59b(_0x23ab36['UGJME']);if(_0x3841f3[_0x35d263(0x2a6)](_0x525896))_0x551789[_0x35d263(0x25d)](_0x525896);}}}),_0x7047ce[_0x325e92(0x268)](_0x325e92(0x296),async(_0x2c8460,_0x40253c)=>{const _0x301402=_0x325e92;try{const _0x3608e6=await SystemSettings['currentLogoFilename'](),_0x1c946f=_0x3608e6===LOGO_FILENAME;_0x40253c[_0x301402(0x169)](0xc8)[_0x301402(0x213)]({'isDefaultLogo':_0x1c946f});}catch(_0x539b6c){console[_0x301402(0x17b)](_0x23ab36[_0x301402(0x224)],_0x539b6c),_0x40253c['status'](0x1f4)[_0x301402(0x213)]({'message':_0x23ab36['QgooK']});}}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x1fd)],[validatedRequest,_0x23ab36[_0x325e92(0x205)](flexUserRoleValid,[ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0x3c3ac8,_0x22ca3b)=>{const _0x482866=_0x325e92,_0x388392={'rvMpO':_0x482866(0x2a8),'exEQJ':_0x482866(0x162)};if(_0x23ab36[_0x482866(0x26b)]('eFEyP',_0x482866(0x23e)))_0x2704e5['error'](_0x388392[_0x482866(0x1b4)],_0x5ded41),_0x228387['status'](0x1f4)[_0x482866(0x213)]({'message':_0x388392[_0x482866(0x26e)]});else try{const _0x2492e5=await SystemSettings[_0x482866(0x1a7)]();await _0x23ab36[_0x482866(0x19b)](removeCustomLogo,_0x2492e5);const {success:_0x2a1898,error:_0x3a59d0}=await SystemSettings['_updateSettings']({'logo_filename':LOGO_FILENAME});return _0x22ca3b[_0x482866(0x169)](_0x2a1898?0xc8:0x1f4)[_0x482866(0x213)]({'message':_0x2a1898?_0x23ab36['dNQYM']:_0x3a59d0||'Failed\x20to\x20update\x20with\x20new\x20logo.'});}catch(_0x369432){_0x23ab36[_0x482866(0x1b1)](_0x23ab36[_0x482866(0x22d)],_0x23ab36['sSamN'])?(_0x27229a[_0x482866(0x17b)](_0x4905bd),_0x25e1bf[_0x482866(0x169)](0x1f4)['json']({'apiKey':null,'error':_0x482866(0x191)})):(console[_0x482866(0x17b)](_0x23ab36[_0x482866(0x184)],_0x369432),_0x22ca3b['status'](0x1f4)[_0x482866(0x213)]({'message':_0x482866(0x228)}));}}),_0x7047ce[_0x325e92(0x268)](_0x325e92(0x28a),[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x2a1a02,_0x591f72){const _0x15b448=_0x325e92;try{const _0x258a6a=await WelcomeMessages['getMessages']();_0x591f72[_0x15b448(0x169)](0xc8)[_0x15b448(0x213)]({'success':!![],'welcomeMessages':_0x258a6a});}catch(_0x429118){console[_0x15b448(0x17b)](_0x15b448(0x1ca),_0x429118),_0x591f72[_0x15b448(0x169)](0x1f4)[_0x15b448(0x213)]({'success':![],'message':_0x15b448(0x162)});}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x1ea),[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0x1b0054,_0x5f3677)=>{const _0xa4575=_0x325e92;try{const {messages:messages=[]}=_0x23ab36['QmEaD'](reqBody,_0x1b0054);if(!Array[_0xa4575(0x1a6)](messages))return _0x5f3677['status'](0x190)[_0xa4575(0x213)]({'success':![],'message':_0xa4575(0x170)});return await WelcomeMessages[_0xa4575(0x2aa)](messages),_0x5f3677[_0xa4575(0x169)](0xc8)['json']({'success':!![],'message':_0xa4575(0x20b)});}catch(_0x3f7fe7){console[_0xa4575(0x17b)](_0x23ab36[_0xa4575(0x245)],_0x3f7fe7),_0x5f3677[_0xa4575(0x169)](0x1f4)[_0xa4575(0x213)]({'success':!![],'message':_0xa4575(0x178)});}}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x1ac)],[validatedRequest],async(_0x55ee1e,_0x180de4)=>{const _0x264856=_0x325e92;try{if(_0x180de4[_0x264856(0x1bb)][_0x264856(0x1bf)])return _0x180de4[_0x264856(0x276)](0x191)[_0x264856(0x203)]();const _0x1be6d5=await ApiKey[_0x264856(0x1b6)]({});return _0x180de4[_0x264856(0x169)](0xc8)['json']({'apiKeys':_0x1be6d5,'error':null});}catch(_0x10093d){_0x264856(0x26d)==='SyBmA'?(_0x124a3b[_0x264856(0x17b)](_0x6857f6),_0x23836f['sendStatus'](0x1f4)['end']()):(console[_0x264856(0x17b)](_0x10093d),_0x180de4[_0x264856(0x169)](0x1f4)[_0x264856(0x213)]({'apiKey':null,'error':_0x264856(0x191)}));}}),_0x7047ce[_0x325e92(0x165)](_0x23ab36[_0x325e92(0x297)],[validatedRequest],async(_0xf721f4,_0x51e563)=>{const _0x4f26c4=_0x325e92;try{if(_0x51e563[_0x4f26c4(0x1bb)][_0x4f26c4(0x1bf)]){if(_0x23ab36[_0x4f26c4(0x283)](_0x4f26c4(0x252),_0x4f26c4(0x252)))_0x164f84[_0x4f26c4(0x17b)](_0x205359[_0x4f26c4(0x1d4)],_0x206960),_0x6a6bb7[_0x4f26c4(0x276)](0x1f4)[_0x4f26c4(0x203)]();else return _0x51e563[_0x4f26c4(0x276)](0x191)[_0x4f26c4(0x203)]();}const {apiKey:_0x381507,error:_0x2cfd1d}=await ApiKey[_0x4f26c4(0x29c)]();return await Telemetry['sendTelemetry'](_0x4f26c4(0x232)),await EventLogs[_0x4f26c4(0x2ae)](_0x23ab36['drQKF'],{},_0x51e563?.[_0x4f26c4(0x1bb)]?.['user']?.['id']),_0x51e563['status'](0xc8)[_0x4f26c4(0x213)]({'apiKey':_0x381507,'error':_0x2cfd1d});}catch(_0x56f14d){console[_0x4f26c4(0x17b)](_0x56f14d),_0x51e563['status'](0x1f4)[_0x4f26c4(0x213)]({'apiKey':null,'error':_0x4f26c4(0x18e)});}}),_0x7047ce['delete'](_0x325e92(0x272),[validatedRequest],async(_0x322bc3,_0x5849b0)=>{const _0x2e8e9f=_0x325e92;try{if(_0x5849b0[_0x2e8e9f(0x1bb)][_0x2e8e9f(0x1bf)])return _0x5849b0[_0x2e8e9f(0x276)](0x191)[_0x2e8e9f(0x203)]();return await ApiKey[_0x2e8e9f(0x231)](),await EventLogs[_0x2e8e9f(0x2ae)]('api_key_deleted',{'deletedBy':_0x5849b0[_0x2e8e9f(0x1bb)]?.[_0x2e8e9f(0x193)]?.[_0x2e8e9f(0x241)]},_0x5849b0?.[_0x2e8e9f(0x1bb)]?.['user']?.['id']),_0x5849b0[_0x2e8e9f(0x169)](0xc8)[_0x2e8e9f(0x203)]();}catch(_0x449e2f){console[_0x2e8e9f(0x17b)](_0x449e2f),_0x5849b0[_0x2e8e9f(0x169)](0x1f4)[_0x2e8e9f(0x203)]();}}),_0x7047ce[_0x325e92(0x165)](_0x23ab36['Vvqtk'],[validatedRequest],async(_0x329c2d,_0x2c0a52)=>{const _0x550352=_0x325e92;try{const {provider:_0x438ab0,apiKey:apiKey=null,basePath:basePath=null}=reqBody(_0x329c2d),{models:_0x3e0dcc,error:_0x310f26}=await getCustomModels(_0x438ab0,apiKey,basePath);return _0x2c0a52[_0x550352(0x169)](0xc8)[_0x550352(0x213)]({'models':_0x3e0dcc,'error':_0x310f26});}catch(_0x2238e4){console[_0x550352(0x17b)](_0x2238e4),_0x2c0a52[_0x550352(0x169)](0x1f4)[_0x550352(0x203)]();}}),_0x7047ce['post'](_0x325e92(0x19d),[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)]])],async(_0x11abef,_0xa2700f)=>{const _0x3cad17=_0x325e92;try{if(_0x23ab36[_0x3cad17(0x1b0)](_0x3cad17(0x2b6),_0x3cad17(0x2b6))){const {offset:offset=0x0,limit:limit=0xa}=reqBody(_0x11abef),_0x4f341e=await EventLogs[_0x3cad17(0x247)]({},limit,offset*limit,{'id':_0x3cad17(0x1f7)}),_0x164c41=await EventLogs[_0x3cad17(0x190)](),_0x2e5c6a=_0x23ab36[_0x3cad17(0x257)](_0x164c41,_0x23ab36[_0x3cad17(0x28f)](offset+0x1,limit));_0xa2700f[_0x3cad17(0x169)](0xc8)[_0x3cad17(0x213)]({'logs':_0x4f341e,'hasPages':_0x2e5c6a,'totalLogs':_0x164c41});}else _0x4cdb17[_0x3cad17(0x169)](0xc8)[_0x3cad17(0x213)]({'online':!![]});}catch(_0x4f91eb){console['error'](_0x4f91eb),_0xa2700f[_0x3cad17(0x276)](0x1f4)[_0x3cad17(0x203)]();}}),_0x7047ce[_0x325e92(0x231)](_0x325e92(0x19d),[validatedRequest,_0x23ab36['dSCDS'](flexUserRoleValid,[ROLES['admin']])],async(_0x48f45d,_0x595cbe)=>{const _0xf206d0=_0x325e92;try{await EventLogs[_0xf206d0(0x231)](),await EventLogs['logEvent'](_0x23ab36[_0xf206d0(0x1a9)],{},_0x595cbe?.[_0xf206d0(0x1bb)]?.[_0xf206d0(0x193)]?.['id']),_0x595cbe['json']({'success':!![]});}catch(_0x2ea75e){console[_0xf206d0(0x17b)](_0x2ea75e),_0x595cbe[_0xf206d0(0x276)](0x1f4)[_0xf206d0(0x203)]();}}),_0x7047ce[_0x325e92(0x165)]('/system/workspace-chats',[chatHistoryViewable,validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x24d)],ROLES[_0x325e92(0x1a0)]])],async(_0x4210b1,_0x43d48b)=>{const _0x2cb6bc=_0x325e92;try{const {offset:offset=0x0,limit:limit=0x14}=reqBody(_0x4210b1),_0x19691b=await WorkspaceChats[_0x2cb6bc(0x247)]({},limit,offset*limit,{'id':_0x23ab36['wqYUe']}),_0x2adf34=await WorkspaceChats[_0x2cb6bc(0x190)](),_0x47d0ba=_0x2adf34>(offset+0x1)*limit;_0x43d48b[_0x2cb6bc(0x169)](0xc8)[_0x2cb6bc(0x213)]({'chats':_0x19691b,'hasPages':_0x47d0ba,'totalChats':_0x2adf34});}catch(_0x89b0f8){console[_0x2cb6bc(0x17b)](_0x89b0f8),_0x43d48b[_0x2cb6bc(0x276)](0x1f4)[_0x2cb6bc(0x203)]();}}),_0x7047ce[_0x325e92(0x231)](_0x325e92(0x1f8),[validatedRequest,_0x23ab36[_0x325e92(0x239)](flexUserRoleValid,[ROLES[_0x325e92(0x24d)],ROLES['manager']])],async(_0x13b1b3,_0x12ed0f)=>{const _0x265b62=_0x325e92;try{const {id:_0x276690}=_0x13b1b3['params'];_0x23ab36[_0x265b62(0x290)](Number(_0x276690),-0x1)?await WorkspaceChats[_0x265b62(0x231)]({},!![]):await WorkspaceChats[_0x265b62(0x231)]({'id':_0x23ab36[_0x265b62(0x1be)](Number,_0x276690)}),_0x12ed0f[_0x265b62(0x213)]({'success':!![],'error':null});}catch(_0x3fc50f){console['error'](_0x3fc50f),_0x12ed0f['sendStatus'](0x1f4)['end']();}}),_0x7047ce[_0x325e92(0x268)](_0x23ab36[_0x325e92(0x1a2)],[chatHistoryViewable,validatedRequest,_0x23ab36[_0x325e92(0x1c3)](flexUserRoleValid,[ROLES[_0x325e92(0x1a0)],ROLES['admin']])],async(_0x5b1618,_0x437f15)=>{const _0x508067=_0x325e92;try{const {type:type='jsonl',chatType:chatType=_0x23ab36[_0x508067(0x24c)]}=_0x5b1618[_0x508067(0x26a)],{contentType:_0x4f8895,data:_0x13ca00}=await _0x23ab36[_0x508067(0x175)](exportChatsAsType,type,chatType);await EventLogs[_0x508067(0x2ae)](_0x23ab36['HQZMm'],{'type':type,'chatType':chatType},_0x437f15[_0x508067(0x1bb)][_0x508067(0x193)]?.['id']),_0x437f15[_0x508067(0x286)](_0x508067(0x1e8),_0x4f8895),_0x437f15[_0x508067(0x169)](0xc8)[_0x508067(0x16e)](_0x13ca00);}catch(_0x5ea18c){console[_0x508067(0x17b)](_0x5ea18c),_0x437f15['sendStatus'](0x1f4)['end']();}}),_0x7047ce[_0x325e92(0x165)](_0x325e92(0x18b),[validatedRequest],async(_0x13e13b,_0x1719a1)=>{const _0x187f66=_0x325e92;if(_0x23ab36[_0x187f66(0x26b)](_0x23ab36[_0x187f66(0x256)],_0x187f66(0x28b)))_0x512924[_0x187f66(0x169)](0xc8)[_0x187f66(0x213)]({'success':_0x4b0208,'resetToken':_0x58dd36});else try{if('cHqnO'==='PejrB'){_0x12e7f9[_0x187f66(0x276)](0x191)[_0x187f66(0x203)]();return;}else{const _0x3b2a4a=await _0x23ab36[_0x187f66(0x229)](userFromSession,_0x13e13b,_0x1719a1),{username:_0x2cc5f6,password:_0x5a7fc5}=reqBody(_0x13e13b),_0x1fd6bf=_0x23ab36[_0x187f66(0x225)](Number,_0x3b2a4a['id']);if(!_0x1fd6bf){_0x1719a1[_0x187f66(0x169)](0x190)['json']({'success':![],'error':_0x187f66(0x1f2)});return;}const _0x362ddb={};_0x2cc5f6&&(_0x362ddb['username']=User[_0x187f66(0x294)][_0x187f66(0x241)](_0x23ab36[_0x187f66(0x277)](String,_0x2cc5f6)));_0x5a7fc5&&(_0x362ddb[_0x187f66(0x1e3)]=String(_0x5a7fc5));if(Object[_0x187f66(0x211)](_0x362ddb)[_0x187f66(0x269)]===0x0){if(_0x187f66(0x298)!==_0x187f66(0x1e1)){_0x1719a1[_0x187f66(0x169)](0x190)[_0x187f66(0x213)]({'success':![],'error':'No\x20updates\x20provided'});return;}else _0x489d9c[_0x187f66(0x17b)](_0x187f66(0x1ca),_0x1a53ce),_0x5365a4[_0x187f66(0x169)](0x1f4)[_0x187f66(0x213)]({'success':![],'message':_0x187f66(0x162)});}const {success:_0x51b907,error:_0x8d4c08}=await User['update'](_0x1fd6bf,_0x362ddb);_0x1719a1['status'](0xc8)[_0x187f66(0x213)]({'success':_0x51b907,'error':_0x8d4c08});}}catch(_0x7fd408){console[_0x187f66(0x17b)](_0x7fd408),_0x1719a1[_0x187f66(0x276)](0x1f4)['end']();}}),_0x7047ce['get'](_0x325e92(0x17d),[validatedRequest,flexUserRoleValid([ROLES['all']])],async(_0x2b6087,_0x4cb95c)=>{const _0xc7fc2=_0x325e92;try{const _0xecc22b=await userFromSession(_0x2b6087,_0x4cb95c),_0x486eac=await SlashCommandPresets['getUserPresets'](_0xecc22b?.['id']);_0x4cb95c['status'](0xc8)[_0xc7fc2(0x213)]({'presets':_0x486eac});}catch(_0x57b3a0){if(_0x23ab36[_0xc7fc2(0x1de)](_0x23ab36['SZLsr'],_0x23ab36['YejXv']))console[_0xc7fc2(0x17b)](_0xc7fc2(0x24f),_0x57b3a0),_0x4cb95c[_0xc7fc2(0x169)](0x1f4)[_0xc7fc2(0x213)]({'message':_0x23ab36[_0xc7fc2(0x198)]});else return _0x397554['sendStatus'](0x191)['end']();}}),_0x7047ce[_0x325e92(0x165)](_0x23ab36[_0x325e92(0x236)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async(_0x4b2bbf,_0x36239c)=>{const _0x39e22f=_0x325e92;try{const _0x3de5e4=await userFromSession(_0x4b2bbf,_0x36239c),{command:_0x25cc64,prompt:_0x40da32,description:_0x464861}=_0x23ab36['cGvAH'](reqBody,_0x4b2bbf),_0x3edfbc={'command':SlashCommandPresets[_0x39e22f(0x1d5)](String(_0x25cc64)),'prompt':String(_0x40da32),'description':String(_0x464861)},_0x1a956d=await SlashCommandPresets['create'](_0x3de5e4?.['id'],_0x3edfbc);if(!_0x1a956d)return _0x36239c['status'](0x1f4)[_0x39e22f(0x213)]({'message':_0x23ab36['brbqr']});_0x36239c[_0x39e22f(0x169)](0xc9)[_0x39e22f(0x213)]({'preset':_0x1a956d});}catch(_0x3ba816){console['error'](_0x39e22f(0x284),_0x3ba816),_0x36239c[_0x39e22f(0x169)](0x1f4)[_0x39e22f(0x213)]({'message':_0x23ab36['QgooK']});}}),_0x7047ce[_0x325e92(0x165)](_0x23ab36[_0x325e92(0x206)],[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x1a8)]])],async(_0x440808,_0x297a4b)=>{const _0x48ec38=_0x325e92;try{const _0x43c1e2=await userFromSession(_0x440808,_0x297a4b),{slashCommandId:_0x1ed40b}=_0x440808['params'],{command:_0x572b5c,prompt:_0x121989,description:_0x42e819}=reqBody(_0x440808),_0x512b3a=await SlashCommandPresets[_0x48ec38(0x268)]({'userId':_0x43c1e2?.['id']??null,'id':_0x23ab36['TnbFr'](Number,_0x1ed40b)});if(!_0x512b3a)return _0x297a4b[_0x48ec38(0x169)](0x194)[_0x48ec38(0x213)]({'message':_0x23ab36[_0x48ec38(0x218)]});const _0x1395c7={'command':SlashCommandPresets[_0x48ec38(0x1d5)](_0x23ab36[_0x48ec38(0x186)](String,_0x572b5c)),'prompt':String(_0x121989),'description':_0x23ab36['SRtlN'](String,_0x42e819)},_0x1bae62=await SlashCommandPresets[_0x48ec38(0x281)](Number(_0x1ed40b),_0x1395c7);if(!_0x1bae62)return _0x297a4b[_0x48ec38(0x276)](0x1a6);_0x297a4b['status'](0xc8)[_0x48ec38(0x213)]({'preset':{..._0x512b3a,..._0x1395c7}});}catch(_0x545a97){console[_0x48ec38(0x17b)](_0x48ec38(0x253),_0x545a97),_0x297a4b[_0x48ec38(0x169)](0x1f4)['json']({'message':_0x23ab36['QgooK']});}}),_0x7047ce['delete'](_0x23ab36[_0x325e92(0x206)],[validatedRequest,flexUserRoleValid([ROLES[_0x325e92(0x1a8)]])],async(_0x32bfe3,_0x2ddd0f)=>{const _0x414631=_0x325e92;if(_0x23ab36[_0x414631(0x1c8)]===_0x23ab36[_0x414631(0x1c8)])try{const {slashCommandId:_0x528bed}=_0x32bfe3[_0x414631(0x1d8)],_0x333b57=await _0x23ab36[_0x414631(0x175)](userFromSession,_0x32bfe3,_0x2ddd0f),_0x1682ab=await SlashCommandPresets[_0x414631(0x268)]({'userId':_0x333b57?.['id']??null,'id':_0x23ab36[_0x414631(0x196)](Number,_0x528bed)});if(!_0x1682ab)return _0x2ddd0f[_0x414631(0x169)](0x193)[_0x414631(0x213)]({'message':_0x414631(0x2b5)});await SlashCommandPresets[_0x414631(0x231)](Number(_0x528bed)),_0x2ddd0f[_0x414631(0x276)](0xcc);}catch(_0x4b0e9b){console[_0x414631(0x17b)](_0x23ab36[_0x414631(0x279)],_0x4b0e9b),_0x2ddd0f[_0x414631(0x169)](0x1f4)[_0x414631(0x213)]({'message':_0x23ab36[_0x414631(0x198)]});}else _0x519fcf['error']('Error\x20processing\x20the\x20logo\x20removal:',_0x2212ab),_0x372d7f[_0x414631(0x169)](0x1f4)[_0x414631(0x213)]({'message':_0x414631(0x228)});});}function _0x5bca(){const _0x443e80=['rmmxG','NJGuH','../models/apiKeys','hDuhe','htUtA','nxYub','DAdXI','Error\x20processing\x20the\x20welcome\x20messages:','eFEyP','Kxupi','JPrco','username','exports','pkCFB','zvFDZ','PBlcF','../models/workspaceChats','whereWithData','caAvG','attachment;\x20filename=','Invalid\x20path\x20name','JWT_SECRET','JNiFP','admin','OMhQB','Error\x20fetching\x20slash\x20command\x20presets:','12LvIoqj','/system/upload-logo','uvJfn','Error\x20updating\x20slash\x20command\x20preset:','AWYRL','[001]\x20An\x20error\x20occurred\x20while\x20validating\x20the\x20token:\x20','WftUN','XzlVk','from','SdhLW','kRCFk','hBSFo','writeHead','unlinkSync','/system/check-token','dSCDS','rMZiH','event_logs_cleared','compareSync','/system/enable-multi-user','NsIEV','Unknown\x20user','bcrypt','KXfqD','get','length','query','YtFMq','jTFjH','npIzb','exEQJ','failed_login_invalid_password','[003]\x20Invalid\x20password\x20provided','xLmts','/system/api-key','/system/custom-app-name','../models/browserExtensionApiKey','QvfQR','sendStatus','Qhwdg','dcyBJ','gNKnu','sendTelemetry','dotenv','beIPD','workspace','../utils/helpers','BXZIj','Error\x20resetting\x20password:','update','/request-token','hZsAa','Error\x20creating\x20slash\x20command\x20preset:','image/png','setHeader','CeUJw','FwHrW','stringify','/system/welcome-messages','oVchU','228576cZtnEX','.env.','../utils/collectorApi','cwssU','dxnws','uuid','VazgE','184557EHStfo','validations','ejYjp','/system/is-default-logo','CdQeF','REmVI','_updateSettings','/env-dump','../utils/files','create','isbVc','QLCKW','Content-Disposition,X-Is-Custom-Logo,Content-Type,Content-Length','gbwId','FUVuN','currentSettings','NLkaN','Failed\x20to\x20remove\x20profile\x20picture.','ZxjJu','existsSync','pmSgN','Error\x20processing\x20the\x20profile\x20picture\x20upload:','hashSync','saveAll','/system/slash-command-presets/:slashCommandId','fWvUK','nRwwr','logEvent','env','VIGJl','seen_recovery_codes','../models/user','Error\x20uploading\x20the\x20logo.','ZGogg','Failed\x20to\x20delete\x20preset','PTUxI','development','rDTGy','Internal\x20server\x20error','rpcwD','Failed\x20to\x20update\x20with\x20new\x20logo.','post','/system/remove-folder','slug','rJoDU','status','Error\x20fetching\x20custom\x20app\x20name:','suspended','DCSAt','/system/pfp/:id','send','Profile\x20picture\x20removed\x20successfully.','Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.','2825921JOYSmp','ujRpn','SsdNU','395599GXsGFk','Ayhvp','Preset\x20not\x20found','join','Error\x20saving\x20the\x20welcome\x20messages.','DrFku','winTD','error','CCPoY','/system/slash-command-presets','BefnC','multi_user_mode_enabled','Profile\x20picture\x20uploaded\x20successfully.','/system/reset-password','/system/remove-pfp','base64','BpXEY','2610612wtQxZw','ltozl','custom_app_name','ScmEn','/system/footer-data','Unknown\x20IP','/system/user','Ajlnf','/ping','Error\x20generating\x20api\x20key.','isMultiUserMode','count','Could\x20not\x20find\x20an\x20API\x20Key.','nAtVM','user','pUlEb','AXPcY','DSRuB','TfQex','QgooK','CyYjk','CyBeR','BsSPV','../utils/middleware/validatedRequest','/system/event-logs','acgOZ','../utils/helpers/updateENV','manager','/system/remove-document','Xbwuv','HjCSV','[002]\x20Invalid\x20login\x20credentials.','NODE_ENV','isArray','currentLogoFilename','all','fEIhD','AgkKx','gQtuN','ZoDiA','nQkaY','PfJpZ','[001]\x20Invalid\x20login\x20credentials.','FfdfP','efUcm','sSbxI','OhgZc','rvMpO','encrypt','where','filterFields','JebCn','yHcIM','value','locals','PhsVW','nKSJI','SRtlN','multiUserMode','Error\x20processing\x20the\x20logo\x20request:','xNHwe','SrNuE','VzpqM','cGvAH','rGxWA','QmEaD','/system/recover-account','afBUb','/system/export-chats','Error\x20fetching\x20welcome\x20messages:','Logo\x20removed\x20successfully.','cLoaS','ZStlY','KOapZ','pfpFilename','totalVectors','SoeGI','869304XrwQPb','online','message','formatCommand','UfUSQ','../storage/assets/pfp','params','nBeWF','zjEFt','Failed\x20to\x20update\x20with\x20new\x20profile\x20picture.','/system/generate-api-key','/system/upload-pfp','lZSlW','QkkuR','../models/telemetry','pyhon','Error\x20deleting\x20slash\x20command\x20preset:','password','failed_login_account_suspended','../utils/middleware/multiUserProtected','resolve','migrateApiKeysToMultiUser','Content-Type','exported_chats','/system/set-welcome-messages','/system/custom-models','../utils/files/multer','VNJaf','mOpkl','Evjub','randomFileName','/system/remove-logo','Invalid\x20user\x20ID','../utils/PasswordRecovery','fNXOj','fSpqR','Multi-user\x20mode\x20is\x20already\x20enabled.','desc','/system/workspace-chats/:id','WFodz','/system/multi-user-mode','basename','/system/accepted-document-types','UlxWK','UKWHO','NAlTA','Logo\x20uploaded\x20successfully.','aipGg','login_event','end','30d','QIBxl','tqnVz','default','hSdtR','../utils/helpers/customModels','/migrate','Welcome\x20messages\x20saved\x20successfully.','XOnpO','theme','KvskC','/system/update-env','ixNtR','keys','/request-token/sso/simple','json','[004]\x20Account\x20suspended\x20by\x20admin.','/system/remove-documents','originalname','../models/temporaryAuthToken','xaDdO','../utils/middleware/chatHistoryViewable','failed_login_invalid_temporary_auth_token','gbOwE','xWqGP','Error\x20processing\x20the\x20profile\x20picture\x20removal:','AmobF','../utils/EncryptionManager','dtrKs','UGJME','KoFpJ','production','zVWYF','yPbYB','ESrWh','MihhI','Error\x20removing\x20the\x20logo.','ECjIm','/system/update-password','AUTH_TOKEN','namespaceCount','MZsEO','bnWqt','File\x20upload\x20failed.','561210SZtWaJ','delete','api_key_created','file','XXjxj','../models/welcomeMessages'];_0x5bca=function(){return _0x443e80;};return _0x5bca();}module[_0x27f178(0x242)]={'systemEndpoints':systemEndpoints};