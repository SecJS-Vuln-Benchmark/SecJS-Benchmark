function _0x9994(){const _0x1f6ab0=['NODE_ENV','Authorization','../../models/systemSettings','../EncryptionManager','FWwlH','sjthO','env','Invalid\x20auth\x20token.','15766434jSdJzh','Invalid\x20auth\x20credentials.','aYJvX','CereU','status','YVXIC','compareSync','You\x20need\x20to\x20set\x20an\x20AUTH_TOKEN\x20environment\x20variable.','locals','300tJJWSh','11358952usndmG','mdoLc','qLGmN','6745730acHQpD','LYeDf','NPEaj','decrypt','7866612fGLQrQ','8378cWNGUR','181JallKv','development','EtnrK','ixpHq','Token\x20expired\x20or\x20failed\x20validation.','pSbtx','yxsOy','AUTH_TOKEN','KDczb','hBYNj','nzxRM','json','DmsCO','hashSync','wZrva','bcrypt','jMuaP','yiOOk','716hKOdlk','user','get','No\x20auth\x20token\x20found.','GxpJH','ozJza','isMultiUserMode','pElCZ','User\x20is\x20suspended\x20from\x20system','exports','JWT_SECRET','Invalid\x20auth\x20for\x20user.','ovQbT','9772973nitgSl'];_0x9994=function(){return _0x1f6ab0;};return _0x9994();}const _0xc0373c=_0x162d;(function(_0x48abe9,_0x4532f3){const _0x71bbec=_0x162d,_0x3fc43d=_0x48abe9();while(!![]){try{const _0x9239fb=parseInt(_0x71bbec(0x1f9))/0x1*(-parseInt(_0x71bbec(0x1f8))/0x2)+-parseInt(_0x71bbec(0x1ef))/0x3*(parseInt(_0x71bbec(0x20b))/0x4)+-parseInt(_0x71bbec(0x1f3))/0x5+parseInt(_0x71bbec(0x1f7))/0x6+-parseInt(_0x71bbec(0x218))/0x7+parseInt(_0x71bbec(0x1f0))/0x8+parseInt(_0x71bbec(0x1e6))/0x9;if(_0x9239fb===_0x4532f3)break;else _0x3fc43d['push'](_0x3fc43d['shift']());}catch(_0x2315a9){_0x3fc43d['push'](_0x3fc43d['shift']());}}}(_0x9994,0xeab7b));const {SystemSettings}=require(_0xc0373c(0x21b)),{User}=require('../../models/user'),{EncryptionManager}=require(_0xc0373c(0x21c)),{decodeJWT}=require('../http'),EncryptionMgr=new EncryptionManager();async function validatedRequest(_0x287d83,_0x3332a4,_0x42a1c8){const _0x135e0e=_0xc0373c,_0x52b8a4={'ozJza':_0x135e0e(0x1e7),'yxsOy':_0x135e0e(0x216),'aYJvX':_0x135e0e(0x213),'LYeDf':_0x135e0e(0x1fa),'wZrva':function(_0x2a0fe9,_0x225ea0){return _0x2a0fe9===_0x225ea0;},'hBYNj':_0x135e0e(0x1fc),'NMwlR':'You\x20need\x20to\x20set\x20an\x20AUTH_TOKEN\x20environment\x20variable.','yiOOk':_0x135e0e(0x21a),'FWwlH':function(_0x48c401,_0x27943e){return _0x48c401!==_0x27943e;},'EtnrK':_0x135e0e(0x20e),'qLGmN':function(_0x3b48a9,_0x5c10b8){return _0x3b48a9(_0x5c10b8);},'YVXIC':_0x135e0e(0x208),'CereU':_0x135e0e(0x1f5),'wSdjy':_0x135e0e(0x1fd)},_0x26131a=await SystemSettings[_0x135e0e(0x211)]();_0x3332a4[_0x135e0e(0x1ee)]['multiUserMode']=_0x26131a;if(_0x26131a)return await validateMultiUserRequest(_0x287d83,_0x3332a4,_0x42a1c8);if(process[_0x135e0e(0x21f)][_0x135e0e(0x219)]===_0x52b8a4[_0x135e0e(0x1f4)]||!process[_0x135e0e(0x21f)][_0x135e0e(0x200)]||!process[_0x135e0e(0x21f)][_0x135e0e(0x215)]){_0x42a1c8();return;}if(!process[_0x135e0e(0x21f)][_0x135e0e(0x200)]){if(_0x52b8a4['wZrva'](_0x135e0e(0x1fc),_0x52b8a4[_0x135e0e(0x202)])){_0x3332a4[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x52b8a4['NMwlR']});return;}else{_0x4affaf[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x52b8a4[_0x135e0e(0x210)]});return;}}const _0x47f463=_0x287d83['header'](_0x52b8a4[_0x135e0e(0x20a)]),_0x3f8ed7=_0x47f463?_0x47f463['split']('\x20')[0x1]:null;if(!_0x3f8ed7){if(_0x52b8a4[_0x135e0e(0x21d)](_0x135e0e(0x212),'xokHe')){_0x3332a4[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x52b8a4[_0x135e0e(0x1fb)]});return;}else{_0x1cae0f[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x52b8a4[_0x135e0e(0x1ff)]});return;}}const _0x4adaee=_0x52b8a4[_0x135e0e(0x1f2)](require,_0x52b8a4[_0x135e0e(0x1eb)]),{p:_0x139663}=decodeJWT(_0x3f8ed7);if(_0x139663===null||!/\w{32}:\w{32}/['test'](_0x139663)){if(_0x52b8a4[_0x135e0e(0x207)](_0x52b8a4[_0x135e0e(0x1e9)],_0x52b8a4[_0x135e0e(0x1e9)])){_0x3332a4[_0x135e0e(0x1ea)](0x191)['json']({'error':_0x52b8a4['wSdjy']});return;}else{_0x23b9f2[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x52b8a4[_0x135e0e(0x1e8)]});return;}}if(!_0x4adaee[_0x135e0e(0x1ec)](EncryptionMgr[_0x135e0e(0x1f6)](_0x139663),_0x4adaee[_0x135e0e(0x206)](process['env'][_0x135e0e(0x200)],0xa))){_0x3332a4[_0x135e0e(0x1ea)](0x191)[_0x135e0e(0x204)]({'error':_0x135e0e(0x1e7)});return;}_0x42a1c8();}async function validateMultiUserRequest(_0x344322,_0x1cb388,_0x8b5f86){const _0x58c783=_0xc0373c,_0x1b61f3={'KDczb':_0x58c783(0x1ed),'DmsCO':_0x58c783(0x1e5),'VlNNn':'pSbtx','AnEgi':function(_0x4f8d8c,_0x5a1b26){return _0x4f8d8c!==_0x5a1b26;},'GxpJH':_0x58c783(0x21e),'mdoLc':'User\x20is\x20suspended\x20from\x20system','jMuaP':function(_0x532b5a){return _0x532b5a();}},_0x380dc1=_0x344322['header'](_0x58c783(0x21a)),_0x314639=_0x380dc1?_0x380dc1['split']('\x20')[0x1]:null;if(!_0x314639){if(_0x58c783(0x1fe)!==_0x1b61f3['VlNNn']){_0x3c6715[_0x58c783(0x1ea)](0x191)[_0x58c783(0x204)]({'error':_0x58c783(0x20e)});return;}else{_0x1cb388[_0x58c783(0x1ea)](0x191)[_0x58c783(0x204)]({'error':'No\x20auth\x20token\x20found.'});return;}}const _0x101896=decodeJWT(_0x314639);if(!_0x101896||!_0x101896['id']){_0x1cb388['status'](0x191)['json']({'error':_0x1b61f3[_0x58c783(0x205)]});return;}const _0x1654b4=await User[_0x58c783(0x20d)]({'id':_0x101896['id']});if(!_0x1654b4){if(_0x1b61f3['AnEgi'](_0x58c783(0x217),_0x1b61f3[_0x58c783(0x20f)])){_0x1cb388[_0x58c783(0x1ea)](0x191)[_0x58c783(0x204)]({'error':_0x58c783(0x216)});return;}else{_0x385e9c['status'](0x191)['json']({'error':_0x1b61f3[_0x58c783(0x201)]});return;}}if(_0x1654b4['suspended']){if(_0x58c783(0x203)!=='IRmUW'){_0x1cb388[_0x58c783(0x1ea)](0x191)[_0x58c783(0x204)]({'error':_0x1b61f3[_0x58c783(0x1f1)]});return;}else{_0xe6f8a0['status'](0x191)[_0x58c783(0x204)]({'error':_0x1b61f3['DmsCO']});return;}}_0x1cb388['locals'][_0x58c783(0x20c)]=_0x1654b4,_0x1b61f3[_0x58c783(0x209)](_0x8b5f86);}function _0x162d(_0x395849,_0xe6bd45){const _0x999416=_0x9994();return _0x162d=function(_0x162dd1,_0xb0680b){_0x162dd1=_0x162dd1-0x1e5;let _0x4f0076=_0x999416[_0x162dd1];return _0x4f0076;},_0x162d(_0x395849,_0xe6bd45);}module[_0xc0373c(0x214)]={'validatedRequest':validatedRequest};