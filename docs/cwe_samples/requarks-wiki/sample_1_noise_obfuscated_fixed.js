function _0x38af(){var _0xbb3d96=['HsXJL','hRywl','ncGUh','setupTotp','hasPermission','/api/users/reviewers','safe','Xustd','PsThu','get','24636qXxFRp','jsonwebtoken','string','zDBnG','audits:review-all','JWT\x20','BAjIu','rHMLZ','bwlyt','BadParameters','48KSEkYH','log','New\x20password\x20validation\x20failed','stringify','removeSession','fFmcj','612873zQnXvc','3318136GrdsaH','then','Internal','844963vfHWcs','post','getTotpQrcode','FoMzJ','EFRpM','yQolH','/api/users/:id','qNqSj','tPLRK','password','updateClock();','clearCookie','cjlYS','lvonW','validtoken','Password\x20does\x20not\x20match\x20the\x20password\x20policy','sBAbM','hTizr','xwAcf','jyObs','XNtle','Already\x20Initialized','name','Missing\x20some\x20required\x20parameters','10Ockwyd','974196ToOFlq','bRayL','Created','BPeeG','/api/users/totp','audits:review','7|5|3|2|6|4|0|1','GQBqd','confirmPassword','8|9|1|7|0|3|2|6|4|10|5','/api/users/checktoken','mPnxU','return\x20await\x20Promise.resolve(42);','getByUsername','userId','ePwPY','updateRefreshToken','../lib/auth','isNil','JOhbv','HbBuQ','/api/users/token','Parameters\x20must\x20be\x20of\x20type\x20String','user','VJgKK','kSoOA','phone','NpuPD','1166gYeUqW','create','iIDDF','return\x20new\x20Date();','cookie','length','XbsKk','totpToken','4|1|2|0|3','lastname','totpSecret','admin','DegZT','yCqwG','PynwP','50235HjHhoc','HRpkz','firstname','FSYYH','eCJMi','email','/api/users/refreshtoken','Unauthorized','bLOgQ','GslPh','users:create','Required\x20parameters:\x20username,\x20password','BeTbl','wYWBV','MERch','catch','getAll','sessionId','push','cJgVz','params','forEach','put','AdaLT','TbPzI','currentPassword','New\x20Password\x20does\x20not\x20match\x20the\x20password\x20policy','strongPassword','cookies','role','isAllowed','split','newPassword','88tdyhow','/api/users/me','getToken','User','user-agent','model','delete','XmHzY','VNnpS','acl','GIvly','MhIhq','updateProfile','GdfSE','username','token','decodedToken','208383HJwlBs','../lib/passwordpolicy','refreshToken','verify','enabled','/api/users','hwvQV','6OeCFfb','gPsQc','headers','body','jwtRefreshSecret','SBIyo','WQluF','/api/users/init','TokenExpiredError'];_0x38af=function(){return _0xbb3d96;};return _0x38af();}function _0xb5ee(_0x57d9b9,_0x166fc7){var _0x38af09=_0x38af();return _0xb5ee=function(_0xb5eee1,_0x11bc73){_0xb5eee1=_0xb5eee1-0x116;var _0x230afa=_0x38af09[_0xb5eee1];return _0x230afa;},_0xb5ee(_0x57d9b9,_0x166fc7);}(function(_0x1820d5,_0x11ae95){var _0x3bc53d=_0xb5ee,_0x3cc7f8=_0x1820d5();while(!![]){try{var _0x537257=parseInt(_0x3bc53d(0x1a6))/0x1+parseInt(_0x3bc53d(0x17f))/0x2*(-parseInt(_0x3bc53d(0x11b))/0x3)+parseInt(_0x3bc53d(0x167))/0x4*(parseInt(_0x3bc53d(0x146))/0x5)+parseInt(_0x3bc53d(0x19c))/0x6*(-parseInt(_0x3bc53d(0x178))/0x7)+parseInt(_0x3bc53d(0x1a3))/0x8+-parseInt(_0x3bc53d(0x1a2))/0x9*(-parseInt(_0x3bc53d(0x11a))/0xa)+-parseInt(_0x3bc53d(0x137))/0xb*(-parseInt(_0x3bc53d(0x192))/0xc);if(_0x537257===_0x11ae95)break;else _0x3cc7f8['push'](_0x3cc7f8['shift']());}catch(_0x2cd56c){_0x3cc7f8['push'](_0x3cc7f8['shift']());}}}(_0x38af,0x87493),module['exports']=function(_0x15ae70){var _0x34ad1c=_0xb5ee,_0x249710={'gPsQc':'token','yQolH':function(_0x20c769,_0x450968){return _0x20c769===_0x450968;},'GdfSE':_0x34ad1c(0x153),'ylgUs':_0x34ad1c(0x189),'mPnxU':_0x34ad1c(0x14d),'kSoOA':_0x34ad1c(0x17a),'DegZT':'xuINN','GslPh':function(_0x489dae,_0x1fc60e){return _0x489dae+_0x1fc60e;},'XmHzY':'return\x20await\x20Promise.resolve(42);','bLOgQ':_0x34ad1c(0x13f),'JOhbv':_0x34ad1c(0x187),'cJgVz':'Invalid\x20refreshToken','BeTbl':function(_0x35be8a,_0x206b7a){return _0x35be8a*_0x206b7a;},'PynwP':_0x34ad1c(0x121),'QiEZb':_0x34ad1c(0x16b),'Xustd':function(_0x4d639d,_0x1c5191){return _0x4d639d!==_0x1c5191;},'XbsKk':_0x34ad1c(0x151),'hTizr':_0x34ad1c(0x1b0),'eCJMi':_0x34ad1c(0x14c),'lBMqV':_0x34ad1c(0x11c),'cmohG':'Missing\x20some\x20required\x20parameters','qNqSj':function(_0x4498cc,_0x59bf46,_0x16fbf8){return _0x4498cc(_0x59bf46,_0x16fbf8);},'qKVAL':'hiPgg','GIvly':_0x34ad1c(0x132),'WQluF':_0x34ad1c(0x1b5),'hwvQV':_0x34ad1c(0x18e),'BAjIu':'2|1|4|3|0','cjlYS':_0x34ad1c(0x117),'AdaLT':_0x34ad1c(0x190),'BPeeG':_0x34ad1c(0x142),'MERch':_0x34ad1c(0x19e),'ncGUh':function(_0x22baf7,_0x5db514){return _0x22baf7(_0x5db514);},'ejywV':_0x34ad1c(0x13a),'BCrHk':'../lib/httpResponse.js','rHMLZ':'mongoose','FSYYH':function(_0x51f777,_0x5e05c8){return _0x51f777(_0x5e05c8);},'TbPzI':_0x34ad1c(0x193),'bFsga':_0x34ad1c(0x179),'hZlQi':_0x34ad1c(0x17d),'XNtle':_0x34ad1c(0x18d),'VJgKK':'users:read','yCqwG':_0x34ad1c(0x168),'HRpkz':_0x34ad1c(0x11f),'bwlyt':_0x34ad1c(0x1b4),'zDBnG':'/api/users/:username','ePwPY':_0x34ad1c(0x150)},_0x4423db=_0x249710[_0x34ad1c(0x18a)](require,_0x249710['BCrHk']),_0x58f1ba=require(_0x249710[_0x34ad1c(0x199)])[_0x34ad1c(0x16c)](_0x34ad1c(0x16a)),_0x180358=require('../lib/auth')[_0x34ad1c(0x170)],_0x54e272=_0x249710[_0x34ad1c(0x149)](require,_0x34ad1c(0x12c))[_0x34ad1c(0x183)],_0x79e1e7=require(_0x249710[_0x34ad1c(0x15e)]),_0x49277a=require('lodash'),_0x53f871=_0x249710[_0x34ad1c(0x149)](require,_0x249710['bFsga']);_0x15ae70['get'](_0x34ad1c(0x125),_0x180358[_0x34ad1c(0x18c)](_0x34ad1c(0x1b4)),function(_0x5a8871,_0x4b1fbe){var _0x5f4546=_0x34ad1c;_0x4423db['Ok'](_0x4b1fbe,_0x5a8871[_0x5f4546(0x162)][_0x249710[_0x5f4546(0x180)]]);}),_0x15ae70[_0x34ad1c(0x191)]('/api/users/refreshtoken',function(_0x2619f3,_0x546890){var _0x9d9036=_0x34ad1c,_0x27e4d0={'HbBuQ':_0x9d9036(0x176),'SBIyo':_0x9d9036(0x17a)},_0x4a85b1=_0x2619f3['headers'][_0x9d9036(0x16b)],_0x4f62f1=_0x2619f3[_0x9d9036(0x162)][_0x9d9036(0x17a)];_0x58f1ba[_0x9d9036(0x12b)](_0x4f62f1,_0x4a85b1)[_0x9d9036(0x1a4)](_0x2ce2df=>{var _0x34e6b0=_0x9d9036;_0x249710[_0x34e6b0(0x1ab)](_0x249710[_0x34e6b0(0x174)],_0x249710['ylgUs'])?(_0x561ef9[_0x34e6b0(0x13b)](_0x27e4d0[_0x34e6b0(0x12f)],_0x34e6b0(0x197)+_0x4a611d['token'],{'secure':!![],'httpOnly':!![]}),_0x238dc8[_0x34e6b0(0x13b)](_0x27e4d0[_0x34e6b0(0x184)],_0x151da1[_0x34e6b0(0x17a)],{'secure':!![],'httpOnly':!![],'path':'/api/users/refreshtoken'}),_0x13e7f2[_0x34e6b0(0x11d)](_0x141812,_0x4c6727)):(_0x546890['cookie'](_0x249710['gPsQc'],_0x34e6b0(0x197)+_0x2ce2df[_0x34e6b0(0x176)],{'secure':!![],'httpOnly':!![]}),_0x546890[_0x34e6b0(0x13b)](_0x34e6b0(0x17a),_0x2ce2df[_0x34e6b0(0x17a)],{'secure':!![],'httpOnly':!![],'path':_0x34e6b0(0x14c)}),_0x4423db['Ok'](_0x546890,_0x2ce2df));})[_0x9d9036(0x155)](_0x7304f4=>{var _0xe1585f=_0x9d9036;_0x249710[_0xe1585f(0x1ab)](_0x7304f4['fn'],_0x249710[_0xe1585f(0x126)])&&(_0x546890[_0xe1585f(0x1b1)](_0x249710[_0xe1585f(0x180)]),_0x546890[_0xe1585f(0x1b1)](_0x249710[_0xe1585f(0x134)])),_0x4423db[_0xe1585f(0x1a5)](_0x546890,_0x7304f4);});}),_0x15ae70[_0x34ad1c(0x16d)](_0x249710[_0x34ad1c(0x14a)],function(_0x497001,_0x597ef5){var _0xc738be=_0x34ad1c,_0x32f870={'FoMzJ':function(_0x4876ef,_0x218b63){var _0x15ee52=_0xb5ee;return _0x249710[_0x15ee52(0x14f)](_0x4876ef,_0x218b63);},'HsXJL':_0x249710['XmHzY']},_0x5bd178=_0x497001[_0xc738be(0x162)][_0x249710[_0xc738be(0x134)]];try{var _0x488460=_0x79e1e7[_0xc738be(0x17b)](_0x5bd178,_0x54e272);}catch(_0x38b054){var _0xeb551d=_0x249710[_0xc738be(0x14e)][_0xc738be(0x165)]('|'),_0x1e4a53=0x0;while(!![]){switch(_0xeb551d[_0x1e4a53++]){case'0':eval('var _0x45015f = _0xc738be;_0x32f870[_0x45015f(425)](1, 1);');continue;case'1':_0x597ef5['clearCookie'](_0x249710[_0xc738be(0x134)]);continue;case'2':if(_0x38b054[_0xc738be(0x118)]===_0x249710[_0xc738be(0x12e)])_0x4423db[_0xc738be(0x14d)](_0x597ef5,'Expired\x20refreshToken');else _0x4423db[_0xc738be(0x14d)](_0x597ef5,_0x249710[_0xc738be(0x159)]);continue;case'3':return;case'4':_0x597ef5['clearCookie'](_0x249710[_0xc738be(0x180)]);continue;}break;}}_0x58f1ba[_0xc738be(0x1a0)](_0x488460[_0xc738be(0x129)],_0x488460[_0xc738be(0x157)])[_0xc738be(0x1a4)](_0x4a0c80=>{var _0xb2e9b6=_0xc738be;if(_0xb2e9b6(0x139)!==_0x249710[_0xb2e9b6(0x143)])_0x597ef5[_0xb2e9b6(0x1b1)](_0x249710[_0xb2e9b6(0x180)]),_0x597ef5[_0xb2e9b6(0x1b1)](_0x249710[_0xb2e9b6(0x134)]),_0x4423db['Ok'](_0x597ef5,_0x4a0c80);else{_0x35632c[_0xb2e9b6(0x19b)](_0x27dde8,_0xb2e9b6(0x119)),new _0x198aba(_0x32f870[_0xb2e9b6(0x188)])();return;}})[_0xc738be(0x155)](_0x1dc0a0=>_0x4423db[_0xc738be(0x1a5)](_0x597ef5,_0x1dc0a0));}),_0x15ae70[_0x34ad1c(0x1a7)](_0x34ad1c(0x130),function(_0x4b394d,_0x7ae866){var _0x4a169c=_0x34ad1c,_0x5b8ae7=_0x249710[_0x4a169c(0x145)][_0x4a169c(0x165)]('|'),_0x558b5c=0x0;while(!![]){switch(_0x5b8ae7[_0x558b5c++]){case'0':if(_0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x13e)])_0x5843ca[_0x4a169c(0x13e)]=_0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x13e)];continue;case'1':_0x5843ca['getToken'](_0x4b394d[_0x4a169c(0x181)][_0x249710['QiEZb']])[_0x4a169c(0x1a4)](_0x274b28=>{var _0xf03d73=_0x4a169c;_0x7ae866[_0xf03d73(0x13b)]('token',_0xf03d73(0x197)+_0x274b28['token'],{'secure':!![],'httpOnly':!![]}),_0x7ae866['cookie'](_0x45e26e['PgWaP'],_0x274b28[_0xf03d73(0x17a)],{'secure':!![],'httpOnly':!![],'path':_0x45e26e[_0xf03d73(0x1a1)]}),_0x4423db['Ok'](_0x7ae866,_0x274b28);})['catch'](_0x8eab17=>_0x4423db['Internal'](_0x7ae866,_0x8eab17));continue;case'2':var _0x5843ca=new _0x58f1ba();continue;case'3':if(_0x249710[_0x4a169c(0x18f)](typeof _0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x1af)],_0x4a169c(0x194))||typeof _0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x175)]!==_0x4a169c(0x194)||_0x4b394d['body'][_0x4a169c(0x13e)]&&_0x249710[_0x4a169c(0x18f)](typeof _0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x13e)],_0x4a169c(0x194))){_0x4423db['BadParameters'](_0x7ae866,_0x4a169c(0x131)),eval('var _0x128e22 = _0x4a169c;_0x249710[_0x128e22(338)](Math[\'PI\'], 2);');return;}continue;case'4':_0x5843ca[_0x4a169c(0x1af)]=_0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x1af)];continue;case'5':if(!_0x4b394d['body'][_0x4a169c(0x1af)]||!_0x4b394d[_0x4a169c(0x182)][_0x4a169c(0x175)]){_0x4423db[_0x4a169c(0x19b)](_0x7ae866,_0x249710[_0x4a169c(0x13d)]),setInterval(_0x249710[_0x4a169c(0x1b7)],0x3e8);return;}continue;case'6':_0x5843ca[_0x4a169c(0x175)]=_0x4b394d['body'][_0x4a169c(0x175)];continue;case'7':var _0x45e26e={'PgWaP':_0x4a169c(0x17a),'fFmcj':_0x249710[_0x4a169c(0x14a)]};continue;}break;}}),_0x15ae70['get'](_0x34ad1c(0x186),function(_0x382940,_0x2c2234){var _0x116c9d=_0x34ad1c;_0x58f1ba[_0x116c9d(0x156)]()[_0x116c9d(0x1a4)](_0xc6c423=>_0x4423db['Ok'](_0x2c2234,_0xc6c423[_0x116c9d(0x13c)]===0x0))[_0x116c9d(0x155)](_0x50cce7=>_0x4423db[_0x116c9d(0x1a5)](_0x2c2234,_0x50cce7));}),_0x15ae70[_0x34ad1c(0x191)](_0x249710['hZlQi'],_0x180358['hasPermission']('users:read'),function(_0x283dc5,_0x1f1d0a){var _0x1cb8c5=_0x34ad1c;_0x58f1ba[_0x1cb8c5(0x156)]()['then'](_0x4bcbec=>_0x4423db['Ok'](_0x1f1d0a,_0x4bcbec))[_0x1cb8c5(0x155)](_0x391b41=>_0x4423db['Internal'](_0x1f1d0a,_0x391b41));}),_0x15ae70[_0x34ad1c(0x191)](_0x249710[_0x34ad1c(0x116)],_0x180358['hasPermission'](_0x249710[_0x34ad1c(0x133)]),function(_0x1ef409,_0x395b8b){var _0x537aaf=_0x34ad1c;_0x537aaf(0x1b3)!==_0x537aaf(0x1b3)?_0xb9aa41[_0x537aaf(0x156)]()['then'](_0x4ea3ef=>_0x14f924['Ok'](_0x53809e,_0x4ea3ef[_0x537aaf(0x13c)]===0x0))[_0x537aaf(0x155)](_0x3ad416=>_0xbe8cdf[_0x537aaf(0x1a5)](_0x269fdc,_0x3ad416)):_0x58f1ba[_0x537aaf(0x156)]()[_0x537aaf(0x1a4)](_0x34a361=>{var _0x19812d=_0x537aaf,_0x528184={'NpuPD':_0x19812d(0x120)},_0x2d12db=[];_0x34a361[_0x19812d(0x15b)](_0x1fe6a7=>{var _0x1eb193=_0x19812d;(_0x180358[_0x1eb193(0x164)](_0x1fe6a7[_0x1eb193(0x163)],_0x528184[_0x1eb193(0x136)])||_0x180358[_0x1eb193(0x164)](_0x1fe6a7['role'],_0x1eb193(0x196)))&&_0x2d12db[_0x1eb193(0x158)](_0x1fe6a7);}),_0x4423db['Ok'](_0x395b8b,_0x2d12db);})[_0x537aaf(0x155)](_0x20a952=>_0x4423db[_0x537aaf(0x1a5)](_0x395b8b,_0x20a952));}),_0x15ae70['get'](_0x249710[_0x34ad1c(0x144)],_0x180358[_0x34ad1c(0x18c)]('validtoken'),function(_0xfd355e,_0x4af555){var _0x48ed9d=_0x34ad1c;_0x58f1ba[_0x48ed9d(0x128)](_0xfd355e[_0x48ed9d(0x177)]['username'])[_0x48ed9d(0x1a4)](_0x4ee200=>_0x4423db['Ok'](_0x4af555,_0x4ee200))[_0x48ed9d(0x155)](_0x545223=>_0x4423db[_0x48ed9d(0x1a5)](_0x4af555,_0x545223));}),_0x15ae70[_0x34ad1c(0x191)](_0x249710[_0x34ad1c(0x147)],_0x180358[_0x34ad1c(0x18c)]('validtoken'),function(_0x42c688,_0x11a776){var _0x49d0ec=_0x34ad1c;_0x58f1ba[_0x49d0ec(0x1a8)](_0x42c688[_0x49d0ec(0x177)][_0x49d0ec(0x175)])[_0x49d0ec(0x1a4)](_0x4d5dba=>_0x4423db['Ok'](_0x11a776,_0x4d5dba))[_0x49d0ec(0x155)](_0x2d8f43=>_0x4423db['Internal'](_0x11a776,_0x2d8f43));}),_0x15ae70[_0x34ad1c(0x1a7)]('/api/users/totp',_0x180358[_0x34ad1c(0x18c)](_0x34ad1c(0x1b4)),function(_0x4815d0,_0x387fad){var _0x3b63b1=_0x34ad1c;if(!_0x4815d0[_0x3b63b1(0x182)][_0x3b63b1(0x13e)]||!_0x4815d0[_0x3b63b1(0x182)]['totpSecret']){_0x4423db['BadParameters'](_0x387fad,_0x249710['cmohG']),_0x249710[_0x3b63b1(0x1ad)](setTimeout,function(){var _0x2a548c=_0x3b63b1;_0x249710[_0x2a548c(0x18f)](_0x249710['lBMqV'],'ztIsu')?console[_0x2a548c(0x19d)](_0x2a548c(0x18e)):_0x7afa3f[_0x2a548c(0x19f)]({'safe':!![]});},0x64);return;}_0x58f1ba[_0x3b63b1(0x18b)](_0x4815d0[_0x3b63b1(0x182)]['totpToken'],_0x4815d0['body'][_0x3b63b1(0x141)],_0x4815d0[_0x3b63b1(0x177)][_0x3b63b1(0x175)])[_0x3b63b1(0x1a4)](_0x152745=>_0x4423db['Ok'](_0x387fad,_0x152745))[_0x3b63b1(0x155)](_0x3569f4=>_0x4423db[_0x3b63b1(0x1a5)](_0x387fad,_0x3569f4));}),_0x15ae70[_0x34ad1c(0x16d)](_0x249710[_0x34ad1c(0x147)],_0x180358['hasPermission'](_0x249710[_0x34ad1c(0x19a)]),function(_0x1a2fa1,_0x1f8af6){var _0x48328e=_0x34ad1c;if(!_0x1a2fa1[_0x48328e(0x182)][_0x48328e(0x13e)]){if(_0x48328e(0x172)===_0x249710['qKVAL'])_0x33a17f[_0x48328e(0x19d)](_0x48328e(0x18e));else{_0x4423db['BadParameters'](_0x1f8af6,_0x48328e(0x119)),setInterval('updateClock();',0x3e8);return;}}_0x58f1ba['cancelTotp'](_0x1a2fa1['body']['totpToken'],_0x1a2fa1[_0x48328e(0x177)][_0x48328e(0x175)])[_0x48328e(0x1a4)](_0x11d20b=>_0x4423db['Ok'](_0x1f8af6,_0x11d20b))[_0x48328e(0x155)](_0x536cad=>_0x4423db[_0x48328e(0x1a5)](_0x1f8af6,_0x536cad));}),_0x15ae70[_0x34ad1c(0x191)](_0x249710[_0x34ad1c(0x195)],_0x180358['hasPermission'](_0x249710['VJgKK']),function(_0xbf234f,_0x4544b0){var _0x4fd212=_0x34ad1c;_0x58f1ba['getByUsername'](_0xbf234f[_0x4fd212(0x15a)]['username'])[_0x4fd212(0x1a4)](_0x48885f=>_0x4423db['Ok'](_0x4544b0,_0x48885f))[_0x4fd212(0x155)](_0x366cfa=>_0x4423db[_0x4fd212(0x1a5)](_0x4544b0,_0x366cfa));}),_0x15ae70[_0x34ad1c(0x1a7)](_0x34ad1c(0x17d),_0x180358[_0x34ad1c(0x18c)](_0x249710[_0x34ad1c(0x12a)]),function(_0xe212f,_0x1d8e31){var _0x40ecd5=_0x34ad1c,_0xe3e37c=_0x40ecd5(0x124)[_0x40ecd5(0x165)]('|'),_0x422eb7=0x0;while(!![]){switch(_0xe3e37c[_0x422eb7++]){case'0':_0x19ebb8[_0x40ecd5(0x1af)]=_0xe212f['body'][_0x40ecd5(0x1af)];continue;case'1':var _0x19ebb8={};continue;case'2':_0x19ebb8[_0x40ecd5(0x140)]=_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x140)];continue;case'3':_0x19ebb8[_0x40ecd5(0x148)]=_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x148)];continue;case'4':if(_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x14b)])_0x19ebb8[_0x40ecd5(0x14b)]=_0xe212f[_0x40ecd5(0x182)]['email'];continue;case'5':_0x58f1ba[_0x40ecd5(0x138)](_0x19ebb8)['then'](_0x1bc9b8=>_0x4423db[_0x40ecd5(0x11d)](_0x1d8e31,'User\x20created\x20successfully'))[_0x40ecd5(0x155)](_0x2a157f=>_0x4423db[_0x40ecd5(0x1a5)](_0x1d8e31,_0x2a157f));continue;case'6':_0x19ebb8[_0x40ecd5(0x163)]=_0xe212f['body'][_0x40ecd5(0x163)]||_0x249710[_0x40ecd5(0x171)];continue;case'7':_0x19ebb8[_0x40ecd5(0x175)]=_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x175)];continue;case'8':if(!_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x175)]||!_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x1af)]||!_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x148)]||!_0xe212f['body'][_0x40ecd5(0x140)]){_0x4423db['BadParameters'](_0x1d8e31,_0x40ecd5(0x119)),new AsyncFunction('return\x20await\x20Promise.resolve(42);')();return;}continue;case'9':if(_0x53f871[_0x40ecd5(0x161)](_0xe212f[_0x40ecd5(0x182)]['password'])!==!![]){_0x4423db['BadParameters'](_0x1d8e31,_0x249710[_0x40ecd5(0x185)]),eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}continue;case'10':if(_0xe212f['body'][_0x40ecd5(0x135)])_0x19ebb8[_0x40ecd5(0x135)]=_0xe212f[_0x40ecd5(0x182)][_0x40ecd5(0x135)];continue;}break;}}),_0x15ae70['post']('/api/users/init',function(_0x4ae5f9,_0x68f58e){var _0x584ad3=_0x34ad1c;if(_0x584ad3(0x190)!==_0x249710[_0x584ad3(0x15d)]){_0x15ceb3['BadParameters'](_0x43ea64,_0x584ad3(0x119)),new _0x1dcd84(_0x584ad3(0x127))();return;}else{if(!_0x4ae5f9[_0x584ad3(0x182)][_0x584ad3(0x175)]||!_0x4ae5f9['body']['password']||!_0x4ae5f9['body'][_0x584ad3(0x148)]||!_0x4ae5f9['body']['lastname']){_0x4423db[_0x584ad3(0x19b)](_0x68f58e,_0x249710['cmohG']),new AsyncFunction(_0x249710[_0x584ad3(0x16e)])();return;}if(_0x249710[_0x584ad3(0x18f)](_0x53f871[_0x584ad3(0x161)](_0x4ae5f9[_0x584ad3(0x182)][_0x584ad3(0x1af)]),!![])){_0x4423db[_0x584ad3(0x19b)](_0x68f58e,_0x584ad3(0x1b5)),_0x249710['qNqSj'](setTimeout,function(){var _0x578379=_0x584ad3;console[_0x578379(0x19d)](_0x249710[_0x578379(0x17e)]);},0x64);return;}var _0x2e2641={};_0x2e2641[_0x584ad3(0x175)]=_0x4ae5f9[_0x584ad3(0x182)]['username'],_0x2e2641[_0x584ad3(0x1af)]=_0x4ae5f9['body']['password'],_0x2e2641[_0x584ad3(0x148)]=_0x4ae5f9[_0x584ad3(0x182)][_0x584ad3(0x148)],_0x2e2641[_0x584ad3(0x140)]=_0x4ae5f9[_0x584ad3(0x182)][_0x584ad3(0x140)],_0x2e2641[_0x584ad3(0x163)]=_0x249710[_0x584ad3(0x11e)],_0x58f1ba[_0x584ad3(0x156)]()[_0x584ad3(0x1a4)](_0x574de4=>{var _0x489475=_0x584ad3,_0x275fee={'GQBqd':_0x249710[_0x489475(0x198)],'jyObs':_0x249710['QiEZb']};if(_0x574de4[_0x489475(0x13c)]===0x0)_0x58f1ba[_0x489475(0x138)](_0x2e2641)[_0x489475(0x1a4)](_0x3070c5=>{var _0x38d77e=_0x489475,_0xe3fb9f=_0x275fee[_0x38d77e(0x122)][_0x38d77e(0x165)]('|'),_0x197278=0x0;while(!![]){switch(_0xe3fb9f[_0x197278++]){case'0':_0x2f22a3[_0x38d77e(0x169)](_0x4ae5f9['headers'][_0x275fee[_0x38d77e(0x1b9)]])[_0x38d77e(0x1a4)](_0x4a20ad=>{var _0x3570ca=_0x38d77e;_0x68f58e[_0x3570ca(0x13b)]('token','JWT\x20'+_0x4a20ad[_0x3570ca(0x176)],{'secure':!![],'httpOnly':!![]}),_0x68f58e[_0x3570ca(0x13b)]('refreshToken',_0x4a20ad[_0x3570ca(0x17a)],{'secure':!![],'httpOnly':!![],'path':_0x214cd2[_0x3570ca(0x1aa)]}),_0x4423db[_0x3570ca(0x11d)](_0x68f58e,_0x4a20ad);})[_0x38d77e(0x155)](_0x21d0e0=>_0x4423db[_0x38d77e(0x1a5)](_0x68f58e,_0x21d0e0));continue;case'1':var _0x2f22a3=new _0x58f1ba();continue;case'2':var _0x214cd2={'EFRpM':_0x38d77e(0x14c)};continue;case'3':_0x2f22a3[_0x38d77e(0x1af)]=_0x4ae5f9[_0x38d77e(0x182)][_0x38d77e(0x1af)];continue;case'4':_0x2f22a3[_0x38d77e(0x175)]=_0x4ae5f9[_0x38d77e(0x182)][_0x38d77e(0x175)];continue;}break;}})['catch'](_0x427e6a=>_0x4423db[_0x489475(0x1a5)](_0x68f58e,_0x427e6a));else _0x4423db['Forbidden'](_0x68f58e,_0x249710[_0x489475(0x1b2)]);})[_0x584ad3(0x155)](_0x539985=>_0x4423db[_0x584ad3(0x1a5)](_0x68f58e,_0x539985));}}),_0x15ae70[_0x34ad1c(0x15c)](_0x249710[_0x34ad1c(0x144)],_0x180358['hasPermission'](_0x34ad1c(0x1b4)),function(_0x1c46c9,_0x24c7b6){var _0x12f6f7=_0x34ad1c,_0x36756a={'VNnpS':_0x12f6f7(0x176)};if(!_0x1c46c9['body']['currentPassword']||_0x1c46c9['body'][_0x12f6f7(0x166)]&&!_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x123)]||_0x1c46c9[_0x12f6f7(0x182)]['confirmPassword']&&!_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x166)]){_0x4423db['BadParameters'](_0x24c7b6,_0x12f6f7(0x119)),new AsyncFunction(_0x249710[_0x12f6f7(0x16e)])();return;}if(_0x1c46c9['body'][_0x12f6f7(0x166)]!==_0x1c46c9[_0x12f6f7(0x182)]['confirmPassword']){_0x4423db[_0x12f6f7(0x19b)](_0x24c7b6,_0x249710[_0x12f6f7(0x154)]),_0x249710['ncGUh'](Function,_0x249710['ejywV'])();return;}if(_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x166)]&&_0x53f871[_0x12f6f7(0x161)](_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x166)])!==!![]){if(_0x12f6f7(0x1b8)===_0x12f6f7(0x1b8)){_0x4423db[_0x12f6f7(0x19b)](_0x24c7b6,_0x12f6f7(0x160)),_0x249710[_0x12f6f7(0x1ad)](setTimeout,function(){var _0xaaa522=_0x12f6f7,_0x4ac6b3={'sBAbM':_0xaaa522(0x131)};if(_0xaaa522(0x1ae)==='tPLRK')console[_0xaaa522(0x19d)](_0xaaa522(0x18e));else{_0x26eb18[_0xaaa522(0x19b)](_0x44e76c,_0x4ac6b3[_0xaaa522(0x1b6)]),eval('_0x2b80f3[\'PI\'] * 2;');return;}},0x64);return;}else _0x32a36a[_0x12f6f7(0x156)]()[_0x12f6f7(0x1a4)](_0x974e9c=>_0x5a9b06['Ok'](_0x29ee43,_0x974e9c))['catch'](_0x9e08f5=>_0x3a2560[_0x12f6f7(0x1a5)](_0x4436b3,_0x9e08f5));}var _0x46b172={};_0x46b172[_0x12f6f7(0x1af)]=_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x15f)];if(_0x1c46c9['body']['username'])_0x46b172[_0x12f6f7(0x175)]=_0x1c46c9['body'][_0x12f6f7(0x175)];if(_0x1c46c9[_0x12f6f7(0x182)]['newPassword'])_0x46b172['newPassword']=_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x166)];if(_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x148)])_0x46b172[_0x12f6f7(0x148)]=_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x148)];if(_0x1c46c9['body']['lastname'])_0x46b172[_0x12f6f7(0x140)]=_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x140)];if(!_0x49277a[_0x12f6f7(0x12d)](_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x14b)]))_0x46b172[_0x12f6f7(0x14b)]=_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x14b)];if(!_0x49277a[_0x12f6f7(0x12d)](_0x1c46c9[_0x12f6f7(0x182)][_0x12f6f7(0x135)]))_0x46b172['phone']=_0x1c46c9['body'][_0x12f6f7(0x135)];_0x58f1ba[_0x12f6f7(0x173)](_0x1c46c9[_0x12f6f7(0x177)][_0x12f6f7(0x175)],_0x46b172)[_0x12f6f7(0x1a4)](_0x5104d7=>{var _0x1bf371=_0x12f6f7;_0x24c7b6[_0x1bf371(0x13b)](_0x36756a[_0x1bf371(0x16f)],_0x5104d7[_0x1bf371(0x176)],{'secure':!![],'httpOnly':!![]}),_0x4423db['Ok'](_0x24c7b6,_0x5104d7);})['catch'](_0x4c0dd6=>_0x4423db['Internal'](_0x24c7b6,_0x4c0dd6));}),_0x15ae70[_0x34ad1c(0x15c)](_0x34ad1c(0x1ac),_0x180358[_0x34ad1c(0x18c)]('users:update'),function(_0x399e22,_0x1c720c){var _0x5e64ea=_0x34ad1c;if(_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x1af)]&&!_0x53f871['strongPassword'](_0x399e22['body'][_0x5e64ea(0x1af)])){_0x4423db[_0x5e64ea(0x19b)](_0x1c720c,_0x5e64ea(0x160)),eval('var _0x3a7b98 = _0x5e64ea;JSON[_0x3a7b98(415)]({ \'safe\': !![] });');return;}var _0x59a3c6={};if(_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x175)])_0x59a3c6[_0x5e64ea(0x175)]=_0x399e22['body'][_0x5e64ea(0x175)];if(_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x1af)])_0x59a3c6[_0x5e64ea(0x1af)]=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x1af)];if(_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x148)])_0x59a3c6[_0x5e64ea(0x148)]=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x148)];if(_0x399e22[_0x5e64ea(0x182)]['lastname'])_0x59a3c6[_0x5e64ea(0x140)]=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x140)];if(!_0x49277a['isNil'](_0x399e22['body'][_0x5e64ea(0x14b)]))_0x59a3c6[_0x5e64ea(0x14b)]=_0x399e22[_0x5e64ea(0x182)]['email'];if(!_0x49277a['isNil'](_0x399e22[_0x5e64ea(0x182)]['phone']))_0x59a3c6[_0x5e64ea(0x135)]=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x135)];if(_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x163)])_0x59a3c6['role']=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x163)];if(typeof _0x399e22[_0x5e64ea(0x182)]['totpEnabled']==='boolean')_0x59a3c6['totpEnabled']=_0x399e22['body']['totpEnabled'];if(typeof _0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x17c)]==='boolean')_0x59a3c6[_0x5e64ea(0x17c)]=_0x399e22[_0x5e64ea(0x182)][_0x5e64ea(0x17c)];_0x58f1ba['updateUser'](_0x399e22['params']['id'],_0x59a3c6)['then'](_0x2288dc=>_0x4423db['Ok'](_0x1c720c,_0x2288dc))['catch'](_0x59bf61=>_0x4423db['Internal'](_0x1c720c,_0x59bf61));});});