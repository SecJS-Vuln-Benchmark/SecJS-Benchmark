'use strict';const _0x9fd1c1=_0x3ed3;function _0x1eb2(){const _0x4935d1=['relaxedHeaders','from','From:\x20andris@node.ee','2fctiPc','b:Y\x20Z\x0d\x0ad:X\x0d\x0a','WKnlX','message-id','NQtjp','should\x20create\x20relaxed\x20headers','sha256','To:andris@kreata.ee','12RyZIMm','a:c','node.ee','nXJZV','ThAUl','kRHfV','553qCRJWl','5537637ONFoBs','vMAgO','chai','uTKER','should\x20sign\x20headers\x20for\x20unicode\x20domain','Message-ID:\x20<testkiri@kreata.ee>','../../lib/dkim/sign','6878350QmxsAj','deep','a:b','12414PeadfA','jzVAr','C:\x20X','tdXrT','aywqs','config','should\x20sign\x20headers','dMQDg','A:\x20X','DKIM\x20Sign\x20Tests','müriaad-polüteism.info','message-id:references','wJEZk','157671IFMqJE','tHcgj','DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=node.ee;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=pVd+Dp+EjmYBcc1AWlBAP4ESpuAJ2WMS4gbxWLoeUZ1vZRodVN7K9UXvcCsLuqjJktCZMN2+8dyEUaYW2VIcxg4sVBCS1wqB/tqYZ/gxXLnG2/nZf4fyD2vxltJP4pDL','703592BXDjJD','expect','a:b:c:d','ZgCwe','should\x20skip\x20specific\x20headers','IJxsw','replace','454749BEIIVU','1144765UeJYfj','vncCd','equal','BNJqy','B:\x20Y\x09\x0d\x0a\x09Z\x20\x20'];_0x1eb2=function(){return _0x4935d1;};return _0x1eb2();}(function(_0x502931,_0x1b702a){const _0x598458=_0x3ed3,_0xc0a45c=_0x502931();while(!![]){try{const _0x3b2285=parseInt(_0x598458(0x20d))/0x1*(-parseInt(_0x598458(0x1e7))/0x2)+parseInt(_0x598458(0x217))/0x3+parseInt(_0x598458(0x1ef))/0x4*(parseInt(_0x598458(0x1df))/0x5)+parseInt(_0x598458(0x200))/0x6*(-parseInt(_0x598458(0x1f5))/0x7)+-parseInt(_0x598458(0x210))/0x8+parseInt(_0x598458(0x1f6))/0x9+-parseInt(_0x598458(0x1fd))/0xa;if(_0x3b2285===_0x1b702a)break;else _0xc0a45c['push'](_0xc0a45c['shift']());}catch(_0x7013fd){_0xc0a45c['push'](_0xc0a45c['shift']());}}}(_0x1eb2,0x571dd));const chai=require(_0x9fd1c1(0x1f8)),expect=chai[_0x9fd1c1(0x211)];let sign=require(_0x9fd1c1(0x1fc));function _0x3ed3(_0x3198fb,_0x10aff0){const _0x1eb243=_0x1eb2();return _0x3ed3=function(_0x3ed3f5,_0x74d30e){_0x3ed3f5=_0x3ed3f5-0x1df;let _0x38af85=_0x1eb243[_0x3ed3f5];return _0x38af85;},_0x3ed3(_0x3198fb,_0x10aff0);}chai[_0x9fd1c1(0x205)]['includeStack']=!![];const privateKey='-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIIBywIBAAJhANCx7ncKUfQ8wBUYmMqq6ky8rBB0NL8knBf3+uA7q/CSxpX6sQ8N\x0adFNtEeEd7gu7BWEM7+PkO1P0M78eZOvVmput8BP9R44ARpgHY4V0qSCdUt4rD32n\x0awfjlGbh8p5ua5wIDAQABAmAm+uUQpQPTu7kg95wqVqw2sxLsa9giT6M8MtxQH7Uo\x0a1TF0eAO0TQ4KOxgY1S9OT5sGPVKnag258m3qX7o5imawcuyStb68DQgAUg6xv7Af\x0aAqAEDfYN5HW6xK+X81jfOUECMQDr7XAS4PERATvgb1B3vRu5UEbuXcenHDYgdoyT\x0a3qJFViTbep4qeaflF0uF9eFveMcCMQDic10rJ8fopGD7/a45O4VJb0+lRXVdqZxJ\x0aQzAp+zVKWqDqPfX7L93SQLzOGhdd7OECMQDeQyD7WBkjSQNMy/GF7I1qxrscIxNN\x0aVqGTcbu8Lti285Hjhx/sqhHHHGwU9vB7oM8CMQDKTS3Kw/s/xrot5O+kiZwFgr+w\x0acmDrj/7jJHb+ykFNb7GaEkiSYqzUjKkfpweBDYECMFJUyzuuFJAjq3BXmGJlyykQ\x0aTweUw+zMVdSXjO+FCPcYNi6CP1t1KoESzGKBVoqA/g==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----';describe(_0x9fd1c1(0x209),function(){const _0x201f3c=_0x9fd1c1,_0x18fd1e={'wJEZk':function(_0x2a78d4,_0x343586){return _0x2a78d4(_0x343586);},'tHcgj':_0x201f3c(0x212),'kRHfV':'a:X\x0d\x0ab:Y\x20Z\x0d\x0a','WKnlX':_0x201f3c(0x1ff),'aywqs':'A:\x20X','ZgCwe':_0x201f3c(0x1f0),'dMQDg':'from','vMAgO':_0x201f3c(0x1ee),'ThAUl':_0x201f3c(0x1ea),'uTKER':function(_0x37d269,_0x25d025,_0x179a27,_0x40e01f,_0x354829){return _0x37d269(_0x25d025,_0x179a27,_0x40e01f,_0x354829);},'NQtjp':_0x201f3c(0x1ed),'tdXrT':_0x201f3c(0x1f1),'jzVAr':_0x201f3c(0x20f),'BNJqy':'z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=','xqfTK':function(_0x5933a0,_0x2adb4a){return _0x5933a0(_0x2adb4a);},'vncCd':'DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=xn--mriaad-polteism-zvbj.info;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=oBJ1MkwEkftfXa2AK4Expjp2xgIcAR43SVrftSEHVQ6F1SlGjP3EKP+cn/hLkhUel3rY0icthk/myDu6uhTBmM6DMtzIBW/7uQd6q9hfgaiYnw5Iew2tZc4TzBEYSdKi','nXJZV':function(_0x12d3f8,_0x274ab3,_0x3db44a){return _0x12d3f8(_0x274ab3,_0x3db44a);},'IJxsw':_0x201f3c(0x214)};it(_0x201f3c(0x1ec),function(){const _0x1096c4=_0x201f3c;let _0x10c63f=[{'key':'a','line':_0x1096c4(0x208)},{'key':'b','line':_0x1096c4(0x1e3)}];_0x18fd1e[_0x1096c4(0x20c)](expect,sign[_0x1096c4(0x1e4)](_0x10c63f,_0x18fd1e[_0x1096c4(0x20e)]))['to'][_0x1096c4(0x1fe)][_0x1096c4(0x1e1)]({'headers':_0x18fd1e[_0x1096c4(0x1f4)],'fieldNames':_0x18fd1e[_0x1096c4(0x1e9)]});}),_0x18fd1e[_0x201f3c(0x1f2)](it,_0x18fd1e[_0x201f3c(0x215)],function(){const _0x40d6b8=_0x201f3c;let _0x15a019=[{'key':'a','line':_0x18fd1e[_0x40d6b8(0x204)]},{'key':'b','line':'B:\x20Y\x09\x0d\x0a\x09Z\x20\x20'},{'key':'c','line':_0x40d6b8(0x202)},{'key':'d','line':'D:\x20X'}];expect(sign['relaxedHeaders'](_0x15a019,_0x18fd1e[_0x40d6b8(0x20e)],_0x18fd1e[_0x40d6b8(0x213)]))['to'][_0x40d6b8(0x1fe)][_0x40d6b8(0x1e1)]({'headers':_0x40d6b8(0x1e8),'fieldNames':'b:d'});}),_0x18fd1e[_0x201f3c(0x1f2)](it,_0x201f3c(0x206),function(){const _0x1ed54f=_0x201f3c;let _0x4bf3cc=[{'key':_0x18fd1e[_0x1ed54f(0x207)],'line':_0x1ed54f(0x1e6)},{'key':'to','line':_0x18fd1e['vMAgO']},{'key':_0x18fd1e[_0x1ed54f(0x1f3)],'line':_0x1ed54f(0x1fb)}],_0x3ddc08=_0x18fd1e[_0x1ed54f(0x1f9)](sign,_0x4bf3cc,_0x18fd1e[_0x1ed54f(0x1eb)],'z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=',{'skipFields':_0x1ed54f(0x20b),'domainName':_0x18fd1e[_0x1ed54f(0x203)],'keySelector':'dkim','privateKey':privateKey});expect(_0x3ddc08['replace'](/\r?\n\s*/g,'')['replace'](/\s+/g,''))['to'][_0x1ed54f(0x1e1)](_0x18fd1e[_0x1ed54f(0x201)]);}),it(_0x201f3c(0x1fa),function(){const _0x486287=_0x201f3c;let _0x321cca=[{'key':_0x486287(0x1e5),'line':'From:\x20andris@node.ee'},{'key':'to','line':_0x18fd1e[_0x486287(0x1f7)]}],_0x13d5f7=sign(_0x321cca,_0x486287(0x1ed),_0x18fd1e[_0x486287(0x1e2)],{'domainName':_0x486287(0x20a),'keySelector':'dkim','privateKey':privateKey});_0x18fd1e['xqfTK'](expect,_0x13d5f7[_0x486287(0x216)](/\r?\n\s*/g,'')[_0x486287(0x216)](/\s+/g,''))['to'][_0x486287(0x1e1)](_0x18fd1e[_0x486287(0x1e0)]);});});