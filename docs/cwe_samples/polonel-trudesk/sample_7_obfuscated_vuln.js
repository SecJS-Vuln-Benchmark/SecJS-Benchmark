const _0x1a86d4=_0x5863;function _0x5863(_0x3fc038,_0x451033){const _0x28c94b=_0x28c9();return _0x5863=function(_0x586322,_0x1a1d12){_0x586322=_0x586322-0x1ec;let _0x17192f=_0x28c94b[_0x586322];return _0x17192f;},_0x5863(_0x3fc038,_0x451033);}function _0x28c9(){const _0x21572e=['NAwPS','get','timestamp','convertTimestampToBigEndian','text','enableInsecureAuth','zcfoD','XEGqM','Failed\x20to\x20fetch\x20certificate:\x20','validateAuthData','jyqVt','xkwzw','validateOptions','push','\x20is\x20missing.','882XzJXcU','loadingPromise','16152sEBoKA','verifySignature','2|0|3|4|1','binary','4|3|0|1|2','fetchCertificate','loadCertificate','bundleId\x20is\x20required\x20for\x20secure\x20auth.','base64','alloc','cache','KKkmB','iQppo','rootCertificateUrl','test','getAppleCertificate','https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','1252056GJDAcf','content-type','content-length','OVuqw','url','Error','includes','jmmsy','from','split','LZwBr','certificateFromAsn1','OBJECT_NOT_FOUND','update','fromDer','headers','uNgCf','GTaSb','cache-control','56IGedri','2smfzPY','verifyPublicKeyUrl','173040Pjrztc','ywipm','577881Rohtor','AuthData\x20','application/x-pem-file','700326IvAAvz','bundleId','verifyPublicKeyIssuer','7654560EGjVWH','cert','Invalid\x20rootCertificateURL.','kVPnf','createVerify','125610THVTfB','Invalid\x20publicKeyUrl:\x20','utf8','rffHg','sha256','Invalid\x20signature.','certificateToPem','ZEPEU','certificateFromPem','arrayBuffer','GDvcd','spMtf','signature','Wtaxj'];_0x28c9=function(){return _0x21572e;};return _0x28c9();}(function(_0x236818,_0x291763){const _0x3016ac=_0x5863,_0x5b8de6=_0x236818();while(!![]){try{const _0x4d7811=parseInt(_0x3016ac(0x239))/0x1+parseInt(_0x3016ac(0x235))/0x2*(parseInt(_0x3016ac(0x221))/0x3)+-parseInt(_0x3016ac(0x234))/0x4*(-parseInt(_0x3016ac(0x1f1))/0x5)+-parseInt(_0x3016ac(0x23c))/0x6+parseInt(_0x3016ac(0x237))/0x7+parseInt(_0x3016ac(0x210))/0x8*(-parseInt(_0x3016ac(0x20e))/0x9)+-parseInt(_0x3016ac(0x1ec))/0xa;if(_0x4d7811===_0x291763)break;else _0x5b8de6['push'](_0x5b8de6['shift']());}catch(_0x2231d4){_0x5b8de6['push'](_0x5b8de6['shift']());}}}(_0x28c9,0x47326));import _0x136bcd from'crypto';import{asn1,pki}from'node-forge';import _0x5a2b78 from'./AuthAdapter';class GameCenterAuth extends _0x5a2b78{constructor(){const _0x3ae7ef=_0x5863;super(),this['ca']={'cert':null,'url':null},this[_0x3ae7ef(0x21a)]={},this[_0x3ae7ef(0x23d)]='';}[_0x1a86d4(0x20b)](_0xce79f9){const _0x494ebb=_0x1a86d4,_0x30fbce={'VASVP':'bundleId\x20is\x20required\x20for\x20secure\x20auth.','LZwBr':'Game\x20center\x20auth\x20options\x20are\x20required.'},_0x76fdc8=_0x494ebb(0x212)[_0x494ebb(0x22a)]('|');let _0x2bd181=0x0;while(!![]){switch(_0x76fdc8[_0x2bd181++]){case'0':!this[_0x494ebb(0x20f)]&&(this['loadingPromise']=this[_0x494ebb(0x216)](_0xce79f9));continue;case'1':if(!this[_0x494ebb(0x204)]&&!this[_0x494ebb(0x23d)])throw new Error(_0x30fbce['VASVP']);continue;case'2':if(!_0xce79f9)throw new Error(_0x30fbce[_0x494ebb(0x22b)]);continue;case'3':this['enableInsecureAuth']=_0xce79f9[_0x494ebb(0x204)];continue;case'4':this[_0x494ebb(0x23d)]=_0xce79f9[_0x494ebb(0x23d)];continue;}break;}}async[_0x1a86d4(0x216)](_0x64152e){const _0x100d6a=_0x1a86d4,_0x22632c={'KKkmB':_0x100d6a(0x220),'xkwzw':_0x100d6a(0x23b),'mvTob':function(_0x292cd9,_0x2d992a){return _0x292cd9>_0x2d992a;},'uUqda':function(_0xdd12ba,_0x22409f,_0x309828){return _0xdd12ba(_0x22409f,_0x309828);},'ZEPEU':'content-length'},_0x1840d4=_0x64152e[_0x100d6a(0x21d)]||_0x22632c[_0x100d6a(0x21b)];if(this['ca'][_0x100d6a(0x225)]===_0x1840d4)return _0x1840d4;const {certificate:_0x302a01,headers:_0x14976b}=await this['fetchCertificate'](_0x1840d4);if(_0x14976b[_0x100d6a(0x200)](_0x100d6a(0x222))!==_0x22632c[_0x100d6a(0x20a)]||!_0x14976b[_0x100d6a(0x200)](_0x100d6a(0x223))||_0x22632c['mvTob'](_0x22632c['uUqda'](parseInt,_0x14976b[_0x100d6a(0x200)](_0x22632c[_0x100d6a(0x1f8)]),0xa),0x2710))throw new Parse[(_0x100d6a(0x226))](Parse[_0x100d6a(0x226)]['OBJECT_NOT_FOUND'],_0x100d6a(0x1ee));return this['ca']['cert']=pki[_0x100d6a(0x1f9)](_0x302a01),this['ca'][_0x100d6a(0x225)]=_0x1840d4,_0x1840d4;}['verifyPublicKeyUrl'](_0x4b2615){const _0x35da7e=_0x1a86d4,_0x57e17c=/^https:\/\/(?:[-_A-Za-z0-9]+\.){0,}apple\.com\/.*\.cer$/;return _0x57e17c[_0x35da7e(0x21e)](_0x4b2615);}async[_0x1a86d4(0x215)](_0x2f4cb6){const _0x30e7c9=_0x1a86d4,_0xcc05c9={'spMtf':function(_0x5ebc85,_0x2034f6){return _0x5ebc85(_0x2034f6);},'ywipm':_0x30e7c9(0x222)},_0x277c0f=await _0xcc05c9[_0x30e7c9(0x1fc)](fetch,_0x2f4cb6);if(!_0x277c0f['ok'])throw new Error(_0x30e7c9(0x207)+_0x2f4cb6);const _0x256906=_0x277c0f[_0x30e7c9(0x230)][_0x30e7c9(0x200)](_0xcc05c9[_0x30e7c9(0x238)]),_0xd48938=_0x256906?.[_0x30e7c9(0x227)](_0x30e7c9(0x23b));if(_0xd48938){const _0x1dc854=await _0x277c0f[_0x30e7c9(0x203)]();return{'certificate':_0x1dc854,'headers':_0x277c0f[_0x30e7c9(0x230)]};}const _0x5cb8f6=await _0x277c0f[_0x30e7c9(0x1fa)](),_0x21665c=Buffer[_0x30e7c9(0x229)](_0x5cb8f6),_0x22078e=asn1[_0x30e7c9(0x22f)](_0x21665c['toString'](_0x30e7c9(0x213))),_0x4514d6=pki[_0x30e7c9(0x22c)](_0x22078e),_0x3f87b3=pki[_0x30e7c9(0x1f7)](_0x4514d6);return{'certificate':_0x3f87b3,'headers':_0x277c0f['headers']};}async[_0x1a86d4(0x21f)](_0x1ed20){const _0x30deae=_0x1a86d4,_0x492367={'UjXur':_0x30deae(0x233),'iQppo':function(_0x394e6f,_0x3f1d18,_0x4a1de2){return _0x394e6f(_0x3f1d18,_0x4a1de2);}};if(!this[_0x30deae(0x236)](_0x1ed20))throw new Parse['Error'](Parse[_0x30deae(0x226)][_0x30deae(0x22d)],_0x30deae(0x1f2)+_0x1ed20);if(this[_0x30deae(0x21a)][_0x1ed20])return this[_0x30deae(0x21a)][_0x1ed20];const {certificate:_0x2dc5a0,headers:_0xf47b65}=await this[_0x30deae(0x215)](_0x1ed20),_0x54adc6=_0xf47b65['get'](_0x492367['UjXur']),_0x5aa01b=_0x54adc6?.['match'](/max-age=([0-9]+)/);return this[_0x30deae(0x23e)](_0x2dc5a0,_0x1ed20),_0x5aa01b&&(this['cache'][_0x1ed20]=_0x2dc5a0,_0x492367[_0x30deae(0x21c)](setTimeout,()=>delete this['cache'][_0x1ed20],parseInt(_0x5aa01b[0x1],0xa)*0x3e8)),_0x2dc5a0;}[_0x1a86d4(0x23e)](_0x4cf518,_0x309e72){const _0x500f06=_0x1a86d4,_0x182f39={'XEGqM':'Game\x20center\x20auth\x20options\x20are\x20required.','rffHg':'Root\x20certificate\x20is\x20invalid\x20or\x20missing.','GDvcd':function(_0x23b925,_0x457a38){return _0x23b925!==_0x457a38;},'Wtaxj':_0x500f06(0x231),'NAwPS':'fljdA'},_0x27dbf0=pki[_0x500f06(0x1f9)](_0x4cf518);if(!this['ca'][_0x500f06(0x1ed)])throw new Parse[(_0x500f06(0x226))](Parse[_0x500f06(0x226)][_0x500f06(0x22d)],_0x182f39[_0x500f06(0x1f4)]);if(!this['ca'][_0x500f06(0x1ed)]['verify'](_0x27dbf0)){if(_0x182f39[_0x500f06(0x1fb)](_0x182f39[_0x500f06(0x1fe)],_0x182f39[_0x500f06(0x1ff)]))throw new Parse[(_0x500f06(0x226))](Parse[_0x500f06(0x226)][_0x500f06(0x22d)],_0x500f06(0x1f2)+_0x309e72);else{const _0x3d5dfd=_0x500f06(0x214)[_0x500f06(0x22a)]('|');let _0x12d813=0x0;while(!![]){switch(_0x3d5dfd[_0x12d813++]){case'0':this['enableInsecureAuth']=_0x53fe2a[_0x500f06(0x204)];continue;case'1':this[_0x500f06(0x23d)]=_0x3bb398['bundleId'];continue;case'2':if(!this[_0x500f06(0x204)]&&!this[_0x500f06(0x23d)])throw new _0x414303(_0x500f06(0x217));continue;case'3':!this[_0x500f06(0x20f)]&&(this[_0x500f06(0x20f)]=this[_0x500f06(0x216)](_0x274d57));continue;case'4':if(!_0x16a5dd)throw new _0xb563da(_0x182f39[_0x500f06(0x206)]);continue;}break;}}}}['verifySignature'](_0xc2442a,_0x44db21){const _0x1bc3c6=_0x1a86d4,_0x57250d={'kVPnf':_0x1bc3c6(0x1f5),'jyqVt':_0x1bc3c6(0x1f3),'OVuqw':_0x1bc3c6(0x218)},_0x1efde8=this[_0x1bc3c6(0x23d)]||this[_0x1bc3c6(0x204)]&&_0x44db21[_0x1bc3c6(0x23d)],_0x48d8a3=_0x136bcd[_0x1bc3c6(0x1f0)](_0x57250d[_0x1bc3c6(0x1ef)]);_0x48d8a3['update'](Buffer[_0x1bc3c6(0x229)](_0x44db21['id'],_0x57250d['jyqVt'])),_0x48d8a3['update'](Buffer[_0x1bc3c6(0x229)](_0x1efde8,_0x57250d[_0x1bc3c6(0x209)])),_0x48d8a3[_0x1bc3c6(0x22e)](this[_0x1bc3c6(0x202)](_0x44db21[_0x1bc3c6(0x201)])),_0x48d8a3[_0x1bc3c6(0x22e)](Buffer[_0x1bc3c6(0x229)](_0x44db21['salt'],_0x57250d[_0x1bc3c6(0x224)]));if(!_0x48d8a3['verify'](_0xc2442a,_0x44db21[_0x1bc3c6(0x1fd)],_0x57250d[_0x1bc3c6(0x224)]))throw new Parse[(_0x1bc3c6(0x226))](Parse[_0x1bc3c6(0x226)][_0x1bc3c6(0x22d)],_0x1bc3c6(0x1f6));}async[_0x1a86d4(0x208)](_0x27a486){const _0x5b92c9=_0x1a86d4,_0x244e4e={'VpyhL':'publicKeyUrl','GTaSb':_0x5b92c9(0x1fd),'zcfoD':'salt','tfxiz':_0x5b92c9(0x23d)},_0xb8fe83=['id',_0x244e4e['VpyhL'],'timestamp',_0x244e4e[_0x5b92c9(0x232)],_0x244e4e[_0x5b92c9(0x205)]];this[_0x5b92c9(0x204)]&&_0xb8fe83[_0x5b92c9(0x20c)](_0x244e4e['tfxiz']);for(const _0x186170 of _0xb8fe83){if(!_0x27a486[_0x186170])throw new Parse['Error'](Parse['Error'][_0x5b92c9(0x22d)],_0x5b92c9(0x23a)+_0x186170+_0x5b92c9(0x20d));}await this['loadingPromise'];const _0x20fdc4=await this[_0x5b92c9(0x21f)](_0x27a486['publicKeyUrl']);this[_0x5b92c9(0x211)](_0x20fdc4,_0x27a486);}[_0x1a86d4(0x202)](_0x38734e){const _0xd485af=_0x1a86d4,_0x29a994={'jmmsy':function(_0x530a40,_0x129485){return _0x530a40(_0x129485);}},_0x5ec516=Buffer[_0xd485af(0x219)](0x8);return _0x5ec516['writeBigUInt64BE'](_0x29a994[_0xd485af(0x228)](BigInt,_0x38734e)),_0x5ec516;}}export default new GameCenterAuth();