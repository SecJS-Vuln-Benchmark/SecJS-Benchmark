const _0x5e6db5=_0x1429;function _0xd1e4(){const _0xd5bb1c=['zpSSF','id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://www.facebook.com\x20|\x20from:\x20https://not.facebook.com','BVLbD','ExzNd','UhhWM','RfQWV','An\x20error\x20occurred','fail','VnywB','test','ZzsaF','hWTgr','https://not.apple.com','RafKB','(using\x20client\x20id\x20as\x20array)\x20should\x20verify\x20id_token\x20(facebook.com)','PSQPh','FzehP','nDkNL','PhantAuth\x20auth\x20is\x20invalid\x20for\x20this\x20user.','synchronizedExpiration','AuthenticationProviders','KUXSA','jLFfH','hADCc','validateAuthData\x20should\x20handle\x20authentication','BJXub','TmZqB','wZiQM','AzyHg','fetch','bdxHg','FdPkF','pNnta','User\x20should\x20not\x20be\x20linked\x20to\x20myoauth','ZPleU','provided\x20token\x20does\x20not\x20decode\x20as\x20JWT','GMuQZ','OKXjn','kmlyX','SnGOR','keycloak','should\x20support\x20loginWith\x20with\x20session\x20token\x20and\x20with/without\x20mutated\x20authData','function','_User','SphEW','createdAt','SlGiD','c194d902-e697-46c9-a303-82c2d914473c','../lib/Config','xgLhu','callFake','Should\x20have\x20used\x20the\x20subclass.','sometoken','args','KjELw','UzjCR','PYazr','qRlpU','usyKF','xDxte','custom','TWXkT','eebYf','jvHKL','WKsPy','future\x20logins\x20require\x20SMS\x20code','RoWvk','yUZTG','validateAuthData\x20should\x20fail\x20with\x20error\x20description','PiaKi','application/json','appsecret_proof','invalidID','PmdsU','adKFS','123','RUIqc','kid','PPhNl','a_different_user_id','XHZDT','Query','ujmMi','badtoken','myoauth','VLNfa','resolveTo','rMpSF','should\x20throw\x20error\x20with\x20missing\x20id_token','vkGOb','jqBeY','myUser2','hXoMh','Unable\x20to\x20find\x20matching\x20key\x20for\x20Key\x20ID:\x20','_Installation','unknown','User','bcnhi','HfdFF','nbTuS','now','VNiwT','lRcZm','getSessionToken','vVOlQ','FgiNt','(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20missing\x20id_token','loggedOut','sgaAw','INSERT\x20FACEBOOK\x20TOKEN\x20HERE','This\x20authentication\x20method\x20is\x20unsupported.','liKBM','wSvZg','sQdrk','yYvnv','(using\x20client\x20id\x20as\x20array\x20with\x20multiple\x20items)\x20should\x20verify\x20id_token\x20(apple.com)','should\x20handle\x20Facebook\x20appSecret\x20for\x20validating\x20auth\x20data','JOKMw','RrRcg','GQQOf','GqGRW','leoZp','wxsQO','aUpqe','Missing\x20keycloak\x20configuration','kzXdQ','ThQYg','dsTQs','ZsIzb','hQydj','ArtUu','Lfite','HKmCR','aTost','Facebook\x20auth\x20is\x20not\x20configured.','WNFpx','sARyg','SzMlQ','184gphGWF','GWpJJ','dTbJW','should\x20use\x20algorithm\x20from\x20key\x20header\x20to\x20verify\x20id_token\x20(apple.com)','error','gntuL','e3f16404-18e9-4a87-a555-4710cfbdac67','getHeaderFromToken','awaRk','XYoto','gXDYC','this\x20auth\x20is\x20already\x20used','JsHog','jnpkp','hIdYq','1858520TKCtgy','CHPRv','kkRor','kdrxL','JvjhR','new','ruESJ','enabled','ffZLL','KktLd','XygIc','Error','XdSos','sJTYG','XkmgQ','HILPd','XPRez','Pmgsm','LeKLl','OTP\x20SMS\x20auth\x20adatper','tWLif','alYRd','96YQlSqH','yolo','toEqual','updatedAt','SklzR','world','authData','should\x20only\x20create\x20a\x20single\x20user\x20with\x20REST\x20API','NzTOl','mkyNI','jinLD','noben','xIFlr','http://example.com','id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com','../lib/Adapters/Auth','hCeNR','logIn','kuLJZ','mfa','facebook\x20limited\x20auth\x20adapter','jHzBi','ApVXL','toHaveBeenCalledTimes','rUdWj','FLGnV','(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','_isLinked','TpJQO','oldmh','http://localhost:8378/1/login','mtiba','https://not.google.com','upzSj','ibAUJ','ezMAv','dwxTW','defaultColumns','mucvE','mRFWk','should\x20create\x20user\x20with\x20REST\x20API','grJQG','Hpokt','PJOov','validateAuthData\x20should\x20fail\x20with\x20invalid\x20auth','./spec/support/CustomAuthFunction.js','toBeUndefined','WRHGz','UisYo','jsonwebtoken','UiZbv','LzAax','DAJhG','validateAppId','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(google.com)','phSmN','wfSiF','Secret','XSsni','nYyYh','Sltsd','rEvBf','vKErc','qWYAW','uWQdF','kUtav','FgkWB','../lib/Adapters/Auth/apple','stringify','iwJjN','cHnoc','789','sFShH','properly\x20loads\x20custom\x20adapter','INSERT\x20CLIENT\x20ID\x20HERE','loadAuthAdapter','synchronizedUserId','OwfBi','_auth_data_myoauth','aIHhb','EhhEZ','xoGbU','CVwjU','disabled','validateAuthData','customAuthentication','BWdje','3416340ypVcyG','hosting_error','GzfpG','OBJECT_NOT_FOUND','mJvqC','uUTSx','bhvGS','WuSsj','SsFEE','validateAuthData\x20should\x20throw\x20for\x20invalid\x20auth','4bcb1a1a-11f8-4e12-a3f6-73f7e25e355a','phantauth','wSYdD','PrhIp','RcAEr','inLeW','kcoBA','mFlqG','aVCiT','TgmGR','JxZYO','and','sessionToken','ACL','QiBQq','MaGVR','data','INSERT\x20APPLE\x20TOKEN\x20HERE','tUaYk','INSERT\x20APPLE\x20TOKEN\x20HERE\x20WITH\x20INVALID\x20JWT\x20ISSUER','549c33a1-3a6b-4732-8cf6-8f010ad4569c','VioUf','cpcje','jwt\x20malformed','validateAuthData\x20should\x20fail\x20with\x20invalid\x20roles','toBe','toBeRejectedWith','LcwtB','bRyeC','apple\x20signin\x20auth\x20adapter','POST','header','rZOhd','fjJhR','PMlsN','UQRYl','mLXFP','gzwTs','AsJjm','YvOXt','Please\x20enter\x20the\x20token','mUFzZ','appIds\x20must\x20be\x20an\x20array.','pBasj','tqGon','abcd','uQTrO','KgIhE','LJCFV','logInWith','imlZh','uNieh','Gtxme','applicationId','token','Joqrd','path','FoLQo','TjfdP','240777LOgBad','shouldCancel','password','uppDk','google\x20auth\x20adapter','12345','custom\x20error\x20message','wCmaJ','NAoNo','Missing\x20additional\x20authData\x20mfa','_registerAuthenticationProvider','uIWfd','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20with\x20token\x20(apple.com)','246977OqgMOf','EgfXW','CzxYL','the_rsa_public_key','BMbCG','CIhBa','wyeKQ','Rdnab','Expiration\x20should\x20be\x20cleared','(using\x20client\x20id\x20as\x20array)\x20should\x20not\x20verify\x20invalid\x20id_token','VsZQj','should\x20throw\x20error\x20with\x20with\x20invalid\x20user\x20id\x20(apple.com)','KXDvd','ZxJjP','getValidatorForProvider','properly\x20loads\x20a\x20default\x20adapter\x20with\x20options','wTPXF','restoreAuthentication','QCizP','AneYN','vWwGk','prTwj','can\x20enroll','oiryo','mxOxw','../lib/Adapters/Auth/httpsRequest','should\x20throw\x20error\x20with\x20invalid\x20user\x20id','JoktM','ruOhv','CrEOE','NFdEy','JdTim','NHJCD','dIdau','https://www.facebook.com','the_token','Bawbd','fakeid','sort','UNSUPPORTED_SERVICE','Could\x20not\x20connect\x20to\x20the\x20authentication\x20server','group1','svyPW','qJBLo','EBNLs','KFxtP','future\x20logins\x20reject\x20incorrect\x20TOTP\x20token','kNMEx','WdpaC','NZQCZ','auth\x20data\x20is\x20invalid\x20for\x20this\x20user.','Tdmmo','AkxEv','future\x20logins\x20require\x20TOTP\x20token','sHgyP','BHkZv','base32','username','partially\x20enrolled\x20users\x20can\x20still\x20login','aqUDe','verify','eoHwQ','properly\x20loads\x20custom\x20adapter\x20module\x20object\x20(again)','using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(facebook.com)','SHA1','get','oRMbK','hNkeu','LEFfX','toBeDefined','OemWL','invalid\x20user','should\x20not\x20decode\x20invalid\x20id_token','PHtlc','secret\x20123','(using\x20client\x20id\x20as\x20array\x20with\x20multiple\x20items)\x20should\x20verify\x20id_token\x20(facebook.com)','OskGv','includes','qZfqC','toHaveBeenCalledWith','TtAnb','eooSj','188629MjZpsc','714588tUDWnD','FzGEe','cKkRw','RmTEa','yoFfT','INSERT\x20ID\x20HERE','toHaveBeenCalled','Hvuev','SIsHO','DZcHc','jwt\x20audience\x20invalid.\x20expected:\x20secret','LGxrY','zcEdz','Oilyf','Sxitl','OwtYz','should\x20handle\x20Facebook\x20appSecret\x20for\x20validating\x20appIds','ijnmY','olVpl','2|3|1|0|4','cQIdG','should\x20not\x20verify\x20invalid\x20id_token','fTujc','toBeNull','(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer','rjdCK','AHWBz','uxnRA','jpLjr','Invalid\x20MFA\x20token','imzcC','DaPSQ','LnAVE','2ctymcT','valid-token','phant\x20auth\x20adapter','../lib/request','KxwWB','recovery','my-token','IEtwS','XJCjB','pyDJa','WkXpp','reject','TOTP','HjoIZ','OTHER_CAUSE','../lib/Adapters/Auth/google','cpIuI','EZQTx','XrlKJ','CNLeX','IeGVD','should\x20fail\x20to\x20link\x20if\x20session\x20token\x20don\x27t\x20match\x20user','ANHSa','Expiration\x20should\x20have\x20a\x20value','length','AYkWA','can\x20disable\x20provider','keys','miSJg','secret','role1','unlink\x20and\x20link\x20with\x20custom\x20provider','PsnAs','njpbn','ixmWX','LbhnY','ivNPP','installationId','ulJTH','first','ipRfT','sendSMS','extend','getSigningKey','rStdg','invalid_client_id','ybhEY','aeMUS','generate','tvumZ','shouldError','GmYBr','myXGz','id\x20token\x20not\x20issued\x20by\x20correct\x20provider\x20-\x20expected:\x20accounts.google.com\x20or\x20https://accounts.google.com\x20|\x20from:\x20https://not.google.com','kLILg','validateAuthData\x20should\x20fail\x20without\x20user\x20id','HQwER','kFJtB','llydx','pending','cannot\x20change\x20OTP\x20with\x20invalid\x20token','logOut','uRkii','tcVao','FFzNK','BIHlq','hSSLZ','YuBZP','CKnrP','KAWZj','qAkpT','CmfSQ','should\x20throw\x20error\x20when\x20Facebook\x20request\x20appId\x20is\x20wrong\x20data\x20type','YaUBr','tZCPD','XoYTC','then','signUp','EYmMX','asyncProvider','oyoBT','Yqjgt','hNCVN','fakeToken','not','/realms/new/protocol/openid-connect/userinfo','current','should\x20not\x20fail\x20fetching\x20the\x20session','vUScq','pFkVQ','yBSnu','RS256','HNUAN','eiCAH','(using\x20client\x20id\x20as\x20string)\x20\x20with\x20token','zejpj','QeOeo','yfuAk','properly\x20loads\x20a\x20custom\x20adapter\x20with\x20options','RYQXq','TuXHM','OHQSD','reset','access_token','Qfqnb','dCiXd','should\x20support\x20sync/async\x20validateAppId','+11111111111','syncProvider','GsLrx','KvzRz','INSERT\x20FACEBOOK\x20TOKEN\x20HERE\x20WITH\x20INVALID\x20JWT\x20ISSUER','gnZbY','_linkWith','(using\x20client\x20id\x20as\x20array)\x20should\x20verify\x20id_token\x20(apple.com)','VZHSQ','SCRIPT_FAILED','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(apple.com)','PVeJu','http://localhost:8378/1/users','(using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(apple.com)','user1','Bearer\x20sometoken','7bfa55ab-8fd7-4526-992e-6de3df16bf9c','oqTsg','the_user_id','cvFzw','WqqUd','properly\x20loads\x20custom\x20adapter\x20module\x20object','objectId','SZfZz','success','synchronizedAuthToken','fuSQp','should\x20use\x20algorithm\x20from\x20key\x20header\x20to\x20verify\x20id_token\x20(facebook.com)','OGrzW','lCabX','pkhcL','User\x20should\x20be\x20linked\x20to\x20myoauth','(using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(google.com)','vyQBA','code','yTrYP','callThrough','wvjsD','https://appleid.apple.com','xVWob','ZXOfG','LthPm','request','database','save','authDataResponse','facebook','Pzrgw','_Default','expiration_date','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20missing\x20id_token','Invalid\x20authentication','uuatU','split','secret_sauce','catch','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','qWqME','GdFlf','message','oKQvB','Missing\x20access\x20token\x20and/or\x20User\x20id','uUEjm','gdDWJ','aLLDW','_logInWith','calls','ygQcM','1382595rQaibb','resolve','id\x20token\x20is\x20invalid\x20for\x20this\x20user.','jQktp','rest','gGdRs','Zavwk','hello','CduZy','mHmrI','BUaYh','fEGYE','dlttx'];_0xd1e4=function(){return _0xd5bb1c;};return _0xd1e4();}(function(_0x26a7c4,_0x411151){const _0x263b4f=_0x1429,_0x448d50=_0x26a7c4();while(!![]){try{const _0x51ce5f=-parseInt(_0x263b4f(0x282))/0x1*(parseInt(_0x263b4f(0x2f6))/0x2)+parseInt(_0x263b4f(0x2d5))/0x3+parseInt(_0x263b4f(0x1c3))/0x4+-parseInt(_0x263b4f(0x3a5))/0x5+-parseInt(_0x263b4f(0x1d9))/0x6*(-parseInt(_0x263b4f(0x2d4))/0x7)+parseInt(_0x263b4f(0x1b4))/0x8*(-parseInt(_0x263b4f(0x275))/0x9)+parseInt(_0x263b4f(0x230))/0xa;if(_0x51ce5f===_0x411151)break;else _0x448d50['push'](_0x448d50['shift']());}catch(_0xb620a8){_0x448d50['push'](_0x448d50['shift']());}}}(_0xd1e4,0x5239d));const request=require(_0x5e6db5(0x2f9)),Config=require(_0x5e6db5(0x3e2)),defaultColumns=require('../lib/Controllers/SchemaController')[_0x5e6db5(0x1fe)],authenticationLoader=require(_0x5e6db5(0x1e8)),path=require(_0x5e6db5(0x272));function _0x1429(_0x4bc166,_0x276010){const _0xd1e402=_0xd1e4();return _0x1429=function(_0x1429ae,_0xb78078){_0x1429ae=_0x1429ae-0x19e;let _0x52743c=_0xd1e402[_0x1429ae];return _0x52743c;},_0x1429(_0x4bc166,_0x276010);}describe(_0x5e6db5(0x3c6),function(){const _0x16c2aa=_0x5e6db5,_0x58f32d={'eooSj':function(_0x2608ff,_0x20261c){return _0x2608ff===_0x20261c;},'VLNfa':'pMIfH','uuatU':function(_0x4dab0f,_0x47dec4){return _0x4dab0f(_0x47dec4);},'WRHGz':_0x16c2aa(0x288),'gGdRs':function(_0x26e667,_0xc49f14){return _0x26e667(_0xc49f14);},'WePpR':_0x16c2aa(0x251),'aAPEn':_0x16c2aa(0x27a),'XkmgQ':function(_0x299961,_0x2afb4b,_0x36c99d){return _0x299961(_0x2afb4b,_0x36c99d);},'mGjpG':_0x16c2aa(0x3a9),'vkGOb':function(_0x20ad7c,_0x899053){return _0x20ad7c(_0x899053);},'tUaYk':function(_0x1699bf,_0x1de395){return _0x1699bf(_0x1de395);},'hBHxN':'jqBeY','cQIdG':function(_0x1f54a9,_0x21558a){return _0x1f54a9(_0x21558a);},'KjELw':_0x16c2aa(0x277),'ruOhv':_0x16c2aa(0x3c4),'Qfqnb':function(_0x54de88,_0x5d5f0d){return _0x54de88(_0x5d5f0d);},'mBpxf':'zlYfu','gyzQP':'fakeToken','kUtav':'fakeAuthProvider','mucvE':'validateAppId','SAZSm':_0x16c2aa(0x345),'VsZQj':_0x16c2aa(0x362),'TmZqB':function(_0x5ec9af,_0x5a822d){return _0x5ec9af(_0x5a822d);},'bRyeC':function(_0x34d35b,_0x9d8a43){return _0x34d35b(_0x9d8a43);},'pJTxS':function(_0x33b9ac){return _0x33b9ac();},'WqqUd':_0x16c2aa(0x406),'dCiXd':function(_0x2f0011,_0x1c2abd,_0x410cd6){return _0x2f0011(_0x1c2abd,_0x410cd6);},'vWwGk':function(_0x2c1035,_0x59c2ff){return _0x2c1035 instanceof _0x59c2ff;},'hIdYq':function(_0x4b16e1,_0x5a20d6,_0x5b9ccf){return _0x4b16e1(_0x5a20d6,_0x5b9ccf);},'mvpzZ':_0x16c2aa(0x380),'UiZbv':_0x16c2aa(0x3d3),'adKFS':'User\x20id\x20should\x20be\x20cleared','qmtdk':_0x16c2aa(0x28a),'qAkpT':function(_0x7d5826,_0x47a8ee){return _0x7d5826(_0x47a8ee);},'tvumZ':'User\x20id\x20should\x20have\x20a\x20value','uUTSx':function(_0x278cda,_0x5ea9a1,_0x2d6d84){return _0x278cda(_0x5ea9a1,_0x2d6d84);},'hQydj':_0x16c2aa(0x30d),'bhvGS':_0x16c2aa(0x3dc),'CHPRv':function(_0x1076f9,_0x44feaa){return _0x1076f9(_0x44feaa);},'yTrYP':function(_0x2314f4){return _0x2314f4();},'hADCc':_0x16c2aa(0x3ac),'kLILg':_0x16c2aa(0x1de),'XPRez':_0x16c2aa(0x22d),'oldmh':function(_0x17fc8f,_0x1eb966){return _0x17fc8f(_0x1eb966);},'nbTuS':function(_0x198fea){return _0x198fea();},'xwWdo':'./spec/support/CustomAuth.js','aeMUS':_0x16c2aa(0x2f7),'Rdnab':function(_0x3f16f6,_0x4b7f71,_0x12d22a,_0x51227d){return _0x3f16f6(_0x4b7f71,_0x12d22a,_0x51227d);},'njpbn':function(_0x1925cd,_0x123696){return _0x1925cd(_0x123696);},'cpIuI':function(_0x1dcf4a,_0x5c4382){return _0x1dcf4a(_0x5c4382);},'EBNLs':_0x16c2aa(0x29b),'PVeJu':_0x16c2aa(0x2c3),'JxZYO':_0x16c2aa(0x397),'YuBZP':_0x16c2aa(0x38f),'OHQSD':function(_0x1bf9bf,_0x3a446c){return _0x1bf9bf!==_0x3a446c;},'ybhEY':_0x16c2aa(0x228),'VnywB':_0x16c2aa(0x3bb),'VZHSQ':function(_0x75080,_0x5e43e7){return _0x75080(_0x5e43e7);},'ulJTH':'support/myoauth','qyfyB':_0x16c2aa(0x420),'YvOXt':_0x16c2aa(0x201),'eYNbG':_0x16c2aa(0x1e0),'jQktp':_0x16c2aa(0x30b),'gzwTs':_0x16c2aa(0x3db),'KAWZj':function(_0x223dda,_0xc550f1,_0x3d783d){return _0x223dda(_0xc550f1,_0x3d783d);},'BlwSp':function(_0x6e5514,_0x1db4b5,_0x702d4c){return _0x6e5514(_0x1db4b5,_0x702d4c);},'xDxte':_0x16c2aa(0x291),'hCeNR':function(_0x3ca856,_0x4ca279,_0x248dfa){return _0x3ca856(_0x4ca279,_0x248dfa);},'oiryo':function(_0x56f2dc,_0x3b414e,_0x300385){return _0x56f2dc(_0x3b414e,_0x300385);},'RUIqc':function(_0x46e274,_0x2f198b,_0x3d084b){return _0x46e274(_0x2f198b,_0x3d084b);},'jnpkp':_0x16c2aa(0x358),'tZCPD':_0x16c2aa(0x310)},_0x45eeb4=function(){const _0x29aa43=_0x16c2aa,_0x3ad00e={'xsbag':_0x58f32d[_0x29aa43(0x208)],'TIHEG':function(_0x14fbf9,_0x2fff47){return _0x14fbf9===_0x2fff47;},'Gtxme':_0x29aa43(0x1e2),'llydx':_0x29aa43(0x406),'NAgSz':function(_0x413157,_0x1e5a9c){const _0x50a7d4=_0x29aa43;return _0x58f32d[_0x50a7d4(0x3aa)](_0x413157,_0x1e5a9c);},'uWQdF':_0x58f32d['WePpR']};if(_0x29aa43(0x2c8)===_0x29aa43(0x2c8))return{'authData':{'id':_0x58f32d['aAPEn'],'access_token':'12345','expiration_date':new Date()['toJSON']()},'shouldError':![],'loggedOut':![],'synchronizedUserId':null,'synchronizedAuthToken':null,'synchronizedExpiration':null,'authenticate':function(_0x586663){const _0x3e1390=_0x29aa43;if(this[_0x3e1390(0x328)])_0x586663[_0x3e1390(0x1b8)](this,_0x3e1390(0x3b8));else this[_0x3e1390(0x276)]?_0x586663['error'](this,null):_0x586663[_0x3e1390(0x379)](this,this[_0x3e1390(0x1df)]);},'restoreAuthentication':function(_0x4a4455){const _0x54080a=_0x29aa43,_0x5e9117={'kstLy':'id\x20token\x20is\x20invalid\x20for\x20this\x20user.'};if(_0x54080a(0x2d0)!==_0x3ad00e['xsbag']){if(!_0x4a4455){if(_0x3ad00e['TIHEG'](_0x3ad00e['Gtxme'],_0x3ad00e[_0x54080a(0x26e)]))return this[_0x54080a(0x225)]=null,this[_0x54080a(0x37a)]=null,this[_0x54080a(0x3c5)]=null,!![];else _0xf886(_0x48b6e9[_0x54080a(0x39c)])[_0x54080a(0x253)](_0x5e9117['kstLy']);}return this['synchronizedUserId']=_0x4a4455['id'],this['synchronizedAuthToken']=_0x4a4455[_0x54080a(0x35d)],this[_0x54080a(0x3c5)]=_0x4a4455['expiration_date'],!![];}else _0xbe68(_0x330499)[_0x54080a(0x2db)](),_0x2c8bc9(_0x26ff98)['not']['toHaveBeenCalled'](),_0x23e60c();},'getAuthType':function(){const _0x3b8174=_0x29aa43;return _0x3ad00e[_0x3b8174(0x330)];},'deauthenticate':function(){const _0x39a426=_0x29aa43;_0x58f32d[_0x39a426(0x2d3)](_0x58f32d[_0x39a426(0x407)],_0x39a426(0x211))?_0x3ad00e['NAgSz'](_0x24ef86,_0x44ec86['message'])[_0x39a426(0x253)](_0x3ad00e[_0x39a426(0x219)]):(this[_0x39a426(0x41d)]=!![],this[_0x39a426(0x293)](null));}};else _0x58f32d[_0x29aa43(0x395)](_0x352912,_0x3a20b7[_0x29aa43(0x39c)])[_0x29aa43(0x253)](_0x29aa43(0x39e));};Parse[_0x16c2aa(0x412)][_0x16c2aa(0x320)]({'extended':function(){return!![];}});const _0x2d4d5f=function(_0x5127f2){return _0x58f32d['XkmgQ'](_0x5fa21d,undefined,_0x5127f2);},_0x5fa21d=function(_0x1e0ced,_0x567df2){const _0x3ada2d=_0x16c2aa,_0x51984d={'authData':{'myoauth':_0x45eeb4()['authData']}},_0x10c353={'method':_0x3ada2d(0x258),'headers':{'X-Parse-Application-Id':'test','X-Parse-REST-API-Key':_0x58f32d['mGjpG'],'X-Parse-Installation-Id':'yolo','X-Parse-Session-Token':_0x1e0ced,'Content-Type':_0x3ada2d(0x3f8)},'url':_0x3ada2d(0x36d),'body':_0x51984d};return _0x58f32d['uuatU'](request,_0x10c353)[_0x3ada2d(0x342)](_0x1c4fd6=>{const _0x545430=_0x3ada2d;return _0x567df2&&_0x567df2(null,_0x1c4fd6,_0x1c4fd6[_0x545430(0x24a)]),{'res':_0x1c4fd6,'body':_0x1c4fd6[_0x545430(0x24a)]};})[_0x3ada2d(0x398)](_0x56af10=>{_0x567df2&&_0x567df2(_0x56af10);throw _0x56af10;});};_0x58f32d[_0x16c2aa(0x235)](it,_0x58f32d[_0x16c2aa(0x261)],_0x5576aa=>{const _0x325f85=_0x16c2aa,_0x4b518c={'uUEjm':'should\x20not\x20fail\x20fetching\x20the\x20session','jvHKL':function(_0x565cf3,_0x43aad8){return _0x565cf3(_0x43aad8);},'NHjVr':function(_0x202159,_0x122eaf){const _0x4059cb=_0x1429;return _0x58f32d[_0x4059cb(0x40b)](_0x202159,_0x122eaf);},'dwxTW':function(_0x3f02e6,_0x3ade54){return _0x3f02e6(_0x3ade54);},'ujmMi':'_Session','QiBQq':_0x325f85(0x246)};_0x58f32d['vkGOb'](_0x2d4d5f,(_0x434e54,_0x11a006,_0x3840e0)=>{const _0x1bbe5a=_0x325f85,_0x1f4202={'LcwtB':function(_0x4c7256,_0x548392){return _0x4b518c['NHjVr'](_0x4c7256,_0x548392);},'ExzNd':function(_0x1595d1){return _0x1595d1();}};_0x4b518c[_0x1bbe5a(0x3f1)](expect,_0x434e54)[_0x1bbe5a(0x253)](null);const _0x4ca24f=_0x3840e0;_0x4b518c[_0x1bbe5a(0x1fd)](ok,_0x4ca24f[_0x1bbe5a(0x246)]),expect(_0x4ca24f[_0x1bbe5a(0x377)])[_0x1bbe5a(0x34a)][_0x1bbe5a(0x2ec)](),expect(_0x4ca24f[_0x1bbe5a(0x377)])[_0x1bbe5a(0x34a)][_0x1bbe5a(0x207)]();const _0x211cc3=_0x4ca24f['sessionToken'],_0x558869=new Parse[(_0x1bbe5a(0x403))](_0x4b518c[_0x1bbe5a(0x404)]);_0x558869['equalTo'](_0x4b518c[_0x1bbe5a(0x248)],_0x211cc3),_0x558869[_0x1bbe5a(0x31d)]({'useMasterKey':!![]})[_0x1bbe5a(0x342)](_0xf4de4=>{const _0x42f7bd=_0x1bbe5a;if(!_0xf4de4){fail(_0x4b518c[_0x42f7bd(0x39f)]),_0x5576aa();return;}_0x4b518c['jvHKL'](expect,_0xf4de4['get'](_0x42f7bd(0x31b)))['toEqual'](_0x42f7bd(0x1da)),_0x5576aa();})['catch'](()=>{const _0x156b14=_0x1bbe5a;_0x1f4202[_0x156b14(0x255)](fail,_0x156b14(0x34d)),_0x1f4202[_0x156b14(0x3b5)](_0x5576aa);});});}),_0x58f32d[_0x16c2aa(0x35f)](it,_0x58f32d['eYNbG'],_0x2a5fd9=>{const _0x46444a={'lCabX':function(_0x4df85f,_0xc43673){const _0x5733e4=_0x1429;return _0x58f32d[_0x5733e4(0x24c)](_0x4df85f,_0xc43673);}};let _0xc3b687;_0x2d4d5f((_0x594676,_0x2808cd,_0x15ec0e)=>{const _0x353f8a=_0x1429,_0x1dcfe4={'ruFtk':function(_0x11fb64,_0x53f959){return _0x11fb64(_0x53f959);}};_0x46444a[_0x353f8a(0x37e)](expect,_0x594676)[_0x353f8a(0x253)](null);const _0x344eb6=_0x15ec0e;expect(_0x344eb6[_0x353f8a(0x377)])[_0x353f8a(0x34a)][_0x353f8a(0x2ec)](),expect(_0x344eb6['objectId'])[_0x353f8a(0x34a)][_0x353f8a(0x207)](),_0xc3b687=_0x344eb6[_0x353f8a(0x377)],_0x46444a[_0x353f8a(0x37e)](_0x2d4d5f,(_0x1087a6,_0x209159,_0x4d6138)=>{const _0xad14c3=_0x353f8a;expect(_0x1087a6)['toBe'](null);const _0x474c58=_0x4d6138;expect(_0x474c58[_0xad14c3(0x377)])[_0xad14c3(0x34a)]['toBeNull'](),expect(_0x474c58[_0xad14c3(0x377)])[_0xad14c3(0x34a)][_0xad14c3(0x207)](),_0x1dcfe4['ruFtk'](expect,_0x474c58[_0xad14c3(0x377)])[_0xad14c3(0x253)](_0xc3b687),_0x2a5fd9();});});}),it(_0x58f32d[_0x16c2aa(0x3a8)],_0x1e91d1=>{const _0xbb9439=_0x16c2aa,_0x119cda={'NBscQ':function(_0x42fba2,_0x4988fa){const _0x1aa8a5=_0x1429;return _0x58f32d[_0x1aa8a5(0x2e9)](_0x42fba2,_0x4988fa);},'sQdrk':_0xbb9439(0x40d),'LEFfX':_0x58f32d[_0xbb9439(0x3e8)],'rZOhd':_0x58f32d[_0xbb9439(0x29e)]};Parse[_0xbb9439(0x412)][_0xbb9439(0x343)]('myUser',_0x58f32d[_0xbb9439(0x3e8)])[_0xbb9439(0x342)](_0x4b6a94=>{return _0x119cda['NBscQ'](_0x5fa21d,_0x4b6a94['getSessionToken']());})[_0xbb9439(0x342)](()=>{const _0x15b748=_0xbb9439;return Parse[_0x15b748(0x412)][_0x15b748(0x333)]();})[_0xbb9439(0x342)](()=>{const _0x1251ba=_0xbb9439;return Parse[_0x1251ba(0x412)][_0x1251ba(0x343)](_0x119cda[_0x1251ba(0x423)],_0x119cda[_0x1251ba(0x2c6)]);})['then'](_0x2aad2b=>{const _0x4e2107=_0xbb9439;return _0x5fa21d(_0x2aad2b[_0x4e2107(0x419)]());})[_0xbb9439(0x342)](fail,({data:_0x56b130})=>{const _0x288703=_0xbb9439;_0x58f32d['hBHxN']!==_0x288703(0x40c)?_0x119cda['NBscQ'](_0x4c3c31,_0x1e9fd5[_0x288703(0x39c)])[_0x288703(0x253)](_0x119cda[_0x288703(0x25a)]):(expect(_0x56b130[_0x288703(0x383)])[_0x288703(0x253)](0xd0),expect(_0x56b130[_0x288703(0x1b8)])[_0x288703(0x253)](_0x288703(0x1bf)),_0x1e91d1());})[_0xbb9439(0x398)](_0x1e91d1[_0xbb9439(0x3b9)]);}),it(_0x58f32d[_0x16c2aa(0x25f)],async()=>{const _0x14f394=_0x16c2aa;if(_0x58f32d['eooSj'](_0x58f32d['mBpxf'],_0x14f394(0x3fb)))_0x58f32d['Qfqnb'](_0x1ff4ad,_0x155807),_0x29a292();else{const _0x24f48f={'validateAppId':()=>Promise[_0x14f394(0x3a6)](),'validateAuthData':()=>Promise['resolve']()},_0x368d49={'authData':{'id':_0x14f394(0x36f),'token':_0x58f32d['gyzQP']}},_0x2309fd={'authData':{'id':_0x14f394(0x36f),'token':'fakeToken2'}};await _0x58f32d['gGdRs'](reconfigureServer,{'auth':{'fakeAuthProvider':_0x24f48f}});const _0x351155=await Parse[_0x14f394(0x412)][_0x14f394(0x26b)](_0x58f32d['kUtav'],_0x368d49),_0x35dd7a=await Parse[_0x14f394(0x412)][_0x14f394(0x26b)](_0x58f32d['kUtav'],_0x368d49,{'sessionToken':_0x351155['getSessionToken']()}),_0x53b0cb=await Parse['User'][_0x14f394(0x26b)](_0x58f32d[_0x14f394(0x21a)],_0x2309fd,{'sessionToken':_0x35dd7a[_0x14f394(0x419)]()});expect(_0x351155['id'])['toEqual'](_0x35dd7a['id']),_0x58f32d[_0x14f394(0x40b)](expect,_0x351155['id'])[_0x14f394(0x1db)](_0x53b0cb['id']);}}),it(_0x16c2aa(0x360),async()=>{const _0x51548a=_0x16c2aa,_0x1759cd={'validateAppId':()=>!![],'appIds':'test','validateAuthData':()=>Promise['resolve']()},_0x5348a4={'appIds':_0x51548a(0x3bb),'validateAppId':()=>Promise['resolve'](!![]),'validateAuthData':()=>Promise[_0x51548a(0x3a6)]()},_0x3b96b4={'authData':{'id':_0x51548a(0x36f),'token':_0x51548a(0x349)}},_0x3aebaa=_0x58f32d['XkmgQ'](spyOn,_0x1759cd,_0x58f32d[_0x51548a(0x1ff)]),_0x8e33ed=spyOn(_0x5348a4,_0x58f32d[_0x51548a(0x1ff)]);await reconfigureServer({'auth':{'asyncProvider':_0x5348a4,'syncProvider':_0x1759cd}});const _0x5e91f1=await Parse[_0x51548a(0x412)]['logInWith'](_0x58f32d['SAZSm'],_0x3b96b4),_0x29672c=await Parse[_0x51548a(0x412)][_0x51548a(0x26b)](_0x58f32d[_0x51548a(0x28c)],_0x3b96b4);_0x58f32d[_0x51548a(0x3cc)](expect,_0x5e91f1[_0x51548a(0x419)]())[_0x51548a(0x2c7)](),expect(_0x29672c[_0x51548a(0x419)]())['toBeDefined'](),_0x58f32d[_0x51548a(0x256)](expect,_0x3aebaa)[_0x51548a(0x1f0)](0x1),expect(_0x8e33ed)[_0x51548a(0x1f0)](0x1);}),it(_0x16c2aa(0x315),async()=>{const _0x2285f8=_0x16c2aa,_0x373404=_0x58f32d['pJTxS'](_0x45eeb4);Parse['User'][_0x2285f8(0x27f)](_0x373404);const _0x22a6a7=await Parse[_0x2285f8(0x412)][_0x2285f8(0x3a2)](_0x58f32d[_0x2285f8(0x375)]);_0x58f32d[_0x2285f8(0x35f)](ok,_0x58f32d[_0x2285f8(0x296)](_0x22a6a7,Parse[_0x2285f8(0x412)]),'Model\x20should\x20be\x20a\x20Parse.User'),strictEqual(Parse[_0x2285f8(0x412)][_0x2285f8(0x34c)](),_0x22a6a7),ok(_0x22a6a7['extended'](),_0x2285f8(0x3e5)),_0x58f32d[_0x2285f8(0x1c2)](strictEqual,_0x373404['authData']['id'],_0x373404[_0x2285f8(0x225)]),strictEqual(_0x373404['authData'][_0x2285f8(0x35d)],_0x373404[_0x2285f8(0x37a)]),strictEqual(_0x373404[_0x2285f8(0x1df)][_0x2285f8(0x392)],_0x373404['synchronizedExpiration']),ok(_0x22a6a7[_0x2285f8(0x1f4)](_0x2285f8(0x406)),_0x58f32d['mvpzZ']),await _0x22a6a7['_unlinkFrom']('myoauth'),_0x58f32d[_0x2285f8(0x35f)](ok,!_0x22a6a7[_0x2285f8(0x1f4)](_0x2285f8(0x406)),_0x58f32d[_0x2285f8(0x20b)]),ok(!_0x373404[_0x2285f8(0x225)],_0x58f32d[_0x2285f8(0x3fc)]),ok(!_0x373404[_0x2285f8(0x37a)],'Auth\x20token\x20should\x20be\x20cleared'),_0x58f32d[_0x2285f8(0x35f)](ok,!_0x373404[_0x2285f8(0x3c5)],_0x58f32d['qmtdk']);const _0x79d654=Config[_0x2285f8(0x2c3)](Parse[_0x2285f8(0x26f)]),_0xc57a22=await _0x79d654[_0x2285f8(0x38c)]['adapter']['find'](_0x2285f8(0x3dd),{'fields':Object['assign']({},defaultColumns[_0x2285f8(0x391)],defaultColumns[_0x2285f8(0x410)])},{'objectId':_0x22a6a7['id']},{});_0x58f32d[_0x2285f8(0x35e)](expect,_0xc57a22['length'])['toBe'](0x1),expect(_0xc57a22[0x0][_0x2285f8(0x227)])[_0x2285f8(0x207)](),_0x58f32d[_0x2285f8(0x33c)](expect,_0xc57a22[0x0][_0x2285f8(0x227)])[_0x2285f8(0x34a)][_0x2285f8(0x2ec)](),await _0x22a6a7[_0x2285f8(0x367)](_0x2285f8(0x406)),ok(_0x373404['synchronizedUserId'],_0x58f32d[_0x2285f8(0x327)]),_0x58f32d['uUTSx'](ok,_0x373404[_0x2285f8(0x37a)],'Auth\x20token\x20should\x20have\x20a\x20value'),ok(_0x373404[_0x2285f8(0x3c5)],_0x58f32d[_0x2285f8(0x1ab)]),ok(_0x22a6a7[_0x2285f8(0x1f4)]('myoauth'),'User\x20should\x20be\x20linked\x20to\x20myoauth');});function _0x723338(_0x58f557){const _0x49fb61=_0x16c2aa;expect(typeof _0x58f557)[_0x49fb61(0x253)]('function');}function _0x1c3a8c(_0x33f38c){const _0x25025b=_0x16c2aa;expect(_0x33f38c)[_0x25025b(0x34a)]['toBeUndefined'](),_0x58f32d[_0x25025b(0x40b)](expect,typeof _0x33f38c[_0x25025b(0x290)])[_0x25025b(0x253)](_0x58f32d[_0x25025b(0x236)]),_0x58f32d[_0x25025b(0x395)](expect,typeof _0x33f38c[_0x25025b(0x290)])[_0x25025b(0x253)](_0x58f32d['bhvGS']);}function _0x5be1e8(_0x500a29){const _0xe8305=_0x16c2aa;expect(_0x500a29)[_0xe8305(0x34a)][_0xe8305(0x207)]();if(!_0x500a29)return;expect(typeof _0x500a29[_0xe8305(0x22d)])[_0xe8305(0x253)](_0xe8305(0x3dc)),_0x58f32d[_0xe8305(0x1c4)](expect,typeof _0x500a29[_0xe8305(0x20e)])[_0xe8305(0x253)](_0xe8305(0x3dc));}it(_0x16c2aa(0x222),_0xa00d15=>{const _0x2be9fd=_0x16c2aa,_0x1c7c64={'id':_0x58f32d[_0x2be9fd(0x3c9)],'token':_0x58f32d[_0x2be9fd(0x32c)]},_0x2a1d57={'validateAppId':function(){const _0x3100f0=_0x2be9fd;return Promise[_0x3100f0(0x3a6)]();},'validateAuthData':function(_0x1b016c){const _0x5e06d0=_0x2be9fd;if(_0x1b016c['id']==_0x1c7c64['id']&&_0x1b016c[_0x5e06d0(0x270)]==_0x1c7c64[_0x5e06d0(0x270)])return Promise[_0x5e06d0(0x3a6)]();return Promise['reject']();}},_0x5b3d8c=spyOn(_0x2a1d57,_0x58f32d[_0x2be9fd(0x1d3)])['and'][_0x2be9fd(0x385)](),_0xb85de8=spyOn(_0x2a1d57,_0x58f32d[_0x2be9fd(0x1ff)])[_0x2be9fd(0x245)][_0x2be9fd(0x385)](),_0x125865=authenticationLoader({'customAuthentication':_0x2a1d57});_0x1c3a8c(_0x125865);const {validator:_0x13b1d1}=_0x125865[_0x2be9fd(0x290)](_0x2be9fd(0x22e));_0x723338(_0x13b1d1),_0x13b1d1(_0x1c7c64,{},{})[_0x2be9fd(0x342)](()=>{const _0xd42d1a=_0x2be9fd;expect(_0x5b3d8c)[_0xd42d1a(0x2db)](),expect(_0xb85de8)['not'][_0xd42d1a(0x2db)](),_0xa00d15();},_0x1551cc=>{const _0x58e423=_0x2be9fd;_0x58f32d[_0x58e423(0x24c)](jfail,_0x1551cc),_0x58f32d[_0x58e423(0x384)](_0xa00d15);});}),_0x58f32d[_0x16c2aa(0x33b)](it,_0x16c2aa(0x376),_0x4c2002=>{const _0x3bf38e=_0x16c2aa,_0x143d7c=authenticationLoader({'customAuthentication':path[_0x3bf38e(0x3a6)](_0x58f32d['xwWdo'])});_0x1c3a8c(_0x143d7c);const {validator:_0xc0bef3}=_0x143d7c[_0x3bf38e(0x290)](_0x3bf38e(0x22e));_0x723338(_0xc0bef3),_0xc0bef3({'token':_0x3bf38e(0x2fc)},{},{})['then'](()=>{_0x4c2002();},_0x263b65=>{const _0x3a3947=_0x3bf38e;_0x58f32d[_0x3a3947(0x1f6)](jfail,_0x263b65),_0x58f32d[_0x3a3947(0x415)](_0x4c2002);});}),_0x58f32d['dCiXd'](it,_0x16c2aa(0x2c0),_0x6ea823=>{const _0x169207=_0x16c2aa,_0x17a0a1={'DaPSQ':function(_0x248587,_0x4ceedd){const _0x26b6ed=_0x1429;return _0x58f32d[_0x26b6ed(0x35e)](_0x248587,_0x4ceedd);},'XrlKJ':function(_0x67c89c){return _0x67c89c();}},_0x274ab9=authenticationLoader({'customAuthentication':{'module':path['resolve'](_0x169207(0x206)),'options':{'token':_0x58f32d[_0x169207(0x325)]}}});_0x58f32d['gGdRs'](_0x1c3a8c,_0x274ab9);const {validator:_0x261aa0}=_0x274ab9['getValidatorForProvider'](_0x169207(0x22e));_0x723338(_0x261aa0),_0x58f32d[_0x169207(0x289)](_0x261aa0,{'token':_0x169207(0x2f7)},{},{})[_0x169207(0x342)](()=>{_0x6ea823();},_0xde7c4b=>{const _0x7ba219=_0x169207;_0x17a0a1[_0x7ba219(0x2f4)](jfail,_0xde7c4b),_0x17a0a1[_0x7ba219(0x308)](_0x6ea823);});}),_0x58f32d['BlwSp'](it,_0x58f32d[_0x16c2aa(0x3ed)],()=>{const _0x44aded=_0x16c2aa,_0x463395={'facebook':{'appIds':['a','b'],'appSecret':_0x44aded(0x313)}},{adapter:_0x32c4bb,appIds:_0x4deddd,providerOptions:_0x38773b}=authenticationLoader[_0x44aded(0x224)]('facebook',_0x463395);_0x58f32d[_0x44aded(0x256)](_0x5be1e8,_0x32c4bb),_0x58f32d['njpbn'](expect,_0x4deddd)[_0x44aded(0x1db)](['a','b']),_0x58f32d['gGdRs'](expect,_0x38773b)[_0x44aded(0x1db)](_0x463395[_0x44aded(0x38f)]);}),_0x58f32d[_0x16c2aa(0x1e9)](it,_0x16c2aa(0x2e5),async()=>{const _0x1c849f=_0x16c2aa,_0x19d6e4=_0x58f32d['cpIuI'](require,_0x58f32d[_0x1c849f(0x2ae)]);spyOn(_0x19d6e4,_0x58f32d[_0x1c849f(0x36c)])['and']['callFake'](()=>{const _0xe5f898=_0x1c849f;return Promise[_0xe5f898(0x3a6)]({'id':'a'});});const _0x1009a7={'facebook':{'appIds':['a','b'],'appSecret':_0x58f32d[_0x1c849f(0x244)]}},_0x282605={'access_token':_0x1c849f(0x405)},{adapter:_0xab3369,appIds:_0x22c873,providerOptions:_0x395287}=authenticationLoader['loadAuthAdapter'](_0x58f32d[_0x1c849f(0x339)],_0x1009a7);await _0xab3369[_0x1c849f(0x20e)](_0x22c873,_0x282605,_0x395287),_0x58f32d[_0x1c849f(0x317)](expect,_0x19d6e4[_0x1c849f(0x2c3)]['calls'][_0x1c849f(0x31d)]()[_0x1c849f(0x3e7)][0x0][_0x1c849f(0x2cf)]('appsecret_proof'))[_0x1c849f(0x253)](!![]);}),_0x58f32d[_0x16c2aa(0x235)](it,_0x16c2aa(0x33e),async()=>{const _0x324b00=_0x16c2aa,_0xd49274=require(_0x58f32d[_0x324b00(0x2ae)]);_0x58f32d[_0x324b00(0x1d1)](spyOn,_0xd49274,_0x58f32d['PVeJu'])[_0x324b00(0x245)][_0x324b00(0x3e4)](()=>{const _0x5bea39=_0x324b00;return Promise[_0x5bea39(0x3a6)]({'id':'a'});});const _0x4bed77={'facebook':{'appIds':_0x324b00(0x267),'appSecret':_0x58f32d['JxZYO']}},_0x34de05={'access_token':_0x324b00(0x405)},{adapter:_0x1cd54f,appIds:_0x52e1fc,providerOptions:_0x1dda29}=authenticationLoader['loadAuthAdapter'](_0x58f32d[_0x324b00(0x339)],_0x4bed77);await expectAsync(_0x1cd54f['validateAppId'](_0x52e1fc,_0x34de05,_0x1dda29))[_0x324b00(0x254)](new Parse[(_0x324b00(0x1ce))](Parse['Error'][_0x324b00(0x233)],_0x324b00(0x264)));}),_0x58f32d[_0x16c2aa(0x299)](it,_0x16c2aa(0x19e),async()=>{const _0x5b351e=_0x16c2aa,_0x4625e3={'IeGVD':function(_0x1a0899,_0x1d5a24){const _0x57d0a9=_0x1429;return _0x58f32d[_0x57d0a9(0x35b)](_0x1a0899,_0x1d5a24);},'kdrxL':_0x58f32d[_0x5b351e(0x324)],'JoktM':_0x5b351e(0x2ac)},_0x2f6c98=_0x58f32d[_0x5b351e(0x33c)](require,_0x5b351e(0x29b));spyOn(_0x2f6c98,_0x5b351e(0x2c3))[_0x5b351e(0x245)]['callFake'](()=>{const _0x32802c=_0x5b351e;if(_0x4625e3[_0x32802c(0x30a)](_0x4625e3[_0x32802c(0x1c6)],_0x4625e3[_0x32802c(0x29d)]))return Promise['resolve']();else{_0x4b2f7b&&_0x390b61(_0x3b6d3d);throw _0x47f5cd;}});const _0x393ef3={'facebook':{'appIds':['a','b'],'appSecret':'secret_sauce'}},_0x231a6e={'id':_0x58f32d[_0x5b351e(0x3ba)],'access_token':_0x58f32d[_0x5b351e(0x3ba)]},{adapter:_0x2c661f,providerOptions:_0x302268}=authenticationLoader[_0x5b351e(0x224)](_0x5b351e(0x38f),_0x393ef3);await _0x2c661f['validateAuthData'](_0x231a6e,_0x302268),_0x58f32d[_0x5b351e(0x306)](expect,_0x2f6c98[_0x5b351e(0x2c3)][_0x5b351e(0x3a3)]['first']()[_0x5b351e(0x3e7)][0x0][_0x5b351e(0x2cf)](_0x5b351e(0x3f9)))[_0x5b351e(0x253)](!![]);}),_0x58f32d[_0x16c2aa(0x3fe)](it,_0x58f32d[_0x16c2aa(0x1c1)],()=>{const _0x2efeef=_0x16c2aa,_0x5389bb={'custom':{'validateAppId':()=>{},'validateAuthData':()=>{},'appIds':['a','b']}},{adapter:_0x4b0ea5,appIds:_0x1cecdb,providerOptions:_0x198aa5}=authenticationLoader[_0x2efeef(0x224)]('custom',_0x5389bb);_0x5be1e8(_0x4b0ea5),expect(_0x1cecdb)[_0x2efeef(0x1db)](['a','b']),_0x58f32d[_0x2efeef(0x369)](expect,_0x198aa5)[_0x2efeef(0x1db)](_0x5389bb[_0x2efeef(0x3ee)]);}),_0x58f32d['XkmgQ'](it,_0x58f32d[_0x16c2aa(0x340)],async()=>{const _0x348673=_0x16c2aa;await reconfigureServer({'auth':{'myoauth':{'enabled':![],'module':path['resolve'](__dirname,_0x58f32d[_0x348673(0x31c)])}}});const _0x436469=_0x45eeb4();Parse['User'][_0x348673(0x27f)](_0x436469),await expectAsync(Parse[_0x348673(0x412)][_0x348673(0x3a2)](_0x58f32d[_0x348673(0x375)]))[_0x348673(0x254)](new Parse[(_0x348673(0x1ce))](Parse[_0x348673(0x1ce)][_0x348673(0x2a9)],_0x58f32d['qyfyB']));});}),describe(_0x5e6db5(0x279),()=>{const _0x5970b7=_0x5e6db5,_0x12dcc7={'ZzsaF':function(_0x409833){return _0x409833();},'Acnld':_0x5970b7(0x3a7),'iwJjN':'the_token','zcEdz':function(_0x41cf6e,_0x421418){return _0x41cf6e(_0x421418);},'ZxJjP':_0x5970b7(0x3d5),'IUPFQ':'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com','cvFzw':'jGVpM','mHmrI':_0x5970b7(0x351),'kzXdQ':function(_0x3be157,_0x2d0661,_0x373a0b){return _0x3be157(_0x2d0661,_0x373a0b);},'ZPleU':_0x5970b7(0x2be),'ipRfT':_0x5970b7(0x373),'kuLJZ':_0x5970b7(0x313),'eebYf':_0x5970b7(0x1bb),'SlGiD':function(_0xd45693,_0x29c1c8,_0x476e9e){return _0xd45693(_0x29c1c8,_0x476e9e);},'WdpaC':_0x5970b7(0x32b),'xoGbU':'https://accounts.google.com','tWLif':function(_0x2a5aeb,_0x164cae,_0x316363){return _0x2a5aeb(_0x164cae,_0x316363);},'hYtzR':_0x5970b7(0x2da),'AneYN':_0x5970b7(0x24b),'cKkRw':_0x5970b7(0x280),'KUXSA':'jwt\x20audience\x20invalid.\x20expected:\x20secret','ApVXL':_0x5970b7(0x2aa),'nGDBz':'123','GSWKW':function(_0x490644,_0x50bbf1,_0x3643d7){return _0x490644(_0x50bbf1,_0x3643d7);},'pnOsb':function(_0x274181,_0x4d5199){return _0x274181===_0x4d5199;},'PiaKi':_0x5970b7(0x2ee),'fEGYE':_0x5970b7(0x2c9),'phSmN':function(_0x4695a6,_0x5d6dbd){return _0x4695a6(_0x5d6dbd);},'cwmIv':function(_0x54a9e5,_0x286dcf){return _0x54a9e5(_0x286dcf);},'JOKMw':_0x5970b7(0x20a),'RrRcg':'../lib/Adapters/Auth/utils','SnGOR':function(_0x1bb14c,_0x2ce8f1,_0x4db279){return _0x1bb14c(_0x2ce8f1,_0x4db279);},'YxVZq':_0x5970b7(0x40a),'NHJCD':_0x5970b7(0x381),'GWpJJ':_0x5970b7(0x20f),'CDKue':'(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20client_id'},_0x5f49c7=_0x12dcc7[_0x5970b7(0x210)](require,_0x5970b7(0x305)),_0x45b8ac=_0x12dcc7['cwmIv'](require,_0x12dcc7[_0x5970b7(0x19f)]),_0x2e418c=_0x12dcc7[_0x5970b7(0x210)](require,_0x12dcc7[_0x5970b7(0x1a0)]);_0x12dcc7[_0x5970b7(0x3d9)](it,_0x12dcc7['YxVZq'],async()=>{const _0x1b58ba=_0x5970b7;try{await _0x5f49c7[_0x1b58ba(0x22d)]({},{}),_0x12dcc7[_0x1b58ba(0x3bc)](fail);}catch(_0x1fb29c){expect(_0x1fb29c[_0x1b58ba(0x39c)])['toBe'](_0x12dcc7['Acnld']);}}),_0x12dcc7[_0x5970b7(0x3e0)](it,_0x5970b7(0x2ca),async()=>{const _0x5ec719=_0x5970b7;try{await _0x5f49c7[_0x5ec719(0x22d)]({'id':_0x5ec719(0x373),'id_token':_0x12dcc7[_0x5ec719(0x21e)]},{}),fail();}catch(_0x420311){_0x12dcc7[_0x5ec719(0x2e1)](expect,_0x420311['message'])[_0x5ec719(0x253)](_0x12dcc7[_0x5ec719(0x28f)]);}}),_0x12dcc7['kzXdQ'](it,_0x12dcc7[_0x5970b7(0x2a2)],async()=>{const _0x357644=_0x5970b7;if(_0x12dcc7['cvFzw']!==_0x12dcc7[_0x357644(0x374)])_0x12dcc7['zcEdz'](_0x441b80,_0x47b357['message'])[_0x357644(0x253)](_0x12dcc7['IUPFQ']);else{const _0x3083b9={'iss':'https://accounts.google.com','aud':_0x357644(0x313),'exp':Date[_0x357644(0x416)](),'sub':_0x357644(0x373)},_0x1edcfa={'header':{'kid':_0x357644(0x3fd),'alg':_0x12dcc7[_0x357644(0x3ae)]}};_0x12dcc7[_0x357644(0x1a7)](spyOn,_0x2e418c,_0x357644(0x1bb))[_0x357644(0x245)][_0x357644(0x3e4)](()=>_0x1edcfa),spyOn(_0x45b8ac,_0x12dcc7[_0x357644(0x3d4)])[_0x357644(0x245)][_0x357644(0x3e4)](()=>_0x3083b9);const _0xa55b93=await _0x5f49c7[_0x357644(0x22d)]({'id':_0x12dcc7[_0x357644(0x31e)],'id_token':_0x357644(0x2a5)},{'clientId':_0x12dcc7[_0x357644(0x1eb)]});expect(_0xa55b93)[_0x357644(0x1db)](_0x3083b9);}}),_0x12dcc7['SlGiD'](it,_0x12dcc7[_0x5970b7(0x1b5)],async()=>{const _0x2f5275=_0x5970b7,_0x2847d0={'iss':_0x2f5275(0x1f9),'sub':_0x12dcc7['ipRfT']},_0x52df9d={'header':{'kid':'123','alg':_0x12dcc7[_0x2f5275(0x3ae)]}};spyOn(_0x2e418c,_0x12dcc7[_0x2f5275(0x3f0)])[_0x2f5275(0x245)][_0x2f5275(0x3e4)](()=>_0x52df9d),_0x12dcc7['SlGiD'](spyOn,_0x45b8ac,_0x2f5275(0x2be))[_0x2f5275(0x245)][_0x2f5275(0x3e4)](()=>_0x2847d0);try{await _0x5f49c7['validateAuthData']({'id':_0x2f5275(0x373),'id_token':_0x2f5275(0x2a5)},{'clientId':_0x12dcc7[_0x2f5275(0x1eb)]}),fail();}catch(_0x3769a5){_0x12dcc7['zcEdz'](expect,_0x3769a5[_0x2f5275(0x39c)])[_0x2f5275(0x253)](_0x12dcc7[_0x2f5275(0x2b2)]);}}),xit(_0x12dcc7['CDKue'],async()=>{const _0x36f4a7=_0x5970b7,_0x578a8a={'iss':_0x12dcc7[_0x36f4a7(0x22a)],'aud':_0x36f4a7(0x313),'exp':Date['now'](),'sub':_0x36f4a7(0x373)},_0xea9f5f={'header':{'kid':_0x36f4a7(0x3fd),'alg':_0x12dcc7[_0x36f4a7(0x3ae)]}};spyOn(_0x2e418c,_0x12dcc7[_0x36f4a7(0x3f0)])['and'][_0x36f4a7(0x3e4)](()=>_0xea9f5f),_0x12dcc7[_0x36f4a7(0x1d7)](spyOn,_0x45b8ac,_0x36f4a7(0x2be))[_0x36f4a7(0x245)][_0x36f4a7(0x3e4)](()=>_0x578a8a);try{await _0x5f49c7[_0x36f4a7(0x22d)]({'id':_0x12dcc7['hYtzR'],'token':_0x12dcc7[_0x36f4a7(0x295)]},{'clientId':_0x36f4a7(0x313)}),fail();}catch(_0x1df4e8){if('uIWfd'===_0x12dcc7[_0x36f4a7(0x2d7)])expect(_0x1df4e8[_0x36f4a7(0x39c)])['toBe'](_0x12dcc7[_0x36f4a7(0x3c7)]);else{if(!_0x3c0a2e)return this[_0x36f4a7(0x225)]=null,this['synchronizedAuthToken']=null,this[_0x36f4a7(0x3c5)]=null,!![];return this[_0x36f4a7(0x225)]=_0x25297f['id'],this[_0x36f4a7(0x37a)]=_0x4d1288[_0x36f4a7(0x35d)],this[_0x36f4a7(0x3c5)]=_0x16f45f[_0x36f4a7(0x392)],!![];}}}),xit('should\x20throw\x20error\x20with\x20invalid\x20user\x20id',async()=>{const _0xece440=_0x5970b7,_0x553a09={'iss':_0x12dcc7['xoGbU'],'aud':_0x12dcc7['kuLJZ'],'exp':Date[_0xece440(0x416)](),'sub':_0x12dcc7['ipRfT']},_0x4ac662={'header':{'kid':_0x12dcc7['nGDBz'],'alg':_0x12dcc7[_0xece440(0x3ae)]}};spyOn(_0x2e418c,_0xece440(0x1bb))[_0xece440(0x245)][_0xece440(0x3e4)](()=>_0x4ac662),_0x12dcc7['GSWKW'](spyOn,_0x45b8ac,_0xece440(0x2be))[_0xece440(0x245)][_0xece440(0x3e4)](()=>_0x553a09);try{_0x12dcc7['pnOsb'](_0x12dcc7[_0xece440(0x3f7)],_0xece440(0x2ee))?(await _0x5f49c7[_0xece440(0x22d)]({'id':_0x12dcc7[_0xece440(0x3b0)],'token':_0x12dcc7[_0xece440(0x295)]},{'clientId':'INSERT\x20CLIENT\x20ID\x20HERE'}),fail()):_0x12dcc7[_0xece440(0x2e1)](_0x1390cb,_0x392256[_0xece440(0x39c)])['toBe'](_0x12dcc7[_0xece440(0x1ef)]);}catch(_0x3d7bcf){_0x12dcc7[_0xece440(0x2e1)](expect,_0x3d7bcf[_0xece440(0x39c)])[_0xece440(0x253)](_0xece440(0x2b4));}});}),describe('keycloak\x20auth\x20adapter',()=>{const _0xf52f4=_0x5e6db5,_0x31e04b={'EMFId':_0xf52f4(0x39e),'GsLrx':_0xf52f4(0x38f),'FzGEe':function(_0x54d306,_0x2f8a91){return _0x54d306(_0x2f8a91);},'SIsHO':function(_0x3a026f,_0x35bb63){return _0x3a026f(_0x35bb63);},'XygIc':_0xf52f4(0x347),'rMpSF':function(_0x2e3ce1){return _0x2e3ce1();},'nDkNL':_0xf52f4(0x2a7),'HjoIZ':_0xf52f4(0x3da),'ZsIzb':function(_0x55e9e4,_0x149626){return _0x55e9e4!==_0x149626;},'GRlJl':function(_0x584d9d,_0x1cf7f1){return _0x584d9d(_0x1cf7f1);},'rEvBf':_0xf52f4(0x1a6),'LzAax':_0xf52f4(0x231),'HfdFF':'get','JsHog':function(_0x14a058){return _0x14a058();},'vyQBA':_0xf52f4(0x1a3),'ivNPP':_0xf52f4(0x2aa),'gntuL':'new','miSJg':_0xf52f4(0x3e6),'MaGVR':_0xf52f4(0x25c),'ijnmY':_0xf52f4(0x27d),'DZcHc':function(_0x229c96,_0x171713,_0x20c3ff){return _0x229c96(_0x171713,_0x20c3ff);},'AHWBz':'role1','RafKB':function(_0x55d668,_0x325302,_0x1bb2be){return _0x55d668(_0x325302,_0x1bb2be);},'uNieh':'http://example.com','FoLQo':_0xf52f4(0x2ab),'KktLd':function(_0x2720c4){return _0x2720c4();},'noben':'Invalid\x20authentication','UhhWM':function(_0x412d99,_0x290e6a,_0x138af7){return _0x412d99(_0x290e6a,_0x138af7);},'wZiQM':_0xf52f4(0x39d),'inLeW':function(_0x38ff89,_0x51ff18){return _0x38ff89(_0x51ff18);},'PPhNl':function(_0x29cc95,_0x25458c,_0x1f7b46){return _0x29cc95(_0x25458c,_0x1f7b46);},'gYCUS':_0xf52f4(0x34b),'qWYAW':_0xf52f4(0x370),'LbhnY':'validateAuthData\x20should\x20fail\x20without\x20access\x20token','BIHlq':_0xf52f4(0x32d),'KvzRz':function(_0x53abfc,_0x2f31ad,_0x5b518a){return _0x53abfc(_0x2f31ad,_0x5b518a);},'JvjhR':'validateAuthData\x20should\x20fail\x20with\x20invalid\x20groups','GqGRW':function(_0x4690ec,_0x266fc0,_0x163f00){return _0x4690ec(_0x266fc0,_0x163f00);},'TjfdP':function(_0x1aa8ba,_0x2b04a8,_0x2db4f3){return _0x1aa8ba(_0x2b04a8,_0x2db4f3);},'SzMlQ':_0xf52f4(0x3ca)},_0x19e59d=require('../lib/Adapters/Auth/keycloak'),_0x2c4533=_0x31e04b[_0xf52f4(0x23f)](require,'../lib/Adapters/Auth/httpsRequest');_0x31e04b[_0xf52f4(0x2de)](it,_0x31e04b[_0xf52f4(0x319)],async()=>{const _0x5c89d8=_0xf52f4,_0x44f4e6={'id':'fakeid'};try{await _0x19e59d[_0x5c89d8(0x22d)](_0x44f4e6),fail();}catch(_0x4da01f){expect(_0x4da01f['message'])['toBe'](_0x31e04b['EMFId']);}}),_0x31e04b['DZcHc'](it,_0x31e04b[_0xf52f4(0x337)],async()=>{const _0x5ea441=_0xf52f4,_0x1b487b={'YaUBr':_0x31e04b[_0x5ea441(0x363)],'ANHSa':function(_0x28b0b6,_0x20718e){const _0x51924c=_0x5ea441;return _0x31e04b[_0x51924c(0x2d6)](_0x28b0b6,_0x20718e);},'GdFlf':function(_0x4a77bd,_0x5a3c54){const _0x4de9de=_0x5ea441;return _0x31e04b[_0x4de9de(0x2dd)](_0x4a77bd,_0x5a3c54);}},_0x23da51={'access_token':_0x5ea441(0x3e6)};try{if('nGliv'!==_0x31e04b[_0x5ea441(0x1cd)])await _0x19e59d[_0x5ea441(0x22d)](_0x23da51),_0x31e04b[_0x5ea441(0x409)](fail);else{const _0x23b92a={'facebook':{'appIds':['a','b'],'appSecret':'secret'}},{adapter:_0x533926,appIds:_0x27bb28,providerOptions:_0x351f74}=_0x104e2e[_0x5ea441(0x224)](_0x1b487b[_0x5ea441(0x33f)],_0x23b92a);_0x1b487b[_0x5ea441(0x30c)](_0x4ef99b,_0x533926),_0x1b487b['ANHSa'](_0xb8ada3,_0x27bb28)['toEqual'](['a','b']),_0x1b487b[_0x5ea441(0x39b)](_0x2f9258,_0x351f74)[_0x5ea441(0x1db)](_0x23b92a[_0x5ea441(0x38f)]);}}catch(_0xdfd7a0){_0x31e04b[_0x5ea441(0x2dd)](expect,_0xdfd7a0['message'])[_0x5ea441(0x253)](_0x5ea441(0x39e));}}),_0x31e04b[_0xf52f4(0x3b6)](it,'validateAuthData\x20should\x20fail\x20without\x20config',async()=>{const _0xfbf42b=_0xf52f4,_0x1b524a={'hSapl':function(_0x2299a4,_0x34a1b8){const _0x2c5ab3=_0x1429;return _0x31e04b[_0x2c5ab3(0x2d6)](_0x2299a4,_0x34a1b8);}},_0x5b6404={'keycloak':{'config':null}},_0x5db409={'id':_0x31e04b[_0xfbf42b(0x3c3)],'access_token':_0xfbf42b(0x3e6)},{adapter:_0x32e73d,providerOptions:_0x1f096b}=authenticationLoader[_0xfbf42b(0x224)](_0x31e04b['HjoIZ'],_0x5b6404);try{await _0x32e73d[_0xfbf42b(0x22d)](_0x5db409,_0x1f096b),_0x31e04b[_0xfbf42b(0x409)](fail);}catch(_0xec765d){_0x31e04b[_0xfbf42b(0x1aa)](_0xfbf42b(0x22f),_0xfbf42b(0x22f))?_0x1b524a['hSapl'](_0x52e9ea,_0x27b098[_0xfbf42b(0x39c)])[_0xfbf42b(0x253)](_0xfbf42b(0x3b3)):_0x31e04b['GRlJl'](expect,_0xec765d[_0xfbf42b(0x39c)])[_0xfbf42b(0x253)](_0x31e04b[_0xfbf42b(0x216)]);}}),it('validateAuthData\x20should\x20fail\x20connect\x20error',async()=>{const _0x8ec25a=_0xf52f4;spyOn(_0x2c4533,_0x31e04b['HfdFF'])['and'][_0x8ec25a(0x3e4)](()=>{const _0x593e84=_0x8ec25a;return Promise[_0x593e84(0x301)]({'text':JSON['stringify']({'error':_0x31e04b[_0x593e84(0x20c)]})});});const _0x295d42={'keycloak':{'config':{'auth-server-url':_0x8ec25a(0x1e6),'realm':'new'}}},_0x166318={'id':'fakeid','access_token':_0x8ec25a(0x3e6)},{adapter:_0xa81ac5,providerOptions:_0x5e4868}=authenticationLoader['loadAuthAdapter'](_0x8ec25a(0x3da),_0x295d42);try{await _0xa81ac5[_0x8ec25a(0x22d)](_0x166318,_0x5e4868),_0x31e04b[_0x8ec25a(0x1c0)](fail);}catch(_0x2675e7){_0x31e04b[_0x8ec25a(0x382)]===_0x8ec25a(0x1a3)?expect(_0x2675e7[_0x8ec25a(0x39c)])[_0x8ec25a(0x253)](_0x31e04b[_0x8ec25a(0x31a)]):_0xfa160(_0x427e80[_0x8ec25a(0x39c)])[_0x8ec25a(0x253)](_0x8ec25a(0x3d5));}}),_0x31e04b['KvzRz'](it,_0xf52f4(0x3f6),async()=>{const _0x11dbd8=_0xf52f4,_0x1d7860={'XHZDT':_0x11dbd8(0x3dc),'XoYTC':function(_0x3c1342,_0x49f280){return _0x3c1342(_0x49f280);},'Pmgsm':function(_0x4cffd0,_0x3f2945){return _0x4cffd0(_0x3f2945);}};spyOn(_0x2c4533,_0x31e04b['HfdFF'])[_0x11dbd8(0x245)][_0x11dbd8(0x3e4)](()=>{const _0x3fca39=_0x11dbd8;return Promise[_0x3fca39(0x301)]({'text':JSON['stringify']({'error_description':_0x3fca39(0x27b)})});});const _0x57c363={'keycloak':{'config':{'auth-server-url':_0x11dbd8(0x1e6),'realm':_0x31e04b[_0x11dbd8(0x1b9)]}}},_0x2582cc={'id':_0x11dbd8(0x2a7),'access_token':_0x31e04b[_0x11dbd8(0x312)]},{adapter:_0x59b223,providerOptions:_0x489ec0}=authenticationLoader[_0x11dbd8(0x224)]('keycloak',_0x57c363);try{if(_0x11dbd8(0x25c)===_0x31e04b[_0x11dbd8(0x249)])await _0x59b223[_0x11dbd8(0x22d)](_0x2582cc,_0x489ec0),_0x31e04b[_0x11dbd8(0x1c0)](fail);else{_0x5c6511(_0x21a974)[_0x11dbd8(0x34a)]['toBeUndefined']();if(!_0x47e56c)return;_0x5553a4(typeof _0x3f88a9['validateAuthData'])['toBe'](_0x1d7860[_0x11dbd8(0x402)]),_0x1d7860[_0x11dbd8(0x341)](_0x98ba47,typeof _0x25d151[_0x11dbd8(0x20e)])['toBe'](_0x11dbd8(0x3dc));}}catch(_0x1e8a19){_0x11dbd8(0x27d)!==_0x31e04b[_0x11dbd8(0x2e6)]?_0x1d7860[_0x11dbd8(0x1d4)](_0x418c10,_0xff3905[_0x11dbd8(0x39c)])['toBe'](_0x11dbd8(0x3d5)):_0x31e04b[_0x11dbd8(0x2dd)](expect,_0x1e8a19[_0x11dbd8(0x39c)])['toBe'](_0x11dbd8(0x27b));}}),it(_0xf52f4(0x205),async()=>{const _0x7a4c50=_0xf52f4;_0x31e04b[_0x7a4c50(0x2de)](spyOn,_0x2c4533,_0x31e04b['HfdFF'])['and']['callFake'](()=>{const _0x4089c3=_0x7a4c50;return Promise[_0x4089c3(0x3a6)]({});});const _0x3741e7={'keycloak':{'config':{'auth-server-url':_0x7a4c50(0x1e6),'realm':_0x7a4c50(0x1c8)}}},_0x42db22={'id':_0x7a4c50(0x2a7),'access_token':_0x31e04b[_0x7a4c50(0x312)]},{adapter:_0x1b50d8,providerOptions:_0x4255cd}=authenticationLoader[_0x7a4c50(0x224)](_0x7a4c50(0x3da),_0x3741e7);try{await _0x1b50d8['validateAuthData'](_0x42db22,_0x4255cd),_0x31e04b[_0x7a4c50(0x409)](fail);}catch(_0x13edd8){_0x31e04b[_0x7a4c50(0x2dd)](expect,_0x13edd8['message'])['toBe'](_0x7a4c50(0x394));}}),_0x31e04b[_0xf52f4(0x364)](it,_0x31e04b[_0xf52f4(0x1c7)],async()=>{const _0x13ea75=_0xf52f4,_0x36c1ca={'PHtlc':_0x31e04b[_0x13ea75(0x2ef)],'LOibW':_0x13ea75(0x411)};_0x31e04b[_0x13ea75(0x3bf)](spyOn,_0x2c4533,_0x31e04b['HfdFF'])[_0x13ea75(0x245)]['callFake'](()=>{const _0x166631=_0x13ea75;return Promise[_0x166631(0x3a6)]({'data':{'sub':_0x166631(0x2a7),'roles':[_0x36c1ca[_0x166631(0x2cb)]],'groups':[_0x36c1ca['LOibW']]}});});const _0x227f01={'keycloak':{'config':{'auth-server-url':_0x31e04b[_0x13ea75(0x26d)],'realm':_0x31e04b['gntuL']}}},_0x3b546f={'id':_0x31e04b[_0x13ea75(0x3c3)],'access_token':'sometoken','roles':[_0x13ea75(0x314)],'groups':[_0x31e04b[_0x13ea75(0x273)]]},{adapter:_0x4abe0b,providerOptions:_0x5ad40a}=authenticationLoader['loadAuthAdapter'](_0x31e04b['HjoIZ'],_0x227f01);try{await _0x4abe0b[_0x13ea75(0x22d)](_0x3b546f,_0x5ad40a),_0x31e04b[_0x13ea75(0x1cc)](fail);}catch(_0x20408a){expect(_0x20408a[_0x13ea75(0x39c)])[_0x13ea75(0x253)](_0x31e04b[_0x13ea75(0x1e4)]);}}),_0x31e04b[_0xf52f4(0x1a2)](it,_0xf52f4(0x252),async()=>{const _0x2a89f7=_0xf52f4;_0x31e04b[_0x2a89f7(0x3b6)](spyOn,_0x2c4533,_0x31e04b[_0x2a89f7(0x414)])['and'][_0x2a89f7(0x3e4)](()=>{const _0x84604d=_0x2a89f7,_0x5e3b8f={'LGxrY':function(_0x57b8b9,_0x28f91d){return _0x57b8b9(_0x28f91d);}};if(_0x84604d(0x1fc)===_0x84604d(0x1fc))return Promise[_0x84604d(0x3a6)]({'data':{'sub':_0x84604d(0x2a7),'roles':_0x84604d(0x411),'groups':[_0x31e04b[_0x84604d(0x273)]]}});else _0x5e3b8f[_0x84604d(0x2e0)](_0xd7b612,_0x3b5d0c['message'])[_0x84604d(0x253)](_0x84604d(0x40f)+_0x4fc71b[_0x84604d(0x259)][_0x84604d(0x3ff)]);});const _0x252bbc={'keycloak':{'config':{'auth-server-url':_0x2a89f7(0x1e6),'realm':'new'}}},_0x54f414={'id':_0x2a89f7(0x2a7),'access_token':_0x2a89f7(0x3e6),'roles':[_0x2a89f7(0x314)],'groups':[_0x31e04b[_0x2a89f7(0x273)]]},{adapter:_0x5a0fc5,providerOptions:_0x2f1225}=authenticationLoader['loadAuthAdapter'](_0x31e04b[_0x2a89f7(0x303)],_0x252bbc);try{await _0x5a0fc5[_0x2a89f7(0x22d)](_0x54f414,_0x2f1225),fail();}catch(_0x137fe3){if(_0x31e04b[_0x2a89f7(0x1aa)](_0x31e04b[_0x2a89f7(0x3cd)],_0x2a89f7(0x39d))){const _0x45fe7f=_0x2a89f7(0x2e8)[_0x2a89f7(0x396)]('|');let _0x4c3d02=0x0;while(!![]){switch(_0x45fe7f[_0x4c3d02++]){case'0':_0x5babfc=_0x5a4725;continue;case'1':_0x396480(_0x5824fb['length'])[_0x2a89f7(0x1db)](0x6);continue;case'2':_0x31e04b[_0x2a89f7(0x2d6)](_0xf1c7a2,_0x3e2182)[_0x2a89f7(0x2c7)]();continue;case'3':_0x11eddd(_0x300cfa)[_0x2a89f7(0x2c7)]();continue;case'4':_0x4deed8=_0xb09d78;continue;}break;}}else _0x31e04b[_0x2a89f7(0x23f)](expect,_0x137fe3[_0x2a89f7(0x39c)])[_0x2a89f7(0x253)](_0x31e04b[_0x2a89f7(0x1e4)]);}}),_0x31e04b[_0xf52f4(0x274)](it,_0x31e04b[_0xf52f4(0x1b3)],async()=>{const _0xe1b7b=_0xf52f4,_0x530bca={'rpyKm':_0x31e04b[_0xe1b7b(0x2ef)]};_0x31e04b[_0xe1b7b(0x400)](spyOn,_0x2c4533,_0xe1b7b(0x2c3))[_0xe1b7b(0x245)][_0xe1b7b(0x3e4)](()=>{const _0x3e8bb1=_0xe1b7b;return Promise[_0x3e8bb1(0x3a6)]({'data':{'sub':_0x3e8bb1(0x2a7),'roles':[_0x530bca['rpyKm']],'groups':[_0x3e8bb1(0x2ab)]}});});const _0x19b364={'keycloak':{'config':{'auth-server-url':_0x31e04b[_0xe1b7b(0x26d)],'realm':_0x31e04b[_0xe1b7b(0x1b9)]}}},_0x2c1b9b={'id':'fakeid','access_token':_0xe1b7b(0x3e6),'roles':[_0xe1b7b(0x314)],'groups':[_0xe1b7b(0x2ab)]},{adapter:_0x14f3a2,providerOptions:_0x206e64}=authenticationLoader[_0xe1b7b(0x224)](_0x31e04b[_0xe1b7b(0x303)],_0x19b364);await _0x14f3a2['validateAuthData'](_0x2c1b9b,_0x206e64),_0x31e04b['FzGEe'](expect,_0x2c4533[_0xe1b7b(0x2c3)])[_0xe1b7b(0x2d1)]({'host':'http://example.com','path':_0x31e04b['gYCUS'],'headers':{'Authorization':_0x31e04b[_0xe1b7b(0x218)]}});});}),describe(_0x5e6db5(0x257),()=>{const _0x18a32b=_0x5e6db5,_0x8c2fe1={'uxnRA':_0x18a32b(0x313),'jLFfH':function(_0xafd0b9){return _0xafd0b9();},'WkXpp':function(_0x16eeef,_0x38c235){return _0x16eeef!==_0x38c235;},'satrz':_0x18a32b(0x1ad),'OskGv':function(_0x1a3c1){return _0x1a3c1();},'GzfpG':function(_0x1dff91,_0x4a36b1){return _0x1dff91(_0x4a36b1);},'AkxEv':_0x18a32b(0x2a5),'EZQTx':function(_0x193b5e,_0x1b9121){return _0x193b5e(_0x1b9121);},'yfuAk':function(_0x49d400,_0x420f5e){return _0x49d400!==_0x420f5e;},'RmTEa':_0x18a32b(0x2bd),'aLLDW':_0x18a32b(0x351),'XdSos':function(_0x31dde4,_0x3c0d08,_0x54ee4c){return _0x31dde4(_0x3c0d08,_0x54ee4c);},'OwfBi':_0x18a32b(0x1bb),'hWTgr':_0x18a32b(0x3b8),'jHzBi':function(_0x427631,_0x359b24){return _0x427631!==_0x359b24;},'CKnrP':_0x18a32b(0x265),'TuXHM':_0x18a32b(0x373),'EhhEZ':'123','sHgyP':_0x18a32b(0x285),'yBSnu':function(_0x45f3e4,_0x3074c8,_0x361ce7){return _0x45f3e4(_0x3074c8,_0x361ce7);},'dsTQs':function(_0x5ef7d1,_0x36ac56,_0x57cd00){return _0x5ef7d1(_0x36ac56,_0x57cd00);},'UzjCR':_0x18a32b(0x2be),'Bawbd':'getSigningKey','cpcje':_0x18a32b(0x266),'usyKF':'jwt\x20malformed','vKErc':function(_0x39d550,_0x2412fb){return _0x39d550(_0x2412fb);},'alYRd':_0x18a32b(0x387),'wxsQO':function(_0x24cb7d,_0x2f16f5,_0x3a5fcb){return _0x24cb7d(_0x2f16f5,_0x3a5fcb);},'PYazr':function(_0x10caad,_0x42b7cf,_0x463ef8){return _0x10caad(_0x42b7cf,_0x463ef8);},'kkRor':_0x18a32b(0x2fe),'dlttx':function(_0x322de8,_0x9728ee,_0x2939dc){return _0x322de8(_0x9728ee,_0x2939dc);},'xIFlr':function(_0x594c61,_0x2abe1e,_0x5e2147){return _0x594c61(_0x2abe1e,_0x5e2147);},'hNkeu':function(_0xdb50f4,_0x434abd,_0x482586){return _0xdb50f4(_0x434abd,_0x482586);},'gXDYC':_0x18a32b(0x3be),'hCyps':function(_0xef50d4,_0x11339c,_0x513ac6){return _0xef50d4(_0x11339c,_0x513ac6);},'KxwWB':_0x18a32b(0x24d),'wvjsD':_0x18a32b(0x223),'lDYKO':function(_0x5d45fe){return _0x5d45fe();},'LthPm':function(_0x34e0f8){return _0x34e0f8();},'ZXOfG':_0x18a32b(0x348),'pkhcL':function(_0x4e0cf0,_0x197f75,_0x579ac0){return _0x4e0cf0(_0x197f75,_0x579ac0);},'CVwjU':function(_0x3ec1d8,_0x59b342,_0x468b44){return _0x3ec1d8(_0x59b342,_0x468b44);},'AYkWA':function(_0x1bdf27,_0x4a312f,_0x1d26b1){return _0x1bdf27(_0x4a312f,_0x1d26b1);},'qRlpU':function(_0xed575e,_0x31a3de){return _0xed575e!==_0x31a3de;},'sgaAw':'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com','CNLeX':function(_0x5d2823,_0x15627d){return _0x5d2823(_0x15627d);},'PrhIp':function(_0x2483e1,_0x20f1f6){return _0x2483e1===_0x20f1f6;},'QeOeo':_0x18a32b(0x200),'wSvZg':'XAdhG','FgkWB':_0x18a32b(0x2da),'uQTrO':function(_0x5431d6,_0x1dea22){return _0x5431d6(_0x1dea22);},'sJTYG':function(_0x244d1c,_0x579bf4){return _0x244d1c!==_0x579bf4;},'grJQG':_0x18a32b(0x2df),'mFlqG':_0x18a32b(0x2c9),'BUaYh':_0x18a32b(0x24b),'eoHwQ':function(_0x5a0d12,_0x222fa7){return _0x5a0d12!==_0x222fa7;},'VNiwT':function(_0x3df582,_0x356025){return _0x3df582(_0x356025);},'ItbvW':_0x18a32b(0x2b4),'NZQCZ':_0x18a32b(0x323),'kFJtB':_0x18a32b(0x401),'HQwER':_0x18a32b(0x1f1),'hSSLZ':_0x18a32b(0x3c2),'ixmWX':_0x18a32b(0x21c),'MhTpy':'../lib/Adapters/Auth/utils','FFzNK':_0x18a32b(0x393),'LnAVE':'should\x20not\x20decode\x20invalid\x20id_token','ibAUJ':function(_0x5c2d65,_0x1bf729,_0x31d8e6){return _0x5c2d65(_0x1bf729,_0x31d8e6);},'CrEOE':_0x18a32b(0x1b7),'NPEhX':_0x18a32b(0x28b),'OGrzW':function(_0x3e9b35,_0x359f09,_0x376a37){return _0x3e9b35(_0x359f09,_0x376a37);},'jpLjr':function(_0x389ef9,_0x7c2ee3,_0x6720fc){return _0x389ef9(_0x7c2ee3,_0x6720fc);},'aUpqe':_0x18a32b(0x425),'EYmMX':_0x18a32b(0x36b),'KgIhE':function(_0x26313c,_0x5bad2a,_0x3e6faa){return _0x26313c(_0x5bad2a,_0x3e6faa);},'WNFpx':_0x18a32b(0x2ed),'PsnAs':function(_0x50f568,_0x4b6d17,_0x362313){return _0x50f568(_0x4b6d17,_0x362313);},'dIdau':'(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','poLeA':function(_0x1eb6d2,_0x5039d9,_0x313441){return _0x1eb6d2(_0x5039d9,_0x313441);},'CduZy':'(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','uppDk':function(_0x3cb7a0,_0x1c6a7b,_0x5f3fe8){return _0x3cb7a0(_0x1c6a7b,_0x5f3fe8);},'FLGnV':_0x18a32b(0x29c)},_0x1c956b=require(_0x8c2fe1[_0x18a32b(0x318)]),_0x10030e=require('jsonwebtoken'),_0x3d3579=require(_0x8c2fe1['MhTpy']);_0x8c2fe1[_0x18a32b(0x1e5)](it,_0x8c2fe1[_0x18a32b(0x336)],async()=>{const _0x315fc7=_0x18a32b;try{await _0x1c956b[_0x315fc7(0x22d)]({},{'clientId':_0x8c2fe1['uxnRA']}),_0x8c2fe1[_0x315fc7(0x3c8)](fail);}catch(_0x5d0ad2){expect(_0x5d0ad2[_0x315fc7(0x39c)])[_0x315fc7(0x253)](_0x315fc7(0x3a7));}}),it(_0x18a32b(0x41c),async()=>{const _0x102faf=_0x18a32b,_0x6f19e={'upzSj':function(_0x44dfd9,_0x29a620){return _0x44dfd9(_0x29a620);}};if(_0x8c2fe1[_0x102faf(0x300)](_0x102faf(0x283),_0x8c2fe1['satrz']))try{await _0x1c956b[_0x102faf(0x22d)]({},{'clientId':[_0x8c2fe1['uxnRA']]}),_0x8c2fe1[_0x102faf(0x2ce)](fail);}catch(_0x1e34c4){_0x8c2fe1[_0x102faf(0x232)](expect,_0x1e34c4[_0x102faf(0x39c)])[_0x102faf(0x253)](_0x102faf(0x3a7));}else _0x6f19e[_0x102faf(0x1fa)](_0x228d41,_0x29bcf2),_0x39f1d8();}),_0x8c2fe1['dsTQs'](it,_0x8c2fe1[_0x18a32b(0x2f5)],async()=>{const _0x35fc1d=_0x18a32b;try{await _0x1c956b['validateAuthData']({'id':_0x35fc1d(0x373),'token':_0x8c2fe1[_0x35fc1d(0x2b6)]},{'clientId':_0x8c2fe1[_0x35fc1d(0x2f0)]}),_0x8c2fe1[_0x35fc1d(0x3c8)](fail);}catch(_0x4bedbf){expect(_0x4bedbf['message'])[_0x35fc1d(0x253)](_0x35fc1d(0x3d5));}}),_0x8c2fe1[_0x18a32b(0x2c5)](it,'should\x20throw\x20error\x20if\x20public\x20key\x20used\x20to\x20encode\x20token\x20is\x20not\x20available',async()=>{const _0x4c8040=_0x18a32b;if(_0x8c2fe1[_0x4c8040(0x357)](_0x8c2fe1[_0x4c8040(0x2d8)],'aqUDe'))_0x8c2fe1[_0x4c8040(0x307)](_0x56a13f,_0x5d69d2[_0x4c8040(0x39c)])[_0x4c8040(0x253)](_0x4c8040(0x2df));else{const _0x280724={'header':{'kid':'789','alg':_0x8c2fe1['aLLDW']}};try{_0x8c2fe1[_0x4c8040(0x1cf)](spyOn,_0x3d3579,_0x8c2fe1[_0x4c8040(0x226)])['and'][_0x4c8040(0x3e4)](()=>_0x280724[_0x4c8040(0x259)]),await _0x1c956b['validateAuthData']({'id':'the_user_id','token':_0x4c8040(0x2a5)},{'clientId':_0x4c8040(0x313)}),fail();}catch(_0x436699){expect(_0x436699[_0x4c8040(0x39c)])[_0x4c8040(0x253)](_0x4c8040(0x40f)+_0x280724[_0x4c8040(0x259)][_0x4c8040(0x3ff)]);}}}),_0x8c2fe1[_0x18a32b(0x1fb)](it,_0x8c2fe1[_0x18a32b(0x29f)],async()=>{const _0x8b2db9=_0x18a32b,_0x193167={'wSYdD':_0x8c2fe1[_0x8b2db9(0x3bd)]};if(_0x8c2fe1[_0x8b2db9(0x1ee)](_0x8b2db9(0x243),_0x8c2fe1[_0x8b2db9(0x33a)])){const _0x3fc6f5={'iss':_0x8b2db9(0x387),'aud':'secret','exp':Date[_0x8b2db9(0x416)](),'sub':_0x8c2fe1[_0x8b2db9(0x35a)]},_0x51162d={'header':{'kid':_0x8c2fe1[_0x8b2db9(0x229)],'alg':'RS256'}},_0x3118f4={'kid':_0x8c2fe1[_0x8b2db9(0x229)],'rsaPublicKey':_0x8c2fe1[_0x8b2db9(0x2b8)]};_0x8c2fe1[_0x8b2db9(0x350)](spyOn,_0x3d3579,'getHeaderFromToken')[_0x8b2db9(0x245)][_0x8b2db9(0x3e4)](()=>_0x51162d['header']),spyOn(_0x3d3579,_0x8b2db9(0x321))['and'][_0x8b2db9(0x408)](_0x3118f4),_0x8c2fe1[_0x8b2db9(0x1a9)](spyOn,_0x10030e,_0x8c2fe1['UzjCR'])[_0x8b2db9(0x245)][_0x8b2db9(0x3e4)](()=>_0x3fc6f5);const _0x8318d9=await _0x1c956b['validateAuthData']({'id':'the_user_id','token':_0x8b2db9(0x2a5)},{'clientId':_0x8c2fe1['uxnRA']});expect(_0x8318d9)[_0x8b2db9(0x1db)](_0x3fc6f5),expect(_0x10030e[_0x8b2db9(0x2be)][_0x8b2db9(0x3a3)]['first']()[_0x8b2db9(0x3e7)][0x2]['algorithms'])['toEqual'](_0x51162d[_0x8b2db9(0x259)]['alg']);}else _0x170b1c[_0x8b2db9(0x1b8)](this,_0x193167[_0x8b2db9(0x23c)]);}),it(_0x18a32b(0x2ea),async()=>{const _0x281c01=_0x18a32b,_0x64cba6={'header':{'kid':_0x8c2fe1[_0x281c01(0x229)],'alg':_0x8c2fe1[_0x281c01(0x3a1)]}},_0x1ddd91={'kid':_0x8c2fe1[_0x281c01(0x229)],'rsaPublicKey':_0x8c2fe1[_0x281c01(0x2b8)]};_0x8c2fe1[_0x281c01(0x1a9)](spyOn,_0x3d3579,_0x8c2fe1[_0x281c01(0x226)])[_0x281c01(0x245)][_0x281c01(0x3e4)](()=>_0x64cba6),spyOn(_0x3d3579,_0x8c2fe1[_0x281c01(0x2a6)])[_0x281c01(0x245)][_0x281c01(0x408)](_0x1ddd91);try{if(_0x8c2fe1[_0x281c01(0x250)]==='tqGon')await _0x1c956b[_0x281c01(0x22d)]({'id':_0x8c2fe1['TuXHM'],'token':_0x8c2fe1[_0x281c01(0x2b6)]},{'clientId':'secret'}),fail();else throw _0x32701b['data'];}catch(_0x354451){expect(_0x354451[_0x281c01(0x39c)])[_0x281c01(0x253)](_0x8c2fe1[_0x281c01(0x3ec)]);}}),it(_0x8c2fe1['NPEhX'],async()=>{const _0xa65099=_0x18a32b;try{await _0x1c956b['validateAuthData']({'id':_0xa65099(0x373),'token':_0x8c2fe1[_0xa65099(0x2b6)]},{'clientId':[_0xa65099(0x313)]}),_0x8c2fe1[_0xa65099(0x2ce)](fail);}catch(_0x3f2ac4){_0x8c2fe1[_0xa65099(0x217)](expect,_0x3f2ac4[_0xa65099(0x39c)])[_0xa65099(0x253)](_0xa65099(0x3d5));}}),_0x8c2fe1[_0x18a32b(0x37d)](it,_0x18a32b(0x36e),async()=>{const _0x3af1e0=_0x18a32b,_0x3a8b3f={'iss':_0x8c2fe1[_0x3af1e0(0x1d8)],'aud':_0x8c2fe1[_0x3af1e0(0x2f0)],'exp':Date['now'](),'sub':_0x3af1e0(0x373)},_0x399df5={'header':{'kid':_0x8c2fe1['EhhEZ'],'alg':_0x8c2fe1['aLLDW']}},_0xe31055={'kid':_0x8c2fe1[_0x3af1e0(0x229)],'rsaPublicKey':'the_rsa_public_key'};_0x8c2fe1[_0x3af1e0(0x1a4)](spyOn,_0x3d3579,_0x3af1e0(0x1bb))['and']['callFake'](()=>_0x399df5),_0x8c2fe1[_0x3af1e0(0x3ea)](spyOn,_0x3d3579,_0x8c2fe1[_0x3af1e0(0x2a6)])['and'][_0x3af1e0(0x408)](_0xe31055),spyOn(_0x10030e,_0x8c2fe1['UzjCR'])['and'][_0x3af1e0(0x3e4)](()=>_0x3a8b3f);const _0xa447ab=await _0x1c956b['validateAuthData']({'id':_0x8c2fe1['TuXHM'],'token':_0x8c2fe1[_0x3af1e0(0x2b6)]},{'clientId':_0x3af1e0(0x313)});expect(_0xa447ab)['toEqual'](_0x3a8b3f);}),_0x8c2fe1[_0x18a32b(0x2f1)](it,_0x18a32b(0x368),async()=>{const _0x12c7aa=_0x18a32b;if(_0x8c2fe1[_0x12c7aa(0x1c5)]!==_0x12c7aa(0x2fe))return _0xbdcb2e[_0x12c7aa(0x3a6)]();else{const _0x5b0e83={'iss':'https://appleid.apple.com','aud':_0x12c7aa(0x313),'exp':Date[_0x12c7aa(0x416)](),'sub':_0x12c7aa(0x373)},_0x361217={'header':{'kid':_0x8c2fe1[_0x12c7aa(0x229)],'alg':_0x12c7aa(0x351)}},_0x3f12d4={'kid':'123','rsaPublicKey':'the_rsa_public_key'};_0x8c2fe1[_0x12c7aa(0x3b1)](spyOn,_0x3d3579,_0x8c2fe1['OwfBi'])[_0x12c7aa(0x245)][_0x12c7aa(0x3e4)](()=>_0x361217),_0x8c2fe1['xIFlr'](spyOn,_0x3d3579,_0x12c7aa(0x321))[_0x12c7aa(0x245)][_0x12c7aa(0x408)](_0x3f12d4),spyOn(_0x10030e,_0x8c2fe1[_0x12c7aa(0x3e9)])[_0x12c7aa(0x245)]['callFake'](()=>_0x5b0e83);const _0xce8ca2=await _0x1c956b[_0x12c7aa(0x22d)]({'id':'the_user_id','token':_0x8c2fe1[_0x12c7aa(0x2b6)]},{'clientId':[_0x12c7aa(0x313)]});_0x8c2fe1[_0x12c7aa(0x217)](expect,_0xce8ca2)[_0x12c7aa(0x1db)](_0x5b0e83);}}),it(_0x8c2fe1[_0x18a32b(0x1a5)],async()=>{const _0x2b499d=_0x18a32b,_0x42b673={'iss':_0x2b499d(0x387),'aud':_0x2b499d(0x313),'exp':Date[_0x2b499d(0x416)](),'sub':_0x2b499d(0x373)},_0x2c5493={'header':{'kid':_0x2b499d(0x3fd),'alg':_0x8c2fe1[_0x2b499d(0x3a1)]}},_0x19dae4={'kid':_0x8c2fe1[_0x2b499d(0x229)],'rsaPublicKey':_0x8c2fe1[_0x2b499d(0x2b8)]};_0x8c2fe1[_0x2b499d(0x2c5)](spyOn,_0x3d3579,_0x8c2fe1[_0x2b499d(0x226)])['and'][_0x2b499d(0x3e4)](()=>_0x2c5493),_0x8c2fe1[_0x2b499d(0x1a4)](spyOn,_0x3d3579,_0x8c2fe1['Bawbd'])[_0x2b499d(0x245)]['resolveTo'](_0x19dae4),spyOn(_0x10030e,_0x2b499d(0x2be))['and'][_0x2b499d(0x3e4)](()=>_0x42b673);const _0x45d2cf=await _0x1c956b['validateAuthData']({'id':_0x8c2fe1[_0x2b499d(0x35a)],'token':'the_token'},{'clientId':[_0x2b499d(0x313),_0x2b499d(0x2cc)]});expect(_0x45d2cf)[_0x2b499d(0x1db)](_0x42b673);}),_0x8c2fe1[_0x18a32b(0x1e5)](it,_0x8c2fe1[_0x18a32b(0x344)],async()=>{const _0x3a4a30=_0x18a32b,_0x32f749={'iss':_0x8c2fe1[_0x3a4a30(0x1be)],'sub':_0x3a4a30(0x373)},_0x3c3071={'header':{'kid':_0x8c2fe1[_0x3a4a30(0x229)],'alg':_0x3a4a30(0x351)}},_0x5433c1={'kid':_0x8c2fe1[_0x3a4a30(0x229)],'rsaPublicKey':_0x8c2fe1[_0x3a4a30(0x2b8)]};_0x8c2fe1['XdSos'](spyOn,_0x3d3579,_0x8c2fe1[_0x3a4a30(0x226)])[_0x3a4a30(0x245)][_0x3a4a30(0x3e4)](()=>_0x3c3071),_0x8c2fe1['hCyps'](spyOn,_0x3d3579,_0x3a4a30(0x321))[_0x3a4a30(0x245)][_0x3a4a30(0x408)](_0x5433c1),spyOn(_0x10030e,_0x8c2fe1[_0x3a4a30(0x3e9)])[_0x3a4a30(0x245)][_0x3a4a30(0x3e4)](()=>_0x32f749);try{await _0x1c956b['validateAuthData']({'id':'the_user_id','token':_0x8c2fe1[_0x3a4a30(0x2b6)]},{'clientId':_0x8c2fe1[_0x3a4a30(0x2f0)]}),fail();}catch(_0x56ec75){expect(_0x56ec75['message'])['toBe']('id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com');}}),_0x8c2fe1[_0x18a32b(0x269)](xit,_0x8c2fe1[_0x18a32b(0x1b1)],async()=>{const _0x4a2258=_0x18a32b;if(_0x8c2fe1['jHzBi'](_0x4a2258(0x2eb),_0x4a2258(0x1f5))){const _0x96e853={'iss':_0x8c2fe1[_0x4a2258(0x1be)],'sub':_0x8c2fe1[_0x4a2258(0x35a)]},_0xb4e71c={'header':{'kid':_0x8c2fe1[_0x4a2258(0x229)],'alg':_0x8c2fe1[_0x4a2258(0x3a1)]}},_0x4f8d2f={'kid':_0x8c2fe1[_0x4a2258(0x229)],'rsaPublicKey':_0x8c2fe1[_0x4a2258(0x2b8)]};spyOn(_0x3d3579,_0x8c2fe1[_0x4a2258(0x226)])[_0x4a2258(0x245)][_0x4a2258(0x3e4)](()=>_0xb4e71c),_0x8c2fe1['PYazr'](spyOn,_0x3d3579,_0x8c2fe1[_0x4a2258(0x2a6)])[_0x4a2258(0x245)]['resolveTo'](_0x4f8d2f),_0x8c2fe1[_0x4a2258(0x350)](spyOn,_0x10030e,_0x8c2fe1['UzjCR'])[_0x4a2258(0x245)][_0x4a2258(0x3e4)](()=>_0x96e853);try{await _0x1c956b[_0x4a2258(0x22d)]({'id':'INSERT\x20ID\x20HERE','token':_0x8c2fe1[_0x4a2258(0x2fa)]},{'clientId':[_0x8c2fe1[_0x4a2258(0x386)]]}),_0x8c2fe1['lDYKO'](fail);}catch(_0x5c1fd9){expect(_0x5c1fd9[_0x4a2258(0x39c)])[_0x4a2258(0x253)](_0x4a2258(0x1e7));}}else return _0x40041b(_0x1acb1a[_0x4a2258(0x419)]());}),it(_0x18a32b(0x281),async()=>{const _0x12c91b=_0x18a32b,_0x26a4cf={'BMbCG':function(_0x1673ea,_0x491bbf){const _0x33bf64=_0x1429;return _0x8c2fe1[_0x33bf64(0x307)](_0x1673ea,_0x491bbf);},'GQQOf':_0x12c91b(0x394)};if(_0x12c91b(0x348)!==_0x8c2fe1[_0x12c91b(0x389)])_0x26a4cf[_0x12c91b(0x286)](_0x1d357d,_0x388239[_0x12c91b(0x39c)])[_0x12c91b(0x253)](_0x26a4cf[_0x12c91b(0x1a1)]);else{const _0x2d2119={'iss':_0x12c91b(0x3be),'sub':_0x12c91b(0x373)},_0x294923={'header':{'kid':_0x12c91b(0x3fd),'alg':'RS256'}},_0x55aeb5={'kid':_0x12c91b(0x3fd),'rsaPublicKey':_0x8c2fe1[_0x12c91b(0x2b8)]};_0x8c2fe1[_0x12c91b(0x37f)](spyOn,_0x3d3579,_0x8c2fe1[_0x12c91b(0x226)])[_0x12c91b(0x245)][_0x12c91b(0x3e4)](()=>_0x294923),_0x8c2fe1[_0x12c91b(0x22b)](spyOn,_0x3d3579,_0x12c91b(0x321))[_0x12c91b(0x245)]['resolveTo'](_0x55aeb5),_0x8c2fe1[_0x12c91b(0x30f)](spyOn,_0x10030e,'verify')['and'][_0x12c91b(0x3e4)](()=>_0x2d2119);try{_0x8c2fe1[_0x12c91b(0x3eb)](_0x12c91b(0x3cb),_0x12c91b(0x3cb))?(_0x8c2fe1['EZQTx'](_0x122590,_0x426e08),_0x8c2fe1[_0x12c91b(0x38a)](_0x361899)):(await _0x1c956b[_0x12c91b(0x22d)]({'id':'INSERT\x20ID\x20HERE','token':_0x8c2fe1[_0x12c91b(0x2fa)]},{'clientId':_0x8c2fe1[_0x12c91b(0x386)]}),fail());}catch(_0x58e5d7){expect(_0x58e5d7['message'])[_0x12c91b(0x253)](_0x8c2fe1[_0x12c91b(0x41e)]);}}}),_0x8c2fe1[_0x18a32b(0x316)](xit,_0x8c2fe1[_0x18a32b(0x2a3)],async()=>{const _0x3a124b=_0x18a32b;if(_0x8c2fe1[_0x3a124b(0x23d)](_0x8c2fe1[_0x3a124b(0x356)],_0x8c2fe1[_0x3a124b(0x422)]))_0x8c2fe1[_0x3a124b(0x309)](_0x38738a,_0x5ddf95[_0x3a124b(0x39c)])[_0x3a124b(0x253)](_0x3a124b(0x3b3));else try{await _0x1c956b['validateAuthData']({'id':_0x8c2fe1['FgkWB'],'token':_0x3a124b(0x24b)},{'clientId':_0x8c2fe1['uxnRA']}),fail();}catch(_0x5cf1c7){expect(_0x5cf1c7['message'])[_0x3a124b(0x253)]('jwt\x20audience\x20invalid.\x20expected:\x20secret');}}),_0x8c2fe1['poLeA'](xit,_0x8c2fe1[_0x18a32b(0x3ad)],async()=>{const _0x387097=_0x18a32b,_0x654416={'RYQXq':function(_0x557a0e,_0x48185a){const _0x297993=_0x1429;return _0x8c2fe1[_0x297993(0x268)](_0x557a0e,_0x48185a);},'imlZh':function(_0x5214b7,_0x1fcd5d){return _0x5214b7(_0x1fcd5d);},'VioUf':function(_0x4e6cce,_0x11a037){return _0x4e6cce(_0x11a037);},'DAHdg':function(_0x564d6d){const _0x3f767e=_0x1429;return _0x8c2fe1[_0x3f767e(0x38a)](_0x564d6d);},'hXoMh':function(_0x165bb8,_0x195dbc){const _0x5e8f3e=_0x1429;return _0x8c2fe1[_0x5e8f3e(0x217)](_0x165bb8,_0x195dbc);}};try{if(_0x8c2fe1[_0x387097(0x1d0)]('QcKBp',_0x387097(0x215)))await _0x1c956b[_0x387097(0x22d)]({'id':_0x8c2fe1[_0x387097(0x21b)],'token':'INSERT\x20APPLE\x20TOKEN\x20HERE'},{'clientId':[_0x387097(0x313)]}),fail();else{const _0x50e137={'GMuQZ':function(_0x1c541e,_0x5b674d){const _0x1a7805=_0x387097;return _0x654416[_0x1a7805(0x24f)](_0x1c541e,_0x5b674d);},'oqTsg':function(_0x2122e7){return _0x654416['DAHdg'](_0x2122e7);}};let _0x396362;_0x654416[_0x387097(0x40e)](_0x4a2e89,(_0x5c0759,_0x5b014e,_0x59677a)=>{const _0x756a2c=_0x387097;_0x3b0be2(_0x5c0759)[_0x756a2c(0x253)](null);const _0x3c43a0=_0x59677a;_0x654416[_0x756a2c(0x359)](_0x577d01,_0x3c43a0[_0x756a2c(0x377)])[_0x756a2c(0x34a)]['toBeNull'](),_0x3a0fa6(_0x3c43a0['objectId'])[_0x756a2c(0x34a)][_0x756a2c(0x207)](),_0x396362=_0x3c43a0[_0x756a2c(0x377)],_0x654416[_0x756a2c(0x26c)](_0x3e8f7e,(_0x58b7bd,_0x214aec,_0xda6b70)=>{const _0x519a2e=_0x756a2c;_0xc754f0(_0x58b7bd)[_0x519a2e(0x253)](null);const _0x2f23f1=_0xda6b70;_0x50e137[_0x519a2e(0x3d6)](_0x291243,_0x2f23f1[_0x519a2e(0x377)])[_0x519a2e(0x34a)][_0x519a2e(0x2ec)](),_0x24b436(_0x2f23f1[_0x519a2e(0x377)])[_0x519a2e(0x34a)][_0x519a2e(0x207)](),_0x22a8cf(_0x2f23f1[_0x519a2e(0x377)])[_0x519a2e(0x253)](_0x396362),_0x50e137[_0x519a2e(0x372)](_0x3ffdc3);});});}}catch(_0xc7e946){_0x8c2fe1['CNLeX'](expect,_0xc7e946[_0x387097(0x39c)])[_0x387097(0x253)](_0x8c2fe1[_0x387097(0x202)]);}}),_0x8c2fe1[_0x18a32b(0x278)](xit,_0x8c2fe1[_0x18a32b(0x1f2)],async()=>{const _0xecf246=_0x18a32b,_0x2eb0cd={'pFkVQ':function(_0x1ec86e,_0x4daca8){return _0x1ec86e(_0x4daca8);},'AzyHg':_0x8c2fe1[_0xecf246(0x202)]};try{await _0x1c956b['validateAuthData']({'id':_0x8c2fe1[_0xecf246(0x241)],'token':_0x8c2fe1[_0xecf246(0x3af)]},{'clientId':_0xecf246(0x223)}),fail();}catch(_0x2b9665){_0x8c2fe1[_0xecf246(0x2bf)](_0xecf246(0x352),'FOckk')?_0x8c2fe1[_0xecf246(0x417)](expect,_0x2b9665['message'])[_0xecf246(0x253)](_0x8c2fe1['ItbvW']):_0x2eb0cd[_0xecf246(0x34f)](_0x37e6c6,_0x409e1c['message'])[_0xecf246(0x253)](_0x2eb0cd[_0xecf246(0x3ce)]);}}),_0x8c2fe1[_0x18a32b(0x2f1)](it,_0x18a32b(0x28d),async()=>{const _0x4df072=_0x18a32b,_0x521047={'gdDWJ':function(_0x18c2ad,_0x501a4e){const _0x19f585=_0x1429;return _0x8c2fe1[_0x19f585(0x309)](_0x18c2ad,_0x501a4e);}},_0x4032ba={'iss':_0x8c2fe1[_0x4df072(0x1d8)],'aud':_0x8c2fe1[_0x4df072(0x2b3)],'sub':_0x8c2fe1[_0x4df072(0x32f)]},_0x1c1202={'header':{'kid':_0x4df072(0x3fd),'alg':_0x4df072(0x351)}},_0x398f73={'kid':_0x8c2fe1['EhhEZ'],'rsaPublicKey':_0x4df072(0x285)};spyOn(_0x3d3579,_0x4df072(0x1bb))[_0x4df072(0x245)][_0x4df072(0x3e4)](()=>_0x1c1202),spyOn(_0x3d3579,'getSigningKey')['and'][_0x4df072(0x408)](_0x398f73),spyOn(_0x10030e,_0x4df072(0x2be))[_0x4df072(0x245)]['callFake'](()=>_0x4032ba);try{await _0x1c956b['validateAuthData']({'id':_0x8c2fe1[_0x4df072(0x35a)],'token':_0x8c2fe1['AkxEv']},{'clientId':_0x8c2fe1['uxnRA']}),fail();}catch(_0x1edf45){_0x8c2fe1[_0x4df072(0x32e)]===_0x8c2fe1[_0x4df072(0x338)]?_0x521047[_0x4df072(0x3a0)](_0x86680b,typeof _0x1c3738)[_0x4df072(0x253)](_0x4df072(0x3dc)):_0x8c2fe1['EZQTx'](expect,_0x1edf45['message'])[_0x4df072(0x253)]('auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');}});}),describe(_0x5e6db5(0x2f8),()=>{const _0x5e40eb=_0x5e6db5,_0x55ef8c={'OwtYz':function(_0x6b2bbc,_0x400687){return _0x6b2bbc(_0x400687);},'prTwj':function(_0x5ee770,_0x350e54,_0x244d17){return _0x5ee770(_0x350e54,_0x244d17);},'yEApW':'../lib/Adapters/Auth/httpsRequest','NFdEy':_0x5e40eb(0x239)},_0x1f691f=_0x55ef8c['OwtYz'](require,_0x55ef8c['yEApW']);_0x55ef8c[_0x5e40eb(0x297)](it,_0x55ef8c[_0x5e40eb(0x2a0)],async()=>{const _0x1bcbb4=_0x5e40eb;await _0x55ef8c[_0x1bcbb4(0x2e4)](reconfigureServer,{'auth':{'phantauth':{'enableInsecureAuth':!![]}}});const _0x8efedf={'id':_0x1bcbb4(0x2a7),'access_token':_0x1bcbb4(0x3e6)},{adapter:_0x46f3ac}=authenticationLoader[_0x1bcbb4(0x224)](_0x1bcbb4(0x23b),{});_0x55ef8c[_0x1bcbb4(0x297)](spyOn,_0x1f691f,_0x1bcbb4(0x2c3))[_0x1bcbb4(0x245)][_0x1bcbb4(0x3e4)](()=>Promise[_0x1bcbb4(0x3a6)]({'sub':_0x1bcbb4(0x3fa)}));try{await _0x46f3ac['validateAuthData'](_0x8efedf),fail();}catch(_0x3f3dbf){_0x55ef8c[_0x1bcbb4(0x2e4)](expect,_0x3f3dbf[_0x1bcbb4(0x39c)])[_0x1bcbb4(0x253)](_0x1bcbb4(0x3c4));}});}),describe(_0x5e6db5(0x1ed),()=>{const _0x4c2f4e=_0x5e6db5,_0x3c05c0={'ygQcM':_0x4c2f4e(0x1da),'CoTpX':function(_0x601e32,_0x4c4dec){return _0x601e32!==_0x4c4dec;},'zejpj':function(_0x2d56d7,_0x391754){return _0x2d56d7(_0x391754);},'ThQYg':_0x4c2f4e(0x1b0),'imzcC':function(_0x31c879){return _0x31c879();},'Tdmmo':_0x4c2f4e(0x373),'liKBM':_0x4c2f4e(0x2a5),'mtiba':function(_0x5135bc){return _0x5135bc();},'awaRk':function(_0x4b75ca,_0x53517c){return _0x4b75ca(_0x53517c);},'aTost':_0x4c2f4e(0x3d5),'xgLhu':'secret','Pzrgw':'CzxYL','QCizP':_0x4c2f4e(0x2a4),'vVOlQ':_0x4c2f4e(0x3fd),'TWXkT':function(_0x3a75b6,_0x22ab6e,_0x1e0179){return _0x3a75b6(_0x22ab6e,_0x1e0179);},'KFxtP':_0x4c2f4e(0x321),'yUZTG':function(_0x3ec2a9,_0x149575,_0x19d590){return _0x3ec2a9(_0x149575,_0x19d590);},'xVWob':_0x4c2f4e(0x1bb),'SsFEE':function(_0x1ea20a,_0x5d8db9){return _0x1ea20a!==_0x5d8db9;},'wCmaJ':_0x4c2f4e(0x329),'wTPXF':_0x4c2f4e(0x351),'SphEW':_0x4c2f4e(0x2be),'pyDJa':'the_rsa_public_key','RfQWV':function(_0x106fe0,_0x216f5b,_0x121765){return _0x106fe0(_0x216f5b,_0x121765);},'VDvCE':'secret\x20123','HILPd':function(_0x4a4042,_0x306dbc){return _0x4a4042(_0x306dbc);},'Sxitl':'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://www.facebook.com\x20|\x20from:\x20https://not.facebook.com','sARyg':function(_0x1c682d,_0x4ba28a,_0x459cc2){return _0x1c682d(_0x4ba28a,_0x459cc2);},'zesez':function(_0x530835,_0x4ee6fa,_0x349af6){return _0x530835(_0x4ee6fa,_0x349af6);},'SZfZz':_0x4c2f4e(0x2da),'yYvnv':function(_0x35bd2c,_0x1b3822,_0x3b09a8){return _0x35bd2c(_0x1b3822,_0x3b09a8);},'dTbJW':function(_0x2e07bb){return _0x2e07bb();},'eiCAH':_0x4c2f4e(0x2e7),'IEtwS':_0x4c2f4e(0x2ab),'ukRcK':_0x4c2f4e(0x2c9),'ABfoh':_0x4c2f4e(0x41f),'rStdg':function(_0x2a0bdb){return _0x2a0bdb();},'gnZbY':function(_0x476651){return _0x476651();},'ffZLL':_0x4c2f4e(0x3b4),'myXGz':'invalid_client_id','vUScq':_0x4c2f4e(0x401),'Hvuev':_0x4c2f4e(0x2b4),'qbhIT':'jsonwebtoken','qWqME':'../lib/Adapters/Auth/utils','nMSbk':function(_0x122750,_0x347730,_0x590411){return _0x122750(_0x347730,_0x590411);},'yyAjm':'should\x20throw\x20error\x20if\x20public\x20key\x20used\x20to\x20encode\x20token\x20is\x20not\x20available','oyoBT':_0x4c2f4e(0x371),'OsgqF':function(_0x1681cf,_0x192ce1,_0x5dbfaf){return _0x1681cf(_0x192ce1,_0x5dbfaf);},'bjisx':'should\x20not\x20verify\x20invalid\x20id_token','HKmCR':function(_0x57c89a,_0x4bf9d7){return _0x57c89a(_0x4bf9d7);},'jAsrL':_0x4c2f4e(0x23a),'UisYo':function(_0x532875,_0x1fc0af){return _0x532875(_0x1fc0af);},'wATKh':'c521a272-2ac2-4d8b-b5ed-ea250336d8b1','yGAwq':_0x4c2f4e(0x1ba),'jinLD':_0x4c2f4e(0x2cd),'nSHXG':_0x4c2f4e(0x24e),'RoWvk':'(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer','lldCI':_0x4c2f4e(0x399),'OKXjn':_0x4c2f4e(0x1f3),'XYoto':'should\x20throw\x20error\x20with\x20with\x20invalid\x20user\x20id\x20(facebook.com)'},_0x58b73e=require('../lib/Adapters/Auth/facebook'),_0x53ad6d=require(_0x3c05c0['qbhIT']),_0xa3ae1e=require(_0x3c05c0[_0x4c2f4e(0x39a)]);_0x3c05c0[_0x4c2f4e(0x3b7)](xit,_0x4c2f4e(0x393),async()=>{const _0x3f9520=_0x4c2f4e,_0xba7278={'fjJhR':function(_0x567419){return _0x567419();},'EgiMT':function(_0xba44c4,_0x387736){return _0xba44c4(_0x387736);},'aVCiT':_0x3f9520(0x31b),'JdTim':_0x3c05c0[_0x3f9520(0x3a4)],'LJCFV':function(_0x3198d5){return _0x3198d5();}};try{await _0x58b73e[_0x3f9520(0x22d)]({},{'clientId':_0x3f9520(0x313)}),fail();}catch(_0x4b7069){if(_0x3c05c0['CoTpX'](_0x3f9520(0x3d8),'EkrJa'))_0x3c05c0['zejpj'](expect,_0x4b7069[_0x3f9520(0x39c)])[_0x3f9520(0x253)](_0x3c05c0[_0x3f9520(0x1a8)]);else{if(!_0xe884ac){_0x5a1cb4(_0x3f9520(0x34d)),_0xba7278[_0x3f9520(0x25b)](_0x3c2a05);return;}_0xba7278['EgiMT'](_0x43020a,_0x136052[_0x3f9520(0x2c3)](_0xba7278[_0x3f9520(0x242)]))[_0x3f9520(0x1db)](_0xba7278[_0x3f9520(0x2a1)]),_0xba7278[_0x3f9520(0x26a)](_0x1121bf);}}}),_0x3c05c0['nMSbk'](xit,_0x4c2f4e(0x41c),async()=>{const _0x29a7bb=_0x4c2f4e;try{await _0x58b73e['validateAuthData']({},{'clientId':[_0x29a7bb(0x313)]}),_0x3c05c0['imzcC'](fail);}catch(_0x233836){expect(_0x233836['message'])[_0x29a7bb(0x253)](_0x3c05c0[_0x29a7bb(0x1a8)]);}}),_0x3c05c0[_0x4c2f4e(0x3b7)](it,'should\x20not\x20decode\x20invalid\x20id_token',async()=>{const _0x25b309=_0x4c2f4e;try{if(_0x25b309(0x28e)!==_0x25b309(0x28e))return _0x55494b(_0x37c17a[_0x25b309(0x419)]());else await _0x58b73e[_0x25b309(0x22d)]({'id':_0x3c05c0['Tdmmo'],'token':_0x3c05c0[_0x25b309(0x421)]},{'clientId':_0x25b309(0x313)}),_0x3c05c0[_0x25b309(0x1f8)](fail);}catch(_0x1bb38a){_0x3c05c0[_0x25b309(0x1bc)](expect,_0x1bb38a['message'])['toBe'](_0x3c05c0[_0x25b309(0x1af)]);}}),it(_0x3c05c0['yyAjm'],async()=>{const _0x5eea0a=_0x4c2f4e,_0x3902c1={'Oilyf':_0x5eea0a(0x406)},_0x2fa89e={'header':{'kid':_0x5eea0a(0x220),'alg':_0x5eea0a(0x351)}};try{spyOn(_0xa3ae1e,_0x5eea0a(0x1bb))['and'][_0x5eea0a(0x3e4)](()=>_0x2fa89e[_0x5eea0a(0x259)]),await _0x58b73e['validateAuthData']({'id':_0x3c05c0[_0x5eea0a(0x2b5)],'token':_0x5eea0a(0x2a5)},{'clientId':_0x3c05c0['xgLhu']}),_0x3c05c0[_0x5eea0a(0x1f8)](fail);}catch(_0x195eaf){if(_0x5eea0a(0x284)===_0x3c05c0[_0x5eea0a(0x390)])expect(_0x195eaf['message'])['toBe'](_0x5eea0a(0x40f)+_0x2fa89e[_0x5eea0a(0x259)]['kid']);else return _0x3902c1[_0x5eea0a(0x2e2)];}}),_0x3c05c0[_0x4c2f4e(0x1bc)](it_id,_0x3c05c0[_0x4c2f4e(0x346)])(it)(_0x4c2f4e(0x37c),async()=>{const _0x4ebccc=_0x4c2f4e,_0x55717b={'iss':_0x3c05c0['QCizP'],'aud':_0x3c05c0['xgLhu'],'exp':Date['now'](),'sub':_0x3c05c0[_0x4ebccc(0x2b5)]},_0x62ecdf={'header':{'kid':_0x3c05c0[_0x4ebccc(0x41a)],'alg':_0x4ebccc(0x351)}},_0x57d9f0={'kid':_0x4ebccc(0x3fd),'rsaPublicKey':_0x4ebccc(0x285)};_0x3c05c0[_0x4ebccc(0x3ef)](spyOn,_0xa3ae1e,_0x4ebccc(0x1bb))[_0x4ebccc(0x245)][_0x4ebccc(0x3e4)](()=>_0x62ecdf[_0x4ebccc(0x259)]),_0x3c05c0[_0x4ebccc(0x3ef)](spyOn,_0xa3ae1e,_0x3c05c0[_0x4ebccc(0x2af)])[_0x4ebccc(0x245)][_0x4ebccc(0x408)](_0x57d9f0),_0x3c05c0['yUZTG'](spyOn,_0x53ad6d,_0x4ebccc(0x2be))['and'][_0x4ebccc(0x3e4)](()=>_0x55717b);const _0x26920d=await _0x58b73e[_0x4ebccc(0x22d)]({'id':_0x3c05c0[_0x4ebccc(0x2b5)],'token':_0x3c05c0[_0x4ebccc(0x421)]},{'clientId':_0x3c05c0[_0x4ebccc(0x3e3)]});_0x3c05c0[_0x4ebccc(0x1bc)](expect,_0x26920d)[_0x4ebccc(0x1db)](_0x55717b),expect(_0x53ad6d[_0x4ebccc(0x2be)]['calls'][_0x4ebccc(0x31d)]()[_0x4ebccc(0x3e7)][0x2]['algorithms'])['toEqual'](_0x62ecdf[_0x4ebccc(0x259)]['alg']);}),_0x3c05c0['OsgqF'](it,_0x3c05c0['bjisx'],async()=>{const _0x913716=_0x4c2f4e,_0x3f99b1={'baKFn':function(_0x56e207,_0x44703e){return _0x56e207(_0x44703e);}},_0x51a7bd={'header':{'kid':'123','alg':_0x913716(0x351)}},_0x3cd93f={'kid':_0x913716(0x3fd),'rsaPublicKey':_0x913716(0x285)};spyOn(_0xa3ae1e,_0x3c05c0[_0x913716(0x388)])[_0x913716(0x245)][_0x913716(0x3e4)](()=>_0x51a7bd),spyOn(_0xa3ae1e,_0x913716(0x321))[_0x913716(0x245)][_0x913716(0x408)](_0x3cd93f);try{await _0x58b73e[_0x913716(0x22d)]({'id':_0x913716(0x373),'token':'the_token'},{'clientId':_0x3c05c0[_0x913716(0x3e3)]}),fail();}catch(_0x205b08){_0x3c05c0[_0x913716(0x238)]('tGiQn','tGiQn')?_0x3f99b1['baKFn'](_0x1db6ec,_0x3e6935[_0x913716(0x39c)])[_0x913716(0x253)](_0x913716(0x2b4)):_0x3c05c0[_0x913716(0x355)](expect,_0x205b08[_0x913716(0x39c)])['toBe'](_0x913716(0x251));}}),it(_0x4c2f4e(0x28b),async()=>{const _0x56175b=_0x4c2f4e;try{await _0x58b73e[_0x56175b(0x22d)]({'id':_0x3c05c0[_0x56175b(0x2b5)],'token':_0x3c05c0['liKBM']},{'clientId':[_0x56175b(0x313)]}),fail();}catch(_0x3120af){_0x3c05c0[_0x56175b(0x27c)]===_0x56175b(0x329)?_0x3c05c0[_0x56175b(0x355)](expect,_0x3120af[_0x56175b(0x39c)])[_0x56175b(0x253)](_0x3c05c0['aTost']):_0x2c2747[_0x56175b(0x1b8)](this,null);}}),_0x3c05c0[_0x4c2f4e(0x1ae)](it_id,_0x3c05c0['jAsrL'])(it)(_0x4c2f4e(0x2c1),async()=>{const _0x3b8312=_0x4c2f4e,_0x594290={'iss':_0x3b8312(0x2a4),'aud':_0x3c05c0[_0x3b8312(0x3e3)],'exp':Date['now'](),'sub':_0x3c05c0[_0x3b8312(0x2b5)]},_0x590607={'header':{'kid':_0x3c05c0[_0x3b8312(0x41a)],'alg':_0x3b8312(0x351)}},_0x398b4e={'kid':_0x3b8312(0x3fd),'rsaPublicKey':_0x3b8312(0x285)};spyOn(_0xa3ae1e,_0x3b8312(0x1bb))['and'][_0x3b8312(0x3e4)](()=>_0x590607),spyOn(_0xa3ae1e,_0x3b8312(0x321))[_0x3b8312(0x245)]['resolveTo'](_0x398b4e),spyOn(_0x53ad6d,_0x3b8312(0x2be))[_0x3b8312(0x245)][_0x3b8312(0x3e4)](()=>_0x594290);const _0x49d26a=await _0x58b73e[_0x3b8312(0x22d)]({'id':'the_user_id','token':_0x3c05c0['liKBM']},{'clientId':_0x3b8312(0x313)});expect(_0x49d26a)['toEqual'](_0x594290);}),_0x3c05c0[_0x4c2f4e(0x209)](it_id,_0x3c05c0['wATKh'])(it)(_0x4c2f4e(0x3c0),async()=>{const _0x24d19f=_0x4c2f4e,_0x4061e3={'iss':_0x3c05c0[_0x24d19f(0x294)],'aud':_0x24d19f(0x313),'exp':Date[_0x24d19f(0x416)](),'sub':_0x3c05c0[_0x24d19f(0x2b5)]},_0xac2247={'header':{'kid':_0x3c05c0[_0x24d19f(0x41a)],'alg':_0x3c05c0[_0x24d19f(0x292)]}},_0x42559d={'kid':'123','rsaPublicKey':'the_rsa_public_key'};spyOn(_0xa3ae1e,_0x3c05c0[_0x24d19f(0x388)])[_0x24d19f(0x245)][_0x24d19f(0x3e4)](()=>_0xac2247),spyOn(_0xa3ae1e,_0x3c05c0[_0x24d19f(0x2af)])[_0x24d19f(0x245)][_0x24d19f(0x408)](_0x42559d),spyOn(_0x53ad6d,_0x3c05c0[_0x24d19f(0x3de)])[_0x24d19f(0x245)][_0x24d19f(0x3e4)](()=>_0x4061e3);const _0x95193e=await _0x58b73e[_0x24d19f(0x22d)]({'id':_0x24d19f(0x373),'token':'the_token'},{'clientId':[_0x3c05c0['xgLhu']]});expect(_0x95193e)[_0x24d19f(0x1db)](_0x4061e3);}),it_id(_0x3c05c0['yGAwq'])(it)(_0x3c05c0[_0x4c2f4e(0x1e3)],async()=>{const _0x27c5f3=_0x4c2f4e;if(_0x27c5f3(0x413)!==_0x27c5f3(0x29a)){const _0x1b4402={'iss':_0x3c05c0['QCizP'],'aud':_0x3c05c0['xgLhu'],'exp':Date['now'](),'sub':_0x27c5f3(0x373)},_0x3cb04e={'header':{'kid':_0x3c05c0[_0x27c5f3(0x41a)],'alg':_0x27c5f3(0x351)}},_0x3c0fab={'kid':_0x3c05c0[_0x27c5f3(0x41a)],'rsaPublicKey':_0x3c05c0[_0x27c5f3(0x2ff)]};_0x3c05c0['RfQWV'](spyOn,_0xa3ae1e,_0x3c05c0['xVWob'])[_0x27c5f3(0x245)]['callFake'](()=>_0x3cb04e),spyOn(_0xa3ae1e,_0x3c05c0['KFxtP'])['and'][_0x27c5f3(0x408)](_0x3c0fab),spyOn(_0x53ad6d,_0x3c05c0['SphEW'])['and'][_0x27c5f3(0x3e4)](()=>_0x1b4402);const _0x236d7=await _0x58b73e[_0x27c5f3(0x22d)]({'id':_0x27c5f3(0x373),'token':_0x3c05c0['liKBM']},{'clientId':['secret',_0x3c05c0['VDvCE']]});_0x3c05c0[_0x27c5f3(0x1d2)](expect,_0x236d7)[_0x27c5f3(0x1db)](_0x1b4402);}else return _0x3e623b[_0x27c5f3(0x3a6)]();}),_0x3c05c0[_0x4c2f4e(0x1bc)](it_id,_0x3c05c0['nSHXG'])(it)('(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(facebook.com)',async()=>{const _0x1c8cfb=_0x4c2f4e,_0x124fc4={'iss':'https://not.facebook.com','sub':_0x3c05c0['Tdmmo']},_0x152bdf={'header':{'kid':_0x3c05c0[_0x1c8cfb(0x41a)],'alg':_0x3c05c0[_0x1c8cfb(0x292)]}},_0x21c3e3={'kid':_0x3c05c0[_0x1c8cfb(0x41a)],'rsaPublicKey':_0x3c05c0[_0x1c8cfb(0x2ff)]};_0x3c05c0['TWXkT'](spyOn,_0xa3ae1e,_0x3c05c0[_0x1c8cfb(0x388)])[_0x1c8cfb(0x245)][_0x1c8cfb(0x3e4)](()=>_0x152bdf),spyOn(_0xa3ae1e,_0x1c8cfb(0x321))[_0x1c8cfb(0x245)]['resolveTo'](_0x21c3e3),spyOn(_0x53ad6d,_0x3c05c0[_0x1c8cfb(0x3de)])[_0x1c8cfb(0x245)][_0x1c8cfb(0x3e4)](()=>_0x124fc4);try{await _0x58b73e['validateAuthData']({'id':_0x3c05c0[_0x1c8cfb(0x2b5)],'token':_0x1c8cfb(0x2a5)},{'clientId':_0x3c05c0[_0x1c8cfb(0x3e3)]}),_0x3c05c0[_0x1c8cfb(0x2f3)](fail);}catch(_0x43ed43){expect(_0x43ed43['message'])[_0x1c8cfb(0x253)](_0x3c05c0[_0x1c8cfb(0x2e3)]);}}),xit(_0x3c05c0[_0x4c2f4e(0x3f4)],async()=>{const _0x2c7542=_0x4c2f4e,_0x436db4={'iss':'https://not.facebook.com','sub':_0x3c05c0[_0x2c7542(0x2b5)]},_0x41fa84={'header':{'kid':_0x3c05c0[_0x2c7542(0x41a)],'alg':_0x3c05c0[_0x2c7542(0x292)]}},_0x2ece04={'kid':_0x3c05c0[_0x2c7542(0x41a)],'rsaPublicKey':_0x2c7542(0x285)};_0x3c05c0[_0x2c7542(0x1b2)](spyOn,_0xa3ae1e,_0x2c7542(0x1bb))['and'][_0x2c7542(0x3e4)](()=>_0x41fa84),_0x3c05c0[_0x2c7542(0x3f5)](spyOn,_0xa3ae1e,_0x2c7542(0x321))[_0x2c7542(0x245)][_0x2c7542(0x408)](_0x2ece04),_0x3c05c0['zesez'](spyOn,_0x53ad6d,_0x2c7542(0x2be))[_0x2c7542(0x245)][_0x2c7542(0x3e4)](()=>_0x436db4);try{await _0x58b73e[_0x2c7542(0x22d)]({'id':_0x3c05c0[_0x2c7542(0x378)],'token':_0x2c7542(0x365)},{'clientId':[_0x2c7542(0x223)]}),fail();}catch(_0x10dd7e){_0x3c05c0['HILPd'](expect,_0x10dd7e[_0x2c7542(0x39c)])[_0x2c7542(0x253)](_0x3c05c0[_0x2c7542(0x2e3)]);}}),it(_0x4c2f4e(0x354),async()=>{const _0x2bdb5d=_0x4c2f4e,_0x299d4b={'iss':'https://not.facebook.com','sub':_0x3c05c0[_0x2bdb5d(0x2b5)]},_0x6bcf58={'header':{'kid':_0x2bdb5d(0x3fd),'alg':_0x2bdb5d(0x351)}},_0x3a0852={'kid':_0x2bdb5d(0x3fd),'rsaPublicKey':_0x3c05c0[_0x2bdb5d(0x2ff)]};_0x3c05c0[_0x2bdb5d(0x424)](spyOn,_0xa3ae1e,_0x3c05c0['xVWob'])['and'][_0x2bdb5d(0x3e4)](()=>_0x6bcf58),_0x3c05c0[_0x2bdb5d(0x3f5)](spyOn,_0xa3ae1e,_0x3c05c0[_0x2bdb5d(0x2af)])[_0x2bdb5d(0x245)][_0x2bdb5d(0x408)](_0x3a0852),spyOn(_0x53ad6d,_0x2bdb5d(0x2be))[_0x2bdb5d(0x245)]['callFake'](()=>_0x299d4b);try{await _0x58b73e['validateAuthData']({'id':_0x3c05c0[_0x2bdb5d(0x378)],'token':_0x2bdb5d(0x365)},{'clientId':_0x2bdb5d(0x223)}),_0x3c05c0[_0x2bdb5d(0x2f3)](fail);}catch(_0x3625c1){_0x3c05c0['awaRk'](expect,_0x3625c1[_0x2bdb5d(0x39c)])[_0x2bdb5d(0x253)](_0x2bdb5d(0x3b3));}}),xit(_0x3c05c0['lldCI'],async()=>{const _0x23c45e=_0x4c2f4e;try{await _0x58b73e[_0x23c45e(0x22d)]({'id':_0x3c05c0[_0x23c45e(0x378)],'token':'INSERT\x20FACEBOOK\x20TOKEN\x20HERE'},{'clientId':_0x3c05c0[_0x23c45e(0x3e3)]}),_0x3c05c0[_0x23c45e(0x1b6)](fail);}catch(_0x21de2d){expect(_0x21de2d[_0x23c45e(0x39c)])[_0x23c45e(0x253)](_0x23c45e(0x2df));}}),xit(_0x3c05c0[_0x4c2f4e(0x3d7)],async()=>{const _0x3956a8=_0x4c2f4e;try{_0x3c05c0[_0x3956a8(0x353)]===_0x3956a8(0x271)?_0x3c05c0[_0x3956a8(0x1bc)](_0x2682e8,_0x5acbff[_0x3956a8(0x39c)])[_0x3956a8(0x253)](_0x3956a8(0x2b4)):(await _0x58b73e[_0x3956a8(0x22d)]({'id':_0x3956a8(0x2da),'token':_0x3956a8(0x41f)},{'clientId':[_0x3c05c0[_0x3956a8(0x3e3)]]}),fail());}catch(_0x1be68d){expect(_0x1be68d[_0x3956a8(0x39c)])[_0x3956a8(0x253)](_0x3956a8(0x2df));}}),_0x3c05c0['nMSbk'](xit,'should\x20throw\x20error\x20with\x20invalid\x20user\x20id',async()=>{const _0x29d279=_0x4c2f4e,_0x405653={'HrPSL':_0x29d279(0x411),'OrvRv':_0x3c05c0[_0x29d279(0x2fd)]};try{await _0x58b73e[_0x29d279(0x22d)]({'id':_0x3c05c0['ukRcK'],'token':_0x3c05c0['ABfoh']},{'clientId':_0x29d279(0x223)}),_0x3c05c0[_0x29d279(0x322)](fail);}catch(_0x257311){if(_0x29d279(0x1ac)!==_0x29d279(0x1ac))return _0x574138[_0x29d279(0x3a6)]({'data':{'sub':'fakeid','roles':_0x405653['HrPSL'],'groups':[_0x405653['OrvRv']]}});else expect(_0x257311[_0x29d279(0x39c)])[_0x29d279(0x253)](_0x29d279(0x2b4));}}),it_id(_0x4c2f4e(0x3e1))(it)(_0x3c05c0[_0x4c2f4e(0x1bd)],async()=>{const _0x13aa61=_0x4c2f4e;if(_0x3c05c0[_0x13aa61(0x1cb)]===_0x13aa61(0x3c1))_0x3c05c0[_0x13aa61(0x366)](_0x390a5f);else{const _0xaaf316={'iss':_0x3c05c0[_0x13aa61(0x294)],'aud':_0x3c05c0[_0x13aa61(0x32a)],'sub':_0x3c05c0[_0x13aa61(0x34e)]},_0x1a1a06={'header':{'kid':_0x13aa61(0x3fd),'alg':_0x3c05c0[_0x13aa61(0x292)]}},_0x51ca50={'kid':_0x3c05c0['vVOlQ'],'rsaPublicKey':_0x3c05c0[_0x13aa61(0x2ff)]};spyOn(_0xa3ae1e,_0x3c05c0[_0x13aa61(0x388)])[_0x13aa61(0x245)]['callFake'](()=>_0x1a1a06),spyOn(_0xa3ae1e,_0x3c05c0[_0x13aa61(0x2af)])[_0x13aa61(0x245)]['resolveTo'](_0x51ca50),spyOn(_0x53ad6d,_0x13aa61(0x2be))['and']['callFake'](()=>_0xaaf316);try{await _0x58b73e[_0x13aa61(0x22d)]({'id':_0x3c05c0['Tdmmo'],'token':_0x3c05c0[_0x13aa61(0x421)]},{'clientId':_0x3c05c0[_0x13aa61(0x3e3)]}),_0x3c05c0[_0x13aa61(0x366)](fail);}catch(_0x950c61){_0x3c05c0[_0x13aa61(0x1d2)](expect,_0x950c61[_0x13aa61(0x39c)])[_0x13aa61(0x253)](_0x3c05c0[_0x13aa61(0x2dc)]);}}});}),describe('OTP\x20TOTP\x20auth\x20adatper',()=>{const _0x76ed5f=_0x5e6db5,_0xd8ebb4={'eMuxE':function(_0x4c5763,_0xca8316){return _0x4c5763(_0xca8316);},'fuSQp':_0x76ed5f(0x302),'LeKLl':'otpauth','CmfSQ':_0x76ed5f(0x2c2),'CViro':_0x76ed5f(0x38e),'rZzgy':'enabled','oRMbK':_0x76ed5f(0x2bb),'kNMEx':_0x76ed5f(0x277),'Zavwk':function(_0x26010c,_0x15e048){return _0x26010c(_0x15e048);},'sFShH':_0x76ed5f(0x1f7),'AVjly':_0x76ed5f(0x377),'PJOov':_0x76ed5f(0x1dc),'yoFfT':_0x76ed5f(0x247),'TROkW':'sessionToken','ruESJ':function(_0x48d969,_0x134e21){return _0x48d969(_0x134e21);},'AsJjm':function(_0x46b5be,_0x1f9271){return _0x46b5be(_0x1f9271);},'LAcOR':'123','kcoBA':_0x76ed5f(0x1df),'TtAnb':function(_0x1eb003,_0x1f5fbd){return _0x1eb003(_0x1f5fbd);},'uRkii':function(_0x189620,_0x998b38){return _0x189620(_0x998b38);},'ZzaQO':_0x76ed5f(0x267),'kKTTT':_0x76ed5f(0x2f2),'BHkZv':function(_0x1503ec,_0x1d1e20,_0x2ee0a2){return _0x1503ec(_0x1d1e20,_0x2ee0a2);},'FgiNt':_0x76ed5f(0x298),'mUFzZ':function(_0x53bc08,_0x53dd4c,_0x226cc8){return _0x53bc08(_0x53dd4c,_0x226cc8);},'mJvqC':'can\x20change\x20OTP\x20with\x20valid\x20token','WKsPy':_0x76ed5f(0x2b0)},_0x1891b9={'Content-Type':_0x76ed5f(0x3f8),'X-Parse-Application-Id':_0x76ed5f(0x3bb),'X-Parse-REST-API-Key':_0x76ed5f(0x3a9)};beforeEach(async()=>{const _0x4a1889=_0x76ed5f;await _0xd8ebb4['eMuxE'](reconfigureServer,{'auth':{'mfa':{'enabled':!![],'options':[_0xd8ebb4[_0x4a1889(0x37b)]],'algorithm':_0x4a1889(0x2c2),'digits':0x6,'period':0x1e}}});}),_0xd8ebb4[_0x76ed5f(0x2b9)](it,_0xd8ebb4[_0x76ed5f(0x41b)],async()=>{const _0x59bb27=_0x76ed5f,_0x3ff2f5=await Parse['User']['signUp'](_0x59bb27(0x2bb),_0x59bb27(0x277)),_0x51d8b8=require(_0xd8ebb4[_0x59bb27(0x1d5)]),_0x2be35f=new _0x51d8b8[(_0x59bb27(0x212))](),_0x254deb=new _0x51d8b8['TOTP']({'algorithm':_0xd8ebb4[_0x59bb27(0x33d)],'digits':0x6,'period':0x1e,'secret':_0x2be35f}),_0x219674=_0x254deb[_0x59bb27(0x326)]();await _0x3ff2f5[_0x59bb27(0x38d)]({'authData':{'mfa':{'secret':_0x2be35f[_0x59bb27(0x2ba)],'token':_0x219674}}},{'sessionToken':_0x3ff2f5['getSessionToken']()});const _0x41313a=_0x3ff2f5['get'](_0xd8ebb4['CViro']);expect(_0x41313a[_0x59bb27(0x1ec)])['toBeDefined'](),expect(_0x41313a['mfa'][_0x59bb27(0x2fb)])[_0x59bb27(0x2c7)](),expect(_0x41313a[_0x59bb27(0x1ec)][_0x59bb27(0x2fb)][_0x59bb27(0x396)](',')[_0x59bb27(0x30e)])[_0x59bb27(0x1db)](0x2),await _0x3ff2f5['fetch'](),expect(_0x3ff2f5[_0x59bb27(0x2c3)](_0x59bb27(0x1df))[_0x59bb27(0x1ec)])['toEqual']({'status':_0xd8ebb4['rZzgy']});}),it('can\x20login\x20with\x20valid\x20token',async()=>{const _0x16c36e=_0x76ed5f,_0x578d9f=await Parse[_0x16c36e(0x412)][_0x16c36e(0x343)](_0xd8ebb4[_0x16c36e(0x2c4)],_0xd8ebb4['kNMEx']),_0x3959bf=_0xd8ebb4[_0x16c36e(0x3ab)](require,_0xd8ebb4[_0x16c36e(0x1d5)]),_0x4696d3=new _0x3959bf[(_0x16c36e(0x212))](),_0x477b11=new _0x3959bf['TOTP']({'algorithm':_0x16c36e(0x2c2),'digits':0x6,'period':0x1e,'secret':_0x4696d3}),_0x619897=_0x477b11[_0x16c36e(0x326)]();await _0x578d9f['save']({'authData':{'mfa':{'secret':_0x4696d3[_0x16c36e(0x2ba)],'token':_0x619897}}},{'sessionToken':_0x578d9f[_0x16c36e(0x419)]()});const _0x281251=await _0xd8ebb4['Zavwk'](request,{'headers':_0x1891b9,'method':'POST','url':_0xd8ebb4[_0x16c36e(0x221)],'body':JSON['stringify']({'username':_0x16c36e(0x2bb),'password':'password','authData':{'mfa':{'token':_0x477b11[_0x16c36e(0x326)]()}}})})[_0x16c36e(0x342)](_0x483438=>_0x483438[_0x16c36e(0x24a)]);expect(_0x281251[_0x16c36e(0x377)])[_0x16c36e(0x1db)](_0x578d9f['id']),expect(_0x281251[_0x16c36e(0x246)])[_0x16c36e(0x2c7)](),expect(_0x281251[_0x16c36e(0x1df)])[_0x16c36e(0x1db)]({'mfa':{'status':'enabled'}}),expect(Object[_0x16c36e(0x311)](_0x281251)[_0x16c36e(0x2a8)]())[_0x16c36e(0x1db)]([_0xd8ebb4['AVjly'],'username',_0x16c36e(0x3df),_0xd8ebb4[_0x16c36e(0x204)],_0x16c36e(0x1df),_0xd8ebb4[_0x16c36e(0x2d9)],_0xd8ebb4['TROkW'],_0xd8ebb4['CViro']]['sort']());}),_0xd8ebb4[_0x76ed5f(0x263)](it,_0xd8ebb4[_0x76ed5f(0x234)],async()=>{const _0x2ba6f3=_0x76ed5f,_0x5a0b44=await Parse[_0x2ba6f3(0x412)]['signUp'](_0x2ba6f3(0x2bb),_0xd8ebb4[_0x2ba6f3(0x2b1)]),_0x27ac4c=_0xd8ebb4[_0x2ba6f3(0x1c9)](require,_0xd8ebb4['LeKLl']),_0x70a8c2=new _0x27ac4c[(_0x2ba6f3(0x212))](),_0x4cf6c9=new _0x27ac4c['TOTP']({'algorithm':_0xd8ebb4[_0x2ba6f3(0x33d)],'digits':0x6,'period':0x1e,'secret':_0x70a8c2}),_0x191cad=_0x4cf6c9['generate']();await _0x5a0b44[_0x2ba6f3(0x38d)]({'authData':{'mfa':{'secret':_0x70a8c2['base32'],'token':_0x191cad}}},{'sessionToken':_0x5a0b44[_0x2ba6f3(0x419)]()});const _0x1025cc=new _0x27ac4c[(_0x2ba6f3(0x212))](),_0x192d6c=new _0x27ac4c[(_0x2ba6f3(0x302))]({'algorithm':_0xd8ebb4['CmfSQ'],'digits':0x6,'period':0x1e,'secret':_0x1025cc}),_0x2f8318=_0x192d6c['generate']();await _0x5a0b44[_0x2ba6f3(0x38d)]({'authData':{'mfa':{'secret':_0x1025cc[_0x2ba6f3(0x2ba)],'token':_0x2f8318,'old':_0x4cf6c9['generate']()}}},{'sessionToken':_0x5a0b44[_0x2ba6f3(0x419)]()}),await _0x5a0b44[_0x2ba6f3(0x3cf)]({'useMasterKey':!![]}),_0xd8ebb4[_0x2ba6f3(0x1c9)](expect,_0x5a0b44[_0x2ba6f3(0x2c3)](_0x2ba6f3(0x1df))[_0x2ba6f3(0x1ec)]['secret'])[_0x2ba6f3(0x1db)](_0x1025cc['base32']);}),it(_0x76ed5f(0x332),async()=>{const _0x46621=_0x76ed5f,_0xdeff84=await Parse[_0x46621(0x412)][_0x46621(0x343)](_0x46621(0x2bb),_0xd8ebb4['kNMEx']),_0x20290e=require(_0xd8ebb4[_0x46621(0x1d5)]),_0x2d3d79=new _0x20290e[(_0x46621(0x212))](),_0x542b1c=new _0x20290e[(_0x46621(0x302))]({'algorithm':_0x46621(0x2c2),'digits':0x6,'period':0x1e,'secret':_0x2d3d79}),_0x2cc4bb=_0x542b1c[_0x46621(0x326)]();await _0xdeff84[_0x46621(0x38d)]({'authData':{'mfa':{'secret':_0x2d3d79[_0x46621(0x2ba)],'token':_0x2cc4bb}}},{'sessionToken':_0xdeff84[_0x46621(0x419)]()});const _0x1f39d5=new _0x20290e['Secret'](),_0x4138a0=new _0x20290e['TOTP']({'algorithm':_0xd8ebb4[_0x46621(0x33d)],'digits':0x6,'period':0x1e,'secret':_0x1f39d5}),_0x4dd507=_0x4138a0[_0x46621(0x326)]();await _0xd8ebb4[_0x46621(0x260)](expectAsync,_0xdeff84['save']({'authData':{'mfa':{'secret':_0x1f39d5[_0x46621(0x2ba)],'token':_0x4dd507,'old':_0xd8ebb4['LAcOR']}}},{'sessionToken':_0xdeff84[_0x46621(0x419)]()}))[_0x46621(0x254)](new Parse[(_0x46621(0x1ce))](Parse[_0x46621(0x1ce)][_0x46621(0x304)],_0x46621(0x2f2))),await _0xdeff84[_0x46621(0x3cf)]({'useMasterKey':!![]}),_0xd8ebb4[_0x46621(0x3ab)](expect,_0xdeff84['get'](_0xd8ebb4[_0x46621(0x240)])[_0x46621(0x1ec)][_0x46621(0x313)])[_0x46621(0x1db)](_0x2d3d79[_0x46621(0x2ba)]);}),_0xd8ebb4[_0x76ed5f(0x263)](it,_0x76ed5f(0x2b7),async()=>{const _0x402a2f=_0x76ed5f,_0x500a51=await Parse[_0x402a2f(0x412)]['signUp'](_0xd8ebb4[_0x402a2f(0x2c4)],_0xd8ebb4[_0x402a2f(0x2b1)]),_0x9e02f9=require('otpauth'),_0x428550=new _0x9e02f9[(_0x402a2f(0x212))](),_0x2e3f7c=new _0x9e02f9['TOTP']({'algorithm':_0x402a2f(0x2c2),'digits':0x6,'period':0x1e,'secret':_0x428550}),_0x492011=_0x2e3f7c[_0x402a2f(0x326)]();await _0x500a51[_0x402a2f(0x38d)]({'authData':{'mfa':{'secret':_0x428550[_0x402a2f(0x2ba)],'token':_0x492011}}},{'sessionToken':_0x500a51['getSessionToken']()}),await _0xd8ebb4[_0x402a2f(0x2d2)](expectAsync,Parse[_0x402a2f(0x412)]['logIn'](_0xd8ebb4[_0x402a2f(0x2c4)],_0x402a2f(0x277)))['toBeRejectedWith'](new Parse[(_0x402a2f(0x1ce))](Parse[_0x402a2f(0x1ce)]['OTHER_CAUSE'],_0x402a2f(0x27e)));}),it(_0xd8ebb4[_0x76ed5f(0x3f2)],async()=>{const _0x2c2f7b=_0x76ed5f,_0x57efb5=await Parse['User']['signUp'](_0x2c2f7b(0x2bb),_0xd8ebb4[_0x2c2f7b(0x2b1)]),_0x35b695=_0xd8ebb4['eMuxE'](require,_0xd8ebb4[_0x2c2f7b(0x1d5)]),_0x4ed7cc=new _0x35b695[(_0x2c2f7b(0x212))](),_0x311991=new _0x35b695[(_0x2c2f7b(0x302))]({'algorithm':_0x2c2f7b(0x2c2),'digits':0x6,'period':0x1e,'secret':_0x4ed7cc}),_0x1ea089=_0x311991['generate']();await _0x57efb5['save']({'authData':{'mfa':{'secret':_0x4ed7cc[_0x2c2f7b(0x2ba)],'token':_0x1ea089}}},{'sessionToken':_0x57efb5['getSessionToken']()}),await _0xd8ebb4['Zavwk'](expectAsync,_0xd8ebb4[_0x2c2f7b(0x334)](request,{'headers':_0x1891b9,'method':_0x2c2f7b(0x258),'url':_0x2c2f7b(0x1f7),'body':JSON[_0x2c2f7b(0x21d)]({'username':_0x2c2f7b(0x2bb),'password':_0xd8ebb4[_0x2c2f7b(0x2b1)],'authData':{'mfa':{'token':_0xd8ebb4['ZzaQO']}}})})['catch'](_0x1e0f45=>{throw _0x1e0f45['data'];}))[_0x2c2f7b(0x254)]({'code':Parse[_0x2c2f7b(0x1ce)][_0x2c2f7b(0x36a)],'error':_0xd8ebb4['kKTTT']});});}),describe(_0x5e6db5(0x1d6),()=>{const _0xe75cf5=_0x5e6db5,_0x2ea11f={'zpSSF':function(_0xeb30a6,_0x30a7ca){return _0xeb30a6(_0x30a7ca);},'UQRYl':'password','bdxHg':_0xe75cf5(0x31f),'qJBLo':_0xe75cf5(0x1df),'DAJhG':function(_0x3f06f4,_0x80cf9a){return _0x3f06f4(_0x80cf9a);},'nYyYh':_0xe75cf5(0x270),'ePMbZ':'expiry','XSsni':_0xe75cf5(0x2bb),'CIhBa':function(_0x24952a,_0x3584c9,_0x4c0cd3){return _0x24952a(_0x3584c9,_0x4c0cd3);},'lRcZm':function(_0x47e7cc,_0x59ef31){return _0x47e7cc(_0x59ef31);},'pNnta':_0xe75cf5(0x27e),'RcAEr':_0xe75cf5(0x38b),'NzTOl':function(_0x175bca,_0x493c0c){return _0x175bca(_0x493c0c);},'Hpokt':'POST','vckCY':_0xe75cf5(0x1f7),'mLXFP':function(_0x5af026,_0x6b4319){return _0x5af026(_0x6b4319);},'cHnoc':function(_0x367b58,_0xf3f0b8){return _0x367b58(_0xf3f0b8);},'eHGvZ':_0xe75cf5(0x3df),'FdPkF':'ACL','SklzR':'sessionToken','uBurw':_0xe75cf5(0x3f8),'tcVao':_0xe75cf5(0x3bb),'WuSsj':_0xe75cf5(0x3f3)},_0x3fd299={'Content-Type':_0x2ea11f['uBurw'],'X-Parse-Application-Id':_0x2ea11f[_0xe75cf5(0x335)],'X-Parse-REST-API-Key':'rest'};let _0xe059fa,_0x1f59d3;const _0x453db1={'enabled':!![],'options':['SMS'],'sendSMS'(_0x1c4c60,_0x4712af){const _0x6eb108=_0xe75cf5;expect(_0x1c4c60)[_0x6eb108(0x2c7)](),_0x2ea11f[_0x6eb108(0x3b2)](expect,_0x4712af)['toBeDefined'](),expect(_0x1c4c60[_0x6eb108(0x30e)])[_0x6eb108(0x1db)](0x6),_0xe059fa=_0x1c4c60,_0x1f59d3=_0x4712af;},'digits':0x6,'period':0x1e};_0x2ea11f[_0xe75cf5(0x3b2)](beforeEach,async()=>{_0xe059fa='',_0x1f59d3='',await reconfigureServer({'auth':{'mfa':_0x453db1}});}),it(_0xe75cf5(0x298),async()=>{const _0x50ba05=_0xe75cf5,_0x439bce=await Parse['User'][_0x50ba05(0x343)](_0x50ba05(0x2bb),_0x2ea11f[_0x50ba05(0x25d)]),_0x563d2f=_0x439bce['getSessionToken'](),_0x38ca4c=spyOn(_0x453db1,_0x2ea11f[_0x50ba05(0x3d0)])[_0x50ba05(0x245)][_0x50ba05(0x385)]();await _0x439bce['save']({'authData':{'mfa':{'mobile':_0x50ba05(0x361)}}},{'sessionToken':_0x563d2f}),await _0x439bce[_0x50ba05(0x3cf)]({'sessionToken':_0x563d2f}),expect(_0x439bce[_0x50ba05(0x2c3)](_0x50ba05(0x1df)))[_0x50ba05(0x1db)]({'mfa':{'status':_0x50ba05(0x22c)}}),expect(_0x38ca4c)[_0x50ba05(0x2d1)](_0xe059fa,_0x50ba05(0x361)),await _0x439bce[_0x50ba05(0x3cf)]({'useMasterKey':!![]});const _0x2f9ec5=_0x439bce[_0x50ba05(0x2c3)](_0x2ea11f[_0x50ba05(0x2ad)])['mfa']?.[_0x50ba05(0x331)];_0x2ea11f[_0x50ba05(0x3b2)](expect,_0x2f9ec5)['toBeDefined'](),expect(_0x2f9ec5[_0x50ba05(0x361)])[_0x50ba05(0x2c7)](),_0x2ea11f[_0x50ba05(0x20d)](expect,Object[_0x50ba05(0x311)](_0x2f9ec5['+11111111111']))[_0x50ba05(0x1db)]([_0x2ea11f[_0x50ba05(0x214)],_0x2ea11f['ePMbZ']]),await _0x439bce[_0x50ba05(0x38d)]({'authData':{'mfa':{'mobile':_0x1f59d3,'token':_0xe059fa}}},{'sessionToken':_0x563d2f}),await _0x439bce[_0x50ba05(0x3cf)]({'sessionToken':_0x563d2f}),_0x2ea11f[_0x50ba05(0x3b2)](expect,_0x439bce[_0x50ba05(0x2c3)]('authData'))['toEqual']({'mfa':{'status':_0x50ba05(0x1ca)}});}),it(_0x2ea11f[_0xe75cf5(0x237)],async()=>{const _0x14caa2=_0xe75cf5,_0x1190ab=await Parse[_0x14caa2(0x412)][_0x14caa2(0x343)](_0x2ea11f[_0x14caa2(0x213)],_0x2ea11f[_0x14caa2(0x25d)]),_0x2c4577=_0x2ea11f[_0x14caa2(0x287)](spyOn,_0x453db1,_0x14caa2(0x31f))['and'][_0x14caa2(0x385)]();await _0x1190ab[_0x14caa2(0x38d)]({'authData':{'mfa':{'mobile':_0x14caa2(0x361)}}},{'sessionToken':_0x1190ab[_0x14caa2(0x419)]()}),await _0x1190ab['save']({'authData':{'mfa':{'mobile':_0x1f59d3,'token':_0xe059fa}}},{'sessionToken':_0x1190ab[_0x14caa2(0x419)]()}),_0x2c4577['calls'][_0x14caa2(0x35c)](),await _0x2ea11f['lRcZm'](expectAsync,Parse[_0x14caa2(0x412)]['logIn'](_0x2ea11f[_0x14caa2(0x213)],_0x14caa2(0x277)))[_0x14caa2(0x254)](new Parse['Error'](Parse[_0x14caa2(0x1ce)][_0x14caa2(0x304)],_0x2ea11f[_0x14caa2(0x3d2)]));const _0x4c5f39=await request({'headers':_0x3fd299,'method':_0x14caa2(0x258),'url':'http://localhost:8378/1/login','body':JSON[_0x14caa2(0x21d)]({'username':'username','password':_0x2ea11f[_0x14caa2(0x25d)],'authData':{'mfa':{'token':_0x2ea11f[_0x14caa2(0x23e)]}}})})[_0x14caa2(0x398)](_0x24e145=>_0x24e145['data']);_0x2ea11f[_0x14caa2(0x3b2)](expect,_0x4c5f39)[_0x14caa2(0x1db)]({'code':Parse[_0x14caa2(0x1ce)][_0x14caa2(0x36a)],'error':_0x14caa2(0x262)}),_0x2ea11f[_0x14caa2(0x1e1)](expect,_0x2c4577)[_0x14caa2(0x2d1)](_0xe059fa,_0x14caa2(0x361));const _0x4ec75a=await _0x2ea11f['zpSSF'](request,{'headers':_0x3fd299,'method':_0x2ea11f[_0x14caa2(0x203)],'url':_0x2ea11f['vckCY'],'body':JSON[_0x14caa2(0x21d)]({'username':_0x14caa2(0x2bb),'password':_0x14caa2(0x277),'authData':{'mfa':{'token':_0xe059fa}}})})['then'](_0x225467=>_0x225467[_0x14caa2(0x24a)]);expect(_0x4ec75a['objectId'])['toEqual'](_0x1190ab['id']),_0x2ea11f[_0x14caa2(0x25e)](expect,_0x4ec75a[_0x14caa2(0x246)])[_0x14caa2(0x2c7)](),_0x2ea11f[_0x14caa2(0x21f)](expect,_0x4ec75a['authData'])[_0x14caa2(0x1db)]({'mfa':{'status':_0x14caa2(0x1ca)}}),_0x2ea11f[_0x14caa2(0x418)](expect,Object[_0x14caa2(0x311)](_0x4ec75a)[_0x14caa2(0x2a8)]())[_0x14caa2(0x1db)]([_0x14caa2(0x377),_0x2ea11f['XSsni'],_0x2ea11f['eHGvZ'],'updatedAt',_0x14caa2(0x1df),_0x2ea11f[_0x14caa2(0x3d1)],_0x2ea11f[_0x14caa2(0x1dd)],_0x14caa2(0x38e)][_0x14caa2(0x2a8)]());}),it(_0xe75cf5(0x2bc),async()=>{const _0x29b698=_0xe75cf5,_0x991ab5=await Parse['User'][_0x29b698(0x343)](_0x2ea11f[_0x29b698(0x213)],_0x2ea11f[_0x29b698(0x25d)]);await _0x991ab5[_0x29b698(0x38d)]({'authData':{'mfa':{'mobile':_0x29b698(0x361)}}});const _0x3a4ded=_0x2ea11f[_0x29b698(0x287)](spyOn,_0x453db1,_0x2ea11f[_0x29b698(0x3d0)])['and'][_0x29b698(0x385)]();await Parse[_0x29b698(0x412)][_0x29b698(0x1ea)]('username',_0x2ea11f[_0x29b698(0x25d)]),_0x2ea11f['zpSSF'](expect,_0x3a4ded)[_0x29b698(0x34a)][_0x29b698(0x2db)]();});});