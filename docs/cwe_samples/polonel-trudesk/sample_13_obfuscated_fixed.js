'use strict';const _0x139ce0=_0x151e;(function(_0x3f3d32,_0x55e46a){const _0x416ebc=_0x151e,_0x4ab401=_0x3f3d32();while(!![]){try{const _0x30a45a=-parseInt(_0x416ebc(0xce))/0x1*(-parseInt(_0x416ebc(0xcd))/0x2)+-parseInt(_0x416ebc(0xe2))/0x3+-parseInt(_0x416ebc(0xf8))/0x4+parseInt(_0x416ebc(0xf1))/0x5*(-parseInt(_0x416ebc(0xde))/0x6)+parseInt(_0x416ebc(0xf0))/0x7*(-parseInt(_0x416ebc(0xcc))/0x8)+parseInt(_0x416ebc(0xea))/0x9+-parseInt(_0x416ebc(0xc7))/0xa*(-parseInt(_0x416ebc(0x102))/0xb);if(_0x30a45a===_0x55e46a)break;else _0x4ab401['push'](_0x4ab401['shift']());}catch(_0x210ecd){_0x4ab401['push'](_0x4ab401['shift']());}}}(_0xb59c,0x2b84f));function _0xb59c(){const _0x3a4470=['id\x20token\x20is\x20invalid\x20for\x20this\x20user.','756660rezERt','JtUnS','hex','message','Error','gimdu','iWkWd','getHeaderFromToken','resolve','cache-control','949201JRGYIp','EMJlj','exports','id\x20token\x20not\x20authorized\x20for\x20this\x20clientId.','YHxsk','fKFRM','50FZnkJq','https://accounts.google.com','Parse','join','headers','1907144PnOKgs','4YhpfjE','158021RJhlfQ','jsonwebtoken','GcCar','NKfkB','end','get','hWhmF','auth\x20data\x20is\x20invalid\x20for\x20this\x20user.','UTNnQ','parse','https://www.googleapis.com/oauth2/v3/certs','BymIK','HUeAC','gQOTR','iss','RMvKk','2322wLLICK','reduce','-----BEGIN\x20RSA\x20PUBLIC\x20KEY-----\x0a','verify','757041YcDnxR','CWaHV','aud','toString','match','utf8','OBJECT_NOT_FOUND','accounts.google.com','1413927NsbXKg','assign','data','gmGoX','ozfMX','QBHII','7nHDhkn','600pkeqzp','\x20|\x20from:\x20','\x0a-----END\x20RSA\x20PUBLIC\x20KEY-----\x0a','base64','hcaXB','length'];_0xb59c=function(){return _0x3a4470;};return _0xb59c();}var Parse=require('parse/node')[_0x139ce0(0xc9)];const https=require('https'),jwt=require(_0x139ce0(0xcf)),authUtils=require('./utils'),TOKEN_ISSUER=_0x139ce0(0xe9),HTTPS_TOKEN_ISSUER=_0x139ce0(0xc8);let cache={};function getGoogleKeyByKeyId(_0x551fc5){const _0x1f5c94=_0x139ce0,_0x33a050={'hcaXB':function(_0x2e6612,_0x331029){return _0x2e6612(_0x331029);},'NKfkB':_0x1f5c94(0xec),'gQOTR':function(_0x4db785,_0x96a98){return _0x4db785>_0x96a98;},'ygMlU':'vEFuL'};if(cache[_0x551fc5]&&_0x33a050[_0x1f5c94(0xdb)](cache['expiresAt'],new Date())){if(_0x33a050['ygMlU']!==_0x1f5c94(0xfd))return cache[_0x551fc5];else throw new _0x3f8b9e[(_0x1f5c94(0xfc))](_0x25f5d8[_0x1f5c94(0xfc)][_0x1f5c94(0xe8)],_0x1f5c94(0xf7));}return new Promise((_0x259279,_0x2af0b2)=>{const _0xb29c68=_0x1f5c94;https[_0xb29c68(0xd3)](_0xb29c68(0xd8),_0x1addb5=>{const _0x407380=_0xb29c68,_0x4db8e4={'QBHII':_0x407380(0x101),'CWaHV':function(_0x464fc0,_0x41605d){const _0x1965a7=_0x407380;return _0x33a050[_0x1965a7(0xf5)](_0x464fc0,_0x41605d);}};let _0xea5106='';_0x1addb5['on'](_0x33a050[_0x407380(0xd1)],_0x361c28=>{const _0x84fa5b=_0x407380;_0xea5106+=_0x361c28['toString'](_0x84fa5b(0xe7));}),_0x1addb5['on'](_0x407380(0xd2),()=>{const _0x33f9ed=_0x407380,{keys:_0x4cd47f}=JSON[_0x33f9ed(0xd7)](_0xea5106),_0x48b963=_0x4cd47f[_0x33f9ed(0xdf)]((_0x7eea7b,{n:_0x1e58fe,e:_0x1eb8d1,kid:_0x49a2f3})=>Object['assign'](_0x7eea7b,{[_0x49a2f3]:rsaPublicKeyToPEM(_0x1e58fe,_0x1eb8d1)}),{});if(_0x1addb5[_0x33f9ed(0xcb)][_0x4db8e4[_0x33f9ed(0xef)]]){var _0x3d7fd2=_0x1addb5['headers'][_0x4db8e4[_0x33f9ed(0xef)]][_0x33f9ed(0xe6)](/max-age=([0-9]+)/);_0x3d7fd2&&(cache=Object[_0x33f9ed(0xeb)]({},_0x48b963,{'expiresAt':new Date(new Date()['getTime']()+_0x4db8e4[_0x33f9ed(0xe3)](Number,_0x3d7fd2[0x1])*0x3e8)}));}_0x259279(_0x48b963[_0x551fc5]);});})['on']('error',_0x2af0b2);});}async function verifyIdToken({id_token:_0x486282,id:_0x430bd2},{clientId:_0x35bb02}){const _0xef03e7=_0x139ce0,_0x167175={'KjFUl':function(_0x516941,_0x2935e1){return _0x516941!==_0x2935e1;},'GcCar':function(_0x50cf6b,_0x3a8709){return _0x50cf6b!==_0x3a8709;},'fKFRM':function(_0x327292,_0x45e8e9){return _0x327292!==_0x45e8e9;}};if(!_0x486282)throw new Parse[(_0xef03e7(0xfc))](Parse[_0xef03e7(0xfc)][_0xef03e7(0xe8)],_0xef03e7(0xf7));const {kid:_0x31fc7a,alg:_0x2db42a}=authUtils[_0xef03e7(0xff)](_0x486282);let _0x214b1f;const _0x2b2563=await getGoogleKeyByKeyId(_0x31fc7a);try{_0x214b1f=jwt[_0xef03e7(0xe1)](_0x486282,_0x2b2563,{'algorithms':_0x2db42a,'audience':_0x35bb02});}catch(_0x1ad2f3){const _0x56d538=_0x1ad2f3[_0xef03e7(0xfb)];throw new Parse[(_0xef03e7(0xfc))](Parse[_0xef03e7(0xfc)][_0xef03e7(0xe8)],''+_0x56d538);}if(_0x167175['KjFUl'](_0x214b1f[_0xef03e7(0xdc)],TOKEN_ISSUER)&&_0x214b1f[_0xef03e7(0xdc)]!==HTTPS_TOKEN_ISSUER)throw new Parse[(_0xef03e7(0xfc))](Parse[_0xef03e7(0xfc)]['OBJECT_NOT_FOUND'],'id\x20token\x20not\x20issued\x20by\x20correct\x20provider\x20-\x20expected:\x20'+TOKEN_ISSUER+'\x20or\x20'+HTTPS_TOKEN_ISSUER+_0xef03e7(0xf2)+_0x214b1f[_0xef03e7(0xdc)]);if(_0x167175[_0xef03e7(0xd0)](_0x214b1f['sub'],_0x430bd2))throw new Parse['Error'](Parse[_0xef03e7(0xfc)][_0xef03e7(0xe8)],_0xef03e7(0xd5));if(_0x35bb02&&_0x167175[_0xef03e7(0xc6)](_0x214b1f[_0xef03e7(0xe4)],_0x35bb02))throw new Parse[(_0xef03e7(0xfc))](Parse[_0xef03e7(0xfc)][_0xef03e7(0xe8)],_0xef03e7(0x105));return _0x214b1f;}function validateAuthData(_0x40cc06,_0x2fa24a={}){const _0x17d9ba={'wHgYg':function(_0x14bd32,_0x158c1c,_0xf87c51){return _0x14bd32(_0x158c1c,_0xf87c51);}};return _0x17d9ba['wHgYg'](verifyIdToken,_0x40cc06,_0x2fa24a);}function _0x151e(_0x11f503,_0x3bd00e){const _0xb59c8d=_0xb59c();return _0x151e=function(_0x151e2c,_0x58717f){_0x151e2c=_0x151e2c-0xc5;let _0x1813cd=_0xb59c8d[_0x151e2c];return _0x1813cd;},_0x151e(_0x11f503,_0x3bd00e);}function validateAppId(){const _0x29179b=_0x139ce0;return Promise[_0x29179b(0x100)]();}module[_0x139ce0(0x104)]={'validateAppId':validateAppId,'validateAuthData':validateAuthData};function rsaPublicKeyToPEM(_0x35441b,_0x33f4f2){const _0x36a6c5=_0x139ce0,_0x5398b5={'gmGoX':_0x36a6c5(0xf4),'EMJlj':_0x36a6c5(0xfa),'ozfMX':function(_0x3e9544,_0x177ee6){return _0x3e9544(_0x177ee6);},'HUeAC':function(_0x4e8506,_0xbcddfe){return _0x4e8506+_0xbcddfe;},'BymIK':function(_0x138a7d,_0x573d42){return _0x138a7d+_0x573d42;},'kPojD':function(_0xafd14a,_0x197098){return _0xafd14a+_0x197098;},'LEIFZ':_0x36a6c5(0xe0)},_0x18b517=new Buffer(_0x35441b,_0x36a6c5(0xf4)),_0x3d57e7=new Buffer(_0x33f4f2,_0x5398b5[_0x36a6c5(0xed)]),_0x5cf8df=prepadSigned(_0x18b517['toString'](_0x5398b5['EMJlj'])),_0x1a64b7=_0x5398b5[_0x36a6c5(0xee)](prepadSigned,_0x3d57e7[_0x36a6c5(0xe5)]('hex')),_0x13b4f5=_0x5cf8df[_0x36a6c5(0xf6)]/0x2,_0x4bcdff=_0x1a64b7['length']/0x2,_0x3b2b53=encodeLengthHex(_0x13b4f5),_0x5829ac=_0x5398b5[_0x36a6c5(0xee)](encodeLengthHex,_0x4bcdff),_0x3b4df0=_0x5398b5[_0x36a6c5(0xda)](_0x5398b5[_0x36a6c5(0xda)](_0x5398b5[_0x36a6c5(0xd9)]('30'+encodeLengthHex(_0x5398b5['HUeAC'](_0x5398b5['kPojD'](_0x5398b5[_0x36a6c5(0xd9)](_0x13b4f5+_0x4bcdff,_0x3b2b53[_0x36a6c5(0xf6)]/0x2),_0x5829ac[_0x36a6c5(0xf6)]/0x2),0x2)),'02'),_0x3b2b53),_0x5cf8df)+'02'+_0x5829ac+_0x1a64b7,_0xcd0341=new Buffer(_0x3b4df0,_0x5398b5[_0x36a6c5(0x103)])[_0x36a6c5(0xe5)](_0x5398b5[_0x36a6c5(0xed)]);let _0x5a5e94=_0x5398b5['LEIFZ'];return _0x5a5e94+=''+_0xcd0341['match'](/.{1,64}/g)[_0x36a6c5(0xca)]('\x0a'),_0x5a5e94+=_0x36a6c5(0xf3),_0x5a5e94;}function prepadSigned(_0x5f324c){const _0x3cc5c6={'edOrM':function(_0x2a67d2,_0x2933be){return _0x2a67d2>_0x2933be;}},_0x389bc3=_0x5f324c[0x0];if(_0x389bc3<'0'||_0x3cc5c6['edOrM'](_0x389bc3,'7'))return'00'+_0x5f324c;return _0x5f324c;}function toHex(_0x15c6d4){const _0xe718e2=_0x139ce0,_0x9866b1={'RMvKk':_0xe718e2(0xd6)},_0x29249c=_0x15c6d4[_0xe718e2(0xe5)](0x10);if(_0x29249c['length']%0x2){if(_0x9866b1[_0xe718e2(0xdd)]==='UTNnQ')return'0'+_0x29249c;else{const _0x20f120=_0x2631da['message'];throw new _0x293abc[(_0xe718e2(0xfc))](_0x449b49['Error'][_0xe718e2(0xe8)],''+_0x20f120);}}return _0x29249c;}function encodeLengthHex(_0x57d27c){const _0x2a9fca=_0x139ce0,_0x5d7f83={'iWkWd':function(_0x26a5d6,_0x4c9f7f){return _0x26a5d6(_0x4c9f7f);},'JtUnS':function(_0x345665,_0x30da33){return _0x345665+_0x30da33;},'YHxsk':function(_0x5530e9,_0x2dc6ae){return _0x5530e9+_0x2dc6ae;},'hWhmF':function(_0x5475c5,_0x29cbec){return _0x5475c5(_0x29cbec);}};if(_0x57d27c<=0x7f)return _0x5d7f83[_0x2a9fca(0xfe)](toHex,_0x57d27c);const _0x58c490=_0x5d7f83['iWkWd'](toHex,_0x57d27c),_0x552d24=_0x5d7f83[_0x2a9fca(0xf9)](0x80,_0x58c490[_0x2a9fca(0xf6)]/0x2);return _0x5d7f83[_0x2a9fca(0xc5)](_0x5d7f83[_0x2a9fca(0xd4)](toHex,_0x552d24),_0x58c490);}