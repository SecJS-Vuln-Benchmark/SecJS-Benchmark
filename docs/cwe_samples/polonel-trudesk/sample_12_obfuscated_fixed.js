const _0x67a70d=_0x3ef7;(function(_0x5926e5,_0x273b2f){const _0xf90c69=_0x3ef7,_0x393f47=_0x5926e5();while(!![]){try{const _0x270d04=parseInt(_0xf90c69(0x178))/0x1*(-parseInt(_0xf90c69(0x148))/0x2)+parseInt(_0xf90c69(0x172))/0x3+-parseInt(_0xf90c69(0x147))/0x4*(-parseInt(_0xf90c69(0x156))/0x5)+-parseInt(_0xf90c69(0x154))/0x6*(parseInt(_0xf90c69(0x168))/0x7)+parseInt(_0xf90c69(0x14b))/0x8*(-parseInt(_0xf90c69(0x17f))/0x9)+-parseInt(_0xf90c69(0x14e))/0xa*(parseInt(_0xf90c69(0x174))/0xb)+parseInt(_0xf90c69(0x15d))/0xc;if(_0x270d04===_0x273b2f)break;else _0x393f47['push'](_0x393f47['shift']());}catch(_0x2c8c1e){_0x393f47['push'](_0x393f47['shift']());}}}(_0x469e,0xc200d));const Parse=require(_0x67a70d(0x171))[_0x67a70d(0x151)],crypto=require(_0x67a70d(0x173)),jwksClient=require(_0x67a70d(0x16e)),jwt=require(_0x67a70d(0x179)),httpsRequest=require(_0x67a70d(0x159)),authUtils=require(_0x67a70d(0x17b)),TOKEN_ISSUER=_0x67a70d(0x180);function _0x469e(){const _0x1b13ba=['Facebook\x20auth\x20is\x20invalid\x20for\x20this\x20user.','AFUtG','sufnJ','8Suthqn','jsonwebtoken','test','./utils','iRSur','access_token','lwDuQ','9DGmvBe','https://www.facebook.com','yEYjy','NPCri','FClGB','id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20','ZdOtr','app?access_token=','env','token','wVBAR','Facebook\x20auth\x20is\x20not\x20configured.','rfEdC','id\x20token\x20is\x20invalid\x20for\x20this\x20user.','hex','sha256','16QqSWND','211808IyGuAf','&appsecret_proof=','urbsS','366840mcJKqx','auth\x20data\x20is\x20invalid\x20for\x20this\x20user.','\x20|\x20from:\x20','7822410DVsGgj','CvEKG','appIds\x20must\x20be\x20an\x20array.','Parse','OMDws','includes','160464QgGXlw','length','1097825zYEaDz','getSigningKey','FJNKA','./httpsRequest','TESTING','Unable\x20to\x20find\x20matching\x20key\x20for\x20Key\x20ID:\x20','publicKey','6739416GZfNvV','update','https://graph.facebook.com/','then','digest','Error','VuUVq','qhUdR','sub','zMZRG','OBJECT_NOT_FOUND','7amaqHz','verify','message','createHmac','appSecret','TPicU','jwks-rsa','resolve','rsaPublicKey','parse/node','3170493KegDnc','crypto','11qijonX'];_0x469e=function(){return _0x1b13ba;};return _0x469e();}function _0x3ef7(_0xcdc6be,_0x427b01){const _0x469e47=_0x469e();return _0x3ef7=function(_0x3ef7d6,_0x363fc2){_0x3ef7d6=_0x3ef7d6-0x144;let _0x45ab90=_0x469e47[_0x3ef7d6];return _0x45ab90;},_0x3ef7(_0xcdc6be,_0x427b01);}function getAppSecretPath(_0x4c0b78,_0x439916={}){const _0x1b6c64=_0x67a70d,_0x416a58={'WZuko':_0x1b6c64(0x146),'AFUtG':_0x1b6c64(0x145)},_0x4b68b1=_0x439916[_0x1b6c64(0x16c)];if(!_0x4b68b1)return'';const _0x5e79ca=crypto[_0x1b6c64(0x16b)](_0x416a58['WZuko'],_0x4b68b1)[_0x1b6c64(0x15e)](_0x4c0b78[_0x1b6c64(0x17d)])[_0x1b6c64(0x161)](_0x416a58[_0x1b6c64(0x176)]);return _0x1b6c64(0x149)+_0x5e79ca;}function validateGraphToken(_0x5a91af,_0xaa824e){const _0x3c0b3d=_0x67a70d,_0x4289fa={'AjHqX':function(_0x1153d2,_0x20af4b){return _0x1153d2==_0x20af4b;},'iRSur':function(_0x5b3118,_0x46d3c3){return _0x5b3118===_0x46d3c3;},'qhUdR':_0x3c0b3d(0x17a),'BdHIP':_0x3c0b3d(0x175),'FClGB':function(_0x4a1907,_0x2bae86){return _0x4a1907+_0x2bae86;},'pWrIG':'me?fields=id&access_token='};return graphRequest(_0x4289fa[_0x3c0b3d(0x183)](_0x4289fa['pWrIG']+_0x5a91af[_0x3c0b3d(0x17d)],getAppSecretPath(_0x5a91af,_0xaa824e)))[_0x3c0b3d(0x160)](_0x9e27ea=>{const _0x260951=_0x3c0b3d;if(_0x9e27ea&&_0x4289fa['AjHqX'](_0x9e27ea['id'],_0x5a91af['id'])||process['env']['TESTING']&&_0x4289fa[_0x260951(0x17c)](_0x5a91af['id'],_0x4289fa[_0x260951(0x164)]))return;throw new Parse[(_0x260951(0x162))](Parse[_0x260951(0x162)][_0x260951(0x167)],_0x4289fa['BdHIP']);});}async function validateGraphAppId(_0x2efd86,_0x4764ec,_0x563734){const _0x5cef79=_0x67a70d,_0x5c8feb={'GHusO':'test','Dzpzd':function(_0x311d69,_0x585231){return _0x311d69===_0x585231;},'NPCri':_0x5cef79(0x150),'dVEOd':function(_0x1a0c6b,_0x333006){return _0x1a0c6b(_0x333006);},'CvEKG':function(_0x4c2a78,_0x14d56e,_0x4582fc){return _0x4c2a78(_0x14d56e,_0x4582fc);},'wVBAR':_0x5cef79(0x175)};var _0x114648=_0x4764ec['access_token'];if(process[_0x5cef79(0x187)][_0x5cef79(0x15a)]&&_0x114648===_0x5c8feb['GHusO'])return;if(!Array['isArray'](_0x2efd86)){if(_0x5c8feb['Dzpzd']('sBPWc',_0x5cef79(0x17e)))return _0x3a0bc3['token']?_0x337008[_0x5cef79(0x16f)]():_0x46384f(_0x49f0d3,_0x2f91ac,_0x17a2e2);else throw new Parse['Error'](Parse['Error'][_0x5cef79(0x167)],_0x5c8feb[_0x5cef79(0x182)]);}if(!_0x2efd86[_0x5cef79(0x155)])throw new Parse[(_0x5cef79(0x162))](Parse[_0x5cef79(0x162)][_0x5cef79(0x167)],_0x5cef79(0x18a));const _0x3b3116=await _0x5c8feb['dVEOd'](graphRequest,_0x5cef79(0x186)+_0x114648+_0x5c8feb[_0x5cef79(0x14f)](getAppSecretPath,_0x4764ec,_0x563734));if(!_0x3b3116||!_0x2efd86[_0x5cef79(0x153)](_0x3b3116['id']))throw new Parse['Error'](Parse[_0x5cef79(0x162)][_0x5cef79(0x167)],_0x5c8feb[_0x5cef79(0x189)]);}const getFacebookKeyByKeyId=async(_0x2fe744,_0x35cf4a,_0x1f2590)=>{const _0x24b569=_0x67a70d,_0x510d39={'catnR':function(_0x1bb719,_0x1dc630){return _0x1bb719(_0x1dc630);}},_0x3911dd=_0x510d39['catnR'](jwksClient,{'jwksUri':TOKEN_ISSUER+'/.well-known/oauth/openid/jwks/','cache':!![],'cacheMaxEntries':_0x35cf4a,'cacheMaxAge':_0x1f2590});let _0x9b02ba;try{_0x9b02ba=await authUtils[_0x24b569(0x157)](_0x3911dd,_0x2fe744);}catch(_0x2fab3d){throw new Parse[(_0x24b569(0x162))](Parse[_0x24b569(0x162)][_0x24b569(0x167)],_0x24b569(0x15b)+_0x2fe744);}return _0x9b02ba;},verifyIdToken=async({token:_0x55768c,id:_0x214ca4},{clientId:_0x9c6f2a,cacheMaxEntries:_0x3236d0,cacheMaxAge:_0x3a4377})=>{const _0x4868f3=_0x67a70d,_0x41332a={'ZdOtr':_0x4868f3(0x175),'TPicU':'knNcf','rfEdC':_0x4868f3(0x144),'OMDws':function(_0x5f3ec9,_0x3ed3a6){return _0x5f3ec9||_0x3ed3a6;}};if(!_0x55768c){if(_0x4868f3(0x14a)===_0x41332a[_0x4868f3(0x16d)]){if(_0x5e6866&&_0x1404b1['id']==_0x5f38f2['id']||_0xd3da9f['env'][_0x4868f3(0x15a)]&&_0x58dfc0['id']===_0x4868f3(0x17a))return;throw new _0x176cba['Error'](_0xbbb302[_0x4868f3(0x162)]['OBJECT_NOT_FOUND'],_0x41332a[_0x4868f3(0x185)]);}else throw new Parse[(_0x4868f3(0x162))](Parse[_0x4868f3(0x162)][_0x4868f3(0x167)],_0x41332a[_0x4868f3(0x18b)]);}const {kid:_0x489a32,alg:_0x4b3ab3}=authUtils['getHeaderFromToken'](_0x55768c),_0x284777=0x36ee80;let _0x37aea0;_0x3a4377=_0x3a4377||_0x284777,_0x3236d0=_0x41332a[_0x4868f3(0x152)](_0x3236d0,0x5);const _0x1e25d6=await getFacebookKeyByKeyId(_0x489a32,_0x3236d0,_0x3a4377),_0xa61d54=_0x1e25d6[_0x4868f3(0x15c)]||_0x1e25d6[_0x4868f3(0x170)];try{_0x37aea0=jwt[_0x4868f3(0x169)](_0x55768c,_0xa61d54,{'algorithms':_0x4b3ab3,'audience':_0x9c6f2a});}catch(_0x303fe5){const _0x3089a9=_0x303fe5[_0x4868f3(0x16a)];throw new Parse['Error'](Parse[_0x4868f3(0x162)][_0x4868f3(0x167)],''+_0x3089a9);}if(_0x37aea0['iss']!==TOKEN_ISSUER)throw new Parse['Error'](Parse[_0x4868f3(0x162)][_0x4868f3(0x167)],_0x4868f3(0x184)+TOKEN_ISSUER+_0x4868f3(0x14d)+_0x37aea0['iss']);if(_0x37aea0[_0x4868f3(0x165)]!==_0x214ca4)throw new Parse[(_0x4868f3(0x162))](Parse[_0x4868f3(0x162)][_0x4868f3(0x167)],_0x4868f3(0x14c));return _0x37aea0;};function validateAuthData(_0x397289,_0x2d01dc){const _0x411d42=_0x67a70d,_0xefae53={'IGBWG':function(_0x5779ab,_0x29ee1b){return _0x5779ab!==_0x29ee1b;},'sufnJ':_0x411d42(0x158),'zMZRG':_0x411d42(0x163)};return _0x397289['token']?_0xefae53['IGBWG'](_0xefae53[_0x411d42(0x177)],_0xefae53[_0x411d42(0x166)])?verifyIdToken(_0x397289,_0x2d01dc):'':validateGraphToken(_0x397289,_0x2d01dc);}function validateAppId(_0x17f2e7,_0x52ec3e,_0x2a338a){const _0x4fecf4=_0x67a70d;return _0x52ec3e[_0x4fecf4(0x188)]?Promise['resolve']():validateGraphAppId(_0x17f2e7,_0x52ec3e,_0x2a338a);}function graphRequest(_0x49afc2){const _0x101dd4=_0x67a70d,_0x5074fd={'yEYjy':function(_0x516235,_0x4b5b55){return _0x516235+_0x4b5b55;}};return httpsRequest['get'](_0x5074fd[_0x101dd4(0x181)](_0x101dd4(0x15f),_0x49afc2));}module['exports']={'validateAppId':validateAppId,'validateAuthData':validateAuthData};