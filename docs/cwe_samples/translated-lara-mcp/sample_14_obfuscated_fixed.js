'use strict';const _0x430dd0=_0x2101;(function(_0x347c3,_0x496008){const _0x10fe96=_0x2101,_0x456e9e=_0x347c3();while(!![]){try{const _0x11075d=parseInt(_0x10fe96(0x14c))/0x1*(parseInt(_0x10fe96(0x14b))/0x2)+parseInt(_0x10fe96(0x149))/0x3*(parseInt(_0x10fe96(0x154))/0x4)+parseInt(_0x10fe96(0x15f))/0x5+-parseInt(_0x10fe96(0x138))/0x6+-parseInt(_0x10fe96(0x155))/0x7+parseInt(_0x10fe96(0x131))/0x8*(parseInt(_0x10fe96(0x163))/0x9)+parseInt(_0x10fe96(0x139))/0xa*(-parseInt(_0x10fe96(0x13d))/0xb);if(_0x11075d===_0x496008)break;else _0x456e9e['push'](_0x456e9e['shift']());}catch(_0x1b2da4){_0x456e9e['push'](_0x456e9e['shift']());}}}(_0x36b2,0x8256e));const strapiUtils=require(_0x430dd0(0x159)),{errors:{YupValidationError}}=require(_0x430dd0(0x159)),validators=require(_0x430dd0(0x14e));function _0x2101(_0x1855a5,_0x417d9a){const _0x36b21f=_0x36b2();return _0x2101=function(_0x21019a,_0x59e230){_0x21019a=_0x21019a-0x131;let _0x1b5137=_0x36b21f[_0x21019a];return _0x1b5137;},_0x2101(_0x1855a5,_0x417d9a);}describe(_0x430dd0(0x135),()=>{const _0x2d1b00=_0x430dd0,_0x4ada81={'EhBFc':_0x2d1b00(0x147),'bLEfO':_0x2d1b00(0x151),'Hgtsc':function(_0x3884f8,_0x3c4551){return _0x3884f8(_0x3c4551);},'bwSpf':_0x2d1b00(0x162),'lURev':function(_0x325e46,_0xdd3973){return _0x325e46(_0xdd3973);},'tBLsu':function(_0x1af05d,_0x46a248){return _0x1af05d(_0x46a248);},'NFXiC':function(_0x51866d,_0x3a56a1){return _0x51866d(_0x3a56a1);},'revuF':'test-model','mkWcw':_0x2d1b00(0x13c),'SuRqt':function(_0x245271,_0x930dd6,_0x1e683c){return _0x245271(_0x930dd6,_0x1e683c);},'xepOq':_0x2d1b00(0x14a),'QXaXf':function(_0x3010e2,_0x187103,_0x4f427b){return _0x3010e2(_0x187103,_0x4f427b);},'QgIAN':'it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','ITRNP':_0x2d1b00(0x13b),'UbiIC':_0x2d1b00(0x150)};_0x4ada81[_0x2d1b00(0x15c)](describe,_0x2d1b00(0x158),()=>{const _0x4bfeac=_0x2d1b00,_0x13e9d9={'KoMYN':'datetime','jduZQ':_0x4bfeac(0x162),'HsDuJ':function(_0x5ec0cc,_0x2c1b90){const _0x5067c7=_0x4bfeac;return _0x4ada81[_0x5067c7(0x13a)](_0x5ec0cc,_0x2c1b90);}},_0x474aa9=jest['fn']();global[_0x4bfeac(0x160)]={'db':{'query':jest['fn'](()=>({'findOne':_0x474aa9}))}},afterEach(()=>{const _0x2e9890=_0x4bfeac;jest[_0x2e9890(0x153)](),_0x474aa9[_0x2e9890(0x134)]();});const _0x5add03={'kind':'contentType','modelName':_0x4ada81[_0x4bfeac(0x142)],'uid':'test-uid','options':{},'attributes':{'attrDateTimeUnique':{'type':_0x4bfeac(0x147),'unique':!![]}}};test(_0x4ada81[_0x4bfeac(0x145)],async()=>{const _0x568e8a=_0x4bfeac;_0x474aa9[_0x568e8a(0x164)](null);const _0x5d1e5c=strapiUtils[_0x568e8a(0x14f)](validators[_0x568e8a(0x147)]({'attr':{'type':_0x4ada81[_0x568e8a(0x148)]},'model':_0x5add03,'updatedAttribute':{'name':_0x568e8a(0x162),'value':_0x4ada81[_0x568e8a(0x15b)]},'entity':{'id':0x1,'attrDateTimeUnique':_0x4ada81[_0x568e8a(0x15b)]}},{'isDraft':![]}));await _0x4ada81[_0x568e8a(0x144)](_0x5d1e5c,'2021-11-29T00:00:00.000Z'),_0x4ada81['Hgtsc'](expect,_0x474aa9)[_0x568e8a(0x157)][_0x568e8a(0x15a)]();}),_0x4ada81['SuRqt'](test,_0x4ada81[_0x4bfeac(0x133)],async()=>{const _0x4a7010=_0x4bfeac;_0x474aa9[_0x4a7010(0x164)](null);const _0xf0a4cc=strapiUtils['validateYupSchema'](validators[_0x4a7010(0x147)]({'attr':{'type':_0x4a7010(0x147),'unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x4a7010(0x162),'value':null},'entity':null},{'isDraft':![]})[_0x4a7010(0x143)]());await _0x4ada81[_0x4a7010(0x144)](_0xf0a4cc,null),expect(_0x474aa9)['not'][_0x4a7010(0x15a)]();}),_0x4ada81['QXaXf'](test,_0x4bfeac(0x146),async()=>{const _0x3df0b9=_0x4bfeac;_0x474aa9[_0x3df0b9(0x164)](null);const _0x5c78b8=strapiUtils[_0x3df0b9(0x14f)](validators['datetime']({'attr':{'type':'datetime','unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x4ada81[_0x3df0b9(0x132)],'value':_0x3df0b9(0x151)},'entity':null},{'isDraft':![]}));_0x4ada81[_0x3df0b9(0x144)](expect,await _0x4ada81[_0x3df0b9(0x144)](_0x5c78b8,_0x3df0b9(0x151)))['toBe'](_0x4ada81[_0x3df0b9(0x15b)]);}),_0x4ada81[_0x4bfeac(0x15c)](test,_0x4ada81[_0x4bfeac(0x13f)],async()=>{const _0x7c9045=_0x4bfeac;expect['assertions'](0x1),_0x474aa9[_0x7c9045(0x164)]({'attrDateTimeUnique':'2021-11-29T00:00:00.000Z'});const _0x420df6=strapiUtils['validateYupSchema'](validators[_0x7c9045(0x147)]({'attr':{'type':_0x4ada81[_0x7c9045(0x148)],'unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x7c9045(0x162),'value':_0x4ada81[_0x7c9045(0x15b)]},'entity':null},{'isDraft':![]}));try{await _0x4ada81['lURev'](_0x420df6,_0x4ada81[_0x7c9045(0x15b)]);}catch(_0x32f687){_0x4ada81[_0x7c9045(0x14d)](expect,_0x32f687)[_0x7c9045(0x15d)](YupValidationError);}}),test(_0x4bfeac(0x161),async()=>{const _0x29afee=_0x4bfeac;_0x474aa9['mockResolvedValueOnce']({'attrDateTimeUnique':_0x4ada81[_0x29afee(0x15b)]});const _0xaa2f43=strapiUtils[_0x29afee(0x14f)](validators['datetime']({'attr':{'type':_0x4ada81[_0x29afee(0x148)],'unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x29afee(0x162),'value':_0x29afee(0x151)},'entity':{'id':0x1,'attrDateTimeUnique':_0x4ada81['bLEfO']}},{'isDraft':![]}));_0x4ada81['Hgtsc'](expect,await _0x4ada81[_0x29afee(0x13e)](_0xaa2f43,_0x4ada81[_0x29afee(0x15b)]))[_0x29afee(0x141)](_0x4ada81[_0x29afee(0x15b)]);}),test(_0x4ada81[_0x4bfeac(0x15e)],async()=>{const _0x27d7ff=_0x4bfeac;_0x474aa9[_0x27d7ff(0x164)](null);const _0x23d29c=strapiUtils['validateYupSchema'](validators[_0x27d7ff(0x147)]({'attr':{'type':_0x4ada81[_0x27d7ff(0x148)],'unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x4ada81[_0x27d7ff(0x132)],'value':_0x4ada81[_0x27d7ff(0x15b)]},'entity':null},{'isDraft':![]}));await _0x23d29c(_0x4ada81[_0x27d7ff(0x15b)]),_0x4ada81['NFXiC'](expect,_0x474aa9)[_0x27d7ff(0x137)]({'select':['id'],'where':{'attrDateTimeUnique':'2021-11-29T00:00:00.000Z'}});}),test(_0x4ada81['UbiIC'],async()=>{const _0x38d453=_0x4bfeac;_0x474aa9[_0x38d453(0x164)](null);const _0x57e40a=strapiUtils[_0x38d453(0x14f)](validators[_0x38d453(0x147)]({'attr':{'type':_0x13e9d9[_0x38d453(0x140)],'unique':!![]},'model':_0x5add03,'updatedAttribute':{'name':_0x13e9d9[_0x38d453(0x156)],'value':_0x38d453(0x151)},'entity':{'id':0x1,'attrDateTimeUnique':_0x38d453(0x136)}},{'isDraft':![]}));await _0x57e40a(_0x38d453(0x151)),_0x13e9d9[_0x38d453(0x152)](expect,_0x474aa9)[_0x38d453(0x137)]({'select':['id'],'where':{'$and':[{'attrDateTimeUnique':_0x38d453(0x151)},{'$not':{'id':0x1}}]}});});});});function _0x36b2(){const _0x1d65c9=['toBe','revuF','nullable','Hgtsc','mkWcw','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','datetime','EhBFc','681tapcUB','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','2tguxew','652603HJHFGO','lURev','../validators','validateYupSchema','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','2021-11-29T00:00:00.000Z','HsDuJ','clearAllMocks','13452YylRcY','3079279NhBIaR','jduZQ','not','unique','@strapi/utils','toHaveBeenCalled','bLEfO','SuRqt','toBeInstanceOf','ITRNP','4601875TSOViO','strapi','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','attrDateTimeUnique','18toFGnl','mockResolvedValueOnce','647656qfmDKM','bwSpf','xepOq','mockReset','Datetime\x20validator','2021-12-25T00:00:00.000Z','toHaveBeenCalledWith','2763558ZxedNk','3670rgAIIY','NFXiC','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','31889ilNpyG','tBLsu','QgIAN','KoMYN'];_0x36b2=function(){return _0x1d65c9;};return _0x36b2();}