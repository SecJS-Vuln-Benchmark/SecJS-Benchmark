'use strict';const _0x5b1482=_0x4ddc;function _0x4ddc(_0x242e40,_0x2296e4){const _0x59c20a=_0x59c2();return _0x4ddc=function(_0x4ddc60,_0xfc20ee){_0x4ddc60=_0x4ddc60-0x1eb;let _0x1a8eef=_0x59c20a[_0x4ddc60];return _0x1a8eef;},_0x4ddc(_0x242e40,_0x2296e4);}(function(_0x4600f9,_0x3d1490){const _0x5b5f8a=_0x4ddc,_0x362109=_0x4600f9();while(!![]){try{const _0x1ba7ad=parseInt(_0x5b5f8a(0x202))/0x1+parseInt(_0x5b5f8a(0x207))/0x2*(-parseInt(_0x5b5f8a(0x20a))/0x3)+parseInt(_0x5b5f8a(0x201))/0x4*(-parseInt(_0x5b5f8a(0x20b))/0x5)+-parseInt(_0x5b5f8a(0x208))/0x6*(parseInt(_0x5b5f8a(0x21a))/0x7)+-parseInt(_0x5b5f8a(0x1f1))/0x8+parseInt(_0x5b5f8a(0x1fc))/0x9*(-parseInt(_0x5b5f8a(0x21e))/0xa)+parseInt(_0x5b5f8a(0x204))/0xb;if(_0x1ba7ad===_0x3d1490)break;else _0x362109['push'](_0x362109['shift']());}catch(_0x27d76c){_0x362109['push'](_0x362109['shift']());}}}(_0x59c2,0x497ce));const strapiUtils=require('@strapi/utils'),{errors:{YupValidationError}}=require(_0x5b1482(0x206)),validators=require('../validators');function _0x59c2(){const _0x3c5d68=['2348xDcLju','247633dZhXjh','fYYVH','17408853DgTFfK','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','@strapi/utils','2nkOjtM','347664XCIspt','contentType','958371rUTYLl','2130qroLkc','validateYupSchema','nullable','00:00:00.000Z','mockReset','assertions','not','toHaveBeenCalledWith','ctrdW','01:00:00.000Z','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','toBeInstanceOf','time','xecaH','70ZinkYn','JLREz','toHaveBeenCalled','toBe','2284610DBnAqT','RrimG','mockResolvedValueOnce','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','attrTimeUnique','GzvDM','Time\x20validator','unique','test-uid','NGYda','1214640LpkbwG','JwPtM','clearAllMocks','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','Kxpey','IySow','QHXyT','yiNRn','BxKSY','ZDzKq','VKaNk','9aRnTOL','it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','test-model','strapi','xIrvC'];_0x59c2=function(){return _0x3c5d68;};return _0x59c2();}describe(_0x5b1482(0x1ed),()=>{const _0x216317=_0x5b1482,_0x4f7457={'ZDzKq':_0x216317(0x20e),'FMhSq':'attrTimeUnique','GzvDM':function(_0x2ef1d0,_0x3ac3f5){return _0x2ef1d0(_0x3ac3f5);},'JwPtM':function(_0x102d39,_0x1ee88c){return _0x102d39(_0x1ee88c);},'ctrdW':_0x216317(0x209),'VKaNk':_0x216317(0x218),'FjIXm':_0x216317(0x215),'xIrvC':function(_0x5522ca,_0x3af5c8,_0x31c29a){return _0x5522ca(_0x3af5c8,_0x31c29a);},'QHXyT':_0x216317(0x205),'YpbVE':_0x216317(0x221),'Aupse':'it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','JLREz':_0x216317(0x216)};_0x4f7457[_0x216317(0x200)](describe,_0x216317(0x1ee),()=>{const _0x3c40ce=_0x216317,_0x2e2d35={'xecaH':_0x4f7457['FMhSq'],'fYYVH':_0x4f7457[_0x3c40ce(0x1fa)],'IySow':function(_0xe720f5,_0x50cba5){return _0xe720f5(_0x50cba5);},'BxKSY':_0x3c40ce(0x218),'yiNRn':function(_0x50e130,_0x42d987){const _0x527d00=_0x3c40ce;return _0x4f7457[_0x527d00(0x1ec)](_0x50e130,_0x42d987);},'RrimG':function(_0x112c64,_0x3deb3d){return _0x112c64(_0x3deb3d);},'Kxpey':function(_0x44cc47,_0xb9cde3){return _0x44cc47(_0xb9cde3);},'NGYda':function(_0x5a6750,_0xb7732){return _0x4f7457['GzvDM'](_0x5a6750,_0xb7732);}},_0x645389=jest['fn']();global[_0x3c40ce(0x1ff)]={'db':{'query':jest['fn'](()=>({'findOne':_0x645389}))}},_0x4f7457[_0x3c40ce(0x1f2)](afterEach,()=>{const _0x19841c=_0x3c40ce;jest[_0x19841c(0x1f3)](),_0x645389[_0x19841c(0x20f)]();});const _0x512278={'kind':_0x4f7457[_0x3c40ce(0x213)],'modelName':_0x3c40ce(0x1fe),'uid':_0x3c40ce(0x1ef),'privateAttributes':[],'options':{},'attributes':{'attrTimeUnique':{'type':_0x4f7457[_0x3c40ce(0x1fb)],'unique':!![]}}};test(_0x3c40ce(0x1f4),async()=>{const _0x537104=_0x3c40ce;_0x645389[_0x537104(0x220)](null);const _0x2d2e99=strapiUtils[_0x537104(0x20c)](validators[_0x537104(0x218)]({'attr':{'type':_0x537104(0x218)},'model':_0x512278,'updatedAttribute':{'name':_0x2e2d35[_0x537104(0x219)],'value':_0x2e2d35['fYYVH']},'entity':null},{'isDraft':![]}));await _0x2e2d35[_0x537104(0x1f6)](_0x2d2e99,_0x2e2d35[_0x537104(0x203)]),expect(_0x645389)['not'][_0x537104(0x21c)]();}),test(_0x4f7457['FjIXm'],async()=>{const _0x389c1a=_0x3c40ce;_0x645389['mockResolvedValueOnce'](null);const _0x26be19=strapiUtils[_0x389c1a(0x20c)](validators[_0x389c1a(0x218)]({'attr':{'type':_0x2e2d35[_0x389c1a(0x1f9)],'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':'attrTimeUnique','value':null},'entity':{'id':0x1,'attrTimeUnique':_0x389c1a(0x20e)}},{'isDraft':![]})[_0x389c1a(0x20d)]());await _0x2e2d35[_0x389c1a(0x1f8)](_0x26be19,null),expect(_0x645389)[_0x389c1a(0x211)][_0x389c1a(0x21c)]();}),_0x4f7457['xIrvC'](test,_0x4f7457[_0x3c40ce(0x1f7)],async()=>{const _0x5553ec=_0x3c40ce;_0x645389['mockResolvedValueOnce'](null);const _0x316b8c=strapiUtils[_0x5553ec(0x20c)](validators['time']({'attr':{'type':_0x2e2d35[_0x5553ec(0x1f9)],'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':_0x2e2d35[_0x5553ec(0x219)],'value':_0x2e2d35[_0x5553ec(0x203)]},'entity':null},{'isDraft':![]}));_0x2e2d35[_0x5553ec(0x21f)](expect,await _0x2e2d35[_0x5553ec(0x1f6)](_0x316b8c,_0x5553ec(0x20e)))[_0x5553ec(0x21d)]('00:00:00.000Z');}),test(_0x3c40ce(0x1fd),async()=>{const _0x5e3abe=_0x3c40ce;expect[_0x5e3abe(0x210)](0x1),_0x645389[_0x5e3abe(0x220)]({'attrTimeUnique':'00:00:00.000Z'});const _0x1610eb=strapiUtils[_0x5e3abe(0x20c)](validators['time']({'attr':{'type':_0x5e3abe(0x218),'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':'attrTimeUnique','value':_0x5e3abe(0x20e)},'entity':null},{'isDraft':![]}));try{await _0x1610eb(_0x2e2d35[_0x5e3abe(0x203)]);}catch(_0x425ce0){_0x2e2d35[_0x5e3abe(0x1f6)](expect,_0x425ce0)[_0x5e3abe(0x217)](YupValidationError);}}),test(_0x4f7457['YpbVE'],async()=>{const _0x7cc743=_0x3c40ce;_0x645389[_0x7cc743(0x220)]({'attrTimeUnique':_0x7cc743(0x20e)});const _0x548f86=strapiUtils[_0x7cc743(0x20c)](validators[_0x7cc743(0x218)]({'attr':{'type':_0x2e2d35[_0x7cc743(0x1f9)],'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':_0x2e2d35[_0x7cc743(0x219)],'value':_0x7cc743(0x20e)},'entity':{'id':0x1,'attrTimeUnique':_0x7cc743(0x20e)}},{'isDraft':![]}));_0x2e2d35[_0x7cc743(0x1f5)](expect,await _0x2e2d35[_0x7cc743(0x1f0)](_0x548f86,_0x7cc743(0x20e)))[_0x7cc743(0x21d)](_0x2e2d35[_0x7cc743(0x203)]);}),test(_0x4f7457['Aupse'],async()=>{const _0x338809=_0x3c40ce;_0x645389['mockResolvedValueOnce'](null);const _0x3b3025=strapiUtils[_0x338809(0x20c)](validators[_0x338809(0x218)]({'attr':{'type':_0x2e2d35['BxKSY'],'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':_0x2e2d35[_0x338809(0x219)],'value':'00:00:00.000Z'},'entity':null},{'isDraft':![]}));await _0x3b3025(_0x338809(0x20e)),expect(_0x645389)[_0x338809(0x212)]({'select':['id'],'where':{'attrTimeUnique':'00:00:00.000Z'}});}),test(_0x4f7457[_0x3c40ce(0x21b)],async()=>{const _0x1a8e15=_0x3c40ce;_0x645389[_0x1a8e15(0x220)](null);const _0x4962fb=strapiUtils[_0x1a8e15(0x20c)](validators[_0x1a8e15(0x218)]({'attr':{'type':_0x1a8e15(0x218),'unique':!![]},'model':_0x512278,'updatedAttribute':{'name':_0x1a8e15(0x1eb),'value':_0x4f7457[_0x1a8e15(0x1fa)]},'entity':{'id':0x1,'attrTimeUnique':_0x1a8e15(0x214)}},{'isDraft':![]}));await _0x4962fb(_0x4f7457['ZDzKq']),expect(_0x645389)[_0x1a8e15(0x212)]({'select':['id'],'where':{'$and':[{'attrTimeUnique':_0x1a8e15(0x20e)},{'$not':{'id':0x1}}]}});});});});