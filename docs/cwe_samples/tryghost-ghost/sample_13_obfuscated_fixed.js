function _0x34c9(){const _0x13cefe=['manage-emoji','extension','setName','foRyu','contentType','ueLso','JiVNa','previousName','Alias_Set','insertOrUpdateEmoji','broadcast','_id','BSAfb','yDJtK','812532jcJKZd','171099HadSJf','deleteFile','setAliases','281280pGKlIc','veAmH','end','100976beTFWV','KThrm','findByNameOrAliasExceptID','emoji.updateCustom','Name','\x20is\x20not\x20a\x20valid\x20name','wHpva','\x20is\x20not\x20a\x20valid\x20alias\x20set','replace','concat','Custom_Emoji_Error_Name_Or_Alias_Already_In_Use','Srxty','KkAjP','The\x20custom\x20emoji\x20or\x20one\x20of\x20its\x20aliases\x20is\x20already\x20in\x20use','Error','without','findByNameOrAlias','hpWvt','pxmcl','46446KXVhOS','73310SFdevG','fetch','pipe','JSdMw','HClZY','not_authorized','userId','bindEnvironment','WUvOz','40yvOGmx','aliases','GdErj','name','length','previousExtension','test','tjMhP','10202588ChmlMN','setExtension','error-input-is-not-a-valid-field','AMHzY','140YtTCQt','EbLUi','oeXuX','8CLdflO','0|3|2|1|4','create','301hYZvyO','getFileWithReadStream','aDRaK','split'];_0x34c9=function(){return _0x13cefe;};return _0x34c9();}(function(_0x150e48,_0x2628c4){const _0x4b8d07=_0x17e8,_0x553fd3=_0x150e48();while(!![]){try{const _0x2de79a=parseInt(_0x4b8d07(0x116))/0x1*(-parseInt(_0x4b8d07(0xe6))/0x2)+-parseInt(_0x4b8d07(0xfb))/0x3+parseInt(_0x4b8d07(0x102))/0x4*(-parseInt(_0x4b8d07(0xd7))/0x5)+parseInt(_0x4b8d07(0x115))/0x6*(parseInt(_0x4b8d07(0xe9))/0x7)+-parseInt(_0x4b8d07(0xff))/0x8+parseInt(_0x4b8d07(0xfc))/0x9*(-parseInt(_0x4b8d07(0xe3))/0xa)+parseInt(_0x4b8d07(0xdf))/0xb;if(_0x2de79a===_0x2628c4)break;else _0x553fd3['push'](_0x553fd3['shift']());}catch(_0x4b0ceb){_0x553fd3['push'](_0x553fd3['shift']());}}}(_0x34c9,0x2f1fd));import{Meteor}from'meteor/meteor';import _0x49c046 from'underscore';import _0x1cb8b1 from'underscore.string';function _0x17e8(_0x590a6c,_0x549896){const _0x34c97a=_0x34c9();return _0x17e8=function(_0x17e837,_0x4b6c6a){_0x17e837=_0x17e837-0xcf;let _0x41bf77=_0x34c97a[_0x17e837];return _0x41bf77;},_0x17e8(_0x590a6c,_0x549896);}import _0x2d7d8b from'limax';import{hasPermission}from'../../../authorization';import{EmojiCustom}from'../../../models';import{RocketChatFileEmojiCustomInstance}from'../startup/emoji-custom';import{api}from'../../../../server/sdk/api';Meteor['methods']({'insertOrUpdateEmoji'(_0x38c0e7){const _0x38bba1=_0x17e8,_0x4eb7c5={'JSdMw':_0x38bba1(0xe1),'Srxty':_0x38bba1(0xf5),'KkAjP':_0x38bba1(0xe7),'BSAfb':function(_0x2cba0b,_0xadb8ef){return _0x2cba0b(_0xadb8ef);},'GmFUA':_0x38bba1(0xed),'WUvOz':_0x38bba1(0xd3),'aDRaK':'insertOrUpdateEmoji','foRyu':'Name','KThrm':function(_0xbe91d5,_0x34e46a,_0x298081){return _0xbe91d5(_0x34e46a,_0x298081);},'tjMhP':_0x38bba1(0x10c),'ueLso':_0x38bba1(0x10f),'aDcLy':_0x38bba1(0x105),'hpWvt':function(_0x3966f1,_0x569ef5){return _0x3966f1(_0x569ef5);},'wHpva':function(_0x25d02e,_0x4ccc71){return _0x25d02e!==_0x4ccc71;},'AMHzY':_0x38bba1(0xe4),'GdErj':_0x38bba1(0xfa),'pxmcl':function(_0x17b80c,_0x4ca8dd){return _0x17b80c(_0x4ca8dd);},'JiVNa':function(_0x3c96e8,_0x5391e9){return _0x3c96e8(_0x5391e9);},'veAmH':_0x38bba1(0x101),'oeXuX':function(_0x5a12c7,_0x892734){return _0x5a12c7!==_0x892734;}};if(!hasPermission(this[_0x38bba1(0xd4)],_0x4eb7c5['GmFUA']))throw new Meteor[(_0x38bba1(0x110))](_0x4eb7c5[_0x38bba1(0xd6)]);if(!_0x1cb8b1['trim'](_0x38c0e7[_0x38bba1(0xda)]))throw new Meteor[(_0x38bba1(0x110))]('error-the-field-is-required','The\x20field\x20Name\x20is\x20required',{'method':_0x4eb7c5[_0x38bba1(0xeb)],'field':_0x4eb7c5[_0x38bba1(0xf0)]});_0x38c0e7['name']=_0x4eb7c5[_0x38bba1(0x103)](_0x2d7d8b,_0x38c0e7[_0x38bba1(0xda)],{'replacement':'_'}),_0x38c0e7[_0x38bba1(0xd8)]=_0x2d7d8b(_0x38c0e7['aliases'],{'replacement':'_'});const _0x596adc=/[\s,:><&"'\/\\\(\)]/,_0x372b73=/[:><&\|"'\/\\\(\)]/;_0x38c0e7['name']=_0x38c0e7[_0x38bba1(0xda)][_0x38bba1(0x10a)](/:/g,''),_0x38c0e7[_0x38bba1(0xd8)]=_0x38c0e7['aliases'][_0x38bba1(0x10a)](/:/g,'');if(_0x596adc[_0x38bba1(0xdd)](_0x38c0e7['name']))throw new Meteor['Error'](_0x4eb7c5[_0x38bba1(0xd1)],_0x38c0e7['name']+_0x38bba1(0x107),{'method':_0x4eb7c5[_0x38bba1(0xeb)],'input':_0x38c0e7[_0x38bba1(0xda)],'field':_0x38bba1(0x106)});if(_0x38c0e7[_0x38bba1(0xd8)]){if(_0x372b73['test'](_0x38c0e7[_0x38bba1(0xd8)]))throw new Meteor[(_0x38bba1(0x110))](_0x38bba1(0xe1),_0x38c0e7[_0x38bba1(0xd8)]+_0x38bba1(0x109),{'method':_0x4eb7c5[_0x38bba1(0xeb)],'input':_0x38c0e7[_0x38bba1(0xd8)],'field':_0x38bba1(0xf5)});_0x38c0e7[_0x38bba1(0xd8)]=_0x38c0e7[_0x38bba1(0xd8)]['split'](/[\s,]/),_0x38c0e7[_0x38bba1(0xd8)]=_0x38c0e7[_0x38bba1(0xd8)]['filter'](Boolean),_0x38c0e7[_0x38bba1(0xd8)]=_0x49c046[_0x38bba1(0x111)](_0x38c0e7['aliases'],_0x38c0e7['name']);}else _0x38c0e7[_0x38bba1(0xd8)]=[];_0x38c0e7[_0x38bba1(0xee)]=_0x38c0e7[_0x38bba1(0xee)]==='svg+xml'?'png':_0x38c0e7['extension'];let _0x567d34=[];if(_0x38c0e7[_0x38bba1(0xf8)]){_0x567d34=EmojiCustom[_0x38bba1(0x104)](_0x38c0e7['name'],_0x38c0e7[_0x38bba1(0xf8)])[_0x38bba1(0xcf)]();for(const _0x405517 of _0x38c0e7[_0x38bba1(0xd8)]){_0x567d34=_0x567d34[_0x38bba1(0x10b)](EmojiCustom[_0x38bba1(0x104)](_0x405517,_0x38c0e7['_id'])[_0x38bba1(0xcf)]());}}else{_0x567d34=EmojiCustom['findByNameOrAlias'](_0x38c0e7[_0x38bba1(0xda)])[_0x38bba1(0xcf)]();for(const _0x128a05 of _0x38c0e7['aliases']){_0x567d34=_0x567d34[_0x38bba1(0x10b)](EmojiCustom[_0x38bba1(0x112)](_0x128a05)[_0x38bba1(0xcf)]());}}if(_0x567d34[_0x38bba1(0xdb)]>0x0)throw new Meteor[(_0x38bba1(0x110))](_0x4eb7c5[_0x38bba1(0xde)],_0x4eb7c5[_0x38bba1(0xf2)],{'method':_0x4eb7c5['aDRaK']});if(!_0x38c0e7[_0x38bba1(0xf8)]){const _0x316541={'name':_0x38c0e7[_0x38bba1(0xda)],'aliases':_0x38c0e7[_0x38bba1(0xd8)],'extension':_0x38c0e7['extension']},_0x3f3b78=EmojiCustom[_0x38bba1(0xe8)](_0x316541);return api[_0x38bba1(0xf7)](_0x4eb7c5['aDcLy'],_0x316541),_0x3f3b78;}if(_0x38c0e7['newFile'])RocketChatFileEmojiCustomInstance[_0x38bba1(0xfd)](encodeURIComponent(_0x38c0e7[_0x38bba1(0xda)]+'.'+_0x38c0e7[_0x38bba1(0xee)])),RocketChatFileEmojiCustomInstance['deleteFile'](encodeURIComponent(_0x38c0e7[_0x38bba1(0xda)]+'.'+_0x38c0e7[_0x38bba1(0xdc)])),RocketChatFileEmojiCustomInstance[_0x38bba1(0xfd)](encodeURIComponent(_0x38c0e7['previousName']+'.'+_0x38c0e7['extension'])),RocketChatFileEmojiCustomInstance[_0x38bba1(0xfd)](_0x4eb7c5[_0x38bba1(0x113)](encodeURIComponent,_0x38c0e7[_0x38bba1(0xf4)]+'.'+_0x38c0e7['previousExtension'])),EmojiCustom[_0x38bba1(0xe0)](_0x38c0e7['_id'],_0x38c0e7[_0x38bba1(0xee)]);else{if(_0x4eb7c5[_0x38bba1(0x108)](_0x38c0e7['name'],_0x38c0e7['previousName'])){if(_0x4eb7c5['wHpva'](_0x4eb7c5[_0x38bba1(0xe2)],_0x4eb7c5[_0x38bba1(0xd9)])){const _0x3b5186=RocketChatFileEmojiCustomInstance[_0x38bba1(0xea)](_0x4eb7c5[_0x38bba1(0x114)](encodeURIComponent,_0x38c0e7[_0x38bba1(0xf4)]+'.'+_0x38c0e7[_0x38bba1(0xdc)]));if(_0x4eb7c5[_0x38bba1(0x108)](_0x3b5186,null)){RocketChatFileEmojiCustomInstance[_0x38bba1(0xfd)](_0x4eb7c5[_0x38bba1(0xf3)](encodeURIComponent,_0x38c0e7[_0x38bba1(0xda)]+'.'+_0x38c0e7[_0x38bba1(0xee)]));const _0x3a1892=RocketChatFileEmojiCustomInstance['createWriteStream'](_0x4eb7c5[_0x38bba1(0xf9)](encodeURIComponent,_0x38c0e7[_0x38bba1(0xda)]+'.'+_0x38c0e7[_0x38bba1(0xdc)]),_0x3b5186[_0x38bba1(0xf1)]);_0x3a1892['on'](_0x4eb7c5[_0x38bba1(0x100)],Meteor[_0x38bba1(0xd5)](()=>RocketChatFileEmojiCustomInstance[_0x38bba1(0xfd)](encodeURIComponent(_0x38c0e7[_0x38bba1(0xf4)]+'.'+_0x38c0e7[_0x38bba1(0xdc)])))),_0x3b5186['readStream'][_0x38bba1(0xd0)](_0x3a1892);}}else throw new _0x226749[(_0x38bba1(0x110))](_0x4eb7c5['JSdMw'],_0x2cbbd1[_0x38bba1(0xd8)]+'\x20is\x20not\x20a\x20valid\x20alias\x20set',{'method':_0x38bba1(0xf6),'input':_0x138e98['aliases'],'field':_0x4eb7c5[_0x38bba1(0x10d)]});}}_0x38c0e7[_0x38bba1(0xda)]!==_0x38c0e7[_0x38bba1(0xf4)]&&EmojiCustom[_0x38bba1(0xef)](_0x38c0e7['_id'],_0x38c0e7[_0x38bba1(0xda)]);if(_0x38c0e7[_0x38bba1(0xd8)])EmojiCustom[_0x38bba1(0xfe)](_0x38c0e7[_0x38bba1(0xf8)],_0x38c0e7[_0x38bba1(0xd8)]);else{if(_0x4eb7c5[_0x38bba1(0xe5)](_0x38bba1(0xd2),_0x38bba1(0xd2))){const _0x403de0=_0x4eb7c5[_0x38bba1(0x10e)][_0x38bba1(0xec)]('|');let _0x1893fd=0x0;while(!![]){switch(_0x403de0[_0x1893fd++]){case'0':_0x1484cc[_0x38bba1(0xfd)](_0x4eb7c5[_0x38bba1(0xf9)](_0x5870e0,_0x56b1ef[_0x38bba1(0xda)]+'.'+_0x305485[_0x38bba1(0xee)]));continue;case'1':_0x53b08a[_0x38bba1(0xfd)](_0x319dfa(_0x417bd6[_0x38bba1(0xf4)]+'.'+_0x5c35da['previousExtension']));continue;case'2':_0x467674[_0x38bba1(0xfd)](_0x4eb7c5[_0x38bba1(0xf9)](_0x3a68bf,_0x4de879[_0x38bba1(0xf4)]+'.'+_0x51acd2[_0x38bba1(0xee)]));continue;case'3':_0x2f911f[_0x38bba1(0xfd)](_0x451901(_0x6e53f1['name']+'.'+_0x36868a[_0x38bba1(0xdc)]));continue;case'4':_0x4f4a92[_0x38bba1(0xe0)](_0x1671bb['_id'],_0x25fb5c[_0x38bba1(0xee)]);continue;}break;}}else EmojiCustom[_0x38bba1(0xfe)](_0x38c0e7[_0x38bba1(0xf8)],[]);}return api[_0x38bba1(0xf7)](_0x38bba1(0x105),_0x38c0e7),!![];}});