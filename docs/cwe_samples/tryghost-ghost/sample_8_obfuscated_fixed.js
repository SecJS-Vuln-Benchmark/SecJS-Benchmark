(function(_0xabe65e,_0x13ffef){const _0x5b2828=_0x2446,_0x488f39=_0xabe65e();while(!![]){try{const _0x3c6ee6=-parseInt(_0x5b2828(0xba))/0x1+-parseInt(_0x5b2828(0xb5))/0x2+parseInt(_0x5b2828(0xbd))/0x3*(-parseInt(_0x5b2828(0xd2))/0x4)+parseInt(_0x5b2828(0xd0))/0x5*(parseInt(_0x5b2828(0xcd))/0x6)+-parseInt(_0x5b2828(0xd5))/0x7+parseInt(_0x5b2828(0xcb))/0x8+-parseInt(_0x5b2828(0xb6))/0x9;if(_0x3c6ee6===_0x13ffef)break;else _0x488f39['push'](_0x488f39['shift']());}catch(_0x53b42b){_0x488f39['push'](_0x488f39['shift']());}}}(_0x92c7,0xf0746));import{Meteor}from'meteor/meteor';function _0x2446(_0x3a91f5,_0x135278){const _0x92c7d9=_0x92c7();return _0x2446=function(_0x24465f,_0x27df0a){_0x24465f=_0x24465f-0xae;let _0x37d008=_0x92c7d9[_0x24465f];return _0x37d008;},_0x2446(_0x3a91f5,_0x135278);}import _0x9a839a from'./logger';import{Messages,Subscriptions}from'../../models';Meteor['methods']({'unreadMessages'(_0x36bc47,_0x316dc4){const _0x3741b7=_0x2446,_0x21b0cf={'QDJQc':_0x3741b7(0xc0),'EDYLD':_0x3741b7(0xc1),'reJac':_0x3741b7(0xc7),'ktjzh':function(_0x589ae9,_0x3129f2){return _0x589ae9===_0x3129f2;},'THPmm':function(_0x56c09f,_0x4476cb){return _0x56c09f!==_0x4476cb;},'sdYih':_0x3741b7(0xc6),'Hxybq':function(_0x4ebf69,_0xfdab49){return _0x4ebf69==_0xfdab49;},'RjmMH':'Unread_messages','agOgz':function(_0x5a8973,_0x2b6af1){return _0x5a8973!==_0x2b6af1;},'gnuEm':'KBPzk','pihDc':_0x3741b7(0xb2),'jooRV':_0x3741b7(0xb3),'TGNfZ':_0x3741b7(0xbc),'Tyiya':_0x3741b7(0xb0)},_0x446f7c=Meteor[_0x3741b7(0xd7)]();if(!_0x446f7c)throw new Meteor['Error']('error-invalid-user',_0x21b0cf[_0x3741b7(0xd9)],{'method':_0x21b0cf[_0x3741b7(0xd3)]});if(_0x316dc4&&_0x21b0cf['ktjzh'](typeof _0x316dc4,_0x3741b7(0xd4))){if(_0x21b0cf[_0x3741b7(0xc3)](_0x21b0cf[_0x3741b7(0xce)],_0x21b0cf[_0x3741b7(0xce)]))throw new _0x4fe472['Error'](_0x21b0cf[_0x3741b7(0xc9)],'Not\x20allowed',{'method':_0x21b0cf[_0x3741b7(0xd3)],'action':_0x3741b7(0xd8)});else{const _0x2e991f=Messages['findVisibleByRoomId'](_0x316dc4,{'limit':0x1,'sort':{'ts':-0x1}})[_0x3741b7(0xae)]()[0x0];if(_0x21b0cf[_0x3741b7(0xb7)](_0x2e991f,null))throw new Meteor[(_0x3741b7(0xd6))](_0x21b0cf[_0x3741b7(0xc9)],_0x3741b7(0xb3),{'method':_0x21b0cf[_0x3741b7(0xd3)],'action':_0x21b0cf['RjmMH']});return Subscriptions[_0x3741b7(0xaf)](_0x2e991f[_0x3741b7(0xb9)],_0x446f7c,_0x2e991f['ts']);}}if(_0x21b0cf[_0x3741b7(0xbb)](typeof _0x36bc47?.[_0x3741b7(0xbf)],'string')){if(_0x21b0cf[_0x3741b7(0xc5)]!==_0x21b0cf['pihDc'])throw new Meteor[(_0x3741b7(0xd6))](_0x3741b7(0xc0),_0x21b0cf[_0x3741b7(0xbe)],{'method':_0x21b0cf[_0x3741b7(0xd3)],'action':_0x21b0cf['RjmMH']});else throw new _0x40b495[(_0x3741b7(0xd6))](_0x3741b7(0xc4),_0x21b0cf[_0x3741b7(0xd9)],{'method':_0x3741b7(0xc1)});}const _0x208c44=Messages[_0x3741b7(0xd1)](_0x36bc47[_0x3741b7(0xbf)],{'fields':{'u':0x1,'rid':0x1,'file':0x1,'ts':0x1}});if(_0x21b0cf[_0x3741b7(0xb7)](_0x208c44,null)||_0x446f7c===_0x208c44['u'][_0x3741b7(0xbf)]){if(_0x3741b7(0xbc)===_0x21b0cf[_0x3741b7(0xca)])throw new Meteor[(_0x3741b7(0xd6))](_0x3741b7(0xc0),_0x21b0cf['jooRV'],{'method':_0x21b0cf[_0x3741b7(0xd3)],'action':_0x21b0cf[_0x3741b7(0xc2)]});else return _0x5074ee[_0x3741b7(0xcf)][_0x3741b7(0xb1)](_0x3741b7(0xb0));}const _0x1356f7=Subscriptions[_0x3741b7(0xcc)](_0x208c44[_0x3741b7(0xb9)],_0x446f7c)['ls'];if(_0x36bc47['ts']>=_0x1356f7)return _0x9a839a[_0x3741b7(0xcf)][_0x3741b7(0xb1)](_0x21b0cf[_0x3741b7(0xb8)]);return _0x9a839a['connection']['debug'](_0x3741b7(0xc8)+_0x208c44['ts']+_0x3741b7(0xb4)),Subscriptions['setAsUnreadByRoomIdAndUserId'](_0x208c44[_0x3741b7(0xb9)],_0x446f7c,_0x208c44['ts']);}});function _0x92c7(){const _0x3735e0=['setAsUnreadByRoomIdAndUserId','Provided\x20message\x20is\x20already\x20marked\x20as\x20unread','debug','tSLqN','Not\x20allowed','\x20as\x20the\x20first\x20unread','482330SfekUB','877941sQsLmH','Hxybq','Tyiya','rid','308278NFBpfQ','agOgz','sUzXz','76404RPgJMk','jooRV','_id','error-action-not-allowed','unreadMessages','RjmMH','THPmm','error-invalid-user','gnuEm','gJoBB','Invalid\x20user','Updating\x20unread\x20\x20message\x20of\x20','QDJQc','TGNfZ','10788968yCPcTg','findOneByRoomIdAndUserId','4849842MvyQvF','sdYih','connection','10eLDTyD','findOneById','68znDhyb','EDYLD','string','6302695jTymad','Error','userId','Unread_messages','reJac','fetch'];_0x92c7=function(){return _0x3735e0;};return _0x92c7();}