const _0x326bdd=_0x2c2e;(function(_0x4b3efd,_0x3948a4){const _0x9c564d=_0x2c2e,_0x2269f3=_0x4b3efd();while(!![]){try{const _0x31b726=parseInt(_0x9c564d(0xab))/0x1*(parseInt(_0x9c564d(0xa7))/0x2)+-parseInt(_0x9c564d(0xb5))/0x3+parseInt(_0x9c564d(0xbb))/0x4*(-parseInt(_0x9c564d(0xbc))/0x5)+-parseInt(_0x9c564d(0xb1))/0x6+-parseInt(_0x9c564d(0xa0))/0x7*(-parseInt(_0x9c564d(0xb6))/0x8)+-parseInt(_0x9c564d(0xa5))/0x9+parseInt(_0x9c564d(0xbe))/0xa*(parseInt(_0x9c564d(0xbd))/0xb);if(_0x31b726===_0x3948a4)break;else _0x2269f3['push'](_0x2269f3['shift']());}catch(_0x43f292){_0x2269f3['push'](_0x2269f3['shift']());}}}(_0x207d,0xe65b5));import{Meteor}from'meteor/meteor';function _0x2c2e(_0x32b066,_0x4450b3){const _0x207db2=_0x207d();return _0x2c2e=function(_0x2c2eca,_0x3d33a8){_0x2c2eca=_0x2c2eca-0x9e;let _0x289e9a=_0x207db2[_0x2c2eca];return _0x289e9a;},_0x2c2e(_0x32b066,_0x4450b3);}import _0x26f07d from'limax';import _0xee0dfe from'sharp';import{hasPermission}from'../../../authorization';import{RocketChatFile}from'../../../file';import{RocketChatFileEmojiCustomInstance}from'../startup/emoji-custom';import{api}from'../../../../server/sdk/api';function _0x207d(){const _0x59918b=['Error','lIKwv','BsATa','1212292ibbOzx','5dpSDvI','3741694uERirr','30DmAmwd','manage-emoji','ZaOhi','35XNFYWY','end','toBuffer','png','createWriteStream','6028641zaPvci','bufferToStream','4YBFFsB','broadcast','svg+xml','vjqKq','176023UELeQl','aliases','userId','extension','not_authorized','from','862848woljnf','binary','name','TBxKY','2907306YpyDpi','2650984BLYcsX','methods'];_0x207d=function(){return _0x59918b;};return _0x207d();}const getFile=async(_0x22a48e,_0x4c31a8)=>{const _0x3add7f=_0x2c2e,_0xaadef9={'bfcCS':'svg+xml'};if(_0x4c31a8!==_0xaadef9['bfcCS'])return _0x22a48e;return _0xee0dfe(_0x22a48e)['png']()[_0x3add7f(0xa2)]();};Meteor[_0x326bdd(0xb7)]({async 'uploadEmojiCustom'(_0x212bdf,_0x136046,_0x939d3c){const _0x574a1d=_0x326bdd,_0x340417={'ZaOhi':_0x574a1d(0x9e),'BsATa':function(_0xf6310c,_0x1b1ad6,_0x35859f){return _0xf6310c(_0x1b1ad6,_0x35859f);},'lIKwv':_0x574a1d(0xa3),'TBxKY':function(_0xa3b60f,_0x16adf2){return _0xa3b60f(_0x16adf2);},'vjqKq':_0x574a1d(0xa1)};if(!hasPermission(this[_0x574a1d(0xad)],_0x340417[_0x574a1d(0x9f)]))throw new Meteor[(_0x574a1d(0xb8))](_0x574a1d(0xaf));_0x939d3c['name']=_0x340417[_0x574a1d(0xba)](_0x26f07d,_0x939d3c['name'],{'replacement':'_'}),delete _0x939d3c[_0x574a1d(0xac)];const _0x10add8=await getFile(Buffer[_0x574a1d(0xb0)](_0x212bdf,_0x574a1d(0xb2)),_0x939d3c[_0x574a1d(0xae)]);_0x939d3c['extension']=_0x939d3c[_0x574a1d(0xae)]===_0x574a1d(0xa9)?_0x340417[_0x574a1d(0xb9)]:_0x939d3c[_0x574a1d(0xae)];const _0x2b858e=RocketChatFile[_0x574a1d(0xa6)](_0x10add8);RocketChatFileEmojiCustomInstance['deleteFile'](_0x340417[_0x574a1d(0xb4)](encodeURIComponent,_0x939d3c[_0x574a1d(0xb3)]+'.'+_0x939d3c[_0x574a1d(0xae)]));const _0xd78786=RocketChatFileEmojiCustomInstance[_0x574a1d(0xa4)](encodeURIComponent(_0x939d3c[_0x574a1d(0xb3)]+'.'+_0x939d3c['extension']),_0x136046);_0xd78786['on'](_0x340417[_0x574a1d(0xaa)],Meteor['bindEnvironment'](()=>Meteor['setTimeout'](()=>api[_0x574a1d(0xa8)]('emoji.updateCustom',_0x939d3c),0x1f4))),_0x2b858e['pipe'](_0xd78786);}});