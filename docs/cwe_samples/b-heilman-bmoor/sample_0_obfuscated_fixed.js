function _0x5a93(_0x36f210,_0x5f4f86){var _0x5f53db=_0x5f53();return _0x5a93=function(_0x5a93ee,_0xac446e){_0x5a93ee=_0x5a93ee-0x86;var _0x5e023a=_0x5f53db[_0x5a93ee];return _0x5e023a;},_0x5a93(_0x36f210,_0x5f4f86);}function _0x5f53(){var _0x31f363=['1|8|5|7|3|2|0|6|4','12171042hSZJJY','4066044hYcEWp','HrbFN','fsypA','wwbys','AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA','AsyhP','fHPrZ','should\x20throw\x20if\x20algorithms\x20is\x20not\x20an\x20array','elPxz','shhhhhh','lhtkV','54612YFytij','Oaxce','GzVoU','Bearer\x20eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.yJ1c2VybmFtZSI6InNhZ3VpYXIiLCJpYXQiOjE0NzEwMTg2MzUsImV4cCI6MTQ3MzYxMDYzNX0.foo','not\x20the\x20secret','equal','XsqhR','8981rYbMiB','kGBqu','bar','Pediz','tnKtg','locals','25LAZKnQ','cTPhz','OclKW','support\x20unless\x20skip','yUfcN','tnEuv','http://foo','credentials_bad_scheme','should\x20throw\x20if\x20authorization\x20header\x20is\x20not\x20Bearer','ICtll','FNeOf','locals.user','code','name','alg','CiscO','mUSfj','LiAxb','CFFrh','edkXp','KNRDw','xXVcX','JwbEa','2290446fYGvrt','vdHrV','secret\x20should\x20be\x20set','should\x20work\x20if\x20authorization\x20header\x20is\x20valid\x20with\x20a\x20buffer\x20secret','should\x20throw\x20error\x20when\x20signature\x20is\x20wrong','auth.token','should\x20ignore\x20userProperty\x20if\x20resultProperty\x20option\x20provided','qEkAM','jwt\x20expired','aQqCr','SMUCY','Basic\x20foobar','vUuhM','KaMOf','vzrbl','MZyOZ','originalUrl','should\x20set\x20resultProperty\x20if\x20option\x20provided','qvaHS','work\x20tests','3gSZfJm','Ncyin','nDVtU','NNryr','should\x20set\x20userProperty\x20if\x20option\x20provided','wrong','CwITu','KNnia','foo','shhh','AxaWo','Xtdrr','message','EELFz','different-shhhh','secretB','../lib','dVYnm','yTkQP','should\x20throw\x20if\x20authorization\x20header\x20is\x20not\x20well-formatted\x20jwt','HIsEj','should\x20skip\x20on\x20CORS\x20preflight','Bearer\x20wrongjwt','../lib/errors/UnauthorizedError','should\x20throw\x20if\x20authorization\x20header\x20is\x20not\x20valid\x20jwt','token','{foo:\x20\x27bar\x27,\x20edg:\x20\x27ar\x27}','auth','invalid_token','Bearer\x20','1384878ssJTbI','nBFbo','9270580tqVlYM','algorithms\x20should\x20be\x20set','aVbQU','AMEWP','EgmRA','split','Stack\x20trace\x20didn\x27t\x20include\x20\x27invalid\x20signature\x27\x20message.','unless','headers','3|1|2|0|4','HSRGq','query','vMfTk','expected-audience','3|4|0|2|1|5','nzxnO','qifFb','should\x20throw\x20if\x20no\x20authorization\x20header\x20and\x20credentials\x20are\x20required','user','authorization','Ekzwq','nOxjR','gnkhv','shhhh','should\x20throw\x20if\x20options\x20not\x20sent','vjxng','should\x20produce\x20a\x20stack\x20trace\x20that\x20includes\x20the\x20failure\x20reason','should\x20not\x20work\x20if\x20no\x20authorization\x20header','should\x20work\x20with\x20a\x20custom\x20getToken\x20function','IduOb','join','Invalid\x20token!','ZdgSp','should\x20throw\x20error\x20if\x20token\x20is\x20expired\x20even\x20with\x20when\x20credentials\x20are\x20not\x20required','dwhPa','yUtzQ','UnauthorizedError:\x20invalid\x20signature','OIgUZ','KHpGv','undefined','sign','qwVhV','2|0|4|3|1','invalid\x20signature','ebHWR','should\x20throw\x20if\x20algorithms\x20is\x20not\x20sent','jwt\x20issuer\x20invalid.\x20expected:\x20http://wrong','RDRHI','should\x20next\x20if\x20authorization\x20header\x20is\x20not\x20Bearer\x20and\x20credentialsRequired\x20is\x20false','http://wrong','Lhaqh','SZiNK','http://www','failure\x20tests','xBzSG','kEtLI','hpFbb','zUsZH','WNRcB','WrjBS','base64','YJtCX','invalid\x20token','inner','SHPtb','xzEHH','should\x20work\x20with\x20nested\x20properties','jwt\x20audience\x20invalid.\x20expected:\x20not-expected-audience','nnZIw','LZneb','fgscC','vXkqw','yHoNQ','11144HZsHSj','should\x20use\x20errors\x20thrown\x20from\x20custom\x20getToken\x20function','ihSte','swkgt','koqor','EQzHg','rXeQZ','TokenExpiredError','nKACf','HS256','puHvQ','credentials_bad_format','rTOdN','rMELJ','igVrJ','wTUgY','rypqP','xRdTU','XsBns','should\x20throw\x20if\x20audience\x20is\x20not\x20expected','dDieR','credentials_required'];_0x5f53=function(){return _0x31f363;};return _0x5f53();}var _0x503658=_0x5a93;(function(_0x3e6f84,_0x365bb6){var _0x21485b=_0x5a93,_0x563076=_0x3e6f84();while(!![]){try{var _0x962193=parseInt(_0x21485b(0x9c))/0x1+-parseInt(_0x21485b(0xc0))/0x2+-parseInt(_0x21485b(0xd4))/0x3*(-parseInt(_0x21485b(0x91))/0x4)+-parseInt(_0x21485b(0xa9))/0x5*(parseInt(_0x21485b(0xf2))/0x6)+parseInt(_0x21485b(0xa3))/0x7*(parseInt(_0x21485b(0x13d))/0x8)+parseInt(_0x21485b(0x90))/0x9+-parseInt(_0x21485b(0xf4))/0xa;if(_0x962193===_0x365bb6)break;else _0x563076['push'](_0x563076['shift']());}catch(_0x38f064){_0x563076['push'](_0x563076['shift']());}}}(_0x5f53,0xf050e));var jwt=require('jsonwebtoken'),assert=require('assert'),expressjwt=require(_0x503658(0xe4)),UnauthorizedError=require(_0x503658(0xeb));describe(_0x503658(0x129),function(){var _0x57396e=_0x503658,_0x119584={'GzVoU':_0x57396e(0x146),'SZiNK':'4|3|0|2|1','tnKtg':_0x57396e(0xf1),'dDieR':_0x57396e(0xa5),'YJtCX':_0x57396e(0x9a),'zUsZH':'ivAGJ','gfmio':'SuJUC','Pediz':function(_0x341884,_0x598d1c){return _0x341884(_0x598d1c);},'rXeQZ':_0x57396e(0x10b),'puHvQ':'edkXp','nBFbo':'foo','aQqCr':_0x57396e(0xcb),'wwbys':function(_0x5f5ce4,_0x28381d){return _0x5f5ce4(_0x28381d);},'CwITu':function(_0x25aee2,_0x47d2db){return _0x25aee2!==_0x47d2db;},'NGzOQ':'/index.html','JwbEa':function(_0x3ca965,_0x9c549a){return _0x3ca965(_0x9c549a);},'AxaWo':'OPTIONS','vjxng':function(_0x50e5fb,_0x143e62){return _0x50e5fb(_0x143e62);},'qwVhV':_0x57396e(0x148),'lhtkV':_0x57396e(0xea),'Kwwol':_0x57396e(0x9f),'KNnia':_0x57396e(0xf0),'FNeOf':_0x57396e(0x101),'XsqhR':'not-expected-audience','elPxz':_0x57396e(0xc8),'ebHWR':function(_0x4f422f,_0x422a81){return _0x4f422f+_0x422a81;},'kEtLI':function(_0x18b2ec,_0x17dcd3){return _0x18b2ec(_0x17dcd3);},'vdHrV':function(_0x51e7c7,_0x56f136){return _0x51e7c7(_0x56f136);},'qvaHS':_0x57396e(0x97),'HSRGq':_0x57396e(0x114),'fsypA':_0x57396e(0x102),'KaMOf':function(_0x438ef4,_0xeecea,_0x46641f){return _0x438ef4(_0xeecea,_0x46641f);},'AMEWP':_0x57396e(0x10c),'tnEuv':_0x57396e(0x98),'IduOb':function(_0x1eb03d,_0xfe3b27,_0x37e31d){return _0x1eb03d(_0xfe3b27,_0x37e31d);},'XsBns':_0x57396e(0x105),'vMfTk':function(_0x322181,_0x3cd2f7,_0x39b1f7){return _0x322181(_0x3cd2f7,_0x39b1f7);},'ZNAEd':_0x57396e(0xac),'Ncyin':function(_0x58c739,_0x206be9,_0x5237f4){return _0x58c739(_0x206be9,_0x5237f4);},'PGTMM':'should\x20throw\x20if\x20authorization\x20header\x20is\x20malformed','xRdTU':_0x57396e(0xb1),'AsyhP':_0x57396e(0x124),'swkgt':'should\x20throw\x20if\x20jwt\x20is\x20an\x20invalid\x20json','oHIch':_0x57396e(0xec),'HrbFN':function(_0x18c02d,_0x53206f,_0xa3e21c){return _0x18c02d(_0x53206f,_0xa3e21c);},'LZneb':function(_0x3300f6,_0x39921b,_0x327737){return _0x3300f6(_0x39921b,_0x327737);},'EQzHg':function(_0x52c77d,_0x52ba12,_0x168f47){return _0x52c77d(_0x52ba12,_0x168f47);},'dwhPa':_0x57396e(0x13e),'MrYcy':_0x57396e(0xc4),'EELFz':function(_0x1db8e0,_0x58e8bd,_0x38a9b3){return _0x1db8e0(_0x58e8bd,_0x38a9b3);},'xzEHH':'should\x20throw\x20error\x20if\x20token\x20is\x20invalid\x20even\x20with\x20when\x20credentials\x20are\x20not\x20required'},_0x3bd137={},_0x1bfa49={};_0x119584['KaMOf'](it,_0x119584[_0x57396e(0xf7)],function(){var _0x27e5ec=_0x57396e;try{expressjwt();}catch(_0x2cd1ab){assert['ok'](_0x2cd1ab),assert[_0x27e5ec(0xa1)](_0x2cd1ab[_0x27e5ec(0xe0)],_0x27e5ec(0xc2));}}),it(_0x57396e(0x121),function(){var _0x151a94=_0x57396e,_0x2e5d36={'vXkqw':_0x119584[_0x151a94(0x127)],'qifFb':_0x151a94(0x146),'fCZkl':function(_0x3fd6cf,_0x33b2b0){return _0x3fd6cf+_0x33b2b0;},'EgmRA':_0x119584[_0x151a94(0xa7)],'KHpGv':_0x119584[_0x151a94(0x8d)],'WNRcB':_0x119584['YJtCX']};try{if(_0x119584[_0x151a94(0x12d)]!==_0x119584['gfmio'])_0x119584[_0x151a94(0xa6)](expressjwt,{'secret':_0x119584['rXeQZ']});else{var _0x222799={'OgpUp':function(_0x16d0e8,_0x3078c5,_0x5556a0){return _0x16d0e8(_0x3078c5,_0x5556a0);}};_0x18dac7[_0x151a94(0xa1)](_0x51dbea[_0x151a94(0xb7)],_0x119584['GzVoU']),_0x836afa['equal'](_0x2570c7[_0x151a94(0xdc)],'bar'),_0x266833['nextTick'](function(){return _0x222799['OgpUp'](_0x6698be,null,_0x4dbccd);});}}catch(_0x28f9e3){if(_0x151a94(0xbc)===_0x119584[_0x151a94(0x147)])assert['ok'](_0x28f9e3),assert[_0x151a94(0xa1)](_0x28f9e3[_0x151a94(0xe0)],_0x151a94(0xf5));else{var _0x5e90a1=_0x2e5d36[_0x151a94(0x13b)]['split']('|'),_0x571692=0x0;while(!![]){switch(_0x5e90a1[_0x571692++]){case'0':_0x15045c[_0x151a94(0xfc)]={};continue;case'1':_0x5e5091({'secret':_0x27ed46,'algorithms':[_0x2e5d36[_0x151a94(0x104)]],'userProperty':_0x151a94(0xef)})(_0x43eb31,_0x4e47bc,function(){var _0x44bf8b=_0x151a94;_0x40e1dc[_0x44bf8b(0xa1)](_0x44bf8b(0xa5),_0x3dca2e['auth']['foo']);});continue;case'2':_0x3dcc2a['headers'][_0x151a94(0x107)]=_0x2e5d36['fCZkl'](_0x2e5d36[_0x151a94(0xf8)],_0x1ec3ff);continue;case'3':var _0x1ec3ff=_0x181d19[_0x151a94(0x11c)]({'foo':_0x2e5d36[_0x151a94(0x11a)]},_0x27ed46);continue;case'4':var _0x27ed46=_0x2e5d36[_0x151a94(0x12e)];continue;}break;}}}}),_0x119584[_0x57396e(0xcd)](it,_0x119584[_0x57396e(0xae)],function(){var _0x4cf496=_0x57396e;try{expressjwt({'secret':_0x4cf496(0x10b),'algorithms':_0x119584[_0x4cf496(0xf3)]});}catch(_0x291384){assert['ok'](_0x291384),assert['equal'](_0x291384['message'],'algorithms\x20must\x20be\x20an\x20array');}}),_0x119584[_0x57396e(0x111)](it,_0x119584[_0x57396e(0x8b)],function(){var _0x1733ba=_0x57396e,_0x163243={'nDVtU':_0x1733ba(0x8e)};if(_0x119584[_0x1733ba(0xda)]('fOPKm',_0x1733ba(0xcc)))_0x119584[_0x1733ba(0x94)](expressjwt,{'secret':_0x1733ba(0x10b),'credentialsRequired':!![],'algorithms':[_0x119584[_0x1733ba(0x9e)]]})(_0x3bd137,_0x1bfa49,function(_0xa6e44a){var _0x176f7a=_0x1733ba;assert['ok'](_0xa6e44a),assert['equal'](_0xa6e44a['code'],_0x163243[_0x176f7a(0xd6)]);});else{var _0x73381={'kGBqu':function(_0x533690,_0x5e8612){return _0x533690===_0x5e8612;},'ICtll':'undefined'};_0x52d205[_0x1733ba(0xfc)]={},_0x1e1d6b['headers'][_0x1733ba(0x107)]=_0x119584[_0x1733ba(0xc9)],_0x119584[_0x1733ba(0x94)](_0x3c2c8e,{'secret':_0x119584[_0x1733ba(0x143)],'algorithms':['HS256'],'credentialsRequired':![]})(_0x2a470a,_0x3fcdf8,function(_0x23422b){var _0x1f559c=_0x1733ba;_0x464901['ok'](_0x73381[_0x1f559c(0xa4)](typeof _0x23422b,_0x73381[_0x1f559c(0xb2)]));});}}),_0x119584[_0x57396e(0x100)](it,_0x119584['ZNAEd'],function(){var _0x3ddf82=_0x57396e;_0x3bd137[_0x3ddf82(0xd0)]=_0x119584['NGzOQ'],_0x119584[_0x3ddf82(0xbf)](expressjwt,{'secret':_0x119584[_0x3ddf82(0x143)],'algorithms':[_0x3ddf82(0x146)],'algorithms':[_0x3ddf82(0x146)]})[_0x3ddf82(0xfb)]({'path':_0x119584['NGzOQ']})(_0x3bd137,_0x1bfa49,function(_0x48f5a4){assert['ok'](!_0x48f5a4);});}),_0x119584[_0x57396e(0x100)](it,_0x57396e(0xe9),function(){var _0x4c1647=_0x57396e,_0xb111f2={};_0xb111f2['method']=_0x119584[_0x4c1647(0xde)],_0xb111f2[_0x4c1647(0xfc)]={'access-control-request-headers':'sasa,\x20sras,\x20\x20authorization'},_0x119584['vjxng'](expressjwt,{'secret':_0x119584[_0x4c1647(0x143)],'algorithms':[_0x119584[_0x4c1647(0x9e)]]})(_0xb111f2,_0x1bfa49,function(_0x2eeeac){assert['ok'](!_0x2eeeac);});}),_0x119584['Ncyin'](it,_0x119584['PGTMM'],function(){var _0xceeaf9=_0x57396e;_0x3bd137[_0xceeaf9(0xfc)]={},_0x3bd137[_0xceeaf9(0xfc)][_0xceeaf9(0x107)]=_0xceeaf9(0xd9),expressjwt({'secret':_0x119584['rXeQZ'],'algorithms':[_0x119584[_0xceeaf9(0x9e)]]})(_0x3bd137,_0x1bfa49,function(_0x470ba4){var _0x5d6bce=_0xceeaf9;assert['ok'](_0x470ba4),assert['equal'](_0x470ba4[_0x5d6bce(0xb5)],_0x119584[_0x5d6bce(0x11d)]);});}),it(_0x119584[_0x57396e(0x8a)],function(){var _0x5f20ec=_0x57396e,_0x3b9ed9={'nKACf':_0x5f20ec(0xb0)};_0x3bd137[_0x5f20ec(0xfc)]={},_0x3bd137[_0x5f20ec(0xfc)]['authorization']=_0x5f20ec(0xcb),expressjwt({'secret':_0x119584[_0x5f20ec(0x143)],'algorithms':[_0x5f20ec(0x146)]})(_0x3bd137,_0x1bfa49,function(_0x129253){var _0x466ee6=_0x5f20ec;assert['ok'](_0x129253),assert[_0x466ee6(0xa1)](_0x129253[_0x466ee6(0xb5)],_0x3b9ed9[_0x466ee6(0x145)]);});}),it(_0x119584[_0x57396e(0x96)],function(){var _0x424a2a=_0x57396e,_0x10a24d={'hpFbb':function(_0x197253,_0x2fec8c){return _0x197253===_0x2fec8c;}};_0x3bd137['headers']={},_0x3bd137[_0x424a2a(0xfc)][_0x424a2a(0x107)]=_0x119584[_0x424a2a(0xc9)],_0x119584[_0x424a2a(0x10d)](expressjwt,{'secret':_0x119584[_0x424a2a(0x143)],'algorithms':[_0x119584[_0x424a2a(0x9e)]],'credentialsRequired':![]})(_0x3bd137,_0x1bfa49,function(_0x53ded8){var _0x137bd3=_0x424a2a;assert['ok'](_0x10a24d[_0x137bd3(0x12c)](typeof _0x53ded8,_0x137bd3(0x11b)));});}),it(_0x57396e(0xe7),function(){var _0x314d7a=_0x57396e;_0x3bd137[_0x314d7a(0xfc)]={},_0x3bd137[_0x314d7a(0xfc)][_0x314d7a(0x107)]=_0x119584[_0x314d7a(0x9b)],_0x119584['JwbEa'](expressjwt,{'secret':_0x314d7a(0x10b),'algorithms':[_0x119584['GzVoU']]})(_0x3bd137,_0x1bfa49,function(_0x2badde){var _0x401821=_0x314d7a;assert['ok'](_0x2badde),assert[_0x401821(0xa1)](_0x2badde[_0x401821(0xb5)],'invalid_token');});}),_0x119584[_0x57396e(0x100)](it,_0x119584[_0x57396e(0x140)],function(){var _0x453cb4=_0x57396e,_0x313c4d={'HIsEj':_0x453cb4(0xf0)};_0x3bd137['headers']={},_0x3bd137[_0x453cb4(0xfc)][_0x453cb4(0x107)]=_0x119584['Kwwol'],expressjwt({'secret':_0x453cb4(0x10b),'algorithms':[_0x453cb4(0x146)]})(_0x3bd137,_0x1bfa49,function(_0x524a87){var _0x24ba3f=_0x453cb4;assert['ok'](_0x524a87),assert[_0x24ba3f(0xa1)](_0x524a87[_0x24ba3f(0xb5)],_0x313c4d[_0x24ba3f(0xe8)]);});}),_0x119584['vMfTk'](it,_0x119584['oHIch'],function(){var _0x3bb353=_0x57396e,_0x31a21c=_0x3bb353(0x11e)['split']('|'),_0x28c4a1=0x0;while(!![]){switch(_0x31a21c[_0x28c4a1++]){case'0':var _0x310853=jwt[_0x3bb353(0x11c)]({'foo':_0x119584[_0x3bb353(0x8d)]},_0x8c29c4);continue;case'1':expressjwt({'secret':_0x3bb353(0xe2),'algorithms':['HS256']})(_0x3bd137,_0x1bfa49,function(_0x486619){var _0x294a94=_0x3bb353;assert['ok'](_0x486619),assert[_0x294a94(0xa1)](_0x486619[_0x294a94(0xb5)],_0x294a94(0xf0)),assert[_0x294a94(0xa1)](_0x486619[_0x294a94(0xe0)],'invalid\x20signature');});continue;case'2':var _0x8c29c4=_0x119584[_0x3bb353(0x131)];continue;case'3':_0x3bd137[_0x3bb353(0xfc)][_0x3bb353(0x107)]=_0x3bb353(0xf1)+_0x310853;continue;case'4':_0x3bd137['headers']={};continue;}break;}}),_0x119584[_0x57396e(0x92)](it,_0x57396e(0x8c),function(){var _0x6f8f4c=_0x57396e,_0x1788a7=_0x6f8f4c(0x9a),_0x494bfe=jwt[_0x6f8f4c(0x11c)]({'foo':_0x119584[_0x6f8f4c(0x8d)],'aud':_0x119584[_0x6f8f4c(0xb3)]},_0x1788a7,{'expiresIn':0x1f4});_0x3bd137[_0x6f8f4c(0xfc)]={},_0x3bd137['headers'][_0x6f8f4c(0x107)]=_0x6f8f4c(0xf1)+_0x494bfe,expressjwt({'secret':_0x119584[_0x6f8f4c(0x131)],'algorithms':[_0x119584[_0x6f8f4c(0x9e)]],'audience':_0x119584[_0x6f8f4c(0xa2)]})(_0x3bd137,_0x1bfa49,function(_0x332c70){var _0x31ed06=_0x6f8f4c;assert['ok'](_0x332c70),assert[_0x31ed06(0xa1)](_0x332c70[_0x31ed06(0xb5)],_0x119584[_0x31ed06(0xdb)]),assert[_0x31ed06(0xa1)](_0x332c70[_0x31ed06(0xe0)],_0x31ed06(0x137));});}),_0x119584[_0x57396e(0xd5)](it,'should\x20throw\x20if\x20token\x20is\x20expired',function(){var _0x4af7a7=_0x57396e,_0x5dfd44={'yUtzQ':_0x4af7a7(0x144),'wTUgY':_0x119584[_0x4af7a7(0x99)]},_0x57be91=_0x119584[_0x4af7a7(0x131)],_0x5ab752=jwt[_0x4af7a7(0x11c)]({'foo':'bar','exp':0x5265f279},_0x57be91);_0x3bd137['headers']={},_0x3bd137[_0x4af7a7(0xfc)][_0x4af7a7(0x107)]=_0x119584[_0x4af7a7(0x120)](_0x119584[_0x4af7a7(0xa7)],_0x5ab752),_0x119584[_0x4af7a7(0x12b)](expressjwt,{'secret':_0x4af7a7(0x9a),'algorithms':[_0x119584[_0x4af7a7(0x9e)]]})(_0x3bd137,_0x1bfa49,function(_0x33d335){var _0x30a826=_0x4af7a7;assert['ok'](_0x33d335),assert[_0x30a826(0xa1)](_0x33d335[_0x30a826(0xb5)],_0x30a826(0xf0)),assert['equal'](_0x33d335[_0x30a826(0x133)][_0x30a826(0xb6)],_0x5dfd44[_0x30a826(0x117)]),assert[_0x30a826(0xa1)](_0x33d335[_0x30a826(0xe0)],_0x5dfd44[_0x30a826(0x88)]);});}),_0x119584[_0x57396e(0x139)](it,'should\x20throw\x20if\x20token\x20issuer\x20is\x20wrong',function(){var _0x5365d7=_0x57396e,_0x14e22e=_0x119584['YJtCX'],_0x374d55=jwt['sign']({'foo':_0x5365d7(0xa5),'iss':_0x5365d7(0xaf)},_0x14e22e);_0x3bd137[_0x5365d7(0xfc)]={},_0x3bd137[_0x5365d7(0xfc)][_0x5365d7(0x107)]=_0x119584[_0x5365d7(0x120)](_0x119584[_0x5365d7(0xa7)],_0x374d55),_0x119584[_0x5365d7(0xc1)](expressjwt,{'secret':'shhhhhh','algorithms':['HS256'],'issuer':_0x5365d7(0x125)})(_0x3bd137,_0x1bfa49,function(_0x3bb9c3){var _0x4d2519=_0x5365d7;assert['ok'](_0x3bb9c3),assert[_0x4d2519(0xa1)](_0x3bb9c3[_0x4d2519(0xb5)],_0x119584['KNnia']),assert[_0x4d2519(0xa1)](_0x3bb9c3[_0x4d2519(0xe0)],'jwt\x20issuer\x20invalid.\x20expected:\x20http://wrong');});}),_0x119584[_0x57396e(0x142)](it,_0x119584[_0x57396e(0x116)],function(){var _0x580cb6=_0x57396e,_0x21d4e2=_0x119584[_0x580cb6(0x131)];function _0x17ba41(){var _0x32c0bb=_0x580cb6;throw new UnauthorizedError('invalid_token',{'message':_0x32c0bb(0x113)});}expressjwt({'secret':_0x119584['YJtCX'],'algorithms':[_0x119584[_0x580cb6(0x9e)]],'getToken':_0x17ba41})(_0x3bd137,_0x1bfa49,function(_0x15b98a){var _0x38b548=_0x580cb6;assert['ok'](_0x15b98a),assert[_0x38b548(0xa1)](_0x15b98a[_0x38b548(0xb5)],'invalid_token'),assert['equal'](_0x15b98a[_0x38b548(0xe0)],_0x38b548(0x113));});}),it(_0x119584['MrYcy'],function(){var _0x3decd9=_0x57396e,_0x3aa7d1=_0x3decd9(0x8f)[_0x3decd9(0xf9)]('|'),_0x5eeb73=0x0;while(!![]){switch(_0x3aa7d1[_0x5eeb73++]){case'0':_0x3bd137[_0x3decd9(0xfc)]=[];continue;case'1':var _0x8a10f2=_0x3decd9(0xdd);continue;case'2':var _0x230ed5=_0xfe486[_0x3decd9(0x112)]('.');continue;case'3':_0xfe486[0x1]=_0x59ebec;continue;case'4':expressjwt({'secret':_0x8a10f2,'algorithms':[_0x3decd9(0x146)]})(_0x3bd137,_0x1bfa49,function(_0x5e09f8){var _0x2e0de2=_0x3decd9;assert['ok'](_0x5e09f8),assert[_0x2e0de2(0xa1)](_0x5e09f8['code'],_0x2e0de2(0xf0)),assert[_0x2e0de2(0xa1)](_0x5e09f8['message'],_0x2e0de2(0x132));});continue;case'5':var _0x59ebec=new Buffer(_0x3decd9(0xee))['toString'](_0x3decd9(0x130));continue;case'6':_0x3bd137[_0x3decd9(0xfc)][_0x3decd9(0x107)]=_0x3decd9(0xf1)+_0x230ed5;continue;case'7':var _0xfe486=_0x4e3093[_0x3decd9(0xf9)]('.');continue;case'8':var _0x4e3093=jwt['sign']({'foo':'bar','iss':_0x3decd9(0x128)},_0x8a10f2);continue;}break;}}),_0x119584[_0x57396e(0x111)](it,_0x57396e(0x115),function(){var _0x1f8495=_0x57396e;if(_0x119584[_0x1f8495(0xd2)]!==_0x119584[_0x1f8495(0xfe)]){var _0x1a4221=_0x119584[_0x1f8495(0x131)],_0x24a158=jwt[_0x1f8495(0x11c)]({'foo':_0x119584[_0x1f8495(0x8d)],'exp':0x5265f279},_0x1a4221);_0x3bd137[_0x1f8495(0xfc)]={},_0x3bd137[_0x1f8495(0xfc)][_0x1f8495(0x107)]='Bearer\x20'+_0x24a158,expressjwt({'secret':_0x1a4221,'credentialsRequired':![],'algorithms':[_0x1f8495(0x146)]})(_0x3bd137,_0x1bfa49,function(_0x180d80){var _0x7260a6=_0x1f8495;assert['ok'](_0x180d80),assert[_0x7260a6(0xa1)](_0x180d80[_0x7260a6(0xb5)],_0x119584['KNnia']),assert['equal'](_0x180d80[_0x7260a6(0xe0)],_0x119584[_0x7260a6(0x99)]);});}else _0x4d2a7a[_0x1f8495(0xa1)](_0x1f8495(0xa5),_0x16962e[_0x1f8495(0xef)][_0x1f8495(0xed)][_0x1f8495(0xdc)]);}),_0x119584[_0x57396e(0xe1)](it,_0x119584[_0x57396e(0x135)],function(){var _0x4eff4b=_0x57396e,_0x1f432c=_0x119584[_0x4eff4b(0x93)]['split']('|'),_0x55d79c=0x0;while(!![]){switch(_0x1f432c[_0x55d79c++]){case'0':var _0x328b30=jwt['sign']({'foo':'bar','exp':0x5265f279},_0x5c9289);continue;case'1':_0x3bd137[_0x4eff4b(0xfc)]['authorization']=_0x119584[_0x4eff4b(0x120)](_0x119584['tnKtg'],_0x328b30);continue;case'2':_0x3bd137[_0x4eff4b(0xfc)]={};continue;case'3':var _0xddf4b8={'MQYHR':_0x119584[_0x4eff4b(0xdb)]};continue;case'4':var _0x5c9289='shhhhhh';continue;case'5':_0x119584['wwbys'](expressjwt,{'secret':_0x4eff4b(0xa0),'algorithms':['HS256'],'credentialsRequired':![]})(_0x3bd137,_0x1bfa49,function(_0x34c502){var _0x339da0=_0x4eff4b;assert['ok'](_0x34c502),assert[_0x339da0(0xa1)](_0x34c502[_0x339da0(0xb5)],_0xddf4b8['MQYHR']),assert[_0x339da0(0xa1)](_0x34c502[_0x339da0(0xe0)],_0x339da0(0x11f));});continue;}break;}});}),describe(_0x503658(0xd3),function(){var _0x1d529b=_0x503658,_0x2c9965={'qEkAM':'onNUh','aVbQU':'bar','mUSfj':_0x1d529b(0x9a),'yUfcN':_0x1d529b(0xf1),'yTkQP':function(_0x2c59b3,_0x35a1cb){return _0x2c59b3(_0x35a1cb);},'RrlWc':_0x1d529b(0xc5),'nzxnO':_0x1d529b(0x11b),'Puhyh':_0x1d529b(0xb8),'rTOdN':_0x1d529b(0x95),'fgscC':function(_0x1838d3,_0x159965){return _0x1838d3+_0x159965;},'NNryr':function(_0x5783d1,_0x3fcc1d){return _0x5783d1(_0x3fcc1d);},'xXVcX':_0x1d529b(0x146),'UmkZZ':_0x1d529b(0xef),'gnkhv':_0x1d529b(0xb4),'xBzSG':function(_0x3eac7f,_0x33d9c5){return _0x3eac7f(_0x33d9c5);},'WrjBS':function(_0x14420b,_0x5185b6){return _0x14420b===_0x5185b6;},'ihSte':_0x1d529b(0xaa),'zlahJ':'shhhh','koqor':function(_0x3c89d4,_0x1fd47d){return _0x3c89d4!==_0x1fd47d;},'Xtdrr':_0x1d529b(0x118),'yHoNQ':'secretA','OIgUZ':_0x1d529b(0xe3),'hOnPT':_0x1d529b(0x126),'jtfWb':function(_0x40f199,_0x5e8f76){return _0x40f199(_0x5e8f76);},'SMUCY':function(_0xf4873b,_0x20ac47,_0x203079){return _0xf4873b(_0x20ac47,_0x203079);},'Ekzwq':_0x1d529b(0x136),'nnZIw':_0x1d529b(0xc3),'OclKW':_0x1d529b(0xd8),'rypqP':function(_0xa67f3f,_0xd4466a,_0x431e25){return _0xa67f3f(_0xd4466a,_0x431e25);},'vzrbl':'should\x20work\x20if\x20no\x20authorization\x20header\x20and\x20credentials\x20are\x20not\x20required','nOxjR':function(_0x516507,_0x12fb2d,_0x1791fc){return _0x516507(_0x12fb2d,_0x1791fc);},'RDRHI':function(_0xd0c583,_0xac9c4f,_0x14d170){return _0xd0c583(_0xac9c4f,_0x14d170);},'igVrJ':_0x1d529b(0x110)},_0x99c8be={},_0x37c237={};it('should\x20work\x20if\x20authorization\x20header\x20is\x20valid\x20jwt',function(){var _0xc4165f=_0x1d529b,_0x4eba1f=_0x2c9965[_0xc4165f(0xb9)],_0x5df451=jwt[_0xc4165f(0x11c)]({'foo':_0x2c9965[_0xc4165f(0xf6)]},_0x4eba1f);_0x99c8be['headers']={},_0x99c8be['headers']['authorization']=_0xc4165f(0xf1)+_0x5df451,expressjwt({'secret':_0x4eba1f,'algorithms':[_0xc4165f(0x146)]})(_0x99c8be,_0x37c237,function(){var _0x19b43c=_0xc4165f;_0x2c9965[_0x19b43c(0xc7)]==='onNUh'?assert[_0x19b43c(0xa1)](_0x2c9965[_0x19b43c(0xf6)],_0x99c8be[_0x19b43c(0x106)][_0x19b43c(0xdc)]):_0x155a1d[_0x19b43c(0xa1)]('bar',_0xb5899e[_0x19b43c(0x106)]['foo']);});}),_0x2c9965['SMUCY'](it,_0x2c9965[_0x1d529b(0x108)],function(){var _0x394035=_0x1d529b,_0x50a3a5={'dVYnm':_0x2c9965['aVbQU']},_0x1896d3=_0x2c9965[_0x394035(0xb9)],_0x4710ef=jwt['sign']({'foo':_0x394035(0xa5)},_0x1896d3);_0x99c8be[_0x394035(0xfc)]={},_0x99c8be['headers'][_0x394035(0x107)]=_0x2c9965['yUfcN']+_0x4710ef,_0x2c9965[_0x394035(0xe6)](expressjwt,{'secret':_0x1896d3,'algorithms':['HS256'],'requestProperty':_0x2c9965['RrlWc']})(_0x99c8be,_0x37c237,function(){var _0x57f520=_0x394035;assert[_0x57f520(0xa1)](_0x50a3a5[_0x57f520(0xe5)],_0x99c8be[_0x57f520(0xef)][_0x57f520(0xed)][_0x57f520(0xdc)]);});}),_0x2c9965[_0x1d529b(0xca)](it,_0x2c9965[_0x1d529b(0x138)],function(){var _0x59647a=_0x1d529b,_0x4e1bb1=new Buffer(_0x2c9965[_0x59647a(0x149)],_0x59647a(0x130)),_0x1d7892=jwt[_0x59647a(0x11c)]({'foo':_0x2c9965[_0x59647a(0xf6)]},_0x4e1bb1);_0x99c8be[_0x59647a(0xfc)]={},_0x99c8be['headers'][_0x59647a(0x107)]=_0x2c9965['fgscC'](_0x2c9965[_0x59647a(0xad)],_0x1d7892),_0x2c9965[_0x59647a(0xd7)](expressjwt,{'secret':_0x4e1bb1,'algorithms':[_0x2c9965['xXVcX']]})(_0x99c8be,_0x37c237,function(){var _0x748d1d=_0x59647a,_0x1870e5={'MZyOZ':_0x2c9965['nzxnO']};_0x748d1d(0xbb)!==_0x2c9965['Puhyh']?assert[_0x748d1d(0xa1)](_0x748d1d(0xa5),_0x99c8be[_0x748d1d(0x106)][_0x748d1d(0xdc)]):_0x3c18d1['ok'](typeof _0x2c4827===_0x1870e5[_0x748d1d(0xcf)]);});}),it(_0x2c9965[_0x1d529b(0xab)],function(){var _0x3173e5=_0x1d529b,_0x10c808=_0x3173e5(0xfd)[_0x3173e5(0xf9)]('|'),_0x2611d9=0x0;while(!![]){switch(_0x10c808[_0x2611d9++]){case'0':_0x99c8be[_0x3173e5(0xfc)][_0x3173e5(0x107)]=_0x3173e5(0xf1)+_0x2c8a28;continue;case'1':var _0x2c8a28=jwt[_0x3173e5(0x11c)]({'foo':_0x2c9965[_0x3173e5(0xf6)]},_0x27f16c);continue;case'2':_0x99c8be[_0x3173e5(0xfc)]={};continue;case'3':var _0x27f16c=_0x2c9965[_0x3173e5(0xb9)];continue;case'4':_0x2c9965[_0x3173e5(0xe6)](expressjwt,{'secret':_0x27f16c,'algorithms':[_0x3173e5(0x146)],'userProperty':_0x2c9965['UmkZZ']})(_0x99c8be,_0x37c237,function(){var _0x45fe25=_0x3173e5;assert[_0x45fe25(0xa1)](_0x45fe25(0xa5),_0x99c8be['auth'][_0x45fe25(0xdc)]);});continue;}break;}}),_0x2c9965[_0x1d529b(0x89)](it,_0x1d529b(0xd1),function(){var _0x20a7ee=_0x1d529b,_0x5cde85=_0x2c9965[_0x20a7ee(0xb9)],_0x41054d=jwt['sign']({'foo':_0x2c9965['aVbQU']},_0x5cde85);_0x99c8be={},_0x37c237={},_0x99c8be[_0x20a7ee(0xfc)]={},_0x99c8be[_0x20a7ee(0xfc)][_0x20a7ee(0x107)]=_0x2c9965[_0x20a7ee(0xad)]+_0x41054d,expressjwt({'secret':_0x5cde85,'algorithms':[_0x20a7ee(0x146)],'resultProperty':_0x2c9965[_0x20a7ee(0x10a)]})(_0x99c8be,_0x37c237,function(){var _0x59e61a=_0x20a7ee;assert['equal'](_0x2c9965[_0x59e61a(0xf6)],_0x37c237['locals']['user'][_0x59e61a(0xdc)]),assert['ok'](typeof _0x99c8be[_0x59e61a(0x106)]===_0x2c9965[_0x59e61a(0x103)]);});}),it(_0x1d529b(0xc6),function(){var _0x2a30b9=_0x1d529b,_0x47b083={'rMELJ':function(_0x1b1288,_0x1ad47a){return _0x1b1288===_0x1ad47a;},'SHPtb':_0x2c9965['nzxnO']},_0x1c2c62='shhhhhh',_0x2631a9=jwt[_0x2a30b9(0x11c)]({'foo':_0x2c9965[_0x2a30b9(0xf6)]},_0x1c2c62);_0x99c8be={},_0x37c237={},_0x99c8be['headers']={},_0x99c8be['headers'][_0x2a30b9(0x107)]=_0x2c9965[_0x2a30b9(0x13a)](_0x2c9965['yUfcN'],_0x2631a9),_0x2c9965[_0x2a30b9(0x12a)](expressjwt,{'secret':_0x1c2c62,'algorithms':[_0x2a30b9(0x146)],'userProperty':_0x2c9965['UmkZZ'],'resultProperty':_0x2a30b9(0xb4)})(_0x99c8be,_0x37c237,function(){var _0x142ea8=_0x2a30b9;assert[_0x142ea8(0xa1)](_0x142ea8(0xa5),_0x37c237[_0x142ea8(0xa8)][_0x142ea8(0x106)][_0x142ea8(0xdc)]),assert['ok'](_0x47b083[_0x142ea8(0x86)](typeof _0x99c8be['auth'],_0x47b083[_0x142ea8(0x134)]));});}),it(_0x2c9965[_0x1d529b(0xce)],function(){var _0x358241=_0x1d529b;_0x358241(0xba)!==_0x2c9965[_0x358241(0x13f)]?(_0x99c8be={},_0x2c9965['yTkQP'](expressjwt,{'secret':_0x2c9965['zlahJ'],'algorithms':[_0x2c9965[_0x358241(0xbe)]],'credentialsRequired':![]})(_0x99c8be,_0x37c237,function(_0x254705){var _0x57e4b7=_0x358241;assert(_0x2c9965[_0x57e4b7(0x12f)](typeof _0x254705,_0x2c9965[_0x57e4b7(0x103)]));})):(_0x4be1e4['ok'](_0x38523c),_0x3d128f[_0x358241(0xa1)](_0x5775a2[_0x358241(0xb5)],_0x358241(0xf0)),_0x8bf9b2[_0x358241(0xa1)](_0xa25cf4[_0x358241(0xe0)],_0x358241(0x122)));}),_0x2c9965['SMUCY'](it,_0x1d529b(0x10f),function(){var _0x54d688=_0x1d529b;_0x99c8be={},expressjwt({'secret':_0x54d688(0x10b),'algorithms':['HS256']})(_0x99c8be,_0x37c237,function(_0x28f445){var _0x178e85=_0x54d688;_0x2c9965[_0x178e85(0xd7)](assert,_0x2c9965[_0x178e85(0x141)](typeof _0x28f445,_0x2c9965[_0x178e85(0x103)]));});}),_0x2c9965[_0x1d529b(0x109)](it,_0x1d529b(0x10e),function(){var _0x2ae120=_0x1d529b,_0xca5420={},_0x47f2cc=jwt[_0x2ae120(0x11c)]({'foo':_0x2c9965['aVbQU']},_0x2c9965[_0x2ae120(0x13c)]);_0xca5420[_0x2ae120(0xfc)]={},_0xca5420['headers'][_0x2ae120(0x107)]=_0x2ae120(0xf1)+_0x47f2cc,expressjwt({'secret':_0x2c9965[_0x2ae120(0x119)],'algorithms':[_0x2ae120(0x146)]})(_0xca5420,_0x37c237,function(_0x1547f1){var _0x25678d=_0x2ae120,_0x52dc70=_0x1547f1['stack']['indexOf'](_0x2c9965[_0x25678d(0xdf)]);assert[_0x25678d(0xa1)](_0x52dc70,0x0,_0x25678d(0xfa));});}),_0x2c9965[_0x1d529b(0x123)](it,_0x2c9965[_0x1d529b(0x87)],function(){var _0x4954fe=_0x1d529b,_0x42f72c={'RmPmz':_0x4954fe(0xa5)},_0x844d7f=_0x4954fe(0x9a),_0x5a52d3=jwt[_0x4954fe(0x11c)]({'foo':_0x2c9965[_0x4954fe(0xf6)]},_0x844d7f);_0x99c8be['headers']={},_0x99c8be['query']={},_0x99c8be['query']['token']=_0x5a52d3;function _0x4017c2(_0x30a91e){var _0x356dae=_0x4954fe;return _0x30a91e[_0x356dae(0xff)][_0x356dae(0xed)];}_0x2c9965[_0x4954fe(0x12a)](expressjwt,{'secret':_0x844d7f,'algorithms':[_0x2c9965[_0x4954fe(0xbe)]],'getToken':_0x4017c2})(_0x99c8be,_0x37c237,function(){assert['equal'](_0x42f72c['RmPmz'],_0x99c8be['user']['foo']);});}),it('should\x20work\x20with\x20a\x20secretCallback\x20function\x20that\x20accepts\x20header\x20argument',function(){var _0xaa0786=_0x1d529b,_0x57f8cb={'KNRDw':_0x2c9965[_0xaa0786(0xf6)]};if(_0xaa0786(0x9d)!==_0x2c9965['hOnPT']){var _0x1aa4eb=_0xaa0786(0x9a),_0x1086e7=function(_0xba6571,_0x581288,_0xca138f,_0x123aac){var _0x66205=_0xaa0786;assert[_0x66205(0xa1)](_0x581288[_0x66205(0xb7)],_0x2c9965[_0x66205(0xbe)]),assert[_0x66205(0xa1)](_0xca138f[_0x66205(0xdc)],_0x66205(0xa5)),process['nextTick'](function(){return _0x123aac(null,_0x1aa4eb);});},_0x303001=jwt[_0xaa0786(0x11c)]({'foo':_0xaa0786(0xa5)},_0x1aa4eb);_0x99c8be[_0xaa0786(0xfc)]={},_0x99c8be['headers'][_0xaa0786(0x107)]=_0xaa0786(0xf1)+_0x303001,_0x2c9965['jtfWb'](expressjwt,{'secret':_0x1086e7,'algorithms':[_0x2c9965[_0xaa0786(0xbe)]]})(_0x99c8be,_0x37c237,function(){var _0x1901ea=_0xaa0786;assert[_0x1901ea(0xa1)](_0x57f8cb[_0x1901ea(0xbd)],_0x99c8be['user'][_0x1901ea(0xdc)]);});}else _0x119621({'secret':_0xaa0786(0x10b),'algorithms':'foo'});});});