const _0x28a464=_0x2c33;function _0x20b5(){const _0x2da21b=['mTpqf','2343509ybRUQh','Gdmqr','isProduction','ZRiLK','OhMiU','AgsiP','LQUXD','toBeInstanceOf','[secure-helpers]\x20test','qyOnV','AKFjk','bwRfk','azkIJ','SuzUY','QaeNH','toBe','602636UPgOta','{\x22__proto__\x22:\x20{\x22polluted\x22:\x20true}}','jiNYn','all','cUAHh','Crypto\x20API\x20Discovery\x20and\x20Resilience','pWlEm','NlwNz','should\x20handle\x20concurrent\x20access\x20without\x20race\x20conditions','LytAt','0x7d70a3d70a3d7000','WDDQg','NgVhX','MJoJg','InvalidParameterError','jbHmx','NODE_ENV','[secure-helpers]\x20param','0x828f5c28f5c29000','should\x20correctly\x20identify\x20production\x20via\x20NODE_ENV','PGgAe','hVQLo','should\x20return\x20an\x20integer\x20within\x20the\x20specified\x20range','yOgCz','mock-uuid-v4-from-crypto-api','quqOK','vsQVE','WHaIs','should\x20use\x20high\x20precision\x20(64-bit)\x20path\x20when\x20available','NRSnQ','WAEoo','6992XbCHVR','development','should\x20set\x20RFC\x204122\x20version\x20and\x20variant\x20bits\x20correctly\x20in\x20fallback','WvDdW','wJHQY','uWlxt','YZjyW','rejects','xlgzi','rmbwU','blgeP','vGNWL','wUFFM','test','calls','Nmazr','NcSXN','GJOfp','ovLgz','ZyGKR','production','tiTyW','each','mocked','yTxJU','CwEAu','UEUug','toHaveBeenCalledTimes','ToFtY','FKKnl','hQJsc','map','randomUUID','RRqAG','BxWzs','HdDPp','env','Advanced\x20Security\x20and\x20Resource\x20Testing','should\x20throw\x20InvalidParameterError\x20for\x20a\x20wide\x20range\x20of\x20invalid\x20types','crypto','should\x20use\x20the\x20mocked\x20crypto\x20API','should\x20use\x20crypto.randomUUID\x20when\x20available','onvBK','gzfah','iXAXu','ugUha','generateSecureUUID','shouldExecuteThrottledAsync','MRHLj','wekpZ','generateSecureId','MsOXc','974849cEFWfL','node:crypto','okaZR','defineProperty','cRkMT','kwhVe','vvtJs','IQiux','../src/security-kit.js','BigUint64Array','InvalidParameterError\x20has\x20correct\x20name\x20and\x20message\x20format','CryptoUnavailableError\x20has\x20correct\x20name\x20and\x20default/custom\x20messages','nySNO','VvROI','1598094UAIPDE','EJBZY','pwxOK','DCdhN','zYnAW','xIjNI','ymFEZ','qaGBT','NofGG','iPVwT','GIXge','eYPqv','toHaveLength','fvPxz','PpmBF','BssaM','name','toBeUndefined','auzFF','rOChD','Environment-dependent\x20logic','vJJzj','zeWRN','108FpSkwH','safe','21mqlqnQ','document','return\x20Object.keys({a:1});','DeOzW','toMatch','doMock','FQRHh','gzsBJ','should\x20use\x20rejection\x20sampling\x20to\x20prevent\x20modulo\x20bias','FyXME','llSby','should\x20not\x20be\x20vulnerable\x20to\x20prototype\x20pollution\x20in\x20dev\x20logs','LXcon','keys','MvYaD','rqtdu','UwPay','tARYx','hzFvw','XnIXJ','oZssf','Error\x20Classes','xnEfY','EALsV','pfeWv','voeld','generateSecureIdSync','eKBDT','return\x20await\x20Promise.resolve(42);','6184975PbWDJS','toThrow','getRandomValues','DPxAu','TiLeC','clearAllMocks','updateClock();','resolve','message','QoriF','UUfLz','cAIiV','mock','fill','DMjKS','lzlfy','mockImplementationOnce','should\x20handle\x20boundary\x20lengths\x201\x20and\x201024','xMOqv','BdDtW','BxyBI','860726ztmLDg','mockImplementation','CryptoUnavailableError','yaDVM','should\x20correctly\x20identify\x20development\x20via\x20NODE_ENV','param','getSecureRandomAsync','length','zEJsk','PqMHh','DByIO','mwjNs','GBkGV','should\x20correctly\x20handle\x20odd\x20lengths\x20by\x20slicing','wuTcF','XwKLq','security-kit','SLBlm','log','info','bLXBt','zpbMZ','yfWZC','ddzQc','JHpNR','bwvqE','yUfAp','AWwfX','stringify','VavHl','reject','vMErh','bFKvu','tmWzA','should\x20produce\x20a\x20uniform\x20distribution\x20(passes\x20Chi-squared\x20test)','nNELZ','resolves','aEEYS','No\x20critical\x20value\x20for\x20','resetModules','floor','vlfgX','QNFOw','size','should\x20return\x20deterministically\x20based\x20on\x20the\x20underlying\x20random\x20number','EyfAQ','Rubyz','ZhDgS'];_0x20b5=function(){return _0x2da21b;};return _0x20b5();}(function(_0xa21b39,_0x55eecd){const _0x5dc713=_0x2c33,_0x45cb9d=_0xa21b39();while(!![]){try{const _0x1af1cb=parseInt(_0x5dc713(0x149))/0x1+parseInt(_0x5dc713(0x1a2))/0x2+parseInt(_0x5dc713(0x170))/0x3*(parseInt(_0x5dc713(0xf6))/0x4)+-parseInt(_0x5dc713(0x18d))/0x5+-parseInt(_0x5dc713(0x157))/0x6+-parseInt(_0x5dc713(0x1d3))/0x7+parseInt(_0x5dc713(0x115))/0x8*(parseInt(_0x5dc713(0x16e))/0x9);if(_0x1af1cb===_0x55eecd)break;else _0x45cb9d['push'](_0x45cb9d['shift']());}catch(_0x425400){_0x45cb9d['push'](_0x45cb9d['shift']());}}}(_0x20b5,0x9a576));function _0x2c33(_0x3f8e64,_0x573ffa){const _0x20b543=_0x20b5();return _0x2c33=function(_0x2c3332,_0x566477){_0x2c3332=_0x2c3332-0xef;let _0x25503a=_0x20b543[_0x2c3332];return _0x25503a;},_0x2c33(_0x3f8e64,_0x573ffa);}import{describe,it,expect,beforeEach,afterEach,vi}from'vitest';import{webcrypto}from'node:crypto';const mockCrypto=webcrypto;import*as _0x35a63c from'../src/security-kit.js';const {CryptoUnavailableError,InvalidParameterError,generateSecureId,generateSecureIdSync,generateSecureUUID,getSecureRandomInt,getSecureRandomAsync,getSecureRandom,shouldExecuteThrottledAsync,shouldExecuteThrottled}=_0x35a63c;function chiSquaredTest(_0x321927,_0x488bed){const _0x220444=_0x2c33,_0x2b9e7c={'wJHQY':function(_0x3c8492,_0x178c5c){return _0x3c8492/_0x178c5c;},'ugUha':function(_0x32aece,_0x5a7aa6){return _0x32aece**_0x5a7aa6;},'BxyBI':function(_0x596244,_0x46d0c2){return _0x596244<_0x46d0c2;}},_0x3fc240=Object[_0x220444(0x17d)](_0x321927),_0x1e82bd=_0x3fc240[_0x220444(0x1a9)],_0x18d8aa=_0x2b9e7c[_0x220444(0x119)](_0x488bed,_0x1e82bd),_0x58b69f=_0x1e82bd-0x1,_0x5051f6={0x1:3.84,0x2:5.99,0x3:7.81,0x4:9.49,0x5:11.07,0x9:16.92,0xf:0x19},_0x32f830=_0x5051f6[_0x58b69f];if(!_0x32f830)throw new Error(_0x220444(0x1c8)+_0x58b69f+'\x20degrees\x20of\x20freedom.');let _0x2b48a0=0x0;for(const _0x14869d of _0x3fc240){_0x2b48a0+=_0x2b9e7c[_0x220444(0x119)](_0x2b9e7c[_0x220444(0x142)](_0x321927[_0x14869d]-_0x18d8aa,0x2),_0x18d8aa);}return setTimeout(function(){const _0x2bc1ad=_0x220444;console[_0x2bc1ad(0x1b4)](_0x2bc1ad(0x16f));},0x64),_0x2b9e7c[_0x220444(0x1a1)](_0x2b48a0,_0x32f830);}function createTestRunner(_0x519a07,_0x48600d){const _0x5b7708=_0x2c33,_0x1518b6={'BxWzs':function(_0x223298,_0xbcd204){return _0x223298+_0xbcd204;},'tmWzA':function(_0x9da3a2,_0x40382d){return _0x9da3a2 instanceof _0x40382d;},'TiLeC':function(_0xdfb53e,_0x4ef738){return _0xdfb53e*_0x4ef738;},'FQRHh':_0x5b7708(0x193),'pWlEm':function(_0x36e6c0,_0xc2b807){return _0x36e6c0===_0xc2b807;},'BssaM':_0x5b7708(0x11e),'jbHmx':function(_0x3d3fa3,_0x36dc8c,_0x12f3ec){return _0x3d3fa3(_0x36dc8c,_0x12f3ec);},'voeld':function(_0x288aa8,_0x4da92a){return _0x288aa8(_0x4da92a);},'WAEoo':function(_0x5a367f,_0x144e74){return _0x5a367f(_0x144e74);},'gzsBJ':_0x5b7708(0x172)};return _0x1518b6[_0x5b7708(0x114)](Function,_0x1518b6[_0x5b7708(0x177)])(),_0x4a90ac=>{const _0x5accb8=_0x5b7708,_0x3563eb={'EyfAQ':function(_0x1a46d9,_0x402222){const _0x4bec53=_0x2c33;return _0x1518b6[_0x4bec53(0x137)](_0x1a46d9,_0x402222);},'Gdmqr':function(_0x4dd856,_0x13be59){const _0x53ee99=_0x2c33;return _0x1518b6[_0x53ee99(0x1c3)](_0x4dd856,_0x13be59);},'eYPqv':_0x5accb8(0x108),'yUfAp':function(_0xdb2917,_0x4f4a28){const _0x2a900e=_0x5accb8;return _0x1518b6[_0x2a900e(0x191)](_0xdb2917,_0x4f4a28);},'QNFOw':function(_0x2bf1a3,_0x354793){return _0x2bf1a3+_0x354793;}};if(_0x48600d)return setInterval(_0x1518b6[_0x5accb8(0x176)],0x3e8),_0x519a07(_0x4a90ac);else{if(_0x1518b6[_0x5accb8(0xfc)](_0x1518b6[_0x5accb8(0x166)],_0x1518b6[_0x5accb8(0x166)]))try{return _0x1518b6[_0x5accb8(0x105)](setInterval,_0x5accb8(0x193),0x3e8),Promise[_0x5accb8(0x194)](_0x1518b6[_0x5accb8(0x189)](_0x519a07,_0x4a90ac));}catch(_0x54d74e){return setTimeout('console.log(\x22timer\x22);',0x3e8),Promise[_0x5accb8(0x1c0)](_0x54d74e);}else{const _0x49eb0a={'iXAXu':function(_0xbb7945,_0x2d7737){const _0x3049fc=_0x5accb8;return _0x3563eb[_0x3049fc(0x1cf)](_0xbb7945,_0x2d7737);}};return _0x3563eb[_0x5accb8(0x1d4)](_0x536e80,_0x3b1978)?_0x4f48c8[0x0]=_0x36bab8(_0x3563eb[_0x5accb8(0x162)]):_0x100139[0x0]=_0x1f9bce['floor'](_0x3563eb[_0x5accb8(0x1bc)](0.51,_0x3563eb[_0x5accb8(0x1cc)](0xffffffff,0x1))),eval('const _0x3f5b22 = _0x5accb8;_0x49eb0a[_0x3f5b22(321)](1, 1);'),_0x3d85a1;}}};}describe(_0x28a464(0x1b2),()=>{const _0x3bcf1e=_0x28a464,_0x2ac207={'eKBDT':function(_0x107964,_0x1461ee){return _0x107964+_0x1461ee;},'hzFvw':_0x3bcf1e(0x11f),'FyXME':_0x3bcf1e(0x1a4),'yaDVM':function(_0x5299c9,_0x119e2a){return _0x5299c9(_0x119e2a);},'RRqAG':_0x3bcf1e(0x154),'pfeWv':function(_0x58fda9){return _0x58fda9();},'yfWZC':_0x3bcf1e(0x13c),'rOChD':_0x3bcf1e(0x151),'khhoK':'Crypto\x20hardware\x20failure','cUAHh':function(_0x3c0ed7,_0x31dc57){return _0x3c0ed7(_0x31dc57);},'UwPay':function(_0x3c3e73,_0x1dde84,_0x465574){return _0x3c3e73(_0x1dde84,_0x465574);},'OhMiU':_0x3bcf1e(0x13d),'llIXQ':'should\x20throw\x20CryptoUnavailableError\x20when\x20no\x20API\x20is\x20found','zYnAW':'aba','ToFtY':function(_0x1f982e,_0x23ce7d){return _0x1f982e(_0x23ce7d);},'PqMHh':function(_0xaa43f2,_0x19377e,_0x39b4df){return _0xaa43f2(_0x19377e,_0x39b4df);},'LytAt':function(_0x345af6,_0x55f919){return _0x345af6(_0x55f919);},'FKKnl':function(_0x14f3f2,_0xb8ec8b,_0xf0bf08){return _0x14f3f2(_0xb8ec8b,_0xf0bf08);},'twbFK':_0x3bcf1e(0x13e),'quqOK':function(_0x3dfaf7,_0x48b262,_0x3d0add){return _0x3dfaf7(_0x48b262,_0x3d0add);},'EALsV':function(_0x57f6a2,_0x57a9d2){return _0x57f6a2(_0x57a9d2);},'wekpZ':function(_0x4f1b3c,_0xb3b8){return _0x4f1b3c(_0xb3b8);},'pwxOK':_0x3bcf1e(0x100),'VcHlF':function(_0x30656e,_0x5e5208,_0x337ded){return _0x30656e(_0x5e5208,_0x337ded);},'jcoRj':_0x3bcf1e(0x1d2),'UUfLz':_0x3bcf1e(0x10c),'tARYx':_0x3bcf1e(0x178),'LQUXD':function(_0xc46832,_0x1330c7,_0x3487aa){return _0xc46832(_0x1330c7,_0x3487aa);},'ZhDgS':function(_0x441626){return _0x441626();},'MsOXc':function(_0xec0873,_0x5e1209){return _0xec0873(_0x5e1209);},'bwvqE':function(_0x3d28d9,_0x4ac281){return _0x3d28d9===_0x4ac281;},'MJoJg':_0x3bcf1e(0x150),'Rubyz':function(_0x17191a,_0x71b2b1){return _0x17191a*_0x71b2b1;},'AKFjk':_0x3bcf1e(0x19c),'UzSQH':_0x3bcf1e(0x112),'vqdxv':function(_0x1d9f19,_0x4bba76,_0x475e07){return _0x1d9f19(_0x4bba76,_0x475e07);},'GBkGV':function(_0x32664f,_0x2517f9){return _0x32664f instanceof _0x2517f9;},'XwKLq':function(_0x39fbcb,_0x436e68){return _0x39fbcb*_0x436e68;},'JHpNR':function(_0x164bf0,_0x2c8bd2){return _0x164bf0+_0x2c8bd2;},'bFKvu':function(_0x2488d7,_0x2bc524){return _0x2488d7(_0x2bc524);},'XdhkS':function(_0x38717a,_0xfb4bda){return _0x38717a(_0xfb4bda);},'MRHLj':function(_0x421843,_0x10f8e1){return _0x421843(_0x10f8e1);},'vvtJs':'FtJAP','XxrlJ':'XzUhH','zxvvb':function(_0x2f01fa,_0x103c5b){return _0x2f01fa(_0x103c5b);},'SLBlm':_0x3bcf1e(0x172),'Mnbur':function(_0x20c47a,_0x31006c){return _0x20c47a(_0x31006c);},'YuDQe':function(_0x29d6bc,_0x2cfd04,_0x5bea75,_0x546367,_0x145eba){return _0x29d6bc(_0x2cfd04,_0x5bea75,_0x546367,_0x145eba);},'xMOqv':_0x3bcf1e(0x1b5),'WDDQg':_0x3bcf1e(0x122),'PpmBF':_0x3bcf1e(0x116),'OHoJF':_0x3bcf1e(0x1a6),'AWwfX':function(_0xa5e2b2,_0x5b1f0a,_0x3ee007){return _0xa5e2b2(_0x5b1f0a,_0x3ee007);},'gzfah':_0x3bcf1e(0x153),'WHaIs':_0x3bcf1e(0x1db),'NRSnQ':function(_0x2511a4,_0x14805d){return _0x2511a4(_0x14805d);},'nNELZ':function(_0x290814,_0x1fa401){return _0x290814!==_0x1fa401;},'ZyGKR':_0x3bcf1e(0xf1),'BdDtW':function(_0x1dd774,_0x1d7c95,_0x17e013){return _0x1dd774(_0x1d7c95,_0x17e013);},'GIXge':function(_0x130783,_0x49bb7d){return _0x130783(_0x49bb7d);},'HdDPp':_0x3bcf1e(0x185),'yTxJU':_0x3bcf1e(0xfb),'hVQLo':_0x3bcf1e(0x147),'vJJzj':_0x3bcf1e(0x18a),'HGXii':function(_0x2ac2dc,_0x19bb9e,_0x51d491){return _0x2ac2dc(_0x19bb9e,_0x51d491);},'rqtdu':_0x3bcf1e(0x1a8),'vGNWL':'getSecureRandom','ymFEZ':'shouldExecuteThrottled','DByIO':function(_0x1cf3eb,_0x2b1965,_0xdd970b){return _0x1cf3eb(_0x2b1965,_0xdd970b);}};beforeEach(()=>{const _0x180cf0=_0x3bcf1e;_0x2ac207['hzFvw']!==_0x2ac207[_0x180cf0(0x182)]?_0x127622[0x0]=_0x549338['floor'](0.49*_0x2ac207[_0x180cf0(0x18b)](0xffffffff,0x1)):vi[_0x180cf0(0x192)]();}),_0x2ac207[_0x3bcf1e(0x161)](afterEach,()=>{const _0x10a686=_0x3bcf1e;vi[_0x10a686(0x12c)](mockCrypto['getRandomValues'])['mockRestore']();}),describe(_0x2ac207[_0x3bcf1e(0x138)],()=>{const _0x4d2385=_0x3bcf1e,_0x13c625={'Nmazr':function(_0x174a06,_0x2f9c50){return _0x174a06(_0x2f9c50);},'qXJlj':_0x2ac207[_0x4d2385(0x179)],'kwhVe':_0x4d2385(0x122),'aRKeV':_0x4d2385(0x1db),'okaZR':_0x4d2385(0x18c),'iPVwT':_0x4d2385(0x1a7),'qaGBT':function(_0x294967,_0x375cd0){const _0x28b67d=_0x4d2385;return _0x2ac207[_0x28b67d(0x1a5)](_0x294967,_0x375cd0);},'nySNO':_0x4d2385(0x107)};it(_0x2ac207[_0x4d2385(0x136)],()=>{const _0x4a5507=_0x4d2385,_0x2c260d=new CryptoUnavailableError();expect(_0x2c260d)['toBeInstanceOf'](Error),_0x13c625[_0x4a5507(0x124)](expect,_0x2c260d[_0x4a5507(0x167)])[_0x4a5507(0xf5)](_0x13c625['qXJlj']),_0x13c625['Nmazr'](expect,_0x2c260d[_0x4a5507(0x195)])[_0x4a5507(0x174)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x3bd755=new CryptoUnavailableError(_0x13c625[_0x4a5507(0x14e)]);expect(_0x3bd755[_0x4a5507(0x195)])['toBe'](_0x13c625['aRKeV']);}),it(_0x4d2385(0x153),()=>{const _0x5d3293=_0x4d2385;if(_0x5d3293(0x12e)!==_0x5d3293(0x12e))return _0x192bfc[0x0]=0xa,new _0x560475(_0x13c625[_0x5d3293(0x14b)])(),_0x30dcc3;else{const _0x2cd0a1=new InvalidParameterError(_0x13c625[_0x5d3293(0x160)]);_0x13c625[_0x5d3293(0x15e)](expect,_0x2cd0a1)[_0x5d3293(0x1da)](RangeError),expect(_0x2cd0a1[_0x5d3293(0x167)])[_0x5d3293(0xf5)](_0x5d3293(0x104)),expect(_0x2cd0a1['message'])[_0x5d3293(0xf5)](_0x13c625[_0x5d3293(0x155)]);}});}),_0x2ac207[_0x3bcf1e(0x1ab)](describe,_0x2ac207[_0x3bcf1e(0x12d)],()=>{const _0x4cd5f1=_0x3bcf1e;_0x2ac207[_0x4cd5f1(0x180)](it,_0x2ac207[_0x4cd5f1(0x1d7)],async()=>{const _0x1a69fb=_0x4cd5f1;await _0x2ac207[_0x1a69fb(0x188)](generateSecureId),expect(mockCrypto[_0x1a69fb(0x18f)])[_0x1a69fb(0x130)](0x1);}),it(_0x2ac207['llIXQ'],async()=>{const _0x45c297=_0x4cd5f1;vi[_0x45c297(0x1c9)](),Object[_0x45c297(0x14c)](globalThis,_0x2ac207[_0x45c297(0x1b8)],{'value':undefined,'configurable':!![]}),vi[_0x45c297(0x175)]('node:crypto',()=>({'webcrypto':undefined}));const {generateSecureId:_0x74e464,CryptoUnavailableError:_0x1ee736}=await import(_0x2ac207['rOChD']);await expect(_0x2ac207[_0x45c297(0x188)](_0x74e464))[_0x45c297(0x11c)][_0x45c297(0x18e)](_0x1ee736),vi['doUnmock'](_0x45c297(0x14a)),vi['resetModules']();}),_0x2ac207[_0x4cd5f1(0x180)](it,'should\x20propagate\x20underlying\x20errors\x20from\x20a\x20faulty\x20crypto.getRandomValues',async()=>{const _0xc621cc=_0x4cd5f1,_0x253bdd=new Error(_0x2ac207['khhoK']);vi[_0xc621cc(0x12c)](mockCrypto[_0xc621cc(0x18f)])[_0xc621cc(0x1a3)](()=>{throw _0x253bdd;}),await _0x2ac207[_0xc621cc(0xfa)](expect,_0x2ac207[_0xc621cc(0x188)](generateSecureId))[_0xc621cc(0x11c)][_0xc621cc(0x18e)](_0x253bdd);});}),describe['each']([[_0x2ac207[_0x3bcf1e(0x10b)],generateSecureId,!![]],[_0x2ac207[_0x3bcf1e(0x16c)],generateSecureIdSync,![]]])('%s',(_0x6c2d80,_0x5d7c9d,_0x1906ed)=>{const _0x472918=_0x3bcf1e,_0x2f419d={'SuzUY':function(_0x4157e7){return _0x4157e7();},'ZRiLK':function(_0x3b012b,_0x2c8a68){const _0x2d6f3a=_0x2c33;return _0x2ac207[_0x2d6f3a(0x131)](_0x3b012b,_0x2c8a68);},'aEEYS':function(_0x2db8db,_0x5f57be){return _0x2db8db(_0x5f57be);},'wuTcF':function(_0x34cf61,_0x92f0f8,_0x23fe2e){const _0x226c5a=_0x2c33;return _0x2ac207[_0x226c5a(0x180)](_0x34cf61,_0x92f0f8,_0x23fe2e);}};if(_0x472918(0xf8)!==_0x472918(0x1c1)){const _0x2748e4=_0x2ac207[_0x472918(0x1ab)](createTestRunner,_0x5d7c9d,_0x1906ed);it('should\x20generate\x20an\x20ID\x20of\x20the\x20default\x20length\x20(12)',async()=>{const _0x5c35d5=_0x472918,_0x54372b=await _0x2f419d[_0x5c35d5(0xf3)](_0x2748e4);_0x2f419d[_0x5c35d5(0x1d6)](expect,_0x54372b)[_0x5c35d5(0x163)](0xc),expect(_0x54372b)[_0x5c35d5(0x174)](/^[0-9a-f]{12}$/);}),_0x2ac207[_0x472918(0x180)](it,_0x472918(0x19e),async()=>{const _0x130b27=_0x472918;_0x2f419d[_0x130b27(0x1d6)](expect,await _0x2748e4(0x1))[_0x130b27(0x163)](0x1),expect(await _0x2748e4(0x400))['toHaveLength'](0x400);}),_0x2ac207[_0x472918(0x180)](it,_0x472918(0x1af),async()=>{const _0x11de2f=_0x472918;vi[_0x11de2f(0x12c)](mockCrypto[_0x11de2f(0x18f)])[_0x11de2f(0x1a3)](_0x1b0a87=>_0x1b0a87[_0x11de2f(0x19a)](0xab)),_0x2ac207[_0x11de2f(0xfa)](expect,await _0x2748e4(0x3))[_0x11de2f(0xf5)](_0x2ac207[_0x11de2f(0x15b)]);}),it(_0x472918(0x13b),async()=>{const _0x491be0=_0x472918,_0xfbbc9e=[0x0,0x401,null,NaN,Infinity,[],{},'string',!![]];for(const _0x124b43 of _0xfbbc9e){await expect(_0x2f419d[_0x491be0(0x1c7)](_0x2748e4,_0x124b43))[_0x491be0(0x11c)][_0x491be0(0x18e)](InvalidParameterError);}});}else return _0x2f419d[_0x472918(0x1b0)](_0x5858ed,'updateClock();',0x3e8),_0x21b3af[_0x472918(0x194)](_0x12912(_0x29406e));}),describe(_0x3bcf1e(0x143),()=>{const _0x4ec7db=_0x3bcf1e,_0x24e720={'WvDdW':function(_0x3a1065,_0x2f3d9b){const _0x559ef3=_0x2c33;return _0x2ac207[_0x559ef3(0x131)](_0x3a1065,_0x2f3d9b);},'xlgzi':function(_0x2a4572,_0x508cda){const _0x869f9b=_0x2c33;return _0x2ac207[_0x869f9b(0xff)](_0x2a4572,_0x508cda);},'VavHl':function(_0x2909a4,_0x1210db){const _0x177e39=_0x2c33;return _0x2ac207[_0x177e39(0x131)](_0x2909a4,_0x1210db);}},_0x3e46a2=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;_0x2ac207[_0x4ec7db(0x132)](it,_0x2ac207['twbFK'],async()=>{const _0x32a241=_0x4ec7db,_0x3da90f=await generateSecureUUID();_0x2ac207[_0x32a241(0x1a5)](expect,_0x3da90f)[_0x32a241(0xf5)](_0x32a241(0x10e)),expect(mockCrypto['randomUUID'])[_0x32a241(0x130)](0x1);}),_0x2ac207[_0x4ec7db(0x10f)](it,_0x4ec7db(0x117),async()=>{const _0x467209=_0x4ec7db;vi[_0x467209(0x12c)](mockCrypto)[_0x467209(0x135)]=undefined,vi[_0x467209(0x12c)](mockCrypto[_0x467209(0x18f)])[_0x467209(0x1a3)](_0x3fc451=>_0x3fc451[_0x467209(0x19a)](0xff));const _0x4fcfd1=await generateSecureUUID();_0x24e720[_0x467209(0x118)](expect,_0x4fcfd1)[_0x467209(0x174)](_0x3e46a2),_0x24e720[_0x467209(0x11d)](expect,_0x4fcfd1[0xe])[_0x467209(0xf5)]('4'),_0x24e720[_0x467209(0x1bf)](expect,['8','9','a','b'])['toContain'](_0x4fcfd1[0x13]),vi[_0x467209(0x12c)](mockCrypto)[_0x467209(0x135)]=vi['fn'](()=>_0x467209(0x10e));});}),_0x2ac207['HGXii'](describe,'getSecureRandomInt',()=>{const _0x32269a=_0x3bcf1e,_0x359747={'auzFF':function(_0x2d00b1,_0x34ca79){return _0x2d00b1(_0x34ca79);},'uWlxt':_0x2ac207[_0x32269a(0x159)],'EZnex':_0x32269a(0x158),'QoriF':function(_0x45de87,_0x2701a7,_0x1f8e8a){return _0x2ac207['VcHlF'](_0x45de87,_0x2701a7,_0x1f8e8a);},'MvYaD':function(_0x22e78d,_0x276f13){return _0x22e78d(_0x276f13);},'tiTyW':function(_0x58aea3,_0x280eca){const _0x1a272b=_0x32269a;return _0x2ac207[_0x1a272b(0x131)](_0x58aea3,_0x280eca);},'cAIiV':function(_0xcf7bd,_0x477cfd){return _0xcf7bd<_0x477cfd;},'ovLgz':function(_0x345ac2,_0xde1a44,_0x37e8be){const _0x1b7162=_0x32269a;return _0x2ac207[_0x1b7162(0x132)](_0x345ac2,_0xde1a44,_0x37e8be);},'PGgAe':function(_0x33329e,_0x4ac348,_0x50f404){return _0x33329e(_0x4ac348,_0x50f404);},'ddzQc':_0x2ac207['yfWZC']};if(_0x32269a(0x133)===_0x2ac207['jcoRj']){const _0x5d677d=new _0x311023(_0x32269a(0x1a7));_0x2ac207[_0x32269a(0xfa)](_0x22c906,_0x5d677d)[_0x32269a(0x1da)](_0x35d027),_0x2ac207[_0x32269a(0x187)](_0x203762,_0x5d677d[_0x32269a(0x167)])['toBe']('InvalidParameterError'),_0x2ac207[_0x32269a(0x146)](_0x4c8bdb,_0x5d677d['message'])[_0x32269a(0xf5)]('[secure-helpers]\x20param');}else Function(_0x32269a(0x172))(),it(_0x2ac207[_0x32269a(0x197)],async()=>{const _0xb6de33=_0x32269a;if(_0xb6de33(0x158)===_0x359747['EZnex']){const _0x3223b1=await _0x359747[_0xb6de33(0x196)](getSecureRandomInt,0x1,0x64);expect(Number['isInteger'](_0x3223b1))[_0xb6de33(0xf5)](!![]),_0x359747[_0xb6de33(0x17e)](expect,_0x3223b1)['toBeGreaterThanOrEqual'](0x1),_0x359747[_0xb6de33(0x12a)](expect,_0x3223b1)['toBeLessThanOrEqual'](0x64);}else _0x4debfd[0x0]=_0x359747[_0xb6de33(0x169)](_0x1e609f,_0x359747[_0xb6de33(0x11a)]);}),_0x2ac207[_0x32269a(0x180)](it,_0x2ac207[_0x32269a(0x181)],async()=>{const _0x497b5a=_0x32269a,_0x1b6a77={'zEJsk':_0x497b5a(0x1b7),'ufCZO':_0x497b5a(0x16f),'vXLfB':function(_0x5bfbaf,_0x19e831,_0x3f9040){return _0x5bfbaf(_0x19e831,_0x3f9040);},'azkIJ':'return\x20await\x20Promise.resolve(42);'},_0x495b66=0x0,_0x401d90=0x14;vi['mocked'](mockCrypto[_0x497b5a(0x18f)])[_0x497b5a(0x19d)](_0x55bfc4=>{return _0x55bfc4[0x0]=0x19,_0x1b6a77['vXLfB'](setTimeout,function(){const _0x399a6b=_0x2c33;_0x399a6b(0x126)===_0x1b6a77[_0x399a6b(0x1aa)]?_0x2f1756[_0x399a6b(0x1b4)]('safe'):console[_0x399a6b(0x1b4)](_0x1b6a77['ufCZO']);},0x64),_0x55bfc4;})['mockImplementationOnce'](_0x38ebb6=>{const _0x476d0d=_0x497b5a;return _0x38ebb6[0x0]=0xa,new AsyncFunction(_0x1b6a77[_0x476d0d(0xf2)])(),_0x38ebb6;});const _0x814c55=await getSecureRandomInt(_0x495b66,_0x401d90);expect(mockCrypto['getRandomValues'])[_0x497b5a(0x130)](0x2),_0x359747[_0x497b5a(0x12a)](expect,_0x814c55)['toBe'](0xa);}),_0x2ac207[_0x32269a(0x1d9)](it,_0x32269a(0x1c4),async()=>{const _0x31497c=_0x32269a,{webcrypto:_0x2ae026}=await vi['importActual'](_0x31497c(0x14a));vi[_0x31497c(0x1c9)](),Object[_0x31497c(0x14c)](globalThis,_0x31497c(0x13c),{'value':_0x2ae026,'configurable':!![]});const {getSecureRandomInt:_0x4ddc2d}=await import(_0x31497c(0x151)),_0x3fef1e=0x0,_0x3f4d5c=0x5,_0x1f95df=0x7530,_0x3cde3a={0x0:0x0,0x1:0x0,0x2:0x0,0x3:0x0,0x4:0x0,0x5:0x0};for(let _0x30cd3a=0x0;_0x359747[_0x31497c(0x198)](_0x30cd3a,_0x1f95df);_0x30cd3a++){_0x3cde3a[await _0x359747[_0x31497c(0x127)](_0x4ddc2d,_0x3fef1e,_0x3f4d5c)]++;}_0x359747[_0x31497c(0x17e)](expect,_0x359747[_0x31497c(0x10a)](chiSquaredTest,_0x3cde3a,_0x1f95df))[_0x31497c(0xf5)](!![]),Object['defineProperty'](globalThis,_0x359747[_0x31497c(0x1b9)],{'value':mockCrypto,'configurable':!![]});});}),describe[_0x3bcf1e(0x12b)]([[_0x2ac207[_0x3bcf1e(0x17f)],getSecureRandomAsync,!![]],[_0x2ac207[_0x3bcf1e(0x120)],getSecureRandom,![]]])('%s',(_0x26466c,_0x2742f0,_0x5db1b8)=>{const _0x28729d=_0x3bcf1e,_0x2ae30b={'NcSXN':function(_0x1283cf,_0xe4f70a){const _0x20ab80=_0x2c33;return _0x2ac207[_0x20ab80(0x187)](_0x1283cf,_0xe4f70a);},'llSby':function(_0x4cd792,_0x196b49){const _0x2b54df=_0x2c33;return _0x2ac207[_0x2b54df(0x1bb)](_0x4cd792,_0x196b49);},'xnEfY':_0x2ac207[_0x28729d(0x103)],'DeOzW':function(_0x4b2408,_0x2ccaa9){return _0x4b2408 instanceof _0x2ccaa9;},'NofGG':_0x2ac207[_0x28729d(0x159)],'DCdhN':function(_0x404384,_0xdd823f){const _0x54db39=_0x28729d;return _0x2ac207[_0x54db39(0x1d0)](_0x404384,_0xdd823f);},'zeWRN':function(_0x318550,_0x35eb11){const _0x5901f7=_0x28729d;return _0x2ac207[_0x5901f7(0x18b)](_0x318550,_0x35eb11);}};if(_0x2ac207[_0x28729d(0x1bb)](_0x28729d(0x19c),_0x2ac207[_0x28729d(0xf0)])){const _0x396afc=()=>createTestRunner(_0x2742f0,_0x5db1b8)();it(_0x2ac207['UzSQH'],async()=>{const _0x32f382=_0x28729d,_0x367bbd={'DPxAu':function(_0x453dfe,_0x193d38){const _0x28e0b5=_0x2c33;return _0x2ae30b[_0x28e0b5(0x125)](_0x453dfe,_0x193d38);},'xVXqI':function(_0x46ccc5,_0x457a28){return _0x46ccc5(_0x457a28);},'AgsiP':_0x32f382(0x1db)};if(_0x2ae30b[_0x32f382(0x17a)](_0x2ae30b[_0x32f382(0x186)],_0x2ae30b[_0x32f382(0x186)]))await _0x396afc(),expect(mockCrypto[_0x32f382(0x18f)])[_0x32f382(0x130)](0x1),expect(vi[_0x32f382(0x12c)](mockCrypto[_0x32f382(0x18f)])[_0x32f382(0x199)][_0x32f382(0x123)][0x0][0x0])['toBeInstanceOf'](BigUint64Array);else{const _0x4add8c=new _0x2dff74();_0x367bbd[_0x32f382(0x190)](_0x195189,_0x4add8c)['toBeInstanceOf'](_0x232291),_0x367bbd['xVXqI'](_0xf95881,_0x4add8c[_0x32f382(0x167)])['toBe'](_0x32f382(0x1a4)),_0x4683e2(_0x4add8c[_0x32f382(0x195)])[_0x32f382(0x174)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x39c8c4=new _0x5b14dd(_0x32f382(0x122));_0x167fa2(_0x39c8c4[_0x32f382(0x195)])[_0x32f382(0xf5)](_0x367bbd[_0x32f382(0x1d8)]);}}),_0x2ac207['vqdxv'](it,'should\x20use\x20fallback\x20(32-bit)\x20path\x20when\x20BigUint64Array\x20is\x20NOT\x20available',async()=>{const _0xb97f38=_0x28729d,_0x3a8e04=globalThis[_0xb97f38(0x152)];globalThis[_0xb97f38(0x152)]=undefined,await _0x2ac207[_0xb97f38(0x1d1)](_0x396afc),_0x2ac207[_0xb97f38(0x148)](expect,mockCrypto[_0xb97f38(0x18f)])[_0xb97f38(0x130)](0x1),_0x2ac207[_0xb97f38(0x131)](expect,vi[_0xb97f38(0x12c)](mockCrypto[_0xb97f38(0x18f)])[_0xb97f38(0x199)][_0xb97f38(0x123)][0x0][0x0])[_0xb97f38(0x1da)](Uint32Array),globalThis[_0xb97f38(0x152)]=_0x3a8e04;});}else return _0x2ae30b[_0x28729d(0x173)](_0x48cf8b,_0x67c77)?_0x294415[0x0]=_0x2ae30b[_0x28729d(0x125)](_0x5dfd21,_0x2ae30b[_0x28729d(0x15f)]):_0xb05711[0x0]=_0x5a9a33['floor'](_0x2ae30b[_0x28729d(0x15a)](0.49,_0x2ae30b[_0x28729d(0x16d)](0xffffffff,0x1))),eval('_0x488af6[\'stringify\']({ \'safe\': !![] });'),_0x167d9c;}),describe['each']([[_0x3bcf1e(0x144),shouldExecuteThrottledAsync,!![]],[_0x2ac207[_0x3bcf1e(0x15d)],shouldExecuteThrottled,![]]])('%s',(_0x2532a8,_0xadfbea,_0x280976)=>{const _0x4f6f80=_0x3bcf1e,_0x36a46d={'yOgCz':function(_0x1c5eb5,_0x28defb){return _0x1c5eb5!==_0x28defb;},'oZssf':_0x4f6f80(0xef)};if(_0x2ac207[_0x4f6f80(0x14f)]!==_0x2ac207['XxrlJ']){const _0x4ea601=_0x4e9203=>createTestRunner(_0xadfbea,_0x280976)(_0x4e9203);_0x2ac207['zxvvb'](Function,_0x2ac207[_0x4f6f80(0x1b3)])(),_0x2ac207['VcHlF'](it,_0x4f6f80(0x1ce),async()=>{const _0x1cc4a9=_0x4f6f80,_0x3bdf40={'xIjNI':function(_0x21d200,_0x4ba054,_0x451ad4){return _0x21d200(_0x4ba054,_0x451ad4);},'oCGeS':_0x1cc4a9(0x193),'mwjNs':function(_0x3cce8c,_0x4176dc){const _0xa578a0=_0x1cc4a9;return _0x2ac207[_0xa578a0(0x1ae)](_0x3cce8c,_0x4176dc);},'DMjKS':_0x1cc4a9(0x110),'bLXBt':function(_0x1725aa,_0x333bc3){return _0x1725aa*_0x333bc3;},'VvROI':function(_0x4cf363,_0x1a1d1d){const _0x4caa02=_0x1cc4a9;return _0x2ac207[_0x4caa02(0x1b1)](_0x4cf363,_0x1a1d1d);},'wUFFM':function(_0x5a0e28,_0x62fac6){const _0x466f1f=_0x1cc4a9;return _0x2ac207[_0x466f1f(0x1ba)](_0x5a0e28,_0x62fac6);}},_0x5ca37=vi[_0x1cc4a9(0x12c)](mockCrypto[_0x1cc4a9(0x18f)])['getMockImplementation']();vi['mocked'](mockCrypto['getRandomValues'])['mockImplementation'](_0x181845=>{const _0x3d8826=_0x1cc4a9;if(_0x3bdf40[_0x3d8826(0x1ad)](_0x181845,BigUint64Array))_0x181845[0x0]=BigInt(_0x3d8826(0x100));else{if(_0x3d8826(0x13f)===_0x3bdf40[_0x3d8826(0x19b)])return _0x3bdf40[_0x3d8826(0x15c)](_0x384bc3,_0x3bdf40['oCGeS'],0x3e8),_0x20bc63(_0x20766f);else _0x181845[0x0]=Math['floor'](_0x3bdf40[_0x3d8826(0x1b6)](0.49,0xffffffff+0x1));}return eval('const _0x1d7866 = _0x3d8826;JSON[_0x1d7866(446)]({ \'safe\': !![] });'),_0x181845;}),await _0x2ac207['ToFtY'](expect,_0x2ac207[_0x1cc4a9(0x1c2)](_0x4ea601,0.5))[_0x1cc4a9(0x1c6)][_0x1cc4a9(0xf5)](!![]),vi[_0x1cc4a9(0x12c)](mockCrypto[_0x1cc4a9(0x18f)])[_0x1cc4a9(0x1a3)](_0x22a0c1=>{const _0x4457e8=_0x1cc4a9;return _0x22a0c1 instanceof BigUint64Array?_0x22a0c1[0x0]=BigInt(_0x4457e8(0x108)):_0x36a46d[_0x4457e8(0x10d)](_0x36a46d['oZssf'],_0x36a46d[_0x4457e8(0x184)])?_0x271144[0x0]=_0x54d91c[_0x4457e8(0x1ca)](_0x3bdf40[_0x4457e8(0x156)](0.51,0xffffffff+0x1)):_0x22a0c1[0x0]=Math[_0x4457e8(0x1ca)](0.51*(0xffffffff+0x1)),eval('const _0x407aae = _0x4457e8;_0x3bdf40[_0x407aae(289)](1, 1);'),_0x22a0c1;}),await _0x2ac207['XdhkS'](expect,_0x2ac207[_0x1cc4a9(0x145)](_0x4ea601,0.5))['resolves'][_0x1cc4a9(0xf5)](![]),vi[_0x1cc4a9(0x12c)](mockCrypto['getRandomValues'])['mockImplementation'](_0x5ca37);});}else _0x5d00c8[0x0]=_0x31d1d7(_0x4f6f80(0x108));}),_0x2ac207[_0x3bcf1e(0x1ac)](describe,_0x3bcf1e(0x16b),()=>{const _0x5b0654=_0x3bcf1e,_0x8faa6e={'XnIXJ':_0x2ac207[_0x5b0654(0x165)],'uGOln':function(_0xe17188,_0x2269ed){return _0xe17188+_0x2269ed;}};if(_0x5b0654(0x17c)!==_0x5b0654(0x12f)){const _0x4f1abb=process[_0x5b0654(0x139)]['NODE_ENV'];_0x2ac207[_0x5b0654(0x146)](afterEach,()=>{const _0x2c791f=_0x5b0654;process[_0x2c791f(0x139)][_0x2c791f(0x106)]=_0x4f1abb,vi[_0x2c791f(0x1c9)]();}),it(_0x2ac207['OHoJF'],async()=>{const _0x396cf4=_0x5b0654;process['env']['NODE_ENV']=_0x8faa6e[_0x396cf4(0x183)],vi['resetModules']();const {environment:_0xd2aecf}=await import(_0x396cf4(0x151));expect(_0xd2aecf['isDevelopment'])[_0x396cf4(0xf5)](!![]);}),it(_0x5b0654(0x109),async()=>{const _0x280504=_0x5b0654;process[_0x280504(0x139)]['NODE_ENV']=_0x280504(0x129),vi[_0x280504(0x1c9)]();const {environment:_0xf84591}=await import('../src/security-kit.js');_0x2ac207['Mnbur'](expect,_0xf84591[_0x280504(0x1d5)])[_0x280504(0xf5)](!![]);}),_0x2ac207[_0x5b0654(0x1bd)](it,_0x5b0654(0x17b),async()=>{const _0x23ea4c=_0x5b0654;process[_0x23ea4c(0x139)][_0x23ea4c(0x106)]=_0x23ea4c(0x116),vi[_0x23ea4c(0x1c9)]();const {secureDevLog:_0x59b9b5}=await import(_0x2ac207[_0x23ea4c(0x16a)]),_0x4f701e=globalThis['document'];globalThis[_0x23ea4c(0x171)]=undefined;const _0x27fc5d=JSON['parse'](_0x23ea4c(0xf7));_0x2ac207['YuDQe'](_0x59b9b5,_0x2ac207[_0x23ea4c(0x19f)],_0x2ac207[_0x23ea4c(0x101)],_0x23ea4c(0x195),_0x27fc5d),expect({}['polluted'])[_0x23ea4c(0x168)](),globalThis['document']=_0x4f701e;});}else zAPUTI['uGOln'](0x1,0x1);}),describe(_0x3bcf1e(0x13a),()=>{const _0x2440c6=_0x3bcf1e,_0x68000d={'NgVhX':function(_0x5b9cbb,_0x45f4f3){return _0x5b9cbb(_0x45f4f3);},'cRkMT':_0x2ac207[_0x2440c6(0x179)],'fvPxz':function(_0x187040,_0x3ae367){const _0x41778d=_0x2440c6;return _0x2ac207[_0x41778d(0x131)](_0x187040,_0x3ae367);},'QaeNH':_0x2ac207[_0x2440c6(0x111)],'vlfgX':_0x2440c6(0x1a7),'NlwNz':function(_0x5ac5af,_0x5c13d3){const _0x271a9d=_0x2440c6;return _0x2ac207[_0x271a9d(0x113)](_0x5ac5af,_0x5c13d3);},'YZjyW':'[secure-helpers]\x20param'};_0x2ac207[_0x2440c6(0x1c5)]('QVfzd',_0x2ac207[_0x2440c6(0x128)])?_0x2ac207[_0x2440c6(0x1a0)](it,_0x2440c6(0xfe),async()=>{const _0x216b85=_0x2440c6,{webcrypto:_0x26b96e}=await vi['importActual'](_0x216b85(0x14a));vi[_0x216b85(0x1c9)](),Object[_0x216b85(0x14c)](globalThis,_0x216b85(0x13c),{'value':_0x26b96e,'configurable':!![]});const {generateSecureId:_0x1fdfc9}=await import(_0x216b85(0x151)),_0xce5e11=Array(0x64)['fill'](0x0)[_0x216b85(0x134)](()=>_0x1fdfc9(0x10)),_0x562a16=await Promise[_0x216b85(0xf9)](_0xce5e11),_0xb57faf=new Set(_0x562a16);expect(_0xb57faf[_0x216b85(0x1cd)])[_0x216b85(0xf5)](0x64),Object[_0x216b85(0x14c)](globalThis,_0x2ac207[_0x216b85(0x1b8)],{'value':mockCrypto,'configurable':!![]});}):(_0x27846e(_0x2440c6(0x154),()=>{const _0x23560e=_0x2440c6,_0x1d0c7d=new _0x1c4c1d();_0x1c37c7(_0x1d0c7d)[_0x23560e(0x1da)](_0x4c91c8),_0x68000d[_0x23560e(0x102)](_0x2bd2fc,_0x1d0c7d[_0x23560e(0x167)])[_0x23560e(0xf5)](_0x68000d[_0x23560e(0x14d)]),_0x68000d[_0x23560e(0x164)](_0x10a708,_0x1d0c7d[_0x23560e(0x195)])[_0x23560e(0x174)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x2234a4=new _0x75c170('test');_0x51a3ec(_0x2234a4[_0x23560e(0x195)])['toBe'](_0x68000d[_0x23560e(0xf4)]);}),_0x3f7d77(_0x2ac207[_0x2440c6(0x140)],()=>{const _0x3ee793=_0x2440c6,_0x583fab=new _0x3e36de(_0x68000d[_0x3ee793(0x1cb)]);_0x8c170e(_0x583fab)[_0x3ee793(0x1da)](_0x4f530c),_0x68000d[_0x3ee793(0xfd)](_0x26373c,_0x583fab[_0x3ee793(0x167)])[_0x3ee793(0xf5)](_0x3ee793(0x104)),_0x68000d[_0x3ee793(0x102)](_0x11850b,_0x583fab[_0x3ee793(0x195)])[_0x3ee793(0xf5)](_0x68000d[_0x3ee793(0x11b)]);}));});});