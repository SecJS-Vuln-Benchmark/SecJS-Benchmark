const _0x5da7d4=_0x292d;(function(_0x5b3fd7,_0x219078){const _0x393715=_0x292d,_0x19a525=_0x5b3fd7();while(!![]){try{const _0x181744=-parseInt(_0x393715(0x29f))/0x1*(parseInt(_0x393715(0x230))/0x2)+parseInt(_0x393715(0x1df))/0x3+-parseInt(_0x393715(0x1c5))/0x4+-parseInt(_0x393715(0x1ef))/0x5+-parseInt(_0x393715(0x25e))/0x6+parseInt(_0x393715(0x2e7))/0x7+parseInt(_0x393715(0x1d9))/0x8;if(_0x181744===_0x219078)break;else _0x19a525['push'](_0x19a525['shift']());}catch(_0x28bbef){_0x19a525['push'](_0x19a525['shift']());}}}(_0x2822,0x94496));import{describe,it,expect,beforeEach,afterEach,vi}from'vitest';import{webcrypto}from'node:crypto';const mockCrypto=webcrypto;import*as _0x5bb480 from'../src/security-kit.js';function _0x2822(){const _0x5b9644=['ruyxz','xuwqW','ErhKK','should\x20prevent\x20excessive\x20memory\x20allocation\x20in\x20generateSecureIdSync','PoJMs','WSaJT','ifLRD','should\x20throw\x20InvalidParameterError\x20for\x20a\x20wide\x20range\x20of\x20invalid\x20types','nNxhC','doUnmock','JqZou','toBeGreaterThanOrEqual','toMatch','Ctdxd','NjKSJ','should\x20handle\x20malicious\x20large\x20length\x20values\x20gracefully','PjPpH','kAgBs','lRRdm','ULuwB','from','RuTcI','Jfunh','vhthG','document','mhhiL','toThrow','aezgs','ifCmD','[secure-helpers]\x20test','resetModules','Environment-dependent\x20logic','CGxOQ','MIN_SAFE_INTEGER','should\x20handle\x20concurrent\x20access\x20without\x20race\x20conditions','jLHAn','ksKCk','TIytM','mocked','length','Buffer','fCzUO','reduce','lseTY','gKgsY','NgdNu','mockImplementation','vSthh','security-kit','JRDGQ','30oazEvg','tpbLd','XtXZR','ABNhh','pzCHH','oTfpr','acvcb','OaaoB','jzRui','nkNUP','Efxka','\x20degrees\x20of\x20freedom.','0x828f5c28f5c29000','should\x20detect\x20and\x20prevent\x20buffer\x20allocation\x20overflow\x20scenarios','production','should\x20use\x20optimized\x20hex\x20encoding\x20when\x20Buffer\x20is\x20available','size','svTzN','now','floor','yRZbi','GkmRH','toHaveLength','CXtjC','gHmVW','CfULR','UFSpM','qVgrN','BxHbl','doMock','should\x20throw\x20CryptoUnavailableError\x20when\x20no\x20API\x20is\x20found','arncp','MVYyz','mock-uuid-v4-from-crypto-api','YmEBy','kbbTl','getRandomValues','uMDXh','PYgTG','ABbSu','polluted','cXaQF','SraQz','PFptX','DoSWx','jNBay','4687296mefYUz','NWZdc','should\x20correctly\x20handle\x20odd\x20lengths\x20by\x20slicing','lWmzS','fill','CryptoUnavailableError\x20has\x20correct\x20name\x20and\x20default/custom\x20messages','xkdyT','ID\x20Generation\x20DoS\x20Protection','aydWZ','VYcYQ','mEhHz','should\x20use\x20crypto.randomUUID\x20when\x20available','OyGkT','SAhio','Ggzyg','cKKKt','FOOhi','CKtGl','oDCya','getSecureRandom','sHatH','Crypto\x20API\x20Discovery\x20and\x20Resilience','BaJsw','should\x20use\x20rejection\x20sampling\x20to\x20prevent\x20modulo\x20bias','SmKha','[secure-helpers]\x20param','TWwVj','frRZC','fyEgz','JKrDJ','QhgzV','pNNkq','YcGDD','DsyJw','should\x20prevent\x20ranges\x20that\x20would\x20require\x20excessive\x20buffer\x20allocation','xBvfq','nroav','UEDRy','should\x20have\x20circuit\x20breaker\x20protection\x20against\x20infinite\x20rejection\x20sampling','hPAXf','lzahX','crypto','BigUint64Array','OfsQs','ANCGG','EHbKN','toBeDefined','should\x20set\x20RFC\x204122\x20version\x20and\x20variant\x20bits\x20correctly\x20in\x20fallback','toBe','MkPWy','fQqaL','InvalidParameterError','message','rejects','return\x20Object.keys({a:1});','DRSaV','eoXHk','QlUtp','generateSecureIdSync','kKYxG','lofmR','zkntn','wCopf','deadbeef12345678','zeSvC','44327UBaYIh','{\x22__proto__\x22:\x20{\x22polluted\x22:\x20true}}','node:crypto','LGBzE','sDQfC','NlExj','BSMAa','UaCAE','RkbHP','map','importActual','QEAWr','Buffer\x20Overflow\x20and\x20DoS\x20Protection\x20Tests','fPznG','klWHz','tJbOS','WOtok','YIUyN','shouldExecuteThrottled','Advanced\x20Security\x20and\x20Resource\x20Testing','console.log(\x22timer\x22);','hFnkY','XOATS','toBeLessThanOrEqual','JVesB','toBeLessThan','name','kskqy','LnlGO','uJLhG','KhdpC','toBeUndefined','max','getMockImplementation','waSAp','qqwga','param','No\x20critical\x20value\x20for\x20','wFLKG','updateClock();','return\x20new\x20Date();','mock','mockReturnValue','expected_failure','iORby','RzWgZ','SezTa','ydtRc','defineProperty','JmhwS','NZnQy','AlImC','all','filter','resolves','randomUUID','push','should\x20maintain\x20consistent\x20performance\x20under\x20DoS\x20attack\x20simulation','spTpd','GwPNK','VCbiH','wUaXS','syGgN','each','edahR','NWUVm','SYXPy','MAX_SAFE_INTEGER','inYEl','should\x20include\x20circuit\x20breaker\x20protection\x20against\x20infinite\x20loops','ZwSXW','rMpqw','7911379koTCFX','Agtji','FtsWG','cngNO','gUbWV','gnrBp','fPIBF','XHETW','XiKSi','zNWgI','development','Error\x20Classes','NexSz','mockRestore','parse','should\x20return\x20deterministically\x20based\x20on\x20the\x20underlying\x20random\x20number','string','mockImplementationOnce','should\x20generate\x20an\x20ID\x20of\x20the\x20default\x20length\x20(12)','FGBQP','4072192UkBcsJ','cORHn','env','PXDqn','GlAZV','safe','should\x20use\x20the\x20mocked\x20crypto\x20API','should\x20handle\x20rapid\x20successive\x20large\x20requests\x20without\x20memory\x20issues','should\x20use\x20high\x20precision\x20(64-bit)\x20path\x20when\x20available','ckuuh','toHaveBeenCalledTimes','Hyeju','WeXtZ','isProduction','CryptoUnavailableError','aZdXT','PaNVX','QlumJ','HEeJq','hIeaK','16729456raPuaW','../src/security-kit.js','rAPiZ','eZIRg','bYciL','reject','1008888oKGjMr','FQkqo','JMHek','LOEre','isInteger','iUJgF','TEiau','resolve','iMNWL','calls','EOhPl','hSzPl','ibHTD','eohLC','yEiKN','0x7d70a3d70a3d7000','2430620HwnGkn','info','getSecureRandomInt','UYfbh','TRlga','toBeInstanceOf','RDGKJ','test','NODE_ENV','should\x20not\x20be\x20vulnerable\x20to\x20prototype\x20pollution\x20in\x20dev\x20logs','TEhUj','pnNHM','should\x20enforce\x20stricter\x20bounds\x20to\x20prevent\x20DoS\x20attacks','should\x20handle\x20large\x20ranges\x20using\x20BigInt\x20arithmetic\x20correctly','xCFlh'];_0x2822=function(){return _0x5b9644;};return _0x2822();}const {CryptoUnavailableError,InvalidParameterError,generateSecureId,generateSecureIdSync,generateSecureUUID,getSecureRandomInt,getSecureRandomAsync,getSecureRandom,shouldExecuteThrottledAsync,shouldExecuteThrottled}=_0x5bb480;function chiSquaredTest(_0x4f2aac,_0x7e2df3){const _0x49658a=_0x292d,_0x47c6bc={'PMCsj':function(_0x3645bd,_0x4fbc10){return _0x3645bd/_0x4fbc10;},'XOATS':function(_0x1293cd,_0x2a1454){return _0x1293cd-_0x2a1454;}},_0x526de6=Object['keys'](_0x4f2aac),_0x20966e=_0x526de6[_0x49658a(0x225)],_0x3ff4dc=_0x7e2df3/_0x20966e,_0x28da11=_0x20966e-0x1,_0x204a30={0x1:3.84,0x2:5.99,0x3:7.81,0x4:9.49,0x5:11.07,0x9:16.92,0xf:0x19},_0x489ec0=_0x204a30[_0x28da11];if(!_0x489ec0)throw new Error(_0x49658a(0x2c4)+_0x28da11+_0x49658a(0x23b));let _0x1214d3=0x0;for(const _0x15fc6e of _0x526de6){_0x1214d3+=_0x47c6bc['PMCsj'](_0x47c6bc[_0x49658a(0x2b5)](_0x4f2aac[_0x15fc6e],_0x3ff4dc)**0x2,_0x3ff4dc);}return setInterval('updateClock();',0x3e8),_0x1214d3<_0x489ec0;}function _0x292d(_0x1a24d6,_0x543339){const _0x2822fe=_0x2822();return _0x292d=function(_0x292dae,_0xf7e52a){_0x292dae=_0x292dae-0x1bd;let _0x20db13=_0x2822fe[_0x292dae];return _0x20db13;},_0x292d(_0x1a24d6,_0x543339);}function createTestRunner(_0x5d0618,_0x46d33d){const _0x1d7f90=_0x292d,_0x45d5f7={'yRZbi':function(_0x364bbe,_0x66f241){return _0x364bbe+_0x66f241;},'OfsQs':function(_0x5ac0fc,_0x2e8dbc){return _0x5ac0fc+_0x2e8dbc;},'kKYxG':function(_0x1105c9,_0x5940fc){return _0x1105c9 instanceof _0x5940fc;},'cKKKt':function(_0x5877cc,_0x14c28d){return _0x5877cc*_0x14c28d;},'svTzN':function(_0x2f63b8,_0x10675a,_0x21154b){return _0x2f63b8(_0x10675a,_0x21154b);},'ifCmD':'updateClock();','OaaoB':function(_0xa06d26,_0x439536){return _0xa06d26!==_0x439536;},'klWHz':_0x1d7f90(0x29a)};return eval('const _0x189d21 = _0x1d7f90;_0x45d5f7[_0x189d21(580)](1, 1);'),_0x551255=>{const _0x4ba145=_0x1d7f90;if(_0x46d33d)return Function('return\x20Object.keys({a:1});')(),_0x5d0618(_0x551255);else try{return eval('const _0x5c993c = _0x292d;_0x45d5f7[_0x5c993c(649)](1, 1);'),Promise[_0x4ba145(0x1e6)](_0x5d0618(_0x551255));}catch(_0x17c698){return _0x45d5f7[_0x4ba145(0x237)](_0x45d5f7[_0x4ba145(0x2ad)],_0x45d5f7[_0x4ba145(0x2ad)])?(_0x45d5f7[_0x4ba145(0x299)](_0x14d966,_0x726a81)?_0x21143f[0x0]=_0x2cbc41(_0x4ba145(0x23c)):_0x1bbdbe[0x0]=_0x24c2f9['floor'](_0x45d5f7[_0x4ba145(0x26d)](0.51,0xffffffff+0x1)),_0x45d5f7[_0x4ba145(0x241)](_0x53386d,_0x45d5f7[_0x4ba145(0x21a)],0x3e8),_0x4efa1c):(new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),Promise[_0x4ba145(0x1de)](_0x17c698));}};}describe(_0x5da7d4(0x22e),()=>{const _0x8a85cd=_0x5da7d4,_0x204c7e={'NlExj':function(_0x36398c,_0x467d76){return _0x36398c(_0x467d76);},'fQqaL':function(_0x5b524d,_0x54c4c9){return _0x5b524d(_0x54c4c9);},'zkntn':_0x8a85cd(0x291),'fyEgz':function(_0x1bfd5e,_0x293ab7){return _0x1bfd5e(_0x293ab7);},'vSthh':_0x8a85cd(0x277),'qVgrN':_0x8a85cd(0x1d3),'JKrDJ':'test','kAgBs':_0x8a85cd(0x263),'BaJsw':function(_0x4ac362,_0x48faf0,_0x1006e4){return _0x4ac362(_0x48faf0,_0x1006e4);},'WSaJT':function(_0x29a590,_0x585710){return _0x29a590===_0x585710;},'PYgTG':'fPznG','GRrZR':'Crypto\x20hardware\x20failure','cXaQF':function(_0x690286){return _0x690286();},'SmKha':function(_0x1467a6,_0xf39c){return _0x1467a6(_0xf39c);},'acvcb':function(_0x4a2ce2){return _0x4a2ce2();},'vhthG':function(_0x1f5b3f,_0x3d7cc6,_0x154904){return _0x1f5b3f(_0x3d7cc6,_0x154904);},'PFptX':_0x8a85cd(0x24e),'nNxhC':function(_0x3dc4b2,_0x2e5373,_0xf460e1){return _0x3dc4b2(_0x2e5373,_0xf460e1);},'siCHj':'should\x20propagate\x20underlying\x20errors\x20from\x20a\x20faulty\x20crypto.getRandomValues','OyGkT':_0x8a85cd(0x2c3),'syGgN':'zQIAZ','jzRui':function(_0x216968,_0x6ba13,_0x356bac){return _0x216968(_0x6ba13,_0x356bac);},'lseTY':_0x8a85cd(0x251),'iMNWL':function(_0x493bba,_0x220bfa){return _0x493bba(_0x220bfa);},'Hyeju':_0x8a85cd(0x269),'hFnkY':function(_0x1b92da,_0x51f5a1,_0x379095){return _0x1b92da(_0x51f5a1,_0x379095);},'fBxUI':_0x8a85cd(0x28d),'NexSz':function(_0x1af205,_0x449fa8){return _0x1af205!==_0x449fa8;},'UaCAE':_0x8a85cd(0x2a5),'DkBpu':function(_0x2e7eac,_0x27f13e){return _0x2e7eac*_0x27f13e;},'cngNO':_0x8a85cd(0x214),'CaUwE':_0x8a85cd(0x2cb),'DsyJw':function(_0x3d814c,_0x4b543d,_0x43a3b0){return _0x3d814c(_0x4b543d,_0x43a3b0);},'eohLC':function(_0x2cd674,_0x261096){return _0x2cd674**_0x261096;},'xkdyT':_0x8a85cd(0x2b3),'jNBay':_0x8a85cd(0x287),'WOtok':function(_0x1faf89,_0x44423d,_0x2c82dc){return _0x1faf89(_0x44423d,_0x2c82dc);},'eZIRg':'should\x20return\x20an\x20integer\x20within\x20the\x20specified\x20range','zNWgI':_0x8a85cd(0x1fb),'xNpPQ':_0x8a85cd(0x275),'wUNhH':function(_0x5a6028,_0x22ade3,_0x4d80fd){return _0x5a6028(_0x22ade3,_0x4d80fd);},'XoeVZ':_0x8a85cd(0x1fc),'bYciL':function(_0x3df2e4,_0x4fc58f){return _0x3df2e4(_0x4fc58f);},'xuwqW':'should\x20use\x20fallback\x20(32-bit)\x20path\x20when\x20BigUint64Array\x20is\x20NOT\x20available','tpbLd':_0x8a85cd(0x2b7),'lRRdm':function(_0x33f948,_0x4be537){return _0x33f948 instanceof _0x4be537;},'lWmzS':function(_0x3c7e2b,_0x5625dc){return _0x3c7e2b(_0x5625dc);},'xDcTC':_0x8a85cd(0x1ee),'zeSvC':function(_0x13b10f,_0x3174f1){return _0x13b10f*_0x3174f1;},'sHatH':_0x8a85cd(0x2c6),'qpuZR':function(_0x83749b,_0x1f8490){return _0x83749b+_0x1f8490;},'eoXHk':_0x8a85cd(0x23c),'ANCGG':function(_0x16c241,_0x51886e){return _0x16c241+_0x51886e;},'gKgsY':function(_0x597ce5,_0x3a2131,_0x9b25d7){return _0x597ce5(_0x3a2131,_0x9b25d7);},'RDGKJ':_0x8a85cd(0x2f1),'ErhKK':function(_0x4f7bbe,_0x31b3e5){return _0x4f7bbe(_0x31b3e5);},'fMOIM':_0x8a85cd(0x1da),'uMDXh':_0x8a85cd(0x2a0),'CGxOQ':'message','PoJMs':_0x8a85cd(0x1f8),'MkPWy':_0x8a85cd(0x29d),'iInsk':function(_0x393423,_0x2c24d8,_0x42a07b){return _0x393423(_0x2c24d8,_0x42a07b);},'ifLRD':_0x8a85cd(0x201),'SezTa':function(_0x25858a,_0x398701){return _0x25858a(_0x398701);},'ayCVo':function(_0x1127a8,_0x46e354,_0x57fa86){return _0x1127a8(_0x46e354,_0x57fa86);},'QhgzV':function(_0x427f0d,_0x3fff8c){return _0x427f0d**_0x3fff8c;},'YIUyN':_0x8a85cd(0x1c6),'nroav':function(_0x2156ac,_0x35d432,_0x406502){return _0x2156ac(_0x35d432,_0x406502);},'aZdXT':function(_0x14eb53,_0x138e38){return _0x14eb53(_0x138e38);},'FGBQP':_0x8a85cd(0x23d),'hPAXf':_0x8a85cd(0x26f),'rMpqw':'kbGgT','BaVwW':function(_0x3b0a24,_0x8f0fc2){return _0x3b0a24<_0x8f0fc2;},'VCbiH':function(_0x3eec99,_0x43c80b){return _0x3eec99>_0x43c80b;},'gHmVW':function(_0x139537,_0x2e92f1){return _0x139537**_0x2e92f1;},'FOOhi':function(_0x2746e1,_0xe20453){return _0x2746e1-_0xe20453;},'DRSaV':function(_0x4cd46f,_0x223b34){return _0x4cd46f(_0x223b34);},'ZybSd':function(_0x36568f,_0x5882cb,_0x11f846){return _0x36568f(_0x5882cb,_0x11f846);},'pnNHM':_0x8a85cd(0x1cc),'LOEre':function(_0xd20ec2,_0x4fba34){return _0xd20ec2(_0x4fba34);},'aydWZ':'fsNFc','FQkqo':_0x8a85cd(0x1d8),'UFSpM':function(_0x565196,_0x40e2ef,_0x3db1dc){return _0x565196(_0x40e2ef,_0x3db1dc);},'TRlga':function(_0xbaf92,_0x4670ca,_0x1ad2ec){return _0xbaf92(_0x4670ca,_0x1ad2ec);},'AlImC':function(_0x210f4e,_0x1742dc,_0x25f9bd){return _0x210f4e(_0x1742dc,_0x25f9bd);},'wUaXS':function(_0xb92cc1,_0x3a84b0){return _0xb92cc1(_0x3a84b0);},'GwPNK':_0x8a85cd(0x2f2),'wCopf':'generateSecureUUID','mEhHz':'shouldExecuteThrottledAsync','oDCya':_0x8a85cd(0x2b1),'rAPiZ':_0x8a85cd(0x2ab)};_0x204c7e[_0x8a85cd(0x2dc)](beforeEach,()=>{vi['clearAllMocks']();}),afterEach(()=>{const _0x4f6549=_0x8a85cd;vi['mocked'](mockCrypto['getRandomValues'])[_0x4f6549(0x1be)]();}),describe(_0x204c7e[_0x8a85cd(0x2da)],()=>{const _0x67e7e=_0x8a85cd,_0x21b2bb={'pLpgb':function(_0x4d7535,_0x52684f){return _0x4d7535(_0x52684f);},'ABNhh':_0x204c7e[_0x67e7e(0x24b)],'xCFlh':function(_0x3c74e5,_0xbcc072){return _0x3c74e5(_0xbcc072);},'jLHAn':_0x204c7e[_0x67e7e(0x27b)]};it(_0x204c7e[_0x67e7e(0x20f)],()=>{const _0x281ebf=_0x67e7e,_0x41514c=new CryptoUnavailableError();_0x21b2bb['pLpgb'](expect,_0x41514c)[_0x281ebf(0x1f4)](Error),expect(_0x41514c[_0x281ebf(0x2b9)])[_0x281ebf(0x28e)](_0x21b2bb[_0x281ebf(0x233)]),_0x21b2bb[_0x281ebf(0x1fd)](expect,_0x41514c[_0x281ebf(0x292)])[_0x281ebf(0x20a)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x447dad=new CryptoUnavailableError(_0x21b2bb[_0x281ebf(0x221)]);expect(_0x447dad[_0x281ebf(0x292)])[_0x281ebf(0x28e)]('[secure-helpers]\x20test');}),_0x204c7e[_0x67e7e(0x274)](it,'InvalidParameterError\x20has\x20correct\x20name\x20and\x20message\x20format',()=>{const _0x4b78b4=_0x67e7e,_0x127f16=new InvalidParameterError('param');_0x204c7e[_0x4b78b4(0x2a4)](expect,_0x127f16)[_0x4b78b4(0x1f4)](RangeError),_0x204c7e[_0x4b78b4(0x290)](expect,_0x127f16['name'])[_0x4b78b4(0x28e)](_0x204c7e[_0x4b78b4(0x29b)]),_0x204c7e[_0x4b78b4(0x27a)](expect,_0x127f16[_0x4b78b4(0x292)])[_0x4b78b4(0x28e)](_0x204c7e[_0x4b78b4(0x22d)]);});}),_0x204c7e[_0x8a85cd(0x282)](describe,_0x8a85cd(0x273),()=>{const _0x4f3b40=_0x8a85cd,_0x2b16c7={'GkmRH':'crypto','KhdpC':function(_0x3930cd,_0x54709f){const _0x192628=_0x292d;return _0x204c7e[_0x192628(0x276)](_0x3930cd,_0x54709f);},'fPIBF':function(_0x1fc32c){return _0x204c7e['acvcb'](_0x1fc32c);}};_0x204c7e[_0x4f3b40(0x215)](it,_0x4f3b40(0x1cb),async()=>{const _0x5a1e27=_0x4f3b40;await generateSecureId(),expect(mockCrypto[_0x5a1e27(0x254)])['toHaveBeenCalledTimes'](0x1);}),it(_0x204c7e[_0x4f3b40(0x25b)],async()=>{const _0x6bc7d7=_0x4f3b40;vi[_0x6bc7d7(0x21c)](),Object['defineProperty'](globalThis,_0x2b16c7[_0x6bc7d7(0x245)],{'value':undefined,'configurable':!![]}),vi[_0x6bc7d7(0x24d)](_0x6bc7d7(0x2a1),()=>({'webcrypto':undefined}));const {generateSecureId:_0x1865b8,CryptoUnavailableError:_0x21c83d}=await import(_0x6bc7d7(0x1da));await _0x2b16c7[_0x6bc7d7(0x2bd)](expect,_0x2b16c7[_0x6bc7d7(0x2ed)](_0x1865b8))[_0x6bc7d7(0x293)][_0x6bc7d7(0x218)](_0x21c83d),vi[_0x6bc7d7(0x207)](_0x6bc7d7(0x2a1)),vi[_0x6bc7d7(0x21c)]();}),_0x204c7e[_0x4f3b40(0x206)](it,_0x204c7e['siCHj'],async()=>{const _0x563525=_0x4f3b40;if(_0x204c7e[_0x563525(0x203)](_0x563525(0x2ac),_0x204c7e[_0x563525(0x256)])){const _0x4ed478=new Error(_0x204c7e['GRrZR']);vi[_0x563525(0x224)](mockCrypto[_0x563525(0x254)])[_0x563525(0x22c)](()=>{throw _0x4ed478;}),await expect(_0x204c7e[_0x563525(0x259)](generateSecureId))[_0x563525(0x293)][_0x563525(0x218)](_0x4ed478);}else 0x1+0x1;});}),describe[_0x8a85cd(0x2de)]([['generateSecureId',generateSecureId,!![]],[_0x8a85cd(0x298),generateSecureIdSync,![]]])('%s',(_0x4883d4,_0x389522,_0xfd435a)=>{const _0x4a6f5c=_0x8a85cd,_0x55f555={'YcGDD':_0x4a6f5c(0x24f),'gnrBp':function(_0x3d634b,_0x2106d1){return _0x3d634b(_0x2106d1);},'kbbTl':_0x204c7e[_0x4a6f5c(0x26a)],'Agtji':_0x204c7e[_0x4a6f5c(0x29b)],'HEeJq':function(_0x484761,_0x48df4d){return _0x484761===_0x48df4d;},'gUbWV':_0x204c7e[_0x4a6f5c(0x2dd)]},_0x1c5367=createTestRunner(_0x389522,_0xfd435a);_0x204c7e[_0x4a6f5c(0x274)](it,_0x4a6f5c(0x1c3),async()=>{const _0x20962b=_0x4a6f5c,_0xab057=await _0x1c5367();expect(_0xab057)[_0x20962b(0x246)](0xc),expect(_0xab057)[_0x20962b(0x20a)](/^[0-9a-f]{12}$/);}),it('should\x20handle\x20boundary\x20lengths\x201\x20and\x20256',async()=>{const _0x2b582f=_0x4a6f5c;_0x2b582f(0x297)!==_0x55f555[_0x2b582f(0x27e)]?(expect(await _0x1c5367(0x1))[_0x2b582f(0x246)](0x1),_0x55f555[_0x2b582f(0x2ec)](expect,await _0x1c5367(0x100))[_0x2b582f(0x246)](0x100)):_0x46b18a['log']('safe');}),_0x204c7e[_0x4a6f5c(0x206)](it,_0x4a6f5c(0x260),async()=>{const _0x32d1f2=_0x4a6f5c;vi[_0x32d1f2(0x224)](mockCrypto[_0x32d1f2(0x254)])['mockImplementation'](_0x5781c3=>_0x5781c3[_0x32d1f2(0x262)](0xab)),_0x55f555[_0x32d1f2(0x2ec)](expect,await _0x1c5367(0x3))['toBe']('aba');}),_0x204c7e[_0x4a6f5c(0x238)](it,_0x4a6f5c(0x205),async()=>{const _0x579e95=_0x4a6f5c,_0x1014c4={'XHETW':_0x55f555[_0x579e95(0x253)],'inYEl':_0x55f555[_0x579e95(0x2e8)],'hJWZQ':function(_0x1140b8,_0x43122d){return _0x1140b8(_0x43122d);}},_0x371f4a=[0x0,0x101,null,NaN,Infinity,[],{},_0x579e95(0x1c1),!![]];for(const _0x5d4c7c of _0x371f4a){if(_0x55f555[_0x579e95(0x1d7)](_0x579e95(0x239),_0x55f555[_0x579e95(0x2eb)])){const _0x4eb0a5=new _0xa0d6b6(_0x1014c4[_0x579e95(0x2ee)]);_0x2b84f1(_0x4eb0a5)[_0x579e95(0x1f4)](_0x55df2f),_0x597f00(_0x4eb0a5[_0x579e95(0x2b9)])[_0x579e95(0x28e)](_0x1014c4[_0x579e95(0x2e3)]),_0x1014c4['hJWZQ'](_0x3c9fa2,_0x4eb0a5[_0x579e95(0x292)])[_0x579e95(0x28e)](_0x579e95(0x277));}else await _0x55f555['gnrBp'](expect,_0x55f555[_0x579e95(0x2ec)](_0x1c5367,_0x5d4c7c))[_0x579e95(0x293)][_0x579e95(0x218)](InvalidParameterError);}});}),_0x204c7e[_0x8a85cd(0x2d2)](describe,_0x204c7e[_0x8a85cd(0x29c)],()=>{const _0x5e6975=_0x8a85cd,_0x4b8fd7=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;it(_0x204c7e[_0x5e6975(0x1d0)],async()=>{const _0x2f1843=_0x5e6975,_0x43b6d6=await _0x204c7e[_0x2f1843(0x259)](generateSecureUUID);_0x204c7e[_0x2f1843(0x276)](expect,_0x43b6d6)[_0x2f1843(0x28e)](_0x204c7e[_0x2f1843(0x229)]),_0x204c7e['SmKha'](expect,mockCrypto[_0x2f1843(0x2d6)])[_0x2f1843(0x1cf)](0x1);}),_0x204c7e[_0x5e6975(0x2b4)](it,_0x204c7e['fBxUI'],async()=>{const _0x1b0ce5=_0x5e6975;vi[_0x1b0ce5(0x224)](mockCrypto)['randomUUID']=undefined,vi['mocked'](mockCrypto[_0x1b0ce5(0x254)])[_0x1b0ce5(0x22c)](_0x4373bb=>_0x4373bb['fill'](0xff));const _0x139eeb=await generateSecureUUID();expect(_0x139eeb)[_0x1b0ce5(0x20a)](_0x4b8fd7),_0x204c7e['iMNWL'](expect,_0x139eeb[0xe])[_0x1b0ce5(0x28e)]('4'),expect(['8','9','a','b'])['toContain'](_0x139eeb[0x13]),vi[_0x1b0ce5(0x224)](mockCrypto)[_0x1b0ce5(0x2d6)]=vi['fn'](()=>_0x1b0ce5(0x251));});}),describe(_0x8a85cd(0x1f1),()=>{const _0x15753c=_0x8a85cd,_0x10a940={'duqZP':function(_0x43532c,_0x409c3d){const _0x48ea49=_0x292d;return _0x204c7e[_0x48ea49(0x1ec)](_0x43532c,_0x409c3d);},'ibHTD':function(_0x27c187,_0x4c6d80){return _0x27c187(_0x4c6d80);},'JqZou':function(_0x817e11,_0x4db9e4,_0x471797){return _0x817e11(_0x4db9e4,_0x471797);},'CXtjC':function(_0x88dbc0,_0x23f20c){return _0x88dbc0+_0x23f20c;},'pzCHH':_0x204c7e[_0x15753c(0x264)],'RkbHP':function(_0x82e8a7,_0x50f8b6){return _0x82e8a7(_0x50f8b6);},'TIytM':_0x204c7e[_0x15753c(0x25d)]};Function(_0x15753c(0x2c7))(),_0x204c7e['WOtok'](it,_0x204c7e[_0x15753c(0x1dc)],async()=>{const _0x1df2db=_0x15753c;if(_0x204c7e[_0x1df2db(0x1bd)](_0x1df2db(0x27d),_0x204c7e[_0x1df2db(0x2a6)])){const _0x466af7=await getSecureRandomInt(0x1,0x64);expect(Number[_0x1df2db(0x1e3)](_0x466af7))['toBe'](!![]),expect(_0x466af7)[_0x1df2db(0x209)](0x1),_0x204c7e[_0x1df2db(0x1e7)](expect,_0x466af7)[_0x1df2db(0x2b6)](0x64);}else 0x1+0x1;}),_0x204c7e['hFnkY'](it,_0x204c7e[_0x15753c(0x2f0)],async()=>{const _0x4580c4=_0x15753c,_0x2d8ff7=_0x10a940['duqZP'](0x2,0x1f),_0x533cc0=-(0x2**0x1f);await expect(getSecureRandomInt(_0x533cc0,_0x533cc0+0xa))[_0x4580c4(0x2d5)][_0x4580c4(0x28c)](),await _0x10a940[_0x4580c4(0x1eb)](expect,getSecureRandomInt(_0x2d8ff7-0xa,_0x2d8ff7))[_0x4580c4(0x2d5)]['toBeDefined'](),await expect(getSecureRandomInt(_0x533cc0-0x1,0x64))[_0x4580c4(0x293)][_0x4580c4(0x218)](InvalidParameterError),await _0x10a940[_0x4580c4(0x1eb)](expect,_0x10a940[_0x4580c4(0x208)](getSecureRandomInt,0x64,_0x10a940[_0x4580c4(0x247)](_0x2d8ff7,0x1)))[_0x4580c4(0x293)]['toThrow'](InvalidParameterError);}),it(_0x204c7e['xNpPQ'],async()=>{const _0x53ab9e=_0x15753c,_0x73ea01={'oRolV':function(_0x44265c,_0x322bdd){return _0x204c7e['DkBpu'](_0x44265c,_0x322bdd);},'qqwga':function(_0x4271c9,_0x46a449){return _0x4271c9+_0x46a449;}};if(_0x204c7e[_0x53ab9e(0x2ea)]===_0x204c7e['CaUwE'])_0x458e7b[0x0]=_0x130113[_0x53ab9e(0x243)](_0x73ea01['oRolV'](0.49,_0x73ea01[_0x53ab9e(0x2c2)](0xffffffff,0x1)));else{const _0x215261=0x0,_0x35ffd8=0x14;vi[_0x53ab9e(0x224)](mockCrypto[_0x53ab9e(0x254)])[_0x53ab9e(0x1c2)](_0x8f78d5=>{const _0x3378fb=_0x53ab9e;return _0x8f78d5[0x0]=0x19,setTimeout(_0x10a940[_0x3378fb(0x234)],0x3e8),_0x8f78d5;})['mockImplementationOnce'](_0x3f0779=>{return _0x3f0779[0x0]=0xa,setTimeout(function(){const _0x5eec71=_0x292d;console['log'](_0x5eec71(0x1ca));},0x64),_0x3f0779;});const _0x3e7f86=await getSecureRandomInt(_0x215261,_0x35ffd8);expect(mockCrypto[_0x53ab9e(0x254)])[_0x53ab9e(0x1cf)](0x2),_0x204c7e[_0x53ab9e(0x27a)](expect,_0x3e7f86)[_0x53ab9e(0x28e)](0xa);}}),_0x204c7e['wUNhH'](it,_0x204c7e['XoeVZ'],async()=>{const _0x384e89=_0x15753c,_0x5815af=0x3b9aca00,_0x54b960=0x77359400,_0x45428b=await _0x10a940['JqZou'](getSecureRandomInt,_0x5815af,_0x54b960);expect(Number[_0x384e89(0x1e3)](_0x45428b))[_0x384e89(0x28e)](!![]),_0x10a940[_0x384e89(0x2a7)](expect,_0x45428b)[_0x384e89(0x209)](_0x5815af),_0x10a940[_0x384e89(0x2a7)](expect,_0x45428b)[_0x384e89(0x2b6)](_0x54b960);}),it(_0x15753c(0x2e4),async()=>{const _0x8e9b24=_0x15753c;vi['mocked'](mockCrypto[_0x8e9b24(0x254)])[_0x8e9b24(0x22c)](_0x1df555=>{const _0x226cfc=_0x8e9b24;return _0x1df555[_0x226cfc(0x262)](0xff),Function(_0x226cfc(0x2c7))(),_0x1df555;}),await expect(_0x204c7e[_0x8e9b24(0x27f)](getSecureRandomInt,0x0,0x1))[_0x8e9b24(0x293)][_0x8e9b24(0x218)](/Failed to generate random integer within reasonable iterations/);}),it('should\x20produce\x20a\x20uniform\x20distribution\x20(passes\x20Chi-squared\x20test)',async()=>{const _0x4b4859=_0x15753c,{webcrypto:_0x2719c7}=await vi[_0x4b4859(0x2a9)]('node:crypto');vi[_0x4b4859(0x21c)](),Object[_0x4b4859(0x2cf)](globalThis,_0x10a940[_0x4b4859(0x223)],{'value':_0x2719c7,'configurable':!![]});const {getSecureRandomInt:_0x484b76}=await import(_0x4b4859(0x1da)),_0x542581=0x0,_0x2daacf=0x5,_0x5b7066=0x9c40,_0x1d7a70={0x0:0x0,0x1:0x0,0x2:0x0,0x3:0x0,0x4:0x0,0x5:0x0};for(let _0x135df9=0x0;_0x135df9<_0x5b7066;_0x135df9++){_0x1d7a70[await _0x10a940['JqZou'](_0x484b76,_0x542581,_0x2daacf)]++;}_0x10a940[_0x4b4859(0x1eb)](expect,_0x10a940[_0x4b4859(0x208)](chiSquaredTest,_0x1d7a70,_0x5b7066))[_0x4b4859(0x28e)](!![]),Object[_0x4b4859(0x2cf)](globalThis,_0x10a940[_0x4b4859(0x223)],{'value':mockCrypto,'configurable':!![]});});}),describe['each']([['getSecureRandomAsync',getSecureRandomAsync,!![]],[_0x8a85cd(0x271),getSecureRandom,![]]])('%s',(_0x38498d,_0x53f07a,_0xeb021f)=>{const _0x284d57=_0x8a85cd;if(_0x284d57(0x25f)===_0x284d57(0x25f)){const _0x4be5ff=()=>createTestRunner(_0x53f07a,_0xeb021f)();it(_0x284d57(0x1cd),async()=>{const _0x1e78c2=_0x284d57;await _0x204c7e[_0x1e78c2(0x236)](_0x4be5ff),_0x204c7e['iMNWL'](expect,mockCrypto[_0x1e78c2(0x254)])[_0x1e78c2(0x1cf)](0x1),expect(vi[_0x1e78c2(0x224)](mockCrypto['getRandomValues'])[_0x1e78c2(0x2c8)][_0x1e78c2(0x1e8)][0x0][0x0])['toBeInstanceOf'](BigUint64Array);}),it(_0x204c7e[_0x284d57(0x1ff)],async()=>{const _0x40c957=_0x284d57,_0x3b86d3=globalThis[_0x40c957(0x288)];globalThis[_0x40c957(0x288)]=undefined,await _0x204c7e[_0x40c957(0x259)](_0x4be5ff),expect(mockCrypto[_0x40c957(0x254)])[_0x40c957(0x1cf)](0x1),_0x204c7e[_0x40c957(0x1dd)](expect,vi[_0x40c957(0x224)](mockCrypto[_0x40c957(0x254)])[_0x40c957(0x2c8)][_0x40c957(0x1e8)][0x0][0x0])[_0x40c957(0x1f4)](Uint32Array),globalThis['BigUint64Array']=_0x3b86d3;});}else _0x17036a(_0x4fe44e)[_0x284d57(0x1f4)](_0xc06d21);}),describe[_0x8a85cd(0x2de)]([[_0x204c7e[_0x8a85cd(0x268)],shouldExecuteThrottledAsync,!![]],[_0x204c7e[_0x8a85cd(0x270)],shouldExecuteThrottled,![]]])('%s',(_0x39be6e,_0x226961,_0x467c51)=>{const _0x283c0a=_0x8a85cd,_0x175fdf={'QlumJ':function(_0x34a8e5,_0x265c91){const _0x412d17=_0x292d;return _0x204c7e[_0x412d17(0x210)](_0x34a8e5,_0x265c91);},'JmhwS':function(_0x101bbb,_0x3baeaf){const _0x5b6144=_0x292d;return _0x204c7e[_0x5b6144(0x261)](_0x101bbb,_0x3baeaf);},'UEDRy':_0x204c7e['xDcTC'],'sDQfC':function(_0x186b45,_0x258bf5){const _0x14b97d=_0x292d;return _0x204c7e[_0x14b97d(0x29e)](_0x186b45,_0x258bf5);},'NjKSJ':_0x204c7e[_0x283c0a(0x272)],'VYcYQ':function(_0x27f646,_0x39906e){return _0x204c7e['qpuZR'](_0x27f646,_0x39906e);},'DoSWx':function(_0x425776,_0xc730da){return _0x425776(_0xc730da);},'NZnQy':function(_0x4a12ea,_0x5996c9){return _0x4a12ea(_0x5996c9);},'ckuuh':_0x204c7e[_0x283c0a(0x296)],'BxHbl':function(_0x3d4814,_0x123102){const _0x18ffe9=_0x283c0a;return _0x204c7e[_0x18ffe9(0x28a)](_0x3d4814,_0x123102);}},_0x3a5567=_0x41f40c=>createTestRunner(_0x226961,_0x467c51)(_0x41f40c);_0x204c7e[_0x283c0a(0x238)](setTimeout,function(){const _0x208582=_0x283c0a;if(_0x204c7e[_0x208582(0x203)]('ebqRp',_0x204c7e[_0x208582(0x231)]))return _0x175fdf[_0x208582(0x1d6)](_0x5ab6b6,_0x2506a9)?_0x2e6bae[0x0]=_0x175fdf[_0x208582(0x2d0)](_0x16f158,_0x175fdf[_0x208582(0x283)]):_0x454dc3[0x0]=_0x367299[_0x208582(0x243)](_0x175fdf[_0x208582(0x2a3)](0.49,0xffffffff+0x1)),_0x365f81(_0x175fdf[_0x208582(0x20c)],0x3e8),_0x44ef6a;else console['log'](_0x208582(0x1ca));},0x64),_0x204c7e['gKgsY'](it,_0x283c0a(0x1c0),async()=>{const _0x349d6b=_0x283c0a,_0x47f959={'EOhPl':function(_0x2541c1,_0x4aa522){const _0x481e92=_0x292d;return _0x175fdf[_0x481e92(0x25c)](_0x2541c1,_0x4aa522);},'iUJgF':function(_0x21eb92,_0x2f883f){return _0x175fdf['NZnQy'](_0x21eb92,_0x2f883f);},'mHOWG':_0x175fdf[_0x349d6b(0x1ce)],'waSAp':_0x349d6b(0x1fe),'UYfbh':function(_0x2b8040,_0x2e3301){const _0x270965=_0x349d6b;return _0x175fdf[_0x270965(0x2a3)](_0x2b8040,_0x2e3301);},'XqRQI':function(_0x47a8a7,_0x5e9cc0){const _0x49a2a2=_0x349d6b;return _0x175fdf[_0x49a2a2(0x24c)](_0x47a8a7,_0x5e9cc0);},'Ggzyg':function(_0xb7ef16,_0xe99e2f,_0x309131){return _0xb7ef16(_0xe99e2f,_0x309131);}},_0x1f7316=vi[_0x349d6b(0x224)](mockCrypto[_0x349d6b(0x254)])[_0x349d6b(0x2c0)]();vi[_0x349d6b(0x224)](mockCrypto[_0x349d6b(0x254)])[_0x349d6b(0x22c)](_0x2692f6=>{const _0x2bf86c=_0x349d6b;return _0x2692f6 instanceof BigUint64Array?_0x2692f6[0x0]=_0x175fdf[_0x2bf86c(0x2d0)](BigInt,'0x7d70a3d70a3d7000'):_0x2692f6[0x0]=Math[_0x2bf86c(0x243)](0.49*_0x175fdf[_0x2bf86c(0x267)](0xffffffff,0x1)),setInterval('updateClock();',0x3e8),_0x2692f6;}),await expect(_0x175fdf[_0x349d6b(0x2d1)](_0x3a5567,0.5))[_0x349d6b(0x2d5)]['toBe'](!![]),vi[_0x349d6b(0x224)](mockCrypto[_0x349d6b(0x254)])[_0x349d6b(0x22c)](_0xfc58d=>{const _0x36af2b=_0x349d6b;if(_0xfc58d instanceof BigUint64Array)_0xfc58d[0x0]=_0x47f959[_0x36af2b(0x1e4)](BigInt,_0x47f959['mHOWG']);else{if(_0x47f959['waSAp']!==_0x47f959[_0x36af2b(0x2c1)])return _0x1fbd2b(_0x36af2b(0x294))(),_0x47f959[_0x36af2b(0x1e9)](_0x3c2b3e,_0x455249);else _0xfc58d[0x0]=Math[_0x36af2b(0x243)](_0x47f959[_0x36af2b(0x1f2)](0.51,_0x47f959['XqRQI'](0xffffffff,0x1)));}return _0x47f959[_0x36af2b(0x26c)](setInterval,_0x36af2b(0x2c6),0x3e8),_0xfc58d;}),await expect(_0x175fdf[_0x349d6b(0x2d0)](_0x3a5567,0.5))[_0x349d6b(0x2d5)][_0x349d6b(0x28e)](![]),vi[_0x349d6b(0x224)](mockCrypto[_0x349d6b(0x254)])[_0x349d6b(0x22c)](_0x1f7316);});}),_0x204c7e[_0x8a85cd(0x2af)](describe,_0x8a85cd(0x21d),()=>{const _0x1ea005=_0x8a85cd,_0xb10391={'uJLhG':function(_0x132599,_0x2952d7){return _0x132599===_0x2952d7;},'RuTcI':_0x1ea005(0x1c9),'Ctdxd':_0x204c7e[_0x1ea005(0x255)],'JMHek':function(_0x1f9bb4,_0x21322f,_0x133f48,_0x9140a7,_0x34faa0){return _0x1f9bb4(_0x21322f,_0x133f48,_0x9140a7,_0x34faa0);},'TWwVj':_0x1ea005(0x1f6),'JRDGQ':_0x204c7e[_0x1ea005(0x21e)]},_0x5d36f1=process[_0x1ea005(0x1c7)]['NODE_ENV'];afterEach(()=>{const _0x484eaf=_0x1ea005;if(_0xb10391[_0x484eaf(0x2bc)](_0xb10391[_0x484eaf(0x213)],_0x484eaf(0x217)))throw _0x331493;else process['env'][_0x484eaf(0x1f7)]=_0x5d36f1,vi[_0x484eaf(0x21c)]();}),_0x204c7e['DsyJw'](it,'should\x20correctly\x20identify\x20development\x20via\x20NODE_ENV',async()=>{const _0x10097b=_0x1ea005;process[_0x10097b(0x1c7)]['NODE_ENV']=_0x204c7e[_0x10097b(0x1f5)],vi['resetModules']();const {environment:_0x3ce26e}=await import(_0x10097b(0x1da));_0x204c7e[_0x10097b(0x200)](expect,_0x3ce26e['isDevelopment'])['toBe'](!![]);}),it('should\x20correctly\x20identify\x20production\x20via\x20NODE_ENV',async()=>{const _0xc4da52=_0x1ea005;process[_0xc4da52(0x1c7)][_0xc4da52(0x1f7)]=_0xc4da52(0x23e),vi['resetModules']();const {environment:_0x4cc5d1}=await import(_0x204c7e['fMOIM']);expect(_0x4cc5d1[_0xc4da52(0x1d2)])[_0xc4da52(0x28e)](!![]);}),it(_0x204c7e[_0x1ea005(0x202)],async()=>{const _0x2d4574=_0x1ea005;process[_0x2d4574(0x1c7)][_0x2d4574(0x1f7)]=_0x2d4574(0x2f1),vi[_0x2d4574(0x21c)]();const {secureDevLog:_0x36ac82}=await import(_0x2d4574(0x1da)),_0x18b3ab=globalThis[_0x2d4574(0x216)];globalThis[_0x2d4574(0x216)]=undefined;const _0x3a6bf3=JSON[_0x2d4574(0x1bf)](_0xb10391[_0x2d4574(0x20b)]);_0xb10391[_0x2d4574(0x1e1)](_0x36ac82,_0x2d4574(0x1f0),_0xb10391[_0x2d4574(0x278)],_0xb10391[_0x2d4574(0x22f)],_0x3a6bf3),expect({}[_0x2d4574(0x258)])[_0x2d4574(0x2be)](),globalThis[_0x2d4574(0x216)]=_0x18b3ab;});}),_0x204c7e['ayCVo'](describe,_0x8a85cd(0x2b2),()=>{const _0x3d80c6=_0x8a85cd;_0x204c7e[_0x3d80c6(0x238)](it,_0x3d80c6(0x220),async()=>{const _0x1d9620=_0x3d80c6,{webcrypto:_0x27bdae}=await vi[_0x1d9620(0x2a9)](_0x1d9620(0x2a1));vi[_0x1d9620(0x21c)](),Object[_0x1d9620(0x2cf)](globalThis,_0x204c7e['jNBay'],{'value':_0x27bdae,'configurable':!![]});const {generateSecureId:_0x5cf08a}=await import('../src/security-kit.js'),_0xc274f3=Array(0x64)['fill'](0x0)[_0x1d9620(0x2a8)](()=>_0x5cf08a(0x10)),_0x111cbf=await Promise['all'](_0xc274f3),_0x3249b7=new Set(_0x111cbf);expect(_0x3249b7[_0x1d9620(0x240)])[_0x1d9620(0x28e)](0x64),Object[_0x1d9620(0x2cf)](globalThis,_0x1d9620(0x287),{'value':mockCrypto,'configurable':!![]});}),_0x204c7e[_0x3d80c6(0x215)](it,_0x3d80c6(0x23f),async()=>{const _0x2e6ebc=_0x3d80c6;if(_0x2e6ebc(0x2ba)!=='kskqy')_0x63a061[_0x2e6ebc(0x224)](_0x5d704a[_0x2e6ebc(0x254)])[_0x2e6ebc(0x1be)]();else{const _0x35080c={'from':vi['fn']()[_0x2e6ebc(0x2c9)]({'toString':vi['fn']()[_0x2e6ebc(0x2c9)](_0x2e6ebc(0x29d))})},_0x3c86c3=globalThis['Buffer'];globalThis['Buffer']=_0x35080c;try{const _0x145c36=await _0x204c7e[_0x2e6ebc(0x1e7)](generateSecureId,0x10);expect(_0x35080c[_0x2e6ebc(0x212)])[_0x2e6ebc(0x1cf)](0x1),_0x204c7e[_0x2e6ebc(0x261)](expect,_0x145c36)[_0x2e6ebc(0x28e)](_0x204c7e[_0x2e6ebc(0x28f)]);}finally{globalThis[_0x2e6ebc(0x226)]=_0x3c86c3;}}});}),describe(_0x204c7e[_0x8a85cd(0x1db)],()=>{const _0x29ff4f=_0x8a85cd,_0x15c709={'ksKCk':_0x204c7e[_0x29ff4f(0x20f)],'PXDqn':'InvalidParameterError\x20has\x20correct\x20name\x20and\x20message\x20format','hSzPl':function(_0x576bec,_0xd64795){const _0x55ae14=_0x29ff4f;return _0x204c7e[_0x55ae14(0x27c)](_0x576bec,_0xd64795);},'lzahX':_0x204c7e[_0x29ff4f(0x285)],'aQUeG':_0x204c7e[_0x29ff4f(0x2e6)],'SraQz':function(_0x4c77aa,_0x1f5af6){return _0x204c7e['BaVwW'](_0x4c77aa,_0x1f5af6);},'XiKSi':function(_0x440144,_0x38a063){const _0x374051=_0x29ff4f;return _0x204c7e[_0x374051(0x2db)](_0x440144,_0x38a063);},'edahR':function(_0x2f385f,_0x398cc5){const _0x2a8488=_0x29ff4f;return _0x204c7e[_0x2a8488(0x248)](_0x2f385f,_0x398cc5);},'TEiau':function(_0x154e13,_0x3006bc){return _0x154e13(_0x3006bc);},'WeXtZ':function(_0xbaeca8,_0x3e0328,_0x3f3b27){const _0x3fcb83=_0x29ff4f;return _0x204c7e[_0x3fcb83(0x2b4)](_0xbaeca8,_0x3e0328,_0x3f3b27);},'spTpd':function(_0x2b99f3,_0x172704){return _0x2b99f3(_0x172704);},'frRZC':function(_0x43ab6e,_0x1a0aa){return _0x43ab6e(_0x1a0aa);},'ppNvE':function(_0x3ee316,_0x335844){const _0x202c61=_0x29ff4f;return _0x204c7e[_0x202c61(0x26e)](_0x3ee316,_0x335844);},'ABbSu':function(_0x4ecb7d,_0x15420c){return _0x4ecb7d/_0x15420c;},'NWUVm':function(_0x1681c6,_0x1eebbb){return _0x1681c6(_0x1eebbb);},'ULuwB':function(_0x335058,_0x1f88c0){const _0x156caa=_0x29ff4f;return _0x204c7e[_0x156caa(0x295)](_0x335058,_0x1f88c0);},'hFXQU':function(_0x1ee241,_0x2c885c,_0x5bf115){return _0x204c7e['ZybSd'](_0x1ee241,_0x2c885c,_0x5bf115);},'ZwSXW':_0x204c7e[_0x29ff4f(0x1fa)],'YmEBy':_0x29ff4f(0x2d8),'tpxFs':function(_0x2abc0e,_0x2e9c13){const _0x40edb6=_0x29ff4f;return _0x204c7e[_0x40edb6(0x1e2)](_0x2abc0e,_0x2e9c13);},'tJbOS':function(_0x5826bf,_0x30aa00){return _0x5826bf(_0x30aa00);}};_0x204c7e[_0x29ff4f(0x266)]!==_0x204c7e[_0x29ff4f(0x1e0)]?(_0x204c7e[_0x29ff4f(0x24a)](describe,_0x29ff4f(0x265),()=>{const _0x132164=_0x29ff4f,_0x1ecdc6={'EHbKN':function(_0x20831b,_0x2cca1f){return _0x20831b(_0x2cca1f);},'ydtRc':function(_0x2a7458,_0x417e29){const _0x2c883a=_0x292d;return _0x204c7e[_0x2c883a(0x200)](_0x2a7458,_0x417e29);},'FtsWG':function(_0x3c2f85,_0x3a25e3){return _0x204c7e['NlExj'](_0x3c2f85,_0x3a25e3);},'ZbHKm':function(_0x5bda01,_0x519113){return _0x5bda01(_0x519113);}};it('should\x20prevent\x20excessive\x20memory\x20allocation\x20in\x20generateSecureId',async()=>{const _0x3bdb48=_0x292d;await _0x1ecdc6[_0x3bdb48(0x28b)](expect,generateSecureId(0x100))[_0x3bdb48(0x2d5)][_0x3bdb48(0x246)](0x100),await _0x1ecdc6[_0x3bdb48(0x2ce)](expect,_0x1ecdc6[_0x3bdb48(0x2e9)](generateSecureId,0x101))[_0x3bdb48(0x293)][_0x3bdb48(0x218)](InvalidParameterError),await _0x1ecdc6['EHbKN'](expect,generateSecureId(0x101))['rejects'][_0x3bdb48(0x218)](/length must be an integer between 1 and 256/);}),_0x204c7e['iInsk'](it,_0x204c7e[_0x132164(0x204)],()=>{const _0x1505af=_0x132164;expect(_0x1ecdc6['EHbKN'](generateSecureIdSync,0x100))[_0x1505af(0x246)](0x100),_0x1ecdc6['ZbHKm'](expect,()=>generateSecureIdSync(0x101))['toThrow'](InvalidParameterError),expect(()=>generateSecureIdSync(0x101))[_0x1505af(0x218)](/length must be an integer between 1 and 256/);}),it(_0x132164(0x20d),async()=>{const _0x5dd9d8=_0x132164,_0x1c9a0b={'LnlGO':function(_0xcba82b,_0x307e5b){return _0xcba82b(_0x307e5b);},'PjPpH':_0x5dd9d8(0x1f6),'beVQU':function(_0x31ffb9,_0x5ee453,_0x1d8a9b){return _0x31ffb9(_0x5ee453,_0x1d8a9b);},'XtXZR':_0x15c709[_0x5dd9d8(0x222)],'MVYyz':_0x15c709[_0x5dd9d8(0x1c8)]},_0x22d14b=[0x3e8,0x2710,0x186a0,Number[_0x5dd9d8(0x2e2)],_0x15c709['hSzPl'](0x2,0x14),0x2**0x1e];for(const _0x4dbeec of _0x22d14b){if(_0x15c709[_0x5dd9d8(0x286)]!==_0x15c709['aQUeG'])await expect(generateSecureId(_0x4dbeec))['rejects']['toThrow'](InvalidParameterError),expect(()=>generateSecureIdSync(_0x4dbeec))[_0x5dd9d8(0x218)](InvalidParameterError);else{const _0x9f51c4={'SYXPy':'CryptoUnavailableError','iVQZV':function(_0x3a1212,_0x337bb8){const _0x2c0eac=_0x5dd9d8;return _0x1c9a0b[_0x2c0eac(0x2bb)](_0x3a1212,_0x337bb8);},'Efxka':_0x1c9a0b[_0x5dd9d8(0x20e)],'TEhUj':function(_0x5bdd74,_0x4418e9){return _0x1c9a0b['LnlGO'](_0x5bdd74,_0x4418e9);}};_0x1c9a0b['beVQU'](_0x33553d,_0x1c9a0b[_0x5dd9d8(0x232)],()=>{const _0x3194e6=_0x5dd9d8,_0x34897c=new _0x7f6381();_0x1b0826(_0x34897c)[_0x3194e6(0x1f4)](_0x31a91a),_0x323061(_0x34897c[_0x3194e6(0x2b9)])['toBe'](_0x9f51c4[_0x3194e6(0x2e1)]),_0x9f51c4['iVQZV'](_0x25003f,_0x34897c['message'])[_0x3194e6(0x20a)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x88ebc0=new _0x106344(_0x9f51c4[_0x3194e6(0x23a)]);_0x9f51c4['iVQZV'](_0x418713,_0x88ebc0[_0x3194e6(0x292)])[_0x3194e6(0x28e)](_0x3194e6(0x21b));}),_0x2ad1a7(_0x1c9a0b[_0x5dd9d8(0x250)],()=>{const _0x3dc51c=_0x5dd9d8,_0x544c02=new _0x35361d(_0x3dc51c(0x2c3));_0x87d90b(_0x544c02)[_0x3dc51c(0x1f4)](_0x3763a1),_0x90783a(_0x544c02[_0x3dc51c(0x2b9)])['toBe']('InvalidParameterError'),_0x9f51c4[_0x3dc51c(0x1f9)](_0x4a2c4f,_0x544c02[_0x3dc51c(0x292)])[_0x3dc51c(0x28e)](_0x3dc51c(0x277));});}}});}),describe('Random\x20Integer\x20DoS\x20Protection',()=>{const _0x3afde3=_0x29ff4f,_0x36f4c5={'xBvfq':function(_0xa464e7,_0x2a78ea){const _0x3bf5f0=_0x292d;return _0x204c7e[_0x3bf5f0(0x261)](_0xa464e7,_0x2a78ea);},'ZoNZP':function(_0x3ebfec,_0x13a258,_0x416f3e){return _0x204c7e['vhthG'](_0x3ebfec,_0x13a258,_0x416f3e);},'PaNVX':function(_0x32f3a0,_0x23035f){const _0x47cfff=_0x292d;return _0x204c7e[_0x47cfff(0x2cd)](_0x32f3a0,_0x23035f);},'ZoxKD':function(_0x335fdc,_0x1055d9,_0x2ce9f1){return _0x335fdc(_0x1055d9,_0x2ce9f1);},'aezgs':function(_0x3a48f4,_0x5e7953,_0x2e80d8){return _0x3a48f4(_0x5e7953,_0x2e80d8);}};it('should\x20enforce\x20strict\x20range\x20boundaries\x20to\x20prevent\x20integer\x20overflow',async()=>{const _0x3374bc=_0x292d,_0x33660c=0x2**0x1f,_0x4cb3c9=-(0x2**0x1f);await _0x36f4c5[_0x3374bc(0x281)](expect,_0x36f4c5['ZoNZP'](getSecureRandomInt,0xf4240,0x1e8480))['resolves']['toBeDefined'](),await expect(getSecureRandomInt(-0xf4240,-0x7a120))[_0x3374bc(0x2d5)][_0x3374bc(0x28c)](),await expect(_0x36f4c5['ZoNZP'](getSecureRandomInt,_0x4cb3c9-0x1,0x0))[_0x3374bc(0x293)][_0x3374bc(0x218)](InvalidParameterError),await _0x36f4c5[_0x3374bc(0x1d5)](expect,_0x36f4c5['ZoxKD'](getSecureRandomInt,0x0,_0x33660c+0x1))['rejects'][_0x3374bc(0x218)](InvalidParameterError),await expect(_0x36f4c5[_0x3374bc(0x219)](getSecureRandomInt,Number['MIN_SAFE_INTEGER'],0x0))[_0x3374bc(0x293)]['toThrow'](InvalidParameterError),await expect(_0x36f4c5[_0x3374bc(0x219)](getSecureRandomInt,0x0,Number[_0x3374bc(0x2e2)]))[_0x3374bc(0x293)][_0x3374bc(0x218)](InvalidParameterError);}),_0x204c7e['ayCVo'](it,_0x3afde3(0x280),async()=>{const _0x14b1f5=_0x3afde3,_0x591aca=[[Number[_0x14b1f5(0x21f)],Number[_0x14b1f5(0x2e2)]],[-(0x2**0x1f)+0x1,0x2**0x1f]];for(const [_0x43fe51,_0xcb9f34]of _0x591aca){(_0x15c709[_0x14b1f5(0x25a)](_0x43fe51,-_0x15c709[_0x14b1f5(0x1ea)](0x2,0x1f))||_0x15c709[_0x14b1f5(0x2ef)](_0xcb9f34,_0x15c709[_0x14b1f5(0x2df)](0x2,0x1f)))&&await _0x15c709[_0x14b1f5(0x1e5)](expect,_0x15c709[_0x14b1f5(0x1d1)](getSecureRandomInt,_0x43fe51,_0xcb9f34))[_0x14b1f5(0x293)][_0x14b1f5(0x218)](InvalidParameterError);}}),it(_0x3afde3(0x284),async()=>{const _0x112170=_0x3afde3,_0x2ed7ba={'fCzUO':_0x112170(0x2cc),'vSsde':function(_0x32859b,_0x130e6d){return _0x32859b(_0x130e6d);}};vi[_0x112170(0x224)](mockCrypto[_0x112170(0x254)])[_0x112170(0x22c)](_0x24147e=>{const _0x1d327d=_0x112170,_0x1704bd={'CfULR':function(_0x112393,_0x175ee9){return _0x112393+_0x175ee9;}};return _0x1d327d(0x2c5)!==_0x2ed7ba[_0x1d327d(0x227)]?(_0x24147e['fill'](0xff),_0x2ed7ba['vSsde'](Function,'return\x20new\x20Date();')(),_0x24147e):(eval('const _0x28c462 = _0x1d327d;_0x1704bd[_0x28c462(585)](1, 1);'),_0x1142c0[_0x1d327d(0x1e6)](_0x195e7e(_0x1901cc)));}),await _0x15c709[_0x112170(0x2d9)](expect,getSecureRandomInt(0x0,0x1))[_0x112170(0x293)][_0x112170(0x218)](/Failed to generate random integer within reasonable iterations/);const _0x138859=Date[_0x112170(0x242)]();try{await getSecureRandomInt(0x0,0x1);}catch(_0x2746d1){const _0x3358d7=Date[_0x112170(0x242)]()-_0x138859;expect(_0x3358d7)['toBeLessThan'](0x3e8);}});}),_0x204c7e[_0x29ff4f(0x1f3)](describe,'Memory\x20Exhaustion\x20Attack\x20Simulation',()=>{const _0x5d43e5=_0x29ff4f,_0x4a1c97={'SAhio':function(_0x3d8c8b,_0x560409){const _0x423ce1=_0x292d;return _0x15c709[_0x423ce1(0x211)](_0x3d8c8b,_0x560409);}};_0x15c709['hFXQU'](it,_0x15c709[_0x5d43e5(0x2e5)],async()=>{const _0x4134f6=_0x5d43e5,_0x1ed783=[];for(let _0x141679=0x0;_0x141679<0x64;_0x141679++){_0x1ed783[_0x4134f6(0x2d7)](generateSecureId(0x100)['catch'](()=>_0x4134f6(0x2ca)),_0x4a1c97[_0x4134f6(0x26b)](generateSecureId,0x101)['catch'](()=>_0x4134f6(0x2ca)));}const _0x294348=await Promise[_0x4134f6(0x2d3)](_0x1ed783),_0x43fe1d=_0x294348['filter'](_0x586db3=>_0x586db3!==_0x4134f6(0x2ca))[_0x4134f6(0x225)],_0x4516a4=_0x294348[_0x4134f6(0x2d4)](_0x607d08=>_0x607d08===_0x4134f6(0x2ca))[_0x4134f6(0x225)];_0x4a1c97[_0x4134f6(0x26b)](expect,_0x43fe1d)[_0x4134f6(0x28e)](0x64),_0x4a1c97[_0x4134f6(0x26b)](expect,_0x4516a4)[_0x4134f6(0x28e)](0x64);}),_0x15c709[_0x5d43e5(0x1d1)](it,_0x15c709[_0x5d43e5(0x252)],async()=>{const _0x454a54=_0x5d43e5,_0x1b94da={'FIFMI':'return\x20new\x20Date();'};if('ymZBd'!=='AuPBi'){const _0x29802e=0x32,_0x5ac61d=[];for(let _0x140060=0x0;_0x140060<_0x29802e;_0x140060++){const _0x10cc33=performance['now']();try{await _0x15c709[_0x454a54(0x279)](generateSecureId,0x3e8);}catch(_0x5b9e2c){_0x15c709['TEiau'](expect,_0x5b9e2c)['toBeInstanceOf'](InvalidParameterError);}const _0x303ff9=_0x15c709['ppNvE'](performance[_0x454a54(0x242)](),_0x10cc33);_0x5ac61d[_0x454a54(0x2d7)](_0x303ff9);}const _0x3d5c32=_0x15c709[_0x454a54(0x257)](_0x5ac61d[_0x454a54(0x228)]((_0x30b053,_0x55b2d1)=>_0x30b053+_0x55b2d1),_0x5ac61d[_0x454a54(0x225)]),_0x239235=Math[_0x454a54(0x2bf)](..._0x5ac61d);_0x15c709[_0x454a54(0x2e0)](expect,_0x3d5c32)[_0x454a54(0x2b8)](0x5),expect(_0x239235)[_0x454a54(0x2b8)](0x14);}else return _0x182b39['fill'](0xff),_0x1aee59(_0x1b94da['FIFMI'])(),_0x329d6c;});}),_0x204c7e[_0x29ff4f(0x2d2)](describe,'BigInt\x20Buffer\x20Overflow\x20Protection',()=>{const _0x44b115=_0x29ff4f,_0x5d483f={'oTfpr':function(_0x1f3f99,_0x37e040){return _0x1f3f99**_0x37e040;},'XxovS':function(_0x311883,_0x1a864b){const _0x4cd162=_0x292d;return _0x204c7e[_0x4cd162(0x27c)](_0x311883,_0x1a864b);},'xCbeT':function(_0x315955,_0x1d4b8d){return _0x315955>=_0x1d4b8d;},'XyzMz':function(_0x3f1fdf,_0x676d92){return _0x3f1fdf===_0x676d92;},'QEAWr':_0x204c7e[_0x44b115(0x2b0)],'LGBzE':function(_0x90480d,_0x279468,_0x25c36c){const _0x22d1a7=_0x44b115;return _0x204c7e[_0x22d1a7(0x282)](_0x90480d,_0x279468,_0x25c36c);},'RWgHt':function(_0x522940,_0x5d586b){const _0x14f3e7=_0x44b115;return _0x204c7e[_0x14f3e7(0x1d4)](_0x522940,_0x5d586b);},'NgdNu':function(_0xa2839d,_0x3cc28d){return _0xa2839d(_0x3cc28d);},'yEiKN':function(_0x4cf414,_0x21d3c7,_0x1261a8){return _0x4cf414(_0x21d3c7,_0x1261a8);}};it('should\x20handle\x20BigInt\x20arithmetic\x20without\x2032-bit\x20overflow',async()=>{const _0x576222=_0x44b115,_0x2e321f=[[0x0,_0x5d483f[_0x576222(0x235)](0x2,0x20)-0x1],[0x3b9aca00,0x77359400],[-_0x5d483f['XxovS'](0x2,0x1e),_0x5d483f['oTfpr'](0x2,0x1e)]];for(const [_0x10501e,_0x1a6181]of _0x2e321f){if(_0x5d483f['xCbeT'](_0x10501e,-(0x2**0x1f))&&_0x1a6181<=0x2**0x1f){if(_0x5d483f['XyzMz'](_0x5d483f[_0x576222(0x2aa)],_0x576222(0x1c6))){const _0x566e67=await _0x5d483f[_0x576222(0x2a2)](getSecureRandomInt,_0x10501e,_0x1a6181);expect(_0x566e67)['toBeGreaterThanOrEqual'](_0x10501e),_0x5d483f['RWgHt'](expect,_0x566e67)[_0x576222(0x2b6)](_0x1a6181),_0x5d483f['NgdNu'](expect,Number[_0x576222(0x1e3)](_0x566e67))['toBe'](!![]);}else _0x5f3fac[_0x576222(0x226)]=_0x567042;}}}),_0x204c7e[_0x44b115(0x22a)](it,_0x204c7e[_0x44b115(0x1c4)],async()=>{const _0x2b7aa2=_0x44b115,_0x26eff6=[[Number[_0x2b7aa2(0x21f)],0x0],[0x0,Number[_0x2b7aa2(0x2e2)]]];for(const [_0x1049a7,_0x30d18c]of _0x26eff6){await _0x5d483f[_0x2b7aa2(0x22b)](expect,_0x5d483f[_0x2b7aa2(0x1ed)](getSecureRandomInt,_0x1049a7,_0x30d18c))['rejects']['toThrow'](InvalidParameterError);}});})):(_0x15c709['tpxFs'](_0x21067a,_0x15c709[_0x29ff4f(0x2ae)](_0x4c4b32,0x100))[_0x29ff4f(0x246)](0x100),_0x301c5b(()=>_0x106ef7(0x101))[_0x29ff4f(0x218)](_0x48d539),_0x15c709[_0x29ff4f(0x2e0)](_0x4df4c6,()=>_0x2d16ba(0x101))['toThrow'](/length must be an integer between 1 and 256/));});});