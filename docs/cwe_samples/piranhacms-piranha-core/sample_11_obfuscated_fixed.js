function _0x5a90(){const _0x37d4bc=['MZtau','xeoZx','LyBlC','/auth/transfer-root','kEFVv','config','30d','1095Pvmtju','EoRPy','yTZAh','compareSync','SllKm','NODE_ENV','isVRK','sendTelemetry','allow_account_creation','CuamE','onpKo','bcrypt','includes','addToAllOrgs','root','count','9230319iZUgGm','SAjDo','eSiQp','value','../utils/http','account_creation_domain_scope','UVXyO','json','kIpKZ','create','15ghCxpc','get','email','/auth/login','1hr','mjtxs','[003]\x20Access\x20denied.','sendStatus','message','[004]\x20Invalid\x20login\x20credentials.','IbiVI','LMEvU','dotenv','/auth/create-account','post','WQrjl','development','CbPcp','iksla','BjVfO','[000]\x20System\x20setup\x20has\x20not\x20been\x20completed\x20-\x20account\x20creation\x20disabled.','log','password','236775nsqOPZ','941388AAuerw','[001]\x20Account\x20already\x20exists\x20by\x20this\x20email\x20-\x20use\x20another.','exports','../models/user','YOAwd','env','status','admin','../models/systemSettings','12298192EIwcdo','1547280pHCQCU','488846raJItV','zrsPP','GQuZs','[002]\x20No\x20email\x20or\x20password\x20provided.','[002]\x20Invalid\x20login\x20credentials.','6904SInzUN','end'];_0x5a90=function(){return _0x37d4bc;};return _0x5a90();}const _0x10103d=_0x52ed;(function(_0x4dc7f7,_0x2447b9){const _0x3decb8=_0x52ed,_0x32ee61=_0x4dc7f7();while(!![]){try{const _0x2ae264=parseInt(_0x3decb8(0x12e))/0x1+-parseInt(_0x3decb8(0xef))/0x2*(-parseInt(_0x3decb8(0x117))/0x3)+parseInt(_0x3decb8(0xf4))/0x4*(-parseInt(_0x3decb8(0xfd))/0x5)+parseInt(_0x3decb8(0x12f))/0x6+parseInt(_0x3decb8(0xee))/0x7+-parseInt(_0x3decb8(0xed))/0x8+parseInt(_0x3decb8(0x10d))/0x9;if(_0x2ae264===_0x2447b9)break;else _0x32ee61['push'](_0x32ee61['shift']());}catch(_0x2cb238){_0x32ee61['push'](_0x32ee61['shift']());}}}(_0x5a90,0xe73cf),process[_0x10103d(0xe9)]['NODE_ENV']===_0x10103d(0x127)?require(_0x10103d(0x123))[_0x10103d(0xfb)]({'path':'.env.'+process[_0x10103d(0xe9)][_0x10103d(0x102)]}):require(_0x10103d(0x123))[_0x10103d(0xfb)]());const {SystemSettings}=require(_0x10103d(0xec)),{Telemetry}=require('../models/telemetry'),{User}=require(_0x10103d(0xe7)),{reqBody,makeJWT}=require(_0x10103d(0x111)),bcrypt=require(_0x10103d(0x108));function _0x52ed(_0x32a8dc,_0x3dedc0){const _0x5a903a=_0x5a90();return _0x52ed=function(_0x52ed78,_0x57fa62){_0x52ed78=_0x52ed78-0xe6;let _0x94028e=_0x5a903a[_0x52ed78];return _0x94028e;},_0x52ed(_0x32a8dc,_0x3dedc0);}function authenticationEndpoints(_0x18e6cf){const _0x2f3287=_0x10103d,_0x1f3251={'SAjDo':function(_0xfefe07,_0x38b038){return _0xfefe07===_0x38b038;},'DYRyH':_0x2f3287(0xf8),'DnFKR':function(_0x143030,_0x4a9811){return _0x143030>_0x4a9811;},'WQrjl':_0x2f3287(0xeb),'mjtxs':_0x2f3287(0x11b),'LMEvU':_0x2f3287(0x12b),'yTZAh':_0x2f3287(0xf2),'UVXyO':function(_0x42aeb5,_0x32875a){return _0x42aeb5>_0x32875a;},'GQuZs':function(_0x1317ef,_0x37a5f2){return _0x1317ef!==_0x37a5f2;},'znCYr':'[001]\x20Invalid\x20login\x20credentials.','BjVfO':_0x2f3287(0xf3),'onpKo':function(_0x13de32,_0x2085cd,_0x251963){return _0x13de32(_0x2085cd,_0x251963);},'SllKm':'XXPRJ','zrsPP':function(_0x43fea1,_0x259c1b){return _0x43fea1(_0x259c1b);},'sNSPD':_0x2f3287(0x130),'dxhYU':'[003]\x20Access\x20denied.','aMEca':_0x2f3287(0xf7),'raBMH':'[003]\x20Invalid\x20account\x20creation\x20values.','kEFVv':'login_event','MZtau':'30d','CuamE':_0x2f3287(0xfe),'eSiQp':function(_0x56d372,_0x19b422){return _0x56d372!==_0x19b422;},'IbiVI':function(_0x17a122,_0x2f947c){return _0x17a122>_0x2f947c;},'DntIA':function(_0x939e0,_0x2fa7ea,_0xeb0061){return _0x939e0(_0x2fa7ea,_0xeb0061);},'isVRK':_0x2f3287(0x124)};if(!_0x18e6cf)return;_0x18e6cf[_0x2f3287(0x118)]('/auth/auto-onboard',async(_0x4d2339,_0xbc14c8)=>{const _0x32bf28=_0x2f3287;if(_0x1f3251[_0x32bf28(0x10e)](_0x1f3251['DYRyH'],_0x32bf28(0xf8)))try{const _0x822209=_0x1f3251['DnFKR'](await User[_0x32bf28(0x10c)]({'role':_0x1f3251[_0x32bf28(0x126)]}),0x0);if(_0x822209){_0xbc14c8[_0x32bf28(0xea)](0xc8)[_0x32bf28(0x114)]({'completed':!![]});return;}const _0x452d53=await User[_0x32bf28(0x118)]({'role':_0x32bf28(0x10b)});if(!_0x452d53){_0xbc14c8[_0x32bf28(0xea)](0xc8)[_0x32bf28(0x114)]({'completed':!![]});return;}await Telemetry[_0x32bf28(0x104)]('onboarding_complete'),_0xbc14c8[_0x32bf28(0xea)](0xc8)['json']({'valid':!![],'user':_0x452d53,'token':makeJWT({'id':_0x452d53['id'],'email':_0x452d53['email']},_0x1f3251[_0x32bf28(0x11c)]),'message':null});}catch(_0x45ed69){console[_0x32bf28(0x12c)](_0x45ed69[_0x32bf28(0x11f)],_0x45ed69),_0xbc14c8[_0x32bf28(0x11e)](0x1f4)['end']();}else{_0x31da94[_0x32bf28(0xea)](0xc8)['json']({'completed':!![]});return;}}),_0x18e6cf['post'](_0x2f3287(0x11a),async(_0x39cd76,_0x2d192b)=>{const _0x501f4c=_0x2f3287,_0x2fddcf={'RalrP':_0x1f3251[_0x501f4c(0x122)]};try{const {email:_0x12fa59,password:_0x496d79}=reqBody(_0x39cd76);if(!_0x12fa59||!_0x496d79){_0x2d192b[_0x501f4c(0xea)](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1f3251[_0x501f4c(0xff)]});return;}if(_0x12fa59===process[_0x501f4c(0xe9)]['SYS_EMAIL']){const _0x12ac93=_0x1f3251[_0x501f4c(0x113)](await User[_0x501f4c(0x10c)]({'role':_0x1f3251[_0x501f4c(0x126)]}),0x0);if(_0x12ac93){if(_0x1f3251[_0x501f4c(0xf1)](_0x501f4c(0xe8),'YOAwd')){_0x4f99fc[_0x501f4c(0xea)](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x501f4c(0x130)});return;}else{_0x2d192b[_0x501f4c(0xea)](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x501f4c(0x120)});return;}}}const _0x20ff7c=await User[_0x501f4c(0x118)]({'email':_0x12fa59});if(!_0x20ff7c){_0x2d192b[_0x501f4c(0xea)](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1f3251['znCYr']});return;}if(!bcrypt[_0x501f4c(0x100)](_0x496d79,_0x20ff7c[_0x501f4c(0x12d)])){_0x2d192b[_0x501f4c(0xea)](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1f3251[_0x501f4c(0x12a)]});return;}await Telemetry['sendTelemetry']('login_event'),_0x2d192b['status'](0xc8)[_0x501f4c(0x114)]({'valid':!![],'user':_0x20ff7c,'token':_0x1f3251[_0x501f4c(0x107)](makeJWT,{'id':_0x20ff7c['id'],'email':_0x20ff7c[_0x501f4c(0x119)]},_0x501f4c(0xfc)),'message':null});return;}catch(_0x2bef88){if(_0x501f4c(0x115)!==_0x1f3251[_0x501f4c(0x101)])console['log'](_0x2bef88[_0x501f4c(0x11f)],_0x2bef88),_0x2d192b['sendStatus'](0x1f4)[_0x501f4c(0xf5)]();else{_0x3f3491['status'](0xc8)[_0x501f4c(0x114)]({'user':null,'valid':![],'token':null,'message':_0x2fddcf['RalrP']});return;}}}),_0x18e6cf['post'](_0x1f3251[_0x2f3287(0x103)],async(_0x48d7d3,_0x2fe9e4)=>{const _0x2aa715=_0x2f3287;try{const {email:_0x8953dc,password:_0x4012ff}=_0x1f3251[_0x2aa715(0xf0)](reqBody,_0x48d7d3);if(!_0x8953dc||!_0x4012ff){_0x2fe9e4[_0x2aa715(0xea)](0xc8)[_0x2aa715(0x114)]({'user':null,'valid':![],'token':null,'message':'[002]\x20No\x20email\x20or\x20password\x20provided.'});return;}const _0x41a1af=await User[_0x2aa715(0x10c)]({'role':_0x2aa715(0xeb)});if(_0x41a1af===0x0){_0x2fe9e4[_0x2aa715(0xea)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':'[000]\x20System\x20setup\x20has\x20not\x20been\x20completed\x20-\x20account\x20creation\x20disabled.'});return;}const _0x432316=await User[_0x2aa715(0x118)]({'email':_0x8953dc});if(!!_0x432316){_0x2fe9e4['status'](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x1f3251['sNSPD']});return;}const _0x3f68c1=await SystemSettings[_0x2aa715(0x118)]({'label':_0x2aa715(0x105)});if(!!_0x3f68c1&&_0x1f3251[_0x2aa715(0xf1)](_0x3f68c1['value'],null)&&_0x1f3251['SAjDo'](_0x3f68c1['value'],'false')){_0x2fe9e4['status'](0xc8)[_0x2aa715(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1f3251['dxhYU']});return;}const _0xb8d44f=await SystemSettings[_0x2aa715(0x118)]({'label':_0x2aa715(0x112)});if(!!_0xb8d44f&&_0xb8d44f[_0x2aa715(0x110)]!==null&&!_0x8953dc[_0x2aa715(0x109)](_0xb8d44f['value'])){if(_0x1f3251[_0x2aa715(0x10e)](_0x2aa715(0xf7),_0x1f3251['aMEca'])){_0x2fe9e4[_0x2aa715(0xea)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x1f3251['raBMH']});return;}else{_0x4af4dc[_0x2aa715(0xea)](0xc8)[_0x2aa715(0x114)]({'user':null,'valid':![],'token':null,'message':'[001]\x20Invalid\x20login\x20credentials.'});return;}}const {user:_0x141ca0,message:_0x412953}=await User['create']({'email':_0x8953dc,'password':_0x4012ff});if(!_0x141ca0){_0x2fe9e4[_0x2aa715(0xea)](0xc8)[_0x2aa715(0x114)]({'user':null,'valid':![],'token':null,'message':_0x412953});return;}await User[_0x2aa715(0x10a)](_0x141ca0['id']),await Telemetry['sendTelemetry'](_0x1f3251[_0x2aa715(0xfa)]),_0x2fe9e4[_0x2aa715(0xea)](0xc8)[_0x2aa715(0x114)]({'user':_0x141ca0,'valid':!![],'token':makeJWT({'id':_0x141ca0['id'],'email':_0x141ca0[_0x2aa715(0x119)]},_0x1f3251[_0x2aa715(0xf6)]),'message':null});return;}catch(_0x33b507){console['log'](_0x33b507[_0x2aa715(0x11f)],_0x33b507),_0x2fe9e4[_0x2aa715(0x11e)](0x1f4)[_0x2aa715(0xf5)]();}}),_0x18e6cf[_0x2f3287(0x125)](_0x2f3287(0xf9),async(_0x229b4a,_0x35c5b2)=>{const _0x3a1013=_0x2f3287,_0x213966={'iksla':_0x3a1013(0x11d)};if(_0x1f3251['GQuZs'](_0x1f3251['CuamE'],_0x1f3251[_0x3a1013(0x106)])){_0x5e8f62[_0x3a1013(0xea)](0xc8)[_0x3a1013(0x114)]({'user':null,'valid':![],'token':null,'message':_0x213966[_0x3a1013(0x129)]});return;}else try{if(_0x1f3251[_0x3a1013(0x10f)](_0x3a1013(0x128),_0x3a1013(0x128)))_0x42478e[_0x3a1013(0x12c)](_0x557a7c[_0x3a1013(0x11f)],_0x4c8110),_0x204ad5[_0x3a1013(0x11e)](0x1f4)['end']();else{const {email:_0x457b68,password:_0x1ac536}=reqBody(_0x229b4a);if(!_0x457b68||!_0x1ac536){_0x35c5b2[_0x3a1013(0xea)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':'[002]\x20No\x20email\x20or\x20password\x20provided.'});return;}const _0x210bf1=await User[_0x3a1013(0x10c)]({'role':_0x3a1013(0xeb)});if(_0x1f3251[_0x3a1013(0x121)](_0x210bf1,0x0)){_0x35c5b2['status'](0xc8)[_0x3a1013(0x114)]({'user':null,'valid':![],'token':null,'message':'[000]\x20System\x20setup\x20has\x20already\x20been\x20completed\x20-\x20you\x20cannot\x20do\x20this\x20again.'});return;}const _0x4ba17f=await User[_0x3a1013(0x118)]({'email':_0x457b68});if(!!_0x4ba17f){_0x35c5b2[_0x3a1013(0xea)](0xc8)[_0x3a1013(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1f3251['sNSPD']});return;}const {user:_0x429e38,message:_0x1fb5c2}=await User[_0x3a1013(0x116)]({'email':_0x457b68,'password':_0x1ac536,'role':_0x3a1013(0xeb)});if(!_0x429e38){_0x35c5b2[_0x3a1013(0xea)](0xc8)[_0x3a1013(0x114)]({'user':null,'valid':![],'token':null,'message':_0x1fb5c2});return;}_0x35c5b2[_0x3a1013(0xea)](0xc8)[_0x3a1013(0x114)]({'user':_0x429e38,'valid':!![],'token':_0x1f3251['DntIA'](makeJWT,{'id':_0x429e38['id'],'email':_0x429e38[_0x3a1013(0x119)]},_0x3a1013(0xfc)),'message':null});return;}}catch(_0x198a39){console[_0x3a1013(0x12c)](_0x198a39['message'],_0x198a39),_0x35c5b2[_0x3a1013(0x11e)](0x1f4)[_0x3a1013(0xf5)]();}});}module[_0x10103d(0xe6)]={'authenticationEndpoints':authenticationEndpoints};