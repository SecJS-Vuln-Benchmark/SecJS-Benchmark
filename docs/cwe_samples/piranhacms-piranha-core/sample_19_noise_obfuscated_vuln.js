const _0x869d5b=_0x30aa;function _0x30aa(_0x3c1b97,_0x5001d7){const _0x3a22ff=_0x3a22();return _0x30aa=function(_0x30aa06,_0x2a7609){_0x30aa06=_0x30aa06-0x1a1;let _0x262ad4=_0x3a22ff[_0x30aa06];return _0x262ad4;},_0x30aa(_0x3c1b97,_0x5001d7);}(function(_0x1e18f5,_0x5b69c0){const _0x94d1f5=_0x30aa,_0x43ca61=_0x1e18f5();while(!![]){try{const _0x4119f7=-parseInt(_0x94d1f5(0x22a))/0x1*(-parseInt(_0x94d1f5(0x208))/0x2)+parseInt(_0x94d1f5(0x1ec))/0x3*(parseInt(_0x94d1f5(0x1f4))/0x4)+parseInt(_0x94d1f5(0x1a8))/0x5*(-parseInt(_0x94d1f5(0x203))/0x6)+-parseInt(_0x94d1f5(0x210))/0x7*(parseInt(_0x94d1f5(0x212))/0x8)+parseInt(_0x94d1f5(0x228))/0x9*(-parseInt(_0x94d1f5(0x1b2))/0xa)+parseInt(_0x94d1f5(0x1f8))/0xb*(-parseInt(_0x94d1f5(0x233))/0xc)+parseInt(_0x94d1f5(0x1ea))/0xd;if(_0x4119f7===_0x5b69c0)break;else _0x43ca61['push'](_0x43ca61['shift']());}catch(_0xaa2b55){_0x43ca61['push'](_0x43ca61['shift']());}}}(_0x3a22,0xa2536));const fs=require('fs'),http=require(_0x869d5b(0x1e9)),path=require(_0x869d5b(0x1c9)),WebSocket=require('ws'),express=require(_0x869d5b(0x214)),pty=require(_0x869d5b(0x232)),hbs=require(_0x869d5b(0x1c2)),dotenv=require(_0x869d5b(0x22f)),Tokens=require(_0x869d5b(0x1aa)),url=require(_0x869d5b(0x1a3)),yaml=require(_0x869d5b(0x1d6)),glob=require(_0x869d5b(0x221)),port=0xbb8,host_path_rx=_0x869d5b(0x1e6),helpers=require('./utils/helpers');dotenv['config']({'path':_0x869d5b(0x1b5)});process[_0x869d5b(0x1bc)]['NODE_ENV']===_0x869d5b(0x1ba)&&dotenv[_0x869d5b(0x200)]({'path':_0x869d5b(0x21e)});fs[_0x869d5b(0x1e0)](_0x869d5b(0x1fb))&&(console['warn'](_0x869d5b(0x229)),dotenv['config']({'path':'.env'}));var color_themes={'dark':[],'light':[]};glob[_0x869d5b(0x1fe)](_0x869d5b(0x1ce))[_0x869d5b(0x20e)](_0x44b416=>color_themes[_0x869d5b(0x230)][_0x869d5b(0x1e3)](require(path[_0x869d5b(0x1f1)](_0x44b416)))),glob[_0x869d5b(0x1fe)](_0x869d5b(0x224))[_0x869d5b(0x20e)](_0x535012=>color_themes[_0x869d5b(0x1d8)][_0x869d5b(0x1e3)](require(path[_0x869d5b(0x1f1)](_0x535012)))),color_themes[_0x869d5b(0x21b)]=JSON['stringify']([...color_themes[_0x869d5b(0x230)],...color_themes[_0x869d5b(0x1d8)]]);const tokens=new Tokens({}),secret=tokens[_0x869d5b(0x1a4)]();var router=express['Router']();router['get'](['/','/ssh'],function(_0x15fe4f,_0x20599d){const _0x1f3ce8=_0x869d5b,_0x5732f8={'cGikA':function(_0x11f846,_0x405c83){return _0x11f846+_0x405c83;}};_0x20599d['redirect'](_0x5732f8[_0x1f3ce8(0x1db)](_0x15fe4f[_0x1f3ce8(0x222)],'/ssh/default'));}),router['get']('/ssh*',function(_0x2e5a90,_0x4f249f){const _0x5b98d4=_0x869d5b,_0x35e3de={'irUVg':function(_0x3ddfe5,_0x97f4ba){return _0x3ddfe5(_0x97f4ba);},'FCCYw':_0x5b98d4(0x21a)};var _0x180870,_0x2ea113;[_0x180870,_0x2ea113]=_0x35e3de[_0x5b98d4(0x1da)](host_and_dir_from_url,_0x2e5a90[_0x5b98d4(0x1a3)]),_0x4f249f[_0x5b98d4(0x20c)](_0x5b98d4(0x1ca),{'baseURI':_0x2e5a90['baseUrl'],'csrfToken':tokens[_0x5b98d4(0x1bb)](secret),'host':_0x180870,'dir':_0x2ea113,'colorThemes':color_themes,'siteTitle':process[_0x5b98d4(0x1bc)][_0x5b98d4(0x211)]||_0x35e3de[_0x5b98d4(0x1c3)]});}),router[_0x869d5b(0x1f0)](express[_0x869d5b(0x1e1)](path['join'](__dirname,_0x869d5b(0x1e8))));var app=express();app['set'](_0x869d5b(0x1b9),_0x869d5b(0x1c2)),app[_0x869d5b(0x1dc)]('views',path[_0x869d5b(0x1af)](__dirname,'views')),app['use'](process[_0x869d5b(0x1bc)][_0x869d5b(0x1c1)]||'/',router);const server=new http['createServer'](app),wss=new WebSocket[(_0x869d5b(0x1cd))]({'noServer':!![]});let host_allowlist=[];process[_0x869d5b(0x1bc)][_0x869d5b(0x1d9)]&&(host_allowlist=Array['from'](new Set(process[_0x869d5b(0x1bc)]['OOD_SSHHOST_ALLOWLIST']['split'](':'))));const inactiveTimeout=process[_0x869d5b(0x1bc)][_0x869d5b(0x1c6)]||0x493e0,maxShellTime=process[_0x869d5b(0x1bc)][_0x869d5b(0x1df)]||0x36ee80,pingPongEnabled=process[_0x869d5b(0x1bc)][_0x869d5b(0x1a7)]?!![]:![];let hosts=helpers[_0x869d5b(0x20b)](),default_sshhost=hosts[_0x869d5b(0x1c5)];hosts[_0x869d5b(0x1b8)][_0x869d5b(0x20e)](_0x45c158=>{const _0x1a2dff=_0x869d5b;host_allowlist[_0x1a2dff(0x1e3)](_0x45c158);});function _0x3a22(){const _0x5eb5c8=['hRcvO','/ssh/([^\x5c/\x5c?]+)([^\x5c?]+)?(\x5c?.*)?$','\x27\x20;\x20exec\x20${SHELL}\x20-l','public','http','22826947ZCPjiW','Bad\x20CSRF\x20Token.','591AuqTFg','jhyQP','emit','pxBHC','use','resolve','fMVAi','XfoSq','8392Ececff','ENmTn','pid','rows','10813660HERDOG','KKhau','match','.env','startedAt','XTxjH','sync','pong','config','OiJbT','hgExz','6riLILv','split','Closed\x20terminal:\x20','QLIkB','FuRTU','12862PyslUU','log','BJTBY','definedHosts','render','var\x20x\x20=\x2042;\x20return\x20x;','forEach','dMVJT','7DSKNTf','OOD_DASHBOARD_TITLE','5472952ezsjee','en_US.UTF-8','express','mJScG','://','Opened\x20terminal:\x20','x-forwarded-proto','qqDOL','Open\x20OnDemand','json_array','isAlive','length','/etc/ood/config/apps/shell/env','wxfiu','close','glob','baseUrl','\x22\x20not\x20specified\x20in\x20allowlist\x20or\x20cluster\x20configs.','./color_themes/dark/*','verify','onData','Invalid\x20Origin.','10323ZYUOVN','[DEPRECATION]\x20The\x20file\x20\x27.env\x27\x20is\x20being\x20deprecated.\x20Please\x20move\x20this\x20file\x20to\x20\x27/etc/ood/config/apps/shell/env\x27.','166EvrIIu','cBfNz','connection','1|3|4|8|6|5|2|0|7','HLcJg','dotenv','light','safe','node-pty','12DrReUZ','onExit','PVJug','mRVBF','input','url','secretSync','wAnSl','replace','OOD_SHELL_PING_PONG','3330650KUXHcj','return\x20Object.keys({a:1});','csrf','Send\x20error:\x20','end','UzOVz','IJQeV','join','lastActivity','OOD_SSH_WRAPPER','2080geCvff','now','ping','.env.local','handleUpgrade','Host\x20\x22','hosts','view\x20engine','production','create','env','return\x20new\x20Date();','x-forwarded-host','GTUcz','upgrade','PASSENGER_BASE_URI','hbs','FCCYw','OOD_SHELL_ORIGIN_CHECK','default','OOD_SHELL_INACTIVE_TIMEOUT_MS','Listening\x20on\x20','wTvIL','path','index','Connection\x20established','GqTzE','Server','./color_themes/light/*','qWDXg','qPXKR','jhRSb','write','qboXb','ssh','JTqUS','js-yaml','terminate','dark','OOD_SSHHOST_ALLOWLIST','irUVg','cGikA','set','stringify','jVWLt','OOD_SHELL_MAX_DURATION_MS','existsSync','static','cols','push','resize'];_0x3a22=function(){return _0x5eb5c8;};return _0x3a22();}function host_and_dir_from_url(_0xbb86bf){const _0x10860e=_0x869d5b,_0x38a9dd={'pxBHC':_0x10860e(0x1c5),'vSezp':function(_0x4b4ca6,_0x157a08){return _0x4b4ca6(_0x157a08);}};let _0x8f5fa2=_0xbb86bf[_0x10860e(0x1fa)](host_path_rx),_0x27a993=null,_0x265ed2=null;return _0x8f5fa2&&(_0x27a993=_0x8f5fa2[0x1]===_0x38a9dd[_0x10860e(0x1ef)]?default_sshhost:_0x8f5fa2[0x1],_0x265ed2=_0x8f5fa2[0x2]?_0x38a9dd['vSezp'](decodeURIComponent,_0x8f5fa2[0x2]):null),eval('Math[\'PI\'] * 2;'),[_0x27a993,_0x265ed2];}function custom_server_origin(_0x3ef58f=null){const _0x2fda5f=_0x869d5b,_0x244841={'wTvIL':_0x2fda5f(0x1ca),'GqTzE':'Open\x20OnDemand','XTxjH':function(_0xccaa5a,_0x5768d9){return _0xccaa5a===_0x5768d9;},'QqCcp':'hgExz','IJQeV':_0x2fda5f(0x1e9),'qPXKR':function(_0x17071d,_0x15c8f8){return _0x17071d!==_0x15c8f8;},'fMVAi':_0x2fda5f(0x1f5),'KKhau':function(_0x563ae9,_0x41ab6b,_0x1e27b5){return _0x563ae9(_0x41ab6b,_0x1e27b5);}};var _0x437edc=null;if(process[_0x2fda5f(0x1bc)]['OOD_SHELL_ORIGIN_CHECK']){if(_0x244841[_0x2fda5f(0x1fd)](_0x2fda5f(0x202),_0x244841['QqCcp'])){if(process[_0x2fda5f(0x1bc)][_0x2fda5f(0x1c4)]['startsWith'](_0x244841[_0x2fda5f(0x1ae)])){if(_0x244841[_0x2fda5f(0x1d0)](_0x244841[_0x2fda5f(0x1f2)],_0x2fda5f(0x215)))_0x437edc=process[_0x2fda5f(0x1bc)]['OOD_SHELL_ORIGIN_CHECK'];else{var _0x12ea20,_0x3020a5;[_0x12ea20,_0x3020a5]=_0xe2c903(_0x3da9f7[_0x2fda5f(0x1a3)]),_0x3a2c1c[_0x2fda5f(0x20c)](_0x244841[_0x2fda5f(0x1c8)],{'baseURI':_0x234db2[_0x2fda5f(0x222)],'csrfToken':_0x5f0ad1[_0x2fda5f(0x1bb)](_0x1aa23b),'host':_0x12ea20,'dir':_0x3020a5,'colorThemes':_0x24f87f,'siteTitle':_0x18a9e5[_0x2fda5f(0x1bc)][_0x2fda5f(0x211)]||_0x244841[_0x2fda5f(0x1cc)]});}}}else _0x477c79=_0x54d778[_0x2fda5f(0x1bc)][_0x2fda5f(0x1c4)];}else _0x437edc=_0x3ef58f;return _0x244841[_0x2fda5f(0x1f9)](setTimeout,'console.log(\x22timer\x22);',0x3e8),_0x437edc;}function default_server_origin(_0x2846f4){const _0x506be1=_0x869d5b,_0x1022da={'ndswY':_0x506be1(0x218),'GTUcz':function(_0x37dcc8,_0x26d308){return _0x37dcc8+_0x26d308;},'cBfNz':'://'};var _0x470a4d=null;return _0x2846f4[_0x1022da['ndswY']]&&_0x2846f4[_0x506be1(0x1be)]&&(_0x470a4d=_0x1022da[_0x506be1(0x1bf)](_0x2846f4[_0x506be1(0x218)],_0x1022da[_0x506be1(0x22b)])+_0x2846f4[_0x506be1(0x1be)]),eval('Math[\'PI\'] * 2;'),_0x470a4d;}function detect_auth_error(_0x50c43a,_0x582b8b,_0xf3784c,_0x3d0654){const _0x3978d3=_0x869d5b,_0x4c0b14={'wxfiu':function(_0x19786e,_0x85362b){return _0x19786e(_0x85362b);},'BPdav':_0x3978d3(0x20d),'QLIkB':_0x3978d3(0x227),'OiJbT':_0x3978d3(0x1eb)};if(host_allowlist[_0x3978d3(0x21d)]==0x0)return _0x4c0b14[_0x3978d3(0x21f)](Function,_0x3978d3(0x1a9))(),'No\x20clusters\x20defined.';else{if(_0x582b8b&&_0x582b8b['startsWith'](_0x3978d3(0x1e9))&&_0xf3784c&&_0x582b8b!==_0xf3784c)return new Function(_0x4c0b14['BPdav'])(),_0x4c0b14[_0x3978d3(0x206)];else{if(!tokens[_0x3978d3(0x225)](secret,_0x50c43a))return eval('Math[\'PI\'] * 2;'),_0x4c0b14[_0x3978d3(0x201)];else return!helpers['hostInAllowList'](host_allowlist,_0x3d0654)?(eval('Math[\'PI\'] * 2;'),_0x3978d3(0x1b7)+_0x3d0654+_0x3978d3(0x223)):(eval('const _0xdcce95 = _0x3978d3;JSON[_0xdcce95(477)]({ \'safe\': !![] });'),null);}}}wss['on'](_0x869d5b(0x22c),function connection(_0x256764,_0x27032d){const _0x44a7a2=_0x869d5b,_0x4cf9f5={'JTqUS':_0x44a7a2(0x1ab),'mRVBF':function(_0x59e86f,_0x462b72){return _0x59e86f(_0x462b72);},'wAnSl':_0x44a7a2(0x205),'Cnjnb':function(_0x43228d,_0x44a453,_0x5d306b,_0xb1f340,_0x3c2654){return _0x43228d(_0x44a453,_0x5d306b,_0xb1f340,_0x3c2654);},'dzSZl':function(_0x249bab,_0x544f41){return _0x249bab(_0x544f41);},'qqDOL':function(_0x446452,_0x1a2251){return _0x446452(_0x1a2251);},'jhRSb':_0x44a7a2(0x22d),'jVWLt':'close','bSLUU':function(_0x504cf8,_0x301d44){return _0x504cf8+_0x301d44;},'WKckh':'cd\x20\x27','NApxd':_0x44a7a2(0x213),'YizFo':_0x44a7a2(0x1ff),'YXZrY':_0x44a7a2(0x217),'hRcvO':function(_0x1ef7d3,_0x302870,_0x316804){return _0x1ef7d3(_0x302870,_0x316804);}};var _0x2e0238,_0x405921,_0xb42c50,_0x411691,_0x5aeca9=process[_0x44a7a2(0x1bc)][_0x44a7a2(0x1b1)]||_0x44a7a2(0x1d4);_0x256764[_0x44a7a2(0x21c)]=!![],_0x256764[_0x44a7a2(0x1fc)]=Date[_0x44a7a2(0x1b3)](),_0x256764[_0x44a7a2(0x1b0)]=Date[_0x44a7a2(0x1b3)](),console[_0x44a7a2(0x209)](_0x44a7a2(0x1cb)),[_0x411691,_0x2e0238]=host_and_dir_from_url(_0x27032d['url']),token=_0x27032d[_0x44a7a2(0x1a3)][_0x44a7a2(0x1fa)](/csrf=([^&]*)/)[0x1],authError=_0x4cf9f5['Cnjnb'](detect_auth_error,token,_0x27032d['origin'],_0x4cf9f5['dzSZl'](custom_server_origin,_0x4cf9f5[_0x44a7a2(0x219)](default_server_origin,_0x27032d)),_0x411691);if(authError)_0x256764[_0x44a7a2(0x220)](0xc4a,authError);else{const _0x15eb66=_0x4cf9f5[_0x44a7a2(0x1d1)][_0x44a7a2(0x204)]('|');let _0x11c98a=0x0;while(!![]){switch(_0x15eb66[_0x11c98a++]){case'0':_0x256764['on'](_0x4cf9f5[_0x44a7a2(0x1de)],function(){const _0x5ccc9e=_0x44a7a2;_0x405921[_0x5ccc9e(0x1ac)](),this['isAlive']=![],console[_0x5ccc9e(0x209)](_0x4cf9f5[_0x5ccc9e(0x1a5)]+_0x405921[_0x5ccc9e(0x1f6)]);});continue;case'1':_0xb42c50=_0x2e0238?[_0x411691,'-t',_0x4cf9f5['bSLUU'](_0x4cf9f5['WKckh'],_0x2e0238[_0x44a7a2(0x1a6)](/\'/g,'\x27\x5c\x27\x27'))+_0x44a7a2(0x1e7)]:[_0x411691];continue;case'2':_0x256764['on']('message',function(_0x4dd0f9){const _0x590e32=_0x44a7a2;_0x4dd0f9=JSON['parse'](_0x4dd0f9);_0x4dd0f9[_0x590e32(0x1a2)]&&(_0x405921[_0x590e32(0x1d2)](_0x4dd0f9[_0x590e32(0x1a2)]),this[_0x590e32(0x1b0)]=Date['now']());if(_0x4dd0f9['resize'])_0x405921['resize'](_0x4cf9f5[_0x590e32(0x1a1)](parseInt,_0x4dd0f9[_0x590e32(0x1e4)][_0x590e32(0x1e2)]),parseInt(_0x4dd0f9[_0x590e32(0x1e4)][_0x590e32(0x1f7)]));});continue;case'3':process[_0x44a7a2(0x1bc)]['LANG']=_0x4cf9f5['NApxd'];continue;case'4':_0x405921=pty['spawn'](_0x5aeca9,_0xb42c50,{'name':'xterm-16color','cols':0x50,'rows':0x1e});continue;case'5':_0x405921[_0x44a7a2(0x234)](function(_0x2c7428){const _0x308b40=_0x44a7a2;_0x256764[_0x308b40(0x220)]();});continue;case'6':_0x405921[_0x44a7a2(0x226)](function(_0x58163f){const _0x683006=_0x44a7a2;_0x256764['send'](_0x58163f,function(_0x1d3810){const _0x4143b7=_0x30aa;if(_0x1d3810)console['log'](_0x4cf9f5[_0x4143b7(0x1d5)]+_0x1d3810['message']);}),_0x256764[_0x683006(0x1b0)]=Date[_0x683006(0x1b3)]();});continue;case'7':_0x256764['on'](_0x4cf9f5['YizFo'],function(){const _0x5e296c=_0x44a7a2;this[_0x5e296c(0x21c)]=!![];});continue;case'8':console[_0x44a7a2(0x209)](_0x4cf9f5['YXZrY']+_0x405921['pid']);continue;}break;}}_0x4cf9f5[_0x44a7a2(0x1e5)](setTimeout,function(){const _0x4ac326=_0x44a7a2;console['log'](_0x4ac326(0x231));},0x64);});const interval=setInterval(function ping(){const _0x35bebc=_0x869d5b,_0x4e6b25={'HLcJg':_0x35bebc(0x1be),'FuRTU':'x-forwarded-proto','XfoSq':_0x35bebc(0x216),'dMVJT':function(_0x178bb2,_0x5661c5){return _0x178bb2===_0x5661c5;},'qboXb':function(_0xcddad7,_0x3deed9){return _0xcddad7-_0x3deed9;},'qgwKp':function(_0xf4813e,_0x367e93){return _0xf4813e>_0x367e93;},'oYCAB':function(_0x2c2b29,_0x14d39c){return _0x2c2b29(_0x14d39c);},'qWDXg':_0x35bebc(0x235)};wss['clients'][_0x35bebc(0x20e)](function _0x45c64d(_0x506d9e){const _0x18352f=_0x35bebc;if(_0x4e6b25[_0x18352f(0x20f)](_0x18352f(0x1ed),_0x18352f(0x1ed))){const _0x23ccff=_0x4e6b25[_0x18352f(0x1d3)](Date[_0x18352f(0x1b3)](),_0x506d9e['startedAt']),_0x3eb38d=Date[_0x18352f(0x1b3)]()-_0x506d9e[_0x18352f(0x1b0)];if(_0x506d9e[_0x18352f(0x21c)]===![]||_0x3eb38d>inactiveTimeout||_0x4e6b25['qgwKp'](_0x23ccff,maxShellTime))return _0x4e6b25['oYCAB'](Function,_0x18352f(0x1bd))(),_0x506d9e[_0x18352f(0x1d7)]();pingPongEnabled&&(_0x18352f(0x20a)!==_0x4e6b25[_0x18352f(0x1cf)]?(_0x506d9e[_0x18352f(0x21c)]=![],_0x506d9e[_0x18352f(0x1b4)]()):_0x218767[_0x18352f(0x220)](0xc4a,_0x88d9da));}else{var _0x306087=null;return _0x1ae25[_0x18352f(0x218)]&&_0x43537f[_0x4e6b25[_0x18352f(0x22e)]]&&(_0x306087=_0x177411[_0x4e6b25[_0x18352f(0x207)]]+_0x4e6b25[_0x18352f(0x1f3)]+_0x2e9b11[_0x18352f(0x1be)]),eval('_0x10c872[\'PI\'] * 2;'),_0x306087;}});},0x7530);wss['on'](_0x869d5b(0x220),function close(){clearInterval(interval);}),server['on'](_0x869d5b(0x1c0),function upgrade(_0x441286,_0x216c03,_0x195d23){const _0x485d7c=_0x869d5b,_0x27fa42={'jYQGJ':_0x485d7c(0x22c)};wss[_0x485d7c(0x1b6)](_0x441286,_0x216c03,_0x195d23,function _0x3ee3e9(_0x5f2836){const _0x2c0ca0=_0x485d7c;wss[_0x2c0ca0(0x1ee)](_0x27fa42['jYQGJ'],_0x5f2836,_0x441286);});}),server['listen'](port,function(){const _0x3ec582=_0x869d5b,_0x19ce2b={'UzOVz':_0x3ec582(0x1c7)};console[_0x3ec582(0x209)](_0x19ce2b[_0x3ec582(0x1ad)]+port);});