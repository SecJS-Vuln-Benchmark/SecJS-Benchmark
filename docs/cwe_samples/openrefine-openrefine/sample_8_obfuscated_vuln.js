const _0x1b010e=_0x42f2;(function(_0x5c520b,_0x6b7aec){const _0xcb650=_0x42f2,_0x5d712d=_0x5c520b();while(!![]){try{const _0x224e5f=parseInt(_0xcb650(0x13e))/0x1+-parseInt(_0xcb650(0x116))/0x2*(-parseInt(_0xcb650(0x1b6))/0x3)+parseInt(_0xcb650(0x10d))/0x4*(parseInt(_0xcb650(0x189))/0x5)+parseInt(_0xcb650(0x1d0))/0x6*(parseInt(_0xcb650(0x1a1))/0x7)+-parseInt(_0xcb650(0x110))/0x8+-parseInt(_0xcb650(0x1b0))/0x9*(parseInt(_0xcb650(0x11f))/0xa)+-parseInt(_0xcb650(0x12f))/0xb*(parseInt(_0xcb650(0x1e2))/0xc);if(_0x224e5f===_0x6b7aec)break;else _0x5d712d['push'](_0x5d712d['shift']());}catch(_0x1df7f0){_0x5d712d['push'](_0x5d712d['shift']());}}}(_0x28f8,0x3e740));import{createHash}from'node:crypto';import{mkdir,readFile,writeFile}from'node:fs/promises';import{dirname,extname,resolve,relative}from'node:path';import{fileURLToPath}from'node:url';import{doesFileExist,scanDirectory}from'./fs.mjs';import{patchHeaders}from'./headers.mjs';function _0x42f2(_0x2805db,_0x3ea318){const _0x28f892=_0x28f8();return _0x42f2=function(_0x42f20e,_0x5c50a3){_0x42f20e=_0x42f20e-0x109;let _0x427e36=_0x28f892[_0x42f20e];return _0x427e36;},_0x42f2(_0x2805db,_0x3ea318);}export const generateSRIHash=_0x5ca351=>{const _0x153b61=_0x42f2,_0x5d3d49={'IcQhV':function(_0x2b6a5d,_0x317cec){return _0x2b6a5d instanceof _0x317cec;}},_0x4c667c=createHash('sha256');if(_0x5d3d49[_0x153b61(0x150)](_0x5ca351,ArrayBuffer))_0x4c667c['update'](Buffer[_0x153b61(0x15a)](_0x5ca351));else _0x5ca351 instanceof Buffer?_0x4c667c[_0x153b61(0x14f)](_0x5ca351):_0x4c667c[_0x153b61(0x14f)](_0x5ca351,_0x153b61(0x135));return _0x153b61(0x191)+_0x4c667c[_0x153b61(0x17d)](_0x153b61(0x17b));};const scriptReplacer=(_0x1337ff,_0x4abf62,_0x4c7ec9,_0x551c51)=>_0x1b010e(0x1c7)+_0x4abf62+_0x1b010e(0x180)+_0x1337ff+'\x22'+(_0x4c7ec9?_0x1b010e(0x143):'')+'>'+(_0x551c51??'')+_0x1b010e(0x170),styleReplacer=(_0x1c3b34,_0x5252e6,_0x5bd523,_0x182f18)=>'<style'+_0x5252e6+_0x1b010e(0x180)+_0x1c3b34+'\x22'+(_0x5bd523?_0x1b010e(0x143):'')+'>'+(_0x182f18??'')+'</style>',linkStyleReplacer=(_0x2ed3ad,_0x4ff389,_0xed639)=>_0x1b010e(0x156)+_0x4ff389+'\x20integrity=\x22'+_0x2ed3ad+'\x22'+(_0xed639?'\x20crossorigin=\x22anonymous\x22':'')+'/>',srcRegex=/\s+(src|href)\s*=\s*("(?<src1>.*?)"|'(?<src2>.*?)')/i,integrityRegex=/\s+integrity\s*=\s*("(?<integrity1>.*?)"|'(?<integrity2>.*?)')/i,relStylesheetRegex=/\s+rel\s*=\s*('stylesheet'|"stylesheet")/i,getRegexProcessors=()=>{const _0x1359ee=_0x1b010e,_0xda8b82={'iLlKy':'Script','HXRdc':_0x1359ee(0x1e4)};return[{'t':_0xda8b82[_0x1359ee(0x120)],'t2':_0xda8b82[_0x1359ee(0x10b)],'regex':/<script(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*script\s*>/gi,'replacer':scriptReplacer,'hasContent':!![],'attrsRegex':undefined},{'t':'Style','t2':_0x1359ee(0x164),'regex':/<style(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*style\s*>/gi,'replacer':styleReplacer,'hasContent':!![],'attrsRegex':undefined},{'t':_0x1359ee(0x19a),'t2':_0x1359ee(0x164),'regex':/<link(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*\/?>/gi,'replacer':linkStyleReplacer,'hasContent':![],'attrsRegex':relStylesheetRegex}];};export const updateStaticPageSriHashes=async(_0x5f4b0b,_0x72c060,_0x1557f3,_0x299cd9,_0x4df9da,_0x47a830='all',_0x5c2710=_0x1b010e(0x13a))=>{const _0x36a7ee=_0x1b010e,_0x41724e={'MkyyL':function(_0x2c45f0,_0x48c540){return _0x2c45f0!==_0x48c540;},'FUwWm':function(_0x53b91e,_0x18669c){return _0x53b91e<_0x18669c;},'mRTuc':function(_0x599148,_0x274836){return _0x599148!==_0x274836;},'naHWJ':_0x36a7ee(0x186),'xKYdi':function(_0x837393,_0x1239eb){return _0x837393(_0x1239eb);},'JuvYj':function(_0x4bbd33,_0x35dd1e){return _0x4bbd33===_0x35dd1e;},'idLOU':_0x36a7ee(0x152),'UxzRY':function(_0x409506,_0x12515e){return _0x409506&&_0x12515e;},'swYIl':function(_0x39ce01,_0x33e1c3){return _0x39ce01===_0x33e1c3;},'TlUuR':function(_0x5f2b2e,_0x4bc95b){return _0x5f2b2e===_0x4bc95b;},'ujWpu':_0x36a7ee(0x15b),'CVPAQ':function(_0x371d88,_0x2f870e){return _0x371d88(_0x2f870e);}},_0x9a994d=getRegexProcessors(),_0x390acb=_0x4df9da[_0x36a7ee(0x161)][_0x36a7ee(0x10e)](_0x1557f3)??{'scripts':new Set(),'styles':new Set()};_0x4df9da['perPageSriHashes'][_0x36a7ee(0x1de)](_0x1557f3,_0x390acb);let _0x920421=_0x299cd9,_0x1663be;for(const {attrsRegex:_0x4d3d80,hasContent:_0x490d2d,regex:_0x5bc4e7,replacer:_0x3c8240,t:_0x293312,t2:_0x20cfd5}of _0x9a994d){while(_0x41724e[_0x36a7ee(0x17f)](_0x1663be=_0x5bc4e7['exec'](_0x299cd9),null)){const _0x4c93f5=_0x1663be[_0x36a7ee(0x19b)]?.['attrs']??'',_0x207d4e=_0x1663be['groups']?.[_0x36a7ee(0x136)]??'';let _0x31dbea=undefined,_0x30583f=![];if(_0x4c93f5){if(_0x41724e[_0x36a7ee(0x1bc)](_0x36a7ee(0x186),_0x41724e[_0x36a7ee(0x153)])){if(_0x28fe85[_0x52d643]!==_0x3aaa4d[_0x595687])return![];}else{if(_0x4d3d80&&!_0x4d3d80['test'](_0x4c93f5))continue;const _0x6980ba=srcRegex[_0x36a7ee(0x125)](_0x4c93f5),_0x3d076f=integrityRegex[_0x36a7ee(0x125)](_0x4c93f5),_0x2fd03d=_0x6980ba?.[_0x36a7ee(0x19b)]?.[_0x36a7ee(0x169)]??_0x6980ba?.[_0x36a7ee(0x19b)]?.[_0x36a7ee(0x1b8)]??'';if(_0x3d076f){_0x31dbea=_0x3d076f[_0x36a7ee(0x19b)]?.['integrity1']??_0x3d076f[_0x36a7ee(0x19b)]?.[_0x36a7ee(0x121)];if(_0x31dbea){;(_0x6980ba?_0x4df9da[_0x36a7ee(0x140)+_0x293312+_0x36a7ee(0x1e5)]:_0x4df9da['inline'+_0x293312+_0x36a7ee(0x1e5)])['add'](_0x31dbea),_0x390acb[_0x20cfd5]['add'](_0x31dbea);_0x2fd03d&&_0x4df9da[_0x36a7ee(0x16e)][_0x20cfd5][_0x36a7ee(0x1de)](_0x2fd03d,_0x31dbea);continue;}}if(_0x2fd03d){const _0x13e9db=_0x4df9da[_0x36a7ee(0x16e)][_0x20cfd5][_0x36a7ee(0x10e)](_0x2fd03d);if(_0x13e9db)_0x31dbea=_0x13e9db,_0x4df9da[_0x36a7ee(0x140)+_0x293312+'Hashes'][_0x36a7ee(0x123)](_0x31dbea),_0x390acb[_0x20cfd5][_0x36a7ee(0x123)](_0x31dbea);else{let _0x399371;if(_0x2fd03d[_0x36a7ee(0x1b5)]('/')){const _0x111c9c=resolve(_0x72c060,'.'+_0x2fd03d);_0x399371=await _0x41724e['xKYdi'](readFile,_0x111c9c);}else{if(_0x2fd03d['startsWith'](_0x36a7ee(0x172))){_0x30583f=!![];const _0x18b7fe=await fetch(_0x2fd03d,{'method':'GET'});_0x399371=await _0x18b7fe[_0x36a7ee(0x185)]();}else{if(_0x41724e[_0x36a7ee(0x133)](_0x41724e['idLOU'],_0x36a7ee(0x1a7))){if(_0x41724e['MkyyL'](_0x1d57e0[_0x36a7ee(0x12c)],_0x9a1c6b['length']))return![];for(let _0x403e51=0x0;_0x41724e[_0x36a7ee(0x1e1)](_0x403e51,_0x24c000[_0x36a7ee(0x12c)]);_0x403e51++){if(_0x41724e['MkyyL'](_0x4be582[_0x403e51],_0x2d52ec[_0x403e51]))return![];}return!![];}else{_0x5f4b0b[_0x36a7ee(0x1d4)](_0x36a7ee(0x160)+_0x2fd03d+'\x22');continue;}}}_0x31dbea=generateSRIHash(_0x399371),_0x4df9da[_0x36a7ee(0x140)+_0x293312+_0x36a7ee(0x1e5)][_0x36a7ee(0x123)](_0x31dbea),_0x390acb[_0x20cfd5][_0x36a7ee(0x123)](_0x31dbea),_0x4df9da[_0x36a7ee(0x16e)][_0x20cfd5][_0x36a7ee(0x1de)](_0x2fd03d,_0x31dbea);}}}}_0x41724e['UxzRY'](_0x490d2d,!_0x31dbea)&&(!(_0x47a830===![]&&_0x293312===_0x36a7ee(0x1c0))&&!(_0x41724e['swYIl'](_0x5c2710,![])&&_0x41724e['TlUuR'](_0x293312,_0x36a7ee(0x19a)))?_0x41724e[_0x36a7ee(0x1c2)]!==_0x41724e[_0x36a7ee(0x1c2)]?_0xafd6ea['scripts'][_0x48342f]=_0x25f582:(_0x31dbea=_0x41724e[_0x36a7ee(0x111)](generateSRIHash,_0x207d4e),_0x4df9da[_0x36a7ee(0x179)+_0x293312+'Hashes']['add'](_0x31dbea),_0x390acb[_0x20cfd5][_0x36a7ee(0x123)](_0x31dbea)):_0x5f4b0b[_0x36a7ee(0x1d4)](_0x36a7ee(0x194)+_0x293312[_0x36a7ee(0x1a2)]()+'\x20\x22'+_0x1557f3+_0x36a7ee(0x1b2)+_0x20cfd5+'\x20are\x20disabled)')),_0x31dbea&&(_0x920421=_0x920421['replace'](_0x1663be[0x0],_0x3c8240(_0x31dbea,_0x4c93f5,_0x30583f,_0x207d4e)));}}return _0x920421;};export const updateDynamicPageSriHashes=async(_0x35a7d6,_0x693d28,_0x4c54ff,_0x18c800)=>{const _0xaf0640=_0x1b010e,_0x5f32eb={'QOnlt':function(_0xd69f2d,_0x1f6a90){return _0xd69f2d!==_0x1f6a90;},'LZdzW':function(_0x5cc0e0,_0x2fd3c8){return _0x5cc0e0===_0x2fd3c8;},'stwEo':_0xaf0640(0x155),'dHIZm':_0xaf0640(0x165),'LRwsV':_0xaf0640(0x12e),'RrXEl':function(_0x1619e5,_0x1c8b8c){return _0x1619e5>=_0x1c8b8c;},'MnkXV':_0xaf0640(0x172),'eXpIB':_0xaf0640(0x15d),'LlQuf':'GET','kAMYm':'ivHGx','FxUVn':function(_0x444865,_0x581fec){return _0x444865&&_0x581fec;},'EAnGK':_0xaf0640(0x13a),'SarsU':_0xaf0640(0x19a),'qGCOz':function(_0x109d22,_0x46db9f){return _0x109d22(_0x46db9f);},'wxvDu':function(_0x5ca572,_0x1cb0ab){return _0x5ca572!==_0x1cb0ab;},'LfViP':_0xaf0640(0x187)},_0x4c899d=getRegexProcessors();let _0x3c5638=_0x693d28,_0x56c8be;const _0x5be143={'scripts':new Set(),'styles':new Set()};for(const {attrsRegex:_0x436dc8,hasContent:_0x251e15,regex:_0x1af663,replacer:_0x29625d,t:_0x27019b,t2:_0x58d36}of _0x4c899d){if(_0xaf0640(0x10c)!==_0xaf0640(0x19d))while((_0x56c8be=_0x1af663[_0xaf0640(0x125)](_0x693d28))!==null){const _0x15fba2=_0x56c8be[_0xaf0640(0x19b)]?.[_0xaf0640(0x1bd)]??'',_0x232ae8=_0x56c8be['groups']?.['content']??'';let _0x360ef8=undefined,_0x3218d1=![];if(_0x15fba2){if(_0x436dc8&&!_0x436dc8[_0xaf0640(0x1e9)](_0x15fba2))continue;const _0x1322a2=srcRegex[_0xaf0640(0x125)](_0x15fba2),_0x297b2b=integrityRegex[_0xaf0640(0x125)](_0x15fba2),_0x57f7e2=_0x1322a2?.[_0xaf0640(0x19b)]?.['src1']??_0x1322a2?.[_0xaf0640(0x19b)]?.['src2'];if(_0x232ae8&&_0x57f7e2){_0x35a7d6[_0xaf0640(0x1d4)](_0xaf0640(0x1c3)+_0x57f7e2+'\x22');continue;}if(_0x297b2b){_0x360ef8=_0x297b2b['groups']?.[_0xaf0640(0x195)]??_0x297b2b[_0xaf0640(0x19b)]?.[_0xaf0640(0x121)];if(_0x360ef8){if(_0x57f7e2){if(_0x5f32eb[_0xaf0640(0x199)]===_0xaf0640(0x155)){const _0x5e1b21=_0x4c54ff[_0x58d36]['get'](_0x57f7e2);if(_0x5e1b21){if(_0x5e1b21!==_0x360ef8)throw new Error(_0xaf0640(0x14e)+_0x57f7e2+_0xaf0640(0x174)+_0x5e1b21+_0xaf0640(0x1db)+_0x360ef8+'\x22');}else _0x4c54ff[_0x58d36][_0xaf0640(0x1de)](_0x57f7e2,_0x360ef8);}else _0x1293c9[_0x55e60a][_0xaf0640(0x1de)](_0x5b7909,_0x5907fd);}_0x5be143[_0x58d36][_0xaf0640(0x123)](_0x360ef8);}else _0x35a7d6[_0xaf0640(0x1d4)](_0xaf0640(0x147));continue;}if(_0x57f7e2){if(_0x57f7e2[_0xaf0640(0x1b5)]('/')){_0x360ef8=_0x4c54ff[_0x58d36][_0xaf0640(0x10e)](_0x57f7e2);if(_0x360ef8)_0x5f32eb['LZdzW'](_0xaf0640(0x19f),_0x5f32eb['dHIZm'])?_0x2c2738['styles'][_0x26fd10]=_0x1486fa:_0x5be143[_0x58d36][_0xaf0640(0x123)](_0x360ef8);else{!(_0x57f7e2[_0xaf0640(0x1b5)](_0xaf0640(0x146))||_0x57f7e2['startsWith'](_0x5f32eb[_0xaf0640(0x131)])||_0x5f32eb[_0xaf0640(0x1c6)](_0x57f7e2[_0xaf0640(0x1e8)]('?astro&type='),0x0))&&_0x35a7d6[_0xaf0640(0x1d4)](_0xaf0640(0x1da)+_0x57f7e2+'\x22');continue;}}else{if(_0x57f7e2['startsWith'](_0x5f32eb[_0xaf0640(0x190)])){_0x3218d1=!![],_0x360ef8=_0x4c54ff[_0x58d36][_0xaf0640(0x10e)](_0x57f7e2);if(_0x360ef8){if('gnkGD'==='OwSeP'){if(_0x5f32eb['QOnlt'](_0x2dd3ff[_0xaf0640(0x164)][_0x4934df],_0x100fd7))return![];}else _0x5be143[_0x58d36][_0xaf0640(0x123)](_0x360ef8);}else{if(_0x5f32eb[_0xaf0640(0x1dc)]===_0xaf0640(0x15d)){const _0x4e9a11=await fetch(_0x57f7e2,{'method':_0x5f32eb[_0xaf0640(0x14d)]}),_0xb1fdbe=await _0x4e9a11[_0xaf0640(0x185)]();_0x360ef8=generateSRIHash(_0xb1fdbe),_0x4c54ff[_0x58d36][_0xaf0640(0x1de)](_0x57f7e2,_0x360ef8),_0x5be143[_0x58d36][_0xaf0640(0x123)](_0x360ef8);}else _0x2d0ae5[_0xaf0640(0x1d4)]('Skipping\x20SRI\x20hash\x20generation\x20for\x20inline\x20'+_0x183647[_0xaf0640(0x1a2)]()+'\x20(inline\x20'+_0x349a80+'\x20are\x20disabled)');}}else{if(_0x5f32eb[_0xaf0640(0x12a)]!==_0xaf0640(0x138)){_0x35a7d6[_0xaf0640(0x1d4)]('Unable\x20to\x20process\x20external\x20resource:\x20\x22'+_0x57f7e2+'\x22');continue;}else{if(_0x5f32eb[_0xaf0640(0x129)](_0x1558a1,_0x4f48d7))return _0x4bb64c;return;}}}}}if(_0x5f32eb[_0xaf0640(0x176)](_0x251e15,!_0x360ef8)){if((_0x18c800?.[_0xaf0640(0x193)]??_0x5f32eb[_0xaf0640(0x1a0)])===_0x5f32eb[_0xaf0640(0x1a0)]&&_0x5f32eb[_0xaf0640(0x129)](_0x27019b,'Script')||(_0x18c800?.[_0xaf0640(0x16d)]??_0x5f32eb['EAnGK'])===_0x5f32eb['EAnGK']&&_0x27019b===_0x5f32eb[_0xaf0640(0x12d)])_0x360ef8=_0x5f32eb[_0xaf0640(0x181)](generateSRIHash,_0x232ae8),_0x5be143[_0x58d36][_0xaf0640(0x123)](_0x360ef8);else{if(_0x5f32eb[_0xaf0640(0x19c)](_0x5f32eb[_0xaf0640(0x1ac)],_0xaf0640(0x187)))return _0x3cc7fa;else _0x35a7d6[_0xaf0640(0x1d4)](_0xaf0640(0x194)+_0x27019b[_0xaf0640(0x1a2)]()+'\x20(inline\x20'+_0x58d36+_0xaf0640(0x11d));}}_0x360ef8&&(_0x3c5638=_0x3c5638[_0xaf0640(0x117)](_0x56c8be[0x0],_0x29625d(_0x360ef8,_0x15fba2,_0x3218d1,_0x232ae8)));}else _0x14f8a1[_0x57c019]['add'](_0x545c78);}return{'pageHashes':_0x5be143,'updatedContent':_0x3c5638};};const processHTMLFile=async(_0x362643,_0x4cc053,_0x38bf3f,_0x2254f8,_0x2c368f)=>{const _0x5f07b4=_0x1b010e,_0x406fda={'Bccbj':function(_0x6238d4,_0x2c66fc,_0x5068ef){return _0x6238d4(_0x2c66fc,_0x5068ef);},'tmlAC':_0x5f07b4(0x13a),'IiHHR':function(_0x52e520,_0x5d0e91){return _0x52e520!==_0x5d0e91;},'fviaH':_0x5f07b4(0x188),'mczan':_0x5f07b4(0x13f),'XPpTW':function(_0x1f021c,_0x4ae2b8,_0x39bc2a){return _0x1f021c(_0x4ae2b8,_0x39bc2a);}},_0x368151=await _0x406fda[_0x5f07b4(0x112)](readFile,_0x4cc053,_0x5f07b4(0x135)),_0x1158e7=await updateStaticPageSriHashes(_0x362643,_0x38bf3f,_0x406fda['Bccbj'](relative,_0x38bf3f,_0x4cc053),_0x368151,_0x2254f8,_0x2c368f?.[_0x5f07b4(0x193)]??_0x406fda[_0x5f07b4(0x139)],_0x2c368f?.[_0x5f07b4(0x16d)]??_0x406fda['tmlAC']);if(_0x1158e7!==_0x368151){if(_0x406fda[_0x5f07b4(0x1d6)](_0x406fda[_0x5f07b4(0x16f)],_0x406fda[_0x5f07b4(0x168)]))await _0x406fda[_0x5f07b4(0x1b4)](writeFile,_0x4cc053,_0x1158e7);else return![];}};export const arraysEqual=(_0x4a3433,_0xf0cac4)=>{const _0x3bb4ef=_0x1b010e,_0x446297={'fYGyb':function(_0x408bda,_0x255fa3){return _0x408bda(_0x255fa3);},'IKrxL':function(_0x536ddd,_0x2db603){return _0x536ddd!==_0x2db603;},'RvxPA':_0x3bb4ef(0x141),'AcMsa':_0x3bb4ef(0x1df)};if(_0x446297[_0x3bb4ef(0x118)](_0x4a3433[_0x3bb4ef(0x12c)],_0xf0cac4[_0x3bb4ef(0x12c)]))return![];for(let _0x5b042b=0x0;_0x5b042b<_0x4a3433['length'];_0x5b042b++){if(_0x4a3433[_0x5b042b]!==_0xf0cac4[_0x5b042b]){if(_0x446297[_0x3bb4ef(0x18f)]===_0x446297[_0x3bb4ef(0x1ab)])_0x5831d4=_0x446297[_0x3bb4ef(0x1dd)](_0xbdf437,_0x2174e0),_0x233371[_0x25e74d][_0x3bb4ef(0x123)](_0x589676);else return![];}}return!![];};export const pageHashesEqual=(_0x3dbae5,_0x2d1d38)=>{const _0x33b1e5=_0x1b010e,_0x268df5={'rnNuJ':function(_0x3a6f06,_0x4cac33,_0x244ced){return _0x3a6f06(_0x4cac33,_0x244ced);},'vgEby':function(_0x4d18e1,_0x5a726b,_0x233fe9){return _0x4d18e1(_0x5a726b,_0x233fe9);}},_0x23f4a5=Object['keys'](_0x3dbae5)[_0x33b1e5(0x1cc)](),_0x800ba0=Object[_0x33b1e5(0x1b7)](_0x2d1d38)[_0x33b1e5(0x1cc)]();if(!_0x268df5[_0x33b1e5(0x196)](arraysEqual,_0x23f4a5,_0x800ba0))return![];for(const [_0x509efd,_0x4fbe28]of Object['entries'](_0x3dbae5)){const _0x1e7c43=_0x2d1d38[_0x509efd];if(!_0x1e7c43)return![];if(!_0x268df5[_0x33b1e5(0x16c)](arraysEqual,_0x4fbe28['scripts'],_0x1e7c43[_0x33b1e5(0x1e4)])||!_0x268df5[_0x33b1e5(0x196)](arraysEqual,_0x4fbe28[_0x33b1e5(0x164)],_0x1e7c43[_0x33b1e5(0x164)]))return![];}return!![];};export const sriHashesEqual=(_0xed3c64,_0x5854ac)=>{const _0x3a98e1=_0x1b010e,_0x1f4a44={'giwlg':function(_0x5592fc,_0x3c16e5){return _0x5592fc===_0x3c16e5;},'sJFKP':_0x3a98e1(0x1c0),'pDJkg':_0x3a98e1(0x13a),'UoxWx':_0x3a98e1(0x19a),'RKHXF':'igfyf','PLNve':_0x3a98e1(0x1c5)},_0x2fcd8a=Object['keys'](_0xed3c64[_0x3a98e1(0x1e4)])[_0x3a98e1(0x1cc)](),_0x2784b4=Object[_0x3a98e1(0x1b7)](_0x5854ac[_0x3a98e1(0x1e4)])[_0x3a98e1(0x1cc)](),_0x57173b=Object['keys'](_0xed3c64['styles'])[_0x3a98e1(0x1cc)](),_0x173434=Object['keys'](_0x5854ac[_0x3a98e1(0x164)])[_0x3a98e1(0x1cc)]();if(!arraysEqual(_0x2fcd8a,_0x2784b4)||!arraysEqual(_0x57173b,_0x173434))return![];for(const [_0x3e8eb9,_0x4b48f8]of Object[_0x3a98e1(0x18d)](_0xed3c64[_0x3a98e1(0x1e4)])){if('NzBWp'===_0x1f4a44[_0x3a98e1(0x137)])_0x583aa8[_0x3a98e1(0x1d4)](_0x3a98e1(0x182));else{if(_0x5854ac[_0x3a98e1(0x1e4)][_0x3e8eb9]!==_0x4b48f8){if(_0x1f4a44[_0x3a98e1(0x1cf)]===_0x1f4a44[_0x3a98e1(0x1cf)])return![];else _0x1f4a44[_0x3a98e1(0x12b)](_0x31356a?.['allowInlineScripts']??_0x3a98e1(0x13a),'all')&&_0x353888===_0x1f4a44[_0x3a98e1(0x18e)]||(_0x500f2b?.['allowInlineStyles']??_0x1f4a44['pDJkg'])===_0x1f4a44[_0x3a98e1(0x1d2)]&&_0x1f4a44[_0x3a98e1(0x12b)](_0x3a13ad,_0x1f4a44[_0x3a98e1(0x1b1)])?(_0x5eb100=_0xd4e4ab(_0x169588),_0x4b0a34[_0x5c6ccb][_0x3a98e1(0x123)](_0x30ac26)):_0x5c8d81['warn'](_0x3a98e1(0x194)+_0x3914fe[_0x3a98e1(0x1a2)]()+'\x20(inline\x20'+_0x318f1b+_0x3a98e1(0x11d));}}}for(const [_0x5a2bce,_0x495ef2]of Object[_0x3a98e1(0x18d)](_0xed3c64[_0x3a98e1(0x164)])){if(_0x5854ac[_0x3a98e1(0x164)][_0x5a2bce]!==_0x495ef2)return![];}return!![];};export const scanForNestedResources=async(_0x5c537d,_0x307633,_0x3bbe4a)=>{const _0x15cc9d=_0x1b010e,_0x20bd51={'RRSWc':function(_0x1ee4e2,_0x3eb068,_0x10d91e,_0x1e7c03,_0x1dd693){return _0x1ee4e2(_0x3eb068,_0x10d91e,_0x1e7c03,_0x1dd693);},'XRHOT':function(_0x521b94,_0x456f47,_0x36dcbb){return _0x521b94(_0x456f47,_0x36dcbb);},'nmgTt':_0x15cc9d(0x1d8),'oHtXz':function(_0x3d8721,_0x4415b3){return _0x3d8721===_0x4415b3;},'WFsey':function(_0x59e7d3,_0x3a0bd9){return _0x59e7d3(_0x3a0bd9);},'vOAYW':function(_0xb2ade3,_0x206c1a,_0x25d3af,_0x520793,_0x2e06e0,_0x283440,_0x2b2e12){return _0xb2ade3(_0x206c1a,_0x25d3af,_0x520793,_0x2e06e0,_0x283440,_0x2b2e12);}};await _0x20bd51[_0x15cc9d(0x18b)](scanDirectory,_0x5c537d,_0x307633,_0x307633,_0x3bbe4a,async(_0x9d616f,_0x2b49c4,_0x32a526,_0x2744be)=>{const _0xd836c9=_0x15cc9d,_0x36a0d7={'OsAji':function(_0x2d34a5,_0x386144,_0x39e640,_0x5b52f7,_0x507c80){const _0x17c6d5=_0x42f2;return _0x20bd51[_0x17c6d5(0x17a)](_0x2d34a5,_0x386144,_0x39e640,_0x5b52f7,_0x507c80);}},_0x1fa4fd='/'+_0x20bd51[_0xd836c9(0x171)](relative,_0x32a526,_0x2b49c4),_0x550e14=extname(_0x2b49c4);if([_0x20bd51[_0xd836c9(0x1be)],_0xd836c9(0x126)][_0xd836c9(0x14b)](_0x550e14)){if(_0xd836c9(0x145)===_0xd836c9(0x145)){if(!_0x2744be[_0xd836c9(0x16e)][_0xd836c9(0x1e4)][_0xd836c9(0x1ca)](_0x1fa4fd)){const _0x3ee95c=generateSRIHash(await readFile(_0x2b49c4));_0x2744be['extScriptHashes']['add'](_0x3ee95c),_0x2744be['perResourceSriHashes'][_0xd836c9(0x1e4)]['set'](_0x1fa4fd,_0x3ee95c);}}else _0x5d09c4=_0x8806a6[_0xd836c9(0x117)](_0x5cb043[0x0],_0x36a0d7[_0xd836c9(0x173)](_0x508de1,_0x4baa61,_0x57bbb0,_0x3bb0f0,_0x2bf46e));}else{if(_0x20bd51['oHtXz'](_0x550e14,'.css')){if(!_0x2744be[_0xd836c9(0x16e)][_0xd836c9(0x164)][_0xd836c9(0x1ca)](_0x1fa4fd)){const _0x324ed4=_0x20bd51['WFsey'](generateSRIHash,await readFile(_0x2b49c4));_0x2744be[_0xd836c9(0x13b)][_0xd836c9(0x123)](_0x324ed4),_0x2744be['perResourceSriHashes'][_0xd836c9(0x164)][_0xd836c9(0x1de)](_0x1fa4fd,_0x324ed4);}}}},_0x24d4d2=>['.js','.mjs','.css'][_0x15cc9d(0x14b)](extname(_0x24d4d2)));};export async function generateSRIHashesModule(_0x30da7c,_0x424b08,_0x5e958a,_0x15a462){const _0x2b215d=_0x1b010e,_0x3f06f9={'fkdRj':function(_0x5240f7,_0x149f43){return _0x5240f7===_0x149f43;},'fPDmk':_0x2b215d(0x177),'PYvPc':_0x2b215d(0x183),'pHRwp':function(_0x4ff155,_0x2cce93){return _0x4ff155(_0x2cce93);},'GcJng':function(_0x26b3de,_0x26c9dd,_0x520d07){return _0x26b3de(_0x26c9dd,_0x520d07);},'NyCXb':function(_0x2f7317,_0x3cd7e9,_0x31e157){return _0x2f7317(_0x3cd7e9,_0x31e157);},'OOatc':function(_0x2ebf89,_0x4f2481,_0x40b208){return _0x2ebf89(_0x4f2481,_0x40b208);},'NqVhO':_0x2b215d(0x159),'xuoHV':function(_0x53cc69,_0x3e763a){return _0x53cc69>_0x3e763a;},'LroyT':function(_0x4d7daa,_0x2e19f2){return _0x4d7daa>_0x2e19f2;}};let _0x582f81=![],_0x3776e0=![];const _0x20710b=Array[_0x2b215d(0x15a)](_0x424b08['inlineScriptHashes'])[_0x2b215d(0x1cc)](),_0x2741d3=Array[_0x2b215d(0x15a)](_0x424b08['inlineStyleHashes'])[_0x2b215d(0x1cc)](),_0x5b9a2f=Array[_0x2b215d(0x15a)](_0x424b08[_0x2b215d(0x197)])[_0x2b215d(0x1cc)](),_0x5d1164=Array['from'](_0x424b08[_0x2b215d(0x13b)])[_0x2b215d(0x1cc)](),_0x32f1de={};for(const [_0x2a5a6f,_0x2dc71b]of _0x424b08['perPageSriHashes'][_0x2b215d(0x18d)]()){if(_0x3f06f9[_0x2b215d(0x149)](_0x3f06f9[_0x2b215d(0x1cb)],_0x3f06f9[_0x2b215d(0x11c)]))return![];else _0x32f1de[_0x2a5a6f]={'scripts':Array['from'](_0x2dc71b['scripts'])[_0x2b215d(0x1cc)](),'styles':Array[_0x2b215d(0x15a)](_0x2dc71b[_0x2b215d(0x164)])[_0x2b215d(0x1cc)]()};}const _0x429881={'scripts':{},'styles':{}};for(const [_0x3fcf20,_0x3a76eb]of _0x424b08[_0x2b215d(0x16e)]['scripts'][_0x2b215d(0x18d)]()){_0x429881[_0x2b215d(0x1e4)][_0x3fcf20]=_0x3a76eb;}for(const [_0x469384,_0x7eaee2]of _0x424b08['perResourceSriHashes']['styles'][_0x2b215d(0x18d)]()){_0x429881[_0x2b215d(0x164)][_0x469384]=_0x7eaee2;}if(await _0x3f06f9[_0x2b215d(0x167)](doesFileExist,_0x5e958a)){const _0x3d625e=await import(_0x5e958a);_0x582f81=!_0x3f06f9['GcJng'](sriHashesEqual,_0x429881,_0x3d625e[_0x2b215d(0x16e)]??{'scripts':{},'styles':{}}),_0x3776e0=_0x582f81||!arraysEqual(_0x20710b,_0x3d625e[_0x2b215d(0x17c)]??[])||!_0x3f06f9[_0x2b215d(0x11b)](arraysEqual,_0x2741d3,_0x3d625e[_0x2b215d(0x1af)]??[])||!_0x3f06f9[_0x2b215d(0x11b)](arraysEqual,_0x5b9a2f,_0x3d625e[_0x2b215d(0x197)]??[])||!_0x3f06f9[_0x2b215d(0x11e)](arraysEqual,_0x5d1164,_0x3d625e[_0x2b215d(0x13b)]??[])||!_0x3f06f9['OOatc'](pageHashesEqual,_0x32f1de,_0x3d625e[_0x2b215d(0x161)]??{});}else _0x2b215d(0x159)!==_0x3f06f9[_0x2b215d(0x1a8)]?_0x3529e0[_0x2b215d(0x14f)](_0x368c9c):_0x3776e0=!![];if(_0x3776e0){_0x582f81&&_0x15a462&&_0x30da7c[_0x2b215d(0x1d4)]('SRI\x20hashes\x20have\x20changed\x20for\x20static\x20resources\x20that\x20may\x20be\x20used\x20in\x20dynamic\x20pages.\x20You\x20should\x20run\x20the\x20build\x20step\x20again');let _0x23e570=_0x2b215d(0x15f);_0x23e570+=_0x2b215d(0x17e)+_0x20710b[_0x2b215d(0x1c9)](_0x33cfb0=>_0x2b215d(0x1a3)+_0x33cfb0+'\x27,')[_0x2b215d(0x1c1)]('')+(_0x3f06f9[_0x2b215d(0x16b)](_0x20710b[_0x2b215d(0x12c)],0x0)?'\x0a':'')+_0x2b215d(0x134),_0x23e570+=_0x2b215d(0x109)+_0x2741d3[_0x2b215d(0x1c9)](_0xe996a9=>_0x2b215d(0x1a3)+_0xe996a9+'\x27,')[_0x2b215d(0x1c1)]('')+(_0x3f06f9[_0x2b215d(0x119)](_0x2741d3[_0x2b215d(0x12c)],0x0)?'\x0a':'')+_0x2b215d(0x134),_0x23e570+=_0x2b215d(0x122)+_0x5b9a2f['map'](_0x23d121=>_0x2b215d(0x1a3)+_0x23d121+'\x27,')['join']('')+(_0x5b9a2f[_0x2b215d(0x12c)]>0x0?'\x0a':'')+_0x2b215d(0x134),_0x23e570+=_0x2b215d(0x19e)+_0x5d1164[_0x2b215d(0x1c9)](_0x4bc12f=>_0x2b215d(0x1a3)+_0x4bc12f+'\x27,')[_0x2b215d(0x1c1)]('')+(_0x5d1164[_0x2b215d(0x12c)]>0x0?'\x0a':'')+_0x2b215d(0x134),_0x23e570+=_0x2b215d(0x158)+Object[_0x2b215d(0x18d)](_0x32f1de)[_0x2b215d(0x1cc)]()[_0x2b215d(0x1c9)](([_0x881844,_0x21668f])=>_0x2b215d(0x154)+_0x881844+_0x2b215d(0x151)+_0x21668f[_0x2b215d(0x1e4)]['map'](_0x49de4c=>_0x2b215d(0x1ea)+_0x49de4c+'\x27,')['join']('')+(_0x21668f['scripts']['length']>0x0?_0x2b215d(0x1ec):'')+_0x2b215d(0x1a5)+_0x21668f[_0x2b215d(0x164)][_0x2b215d(0x1c9)](_0x5679e1=>_0x2b215d(0x1ea)+_0x5679e1+'\x27,')[_0x2b215d(0x1c1)]('')+(_0x21668f[_0x2b215d(0x164)][_0x2b215d(0x12c)]>0x0?'\x0a\x09\x09\x09':'')+'],\x0a\x09\x09}')[_0x2b215d(0x1c1)](',')+_0x2b215d(0x142),_0x23e570+=_0x2b215d(0x1e7)+Object[_0x2b215d(0x18d)](_0x429881[_0x2b215d(0x1e4)])['map'](([_0x26bfe4,_0x347b5d])=>'\x09\x09\x27'+_0x26bfe4+_0x2b215d(0x11a)+_0x347b5d+_0x2b215d(0x1ae))[_0x2b215d(0x1c1)]('')+_0x2b215d(0x124)+Object[_0x2b215d(0x18d)](_0x429881[_0x2b215d(0x164)])[_0x2b215d(0x1c9)](([_0x22b6b4,_0x407847])=>_0x2b215d(0x10f)+_0x22b6b4+_0x2b215d(0x11a)+_0x407847+_0x2b215d(0x1ae))[_0x2b215d(0x1c1)]('')+_0x2b215d(0x166),await mkdir(_0x3f06f9[_0x2b215d(0x167)](dirname,_0x5e958a),{'recursive':!![]}),await writeFile(_0x5e958a,_0x23e570);}}export const processStaticFiles=async(_0x348dfc,{distDir:_0x2e8a0e,sri:_0x11a484})=>{const _0x7e318c=_0x1b010e,_0x37e7c5={'tKdkq':function(_0x22e6d7,_0x390c5f,_0x1833d2,_0x2a0cf3,_0x1c2de9,_0x118d8c,_0x489ac1,_0x49dee0){return _0x22e6d7(_0x390c5f,_0x1833d2,_0x2a0cf3,_0x1c2de9,_0x118d8c,_0x489ac1,_0x49dee0);},'tGyle':function(_0x48a7b7,_0x4409a3,_0x46016e,_0x2b09c8){return _0x48a7b7(_0x4409a3,_0x46016e,_0x2b09c8);},'ccQHE':_0x7e318c(0x178),'SXEXr':function(_0x56771d,_0x3f0d22,_0xd7c544,_0x9e9dde,_0x4a5cd9){return _0x56771d(_0x3f0d22,_0xd7c544,_0x9e9dde,_0x4a5cd9);}},_0x32e18e={'inlineScriptHashes':new Set(),'inlineStyleHashes':new Set(),'extScriptHashes':new Set(),'extStyleHashes':new Set(),'perPageSriHashes':new Map(),'perResourceSriHashes':{'scripts':new Map(),'styles':new Map()}};await _0x37e7c5[_0x7e318c(0x1e6)](scanDirectory,_0x348dfc,_0x2e8a0e,_0x2e8a0e,_0x32e18e,processHTMLFile,_0x64bd8e=>extname(_0x64bd8e)===_0x7e318c(0x1a9),_0x11a484),await _0x37e7c5[_0x7e318c(0x1ad)](scanForNestedResources,_0x348dfc,_0x2e8a0e,_0x32e18e);if(!_0x11a484[_0x7e318c(0x144)]){if(_0x7e318c(0x1cd)===_0x37e7c5[_0x7e318c(0x1d3)])return[{'t':_0x7e318c(0x1c0),'t2':_0x7e318c(0x1e4),'regex':/<script(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*script\s*>/gi,'replacer':_0x2980d1,'hasContent':!![],'attrsRegex':_0x33e854},{'t':_0x7e318c(0x19a),'t2':_0x7e318c(0x164),'regex':/<style(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*style\s*>/gi,'replacer':_0x160b75,'hasContent':!![],'attrsRegex':_0x3fd0ea},{'t':_0x7e318c(0x19a),'t2':'styles','regex':/<link(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*\/?>/gi,'replacer':_0x4c8fb9,'hasContent':![],'attrsRegex':_0x451646}];else return;}await _0x37e7c5[_0x7e318c(0x1b9)](generateSRIHashesModule,_0x348dfc,_0x32e18e,_0x11a484['hashesModule'],_0x11a484['enableMiddleware']);};function _0x28f8(){const _0xa0e1e=['indexOf','test','\x0a\x09\x09\x09\x09\x27','headers','\x0a\x09\x09\x09','wTowN','export\x20const\x20inlineStyleHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','UyOdC','HXRdc','kXISJ','4008fuHKis','get','\x09\x09\x27','228288CEViDv','CVPAQ','Bccbj','yAhYp','ZcIpE','dpOdn','15094XeVVUe','replace','IKrxL','LroyT','\x27:\x20\x27','GcJng','PYvPc','\x20are\x20disabled)','NyCXb','59770ZZJDbY','iLlKy','integrity2','export\x20const\x20extScriptHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','add','\x09}),\x0a\x09styles:\x20/**\x20@type\x20{Record<string,string>}\x20*/\x20({\x0a','exec','.mjs','gtrQv','zAUzm','LZdzW','kAMYm','giwlg','length','SarsU','/@fs/','44ooaCtB','\x22\x20did\x20not\x20exist\x20at\x20build\x20time.\x20You\x20may\x20have\x20to\x20run\x20the\x20build\x20step\x20again','LRwsV','HBYHw','JuvYj','])\x0a\x0a','utf8','content','RKHXF','PJTLE','tmlAC','all','extStyleHashes','sAOhW',')\x0a})()\x0a','85266sPyQeB','FBOSR','ext','AmLbT','}\x0a)\x0a\x0a','\x20crossorigin=\x22anonymous\x22','hashesModule','uoAxt','/@vite/','Found\x20empty\x20integrity\x20attribute,\x20skipping...','zNrUn','fkdRj','enableStatic','includes','HVUjO','LlQuf','SRI\x20hash\x20mismatch\x20for\x20\x22','update','IcQhV','\x27:\x20{\x0a\x09\x09\x09scripts:\x20[','Rfzfu','naHWJ','\x0a\x09\x09\x27','wGSFN','<link','btdAs','export\x20const\x20perPageSriHashes\x20=\x0a\x09/**\x20@type\x20{Record<string,\x20{\x20scripts:\x20string[];\x20styles:\x20string\x20[]\x20}>}\x20*/\x20({','QzqEh','from','TQeBw','publicDir','yBBjv','ixUdG','//\x20Do\x20not\x20edit\x20this\x20file\x20manually\x0a\x0a','Unable\x20to\x20process\x20external\x20resource:\x20\x22','perPageSriHashes','ZOqGP','status','styles','zLvXM','\x09}),\x0a}\x0a','pHRwp','mczan','src1','post','xuoHV','vgEby','allowInlineStyles','perResourceSriHashes','fviaH','</script>','XRHOT','http','OsAji','\x22,\x20expected\x20\x22','\x0aimport\x20{\x20defineMiddleware\x20}\x20from\x20\x27astro/middleware\x27\x0aimport\x20{\x20getGlobalHashes\x20}\x20from\x20\x27@kindspells/astro-shield/state\x27\x0aimport\x20{\x20','FxUVn','WDwnC','vLogT','inline','RRSWc','base64','inlineScriptHashes','digest','export\x20const\x20inlineScriptHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','MkyyL','\x20integrity=\x22','qGCOz','SRI\x20hashes\x20have\x20changed\x20for\x20static\x20resources\x20that\x20may\x20be\x20used\x20in\x20dynamic\x20pages.\x20You\x20should\x20run\x20the\x20build\x20step\x20again','GUBfv','\x0a\x0aexport\x20const\x20onRequest\x20=\x20await\x20(async\x20()\x20=>\x20{\x0a\x09const\x20globalHashes\x20=\x20await\x20getGlobalHashes()\x0a\x0a\x09','arrayBuffer','flGkJ','wCBfD','ZwVmr','950Gnccca','mlZqP','vOAYW','import\x20{\x20perResourceSriHashes\x20}\x20from\x20\x27','entries','sJFKP','RvxPA','MnkXV','sha256-','The\x20SRI\x20hashes\x20module\x20\x22','allowInlineScripts','Skipping\x20SRI\x20hash\x20generation\x20for\x20inline\x20','integrity1','rnNuJ','extScriptHashes','virtual:@kindspells/astro-shield/middleware','stwEo','Style','groups','wxvDu','wYdki','export\x20const\x20extStyleHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','xcgKm','EAnGK','2098068xUtzXw','toLowerCase','\x0a\x09\x27','statusText','],\x0a\x09\x09\x09styles:\x20[','WJLGW','PWqIR','NqVhO','.html','\x0atry\x20{\x0a\x09if\x20(perResourceSriHashes)\x20{\x0a\x09\x09for\x20(const\x20[key,\x20value]\x20of\x20Object.entries(\x0a\x09\x09\x09perResourceSriHashes.scripts\x20??\x20{},\x0a\x09\x09))\x20{\x0a\x09\x09\x09globalHashes.scripts.set(key,\x20value)\x0a\x09\x09}\x0a\x09\x09for\x20(const\x20[key,\x20value]\x20of\x20Object.entries(\x0a\x09\x09\x09perResourceSriHashes.styles\x20??\x20{},\x0a\x09\x09))\x20{\x0a\x09\x09\x09globalHashes.styles.set(key,\x20value)\x0a\x09\x09}\x0a\x09}\x0a}\x20catch\x20(err)\x20{\x0a\x09console.error(\x27Failed\x20to\x20load\x20static\x20hashes\x20module:\x27,\x20err)\x0a}\x0a','AcMsa','LfViP','tGyle','\x27,\x0a','inlineStyleHashes','513NSrcvB','UoxWx','\x22\x20(inline\x20','stringify','XPpTW','startsWith','39gmHqiE','keys','src2','SXEXr','PMDRi','ijzGK','mRTuc','attrs','nmgTt','SoFfx','Script','join','ujWpu','scripts\x20must\x20have\x20either\x20a\x20src\x20attribute\x20or\x20content,\x20but\x20not\x20both\x20\x22','getMiddlewareHandler','XHwhi','RrXEl','<script','getMiddlewareHandler(globalHashes)','map','has','fPDmk','sort','lPjok','text','PLNve','6dCiKLC','getCSPMiddlewareHandler','pDJkg','ccQHE','warn','IkohT','IiHHR','getCSPMiddlewareHandler(globalHashes,\x20','.js','PGZxP','Unable\x20to\x20obtain\x20SRI\x20hash\x20for\x20local\x20resource:\x20\x22','\x22\x20but\x20got\x20\x22','eXpIB','fYGyb','set','YmrQk','MmjTZ','FUwWm','145344zUEsQo','\x20}\x20from\x20\x27@kindspells/astro-shield/core\x27\x0a','scripts','Hashes','tKdkq','export\x20const\x20perResourceSriHashes\x20=\x20{\x0a\x09scripts:\x20/**\x20@type\x20{Record<string,string>}\x20*/\x20({\x0a'];_0x28f8=function(){return _0xa0e1e;};return _0x28f8();}export const getMiddlewareHandler=_0x42a452=>{const _0x8ff5f0=_0x1b010e,_0x5ba6df={'ijzGK':_0x8ff5f0(0x18a),'zAUzm':function(_0xb36ee6){return _0xb36ee6();},'gtrQv':function(_0x46d4e3,_0x4a11f5,_0x2d765f,_0x324359){return _0x46d4e3(_0x4a11f5,_0x2d765f,_0x324359);}};return async(_0x7a950c,_0x1505f6)=>{const _0x19956f=_0x8ff5f0;if(_0x19956f(0x132)===_0x5ba6df[_0x19956f(0x1bb)])throw new _0x1a9a44('SRI\x20hash\x20mismatch\x20for\x20\x22'+_0x22a03f+'\x22,\x20expected\x20\x22'+_0x4a90be+_0x19956f(0x1db)+_0x13f89d+'\x22');else{const _0x17feac=await _0x5ba6df[_0x19956f(0x128)](_0x1505f6),_0x3084b3=await _0x17feac['text'](),{updatedContent:_0x225fea}=await _0x5ba6df[_0x19956f(0x127)](updateDynamicPageSriHashes,console,_0x3084b3,_0x42a452),_0xa93819=new Response(_0x225fea,{'status':_0x17feac[_0x19956f(0x163)],'statusText':_0x17feac['statusText'],'headers':_0x17feac[_0x19956f(0x1eb)]});return _0xa93819;}};};export const getCSPMiddlewareHandler=(_0x54f26d,_0x12f239)=>{const _0x5e7b9c={'sAOhW':function(_0x256f66){return _0x256f66();},'IkohT':function(_0x8b3f6c,_0x18ffef,_0x37e30f,_0x4bfe20){return _0x8b3f6c(_0x18ffef,_0x37e30f,_0x4bfe20);}};return async(_0x127ed1,_0x3fbf7d)=>{const _0x146d83=_0x42f2,_0x13d3a7=await _0x5e7b9c[_0x146d83(0x13c)](_0x3fbf7d),_0x2e7f3b=await _0x13d3a7[_0x146d83(0x1ce)](),{updatedContent:_0x195011,pageHashes:_0x282c78}=await updateDynamicPageSriHashes(console,_0x2e7f3b,_0x54f26d),_0x3fb82a=new Response(_0x195011,{'status':_0x13d3a7['status'],'statusText':_0x13d3a7[_0x146d83(0x1a4)],'headers':_0x5e7b9c[_0x146d83(0x1d5)](patchHeaders,_0x13d3a7[_0x146d83(0x1eb)],_0x282c78,_0x12f239)});return _0x3fb82a;};};const middlewareVirtualModuleId=_0x1b010e(0x198),resolvedMiddlewareVirtualModuleId='\x00'+middlewareVirtualModuleId,loadVirtualMiddlewareModule=async(_0xff05c5,_0x5ddc38,_0x1a118a,_0x2c6355)=>{const _0x1ba2f2=_0x1b010e,_0x5869a7={'wTowN':function(_0x51d0c3,_0x2f50a9){return _0x51d0c3===_0x2f50a9;},'PGZxP':'UyOdC','zNrUn':_0x1ba2f2(0x1d1),'PMDRi':_0x1ba2f2(0x1c4),'ixUdG':function(_0x31ffc1,_0x560262){return _0x31ffc1!==_0x560262;},'ZcIpE':_0x1ba2f2(0x1c8)};let _0x528b91='',_0x15d6ab='';if(_0x5ddc38[_0x1ba2f2(0x14a)]&&_0x5ddc38[_0x1ba2f2(0x144)]&&!await doesFileExist(_0x5ddc38[_0x1ba2f2(0x144)])){const _0x353d1a={'inlineScriptHashes':new Set(),'inlineStyleHashes':new Set(),'extScriptHashes':new Set(),'extStyleHashes':new Set(),'perPageSriHashes':new Map(),'perResourceSriHashes':{'scripts':new Map(),'styles':new Map()}};await scanForNestedResources(_0xff05c5,_0x2c6355,_0x353d1a),await generateSRIHashesModule(_0xff05c5,_0x353d1a,_0x5ddc38['hashesModule'],![]);}if(_0x5ddc38[_0x1ba2f2(0x14a)]&&_0x5ddc38['hashesModule']&&await doesFileExist(_0x5ddc38[_0x1ba2f2(0x144)]))_0x528b91=_0x1ba2f2(0x18c)+_0x5ddc38['hashesModule']+'\x27',_0x15d6ab=_0x1ba2f2(0x1aa);else _0x5ddc38[_0x1ba2f2(0x14a)]&&_0x5ddc38[_0x1ba2f2(0x144)]&&(_0x5869a7[_0x1ba2f2(0x1ed)](_0x1ba2f2(0x10a),_0x5869a7[_0x1ba2f2(0x1d9)])?_0xff05c5[_0x1ba2f2(0x1d4)](_0x1ba2f2(0x192)+_0x5ddc38[_0x1ba2f2(0x144)]+_0x1ba2f2(0x130)):_0x329311['perResourceSriHashes'][_0x201378][_0x1ba2f2(0x1de)](_0x265b1c,_0x55a2ae));return _0x1ba2f2(0x175)+(_0x1a118a!==undefined?_0x5869a7[_0x1ba2f2(0x148)]:_0x5869a7[_0x1ba2f2(0x1ba)])+_0x1ba2f2(0x1e3)+_0x528b91+_0x1ba2f2(0x184)+_0x15d6ab+'\x0a\x0a\x09return\x20defineMiddleware('+(_0x5869a7[_0x1ba2f2(0x15e)](_0x1a118a,undefined)?_0x1ba2f2(0x1d7)+JSON[_0x1ba2f2(0x1b3)](_0x1a118a)+')':_0x5869a7[_0x1ba2f2(0x114)])+_0x1ba2f2(0x13d);},getViteMiddlewarePlugin=(_0x4c9d1a,_0x55cdc5,_0x40bcb5,_0x387415)=>{const _0x4d6057={'MmjTZ':function(_0x48b51b,_0x3df2e7,_0x3ba980,_0x171574,_0x180b93){return _0x48b51b(_0x3df2e7,_0x3ba980,_0x171574,_0x180b93);}};return{'name':'vite-plugin-astro-shield','resolveId'(_0x3d05a3){if(_0x3d05a3===middlewareVirtualModuleId)return resolvedMiddlewareVirtualModuleId;return;},async 'load'(_0x54599f,_0x219113){const _0x485433=_0x42f2;switch(_0x54599f){case resolvedMiddlewareVirtualModuleId:return await _0x4d6057[_0x485433(0x1e0)](loadVirtualMiddlewareModule,_0x4c9d1a,_0x55cdc5,_0x40bcb5,_0x387415);default:return;}}};};export const getAstroConfigSetup=(_0x140e84,_0x8134a7)=>{const _0x336fcf=_0x1b010e,_0x36cd4b={'btdAs':function(_0x28537c,_0x17370f){return _0x28537c===_0x17370f;},'dpOdn':_0x336fcf(0x162),'WJLGW':_0x336fcf(0x14c),'yAhYp':function(_0x298ff5,_0x17edaa){return _0x298ff5(_0x17edaa);},'SoFfx':function(_0x43de59,_0x1502ee,_0x1f8a13,_0x1e1610,_0x5008c6){return _0x43de59(_0x1502ee,_0x1f8a13,_0x1e1610,_0x5008c6);}};return async({logger:_0x1f9031,addMiddleware:_0x16c470,config:_0x26a6a2,updateConfig:_0x32f3a1})=>{const _0x4835b0=_0x336fcf;if(_0x36cd4b[_0x4835b0(0x157)](_0x36cd4b[_0x4835b0(0x115)],_0x36cd4b[_0x4835b0(0x1a6)]))_0x40c2bf=_0x4835b0(0x18c)+_0x1153bb['hashesModule']+'\x27',_0x4e2ecd=_0x4835b0(0x1aa);else{const _0x5e0216=_0x36cd4b[_0x4835b0(0x113)](fileURLToPath,_0x26a6a2[_0x4835b0(0x15c)]),_0x1deda7=_0x36cd4b[_0x4835b0(0x1bf)](getViteMiddlewarePlugin,_0x1f9031,_0x140e84,_0x8134a7,_0x5e0216);_0x32f3a1({'vite':{'plugins':[_0x1deda7]}}),_0x16c470({'order':_0x4835b0(0x16a),'entrypoint':_0x4835b0(0x198)});}};};