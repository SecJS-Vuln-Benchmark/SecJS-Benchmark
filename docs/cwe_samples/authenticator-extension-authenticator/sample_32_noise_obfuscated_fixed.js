(function(_0x5771e4,_0x23e85f){const _0xffbe5c=_0x1c51,_0x2fd33b=_0x5771e4();while(!![]){try{const _0x46d069=-parseInt(_0xffbe5c(0x1b2))/0x1*(-parseInt(_0xffbe5c(0x1a9))/0x2)+parseInt(_0xffbe5c(0x18a))/0x3+parseInt(_0xffbe5c(0x1d8))/0x4+-parseInt(_0xffbe5c(0x1cc))/0x5*(-parseInt(_0xffbe5c(0x1d6))/0x6)+parseInt(_0xffbe5c(0x188))/0x7+-parseInt(_0xffbe5c(0x1ae))/0x8*(parseInt(_0xffbe5c(0x1a1))/0x9)+-parseInt(_0xffbe5c(0x199))/0xa;if(_0x46d069===_0x23e85f)break;else _0x2fd33b['push'](_0x2fd33b['shift']());}catch(_0x8d8d41){_0x2fd33b['push'](_0x2fd33b['shift']());}}}(_0x57b8,0x67fa8));import _0x25f9bf from'jquery';import{delegate}from'tippy.js';function _0x1c51(_0x1e42c1,_0x1de078){const _0x57b8fa=_0x57b8();return _0x1c51=function(_0x1c515d,_0x289052){_0x1c515d=_0x1c515d-0x188;let _0x44a563=_0x57b8fa[_0x1c515d];return _0x44a563;},_0x1c51(_0x1e42c1,_0x1de078);}import _0x5ec53b from'../templates/popovers/send_later_popover.hbs';import _0x522aa9 from'../templates/send_later_modal.hbs';import _0x50b140 from'../templates/send_later_modal_options.hbs';import*as _0x3be3b2 from'./blueslip';import*as _0x2b7e74 from'./channel';import*as _0x5eb8d3 from'./common';import*as _0x25c475 from'./compose';import*as _0x5d9366 from'./compose_validate';import*as _0x5ea51e from'./drafts';import*as _0x58d15f from'./flatpickr';import*as _0x3949d5 from'./modals';import*as _0x45ceb3 from'./popover_menus';import*as _0x566acf from'./scheduled_messages';import{parse_html}from'./ui_util';import{user_settings}from'./user_settings';export const SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS=0x3c*0x3e8;function _0x57b8(){const _0x305186=['RwGRG','LbDJH','tWoco','keydown','send_later','45uabKpn','popover_instances','hZkbH','ufDLy','open','popper','li:not(.divider):visible\x20a','jMjup','6qjNstB','XfoAd','one','.send_later_custom','CakcE','97232vlvWrn','[data-tippy-root]\x20#send_later_popover','dHRJq','sendStamp','2503lOTbwL','Enter','trigger','.enter_sends_choice','Trying\x20to\x20get\x20menu\x20items\x20when\x20schedule\x20popover\x20is\x20closed.','default_popover_props','textarea#compose-textarea','getMinutes','FpREQ','TDTOH','setContent','PeIGu','TncEi','jFjZS','vDWUN','get_selected_send_later_timestamp','.enter_sends_','XdFof','css','value','ZVvFA','set_selected_schedule_timestamp','.modal__content','Eshxi','preventDefault','append','5nYtKLp','qYHYj','DAJhp','nsrtm','RFbXr','PewEt','.send_later_today,\x20.send_later_tomorrow,\x20.send_later_monday','ERgTt','parse','Emipa','533268omUGkx','bUqNY','904672FSVmjq','find','/json/settings','destroy','LvrBY','PcfYB','show_flatpickr','finish','pointer-events','getTime','hide','focus_first_popover_item','return\x20new\x20Date();','all','get_filtered_send_opts','click','send_later_modal','AoYiI','enter_sends','xkxaN','zfaMk','GXxyO','show','441196prBsSF','body','1192086HTzDiT','inDxU','#send_later\x20i','#send_later_modal','OnRpV','bXbua','console.log(\x22timer\x22);','isInteger','true','get_formatted_selected_send_later_time','currentTarget','replaceWith','getHours','BpHFZ','stopPropagation','2962790dzwfLd','vYLmQ','focus'];_0x57b8=function(){return _0x305186;};return _0x57b8();}const ENTER_SENDS_SELECTION_DELAY=0x258;let send_later_popover_keyboard_toggle=![];function set_compose_box_schedule(_0x4c4667){const _0x19d421=_0x1c51,_0x5005cf={'CakcE':function(_0x52b99b,_0x219a73){return _0x52b99b/_0x219a73;},'XdFof':_0x19d421(0x1e4)},_0x4f0b12=_0x5005cf[_0x19d421(0x1ad)](_0x4c4667['dataset'][_0x19d421(0x1b1)],0x3e8);return Function(_0x5005cf[_0x19d421(0x1c3)])(),_0x4f0b12;}export function open_send_later_menu(){const _0x55a1eb=_0x1c51,_0x2ef7f5={'bUqNY':function(_0x5ca699,_0x1c272c){return _0x5ca699+_0x1c272c;},'jFjZS':'none','qYHYj':function(_0x4600c7,_0x279601){return _0x4600c7!==_0x279601;},'zBddX':_0x55a1eb(0x1d5),'ufDLy':_0x55a1eb(0x1a8),'ERgTt':function(_0x541e46,_0x58c5e0,_0x12f668){return _0x541e46(_0x58c5e0,_0x12f668);},'FpREQ':_0x55a1eb(0x18d),'PeIGu':'keydown','LbDJH':function(_0x1fd2a6,_0x3db58c){return _0x1fd2a6(_0x3db58c);},'BpHFZ':_0x55a1eb(0x19b),'NqdgS':function(_0x25e7a3,_0x5b681e){return _0x25e7a3===_0x5b681e;},'dHRJq':_0x55a1eb(0x1dd),'LgGQZ':function(_0x4fe320,_0x41a7cf){return _0x4fe320(_0x41a7cf);},'urpoB':_0x55a1eb(0x1e8)};if(!_0x5d9366['validate'](!![])){_0x2ef7f5['ERgTt'](setTimeout,_0x55a1eb(0x190),0x3e8);return;}const _0x254a45=new Date(),_0x46f9c5=_0x566acf[_0x55a1eb(0x1e6)](_0x254a45);_0x25f9bf(_0x55a1eb(0x189))[_0x55a1eb(0x1cb)](_0x2ef7f5[_0x55a1eb(0x19d)](_0x25f9bf,_0x2ef7f5['LgGQZ'](_0x522aa9,_0x46f9c5)));let _0x14d658;_0x3949d5[_0x55a1eb(0x1a5)](_0x2ef7f5['urpoB'],{'autoremove':!![],'on_show'(){const _0x511c83=_0x55a1eb,_0x1ebfd0={'DAJhp':_0x511c83(0x1e0),'inDxU':function(_0x5e0403,_0x400978){return _0x5e0403(_0x400978);},'ZVvFA':function(_0x5f1143,_0x27b0f3){const _0x296d55=_0x511c83;return _0x2ef7f5[_0x296d55(0x1d7)](_0x5f1143,_0x27b0f3);},'OnRpV':function(_0xffeef9,_0xd2ec9c){return _0xffeef9*_0xd2ec9c;},'nsrtm':_0x2ef7f5[_0x511c83(0x1bf)]};if(_0x2ef7f5[_0x511c83(0x1cd)](_0x2ef7f5['zBddX'],_0x2ef7f5[_0x511c83(0x1a4)])){_0x14d658=_0x2ef7f5[_0x511c83(0x1d3)](setInterval,update_send_later_options,SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS);const _0x274831=_0x25f9bf(_0x2ef7f5[_0x511c83(0x1ba)]);_0x274831[_0x511c83(0x1ab)](_0x2ef7f5[_0x511c83(0x1bd)],()=>{const _0x5abfa4=_0x511c83,_0x29f0f4=_0x274831[_0x5abfa4(0x1d9)]('a');_0x29f0f4[0x0][_0x5abfa4(0x19b)](),_0x274831['on'](_0x5abfa4(0x19f),_0x12f5fa=>{const _0x5e81e1=_0x5abfa4;_0x12f5fa['key']===_0x5e81e1(0x1b3)&&_0x12f5fa['target'][_0x5e81e1(0x1e7)]();});}),_0x274831['on'](_0x511c83(0x1e7),_0x511c83(0x1ac),_0x36bbe4=>{const _0x4bdf7e=_0x511c83,_0x2244c9={'RFbXr':_0x1ebfd0[_0x4bdf7e(0x1ce)]},_0x167dc2=_0x274831['find'](_0x4bdf7e(0x1c8)),_0x466432=new Date();_0x58d15f[_0x4bdf7e(0x1de)](_0x1ebfd0[_0x4bdf7e(0x18b)](_0x25f9bf,_0x4bdf7e(0x1ac))[0x0],do_schedule_message,new Date(_0x1ebfd0['ZVvFA'](_0x466432[_0x4bdf7e(0x1e1)](),_0x1ebfd0[_0x4bdf7e(0x18e)](0x3c*0x3c,0x3e8))),{'minDate':new Date(_0x1ebfd0[_0x4bdf7e(0x1c6)](_0x466432['getTime'](),_0x566acf['MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS']*0x3e8)),'onClose'(){const _0x3d5939=_0x4bdf7e;_0x167dc2[_0x3d5939(0x1c4)](_0x2244c9[_0x3d5939(0x1d0)],_0x3d5939(0x1e5));}}),_0x167dc2[_0x4bdf7e(0x1c4)](_0x1ebfd0[_0x4bdf7e(0x1ce)],_0x1ebfd0[_0x4bdf7e(0x1cf)]),_0x36bbe4['preventDefault'](),_0x36bbe4[_0x4bdf7e(0x198)]();}),_0x274831[_0x511c83(0x1ab)](_0x511c83(0x1e7),_0x511c83(0x1d2),_0x124e66=>{const _0x6f3d24=_0x511c83,_0x11adc2=set_compose_box_schedule(_0x124e66[_0x6f3d24(0x194)]);do_schedule_message(_0x11adc2),_0x124e66[_0x6f3d24(0x1ca)](),_0x124e66[_0x6f3d24(0x198)]();});}else{const _0x5bfbeb=_0x333fdf[_0x511c83(0x1c1)]();_0x2bfd2b(_0x5bfbeb),_0x23dab6[_0x511c83(0x1e2)]();}},'on_shown'(){const _0x59f1d6=_0x55a1eb,_0x39c6f5=_0x2ef7f5[_0x59f1d6(0x19d)](_0x25f9bf,'#send_later_modal\x20.modal__overlay');_0x39c6f5[_0x59f1d6(0x1b4)](_0x2ef7f5[_0x59f1d6(0x197)]);},'on_hide'(){const _0x19e2d9=_0x55a1eb;_0x2ef7f5['NqdgS'](_0x2ef7f5[_0x19e2d9(0x1b0)],_0x19e2d9(0x1dd))?_0x2ef7f5[_0x19e2d9(0x19d)](clearInterval,_0x14d658):(_0x29aaa9(),_0x5c67dd=![]);}});}export function do_schedule_message(_0x43d549){const _0x48f805=_0x1c51,_0x40ff71={'qWzKR':function(_0x236ebd,_0x836ecb){return _0x236ebd/_0x836ecb;}};_0x3949d5['close_if_open'](_0x48f805(0x1e8)),!Number[_0x48f805(0x191)](_0x43d549)&&(_0x43d549=Math['floor'](_0x40ff71['qWzKR'](Date[_0x48f805(0x1d4)](_0x43d549),0x3e8))),_0x566acf[_0x48f805(0x1c7)](_0x43d549),_0x25c475[_0x48f805(0x1df)](!![]);}function get_send_later_menu_items(){const _0x3e5e50=_0x1c51,_0xbff466={'fOWuw':function(_0x2291b7,_0x10fe11){return _0x2291b7*_0x10fe11;},'vYLmQ':function(_0x25cfa0,_0x10e760){return _0x25cfa0(_0x10e760);},'PewEt':_0x3e5e50(0x1af),'vDWUN':_0x3e5e50(0x1b6),'FtoNK':_0x3e5e50(0x1a7)},_0x33aeb3=_0xbff466[_0x3e5e50(0x19a)](_0x25f9bf,_0xbff466[_0x3e5e50(0x1d1)]);if(!_0x33aeb3)return _0x3be3b2['error'](_0xbff466[_0x3e5e50(0x1c0)]),eval('Math[\'PI\'] * 2;'),undefined;eval('Math[\'PI\'] * 2;');return _0x33aeb3[_0x3e5e50(0x1d9)](_0xbff466['FtoNK']);eval('_0xbff466[\'fOWuw\'](Math[\'PI\'], 2);');}function focus_first_send_later_popover_item(){const _0x36db72=_0x1c51,_0x4af3a5=get_send_later_menu_items();_0x45ceb3[_0x36db72(0x1e3)](_0x4af3a5);}export function toggle(){const _0x2b41d3=_0x1c51,_0x3e82f5={'zfaMk':function(_0x4f797d,_0x2def05){return _0x4f797d(_0x2def05);},'eOxTM':_0x2b41d3(0x1e7)};send_later_popover_keyboard_toggle=!![],_0x3e82f5[_0x2b41d3(0x1ec)](_0x25f9bf,_0x2b41d3(0x18c))[_0x2b41d3(0x1b4)](_0x3e82f5['eOxTM']);}export function initialize(){const _0x5cc863=_0x1c51,_0x274613={'qFMhr':_0x5cc863(0x1b8),'AoYiI':_0x5cc863(0x19b),'xkxaN':function(_0x56a4d3,_0xa9dad9){return _0x56a4d3(_0xa9dad9);},'cmMYW':function(_0x333161,_0x25f281){return _0x333161(_0x25f281);},'TDTOH':_0x5cc863(0x18f),'RwGRG':_0x5cc863(0x1e7),'LvrBY':'.send_later_selected_send_later_time','dQaaA':'.open_send_later_modal','hZkbH':_0x5cc863(0x189),'pRIiu':_0x5cc863(0x18c)};delegate(_0x274613[_0x5cc863(0x1a3)],{..._0x45ceb3[_0x5cc863(0x1b7)],'target':_0x274613['pRIiu'],'onUntrigger'(){const _0x2fdf69=_0x5cc863;_0x25f9bf(_0x274613['qFMhr'])[_0x2fdf69(0x1b4)](_0x274613[_0x2fdf69(0x1e9)]);},'onShow'(_0x4be3a9){const _0x6e9fd4=_0x5cc863,_0x2916bb=_0x566acf[_0x6e9fd4(0x193)]();_0x4be3a9[_0x6e9fd4(0x1bc)](_0x274613['xkxaN'](parse_html,_0x274613['cmMYW'](_0x5ec53b,{'enter_sends_true':user_settings['enter_sends'],'formatted_send_later_time':_0x2916bb}))),_0x45ceb3[_0x6e9fd4(0x1a2)][_0x6e9fd4(0x1a0)]=_0x4be3a9;},'onMount'(_0x31f241){const _0x5028f6=_0x5cc863,_0x20e80d={'TncEi':function(_0x158307,_0x38b090){return _0x158307===_0x38b090;},'Eshxi':function(_0x386ad7,_0x181110){const _0x4edb63=_0x1c51;return _0x274613[_0x4edb63(0x1eb)](_0x386ad7,_0x181110);},'lMleq':_0x274613[_0x5028f6(0x1e9)]};if('bXbua'===_0x274613[_0x5028f6(0x1bb)]){send_later_popover_keyboard_toggle&&(focus_first_send_later_popover_item(),send_later_popover_keyboard_toggle=![]);_0x5ea51e['update_compose_draft_count']();const _0xefc83a=_0x25f9bf(_0x31f241[_0x5028f6(0x1a6)]);_0x5eb8d3['adjust_mac_kbd_tags']('.enter_sends_choices\x20kbd'),_0xefc83a[_0x5028f6(0x1ab)](_0x274613[_0x5028f6(0x19c)],_0x274613[_0x5028f6(0x1dc)],()=>{const _0x5a217a=_0x5028f6,_0x2d4acf=_0x566acf['get_selected_send_later_timestamp']();do_schedule_message(_0x2d4acf),_0x31f241[_0x5a217a(0x1e2)]();}),_0xefc83a[_0x5028f6(0x1ab)]('click',_0x5028f6(0x1b5),_0x918b9b=>{const _0x4210c8=_0x5028f6;let _0x387f49=_0x25f9bf(_0x918b9b[_0x4210c8(0x194)])['find']('input[type=\x27radio\x27]')['attr'](_0x4210c8(0x1c5));_0x387f49=_0x20e80d[_0x4210c8(0x1be)](_0x387f49,_0x4210c8(0x192)),user_settings[_0x4210c8(0x1ea)]=_0x387f49,_0x25f9bf(_0x4210c8(0x1c2)+!_0x387f49)[_0x4210c8(0x1e2)](),_0x20e80d[_0x4210c8(0x1c9)](_0x25f9bf,_0x4210c8(0x1c2)+_0x387f49)[_0x4210c8(0x1ee)](),_0x20e80d[_0x4210c8(0x1c9)](_0x25f9bf,_0x4210c8(0x1b8))[_0x4210c8(0x1b4)](_0x20e80d['lMleq']),_0x2b7e74['patch']({'url':_0x4210c8(0x1da),'data':{'enter_sends':_0x387f49}}),_0x918b9b[_0x4210c8(0x198)](),setTimeout(()=>{const _0x463213=_0x4210c8;_0x31f241[_0x463213(0x1e2)]();},ENTER_SENDS_SELECTION_DELAY);}),_0xefc83a['one'](_0x274613[_0x5028f6(0x19c)],_0x274613['dQaaA'],()=>{const _0x152728=_0x5028f6;open_send_later_menu(),_0x31f241[_0x152728(0x1e2)]();});}else _0x532966['target'][_0x5028f6(0x1e7)]();},'onHidden'(_0x512123){const _0x1471d2=_0x5cc863;_0x512123[_0x1471d2(0x1db)](),_0x45ceb3[_0x1471d2(0x1a2)]['send_later']=undefined,send_later_popover_keyboard_toggle=![];}});}export function should_update_send_later_options(_0x1ace43){const _0xbd0f2=_0x1c51,_0x53c8ee={'pkDVj':function(_0x371eb1,_0x4993d1){return _0x371eb1===_0x4993d1;},'tWoco':'updateClock();','XfoAd':function(_0x98b863,_0x47e4be){return _0x98b863===_0x47e4be;},'GXxyO':function(_0x6032d1,_0x48999d){return _0x6032d1/_0x48999d;}},_0x4ca549=_0x1ace43[_0xbd0f2(0x1b9)](),_0x1a26b4=_0x1ace43[_0xbd0f2(0x196)]();if(_0x53c8ee['pkDVj'](_0x1a26b4,0x0)&&_0x4ca549===0x0)return setInterval(_0x53c8ee[_0xbd0f2(0x19e)],0x3e8),!![];return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x53c8ee[_0xbd0f2(0x1aa)](_0x4ca549,0x3c-_0x53c8ee[_0xbd0f2(0x1ed)](_0x566acf['MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS'],0x3c));}export function update_send_later_options(){const _0x5efe74=_0x1c51,_0x110b18={'Svocu':'#send_later_options'},_0x1b559d=new Date();if(should_update_send_later_options(_0x1b559d)){const _0x3508ae=_0x566acf[_0x5efe74(0x1e6)](_0x1b559d);_0x25f9bf(_0x110b18['Svocu'])[_0x5efe74(0x195)](_0x25f9bf(_0x50b140(_0x3508ae)));}}