function _0x2778(){var _0x48df96=['post','totpToken','../lib/auth','TjDyG','wGwSw','New\x20password\x20validation\x20failed','updateUser','5171931PtydAi','4|5|8|9|6|7|3|2|0|10|1','RXWUQ','/api/users','setupTotp','dYZFO','22076VfEJTL','3222768VQPqYO','rINBA','UjgYd','QsChG','jNDYA','Missing\x20some\x20required\x20parameters','qUais','RHmGV','delete','QMEed','UmWEC','totpSecret','1989952kpEVnb','Forbidden','700RQsBJm','newPassword','PLWmr','BadParameters','2175039BqvROH','lodash','getToken','confirmPassword','onsSm','email','User\x20created\x20successfully','Internal','username','nEdYM','password','188280hXKwfi','nuIer','/api/users/:username','mongoose','getAll','Already\x20Initialized','Required\x20parameters:\x20username,\x20password','body','kKGdX','yNbhg','IUrGC','currentPassword','hasPermission','TPdqx','EYhNx','refreshToken','../lib/passwordpolicy','CQGIb','mdTvb','validtoken','isNil','put','totpEnabled','LLCIb','/api/users/refreshtoken','wBzhS','tmmOK','cookies','gDYLJ','lastname','boolean','RtBVV','create','then','phone','knrxw','token','jsonwebtoken','eDKFz','isAllowed','/api/users/me','clearCookie','getByUsername','sessionId','name','headers','cookie','cancelTotp','Expired\x20refreshToken','reIvQ','NKodR','iuDux','XIHye','GNIii','length','FeSOP','ZpOdt','acl','Password\x20does\x20not\x20match\x20the\x20password\x20policy','wqpyf','forEach','string','VsmRs','role','jwtRefreshSecret','HZRxN','PjlII','User','14ZyorRL','JWT\x20','asOuL','user','audits:review-all','SCDol','enabled','EbWsb','CgcCp','OaxWk','Created','oIMva','verify','New\x20Password\x20does\x20not\x20match\x20the\x20password\x20policy','get','WYdQQ','users:update','firstname','users:create','/api/users/:id','bfDwp','QtHIh','exports','strongPassword','../lib/httpResponse.js','fxRWK','TokenExpiredError','tlSvD','fUpji','user-agent','90wNfzJs','/api/users/checktoken','Unauthorized','getTotpQrcode','ACQwQ','catch','decodedToken','fbmiZ','zjOpN','1812446WhSMOs','split','IovaU','users:read','audits:review'];_0x2778=function(){return _0x48df96;};return _0x2778();}var _0x1a2714=_0x5b96;function _0x5b96(_0x541fb5,_0x336374){var _0x277860=_0x2778();return _0x5b96=function(_0x5b96b5,_0x1336c9){_0x5b96b5=_0x5b96b5-0x1e4;var _0x58e3b4=_0x277860[_0x5b96b5];return _0x58e3b4;},_0x5b96(_0x541fb5,_0x336374);}(function(_0x43fb02,_0x270c9a){var _0x146c8f=_0x5b96,_0x51f879=_0x43fb02();while(!![]){try{var _0x21120c=parseInt(_0x146c8f(0x24c))/0x1+-parseInt(_0x146c8f(0x26b))/0x2+-parseInt(_0x146c8f(0x258))/0x3+-parseInt(_0x146c8f(0x25e))/0x4*(-parseInt(_0x146c8f(0x26d))/0x5)+parseInt(_0x146c8f(0x25f))/0x6*(-parseInt(_0x146c8f(0x225))/0x7)+parseInt(_0x146c8f(0x27c))/0x8+parseInt(_0x146c8f(0x271))/0x9*(parseInt(_0x146c8f(0x243))/0xa);if(_0x21120c===_0x270c9a)break;else _0x51f879['push'](_0x51f879['shift']());}catch(_0x5bb78f){_0x51f879['push'](_0x51f879['shift']());}}}(_0x2778,0xf1d07),module[_0x1a2714(0x23b)]=function(_0xe960c6){var _0x135978=_0x1a2714,_0x258fdc={'wGwSw':_0x135978(0x205),'gDYLJ':_0x135978(0x1f0),'eDKFz':_0x135978(0x1f9),'IUrGC':function(_0x551320,_0x113591){return _0x551320===_0x113591;},'bfDwp':_0x135978(0x211),'ZpOdt':_0x135978(0x232),'onsSm':'Required\x20parameters:\x20username,\x20password','OaxWk':function(_0x1065de,_0x55fe01){return _0x1065de!==_0x55fe01;},'fbmiZ':'string','asOuL':'Parameters\x20must\x20be\x20of\x20type\x20String','nEdYM':_0x135978(0x25a),'CQGIb':_0x135978(0x242),'VsmRs':_0x135978(0x250),'dYZFO':'knrxw','qUais':_0x135978(0x264),'CgcCp':function(_0x2cfa08,_0x5be438){return _0x2cfa08!==_0x5be438;},'iuDux':_0x135978(0x247),'JJLrv':function(_0x1141fe,_0xd47bbb){return _0x1141fe===_0xd47bbb;},'WYdQQ':'oARNI','jccaY':'DrqGH','kKGdX':_0x135978(0x21b),'UjgYd':_0x135978(0x228),'fxRWK':function(_0x1d0678,_0x2a719a){return _0x1d0678!==_0x2a719a;},'oIMva':function(_0x299e31,_0x2e5868){return _0x299e31===_0x2e5868;},'nuIer':_0x135978(0x1e6),'cuKVn':function(_0x4fc15d,_0x2a79b0){return _0x4fc15d!==_0x2a79b0;},'RHmGV':function(_0x411837,_0xe907fc){return _0x411837===_0xe907fc;},'PLWmr':_0x135978(0x216),'FeSOP':'admin','mdTvb':_0x135978(0x1ff),'tlSvD':function(_0x1084e7,_0x6a1d3a){return _0x1084e7(_0x6a1d3a);},'TjDyG':_0x135978(0x23d),'QMuhw':_0x135978(0x1e4),'EYhNx':function(_0x31663d,_0x32a218){return _0x31663d(_0x32a218);},'vwmRV':_0x135978(0x253),'zjOpN':_0x135978(0x1f1),'LLCIb':'/api/users/init','QsChG':_0x135978(0x25b),'didSk':'/api/users/reviewers','VgSnr':_0x135978(0x209),'TPdqx':'validtoken','XIHye':'/api/users/totp'},_0x3df418=_0x258fdc[_0x135978(0x240)](require,_0x258fdc[_0x135978(0x254)]),_0x50bb27=_0x258fdc[_0x135978(0x240)](require,_0x258fdc['QMuhw'])['model'](_0x135978(0x224)),_0x4421e7=_0x258fdc[_0x135978(0x1ef)](require,'../lib/auth')[_0x135978(0x21a)],_0x212a69=_0x258fdc[_0x135978(0x240)](require,_0x258fdc['vwmRV'])[_0x135978(0x221)],_0x5a0fe4=require(_0x135978(0x206)),_0x2d5ab5=require(_0x135978(0x272)),_0xd1db2d=require(_0x258fdc[_0x135978(0x24b)]);_0xe960c6['get'](_0x135978(0x244),_0x4421e7[_0x135978(0x1ed)](_0x135978(0x1f4)),function(_0xe67564,_0x413750){var _0x51ea67=_0x135978;_0x3df418['Ok'](_0x413750,_0xe67564[_0x51ea67(0x1fc)][_0x258fdc[_0x51ea67(0x255)]]);}),_0xe960c6[_0x135978(0x233)]('/api/users/refreshtoken',function(_0x37005d,_0x5ee673){var _0x3b6d00=_0x135978,_0x4854ca=_0x37005d[_0x3b6d00(0x20e)][_0x3b6d00(0x242)],_0x4f613e=_0x37005d[_0x3b6d00(0x1fc)][_0x3b6d00(0x1f0)];_0x50bb27['updateRefreshToken'](_0x4f613e,_0x4854ca)['then'](_0x1ce3df=>{var _0x9e2e2a=_0x3b6d00;_0x5ee673[_0x9e2e2a(0x20f)](_0x9e2e2a(0x205),_0x9e2e2a(0x226)+_0x1ce3df[_0x9e2e2a(0x205)],{'secure':!![],'httpOnly':!![]}),_0x5ee673[_0x9e2e2a(0x20f)](_0x258fdc[_0x9e2e2a(0x1fd)],_0x1ce3df[_0x9e2e2a(0x1f0)],{'secure':!![],'httpOnly':!![],'path':_0x258fdc[_0x9e2e2a(0x207)]}),_0x3df418['Ok'](_0x5ee673,_0x1ce3df);})[_0x3b6d00(0x248)](_0x52e32c=>{var _0xc68720=_0x3b6d00;_0x258fdc[_0xc68720(0x1eb)](_0x52e32c['fn'],'Unauthorized')&&(_0x5ee673[_0xc68720(0x20a)]('token'),_0x5ee673[_0xc68720(0x20a)](_0x258fdc[_0xc68720(0x1fd)])),_0x3df418[_0xc68720(0x278)](_0x5ee673,_0x52e32c);});}),_0xe960c6[_0x135978(0x267)](_0x258fdc[_0x135978(0x207)],function(_0x24effe,_0x4a5075){var _0x1b4504=_0x135978,_0x55a45f=_0x24effe[_0x1b4504(0x1fc)][_0x1b4504(0x1f0)];try{var _0x34f6fd=_0x5a0fe4[_0x1b4504(0x231)](_0x55a45f,_0x212a69);}catch(_0x417585){_0x4a5075['clearCookie'](_0x1b4504(0x205)),_0x4a5075[_0x1b4504(0x20a)](_0x1b4504(0x1f0));if(_0x258fdc['IUrGC'](_0x417585[_0x1b4504(0x20d)],_0x1b4504(0x23f)))_0x3df418[_0x1b4504(0x245)](_0x4a5075,_0x258fdc[_0x1b4504(0x239)]);else _0x3df418[_0x1b4504(0x245)](_0x4a5075,'Invalid\x20refreshToken');return;}_0x50bb27['removeSession'](_0x34f6fd['userId'],_0x34f6fd[_0x1b4504(0x20c)])[_0x1b4504(0x202)](_0x48d6e1=>{var _0x50c739=_0x1b4504;_0x4a5075[_0x50c739(0x20a)](_0x50c739(0x205)),_0x4a5075[_0x50c739(0x20a)](_0x258fdc[_0x50c739(0x1fd)]),_0x3df418['Ok'](_0x4a5075,_0x48d6e1);})[_0x1b4504(0x248)](_0x13aa6c=>_0x3df418[_0x1b4504(0x278)](_0x4a5075,_0x13aa6c));}),_0xe960c6[_0x135978(0x251)]('/api/users/token',function(_0x4eac69,_0x535daf){var _0x2754b9=_0x135978;if(!_0x4eac69['body'][_0x2754b9(0x27b)]||!_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x279)]){_0x3df418[_0x2754b9(0x270)](_0x535daf,_0x258fdc[_0x2754b9(0x275)]);return;}if(_0x258fdc[_0x2754b9(0x22e)](typeof _0x4eac69['body'][_0x2754b9(0x27b)],_0x2754b9(0x21e))||typeof _0x4eac69[_0x2754b9(0x1e8)]['username']!==_0x258fdc['fbmiZ']||_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x252)]&&_0x258fdc[_0x2754b9(0x22e)](typeof _0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x252)],_0x258fdc[_0x2754b9(0x24a)])){_0x3df418[_0x2754b9(0x270)](_0x535daf,_0x258fdc[_0x2754b9(0x227)]);return;}var _0xf1babe=new _0x50bb27();_0xf1babe[_0x2754b9(0x279)]=_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x279)],_0xf1babe[_0x2754b9(0x27b)]=_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x27b)];if(_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x252)])_0xf1babe['totpToken']=_0x4eac69[_0x2754b9(0x1e8)][_0x2754b9(0x252)];_0xf1babe[_0x2754b9(0x273)](_0x4eac69[_0x2754b9(0x20e)][_0x2754b9(0x242)])[_0x2754b9(0x202)](_0x199afa=>{var _0xab70e0=_0x2754b9,_0x2f7f1b={'nXqAf':_0x258fdc['ZpOdt']};if(_0xab70e0(0x1ea)!==_0xab70e0(0x1ea)){_0x397da9[_0xab70e0(0x270)](_0x21d264,_0x2f7f1b['nXqAf']);return;}else _0x535daf[_0xab70e0(0x20f)](_0xab70e0(0x205),_0xab70e0(0x226)+_0x199afa[_0xab70e0(0x205)],{'secure':!![],'httpOnly':!![]}),_0x535daf[_0xab70e0(0x20f)](_0x258fdc[_0xab70e0(0x1fd)],_0x199afa[_0xab70e0(0x1f0)],{'secure':!![],'httpOnly':!![],'path':_0x258fdc[_0xab70e0(0x207)]}),_0x3df418['Ok'](_0x535daf,_0x199afa);})[_0x2754b9(0x248)](_0x6b8dc1=>_0x3df418[_0x2754b9(0x278)](_0x535daf,_0x6b8dc1));}),_0xe960c6['get'](_0x258fdc[_0x135978(0x1f8)],function(_0x4260a8,_0x26ee66){var _0x145c48=_0x135978,_0x2ccaa1={'RtBVV':_0x258fdc[_0x145c48(0x1fd)]};_0x258fdc[_0x145c48(0x27a)]!==_0x258fdc['nEdYM']?(_0x5ad663[_0x145c48(0x20a)](_0x145c48(0x205)),_0xee308[_0x145c48(0x20a)](_0x2ccaa1[_0x145c48(0x200)]),_0x5b1f94['Ok'](_0x1849e3,_0x1739d6)):_0x50bb27['getAll']()[_0x145c48(0x202)](_0x503b2a=>_0x3df418['Ok'](_0x26ee66,_0x503b2a[_0x145c48(0x217)]===0x0))[_0x145c48(0x248)](_0x2d19fb=>_0x3df418[_0x145c48(0x278)](_0x26ee66,_0x2d19fb));}),_0xe960c6[_0x135978(0x233)](_0x258fdc['QsChG'],_0x4421e7[_0x135978(0x1ed)](_0x135978(0x24f)),function(_0x74d83f,_0x15dbbc){var _0x3c840b=_0x135978,_0x10f67b={'QMEed':_0x3c840b(0x205),'QtHIh':_0x258fdc[_0x3c840b(0x1fd)],'HZRxN':_0x3c840b(0x1f9)};if(_0x3c840b(0x21c)===_0x3c840b(0x213)){if(!_0x42b61a[_0x3c840b(0x1e8)]['password']||!_0xd4b557[_0x3c840b(0x1e8)][_0x3c840b(0x279)]){_0x1ab24f[_0x3c840b(0x270)](_0x52dbc9,_0x3c840b(0x1e7));return;}if(typeof _0x512827[_0x3c840b(0x1e8)][_0x3c840b(0x27b)]!=='string'||_0x258fdc[_0x3c840b(0x22e)](typeof _0x3aec70[_0x3c840b(0x1e8)][_0x3c840b(0x279)],_0x258fdc[_0x3c840b(0x24a)])||_0x33ce37[_0x3c840b(0x1e8)][_0x3c840b(0x252)]&&typeof _0x481374[_0x3c840b(0x1e8)][_0x3c840b(0x252)]!=='string'){_0xffe2d[_0x3c840b(0x270)](_0x541849,_0x258fdc[_0x3c840b(0x227)]);return;}var _0x4643bb=new _0x42c615();_0x4643bb[_0x3c840b(0x279)]=_0x145846[_0x3c840b(0x1e8)][_0x3c840b(0x279)],_0x4643bb[_0x3c840b(0x27b)]=_0x2b2a92[_0x3c840b(0x1e8)][_0x3c840b(0x27b)];if(_0x12cfd5[_0x3c840b(0x1e8)][_0x3c840b(0x252)])_0x4643bb[_0x3c840b(0x252)]=_0x217ace[_0x3c840b(0x1e8)][_0x3c840b(0x252)];_0x4643bb[_0x3c840b(0x273)](_0x448581[_0x3c840b(0x20e)][_0x258fdc[_0x3c840b(0x1f2)]])[_0x3c840b(0x202)](_0x359011=>{var _0x40670a=_0x3c840b;_0x3b20f2[_0x40670a(0x20f)](_0x10f67b[_0x40670a(0x268)],_0x40670a(0x226)+_0x359011[_0x40670a(0x205)],{'secure':!![],'httpOnly':!![]}),_0x21ca5f[_0x40670a(0x20f)](_0x10f67b[_0x40670a(0x23a)],_0x359011[_0x40670a(0x1f0)],{'secure':!![],'httpOnly':!![],'path':_0x10f67b[_0x40670a(0x222)]}),_0x5ec27f['Ok'](_0xcea960,_0x359011);})[_0x3c840b(0x248)](_0x3c1ce8=>_0x1fdb67[_0x3c840b(0x278)](_0x35927c,_0x3c1ce8));}else _0x50bb27['getAll']()[_0x3c840b(0x202)](_0x287cb6=>_0x3df418['Ok'](_0x15dbbc,_0x287cb6))[_0x3c840b(0x248)](_0x1d36de=>_0x3df418[_0x3c840b(0x278)](_0x15dbbc,_0x1d36de));}),_0xe960c6[_0x135978(0x233)](_0x258fdc['didSk'],_0x4421e7[_0x135978(0x1ed)](_0x135978(0x24f)),function(_0x190d04,_0x6b103){var _0x3843e5=_0x135978,_0x146bf0={'tmmOK':_0x3843e5(0x1f9)};_0x50bb27[_0x3843e5(0x1e5)]()['then'](_0xea29a9=>{var _0x3a9447=_0x3843e5,_0x33a64b={'LMUuy':_0x258fdc[_0x3a9447(0x21f)]};if(_0x258fdc[_0x3a9447(0x25d)]===_0x3a9447(0x204)){var _0x1883d8=[];_0xea29a9[_0x3a9447(0x21d)](_0x5c4fdf=>{var _0x18a514=_0x3a9447;(_0x4421e7[_0x18a514(0x208)](_0x5c4fdf[_0x18a514(0x220)],_0x33a64b['LMUuy'])||_0x4421e7[_0x18a514(0x208)](_0x5c4fdf[_0x18a514(0x220)],_0x18a514(0x229)))&&_0x1883d8['push'](_0x5c4fdf);}),_0x3df418['Ok'](_0x6b103,_0x1883d8);}else _0x490538[_0x3a9447(0x20f)](_0x3a9447(0x205),_0x3a9447(0x226)+_0x27bbe7['token'],{'secure':!![],'httpOnly':!![]}),_0x16a22f['cookie'](_0x3a9447(0x1f0),_0x239f60[_0x3a9447(0x1f0)],{'secure':!![],'httpOnly':!![],'path':_0x146bf0[_0x3a9447(0x1fb)]}),_0x5057f3[_0x3a9447(0x22f)](_0x2c1f72,_0x2c5e0a);})[_0x3843e5(0x248)](_0x1508a1=>_0x3df418[_0x3843e5(0x278)](_0x6b103,_0x1508a1));}),_0xe960c6['get'](_0x258fdc['VgSnr'],_0x4421e7['hasPermission'](_0x258fdc['TPdqx']),function(_0xc45714,_0xa3b67a){var _0x299bfa=_0x135978;_0x50bb27[_0x299bfa(0x20b)](_0xc45714[_0x299bfa(0x249)][_0x299bfa(0x279)])[_0x299bfa(0x202)](_0x42a1cb=>_0x3df418['Ok'](_0xa3b67a,_0x42a1cb))['catch'](_0x285cbc=>_0x3df418[_0x299bfa(0x278)](_0xa3b67a,_0x285cbc));}),_0xe960c6['get']('/api/users/totp',_0x4421e7[_0x135978(0x1ed)](_0x258fdc[_0x135978(0x1ee)]),function(_0x17b2bd,_0x5a2ef0){var _0x31142f=_0x135978;_0x50bb27[_0x31142f(0x246)](_0x17b2bd[_0x31142f(0x249)][_0x31142f(0x279)])[_0x31142f(0x202)](_0x18fa42=>_0x3df418['Ok'](_0x5a2ef0,_0x18fa42))['catch'](_0x3a59bb=>_0x3df418[_0x31142f(0x278)](_0x5a2ef0,_0x3a59bb));}),_0xe960c6['post'](_0x258fdc[_0x135978(0x215)],_0x4421e7['hasPermission'](_0x135978(0x1f4)),function(_0x1a2206,_0x24e7bc){var _0x336b3f=_0x135978,_0x4a0eec={'Xdmuo':_0x336b3f(0x1f0),'FXUfE':_0x258fdc[_0x336b3f(0x265)]};if(_0x258fdc[_0x336b3f(0x22d)](_0x336b3f(0x269),_0x336b3f(0x269)))_0x14583d['fn']==='Unauthorized'&&(_0x6f1a19['clearCookie']('token'),_0x2c9be7['clearCookie'](_0x4a0eec['Xdmuo'])),_0x2f4d4b[_0x336b3f(0x278)](_0x13af4e,_0x3bdabd);else{if(!_0x1a2206['body'][_0x336b3f(0x252)]||!_0x1a2206['body'][_0x336b3f(0x26a)]){if(_0x336b3f(0x247)===_0x258fdc[_0x336b3f(0x214)]){_0x3df418[_0x336b3f(0x270)](_0x24e7bc,_0x336b3f(0x264));return;}else{_0x564cba[_0x336b3f(0x270)](_0x2ab1b8,_0x4a0eec['FXUfE']);return;}}_0x50bb27[_0x336b3f(0x25c)](_0x1a2206[_0x336b3f(0x1e8)]['totpToken'],_0x1a2206['body'][_0x336b3f(0x26a)],_0x1a2206['decodedToken']['username'])[_0x336b3f(0x202)](_0x19f4b8=>_0x3df418['Ok'](_0x24e7bc,_0x19f4b8))[_0x336b3f(0x248)](_0x1644b5=>_0x3df418[_0x336b3f(0x278)](_0x24e7bc,_0x1644b5));}}),_0xe960c6[_0x135978(0x267)](_0x258fdc[_0x135978(0x215)],_0x4421e7[_0x135978(0x1ed)](_0x258fdc[_0x135978(0x1ee)]),function(_0x1663f1,_0x1cac3c){var _0x370522=_0x135978;if(!_0x1663f1[_0x370522(0x1e8)][_0x370522(0x252)]){if(_0x258fdc['JJLrv'](_0x258fdc[_0x370522(0x234)],_0x258fdc['jccaY'])){_0x316dae[_0x370522(0x270)](_0x1e99a2,'Parameters\x20must\x20be\x20of\x20type\x20String');return;}else{_0x3df418[_0x370522(0x270)](_0x1cac3c,'Missing\x20some\x20required\x20parameters');return;}}_0x50bb27[_0x370522(0x210)](_0x1663f1[_0x370522(0x1e8)][_0x370522(0x252)],_0x1663f1['decodedToken'][_0x370522(0x279)])[_0x370522(0x202)](_0x52ee05=>_0x3df418['Ok'](_0x1cac3c,_0x52ee05))[_0x370522(0x248)](_0x15a61d=>_0x3df418[_0x370522(0x278)](_0x1cac3c,_0x15a61d));}),_0xe960c6[_0x135978(0x233)](_0x135978(0x27e),_0x4421e7['hasPermission'](_0x135978(0x24f)),function(_0x13c251,_0x328388){var _0x56ea0b=_0x135978;_0x50bb27[_0x56ea0b(0x20b)](_0x13c251['params'][_0x56ea0b(0x279)])[_0x56ea0b(0x202)](_0x3f31ba=>_0x3df418['Ok'](_0x328388,_0x3f31ba))[_0x56ea0b(0x248)](_0x46529f=>_0x3df418[_0x56ea0b(0x278)](_0x328388,_0x46529f));}),_0xe960c6['post'](_0x258fdc[_0x135978(0x262)],_0x4421e7[_0x135978(0x1ed)](_0x135978(0x237)),function(_0xa0b4c3,_0x3f4819){var _0x1e931f=_0x135978;if(!_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x279)]||!_0xa0b4c3[_0x1e931f(0x1e8)]['password']||!_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x236)]||!_0xa0b4c3['body'][_0x1e931f(0x1fe)]){_0x3df418[_0x1e931f(0x270)](_0x3f4819,_0x258fdc[_0x1e931f(0x265)]);return;}if(_0xd1db2d[_0x1e931f(0x23c)](_0xa0b4c3['body'][_0x1e931f(0x27b)])!==!![]){_0x3df418[_0x1e931f(0x270)](_0x3f4819,_0x258fdc[_0x1e931f(0x1e9)]);return;}var _0x2eb00d={};_0x2eb00d[_0x1e931f(0x279)]=_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x279)],_0x2eb00d[_0x1e931f(0x27b)]=_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x27b)],_0x2eb00d['firstname']=_0xa0b4c3['body'][_0x1e931f(0x236)],_0x2eb00d[_0x1e931f(0x1fe)]=_0xa0b4c3['body']['lastname'],_0x2eb00d['role']=_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x220)]||_0x258fdc[_0x1e931f(0x261)];if(_0xa0b4c3[_0x1e931f(0x1e8)]['email'])_0x2eb00d['email']=_0xa0b4c3['body'][_0x1e931f(0x276)];if(_0xa0b4c3[_0x1e931f(0x1e8)][_0x1e931f(0x203)])_0x2eb00d[_0x1e931f(0x203)]=_0xa0b4c3['body'][_0x1e931f(0x203)];_0x50bb27[_0x1e931f(0x201)](_0x2eb00d)[_0x1e931f(0x202)](_0x200e08=>_0x3df418[_0x1e931f(0x22f)](_0x3f4819,'User\x20created\x20successfully'))[_0x1e931f(0x248)](_0x517ee4=>_0x3df418['Internal'](_0x3f4819,_0x517ee4));}),_0xe960c6[_0x135978(0x251)](_0x258fdc[_0x135978(0x1f8)],function(_0x4b7cb5,_0x87988e){var _0x5ced29=_0x135978,_0x400832={'rINBA':_0x5ced29(0x259)};if(_0x258fdc['oIMva'](_0x5ced29(0x1fa),'wBzhS')){if(!_0x4b7cb5[_0x5ced29(0x1e8)]['username']||!_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x27b)]||!_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x236)]||!_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x1fe)]){_0x3df418[_0x5ced29(0x270)](_0x87988e,_0x258fdc[_0x5ced29(0x265)]);return;}if(_0x258fdc['cuKVn'](_0xd1db2d[_0x5ced29(0x23c)](_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x27b)]),!![])){if(_0x258fdc[_0x5ced29(0x266)](_0x258fdc['PLWmr'],_0x258fdc[_0x5ced29(0x26f)])){_0x3df418['BadParameters'](_0x87988e,_0x258fdc['kKGdX']);return;}else _0x1da7d0['clearCookie'](_0x258fdc['wGwSw']),_0x4831e4[_0x5ced29(0x20a)](_0x5ced29(0x1f0));}var _0x5764df={};_0x5764df[_0x5ced29(0x279)]=_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x279)],_0x5764df[_0x5ced29(0x27b)]=_0x4b7cb5[_0x5ced29(0x1e8)]['password'],_0x5764df[_0x5ced29(0x236)]=_0x4b7cb5['body'][_0x5ced29(0x236)],_0x5764df[_0x5ced29(0x1fe)]=_0x4b7cb5[_0x5ced29(0x1e8)][_0x5ced29(0x1fe)],_0x5764df[_0x5ced29(0x220)]=_0x258fdc[_0x5ced29(0x218)],_0x50bb27[_0x5ced29(0x1e5)]()['then'](_0x2e2a2b=>{var _0x3a25db=_0x5ced29,_0x3baa86={'SCDol':function(_0x57e5b2,_0x3e9fb3){var _0x3e77d5=_0x5b96;return _0x258fdc[_0x3e77d5(0x23e)](_0x57e5b2,_0x3e9fb3);},'reIvQ':_0x3a25db(0x263),'IovaU':_0x258fdc['gDYLJ'],'PjlII':_0x3a25db(0x1f9),'EbWsb':_0x258fdc[_0x3a25db(0x1f2)]};if(_0x258fdc[_0x3a25db(0x230)](_0x2e2a2b[_0x3a25db(0x217)],0x0))_0x50bb27['create'](_0x5764df)['then'](_0x45d286=>{var _0x165541=_0x3a25db,_0x1a142b={'fUpji':_0x165541(0x264)},_0x27e5f3=new _0x50bb27();_0x27e5f3[_0x165541(0x279)]=_0x4b7cb5[_0x165541(0x1e8)][_0x165541(0x279)],_0x27e5f3[_0x165541(0x27b)]=_0x4b7cb5[_0x165541(0x1e8)][_0x165541(0x27b)],_0x27e5f3[_0x165541(0x273)](_0x4b7cb5[_0x165541(0x20e)][_0x3baa86[_0x165541(0x22c)]])[_0x165541(0x202)](_0x51026f=>{var _0x2d42a9=_0x165541;if(_0x3baa86[_0x2d42a9(0x22a)](_0x2d42a9(0x263),_0x3baa86[_0x2d42a9(0x212)])){_0x4ac9b1[_0x2d42a9(0x270)](_0x47c39c,_0x1a142b[_0x2d42a9(0x241)]);return;}else _0x87988e[_0x2d42a9(0x20f)]('token',_0x2d42a9(0x226)+_0x51026f[_0x2d42a9(0x205)],{'secure':!![],'httpOnly':!![]}),_0x87988e[_0x2d42a9(0x20f)](_0x3baa86[_0x2d42a9(0x24e)],_0x51026f[_0x2d42a9(0x1f0)],{'secure':!![],'httpOnly':!![],'path':_0x3baa86[_0x2d42a9(0x223)]}),_0x3df418[_0x2d42a9(0x22f)](_0x87988e,_0x51026f);})['catch'](_0x5072e8=>_0x3df418[_0x165541(0x278)](_0x87988e,_0x5072e8));})[_0x3a25db(0x248)](_0x468976=>_0x3df418[_0x3a25db(0x278)](_0x87988e,_0x468976));else _0x3df418[_0x3a25db(0x26c)](_0x87988e,_0x258fdc[_0x3a25db(0x27d)]);})['catch'](_0x16216d=>_0x3df418[_0x5ced29(0x278)](_0x87988e,_0x16216d));}else{var _0x55d71a=_0x400832[_0x5ced29(0x260)][_0x5ced29(0x24d)]('|'),_0x3f1bd0=0x0;while(!![]){switch(_0x55d71a[_0x3f1bd0++]){case'0':if(_0x5d354d[_0x5ced29(0x1e8)][_0x5ced29(0x276)])_0x5d6157[_0x5ced29(0x276)]=_0x16c4b8[_0x5ced29(0x1e8)][_0x5ced29(0x276)];continue;case'1':_0x3b1925['create'](_0x5d6157)['then'](_0x1bc743=>_0x4cb776[_0x5ced29(0x22f)](_0xa0face,_0x5ced29(0x277)))[_0x5ced29(0x248)](_0x44b566=>_0x1d82ad['Internal'](_0x4053a3,_0x44b566));continue;case'2':_0x5d6157['role']=_0x55daab[_0x5ced29(0x1e8)][_0x5ced29(0x220)]||_0x5ced29(0x228);continue;case'3':_0x5d6157[_0x5ced29(0x1fe)]=_0xc524c2['body'][_0x5ced29(0x1fe)];continue;case'4':if(!_0x1b56b8[_0x5ced29(0x1e8)]['username']||!_0x28a1b0[_0x5ced29(0x1e8)]['password']||!_0x273181[_0x5ced29(0x1e8)]['firstname']||!_0x22cfdd[_0x5ced29(0x1e8)][_0x5ced29(0x1fe)]){_0x552dc0['BadParameters'](_0x530214,_0x5ced29(0x264));return;}continue;case'5':if(_0x35f6ac[_0x5ced29(0x23c)](_0x358a41[_0x5ced29(0x1e8)]['password'])!==!![]){_0x9f1c52[_0x5ced29(0x270)](_0x3f131c,'Password\x20does\x20not\x20match\x20the\x20password\x20policy');return;}continue;case'6':_0x5d6157[_0x5ced29(0x27b)]=_0x50102e[_0x5ced29(0x1e8)][_0x5ced29(0x27b)];continue;case'7':_0x5d6157[_0x5ced29(0x236)]=_0x333dcc[_0x5ced29(0x1e8)][_0x5ced29(0x236)];continue;case'8':var _0x5d6157={};continue;case'9':_0x5d6157[_0x5ced29(0x279)]=_0x10a647[_0x5ced29(0x1e8)][_0x5ced29(0x279)];continue;case'10':if(_0x4240f5[_0x5ced29(0x1e8)][_0x5ced29(0x203)])_0x5d6157[_0x5ced29(0x203)]=_0xce331f['body'][_0x5ced29(0x203)];continue;}break;}}}),_0xe960c6[_0x135978(0x1f6)](_0x135978(0x209),_0x4421e7[_0x135978(0x1ed)](_0x258fdc[_0x135978(0x1ee)]),function(_0x3ea918,_0x5b60f7){var _0x4cfde=_0x135978,_0x46dc55='4|6|7|5|9|1|8|10|3|11|0|2'[_0x4cfde(0x24d)]('|'),_0x3acd16=0x0;while(!![]){switch(_0x46dc55[_0x3acd16++]){case'0':if(!_0x2d5ab5['isNil'](_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x203)]))_0x4e2c92[_0x4cfde(0x203)]=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x203)];continue;case'1':if(_0x3ea918['body'][_0x4cfde(0x279)])_0x4e2c92[_0x4cfde(0x279)]=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x279)];continue;case'2':_0x50bb27['updateProfile'](_0x3ea918[_0x4cfde(0x249)][_0x4cfde(0x279)],_0x4e2c92)[_0x4cfde(0x202)](_0x3e5c9e=>{var _0x34fac3=_0x4cfde;_0x5b60f7['cookie'](_0x34fac3(0x205),_0x3e5c9e['token'],{'secure':!![],'httpOnly':!![]}),_0x3df418['Ok'](_0x5b60f7,_0x3e5c9e);})[_0x4cfde(0x248)](_0x1278ea=>_0x3df418[_0x4cfde(0x278)](_0x5b60f7,_0x1278ea));continue;case'3':if(_0x3ea918['body'][_0x4cfde(0x1fe)])_0x4e2c92['lastname']=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x1fe)];continue;case'4':if(!_0x3ea918['body'][_0x4cfde(0x1ec)]||_0x3ea918[_0x4cfde(0x1e8)]['newPassword']&&!_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x274)]||_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x274)]&&!_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x26e)]){_0x3df418['BadParameters'](_0x5b60f7,_0x4cfde(0x264));return;}continue;case'5':var _0x4e2c92={};continue;case'6':if(_0x3ea918[_0x4cfde(0x1e8)]['newPassword']!==_0x3ea918['body']['confirmPassword']){_0x3df418[_0x4cfde(0x270)](_0x5b60f7,_0x4cfde(0x256));return;}continue;case'7':if(_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x26e)]&&_0xd1db2d['strongPassword'](_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x26e)])!==!![]){_0x3df418[_0x4cfde(0x270)](_0x5b60f7,_0x258fdc[_0x4cfde(0x219)]);return;}continue;case'8':if(_0x3ea918['body'][_0x4cfde(0x26e)])_0x4e2c92['newPassword']=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x26e)];continue;case'9':_0x4e2c92['password']=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x1ec)];continue;case'10':if(_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x236)])_0x4e2c92[_0x4cfde(0x236)]=_0x3ea918[_0x4cfde(0x1e8)][_0x4cfde(0x236)];continue;case'11':if(!_0x2d5ab5[_0x4cfde(0x1f5)](_0x3ea918['body'][_0x4cfde(0x276)]))_0x4e2c92[_0x4cfde(0x276)]=_0x3ea918['body']['email'];continue;}break;}}),_0xe960c6['put'](_0x135978(0x238),_0x4421e7[_0x135978(0x1ed)](_0x135978(0x235)),function(_0x27badc,_0x37558b){var _0x4a5fde=_0x135978;if(_0x27badc['body'][_0x4a5fde(0x27b)]&&!_0xd1db2d[_0x4a5fde(0x23c)](_0x27badc[_0x4a5fde(0x1e8)]['password'])){_0x3df418['BadParameters'](_0x37558b,'New\x20Password\x20does\x20not\x20match\x20the\x20password\x20policy');return;}var _0x5e2139={};if(_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x279)])_0x5e2139[_0x4a5fde(0x279)]=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x279)];if(_0x27badc['body']['password'])_0x5e2139['password']=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x27b)];if(_0x27badc[_0x4a5fde(0x1e8)]['firstname'])_0x5e2139['firstname']=_0x27badc['body']['firstname'];if(_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x1fe)])_0x5e2139[_0x4a5fde(0x1fe)]=_0x27badc['body'][_0x4a5fde(0x1fe)];if(!_0x2d5ab5[_0x4a5fde(0x1f5)](_0x27badc[_0x4a5fde(0x1e8)]['email']))_0x5e2139[_0x4a5fde(0x276)]=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x276)];if(!_0x2d5ab5[_0x4a5fde(0x1f5)](_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x203)]))_0x5e2139[_0x4a5fde(0x203)]=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x203)];if(_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x220)])_0x5e2139[_0x4a5fde(0x220)]=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x220)];if(typeof _0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x1f7)]===_0x258fdc[_0x4a5fde(0x1f3)])_0x5e2139[_0x4a5fde(0x1f7)]=_0x27badc['body'][_0x4a5fde(0x1f7)];if(typeof _0x27badc['body'][_0x4a5fde(0x22b)]===_0x4a5fde(0x1ff))_0x5e2139[_0x4a5fde(0x22b)]=_0x27badc[_0x4a5fde(0x1e8)][_0x4a5fde(0x22b)];_0x50bb27[_0x4a5fde(0x257)](_0x27badc['params']['id'],_0x5e2139)[_0x4a5fde(0x202)](_0x483e7d=>_0x3df418['Ok'](_0x37558b,_0x483e7d))['catch'](_0x3af662=>_0x3df418[_0x4a5fde(0x278)](_0x37558b,_0x3af662));});});