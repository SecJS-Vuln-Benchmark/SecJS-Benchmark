var _0x4ca61c=_0x1400;(function(_0x4154d9,_0x229cc8){var _0x16eba1=_0x1400,_0x3b1b95=_0x4154d9();while(!![]){try{var _0x448c2d=-parseInt(_0x16eba1(0x1d1))/0x1+-parseInt(_0x16eba1(0x1f9))/0x2*(-parseInt(_0x16eba1(0x1f2))/0x3)+-parseInt(_0x16eba1(0x208))/0x4*(-parseInt(_0x16eba1(0x202))/0x5)+-parseInt(_0x16eba1(0x1bf))/0x6*(parseInt(_0x16eba1(0x20e))/0x7)+-parseInt(_0x16eba1(0x1d4))/0x8+parseInt(_0x16eba1(0x1b1))/0x9*(-parseInt(_0x16eba1(0x1a9))/0xa)+-parseInt(_0x16eba1(0x1e0))/0xb;if(_0x448c2d===_0x229cc8)break;else _0x3b1b95['push'](_0x3b1b95['shift']());}catch(_0x7f4ab4){_0x3b1b95['push'](_0x3b1b95['shift']());}}}(_0x40cf,0xaa7a0));var jstest=require('jstest')[_0x4ca61c(0x1d3)],Engine=require(_0x4ca61c(0x201)),Server=require('../../../src/protocol/server');function _0x1400(_0x14e566,_0x52b0a9){var _0x40cf70=_0x40cf();return _0x1400=function(_0x140052,_0x13fd24){_0x140052=_0x140052-0x1a1;var _0x322667=_0x40cf70[_0x140052];return _0x322667;},_0x1400(_0x14e566,_0x52b0a9);}function _0x40cf(){var _0x5e3e3a=['error','returns','3|0|2|1|4','/meta/subscribe','does\x20not\x20subscribe\x20using\x20the\x20intended\x20channel','2|1|0|3|4','TkgWY','RGaNW','LifqY','ext','qHKkP','PomwK','633522FbFGDU','calNI','server','YTRHf','SFyCV','ZOuyQ','UPKmx','10LEVizj','hVcrn','MsLBD','hello','Invalid\x20auth','JwfFE','passes\x20incoming\x20messages\x20through\x20the\x20extension','CgULR','../../../src/engines/proxy','964415yWTVii','publish','xRAlr','zEMjd','lIaDU','password','28hAbxSk','qzJWr','clientExists','LaPwH','Server\x20extensions','aIkIQ','349902UsKaDP','atSNa','qgKFT','ZjLyw','AKxrb','tfkeR','VTwVY','kwwih','passes\x20outgoing\x20messages\x20through\x20the\x20extension','TfUbh','OggRe','NXoVO','eYrax','dQjJJ','10LSysrp','given','addExtension','GJSUI','JklGx','1|0|3|2|4','WyUEo','XkvFi','3930669UeAmzc','/foo','split','myhQx','Ghikd','process','ENfdk','WjHOf','with\x20subscription\x20auth\x20installed','fakeclientid','LGDdJ','subscribe','nGJZI','LrRkj','36DwkRMz','ZWnTM','auth','VBhBr','handshake','/meta/handshake','1|3|0|4|2','QbvSR','does\x20not\x20pass\x20incoming\x20messages\x20through\x20the\x20extension','yields','iZwFV','with\x20an\x20incoming\x20extension\x20installed','OlIrn','jSrKu','match','oKctF','message','HwPkm','225897VZUXKk','does\x20not\x20pass\x20outgoing\x20messages\x20through\x20the\x20extension','Test','2293184RBuQFx','XyogF','does\x20not\x20subscribe\x20using\x20an\x20extended\x20channel','SNNSC','channel','bpgIp','INtyz','Kksno','with\x20an\x20outgoing\x20extension\x20installed','/meta/subscribe/x','HJqRP','Xflfz','5044347pncZpl','YChJd','PdNND','get','exactly','xlXpG'];_0x40cf=function(){return _0x5e3e3a;};return _0x40cf();}jstest['describe'](_0x4ca61c(0x20c),function(){var _0x1ed836=_0x4ca61c,_0x2287c2={'XyogF':_0x1ed836(0x1bb),'atSNa':function(_0x23033b,_0x1322df,_0x275064){return _0x23033b(_0x1322df,_0x275064);},'ZOuyQ':_0x1ed836(0x203),'LifqY':'hello','zEMjd':_0x1ed836(0x207),'UGasv':_0x1ed836(0x210),'WyUEo':_0x1ed836(0x20d),'iZwFV':_0x1ed836(0x1ae),'lIaDU':_0x1ed836(0x1b2),'hVcrn':_0x1ed836(0x1b0),'kDcyg':_0x1ed836(0x1ba),'scKfl':_0x1ed836(0x20a),'EfqeY':function(_0x25e6ca,_0x3b7ed1){return _0x25e6ca===_0x3b7ed1;},'ZjLyw':function(_0x317430,_0x49ae30){return _0x317430===_0x49ae30;},'bpgIp':_0x1ed836(0x1cb),'kwwih':function(_0x1a7d34,_0x1f81f4,_0x1608a3){return _0x1a7d34(_0x1f81f4,_0x1608a3);},'Ghikd':_0x1ed836(0x1da),'SFyCV':_0x1ed836(0x1e9),'PomwK':function(_0x107d21,_0x15c27c,_0x3b7299){return _0x107d21(_0x15c27c,_0x3b7299);},'UPKmx':function(_0xd0e247,_0x396309,_0x10bef3){return _0xd0e247(_0x396309,_0x10bef3);},'PdNND':function(_0x842f82,_0x5a403b,_0x2eba48){return _0x842f82(_0x5a403b,_0x2eba48);},'YTRHf':'subscribe','qHKkP':function(_0xdbf76e,_0x1fc1b1){return _0xdbf76e(_0x1fc1b1);},'eYrax':_0x1ed836(0x1ea),'LrRkj':function(_0x56a46f,_0x21effe,_0x4fe03a){return _0x56a46f(_0x21effe,_0x4fe03a);},'LaPwH':_0x1ed836(0x1e8),'nGJZI':function(_0x3ac3c8,_0x38eaa8,_0x43e04b){return _0x3ac3c8(_0x38eaa8,_0x43e04b);},'CmiMK':function(_0x2a0599,_0x192462){return _0x2a0599!==_0x192462;},'LuxGb':_0x1ed836(0x1ce),'Xflfz':_0x1ed836(0x1ed),'Elpxx':_0x1ed836(0x1ec),'JklGx':function(_0xdc8770,_0x515974){return _0xdc8770(_0x515974);},'VBhBr':_0x1ed836(0x1ca)};with(this){_0x2287c2[_0x1ed836(0x1ad)](before,function(){var _0x3e2380=_0x1ed836,_0x545425={'SNNSC':_0x3e2380(0x1c5),'xRAlr':function(_0x32bd10,_0x53355c,_0x5bd0b2){return _0x32bd10(_0x53355c,_0x5bd0b2);},'fwJUO':_0x3e2380(0x1c3),'fbUtJ':function(_0x20289d,_0x304dfd,_0x5073cb){return _0x20289d(_0x304dfd,_0x5073cb);},'nnPjK':'hello'};with(this){if(_0x3e2380(0x1bb)===_0x2287c2[_0x3e2380(0x1d5)])this['engine']={},_0x2287c2['atSNa'](stub,Engine,_0x3e2380(0x1e3))[_0x3e2380(0x1e7)](engine),this[_0x3e2380(0x1f4)]=new Server();else{var _0x46cf3f=_0x545425[_0x3e2380(0x1d7)][_0x3e2380(0x1b3)]('|'),_0x1a0f2d=0x0;while(!![]){switch(_0x46cf3f[_0x1a0f2d++]){case'0':var _0x1ae718=null;continue;case'1':_0x545425[_0x3e2380(0x204)](_0x9ee755,_0x597004,_0x545425['fwJUO'])['yields']([_0x1b08ca]);continue;case'2':_0x545425['fbUtJ'](_0x2f5be9,[{'channel':_0x3e2380(0x1b2),'data':_0x545425['nnPjK']}],_0x1ae718);continue;case'3':_0x574e8d(_0x4d63a3,_0x3e2380(0x203));continue;case'4':_0x1ab95e['process']({'channel':'/meta/handshake'},![],function(_0x5d6c2f){_0x1ae718=_0x5d6c2f;});continue;}break;}}}}),describe(_0x2287c2[_0x1ed836(0x1c2)],function(){var _0x34c136=_0x1ed836,_0x168a92={'xlXpG':_0x34c136(0x207),'HJqRP':_0x2287c2[_0x34c136(0x206)]};if(_0x34c136(0x1b0)!==_0x2287c2[_0x34c136(0x1fa)]){var _0x541307={'outgoing':function(_0x251a91,_0xad4e94){var _0x2e8a25=_0x34c136;_0x251a91['ext']={'auth':_0x168a92[_0x2e8a25(0x1e5)]},_0xad4e94(_0x251a91);}};_0x4a5d19[_0x34c136(0x1ab)](_0x541307),this[_0x34c136(0x1cf)]={'channel':_0x168a92[_0x34c136(0x1de)],'data':_0x34c136(0x1fc)};}else with(this){before(function(){var _0x8b533b=_0x34c136;with(this){if(_0x8b533b(0x1fb)!==_0x8b533b(0x1e1)){var _0xd8dc70={'incoming':function(_0x1f75f6,_0x5b49bf){var _0x3b3796=_0x8b533b;_0x1f75f6['ext']={'auth':_0x168a92[_0x3b3796(0x1e5)]},_0x5b49bf(_0x1f75f6);}};server[_0x8b533b(0x1ab)](_0xd8dc70),this[_0x8b533b(0x1cf)]={'channel':_0x8b533b(0x1b2),'data':_0x8b533b(0x1fc)};}else _0x1634ef[_0x8b533b(0x1ef)]={'auth':_0x8b533b(0x207)},_0x60b4d8(_0xad102);}}),_0x2287c2['atSNa'](it,_0x34c136(0x1ff),function(){var _0x5e8fa6=_0x34c136;with(this){expect(engine,_0x2287c2[_0x5e8fa6(0x1f7)])['given']({'channel':'/foo','data':_0x2287c2[_0x5e8fa6(0x1ee)],'ext':{'auth':_0x2287c2[_0x5e8fa6(0x205)]}}),server[_0x5e8fa6(0x1b6)](message,![],function(){});}}),it(_0x34c136(0x1d2),function(){var _0xe11f23=_0x34c136,_0x19d318={'tfkeR':'password','TfUbh':_0x2287c2[_0xe11f23(0x1ee)]};if(_0x2287c2['UGasv']===_0x2287c2[_0xe11f23(0x1af)]){var _0x17e309={'incoming':function(_0x4b9314,_0x1ce4ca){var _0x4a6e57=_0xe11f23;_0x4b9314[_0x4a6e57(0x1ef)]={'auth':_0x19d318[_0x4a6e57(0x213)]},_0x1ce4ca(_0x4b9314);}};_0x1ed8de['addExtension'](_0x17e309),this[_0xe11f23(0x1cf)]={'channel':_0xe11f23(0x1b2),'data':_0x19d318[_0xe11f23(0x1a4)]};}else with(this){var _0x4b65ef=_0x2287c2[_0xe11f23(0x1c9)][_0xe11f23(0x1b3)]('|'),_0x19d405=0x0;while(!![]){switch(_0x4b65ef[_0x19d405++]){case'0':stub(engine,_0x2287c2['ZOuyQ']);continue;case'1':_0x2287c2[_0xe11f23(0x20f)](stub,server,_0xe11f23(0x1c3))[_0xe11f23(0x1c8)]([message]);continue;case'2':server['process']({'channel':_0xe11f23(0x1c4)},![],function(_0x519d55){_0x5c4b8d=_0x519d55;});continue;case'3':var _0x5c4b8d=null;continue;case'4':_0x2287c2[_0xe11f23(0x20f)](assertEqual,[{'channel':_0x2287c2[_0xe11f23(0x206)],'data':_0xe11f23(0x1fc)}],_0x5c4b8d);continue;}break;}}});}}),describe(_0x1ed836(0x1b9),function(){var _0x2a9a66=_0x1ed836,_0x424b2f={'iRwyw':function(_0x17895a,_0x1e1471){return _0x17895a===_0x1e1471;},'HwPkm':function(_0x2d5430,_0x1ba35f){return _0x2d5430(_0x1ba35f);}};with(this){if(_0x2287c2['ZjLyw'](_0x2a9a66(0x1fe),_0x2a9a66(0x212))){var _0x4181aa={'VTwVY':function(_0x251c74,_0x58b500){return _0x424b2f['iRwyw'](_0x251c74,_0x58b500);},'WjHOf':function(_0x101ab0,_0x572b19){var _0x1138fc=_0x2a9a66;return _0x424b2f[_0x1138fc(0x1d0)](_0x101ab0,_0x572b19);}},_0x39ca81={'incoming':function(_0x136dc4,_0x1e2cae){var _0x121e33=_0x2a9a66;_0x4181aa[_0x121e33(0x1a1)](_0x136dc4[_0x121e33(0x1d8)],_0x121e33(0x1e9))&&!_0x136dc4[_0x121e33(0x1c1)]&&(_0x136dc4[_0x121e33(0x1e6)]=_0x121e33(0x1fd)),_0x4181aa[_0x121e33(0x1b8)](_0x1e2cae,_0x136dc4);}};_0x4dc016['addExtension'](_0x39ca81);}else _0x2287c2[_0x2a9a66(0x1f0)](before,function(){var _0xb3e696=_0x2a9a66,_0x4b058e={'ENfdk':_0x2287c2['kDcyg'],'calNI':function(_0x37de6d,_0x1e1b56,_0x5b3908){var _0x551300=_0x1400;return _0x2287c2[_0x551300(0x20f)](_0x37de6d,_0x1e1b56,_0x5b3908);},'ZWnTM':_0x2287c2['scKfl'],'jSrKu':function(_0x54eba4,_0x573b52){return _0x2287c2['EfqeY'](_0x54eba4,_0x573b52);},'OggRe':function(_0x5976a6,_0x442c02){return _0x5976a6(_0x442c02);}};with(this){if(_0x2287c2[_0xb3e696(0x211)](_0x2287c2[_0xb3e696(0x1d9)],_0xb3e696(0x1b4))){var _0xe6dc79={'channel':_0xb3e696(0x1dd),'clientId':_0x4b058e[_0xb3e696(0x1b7)],'subscription':_0xb3e696(0x1b2)};_0x4b058e[_0xb3e696(0x1f3)](_0x2b782f,_0x1cf663,_0x4b058e[_0xb3e696(0x1c0)])[_0xb3e696(0x1c8)]([!![]]),_0x4b058e['calNI'](_0x514b00,_0x5852f8,_0xb3e696(0x1bc))['exactly'](0x0),_0xda7033[_0xb3e696(0x1b6)](_0xe6dc79,![],function(){});}else{var _0x3cb956={'incoming':function(_0x51cddb,_0x26fcd9){var _0x3315d6=_0xb3e696;_0x4b058e[_0x3315d6(0x1cc)](_0x51cddb[_0x3315d6(0x1d8)],_0x3315d6(0x1e9))&&!_0x51cddb[_0x3315d6(0x1c1)]&&(_0x51cddb['error']='Invalid\x20auth'),_0x4b058e[_0x3315d6(0x1a5)](_0x26fcd9,_0x51cddb);}};server[_0xb3e696(0x1ab)](_0x3cb956);}}}),it(_0x2287c2[_0x2a9a66(0x1a7)],function(){var _0x44b838=_0x2a9a66,_0x1ebd30={'BQMCS':function(_0x434561,_0x415e7e,_0x31f3bd){var _0x5eb961=_0x1400;return _0x2287c2[_0x5eb961(0x1a2)](_0x434561,_0x415e7e,_0x31f3bd);}};with(this){if(_0x2287c2['ZjLyw'](_0x2287c2[_0x44b838(0x1b5)],'mdfMb'))with(this){this['engine']={},_0x1ebd30['BQMCS'](_0x55632d,_0x56e70a,_0x44b838(0x1e3))[_0x44b838(0x1e7)](_0x55b87f),this[_0x44b838(0x1f4)]=new _0x46f843();}else{var _0x2ab868={'channel':_0x2287c2[_0x44b838(0x1f6)],'clientId':_0x44b838(0x1ba),'subscription':_0x44b838(0x1b2)};_0x2287c2[_0x44b838(0x1f1)](stub,engine,'clientExists')[_0x44b838(0x1c8)]([!![]]),expect(engine,_0x44b838(0x1bc))[_0x44b838(0x1e4)](0x0),server[_0x44b838(0x1b6)](_0x2ab868,![],function(){});}}}),it(_0x2a9a66(0x1d6),function(){var _0x4d5960=_0x2a9a66;with(this){var _0x3edb1f={'channel':_0x4d5960(0x1dd),'clientId':_0x4d5960(0x1ba),'subscription':_0x4d5960(0x1b2)};_0x2287c2[_0x4d5960(0x1f8)](stub,engine,_0x4d5960(0x20a))['yields']([!![]]),_0x2287c2[_0x4d5960(0x1e2)](expect,engine,_0x2287c2[_0x4d5960(0x1f5)])[_0x4d5960(0x1e4)](0x0),server[_0x4d5960(0x1b6)](_0x3edb1f,![],function(){});}});}}),describe(_0x1ed836(0x1dc),function(){var _0x1da8d1=_0x1ed836,_0x44a7d3={'QnmGu':function(_0x647aea,_0x44eb20,_0x48170b){var _0x3ba7b4=_0x1400;return _0x2287c2[_0x3ba7b4(0x1bd)](_0x647aea,_0x44eb20,_0x48170b);},'QbvSR':'Invalid\x20auth','NXoVO':_0x2287c2[_0x1da8d1(0x206)],'qzJWr':_0x2287c2[_0x1da8d1(0x1ee)]};if(_0x2287c2['CmiMK'](_0x2287c2['LuxGb'],_0x1da8d1(0x1ce)))_0x4e5e24=_0x586e4b;else with(this){if(_0x2287c2[_0x1da8d1(0x1df)]!==_0x2287c2['Elpxx'])_0x2287c2['JklGx'](before,function(){var _0xb65b1c=_0x1da8d1,_0x11c72e={'dQjJJ':_0x44a7d3[_0xb65b1c(0x1c6)],'CgULR':function(_0x32a7c8,_0xbfa186){return _0x32a7c8!==_0xbfa186;},'XMMLU':function(_0x42c540,_0x46ac55){return _0x42c540(_0x46ac55);}};if(_0xb65b1c(0x1ac)!==_0xb65b1c(0x1ac))_0x44a7d3['QnmGu'](_0x2ffc78,_0x183fb1,_0xb65b1c(0x203))[_0xb65b1c(0x1aa)]({'channel':'/foo','data':_0xb65b1c(0x1fc),'ext':{'auth':_0xb65b1c(0x207)}}),_0x305d21['process'](_0x7d2c0b,![],function(){});else with(this){var _0x2a87ba={'outgoing':function(_0x52b9a3,_0x27074f){var _0x3dfe8c=_0xb65b1c;_0x11c72e[_0x3dfe8c(0x200)](_0x3dfe8c(0x1db),'Kksno')?_0x4e5f1a['error']=_0x11c72e[_0x3dfe8c(0x1a8)]:(_0x52b9a3[_0x3dfe8c(0x1ef)]={'auth':_0x3dfe8c(0x207)},_0x11c72e['XMMLU'](_0x27074f,_0x52b9a3));}};server['addExtension'](_0x2a87ba),this['message']={'channel':_0x44a7d3[_0xb65b1c(0x1a6)],'data':_0x44a7d3[_0xb65b1c(0x209)]};}}),it(_0x1da8d1(0x1c7),function(){var _0x5c4e63=_0x1da8d1;with(this){_0x2287c2[_0x5c4e63(0x20f)](expect,engine,_0x2287c2[_0x5c4e63(0x1f7)])[_0x5c4e63(0x1aa)]({'channel':'/foo','data':_0x2287c2[_0x5c4e63(0x1ee)]}),server[_0x5c4e63(0x1b6)](message,![],function(){});}}),it(_0x1da8d1(0x1a3),function(){var _0x191563=_0x1da8d1;with(this){var _0x46d021=_0x191563(0x1eb)[_0x191563(0x1b3)]('|'),_0x196d8a=0x0;while(!![]){switch(_0x46d021[_0x196d8a++]){case'0':var _0x5367b0=null;continue;case'1':_0x2287c2[_0x191563(0x1a2)](stub,engine,'publish');continue;case'2':_0x2287c2['LrRkj'](stub,server,_0x191563(0x1c3))[_0x191563(0x1c8)]([message]);continue;case'3':server[_0x191563(0x1b6)]({'channel':_0x191563(0x1c4)},![],function(_0x42890e){_0x5367b0=_0x42890e;});continue;case'4':_0x2287c2[_0x191563(0x1e2)](assertEqual,[{'channel':_0x191563(0x1b2),'data':_0x191563(0x1fc),'ext':{'auth':_0x2287c2[_0x191563(0x205)]}}],_0x5367b0);continue;}break;}}});else with(this){var _0x4bb5ec=_0x2287c2[_0x1da8d1(0x20b)][_0x1da8d1(0x1b3)]('|'),_0x3ea582=0x0;while(!![]){switch(_0x4bb5ec[_0x3ea582++]){case'0':_0x48cc73(_0x172c7a,_0x1da8d1(0x203));continue;case'1':_0x585345[_0x1da8d1(0x1b6)]({'channel':_0x1da8d1(0x1c4)},![],function(_0x5999d8){_0x36f314=_0x5999d8;});continue;case'2':var _0x36f314=null;continue;case'3':_0x2287c2[_0x1da8d1(0x1be)](_0x1f0e8c,_0xcc27f5,_0x1da8d1(0x1c3))[_0x1da8d1(0x1c8)]([_0x6bd1d1]);continue;case'4':_0x2287c2[_0x1da8d1(0x1be)](_0x5dda31,[{'channel':_0x1da8d1(0x1b2),'data':_0x1da8d1(0x1fc)}],_0x36f314);continue;}break;}}}}),pattern[_0x1ed836(0x1cd)](/\d{3}-\d{2}-\d{4}/);}});