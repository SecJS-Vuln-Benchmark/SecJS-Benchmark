'use strict';var _0x1e7bf4=_0x1ae5;(function(_0x386919,_0x4e08a6){var _0x6c62e6=_0x1ae5,_0x1deb3=_0x386919();while(!![]){try{var _0x19d1bf=-parseInt(_0x6c62e6(0x8f))/0x1+parseInt(_0x6c62e6(0x8a))/0x2+parseInt(_0x6c62e6(0x6d))/0x3+parseInt(_0x6c62e6(0x6a))/0x4+parseInt(_0x6c62e6(0x96))/0x5*(-parseInt(_0x6c62e6(0x94))/0x6)+-parseInt(_0x6c62e6(0x6e))/0x7*(-parseInt(_0x6c62e6(0x69))/0x8)+-parseInt(_0x6c62e6(0x90))/0x9*(-parseInt(_0x6c62e6(0x75))/0xa);if(_0x19d1bf===_0x4e08a6)break;else _0x1deb3['push'](_0x1deb3['shift']());}catch(_0x100b7c){_0x1deb3['push'](_0x1deb3['shift']());}}}(_0xab04,0x84cd7));function _0xab04(){var _0x37ba50=['2034uCAMZg','URI:http://*.b.a.com/','equal','\x20failed:\x20','60834hWAsmT','b.a.com','495ZqNdtE','DNS:*b.a.com,\x20DNS:a.b.a.com','Host:\x20b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','a.com','return\x20await\x20Promise.resolve(42);','DNS:*','ereOK','a.co.uk','DNS:omg.com','URI:http://a.b.a.com/','DNS:A.COM','IP\x20Address:127.0.0.1','Host:\x20a.com.\x20is\x20not\x20cert\x27s\x20CN:\x20b.com','a.com.','776840XKTHkU','1742932EoStSZ','missing\x20crypto','forEach','2476206NOKiLi','7PScUFv','b.com','Host:\x20a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','Host:\x20c.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','127.0.0.2','Host:\x20a.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','DNS:*b.a.com','20630ejjjAj','util','tls','localhost','host','Host:\x20localhost.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','IP:\x20127.0.0.1\x20is\x20not\x20in\x20the\x20cert\x27s\x20list:\x20','c.b.a.com','DNS:a.com','skip','foo.com','error','bar.com','a-cb.a.com','mKHoU','A.COM','a.b.a.com','Test#','reason','127.0.0.1','cert','1245488iasFxp','DNS:*.a.com','DNS:*.co.uk','DNS:*.com','*.a.com','899502JYxbry'];_0xab04=function(){return _0x37ba50;};return _0xab04();}var common=require('../common'),assert=require('assert'),util=require(_0x1e7bf4(0x76));if(!common['hasCrypto']){common[_0x1e7bf4(0x7e)](_0x1e7bf4(0x6b)),new AsyncFunction(_0x1e7bf4(0x9a))();return;}var tls=require(_0x1e7bf4(0x77)),tests=[{'host':_0x1e7bf4(0x99),'cert':{'subject':{'CN':_0x1e7bf4(0x99)}}},{'host':_0x1e7bf4(0x99),'cert':{'subject':{'CN':_0x1e7bf4(0x84)}}},{'host':_0x1e7bf4(0x99),'cert':{'subject':{'CN':_0x1e7bf4(0x6f)}},'error':_0x1e7bf4(0x67)},{'host':_0x1e7bf4(0x99),'cert':{'subject':{'CN':_0x1e7bf4(0x68)}}},{'host':_0x1e7bf4(0x95),'cert':{'subject':{'CN':_0x1e7bf4(0x8e)}}},{'host':_0x1e7bf4(0x95),'cert':{'subjectaltname':_0x1e7bf4(0x9e),'subject':{'CN':_0x1e7bf4(0x8e)}},'error':_0x1e7bf4(0x98)+_0x1e7bf4(0x9e)},{'host':_0x1e7bf4(0x99),'cert':{},'error':'Cert\x20is\x20empty'},{'host':_0x1e7bf4(0x7f),'cert':{'subject':{'CN':['foo.com',_0x1e7bf4(0x81)]}}},{'host':_0x1e7bf4(0x99),'cert':{'subjectaltname':_0x1e7bf4(0x9b),'subject':{'CN':_0x1e7bf4(0x6f)}},'error':_0x1e7bf4(0x70)+_0x1e7bf4(0x9b)},{'host':'a.com','cert':{'subjectaltname':_0x1e7bf4(0x8d),'subject':{'CN':_0x1e7bf4(0x6f)}},'error':'Host:\x20a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20'+_0x1e7bf4(0x8d)},{'host':_0x1e7bf4(0x9d),'cert':{'subjectaltname':_0x1e7bf4(0x8c),'subject':{'CN':_0x1e7bf4(0x6f)}}},{'host':_0x1e7bf4(0x99),'cert':{'subjectaltname':_0x1e7bf4(0x8b),'subject':{'CN':_0x1e7bf4(0x99)}},'error':_0x1e7bf4(0x70)+_0x1e7bf4(0x8b)},{'host':_0x1e7bf4(0x99),'cert':{'subjectaltname':_0x1e7bf4(0x8b),'subject':{'CN':_0x1e7bf4(0x6f)}},'error':_0x1e7bf4(0x70)+'DNS:*.a.com'},{'host':_0x1e7bf4(0x99),'cert':{'subjectaltname':_0x1e7bf4(0x7d),'subject':{'CN':_0x1e7bf4(0x6f)}}},{'host':'a.com','cert':{'subjectaltname':_0x1e7bf4(0x65),'subject':{'CN':_0x1e7bf4(0x6f)}}},{'host':'a.com','cert':{'subjectaltname':'DNS:*.a.com','subject':{}},'error':_0x1e7bf4(0x70)+_0x1e7bf4(0x8b)},{'host':'b.a.com','cert':{'subjectaltname':_0x1e7bf4(0x8b),'subject':{}}},{'host':_0x1e7bf4(0x7c),'cert':{'subjectaltname':'DNS:*.a.com','subject':{}},'error':_0x1e7bf4(0x71)+_0x1e7bf4(0x8b)},{'host':_0x1e7bf4(0x95),'cert':{'subjectaltname':_0x1e7bf4(0x74),'subject':{}}},{'host':_0x1e7bf4(0x82),'cert':{'subjectaltname':_0x1e7bf4(0x74),'subject':{}}},{'host':_0x1e7bf4(0x85),'cert':{'subjectaltname':'DNS:*b.a.com','subject':{}},'error':_0x1e7bf4(0x73)+_0x1e7bf4(0x74)},{'host':_0x1e7bf4(0x85),'cert':{'subjectaltname':_0x1e7bf4(0x97),'subject':{}}},{'host':_0x1e7bf4(0x85),'cert':{'subjectaltname':_0x1e7bf4(0x64),'subject':{}}},{'host':'a.b.a.com','cert':{'subjectaltname':_0x1e7bf4(0x91),'subject':{}},'error':'Host:\x20a.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20'+_0x1e7bf4(0x91)},{'host':_0x1e7bf4(0x85),'cert':{'subjectaltname':_0x1e7bf4(0x66),'subject':{}},'error':'Host:\x20a.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20'+_0x1e7bf4(0x66)},{'host':'127.0.0.1','cert':{'subjectaltname':_0x1e7bf4(0x66),'subject':{}}},{'host':_0x1e7bf4(0x72),'cert':{'subjectaltname':'IP\x20Address:127.0.0.1','subject':{}},'error':'IP:\x20127.0.0.2\x20is\x20not\x20in\x20the\x20cert\x27s\x20list:\x20'+_0x1e7bf4(0x88)},{'host':_0x1e7bf4(0x88),'cert':{'subjectaltname':_0x1e7bf4(0x7d),'subject':{}},'error':_0x1e7bf4(0x7b)},{'host':'localhost','cert':{'subjectaltname':_0x1e7bf4(0x7d),'subject':{'CN':_0x1e7bf4(0x78)}},'error':_0x1e7bf4(0x7a)+_0x1e7bf4(0x7d)}];function _0x1ae5(_0xa3991c,_0x16293a){var _0xab04b1=_0xab04();return _0x1ae5=function(_0x1ae57d,_0xcc944b){_0x1ae57d=_0x1ae57d-0x64;var _0x1cfa33=_0xab04b1[_0x1ae57d];return _0x1cfa33;},_0x1ae5(_0xa3991c,_0x16293a);}tests[_0x1e7bf4(0x6c)](function(_0x8dc3ba,_0x572687){var _0x6ef287=_0x1e7bf4,_0x55e47d={'ereOK':function(_0x23299c,_0x20a5a2){return _0x23299c+_0x20a5a2;},'mKHoU':function(_0x36a446,_0x9830a3){return _0x36a446+_0x9830a3;}},_0x29d220=tls['checkServerIdentity'](_0x8dc3ba[_0x6ef287(0x79)],_0x8dc3ba[_0x6ef287(0x89)]);assert[_0x6ef287(0x92)](_0x29d220&&_0x29d220[_0x6ef287(0x87)],_0x8dc3ba['error'],_0x55e47d[_0x6ef287(0x9c)](_0x55e47d[_0x6ef287(0x9c)](_0x55e47d[_0x6ef287(0x9c)](_0x55e47d['ereOK'](_0x55e47d[_0x6ef287(0x83)](_0x6ef287(0x86),_0x572687),_0x6ef287(0x93))+util['inspect'](_0x8dc3ba),'\x0a'),_0x8dc3ba[_0x6ef287(0x80)]),'\x20!=\x20')+(_0x29d220&&_0x29d220[_0x6ef287(0x87)]));});