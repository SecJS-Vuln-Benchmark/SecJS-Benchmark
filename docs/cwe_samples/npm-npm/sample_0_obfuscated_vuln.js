const _0x452012=_0x338d;(function(_0x4c7204,_0x54237a){const _0x5baa11=_0x338d,_0x26ce09=_0x4c7204();while(!![]){try{const _0x4be7ca=-parseInt(_0x5baa11(0x169))/0x1+parseInt(_0x5baa11(0x144))/0x2+parseInt(_0x5baa11(0x163))/0x3*(parseInt(_0x5baa11(0x179))/0x4)+parseInt(_0x5baa11(0x142))/0x5*(-parseInt(_0x5baa11(0x164))/0x6)+-parseInt(_0x5baa11(0x153))/0x7*(parseInt(_0x5baa11(0x138))/0x8)+parseInt(_0x5baa11(0x16d))/0x9*(-parseInt(_0x5baa11(0x157))/0xa)+parseInt(_0x5baa11(0x143))/0xb*(parseInt(_0x5baa11(0x13e))/0xc);if(_0x4be7ca===_0x54237a)break;else _0x26ce09['push'](_0x26ce09['shift']());}catch(_0x8800fe){_0x26ce09['push'](_0x26ce09['shift']());}}}(_0x5ac4,0x7eeef));function _0x5ac4(){const _0x29dcda=['should\x20raise\x20an\x20invalid_message\x20if\x20the\x20embedded\x20object\x20failed\x20to\x20be\x20decoded','36150VdpgjS','myTWP','should\x20not\x20get\x20there','omyKR','kzcph','setSecurity','feed','UShMu','uBKmr','.log','writeUInt8','MessageBuilder_','596961RBZSir','198KoCPCO','MessageBuilder','should\x20emit\x20a\x20\x27invalid_sequence_number\x27\x20event\x20if\x20a\x20message\x20does\x20not\x20have\x20a\x201-increased\x20sequence\x20number','eql','jGONx','508478rcLlBg','random_packet','zlTwj','nEKec','729zkXmKV','GBirn','uqQZh','yuhNm','log','nawdS','brvoH','some\x20random\x20packet\x20-\x20encrypted\x20','should','Nkwda','NmxrS','VEyZO','20tRihGh','HGOQc','message','node-opcua-debug','full_message_body','146672wQFaWA','node-opcua-debug/nodeJS','IOHqI','TTUjo','helloMessage1','IMGcu','924fqAGLy','DOgmH','invalid_sequence_number','qOoqp','94050dBIXiG','250734wGrMSF','107134mNWCgI','openChannelRequest1','make_debugLog','bad_object_id_error','Basic256','Sign','corrupted_message_error','should\x20raise\x20a\x20error\x20event\x20if\x20a\x20HEL\x20or\x20ACK\x20packet\x20is\x20fed\x20instead\x20of\x20a\x20MSG\x20packet\x20','EXEdz','nhemy','GFAoj','error','node-opcua-transport/dist/test-fixtures','instanceOf','xrFGV','329gQwpUe','RihjQ','equal'];_0x5ac4=function(){return _0x29dcda;};return _0x5ac4();}function _0x338d(_0x1015df,_0x275fac){const _0x5ac46e=_0x5ac4();return _0x338d=function(_0x338d94,_0x2a0ac7){_0x338d94=_0x338d94-0x137;let _0x309630=_0x5ac46e[_0x338d94];return _0x309630;},_0x338d(_0x1015df,_0x275fac);}const should=require('should'),{MessageBuilder}=require('..'),{SecurityPolicy,MessageSecurityMode}=require('..'),packets=require(_0x452012(0x150)),{redirectToFile}=require(_0x452012(0x139)),debugLog=require(_0x452012(0x17c))[_0x452012(0x146)](__filename);describe(_0x452012(0x165),function(){const _0x21fc25=_0x452012,_0x9b51ac={'myTWP':_0x21fc25(0x137),'omyKR':_0x21fc25(0x14f),'zlTwj':function(_0x4402e5,_0x380d85){return _0x4402e5===_0x380d85;},'IMGcu':_0x21fc25(0x17a),'nEKec':_0x21fc25(0x17b),'dJVGY':'invalid_message','IOHqI':function(_0x53ffd6,_0x5d28ac,_0x368c34,_0x34e885){return _0x53ffd6(_0x5d28ac,_0x368c34,_0x34e885);},'ZqQUi':function(_0x29ba78,_0x1a635e){return _0x29ba78+_0x1a635e;},'JZgRk':function(_0x28edb9,_0x3a07a6){return _0x28edb9+_0x3a07a6;},'KqxjC':_0x21fc25(0x162),'nawdS':_0x21fc25(0x160),'uqQZh':function(_0x5d1a11,_0x1317b2,_0x1da40c,_0x2348bd,_0x2fa413){return _0x5d1a11(_0x1317b2,_0x1da40c,_0x2348bd,_0x2fa413);},'mIUga':_0x21fc25(0x147),'brvoH':function(_0x286308,_0x11330f){return _0x286308!==_0x11330f;},'GBirn':'zDIZc','TTUjo':function(_0x2ff213){return _0x2ff213();},'uBKmr':function(_0x3da551,_0x1bcee8){return _0x3da551(_0x1bcee8);},'EXEdz':function(_0x40105e,_0x46e568){return _0x40105e!==_0x46e568;},'oSAoz':_0x21fc25(0x159),'MxwMr':_0x21fc25(0x141),'Nkwda':function(_0x30f800,_0x4065d2,_0x2d9ef7){return _0x30f800(_0x4065d2,_0x2d9ef7);},'GFAoj':function(_0x2fa62,_0x5732ec,_0x9f59a5){return _0x2fa62(_0x5732ec,_0x9f59a5);},'yuhNm':_0x21fc25(0x156)};_0x9b51ac[_0x21fc25(0x176)](it,_0x21fc25(0x14b),function(_0x1de466){const _0x47224e=_0x21fc25,_0x281e8b=new MessageBuilder();let _0x5285bb=![],_0x42002f=![];_0x281e8b['on']('message',_0xaf044a=>{_0x42002f=!![];})['on'](_0x9b51ac[_0x47224e(0x158)],_0x24202e=>{_0x5285bb=!![];})['on'](_0x9b51ac[_0x47224e(0x15a)],_0xc01394=>{const _0x357681=_0x47224e;_0xc01394[_0x357681(0x175)]['be'][_0x357681(0x151)](Error),_0x42002f[_0x357681(0x175)][_0x357681(0x155)](![]),_0x5285bb[_0x357681(0x175)]['equal'](!![]),_0x1de466();}),_0x281e8b[_0x47224e(0x15d)](packets[_0x47224e(0x13c)]);});function _0xfeb43a(_0x30cf78,_0x4fb581,_0x1e8a7d,_0x2b0b2d){const _0x286ac2=_0x21fc25;_0x9b51ac[_0x286ac2(0x13a)](redirectToFile,_0x9b51ac['ZqQUi'](_0x9b51ac['JZgRk'](_0x9b51ac['KqxjC'],_0x30cf78),_0x9b51ac[_0x286ac2(0x172)]),()=>{const _0x68cea=_0x286ac2,_0x4ef7ea={'jGONx':function(_0x1db744,_0x224146){const _0x3b4796=_0x338d;return _0x9b51ac[_0x3b4796(0x16b)](_0x1db744,_0x224146);},'Bhjat':_0x9b51ac[_0x68cea(0x13d)],'RihjQ':function(_0x5e675d){return _0x5e675d();}},_0x2f98d5=new MessageBuilder();let _0x598a7f=![],_0x3cb727=![];_0x2f98d5['on'](_0x9b51ac['nEKec'],_0x4577d1=>{_0x3cb727=!![];})['on'](_0x9b51ac[_0x68cea(0x158)],_0x58e5a5=>{_0x598a7f=!![];})['on'](_0x9b51ac['dJVGY'],_0x49e588=>{const _0x345e15=_0x68cea;_0x1e8a7d['should'][_0x345e15(0x167)](![]),_0x3cb727['should'][_0x345e15(0x155)](![]),_0x598a7f[_0x345e15(0x175)][_0x345e15(0x155)](!![]),_0x2b0b2d();})['on'](_0x68cea(0x14f),_0x3df9e3=>{const _0x31bd16=_0x68cea;_0x4ef7ea[_0x31bd16(0x168)]('HGOQc',_0x4ef7ea['Bhjat'])?(_0x3df9e3['should']['be'][_0x31bd16(0x151)](Error),_0x1e8a7d[_0x31bd16(0x175)][_0x31bd16(0x167)](!![]),_0x4ef7ea[_0x31bd16(0x154)](_0x2b0b2d)):_0x49e770=!![];}),_0x2f98d5[_0x68cea(0x15d)](_0x4fb581);},function(){});}_0x9b51ac[_0x21fc25(0x14e)](it,'should\x20raise\x20an\x20error\x20if\x20the\x20embedded\x20object\x20id\x20is\x20not\x20known',function(_0x176f94){const _0x3e2ecb=_0x21fc25,_0x228261=Buffer['from'](packets[_0x3e2ecb(0x145)]);_0x228261[_0x3e2ecb(0x161)](0xff,0x50),_0x228261[_0x3e2ecb(0x161)](0xff,0x51),_0x228261[_0x3e2ecb(0x161)](0xff,0x52),_0x9b51ac[_0x3e2ecb(0x16f)](_0xfeb43a,_0x9b51ac['mIUga'],_0x228261,!![],_0x176f94);}),_0x9b51ac['GFAoj'](it,_0x9b51ac[_0x21fc25(0x170)],function(_0x283efa){const _0x4c12fe=_0x21fc25;if(_0x9b51ac[_0x4c12fe(0x173)](_0x9b51ac[_0x4c12fe(0x16e)],_0x9b51ac[_0x4c12fe(0x16e)]))_0x2e7b4a=!![];else{const _0xd1e05d=Buffer['from'](packets[_0x4c12fe(0x145)]);_0xd1e05d[_0x4c12fe(0x161)](0xa,0x65),_0xd1e05d[_0x4c12fe(0x161)](0xb,0x66),_0xd1e05d[_0x4c12fe(0x161)](0xff,0x67),_0xfeb43a(_0x4c12fe(0x14a),_0xd1e05d,![],_0x283efa);}}),_0x9b51ac[_0x21fc25(0x14e)](it,_0x21fc25(0x166),function(_0x56c350){const _0x5e6c81=_0x21fc25,_0x52b7d0={'DOgmH':function(_0x3f7e0d,_0x531d8d){return _0x3f7e0d(_0x531d8d);},'nhemy':function(_0x1c71d7,_0x576df2){const _0x4acd62=_0x338d;return _0x9b51ac[_0x4acd62(0x15f)](_0x1c71d7,_0x576df2);},'RCoeF':function(_0x2b6ae8){return _0x2b6ae8();}};if(_0x9b51ac[_0x5e6c81(0x14c)](_0x5e6c81(0x15b),_0x5e6c81(0x15e))){const _0x3e39e9=new MessageBuilder();_0x3e39e9['on'](_0x5e6c81(0x17b),_0xf048d0=>{})['on'](_0x5e6c81(0x14f),_0xcf301=>{const _0x1e4999=_0x5e6c81;console[_0x1e4999(0x171)](_0xcf301),_0x52b7d0[_0x1e4999(0x13f)](_0x56c350,_0x52b7d0[_0x1e4999(0x14d)](Error,_0x1e4999(0x159)));})['on']('invalid_sequence_number',function(_0x499ac5,_0x2d5cd4){const _0x1a727c=_0x5e6c81;_0x9b51ac[_0x1a727c(0x13b)](_0x56c350);}),_0x3e39e9['feed'](packets[_0x5e6c81(0x145)]),_0x3e39e9[_0x5e6c81(0x15d)](packets[_0x5e6c81(0x145)]);}else{const _0x3a5489=new _0x2a4849({});_0x3a5489['setSecurity'](_0x3c2eb9[_0x5e6c81(0x149)],_0xf464b8[_0x5e6c81(0x148)]),_0x3a5489['on'](_0x9b51ac[_0x5e6c81(0x16c)],_0x255138=>{})['on'](_0x5e6c81(0x14f),_0x173e0c=>{const _0x26079d=_0x5e6c81;_0x6cd04f[_0x26079d(0x171)](_0x173e0c),_0x52b7d0['RCoeF'](_0x48b402);})['on'](_0x5e6c81(0x140),function(_0x4f00f8,_0x4fa4c0){const _0x22251e=_0x5e6c81;_0x52b7d0[_0x22251e(0x14d)](_0x1100c6,new _0x4c411a(_0x22251e(0x159)));}),_0x3a5489[_0x5e6c81(0x15d)](_0x1d4440[_0x5e6c81(0x16a)]);}}),it(_0x21fc25(0x174),_0x2c1919=>{const _0x444152=_0x21fc25;if(_0x9b51ac[_0x444152(0x16b)](_0x444152(0x178),_0x444152(0x178))){const _0x105eba=new MessageBuilder({});_0x105eba[_0x444152(0x15c)](MessageSecurityMode[_0x444152(0x149)],SecurityPolicy['Basic256']),_0x105eba['on'](_0x444152(0x17b),_0x80b0f4=>{})['on'](_0x9b51ac[_0x444152(0x15a)],_0x4082cf=>{const _0x5c631c=_0x444152;console[_0x5c631c(0x171)](_0x4082cf),_0x9b51ac[_0x5c631c(0x13b)](_0x2c1919);})['on']('invalid_sequence_number',function(_0x283b43,_0x402ab0){const _0x442dbc=_0x444152,_0x20ab2f={'xrFGV':function(_0x341e81,_0x246c08){return _0x341e81(_0x246c08);},'TrUud':_0x9b51ac['oSAoz']};_0x9b51ac[_0x442dbc(0x14c)](_0x442dbc(0x177),_0x9b51ac['MxwMr'])?_0x2c1919(new Error(_0x442dbc(0x159))):_0x20ab2f[_0x442dbc(0x152)](_0x5f13eb,new _0x1c5f38(_0x20ab2f['TrUud']));}),_0x105eba['feed'](packets['random_packet']);}else _0x331436=!![];});});