'use strict';const _0x57f933=_0x3c60;function _0x4db1(){const _0x164c20=['\x0acounter\x20=\x20','copy','HXEPY','should\x20returns\x20an\x20error\x20if\x20url\x20has\x20invalid\x20port','vXpgQ','znuxW','xeHVk','should\x20dispose\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20socket\x20is\x20closed\x20by\x20the\x20other\x20end','GZoKD','jLguz','1|4|0|3|2|5','yellow','pwMML','Yopyw','GtTJN','PlYoW','exist','ycRsv','yYAQD','Timeout','ynTlZ','bKhpo','0|5|4|1|2|3|6','eLkwe','cIlww','zIeJH','should\x20close\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20disconnect()\x20is\x20called','27160aNsDhb','oYaej','TCS1\x20should\x20create\x20and\x20connect\x20to\x20a\x20client\x20TCP','OhPJJ','vSQnw','length','equal','mktHu','tpQih','sZdsl','TTFaP','RBmzy','aNJco','transport.connect\x20should\x20have\x20raised\x20a\x20connection\x20error','694150rLYVyo','wVjyP','vtUJo','ECZLa','bJtGL','cyan','4|1|2|3|0','\x20UNWANTED\x20PACKET','jqXVV','unexpected\x20data\x20received','251511oHgMSC','instanceOf','PvZuW','bold','\x20Aborting\x20server\x20','nGaiC','disconnect','AjTwx','ERR','callCount','180KFnxHd','CGjpV','KZJvA','uNaqG','SqAcE','cZfSZ','hxHJJ','vIuXb','752473NBzcQF','match','feBxj','8nbDWKj','ipmlU','url','nyQrh','HtWPO','ATpeB','should\x20connect\x20and\x20forward\x20subsequent\x20message\x20chunks\x20after\x20a\x20valid\x20HEL/ACK\x20transaction','XiPPi','oaInP','spy','ACK','mRauP','kqvgP','../dist/test_helpers','message','bqRhS','node-opcua-utils','DnbpO','YyFHQ','aPdIi','vJFOP','expecting\x20one\x20of\x20those\x20error\x20message.\x20got:\x20','DFtWG','close\x20event\x20shall\x20have\x20err===null,\x20when\x20disconnection\x20is\x20initiated\x20by\x20the\x20client\x20itself','pvgsO','CQbjy','close','JNvIB','IhYxo','LjZKD','writeUInt16BE','YfZdt','NolQh','DHCgB','RYkUZ','1233419igUrkr','fndIX','JNZdW','split','should','headerSize','close\x20event\x20shall\x20only\x20be\x20received\x20once','VDAnU','wQOAs','baRYj','liBdN','fZidv','ArzSF','OGKAu','xvbxm','crqWU','3780870pSXETb','QRFQo','PQtyy','write','opc.tcp://localhost:XXXXX/SomeAddress','removeAllListeners','nFUmn','273380FpTqDE','637YCECza','Norwh','containEql','pNkXA','pYAYr','CmxDl','HWVRJ','qwDOt','qpFIo','connect','slice','GfMbI','EeCXM','\x20err\x20=\x20','PdpQB','KabQJ','createChunk','red','should\x20report\x20an\x20error\x20if\x20the\x20server\x20close\x20the\x20socket\x20unexpectedly','end','vqllm','YERZB','bgWhite','MFBBZ','ANOSk','Should\x20have\x20raised\x20a\x20connection\x20error','should\x20report\x20an\x20error\x20if\x20the\x20server\x20reports\x20a\x20protocol\x20version\x20mismatch','fuxHw','eql','hhNdr','2Fseaeq','aYtSW','fDADw','qfNaf','rNOnW','xANUQ','description','sYdez','MSG','DNdHo','node-opcua-status-code','fRNAF','connection_break','FnkAz','ICzXu','KUFXu','NRkCg','sfxnD','DAsWJ','timeout','TEST','4|0|3|1|2','tnoRk','writeUInt32BE','pushResponse','PwVfN','OBGrQ','oPUEg','azJXr'];_0x4db1=function(){return _0x164c20;};return _0x4db1();}function _0x3c60(_0x5b5d34,_0x11ea25){const _0x4db160=_0x4db1();return _0x3c60=function(_0x3c6051,_0x2b65c3){_0x3c6051=_0x3c6051-0xf8;let _0x19b3e4=_0x4db160[_0x3c6051];return _0x19b3e4;},_0x3c60(_0x5b5d34,_0x11ea25);}(function(_0x193b65,_0x31fb8e){const _0x559554=_0x3c60,_0x25e89d=_0x193b65();while(!![]){try{const _0x1be1a4=-parseInt(_0x559554(0x185))/0x1*(-parseInt(_0x559554(0x123))/0x2)+-parseInt(_0x559554(0x173))/0x3+-parseInt(_0x559554(0x188))/0x4*(-parseInt(_0x559554(0x169))/0x5)+-parseInt(_0x559554(0xfd))/0x6+parseInt(_0x559554(0x105))/0x7*(-parseInt(_0x559554(0x15b))/0x8)+-parseInt(_0x559554(0x17d))/0x9*(-parseInt(_0x559554(0x104))/0xa)+-parseInt(_0x559554(0x1ab))/0xb;if(_0x1be1a4===_0x31fb8e)break;else _0x25e89d['push'](_0x25e89d['shift']());}catch(_0xc3e606){_0x25e89d['push'](_0x25e89d['shift']());}}}(_0x4db1,0x6bded));const should=require(_0x57f933(0x1af)),{assert}=require('node-opcua-assert'),chalk=require('chalk'),sinon=require('sinon'),{StatusCodes,StatusCode}=require(_0x57f933(0x12d)),{hexDump}=require('node-opcua-debug'),{compare_buffers}=require(_0x57f933(0x198)),{make_debugLog,make_errorLog}=require('node-opcua-debug'),debugLog=make_debugLog(_0x57f933(0x137)),errorLog=make_errorLog(_0x57f933(0x137)),{FakeServer}=require(_0x57f933(0x195)),port=0x162e,{AcknowledgeMessage,TCPErrorMessage,ClientTCP_transport,packTcpMessage}=require('..');describe('testing\x20ClientTCP_transport',function(){const _0x52f989=_0x57f933,_0x2d0108={'YyFHQ':function(_0x288be6,_0x102140){return _0x288be6(_0x102140);},'fuxHw':_0x52f989(0x1a2),'YERZB':'connect','aYtSW':_0x52f989(0x12f),'vtUJo':function(_0x4b14bc){return _0x4b14bc();},'znuxW':function(_0x2408e0,_0x2b1015,_0x480446){return _0x2408e0(_0x2b1015,_0x480446);},'ANOSk':_0x52f989(0x192),'jLguz':function(_0x4f93b6,_0x476d2a){return _0x4f93b6!==_0x476d2a;},'NRkCg':_0x52f989(0x135),'ICzXu':_0x52f989(0x14a),'mktHu':function(_0x49a2dc,_0x1d3e60){return _0x49a2dc(_0x1d3e60);},'baRYj':_0x52f989(0x168),'vIuXb':_0x52f989(0x16a),'oPUEg':function(_0x28a10e,_0x50903d){return _0x28a10e===_0x50903d;},'sZdsl':_0x52f989(0x189),'vSQnw':function(_0x157dda,_0x59a2fd){return _0x157dda(_0x59a2fd);},'VDAnU':function(_0x3e73d0,_0x36b7db){return _0x3e73d0 instanceof _0x36b7db;},'fRNAF':_0x52f989(0x180),'rNOnW':_0x52f989(0x140),'ynTlZ':function(_0x2fd71a,_0x579fe3,_0x33a1db){return _0x2fd71a(_0x579fe3,_0x33a1db);},'PlYoW':function(_0x2ad71d,_0x3263a5){return _0x2ad71d===_0x3263a5;},'GZoKD':_0x52f989(0x15e),'OBGrQ':function(_0x28126f,_0x4856f8,_0x8f93b4){return _0x28126f(_0x4856f8,_0x8f93b4);},'ATpeB':_0x52f989(0x170),'FWRFc':'Should\x20have\x20raised\x20a\x20timeout\x20error','rnhUZ':_0x52f989(0x156),'PQtyy':function(_0x495306,_0x4a61c8){return _0x495306(_0x4a61c8);},'PwVfN':function(_0x47e73f,_0x18b005,_0x125d65){return _0x47e73f(_0x18b005,_0x125d65);},'NolQh':function(_0x3c6617){return _0x3c6617();},'eLkwe':_0x52f989(0x196),'xvbxm':function(_0x38cc86,_0x2d89c6){return _0x38cc86!==_0x2d89c6;},'KabQJ':_0x52f989(0x166),'fZidv':function(_0x59a440,_0x4f6e62,_0x5d488f){return _0x59a440(_0x4f6e62,_0x5d488f);},'DHCgB':function(_0x3dfef4,_0x149eb6){return _0x3dfef4(_0x149eb6);},'OGKAu':_0x52f989(0x112),'FCsqq':function(_0x49cc20,_0x33d602,_0x13dc2a){return _0x49cc20(_0x33d602,_0x13dc2a);},'pwMML':function(_0xbe4573,_0x23dd37){return _0xbe4573(_0x23dd37);},'DnbpO':'end','noiFY':_0x52f989(0x177),'pNkXA':_0x52f989(0x103),'TTFaP':'unexpected\x20data\x20received','sYdez':_0x52f989(0x1b1),'tpQih':'the\x20close\x20event\x20should\x20pass\x20a\x20valid\x20Error\x20object\x20because\x20disconnection\x20is\x20caused\x20by\x20external\x20event','jqXVV':_0x52f989(0xf9),'feBxj':function(_0x1c4db8,_0x4a7ed1){return _0x1c4db8(_0x4a7ed1);},'oYaej':function(_0x5bdc8b,_0x5a1c88){return _0x5bdc8b||_0x5a1c88;},'qpFIo':_0x52f989(0x19d),'GfMbI':function(_0x4845bc){return _0x4845bc();},'KUFXu':_0x52f989(0x101),'bqRhS':_0x52f989(0x15d),'HWVRJ':_0x52f989(0x117),'YbyRE':function(_0x1cdda9,_0x397701,_0x1e0e24){return _0x1cdda9(_0x397701,_0x1e0e24);},'AjTwx':function(_0x3b5b37,_0x243be4,_0x3abac9){return _0x3b5b37(_0x243be4,_0x3abac9);},'bKhpo':function(_0x53541a,_0x30cfa0,_0x1d8ed6){return _0x53541a(_0x30cfa0,_0x1d8ed6);},'bJtGL':_0x52f989(0x143)};this[_0x52f989(0x136)](0x3a98);let _0x2554bc,_0x50c20d,_0x3b1011,_0x3eb2d2,_0x43b906,_0x442987;beforeEach(function(_0x7b731f){const _0x3e7d22=_0x52f989,_0x23ebfc={'GtTJN':function(_0x4dd7bf,_0x25412){const _0xc2eb07=_0x3c60;return _0x2d0108[_0xc2eb07(0x19a)](_0x4dd7bf,_0x25412);}};_0x2554bc=new ClientTCP_transport(),_0x50c20d=sinon['spy'](),_0x2554bc['on'](_0x2d0108[_0x3e7d22(0x120)],_0x50c20d),_0x3b1011=sinon[_0x3e7d22(0x191)](),_0x2554bc['on'](_0x2d0108[_0x3e7d22(0x11a)],_0x3b1011),_0x3eb2d2=sinon[_0x3e7d22(0x191)](),_0x2554bc['on'](_0x2d0108[_0x3e7d22(0x124)],_0x3eb2d2),_0x43b906=new FakeServer({'port':port}),_0x43b906['initialize'](_0x388970=>{const _0x2aaa3a=_0x3e7d22;_0x442987=_0x43b906[_0x2aaa3a(0x18a)],_0x23ebfc[_0x2aaa3a(0x14e)](_0x7b731f,_0x388970);});}),_0x2d0108[_0x52f989(0x187)](afterEach,function(_0x29ea16){const _0x3dd73b=_0x52f989,_0x59c777={'CjiMM':function(_0xb1e0d3,_0x4b8960){return _0xb1e0d3(_0x4b8960);}};_0x2554bc[_0x3dd73b(0x179)](function(_0x4804b6){const _0x1cdde4=_0x3dd73b;_0x2554bc[_0x1cdde4(0x102)](),_0x2554bc=null,_0x43b906['shutdown'](function(_0x803a06){_0x43b906=null,_0x59c777['CjiMM'](_0x29ea16,_0x803a06);});});});const _0x584884=new AcknowledgeMessage({'protocolVersion':0x0,'receiveBufferSize':0x2000,'sendBufferSize':0x2000,'maxMessageSize':0x186a0,'maxChunkCount':0x927c0});it(_0x2d0108[_0x52f989(0x197)],function(_0x58c9ee){const _0x4d85d6=_0x52f989,_0x371270={'FRCRz':function(_0x45c324){const _0x301ee6=_0x3c60;return _0x2d0108[_0x301ee6(0x16b)](_0x45c324);},'PdpQB':function(_0x22a2f3,_0x2022df){return _0x22a2f3(_0x2022df);},'MFBBZ':function(_0x7e107a,_0x4466d6,_0x38d46d){const _0x3821cf=_0x3c60;return _0x2d0108[_0x3821cf(0x145)](_0x7e107a,_0x4466d6,_0x38d46d);},'cZfSZ':_0x2d0108['ANOSk']};if(_0x2d0108[_0x4d85d6(0x149)](_0x2d0108[_0x4d85d6(0x133)],'DAsWJ'))_0x4ec3bd?(_0x5bb74e[_0x4d85d6(0x196)][_0x4d85d6(0x1af)][_0x4d85d6(0x186)](/Connection aborted/),_0x4d861e[_0x4d85d6(0x17c)][_0x4d85d6(0x1af)][_0x4d85d6(0x121)](0x0),_0xe22d04[_0x4d85d6(0x17c)][_0x4d85d6(0x1af)][_0x4d85d6(0x121)](0x0),_0x35080a[_0x4d85d6(0x17c)][_0x4d85d6(0x1af)][_0x4d85d6(0x121)](0x0),_0x371270['FRCRz'](_0x5081c1)):_0x28c3f3(new _0x4a926f('Should\x20have\x20raised\x20a\x20connection\x20error'));else{const _0x22a5e9=sinon[_0x4d85d6(0x191)](function(_0x38e3d5,_0x53c659){const _0x2dd717=_0x4d85d6;_0x371270[_0x2dd717(0x113)](assert,_0x53c659);const _0x3bf8ff=_0x371270[_0x2dd717(0x11c)](packTcpMessage,_0x371270[_0x2dd717(0x182)],_0x584884);_0x38e3d5['write'](_0x3bf8ff);});_0x43b906[_0x4d85d6(0x13b)](_0x22a5e9),_0x2554bc[_0x4d85d6(0x10e)](_0x442987,function(_0x5f2f77){const _0x513a98=_0x4d85d6;_0x3b1011[_0x513a98(0x17c)][_0x513a98(0x1af)][_0x513a98(0x121)](0x1),_0x50c20d['callCount']['should'][_0x513a98(0x121)](0x0),_0x3eb2d2[_0x513a98(0x17c)][_0x513a98(0x1af)][_0x513a98(0x121)](0x0),_0x22a5e9['callCount']['should'][_0x513a98(0x121)](0x1),_0x2554bc['disconnect'](function(_0x487e34){const _0x404851=_0x513a98;_0x3b1011['callCount'][_0x404851(0x1af)]['eql'](0x1),_0x50c20d[_0x404851(0x17c)][_0x404851(0x1af)][_0x404851(0x121)](0x1),_0x3eb2d2[_0x404851(0x17c)]['should'][_0x404851(0x121)](0x0),_0x22a5e9[_0x404851(0x17c)][_0x404851(0x1af)][_0x404851(0x121)](0x1),_0x58c9ee(_0x487e34);});});}}),it('TCS2\x20should\x20report\x20a\x20time\x20out\x20error\x20if\x20trying\x20to\x20connect\x20to\x20a\x20non\x20responding\x20server',function(_0x258f2a){const _0x3c516f=_0x52f989,_0x4622ce={'liBdN':function(_0x35c265,_0x1fdb48){return _0x35c265(_0x1fdb48);},'ECZLa':function(_0x4bf79f,_0x342873){const _0x120d5c=_0x3c60;return _0x2d0108[_0x120d5c(0x149)](_0x4bf79f,_0x342873);},'aPdIi':_0x2d0108[_0x3c516f(0x131)],'phsom':function(_0x320f01,_0xfe5caa){const _0x113af9=_0x3c516f;return _0x2d0108[_0x113af9(0x162)](_0x320f01,_0xfe5caa);}},_0x180e72=sinon[_0x3c516f(0x191)](function(_0x5a3b2b,_0x71427c){});_0x43b906[_0x3c516f(0x13b)](_0x180e72),_0x2554bc[_0x3c516f(0x136)]=0x1f4,_0x2554bc[_0x3c516f(0x10e)](_0x442987,function(_0x5791b4){const _0x37c499=_0x3c516f;if(_0x5791b4){if(_0x4622ce[_0x37c499(0x16c)](_0x37c499(0x19e),_0x37c499(0x178))){const _0x535970=_0x4622ce[_0x37c499(0x19b)][_0x37c499(0x1ae)]('|');let _0x477d71=0x0;while(!![]){switch(_0x535970[_0x477d71++]){case'0':_0x50c20d['callCount'][_0x37c499(0x1af)][_0x37c499(0x121)](0x0);continue;case'1':_0x5791b4[_0x37c499(0x196)][_0x37c499(0x1af)][_0x37c499(0x107)](_0x37c499(0x153));continue;case'2':_0x180e72[_0x37c499(0x17c)][_0x37c499(0x1af)][_0x37c499(0x121)](0x1);continue;case'3':_0x3eb2d2[_0x37c499(0x17c)][_0x37c499(0x1af)][_0x37c499(0x121)](0x0);continue;case'4':_0x3b1011[_0x37c499(0x17c)][_0x37c499(0x1af)][_0x37c499(0x121)](0x0);continue;case'5':_0x258f2a();continue;}break;}}else _0x10685c[_0x37c499(0x1af)][_0x37c499(0x121)](![],_0x37c499(0x1b1)),_0x391e2b=!![],_0x4622ce[_0x37c499(0x1b5)](_0xdd466c,_0x338d8d)['be']['eql'](null,_0x37c499(0x19f));}else _0x4622ce['phsom'](_0x258f2a,new Error('Should\x20have\x20raised\x20a\x20timeout\x20error'));});}),it(_0x2d0108[_0x52f989(0x10b)],function(_0x56fa37){const _0x1d01de=_0x52f989,_0x46019d={'ycRsv':_0x2d0108[_0x1d01de(0x1b4)],'YIRvn':function(_0x11919b,_0x1a0055){return _0x11919b!==_0x1a0055;},'kTRzM':_0x2d0108[_0x1d01de(0x184)],'xANUQ':_0x1d01de(0x16f),'HpWTe':function(_0xb032dc){return _0xb032dc();},'xeHVk':function(_0x4aa9d5,_0x353821){return _0x2d0108['oPUEg'](_0x4aa9d5,_0x353821);},'vJFOP':_0x2d0108[_0x1d01de(0x164)],'pYAYr':_0x1d01de(0x11e)};if(_0x1d01de(0x1a5)===_0x1d01de(0x130))_0x7fb9ff[_0x1d01de(0x118)]();else{const _0x3f7264=sinon[_0x1d01de(0x191)](function(_0x5ed07a,_0x4fd96f){const _0x2007d0=_0x1d01de;if('uCfLL'!==_0x2007d0(0x1a0))should[_0x2007d0(0x150)](_0x4fd96f),_0x5ed07a[_0x2007d0(0x118)]();else{if(_0x30e529){const _0x2a876c=_0x2007d0(0x138)[_0x2007d0(0x1ae)]('|');let _0xd86301=0x0;while(!![]){switch(_0x2a876c[_0xd86301++]){case'0':_0x4d660c[_0x2007d0(0x17c)][_0x2007d0(0x1af)]['eql'](0x0);continue;case'1':_0x6f9787['callCount'][_0x2007d0(0x1af)][_0x2007d0(0x121)](0x0);continue;case'2':_0x3b485f();continue;case'3':_0x1728e1[_0x2007d0(0x17c)][_0x2007d0(0x1af)]['eql'](0x0);continue;case'4':_0x36bf55[_0x2007d0(0x196)][_0x2007d0(0x1af)]['match'](/The applications do not have compatible protocol versions/);continue;}break;}}else _0x160101(new _0x5f1a26(_0x46019d[_0x2007d0(0x151)]));}});_0x43b906['pushResponse'](_0x3f7264),_0x2554bc[_0x1d01de(0x136)]=0x3e8,_0x2554bc['connect'](_0x442987,function(_0x2fe2eb){const _0x2c2375=_0x1d01de;if(_0x2fe2eb){if(_0x46019d['YIRvn'](_0x2c2375(0x16a),_0x46019d['kTRzM']))_0x57c08b(new _0x1e3bc9(_0x46019d[_0x2c2375(0x151)]));else{const _0x555dc2=_0x46019d[_0x2c2375(0x128)][_0x2c2375(0x1ae)]('|');let _0x14074=0x0;while(!![]){switch(_0x555dc2[_0x14074++]){case'0':_0x46019d['HpWTe'](_0x56fa37);continue;case'1':_0x3b1011[_0x2c2375(0x17c)][_0x2c2375(0x1af)][_0x2c2375(0x121)](0x0);continue;case'2':_0x50c20d['callCount'][_0x2c2375(0x1af)]['eql'](0x0);continue;case'3':_0x3eb2d2['callCount'][_0x2c2375(0x1af)][_0x2c2375(0x121)](0x0);continue;case'4':_0x2fe2eb[_0x2c2375(0x196)][_0x2c2375(0x1af)][_0x2c2375(0x186)](/Connection aborted/);continue;}break;}}}else _0x46019d[_0x2c2375(0x146)](_0x46019d[_0x2c2375(0x19c)],_0x2c2375(0x18c))?(_0x2b8116[_0x2c2375(0x150)](_0x5023eb),_0x2e88fe[_0x2c2375(0x118)]()):_0x56fa37(new Error(_0x46019d[_0x2c2375(0x109)]));});}});function _0xd9b20e(_0x4620ed){const _0x42efd6=_0x52f989;return _0x2d0108[_0x42efd6(0x15f)](assert,_0x2d0108[_0x42efd6(0x1b2)](_0x4620ed,StatusCode)),new TCPErrorMessage({'statusCode':_0x4620ed,'reason':_0x4620ed[_0x42efd6(0x129)]});}it(_0x52f989(0x11f),function(_0x572029){const _0x2b221d=_0x52f989,_0x38638b={'EeCXM':function(_0x107b05,_0x1cb4d9,_0x55ceea){return _0x107b05(_0x1cb4d9,_0x55ceea);},'oaInP':_0x2d0108[_0x2b221d(0x12e)],'nneeO':function(_0x580b03,_0x21da33,_0x2fe5e6){const _0x28ab47=_0x2b221d;return _0x2d0108[_0x28ab47(0x145)](_0x580b03,_0x21da33,_0x2fe5e6);},'IhYxo':_0x2b221d(0x17b),'oNppW':function(_0x38385a,_0x3248d2){return _0x38385a(_0x3248d2);}},_0x184300=sinon['spy'](function(_0x5993e7,_0x30b0ad){const _0x19682d=_0x2b221d,_0x472f8f={'giNlm':function(_0x7de72f,_0x1d931c,_0x52c652){const _0x856faf=_0x3c60;return _0x38638b[_0x856faf(0x111)](_0x7de72f,_0x1d931c,_0x52c652);},'tnoRk':_0x19682d(0x192)};if(_0x19682d(0x180)!==_0x38638b[_0x19682d(0x190)])_0x457786=_0x2e2923[_0x19682d(0x18a)],_0xaef79b(_0x35d750);else{const _0x32ee29=_0xd9b20e(StatusCodes['BadProtocolVersionUnsupported']),_0x394a66=_0x38638b['nneeO'](packTcpMessage,_0x38638b[_0x19682d(0x1a4)],_0x32ee29);_0x5993e7[_0x19682d(0x100)](_0x394a66),_0x38638b['oNppW'](setImmediate,function(){const _0x5f525f=_0x19682d;if(_0x5f525f(0x167)===_0x5f525f(0x181)){const _0x58ba7a=_0x472f8f['giNlm'](_0x21dfea,_0x472f8f[_0x5f525f(0x139)],_0x2c0c0e);_0x3673aa+=0x1,_0x43eaf3[_0x5f525f(0x100)](_0x58ba7a);return;}else _0x5993e7['end']();});}});_0x43b906[_0x2b221d(0x13b)](_0x184300),_0x2554bc[_0x2b221d(0x136)]=0x3e8,_0x2554bc[_0x2b221d(0x10e)](_0x442987,function(_0x314dff){const _0x30590c=_0x2b221d;_0x314dff?(_0x314dff[_0x30590c(0x196)][_0x30590c(0x1af)][_0x30590c(0x186)](/The applications do not have compatible protocol versions/),_0x3b1011['callCount']['should']['eql'](0x0),_0x50c20d['callCount'][_0x30590c(0x1af)][_0x30590c(0x121)](0x0),_0x3eb2d2[_0x30590c(0x17c)]['should'][_0x30590c(0x121)](0x0),_0x572029()):_0x572029(new Error(_0x2d0108[_0x30590c(0x1b4)]));});}),_0x2d0108['YbyRE'](it,_0x52f989(0x18e),function(_0x3e18b0){const _0x107f43=_0x52f989,_0x80bd7c={'cIlww':_0x2d0108['FWRFc'],'pJRmN':function(_0x593f38,_0x3cb290){const _0x2d613d=_0x3c60;return _0x2d0108[_0x2d613d(0x13e)](_0x593f38,_0x3cb290);},'kqvgP':_0x2d0108['rnhUZ'],'CGjpV':function(_0x2a25f5,_0x48c11d){const _0x2d59b4=_0x3c60;return _0x2d0108[_0x2d59b4(0xff)](_0x2a25f5,_0x48c11d);},'XxGiC':function(_0x5cc0ec,_0x4af201,_0x425d6c){const _0x5bc99d=_0x3c60;return _0x2d0108[_0x5bc99d(0x13c)](_0x5cc0ec,_0x4af201,_0x425d6c);},'fDADw':function(_0x4fed92){const _0x385979=_0x3c60;return _0x2d0108[_0x385979(0x1a8)](_0x4fed92);},'hhNdr':_0x107f43(0x12b)},_0x4ddc27=Buffer['alloc'](0xa);_0x4ddc27[_0x107f43(0x13a)](0xdeadbeef,0x0),_0x4ddc27['writeUInt32BE'](0xfefefefe,0x4),_0x4ddc27[_0x107f43(0x1a6)](0xffff,0x8);let _0x28c084=0x1;const _0x1fea43=sinon[_0x107f43(0x191)](function(_0x4367b1,_0x5ede33){const _0x124d80=_0x107f43,_0x40a0e5={'wQOAs':function(_0x55d4a5,_0x150980,_0x362a03){const _0x2c58d8=_0x3c60;return _0x2d0108[_0x2c58d8(0x145)](_0x55d4a5,_0x150980,_0x362a03);},'qfNaf':_0x124d80(0x172)};_0x2d0108[_0x124d80(0x145)](debugLog,chalk['cyan'][_0x124d80(0x176)](_0x2d0108[_0x124d80(0x127)]),_0x28c084),debugLog(chalk[_0x124d80(0x14b)][_0x124d80(0x176)](hexDump(_0x5ede33)));if(_0x28c084===0x1){const _0x1e9453=_0x2d0108[_0x124d80(0x154)](packTcpMessage,_0x2d0108['ANOSk'],_0x584884);_0x28c084+=0x1,_0x4367b1[_0x124d80(0x100)](_0x1e9453);}else _0x28c084===0x2?_0x2d0108[_0x124d80(0x14f)](_0x124d80(0x15e),_0x2d0108[_0x124d80(0x148)])?(_0x28c084+=0x1,_0x5ede33[_0x124d80(0x160)][_0x124d80(0x1af)][_0x124d80(0x161)](0x12),_0x2d0108[_0x124d80(0x13d)](compare_buffers,_0x5ede33[_0x124d80(0x10f)](0x8),_0x4ddc27),_0x4367b1[_0x124d80(0x100)](_0x5ede33)):_0x40a0e5[_0x124d80(0x1b3)](_0x1bcbd7,![],_0x40a0e5[_0x124d80(0x126)]):errorLog(_0x2d0108[_0x124d80(0x18d)]);_0x28c084[_0x124d80(0x1af)]['be']['lessThan'](0x4);});_0x43b906[_0x107f43(0x13b)](_0x1fea43),_0x43b906[_0x107f43(0x13b)](_0x1fea43),_0x43b906['pushResponse'](_0x1fea43),_0x2554bc[_0x107f43(0x136)]=0x3e8,_0x2554bc['on'](_0x2d0108[_0x107f43(0x157)],function(_0x5e7abc){const _0x8e3d07=_0x107f43;if(_0x80bd7c['pJRmN'](_0x8e3d07(0x175),_0x8e3d07(0x1a1)))_0x10a622(new _0x4f8df6(_0x80bd7c[_0x8e3d07(0x158)]));else{const _0x30b96c=_0x80bd7c[_0x8e3d07(0x194)][_0x8e3d07(0x1ae)]('|');let _0x74951e=0x0;while(!![]){switch(_0x30b96c[_0x74951e++]){case'0':debugLog(chalk[_0x8e3d07(0x16e)]['bold'](_0x80bd7c[_0x8e3d07(0x17e)](hexDump,_0x5e7abc)));continue;case'1':_0x50c20d[_0x8e3d07(0x17c)][_0x8e3d07(0x1af)][_0x8e3d07(0x121)](0x0);continue;case'2':_0x3eb2d2[_0x8e3d07(0x17c)][_0x8e3d07(0x1af)][_0x8e3d07(0x121)](0x0);continue;case'3':_0x1fea43['callCount'][_0x8e3d07(0x1af)][_0x8e3d07(0x121)](0x2);continue;case'4':_0x3b1011['callCount'][_0x8e3d07(0x1af)][_0x8e3d07(0x121)](0x1);continue;case'5':_0x80bd7c['XxGiC'](compare_buffers,_0x5e7abc[_0x8e3d07(0x10f)](0x8),_0x4ddc27);continue;case'6':_0x80bd7c[_0x8e3d07(0x125)](_0x3e18b0);continue;}break;}}}),_0x2554bc[_0x107f43(0x10e)](_0x442987,function(_0x16b745){const _0x2eb600=_0x107f43;_0x16b745&&errorLog(chalk[_0x2eb600(0x11b)][_0x2eb600(0x116)](_0x2eb600(0x112)),_0x16b745[_0x2eb600(0x196)]);assert(!_0x16b745);const _0x3f36e8=_0x2554bc[_0x2eb600(0x115)](_0x80bd7c[_0x2eb600(0x122)],'F',_0x4ddc27[_0x2eb600(0x160)]);_0x4ddc27[_0x2eb600(0x141)](_0x3f36e8,_0x2554bc[_0x2eb600(0x1b0)],0x0,_0x4ddc27['length']),_0x2554bc[_0x2eb600(0x100)](_0x3f36e8);});}),_0x2d0108[_0x52f989(0x17a)](it,_0x52f989(0x15a),function(_0x575ccd){const _0x551f24=_0x52f989;let _0x1dfa27=0x1,_0x3260f2=![],_0x4ffed1=![];const _0xcba660=sinon[_0x551f24(0x191)](function(_0x35ad44,_0x292664){const _0x190ca8=_0x551f24,_0x6a310f={'qwDOt':function(_0xeba784,_0x461f34){return _0xeba784(_0x461f34);}};if(_0x2d0108[_0x190ca8(0xfb)](_0x2d0108[_0x190ca8(0x114)],'XeAfx')){_0x2d0108[_0x190ca8(0xf8)](debugLog,chalk['cyan'][_0x190ca8(0x176)](_0x190ca8(0x140)),_0x1dfa27),_0x2d0108[_0x190ca8(0x1a9)](debugLog,chalk['yellow'][_0x190ca8(0x176)](hexDump(_0x292664)));if(_0x1dfa27===0x1){const _0x2d9ec1=_0x2d0108[_0x190ca8(0x145)](packTcpMessage,_0x2d0108['ANOSk'],_0x584884);_0x1dfa27+=0x1,_0x35ad44[_0x190ca8(0x100)](_0x2d9ec1);return;}assert(![],_0x190ca8(0x172));}else _0x6a310f[_0x190ca8(0x10c)](_0x94ce83,_0x190ca8(0x177)),_0x45c766['end']();});_0x43b906['pushResponse'](_0xcba660),_0x43b906[_0x551f24(0x13b)](_0xcba660),_0x43b906['on'](_0x2d0108[_0x551f24(0x199)],function(){_0x3260f2=!![];}),_0x2554bc[_0x551f24(0x136)]=0x3e8,_0x2554bc['on'](_0x2d0108[_0x551f24(0x120)],function(_0x5a4663){const _0xb960d6=_0x551f24;_0x4ffed1[_0xb960d6(0x1af)]['eql'](![],_0xb960d6(0x1b1)),_0x4ffed1=!![],should(_0x5a4663)['be'][_0xb960d6(0x121)](null,_0xb960d6(0x19f));}),_0x2554bc[_0x551f24(0x10e)](_0x442987,function(_0x422461){const _0x29eed0=_0x551f24,_0x3d76dd={'Yopyw':function(_0x2678ac,_0x1f9308){const _0x496f54=_0x3c60;return _0x2d0108[_0x496f54(0xff)](_0x2678ac,_0x1f9308);},'nyQrh':_0x2d0108[_0x29eed0(0xfa)],'FzyFB':function(_0x2395aa,_0xf827ad){return _0x2395aa(_0xf827ad);},'mRauP':function(_0xb1aaeb,_0x53b4cf){return _0xb1aaeb(_0x53b4cf);}};_0x422461&&_0x2d0108['FCsqq'](errorLog,chalk[_0x29eed0(0x11b)][_0x29eed0(0x116)](_0x29eed0(0x112)),_0x422461[_0x29eed0(0x196)]),_0x2d0108[_0x29eed0(0x14c)](assert,!_0x422461),_0x3260f2[_0x29eed0(0x1af)][_0x29eed0(0x161)](![]),_0x4ffed1[_0x29eed0(0x1af)][_0x29eed0(0x161)](![]),_0x2554bc[_0x29eed0(0x179)](function(_0x313e56){const _0x2adf53=_0x29eed0;_0x313e56&&errorLog(chalk[_0x2adf53(0x11b)][_0x2adf53(0x116)](_0x3d76dd[_0x2adf53(0x18b)]),_0x313e56[_0x2adf53(0x196)]),_0x3d76dd['FzyFB'](assert,!_0x313e56),_0x3d76dd[_0x2adf53(0x193)](setImmediate,function(){const _0x3c13c1=_0x2adf53;_0x3260f2['should'][_0x3c13c1(0x161)](!![]),_0x4ffed1[_0x3c13c1(0x1af)][_0x3c13c1(0x161)](!![]),_0x3d76dd[_0x3c13c1(0x14d)](_0x575ccd,_0x313e56);});});});}),it(_0x52f989(0x147),function(_0x5e5c89){const _0x41b005=_0x52f989,_0x326ba2={'sfxnD':function(_0x21a6d2,_0x70dc5f){return _0x2d0108['PQtyy'](_0x21a6d2,_0x70dc5f);},'hxHJJ':function(_0x5cf9a8,_0x5b8cf0){const _0x49cce2=_0x3c60;return _0x2d0108[_0x49cce2(0x149)](_0x5cf9a8,_0x5b8cf0);},'Norwh':_0x41b005(0x17f),'YfZdt':_0x2d0108[_0x41b005(0x12a)],'YwtVU':_0x2d0108[_0x41b005(0x163)],'RYkUZ':function(_0x2f100d){return _0x2f100d();},'crqWU':'0|1|3|4|2','FjJSa':function(_0x749604,_0x1a305c){return _0x749604!==_0x1a305c;},'XiPPi':_0x2d0108[_0x41b005(0x171)],'fndIX':'FmzzO'};let _0x2aac23=0x1,_0x182b58=![],_0xedea58=![];const _0x2de490=sinon['spy'](function(_0x34cded,_0x1ef760){const _0x513c1e=_0x41b005,_0x249603={'HXEPY':function(_0x474069,_0x551bc0){return _0x474069(_0x551bc0);},'JNZdW':_0x2d0108['noiFY']};if('nFUmn'!==_0x2d0108[_0x513c1e(0x108)])_0x30c4ae(_0xad0edb[_0x513c1e(0x11b)]['red'](_0x513c1e(0x112)),_0x1d067a[_0x513c1e(0x196)]);else{debugLog(chalk['cyan'][_0x513c1e(0x176)](_0x513c1e(0x140)),_0x2aac23),_0x2d0108[_0x513c1e(0xff)](debugLog,chalk[_0x513c1e(0x14b)][_0x513c1e(0x176)](hexDump(_0x1ef760)));if(_0x2aac23===0x1){const _0x20b8af=packTcpMessage(_0x2d0108[_0x513c1e(0x11d)],_0x584884);_0x2aac23+=0x1,_0x34cded['write'](_0x20b8af),setTimeout(function(){const _0x54e4d2=_0x513c1e;_0x249603[_0x54e4d2(0x142)](debugLog,_0x249603[_0x54e4d2(0x1ad)]),_0x34cded[_0x54e4d2(0x118)]();},0xa);}else{if(_0x2aac23===0x2){}else assert(![],_0x2d0108[_0x513c1e(0x165)]);}}});_0x43b906[_0x41b005(0x13b)](_0x2de490),_0x43b906['on'](_0x2d0108[_0x41b005(0x199)],function(){const _0x2ec581=_0x41b005;_0x326ba2[_0x2ec581(0x183)](_0x326ba2[_0x2ec581(0x106)],_0x2ec581(0x13f))?_0x182b58=!![]:(_0x3524df=null,_0x326ba2[_0x2ec581(0x134)](_0x102fb2,_0x30b72c));}),_0x2554bc[_0x41b005(0x136)]=0x3e8,_0x2554bc['on'](_0x2d0108[_0x41b005(0x120)],function(_0x3a59a6){const _0x153a80=_0x41b005;_0xedea58['should'][_0x153a80(0x121)](![],_0x326ba2[_0x153a80(0x1a7)]),_0xedea58=!![],should(_0x3a59a6)['be'][_0x153a80(0x174)](Error,_0x326ba2['YwtVU']),_0x326ba2[_0x153a80(0x1aa)](_0x5e5c89);}),_0x2554bc[_0x41b005(0x10e)](_0x442987,function(_0x1d95a2){const _0x413965=_0x41b005;if(_0x326ba2['FjJSa'](_0x326ba2[_0x413965(0x18f)],_0x326ba2[_0x413965(0x1ac)]))_0x326ba2['sfxnD'](assert,!_0x1d95a2);else{const _0x4fbe3f=_0x326ba2[_0x413965(0xfc)]['split']('|');let _0x40877f=0x0;while(!![]){switch(_0x4fbe3f[_0x40877f++]){case'0':_0x37f6e6['message'][_0x413965(0x1af)][_0x413965(0x186)](/Connection aborted/);continue;case'1':_0x298709[_0x413965(0x17c)]['should']['eql'](0x0);continue;case'2':_0x326ba2[_0x413965(0x1aa)](_0x3e5814);continue;case'3':_0x120633[_0x413965(0x17c)][_0x413965(0x1af)][_0x413965(0x121)](0x0);continue;case'4':_0x287d06[_0x413965(0x17c)]['should'][_0x413965(0x121)](0x0);continue;}break;}}});}),_0x2d0108[_0x52f989(0x155)](it,_0x2d0108[_0x52f989(0x16d)],function(_0x2f656a){const _0x1f2b75=_0x52f989,_0x39f19d={'JNvIB':function(_0x3c8b6a,_0x47ad11){const _0x347e3a=_0x3c60;return _0x2d0108[_0x347e3a(0x187)](_0x3c8b6a,_0x47ad11);},'vqllm':function(_0x17b8f8,_0xb09354){return _0x17b8f8===_0xb09354;},'uFExo':function(_0x5cd45b,_0x59b728){const _0x3d7140=_0x3c60;return _0x2d0108[_0x3d7140(0x15c)](_0x5cd45b,_0x59b728);},'DNdHo':_0x2d0108[_0x1f2b75(0x10d)],'cvhox':function(_0x2c4117){const _0x1a074d=_0x1f2b75;return _0x2d0108[_0x1a074d(0x110)](_0x2c4117);},'BBhjv':_0x1f2b75(0x11e)};_0x2554bc[_0x1f2b75(0x10e)](_0x2d0108[_0x1f2b75(0x132)],function(_0x2c10f9){const _0x1d190d=_0x1f2b75,_0x576f63={'CmxDl':function(_0x20a657,_0x53fb28,_0x13b0c4){return _0x20a657(_0x53fb28,_0x13b0c4);},'yYAQD':function(_0x3bd57f,_0x590628){return _0x39f19d['JNvIB'](_0x3bd57f,_0x590628);},'vXpgQ':function(_0x28c193,_0x13baf3){const _0x242b96=_0x3c60;return _0x39f19d[_0x242b96(0x119)](_0x28c193,_0x13baf3);}};if(_0x2c10f9){if(_0x1d190d(0xfe)!==_0x1d190d(0x159)){const _0x590ed9=/EADDRNOTAVAIL|ECONNREFUSED/,_0x2f46b2=/port(" option)* should be/,_0x105fa5=/Port should be > 0 and < 65536. Received NaN/,_0x298e94=/ERR_SOCKET_BAD_PORT|Port should be >= 0 and < 65536. Received NaN./,_0x34cca3=!!_0x2c10f9[_0x1d190d(0x196)][_0x1d190d(0x186)](_0x590ed9),_0x59d2fa=!!_0x2c10f9['message'][_0x1d190d(0x186)](_0x2f46b2),_0x15c893=!!_0x2c10f9[_0x1d190d(0x196)][_0x1d190d(0x186)](_0x105fa5),_0x12c0b6=!!_0x2c10f9['message'][_0x1d190d(0x186)](_0x298e94);(_0x39f19d['uFExo'](_0x34cca3,_0x59d2fa)||_0x15c893||_0x12c0b6)[_0x1d190d(0x1af)][_0x1d190d(0x121)](!![],_0x39f19d[_0x1d190d(0x12c)]+_0x2c10f9[_0x1d190d(0x196)]),_0x39f19d['cvhox'](_0x2f656a);}else{_0x576f63[_0x1d190d(0x10a)](_0x2e704f,_0x56458f[_0x1d190d(0x16e)]['bold']('\x0acounter\x20=\x20'),_0x3ee431),_0x1665d6(_0x235df6[_0x1d190d(0x14b)][_0x1d190d(0x176)](_0x576f63[_0x1d190d(0x152)](_0x4f7177,_0x217302)));if(_0x576f63[_0x1d190d(0x144)](_0x52a068,0x1)){const _0xa3b75c=_0x46649d(_0x1d190d(0x192),_0x3a85d9);_0x38097d+=0x1,_0x3ab7ef[_0x1d190d(0x100)](_0xa3b75c);return;}_0x4548f1(![],'unexpected\x20data\x20received');}}else _0x39f19d[_0x1d190d(0x1a3)](_0x2f656a,new Error(_0x39f19d['BBhjv']));});});});