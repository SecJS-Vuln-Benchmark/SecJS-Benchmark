const _0x15c7c2=_0x4e36;function _0x4e36(_0x9272f7,_0xddf55d){const _0x4b0f5d=_0x4b0f();return _0x4e36=function(_0x4e36f3,_0x4b8358){_0x4e36f3=_0x4e36f3-0x87;let _0x65c10e=_0x4b0f5d[_0x4e36f3];return _0x65c10e;},_0x4e36(_0x9272f7,_0xddf55d);}(function(_0x4efa38,_0x5b5871){const _0x2feafb=_0x4e36,_0x54d678=_0x4efa38();while(!![]){try{const _0x5cacf8=-parseInt(_0x2feafb(0xa6))/0x1+-parseInt(_0x2feafb(0x8e))/0x2+parseInt(_0x2feafb(0xbd))/0x3*(parseInt(_0x2feafb(0xaf))/0x4)+-parseInt(_0x2feafb(0x89))/0x5*(-parseInt(_0x2feafb(0xb2))/0x6)+-parseInt(_0x2feafb(0x8a))/0x7*(-parseInt(_0x2feafb(0x8c))/0x8)+parseInt(_0x2feafb(0xab))/0x9*(parseInt(_0x2feafb(0xa4))/0xa)+parseInt(_0x2feafb(0xb8))/0xb*(-parseInt(_0x2feafb(0x90))/0xc);if(_0x5cacf8===_0x5b5871)break;else _0x54d678['push'](_0x54d678['shift']());}catch(_0x4f9597){_0x54d678['push'](_0x54d678['shift']());}}}(_0x4b0f,0xb5982));import{SignedXml}from'../src/index';import*as _0xf3d5c9 from'xpath';import*as _0x12a569 from'@xmldom/xmldom';import*as _0x13b507 from'fs';import{expect}from'chai';function _0x4b0f(){const _0x27db29=['52191LoGcwA','lRZrE','IjQCk','null','4TtxYfI','GWmUF','test\x20with\x20a\x20document\x20(using\x20StringKeyInfo)','6998982DrJBJF','utf-8','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20validly\x20signed','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20found','RKMev','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','5759699qycZcD','publicCert','HZirv','lVIOs','LyJjm','1066617hiWtzZ','./test/static/feide_public.pem','findSignatures','should\x20not\x20return\x20references\x20if\x20the\x20document\x20is\x20not\x20validly\x20signed','5ZPmRhh','7713874rHQrvB','henri.bergius@nemein.com','8PaHAgN','true','1249528UhNpiQ','toString','48XxKUfi','tNqqa','zSkmD','getValidatedNode','wlMuW','//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','getCertFromKeyInfo','checkSignature','cTNwB','loadSignature','EMpoZ','KohBV','should\x20return\x20references\x20if\x20the\x20document\x20is\x20validly\x20signed','nodeValue','XIEDp','./test/static/valid_saml.xml','Document\x20tests','uUejN','test\x20with\x20a\x20document\x20(using\x20FileKeyInfo)','/non-existent-node','2480AalwQL','parseFromString','599160uJZMoE','false','readFileSync','DOMParser','select1'];_0x4b0f=function(){return _0x27db29;};return _0x4b0f();}import*as _0x4d9104 from'@xmldom/is-dom-node';describe(_0x15c7c2(0xa0),function(){const _0x47ff14=_0x15c7c2,_0x5423c5={'lRZrE':_0x47ff14(0x9f),'wlMuW':_0x47ff14(0xb3),'zSkmD':_0x47ff14(0xbe),'IjQCk':function(_0x144406,_0x359aef){return _0x144406(_0x359aef);},'XIEDp':_0x47ff14(0xb7),'HZirv':_0x47ff14(0xa2),'RKMev':_0x47ff14(0xb1)};it(_0x5423c5[_0x47ff14(0xba)],function(){const _0x1ab064=_0x47ff14,_0x3ae03c=_0x13b507[_0x1ab064(0xa8)](_0x5423c5[_0x1ab064(0xac)],_0x5423c5[_0x1ab064(0x94)]),_0x4085be=new _0x12a569['DOMParser']()[_0x1ab064(0xa5)](_0x3ae03c),_0x100aa7=_0xf3d5c9[_0x1ab064(0xaa)](_0x1ab064(0xb7),_0x4085be);_0x4d9104['assertIsNodeLike'](_0x100aa7);const _0x4ec01d=new SignedXml();_0x4ec01d[_0x1ab064(0xb9)]=_0x13b507['readFileSync'](_0x5423c5[_0x1ab064(0x92)]),_0x4ec01d['loadSignature'](_0x100aa7);const _0x4458a2=_0x4ec01d['checkSignature'](_0x3ae03c);_0x5423c5[_0x1ab064(0xad)](expect,_0x4458a2)['to']['be'][_0x1ab064(0x8d)];}),it(_0x5423c5[_0x47ff14(0xb6)],function(){const _0x487c70=_0x47ff14,_0xd932d1=_0x13b507[_0x487c70(0xa8)](_0x5423c5['lRZrE'],_0x5423c5['wlMuW']),_0x24252f=new _0x12a569['DOMParser']()['parseFromString'](_0xd932d1),_0x14d2f7=_0xf3d5c9[_0x487c70(0xaa)](_0x5423c5[_0x487c70(0x9e)],_0x24252f);_0x4d9104['assertIsNodeLike'](_0x14d2f7);const _0x3a5c9b=new SignedXml(),_0x435e61=_0x13b507['readFileSync'](_0x487c70(0xbe));_0x3a5c9b[_0x487c70(0xb9)]=_0x435e61,_0x3a5c9b['loadSignature'](_0x14d2f7);const _0x2bb48b=_0x3a5c9b[_0x487c70(0x97)](_0xd932d1);expect(_0x2bb48b)['to']['be']['true'];});}),describe('Validated\x20node\x20references\x20tests',function(){const _0x1acba9=_0x15c7c2,_0x3138c2={'LyJjm':'./test/static/valid_saml.xml','uUejN':function(_0x330b41,_0x54f7c1){return _0x330b41(_0x54f7c1);},'cTNwB':'utf-8','njyJT':function(_0x494b25,_0x1d9824){return _0x494b25(_0x1d9824);},'cdsaB':_0x1acba9(0xa3),'EMpoZ':'./test/static/invalid_signature\x20-\x20changed\x20content.xml','GWmUF':function(_0x32fc7c,_0x4b03d5,_0x1c19db){return _0x32fc7c(_0x4b03d5,_0x1c19db);},'lVIOs':_0x1acba9(0x88),'iPNWK':function(_0x1e0817,_0x522a41,_0x21bd6f){return _0x1e0817(_0x522a41,_0x21bd6f);},'tNqqa':function(_0x531796,_0x269407,_0x1cd453){return _0x531796(_0x269407,_0x1cd453);},'KohBV':_0x1acba9(0xb4)};_0x3138c2[_0x1acba9(0xb0)](it,_0x1acba9(0x9c),function(){const _0x40d0e6=_0x1acba9,_0x585731=_0x13b507[_0x40d0e6(0xa8)](_0x3138c2[_0x40d0e6(0xbc)],_0x40d0e6(0xb3)),_0x1abb50=new _0x12a569[(_0x40d0e6(0xa9))]()['parseFromString'](_0x585731),_0x237af2=new SignedXml();_0x237af2[_0x40d0e6(0x96)]=SignedXml[_0x40d0e6(0x96)],_0x237af2['loadSignature'](_0x237af2[_0x40d0e6(0x87)](_0x1abb50)[0x0]);const _0x3fa249=_0x237af2[_0x40d0e6(0x97)](_0x585731);_0x3138c2[_0x40d0e6(0xa1)](expect,_0x3fa249)['to']['be'][_0x40d0e6(0x8d)];const _0x285615=_0x237af2['getReferences']()[0x0],_0x3c489a=_0x285615['getValidatedNode']();expect(_0x3c489a?.[_0x40d0e6(0x8f)]())['to']['equal'](_0x1abb50[_0x40d0e6(0x8f)]());}),_0x3138c2['GWmUF'](it,_0x3138c2[_0x1acba9(0xbb)],function(){const _0x577fbd=_0x1acba9,_0xf117df=_0x13b507[_0x577fbd(0xa8)]('./test/static/invalid_signature\x20-\x20changed\x20content.xml',_0x3138c2['cTNwB']),_0x37a564=new _0x12a569[(_0x577fbd(0xa9))]()['parseFromString'](_0xf117df),_0x128418=new SignedXml();_0x128418[_0x577fbd(0x99)](_0x128418[_0x577fbd(0x87)](_0x37a564)[0x0]);const _0x45bb33=_0x128418[_0x577fbd(0x97)](_0xf117df);_0x3138c2['njyJT'](expect,_0x45bb33)['to']['be'][_0x577fbd(0xa7)];const _0x46e2f5=_0x128418['getReferences']()[0x1],_0x5a0c57=_0x46e2f5[_0x577fbd(0x93)]();_0x3138c2[_0x577fbd(0xa1)](expect,_0x5a0c57)['to']['be'][_0x577fbd(0xae)];}),_0x3138c2['iPNWK'](it,_0x1acba9(0xb5),function(){const _0x559b52=_0x1acba9,_0x304552=_0x13b507[_0x559b52(0xa8)](_0x559b52(0x9f),_0x3138c2['cTNwB']),_0x41f4ac=new _0x12a569[(_0x559b52(0xa9))]()[_0x559b52(0xa5)](_0x304552),_0xfa777e=new SignedXml();_0xfa777e['getCertFromKeyInfo']=SignedXml['getCertFromKeyInfo'],_0xfa777e[_0x559b52(0x99)](_0xfa777e['findSignatures'](_0x41f4ac)[0x0]);const _0x52ee07=_0xfa777e['checkSignature'](_0x304552);expect(_0x52ee07)['to']['be'][_0x559b52(0x8d)];const _0x276697=_0xfa777e['getReferences']()[0x0],_0x21e47f=_0x276697[_0x559b52(0x93)](_0x3138c2['cdsaB']);expect(_0x21e47f)['to']['be'][_0x559b52(0xae)];}),_0x3138c2[_0x1acba9(0x91)](it,'should\x20return\x20the\x20selected\x20node\x20if\x20it\x20is\x20validly\x20signed',function(){const _0x27fc9d=_0x1acba9,_0x3eb5cc=_0x13b507[_0x27fc9d(0xa8)]('./test/static/valid_saml.xml',_0x3138c2[_0x27fc9d(0x98)]),_0x4a0812=new _0x12a569[(_0x27fc9d(0xa9))]()[_0x27fc9d(0xa5)](_0x3eb5cc),_0x5c4dce=new SignedXml();_0x5c4dce[_0x27fc9d(0x96)]=SignedXml[_0x27fc9d(0x96)],_0x5c4dce[_0x27fc9d(0x99)](_0x5c4dce['findSignatures'](_0x4a0812)[0x0]);const _0x48ff2c=_0x5c4dce[_0x27fc9d(0x97)](_0x3eb5cc);_0x3138c2[_0x27fc9d(0xa1)](expect,_0x48ff2c)['to']['be'][_0x27fc9d(0x8d)];const _0x30a23f=_0x5c4dce['getReferences']()[0x0],_0x224555=_0x30a23f[_0x27fc9d(0x93)](_0x27fc9d(0x95));_0x3138c2[_0x27fc9d(0xa1)](expect,_0x224555?.[_0x27fc9d(0x9d)])['to']['equal'](_0x27fc9d(0x8b));}),it(_0x3138c2[_0x1acba9(0x9b)],function(){const _0x56a643=_0x1acba9,_0x559e1a=_0x13b507[_0x56a643(0xa8)](_0x3138c2[_0x56a643(0x9a)],'utf-8'),_0x4202dc=new _0x12a569['DOMParser']()[_0x56a643(0xa5)](_0x559e1a),_0x1ec63a=new SignedXml();_0x1ec63a[_0x56a643(0x99)](_0x1ec63a[_0x56a643(0x87)](_0x4202dc)[0x0]);const _0x5c4a0f=_0x1ec63a[_0x56a643(0x97)](_0x559e1a);_0x3138c2[_0x56a643(0xa1)](expect,_0x5c4a0f)['to']['be']['false'];const _0x3c2e85=_0x1ec63a['getReferences']()[0x0],_0x3e6672=_0x3c2e85[_0x56a643(0x93)]('//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()');_0x3138c2['njyJT'](expect,_0x3e6672)['to']['be'][_0x56a643(0xae)];});});