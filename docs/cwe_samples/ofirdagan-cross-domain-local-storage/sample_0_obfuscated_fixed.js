const _0x3485dd=_0x5bbe;(function(_0x4d155e,_0x2f578a){const _0x2a12d4=_0x5bbe,_0x401b7a=_0x4d155e();while(!![]){try{const _0x1bb453=-parseInt(_0x2a12d4(0x1db))/0x1+parseInt(_0x2a12d4(0x1dd))/0x2*(-parseInt(_0x2a12d4(0x1d3))/0x3)+parseInt(_0x2a12d4(0x1c7))/0x4+-parseInt(_0x2a12d4(0x1b2))/0x5+-parseInt(_0x2a12d4(0x1bb))/0x6*(parseInt(_0x2a12d4(0x1bd))/0x7)+parseInt(_0x2a12d4(0x1d6))/0x8*(-parseInt(_0x2a12d4(0x1be))/0x9)+parseInt(_0x2a12d4(0x1de))/0xa*(parseInt(_0x2a12d4(0x1af))/0xb);if(_0x1bb453===_0x2f578a)break;else _0x401b7a['push'](_0x401b7a['shift']());}catch(_0x28923a){_0x401b7a['push'](_0x401b7a['shift']());}}}(_0x4a16,0x1f8c8));import*as _0x492f32 from'@xmldom/xmldom';import*as _0x40d777 from'fs';function _0x4a16(){const _0x116815=['eZflQ','getKeyInfoContent','select1','oXQJp','2718sogrnX','./test/static/hmac.key','2996rvrdYz','4833jqRBAV','http://www.w3.org/2000/09/xmldsig#hmac-sha1','assertIsArrayOfNodes','privateKey','zxWYP','okoBB','select','TtTjA','GEkWV','79712JAdpra','computeSignature','addReference','parseFromString','<root><x\x20/></root>','iExxk','length','wTUzE','//*[local-name(.)=\x27book\x27]','http://www.w3.org/2000/09/xmldsig#rsa-sha1','<book>','signatureAlgorithm','5373gEyfQH','KeyInfo\x20tests','dIdwo','848efxdaM','./test/static/client.pem','X509Certificate\x20element\x20should\x20exist','documentElement','</book>','230659EzlOJX','readFileSync','268IUTBPq','663730OPXkOR','getSignedXml','http://www.w3.org/2001/10/xml-exc-c14n#','DOMParser','kPZZk','//*[local-name(.)=\x27X509Certificate\x27]','<name>Harry\x20Potter</name>','./test/static/client_public.pem','undefined','143DRCYwC','<library>','UPLhR','160470LxFFgp','canonicalizationAlgorithm','publicCert','fPwhh','</library>'];_0x4a16=function(){return _0x116815;};return _0x4a16();}import*as _0x237173 from'xpath';import{SignedXml}from'../src/index';import{expect}from'chai';function _0x5bbe(_0x203acd,_0x3d3c10){const _0x4a160d=_0x4a16();return _0x5bbe=function(_0x5bbe87,_0x55180c){_0x5bbe87=_0x5bbe87-0x1ac;let _0xab273f=_0x4a160d[_0x5bbe87];return _0xab273f;},_0x5bbe(_0x203acd,_0x3d3c10);}import*as _0xf0076f from'@xmldom/is-dom-node';describe(_0x3485dd(0x1d4),function(){const _0x2e264c=_0x3485dd,_0x2ba94f={'UPLhR':_0x2e264c(0x1ad),'wTUzE':_0x2e264c(0x1e0),'okoBB':_0x2e264c(0x1d0),'oXQJp':_0x2e264c(0x1d8),'GXmBK':function(_0x52146f,_0x418e4e){return _0x52146f+_0x418e4e;},'eZflQ':_0x2e264c(0x1b0),'TtTjA':_0x2e264c(0x1d1),'GEkWV':_0x2e264c(0x1ac),'kPZZk':_0x2e264c(0x1b6),'iExxk':_0x2e264c(0x1bc),'zxWYP':_0x2e264c(0x1bf),'fPwhh':function(_0x5cceb6,_0x2049aa){return _0x5cceb6(_0x2049aa);},'dIdwo':function(_0x5c82c4,_0x20989f,_0x259529){return _0x5c82c4(_0x20989f,_0x259529);}};it('adds\x20X509Certificate\x20element\x20during\x20signature',function(){const _0x3fdbfc=_0x2e264c,_0x99f79e=_0x3fdbfc(0x1cb),_0x438ffa=new SignedXml();_0x438ffa[_0x3fdbfc(0x1c1)]=_0x40d777[_0x3fdbfc(0x1dc)](_0x3fdbfc(0x1d7)),_0x438ffa['publicCert']=_0x40d777[_0x3fdbfc(0x1dc)](_0x2ba94f[_0x3fdbfc(0x1b1)]),_0x438ffa['canonicalizationAlgorithm']=_0x2ba94f[_0x3fdbfc(0x1ce)],_0x438ffa[_0x3fdbfc(0x1d2)]=_0x2ba94f[_0x3fdbfc(0x1c3)],_0x438ffa['getKeyInfoContent']=SignedXml[_0x3fdbfc(0x1b8)],_0x438ffa[_0x3fdbfc(0x1c8)](_0x99f79e);const _0x680396=_0x438ffa['getSignedXml'](),_0x33b439=new _0x492f32[(_0x3fdbfc(0x1e1))]()[_0x3fdbfc(0x1ca)](_0x680396),_0x310c5c=_0x237173[_0x3fdbfc(0x1c4)](_0x3fdbfc(0x1e3),_0x33b439[_0x3fdbfc(0x1d9)]);_0xf0076f[_0x3fdbfc(0x1c0)](_0x310c5c),expect(_0x310c5c[_0x3fdbfc(0x1cd)],_0x2ba94f[_0x3fdbfc(0x1ba)])['to']['equal'](0x1);}),_0x2ba94f[_0x2e264c(0x1d5)](it,'make\x20sure\x20private\x20hmac\x20key\x20is\x20not\x20leaked\x20due\x20to\x20key\x20confusion',function(){const _0x17ca53=_0x2e264c,_0x1663f1=_0x2ba94f['GXmBK'](_0x2ba94f[_0x17ca53(0x1b7)]+_0x2ba94f[_0x17ca53(0x1c5)],_0x2ba94f[_0x17ca53(0x1c6)])+_0x17ca53(0x1da)+_0x2ba94f[_0x17ca53(0x1e2)],_0x4705c3=new SignedXml();_0x4705c3[_0x17ca53(0x1c1)]=_0x40d777['readFileSync'](_0x17ca53(0x1bc)),_0x4705c3[_0x17ca53(0x1b4)]=_0x40d777[_0x17ca53(0x1dc)](_0x2ba94f[_0x17ca53(0x1cc)]),_0x4705c3[_0x17ca53(0x1d2)]=_0x2ba94f[_0x17ca53(0x1c2)],_0x4705c3['enableHMAC'](),_0x4705c3[_0x17ca53(0x1c9)]({'xpath':_0x17ca53(0x1cf),'digestAlgorithm':'http://www.w3.org/2000/09/xmldsig#sha1','transforms':[_0x17ca53(0x1e0)]}),_0x4705c3[_0x17ca53(0x1b3)]=_0x2ba94f[_0x17ca53(0x1ce)],_0x4705c3[_0x17ca53(0x1c8)](_0x1663f1);const _0x3f907f=new _0x492f32['DOMParser']()[_0x17ca53(0x1ca)](_0x4705c3[_0x17ca53(0x1df)]()),_0xaef313=_0x237173[_0x17ca53(0x1b9)]('//*[local-name(.)=\x27KeyInfo\x27]',_0x3f907f);_0x2ba94f[_0x17ca53(0x1b5)](expect,_0xaef313)['to']['be'][_0x17ca53(0x1ae)];});});