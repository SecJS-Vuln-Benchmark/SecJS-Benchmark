const _0x1dd7e8=_0x12cb;(function(_0x9c8acb,_0x5b16f4){const _0x84505d=_0x12cb,_0x27697b=_0x9c8acb();while(!![]){try{const _0x1b3d4b=parseInt(_0x84505d(0xb8))/0x1+parseInt(_0x84505d(0xc6))/0x2*(-parseInt(_0x84505d(0xa6))/0x3)+-parseInt(_0x84505d(0xa4))/0x4+-parseInt(_0x84505d(0xc7))/0x5+parseInt(_0x84505d(0xc2))/0x6+parseInt(_0x84505d(0xca))/0x7*(parseInt(_0x84505d(0xb9))/0x8)+parseInt(_0x84505d(0xb3))/0x9;if(_0x1b3d4b===_0x5b16f4)break;else _0x27697b['push'](_0x27697b['shift']());}catch(_0x434474){_0x27697b['push'](_0x27697b['shift']());}}}(_0xfc04,0x570fe));function _0xfc04(){const _0x3a4a76=['249233LYkvWA','8APinnj','ugVDC','yYvaD','parseFromString','YNRJF','DOMParser','//*[local-name(.)=\x27Assertion\x27]','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','IrrnS','511692GjxIiq','OxScG','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','WUGhZ','5276RZQAGG','2212560DAKyAO','waZUi','./test/static/id_with_quotes.xml','2797963fsBXxU','tYYju','signature\x20wrapping\x20attack.','true','hbVXa','CXxek','Afrkd','test\x20validating\x20SAML\x20response\x20WithComments','RIgYB','select1','./test/static/saml_external_ns.pem','./test/static/feide_public.pem','id\x20should\x20not\x20contain\x20quotes','ySMvY','tuZMu','rrknp','assertIsNodeLike','checkSignature','2597072QgoVNR','publicCert','174usijTo','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','throw','xqJHd','loadSignature','utf-8','./test/static/saml_external_ns.xml','./test/static/valid_saml_signature_wrapping.xml','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','TVpOq','ttCBk','readFileSync','nSKqy','7804494uGZYbg','SAML\x20response\x20tests','JBlyg','rKWGG','test\x20validating\x20SAML\x20response'];_0xfc04=function(){return _0x3a4a76;};return _0xfc04();}import{SignedXml}from'../src/index';import*as _0x477f52 from'xpath';import*as _0x4617b7 from'@xmldom/xmldom';import*as _0x38cc3d from'fs';import{expect}from'chai';function _0x12cb(_0x4ba508,_0x34bc2f){const _0xfc045a=_0xfc04();return _0x12cb=function(_0x12cb42,_0x47ede4){_0x12cb42=_0x12cb42-0x9d;let _0x3ed83c=_0xfc045a[_0x12cb42];return _0x3ed83c;},_0x12cb(_0x4ba508,_0x34bc2f);}import*as _0x200c32 from'@xmldom/is-dom-node';describe(_0x1dd7e8(0xb4),function(){const _0x502d6f=_0x1dd7e8,_0x464860={'tuZMu':'./test/static/valid_saml.xml','YNRJF':function(_0x47512a,_0x105fde){return _0x47512a(_0x105fde);},'waZUi':function(_0x14619e,_0x1d065e){return _0x14619e===_0x1d065e;},'ttCBk':_0x502d6f(0xaf),'rKWGG':_0x502d6f(0xc5),'xqJHd':_0x502d6f(0xab),'Afrkd':_0x502d6f(0xa7),'ySMvY':'./test/static/feide_public.pem','BZCXj':'//*[local-name(.)=\x27Assertion\x27]','yYvaD':function(_0x445054,_0x176fd2,_0x40c3de){return _0x445054(_0x176fd2,_0x40c3de);},'JBlyg':_0x502d6f(0xc4),'IrrnS':_0x502d6f(0xd4),'nOaJb':function(_0x3b1624,_0x2bfd0e){return _0x3b1624===_0x2bfd0e;},'tYYju':'ZHAKz','ugVDC':'./test/static/saml_external_ns.xml','OxScG':'//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','hbVXa':_0x502d6f(0xb7),'RIgYB':'test\x20validating\x20wrapped\x20assertion\x20signature','pliqV':'test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element','RITkF':_0x502d6f(0xc0),'CXxek':function(_0x2b70bc,_0x158468,_0x2fb993){return _0x2b70bc(_0x158468,_0x2fb993);},'rrknp':_0x502d6f(0xd1)};it(_0x464860[_0x502d6f(0xce)],function(){const _0x22fff1=_0x502d6f;if(_0x464860[_0x22fff1(0xc8)](_0x464860[_0x22fff1(0xb0)],_0x464860[_0x22fff1(0xb6)])){const _0x1b25ce=_0xfa0a91[_0x22fff1(0xb1)](_0x464860['tuZMu'],'utf-8'),_0x47a928=new _0x24856a[(_0x22fff1(0xbe))]()['parseFromString'](_0x1b25ce),_0x466685=_0x2f3e27[_0x22fff1(0xd3)](_0x22fff1(0xa7),_0x47a928);_0xb55cc8[_0x22fff1(0xa2)](_0x466685);const _0x30246c=new _0x38387a();_0x30246c[_0x22fff1(0xa5)]=_0x41f76c[_0x22fff1(0xb1)](_0x22fff1(0x9d)),_0x30246c['loadSignature'](_0x466685);const _0x429c71=_0x30246c['checkSignature'](_0x1b25ce);_0x464860[_0x22fff1(0xbd)](_0x54485e,_0x429c71)['to']['be'][_0x22fff1(0xcd)];}else{const _0xc17833=_0x38cc3d[_0x22fff1(0xb1)](_0x464860[_0x22fff1(0xa0)],_0x464860[_0x22fff1(0xa9)]),_0xe074a=new _0x4617b7[(_0x22fff1(0xbe))]()[_0x22fff1(0xbc)](_0xc17833),_0x121639=_0x477f52[_0x22fff1(0xd3)](_0x464860[_0x22fff1(0xd0)],_0xe074a);_0x200c32[_0x22fff1(0xa2)](_0x121639);const _0x616f9b=new SignedXml();_0x616f9b[_0x22fff1(0xa5)]=_0x38cc3d[_0x22fff1(0xb1)](_0x464860[_0x22fff1(0x9f)]),_0x616f9b[_0x22fff1(0xaa)](_0x121639);const _0x1ad794=_0x616f9b[_0x22fff1(0xa3)](_0xc17833);expect(_0x1ad794)['to']['be'][_0x22fff1(0xcd)];}}),_0x464860[_0x502d6f(0xbb)](it,_0x464860[_0x502d6f(0xd2)],function(){const _0x11404d=_0x502d6f,_0xd69f75=_0x38cc3d[_0x11404d(0xb1)](_0x11404d(0xad),_0x464860[_0x11404d(0xa9)]),_0x5732e1=new _0x4617b7[(_0x11404d(0xbe))]()[_0x11404d(0xbc)](_0xd69f75),_0x4163cb=_0x477f52[_0x11404d(0xd3)](_0x464860['BZCXj'],_0x5732e1);_0x200c32['assertIsNodeLike'](_0x4163cb);const _0x432fb9=_0x477f52['select1'](_0x11404d(0xae),_0x4163cb);_0x200c32[_0x11404d(0xa2)](_0x432fb9);const _0x26cdab=new SignedXml();_0x26cdab[_0x11404d(0xa5)]=_0x38cc3d['readFileSync'](_0x11404d(0x9d)),_0x26cdab['loadSignature'](_0x432fb9),_0x464860[_0x11404d(0xbb)](expect,function(){const _0x435455=_0x11404d;_0x26cdab[_0x435455(0xa3)](_0xd69f75);},'Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20'+'same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20'+_0x11404d(0xcc))['to'][_0x11404d(0xa8)]();}),_0x464860['yYvaD'](it,_0x464860['pliqV'],function(){const _0x5b19c9=_0x502d6f;if(_0x464860['nOaJb'](_0x5b19c9(0xb2),_0x464860[_0x5b19c9(0xcb)])){const _0x88af86=_0x2d8ce1[_0x5b19c9(0xb1)](_0x5b19c9(0xac),'utf-8'),_0x1c66fc=new _0x3ddf76[(_0x5b19c9(0xbe))]()['parseFromString'](_0x88af86),_0x362a33=_0x2564a7[_0x5b19c9(0xd3)](_0x464860[_0x5b19c9(0xb5)],_0x1c66fc);_0x198c9d[_0x5b19c9(0xa2)](_0x362a33);const _0x2f4e31=new _0x593794();_0x2f4e31['publicCert']=_0x1e1985[_0x5b19c9(0xb1)](_0x464860[_0x5b19c9(0xc1)]),_0x2f4e31[_0x5b19c9(0xaa)](_0x362a33);const _0x101cab=_0x2f4e31[_0x5b19c9(0xa3)](_0x88af86);_0x41e305(_0x101cab)['to']['be'][_0x5b19c9(0xcd)];}else{const _0x382bec=_0x38cc3d['readFileSync'](_0x464860[_0x5b19c9(0xba)],_0x464860[_0x5b19c9(0xa9)]),_0x28a62f=new _0x4617b7[(_0x5b19c9(0xbe))]()[_0x5b19c9(0xbc)](_0x382bec),_0x550d1f=_0x477f52['select1'](_0x464860[_0x5b19c9(0xb5)],_0x28a62f);_0x200c32[_0x5b19c9(0xa2)](_0x550d1f);const _0x4cf0b5=new SignedXml();_0x4cf0b5[_0x5b19c9(0xa5)]=_0x38cc3d[_0x5b19c9(0xb1)](_0x464860['IrrnS']),_0x4cf0b5['loadSignature'](_0x550d1f);const _0x43a038=_0x4cf0b5[_0x5b19c9(0xa3)](_0x382bec);_0x464860[_0x5b19c9(0xbd)](expect,_0x43a038)['to']['be'][_0x5b19c9(0xcd)];}}),it(_0x464860['RITkF'],function(){const _0x28d6d8=_0x502d6f,_0x16b366=_0x38cc3d['readFileSync'](_0x28d6d8(0xc9),_0x28d6d8(0xab)),_0x5a8728=new _0x4617b7['DOMParser']()[_0x28d6d8(0xbc)](_0x16b366),_0x2250ff=_0x477f52[_0x28d6d8(0xd3)](_0x28d6d8(0xbf),_0x5a8728);_0x200c32[_0x28d6d8(0xa2)](_0x2250ff);const _0x47c090=_0x477f52[_0x28d6d8(0xd3)](_0x464860[_0x28d6d8(0xc3)],_0x2250ff);_0x200c32[_0x28d6d8(0xa2)](_0x47c090);const _0x45113e=new SignedXml();_0x45113e[_0x28d6d8(0xa5)]=_0x38cc3d[_0x28d6d8(0xb1)](_0x28d6d8(0x9d)),_0x45113e['loadSignature'](_0x47c090),expect(function(){const _0x43cf42=_0x28d6d8;_0x45113e[_0x43cf42(0xa3)](_0x16b366);},_0x28d6d8(0x9e))['to'][_0x28d6d8(0xa8)]();}),_0x464860[_0x502d6f(0xcf)](it,_0x464860[_0x502d6f(0xa1)],function(){const _0x44e3d7=_0x502d6f,_0x48cb8f=_0x38cc3d[_0x44e3d7(0xb1)]('./test/static/valid_saml_withcomments.xml',_0x464860[_0x44e3d7(0xa9)]),_0x4302f4=new _0x4617b7['DOMParser']()[_0x44e3d7(0xbc)](_0x48cb8f),_0x2d653f=_0x477f52[_0x44e3d7(0xd3)](_0x464860[_0x44e3d7(0xd0)],_0x4302f4);_0x200c32[_0x44e3d7(0xa2)](_0x2d653f);const _0x297bcc=new SignedXml();_0x297bcc[_0x44e3d7(0xa5)]=_0x38cc3d['readFileSync'](_0x44e3d7(0x9d)),_0x297bcc['loadSignature'](_0x2d653f),expect(()=>_0x297bcc['checkSignature'](_0x48cb8f))['to'][_0x44e3d7(0xa8)](/^invalid signature/);});});