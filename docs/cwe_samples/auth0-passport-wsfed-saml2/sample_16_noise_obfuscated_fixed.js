var _0x53c204=_0x4aad;function _0x4aad(_0x37eb49,_0x3880f8){var _0x339403=_0x3394();return _0x4aad=function(_0x4aad54,_0x188abb){_0x4aad54=_0x4aad54-0x16a;var _0x2acb54=_0x339403[_0x4aad54];return _0x2acb54;},_0x4aad(_0x37eb49,_0x3880f8);}(function(_0x347cd6,_0x202acf){var _0x49cf5b=_0x4aad,_0x1977cb=_0x347cd6();while(!![]){try{var _0x235e9f=parseInt(_0x49cf5b(0x182))/0x1+-parseInt(_0x49cf5b(0x192))/0x2+-parseInt(_0x49cf5b(0x18b))/0x3+-parseInt(_0x49cf5b(0x175))/0x4+parseInt(_0x49cf5b(0x195))/0x5+-parseInt(_0x49cf5b(0x185))/0x6+parseInt(_0x49cf5b(0x16d))/0x7*(parseInt(_0x49cf5b(0x17f))/0x8);if(_0x235e9f===_0x202acf)break;else _0x1977cb['push'](_0x1977cb['shift']());}catch(_0x5457af){_0x1977cb['push'](_0x1977cb['shift']());}}}(_0x3394,0x96915));var jwt=require('jsonwebtoken'),assert=require('assert'),expressjwt=require(_0x53c204(0x189)),UnauthorizedError=require(_0x53c204(0x177));function _0x3394(){var _0x3db6c6=['ynfwG','5849106ftCZiq','SGAiF','YoKTZ','should\x20throw\x20if\x20an\x20error\x20ocurred\x20when\x20retrieving\x20the\x20token','../lib','inexistent','2841195JkNlZr','authorization','UOViT','kRWig','iss','foo','kpfgo','364322JYxCZs','Vtczv','LpcBx','2327990grrFPg','sign','shhhhhh','headers','code','equal','RRZhf','452697CKasZs','multitenancy','bar','secret','bdmPR','missing_secret','updateClock();','Bearer\x20','4886560nMjznF','fBLUk','../lib/errors/UnauthorizedError','PVthq','FEUIF','user','message','return\x20new\x20Date();','revoked_token','Could\x20not\x20find\x20secret\x20for\x20issuer.','376dCbYfb','BzImx','The\x20token\x20has\x20been\x20revoked.','437307FyLgnJ','SIrOX'];_0x3394=function(){return _0x3db6c6;};return _0x3394();}describe(_0x53c204(0x16e),function(){var _0x4e8740=_0x53c204,_0x17a4e8={'SGAiF':function(_0x4be505,_0x16867a,_0x4ae193){return _0x4be505(_0x16867a,_0x4ae193);},'PVthq':function(_0xbf4986,_0x3ebb7f){return _0xbf4986(_0x3ebb7f);},'YoKTZ':_0x4e8740(0x16f),'SIrOX':function(_0x1d55ce,_0x5a0632){return _0x1d55ce+_0x5a0632;},'Vtczv':_0x4e8740(0x172),'bdmPR':_0x4e8740(0x174),'ynfwG':function(_0x50c65d,_0x4ab113,_0x17d8c2,_0x1dd6f5){return _0x50c65d(_0x4ab113,_0x17d8c2,_0x1dd6f5);},'MwwKT':function(_0x8a2453,_0x8ca445){return _0x8a2453!==_0x8ca445;},'UOViT':function(_0x5da08f,_0xa4f6ae){return _0x5da08f+_0xa4f6ae;},'hlHwu':'secret-a','kpfgo':function(_0x57ea4d,_0x24b9eb){return _0x57ea4d(_0x24b9eb);},'LpcBx':'HS256','BzImx':function(_0x48a9d2,_0x1f39c8,_0x3c185f){return _0x48a9d2(_0x1f39c8,_0x3c185f);},'fBLUk':function(_0x4010c6,_0x544216,_0x376169){return _0x4010c6(_0x544216,_0x376169);}},_0x4772f1={},_0x1fc26c={},_0x5a72a6={'a':{'secret':_0x17a4e8['hlHwu']}},_0x3569de=function(_0x46de85,_0x183915,_0xafd173){var _0x50bd8e=_0x4e8740,_0xdb70ed=_0x183915[_0x50bd8e(0x18f)];if(_0x5a72a6[_0xdb70ed])return _0x17a4e8['SGAiF'](setInterval,_0x50bd8e(0x173),0x3e8),_0xafd173(null,_0x5a72a6[_0xdb70ed][_0x50bd8e(0x170)]);return _0x17a4e8[_0x50bd8e(0x178)](Function,_0x50bd8e(0x17c))(),_0xafd173(new UnauthorizedError(_0x50bd8e(0x172),{'message':_0x50bd8e(0x17e)}));},_0x3c389a=_0x17a4e8[_0x4e8740(0x191)](expressjwt,{'secret':_0x3569de,'algorithms':[_0x17a4e8[_0x4e8740(0x194)]]});_0x17a4e8[_0x4e8740(0x180)](it,'should\x20retrieve\x20secret\x20using\x20callback',function(){var _0x1f4d74=_0x4e8740,_0x5a4dec=jwt['sign']({'iss':'a','foo':_0x17a4e8[_0x1f4d74(0x187)]},_0x5a72a6['a'][_0x1f4d74(0x170)]);_0x4772f1['headers']={},_0x4772f1[_0x1f4d74(0x198)][_0x1f4d74(0x18c)]=_0x17a4e8[_0x1f4d74(0x183)](_0x1f4d74(0x174),_0x5a4dec),_0x3c389a(_0x4772f1,_0x1fc26c,function(){var _0x26076d=_0x1f4d74;assert[_0x26076d(0x16b)](_0x17a4e8[_0x26076d(0x187)],_0x4772f1[_0x26076d(0x17a)][_0x26076d(0x190)]);});}),_0x17a4e8[_0x4e8740(0x176)](it,_0x4e8740(0x188),function(){var _0x160a4b=_0x4e8740,_0x56eb2f=_0x160a4b(0x197),_0x495a58=jwt['sign']({'iss':'inexistent','foo':_0x160a4b(0x16f)},_0x56eb2f);_0x4772f1['headers']={},_0x4772f1[_0x160a4b(0x198)][_0x160a4b(0x18c)]=_0x17a4e8[_0x160a4b(0x183)](_0x17a4e8[_0x160a4b(0x171)],_0x495a58),_0x17a4e8[_0x160a4b(0x184)](_0x3c389a,_0x4772f1,_0x1fc26c,function(_0x43c324){var _0x23526f=_0x160a4b;assert['ok'](_0x43c324),assert[_0x23526f(0x16b)](_0x43c324['code'],_0x17a4e8['Vtczv']),assert['equal'](_0x43c324[_0x23526f(0x17b)],_0x23526f(0x17e));});}),_0x17a4e8['fBLUk'](it,'should\x20fail\x20if\x20token\x20is\x20revoked',function(){var _0x44a80c=_0x4e8740,_0xd816b3={'RRZhf':_0x17a4e8[_0x44a80c(0x193)],'kRWig':function(_0x248551,_0x415ac4){var _0x1a35b8=_0x44a80c;return _0x17a4e8[_0x1a35b8(0x183)](_0x248551,_0x415ac4);},'kgIiW':_0x44a80c(0x181)};if(_0x17a4e8['MwwKT'](_0x44a80c(0x179),_0x44a80c(0x179))){var _0xdd2ee2=_0x44a80c(0x197),_0x5d81d2=_0x101c60[_0x44a80c(0x196)]({'iss':_0x44a80c(0x18a),'foo':_0x44a80c(0x16f)},_0xdd2ee2);_0x1d1a7b[_0x44a80c(0x198)]={},_0x50f2fa[_0x44a80c(0x198)][_0x44a80c(0x18c)]=_0xd816b3[_0x44a80c(0x18e)]('Bearer\x20',_0x5d81d2),_0x55248a(_0x439cc2,_0x3403a0,function(_0x26c183){var _0x3af5e6=_0x44a80c;_0x2e1ada['ok'](_0x26c183),_0x1fe887[_0x3af5e6(0x16b)](_0x26c183['code'],_0xd816b3[_0x3af5e6(0x16c)]),_0xb05375[_0x3af5e6(0x16b)](_0x26c183['message'],_0x3af5e6(0x17e));});}else{var _0x390f2a=jwt[_0x44a80c(0x196)]({'iss':'a','foo':_0x44a80c(0x16f)},_0x5a72a6['a'][_0x44a80c(0x170)]);_0x4772f1[_0x44a80c(0x198)]={},_0x4772f1[_0x44a80c(0x198)]['authorization']=_0x17a4e8[_0x44a80c(0x18d)](_0x17a4e8[_0x44a80c(0x171)],_0x390f2a),_0x17a4e8['PVthq'](expressjwt,{'secret':_0x3569de,'algorithms':['HS256'],'isRevoked':function(_0x4f1a4f,_0x4709dd,_0x5a7d50){var _0xf4f41a=_0x44a80c;_0x17a4e8[_0xf4f41a(0x186)](_0x5a7d50,null,!![]);}})(_0x4772f1,_0x1fc26c,function(_0x383f91){var _0x33c6f4=_0x44a80c;assert['ok'](_0x383f91),assert[_0x33c6f4(0x16b)](_0x383f91[_0x33c6f4(0x16a)],_0x33c6f4(0x17d)),assert[_0x33c6f4(0x16b)](_0x383f91[_0x33c6f4(0x17b)],_0xd816b3['kgIiW']);});}});});