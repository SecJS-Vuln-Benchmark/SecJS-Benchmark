function _0x3ce9(_0x1d3c42,_0x240c8c){const _0x336458=_0x3364();return _0x3ce9=function(_0x3ce92e,_0x406067){_0x3ce92e=_0x3ce92e-0x197;let _0x1a330e=_0x336458[_0x3ce92e];return _0x1a330e;},_0x3ce9(_0x1d3c42,_0x240c8c);}const _0x5c25dd=_0x3ce9;function _0x3364(){const _0x38f95b=['push','concat','flattened','ywTdf','zip','unwrapKey','BrsPh','LmXCg','../jwks','apu','ZrQIs','LIuDr','../jwa','keyManagementDecrypt','\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','sfNtP','every','PeZoE','./serializers','header','length','1237146TZjjcI','tTluw','map','tWseF','alg','dtAop','fCwkv','kid','321933XETDap','p2s','exports','./validate_headers','zelDv','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','PBES2','from','PWVZF','yrENd','\x22crit\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','JWEDecryptionFailed','FBxeU','142326VZwYtc','key\x20management\x20algorithm\x20not\x20whitelisted','Gmquv','JSON','contentEncryptionAlgorithms','swXvp','GEyfB','isArray','pzidy','573624AkPMyi','apv','JOSEAlgNotWhitelisted','PdJey','../help/base64url','bZClx','JWKSNoMatchingKey','vjhpU','tqorU','keyManagementAlgorithms','zlib','has','compact','rmuNJ','KaiUD','./generate_cek','string','split','asKey','tag','98POgLYf','some','TXsNV','enc','ymlFj','unprotected','../help/get_key','all','5arwVAM','tfaJv','CZXlw','11992uMBSZA','decode','JamTa','kMByJ','dir','41240CJGolr','301000nTNqLz','100kzbTCj','IOuQL','QibSk','ssiUm','Nguvq','decodeToBuffer'];_0x3364=function(){return _0x38f95b;};return _0x3364();}(function(_0x3a363b,_0x3dc7e4){const _0x5693ba=_0x3ce9,_0x2a5eca=_0x3a363b();while(!![]){try{const _0x3eccbc=-parseInt(_0x5693ba(0x1ec))/0x1*(-parseInt(_0x5693ba(0x1c7))/0x2)+parseInt(_0x5693ba(0x1ba))/0x3+-parseInt(_0x5693ba(0x1ef))/0x4*(parseInt(_0x5693ba(0x197))/0x5)+-parseInt(_0x5693ba(0x1b2))/0x6+-parseInt(_0x5693ba(0x1e4))/0x7*(parseInt(_0x5693ba(0x1f4))/0x8)+parseInt(_0x5693ba(0x1d0))/0x9+parseInt(_0x5693ba(0x1f5))/0xa;if(_0x3eccbc===_0x3dc7e4)break;else _0x2a5eca['push'](_0x2a5eca['shift']());}catch(_0x489db6){_0x2a5eca['push'](_0x2a5eca['shift']());}}}(_0x3364,0x35611));const {inflateRawSync}=require(_0x5c25dd(0x1da)),base64url=require(_0x5c25dd(0x1d4)),getKey=require(_0x5c25dd(0x1ea)),{KeyStore}=require(_0x5c25dd(0x1a5)),errors=require('../errors'),{check,decrypt,keyManagementDecrypt}=require(_0x5c25dd(0x1a9)),JWK=require('../jwk'),{createSecretKey}=require('../help/key_object'),generateCEK=require(_0x5c25dd(0x1df)),validateHeaders=require(_0x5c25dd(0x1bd)),{detect:resolveSerialization}=require(_0x5c25dd(0x1af)),SINGLE_RECIPIENT=new Set([_0x5c25dd(0x1dc),_0x5c25dd(0x19f)]),combineHeader=(_0x4e8dd6={},_0x35d4b1={},_0x46edff={})=>{const _0x345e8a=_0x5c25dd,_0x3a9048={'Gmquv':_0x345e8a(0x1c4),'pzidy':function(_0x5d5948,_0xc626d1){return _0x5d5948===_0xc626d1;},'ZrQIs':_0x345e8a(0x1e0),'LmXCg':function(_0x4a404e,_0x3bbe00){return _0x4a404e===_0x3bbe00;},'fCwkv':_0x345e8a(0x1a0),'svRtE':function(_0x1e5841,_0x505894){return _0x1e5841===_0x505894;}};if(_0x3a9048[_0x345e8a(0x1cf)](typeof _0x4e8dd6,_0x3a9048[_0x345e8a(0x1a7)])){if(_0x3a9048[_0x345e8a(0x1a4)](_0x3a9048[_0x345e8a(0x1b8)],_0x345e8a(0x1a0)))_0x4e8dd6=base64url[_0x345e8a(0x1ca)][_0x345e8a(0x1f0)](_0x4e8dd6);else throw new _0x5154af(_0x3a9048[_0x345e8a(0x1c9)]);}const _0x2cfced=_0x4e8dd6[_0x345e8a(0x1bb)]||_0x35d4b1[_0x345e8a(0x1bb)]||_0x46edff['p2s'],_0x2a471c=_0x4e8dd6[_0x345e8a(0x1a6)]||_0x35d4b1['apu']||_0x46edff[_0x345e8a(0x1a6)],_0x593bab=_0x4e8dd6['apv']||_0x35d4b1[_0x345e8a(0x1d1)]||_0x46edff[_0x345e8a(0x1d1)],_0x1c64fa=_0x4e8dd6['iv']||_0x35d4b1['iv']||_0x46edff['iv'],_0x1ed826=_0x4e8dd6[_0x345e8a(0x1e3)]||_0x35d4b1[_0x345e8a(0x1e3)]||_0x46edff[_0x345e8a(0x1e3)];return{..._0x4e8dd6,..._0x35d4b1,..._0x46edff,..._0x3a9048['LmXCg'](typeof _0x2cfced,_0x3a9048['ZrQIs'])?{'p2s':base64url[_0x345e8a(0x19c)](_0x2cfced)}:undefined,...typeof _0x2a471c==='string'?{'apu':base64url['decodeToBuffer'](_0x2a471c)}:undefined,..._0x3a9048['svRtE'](typeof _0x593bab,_0x345e8a(0x1e0))?{'apv':base64url[_0x345e8a(0x19c)](_0x593bab)}:undefined,..._0x3a9048['svRtE'](typeof _0x1c64fa,_0x345e8a(0x1e0))?{'iv':base64url['decodeToBuffer'](_0x1c64fa)}:undefined,...typeof _0x1ed826==='string'?{'tag':base64url[_0x345e8a(0x19c)](_0x1ed826)}:undefined};},validateAlgorithms=(_0x385964,_0x1cead5)=>{const _0x213802=_0x5c25dd;if(_0x385964!==undefined&&(!Array[_0x213802(0x1ce)](_0x385964)||_0x385964[_0x213802(0x1e5)](_0x551f42=>typeof _0x551f42!==_0x213802(0x1e0)||!_0x551f42)))throw new TypeError('\x22'+_0x1cead5+_0x213802(0x1ab));if(!_0x385964)return undefined;return new Set(_0x385964);},jweDecrypt=(_0x123ded,_0x46dd08,_0x1ef674,_0x43a9ea,{crit:crit=[],complete:complete=![],keyManagementAlgorithms:_0x28f2b6,contentEncryptionAlgorithms:_0x1a027d,maxPBES2Count:maxPBES2Count=0x2710,inflateRawSyncLimit:inflateRawSyncLimit=0x3d090}={})=>{const _0x2f4a96=_0x5c25dd,_0x2e5ecc={'tfaJv':'content\x20encryption\x20algorithm\x20not\x20whitelisted','Nguvq':function(_0x103a72,_0xf93cad){return _0x103a72(_0xf93cad);},'tqorU':_0x2f4a96(0x1c8),'kPDFd':function(_0x1631d1,_0x2871ea){return _0x1631d1||_0x2871ea;},'tTluw':function(_0x2b48fb,_0x49846b,_0x301a46){return _0x2b48fb(_0x49846b,_0x301a46);},'vjhpU':_0x2f4a96(0x1c4),'zelDv':'general','KaiUD':function(_0x45834f,_0x1d3616){return _0x45834f===_0x1d3616;},'CZXlw':_0x2f4a96(0x19f),'JamTa':_0x2f4a96(0x1dc),'jZwkf':function(_0x356674,_0x20697c,_0x2ea114,_0x13ed9c,_0x4b8e11,_0x379ca9){return _0x356674(_0x20697c,_0x2ea114,_0x13ed9c,_0x4b8e11,_0x379ca9);},'IOuQL':function(_0x534a27,_0xc1dce0,_0x5a6133,_0xaf907b){return _0x534a27(_0xc1dce0,_0x5a6133,_0xaf907b);},'htznQ':function(_0x179794,_0x441566){return _0x179794 instanceof _0x441566;},'CgAwT':'decrypt','CPJTD':function(_0xb6f57b,_0x52f805){return _0xb6f57b>_0x52f805;},'zALoK':_0x2f4a96(0x1c3),'sfNtP':_0x2f4a96(0x1b7),'GEyfB':_0x2f4a96(0x1e7),'ymlFj':function(_0x255cbf,_0x3d5804){return _0x255cbf===_0x3d5804;},'FBxeU':'ECDH-ES','TrplK':function(_0x562288,_0x747752,_0x2664fd,_0x3c579f,_0x5fae05){return _0x562288(_0x747752,_0x2664fd,_0x3c579f,_0x5fae05);},'PeZoE':_0x2f4a96(0x1f2),'qjRWs':function(_0x38cc39,_0x41dde7){return _0x38cc39||_0x41dde7;},'BrsPh':function(_0x1412c0,_0x3a2575){return _0x1412c0||_0x3a2575;},'PWVZF':'yFQCF','swXvp':function(_0x359f5b,_0x39eca4,_0x425bc9){return _0x359f5b(_0x39eca4,_0x425bc9);}};_0x43a9ea=_0x2e5ecc[_0x2f4a96(0x1b3)](getKey,_0x43a9ea,!![]),_0x28f2b6=_0x2e5ecc[_0x2f4a96(0x1b3)](validateAlgorithms,_0x28f2b6,_0x2f4a96(0x1d9)),_0x1a027d=_0x2e5ecc[_0x2f4a96(0x1b3)](validateAlgorithms,_0x1a027d,_0x2f4a96(0x1cb));if(!Array[_0x2f4a96(0x1ce)](crit)||crit[_0x2f4a96(0x1e5)](_0x116df4=>typeof _0x116df4!==_0x2f4a96(0x1e0)||!_0x116df4))throw new TypeError(_0x2e5ecc[_0x2f4a96(0x1d7)]);!_0x46dd08&&(_0x46dd08=_0x2e5ecc[_0x2f4a96(0x19b)](resolveSerialization,_0x1ef674));let _0x2920fe,_0x5d06ae,_0x4054b8,_0x173c22,_0x4a2fcc,_0x272983,_0x5b3005,_0x59198b,_0x38f0f4,_0x3a5078,_0x559ca0,_0x2062f8;if(_0x46dd08===_0x2e5ecc[_0x2f4a96(0x1be)]&&_0x2e5ecc[_0x2f4a96(0x1de)](_0x1ef674['recipients'][_0x2f4a96(0x1b1)],0x1)){_0x46dd08=_0x2e5ecc[_0x2f4a96(0x1ee)];const {recipients:_0x44e1e4,..._0x152e75}=_0x1ef674;_0x1ef674={..._0x152e75,..._0x44e1e4[0x0]};}if(SINGLE_RECIPIENT['has'](_0x46dd08)){_0x46dd08===_0x2e5ecc[_0x2f4a96(0x1f1)]?[_0x5b3005,_0x173c22,_0x4a2fcc,_0x5d06ae,_0x59198b]=_0x1ef674[_0x2f4a96(0x1e1)]('.'):{protected:_0x5b3005,encrypted_key:_0x173c22,iv:_0x4a2fcc,ciphertext:_0x5d06ae,tag:_0x59198b,unprotected:_0x38f0f4,aad:_0x559ca0,header:_0x2062f8}=_0x1ef674;!_0x123ded&&_0x2e5ecc['jZwkf'](validateHeaders,_0x5b3005,_0x38f0f4,[{'header':_0x2062f8}],!![],crit);_0x272983=_0x2e5ecc[_0x2f4a96(0x198)](combineHeader,_0x5b3005,_0x38f0f4,_0x2062f8),{alg:_0x2920fe,enc:_0x4054b8}=_0x272983;if(_0x28f2b6&&!_0x28f2b6[_0x2f4a96(0x1db)](_0x2920fe))throw new errors[(_0x2f4a96(0x1d2))](_0x2f4a96(0x1c8));if(_0x1a027d&&!_0x1a027d['has'](_0x4054b8))throw new errors['JOSEAlgNotWhitelisted'](_0x2e5ecc['tfaJv']);if(_0x2e5ecc['htznQ'](_0x43a9ea,KeyStore)){const _0x16ee2b=_0x43a9ea;let _0x10a4c1;if(_0x272983[_0x2f4a96(0x1b6)]===_0x2f4a96(0x1f3)){if(_0x2f4a96(0x1dd)!=='rmuNJ')throw new _0x401eb8[(_0x2f4a96(0x1d2))](_0x2e5ecc[_0x2f4a96(0x1ed)]);else _0x10a4c1=_0x16ee2b[_0x2f4a96(0x1eb)]({'kid':_0x272983[_0x2f4a96(0x1b9)],'alg':_0x272983['enc'],'key_ops':[_0x2e5ecc['CgAwT']]});}else _0x10a4c1=_0x16ee2b['all']({'kid':_0x272983[_0x2f4a96(0x1b9)],'alg':_0x272983[_0x2f4a96(0x1b6)],'key_ops':[_0x2f4a96(0x1a2)]});switch(_0x10a4c1['length']){case 0x0:throw new errors['JWKSNoMatchingKey']();case 0x1:_0x43a9ea=_0x10a4c1[0x0];break;default:{const _0x57e645=[];for(const _0x284b19 of _0x10a4c1){try{return jweDecrypt(!![],_0x46dd08,_0x1ef674,_0x284b19,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x1a027d?[..._0x1a027d]:undefined,'keyManagementAlgorithms':_0x28f2b6?[..._0x28f2b6]:undefined});}catch(_0x1764f4){_0x57e645[_0x2f4a96(0x19d)](_0x1764f4);continue;}}const _0x2bcd1b=new errors['JOSEMultiError'](_0x57e645);if([..._0x2bcd1b]['some'](_0x58993f=>_0x58993f instanceof errors[_0x2f4a96(0x1c5)]))throw new errors['JWEDecryptionFailed']();throw _0x2bcd1b;}}}check(_0x43a9ea,..._0x2e5ecc[_0x2f4a96(0x1de)](_0x2920fe,'dir')?['decrypt',_0x4054b8]:[_0x2f4a96(0x1aa),_0x2920fe]);if(_0x2920fe['startsWith'](_0x2f4a96(0x1c0))){if(_0x2f4a96(0x1b5)!==_0x2f4a96(0x1d5)){if(_0x272983&&_0x2e5ecc['CPJTD'](_0x272983['p2c'],maxPBES2Count)){if(_0x2e5ecc['zALoK']===_0x2f4a96(0x1e6))_0x33bca6=_0x529670(_0x7bb74);else throw new errors['JWEInvalid'](_0x2f4a96(0x1bf));}}else throw new _0x2f6523['JWEInvalid'](_0x2f4a96(0x1bf));}try{if(_0x2e5ecc[_0x2f4a96(0x1ac)]===_0x2f4a96(0x1b7)){if(_0x2920fe===_0x2f4a96(0x1f3))_0x3a5078=JWK[_0x2f4a96(0x1e2)](_0x43a9ea,{'alg':_0x4054b8,'use':_0x2e5ecc[_0x2f4a96(0x1cd)]});else{if(_0x2e5ecc[_0x2f4a96(0x1e8)](_0x2920fe,_0x2e5ecc[_0x2f4a96(0x1c6)])){const _0x1fe8e5=_0x2e5ecc['TrplK'](keyManagementDecrypt,_0x2920fe,_0x43a9ea,undefined,_0x272983);_0x3a5078=JWK[_0x2f4a96(0x1e2)](createSecretKey(_0x1fe8e5),{'alg':_0x4054b8,'use':_0x2e5ecc[_0x2f4a96(0x1cd)]});}else{if(_0x2f4a96(0x1f2)===_0x2e5ecc[_0x2f4a96(0x1ae)]){const _0x363fcf=_0x2e5ecc['TrplK'](keyManagementDecrypt,_0x2920fe,_0x43a9ea,base64url['decodeToBuffer'](_0x173c22),_0x272983);_0x3a5078=JWK[_0x2f4a96(0x1e2)](createSecretKey(_0x363fcf),{'alg':_0x4054b8,'use':_0x2f4a96(0x1e7)});}else{const _0x27c5bc=_0x483ab5(_0x40b71e,_0x5393bd,_0x1dad28[_0x2f4a96(0x19c)](_0x44784e),_0x42084b);_0x2c8de8=_0x1c5412[_0x2f4a96(0x1e2)](_0x2e5ecc[_0x2f4a96(0x19b)](_0x2df29f,_0x27c5bc),{'alg':_0x52a5c7,'use':_0x2f4a96(0x1e7)});}}}}else _0x5232f1=_0x2e7f22[_0x2f4a96(0x19c)](_0x1b2eb6);}catch(_0x53da5e){_0x3a5078=generateCEK(_0x4054b8);}let _0x3cbd72;_0x559ca0?_0x3cbd72=Buffer[_0x2f4a96(0x19e)]([Buffer[_0x2f4a96(0x1c1)](_0x2e5ecc['qjRWs'](_0x5b3005,'')),Buffer['from']('.'),Buffer[_0x2f4a96(0x1c1)](_0x559ca0)]):_0x3cbd72=Buffer['from'](_0x2e5ecc[_0x2f4a96(0x1a3)](_0x5b3005,''));try{_0x4a2fcc=base64url[_0x2f4a96(0x19c)](_0x4a2fcc);}catch(_0x5f5dd7){}try{if(_0x2e5ecc[_0x2f4a96(0x1de)](_0x2e5ecc[_0x2f4a96(0x1c2)],_0x2f4a96(0x1d3)))throw new _0x4b925b('\x22'+_0x1463ce+'\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings');else _0x59198b=base64url[_0x2f4a96(0x19c)](_0x59198b);}catch(_0x3cdc23){}let _0xf46982=_0x2e5ecc['TrplK'](decrypt,_0x4054b8,_0x3a5078,base64url[_0x2f4a96(0x19c)](_0x5d06ae),{'iv':_0x4a2fcc,'tag':_0x59198b,'aad':_0x3cbd72});_0x272983[_0x2f4a96(0x1a1)]&&(_0xf46982=_0x2e5ecc[_0x2f4a96(0x1cc)](inflateRawSync,_0xf46982,{'maxOutputLength':inflateRawSyncLimit}));if(complete){if(_0x2f4a96(0x199)===_0x2f4a96(0x19a))throw new _0x4dbd5e['JOSEAlgNotWhitelisted'](_0x2e5ecc[_0x2f4a96(0x1d8)]);else{const _0x28ace4={'cleartext':_0xf46982,'key':_0x43a9ea,'cek':_0x3a5078};if(_0x559ca0)_0x28ace4['aad']=_0x559ca0;if(_0x2062f8)_0x28ace4[_0x2f4a96(0x1b0)]=_0x2062f8;if(_0x38f0f4)_0x28ace4[_0x2f4a96(0x1e9)]=_0x38f0f4;if(_0x5b3005)_0x28ace4['protected']=base64url[_0x2f4a96(0x1ca)][_0x2f4a96(0x1f0)](_0x5b3005);return _0x28ace4;}}return _0xf46982;}validateHeaders(_0x1ef674['protected'],_0x1ef674[_0x2f4a96(0x1e9)],_0x1ef674['recipients'][_0x2f4a96(0x1b4)](({header:_0x346804})=>({'header':_0x346804})),!![],crit);const {recipients:_0x15a24f,..._0x1556a2}=_0x1ef674,_0x33e1cd=[];for(const _0x30b98f of _0x15a24f){try{if('LIuDr'===_0x2f4a96(0x1a8))return jweDecrypt(!![],_0x2f4a96(0x19f),{..._0x1556a2,..._0x30b98f},_0x43a9ea,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x1a027d?[..._0x1a027d]:undefined,'keyManagementAlgorithms':_0x28f2b6?[..._0x28f2b6]:undefined});else _0x4aa3b2=_0x55ef63[_0x2f4a96(0x19e)]([_0x33294a['from'](_0x2e5ecc['kPDFd'](_0x83733d,'')),_0x510dc0[_0x2f4a96(0x1c1)]('.'),_0x56d4d1[_0x2f4a96(0x1c1)](_0x7962c2)]);}catch(_0x12f07a){_0x33e1cd[_0x2f4a96(0x19d)](_0x12f07a);continue;}}const _0x5a3055=new errors['JOSEMultiError'](_0x33e1cd);if([..._0x5a3055][_0x2f4a96(0x1e5)](_0x5b3860=>_0x5b3860 instanceof errors['JWEDecryptionFailed']))throw new errors[(_0x2f4a96(0x1c5))]();else{if([..._0x5a3055][_0x2f4a96(0x1ad)](_0x1925ce=>_0x1925ce instanceof errors[_0x2f4a96(0x1d6)]))throw new errors[(_0x2f4a96(0x1d6))]();}throw _0x5a3055;};module[_0x5c25dd(0x1bc)]=jweDecrypt['bind'](undefined,![],undefined);