const _0x249876=_0xa697;(function(_0x44e95f,_0x178007){const _0x30e1a3=_0xa697,_0x3ff89b=_0x44e95f();while(!![]){try{const _0x17889f=-parseInt(_0x30e1a3(0xcd))/0x1+-parseInt(_0x30e1a3(0xd5))/0x2+-parseInt(_0x30e1a3(0x9a))/0x3+parseInt(_0x30e1a3(0x96))/0x4*(-parseInt(_0x30e1a3(0xc7))/0x5)+-parseInt(_0x30e1a3(0xb7))/0x6*(parseInt(_0x30e1a3(0x99))/0x7)+parseInt(_0x30e1a3(0x97))/0x8*(-parseInt(_0x30e1a3(0xc8))/0x9)+parseInt(_0x30e1a3(0xb8))/0xa*(parseInt(_0x30e1a3(0x94))/0xb);if(_0x17889f===_0x178007)break;else _0x3ff89b['push'](_0x3ff89b['shift']());}catch(_0x3eb17e){_0x3ff89b['push'](_0x3ff89b['shift']());}}}(_0x345b,0x26878));function _0xa697(_0x3b6633,_0x26d1b5){const _0x345b48=_0x345b();return _0xa697=function(_0xa69717,_0x433272){_0xa69717=_0xa69717-0x87;let _0x50cb6c=_0x345b48[_0xa69717];return _0x50cb6c;},_0xa697(_0x3b6633,_0x26d1b5);}function _0x345b(){const _0x3d6a94=['ERR_BUFFER_TOO_LARGE','bOzAw','JWE\x20Authentication\x20Tag\x20missing\x20or\x20incorrect\x20type','1859MzHCua','before','138332fTcBaP','8BCpNLu','baz','779863ZAxYxu','425445ITNKnB','setProtectedHeader','dir','DEF','encrypted_key','aYbVm','missing\x20JWE\x20Encryption\x20Algorithm\x20(enc)\x20in\x20JWE\x20Header','JmFMf','lKjtO','ERR_JWE_DECOMPRESSION_FAILED','JWE\x20format\x20validation','A128GCM','throwsAsync','decryption\x20operation\x20failed','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','JWE\x20Ciphertext\x20missing\x20or\x20incorrect\x20type','protected','JWE\x20Initialization\x20Vector\x20missing\x20or\x20incorrect\x20type','tag','plaintext','JWE\x20AAD\x20incorrect\x20type','shmtY','KelAg','setKeyManagementParameters','gMTKE','DGXhf','AES\x20CBC\x20+\x20HMAC','ciphertext','JWE\x20Protected\x20Header\x20incorrect\x20type','12TOxIcv','51290TxiAjh','additionalAuthenticatedData','APfHD','unprotected','JWE\x20Encrypted\x20Key\x20incorrect\x20type','gZcda','VcOBc','decrypt\x20inflate\x20output\x20length\x20limit','initializationVector','pWDYw','CniCf','cIFeI','prototype','MBgpR','aad','5UjCdRB','149427GCmaPi','JWE\x20Per-Recipient\x20Unprotected\x20Header\x20incorrect\x20type','set','encrypt','setSharedUnprotectedHeader','210118FUabjS','setAdditionalAuthenticatedData','GOIxO','GEzFj','context','JWE\x20Shared\x20Unprotected\x20Header\x20incorrect\x20type','PBES2-HS256+A128KW','encode','166096YZKeqE','bar','bind','XEfLf','JWE\x20Protected\x20Header\x20is\x20invalid','ERR_JWE_DECRYPTION_FAILED','secret','ERR_JWE_INVALID','FmNkS','AldBb','foo','JQBsv','The\x20Fellowship\x20of\x20the\x20Ring','missing\x20JWE\x20Algorithm\x20(alg)\x20in\x20JWE\x20Header','header','slice','A128CBC-HS256','randomFillSync','UWfzO','decrypt\x20PBES2\x20p2c\x20limit'];_0x345b=function(){return _0x3d6a94;};return _0x345b();}import _0x3f03b7 from'ava';import*as _0x204992 from'crypto';import{promisify}from'node:util';import{inflateRaw as _0x4c6ee4}from'node:zlib';const {FlattenedEncrypt,flattenedDecrypt}=await import('#dist');_0x3f03b7[_0x249876(0x95)](async _0x55ef95=>{const _0x374baa=_0x249876,_0x4ff8e5={'IcGgs':function(_0x32af74,_0x2ff7d4){return _0x32af74(_0x2ff7d4);},'qDPNa':'Itâ€™s\x20a\x20dangerous\x20business,\x20Frodo,\x20going\x20out\x20your\x20door.','yzPwi':function(_0x303635,_0x3cb6cf){return _0x303635(_0x3cb6cf);},'shmtY':_0x374baa(0x89)},_0x582d60=TextEncoder[_0x374baa(0xc4)][_0x374baa(0xd4)][_0x374baa(0xd7)](new TextEncoder());_0x55ef95['context'][_0x374baa(0xad)]=_0x4ff8e5['IcGgs'](_0x582d60,_0x4ff8e5['qDPNa']),_0x55ef95[_0x374baa(0xd1)][_0x374baa(0xb9)]=_0x4ff8e5['yzPwi'](_0x582d60,_0x4ff8e5[_0x374baa(0xaf)]),_0x55ef95[_0x374baa(0xd1)][_0x374baa(0xc0)]=new Uint8Array(0xc),_0x55ef95[_0x374baa(0xd1)][_0x374baa(0xdb)]=new Uint8Array(0x10);}),_0x3f03b7(_0x249876(0xa4),async _0x32190a=>{const _0x2fd8a9=_0x249876,_0x25a88f={'MBgpR':_0x2fd8a9(0xd6),'aYbVm':_0x2fd8a9(0xa5),'gyXHg':'Flattened\x20JWE\x20must\x20be\x20an\x20object','CniCf':function(_0x3ae945,_0x4d4388,_0x323e8b){return _0x3ae945(_0x4d4388,_0x323e8b);},'FmNkS':'JOSE\x20Header\x20missing','DHUUB':_0x2fd8a9(0xab),'JmFMf':'ERR_JWE_INVALID','ReFjj':_0x2fd8a9(0xa9),'ClAGP':_0x2fd8a9(0x93),'AldBb':function(_0x1e1320,_0x4978f0,_0x503d7b){return _0x1e1320(_0x4978f0,_0x503d7b);},'Nntzc':_0x2fd8a9(0xae),'APfHD':_0x2fd8a9(0xd2),'VcOBc':_0x2fd8a9(0xc9),'lmwgj':function(_0x31b221,_0x3bf463,_0x432f30){return _0x31b221(_0x3bf463,_0x432f30);},'XEfLf':_0x2fd8a9(0x8a),'RtpDn':function(_0x4e6066,_0x4cbebb,_0x31c65d){return _0x4e6066(_0x4cbebb,_0x31c65d);},'ZUlqa':_0x2fd8a9(0xa0)},_0x24c6ee=await new FlattenedEncrypt(_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xad)])[_0x2fd8a9(0x9b)]({'bar':_0x2fd8a9(0x98)})['setUnprotectedHeader']({'foo':_0x25a88f[_0x2fd8a9(0xc5)]})[_0x2fd8a9(0xcc)]({'alg':_0x2fd8a9(0x9c),'enc':_0x25a88f[_0x2fd8a9(0x9f)]})[_0x2fd8a9(0xce)](_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xb9)])[_0x2fd8a9(0xcb)](_0x32190a[_0x2fd8a9(0xd1)]['secret']);{await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(null,_0x32190a[_0x2fd8a9(0xd1)]['secret']),{'message':_0x25a88f['gyXHg'],'code':_0x2fd8a9(0xdc)});}{const _0x6f9d3e={..._0x24c6ee};delete _0x6f9d3e['protected'],delete _0x6f9d3e[_0x2fd8a9(0x8b)],delete _0x6f9d3e['unprotected'],await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f[_0x2fd8a9(0xc2)](flattenedDecrypt,_0x6f9d3e,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x25a88f[_0x2fd8a9(0xdd)],'code':_0x2fd8a9(0xdc)});}{const _0x2f86bc={..._0x24c6ee};delete _0x2f86bc['iv'];const _0x1730da={'message':_0x25a88f['DHUUB'],'code':_0x25a88f[_0x2fd8a9(0xa1)]};await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x2f86bc,_0x32190a['context'][_0x2fd8a9(0xdb)]),_0x1730da),_0x2f86bc['iv']=null,await _0x32190a['throwsAsync'](_0x25a88f[_0x2fd8a9(0xc2)](flattenedDecrypt,_0x2f86bc,_0x32190a[_0x2fd8a9(0xd1)]['secret']),_0x1730da);}{const _0x4f6571={..._0x24c6ee};delete _0x4f6571[_0x2fd8a9(0xb5)];const _0x21817c={'message':_0x25a88f['ReFjj'],'code':_0x25a88f[_0x2fd8a9(0xa1)]};await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f['CniCf'](flattenedDecrypt,_0x4f6571,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),_0x21817c),_0x4f6571['ciphertext']=null,await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f['CniCf'](flattenedDecrypt,_0x4f6571,_0x32190a['context'][_0x2fd8a9(0xdb)]),_0x21817c);}{const _0x75f541={..._0x24c6ee};delete _0x75f541[_0x2fd8a9(0xac)];const _0x390775={'message':_0x25a88f['ClAGP'],'code':_0x2fd8a9(0xdc)};await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x75f541,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),_0x390775),_0x75f541[_0x2fd8a9(0xac)]=null,await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f[_0x2fd8a9(0xc2)](flattenedDecrypt,_0x75f541,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),_0x390775);}{const _0x13f10e={..._0x24c6ee};_0x13f10e['protected']=null,await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f['CniCf'](flattenedDecrypt,_0x13f10e,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x2fd8a9(0xb6),'code':'ERR_JWE_INVALID'});}{const _0x2dd870={..._0x24c6ee},_0x354baf={'message':_0x2fd8a9(0xd9),'code':_0x2fd8a9(0xdc)};_0x2dd870[_0x2fd8a9(0xaa)]='1'+_0x2dd870[_0x2fd8a9(0xaa)],await _0x32190a['throwsAsync'](flattenedDecrypt(_0x2dd870,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),_0x354baf);}{const _0x4bd4ce={..._0x24c6ee};_0x4bd4ce[_0x2fd8a9(0x9e)]=null,await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f[_0x2fd8a9(0xde)](flattenedDecrypt,_0x4bd4ce,_0x32190a['context'][_0x2fd8a9(0xdb)]),{'message':_0x2fd8a9(0xbc),'code':_0x25a88f['JmFMf']});}{const _0x567d7c={..._0x24c6ee};_0x567d7c[_0x2fd8a9(0xc6)]=null,await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x567d7c,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x25a88f['Nntzc'],'code':_0x2fd8a9(0xdc)});}{const _0x4246c8={..._0x24c6ee};_0x4246c8['header']=null,await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x4246c8,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x25a88f[_0x2fd8a9(0xba)],'code':_0x2fd8a9(0xdc)});}{const _0x262179={..._0x24c6ee};_0x262179[_0x2fd8a9(0xbb)]=null,await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x262179,_0x32190a[_0x2fd8a9(0xd1)]['secret']),{'message':_0x25a88f[_0x2fd8a9(0xbe)],'code':_0x2fd8a9(0xdc)});}{const _0x589486={..._0x24c6ee};_0x589486['unprotected']={'foo':'bar'},await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x589486,_0x32190a[_0x2fd8a9(0xd1)]['secret']),{'message':'JWE\x20Protected,\x20JWE\x20Unprotected\x20Header,\x20and\x20JWE\x20Per-Recipient\x20Unprotected\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','code':_0x25a88f[_0x2fd8a9(0xa1)]});}{const _0x51c06e={..._0x24c6ee};_0x51c06e[_0x2fd8a9(0xbb)]={'enc':_0x2fd8a9(0xa5)},await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f['lmwgj'](flattenedDecrypt,_0x51c06e,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x25a88f[_0x2fd8a9(0xd8)],'code':_0x2fd8a9(0xdc)});}{const _0x4ca810={..._0x24c6ee};_0x4ca810[_0x2fd8a9(0xbb)]={'alg':'dir'},await _0x32190a[_0x2fd8a9(0xa6)](_0x25a88f['RtpDn'](flattenedDecrypt,_0x4ca810,_0x32190a[_0x2fd8a9(0xd1)][_0x2fd8a9(0xdb)]),{'message':_0x25a88f['ZUlqa'],'code':_0x25a88f['JmFMf']});}{const _0x3a54c2={..._0x24c6ee};_0x3a54c2[_0x2fd8a9(0x9e)]=_0x2fd8a9(0x87),await _0x32190a[_0x2fd8a9(0xa6)](flattenedDecrypt(_0x3a54c2,_0x32190a[_0x2fd8a9(0xd1)]['secret']),{'message':'Encountered\x20unexpected\x20JWE\x20Encrypted\x20Key','code':_0x2fd8a9(0xdc)});}}),_0x3f03b7(_0x249876(0xb4),async _0x2e062d=>{const _0x4b8615=_0x249876,_0x59d062={'lKjtO':_0x4b8615(0x8d),'bOzAw':function(_0x588680,_0x39e2c2,_0x44c74e){return _0x588680(_0x39e2c2,_0x44c74e);},'GOIxO':_0x4b8615(0xda),'PGfAt':_0x4b8615(0xa7),'eWGBY':function(_0x2dd003,_0x552392,_0xdfeb7f){return _0x2dd003(_0x552392,_0xdfeb7f);}},_0x109043=_0x204992[_0x4b8615(0x8e)](new Uint8Array(0x20)),_0x215253=await new FlattenedEncrypt(_0x2e062d[_0x4b8615(0xd1)][_0x4b8615(0xad)])[_0x4b8615(0x9b)]({'alg':_0x4b8615(0x9c),'enc':_0x59d062[_0x4b8615(0xa2)]})[_0x4b8615(0xcb)](_0x109043);{const _0x538d93={..._0x215253};_0x538d93[_0x4b8615(0xac)]='foo',await _0x2e062d[_0x4b8615(0xa6)](_0x59d062['bOzAw'](flattenedDecrypt,_0x538d93,_0x109043),{'code':_0x59d062[_0x4b8615(0xcf)],'message':_0x59d062['PGfAt']});}{const _0x19bc0c={..._0x215253};_0x19bc0c[_0x4b8615(0xb5)]=_0x4b8615(0x87),await _0x2e062d[_0x4b8615(0xa6)](_0x59d062[_0x4b8615(0x92)](flattenedDecrypt,_0x19bc0c,_0x109043),{'code':_0x59d062[_0x4b8615(0xcf)],'message':_0x4b8615(0xa7)});}{const _0x29a85d=new Uint8Array(0x20);_0x29a85d['set'](_0x109043[_0x4b8615(0x8c)](0x0,0x10),0x10),_0x29a85d[_0x4b8615(0xca)](_0x109043[_0x4b8615(0x8c)](0x10),0x0),await _0x2e062d[_0x4b8615(0xa6)](_0x59d062['eWGBY'](flattenedDecrypt,_0x215253,_0x29a85d),{'code':_0x4b8615(0xda),'message':_0x59d062['PGfAt']});}}),_0x3f03b7(_0x249876(0x90),async _0x1567bd=>{const _0x241d27=_0x249876,_0x5b6337={'myCoh':_0x241d27(0xd3),'cIFeI':_0x241d27(0x8d)},_0x56f2db=await new FlattenedEncrypt(new Uint8Array(0x0))['setProtectedHeader']({'alg':_0x5b6337['myCoh'],'enc':_0x5b6337[_0x241d27(0xc3)]})[_0x241d27(0xb1)]({'p2c':0x801})[_0x241d27(0xcb)](new Uint8Array(0x20));await _0x1567bd[_0x241d27(0xa6)](flattenedDecrypt(_0x56f2db,new Uint8Array(0x20),{'maxPBES2Count':0x800}),{'message':_0x241d27(0xa8),'code':_0x241d27(0xdc)});}),_0x3f03b7(_0x249876(0xbf),async _0x33002d=>{const _0x515fa7=_0x249876,_0x55bff5={'gZcda':_0x515fa7(0x8d),'UWfzO':function(_0x149f8e,_0x3ce95f){return _0x149f8e+_0x3ce95f;},'DGXhf':_0x515fa7(0x9c),'JQBsv':_0x515fa7(0x9d),'GEzFj':function(_0x53faed,_0x359c05,_0x54435e){return _0x53faed(_0x359c05,_0x54435e);},'gMTKE':_0x515fa7(0xa3),'KelAg':function(_0x560715,_0x253a2c){return _0x560715(_0x253a2c);},'pWDYw':_0x515fa7(0x91)};{const _0x2d8f16=await new FlattenedEncrypt(new Uint8Array(0x3d090))[_0x515fa7(0x9b)]({'alg':_0x515fa7(0x9c),'enc':_0x55bff5[_0x515fa7(0xbd)],'zip':_0x515fa7(0x9d)})['encrypt'](new Uint8Array(0x20));await flattenedDecrypt(_0x2d8f16,new Uint8Array(0x20));}{const _0x48d05f=await new FlattenedEncrypt(new Uint8Array(_0x55bff5[_0x515fa7(0x8f)](0x3d090,0x1)))[_0x515fa7(0x9b)]({'alg':_0x55bff5[_0x515fa7(0xb3)],'enc':_0x515fa7(0x8d),'zip':_0x55bff5[_0x515fa7(0x88)]})[_0x515fa7(0xcb)](new Uint8Array(0x20));await _0x33002d['throwsAsync'](_0x55bff5[_0x515fa7(0xd0)](flattenedDecrypt,_0x48d05f,new Uint8Array(0x20)),{'message':'decompression\x20operation\x20failed','code':_0x55bff5[_0x515fa7(0xb2)]});}{const _0x2306d6=await new FlattenedEncrypt(new Uint8Array(0x3e8+0x1))['setProtectedHeader']({'alg':_0x515fa7(0x9c),'enc':_0x55bff5['gZcda'],'zip':'DEF'})[_0x515fa7(0xcb)](new Uint8Array(0x20)),_0x1fa24f=_0x55bff5[_0x515fa7(0xb0)](promisify,_0x4c6ee4),_0x2a45a2=async _0x3ba4a9=>_0x1fa24f(_0x3ba4a9,{'maxOutputLength':0x3e8});await _0x33002d[_0x515fa7(0xa6)](flattenedDecrypt(_0x2306d6,new Uint8Array(0x20),{'inflateRaw':_0x2a45a2}),{'code':_0x55bff5[_0x515fa7(0xc1)]});}});