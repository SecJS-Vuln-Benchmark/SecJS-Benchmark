function _0x2ea6(_0x583790,_0x3a7f24){const _0x1e8e4b=_0x1e8e();return _0x2ea6=function(_0x2ea6cf,_0x33b708){_0x2ea6cf=_0x2ea6cf-0x109;let _0x5b1ef3=_0x1e8e4b[_0x2ea6cf];return _0x5b1ef3;},_0x2ea6(_0x583790,_0x3a7f24);}const _0x25ebdd=_0x2ea6;function _0x1e8e(){const _0x244925=['plMgD','gnqKV','toThrow','WhNHl','RzOsi','mockCertificate','should\x20validate\x20options\x20successfully\x20with\x20valid\x20parameters','xguzh','slice','408258IPJbbp','should\x20throw\x20error\x20for\x20invalid\x20options','veRdp','should\x20verify\x20signature\x20successfully','jhKnr','6087UIIEjG','jtYGJ','VQbJh','LiDfq','toBeRejectedWithError','Certificate\x20and\x20Signature\x20Validation','bKQso','dBxSL','Test\x20payload\x20passing','getAppleCertificate','fpMvH','wQvVF','VWPwi','should\x20fetch\x20and\x20validate\x20Apple\x20certificate','verifyPublicKeyIssuer','bundleId','CnfSk','uqLBTr9Uex8zCpc1UQ1MIDMitb+HUat2Mah4Kw6AVLSGe0gGNJXlih2i5X+0ZwVY0S9zY2NHWi2gFjmhjt/4kxWGMkupqXX5H/qhE2m7hzox6lZJpH98ZEUbouWRfZX2ZhUlCkAX09oRNi7fI7mWL1/o88MaI/y6k6tLr14JTzmlxgdyhw+QRLxRPA6NuvUlRSJpyJ4aGtNH5/wHdKQWL8nUnFYiYmaY8R7IjzNxPfy8UJTUWmeZvMSgND4u8EjADPsz7ZtZyWAPi8kYcAb6M8k0jwLD3vrYCB8XXyO2RQb/FY2TM4zJuI7PzLlvvgOJXbbfVtHx7Evnm5NYoyzgzw==','BgklF','invalidSignature','cloud.xtralife.gamecenterauth','PqcVB','WmAlN','fetchCertificate','verifySignature','should\x20throw\x20error\x20for\x20invalid\x20signature\x20verification','toBe','3261715rjDoSO','BYmaz','sIZlO','enableInsecureAuth','validateAuthData','PkwKY','DzqqrQ==','30clNYQY','validateOptions','npnmx','throwError','withContext','Invalid\x20publicKeyUrl','https://malicious.url.com/key.cer','should\x20throw\x20error\x20for\x20missing\x20authData\x20fields','../../../lib/Adapters/Auth/gcenter','resolve','Test\x20payload\x20fails\x20due\x20to\x20incorrect\x20appId\x20/\x20certificate','Invalid\x20signature.','xsYhN','toString','G:1965586982','1cnZxZQ','not','CvGWU','zDJrW','should\x20not\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20secure\x20mode','../../support/cert/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','AuthData\x20id\x20is\x20missing.','Invalid\x20publicKeyUrl:\x20https://malicious.url.com/key.cer','wgKoc','1720872zNnmDc','https://static.gc.apple.com/public-key/gc-prod-4.cer','TJSDz','WnIiQ','1464ZoIelL','sfVtj','buffer','should\x20successfully\x20process\x20valid\x20payload\x20and\x20save\x20auth\x20data','returnValue','publicKeyUrl','validSignature','readFileSync','864472nJkbxP','KQfCq','169047FBaqsR','1782099cFgOzD','YkOIh','and','HHwmA','1234567','byteOffset','vYAbx','YZDAq','should\x20not\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20insecure\x20mode','guoVg','certificateFromPem','390opHvaQ','oxUwv','content-length','length','tcmkN','com.valid.app','Test\x20config\x20failing\x20due\x20to\x20missing\x20params\x20or\x20wrong\x20types','gvPMy','validKey','stringify','saltST==','default','XdykN','ofjDC','TdNuq','constructor','cqsTX','../../support/cert/gc-prod-4.cer','JMuBy','ZaFed','ykOmy','should\x20throw\x20error\x20for\x20invalid\x20publicKeyUrl','varJS','cache','rsCNY','https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','YlVUq'];_0x1e8e=function(){return _0x244925;};return _0x1e8e();}(function(_0x1f34cd,_0x40528b){const _0x1447fb=_0x2ea6,_0x4c7c27=_0x1f34cd();while(!![]){try{const _0x18fbba=-parseInt(_0x1447fb(0x138))/0x1*(parseInt(_0x1447fb(0x17f))/0x2)+-parseInt(_0x1447fb(0x184))/0x3*(-parseInt(_0x1447fb(0x145))/0x4)+-parseInt(_0x1447fb(0x122))/0x5+parseInt(_0x1447fb(0x129))/0x6*(-parseInt(_0x1447fb(0x14d))/0x7)+parseInt(_0x1447fb(0x141))/0x8+parseInt(_0x1447fb(0x14f))/0x9*(parseInt(_0x1447fb(0x15b))/0xa)+parseInt(_0x1447fb(0x150))/0xb;if(_0x18fbba===_0x40528b)break;else _0x4c7c27['push'](_0x4c7c27['shift']());}catch(_0x51cbf5){_0x4c7c27['push'](_0x4c7c27['shift']());}}}(_0x1e8e,0x5c5cd));const GameCenterAuth=require(_0x25ebdd(0x131))[_0x25ebdd(0x166)],{pki}=require('node-forge'),fs=require('fs'),path=require('path');describe('GameCenterAuth\x20Adapter',function(){const _0x5eea27=_0x25ebdd,_0x334004={'HHwmA':_0x5eea27(0x16c),'jtYGJ':_0x5eea27(0x13d),'fpMvH':_0x5eea27(0x142),'LiDfq':'GET','WmAlN':_0x5eea27(0x174),'DZVOU':_0x5eea27(0x15d),'wgKoc':_0x5eea27(0x13a),'zDJrW':_0x5eea27(0x160),'WnIiQ':function(_0x413ec8,_0x5965fb,_0x567312){return _0x413ec8(_0x5965fb,_0x567312);},'TdNuq':_0x5eea27(0x180),'PqcVB':_0x5eea27(0x17c),'VWPwi':function(_0x6cb24f,_0x2fa15f){return _0x6cb24f===_0x2fa15f;},'varJS':'FNHUv','CnfSk':function(_0x1d21b7,_0x4b6491){return _0x1d21b7(_0x4b6491);},'bKQso':function(_0x4f91a8,_0x5ef0b0){return _0x4f91a8(_0x5ef0b0);},'VQbJh':'Invalid\x20signature.','jhKnr':_0x5eea27(0x13f),'sIZlO':function(_0x569dce,_0x3cddfe,_0x58b3f8){return _0x569dce(_0x3cddfe,_0x58b3f8);},'sfVtj':_0x5eea27(0x120),'wFlEC':function(_0x49a73f,_0x451480,_0x4448f0){return _0x49a73f(_0x451480,_0x4448f0);},'wQvVF':function(_0x8f9cd4,_0x336652){return _0x8f9cd4(_0x336652);},'YZDAq':_0x5eea27(0x148),'jchDP':_0x5eea27(0x15a),'xpBPy':_0x5eea27(0x137),'tcmkN':_0x5eea27(0x128),'BgklF':_0x5eea27(0x11b),'GWVSR':function(_0x328902,_0x30ddf8){return _0x328902(_0x30ddf8);},'xsYhN':'uqLBTr9Uex8zCpc1UQ1MIDMitb+HUat2Mah4Kw6AVLSGe0gGNJXlih2i5X+0ZwVY0S9zY2NHWi2gFjmhjt/4kxWGMkupqXX5H/qhE2m7hzox6lZJpH98ZEUbouWRfZX2ZhUlCkAX09oRNi7fI7mWL1/o88MaI/y6k6tLr14JTzmlxgdyhw+QRLxRPA6NuvUlRSJpyJ4aGtNH5/wHdKQWL8nUnFYiYmaY8R7IjzNxPfy8UJTUWmeZvMSgND4u8EjADPsz7ZtZyWAPi8kYcAb6M8k0jwLD3vrYCB8XXyO2RQb/FY2TM4zJuI7PzLlvvgOJXbbfVtHx7Evnm5NYoyzgzw==','iTFAb':'verifyPublicKeyIssuer','Jjeen':_0x5eea27(0x114),'jidNK':_0x5eea27(0x158),'cqsTX':_0x5eea27(0x161),'nnaze':function(_0x27b2c0,_0x16ec3f,_0x780716){return _0x27b2c0(_0x16ec3f,_0x780716);},'gnqKV':'Test\x20payload\x20failing\x20due\x20to\x20missing\x20params\x20or\x20wrong\x20types','ykOmy':_0x5eea27(0x133),'guoVg':_0x5eea27(0x10f),'ZaFed':_0x5eea27(0x10c)};let _0x21049d;beforeEach(function(){const _0x1f87bd=_0x5eea27;if(_0x1f87bd(0x167)===_0x1f87bd(0x15c)){const _0x163ce8={'bundleId':_0x1f87bd(0x160),'enableInsecureAuth':![]};_0x4062e1(()=>_0x3271f9[_0x1f87bd(0x12a)](_0x163ce8))[_0x1f87bd(0x139)][_0x1f87bd(0x178)]();}else{_0x21049d=new GameCenterAuth[(_0x1f87bd(0x16a))]();const _0x1b486a=fs[_0x1f87bd(0x14c)](path[_0x1f87bd(0x132)](__dirname,_0x334004[_0x1f87bd(0x153)])),_0x482979=fs[_0x1f87bd(0x14c)](path[_0x1f87bd(0x132)](__dirname,_0x334004[_0x1f87bd(0x185)]))[_0x1f87bd(0x136)]();mockFetch([{'url':_0x334004[_0x1f87bd(0x111)],'method':_0x334004[_0x1f87bd(0x10a)],'response':{'ok':!![],'headers':new Map(),'arrayBuffer':()=>Promise[_0x1f87bd(0x132)](_0x1b486a[_0x1f87bd(0x147)][_0x1f87bd(0x17e)](_0x1b486a['byteOffset'],_0x1b486a[_0x1f87bd(0x155)]+_0x1b486a['length']))}},{'url':_0x334004[_0x1f87bd(0x11d)],'method':_0x334004[_0x1f87bd(0x10a)],'response':{'ok':!![],'headers':new Map([['content-type','application/x-pem-file'],[_0x334004['DZVOU'],_0x482979[_0x1f87bd(0x15e)]['toString']()]]),'text':()=>Promise[_0x1f87bd(0x132)](_0x482979)}}]);}}),describe(_0x334004[_0x5eea27(0x16b)],function(){const _0x5a29b1=_0x5eea27,_0x1f34ed={'dBxSL':_0x334004[_0x5a29b1(0x13b)]};_0x334004[_0x5a29b1(0x144)](it,_0x334004[_0x5a29b1(0x169)],async function(){const _0x5961cc=_0x5a29b1,_0x49cf7c=[null,undefined,{},{'bundleId':''},{'enableInsecureAuth':![]}];for(const _0x865bdf of _0x49cf7c){if(_0x334004[_0x5961cc(0x140)]!==_0x334004[_0x5961cc(0x140)]){const _0x2fade8=[null,_0x483a75,{},{'bundleId':''},{'enableInsecureAuth':![]}];for(const _0x2d420d of _0x2fade8){_0x94d0fe(()=>_0x260f0f['validateOptions'](_0x2d420d))[_0x5961cc(0x12d)](_0x2e95ec[_0x5961cc(0x164)](_0x2d420d))['toThrow']();}}else expect(()=>_0x21049d[_0x5961cc(0x12a)](_0x865bdf))[_0x5961cc(0x12d)](JSON[_0x5961cc(0x164)](_0x865bdf))[_0x5961cc(0x178)]();}}),_0x334004[_0x5a29b1(0x144)](it,_0x334004[_0x5a29b1(0x11c)],function(){const _0x2158e7=_0x5a29b1,_0x180a78={'bundleId':_0x1f34ed[_0x2158e7(0x10e)],'enableInsecureAuth':![]};expect(()=>_0x21049d[_0x2158e7(0x12a)](_0x180a78))[_0x2158e7(0x139)][_0x2158e7(0x178)]();});}),_0x334004['nnaze'](describe,_0x334004[_0x5eea27(0x177)],function(){const _0x52986e=_0x5eea27;it(_0x52986e(0x130),async function(){const _0x2f5dc4=_0x52986e,_0x5e2624={'WhNHl':function(_0x2613d3,_0x4a7178){return _0x2613d3(_0x4a7178);},'fTLRx':_0x334004['TdNuq'],'KQfCq':_0x334004[_0x2f5dc4(0x11c)]};if(_0x334004[_0x2f5dc4(0x113)]('FNHUv',_0x334004[_0x2f5dc4(0x171)]))await _0x334004['CnfSk'](expectAsync,_0x21049d[_0x2f5dc4(0x126)]({}))[_0x2f5dc4(0x10b)](_0x2f5dc4(0x13e));else{const _0x5428a3={'xguzh':function(_0xb2799,_0x915e75){const _0x4b35a6=_0x2f5dc4;return _0x5e2624[_0x4b35a6(0x179)](_0xb2799,_0x915e75);}};_0x4b50ad(_0x5e2624['fTLRx'],async function(){const _0x2cdc2f=_0x2f5dc4,_0x2dcbef=[null,_0x2095ce,{},{'bundleId':''},{'enableInsecureAuth':![]}];for(const _0x5ca100 of _0x2dcbef){_0x5428a3[_0x2cdc2f(0x17d)](_0x2ee5c5,()=>_0x2aceac[_0x2cdc2f(0x12a)](_0x5ca100))['withContext'](_0x5f1cb4['stringify'](_0x5ca100))[_0x2cdc2f(0x178)]();}}),_0x43cb62(_0x5e2624[_0x2f5dc4(0x14e)],function(){const _0x5e2e17=_0x2f5dc4,_0x2ec9b2={'bundleId':'com.valid.app','enableInsecureAuth':![]};_0x599a4d(()=>_0x570809[_0x5e2e17(0x12a)](_0x2ec9b2))['not'][_0x5e2e17(0x178)]();});}});}),_0x334004[_0x5eea27(0x124)](describe,_0x334004[_0x5eea27(0x16f)],function(){const _0x3d339f=_0x5eea27,_0x4d19a4={'veRdp':_0x3d339f(0x168),'YlVUq':function(_0x458568,_0x43dc8c){const _0x9f4a40=_0x3d339f;return _0x334004[_0x9f4a40(0x117)](_0x458568,_0x43dc8c);},'plMgD':_0x334004[_0x3d339f(0x183)]};_0x334004[_0x3d339f(0x124)](it,_0x3d339f(0x170),async function(){const _0xf3e38c=_0x3d339f;if(_0x4d19a4[_0xf3e38c(0x181)]!==_0xf3e38c(0x12b)){const _0x216264=_0xf3e38c(0x12f);spyOn(_0x21049d,'fetchCertificate')[_0xf3e38c(0x152)][_0xf3e38c(0x12c)](new Error(_0xf3e38c(0x12e))),await _0x4d19a4[_0xf3e38c(0x175)](expectAsync,_0x21049d[_0xf3e38c(0x110)](_0x216264))['toBeRejectedWithError'](_0x4d19a4[_0xf3e38c(0x176)]);}else _0x37af69(()=>_0x19a74f[_0xf3e38c(0x12a)](_0x48578c))['withContext'](_0xc582be[_0xf3e38c(0x164)](_0x15e5e6))[_0xf3e38c(0x178)]();}),it(_0x334004[_0x3d339f(0x146)],async function(){const _0x1a8dd0=_0x3d339f,_0x621199='invalid-key',_0x3dff9d={'id':_0x1a8dd0(0x154),'publicKeyUrl':_0x334004[_0x1a8dd0(0x111)],'timestamp':0x154294754f7,'salt':_0x1a8dd0(0x165),'signature':_0x1a8dd0(0x11a)};_0x334004[_0x1a8dd0(0x144)](spyOn,_0x21049d,_0x1a8dd0(0x110))[_0x1a8dd0(0x152)][_0x1a8dd0(0x149)](Promise[_0x1a8dd0(0x132)](_0x621199)),spyOn(_0x21049d,_0x1a8dd0(0x11f))['and']['throwError'](_0x1a8dd0(0x134)),await _0x334004[_0x1a8dd0(0x10d)](expectAsync,_0x21049d[_0x1a8dd0(0x126)](_0x3dff9d))[_0x1a8dd0(0x10b)](_0x334004[_0x1a8dd0(0x109)]);});}),describe(_0x334004[_0x5eea27(0x159)],function(){const _0x8b2039=_0x5eea27,_0x19913a={'RzOsi':_0x8b2039(0x160),'TJSDz':function(_0x43039b,_0x2bc4ab,_0x483aa4){return _0x334004['wFlEC'](_0x43039b,_0x2bc4ab,_0x483aa4);},'GJEtE':function(_0x3898e7,_0x3f908f){const _0x22762e=_0x8b2039;return _0x334004[_0x22762e(0x112)](_0x3898e7,_0x3f908f);}};it(_0x334004[_0x8b2039(0x157)],async function(){const _0x31d513=_0x8b2039,_0x5809f9={'id':'1234567','publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer','timestamp':0x154294754f7,'salt':_0x31d513(0x165),'signature':_0x31d513(0x14b),'bundleId':_0x19913a[_0x31d513(0x17a)]};_0x19913a[_0x31d513(0x143)](spyOn,_0x21049d,'getAppleCertificate')[_0x31d513(0x152)][_0x31d513(0x149)](Promise['resolve'](_0x31d513(0x163))),spyOn(_0x21049d,'verifySignature')['and'][_0x31d513(0x149)](!![]),await _0x19913a['GJEtE'](expectAsync,_0x21049d[_0x31d513(0x126)](_0x5809f9))['toBeResolved']();});}),describe(_0x334004[_0x5eea27(0x16e)],function(){const _0x59d13e=_0x5eea27,_0x3ff359={'gvPMy':_0x59d13e(0x118),'vYAbx':_0x334004[_0x59d13e(0x119)],'PkwKY':function(_0x30c378,_0x590d8c,_0x5ae8d8){return _0x30c378(_0x590d8c,_0x5ae8d8);},'rsCNY':function(_0x5e786b,_0x962be9){return _0x5e786b(_0x962be9);},'JMuBy':'G:1965586982','BYmaz':_0x334004[_0x59d13e(0x111)],'YkOIh':_0x334004['tcmkN']};_0x334004[_0x59d13e(0x144)](it,_0x334004['Jjeen'],async function(){const _0x48ad7b=_0x59d13e,_0x16acac='https://static.gc.apple.com/public-key/gc-prod-4.cer',_0x37f444=_0x48ad7b(0x17b);_0x334004[_0x48ad7b(0x144)](spyOn,_0x21049d,_0x48ad7b(0x11e))[_0x48ad7b(0x152)][_0x48ad7b(0x149)](Promise[_0x48ad7b(0x132)]({'certificate':_0x37f444,'headers':new Map()})),spyOn(pki,_0x334004['jchDP'])[_0x48ad7b(0x152)]['returnValue']({}),_0x21049d[_0x48ad7b(0x172)][_0x16acac]=_0x37f444;const _0x11cc23=await _0x21049d[_0x48ad7b(0x110)](_0x16acac);_0x334004[_0x48ad7b(0x117)](expect,_0x11cc23)[_0x48ad7b(0x121)](_0x37f444);}),_0x334004[_0x59d13e(0x124)](it,_0x59d13e(0x182),async function(){const _0x594c8a=_0x59d13e,_0x585959={'id':_0x334004['xpBPy'],'publicKeyUrl':_0x334004[_0x594c8a(0x111)],'timestamp':0x16c7096de77,'signature':_0x594c8a(0x118),'salt':_0x334004[_0x594c8a(0x15f)]};_0x21049d['bundleId']=_0x334004[_0x594c8a(0x119)],_0x21049d[_0x594c8a(0x125)]=![],spyOn(_0x21049d,'verifyPublicKeyIssuer')[_0x594c8a(0x152)][_0x594c8a(0x149)]();const _0x36e1c9=await _0x21049d[_0x594c8a(0x110)](_0x585959[_0x594c8a(0x14a)]);_0x334004['GWVSR'](expect,()=>_0x21049d[_0x594c8a(0x11f)](_0x36e1c9,_0x585959))[_0x594c8a(0x139)]['toThrow']();}),it(_0x59d13e(0x13c),async function(){const _0x2fd964=_0x59d13e,_0x184a20={'id':_0x2fd964(0x137),'publicKeyUrl':_0x2fd964(0x142),'timestamp':0x16c7096de77,'signature':_0x3ff359[_0x2fd964(0x162)],'salt':_0x2fd964(0x128),'bundleId':'com.example.insecure.app'};_0x21049d[_0x2fd964(0x116)]=_0x3ff359[_0x2fd964(0x156)],_0x21049d['enableInsecureAuth']=![],_0x3ff359[_0x2fd964(0x127)](spyOn,_0x21049d,'verifyPublicKeyIssuer')[_0x2fd964(0x152)][_0x2fd964(0x149)]();const _0x4fc0c2=await _0x21049d[_0x2fd964(0x110)](_0x184a20[_0x2fd964(0x14a)]);_0x3ff359[_0x2fd964(0x173)](expect,()=>_0x21049d['verifySignature'](_0x4fc0c2,_0x184a20))[_0x2fd964(0x139)][_0x2fd964(0x178)]();}),it(_0x334004['jidNK'],async function(){const _0x3e3041=_0x59d13e,_0x3c98c4={'id':_0x334004['xpBPy'],'publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer','timestamp':0x16c7096de77,'signature':_0x334004[_0x3e3041(0x135)],'salt':_0x334004[_0x3e3041(0x15f)],'bundleId':'com.example.insecure.app'};_0x21049d[_0x3e3041(0x116)]=_0x3e3041(0x11b),_0x21049d[_0x3e3041(0x125)]=!![],_0x334004[_0x3e3041(0x124)](spyOn,_0x21049d,_0x334004['iTFAb'])[_0x3e3041(0x152)][_0x3e3041(0x149)]();const _0x508c8b=await _0x21049d[_0x3e3041(0x110)](_0x3c98c4[_0x3e3041(0x14a)]);expect(()=>_0x21049d[_0x3e3041(0x11f)](_0x508c8b,_0x3c98c4))[_0x3e3041(0x139)][_0x3e3041(0x178)]();}),it('can\x20\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20insecure\x20mode',async function(){const _0x235c58=_0x59d13e,_0x537467={'id':_0x3ff359[_0x235c58(0x16d)],'publicKeyUrl':_0x3ff359[_0x235c58(0x123)],'timestamp':0x16c7096de77,'signature':_0x235c58(0x118),'salt':_0x3ff359[_0x235c58(0x151)],'bundleId':'cloud.xtralife.gamecenterauth'};_0x21049d['enableInsecureAuth']=!![],spyOn(_0x21049d,_0x235c58(0x115))[_0x235c58(0x152)][_0x235c58(0x149)]();const _0x29b683=await _0x21049d['getAppleCertificate'](_0x537467[_0x235c58(0x14a)]);expect(()=>_0x21049d['verifySignature'](_0x29b683,_0x537467))[_0x235c58(0x139)][_0x235c58(0x178)]();});});});