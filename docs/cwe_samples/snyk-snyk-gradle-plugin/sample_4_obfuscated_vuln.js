function _0x2b51(){const _0x26044f=['SBGKH','localhost','YTvtJ','qVMEH','VaSkV','dtCef','aKzYp','searchParams','1492272ZhmPPK','NrYpu','call','WqKfW','SYpuI','https://example.com/test','mNQBt','test@localhost:8080','string','Input\x20Validation','equal','22HoJjjD','createElement','yuoqq','ufRxn','ZiMMb','MHxJi','Browser\x20Environment','Mvhfs','reject','resolve','message','MvRDs','address\x20is\x20required','jbvea','lXMBN','timeout','floor','WebFinger\x20Browser\x20Tests','/.well-known/webfinger?resource={uri}','XTkSG','test@localhost','dPdnB','should\x20block\x20private\x20IPv4\x20addresses','lrdd','JBQcj','MtphQ','pathname','beCCt','QJpLl','uqOtv','should\x20load\x20WebFinger\x20in\x20browser','nLAiW','kVydw','FhkmC','idx','should\x20reject\x20when\x20called\x20with\x20no\x20parameters','get','Module\x20Loading','Failed\x20to\x20fetch','object','AqTQy','WvXgc','AHSPb','profile','JRD\x20Data\x20Structure\x20Validation','aALSM','should\x20handle\x20network\x20error\x20scenarios','TDYtk','originalFetch','vHTNm','href','PiyBr','SBvvq','http://localhost:','should\x20have\x20access\x20to\x20fetch\x20API','user@localhost:','lookupLink','exist','unsupported\x20rel','acct:','udaue','http://packetizer.com/ns/name','RyRiq','pkDRy','UzOpJ','http://webfinger.net/rel/profile-page','PPQza','NROHf','1381445qWJYMg','http://webfinger.net/rel/avatar','replace','port','should\x20handle\x20JRD\x20with\x20properties','stop','MjueJ','tcWJN','acct:user@localhost:PORT','Test\x20User','vCiqV','brvBf','zwtOE','rel','should\x20work\x20with\x20browser\x20globals','aAXHa','WCrQa','YcoGk','application/json','yjQDw','xiSJl','match','gAtHv','instanceOf','array','test@nonexistent-domain-12345.com','properties','IueEt','ronkF','SPUUZ','1186168pAjJzU','OaUTR','WebFinger','acct:test@localhost:PORT','onerror','should\x20find\x20specific\x20link\x20relations','user@localhost','/.well-known/host-meta','test@localhost:','dxCgw','acct:test@localhost:','IIihF','forEach','src','KRLPT','IDQLc','RHQOA','lookup','includes','nfNJn','MuYTM','PcLZp','pvMiZ','fetch','voLlS','gDGGf','qKxdZ','dpcaJ','TdJrm','include','aeiKO','VVINF','XbHBU','MmoQd','Fallback\x20Mechanisms','/.well-known/host-meta.json','Vlipl','should\x20create\x20a\x20WebFinger\x20instance','UyasZ','xrSWP','should\x20create\x20instance\x20with\x20custom\x20configuration','hjWHA','xiHcA','stringify','GieWB','SRZrJ','should\x20block\x20private\x20addresses\x20when\x20allow_private_addresses\x20is\x20false','script','location','SDumq','3247sDunqa','65690UJMpqB','PORT','cuFnR','kkfmq','QNJmp','TQijp','KAgwf','YeUNK','qqubn','ZRZlo','SVdTQ','zOMNy','https://example.com/avatar.png','RsqHU','mpTsb','private\x20or\x20internal\x20addresses\x20are\x20not\x20allowed','resource','HUYCU','PvALJ','133FVeojX','591540mmVIOS','hzuQL','resource\x20not\x20found','54LoKzil','subject','invalid\x20useraddress\x20format','JRFKo','asdfg','links','XNRho','iWpyC','should\x20handle\x20server\x20errors\x20gracefully','cHoPf','Should\x20have\x20thrown','/.tmp/webfinger.js','head','ebdsg','FSSdd','appendChild','72664tbiqqF','that','JdlrB','NvPuQ','parse','dYtMb','function','nYCbt'];_0x2b51=function(){return _0x26044f;};return _0x2b51();}const _0x2ebfc3=_0x53f6;(function(_0x597b71,_0x450260){const _0x35b229=_0x53f6,_0x247b58=_0x597b71();while(!![]){try{const _0x3549ee=parseInt(_0x35b229(0x80))/0x1*(-parseInt(_0x35b229(0xc3))/0x2)+-parseInt(_0x35b229(0x95))/0x3+parseInt(_0x35b229(0x125))/0x4+parseInt(_0x35b229(0x107))/0x5+-parseInt(_0x35b229(0xb8))/0x6+-parseInt(_0x35b229(0x94))/0x7*(-parseInt(_0x35b229(0xa8))/0x8)+parseInt(_0x35b229(0x98))/0x9*(-parseInt(_0x35b229(0x81))/0xa);if(_0x3549ee===_0x450260)break;else _0x247b58['push'](_0x247b58['shift']());}catch(_0x127fd6){_0x247b58['push'](_0x247b58['shift']());}}}(_0x2b51,0x36c81));function _0x53f6(_0x3bd837,_0x39c6ae){const _0x2b51b3=_0x2b51();return _0x53f6=function(_0x53f68b,_0x330d2f){_0x53f68b=_0x53f68b-0x7f;let _0x547bde=_0x2b51b3[_0x53f68b];return _0x547bde;},_0x53f6(_0x3bd837,_0x39c6ae);}import{expect}from'@esm-bundle/chai';async function loadWebFinger(){const _0x7c43a3=_0x53f6;if(window[_0x7c43a3(0x127)])return window['WebFinger'];return new Promise((_0x5cd1d5,_0x2a02eb)=>{const _0x13c257=_0x7c43a3,_0x29b519=document[_0x13c257(0xc4)]('script');_0x29b519[_0x13c257(0x132)]=_0x13c257(0xa3),_0x29b519['onload']=()=>_0x5cd1d5(window[_0x13c257(0x127)]),_0x29b519[_0x13c257(0x129)]=_0x2a02eb,document[_0x13c257(0xa4)][_0x13c257(0xa7)](_0x29b519);});}describe(_0x2ebfc3(0xd4),()=>{const _0x4ec29f=_0x2ebfc3,_0x34091f={'beCCt':function(_0x4ad2e9){return _0x4ad2e9();},'FSSdd':function(_0xbaee3a,_0x2fd85b){return _0xbaee3a(_0x2fd85b);},'iWpyC':_0x4ec29f(0xae),'KAgwf':_0x4ec29f(0x97),'aeiKO':_0x4ec29f(0x134),'MjueJ':function(_0x2d5179,_0x4e6adc){return _0x2d5179(_0x4e6adc);},'RHQOA':function(_0x250a5c,_0x551fda){return _0x250a5c(_0x551fda);},'hzuQL':function(_0x4d7e8d,_0x20b527){return _0x4d7e8d===_0x20b527;},'MtphQ':_0x4ec29f(0x14e),'dtCef':_0x4ec29f(0xe1),'AqTQy':function(_0x290820,_0x1467b6,_0x4e1193){return _0x290820(_0x1467b6,_0x4e1193);},'ieaAf':_0x4ec29f(0x14a),'qVMEH':_0x4ec29f(0x9a),'lNggW':_0x4ec29f(0x133),'xiSJl':_0x4ec29f(0xa2),'YTvtJ':_0x4ec29f(0xe6),'MuYTM':_0x4ec29f(0x84),'TDYtk':function(_0x989658,_0x21ff91){return _0x989658(_0x21ff91);},'uqOtv':_0x4ec29f(0x115),'wUqQm':_0x4ec29f(0x14d),'JBQcj':function(_0x4f9df1,_0x3ec861){return _0x4f9df1(_0x3ec861);},'gDGGf':function(_0x14f4c,_0x7cc533){return _0x14f4c!==_0x7cc533;},'NrYpu':'riqac','zOMNy':_0x4ec29f(0xc5),'dYtMb':function(_0x175ecd,_0x23fa7b){return _0x175ecd(_0x23fa7b);},'FKPVz':function(_0x5236a3,_0x59ee79){return _0x5236a3(_0x59ee79);},'SRZrJ':'lrdd','YcoGk':function(_0x3d9a53){return _0x3d9a53();},'NROHf':function(_0x4ac0be,_0x533da6,_0xedd322){return _0x4ac0be(_0x533da6,_0xedd322);},'WvXgc':'should\x20perform\x20successful\x20WebFinger\x20lookup\x20with\x20mock\x20server','IueEt':_0x4ec29f(0xa0),'voLlS':function(_0x13c830,_0x40e5da){return _0x13c830(_0x40e5da);},'SBvvq':function(_0x4b231c){return _0x4b231c();},'cHoPf':_0x4ec29f(0x110),'OaUTR':function(_0x1013f7,_0x40933b,_0x35167c){return _0x1013f7(_0x40933b,_0x35167c);},'udaue':'should\x20return\x20properly\x20structured\x20JRD\x20response','JRFKo':function(_0x4711ad,_0x5e0c27){return _0x4711ad(_0x5e0c27);},'cuFnR':_0x4ec29f(0xbd),'YeUNK':'nonexistent','IdiYB':_0x4ec29f(0x12a),'pvMiZ':function(_0x3c2340){return _0x3c2340();},'QNJmp':function(_0x581f0e,_0x1776b2){return _0x581f0e(_0x1776b2);},'UzOpJ':function(_0x192117,_0x164262){return _0x192117!==_0x164262;},'ajdSb':'xxtiL','QJpLl':function(_0x5a3195,_0xa064ea){return _0x5a3195(_0xa064ea);},'WqKfW':_0x4ec29f(0xf1),'SVdTQ':_0x4ec29f(0x7f),'bUXxj':function(_0x135da2,_0x297d4c){return _0x135da2(_0x297d4c);},'PPQza':'private\x20or\x20internal\x20addresses\x20are\x20not\x20allowed','aAXHa':function(_0x449cee,_0x429a07,_0x43684e){return _0x449cee(_0x429a07,_0x43684e);},'kVydw':_0x4ec29f(0xf4),'jbvea':_0x4ec29f(0xe2),'jiIcs':function(_0x4620aa,_0x57a27d){return _0x4620aa(_0x57a27d);},'MHxJi':function(_0x2f33ed,_0x1392dc){return _0x2f33ed(_0x1392dc);},'brvBf':_0x4ec29f(0x153),'SPUUZ':_0x4ec29f(0xd9),'IIihF':_0x4ec29f(0xe8),'pkDRy':_0x4ec29f(0xc9),'UyasZ':'Configuration','SBGKH':'Real\x20WebFinger\x20Lookups','XNRho':_0x4ec29f(0xef),'aALSM':'Link\x20Relation\x20Lookups','PMxVt':_0x4ec29f(0x147)};let _0xc98f41,_0x20c6f5;before(async()=>{const _0x29dd4c=_0x4ec29f;_0xc98f41=await _0x34091f[_0x29dd4c(0xde)](loadWebFinger);}),beforeEach(()=>{_0x20c6f5=new _0xc98f41({'webfist_fallback':!![],'uri_fallback':!![],'request_timeout':0x1388,'allow_private_addresses':!![]});}),describe(_0x34091f[_0x4ec29f(0x130)],()=>{const _0x57d0f8=_0x4ec29f;_0x34091f[_0x57d0f8(0x96)](_0x34091f[_0x57d0f8(0xdc)],_0x57d0f8(0xd1))?_0x447580[_0x57d0f8(0x13c)]=_0xf888f2:(it(_0x34091f[_0x57d0f8(0xb5)],()=>{const _0x17af44=_0x57d0f8;_0x34091f[_0x17af44(0xa6)](expect,_0xc98f41)['to']['be']['a'](_0x34091f[_0x17af44(0x9f)]);}),_0x34091f['AqTQy'](it,_0x34091f['ieaAf'],()=>{const _0x4b7658=_0x57d0f8,_0x65d515={'nfNJn':_0x34091f[_0x4b7658(0x87)]};if(_0x34091f[_0x4b7658(0x143)]===_0x34091f['aeiKO']){const _0x327acc=new _0xc98f41();_0x34091f[_0x4b7658(0x10d)](expect,_0x327acc)['to']['be'][_0x4b7658(0x11e)](_0xc98f41),_0x34091f[_0x4b7658(0x135)](expect,_0x327acc[_0x4b7658(0x136)])['to']['be']['a'](_0x34091f[_0x4b7658(0x9f)]),_0x34091f['MjueJ'](expect,_0x327acc[_0x4b7658(0xfb)])['to']['be']['a'](_0x34091f[_0x4b7658(0x9f)]);}else _0x2dda64(_0x2f64f4[_0x4b7658(0xcd)])['to'][_0x4b7658(0x142)](_0x65d515[_0x4b7658(0x138)]);}));}),describe(_0x4ec29f(0xc1),()=>{const _0x568948=_0x4ec29f,_0x4d5613={'ufRxn':function(_0x4bee2a,_0x194cdc){return _0x4bee2a(_0x194cdc);},'vCiqV':_0x34091f[_0x568948(0xb3)],'adOVk':_0x34091f['lNggW'],'TQijp':_0x34091f[_0x568948(0x11b)],'vmATw':_0x568948(0xcf),'GieWB':_0x568948(0x9c)};it(_0x34091f[_0x568948(0xb2)],async()=>{const _0x31ce71=_0x568948;try{if(_0x4d5613['adOVk']===_0x31ce71(0x144))_0x4d5613[_0x31ce71(0xc6)](_0xc6864c,_0xcd2419[_0x31ce71(0xcd)])['to']['include'](_0x4d5613[_0x31ce71(0x111)]);else{await _0x20c6f5['lookup']();throw new Error(_0x4d5613[_0x31ce71(0x86)]);}}catch(_0x56ff62){expect(_0x56ff62[_0x31ce71(0xcd)])['to'][_0x31ce71(0x142)](_0x4d5613['vmATw']);}}),_0x34091f[_0x568948(0xeb)](it,'should\x20reject\x20invalid\x20useraddress\x20format',async()=>{const _0x26bb92=_0x568948;try{await _0x20c6f5[_0x26bb92(0x136)](_0x4d5613[_0x26bb92(0x151)]);throw new Error(_0x4d5613[_0x26bb92(0x86)]);}catch(_0xe1dd49){expect(_0xe1dd49[_0x26bb92(0xcd)])['to'][_0x26bb92(0x142)](_0x26bb92(0x9a));}});}),_0x34091f[_0x4ec29f(0x106)](describe,_0x34091f[_0x4ec29f(0x102)],()=>{const _0x1ec2ce=_0x4ec29f;_0x34091f[_0x1ec2ce(0xeb)](it,_0x1ec2ce(0xf9),()=>{const _0x1fc427=_0x1ec2ce;_0x34091f[_0x1fc427(0xa6)](expect,window['fetch'])['to']['be']['a'](_0x34091f[_0x1fc427(0x9f)]);}),it(_0x34091f[_0x1ec2ce(0xe0)],()=>{const _0x27cc5c=_0x1ec2ce;if(_0x34091f[_0x27cc5c(0x139)]===_0x27cc5c(0x8e))return _0x58e856['WebFinger'];else _0x34091f[_0x27cc5c(0xf2)](expect,window[_0x27cc5c(0x155)])['to'][_0x27cc5c(0xfc)],expect(document)['to'][_0x27cc5c(0xfc)];});}),describe(_0x34091f[_0x4ec29f(0x14b)],()=>{it(_0x34091f['wUqQm'],()=>{const _0x325520=_0x53f6,_0x15f540=new _0xc98f41({'tls_only':![],'webfist_fallback':!![],'uri_fallback':!![],'request_timeout':0x3a98});_0x34091f[_0x325520(0xa6)](expect,_0x15f540)['to']['be']['instanceOf'](_0xc98f41);});}),describe(_0x34091f[_0x4ec29f(0xb0)],()=>{const _0x269f28=_0x4ec29f,_0x220a83={'ZRZlo':_0x34091f[_0x269f28(0x152)],'yMUBF':_0x269f28(0x119),'yjQDw':function(_0x139035){const _0x127ac0=_0x269f28;return _0x34091f[_0x127ac0(0x118)](_0x139035);}};if(_0x269f28(0x14f)!=='xiHcA'){const _0x308808={'links':[{'rel':_0x220a83[_0x269f28(0x8a)],'template':_0x269f28(0xf8)+_0xeb7702[_0x269f28(0x10a)]+_0x269f28(0xd5)}]},_0x5b20fc=_0x575226[_0x269f28(0x150)](_0x308808);return _0x562d33[_0x269f28(0xcc)]({'ok':!![],'status':0xc8,'headers':new _0x4ebee8({'content-type':_0x220a83['yMUBF']}),'json':()=>_0x4212a4[_0x269f28(0xcc)](_0x308808),'text':()=>_0x11d818['resolve'](_0x5b20fc)});}else{let _0x5d461c,_0x709604;before(async()=>{const _0x73a8d=_0x269f28;_0x5d461c=await _0x220a83[_0x73a8d(0x11a)](createMockServer),_0x709604=_0x5d461c['port'];}),_0x34091f[_0x269f28(0xa6)](after,async()=>{const _0x1707c0=_0x269f28,_0x54dee8={'LIgrh':function(_0x38c328,_0x2c53f0){const _0x492c19=_0x53f6;return _0x34091f[_0x492c19(0xdb)](_0x38c328,_0x2c53f0);},'dxCgw':function(_0x2d74e8,_0x25ebed){return _0x2d74e8(_0x25ebed);}};_0x34091f[_0x1707c0(0x13e)](_0x34091f[_0x1707c0(0xb9)],_0x34091f['NrYpu'])?(_0x54dee8['LIgrh'](_0x1a6d48,_0x39276c[_0x1707c0(0x155)])['to'][_0x1707c0(0xfc)],_0x32c105(_0x514b61)['to'][_0x1707c0(0xfc)]):_0x5d461c&&(_0x34091f[_0x1707c0(0x96)](_0x1707c0(0xa5),_0x34091f[_0x1707c0(0x8c)])?_0x54dee8[_0x1707c0(0x12e)](_0x34c4db,_0x2b62b4[_0x1707c0(0x13c)])['to']['be']['a'](_0x1707c0(0xae)):await _0x5d461c[_0x1707c0(0x10c)]());}),_0x34091f[_0x269f28(0x106)](it,_0x34091f[_0x269f28(0xec)],async()=>{const _0x53e110=_0x269f28,_0x5707f1=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]}),_0x4b288f=await _0x5707f1[_0x53e110(0x136)](_0x53e110(0x12d)+_0x709604);expect(_0x4b288f)['to']['be']['an'](_0x53e110(0xea)),_0x34091f[_0x53e110(0xad)](expect,_0x4b288f['object']['subject'])['to']['equal']('acct:test@localhost:'+_0x709604),_0x34091f[_0x53e110(0xdb)](expect,_0x4b288f[_0x53e110(0xe5)])['to']['be']['an']('object');}),_0x34091f['AqTQy'](it,_0x34091f[_0x269f28(0x122)],async()=>{const _0x2ae92d=_0x269f28,_0x58ad10={'qqubn':_0x34091f[_0x2ae92d(0x87)],'HUYCU':'application/json'};if(_0x34091f[_0x2ae92d(0x13e)]('daiGd',_0x2ae92d(0xd8))){const _0x3b7041=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]});try{await _0x3b7041[_0x2ae92d(0x136)]('nonexistent@localhost:'+_0x709604);throw new Error(_0x34091f['xiSJl']);}catch(_0x5173c1){_0x34091f['FKPVz'](expect,_0x5173c1[_0x2ae92d(0xcd)])['to'][_0x2ae92d(0x142)](_0x34091f[_0x2ae92d(0x87)]);}}else{const _0x2e920f={'error':_0x58ad10[_0x2ae92d(0x89)]},_0xbdcc13=_0x2bfcb8[_0x2ae92d(0x150)](_0x2e920f);return _0x39b34b[_0x2ae92d(0xcc)]({'ok':![],'status':0x194,'headers':new _0x2e0527({'content-type':_0x58ad10[_0x2ae92d(0x92)]}),'json':()=>_0x4fc620[_0x2ae92d(0xcc)](_0x2e920f),'text':()=>_0x20b3e4[_0x2ae92d(0xcc)](_0xbdcc13)});}});}}),describe(_0x34091f[_0x4ec29f(0x9e)],()=>{const _0x49f664=_0x4ec29f,_0x2f161c={'gAtHv':function(_0x3199ae){const _0x3b0dca=_0x53f6;return _0x34091f[_0x3b0dca(0xf7)](_0x3199ae);},'zwtOE':function(_0x33fd8f,_0x5a42ba){return _0x33fd8f(_0x5a42ba);},'PvALJ':_0x34091f[_0x49f664(0x9f)],'tcWJN':_0x49f664(0x114),'uIYVN':_0x49f664(0xc0),'AHSPb':function(_0x5a8496,_0x39f1af){return _0x34091f['voLlS'](_0x5a8496,_0x39f1af);},'nYCbt':_0x34091f[_0x49f664(0xa1)]};if(_0x34091f[_0x49f664(0x96)](_0x49f664(0x117),_0x49f664(0x149)))_0x34091f[_0x49f664(0x13d)](_0xaeb1fd,_0x17c2c1[_0x49f664(0xcd)])['to'][_0x49f664(0x142)](_0x49f664(0x90));else{let _0x290a3a,_0x52521a;before(async()=>{const _0x5e7a6e=_0x49f664;_0x290a3a=await _0x2f161c[_0x5e7a6e(0x11d)](createMockServer),_0x52521a=_0x290a3a[_0x5e7a6e(0x10a)];}),after(async()=>{const _0x3ca887=_0x49f664,_0x42457a={'NvPuQ':function(_0x39d51c,_0x2930b2){return _0x39d51c(_0x2930b2);}};'RyRiq'!==_0x3ca887(0x101)?_0x42457a[_0x3ca887(0xab)](_0x3a3681,_0x4d2c0c)['to']['include'](_0x3ca887(0xfd)):_0x290a3a&&(_0x3ca887(0xbe)===_0x3ca887(0xbe)?await _0x290a3a['stop']():_0x2f161c[_0x3ca887(0x113)](_0x29cb70,_0x2ca384)['to']['be']['a'](_0x2f161c[_0x3ca887(0x93)]));}),_0x34091f[_0x49f664(0x126)](it,_0x34091f[_0x49f664(0xff)],async()=>{const _0x31e6f5=_0x49f664,_0x4a46e9=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]}),_0x3923c8=await _0x4a46e9[_0x31e6f5(0x136)]('test@localhost:'+_0x52521a);_0x2f161c[_0x31e6f5(0x113)](expect,_0x3923c8[_0x31e6f5(0xea)][_0x31e6f5(0x99)])['to']['be']['a'](_0x31e6f5(0xc0)),expect(_0x3923c8['object']['links'])['to']['be']['an'](_0x31e6f5(0x11f)),expect(_0x3923c8['idx'])['to']['be']['an']('object'),_0x3923c8[_0x31e6f5(0xea)][_0x31e6f5(0x9d)][_0x31e6f5(0x131)](_0x21efe2=>{const _0x4b1954=_0x31e6f5;expect(_0x21efe2)['to']['have']['property'](_0x2f161c[_0x4b1954(0x10e)])[_0x4b1954(0xa9)]['is']['a'](_0x4b1954(0xc0)),expect(_0x21efe2)['to']['have']['property'](_0x4b1954(0xf5))[_0x4b1954(0xa9)]['is']['a'](_0x2f161c['uIYVN']);});}),it(_0x49f664(0x10b),async()=>{const _0x4cd890=_0x49f664,_0x56ceab=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]}),_0x140334=await _0x56ceab[_0x4cd890(0x136)](_0x4cd890(0xfa)+_0x52521a);_0x2f161c[_0x4cd890(0x113)](expect,_0x140334[_0x4cd890(0xea)][_0x4cd890(0x121)])['to']['be']['an'](_0x4cd890(0xea)),_0x2f161c[_0x4cd890(0xed)](expect,_0x140334['object'][_0x4cd890(0x121)][_0x4cd890(0x100)])['to'][_0x4cd890(0xc2)](_0x2f161c[_0x4cd890(0xaf)]);});}}),describe(_0x34091f[_0x4ec29f(0xf0)],()=>{const _0xe97aa5=_0x4ec29f;let _0x267ac2,_0x1fd9ce;before(async()=>{const _0x13ed86=_0x53f6;_0x267ac2=await createMockServer(),_0x1fd9ce=_0x267ac2[_0x13ed86(0x10a)];}),_0x34091f[_0xe97aa5(0xa6)](after,async()=>{_0x267ac2&&await _0x267ac2['stop']();}),it(_0x34091f['IdiYB'],async()=>{const _0x2605bd=_0xe97aa5,_0x555f9f=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]}),_0x1f9c29=await _0x555f9f['lookupLink']('test@localhost:'+_0x1fd9ce,_0x2605bd(0xee));_0x34091f[_0x2605bd(0x9b)](expect,_0x1f9c29)['to']['be']['an'](_0x2605bd(0xea)),_0x34091f['dYtMb'](expect,_0x1f9c29['href'])['to'][_0x2605bd(0xc2)](_0x34091f[_0x2605bd(0x83)]),expect(_0x1f9c29[_0x2605bd(0x114)])['to'][_0x2605bd(0xc2)](_0x2605bd(0x104));}),it('should\x20return\x20null\x20for\x20non-existent\x20link\x20relations',async()=>{const _0x19f31b=_0xe97aa5,_0x3a9ea0=new _0xc98f41({'tls_only':![],'request_timeout':0x1388,'allow_private_addresses':!![]});try{await _0x3a9ea0[_0x19f31b(0xfb)](_0x19f31b(0x12d)+_0x1fd9ce,_0x34091f[_0x19f31b(0x88)]);throw new Error(_0x34091f[_0x19f31b(0x11b)]);}catch(_0x58559e){expect(_0x58559e)['to'][_0x19f31b(0x142)]('unsupported\x20rel');}});}),describe(_0x34091f['PMxVt'],()=>{const _0x357030=_0x4ec29f,_0x1c137c={'mpTsb':function(_0x852d8c){const _0x2bf96c=_0x53f6;return _0x34091f[_0x2bf96c(0x13b)](_0x852d8c);},'RSZPa':_0x357030(0xaa),'WULFE':_0x357030(0xea),'ZiMMb':function(_0x306967,_0x108064){return _0x306967(_0x108064);},'XVULc':_0x34091f[_0x357030(0x11b)],'uVihH':function(_0x305754,_0x300213){const _0x47612f=_0x357030;return _0x34091f[_0x47612f(0x85)](_0x305754,_0x300213);}};if(_0x34091f[_0x357030(0x103)]('CmyVE',_0x34091f['ajdSb'])){let _0x362717,_0xe9bb69;_0x34091f[_0x357030(0xdf)](before,async()=>{const _0x4e3317=_0x357030;_0x362717=await _0x1c137c[_0x4e3317(0x8f)](createMockServer),_0xe9bb69=_0x362717['port'];}),after(async()=>{const _0x58f09c=_0x357030;_0x362717&&('JdlrB'===_0x1c137c['RSZPa']?await _0x362717[_0x58f09c(0x10c)]():_0x40b299=new _0xade3e5({'webfist_fallback':!![],'uri_fallback':!![],'request_timeout':0x1388,'allow_private_addresses':!![]}));}),it('should\x20work\x20with\x20uri_fallback\x20enabled',async()=>{const _0x37b0ce=_0x357030,_0x218c72=new _0xc98f41({'tls_only':![],'uri_fallback':!![],'request_timeout':0x1388,'allow_private_addresses':!![]}),_0x5f4a7c=await _0x218c72['lookup']('test@localhost:'+_0xe9bb69);expect(_0x5f4a7c)['to']['be']['an'](_0x1c137c['WULFE']),_0x1c137c[_0x37b0ce(0xc7)](expect,_0x5f4a7c['object'][_0x37b0ce(0x99)])['to'][_0x37b0ce(0xc2)](_0x37b0ce(0x12f)+_0xe9bb69);}),_0x34091f[_0x357030(0x126)](it,_0x34091f[_0x357030(0xbb)],async function(){const _0x3c3a42=_0x357030;this[_0x3c3a42(0xd2)](0x1f40);const _0x3eaa28=new _0xc98f41({'tls_only':![],'request_timeout':0x3e8,'allow_private_addresses':!![]});try{await _0x3eaa28[_0x3c3a42(0x136)](_0x3c3a42(0x120));throw new Error(_0x1c137c['XVULc']);}catch(_0x4f6252){_0x1c137c['uVihH'](expect,_0x4f6252[_0x3c3a42(0xcd)])['to'][_0x3c3a42(0x11c)](/(failed.*fetch|network)/i);}});}else{const _0x413be7=new _0x417604({'tls_only':![],'webfist_fallback':!![],'uri_fallback':!![],'request_timeout':0x3a98});_0x332593(_0x413be7)['to']['be'][_0x357030(0x11e)](_0x1462f4);}}),describe('Security\x20Features',()=>{const _0x48d21b=_0x4ec29f,_0x3c218c={'TdJrm':_0x48d21b(0x154),'nKWxS':function(_0x294085,_0x269c89){const _0x467221=_0x48d21b;return _0x34091f[_0x467221(0xc8)](_0x294085,_0x269c89);}};_0x34091f['aAXHa'](it,_0x34091f[_0x48d21b(0x112)],async()=>{const _0x2554b5=_0x48d21b,_0x4235ac=new _0xc98f41({'tls_only':![],'allow_private_addresses':![],'request_timeout':0x3e8});try{await _0x4235ac[_0x2554b5(0x136)](_0x2554b5(0xbf));throw new Error(_0x2554b5(0xa2));}catch(_0x14be15){if(_0x34091f[_0x2554b5(0x8b)]===_0x2554b5(0x7f))_0x34091f['bUXxj'](expect,_0x14be15[_0x2554b5(0xcd)])['to'][_0x2554b5(0x142)](_0x34091f[_0x2554b5(0x105)]);else{const _0x446d65=_0x15dbc5[_0x2554b5(0xc4)](_0x3c218c[_0x2554b5(0x141)]);_0x446d65['src']=_0x2554b5(0xa3),_0x446d65['onload']=()=>_0x37a24d(_0x3aaeaa['WebFinger']),_0x446d65['onerror']=_0x1e9bf5,_0x3fe6f4['head']['appendChild'](_0x446d65);}}}),it(_0x34091f[_0x48d21b(0x124)],async()=>{const _0x2812d0=_0x48d21b,_0x5c0c5a={'ronkF':function(_0x5d720e,_0x3142ed){return _0x5d720e(_0x3142ed);},'Mvhfs':_0x34091f[_0x2812d0(0x9f)],'PcLZp':function(_0x53f4ce,_0x3bbc34,_0x340e1f){const _0x217a72=_0x2812d0;return _0x34091f[_0x217a72(0x116)](_0x53f4ce,_0x3bbc34,_0x340e1f);}};if(_0x34091f[_0x2812d0(0xe3)]===_0x2812d0(0xce)){const _0x17e135={'XTkSG':function(_0x3b4e7f,_0x2e3cfd){return _0x3b4e7f(_0x2e3cfd);},'dpcaJ':_0x5c0c5a[_0x2812d0(0xca)]};_0x5c0c5a[_0x2812d0(0x13a)](_0x58a218,_0x2812d0(0xe1),()=>{const _0x14f51b=_0x2812d0;_0x17e135[_0x14f51b(0xd6)](_0x44c64c,_0x221e5d)['to']['be']['a'](_0x17e135[_0x14f51b(0x140)]);}),_0x3b714d(_0x2812d0(0x14a),()=>{const _0x1be71d=_0x2812d0,_0x36febb=new _0x2287fc();_0x5c0c5a[_0x1be71d(0x123)](_0x14ab27,_0x36febb)['to']['be'][_0x1be71d(0x11e)](_0x91388a),_0x538964(_0x36febb[_0x1be71d(0x136)])['to']['be']['a'](_0x1be71d(0xae)),_0x41b0e6(_0x36febb['lookupLink'])['to']['be']['a'](_0x5c0c5a['Mvhfs']);});}else{const _0x4273a9=new _0xc98f41({'allow_private_addresses':![],'request_timeout':0x3e8});try{if(_0x34091f[_0x2812d0(0xd0)]!==_0x34091f['jbvea'])_0x3c218c['nKWxS'](_0x1055c2,_0xaf8487[_0x2812d0(0xcd)])['to'][_0x2812d0(0x11c)](/(failed.*fetch|network)/i);else{await _0x4273a9[_0x2812d0(0x136)]('test@192.168.1.1');throw new Error(_0x34091f[_0x2812d0(0x11b)]);}}catch(_0xaf12de){_0x34091f['jiIcs'](expect,_0xaf12de[_0x2812d0(0xcd)])['to'][_0x2812d0(0x142)](_0x34091f[_0x2812d0(0x105)]);}}});});});async function createMockServer(){const _0x5c1c11=_0x2ebfc3,_0x5d6585={'aKzYp':_0x5c1c11(0xe9),'MmoQd':'/.well-known/webfinger','XbHBU':function(_0x2a9166,_0x596f5b){return _0x2a9166===_0x596f5b;},'MJLvO':_0x5c1c11(0xfe),'PiyBr':_0x5c1c11(0x82),'SYpuI':'application/jrd+json','HuZbk':function(_0x55d5bd,_0x14886d){return _0x55d5bd*_0x14886d;},'VaSkV':_0x5c1c11(0x8d),'FhkmC':_0x5c1c11(0x10f),'qKxdZ':_0x5c1c11(0x110),'xrSWP':'https://example.com/user'},_0x289f3c={[_0x5c1c11(0xd7)]:{'subject':_0x5c1c11(0x128),'links':[{'rel':'http://webfinger.net/rel/profile-page','href':_0x5c1c11(0xbd)},{'rel':_0x5c1c11(0x108),'href':_0x5d6585[_0x5c1c11(0xb4)]}]},[_0x5c1c11(0x12b)]:{'subject':_0x5d6585[_0x5c1c11(0xe4)],'properties':{'http://packetizer.com/ns/name':_0x5d6585[_0x5c1c11(0x13f)]},'links':[{'rel':_0x5c1c11(0x104),'href':_0x5d6585[_0x5c1c11(0x14c)]}]}},_0x1a48c8=new Promise(_0x851607=>{const _0x1b9fa3=_0x5c1c11,_0x45fb71={'port':0x1f91+Math[_0x1b9fa3(0xd3)](_0x5d6585['HuZbk'](Math['random'](),0x3e8)),'responses':_0x289f3c,'stop':async()=>{}},_0x2a0f9b=window[_0x1b9fa3(0x13c)];window['fetch']=function(_0x3bcc03,_0xaa2ea7){const _0x4a43ca=_0x1b9fa3,_0x160ac5=new URL(_0x3bcc03);if(!_0x3bcc03[_0x4a43ca(0x137)](_0x4a43ca(0xb1)))return Promise[_0x4a43ca(0xcb)](new Error(_0x5d6585[_0x4a43ca(0xb6)]));if(_0x160ac5[_0x4a43ca(0xdd)]===_0x5d6585[_0x4a43ca(0x146)]||_0x5d6585[_0x4a43ca(0x145)](_0x160ac5[_0x4a43ca(0xdd)],_0x4a43ca(0x12c))||_0x160ac5['pathname']===_0x4a43ca(0x148)){if(_0x160ac5[_0x4a43ca(0xdd)]===_0x5d6585[_0x4a43ca(0x146)]){const _0x1bc2b7=_0x160ac5[_0x4a43ca(0xb7)][_0x4a43ca(0xe7)](_0x4a43ca(0x91)),_0x3ae2e0=_0x1bc2b7?.[_0x4a43ca(0x109)](_0x5d6585['MJLvO'],'')[_0x4a43ca(0x109)](':'+_0x45fb71[_0x4a43ca(0x10a)],'');if(_0x3ae2e0&&_0x289f3c[_0x3ae2e0]){const _0x3f8826=JSON[_0x4a43ca(0xac)](JSON['stringify'](_0x289f3c[_0x3ae2e0]));_0x3f8826['subject']=_0x3f8826[_0x4a43ca(0x99)][_0x4a43ca(0x109)](_0x5d6585[_0x4a43ca(0xf6)],_0x45fb71['port']);const _0x3a19ac=JSON[_0x4a43ca(0x150)](_0x3f8826);return Promise[_0x4a43ca(0xcc)]({'ok':!![],'status':0xc8,'headers':new Headers({'content-type':_0x5d6585[_0x4a43ca(0xbc)]}),'json':()=>Promise[_0x4a43ca(0xcc)](_0x3f8826),'text':()=>Promise['resolve'](_0x3a19ac)});}else{const _0xbbdb7={'error':'resource\x20not\x20found'},_0x2644dd=JSON['stringify'](_0xbbdb7);return Promise[_0x4a43ca(0xcc)]({'ok':![],'status':0x194,'headers':new Headers({'content-type':_0x4a43ca(0x119)}),'json':()=>Promise[_0x4a43ca(0xcc)](_0xbbdb7),'text':()=>Promise[_0x4a43ca(0xcc)](_0x2644dd)});}}if(_0x160ac5[_0x4a43ca(0xdd)]==='/.well-known/host-meta'||_0x5d6585[_0x4a43ca(0x145)](_0x160ac5[_0x4a43ca(0xdd)],_0x4a43ca(0x148))){const _0x2ffb08={'links':[{'rel':_0x4a43ca(0xda),'template':'http://localhost:'+_0x45fb71['port']+_0x4a43ca(0xd5)}]},_0x26fad3=JSON[_0x4a43ca(0x150)](_0x2ffb08);return Promise[_0x4a43ca(0xcc)]({'ok':!![],'status':0xc8,'headers':new Headers({'content-type':'application/json'}),'json':()=>Promise[_0x4a43ca(0xcc)](_0x2ffb08),'text':()=>Promise[_0x4a43ca(0xcc)](_0x26fad3)});}}return _0x2a0f9b[_0x4a43ca(0xba)](this,_0x3bcc03,_0xaa2ea7);},_0x45fb71[_0x1b9fa3(0xf3)]=_0x2a0f9b,_0x45fb71[_0x1b9fa3(0x10c)]=async()=>{window['fetch']=_0x2a0f9b;},_0x851607(_0x45fb71);});return _0x1a48c8;}