const _0x320530=_0x2c12;(function(_0x38b4b1,_0x3e8329){const _0x393ab8=_0x2c12,_0x109dd8=_0x38b4b1();while(!![]){try{const _0x165de8=parseInt(_0x393ab8(0x102))/0x1+parseInt(_0x393ab8(0xea))/0x2*(parseInt(_0x393ab8(0x10b))/0x3)+-parseInt(_0x393ab8(0xfb))/0x4+parseInt(_0x393ab8(0x10a))/0x5*(parseInt(_0x393ab8(0x11e))/0x6)+parseInt(_0x393ab8(0x101))/0x7+parseInt(_0x393ab8(0xda))/0x8*(-parseInt(_0x393ab8(0x106))/0x9)+parseInt(_0x393ab8(0x10f))/0xa*(parseInt(_0x393ab8(0xd3))/0xb);if(_0x165de8===_0x3e8329)break;else _0x109dd8['push'](_0x109dd8['shift']());}catch(_0x420a40){_0x109dd8['push'](_0x109dd8['shift']());}}}(_0x432d,0xf2587));import{fileURLToPath,pathToFileURL}from'url';import{dirname,join}from'path';import{createHash}from'crypto';globalThis[_0x320530(0x10d)]={'createHash':createHash};const __filename=fileURLToPath(import.meta['url']),__dirname=dirname(__filename),clientModule=await import(pathToFileURL(join(__dirname,'..',_0x320530(0x104)))[_0x320530(0x112)]),serverModule=await import(pathToFileURL(join(__dirname,'..',_0x320530(0x116)))[_0x320530(0x112)]),rfc5054={'N_base10':_0x320530(0xfc),'g_base10':'2','k_base16':'5b9e8ef059c6b32ea59fc1d322d37f04aa30bae5aa9003b8321e21ddb04e300'};console['log'](_0x320530(0xe1)),console[_0x320530(0xdd)](_0x320530(0xd0)),console['log'](_0x320530(0xe3));const SRP6JavascriptClientSession=clientModule[_0x320530(0xdf)](rfc5054[_0x320530(0xdb)],rfc5054[_0x320530(0x105)],rfc5054[_0x320530(0xd5)]);console[_0x320530(0xdd)](_0x320530(0xeb)),console['log'](_0x320530(0xe9));const SRP6JavascriptServerSession=serverModule[_0x320530(0xdf)](rfc5054[_0x320530(0xdb)],rfc5054[_0x320530(0x105)],rfc5054[_0x320530(0xd5)]);console[_0x320530(0xdd)](_0x320530(0xff)),console[_0x320530(0xdd)]('\x0ağŸ”\x20REGISTRATION\x20PHASE'),console['log']('====================='),console[_0x320530(0xdd)]('ğŸ‘¤\x20Creating\x20client\x20session...');const client=new SRP6JavascriptClientSession();console[_0x320530(0xdd)]('âœ…\x20Client\x20session\x20created'),console[_0x320530(0xdd)](_0x320530(0x122));const salt=client[_0x320530(0xf9)]();console['log']('âœ…\x20Salt\x20generated:\x20'+salt[_0x320530(0x115)](0x0,0x10)+_0x320530(0xd2));const username=_0x320530(0xf8),password=_0x320530(0x120);function _0x2c12(_0xfee170,_0x132a0c){const _0x432d83=_0x432d();return _0x2c12=function(_0x2c12c3,_0x13af63){_0x2c12c3=_0x2c12c3-0xcf;let _0x411847=_0x432d83[_0x2c12c3];return _0x411847;},_0x2c12(_0xfee170,_0x132a0c);}function _0x432d(){const _0x343c9e=['\x0ağŸ\x20All\x20tests\x20completed\x20successfully!','âŒ\x20Browser.js\x20compatibility\x20test\x20failed','âœ…\x20Server\x20session\x20factory\x20created','step3','705579FBMtLA','1281958rBJfAL','message','client.mjs','g_base10','14657229zqpeYi','âš ï¸\x20\x20Browser.js\x20compatibility\x20test\x20skipped:\x20','\x0ağŸšª\x20LOGIN\x20PHASE','stringify','300ZCBIus','51PuuICd','=========================','nodeCrypto','âŒ\x20FAILURE:\x20Session\x20keys\x20do\x20not\x20match!','29720930uHxdkG','ğŸ‘¤\x20User:\x20','âœ…\x20SRP\x20authentication\x20phase\x20completed','href','ğŸ‘¤\x20Client\x20session\x20key:\x20','âŒ\x20CRITICAL\x20ERROR\x20in\x20SRP\x20authentication:','substring','server.mjs','fromPrivateStoreState','\x20\x20\x20Stack:\x20','url','ğŸ–¥ï¸\x20\x20Server\x20session\x20key:\x20','length','\x20characters','parse','11496AoTWAc','This\x20indicates\x20a\x20problem\x20with\x20the\x20SRP\x20implementation.','password1234','âœ…\x20Client\x20step1\x20completed\x20-\x20State:\x20','ğŸ§‚\x20Generating\x20random\x20salt...','error','getState','exit','\x0ağŸ“Š\x20COMPATIBILITY\x20TEST','YES','=====================================','step2','...','11iySjSi','Session\x20key\x20mismatch\x20-\x20SRP\x20protocol\x20failed','k_base16','\x20\x20\x20Client\x20State:\x20','toPrivateStoreState','âœ…\x20Client\x20generated\x20credentials:','step1','8AeZIgG','N_base10','âœ…\x20Client\x20verified\x20server\x20proof:\x20','log','\x0ağŸ”‘\x20SESSION\x20KEY\x20VERIFICATION','default','âœ…\x20SRP\x20registration\x20phase\x20completed','ğŸš€\x20Starting\x20SRP\x20ES\x20Module\x20Test\x20Suite','ğŸ“¤\x20Client\x20Step\x201:\x20Sending\x20credentials\x20to\x20start\x20authentication...','ğŸ“¦\x20Creating\x20client\x20session\x20factory...','ğŸ”\x20Server\x20Step\x202:\x20Verifying\x20credentials...','âœ…\x20SUCCESS:\x20Session\x20keys\x20match\x20perfectly!','ğŸ”\x20Generating\x20verifier...','ğŸ—ï¸\x20\x20Server\x20Step\x201:\x20Generating\x20challenge...','ğŸŒ\x20Testing\x20backward\x20compatibility\x20with\x20browser.js...','ğŸ“¦\x20Creating\x20server\x20session\x20factory...','6502lZmipi','âœ…\x20Client\x20session\x20factory\x20created','\x0ağŸ‰\x20ES\x20MODULE\x20TEST\x20RESULTS','stack','âœ…\x20Client\x20ES\x20module\x20loaded\x20successfully','===========================','\x20\x20\x20M1:\x20','\x20\x20\x20Error:\x20','âœ…\x20Browser.js\x20compatibility\x20test\x20passed','\x20\x20\x20Final\x20Client\x20State:\x20','âœ…\x20Full\x20SRP\x20round-trip\x20successful','getSessionKey','\x20\x20\x20A:\x20','module','tom@arcot.com','generateRandomSalt','../browser.js','7615388EIaGQF','21766174458617435773191008891802753781907668374255538511144643224689886235383840957210909013086056401571399717235807266581649606472148410291413364152197364477180887395655483738115072677402235101762521901569820740293149529620419333266262073471054548368736039519702486226506248861060256971802984953561121442680157668000761429988222457090413873973970171927093992114751765168063614761119615476233422096442783117971236371647333871414335895773474667308967050807005509320424799678417036867928316761272274230314067548291133582479583061439577559347101961771406173684378522703483495337037655006751328447510550299250924469288819'];_0x432d=function(){return _0x343c9e;};return _0x432d();}console['log'](_0x320530(0x110)+username),console['log']('ğŸ”‘\x20Password:\x20'+password),console[_0x320530(0xdd)](_0x320530(0xe6));const verifier=client['generateVerifier'](salt,username,password);console['log']('âœ…\x20Verifier\x20generated:\x20'+verifier['substring'](0x0,0x10)+_0x320530(0xd2)),console[_0x320530(0xdd)](_0x320530(0x108)),console[_0x320530(0xdd)]('=============='),console['log'](_0x320530(0xe2)),client[_0x320530(0xd9)](username,password),console['log'](_0x320530(0x121)+client[_0x320530(0x124)]()),console['log'](_0x320530(0xe7));const serverWillDie=new SRP6JavascriptServerSession(),B=serverWillDie[_0x320530(0xd9)](username,salt,verifier);console['log']('âœ…\x20Server\x20generated\x20challenge\x20B:\x20'+B[_0x320530(0x115)](0x0,0x10)+_0x320530(0xd2));const privateState=serverWillDie[_0x320530(0xd7)](),cacheJson=JSON[_0x320530(0x109)](privateState);console[_0x320530(0xdd)]('ğŸ’¾\x20Server\x20private\x20state\x20cached\x20('+cacheJson[_0x320530(0x11b)]+'\x20bytes)'),console['log']('ğŸ“¤\x20Client\x20Step\x202:\x20Creating\x20password\x20proof...');const credentials=client[_0x320530(0xd1)](salt,B);console[_0x320530(0xdd)](_0x320530(0xd8)),console[_0x320530(0xdd)](_0x320530(0xf6)+credentials['A'][_0x320530(0x115)](0x0,0x10)+'...'),console['log'](_0x320530(0xf0)+credentials['M1'][_0x320530(0x115)](0x0,0x10)+_0x320530(0xd2)),console['log'](_0x320530(0xd6)+client[_0x320530(0x124)]()),console['log'](_0x320530(0xe4));const newPrivate=JSON[_0x320530(0x11d)](cacheJson),server=new SRP6JavascriptServerSession();server[_0x320530(0x117)](newPrivate),console[_0x320530(0xdd)]('ğŸ’¾\x20Server\x20private\x20state\x20restored\x20from\x20cache');try{const M2=server[_0x320530(0xd1)](credentials['A'],credentials['M1']);console[_0x320530(0xdd)]('âœ…\x20Server\x20verified\x20credentials\x20and\x20generated\x20M2:\x20'+M2[_0x320530(0x115)](0x0,0x10)+_0x320530(0xd2)),console['log']('ğŸ”\x20Client\x20Step\x203:\x20Verifying\x20server\x20proof...');const step3Result=client[_0x320530(0x100)](M2);console[_0x320530(0xdd)](_0x320530(0xdc)+step3Result),console[_0x320530(0xdd)](_0x320530(0xf3)+client[_0x320530(0x124)]()),console[_0x320530(0xdd)](_0x320530(0xde)),console[_0x320530(0xdd)](_0x320530(0xef));const clientSessionKey=client['getSessionKey'](),serverSessionKey=server[_0x320530(0xf5)]();console['log'](_0x320530(0x113)+clientSessionKey),console['log'](_0x320530(0x11a)+serverSessionKey);if(clientSessionKey===serverSessionKey)console[_0x320530(0xdd)](_0x320530(0xe5)),console[_0x320530(0xdd)]('ğŸ”\x20Shared\x20key\x20length:\x20'+clientSessionKey[_0x320530(0x11b)]+_0x320530(0x11c));else{console[_0x320530(0x123)](_0x320530(0x10e)),console[_0x320530(0x123)](_0x320530(0x11f));throw new Error(_0x320530(0xd4));}console[_0x320530(0xdd)](_0x320530(0xec)),console['log'](_0x320530(0x10c)),console[_0x320530(0xdd)](_0x320530(0xee)),console[_0x320530(0xdd)]('âœ…\x20Server\x20ES\x20module\x20loaded\x20successfully'),console['log'](_0x320530(0xe0)),console[_0x320530(0xdd)](_0x320530(0x111)),console[_0x320530(0xdd)]('âœ…\x20Session\x20keys\x20generated\x20and\x20verified'),console[_0x320530(0xdd)](_0x320530(0xf4)),console[_0x320530(0xdd)](_0x320530(0x126)),console[_0x320530(0xdd)]('=====================');try{const {createRequire}=await import(_0x320530(0xf7)),require=createRequire(import.meta[_0x320530(0x119)]);console[_0x320530(0xdd)](_0x320530(0xe8));const BrowserSRP6JavascriptClientSession=require(_0x320530(0xfa))(rfc5054['N_base10'],rfc5054[_0x320530(0x105)],rfc5054[_0x320530(0xd5)]),bclient=new BrowserSRP6JavascriptClientSession();bclient[_0x320530(0xd9)](username,password);const bserver=new SRP6JavascriptServerSession(),bB=bserver[_0x320530(0xd9)](username,salt,verifier),bcredentials=bclient[_0x320530(0xd1)](salt,bB),bM2=bserver['step2'](bcredentials['A'],bcredentials['M1']);bclient['step3'](bM2);const bclientSessionKey=bclient['getSessionKey'](),bserverSessionKey=bserver[_0x320530(0xf5)]();bclientSessionKey===bserverSessionKey?(console[_0x320530(0xdd)](_0x320530(0xf2)),console['log']('ğŸ”—\x20Browser-Server\x20key\x20match:\x20'+(bclientSessionKey===serverSessionKey?_0x320530(0xcf):'NO'))):console['error'](_0x320530(0xfe));}catch(_0x503ecc){console['warn'](_0x320530(0x107)+_0x503ecc[_0x320530(0x103)]);}}catch(_0x35eff7){console[_0x320530(0x123)](_0x320530(0x114)),console[_0x320530(0x123)](_0x320530(0xf1)+_0x35eff7[_0x320530(0x103)]),console[_0x320530(0x123)](_0x320530(0x118)+_0x35eff7[_0x320530(0xed)]);throw _0x35eff7;}console['log'](_0x320530(0xfd)),process[_0x320530(0x125)](0x0);