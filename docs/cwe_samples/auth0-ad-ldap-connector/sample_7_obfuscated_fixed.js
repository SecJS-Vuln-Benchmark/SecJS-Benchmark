const _0x4af156=_0x4b53;function _0x166d(){const _0x3fe2d3=['IyORC','findOne','4948048jQXzNz','6998440CuIFzq','6gSBCMy','session','exports','request','body','../utils/helper','9974JaIAtH','3875055tmoVkn','throw','eJfXs','pwd','6130ciErbT','uid','1431iKNUzo','only','1FlFsev','profile','1884117yJAHZT','2345960sDXFrm','verifyContest','../models/User'];_0x166d=function(){return _0x3fe2d3;};return _0x166d();}(function(_0x3547fe,_0xb371c7){const _0x2ae1aa=_0x4b53,_0x2aa2f9=_0x3547fe();while(!![]){try{const _0x3a97af=-parseInt(_0x2ae1aa(0x13b))/0x1*(-parseInt(_0x2ae1aa(0x14b))/0x2)+-parseInt(_0x2ae1aa(0x13d))/0x3+parseInt(_0x2ae1aa(0x13e))/0x4+parseInt(_0x2ae1aa(0x14c))/0x5*(parseInt(_0x2ae1aa(0x145))/0x6)+parseInt(_0x2ae1aa(0x143))/0x7+-parseInt(_0x2ae1aa(0x144))/0x8+parseInt(_0x2ae1aa(0x152))/0x9*(-parseInt(_0x2ae1aa(0x150))/0xa);if(_0x3a97af===_0xb371c7)break;else _0x2aa2f9['push'](_0x2aa2f9['shift']());}catch(_0x319662){_0x2aa2f9['push'](_0x2aa2f9['shift']());}}}(_0x166d,0x737d1));function _0x4b53(_0x5712ff,_0x3a92f2){const _0x166d70=_0x166d();return _0x4b53=function(_0x4b53fa,_0x5375dc){_0x4b53fa=_0x4b53fa-0x13b;let _0xdbcee4=_0x166d70[_0x4b53fa];return _0xdbcee4;},_0x4b53(_0x5712ff,_0x3a92f2);}const only=require(_0x4af156(0x153)),User=require(_0x4af156(0x140)),{generatePwd}=require(_0x4af156(0x14a)),login=async _0x174072=>{const _0x3c9071=_0x4af156,_0x6b1b37={'eJfXs':'No\x20such\x20a\x20user','IyORC':function(_0x35344c,_0xa8a568,_0x5d581a){return _0x35344c(_0xa8a568,_0x5d581a);}},_0x52b0ee=_0x174072[_0x3c9071(0x148)]['body'][_0x3c9071(0x151)],_0x49040d=generatePwd(_0x174072[_0x3c9071(0x148)][_0x3c9071(0x149)][_0x3c9071(0x14f)]),_0x51cef5=await User[_0x3c9071(0x142)]({'uid':_0x52b0ee})['exec']();_0x51cef5==null&&_0x174072[_0x3c9071(0x14d)](0x190,_0x6b1b37[_0x3c9071(0x14e)]),_0x51cef5[_0x3c9071(0x14f)]!==_0x49040d&&_0x174072[_0x3c9071(0x14d)](0x190,'Wrong\x20password'),_0x174072[_0x3c9071(0x146)][_0x3c9071(0x13c)]=_0x6b1b37[_0x3c9071(0x141)](only,_0x51cef5,'uid\x20nick\x20privilege\x20pwd'),_0x174072['session'][_0x3c9071(0x13c)][_0x3c9071(0x13f)]=[],_0x174072[_0x3c9071(0x149)]={'profile':_0x174072[_0x3c9071(0x146)][_0x3c9071(0x13c)]};},logout=async _0x28d827=>{const _0x390014=_0x4af156;delete _0x28d827[_0x390014(0x146)]['profile'],_0x28d827[_0x390014(0x149)]={};},profile=async _0x40c9c1=>{const _0x554873=_0x4af156,_0x1a36c7=_0x40c9c1[_0x554873(0x146)][_0x554873(0x13c)]?_0x40c9c1['session'][_0x554873(0x13c)]:null;_0x40c9c1[_0x554873(0x149)]={'profile':_0x1a36c7};};module[_0x4af156(0x147)]={'login':login,'logout':logout,'profile':profile};