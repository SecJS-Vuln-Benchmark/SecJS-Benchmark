const _0x57e540=_0x28dd;(function(_0x464b19,_0x1f180e){const _0x2c8f5c=_0x28dd,_0x36f7f1=_0x464b19();while(!![]){try{const _0xb9340a=parseInt(_0x2c8f5c(0xfe))/0x1+-parseInt(_0x2c8f5c(0xb4))/0x2+-parseInt(_0x2c8f5c(0xbe))/0x3*(-parseInt(_0x2c8f5c(0x73))/0x4)+parseInt(_0x2c8f5c(0x77))/0x5*(parseInt(_0x2c8f5c(0x90))/0x6)+-parseInt(_0x2c8f5c(0xbf))/0x7*(-parseInt(_0x2c8f5c(0xcb))/0x8)+parseInt(_0x2c8f5c(0xf6))/0x9+-parseInt(_0x2c8f5c(0xc0))/0xa;if(_0xb9340a===_0x1f180e)break;else _0x36f7f1['push'](_0x36f7f1['shift']());}catch(_0x1f49f0){_0x36f7f1['push'](_0x36f7f1['shift']());}}}(_0x2f42,0x54fc3));import{BasePlugin}from'../base';import{hasOwnProperty,objectEach}from'../../helpers/object';import{rangeEach}from'../../helpers/number';import{arrayEach,arrayReduce,arrayMap}from'../../helpers/array';import{CellRange,CellCoords}from'../../3rdparty/walkontable/src';import*as _0xe89062 from'../../i18n/constants';function _0x28dd(_0x4a97b0,_0x4fa9a1){const _0x2f424c=_0x2f42();return _0x28dd=function(_0x28dd76,_0x2b6cdf){_0x28dd76=_0x28dd76-0x6f;let _0x445741=_0x2f424c[_0x28dd76];return _0x445741;},_0x28dd(_0x4a97b0,_0x4fa9a1);}import{bottom,left,noBorders,right,top}from'./contextMenuItem';import{createId,createDefaultCustomBorder,createSingleEmptyBorder,createEmptyBorders,extendDefaultBorder}from'./utils';function _0x2f42(){const _0x2eaef4=['items','isArray','countHide','nEERy','countRows','BLQAG','ZnKUp','getSettings','instanceBorders','FBFoB','zwKFT','rcdoh','4suONYz','wuwdK','changeBorderStyle','push','5kQwmqz','savedBorders','onAfterContextMenuDefaultOptions','eBfGl','PLUGIN_PRIORITY','EtJHI','CERuj','SAoaE','addHook','length','init','JrJRt','ONLLK','col','afterContextMenuDefaultOptions','setBorders','rydCz','customBorders','zGdYA','hide','kFDBi','min','wHLbX','isEnabled','njjwC','2182998cYKsqE','removeCellMeta','ZJHqn','CkxXt','tSDFc','from','OBuVr','NwYqg','Acsqh','bottom','DwSTC','render','prepareBorder','highlight','getTranslatedPhrase','clearNullCellRange','psGkW','VHchP','tyPIZ','values','WQFBw','enablePlugin','PikEl','clear','yWEDZ','NTqtY','SUZmy','BQvng','BOgOu','checkCustomSelections','spliceBorder','enabled','top','noBorders','xkYkS','MAoGh','1105586zZVXnm','BSBlx','left','whbDJ','hot','RtTCy','eYnRa','qJOpe','jjsbC','borders','1322931nfMvGB','1022JyOofG','11134810jstaGT','tPFsY','efvvl','URjDp','range','OWhKW','HpCvR','clearBordersFromSelectionSettings','customSelections','zZSct','assign','8672IaYhvk','removeAllBorders','DAbEW','LTNbt','KWFiQ','sKhoZ','baoqu','baugy','onAfterInit','right','TyHJn','LbTra','xMgNa','destroy','border','changeBorderSettings','getCellMeta','pYRCe','KcfVC','jXdIw','checkCustomSelectionsFromContextMenu','bCmbe','gFwbj','srMJy','splice','selection','settings','EzfsI','hideBorders','YPCXd','indexOf','createCustomBorders','countCols','setCellMeta','prepareBorderFromCustomAddedRange','getBorders','row','disablePlugin','commit','visualCellRange','KpBxh','bOPJR','updatePlugin','6184161ynHKfK','prepareBorderFromCustomAdded','setBorder','ysOta','EMmGw','insertBorderIntoSettings','fZfYm','KVdzR','364170tVIlHX','PFsvG','toggleHiddenClass','mHcoo','rsBiN'];_0x2f42=function(){return _0x2eaef4;};return _0x2f42();}import{detectSelectionType,normalizeSelectionFactory}from'../../selection';export const PLUGIN_KEY=_0x57e540(0x88);export const PLUGIN_PRIORITY=0x5a;export class CustomBorders extends BasePlugin{static get['PLUGIN_KEY'](){return PLUGIN_KEY;}static get[_0x57e540(0x7b)](){return PLUGIN_PRIORITY;}constructor(_0x4cada6){const _0xed1561=_0x57e540;super(_0x4cada6),this[_0xed1561(0x78)]=[];}[_0x57e540(0x8e)](){const _0x3aaaa3=_0x57e540;return!!this[_0x3aaaa3(0xb8)][_0x3aaaa3(0x10a)]()[PLUGIN_KEY];}[_0x57e540(0xa5)](){const _0x18212d=_0x57e540;if(this[_0x18212d(0xaf)])return;this[_0x18212d(0x7f)](_0x18212d(0x85),_0x2cce5c=>this[_0x18212d(0x79)](_0x2cce5c)),this[_0x18212d(0x7f)](_0x18212d(0x81),()=>this[_0x18212d(0xd3)]()),super[_0x18212d(0xa5)]();}[_0x57e540(0xf0)](){const _0xae762c=_0x57e540;this[_0xae762c(0xe7)](),super[_0xae762c(0xf0)]();}[_0x57e540(0xf5)](){const _0x4777ce=_0x57e540;this['disablePlugin'](),this['enablePlugin'](),this[_0x4777ce(0xda)](),super[_0x4777ce(0xf5)]();}[_0x57e540(0x86)](_0x366286,_0x1066fe){const _0x1c4b4e=_0x57e540,_0x21809b={'DAbEW':function(_0x52abf9,_0x5c0acd){return _0x52abf9<=_0x5c0acd;},'rcdoh':_0x1c4b4e(0xd4),'aAsaz':function(_0x3ac45c,_0x1df4a0){return _0x3ac45c(_0x1df4a0);}},_0x49b594=['top',_0x21809b[_0x1c4b4e(0x72)],_0x1c4b4e(0x99),_0x1c4b4e(0xb6)],_0x5f3850=_0x1066fe?Object['keys'](_0x1066fe):_0x49b594,_0x163a3c=detectSelectionType(_0x366286),_0x32b5ce=_0x21809b['aAsaz'](normalizeSelectionFactory,_0x163a3c);arrayEach(_0x366286,_0x115b4f=>{const _0x19f233=_0x1c4b4e,[_0x20a495,_0x215a4b,_0x15fd1a,_0x34ad04]=_0x32b5ce(_0x115b4f);for(let _0x267766=_0x20a495;_0x21809b[_0x19f233(0xcd)](_0x267766,_0x15fd1a);_0x267766+=0x1){for(let _0x1b5852=_0x215a4b;_0x1b5852<=_0x34ad04;_0x1b5852+=0x1){arrayEach(_0x5f3850,_0xf008f3=>{const _0xf8856d=_0x19f233;this[_0xf8856d(0xf7)](_0x267766,_0x1b5852,_0x1066fe,_0xf008f3);});}}}),this[_0x1c4b4e(0xb8)]['view'][_0x1c4b4e(0x9b)]();}[_0x57e540(0xee)](_0x5619d1){const _0x15e29a=_0x57e540,_0x5a6630={'tIZmd':function(_0x1b1fd9,_0x331807){return _0x1b1fd9!==_0x331807;},'oylbi':function(_0x45fcb7,_0x520347){return _0x45fcb7===_0x520347;},'CHPMH':function(_0x593e12,_0x2c24c4){return _0x593e12===_0x2c24c4;},'ZnKUp':function(_0x1e1c65,_0x1d9ae1){return _0x1e1c65(_0x1d9ae1);},'eYnRa':function(_0x16e82b,_0x4c6865){return _0x16e82b<=_0x4c6865;}};if(!Array[_0x15e29a(0x104)](_0x5619d1))return this['savedBorders'];const _0x3430eb=detectSelectionType(_0x5619d1),_0x32f90f=_0x5a6630[_0x15e29a(0x109)](normalizeSelectionFactory,_0x3430eb),_0x2ca354=[];return arrayEach(_0x5619d1,_0x235ef9=>{const _0x1bf65b=_0x15e29a,_0x437cf5={'bCmbe':function(_0x238683,_0x5ee7a9){return _0x5a6630['tIZmd'](_0x238683,_0x5ee7a9);},'xkYkS':function(_0x23a782,_0x2ff0fc){return _0x5a6630['oylbi'](_0x23a782,_0x2ff0fc);},'rydCz':function(_0x52e16e,_0x28dfdb){return _0x5a6630['CHPMH'](_0x52e16e,_0x28dfdb);}},[_0x58042c,_0x242a6c,_0x46eba7,_0x561859]=_0x5a6630[_0x1bf65b(0x109)](_0x32f90f,_0x235ef9);for(let _0x10d023=_0x58042c;_0x5a6630[_0x1bf65b(0xba)](_0x10d023,_0x46eba7);_0x10d023+=0x1){if(_0x1bf65b(0x8d)!==_0x1bf65b(0xac))for(let _0x164ba9=_0x242a6c;_0x164ba9<=_0x561859;_0x164ba9+=0x1){arrayEach(this[_0x1bf65b(0x78)],_0xcb2460=>{const _0x41db2f=_0x1bf65b;_0x437cf5[_0x41db2f(0xe0)](_0x41db2f(0x92),_0x41db2f(0x92))?this['insertBorderIntoSettings'](_0x9af3b5):_0x437cf5[_0x41db2f(0xb2)](_0xcb2460[_0x41db2f(0xef)],_0x10d023)&&_0x437cf5[_0x41db2f(0x87)](_0xcb2460[_0x41db2f(0x84)],_0x164ba9)&&_0x2ca354['push'](_0xcb2460);});}else _0x2f5535+=0x1,_0x4a5066[_0x1bf65b(0xb0)]=_0x395e30[_0x1bf65b(0xb0)];}}),_0x2ca354;}['clearBorders'](_0x475fc6){const _0x182bd9=_0x57e540,_0x133155={'psGkW':_0x182bd9(0xa8)};_0x475fc6?_0x133155[_0x182bd9(0xa0)]===_0x133155['psGkW']?this['setBorders'](_0x475fc6):this[_0x182bd9(0xf8)](_0xaa1e9a[_0x182bd9(0xef)],_0x23e07c,_0x5ab33e,_0x3ce4cc):(arrayEach(this[_0x182bd9(0x78)],_0xea5575=>{const _0x4a5a13=_0x182bd9;this['clearBordersFromSelectionSettings'](_0xea5575['id']),this[_0x4a5a13(0x9f)](),this[_0x4a5a13(0xb8)][_0x4a5a13(0x91)](_0xea5575[_0x4a5a13(0xef)],_0xea5575[_0x4a5a13(0x84)],_0x4a5a13(0xbd));}),this[_0x182bd9(0x78)][_0x182bd9(0x80)]=0x0);}[_0x57e540(0xfb)](_0x16f0d7,_0x5628bd){const _0x388f95=_0x57e540,_0x3190f9={'KWFiQ':function(_0x201630,_0x2d991e){return _0x201630===_0x2d991e;},'OWhKW':_0x388f95(0xc1),'PmKWr':_0x388f95(0xd2)},_0x2d9274=this['checkSavedBorders'](_0x16f0d7);!_0x2d9274&&this['savedBorders'][_0x388f95(0x76)](_0x16f0d7);const _0x11d01b=new CellRange(new CellCoords(_0x16f0d7[_0x388f95(0xef)],_0x16f0d7[_0x388f95(0x84)])),_0x218be9=this[_0x388f95(0xad)](_0x16f0d7,_0x11d01b,_0x5628bd);!_0x218be9&&(_0x3190f9[_0x388f95(0xcf)](_0x3190f9[_0x388f95(0xc5)],_0x3190f9['PmKWr'])?_0x281d8f[_0x388f95(0x100)](_0xf1874e,_0x984a58):this[_0x388f95(0xb8)]['selection'][_0x388f95(0x9d)]['addCustomSelection']({'border':_0x16f0d7,'visualCellRange':_0x11d01b}));}['prepareBorderFromCustomAdded'](_0x4177c2,_0x11bc98,_0x30f5c1,_0x48f80e){const _0x15de94=_0x57e540,_0x21a1f8={'WQFBw':function(_0x4a66cf,_0x38e902){return _0x4a66cf>=_0x38e902;},'ysOta':function(_0x2b1406,_0xd8cbfa,_0x2f1b1b){return _0x2b1406(_0xd8cbfa,_0x2f1b1b);}},_0x3d9971=this['hot'][_0x15de94(0x107)](),_0x60e78e=this[_0x15de94(0xb8)][_0x15de94(0xeb)]();if(_0x21a1f8[_0x15de94(0xa4)](_0x4177c2,_0x3d9971)||_0x11bc98>=_0x60e78e)return;let _0x418c28=createEmptyBorders(_0x4177c2,_0x11bc98);_0x30f5c1&&(_0x418c28=extendDefaultBorder(_0x418c28,_0x30f5c1),_0x21a1f8[_0x15de94(0xf9)](arrayEach,this[_0x15de94(0xb8)][_0x15de94(0xe4)][_0x15de94(0x9d)][_0x15de94(0xc8)],_0x1c7843=>{const _0x27fe6c=_0x15de94;if(_0x418c28['id']===_0x1c7843[_0x27fe6c(0xe5)]['id'])return Object['assign'](_0x1c7843[_0x27fe6c(0xe5)],_0x30f5c1),_0x418c28['id']=_0x1c7843['settings']['id'],_0x418c28[_0x27fe6c(0xb6)]=_0x1c7843[_0x27fe6c(0xe5)][_0x27fe6c(0xb6)],_0x418c28[_0x27fe6c(0xd4)]=_0x1c7843['settings']['right'],_0x418c28[_0x27fe6c(0xb0)]=_0x1c7843['settings'][_0x27fe6c(0xb0)],_0x418c28[_0x27fe6c(0x99)]=_0x1c7843[_0x27fe6c(0xe5)]['bottom'],![];})),this[_0x15de94(0xb8)][_0x15de94(0xec)](_0x4177c2,_0x11bc98,_0x15de94(0xbd),_0x418c28),this[_0x15de94(0xfb)](_0x418c28,_0x48f80e);}[_0x57e540(0xed)](_0x202e5c){const _0x54b31f=_0x57e540,_0x5850b8={'NwYqg':function(_0x24f3e7,_0x266ca6){return _0x24f3e7===_0x266ca6;},'SUZmy':'iEefW','nEERy':'huEcD','mrftt':_0x54b31f(0x108),'tSDFc':function(_0x2890b1,_0x5edd34){return _0x2890b1-_0x5edd34;}},_0x5d54cf=_0x202e5c[_0x54b31f(0xc4)],_0x17a2d3=Math[_0x54b31f(0x8c)](_0x5d54cf['to'][_0x54b31f(0xef)],this[_0x54b31f(0xb8)][_0x54b31f(0x107)]()-0x1),_0x2fb1a4=Math[_0x54b31f(0x8c)](_0x5d54cf['to'][_0x54b31f(0x84)],_0x5850b8[_0x54b31f(0x94)](this[_0x54b31f(0xb8)]['countCols'](),0x1));rangeEach(_0x5d54cf[_0x54b31f(0x95)]['row'],_0x17a2d3,_0x3ecc23=>{const _0x382e35=_0x54b31f,_0x5892bb={'zGdYA':function(_0x4e3f04,_0x345901,_0x3f1d8e){return _0x4e3f04(_0x345901,_0x3f1d8e);},'gFwbj':function(_0x607d54,_0x4b5b47){return _0x607d54>_0x4b5b47;}};rangeEach(_0x5d54cf[_0x382e35(0x95)][_0x382e35(0x84)],_0x2fb1a4,_0x808b63=>{const _0x2aed81=_0x382e35,_0x3bf9ff=createEmptyBorders(_0x3ecc23,_0x808b63);let _0x5e1681=0x0;_0x5850b8[_0x2aed81(0x97)](_0x3ecc23,_0x5d54cf[_0x2aed81(0x95)][_0x2aed81(0xef)])&&(hasOwnProperty(_0x202e5c,_0x2aed81(0xb0))&&(_0x5e1681+=0x1,_0x3bf9ff[_0x2aed81(0xb0)]=_0x202e5c[_0x2aed81(0xb0)]));_0x3ecc23===_0x5d54cf['to'][_0x2aed81(0xef)]&&(hasOwnProperty(_0x202e5c,_0x2aed81(0x99))&&(_0x5850b8[_0x2aed81(0xaa)]!==_0x2aed81(0x7e)?(_0x5e1681+=0x1,_0x3bf9ff[_0x2aed81(0x99)]=_0x202e5c[_0x2aed81(0x99)]):_0x447b79[_0x2aed81(0x75)](_0x53f5ac,_0x500ddb)));_0x808b63===_0x5d54cf[_0x2aed81(0x95)][_0x2aed81(0x84)]&&(_0x5850b8[_0x2aed81(0x106)]!==_0x5850b8['mrftt']?hasOwnProperty(_0x202e5c,_0x2aed81(0xb6))&&(_0x5e1681+=0x1,_0x3bf9ff[_0x2aed81(0xb6)]=_0x202e5c[_0x2aed81(0xb6)]):_0x41091e(_0x556829,_0x2aed81(0x99))&&(_0x90a69e+=0x1,_0x2467a9['bottom']=_0x1d6fee[_0x2aed81(0x99)]));if(_0x808b63===_0x5d54cf['to']['col']){if(hasOwnProperty(_0x202e5c,_0x2aed81(0xd4))){if(_0x2aed81(0xd6)!==_0x2aed81(0xd6)){const _0x1c7c91=_0x5892bb[_0x2aed81(0x89)](_0x407823,this[_0x2aed81(0xb8)]['selection'][_0x2aed81(0x9d)][_0x2aed81(0xc8)],_0x2b89d9=>_0x2b89d9[_0x2aed81(0xe5)]['id'])[_0x2aed81(0xe9)](_0x40c63d);_0x5892bb[_0x2aed81(0xe1)](_0x1c7c91,-0x1)&&this[_0x2aed81(0xb8)][_0x2aed81(0xe4)]['highlight']['customSelections'][_0x1c7c91]['clear']();}else _0x5e1681+=0x1,_0x3bf9ff[_0x2aed81(0xd4)]=_0x202e5c[_0x2aed81(0xd4)];}}if(_0x5e1681>0x0)this[_0x2aed81(0xb8)][_0x2aed81(0xec)](_0x3ecc23,_0x808b63,_0x2aed81(0xbd),_0x3bf9ff),this[_0x2aed81(0xfb)](_0x3bf9ff);else{}});});}[_0x57e540(0xcc)](_0x42093c,_0x1fcbdf){const _0x3cd0ef=_0x57e540,_0x5fdeec={'GIzgx':function(_0x16ab2b,_0x26f6be,_0x207a45){return _0x16ab2b(_0x26f6be,_0x207a45);}},_0x4b23b5=_0x5fdeec['GIzgx'](createId,_0x42093c,_0x1fcbdf);this[_0x3cd0ef(0xae)](_0x4b23b5),this[_0x3cd0ef(0xc7)](_0x4b23b5),this[_0x3cd0ef(0x9f)](),this[_0x3cd0ef(0xb8)][_0x3cd0ef(0x91)](_0x42093c,_0x1fcbdf,_0x3cd0ef(0xbd));}['setBorder'](_0x54eb4e,_0x17bf2d,_0x5b3684,_0x5b8b1c){const _0x36baa6=_0x57e540,_0x42638e={'QiMxm':function(_0x4395eb,_0x49de94){return _0x4395eb===_0x49de94;},'eTlCp':function(_0x21403d,_0x527416){return _0x21403d===_0x527416;},'njjwC':function(_0x29da88,_0xb449c,_0x3d8c82){return _0x29da88(_0xb449c,_0x3d8c82);},'xMgNa':function(_0x182066){return _0x182066();},'BQvng':function(_0x2454a2,_0x2f1c37){return _0x2454a2===_0x2f1c37;},'eBfGl':function(_0x1fceb0,_0x239dc9){return _0x1fceb0!==_0x239dc9;},'OBuVr':'PFsvG','kFDBi':_0x36baa6(0xbd)};let _0x1397a6=this[_0x36baa6(0xb8)][_0x36baa6(0xdb)](_0x54eb4e,_0x17bf2d)[_0x36baa6(0xbd)];(!_0x1397a6||_0x1397a6[_0x36baa6(0xd9)]===void 0x0)&&(_0x1397a6=_0x42638e[_0x36baa6(0x8f)](createEmptyBorders,_0x54eb4e,_0x17bf2d));if(_0x5b8b1c){_0x1397a6[_0x5b3684]=_0x42638e[_0x36baa6(0xd7)](createSingleEmptyBorder);const _0x29cf39=this['countHide'](_0x1397a6);if(_0x42638e[_0x36baa6(0xab)](_0x29cf39,0x4)){if(_0x42638e[_0x36baa6(0x7a)](_0x36baa6(0xff),_0x42638e[_0x36baa6(0x96)])){if(_0x42638e['QiMxm'](_0x4c7621['id'],_0x139b90[_0x36baa6(0xe5)]['id']))return _0x33a9fa(_0x2dd141['instanceBorders'],_0x34059f=>{const _0x971029=_0x36baa6;_0x34059f[_0x971029(0x100)](_0x38f725,_0x50f457);}),_0x9a5a63=!![],![];}else this[_0x36baa6(0xcc)](_0x54eb4e,_0x17bf2d);}else{const _0x22b15a=this[_0x36baa6(0xdf)](_0x1397a6,_0x5b3684,_0x5b8b1c);!_0x22b15a&&this[_0x36baa6(0xfb)](_0x1397a6),this[_0x36baa6(0xb8)][_0x36baa6(0xec)](_0x54eb4e,_0x17bf2d,_0x42638e['kFDBi'],_0x1397a6);}}else{if(_0x36baa6(0xb7)!==_0x36baa6(0xf3)){_0x1397a6[_0x5b3684]=_0x42638e['xMgNa'](createDefaultCustomBorder);const _0x268adf=this['checkCustomSelectionsFromContextMenu'](_0x1397a6,_0x5b3684,_0x5b8b1c);if(!_0x268adf){if(_0x36baa6(0x74)!==_0x36baa6(0x74)){if(_0x42638e['eTlCp'](_0x151b2b['id'],_0x4816c2['id']))return this[_0x36baa6(0x78)][_0x433b9a]=_0x100971,_0x57ab97=!![],![];}else this['insertBorderIntoSettings'](_0x1397a6);}this[_0x36baa6(0xb8)][_0x36baa6(0xec)](_0x54eb4e,_0x17bf2d,_0x42638e[_0x36baa6(0x8b)],_0x1397a6);}else return;}}[_0x57e540(0x9c)](_0x23af11,_0x537b86,_0x24b311){const _0x6aeca4=_0x57e540,_0xc11089={'srMJy':function(_0x55f4db,_0x41f2b7){return _0x55f4db!==_0x41f2b7;},'Phwqd':_0x6aeca4(0x7c),'PikEl':function(_0x2bb910,_0x4ef471,_0x4ccf95,_0x46031d){return _0x2bb910(_0x4ef471,_0x4ccf95,_0x46031d);},'rQMuc':function(_0x5ebf49,_0x235a3d){return _0x5ebf49===_0x235a3d;},'RtTCy':_0x6aeca4(0xdc),'EzfsI':_0x6aeca4(0xb0),'ONLLK':function(_0x4dd7af,_0x11c784,_0x3a5643,_0x289ded){return _0x4dd7af(_0x11c784,_0x3a5643,_0x289ded);},'DwSTC':function(_0x1c88de,_0x208e7a,_0xcba4b4,_0x3286bd){return _0x1c88de(_0x208e7a,_0xcba4b4,_0x3286bd);},'rsBiN':'left','CElzi':function(_0x1494f4,_0xdfdc45,_0x404ce8,_0x2faade){return _0x1494f4(_0xdfdc45,_0x404ce8,_0x2faade);}};arrayEach(_0x23af11,({start:_0x3e65b1,end:_0x2351da})=>{const _0x49998f=_0x6aeca4,_0xf22363={'SFEVp':function(_0x4de849,_0x4f33b4,_0x4e40c3,_0x69702d){const _0x4e06c4=_0x28dd;return _0xc11089[_0x4e06c4(0xa6)](_0x4de849,_0x4f33b4,_0x4e40c3,_0x69702d);}};if(_0x3e65b1[_0x49998f(0xef)]===_0x2351da[_0x49998f(0xef)]&&_0xc11089['rQMuc'](_0x3e65b1[_0x49998f(0x84)],_0x2351da[_0x49998f(0x84)])){if(_0x537b86===_0x49998f(0xb1)){if(_0xc11089[_0x49998f(0xb9)]===_0x49998f(0xf4))return this[_0x49998f(0x78)];else this[_0x49998f(0xcc)](_0x3e65b1[_0x49998f(0xef)],_0x3e65b1['col']);}else this[_0x49998f(0xf8)](_0x3e65b1[_0x49998f(0xef)],_0x3e65b1[_0x49998f(0x84)],_0x537b86,_0x24b311);}else switch(_0x537b86){case _0x49998f(0xb1):rangeEach(_0x3e65b1[_0x49998f(0x84)],_0x2351da[_0x49998f(0x84)],_0x5c6dab=>{const _0x2fc15d=_0x49998f;_0xf22363['SFEVp'](rangeEach,_0x3e65b1['row'],_0x2351da[_0x2fc15d(0xef)],_0x2bee2e=>{const _0x29b697=_0x2fc15d;this[_0x29b697(0xcc)](_0x2bee2e,_0x5c6dab);});});break;case _0xc11089[_0x49998f(0xe6)]:_0xc11089[_0x49998f(0x83)](rangeEach,_0x3e65b1[_0x49998f(0x84)],_0x2351da['col'],_0xd10344=>{const _0x33ac7c=_0x49998f;this[_0x33ac7c(0xf8)](_0x3e65b1[_0x33ac7c(0xef)],_0xd10344,_0x537b86,_0x24b311);});break;case _0x49998f(0xd4):rangeEach(_0x3e65b1[_0x49998f(0xef)],_0x2351da[_0x49998f(0xef)],_0x5d2409=>{const _0x4d1026=_0x49998f;this[_0x4d1026(0xf8)](_0x5d2409,_0x2351da[_0x4d1026(0x84)],_0x537b86,_0x24b311);});break;case _0x49998f(0x99):_0xc11089[_0x49998f(0x9a)](rangeEach,_0x3e65b1[_0x49998f(0x84)],_0x2351da[_0x49998f(0x84)],_0xda7d60=>{const _0x1e12d7=_0x49998f;this[_0x1e12d7(0xf8)](_0x2351da[_0x1e12d7(0xef)],_0xda7d60,_0x537b86,_0x24b311);});break;case _0xc11089[_0x49998f(0x102)]:_0xc11089['CElzi'](rangeEach,_0x3e65b1['row'],_0x2351da[_0x49998f(0xef)],_0x456fb8=>{const _0x2fc254=_0x49998f,_0x549e59={'zZSct':'4|6|2|1|3|5|0'};if(_0xc11089[_0x2fc254(0xe2)](_0xc11089['Phwqd'],_0x2fc254(0x7c))){const _0x94d6dd=_0x549e59[_0x2fc254(0xc9)]['split']('|');let _0x5136b9=0x0;while(!![]){switch(_0x94d6dd[_0x5136b9++]){case'0':return![];case'1':_0x941a9b[_0x2fc254(0xd4)]=_0x37f7bd[_0x2fc254(0xe5)][_0x2fc254(0xd4)];continue;case'2':_0x3c9e49[_0x2fc254(0xb6)]=_0x4e0cef[_0x2fc254(0xe5)][_0x2fc254(0xb6)];continue;case'3':_0x4d2e96[_0x2fc254(0xb0)]=_0x1fa37e['settings'][_0x2fc254(0xb0)];continue;case'4':_0x572903[_0x2fc254(0xca)](_0x5c2357['settings'],_0x5b18bb);continue;case'5':_0x239ff0['bottom']=_0x590d5[_0x2fc254(0xe5)][_0x2fc254(0x99)];continue;case'6':_0x295612['id']=_0x24e35f[_0x2fc254(0xe5)]['id'];continue;}break;}}else this['setBorder'](_0x456fb8,_0x3e65b1['col'],_0x537b86,_0x24b311);});break;default:break;}});}[_0x57e540(0xea)](_0x2cbd81){const _0x27ae81=_0x57e540,_0xcfb7c1={'YPCXd':function(_0x44837c,_0x44fe01){return _0x44837c!==_0x44fe01;},'wmmTX':_0x27ae81(0x98)};arrayEach(_0x2cbd81,_0x498e1a=>{const _0x53cd40=_0x27ae81;_0x498e1a[_0x53cd40(0xc4)]?this['prepareBorderFromCustomAddedRange'](_0x498e1a):_0xcfb7c1[_0x53cd40(0xe8)](_0xcfb7c1['wmmTX'],_0x53cd40(0x98))?_0x3c1e2a[_0x53cd40(0xc4)]?this[_0x53cd40(0xed)](_0x56544a):this[_0x53cd40(0xf7)](_0x167b25[_0x53cd40(0xef)],_0x49a706[_0x53cd40(0x84)],_0x35ad67):this[_0x53cd40(0xf7)](_0x498e1a[_0x53cd40(0xef)],_0x498e1a[_0x53cd40(0x84)],_0x498e1a);});}[_0x57e540(0x105)](_0x140774){const _0x1a736e=_0x57e540,_0x31420f=Object[_0x1a736e(0xa3)](_0x140774);return arrayReduce(_0x31420f,(_0xe39bfb,_0x444bdc)=>{const _0x24e24e=_0x1a736e;let _0x2da8e3=_0xe39bfb;return _0x444bdc[_0x24e24e(0x8a)]&&(_0x2da8e3+=0x1),_0x2da8e3;},0x0);}['clearBordersFromSelectionSettings'](_0x12e96d){const _0x249a14=_0x57e540,_0x3a787c={'FBFoB':function(_0x883c0c,_0x41840a,_0x3a630e){return _0x883c0c(_0x41840a,_0x3a630e);},'CERuj':function(_0x187cdf,_0x367627,_0x419e71){return _0x187cdf(_0x367627,_0x419e71);},'tyPIZ':function(_0x422d11,_0x135184){return _0x422d11>_0x135184;},'MjatF':_0x249a14(0xbc)},_0x4df4cc=_0x3a787c[_0x249a14(0x7d)](arrayMap,this[_0x249a14(0xb8)][_0x249a14(0xe4)]['highlight'][_0x249a14(0xc8)],_0x458407=>_0x458407[_0x249a14(0xe5)]['id'])['indexOf'](_0x12e96d);_0x3a787c[_0x249a14(0xa2)](_0x4df4cc,-0x1)&&(_0x249a14(0x93)!==_0x3a787c['MjatF']?this[_0x249a14(0xb8)][_0x249a14(0xe4)][_0x249a14(0x9d)][_0x249a14(0xc8)][_0x4df4cc][_0x249a14(0xa7)]():(_0x3a787c[_0x249a14(0x70)](_0x142349,this['savedBorders'],_0x57daf8=>{const _0x14d2ee=_0x249a14;this['clearBordersFromSelectionSettings'](_0x57daf8['id']),this[_0x14d2ee(0x9f)](),this[_0x14d2ee(0xb8)][_0x14d2ee(0x91)](_0x57daf8['row'],_0x57daf8[_0x14d2ee(0x84)],_0x14d2ee(0xbd));}),this[_0x249a14(0x78)][_0x249a14(0x80)]=0x0));}[_0x57e540(0x9f)](){const _0x30bbcd=_0x57e540,_0x2491d8={'auXdJ':_0x30bbcd(0xc2)};arrayEach(this[_0x30bbcd(0xb8)]['selection']['highlight'][_0x30bbcd(0xc8)],(_0x23bea8,_0x31498f)=>{const _0x434b71=_0x30bbcd;if(_0x23bea8['cellRange']===null){if(_0x434b71(0xdd)===_0x2491d8['auXdJ'])_0x2c4378+=0x1,_0x36e439['bottom']=_0xba3250['bottom'];else return this['hot']['selection']['highlight'][_0x434b71(0xc8)][_0x31498f]['destroy'](),this[_0x434b71(0xb8)][_0x434b71(0xe4)][_0x434b71(0x9d)][_0x434b71(0xc8)][_0x434b71(0xe3)](_0x31498f,0x1),![];}});}[_0x57e540(0xe7)](){arrayEach(this['savedBorders'],_0x3702f5=>{const _0x3feb9c=_0x28dd;this[_0x3feb9c(0xc7)](_0x3702f5['id']),this[_0x3feb9c(0x9f)]();});}[_0x57e540(0xae)](_0x6027ff){const _0x1a354d=_0x57e540,_0x32a822={'zwKFT':function(_0x332ee1,_0x319ef9,_0x5cf3ea){return _0x332ee1(_0x319ef9,_0x5cf3ea);}},_0x147647=_0x32a822[_0x1a354d(0x71)](arrayMap,this[_0x1a354d(0x78)],_0x3d7464=>_0x3d7464['id'])[_0x1a354d(0xe9)](_0x6027ff);_0x147647>-0x1&&this[_0x1a354d(0x78)]['splice'](_0x147647,0x1);}['checkSavedBorders'](_0x5cd6b7){const _0x936e32=_0x57e540,_0x509346={'KVdzR':function(_0x1bfad0,_0x13f048){return _0x1bfad0===_0x13f048;},'MAoGh':function(_0x11a46b,_0x1cceb6){return _0x11a46b===_0x1cceb6;}};let _0x174f3f=![];const _0x3d555b=this[_0x936e32(0x105)](_0x5cd6b7);return _0x509346[_0x936e32(0xb3)](_0x3d555b,0x4)?(this[_0x936e32(0xae)](_0x5cd6b7['id']),_0x174f3f=!![]):arrayEach(this[_0x936e32(0x78)],(_0x5969fd,_0x3d35be)=>{const _0x720b12=_0x936e32;if(_0x509346[_0x720b12(0xfd)](_0x5cd6b7['id'],_0x5969fd['id']))return this[_0x720b12(0x78)][_0x3d35be]=_0x5cd6b7,_0x174f3f=!![],![];}),_0x174f3f;}['checkCustomSelectionsFromContextMenu'](_0x5a8087,_0x16dadb,_0x12c273){const _0x55d059=_0x57e540,_0x4f1569={'gLMSD':_0x55d059(0x82),'sKhoZ':function(_0x524975,_0x2e07a7,_0x274e3c){return _0x524975(_0x2e07a7,_0x274e3c);}};let _0x1eeaf3=![];return _0x4f1569[_0x55d059(0xd0)](arrayEach,this['hot'][_0x55d059(0xe4)]['highlight'][_0x55d059(0xc8)],_0x25439a=>{const _0x2081e5=_0x55d059;if(_0x5a8087['id']===_0x25439a[_0x2081e5(0xe5)]['id'])return _0x2081e5(0x82)!==_0x4f1569['gLMSD']?(this[_0x2081e5(0xb8)][_0x2081e5(0xe4)]['highlight'][_0x2081e5(0xc8)][_0x301592][_0x2081e5(0xd8)](),this[_0x2081e5(0xb8)][_0x2081e5(0xe4)][_0x2081e5(0x9d)][_0x2081e5(0xc8)][_0x2081e5(0xe3)](_0xca6c40,0x1),![]):(objectEach(_0x25439a['instanceBorders'],_0x26d444=>{const _0x41bd73=_0x2081e5;_0x26d444[_0x41bd73(0x100)](_0x16dadb,_0x12c273);}),_0x1eeaf3=!![],![]);}),_0x1eeaf3;}['checkCustomSelections'](_0x2ee44d,_0x5ef230,_0x2c964f){const _0x296e62=_0x57e540,_0x3fb5f4={'HpCvR':function(_0x4ea349,_0x17b86d){return _0x4ea349===_0x17b86d;},'mHcoo':'fZfYm','URjDp':function(_0x32b88b,_0x4d6518,_0x18db2f){return _0x32b88b(_0x4d6518,_0x18db2f);}},_0x20c62e=this[_0x296e62(0x105)](_0x2ee44d);let _0x3e1c10=![];return _0x3fb5f4[_0x296e62(0xc6)](_0x20c62e,0x4)?(this['removeAllBorders'](_0x2ee44d['row'],_0x2ee44d[_0x296e62(0x84)]),_0x3e1c10=!![]):arrayEach(this[_0x296e62(0xb8)]['selection'][_0x296e62(0x9d)][_0x296e62(0xc8)],_0x4a97a7=>{const _0x2d469a=_0x296e62,_0x2583c8={'TyHJn':function(_0x1bc3a8,_0x5ad3c4,_0x155ca7){return _0x1bc3a8(_0x5ad3c4,_0x155ca7);}};if(_0x3fb5f4[_0x2d469a(0xc6)](_0x2ee44d['id'],_0x4a97a7[_0x2d469a(0xe5)]['id'])){if(_0x3fb5f4[_0x2d469a(0x101)]!==_0x2d469a(0xfc))this[_0x2d469a(0xf7)](_0x443664,_0x3ac7b0,_0x28ee85,_0x3fdd3e);else return _0x4a97a7[_0x2d469a(0xf2)]=_0x5ef230,_0x4a97a7[_0x2d469a(0xf1)](),_0x2c964f&&(_0x3fb5f4[_0x2d469a(0xc6)](_0x2d469a(0xfa),_0x2d469a(0xbb))?_0x478595?this[_0x2d469a(0x86)](_0x5a0c7c):(_0x2583c8[_0x2d469a(0xd5)](_0x2a74c9,this[_0x2d469a(0x78)],_0xd80f23=>{const _0x116715=_0x2d469a;this[_0x116715(0xc7)](_0xd80f23['id']),this[_0x116715(0x9f)](),this[_0x116715(0xb8)]['removeCellMeta'](_0xd80f23[_0x116715(0xef)],_0xd80f23[_0x116715(0x84)],_0x116715(0xbd));}),this[_0x2d469a(0x78)]['length']=0x0):_0x3fb5f4[_0x2d469a(0xc3)](objectEach,_0x4a97a7[_0x2d469a(0x6f)],_0x2fc9ed=>{const _0x25a384=_0x2d469a;_0x2fc9ed[_0x25a384(0x75)](_0x2c964f,_0x2ee44d);})),_0x3e1c10=!![],![];}}),_0x3e1c10;}[_0x57e540(0xda)](){const _0x10d5bd=_0x57e540,_0x162681={'jXdIw':function(_0x2583e7){return _0x2583e7();},'BSBlx':'borders','baoqu':function(_0x5a6f14,_0x52af17){return _0x5a6f14!==_0x52af17;},'VHchP':function(_0x531085,_0x225b45){return _0x531085!==_0x225b45;},'yKufv':_0x10d5bd(0xa9)},_0x50dc3f=this[_0x10d5bd(0xb8)][_0x10d5bd(0x10a)]()[PLUGIN_KEY];if(Array['isArray'](_0x50dc3f))!_0x50dc3f[_0x10d5bd(0x80)]&&(this[_0x10d5bd(0x78)]=_0x50dc3f),this[_0x10d5bd(0xea)](_0x50dc3f);else{if(_0x162681[_0x10d5bd(0xd1)](_0x50dc3f,void 0x0)){if(_0x162681[_0x10d5bd(0xa1)](_0x10d5bd(0xa9),_0x162681['yKufv'])){_0x8d5169[_0x5eaa3e]=_0x162681[_0x10d5bd(0xde)](_0x54cea1);const _0x4c55ad=this[_0x10d5bd(0x105)](_0x4a509e);if(_0x4c55ad===0x4)this['removeAllBorders'](_0x1eb196,_0x3ac2c1);else{const _0x1893f3=this[_0x10d5bd(0xdf)](_0x5adb6b,_0x87295b,_0x2bab5d);!_0x1893f3&&this[_0x10d5bd(0xfb)](_0x14fefd),this[_0x10d5bd(0xb8)]['setCellMeta'](_0x2cffb3,_0x29a91c,_0x162681[_0x10d5bd(0xb5)],_0x1ed681);}}else this['createCustomBorders'](this['savedBorders']);}}}[_0x57e540(0x79)](_0x4f4f34){const _0x201e8b=_0x57e540,_0x3a0c16={'LTNbt':function(_0x3070ef,_0x3edeb3){return _0x3070ef(_0x3edeb3);}};if(!this['hot'][_0x201e8b(0x10a)]()[PLUGIN_KEY])return;_0x4f4f34[_0x201e8b(0x103)][_0x201e8b(0x76)]({'name':'---------'},{'key':_0x201e8b(0xbd),'name'(){const _0xaf9715=_0x201e8b;return this[_0xaf9715(0x9e)](_0xe89062['CONTEXTMENU_ITEMS_BORDERS']);},'disabled'(){const _0x2bab43=_0x201e8b;return this[_0x2bab43(0xe4)]['isSelectedByCorner']();},'submenu':{'items':[_0x3a0c16[_0x201e8b(0xce)](top,this),_0x3a0c16[_0x201e8b(0xce)](right,this),_0x3a0c16[_0x201e8b(0xce)](bottom,this),_0x3a0c16[_0x201e8b(0xce)](left,this),noBorders(this)]}});}[_0x57e540(0xd3)](){const _0x4fdfaf=_0x57e540;this[_0x4fdfaf(0xda)]();}[_0x57e540(0xd8)](){const _0x1a35f0=_0x57e540;super[_0x1a35f0(0xd8)]();}}