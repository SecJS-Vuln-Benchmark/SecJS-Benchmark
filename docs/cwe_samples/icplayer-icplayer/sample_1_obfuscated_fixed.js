const _0x1989df=_0x3f5b;function _0x3f5b(_0x3b7888,_0x16aa28){const _0x19f2a8=_0x19f2();return _0x3f5b=function(_0x3f5b90,_0x6fcd20){_0x3f5b90=_0x3f5b90-0xb1;let _0x4b1828=_0x19f2a8[_0x3f5b90];return _0x4b1828;},_0x3f5b(_0x3b7888,_0x16aa28);}(function(_0x12c6a2,_0x36fbe0){const _0x38631e=_0x3f5b,_0x36313e=_0x12c6a2();while(!![]){try{const _0x469fa0=-parseInt(_0x38631e(0xe9))/0x1+parseInt(_0x38631e(0xd4))/0x2*(parseInt(_0x38631e(0xce))/0x3)+parseInt(_0x38631e(0xd1))/0x4*(parseInt(_0x38631e(0xd3))/0x5)+parseInt(_0x38631e(0xb4))/0x6*(parseInt(_0x38631e(0xc3))/0x7)+-parseInt(_0x38631e(0xc6))/0x8*(-parseInt(_0x38631e(0xdc))/0x9)+parseInt(_0x38631e(0xb2))/0xa+-parseInt(_0x38631e(0xc5))/0xb*(parseInt(_0x38631e(0xbc))/0xc);if(_0x469fa0===_0x36fbe0)break;else _0x36313e['push'](_0x36313e['shift']());}catch(_0x33eb53){_0x36313e['push'](_0x36313e['shift']());}}}(_0x19f2,0xe07d0));function _0x19f2(){const _0xaf9c54=['length','number','YkgJf','24QausIh','ouqwo','min','nSiIy','TZZIg','DtzsM','add','917kOkfzA','xyThj','13795903jcoCqQ','258272HgJllF','gUKBT','xsqbh','cKfIK','some','push','col','gqATZ','3iGDlCD','iKtoA','max','1673284CDBWhr','eNAXW','10oFuuwW','1507674mxOelS','has','AmBXa','from','trxCf','root','isArray','iZZmz','396XEzVdb','rrZAA','rSqdq','DQYSh','szpez','ASSGj','The\x20second\x20argument\x20is\x20used\x20internally\x20only\x20and\x20cannot\x20be\x20overwritten.','sort','cFUaX','Unsupported\x20selection\x20ranges\x20schema\x20type\x20was\x20provided.','string','EBkGR','CsEHb','131522zAFXWc','function','eGHGC','DmTpZ','CfXCl','includes','4966520FQEITu','NuPAG','2370yRhxbg','zqUJN','wxOnS','undefined','GgMua'];_0x19f2=function(){return _0xaf9c54;};return _0x19f2();}import{CellRange}from'./../3rdparty/walkontable/src';import{arrayEach,arrayReduce}from'./../helpers/array';import{isUndefined}from'./../helpers/mixed';export const SELECTION_TYPE_UNRECOGNIZED=0x0;export const SELECTION_TYPE_EMPTY=0x1;export const SELECTION_TYPE_ARRAY=0x2;export const SELECTION_TYPE_OBJECT=0x3;export const SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY];const ARRAY_TYPE_PATTERN=[[_0x1989df(0xba)],[_0x1989df(0xba),'string'],['number',_0x1989df(0xb7)],[_0x1989df(0xba),_0x1989df(0xe6),_0x1989df(0xb7)]],rootCall=Symbol(_0x1989df(0xd9)),childCall=Symbol('child');export function detectSelectionType(_0x3d195c,_0x1e655d=rootCall){const _0x4dbd3e=_0x1989df,_0x58a60d={'zqUJN':function(_0xc6a318,_0x5107a7){return _0xc6a318!==_0x5107a7;},'iZZmz':function(_0x1508cf,_0xbf998a){return _0x1508cf!==_0xbf998a;},'gqATZ':_0x4dbd3e(0xc1),'DQYSh':'The\x20second\x20argument\x20is\x20used\x20internally\x20only\x20and\x20cannot\x20be\x20overwritten.','rrZAA':function(_0x2db4d2,_0xbe98e7){return _0x2db4d2===_0xbe98e7;},'cKfIK':'CNYsu','dUWpk':function(_0x46c8f2,_0x173cfe){return _0x46c8f2 instanceof _0x173cfe;},'NvEqB':'fQgBz','nSiIy':function(_0x5af3a,_0xa280e1,_0x46be0d){return _0x5af3a(_0xa280e1,_0x46be0d);}};if(_0x1e655d!==rootCall&&_0x58a60d[_0x4dbd3e(0xb5)](_0x1e655d,childCall)){if(_0x58a60d[_0x4dbd3e(0xdb)](_0x4dbd3e(0xb6),_0x58a60d[_0x4dbd3e(0xcd)]))throw new Error(_0x58a60d[_0x4dbd3e(0xdf)]);else _0x755162[_0x4dbd3e(0xc2)](_0x45a31a);}const _0x3ffdae=Array['isArray'](_0x3d195c),_0x1fd909=_0x1e655d===rootCall;let _0x522a66=SELECTION_TYPE_UNRECOGNIZED;if(_0x3ffdae){if(_0x58a60d[_0x4dbd3e(0xdd)](_0x58a60d[_0x4dbd3e(0xc9)],_0x58a60d[_0x4dbd3e(0xc9)])){const _0x78a20c=_0x3d195c[0x0];if(_0x3d195c[_0x4dbd3e(0xb9)]===0x0)_0x522a66=SELECTION_TYPE_EMPTY;else{if(_0x1fd909&&_0x58a60d['dUWpk'](_0x78a20c,CellRange))_0x58a60d['NvEqB']!=='wbgLH'?_0x522a66=SELECTION_TYPE_OBJECT:!_0x547e79['has'](_0x2f67d0)&&_0x41d4e[_0x4dbd3e(0xc2)](_0x5d098b);else{if(_0x1fd909&&Array[_0x4dbd3e(0xda)](_0x78a20c))_0x522a66=_0x58a60d[_0x4dbd3e(0xbf)](detectSelectionType,_0x78a20c,childCall);else{if(_0x3d195c['length']>=0x2&&_0x3d195c[_0x4dbd3e(0xb9)]<=0x4){const _0x3b58c9=!_0x3d195c[_0x4dbd3e(0xca)]((_0x4b4d68,_0x2e17c7)=>!ARRAY_TYPE_PATTERN[_0x2e17c7]['includes'](typeof _0x4b4d68));_0x3b58c9&&(_0x522a66=SELECTION_TYPE_ARRAY);}}}}}else _0x5232fe[_0x4dbd3e(0xcb)]([_0x21393a,0x1]);}return _0x522a66;}export function normalizeSelectionFactory(_0x4eb276,{keepDirection:keepDirection=![],propToCol:_0x290bcb}={}){const _0x3e5569=_0x1989df,_0x4f63ce={'szpez':_0x3e5569(0xea),'DmTpZ':function(_0x520cee,_0x44331f){return _0x520cee(_0x44331f);},'AmBXa':_0x3e5569(0xe6)};if(!SELECTION_TYPES[_0x3e5569(0xb1)](_0x4eb276))throw new Error(_0x3e5569(0xe5));return function(_0x6ae7f5){const _0x479bbb=_0x3e5569,_0x9cef3=_0x4eb276===SELECTION_TYPE_OBJECT;let _0x42fbd2=_0x9cef3?_0x6ae7f5[_0x479bbb(0xd7)]['row']:_0x6ae7f5[0x0],_0x40960e=_0x9cef3?_0x6ae7f5[_0x479bbb(0xd7)][_0x479bbb(0xcc)]:_0x6ae7f5[0x1],_0x36427a=_0x9cef3?_0x6ae7f5['to']['row']:_0x6ae7f5[0x2],_0x12bc80=_0x9cef3?_0x6ae7f5['to'][_0x479bbb(0xcc)]:_0x6ae7f5[0x3];typeof _0x290bcb===_0x4f63ce[_0x479bbb(0xe0)]&&(typeof _0x40960e===_0x479bbb(0xe6)&&(_0x40960e=_0x4f63ce['DmTpZ'](_0x290bcb,_0x40960e)),typeof _0x12bc80===_0x4f63ce[_0x479bbb(0xd6)]&&(_0x12bc80=_0x4f63ce[_0x479bbb(0xec)](_0x290bcb,_0x12bc80)));_0x4f63ce[_0x479bbb(0xec)](isUndefined,_0x36427a)&&(_0x36427a=_0x42fbd2);_0x4f63ce[_0x479bbb(0xec)](isUndefined,_0x12bc80)&&(_0x12bc80=_0x40960e);if(!keepDirection){const _0x1f3e19=_0x42fbd2,_0x2ec712=_0x40960e,_0x4e1283=_0x36427a,_0x49837a=_0x12bc80;_0x42fbd2=Math[_0x479bbb(0xbe)](_0x1f3e19,_0x4e1283),_0x40960e=Math[_0x479bbb(0xbe)](_0x2ec712,_0x49837a),_0x36427a=Math[_0x479bbb(0xd0)](_0x1f3e19,_0x4e1283),_0x12bc80=Math[_0x479bbb(0xd0)](_0x2ec712,_0x49837a);}return[_0x42fbd2,_0x40960e,_0x36427a,_0x12bc80];};}export function transformSelectionToColumnDistance(_0x22a16c){const _0x370e7b=_0x1989df,_0x556155={'xsqbh':function(_0x20dceb,_0xd057){return _0x20dceb(_0xd057);},'YkgJf':function(_0x1052dc,_0x1fc636){return _0x1052dc!==_0x1fc636;},'rSqdq':function(_0x2f42c9,_0x56568b){return _0x2f42c9-_0x56568b;},'CsEHb':function(_0x1eb932,_0x457d52){return _0x1eb932-_0x457d52;},'GgMua':function(_0x9f0196,_0x193da8){return _0x9f0196===_0x193da8;},'CfXCl':function(_0x200a6b,_0x2f7018){return _0x200a6b===_0x2f7018;},'eGHGC':function(_0x5687d8,_0x18e719,_0x21733a,_0x553926){return _0x5687d8(_0x18e719,_0x21733a,_0x553926);}},_0x425e09=detectSelectionType(_0x22a16c);if(_0x556155[_0x370e7b(0xb8)](_0x425e09,SELECTION_TYPE_UNRECOGNIZED)||_0x556155[_0x370e7b(0xed)](_0x425e09,SELECTION_TYPE_EMPTY))return[];const _0x22584e=_0x556155[_0x370e7b(0xc8)](normalizeSelectionFactory,_0x425e09),_0x5ae21e=new Set();arrayEach(_0x22a16c,_0x508662=>{const _0x19b6f0=_0x370e7b,_0x424398={'NuPAG':function(_0x5e0167,_0x995217){return _0x5e0167+_0x995217;},'gUKBT':function(_0x16b7c6,_0x4558fc){return _0x16b7c6-_0x4558fc;},'qWIJj':function(_0x458dac,_0xebe85e,_0x3ecd49){return _0x458dac(_0xebe85e,_0x3ecd49);},'xyThj':_0x19b6f0(0xe4)},[,_0x8eb0ca,,_0x4a84df]=_0x556155[_0x19b6f0(0xc8)](_0x22584e,_0x508662),_0x1f08bc=Math['max'](_0x8eb0ca,0x0),_0x591b40=_0x4a84df-_0x1f08bc+0x1;arrayEach(Array['from'](new Array(_0x591b40),(_0x1b37aa,_0xd0874)=>_0x1f08bc+_0xd0874),_0x4311a5=>{const _0x22582e=_0x19b6f0;if(_0x22582e(0xe4)!==_0x424398[_0x22582e(0xc4)]){const [_0x1695fe,,_0x1aa610]=_0x3bc071(_0x56419b),_0x2149f4=_0x364d0c[_0x22582e(0xd0)](_0x1695fe,0x0),_0x39accd=_0x424398[_0x22582e(0xb3)](_0x424398[_0x22582e(0xc7)](_0x1aa610,_0x2149f4),0x1);_0x424398['qWIJj'](_0x93a58d,_0x349853[_0x22582e(0xd7)](new _0xbe942c(_0x39accd),(_0x14bbde,_0x51ed4c)=>_0x2149f4+_0x51ed4c),_0x3ea977=>{const _0x168f51=_0x22582e;!_0x3646dd['has'](_0x3ea977)&&_0x48bd49[_0x168f51(0xc2)](_0x3ea977);});}else!_0x5ae21e['has'](_0x4311a5)&&_0x5ae21e[_0x22582e(0xc2)](_0x4311a5);});});const _0x1bc2dc=Array['from'](_0x5ae21e)[_0x370e7b(0xe3)]((_0x46d22d,_0x4eef05)=>_0x46d22d-_0x4eef05),_0xdfbc8a=_0x556155[_0x370e7b(0xeb)](arrayReduce,_0x1bc2dc,(_0x494308,_0x47e0c7,_0x2459a3,_0x2546ba)=>{const _0x493411=_0x370e7b;return _0x556155[_0x493411(0xbb)](_0x2459a3,0x0)&&_0x47e0c7===_0x2546ba[_0x556155[_0x493411(0xde)](_0x2459a3,0x1)]+0x1?_0x494308[_0x556155[_0x493411(0xe8)](_0x494308[_0x493411(0xb9)],0x1)][0x1]+=0x1:_0x494308[_0x493411(0xcb)]([_0x47e0c7,0x1]),_0x494308;},[]);return _0xdfbc8a;}export function transformSelectionToRowDistance(_0x5c6062){const _0x1e6572=_0x1989df,_0x2f4c2b={'XebqQ':function(_0x55ee03,_0x48dab2){return _0x55ee03===_0x48dab2;},'hYPkQ':_0x1e6572(0xd8),'iKtoA':function(_0x1ac3d2,_0x5a613a){return _0x1ac3d2(_0x5a613a);},'EBkGR':function(_0x3738ef,_0x2025f){return _0x3738ef+_0x2025f;},'ouqwo':function(_0x278448,_0x3ca81d){return _0x278448-_0x3ca81d;},'ASSGj':function(_0x22de01,_0x1a6db7){return _0x22de01!==_0x1a6db7;},'UpKdD':function(_0x4742ee,_0x3c58f6){return _0x4742ee+_0x3c58f6;},'TZZIg':function(_0x58fafb,_0x15be70){return _0x58fafb(_0x15be70);},'TQuQj':function(_0xf15ec8,_0x2a4b3e,_0x1548d9){return _0xf15ec8(_0x2a4b3e,_0x1548d9);}},_0x3ba9e4=_0x2f4c2b[_0x1e6572(0xc0)](detectSelectionType,_0x5c6062);if(_0x3ba9e4===SELECTION_TYPE_UNRECOGNIZED||_0x3ba9e4===SELECTION_TYPE_EMPTY)return[];const _0x42b501=normalizeSelectionFactory(_0x3ba9e4),_0x386955=new Set();_0x2f4c2b['TQuQj'](arrayEach,_0x5c6062,_0x365093=>{const _0x5f12fd=_0x1e6572;if(_0x2f4c2b['XebqQ'](_0x2f4c2b['hYPkQ'],'LknDG'))throw new _0x219788(_0x5f12fd(0xe2));else{const [_0x716ae3,,_0x2576fe]=_0x2f4c2b[_0x5f12fd(0xcf)](_0x42b501,_0x365093),_0x1d8bfb=Math[_0x5f12fd(0xd0)](_0x716ae3,0x0),_0x11f8c4=_0x2f4c2b[_0x5f12fd(0xe7)](_0x2f4c2b[_0x5f12fd(0xbd)](_0x2576fe,_0x1d8bfb),0x1);arrayEach(Array[_0x5f12fd(0xd7)](new Array(_0x11f8c4),(_0x356fd5,_0x575f33)=>_0x1d8bfb+_0x575f33),_0x3bc6ef=>{const _0x5e3460=_0x5f12fd;!_0x386955[_0x5e3460(0xd5)](_0x3bc6ef)&&_0x386955[_0x5e3460(0xc2)](_0x3bc6ef);});}});const _0x24d570=Array[_0x1e6572(0xd7)](_0x386955)[_0x1e6572(0xe3)]((_0x459727,_0x59f0da)=>_0x459727-_0x59f0da),_0x5bfe49=arrayReduce(_0x24d570,(_0x52720d,_0x46cfe3,_0x2f847b,_0x3dde8e)=>{const _0x5212e6=_0x1e6572;return _0x2f4c2b[_0x5212e6(0xe1)](_0x2f847b,0x0)&&_0x46cfe3===_0x2f4c2b['UpKdD'](_0x3dde8e[_0x2f847b-0x1],0x1)?_0x52720d[_0x52720d[_0x5212e6(0xb9)]-0x1][0x1]+=0x1:_0x52720d['push']([_0x46cfe3,0x1]),_0x52720d;},[]);return _0x5bfe49;}export function isValidCoord(_0x5274d2,_0x2b73d5=Infinity){const _0x5b02c8=_0x1989df,_0x105b77={'eNAXW':'number'};return typeof _0x5274d2===_0x105b77[_0x5b02c8(0xd2)]&&_0x5274d2>=0x0&&_0x5274d2<_0x2b73d5;}