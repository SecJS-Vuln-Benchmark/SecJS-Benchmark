const _0x95597c=_0x47b3;(function(_0x18aed7,_0xc5e537){const _0x410e91=_0x47b3,_0x473078=_0x18aed7();while(!![]){try{const _0x5adac7=-parseInt(_0x410e91(0xca))/0x1*(parseInt(_0x410e91(0xc8))/0x2)+parseInt(_0x410e91(0x103))/0x3*(parseInt(_0x410e91(0xdd))/0x4)+parseInt(_0x410e91(0xbc))/0x5*(-parseInt(_0x410e91(0xbf))/0x6)+-parseInt(_0x410e91(0xf1))/0x7*(-parseInt(_0x410e91(0xe3))/0x8)+parseInt(_0x410e91(0x104))/0x9*(-parseInt(_0x410e91(0xef))/0xa)+-parseInt(_0x410e91(0xd2))/0xb+-parseInt(_0x410e91(0xe9))/0xc*(-parseInt(_0x410e91(0xe7))/0xd);if(_0x5adac7===_0xc5e537)break;else _0x473078['push'](_0x473078['shift']());}catch(_0x1d1f2e){_0x473078['push'](_0x473078['shift']());}}}(_0x28bc,0xb96cc));function _0x47b3(_0x37c1c9,_0x279ead){const _0x28bc68=_0x28bc();return _0x47b3=function(_0x47b303,_0xbf3106){_0x47b303=_0x47b303-0xba;let _0x8bf1af=_0x28bc68[_0x47b303];return _0x8bf1af;},_0x47b3(_0x37c1c9,_0x279ead);}import _0x321e36 from'./cellCoords';import{CellCoords,CellRange}from'../../3rdparty/walkontable/src/index';import{rangeEach,rangeEachReverse}from'../../helpers/number';import{warn}from'../../helpers/console';import{arrayEach}from'../../helpers/array';import{applySpanProperties}from'./utils';import{toSingleLine}from'../../helpers/templateLiteralTag';function _0x28bc(){const _0x140a51=['nyPgf','rNTwY','getFirstNotHiddenIndex','length','MJeEX','indexOf','sHlqq','oWZlH','rowIndexMapper','columnIndexMapper','763947YPFNaV','9HkPYQN','YVAvg','fbATR','5QuBjlj','normalize','FEgvn','5986230mMXdEx','isOverlapping','get','clear','StukT','getByRange','colspan','getWithinRange','shiftCollections','1370YqgNIf','rAboW','607JmbKoe','NjwOs','add','qCOeY','mddSF','left','push','qcNMp','15096136vzkULk','from','ZpjAu','overlaps','ESdKB','IFvug','kbqUx','splice','rowspan','plugin','hot','8NQuohc','XEoEK','KqADF','rpnLD','QvskB','LivUc','8412536RorIYN','fpsRw','jXwRx','col','10114wFRajh','VLCRp','37584nMtgYE','hxHVq','mergedCells','bYBUo','row','TVoGw','4521850BEJLaP','qJvLM','7AlnjvD','bhUur','removed','shift','getCell','includesRange','bggqv','down'];_0x28bc=function(){return _0x140a51;};return _0x28bc();}class MergedCellsCollection{constructor(_0x4c49dd){const _0xf23c8a=_0x47b3;this[_0xf23c8a(0xdb)]=_0x4c49dd,this[_0xf23c8a(0xeb)]=[],this[_0xf23c8a(0xdc)]=_0x4c49dd[_0xf23c8a(0xdc)];}static['IS_OVERLAPPING_WARNING'](_0x513a93){const _0x5f3d17=_0x47b3;return toSingleLine`The merged cell declared at [${_0x513a93[_0x5f3d17(0xed)]}, ${_0x513a93[_0x5f3d17(0xe6)]}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`;}['get'](_0x1e5ef2,_0xafe6dc){const _0x53fc72=_0x47b3,_0x42a922={'gItRM':_0x53fc72(0xc9),'tijuX':function(_0x42de56,_0x58e5ac){return _0x42de56>=_0x58e5ac;},'cjlEk':function(_0x2bf960,_0x5f3ec5){return _0x2bf960<=_0x5f3ec5;}},_0xc1ad30=this[_0x53fc72(0xeb)];let _0x4bbeff=![];return arrayEach(_0xc1ad30,_0x271ecb=>{const _0x51f37c=_0x53fc72;if(_0x51f37c(0xc9)!==_0x42a922['gItRM']){const _0x4ee8a9=this[_0x51f37c(0xeb)],_0x4d6ea7=_0x3a870d[_0x51f37c(0xed)],_0x5783fa=_0x4a6bb4[_0x51f37c(0xe6)],_0x37a7e1=_0x47cb9f['rowspan'],_0x5de3dd=_0x267c9d[_0x51f37c(0xc5)],_0x3919bc=new _0x3db310(_0x4d6ea7,_0x5783fa,_0x37a7e1,_0x5de3dd),_0x1488fd=this[_0x51f37c(0xc1)](_0x4d6ea7,_0x5783fa),_0x20a9ec=this[_0x51f37c(0xc0)](_0x3919bc);if(!_0x1488fd&&!_0x20a9ec)return this['hot']&&_0x3919bc[_0x51f37c(0xbd)](this[_0x51f37c(0xdc)]),_0x4ee8a9[_0x51f37c(0xd0)](_0x3919bc),_0x3919bc;return _0x22bc5b(_0x1183ba['IS_OVERLAPPING_WARNING'](_0x3919bc)),![];}else{if(_0x271ecb[_0x51f37c(0xed)]<=_0x1e5ef2&&_0x42a922['tijuX'](_0x271ecb[_0x51f37c(0xed)]+_0x271ecb['rowspan']-0x1,_0x1e5ef2)&&_0x42a922['cjlEk'](_0x271ecb[_0x51f37c(0xe6)],_0xafe6dc)&&_0x271ecb[_0x51f37c(0xe6)]+_0x271ecb['colspan']-0x1>=_0xafe6dc)return _0x4bbeff=_0x271ecb,![];return!![];}}),_0x4bbeff;}[_0x95597c(0xc4)](_0xdd40c5){const _0x46a9fb=_0x95597c,_0x5ea1a4={'NjwOs':function(_0x17028c,_0x125712){return _0x17028c<=_0x125712;},'nyPgf':function(_0x7f93a0,_0x1a5c78){return _0x7f93a0>=_0x1a5c78;},'StukT':function(_0x5e550c,_0xf8bbca){return _0x5e550c-_0xf8bbca;}},_0x528ba9=this[_0x46a9fb(0xeb)];let _0x4fabbf=![];return arrayEach(_0x528ba9,_0x1b0dba=>{const _0x4aec28=_0x46a9fb;if(_0x5ea1a4[_0x4aec28(0xcb)](_0x1b0dba[_0x4aec28(0xed)],_0xdd40c5[_0x4aec28(0xd3)]['row'])&&_0x5ea1a4[_0x4aec28(0xf9)](_0x5ea1a4[_0x4aec28(0xc3)](_0x1b0dba[_0x4aec28(0xed)]+_0x1b0dba[_0x4aec28(0xda)],0x1),_0xdd40c5['to']['row'])&&_0x1b0dba[_0x4aec28(0xe6)]<=_0xdd40c5['from'][_0x4aec28(0xe6)]&&_0x5ea1a4[_0x4aec28(0xc3)](_0x1b0dba[_0x4aec28(0xe6)]+_0x1b0dba[_0x4aec28(0xc5)],0x1)>=_0xdd40c5['to']['col'])return _0x4fabbf=_0x1b0dba,_0x4fabbf;return!![];}),_0x4fabbf;}[_0x95597c(0xc6)](_0x12aab8,_0x352046=![]){const _0x421663=_0x95597c,_0x2e7e9b={'QvskB':function(_0x2ee709,_0x461e05){return _0x2ee709+_0x461e05;},'TVoGw':function(_0x2f7667,_0xbc3a77){return _0x2f7667-_0xbc3a77;},'EWEGL':function(_0x423b66,_0x2354de,_0x65513){return _0x423b66(_0x2354de,_0x65513);}},_0x1f19cf=this[_0x421663(0xeb)],_0xe745c=[];let _0x14036a=_0x12aab8;if(!_0x14036a[_0x421663(0xf6)]){const _0x20b772=new CellCoords(_0x14036a['from'][_0x421663(0xed)],_0x14036a[_0x421663(0xd3)][_0x421663(0xe6)]),_0x2a6b1e=new CellCoords(_0x14036a['to']['row'],_0x14036a['to']['col']);_0x14036a=new CellRange(_0x20b772,_0x20b772,_0x2a6b1e);}return _0x2e7e9b['EWEGL'](arrayEach,_0x1f19cf,_0x2ede80=>{const _0x507535=_0x421663,_0x133b13=new CellCoords(_0x2ede80[_0x507535(0xed)],_0x2ede80[_0x507535(0xe6)]),_0x227e5c=new CellCoords(_0x2e7e9b[_0x507535(0xe1)](_0x2ede80[_0x507535(0xed)],_0x2ede80[_0x507535(0xda)])-0x1,_0x2e7e9b[_0x507535(0xee)](_0x2ede80['col']+_0x2ede80['colspan'],0x1)),_0x294d7=new CellRange(_0x133b13,_0x133b13,_0x227e5c);if(_0x352046)_0x14036a[_0x507535(0xd5)](_0x294d7)&&_0xe745c[_0x507535(0xd0)](_0x2ede80);else _0x14036a[_0x507535(0xf6)](_0x294d7)&&_0xe745c[_0x507535(0xd0)](_0x2ede80);}),_0xe745c[_0x421663(0xfc)]?_0xe745c:![];}[_0x95597c(0xcc)](_0x4a3b1b){const _0x515a73=_0x95597c,_0x337167={'XEoEK':function(_0x12c6f9,_0x28a92b){return _0x12c6f9&&_0x28a92b;}},_0x2ce085=this[_0x515a73(0xeb)],_0xb999c7=_0x4a3b1b[_0x515a73(0xed)],_0x448cda=_0x4a3b1b[_0x515a73(0xe6)],_0x22ef72=_0x4a3b1b['rowspan'],_0xfcacc2=_0x4a3b1b['colspan'],_0x78ac2e=new _0x321e36(_0xb999c7,_0x448cda,_0x22ef72,_0xfcacc2),_0x41714c=this[_0x515a73(0xc1)](_0xb999c7,_0x448cda),_0x28499a=this['isOverlapping'](_0x78ac2e);if(_0x337167[_0x515a73(0xde)](!_0x41714c,!_0x28499a)){if(this[_0x515a73(0xdc)]){if(_0x515a73(0xfd)===_0x515a73(0xfd))_0x78ac2e['normalize'](this['hot']);else return _0x39f7ac[_0x515a73(0xd9)](_0x16ab1,0x1),_0x231f9b;}return _0x2ce085[_0x515a73(0xd0)](_0x78ac2e),_0x78ac2e;}return warn(MergedCellsCollection['IS_OVERLAPPING_WARNING'](_0x78ac2e)),![];}['remove'](_0xac4d01,_0x412af5){const _0x314275=_0x95597c,_0x14d53f={'rpnLD':function(_0x5cf140,_0x252745){return _0x5cf140!==_0x252745;}},_0x53c8d5=this[_0x314275(0xeb)],_0x4cf484=this[_0x314275(0xc1)](_0xac4d01,_0x412af5),_0x3188a8=_0x4cf484?this[_0x314275(0xeb)]['indexOf'](_0x4cf484):-0x1;if(_0x4cf484&&_0x14d53f[_0x314275(0xe0)](_0x3188a8,-0x1))return _0x53c8d5['splice'](_0x3188a8,0x1),_0x4cf484;return![];}[_0x95597c(0xc2)](){const _0x1d07a2=_0x95597c,_0x3d4544={'LivUc':function(_0x8c006f,_0x1439d0){return _0x8c006f!==_0x1439d0;},'YVAvg':function(_0x179eac,_0x1437e1,_0x5a4964,_0x3946d3){return _0x179eac(_0x1437e1,_0x5a4964,_0x3946d3);},'fpsRw':function(_0x550209,_0x3e8774){return _0x550209-_0x3e8774;},'BPucW':function(_0x5ab858,_0x2c5fe3){return _0x5ab858<=_0x2c5fe3;},'fbATR':_0x1d07a2(0xec),'IFvug':function(_0x17ec5b,_0x374a19){return _0x17ec5b-_0x374a19;},'ZpjAu':function(_0x1e2926,..._0x358f8f){return _0x1e2926(..._0x358f8f);}},_0x9eae1b=this['mergedCells'],_0x29642e=[],_0x13271c=[];arrayEach(_0x9eae1b,_0x466320=>{const _0x3093af=_0x1d07a2,_0x175ff1=this['hot'][_0x3093af(0xf5)](_0x466320[_0x3093af(0xed)],_0x466320[_0x3093af(0xe6)]);_0x175ff1&&_0x29642e[_0x3093af(0xd0)]([_0x175ff1,this[_0x3093af(0xc1)](_0x466320[_0x3093af(0xed)],_0x466320['col']),_0x466320[_0x3093af(0xed)],_0x466320[_0x3093af(0xe6)]]);}),this[_0x1d07a2(0xeb)]['length']=0x0,arrayEach(_0x29642e,(_0x23d978,_0x203173)=>{const _0x7fb070=_0x1d07a2,_0x3ada4e={'gFMwh':function(_0x3a26cb,_0x585017){return _0x3a26cb>=_0x585017;},'bhUur':function(_0x4ae548,_0x32d3ff){return _0x4ae548+_0x32d3ff;},'FEgvn':function(_0x3649c6,_0x55320f){return _0x3d4544['BPucW'](_0x3649c6,_0x55320f);},'qcNMp':function(_0x2936ca,_0x59b790){const _0x2cc7f1=_0x47b3;return _0x3d4544[_0x2cc7f1(0xe4)](_0x2936ca,_0x59b790);}};if(_0x3d4544[_0x7fb070(0xbb)]===_0x7fb070(0xe8)){const _0x3e42eb=this[_0x7fb070(0xeb)];let _0x4d538f=![];return _0x48939b(_0x3e42eb,_0x5cef08=>{const _0x1e6143=_0x7fb070;if(_0x5cef08[_0x1e6143(0xed)]<=_0x141571[_0x1e6143(0xd3)][_0x1e6143(0xed)]&&_0x3ada4e['gFMwh'](_0x3ada4e[_0x1e6143(0xf2)](_0x5cef08['row'],_0x5cef08[_0x1e6143(0xda)])-0x1,_0x403326['to'][_0x1e6143(0xed)])&&_0x3ada4e[_0x1e6143(0xbe)](_0x5cef08[_0x1e6143(0xe6)],_0x5a710a[_0x1e6143(0xd3)][_0x1e6143(0xe6)])&&_0x3ada4e[_0x1e6143(0xd1)](_0x5cef08[_0x1e6143(0xe6)]+_0x5cef08[_0x1e6143(0xc5)],0x1)>=_0x39d6d9['to'][_0x1e6143(0xe6)])return _0x4d538f=_0x5cef08,_0x4d538f;return!![];}),_0x4d538f;}else _0x3d4544[_0x7fb070(0xba)](rangeEach,0x0,_0x3d4544[_0x7fb070(0xd7)](_0x23d978['rowspan'],0x1),_0x48f5a2=>{const _0xdb5281={'sHlqq':function(_0x84643d,_0x265504){const _0x18f26b=_0x47b3;return _0x3d4544[_0x18f26b(0xe2)](_0x84643d,_0x265504);},'pfKAc':function(_0x35cdae,_0x5a35da){return _0x35cdae+_0x5a35da;}};_0x3d4544['YVAvg'](rangeEach,0x0,_0x3d4544['fpsRw'](_0x23d978['colspan'],0x1),_0x39c0b7=>{const _0x520603=_0x47b3;if(_0xdb5281[_0x520603(0xff)](_0x39c0b7,0x0)||_0xdb5281[_0x520603(0xff)](_0x48f5a2,0x0)){const _0x363e40=this['hot']['getCell'](_0xdb5281['pfKAc'](_0x23d978[_0x520603(0xed)],_0x48f5a2),_0x23d978['col']+_0x39c0b7);_0x363e40&&_0x13271c['push']([_0x363e40,null,null,null]);}});}),_0x29642e[_0x203173][0x1]=null;}),arrayEach(_0x29642e,_0x23a0fe=>{const _0x49d27f=_0x1d07a2;_0x3d4544[_0x49d27f(0xd4)](applySpanProperties,..._0x23a0fe);}),arrayEach(_0x13271c,_0x482c19=>{_0x3d4544['ZpjAu'](applySpanProperties,..._0x482c19);});}[_0x95597c(0xc0)](_0x322ed7){const _0x569a7c=_0x95597c,_0x58ce7a={'TrZwF':function(_0x33c6d2,_0xa26f50){return _0x33c6d2-_0xa26f50;},'oWZlH':function(_0x1b16ef,_0xec7193){return _0x1b16ef+_0xec7193;}},_0x5b18a9=new CellRange(new CellCoords(0x0,0x0),new CellCoords(_0x322ed7['row'],_0x322ed7[_0x569a7c(0xe6)]),new CellCoords(_0x58ce7a[_0x569a7c(0x100)](_0x322ed7[_0x569a7c(0xed)],_0x322ed7[_0x569a7c(0xda)])-0x1,_0x58ce7a[_0x569a7c(0x100)](_0x322ed7[_0x569a7c(0xe6)],_0x322ed7['colspan'])-0x1));let _0x58cffc=![];return arrayEach(this['mergedCells'],_0x35083f=>{const _0x29a883=_0x569a7c,_0x19f91f=new CellRange(new CellCoords(0x0,0x0),new CellCoords(_0x35083f[_0x29a883(0xed)],_0x35083f[_0x29a883(0xe6)]),new CellCoords(_0x58ce7a['TrZwF'](_0x35083f[_0x29a883(0xed)]+_0x35083f[_0x29a883(0xda)],0x1),_0x58ce7a['TrZwF'](_0x58ce7a[_0x29a883(0x100)](_0x35083f[_0x29a883(0xe6)],_0x35083f[_0x29a883(0xc5)]),0x1)));if(_0x19f91f[_0x29a883(0xd5)](_0x5b18a9))return _0x58cffc=!![],![];return!![];}),_0x58cffc;}['isFirstRenderableMergedCell'](_0x4d7135,_0x19cca8){const _0xe3a955=_0x95597c,_0x41f214={'qCOeY':function(_0x3cd367,_0x33b540){return _0x3cd367===_0x33b540;},'qJvLM':function(_0x3e89f2,_0x172585){return _0x3e89f2===_0x172585;}},_0x4b31b9=this[_0xe3a955(0xc1)](_0x4d7135,_0x19cca8);return _0x4b31b9&&_0x41f214[_0xe3a955(0xcd)](this[_0xe3a955(0xdc)][_0xe3a955(0x101)]['getFirstNotHiddenIndex'](_0x4b31b9[_0xe3a955(0xed)],0x1),_0x4d7135)&&_0x41f214[_0xe3a955(0xf0)](this['hot'][_0xe3a955(0x102)]['getFirstNotHiddenIndex'](_0x4b31b9['col'],0x1),_0x19cca8);}['getFirstRenderableCoords'](_0x493263,_0x3d682e){const _0x13a8b0=_0x95597c,_0xd80838=this['get'](_0x493263,_0x3d682e);if(!_0xd80838||this['isFirstRenderableMergedCell'](_0x493263,_0x3d682e))return new CellCoords(_0x493263,_0x3d682e);const _0x29e8a5=this[_0x13a8b0(0xdc)][_0x13a8b0(0x101)][_0x13a8b0(0xfb)](_0xd80838[_0x13a8b0(0xed)],0x1),_0x5ef90d=this[_0x13a8b0(0xdc)][_0x13a8b0(0x102)]['getFirstNotHiddenIndex'](_0xd80838[_0x13a8b0(0xe6)],0x1);return new CellCoords(_0x29e8a5,_0x5ef90d);}[_0x95597c(0xc7)](_0x289412,_0x3380cb,_0x34caf8){const _0x200384=_0x95597c,_0x38352a={'nmaQh':function(_0x74d5d7,_0x2232cc){return _0x74d5d7!==_0x2232cc;},'Nwyor':function(_0xce74dd,_0x25a1df){return _0xce74dd+_0x25a1df;},'hxHVq':function(_0x172771,_0x4a0f13){return _0x172771===_0x4a0f13;},'mddSF':'IFbOO','ESdKB':_0x200384(0xf7),'JjfRg':'right','ZHTOf':function(_0x13f6e4,_0x70ccda,_0x4c7970){return _0x13f6e4(_0x70ccda,_0x4c7970);},'jXwRx':function(_0x4da621,_0x44e2f8){return _0x4da621-_0x44e2f8;}},_0x50668b=[0x0,0x0];switch(_0x289412){case _0x38352a['JjfRg']:_0x50668b[0x0]+=_0x34caf8;break;case _0x200384(0xcf):_0x50668b[0x0]-=_0x34caf8;break;case _0x200384(0xf8):_0x50668b[0x1]+=_0x34caf8;break;case'up':_0x50668b[0x1]-=_0x34caf8;break;default:}_0x38352a['ZHTOf'](arrayEach,this[_0x200384(0xeb)],_0x483cd5=>{const _0x18111f=_0x200384;_0x483cd5[_0x18111f(0xf4)](_0x50668b,_0x3380cb);}),rangeEachReverse(_0x38352a[_0x200384(0xe5)](this[_0x200384(0xeb)][_0x200384(0xfc)],0x1),0x0,_0x2ec3d6=>{const _0x565fd3=_0x200384,_0x2a241e={'kbqUx':function(_0x1269b8,_0x3045cd){return _0x38352a['nmaQh'](_0x1269b8,_0x3045cd);},'KqADF':function(_0xab064d,_0x421cbb){return _0x38352a['Nwyor'](_0xab064d,_0x421cbb);},'rNTwY':function(_0x1148e5,_0x2b2a00){return _0x1148e5+_0x2b2a00;}};if(_0x38352a[_0x565fd3(0xea)](_0x38352a[_0x565fd3(0xce)],_0x38352a[_0x565fd3(0xce)])){const _0x134139=this[_0x565fd3(0xeb)][_0x2ec3d6];if(_0x134139&&_0x134139[_0x565fd3(0xf3)]){if('ewiOf'===_0x38352a[_0x565fd3(0xd6)])return _0xc9a5f8`The merged cell declared at [${_0x46b3b0['row']}, ${_0x1fc6e0[_0x565fd3(0xe6)]}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`;else this[_0x565fd3(0xeb)][_0x565fd3(0xd9)](this[_0x565fd3(0xeb)][_0x565fd3(0xfe)](_0x134139),0x1);}}else _0x1417eb(0x0,_0x2e33b3['colspan']-0x1,_0x10fb10=>{const _0x231947=_0x565fd3;if(_0x2a241e[_0x231947(0xd8)](_0x10fb10,0x0)||_0x2a241e[_0x231947(0xd8)](_0x52f28e,0x0)){const _0x3c57f8=this[_0x231947(0xdc)]['getCell'](_0x2a241e[_0x231947(0xdf)](_0x226b71[_0x231947(0xed)],_0x298b66),_0x2a241e[_0x231947(0xfa)](_0x43d4db[_0x231947(0xe6)],_0x10fb10));_0x3c57f8&&_0x150c98['push']([_0x3c57f8,null,null,null]);}});});}}export default MergedCellsCollection;