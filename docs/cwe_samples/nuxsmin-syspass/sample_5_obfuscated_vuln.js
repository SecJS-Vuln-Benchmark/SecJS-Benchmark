'use strict';const _0x68cb61=_0x4381;(function(_0x127f7b,_0x3ae008){const _0x1364ab=_0x4381,_0x6e2f9d=_0x127f7b();while(!![]){try{const _0xb6b17f=-parseInt(_0x1364ab(0x128))/0x1*(parseInt(_0x1364ab(0x141))/0x2)+parseInt(_0x1364ab(0x125))/0x3+parseInt(_0x1364ab(0x151))/0x4+parseInt(_0x1364ab(0x129))/0x5*(parseInt(_0x1364ab(0x157))/0x6)+-parseInt(_0x1364ab(0x16a))/0x7+-parseInt(_0x1364ab(0x100))/0x8*(parseInt(_0x1364ab(0x139))/0x9)+parseInt(_0x1364ab(0x113))/0xa;if(_0xb6b17f===_0x3ae008)break;else _0x6e2f9d['push'](_0x6e2f9d['shift']());}catch(_0x502e7f){_0x6e2f9d['push'](_0x6e2f9d['shift']());}}}(_0x1ad9,0x83d89));function _0x1ad9(){const _0x336d86=['_on_PublishRequest','statusCode','removeListener','ns=0;i=2258','closeSession','createSession','callCount','getSubscription','constructor','createSubscription','Zzetr','Good','622818iZTEpD','status','XCX\x20session\x20should\x20emit\x20a\x20new_subscription\x20and\x20subscription_terminated\x20event','244865sEURhG','15710pqXaVP','lufuH','createMonitoredItem','XFdLK','call','clock','instanceOf','ulgCr','qWITy','Both','currentSubscriptionCount','currentSessionCount','shutdown','lifeTimeCount','equal','initialize','1377JaxBdQ','iZvom','rnSLs','BadNoSubscription','DDD\x20delete\x20a\x20subscription\x20with\x202\x20outstanding\x20PublishRequest','findNode','BadSubscriptionIdInvalid','CREATING','6FpIejm','new_subscription','VGuAU','rdDcU','CLOSED','ZDZ-2\x20LifetimeCount,\x20the\x20publish\x20engine\x20shall\x20send\x20a\x20StatusChangeNotification\x20to\x20inform\x20that\x20a\x20subscription\x20has\x20been\x20closed\x20because\x20of\x20lifetime\x20timeout\x20-\x20with\x202\x20subscriptions','should\x20check\x20the\x20subscription\x20live\x20cycle','name','Iomai','exist','EgrFr','LJrbS','sinon','CloseSession','addressSpace','publishEngine','110180jCpyio','node-opcua-leak-detector','state','notificationData','dispose','node-opcua-service-subscription','858VrAtpB','cumulatedSessionCount','deleteSubscription','bMYko','should\x20return\x20an\x20error\x20when\x20trying\x20to\x20delete\x20an\x20non-existing\x20subscription','cumulatedSubscriptionCount','getCall','publishingInterval','notificationMessage','yuHlO','StatusChangeNotification','describeWithLeakDetector','spy','length','authenticationToken','wPnZw','monitoredItem','KtRQL','BadTimeout','7430955LvKpjs','monitoredItemCount','samplingFunc','sequenceNumber','AZQ\x20should\x20receive\x20StatusChangeNotification\x20from\x20first\x20subscription\x20even\x20if\x20publishRequest\x20arrives\x20late','ZHgAu','31704fYsbTi','subscription_terminated','eql','responseHeader','IPwBo','LATE','FolderType','gJfEl','KEEPALIVE','ServerEngine\x20Subscriptions\x20service','ZBUDt','messageSent','tick','subscriptionId','should\x20maintain\x20the\x20correct\x20number\x20of\x20cumulatedSubscriptionCount\x20at\x20the\x20engine\x20level','ZBxOt','maxKeepAliveCount','should','BaseDataVariableType','22580830PGZAAb','AZW2\x20should\x20terminate\x20a\x20orphan\x20subscription\x20containing\x20monitored\x20items','serviceResult','requestHandle','Reporting','args'];_0x1ad9=function(){return _0x336d86;};return _0x1ad9();}function _0x4381(_0x4b5f3e,_0x1b2071){const _0x1ad969=_0x1ad9();return _0x4381=function(_0x4381d0,_0x468761){_0x4381d0=_0x4381d0-0xff;let _0x259c73=_0x1ad969[_0x4381d0];return _0x259c73;},_0x4381(_0x4b5f3e,_0x1b2071);}const should=require(_0x68cb61(0x111)),sinon=require(_0x68cb61(0x14d)),{MonitoringMode,PublishRequest}=require(_0x68cb61(0x156)),{StatusCodes,StatusCode}=require('node-opcua-status-code'),{TimestampsToReturn}=require('node-opcua-service-read'),{MonitoredItemCreateRequest}=require(_0x68cb61(0x156)),{get_mini_nodeset_filename}=require('node-opcua-address-space/testHelpers'),{ServerEngine,SubscriptionState}=require('..'),{with_fake_timer}=require('./helper_with_fake_timer'),mini_nodeset_filename=get_mini_nodeset_filename(),describe=require(_0x68cb61(0x152))[_0x68cb61(0x162)];describe(_0x68cb61(0x109),function(){const _0x3f5dfb=_0x68cb61,_0x206839={'pKQtR':_0x3f5dfb(0x142),'lufuH':function(_0x3049f5,_0x1a169f){return _0x3049f5*_0x1a169f;},'dAgGo':function(_0x57bdf8,_0x364a15){return _0x57bdf8*_0x364a15;},'VGuAU':_0x3f5dfb(0x14e),'rdDcU':_0x3f5dfb(0x161),'FiLLj':_0x3f5dfb(0x167),'yuHlO':_0x3f5dfb(0x11c),'QfEua':function(_0x228eaa,_0x454d04){return _0x228eaa*_0x454d04;},'LJrbS':function(_0x56385e,_0x5b3e94){return _0x56385e(_0x5b3e94);},'VLitk':_0x3f5dfb(0x15b),'Iomai':function(_0x2d5a92,_0x581377,_0x199d01){return _0x2d5a92(_0x581377,_0x199d01);},'qWITy':_0x3f5dfb(0x127),'EgrFr':_0x3f5dfb(0x10e),'wPnZw':function(_0x536aa7,_0x4dd1c1,_0x18f1d9){return _0x536aa7(_0x4dd1c1,_0x18f1d9);},'ZBUDt':'AZW1\x20should\x20receive\x20StatusChangeNotification\x20from\x20first\x20subscription\x20even\x20if\x20publishRequest\x20arrives\x20late','bMYko':function(_0x29aac9,_0xa535bb,_0x5d9365){return _0x29aac9(_0xa535bb,_0x5d9365);}},_0x8dad0a=this;let _0x3eb7a3,_0xd4a39f,_0xe5d50a,_0x3d9f0a;_0x206839[_0x3f5dfb(0x14c)](beforeEach,function(_0x144173){const _0x59cd3d=_0x3f5dfb,_0x57d468={'nxGTL':_0x59cd3d(0x106)};_0x3eb7a3=new ServerEngine(),_0x3eb7a3[_0x59cd3d(0x138)]({'nodeset_filename':mini_nodeset_filename},function(){const _0x52f6f0=_0x59cd3d;_0xe5d50a=_0x3eb7a3[_0x52f6f0(0x14f)][_0x52f6f0(0x13e)](_0x57d468['nxGTL'])['nodeId'],_0x3d9f0a=_0x3eb7a3[_0x52f6f0(0x14f)][_0x52f6f0(0x13e)](_0x52f6f0(0x112))['nodeId'],_0x144173();});}),_0x206839[_0x3f5dfb(0x14c)](afterEach,async()=>{const _0x3ef447=_0x3f5dfb;_0xd4a39f=null,should[_0x3ef447(0x14a)](_0x3eb7a3),await _0x3eb7a3[_0x3ef447(0x135)](),_0x3eb7a3=null;}),it(_0x206839['VLitk'],async()=>{const _0x3254fd=_0x3f5dfb;_0xd4a39f=_0x3eb7a3[_0x3254fd(0x11e)]();const _0x461695=await _0xd4a39f[_0x3254fd(0x159)](-0x1a85);_0x461695[_0x3254fd(0x111)]['eql'](StatusCodes[_0x3254fd(0x13f)]);}),it(_0x3f5dfb(0x147),async()=>{const _0x3fdb29=_0x3f5dfb;_0xd4a39f=_0x3eb7a3[_0x3fdb29(0x11e)](),_0xd4a39f['currentSubscriptionCount'][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x0),_0xd4a39f[_0x3fdb29(0x15c)][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x0);const _0x5d7311=_0xd4a39f[_0x3fdb29(0x122)]({'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0xa,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe});_0x5d7311[_0x3fdb29(0x16b)][_0x3fdb29(0x111)]['eql'](0x0),_0xd4a39f[_0x3fdb29(0x133)][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x1),_0xd4a39f[_0x3fdb29(0x15c)][_0x3fdb29(0x111)]['equal'](0x1),_0xd4a39f[_0x3fdb29(0x120)](_0x5d7311['id'])[_0x3fdb29(0x111)]['equal'](_0x5d7311);const _0x12e35e=await _0xd4a39f[_0x3fdb29(0x159)](_0x5d7311['id']);_0x12e35e[_0x3fdb29(0x111)][_0x3fdb29(0x102)](StatusCodes[_0x3fdb29(0x124)]),_0xd4a39f[_0x3fdb29(0x133)][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x0),_0xd4a39f['cumulatedSubscriptionCount'][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x1),_0x3eb7a3['currentSubscriptionCount'][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x0),_0x3eb7a3[_0x3fdb29(0x15c)][_0x3fdb29(0x111)][_0x3fdb29(0x137)](0x1),_0x5d7311['terminate'](),_0x5d7311[_0x3fdb29(0x155)]();}),_0x206839[_0x3f5dfb(0x149)](it,_0x206839[_0x3f5dfb(0x131)],async()=>{const _0x11b9e8=_0x3f5dfb;_0xd4a39f=_0x3eb7a3['createSession'](),_0xd4a39f[_0x11b9e8(0x133)]['should']['equal'](0x0),_0xd4a39f[_0x11b9e8(0x15c)][_0x11b9e8(0x111)][_0x11b9e8(0x137)](0x0);const _0x292a10=sinon['spy'](),_0x5d84d5=sinon[_0x11b9e8(0x163)]();_0xd4a39f['on']('new_subscription',_0x292a10),_0xd4a39f['on'](_0x11b9e8(0x101),_0x5d84d5);const _0x470b35=_0xd4a39f[_0x11b9e8(0x122)]({'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0xa,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe});_0xd4a39f[_0x11b9e8(0x133)][_0x11b9e8(0x111)][_0x11b9e8(0x137)](0x1),_0xd4a39f[_0x11b9e8(0x15c)][_0x11b9e8(0x111)][_0x11b9e8(0x137)](0x1),_0x292a10['callCount']['should'][_0x11b9e8(0x102)](0x1),_0x5d84d5[_0x11b9e8(0x11f)]['should'][_0x11b9e8(0x102)](0x0);const _0x3ec03e=await _0xd4a39f[_0x11b9e8(0x159)](_0x470b35['id']);_0x3ec03e[_0x11b9e8(0x111)]['be'][_0x11b9e8(0x12f)](StatusCode),_0x292a10[_0x11b9e8(0x11f)]['should'][_0x11b9e8(0x102)](0x1),_0x5d84d5[_0x11b9e8(0x11f)][_0x11b9e8(0x111)]['eql'](0x1),_0xd4a39f['removeListener'](_0x206839['pKQtR'],_0x292a10),_0xd4a39f[_0x11b9e8(0x11b)](_0x11b9e8(0x101),_0x5d84d5),_0xd4a39f[_0x11b9e8(0x133)][_0x11b9e8(0x111)][_0x11b9e8(0x137)](0x0),_0xd4a39f[_0x11b9e8(0x15c)][_0x11b9e8(0x111)][_0x11b9e8(0x137)](0x1);}),_0x206839[_0x3f5dfb(0x149)](it,_0x206839[_0x3f5dfb(0x14b)],async()=>{const _0x38f437=_0x3f5dfb;_0xd4a39f=_0x3eb7a3[_0x38f437(0x11e)]();const _0x311b61={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0xa,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe};_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)]['equal'](0x0),_0x3eb7a3[_0x38f437(0x15c)][_0x38f437(0x111)][_0x38f437(0x137)](0x0),_0x3eb7a3['currentSessionCount']['should'][_0x38f437(0x137)](0x1),_0x3eb7a3[_0x38f437(0x158)][_0x38f437(0x111)][_0x38f437(0x137)](0x1);const _0x4061cc=_0xd4a39f[_0x38f437(0x122)](_0x311b61);_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)]['equal'](0x1),_0x3eb7a3[_0x38f437(0x15c)][_0x38f437(0x111)][_0x38f437(0x137)](0x1);const _0x4ce969=_0xd4a39f['createSubscription'](_0x311b61);_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)][_0x38f437(0x137)](0x2),_0x3eb7a3[_0x38f437(0x15c)][_0x38f437(0x111)][_0x38f437(0x137)](0x2),await _0xd4a39f[_0x38f437(0x159)](_0x4ce969['id']),_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)][_0x38f437(0x137)](0x1),_0x3eb7a3['cumulatedSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x2);const _0x1df62c=_0x3eb7a3[_0x38f437(0x11e)]();_0x3eb7a3[_0x38f437(0x134)][_0x38f437(0x111)]['equal'](0x2),_0x3eb7a3[_0x38f437(0x158)][_0x38f437(0x111)][_0x38f437(0x137)](0x2),_0x3eb7a3['currentSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x1);const _0x18418c=_0x1df62c[_0x38f437(0x122)](_0x311b61),_0x5777c5=_0x1df62c[_0x38f437(0x122)](_0x311b61),_0x4caed1=_0x1df62c['createSubscription'](_0x311b61);_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)][_0x38f437(0x137)](0x4),_0x3eb7a3['cumulatedSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x5),await _0x3eb7a3[_0x38f437(0x11d)](_0x1df62c[_0x38f437(0x165)],!![]),_0x3eb7a3[_0x38f437(0x134)][_0x38f437(0x111)][_0x38f437(0x137)](0x1),_0x3eb7a3[_0x38f437(0x158)]['should'][_0x38f437(0x137)](0x2),_0x3eb7a3['currentSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x1),_0x3eb7a3['cumulatedSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x5),await _0xd4a39f['deleteSubscription'](_0x4061cc['id']),_0x3eb7a3[_0x38f437(0x133)][_0x38f437(0x111)][_0x38f437(0x137)](0x0),_0x3eb7a3['cumulatedSubscriptionCount'][_0x38f437(0x111)][_0x38f437(0x137)](0x5);}),_0x206839[_0x3f5dfb(0x149)](it,_0x3f5dfb(0x13d),async()=>{const _0x502026=_0x3f5dfb;_0xd4a39f=_0x3eb7a3[_0x502026(0x11e)]();const _0x22202a={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0xa,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe},_0x94d51=_0xd4a39f[_0x502026(0x122)](_0x22202a),_0x4cd94e=sinon[_0x502026(0x163)](),_0x2908cc={'requestHeader':{'requestHandle':0x64}};_0xd4a39f[_0x502026(0x150)][_0x502026(0x119)](new PublishRequest(_0x2908cc),_0x4cd94e);const _0x201cad={'requestHeader':{'requestHandle':0x65}};_0xd4a39f[_0x502026(0x150)]['_on_PublishRequest'](new PublishRequest(_0x201cad),_0x4cd94e),_0x4cd94e[_0x502026(0x11f)][_0x502026(0x111)][_0x502026(0x102)](0x0),await _0xd4a39f[_0x502026(0x159)](_0x94d51['id']),_0x4cd94e[_0x502026(0x11f)]['should'][_0x502026(0x102)](0x2),_0x4cd94e[_0x502026(0x15d)](0x0)['args'][0x1][_0x502026(0x103)][_0x502026(0x116)][_0x502026(0x111)][_0x502026(0x102)](0x64),_0x4cd94e[_0x502026(0x15d)](0x1)[_0x502026(0x118)][0x1][_0x502026(0x103)]['requestHandle'][_0x502026(0x111)][_0x502026(0x102)](0x65),_0x4cd94e[_0x502026(0x15d)](0x0)['args'][0x1][_0x502026(0x103)]['serviceResult'][_0x502026(0x111)]['eql'](StatusCodes[_0x502026(0x13c)]),_0x4cd94e[_0x502026(0x15d)](0x1)[_0x502026(0x118)][0x1][_0x502026(0x103)]['serviceResult'][_0x502026(0x111)][_0x502026(0x102)](StatusCodes[_0x502026(0x13c)]);}),it('ZDZ-1\x20create\x20and\x20terminate\x202\x20subscriptions\x20,\x20with\x204\x20publish\x20requests',async()=>{const _0x46d2df=_0x3f5dfb;await with_fake_timer[_0x46d2df(0x12d)](_0x8dad0a,async()=>{const _0x8b8c95=_0x46d2df;_0xd4a39f=_0x3eb7a3[_0x8b8c95(0x11e)]({'sessionTimeout':0x5f5e100});const _0xeac02e={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0x3c,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe},_0x1add94=_0xd4a39f['createSubscription'](_0xeac02e);_0x1add94[_0x8b8c95(0x153)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x140)]),_0x8dad0a[_0x8b8c95(0x12e)][_0x8b8c95(0x10c)](_0x1add94[_0x8b8c95(0x15e)]),_0x1add94[_0x8b8c95(0x153)][_0x8b8c95(0x111)]['eql'](SubscriptionState[_0x8b8c95(0x140)]),_0x1add94[_0x8b8c95(0x10b)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](![]),await _0xd4a39f['deleteSubscription'](_0x1add94['id']),_0x1add94[_0x8b8c95(0x153)]['should'][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x145)]);const _0x24cd38=_0xd4a39f[_0x8b8c95(0x122)](_0xeac02e);_0x24cd38[_0x8b8c95(0x153)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x140)]),_0x8dad0a[_0x8b8c95(0x12e)][_0x8b8c95(0x10c)](_0x206839[_0x8b8c95(0x12a)](_0x24cd38[_0x8b8c95(0x15e)],_0x24cd38[_0x8b8c95(0x110)])),_0x24cd38[_0x8b8c95(0x153)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x105)]);const _0xad80d0=sinon[_0x8b8c95(0x163)]();_0xd4a39f[_0x8b8c95(0x150)][_0x8b8c95(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x64}}),_0xad80d0),_0xd4a39f['publishEngine'][_0x8b8c95(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x65}}),_0xad80d0),_0xd4a39f['publishEngine']['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x66}}),_0xad80d0),_0xd4a39f['publishEngine'][_0x8b8c95(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x67}}),_0xad80d0),_0x8dad0a[_0x8b8c95(0x12e)][_0x8b8c95(0x10c)](_0x24cd38[_0x8b8c95(0x15e)]),_0x24cd38['state']['should'][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x108)]),await _0xd4a39f[_0x8b8c95(0x159)](_0x24cd38['id']),_0x24cd38[_0x8b8c95(0x153)]['should'][_0x8b8c95(0x102)](SubscriptionState[_0x8b8c95(0x145)]),_0xad80d0['callCount'][_0x8b8c95(0x111)][_0x8b8c95(0x102)](0x4),_0xad80d0[_0x8b8c95(0x15d)](0x0)[_0x8b8c95(0x118)][0x1][_0x8b8c95(0x103)][_0x8b8c95(0x115)][_0x8b8c95(0x111)]['eql'](StatusCodes[_0x8b8c95(0x124)]),_0xad80d0[_0x8b8c95(0x15d)](0x0)['args'][0x1][_0x8b8c95(0x10d)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](_0x24cd38['id']),_0xad80d0[_0x8b8c95(0x15d)](0x0)[_0x8b8c95(0x118)][0x1][_0x8b8c95(0x15f)][_0x8b8c95(0x154)][_0x8b8c95(0x164)][_0x8b8c95(0x111)][_0x8b8c95(0x102)](0x0),_0xad80d0[_0x8b8c95(0x15d)](0x1)[_0x8b8c95(0x118)][0x1][_0x8b8c95(0x103)]['serviceResult'][_0x8b8c95(0x111)][_0x8b8c95(0x102)](StatusCodes[_0x8b8c95(0x13c)]),_0xad80d0[_0x8b8c95(0x15d)](0x2)[_0x8b8c95(0x118)][0x1]['responseHeader']['serviceResult']['should'][_0x8b8c95(0x102)](StatusCodes[_0x8b8c95(0x13c)]),_0xad80d0[_0x8b8c95(0x15d)](0x3)[_0x8b8c95(0x118)][0x1][_0x8b8c95(0x103)]['serviceResult']['should'][_0x8b8c95(0x102)](StatusCodes[_0x8b8c95(0x13c)]),await _0x3eb7a3['closeSession'](_0xd4a39f['authenticationToken'],!![],_0x8b8c95(0x14e));});}),it(_0x3f5dfb(0x146),async()=>{const _0x16466b=_0x3f5dfb,_0x2a9c90={'gJfEl':function(_0x4ff580,_0x1795f4){return _0x4ff580*_0x1795f4;},'IPwBo':function(_0x254fc9,_0x46840c){return _0x206839['dAgGo'](_0x254fc9,_0x46840c);},'iZvom':_0x206839[_0x16466b(0x143)]};await with_fake_timer[_0x16466b(0x12d)](_0x8dad0a,async()=>{const _0x1cf94d=_0x16466b;_0xd4a39f=_0x3eb7a3[_0x1cf94d(0x11e)]({'sessionTimeout':0x5f5e100});const _0x53f29f={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0x3c,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe},_0x384246=_0xd4a39f[_0x1cf94d(0x122)](_0x53f29f);_0x384246['publishingInterval'][_0x1cf94d(0x111)][_0x1cf94d(0x102)](0x3e8),_0x384246['maxKeepAliveCount'][_0x1cf94d(0x111)][_0x1cf94d(0x102)](0xa),_0x384246[_0x1cf94d(0x136)][_0x1cf94d(0x111)]['eql'](0x3c),_0x384246[_0x1cf94d(0x153)]['should'][_0x1cf94d(0x102)](SubscriptionState[_0x1cf94d(0x140)]),_0x8dad0a[_0x1cf94d(0x12e)][_0x1cf94d(0x10c)](_0x384246['publishingInterval']),_0x384246['state']['should'][_0x1cf94d(0x102)](SubscriptionState[_0x1cf94d(0x140)]),_0x8dad0a[_0x1cf94d(0x12e)][_0x1cf94d(0x10c)](_0x384246[_0x1cf94d(0x15e)]*_0x384246[_0x1cf94d(0x110)]),_0x384246[_0x1cf94d(0x153)]['should']['eql'](SubscriptionState[_0x1cf94d(0x105)]),_0x8dad0a[_0x1cf94d(0x12e)]['tick'](_0x384246['publishingInterval']*_0x384246['maxKeepAliveCount']),_0x384246[_0x1cf94d(0x153)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](SubscriptionState[_0x1cf94d(0x105)]),_0x8dad0a[_0x1cf94d(0x12e)][_0x1cf94d(0x10c)](_0x2a9c90[_0x1cf94d(0x107)](_0x384246[_0x1cf94d(0x15e)],_0x384246[_0x1cf94d(0x136)])),_0x384246['state'][_0x1cf94d(0x111)][_0x1cf94d(0x102)](SubscriptionState['CLOSED']);const _0x21bfaf=_0xd4a39f['createSubscription'](_0x53f29f);_0x21bfaf[_0x1cf94d(0x153)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](SubscriptionState[_0x1cf94d(0x140)]),_0x8dad0a[_0x1cf94d(0x12e)]['tick'](_0x2a9c90[_0x1cf94d(0x104)](_0x21bfaf[_0x1cf94d(0x15e)],_0x21bfaf['maxKeepAliveCount'])),_0x21bfaf[_0x1cf94d(0x153)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](SubscriptionState[_0x1cf94d(0x105)]);const _0x51f977=sinon[_0x1cf94d(0x163)]();_0xd4a39f[_0x1cf94d(0x150)][_0x1cf94d(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x65}}),_0x51f977),_0xd4a39f['publishEngine']['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x66}}),_0x51f977),_0xd4a39f[_0x1cf94d(0x150)][_0x1cf94d(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x67}}),_0x51f977),_0xd4a39f[_0x1cf94d(0x150)]['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x68}}),_0x51f977),_0x8dad0a[_0x1cf94d(0x12e)][_0x1cf94d(0x10c)](_0x21bfaf[_0x1cf94d(0x15e)]),await _0xd4a39f[_0x1cf94d(0x159)](_0x21bfaf['id']),_0x8dad0a[_0x1cf94d(0x12e)][_0x1cf94d(0x10c)](_0x21bfaf[_0x1cf94d(0x15e)]),_0x51f977[_0x1cf94d(0x11f)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](0x4),_0x51f977['getCall'](0x0)['args'][0x1][_0x1cf94d(0x103)][_0x1cf94d(0x115)][_0x1cf94d(0x111)]['eql'](StatusCodes[_0x1cf94d(0x124)]),_0x51f977[_0x1cf94d(0x15d)](0x0)['args'][0x1][_0x1cf94d(0x10d)]['should'][_0x1cf94d(0x102)](_0x384246['id']),_0x51f977[_0x1cf94d(0x15d)](0x0)['args'][0x1][_0x1cf94d(0x15f)][_0x1cf94d(0x154)][0x0][_0x1cf94d(0x126)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](StatusCodes[_0x1cf94d(0x169)]),_0x51f977[_0x1cf94d(0x15d)](0x1)[_0x1cf94d(0x118)][0x1][_0x1cf94d(0x103)][_0x1cf94d(0x115)][_0x1cf94d(0x111)]['eql'](StatusCodes[_0x1cf94d(0x124)]),_0x51f977[_0x1cf94d(0x15d)](0x1)['args'][0x1][_0x1cf94d(0x10d)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](_0x21bfaf['id']),_0x51f977['getCall'](0x1)['args'][0x1][_0x1cf94d(0x15f)][_0x1cf94d(0x154)][_0x1cf94d(0x164)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](0x0),_0x51f977[_0x1cf94d(0x15d)](0x2)['args'][0x1][_0x1cf94d(0x103)][_0x1cf94d(0x115)][_0x1cf94d(0x111)]['eql'](StatusCodes['BadNoSubscription']),_0x51f977[_0x1cf94d(0x15d)](0x3)[_0x1cf94d(0x118)][0x1]['responseHeader'][_0x1cf94d(0x115)][_0x1cf94d(0x111)][_0x1cf94d(0x102)](StatusCodes['BadNoSubscription']),await _0x3eb7a3[_0x1cf94d(0x11d)](_0xd4a39f['authenticationToken'],!![],_0x2a9c90[_0x1cf94d(0x13a)]);});}),_0x206839[_0x3f5dfb(0x166)](it,_0x3f5dfb(0x16e),async()=>{const _0x43f908=_0x3f5dfb,_0x4a50c7={'ZHgAu':function(_0x45a466,_0xc6d80c){return _0x45a466*_0xc6d80c;},'rnSLs':_0x43f908(0x161),'nOfNi':_0x206839[_0x43f908(0x143)]};await with_fake_timer['call'](_0x8dad0a,async()=>{const _0x5ca9fe=_0x43f908;_0xd4a39f=_0x3eb7a3['createSession']({'sessionTimeout':0x5f5e100});const _0x58b596={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0x3c,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe},_0xc3da64=_0xd4a39f[_0x5ca9fe(0x122)](_0x58b596);_0xc3da64[_0x5ca9fe(0x153)][_0x5ca9fe(0x111)]['eql'](SubscriptionState[_0x5ca9fe(0x140)]),_0x8dad0a['clock'][_0x5ca9fe(0x10c)](_0x4a50c7[_0x5ca9fe(0xff)](_0xc3da64[_0x5ca9fe(0x15e)],_0xc3da64[_0x5ca9fe(0x110)])),_0x8dad0a[_0x5ca9fe(0x12e)][_0x5ca9fe(0x10c)](_0xc3da64[_0x5ca9fe(0x15e)]*_0xc3da64[_0x5ca9fe(0x136)]),_0xc3da64[_0x5ca9fe(0x153)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](SubscriptionState[_0x5ca9fe(0x145)]),_0xc3da64['messageSent'][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](![]);const _0x488263=sinon['spy']();_0xd4a39f['publishEngine'][_0x5ca9fe(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x65}}),_0x488263),_0xd4a39f[_0x5ca9fe(0x150)]['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x66}}),_0x488263),_0xd4a39f[_0x5ca9fe(0x150)][_0x5ca9fe(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x67}}),_0x488263),_0xd4a39f[_0x5ca9fe(0x150)][_0x5ca9fe(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x68}}),_0x488263),_0x8dad0a[_0x5ca9fe(0x12e)][_0x5ca9fe(0x10c)](_0x4a50c7[_0x5ca9fe(0xff)](_0xc3da64[_0x5ca9fe(0x15e)],0x2)),_0x488263['getCall'](0x0)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x10d)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](_0xc3da64[_0x5ca9fe(0x10d)]),_0x488263[_0x5ca9fe(0x15d)](0x0)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x103)][_0x5ca9fe(0x115)]['should'][_0x5ca9fe(0x102)](StatusCodes['Good']),_0x488263['getCall'](0x0)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x15f)][_0x5ca9fe(0x16d)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x1),_0x488263[_0x5ca9fe(0x15d)](0x0)['args'][0x1][_0x5ca9fe(0x15f)][_0x5ca9fe(0x154)][0x0][_0x5ca9fe(0x121)][_0x5ca9fe(0x148)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](_0x4a50c7[_0x5ca9fe(0x13b)]),_0x488263['getCall'](0x0)['args'][0x1][_0x5ca9fe(0x15f)]['notificationData'][0x0][_0x5ca9fe(0x126)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](StatusCodes[_0x5ca9fe(0x169)]),_0x488263[_0x5ca9fe(0x11f)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x4),_0x488263[_0x5ca9fe(0x15d)](0x1)['args'][0x1][_0x5ca9fe(0x103)][_0x5ca9fe(0x115)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](StatusCodes['BadNoSubscription']),_0x488263[_0x5ca9fe(0x15d)](0x1)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x10d)][_0x5ca9fe(0x111)]['eql'](0xffffffff),_0x488263[_0x5ca9fe(0x15d)](0x1)[_0x5ca9fe(0x118)][0x1]['notificationMessage'][_0x5ca9fe(0x16d)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x0),_0x488263[_0x5ca9fe(0x15d)](0x1)[_0x5ca9fe(0x118)][0x1]['notificationMessage']['notificationData'][_0x5ca9fe(0x164)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x0),_0x488263[_0x5ca9fe(0x15d)](0x2)[_0x5ca9fe(0x118)][0x1]['responseHeader'][_0x5ca9fe(0x115)][_0x5ca9fe(0x111)]['eql'](StatusCodes['BadNoSubscription']),_0x488263[_0x5ca9fe(0x15d)](0x2)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x10d)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0xffffffff),_0x488263[_0x5ca9fe(0x15d)](0x2)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x15f)][_0x5ca9fe(0x16d)][_0x5ca9fe(0x111)]['eql'](0x0),_0x488263[_0x5ca9fe(0x15d)](0x2)['args'][0x1][_0x5ca9fe(0x15f)][_0x5ca9fe(0x154)][_0x5ca9fe(0x164)][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x0),_0x488263[_0x5ca9fe(0x15d)](0x3)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x103)][_0x5ca9fe(0x115)]['should'][_0x5ca9fe(0x102)](StatusCodes[_0x5ca9fe(0x13c)]),_0x488263['getCall'](0x3)['args'][0x1][_0x5ca9fe(0x10d)][_0x5ca9fe(0x111)]['eql'](0xffffffff),_0x488263[_0x5ca9fe(0x15d)](0x3)[_0x5ca9fe(0x118)][0x1][_0x5ca9fe(0x15f)]['sequenceNumber'][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x0),_0x488263[_0x5ca9fe(0x15d)](0x3)[_0x5ca9fe(0x118)][0x1]['notificationMessage']['notificationData']['length'][_0x5ca9fe(0x111)][_0x5ca9fe(0x102)](0x0),await _0x3eb7a3[_0x5ca9fe(0x11d)](_0xd4a39f[_0x5ca9fe(0x165)],!![],_0x4a50c7['nOfNi']);});}),_0x206839['wPnZw'](it,_0x206839[_0x3f5dfb(0x10a)],async()=>{const _0x3c79bb=_0x3f5dfb,_0xcefa41={'Zzetr':function(_0x438728,_0x16caf1){return _0x438728*_0x16caf1;},'XFdLK':function(_0x50b508,_0x411cd5){return _0x50b508*_0x411cd5;},'sXqoJ':_0x206839[_0x3c79bb(0x144)]};await with_fake_timer['call'](_0x8dad0a,async()=>{const _0x5061c8=_0x3c79bb;_0xd4a39f=_0x3eb7a3['createSession']({'sessionTimeout':0x5f5e100});const _0x4816c9={'requestedPublishingInterval':0x3e8,'requestedLifetimeCount':0x3c,'requestedMaxKeepAliveCount':0xa,'maxNotificationsPerPublish':0xa,'publishingEnabled':!![],'priority':0xe},_0x134104=_0xd4a39f[_0x5061c8(0x122)](_0x4816c9);_0x134104[_0x5061c8(0x153)][_0x5061c8(0x111)][_0x5061c8(0x102)](SubscriptionState[_0x5061c8(0x140)]),_0x8dad0a[_0x5061c8(0x12e)]['tick'](_0xcefa41[_0x5061c8(0x123)](_0x134104['publishingInterval'],_0x134104[_0x5061c8(0x110)])),_0x8dad0a['clock'][_0x5061c8(0x10c)](_0xcefa41[_0x5061c8(0x12c)](_0x134104[_0x5061c8(0x15e)],_0x134104['lifeTimeCount']));const _0x12fb0b=_0xd4a39f['createSubscription'](_0x4816c9);_0x12fb0b[_0x5061c8(0x153)][_0x5061c8(0x111)][_0x5061c8(0x102)](SubscriptionState[_0x5061c8(0x140)]);const _0x1e7cf7=sinon[_0x5061c8(0x163)]();_0xd4a39f[_0x5061c8(0x150)]['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x65}}),_0x1e7cf7),_0xd4a39f[_0x5061c8(0x150)]['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x66}}),_0x1e7cf7),_0xd4a39f['publishEngine']['_on_PublishRequest'](new PublishRequest({'requestHeader':{'requestHandle':0x67}}),_0x1e7cf7),_0xd4a39f[_0x5061c8(0x150)][_0x5061c8(0x119)](new PublishRequest({'requestHeader':{'requestHandle':0x68}}),_0x1e7cf7),_0x1e7cf7[_0x5061c8(0x11f)]['should'][_0x5061c8(0x102)](0x1),_0x1e7cf7[_0x5061c8(0x15d)](0x0)[_0x5061c8(0x118)][0x1][_0x5061c8(0x103)][_0x5061c8(0x115)]['should'][_0x5061c8(0x102)](StatusCodes[_0x5061c8(0x124)]),_0x1e7cf7[_0x5061c8(0x15d)](0x0)[_0x5061c8(0x118)][0x1][_0x5061c8(0x15f)][_0x5061c8(0x16d)][_0x5061c8(0x111)]['eql'](0x1),_0x1e7cf7['getCall'](0x0)[_0x5061c8(0x118)][0x1][_0x5061c8(0x15f)][_0x5061c8(0x154)][0x0][_0x5061c8(0x121)][_0x5061c8(0x148)][_0x5061c8(0x111)][_0x5061c8(0x102)](_0xcefa41['sXqoJ']),_0x1e7cf7[_0x5061c8(0x15d)](0x0)[_0x5061c8(0x118)][0x1]['notificationMessage'][_0x5061c8(0x154)][0x0][_0x5061c8(0x126)][_0x5061c8(0x111)]['eql'](StatusCodes[_0x5061c8(0x169)]),await _0x3eb7a3[_0x5061c8(0x11d)](_0xd4a39f[_0x5061c8(0x165)],!![],'CloseSession');});}),_0x206839[_0x3f5dfb(0x15a)](it,_0x3f5dfb(0x114),async()=>{const _0x247a07=_0x3f5dfb,_0x2042a3={'ulgCr':_0x206839['FiLLj'],'ZBxOt':_0x206839[_0x247a07(0x160)],'KtRQL':function(_0x155103,_0x4a7a5d){return _0x206839['QfEua'](_0x155103,_0x4a7a5d);}};await with_fake_timer[_0x247a07(0x12d)](_0x8dad0a,async()=>{const _0x4fabe1=_0x247a07;_0xd4a39f=_0x3eb7a3[_0x4fabe1(0x11e)]({'sessionTimeout':0x5f5e100});const _0x3510dc={'requestedPublishingInterval':0x64,'requestedLifetimeCount':0x3c,'requestedMaxKeepAliveCount':0x1e,'maxNotificationsPerPublish':0x3e8,'publishingEnabled':!![],'priority':0xe},_0x214007=_0xd4a39f[_0x4fabe1(0x122)](_0x3510dc);_0x214007[_0x4fabe1(0x153)][_0x4fabe1(0x111)][_0x4fabe1(0x102)](SubscriptionState[_0x4fabe1(0x140)]),_0x214007['on'](_0x2042a3[_0x4fabe1(0x130)],function(_0x3b1d4b){const _0x71c2c6=_0x4fabe1;_0x3b1d4b[_0x71c2c6(0x16c)]=function(){};});const _0x415eec=new MonitoredItemCreateRequest({'itemToMonitor':{'nodeId':_0x2042a3[_0x4fabe1(0x10f)]},'monitoringMode':MonitoringMode[_0x4fabe1(0x117)],'requestedParameters':{'clientHandle':0x7b,'queueSize':0xa,'samplingInterval':0x64}}),_0xf80503=_0x214007[_0x4fabe1(0x12b)](_0x3eb7a3['addressSpace'],TimestampsToReturn[_0x4fabe1(0x132)],_0x415eec);_0xf80503[_0x4fabe1(0x11a)][_0x4fabe1(0x111)]['eql'](StatusCodes['Good']);const _0x483b2c=![];_0x3eb7a3[_0x4fabe1(0x11d)](_0xd4a39f[_0x4fabe1(0x165)],_0x483b2c,_0x4fabe1(0x14e)),_0x8dad0a[_0x4fabe1(0x12e)][_0x4fabe1(0x10c)](_0x2042a3['KtRQL'](_0x214007[_0x4fabe1(0x15e)],_0x214007['maxKeepAliveCount'])),_0x8dad0a[_0x4fabe1(0x12e)]['tick'](_0x2042a3[_0x4fabe1(0x168)](_0x214007['publishingInterval'],_0x214007[_0x4fabe1(0x136)]));});});});