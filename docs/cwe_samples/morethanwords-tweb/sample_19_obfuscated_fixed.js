const _0x72a7e8=_0xe4df;(function(_0x53739c,_0x32dd25){const _0x5d8cd0=_0xe4df,_0x30e03e=_0x53739c();while(!![]){try{const _0x329080=parseInt(_0x5d8cd0(0xb7))/0x1*(-parseInt(_0x5d8cd0(0xcb))/0x2)+parseInt(_0x5d8cd0(0xe0))/0x3+parseInt(_0x5d8cd0(0xb5))/0x4*(-parseInt(_0x5d8cd0(0xe9))/0x5)+parseInt(_0x5d8cd0(0xca))/0x6*(parseInt(_0x5d8cd0(0xb1))/0x7)+parseInt(_0x5d8cd0(0xcc))/0x8*(parseInt(_0x5d8cd0(0xe7))/0x9)+parseInt(_0x5d8cd0(0xb2))/0xa+-parseInt(_0x5d8cd0(0xe5))/0xb;if(_0x329080===_0x32dd25)break;else _0x30e03e['push'](_0x30e03e['shift']());}catch(_0x45f19f){_0x30e03e['push'](_0x30e03e['shift']());}}}(_0x4728,0x7a74c));const prisma=require(_0x72a7e8(0xb6)),{EventLogs}=require(_0x72a7e8(0xc9)),User={'writable':['username',_0x72a7e8(0xb3),_0x72a7e8(0xc1),_0x72a7e8(0xc3),_0x72a7e8(0xd8)],'castColumnValue':function(_0x261715,_0x1c7f2b){const _0x32b1c6={'nLFXZ':function(_0x12cc80,_0xeb0c5d){return _0x12cc80(_0xeb0c5d);}};switch(_0x261715){case'suspended':return _0x32b1c6['nLFXZ'](Number,Boolean(_0x1c7f2b));default:return String(_0x1c7f2b);}},'filterFields':function(_0x428611={}){const {password:_0x376d64,..._0x15decd}=_0x428611;return{..._0x15decd};},'create':async function({username:_0x259951,password:_0x5869b5,role:role='default'}){const _0x186b26=_0x72a7e8,_0x4c17b0={'RwMLj':_0x186b26(0xd9)},_0x225a3f=this[_0x186b26(0xd6)](_0x5869b5);if(!_0x225a3f[_0x186b26(0xbd)])return{'user':null,'error':_0x225a3f['error']};try{const _0x540821=require(_0x4c17b0['RwMLj']),_0x16fed7=_0x540821['hashSync'](_0x5869b5,0xa),_0x5736ad=await prisma[_0x186b26(0xc4)][_0x186b26(0xed)]({'data':{'username':_0x259951,'password':_0x16fed7,'role':role}});return{'user':this['filterFields'](_0x5736ad),'error':null};}catch(_0x4338a7){return console[_0x186b26(0xd4)](_0x186b26(0xda),_0x4338a7[_0x186b26(0xbf)]),{'user':null,'error':_0x4338a7['message']};}},'loggedChanges':function(_0x5332f1,_0x1bcabf={}){const _0x5c0827=_0x72a7e8,_0x352ada={'YSuHH':function(_0x1c86b1,_0x4dfd8b){return _0x1c86b1!==_0x4dfd8b;}},_0x876d4c={},_0x3e2b7d=[_0x5c0827(0xb3)];return Object[_0x5c0827(0xb9)](_0x5332f1)[_0x5c0827(0xdd)](_0x4faf9f=>{const _0x31e8d5=_0x5c0827;!_0x3e2b7d['includes'](_0x4faf9f)&&_0x352ada[_0x31e8d5(0xaf)](_0x5332f1[_0x4faf9f],_0x1bcabf[_0x4faf9f])&&(_0x876d4c[_0x4faf9f]=_0x1bcabf[_0x4faf9f]+_0x31e8d5(0xc8)+_0x5332f1[_0x4faf9f]);}),_0x876d4c;},'update':async function(_0x15f23e,_0x596802={}){const _0x1d23e7=_0x72a7e8,_0x4eb4c4={'VUdPH':_0x1d23e7(0xb3),'pNAyR':_0x1d23e7(0xd9),'gUptf':function(_0x221db8,_0x2ce36e){return _0x221db8(_0x2ce36e);}};try{if(!_0x15f23e)throw new Error(_0x1d23e7(0xd2));const _0x355e61=await prisma[_0x1d23e7(0xc4)][_0x1d23e7(0xbc)]({'where':{'id':parseInt(_0x15f23e)}});if(!_0x355e61)return{'success':![],'error':_0x1d23e7(0xef)};Object[_0x1d23e7(0xec)](_0x596802)[_0x1d23e7(0xdd)](([_0x3b0c03,_0x245c53])=>{const _0x1dde40=_0x1d23e7;if(this[_0x1dde40(0xb0)][_0x1dde40(0xb4)](_0x3b0c03)){_0x596802[_0x3b0c03]=this[_0x1dde40(0xc7)](_0x3b0c03,_0x245c53);return;}delete _0x596802[_0x3b0c03];});if(Object[_0x1d23e7(0xb9)](_0x596802)[_0x1d23e7(0xeb)]===0x0)return{'success':![],'error':'No\x20valid\x20updates\x20applied.'};if(_0x596802['hasOwnProperty'](_0x4eb4c4[_0x1d23e7(0xe8)])){const _0x597741=this['checkPasswordComplexity'](_0x596802['password']);if(!_0x597741[_0x1d23e7(0xbd)])return{'success':![],'error':_0x597741[_0x1d23e7(0xd4)]};const _0x5b9e40=require(_0x4eb4c4[_0x1d23e7(0xd1)]);_0x596802[_0x1d23e7(0xb3)]=_0x5b9e40[_0x1d23e7(0xba)](_0x596802[_0x1d23e7(0xb3)],0xa);}const _0x2de78e=await prisma[_0x1d23e7(0xc4)][_0x1d23e7(0xd0)]({'where':{'id':_0x4eb4c4[_0x1d23e7(0xc5)](parseInt,_0x15f23e)},'data':_0x596802});return await EventLogs[_0x1d23e7(0xbb)]('user_updated',{'username':_0x2de78e[_0x1d23e7(0xcd)],'changes':this[_0x1d23e7(0xde)](_0x596802,_0x355e61)},_0x15f23e),{'success':!![],'error':null};}catch(_0x402747){return console[_0x1d23e7(0xd4)](_0x402747[_0x1d23e7(0xbf)]),{'success':![],'error':_0x402747[_0x1d23e7(0xbf)]};}},'_update':async function(_0x419c9a=null,_0x21e325={}){const _0x2c3fb5=_0x72a7e8;if(!_0x419c9a)throw new Error('No\x20user\x20id\x20provided\x20for\x20update');try{const _0x348cac=await prisma[_0x2c3fb5(0xc4)][_0x2c3fb5(0xd0)]({'where':{'id':_0x419c9a},'data':_0x21e325});return{'user':_0x348cac,'message':null};}catch(_0x53b012){return console[_0x2c3fb5(0xd4)](_0x53b012[_0x2c3fb5(0xbf)]),{'user':null,'message':_0x53b012['message']};}},'get':async function(_0x180904={}){const _0x5ed691=_0x72a7e8;try{const _0x3d85b9=await prisma[_0x5ed691(0xc4)][_0x5ed691(0xdb)]({'where':_0x180904});return _0x3d85b9?this['filterFields']({..._0x3d85b9}):null;}catch(_0x436acf){return console[_0x5ed691(0xd4)](_0x436acf[_0x5ed691(0xbf)]),null;}},'_get':async function(_0x245671={}){const _0x3fb854=_0x72a7e8;try{const _0x21f131=await prisma['users'][_0x3fb854(0xdb)]({'where':_0x245671});return _0x21f131?{..._0x21f131}:null;}catch(_0x5b0e1e){return console['error'](_0x5b0e1e[_0x3fb854(0xbf)]),null;}},'count':async function(_0x4b146a={}){const _0x5d5b0c=_0x72a7e8;try{const _0x52e91e=await prisma[_0x5d5b0c(0xc4)]['count']({'where':_0x4b146a});return _0x52e91e;}catch(_0x5cceb8){return console[_0x5d5b0c(0xd4)](_0x5cceb8[_0x5d5b0c(0xbf)]),0x0;}},'delete':async function(_0x6eb307={}){const _0xaa156a=_0x72a7e8;try{return await prisma['users'][_0xaa156a(0xbe)]({'where':_0x6eb307}),!![];}catch(_0x564a6d){return console['error'](_0x564a6d['message']),![];}},'where':async function(_0x31fe13={},_0x5bf7b1=null){const _0x566527=_0x72a7e8,_0x10ad9c={'pVCrO':function(_0x1d0b9e,_0x376125){return _0x1d0b9e!==_0x376125;}};try{const _0x2eef5f=await prisma[_0x566527(0xc4)][_0x566527(0xc2)]({'where':_0x31fe13,..._0x10ad9c[_0x566527(0xe4)](_0x5bf7b1,null)?{'take':_0x5bf7b1}:{}});return _0x2eef5f[_0x566527(0xc0)](_0x5e46e4=>this[_0x566527(0xce)](_0x5e46e4));}catch(_0x137df1){return console[_0x566527(0xd4)](_0x137df1[_0x566527(0xbf)]),[];}},'checkPasswordComplexity':function(_0x101176=''){const _0x2f8a1d=_0x72a7e8,_0x30e6dd={'uBICD':function(_0x5ce10c,_0x3b2596){return _0x5ce10c(_0x3b2596);},'gSRLo':'password','FXRoC':function(_0x55e2ab,_0x2fdfdf){return _0x55e2ab+_0x2fdfdf;}},_0x54dbb6=_0x30e6dd['uBICD'](require,'joi-password-complexity'),_0xeddca0={'min':process[_0x2f8a1d(0xe3)][_0x2f8a1d(0xf0)]||0x8,'max':process['env'][_0x2f8a1d(0xdf)]||0xfa,'lowerCase':process[_0x2f8a1d(0xe3)][_0x2f8a1d(0xe2)]||0x0,'upperCase':process[_0x2f8a1d(0xe3)][_0x2f8a1d(0xcf)]||0x0,'numeric':process[_0x2f8a1d(0xe3)][_0x2f8a1d(0xdc)]||0x0,'symbol':process[_0x2f8a1d(0xe3)][_0x2f8a1d(0xe1)]||0x0,'requirementCount':process['env'][_0x2f8a1d(0xc6)]||0x0},_0x47116e=_0x54dbb6(_0xeddca0,_0x30e6dd[_0x2f8a1d(0xee)])[_0x2f8a1d(0xe6)](_0x101176);if(_0x47116e[_0x2f8a1d(0xd3)](_0x2f8a1d(0xd4))){let _0xa3ff50='',_0xbedfff='';for(let _0x4ce361=0x0;_0x4ce361<_0x47116e[_0x2f8a1d(0xd4)][_0x2f8a1d(0xb8)][_0x2f8a1d(0xeb)];_0x4ce361++){_0xa3ff50+=_0x30e6dd[_0x2f8a1d(0xea)](_0xbedfff,_0x47116e['error'][_0x2f8a1d(0xb8)][_0x4ce361][_0x2f8a1d(0xbf)]),_0xbedfff=',\x20';}return{'checkedOK':![],'error':_0xa3ff50};}return{'checkedOK':!![],'error':_0x2f8a1d(0xd5)};}};function _0xe4df(_0x236513,_0x4d7db5){const _0x4728e7=_0x4728();return _0xe4df=function(_0xe4df3d,_0xc3ae0a){_0xe4df3d=_0xe4df3d-0xaf;let _0x511d9f=_0x4728e7[_0xe4df3d];return _0x511d9f;},_0xe4df(_0x236513,_0x4d7db5);}function _0x4728(){const _0x830e5c=['password','includes','3336988CAVADj','../utils/prisma','417721rSeUwk','details','keys','hashSync','logEvent','findUnique','checkedOK','deleteMany','message','map','pfpFilename','findMany','role','users','gUptf','PASSWORDREQUIREMENTS','castColumnValue','\x20=>\x20','./eventLogs','107664XJvaoe','2rpgnJV','6629032ZwCosp','username','filterFields','PASSWORDUPPERCASE','update','pNAyR','No\x20user\x20id\x20provided\x20for\x20update','hasOwnProperty','error','No\x20error.','checkPasswordComplexity','exports','suspended','bcrypt','FAILED\x20TO\x20CREATE\x20USER.','findFirst','PASSWORDNUMERIC','forEach','loggedChanges','PASSWORDMAXCHAR','2497776bJAaEz','PASSWORDSYMBOL','PASSWORDLOWERCASE','env','pVCrO','17096178klVlOK','validate','9yGcaPr','VUdPH','5OrdAJq','FXRoC','length','entries','create','gSRLo','User\x20not\x20found','PASSWORDMINCHAR','YSuHH','writable','357GMGIBP','7313810wSgXDz'];_0x4728=function(){return _0x830e5c;};return _0x4728();}module[_0x72a7e8(0xd7)]={'User':User};