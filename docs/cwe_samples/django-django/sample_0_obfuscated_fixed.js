const _0x2531d6=_0x2039;(function(_0x14a7e6,_0x252841){const _0x3d07fe=_0x2039,_0x3747ec=_0x14a7e6();while(!![]){try{const _0x46ddac=parseInt(_0x3d07fe(0x231))/0x1*(-parseInt(_0x3d07fe(0x1ef))/0x2)+-parseInt(_0x3d07fe(0x1d4))/0x3*(parseInt(_0x3d07fe(0x226))/0x4)+parseInt(_0x3d07fe(0x1ee))/0x5+parseInt(_0x3d07fe(0x223))/0x6+-parseInt(_0x3d07fe(0x23e))/0x7*(-parseInt(_0x3d07fe(0x24a))/0x8)+parseInt(_0x3d07fe(0x1f2))/0x9+parseInt(_0x3d07fe(0x1de))/0xa*(-parseInt(_0x3d07fe(0x1e8))/0xb);if(_0x46ddac===_0x252841)break;else _0x3747ec['push'](_0x3747ec['shift']());}catch(_0x22018d){_0x3747ec['push'](_0x3747ec['shift']());}}}(_0x5e22,0x5f6cd));function _0x5e22(){const _0x5f17db=['\x22></progress>\x0a\x20\x20\x20\x20\x20\x20</li>','findIndex','input','\x0a\x20\x20\x20\x20\x20\x20<div>','add','map','length','signed_id','uploadFile','children','</ul>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','test','handleButtonClick','saveButton','forEach','1705332mkJChR','uploadItems','aCChn','4604EPNxJf','innerHTML','dropZone','dataset','[data-dialog-title]','hiddenField','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20class=\x22sm\x22\x20type=\x22text\x22\x20value=\x22','querySelector','src','HaYdD','label','149509vTLNLW','textContent','modalTitle','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<span>','from','readAsDataURL','tBHGq','attachmentId','push','button','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','validation_error','kcWIb','2634646ijThuy','trim','error','upload','fBNYL','name','qKVop','ThVpF','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','options','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','items','8aFFuoP','</li>','1680Veweeg','type','bind','autoloadImage','[data-filename=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','createUploadItem','directUploadUrl','[data-filename]','attachmentCounter','184890gwSpjl','\x22]\x20progress','updateAddAttachmentsButton','div','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22\x22\x20alt=\x22','assign','preloadFiles','create','YeCLU','editlabel','154krrrqr','disabled','locales','title','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','setProgressBar','1666345KrlxML','2QgVvHr','qFago','validate','4049163eNKaPt','getOrdinalNumber','nextElementSibling','remove','setAttribute','</div>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','YzkDr','filter','closest','modal','emptyItems','parse','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<ul>','is-disabled','data-attachment-id=\x22','cZHji','ERROR','cancelButton','filename','uploadFiles','updateDropZone','VALIDATED','createElement','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20data-template=\x22','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','error-warning-line','img','value','errors','classList','RgHoH','removeAttribute','QEoap','\x20data-filename=\x22'];_0x5e22=function(){return _0x5f17db;};return _0x5e22();}import{Uploader}from'src/decidim/direct_uploads/redesigned_uploader';function _0x2039(_0x4b8cd2,_0x17dcfb){const _0x5e2236=_0x5e22();return _0x2039=function(_0x2039ae,_0x5b424b){_0x2039ae=_0x2039ae-0x1d3;let _0xf9d4d3=_0x5e2236[_0x2039ae];return _0xf9d4d3;},_0x2039(_0x4b8cd2,_0x17dcfb);}import _0x1b3ea9 from'src/decidim/redesigned_icon';import{truncateFilename}from'src/decidim/direct_uploads/upload_utility';const STATUS={'VALIDATED':'validated','ERROR':_0x2531d6(0x240)};export default class UploadModal{constructor(_0x4d04ef,_0x41a33f={}){const _0x2093b3=_0x2531d6,_0x42e44b={'YeCLU':'button[data-dropzone-cancel]','qFago':_0x2093b3(0x22a),'YzkDr':'[data-dropzone-no-items]'};this[_0x2093b3(0x23a)]=_0x4d04ef;let _0x24e9f2={};try{_0x24e9f2=JSON[_0x2093b3(0x1fd)](_0x4d04ef[_0x2093b3(0x229)][_0x2093b3(0x241)]);}catch(_0x2cae8f){}this[_0x2093b3(0x247)]=Object[_0x2093b3(0x1e3)](_0x24e9f2,_0x41a33f),this[_0x2093b3(0x1fb)]=document['querySelector']('#'+_0x4d04ef['dataset']['dialogOpen']),this['saveButton']=this['modal'][_0x2093b3(0x22d)]('button[data-dropzone-save]'),this[_0x2093b3(0x203)]=this['modal'][_0x2093b3(0x22d)](_0x42e44b[_0x2093b3(0x1e6)]),this[_0x2093b3(0x233)]=this['modal']['querySelector'](_0x42e44b[_0x2093b3(0x1f0)]),this[_0x2093b3(0x228)]=this[_0x2093b3(0x1fb)]['querySelector']('[data-dropzone]'),this[_0x2093b3(0x1fc)]=this['modal'][_0x2093b3(0x22d)](_0x42e44b[_0x2093b3(0x1f8)]),this[_0x2093b3(0x224)]=this[_0x2093b3(0x1fb)]['querySelector']('[data-dropzone-items]'),this[_0x2093b3(0x216)]=this[_0x2093b3(0x228)][_0x2093b3(0x22d)](_0x2093b3(0x216)),this[_0x2093b3(0x249)]=[],this['attachmentCounter']=0x0,this[_0x2093b3(0x1ea)]=JSON[_0x2093b3(0x1fd)](this['uploadItems']['dataset']['locales']),this[_0x2093b3(0x206)]();}[_0x2531d6(0x205)](_0xa1c953){const _0x4e3602=_0x2531d6;if(this[_0x4e3602(0x247)]['multiple'])Array[_0x4e3602(0x235)](_0xa1c953)[_0x4e3602(0x222)](_0x2eaa8f=>this['uploadFile'](_0x2eaa8f));else!this['uploadItems'][_0x4e3602(0x21d)][_0x4e3602(0x21a)]&&this[_0x4e3602(0x21c)](_0xa1c953[0x0]);}[_0x2531d6(0x21c)](_0x51fd6d){const _0x37335e=_0x2531d6,_0x4630ac=new Uploader(this,{'file':_0x51fd6d,'url':this[_0x37335e(0x216)][_0x37335e(0x229)][_0x37335e(0x1db)],'attachmentName':_0x51fd6d[_0x37335e(0x243)]}),_0x21ce1f=this[_0x37335e(0x1da)](_0x51fd6d,_0x4630ac[_0x37335e(0x20e)]);this['uploadItems']['appendChild'](_0x21ce1f),_0x4630ac[_0x37335e(0x20e)][_0x37335e(0x21a)]?this[_0x37335e(0x206)]():_0x4630ac['upload'][_0x37335e(0x1e5)]((_0x3205d1,_0x1ecd52)=>{const _0x770448=_0x37335e;_0x3205d1?_0x4630ac[_0x770448(0x20e)]=[_0x3205d1]:(_0x51fd6d[_0x770448(0x22b)]=_0x1ecd52[_0x770448(0x21b)],_0x4630ac[_0x770448(0x1f1)](_0x1ecd52[_0x770448(0x21b)])['then'](()=>{const _0x458960=_0x770448;_0x4630ac[_0x458960(0x20e)][_0x458960(0x21a)]?this['uploadItems']['replaceChild'](this['createUploadItem'](_0x51fd6d,_0x4630ac[_0x458960(0x20e)],{'value':0x64}),_0x21ce1f):(this['items'][_0x458960(0x239)](_0x51fd6d),this[_0x458960(0x1d7)](_0x21ce1f,_0x51fd6d)),this[_0x458960(0x206)]();}));});}[_0x2531d6(0x1d7)](_0x515d2d,_0x59d17d){const _0x34a48d=_0x2531d6,_0x4e38c2={'QEoap':_0x34a48d(0x20c)};if(!/image/[_0x34a48d(0x21f)](_0x59d17d[_0x34a48d(0x1d5)]))return;const _0x382d02=new FileReader();_0x382d02[_0x34a48d(0x236)](_0x59d17d),_0x382d02['onload']=({target:{result:_0x26e254}})=>{const _0x39f103=_0x34a48d,_0x13e0b9=_0x515d2d[_0x39f103(0x22d)](_0x4e38c2[_0x39f103(0x212)]);_0x13e0b9[_0x39f103(0x22e)]=_0x26e254;};}async[_0x2531d6(0x1e4)](_0x3e698b){const _0x51f824=_0x2531d6,_0x375b8f={'HaYdD':'image'},{src:_0x1c31d7}=_0x3e698b[_0x51f824(0x22d)](_0x51f824(0x20c))||{};let _0x13cd06='',_0x4c6bb3='';_0x1c31d7&&(_0x13cd06=await fetch(_0x1c31d7)['then'](_0x22d89b=>_0x22d89b['arrayBuffer']()),_0x4c6bb3=_0x375b8f[_0x51f824(0x22f)]);const _0x16a162=new File([_0x13cd06],_0x3e698b[_0x51f824(0x229)][_0x51f824(0x204)],{'type':_0x4c6bb3}),_0x49d7f6=this[_0x51f824(0x1da)](_0x16a162,[],{..._0x3e698b[_0x51f824(0x229)],'value':0x64});_0x16a162[_0x51f824(0x238)]=_0x3e698b[_0x51f824(0x229)][_0x51f824(0x238)],this[_0x51f824(0x249)][_0x51f824(0x239)](_0x16a162),this[_0x51f824(0x224)]['appendChild'](_0x49d7f6),this[_0x51f824(0x1d7)](_0x49d7f6,_0x16a162);}[_0x2531d6(0x1f3)](){const _0x4e4c2c=_0x2531d6,_0x1a9e41=this['attachmentCounter'];return this[_0x4e4c2c(0x1dd)]+=0x1,_0x1a9e41;}[_0x2531d6(0x206)](){const _0x76be39=_0x2531d6,_0x591cc2={'bXGmP':function(_0x133ca5,_0x20e1cc){return _0x133ca5>_0x20e1cc;},'aCChn':_0x76be39(0x1e9),'qKVop':_0x76be39(0x1ff)},{children:_0x5da90a}=this[_0x76be39(0x224)],_0x402a8e=_0x591cc2['bXGmP'](_0x5da90a[_0x76be39(0x21a)],0x0);this['uploadItems']['hidden']=!_0x402a8e,this[_0x76be39(0x221)]['disabled']=Array[_0x76be39(0x235)](_0x5da90a)[_0x76be39(0x1f9)](({dataset:{state:_0x2ec3c9}})=>_0x2ec3c9===STATUS['ERROR'])[_0x76be39(0x21a)]>0x0;const _0x32ff01=!_0x5da90a[_0x76be39(0x21a)]||this[_0x76be39(0x247)]['multiple'];this[_0x76be39(0x216)][_0x76be39(0x1e9)]=!_0x32ff01,_0x32ff01?(this[_0x76be39(0x1fc)][_0x76be39(0x20f)][_0x76be39(0x1f5)]('is-disabled'),this[_0x76be39(0x1fc)][_0x76be39(0x22d)](_0x76be39(0x230))[_0x76be39(0x211)](_0x591cc2[_0x76be39(0x225)])):(this[_0x76be39(0x1fc)][_0x76be39(0x20f)][_0x76be39(0x218)](_0x591cc2[_0x76be39(0x244)]),this[_0x76be39(0x1fc)]['querySelector'](_0x76be39(0x230))[_0x76be39(0x1f6)](_0x591cc2[_0x76be39(0x225)],!![]));}[_0x2531d6(0x1da)](_0x2f76c6,_0x3dfbd9,_0x13eb0d={}){const _0x497d1b=_0x2531d6,_0x54c89d={'ThVpF':function(_0xca1067,_0xb3e427){return _0xca1067(_0xb3e427);},'cZHji':function(_0x3aeca3,_0x6efde1){return _0x3aeca3(_0x6efde1);},'kcWIb':'titled','tBHGq':_0x497d1b(0x1e1)},_0x3babc4=_0x497d1b(0x1e2)+_0x2f76c6[_0x497d1b(0x243)]+_0x497d1b(0x234)+_0x54c89d[_0x497d1b(0x245)](truncateFilename,_0x2f76c6['name'])+'</span>\x0a\x20\x20\x20\x20',_0x56f643=_0x497d1b(0x217)+_0x54c89d[_0x497d1b(0x245)](_0x1b3ea9,_0x497d1b(0x20b))+_0x497d1b(0x1f7)+truncateFilename(_0x2f76c6[_0x497d1b(0x243)])+_0x497d1b(0x20a)+this[_0x497d1b(0x1ea)][_0x497d1b(0x23c)]+_0x497d1b(0x1fe)+_0x3dfbd9[_0x497d1b(0x219)](_0xbdde2c=>'<li>'+_0xbdde2c+_0x497d1b(0x1d3))['join']('\x0a')+_0x497d1b(0x21e),_0x19aee5='\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22\x22\x20alt=\x22'+_0x2f76c6[_0x497d1b(0x243)]+_0x497d1b(0x248)+this['locales']['filename']+_0x497d1b(0x23b)+_0x54c89d[_0x497d1b(0x201)](truncateFilename,_0x2f76c6[_0x497d1b(0x243)])+_0x497d1b(0x1d9)+this['locales'][_0x497d1b(0x1eb)]+_0x497d1b(0x22c)+(_0x13eb0d[_0x497d1b(0x1eb)]||truncateFilename(_0x2f76c6[_0x497d1b(0x243)]))+_0x497d1b(0x246);let _0x4d299e=STATUS[_0x497d1b(0x207)],_0x369cb0=_0x3babc4,_0x4d0137='ok';_0x3dfbd9[_0x497d1b(0x21a)]&&(_0x4d299e=STATUS[_0x497d1b(0x202)],_0x369cb0=_0x56f643,_0x4d0137=_0x497d1b(0x240));!_0x3dfbd9[_0x497d1b(0x21a)]&&this[_0x497d1b(0x247)]['titled']&&(_0x369cb0=_0x19aee5,_0x4d0137=_0x54c89d[_0x497d1b(0x23d)]);const _0xbc36a8=_0x13eb0d[_0x497d1b(0x238)]?_0x497d1b(0x200)+_0x13eb0d[_0x497d1b(0x238)]+'\x22':'',_0x1cce8b='\x0a\x20\x20\x20\x20\x20\x20<li\x20'+_0xbc36a8+_0x497d1b(0x213)+_0x2f76c6['name']+'\x22\x20data-state=\x22'+_0x4d299e+_0x497d1b(0x209)+_0x4d0137+_0x497d1b(0x1ec)+_0x369cb0[_0x497d1b(0x23f)]()+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button>'+this['locales'][_0x497d1b(0x1f5)]+'</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<progress\x20max=\x22100\x22\x20value=\x22'+(_0x13eb0d[_0x497d1b(0x20d)]||0x0)+_0x497d1b(0x214),_0x5e1411=document[_0x497d1b(0x208)](_0x54c89d[_0x497d1b(0x237)]);_0x5e1411[_0x497d1b(0x227)]=_0x1cce8b[_0x497d1b(0x23f)]();const _0x41ff3a=_0x5e1411['firstChild'];return _0x41ff3a[_0x497d1b(0x22d)](_0x497d1b(0x23a))['addEventListener']('click',this[_0x497d1b(0x220)][_0x497d1b(0x1d6)](this)),_0x41ff3a;}[_0x2531d6(0x220)]({currentTarget:_0x42b060}){const _0xdec4d9=_0x2531d6,_0x1c23ef={'RgHoH':_0xdec4d9(0x1dc)},_0x2dcb96=_0x42b060[_0xdec4d9(0x1fa)](_0x1c23ef[_0xdec4d9(0x210)]),{filename:_0x3cbe04}=_0x2dcb96[_0xdec4d9(0x229)];_0x2dcb96[_0xdec4d9(0x1f5)]();const _0xe07f56=this['items'][_0xdec4d9(0x215)](({name:_0x2ca43a})=>_0x2ca43a===_0x3cbe04);_0xe07f56>-0x1&&(this[_0xdec4d9(0x249)][_0xe07f56]['removable']=!![]),this['updateDropZone']();}[_0x2531d6(0x1ed)](_0x5ee4ab,_0x37d44d){const _0x4f033e=_0x2531d6;this[_0x4f033e(0x224)][_0x4f033e(0x22d)](_0x4f033e(0x1d8)+_0x5ee4ab+_0x4f033e(0x1df))[_0x4f033e(0x20d)]=_0x37d44d;}[_0x2531d6(0x1e0)](){const _0x41a5ee=_0x2531d6,_0xd250d4={'fBNYL':function(_0x694d14,_0x4d6582){return _0x694d14>_0x4d6582;}};this[_0x41a5ee(0x224)][_0x41a5ee(0x21d)][_0x41a5ee(0x21a)]===0x0?this[_0x41a5ee(0x23a)][_0x41a5ee(0x227)]=this['modalTitle'][_0x41a5ee(0x229)]['addlabel']:this[_0x41a5ee(0x23a)][_0x41a5ee(0x227)]=this[_0x41a5ee(0x233)][_0x41a5ee(0x229)][_0x41a5ee(0x1e7)];const _0x53ab6e=this[_0x41a5ee(0x23a)][_0x41a5ee(0x1f4)];_0x53ab6e&&(_0x53ab6e['checked']=_0xd250d4[_0x41a5ee(0x242)](this[_0x41a5ee(0x224)][_0x41a5ee(0x21d)][_0x41a5ee(0x21a)],0x0));}['cleanAllFiles'](){const _0x2391e0=_0x2531d6;this[_0x2391e0(0x249)]=[],this[_0x2391e0(0x224)][_0x2391e0(0x232)]='',this[_0x2391e0(0x206)]();}}