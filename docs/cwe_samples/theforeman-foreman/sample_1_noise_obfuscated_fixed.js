'use strict';const _0x43f80b=_0x16b0;(function(_0x3115e0,_0x15ae04){const _0x55997d=_0x16b0,_0x312778=_0x3115e0();while(!![]){try{const _0x358511=parseInt(_0x55997d(0x185))/0x1+parseInt(_0x55997d(0x18d))/0x2*(parseInt(_0x55997d(0x193))/0x3)+parseInt(_0x55997d(0x1a6))/0x4+parseInt(_0x55997d(0x1a7))/0x5*(parseInt(_0x55997d(0x19f))/0x6)+-parseInt(_0x55997d(0x18c))/0x7+-parseInt(_0x55997d(0x184))/0x8*(-parseInt(_0x55997d(0x1ad))/0x9)+-parseInt(_0x55997d(0x1ac))/0xa;if(_0x358511===_0x15ae04)break;else _0x312778['push'](_0x312778['shift']());}catch(_0x803f75){_0x312778['push'](_0x312778['shift']());}}}(_0x591f,0xd58f6));function _0x591f(){const _0x2bd6e4=['RYlCp','@strapi/utils','5938986GCsnJu','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','NNgbK','JGpPl','toBe','hVNXQ','not','6774084UqdDog','5kBuDxb','mockResolvedValueOnce','rnBMW','VNKoL','UMTap','30547890BdWhGp','1150758TTySwE','shYbY','validateYupSchema','2021-11-29','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','8zFZDOt','956039wyxbyw','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','test-uid','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','2021-12-15','Date\x20validator','3085075yzHTgj','2698ksRuzV','attrDateUnique','toHaveBeenCalled','assertions','LGrOr','date','1341bmcGuE','../validators','Noqkm','nullable','strapi','unique','EKeVK','contentType','CUFyw','aeEla'];_0x591f=function(){return _0x2bd6e4;};return _0x591f();}function _0x16b0(_0x652f31,_0x315114){const _0x591fce=_0x591f();return _0x16b0=function(_0x16b029,_0x1dbe61){_0x16b029=_0x16b029-0x180;let _0x341c72=_0x591fce[_0x16b029];return _0x341c72;},_0x16b0(_0x652f31,_0x315114);}const strapiUtils=require(_0x43f80b(0x19e)),{errors:{YupValidationError}}=require(_0x43f80b(0x19e)),validators=require(_0x43f80b(0x194));describe(_0x43f80b(0x18b),()=>{const _0x54c95b=_0x43f80b,_0x3cccaf={'RYlCp':_0x54c95b(0x18e),'hVNXQ':'2021-11-29','VNKoL':function(_0x2db54b,_0x317b6b){return _0x2db54b(_0x317b6b);},'IMLbz':_0x54c95b(0x192),'shYbY':function(_0x2a6ff5,_0x16f4be){return _0x2a6ff5(_0x16f4be);},'LGrOr':_0x54c95b(0x188),'UHvlE':_0x54c95b(0x1a0),'rnBMW':_0x54c95b(0x186),'CUFyw':_0x54c95b(0x183),'UMTap':function(_0x528a53,_0x48855e,_0xaedc93){return _0x528a53(_0x48855e,_0xaedc93);},'NNgbK':'it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','aeEla':_0x54c95b(0x189)};_0x3cccaf[_0x54c95b(0x1ab)](describe,_0x54c95b(0x198),()=>{const _0x3776e7=_0x54c95b,_0x255bb3={'EKeVK':_0x3cccaf['IMLbz'],'Noqkm':_0x3cccaf[_0x3776e7(0x1a4)],'JGpPl':function(_0x71f086,_0x15bdc9){const _0x2f0999=_0x3776e7;return _0x3cccaf[_0x2f0999(0x1ae)](_0x71f086,_0x15bdc9);},'tjDmV':_0x3776e7(0x18e)},_0x5a89ce=jest['fn']();global[_0x3776e7(0x197)]={'db':{'query':jest['fn'](()=>({'findOne':_0x5a89ce}))}},afterEach(()=>{jest['clearAllMocks'](),_0x5a89ce['mockReset']();});const _0x229130={'kind':_0x3776e7(0x19a),'modelName':'test-model','uid':_0x3cccaf[_0x3776e7(0x191)],'privateAttributes':[],'options':{},'attributes':{'attrDateUnique':{'type':_0x3cccaf['IMLbz'],'unique':!![]}}};test(_0x3776e7(0x182),async()=>{const _0x2f58a5=_0x3776e7;_0x5a89ce[_0x2f58a5(0x1a8)](null);const _0x34515c=strapiUtils[_0x2f58a5(0x180)](validators[_0x2f58a5(0x192)]({'attr':{'type':_0x2f58a5(0x192)},'model':_0x229130,'updatedAttribute':{'name':_0x3cccaf[_0x2f58a5(0x19d)],'value':_0x3cccaf[_0x2f58a5(0x1a4)]},'entity':null},{'isDraft':![]}));await _0x34515c(_0x3cccaf[_0x2f58a5(0x1a4)]),_0x3cccaf[_0x2f58a5(0x1aa)](expect,_0x5a89ce)['not'][_0x2f58a5(0x18f)]();}),test(_0x3cccaf['UHvlE'],async()=>{const _0x19cdbc=_0x3776e7;_0x5a89ce[_0x19cdbc(0x1a8)](null);const _0x360a7b=strapiUtils[_0x19cdbc(0x180)](validators[_0x19cdbc(0x192)]({'attr':{'type':'date','unique':!![]},'model':_0x229130,'updatedAttribute':{'name':_0x3cccaf[_0x19cdbc(0x19d)],'value':null},'entity':null},{'isDraft':![]})[_0x19cdbc(0x196)]());await _0x360a7b(null),_0x3cccaf['VNKoL'](expect,_0x5a89ce)[_0x19cdbc(0x1a5)][_0x19cdbc(0x18f)]();}),test(_0x3cccaf[_0x3776e7(0x1a9)],async()=>{const _0x10c59d=_0x3776e7;_0x5a89ce[_0x10c59d(0x1a8)](null);const _0x47d059=strapiUtils['validateYupSchema'](validators[_0x10c59d(0x192)]({'attr':{'type':_0x255bb3[_0x10c59d(0x199)],'unique':!![]},'model':_0x229130,'updatedAttribute':{'name':'attrDateUnique','value':_0x255bb3[_0x10c59d(0x195)]},'entity':null},{'isDraft':![]}));expect(await _0x255bb3[_0x10c59d(0x1a2)](_0x47d059,_0x255bb3[_0x10c59d(0x195)]))[_0x10c59d(0x1a3)](_0x255bb3[_0x10c59d(0x195)]);}),test(_0x3776e7(0x187),async()=>{const _0x5f0e2a=_0x3776e7;expect[_0x5f0e2a(0x190)](0x1),_0x5a89ce['mockResolvedValueOnce']({'attrDateUnique':'2021-11-29'});const _0x5d7d62=strapiUtils[_0x5f0e2a(0x180)](validators['date']({'attr':{'type':_0x5f0e2a(0x192),'unique':!![]},'model':_0x229130,'updatedAttribute':{'name':_0x3cccaf['RYlCp'],'value':_0x5f0e2a(0x181)},'entity':null},{'isDraft':![]}));try{await _0x5d7d62(_0x3cccaf[_0x5f0e2a(0x1a4)]);}catch(_0x3b249b){expect(_0x3b249b)['toBeInstanceOf'](YupValidationError);}}),test(_0x3cccaf[_0x3776e7(0x19b)],async()=>{const _0x18e90e=_0x3776e7;_0x5a89ce[_0x18e90e(0x1a8)]({'attrDateUnique':_0x18e90e(0x181)});const _0x55a281=strapiUtils['validateYupSchema'](validators[_0x18e90e(0x192)]({'attr':{'type':_0x18e90e(0x192),'unique':!![]},'model':_0x229130,'updatedAttribute':{'name':_0x3cccaf[_0x18e90e(0x19d)],'value':_0x3cccaf['hVNXQ']},'entity':{'id':0x1,'attrDateUnique':'2021-11-29'}},{'isDraft':![]}));expect(await _0x55a281(_0x3cccaf[_0x18e90e(0x1a4)]))[_0x18e90e(0x1a3)]('2021-11-29');}),_0x3cccaf['UMTap'](test,_0x3cccaf[_0x3776e7(0x1a1)],async()=>{const _0x5ec199=_0x3776e7;_0x5a89ce['mockResolvedValueOnce'](null);const _0x12b960=strapiUtils[_0x5ec199(0x180)](validators['date']({'attr':{'type':_0x5ec199(0x192),'unique':!![]},'model':_0x229130,'updatedAttribute':{'name':'attrDateUnique','value':_0x5ec199(0x181)},'entity':null},{'isDraft':![]}));await _0x3cccaf[_0x5ec199(0x1aa)](_0x12b960,_0x3cccaf[_0x5ec199(0x1a4)]),_0x3cccaf[_0x5ec199(0x1aa)](expect,_0x5a89ce)['toHaveBeenCalledWith']({'select':['id'],'where':{'attrDateUnique':_0x5ec199(0x181)}});}),test(_0x3cccaf[_0x3776e7(0x19c)],async()=>{const _0x31dff7=_0x3776e7;_0x5a89ce[_0x31dff7(0x1a8)](null);const _0x326557=strapiUtils['validateYupSchema'](validators[_0x31dff7(0x192)]({'attr':{'type':'date','unique':!![]},'model':_0x229130,'updatedAttribute':{'name':_0x255bb3['tjDmV'],'value':_0x255bb3['Noqkm']},'entity':{'id':0x1,'attrDateUnique':_0x31dff7(0x18a)}},{'isDraft':![]}));await _0x326557(_0x255bb3['Noqkm']),expect(_0x5a89ce)['toHaveBeenCalledWith']({'select':['id'],'where':{'$and':[{'attrDateUnique':_0x31dff7(0x181)},{'$not':{'id':0x1}}]}});});});});