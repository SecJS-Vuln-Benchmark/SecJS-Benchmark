'use strict';const _0x1bfdf5=_0x385f;(function(_0x70407,_0x36dc7a){const _0x2e1ef3=_0x385f,_0x1fb635=_0x70407();while(!![]){try{const _0x316396=parseInt(_0x2e1ef3(0x1e1))/0x1*(parseInt(_0x2e1ef3(0x1dd))/0x2)+-parseInt(_0x2e1ef3(0x1d5))/0x3*(-parseInt(_0x2e1ef3(0x1e2))/0x4)+-parseInt(_0x2e1ef3(0x1c0))/0x5+parseInt(_0x2e1ef3(0x1d2))/0x6*(-parseInt(_0x2e1ef3(0x1d1))/0x7)+parseInt(_0x2e1ef3(0x1c8))/0x8+parseInt(_0x2e1ef3(0x1df))/0x9*(-parseInt(_0x2e1ef3(0x1d7))/0xa)+-parseInt(_0x2e1ef3(0x1cc))/0xb;if(_0x316396===_0x36dc7a)break;else _0x1fb635['push'](_0x1fb635['shift']());}catch(_0x5dfb5a){_0x1fb635['push'](_0x1fb635['shift']());}}}(_0x2388,0x2a475));function _0x2388(){const _0x46ef4f=['it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','contentType','RTsnF','toHaveBeenCalledWith','EBGRv','it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','bTftn','assertions','397380sHNsKB','test-uid','@strapi/utils','XCDPx','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','HbGmW','sCqYS','toBeInstanceOf','1770032NKFgHW','BxSrU','2021-11-29T00:00:00.000Z','datetime','1520255wzEtCr','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','unique','clearAllMocks','not','2116723TqsORL','6hUKORl','test-model','UlNmk','126RGPBPm','mockResolvedValueOnce','1777070esSpIL','yaLdM','toHaveBeenCalled','udrxI','mockReset','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','615548UdCxKa','attrDateTimeUnique','9VkSUqW','vpmqg','1HdRgoo','32564NQxEHd','validateYupSchema','toBe'];_0x2388=function(){return _0x46ef4f;};return _0x2388();}function _0x385f(_0x2561df,_0x29217d){const _0x23883c=_0x2388();return _0x385f=function(_0x385f28,_0x5440be){_0x385f28=_0x385f28-0x1b9;let _0x1afe50=_0x23883c[_0x385f28];return _0x1afe50;},_0x385f(_0x2561df,_0x29217d);}const strapiUtils=require(_0x1bfdf5(0x1c2)),{errors:{YupValidationError}}=require(_0x1bfdf5(0x1c2)),validators=require('../validators');describe('Datetime\x20validator',()=>{const _0x2369b7=_0x1bfdf5,_0x4253bd={'bTftn':_0x2369b7(0x1de),'udrxI':'2021-11-29T00:00:00.000Z','HbIBM':function(_0x39cab1,_0x3e6dc1){return _0x39cab1(_0x3e6dc1);},'UlNmk':'datetime','vpmqg':function(_0x3281a2,_0x141451){return _0x3281a2(_0x141451);},'UcEVq':_0x2369b7(0x1e6),'lFpSO':_0x2369b7(0x1d3),'EBGRv':function(_0xaf19ce,_0xa721d4,_0x3857a5){return _0xaf19ce(_0xa721d4,_0x3857a5);},'JiFtF':_0x2369b7(0x1cd),'sCqYS':_0x2369b7(0x1bc),'RTsnF':function(_0x4cfe70,_0x81d1f2,_0x5b3859){return _0x4cfe70(_0x81d1f2,_0x5b3859);},'yaLdM':_0x2369b7(0x1dc),'XCDPx':_0x2369b7(0x1ce)};describe(_0x4253bd[_0x2369b7(0x1c3)],()=>{const _0x6526d5=_0x2369b7,_0x1ca439={'HbGmW':_0x6526d5(0x1de),'BxSrU':function(_0x41dacd,_0x39f39c){return _0x41dacd(_0x39f39c);},'kAICp':_0x4253bd[_0x6526d5(0x1da)]},_0x5b3e2c=jest['fn']();global['strapi']={'db':{'query':jest['fn'](()=>({'findOne':_0x5b3e2c}))}},afterEach(()=>{const _0x52f4e3=_0x6526d5;jest[_0x52f4e3(0x1cf)](),_0x5b3e2c[_0x52f4e3(0x1db)]();});const _0x55e26a={'kind':_0x4253bd['UcEVq'],'modelName':_0x4253bd['lFpSO'],'uid':_0x6526d5(0x1c1),'options':{},'attributes':{'attrDateTimeUnique':{'type':_0x4253bd[_0x6526d5(0x1d4)],'unique':!![]}}};_0x4253bd[_0x6526d5(0x1bb)](test,_0x6526d5(0x1e5),async()=>{const _0x3ac468=_0x6526d5;_0x5b3e2c[_0x3ac468(0x1d6)](null);const _0x1eb550=strapiUtils[_0x3ac468(0x1e3)](validators[_0x3ac468(0x1cb)]({'attr':{'type':_0x3ac468(0x1cb)},'model':_0x55e26a,'updatedAttribute':{'name':_0x4253bd[_0x3ac468(0x1be)],'value':_0x3ac468(0x1ca)},'entity':{'id':0x1,'attrDateTimeUnique':_0x4253bd[_0x3ac468(0x1da)]}},{'isDraft':![]}));await _0x4253bd['HbIBM'](_0x1eb550,_0x4253bd[_0x3ac468(0x1da)]),expect(_0x5b3e2c)[_0x3ac468(0x1d0)]['toHaveBeenCalled']();}),test('it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`',async()=>{const _0x39ca52=_0x6526d5;_0x5b3e2c[_0x39ca52(0x1d6)](null);const _0x2369d1=strapiUtils[_0x39ca52(0x1e3)](validators[_0x39ca52(0x1cb)]({'attr':{'type':_0x39ca52(0x1cb),'unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0x1ca439[_0x39ca52(0x1c5)],'value':null},'entity':null},{'isDraft':![]})['nullable']());await _0x2369d1(null),expect(_0x5b3e2c)[_0x39ca52(0x1d0)][_0x39ca52(0x1d9)]();}),test(_0x4253bd['JiFtF'],async()=>{const _0x5275fd=_0x6526d5;_0x5b3e2c[_0x5275fd(0x1d6)](null);const _0x244cb0=strapiUtils[_0x5275fd(0x1e3)](validators[_0x5275fd(0x1cb)]({'attr':{'type':_0x4253bd[_0x5275fd(0x1d4)],'unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0x4253bd['bTftn'],'value':'2021-11-29T00:00:00.000Z'},'entity':null},{'isDraft':![]}));expect(await _0x4253bd['HbIBM'](_0x244cb0,_0x5275fd(0x1ca)))[_0x5275fd(0x1e4)](_0x4253bd['udrxI']);}),_0x4253bd[_0x6526d5(0x1bb)](test,_0x4253bd[_0x6526d5(0x1c6)],async()=>{const _0x1f271a=_0x6526d5;expect[_0x1f271a(0x1bf)](0x1),_0x5b3e2c[_0x1f271a(0x1d6)]({'attrDateTimeUnique':_0x1f271a(0x1ca)});const _0x23e690=strapiUtils[_0x1f271a(0x1e3)](validators[_0x1f271a(0x1cb)]({'attr':{'type':_0x1f271a(0x1cb),'unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0x1f271a(0x1de),'value':_0x4253bd['udrxI']},'entity':null},{'isDraft':![]}));try{await _0x23e690(_0x4253bd[_0x1f271a(0x1da)]);}catch(_0x8f5745){_0x4253bd[_0x1f271a(0x1e0)](expect,_0x8f5745)[_0x1f271a(0x1c7)](YupValidationError);}}),test(_0x6526d5(0x1c4),async()=>{const _0x1ce227=_0x6526d5;_0x5b3e2c[_0x1ce227(0x1d6)]({'attrDateTimeUnique':_0x1ce227(0x1ca)});const _0x3a1795=strapiUtils[_0x1ce227(0x1e3)](validators[_0x1ce227(0x1cb)]({'attr':{'type':_0x1ce227(0x1cb),'unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0x4253bd[_0x1ce227(0x1be)],'value':_0x1ce227(0x1ca)},'entity':{'id':0x1,'attrDateTimeUnique':_0x1ce227(0x1ca)}},{'isDraft':![]}));expect(await _0x3a1795(_0x1ce227(0x1ca)))['toBe'](_0x4253bd[_0x1ce227(0x1da)]);}),_0x4253bd[_0x6526d5(0x1b9)](test,_0x6526d5(0x1bd),async()=>{const _0xc81f54=_0x6526d5;_0x5b3e2c[_0xc81f54(0x1d6)](null);const _0x452aeb=strapiUtils['validateYupSchema'](validators['datetime']({'attr':{'type':'datetime','unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0xc81f54(0x1de),'value':_0xc81f54(0x1ca)},'entity':null},{'isDraft':![]}));await _0x1ca439[_0xc81f54(0x1c9)](_0x452aeb,_0xc81f54(0x1ca)),_0x1ca439[_0xc81f54(0x1c9)](expect,_0x5b3e2c)[_0xc81f54(0x1ba)]({'select':['id'],'where':{'attrDateTimeUnique':_0x1ca439['kAICp']}});}),test(_0x4253bd[_0x6526d5(0x1d8)],async()=>{const _0x259283=_0x6526d5;_0x5b3e2c['mockResolvedValueOnce'](null);const _0x26650a=strapiUtils['validateYupSchema'](validators[_0x259283(0x1cb)]({'attr':{'type':_0x4253bd[_0x259283(0x1d4)],'unique':!![]},'model':_0x55e26a,'updatedAttribute':{'name':_0x4253bd[_0x259283(0x1be)],'value':_0x259283(0x1ca)},'entity':{'id':0x1,'attrDateTimeUnique':'2021-12-25T00:00:00.000Z'}},{'isDraft':![]}));await _0x26650a(_0x259283(0x1ca)),_0x4253bd['HbIBM'](expect,_0x5b3e2c)[_0x259283(0x1ba)]({'select':['id'],'where':{'$and':[{'attrDateTimeUnique':_0x4253bd['udrxI']},{'$not':{'id':0x1}}]}});});});});