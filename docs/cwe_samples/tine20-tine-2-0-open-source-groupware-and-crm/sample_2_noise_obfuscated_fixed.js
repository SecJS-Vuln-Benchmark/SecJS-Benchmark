'use strict';function _0x34f5(_0x266631,_0x500cdd){const _0x3940f0=_0x3940();return _0x34f5=function(_0x34f532,_0x107643){_0x34f532=_0x34f532-0x136;let _0x3d958e=_0x3940f0[_0x34f532];return _0x3d958e;},_0x34f5(_0x266631,_0x500cdd);}const _0x563cda=_0x34f5;(function(_0x18aad2,_0x4f41bb){const _0x55e3cd=_0x34f5,_0x5d68ab=_0x18aad2();while(!![]){try{const _0x12c022=parseInt(_0x55e3cd(0x13a))/0x1+parseInt(_0x55e3cd(0x136))/0x2*(-parseInt(_0x55e3cd(0x139))/0x3)+-parseInt(_0x55e3cd(0x144))/0x4*(parseInt(_0x55e3cd(0x138))/0x5)+parseInt(_0x55e3cd(0x156))/0x6*(parseInt(_0x55e3cd(0x15d))/0x7)+parseInt(_0x55e3cd(0x14a))/0x8*(parseInt(_0x55e3cd(0x143))/0x9)+parseInt(_0x55e3cd(0x13e))/0xa*(parseInt(_0x55e3cd(0x147))/0xb)+-parseInt(_0x55e3cd(0x137))/0xc;if(_0x12c022===_0x4f41bb)break;else _0x5d68ab['push'](_0x5d68ab['shift']());}catch(_0x2689d2){_0x5d68ab['push'](_0x5d68ab['shift']());}}}(_0x3940,0x8e66b));const strapiUtils=require(_0x563cda(0x15c)),{errors:{YupValidationError}}=require(_0x563cda(0x15c)),validators=require(_0x563cda(0x162));function _0x3940(){const _0x140a0b=['not','toBe','mockResolvedValueOnce','yHXLo','132852nZqBDv','hxndA','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','test-model','00:00:00.000Z','JLVxK','@strapi/utils','287nDKCpf','01:00:00.000Z','ZOUVR','NFpyi','rFBlO','../validators','HhmIJ','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','validateYupSchema','RHtOp','toBeInstanceOf','aRBQl','1447090DglSPC','4816536PIxErp','1790270pLqSBV','3IbikFb','478127yRieZi','time','VjpXn','nullable','160IXDbir','SNafD','attrTimeUnique','PtkEZ','MkzIY','8790669AHvoeY','8PbrNOt','contentType','strapi','42361QLoAYb','assertions','tvTaV','8XmYEQp','clearAllMocks','lIdhp','toHaveBeenCalled','STFyj','toHaveBeenCalledWith','test-uid','HhoVB'];_0x3940=function(){return _0x140a0b;};return _0x3940();}describe('Time\x20validator',()=>{const _0x35dfe3=_0x563cda,_0x1b77ce={'SNafD':_0x35dfe3(0x15a),'rFBlO':function(_0x1f8ca4,_0xc3232a){return _0x1f8ca4(_0xc3232a);},'RHtOp':_0x35dfe3(0x13b),'HhoVB':_0x35dfe3(0x140),'lIdhp':function(_0x33d027,_0x197740){return _0x33d027(_0x197740);},'oERON':function(_0x201974,_0x4e7b5b){return _0x201974(_0x4e7b5b);},'MkzIY':_0x35dfe3(0x145),'VjpXn':_0x35dfe3(0x159),'HhmIJ':_0x35dfe3(0x150),'yHXLo':function(_0x1baec3,_0x2f67c6,_0x570020){return _0x1baec3(_0x2f67c6,_0x570020);},'STFyj':'it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','ZOUVR':function(_0x29a9a9,_0x5b3913,_0x2fc524){return _0x29a9a9(_0x5b3913,_0x2fc524);},'aRBQl':_0x35dfe3(0x158),'PtkEZ':'it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','tvTaV':function(_0x5d3a15,_0x50e3b6,_0x276c8d){return _0x5d3a15(_0x50e3b6,_0x276c8d);},'Yjwzr':'it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed'};describe('unique',()=>{const _0x4f9b11=_0x35dfe3,_0xba5ea5={'hxndA':_0x4f9b11(0x140),'JLVxK':function(_0x2a708f,_0x457cc8){return _0x1b77ce['oERON'](_0x2a708f,_0x457cc8);},'NFpyi':'00:00:00.000Z','rnSvQ':_0x1b77ce[_0x4f9b11(0x166)]},_0x2ea86a=jest['fn']();global[_0x4f9b11(0x146)]={'db':{'query':jest['fn'](()=>({'findOne':_0x2ea86a}))}},_0x1b77ce[_0x4f9b11(0x161)](afterEach,()=>{const _0x385bd4=_0x4f9b11;jest[_0x385bd4(0x14b)](),_0x2ea86a['mockReset']();});const _0x27aa77={'kind':_0x1b77ce[_0x4f9b11(0x142)],'modelName':_0x1b77ce[_0x4f9b11(0x13c)],'uid':_0x1b77ce[_0x4f9b11(0x163)],'options':{},'attributes':{'attrTimeUnique':{'type':'time','unique':!![]}}};_0x1b77ce[_0x4f9b11(0x155)](test,_0x4f9b11(0x164),async()=>{const _0x2eec4f=_0x4f9b11;_0x2ea86a[_0x2eec4f(0x154)](null);const _0x192295=strapiUtils['validateYupSchema'](validators[_0x2eec4f(0x13b)]({'attr':{'type':_0x2eec4f(0x13b)},'model':_0x27aa77,'updatedAttribute':{'name':'attrTimeUnique','value':_0x1b77ce['SNafD']},'entity':null},{'isDraft':![]}));await _0x1b77ce[_0x2eec4f(0x161)](_0x192295,_0x1b77ce[_0x2eec4f(0x13f)]),expect(_0x2ea86a)[_0x2eec4f(0x152)]['toHaveBeenCalled']();}),test(_0x1b77ce[_0x4f9b11(0x14e)],async()=>{const _0x59753e=_0x4f9b11;_0x2ea86a[_0x59753e(0x154)](null);const _0x528f28=strapiUtils['validateYupSchema'](validators[_0x59753e(0x13b)]({'attr':{'type':_0x1b77ce[_0x59753e(0x166)],'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0x1b77ce[_0x59753e(0x151)],'value':null},'entity':{'id':0x1,'attrTimeUnique':_0x59753e(0x15a)}},{'isDraft':![]})[_0x59753e(0x13d)]());await _0x528f28(null),expect(_0x2ea86a)['not'][_0x59753e(0x14d)]();}),_0x1b77ce[_0x4f9b11(0x15f)](test,_0x1b77ce[_0x4f9b11(0x168)],async()=>{const _0x485048=_0x4f9b11;_0x2ea86a[_0x485048(0x154)](null);const _0x3decfc=strapiUtils['validateYupSchema'](validators[_0x485048(0x13b)]({'attr':{'type':_0x485048(0x13b),'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0xba5ea5[_0x485048(0x157)],'value':_0x485048(0x15a)},'entity':null},{'isDraft':![]}));expect(await _0xba5ea5[_0x485048(0x15b)](_0x3decfc,_0xba5ea5['NFpyi']))[_0x485048(0x153)](_0x485048(0x15a));}),_0x1b77ce[_0x4f9b11(0x155)](test,_0x1b77ce[_0x4f9b11(0x141)],async()=>{const _0x208a9e=_0x4f9b11;expect[_0x208a9e(0x148)](0x1),_0x2ea86a[_0x208a9e(0x154)]({'attrTimeUnique':_0x208a9e(0x15a)});const _0x1c3e0e=strapiUtils[_0x208a9e(0x165)](validators[_0x208a9e(0x13b)]({'attr':{'type':_0x208a9e(0x13b),'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0xba5ea5['hxndA'],'value':_0xba5ea5[_0x208a9e(0x160)]},'entity':null},{'isDraft':![]}));try{await _0xba5ea5[_0x208a9e(0x15b)](_0x1c3e0e,_0xba5ea5['NFpyi']);}catch(_0x51209d){expect(_0x51209d)[_0x208a9e(0x167)](YupValidationError);}}),test('it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value',async()=>{const _0x4b677e=_0x4f9b11;_0x2ea86a[_0x4b677e(0x154)]({'attrTimeUnique':_0x4b677e(0x15a)});const _0x558c70=strapiUtils[_0x4b677e(0x165)](validators[_0x4b677e(0x13b)]({'attr':{'type':_0x1b77ce[_0x4b677e(0x166)],'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0x4b677e(0x140),'value':_0x1b77ce[_0x4b677e(0x13f)]},'entity':{'id':0x1,'attrTimeUnique':_0x1b77ce[_0x4b677e(0x13f)]}},{'isDraft':![]}));expect(await _0x1b77ce[_0x4b677e(0x14c)](_0x558c70,_0x1b77ce[_0x4b677e(0x13f)]))[_0x4b677e(0x153)](_0x1b77ce[_0x4b677e(0x13f)]);}),_0x1b77ce[_0x4f9b11(0x15f)](test,'it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute',async()=>{const _0x116b5c=_0x4f9b11;_0x2ea86a[_0x116b5c(0x154)](null);const _0x277707=strapiUtils[_0x116b5c(0x165)](validators['time']({'attr':{'type':_0xba5ea5['rnSvQ'],'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0xba5ea5['hxndA'],'value':_0x116b5c(0x15a)},'entity':null},{'isDraft':![]}));await _0x277707(_0xba5ea5['NFpyi']),_0xba5ea5[_0x116b5c(0x15b)](expect,_0x2ea86a)[_0x116b5c(0x14f)]({'select':['id'],'where':{'attrTimeUnique':_0x116b5c(0x15a)}});}),_0x1b77ce[_0x4f9b11(0x149)](test,_0x1b77ce['Yjwzr'],async()=>{const _0x283422=_0x4f9b11;_0x2ea86a[_0x283422(0x154)](null);const _0xd66b02=strapiUtils[_0x283422(0x165)](validators[_0x283422(0x13b)]({'attr':{'type':_0xba5ea5['rnSvQ'],'unique':!![]},'model':_0x27aa77,'updatedAttribute':{'name':_0xba5ea5[_0x283422(0x157)],'value':_0x283422(0x15a)},'entity':{'id':0x1,'attrTimeUnique':_0x283422(0x15e)}},{'isDraft':![]}));await _0xd66b02(_0xba5ea5[_0x283422(0x160)]),_0xba5ea5[_0x283422(0x15b)](expect,_0x2ea86a)['toHaveBeenCalledWith']({'select':['id'],'where':{'$and':[{'attrTimeUnique':_0xba5ea5[_0x283422(0x160)]},{'$not':{'id':0x1}}]}});});});});