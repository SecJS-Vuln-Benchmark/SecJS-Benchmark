'use strict';const _0x442881=_0x5516;function _0x5516(_0x442701,_0x582109){const _0x4b3d18=_0x4b3d();return _0x5516=function(_0x551616,_0x38dde8){_0x551616=_0x551616-0x1c3;let _0x1aee9f=_0x4b3d18[_0x551616];return _0x1aee9f;},_0x5516(_0x442701,_0x582109);}(function(_0x50d6c4,_0x1e538d){const _0x1239b8=_0x5516,_0x3dd80b=_0x50d6c4();while(!![]){try{const _0x54458e=parseInt(_0x1239b8(0x1dd))/0x1+parseInt(_0x1239b8(0x1d4))/0x2*(parseInt(_0x1239b8(0x1e7))/0x3)+-parseInt(_0x1239b8(0x1e1))/0x4+parseInt(_0x1239b8(0x1da))/0x5+-parseInt(_0x1239b8(0x1df))/0x6+parseInt(_0x1239b8(0x1e9))/0x7+-parseInt(_0x1239b8(0x1e4))/0x8;if(_0x54458e===_0x1e538d)break;else _0x3dd80b['push'](_0x3dd80b['shift']());}catch(_0x59214c){_0x3dd80b['push'](_0x3dd80b['shift']());}}}(_0x4b3d,0xa0d0d));const strapiUtils=require('@strapi/utils'),{errors:{YupValidationError}}=require('@strapi/utils'),validators=require(_0x442881(0x1ce));function _0x4b3d(){const _0x127248=['timestamp','bNQIc','DCXWQ','aIRzi','TLZkC','1000000000','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','ezwnd','RoCjI','xmXGd','../validators','bvlet','nhPJy','toHaveBeenCalledWith','1638140400','assertions','280682meRHZu','mOVxC','fiTQY','validateYupSchema','TnKTq','attrTimestampUnique','1481570KYXzrW','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','unique','142775zdKnty','test-model','3608922kKLjku','toBe','2600384nzrGWF','WNEYt','contentType','2160400uRJEXs','Time\x20validator','DEYwp','18LfpcKg','cKYhw','6294393mqBSTN','mockResolvedValueOnce','bgEwn','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','aRTJA','not','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','cWBLv','mockReset'];_0x4b3d=function(){return _0x127248;};return _0x4b3d();}describe(_0x442881(0x1e5),()=>{const _0x918a84=_0x442881,_0x88569b={'nhPJy':_0x918a84(0x1d9),'TnKTq':'1638140400','TLZkC':function(_0x1cfb2e,_0x3de5dc){return _0x1cfb2e(_0x3de5dc);},'xmXGd':'timestamp','cKYhw':function(_0x33783d,_0x563b7b){return _0x33783d(_0x563b7b);},'WNEYt':_0x918a84(0x1c8),'aIRzi':_0x918a84(0x1e3),'RoCjI':'test-uid','ezwnd':function(_0x394111,_0x3c039e,_0x528b6f){return _0x394111(_0x3c039e,_0x528b6f);},'bvlet':'it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','HTpbJ':function(_0x1b9536,_0x17df7d,_0x1e812b){return _0x1b9536(_0x17df7d,_0x1e812b);},'fiTQY':function(_0x32ff3c,_0x50e10c,_0x128fdb){return _0x32ff3c(_0x50e10c,_0x128fdb);},'DEYwp':'it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','DCXWQ':_0x918a84(0x1db),'bgEwn':function(_0x50e201,_0xacba01,_0x5f12e6){return _0x50e201(_0xacba01,_0x5f12e6);}};_0x88569b[_0x918a84(0x1cb)](describe,_0x918a84(0x1dc),()=>{const _0x75290a=_0x918a84,_0x3253aa={'mOVxC':_0x75290a(0x1c3),'aRTJA':function(_0x3d4a02,_0x1724a3){const _0x201610=_0x75290a;return _0x88569b[_0x201610(0x1e8)](_0x3d4a02,_0x1724a3);},'bNQIc':_0x88569b['TnKTq'],'cWBLv':_0x88569b[_0x75290a(0x1e2)]},_0x5f4296=jest['fn']();global['strapi']={'db':{'query':jest['fn'](()=>({'findOne':_0x5f4296}))}},_0x88569b[_0x75290a(0x1c7)](afterEach,()=>{const _0x2f4d14=_0x75290a;jest['clearAllMocks'](),_0x5f4296[_0x2f4d14(0x1f1)]();});const _0x6129af={'kind':_0x88569b[_0x75290a(0x1c6)],'modelName':_0x75290a(0x1de),'uid':_0x88569b[_0x75290a(0x1cc)],'options':{},'attributes':{'attrTimestampUnique':{'type':_0x88569b[_0x75290a(0x1cd)],'unique':!![]}}};_0x88569b[_0x75290a(0x1cb)](test,_0x88569b[_0x75290a(0x1cf)],async()=>{const _0x5af79d=_0x75290a;_0x5f4296['mockResolvedValueOnce'](null);const _0x3e07b2=strapiUtils[_0x5af79d(0x1d7)](validators[_0x5af79d(0x1c3)]({'attr':{'type':'timestamp'},'model':_0x6129af,'updatedAttribute':{'name':_0x88569b[_0x5af79d(0x1d0)],'value':_0x88569b['TnKTq']},'entity':null},{'isDraft':![]}));await _0x88569b[_0x5af79d(0x1c7)](_0x3e07b2,_0x5af79d(0x1d2)),expect(_0x5f4296)[_0x5af79d(0x1ee)]['toHaveBeenCalled']();}),_0x88569b['HTpbJ'](test,_0x75290a(0x1c9),async()=>{const _0x5244ec=_0x75290a;_0x5f4296[_0x5244ec(0x1ea)](null);const _0x3e7cb4=strapiUtils[_0x5244ec(0x1d7)](validators[_0x5244ec(0x1c3)]({'attr':{'type':_0x3253aa[_0x5244ec(0x1d5)],'unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':'attrTimestampUnique','value':null},'entity':null},{'isDraft':![]})['nullable']());await _0x3253aa[_0x5244ec(0x1ed)](_0x3e7cb4,null),_0x3253aa['aRTJA'](expect,_0x5f4296)['not']['toHaveBeenCalled']();}),test(_0x75290a(0x1ca),async()=>{const _0x7948e=_0x75290a;_0x5f4296[_0x7948e(0x1ea)](null);const _0x4f28a2=strapiUtils[_0x7948e(0x1d7)](validators['timestamp']({'attr':{'type':'timestamp','unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':_0x7948e(0x1d9),'value':_0x7948e(0x1d2)},'entity':null},{'isDraft':![]}));_0x88569b[_0x7948e(0x1c7)](expect,await _0x88569b[_0x7948e(0x1c7)](_0x4f28a2,_0x7948e(0x1d2)))[_0x7948e(0x1e0)](_0x7948e(0x1d2));}),_0x88569b[_0x75290a(0x1d6)](test,_0x88569b[_0x75290a(0x1e6)],async()=>{const _0x2da76f=_0x75290a;expect[_0x2da76f(0x1d3)](0x1),_0x5f4296[_0x2da76f(0x1ea)]({'attrTimestampUnique':_0x3253aa[_0x2da76f(0x1c4)]});const _0x5703f1=strapiUtils[_0x2da76f(0x1d7)](validators[_0x2da76f(0x1c3)]({'attr':{'type':'timestamp','unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':_0x2da76f(0x1d9),'value':_0x3253aa[_0x2da76f(0x1c4)]},'entity':null},{'isDraft':![]}));try{await _0x5703f1(_0x3253aa[_0x2da76f(0x1c4)]);}catch(_0x54d5a5){expect(_0x54d5a5)['toBeInstanceOf'](YupValidationError);}}),_0x88569b[_0x75290a(0x1cb)](test,_0x88569b[_0x75290a(0x1c5)],async()=>{const _0x12491f=_0x75290a;_0x5f4296['mockResolvedValueOnce']({'attrTimestampUnique':_0x88569b[_0x12491f(0x1d8)]});const _0x4c152d=strapiUtils[_0x12491f(0x1d7)](validators[_0x12491f(0x1c3)]({'attr':{'type':_0x88569b['xmXGd'],'unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':_0x12491f(0x1d9),'value':_0x12491f(0x1d2)},'entity':{'id':0x1,'attrTimestampUnique':'1638140400'}},{'isDraft':![]}));expect(await _0x4c152d(_0x88569b['TnKTq']))[_0x12491f(0x1e0)](_0x88569b['TnKTq']);}),_0x88569b[_0x75290a(0x1d6)](test,_0x75290a(0x1ec),async()=>{const _0x7a6119=_0x75290a;_0x5f4296['mockResolvedValueOnce'](null);const _0x49c6e8=strapiUtils['validateYupSchema'](validators[_0x7a6119(0x1c3)]({'attr':{'type':_0x88569b[_0x7a6119(0x1cd)],'unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':_0x7a6119(0x1d9),'value':_0x88569b['TnKTq']},'entity':null},{'isDraft':![]}));await _0x49c6e8(_0x7a6119(0x1d2)),_0x88569b['TLZkC'](expect,_0x5f4296)['toHaveBeenCalledWith']({'select':['id'],'where':{'attrTimestampUnique':'1638140400'}});}),_0x88569b[_0x75290a(0x1eb)](test,_0x75290a(0x1ef),async()=>{const _0x57b076=_0x75290a;_0x5f4296['mockResolvedValueOnce'](null);const _0x351620=strapiUtils[_0x57b076(0x1d7)](validators[_0x57b076(0x1c3)]({'attr':{'type':_0x3253aa[_0x57b076(0x1d5)],'unique':!![]},'model':_0x6129af,'updatedAttribute':{'name':_0x57b076(0x1d9),'value':_0x3253aa['bNQIc']},'entity':{'id':0x1,'attrTimestampUnique':_0x3253aa[_0x57b076(0x1f0)]}},{'isDraft':![]}));await _0x351620(_0x57b076(0x1d2)),expect(_0x5f4296)[_0x57b076(0x1d1)]({'select':['id'],'where':{'$and':[{'attrTimestampUnique':'1638140400'},{'$not':{'id':0x1}}]}});});});});