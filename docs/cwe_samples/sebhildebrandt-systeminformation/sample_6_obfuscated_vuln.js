var _0x28b59a=_0x4dff;(function(_0x4a8637,_0x435991){var _0x768768=_0x4dff,_0x9a5433=_0x4a8637();while(!![]){try{var _0x1b9b5d=parseInt(_0x768768(0x190))/0x1*(-parseInt(_0x768768(0x15d))/0x2)+parseInt(_0x768768(0x157))/0x3*(parseInt(_0x768768(0x16b))/0x4)+-parseInt(_0x768768(0x195))/0x5*(parseInt(_0x768768(0x19e))/0x6)+parseInt(_0x768768(0x17b))/0x7*(-parseInt(_0x768768(0x17a))/0x8)+-parseInt(_0x768768(0x14a))/0x9*(parseInt(_0x768768(0x181))/0xa)+parseInt(_0x768768(0x16a))/0xb+-parseInt(_0x768768(0x183))/0xc*(-parseInt(_0x768768(0x19f))/0xd);if(_0x1b9b5d===_0x435991)break;else _0x9a5433['push'](_0x9a5433['shift']());}catch(_0x2648b4){_0x9a5433['push'](_0x9a5433['shift']());}}}(_0x3e23,0xdc4bd),require(_0x28b59a(0x187))['config']());function _0x3e23(){var _0x53f9cb=['languages:read','audit-types:read','mjFHo','name','12424RvtXhp','1183GmSLSV','length','ElFoX','allows','YNgSE','./httpResponse','238640LGwEqH','companies:create','15108gpxYAP','RUWzR','jzqps','wQIxu','dotenv','jsonwebtoken','audits:read','inherits','LKySD','split','QVOue','No\x20Authorization\x20header','indexOf','96979ygIvBI','createSecret','ARvLx','SECRET','env','10wHzwzk','sections:read','TokenExpiredError','qEXIz','isAllowed','header','mBBqU','clients:read','CgTak','4063062eJtULE','30862BbFaBj','KKbGZ','./roles.json','vulnerability-categories:read','Expired\x20token','AAewG','cmhfw','audits:delete','oyCnn','./utils','ptJEf','FGBQY','object','roles','189bHmwSc','buildRoles','eTWOb','vulnerability-types:read','VsHMc','vTpQb','wEsLV','yyCxS','iYExq','CYAYo','Forbidden','verify','Insufficient\x20privileges','3fCvRpo','user','vulnerabilities:read','Unauthorized','uEhDX','ZBUWZ','26XxeXio','companies:update','egcsE','templates:read','NeqHP','clients:delete','hasPermission','Authorization','Invalid\x20token','audits:update','decodedToken','Expected\x20an\x20object\x20as\x20input','clients:update','1551693jvDOdG','4604344Ozydvh','FxjAW','vulnerability-updates:create','HsiLy','some','includes','companies:delete','MmMFv','forEach','roles:read','Bad\x20Authorization\x20type'];_0x3e23=function(){return _0x53f9cb;};return _0x3e23();}var utils=require(_0x28b59a(0x1a8)),jwtSecret=process[_0x28b59a(0x194)][_0x28b59a(0x193)]||utils[_0x28b59a(0x191)]();exports['jwtSecret']=jwtSecret;var builtInRoles={'user':{'allows':['audits:create',_0x28b59a(0x189),_0x28b59a(0x166),_0x28b59a(0x1a6),'clients:create',_0x28b59a(0x19c),_0x28b59a(0x169),_0x28b59a(0x162),_0x28b59a(0x182),'companies:read',_0x28b59a(0x15e),_0x28b59a(0x171),_0x28b59a(0x176),_0x28b59a(0x177),_0x28b59a(0x14d),_0x28b59a(0x1a2),_0x28b59a(0x196),_0x28b59a(0x160),'users:read',_0x28b59a(0x174),_0x28b59a(0x159),_0x28b59a(0x16d),'custom-fields:read']},'admin':{'allows':'*'}};function _0x4dff(_0x1a816d,_0x43a43c){var _0x3e23ca=_0x3e23();return _0x4dff=function(_0x4dffec,_0x217ce1){_0x4dffec=_0x4dffec-0x147;var _0x625284=_0x3e23ca[_0x4dffec];return _0x625284;},_0x4dff(_0x1a816d,_0x43a43c);}try{var customRoles=require(_0x28b59a(0x1a1));}catch(_0x4eaa52){var customRoles=[];}var roles={...customRoles,...builtInRoles};class ACL{constructor(_0x47a9b5){var _0xc556f7=_0x28b59a,_0x41eb0d={'KKbGZ':'user','yyCxS':_0xc556f7(0x148),'oyCnn':function(_0x10774b,_0x59e6b3){return _0x10774b!==_0x59e6b3;},'vTpQb':_0xc556f7(0x168)};if(typeof _0x47a9b5!==_0x41eb0d[_0xc556f7(0x151)]){if(_0x41eb0d[_0xc556f7(0x1a7)](_0xc556f7(0x17d),_0xc556f7(0x147)))throw new TypeError(_0x41eb0d[_0xc556f7(0x14f)]);else{var _0x3738b5=this['roles'][_0x4c0bc7]||this['roles'][_0x41eb0d[_0xc556f7(0x1a0)]],_0x30b748=_0x3738b5['allows']||[];return _0x3738b5['inherits']&&_0x3738b5[_0xc556f7(0x18a)]['forEach'](_0x25b53f=>{var _0x414391=_0xc556f7;_0x30b748=[...new _0x180321([..._0x30b748,...this[_0x414391(0x14b)](_0x25b53f)])];}),_0x30b748;}}this[_0xc556f7(0x149)]=_0x47a9b5;}[_0x28b59a(0x199)](_0x226800,_0x5672d9){var _0x3e08e6=_0x28b59a,_0x4f42f0={'wEsLV':_0x3e08e6(0x158),'RUWzR':_0x3e08e6(0x15c),'iYExq':_0x3e08e6(0x14c),'qEXIz':function(_0xc5efb8,_0x2a2daa){return _0xc5efb8!==_0x2a2daa;},'xWFuA':function(_0x4e50b1,_0x30b3a3){return _0x4e50b1<_0x30b3a3;}};if(!this['roles'][_0x226800]&&!this[_0x3e08e6(0x149)][_0x4f42f0[_0x3e08e6(0x150)]])return _0x4f42f0[_0x3e08e6(0x184)]===_0x4f42f0[_0x3e08e6(0x152)]?![]:![];let _0x275e27=this['roles'][_0x226800]||this[_0x3e08e6(0x149)][_0x4f42f0[_0x3e08e6(0x150)]];if(_0x275e27['allows']&&(_0x275e27['allows']==='*'||_0x4f42f0[_0x3e08e6(0x198)](_0x275e27['allows'][_0x3e08e6(0x18f)](_0x5672d9),-0x1)))return!![];if(!_0x275e27[_0x3e08e6(0x18a)]||_0x4f42f0['xWFuA'](_0x275e27['inherits']['length'],0x1))return![];return _0x275e27['inherits'][_0x3e08e6(0x16f)](_0x205027=>this[_0x3e08e6(0x199)](_0x205027,_0x5672d9));}[_0x28b59a(0x163)](_0xbdefb5){var _0x4ac01d=_0x28b59a,_0x492347={'mBBqU':'validtoken','CgTak':function(_0x9f99e1,_0x59fef7){return _0x9f99e1===_0x59fef7;},'ptJEf':_0x4ac01d(0x164),'RPAUZ':_0x4ac01d(0x18e),'egcsE':function(_0x4f304c,_0x3308c9){return _0x4f304c!==_0x3308c9;},'wQIxu':'JWT','jzqps':_0x4ac01d(0x175),'ARvLx':_0x4ac01d(0x180),'VsHMc':function(_0x4de061,_0xcf9938){return _0x4de061(_0xcf9938);},'zBoNV':_0x4ac01d(0x188)},_0x289f2a=require(_0x492347[_0x4ac01d(0x192)]),_0x444ef5=_0x492347[_0x4ac01d(0x14e)](require,_0x492347['zBoNV']);return(_0x467260,_0x3cc119,_0x2672a)=>{var _0x40be23=_0x4ac01d,_0x48eae4={'FxjAW':function(_0x5f0138,_0x140785){return _0x5f0138===_0x140785;},'QVOue':function(_0x1fa264,_0x469f70){return _0x1fa264===_0x469f70;},'NeqHP':_0x40be23(0x18b),'sTEpW':'Expired\x20token','HsiLy':_0x492347[_0x40be23(0x19b)],'AAewG':function(_0x147095,_0x282910){var _0x3f5eaa=_0x40be23;return _0x492347[_0x3f5eaa(0x19d)](_0x147095,_0x282910);}};if(!_0x467260[_0x40be23(0x19a)](_0x492347[_0x40be23(0x1a9)])){_0x289f2a[_0x40be23(0x15a)](_0x3cc119,_0x492347['RPAUZ']);return;}var _0x4b2c0b=_0x467260['header'](_0x492347[_0x40be23(0x1a9)])[_0x40be23(0x18c)]('\x20');if(_0x492347[_0x40be23(0x15f)](_0x4b2c0b[_0x40be23(0x17c)],0x2)||_0x4b2c0b[0x0]!==_0x492347[_0x40be23(0x186)]){_0x289f2a['Unauthorized'](_0x3cc119,_0x492347[_0x40be23(0x185)]);return;}var _0xd85bcc=_0x4b2c0b[0x1];_0x444ef5[_0x40be23(0x155)](_0xd85bcc,jwtSecret,(_0x272695,_0x859c20)=>{var _0x3a8546=_0x40be23,_0x4556a4={'cmhfw':_0x3a8546(0x168)};if(_0x272695){if(_0x48eae4[_0x3a8546(0x18d)](_0x48eae4[_0x3a8546(0x161)],_0x48eae4['NeqHP'])){if(_0x48eae4[_0x3a8546(0x18d)](_0x272695[_0x3a8546(0x179)],_0x3a8546(0x197)))_0x289f2a[_0x3a8546(0x15a)](_0x3cc119,_0x48eae4['sTEpW']);else _0x289f2a[_0x3a8546(0x15a)](_0x3cc119,_0x3a8546(0x165));return;}else{var _0x5a3de1=this[_0x3a8546(0x14b)](_0x40e941);if(_0x5a3de1[_0x3a8546(0x170)]('*'))return'*';return _0x5a3de1;}}if(_0xbdefb5===_0x48eae4[_0x3a8546(0x16e)]||this[_0x3a8546(0x199)](_0x859c20['role'],_0xbdefb5)){if(_0x3a8546(0x153)!==_0x3a8546(0x153)){if(_0x48eae4[_0x3a8546(0x16c)](_0x37621e[_0x3a8546(0x179)],'TokenExpiredError'))_0x19e0e0[_0x3a8546(0x15a)](_0x4260f9,_0x3a8546(0x1a3));else _0x1d7834[_0x3a8546(0x15a)](_0x2ff852,_0x3a8546(0x165));return;}else return _0x467260[_0x3a8546(0x167)]=_0x859c20,_0x2672a();}else{if(_0x48eae4[_0x3a8546(0x1a4)](_0x3a8546(0x15b),_0x3a8546(0x15b))){_0x289f2a[_0x3a8546(0x154)](_0x3cc119,'Insufficient\x20privileges');return;}else throw new _0xd0c4c0(_0x4556a4[_0x3a8546(0x1a5)]);}});};}[_0x28b59a(0x14b)](_0x510428){var _0x4b9dc7=_0x28b59a,_0x44b790={'MmMFv':_0x4b9dc7(0x156),'ZxCAx':function(_0x3679c6,_0x490499){return _0x3679c6===_0x490499;}},_0x377ded=this['roles'][_0x510428]||this[_0x4b9dc7(0x149)][_0x4b9dc7(0x158)],_0x4aec11=_0x377ded[_0x4b9dc7(0x17e)]||[];if(_0x377ded[_0x4b9dc7(0x18a)]){if(_0x44b790['ZxCAx'](_0x4b9dc7(0x17f),_0x4b9dc7(0x178))){_0x3c6070[_0x4b9dc7(0x154)](_0x4ee75e,_0x44b790[_0x4b9dc7(0x172)]);return;}else _0x377ded[_0x4b9dc7(0x18a)][_0x4b9dc7(0x173)](_0x1724ae=>{_0x4aec11=[...new Set([..._0x4aec11,...this['buildRoles'](_0x1724ae)])];});}return _0x4aec11;}['getRoles'](_0x1c0839){var _0x29fe75=_0x28b59a,_0x48ed5b=this[_0x29fe75(0x14b)](_0x1c0839);if(_0x48ed5b[_0x29fe75(0x170)]('*'))return'*';return _0x48ed5b;}}exports['acl']=new ACL(roles);