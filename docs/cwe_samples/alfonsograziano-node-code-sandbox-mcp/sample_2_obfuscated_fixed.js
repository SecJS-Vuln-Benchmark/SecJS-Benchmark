const _0x50ea18=_0x4e8f;function _0x4e8f(_0x4541bc,_0x8a4048){const _0x5a9921=_0x5a99();return _0x4e8f=function(_0x4e8fb6,_0x4b342c){_0x4e8fb6=_0x4e8fb6-0x199;let _0x573554=_0x5a9921[_0x4e8fb6];return _0x573554;},_0x4e8f(_0x4541bc,_0x8a4048);}(function(_0x2e3ee8,_0x3922fc){const _0xa0fed9=_0x4e8f,_0x318ff0=_0x2e3ee8();while(!![]){try{const _0x3c3a63=parseInt(_0xa0fed9(0x1ca))/0x1+parseInt(_0xa0fed9(0x1e8))/0x2*(parseInt(_0xa0fed9(0x1e3))/0x3)+-parseInt(_0xa0fed9(0x1b6))/0x4+-parseInt(_0xa0fed9(0x1aa))/0x5+-parseInt(_0xa0fed9(0x1d7))/0x6*(-parseInt(_0xa0fed9(0x1a5))/0x7)+parseInt(_0xa0fed9(0x1be))/0x8+parseInt(_0xa0fed9(0x1e5))/0x9;if(_0x3c3a63===_0x3922fc)break;else _0x318ff0['push'](_0x318ff0['shift']());}catch(_0x4789a3){_0x318ff0['push'](_0x318ff0['shift']());}}}(_0x5a99,0x4e1f4));const debug=require('@tryghost/debug')(_0x50ea18(0x1bd)),cors=require('cors'),bodyParser=require(_0x50ea18(0x1f1)),express=require(_0x50ea18(0x1ee)),sentry=require(_0x50ea18(0x1a4)),membersService=require(_0x50ea18(0x1bf)),stripeService=require(_0x50ea18(0x1c5)),middleware=membersService[_0x50ea18(0x1a0)],shared=require('../shared'),labs=require(_0x50ea18(0x1cf)),errorHandler=require(_0x50ea18(0x1e4)),config=require(_0x50ea18(0x1d5)),{http}=require(_0x50ea18(0x1cc)),api=require('../../api')['endpoints'],commentRouter=require(_0x50ea18(0x1d2)),announcementRouter=require(_0x50ea18(0x1e6));function _0x5a99(){const _0x154ffa=['body-parser','loadMemberSession','deleteSuppression','/api/member','QXteW','enabledMiddleware','createSessionFromMagicLink','add','kTbBD','/api/recommendations/:id/subscribed','updateMemberData','XWJEE','/api/feedback','private','feedbackMembers','middleware','webhookController','/api','authMemberByUuid','../../../shared/sentry','4557UmKXGg','application/json','5mb','50mb','createCheckoutSession','3173660VKUJcP','cacheMembersContent:enabled','membersAuthEnumeration','site','eQgiu','get','Orweh','bind','ZntVY','exports','use','getIdentityToken','2285980KJXlub','getMemberData','/api/site','/api/comments','deleteSession','lyMWX','leGfs','members','383992lixrOh','../../services/members','trackClicked','rFrmW','recommendationsPublic','/api/announcement','getMemberNewsletters','../../services/stripe','/api/recommendations/:id/clicked','LjIvS','/api/send-magic-link','/webhooks','94741mLToru','api','@tryghost/api-framework','audienceFeedback','xdAWp','../../../shared/labs','/api/create-stripe-checkout-session','handleJSONResponse','../comments','announcementBar','updateSubscription','../../../shared/config','caching:cors:maxAge','1002zNPaVg','/webhooks/stripe','json','/api/member/newsletters','delete','resourceNotFound','NSMav','/api/member/suppression','bLFap','trackSubscribed','put','Members\x20App\x20setup\x20start','1371yEFowy','@tryghost/mw-error-handler','6393267olGhjm','../announcement','/api/session','2470PSnDjC','XwMeU','updateEmailAddress','/api/create-stripe-update-session','membersAuth','Members\x20App\x20setup\x20end','../../../shared/express','ScLtf','post'];_0x5a99=function(){return _0x154ffa;};return _0x5a99();}module[_0x50ea18(0x1b3)]=function setupMembersApp(){const _0x5656e0=_0x50ea18,_0x1783f7={'leGfs':_0x5656e0(0x1e2),'rFrmW':function(_0x567147,_0x10ecd7){return _0x567147(_0x10ecd7);},'XWJEE':_0x5656e0(0x1d8),'ivDQN':_0x5656e0(0x1a8),'LjIvS':function(_0x4e6151,_0x5ad06e){return _0x4e6151!==_0x5ad06e;},'xdAWp':_0x5656e0(0x1dd),'Orweh':'nezJd','bLFap':_0x5656e0(0x1de),'ScLtf':_0x5656e0(0x1e7),'QXteW':_0x5656e0(0x1d0),'kwqsY':'/api/subscriptions/:id','lyMWX':_0x5656e0(0x1cd),'XwMeU':function(_0xb252cd,_0x11c7a2){return _0xb252cd(_0x11c7a2);},'eQgiu':_0x5656e0(0x1c3),'ZntVY':_0x5656e0(0x19a),'uHfVM':_0x5656e0(0x1a2),'kTbBD':_0x5656e0(0x1c9)};debug(_0x1783f7[_0x5656e0(0x1bc)]);const _0x1e4745=express(_0x5656e0(0x1bd));_0x1e4745['use'](shared[_0x5656e0(0x1a0)]['cacheControl'](_0x5656e0(0x19e))),_0x1e4745[_0x5656e0(0x1b4)](_0x1783f7['rFrmW'](cors,{'maxAge':config['get'](_0x5656e0(0x1d6))})),_0x1e4745[_0x5656e0(0x1b4)](middleware[_0x5656e0(0x1f7)]),_0x1e4745['post'](_0x1783f7[_0x5656e0(0x19c)],bodyParser['raw']({'type':_0x5656e0(0x1a6)}),stripeService[_0x5656e0(0x1a1)]['handle'][_0x5656e0(0x1b1)](stripeService[_0x5656e0(0x1a1)])),_0x1e4745[_0x5656e0(0x1af)](_0x5656e0(0x1da),middleware[_0x5656e0(0x1a3)],middleware[_0x5656e0(0x1c4)]),_0x1e4745[_0x5656e0(0x1e1)](_0x5656e0(0x1da),bodyParser[_0x5656e0(0x1d9)]({'limit':_0x1783f7['ivDQN']}),middleware['authMemberByUuid'],middleware['updateMemberNewsletters']);const _0x1762fe=config[_0x5656e0(0x1af)](_0x5656e0(0x1ab));if(_0x1762fe)_0x1e4745[_0x5656e0(0x1af)](_0x5656e0(0x1f4),middleware['loadMemberSession'],middleware['accessInfoSession'],middleware['getMemberData']);else{if(_0x1783f7[_0x5656e0(0x1c7)](_0x1783f7[_0x5656e0(0x1ce)],_0x1783f7[_0x5656e0(0x1b0)]))_0x1e4745[_0x5656e0(0x1af)](_0x5656e0(0x1f4),middleware[_0x5656e0(0x1b7)]);else return _0x40c9e2['api'][_0x5656e0(0x1a0)][_0x5656e0(0x1a9)](_0x46431f,_0x7e8065,_0x1213e7);}return _0x1e4745[_0x5656e0(0x1e1)](_0x5656e0(0x1f4),bodyParser[_0x5656e0(0x1d9)]({'limit':_0x1783f7['ivDQN']}),middleware[_0x5656e0(0x19b)]),_0x1e4745[_0x5656e0(0x1f0)]('/api/member/email',bodyParser[_0x5656e0(0x1d9)]({'limit':_0x1783f7['ivDQN']}),(_0x1d8259,_0x15c2c1)=>membersService[_0x5656e0(0x1cb)][_0x5656e0(0x1a0)][_0x5656e0(0x1ea)](_0x1d8259,_0x15c2c1)),_0x1e4745[_0x5656e0(0x1db)](_0x1783f7[_0x5656e0(0x1df)],middleware[_0x5656e0(0x1f3)]),_0x1e4745[_0x5656e0(0x1af)](_0x5656e0(0x1e7),middleware[_0x5656e0(0x1b5)]),_0x1e4745[_0x5656e0(0x1db)](_0x1783f7[_0x5656e0(0x1ef)],bodyParser[_0x5656e0(0x1d9)]({'limit':_0x5656e0(0x1a7)}),middleware[_0x5656e0(0x1ba)]),_0x1e4745[_0x5656e0(0x1f0)](_0x5656e0(0x1c8),bodyParser['json'](),shared[_0x5656e0(0x1a0)]['brute'][_0x5656e0(0x1ac)],shared[_0x5656e0(0x1a0)]['brute'][_0x5656e0(0x1ec)],function _0x24230a(_0xfcc3a5,_0x279f66,_0xe73012){const _0x1b267a=_0x5656e0;return membersService[_0x1b267a(0x1cb)]['middleware']['sendMagicLink'](_0xfcc3a5,_0x279f66,_0xe73012);}),_0x1e4745[_0x5656e0(0x1f0)](_0x1783f7[_0x5656e0(0x1f5)],function _0x21d1c7(_0x11b52f,_0x33b80f,_0x53d08c){const _0xdfc711=_0x5656e0;return membersService[_0xdfc711(0x1cb)][_0xdfc711(0x1a0)][_0xdfc711(0x1a9)](_0x11b52f,_0x33b80f,_0x53d08c);}),_0x1e4745[_0x5656e0(0x1f0)](_0x5656e0(0x1eb),function _0x13b0e1(_0x5bc8df,_0x1b013d,_0x2576ed){const _0x3d60f4=_0x5656e0;return membersService[_0x3d60f4(0x1cb)][_0x3d60f4(0x1a0)]['createCheckoutSetupSession'](_0x5bc8df,_0x1b013d,_0x2576ed);}),_0x1e4745[_0x5656e0(0x1e1)](_0x1783f7['kwqsY'],function _0x225510(_0x1cb9f2,_0xeffefd,_0x297f9c){const _0x44d92f=_0x5656e0;return membersService[_0x44d92f(0x1cb)][_0x44d92f(0x1a0)][_0x44d92f(0x1d4)](_0x1cb9f2,_0xeffefd,_0x297f9c);}),_0x1e4745['use'](_0x5656e0(0x1b9),commentRouter()),_0x1e4745[_0x5656e0(0x1f0)](_0x5656e0(0x19d),labs['enabledMiddleware'](_0x1783f7[_0x5656e0(0x1bb)]),bodyParser[_0x5656e0(0x1d9)]({'limit':_0x5656e0(0x1a8)}),middleware[_0x5656e0(0x1f2)],middleware[_0x5656e0(0x1a3)],_0x1783f7[_0x5656e0(0x1e9)](http,api[_0x5656e0(0x19f)][_0x5656e0(0x1f8)])),_0x1e4745[_0x5656e0(0x1b4)](_0x1783f7[_0x5656e0(0x1ae)],labs[_0x5656e0(0x1f6)](_0x5656e0(0x1d3)),middleware[_0x5656e0(0x1f2)],announcementRouter()),_0x1e4745['post'](_0x5656e0(0x1c6),middleware['loadMemberSession'],http(api[_0x5656e0(0x1c2)][_0x5656e0(0x1c0)])),_0x1e4745[_0x5656e0(0x1f0)](_0x1783f7[_0x5656e0(0x1b2)],middleware[_0x5656e0(0x1f2)],_0x1783f7[_0x5656e0(0x1c1)](http,api[_0x5656e0(0x1c2)][_0x5656e0(0x1e0)])),_0x1e4745[_0x5656e0(0x1af)](_0x5656e0(0x1b8),_0x1783f7[_0x5656e0(0x1e9)](http,api[_0x5656e0(0x1ad)]['read'])),_0x1e4745['use'](_0x1783f7['uHfVM'],errorHandler[_0x5656e0(0x1dc)]),_0x1e4745[_0x5656e0(0x1b4)](_0x5656e0(0x1a2),errorHandler[_0x5656e0(0x1d1)](sentry)),_0x1e4745[_0x5656e0(0x1b4)](_0x1783f7[_0x5656e0(0x199)],errorHandler[_0x5656e0(0x1dc)]),_0x1e4745['use'](_0x5656e0(0x1c9),errorHandler[_0x5656e0(0x1d1)](sentry)),_0x1783f7[_0x5656e0(0x1c1)](debug,_0x5656e0(0x1ed)),_0x1e4745;};