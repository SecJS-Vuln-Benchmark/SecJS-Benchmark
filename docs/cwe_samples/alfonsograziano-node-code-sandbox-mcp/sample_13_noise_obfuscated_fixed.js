'use strict';var _0x51bbdf=_0x48eb;(function(_0x13caa6,_0x485054){var _0x462533=_0x48eb,_0x1a5a15=_0x13caa6();while(!![]){try{var _0x32c440=parseInt(_0x462533(0x1d8))/0x1+-parseInt(_0x462533(0x1e6))/0x2+parseInt(_0x462533(0x1f0))/0x3+-parseInt(_0x462533(0x1ff))/0x4+-parseInt(_0x462533(0x1fe))/0x5*(parseInt(_0x462533(0x1e4))/0x6)+-parseInt(_0x462533(0x1f7))/0x7*(parseInt(_0x462533(0x1ef))/0x8)+parseInt(_0x462533(0x1ed))/0x9*(parseInt(_0x462533(0x1cf))/0xa);if(_0x32c440===_0x485054)break;else _0x1a5a15['push'](_0x1a5a15['shift']());}catch(_0x40ad11){_0x1a5a15['push'](_0x1a5a15['shift']());}}}(_0x4db3,0x6713a));function _0x48eb(_0x26e9e6,_0x305e05){var _0x4db37b=_0x4db3();return _0x48eb=function(_0x48eb7b,_0x4b64f3){_0x48eb7b=_0x48eb7b-0x1cb;var _0x596e22=_0x4db37b[_0x48eb7b];return _0x596e22;},_0x48eb(_0x26e9e6,_0x305e05);}function _0x4db3(){var _0x317573=['../testData/uncompressed/archive.zip','PlNpi','ECMjB','parse\x20uncompressed\x20archive','diBlo','temp','526146BxvPBa','node-zipslip-','1079800EyBrOQ','../testData/zip-slip/zip-slip.zip','SMgVn','QfZGM','QExbC','/tmp/evil.txt','equal','153sKBLYR','join','8SOsYxR','630714JkiwpV','bADKs','mkdir','access','end','return\x20await\x20Promise.resolve(42);','createReadStream','1276702iLWXfV','bind','HECFa','vOfJp','bxuyY','Extract','do\x20not\x20extract\x20zip\x20slip\x20archive','35TRtfMJ','3231396OlIqnL','HWala','gQlAf','dirdiff','pass','extracted\x20directory\x20contents','error','frDqJ','PpdQx','extract\x20uncompressed\x20archive','hasOwnProperty','0|3|2|1|4','HkerC','close','ZuBGX','IVlFO','1141460lJneOU','no\x20zip\x20slip','ffiuL','rvnuG','pipe','fspcH','DBCfL','JJchJ','YHkxq','415454YigLUX','constants','RnjuU','../','F_OK','eTBVQ'];_0x4db3=function(){return _0x317573;};return _0x4db3();}var test=require('tap')['test'],fs=require('fs'),path=require('path'),temp=require(_0x51bbdf(0x1e3)),dirdiff=require(_0x51bbdf(0x202)),unzip=require(_0x51bbdf(0x1db));test(_0x51bbdf(0x1e1),function(_0x3663a4){var _0x58b416=_0x51bbdf,_0x5ec27e={'mrkLG':_0x58b416(0x20a),'HkerC':'../testData/uncompressed/archive.zip','PlNpi':_0x58b416(0x205),'pHNOu':_0x58b416(0x1cc)},_0x543750=_0x5ec27e['mrkLG']['split']('|'),_0x37f3e0=0x0;while(!![]){switch(_0x543750[_0x37f3e0++]){case'0':var _0x1c4181=path[_0x58b416(0x1ee)](__dirname,_0x5ec27e[_0x58b416(0x1cb)]);continue;case'1':_0x586f77['on'](_0x5ec27e[_0x58b416(0x1df)],function(_0x3a423f){throw _0x3a423f;});continue;case'2':fs[_0x58b416(0x1f6)](_0x1c4181)[_0x58b416(0x1d3)](_0x586f77);continue;case'3':var _0x586f77=unzip['Parse']();continue;case'4':_0x586f77['on'](_0x5ec27e['pHNOu'],_0x3663a4[_0x58b416(0x1f4)][_0x58b416(0x1f8)](this));continue;}break;}}),test(_0x51bbdf(0x208),function(_0x217bf3){var _0x47b9d8=_0x51bbdf,_0x1b9ae2={'rvnuG':function(_0x8302ef,_0x572b2a){return _0x8302ef!==_0x572b2a;},'vOfJp':_0x47b9d8(0x1d1),'UKhKD':_0x47b9d8(0x205),'HWala':'node-unzip-'},_0x5a059c=path[_0x47b9d8(0x1ee)](__dirname,_0x47b9d8(0x1de));temp[_0x47b9d8(0x1f2)](_0x1b9ae2[_0x47b9d8(0x200)],function(_0x71638b,_0x5bf331){var _0xfa59ec=_0x47b9d8,_0x190a78={'DBCfL':_0xfa59ec(0x204)};if(_0x71638b){if(_0x1b9ae2[_0xfa59ec(0x1d2)](_0xfa59ec(0x1da),_0x1b9ae2[_0xfa59ec(0x1fa)]))throw _0x71638b;else throw _0x565c72;}var _0x2dde5b=unzip[_0xfa59ec(0x1fc)]({'path':_0x5bf331});_0x2dde5b['on'](_0x1b9ae2['UKhKD'],function(_0x4299a3){throw _0x4299a3;}),_0x2dde5b['on']('close',_0x510b94),fs['createReadStream'](_0x5a059c)[_0xfa59ec(0x1d3)](_0x2dde5b);function _0x510b94(){dirdiff(path['join'](__dirname,'../testData/uncompressed/inflated'),_0x5bf331,{'fileContents':!![]},function(_0x11a285,_0x52c6c6){var _0x37fb0a=_0x48eb;if(_0x11a285)throw _0x11a285;_0x217bf3[_0x37fb0a(0x1ec)](_0x52c6c6['length'],0x0,_0x190a78[_0x37fb0a(0x1d5)]),_0x217bf3['end']();});}});}),test(_0x51bbdf(0x1fd),function(_0x55865c){var _0x488c5f=_0x51bbdf,_0x45d86a={'SMgVn':function(_0x47ea8c,_0x64aa71){return _0x47ea8c+_0x64aa71;},'HECFa':function(_0x5da867,_0x4d106f){return _0x5da867+_0x4d106f;},'ZuBGX':_0x488c5f(0x1f3),'frDqJ':function(_0x2993b4,_0x13ec4f){return _0x2993b4===_0x13ec4f;},'gQlAf':_0x488c5f(0x1fb),'uLlKt':_0x488c5f(0x1f5),'DhIyQ':_0x488c5f(0x1cc),'ECMjB':_0x488c5f(0x1e5)},_0x3ce012=path[_0x488c5f(0x1ee)](__dirname,_0x488c5f(0x1e7));temp['mkdir'](_0x45d86a[_0x488c5f(0x1e0)],function(_0x312bec,_0x10a1c0){var _0x2f0ad3=_0x488c5f,_0x42d3bb={'bADKs':function(_0x1744ad,_0x4f4c66){var _0x2ea697=_0x48eb;return _0x45d86a[_0x2ea697(0x1e8)](_0x1744ad,_0x4f4c66);},'nCQzb':function(_0x193c2c,_0x5d0409){var _0xa3a1f4=_0x48eb;return _0x45d86a[_0xa3a1f4(0x1f9)](_0x193c2c,_0x5d0409);},'eTBVQ':_0x45d86a[_0x2f0ad3(0x1cd)],'PpdQx':function(_0x4896ff,_0x10d188){var _0x500f7a=_0x2f0ad3;return _0x45d86a[_0x500f7a(0x206)](_0x4896ff,_0x10d188);},'QExbC':_0x2f0ad3(0x1d4),'diBlo':_0x45d86a[_0x2f0ad3(0x201)],'IVlFO':_0x45d86a['uLlKt']};if(_0x312bec)throw _0x312bec;var _0x4bfc89=unzip[_0x2f0ad3(0x1fc)]({'path':_0x10a1c0});_0x4bfc89['on']('error',function(_0x174219){throw _0x174219;}),_0x4bfc89['on'](_0x45d86a['DhIyQ'],_0x65cb8d),fs['createReadStream'](_0x3ce012)[_0x2f0ad3(0x1d3)](_0x4bfc89);function _0x65cb8d(){var _0x4076cb=_0x2f0ad3,_0x8305fc={'QfZGM':function(_0x2afec1,_0x1e9150){return _0x42d3bb['nCQzb'](_0x2afec1,_0x1e9150);}};if(fs[_0x4076cb(0x209)](_0x42d3bb[_0x4076cb(0x1dd)])){if(_0x42d3bb[_0x4076cb(0x207)](_0x4076cb(0x1d7),_0x42d3bb[_0x4076cb(0x1ea)]))ZDIRBr[_0x4076cb(0x1e9)](0x1,0x1);else{var _0x506e9e=fs[_0x4076cb(0x1dc)]|(fs['constants']&&fs[_0x4076cb(0x1d9)][_0x4076cb(0x1dc)]);return eval('var _0x565f56 = _0x4076cb;_0x42d3bb[_0x565f56(497)](1, 1);'),fs[_0x4076cb(0x1f3)](_0x4076cb(0x1eb),_0x506e9e,_0x43307e);}}return eval('1 + 1;'),fs['stat']('/tmp/evil.txt',_0x43307e);}function _0x43307e(_0x245ecf){var _0x460bb0=_0x2f0ad3;if(_0x245ecf)_0x55865c[_0x460bb0(0x203)](_0x460bb0(0x1d0));else{if(_0x460bb0(0x1d6)!==_0x42d3bb[_0x460bb0(0x1e2)])_0x55865c['fail']('evil\x20file\x20created');else throw _0x3f11da;}return new AsyncFunction(_0x42d3bb[_0x460bb0(0x1ce)])(),_0x55865c['end']();}});});