const _0x3de023=_0x1896;(function(_0x25e197,_0x4b3ed8){const _0x4ed4e3=_0x1896,_0x1eb61e=_0x25e197();while(!![]){try{const _0x43e724=-parseInt(_0x4ed4e3(0xae))/0x1+-parseInt(_0x4ed4e3(0x13e))/0x2+-parseInt(_0x4ed4e3(0x256))/0x3+parseInt(_0x4ed4e3(0x1a0))/0x4+-parseInt(_0x4ed4e3(0x223))/0x5*(parseInt(_0x4ed4e3(0xb7))/0x6)+-parseInt(_0x4ed4e3(0xb8))/0x7*(parseInt(_0x4ed4e3(0x119))/0x8)+parseInt(_0x4ed4e3(0x1e9))/0x9;if(_0x43e724===_0x4b3ed8)break;else _0x1eb61e['push'](_0x1eb61e['shift']());}catch(_0x285fc4){_0x1eb61e['push'](_0x1eb61e['shift']());}}}(_0x2545,0x6b8b5));const assert=require(_0x3de023(0x187)),should=require(_0x3de023(0x125)),sinon=require(_0x3de023(0x207)),supertest=require(_0x3de023(0x116)),moment=require(_0x3de023(0xc0)),testUtils=require(_0x3de023(0x231)),configUtils=require(_0x3de023(0x234)),settingsCache=require(_0x3de023(0xb1)),settingsHelpers=require(_0x3de023(0x121)),DomainEvents=require(_0x3de023(0x1ef)),{MemberPageViewEvent}=require('@tryghost/member-events'),models=require(_0x3de023(0x1cb)),{fixtureManager}=require(_0x3de023(0x178)),DataGenerator=require(_0x3de023(0x1e2)),members=require(_0x3de023(0x197)),crypto=require('crypto');function assertContentIsPresent(_0x498d3a){const _0x1c08ac=_0x3de023,_0x32d972={'cLgGy':_0x1c08ac(0xc9)};_0x498d3a[_0x1c08ac(0x12b)]['should'][_0x1c08ac(0xec)](_0x32d972[_0x1c08ac(0x1ba)]);}function _0x1896(_0x3cd809,_0x5aadcc){const _0x254593=_0x2545();return _0x1896=function(_0x1896f1,_0x7b617c){_0x1896f1=_0x1896f1-0xab;let _0x3ec203=_0x254593[_0x1896f1];return _0x3ec203;},_0x1896(_0x3cd809,_0x5aadcc);}function assertContentIsAbsent(_0x4382bb){const _0x53623d=_0x3de023,_0x23153f={'bXCgt':_0x53623d(0xc9)};_0x4382bb[_0x53623d(0x12b)][_0x53623d(0x125)]['not'][_0x53623d(0xec)](_0x23153f['bXCgt']);}async function createMember(_0x12354f){return await members['api']['members']['create']({..._0x12354f});}function _0x2545(){const _0x41320e=['YwUPY','jbWnk','ggtrc','/thou-must-be-labelled-vip/','GEFBU','edit','Sending\x20a\x20POST\x20request\x20to\x20the\x20unsubscribe\x20endpoint\x20should\x20unsubscribe\x20the\x20member\x20from\x20that\x20specific\x20newsletter','nHtPE','NYZQs','YqFXV','cannot\x20read\x20paid\x20post\x20content','should\x20error\x20for\x20fetching\x20member\x20newsletters\x20with\x20invalid\x20uuid','Content','aPzKU','rRdeH','api','../utils/e2e-framework','JFVJQ','have','returns','sort_order','should\x20401\x20for\x20PUT\x20member\x20newsletters\x20with\x20a\x20mismatched\x20hmac\x20key','OZvwG','unsubscribe\x20post\x20works\x20with\x20x-www-form-urlencoded','unsubscribe-member-test-another@example.com','HwkQZ','tLsWM','url','OMLFF','QkQqA','spy','assert/strict','MlRXo','member1@test.com','jnKgK','can\x20read\x20paid\x20post\x20content','/members/api/send-magic-link','glJWI','btUKu','can\x20destroy\x20all\x20sessions','wrEyh','jxdpa','EnIhk','ZzbFc','create','should\x20error\x20for\x20updating\x20member\x20newsletters\x20with\x20no\x20key','WZYHB','../../core/server/services/members','subscribe','refresh','thou-shalt-be-paid-for','YOZGL','uuid','GcCKZ','can\x20read\x20product-only\x20post\x20content','can\x20fetch\x20member\x20data','49096kcOWxg','search','VBFRG','name','FgrrF','update','Bvngx','jrwoE','equal','free-to-see','mUpFd','transient_id','LLOlP','paid@test.com','Jlyxn','/members/api/member/newsletters?uuid=','signin','WUXUL','aBlsz','cannot\x20read\x20members\x20post\x20content','forKnex','WCuye','can\x20destroy\x20only\x20current\x20session','as\x20member\x20with\x20product','/unsubscribe/?uuid=XXX&newsletter=YYY','seconds','cLgGy','tsuDP','BXTAu','stub','TWgjD','fqaza','exist','OlaCE','HmHmp','UpEMR','eqcSC','test','WCFOF','lyrbH','models','/free-to-see/','xqifb','../../core/server/models','Fbnri','EurfY','qfCRG','IVUEY','FpleT','members','active_theme','Content-Type','location','doesn\x27t\x20generate\x20a\x20MemberPageView\x20event','YYEWP','fhSGX','getURL','xQwMH','should\x20redirect\x20invalid\x20token\x20on\x20members\x20endpoint','UVkbx','text/html;\x20charset=utf-8','vjffd','6|4|5|2|0|1|3','ikkvA','ZcFDc','ISsaj','../utils/fixtures/data-generator','alrNc','Unsubscribe','mgnnW','members-test-theme','set-cookie','/members/webhooks/stripe','13874859gMRlAW','OtqTx','/members/api/session','GDDlv','OMNII','fSABW','@tryghost/domain-events','bBfFn','TqCIj','body','fnimA','VlLAC','RmcvO','/members/api/member','rPgyM','kBMlY','should\x20error\x20for\x20invalid\x20data\x20on\x20members\x20create\x20update\x20session\x20endpoint','invalid','Gmgzf','paid','HUviL','rJyWB','lxgcI','tHDCr','HCKLE','gAQsk','property','zNKCs','elNIK','public','sinon','AlwCy','vVyfI','eiAbr','getMagicLink','an\x20invalid\x20token\x20causes\x20a\x20set-cookie\x20logout\x20when\x20requesting\x20the\x20identity','can\x20read\x20members\x20post\x20content','createPost','related','lqpES','aFPSw','should\x20pass\x20through\x20an\x20optional\x20newsletter\x20param','dtLCY','sPEWe','jdUOc','kNyvr','XCuWl','del','agent','searchParams','should\x20unsubscribe\x20from\x20comment\x20notifications\x20on\x20POST','form','/unsubscribe/?uuid=XXX&key=YYY','{\x22version\x22:\x220.3.1\x22,\x22markups\x22:[],\x22atoms\x22:[],\x22cards\x22:[[\x22paywall\x22,{}]],\x22sections\x22:[[1,\x22p\x22,[[0,[],0,\x22Free\x20content\x22]]],[10,0],[1,\x22p\x22,[[0,[],0,\x22Members\x20content\x22]]]]}','headers','should\x20redirect\x20with\x20uuid\x20and\x20action\x20param','email','aUeja','10CenknE','zpERg','as\x20paid\x20member','unsubscribe\x20post\x20works\x20with\x20multipart/form-data','unsubscribe-member-test@example.com','as\x20free\x20member','selke','aJtxI','subscriptions','IXDpt','/unsubscribe/','/members/','UVmdg','should\x20error\x20for\x20invalid\x20data\x20on\x20member\x20magic\x20link\x20endpoint','../utils','ZKgHC','last_seen_at','../utils/configUtils','HlSdj','Member\x20routes','FxAcP','Member','QuVXe','nLbQX','HWkAv','callsFake','/thou-shalt-not-be-seen/','add','expect','tCMQQ','/thou-shalt-be-paid-for/','email_suppression','Gvibr','yLJPU','hpSaz','xpWls','calledOnce','YZbGw','/members/?token=abc&action=signup','status','should\x20serve\x20theme\x20404\x20on\x20members\x20endpoint','oSNNg','NoDfb','cannot\x20read\x20product-only\x20post\x20content','startGhost','eql','uDbmw','should\x20reject\x20when\x20missing\x20a\x20uuid','rqlNA','lsokd','jYoKQ','416745JDmXvp','should\x20return\x20no\x20content\x20when\x20removing\x20member\x20sessions','enable_comment_notifications','pLXPS','&comments=1','config','fHbBF','success','CwqwL','UAFul','ZdedE','uNzYS','toDate','getMemberIdentityToken','ZcCrr','VgkuB','oGMEu','kFvjT','yjjhg','GfScZ','gGcIO','OhcCP','73701HIFXkU','oZWCL','not','../../core/shared/settings-cache','getMembersValidationKey','pwgnQ','A\x20page\x20view\x20from\x20a\x20member\x20should\x20generate\x20a\x20MemberPageViewEvent\x20event','Xrtzq','DVDKb','238530iqygvR','18907iGuOZN','EHIOk','VVnLP','QjFRs','should\x20error\x20for\x20updating\x20member\x20newsletters\x20with\x20missing\x20uuid','put','log\x20out','jqlAU','moment','OQjnI','gcXCI','thou-must-be-labelled-vip','as\x20free\x20member\x20with\x20vip\x20label','/members/api/member/newsletters?uuid=abc','mtCOL','Izint','digest','<h2\x20id=\x22markdown\x22>markdown</h2>','created_at','/members/api/subscriptions/123','kVzLZ','length','TjThe','ShDvB','generates\x20a\x20MemberPageView\x20event','unsubscribe-member-test-2@example.com','ylqYI','uTBbq','API','TKwPE','sha256','should\x20fail\x20processing\x20a\x20webhook\x20endpoint\x20with\x20stripe\x20header','dbOnS','should\x20error\x20serving\x20webhook\x20endpoint\x20without\x20any\x20parameters','VEPPJ','VWbce','post','RFbeH','send','Yqeaw','oVRzI','GFCWo','oXWaI','ofmtg','thefalsekey','FeVsv','type','fxJKu','UtDPJ','UoQik','can\x20read\x20public\x20post\x20content','WTUvU','containEql','/members/api/create-stripe-checkout-session','KIXuo','should\x20error\x20for\x20invalid\x20data\x20on\x20members\x20subscription\x20endpoint','field','<p>Free\x20content</p><!--members-only--><p>Members\x20content</p>','fyAkQ','FfUnS','members:newsletters','with-product@test.com','&newsletter=','XbzPP','findOne','dzVWm','YuIau','aZhvd','keys','fixtures','/members/api/create-stripe-update-session','as\x20comped\x20member','The\x20member\x20should\x20have\x20a\x20`last_seen_at`\x20property\x20after\x20having\x20visited\x20a\x20page\x20while\x20logged-in.','EaIaO','dswpK','avatar_image','/members/api/member/newsletters','cannot\x20read\x20label-only\x20post\x20content','notEqual','KbZgQ','Idnjy','set','pDipV','restore','pathname','HLgAw','DataGenerator','RfJkx','IVeSk','NcEDh','tOUbs','cGKQg','JpnaB','afeKS','supertest','/thou-must-have-default-product/','get','352fjrDOF','allSettled','/unsubscribe/?uuid=','Vwunm','http://127.0.0.1:2369/?uuid=XXX&newsletter=YYY&action=unsubscribe','Aolvj','hex','ddHDu','../../core/server/services/settings-helpers','KJflP','GTZxL','zmNQG','should','notCalled','tTzCA','/members/api/member/newsletters?uuid=abc&key=blah','VHwZm','RHwrI','text','jFIXh','should\x20401\x20for\x20GET\x20member\x20newsletters\x20with\x20a\x20mismatched\x20hmac\x20key','newsletters','should\x20return\x20no\x20content\x20for\x20invalid\x20token\x20passed\x20in\x20session','XVBVx','List-Unsubscribe','aHkjx','PhWHK','mSsHm','bsevC','BmgGV','NaNGS','bmdNd','MOngc','gOzmf','/unsubscribe/?uuid=XXX','http://127.0.0.1:2369/?uuid=XXX&key=YYY&action=unsubscribe','lgenm','1404908VqSBJC','as\x20non-member','properties','eQwbr','yyTQB','Udpbm','KkUdE','PMjij','oQJnc','thou-must-have-default-product','calDi','unMhG','should\x20return\x20unauthorized\x20with\x20a\x20bad\x20key','One-Click','true','Jamie\x20Larsen','Sending\x20a\x20POST\x20request\x20to\x20the\x20unsubscribe\x20endpoint\x20should\x20unsubscribe\x20the\x20member','ubvao','should\x20only\x20do\x20a\x20partial\x20unsubscribe\x20on\x20POST','VZlvK','TAgxH','insertPosts','Location','The\x20member\x20shouldn\x27t\x20have\x20a\x20`last_seen_at`\x20property\x20set\x20before\x20this\x20test.','should\x20error\x20for\x20updating\x20member\x20newsletters\x20with\x20invalid\x20uuid','createHmac','&key=','vPchB','Front-end\x20members\x20behavior','VgiqU','XRztO','should\x20pass\x20through\x20an\x20optional\x20key\x20param','hBqBd','JDkOW','label:vip','/?action=signup&success=false','faMwX','DZaEI','Could\x20not\x20find\x20subscription\x20invalid','product:default-product','EsXTh','sIxiK'];_0x2545=function(){return _0x41320e;};return _0x2545();}async function cycleTransientId(_0x2833ad){const _0x20c0de=_0x3de023;return await members[_0x20c0de(0x177)][_0x20c0de(0x1d1)]['cycleTransientId']({..._0x2833ad});}describe(_0x3de023(0x15a),function(){const _0x3ef242=_0x3de023,_0x331bc4={'IVUEY':'true','alrNc':function(_0x53761e,_0x125927){return _0x53761e(_0x125927);},'ORawZ':_0x3ef242(0x197),'FCMwf':function(_0x5e91fe,_0x5db42c){return _0x5e91fe!==_0x5db42c;},'FxAcP':'hManq','BmgGV':'npFVa','Udpbm':_0x3ef242(0x183),'YuIau':'JBzjC','yyTQB':_0x3ef242(0x213),'ofmtg':_0x3ef242(0x1eb),'UpEMR':_0x3ef242(0xfe),'zNKCs':_0x3ef242(0x1fa),'HLgAw':_0x3ef242(0x1d3),'uNzYS':'text/plain;charset=UTF-8','pLXPS':_0x3ef242(0x1de),'vPchB':'thou-shalt-have-a-taste','uDbmw':'seconds','pwgnQ':'thou-shalt-not-be-seen','fyAkQ':function(_0x4be3d5){return _0x4be3d5();},'tOUbs':_0x3ef242(0x19a),'vVyfI':function(_0x224c0d,_0x1871b6){return _0x224c0d===_0x1871b6;},'RHwrI':_0x3ef242(0x1c4),'VgkuB':_0x3ef242(0x1c5),'JDkOW':_0x3ef242(0x17c),'mSVIx':_0x3ef242(0x24a),'JFVJQ':function(_0x5a1939,_0x19ca25,_0x1f4b21){return _0x5a1939(_0x19ca25,_0x1f4b21);},'JpnaB':'should\x20error\x20for\x20fetching\x20member\x20newsletters\x20with\x20missing\x20uuid','nMLrD':_0x3ef242(0x173),'HCKLE':_0x3ef242(0xbc),'vbidr':_0x3ef242(0x195),'GFCWo':function(_0x46104d,_0x229d7e,_0x5ec8a7){return _0x46104d(_0x229d7e,_0x5ec8a7);},'TKwPE':_0x3ef242(0x12d),'lyrbH':_0x3ef242(0xc9),'rRdeH':_0x3ef242(0x25d),'zBBhQ':'Stripe-Signature','VBFRG':_0x3ef242(0xed),'UVkbx':'https://example.com/blog/?stripe=cancel','kBMlY':'jamie@example.com','GxvXf':_0x3ef242(0x164),'ynyUG':_0x3ef242(0x184),'jnKgK':_0x3ef242(0xb2),'xqifb':_0x3ef242(0x22e),'WHnYZ':function(_0x426c88,_0x8ecae9){return _0x426c88!==_0x8ecae9;},'zuSkX':'kuWTH','WCuye':function(_0x4272c9,_0x58d9f8,_0x36fedc){return _0x4272c9(_0x58d9f8,_0x36fedc);},'RfJkx':_0x3ef242(0xd7),'bpxZw':_0x3ef242(0x257),'mtCOL':function(_0x2ab62b,_0x342a07,_0x55ae29){return _0x2ab62b(_0x342a07,_0x55ae29);},'rJyWB':'should\x20error\x20for\x20invalid\x20member\x20token\x20on\x20member\x20data\x20endpoint','UsCKd':_0x3ef242(0x230),'tHDCr':'should\x20error\x20for\x20using\x20an\x20invalid\x20offer\x20id\x20on\x20members\x20create\x20checkout\x20session\x20endpoint','bnYGp':_0x3ef242(0x1f9),'ZcCrr':function(_0x31c176,_0xd9ee3b,_0x1e37ee){return _0x31c176(_0xd9ee3b,_0x1e37ee);},'IxEzg':_0x3ef242(0xef),'nDGTN':function(_0x20b24d,_0x2cc993,_0x577043){return _0x20b24d(_0x2cc993,_0x577043);},'VlLAC':function(_0x11ea12,_0x13fec1,_0x14f70a){return _0x11ea12(_0x13fec1,_0x14f70a);},'yLJPU':_0x3ef242(0x1da),'KIXuo':_0x3ef242(0x1d2),'tLsWM':_0x3ef242(0x1e6),'WZYHB':_0x3ef242(0x13b),'aOvmK':'Location','NSjEk':'glJWI','fxJKu':_0x3ef242(0x21d),'UXkEC':_0x3ef242(0x22d),'oGMEu':_0x3ef242(0x12e),'tsuDP':'sha256','WCFOF':'hex','Aolvj':_0x3ef242(0xd1),'dzVWm':_0x3ef242(0x19c),'ISsaj':_0x3ef242(0x16e),'EurfY':_0x3ef242(0x21c),'Gmgzf':_0x3ef242(0x14b),'oVRzI':_0x3ef242(0x14e),'LLOlP':function(_0x40a84d,_0x584009){return _0x40a84d(_0x584009);},'aHkjx':_0x3ef242(0x131),'PqsML':_0x3ef242(0x1b8),'rPgyM':_0x3ef242(0x227),'qfCRG':'oFHiW','ddHDu':function(_0x47c7d5,_0x4a8fd2,_0xae957f){return _0x47c7d5(_0x4a8fd2,_0xae957f);},'YlJAv':_0x3ef242(0x220),'bmdNd':_0x3ef242(0x15d),'HwkQZ':function(_0x436277,_0x3e736b,_0x4d5cce){return _0x436277(_0x3e736b,_0x4d5cce);},'YqFXV':_0x3ef242(0x252),'lqpES':_0x3ef242(0x14a),'NcEDh':function(_0x670326,_0x5deaa5,_0x4aa49e){return _0x670326(_0x5deaa5,_0x4aa49e);},'ubvao':'should\x20do\x20an\x20actual\x20unsubscribe\x20on\x20POST','ILVxe':function(_0x1fcab5,_0x56baf5,_0x3b4eb0){return _0x1fcab5(_0x56baf5,_0x3b4eb0);},'gcXCI':_0x3ef242(0x21b),'mXFvG':_0x3ef242(0x17f),'YAaWl':'free-to-see','OQjnI':_0x3ef242(0x206),'bsevC':'members','selke':_0x3ef242(0x21e),'unMhG':_0x3ef242(0xf1),'GcCKZ':_0x3ef242(0x160),'jYoKQ':_0x3ef242(0x165),'jqlAU':function(_0x108469,_0x7ab3a2){return _0x108469(_0x7ab3a2);},'hvQVw':'WHxjQ','OhcCP':_0x3ef242(0x1f6),'Yqeaw':'transient_id','VEPPJ':function(_0x362166,_0x53bd65){return _0x362166(_0x53bd65);},'FeVsv':function(_0x4f69af,_0x4df7f0,_0x51fb22){return _0x4f69af(_0x4df7f0,_0x51fb22);},'FfUnS':'by\x20default\x20only\x20destroys\x20current\x20session','NaNGS':function(_0x26fac4,_0x1bdfca,_0x3e4133){return _0x26fac4(_0x1bdfca,_0x3e4133);},'QuVXe':_0x3ef242(0x18f),'RFbeH':_0x3ef242(0x1c9),'zHAzu':function(_0x5f77b5,_0x533a40){return _0x5f77b5(_0x533a40);},'wrEyh':_0x3ef242(0x23d),'kSXaD':function(_0x453384,_0x1f7bcc){return _0x453384(_0x1f7bcc);},'eiAbr':'cannot\x20read\x20label-only\x20post\x20content','zpERg':'can\x20read\x20product-only\x20post\x20content','EsXTh':'KkUdE','AzdSR':'/thou-shalt-be-paid-for/','FpleT':_0x3ef242(0x172),'Fbnri':function(_0x41568d,_0x1065fc,_0x1dde69){return _0x41568d(_0x1065fc,_0x1dde69);},'mgnnW':function(_0x445184,_0x1b9e25){return _0x445184(_0x1b9e25);},'TqCIj':'set-cookie','nLbQX':_0x3ef242(0x189),'jdUOc':_0x3ef242(0x1b0),'Krorj':_0x3ef242(0x233),'gFCrK':_0x3ef242(0x100),'GEFBU':_0x3ef242(0x1ad),'FgrrF':function(_0x5da3e0,_0xacc2e4){return _0x5da3e0(_0xacc2e4);},'btUKu':_0x3ef242(0x20d),'PhWHK':function(_0x567296,_0x31d78c,_0x5c078f){return _0x567296(_0x31d78c,_0x5c078f);},'bBfFn':_0x3ef242(0x13f),'ZzbFc':_0x3ef242(0xbe),'faMwX':function(_0x5ca496,_0x484a8f,_0xa29ea4){return _0x5ca496(_0x484a8f,_0xa29ea4);},'KbZgQ':_0x3ef242(0xc4),'QkQqA':_0x3ef242(0x1b7),'mUpFd':function(_0x4493cc,_0x3f6da0){return _0x4493cc(_0x3f6da0);},'Izint':function(_0x4694b8,_0x3de2f5){return _0x4694b8(_0x3de2f5);},'HmHmp':_0x3ef242(0x1e4)};let _0xa7dc0f;async function _0x39148a(_0x77c588){const _0x52db82=_0x3ef242,_0x101b41=await models[_0x52db82(0x238)][_0x52db82(0xf8)]({'email':_0x77c588},{'require':!![]}),_0x1a6305=_0x331bc4['alrNc'](require,_0x331bc4['ORawZ']),_0x5dced7=await _0x1a6305[_0x52db82(0x177)][_0x52db82(0x20b)](_0x77c588,_0x52db82(0x1b0)),_0x5409c1=new URL(_0x5dced7),_0x342f00=''+_0x5409c1['pathname']+_0x5409c1[_0x52db82(0x1a1)];return await _0xa7dc0f[_0x52db82(0x118)](_0x342f00)[_0x52db82(0x23f)](0x12e)['expect'](_0xfc3202=>{const _0x2a31ac=_0x52db82,_0x2d0747=new URL(_0xfc3202[_0x2a31ac(0x21f)][_0x2a31ac(0x1d4)],testUtils['API']['getURL']());should[_0x2a31ac(0x1c0)](_0x2d0747[_0x2a31ac(0x21a)][_0x2a31ac(0x118)](_0x2a31ac(0x25d))),_0x2d0747['searchParams']['get'](_0x2a31ac(0x25d))[_0x2a31ac(0x125)][_0x2a31ac(0x250)](_0x331bc4[_0x2a31ac(0x1cf)]);}),_0x101b41;}_0x331bc4[_0x3ef242(0x1aa)](before,async function(){const _0x4fc9a3=_0x3ef242,_0x47b8c3={'UVmdg':function(_0x3249e9,_0x512538){return _0x331bc4['FCMwf'](_0x3249e9,_0x512538);},'AlwCy':_0x331bc4[_0x4fc9a3(0x237)],'TAgxH':_0x331bc4[_0x4fc9a3(0x136)],'aPzKU':function(_0x5bdfd6,_0x2d3595){return _0x5bdfd6===_0x2d3595;},'KJflP':function(_0x30e9e1,_0x2b636f,_0x2e9da9){return _0x30e9e1(_0x2b636f,_0x2e9da9);}},_0xff8632=settingsCache[_0x4fc9a3(0x118)];sinon[_0x4fc9a3(0x1bd)](settingsCache,'get')[_0x4fc9a3(0x23c)](function(_0x42fd82,_0x47d4e6){const _0x4fe29e=_0x4fc9a3;if(_0x47b8c3[_0x4fe29e(0x22f)](_0x47b8c3[_0x4fe29e(0x208)],_0x47b8c3[_0x4fe29e(0x152)])){if(_0x42fd82==='labs')return{'members':!![]};if(_0x47b8c3[_0x4fe29e(0x175)](_0x42fd82,_0x4fe29e(0x1d2)))return _0x4fe29e(0x1e6);return _0x47b8c3[_0x4fe29e(0x122)](_0xff8632,_0x42fd82,_0x47d4e6);}else _0x3d0c77[_0x4fe29e(0x10b)]();}),await testUtils[_0x4fc9a3(0x24f)]({'copyThemes':!![]}),await testUtils['initFixtures']('newsletters',_0x4fc9a3(0xf4)),_0xa7dc0f=supertest[_0x4fc9a3(0x219)](configUtils[_0x4fc9a3(0x25b)][_0x4fc9a3(0x118)](_0x331bc4[_0x4fc9a3(0x143)]));}),_0x331bc4[_0x3ef242(0xc7)](after,function(){const _0x5da380=_0x3ef242;sinon[_0x5da380(0x10b)]();}),_0x331bc4[_0x3ef242(0xc6)](describe,_0x3ef242(0x236),function(){const _0x316b1a=_0x3ef242,_0x271105={'dswpK':_0x331bc4[_0x316b1a(0x176)],'WUXUL':_0x331bc4['zBBhQ'],'IXDpt':_0x316b1a(0x18c),'fSABW':function(_0x761dde,_0x4ef509){return _0x761dde===_0x4ef509;},'dbOnS':_0x316b1a(0x214),'XCuWl':_0x331bc4[_0x316b1a(0x1a2)],'EnIhk':'invalid','tTzCA':_0x331bc4[_0x316b1a(0x1db)],'fVhcV':_0x331bc4[_0x316b1a(0x1f8)],'gGcIO':_0x331bc4['GxvXf'],'aFPSw':_0x316b1a(0x1e6),'MlRXo':function(_0x1f051,_0x3bf547){return _0x1f051!==_0x3bf547;},'JMmSO':_0x331bc4['ynyUG'],'ppugz':_0x316b1a(0x104),'DVDKb':_0x331bc4[_0x316b1a(0x18a)],'RmcvO':_0x331bc4[_0x316b1a(0x265)],'MOngc':_0x316b1a(0x128),'ehjoL':_0x331bc4[_0x316b1a(0x1ca)],'lxgcI':_0x331bc4[_0x316b1a(0x10d)],'OMNII':_0x316b1a(0x1dc),'aUeja':_0x316b1a(0x249)};_0x331bc4['WHnYZ'](_0x316b1a(0x1bc),_0x331bc4['zuSkX'])?(_0x331bc4[_0x316b1a(0x1b5)](it,_0x316b1a(0xd9),async function(){const _0x19ad65=_0x316b1a;if(_0x331bc4[_0x19ad65(0xfa)]!==_0x331bc4[_0x19ad65(0x142)])await _0xa7dc0f[_0x19ad65(0xdc)](_0x19ad65(0x1e8))['expect'](0x190);else{const _0x1a075b=new _0x5a4aaf(_0x3007a4[_0x19ad65(0x21f)][_0x19ad65(0x1d4)],_0xdc99d7[_0x19ad65(0xd4)][_0x19ad65(0x1d8)]());_0x1fb761[_0x19ad65(0x1c0)](_0x1a075b[_0x19ad65(0x21a)]['get'](_0x271105[_0x19ad65(0x102)])),_0x1a075b[_0x19ad65(0x21a)][_0x19ad65(0x118)](_0x271105[_0x19ad65(0x102)])[_0x19ad65(0x125)][_0x19ad65(0x250)](_0x19ad65(0x14c));}}),it(_0x331bc4[_0x316b1a(0x10f)],async function(){const _0x419c4e=_0x316b1a;await _0xa7dc0f[_0x419c4e(0xdc)]('/members/webhooks/stripe')[_0x419c4e(0x109)](_0x271105[_0x419c4e(0x1b1)],'test-invalid-signature')[_0x419c4e(0x23f)](0x191);}),it(_0x316b1a(0x12f),async function(){const _0x114aaf=_0x316b1a;await _0xa7dc0f[_0x114aaf(0x118)](_0x331bc4['ofmtg'])[_0x114aaf(0x23f)](0xcc);}),it(_0x331bc4['bpxZw'],async function(){const _0x48da65=_0x316b1a;await _0xa7dc0f['del'](_0x331bc4['ofmtg'])[_0x48da65(0x23f)]('set-cookie',/ghost-members-ssr=.*;.*?expires=Thu, 01 Jan 1970 00:00:00 GMT;.*?/)[_0x48da65(0x23f)](0xcc);}),_0x331bc4[_0x316b1a(0xc6)](it,_0x331bc4[_0x316b1a(0x1fe)],async function(){const _0x27ad68=_0x316b1a;await _0xa7dc0f[_0x27ad68(0x118)]('/members/api/member')['expect'](0xcc);}),it(_0x331bc4['UsCKd'],async function(){const _0x225087=_0x316b1a;await _0xa7dc0f[_0x225087(0xdc)](_0x271105[_0x225087(0x22c)])[_0x225087(0x23f)](0x190);}),_0x331bc4[_0x316b1a(0x179)](it,'should\x20error\x20for\x20invalid\x20data\x20on\x20members\x20create\x20checkout\x20session\x20endpoint',async function(){const _0x78120a=_0x316b1a;_0x271105[_0x78120a(0x1ee)](_0x271105[_0x78120a(0xd8)],_0x271105[_0x78120a(0xd8)])?await _0xa7dc0f['post'](_0x271105[_0x78120a(0x217)])[_0x78120a(0x23f)](0x190):_0x63560[_0x78120a(0x10b)]();}),_0x331bc4[_0x316b1a(0x1b5)](it,_0x331bc4[_0x316b1a(0x200)],async function(){const _0x4d0b03=_0x316b1a;await _0xa7dc0f['post'](_0x4d0b03(0xed))[_0x4d0b03(0xde)]({'offerId':_0x271105[_0x4d0b03(0x192)],'identity':null,'metadata':{'name':_0x4d0b03(0x14d)},'cancelUrl':_0x271105[_0x4d0b03(0x127)],'customerEmail':_0x271105['fVhcV'],'tierId':null,'cadence':null})['expect'](0x190);}),it(_0x331bc4['bnYGp'],async function(){const _0x1fee91=_0x316b1a;await _0xa7dc0f[_0x1fee91(0xdc)](_0x1fee91(0xfe))['expect'](0x190);}),_0x331bc4[_0x316b1a(0x264)](it,'should\x20error\x20for\x20invalid\x20subscription\x20id\x20on\x20members\x20create\x20update\x20session\x20endpoint',async function(){const _0x65f8f7=_0x316b1a,_0x17c6ba=require(_0x65f8f7(0x197)),_0x3aca63='test-member-create-update-session@email.com',_0x5b18d6=await _0x17c6ba[_0x65f8f7(0x177)]['members'][_0x65f8f7(0x194)]({'email':_0x3aca63}),_0x130be0=await _0x17c6ba[_0x65f8f7(0x177)][_0x65f8f7(0x263)](_0x5b18d6[_0x65f8f7(0x118)](_0x65f8f7(0x1ab)));await _0xa7dc0f[_0x65f8f7(0xdc)](_0x331bc4[_0x65f8f7(0x1c3)])[_0x65f8f7(0xde)]({'identity':_0x130be0,'subscription_id':_0x331bc4[_0x65f8f7(0x204)]})[_0x65f8f7(0x23f)](0x194)[_0x65f8f7(0x23f)](_0x331bc4[_0x65f8f7(0x10d)],_0x331bc4[_0x65f8f7(0x261)])[_0x65f8f7(0x23f)](_0x2f5403=>{const _0xed5edc=_0x65f8f7;_0x2f5403[_0xed5edc(0x12b)]['should'][_0xed5edc(0x250)](_0x271105[_0xed5edc(0xac)]);});}),it(_0x331bc4['IxEzg'],async function(){const _0x5346b5=_0x316b1a;if(_0x271105[_0x5346b5(0x188)](_0x271105['JMmSO'],'LCear'))await _0xa7dc0f['put'](_0x5346b5(0xcb))['expect'](0x190);else return _0x271105[_0x5346b5(0x211)];}),_0x331bc4['nDGTN'](describe,'Newsletters',function(){const _0x3b2a5b=_0x316b1a,_0x1ae375={'Idnjy':_0x331bc4[_0x3b2a5b(0x259)],'GTZxL':_0x3b2a5b(0xc3),'tCMQQ':function(_0x1ac761){return _0x1ac761();},'XRztO':_0x3b2a5b(0x165),'NoDfb':function(_0x112a0f){return _0x112a0f();},'oSNNg':_0x331bc4[_0x3b2a5b(0x159)],'kNyvr':'members','kFvjT':_0x331bc4[_0x3b2a5b(0x251)],'xuSLF':_0x331bc4[_0x3b2a5b(0xb3)],'VgiqU':function(_0x168807){const _0x244d1f=_0x3b2a5b;return _0x331bc4[_0x244d1f(0xf2)](_0x168807);},'CiucB':_0x331bc4[_0x3b2a5b(0x112)],'PISTD':'public','elNIK':function(_0x22644a,_0x591edf){const _0x4b98cf=_0x3b2a5b;return _0x331bc4[_0x4b98cf(0x209)](_0x22644a,_0x591edf);},'sIxiK':_0x331bc4[_0x3b2a5b(0x12a)],'zmNQG':'getMembersValidationKey','fhSGX':_0x331bc4[_0x3b2a5b(0x265)],'TWgjD':_0x3b2a5b(0x221),'jFIXh':_0x3b2a5b(0x19c),'jbWnk':_0x3b2a5b(0x1a3),'ytUEh':'description','Vwunm':_0x331bc4[_0x3b2a5b(0x15f)],'aBlsz':'cannot\x20change\x20me','YOZGL':_0x331bc4['mSVIx'],'NYZQs':'newsletters'};afterEach(function(){const _0x2f551b=_0x3b2a5b;sinon[_0x2f551b(0x10b)]();}),_0x331bc4[_0x3b2a5b(0x179)](it,_0x331bc4[_0x3b2a5b(0x114)],async function(){const _0x50b15f=_0x3b2a5b;await _0xa7dc0f[_0x50b15f(0x118)](_0x271105['ppugz'])[_0x50b15f(0x23f)](0x191);}),it(_0x331bc4['nMLrD'],async function(){const _0x410879=_0x3b2a5b;await _0xa7dc0f[_0x410879(0x118)](_0x410879(0xc5))['expect'](0x191);}),it(_0x331bc4[_0x3b2a5b(0x201)],async function(){const _0x53c081=_0x3b2a5b;await _0xa7dc0f[_0x53c081(0xbd)](_0x53c081(0x104))[_0x53c081(0x23f)](0x191);}),it(_0x3b2a5b(0x156),async function(){const _0x45f179=_0x3b2a5b;await _0xa7dc0f['put'](_0x45f179(0xc5))[_0x45f179(0x23f)](0x191);}),_0x331bc4[_0x3b2a5b(0x179)](it,_0x331bc4['vbidr'],async function(){const _0x53bd6c=_0x3b2a5b;if(_0x1ae375[_0x53bd6c(0x205)](_0x1ae375[_0x53bd6c(0x167)],_0x53bd6c(0x1c4)))sinon['stub'](settingsHelpers,_0x1ae375[_0x53bd6c(0x124)])[_0x53bd6c(0x17b)](_0x53bd6c(0x1c5)),await _0xa7dc0f[_0x53bd6c(0x118)](_0x53bd6c(0xc5))[_0x53bd6c(0x23f)](0x191);else{const _0x44a353=_0x1ae375[_0x53bd6c(0x108)]['split']('|');let _0x54300a=0x0;while(!![]){switch(_0x44a353[_0x54300a++]){case'0':_0x502d84=_0x172497['DataGenerator'][_0x53bd6c(0x1b4)][_0x53bd6c(0x20e)]({'slug':_0x1ae375[_0x53bd6c(0x123)],'visibility':_0x53bd6c(0x160),'published_at':_0x1ae375[_0x53bd6c(0x240)](_0x33162f)[_0x53bd6c(0x262)]()});continue;case'1':_0x236abb=_0x46ab13['DataGenerator'][_0x53bd6c(0x1b4)][_0x53bd6c(0x20e)]({'slug':_0x53bd6c(0x147),'visibility':_0x1ae375[_0x53bd6c(0x15c)],'published_at':_0x1ae375[_0x53bd6c(0x24d)](_0x5b59f4)[_0x53bd6c(0x262)]()});continue;case'2':_0x1c5c61=_0x599fce[_0x53bd6c(0x10e)][_0x53bd6c(0x1b4)]['createPost']({'slug':_0x1ae375[_0x53bd6c(0x24c)],'visibility':_0x1ae375[_0x53bd6c(0x216)],'mobiledoc':_0x53bd6c(0x21e),'html':_0x53bd6c(0xf1),'published_at':_0x3a3f90()[_0x53bd6c(0x23e)](0x5,_0x1ae375['kFvjT'])[_0x53bd6c(0x262)]()});continue;case'3':return _0x193d44[_0x53bd6c(0xfd)][_0x53bd6c(0x153)]([_0x5202fd,_0x5d7112,_0x20324e,_0x4290b4,_0x24c083,_0x5acc31]);case'4':_0x312304=_0x5ebcdb[_0x53bd6c(0x10e)][_0x53bd6c(0x1b4)][_0x53bd6c(0x20e)]({'slug':_0x1ae375['xuSLF'],'visibility':_0x53bd6c(0x1d1),'published_at':_0x1ae375[_0x53bd6c(0x15b)](_0xb84266)[_0x53bd6c(0x23e)](0x2d,'seconds')[_0x53bd6c(0x262)]()});continue;case'5':_0x31ff7f=_0xe7cd3d[_0x53bd6c(0x10e)][_0x53bd6c(0x1b4)][_0x53bd6c(0x20e)]({'slug':_0x1ae375['CiucB'],'visibility':_0x53bd6c(0x1fc),'published_at':_0x1ce472()[_0x53bd6c(0x23e)](0x1e,_0x53bd6c(0x1b9))[_0x53bd6c(0x262)]()});continue;case'6':_0x465b55=_0x23ac0a[_0x53bd6c(0x10e)]['forKnex'][_0x53bd6c(0x20e)]({'slug':_0x53bd6c(0x1a9),'visibility':_0x1ae375['PISTD'],'published_at':_0x4e78ce()[_0x53bd6c(0x23e)](0xf,_0x1ae375[_0x53bd6c(0x267)])[_0x53bd6c(0x262)]()});continue;}break;}}}),_0x331bc4[_0x3b2a5b(0xe1)](it,_0x331bc4[_0x3b2a5b(0xd5)],async function(){const _0x557474=_0x3b2a5b;sinon['stub'](settingsHelpers,_0x557474(0xb2))[_0x557474(0x17b)](_0x557474(0x1c5)),await _0xa7dc0f[_0x557474(0x118)]('/members/api/member/newsletters?uuid=abc&key=blah')[_0x557474(0x23f)](0x191);}),it(_0x3b2a5b(0x17d),async function(){const _0x339362=_0x3b2a5b;sinon['stub'](settingsHelpers,_0x271105[_0x339362(0xb6)])['returns'](_0x271105[_0x339362(0x1f5)]),await _0xa7dc0f[_0x339362(0xbd)](_0x271105[_0x339362(0x139)])['expect'](0x191);}),it('should\x20fetch\x20and\x20update\x20member\x20newsletters\x20with\x20valid\x20uuid',async function(){const _0x76db81=_0x3b2a5b,_0x1b489d=DataGenerator[_0x76db81(0x174)][_0x76db81(0x1d1)][0x0]['uuid'];sinon[_0x76db81(0x1bd)](settingsHelpers,_0x1ae375[_0x76db81(0x124)])[_0x76db81(0x17b)](_0x1ae375[_0x76db81(0x1d7)]);const _0x2d4d4d=crypto[_0x76db81(0x157)](_0x76db81(0xd6),_0x76db81(0x1c5))[_0x76db81(0x1a5)](_0x1b489d)['digest'](_0x76db81(0x11f)),_0x305638=await _0xa7dc0f[_0x76db81(0x118)](_0x76db81(0x1af)+_0x1b489d+_0x76db81(0x158)+_0x2d4d4d)[_0x76db81(0x23f)](0xc8),_0x285034=_0x305638['body'];should[_0x76db81(0x1c0)](_0x285034),_0x285034['should'][_0x76db81(0x17a)][_0x76db81(0x140)]([_0x1ae375[_0x76db81(0x1be)],_0x1ae375[_0x76db81(0x12c)],'status',_0x76db81(0x1a3),'newsletters']),_0x285034[_0x76db81(0x125)][_0x76db81(0xb0)][_0x76db81(0x17a)][_0x76db81(0x203)]('id'),_0x285034['newsletters'][_0x76db81(0x125)][_0x76db81(0x17a)][_0x76db81(0xcd)](0x1),Object['keys'](_0x285034['newsletters'][0x0])[_0x76db81(0x125)][_0x76db81(0x17a)]['length'](0x5),_0x285034[_0x76db81(0x12e)][0x0][_0x76db81(0x125)]['have'][_0x76db81(0x140)](['id',_0x76db81(0x19c),_0x1ae375['jbWnk'],_0x1ae375['ytUEh'],_0x1ae375[_0x76db81(0x11c)]]);const _0x1f173d=_0x285034['newsletters'],_0x39272b=_0x1f173d[0x0][_0x76db81(0x1a3)];_0x1f173d[0x0][_0x76db81(0x1a3)]=_0x1ae375[_0x76db81(0x1b2)];const _0x59d1c1=await _0xa7dc0f[_0x76db81(0xbd)](_0x76db81(0x1af)+_0x1b489d+_0x76db81(0x158)+_0x2d4d4d)[_0x76db81(0xde)]({'newsletters':[]})[_0x76db81(0x23f)](0xc8),_0x2e29de=_0x59d1c1[_0x76db81(0x1f2)];should[_0x76db81(0x1c0)](_0x2e29de),_0x2e29de[_0x76db81(0x125)][_0x76db81(0x17a)][_0x76db81(0x140)]([_0x1ae375[_0x76db81(0x1be)],_0x76db81(0x19c),_0x76db81(0x24a),_0x76db81(0x1a3),_0x76db81(0x12e)]),_0x2e29de[_0x76db81(0x125)]['not'][_0x76db81(0x17a)][_0x76db81(0x203)]('id'),_0x2e29de[_0x76db81(0x12e)][_0x76db81(0x125)][_0x76db81(0x17a)][_0x76db81(0xcd)](0x0);const _0x2eba19=await _0xa7dc0f[_0x76db81(0xbd)]('/members/api/member/newsletters?uuid='+_0x1b489d+_0x76db81(0x158)+_0x2d4d4d)[_0x76db81(0xde)]({'newsletters':_0x1f173d})[_0x76db81(0x23f)](0xc8),_0x7bd326=_0x2eba19[_0x76db81(0x1f2)];should[_0x76db81(0x1c0)](_0x7bd326),_0x7bd326[_0x76db81(0x125)][_0x76db81(0x17a)][_0x76db81(0x140)]([_0x1ae375[_0x76db81(0x1be)],'uuid',_0x1ae375[_0x76db81(0x19b)],_0x1ae375['jbWnk'],_0x1ae375[_0x76db81(0x170)]]),_0x7bd326[_0x76db81(0x125)]['not']['have']['property']('id'),_0x7bd326['newsletters'][_0x76db81(0x125)][_0x76db81(0x17a)]['length'](0x1),Object[_0x76db81(0xfc)](_0x7bd326[_0x76db81(0x12e)][0x0])[_0x76db81(0x125)][_0x76db81(0x17a)][_0x76db81(0xcd)](0x5),_0x7bd326[_0x76db81(0x12e)][0x0][_0x76db81(0x125)][_0x76db81(0x17a)]['properties'](['id',_0x1ae375['jFIXh'],_0x1ae375[_0x76db81(0x169)],_0x1ae375['ytUEh'],'sort_order']),should[_0x76db81(0x1a8)](_0x7bd326[_0x76db81(0x12e)][0x0][_0x76db81(0x1a3)],_0x39272b);});}),_0x331bc4['GFCWo'](it,_0x316b1a(0x24b),async function(){const _0x5d49d0=_0x316b1a;await _0xa7dc0f[_0x5d49d0(0x118)](_0x271105['ehjoL'])[_0x5d49d0(0x23f)](0x194)[_0x5d49d0(0x23f)](_0x271105[_0x5d49d0(0x1ff)],_0x271105[_0x5d49d0(0x1ed)]);}),_0x331bc4[_0x316b1a(0x1f4)](it,_0x331bc4[_0x316b1a(0x244)],async function(){const _0x2d6589=_0x316b1a;await _0xa7dc0f[_0x2d6589(0x118)](_0x271105[_0x2d6589(0x222)])[_0x2d6589(0x23f)](0x12e)['expect'](_0x2d6589(0x154),_0x2d6589(0x161));})):_0x401a7a['text'][_0x316b1a(0x125)]['not']['containEql'](_0x331bc4[_0x316b1a(0x1c7)]);}),_0x331bc4['WCuye'](describe,_0x331bc4[_0x3ef242(0x1c2)],function(){const _0x10478e=_0x3ef242,_0x5db3a8={'NnlCc':_0x331bc4['PqsML'],'YZbGw':function(_0x1ebb51,_0x3fdd31){return _0x1ebb51===_0x3fdd31;},'oFpzf':_0x10478e(0xfb),'HWkAv':_0x10478e(0x12e),'PMjij':_0x331bc4[_0x10478e(0x1f7)],'yjjhg':'therealkey','uTBbq':_0x10478e(0xe4),'DZaEI':_0x331bc4[_0x10478e(0x18a)],'HlSdj':_0x10478e(0x1c5),'oZWCL':_0x331bc4[_0x10478e(0x1bb)],'hpSaz':_0x331bc4[_0x10478e(0x1c6)]};if(_0x10478e(0x191)===_0x331bc4[_0x10478e(0x1ce)]){if(_0x331bc4[_0x10478e(0x209)](_0x4f5b54,'labs'))return{'members':!![]};if(_0x4156a0===_0x331bc4[_0x10478e(0xee)])return _0x331bc4[_0x10478e(0x182)];return _0x513212(_0x2a5c2a,_0xd72ea7);}else afterEach(function(){const _0x10e24e=_0x10478e;sinon[_0x10e24e(0x10b)]();}),_0x331bc4[_0x10478e(0x120)](it,_0x331bc4['YlJAv'],async function(){const _0x27fdc5=_0x10478e;await _0xa7dc0f[_0x27fdc5(0x118)](_0x331bc4[_0x27fdc5(0x196)])[_0x27fdc5(0x23f)](0x12e)['expect'](_0x331bc4['aOvmK'],'http://127.0.0.1:2369/?uuid=XXX&action=unsubscribe');}),it(_0x10478e(0x212),async function(){const _0x545f82=_0x10478e;await _0xa7dc0f['get'](_0x5db3a8['NnlCc'])['expect'](0x12e)['expect'](_0x545f82(0x154),_0x545f82(0x11d));}),it(_0x331bc4[_0x10478e(0x138)],async function(){const _0x13f731=_0x10478e;_0x13f731(0x18d)!==_0x331bc4['NSjEk']?_0x53f9e1[_0x13f731(0x12b)][_0x13f731(0x125)][_0x13f731(0x250)](_0x13f731(0x164)):await _0xa7dc0f['get'](_0x331bc4[_0x13f731(0xe7)])[_0x13f731(0x23f)](0x12e)[_0x13f731(0x23f)]('Location',_0x13f731(0x13c));}),_0x331bc4[_0x10478e(0x181)](it,_0x331bc4[_0x10478e(0x171)],async function(){const _0x4cfad9=_0x10478e;await _0xa7dc0f[_0x4cfad9(0x118)](_0x331bc4['UXkEC'])[_0x4cfad9(0x23f)](0x190);}),it(_0x331bc4[_0x10478e(0x210)],async function(){const _0x1d5479=_0x10478e;if(_0x5db3a8[_0x1d5479(0x248)](_0x1d5479(0x1ec),_0x5db3a8['oFpzf']))_0x136966[_0x1d5479(0x12b)]['should'][_0x1d5479(0xec)](_0x1d5479(0xc9));else{const _0x41ae0b=fixtureManager[_0x1d5479(0x118)](_0x5db3a8[_0x1d5479(0x23b)],0x0)['id'],_0x13036d=await createMember({'email':_0x5db3a8[_0x1d5479(0x145)],'newsletters':[{'id':_0x41ae0b}]}),_0x5e2ebd=_0x13036d[_0x1d5479(0x118)]('uuid');sinon[_0x1d5479(0x1bd)](settingsHelpers,'getMembersValidationKey')[_0x1d5479(0x17b)](_0x5db3a8[_0x1d5479(0x268)]);const _0x4c30a1=crypto[_0x1d5479(0x157)](_0x1d5479(0xd6),_0x5db3a8[_0x1d5479(0xd3)])[_0x1d5479(0x1a5)](_0x5e2ebd)[_0x1d5479(0xc8)](_0x1d5479(0x11f));await _0xa7dc0f['get'](_0x1d5479(0x1af)+_0x5e2ebd+_0x1d5479(0x158)+_0x4c30a1)['expect'](0x191);}}),_0x331bc4[_0x10478e(0x111)](it,_0x331bc4[_0x10478e(0x14f)],async function(){const _0x5be684=_0x10478e,_0x202dbb=fixtureManager[_0x5be684(0x118)](_0x331bc4[_0x5be684(0x266)],0x0)['id'],_0xaf4c78=await createMember({'email':_0x5be684(0x180),'newsletters':[{'id':_0x202dbb}]}),_0x40312b=_0xaf4c78[_0x5be684(0x118)]('uuid');sinon[_0x5be684(0x1bd)](settingsHelpers,_0x5be684(0xb2))['returns']('test');const _0x28c99e=crypto[_0x5be684(0x157)](_0x331bc4['tsuDP'],_0x331bc4['VgkuB'])[_0x5be684(0x1a5)](_0x40312b)['digest'](_0x331bc4['WCFOF']);let _0x3f8b3a=await _0xa7dc0f['get']('/members/api/member/newsletters?uuid='+_0x40312b+_0x5be684(0x158)+_0x28c99e)[_0x5be684(0x23f)](0xc8),_0x1bbd9d=_0x3f8b3a[_0x5be684(0x1f2)];assert[_0x5be684(0x1a8)](_0x1bbd9d[_0x5be684(0x12e)][_0x5be684(0xcd)],0x1),await _0xa7dc0f[_0x5be684(0xdc)](_0x5be684(0x11b)+_0x40312b+_0x5be684(0x158)+_0x28c99e)['expect'](0xc9),_0x3f8b3a=await _0xa7dc0f[_0x5be684(0x118)](_0x5be684(0x1af)+_0x40312b+_0x5be684(0x158)+_0x28c99e)['expect'](0xc8),_0x1bbd9d=_0x3f8b3a[_0x5be684(0x1f2)],assert[_0x5be684(0x1a8)](_0x1bbd9d[_0x5be684(0x12e)]['length'],0x0,'Sending\x20a\x20POST\x20request\x20to\x20the\x20unsubscribe\x20endpoint\x20should\x20unsubscribe\x20the\x20member');}),it(_0x10478e(0x150),async function(){const _0x54d46c=_0x10478e,_0x58fb9d=fixtureManager[_0x54d46c(0x118)](_0x54d46c(0x12e),0x0)['id'],_0x4da69d=fixtureManager[_0x54d46c(0x118)](_0x331bc4[_0x54d46c(0x266)],0x1)['id'],_0x3b63bc=fixtureManager[_0x54d46c(0x118)]('newsletters',0x1)[_0x54d46c(0x19c)],_0x58bb0f=await _0x331bc4[_0x54d46c(0x1e3)](createMember,{'email':_0x331bc4[_0x54d46c(0x11e)],'newsletters':[{'id':_0x58fb9d},{'id':_0x4da69d}]}),_0x394fa3=_0x58bb0f[_0x54d46c(0x118)](_0x331bc4[_0x54d46c(0xf9)]);sinon[_0x54d46c(0x1bd)](settingsHelpers,'getMembersValidationKey')[_0x54d46c(0x17b)](_0x54d46c(0x1c5));const _0x4efad3=crypto[_0x54d46c(0x157)](_0x54d46c(0xd6),_0x331bc4[_0x54d46c(0x265)])[_0x54d46c(0x1a5)](_0x394fa3)['digest'](_0x54d46c(0x11f));let _0x2fd762=await _0xa7dc0f[_0x54d46c(0x118)]('/members/api/member/newsletters?uuid='+_0x394fa3+_0x54d46c(0x158)+_0x4efad3)[_0x54d46c(0x23f)](0xc8),_0x48ebd8=_0x2fd762[_0x54d46c(0x1f2)];assert[_0x54d46c(0x1a8)](_0x48ebd8[_0x54d46c(0x12e)][_0x54d46c(0xcd)],0x2),await _0xa7dc0f[_0x54d46c(0xdc)](_0x54d46c(0x11b)+_0x394fa3+_0x54d46c(0xf6)+_0x3b63bc+_0x54d46c(0x158)+_0x4efad3)[_0x54d46c(0x23f)](0xc9),_0x2fd762=await _0xa7dc0f[_0x54d46c(0x118)](_0x54d46c(0x1af)+_0x394fa3+'&key='+_0x4efad3)[_0x54d46c(0x23f)](0xc8),_0x48ebd8=_0x2fd762['body'],assert[_0x54d46c(0x1a8)](_0x48ebd8[_0x54d46c(0x12e)][_0x54d46c(0xcd)],0x1,_0x331bc4[_0x54d46c(0x1e1)]);}),_0x331bc4['ILVxe'](it,_0x331bc4[_0x10478e(0xc2)],async function(){const _0x18f181=_0x10478e,_0x54e194=fixtureManager[_0x18f181(0x118)](_0x18f181(0x12e),0x0)['id'],_0x309ca6=await createMember({'email':'unsubscribe-member-test-3@example.com','newsletters':[{'id':_0x54e194}],'enable_comment_notifications':!![]}),_0x9210f2=_0x309ca6[_0x18f181(0x118)]('uuid');sinon['stub'](settingsHelpers,_0x5db3a8[_0x18f181(0x163)])['returns'](_0x5db3a8[_0x18f181(0x235)]);const _0xf892d4=crypto['createHmac'](_0x5db3a8[_0x18f181(0xaf)],_0x18f181(0x1c5))[_0x18f181(0x1a5)](_0x9210f2)['digest'](_0x5db3a8[_0x18f181(0x245)]);let _0x3188e7=await _0xa7dc0f[_0x18f181(0x118)]('/members/api/member/newsletters?uuid='+_0x9210f2+_0x18f181(0x158)+_0xf892d4)[_0x18f181(0x23f)](0xc8),_0x4f03a3=_0x3188e7['body'];assert[_0x18f181(0x1a8)](_0x4f03a3[_0x18f181(0x12e)][_0x18f181(0xcd)],0x1),await _0xa7dc0f[_0x18f181(0xdc)](_0x18f181(0x11b)+_0x9210f2+_0x18f181(0x158)+_0xf892d4+_0x18f181(0x25a))[_0x18f181(0x23f)](0xc9);const _0x4fb42d=await members[_0x18f181(0x177)][_0x18f181(0x1d1)]['get']({'id':_0x309ca6['id']},{'withRelated':[_0x5db3a8[_0x18f181(0x23b)]]});assert['equal'](_0x4fb42d['get']('enable_comment_notifications'),![]),assert[_0x18f181(0x1a8)](_0x4fb42d[_0x18f181(0x20f)](_0x18f181(0x12e))[_0x18f181(0x1c8)][_0x18f181(0xcd)],0x1);}),it(_0x331bc4['mXFvG'],async function(){const _0x378bf2=_0x10478e,_0x53ce7a=fixtureManager[_0x378bf2(0x118)](_0x378bf2(0x12e),0x0)['id'],_0x48a819=await _0x331bc4['alrNc'](createMember,{'email':'unsubscribe-member-test-4@example.com','newsletters':[{'id':_0x53ce7a}]}),_0x293866=_0x48a819[_0x378bf2(0x118)](_0x331bc4[_0x378bf2(0xf9)]);sinon[_0x378bf2(0x1bd)](settingsHelpers,_0x378bf2(0xb2))[_0x378bf2(0x17b)](_0x331bc4[_0x378bf2(0x265)]);const _0x741e18=crypto[_0x378bf2(0x157)](_0x378bf2(0xd6),_0x378bf2(0x1c5))[_0x378bf2(0x1a5)](_0x293866)[_0x378bf2(0xc8)]('hex');let _0x24067c=await _0xa7dc0f['get'](_0x378bf2(0x1af)+_0x293866+_0x378bf2(0x158)+_0x741e18)[_0x378bf2(0x23f)](0xc8),_0x19ede4=_0x24067c[_0x378bf2(0x1f2)];assert[_0x378bf2(0x1a8)](_0x19ede4['newsletters'][_0x378bf2(0xcd)],0x1),await _0xa7dc0f[_0x378bf2(0xdc)]('/unsubscribe/?uuid='+_0x293866+_0x378bf2(0x158)+_0x741e18)[_0x378bf2(0xe6)](_0x331bc4[_0x378bf2(0x1cd)])[_0x378bf2(0xde)]({'List-Unsubscribe':_0x331bc4[_0x378bf2(0x1fb)]})['expect'](0xc9),_0x24067c=await _0xa7dc0f[_0x378bf2(0x118)](_0x378bf2(0x1af)+_0x293866+_0x378bf2(0x158)+_0x741e18)[_0x378bf2(0x23f)](0xc8),_0x19ede4=_0x24067c[_0x378bf2(0x1f2)],assert['equal'](_0x19ede4[_0x378bf2(0x12e)]['length'],0x0,_0x331bc4[_0x378bf2(0xe0)]);}),it(_0x10478e(0x226),async function(){const _0x26e8dc=_0x10478e,_0x47f440=fixtureManager['get'](_0x331bc4['oGMEu'],0x0)['id'],_0x38e441=await _0x331bc4[_0x26e8dc(0x1ac)](createMember,{'email':'unsubscribe-member-test-5@example.com','newsletters':[{'id':_0x47f440}]}),_0x6fd20e=_0x38e441[_0x26e8dc(0x118)](_0x331bc4[_0x26e8dc(0xf9)]);sinon['stub'](settingsHelpers,'getMembersValidationKey')['returns'](_0x331bc4[_0x26e8dc(0x265)]);const _0x27cf50=crypto['createHmac']('sha256',_0x26e8dc(0x1c5))[_0x26e8dc(0x1a5)](_0x6fd20e)[_0x26e8dc(0xc8)](_0x331bc4[_0x26e8dc(0x1c6)]);let _0x219b54=await _0xa7dc0f[_0x26e8dc(0x118)]('/members/api/member/newsletters?uuid='+_0x6fd20e+_0x26e8dc(0x158)+_0x27cf50)[_0x26e8dc(0x23f)](0xc8),_0xf99d44=_0x219b54[_0x26e8dc(0x1f2)];assert[_0x26e8dc(0x1a8)](_0xf99d44[_0x26e8dc(0x12e)]['length'],0x1),await _0xa7dc0f['post'](_0x26e8dc(0x11b)+_0x6fd20e+_0x26e8dc(0x158)+_0x27cf50)[_0x26e8dc(0xf0)](_0x331bc4[_0x26e8dc(0x132)],_0x331bc4['Gmgzf'])[_0x26e8dc(0x23f)](0xc9),_0x219b54=await _0xa7dc0f[_0x26e8dc(0x118)](_0x26e8dc(0x1af)+_0x6fd20e+_0x26e8dc(0x158)+_0x27cf50)['expect'](0xc8),_0xf99d44=_0x219b54[_0x26e8dc(0x1f2)],assert[_0x26e8dc(0x1a8)](_0xf99d44[_0x26e8dc(0x12e)][_0x26e8dc(0xcd)],0x0,_0x331bc4[_0x26e8dc(0xe0)]);});}),describe('Content\x20gating',function(){const _0x9df1c6=_0x3ef242,_0x19df63={'ylqYI':_0x9df1c6(0x1c9),'QSGJS':function(_0x1399fb,_0xf09244){const _0x17828e=_0x9df1c6;return _0x331bc4[_0x17828e(0x209)](_0x1399fb,_0xf09244);},'VVnLP':_0x331bc4[_0x9df1c6(0x166)],'VWbce':_0x331bc4['AzdSR'],'jrwoE':_0x9df1c6(0x16b),'Xrtzq':'/thou-must-have-default-product/','WTUvU':_0x9df1c6(0x1b3),'XVBVx':_0x331bc4[_0x9df1c6(0x1d0)],'kVzLZ':function(_0x4d379c,_0x280c94,_0x4f64ae){const _0x267733=_0x9df1c6;return _0x331bc4[_0x267733(0x1cc)](_0x4d379c,_0x280c94,_0x4f64ae);},'Gvibr':_0x9df1c6(0x1d5),'xpWls':function(_0x2244ff,_0x295aa6){const _0x1404b4=_0x9df1c6;return _0x331bc4[_0x1404b4(0x1e5)](_0x2244ff,_0x295aa6);},'QjFRs':_0x9df1c6(0x1ab),'CwqwL':_0x331bc4[_0x9df1c6(0xe3)],'GfScZ':_0x331bc4[_0x9df1c6(0x1f1)],'gOzmf':_0x9df1c6(0x1f6),'aJtxI':_0x331bc4[_0x9df1c6(0x23a)],'ggtrc':function(_0x1369e1,_0x5d5c02,_0x5894ae){return _0x1369e1(_0x5d5c02,_0x5894ae);},'HUviL':_0x9df1c6(0x24e),'OlaCE':_0x9df1c6(0x197),'ZdedE':_0x331bc4[_0x9df1c6(0x215)],'afeKS':_0x9df1c6(0x23d),'UtDPJ':_0x331bc4['Krorj'],'rqlNA':_0x9df1c6(0x155),'Bvngx':'A\x20page\x20view\x20from\x20a\x20member\x20should\x20generate\x20a\x20MemberPageViewEvent\x20event','ERPhD':_0x331bc4['gFCrK'],'YTdHE':_0x331bc4[_0x9df1c6(0xf9)],'qYlQX':_0x331bc4[_0x9df1c6(0x16c)],'nHtPE':function(_0x3ee169,_0x33eae8){const _0x56802e=_0x9df1c6;return _0x331bc4[_0x56802e(0x1a4)](_0x3ee169,_0x33eae8);},'EMBqG':_0x9df1c6(0x19f),'mSsHm':function(_0x3fc2aa,_0x34eaa5,_0x2e0bdb){const _0x1b109f=_0x9df1c6;return _0x331bc4[_0x1b109f(0x1b5)](_0x3fc2aa,_0x34eaa5,_0x2e0bdb);},'UoQik':_0x331bc4[_0x9df1c6(0x18e)],'OZvwG':_0x9df1c6(0x18b),'XbzPP':_0x331bc4[_0x9df1c6(0x20a)],'vjffd':_0x9df1c6(0x19e),'ZcFDc':_0x9df1c6(0xd0)};let _0x4d6d88,_0x2828dc,_0x142440,_0x478c7,_0x259417,_0x3b03e6;before(function(){const _0x286bf5=_0x9df1c6;return _0x4d6d88=testUtils[_0x286bf5(0x10e)]['forKnex'][_0x286bf5(0x20e)]({'slug':_0x331bc4['YAaWl'],'visibility':_0x331bc4[_0x286bf5(0xc1)],'published_at':moment()[_0x286bf5(0x23e)](0xf,'seconds')[_0x286bf5(0x262)]()}),_0x2828dc=testUtils[_0x286bf5(0x10e)][_0x286bf5(0x1b4)][_0x286bf5(0x20e)]({'slug':_0x331bc4[_0x286bf5(0xb3)],'visibility':_0x331bc4[_0x286bf5(0x135)],'published_at':moment()[_0x286bf5(0x23e)](0x2d,_0x331bc4[_0x286bf5(0x251)])[_0x286bf5(0x262)]()}),_0x142440=testUtils[_0x286bf5(0x10e)][_0x286bf5(0x1b4)][_0x286bf5(0x20e)]({'slug':_0x286bf5(0x19a),'visibility':_0x286bf5(0x1fc),'published_at':moment()[_0x286bf5(0x23e)](0x1e,_0x331bc4[_0x286bf5(0x251)])[_0x286bf5(0x262)]()}),_0x478c7=testUtils[_0x286bf5(0x10e)][_0x286bf5(0x1b4)][_0x286bf5(0x20e)]({'slug':'thou-shalt-have-a-taste','visibility':_0x286bf5(0x1d1),'mobiledoc':_0x331bc4[_0x286bf5(0x229)],'html':_0x331bc4[_0x286bf5(0x149)],'published_at':_0x331bc4[_0x286bf5(0xf2)](moment)['add'](0x5,_0x331bc4[_0x286bf5(0x251)])[_0x286bf5(0x262)]()}),_0x259417=testUtils['DataGenerator']['forKnex'][_0x286bf5(0x20e)]({'slug':'thou-must-be-labelled-vip','visibility':_0x331bc4[_0x286bf5(0x19d)],'published_at':moment()[_0x286bf5(0x262)]()}),_0x3b03e6=testUtils['DataGenerator']['forKnex']['createPost']({'slug':_0x286bf5(0x147),'visibility':_0x331bc4[_0x286bf5(0x255)],'published_at':moment()[_0x286bf5(0x262)]()}),testUtils[_0x286bf5(0xfd)][_0x286bf5(0x153)]([_0x4d6d88,_0x2828dc,_0x142440,_0x478c7,_0x259417,_0x3b03e6]);}),_0x331bc4[_0x9df1c6(0x133)](describe,_0x331bc4[_0x9df1c6(0x1f0)],function(){const _0x589e8f=_0x9df1c6,_0x559fa2={'pDipV':_0x589e8f(0x25d)};it('can\x20read\x20public\x20post\x20content',async function(){const _0x58ae9a=_0x589e8f;await _0xa7dc0f[_0x58ae9a(0x118)](_0x19df63[_0x58ae9a(0xd2)])['expect'](0xc8)['expect'](assertContentIsPresent);}),it(_0x19df63[_0x589e8f(0xeb)],async function(){const _0x1654af=_0x589e8f;await _0xa7dc0f[_0x1654af(0x118)](_0x1654af(0x23d))[_0x1654af(0x23f)](0xc8)['expect'](assertContentIsAbsent);}),it(_0x19df63[_0x589e8f(0x130)],async function(){const _0x139c80=_0x589e8f;if(_0x19df63['QSGJS'](_0x139c80(0x144),_0x19df63[_0x139c80(0xba)]))await _0xa7dc0f[_0x139c80(0x118)](_0x19df63[_0x139c80(0xdb)])[_0x139c80(0x23f)](0xc8)[_0x139c80(0x23f)](assertContentIsAbsent);else{const _0x532a57=new _0x1f2420(_0x2a97ab[_0x139c80(0x21f)][_0x139c80(0x1d4)],_0x58f8f3['API']['getURL']());_0x47c04f[_0x139c80(0x1c0)](_0x532a57['searchParams'][_0x139c80(0x118)](_0x559fa2[_0x139c80(0x10a)])),_0x532a57[_0x139c80(0x21a)][_0x139c80(0x118)](_0x559fa2[_0x139c80(0x10a)])[_0x139c80(0x125)]['eql'](_0x139c80(0x14c));}}),it(_0x589e8f(0x105),async function(){const _0x3f890c=_0x589e8f;await _0xa7dc0f[_0x3f890c(0x118)](_0x19df63[_0x3f890c(0x1a7)])['expect'](0xc8)['expect'](assertContentIsAbsent);}),_0x19df63[_0x589e8f(0xcc)](it,_0x589e8f(0x24e),async function(){const _0x2a42c5=_0x589e8f;await _0xa7dc0f[_0x2a42c5(0x118)](_0x19df63[_0x2a42c5(0xb5)])[_0x2a42c5(0x23f)](0xc8)[_0x2a42c5(0x23f)](assertContentIsAbsent);}),it(_0x19df63[_0x589e8f(0x243)],async function(){const _0x54a231=_0x589e8f,_0x284a96=sinon[_0x54a231(0x186)]();DomainEvents['subscribe'](MemberPageViewEvent,_0x284a96),await _0xa7dc0f[_0x54a231(0x118)](_0x19df63[_0x54a231(0xd2)])[_0x54a231(0x23f)](0xc8)[_0x54a231(0x23f)](assertContentIsPresent),assert(_0x284a96[_0x54a231(0x126)],'A\x20page\x20view\x20from\x20a\x20non-member\x20shouldn\x27t\x20generate\x20a\x20MemberPageViewEvent\x20event');});}),describe(_0x331bc4[_0x9df1c6(0x193)],function(){const _0x2d634e=_0x9df1c6,_0x5b881e={'COcsq':function(_0x27db12,_0x40e070){const _0x208400=_0x1896;return _0x331bc4[_0x208400(0xbf)](_0x27db12,_0x40e070);},'fnimA':_0x2d634e(0x189),'fHbBF':function(_0x225222,_0x2c4025){return _0x331bc4['vVyfI'](_0x225222,_0x2c4025);},'BSHsp':_0x2d634e(0x1ae),'eQwbr':_0x331bc4['hvQVw'],'ZKgHC':_0x2d634e(0x1e7),'lgenm':_0x331bc4[_0x2d634e(0xad)],'oXWaI':_0x331bc4[_0x2d634e(0xdf)],'calDi':_0x331bc4[_0x2d634e(0xe3)]};let _0x559a28;_0x331bc4[_0x2d634e(0xda)](beforeEach,async function(){const _0x746203=_0x2d634e;_0x559a28=await _0x5b881e['COcsq'](_0x39148a,_0x5b881e[_0x746203(0x1f3)]);}),_0x331bc4[_0x2d634e(0xe5)](it,_0x2d634e(0x20c),async function(){const _0x49f467=_0x2d634e;await _0xa7dc0f[_0x49f467(0x118)]('/members/api/member')['expect'](0xc8),await _0x19df63[_0x49f467(0x246)](cycleTransientId,{'id':_0x559a28['id']}),await _0x559a28[_0x49f467(0x199)]();const _0x42e101=_0x559a28[_0x49f467(0x118)](_0x19df63[_0x49f467(0xbb)]);await _0xa7dc0f['get'](_0x19df63[_0x49f467(0x25e)])[_0x49f467(0x23f)](_0x49f467(0x1e7),/ghost-members-ssr=.*;.*?expires=Thu, 01 Jan 1970 00:00:00 GMT;.*?/)[_0x49f467(0x23f)](0xcc),await _0xa7dc0f[_0x49f467(0x118)]('/members/api/member')[_0x49f467(0x23f)](0xcc),await _0x559a28['refresh'](),assert[_0x49f467(0x1a8)](_0x559a28[_0x49f467(0x118)](_0x19df63[_0x49f467(0xbb)]),_0x42e101);}),it(_0x331bc4[_0x2d634e(0xf3)],async function(){const _0x381520=_0x2d634e;if(_0x5b881e[_0x381520(0x25c)](_0x5b881e['BSHsp'],_0x5b881e[_0x381520(0x141)]))_0x5f2f62[_0x381520(0x10b)]();else{const _0x3904ea=_0x559a28[_0x381520(0x118)](_0x381520(0x1ab));await _0xa7dc0f[_0x381520(0x118)](_0x381520(0x1f6))[_0x381520(0x23f)](0xc8),await _0xa7dc0f['del'](_0x381520(0x1eb))[_0x381520(0x23f)](_0x5b881e[_0x381520(0x232)],/ghost-members-ssr=.*;.*?expires=Thu, 01 Jan 1970 00:00:00 GMT;.*?/)[_0x381520(0x23f)](0xcc),await _0xa7dc0f[_0x381520(0x118)](_0x5b881e[_0x381520(0x13d)])[_0x381520(0x23f)](0xcc),await _0x559a28[_0x381520(0x199)](),assert['equal'](_0x559a28['get'](_0x5b881e['oXWaI']),_0x3904ea);}}),_0x331bc4[_0x2d634e(0x137)](it,_0x331bc4[_0x2d634e(0x239)],async function(){const _0x5e25e1=_0x2d634e,_0x2c48e0=_0x559a28[_0x5e25e1(0x118)](_0x5e25e1(0x1ab));await _0xa7dc0f[_0x5e25e1(0x118)](_0x5e25e1(0x1f6))[_0x5e25e1(0x23f)](0xc8),await _0xa7dc0f['del'](_0x5b881e[_0x5e25e1(0x148)])['send']({'all':!![]})[_0x5e25e1(0x23f)](_0x5e25e1(0x1e7),/ghost-members-ssr=.*;.*?expires=Thu, 01 Jan 1970 00:00:00 GMT;.*?/)[_0x5e25e1(0x23f)](0xcc),await _0xa7dc0f['get'](_0x5b881e['lgenm'])[_0x5e25e1(0x23f)](0xcc),await _0x559a28[_0x5e25e1(0x199)](),assert['notEqual'](_0x559a28[_0x5e25e1(0x118)](_0x5b881e[_0x5e25e1(0xe2)]),_0x2c48e0);}),it(_0x2d634e(0x1b6),async function(){const _0xdd435e=_0x2d634e;if(_0xdd435e(0xb9)!=='AVPfm'){const _0x337b9d=_0x559a28[_0xdd435e(0x118)](_0x19df63[_0xdd435e(0xbb)]);await _0xa7dc0f['get'](_0xdd435e(0x1f6))[_0xdd435e(0x23f)](0xc8),await _0xa7dc0f[_0xdd435e(0x218)](_0x19df63[_0xdd435e(0x25e)])[_0xdd435e(0xde)]({'all':![]})[_0xdd435e(0x23f)](_0x19df63[_0xdd435e(0xab)],/ghost-members-ssr=.*;.*?expires=Thu, 01 Jan 1970 00:00:00 GMT;.*?/)['expect'](0xcc),await _0xa7dc0f[_0xdd435e(0x118)](_0x19df63[_0xdd435e(0x13a)])[_0xdd435e(0x23f)](0xcc),await _0x559a28['refresh'](),assert[_0xdd435e(0x1a8)](_0x559a28[_0xdd435e(0x118)]('transient_id'),_0x337b9d);}else return{'members':!![]};});}),_0x331bc4[_0x9df1c6(0x162)](describe,_0x9df1c6(0x228),function(){const _0x943e4=_0x9df1c6,_0x279195={'xQwMH':function(_0x405f59,_0x3c832a){return _0x405f59(_0x3c832a);},'ShDvB':_0x19df63[_0x943e4(0x22a)],'sGCar':_0x943e4(0x1c9)};_0x19df63[_0x943e4(0x246)](before,async function(){const _0x3db60e=_0x943e4;await _0x279195[_0x3db60e(0x1d9)](_0x39148a,_0x279195[_0x3db60e(0xcf)]);}),_0x19df63[_0x943e4(0x16a)](it,_0x943e4(0xea),async function(){const _0x3be598=_0x943e4;await _0xa7dc0f[_0x3be598(0x118)](_0x279195['sGCar'])[_0x3be598(0x23f)](0xc8)['expect'](assertContentIsPresent);}),it(_0x943e4(0x20d),async function(){const _0x4200d0=_0x943e4;await _0xa7dc0f[_0x4200d0(0x118)](_0x4200d0(0x23d))[_0x4200d0(0x23f)](0xc8)[_0x4200d0(0x23f)](assertContentIsPresent);}),_0x19df63[_0x943e4(0xcc)](it,_0x19df63['XVBVx'],async function(){const _0x458772=_0x943e4;await _0xa7dc0f[_0x458772(0x118)](_0x458772(0x241))[_0x458772(0x23f)](0xc8)[_0x458772(0x23f)](assertContentIsAbsent);}),it(_0x943e4(0x105),async function(){const _0x1dd171=_0x943e4;await _0xa7dc0f['get'](_0x1dd171(0x16b))['expect'](0xc8)[_0x1dd171(0x23f)](assertContentIsAbsent);}),_0x19df63[_0x943e4(0x16a)](it,_0x19df63[_0x943e4(0x1fd)],async function(){const _0x3661a5=_0x943e4;await _0xa7dc0f['get'](_0x3661a5(0x117))['expect'](0xc8)['expect'](assertContentIsAbsent);});}),describe(_0x331bc4[_0x9df1c6(0x107)],function(){const _0x101ab1=_0x9df1c6,_0x3323c4={'cGKQg':_0x101ab1(0x155),'gMEXm':_0x331bc4[_0x101ab1(0xdd)],'xwpEy':function(_0x26b38a,_0x4cec5e,_0x5936e5){return _0x26b38a(_0x4cec5e,_0x5936e5);},'UAFul':_0x101ab1(0xb4),'gAQsk':_0x101ab1(0x233),'YYEWP':_0x101ab1(0x100)},_0x23e684='vip@test.com';before(async function(){await _0x39148a(_0x23e684);}),it('generates\x20a\x20MemberPageView\x20event',async function(){const _0x476136=_0x101ab1,_0x284fe2=sinon[_0x476136(0x186)]();DomainEvents[_0x476136(0x198)](MemberPageViewEvent,_0x284fe2);let _0x334b84=await models[_0x476136(0x238)][_0x476136(0xf8)]({'email':_0x23e684});await models[_0x476136(0x238)][_0x476136(0x16d)]({'last_seen_at':null},{'id':_0x334b84[_0x476136(0x118)]('id')}),_0x334b84=await models['Member'][_0x476136(0xf8)]({'email':_0x23e684}),assert[_0x476136(0x1a8)](_0x334b84[_0x476136(0x118)]('last_seen_at'),null,_0x3323c4[_0x476136(0x113)]),await _0xa7dc0f[_0x476136(0x118)](_0x3323c4['gMEXm'])[_0x476136(0x23f)](0xc8)[_0x476136(0x23f)](assertContentIsPresent),await DomainEvents['allSettled'](),_0x3323c4['xwpEy'](assert,_0x284fe2[_0x476136(0x247)],_0x3323c4[_0x476136(0x25f)]),_0x334b84=await models['Member'][_0x476136(0xf8)]({'email':_0x23e684}),assert[_0x476136(0x106)](_0x334b84[_0x476136(0x118)](_0x3323c4[_0x476136(0x202)]),null,_0x3323c4[_0x476136(0x1d6)]);});}),_0x331bc4[_0x9df1c6(0x1f4)](describe,_0x9df1c6(0x225),function(){const _0x3393f4=_0x9df1c6,_0x9fd2e9={'VHwZm':_0x3393f4(0x25d),'oQJnc':_0x3393f4(0x1f6),'EaIaO':_0x19df63['YTdHE'],'lsokd':'name','OtqTx':'firstname','vfLfd':'subscribed','nBVtj':_0x3393f4(0x22b),'YwUPY':_0x3393f4(0x242)},_0xcfe553=_0x19df63['qYlQX'];_0x19df63[_0x3393f4(0x16f)](before,async function(){const _0x1f93dc=_0x3393f4;await models[_0x1f93dc(0x238)][_0x1f93dc(0xf8)]({'email':_0xcfe553},{'require':!![]});const _0x5e32fb=require(_0x19df63[_0x1f93dc(0x1c1)]),_0x48ddc6=await _0x5e32fb[_0x1f93dc(0x177)]['getMagicLink'](_0xcfe553,_0x19df63[_0x1f93dc(0x260)]),_0x37c5e9=new URL(_0x48ddc6),_0x21933f=''+_0x37c5e9[_0x1f93dc(0x10c)]+_0x37c5e9[_0x1f93dc(0x1a1)];await _0xa7dc0f[_0x1f93dc(0x118)](_0x21933f)[_0x1f93dc(0x23f)](0x12e)['then'](_0x4cf1ee=>{const _0xa1199a=_0x1f93dc,_0x4db77d=new URL(_0x4cf1ee[_0xa1199a(0x21f)][_0xa1199a(0x1d4)],testUtils[_0xa1199a(0xd4)][_0xa1199a(0x1d8)]());should['exist'](_0x4db77d[_0xa1199a(0x21a)]['get']('success')),_0x4db77d[_0xa1199a(0x21a)][_0xa1199a(0x118)](_0x9fd2e9[_0xa1199a(0x129)])[_0xa1199a(0x125)][_0xa1199a(0x250)]('true');});}),it(_0x19df63['EMBqG'],async function(){const _0x39eb6f=_0x3393f4,_0x4696fa=await _0xa7dc0f[_0x39eb6f(0x118)](_0x9fd2e9[_0x39eb6f(0x146)])[_0x39eb6f(0x23f)](0xc8),_0x90efab=_0x4696fa[_0x39eb6f(0x1f2)];should[_0x39eb6f(0x1c0)](_0x90efab),_0x90efab[_0x39eb6f(0x125)][_0x39eb6f(0x17a)][_0x39eb6f(0x140)]([_0x9fd2e9[_0x39eb6f(0x101)],'email',_0x9fd2e9[_0x39eb6f(0x254)],_0x9fd2e9[_0x39eb6f(0x1ea)],'expertise',_0x39eb6f(0x103),_0x9fd2e9['vfLfd'],_0x9fd2e9['nBVtj'],_0x39eb6f(0x1fc),_0x39eb6f(0xca),_0x39eb6f(0x258),_0x39eb6f(0x12e),_0x9fd2e9[_0x39eb6f(0x168)]]),Object['keys'](_0x90efab)[_0x39eb6f(0x125)][_0x39eb6f(0x17a)]['length'](0xd),_0x90efab[_0x39eb6f(0x125)][_0x39eb6f(0xb0)]['have'][_0x39eb6f(0x203)]('id'),_0x90efab[_0x39eb6f(0x12e)][_0x39eb6f(0x125)][_0x39eb6f(0x17a)][_0x39eb6f(0xcd)](0x1),Object[_0x39eb6f(0xfc)](_0x90efab[_0x39eb6f(0x12e)][0x0])['should'][_0x39eb6f(0x17a)][_0x39eb6f(0xcd)](0x5),_0x90efab[_0x39eb6f(0x12e)][0x0][_0x39eb6f(0x125)][_0x39eb6f(0x17a)][_0x39eb6f(0x140)](['id',_0x39eb6f(0x19c),_0x9fd2e9[_0x39eb6f(0x254)],'description',_0x39eb6f(0x17c)]);}),it(_0x3393f4(0xea),async function(){const _0x5b086e=_0x3393f4;await _0xa7dc0f[_0x5b086e(0x118)](_0x19df63[_0x5b086e(0xd2)])['expect'](0xc8)[_0x5b086e(0x23f)](assertContentIsPresent);}),_0x19df63[_0x3393f4(0x134)](it,_0x19df63[_0x3393f4(0xe9)],async function(){const _0x44741a=_0x3393f4;await _0xa7dc0f[_0x44741a(0x118)](_0x19df63[_0x44741a(0x115)])[_0x44741a(0x23f)](0xc8)[_0x44741a(0x23f)](assertContentIsPresent);}),it(_0x19df63[_0x3393f4(0x17e)],async function(){const _0x30757b=_0x3393f4;await _0xa7dc0f['get'](_0x30757b(0x241))[_0x30757b(0x23f)](0xc8)[_0x30757b(0x23f)](assertContentIsPresent);}),it(_0x19df63[_0x3393f4(0xf7)],async function(){const _0xe6fd64=_0x3393f4;await _0xa7dc0f['get'](_0xe6fd64(0x16b))[_0xe6fd64(0x23f)](0xc8)[_0xe6fd64(0x23f)](assertContentIsAbsent);}),_0x19df63[_0x3393f4(0xcc)](it,_0x19df63[_0x3393f4(0x1dd)],async function(){const _0x112f76=_0x3393f4;await _0xa7dc0f['get']('/thou-must-have-default-product/')[_0x112f76(0x23f)](0xc8)[_0x112f76(0x23f)](assertContentIsPresent);}),it(_0x19df63[_0x3393f4(0x1e0)],async function(){const _0x315034=_0x3393f4,_0x1ce62a=sinon['spy']();DomainEvents[_0x315034(0x198)](MemberPageViewEvent,_0x1ce62a);let _0x464195=await models[_0x315034(0x238)][_0x315034(0xf8)]({'email':_0xcfe553});await models[_0x315034(0x238)][_0x315034(0x16d)]({'last_seen_at':null},{'id':_0x464195[_0x315034(0x118)]('id')}),_0x464195=await models[_0x315034(0x238)][_0x315034(0xf8)]({'email':_0xcfe553}),assert[_0x315034(0x1a8)](_0x464195[_0x315034(0x118)](_0x19df63[_0x315034(0xe8)]),null,_0x19df63[_0x315034(0x253)]),await _0xa7dc0f[_0x315034(0x118)](_0x19df63[_0x315034(0xd2)])['expect'](0xc8)[_0x315034(0x23f)](assertContentIsPresent),await DomainEvents[_0x315034(0x11a)](),assert(_0x1ce62a['calledOnce'],_0x19df63[_0x315034(0x1a6)]),_0x464195=await models['Member'][_0x315034(0xf8)]({'email':_0xcfe553}),assert[_0x315034(0x106)](_0x464195['get'](_0x315034(0x233)),null,_0x19df63['ERPhD']);});}),_0x331bc4[_0x9df1c6(0x181)](describe,_0x9df1c6(0xff),function(){const _0x832508=_0x9df1c6,_0x74ecef={'VZlvK':function(_0x436030,_0x2e0b6f){return _0x331bc4['zHAzu'](_0x436030,_0x2e0b6f);},'KjNfN':'comped@test.com','TjThe':_0x331bc4[_0x832508(0xdd)],'fqaza':_0x331bc4[_0x832508(0x190)],'ikkvA':_0x832508(0x241),'hBqBd':_0x832508(0x16b),'GKUYU':_0x832508(0x117)};_0x331bc4['kSXaD'](before,async function(){const _0x8bcf00=_0x832508;await _0x74ecef[_0x8bcf00(0x151)](_0x39148a,_0x74ecef['KjNfN']);}),it(_0x832508(0xea),async function(){const _0x5828eb=_0x832508;await _0xa7dc0f[_0x5828eb(0x118)](_0x74ecef[_0x5828eb(0xce)])['expect'](0xc8)[_0x5828eb(0x23f)](assertContentIsPresent);}),it('can\x20read\x20members\x20post\x20content',async function(){const _0x3424c8=_0x832508;await _0xa7dc0f[_0x3424c8(0x118)](_0x74ecef[_0x3424c8(0x1bf)])['expect'](0xc8)[_0x3424c8(0x23f)](assertContentIsPresent);}),it(_0x832508(0x18b),async function(){const _0x23698d=_0x832508;await _0xa7dc0f['get'](_0x74ecef[_0x23698d(0x1df)])['expect'](0xc8)[_0x23698d(0x23f)](assertContentIsPresent);}),_0x331bc4[_0x832508(0x120)](it,_0x331bc4[_0x832508(0x20a)],async function(){const _0x557df3=_0x832508;await _0xa7dc0f[_0x557df3(0x118)](_0x74ecef[_0x557df3(0x15e)])[_0x557df3(0x23f)](0xc8)[_0x557df3(0x23f)](assertContentIsAbsent);}),_0x331bc4[_0x832508(0xe1)](it,_0x832508(0x19e),async function(){const _0xbcb482=_0x832508;await _0xa7dc0f[_0xbcb482(0x118)](_0x74ecef['GKUYU'])[_0xbcb482(0x23f)](0xc8)[_0xbcb482(0x23f)](assertContentIsPresent);});}),describe(_0x331bc4[_0x9df1c6(0x185)],function(){const _0x4cdf31=_0x9df1c6,_0x33f73c={'IVeSk':_0x4cdf31(0xf5)};before(async function(){const _0x595283=_0x4cdf31;await _0x39148a(_0x33f73c[_0x595283(0x110)]);}),it(_0x331bc4[_0x4cdf31(0x224)],async function(){const _0x4e22c3=_0x4cdf31;await _0xa7dc0f[_0x4e22c3(0x118)](_0x19df63[_0x4e22c3(0xb5)])[_0x4e22c3(0x23f)](0xc8)[_0x4e22c3(0x23f)](assertContentIsPresent);});});});});