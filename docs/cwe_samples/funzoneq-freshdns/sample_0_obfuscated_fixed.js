'use strict';function _0x596e(_0x54199a,_0x1cd2f3){const _0x304a4b=_0x304a();return _0x596e=function(_0x596ee4,_0xfdd2c7){_0x596ee4=_0x596ee4-0x187;let _0x28219a=_0x304a4b[_0x596ee4];return _0x28219a;},_0x596e(_0x54199a,_0x1cd2f3);}function _0x304a(){const _0x196984=['object','38276ZqpVuQ','decorateReply','string','secret','VPEzy','includes','send','csrf','hBOkO','14030wXToEZ','warn','bRsrs','hHzXb','fastify-cookie','Invalid\x20csrf\x20token','cookies','cookieOpts\x20should\x20be\x20a\x20object','811764HVjDbO','829805Fclake','assert','headers','sessionKey\x20should\x20be\x20a\x20string','Feiex','kxMRy','session','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','fastify-csrf','body','438GBNPNB','11816xbwnQv','function','CMiCe','assign','fastify-plugin','unsignCookie','>=3.0.0','CNtwJ','set','Missing\x20csrf\x20secret','fhOIv','52247nkiLVp','csrf-token','102bfVyyR','21ywokos','441xAQqXa','generateCsrf','signed','decorate','fastify-session','XlAQg','create','fastify-secure-session','x-csrf-token','exports','x-xsrf-token','options','2013ymNTbT','xsrf-token','fxBIG','http-errors','_csrf','request','exmcv','2THYqtB','log'];_0x304a=function(){return _0x196984;};return _0x304a();}const _0x4aad68=_0x596e;(function(_0x46977d,_0x3ec181){const _0x42cd13=_0x596e,_0x4d9415=_0x46977d();while(!![]){try{const _0x2ffeb7=parseInt(_0x42cd13(0x1b6))/0x1*(-parseInt(_0x42cd13(0x18b))/0x2)+-parseInt(_0x42cd13(0x1b8))/0x3*(parseInt(_0x42cd13(0x18e))/0x4)+parseInt(_0x42cd13(0x1a0))/0x5+parseInt(_0x42cd13(0x1aa))/0x6*(-parseInt(_0x42cd13(0x1b9))/0x7)+parseInt(_0x42cd13(0x1ab))/0x8*(parseInt(_0x42cd13(0x1ba))/0x9)+parseInt(_0x42cd13(0x197))/0xa*(parseInt(_0x42cd13(0x1c6))/0xb)+parseInt(_0x42cd13(0x19f))/0xc;if(_0x2ffeb7===_0x3ec181)break;else _0x4d9415['push'](_0x4d9415['shift']());}catch(_0x3fc280){_0x4d9415['push'](_0x4d9415['shift']());}}}(_0x304a,0x2d256));const assert=require(_0x4aad68(0x1a1)),fp=require(_0x4aad68(0x1af)),CSRF=require(_0x4aad68(0x195)),{Forbidden}=require(_0x4aad68(0x187)),defaultOptions={'cookieKey':_0x4aad68(0x188),'cookieOpts':{'path':'/','sameSite':!![],'httpOnly':!![]},'sessionKey':_0x4aad68(0x188),'getToken':getTokenDefault,'sessionPlugin':_0x4aad68(0x19b)};async function csrfPlugin(_0x11dde3,_0x15b343){const _0x1faac0=_0x4aad68,_0xe3743a={'exmcv':function(_0x8e4f87,_0x115eba,_0x564fba){return _0x8e4f87(_0x115eba,_0x564fba);},'Feiex':_0x1faac0(0x1b4),'XlAQg':function(_0x3b68f0,_0x53ed77){return _0x3b68f0(_0x53ed77);},'fhOIv':_0x1faac0(0x19c),'hBOkO':function(_0xaefd16){return _0xaefd16();},'kxMRy':function(_0x1710cf,_0x1bb0fb){return _0x1710cf===_0x1bb0fb;},'CMiCe':'cookieKey\x20should\x20be\x20a\x20string','CNtwJ':'string','KcTXu':'getToken\x20should\x20be\x20a\x20function','oFfsh':_0x1faac0(0x18d),'OnHgJ':_0x1faac0(0x19b),'ryBVn':_0x1faac0(0x1c1),'hHzXb':_0x1faac0(0x1a7),'fxBIG':function(_0x3c840b,_0x29fe11){return _0x3c840b===_0x29fe11;},'VPEzy':function(_0x391398,_0x5ea632){return _0x391398===_0x5ea632;},'bRsrs':'generateCsrf'},{cookieKey:_0x46492b,cookieOpts:_0xca4b1d,sessionKey:_0x143598,getToken:_0x5ecd11,sessionPlugin:_0x30d8d4,csrfOpts:_0x415fa0}=Object[_0x1faac0(0x1ae)]({},defaultOptions,_0x15b343);assert(_0xe3743a[_0x1faac0(0x1a5)](typeof _0x46492b,_0x1faac0(0x190)),_0xe3743a[_0x1faac0(0x1ad)]),_0xe3743a['exmcv'](assert,_0xe3743a[_0x1faac0(0x1a5)](typeof _0x143598,_0xe3743a[_0x1faac0(0x1b2)]),_0x1faac0(0x1a3)),_0xe3743a[_0x1faac0(0x18a)](assert,typeof _0x5ecd11===_0x1faac0(0x1ac),_0xe3743a['KcTXu']),_0xe3743a[_0x1faac0(0x18a)](assert,typeof _0xca4b1d===_0xe3743a['oFfsh'],_0x1faac0(0x19e)),assert([_0xe3743a['OnHgJ'],'fastify-session',_0xe3743a['ryBVn']][_0x1faac0(0x193)](_0x30d8d4),_0xe3743a[_0x1faac0(0x19a)]);const _0x237625=new CSRF(_0x415fa0),_0x4203ae=_0xca4b1d&&_0xca4b1d[_0x1faac0(0x1bc)];if(_0xe3743a[_0x1faac0(0x1c8)](_0x30d8d4,_0x1faac0(0x1c1)))_0x11dde3[_0x1faac0(0x18f)]('generateCsrf',_0x15adba);else _0xe3743a[_0x1faac0(0x192)](_0x30d8d4,_0x1faac0(0x1be))?_0x11dde3[_0x1faac0(0x18f)](_0x1faac0(0x1bb),_0x311d44):_0x11dde3[_0x1faac0(0x18f)](_0xe3743a[_0x1faac0(0x199)],_0x14d771);_0x11dde3[_0x1faac0(0x1bd)]('csrfProtection',_0x213811);async function _0x14d771(_0x5c04ee){const _0x1c0bbb=_0x1faac0;let _0x3660a1=_0x4203ae?this[_0x1c0bbb(0x1b0)](this[_0x1c0bbb(0x189)]['cookies'][_0x46492b]||''):this[_0x1c0bbb(0x189)][_0x1c0bbb(0x19d)][_0x46492b];return!_0x3660a1&&(_0x3660a1=await _0x237625[_0x1c0bbb(0x191)](),this['setCookie'](_0x46492b,_0x3660a1,Object['assign']({},_0xca4b1d,_0x5c04ee))),_0x237625[_0x1c0bbb(0x1c0)](_0x3660a1);}async function _0x15adba(_0x461178){const _0x1f66f1=_0x1faac0;let _0x34e43f=this['request'][_0x1f66f1(0x1a6)]['get'](_0x143598);return!_0x34e43f&&(_0x34e43f=await _0x237625[_0x1f66f1(0x191)](),this[_0x1f66f1(0x189)]['session'][_0x1f66f1(0x1b3)](_0x143598,_0x34e43f)),_0x461178&&this[_0x1f66f1(0x189)][_0x1f66f1(0x1a6)][_0x1f66f1(0x1c5)](_0x461178),_0x237625[_0x1f66f1(0x1c0)](_0x34e43f);}async function _0x311d44(){const _0x2f813c=_0x1faac0;let _0x428b70=this[_0x2f813c(0x189)][_0x2f813c(0x1a6)][_0x143598];return!_0x428b70&&(_0x428b70=await _0x237625['secret'](),this[_0x2f813c(0x189)]['session'][_0x143598]=_0x428b70),_0x237625[_0x2f813c(0x1c0)](_0x428b70);}function _0x213811(_0x271827,_0x5bf370,_0x548183){const _0x380d01=_0x1faac0,_0x5eb002=_0xe3743a['exmcv'](_0x1b533b,_0x271827,_0x5bf370);if(!_0x5eb002)return _0x271827['log'][_0x380d01(0x198)](_0xe3743a['Feiex']),_0x5bf370[_0x380d01(0x194)](new Forbidden(_0xe3743a[_0x380d01(0x1a4)]));if(!_0x237625['verify'](_0x5eb002,_0xe3743a[_0x380d01(0x1bf)](_0x5ecd11,_0x271827)))return _0x271827[_0x380d01(0x18c)][_0x380d01(0x198)](_0xe3743a[_0x380d01(0x1b5)]),_0x5bf370[_0x380d01(0x194)](new Forbidden(_0xe3743a[_0x380d01(0x1b5)]));_0xe3743a[_0x380d01(0x196)](_0x548183);}function _0x1b533b(_0x3606bb,_0x230b80){const _0x44daa8=_0x1faac0;if(_0x30d8d4==='fastify-secure-session')return _0x3606bb[_0x44daa8(0x1a6)]['get'](_0x143598);else return _0x30d8d4===_0x44daa8(0x1be)?_0x3606bb[_0x44daa8(0x1a6)][_0x143598]:_0x4203ae?_0x230b80[_0x44daa8(0x1b0)](_0x3606bb['cookies'][_0x46492b]||''):_0x3606bb['cookies'][_0x46492b];}}function getTokenDefault(_0x557632){const _0x3e0888=_0x4aad68,_0x52de29={'DWeHP':_0x3e0888(0x1c4)};return _0x557632[_0x3e0888(0x1a9)]&&_0x557632['body'][_0x3e0888(0x188)]||_0x557632['headers'][_0x3e0888(0x1b7)]||_0x557632[_0x3e0888(0x1a2)][_0x3e0888(0x1c7)]||_0x557632[_0x3e0888(0x1a2)][_0x3e0888(0x1c2)]||_0x557632['headers'][_0x52de29['DWeHP']];}module[_0x4aad68(0x1c3)]=fp(csrfPlugin,{'fastify':_0x4aad68(0x1b1),'name':_0x4aad68(0x1a8),'dependencies':['fastify-cookie']});