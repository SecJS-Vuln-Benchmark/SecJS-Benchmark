'use strict';const _0x57e367=_0x921d;(function(_0x1a298f,_0x5ca633){const _0x5cf4d8=_0x921d,_0x462f24=_0x1a298f();while(!![]){try{const _0x4cf8f2=parseInt(_0x5cf4d8(0x83))/0x1*(-parseInt(_0x5cf4d8(0xcd))/0x2)+parseInt(_0x5cf4d8(0x82))/0x3+-parseInt(_0x5cf4d8(0xd3))/0x4+-parseInt(_0x5cf4d8(0x71))/0x5*(parseInt(_0x5cf4d8(0x75))/0x6)+-parseInt(_0x5cf4d8(0x92))/0x7+-parseInt(_0x5cf4d8(0x6e))/0x8*(parseInt(_0x5cf4d8(0xf5))/0x9)+parseInt(_0x5cf4d8(0xdc))/0xa;if(_0x4cf8f2===_0x5ca633)break;else _0x462f24['push'](_0x462f24['shift']());}catch(_0x4e4b94){_0x462f24['push'](_0x462f24['shift']());}}}(_0x520b,0x1cab5));function _0x921d(_0x3846b7,_0x32e1e1){const _0x520b97=_0x520b();return _0x921d=function(_0x921db5,_0x476a06){_0x921db5=_0x921db5-0x6c;let _0x1dd3bc=_0x520b97[_0x921db5];return _0x1dd3bc;},_0x921d(_0x3846b7,_0x32e1e1);}const {test}=require('tap'),Fastify=require(_0x57e367(0xd1)),fastifyCookie=require(_0x57e367(0x7f)),fastifySession=require(_0x57e367(0xb2)),fastifySecureSession=require(_0x57e367(0xec)),proxyquire=require(_0x57e367(0xe8)),sinon=require(_0x57e367(0xcc)),fastifyCsrf=require(_0x57e367(0x6f)),sodium=require(_0x57e367(0x70)),key=Buffer[_0x57e367(0xe1)](sodium[_0x57e367(0xf7)]);sodium[_0x57e367(0x73)](key),test(_0x57e367(0x9a),_0x28e552=>{const _0x1eaddc=_0x57e367,_0x154a29={'rQutS':_0x1eaddc(0xc2),'IIOVj':function(_0x250a9b,_0xe157a5,_0x141312,_0x4318fe,_0x1b5636){return _0x250a9b(_0xe157a5,_0x141312,_0x4318fe,_0x1b5636);},'WPHwj':_0x1eaddc(0x78),'dsAjI':_0x1eaddc(0xb7),'jDSJI':_0x1eaddc(0xd4),'EpyYH':_0x1eaddc(0xa5),'syJtQ':function(_0x41d80b,_0x2fa1da,_0x901211,_0x4ef47d){return _0x41d80b(_0x2fa1da,_0x901211,_0x4ef47d);},'mrQUY':_0x1eaddc(0xa8),'SRySz':function(_0x5d7bfb,_0x1f5386,_0x1dce3d){return _0x5d7bfb(_0x1f5386,_0x1dce3d);}};async function _0x3ac6c8(){const _0x53ae9c=_0x1eaddc,_0x2bdb64=Fastify();return await _0x2bdb64[_0x53ae9c(0xa9)](fastifyCookie),await _0x2bdb64[_0x53ae9c(0xa9)](fastifyCsrf),_0x2bdb64[_0x53ae9c(0x99)](_0x154a29[_0x53ae9c(0xd0)],_0x53ae9c(0x7f)),_0x2bdb64;}_0x154a29[_0x1eaddc(0x72)](runTest,_0x28e552,_0x3ac6c8,{'property':_0x154a29['WPHwj'],'place':_0x154a29[_0x1eaddc(0xa1)]},_0x154a29[_0x1eaddc(0x85)]),runTest(_0x28e552,_0x3ac6c8,{'property':_0x1eaddc(0xcf),'place':_0x154a29[_0x1eaddc(0xc0)]}),runTest(_0x28e552,_0x3ac6c8,{'property':_0x1eaddc(0xc6),'place':_0x154a29[_0x1eaddc(0xc0)]}),_0x154a29['syJtQ'](runTest,_0x28e552,_0x3ac6c8,{'property':_0x154a29[_0x1eaddc(0x77)],'place':_0x1eaddc(0xa5)}),runTest(_0x28e552,_0x3ac6c8,{'property':_0x1eaddc(0xcb),'place':_0x154a29[_0x1eaddc(0xc0)]}),_0x154a29[_0x1eaddc(0x98)](runCookieOpts,_0x28e552,_0x3ac6c8),_0x28e552[_0x1eaddc(0xc9)]();}),test('Cookies\x20signed',_0x40311d=>{const _0x309139=_0x57e367,_0x597760={'ImffM':function(_0x5ebbc1){return _0x5ebbc1();},'DjEnF':_0x309139(0xdb),'XzRgU':'testType','WwmWs':_0x309139(0x7f),'FkqlU':_0x309139(0x78),'knAqC':'body','cQcda':_0x309139(0xd4),'nGkjb':function(_0x22a9d9,_0x3b4c01,_0x429d24,_0x7a2e47){return _0x22a9d9(_0x3b4c01,_0x429d24,_0x7a2e47);},'lYdJG':'headers','YfoFD':'xsrf-token','hHKmG':_0x309139(0xa8),'rnvwL':_0x309139(0xcb),'yXATU':function(_0x1aeb77,_0x31fc29,_0x6f2a4f){return _0x1aeb77(_0x31fc29,_0x6f2a4f);}};async function _0x56b743(){const _0x50aa43=_0x309139,_0x594c6c=_0x597760['ImffM'](Fastify);return await _0x594c6c[_0x50aa43(0xa9)](fastifyCookie,{'secret':_0x597760[_0x50aa43(0x94)]}),await _0x594c6c['register'](fastifyCsrf,{'cookieOpts':{'signed':!![]}}),_0x594c6c[_0x50aa43(0x99)](_0x597760[_0x50aa43(0xac)],_0x597760[_0x50aa43(0x8f)]),_0x594c6c;}runTest(_0x40311d,_0x56b743,{'property':_0x597760['FkqlU'],'place':_0x597760[_0x309139(0x96)]},_0x597760['cQcda']),_0x597760[_0x309139(0xf4)](runTest,_0x40311d,_0x56b743,{'property':_0x309139(0xcf),'place':_0x597760[_0x309139(0xdd)]}),runTest(_0x40311d,_0x56b743,{'property':_0x597760[_0x309139(0x6c)],'place':_0x597760[_0x309139(0xdd)]}),runTest(_0x40311d,_0x56b743,{'property':_0x597760[_0x309139(0xef)],'place':_0x597760[_0x309139(0xdd)]}),runTest(_0x40311d,_0x56b743,{'property':_0x597760['rnvwL'],'place':_0x597760[_0x309139(0xdd)]}),_0x597760['yXATU'](runCookieOpts,_0x40311d,_0x56b743),_0x40311d['end']();}),test(_0x57e367(0xbd),_0x3a9880=>{const _0x2e8e0a=_0x57e367,_0x379947={'nvpFx':function(_0x1c0c90,_0x478436){return _0x1c0c90!==_0x478436;},'HeBxp':'kjlOQ','TjRbh':_0x2e8e0a(0xf0),'wnych':function(_0x44d6b4){return _0x44d6b4();},'jEyul':_0x2e8e0a(0xc2),'nqBsL':_0x2e8e0a(0xd4),'pORPk':function(_0x44f97b,_0x37d2bb,_0x2aa716,_0x2d00f0,_0xece6b3){return _0x44f97b(_0x37d2bb,_0x2aa716,_0x2d00f0,_0xece6b3);},'AQhPK':_0x2e8e0a(0xcf),'MtugY':_0x2e8e0a(0xa5),'qcApW':function(_0x27faa3,_0x34acfe,_0x56a3fb,_0x1ae319,_0x2f4e32){return _0x27faa3(_0x34acfe,_0x56a3fb,_0x1ae319,_0x2f4e32);},'drEXM':function(_0x34e6ab,_0x49f7b6,_0x20d785,_0x3194ac,_0xb41189){return _0x34e6ab(_0x49f7b6,_0x20d785,_0x3194ac,_0xb41189);},'KPwqh':_0x2e8e0a(0xa8),'AgpMp':'x-xsrf-token'};async function _0x5da074(){const _0xb7bc74=_0x2e8e0a;if(_0x379947[_0xb7bc74(0x80)](_0x379947['HeBxp'],_0x379947[_0xb7bc74(0x7a)])){const _0x182040=_0x379947['wnych'](Fastify);return await _0x182040['register'](fastifyCookie),await _0x182040[_0xb7bc74(0xa9)](fastifySession,{'secret':'a'[_0xb7bc74(0xca)](0x20),'cookie':{'path':'/','secure':![]}}),await _0x182040[_0xb7bc74(0xa9)](fastifyCsrf,{'sessionPlugin':_0xb7bc74(0xb2)}),_0x182040[_0xb7bc74(0x99)](_0x379947[_0xb7bc74(0xd5)],_0xb7bc74(0xb2)),_0x182040;}else _0x3c681[_0xb7bc74(0x7d)](_0x4f1d85[_0xb7bc74(0xea)],'getToken\x20should\x20be\x20a\x20function');}runTest(_0x3a9880,_0x5da074,{'property':_0x2e8e0a(0x78),'place':'body'},_0x379947['nqBsL']),_0x379947[_0x2e8e0a(0x6d)](runTest,_0x3a9880,_0x5da074,{'property':_0x379947[_0x2e8e0a(0xb1)],'place':_0x379947[_0x2e8e0a(0xa4)]},_0x2e8e0a(0xd4)),_0x379947[_0x2e8e0a(0xf3)](runTest,_0x3a9880,_0x5da074,{'property':_0x2e8e0a(0xc6),'place':_0x379947[_0x2e8e0a(0xa4)]},'preValidation'),_0x379947[_0x2e8e0a(0xe6)](runTest,_0x3a9880,_0x5da074,{'property':_0x379947[_0x2e8e0a(0xa3)],'place':_0x379947[_0x2e8e0a(0xa4)]},_0x379947[_0x2e8e0a(0x9c)]),_0x379947[_0x2e8e0a(0xe6)](runTest,_0x3a9880,_0x5da074,{'property':_0x379947[_0x2e8e0a(0xde)],'place':_0x379947['MtugY']},_0x379947[_0x2e8e0a(0x9c)]),_0x3a9880['end']();}),test(_0x57e367(0xb5),_0x536d32=>{const _0x181797=_0x57e367,_0xeee1c7={'yeAIt':function(_0x4add7a,_0x4a88a8){return _0x4add7a===_0x4a88a8;},'PBTVA':_0x181797(0x9d),'BAIYT':function(_0x4779d8){return _0x4779d8();},'mPDwT':'fastify-secure-session','zRBKP':'_csrf','ZCinj':_0x181797(0xb7),'pUPtL':_0x181797(0xd4),'iUhMR':function(_0x101fbd,_0x7f614,_0x23d96f,_0x24b378){return _0x101fbd(_0x7f614,_0x23d96f,_0x24b378);},'TyKSw':'headers','PdTgK':function(_0x6bb2ce,_0x167896,_0x402054,_0xfc1c15){return _0x6bb2ce(_0x167896,_0x402054,_0xfc1c15);},'OGoPn':_0x181797(0xc6),'JszQq':function(_0x259add,_0x5c9c02,_0x45e147,_0x23fee5){return _0x259add(_0x5c9c02,_0x45e147,_0x23fee5);},'LAEBP':_0x181797(0xcb),'wtEUK':function(_0x176996,_0x4e6051,_0x487f84){return _0x176996(_0x4e6051,_0x487f84);}};async function _0x48d141(){const _0x116af0=_0x181797;if(_0xeee1c7[_0x116af0(0xc8)]('aCNnm',_0xeee1c7[_0x116af0(0xb6)])){const _0x3c0266=_0xeee1c7['BAIYT'](Fastify);return await _0x3c0266[_0x116af0(0xa9)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x3c0266[_0x116af0(0xa9)](fastifyCsrf,{'sessionPlugin':_0xeee1c7[_0x116af0(0xc4)]}),_0x3c0266[_0x116af0(0x99)](_0x116af0(0xc2),_0xeee1c7[_0x116af0(0xc4)]),_0x3c0266;}else _0x165dbc[_0x116af0(0xbe)](_0xec4ec0,_0x25c087);}runTest(_0x536d32,_0x48d141,{'property':_0xeee1c7[_0x181797(0xb0)],'place':_0xeee1c7[_0x181797(0xeb)]},_0xeee1c7[_0x181797(0xd9)]),_0xeee1c7[_0x181797(0xc1)](runTest,_0x536d32,_0x48d141,{'property':'csrf-token','place':_0xeee1c7[_0x181797(0xd2)]}),_0xeee1c7[_0x181797(0xa7)](runTest,_0x536d32,_0x48d141,{'property':_0xeee1c7[_0x181797(0x95)],'place':_0x181797(0xa5)}),runTest(_0x536d32,_0x48d141,{'property':_0x181797(0xa8),'place':_0xeee1c7['TyKSw']}),_0xeee1c7[_0x181797(0xb4)](runTest,_0x536d32,_0x48d141,{'property':_0xeee1c7['LAEBP'],'place':_0xeee1c7['TyKSw']}),_0xeee1c7[_0x181797(0x88)](runCookieOpts,_0x536d32,_0x48d141),_0x536d32[_0x181797(0xc9)]();}),test(_0x57e367(0xad),_0x1beed4=>{const _0x5dbbb3=_0x57e367,_0x176bad={'CWxJX':function(_0xf97d20){return _0xf97d20();},'kjKVq':function(_0x1f5182){return _0x1f5182();},'Xttod':function(_0x4928b7){return _0x4928b7();},'ozwQW':_0x5dbbb3(0xdf),'yXWEO':function(_0x3748c5,_0xcf0257){return _0x3748c5===_0xcf0257;},'LustG':'cookieKey','rpcAn':'sessionKey'};_0x1beed4['test'](_0x176bad[_0x5dbbb3(0x7e)],_0x18c1ba=>{const _0x4c6a4e=_0x5dbbb3,_0x1067cd={'EPPdo':'SIVMn'};if(_0x4c6a4e(0xda)==='CqePv'){_0x18c1ba[_0x4c6a4e(0x93)](0x1);const _0x4c3ac3=_0x176bad['kjKVq'](Fastify);_0x4c3ac3[_0x4c6a4e(0xa9)](fastifyCookie),_0x4c3ac3[_0x4c6a4e(0xa9)](fastifyCsrf,{'cookieKey':0x2a}),_0x4c3ac3[_0x4c6a4e(0x91)](_0x53f5db=>{const _0x42baba=_0x4c6a4e;_0x42baba(0xe0)===_0x1067cd[_0x42baba(0x76)]?_0x18c1ba[_0x42baba(0x7d)](_0x53f5db[_0x42baba(0xea)],'cookieKey\x20should\x20be\x20a\x20string'):_0x1cc2ec[_0x42baba(0x7d)](_0x390242,_0x2d67fa);});}else{const _0xb18333={'RVKzm':_0x4c6a4e(0xf2)};_0x2a1064[_0x4c6a4e(0x93)](0x1);const _0x18ef07=_0x176bad['CWxJX'](_0x2e6166);_0x18ef07['register'](_0x3afc94),_0x18ef07['register'](_0x41559c,{'sessionPlugin':0x2a}),_0x18ef07['ready'](_0x463646=>{const _0x127936=_0x4c6a4e;_0x21a07f['strictEqual'](_0x463646[_0x127936(0xea)],_0xb18333[_0x127936(0xba)]);});}}),_0x1beed4['test'](_0x176bad[_0x5dbbb3(0x84)],_0x52a18f=>{const _0x257ea4=_0x5dbbb3;_0x52a18f[_0x257ea4(0x93)](0x1);const _0x1ee906=Fastify();_0x1ee906[_0x257ea4(0xa9)](fastifyCookie),_0x1ee906[_0x257ea4(0xa9)](fastifyCsrf,{'sessionKey':0x2a}),_0x1ee906[_0x257ea4(0x91)](_0x5c3e64=>{const _0x2d8bf2=_0x257ea4;_0x52a18f['strictEqual'](_0x5c3e64[_0x2d8bf2(0xea)],_0x2d8bf2(0xa6));});}),_0x1beed4[_0x5dbbb3(0x74)](_0x5dbbb3(0xb9),_0x33494f=>{const _0x216596=_0x5dbbb3;_0x33494f[_0x216596(0x93)](0x1);const _0x45ee56=_0x176bad[_0x216596(0x8b)](Fastify);_0x45ee56[_0x216596(0xa9)](fastifyCookie),_0x45ee56['register'](fastifyCsrf,{'getToken':0x2a}),_0x45ee56[_0x216596(0x91)](_0x529665=>{const _0x4071c4=_0x216596;_0x33494f[_0x4071c4(0x7d)](_0x529665['message'],_0x4071c4(0x8e));});}),_0x1beed4[_0x5dbbb3(0x74)]('cookieOpts',_0x5dcb73=>{const _0x44e2bd=_0x5dbbb3;_0x5dcb73[_0x44e2bd(0x93)](0x1);const _0x467f04=Fastify();_0x467f04[_0x44e2bd(0xa9)](fastifyCookie),_0x467f04[_0x44e2bd(0xa9)](fastifyCsrf,{'cookieOpts':0x2a}),_0x467f04[_0x44e2bd(0x91)](_0x84ad6=>{const _0x5f240f=_0x44e2bd;_0x5dcb73['strictEqual'](_0x84ad6[_0x5f240f(0xea)],_0x176bad[_0x5f240f(0x8a)]);});}),_0x1beed4[_0x5dbbb3(0x74)](_0x5dbbb3(0x97),_0x5d5f3d=>{const _0x308319=_0x5dbbb3;if(_0x176bad['yXWEO'](_0x308319(0xab),_0x308319(0xab))){_0x5d5f3d['plan'](0x1);const _0x49c615=_0x176bad[_0x308319(0xd7)](Fastify);_0x49c615[_0x308319(0xa9)](fastifyCookie),_0x49c615[_0x308319(0xa9)](fastifyCsrf,{'sessionPlugin':0x2a}),_0x49c615[_0x308319(0x91)](_0x2af030=>{const _0x430dac=_0x308319;_0x5d5f3d[_0x430dac(0x7d)](_0x2af030[_0x430dac(0xea)],_0x430dac(0xf2));});}else return _0x4142fb(..._0x1e2099);}),_0x1beed4[_0x5dbbb3(0xc9)]();}),test(_0x57e367(0x7c),async()=>{const _0x571e41=_0x57e367,_0x3f29d4={'USqVh':function(_0x4a0a16,..._0x59848e){return _0x4a0a16(..._0x59848e);},'FqYEy':function(_0x3cc536,_0x8b50b4,_0x131878){return _0x3cc536(_0x8b50b4,_0x131878);},'abIdO':_0x571e41(0x6f),'SjAsq':function(_0x14b4b9){return _0x14b4b9();}},_0x3905b8=sinon[_0x571e41(0xe2)](),_0x1071af=_0x3f29d4['FqYEy'](proxyquire,_0x3f29d4[_0x571e41(0x87)],{'csrf':function(..._0x2da3fe){const _0x28eb7e=_0x571e41;return _0x3f29d4[_0x28eb7e(0x89)](_0x3905b8,..._0x2da3fe);}}),_0xad3323={'some':_0x571e41(0xc3)};await _0x3f29d4['SjAsq'](Fastify)[_0x571e41(0xa9)](fastifyCookie)[_0x571e41(0xa9)](_0x1071af,{'csrfOpts':_0xad3323}),sinon[_0x571e41(0xe7)][_0x571e41(0xe3)](_0x3905b8,_0xad3323);});function runTest(_0x52a0af,_0xe138ea,_0x29b1f6,_0x1b6ac1=_0x57e367(0x90)){const _0x3c9882=_0x57e367,_0x1278e8={'zzLcP':_0x3c9882(0xa6),'LrKka':_0x3c9882(0xa2),'xzOCY':_0x3c9882(0xb2),'vhHQr':function(_0x58bf51,_0x445b3f){return _0x58bf51!==_0x445b3f;},'NopqZ':_0x3c9882(0xae),'BPOKT':_0x3c9882(0xb7),'rVwff':'POST','TkSMj':_0x3c9882(0x81)};_0x52a0af[_0x3c9882(0x74)](_0x3c9882(0xa0)+_0x29b1f6['place'],async _0x2f3db4=>{const _0x14099e=_0x3c9882,_0x413a6a=await _0xe138ea();_0x413a6a[_0x14099e(0xaa)]('/',async(_0x1e3be5,_0x33b749)=>{const _0x104922=await _0x33b749['generateCsrf']();return{'token':_0x104922};}),_0x413a6a[_0x14099e(0x9e)]('/',{[_0x1b6ac1]:_0x413a6a[_0x14099e(0x9b)]},async(_0x49bdbf,_0x3613e6)=>{return _0x49bdbf['body'];});let _0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':_0x1278e8[_0x14099e(0xbb)],'path':'/'});_0x2f3db4[_0x14099e(0x7d)](_0x381e6f[_0x14099e(0xb8)],0xc8);const _0x5b9401=_0x381e6f['cookies'][0x0],_0x4f8cbb=_0x381e6f[_0x14099e(0xed)]()[_0x14099e(0x7b)];_0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':_0x14099e(0xa2),'path':'/','cookies':{[_0x5b9401[_0x14099e(0xbf)]]:_0x5b9401[_0x14099e(0x8c)]}}),_0x2f3db4[_0x14099e(0x7d)](_0x381e6f[_0x14099e(0xb8)],0xc8);const _0x162f42=_0x381e6f['cookies'][0x0],_0x459490=_0x381e6f[_0x14099e(0xed)]()[_0x14099e(0x7b)];_0x413a6a[_0x14099e(0xc2)]===_0x1278e8[_0x14099e(0xbc)]?_0x2f3db4[_0x14099e(0xbe)](_0x5b9401,_0x162f42):_0x1278e8[_0x14099e(0xf1)](_0x14099e(0xee),_0x1278e8[_0x14099e(0x86)])?_0x2f3db4[_0x14099e(0x7d)](_0x162f42,undefined):_0x5098a4['strictEqual'](_0x335dae[_0x14099e(0xea)],_0x1278e8['zzLcP']),_0x2f3db4[_0x14099e(0xc5)](_0x4f8cbb,_0x459490),_0x29b1f6['place']===_0x1278e8['BPOKT']?_0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':_0x1278e8[_0x14099e(0x79)],'path':'/','payload':{'hello':_0x14099e(0x81),[_0x29b1f6[_0x14099e(0xd6)]]:_0x459490},'cookies':{[_0x5b9401[_0x14099e(0xbf)]]:_0x5b9401[_0x14099e(0x8c)]}}):_0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':_0x14099e(0xb3),'path':'/','payload':{'hello':_0x1278e8['TkSMj']},'headers':{[_0x29b1f6[_0x14099e(0xd6)]]:_0x459490},'cookies':{[_0x5b9401['name']]:_0x5b9401[_0x14099e(0x8c)]}}),_0x2f3db4[_0x14099e(0x7d)](_0x381e6f['statusCode'],0xc8),_0x2f3db4[_0x14099e(0xe4)](_0x381e6f[_0x14099e(0xed)](),{'hello':_0x14099e(0x81)}),_0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':_0x1278e8[_0x14099e(0x79)],'path':'/','payload':{'hello':'world'}}),_0x2f3db4[_0x14099e(0x7d)](_0x381e6f[_0x14099e(0xb8)],0x193),_0x2f3db4[_0x14099e(0xe4)](_0x381e6f['json'](),{'message':_0x14099e(0xe9)}),_0x381e6f=await _0x413a6a[_0x14099e(0x9f)]({'method':'POST','path':'/','payload':{'hello':_0x1278e8[_0x14099e(0xc7)]},'cookies':{[_0x5b9401[_0x14099e(0xbf)]]:_0x5b9401[_0x14099e(0x8c)]}}),_0x2f3db4['strictEqual'](_0x381e6f[_0x14099e(0xb8)],0x193),_0x2f3db4[_0x14099e(0xe4)](_0x381e6f[_0x14099e(0xed)](),{'message':_0x14099e(0xaf)});});}function runCookieOpts(_0x296d1a,_0x33f2bf){const _0x185c9e=_0x57e367,_0x55333c={'HXvkm':function(_0x26750d){return _0x26750d();},'oFTlk':_0x185c9e(0xa2),'NEgYC':_0x185c9e(0xf6)};_0x296d1a[_0x185c9e(0x74)](_0x185c9e(0xe5),async _0x2cad83=>{const _0x2f744c=_0x185c9e,_0x42dde4=await _0x55333c[_0x2f744c(0xd8)](_0x33f2bf);_0x42dde4['get']('/',async(_0x5ebefd,_0x5b75ab)=>{const _0x36b997=_0x2f744c,_0x705c8c=await _0x5b75ab['generateCsrf']({'path':_0x36b997(0xf6)});return{'token':_0x705c8c};});const _0x238b8f=await _0x42dde4['inject']({'method':_0x55333c[_0x2f744c(0xce)],'path':'/'}),_0xcad3e5=_0x238b8f['cookies'][0x0];_0x2cad83['match'](_0xcad3e5,{'path':_0x55333c[_0x2f744c(0x8d)]});});}function _0x520b(){const _0xe8b0af=['../','sodium-native','139835iSISqb','IIOVj','randombytes_buf','test','36xcGnde','EPPdo','mrQUY','_csrf','rVwff','TjRbh','token','csrf\x20options','strictEqual','LustG','fastify-cookie','nvpFx','world','471579iqJouA','225761hRpBCJ','rpcAn','jDSJI','NopqZ','abIdO','wtEUK','USqVh','ozwQW','Xttod','value','NEgYC','getToken\x20should\x20be\x20a\x20function','WwmWs','onRequest','ready','448742QRwvCS','plan','DjEnF','OGoPn','knAqC','sessionPlugin','SRySz','decorate','Cookies','csrfProtection','nqBsL','aCNnm','post','inject','Token\x20in\x20','dsAjI','GET','KPwqh','MtugY','headers','sessionKey\x20should\x20be\x20a\x20string','PdTgK','x-csrf-token','register','get','kANZd','XzRgU','Validation','fWWKK','Invalid\x20csrf\x20token','zRBKP','AQhPK','fastify-session','POST','JszQq','Fastify\x20Secure\x20Session','PBTVA','body','statusCode','getToken','RVKzm','LrKka','xzOCY','Fastify\x20Session','deepEqual','name','EpyYH','iUhMR','testType','options','mPDwT','notStrictEqual','xsrf-token','TkSMj','yeAIt','end','repeat','x-xsrf-token','sinon','2dMQGch','oFTlk','csrf-token','rQutS','fastify','TyKSw','4364Voefdp','preValidation','jEyul','property','CWxJX','HXvkm','pUPtL','CqePv','supersecret','4538430CCGtxD','lYdJG','AgpMp','cookieOpts\x20should\x20be\x20a\x20object','SIVMn','alloc','stub','calledWith','match','Custom\x20cookie\x20options','drEXM','assert','proxyquire','Missing\x20csrf\x20secret','message','ZCinj','fastify-secure-session','json','xrYeU','hHKmG','kzwFG','vhHQr','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','qcApW','nGkjb','313623ykijjO','/hello','crypto_secretbox_KEYBYTES','YfoFD','pORPk','8Bqvsks'];_0x520b=function(){return _0xe8b0af;};return _0x520b();}