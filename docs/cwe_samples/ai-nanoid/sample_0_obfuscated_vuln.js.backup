const _0x1371ed=_0x58e6;function _0x490b(){const _0x3b5380=['raw','membersAuthEnumeration','LRgUg','loadMemberSession','BLMRc','updateEmailAddress','/api/feedback','Members\x20App\x20setup\x20end','Members\x20App\x20setup\x20start','delete','../../services/stripe','gJeEF','Uslmg','createCheckoutSession','put','enabledMiddleware','43532KTUbps','add','/api/member','trackSubscribed','endpoints','../announcement','MTVRq','ogmav','CSrhv','/api/create-stripe-update-session','195596CMKisj','bjGwh','members','xoRNI','61805LiGSIG','/api/member/email','membersAuth','../../../shared/config','../../services/members','WmUML','55096iHqTfx','../comments','51mFQlAW','108mQgKMO','createCheckoutSetupSession','exports','brute','5mb','use','/api/session','audienceFeedback','/api/member/suppression','cacheMembersContent:enabled','VSdLH','/api','50mb','@tryghost/debug','json','handle','application/json','accessInfoSession','createSessionFromMagicLink','updateMemberNewsletters','deleteSession','DtrBm','api','225dQMMYy','announcementBar','read','getMemberNewsletters','recommendationsPublic','gjhTO','/api/comments','2647146SvkkQv','caching:cors:maxAge','../../../shared/express','/webhooks/stripe','45364FuMeuw','/api/send-magic-link','@tryghost/mw-error-handler','authMemberByUuid','2281797uGgJHl','body-parser','NuwDn','SRivq','GrYOc','eoCfh','ihPtS','get','/api/recommendations/:id/subscribed','wnEtD','../../../shared/sentry','middleware','../shared','trackClicked','/api/subscriptions/:id','/api/member/newsletters','/api/create-stripe-checkout-session','SDEuW','hzhEQ','../../api','../../../shared/labs','pWfMd','private','post','getMemberData','handleJSONResponse','site','bind','XyCPS','sendMagicLink','webhookController','4150YgdzZa','jikWl','updateSubscription','cOROi'];_0x490b=function(){return _0x3b5380;};return _0x490b();}(function(_0x1d3bcb,_0x1ee7f1){const _0x4e6643=_0x58e6,_0x31559c=_0x1d3bcb();while(!![]){try{const _0x4689fc=parseInt(_0x4e6643(0x15f))/0x1+parseInt(_0x4e6643(0x1c5))/0x2*(-parseInt(_0x4e6643(0x16b))/0x3)+parseInt(_0x4e6643(0x16c))/0x4*(-parseInt(_0x4e6643(0x163))/0x5)+-parseInt(_0x4e6643(0x18a))/0x6+-parseInt(_0x4e6643(0x192))/0x7+-parseInt(_0x4e6643(0x169))/0x8*(parseInt(_0x4e6643(0x183))/0x9)+parseInt(_0x4e6643(0x1b1))/0xa*(parseInt(_0x4e6643(0x18e))/0xb);if(_0x4689fc===_0x1ee7f1)break;else _0x31559c['push'](_0x31559c['shift']());}catch(_0x4e3c7e){_0x31559c['push'](_0x31559c['shift']());}}}(_0x490b,0x4070e));const debug=require(_0x1371ed(0x179))(_0x1371ed(0x161)),cors=require('cors'),bodyParser=require(_0x1371ed(0x193)),express=require(_0x1371ed(0x18c)),sentry=require(_0x1371ed(0x19c)),membersService=require(_0x1371ed(0x167)),stripeService=require(_0x1371ed(0x1bf)),middleware=membersService[_0x1371ed(0x19d)],shared=require(_0x1371ed(0x19e)),labs=require(_0x1371ed(0x1a6)),errorHandler=require(_0x1371ed(0x190)),config=require(_0x1371ed(0x166)),{http}=require('@tryghost/api-framework'),api=require(_0x1371ed(0x1a5))[_0x1371ed(0x1c9)],commentRouter=require(_0x1371ed(0x16a)),announcementRouter=require(_0x1371ed(0x1ca));function _0x58e6(_0x569285,_0x2c515f){const _0x490b17=_0x490b();return _0x58e6=function(_0x58e657,_0x3e8e84){_0x58e657=_0x58e657-0x15b;let _0x3b3019=_0x490b17[_0x58e657];return _0x3b3019;},_0x58e6(_0x569285,_0x2c515f);}module[_0x1371ed(0x16e)]=function setupMembersApp(){const _0x5f3194=_0x1371ed,_0x414151={'DtrBm':function(_0x4820b3,_0x294af5){return _0x4820b3!==_0x294af5;},'hzhEQ':'TBRCi','bjGwh':_0x5f3194(0x1a7),'SDEuW':function(_0x164e02,_0x64fe90){return _0x164e02(_0x64fe90);},'ogmav':_0x5f3194(0x161),'LRgUg':_0x5f3194(0x1a8),'CSrhv':_0x5f3194(0x18b),'xoRNI':_0x5f3194(0x17c),'Uslmg':_0x5f3194(0x1a1),'eoCfh':_0x5f3194(0x178),'VSdLH':_0x5f3194(0x1c7),'XyCPS':_0x5f3194(0x164),'NuwDn':_0x5f3194(0x174),'cOROi':_0x5f3194(0x172),'USClN':_0x5f3194(0x1a2),'WmUML':_0x5f3194(0x15e),'wnEtD':_0x5f3194(0x1a0),'ihPtS':'/api/announcement','MTVRq':_0x5f3194(0x184),'AvmbE':'/api/recommendations/:id/clicked','gJeEF':function(_0x2d8330,_0x103987){return _0x2d8330(_0x103987);},'GrYOc':function(_0x235468,_0x4d1440){return _0x235468(_0x4d1440);},'jikWl':'/api/site','OFYoY':function(_0xfd150e,_0x3ed17b){return _0xfd150e(_0x3ed17b);},'BLMRc':_0x5f3194(0x177),'gjhTO':'/webhooks','Qhdkj':_0x5f3194(0x1bc)};debug(_0x5f3194(0x1bd));const _0x4ddd0d=_0x414151[_0x5f3194(0x1a3)](express,_0x414151[_0x5f3194(0x15c)]);_0x4ddd0d[_0x5f3194(0x171)](shared[_0x5f3194(0x19d)]['cacheControl'](_0x414151[_0x5f3194(0x1b7)])),_0x4ddd0d[_0x5f3194(0x171)](cors({'maxAge':config[_0x5f3194(0x199)](_0x414151[_0x5f3194(0x15d)])})),_0x4ddd0d['use'](middleware[_0x5f3194(0x17e)]),_0x4ddd0d[_0x5f3194(0x1a9)](_0x5f3194(0x18d),bodyParser[_0x5f3194(0x1b5)]({'type':_0x414151[_0x5f3194(0x162)]}),stripeService[_0x5f3194(0x1b0)][_0x5f3194(0x17b)][_0x5f3194(0x1ad)](stripeService[_0x5f3194(0x1b0)])),_0x4ddd0d['get'](_0x5f3194(0x1a1),middleware[_0x5f3194(0x186)]),_0x4ddd0d[_0x5f3194(0x1c3)](_0x414151[_0x5f3194(0x1c1)],bodyParser[_0x5f3194(0x17a)]({'limit':_0x414151[_0x5f3194(0x197)]}),middleware[_0x5f3194(0x17f)]);const _0x5ebbda=config[_0x5f3194(0x199)](_0x5f3194(0x175));return _0x5ebbda?_0x4ddd0d['get']('/api/member',middleware[_0x5f3194(0x1b8)],middleware[_0x5f3194(0x17d)],middleware[_0x5f3194(0x1aa)]):_0x4ddd0d[_0x5f3194(0x199)](_0x414151['VSdLH'],middleware['getMemberData']),_0x4ddd0d[_0x5f3194(0x1c3)](_0x414151[_0x5f3194(0x176)],bodyParser[_0x5f3194(0x17a)]({'limit':'50mb'}),middleware['updateMemberData']),_0x4ddd0d['post'](_0x414151[_0x5f3194(0x1ae)],bodyParser['json']({'limit':'50mb'}),(_0x15294f,_0x23aa12)=>membersService[_0x5f3194(0x182)]['middleware'][_0x5f3194(0x1ba)](_0x15294f,_0x23aa12)),_0x4ddd0d[_0x5f3194(0x1be)](_0x414151[_0x5f3194(0x194)],middleware['deleteSuppression']),_0x4ddd0d[_0x5f3194(0x199)](_0x5f3194(0x172),middleware['getIdentityToken']),_0x4ddd0d[_0x5f3194(0x1be)](_0x414151[_0x5f3194(0x1b4)],bodyParser['json']({'limit':_0x5f3194(0x170)}),middleware[_0x5f3194(0x180)]),_0x4ddd0d[_0x5f3194(0x1a9)](_0x5f3194(0x18f),bodyParser[_0x5f3194(0x17a)](),shared[_0x5f3194(0x19d)][_0x5f3194(0x16f)][_0x5f3194(0x1b6)],shared[_0x5f3194(0x19d)][_0x5f3194(0x16f)][_0x5f3194(0x165)],function _0x2280ea(_0x2167b4,_0x1b23ac,_0x16a2ed){const _0x16ee81=_0x5f3194;return _0x414151[_0x16ee81(0x181)](_0x16ee81(0x195),'erqAw')?membersService[_0x16ee81(0x182)][_0x16ee81(0x19d)][_0x16ee81(0x1af)](_0x2167b4,_0x1b23ac,_0x16a2ed):_0x1c46d1[_0x16ee81(0x182)]['middleware'][_0x16ee81(0x16d)](_0x525ead,_0x1eb9c9,_0x194e40);}),_0x4ddd0d[_0x5f3194(0x1a9)](_0x414151['USClN'],function _0x23d137(_0x1b897b,_0x1b3b77,_0x366d9e){const _0x2f8cc2=_0x5f3194;return membersService[_0x2f8cc2(0x182)][_0x2f8cc2(0x19d)][_0x2f8cc2(0x1c2)](_0x1b897b,_0x1b3b77,_0x366d9e);}),_0x4ddd0d[_0x5f3194(0x1a9)](_0x414151[_0x5f3194(0x168)],function _0x53fa43(_0x38e509,_0x335d0d,_0x133476){const _0x159819=_0x5f3194;return membersService[_0x159819(0x182)]['middleware'][_0x159819(0x16d)](_0x38e509,_0x335d0d,_0x133476);}),_0x4ddd0d[_0x5f3194(0x1c3)](_0x414151[_0x5f3194(0x19b)],function _0x405b40(_0x183ef6,_0x3c27a7,_0x4196ae){const _0xcf9711=_0x5f3194;return _0x414151[_0xcf9711(0x1a4)]!==_0x414151[_0xcf9711(0x160)]?membersService[_0xcf9711(0x182)][_0xcf9711(0x19d)]['updateSubscription'](_0x183ef6,_0x3c27a7,_0x4196ae):_0x3b57d6[_0xcf9711(0x182)][_0xcf9711(0x19d)][_0xcf9711(0x1b3)](_0x186a1e,_0x398818,_0x3ab7bf);}),_0x4ddd0d[_0x5f3194(0x171)](_0x5f3194(0x189),commentRouter()),_0x4ddd0d[_0x5f3194(0x1a9)](_0x5f3194(0x1bb),labs[_0x5f3194(0x1c4)](_0x5f3194(0x173)),bodyParser[_0x5f3194(0x17a)]({'limit':_0x414151[_0x5f3194(0x197)]}),middleware[_0x5f3194(0x1b8)],middleware[_0x5f3194(0x191)],_0x414151[_0x5f3194(0x1a3)](http,api['feedbackMembers'][_0x5f3194(0x1c6)])),_0x4ddd0d[_0x5f3194(0x171)](_0x414151[_0x5f3194(0x198)],labs['enabledMiddleware'](_0x414151[_0x5f3194(0x15b)]),middleware[_0x5f3194(0x1b8)],announcementRouter()),_0x4ddd0d['post'](_0x414151['AvmbE'],middleware[_0x5f3194(0x1b8)],_0x414151[_0x5f3194(0x1c0)](http,api[_0x5f3194(0x187)][_0x5f3194(0x19f)])),_0x4ddd0d['post'](_0x5f3194(0x19a),middleware[_0x5f3194(0x1b8)],_0x414151[_0x5f3194(0x196)](http,api[_0x5f3194(0x187)][_0x5f3194(0x1c8)])),_0x4ddd0d[_0x5f3194(0x199)](_0x414151[_0x5f3194(0x1b2)],_0x414151['OFYoY'](http,api[_0x5f3194(0x1ac)][_0x5f3194(0x185)])),_0x4ddd0d[_0x5f3194(0x171)](_0x414151[_0x5f3194(0x1b9)],errorHandler['resourceNotFound']),_0x4ddd0d['use'](_0x414151[_0x5f3194(0x1b9)],errorHandler[_0x5f3194(0x1ab)](sentry)),_0x4ddd0d[_0x5f3194(0x171)]('/webhooks',errorHandler['resourceNotFound']),_0x4ddd0d[_0x5f3194(0x171)](_0x414151[_0x5f3194(0x188)],errorHandler['handleJSONResponse'](sentry)),debug(_0x414151['Qhdkj']),_0x4ddd0d;};