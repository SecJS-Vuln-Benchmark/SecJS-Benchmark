function _0x3ada(_0x33aaea,_0x192416){const _0x50eb21=_0x50eb();return _0x3ada=function(_0x3adaf6,_0x55b5c4){_0x3adaf6=_0x3adaf6-0x1ea;let _0x5490e4=_0x50eb21[_0x3adaf6];return _0x5490e4;},_0x3ada(_0x33aaea,_0x192416);}const _0x445cea=_0x3ada;(function(_0x49f807,_0x32f884){const _0x39226c=_0x3ada,_0xe2de5f=_0x49f807();while(!![]){try{const _0x6b059=parseInt(_0x39226c(0x262))/0x1+parseInt(_0x39226c(0x276))/0x2*(parseInt(_0x39226c(0x1f4))/0x3)+-parseInt(_0x39226c(0x202))/0x4*(-parseInt(_0x39226c(0x25b))/0x5)+parseInt(_0x39226c(0x231))/0x6*(-parseInt(_0x39226c(0x21b))/0x7)+parseInt(_0x39226c(0x229))/0x8*(parseInt(_0x39226c(0x272))/0x9)+parseInt(_0x39226c(0x259))/0xa*(-parseInt(_0x39226c(0x260))/0xb)+-parseInt(_0x39226c(0x244))/0xc*(parseInt(_0x39226c(0x207))/0xd);if(_0x6b059===_0x32f884)break;else _0xe2de5f['push'](_0xe2de5f['shift']());}catch(_0xd5f193){_0xe2de5f['push'](_0xe2de5f['shift']());}}}(_0x50eb,0xa7af6));const {assert,expect}=require(_0x445cea(0x1f7)),{describe,before,beforeEach,after,afterEach,it}=require(_0x445cea(0x217)),sinon=require(_0x445cea(0x22d)),{mockRequest,mockResponse}=require(_0x445cea(0x25e)),{randomUUID,randomBytes}=require(_0x445cea(0x249)),csurf=require(_0x445cea(0x261)),{encryptCookie,decryptCookie,verifyCsrf}=require(_0x445cea(0x228));function _0x50eb(){const _0x51bef2=['icdbt','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect','args','YDdte','QLjjs','hpFyV','290EWChKI','laDOn','6395OjWzKZ','UCKQb','cookie','mock-req-res','GTCpo','173393aXcVwv','./index','1066187NHWhzH','POST','tNkXJ','oylfY','allows\x20if\x20the\x20method\x20is\x20specified\x20as\x20not\x20included','EBtBJ','OtiZr','tjzaI','throws','notEqual','QnWkt','sVIry','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded\x20as\x20a\x20regexp','beYMC','YauRH','aaaa','9117OZgvXA','aDupJ','VNwVs','equal','327670DRJHyc','JlcDR','HAWpr','isString','sHrBg','name','ZWKXD','csrf','throws\x20internal\x20error\x20if\x20we\x20have\x20no\x20cookies','Txrva','GLmMi','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20was\x20never\x20generated','18ozxLxj','HYQsB','yvWVf','chai','Should\x20not\x20be\x20able\x20to\x20verify\x20without\x20the\x20secret','jhzRv','message','/somethingElse','open','Should\x20not\x20verify\x20random\x20UUID\x20tokens','calledOnce','stub','generates\x20token\x20for\x20non-POST\x20request','xuZYE','1696YcVJqI','zupcN','isNotFunction','123456789iamasecret987654321look','ijtjM','9935614fRoKkL','aaaaa','tEfqs','GlpAB','aaaabbb','isFunction','mkoHQ','YVMxn','EEKlc','cBoSu','Error','ShfJi','getCall','allows\x20if\x20the\x20CSRF\x20token\x20is\x20correct','Nlszf','Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token','mocha','dnrkO','jTbOt','/detail/603f31d8-9615-40a4-a609-f7bd9059ee6c','520485xzRHGb','EYary','NLebS','olaCz','nOvFb','Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request','OWRqX','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20missing\x20in\x20body','nmcnr','hscTf','VqTNc','BqXTU','jVlyp','./encryption','9448PhThoe','hex','LofJz','secret','sinon','Both\x20are\x20equal\x20as\x20plain\x20string\x20and\x20shouldn\x27t\x20be','BqaLO','UBQZB','90FUaHlO','tCiTS','dmupz','fJyUk','No\x20Cookie\x20middleware\x20is\x20installed','isFalse','Cookie\x20Encryption\x20Tests','zTWmE','Should\x20not\x20verify\x20random\x20blank\x20tokens','WfNMe','https://api.github.com/repos/public/repo','csrfToken','PUT','eYPYS','bpryF','EQbwd','isTrue','yGuNL','Should\x20not\x20verify\x20random\x20null\x20tokens','24iVSWKz','BWVrG','TEBZv','EVmJc','GET','crypto','throw\x20internal\x20error\x20if\x20our\x20secret\x20is\x20not\x20long\x20enough','CJGNS','Default\x20Options\x20Tests','Tests\x20w/Specified\x20Excluded\x20URLs','imnotlongenough','include','toString','fLGwy','xhPaI'];_0x50eb=function(){return _0x51bef2;};return _0x50eb();}describe(_0x445cea(0x237),()=>{const _0x133580=_0x445cea,_0x5039dc={'yvWVf':_0x133580(0x205),'sHrBg':function(_0x125f17){return _0x125f17();},'icdbt':function(_0x261bf2,_0x4f1675,_0x3d8ea9){return _0x261bf2(_0x4f1675,_0x3d8ea9);},'OWRqX':_0x133580(0x22e),'GlpAB':function(_0x4f2d75,_0x20c8e6,_0x5505cf,_0x2fc001){return _0x4f2d75(_0x20c8e6,_0x5505cf,_0x2fc001);},'YVMxn':function(_0x23c871,_0x56f56b){return _0x23c871(_0x56f56b);},'CJGNS':_0x133580(0x22a),'laDOn':_0x133580(0x1f8),'QnWkt':_0x133580(0x239),'npyOq':function(_0x3d6d9c,_0x13f3a0){return _0x3d6d9c(_0x13f3a0);},'bpryF':'will\x20encrypt\x20and\x20decrypt\x20a\x20cookie'};before(()=>{}),_0x5039dc['npyOq'](after,()=>{}),_0x5039dc[_0x133580(0x253)](it,_0x5039dc[_0x133580(0x23f)],()=>{const _0x34667f=_0x133580,_0x33c6b4=_0x5039dc[_0x34667f(0x1f6)],_0x4fff2c=_0x5039dc[_0x34667f(0x1ec)](randomUUID),_0x632a08=_0x5039dc[_0x34667f(0x253)](encryptCookie,_0x4fff2c,_0x33c6b4);assert[_0x34667f(0x26b)](_0x4fff2c,_0x632a08,_0x5039dc[_0x34667f(0x221)]),assert['isTrue'](verifyCsrf(_0x4fff2c,_0x632a08,_0x33c6b4)),assert[_0x34667f(0x236)](_0x5039dc[_0x34667f(0x20a)](verifyCsrf,_0x4fff2c,_0x632a08,_0x5039dc[_0x34667f(0x20e)](randomBytes,0x10)['toString'](_0x5039dc[_0x34667f(0x24b)])),_0x5039dc[_0x34667f(0x25a)]),assert[_0x34667f(0x236)](_0x5039dc['GlpAB'](verifyCsrf,randomUUID(),_0x632a08,_0x33c6b4),_0x34667f(0x1fd)),assert[_0x34667f(0x236)](_0x5039dc[_0x34667f(0x20a)](verifyCsrf,'',_0x632a08,_0x33c6b4),_0x5039dc[_0x34667f(0x26c)]),assert['isFalse'](verifyCsrf(null,_0x632a08,_0x33c6b4),_0x34667f(0x243));});}),describe(_0x445cea(0x24c),()=>{const _0x5e9894=_0x445cea,_0x1f87bf={'zTWmE':function(_0xda84){return _0xda84();},'hscTf':function(_0x228223,_0x8aac09,_0x34e02f){return _0x228223(_0x8aac09,_0x34e02f);},'Nlszf':_0x5e9894(0x22e),'VNwVs':function(_0x168d3d,_0x3cdc87,_0x5c72cc,_0x7daf26){return _0x168d3d(_0x3cdc87,_0x5c72cc,_0x7daf26);},'nOvFb':function(_0x2905ac,_0xb6220){return _0x2905ac(_0xb6220);},'Txrva':_0x5e9894(0x22a),'oylfY':_0x5e9894(0x1f8),'cBoSu':function(_0x49881a){return _0x49881a();},'WfzWY':'Should\x20not\x20verify\x20random\x20UUID\x20tokens','mkoHQ':_0x5e9894(0x239),'dnrkO':'NGPVO','OtiZr':_0x5e9894(0x211),'whfta':_0x5e9894(0x248),'jhzRv':'csrfToken','yGuNL':function(_0x1d5113,_0x5e0837){return _0x1d5113(_0x5e0837);},'NYRQA':'aaaa','QLjjs':function(_0x3e56ea,_0x5663db,_0x51d4c8){return _0x3e56ea(_0x5663db,_0x51d4c8);},'IzpTo':_0x5e9894(0x20b),'EBtBJ':_0x5e9894(0x216),'sVIry':function(_0xf26bee,_0x5f3c8e){return _0xf26bee(_0x5f3c8e);},'tjzaI':_0x5e9894(0x263),'HYQsB':function(_0x2aaf2c,_0x21a5eb){return _0x2aaf2c(_0x21a5eb);},'eYPYS':_0x5e9894(0x24a),'VqTNc':_0x5e9894(0x1f0),'uQZsr':_0x5e9894(0x254),'beYMC':_0x5e9894(0x222)};_0x1f87bf[_0x5e9894(0x1f5)](before,()=>{const _0x4f6a71=_0x5e9894;this['secret']=_0x4f6a71(0x205),this['csrf']=csurf(this[_0x4f6a71(0x22c)]);}),it(_0x1f87bf[_0x5e9894(0x23e)],()=>{const _0x3ddcef=_0x5e9894;assert[_0x3ddcef(0x26a)](()=>csurf(_0x3ddcef(0x24e)));}),it(_0x1f87bf[_0x5e9894(0x225)],()=>{const _0x480e08=_0x5e9894,_0x4336c2=mockRequest({'cookies':null}),_0x13cd17=mockResponse({'cookie':null}),_0x44bdd3=sinon[_0x480e08(0x1ff)]();try{this[_0x480e08(0x1ef)](_0x4336c2,_0x13cd17,_0x44bdd3);}catch(_0x2269b7){if(_0x480e08(0x247)===_0x1f87bf[_0x480e08(0x218)]){const _0x298733=_0x480e08(0x205),_0xc9ab55=_0x1f87bf[_0x480e08(0x238)](_0x5a1494),_0x2e0e81=_0x1f87bf[_0x480e08(0x224)](_0x5c8b0c,_0xc9ab55,_0x298733);_0x34b8a4[_0x480e08(0x26b)](_0xc9ab55,_0x2e0e81,_0x1f87bf[_0x480e08(0x215)]),_0xe0a0b3[_0x480e08(0x241)](_0x1f87bf['VNwVs'](_0x2b8282,_0xc9ab55,_0x2e0e81,_0x298733)),_0x150ed4[_0x480e08(0x236)](_0x1f87bf[_0x480e08(0x274)](_0x1f8d40,_0xc9ab55,_0x2e0e81,_0x1f87bf[_0x480e08(0x21f)](_0x559ac0,0x10)[_0x480e08(0x250)](_0x1f87bf[_0x480e08(0x1f1)])),_0x1f87bf[_0x480e08(0x265)]),_0x548429[_0x480e08(0x236)](_0x1f87bf[_0x480e08(0x274)](_0x2af290,_0x1f87bf[_0x480e08(0x210)](_0x3decd2),_0x2e0e81,_0x298733),_0x1f87bf['WfzWY']),_0x3fca35['isFalse'](_0x5552f4('',_0x2e0e81,_0x298733),_0x1f87bf[_0x480e08(0x20d)]),_0x5ee67c[_0x480e08(0x236)](_0x147c04(null,_0x2e0e81,_0x298733),'Should\x20not\x20verify\x20random\x20null\x20tokens');}else assert[_0x480e08(0x275)](_0x2269b7[_0x480e08(0x1ed)],_0x1f87bf[_0x480e08(0x268)],_0x2269b7),assert['equal'](_0x2269b7[_0x480e08(0x1fa)],_0x480e08(0x235));}}),it(_0x5e9894(0x200),()=>{const _0x496722=_0x5e9894,_0xa4bace=_0x1f87bf[_0x496722(0x21f)](mockRequest,{'method':_0x1f87bf['whfta'],'signedCookies':{},'body':{}}),_0x3aa1ba=mockResponse({'cookie':sinon[_0x496722(0x1ff)]()}),_0x427322=sinon[_0x496722(0x1ff)]();assert[_0x496722(0x204)](_0xa4bace['csrfToken']),this['csrf'](_0xa4bace,_0x3aa1ba,_0x427322),assert[_0x496722(0x20c)](_0xa4bace[_0x496722(0x23c)]),_0xa4bace[_0x496722(0x23c)](),assert[_0x496722(0x241)](_0x3aa1ba[_0x496722(0x25d)]['calledOnce']),assert[_0x496722(0x275)](_0x3aa1ba['cookie'][_0x496722(0x213)](0x0)[_0x496722(0x255)][0x0],_0x1f87bf[_0x496722(0x1f9)]),assert[_0x496722(0x1eb)](_0x3aa1ba['cookie']['getCall'](0x0)[_0x496722(0x255)][0x1]);}),it(_0x5e9894(0x214),()=>{const _0xbe4ca9=_0x5e9894,_0x26864c=mockRequest({'method':_0xbe4ca9(0x263),'signedCookies':{'csrfToken':encryptCookie(_0xbe4ca9(0x271),this[_0xbe4ca9(0x22c)])},'body':{'_csrf':_0xbe4ca9(0x271)}}),_0x489c8f=_0x1f87bf[_0xbe4ca9(0x242)](mockResponse,{'cookie':sinon[_0xbe4ca9(0x1ff)]()}),_0x48ce26=sinon[_0xbe4ca9(0x1ff)]();assert['isNotFunction'](_0x26864c['csrfToken']),this[_0xbe4ca9(0x1ef)](_0x26864c,_0x489c8f,_0x48ce26),assert[_0xbe4ca9(0x241)](_0x48ce26['calledOnce']);}),_0x1f87bf['QLjjs'](it,_0x1f87bf['uQZsr'],()=>{const _0xc27c48=_0x5e9894,_0x3d9c0a=mockRequest({'method':_0xc27c48(0x263),'signedCookies':{'csrfToken':_0x1f87bf[_0xc27c48(0x224)](encryptCookie,_0xc27c48(0x20b),this[_0xc27c48(0x22c)])},'body':{'_csrf':_0x1f87bf['NYRQA']}}),_0x3a885c=_0x1f87bf[_0xc27c48(0x21f)](mockResponse,{'cookie':sinon[_0xc27c48(0x1ff)]()}),_0x1481cb=sinon['stub']();assert[_0xc27c48(0x204)](_0x3d9c0a['csrfToken']);try{this[_0xc27c48(0x1ef)](_0x3d9c0a,_0x3a885c,_0x1481cb);}catch(_0x373d25){assert[_0xc27c48(0x275)](_0x373d25['name'],_0xc27c48(0x211)),assert[_0xc27c48(0x24f)](_0x373d25[_0xc27c48(0x1fa)],_0xc27c48(0x216));}assert[_0xc27c48(0x236)](_0x1481cb[_0xc27c48(0x1fe)]);}),it(_0x1f87bf[_0x5e9894(0x26f)],()=>{const _0x2e9132=_0x5e9894,_0x5bbf92=_0x1f87bf['nOvFb'](mockRequest,{'method':'POST','signedCookies':{'csrfToken':_0x1f87bf[_0x2e9132(0x257)](encryptCookie,_0x1f87bf['IzpTo'],this[_0x2e9132(0x22c)])},'body':{}}),_0x26c1b9=mockResponse({'cookie':sinon[_0x2e9132(0x1ff)]()}),_0x352f66=sinon[_0x2e9132(0x1ff)]();assert[_0x2e9132(0x204)](_0x5bbf92[_0x2e9132(0x23c)]);try{this[_0x2e9132(0x1ef)](_0x5bbf92,_0x26c1b9,_0x352f66);}catch(_0x52c4b3){assert[_0x2e9132(0x275)](_0x52c4b3[_0x2e9132(0x1ed)],_0x1f87bf['OtiZr']),assert[_0x2e9132(0x24f)](_0x52c4b3[_0x2e9132(0x1fa)],_0x1f87bf[_0x2e9132(0x267)]);}assert[_0x2e9132(0x236)](_0x352f66['calledOnce']);}),it(_0x5e9894(0x1f3),()=>{const _0x39c186=_0x5e9894,_0x9820b5=_0x1f87bf[_0x39c186(0x26d)](mockRequest,{'method':_0x1f87bf[_0x39c186(0x269)],'signedCookies':{},'body':{}}),_0x5804cd=mockResponse({'cookie':sinon[_0x39c186(0x1ff)]()}),_0x30b7f1=sinon[_0x39c186(0x1ff)]();assert[_0x39c186(0x204)](_0x9820b5[_0x39c186(0x23c)]);try{this['csrf'](_0x9820b5,_0x5804cd,_0x30b7f1);}catch(_0x4b8dc2){assert[_0x39c186(0x275)](_0x4b8dc2[_0x39c186(0x1ed)],_0x1f87bf[_0x39c186(0x268)]),assert[_0x39c186(0x24f)](_0x4b8dc2['message'],'Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token');}assert[_0x39c186(0x236)](_0x30b7f1['calledOnce']);});}),describe('Tests\x20w/Specified\x20Included\x20Request\x20Methods',()=>{const _0x23d636=_0x445cea,_0x3a62d9={'YDdte':'POST','olaCz':function(_0xe9e0ea,_0x1f2c88){return _0xe9e0ea===_0x1f2c88;},'ZWKXD':'aaaa','UCKQb':function(_0x37a0cf,_0x425de5){return _0x37a0cf(_0x425de5);},'XhqPj':_0x23d636(0x23d),'NLebS':function(_0x4aeefb,_0x200c00,_0x41ed6c){return _0x4aeefb(_0x200c00,_0x41ed6c);},'mbnTK':'aaaabbb','UBQZB':function(_0x375c1c,_0xb0be22){return _0x375c1c(_0xb0be22);},'aAkvn':_0x23d636(0x223),'fJyUk':_0x23d636(0x211),'nagGP':_0x23d636(0x214),'Drqwd':function(_0x2828fe,_0x39e7f5,_0x603c88){return _0x2828fe(_0x39e7f5,_0x603c88);},'BqaLO':_0x23d636(0x248),'tEfqs':_0x23d636(0x23b)};before(()=>{const _0x32d1ff=_0x23d636;this['secret']=_0x32d1ff(0x205),this[_0x32d1ff(0x1ef)]=csurf(this['secret'],[_0x3a62d9[_0x32d1ff(0x256)],_0x32d1ff(0x23d)],[]);}),it(_0x3a62d9['nagGP'],()=>{const _0xcaad18=_0x23d636;if(_0x3a62d9[_0xcaad18(0x21e)](_0xcaad18(0x203),_0xcaad18(0x203))){const _0x488dbd=mockRequest({'method':'PUT','signedCookies':{'csrfToken':encryptCookie(_0x3a62d9['ZWKXD'],this[_0xcaad18(0x22c)])},'body':{'_csrf':_0x3a62d9[_0xcaad18(0x1ee)]}}),_0x2733b4=_0x3a62d9[_0xcaad18(0x25c)](mockResponse,{'cookie':sinon[_0xcaad18(0x1ff)]()}),_0x5bdd08=sinon[_0xcaad18(0x1ff)]();assert[_0xcaad18(0x204)](_0x488dbd['csrfToken']),this['csrf'](_0x488dbd,_0x2733b4,_0x5bdd08),assert[_0xcaad18(0x241)](_0x5bdd08[_0xcaad18(0x1fe)]);}else this[_0xcaad18(0x1ef)](_0x4b730a,_0x109f21,_0x52ea8b);}),_0x3a62d9['Drqwd'](it,'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect',()=>{const _0x534a5d=_0x23d636,_0x4001a0=mockRequest({'method':_0x3a62d9['XhqPj'],'signedCookies':{'csrfToken':_0x3a62d9[_0x534a5d(0x21d)](encryptCookie,_0x3a62d9['mbnTK'],this[_0x534a5d(0x22c)])},'body':{'_csrf':_0x3a62d9[_0x534a5d(0x1ee)]}}),_0x470f59=_0x3a62d9[_0x534a5d(0x230)](mockResponse,{'cookie':sinon['stub']()}),_0x4ed3a2=sinon[_0x534a5d(0x1ff)]();assert['isNotFunction'](_0x4001a0[_0x534a5d(0x23c)]);try{this[_0x534a5d(0x1ef)](_0x4001a0,_0x470f59,_0x4ed3a2);}catch(_0x206728){'lTKVY'!==_0x3a62d9['aAkvn']?(assert['equal'](_0x206728[_0x534a5d(0x1ed)],_0x3a62d9[_0x534a5d(0x234)]),assert[_0x534a5d(0x24f)](_0x206728[_0x534a5d(0x1fa)],'Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token')):this[_0x534a5d(0x1ef)](_0x420682,_0x15d0f5,_0x13f7a8);}assert[_0x534a5d(0x236)](_0x4ed3a2[_0x534a5d(0x1fe)]);}),it(_0x23d636(0x266),()=>{const _0x275410=_0x23d636,_0x115fd2=_0x3a62d9['UCKQb'](mockRequest,{'method':'GET','signedCookies':{'csrfToken':encryptCookie(_0x3a62d9[_0x275410(0x1ee)],this['secret'])},'body':{'_csrf':''}}),_0x29e048=mockResponse({'cookie':sinon['stub']()}),_0x5d551e=sinon['stub']();assert[_0x275410(0x204)](_0x115fd2[_0x275410(0x23c)]),this['csrf'](_0x115fd2,_0x29e048,_0x5d551e),assert[_0x275410(0x241)](_0x5d551e[_0x275410(0x1fe)]);}),xhr[_0x23d636(0x1fc)](_0x3a62d9[_0x23d636(0x22f)],_0x3a62d9[_0x23d636(0x209)]);}),describe(_0x445cea(0x24d),()=>{const _0xdc7233=_0x445cea,_0x359c82={'ShfJi':function(_0x190397,_0x1249f3){return _0x190397(_0x1249f3);},'jVlyp':function(_0x11888d,_0x34d144,_0x571eca){return _0x11888d(_0x34d144,_0x571eca);},'HAWpr':'aaaabbb','GLmMi':'uxkwe','jTbOt':'/detail','EQbwd':_0xdc7233(0x263),'JlcDR':function(_0x1d5657,_0x5b1ef2){return _0x1d5657(_0x5b1ef2);},'tNkXJ':function(_0x55840d,_0x3c98af){return _0x55840d===_0x3c98af;},'YauRH':_0xdc7233(0x22b),'tCiTS':function(_0x44dfff,_0x4c9e35){return _0x44dfff(_0x4c9e35);},'aDupJ':_0xdc7233(0x211),'dmupz':_0xdc7233(0x252),'GTCpo':_0xdc7233(0x226),'EYary':_0xdc7233(0x220),'BWVrG':_0xdc7233(0x271),'WfNMe':'allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded','hpFyV':_0xdc7233(0x26e),'TEBZv':function(_0x5abee0,_0x5e250c,_0x21e1ef){return _0x5abee0(_0x5e250c,_0x21e1ef);},'EEKlc':'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect\x20and\x20the\x20URL\x20is\x20not\x20marked\x20as\x20excluded'};before(()=>{const _0x26324a=_0xdc7233;if(_0x359c82[_0x26324a(0x1f2)]!=='uxkwe'){const _0x276cf8=_0x359c82[_0x26324a(0x212)](_0xcc0d7e,{'method':_0x26324a(0x23d),'signedCookies':{'csrfToken':_0x359c82[_0x26324a(0x227)](_0x325271,_0x359c82[_0x26324a(0x1ea)],this[_0x26324a(0x22c)])},'body':{'_csrf':_0x26324a(0x271)}}),_0x1dce35=_0x359c82[_0x26324a(0x212)](_0x346631,{'cookie':_0x1802f6[_0x26324a(0x1ff)]()}),_0x926c8f=_0x57d7e7[_0x26324a(0x1ff)]();_0x3a6ec2['isNotFunction'](_0x276cf8[_0x26324a(0x23c)]);try{this['csrf'](_0x276cf8,_0x1dce35,_0x926c8f);}catch(_0x45b913){_0x1b70a9[_0x26324a(0x275)](_0x45b913[_0x26324a(0x1ed)],'Error'),_0x3485d4[_0x26324a(0x24f)](_0x45b913[_0x26324a(0x1fa)],'Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token');}_0x4035a4['isFalse'](_0x926c8f['calledOnce']);}else this[_0x26324a(0x22c)]=_0x26324a(0x205),this[_0x26324a(0x1ef)]=csurf(this[_0x26324a(0x22c)],null,[_0x359c82['jTbOt'],/\/detail\.*/i]);}),_0x359c82[_0xdc7233(0x227)](it,_0x359c82[_0xdc7233(0x23a)],()=>{const _0x100219=_0xdc7233,_0x33ecfb=mockRequest({'method':_0x359c82[_0x100219(0x240)],'signedCookies':{'csrfToken':encryptCookie(_0x100219(0x208),this[_0x100219(0x22c)])},'body':{'_csrf':''},'originalUrl':_0x359c82[_0x100219(0x219)]}),_0x34b9e2=_0x359c82[_0x100219(0x277)](mockResponse,{'cookie':sinon['stub']()}),_0x564fa5=sinon[_0x100219(0x1ff)]();assert[_0x100219(0x204)](_0x33ecfb['csrfToken']),this['csrf'](_0x33ecfb,_0x34b9e2,_0x564fa5),assert[_0x100219(0x241)](_0x564fa5[_0x100219(0x1fe)]),assert['isFunction'](_0x33ecfb['csrfToken'],_0x100219(0x220));}),it(_0x359c82[_0xdc7233(0x258)],()=>{const _0x41125d=_0xdc7233;if(_0x359c82[_0x41125d(0x264)](_0x359c82[_0x41125d(0x270)],_0x41125d(0x22b))){const _0x4a3635=_0x359c82[_0x41125d(0x232)](mockRequest,{'method':_0x41125d(0x263),'signedCookies':{'csrfToken':encryptCookie('aaaaa',this[_0x41125d(0x22c)])},'body':{'_csrf':''},'originalUrl':_0x41125d(0x21a)}),_0x16a0c2=mockResponse({'cookie':sinon[_0x41125d(0x1ff)]()}),_0x2a0d24=sinon[_0x41125d(0x1ff)]();assert[_0x41125d(0x204)](_0x4a3635[_0x41125d(0x23c)]),this['csrf'](_0x4a3635,_0x16a0c2,_0x2a0d24),assert[_0x41125d(0x241)](_0x2a0d24['calledOnce']),assert['isFunction'](_0x4a3635[_0x41125d(0x23c)],'Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request');}else _0x58b0f0['equal'](_0x7a286['name'],_0x41125d(0x211)),_0x5de294['include'](_0x26ca5d[_0x41125d(0x1fa)],_0x41125d(0x216));}),_0x359c82[_0xdc7233(0x227)](it,'generates\x20a\x20new\x20token\x20if\x20no\x20token\x20is\x20supplied',()=>{const _0x2a7668=_0xdc7233,_0x3c0c88={'fLGwy':function(_0x4d508e,_0x3dac35){const _0xd3b7ee=_0x3ada;return _0x359c82[_0xd3b7ee(0x232)](_0x4d508e,_0x3dac35);},'xuZYE':_0x359c82[_0x2a7668(0x273)]};if(_0x359c82[_0x2a7668(0x233)]===_0x359c82[_0x2a7668(0x25f)]){const _0x35b347=_0x3c0c88[_0x2a7668(0x251)](_0xa5133,{'cookies':null}),_0x5c7b20=_0x3c0c88['fLGwy'](_0x13bf52,{'cookie':null}),_0x3a1920=_0x558e22[_0x2a7668(0x1ff)]();try{this[_0x2a7668(0x1ef)](_0x35b347,_0x5c7b20,_0x3a1920);}catch(_0x3f0242){_0x312eb4[_0x2a7668(0x275)](_0x3f0242['name'],_0x3c0c88[_0x2a7668(0x201)],_0x3f0242),_0x1b172b[_0x2a7668(0x275)](_0x3f0242[_0x2a7668(0x1fa)],_0x2a7668(0x235));}}else{const _0x2d08da=mockRequest({'method':'POST','signedCookies':{},'body':{'_csrf':''},'originalUrl':'/detail'}),_0x32a385=mockResponse({'cookie':sinon[_0x2a7668(0x1ff)]()}),_0x46fd81=sinon[_0x2a7668(0x1ff)]();assert[_0x2a7668(0x204)](_0x2d08da[_0x2a7668(0x23c)]),this['csrf'](_0x2d08da,_0x32a385,_0x46fd81),assert['isTrue'](_0x46fd81['calledOnce']),assert[_0x2a7668(0x20c)](_0x2d08da[_0x2a7668(0x23c)],_0x359c82[_0x2a7668(0x21c)]);const _0x13e4d5=_0x2d08da[_0x2a7668(0x23c)]();assert['isString'](_0x13e4d5);}}),_0x359c82[_0xdc7233(0x246)](it,_0x359c82[_0xdc7233(0x20f)],()=>{const _0x58e1fa=_0xdc7233,_0x5959c5=_0x359c82[_0x58e1fa(0x212)](mockRequest,{'method':_0x58e1fa(0x263),'signedCookies':{'csrfToken':_0x359c82[_0x58e1fa(0x1ea)]},'body':{'_csrf':'aaaa'},'orignalUrl':_0x58e1fa(0x1fb)}),_0x462dae=_0x359c82['tCiTS'](mockResponse,{'cookie':sinon['stub']()}),_0x38106b=sinon['stub']();assert['isNotFunction'](_0x5959c5[_0x58e1fa(0x23c)]);try{if(_0x359c82[_0x58e1fa(0x264)](_0x58e1fa(0x206),_0x58e1fa(0x206)))this['csrf'](_0x5959c5,_0x462dae,_0x38106b);else{const _0x157384=_0x359c82[_0x58e1fa(0x277)](_0x5ca206,{'method':'PUT','signedCookies':{'csrfToken':_0x240222(_0x359c82[_0x58e1fa(0x245)],this[_0x58e1fa(0x22c)])},'body':{'_csrf':_0x359c82[_0x58e1fa(0x245)]}}),_0x11c731=_0x4a8dff({'cookie':_0x4212b0[_0x58e1fa(0x1ff)]()}),_0x111d70=_0x25089f[_0x58e1fa(0x1ff)]();_0x346b02[_0x58e1fa(0x204)](_0x157384['csrfToken']),this['csrf'](_0x157384,_0x11c731,_0x111d70),_0x4cd21c['isTrue'](_0x111d70[_0x58e1fa(0x1fe)]);}}catch(_0x3cefbe){assert[_0x58e1fa(0x275)](_0x3cefbe[_0x58e1fa(0x1ed)],_0x359c82[_0x58e1fa(0x273)]),assert['include'](_0x3cefbe[_0x58e1fa(0x1fa)],_0x58e1fa(0x216));}assert[_0x58e1fa(0x236)](_0x38106b[_0x58e1fa(0x1fe)]);});});