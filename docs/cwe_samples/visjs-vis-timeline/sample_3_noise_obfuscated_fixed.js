const _0x4f5301=_0x4b94;(function(_0x4bdab8,_0x3a4c6f){const _0x2b0961=_0x4b94,_0xd11602=_0x4bdab8();while(!![]){try{const _0x54472e=parseInt(_0x2b0961(0x131))/0x1*(-parseInt(_0x2b0961(0x10a))/0x2)+parseInt(_0x2b0961(0xfb))/0x3+-parseInt(_0x2b0961(0x119))/0x4*(parseInt(_0x2b0961(0xe8))/0x5)+-parseInt(_0x2b0961(0x12c))/0x6*(parseInt(_0x2b0961(0x11e))/0x7)+parseInt(_0x2b0961(0x130))/0x8*(parseInt(_0x2b0961(0xf8))/0x9)+-parseInt(_0x2b0961(0x101))/0xa+parseInt(_0x2b0961(0x135))/0xb;if(_0x54472e===_0x3a4c6f)break;else _0xd11602['push'](_0xd11602['shift']());}catch(_0x4ec6ef){_0xd11602['push'](_0xd11602['shift']());}}}(_0x1cf8,0xe22f8));function _0x4b94(_0x3aefc6,_0x4cb7b7){const _0x1cf899=_0x1cf8();return _0x4b94=function(_0x4b9475,_0x30ce95){_0x4b9475=_0x4b9475-0xdc;let _0x478b4d=_0x1cf899[_0x4b9475];return _0x478b4d;},_0x4b94(_0x3aefc6,_0x4cb7b7);}const {assert,expect}=require(_0x4f5301(0xfa)),{describe,before,beforeEach,after,afterEach,it}=require(_0x4f5301(0x128)),sinon=require(_0x4f5301(0x12e)),{mockRequest,mockResponse}=require('mock-req-res'),csurf=require(_0x4f5301(0x12d));describe(_0x4f5301(0xef),()=>{const _0x2781b8=_0x4f5301,_0x2dcbe1={'wxUMB':function(_0x3bc7a5,_0x193205,_0x4a58f9){return _0x3bc7a5(_0x193205,_0x4a58f9);},'nXHnf':_0x2781b8(0x108),'VKBxk':function(_0xbf53b6,_0x2e48b7){return _0xbf53b6(_0x2e48b7);},'NSAIx':_0x2781b8(0x136),'MASqg':_0x2781b8(0xf3),'eChTL':_0x2781b8(0x10c),'ajZOw':_0x2781b8(0xf5),'wcQmo':'Did\x20not\x20get\x20a\x20CSRF\x20token','hLqoq':_0x2781b8(0x115),'YNiPL':_0x2781b8(0x127),'RakhZ':function(_0x5502e6,_0x1ad68,_0x2a6249){return _0x5502e6(_0x1ad68,_0x2a6249);},'tjawz':'allows\x20if\x20the\x20CSRF\x20token\x20is\x20correct','AOLvX':function(_0x522495,_0x3867a0,_0x2d639e){return _0x522495(_0x3867a0,_0x2d639e);},'UYcqq':_0x2781b8(0xdc),'akxDa':function(_0xe06ff1,_0x3363c2,_0x100d49){return _0xe06ff1(_0x3363c2,_0x100d49);}};_0x2dcbe1['VKBxk'](before,()=>{const _0xa17f99=_0x2781b8;this[_0xa17f99(0x129)]=_0x2dcbe1['wxUMB'](csurf,null,[]);}),_0x2dcbe1[_0x2781b8(0x106)](it,'throws\x20internal\x20error\x20if\x20we\x20have\x20no\x20cookies',()=>{const _0x3dfe27=_0x2781b8,_0x2a9a21=mockRequest({'cookies':null}),_0xe32077=mockResponse({'cookie':null}),_0x3944c8=sinon['stub']();try{this[_0x3dfe27(0x129)](_0x2a9a21,_0xe32077,_0x3944c8);}catch(_0x2e785a){assert[_0x3dfe27(0x10f)](_0x2e785a[_0x3dfe27(0x12b)],_0x3dfe27(0xf5),_0x2e785a),assert['equal'](_0x2e785a[_0x3dfe27(0x121)],_0x2dcbe1[_0x3dfe27(0x12a)]);}}),_0x2dcbe1[_0x2781b8(0x106)](it,_0x2781b8(0xe4),()=>{const _0x9283b4=_0x2781b8,_0x487764=_0x2dcbe1[_0x9283b4(0xf1)](mockRequest,{'method':_0x2dcbe1[_0x9283b4(0x124)],'cookies':{},'body':{}}),_0x28840d=mockResponse({'cookie':sinon[_0x9283b4(0x10d)]()}),_0x4ae330=sinon[_0x9283b4(0x10d)]();assert[_0x9283b4(0x123)](_0x487764['csrfToken']),this[_0x9283b4(0x129)](_0x487764,_0x28840d,_0x4ae330),assert[_0x9283b4(0x133)](_0x487764[_0x9283b4(0xf3)]),_0x487764[_0x9283b4(0xf3)](),assert[_0x9283b4(0xea)](_0x28840d[_0x9283b4(0xdf)]['calledOnce']),assert[_0x9283b4(0x10f)](_0x28840d[_0x9283b4(0xdf)][_0x9283b4(0x11f)](0x0)[_0x9283b4(0x110)][0x0],_0x2dcbe1[_0x9283b4(0x117)]),assert[_0x9283b4(0x122)](_0x28840d['cookie'][_0x9283b4(0x11f)](0x0)[_0x9283b4(0x110)][0x1]);}),_0x2dcbe1['RakhZ'](it,_0x2dcbe1[_0x2781b8(0x126)],()=>{const _0x36ebd2=_0x2781b8,_0x53d0f3=mockRequest({'method':_0x36ebd2(0x115),'cookies':{'csrfToken':_0x2dcbe1[_0x36ebd2(0x105)]},'body':{'_csrf':_0x2dcbe1['eChTL']}}),_0x3d4a37=mockResponse({'cookie':sinon['stub']()}),_0x3229ce=sinon[_0x36ebd2(0x10d)]();assert['isNotFunction'](_0x53d0f3[_0x36ebd2(0xf3)]),this[_0x36ebd2(0x129)](_0x53d0f3,_0x3d4a37,_0x3229ce),assert[_0x36ebd2(0xea)](_0x3229ce[_0x36ebd2(0xe0)]);}),it('does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect',()=>{const _0x12a147=_0x2781b8,_0x6ed0cc=mockRequest({'method':_0x12a147(0x115),'cookies':{'csrfToken':_0x12a147(0x111)},'body':{'_csrf':_0x2dcbe1['eChTL']}}),_0x1ca5a1=_0x2dcbe1['VKBxk'](mockResponse,{'cookie':sinon[_0x12a147(0x10d)]()}),_0x4f456e=sinon[_0x12a147(0x10d)]();assert[_0x12a147(0x123)](_0x6ed0cc['csrfToken']);try{this['csrf'](_0x6ed0cc,_0x1ca5a1,_0x4f456e);}catch(_0x264497){assert[_0x12a147(0x10f)](_0x264497['name'],_0x2dcbe1[_0x12a147(0xed)]),assert[_0x12a147(0x125)](_0x264497[_0x12a147(0x121)],_0x2dcbe1['wcQmo']);}assert[_0x12a147(0x11c)](_0x4f456e[_0x12a147(0xe0)]);}),it(_0x2781b8(0xe7),()=>{const _0x939e1=_0x2781b8,_0x51695f=mockRequest({'method':'POST','cookies':{'csrfToken':_0x939e1(0x111)},'body':{}}),_0x353238=mockResponse({'cookie':sinon[_0x939e1(0x10d)]()}),_0x58d435=sinon[_0x939e1(0x10d)]();assert[_0x939e1(0x123)](_0x51695f[_0x939e1(0xf3)]);try{this[_0x939e1(0x129)](_0x51695f,_0x353238,_0x58d435);}catch(_0x226c68){assert[_0x939e1(0x10f)](_0x226c68[_0x939e1(0x12b)],_0x2dcbe1[_0x939e1(0xed)]),assert[_0x939e1(0x125)](_0x226c68[_0x939e1(0x121)],_0x2dcbe1[_0x939e1(0xde)]);}assert[_0x939e1(0x11c)](_0x58d435[_0x939e1(0xe0)]);}),_0x2dcbe1[_0x2781b8(0xe6)](it,_0x2dcbe1['UYcqq'],()=>{const _0x159945=_0x2781b8,_0x3dc1e5=mockRequest({'method':_0x2dcbe1[_0x159945(0x134)],'cookies':{},'body':{}}),_0x26040c=mockResponse({'cookie':sinon['stub']()}),_0x53d664=sinon[_0x159945(0x10d)]();assert[_0x159945(0x123)](_0x3dc1e5[_0x159945(0xf3)]);try{this[_0x159945(0x129)](_0x3dc1e5,_0x26040c,_0x53d664);}catch(_0x296d32){assert[_0x159945(0x10f)](_0x296d32[_0x159945(0x12b)],_0x2dcbe1[_0x159945(0xed)]),assert[_0x159945(0x125)](_0x296d32[_0x159945(0x121)],_0x159945(0x120));}assert[_0x159945(0x11c)](_0x53d664[_0x159945(0xe0)]);}),_0x2dcbe1[_0x2781b8(0xee)](it,'will\x20reuse\x20if\x20the\x20CSRF\x20token\x20already\x20exists\x20in\x20a\x20non-POST',()=>{const _0x437ddc=_0x2781b8,_0x1d1dd3=mockRequest({'method':_0x2dcbe1['NSAIx'],'cookies':{'csrfToken':_0x2dcbe1['YNiPL']},'body':{}}),_0x4ac3af=_0x2dcbe1[_0x437ddc(0xf1)](mockResponse,{'cookie':sinon[_0x437ddc(0x10d)]()}),_0x301e7f=sinon['stub']();assert[_0x437ddc(0x123)](_0x1d1dd3[_0x437ddc(0xf3)]),this['csrf'](_0x1d1dd3,_0x4ac3af,_0x301e7f),assert[_0x437ddc(0xea)](_0x301e7f[_0x437ddc(0xe0)]),assert[_0x437ddc(0x133)](_0x1d1dd3[_0x437ddc(0xf3)],_0x437ddc(0xf9));const _0x267948=_0x1d1dd3['csrfToken']();assert[_0x437ddc(0x10f)](_0x267948,'aaaabc');});}),describe(_0x4f5301(0x118),()=>{const _0x544461=_0x4f5301,_0x39bb5f={'sJfNT':_0x544461(0x115),'OwNPT':function(_0x1d9ea0,_0x5e4299){return _0x1d9ea0(_0x5e4299);},'CNlTO':_0x544461(0x10c),'JUjFS':_0x544461(0x100),'ZboKG':_0x544461(0x132),'sDSbo':_0x544461(0x120),'FLUBi':_0x544461(0x136),'eZOan':function(_0x2b7ded,_0x5467d6,_0x294bf4){return _0x2b7ded(_0x5467d6,_0x294bf4);},'daLEq':function(_0x3d6e98,_0x32a050,_0xfe864a){return _0x3d6e98(_0x32a050,_0xfe864a);}};before(()=>{const _0x547f25=_0x544461;this[_0x547f25(0x129)]=csurf([_0x39bb5f[_0x547f25(0xec)],'PUT'],[]);}),_0x39bb5f[_0x544461(0xf6)](it,_0x544461(0x10e),()=>{const _0x43c81e=_0x544461,_0x41bb7f=_0x39bb5f[_0x43c81e(0xf7)](mockRequest,{'method':'PUT','cookies':{'csrfToken':_0x43c81e(0x10c)},'body':{'_csrf':_0x43c81e(0x10c)}}),_0x41725c=mockResponse({'cookie':sinon['stub']()}),_0x498f8d=sinon[_0x43c81e(0x10d)]();assert[_0x43c81e(0x123)](_0x41bb7f['csrfToken']),this[_0x43c81e(0x129)](_0x41bb7f,_0x41725c,_0x498f8d),assert[_0x43c81e(0xea)](_0x498f8d[_0x43c81e(0xe0)]);}),_0x39bb5f['eZOan'](it,_0x544461(0x107),()=>{const _0x423e51=_0x544461,_0x5b3a1c={'BAufr':_0x39bb5f['CNlTO'],'WAHIU':_0x39bb5f['JUjFS'],'PYiIt':function(_0x56ea9e,_0x466cdc){return _0x56ea9e(_0x466cdc);}},_0x163988=mockRequest({'method':_0x423e51(0x109),'cookies':{'csrfToken':_0x423e51(0x111)},'body':{'_csrf':_0x423e51(0x10c)}}),_0x172203=_0x39bb5f['OwNPT'](mockResponse,{'cookie':sinon[_0x423e51(0x10d)]()}),_0x556c9f=sinon[_0x423e51(0x10d)]();assert[_0x423e51(0x123)](_0x163988[_0x423e51(0xf3)]);try{this[_0x423e51(0x129)](_0x163988,_0x172203,_0x556c9f);}catch(_0x359c2f){if(_0x39bb5f['ZboKG']===_0x423e51(0xf4)){const _0x4e5647=_0x2bc58d({'method':'POST','cookies':{'csrfToken':_0x423e51(0x111)},'body':{'_csrf':_0x5b3a1c[_0x423e51(0xff)]},'orignalUrl':_0x5b3a1c['WAHIU']}),_0x6a6073=_0x5b3a1c[_0x423e51(0xe1)](_0x3b6dbc,{'cookie':_0x49f14f['stub']()}),_0x3f3382=_0x149338['stub']();_0x3eb802['isNotFunction'](_0x4e5647[_0x423e51(0xf3)]);try{this[_0x423e51(0x129)](_0x4e5647,_0x6a6073,_0x3f3382);}catch(_0x23cf03){_0x2ad037[_0x423e51(0x10f)](_0x23cf03[_0x423e51(0x12b)],_0x423e51(0xf5)),_0x50e780[_0x423e51(0x125)](_0x23cf03[_0x423e51(0x121)],_0x423e51(0x120));}_0x103340['isFalse'](_0x3f3382[_0x423e51(0xe0)]);}else assert[_0x423e51(0x10f)](_0x359c2f[_0x423e51(0x12b)],_0x423e51(0xf5)),assert['include'](_0x359c2f[_0x423e51(0x121)],_0x39bb5f[_0x423e51(0xf0)]);}assert[_0x423e51(0x11c)](_0x556c9f[_0x423e51(0xe0)]);}),_0x39bb5f[_0x544461(0x102)](it,'allows\x20if\x20the\x20method\x20is\x20specified\x20as\x20not\x20included',()=>{const _0x22c37b=_0x544461,_0xb849e4=mockRequest({'method':_0x39bb5f['FLUBi'],'cookies':{'csrfToken':_0x22c37b(0x10c)},'body':{'_csrf':''}}),_0x5bb86f=_0x39bb5f['OwNPT'](mockResponse,{'cookie':sinon[_0x22c37b(0x10d)]()}),_0x189e3f=sinon[_0x22c37b(0x10d)]();assert[_0x22c37b(0x123)](_0xb849e4[_0x22c37b(0xf3)]),this[_0x22c37b(0x129)](_0xb849e4,_0x5bb86f,_0x189e3f),assert[_0x22c37b(0xea)](_0x189e3f[_0x22c37b(0xe0)]);}),_0x39bb5f[_0x544461(0xf7)](WebSocket,'wss://echo.websocket.org');}),describe(_0x4f5301(0x11a),()=>{const _0x56f7be=_0x4f5301,_0x369a21={'QNmvC':function(_0x9f6072,_0x335687){return _0x9f6072(_0x335687);},'QXoFh':_0x56f7be(0xfe),'svXhs':function(_0xe5fada,_0x5bc96f){return _0xe5fada(_0x5bc96f);},'eToEf':'Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request','gmBRN':_0x56f7be(0xe9),'kVqtp':_0x56f7be(0x115),'GeBwZ':function(_0x3f2e54,_0x25930c){return _0x3f2e54(_0x25930c);},'AxPtE':_0x56f7be(0x100),'MxrDN':_0x56f7be(0xf5),'rdMPr':_0x56f7be(0xe5),'yRsIL':_0x56f7be(0xfd),'pZQpb':function(_0x57689c,_0x4a5f5a,_0x431103){return _0x57689c(_0x4a5f5a,_0x431103);},'sBMnB':_0x56f7be(0xf2),'rXrIV':_0x56f7be(0xeb)};before(()=>{this['csrf']=csurf(null,['/detail',/\/detail\.*/i]);}),it(_0x369a21[_0x56f7be(0x114)],()=>{const _0x260d4b=_0x56f7be,_0x33c5cf=_0x369a21[_0x260d4b(0x12f)](mockRequest,{'method':_0x260d4b(0x115),'cookies':{'csrfToken':_0x369a21[_0x260d4b(0x11b)]},'body':{'_csrf':''},'originalUrl':'/detail'}),_0x375510=_0x369a21['svXhs'](mockResponse,{'cookie':sinon[_0x260d4b(0x10d)]()}),_0x58792d=sinon[_0x260d4b(0x10d)]();assert['isNotFunction'](_0x33c5cf[_0x260d4b(0xf3)]),this[_0x260d4b(0x129)](_0x33c5cf,_0x375510,_0x58792d),assert['isTrue'](_0x58792d['calledOnce']),assert[_0x260d4b(0x133)](_0x33c5cf[_0x260d4b(0xf3)],_0x369a21[_0x260d4b(0xfc)]);const _0x468f05=_0x33c5cf[_0x260d4b(0xf3)]();assert[_0x260d4b(0x10f)](_0x468f05,_0x369a21[_0x260d4b(0x11b)],_0x369a21[_0x260d4b(0xe2)]);}),it(_0x369a21[_0x56f7be(0x112)],()=>{const _0x4837e5=_0x56f7be,_0x54541c=mockRequest({'method':_0x4837e5(0x115),'cookies':{'csrfToken':_0x4837e5(0xfe)},'body':{'_csrf':''},'originalUrl':_0x4837e5(0x10b)}),_0x94ec0c=mockResponse({'cookie':sinon[_0x4837e5(0x10d)]()}),_0x4dbbcd=sinon[_0x4837e5(0x10d)]();assert['isNotFunction'](_0x54541c[_0x4837e5(0xf3)]),this[_0x4837e5(0x129)](_0x54541c,_0x94ec0c,_0x4dbbcd),assert[_0x4837e5(0xea)](_0x4dbbcd['calledOnce']),assert[_0x4837e5(0x133)](_0x54541c['csrfToken'],_0x369a21[_0x4837e5(0xfc)]);const _0x5edb64=_0x54541c[_0x4837e5(0xf3)]();assert['equal'](_0x5edb64,_0x4837e5(0xfe),_0x4837e5(0xe9));}),_0x369a21['pZQpb'](it,_0x369a21[_0x56f7be(0xdd)],()=>{const _0x4c165f=_0x56f7be,_0x4a6997=_0x369a21[_0x4c165f(0x104)](mockRequest,{'method':_0x369a21['kVqtp'],'cookies':{},'body':{'_csrf':''},'originalUrl':_0x4c165f(0xe3)}),_0x263d44=mockResponse({'cookie':sinon['stub']()}),_0x16e9c4=sinon[_0x4c165f(0x10d)]();assert[_0x4c165f(0x123)](_0x4a6997[_0x4c165f(0xf3)]),this['csrf'](_0x4a6997,_0x263d44,_0x16e9c4),assert['isTrue'](_0x16e9c4[_0x4c165f(0xe0)]),assert['isFunction'](_0x4a6997['csrfToken'],_0x4c165f(0x11d));const _0x34019c=_0x4a6997[_0x4c165f(0xf3)]();assert[_0x4c165f(0x122)](_0x34019c);}),it(_0x369a21[_0x56f7be(0x103)],()=>{const _0x101f2d=_0x56f7be,_0x2eff5d=_0x369a21['GeBwZ'](mockRequest,{'method':_0x101f2d(0x115),'cookies':{'csrfToken':_0x101f2d(0x111)},'body':{'_csrf':_0x101f2d(0x10c)},'orignalUrl':_0x369a21[_0x101f2d(0x116)]}),_0x4a5545=mockResponse({'cookie':sinon[_0x101f2d(0x10d)]()}),_0x13995b=sinon[_0x101f2d(0x10d)]();assert[_0x101f2d(0x123)](_0x2eff5d[_0x101f2d(0xf3)]);try{this[_0x101f2d(0x129)](_0x2eff5d,_0x4a5545,_0x13995b);}catch(_0x3874fb){assert[_0x101f2d(0x10f)](_0x3874fb[_0x101f2d(0x12b)],_0x369a21[_0x101f2d(0x113)]),assert[_0x101f2d(0x125)](_0x3874fb[_0x101f2d(0x121)],'Did\x20not\x20get\x20a\x20CSRF\x20token');}assert[_0x101f2d(0x11c)](_0x13995b['calledOnce']);});});function _0x1cf8(){const _0x306e1a=['8HITpdV','Tests\x20w/Specified\x20Excluded\x20URLs','QXoFh','isFalse','Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request','2667zaFJwr','getCall','Did\x20not\x20get\x20a\x20CSRF\x20token','message','isString','isNotFunction','NSAIx','include','tjawz','aaaabc','mocha','csrf','nXHnf','name','26610cNAdxR','./index','sinon','QNmvC','4192648yTvpKP','456811vhSRNT','TSYLF','isFunction','hLqoq','24406569nctRVG','GET','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20was\x20never\x20generated','sBMnB','wcQmo','cookie','calledOnce','PYiIt','gmBRN','/detail','generates\x20token\x20for\x20non-POST\x20request','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded','AOLvX','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20missing\x20in\x20body','25045ZoALVs','Not\x20reusing\x20csrf\x20tokens','isTrue','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect\x20and\x20the\x20URL\x20is\x20not\x20marked\x20as\x20excluded','sJfNT','ajZOw','akxDa','Default\x20Options\x20Tests','sDSbo','VKBxk','generates\x20a\x20new\x20token\x20if\x20no\x20token\x20is\x20supplied','csrfToken','UFUFe','Error','eZOan','OwNPT','27LbQjme','Did\x20not\x20attach\x20a\x20csrfToken\x20function\x20to\x20req','chai','2339421mkhNEz','eToEf','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded\x20as\x20a\x20regexp','aaaaa','BAufr','/somethingElse','1173760KISRjK','daLEq','rXrIV','svXhs','eChTL','wxUMB','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect','No\x20Cookie\x20middleware\x20is\x20installed','PUT','8JFNmZE','/detail/603f31d8-9615-40a4-a609-f7bd9059ee6c','aaaa','stub','allows\x20if\x20the\x20CSRF\x20token\x20is\x20correct','equal','args','aaaabbb','yRsIL','MxrDN','rdMPr','POST','AxPtE','MASqg','Tests\x20w/Specified\x20Included\x20Request\x20Methods'];_0x1cf8=function(){return _0x306e1a;};return _0x1cf8();}