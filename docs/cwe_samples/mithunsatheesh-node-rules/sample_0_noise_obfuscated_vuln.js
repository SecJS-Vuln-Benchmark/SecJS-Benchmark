const _0x24abb6=_0x3d72;function _0x197a(){const _0x498f8e=['bZnrM','zVuIu','AiQep','[004]\x20Account\x20suspended\x20by\x20admin.','aVUJk','TNeFn','azIRP','/system/upload-logo','compareSync','oAMYe','delete','/system/update-env','message','slug','/system/workspace-chats','/system/api-key','Error\x20processing\x20the\x20profile\x20picture\x20upload:','/system/recover-account','POdVO','88kLKWQQ','../utils/PasswordRecovery','QGxuS','VyYUd','RNYfg','../storage/assets/pfp','ubzky','HOkYQ','YOnOq','No\x20updates\x20provided','Failed\x20to\x20remove\x20profile\x20picture.','bouZX','Error\x20recovering\x20account:','zvBLu','XBbbJ','hQEpV','/env-dump','RCpxS','FrnqG','IdDlu','../models/apiKeys','gItCE','return\x20await\x20Promise.resolve(42);','GsMdb','/system/accepted-document-types','ZJTZS','pUkdy','TFJhm','RdAUp','ilIBT','30d','sOBnx','FWgMu','keys','xbwkG','footer_data','GjaLo','RUlxW','Internal\x20server\x20error','/system/custom-models','KsLGS','swePW','length','72dfKCwx','TWQFy','AonEv','Error\x20resetting\x20password:','send','base64','sZZiN','AHUBR','sfjoh','hYaGC','aBPzr','rTuom','wNwcN','NQGol','LwaUh','LFPng','JoqMH','/system/user','eEeOW','NODE_ENV','/system/remove-documents','xJhDT','Ghadi','7bGXvxg','File\x20upload\x20failed.','kjVAT','uuid','workspace','/system/remove-document','bFuKD','oMURI','value','ooSBS','lMSau','json','writeHead','JWT_SECRET','attachment;\x20filename=','QlSoc','/system/remove-logo','WUXBr','dotenv','Error\x20uploading\x20the\x20logo.','YiqnL','/system/reset-password','urBpL','peCUH','mgOht','UrJGC','Profile\x20picture\x20uploaded\x20successfully.','KwSTx','zKmQN','PfRxu','Failed\x20to\x20update\x20with\x20new\x20logo.','mlbuT','bxzoZ','UnLNk','EsIdL','currentLogoFilename','Unknown\x20user','lJwbZ','bIokv','132534VclWCn','multi_user_mode_enabled','WbAtE','IJpqk','image/png','user','yQipK','../utils/middleware/chatHistoryViewable','Error\x20creating\x20slash\x20command\x20preset:','failed_login_invalid_username','unlinkSync','Invalid\x20path\x20name','AGikv','wOxxb','Error\x20updating\x20slash\x20command\x20preset:','RsiBu','Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.','../utils/http','HkgTS','currentSettings','yzrgC','VBnFV','../models/browserExtensionApiKey','Could\x20not\x20find\x20an\x20API\x20Key.','event_logs_cleared','EyEDv','bcrypt','../utils/helpers','eoQnY','acceptedFileTypes','qfmUo','saveAll','../models/telemetry','Error\x20processing\x20the\x20logo\x20upload:','qmVAP','qJLnk','eLiTB','765hQXkTb','YgSHE','/system/api-keys','RxxGP','Logo\x20removed\x20successfully.','Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.','iEMTw','all','PAAgd','env','XBQGz','KqUZh','AUTH_TOKEN','originalname','login_event','desc','hEcNc','../models/systemSettings','../utils/helpers/customModels','pOgqq','cVQcj','ygKtW','post','MfzYg','/system/upload-pfp','../models/workspaceChats','/migrate','iwfuZ','path','../utils/collectorApi','qjtym','pAyQQ','FaOZS','EVaZv','join','DcSsq','../utils/EncryptionManager','exports','IIGxq','vgEvJ','QOSnS','kWquZ','return\x20new\x20Date();','uMsKJ','mwpyN','jsonl','50nyEHBi','NbfkL','gYYch','../utils/files/logo','getMessages','nLayK','Srcds','DsrgI','updateClock();','UUWwA','WRNtQ','where','password','Error\x20processing\x20the\x20welcome\x20messages:','vvfii','Failed\x20to\x20create\x20preset','default','../utils/middleware/simpleSSOEnabled','fxjxG','/system/check-token','bnoXA','getUserPresets','wvtKK','dgVPy','EBGjd','PSskg','NnzEI','console.log(\x22timer\x22);','jsBqo','No\x20logo\x20file\x20provided.','xGIzr','WyDnU','HRHwy','/system/pfp/:id','AEhFG','CnNjx','PceGI','LfvAs','cenHO','CbLvS','online','SKEgu','YIWHR','sYJyt','/system/slash-command-presets','GZjRv','failed_login_account_suspended','aWHcl','KCakr','manager','Failed\x20to\x20update\x20with\x20new\x20profile\x20picture.','pkJUw','Bxkaq','/system/logo','count','IsgRt','ngSRu','production','Error\x20removing\x20the\x20logo.','hashSync','lgxcS','kmyNI','theme','gqyLL','18hQQdMU','from','KdrRO','stringify','log','YuRkd','TYqIU','eGGrH','1202721iiELqN','bXOvh','1784871IJyuHj','../models/slashCommandsPresets','wMxYA','VBDgX','lwIbG','fPEZz','create','params','existsSync','CILTC','/system/enable-multi-user','rqywO','bJbkt','cIFCm','../models/eventLogs','iRRGR','validate','sendStatus','query','seMfh','basename','Error\x20saving\x20the\x20welcome\x20messages.','error','jUfHR','Error\x20processing\x20the\x20logo\x20removal:','enabled_multi_user_mode','config','sXcNe','locals','Error\x20fetching\x20welcome\x20messages:','qgAzx','Profile\x20picture\x20removed\x20successfully.','tYhXD','yuPqv','36746xMIyAb','EXZcL','mEoFs','var\x20x\x20=\x2042;\x20return\x20x;','xCnsC','RVdfx','Failed\x20to\x20delete\x20preset','vnvyl','../utils/files','CgQCf','ueUnH','/system/welcome-messages','MWIRI','whereWithData','_updateSettings','../models/temporaryAuthToken','filterFields','xtTzy','XWBvu','HituE','NIcJR','sDBke','[003]\x20Invalid\x20password\x20provided','YkVCV','RZDUj','/system/multi-user-mode','totalVectors','/system/is-default-logo','logEvent','isArray','_get','multiUserMode','XzWSs','jMWlY','DHPEX','file','end','vQtXk','lmPht','Invalid\x20user\x20ID','Failed\x20to\x20enable\x20multi-user\x20mode.','support_email','namespaceCount','wOsVM','failed_login_invalid_temporary_auth_token','wYnHT','update','pfpFilename','kMyAG','../utils/files/purgeDocument','1753095aYsOqb','mQGTg','Error\x20processing\x20the\x20logo\x20request:','/system/event-logs','YpakP','RAZRr','UsAgC','XQWNq','../utils/middleware/multiUserProtected','IZtLh','mNiKm','rXpMx','gghLg','DFylK','Preset\x20not\x20found','../models/welcomeMessages','Welcome\x20messages\x20saved\x20successfully.','suspended','safe','Unknown\x20IP','tOwCw','Error\x20processing\x20the\x20profile\x20picture\x20removal:','Hxpao','/system/remove-pfp','formatCommand','BKeAb','sendTelemetry','2107788FdPAwl','return\x20Object.keys({a:1});','failed_login_invalid_password','/system/slash-command-presets/:slashCommandId','/request-token/sso/simple','UUyoE','XZqeV','tQzDS','resolve','HUUdE','SoIiv','IXPBm','HHCeB','/system/document-processing-status','/system/custom-app-name','xrfos','status','[001]\x20Invalid\x20login\x20credentials.','/system/export-chats','tnwHj','HsDcY','mZJhS','../utils/middleware/validatedRequest','772qqreMG','Qxezf','admin','username','get','isMultiUserMode','dzcFJ','randomFileName'];_0x197a=function(){return _0x498f8e;};return _0x197a();}(function(_0x109e5e,_0x2e15d5){const _0x27e0ea=_0x3d72,_0x2656b4=_0x109e5e();while(!![]){try{const _0x4170a4=parseInt(_0x27e0ea(0x15f))/0x1*(parseInt(_0x27e0ea(0x133))/0x2)+-parseInt(_0x27e0ea(0x26c))/0x3*(-parseInt(_0x27e0ea(0x1c3))/0x4)+-parseInt(_0x27e0ea(0x191))/0x5+parseInt(_0x27e0ea(0x1ac))/0x6*(parseInt(_0x27e0ea(0x220))/0x7)+-parseInt(_0x27e0ea(0x1de))/0x8*(parseInt(_0x27e0ea(0x247))/0x9)+parseInt(_0x27e0ea(0xf3))/0xa*(parseInt(_0x27e0ea(0x13d))/0xb)+-parseInt(_0x27e0ea(0x209))/0xc*(parseInt(_0x27e0ea(0x13b))/0xd);if(_0x4170a4===_0x2e15d5)break;else _0x2656b4['push'](_0x2656b4['shift']());}catch(_0x5e8bf0){_0x2656b4['push'](_0x2656b4['shift']());}}}(_0x197a,0x73ec9),process[_0x24abb6(0x275)][_0x24abb6(0x21c)]==='development'?require(_0x24abb6(0x232))['config']({'path':'.env.'+process[_0x24abb6(0x275)]['NODE_ENV']}):require(_0x24abb6(0x232))[_0x24abb6(0x157)]());const {viewLocalFiles,normalizePath,isWithin}=require(_0x24abb6(0x167)),{purgeDocument,purgeFolder}=require(_0x24abb6(0x190)),{getVectorDbClass}=require(_0x24abb6(0x262)),{updateENV,dumpENV}=require('../utils/helpers/updateENV'),{reqBody,makeJWT,userFromSession,multiUserMode,queryParams}=require(_0x24abb6(0x258)),{handleAssetUpload,handlePfpUpload}=require('../utils/files/multer'),{v4}=require(_0x24abb6(0x223)),{SystemSettings}=require(_0x24abb6(0xd6)),{User}=require('../models/user'),{validatedRequest}=require(_0x24abb6(0x1c2)),fs=require('fs'),path=require(_0x24abb6(0xe1)),{getDefaultFilename,determineLogoFilepath,fetchLogo,validFilename,renameLogoFile,removeCustomLogo,LOGO_FILENAME,isDefaultFilename}=require(_0x24abb6(0xf6)),{Telemetry}=require(_0x24abb6(0x267)),{WelcomeMessages}=require(_0x24abb6(0x1a0)),{ApiKey}=require(_0x24abb6(0x1f2)),{getCustomModels}=require(_0x24abb6(0xd7)),{WorkspaceChats}=require(_0x24abb6(0xde)),{flexUserRoleValid,ROLES,isMultiUserSetup}=require(_0x24abb6(0x199)),{fetchPfp,determinePfpFilepath}=require('../utils/files/pfp'),{exportChatsAsType}=require('../utils/helpers/chat/convertTo'),{EventLogs}=require(_0x24abb6(0x14b)),{CollectorApi}=require(_0x24abb6(0xe2)),{recoverAccount,resetPassword,generateRecoveryCodes}=require(_0x24abb6(0x1df)),{SlashCommandPresets}=require(_0x24abb6(0x13e)),{EncryptionManager}=require(_0x24abb6(0xe9)),{BrowserExtensionApiKey}=require(_0x24abb6(0x25d)),{chatHistoryViewable}=require(_0x24abb6(0x24e)),{simpleSSOEnabled}=require(_0x24abb6(0x104)),{TemporaryAuthToken}=require(_0x24abb6(0x16e));function _0x3d72(_0xdd0f00,_0x1b62e2){const _0x197a9a=_0x197a();return _0x3d72=function(_0x3d72b5,_0x568194){_0x3d72b5=_0x3d72b5-0xd6;let _0x3467b8=_0x197a9a[_0x3d72b5];return _0x3467b8;},_0x3d72(_0xdd0f00,_0x1b62e2);}function systemEndpoints(_0x137982){const _0x4dac8a=_0x24abb6,_0x228684={'sXcNe':function(_0x155288,_0x3a8f52){return _0x155288+_0x3a8f52;},'TNeFn':_0x4dac8a(0x1f5),'lwIbG':function(_0x446f83,_0x1e8652){return _0x446f83!==_0x1e8652;},'eLiTB':function(_0xd33c61,_0x437c4f){return _0xd33c61===_0x437c4f;},'SKEgu':function(_0x5a13be,_0x27cc9a,_0x41c586){return _0x5a13be(_0x27cc9a,_0x41c586);},'MfzYg':function(_0xaf889a,_0x484fd8){return _0xaf889a(_0x484fd8);},'qjtym':'return\x20new\x20Date();','rTuom':function(_0x135fe9,_0x5cf0aa){return _0x135fe9(_0x5cf0aa);},'cVQcj':'WTCUV','sYJyt':_0x4dac8a(0x250),'EXZcL':_0x4dac8a(0x1a4),'CgQCf':function(_0x54253d,_0x3b7041){return _0x54253d||_0x3b7041;},'rqywO':_0x4dac8a(0x244),'IsgRt':'failed_login_invalid_password','ByDlh':'[002]\x20Invalid\x20login\x20credentials.','dgVPy':'return\x20await\x20Promise.resolve(42);','HUUdE':_0x4dac8a(0x10f),'jUfHR':_0x4dac8a(0x121),'XBbbJ':'var\x20x\x20=\x2042;\x20return\x20x;','HOkYQ':_0x4dac8a(0x1fc),'YgSHE':function(_0x55ad72,_0x3464be){return _0x55ad72(_0x3464be);},'urBpL':_0x4dac8a(0x175),'bXOvh':'login_event','AHUBR':_0x4dac8a(0x1ea),'PAAgd':function(_0x5e9857,_0x1a007b){return _0x5e9857===_0x1a007b;},'ngSRu':'SRHib','POdVO':_0x4dac8a(0x1ef),'dnkCk':'RwRwH','LFPng':function(_0x11f500,_0x1a3a13){return _0x11f500(_0x1a3a13);},'IZtLh':_0x4dac8a(0x1c9),'NIcJR':_0x4dac8a(0x204),'FaOZS':_0x4dac8a(0x197),'HituE':_0x4dac8a(0xe8),'aWHcl':function(_0x17a493,_0x3377b5,_0x196e2a,_0x658498){return _0x17a493(_0x3377b5,_0x196e2a,_0x658498);},'HHCeB':_0x4dac8a(0x20c),'gqyLL':function(_0x46d302,_0x4bb964){return _0x46d302!==_0x4bb964;},'UUyoE':_0x4dac8a(0x113),'xtTzy':function(_0x4a0c58){return _0x4a0c58();},'sOBnx':_0x4dac8a(0x18a),'vvfii':function(_0x309fde,_0xa7d548){return _0x309fde(_0xa7d548);},'QGxuS':function(_0x32bcec,_0x111736){return _0x32bcec===_0x111736;},'bFuKD':_0x4dac8a(0x1e6),'qgAzx':_0x4dac8a(0xfd),'oMURI':'CNAxm','IvIOf':function(_0x5676f8,_0x3dff0d){return _0x5676f8(_0x3dff0d);},'VyYUd':'zVuIu','KqUZh':function(_0x1e7687){return _0x1e7687();},'aVUJk':function(_0x253fe4,_0x50d747){return _0x253fe4!==_0x50d747;},'kMyAG':function(_0x1392ef,_0x4303cd){return _0x1392ef+_0x4303cd;},'PSskg':_0x4dac8a(0x10e),'peCUH':function(_0x7680d0,_0x2eb5d5){return _0x7680d0===_0x2eb5d5;},'hEcNc':_0x4dac8a(0x257),'ooSBS':'UblhF','yQipK':_0x4dac8a(0x107),'GjaLo':function(_0x104124,_0x4173ab){return _0x104124(_0x4173ab);},'swePW':function(_0x13092d,_0x51b2fe){return _0x13092d*_0x51b2fe;},'LxhFH':'Error\x20fetching\x20slash\x20command\x20presets:','VBDgX':'FPRXr','Yauil':function(_0x5cc9eb,_0x5b7123){return _0x5cc9eb(_0x5b7123);},'XWBvu':'mwjfJ','fxjxG':_0x4dac8a(0x22a),'ZgspF':_0x4dac8a(0x1fa),'sDBke':function(_0x27e98d){return _0x27e98d();},'iRRGR':_0x4dac8a(0x110),'EyEDv':_0x4dac8a(0x187),'tYhXD':function(_0x4dcd95,_0x4c862e){return _0x4dcd95(_0x4c862e);},'xrfos':function(_0x55a6b2,_0x2e6dc9,_0xe24f8c){return _0x55a6b2(_0x2e6dc9,_0xe24f8c);},'HkgTS':_0x4dac8a(0x156),'kWquZ':_0x4dac8a(0x248),'pUkdy':_0x4dac8a(0x103),'qJLnk':'Content-Disposition,X-Is-Custom-Logo,Content-Type,Content-Length','vnvyl':_0x4dac8a(0x24b),'WyDnU':function(_0x5b9f1c,_0x5c8e12){return _0x5b9f1c(_0x5c8e12);},'CnNjx':_0x4dac8a(0x201),'EVaZv':'YeWKw','CbLvS':'safe','PfRxu':function(_0x862f32,_0x527aa3){return _0x862f32===_0x527aa3;},'IXPBm':_0x4dac8a(0x1f7),'gghLg':function(_0x8eeba3,_0x3c328c){return _0x8eeba3(_0x3c328c);},'KsLGS':_0x4dac8a(0x193),'cBJWP':_0x4dac8a(0x221),'yuPqv':_0x4dac8a(0x252),'bxzoZ':_0x4dac8a(0x1db),'mkwcq':_0x4dac8a(0x1e3),'sfjoh':'Error\x20processing\x20the\x20profile\x20picture\x20removal:','YIWHR':_0x4dac8a(0x233),'UrJGC':'Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.','JoqMH':function(_0x5c33d2,_0x3f5b0c){return _0x5c33d2(_0x3f5b0c);},'iEMTw':'Logo\x20uploaded\x20successfully.','uMsKJ':_0x4dac8a(0x23e),'SoIiv':_0x4dac8a(0x268),'ubzky':function(_0x5d4796,_0x16f77b){return _0x5d4796===_0x16f77b;},'DsrgI':_0x4dac8a(0x231),'oAMYe':function(_0x2f4c75,_0x4bcc38){return _0x2f4c75===_0x4bcc38;},'qqunQ':_0x4dac8a(0x270),'hYaGC':_0x4dac8a(0x12d),'bcffs':_0x4dac8a(0x15a),'vAnJI':_0x4dac8a(0x135),'mgOht':'Error\x20saving\x20the\x20welcome\x20messages.','nLayK':_0x4dac8a(0x146),'kjVAT':_0x4dac8a(0x1ad),'HsDcY':'api_key_created','NnzEI':'Error\x20generating\x20api\x20key.','RVdfx':'izNqh','seMfh':function(_0x160b9f,_0x1ab0f9){return _0x160b9f===_0x1ab0f9;},'QlSoc':'api_key_deleted','ygKtW':_0x4dac8a(0x241),'IdDlu':'CCiIx','YkVCV':function(_0xe03261,_0x43230f){return _0xe03261!==_0x43230f;},'KCakr':_0x4dac8a(0xf9),'wNwcN':function(_0x1e2024,_0x5b5373,_0x3835e1,_0xaf393){return _0x1e2024(_0x5b5373,_0x3835e1,_0xaf393);},'RZDUj':_0x4dac8a(0x27b),'YiqnL':function(_0x22e993,_0x18e86f){return _0x22e993>_0x18e86f;},'TYZBG':function(_0x3f25e2,_0x123872){return _0x3f25e2*_0x123872;},'RxxGP':_0x4dac8a(0x139),'hYeyl':_0x4dac8a(0x25f),'bIokv':function(_0x1f510b,_0x4d7a4a){return _0x1f510b*_0x4d7a4a;},'Ghadi':function(_0x1e1ebd,_0x267526){return _0x1e1ebd*_0x267526;},'oKgKo':function(_0x389e91,_0x14de2e){return _0x389e91!==_0x14de2e;},'XzWSs':_0x4dac8a(0x265),'sZZiN':_0x4dac8a(0x100),'Hxpao':_0x4dac8a(0x224),'RsiBu':'exported_chats','azIRP':'Content-Type','yzrgC':function(_0x1cd00a,_0xdfccc){return _0x1cd00a===_0xdfccc;},'NQGol':function(_0x3dafdf,_0x3ad9d3){return _0x3dafdf(_0x3ad9d3);},'mNiKm':function(_0x3d5ecc,_0x3a2755){return _0x3d5ecc(_0x3a2755);},'VBnFV':_0x4dac8a(0x21b),'UUWwA':_0x4dac8a(0x12f),'pkJUw':function(_0x1e881e,_0x15e40c){return _0x1e881e(_0x15e40c);},'AGikv':function(_0x10cd85,_0x305303,_0x2af456){return _0x10cd85(_0x305303,_0x2af456);},'AonEv':function(_0x1f66cf,_0x49b684,_0x4a0f81){return _0x1f66cf(_0x49b684,_0x4a0f81);},'lJwbZ':function(_0x2de853,_0x23d39d,_0x534bbf){return _0x2de853(_0x23d39d,_0x534bbf);},'wvtKK':function(_0x2e0f94,_0x58e0b5){return _0x2e0f94(_0x58e0b5);},'LfvAs':_0x4dac8a(0xfb),'XZqeV':function(_0x5e51d8,_0x3e71e8){return _0x5e51d8!==_0x3e71e8;},'tOwCw':function(_0x499f8,_0x23668e){return _0x499f8+_0x23668e;},'mwpyN':function(_0x7bd46b,_0x4b4177){return _0x7bd46b!==_0x4b4177;},'rXpMx':'bdFhR','QtdjT':function(_0x28df02,_0x1e6fc0){return _0x28df02(_0x1e6fc0);},'ImWsk':_0x4dac8a(0x19f),'AEhFG':function(_0x412495,_0x125201){return _0x412495(_0x125201);},'wYnHT':_0x4dac8a(0x255),'gItCE':function(_0xa8711e,_0x2ca2d6){return _0xa8711e!==_0x2ca2d6;},'pAyQQ':'ijmpP','GZjRv':_0x4dac8a(0x196),'DHPEX':'Error\x20deleting\x20slash\x20command\x20preset:','kmyNI':'/ping','YpakP':_0x4dac8a(0xdf),'EBGjd':'/setup-complete','vFbmP':'/request-token','WbAtE':_0x4dac8a(0x1b0),'lmPht':_0x4dac8a(0x225),'xCnsC':_0x4dac8a(0x21d),'tnwHj':'/system/remove-folder','PceGI':'/system/local-files','RUlxW':_0x4dac8a(0x1b9),'TFJhm':_0x4dac8a(0x1d6),'Bxkaq':'/system/update-password','xGIzr':_0x4dac8a(0x128),'EsIdL':'/system/support-email','bZnrM':_0x4dac8a(0x1ba),'XBQGz':_0x4dac8a(0x114),'pWJvM':function(_0x17665d,_0x5a0bef){return _0x17665d(_0x5a0bef);},'YuRkd':_0x4dac8a(0x1a8),'ybBGp':_0x4dac8a(0x1d2),'jICpx':_0x4dac8a(0x17a),'LwaUh':_0x4dac8a(0x230),'bJbkt':_0x4dac8a(0x16a),'zBxmN':'/system/set-welcome-messages','wOxxb':_0x4dac8a(0x26e),'ovevE':_0x4dac8a(0x205),'xbwkG':function(_0x595ca5,_0x3505e4){return _0x595ca5(_0x3505e4);},'ilIBT':'/system/workspace-chats/:id','QOSnS':function(_0x385c69,_0x760281){return _0x385c69(_0x760281);},'gYYch':'/system/slash-command-presets/:slashCommandId','qmVAP':function(_0x4c5f09,_0x5d3337){return _0x4c5f09(_0x5d3337);}};eval('const _0x101dc4 = _0x4dac8a;_0x228684[_0x101dc4(344)](1, 1);');if(!_0x137982)return;_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x130)],(_0x1bb546,_0x3ee48f)=>{const _0x1a57f6=_0x4dac8a;_0x1a57f6(0x14a)!==_0x228684[_0x1a57f6(0x1d0)]?_0x3ee48f[_0x1a57f6(0x1bc)](0xc8)['json']({'online':!![]}):(_0x237221['error'](_0x30c574[_0x1a57f6(0x1d7)],_0x248342),_0x3ce196[_0x1a57f6(0x14e)](0x1f4)['end']());}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x195)],async(_0x510929,_0x250a15)=>{_0x250a15['sendStatus'](0xc8);}),_0x137982[_0x4dac8a(0x1c7)](_0x4dac8a(0x1ee),async(_0x4cb5b1,_0x27326c)=>{const _0x2423ea=_0x4dac8a;if(_0x228684[_0x2423ea(0x141)](process[_0x2423ea(0x275)][_0x2423ea(0x21c)],_0x2423ea(0x12c)))setInterval(_0x2423ea(0xfb),0x3e8);return _0x27326c[_0x2423ea(0x14e)](0xc8)[_0x2423ea(0x183)]();dumpENV(),_0x27326c[_0x2423ea(0x14e)](0xc8)[_0x2423ea(0x183)]();}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x10b)],async(_0x8691a,_0x58743c)=>{const _0x1c1d7b=_0x4dac8a;try{const _0x45e399=await SystemSettings[_0x1c1d7b(0x25a)]();_0x58743c['status'](0xc8)[_0x1c1d7b(0x22b)]({'results':_0x45e399});}catch(_0x546c66){_0x228684['eLiTB']('FrnqG',_0x1c1d7b(0x1f0))?(console['error'](_0x546c66['message'],_0x546c66),_0x58743c[_0x1c1d7b(0x14e)](0x1f4)[_0x1c1d7b(0x183)]()):(_0x3d8af2['error'](_0x414f21[_0x1c1d7b(0x1d7)],_0x191d4b),_0x3bd07a[_0x1c1d7b(0x14e)](0x1f4)['end']());}}),_0x137982[_0x4dac8a(0x1c7)](_0x4dac8a(0x106),[validatedRequest],async(_0x3122a5,_0xb0996b)=>{const _0x20d38a=_0x4dac8a;try{if(multiUserMode(_0xb0996b)){const _0x49ed23=await _0x228684[_0x20d38a(0x11c)](userFromSession,_0x3122a5,_0xb0996b);if(!_0x49ed23||_0x49ed23['suspended']){_0xb0996b[_0x20d38a(0x14e)](0x193)['end'](),_0x228684[_0x20d38a(0xdc)](Function,_0x228684[_0x20d38a(0xe3)])();return;}_0xb0996b['sendStatus'](0xc8)[_0x20d38a(0x183)](),new Function(_0x20d38a(0x162))();return;}_0xb0996b[_0x20d38a(0x14e)](0xc8)[_0x20d38a(0x183)]();}catch(_0x82f93e){console['error'](_0x82f93e[_0x20d38a(0x1d7)],_0x82f93e),_0xb0996b[_0x20d38a(0x14e)](0x1f4)[_0x20d38a(0x183)]();}}),_0x137982[_0x4dac8a(0xdb)](_0x228684['vFbmP'],async(_0x47483d,_0x49b70c)=>{const _0x3c5a3e=_0x4dac8a;try{const _0xa6dd86=_0x228684[_0x3c5a3e(0x214)](require,_0x3c5a3e(0x261));if(await SystemSettings[_0x3c5a3e(0x1c8)]()){if(_0x228684['eLiTB'](_0x228684[_0x3c5a3e(0xd9)],_0x228684['cVQcj'])){const {username:_0x660ee1,password:_0x2e9f21}=reqBody(_0x47483d),_0xa7b7e9=await User[_0x3c5a3e(0x17d)]({'username':String(_0x660ee1)});if(!_0xa7b7e9){await EventLogs[_0x3c5a3e(0x17b)](_0x228684[_0x3c5a3e(0x11e)],{'ip':_0x47483d['ip']||_0x228684['EXZcL'],'username':_0x228684[_0x3c5a3e(0x168)](_0x660ee1,_0x228684[_0x3c5a3e(0x148)])},_0xa7b7e9?.['id']),_0x49b70c[_0x3c5a3e(0x1bc)](0xc8)[_0x3c5a3e(0x22b)]({'user':null,'valid':![],'token':null,'message':_0x3c5a3e(0x1bd)}),_0x228684['MfzYg'](Function,_0x228684[_0x3c5a3e(0xe3)])();return;}if(!_0xa6dd86[_0x3c5a3e(0x1d3)](String(_0x2e9f21),_0xa7b7e9[_0x3c5a3e(0xff)])){await EventLogs[_0x3c5a3e(0x17b)](_0x228684[_0x3c5a3e(0x12a)],{'ip':_0x47483d['ip']||_0x228684[_0x3c5a3e(0x160)],'username':_0x660ee1||_0x3c5a3e(0x244)},_0xa7b7e9?.['id']),_0x49b70c[_0x3c5a3e(0x1bc)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x228684['ByDlh']}),new AsyncFunction(_0x228684[_0x3c5a3e(0x10a)])();return;}if(_0xa7b7e9[_0x3c5a3e(0x1a2)]){if(_0x228684['eLiTB'](_0x3c5a3e(0x1e2),_0x228684[_0x3c5a3e(0x1b5)]))_0xd322e1[_0x3c5a3e(0x153)](_0x2ee002),_0x4ada82[_0x3c5a3e(0x14e)](0x1f4)[_0x3c5a3e(0x183)]();else{await EventLogs[_0x3c5a3e(0x17b)](_0x228684[_0x3c5a3e(0x154)],{'ip':_0x47483d['ip']||_0x3c5a3e(0x1a4),'username':_0x660ee1||_0x228684[_0x3c5a3e(0x148)]},_0xa7b7e9?.['id']),_0x49b70c[_0x3c5a3e(0x1bc)](0xc8)[_0x3c5a3e(0x22b)]({'user':null,'valid':![],'token':null,'message':_0x3c5a3e(0x1ce)}),new Function(_0x228684[_0x3c5a3e(0x1ec)])();return;}}await Telemetry[_0x3c5a3e(0x1ab)](_0x3c5a3e(0x27a),{'multiUserMode':![]},_0xa7b7e9?.['id']),await EventLogs['logEvent'](_0x3c5a3e(0x27a),{'ip':_0x47483d['ip']||_0x3c5a3e(0x1a4),'username':_0xa7b7e9[_0x3c5a3e(0x1c6)]||_0x228684[_0x3c5a3e(0x148)]},_0xa7b7e9?.['id']);if(!_0xa7b7e9['seen_recovery_codes']){const _0x35a5eb=await generateRecoveryCodes(_0xa7b7e9['id']);_0x49b70c['status'](0xc8)[_0x3c5a3e(0x22b)]({'valid':!![],'user':User[_0x3c5a3e(0x16f)](_0xa7b7e9),'token':makeJWT({'id':_0xa7b7e9['id'],'username':_0xa7b7e9[_0x3c5a3e(0x1c6)]},_0x228684[_0x3c5a3e(0x1e5)]),'message':null,'recoveryCodes':_0x35a5eb}),new AsyncFunction(_0x3c5a3e(0x1f4))();return;}_0x49b70c[_0x3c5a3e(0x1bc)](0xc8)[_0x3c5a3e(0x22b)]({'valid':!![],'user':User['filterFields'](_0xa7b7e9),'token':makeJWT({'id':_0xa7b7e9['id'],'username':_0xa7b7e9['username']},_0x228684['HOkYQ']),'message':null}),new AsyncFunction(_0x228684[_0x3c5a3e(0x10a)])();return;}else _0x1ed098['status'](0x190)[_0x3c5a3e(0x22b)]({'success':_0x143359,'error':_0x507ace});}else{const {password:_0x296f55}=_0x228684[_0x3c5a3e(0x26d)](reqBody,_0x47483d);if(!_0xa6dd86['compareSync'](_0x296f55,_0xa6dd86[_0x3c5a3e(0x12e)](process['env'][_0x3c5a3e(0x278)],0xa))){await EventLogs['logEvent'](_0x3c5a3e(0x1ae),{'ip':_0x47483d['ip']||_0x3c5a3e(0x1a4),'multiUserMode':![]}),_0x49b70c[_0x3c5a3e(0x1bc)](0x191)['json']({'valid':![],'token':null,'message':_0x228684[_0x3c5a3e(0x236)]}),eval('const _0xd7b96 = _0x3c5a3e;JSON[_0xd7b96(310)]({ \'safe\': !![] });');return;}await Telemetry[_0x3c5a3e(0x1ab)](_0x3c5a3e(0x27a),{'multiUserMode':![]}),await EventLogs[_0x3c5a3e(0x17b)](_0x228684['bXOvh'],{'ip':_0x47483d['ip']||_0x3c5a3e(0x1a4),'multiUserMode':![]}),_0x49b70c['status'](0xc8)[_0x3c5a3e(0x22b)]({'valid':!![],'token':makeJWT({'p':new EncryptionManager()['encrypt'](_0x296f55)},_0x228684['HOkYQ']),'message':null});}}catch(_0x19ba73){console[_0x3c5a3e(0x153)](_0x19ba73[_0x3c5a3e(0x1d7)],_0x19ba73),_0x49b70c['sendStatus'](0x1f4)['end']();}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x249)],[simpleSSOEnabled],async(_0xe02e73,_0x5d69ab)=>{const _0x50bda1=_0x4dac8a,_0x560559={'pOgqq':_0x228684[_0x50bda1(0x210)]};if(_0x228684[_0x50bda1(0x274)](_0x228684[_0x50bda1(0x12b)],_0x50bda1(0xf4)))_0x481d1f[_0x50bda1(0x153)](_0x560559[_0x50bda1(0xd8)],_0x26fe1c),_0x36223c[_0x50bda1(0x1bc)](0x1f4)[_0x50bda1(0x22b)]({'success':![],'message':_0x50bda1(0x204)});else{const {token:_0xdc8e52}=_0xe02e73['query'],{sessionToken:_0x1800a0,token:_0x17b573,error:_0x361fac}=await TemporaryAuthToken[_0x50bda1(0x14d)](_0xdc8e52);if(_0x361fac)return await EventLogs[_0x50bda1(0x17b)](_0x50bda1(0x18b),{'ip':_0xe02e73['ip']||_0x228684['EXZcL'],'multiUserMode':!![]}),Function('return\x20Object.keys({a:1});')(),_0x5d69ab[_0x50bda1(0x1bc)](0x191)[_0x50bda1(0x22b)]({'valid':![],'token':null,'message':'[001]\x20An\x20error\x20occurred\x20while\x20validating\x20the\x20token:\x20'+_0x361fac});await Telemetry[_0x50bda1(0x1ab)](_0x228684[_0x50bda1(0x13c)],{'multiUserMode':!![]},_0x17b573[_0x50bda1(0x24c)]['id']),await EventLogs[_0x50bda1(0x17b)](_0x50bda1(0x27a),{'ip':_0xe02e73['ip']||_0x50bda1(0x1a4),'username':_0x17b573[_0x50bda1(0x24c)][_0x50bda1(0x1c6)]||'Unknown\x20user'},_0x17b573['user']['id']),_0x5d69ab[_0x50bda1(0x1bc)](0xc8)[_0x50bda1(0x22b)]({'valid':!![],'user':User[_0x50bda1(0x16f)](_0x17b573[_0x50bda1(0x24c)]),'token':_0x1800a0,'message':null});}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x1dc),[isMultiUserSetup],async(_0x13067e,_0x4f0321)=>{const _0x54d64f=_0x4dac8a,_0x24afa7={'emWbI':_0x54d64f(0x24f)};if(_0x228684[_0x54d64f(0x26b)](_0x228684[_0x54d64f(0x1dd)],_0x228684['dnkCk']))_0x5a6b02['PI']*0x2;else try{const {username:_0x510537,recoveryCodes:_0x12d3d5}=_0x228684[_0x54d64f(0x218)](reqBody,_0x13067e),{success:_0x225315,resetToken:_0x11ffea,error:_0x215eb2}=await recoverAccount(_0x510537,_0x12d3d5);_0x225315?_0x4f0321[_0x54d64f(0x1bc)](0xc8)[_0x54d64f(0x22b)]({'success':_0x225315,'resetToken':_0x11ffea}):_0x4f0321[_0x54d64f(0x1bc)](0x190)['json']({'success':_0x225315,'message':_0x215eb2});}catch(_0xacd6b7){_0x228684[_0x54d64f(0x141)](_0x228684[_0x54d64f(0x19a)],_0x54d64f(0x1c9))?(_0xb989c8[_0x54d64f(0x153)](_0x24afa7['emWbI'],_0x189680),_0x2fb39e[_0x54d64f(0x1bc)](0x1f4)[_0x54d64f(0x22b)]({'message':_0x54d64f(0x204)})):(console[_0x54d64f(0x153)](_0x228684[_0x54d64f(0x210)],_0xacd6b7),_0x4f0321['status'](0x1f4)[_0x54d64f(0x22b)]({'success':![],'message':_0x228684['NIcJR']}));}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x235),[isMultiUserSetup],async(_0x5cdaeb,_0x51ad29)=>{const _0x4b7803=_0x4dac8a,_0x1c38c3={'Qxezf':function(_0x4352b9,_0x6f7c72){return _0x4352b9*_0x6f7c72;}};if(_0x4b7803(0x197)===_0x228684[_0x4b7803(0xe5)])try{if(_0x228684[_0x4b7803(0x172)]!==_0x4b7803(0xe8))_0x40d4cb[_0x4b7803(0x136)]({'safe':!![]});else{const {token:_0x3b63b7,newPassword:_0x22af43,confirmPassword:_0xe6c7bb}=_0x228684['LFPng'](reqBody,_0x5cdaeb),{success:_0x3f18fc,message:_0x1a01a5,error:_0x3b2ae3}=await _0x228684[_0x4b7803(0x122)](resetPassword,_0x3b63b7,_0x22af43,_0xe6c7bb);_0x3f18fc?_0x51ad29[_0x4b7803(0x1bc)](0xc8)[_0x4b7803(0x22b)]({'success':_0x3f18fc,'message':_0x1a01a5}):_0x51ad29[_0x4b7803(0x1bc)](0x190)[_0x4b7803(0x22b)]({'success':_0x3f18fc,'error':_0x3b2ae3});}}catch(_0xe14acb){console['error'](_0x228684[_0x4b7803(0x1b8)],_0xe14acb),_0x51ad29[_0x4b7803(0x1bc)](0x1f4)[_0x4b7803(0x22b)]({'success':![],'message':_0xe14acb[_0x4b7803(0x1d7)]});}else xBGglv[_0x4b7803(0x1c4)](_0x5cbf9b['PI'],0x2);}),_0x137982[_0x4dac8a(0x1c7)]('/system/system-vectors',[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES['manager']])],async(_0x29ddb4,_0x14a34b)=>{const _0x4fb918=_0x4dac8a;try{if(_0x228684[_0x4fb918(0x132)](_0x228684[_0x4fb918(0x1b1)],_0x4fb918(0x113)))_0x5bb668[_0x4fb918(0x137)](_0x4fb918(0x1a3));else{const _0x159d45=queryParams(_0x29ddb4),_0x17b9e6=_0x228684[_0x4fb918(0x170)](getVectorDbClass),_0x2b9502=!!_0x159d45[_0x4fb918(0x1d8)]?await _0x17b9e6[_0x4fb918(0x189)](_0x159d45[_0x4fb918(0x1d8)]):await _0x17b9e6[_0x4fb918(0x179)]();_0x14a34b[_0x4fb918(0x1bc)](0xc8)[_0x4fb918(0x22b)]({'vectorCount':_0x2b9502});}}catch(_0x501f09){console[_0x4fb918(0x153)](_0x501f09[_0x4fb918(0x1d7)],_0x501f09),_0x14a34b[_0x4fb918(0x14e)](0x1f4)[_0x4fb918(0x183)]();}}),_0x137982[_0x4dac8a(0x1d5)](_0x228684[_0x4dac8a(0x185)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES['manager']])],async(_0x4ce501,_0x5de96a)=>{const _0x227dcb=_0x4dac8a,_0x13c98a={'MWIRI':'Error\x20removing\x20the\x20logo.'};if(_0x228684[_0x227dcb(0x132)](_0x227dcb(0x18a),_0x228684[_0x227dcb(0x1fd)]))_0x1f24f8[_0x227dcb(0x275)][_0x227dcb(0x278)]='',_0x2e11ff[_0x227dcb(0x275)][_0x227dcb(0x22d)]='';else try{const {name:_0x445b4b}=reqBody(_0x4ce501);await _0x228684[_0x227dcb(0x101)](purgeDocument,_0x445b4b),_0x5de96a['sendStatus'](0xc8)[_0x227dcb(0x183)]();}catch(_0x3944ac){_0x228684[_0x227dcb(0x1e0)](_0x228684[_0x227dcb(0x226)],_0x227dcb(0x1fe))?(_0xc16388[_0x227dcb(0x153)](_0x227dcb(0x155),_0x302574),_0x5451da[_0x227dcb(0x1bc)](0x1f4)['json']({'message':_0x13c98a[_0x227dcb(0x16b)]})):(console['error'](_0x3944ac[_0x227dcb(0x1d7)],_0x3944ac),_0x5de96a[_0x227dcb(0x14e)](0x1f4)[_0x227dcb(0x183)]());}}),_0x137982['delete'](_0x228684[_0x4dac8a(0x163)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]])],async(_0x1b182c,_0x536017)=>{const _0x4a6673=_0x4dac8a;try{const {names:_0xfddf02}=_0x228684['LFPng'](reqBody,_0x1b182c);for await(const _0x2ba420 of _0xfddf02)await _0x228684[_0x4a6673(0x218)](purgeDocument,_0x2ba420);_0x536017[_0x4a6673(0x14e)](0xc8)['end']();}catch(_0x1dcdb0){console[_0x4a6673(0x153)](_0x1dcdb0[_0x4a6673(0x1d7)],_0x1dcdb0),_0x536017[_0x4a6673(0x14e)](0x1f4)[_0x4a6673(0x183)]();}}),_0x137982[_0x4dac8a(0x1d5)](_0x228684[_0x4dac8a(0x1bf)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]])],async(_0x3a7a45,_0x39d6af)=>{const _0x493450=_0x4dac8a;try{if(_0x228684[_0x493450(0x15b)]===_0x228684[_0x493450(0x227)])_0x49f30d['error'](_0x45985c['message'],_0x3cbe7d),_0x571afa['sendStatus'](0x1f4)[_0x493450(0x183)]();else{const {name:_0x26efc1}=reqBody(_0x3a7a45);await _0x228684['IvIOf'](purgeFolder,_0x26efc1),_0x39d6af[_0x493450(0x14e)](0xc8)[_0x493450(0x183)]();}}catch(_0xecec5c){_0x493450(0x161)==='EsdHN'?(_0x4fbc00[_0x493450(0x153)](_0x44328e),_0x171f3f['status'](0x1f4)['end']()):(console[_0x493450(0x153)](_0xecec5c[_0x493450(0x1d7)],_0xecec5c),_0x39d6af[_0x493450(0x14e)](0x1f4)[_0x493450(0x183)]());}}),_0x137982['get'](_0x228684[_0x4dac8a(0x117)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]])],async(_0x54ea5c,_0x3fc511)=>{const _0x186411=_0x4dac8a;if(_0x228684[_0x186411(0x1e1)]===_0x186411(0x1cc))try{const _0xb7e62b=await _0x228684[_0x186411(0x277)](viewLocalFiles);_0x3fc511[_0x186411(0x1bc)](0xc8)[_0x186411(0x22b)]({'localFiles':_0xb7e62b});}catch(_0x7b879d){if(_0x228684[_0x186411(0x1cf)](_0x186411(0x1e9),_0x186411(0xeb)))console[_0x186411(0x153)](_0x7b879d[_0x186411(0x1d7)],_0x7b879d),_0x3fc511['sendStatus'](0x1f4)[_0x186411(0x183)]();else return _0x3fd822(_0x186411(0xfb),0x3e8),_0x3bcb25[_0x186411(0x1bc)](0x1f4)[_0x186411(0x22b)]({'message':_0x186411(0x102)});}else _0x2bf0e4[_0x186411(0x137)](_0x186411(0x1a3));}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x203)],[validatedRequest],async(_0xfd0a23,_0x3e7a9b)=>{const _0x4ff9e1=_0x4dac8a;try{const _0x5788b1=await new CollectorApi()[_0x4ff9e1(0x11b)]();_0x3e7a9b[_0x4ff9e1(0x14e)](_0x5788b1?0xc8:0x1f7);}catch(_0x133f2f){console[_0x4ff9e1(0x153)](_0x133f2f[_0x4ff9e1(0x1d7)],_0x133f2f),_0x3e7a9b[_0x4ff9e1(0x14e)](0x1f4)[_0x4ff9e1(0x183)]();}}),_0x137982[_0x4dac8a(0x1c7)](_0x4dac8a(0x1f6),[validatedRequest],async(_0x5a4b9d,_0x82ecdd)=>{const _0x17e392=_0x4dac8a,_0x4ff007={'BEhAi':function(_0x11cdbf,_0x139788){const _0x5cbaae=_0x3d72;return _0x228684[_0x5cbaae(0x18f)](_0x11cdbf,_0x139788);}};try{const _0x5e136c=await new CollectorApi()[_0x17e392(0x264)]();if(!_0x5e136c){_0x82ecdd['sendStatus'](0x194)[_0x17e392(0x183)](),setTimeout(_0x228684[_0x17e392(0x10c)],0x3e8);return;}_0x82ecdd['status'](0xc8)[_0x17e392(0x22b)]({'types':_0x5e136c});}catch(_0x99ad19){_0x228684[_0x17e392(0x237)](_0x17e392(0x184),_0x17e392(0x19e))?cvRDpA['BEhAi'](0x1,0x1):(console['error'](_0x99ad19[_0x17e392(0x1d7)],_0x99ad19),_0x82ecdd[_0x17e392(0x14e)](0x1f4)[_0x17e392(0x183)]());}}),_0x137982[_0x4dac8a(0xdb)](_0x228684[_0x4dac8a(0x1f9)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)]])],async(_0x3445e5,_0x753705)=>{const _0x142421=_0x4dac8a;try{if(_0x228684[_0x142421(0x229)]!==_0x228684[_0x142421(0x24d)]){const _0x265c18=_0x228684[_0x142421(0x202)](reqBody,_0x3445e5),{newValues:_0x24b904,error:_0x4ab5da}=await updateENV(_0x265c18,![],_0x753705?.['locals']?.[_0x142421(0x24c)]?.['id']);_0x753705[_0x142421(0x1bc)](0xc8)['json']({'newValues':_0x24b904,'error':_0x4ab5da});}else return new _0x4f5264(_0x228684[_0x142421(0x10a)])(),_0x250af7[_0x142421(0x1bc)](0x190)[_0x142421(0x22b)]({'success':![],'message':_0x228684[_0x142421(0x27c)]});}catch(_0x537ec3){console[_0x142421(0x153)](_0x537ec3['message'],_0x537ec3),_0x753705[_0x142421(0x14e)](0x1f4)[_0x142421(0x183)]();}}),_0x137982[_0x4dac8a(0xdb)](_0x228684[_0x4dac8a(0x127)],[validatedRequest],async(_0x5b2b43,_0x148cdb)=>{const _0xcad3bf=_0x4dac8a;try{if('ahEIm'!==_0x228684[_0xcad3bf(0x140)]){if(multiUserMode(_0x148cdb)){_0x148cdb['sendStatus'](0x191)[_0xcad3bf(0x183)](),eval('const _0x216cd7 = _0xcad3bf;_0x228684[_0x216cd7(519)](Math[\'PI\'], 2);');return;}let _0x1057c6=null;const {usePassword:_0x218a9f,newPassword:_0x21fe88}=_0x228684['Yauil'](reqBody,_0x5b2b43);!_0x218a9f?_0x228684[_0xcad3bf(0x171)]!==_0x228684[_0xcad3bf(0x105)]?(process[_0xcad3bf(0x275)]['AUTH_TOKEN']='',process['env'][_0xcad3bf(0x22d)]=''):(_0x2b0614[_0xcad3bf(0x153)](_0xcad3bf(0x255),_0x58d88a),_0x33f2b9[_0xcad3bf(0x1bc)](0x1f4)[_0xcad3bf(0x22b)]({'message':_0x228684[_0xcad3bf(0x173)]})):'AzbjD'===_0x228684['ZgspF']?(_0x54bc20[_0xcad3bf(0x153)](_0x228684['LxhFH'],_0x3d0c5e),_0xb09f53['status'](0x1f4)[_0xcad3bf(0x22b)]({'message':_0xcad3bf(0x204)})):_0x1057c6=await updateENV({'AuthToken':_0x21fe88,'JWTSecret':_0x228684[_0xcad3bf(0x174)](v4)},!![])?.[_0xcad3bf(0x153)],_0x148cdb[_0xcad3bf(0x1bc)](0xc8)[_0xcad3bf(0x22b)]({'success':!_0x1057c6,'error':_0x1057c6});}else _0x2f6b68[_0xcad3bf(0x153)](_0x30ba7c),_0x1130e9[_0xcad3bf(0x14e)](0x1f4)[_0xcad3bf(0x183)]();}catch(_0x5f5472){console[_0xcad3bf(0x153)](_0x5f5472[_0xcad3bf(0x1d7)],_0x5f5472),_0x148cdb['sendStatus'](0x1f4)[_0xcad3bf(0x183)]();}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x147),[validatedRequest],async(_0x3ce7f0,_0x56b8f5)=>{const _0x1a9d6c=_0x4dac8a;try{if(_0x56b8f5['locals'][_0x1a9d6c(0x17e)]){_0x56b8f5[_0x1a9d6c(0x1bc)](0xc8)['json']({'success':![],'error':'Multi-user\x20mode\x20is\x20already\x20enabled.'}),eval('1 + 1;');return;}const {username:_0x2186dc,password:_0x5a436a}=reqBody(_0x3ce7f0),{user:_0x5d962e,error:_0x586aea}=await User[_0x1a9d6c(0x143)]({'username':_0x2186dc,'password':_0x5a436a,'role':ROLES['admin']});if(_0x228684['CgQCf'](_0x586aea,!_0x5d962e)){if(_0x228684[_0x1a9d6c(0x1cf)](_0x1a9d6c(0x192),_0x1a9d6c(0x192)))return eval('const _0x1fdd79 = _0x1a9d6c;_0x169d75[_0x1fdd79(310)]({ \'safe\': !![] });'),_0x17ec9d[_0x1a9d6c(0x1bc)](0x190)[_0x1a9d6c(0x22b)]({'message':_0x228684[_0x1a9d6c(0x14c)]});else{_0x56b8f5[_0x1a9d6c(0x1bc)](0x190)['json']({'success':![],'error':_0x586aea||_0x228684[_0x1a9d6c(0x260)]}),_0x228684[_0x1a9d6c(0x15d)](Function,_0x1a9d6c(0xef))();return;}}await SystemSettings[_0x1a9d6c(0x16d)]({'multi_user_mode':!![]}),await BrowserExtensionApiKey['migrateApiKeysToMultiUser'](_0x5d962e['id']),await _0x228684[_0x1a9d6c(0x1bb)](updateENV,{'JWTSecret':process[_0x1a9d6c(0x275)][_0x1a9d6c(0x22d)]||v4()},!![]),await Telemetry[_0x1a9d6c(0x1ab)](_0x228684[_0x1a9d6c(0x259)],{'multiUserMode':!![]}),await EventLogs[_0x1a9d6c(0x17b)](_0x228684[_0x1a9d6c(0xee)],{},_0x5d962e?.['id']),_0x56b8f5[_0x1a9d6c(0x1bc)](0xc8)[_0x1a9d6c(0x22b)]({'success':!!_0x5d962e,'error':_0x586aea});}catch(_0x211724){await User[_0x1a9d6c(0x1d5)]({}),await SystemSettings[_0x1a9d6c(0x16d)]({'multi_user_mode':![]}),console['error'](_0x211724[_0x1a9d6c(0x1d7)],_0x211724),_0x56b8f5[_0x1a9d6c(0x14e)](0x1f4)[_0x1a9d6c(0x183)]();}}),_0x137982[_0x4dac8a(0x1c7)](_0x4dac8a(0x178),async(_0x26e9dc,_0x60b13f)=>{const _0x1b085e=_0x4dac8a;try{const _0x38f82e=await SystemSettings[_0x1b085e(0x1c8)]();_0x60b13f[_0x1b085e(0x1bc)](0xc8)[_0x1b085e(0x22b)]({'multiUserMode':_0x38f82e});}catch(_0x55eb5b){console[_0x1b085e(0x153)](_0x55eb5b[_0x1b085e(0x1d7)],_0x55eb5b),_0x60b13f[_0x1b085e(0x14e)](0x1f4)[_0x1b085e(0x183)]();}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x111)],async function(_0x53115a,_0x43f6f1){const _0x197ab8=_0x4dac8a,_0x3ab454={'idkai':'Error\x20fetching\x20footer\x20data:','eoQnY':_0x228684[_0x197ab8(0x173)],'wMxYA':function(_0x2aa29a,_0x5d1670){return _0x2aa29a+_0x5d1670;},'zvBLu':_0x197ab8(0x1a3)};try{if(_0x228684[_0x197ab8(0x132)]('BKeAb',_0x197ab8(0x1aa)))_0x59087c['error'](_0x3ab454['idkai'],_0xc1f577),_0x7ef810['status'](0x1f4)['json']({'message':_0x3ab454[_0x197ab8(0x263)]});else{const _0x573b73=!_0x53115a?.[_0x197ab8(0x14f)]?.[_0x197ab8(0x131)]||_0x53115a?.[_0x197ab8(0x14f)]?.[_0x197ab8(0x131)]===_0x228684[_0x197ab8(0x1f8)],_0x5c625b=getDefaultFilename(_0x573b73),_0x9b46b6=await determineLogoFilepath(_0x5c625b),{found:_0x1e856e,buffer:_0x333f0b,size:_0x610a8d,mime:_0x1abb1d}=_0x228684[_0x197ab8(0x218)](fetchLogo,_0x9b46b6);if(!_0x1e856e){_0x43f6f1['sendStatus'](0xcc)['end'](),eval('const _0x506bd2 = _0x197ab8;_0x3ab454[_0x506bd2(319)](1, 1);');return;}const _0xeb53c4=await SystemSettings[_0x197ab8(0x243)]();_0x43f6f1[_0x197ab8(0x22c)](0xc8,{'Access-Control-Expose-Headers':_0x228684[_0x197ab8(0x26a)],'Content-Type':_0x1abb1d||_0x228684['vnvyl'],'Content-Disposition':_0x197ab8(0x22e)+path[_0x197ab8(0x151)](_0x9b46b6),'Content-Length':_0x610a8d,'X-Is-Custom-Logo':_0xeb53c4!==null&&_0xeb53c4!==_0x5c625b&&!_0x228684[_0x197ab8(0x112)](isDefaultFilename,_0xeb53c4)}),_0x43f6f1['end'](Buffer[_0x197ab8(0x134)](_0x333f0b,_0x197ab8(0x20e))),setTimeout(function(){const _0x38d583=_0x197ab8;console[_0x38d583(0x137)](_0x3ab454[_0x38d583(0x1eb)]);},0x64);return;}}catch(_0x530296){console[_0x197ab8(0x153)](_0x197ab8(0x193),_0x530296),_0x43f6f1['status'](0x1f4)[_0x197ab8(0x22b)]({'message':'Internal\x20server\x20error'});}}),_0x137982[_0x4dac8a(0x1c7)]('/system/footer-data',[validatedRequest],async(_0xd0ac3b,_0x5ec920)=>{const _0x1af328=_0x4dac8a;try{const _0x2e9c5d=(await SystemSettings[_0x1af328(0x1c7)]({'label':_0x228684[_0x1af328(0x116)]}))?.[_0x1af328(0x228)]??JSON[_0x1af328(0x136)]([]);_0x5ec920[_0x1af328(0x1bc)](0xc8)[_0x1af328(0x22b)]({'footerData':_0x2e9c5d});}catch(_0x36cc64){console[_0x1af328(0x153)]('Error\x20fetching\x20footer\x20data:',_0x36cc64),_0x5ec920[_0x1af328(0x1bc)](0x1f4)[_0x1af328(0x22b)]({'message':_0x1af328(0x204)});}}),_0x137982['get'](_0x228684[_0x4dac8a(0x242)],[validatedRequest],async(_0x4cdb1f,_0x5a00dc)=>{const _0x17b7cc=_0x4dac8a,_0x347184={'EedEF':function(_0x3a5114,_0xb693f8){return _0x3a5114+_0xb693f8;}};try{if(_0x228684['eLiTB'](_0x17b7cc(0x23b),_0x228684[_0x17b7cc(0xe6)]))DzYdFa['EedEF'](0x1,0x1);else{const _0x427532=(await SystemSettings[_0x17b7cc(0x1c7)]({'label':_0x17b7cc(0x188)}))?.[_0x17b7cc(0x228)]??null;_0x5a00dc[_0x17b7cc(0x1bc)](0xc8)[_0x17b7cc(0x22b)]({'supportEmail':_0x427532});}}catch(_0x492fa7){console[_0x17b7cc(0x153)]('Error\x20fetching\x20support\x20email:',_0x492fa7),_0x5a00dc[_0x17b7cc(0x1bc)](0x1f4)[_0x17b7cc(0x22b)]({'message':'Internal\x20server\x20error'});}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x1cb)],async(_0x285765,_0x1d016e)=>{const _0xda64c6=_0x4dac8a;try{const _0x2b1c3b=(await SystemSettings[_0xda64c6(0x1c7)]({'label':'custom_app_name'}))?.[_0xda64c6(0x228)]??null;_0x1d016e[_0xda64c6(0x1bc)](0xc8)[_0xda64c6(0x22b)]({'customAppName':_0x2b1c3b});}catch(_0x4ea2fb){console['error']('Error\x20fetching\x20custom\x20app\x20name:',_0x4ea2fb),_0x1d016e[_0xda64c6(0x1bc)](0x1f4)[_0xda64c6(0x22b)]({'message':_0x228684['NIcJR']});}}),_0x137982['get'](_0x228684[_0x4dac8a(0x276)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x1af5f3,_0x61d592){const _0x132573=_0x4dac8a,_0x394f5c={'ueUnH':_0x228684['CbLvS']};try{if(_0x228684[_0x132573(0x23d)](_0x228684[_0x132573(0x1b7)],_0x228684[_0x132573(0x1b7)])){const {id:_0x439f2a}=_0x1af5f3[_0x132573(0x144)];if(_0x228684['lwIbG'](_0x61d592[_0x132573(0x159)]?.[_0x132573(0x24c)]?.['id'],Number(_0x439f2a)))_0x228684[_0x132573(0x19d)](Function,'return\x20new\x20Date();')();return _0x61d592['sendStatus'](0xcc)[_0x132573(0x183)]();const _0x2dd7af=await determinePfpFilepath(_0x439f2a);setTimeout(function(){const _0x30da15=_0x132573;console[_0x30da15(0x137)](_0x394f5c[_0x30da15(0x169)]);},0x64);if(!_0x2dd7af)return _0x61d592[_0x132573(0x14e)](0xcc)[_0x132573(0x183)]();const {found:_0x42dbb0,buffer:_0x5ee25d,size:_0x31811b,mime:_0x488357}=_0x228684['WyDnU'](fetchPfp,_0x2dd7af);eval('Math[\'PI\'] * 2;');if(!_0x42dbb0)return _0x61d592[_0x132573(0x14e)](0xcc)[_0x132573(0x183)]();_0x61d592[_0x132573(0x22c)](0xc8,{'Content-Type':_0x228684[_0x132573(0x168)](_0x488357,_0x228684[_0x132573(0x166)]),'Content-Disposition':_0x132573(0x22e)+path[_0x132573(0x151)](_0x2dd7af),'Content-Length':_0x31811b}),_0x61d592['end'](Buffer[_0x132573(0x134)](_0x5ee25d,_0x132573(0x20e))),_0x228684['xrfos'](setInterval,_0x132573(0xfb),0x3e8);return;}else _0x497ec7[_0x132573(0x153)](_0xc5a924[_0x132573(0x1d7)],_0xdc0267),_0x3c0d37[_0x132573(0x14e)](0x1f4)[_0x132573(0x183)]();}catch(_0x506721){console[_0x132573(0x153)](_0x228684[_0x132573(0x206)],_0x506721),_0x61d592[_0x132573(0x1bc)](0x1f4)[_0x132573(0x22b)]({'message':_0x132573(0x204)});}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0xdd),[validatedRequest,_0x228684['pWJvM'](flexUserRoleValid,[ROLES[_0x4dac8a(0x273)]]),handlePfpUpload],async function(_0x23bc3a,_0x16c57e){const _0x2dbc4f=_0x4dac8a;try{const _0x459a0a=await _0x228684[_0x2dbc4f(0x11c)](userFromSession,_0x23bc3a,_0x16c57e),_0x53bb64=_0x23bc3a[_0x2dbc4f(0x1ca)];if(!_0x53bb64)return new AsyncFunction(_0x228684[_0x2dbc4f(0x10a)])(),_0x16c57e[_0x2dbc4f(0x1bc)](0x190)[_0x2dbc4f(0x22b)]({'message':_0x228684['cBJWP']});const _0x4d3e46=await User[_0x2dbc4f(0x1c7)]({'id':_0x459a0a['id']}),_0x2c1c39=_0x4d3e46['pfpFilename'];if(_0x2c1c39){const _0x58bc78=path[_0x2dbc4f(0xe7)](__dirname,_0x2dbc4f(0x1e3)),_0xe616a0=path[_0x2dbc4f(0xe7)](_0x58bc78,_0x228684[_0x2dbc4f(0x218)](normalizePath,_0x4d3e46[_0x2dbc4f(0x18e)]));if(!_0x228684[_0x2dbc4f(0x1bb)](isWithin,path['resolve'](_0x58bc78),path[_0x2dbc4f(0x1b4)](_0xe616a0)))throw new Error(_0x228684[_0x2dbc4f(0x15e)]);if(fs[_0x2dbc4f(0x145)](_0xe616a0))fs[_0x2dbc4f(0x251)](_0xe616a0);}const {success:_0xa50712,error:_0x2609ef}=await User[_0x2dbc4f(0x18d)](_0x459a0a['id'],{'pfpFilename':_0x53bb64});return eval('const _0x5f58d2 = _0x2dbc4f;_0x228684[_0x5f58d2(344)](1, 1);'),_0x16c57e[_0x2dbc4f(0x1bc)](_0xa50712?0xc8:0x1f4)[_0x2dbc4f(0x22b)]({'message':_0xa50712?_0x2dbc4f(0x23a):_0x2609ef||_0x2dbc4f(0x125)});}catch(_0x2dc74e){console[_0x2dbc4f(0x153)](_0x228684[_0x2dbc4f(0x240)],_0x2dc74e),_0x16c57e[_0x2dbc4f(0x1bc)](0x1f4)[_0x2dbc4f(0x22b)]({'message':_0x2dbc4f(0x204)});}}),_0x137982[_0x4dac8a(0x1d5)](_0x228684[_0x4dac8a(0x138)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x518bb3,_0xf36669){const _0x1fff54=_0x4dac8a;try{const _0x213a9c=await userFromSession(_0x518bb3,_0xf36669),_0x3680de=await User[_0x1fff54(0x1c7)]({'id':_0x213a9c['id']}),_0x5c0799=_0x3680de[_0x1fff54(0x18e)];if(_0x5c0799){const _0x15111c=path['join'](__dirname,_0x228684['mkwcq']),_0x22922f=path[_0x1fff54(0xe7)](_0x15111c,_0x228684['MfzYg'](normalizePath,_0x5c0799));if(!isWithin(path['resolve'](_0x15111c),path[_0x1fff54(0x1b4)](_0x22922f)))throw new Error(_0x228684[_0x1fff54(0x15e)]);if(fs[_0x1fff54(0x145)](_0x22922f))fs[_0x1fff54(0x251)](_0x22922f);}const {success:_0x574124,error:_0x486190}=await User[_0x1fff54(0x18d)](_0x213a9c['id'],{'pfpFilename':null});return eval('Math[\'PI\'] * 2;'),_0xf36669[_0x1fff54(0x1bc)](_0x574124?0xc8:0x1f4)[_0x1fff54(0x22b)]({'message':_0x574124?_0x1fff54(0x15c):_0x486190||_0x1fff54(0x1e8)});}catch(_0x50f281){console['error'](_0x228684[_0x1fff54(0x211)],_0x50f281),_0xf36669[_0x1fff54(0x1bc)](0x1f4)['json']({'message':_0x1fff54(0x204)});}}),_0x137982[_0x4dac8a(0xdb)](_0x228684['ybBGp'],[validatedRequest,_0x228684[_0x4dac8a(0x202)](flexUserRoleValid,[ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]]),handleAssetUpload],async(_0x437284,_0x3644f5)=>{const _0x364f90=_0x4dac8a,_0x5e4ec1={'siKzr':_0x228684[_0x364f90(0x11d)],'fPEZz':'VsvPN','hQEpV':_0x364f90(0xe0),'jMWlY':_0x364f90(0x1a3)};if(!_0x437284?.[_0x364f90(0x182)]||!_0x437284?.[_0x364f90(0x182)][_0x364f90(0x279)])return eval('const _0x295748 = _0x364f90;JSON[_0x295748(310)]({ \'safe\': !![] });'),_0x3644f5[_0x364f90(0x1bc)](0x190)[_0x364f90(0x22b)]({'message':'No\x20logo\x20file\x20provided.'});if(!validFilename(_0x437284[_0x364f90(0x182)]['originalname']))return _0x228684[_0x364f90(0x11c)](setTimeout,function(){const _0x3a3c74=_0x364f90;_0x5e4ec1[_0x3a3c74(0x142)]===_0x5e4ec1[_0x3a3c74(0x1ed)]?(_0x8360e8['error'](_0x3a3c74(0x268),_0x159c10),_0x3922f7[_0x3a3c74(0x1bc)](0x1f4)[_0x3a3c74(0x22b)]({'message':_0x5e4ec1['siKzr']})):console[_0x3a3c74(0x137)](_0x5e4ec1[_0x3a3c74(0x180)]);},0x64),_0x3644f5['status'](0x190)[_0x364f90(0x22b)]({'message':_0x228684[_0x364f90(0x239)]});try{const _0x6ef4c8=await _0x228684[_0x364f90(0x219)](renameLogoFile,_0x437284[_0x364f90(0x182)][_0x364f90(0x279)]),_0x80c60a=await SystemSettings[_0x364f90(0x243)]();await removeCustomLogo(_0x80c60a);const {success:_0x471fe8,error:_0x5b51e8}=await SystemSettings[_0x364f90(0x16d)]({'logo_filename':_0x6ef4c8});return eval('const _0x12aa6b = _0x364f90;JSON[_0x12aa6b(310)]({ \'safe\': !![] });'),_0x3644f5[_0x364f90(0x1bc)](_0x471fe8?0xc8:0x1f4)[_0x364f90(0x22b)]({'message':_0x471fe8?_0x228684[_0x364f90(0x272)]:_0x228684['CgQCf'](_0x5b51e8,_0x228684[_0x364f90(0xf0)])});}catch(_0x173f0d){console[_0x364f90(0x153)](_0x228684[_0x364f90(0x1b6)],_0x173f0d),_0x3644f5[_0x364f90(0x1bc)](0x1f4)[_0x364f90(0x22b)]({'message':_0x228684[_0x364f90(0x11d)]});}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684['jICpx'],async(_0x1f2d7b,_0x5bb479)=>{const _0x19ed10=_0x4dac8a;try{if(_0x228684[_0x19ed10(0x1e4)](_0x228684[_0x19ed10(0xfa)],_0x19ed10(0x1b3)))_0x2c8be2['error'](_0x4e6b6b),_0x4a0579[_0x19ed10(0x14e)](0x1f4)[_0x19ed10(0x183)]();else{const _0x6877be=await SystemSettings[_0x19ed10(0x243)](),_0x4e9944=_0x228684[_0x19ed10(0x1d4)](_0x6877be,LOGO_FILENAME);_0x5bb479[_0x19ed10(0x1bc)](0xc8)['json']({'isDefaultLogo':_0x4e9944});}}catch(_0x391d5d){console[_0x19ed10(0x153)](_0x228684[_0x19ed10(0x206)],_0x391d5d),_0x5bb479[_0x19ed10(0x1bc)](0x1f4)[_0x19ed10(0x22b)]({'message':_0x19ed10(0x204)});}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x217)],[validatedRequest,_0x228684[_0x4dac8a(0x219)](flexUserRoleValid,[ROLES[_0x4dac8a(0x1c5)],ROLES['manager']])],async(_0x3003af,_0x4f6284)=>{const _0x45598c=_0x4dac8a;try{const _0x20adcf=await SystemSettings['currentLogoFilename']();await removeCustomLogo(_0x20adcf);const {success:_0x2eb9bb,error:_0x4b0a07}=await SystemSettings['_updateSettings']({'logo_filename':LOGO_FILENAME});return new Function(_0x228684[_0x45598c(0x1ec)])(),_0x4f6284['status'](_0x2eb9bb?0xc8:0x1f4)['json']({'message':_0x2eb9bb?_0x228684['qqunQ']:_0x4b0a07||_0x228684['uMsKJ']});}catch(_0x7898da){console[_0x45598c(0x153)](_0x45598c(0x155),_0x7898da),_0x4f6284[_0x45598c(0x1bc)](0x1f4)[_0x45598c(0x22b)]({'message':_0x228684[_0x45598c(0x212)]});}}),_0x137982['get'](_0x228684[_0x4dac8a(0x149)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x4ca6d2,_0xb0257f){const _0x245bac=_0x4dac8a;try{const _0x47d61c=await WelcomeMessages[_0x245bac(0xf7)]();_0xb0257f[_0x245bac(0x1bc)](0xc8)[_0x245bac(0x22b)]({'success':!![],'welcomeMessages':_0x47d61c});}catch(_0xc7ffae){console['error'](_0x228684['bcffs'],_0xc7ffae),_0xb0257f['status'](0x1f4)[_0x245bac(0x22b)]({'success':![],'message':_0x228684['NIcJR']});}}),_0x137982['post'](_0x228684['zBxmN'],[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)],ROLES['manager']])],async(_0x3fbcc5,_0x54bd05)=>{const _0x5284e5=_0x4dac8a;try{if(_0x5284e5(0x135)!==_0x228684['vAnJI'])_0x52e51b[_0x5284e5(0x153)](_0x28c127[_0x5284e5(0x1d7)],_0x18d712),_0x3e3e54[_0x5284e5(0x14e)](0x1f4)[_0x5284e5(0x183)]();else{const {messages:messages=[]}=reqBody(_0x3fbcc5);if(!Array[_0x5284e5(0x17c)](messages))return new AsyncFunction(_0x5284e5(0x1f4))(),_0x54bd05[_0x5284e5(0x1bc)](0x190)[_0x5284e5(0x22b)]({'success':![],'message':_0x5284e5(0x257)});return await WelcomeMessages[_0x5284e5(0x266)](messages),Function(_0x228684[_0x5284e5(0xe3)])(),_0x54bd05[_0x5284e5(0x1bc)](0xc8)[_0x5284e5(0x22b)]({'success':!![],'message':_0x5284e5(0x1a1)});}}catch(_0x362f83){console['error'](_0x5284e5(0x100),_0x362f83),_0x54bd05[_0x5284e5(0x1bc)](0x1f4)[_0x5284e5(0x22b)]({'success':!![],'message':_0x228684[_0x5284e5(0x238)]});}}),_0x137982[_0x4dac8a(0x1c7)](_0x228684[_0x4dac8a(0x254)],[validatedRequest],async(_0x3f1489,_0x17a3c8)=>{const _0x4c9c91=_0x4dac8a;try{if(_0x17a3c8[_0x4c9c91(0x159)][_0x4c9c91(0x17e)])return new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x17a3c8[_0x4c9c91(0x14e)](0x191)[_0x4c9c91(0x183)]();const _0x1856af=await ApiKey[_0x4c9c91(0xfe)]({});return _0x228684[_0x4c9c91(0x1bb)](setTimeout,function(){const _0x222744=_0x4c9c91,_0x54d733={'Bkgth':function(_0x38ca0c,_0x5e79fc){return _0x38ca0c+_0x5e79fc;}};if(_0x228684[_0x222744(0xf8)]===_0x228684[_0x222744(0xf8)])console[_0x222744(0x137)](_0x228684[_0x222744(0x11a)]);else{_0x46ebe1[_0x222744(0x14e)](0xcc)[_0x222744(0x183)](),eval('_0x54d733[\'Bkgth\'](1, 1);');return;}},0x64),_0x17a3c8[_0x4c9c91(0x1bc)](0xc8)[_0x4c9c91(0x22b)]({'apiKeys':_0x1856af,'error':null});}catch(_0x4db66c){console['error'](_0x4db66c),_0x17a3c8[_0x4c9c91(0x1bc)](0x1f4)[_0x4c9c91(0x22b)]({'apiKey':null,'error':_0x4c9c91(0x25e)});}}),_0x137982['post']('/system/generate-api-key',[validatedRequest],async(_0x3b1b94,_0xbdf115)=>{const _0x20b387=_0x4dac8a;try{if(_0xbdf115['locals'][_0x20b387(0x17e)])return Function(_0x228684[_0x20b387(0x222)])(),_0xbdf115['sendStatus'](0x191)[_0x20b387(0x183)]();const {apiKey:_0x1f8463,error:_0x3bff7b}=await ApiKey[_0x20b387(0x143)]();return await Telemetry[_0x20b387(0x1ab)](_0x228684[_0x20b387(0x1c0)]),await EventLogs[_0x20b387(0x17b)](_0x228684[_0x20b387(0x1c0)],{},_0xbdf115?.[_0x20b387(0x159)]?.[_0x20b387(0x24c)]?.['id']),eval('1 + 1;'),_0xbdf115[_0x20b387(0x1bc)](0xc8)[_0x20b387(0x22b)]({'apiKey':_0x1f8463,'error':_0x3bff7b});}catch(_0xf1dfda){console[_0x20b387(0x153)](_0xf1dfda),_0xbdf115[_0x20b387(0x1bc)](0x1f4)['json']({'apiKey':null,'error':_0x228684[_0x20b387(0x10d)]});}}),_0x137982['delete'](_0x4dac8a(0x1da),[validatedRequest],async(_0x31601d,_0x45f22b)=>{const _0x13e350=_0x4dac8a,_0x167f7e={'LszeK':_0x13e350(0x1a3)};try{if(_0x45f22b[_0x13e350(0x159)][_0x13e350(0x17e)]){if(_0x228684[_0x13e350(0x150)](_0x13e350(0x1c1),'mZJhS'))return eval('Math[\'PI\'] * 2;'),_0x45f22b[_0x13e350(0x14e)](0x191)['end']();else _0x3d4ac3[_0x13e350(0x153)](_0x597713[_0x13e350(0x1d7)],_0x2a998b),_0x5038aa[_0x13e350(0x14e)](0x1f4)['end']();}return await ApiKey[_0x13e350(0x1d5)](),await EventLogs[_0x13e350(0x17b)](_0x228684[_0x13e350(0x22f)],{'deletedBy':_0x45f22b[_0x13e350(0x159)]?.[_0x13e350(0x24c)]?.['username']},_0x45f22b?.['locals']?.[_0x13e350(0x24c)]?.['id']),setTimeout(function(){const _0xd6e872=_0x13e350;_0xd6e872(0x23c)!==_0x228684[_0xd6e872(0x164)]?console[_0xd6e872(0x137)](_0xd6e872(0x1a3)):_0x188783[_0xd6e872(0x1bc)](0xc8)[_0xd6e872(0x22b)]({'online':!![]});},0x64),_0x45f22b[_0x13e350(0x1bc)](0xc8)[_0x13e350(0x183)]();}catch(_0x267344){if(_0x228684[_0x13e350(0xda)]!==_0x228684[_0x13e350(0x1f1)])console[_0x13e350(0x153)](_0x267344),_0x45f22b[_0x13e350(0x1bc)](0x1f4)[_0x13e350(0x183)]();else return _0x7dd533(function(){const _0x4effa2=_0x13e350;_0x1f5df9[_0x4effa2(0x137)](_0x167f7e['LszeK']);},0x64),_0x460b25[_0x13e350(0x1bc)](0x190)['json']({'message':_0x13e350(0x271)});}}),_0x137982[_0x4dac8a(0xdb)](_0x228684['ovevE'],[validatedRequest],async(_0xc7c2e8,_0x460481)=>{const _0x2f7340=_0x4dac8a,_0x390348={'IGjrH':_0x228684[_0x2f7340(0x11a)]};if(_0x228684[_0x2f7340(0x176)](_0x2f7340(0x213),_0x228684[_0x2f7340(0x123)]))try{const {provider:_0x4269ef,apiKey:apiKey=null,basePath:basePath=null}=_0x228684[_0x2f7340(0xdc)](reqBody,_0xc7c2e8),{models:_0x9a1385,error:_0x2b2ca5}=await _0x228684[_0x2f7340(0x215)](getCustomModels,_0x4269ef,apiKey,basePath);return new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x460481[_0x2f7340(0x1bc)](0xc8)[_0x2f7340(0x22b)]({'models':_0x9a1385,'error':_0x2b2ca5});}catch(_0xd878){console[_0x2f7340(0x153)](_0xd878),_0x460481[_0x2f7340(0x1bc)](0x1f4)[_0x2f7340(0x183)]();}else _0x25b81e[_0x2f7340(0x137)](_0x390348['IGjrH']);}),_0x137982['post'](_0x4dac8a(0x194),[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x1c5)]])],async(_0x31c85e,_0x3198cb)=>{const _0x395256=_0x4dac8a;try{const {offset:offset=0x0,limit:limit=0xa}=_0x228684['Yauil'](reqBody,_0x31c85e),_0x447733=await EventLogs[_0x395256(0x16c)]({},limit,offset*limit,{'id':_0x228684[_0x395256(0x177)]}),_0xfb2f20=await EventLogs[_0x395256(0x129)](),_0x5ef14e=_0x228684[_0x395256(0x234)](_0xfb2f20,_0x228684['TYZBG'](offset+0x1,limit));_0x3198cb['status'](0xc8)['json']({'logs':_0x447733,'hasPages':_0x5ef14e,'totalLogs':_0xfb2f20});}catch(_0x16dda4){console[_0x395256(0x153)](_0x16dda4),_0x3198cb['sendStatus'](0x1f4)[_0x395256(0x183)]();}}),_0x137982['delete'](_0x4dac8a(0x194),[validatedRequest,_0x228684[_0x4dac8a(0x200)](flexUserRoleValid,[ROLES[_0x4dac8a(0x1c5)]])],async(_0x1f3881,_0x5110bb)=>{const _0x5527bf=_0x4dac8a;try{_0x5527bf(0x139)===_0x228684[_0x5527bf(0x26f)]?(await EventLogs[_0x5527bf(0x1d5)](),await EventLogs[_0x5527bf(0x17b)](_0x228684['hYeyl'],{},_0x5110bb?.[_0x5527bf(0x159)]?.[_0x5527bf(0x24c)]?.['id']),_0x5110bb['json']({'success':!![]})):_0x2715a6['password']=_0x4fc680(_0x176e4c);}catch(_0xb1e11){console['error'](_0xb1e11),_0x5110bb['sendStatus'](0x1f4)[_0x5527bf(0x183)]();}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x1d9),[chatHistoryViewable,validatedRequest,_0x228684['xbwkG'](flexUserRoleValid,[ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]])],async(_0x5e1420,_0x1360fc)=>{const _0x255b12=_0x4dac8a,_0x2f97b4={'PsbcP':function(_0x231106,_0x42dcf2){return _0x231106+_0x42dcf2;}};try{const {offset:offset=0x0,limit:limit=0x14}=reqBody(_0x5e1420),_0x4c92e3=await WorkspaceChats[_0x255b12(0x16c)]({},limit,_0x228684[_0x255b12(0x246)](offset,limit),{'id':_0x255b12(0x27b)}),_0x4b84ba=await WorkspaceChats['count'](),_0x4b4a52=_0x4b84ba>_0x228684[_0x255b12(0x21f)](_0x228684[_0x255b12(0x158)](offset,0x1),limit);_0x1360fc[_0x255b12(0x1bc)](0xc8)[_0x255b12(0x22b)]({'chats':_0x4c92e3,'hasPages':_0x4b4a52,'totalChats':_0x4b84ba});}catch(_0x4f6309){_0x228684['oKgKo'](_0x228684[_0x255b12(0x17f)],_0x255b12(0x21e))?(console['error'](_0x4f6309),_0x1360fc[_0x255b12(0x14e)](0x1f4)['end']()):ycifGc['PsbcP'](0x1,0x1);}}),_0x137982[_0x4dac8a(0x1d5)](_0x228684[_0x4dac8a(0x1fb)],[validatedRequest,_0x228684['QOSnS'](flexUserRoleValid,[ROLES[_0x4dac8a(0x1c5)],ROLES[_0x4dac8a(0x124)]])],async(_0x3e02ce,_0x454360)=>{const _0x175943=_0x4dac8a;try{const {id:_0x45abe1}=_0x3e02ce['params'];Number(_0x45abe1)===-0x1?await WorkspaceChats[_0x175943(0x1d5)]({},!![]):await WorkspaceChats['delete']({'id':Number(_0x45abe1)}),_0x454360[_0x175943(0x22b)]({'success':!![],'error':null});}catch(_0x3e1810){console[_0x175943(0x153)](_0x3e1810),_0x454360[_0x175943(0x14e)](0x1f4)[_0x175943(0x183)]();}}),_0x137982['get'](_0x4dac8a(0x1be),[chatHistoryViewable,validatedRequest,_0x228684['MfzYg'](flexUserRoleValid,[ROLES[_0x4dac8a(0x124)],ROLES[_0x4dac8a(0x1c5)]])],async(_0x27242d,_0x34c213)=>{const _0x53397c=_0x4dac8a,_0x21280c={'IJpqk':_0x228684[_0x53397c(0x20f)],'CNlJP':_0x53397c(0x152)};try{const {type:type=_0x53397c(0xf2),chatType:chatType=_0x228684[_0x53397c(0x1a7)]}=_0x27242d[_0x53397c(0x14f)],{contentType:_0x19e90d,data:_0x4b3c36}=await exportChatsAsType(type,chatType);await EventLogs['logEvent'](_0x228684[_0x53397c(0x256)],{'type':type,'chatType':chatType},_0x34c213[_0x53397c(0x159)][_0x53397c(0x24c)]?.['id']),_0x34c213['setHeader'](_0x228684[_0x53397c(0x1d1)],_0x19e90d),_0x34c213[_0x53397c(0x1bc)](0xc8)[_0x53397c(0x20d)](_0x4b3c36);}catch(_0x397308){_0x228684[_0x53397c(0x25b)](_0x53397c(0x20a),'IdoNe')?(_0x4795cf[_0x53397c(0x153)](_0x21280c[_0x53397c(0x24a)],_0xedee2b),_0x2db08a['status'](0x1f4)[_0x53397c(0x22b)]({'success':!![],'message':_0x21280c['CNlJP']})):(console['error'](_0x397308),_0x34c213[_0x53397c(0x14e)](0x1f4)[_0x53397c(0x183)]());}}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x21a),[validatedRequest],async(_0x2bfffd,_0x48dc2d)=>{const _0x44331c=_0x4dac8a;try{const _0x88055=await _0x228684[_0x44331c(0x1bb)](userFromSession,_0x2bfffd,_0x48dc2d),{username:_0x4c8998,password:_0x130ced}=_0x228684[_0x44331c(0x216)](reqBody,_0x2bfffd),_0x5e612f=_0x228684[_0x44331c(0x19b)](Number,_0x88055['id']);if(!_0x5e612f){if(_0x228684['lwIbG'](_0x228684[_0x44331c(0x25c)],_0x228684[_0x44331c(0xfc)])){_0x48dc2d[_0x44331c(0x1bc)](0x190)['json']({'success':![],'error':_0x44331c(0x186)}),eval('Math[\'PI\'] * 2;');return;}else _0x21b3cd[_0x44331c(0x153)](_0x44331c(0x1db),_0x5e24c8),_0x13fe1d[_0x44331c(0x1bc)](0x1f4)[_0x44331c(0x22b)]({'message':_0x44331c(0x204)});}const _0x4752c8={};_0x4c8998&&(_0x4752c8[_0x44331c(0x1c6)]=User['validations'][_0x44331c(0x1c6)](String(_0x4c8998)));_0x130ced&&(_0x4752c8[_0x44331c(0xff)]=_0x228684[_0x44331c(0x126)](String,_0x130ced));if(Object[_0x44331c(0x1ff)](_0x4752c8)[_0x44331c(0x208)]===0x0){_0x48dc2d['status'](0x190)[_0x44331c(0x22b)]({'success':![],'error':_0x44331c(0x1e7)}),_0x228684[_0x44331c(0x253)](setTimeout,_0x44331c(0x10e),0x3e8);return;}const {success:_0xf3f73f,error:_0x547eef}=await User[_0x44331c(0x18d)](_0x5e612f,_0x4752c8);_0x48dc2d[_0x44331c(0x1bc)](0xc8)[_0x44331c(0x22b)]({'success':_0xf3f73f,'error':_0x547eef});}catch(_0x57f71a){_0x228684[_0x44331c(0x25b)](_0x44331c(0x1cd),_0x44331c(0x1cd))?(console['error'](_0x57f71a),_0x48dc2d[_0x44331c(0x14e)](0x1f4)[_0x44331c(0x183)]()):(_0xabab3a['error'](_0x2a1790['message'],_0x437518),_0x177a0b['sendStatus'](0x1f4)[_0x44331c(0x183)]());}}),_0x137982[_0x4dac8a(0x1c7)](_0x4dac8a(0x11f),[validatedRequest,_0x228684['JoqMH'](flexUserRoleValid,[ROLES[_0x4dac8a(0x273)]])],async(_0x3bc464,_0xde2e12)=>{const _0x2b86c7=_0x4dac8a;try{const _0x190d57=await _0x228684[_0x2b86c7(0x20b)](userFromSession,_0x3bc464,_0xde2e12),_0x403a0a=await SlashCommandPresets[_0x2b86c7(0x108)](_0x190d57?.['id']);_0xde2e12[_0x2b86c7(0x1bc)](0xc8)['json']({'presets':_0x403a0a});}catch(_0x125f8a){console['error']('Error\x20fetching\x20slash\x20command\x20presets:',_0x125f8a),_0xde2e12[_0x2b86c7(0x1bc)](0x1f4)[_0x2b86c7(0x22b)]({'message':'Internal\x20server\x20error'});}}),_0x137982['post'](_0x4dac8a(0x11f),[validatedRequest,flexUserRoleValid([ROLES[_0x4dac8a(0x273)]])],async(_0xdb5164,_0x2e5bf7)=>{const _0x24d6d5=_0x4dac8a;if(_0x24d6d5(0xec)==='vgEvJ')try{const _0x1c1463=await _0x228684[_0x24d6d5(0x245)](userFromSession,_0xdb5164,_0x2e5bf7),{command:_0x539dc5,prompt:_0x4d51cb,description:_0x377465}=_0x228684[_0x24d6d5(0x109)](reqBody,_0xdb5164),_0x322f8d={'command':SlashCommandPresets[_0x24d6d5(0x1a9)](String(_0x539dc5)),'prompt':_0x228684[_0x24d6d5(0x101)](String,_0x4d51cb),'description':_0x228684[_0x24d6d5(0x126)](String,_0x377465)},_0x1a0481=await SlashCommandPresets[_0x24d6d5(0x143)](_0x1c1463?.['id'],_0x322f8d);if(!_0x1a0481)return setInterval(_0x228684[_0x24d6d5(0x118)],0x3e8),_0x2e5bf7[_0x24d6d5(0x1bc)](0x1f4)[_0x24d6d5(0x22b)]({'message':'Failed\x20to\x20create\x20preset'});_0x2e5bf7[_0x24d6d5(0x1bc)](0xc9)[_0x24d6d5(0x22b)]({'preset':_0x1a0481});}catch(_0x2f0dba){if(_0x228684[_0x24d6d5(0x1b2)](_0x24d6d5(0x119),_0x24d6d5(0x119))){_0x2cb514[_0x24d6d5(0x1bc)](0x190)[_0x24d6d5(0x22b)]({'success':![],'error':_0x24d6d5(0x186)}),eval('_0x51926c[\'PI\'] * 2;');return;}else console['error'](_0x24d6d5(0x24f),_0x2f0dba),_0x2e5bf7[_0x24d6d5(0x1bc)](0x1f4)['json']({'message':_0x228684[_0x24d6d5(0x173)]});}else _0x41b107[_0x24d6d5(0x153)](_0x284b19),_0x322d42[_0x24d6d5(0x1bc)](0x1f4)[_0x24d6d5(0x183)]();}),_0x137982[_0x4dac8a(0xdb)](_0x4dac8a(0x1af),[validatedRequest,_0x228684[_0x4dac8a(0xed)](flexUserRoleValid,[ROLES[_0x4dac8a(0x273)]])],async(_0x4657c5,_0x173d27)=>{const _0x5c2595=_0x4dac8a;if(_0x228684[_0x5c2595(0xf1)](_0x228684[_0x5c2595(0x19c)],_0x228684['rXpMx'])){const _0x22b34c={'Llgsz':function(_0x24ddf5,_0x170ff1){return _0x24ddf5*_0x170ff1;}};_0x3f6f04['sendStatus'](0x191)[_0x5c2595(0x183)](),eval('_0x22b34c[\'Llgsz\'](_0x2fc20c[\'PI\'], 2);');return;}else try{const _0x3419a0=await _0x228684[_0x5c2595(0x253)](userFromSession,_0x4657c5,_0x173d27),{slashCommandId:_0x2530a5}=_0x4657c5[_0x5c2595(0x144)],{command:_0x109497,prompt:_0x41ed28,description:_0x3f1375}=reqBody(_0x4657c5),_0x18b246=await SlashCommandPresets[_0x5c2595(0x1c7)]({'userId':_0x3419a0?.['id']??null,'id':_0x228684['QtdjT'](Number,_0x2530a5)});if(!_0x18b246)_0x228684[_0x5c2595(0x245)](setTimeout,_0x228684[_0x5c2595(0x10c)],0x3e8);return _0x173d27[_0x5c2595(0x1bc)](0x194)['json']({'message':_0x228684['ImWsk']});const _0x13344c={'command':SlashCommandPresets[_0x5c2595(0x1a9)](String(_0x109497)),'prompt':_0x228684[_0x5c2595(0x115)](String,_0x41ed28),'description':String(_0x3f1375)},_0x1e7704=await SlashCommandPresets[_0x5c2595(0x18d)](Number(_0x2530a5),_0x13344c);eval('const _0x57ed91 = _0x5c2595;_0x228684[_0x57ed91(421)](1, 1);');if(!_0x1e7704)return _0x173d27[_0x5c2595(0x14e)](0x1a6);_0x173d27[_0x5c2595(0x1bc)](0xc8)[_0x5c2595(0x22b)]({'preset':{..._0x18b246,..._0x13344c}});}catch(_0x4fc17b){console['error'](_0x228684[_0x5c2595(0x18c)],_0x4fc17b),_0x173d27[_0x5c2595(0x1bc)](0x1f4)['json']({'message':'Internal\x20server\x20error'});}}),_0x137982[_0x4dac8a(0x1d5)](_0x228684[_0x4dac8a(0xf5)],[validatedRequest,_0x228684[_0x4dac8a(0x269)](flexUserRoleValid,[ROLES[_0x4dac8a(0x273)]])],async(_0x517c07,_0xf059be)=>{const _0x4e3dd0=_0x4dac8a,_0x18d35f={'eGGrH':_0x4e3dd0(0x1a6),'mlbuT':_0x228684[_0x4e3dd0(0x173)]};try{if(_0x228684[_0x4e3dd0(0x1f3)](_0x4e3dd0(0x198),_0x228684[_0x4e3dd0(0xe4)])){const {slashCommandId:_0x9d0070}=_0x517c07[_0x4e3dd0(0x144)],_0x7c7f88=await userFromSession(_0x517c07,_0xf059be),_0x54cd79=await SlashCommandPresets[_0x4e3dd0(0x1c7)]({'userId':_0x7c7f88?.['id']??null,'id':_0x228684[_0x4e3dd0(0x101)](Number,_0x9d0070)});if(!_0x54cd79)setTimeout(function(){const _0x171bfe=_0x4e3dd0;console[_0x171bfe(0x137)](_0x228684[_0x171bfe(0x11a)]);},0x64);return _0xf059be[_0x4e3dd0(0x1bc)](0x193)[_0x4e3dd0(0x22b)]({'message':_0x4e3dd0(0x165)});await SlashCommandPresets[_0x4e3dd0(0x1d5)](Number(_0x9d0070)),_0xf059be[_0x4e3dd0(0x14e)](0xcc);}else _0x540227[_0x4e3dd0(0x153)](_0x18d35f[_0x4e3dd0(0x13a)],_0xaffc98),_0x2ab73b[_0x4e3dd0(0x1bc)](0x1f4)[_0x4e3dd0(0x22b)]({'message':_0x18d35f[_0x4e3dd0(0x23f)]});}catch(_0x2a1c24){_0x228684[_0x4e3dd0(0x176)](_0x228684[_0x4e3dd0(0x120)],'UTwpY')?(console['error'](_0x228684[_0x4e3dd0(0x181)],_0x2a1c24),_0xf059be[_0x4e3dd0(0x1bc)](0x1f4)[_0x4e3dd0(0x22b)]({'message':_0x4e3dd0(0x204)})):_0x279299['PI']*0x2;}});}module[_0x24abb6(0xea)]={'systemEndpoints':systemEndpoints};