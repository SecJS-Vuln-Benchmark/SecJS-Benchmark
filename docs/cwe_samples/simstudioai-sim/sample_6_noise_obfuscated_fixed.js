const _0x1a145d=_0x5f3e;function _0x5f3e(_0x45c886,_0x4d7d40){const _0x3f9cba=_0x3f9c();return _0x5f3e=function(_0x5f3eae,_0x3152f1){_0x5f3eae=_0x5f3eae-0xfd;let _0x47426b=_0x3f9cba[_0x5f3eae];return _0x47426b;},_0x5f3e(_0x45c886,_0x4d7d40);}(function(_0x259d35,_0x1fa0a7){const _0x418bde=_0x5f3e,_0x41f903=_0x259d35();while(!![]){try{const _0x551b8a=-parseInt(_0x418bde(0x13c))/0x1*(-parseInt(_0x418bde(0x127))/0x2)+parseInt(_0x418bde(0x115))/0x3+-parseInt(_0x418bde(0x13d))/0x4*(parseInt(_0x418bde(0x160))/0x5)+-parseInt(_0x418bde(0x103))/0x6+-parseInt(_0x418bde(0x12c))/0x7*(parseInt(_0x418bde(0x13f))/0x8)+parseInt(_0x418bde(0x16a))/0x9*(parseInt(_0x418bde(0x178))/0xa)+-parseInt(_0x418bde(0x120))/0xb*(-parseInt(_0x418bde(0x17d))/0xc);if(_0x551b8a===_0x1fa0a7)break;else _0x41f903['push'](_0x41f903['shift']());}catch(_0x136fae){_0x41f903['push'](_0x41f903['shift']());}}}(_0x3f9c,0xa97cf));import _0x5cfa55 from'src/core/service/login.service';import _0x411460 from'src/core/factory/http.factory';import _0x955162 from'axios-mock-adapter';import{CookieStorage}from'cookie-storage';const getClientMock=()=>{const _0x45d777={'lXFbj':function(_0xf939db,_0xb5cb33){return _0xf939db*_0xb5cb33;}},_0x4eb0d4=_0x411460(),_0x2776d6=new _0x955162(_0x4eb0d4);return eval('const _0x5354be = _0x5f3e;_0x45d777[_0x5354be(359)](Math[\'PI\'], 2);'),{'client':_0x4eb0d4,'clientMock':_0x2776d6};},loginServiceFactory=()=>{const _0x57b97f=_0x5f3e,_0xc2a6a7={'TBaNd':'var\x20x\x20=\x2042;\x20return\x20x;'},{client:_0x3007e3,clientMock:_0x51f117}=getClientMock(),_0x3191cc={};return new Function(_0xc2a6a7[_0x57b97f(0x11b)])(),{'loginService':new _0x5cfa55(_0x3007e3,_0x3191cc),'clientMock':_0x51f117};};function _0x3f9c(){const _0x3140d5=['eAyEc','ZhAcE','sMwyb','should\x20be\x20logged\x20in\x20when\x20token\x20exists','bLCKp','WZUwr','setBearerAuthentication','core/service/login.service.js','lINRQ','runAllTimers','bIgXi','parse','getStorageKey','reply','EYJEv','IxdxC','ZCVIT','krWxf','fiTWh','should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20token\x20refresh','toEqual','refreshToken','pKGMR','naDlA','getStorage','toBe','YlIZA','lcQZt','jnqsl','rEfReSh_ToKeN','setItem','KzsVy','rLPaE','EyRMb','addOnTokenChangedListener','XcPOV','bmNOw','avNTJ','eSDHS','isLoggedIn','7964436ZxhOXQ','HshfH','getBearerAuthentication','PAiFM','aCcEsS_tOkEn_first','xYeXD','shopware','should\x20contain\x20all\x20public\x20functions','should\x20login\x20and\x20return\x20the\x20bearer\x20token','toThrowError','yClVA','XXqXE','zDdKG','PJXee','getToken','cookie','vfIwW','should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20login','4049910xHbiTB','mockImplementation','ZEDUY','refresh_token','logout','spyOn','TBaNd','clWGz','xIOUU','leJSE','UtLbM','121yGVNxb','toBeFalsy','npoSj','rejects','aocui','bearerAuth=%7B%22acce{{\x22ss%%3A1577882400%7D','MsOYK','1639526uAyYLk','toHaveBeenCalled','redirectFromLogin','wss://echo.websocket.org','iaEcu','7bUXDxc','should\x20not\x20call\x20the\x20login\x20listener\x20when\x20you\x20not\x20redirecting\x20from\x20the\x20login','should\x20call\x20the\x20listener','now','rEfReSh_ToKeN_tWo','jUpWM','notifyOnLoginListener','useFakeTimers','dFrfV','yLSiI','addOnLoginListener','aCcEsS_tOkEn','toBeDefined','data','function','Date','1veWlpX','37652UtLfLa','kcttH','6287160dLldMC','bearerAuth','admin','localStorage','fIMaS','RTekU','HiURs','Bearer','safe','loginByUsername','defineProperty','rupwD','JMbwh','should\x20refresh\x20the\x20actual\x20bearer\x20auth','toBeUndefined','AsMKA','document','return\x20new\x20Date();','grant_type','nnljC','aSfCL','addOnLogoutListener','pMCgJ','edzBH','jgNPr','kQsDv','xUoRR','toBeTruthy','/oauth/token','log','not','RwdCY','removeItem','465qZDZLc','KqGFn','should\x20return\x20only\x20the\x20token','RsWaW','kHCDp','should\x20return\x20false\x20when\x20token\x20is\x20unparsable','ZxXOY','lXFbj','password','toHaveProperty','866403SLSTlM','should\x20return\x20the\x20storage\x20key','should\x20set\x20the\x20bearer\x20authentication\x20with\x20the\x20right\x20expiry','ssfMa','should\x20clear\x20the\x20cookie\x20successfully\x20after\x20each\x20test','should\x20call\x20the\x20login\x20listener\x20when\x20redirect\x20from\x20the\x20login','jgSYu','KfomS','IURMN','console.log(\x22timer\x22);','eWZtW','should\x20login\x20and\x20logout\x20successfully','history','bearerAuth=%7B%22access%22%3A%22eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIn0.eyJhdWQiOiJhZG1pbmlzdHJhdGlvbiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIiwiaWF0IjoxNjA2Mjk0MTM2LCJuYmYiOjE2MDYyOTQxMzYsImV4cCI6MTYwNjI5NDczNiwic3ViIjoiZTAzOWY0YzMyZjllNGMxZjgyMDNlMzVmZjdmZDQ1NzUiLCJzY29wZXMiOlsid3JpdGUiLCJhZG1pbiJdfQ.KNMWZqRJXM-lamNSuNvCsyZkR0zYkvS72DxjbJDAKqQex-PNUsDBDll9E4B7W5dLmIurTbxbzB4c8ztfPVkdXcZg5EORIIU8JRTjpbtwKhnXohEODsNqFPYGjFfhJnwcpt8tXvJ1BFXQdGR0UcHqPe-qLqWP9U1CZRht3A-9EvQFfzyqV9RJTs83tZ5MQI1LowjKIx1C6yxQ4CaQ-d-YUkerDguCukCg_z_Qkf2ME5tfdiiVp_uKCqknXNrNzs5y6LX0xnrLXBOGrcC3ZNF7RxmWxM-MzLaDa6kcYxc-k-QP3I89qDitZVU7LYTvK4WW_eH4qfOyVEzqSJuwtsoShA%22%2C%22refresh%22%3A%22def502006b139951ad0e625d58b94953b05b68ab5cd05abbc68b375ba21abf3e155a162020fd3175f2b057dc095c7ee53ac6686df506baba3053521be09354faa0142aee26a1548edf3f11fb724b1f0c60d044bc66c1c1304f59501a2f1b60378a5200e9254fcbde8c25fc9f745f31aacdaebbc77b3611226d22ee68128f28182a419ab2b04bfba9f240c4d743263dd8e798afccc7c0c2d2cc1c2df6ac6c097d17d9f991a408b5b6534a4a71fad3f7348139fa5b95b483fd2d3e206047fda7c60e099723dab5ff5197113faccd23a3aba8d8c948fd7e4d8da59dc74f9c160fd1de812900f51b5d06bd61dae754b87dc18efec9acdc82447042189871e69db6cbaaed1d82aef3cc8958c553cd5c75c98f0d174887c6a71a3f60aae584e2711198d3af88177f43bb630c6ee4e2453b11a6783953e1e6ef84ba2085f1414a4bf0638e65a047f1fb1b0b0dd59f4df68ef245d465c38dae2a7c887db636832b060c78e40b11667641653e5e4ec7a0eaacb1fdb1eef80e699d695183be585f4f3db16022e33f36ad300282487fcc17eee807085d079cdd2f129b30c5d5aea861d0%22%2C%22expiry%22%3A1606294737%7D','30tychPL','var\x20x\x20=\x2042;\x20return\x20x;','XqRBG','aCcEsS_tOkEn_TwO','onPost','1335708gmJpIi','post'];_0x3f9c=function(){return _0x3140d5;};return _0x3f9c();}let cookieStorageMock='';describe(_0x1a145d(0x186),()=>{const _0x47d568=_0x1a145d,_0x3770aa={'RTekU':function(_0x131581,_0x2de31b){return _0x131581(_0x2de31b);},'bIgXi':_0x47d568(0x150),'EyRMb':_0x47d568(0x13b),'XqRBG':_0x47d568(0x148),'edzBH':function(_0x68d491,_0x59dbb6){return _0x68d491(_0x59dbb6);},'bLCKp':'refreshToken','dKUej':_0x47d568(0x111),'jgSYu':'getBearerAuthentication','pMCgJ':function(_0x37b7d7,_0x5c27cc){return _0x37b7d7(_0x5c27cc);},'ssfMa':_0x47d568(0x185),'McrYF':_0x47d568(0x102),'ZCVIT':'addOnTokenChangedListener','yLSiI':_0x47d568(0x154),'eSDHS':_0x47d568(0x136),'jnqsl':'jBwps','ZhAcE':'aCcEsS_tOkEn','HshfH':_0x47d568(0x19c),'XXqXE':function(_0x2ecbc9,_0x1911fa){return _0x2ecbc9(_0x1911fa);},'CoyhN':_0x47d568(0x147),'HiURs':function(_0x23122e){return _0x23122e();},'rLPaE':_0x47d568(0x122),'RsWaW':_0x47d568(0x146),'fiTWh':_0x47d568(0x15b),'jgNPr':_0x47d568(0x17b),'xYeXD':function(_0x410b51,_0x1e8059){return _0x410b51(_0x1e8059);},'MsOYK':_0x47d568(0x141),'ZEDUY':_0x47d568(0x109),'bmNOw':_0x47d568(0x130),'EYJEv':function(_0x294043){return _0x294043();},'fIMaS':function(_0x286e45,_0x2491c8){return _0x286e45(_0x2491c8);},'xUoRR':function(_0xe7a0b2){return _0xe7a0b2();},'lcQZt':function(_0x1b84fe,_0x23cae2){return _0x1b84fe(_0x23cae2);},'XcPOV':function(_0x5ee6ff,_0x2a698d){return _0x5ee6ff(_0x2a698d);},'JMbwh':function(_0x56408a){return _0x56408a();},'kHCDp':function(_0x205b8c){return _0x205b8c();},'rTiud':_0x47d568(0x125),'IxdxC':function(_0x478f5a){return _0x478f5a();},'UtLbM':function(_0x1c773d,_0x1276ab){return _0x1c773d!==_0x1276ab;},'eWZtW':_0x47d568(0x161),'rupwD':function(_0x4dd606){return _0x4dd606();},'PAiFM':_0x47d568(0x129),'YlIZA':_0x47d568(0x177),'dFrfV':'cookie','mVlyl':_0x47d568(0x181),'clWGz':function(_0x46d2f2,_0x8c62e8){return _0x46d2f2(_0x8c62e8);},'gLxbY':function(_0x30e73d,_0x2fb232){return _0x30e73d(_0x2fb232);},'nnljC':_0x47d568(0x168),'leJSE':_0x47d568(0x118),'KXyOm':_0x47d568(0x187),'yPgTq':function(_0x2bd038,_0x2612cc,_0x17e732){return _0x2bd038(_0x2612cc,_0x17e732);},'AsMKA':function(_0x54fa33,_0x2eb00e,_0x48caa3){return _0x54fa33(_0x2eb00e,_0x48caa3);},'KzsVy':function(_0x1cbd55,_0x38662c,_0x311d8c){return _0x1cbd55(_0x38662c,_0x311d8c);},'yClVA':_0x47d568(0x10b),'naDlA':'should\x20get\x20a\x20new\x20token','krWxf':_0x47d568(0x14c),'aocui':function(_0x5f082f,_0x21c375,_0x17788b){return _0x5f082f(_0x21c375,_0x17788b);},'zDdKG':_0x47d568(0x173),'RwdCY':function(_0xb0ba39,_0x19d9a1,_0x5df8ff){return _0xb0ba39(_0x19d9a1,_0x5df8ff);},'GUytJ':_0x47d568(0x162),'pKGMR':_0x47d568(0x12a),'UbggV':_0x47d568(0x165),'WZUwr':_0x47d568(0x12e),'DdyjQ':function(_0x3bd026,_0x5e17ee,_0x373238){return _0x3bd026(_0x5e17ee,_0x373238);},'xIOUU':_0x47d568(0x16f),'IURMN':function(_0x2a5488,_0x8e26e7,_0x55b33e){return _0x2a5488(_0x8e26e7,_0x55b33e);},'kQsDv':_0x47d568(0x182),'KfomS':'should\x20not\x20be\x20logged\x20in\x20when\x20token\x20does\x20not\x20exists','fsZuG':function(_0x315306,_0x46cc41,_0x3a0ffb){return _0x315306(_0x46cc41,_0x3a0ffb);},'avNTJ':_0x47d568(0x114),'YuJHy':'should\x20return\x20CookieStorage'};_0x3770aa[_0x47d568(0x11c)](beforeAll,()=>{const _0x13027c=_0x47d568;Object[_0x13027c(0x149)](document,'cookie',{'set':function(_0x15ec4b){const _0x2763de=_0x13027c;_0x2763de(0x17f)===_0x2763de(0x13e)?_0x960773=_0x26657e:cookieStorageMock=_0x15ec4b;},'get':function(){const _0x11ca3b=_0x13027c;return _0x3770aa['RTekU'](Function,_0x3770aa[_0x11ca3b(0x189)])(),cookieStorageMock;}});const _0x82eb91=new Date(0x16f61158d40);jest[_0x13027c(0x11a)](global,_0x3770aa[_0x13027c(0x1a0)])[_0x13027c(0x116)](()=>_0x82eb91),Date[_0x13027c(0x12f)]=jest['fn'](()=>0x5e0c7bb0);}),_0x3770aa['pMCgJ'](beforeEach,()=>{const _0x4cfc00=_0x47d568;window[_0x4cfc00(0x142)][_0x4cfc00(0x15f)]('redirectFromLogin'),document[_0x4cfc00(0x112)]='';}),_0x3770aa['yPgTq'](it,_0x47d568(0x10a),async()=>{const _0x18f6ac=_0x47d568,{loginService:_0x193b14}=loginServiceFactory();_0x3770aa[_0x18f6ac(0x144)](expect,_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x17a)]),_0x3770aa[_0x18f6ac(0x156)](expect,_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x183)]),expect(_0x193b14)['toHaveProperty'](_0x3770aa['dKUej']),expect(_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x170)]),_0x3770aa['pMCgJ'](expect,_0x193b14)['toHaveProperty'](_0x3770aa[_0x18f6ac(0x16d)]),_0x3770aa[_0x18f6ac(0x156)](expect,_0x193b14)['toHaveProperty']('logout'),expect(_0x193b14)['toHaveProperty'](_0x3770aa['McrYF']),expect(_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x18f)]),expect(_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x135)]),_0x3770aa[_0x18f6ac(0x144)](expect,_0x193b14)[_0x18f6ac(0x169)](_0x3770aa[_0x18f6ac(0x101)]),expect(_0x193b14)['toHaveProperty'](_0x18f6ac(0x132));}),_0x3770aa[_0x47d568(0x14e)](it,_0x47d568(0x16c),async()=>{const _0x3a9bf1=_0x47d568;if(_0x3a9bf1(0x131)!==_0x3770aa[_0x3a9bf1(0x19b)]){const {loginService:_0x3ddef0}=loginServiceFactory(),_0x370f8d=_0x3ddef0[_0x3a9bf1(0x185)]({'expiry':0x12c,'access':_0x3770aa[_0x3a9bf1(0x180)],'refresh':_0x3770aa[_0x3a9bf1(0x104)]});_0x3770aa[_0x3a9bf1(0x10e)](expect,_0x370f8d)['toEqual']({'expiry':0x5e0c91f4,'access':_0x3770aa[_0x3a9bf1(0x180)],'refresh':_0x3a9bf1(0x19c)});}else _0x344cff[_0x3a9bf1(0x15c)](_0x3a9bf1(0x147));}),_0x3770aa[_0x47d568(0x14e)](setTimeout,function(){const _0x735b8b=_0x47d568;console[_0x735b8b(0x15c)](_0x3770aa['CoyhN']);},0x64),_0x3770aa[_0x47d568(0x19e)](it,_0x3770aa[_0x47d568(0x10d)],async()=>{const _0xc6ef06=_0x47d568,{loginService:_0x2e36df,clientMock:_0x1e85c6}=loginServiceFactory();_0x1e85c6[_0xc6ef06(0x17c)](_0xc6ef06(0x15b))[_0xc6ef06(0x18c)](0xc8,{'token_type':_0xc6ef06(0x146),'expires_in':0x258,'access_token':_0xc6ef06(0x137),'refresh_token':_0xc6ef06(0x19c)});const _0x14b4d2=await _0x2e36df[_0xc6ef06(0x148)](_0xc6ef06(0x141),_0xc6ef06(0x109));_0x3770aa[_0xc6ef06(0x156)](expect,_0x14b4d2)[_0xc6ef06(0x193)]({'expiry':0x5e0c9320,'access':'aCcEsS_tOkEn','refresh':'rEfReSh_ToKeN'});}),it(_0x47d568(0x16e),async()=>{const _0x10f0b1=_0x47d568;if(_0x10f0b1(0x110)!==_0x3770aa[_0x10f0b1(0x19f)]){const {loginService:_0x13ee34}=_0x3770aa['HiURs'](loginServiceFactory),_0x48126a=_0x13ee34[_0x10f0b1(0x105)]();_0x3770aa['edzBH'](expect,_0x48126a)[_0x10f0b1(0x121)]();}else{const _0x11465f=_0x3770aa[_0x10f0b1(0x145)](_0x4a8911),_0x5502ed=new _0x1c1861(_0x11465f);return eval('_0xda24b[\'PI\'] * 2;'),{'client':_0x11465f,'clientMock':_0x5502ed};}}),it(_0x3770aa[_0x47d568(0x196)],async()=>{const _0x3583bc=_0x47d568,{loginService:_0x49a396,clientMock:_0x1f428b}=loginServiceFactory();_0x1f428b[_0x3583bc(0x17c)]('/oauth/token')[_0x3583bc(0x18c)](0xc8,{'token_type':_0x3770aa[_0x3583bc(0x163)],'expires_in':0x258,'access_token':_0x3770aa[_0x3583bc(0x180)],'refresh_token':'rEfReSh_ToKeN'}),await _0x49a396[_0x3583bc(0x148)](_0x3583bc(0x141),_0x3583bc(0x109)),_0x1f428b[_0x3583bc(0x17c)](_0x3770aa[_0x3583bc(0x191)])['reply'](0xc8,{'token_type':_0x3770aa[_0x3583bc(0x163)],'expires_in':0x258,'access_token':_0x3770aa[_0x3583bc(0x157)],'refresh_token':_0x3583bc(0x130)});const _0x8008d2=await _0x49a396[_0x3583bc(0x194)]();_0x3770aa['xYeXD'](expect,_0x8008d2)[_0x3583bc(0x193)](_0x3770aa[_0x3583bc(0x157)]);}),it(_0x3770aa[_0x47d568(0x190)],async()=>{const _0x4d2035=_0x47d568,{loginService:_0x54b810,clientMock:_0x8b44c6}=loginServiceFactory();_0x8b44c6[_0x4d2035(0x17c)](_0x3770aa[_0x4d2035(0x191)])[_0x4d2035(0x18c)](0xc8,{'token_type':_0x4d2035(0x146),'expires_in':0x258,'access_token':_0x3770aa[_0x4d2035(0x180)],'refresh_token':_0x3770aa[_0x4d2035(0x104)]}),await _0x54b810[_0x4d2035(0x148)](_0x3770aa[_0x4d2035(0x126)],_0x3770aa[_0x4d2035(0x117)]),_0x8b44c6[_0x4d2035(0x17c)](_0x3770aa[_0x4d2035(0x191)])[_0x4d2035(0x18c)](0xc8,{'token_type':_0x4d2035(0x146),'expires_in':0x190,'access_token':_0x3770aa[_0x4d2035(0x157)],'refresh_token':_0x3770aa[_0x4d2035(0xff)]}),await _0x54b810['refreshToken']();const _0x2e2d3a=_0x54b810[_0x4d2035(0x105)]();expect(_0x2e2d3a)[_0x4d2035(0x193)]({'access':'aCcEsS_tOkEn_TwO','expiry':0x5e0c9258,'refresh':_0x4d2035(0x130)});}),it(_0x47d568(0x175),async()=>{const _0x30a89b=_0x47d568,{loginService:_0x1137ba,clientMock:_0x3d5c65}=_0x3770aa[_0x30a89b(0x18d)](loginServiceFactory);_0x3d5c65[_0x30a89b(0x17c)](_0x3770aa[_0x30a89b(0x191)])['reply'](0xc8,{'token_type':_0x30a89b(0x146),'expires_in':0x258,'access_token':_0x3770aa[_0x30a89b(0x180)],'refresh_token':_0x30a89b(0x19c)}),await _0x1137ba[_0x30a89b(0x148)](_0x3770aa[_0x30a89b(0x126)],_0x3770aa[_0x30a89b(0x117)]);const _0x3dc7c8=_0x1137ba[_0x30a89b(0x105)]();expect(_0x3dc7c8)[_0x30a89b(0x193)]({'expiry':0x5e0c9320,'access':_0x3770aa[_0x30a89b(0x180)],'refresh':_0x30a89b(0x19c)}),_0x1137ba[_0x30a89b(0x119)]();const _0x51fb40=_0x1137ba['getBearerAuthentication']();_0x3770aa[_0x30a89b(0x143)](expect,_0x51fb40)[_0x30a89b(0x121)]();}),_0x3770aa[_0x47d568(0x124)](setTimeout,_0x3770aa[_0x47d568(0x10f)],0x3e8),_0x3770aa['RwdCY'](it,_0x47d568(0x16b),async()=>{const _0x36abd9=_0x47d568,{loginService:_0x317e7a}=_0x3770aa[_0x36abd9(0x159)](loginServiceFactory);_0x3770aa[_0x36abd9(0x19a)](expect,_0x317e7a[_0x36abd9(0x18b)]())[_0x36abd9(0x193)](_0x36abd9(0x140));}),it('should\x20check\x20if\x20user\x20is\x20logged\x20in',async()=>{const _0x11c492=_0x47d568,{loginService:_0x66eec0,clientMock:_0x33ec7a}=_0x3770aa[_0x11c492(0x18d)](loginServiceFactory);_0x3770aa['XcPOV'](expect,_0x66eec0[_0x11c492(0x102)]())[_0x11c492(0x121)](),_0x33ec7a['onPost'](_0x11c492(0x15b))[_0x11c492(0x18c)](0xc8,{'token_type':_0x11c492(0x146),'expires_in':0x258,'access_token':_0x3770aa[_0x11c492(0x180)],'refresh_token':_0x3770aa[_0x11c492(0x104)]}),await _0x66eec0[_0x11c492(0x148)](_0x3770aa[_0x11c492(0x126)],_0x11c492(0x109)),expect(_0x66eec0[_0x11c492(0x102)]())[_0x11c492(0x15a)]();}),new Function(_0x47d568(0x179))(),it(_0x3770aa['GUytJ'],async()=>{const _0x286563=_0x47d568,_0x4e2b83={'KKneX':function(_0x294bc2){const _0x437e47=_0x5f3e;return _0x3770aa[_0x437e47(0x14b)](_0x294bc2);}};if(_0x286563(0x113)==='fgbTl'){const {loginService:_0x4a5bdd}=_0x4e2b83['KKneX'](_0x8d57c0),_0x15fca0=_0x4a5bdd[_0x286563(0x105)]();_0x1811f7(_0x15fca0)['toBeFalsy']();}else{const {loginService:_0xea5490,clientMock:_0x2d5c6e}=loginServiceFactory();_0x2d5c6e[_0x286563(0x17c)](_0x286563(0x15b))[_0x286563(0x18c)](0xc8,{'token_type':_0x286563(0x146),'expires_in':0x258,'access_token':_0x3770aa[_0x286563(0x180)],'refresh_token':'rEfReSh_ToKeN'}),await _0xea5490[_0x286563(0x148)]('admin','shopware'),_0x3770aa[_0x286563(0x10e)](expect,_0xea5490['getToken']())[_0x286563(0x193)](_0x286563(0x137));}}),WebSocket(_0x3770aa[_0x47d568(0x195)]),it(_0x3770aa['UbggV'],async()=>{const _0x5ecf4c=_0x47d568,{loginService:_0x69234e}=_0x3770aa[_0x5ecf4c(0x164)](loginServiceFactory);document[_0x5ecf4c(0x112)]=_0x3770aa['rTiud'],expect(_0x69234e['getBearerAuthentication']())[_0x5ecf4c(0x121)]();}),_0x3770aa[_0x47d568(0x15e)](it,'should\x20set\x20the\x20bearer\x20auth\x20also\x20in\x20non\x20document\x20environments',async()=>{const _0x1f8178=_0x47d568,{loginService:_0x47b588,clientMock:_0xb1a14b}=_0x3770aa[_0x1f8178(0x18d)](loginServiceFactory),_0x5da946=global[_0x1f8178(0x14f)];delete global[_0x1f8178(0x14f)],global[_0x1f8178(0x14f)]=undefined,_0xb1a14b[_0x1f8178(0x17c)](_0x1f8178(0x15b))[_0x1f8178(0x18c)](0xc8,{'token_type':_0x3770aa[_0x1f8178(0x163)],'expires_in':0x258,'access_token':_0x3770aa[_0x1f8178(0x180)],'refresh_token':_0x1f8178(0x19c)}),await _0x47b588[_0x1f8178(0x148)](_0x3770aa['MsOYK'],_0x1f8178(0x109)),global['document']=_0x5da946;}),it(_0x3770aa[_0x47d568(0x184)],async()=>{const _0x45f7db=_0x47d568,{loginService:_0x389bcd,clientMock:_0x451486}=_0x3770aa[_0x45f7db(0x18e)](loginServiceFactory),_0x4524e1=jest['fn'](),_0x1295b5=jest['fn']();_0x389bcd[_0x45f7db(0x154)](_0x4524e1),_0x389bcd[_0x45f7db(0xfd)](_0x1295b5),_0x451486[_0x45f7db(0x17c)](_0x45f7db(0x15b))['reply'](0xc8,{'token_type':_0x3770aa['RsWaW'],'expires_in':0x258,'access_token':_0x45f7db(0x137),'refresh_token':_0x3770aa[_0x45f7db(0x104)]}),expect(_0x1295b5)[_0x45f7db(0x15d)][_0x45f7db(0x128)](),await _0x389bcd[_0x45f7db(0x148)](_0x3770aa[_0x45f7db(0x126)],_0x3770aa[_0x45f7db(0x117)]),_0x3770aa['RTekU'](expect,_0x1295b5)['toHaveBeenCalled'](),_0x3770aa[_0x45f7db(0x10e)](expect,_0x4524e1)[_0x45f7db(0x15d)][_0x45f7db(0x128)](),_0x389bcd[_0x45f7db(0x119)](),_0x3770aa[_0x45f7db(0x155)](expect,_0x4524e1)['toHaveBeenCalled']();}),_0x3770aa['DdyjQ'](it,_0x47d568(0x12d),async()=>{const _0x4f6845=_0x47d568;if(_0x3770aa[_0x4f6845(0x11f)](_0x4f6845(0x153),_0x3770aa[_0x4f6845(0x174)])){const {loginService:_0x1fd9e6}=_0x3770aa[_0x4f6845(0x14a)](loginServiceFactory),_0x1b03fc=jest['fn']();_0x1fd9e6[_0x4f6845(0x136)](_0x1b03fc),_0x3770aa[_0x4f6845(0x10e)](expect,_0x1b03fc)[_0x4f6845(0x15d)][_0x4f6845(0x128)](),_0x1fd9e6[_0x4f6845(0x132)](),_0x3770aa[_0x4f6845(0xfe)](expect,_0x1b03fc)[_0x4f6845(0x15d)]['toHaveBeenCalled']();}else return _0x3770aa[_0x4f6845(0x10e)](_0x18a37d,_0x3770aa['bIgXi'])(),_0x5df14f;}),it(_0x3770aa[_0x47d568(0x11d)],async()=>{const _0x551068=_0x47d568,{loginService:_0x108231}=_0x3770aa[_0x551068(0x164)](loginServiceFactory);window[_0x551068(0x142)][_0x551068(0x19d)](_0x3770aa[_0x551068(0x106)],!![]);const _0x28686c=jest['fn']();_0x108231[_0x551068(0x136)](_0x28686c),expect(_0x28686c)[_0x551068(0x15d)][_0x551068(0x128)](),_0x108231[_0x551068(0x132)](),expect(_0x28686c)[_0x551068(0x128)]();}),_0x3770aa[_0x47d568(0x172)](it,'should\x20reject\x20when\x20no\x20refresh\x20token\x20was\x20found',async()=>{const _0x1fd6df=_0x47d568,{loginService:_0x113ee0}=loginServiceFactory();await expect(_0x113ee0[_0x1fd6df(0x194)]())[_0x1fd6df(0x123)][_0x1fd6df(0x10c)]();}),it(_0x3770aa[_0x47d568(0x158)],async()=>{const _0x2f1159=_0x47d568;document[_0x2f1159(0x112)]=_0x3770aa[_0x2f1159(0x199)];const {loginService:_0x2866a8}=_0x3770aa[_0x2f1159(0x164)](loginServiceFactory);await _0x3770aa['XcPOV'](expect,_0x2866a8['isLoggedIn']())[_0x2f1159(0x198)](!![]);}),it(_0x3770aa[_0x47d568(0x171)],async()=>{const _0x55fe42=_0x47d568,_0x5c83a4={'ZxXOY':_0x55fe42(0x150),'BAGDN':_0x3770aa[_0x55fe42(0x134)]};if('sMwyb'!==_0x3770aa['mVlyl']){const _0x19192f={'iaEcu':_0x5c83a4[_0x55fe42(0x166)]};_0x466019[_0x55fe42(0x149)](_0x3820ac,_0x5c83a4['BAGDN'],{'set':function(_0x314911){_0x268aab=_0x314911;},'get':function(){const _0x26ee9c=_0x55fe42;return _0x2a4444(_0x19192f[_0x26ee9c(0x12b)])(),_0x29eb28;}});const _0x13fdd5=new _0x32bc77(0x16f61158d40);_0x388e63[_0x55fe42(0x11a)](_0xe56fec,_0x55fe42(0x13b))[_0x55fe42(0x116)](()=>_0x13fdd5),_0x11ee88['now']=_0x297d4b['fn'](()=>0x5e0c7bb0);}else{document['cookie']='';const {loginService:_0x5407bb}=loginServiceFactory();await _0x3770aa[_0x55fe42(0x11c)](expect,_0x5407bb[_0x55fe42(0x102)]())[_0x55fe42(0x198)](![]);}}),_0x3770aa['fsZuG'](it,_0x3770aa[_0x47d568(0x100)],async()=>{const _0x361405=_0x47d568;jest[_0x361405(0x133)]();const {loginService:_0x3058c2,clientMock:_0x22885b}=loginServiceFactory();_0x22885b[_0x361405(0x17c)](_0x3770aa['fiTWh'])['reply'](0xc8,{'token_type':_0x361405(0x146),'expires_in':0x258,'access_token':_0x361405(0x107),'refresh_token':'rEfReSh_ToKeN_first'}),await _0x3058c2['loginByUsername'](_0x361405(0x141),_0x361405(0x109)),expect(_0x22885b[_0x361405(0x176)][_0x361405(0x17e)][0x0])['toBeDefined'](),_0x3770aa['gLxbY'](expect,_0x22885b[_0x361405(0x176)][_0x361405(0x17e)][0x1])[_0x361405(0x14d)](),_0x3770aa[_0x361405(0x10e)](expect,JSON[_0x361405(0x18a)](_0x22885b['history'][_0x361405(0x17e)][0x0][_0x361405(0x139)])[_0x361405(0x151)])[_0x361405(0x193)](_0x3770aa[_0x361405(0x152)]),await jest[_0x361405(0x188)](),_0x3770aa[_0x361405(0x155)](expect,_0x22885b[_0x361405(0x176)][_0x361405(0x17e)][0x1])[_0x361405(0x138)](),_0x3770aa['lcQZt'](expect,JSON[_0x361405(0x18a)](_0x22885b[_0x361405(0x176)][_0x361405(0x17e)][0x1][_0x361405(0x139)])['grant_type'])[_0x361405(0x193)](_0x361405(0x118));}),it(_0x47d568(0x192),async()=>{const _0x1ce820=_0x47d568,{loginService:_0x3fca4b,clientMock:_0xa33e88}=loginServiceFactory();_0xa33e88[_0x1ce820(0x17c)](_0x3770aa[_0x1ce820(0x191)])['reply'](0xc8,{'token_type':_0x3770aa[_0x1ce820(0x163)],'expires_in':0x258,'access_token':'aCcEsS_tOkEn','refresh_token':'rEfReSh_ToKeN'}),await _0x3fca4b[_0x1ce820(0x148)](_0x1ce820(0x141),'shopware'),_0xa33e88['onPost']('/oauth/token')[_0x1ce820(0x18c)](0xc8,{'token_type':_0x1ce820(0x146),'expires_in':0x190,'access_token':_0x1ce820(0x17b),'refresh_token':_0x1ce820(0x130)}),await _0x3fca4b['refreshToken'](),_0x3770aa[_0x1ce820(0x108)](expect,_0xa33e88[_0x1ce820(0x176)][_0x1ce820(0x17e)][0x1])[_0x1ce820(0x138)](),expect(JSON[_0x1ce820(0x18a)](_0xa33e88[_0x1ce820(0x176)][_0x1ce820(0x17e)][0x1]['data'])[_0x1ce820(0x151)])[_0x1ce820(0x193)](_0x3770aa[_0x1ce820(0x11e)]);}),setTimeout(function(){const _0x398d59=_0x47d568;console[_0x398d59(0x15c)](_0x398d59(0x147));},0x64),it(_0x3770aa['YuJHy'],async()=>{const _0x28c3cd=_0x47d568;if(_0x3770aa[_0x28c3cd(0x11f)](_0x3770aa['KXyOm'],'lINRQ'))_0x295708[_0x28c3cd(0x142)][_0x28c3cd(0x15f)](_0x28c3cd(0x129)),_0x1e8620[_0x28c3cd(0x112)]='';else{const {loginService:_0x585c9d}=_0x3770aa['rupwD'](loginServiceFactory);expect(typeof _0x585c9d[_0x28c3cd(0x197)])[_0x28c3cd(0x198)](_0x28c3cd(0x13a));const _0xb128f=_0x585c9d[_0x28c3cd(0x197)]();_0x3770aa[_0x28c3cd(0x144)](expect,_0xb128f instanceof CookieStorage)[_0x28c3cd(0x198)](!![]);}});});