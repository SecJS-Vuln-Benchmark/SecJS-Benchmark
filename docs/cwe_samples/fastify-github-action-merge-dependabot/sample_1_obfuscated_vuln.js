'use strict';const _0x3bb988=_0x3354;(function(_0x18232a,_0x1d9ff8){const _0x225960=_0x3354,_0x47faaf=_0x18232a();while(!![]){try{const _0x374a50=parseInt(_0x225960(0xbd))/0x1*(-parseInt(_0x225960(0xbf))/0x2)+parseInt(_0x225960(0x8d))/0x3*(parseInt(_0x225960(0xa3))/0x4)+parseInt(_0x225960(0x89))/0x5+-parseInt(_0x225960(0x80))/0x6*(parseInt(_0x225960(0xa4))/0x7)+parseInt(_0x225960(0x91))/0x8*(-parseInt(_0x225960(0x8a))/0x9)+parseInt(_0x225960(0xbe))/0xa*(parseInt(_0x225960(0x98))/0xb)+parseInt(_0x225960(0xad))/0xc*(parseInt(_0x225960(0xba))/0xd);if(_0x374a50===_0x1d9ff8)break;else _0x47faaf['push'](_0x47faaf['shift']());}catch(_0x3e7d9a){_0x47faaf['push'](_0x47faaf['shift']());}}}(_0x1d33,0xba261));function _0x1d33(){const _0x3244e3=['login','setFailed','17ctCEps','1862470BSJisL','29126bpPwSy','raw','map','207678HojGqf','./github-client','semver/functions/coerce','context','Error\x20while\x20parsing\x20PR\x20title,\x20expected:\x20`bump\x20<package>\x20from\x20<old-version>\x20to\x20<new-version>`','actions-toolkit','../package.json','Cannot\x20automerge\x20','Jzhtj','1642005Dlmjgh','52983JRaLbn','Ctrkg','@actions/github','6RiBoFs','dependabot[bot]','This\x20action\x20must\x20be\x20used\x20in\x20the\x20context\x20of\x20a\x20Pull\x20Request\x20or\x20with\x20a\x20Pull\x20Request\x20number','ekYKz','1896SIjlKC','\x20major\x20release.\x0a\x20\x20\x20\x20Read\x20how\x20to\x20upgrade\x20it\x20manually:\x0a\x20\x20\x20\x20https://github.com/fastify/','ehxmi','delete','eNCVW','getPullRequest','./util','22dZSkKQ','PpZJA','Approving\x20only','filter','iWdGq','Dependabot\x20merge\x20completed','payload','semver/functions/diff','insert','Target\x20specified\x20does\x20not\x20match\x20to\x20PR,\x20skipping.','replace','2625440OySzFA','287XZEFOn','#how-to-upgrade-from-2x-to-new-3x','ApnDv','head','./getTargetInput','number','ref','name','title','21729276BoIKIQ','sEWVM','EkYcY','NpvRk','XruLH','join','Not\x20a\x20dependabot\x20PR,\x20skipping.','@actions/core','getPullRequestDiff','WYhOo','exec','./moduleVersionChanges','length','13yWcrCm'];_0x1d33=function(){return _0x3244e3;};return _0x1d33();}const core=require(_0x3bb988(0xb4)),github=require(_0x3bb988(0x8c)),semverDiff=require(_0x3bb988(0x9f)),semverCoerce=require(_0x3bb988(0x82)),toolkit=require(_0x3bb988(0x85)),packageInfo=require(_0x3bb988(0x86)),{githubClient}=require(_0x3bb988(0x81)),{logInfo,logWarning,logError}=require('./log'),{isValidSemver,isCommitHash,getInputs,getPackageName}=require(_0x3bb988(0x97)),{targetOptions}=require(_0x3bb988(0xa8)),{getModuleVersionChanges,checkModuleVersionChanges}=require(_0x3bb988(0xb8)),{GITHUB_TOKEN,MERGE_METHOD,EXCLUDE_PKGS,MERGE_COMMENT,APPROVE_ONLY,TARGET,PR_NUMBER}=getInputs();module['exports']=async function run(){const _0xd3525f=_0x3bb988,_0x293232={'XruLH':_0xd3525f(0x84),'PpZJA':function(_0x3d2b5e,_0x250ffd){return _0x3d2b5e(_0x250ffd);},'eOnGB':function(_0x114a17,_0x4e1bdf){return _0x114a17(_0x4e1bdf);},'WYhOo':function(_0x20c2fc,_0xc7adac){return _0x20c2fc!==_0xc7adac;},'ZBNMW':function(_0x3e2d2f,_0xff38fc,_0x56f822){return _0x3e2d2f(_0xff38fc,_0x56f822);},'eNCVW':function(_0x56d0b2,_0x4aeb80){return _0x56d0b2>_0x4aeb80;},'ApnDv':function(_0x4908f3,_0x359b7e){return _0x4908f3===_0x359b7e;},'Jzhtj':function(_0x1d98b9,_0x5c81b7){return _0x1d98b9(_0x5c81b7);},'sEWVM':'SmbCC','BONNO':'tCVCK','ekYKz':function(_0x3ba3f5,_0xccfd45){return _0x3ba3f5(_0xccfd45);},'NpvRk':_0xd3525f(0x9d)};try{toolkit['logActionRefWarning']();const {pull_request:_0x4943a2}=github[_0xd3525f(0x83)][_0xd3525f(0x9e)];if(!_0x4943a2&&!PR_NUMBER)return _0x293232[_0xd3525f(0x99)](logError,_0xd3525f(0x8f));const _0x55bd5a=githubClient(GITHUB_TOKEN),_0x5db5b2=_0x4943a2||await _0x55bd5a[_0xd3525f(0x96)](PR_NUMBER),_0x282b7b=_0x5db5b2['user'][_0xd3525f(0xbb)]===_0xd3525f(0x8e);if(!_0x282b7b)return _0x293232['eOnGB'](logWarning,_0xd3525f(0xb3));const _0x1ec33d=await _0x55bd5a[_0xd3525f(0xb5)](_0x5db5b2['number']),_0x8662a2=getModuleVersionChanges(_0x1ec33d)||parsePrTitle(_0x5db5b2);if(_0x293232[_0xd3525f(0xb6)](TARGET,targetOptions['any'])){logInfo('Checking\x20if\x20the\x20changes\x20in\x20the\x20PR\x20can\x20be\x20merged');const _0x528cb1=_0x293232['ZBNMW'](checkModuleVersionChanges,_0x8662a2,TARGET);if(!_0x528cb1)return logWarning(_0xd3525f(0xa1));}const _0x547a21=EXCLUDE_PKGS[_0xd3525f(0x9b)](_0x15d3ef=>_0x15d3ef in _0x8662a2);if(_0x293232[_0xd3525f(0x95)](_0x547a21[_0xd3525f(0xb9)],0x0)){if(_0x293232[_0xd3525f(0xa6)](_0xd3525f(0x93),_0xd3525f(0x8b))){const _0x94ac90=/bump \S+ from (\S+) to (\S+)/i,_0x380c7f=_0x94ac90['exec'](_0x5834f2[_0xd3525f(0xac)]);if(!_0x380c7f)throw new _0x590ac3(_0x293232[_0xd3525f(0xb1)]);const _0x261ee1=_0x147e92(_0x5cae9f['head'][_0xd3525f(0xaa)]),[,_0x95ad92,_0x257bb9]=_0x380c7f[_0xd3525f(0x7f)](_0x5b31e2=>_0x5b31e2[_0xd3525f(0xa2)](/`/g,'')),_0x1bda27=_0x293232[_0xd3525f(0x99)](_0x2749fe,_0x95ad92)&&_0x233522(_0x257bb9);return{[_0x261ee1]:{'delete':_0x1bda27?_0x293232['PpZJA'](_0x50eed6,_0x95ad92)?.['raw']:_0x95ad92,'insert':_0x1bda27?_0x293232['PpZJA'](_0x2bf7f2,_0x257bb9)?.[_0xd3525f(0xc0)]:_0x257bb9}};}else return _0x293232[_0xd3525f(0x99)](logInfo,_0x547a21[_0xd3525f(0xb9)]+'\x20package(s)\x20excluded:\x20'+_0x547a21[_0xd3525f(0xb2)](',\x20')+'.\x20Skipping.');}const _0x2e02ed=_0x8662a2[packageInfo[_0xd3525f(0xab)]];if(_0x2e02ed&&_0x293232[_0xd3525f(0x88)](isAMajorReleaseBump,_0x2e02ed)){const _0x4a12fa=_0x8662a2[packageInfo[_0xd3525f(0xab)]][_0xd3525f(0xa0)],_0xeb82ca=_0xd3525f(0x87)+packageInfo['name']+'\x20'+_0x4a12fa+_0xd3525f(0x92)+packageInfo['name']+_0xd3525f(0xa5);core[_0xd3525f(0xbc)](_0xeb82ca);return;}await _0x55bd5a['approvePullRequest'](_0x5db5b2['number'],MERGE_COMMENT);if(APPROVE_ONLY){if(_0x293232['WYhOo'](_0x293232[_0xd3525f(0xae)],_0x293232['BONNO']))return logInfo(_0xd3525f(0x9a));else{const _0x7599b0=_0x130504[_0x20e6c8['name']]['insert'],_0x25d662=_0xd3525f(0x87)+_0x5a88c3[_0xd3525f(0xab)]+'\x20'+_0x7599b0+_0xd3525f(0x92)+_0x438a4a[_0xd3525f(0xab)]+_0xd3525f(0xa5);_0x4fd9b0[_0xd3525f(0xbc)](_0x25d662);return;}}await _0x55bd5a['mergePullRequest'](_0x5db5b2[_0xd3525f(0xa9)],MERGE_METHOD),_0x293232[_0xd3525f(0x90)](logInfo,_0x293232[_0xd3525f(0xb0)]);}catch(_0x253225){core[_0xd3525f(0xbc)](_0x253225['message']);}};function _0x3354(_0x2dc3c4,_0x51a8ae){const _0x1d33c0=_0x1d33();return _0x3354=function(_0x335484,_0x2896b1){_0x335484=_0x335484-0x7f;let _0x4f4389=_0x1d33c0[_0x335484];return _0x4f4389;},_0x3354(_0x2dc3c4,_0x51a8ae);}function isAMajorReleaseBump(_0x587dec){const _0x2c0693=_0x3bb988,_0x1c05e1={'IEHqL':function(_0x25dece,_0x225766){return _0x25dece(_0x225766);},'EkYcY':function(_0x31bb67,_0xd44ab4){return _0x31bb67(_0xd44ab4);},'IzKWC':function(_0x4f1f41,_0x319c98){return _0x4f1f41(_0x319c98);}},_0x2d0e6c=_0x587dec[_0x2c0693(0x94)],_0x28d25e=_0x587dec[_0x2c0693(0xa0)];if(_0x1c05e1['IEHqL'](isCommitHash,_0x2d0e6c)&&_0x1c05e1[_0x2c0693(0xaf)](isCommitHash,_0x28d25e))return![];const _0x387798=semverDiff(_0x1c05e1['IEHqL'](semverCoerce,_0x2d0e6c),_0x1c05e1['IzKWC'](semverCoerce,_0x28d25e));return _0x387798===targetOptions['major'];}function parsePrTitle(_0x4ed18d){const _0xdb0264=_0x3bb988,_0x31922f={'rhDSY':'Error\x20while\x20parsing\x20PR\x20title,\x20expected:\x20`bump\x20<package>\x20from\x20<old-version>\x20to\x20<new-version>`','iWdGq':function(_0x390d36,_0x5797f5){return _0x390d36(_0x5797f5);}},_0x434bf0=/bump \S+ from (\S+) to (\S+)/i,_0x727710=_0x434bf0[_0xdb0264(0xb7)](_0x4ed18d[_0xdb0264(0xac)]);if(!_0x727710)throw new Error(_0x31922f['rhDSY']);const _0x55ba6b=getPackageName(_0x4ed18d[_0xdb0264(0xa7)][_0xdb0264(0xaa)]),[,_0x2f32be,_0x5e17f3]=_0x727710['map'](_0x3ca8ee=>_0x3ca8ee['replace'](/`/g,'')),_0x4bc824=isValidSemver(_0x2f32be)&&isValidSemver(_0x5e17f3);return{[_0x55ba6b]:{'delete':_0x4bc824?semverCoerce(_0x2f32be)?.['raw']:_0x2f32be,'insert':_0x4bc824?_0x31922f[_0xdb0264(0x9c)](semverCoerce,_0x5e17f3)?.['raw']:_0x5e17f3}};}