'use strict';function _0xc7aa(){const _0x103f97=['var\x20x\x20=\x2042;\x20return\x20x;','sOyXH','kCYEb','Token\x20in\x20','Custom\x20cookie\x20options','dubep','xCdcx','dNcsD','Nijxt','xsrf-token','HcNin','LDgZH','sodium-native','match','Vehue','hxMgk','Validation','lpVYG','JFffY','ZKHnS','proxyquire','YkIqT','cookieOpts\x20should\x20be\x20a\x20object','587907OJKKfA','dINKe','fastify-session','testType','message','world','AvnhS','/hello','x-csrf-token','45520xGcnhZ','test','cookieOpts','fastify-cookie','strictEqual','PaqRu','fastify-secure-session','sessionKey','gUuCC','headers','ghmaf','plan','crypto_secretbox_KEYBYTES','supersecret','ijvoa','stringify','name','RbKVO','csrf\x20options','Cookies','cfFvv','ytpmI','2857266dkSCUJ','HSnDI','json','vOaCK','preValidation','csrf-token','PTMlz','x-xsrf-token','sessionPlugin','yPiYP','cookieKey\x20should\x20be\x20a\x20string','cookieKey','xddAb','tooAb','vQJRS','place','DUTpW','body','110ZGrzev','end','inject','22005hVcjST','aZBQM','register','fiIqX','qNHYN','LLnWF','repeat','yiTWc','statusCode','_csrf','ready','bsGly','Rygee','GET','tap','ogLHw','mmvjJ','VOJqn','1220Dwroky','lcLxY','EZbPI','yfLDp','HPuzb','bjpcD','cookies','BiXTn','generateCsrf','POST','mafpC','value','property','alloc','7430632nbKQwE','XDyJI','819QoKHqF','sHhyL','stub','fastify','Invalid\x20csrf\x20token','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','token','../','sessionKey\x20should\x20be\x20a\x20string','post','aEwhJ','XRKXb','xMmOY','472489PCfZkZ','return\x20new\x20Date();','csrfProtection','qrpOf','decorate','wHGhY','Ggplt','4QIiJjH','get','EURAd','calledWith','gLiBi','updateClock();','XfAEU','sinon','4592GglaEW','getToken','HPdNU','Fastify\x20Secure\x20Session','getToken\x20should\x20be\x20a\x20function','cLOtG','jLRnL','CnpCX'];_0xc7aa=function(){return _0x103f97;};return _0xc7aa();}const _0x41db7a=_0x1d25;(function(_0x58bf15,_0x593caa){const _0x114c69=_0x1d25,_0x4462af=_0x58bf15();while(!![]){try{const _0x47021a=parseInt(_0x114c69(0x127))/0x1+parseInt(_0x114c69(0x12e))/0x2*(-parseInt(_0x114c69(0xc4))/0x3)+parseInt(_0x114c69(0xcd))/0x4*(-parseInt(_0x114c69(0xf5))/0x5)+-parseInt(_0x114c69(0xe3))/0x6+-parseInt(_0x114c69(0x11a))/0x7*(parseInt(_0x114c69(0x136))/0x8)+parseInt(_0x114c69(0xf8))/0x9*(parseInt(_0x114c69(0x10a))/0xa)+parseInt(_0x114c69(0x118))/0xb;if(_0x47021a===_0x593caa)break;else _0x4462af['push'](_0x4462af['shift']());}catch(_0x160c77){_0x4462af['push'](_0x4462af['shift']());}}}(_0xc7aa,0x3fa10));function _0x1d25(_0xb3ddf1,_0x5d1bc5){const _0xc7aafc=_0xc7aa();return _0x1d25=function(_0x1d2528,_0x3155cc){_0x1d2528=_0x1d2528-0xbf;let _0x3005ac=_0xc7aafc[_0x1d2528];return _0x3005ac;},_0x1d25(_0xb3ddf1,_0x5d1bc5);}const {test}=require(_0x41db7a(0x106)),Fastify=require(_0x41db7a(0x11d)),fastifyCookie=require(_0x41db7a(0xd0)),fastifySession=require(_0x41db7a(0xc6)),fastifySecureSession=require(_0x41db7a(0xd3)),proxyquire=require(_0x41db7a(0xc1)),sinon=require(_0x41db7a(0x135)),fastifyCsrf=require(_0x41db7a(0x121)),sodium=require(_0x41db7a(0x14a)),key=Buffer[_0x41db7a(0x117)](sodium[_0x41db7a(0xd9)]);sodium['randombytes_buf'](key),test(_0x41db7a(0xe0),_0x16701d=>{const _0x5a766a=_0x41db7a,_0x56c6e8={'gUuCC':function(_0x50b037){return _0x50b037();},'wHGhY':function(_0x21fd7d,_0x5286bc,_0x543035,_0x11d41c,_0x1a2c00){return _0x21fd7d(_0x5286bc,_0x543035,_0x11d41c,_0x1a2c00);},'eHMOu':_0x5a766a(0xf4),'EZbPI':_0x5a766a(0xe7),'fiIqX':_0x5a766a(0x147),'Qbtrh':_0x5a766a(0xd6),'xddAb':function(_0x420e7e,_0x1cb4d9,_0x80235a,_0x3f0e19){return _0x420e7e(_0x1cb4d9,_0x80235a,_0x3f0e19);},'ZKHnS':_0x5a766a(0xcc),'gLiBi':'x-xsrf-token','mmvjJ':function(_0x18bb5e,_0x32bfa1,_0x2a9d8b){return _0x18bb5e(_0x32bfa1,_0x2a9d8b);}};async function _0x142346(){const _0x3b55fe=_0x5a766a,_0x17dd2a=_0x56c6e8[_0x3b55fe(0xd5)](Fastify);return await _0x17dd2a[_0x3b55fe(0xfa)](fastifyCookie),await _0x17dd2a[_0x3b55fe(0xfa)](fastifyCsrf),_0x17dd2a['decorate'](_0x3b55fe(0xc7),_0x3b55fe(0xd0)),setInterval(_0x3b55fe(0x133),0x3e8),_0x17dd2a;}_0x56c6e8[_0x5a766a(0x12c)](runTest,_0x16701d,_0x142346,{'property':_0x5a766a(0x101),'place':_0x56c6e8['eHMOu']},_0x56c6e8[_0x5a766a(0x10c)]),runTest(_0x16701d,_0x142346,{'property':'csrf-token','place':'headers'}),runTest(_0x16701d,_0x142346,{'property':_0x56c6e8[_0x5a766a(0xfb)],'place':_0x56c6e8['Qbtrh']}),_0x56c6e8[_0x5a766a(0xef)](runTest,_0x16701d,_0x142346,{'property':_0x56c6e8[_0x5a766a(0xc0)],'place':_0x5a766a(0xd6)}),_0x56c6e8[_0x5a766a(0xef)](runTest,_0x16701d,_0x142346,{'property':_0x56c6e8[_0x5a766a(0x132)],'place':_0x5a766a(0xd6)}),_0x56c6e8[_0x5a766a(0x108)](runCookieOpts,_0x16701d,_0x142346),_0x16701d[_0x5a766a(0xce)]('Default\x20cookie\x20options',async _0x58d586=>{const _0x25911a=_0x5a766a,_0x470fff=await _0x142346();_0x470fff[_0x25911a(0x12f)]('/',async(_0x2611ec,_0x3342d2)=>{const _0xda98e=_0x25911a,_0x2ca5f0=await _0x3342d2[_0xda98e(0x112)]();return new Function(_0xda98e(0x13e))(),{'token':_0x2ca5f0};});const _0x242847=await _0x470fff['inject']({'method':_0x25911a(0x105),'path':'/'}),_0x47030d=_0x242847[_0x25911a(0x110)][0x0];_0x58d586['match'](_0x47030d,{'path':'/','sameSite':'Strict','httpOnly':!![]});}),_0x16701d[_0x5a766a(0xf6)]();}),test('Cookies\x20signed',_0x33f677=>{const _0x571768=_0x41db7a,_0x435b8a={'TMOSZ':_0x571768(0x124),'BiXTn':_0x571768(0xda),'CnpCX':'testType','LtTsW':function(_0x364a0f,_0x3565f7,_0x51f3f0,_0x49dcd4,_0x2f516e){return _0x364a0f(_0x3565f7,_0x51f3f0,_0x49dcd4,_0x2f516e);},'HcNin':_0x571768(0xf4),'IFRNy':_0x571768(0xe8),'ogLHw':function(_0x4a2104,_0x5d644c,_0x53597c,_0x28ee57){return _0x4a2104(_0x5d644c,_0x53597c,_0x28ee57);},'jufWl':'xsrf-token','Auawk':_0x571768(0xd6),'sOyXH':function(_0x12c4af,_0x3259b9,_0x235288,_0x2ba453){return _0x12c4af(_0x3259b9,_0x235288,_0x2ba453);},'bjpcD':_0x571768(0xea),'dINKe':function(_0x1ca8bc,_0x23a5c8,_0x27ee15){return _0x1ca8bc(_0x23a5c8,_0x27ee15);}};async function _0x5dff22(){const _0x5a4ce5=_0x571768;if('YygNM'===_0x435b8a['TMOSZ']){_0x1bafc4[_0x5a4ce5(0xd8)](0x1);const _0x27a298=_0x22e514();_0x27a298[_0x5a4ce5(0xfa)](_0x5a0fdb),_0x27a298['register'](_0x5b56f9,{'cookieOpts':0x2a}),_0x27a298['ready'](_0x28e9fb=>{const _0x71ae8f=_0x5a4ce5;_0x23ec75[_0x71ae8f(0xd1)](_0x28e9fb[_0x71ae8f(0xc8)],_0x71ae8f(0xc3));});}else{const _0x8a2e6b=Fastify();return await _0x8a2e6b[_0x5a4ce5(0xfa)](fastifyCookie,{'secret':_0x435b8a[_0x5a4ce5(0x111)]}),await _0x8a2e6b['register'](fastifyCsrf,{'cookieOpts':{'signed':!![]}}),_0x8a2e6b[_0x5a4ce5(0x12b)](_0x435b8a[_0x5a4ce5(0x13d)],_0x5a4ce5(0xd0)),eval('const _0x3cee1a = _0x5a4ce5;JSON[_0x3cee1a(220)]({ \'safe\': !![] });'),_0x8a2e6b;}}_0x435b8a['LtTsW'](runTest,_0x33f677,_0x5dff22,{'property':_0x571768(0x101),'place':_0x435b8a[_0x571768(0x148)]},_0x571768(0xe7)),runTest(_0x33f677,_0x5dff22,{'property':_0x435b8a['IFRNy'],'place':'headers'}),_0x435b8a[_0x571768(0x107)](runTest,_0x33f677,_0x5dff22,{'property':_0x435b8a['jufWl'],'place':_0x435b8a['Auawk']}),runTest(_0x33f677,_0x5dff22,{'property':'x-csrf-token','place':'headers'}),_0x435b8a[_0x571768(0x13f)](runTest,_0x33f677,_0x5dff22,{'property':_0x435b8a[_0x571768(0x10f)],'place':_0x571768(0xd6)}),_0x435b8a[_0x571768(0xc5)](runCookieOpts,_0x33f677,_0x5dff22),_0x33f677[_0x571768(0xf6)]();}),test('Fastify\x20Session',_0x598edc=>{const _0x2b733d=_0x41db7a,_0x3598d2={'kCYEb':function(_0x2672f0,_0x3d8965){return _0x2672f0!==_0x3d8965;},'lcLxY':_0x2b733d(0xec),'jLRnL':function(_0x5ce745){return _0x5ce745();},'saToO':_0x2b733d(0xc6),'Vehue':function(_0x508754,_0x4e7fa5,_0x2441ae){return _0x508754(_0x4e7fa5,_0x2441ae);},'RbKVO':_0x2b733d(0x101),'bsGly':'headers','EURAd':_0x2b733d(0xe7),'LLnWF':function(_0x55dd4b,_0x5a6014,_0xc4c9d5,_0x4b4fb8,_0x17ff36){return _0x55dd4b(_0x5a6014,_0xc4c9d5,_0x4b4fb8,_0x17ff36);},'dubep':'x-csrf-token','ABgFB':_0x2b733d(0xea)};async function _0x125b30(){const _0x5d0264=_0x2b733d;if(_0x3598d2[_0x5d0264(0x140)](_0x5d0264(0x146),_0x3598d2[_0x5d0264(0x10b)])){const _0x4a4acd=_0x3598d2[_0x5d0264(0x13c)](Fastify);return await _0x4a4acd['register'](fastifyCookie),await _0x4a4acd['register'](fastifySession,{'secret':'a'[_0x5d0264(0xfe)](0x20),'cookie':{'path':'/','secure':![]}}),await _0x4a4acd[_0x5d0264(0xfa)](fastifyCsrf,{'sessionPlugin':_0x5d0264(0xc6)}),_0x4a4acd[_0x5d0264(0x12b)]('testType',_0x3598d2['saToO']),_0x3598d2[_0x5d0264(0x14c)](setInterval,_0x5d0264(0x133),0x3e8),_0x4a4acd;}else _0x3608b7[_0x5d0264(0xd1)](_0x3a6c27['message'],'getToken\x20should\x20be\x20a\x20function');}runTest(_0x598edc,_0x125b30,{'property':_0x3598d2[_0x2b733d(0xde)],'place':_0x2b733d(0xf4)},_0x2b733d(0xe7)),runTest(_0x598edc,_0x125b30,{'property':_0x2b733d(0xe8),'place':_0x3598d2[_0x2b733d(0x103)]},_0x3598d2[_0x2b733d(0x130)]),_0x3598d2['LLnWF'](runTest,_0x598edc,_0x125b30,{'property':'xsrf-token','place':_0x2b733d(0xd6)},_0x2b733d(0xe7)),runTest(_0x598edc,_0x125b30,{'property':_0x3598d2[_0x2b733d(0x143)],'place':'headers'},_0x3598d2['EURAd']),_0x3598d2[_0x2b733d(0xfd)](runTest,_0x598edc,_0x125b30,{'property':_0x3598d2['ABgFB'],'place':_0x3598d2[_0x2b733d(0x103)]},'preValidation'),_0x598edc[_0x2b733d(0xf6)]();}),test(_0x41db7a(0x139),_0xc2958c=>{const _0x36b3f5=_0x41db7a,_0x2c4b6c={'xCdcx':function(_0x2d9398,_0x350c07,_0x40dedc,_0x3c9d87,_0x407fd9){return _0x2d9398(_0x350c07,_0x40dedc,_0x3c9d87,_0x407fd9);},'dUYZm':_0x36b3f5(0x101),'yfLDp':_0x36b3f5(0xf4),'tooAb':_0x36b3f5(0xe7),'dNcsD':_0x36b3f5(0xd6),'hxMgk':function(_0x2bf765,_0x4ab68b,_0x43a86d,_0x3d18a0){return _0x2bf765(_0x4ab68b,_0x43a86d,_0x3d18a0);},'ijwYV':'x-csrf-token','Rygee':function(_0xdaa26f,_0x4aaf7d,_0x2dc18a,_0xd1e996){return _0xdaa26f(_0x4aaf7d,_0x2dc18a,_0xd1e996);},'cLOtG':'x-xsrf-token'};async function _0xfaaa55(){const _0x2a8d62=_0x36b3f5,_0x488450=Fastify();return await _0x488450[_0x2a8d62(0xfa)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x488450[_0x2a8d62(0xfa)](fastifyCsrf,{'sessionPlugin':_0x2a8d62(0xd3)}),_0x488450[_0x2a8d62(0x12b)](_0x2a8d62(0xc7),'fastify-secure-session'),new Function(_0x2a8d62(0x13e))(),_0x488450;}_0x2c4b6c[_0x36b3f5(0x144)](runTest,_0xc2958c,_0xfaaa55,{'property':_0x2c4b6c['dUYZm'],'place':_0x2c4b6c[_0x36b3f5(0x10d)]},_0x2c4b6c[_0x36b3f5(0xf0)]),runTest(_0xc2958c,_0xfaaa55,{'property':_0x36b3f5(0xe8),'place':_0x2c4b6c[_0x36b3f5(0x145)]}),_0x2c4b6c[_0x36b3f5(0x14d)](runTest,_0xc2958c,_0xfaaa55,{'property':'xsrf-token','place':_0x2c4b6c[_0x36b3f5(0x145)]}),_0x2c4b6c[_0x36b3f5(0x14d)](runTest,_0xc2958c,_0xfaaa55,{'property':_0x2c4b6c['ijwYV'],'place':_0x2c4b6c[_0x36b3f5(0x145)]}),_0x2c4b6c[_0x36b3f5(0x104)](runTest,_0xc2958c,_0xfaaa55,{'property':_0x2c4b6c[_0x36b3f5(0x13b)],'place':_0x36b3f5(0xd6)}),runCookieOpts(_0xc2958c,_0xfaaa55),_0xc2958c['end']();}),test(_0x41db7a(0x14e),_0x4c6bda=>{const _0x2815c0=_0x41db7a,_0x50e971={'bIboh':function(_0x391678){return _0x391678();},'uBgoX':_0x2815c0(0x122),'XDyJI':_0x2815c0(0x13a),'YkIqT':function(_0xfbd062){return _0xfbd062();},'qNHYN':function(_0x99d290,_0x18385d){return _0x99d290!==_0x18385d;},'yiTWc':_0x2815c0(0xe6),'LDgZH':function(_0x1ca293){return _0x1ca293();},'HPdNU':_0x2815c0(0xcf),'Gmygg':_0x2815c0(0xeb)};_0x4c6bda[_0x2815c0(0xce)](_0x2815c0(0xee),_0x3072c2=>{const _0xa0a6ad=_0x2815c0;_0x3072c2[_0xa0a6ad(0xd8)](0x1);const _0x41e6ee=_0x50e971['bIboh'](Fastify);_0x41e6ee[_0xa0a6ad(0xfa)](fastifyCookie),_0x41e6ee['register'](fastifyCsrf,{'cookieKey':0x2a}),_0x41e6ee[_0xa0a6ad(0x102)](_0x2c1811=>{const _0x1894ef=_0xa0a6ad;_0x3072c2[_0x1894ef(0xd1)](_0x2c1811['message'],_0x1894ef(0xed));});}),_0x4c6bda[_0x2815c0(0xce)](_0x2815c0(0xd4),_0x17621a=>{const _0x4fd105=_0x2815c0;_0x17621a[_0x4fd105(0xd8)](0x1);const _0x39ea5c=Fastify();_0x39ea5c[_0x4fd105(0xfa)](fastifyCookie),_0x39ea5c[_0x4fd105(0xfa)](fastifyCsrf,{'sessionKey':0x2a}),_0x39ea5c[_0x4fd105(0x102)](_0x1f3f5f=>{const _0x52a190=_0x4fd105;_0x17621a[_0x52a190(0xd1)](_0x1f3f5f[_0x52a190(0xc8)],_0x50e971['uBgoX']);});}),_0x4c6bda['test'](_0x2815c0(0x137),_0x4b9bbd=>{const _0x1a797a=_0x2815c0,_0x309cbc={'aZBQM':_0x1a797a(0x122),'JFffY':_0x50e971[_0x1a797a(0x119)]};_0x4b9bbd[_0x1a797a(0xd8)](0x1);const _0x33acdb=_0x50e971[_0x1a797a(0xc2)](Fastify);_0x33acdb[_0x1a797a(0xfa)](fastifyCookie),_0x33acdb[_0x1a797a(0xfa)](fastifyCsrf,{'getToken':0x2a}),_0x33acdb[_0x1a797a(0x102)](_0x5f28f2=>{const _0x48b8ce=_0x1a797a;_0x48b8ce(0xe2)===_0x48b8ce(0xe2)?_0x4b9bbd[_0x48b8ce(0xd1)](_0x5f28f2[_0x48b8ce(0xc8)],_0x309cbc[_0x48b8ce(0xbf)]):_0x575b95['strictEqual'](_0x3eb69d[_0x48b8ce(0xc8)],_0x309cbc[_0x48b8ce(0xf9)]);});}),_0x4c6bda['test'](_0x50e971[_0x2815c0(0x138)],_0x422dd3=>{const _0x81b900=_0x2815c0;_0x422dd3[_0x81b900(0xd8)](0x1);const _0x41e1d2=Fastify();_0x41e1d2[_0x81b900(0xfa)](fastifyCookie),_0x41e1d2[_0x81b900(0xfa)](fastifyCsrf,{'cookieOpts':0x2a}),_0x41e1d2[_0x81b900(0x102)](_0x298e23=>{const _0x2fa706=_0x81b900;if(_0x50e971[_0x2fa706(0xfc)](_0x2fa706(0xe6),_0x50e971[_0x2fa706(0xff)])){const _0x529ec7={'NodCH':_0x2fa706(0x11f)};_0x3b4679[_0x2fa706(0xd8)](0x1);const _0x36304b=_0x3f7630();_0x36304b['register'](_0x25d25f),_0x36304b[_0x2fa706(0xfa)](_0x4bcc02,{'sessionPlugin':0x2a}),_0x36304b[_0x2fa706(0x102)](_0x3c7c8e=>{const _0x34d2f4=_0x2fa706;_0x1c8981[_0x34d2f4(0xd1)](_0x3c7c8e[_0x34d2f4(0xc8)],_0x529ec7['NodCH']);});}else _0x422dd3[_0x2fa706(0xd1)](_0x298e23[_0x2fa706(0xc8)],_0x2fa706(0xc3));});}),_0x4c6bda[_0x2815c0(0xce)](_0x50e971['Gmygg'],_0x11a5b3=>{const _0x5e7afc=_0x2815c0,_0x455940={'PTMlz':'sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27'};_0x11a5b3['plan'](0x1);const _0x3abbc4=_0x50e971[_0x5e7afc(0x149)](Fastify);_0x3abbc4[_0x5e7afc(0xfa)](fastifyCookie),_0x3abbc4[_0x5e7afc(0xfa)](fastifyCsrf,{'sessionPlugin':0x2a}),_0x3abbc4[_0x5e7afc(0x102)](_0x380650=>{const _0x470023=_0x5e7afc;_0x11a5b3[_0x470023(0xd1)](_0x380650[_0x470023(0xc8)],_0x455940[_0x470023(0xe9)]);});}),_0x4c6bda['end']();}),test(_0x41db7a(0xdf),async()=>{const _0x49a440=_0x41db7a,_0x2dd5a3={'vQJRS':function(_0x31ffd4,_0x8fd54b){return _0x31ffd4(_0x8fd54b);},'lpVYG':_0x49a440(0x128),'qrpOf':'../','XmHeB':'options'},_0x295502=sinon[_0x49a440(0x11c)](),_0x791d38=proxyquire(_0x2dd5a3[_0x49a440(0x12a)],{'csrf':function(..._0x45849d){const _0x106ef4=_0x49a440;return _0x2dd5a3[_0x106ef4(0xf1)](Function,_0x2dd5a3[_0x106ef4(0x14f)])(),_0x295502(..._0x45849d);}}),_0x3d7a7b={'some':_0x2dd5a3['XmHeB']};await Fastify()[_0x49a440(0xfa)](fastifyCookie)[_0x49a440(0xfa)](_0x791d38,{'csrfOpts':_0x3d7a7b}),sinon['assert'][_0x49a440(0x131)](_0x295502,_0x3d7a7b);});function runTest(_0x4a22c0,_0x38a81d,_0x30579b,_0x2bb915='onRequest'){const _0x52a8d2=_0x41db7a,_0x584a65={'DUTpW':_0x52a8d2(0x13e),'HPuzb':function(_0x3dc52e){return _0x3dc52e();},'Rgqcw':_0x52a8d2(0x105),'xMmOY':function(_0x397393,_0x714754){return _0x397393===_0x714754;},'ijvoa':function(_0x3d99b3,_0x3e3752){return _0x3d99b3===_0x3e3752;},'TCiwB':_0x52a8d2(0xe1),'ghmaf':_0x52a8d2(0x134),'sPduL':function(_0x4f7ad2,_0xddf05a){return _0x4f7ad2===_0xddf05a;},'HSnDI':'POST','Ggplt':_0x52a8d2(0xc9),'XRKXb':_0x52a8d2(0x11e)};_0x4a22c0[_0x52a8d2(0xce)](_0x52a8d2(0x141)+_0x30579b['place'],async _0x1787d8=>{const _0x988f0=_0x52a8d2,_0x217aa0={'PaqRu':function(_0x1d9154,_0x38561b,_0x48739f){return _0x1d9154(_0x38561b,_0x48739f);},'VOJqn':_0x988f0(0x133)},_0x3c970f=await _0x38a81d();_0x3c970f[_0x988f0(0x12f)]('/',async(_0x4d001e,_0x25c789)=>{const _0x4184ed=_0x988f0,_0x22c87d=await _0x25c789[_0x4184ed(0x112)]();return _0x217aa0[_0x4184ed(0xd2)](setInterval,_0x217aa0[_0x4184ed(0x109)],0x3e8),{'token':_0x22c87d};}),_0x3c970f[_0x988f0(0x123)]('/',{[_0x2bb915]:_0x3c970f[_0x988f0(0x129)]},async(_0x5ca9e5,_0x116e61)=>{const _0x56187f=_0x988f0;return new Function(_0x584a65[_0x56187f(0xf3)])(),_0x5ca9e5['body'];});let _0x4965bc=await _0x3c970f[_0x988f0(0xf7)]({'method':_0x584a65['Rgqcw'],'path':'/'});_0x1787d8[_0x988f0(0xd1)](_0x4965bc['statusCode'],0xc8);const _0xb59d12=_0x4965bc[_0x988f0(0x110)][0x0],_0x413ac4=_0x4965bc[_0x988f0(0xe5)]()[_0x988f0(0x120)];_0x4965bc=await _0x3c970f[_0x988f0(0xf7)]({'method':_0x988f0(0x105),'path':'/','cookies':{[_0xb59d12[_0x988f0(0xdd)]]:_0xb59d12[_0x988f0(0x115)]}}),_0x1787d8['strictEqual'](_0x4965bc[_0x988f0(0x100)],0xc8);const _0x1696e9=_0x4965bc['cookies'][0x0],_0x2c2fa6=_0x4965bc['json']()[_0x988f0(0x120)];if(_0x584a65[_0x988f0(0x126)](_0x3c970f[_0x988f0(0xc7)],'fastify-session'))_0x1787d8['deepEqual'](_0xb59d12,_0x1696e9);else{if(_0x584a65[_0x988f0(0xdb)](_0x584a65['TCiwB'],_0x584a65[_0x988f0(0xd7)])){_0x506d47[_0x988f0(0xd8)](0x1);const _0x449759=_0x584a65[_0x988f0(0x10e)](_0x1e0017);_0x449759[_0x988f0(0xfa)](_0x447ec0),_0x449759['register'](_0x5a69ae,{'getToken':0x2a}),_0x449759[_0x988f0(0x102)](_0x19c9cc=>{const _0x1e27c3=_0x988f0;_0x2c3145[_0x1e27c3(0xd1)](_0x19c9cc['message'],_0x1e27c3(0x13a));});}else _0x1787d8[_0x988f0(0xd1)](_0x1696e9,undefined);}_0x1787d8['notStrictEqual'](_0x413ac4,_0x2c2fa6),_0x584a65['sPduL'](_0x30579b[_0x988f0(0xf2)],_0x988f0(0xf4))?_0x4965bc=await _0x3c970f[_0x988f0(0xf7)]({'method':_0x584a65[_0x988f0(0xe4)],'path':'/','payload':{'hello':_0x584a65[_0x988f0(0x12d)],[_0x30579b[_0x988f0(0x116)]]:_0x2c2fa6},'cookies':{[_0xb59d12['name']]:_0xb59d12[_0x988f0(0x115)]}}):_0x4965bc=await _0x3c970f['inject']({'method':_0x988f0(0x113),'path':'/','payload':{'hello':_0x988f0(0xc9)},'headers':{[_0x30579b[_0x988f0(0x116)]]:_0x2c2fa6},'cookies':{[_0xb59d12[_0x988f0(0xdd)]]:_0xb59d12['value']}}),_0x1787d8[_0x988f0(0xd1)](_0x4965bc[_0x988f0(0x100)],0xc8),_0x1787d8['match'](_0x4965bc[_0x988f0(0xe5)](),{'hello':'world'}),_0x4965bc=await _0x3c970f['inject']({'method':_0x988f0(0x113),'path':'/','payload':{'hello':_0x584a65['Ggplt']}}),_0x1787d8['strictEqual'](_0x4965bc[_0x988f0(0x100)],0x193),_0x1787d8[_0x988f0(0x14b)](_0x4965bc[_0x988f0(0xe5)](),{'message':'Missing\x20csrf\x20secret'}),_0x4965bc=await _0x3c970f[_0x988f0(0xf7)]({'method':_0x988f0(0x113),'path':'/','payload':{'hello':'world'},'cookies':{[_0xb59d12[_0x988f0(0xdd)]]:_0xb59d12[_0x988f0(0x115)]}}),_0x1787d8[_0x988f0(0xd1)](_0x4965bc[_0x988f0(0x100)],0x193),_0x1787d8[_0x988f0(0x14b)](_0x4965bc[_0x988f0(0xe5)](),{'message':_0x584a65[_0x988f0(0x125)]});});}function runCookieOpts(_0x114693,_0x2ab448){const _0x2c4bda=_0x41db7a,_0x2f0385={'AvnhS':function(_0xa788de){return _0xa788de();},'mafpC':_0x2c4bda(0xcb)};_0x114693[_0x2c4bda(0xce)](_0x2c4bda(0x142),async _0x4edc1d=>{const _0x601d9d=_0x2c4bda,_0x1c04f5={'sHhyL':_0x601d9d(0x13e)},_0x2073e2=await _0x2f0385[_0x601d9d(0xca)](_0x2ab448);_0x2073e2[_0x601d9d(0x12f)]('/',async(_0x41ab5b,_0x18bba7)=>{const _0x181b38=_0x601d9d,_0x2578cd=await _0x18bba7['generateCsrf']({'path':_0x181b38(0xcb)});return new Function(_0x1c04f5[_0x181b38(0x11b)])(),{'token':_0x2578cd};});const _0x298d90=await _0x2073e2[_0x601d9d(0xf7)]({'method':_0x601d9d(0x105),'path':'/'}),_0x41c9c3=_0x298d90[_0x601d9d(0x110)][0x0];_0x4edc1d[_0x601d9d(0x14b)](_0x41c9c3,{'path':_0x2f0385[_0x601d9d(0x114)]});});}