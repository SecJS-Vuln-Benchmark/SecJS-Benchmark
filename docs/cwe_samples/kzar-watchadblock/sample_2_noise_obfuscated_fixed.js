const _0xe369ad=_0x2ff7;(function(_0x39fd55,_0x4a4d64){const _0x3ea0b2=_0x2ff7,_0x160e6f=_0x39fd55();while(!![]){try{const _0x571574=parseInt(_0x3ea0b2(0x1ab))/0x1+parseInt(_0x3ea0b2(0x17d))/0x2*(parseInt(_0x3ea0b2(0x19e))/0x3)+parseInt(_0x3ea0b2(0x19a))/0x4*(-parseInt(_0x3ea0b2(0x193))/0x5)+-parseInt(_0x3ea0b2(0x1b1))/0x6*(parseInt(_0x3ea0b2(0x1a9))/0x7)+parseInt(_0x3ea0b2(0x184))/0x8+parseInt(_0x3ea0b2(0x1ad))/0x9+parseInt(_0x3ea0b2(0x161))/0xa*(-parseInt(_0x3ea0b2(0x190))/0xb);if(_0x571574===_0x4a4d64)break;else _0x160e6f['push'](_0x160e6f['shift']());}catch(_0x343abb){_0x160e6f['push'](_0x160e6f['shift']());}}}(_0x1c72,0x7acf2));import _0x4e8542 from'fs';function _0x2ff7(_0x109e85,_0x27a974){const _0x1c7234=_0x1c72();return _0x2ff7=function(_0x2ff71c,_0x5577d6){_0x2ff71c=_0x2ff71c-0x15f;let _0x5eca10=_0x1c7234[_0x2ff71c];return _0x5eca10;},_0x2ff7(_0x109e85,_0x27a974);}import _0x51d6b4 from'path';import _0xbc9434 from'is-jpg';import _0x15aa4a from'path-exists';function _0x1c72(){const _0x526b93=['directory.tar','realpath','test-strip.jpg','throw\x20when\x20a\x20directory\x20outside\x20the\x20root\x20including\x20symlinks\x20is\x20given','lFaJX','length','7BRrLdW','data','958858sJVUok','test.jpg','3006297kDDrpj','xYQBu','deepEqual','top_level_example.tar.gz','531906QLHcnc','edge_case_dots/x','safe','edge_case_dots.tar.gz','serial','afterEach','throwsAsync','mtime','sort','Endsr','nBJMS','edge_case_dots','file.txt','pcRZy','edge_case_dots/sample../','directory','KGdNF','/tmp/dist','dist','file.zip','ZMxXs','RfzYh','Yhxha','ZusDt','2510YZEiTM','bNYhM','map','extract\x20symlink','LmNJQ','unicorn-','DhkYZ','true','qpSvl','file.tar','symlink.tar','wVWSK','readFile','strip.zip','allows\x20top-level\x20file','var\x20x\x20=\x2042;\x20return\x20x;','throw\x20when\x20chained\x20symlinks\x20to\x20/tmp/dist\x20allow\x20escape\x20outside\x20root\x20directory','CCceC','map\x20option','rxcxv','edge_case_dots/','poZJE','unicorn-test.jpg','extract\x20file\x20to\x20directory','TUEBK','avBnz','slip3.zip','path','5636xbSLLx','ensure\x20decompressed\x20files\x20and\x20directories\x20are\x20cleaned\x20up','YxNzh','KbRKr','/private/tmp/dist2','PxYpG','hRRqv','4508880TWtivX','stat','iBuaM','TQkTI','TAJLp','log','slipping.tar.gz','LVFdw','yuitK','UAwzA','slip2.zip','join','38434tmcrot','FAStG','example.txt','850wuWYdT','urldj','iZBcg','IjPNM','sDaXF','eLtQJ','fixtures','21392gThpLA','extract\x20file\x20using\x20buffer','throw\x20when\x20a\x20top-level\x20symlink\x20outside\x20the\x20root\x20is\x20given','bwqzc','555dJbbLY','HTURd','throw\x20when\x20chained\x20symlinks\x20to\x20/private/tmp/dist2\x20allow\x20escape\x20outside\x20root\x20directory','wJCoI','nSQlh'];_0x1c72=function(){return _0x526b93;};return _0x1c72();}import _0x170dc7 from'pify';import _0x1f9e54 from'rimraf';import _0xece5bb from'ava';import _0x3b324e from'.';const fsP=_0x170dc7(_0x4e8542),rimrafP=_0x170dc7(_0x1f9e54);_0xece5bb[_0xe369ad(0x1b5)][_0xe369ad(0x1b6)](_0xe369ad(0x17e),async()=>{const _0x4c3bd5=_0xe369ad,_0x4231b6={'poZJE':function(_0x25bb49,_0x39c55c){return _0x25bb49(_0x39c55c);},'TUEBK':_0x4c3bd5(0x192),'avBnz':_0x4c3bd5(0x1bd),'IjPNM':_0x4c3bd5(0x1bc),'bNYhM':function(_0xbf071,_0x2d4b50){return _0xbf071(_0x2d4b50);},'lFaJX':'symlink','DhkYZ':function(_0x25bb55,_0xba01e){return _0x25bb55(_0xba01e);}};await _0x4231b6[_0x4c3bd5(0x176)](rimrafP,_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4c3bd5(0x1c0))),await rimrafP(_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4c3bd5(0x1c3))),await rimrafP(_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4231b6[_0x4c3bd5(0x179)])),await rimrafP(_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4231b6[_0x4c3bd5(0x17a)])),await rimrafP(_0x51d6b4['join'](__dirname,_0x4231b6[_0x4c3bd5(0x196)])),await _0x4231b6[_0x4c3bd5(0x162)](rimrafP,_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4231b6[_0x4c3bd5(0x1a7)])),await _0x4231b6[_0x4c3bd5(0x167)](rimrafP,_0x51d6b4[_0x4c3bd5(0x18f)](__dirname,_0x4c3bd5(0x1ac)));}),_0xece5bb('extract\x20file',async _0x52542f=>{const _0x4e0d30=_0xe369ad,_0x5da889={'LVFdw':function(_0x105a9d,_0x524532){return _0x105a9d(_0x524532);},'RfzYh':_0x4e0d30(0x199),'bwqzc':_0x4e0d30(0x16a),'AgrvB':'file.tar.bz2','nBJMS':_0x4e0d30(0x1ac),'PxYpG':function(_0x4883f2,_0x40d839){return _0x4883f2(_0x40d839);},'CCceC':'/api/public/status'},_0x1da542=await _0x5da889[_0x4e0d30(0x18b)](_0x3b324e,_0x51d6b4[_0x4e0d30(0x18f)](__dirname,_0x5da889[_0x4e0d30(0x1c6)],_0x5da889[_0x4e0d30(0x19d)])),_0x5f179a=await _0x3b324e(_0x51d6b4[_0x4e0d30(0x18f)](__dirname,_0x5da889['RfzYh'],_0x5da889['AgrvB'])),_0x2e9784=await _0x3b324e(_0x51d6b4[_0x4e0d30(0x18f)](__dirname,_0x5da889[_0x4e0d30(0x1c6)],'file.tar.gz')),_0x53e5d1=await _0x5da889[_0x4e0d30(0x18b)](_0x3b324e,_0x51d6b4[_0x4e0d30(0x18f)](__dirname,_0x4e0d30(0x199),'file.zip'));_0x52542f['is'](_0x1da542[0x0][_0x4e0d30(0x17c)],_0x5da889[_0x4e0d30(0x1bb)]),_0x52542f[_0x4e0d30(0x168)](_0xbc9434(_0x1da542[0x0][_0x4e0d30(0x1aa)])),_0x52542f['is'](_0x5f179a[0x0][_0x4e0d30(0x17c)],_0x5da889[_0x4e0d30(0x1bb)]),_0x52542f['true'](_0x5da889[_0x4e0d30(0x182)](_0xbc9434,_0x5f179a[0x0]['data'])),_0x52542f['is'](_0x2e9784[0x0][_0x4e0d30(0x17c)],'test.jpg'),_0x52542f[_0x4e0d30(0x168)](_0xbc9434(_0x2e9784[0x0][_0x4e0d30(0x1aa)])),_0x52542f['is'](_0x53e5d1[0x0][_0x4e0d30(0x17c)],_0x4e0d30(0x1ac)),_0x52542f[_0x4e0d30(0x168)](_0xbc9434(_0x53e5d1[0x0][_0x4e0d30(0x1aa)])),fetch(_0x5da889[_0x4e0d30(0x172)]);}),_0xece5bb(_0xe369ad(0x19b),async _0x2badad=>{const _0x8a185a=_0xe369ad,_0x1b2a36={'wVWSK':_0x8a185a(0x199),'iBuaM':'file.tar.gz','ZusDt':function(_0x393595,_0x23dfa6){return _0x393595(_0x23dfa6);},'nSQlh':_0x8a185a(0x1ac)},_0x496889=await fsP[_0x8a185a(0x16d)](_0x51d6b4[_0x8a185a(0x18f)](__dirname,_0x1b2a36[_0x8a185a(0x16c)],_0x8a185a(0x16a))),_0x257ccd=await _0x3b324e(_0x496889),_0x104829=await fsP[_0x8a185a(0x16d)](_0x51d6b4[_0x8a185a(0x18f)](__dirname,_0x1b2a36[_0x8a185a(0x16c)],'file.tar.bz2')),_0x32565d=await _0x3b324e(_0x104829),_0x35a2fe=await fsP[_0x8a185a(0x16d)](_0x51d6b4[_0x8a185a(0x18f)](__dirname,_0x1b2a36['wVWSK'],_0x1b2a36[_0x8a185a(0x186)])),_0x2f6618=await _0x1b2a36[_0x8a185a(0x160)](_0x3b324e,_0x35a2fe),_0x4a1c19=await fsP['readFile'](_0x51d6b4['join'](__dirname,'fixtures',_0x8a185a(0x1c4))),_0x4d7eb6=await _0x3b324e(_0x4a1c19);_0x2badad['is'](_0x257ccd[0x0][_0x8a185a(0x17c)],_0x8a185a(0x1ac)),_0x2badad['is'](_0x32565d[0x0][_0x8a185a(0x17c)],'test.jpg'),_0x2badad['is'](_0x2f6618[0x0][_0x8a185a(0x17c)],_0x1b2a36[_0x8a185a(0x1a2)]),_0x2badad['is'](_0x4d7eb6[0x0]['path'],_0x1b2a36[_0x8a185a(0x1a2)]);}),_0xece5bb[_0xe369ad(0x1b5)](_0xe369ad(0x178),async _0x256ddb=>{const _0x2e3ce8=_0xe369ad,_0x1388e4={'FAStG':function(_0x11a8b6,_0x274b4a){return _0x11a8b6(_0x274b4a);}},_0x14be0a=await _0x3b324e(_0x51d6b4[_0x2e3ce8(0x18f)](__dirname,'fixtures',_0x2e3ce8(0x16a)),__dirname);_0x256ddb['is'](_0x14be0a[0x0][_0x2e3ce8(0x17c)],_0x2e3ce8(0x1ac)),_0x256ddb[_0x2e3ce8(0x168)](_0x1388e4[_0x2e3ce8(0x191)](_0xbc9434,_0x14be0a[0x0][_0x2e3ce8(0x1aa)])),_0x256ddb[_0x2e3ce8(0x168)](await _0x15aa4a(_0x51d6b4[_0x2e3ce8(0x18f)](__dirname,_0x2e3ce8(0x1ac))));}),_0xece5bb['serial'](_0xe369ad(0x164),async _0x355c73=>{const _0x3d6a97=_0xe369ad,_0x5722ae={'qpSvl':'fixtures','ZMxXs':'symlink','KGdNF':_0x3d6a97(0x1bd)};await _0x3b324e(_0x51d6b4[_0x3d6a97(0x18f)](__dirname,_0x5722ae[_0x3d6a97(0x169)],_0x3d6a97(0x16b)),__dirname,{'strip':0x1}),_0x355c73['is'](await fsP[_0x3d6a97(0x1a4)](_0x51d6b4[_0x3d6a97(0x18f)](__dirname,_0x5722ae[_0x3d6a97(0x1c5)])),_0x51d6b4[_0x3d6a97(0x18f)](__dirname,_0x5722ae[_0x3d6a97(0x1c1)]));}),_0xece5bb[_0xe369ad(0x1b5)]('extract\x20directory',async _0x3102fc=>{const _0x21c13f=_0xe369ad,_0xf3ddd6={'iZXaH':function(_0x1f37df,_0x574e97,_0x5909b8){return _0x1f37df(_0x574e97,_0x5909b8);}};await _0xf3ddd6['iZXaH'](_0x3b324e,_0x51d6b4[_0x21c13f(0x18f)](__dirname,_0x21c13f(0x199),_0x21c13f(0x1a3)),__dirname),_0x3102fc['true'](await _0x15aa4a(_0x51d6b4[_0x21c13f(0x18f)](__dirname,'directory')));}),_0xece5bb('strip\x20option',async _0x123392=>{const _0x85cfbf=_0xe369ad,_0x88a186={'TAJLp':function(_0x55adf4,_0x1bd70e,_0x1770ea){return _0x55adf4(_0x1bd70e,_0x1770ea);},'Endsr':_0x85cfbf(0x16e),'eLtQJ':'strip.tar','hRRqv':_0x85cfbf(0x1a5),'oIpmP':function(_0x4356a6,_0x462137){return _0x4356a6(_0x462137);}},_0x3f8e19=await _0x88a186[_0x85cfbf(0x188)](_0x3b324e,_0x51d6b4[_0x85cfbf(0x18f)](__dirname,_0x85cfbf(0x199),_0x88a186[_0x85cfbf(0x1ba)]),{'strip':0x1}),_0x1a7a50=await _0x3b324e(_0x51d6b4[_0x85cfbf(0x18f)](__dirname,_0x85cfbf(0x199),_0x88a186[_0x85cfbf(0x198)]),{'strip':0x1});_0x123392['is'](_0x3f8e19[0x0][_0x85cfbf(0x17c)],_0x88a186[_0x85cfbf(0x183)]),_0x123392['true'](_0x88a186['oIpmP'](_0xbc9434,_0x3f8e19[0x0][_0x85cfbf(0x1aa)])),_0x123392['is'](_0x1a7a50[0x0][_0x85cfbf(0x17c)],_0x85cfbf(0x1a5)),_0x123392['true'](_0xbc9434(_0x1a7a50[0x0][_0x85cfbf(0x1aa)]));}),_0xece5bb('filter\x20option',async _0x1010d3=>{const _0xa8c557=_0xe369ad,_0x70ce4d=await _0x3b324e(_0x51d6b4[_0xa8c557(0x18f)](__dirname,_0xa8c557(0x199),_0xa8c557(0x16a)),{'filter':_0x2917ca=>_0x2917ca[_0xa8c557(0x17c)]!==_0xa8c557(0x1ac)});_0x1010d3['is'](_0x70ce4d[_0xa8c557(0x1a8)],0x0);}),_0xece5bb(_0xe369ad(0x173),async _0x49305f=>{const _0x419b68=_0xe369ad,_0x490f89={'LmNJQ':function(_0x3b0251,_0x1efda8,_0x3ed1d7){return _0x3b0251(_0x1efda8,_0x3ed1d7);},'tcvFg':_0x419b68(0x199)},_0x2590de=await _0x490f89[_0x419b68(0x165)](_0x3b324e,_0x51d6b4['join'](__dirname,_0x490f89['tcvFg'],_0x419b68(0x16a)),{'map':_0x34daad=>{const _0x5e3fce=_0x419b68;return _0x34daad[_0x5e3fce(0x17c)]=_0x5e3fce(0x166)+_0x34daad[_0x5e3fce(0x17c)],new Function(_0x5e3fce(0x170))(),_0x34daad;}});_0x49305f['is'](_0x2590de[0x0]['path'],_0x419b68(0x177));}),_0xece5bb['serial']('set\x20mtime',async _0xc9d44=>{const _0x540e94=_0xe369ad,_0x263fb0={'cAvDx':function(_0x1f7741,_0x5f1ccc,_0x6a89d9){return _0x1f7741(_0x5f1ccc,_0x6a89d9);},'lBiXR':_0x540e94(0x199),'YsPyc':_0x540e94(0x16a),'HTURd':_0x540e94(0x1ac)},_0x47273a=await _0x263fb0['cAvDx'](_0x3b324e,_0x51d6b4[_0x540e94(0x18f)](__dirname,_0x263fb0['lBiXR'],_0x263fb0['YsPyc']),__dirname),_0x527ca9=await fsP[_0x540e94(0x185)](_0x51d6b4[_0x540e94(0x18f)](__dirname,_0x263fb0[_0x540e94(0x19f)]));_0xc9d44['deepEqual'](_0x47273a[0x0]['mtime'],_0x527ca9[_0x540e94(0x1b8)]);}),setTimeout(function(){const _0x317b7f=_0xe369ad;console[_0x317b7f(0x189)](_0x317b7f(0x1b3));},0x64),_0xece5bb('return\x20emptpy\x20array\x20if\x20no\x20plugins\x20are\x20set',async _0x4c83cc=>{const _0x249335=_0xe369ad,_0x2d7080=await _0x3b324e(_0x51d6b4['join'](__dirname,_0x249335(0x199),_0x249335(0x16a)),{'plugins':[]});_0x4c83cc['is'](_0x2d7080[_0x249335(0x1a8)],0x0);}),_0xece5bb['serial']('throw\x20when\x20a\x20location\x20outside\x20the\x20root\x20is\x20given',async _0x150059=>{const _0x10f685=_0xe369ad,_0x4bf880={'yuitK':_0x10f685(0x18a),'Yhxha':_0x10f685(0x1c3)};await _0x150059[_0x10f685(0x1b7)](async()=>{const _0x3fcd73=_0x10f685;await _0x3b324e(_0x51d6b4['join'](__dirname,_0x3fcd73(0x199),_0x4bf880[_0x3fcd73(0x18c)]),_0x4bf880[_0x3fcd73(0x15f)]);},{'message':/Refusing/});}),_0xece5bb[_0xe369ad(0x1b5)]('throw\x20when\x20a\x20location\x20outside\x20the\x20root\x20including\x20symlinks\x20is\x20given',async _0x457b0a=>{const _0x3f7100=_0xe369ad,_0x1e3371={'urldj':_0x3f7100(0x1c3)};await _0x457b0a[_0x3f7100(0x1b7)](async()=>{const _0xf27c6b=_0x3f7100;await _0x3b324e(_0x51d6b4[_0xf27c6b(0x18f)](__dirname,_0xf27c6b(0x199),'slip.zip'),_0x1e3371[_0xf27c6b(0x194)]);},{'message':/Refusing/});}),_0xece5bb[_0xe369ad(0x1b5)](_0xe369ad(0x19c),async _0x395dc6=>{const _0xa00d9a=_0xe369ad,_0x235129={'vypTL':_0xa00d9a(0x199),'vMDVB':'dist'};await _0x395dc6[_0xa00d9a(0x1b7)](async()=>{const _0x527c54=_0xa00d9a;await _0x3b324e(_0x51d6b4['join'](__dirname,_0x235129['vypTL'],_0x527c54(0x18e)),_0x235129['vMDVB']);},{'message':/Refusing/});}),_0xece5bb[_0xe369ad(0x1b5)](_0xe369ad(0x1a6),async _0x868107=>{const _0x19ed7a=_0xe369ad,_0x3217fa={'rxcxv':function(_0x576a46,_0x574106,_0x592860){return _0x576a46(_0x574106,_0x592860);},'sDaXF':_0x19ed7a(0x199)};await _0x868107['throwsAsync'](async()=>{const _0x16b39d=_0x19ed7a;await _0x3217fa[_0x16b39d(0x174)](_0x3b324e,_0x51d6b4['join'](__dirname,_0x3217fa[_0x16b39d(0x197)],'slipping_directory.tar.gz'),_0x16b39d(0x1c3));},{'message':/Refusing/});}),_0xece5bb[_0xe369ad(0x1b5)]('allows\x20filenames\x20and\x20directories\x20to\x20be\x20written\x20with\x20dots\x20in\x20their\x20names',async _0x4240a6=>{const _0x2bcb99=_0xe369ad,_0x335a3c={'pcRZy':function(_0x1ed541,_0x1fe031,_0x5a70cf){return _0x1ed541(_0x1fe031,_0x5a70cf);},'TQkTI':_0x2bcb99(0x1bf),'YxNzh':_0x2bcb99(0x1b2),'wJCoI':'edge_case_dots/sample../test.txt'},_0x92d646=await _0x335a3c[_0x2bcb99(0x1be)](_0x3b324e,_0x51d6b4['join'](__dirname,_0x2bcb99(0x199),_0x2bcb99(0x1b4)),__dirname);_0x4240a6['is'](_0x92d646[_0x2bcb99(0x1a8)],0x6),_0x4240a6[_0x2bcb99(0x1af)](_0x92d646[_0x2bcb99(0x163)](_0x211701=>_0x211701['path'])[_0x2bcb99(0x1b9)](),[_0x2bcb99(0x175),'edge_case_dots/internal_dots..txt',_0x335a3c[_0x2bcb99(0x187)],'edge_case_dots/ending_dots..',_0x335a3c[_0x2bcb99(0x17f)],_0x335a3c[_0x2bcb99(0x1a1)]]['sort']());}),_0xece5bb[_0xe369ad(0x1b5)](_0xe369ad(0x16f),async _0x5848f8=>{const _0x519530=_0xe369ad,_0x174c83={'xYQBu':function(_0x15cb99,_0x4d5593,_0x25dcf2){return _0x15cb99(_0x4d5593,_0x25dcf2);},'fdTTA':_0x519530(0x199),'EMNZw':_0x519530(0x1b0),'UAwzA':'example.txt'},_0x5546f4=await _0x174c83[_0x519530(0x1ae)](_0x3b324e,_0x51d6b4['join'](__dirname,_0x174c83['fdTTA'],_0x174c83['EMNZw']),_0x519530(0x1c3));_0x5848f8['is'](_0x5546f4[_0x519530(0x1a8)],0x1),_0x5848f8['is'](_0x5546f4[0x0][_0x519530(0x17c)],_0x174c83[_0x519530(0x18d)]);}),_0xece5bb[_0xe369ad(0x1b5)](_0xe369ad(0x171),async _0x24a698=>{const _0xb087a7=_0xe369ad,_0x5d45e8={'KbRKr':_0xb087a7(0x199)};await _0x24a698[_0xb087a7(0x1b7)](async()=>{const _0x3c0cbe=_0xb087a7;await _0x3b324e(_0x51d6b4[_0x3c0cbe(0x18f)](__dirname,_0x5d45e8[_0x3c0cbe(0x180)],_0x3c0cbe(0x17b)),_0x3c0cbe(0x1c2));},{'message':/Refusing/});}),_0xece5bb['serial'](_0xe369ad(0x1a0),async _0x2c77be=>{const _0x86f292=_0xe369ad,_0x528003={'joIWD':_0x86f292(0x199),'iZBcg':'slip3a.zip'};await _0x2c77be['throwsAsync'](async()=>{const _0x142c62=_0x86f292;await _0x3b324e(_0x51d6b4[_0x142c62(0x18f)](__dirname,_0x528003['joIWD'],_0x528003[_0x142c62(0x195)]),_0x142c62(0x181));},{'message':/Refusing/});});