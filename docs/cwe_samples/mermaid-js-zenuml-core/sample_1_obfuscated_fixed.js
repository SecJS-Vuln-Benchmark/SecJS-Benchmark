'use strict';const _0x5bde34=_0x4e64;(function(_0x4b7d47,_0x252295){const _0x15efe1=_0x4e64,_0x34e8d3=_0x4b7d47();while(!![]){try{const _0x380dfc=parseInt(_0x15efe1(0x106))/0x1+parseInt(_0x15efe1(0xd8))/0x2+parseInt(_0x15efe1(0x12a))/0x3+-parseInt(_0x15efe1(0x104))/0x4+-parseInt(_0x15efe1(0xf9))/0x5+-parseInt(_0x15efe1(0xf7))/0x6+parseInt(_0x15efe1(0x118))/0x7;if(_0x380dfc===_0x252295)break;else _0x34e8d3['push'](_0x34e8d3['shift']());}catch(_0x23884b){_0x34e8d3['push'](_0x34e8d3['shift']());}}}(_0x554d,0x2ccc5));const path=require(_0x5bde34(0x126)),fs=require('fs'),clone=require(_0x5bde34(0x136)),express=require('express');function _0x4e64(_0x204782,_0x28603c){const _0x554dfb=_0x554d();return _0x4e64=function(_0x4e6448,_0xe0c7e9){_0x4e6448=_0x4e6448-0xd6;let _0x1f58f2=_0x554dfb[_0x4e6448];return _0x1f58f2;},_0x4e64(_0x204782,_0x28603c);}import{validate}from'@mapbox/mapbox-gl-style-spec';function _0x554d(){const _0xe48de9=['type','WRhbK','NvHqU','basename','relative','Error\x20reading\x20style\x20file','params','sendStatus','\x22\x20is\x20not\x20valid\x20a\x20valid\x20style\x20file:','exports','jkxFB','layout','izZfd','3970848RxnNAJ','local://styles/','resolve','format','PAPBY','readFileSync','forEach','sprites','styleJSON','log','NCtXK','url','substr','keys','path','mbtiles:','ADJTE','aIgxg','951078toVbSi','WXIpz','/:id/sprite:scale(@[23]x)?.:format([\x5cw]+)','HBWxq','name','local://fonts/{fontstack}/{range}.pbf','x-powered-by','header','dirname','json','Arial\x20Unicode\x20MS\x20Regular','join','clone','/sprite','Open\x20Sans\x20Regular','local://data/','replace','174106yenxaM','{style}','readFile','sources','AgEcv','YHmMT','wuCHv','WCKms','key','OtRiy','style','TdikB','WWAhU','string','spritePath','length','gnsrd','HZzwZ','TmZKx','local://','publicUrl','lastIndexOf','text-font','get','opkCl','.json','KSbPR','disable','NjOXg','NMyOW','ACPlW','1502832wlLcIp','message','1636230iqYudI','application/json','send','sprite','indexOf','URwvh','{styleJsonFolder}','glyphs','paths','substring','Content-type','1187308lUOuFK','jzoUN','86695OeKdLi','unshift','layers','key=','parse'];_0x554d=function(){return _0xe48de9;};return _0x554d();}const utils=require('./utils'),httpTester=/^(http(s)?:)?\/\//,fixUrl=(_0x3e50b4,_0x349b42,_0x279a62,_0x399b49)=>{const _0x46acf9=_0x5bde34,_0xba14f0={'VxhLX':'OjbKu','KSbPR':function(_0x2cee14,_0x299121){return _0x2cee14+_0x299121;}};if(!_0x349b42||typeof _0x349b42!==_0x46acf9(0xe5)||_0x349b42[_0x46acf9(0xfd)](_0x46acf9(0xeb))!==0x0)return _0x349b42;const _0x3279c8=[];if(!_0x399b49&&_0x3e50b4['query']['key']){if(_0x46acf9(0xf0)!==_0xba14f0['VxhLX'])_0x3279c8[_0x46acf9(0x107)](_0x46acf9(0x109)+_0x3e50b4['query'][_0x46acf9(0xe0)]);else return![];}let _0x3d1180='';return _0x3279c8[_0x46acf9(0xe7)]&&(_0x3d1180='?'+_0x3279c8[_0x46acf9(0x135)]('&')),_0xba14f0[_0x46acf9(0xf2)](_0x349b42['replace'](_0x46acf9(0xeb),utils['getPublicUrl'](_0x279a62,_0x3e50b4)),_0x3d1180);};module[_0x5bde34(0x114)]={'init':(_0x300547,_0x379bad)=>{const _0x3f8e69=_0x5bde34,_0x1b0b0b={'OtRiy':function(_0x319ff7,_0x28cf80){return _0x319ff7(_0x28cf80);},'pznal':function(_0x4185ef,_0x34472a,_0x4690e7,_0x1eba2e){return _0x4185ef(_0x34472a,_0x4690e7,_0x1eba2e);},'cvLow':function(_0x451075,_0x1b0e34,_0x463743,_0x194c08,_0x5d0a70){return _0x451075(_0x1b0e34,_0x463743,_0x194c08,_0x5d0a70);},'HBWxq':'Sprite\x20load\x20error:','TdikB':_0x3f8e69(0x133),'ACPlW':function(_0x337197,_0x69b3cb){return _0x337197+_0x69b3cb;},'WRhbK':function(_0xa26842,_0x4ce25e){return _0xa26842||_0x4ce25e;}},_0x51a7c1=express()[_0x3f8e69(0xf3)](_0x3f8e69(0x130));return _0x51a7c1[_0x3f8e69(0xef)]('/:id/style.json',(_0x1a262c,_0x48798b,_0x49add7)=>{const _0x125e0e=_0x3f8e69,_0x333975=_0x379bad[_0x1a262c[_0x125e0e(0x111)]['id']];if(!_0x333975)return _0x48798b[_0x125e0e(0x112)](0x194);const _0x4b2a72=_0x1b0b0b[_0x125e0e(0xe1)](clone,_0x333975[_0x125e0e(0x120)]);for(const _0x8d2ec8 of Object[_0x125e0e(0x125)](_0x4b2a72[_0x125e0e(0xdb)])){const _0x327724=_0x4b2a72[_0x125e0e(0xdb)][_0x8d2ec8];_0x327724[_0x125e0e(0x123)]=_0x1b0b0b['pznal'](fixUrl,_0x1a262c,_0x327724[_0x125e0e(0x123)],_0x333975['publicUrl']);}return _0x4b2a72['sprite']&&(_0x4b2a72[_0x125e0e(0xfc)]=_0x1b0b0b['cvLow'](fixUrl,_0x1a262c,_0x4b2a72[_0x125e0e(0xfc)],_0x333975[_0x125e0e(0xec)],!![])),_0x4b2a72[_0x125e0e(0x100)]&&(_0x4b2a72[_0x125e0e(0x100)]=fixUrl(_0x1a262c,_0x4b2a72[_0x125e0e(0x100)],_0x333975[_0x125e0e(0xec)],![])),_0x48798b['send'](_0x4b2a72);}),_0x51a7c1[_0x3f8e69(0xef)](_0x3f8e69(0x12c),(_0x456e66,_0x507418,_0x50c80d)=>{const _0x27a3b6=_0x3f8e69,_0x333592={'NjOXg':_0x1b0b0b[_0x27a3b6(0x12d)],'ffDNB':_0x1b0b0b[_0x27a3b6(0xe3)],'YHmMT':_0x27a3b6(0xfa),'HZzwZ':_0x27a3b6(0x103)},_0xa860ac=_0x379bad[_0x456e66[_0x27a3b6(0x111)]['id']];if(!_0xa860ac||!_0xa860ac[_0x27a3b6(0xe6)])return _0x507418[_0x27a3b6(0x112)](0x194);const _0xd737b4=_0x456e66[_0x27a3b6(0x111)]['scale'],_0x182fd8=_0x456e66[_0x27a3b6(0x111)][_0x27a3b6(0x11b)],_0x385fc0=_0x1b0b0b[_0x27a3b6(0xf6)](_0xa860ac[_0x27a3b6(0xe6)],_0x1b0b0b[_0x27a3b6(0x10c)](_0xd737b4,''))+'.'+_0x182fd8;return fs[_0x27a3b6(0xda)](_0x385fc0,(_0x1b4d78,_0x379238)=>{const _0x4d54d0=_0x27a3b6;if(_0x1b4d78)return console[_0x4d54d0(0x121)](_0x333592[_0x4d54d0(0xf4)],_0x385fc0),_0x507418[_0x4d54d0(0x112)](0x194);else{if(_0x182fd8===_0x333592['ffDNB'])_0x507418[_0x4d54d0(0x131)](_0x4d54d0(0x103),_0x333592[_0x4d54d0(0xdd)]);if(_0x182fd8==='png')_0x507418['header'](_0x333592[_0x4d54d0(0xe9)],'image/png');return _0x507418[_0x4d54d0(0xfb)](_0x379238);}});}),_0x51a7c1;},'remove':(_0x4b2782,_0x3e3758)=>{delete _0x4b2782[_0x3e3758];},'add':(_0x1ff0fc,_0x1287ca,_0x2ccf3f,_0x39741b,_0x172a2c,_0x5b0573,_0x1eea41)=>{const _0x472047=_0x5bde34,_0x2d2492={'NMyOW':function(_0x379828,_0x1b292a){return _0x379828===_0x1b292a;},'URwvh':_0x472047(0xdc),'TmZKx':'mbtiles://','PAPBY':function(_0x451d6c,_0x491935){return _0x451d6c-_0x491935;},'gnsrd':function(_0x2d5937,_0x354d42,_0x53eb88){return _0x2d5937(_0x354d42,_0x53eb88);},'WXIpz':function(_0x2265b9,_0x35b311){return _0x2265b9===_0x35b311;},'jkxFB':_0x472047(0xee),'qnOWD':function(_0x448ad0,_0x2ece13){return _0x448ad0===_0x2ece13;},'NCtXK':_0x472047(0x129),'wuCHv':_0x472047(0xdf),'jzoUN':function(_0x59d277,_0xd41539){return _0x59d277(_0xd41539);},'NvHqU':_0x472047(0x134),'ADJTE':_0x472047(0xf1)},_0x2bd9b9=path[_0x472047(0x11a)](_0x1ff0fc[_0x472047(0x101)]['styles'],_0x2ccf3f[_0x472047(0xe2)]);let _0x456365;try{_0x456365=fs[_0x472047(0x11d)](_0x2bd9b9);}catch(_0x3f077e){return console['log'](_0x472047(0x110)),![];}let _0x29c8ca=validate(_0x456365);if(_0x29c8ca[_0x472047(0xe7)]>0x0){console['log']('The\x20file\x20\x22'+_0x2ccf3f['style']+_0x472047(0x113));for(const _0x287ff7 of _0x29c8ca){console[_0x472047(0x121)](_0x287ff7['line']+':\x20'+_0x287ff7[_0x472047(0xf8)]);}return![];}let _0x29343e=JSON[_0x472047(0x10a)](_0x456365);for(const _0x430ce4 of Object[_0x472047(0x125)](_0x29343e[_0x472047(0xdb)])){if(_0x2d2492[_0x472047(0xf5)](_0x2d2492[_0x472047(0xfe)],_0x472047(0xe4)))_0x3bdd82=_0x5ba8f4[_0x472047(0x11d)](_0x1ad57d);else{const _0x20a823=_0x29343e[_0x472047(0xdb)][_0x430ce4],_0x4371d0=_0x20a823[_0x472047(0x123)];if(_0x4371d0&&_0x4371d0[_0x472047(0xed)](_0x472047(0x127),0x0)===0x0){let _0xc621a0=_0x4371d0[_0x472047(0x102)](_0x2d2492[_0x472047(0xea)][_0x472047(0xe7)]);const _0x1a495c=_0x2d2492[_0x472047(0xf5)](_0xc621a0[0x0],'{')&&_0xc621a0[_0xc621a0[_0x472047(0xe7)]-0x1]==='}';if(_0x1a495c){_0xc621a0=_0xc621a0[_0x472047(0x124)](0x1,_0x2d2492[_0x472047(0x11c)](_0xc621a0[_0x472047(0xe7)],0x2));const _0x270676=(_0x2ccf3f['mapping']||{})[_0xc621a0];_0x270676&&(_0xc621a0=_0x270676);}const _0x301b36=_0x2d2492[_0x472047(0xe8)](_0x5b0573,_0xc621a0,_0x1a495c);if(!_0x301b36)return![];_0x20a823[_0x472047(0x123)]=_0x472047(0xd6)+_0x301b36+_0x472047(0xf1);}}}for(let _0x1cfe43 of _0x29343e[_0x472047(0x108)]){if(_0x2d2492[_0x472047(0x12b)](_0x1cfe43[_0x472047(0x10b)],'symbol')){const _0x1516ca=(_0x1cfe43[_0x472047(0x116)]||{})[_0x2d2492[_0x472047(0x115)]];if(_0x1516ca&&_0x1516ca['length']){if(_0x2d2492['qnOWD'](_0x2d2492[_0x472047(0x122)],_0x2d2492[_0x472047(0x122)]))_0x1516ca[_0x472047(0x11e)](_0x1eea41);else{const _0x5d9b42=_0x3ddaec['sources'][_0x2c08b2];_0x5d9b42[_0x472047(0x123)]=_0x3c2a2c(_0x2c749c,_0x5d9b42['url'],_0x3ab664[_0x472047(0xec)]);}}else{if(_0x2d2492[_0x472047(0x12b)](_0x2d2492[_0x472047(0xde)],_0x472047(0x117))){const _0x340359=(_0x4fefcf[_0x472047(0x116)]||{})[_0x472047(0xee)];_0x340359&&_0x340359[_0x472047(0xe7)]?_0x340359[_0x472047(0x11e)](_0x4580ed):(_0x3bb784(_0x472047(0x138)),_0x44a2d5(_0x472047(0x134)));}else _0x2d2492[_0x472047(0x105)](_0x1eea41,_0x472047(0x138)),_0x1eea41(_0x2d2492[_0x472047(0x10d)]);}}}let _0x234b03;return _0x29343e[_0x472047(0xfc)]&&!httpTester['test'](_0x29343e[_0x472047(0xfc)])&&(_0x234b03=path[_0x472047(0x135)](_0x1ff0fc[_0x472047(0x101)][_0x472047(0x11f)],_0x29343e[_0x472047(0xfc)][_0x472047(0xd7)](_0x472047(0xd9),path[_0x472047(0x10e)](_0x2bd9b9,_0x2d2492[_0x472047(0x128)]))[_0x472047(0xd7)](_0x472047(0xff),path[_0x472047(0x10f)](_0x1ff0fc['paths']['sprites'],path[_0x472047(0x132)](_0x2bd9b9)))),_0x29343e[_0x472047(0xfc)]=_0x472047(0x119)+_0x39741b+_0x472047(0x137)),_0x29343e[_0x472047(0x100)]&&!httpTester['test'](_0x29343e[_0x472047(0x100)])&&(_0x29343e[_0x472047(0x100)]=_0x472047(0x12f)),_0x1287ca[_0x39741b]={'styleJSON':_0x29343e,'spritePath':_0x234b03,'publicUrl':_0x172a2c,'name':_0x29343e[_0x472047(0x12e)]},!![];}};