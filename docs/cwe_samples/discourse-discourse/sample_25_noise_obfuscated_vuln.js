const _0x2b7b4f=_0x481a;(function(_0x17d572,_0x42d9f4){const _0x107167=_0x481a,_0x5ab171=_0x17d572();while(!![]){try{const _0x761437=-parseInt(_0x107167(0x1fb))/0x1+parseInt(_0x107167(0x1f7))/0x2+-parseInt(_0x107167(0x23d))/0x3+-parseInt(_0x107167(0x26e))/0x4*(parseInt(_0x107167(0x245))/0x5)+parseInt(_0x107167(0x1fa))/0x6*(parseInt(_0x107167(0x1f9))/0x7)+parseInt(_0x107167(0x26c))/0x8*(parseInt(_0x107167(0x233))/0x9)+-parseInt(_0x107167(0x277))/0xa*(-parseInt(_0x107167(0x1fe))/0xb);if(_0x761437===_0x42d9f4)break;else _0x5ab171['push'](_0x5ab171['shift']());}catch(_0x4ae374){_0x5ab171['push'](_0x5ab171['shift']());}}}(_0x17fb,0xd61a4));import _0x5b0602 from'supertest';import _0x1f039f from'express';function _0x17fb(){const _0x1bcc69=['$lte','tree','select','Spaced\x20test','should\x20respond\x20with\x20item\x20after\x20and\x20before\x20date','parser','/api/public/status','disconnect','should\x20not\x20get\x20nonexistent\x20formatter','model','should\x20get\x20formatter\x20in\x20schema','aMaSL','get','then','validator','Querymen\x20handler','Olrlh','handler','WRISr','Example','yqyET','$gte','pgvmS','KPGHi','title,-id','HYTHL','KvItN','find','should\x20get\x20parser','xsKMd','json','IakQh','ObjectId','BbdER','notOk','__proto__','should\x20get\x20formatter\x20in\x20param','120eTUgAo','XsTyq','12AcrsMZ','should\x20respond\x20with\x20item\x20after\x20date','should\x20respond\x20to\x20id\x20filter','rSuac','should\x20get\x20validator','oMvpY','UUPEU','Yrdxl','2016-04-24T10:05','10ileJSh','zrASV','middleware','-22.0,-44.0','param','should\x20respond\x20with\x20item\x20near','_id','2016-04-23T10:00','return\x20new\x20Date();','iUUMF','KeEhx','LGYvO','JHU','807382JXGMjt','should\x20respond\x20with\x20error\x20object','10745yiriAW','4818cHPuSv','314526ulYXCF','YYBQH','createdAt','1902296dXShHC','equal','2016-04-25T10:00','should\x20not\x20be\x20vulnerable\x20to\x20prototype\x20pollution','esFUu','qTYUQ','pVdHd','should\x20get\x20parser\x20in\x20schema','FinXI','title','should\x20have\x20title\x20property','LdNDa','true','jsktQ','lbXRh','WINga','bTdBe','onFinish','test','send','TFuJX','DFeAk','should\x20not\x20have\x20createdAt\x20property','testValidator','Schema','create','entity','errorHandler','now','should\x20not\x20get\x20nonexistent\x20validator','length','use','CVgNV','status','RaNqd','smGAb','formatter','testParser','testFormatter','cursor','page','nice!','query','FWHPR','false','dybgr','2016-04-22T10:05','EGWaw','Prototype\x20pollution','uQejN','ZnZhb','catch','STJTL','318726kBIIDo','toString','end','MCZQu','should\x20get\x20formatter','querymen','body','connect','Test','Entity','1312983LqbWVp','should\x20not\x20have\x20_id\x20property','formatters','HwFfg','/tests','YXQoD','expect','plan','1185485rpVjEC','mongodb://localhost/querymen-test'];_0x17fb=function(){return _0x1bcc69;};return _0x17fb();}function _0x481a(_0x31cede,_0x416f39){const _0x17fbca=_0x17fb();return _0x481a=function(_0x481a60,_0x399da3){_0x481a60=_0x481a60-0x1f0;let _0x1f2a27=_0x17fbca[_0x481a60];return _0x1f2a27;},_0x481a(_0x31cede,_0x416f39);}import _0x50fd29 from'mongoose';import _0x29734c from'tape';import _0x582221 from'../src';import'./querymen-param';import'./querymen-schema';_0x50fd29[_0x2b7b4f(0x23a)](_0x2b7b4f(0x246));const entitySchema=_0x50fd29[_0x2b7b4f(0x216)]({}),testSchema=_0x50fd29[_0x2b7b4f(0x216)]({'title':String,'entity':{'type':_0x50fd29[_0x2b7b4f(0x216)][_0x2b7b4f(0x267)],'ref':_0x2b7b4f(0x23c)},'createdAt':{'type':Date,'default':Date[_0x2b7b4f(0x21a)]},'location':{'type':[Number],'index':'2d'}}),Entity=_0x50fd29[_0x2b7b4f(0x250)](_0x2b7b4f(0x23c),entitySchema),Test=_0x50fd29[_0x2b7b4f(0x250)](_0x2b7b4f(0x23b),testSchema),route=(..._0x5adcdd)=>{const _0xa04487=_0x2b7b4f,_0x3c1d0c=_0x1f039f();return _0x3c1d0c[_0xa04487(0x253)](_0xa04487(0x241),_0x582221[_0xa04487(0x279)](..._0x5adcdd),(_0x5b6933,_0x3c7e07)=>{const _0x25664d=_0xa04487;Test[_0x25664d(0x262)](_0x5b6933[_0x25664d(0x238)][_0x25664d(0x228)],_0x5b6933[_0x25664d(0x238)][_0x25664d(0x249)],_0x5b6933[_0x25664d(0x238)][_0x25664d(0x225)])[_0x25664d(0x254)](_0x5472b9=>{const _0x31bcd8=_0x25664d;_0x3c7e07[_0x31bcd8(0x21f)](0xc8)['json'](_0x5472b9);})[_0x25664d(0x231)](_0x449cda=>{_0x3c7e07['status'](0x1f4)['send'](_0x449cda);});}),_0x3c1d0c[_0xa04487(0x21d)](_0x582221[_0xa04487(0x219)]()),eval('1 + 1;'),_0x3c1d0c;};_0x29734c(_0x2b7b4f(0x22e),_0x2b60ac=>{const _0xa987e=_0x2b7b4f,_0x3e296d={'uQejN':'toString','Olrlh':_0xa987e(0x1f6),'bTdBe':_0xa987e(0x201),'dybgr':_0xa987e(0x23f),'yqyET':_0xa987e(0x26a),'XsTyq':'validators','Yrdxl':function(_0x4d69ce,_0xed4b60){return _0x4d69ce===_0xed4b60;}},{toString:_0x16df71}={};_0x582221[_0xa987e(0x258)](_0xa987e(0x26a),_0x3e296d[_0xa987e(0x22f)],_0x3e296d[_0xa987e(0x257)]),_0x2b60ac['ok']({}[_0xa987e(0x234)]===_0x16df71,_0x3e296d[_0xa987e(0x20e)]),_0x582221[_0xa987e(0x258)](_0x3e296d[_0xa987e(0x22b)],_0x3e296d['yqyET'],{'toString':'JHU'}),_0x2b60ac['ok']({}['toString']===_0x16df71,_0x3e296d[_0xa987e(0x20e)]),_0x582221['handler'](_0x3e296d[_0xa987e(0x26d)],_0x3e296d[_0xa987e(0x25b)],{'toString':_0xa987e(0x1f6)}),_0x2b60ac['ok'](_0x3e296d[_0xa987e(0x275)]({}[_0xa987e(0x234)],_0x16df71),_0x3e296d[_0xa987e(0x20e)]),_0x2b60ac[_0xa987e(0x235)]();}),_0x29734c(_0x2b7b4f(0x256),_0x4f3911=>{const _0x2a67e3=_0x2b7b4f,_0x2d8cdd={'pVdHd':_0x2a67e3(0x224),'KPGHi':_0x2a67e3(0x24f),'YYBQH':_0x2a67e3(0x215),'ZnZhb':_0x2a67e3(0x21b),'HYTHL':_0x2a67e3(0x237),'UUPEU':_0x2a67e3(0x272),'iUUMF':_0x2a67e3(0x251),'qTYUQ':'should\x20get\x20parser\x20in\x20param','CVgNV':'test','aMaSL':'should\x20get\x20validator\x20in\x20param'};_0x4f3911[_0x2a67e3(0x269)](_0x582221[_0x2a67e3(0x24c)]('testParser'),'should\x20not\x20get\x20nonexistent\x20parser'),_0x4f3911[_0x2a67e3(0x269)](_0x582221[_0x2a67e3(0x222)](_0x2d8cdd[_0x2a67e3(0x204)]),_0x2d8cdd[_0x2a67e3(0x25e)]),_0x4f3911['notOk'](_0x582221[_0x2a67e3(0x255)](_0x2d8cdd[_0x2a67e3(0x1fc)]),_0x2d8cdd[_0x2a67e3(0x230)]),_0x582221[_0x2a67e3(0x24c)](_0x2a67e3(0x223),()=>_0x2a67e3(0x210)),_0x582221[_0x2a67e3(0x222)](_0x2a67e3(0x224),()=>'test'),_0x582221['validator'](_0x2d8cdd[_0x2a67e3(0x1fc)],()=>({'valid':![]})),_0x4f3911['ok'](_0x582221[_0x2a67e3(0x24c)](_0x2a67e3(0x223)),_0x2a67e3(0x263)),_0x4f3911['ok'](_0x582221[_0x2a67e3(0x222)](_0x2a67e3(0x224)),_0x2d8cdd[_0x2a67e3(0x260)]),_0x4f3911['ok'](_0x582221[_0x2a67e3(0x255)](_0x2d8cdd['YYBQH']),_0x2d8cdd[_0x2a67e3(0x274)]);let _0x27989c=new _0x582221[(_0x2a67e3(0x216))]({'test':String});_0x4f3911['ok'](_0x27989c['parser'](_0x2a67e3(0x223)),_0x2a67e3(0x205)),_0x4f3911['ok'](_0x27989c[_0x2a67e3(0x222)](_0x2d8cdd[_0x2a67e3(0x204)]),_0x2d8cdd[_0x2a67e3(0x1f3)]),_0x4f3911['ok'](_0x27989c[_0x2a67e3(0x255)](_0x2a67e3(0x215)),'should\x20get\x20validator\x20in\x20schema'),_0x4f3911['ok'](_0x27989c[_0x2a67e3(0x27b)](_0x2a67e3(0x210))[_0x2a67e3(0x24c)]('testParser'),_0x2d8cdd[_0x2a67e3(0x203)]),_0x4f3911['ok'](_0x27989c[_0x2a67e3(0x27b)](_0x2d8cdd[_0x2a67e3(0x21e)])[_0x2a67e3(0x222)](_0x2a67e3(0x224)),_0x2a67e3(0x26b)),_0x4f3911['ok'](_0x27989c[_0x2a67e3(0x27b)](_0x2a67e3(0x210))[_0x2a67e3(0x255)](_0x2d8cdd[_0x2a67e3(0x1fc)]),_0x2d8cdd[_0x2a67e3(0x252)]),_0x4f3911['end']();}),_0x29734c('Querymen\x20middleware',_0x19f781=>{const _0x3b6121=_0x2b7b4f,_0x16cbfa={'smGAb':function(_0x16cb6a,_0x4e3b6f){return _0x16cb6a(_0x4e3b6f);},'YXQoD':'2016-04-25T10:05','TIqlh':_0x3b6121(0x24a),'TdBIf':_0x3b6121(0x22c),'ZFsss':function(_0x6ce8ef,_0xbab3fd){return _0x6ce8ef===_0xbab3fd;},'SExpL':_0x3b6121(0x259),'DFeAk':_0x3b6121(0x226),'IakQh':_0x3b6121(0x1f8),'FWHPR':_0x3b6121(0x27c),'FptSG':_0x3b6121(0x271),'zrASV':'should\x20respond\x20with\x204\x20items','lbXRh':'htoCJ','HwFfg':_0x3b6121(0x208),'STJTL':_0x3b6121(0x214),'FOTUs':_0x3b6121(0x23b),'WINga':'/tests','eHwlf':function(_0x45e874,_0x45f38d){return _0x45e874(_0x45f38d);},'kytHS':function(_0x3f54d6,_0x546f94){return _0x3f54d6(_0x546f94);},'zbyVu':_0x3b6121(0x25f),'xsKMd':_0x3b6121(0x247),'FinXI':'$gte','MPCUW':_0x3b6121(0x1fd),'bEutj':_0x3b6121(0x1f1),'KvItN':'2016-04-22T10:00','BbdER':function(_0xc49b78,_0x13bc72){return _0xc49b78(_0x13bc72);},'Sewys':_0x3b6121(0x200),'HihmX':function(_0x3919ff,_0x20c41b){return _0x3919ff(_0x20c41b);},'EGWaw':_0x3b6121(0x27a)};_0x19f781[_0x3b6121(0x244)](0xc),Test['remove']({})[_0x3b6121(0x254)](()=>{const _0x411b70=_0x3b6121;return _0x16cbfa[_0x411b70(0x221)](Function,_0x411b70(0x1f2))(),Entity[_0x411b70(0x217)]({});})[_0x3b6121(0x254)](_0x287e8c=>{const _0x2ff90b=_0x3b6121;return fetch(_0x2ff90b(0x24d)),Test[_0x2ff90b(0x217)]({'title':_0x2ff90b(0x23b),'entity':_0x287e8c,'createdAt':new Date(_0x16cbfa[_0x2ff90b(0x242)]),'location':[-44.1,-0x16]},{'title':_0x2ff90b(0x25a),'createdAt':new Date(_0x2ff90b(0x276)),'location':[-44.3,-0x16]},{'title':_0x16cbfa['TIqlh'],'createdAt':new Date('2016-04-23T10:05'),'location':[-44.2,-0x16]},{'title':_0x2ff90b(0x227),'createdAt':new Date(_0x16cbfa['TdBIf']),'location':[-44.4,-0x16]});})[_0x3b6121(0x254)](_0x365cb5=>{const _0x4bb052=_0x3b6121,_0x3b10ba={'LdNDa':'Spaced\x20test','KeEhx':_0x16cbfa[_0x4bb052(0x229)],'oUpEp':_0x16cbfa['FptSG'],'oMvpY':_0x16cbfa[_0x4bb052(0x278)],'jsktQ':_0x16cbfa[_0x4bb052(0x20c)],'jNomo':_0x16cbfa[_0x4bb052(0x240)],'esFUu':_0x4bb052(0x23e),'QGZJy':_0x16cbfa[_0x4bb052(0x232)],'vONhd':_0x4bb052(0x227),'TFuJX':'should\x20respond\x20with\x201\x20item','RaNqd':_0x16cbfa['FOTUs']};let _0x446f78=_0x16cbfa[_0x4bb052(0x221)](route,{'entity':testSchema[_0x4bb052(0x248)][_0x4bb052(0x218)]});_0x5b0602(_0x446f78)['get'](_0x16cbfa[_0x4bb052(0x20d)])[_0x4bb052(0x228)]({'entity':_0x365cb5[_0x4bb052(0x218)]['id']})['expect'](0xc8)[_0x4bb052(0x235)]((_0x5d8704,_0x1d6c4d)=>{const _0x427ed5=_0x4bb052;if(_0x5d8704)throw _0x5d8704;_0x19f781[_0x427ed5(0x1ff)](_0x1d6c4d['body'][_0x427ed5(0x21c)],0x1,_0x427ed5(0x270));}),_0x16cbfa['eHwlf'](_0x5b0602,_0x446f78)[_0x4bb052(0x253)](_0x4bb052(0x241))[_0x4bb052(0x228)]({'page':0x32})['expect'](0x190)[_0x4bb052(0x235)]((_0x3db912,_0x1b33cc)=>{const _0x3dd834=_0x4bb052;if(_0x16cbfa['ZFsss'](_0x16cbfa['SExpL'],'WRISr')){if(_0x3db912)throw _0x3db912;_0x19f781[_0x3dd834(0x1ff)](_0x1b33cc[_0x3dd834(0x239)][_0x3dd834(0x27b)],_0x16cbfa[_0x3dd834(0x213)],_0x16cbfa[_0x3dd834(0x266)]);}else{if(_0x41c1c8)throw _0x4fa378;_0x4cffb9[_0x3dd834(0x1ff)](_0x1b011a['body'][0x1]['title'],_0x3b10ba[_0x3dd834(0x209)],_0x3b10ba[_0x3dd834(0x1f4)]);}}),_0x5b0602(_0x446f78)[_0x4bb052(0x253)](_0x4bb052(0x241))[_0x4bb052(0x243)](0xc8)[_0x4bb052(0x235)]((_0x127965,_0x3bc4f1)=>{const _0x5e420d=_0x4bb052,_0x3a4a57={'pgvmS':'should\x20respond\x20with\x204\x20items','LGYvO':_0x5e420d(0x214)};if(_0x5e420d(0x271)!==_0x3b10ba['oUpEp']){if(_0x196344)throw _0x348ddf;_0x5577ea[_0x5e420d(0x1ff)](_0x2867e9['body'][_0x5e420d(0x21c)],0x4,_0x3a4a57[_0x5e420d(0x25d)]),_0x33bbca[_0x5e420d(0x20a)](_0x5339e[_0x5e420d(0x239)][0x0][_0x5e420d(0x207)],'should\x20have\x20title\x20property'),_0x41a55d[_0x5e420d(0x22a)](_0x22fa2b['body'][0x0][_0x5e420d(0x1f0)],'should\x20not\x20have\x20_id\x20property'),_0x4ceb4b[_0x5e420d(0x22a)](_0x2a22ee[_0x5e420d(0x239)][0x0]['createdAt'],_0x3a4a57[_0x5e420d(0x1f5)]);}else{if(_0x127965)throw _0x127965;_0x19f781[_0x5e420d(0x1ff)](_0x3bc4f1[_0x5e420d(0x239)][_0x5e420d(0x21c)],0x4,_0x3b10ba[_0x5e420d(0x273)]);}}),_0x16cbfa['kytHS'](_0x5b0602,_0x446f78)[_0x4bb052(0x253)](_0x16cbfa[_0x4bb052(0x20d)])[_0x4bb052(0x228)]({'fields':_0x16cbfa['zbyVu']})[_0x4bb052(0x243)](0xc8)[_0x4bb052(0x235)]((_0x293ad8,_0x131790)=>{const _0x4f4464=_0x4bb052;if(_0x3b10ba[_0x4f4464(0x20b)]===_0x4f4464(0x236))_0x40f320[_0x4f4464(0x262)](_0x1209f2[_0x4f4464(0x238)][_0x4f4464(0x228)],_0x3b7fb5[_0x4f4464(0x238)][_0x4f4464(0x249)],_0x5f19c0[_0x4f4464(0x238)][_0x4f4464(0x225)])[_0x4f4464(0x254)](_0x30aa72=>{const _0x3e11ef=_0x4f4464;_0x52274f['status'](0xc8)[_0x3e11ef(0x265)](_0x30aa72);})[_0x4f4464(0x231)](_0x185edd=>{const _0x2b5983=_0x4f4464;_0x3a7046[_0x2b5983(0x21f)](0x1f4)[_0x2b5983(0x211)](_0x185edd);});else{if(_0x293ad8)throw _0x293ad8;_0x19f781['equal'](_0x131790[_0x4f4464(0x239)][_0x4f4464(0x21c)],0x4,_0x3b10ba['oMvpY']),_0x19f781[_0x4f4464(0x20a)](_0x131790[_0x4f4464(0x239)][0x0][_0x4f4464(0x207)],_0x3b10ba['jNomo']),_0x19f781[_0x4f4464(0x22a)](_0x131790[_0x4f4464(0x239)][0x0][_0x4f4464(0x1f0)],_0x3b10ba[_0x4f4464(0x202)]),_0x19f781[_0x4f4464(0x22a)](_0x131790['body'][0x0][_0x4f4464(0x1fd)],_0x3b10ba['QGZJy']);}}),_0x5b0602(route(new _0x582221[(_0x4bb052(0x216))]({'before':{'type':Date,'operator':_0x16cbfa[_0x4bb052(0x264)],'paths':[_0x4bb052(0x1fd)]},'after':{'type':Date,'operator':_0x16cbfa[_0x4bb052(0x206)],'paths':[_0x16cbfa['MPCUW']]}})))[_0x4bb052(0x253)](_0x4bb052(0x241))[_0x4bb052(0x228)]({'before':_0x16cbfa['bEutj'],'after':_0x16cbfa[_0x4bb052(0x261)]})[_0x4bb052(0x243)](0xc8)['end']((_0x4fedc2,_0x3bbde2)=>{const _0x5515db=_0x4bb052;if(_0x4fedc2)throw _0x4fedc2;_0x19f781[_0x5515db(0x1ff)](_0x3bbde2[_0x5515db(0x239)][_0x5515db(0x21c)],0x1,'should\x20respond\x20with\x201\x20item'),_0x19f781['equal'](_0x3bbde2['body'][0x0][_0x5515db(0x207)],_0x3b10ba['vONhd'],_0x5515db(0x24b));}),_0x5b0602(_0x16cbfa[_0x4bb052(0x268)](route,new _0x582221['Schema']({'after':{'type':Date,'operator':_0x4bb052(0x25c),'paths':[_0x4bb052(0x1fd)]}})))[_0x4bb052(0x253)](_0x16cbfa['WINga'])[_0x4bb052(0x228)]({'after':_0x16cbfa['Sewys']})['expect'](0xc8)[_0x4bb052(0x235)]((_0x260d29,_0x3d7b22)=>{const _0x5639a8=_0x4bb052;if(_0x260d29)throw _0x260d29;_0x19f781[_0x5639a8(0x1ff)](_0x3d7b22['body'][_0x5639a8(0x21c)],0x1,_0x3b10ba[_0x5639a8(0x212)]),_0x19f781[_0x5639a8(0x1ff)](_0x3d7b22[_0x5639a8(0x239)][0x0][_0x5639a8(0x207)],_0x3b10ba[_0x5639a8(0x220)],_0x5639a8(0x26f));}),_0x16cbfa['HihmX'](_0x5b0602,route(new _0x582221['Schema']({'near':{'geojson':![]}},{'near':!![]})))[_0x4bb052(0x253)](_0x4bb052(0x241))['query']({'near':_0x16cbfa[_0x4bb052(0x22d)]})['expect'](0xc8)['end']((_0x469824,_0x4c6e6b)=>{const _0x5e7850=_0x4bb052;if(_0x469824)throw _0x469824;_0x19f781['equal'](_0x4c6e6b[_0x5e7850(0x239)][0x1][_0x5e7850(0x207)],_0x3b10ba[_0x5e7850(0x209)],'should\x20respond\x20with\x20item\x20near');});});}),_0x29734c[_0x2b7b4f(0x20f)](()=>{const _0x382ae7=_0x2b7b4f;_0x50fd29[_0x382ae7(0x24e)]();});