const _0x473512=_0x3845;(function(_0xacd7e3,_0x28366c){const _0x59b671=_0x3845,_0x2dc005=_0xacd7e3();while(!![]){try{const _0x3b1810=-parseInt(_0x59b671(0x125))/0x1+-parseInt(_0x59b671(0x107))/0x2+parseInt(_0x59b671(0xe2))/0x3+parseInt(_0x59b671(0xce))/0x4+-parseInt(_0x59b671(0x12a))/0x5*(-parseInt(_0x59b671(0xff))/0x6)+-parseInt(_0x59b671(0xd9))/0x7*(parseInt(_0x59b671(0x112))/0x8)+parseInt(_0x59b671(0xca))/0x9*(-parseInt(_0x59b671(0xcc))/0xa);if(_0x3b1810===_0x28366c)break;else _0x2dc005['push'](_0x2dc005['shift']());}catch(_0x34067a){_0x2dc005['push'](_0x2dc005['shift']());}}}(_0x42a5,0x51268));const path=require(_0x473512(0x11a)),crypto=require('crypto'),{Capabilities,EModelEndpoint,isAgentsEndpoint,AgentCapabilities,isAssistantsEndpoint,defaultRetrievalModels,defaultAssistantsVersion}=require(_0x473512(0x127)),{Providers}=require(_0x473512(0xfe)),{getCitations,citeText}=require('./citations'),partialRight=require('lodash/partialRight'),{sendMessage}=require(_0x473512(0xd4)),citationRegex=/\[\^\d+?\^]/g,addSpaceIfNeeded=_0x5d347f=>_0x5d347f['length']>0x0&&!_0x5d347f[_0x473512(0x128)]('\x20')?_0x5d347f+'\x20':_0x5d347f,base={'message':!![],'initial':!![]},createOnProgress=({generation:generation='',onProgress:_0x2672ec})=>{const _0xc4dbc=_0x473512,_0x89694e={'pDQqN':function(_0x493b30,_0x30f194){return _0x493b30+_0x30f194;},'DYxRn':function(_0x53b0e9,_0x4cc010,_0x33f3f8){return _0x53b0e9(_0x4cc010,_0x33f3f8);},'kZyoi':function(_0xbe0343,_0x444222){return _0xbe0343===_0x444222;},'SVEwt':function(_0x53730c,_0x274506){return _0x53730c!==_0x274506;},'VNWhN':_0xc4dbc(0x108),'bqHNI':function(_0x4047ad,_0x154e70,_0x5bdd31){return _0x4047ad(_0x154e70,_0x5bdd31);},'YBMBY':function(_0x111e3f,_0x5584fb){return _0x111e3f(_0x5584fb);},'wXoEO':function(_0x684f13,_0x159551){return _0x684f13>_0x159551;},'SLPyc':function(_0x172843,_0x2057d1){return _0x172843!==_0x2057d1;},'zBRcK':'KOnRY','qTEJP':function(_0x47b9e7,_0x10d7bb){return _0x47b9e7(_0x10d7bb);}};let _0x1a8e3c=0x0,_0x49cbf=_0x89694e['qTEJP'](addSpaceIfNeeded,generation);const _0x495ac7=Object['assign']({},base,{'text':_0x49cbf||''}),_0x5aee0b=(_0x16e171,{res:_0x84a6e,..._0x4f8bd4})=>{const _0x3c65ba=_0xc4dbc;_0x495ac7['text']=_0x89694e[_0x3c65ba(0xdd)](_0x495ac7['text'],_0x16e171);const _0xe99476=Object[_0x3c65ba(0xd5)]({},_0x495ac7,_0x4f8bd4);_0x89694e[_0x3c65ba(0xf8)](sendMessage,_0x84a6e,_0xe99476);_0x2672ec&&_0x2672ec(_0xe99476);if(_0x89694e[_0x3c65ba(0xda)](_0x1a8e3c,0x0)){if(_0x89694e[_0x3c65ba(0x12e)]('dVWNE',_0x89694e[_0x3c65ba(0xe8)]))return _0x442dc2(_0x34ffa5,_0x37da19);else _0x495ac7['initial']=![];}_0x1a8e3c++;},_0xdd9d12=(_0x3f45d4,_0x5dca5c,_0x1296aa='')=>{const _0xf9ac1e=_0xc4dbc,_0x4eeb83={'XPgDn':function(_0x19506f,_0x5a9538){return _0x19506f(_0x5a9538);}};if('ZQILy'===_0xf9ac1e(0xe6)){const _0x455131=_0x4eeb83[_0xf9ac1e(0x114)](_0x172609,_0x4e74b0);_0x1e532b['text'][_0xf9ac1e(0x10d)](_0x2cd3cd)?.['length']>0x0&&(_0x182090=_0x359f0f(_0x5c377a)),_0x4e82a5+=_0x455131?.['length']>0x0?'\x0a-\x20'+_0x455131:'';}else{_0x495ac7['text']=_0x495ac7[_0xf9ac1e(0xfa)]+_0x1296aa;const _0x30e787=Object[_0xf9ac1e(0xd5)]({},_0x495ac7,_0x5dca5c);_0x89694e[_0xf9ac1e(0xf8)](sendMessage,_0x3f45d4,_0x30e787),_0x1a8e3c===0x0&&(_0x495ac7[_0xf9ac1e(0x11c)]=![]),_0x1a8e3c++;}},_0x159360=_0x3d3095=>{const _0x5f985a=_0xc4dbc;return _0x89694e[_0x5f985a(0xe3)](partialRight,_0x5aee0b,_0x3d3095);},_0x2a738d=()=>{const _0x503607=_0xc4dbc,_0x2a9054={'EbsFe':function(_0x59e31d,_0x4f22ae){return _0x89694e['YBMBY'](_0x59e31d,_0x4f22ae);},'Opgvz':function(_0xb2feb9,_0x3816c4){const _0x33aa13=_0x3845;return _0x89694e[_0x33aa13(0x124)](_0xb2feb9,_0x3816c4);}};if(_0x89694e[_0x503607(0xeb)](_0x89694e[_0x503607(0x119)],_0x503607(0xf9))){let {text:_0x5db626}=_0x2b6576;_0x508d9c['text']=_0x5db626;if(_0x178ea2){const _0x1ac776=_0x2a9054[_0x503607(0xd0)](_0x5567a3,_0x3c7ffd);_0x2a9054[_0x503607(0xde)](_0x36d702[_0x503607(0xfa)]['match'](_0x3157bf)?.['length'],0x0)&&(_0x5db626=_0x2a9054[_0x503607(0xd0)](_0x2ce475,_0x93d969)),_0x5db626+=_0x1ac776?.[_0x503607(0xef)]>0x0?_0x503607(0xc7)+_0x1ac776:'';}return _0x5db626;}else return _0x495ac7['text'];};return{'onProgress':_0x159360,'getPartialText':_0x2a738d,'sendIntermediateMessage':_0xdd9d12};},handleText=async(_0x5d8690,_0x4c3910=![])=>{const _0x2e40e0=_0x473512,_0x231702={'uoauO':_0x2e40e0(0x11d),'pCmPd':function(_0x279a26,_0x5caebf){return _0x279a26(_0x5caebf);},'KqHRm':function(_0x3c1ea4,_0x4c51a2){return _0x3c1ea4>_0x4c51a2;},'VEILh':function(_0x596d3a,_0x40facb){return _0x596d3a>_0x40facb;}};let {text:_0x388f09}=_0x5d8690;_0x5d8690['text']=_0x388f09;if(_0x4c3910){if(_0x2e40e0(0x11d)!==_0x231702[_0x2e40e0(0xdb)])_0x3a1258['retrievalModels']=_0x269d61,_0x36718e['capabilities']=[_0x2cef97['code_interpreter'],_0x2088c3[_0x2e40e0(0x121)],_0x2301d7[_0x2e40e0(0xcb)],_0x3a85d8[_0x2e40e0(0xe7)],_0x5f0c17[_0x2e40e0(0xd3)]];else{const _0x2cdda1=_0x231702[_0x2e40e0(0x12f)](getCitations,_0x5d8690);_0x231702['KqHRm'](_0x5d8690[_0x2e40e0(0xfa)][_0x2e40e0(0x10d)](citationRegex)?.[_0x2e40e0(0xef)],0x0)&&(_0x388f09=citeText(_0x5d8690)),_0x388f09+=_0x231702[_0x2e40e0(0x118)](_0x2cdda1?.['length'],0x0)?_0x2e40e0(0xc7)+_0x2cdda1:'';}}return _0x388f09;},isObject=_0x3d2ac3=>_0x3d2ac3&&typeof _0x3d2ac3===_0x473512(0xdf)&&!Array['isArray'](_0x3d2ac3),getString=_0xc91db5=>isObject(_0xc91db5)?JSON['stringify'](_0xc91db5):_0xc91db5;function _0x3845(_0x26e805,_0x2b41cf){const _0x42a5f9=_0x42a5();return _0x3845=function(_0x3845b3,_0x553eab){_0x3845b3=_0x3845b3-0xc6;let _0x62735b=_0x42a5f9[_0x3845b3];return _0x62735b;},_0x3845(_0x26e805,_0x2b41cf);}function formatSteps(_0x24f671){const _0x76646d=_0x473512,_0x3a0472={'wIBQi':function(_0x4a89b7,_0x53dd09){return _0x4a89b7===_0x53dd09;},'ehpUx':'N/A','auTJg':function(_0x1ac630,_0x142f8e){return _0x1ac630===_0x142f8e;},'jNeRZ':function(_0x306ba9,_0x27f569){return _0x306ba9>_0x27f569;},'ZFYja':function(_0x25f4fe,_0x3514e3){return _0x25f4fe!==_0x3514e3;},'MhDWO':function(_0x43a78c,_0x51ed16){return _0x43a78c-_0x51ed16;}};let _0x581d3d='';for(let _0x38b2af=0x0;_0x38b2af<_0x24f671[_0x76646d(0xef)];_0x38b2af++){const _0xed172c=_0x24f671[_0x38b2af],_0x3e74e4=getString(_0xed172c[_0x76646d(0xf3)]['toolInput']),_0x4a802f=_0xed172c[_0x76646d(0xfc)];if(_0x3a0472[_0x76646d(0xd8)](_0x3e74e4,_0x3a0472[_0x76646d(0xc6)])||_0x3a0472[_0x76646d(0x113)](_0x4a802f?.[_0x76646d(0xe4)]()?.['length'],0x0)){if(_0x76646d(0xe5)===_0x76646d(0xe5))continue;else _0x293318[_0x76646d(0x11c)]=![];}_0x581d3d+=_0x76646d(0x11e)+_0x3e74e4+_0x76646d(0x100)+getString(_0x4a802f),_0x3a0472[_0x76646d(0xf4)](_0x24f671[_0x76646d(0xef)],0x1)&&_0x3a0472[_0x76646d(0xec)](_0x38b2af,_0x3a0472[_0x76646d(0x115)](_0x24f671[_0x76646d(0xef)],0x1))&&(_0x581d3d+=_0x76646d(0x116));}return _0x581d3d;}function formatAction(_0x584659){const _0x1e1897=_0x473512,_0x3809a2={'bvrtJ':function(_0x1ac72a,_0x1649bd){return _0x1ac72a(_0x1649bd);},'BxCrd':function(_0x33965e,_0x49a3d2){return _0x33965e===_0x49a3d2;},'BnNgb':_0x1e1897(0x120),'KNoCC':'N/A','ZpPuk':function(_0x34bf94,_0x3470ed){return _0x34bf94+_0x3470ed;},'skhHX':'\x20-\x20','BRLPc':function(_0x32d5ff,_0x3fa250){return _0x32d5ff>_0x3fa250;}},_0x1e97bc={'plugin':_0x584659[_0x1e1897(0x101)],'input':_0x3809a2[_0x1e1897(0xc8)](getString,_0x584659[_0x1e1897(0x111)]),'thought':_0x584659[_0x1e1897(0x122)][_0x1e1897(0xd2)]('Thought:\x20')?_0x584659[_0x1e1897(0x122)][_0x1e1897(0xcf)]('\x0a')[0x0][_0x1e1897(0xc9)]('Thought:\x20',''):_0x584659[_0x1e1897(0x122)]['split']('\x0a')[0x0]};_0x1e97bc[_0x1e1897(0xd7)]=getString(_0x1e97bc[_0x1e1897(0xd7)]);if(_0x3809a2[_0x1e1897(0x10c)](_0x584659[_0x1e1897(0x101)][_0x1e1897(0x12c)](),_0x3809a2[_0x1e1897(0xd1)])||_0x3809a2[_0x1e1897(0x10c)](_0x1e97bc[_0x1e1897(0x129)],_0x3809a2[_0x1e1897(0x12d)]))_0x1e97bc[_0x1e1897(0xfb)]=_0x1e1897(0x123)+_0x1e97bc[_0x1e1897(0xf7)]+(!_0x1e97bc['thought'][_0x1e1897(0xd2)](_0x1e97bc['input'])?_0x3809a2['ZpPuk'](_0x3809a2[_0x1e1897(0xd6)],_0x1e97bc[_0x1e1897(0xd7)]):'')+'\x0a}',_0x1e97bc['inputStr']=_0x1e97bc['inputStr'][_0x1e1897(0xc9)](_0x1e1897(0xe1),'');else{const _0x5c0163=_0x3809a2['BRLPc'](_0x1e97bc[_0x1e1897(0xd7)][_0x1e1897(0xef)],0x0),_0x43d38a=_0x5c0163?_0x1e1897(0xea)+_0x1e97bc[_0x1e1897(0xd7)]:'';_0x1e97bc['inputStr']='{\x0a\x09plugin:\x20'+_0x1e97bc['plugin']+_0x1e1897(0x109)+_0x1e97bc['input']+'\x0a'+_0x43d38a+'}';}return _0x1e97bc;}function isEnabled(_0x2b07f6){const _0x56fe46=_0x473512,_0x5acda0={'uRLvd':function(_0x16a518,_0x481040){return _0x16a518===_0x481040;},'kIIel':_0x56fe46(0xf2),'CvOEK':function(_0x17c7a4,_0x577342){return _0x17c7a4===_0x577342;}};if(_0x5acda0[_0x56fe46(0xee)](typeof _0x2b07f6,_0x5acda0[_0x56fe46(0xcd)]))return _0x2b07f6;if(typeof _0x2b07f6==='string')return _0x5acda0['CvOEK'](_0x2b07f6[_0x56fe46(0x12c)]()[_0x56fe46(0xe4)](),_0x56fe46(0xe9));return![];}function _0x42a5(){const _0x1be6d9=['\x0a---\x0a','EXPERIMENTAL_RUN_CODE','VEILh','zBRcK','path','OLLAMA','initial','qBgwp','Input:\x20','fJjBg','self-reflection','image_vision','log','{\x0a\x09thought:\x20','wXoEO','655236LmkEfP','randomBytes','librechat-data-provider','endsWith','plugin','126185yRKJsL','file_search','toLowerCase','KNoCC','SVEwt','pCmPd','ehpUx','\x0a-\x20','bvrtJ','replace','3781971JzSQMe','retrieval','10sjpqNP','kIIel','2417708WrlTGx','split','EbsFe','BnNgb','includes','tools','./streamResponse','assign','skhHX','thought','wIBQi','7ZPIOPo','kZyoi','uoauO','version','pDQqN','Opgvz','object','push','N/A\x20-\x20','1340640OZIgMY','bqHNI','trim','ZHWBo','UuEvH','actions','VNWhN','true','\x0a\x09thought:\x20','SLPyc','ZFYja','PoHvW','uRLvd','length','basename','TKXgt','boolean','action','jNeRZ','exports','slice','input','DYxRn','KOnRY','text','inputStr','observation','toString','@librechat/agents','156qASNcg','\x0aOutput:\x20','tool','azureAssistants','user_provided','capabilities','oCvTD','hex','264440YqUiKX','dVWNE','\x0a\x09input:\x20','userProvideURL','extname','BxCrd','match','jQnWP','startsWith','code_interpreter','toolInput','1339216KkbqOc','auTJg','XPgDn','MhDWO'];_0x42a5=function(){return _0x1be6d9;};return _0x42a5();}const isUserProvided=_0xc1b045=>_0xc1b045===_0x473512(0x103);function generateConfig(_0x1a1edb,_0x168d34,_0x1d5463){const _0x42bca4=_0x473512,_0x242f9a={'fJjBg':function(_0x52ae10,_0x574fd2){return _0x52ae10(_0x574fd2);},'oaady':function(_0x2a3cf8,_0x27b553){return _0x2a3cf8(_0x27b553);},'GSlRA':function(_0x1605da,_0x1d1843){return _0x1605da(_0x1d1843);},'oCvTD':function(_0x557669,_0x1e0ac7){return _0x557669===_0x1e0ac7;}};if(!_0x1a1edb)return![];const _0x1a7e83={'userProvide':_0x242f9a[_0x42bca4(0x11f)](isUserProvided,_0x1a1edb)};_0x168d34&&(_0x1a7e83[_0x42bca4(0x10a)]=_0x242f9a['oaady'](isUserProvided,_0x168d34));const _0x2433ec=_0x242f9a['GSlRA'](isAssistantsEndpoint,_0x1d5463),_0x7f5dbd=isAgentsEndpoint(_0x1d5463);_0x2433ec&&(_0x1a7e83['retrievalModels']=defaultRetrievalModels,_0x1a7e83[_0x42bca4(0x104)]=[Capabilities[_0x42bca4(0x110)],Capabilities['image_vision'],Capabilities['retrieval'],Capabilities[_0x42bca4(0xe7)],Capabilities[_0x42bca4(0xd3)]]);_0x7f5dbd&&(_0x1a7e83['capabilities']=[AgentCapabilities[_0x42bca4(0x12b)],AgentCapabilities['actions'],AgentCapabilities[_0x42bca4(0xd3)]],_0x242f9a[_0x42bca4(0x105)](_0x1a1edb,_0x42bca4(0x117))&&_0x1a7e83[_0x42bca4(0x104)][_0x42bca4(0xe0)](AgentCapabilities['execute_code']));if(_0x2433ec&&_0x1d5463===EModelEndpoint[_0x42bca4(0x102)])_0x1a7e83[_0x42bca4(0xdc)]=defaultAssistantsVersion['azureAssistants'];else _0x2433ec&&(_0x1a7e83['version']=defaultAssistantsVersion['assistants']);return _0x1a7e83;}function normalizeEndpointName(_0x14c6c0=''){const _0x56fb66=_0x473512,_0x2e9d72={'jQnWP':function(_0x228afa,_0x1eda3e){return _0x228afa===_0x1eda3e;}};return _0x2e9d72[_0x56fb66(0x10e)](_0x14c6c0[_0x56fb66(0x12c)](),Providers[_0x56fb66(0x11b)])?Providers[_0x56fb66(0x11b)]:_0x14c6c0;}function sanitizeFilename(_0x116c13){const _0xdba951=_0x473512,_0x18124b={'TKXgt':function(_0x1224f5,_0x19a428){return _0x1224f5===_0x19a428;},'PoHvW':function(_0x10a873,_0x33448e){return _0x10a873>_0x33448e;},'nBGMr':function(_0x5d253f,_0x4f0655){return _0x5d253f+_0x4f0655;},'Bmiis':function(_0x41c064,_0x1760c2){return _0x41c064-_0x1760c2;}};let _0x2353cd=path[_0xdba951(0xf0)](_0x116c13);_0x2353cd=_0x2353cd[_0xdba951(0xc9)](/[^a-zA-Z0-9.-]/g,'_');(_0x2353cd[_0xdba951(0x10f)]('.')||_0x18124b[_0xdba951(0xf1)](_0x2353cd,''))&&(_0x2353cd='_'+_0x2353cd);const _0x4d6872=0xff;if(_0x18124b[_0xdba951(0xed)](_0x2353cd['length'],_0x4d6872)){const _0xa09210=path[_0xdba951(0x10b)](_0x2353cd),_0x174e8a=path[_0xdba951(0xf0)](_0x2353cd,_0xa09210);_0x2353cd=_0x18124b['nBGMr'](_0x174e8a[_0xdba951(0xf6)](0x0,_0x18124b['Bmiis'](_0x4d6872,_0xa09210[_0xdba951(0xef)])-0x7),'-')+crypto[_0xdba951(0x126)](0x3)[_0xdba951(0xfd)](_0xdba951(0x106))+_0xa09210;}return _0x2353cd;}module[_0x473512(0xf5)]={'isEnabled':isEnabled,'handleText':handleText,'formatSteps':formatSteps,'formatAction':formatAction,'isUserProvided':isUserProvided,'generateConfig':generateConfig,'addSpaceIfNeeded':addSpaceIfNeeded,'createOnProgress':createOnProgress,'sanitizeFilename':sanitizeFilename,'normalizeEndpointName':normalizeEndpointName};