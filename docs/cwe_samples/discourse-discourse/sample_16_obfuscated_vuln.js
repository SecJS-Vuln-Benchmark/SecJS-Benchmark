const _0x4dd691=_0x40cc;function _0x5a6c(){const _0x2377ba=['\x0aContent:\x20','There\x20was\x20an\x20error\x20authenticating\x20the\x20file\x20search\x20request.','luhiV','918384UVRlTu','\x0a---\x0a','39670hWEuwN','metadata','3281490HOjSxi','CwOMV','29EtCiDp','~/models/File','/query','string','filter','8bVxeuY','Gnqlk','Performs\x20a\x20semantic\x20search\x20based\x20on\x20a\x20natural\x20language\x20query\x20across\x20the\x20following\x20files:\x0a','A\x20natural\x20language\x20query\x20to\x20search\x20for\x20relevant\x20information\x20in\x20the\x20files.\x20Be\x20specific\x20and\x20use\x20keywords\x20related\x20to\x20the\x20information\x20you\x27re\x20looking\x20for.\x20The\x20query\x20will\x20be\x20used\x20for\x20semantic\x20similarity\x20matching\x20against\x20the\x20file\x20contents.','length','File:\x20','all','split','toFixed','page_content','map','11tAdWPj','11814867OgwJbm','~/config','content','files','917217RpJoYO','No\x20results\x20found\x20or\x20errors\x20occurred\x20while\x20searching\x20the\x20files.','No\x20files\x20to\x20search.\x20Instruct\x20the\x20user\x20to\x20add\x20files\x20for\x20the\x20search.','relevanceScore','object','headers','flatMap','env','filename','989252ZMRRac','32038830cfTbqw','join','describe','Error\x20encountered\x20in\x20`file_search`\x20while\x20querying\x20file_id\x20','file_search','fUWly','file_ids','@langchain/core/tools','concat','Bearer\x20','exports','error','data','20oUEpex'];_0x5a6c=function(){return _0x2377ba;};return _0x5a6c();}(function(_0x9efd71,_0x5cb1e2){const _0x4c32ac=_0x40cc,_0x917e11=_0x9efd71();while(!![]){try{const _0x3612ac=-parseInt(_0x4c32ac(0xd0))/0x1*(-parseInt(_0x4c32ac(0xcc))/0x2)+parseInt(_0x4c32ac(0xce))/0x3+-parseInt(_0x4c32ac(0xb8))/0x4*(-parseInt(_0x4c32ac(0xc6))/0x5)+-parseInt(_0x4c32ac(0xca))/0x6+parseInt(_0x4c32ac(0xaf))/0x7+parseInt(_0x4c32ac(0xd5))/0x8*(parseInt(_0x4c32ac(0xab))/0x9)+parseInt(_0x4c32ac(0xb9))/0xa*(-parseInt(_0x4c32ac(0xaa))/0xb);if(_0x3612ac===_0x5cb1e2)break;else _0x917e11['push'](_0x917e11['shift']());}catch(_0x146cd5){_0x917e11['push'](_0x917e11['shift']());}}}(_0x5a6c,0xb5eb8));const {z}=require('zod'),axios=require('axios'),{tool}=require(_0x4dd691(0xc0)),{Tools,EToolResources}=require('librechat-data-provider'),{getFiles}=require(_0x4dd691(0xd1)),{logger}=require(_0x4dd691(0xac)),createFileSearchTool=async _0x1e5339=>{const _0x4bf0be=_0x4dd691,_0x35509f={'Gnqlk':function(_0x2f7578,_0x4c1f30){return _0x2f7578===_0x4c1f30;},'CwOMV':_0x4bf0be(0xcb),'luhiV':function(_0x26b580,_0x8c5471,_0x4f7ad4){return _0x26b580(_0x8c5471,_0x4f7ad4);},'fUWly':_0x4bf0be(0xa2)},{req:_0xf4c9a7,tool_resources:_0x29174e}=_0x1e5339,_0x3691df=_0x29174e?.[EToolResources[_0x4bf0be(0xbd)]]?.[_0x4bf0be(0xbf)]??[],_0x2c4fc9=await getFiles({'file_id':{'$in':_0x3691df}})??[],_0x26ccbe=_0x2c4fc9[_0x4bf0be(0xc1)](_0x29174e?.[EToolResources[_0x4bf0be(0xbd)]]?.[_0x4bf0be(0xae)]??[])[_0x4bf0be(0xa9)](_0x30ecf3=>({'file_id':_0x30ecf3['file_id'],'filename':_0x30ecf3[_0x4bf0be(0xb7)]})),_0x20a888=_0x26ccbe[_0x4bf0be(0xa9)](_0x1f02fb=>'-\x20'+_0x1f02fb[_0x4bf0be(0xb7)])[_0x4bf0be(0xba)]('\x0a'),_0x3e9b82=_0x4bf0be(0xa1)+_0x20a888,_0x4a77e2=_0x35509f[_0x4bf0be(0xc9)](tool,async({query:_0x3bd48f})=>{const _0x518291=_0x4bf0be;if(_0x26ccbe[_0x518291(0xa3)]===0x0)return _0x518291(0xb1);const _0x2f4efe=_0xf4c9a7[_0x518291(0xb4)]['authorization'][_0x518291(0xa6)]('\x20')[0x1];if(!_0x2f4efe)return _0x518291(0xc8);const _0x33d86f=_0x26ccbe[_0x518291(0xa9)](_0xe273ca=>axios['post'](process[_0x518291(0xb6)]['RAG_API_URL']+_0x518291(0xd2),{'file_id':_0xe273ca['file_id'],'query':_0x3bd48f,'k':0x5},{'headers':{'Authorization':_0x518291(0xc2)+_0x2f4efe,'Content-Type':'application/json'}})['catch'](_0x2b30db=>{const _0x1ac539=_0x518291;return logger[_0x1ac539(0xc4)](_0x1ac539(0xbc)+_0xe273ca['_id']+':',_0x2b30db),null;})),_0xe4bc7f=await Promise[_0x518291(0xa5)](_0x33d86f),_0x446432=_0xe4bc7f[_0x518291(0xd4)](_0x268738=>_0x268738!==null);if(_0x35509f[_0x518291(0xa0)](_0x446432[_0x518291(0xa3)],0x0))return _0x518291(0xb0);const _0x47c672=_0x446432[_0x518291(0xb5)](_0x514858=>_0x514858[_0x518291(0xc5)]['map'](([_0x577b06,_0x59430c])=>({'filename':_0x577b06[_0x518291(0xcd)]['source']['split']('/')['pop'](),'content':_0x577b06[_0x518291(0xa8)],'relevanceScore':_0x59430c})))['sort']((_0x532095,_0x4a7520)=>_0x4a7520[_0x518291(0xb2)]-_0x532095[_0x518291(0xb2)]),_0x16be0e=_0x47c672[_0x518291(0xa9)](_0x1155ae=>_0x518291(0xa4)+_0x1155ae['filename']+'\x0aRelevance:\x20'+_0x1155ae[_0x518291(0xb2)][_0x518291(0xa7)](0x4)+_0x518291(0xc7)+_0x1155ae[_0x518291(0xad)]+'\x0a')[_0x518291(0xba)](_0x35509f[_0x518291(0xcf)]);return _0x16be0e;},{'name':Tools[_0x4bf0be(0xbd)],'description':_0x3e9b82,'schema':z[_0x4bf0be(0xb3)]({'query':z[_0x4bf0be(0xd3)]()[_0x4bf0be(0xbb)](_0x35509f[_0x4bf0be(0xbe)])})});return _0x4a77e2;};function _0x40cc(_0x9ae612,_0x4e855d){const _0x5a6cc1=_0x5a6c();return _0x40cc=function(_0x40ccb7,_0x4e9d41){_0x40ccb7=_0x40ccb7-0xa0;let _0x373ff8=_0x5a6cc1[_0x40ccb7];return _0x373ff8;},_0x40cc(_0x9ae612,_0x4e855d);}module[_0x4dd691(0xc3)]=createFileSearchTool;