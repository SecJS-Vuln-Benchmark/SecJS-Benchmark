const _0x1d3bbd=_0x1527;function _0x3c3a(){const _0x47f2b1=['11602RCRMot','11TgeNmv','7902855zxDlxR','NmAEJ','17604260KoGDtk','value','lean','11gkyYjA','No\x20plugin\x20auth\x20','9917976IZbaVr','updateOne','~/models/schema/pluginAuthSchema','8EQsqiR','qweWI','AlgeX','eyNld','[deleteUserPluginAuth]','deleteMany','JAHbG','save','CzUYE','UPPdX','error','\x20found\x20for\x20user\x20','[getUserPluginAuthValue]','htPNa','3845376plXUSs','~/server/utils/','3328090NKtmnM','ENmIj','[updateUserPluginAuth]','JAFRy','7DmcxcW','findOne','zPjMO','WignG','VrTSD','exports','1665852RbArfx'];_0x3c3a=function(){return _0x47f2b1;};return _0x3c3a();}(function(_0x122b83,_0x5dc91d){const _0x5fd2bf=_0x1527,_0x21b4dc=_0x122b83();while(!![]){try{const _0x23f75f=parseInt(_0x5fd2bf(0xd4))/0x1*(parseInt(_0x5fd2bf(0xd3))/0x2)+-parseInt(_0x5fd2bf(0xc6))/0x3+-parseInt(_0x5fd2bf(0xdf))/0x4*(-parseInt(_0x5fd2bf(0xc8))/0x5)+-parseInt(_0x5fd2bf(0xd2))/0x6*(-parseInt(_0x5fd2bf(0xcc))/0x7)+parseInt(_0x5fd2bf(0xdc))/0x8+parseInt(_0x5fd2bf(0xd5))/0x9+-parseInt(_0x5fd2bf(0xd7))/0xa*(parseInt(_0x5fd2bf(0xda))/0xb);if(_0x23f75f===_0x5dc91d)break;else _0x21b4dc['push'](_0x21b4dc['shift']());}catch(_0x52cae1){_0x21b4dc['push'](_0x21b4dc['shift']());}}}(_0x3c3a,0xb6b19));function _0x1527(_0x4acc2d,_0xb6209c){const _0x3c3a9c=_0x3c3a();return _0x1527=function(_0x1527e4,_0x55af95){_0x1527e4=_0x1527e4-0xc1;let _0x3b7e57=_0x3c3a9c[_0x1527e4];return _0x3b7e57;},_0x1527(_0x4acc2d,_0xb6209c);}const PluginAuth=require(_0x1d3bbd(0xde)),{encrypt,decrypt}=require(_0x1d3bbd(0xc7)),{logger}=require('~/config'),getUserPluginAuthValue=async(_0x54ef86,_0x2c46d0,_0x4d93ba=!![])=>{const _0x676f18=_0x1d3bbd,_0x16f1a6={'UPPdX':function(_0x1f0be8,_0x20c8b2){return _0x1f0be8===_0x20c8b2;},'CzUYE':'qweWI','WignG':'DpgCv','eyNld':_0x676f18(0xc4)};try{const _0x45493f=await PluginAuth[_0x676f18(0xcd)]({'userId':_0x54ef86,'authField':_0x2c46d0})[_0x676f18(0xd9)]();if(!_0x45493f){if(_0x16f1a6[_0x676f18(0xc1)](_0x676f18(0xe0),_0x16f1a6[_0x676f18(0xe7)]))throw new Error(_0x676f18(0xdb)+_0x2c46d0+_0x676f18(0xc3)+_0x54ef86);else return null;}const _0xc901ab=await decrypt(_0x45493f[_0x676f18(0xd8)]);return _0xc901ab;}catch(_0x55e0ba){if(!_0x4d93ba)return _0x676f18(0xd0)!==_0x16f1a6[_0x676f18(0xcf)]?null:(_0x421101[_0x676f18(0xc2)]('[deleteUserPluginAuth]',_0x383cbc),_0x4dad13);logger[_0x676f18(0xc2)](_0x16f1a6[_0x676f18(0xe2)],_0x55e0ba);throw _0x55e0ba;}},updateUserPluginAuth=async(_0x53b4a4,_0x3d38a7,_0x58c3e6,_0x574ce2)=>{const _0x2d79c5=_0x1d3bbd,_0x14aaac={'NmAEJ':function(_0x2ec523,_0x56613f){return _0x2ec523(_0x56613f);},'zPjMO':_0x2d79c5(0xca)};try{const _0xa1875a=await _0x14aaac[_0x2d79c5(0xd6)](encrypt,_0x574ce2),_0x279e24=await PluginAuth[_0x2d79c5(0xcd)]({'userId':_0x53b4a4,'authField':_0x3d38a7})[_0x2d79c5(0xd9)]();if(_0x279e24){const _0x38bfd4=await PluginAuth[_0x2d79c5(0xdd)]({'userId':_0x53b4a4,'authField':_0x3d38a7},{'$set':{'value':_0xa1875a}});return _0x38bfd4;}else{const _0x5ad007=await new PluginAuth({'userId':_0x53b4a4,'authField':_0x3d38a7,'value':_0xa1875a,'pluginKey':_0x58c3e6});return await _0x5ad007[_0x2d79c5(0xe6)](),_0x5ad007;}}catch(_0x1ce413){return logger[_0x2d79c5(0xc2)](_0x14aaac[_0x2d79c5(0xce)],_0x1ce413),_0x1ce413;}},deleteUserPluginAuth=async(_0x304180,_0x594cfe,_0x39d8f4=![])=>{const _0x31899e=_0x1d3bbd,_0x4bd2d3={'JAFRy':_0x31899e(0xe3),'JAHbG':_0x31899e(0xc5)};if(_0x39d8f4)try{const _0x1c583e=await PluginAuth[_0x31899e(0xe4)]({'userId':_0x304180});return _0x1c583e;}catch(_0x23f685){return logger['error'](_0x4bd2d3['JAFRy'],_0x23f685),_0x23f685;}try{return'Yssja'!==_0x4bd2d3[_0x31899e(0xe5)]?await PluginAuth['deleteOne']({'userId':_0x304180,'authField':_0x594cfe}):(_0x42faac['error'](_0x31899e(0xe3),_0x1a5aae),_0x58fb26);}catch(_0x2b32af){if(_0x31899e(0xc9)===_0x31899e(0xe1))throw new _0x40ec25('No\x20plugin\x20auth\x20'+_0x3fff01+'\x20found\x20for\x20user\x20'+_0x29a0f5);else return logger[_0x31899e(0xc2)](_0x4bd2d3[_0x31899e(0xcb)],_0x2b32af),_0x2b32af;}};module[_0x1d3bbd(0xd1)]={'getUserPluginAuthValue':getUserPluginAuthValue,'updateUserPluginAuth':updateUserPluginAuth,'deleteUserPluginAuth':deleteUserPluginAuth};