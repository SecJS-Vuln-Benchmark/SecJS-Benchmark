function _0x15eb(){const _0x1e5265=['wlApk','NioQW','body','/update','ZlNao','vwWtj','6091220TNGJhI','WrNds','assistants','pageSize','true','~/server/middleware/requireJwtAuth','1380640cXcvaw','~/server/utils/import','beta','Error\x20deleting\x20OpenAI\x20thread:','/clear','librechat-data-provider','call','zmIaO','express','conversationId','Error\x20processing\x20file','params','7780716hJaBiK','~/server/utils','arg','button','BQMHt','initializeClient','undefined','multer','SuvHL','conversationId\x20is\x20required','nIysq','del','270GhkHgq','322806dqIcBC','POST\x20/api/convos/update\x20','JRyze','Error\x20updating\x20conversation','get','2985368RIgYRw','7yTwgqn','send','sOgEe','/gen_title','godjc','~/cache/getLogStores','ZvqBZ','mCYlL','~/server/utils/import/fork','QOIBE','isArray','exports','isArchived','use','9478737gMLaRY','Invalid\x20page\x20size','Router','error','Error\x20forking\x20conversation','query','HoWAE','sJvDp','1gnGNpv','/import','user','UQClr','868rCUxXV','/:conversationId','post','GEN_TITLE','Vbxuv','Invalid\x20page\x20number','~/server/services/Endpoints/azureAssistants','file','debug','VUDPR','uppwI','Deleted\x20OpenAI\x20thread:','Conversation(s)\x20imported\x20successfully','json','Title\x20not\x20found\x20or\x20method\x20not\x20implemented\x20for\x20the\x20conversation\x27s\x20endpoint','~/server/services/Endpoints/assistants','~/config','13722dvEeUp','ZjfPD','~/models/Conversation','brRwB','status','end','Error\x20clearing\x20conversations','jQRyr','tags'];_0x15eb=function(){return _0x1e5265;};return _0x15eb();}function _0x2225(_0x9b0558,_0x3a5c06){const _0x15ebb9=_0x15eb();return _0x2225=function(_0x2225f7,_0x5516ae){_0x2225f7=_0x2225f7-0x1df;let _0x49ac06=_0x15ebb9[_0x2225f7];return _0x49ac06;},_0x2225(_0x9b0558,_0x3a5c06);}const _0x37d2bf=_0x2225;(function(_0x3fefe7,_0x50e222){const _0x1b6fd7=_0x2225,_0x48a2d0=_0x3fefe7();while(!![]){try{const _0x463541=-parseInt(_0x1b6fd7(0x208))/0x1*(parseInt(_0x1b6fd7(0x232))/0x2)+parseInt(_0x1b6fd7(0x21d))/0x3*(-parseInt(_0x1b6fd7(0x20c))/0x4)+parseInt(_0x1b6fd7(0x22c))/0x5+parseInt(_0x1b6fd7(0x1df))/0x6+parseInt(_0x1b6fd7(0x1f2))/0x7*(-parseInt(_0x1b6fd7(0x1f1))/0x8)+parseInt(_0x1b6fd7(0x200))/0x9+parseInt(_0x1b6fd7(0x1eb))/0xa*(-parseInt(_0x1b6fd7(0x1ec))/0xb);if(_0x463541===_0x50e222)break;else _0x48a2d0['push'](_0x48a2d0['shift']());}catch(_0x4dbb14){_0x48a2d0['push'](_0x48a2d0['shift']());}}}(_0x15eb,0xafbd8));const multer=require(_0x37d2bf(0x1e6)),express=require(_0x37d2bf(0x23a)),{CacheKeys,EModelEndpoint}=require(_0x37d2bf(0x237)),{getConvosByPage,deleteConvos,getConvo,saveConvo}=require(_0x37d2bf(0x21f)),{storage,importFileFilter}=require('~/server/routes/files/multer'),requireJwtAuth=require(_0x37d2bf(0x231)),{forkConversation}=require(_0x37d2bf(0x1fa)),{importConversations}=require(_0x37d2bf(0x233)),{createImportLimiters}=require('~/server/middleware'),{deleteToolCalls}=require('~/models/ToolCall'),getLogStores=require(_0x37d2bf(0x1f7)),{sleep}=require(_0x37d2bf(0x1e0)),{logger}=require(_0x37d2bf(0x21c)),assistantClients={[EModelEndpoint['azureAssistants']]:require(_0x37d2bf(0x212)),[EModelEndpoint[_0x37d2bf(0x22e)]]:require(_0x37d2bf(0x21b))},router=express[_0x37d2bf(0x202)]();router[_0x37d2bf(0x1ff)](requireJwtAuth),router['get']('/',async(_0x975b54,_0x49c7ab)=>{const _0x44aae1=_0x37d2bf,_0x304932={'TjurF':_0x44aae1(0x211),'UQClr':function(_0x4594f2,_0x39a09f,_0x212444){return _0x4594f2(_0x39a09f,_0x212444);},'TKKVU':function(_0x119cb0,_0x145f6d){return _0x119cb0(_0x145f6d);},'NioQW':function(_0x5ca4c,_0x3ca33f){return _0x5ca4c<_0x3ca33f;}};let _0x4c4df4=_0x975b54[_0x44aae1(0x205)]['pageNumber']||0x1;_0x4c4df4=parseInt(_0x4c4df4,0xa);if(isNaN(_0x4c4df4)||_0x4c4df4<0x1)return _0x49c7ab['status'](0x190)['json']({'error':_0x304932['TjurF']});let _0xe025e0=_0x975b54['query'][_0x44aae1(0x22f)]||0x19;_0xe025e0=_0x304932[_0x44aae1(0x20b)](parseInt,_0xe025e0,0xa);if(_0x304932['TKKVU'](isNaN,_0xe025e0)||_0x304932[_0x44aae1(0x227)](_0xe025e0,0x1))return _0x49c7ab[_0x44aae1(0x221)](0x190)[_0x44aae1(0x219)]({'error':_0x44aae1(0x201)});const _0x2baac1=_0x975b54[_0x44aae1(0x205)][_0x44aae1(0x1fe)]===_0x44aae1(0x230);let _0x144d1e;_0x975b54[_0x44aae1(0x205)][_0x44aae1(0x225)]?_0x144d1e=Array[_0x44aae1(0x1fc)](_0x975b54[_0x44aae1(0x205)][_0x44aae1(0x225)])?_0x975b54[_0x44aae1(0x205)][_0x44aae1(0x225)]:[_0x975b54[_0x44aae1(0x205)][_0x44aae1(0x225)]]:_0x144d1e=undefined,_0x49c7ab[_0x44aae1(0x221)](0xc8)[_0x44aae1(0x1f3)](await getConvosByPage(_0x975b54[_0x44aae1(0x20a)]['id'],_0x4c4df4,_0xe025e0,_0x2baac1,_0x144d1e));}),router[_0x37d2bf(0x1f0)](_0x37d2bf(0x20d),async(_0x26ee68,_0x3c2545)=>{const _0x451511=_0x37d2bf,_0x302df4={'VUDPR':_0x451511(0x223),'UdQbs':function(_0x343bf9,_0x161c53){return _0x343bf9!==_0x161c53;},'jQRyr':'QfIrb'},{conversationId:_0x23ebdb}=_0x26ee68[_0x451511(0x23d)],_0x1a05ec=await getConvo(_0x26ee68[_0x451511(0x20a)]['id'],_0x23ebdb);_0x1a05ec?_0x3c2545[_0x451511(0x221)](0xc8)[_0x451511(0x219)](_0x1a05ec):_0x302df4['UdQbs'](_0x302df4[_0x451511(0x224)],_0x302df4[_0x451511(0x224)])?(_0x22da8e[_0x451511(0x203)](_0x451511(0x223),_0x11a186),_0x50fb71[_0x451511(0x221)](0x1f4)['send'](_0x302df4[_0x451511(0x215)])):_0x3c2545[_0x451511(0x221)](0x194)[_0x451511(0x222)]();}),router['post'](_0x37d2bf(0x1f5),async(_0x198d33,_0x509fc9)=>{const _0xeb7ce0=_0x37d2bf,_0x4de7bb={'JRyze':_0xeb7ce0(0x204),'Vbxuv':function(_0x4ef9ac,_0x255383){return _0x4ef9ac!==_0x255383;},'bUBLa':_0xeb7ce0(0x21e),'DxIRU':function(_0x49cb1d,_0x33222c){return _0x49cb1d(_0x33222c);}},{conversationId:_0x47ab98}=_0x198d33[_0xeb7ce0(0x228)],_0x215382=getLogStores(CacheKeys[_0xeb7ce0(0x20f)]),_0x22198f=_0x198d33['user']['id']+'-'+_0x47ab98;let _0x8488a1=await _0x215382['get'](_0x22198f);!_0x8488a1&&(_0x4de7bb[_0xeb7ce0(0x210)](_0x4de7bb['bUBLa'],_0xeb7ce0(0x1f6))?(await _0x4de7bb['DxIRU'](sleep,0x9c4),_0x8488a1=await _0x215382[_0xeb7ce0(0x1f0)](_0x22198f)):(_0x35c96e[_0xeb7ce0(0x203)](_0xeb7ce0(0x204),_0x1a50cb),_0x5189d0[_0xeb7ce0(0x221)](0x1f4)[_0xeb7ce0(0x1f3)](_0x4de7bb[_0xeb7ce0(0x1ee)]))),_0x8488a1?(await _0x215382['delete'](_0x22198f),_0x509fc9[_0xeb7ce0(0x221)](0xc8)['json']({'title':_0x8488a1})):_0x509fc9['status'](0x194)[_0xeb7ce0(0x219)]({'message':_0xeb7ce0(0x21a)});}),router[_0x37d2bf(0x20e)](_0x37d2bf(0x236),async(_0x5e19ce,_0x38ffcf)=>{const _0x442ea9=_0x37d2bf,_0x108d3e={'nIysq':function(_0x18d7ee,_0x48ada5){return _0x18d7ee===_0x48ada5;},'uppwI':_0x442ea9(0x1e5),'HoWAE':function(_0x1623cc,_0x316e9a){return _0x1623cc!==_0x316e9a;},'nhTIb':'Error\x20deleting\x20OpenAI\x20thread:','ZvqBZ':_0x442ea9(0x223)};let _0x5aea86={};const {conversationId:_0x1b243e,source:_0x1cfd5d,thread_id:_0xf7293d,endpoint:_0x17f753}=_0x5e19ce[_0x442ea9(0x228)][_0x442ea9(0x1e1)];_0x1b243e&&(_0x442ea9(0x1e7)===_0x442ea9(0x1f9)?_0x42a4aa['status'](0xc8)[_0x442ea9(0x219)](_0x49ae16):_0x5aea86={'conversationId':_0x1b243e});if(_0x108d3e[_0x442ea9(0x1e9)](_0x1cfd5d,_0x442ea9(0x1e2))&&!_0x1b243e)return _0x38ffcf['status'](0xc8)['send']('No\x20conversationId\x20provided');if(typeof _0x17f753!=_0x108d3e[_0x442ea9(0x216)]&&Object['prototype']['propertyIsEnumerable'][_0x442ea9(0x238)](assistantClients,_0x17f753)){if(_0x108d3e[_0x442ea9(0x206)](_0x442ea9(0x22b),_0x442ea9(0x220))){const {openai:_0x2dadd0}=await assistantClients[_0x17f753][_0x442ea9(0x1e4)]({'req':_0x5e19ce,'res':_0x38ffcf});try{const _0x10fb3e=await _0x2dadd0[_0x442ea9(0x234)]['threads'][_0x442ea9(0x1ea)](_0xf7293d);logger[_0x442ea9(0x214)](_0x442ea9(0x217),_0x10fb3e);}catch(_0x30cf63){logger[_0x442ea9(0x203)](_0x108d3e['nhTIb'],_0x30cf63);}}else return _0x447af9[_0x442ea9(0x221)](0x190)[_0x442ea9(0x219)]({'error':_0x442ea9(0x211)});}try{const _0x41b0df=await deleteConvos(_0x5e19ce[_0x442ea9(0x20a)]['id'],_0x5aea86);await deleteToolCalls(_0x5e19ce[_0x442ea9(0x20a)]['id'],_0x5aea86[_0x442ea9(0x23b)]),_0x38ffcf[_0x442ea9(0x221)](0xc9)[_0x442ea9(0x219)](_0x41b0df);}catch(_0x56a8c6){logger[_0x442ea9(0x203)](_0x442ea9(0x223),_0x56a8c6),_0x38ffcf[_0x442ea9(0x221)](0x1f4)[_0x442ea9(0x1f3)](_0x108d3e[_0x442ea9(0x1f8)]);}}),router[_0x37d2bf(0x20e)](_0x37d2bf(0x229),async(_0x44c401,_0x552f5e)=>{const _0x38fef=_0x37d2bf,_0x12ec37={'zmIaO':function(_0x1f9894,_0x3e7bfd){return _0x1f9894!==_0x3e7bfd;},'WrNds':_0x38fef(0x1ef)},_0x4fba87=_0x44c401[_0x38fef(0x228)][_0x38fef(0x1e1)];if(!_0x4fba87['conversationId']){if(_0x12ec37[_0x38fef(0x239)](_0x38fef(0x1f4),'OtMhT'))return _0x552f5e['status'](0x190)[_0x38fef(0x219)]({'error':_0x38fef(0x1e8)});else _0x11d33f[_0x38fef(0x203)](_0x38fef(0x235),_0x41c0fc);}try{const _0x241696=await saveConvo(_0x44c401,_0x4fba87,{'context':_0x38fef(0x1ed)+_0x4fba87['conversationId']});_0x552f5e[_0x38fef(0x221)](0xc9)[_0x38fef(0x219)](_0x241696);}catch(_0x103b66){logger[_0x38fef(0x203)](_0x12ec37[_0x38fef(0x22d)],_0x103b66),_0x552f5e[_0x38fef(0x221)](0x1f4)['send'](_0x12ec37[_0x38fef(0x22d)]);}});const {importIpLimiter,importUserLimiter}=createImportLimiters(),upload=multer({'storage':storage,'fileFilter':importFileFilter});router['post'](_0x37d2bf(0x209),importIpLimiter,importUserLimiter,upload['single'](_0x37d2bf(0x213)),async(_0x32c7e6,_0x452e80)=>{const _0x120b1f=_0x37d2bf,_0x4c7f40={'ZlNao':function(_0x288027,_0x14c437){return _0x288027(_0x14c437);},'wlApk':_0x120b1f(0x218),'BQMHt':_0x120b1f(0x23c)};try{await _0x4c7f40[_0x120b1f(0x22a)](importConversations,{'filepath':_0x32c7e6['file']['path'],'requestUserId':_0x32c7e6[_0x120b1f(0x20a)]['id']}),_0x452e80[_0x120b1f(0x221)](0xc9)[_0x120b1f(0x219)]({'message':_0x4c7f40[_0x120b1f(0x226)]});}catch(_0x5a1ad0){logger['error'](_0x120b1f(0x23c),_0x5a1ad0),_0x452e80['status'](0x1f4)[_0x120b1f(0x1f3)](_0x4c7f40[_0x120b1f(0x1e3)]);}}),router[_0x37d2bf(0x20e)]('/fork',async(_0x55b12a,_0x1a6c50)=>{const _0x1aa03d=_0x37d2bf,_0xc2c703={'sJvDp':function(_0x5dfeec,_0x46be14){return _0x5dfeec(_0x46be14);},'QOIBE':_0x1aa03d(0x204)};try{const {conversationId:_0x1e44bd,messageId:_0xf888f3,option:_0x2a4ccd,splitAtTarget:_0x10b122,latestMessageId:_0x3b5deb}=_0x55b12a[_0x1aa03d(0x228)],_0x25ab71=await _0xc2c703[_0x1aa03d(0x207)](forkConversation,{'requestUserId':_0x55b12a[_0x1aa03d(0x20a)]['id'],'originalConvoId':_0x1e44bd,'targetMessageId':_0xf888f3,'latestMessageId':_0x3b5deb,'records':!![],'splitAtTarget':_0x10b122,'option':_0x2a4ccd});_0x1a6c50[_0x1aa03d(0x219)](_0x25ab71);}catch(_0x2b8dd2){logger[_0x1aa03d(0x203)](_0xc2c703[_0x1aa03d(0x1fb)],_0x2b8dd2),_0x1a6c50['status'](0x1f4)[_0x1aa03d(0x1f3)](_0xc2c703[_0x1aa03d(0x1fb)]);}}),module[_0x37d2bf(0x1fd)]=router;