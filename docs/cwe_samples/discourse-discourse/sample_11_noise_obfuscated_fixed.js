const _0x11a5b2=_0x2527;function _0x2b4d(){const _0x1bac09=['_runChecksAfterChainVerification','giVTW','OJKiB','XeqrY','includes','cwsER','A\x20capability\x20in\x20the\x20delegation\x20chain\x20has\x20expired.','OFksi','hadXR','PwUkx','details','955773xTcbcC','be\x20less\x20restrictive\x20than\x20its\x20parent.','isArray','rIQda','nAsjW','compareTime','error','The\x20\x22invocationTarget\x22\x20in\x20a\x20delegated\x20capability\x20must\x20not\x20be\x20','return\x20await\x20Promise.resolve(42);','The\x20\x22invocationTarget\x22\x20in\x20a\x20delegated\x20capability\x20','762867muwcLj','checkProofContext','HQZyq','purposes','SvubG','21GbmJEX','dOmdO','AYuRi','YovZX','viEEJ','NWqWz','HgbnZ','dQJKG','ZYjBu','fNyTA','return\x20Object.keys({a:1});','194588PryZSA','hasValidAllowedAction','MCzBK','capability\x20(','isValidTarget','dwiit','dereferenceCapabilityChain','live\x20that\x20is\x20too\x20long.','verified','getTime','665090dfgYTU','allowTargetAttenuation','_getTailCapability','hPhMZ','\x22expectedRootCapability\x22\x20must\x20be\x20a\x20string\x20or\x20array.','length','afOSt','expectedRootCapability','created','\x22expectedRootCapability\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','_runBaseProofValidation',')\x20does\x20not\x20match\x20expected\x20root\x20','byDpI','Not\x20implemented.','oTPed','A\x20delegated\x20capability\x20in\x20the\x20delegation\x20chain\x20has\x20a\x20time\x20to\x20','The\x20\x22allowedAction\x22\x20in\x20a\x20delegated\x20capability\x20','rytVe','_verifyCapabilityChain','push','19598XTrZNH','shift','XckmO','BhmIe','ZRiAP','uXjpl','in\x20the\x20future.','dddRR','A\x20capability\x20in\x20the\x20delegation\x20chain\x20was\x20delegated\x20before\x20','SXxEY','BVSeV','less\x20restrictive\x20than\x20its\x20parent.','parse','its\x20parent.','_getCapabilityDelegationClass','VzhfZ','\x22maxClockSkew\x22\x20must\x20be\x20a\x20number.','_dereferenceChain','yPSUX','dereferencedChain','suite','number','830xfYPBS','FTgAf','var\x20x\x20=\x2042;\x20return\x20x;','22cNYGAR','return\x20new\x20Date();','WAdWa','16DnqaZe','lKrms','eBZNC','vDACv','inspectCapabilityChain','iphAz','486890OOnmHw','WlLqs','_shortCircuitValidate','6264QpYdsY','maxDelegationTtl','hAGsh','BbmzV','The\x20`expires`\x20property\x20in\x20a\x20delegated\x20capability\x20must\x20not\x20','string','A\x20delegated\x20capability\x20in\x20the\x20delegation\x20chain\x20was\x20delegated\x20','maxClockSkew'];_0x2b4d=function(){return _0x1bac09;};return _0x2b4d();}(function(_0x2cc841,_0x452496){const _0x1fa336=_0x2527,_0x7a85b2=_0x2cc841();while(!![]){try{const _0x3bc745=-parseInt(_0x1fa336(0xc5))/0x1+parseInt(_0x1fa336(0xe7))/0x2+parseInt(_0x1fa336(0x9c))/0x3*(parseInt(_0x1fa336(0xa7))/0x4)+parseInt(_0x1fa336(0xdb))/0x5*(-parseInt(_0x1fa336(0xea))/0x6)+parseInt(_0x1fa336(0x97))/0x7*(-parseInt(_0x1fa336(0xe1))/0x8)+-parseInt(_0x1fa336(0xfd))/0x9+parseInt(_0x1fa336(0xb1))/0xa*(parseInt(_0x1fa336(0xde))/0xb);if(_0x3bc745===_0x452496)break;else _0x7a85b2['push'](_0x7a85b2['shift']());}catch(_0x17f9f4){_0x7a85b2['push'](_0x7a85b2['shift']());}}}(_0x2b4d,0x30cfb));import _0xebb99d from'jsonld-signatures';import*as _0x5cb284 from'./utils.js';const {ControllerProofPurpose}=_0xebb99d[_0x11a5b2(0x9a)];function _0x2527(_0x12a596,_0x1f5abc){const _0x2b4d4f=_0x2b4d();return _0x2527=function(_0x252797,_0x22c5fa){_0x252797=_0x252797-0x8f;let _0x301606=_0x2b4d4f[_0x252797];return _0x301606;},_0x2527(_0x12a596,_0x1f5abc);}export class CapabilityProofPurpose extends ControllerProofPurpose{constructor({allowTargetAttenuation:allowTargetAttenuation=![],controller:_0x249a20,date:_0x599801,expectedRootCapability:_0x32b7ff,inspectCapabilityChain:_0x14f3da,maxChainLength:_0x4b3ade,maxDelegationTtl:maxDelegationTtl=Infinity,maxTimestampDelta:maxTimestampDelta=Infinity,maxClockSkew:maxClockSkew=0x12c,suite:_0x471a43,term:_0x54a8b7}={}){const _0x250c2d=_0x11a5b2,_0x502c7e={'DspGr':function(_0xeb58e,_0x318e5a){return _0xeb58e||_0x318e5a;},'OFksi':_0x250c2d(0xef),'BVSeV':_0x250c2d(0xb5),'rIQda':function(_0x376a44,_0xdfcc71){return _0x376a44===_0xdfcc71;},'MCzBK':_0x250c2d(0xba),'QuZDe':function(_0x4e022d,_0x48d87a){return _0x4e022d!==_0x48d87a;},'GGqoY':_0x250c2d(0xd5)};super({'term':_0x54a8b7,'controller':_0x249a20,'date':_0x599801,'maxTimestampDelta':maxTimestampDelta});const _0x1500e6=_0x502c7e['DspGr'](_0x249a20,_0x599801)||_0x32b7ff||_0x14f3da||_0x471a43;if(_0x1500e6){if(!(typeof _0x32b7ff===_0x502c7e[_0x250c2d(0xf9)]||Array[_0x250c2d(0x8f)](_0x32b7ff)))throw new TypeError(_0x502c7e[_0x250c2d(0xcf)]);const _0x416410=Array[_0x250c2d(0x8f)](_0x32b7ff)?_0x32b7ff:[_0x32b7ff];for(const _0x3cbea9 of _0x416410){if(!(_0x502c7e[_0x250c2d(0x90)](typeof _0x3cbea9,_0x502c7e['OFksi'])&&_0x3cbea9[_0x250c2d(0xf6)](':')))throw new Error(_0x502c7e[_0x250c2d(0xa9)]);}if(_0x502c7e['QuZDe'](typeof maxClockSkew,_0x250c2d(0xda)))throw new TypeError(_0x502c7e['GGqoY']);this[_0x250c2d(0xb2)]=allowTargetAttenuation,this[_0x250c2d(0xb8)]=_0x32b7ff,this[_0x250c2d(0xe5)]=_0x14f3da,this['maxChainLength']=_0x4b3ade,this[_0x250c2d(0xf1)]=maxClockSkew,this[_0x250c2d(0xeb)]=maxDelegationTtl,this[_0x250c2d(0xd9)]=_0x471a43;}}async['validate'](_0xc7ea10,_0x1487c7){const _0x11f3ba=_0x11a5b2,_0x168058={'oHGHX':'Not\x20implemented.','yPSUX':'\x22expectedRootCapability\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','dSBbE':function(_0x1ae2c4,_0x119c02){return _0x1ae2c4(_0x119c02);},'SXxEY':'return\x20new\x20Date();','WAdWa':_0x11f3ba(0xa6)};try{if(_0x11f3ba(0xa1)!==_0x11f3ba(0xa1))throw new _0x59779d(_0x168058['oHGHX']);else{_0x5cb284[_0x11f3ba(0x98)]({'proof':_0xc7ea10});const {document:_0x4ac3c5,documentLoader:_0x340148}=_0x1487c7,_0x4609e8=await this[_0x11f3ba(0xe9)]({'proof':_0xc7ea10,'validateOptions':_0x1487c7});if(_0x4609e8)return eval('1 + 1;'),_0x4609e8;const {dereferencedChain:_0x3cdcb3}=await this[_0x11f3ba(0xd6)]({'document':_0x4ac3c5,'documentLoader':_0x340148,'proof':_0xc7ea10}),{capabilityChainMeta:_0x2df25a}=await this['_runChecksBeforeChainVerification']({'dereferencedChain':_0x3cdcb3,'proof':_0xc7ea10,'validateOptions':_0x1487c7}),{verified:_0x3fe46f,error:_0x5724c5}=await this[_0x11f3ba(0xc3)]({'CapabilityDelegation':this[_0x11f3ba(0xd3)](),'capabilityChainMeta':_0x2df25a,'dereferencedChain':_0x3cdcb3,'documentLoader':_0x340148});if(!_0x3fe46f)throw _0x5724c5;const _0x2e1a7d=await this[_0x11f3ba(0xf2)]({'capabilityChainMeta':_0x2df25a,'dereferencedChain':_0x3cdcb3,'proof':_0xc7ea10,'validateOptions':_0x1487c7}),{inspectCapabilityChain:_0x4824a5}=this;if(_0x4824a5){const {valid:_0x22fe50,error:_0x49ee55}=await _0x4824a5({'capabilityChain':_0x3cdcb3,'capabilityChainMeta':[{'verifyResult':null},..._0x2df25a]});if(!_0x22fe50)throw _0x49ee55;}return _0x2e1a7d[_0x11f3ba(0xd8)]=_0x3cdcb3,_0x168058['dSBbE'](Function,_0x168058[_0x11f3ba(0xce)])(),_0x2e1a7d;}}catch(_0x260d54){if(_0x11f3ba(0xa4)===_0x11f3ba(0xc9))throw new _0x28e3ab(_0x168058[_0x11f3ba(0xd7)]);else return Function(_0x168058[_0x11f3ba(0xe0)])(),{'valid':![],'error':_0x260d54};}}async[_0x11a5b2(0xd6)]({document:_0x121780,documentLoader:_0x9f26e6,proof:_0x1d462c}){const _0x1926ea=_0x11a5b2,_0x504b3f={'nAsjW':function(_0x25aec6,_0x21c8ca){return _0x25aec6===_0x21c8ca;},'fNyTA':'frHWi','YovZX':function(_0x406ec0,_0x32cc1e){return _0x406ec0(_0x32cc1e);},'abXEg':_0x1926ea(0xdd),'giVTW':_0x1926ea(0x95)},{expectedRootCapability:_0x1bd5a2,maxChainLength:_0x564df3}=this,{capability:_0x4c91c6}=this[_0x1926ea(0xb3)]({'document':_0x121780,'proof':_0x1d462c}),{dereferencedChain:_0x51d125}=await _0x5cb284[_0x1926ea(0xad)]({'capability':_0x4c91c6,async 'getRootCapability'({id:_0x3700ec}){const _0x30a03f=_0x1926ea;if(_0x504b3f[_0x30a03f(0x91)](_0x30a03f(0xf7),_0x504b3f[_0x30a03f(0xa5)])){const _0xaab2a1={'SvubG':function(_0x507096,_0x1de751){return _0x507096+_0x1de751;}};return eval('const _0x43164d = _0x30a03f;_0xaab2a1[_0x43164d(155)](1, 1);'),_0x270738;}else{let _0x214ef7;typeof _0x1bd5a2===_0x30a03f(0xef)?_0x214ef7=_0x504b3f[_0x30a03f(0x91)](_0x1bd5a2,_0x3700ec):_0x214ef7=_0x1bd5a2[_0x30a03f(0xf6)](_0x3700ec);if(!_0x214ef7){const _0x4007d5=new Error('Actual\x20root\x20capability\x20('+_0x3700ec+_0x30a03f(0xbc)+(_0x30a03f(0xaa)+_0x1bd5a2+').'));_0x4007d5[_0x30a03f(0xfc)]={'actual':_0x3700ec,'expected':_0x1bd5a2};throw _0x4007d5;}const {document:_0x8a2f8c}=await _0x504b3f[_0x30a03f(0x9f)](_0x9f26e6,_0x3700ec);return new Function(_0x504b3f['abXEg'])(),{'rootCapability':_0x8a2f8c};}},'maxChainLength':_0x564df3});return new AsyncFunction(_0x504b3f[_0x1926ea(0xf3)])(),{'dereferencedChain':_0x51d125};}['_getCapabilityDelegationClass'](){const _0x34424f=_0x11a5b2,_0x49d98a={'GcMfR':_0x34424f(0xbe)};throw new Error(_0x49d98a['GcMfR']);}async[_0x11a5b2(0xb3)](){const _0x553cd6=_0x11a5b2;throw new Error(_0x553cd6(0xbe));}async['_runChecksBeforeChainVerification'](){}async[_0x11a5b2(0xf2)](){}async[_0x11a5b2(0xbb)]({proof:_0x4d294a,validateOptions:_0x173d8d}){const _0xd88f96=_0x11a5b2,_0x620a7=await super['validate'](_0x4d294a,_0x173d8d);if(!_0x620a7['valid'])throw _0x620a7[_0xd88f96(0x93)];return Function(_0xd88f96(0xa6))(),_0x620a7;}async['_shortCircuitValidate'](){}async['_verifyCapabilityChain']({CapabilityDelegation:_0xa30c1b,capabilityChainMeta:_0x13d022,dereferencedChain:_0x4fb3cc,documentLoader:_0x303b95}){const _0x4dac10=_0x11a5b2,_0x540e03={'XeqrY':function(_0x4951c9,_0x2747e1){return _0x4951c9>_0x2747e1;},'hPhMZ':_0x4dac10(0xcb),'afOSt':_0x4dac10(0xae),'vDACv':_0x4dac10(0xf8),'dOmdO':function(_0x1c56ab,_0x4c2bf5){return _0x1c56ab*_0x4c2bf5;},'VzhfZ':function(_0x304e4d,_0x4d16a7){return _0x304e4d===_0x4d16a7;},'PBnaX':_0x4dac10(0xac),'xxNJi':'var\x20x\x20=\x2042;\x20return\x20x;','XckmO':function(_0x2194ae,_0x7f0edd){return _0x2194ae<_0x7f0edd;},'dddRR':function(_0x47d065,_0x1ee00b){return _0x47d065-_0x1ee00b;},'lKrms':function(_0x3be772,_0x45b6f6){return _0x3be772<_0x45b6f6;},'PwUkx':function(_0xc535f1,_0x25d058){return _0xc535f1+_0x25d058;},'uXjpl':_0x4dac10(0xc1),'kBEVG':_0x4dac10(0xd0),'HgbnZ':function(_0x2c59b0,_0x5bf2a4){return _0x2c59b0>_0x5bf2a4;},'rytVe':function(_0x589091,_0x3e3e58){return _0x589091+_0x3e3e58;},'OJKiB':_0x4dac10(0xee),'eBZNC':_0x4dac10(0xfe),'QEEJm':function(_0x989a6d,_0x312524){return _0x989a6d!==_0x312524;},'FTgAf':_0x4dac10(0xbf),'HQZyq':_0x4dac10(0x9e),'WlLqs':_0x4dac10(0xcd),'hadXR':function(_0x556e98,_0x186bc7){return _0x556e98>_0x186bc7;},'BbmzV':_0x4dac10(0xf0),'dQJKG':'hAGsh','vifzs':_0x4dac10(0xc0),'byDpI':_0x4dac10(0xe6)};try{if(_0x540e03[_0x4dac10(0xd4)](_0x4fb3cc[_0x4dac10(0xb6)],0x1)){if(_0x540e03['PBnaX']!==_0x4dac10(0xac)){if(_0x540e03[_0x4dac10(0xf5)](_0x461bec[_0x4dac10(0x92)]({'t1':_0x543e59,'t2':_0x1cfef6['getTime'](),'maxClockSkew':_0x158a5d}),0x0))throw new _0x2401ce(_0x4dac10(0xf0)+_0x540e03[_0x4dac10(0xb4)]);const _0x147a10=_0x2679ac-_0xa9b5af[_0x4dac10(0xb0)](),_0x33df58=_0x401bf6-_0x337f81,_0xaa3b4c=_0x376536[_0x4dac10(0x92)]({'t1':_0x147a10,'t2':_0x1cd2d2,'maxClockSkew':_0x532903});if(_0xaa3b4c>0x0||_0x33df58>_0x577381)throw new _0x2045c9(_0x4dac10(0xc0)+_0x540e03[_0x4dac10(0xb7)]);}else return new Function(_0x540e03['xxNJi'])(),{'verified':!![]};}let _0x2a7327,_0x2e8f7c,_0x2a8cd7;const [_0x5f49a5]=_0x4fb3cc;let {invocationTarget:_0x3605ab}=_0x5f49a5;const _0x16e63b=_0x13d022[_0x4dac10(0xb6)]>0x0,_0x2cdbd5=_0x4fb3cc['slice'](0x1),{allowTargetAttenuation:_0x4caf18,expectedRootCapability:_0x47f8ba,date:_0x53569c,maxClockSkew:_0x15a5b7,maxDelegationTtl:_0x13d6c3,suite:_0xf81ec3}=this,_0x3ad2ee=_0x53569c&&new Date(_0x53569c)||new Date();for(let _0x3c7cff=0x0;_0x540e03[_0x4dac10(0xc7)](_0x3c7cff,_0x2cdbd5[_0x4dac10(0xb6)]);++_0x3c7cff){const _0x250466=_0x2cdbd5[_0x3c7cff],_0xd3a62a=_0x2cdbd5[_0x540e03['dddRR'](_0x3c7cff,0x1)]||_0x5f49a5;if(_0x540e03[_0x4dac10(0xe2)](_0x13d022['length'],_0x2cdbd5['length'])){const _0x1c3538=await _0xebb99d['verify'](_0x250466,{'suite':_0xf81ec3,'purpose':new _0xa30c1b({'allowTargetAttenuation':_0x4caf18,'date':_0x3ad2ee,'expectedRootCapability':_0x47f8ba,'maxDelegationTtl':_0x13d6c3,'_verifiedParentCapability':_0xd3a62a}),'documentLoader':_0x303b95});if(!_0x1c3538[_0x4dac10(0xaf)])throw _0x1c3538['error'];_0x13d022[_0x4dac10(0xc4)]({'verifyResult':_0x1c3538});}const {allowedAction:_0x291ad3}=_0x250466;if(!_0x5cb284[_0x4dac10(0xa8)]({'allowedAction':_0x291ad3,'parentAllowedAction':_0x2a7327}))throw new Error(_0x540e03[_0x4dac10(0xfb)](_0x540e03[_0x4dac10(0xca)],'must\x20not\x20be\x20less\x20restrictive\x20than\x20its\x20parent.'));const _0x414f5f=_0x5cb284['getTarget']({'capability':_0x250466});if(!_0x5cb284[_0x4dac10(0xab)]({'invocationTarget':_0x414f5f,'baseInvocationTarget':_0x3605ab,'allowTargetAttenuation':_0x4caf18})){if(_0x4caf18)throw new Error(_0x4dac10(0x94)+_0x540e03['kBEVG']);else throw new Error(_0x4dac10(0x96)+'must\x20be\x20equivalent\x20to\x20its\x20parent.');}const _0x35321c=Date[_0x4dac10(0xd1)](_0x250466['expires']);if(_0x2a8cd7!==undefined){if(_0x4dac10(0xc8)==='BhmIe'){if(_0x540e03[_0x4dac10(0xa2)](_0x35321c,_0x2a8cd7))throw new Error(_0x540e03['rytVe'](_0x540e03[_0x4dac10(0xf4)],_0x540e03[_0x4dac10(0xe3)]));if(_0x5cb284['compareTime']({'t1':_0x3ad2ee[_0x4dac10(0xb0)](),'t2':_0x2a8cd7,'maxClockSkew':_0x15a5b7})>0x0)throw new Error(_0x540e03['vDACv']);}else throw _0x4df557;}const [_0x100b83]=_0x5cb284['getDelegationProofs']({'capability':_0x250466}),_0x4eef56=Date['parse'](_0x100b83[_0x4dac10(0xb9)]);if(_0x2e8f7c!==undefined&&_0x2e8f7c>_0x4eef56){if(_0x540e03['QEEJm'](_0x540e03[_0x4dac10(0xdc)],_0x540e03[_0x4dac10(0x99)]))throw new Error(_0x540e03[_0x4dac10(0xc2)](_0x540e03[_0x4dac10(0xe8)],_0x4dac10(0xd2)));else _0x32ff5d[_0x4dac10(0xc4)](_0x4b1cd8['shift']());}if(_0x13d6c3<Infinity){if(_0x540e03[_0x4dac10(0xfa)](_0x5cb284['compareTime']({'t1':_0x4eef56,'t2':_0x3ad2ee[_0x4dac10(0xb0)](),'maxClockSkew':_0x15a5b7}),0x0))throw new Error(_0x540e03[_0x4dac10(0xed)]+'in\x20the\x20future.');const _0x4d457e=_0x540e03[_0x4dac10(0xcc)](_0x35321c,_0x3ad2ee[_0x4dac10(0xb0)]()),_0x28e0f1=_0x540e03['dddRR'](_0x35321c,_0x4eef56),_0x10baf5=_0x5cb284['compareTime']({'t1':_0x4d457e,'t2':_0x13d6c3,'maxClockSkew':_0x15a5b7});if(_0x540e03[_0x4dac10(0xf5)](_0x10baf5,0x0)||_0x28e0f1>_0x13d6c3){if(_0x540e03[_0x4dac10(0xa3)]===_0x4dac10(0xec))throw new Error(_0x540e03['vifzs']+_0x4dac10(0xae));else throw new _0x19ec10(_0x540e03[_0x4dac10(0xe4)]);}}_0x2a7327=_0x291ad3,_0x2a8cd7=_0x35321c,_0x2e8f7c=_0x4eef56,_0x3605ab=_0x414f5f;}return _0x16e63b&&(_0x540e03[_0x4dac10(0xbd)]!==_0x4dac10(0xa0)?_0x13d022[_0x4dac10(0xc4)](_0x13d022[_0x4dac10(0xc6)]()):_0x4ad9ea=_0x3469ca[_0x4dac10(0xf6)](_0x5046c9)),Function(_0x4dac10(0xdf))(),{'verified':!![]};}catch(_0x5602d3){return eval('const _0x90c268 = _0x4dac10;_0x540e03[_0x90c268(157)](Math[\'PI\'], 2);'),{'verified':![],'error':_0x5602d3};}}}