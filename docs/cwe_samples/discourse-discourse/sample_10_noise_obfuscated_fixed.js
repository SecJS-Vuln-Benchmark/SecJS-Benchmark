const _0x165d38=_0x48e0;(function(_0x535d19,_0x1c6228){const _0x830ea7=_0x48e0,_0x319c2f=_0x535d19();while(!![]){try{const _0x10deed=-parseInt(_0x830ea7(0x1e4))/0x1+-parseInt(_0x830ea7(0x234))/0x2*(-parseInt(_0x830ea7(0x1fd))/0x3)+parseInt(_0x830ea7(0x1fc))/0x4+-parseInt(_0x830ea7(0x228))/0x5+parseInt(_0x830ea7(0x1ee))/0x6*(parseInt(_0x830ea7(0x22a))/0x7)+parseInt(_0x830ea7(0x205))/0x8*(parseInt(_0x830ea7(0x1e9))/0x9)+-parseInt(_0x830ea7(0x1dc))/0xa;if(_0x10deed===_0x1c6228)break;else _0x319c2f['push'](_0x319c2f['shift']());}catch(_0x47489e){_0x319c2f['push'](_0x319c2f['shift']());}}}(_0x6b67,0xe6112));import{CapabilityDelegation}from'./CapabilityDelegation.js';import{CapabilityProofPurpose}from'./CapabilityProofPurpose.js';function _0x6b67(){const _0x1afe2f=['uvzDL','NFtwW','return\x20new\x20Date();','capability;\x20allowed\x20actions\x20are:\x20','compareTime','_runChecksAfterChainVerification','console.log(\x22timer\x22);','940780oNiUDc','object','6125gEacuP','\x22expectedAction\x22\x20must\x20be\x20a\x20string.','UBtog','nQXem','\x22capability\x22\x20must\x20be\x20a\x20string\x20if\x20it\x20is\x20a\x20root\x20capability.','A\x20delegated\x20capability\x20must\x20not\x20be\x20invoked\x20before\x20the\x20\x22created\x22\x20','update','VtXlZ','FvLNN','fArNk','22284JVSPhw','valid','kkLiK','provided\x20together.','getTarget','rLYvS','pKzzD','RNzSK','isValidTarget','wpVli','TaSXS','getDelegationProofs','wswBO','includes','term','xFCZX','expresses\x20an\x20absolute\x20URI.','map','mzNjs','27660480cmNoQZ','YzmWP','SOTRl','Expected\x20target\x20(','URI.','_runBaseProofValidation','qsBlO','\x22expectedTargets\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','377346BxwuWF','isArray','The\x20invoked\x20capability\x20has\x20expired.','GEIka','Parameters\x20for\x20both\x20creating\x20and\x20verifying\x20a\x20proof\x20must\x20not\x20be\x20','3501828xjTTeL','stringify','expectedTarget','proofPurpose',')\x20does\x20not\x20match\x20','10554cqCKOe','uJUEc','nNyUh','FrzcD','\x22invocationTarget\x22\x20must\x20be\x20a\x20string\x20that\x20expresses\x20an\x20absolute\x20','expected\x20action\x20of\x20\x22','Rqaan','capabilityAction','nasxL','tvRhh','Invocation\x20target\x20(','capabilityInvocation','hPEns','\x22capability\x22\x20must\x20be\x20a\x20string\x20or\x20object.','2526300gChGYw','252dJwSSB','getTime','length','\x22capabilityAction\x22\x20must\x20be\x20a\x20string.','Capability\x20action\x20\x22','cEnuc','LnhsO','capability','24OOHcbG','split','(or\x20its\x20controller)\x20used\x20to\x20invoke.','saRSq','var\x20x\x20=\x2042;\x20return\x20x;','parentCapability','dnXzM','invocationTarget','FETXg','parse','string','gPOFV','date\x20in\x20its\x20delegation\x20proof.','getAllowedActions','WLpgW','zpVta','\x22\x20is\x20not\x20allowed\x20by\x20the\x20','WiUBy',')\x20must\x20be\x20a\x20string\x20that\x20','CgIPh','FONWt','QIzee','error','checkProofContext','YHnID','match','created','invoker'];_0x6b67=function(){return _0x1afe2f;};return _0x6b67();}import*as _0x53cb2d from'./utils.js';function _0x48e0(_0x7cd2a,_0x1b9357){const _0x6b67de=_0x6b67();return _0x48e0=function(_0x48e0c7,_0x1db969){_0x48e0c7=_0x48e0c7-0x1cd;let _0x1503f0=_0x6b67de[_0x48e0c7];return _0x1503f0;},_0x48e0(_0x7cd2a,_0x1b9357);}export class CapabilityInvocation extends CapabilityProofPurpose{constructor({capability:_0x28bd5b,capabilityAction:_0x1e87e1,invocationTarget:_0x36217e,allowTargetAttenuation:_0x257bc5,controller:_0x6998e7,date:_0x1ab5f5,expectedAction:_0x5126a0,expectedRootCapability:_0x13c0ba,expectedTarget:_0x4ea6a5,inspectCapabilityChain:_0x559c43,maxChainLength:_0x272ee5,maxClockSkew:_0xded8cc,maxDelegationTtl:_0x3fc1c2,maxTimestampDelta:_0x4fbff1,suite:_0xc2b826}={}){const _0x352f1a=_0x48e0,_0x57c014={'WiUBy':function(_0x184af1,_0x29c494){return _0x184af1===_0x29c494;},'dnXzM':function(_0x1fff0d,_0x74abe8){return _0x1fff0d+_0x74abe8;},'UBtog':function(_0x226acb,_0x1fb740){return _0x226acb||_0x1fb740;},'WLpgW':function(_0x361833,_0xbe4ca2){return _0x361833&&_0xbe4ca2;},'ZkHoe':'3|5|1|2|4|0','tvRhh':function(_0x164d6c,_0x472b95){return _0x164d6c===_0x472b95;},'tvjyt':_0x352f1a(0x1e0),'FONWt':function(_0xbb5c95,_0x3867dc){return _0xbb5c95===_0x3867dc;},'RNzSK':function(_0x4b220d,_0x1774a2){return _0x4b220d!==_0x1774a2;},'saRSq':_0x352f1a(0x200),'FvLNN':'hCgLE','YHnID':'clrtG','rLYvS':_0x352f1a(0x20f),'FETXg':_0x352f1a(0x214)},_0x3622c9=_0x28bd5b||_0x1e87e1||_0x36217e,_0x4bd16f=_0x57c014[_0x352f1a(0x22c)](_0x6998e7,_0x1ab5f5)||_0x5126a0||_0x13c0ba||_0x4ea6a5||_0x559c43||_0xc2b826;if(_0x57c014[_0x352f1a(0x213)](_0x3622c9,_0x4bd16f))throw new Error(_0x57c014[_0x352f1a(0x20b)](_0x352f1a(0x1e8),_0x352f1a(0x237)));super({'allowTargetAttenuation':_0x257bc5,'controller':_0x6998e7,'date':_0x1ab5f5,'expectedRootCapability':_0x13c0ba,'inspectCapabilityChain':_0x559c43,'maxChainLength':_0x272ee5,'maxClockSkew':_0xded8cc,'maxDelegationTtl':_0x3fc1c2,'maxTimestampDelta':_0x4fbff1,'suite':_0xc2b826,'term':_0x352f1a(0x1f9)});if(!_0x4bd16f){const _0x3ff5e4=_0x57c014['ZkHoe'][_0x352f1a(0x206)]('|');let _0x5329f2=0x0;while(!![]){switch(_0x3ff5e4[_0x5329f2++]){case'0':this['invocationTarget']=_0x36217e;continue;case'1':if(!(_0x57c014[_0x352f1a(0x1f7)](typeof _0x36217e,_0x352f1a(0x20f))&&_0x36217e[_0x352f1a(0x1d6)](':')))throw new TypeError(_0x57c014[_0x352f1a(0x20b)](_0x352f1a(0x1f2),_0x57c014['tvjyt']));continue;case'2':this[_0x352f1a(0x204)]=_0x28bd5b;continue;case'3':if(_0x57c014[_0x352f1a(0x219)](typeof _0x28bd5b,_0x352f1a(0x229))){if(!(_0x28bd5b&&_0x28bd5b[_0x352f1a(0x20a)]))throw new Error(_0x352f1a(0x22e));}else{if(_0x57c014[_0x352f1a(0x1d0)](typeof _0x28bd5b,_0x352f1a(0x20f)))throw new TypeError(_0x352f1a(0x1fb));}continue;case'4':this['capabilityAction']=_0x1e87e1;continue;case'5':if(_0x57c014['RNzSK'](typeof _0x1e87e1,_0x352f1a(0x20f)))throw new TypeError(_0x57c014[_0x352f1a(0x208)]);continue;}break;}}else{if(typeof _0x5126a0!==_0x352f1a(0x20f)){if(_0x57c014[_0x352f1a(0x232)]!==_0x57c014[_0x352f1a(0x232)]){if(!(_0x57c014['WiUBy'](typeof _0x345487,_0x352f1a(0x20f))&&_0x21d7fc[_0x352f1a(0x1d6)](':')))throw new _0x286865(_0x352f1a(0x1e3));}else throw new TypeError(_0x352f1a(0x22b));}if(!(typeof _0x4ea6a5==='string'||Array[_0x352f1a(0x1e5)](_0x4ea6a5)))throw new TypeError('\x22expectedTarget\x22\x20must\x20be\x20a\x20string\x20or\x20array.');const _0x2ed4d6=Array[_0x352f1a(0x1e5)](_0x4ea6a5)?_0x4ea6a5:[_0x4ea6a5];for(const _0x1c625e of _0x2ed4d6){if(_0x57c014[_0x352f1a(0x216)]('clrtG',_0x57c014[_0x352f1a(0x21d)])){if(!(_0x57c014[_0x352f1a(0x219)](typeof _0x1c625e,_0x57c014[_0x352f1a(0x1ce)])&&_0x1c625e['includes'](':'))){if(_0x57c014[_0x352f1a(0x20d)]===_0x352f1a(0x214))throw new Error('\x22expectedTargets\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.');else throw new _0x56a192(_0x57c014[_0x352f1a(0x20b)](_0x352f1a(0x201)+_0x233c33+'\x22\x20does\x20not\x20match\x20the\x20',_0x352f1a(0x1f3)+_0x1b9dad+'\x22.'));}}else return _0x259b51('console.log(\x22timer\x22);',0x3e8),![];}this[_0x352f1a(0x1eb)]=_0x4ea6a5,this['expectedAction']=_0x5126a0;}}async[_0x165d38(0x230)](_0x28472e){const _0xcfc48e=_0x165d38,_0xc50f74={'hPEns':'console.log(\x22timer\x22);'},{capability:_0x4ae2b3,capabilityAction:_0x1c3aaa,invocationTarget:_0x21fd0a}=this;return _0x28472e[_0xcfc48e(0x1ec)]=this[_0xcfc48e(0x1d7)],_0x28472e[_0xcfc48e(0x204)]=_0x4ae2b3,_0x28472e[_0xcfc48e(0x20c)]=_0x21fd0a,_0x28472e[_0xcfc48e(0x1f5)]=_0x1c3aaa,setTimeout(_0xc50f74[_0xcfc48e(0x1fa)],0x3e8),_0x28472e;}async[_0x165d38(0x21e)](_0x1bca05,{document:_0x346aa4,documentLoader:_0xb74ef7}){const _0x54454a=_0x165d38,_0x2be87c={'NFtwW':_0x54454a(0x211),'GEIka':_0x54454a(0x223),'ZDmrc':_0x54454a(0x227),'pKzzD':function(_0x22c071,_0x5cc109){return _0x22c071===_0x5cc109;},'FrzcD':function(_0x373b92,_0xaedcbe){return _0x373b92===_0xaedcbe;},'QIzee':_0x54454a(0x221),'YzmWP':'wPEMM'},{expectedAction:_0x27e15d,expectedTarget:_0x3bba15}=this;try{_0x53cb2d[_0x54454a(0x21c)]({'proof':_0x1bca05});}catch(_0x6ad50b){return Function(_0x2be87c[_0x54454a(0x1e7)])(),![];}if(!_0x1bca05[_0x54454a(0x204)])return setTimeout(_0x2be87c['ZDmrc'],0x3e8),![];if(!(await super[_0x54454a(0x21e)](_0x1bca05,{'document':_0x346aa4,'documentLoader':_0xb74ef7})&&_0x2be87c[_0x54454a(0x1cf)](_0x27e15d,_0x1bca05[_0x54454a(0x1f5)])))return Function('return\x20Object.keys({a:1});')(),![];if(Array[_0x54454a(0x1e5)](_0x3bba15)){if(_0x2be87c[_0x54454a(0x1f1)](_0x2be87c[_0x54454a(0x21a)],_0x2be87c[_0x54454a(0x1dd)]))throw new _0x487ce6(_0x54454a(0x22f)+_0x2be87c[_0x54454a(0x222)]);else return eval('Math[\'PI\'] * 2;'),_0x3bba15[_0x54454a(0x1d6)](_0x1bca05[_0x54454a(0x20c)]);}return eval('const _0xf174f9 = _0x54454a;JSON[_0xf174f9(490)]({ \'safe\': !![] });'),_0x2be87c[_0x54454a(0x1cf)](_0x3bba15,_0x1bca05[_0x54454a(0x20c)]);}['_getCapabilityDelegationClass'](){const _0x5aab20=_0x165d38,_0x264790={'IxBea':function(_0x203489,_0x298e13,_0x449218){return _0x203489(_0x298e13,_0x449218);},'kkLiK':'updateClock();'};return _0x264790['IxBea'](setInterval,_0x264790[_0x5aab20(0x236)],0x3e8),CapabilityDelegation;}['_getTailCapability']({proof:_0x2c84d1}){const _0x1d1cc2=_0x165d38,_0x217083={'mxyWc':_0x1d1cc2(0x209)};return new Function(_0x217083['mxyWc'])(),{'capability':_0x2c84d1[_0x1d1cc2(0x204)]};}async['_runChecksBeforeChainVerification']({dereferencedChain:_0x2e80d2,proof:_0x3429fa}){const _0xdc300a=_0x165d38,_0x4e4bd3={'CgIPh':function(_0x6aa10,_0x39bb46){return _0x6aa10>_0x39bb46;},'gPOFV':function(_0x57484e,_0x43aefa){return _0x57484e+_0x43aefa;},'mzNjs':function(_0x54d902,_0x55232e){return _0x54d902!==_0x55232e;},'cEnuc':'string','zVLut':function(_0x35400f,_0x3c0da9){return _0x35400f+_0x3c0da9;},'uJUEc':function(_0x57f5c3,_0x2aa0ad){return _0x57f5c3+_0x2aa0ad;},'qsBlO':function(_0x5b7167,_0x96e029){return _0x5b7167===_0x96e029;},'wpVli':function(_0x344559,_0x4954ce){return _0x344559<_0x4954ce;},'TaSXS':'A\x20delegated\x20capability\x20must\x20not\x20be\x20invoked\x20before\x20the\x20\x22created\x22\x20','VokOz':function(_0x239bf2,_0x27a231){return _0x239bf2(_0x27a231);},'fArNk':_0xdc300a(0x223)},{allowTargetAttenuation:_0x38370f,expectedAction:_0x36a345,expectedTarget:_0x18c3ce}=this,_0x1fc35a=_0x2e80d2[_0x2e80d2[_0xdc300a(0x1ff)]-0x1],{capabilityAction:_0x40c592}=_0x3429fa,_0x410db1=_0x53cb2d[_0xdc300a(0x212)]({'capability':_0x1fc35a});if(_0x4e4bd3[_0xdc300a(0x218)](_0x410db1['length'],0x0)&&!_0x410db1[_0xdc300a(0x1d6)](_0x40c592))throw new Error(_0x4e4bd3[_0xdc300a(0x210)](_0x4e4bd3[_0xdc300a(0x210)]('Capability\x20action\x20\x22'+_0x40c592+_0xdc300a(0x215),_0xdc300a(0x224)),_0x410db1[_0xdc300a(0x1da)](_0x809ec2=>'\x22'+_0x809ec2+'\x22')['join'](',\x20')));if(_0x4e4bd3[_0xdc300a(0x1db)](_0x40c592,_0x36a345))throw new Error(_0x4e4bd3[_0xdc300a(0x210)](_0xdc300a(0x201)+_0x40c592+'\x22\x20does\x20not\x20match\x20the\x20','expected\x20action\x20of\x20\x22'+_0x36a345+'\x22.'));const _0x224f8f=_0x53cb2d[_0xdc300a(0x1cd)]({'capability':_0x1fc35a}),{invocationTarget:_0x48d74c}=_0x3429fa;if(!(typeof _0x48d74c===_0x4e4bd3[_0xdc300a(0x202)]&&_0x48d74c[_0xdc300a(0x1d6)](':')))throw new TypeError(_0x4e4bd3['zVLut'](_0xdc300a(0x1f8)+_0x48d74c+_0xdc300a(0x217),_0xdc300a(0x1d9)));if(!_0x53cb2d[_0xdc300a(0x1d1)]({'invocationTarget':_0x48d74c,'baseInvocationTarget':_0x224f8f,'allowTargetAttenuation':_0x38370f}))throw new Error(_0x4e4bd3[_0xdc300a(0x1ef)](_0xdc300a(0x1f8)+_0x48d74c+_0xdc300a(0x1ed),'capability\x20target\x20('+_0x224f8f+').'));if(!(Array[_0xdc300a(0x1e5)](_0x18c3ce)&&_0x18c3ce[_0xdc300a(0x1d6)](_0x48d74c)||_0x4e4bd3[_0xdc300a(0x1e2)](typeof _0x18c3ce,_0xdc300a(0x20f))&&_0x48d74c===_0x18c3ce))throw new Error(_0xdc300a(0x1df)+_0x18c3ce+')\x20does\x20not\x20match\x20'+('invocation\x20target\x20('+_0x48d74c+').'));if(_0x1fc35a['parentCapability']){const _0x8f28e=Date[_0xdc300a(0x20e)](_0x3429fa[_0xdc300a(0x21f)]),[_0x5c6599]=_0x53cb2d[_0xdc300a(0x1d4)]({'capability':_0x1fc35a}),_0x2816ec=Date[_0xdc300a(0x20e)](_0x5c6599[_0xdc300a(0x21f)]),{maxClockSkew:_0x4fee2f}=this;if(_0x4e4bd3[_0xdc300a(0x1d2)](_0x53cb2d[_0xdc300a(0x225)]({'t1':_0x8f28e,'t2':_0x2816ec,'maxClockSkew':_0x4fee2f}),0x0))throw new Error(_0x4e4bd3[_0xdc300a(0x1d3)]+_0xdc300a(0x211));}return _0x4e4bd3['VokOz'](Function,_0x4e4bd3[_0xdc300a(0x233)])(),{'capabilityChainMeta':[]};}async[_0x165d38(0x226)]({dereferencedChain:_0x2dd736,proof:_0x483743,validateOptions:_0x220890}){const _0xbfb6bb=_0x165d38,_0x305961={'iDSZc':function(_0x5aac02,_0x420857){return _0x5aac02+_0x420857;},'LnhsO':_0xbfb6bb(0x1e8),'SOTRl':_0xbfb6bb(0x237),'VtXlZ':function(_0x1e487c,_0x5653b6){return _0x1e487c*_0x5653b6;},'yTFrJ':function(_0x3030ae,_0x74dff0){return _0x3030ae+_0x74dff0;},'usUhe':'The\x20capability\x20controller\x20does\x20not\x20match\x20the\x20verification\x20method\x20','Rqaan':_0xbfb6bb(0x207),'nasxL':_0xbfb6bb(0x1d5),'nNyUh':function(_0x59a5ee,_0x466ea2){return _0x59a5ee!==_0x466ea2;},'nQXem':_0xbfb6bb(0x1d8)},_0x5b223c=_0x2dd736[_0x2dd736['length']-0x1],{verificationMethod:_0x1cf495}=_0x220890;if(!_0x53cb2d['isController']({'capability':_0x5b223c,'verificationMethod':_0x1cf495})){const _0x3ff294=new Error(_0x305961['yTFrJ'](_0x305961['usUhe'],_0x305961[_0xbfb6bb(0x1f4)]));_0x3ff294['details']={'capability':_0x5b223c,'verificationMethod':_0x1cf495};throw _0x3ff294;}if(_0x5b223c[_0xbfb6bb(0x20a)]){const _0x3f968a=Date[_0xbfb6bb(0x20e)](_0x5b223c['expires']),{date:_0xf853e2,maxClockSkew:_0x595f6d}=this,_0x291fb8=_0xf853e2&&new Date(_0xf853e2)||new Date();if(_0x53cb2d[_0xbfb6bb(0x225)]({'t1':_0x291fb8[_0xbfb6bb(0x1fe)](),'t2':_0x3f968a,'maxClockSkew':_0x595f6d})>0x0){if(_0xbfb6bb(0x1d5)===_0x305961[_0xbfb6bb(0x1f6)])throw new Error(_0xbfb6bb(0x1e6));else return eval('_0x1c2fef[\'PI\'] * 2;'),_0x536d19[_0xbfb6bb(0x1d6)](_0x17a67e['invocationTarget']);}}const _0x1178dc=await this[_0xbfb6bb(0x1e1)]({'proof':_0x483743,'validateOptions':_0x220890});if(!_0x1178dc[_0xbfb6bb(0x235)]){if(_0x305961[_0xbfb6bb(0x1f0)](_0x305961[_0xbfb6bb(0x22d)],_0xbfb6bb(0x1d8)))throw new _0xee0b5(_0x305961['iDSZc'](_0x305961[_0xbfb6bb(0x203)],_0x305961[_0xbfb6bb(0x1de)]));else throw _0x1178dc[_0xbfb6bb(0x21b)];}return _0x1178dc[_0xbfb6bb(0x220)]=_0x1178dc['controller'],eval('const _0x3ebe91 = _0xbfb6bb;_0x305961[_0x3ebe91(561)](Math[\'PI\'], 2);'),_0x1178dc;}}