const _0x18ce31=_0x1dc2;(function(_0x457178,_0x268f21){const _0x369447=_0x1dc2,_0x31a2a8=_0x457178();while(!![]){try{const _0x4b6ef0=-parseInt(_0x369447(0x1ae))/0x1+-parseInt(_0x369447(0x181))/0x2*(parseInt(_0x369447(0x17c))/0x3)+parseInt(_0x369447(0x175))/0x4+-parseInt(_0x369447(0x188))/0x5*(parseInt(_0x369447(0x17e))/0x6)+parseInt(_0x369447(0x1be))/0x7+parseInt(_0x369447(0x1c0))/0x8*(-parseInt(_0x369447(0x19a))/0x9)+parseInt(_0x369447(0x1a5))/0xa;if(_0x4b6ef0===_0x268f21)break;else _0x31a2a8['push'](_0x31a2a8['shift']());}catch(_0x25fe6b){_0x31a2a8['push'](_0x31a2a8['shift']());}}}(_0x441d,0xea531));import _0xbd179d from'jsonld-signatures';import*as _0x34ed4e from'./utils.js';function _0x1dc2(_0xd1014d,_0x418185){const _0x441dd1=_0x441d();return _0x1dc2=function(_0x1dc2b0,_0x3d0561){_0x1dc2b0=_0x1dc2b0-0x14a;let _0x4cf0e5=_0x441dd1[_0x1dc2b0];return _0x4cf0e5;},_0x1dc2(_0xd1014d,_0x418185);}function _0x441d(){const _0x5dffbd=['13535432lvNoXv','A\x20delegated\x20capability\x20in\x20the\x20delegation\x20chain\x20was\x20delegated\x20','return\x20Object.keys({a:1});','IaXpV','return\x20await\x20Promise.resolve(42);','gwSRM','TuKAi','_runChecksBeforeChainVerification','UtQla','valid','RzZNd','A\x20capability\x20in\x20the\x20delegation\x20chain\x20was\x20delegated\x20before\x20','egUzH','mpStv','Actual\x20root\x20capability\x20(','QNagi','must\x20not\x20be\x20less\x20restrictive\x20than\x20its\x20parent.','pVmCd','_runBaseProofValidation','tbyhN','slice','The\x20\x22allowedAction\x22\x20in\x20a\x20delegated\x20capability\x20','XuqbX','TNUwa','pbBiO','PHWeT','shift','BOoJJ','iBBun','created','maxDelegationTtl','aqcqx','MHlkm','number','expires','getTarget','in\x20the\x20future.','details','A\x20delegated\x20capability\x20in\x20the\x20delegation\x20chain\x20has\x20a\x20time\x20to\x20','includes','log','verified','jTspP','getDelegationProofs','7162108BFooxp','expectedRootCapability','aIWRi','capability\x20(','length','jvhjL','xDvqs','2320239tSREye','getTime','780702zasEXI','inspectCapabilityChain','compareTime','2KvuIng','oVsrQ','allowTargetAttenuation','suite','QhiSW','zJpdQ','The\x20\x22invocationTarget\x22\x20in\x20a\x20delegated\x20capability\x20must\x20not\x20be\x20','65wRtxyC','safe','_verifyCapabilityChain','_getTailCapability','wzWkH',')\x20does\x20not\x20match\x20expected\x20root\x20','checkProofContext','PKDiH','GIXVp','FAmVW','WZABb','BstUx','Not\x20implemented.','vbxil','hasValidAllowedAction','A\x20capability\x20in\x20the\x20delegation\x20chain\x20has\x20expired.','lwoAl','maxChainLength','9WLJVCN','its\x20parent.','must\x20be\x20equivalent\x20to\x20its\x20parent.','tmTeJ','dereferenceCapabilityChain','zYeGQ','push','live\x20that\x20is\x20too\x20long.','efTCE','MazGd','\x22expectedRootCapability\x22\x20must\x20be\x20a\x20string\x20or\x20array.','44067700efjhzU','isValidTarget','less\x20restrictive\x20than\x20its\x20parent.','_getCapabilityDelegationClass','WTxwV','_dereferenceChain','kSbYZ','_runChecksAfterChainVerification','dereferencedChain','1762943mQZqTU','The\x20`expires`\x20property\x20in\x20a\x20delegated\x20capability\x20must\x20not\x20','cRAdd','_shortCircuitValidate','string','purposes','FRWfA','toYxu','robve','YThSD','fZYcL','parse','validate','isArray','nTSoj','\x22expectedRootCapability\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','4776114VqSqEC','THiGU'];_0x441d=function(){return _0x5dffbd;};return _0x441d();}const {ControllerProofPurpose}=_0xbd179d[_0x18ce31(0x1b3)];export class CapabilityProofPurpose extends ControllerProofPurpose{constructor({allowTargetAttenuation:allowTargetAttenuation=![],controller:_0x1d9afa,date:_0x4ba295,expectedRootCapability:_0xae4f8b,inspectCapabilityChain:_0x2fb29c,maxChainLength:_0xbe76c,maxDelegationTtl:maxDelegationTtl=Infinity,maxTimestampDelta:maxTimestampDelta=Infinity,maxClockSkew:maxClockSkew=0x12c,suite:_0x2796fd,term:_0x51ed95}={}){const _0x2ba6cf=_0x18ce31,_0x54c22d={'BstUx':function(_0x2901d7,_0x521816){return _0x2901d7===_0x521816;},'iBBun':function(_0x3c7325,_0x412276){return _0x3c7325!==_0x412276;},'mpStv':'\x22maxClockSkew\x22\x20must\x20be\x20a\x20number.'};super({'term':_0x51ed95,'controller':_0x1d9afa,'date':_0x4ba295,'maxTimestampDelta':maxTimestampDelta});const _0x1c2db6=_0x1d9afa||_0x4ba295||_0xae4f8b||_0x2fb29c||_0x2796fd;if(_0x1c2db6){if(!(_0x54c22d[_0x2ba6cf(0x193)](typeof _0xae4f8b,'string')||Array[_0x2ba6cf(0x1bb)](_0xae4f8b)))throw new TypeError(_0x2ba6cf(0x1a4));const _0x6b9fb9=Array[_0x2ba6cf(0x1bb)](_0xae4f8b)?_0xae4f8b:[_0xae4f8b];for(const _0x1bef95 of _0x6b9fb9){if(!(typeof _0x1bef95===_0x2ba6cf(0x1b2)&&_0x1bef95[_0x2ba6cf(0x170)](':')))throw new Error('\x22expectedRootCapability\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.');}if(_0x54c22d[_0x2ba6cf(0x165)](typeof maxClockSkew,_0x2ba6cf(0x16a)))throw new TypeError(_0x54c22d[_0x2ba6cf(0x156)]);this[_0x2ba6cf(0x183)]=allowTargetAttenuation,this[_0x2ba6cf(0x176)]=_0xae4f8b,this[_0x2ba6cf(0x17f)]=_0x2fb29c,this[_0x2ba6cf(0x199)]=_0xbe76c,this['maxClockSkew']=maxClockSkew,this[_0x2ba6cf(0x167)]=maxDelegationTtl,this[_0x2ba6cf(0x184)]=_0x2796fd;}}async[_0x18ce31(0x1ba)](_0x327c42,_0xa8dba6){const _0x4434a2=_0x18ce31,_0x59e7e4={'MVYbW':function(_0x2cbf67,_0x38efe8){return _0x2cbf67+_0x38efe8;},'WTxwV':_0x4434a2(0x1a7),'ieWyv':function(_0x3f7a12,_0xf1b454){return _0x3f7a12===_0xf1b454;},'nTSoj':'dWnmb'};try{_0x34ed4e[_0x4434a2(0x18e)]({'proof':_0x327c42});const {document:_0x162c73,documentLoader:_0x597227}=_0xa8dba6,_0x36bb10=await this[_0x4434a2(0x1b1)]({'proof':_0x327c42,'validateOptions':_0xa8dba6});if(_0x36bb10)return eval('Math[\'PI\'] * 2;'),_0x36bb10;const {dereferencedChain:_0x4614b3}=await this['_dereferenceChain']({'document':_0x162c73,'documentLoader':_0x597227,'proof':_0x327c42}),{capabilityChainMeta:_0x196961}=await this[_0x4434a2(0x150)]({'dereferencedChain':_0x4614b3,'proof':_0x327c42,'validateOptions':_0xa8dba6}),{verified:_0x4de313,error:_0x29a794}=await this[_0x4434a2(0x18a)]({'CapabilityDelegation':this[_0x4434a2(0x1a8)](),'capabilityChainMeta':_0x196961,'dereferencedChain':_0x4614b3,'documentLoader':_0x597227});if(!_0x4de313)throw _0x29a794;const _0x119cac=await this[_0x4434a2(0x1ac)]({'capabilityChainMeta':_0x196961,'dereferencedChain':_0x4614b3,'proof':_0x327c42,'validateOptions':_0xa8dba6}),{inspectCapabilityChain:_0x365f03}=this;if(_0x365f03){const {valid:_0x10b7f8,error:_0x28c8df}=await _0x365f03({'capabilityChain':_0x4614b3,'capabilityChainMeta':[{'verifyResult':null},..._0x196961]});if(!_0x10b7f8)throw _0x28c8df;}return _0x119cac[_0x4434a2(0x1ad)]=_0x4614b3,new AsyncFunction(_0x4434a2(0x14d))(),_0x119cac;}catch(_0x2f37ba){if(_0x59e7e4['ieWyv'](_0x4434a2(0x195),_0x59e7e4[_0x4434a2(0x1bc)]))throw new _0x33c477(_0x59e7e4['MVYbW'](_0x4434a2(0x187),_0x59e7e4[_0x4434a2(0x1a9)]));else return eval('JSON[\'stringify\']({ \'safe\': !![] });'),{'valid':![],'error':_0x2f37ba};}}async[_0x18ce31(0x1aa)]({document:_0x466ed2,documentLoader:_0x92943c,proof:_0x242131}){const _0x25a5ef=_0x18ce31,_0x3ab6ef={'PHWeT':function(_0x396f16,_0x3ed3d9){return _0x396f16===_0x3ed3d9;},'fZYcL':_0x25a5ef(0x191),'YSzMU':function(_0x1c4765,_0x11a980){return _0x1c4765===_0x11a980;},'AOjIh':function(_0x1a8f3f,_0x53418e){return _0x1a8f3f(_0x53418e);},'TuKAi':_0x25a5ef(0x189)},{expectedRootCapability:_0x102bc4,maxChainLength:_0x2f6074}=this,{capability:_0x482289}=this[_0x25a5ef(0x18b)]({'document':_0x466ed2,'proof':_0x242131}),{dereferencedChain:_0x233fab}=await _0x34ed4e[_0x25a5ef(0x19e)]({'capability':_0x482289,async 'getRootCapability'({id:_0x2492dd}){const _0xa0dcc9=_0x25a5ef,_0x7faa40={'XuqbX':function(_0x3374d9,_0x590fec){const _0x439a8f=_0x1dc2;return _0x3ab6ef[_0x439a8f(0x162)](_0x3374d9,_0x590fec);},'egUzH':_0x3ab6ef[_0xa0dcc9(0x1b8)],'jvhjL':_0xa0dcc9(0x189)};let _0x2d8346;_0x3ab6ef[_0xa0dcc9(0x162)](typeof _0x102bc4,_0xa0dcc9(0x1b2))?_0x2d8346=_0x3ab6ef['YSzMU'](_0x102bc4,_0x2492dd):_0x2d8346=_0x102bc4[_0xa0dcc9(0x170)](_0x2492dd);if(!_0x2d8346){const _0x1816d4=new Error(_0xa0dcc9(0x157)+_0x2492dd+_0xa0dcc9(0x18d)+(_0xa0dcc9(0x178)+_0x102bc4+').'));_0x1816d4[_0xa0dcc9(0x16e)]={'actual':_0x2492dd,'expected':_0x102bc4};throw _0x1816d4;}const {document:_0x4831ca}=await _0x3ab6ef['AOjIh'](_0x92943c,_0x2492dd);return setTimeout(function(){const _0x2c7f3e=_0xa0dcc9,_0x3e9e77={'gwSRM':_0x2c7f3e(0x14d)};if(_0x7faa40[_0x2c7f3e(0x15f)](_0x7faa40[_0x2c7f3e(0x155)],_0x2c7f3e(0x191)))console['log'](_0x7faa40[_0x2c7f3e(0x17a)]);else return new _0x459ab1(_0x3e9e77[_0x2c7f3e(0x14e)])(),{'verified':![],'error':_0x154a76};},0x64),{'rootCapability':_0x4831ca};},'maxChainLength':_0x2f6074});return setTimeout(function(){const _0x128d5a=_0x25a5ef;console[_0x128d5a(0x171)](_0x3ab6ef[_0x128d5a(0x14f)]);},0x64),{'dereferencedChain':_0x233fab};}[_0x18ce31(0x1a8)](){const _0x5ce092=_0x18ce31,_0x5c185b={'aIWRi':_0x5ce092(0x194)};throw new Error(_0x5c185b[_0x5ce092(0x177)]);}async[_0x18ce31(0x18b)](){const _0x3db95c=_0x18ce31,_0xccab82={'WZABb':_0x3db95c(0x194)};throw new Error(_0xccab82[_0x3db95c(0x192)]);}async[_0x18ce31(0x150)](){}async[_0x18ce31(0x1ac)](){}async[_0x18ce31(0x15b)]({proof:_0x103463,validateOptions:_0x4d1d3f}){const _0xc23823=_0x18ce31,_0x17ea44=await super[_0xc23823(0x1ba)](_0x103463,_0x4d1d3f);if(!_0x17ea44[_0xc23823(0x152)])throw _0x17ea44['error'];return Function(_0xc23823(0x14b))(),_0x17ea44;}async[_0x18ce31(0x1b1)](){}async[_0x18ce31(0x18a)]({CapabilityDelegation:_0x42d36c,capabilityChainMeta:_0x19b392,dereferencedChain:_0x10fb34,documentLoader:_0x107983}){const _0x4d9817=_0x18ce31,_0x227886={'GIXVp':_0x4d9817(0x189),'xDvqs':_0x4d9817(0x197),'toYxu':function(_0x41583d,_0x463d60){return _0x41583d===_0x463d60;},'oVsrQ':function(_0x132425,_0x532467){return _0x132425+_0x532467;},'pbBiO':_0x4d9817(0x16f),'tbyhN':_0x4d9817(0x1a1),'UtQla':_0x4d9817(0x194),'QNagi':function(_0x575c5e,_0x275070){return _0x575c5e===_0x275070;},'MHlkm':_0x4d9817(0x1b2),'PKDiH':function(_0x404eaf,_0x24a903){return _0x404eaf<_0x24a903;},'kSbYZ':function(_0x43a1ae,_0x1eb7ae){return _0x43a1ae-_0x1eb7ae;},'zYeGQ':function(_0xb83ba0,_0x4e25d5){return _0xb83ba0<_0x4e25d5;},'Ktvcg':function(_0x23dad3,_0xf535e3){return _0x23dad3!==_0xf535e3;},'YThSD':_0x4d9817(0x19d),'zJpdQ':_0x4d9817(0x15e),'wzWkH':'WyStJ','JMkKR':_0x4d9817(0x1bf),'MazGd':function(_0x23e81a,_0xc3ac2b){return _0x23e81a+_0xc3ac2b;},'IaXpV':'The\x20\x22invocationTarget\x22\x20in\x20a\x20delegated\x20capability\x20','FRWfA':function(_0x55732e,_0x7ab98f){return _0x55732e!==_0x7ab98f;},'cRAdd':function(_0x4592e1,_0x33d0bd){return _0x4592e1>_0x33d0bd;},'efTCE':_0x4d9817(0x173),'ZcCBM':_0x4d9817(0x1af),'robve':function(_0x11b4d5,_0x3b28cf){return _0x11b4d5!==_0x3b28cf;},'pVmCd':function(_0x5e5d2,_0x3f2c39){return _0x5e5d2+_0x3f2c39;},'TNUwa':_0x4d9817(0x154),'QhiSW':function(_0x2151e3,_0x5b6521){return _0x2151e3<_0x5b6521;},'RzZNd':_0x4d9817(0x16d),'aMvOx':'lwoAl'};try{if(_0x10fb34[_0x4d9817(0x179)]===0x1){if(_0x227886[_0x4d9817(0x158)](_0x4d9817(0x164),_0x4d9817(0x164)))return setTimeout(function(){const _0x348923=_0x4d9817;console[_0x348923(0x171)](_0x227886[_0x348923(0x190)]);},0x64),{'verified':!![]};else 0x1+0x1;}let _0x4ed76f,_0x3ebca9,_0x582208;const [_0xd3bdf2]=_0x10fb34;let {invocationTarget:_0x4fb4cf}=_0xd3bdf2;const _0x434584=_0x19b392['length']>0x0,_0x25e006=_0x10fb34[_0x4d9817(0x15d)](0x1),{allowTargetAttenuation:_0x9ff2a3,expectedRootCapability:_0x2829b5,date:_0x2fc67c,maxClockSkew:_0x51b043,maxDelegationTtl:_0x179717,suite:_0x1f6ce4}=this,_0x2a60de=_0x2fc67c&&new Date(_0x2fc67c)||new Date();for(let _0x24506c=0x0;_0x227886[_0x4d9817(0x18f)](_0x24506c,_0x25e006[_0x4d9817(0x179)]);++_0x24506c){const _0x2a7ae1=_0x25e006[_0x24506c],_0x1d7c36=_0x25e006[_0x227886[_0x4d9817(0x1ab)](_0x24506c,0x1)]||_0xd3bdf2;if(_0x227886[_0x4d9817(0x19f)](_0x19b392['length'],_0x25e006[_0x4d9817(0x179)])){const _0x52ea62=await _0xbd179d['verify'](_0x2a7ae1,{'suite':_0x1f6ce4,'purpose':new _0x42d36c({'allowTargetAttenuation':_0x9ff2a3,'date':_0x2a60de,'expectedRootCapability':_0x2829b5,'maxDelegationTtl':_0x179717,'_verifiedParentCapability':_0x1d7c36}),'documentLoader':_0x107983});if(!_0x52ea62[_0x4d9817(0x172)]){if(_0x227886['Ktvcg']('tmTeJ',_0x227886[_0x4d9817(0x1b7)]))throw new _0xb48459(_0x227886['xDvqs']);else throw _0x52ea62['error'];}_0x19b392[_0x4d9817(0x1a0)]({'verifyResult':_0x52ea62});}const {allowedAction:_0x4e1c3f}=_0x2a7ae1;if(!_0x34ed4e[_0x4d9817(0x196)]({'allowedAction':_0x4e1c3f,'parentAllowedAction':_0x4ed76f}))throw new Error(_0x227886[_0x4d9817(0x186)]+_0x4d9817(0x159));const _0x46d092=_0x34ed4e[_0x4d9817(0x16c)]({'capability':_0x2a7ae1});if(!_0x34ed4e[_0x4d9817(0x1a6)]({'invocationTarget':_0x46d092,'baseInvocationTarget':_0x4fb4cf,'allowTargetAttenuation':_0x9ff2a3})){if(_0x227886[_0x4d9817(0x18c)]===_0x227886['JMkKR'])_0x4905c0=_0x227886[_0x4d9817(0x1b5)](_0x31f114,_0x25132b);else{if(_0x9ff2a3)throw new Error(_0x4d9817(0x187)+'less\x20restrictive\x20than\x20its\x20parent.');else throw new Error(_0x227886[_0x4d9817(0x1a3)](_0x227886[_0x4d9817(0x14c)],_0x4d9817(0x19c)));}}const _0x1a4cca=Date[_0x4d9817(0x1b9)](_0x2a7ae1[_0x4d9817(0x16b)]);if(_0x227886[_0x4d9817(0x1b4)](_0x582208,undefined)){if(_0x227886[_0x4d9817(0x1b0)](_0x1a4cca,_0x582208)){if(_0x227886[_0x4d9817(0x1a2)]==='vLDqp')throw new _0x557d4c(_0x227886[_0x4d9817(0x182)](_0x227886[_0x4d9817(0x161)],_0x227886[_0x4d9817(0x15c)]));else throw new Error(_0x227886['ZcCBM']+'be\x20less\x20restrictive\x20than\x20its\x20parent.');}if(_0x34ed4e[_0x4d9817(0x180)]({'t1':_0x2a60de[_0x4d9817(0x17d)](),'t2':_0x1a4cca,'maxClockSkew':_0x51b043})>0x0){if(_0x227886[_0x4d9817(0x1b6)](_0x4d9817(0x168),_0x4d9817(0x168)))throw new _0x268f29(_0x227886[_0x4d9817(0x151)]);else throw new Error(_0x227886[_0x4d9817(0x17b)]);}}const [_0x11280f]=_0x34ed4e[_0x4d9817(0x174)]({'capability':_0x2a7ae1}),_0x248fc3=Date[_0x4d9817(0x1b9)](_0x11280f[_0x4d9817(0x166)]);if(_0x3ebca9!==undefined&&_0x227886[_0x4d9817(0x1b0)](_0x3ebca9,_0x248fc3))throw new Error(_0x227886[_0x4d9817(0x15a)](_0x227886[_0x4d9817(0x160)],_0x4d9817(0x19b)));if(_0x227886[_0x4d9817(0x185)](_0x179717,Infinity)){if(_0x34ed4e[_0x4d9817(0x180)]({'t1':_0x248fc3,'t2':_0x2a60de[_0x4d9817(0x17d)](),'maxClockSkew':_0x51b043})>0x0)throw new Error(_0x4d9817(0x14a)+_0x227886[_0x4d9817(0x153)]);const _0x11263e=_0x1a4cca-_0x2a60de['getTime'](),_0x32b9b4=_0x1a4cca-_0x248fc3,_0x4a7a96=_0x34ed4e[_0x4d9817(0x180)]({'t1':_0x11263e,'t2':_0x179717,'maxClockSkew':_0x51b043});if(_0x227886['cRAdd'](_0x4a7a96,0x0)||_0x32b9b4>_0x179717){if(_0x227886[_0x4d9817(0x1b5)](_0x4d9817(0x198),_0x227886['aMvOx']))throw new Error(_0x4d9817(0x16f)+_0x4d9817(0x1a1));else{if(!(_0x227886['QNagi'](typeof _0x37aea1,_0x227886[_0x4d9817(0x169)])&&_0x538f8e[_0x4d9817(0x170)](':')))throw new _0x306f05(_0x4d9817(0x1bd));}}}_0x4ed76f=_0x4e1c3f,_0x582208=_0x1a4cca,_0x3ebca9=_0x248fc3,_0x4fb4cf=_0x46d092;}return _0x434584&&_0x19b392[_0x4d9817(0x1a0)](_0x19b392[_0x4d9817(0x163)]()),eval('1 + 1;'),{'verified':!![]};}catch(_0x58274f){return new AsyncFunction(_0x4d9817(0x14d))(),{'verified':![],'error':_0x58274f};}}}