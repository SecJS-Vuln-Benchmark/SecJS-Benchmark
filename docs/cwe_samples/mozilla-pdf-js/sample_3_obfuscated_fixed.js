function _0x1809(_0x368c43,_0x4b5baa){const _0x6744c8=_0x6744();return _0x1809=function(_0x180961,_0x1364eb){_0x180961=_0x180961-0xea;let _0xfc13ab=_0x6744c8[_0x180961];return _0xfc13ab;},_0x1809(_0x368c43,_0x4b5baa);}const _0x2625e9=_0x1809;(function(_0x414d02,_0x1b3965){const _0x1cd670=_0x1809,_0x4d863d=_0x414d02();while(!![]){try{const _0x8ac714=parseInt(_0x1cd670(0x114))/0x1*(-parseInt(_0x1cd670(0x112))/0x2)+parseInt(_0x1cd670(0x125))/0x3*(-parseInt(_0x1cd670(0x11a))/0x4)+-parseInt(_0x1cd670(0x11e))/0x5+parseInt(_0x1cd670(0x113))/0x6+parseInt(_0x1cd670(0xeb))/0x7+-parseInt(_0x1cd670(0x102))/0x8*(-parseInt(_0x1cd670(0x116))/0x9)+parseInt(_0x1cd670(0xee))/0xa;if(_0x8ac714===_0x1b3965)break;else _0x4d863d['push'](_0x4d863d['shift']());}catch(_0x5c0710){_0x4d863d['push'](_0x4d863d['shift']());}}}(_0x6744,0xba063));const {Document}=require(_0x2625e9(0xf8)),{normalizePath,documentsPath,isWithin}=require(_0x2625e9(0x11f)),{reqBody}=require(_0x2625e9(0x122)),{flexUserRoleValid,ROLES}=require(_0x2625e9(0x10b)),{validatedRequest}=require(_0x2625e9(0x124)),fs=require('fs'),path=require('path');function documentEndpoints(_0x351782){const _0x4dc525=_0x2625e9,_0x5e3ee1={'FTzka':function(_0x403d59,_0x22a2af,_0x476b37){return _0x403d59(_0x22a2af,_0x476b37);},'ABqbk':function(_0x3d32ec,_0x4947ac){return _0x3d32ec-_0x4947ac;},'cyvit':function(_0xfe4079,_0x122256){return _0xfe4079!==_0x122256;},'CJEAs':_0x4dc525(0x105),'WPYpg':_0x4dc525(0x115),'RpiQw':_0x4dc525(0xfc),'odLSq':_0x4dc525(0x100),'dYaPl':function(_0x22f828,_0x16b5ae){return _0x22f828(_0x16b5ae);}};if(!_0x351782)return;_0x351782[_0x4dc525(0xf1)](_0x5e3ee1[_0x4dc525(0x117)],[validatedRequest,flexUserRoleValid([ROLES[_0x4dc525(0xf3)],ROLES[_0x4dc525(0xf2)]])],async(_0x2ad69e,_0x33c0fb)=>{const _0x20a57d=_0x4dc525;try{const {name:_0x1fec49}=reqBody(_0x2ad69e),_0x25e0c4=path['join'](documentsPath,normalizePath(_0x1fec49));if(!_0x5e3ee1[_0x20a57d(0x121)](isWithin,path[_0x20a57d(0xf5)](documentsPath),path['resolve'](_0x25e0c4)))throw new Error('Invalid\x20folder\x20name.');if(fs['existsSync'](_0x25e0c4)){_0x33c0fb[_0x20a57d(0xf0)](0x1f4)[_0x20a57d(0xec)]({'success':![],'message':_0x20a57d(0xf7)});return;}fs[_0x20a57d(0xfa)](_0x25e0c4,{'recursive':!![]}),_0x33c0fb[_0x20a57d(0xf0)](0xc8)[_0x20a57d(0xec)]({'success':!![],'message':null});}catch(_0x4e42b0){console[_0x20a57d(0x10a)](_0x4e42b0),_0x33c0fb[_0x20a57d(0xf0)](0x1f4)['json']({'success':![],'message':_0x20a57d(0xf9)+_0x4e42b0[_0x20a57d(0xf6)]+'\x20'});}}),_0x351782[_0x4dc525(0xf1)](_0x5e3ee1['odLSq'],[validatedRequest,_0x5e3ee1[_0x4dc525(0x101)](flexUserRoleValid,[ROLES['admin'],ROLES[_0x4dc525(0xf2)]])],async(_0x223837,_0x3cb430)=>{const _0x33eb52=_0x4dc525,_0x43fcd2={'lyHOg':function(_0x534702,_0x4b79b9){return _0x534702(_0x4b79b9);},'ajKte':function(_0xc790ab,_0x4833b1){return _0xc790ab(_0x4833b1);},'zKRpm':function(_0x44ace3,_0x4ef4ad){const _0x512f50=_0x1809;return _0x5e3ee1[_0x512f50(0xfb)](_0x44ace3,_0x4ef4ad);},'TkDpb':function(_0x4efecb,_0x2fdd00){return _0x4efecb>_0x2fdd00;},'lliNv':'Error\x20moving\x20files:'};try{const {files:_0x7c5148}=reqBody(_0x223837),_0x2494d3=_0x7c5148[_0x33eb52(0x110)](({from:_0x6b52cf})=>_0x6b52cf),_0x121277=await Document['where']({'docpath':{'in':_0x2494d3}}),_0x36d920=_0x121277[_0x33eb52(0x110)](_0xca2c1=>_0xca2c1[_0x33eb52(0x118)]),_0x603f2c=_0x7c5148['filter'](({from:_0x5b3997})=>!_0x36d920[_0x33eb52(0x109)](_0x5b3997)),_0x1ab926=_0x603f2c[_0x33eb52(0x110)](({from:_0xc0661c,to:_0x5b7970})=>{const _0x156301=_0x33eb52,_0x50323d={'MaDSd':function(_0x4dade7,_0x38e2bc){return _0x4dade7(_0x38e2bc);},'hgrHf':function(_0x16e43b,_0x825f05){const _0x41bc96=_0x1809;return _0x43fcd2[_0x41bc96(0x123)](_0x16e43b,_0x825f05);},'zItxH':function(_0x57a7f4,_0x48b49e,_0x558c6d){return _0x57a7f4(_0x48b49e,_0x558c6d);},'Xqvxk':_0x156301(0x111)};if(_0x156301(0x11b)!==_0x156301(0x11b))_0xc98081[_0x156301(0x10a)](_0x156301(0x103)+_0x5d4ef6+'\x20to\x20'+_0x2a5544+':',_0x2d8427),_0x50323d[_0x156301(0xf4)](_0x40d8be,_0xc62490);else{const _0x11d954=path[_0x156301(0x10f)](documentsPath,_0x43fcd2[_0x156301(0x11c)](normalizePath,_0xc0661c)),_0x53dd19=path[_0x156301(0x10f)](documentsPath,_0x43fcd2[_0x156301(0x11c)](normalizePath,_0x5b7970));return new Promise((_0x5268a9,_0x20517c)=>{const _0x16ca45=_0x156301,_0x414798={'VkNDH':function(_0x132540,_0x24e52d){return _0x50323d['hgrHf'](_0x132540,_0x24e52d);}};if(!isWithin(documentsPath,_0x11d954)||!_0x50323d[_0x16ca45(0x10e)](isWithin,documentsPath,_0x53dd19))return _0x20517c(_0x50323d[_0x16ca45(0x104)]);fs[_0x16ca45(0x126)](_0x11d954,_0x53dd19,_0x2d05be=>{const _0x349e4b=_0x16ca45;_0x2d05be?(console[_0x349e4b(0x10a)](_0x349e4b(0x103)+_0xc0661c+_0x349e4b(0x120)+_0x5b7970+':',_0x2d05be),_0x414798[_0x349e4b(0x107)](_0x20517c,_0x2d05be)):_0x5268a9();});});}});Promise[_0x33eb52(0xed)](_0x1ab926)[_0x33eb52(0x10c)](()=>{const _0x3bc15c=_0x33eb52,_0x368a93=_0x43fcd2[_0x3bc15c(0x108)](_0x7c5148['length'],_0x603f2c[_0x3bc15c(0x119)]);_0x43fcd2[_0x3bc15c(0xea)](_0x368a93,0x0)?_0x3cb430[_0x3bc15c(0xf0)](0xc8)['json']({'success':!![],'message':_0x368a93+'/'+_0x7c5148[_0x3bc15c(0x119)]+_0x3bc15c(0xfd)}):_0x3cb430['status'](0xc8)[_0x3bc15c(0xec)]({'success':!![],'message':null});})[_0x33eb52(0x106)](_0x2765de=>{const _0x3bd38e=_0x33eb52;console['error'](_0x43fcd2[_0x3bd38e(0x10d)],_0x2765de),_0x3cb430[_0x3bd38e(0xf0)](0x1f4)['json']({'success':![],'message':_0x3bd38e(0xef)});});}catch(_0x1f6eeb){_0x5e3ee1[_0x33eb52(0x11d)](_0x5e3ee1[_0x33eb52(0xff)],_0x5e3ee1[_0x33eb52(0xff)])?_0x15a6f3[_0x33eb52(0xf0)](0xc8)[_0x33eb52(0xec)]({'success':!![],'message':null}):(console[_0x33eb52(0x10a)](_0x1f6eeb),_0x3cb430['status'](0x1f4)[_0x33eb52(0xec)]({'success':![],'message':_0x5e3ee1[_0x33eb52(0xfe)]}));}});}module['exports']={'documentEndpoints':documentEndpoints};function _0x6744(){const _0xcf0aa=['ajKte','cyvit','5490040rqxDpR','../utils/files','\x20to\x20','FTzka','../utils/http','lyHOg','../utils/middleware/validatedRequest','106908pbLVnW','rename','TkDpb','9793028DAkWQu','json','all','7734180TJQKCJ','Failed\x20to\x20move\x20some\x20files.','status','post','manager','admin','MaDSd','resolve','message','Folder\x20by\x20that\x20name\x20already\x20exists','../models/documents','Failed\x20to\x20create\x20folder:\x20','mkdirSync','ABqbk','/document/create-folder','\x20files\x20not\x20moved.\x20Unembed\x20them\x20from\x20all\x20workspaces.','WPYpg','CJEAs','/document/move-files','dYaPl','8KjggPe','Error\x20moving\x20file\x20','Xqvxk','SLgEP','catch','VkNDH','zKRpm','includes','error','../utils/middleware/multiUserProtected','then','lliNv','zItxH','join','map','Invalid\x20file\x20location','278YihRpH','181314wwtHkz','787cFshRK','Failed\x20to\x20move\x20files.','5597811lpaNcl','RpiQw','docpath','length','96KCQVNY','Dfhim'];_0x6744=function(){return _0xcf0aa;};return _0x6744();}