const _0x51975b=_0x558e;function _0x316f(){const _0x424596=['deleteForWorkspace','ApcUE','value','../models/documents','1064kUcSgM','xpuAA','../models/user','status','../models/vectors','rwouN','sendStatus','admin','rnfin','/admin/invite/:id','../models/telemetry','whereWithUsers','Zwcct','RJSxc','UXkQB','limit_user_messages','username','delete-namespace','updateSettings','sgxcz','rNSOC','ROKfS','valid','ZXHDA','embeddingMaxChunkLength','33737430DWMCGu','../models/systemSettings','18qedMta','../utils/http','logEvent','get','/admin/invite/new','true','text_splitter_chunk_size','locals','ywXfc','error','update','nwsXa','xrnTA','end','HiToP','/admin/workspaces/:workspaceId/update-users','invite_created','updateUsers','yKKgx','new','user_created','yBqNf','params','BgzRs','post','GtaML','VwshT','yDxfa','../models/invite','/admin/user/:id','../models/eventLogs','941845AEkcCk','../utils/helpers','delete','2884622rTHXzS','manager','stringify','api_key_deleted','deactivate','../models/workspace','sendTelemetry','dJuaA','agent_search_provider','json','wiaOB','hVIiI','message_limit','api_key_created','../utils/middleware/validatedRequest','agent_sql_connections','Could\x20not\x20find\x20an\x20API\x20Keys.','/admin/workspaces/:id','290650yjDpVF','/admin/workspaces/new','user','hQZER','OTQXi','wVlCF','/admin/system-preferences','workspaceUsers','message','lOgZI','whereWithUser','create','5895387nAnrOV','../utils/middleware/multiUserProtected','OrHQx','CysLj','ZzHpE','TqLOi','vouzH','2568TzIVGO','/admin/api-keys','3VwuQXi','jmLLd','wpbbo','mHfeO','/admin/users/new','../models/workspaceChats','qRazd','invite_deleted','hlzRc','../models/apiKeys','eVihD','kvuNc','YHVXZ','qeuXq','/admin/delete-api-key/:id','3009792melRIR','aJhaS','support_email','OLIfv','YgaPR','slug','AkAQe','hqvrj'];_0x316f=function(){return _0x424596;};return _0x316f();}(function(_0x205de8,_0x396ffc){const _0x1cf8ff=_0x558e,_0x1f9e2f=_0x205de8();while(!![]){try{const _0x2eea09=-parseInt(_0x1cf8ff(0x100))/0x1+-parseInt(_0x1cf8ff(0x16d))/0x2*(parseInt(_0x1cf8ff(0x115))/0x3)+-parseInt(_0x1cf8ff(0x124))/0x4+parseInt(_0x1cf8ff(0x16a))/0x5*(parseInt(_0x1cf8ff(0x14b))/0x6)+-parseInt(_0x1cf8ff(0x130))/0x7*(parseInt(_0x1cf8ff(0x113))/0x8)+-parseInt(_0x1cf8ff(0x10c))/0x9+parseInt(_0x1cf8ff(0x149))/0xa;if(_0x2eea09===_0x396ffc)break;else _0x1f9e2f['push'](_0x1f9e2f['shift']());}catch(_0x1cc7e5){_0x1f9e2f['push'](_0x1f9e2f['shift']());}}}(_0x316f,0xb7026));const {ApiKey}=require(_0x51975b(0x11e)),{Document}=require(_0x51975b(0x12f)),{EventLogs}=require(_0x51975b(0x169)),{Invite}=require(_0x51975b(0x167)),{SystemSettings}=require(_0x51975b(0x14a)),{Telemetry}=require(_0x51975b(0x13a)),{User}=require(_0x51975b(0x132)),{DocumentVectors}=require(_0x51975b(0x134)),{Workspace}=require(_0x51975b(0xf3)),{WorkspaceChats}=require(_0x51975b(0x11a)),{getVectorDbClass,getEmbeddingEngineSelection}=require(_0x51975b(0x16b)),{validRoleSelection,canModifyAdmin,validCanModify}=require('../utils/helpers/admin'),{reqBody,userFromSession,safeJsonParse}=require(_0x51975b(0x14c)),{strictMultiUserRoleValid,flexUserRoleValid,ROLES}=require(_0x51975b(0x10d)),{validatedRequest}=require(_0x51975b(0xfc));function adminEndpoints(_0x31fac4){const _0x1883e8=_0x51975b,_0x24aaa2={'xpuAA':function(_0x4105a6,_0x1d87e9){return _0x4105a6===_0x1d87e9;},'yBqNf':_0x1883e8(0x112),'OWOnT':function(_0x180129,_0x3df26a){return _0x180129===_0x3df26a;},'jqxGj':_0x1883e8(0x12b),'htXey':_0x1883e8(0x110),'wpbbo':function(_0x1a861a,_0x13b696,_0x5a34a8){return _0x1a861a(_0x13b696,_0x5a34a8);},'HFRvU':_0x1883e8(0x162),'rwouN':function(_0x29879f,_0x585e1d){return _0x29879f(_0x585e1d);},'yDxfa':function(_0x179360,_0x557a5a,_0xd49211){return _0x179360(_0x557a5a,_0xd49211);},'YgaPR':function(_0x4af38c,_0x561ae3){return _0x4af38c===_0x561ae3;},'OrHQx':_0x1883e8(0x118),'qOxMh':'user_deleted','OGZLE':function(_0x8b2822,_0x300329){return _0x8b2822!==_0x300329;},'OTQXi':_0x1883e8(0x11c),'rNSOC':_0x1883e8(0x13c),'kvuNc':function(_0x10933d,_0x39e435){return _0x10933d!==_0x39e435;},'hQZER':'yKKgx','hlzRc':function(_0x4f7225,_0x4699a3){return _0x4f7225(_0x4699a3);},'aJhaS':function(_0x3867c8,_0xbcaa6f){return _0x3867c8===_0xbcaa6f;},'fDXkx':'users_can_delete_workspaces','qeuXq':_0x1883e8(0x13f),'kflaH':_0x1883e8(0x150),'rnfin':_0x1883e8(0xfa),'GtaML':'footer_data','sgxcz':_0x1883e8(0x126),'YHVXZ':'text_splitter_chunk_overlap','wVlCF':_0x1883e8(0xfe),'lOgZI':_0x1883e8(0xf1),'TqLOi':_0x1883e8(0x13d),'ywXfc':function(_0x51bd8a,_0xe73139){return _0x51bd8a(_0xe73139);},'DhabD':_0x1883e8(0x119),'nwsXa':_0x1883e8(0x168),'qRazd':function(_0x1097c1,_0x17989b){return _0x1097c1(_0x17989b);},'ApcUE':'/admin/invites','wiaOB':function(_0x57d2ab,_0xd53340){return _0x57d2ab(_0xd53340);},'CysLj':_0x1883e8(0x139),'UXkQB':function(_0x470fa1,_0x4c8c82){return _0x470fa1(_0x4c8c82);},'xrnTA':function(_0x1bdb3c,_0x14ccfe){return _0x1bdb3c(_0x14ccfe);},'dJuaA':_0x1883e8(0x15a),'uQJYo':_0x1883e8(0xff),'OLIfv':function(_0x57716c,_0x16dcef){return _0x57716c(_0x16dcef);},'KNWOt':'/admin/system-preferences','eVihD':_0x1883e8(0x114),'jmLLd':function(_0x4fa8e7,_0xb81f7f){return _0x4fa8e7(_0xb81f7f);},'iMzSe':_0x1883e8(0x123)};if(!_0x31fac4)return;_0x31fac4[_0x1883e8(0x14e)]('/admin/users',[validatedRequest,_0x24aaa2[_0x1883e8(0x153)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x4c7908,_0x41ba03)=>{const _0x16650d=_0x1883e8;if(_0x24aaa2['xpuAA'](_0x24aaa2[_0x16650d(0x160)],_0x24aaa2[_0x16650d(0x160)]))try{const _0x35880f=await User['where']();_0x41ba03[_0x16650d(0x133)](0xc8)[_0x16650d(0xf7)]({'users':_0x35880f});}catch(_0x3b0a22){console[_0x16650d(0x154)](_0x3b0a22),_0x41ba03['sendStatus'](0x1f4)[_0x16650d(0x158)]();}else _0x24bd49[_0x16650d(0x154)](_0x137b43),_0x5bf170[_0x16650d(0x136)](0x1f4)['end']();}),_0x31fac4[_0x1883e8(0x163)](_0x24aaa2['DhabD'],[validatedRequest,strictMultiUserRoleValid([ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x1120e7,_0x19a79f)=>{const _0x5217e7=_0x1883e8;try{if(_0x24aaa2['OWOnT'](_0x24aaa2['jqxGj'],_0x24aaa2['htXey']))_0x549d3a['error'](_0x3e322a),_0x1cdf3c['sendStatus'](0x1f4)[_0x5217e7(0x158)]();else{const _0xa4f1b5=await _0x24aaa2[_0x5217e7(0x117)](userFromSession,_0x1120e7,_0x19a79f),_0x15a669=reqBody(_0x1120e7),_0x5e5b68=validRoleSelection(_0xa4f1b5,_0x15a669);if(!_0x5e5b68[_0x5217e7(0x146)]){_0x19a79f['status'](0xc8)[_0x5217e7(0xf7)]({'user':null,'error':_0x5e5b68[_0x5217e7(0x154)]});return;}const {user:_0xb3f8b9,error:_0x70acc8}=await User[_0x5217e7(0x10b)](_0x15a669);!!_0xb3f8b9&&await EventLogs[_0x5217e7(0x14d)](_0x5217e7(0x15f),{'userName':_0xb3f8b9[_0x5217e7(0x140)],'createdBy':_0xa4f1b5['username']},_0xa4f1b5['id']),_0x19a79f['status'](0xc8)['json']({'user':_0xb3f8b9,'error':_0x70acc8});}}catch(_0x3072aa){console['error'](_0x3072aa),_0x19a79f[_0x5217e7(0x136)](0x1f4)['end']();}}),_0x31fac4['post'](_0x24aaa2['nwsXa'],[validatedRequest,_0x24aaa2[_0x1883e8(0x11b)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES['manager']])],async(_0x1ba415,_0x4caa8a)=>{const _0x26a9fe=_0x1883e8;if(_0x24aaa2[_0x26a9fe(0x131)](_0x24aaa2['HFRvU'],'BgzRs'))try{const _0x6128fa=await userFromSession(_0x1ba415,_0x4caa8a),{id:_0x5941c5}=_0x1ba415['params'],_0x55d983=_0x24aaa2[_0x26a9fe(0x135)](reqBody,_0x1ba415),_0x298965=await User[_0x26a9fe(0x14e)]({'id':Number(_0x5941c5)}),_0x5c07cc=_0x24aaa2[_0x26a9fe(0x117)](validCanModify,_0x6128fa,_0x298965);if(!_0x5c07cc['valid']){_0x4caa8a[_0x26a9fe(0x133)](0xc8)[_0x26a9fe(0xf7)]({'success':![],'error':_0x5c07cc['error']});return;}const _0x686e20=_0x24aaa2[_0x26a9fe(0x117)](validRoleSelection,_0x6128fa,_0x55d983);if(!_0x686e20['valid']){_0x4caa8a[_0x26a9fe(0x133)](0xc8)[_0x26a9fe(0xf7)]({'success':![],'error':_0x686e20['error']});return;}const _0x3fffb0=await _0x24aaa2[_0x26a9fe(0x166)](canModifyAdmin,_0x298965,_0x55d983);if(!_0x3fffb0['valid']){_0x4caa8a[_0x26a9fe(0x133)](0xc8)[_0x26a9fe(0xf7)]({'success':![],'error':_0x3fffb0['error']});return;}const {success:_0x31a87d,error:_0x1a9760}=await User[_0x26a9fe(0x155)](_0x5941c5,_0x55d983);_0x4caa8a[_0x26a9fe(0x133)](0xc8)['json']({'success':_0x31a87d,'error':_0x1a9760});}catch(_0x1fced3){console[_0x26a9fe(0x154)](_0x1fced3),_0x4caa8a[_0x26a9fe(0x136)](0x1f4)[_0x26a9fe(0x158)]();}else{_0x4714c3['status'](0xc8)['json']({'success':![],'error':_0x42d9ae[_0x26a9fe(0x154)]});return;}}),_0x31fac4['delete'](_0x24aaa2[_0x1883e8(0x156)],[validatedRequest,strictMultiUserRoleValid([ROLES[_0x1883e8(0x137)],ROLES['manager']])],async(_0x4f46ef,_0x5c764b)=>{const _0x1972ea=_0x1883e8;try{if(_0x24aaa2[_0x1972ea(0x128)](_0x24aaa2[_0x1972ea(0x10e)],_0x1972ea(0xf9))){_0x10bfa1[_0x1972ea(0x133)](0xc8)[_0x1972ea(0xf7)]({'success':![],'error':_0x41ec01[_0x1972ea(0x154)]});return;}else{const _0x359a28=await _0x24aaa2[_0x1972ea(0x166)](userFromSession,_0x4f46ef,_0x5c764b),{id:_0x131ed8}=_0x4f46ef[_0x1972ea(0x161)],_0x539eca=await User['get']({'id':Number(_0x131ed8)}),_0x4c7264=_0x24aaa2['yDxfa'](validCanModify,_0x359a28,_0x539eca);if(!_0x4c7264[_0x1972ea(0x146)]){_0x5c764b[_0x1972ea(0x133)](0xc8)[_0x1972ea(0xf7)]({'success':![],'error':_0x4c7264[_0x1972ea(0x154)]});return;}await User[_0x1972ea(0x16c)]({'id':_0x24aaa2[_0x1972ea(0x135)](Number,_0x131ed8)}),await EventLogs[_0x1972ea(0x14d)](_0x24aaa2['qOxMh'],{'userName':_0x539eca[_0x1972ea(0x140)],'deletedBy':_0x359a28[_0x1972ea(0x140)]},_0x359a28['id']),_0x5c764b[_0x1972ea(0x133)](0xc8)[_0x1972ea(0xf7)]({'success':!![],'error':null});}}catch(_0x331b70){console[_0x1972ea(0x154)](_0x331b70),_0x5c764b[_0x1972ea(0x136)](0x1f4)[_0x1972ea(0x158)]();}}),_0x31fac4[_0x1883e8(0x14e)](_0x24aaa2[_0x1883e8(0x12d)],[validatedRequest,_0x24aaa2['wiaOB'](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x5ec490,_0xff908)=>{const _0x31021d=_0x1883e8;try{const _0x2c33c0=await Invite['whereWithUsers']();_0xff908[_0x31021d(0x133)](0xc8)[_0x31021d(0xf7)]({'invites':_0x2c33c0});}catch(_0x1ab228){console['error'](_0x1ab228),_0xff908[_0x31021d(0x136)](0x1f4)[_0x31021d(0x158)]();}}),_0x31fac4[_0x1883e8(0x163)](_0x1883e8(0x14f),[validatedRequest,strictMultiUserRoleValid([ROLES['admin'],ROLES[_0x1883e8(0xef)]])],async(_0x3e8611,_0x32398c)=>{const _0x3e1f46=_0x1883e8;if(_0x24aaa2['OGZLE'](_0x3e1f46(0x145),'ROKfS'))_0x50a109[_0x3e1f46(0x154)](_0x595d32),_0x387b36[_0x3e1f46(0x136)](0x1f4)[_0x3e1f46(0x158)]();else try{const _0x5d04db=await userFromSession(_0x3e8611,_0x32398c),_0x5a038a=_0x24aaa2[_0x3e1f46(0x135)](reqBody,_0x3e8611),{invite:_0x37a6c1,error:_0x468e45}=await Invite[_0x3e1f46(0x10b)]({'createdByUserId':_0x5d04db['id'],'workspaceIds':_0x5a038a?.['workspaceIds']||[]});await EventLogs['logEvent'](_0x3e1f46(0x15b),{'inviteCode':_0x37a6c1['code'],'createdBy':_0x32398c[_0x3e1f46(0x152)]?.['user']?.[_0x3e1f46(0x140)]},_0x32398c[_0x3e1f46(0x152)]?.[_0x3e1f46(0x102)]?.['id']),_0x32398c[_0x3e1f46(0x133)](0xc8)[_0x3e1f46(0xf7)]({'invite':_0x37a6c1,'error':_0x468e45});}catch(_0x3a7344){console[_0x3e1f46(0x154)](_0x3a7344),_0x32398c[_0x3e1f46(0x136)](0x1f4)[_0x3e1f46(0x158)]();}}),_0x31fac4[_0x1883e8(0x16c)](_0x24aaa2[_0x1883e8(0x10f)],[validatedRequest,strictMultiUserRoleValid([ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x80eab5,_0x4197ed)=>{const _0x4c2165=_0x1883e8;try{const {id:_0x13d898}=_0x80eab5[_0x4c2165(0x161)],{success:_0x311f3e,error:_0x49910a}=await Invite[_0x4c2165(0xf2)](_0x13d898);await EventLogs[_0x4c2165(0x14d)](_0x24aaa2[_0x4c2165(0x104)],{'deletedBy':_0x4197ed[_0x4c2165(0x152)]?.[_0x4c2165(0x102)]?.[_0x4c2165(0x140)]},_0x4197ed[_0x4c2165(0x152)]?.['user']?.['id']),_0x4197ed[_0x4c2165(0x133)](0xc8)[_0x4c2165(0xf7)]({'success':_0x311f3e,'error':_0x49910a});}catch(_0x18dbfd){console[_0x4c2165(0x154)](_0x18dbfd),_0x4197ed[_0x4c2165(0x136)](0x1f4)[_0x4c2165(0x158)]();}}),_0x31fac4['get']('/admin/workspaces',[validatedRequest,_0x24aaa2[_0x1883e8(0x13e)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x550b25,_0x15c30c)=>{const _0xce2dc6=_0x1883e8;try{const _0x16821c=await Workspace[_0xce2dc6(0x13b)]();_0x15c30c['status'](0xc8)['json']({'workspaces':_0x16821c});}catch(_0x45f963){console[_0xce2dc6(0x154)](_0x45f963),_0x15c30c[_0xce2dc6(0x136)](0x1f4)[_0xce2dc6(0x158)]();}}),_0x31fac4[_0x1883e8(0x14e)]('/admin/workspaces/:workspaceId/users',[validatedRequest,_0x24aaa2[_0x1883e8(0x157)](strictMultiUserRoleValid,[ROLES['admin'],ROLES[_0x1883e8(0xef)]])],async(_0x27cae1,_0x47a7a9)=>{const _0x45ba41=_0x1883e8;try{if(_0x45ba41(0x13c)===_0x24aaa2[_0x45ba41(0x144)]){const {workspaceId:_0x3fc694}=_0x27cae1[_0x45ba41(0x161)],_0x4b67f7=await Workspace[_0x45ba41(0x107)](_0x3fc694);_0x47a7a9[_0x45ba41(0x133)](0xc8)[_0x45ba41(0xf7)]({'users':_0x4b67f7});}else _0x5a9e97[_0x45ba41(0x154)](_0x39709a),_0x1511ec[_0x45ba41(0x136)](0x1f4)[_0x45ba41(0x158)]();}catch(_0x4d6fc6){console[_0x45ba41(0x154)](_0x4d6fc6),_0x47a7a9[_0x45ba41(0x136)](0x1f4)[_0x45ba41(0x158)]();}}),_0x31fac4[_0x1883e8(0x163)](_0x1883e8(0x101),[validatedRequest,_0x24aaa2[_0x1883e8(0x157)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x54d52f,_0xb194b1)=>{const _0x23e656=_0x1883e8;try{if(_0x23e656(0x159)==='HiToP'){const _0x140557=await _0x24aaa2['yDxfa'](userFromSession,_0x54d52f,_0xb194b1),{name:_0x86f457}=reqBody(_0x54d52f),{workspace:_0x3f9e37,message:_0x17c2e2}=await Workspace[_0x23e656(0x15e)](_0x86f457,_0x140557['id']);_0xb194b1['status'](0xc8)['json']({'workspace':_0x3f9e37,'error':_0x17c2e2});}else _0x1f0125[_0x23e656(0x154)](_0x1f6cb4),_0x2823f9[_0x23e656(0x136)](0x1f4)[_0x23e656(0x158)]();}catch(_0x27add8){console[_0x23e656(0x154)](_0x27add8),_0xb194b1['sendStatus'](0x1f4)[_0x23e656(0x158)]();}}),_0x31fac4[_0x1883e8(0x163)](_0x24aaa2[_0x1883e8(0xf5)],[validatedRequest,_0x24aaa2[_0x1883e8(0xf8)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES[_0x1883e8(0xef)]])],async(_0x51e2bc,_0x3f2639)=>{const _0x2aa109=_0x1883e8;if(_0x24aaa2['kvuNc'](_0x2aa109(0x12a),_0x2aa109(0x12a))){_0x5b143c[_0x2aa109(0x133)](0xc8)[_0x2aa109(0xf7)]({'success':![],'error':_0xd76352[_0x2aa109(0x154)]});return;}else try{const {workspaceId:_0x4b09d9}=_0x51e2bc[_0x2aa109(0x161)],{userIds:_0x139d68}=_0x24aaa2[_0x2aa109(0x135)](reqBody,_0x51e2bc),{success:_0x467f8e,error:_0x466552}=await Workspace[_0x2aa109(0x15c)](_0x4b09d9,_0x139d68);_0x3f2639['status'](0xc8)[_0x2aa109(0xf7)]({'success':_0x467f8e,'error':_0x466552});}catch(_0x48e4bd){console[_0x2aa109(0x154)](_0x48e4bd),_0x3f2639[_0x2aa109(0x136)](0x1f4)[_0x2aa109(0x158)]();}}),_0x31fac4['delete'](_0x24aaa2['uQJYo'],[validatedRequest,_0x24aaa2[_0x1883e8(0x127)](strictMultiUserRoleValid,[ROLES['admin'],ROLES[_0x1883e8(0xef)]])],async(_0x3fcb3e,_0x1de0bb)=>{const _0x5b0286=_0x1883e8;try{const {id:_0xb823d}=_0x3fcb3e[_0x5b0286(0x161)],_0xf5ad0b=getVectorDbClass(),_0x3e31e0=await Workspace[_0x5b0286(0x14e)]({'id':Number(_0xb823d)});if(!_0x3e31e0){if(_0x24aaa2[_0x5b0286(0x120)](_0x24aaa2[_0x5b0286(0x103)],_0x5b0286(0x15d)))_0x328de9['error'](_0x3f38f9),_0x19ca83[_0x5b0286(0x136)](0x1f4)[_0x5b0286(0x158)]();else{_0x1de0bb[_0x5b0286(0x136)](0x194)['end']();return;}}await WorkspaceChats[_0x5b0286(0x16c)]({'workspaceId':_0x24aaa2[_0x5b0286(0x135)](Number,_0x3e31e0['id'])}),await DocumentVectors[_0x5b0286(0x12c)](_0x24aaa2['hlzRc'](Number,_0x3e31e0['id'])),await Document[_0x5b0286(0x16c)]({'workspaceId':Number(_0x3e31e0['id'])}),await Workspace[_0x5b0286(0x16c)]({'id':_0x24aaa2[_0x5b0286(0x135)](Number,_0x3e31e0['id'])});try{if(_0x24aaa2[_0x5b0286(0x125)]('ocCMn',_0x5b0286(0x165))){_0x1ee4c4[_0x5b0286(0x133)](0xc8)[_0x5b0286(0xf7)]({'success':![],'error':_0x420194[_0x5b0286(0x154)]});return;}else await _0xf5ad0b[_0x5b0286(0x141)]({'namespace':_0x3e31e0[_0x5b0286(0x129)]});}catch(_0x1009e0){console[_0x5b0286(0x154)](_0x1009e0[_0x5b0286(0x108)]);}_0x1de0bb['status'](0xc8)[_0x5b0286(0xf7)]({'success':!![],'error':null});}catch(_0x153797){console[_0x5b0286(0x154)](_0x153797),_0x1de0bb[_0x5b0286(0x136)](0x1f4)[_0x5b0286(0x158)]();}}),_0x31fac4[_0x1883e8(0x14e)](_0x24aaa2['KNWOt'],[validatedRequest,_0x24aaa2['xrnTA'](flexUserRoleValid,[ROLES[_0x1883e8(0x137)],ROLES['manager']])],async(_0x4d407a,_0x47e6e7)=>{const _0x349583=_0x1883e8;try{const _0x1a73b5={'users_can_delete_workspaces':(await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2['fDXkx']}))?.[_0x349583(0x12e)]===_0x349583(0x150),'limit_user_messages':_0x24aaa2[_0x349583(0x131)]((await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2[_0x349583(0x122)]}))?.[_0x349583(0x12e)],_0x24aaa2['kflaH']),'message_limit':_0x24aaa2[_0x349583(0x11d)](Number,(await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2[_0x349583(0x138)]}))?.[_0x349583(0x12e)])||0xa,'footer_data':(await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2[_0x349583(0x164)]}))?.[_0x349583(0x12e)]||JSON[_0x349583(0xf0)]([]),'support_email':(await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2[_0x349583(0x143)]}))?.[_0x349583(0x12e)]||null,'text_splitter_chunk_size':(await SystemSettings['get']({'label':_0x349583(0x151)}))?.[_0x349583(0x12e)]||getEmbeddingEngineSelection()?.[_0x349583(0x148)]||null,'text_splitter_chunk_overlap':(await SystemSettings[_0x349583(0x14e)]({'label':_0x24aaa2[_0x349583(0x121)]}))?.[_0x349583(0x12e)]||null,'max_embed_chunk_size':getEmbeddingEngineSelection()?.[_0x349583(0x148)]||0x3e8,'agent_search_provider':(await SystemSettings[_0x349583(0x14e)]({'label':_0x349583(0xf6)}))?.[_0x349583(0x12e)]||null,'agent_sql_connections':await SystemSettings['brief'][_0x349583(0xfd)](),'default_agent_skills':_0x24aaa2[_0x349583(0x117)](safeJsonParse,(await SystemSettings[_0x349583(0x14e)]({'label':'default_agent_skills'}))?.['value'],[])||[]};_0x47e6e7['status'](0xc8)['json']({'settings':_0x1a73b5});}catch(_0x19982e){console[_0x349583(0x154)](_0x19982e),_0x47e6e7[_0x349583(0x136)](0x1f4)[_0x349583(0x158)]();}}),_0x31fac4[_0x1883e8(0x163)](_0x1883e8(0x106),[validatedRequest,flexUserRoleValid([ROLES['admin'],ROLES[_0x1883e8(0xef)]])],async(_0x579652,_0x2ca26f)=>{const _0x4d1bc5=_0x1883e8;try{const _0x19b3d3=reqBody(_0x579652);await SystemSettings[_0x4d1bc5(0x142)](_0x19b3d3),_0x2ca26f[_0x4d1bc5(0x133)](0xc8)['json']({'success':!![],'error':null});}catch(_0x1ff34c){console['error'](_0x1ff34c),_0x2ca26f[_0x4d1bc5(0x136)](0x1f4)[_0x4d1bc5(0x158)]();}}),_0x31fac4[_0x1883e8(0x14e)](_0x24aaa2[_0x1883e8(0x11f)],[validatedRequest,strictMultiUserRoleValid([ROLES[_0x1883e8(0x137)]])],async(_0x185ed5,_0x4c7d21)=>{const _0x58fa6d=_0x1883e8;try{const _0x4fc225=await ApiKey[_0x58fa6d(0x10a)]({});return _0x4c7d21[_0x58fa6d(0x133)](0xc8)['json']({'apiKeys':_0x4fc225,'error':null});}catch(_0x4ed05a){console['error'](_0x4ed05a),_0x4c7d21[_0x58fa6d(0x133)](0x1f4)[_0x58fa6d(0xf7)]({'apiKey':null,'error':_0x24aaa2['wVlCF']});}}),_0x31fac4[_0x1883e8(0x163)]('/admin/generate-api-key',[validatedRequest,_0x24aaa2[_0x1883e8(0x116)](strictMultiUserRoleValid,[ROLES[_0x1883e8(0x137)]])],async(_0xe211ec,_0x5aa907)=>{const _0x4a03b5=_0x1883e8;try{if(_0x24aaa2['kvuNc']('ZXHDA',_0x4a03b5(0x147))){_0x21b83f['sendStatus'](0x194)[_0x4a03b5(0x158)]();return;}else{const _0x18c588=await userFromSession(_0xe211ec,_0x5aa907),{apiKey:_0x583c45,error:_0x2768a2}=await ApiKey[_0x4a03b5(0x10b)](_0x18c588['id']);return await Telemetry[_0x4a03b5(0xf4)](_0x4a03b5(0xfb)),await EventLogs['logEvent'](_0x4a03b5(0xfb),{'createdBy':_0x18c588?.[_0x4a03b5(0x140)]},_0x18c588?.['id']),_0x5aa907[_0x4a03b5(0x133)](0xc8)[_0x4a03b5(0xf7)]({'apiKey':_0x583c45,'error':_0x2768a2});}}catch(_0x143eb1){console[_0x4a03b5(0x154)](_0x143eb1),_0x5aa907[_0x4a03b5(0x136)](0x1f4)[_0x4a03b5(0x158)]();}}),_0x31fac4['delete'](_0x24aaa2['iMzSe'],[validatedRequest,strictMultiUserRoleValid([ROLES[_0x1883e8(0x137)]])],async(_0x5cca63,_0xf3ec19)=>{const _0xb8e8b7=_0x1883e8;try{const {id:_0x28eb16}=_0x5cca63[_0xb8e8b7(0x161)];return await ApiKey['delete']({'id':_0x24aaa2[_0xb8e8b7(0x11d)](Number,_0x28eb16)}),await EventLogs[_0xb8e8b7(0x14d)](_0x24aaa2[_0xb8e8b7(0x109)],{'deletedBy':_0xf3ec19[_0xb8e8b7(0x152)]?.[_0xb8e8b7(0x102)]?.[_0xb8e8b7(0x140)]},_0xf3ec19?.[_0xb8e8b7(0x152)]?.[_0xb8e8b7(0x102)]?.['id']),_0xf3ec19['status'](0xc8)[_0xb8e8b7(0x158)]();}catch(_0x597d11){_0xb8e8b7(0x13d)===_0x24aaa2[_0xb8e8b7(0x111)]?(console[_0xb8e8b7(0x154)](_0x597d11),_0xf3ec19['sendStatus'](0x1f4)[_0xb8e8b7(0x158)]()):(_0x27eed4['error'](_0x586766),_0x52ea7f[_0xb8e8b7(0x133)](0x1f4)[_0xb8e8b7(0xf7)]({'apiKey':null,'error':_0x24aaa2[_0xb8e8b7(0x105)]}));}});}function _0x558e(_0x64840e,_0x4cef91){const _0x316fde=_0x316f();return _0x558e=function(_0x558e61,_0x268b3e){_0x558e61=_0x558e61-0xef;let _0x3c6c26=_0x316fde[_0x558e61];return _0x3c6c26;},_0x558e(_0x64840e,_0x4cef91);}module['exports']={'adminEndpoints':adminEndpoints};