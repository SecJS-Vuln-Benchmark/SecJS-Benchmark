const _0x516312=_0x2e24;function _0x3105(){const _0x6521c9=['kvsve','some_claim','Zekuq','ZsoSJ','MVKQS','OMPlJ','voxJg','BWWsK','./fixture/server','smfld','srwaT','itHuZ','get','QWFRB','from','should\x20allow\x20user\x20when\x20custom\x20claim\x20check\x20returns\x20truthy','mWOpQ','QCoKS','jar','SdLpA','baz\x20bar','location','CMleK','KHjnT','SUkNC','YfyYl','returnTo','statusCode','baz','laTEl','searchParams','http://example.org','http://localhost:3000','assert','PDqGH','should\x20collapse\x20leading\x20slashes\x20on\x20returnTo','./fixture/cert','/session','console.log(\x22timer\x22);','/protected','chai','should\x20return\x20401\x20when\x20logged\x20in\x20user\x20doesn\x27t\x20have\x20the\x20claim','23682vlQHCv','updateClock();','gIUmV','kncOI','qjbqn','xMKOW','fhjfb','should\x20401\x20for\x20anonymous\x20users\x20who\x20don\x27t\x20accept\x20html','req.oidc\x20is\x20not\x20found,\x20did\x20you\x20include\x20the\x20auth\x20middleware?','wGzNi','wvMEG','__test_client_id__','should\x20return\x20401\x20when\x20checking\x20many\x20claims\x20with\x20anonymous\x20user','LJaQI','20QJyTvv','VonHk','nWwEK','eemLR','aWsnR','close','state','ftFwx','CTVYL','equal','qux','\x22expected\x22\x20must\x20be\x20a\x20string,\x20number,\x20boolean\x20or\x20null','VVZBc','should\x20ask\x20anonymous\x20user\x20to\x20login\x20when\x20visiting\x20a\x20protected\x20route','headers','should\x20allow\x20logged\x20in\x20users\x20with\x20the\x20right\x20claim','jCTXj','qcYrd','\x22claimCheck\x22\x20expects\x20a\x20function','1456378yvsMQL','safe','data:text/plain;base64,SGVsbG8gV29ybGQ=','syjEO','vkkTR','etftH','IfflX','throws','should\x20accept\x20claim\x20values\x20as\x20a\x20space\x20separated\x20list','should\x20make\x20the\x20token\x20claims\x20available\x20to\x20custom\x20check','__test_session_secret__','xdHQV','./..','bar','ajlsq','TddQV','should\x20throw\x20when\x20there\x27s\x20no\x20auth\x20middleware','olNHq','acMdr','XcQMS','\x22claim\x22\x20must\x20be\x20a\x20string','NQRVY','720CdHvdF','707404fAcyIM','VvaRO','request-promise-native','ROYWc','1525yCaIIJ','100210hjXXTf','stringify','RTPsl','include','should\x20not\x20accept\x20claim\x20values\x20that\x20aren\x27t\x20a\x20string\x20or\x20array','should\x20throw\x20when\x20claim\x20is\x20not\x20a\x20string','should\x20throw\x20when\x20claim\x20value\x20for\x20checking\x20many\x20claims\x20is\x20a\x20non\x20primitive','should\x20return\x20401\x20when\x20logged\x20in\x20user\x20doesn\x27t\x20have\x20the\x20right\x20value\x20for\x20claim','VIOyW','sinon','post','var\x20x\x20=\x2042;\x20return\x20x;','59805OeiEHs','should\x20return\x20401\x20when\x20anonymous\x20user\x20doesn\x27t\x20have\x20the\x20right\x20claim','mQVhY','SJVdQ','should\x20allow\x20logged\x20in\x20users\x20with\x20all\x20of\x20the\x20requested\x20claims','tqPzX','foo','1713878Zhxmim','MeZsm','parse','rZWos','rhSrM','log','///google.com','lXKGY','cZRFX','https://op.example.com','AZrSe','5813344uTKnZB','defaults','VaEBH','zUuLH','EERtG','jcULP','aNGmJ','should\x20return\x20401\x20when\x20checking\x20multiple\x20claims\x20and\x20the\x20user\x20doesn\x27t\x20have\x20the\x20claim'];_0x3105=function(){return _0x6521c9;};return _0x3105();}function _0x2e24(_0x44b737,_0x337b74){const _0x3105fe=_0x3105();return _0x2e24=function(_0x2e24d1,_0x37f412){_0x2e24d1=_0x2e24d1-0x199;let _0x2280b6=_0x3105fe[_0x2e24d1];return _0x2280b6;},_0x2e24(_0x44b737,_0x337b74);}(function(_0x106eba,_0x3f2437){const _0x369c1a=_0x2e24,_0x24df4b=_0x106eba();while(!![]){try{const _0x276a52=parseInt(_0x369c1a(0x1c6))/0x1+-parseInt(_0x369c1a(0x1de))/0x2+parseInt(_0x369c1a(0x1d7))/0x3*(parseInt(_0x369c1a(0x19c))/0x4)+parseInt(_0x369c1a(0x1ca))/0x5*(parseInt(_0x369c1a(0x21b))/0x6)+-parseInt(_0x369c1a(0x1af))/0x7+parseInt(_0x369c1a(0x1e9))/0x8+parseInt(_0x369c1a(0x1c5))/0x9*(-parseInt(_0x369c1a(0x1cb))/0xa);if(_0x276a52===_0x3f2437)break;else _0x24df4b['push'](_0x24df4b['shift']());}catch(_0xc23bec){_0x24df4b['push'](_0x24df4b['shift']());}}}(_0x3105,0xd49fd));const {assert}=require(_0x516312(0x219)),sinon=require(_0x516312(0x1d4)),{create:createServer}=require(_0x516312(0x1f9)),{makeIdToken}=require(_0x516312(0x215)),{auth,requiresAuth,claimEquals,claimIncludes,claimCheck}=require(_0x516312(0x1bb)),request=require(_0x516312(0x1c8))[_0x516312(0x1ea)]({'simple':![],'resolveWithFullResponse':!![],'followRedirect':![]}),baseUrl=_0x516312(0x211),defaultConfig={'secret':_0x516312(0x1b9),'clientID':_0x516312(0x199),'baseURL':_0x516312(0x210),'issuerBaseURL':_0x516312(0x1e7)},login=async _0x53008b=>{const _0x590ee6=_0x516312,_0x559f08={'mzyOB':function(_0x1ce228,_0x166f5b){return _0x1ce228(_0x166f5b);},'QWFRB':_0x590ee6(0x1d6)},_0xd1e04a=request[_0x590ee6(0x203)]();return await request[_0x590ee6(0x1d5)](_0x590ee6(0x216),{'baseUrl':baseUrl,'jar':_0xd1e04a,'json':{'id_token':_0x559f08['mzyOB'](makeIdToken,_0x53008b)}}),new Function(_0x559f08[_0x590ee6(0x1fe)])(),_0xd1e04a;};describe('requiresAuth',()=>{const _0x1efa71=_0x516312,_0x54a130={'PDqGH':'eJRwj','CMleK':function(_0x5da18a,_0x33bace){return _0x5da18a(_0x33bace);},'IfflX':function(_0xc01781){return _0xc01781();},'wGzNi':_0x1efa71(0x218),'iKMrX':_0x1efa71(0x1a2),'qjbqn':function(_0x2d7cd4,_0x3ccecf,_0x20a872){return _0x2d7cd4(_0x3ccecf,_0x20a872);},'OMPlJ':_0x1efa71(0x1c3),'eemLR':_0x1efa71(0x1b0),'EERtG':function(_0x15a348,_0x2e1e29,_0x1e7a33){return _0x15a348(_0x2e1e29,_0x1e7a33);},'SoGfQ':function(_0x194bd4,_0x115fc0){return _0x194bd4!==_0x115fc0;},'YfyYl':_0x1efa71(0x204),'xdHQV':function(_0x142544,_0x1d86b3,_0xaf2b17){return _0x142544(_0x1d86b3,_0xaf2b17);},'gIUmV':_0x1efa71(0x223),'MVKQS':_0x1efa71(0x1dd),'TddQV':_0x1efa71(0x20d),'aWsnR':function(_0x4d18d5,_0x250f28,_0x3a5a18){return _0x4d18d5(_0x250f28,_0x3a5a18);},'MeZsm':function(_0xf3c822,_0xdc606d,_0x375765){return _0xf3c822(_0xdc606d,_0x375765);},'VvaRO':function(_0x22360e,_0x2f2e4a,_0x1a3fb7){return _0x22360e(_0x2f2e4a,_0x1a3fb7);},'wvMEG':_0x1efa71(0x1bc),'KHjnT':function(_0x5f087d,_0x2ab432){return _0x5f087d(_0x2ab432);},'SUkNC':_0x1efa71(0x1a7),'acMdr':function(_0x28ab59,_0x5c746c){return _0x28ab59(_0x5c746c);},'KWzrh':function(_0x32c78d,_0x7ba339,_0x49aa59){return _0x32c78d(_0x7ba339,_0x49aa59);},'ajlsq':function(_0x3b17cf,_0x1b58d5){return _0x3b17cf(_0x1b58d5);},'BWWsK':_0x1efa71(0x201),'voxJg':'baz\x20bar','rHDoG':function(_0x4c186,_0x196cf6){return _0x4c186(_0x196cf6);},'RTPsl':function(_0x32164d,_0x34bdb9,_0x3d5943,_0x19002f){return _0x32164d(_0x34bdb9,_0x3d5943,_0x19002f);},'fhjfb':function(_0x2cf0a6,_0x44568c){return _0x2cf0a6(_0x44568c);},'xMKOW':'kvsve','itHuZ':function(_0x22e230,_0x40d148,_0x5a3b7b){return _0x22e230(_0x40d148,_0x5a3b7b);},'VVZBc':function(_0x280ff0,_0x3e0b1b){return _0x280ff0(_0x3e0b1b);},'ZsoSJ':function(_0x5c8de9,_0x2d4bb2){return _0x5c8de9(_0x2d4bb2);},'kncOI':'bar\x20baz','VIOyW':_0x1efa71(0x1b3),'ftFwx':_0x1efa71(0x1ae),'CTVYL':function(_0x3571af){return _0x3571af();},'zUuLH':function(_0x4c6bc4,_0x33b8e6){return _0x4c6bc4(_0x33b8e6);},'XcQMS':function(_0x20e50e,_0x12db40,_0x40979f){return _0x20e50e(_0x12db40,_0x40979f);},'VonHk':function(_0x30bbaf,_0x543883){return _0x30bbaf(_0x543883);},'smfld':'some_claim','jcULP':function(_0x5879a6,_0x1d8f57){return _0x5879a6(_0x1d8f57);},'SJVdQ':'//google.com','jWayo':_0x1efa71(0x1e4),'lXKGY':_0x1efa71(0x1e7),'olNHq':'should\x20allow\x20logged\x20in\x20users\x20to\x20visit\x20a\x20protected\x20route','qcYrd':function(_0x231c1a,_0x39b6bf,_0x45c7c8){return _0x231c1a(_0x39b6bf,_0x45c7c8);},'rhSrM':'should\x20return\x20401\x20when\x20anonymous\x20user\x20visits\x20a\x20protected\x20route','rCKYd':_0x1efa71(0x1bf),'NXIiy':_0x1efa71(0x1ab),'syjEO':_0x1efa71(0x21a),'VaEBH':_0x1efa71(0x217),'NQRVY':_0x1efa71(0x1d8),'mQVhY':_0x1efa71(0x1d0),'xEkEF':function(_0x29dc98,_0x22831c,_0x126254){return _0x29dc98(_0x22831c,_0x126254);},'nWwEK':'should\x20throw\x20when\x20claim\x20value\x20is\x20a\x20non\x20primitive','Zekuq':function(_0x3c2dfe,_0x5a05f3,_0x30a3af){return _0x3c2dfe(_0x5a05f3,_0x30a3af);},'jCTXj':'should\x20return\x20401\x20for\x20logged\x20with\x20some\x20of\x20the\x20requested\x20claims','AZrSe':function(_0x3712bd,_0x4d5f54,_0x22c9e5){return _0x3712bd(_0x4d5f54,_0x22c9e5);},'rZWos':_0x1efa71(0x1b1),'vFJLq':_0x1efa71(0x1f0),'tqPzX':_0x1efa71(0x19a),'ROYWc':'should\x20throw\x20when\x20custom\x20claim\x20check\x20doesn\x27t\x20get\x20a\x20function','tcxzI':_0x1efa71(0x200),'LJaQI':'should\x20not\x20allow\x20user\x20when\x20custom\x20claim\x20check\x20returns\x20falsey','aNGmJ':_0x1efa71(0x1b8),'laTEl':'should\x20not\x20allow\x20anonymous\x20users\x20to\x20check\x20custom\x20claims','dMtjU':_0x1efa71(0x214)};let _0x16b072;afterEach(async()=>{const _0x529149=_0x1efa71;_0x16b072&&(_0x529149(0x1e6)!==_0x54a130[_0x529149(0x213)]?_0x16b072['close']():_0xe4184['stringify']({'safe':!![]}));}),it(_0x54a130[_0x1efa71(0x1c0)],async()=>{const _0x194067=_0x1efa71;_0x16b072=await createServer(_0x54a130[_0x194067(0x207)](auth,{...defaultConfig,'authRequired':![]}),_0x54a130[_0x194067(0x1b5)](requiresAuth));const _0x50f9a1=await _0x54a130[_0x194067(0x1b5)](login),_0x1150e5=await request({'baseUrl':baseUrl,'jar':_0x50f9a1,'url':_0x54a130['wGzNi']});assert['equal'](_0x1150e5[_0x194067(0x20c)],0xc8);}),it(_0x1efa71(0x1a9),async()=>{const _0x5166b1=_0x1efa71;_0x16b072=await createServer(_0x54a130[_0x5166b1(0x207)](auth,{...defaultConfig,'authRequired':![]}),requiresAuth());const _0x22ce63=await _0x54a130['CMleK'](request,{'baseUrl':baseUrl,'url':'/protected'}),_0x58a7b5=new URL(_0x22ce63[_0x5166b1(0x1aa)]['location'])[_0x5166b1(0x20f)][_0x5166b1(0x1fd)](_0x54a130['iKMrX']),_0x2e488a=Buffer[_0x5166b1(0x1ff)](_0x58a7b5,'base64'),_0x37cdc9=JSON['parse'](_0x2e488a);assert[_0x5166b1(0x1a5)](_0x22ce63[_0x5166b1(0x20c)],0x12e),assert[_0x5166b1(0x1ce)](_0x22ce63[_0x5166b1(0x1aa)][_0x5166b1(0x206)],_0x5166b1(0x1e7)),assert['equal'](_0x37cdc9[_0x5166b1(0x20b)],_0x5166b1(0x218));}),it(_0x1efa71(0x222),async()=>{const _0x2d3673=_0x1efa71;_0x16b072=await _0x54a130[_0x2d3673(0x21f)](createServer,_0x54a130[_0x2d3673(0x207)](auth,{...defaultConfig,'authRequired':![]}),requiresAuth());const _0x16e970=await _0x54a130[_0x2d3673(0x207)](request,{'baseUrl':baseUrl,'url':'/protected','json':!![]});assert[_0x2d3673(0x1a5)](_0x16e970[_0x2d3673(0x20c)],0x191);}),_0x54a130[_0x1efa71(0x1df)](setTimeout,function(){const _0x43eb25=_0x1efa71;_0x43eb25(0x1fb)!==_0x43eb25(0x202)?console[_0x43eb25(0x1e3)](_0x54a130[_0x43eb25(0x19f)]):_0x3f5b95[_0x43eb25(0x1b6)](()=>_0x37ff5c(!![],'bar'),_0x4d51da,_0x54a130[_0x43eb25(0x1f6)]);},0x64),_0x54a130[_0x1efa71(0x1ad)](it,_0x54a130[_0x1efa71(0x1e2)],async()=>{const _0x4795af=_0x1efa71;_0x16b072=await _0x54a130[_0x4795af(0x1ed)](createServer,auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130[_0x4795af(0x1b5)](requiresAuth));const _0x47709f=await request({'baseUrl':baseUrl,'url':'/protected'});assert[_0x4795af(0x1a5)](_0x47709f[_0x4795af(0x20c)],0x191);}),it(_0x54a130['rCKYd'],async()=>{const _0x5e0830=_0x1efa71;if(_0x54a130['SoGfQ'](_0x54a130[_0x5e0830(0x20a)],_0x5e0830(0x204)))_0x18b3d8&&_0x3e76ab[_0x5e0830(0x1a1)]();else{_0x16b072=await _0x54a130[_0x5e0830(0x1ba)](createServer,null,requiresAuth());const {body:{err:_0xd7571d}}=await request({'baseUrl':baseUrl,'url':_0x5e0830(0x218),'json':!![]});assert[_0x5e0830(0x1a5)](_0xd7571d['message'],_0x54a130[_0x5e0830(0x21d)]);}}),it(_0x54a130['NXIiy'],async()=>{const _0x1241a9=_0x1efa71;_0x16b072=await _0x54a130[_0x1241a9(0x1ba)](createServer,auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimEquals(_0x54a130[_0x1241a9(0x1f5)],_0x1241a9(0x1bc)));const _0x4a12de=await login({'foo':_0x1241a9(0x1bc)}),_0x1f44b3=await request({'baseUrl':baseUrl,'jar':_0x4a12de,'url':'/protected'});assert['equal'](_0x1f44b3['statusCode'],0xc8);}),eval('1 + 1;'),_0x54a130[_0x1efa71(0x1fc)](it,_0x1efa71(0x1d2),async()=>{const _0x21461f=_0x1efa71;_0x16b072=await createServer(_0x54a130[_0x21461f(0x207)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimEquals(_0x21461f(0x1dd),_0x21461f(0x1bc)));const _0xcd0a29=await _0x54a130[_0x21461f(0x207)](login,{'foo':_0x54a130['TddQV']}),_0x74fa3f=await request({'baseUrl':baseUrl,'jar':_0xcd0a29,'url':_0x21461f(0x218)});assert[_0x21461f(0x1a5)](_0x74fa3f[_0x21461f(0x20c)],0x191);}),setInterval(_0x1efa71(0x21c),0x3e8),it(_0x54a130[_0x1efa71(0x1b2)],async()=>{const _0x1698f7=_0x1efa71;_0x16b072=await _0x54a130['aWsnR'](createServer,_0x54a130['CMleK'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130[_0x1698f7(0x1df)](claimEquals,_0x1698f7(0x20d),'bar'));const _0xf497dd=await login({'foo':_0x1698f7(0x1bc)}),_0x4d879d=await request({'baseUrl':baseUrl,'jar':_0xf497dd,'url':_0x1698f7(0x218)});assert[_0x1698f7(0x1a5)](_0x4d879d['statusCode'],0x191);}),_0x54a130[_0x1efa71(0x1c2)](setTimeout,_0x54a130[_0x1efa71(0x1eb)],0x3e8),it(_0x54a130[_0x1efa71(0x1c4)],async()=>{const _0x17975a=_0x1efa71;_0x16b072=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130['VvaRO'](claimEquals,_0x17975a(0x1dd),_0x54a130[_0x17975a(0x225)]));const _0x5bab4d=await _0x54a130[_0x17975a(0x208)](request,{'baseUrl':baseUrl,'url':_0x17975a(0x218)});assert[_0x17975a(0x1a5)](_0x5bab4d[_0x17975a(0x20c)],0x191);}),it(_0x54a130[_0x1efa71(0x1d9)],()=>{const _0x56eff5=_0x1efa71;assert['throws'](()=>claimEquals(!![],_0x56eff5(0x1bc)),TypeError,_0x56eff5(0x1c3));}),_0x54a130['xEkEF'](it,_0x54a130[_0x1efa71(0x19e)],()=>{const _0x56fe72=_0x1efa71;assert[_0x56fe72(0x1b6)](()=>claimEquals(_0x56fe72(0x1dd),{'bar':0x1}),TypeError,_0x54a130[_0x56fe72(0x209)]);}),it(_0x1efa71(0x1db),async()=>{const _0x329000=_0x1efa71;if(_0x329000(0x1b4)!==_0x329000(0x1b4))_0x5df1aa[_0x329000(0x1b6)](()=>_0x48c79a(_0x329000(0x1dd),{'bar':0x1}),_0x15b784,_0x54a130[_0x329000(0x209)]);else{_0x16b072=await createServer(_0x54a130[_0x329000(0x207)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes(_0x54a130[_0x329000(0x1f5)],_0x329000(0x1bc),_0x54a130[_0x329000(0x1be)]));const _0x3738e6=await _0x54a130[_0x329000(0x1c1)](login,{'foo':['baz',_0x329000(0x1bc)]}),_0x3ca1e1=await _0x54a130[_0x329000(0x208)](request,{'baseUrl':baseUrl,'jar':_0x3738e6,'url':_0x329000(0x218)});assert['equal'](_0x3ca1e1[_0x329000(0x20c)],0xc8);}}),eval('const _0x4292da = _0x1efa71;JSON[_0x4292da(460)]({ \'safe\': !![] });'),_0x54a130[_0x1efa71(0x1f3)](it,_0x54a130[_0x1efa71(0x1ac)],async()=>{const _0x271872=_0x1efa71;_0x16b072=await _0x54a130['KWzrh'](createServer,_0x54a130[_0x271872(0x208)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes('foo',_0x54a130[_0x271872(0x225)],_0x54a130['TddQV'],_0x271872(0x1a6)));const _0x3929ff=await _0x54a130[_0x271872(0x1bd)](login,{'foo':_0x271872(0x205)}),_0x1eb9f3=await _0x54a130['KHjnT'](request,{'baseUrl':baseUrl,'jar':_0x3929ff,'url':_0x271872(0x218)});assert[_0x271872(0x1a5)](_0x1eb9f3[_0x271872(0x20c)],0x191);}),it(_0x1efa71(0x1b7),async()=>{const _0x474715=_0x1efa71;if(_0x54a130[_0x474715(0x1f8)]!=='yryOk'){_0x16b072=await _0x54a130[_0x474715(0x1ba)](createServer,auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes(_0x54a130[_0x474715(0x1f5)],_0x474715(0x1bc),_0x474715(0x20d)));const _0x1e7c36=await _0x54a130[_0x474715(0x208)](login,{'foo':_0x54a130[_0x474715(0x1f7)]}),_0xf5c56b=await _0x54a130['rHDoG'](request,{'baseUrl':baseUrl,'jar':_0x1e7c36,'url':_0x474715(0x218)});assert[_0x474715(0x1a5)](_0xf5c56b[_0x474715(0x20c)],0xc8);}else _0x3a46fa[_0x474715(0x1b6)](()=>_0x156892(![],_0x474715(0x1bc)),_0x3234f7,_0x54a130[_0x474715(0x1f6)]);}),_0x54a130[_0x1efa71(0x1e8)](it,_0x1efa71(0x1cf),async()=>{const _0x57b467=_0x1efa71;_0x16b072=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130[_0x57b467(0x1cd)](claimIncludes,_0x54a130['MVKQS'],_0x57b467(0x1bc),_0x54a130[_0x57b467(0x1be)]));const _0x116f40=await login({'foo':{'bar':_0x54a130[_0x57b467(0x1be)]}}),_0x4565f7=await _0x54a130[_0x57b467(0x221)](request,{'baseUrl':baseUrl,'jar':_0x116f40,'url':'/protected'});assert[_0x57b467(0x1a5)](_0x4565f7[_0x57b467(0x20c)],0x191);}),it(_0x1efa71(0x1d1),()=>{const _0x2e4cea=_0x1efa71;assert[_0x2e4cea(0x1b6)](()=>claimIncludes(![],_0x2e4cea(0x1bc)),TypeError,_0x54a130[_0x2e4cea(0x1f6)]);}),_0x54a130[_0x1efa71(0x208)](fetch,_0x54a130[_0x1efa71(0x1e1)]),it(_0x54a130['vFJLq'],async()=>{const _0x473d79=_0x1efa71;if(_0x473d79(0x1f1)!==_0x54a130[_0x473d79(0x220)])_0x356cf2[_0x473d79(0x1a1)]();else{_0x16b072=await _0x54a130[_0x473d79(0x1fc)](createServer,_0x54a130['VVZBc'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes(_0x473d79(0x1dd),'bar',_0x54a130[_0x473d79(0x1be)]));const _0x1ce2f0=await _0x54a130[_0x473d79(0x1f4)](login,{'bar':_0x54a130[_0x473d79(0x21e)]}),_0x15e8bd=await _0x54a130[_0x473d79(0x1a8)](request,{'baseUrl':baseUrl,'jar':_0x1ce2f0,'url':_0x54a130['wGzNi']});assert[_0x473d79(0x1a5)](_0x15e8bd[_0x473d79(0x20c)],0x191);}}),new Function(_0x1efa71(0x1d6))(),_0x54a130[_0x1efa71(0x1ad)](it,_0x54a130[_0x1efa71(0x1dc)],async()=>{const _0x10833b=_0x1efa71;_0x16b072=await _0x54a130['KWzrh'](createServer,_0x54a130['rHDoG'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes(_0x10833b(0x1dd),'bar',_0x10833b(0x20d)));const _0x5b4a9f=await _0x54a130[_0x10833b(0x208)](request,{'baseUrl':baseUrl,'url':_0x10833b(0x218)});assert[_0x10833b(0x1a5)](_0x5b4a9f[_0x10833b(0x20c)],0x191);}),_0x54a130[_0x1efa71(0x1c7)](it,_0x54a130[_0x1efa71(0x1c9)],async()=>{const _0x553a41=_0x1efa71,_0x58e1c0={'ynVgk':_0x54a130[_0x553a41(0x19f)]};_0x54a130[_0x553a41(0x1d3)]!=='aovoE'?assert['throws'](()=>claimCheck(null),TypeError,_0x54a130[_0x553a41(0x1a3)]):_0x210fe6[_0x553a41(0x1e3)](_0x58e1c0['ynVgk']);}),_0x54a130[_0x1efa71(0x1a0)](it,_0x54a130['tcxzI'],async()=>{const _0x349bdc=_0x1efa71;_0x16b072=await _0x54a130[_0x349bdc(0x1ed)](createServer,auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimCheck(()=>!![]));const _0xff592d=await _0x54a130[_0x349bdc(0x1a4)](login),_0x109c3c=await _0x54a130[_0x349bdc(0x1a8)](request,{'baseUrl':baseUrl,'jar':_0xff592d,'url':_0x54a130['wGzNi']});assert[_0x349bdc(0x1a5)](_0x109c3c[_0x349bdc(0x20c)],0xc8);}),it(_0x54a130[_0x1efa71(0x19b)],async()=>{const _0x392078=_0x1efa71;_0x16b072=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130[_0x392078(0x1ec)](claimCheck,()=>![]));const _0x3ff1e5=await _0x54a130[_0x392078(0x1b5)](login),_0x5b9114=await _0x54a130[_0x392078(0x1c1)](request,{'baseUrl':baseUrl,'jar':_0x3ff1e5,'url':_0x54a130[_0x392078(0x224)]});assert['equal'](_0x5b9114[_0x392078(0x20c)],0x191);}),_0x54a130[_0x1efa71(0x1c2)](it,_0x54a130[_0x1efa71(0x1ef)],async()=>{const _0x148d79=_0x1efa71;_0x16b072=await _0x54a130[_0x148d79(0x1c2)](createServer,_0x54a130[_0x148d79(0x1a8)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0x54a130[_0x148d79(0x19d)](claimCheck,(_0x34c091,_0x549182)=>_0x549182['foo']===_0x148d79(0x1f2)));const _0x43eb2b=await login({'foo':_0x54a130[_0x148d79(0x1fa)]}),_0x365f19=await request({'baseUrl':baseUrl,'jar':_0x43eb2b,'url':_0x148d79(0x218)});assert[_0x148d79(0x1a5)](_0x365f19[_0x148d79(0x20c)],0xc8);}),it(_0x54a130[_0x1efa71(0x20e)],async()=>{const _0x282074=_0x1efa71,_0x3d0eeb=sinon['spy']();_0x16b072=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimCheck(_0x3d0eeb));const _0x80c5c4=await _0x54a130[_0x282074(0x1ee)](request,{'baseUrl':baseUrl,'url':'/protected'});assert[_0x282074(0x1a5)](_0x80c5c4['statusCode'],0x191),sinon[_0x282074(0x212)]['notCalled'](_0x3d0eeb);}),_0x54a130[_0x1efa71(0x1c2)](it,_0x54a130['dMtjU'],async()=>{const _0x1b6125=_0x1efa71;_0x16b072=await _0x54a130[_0x1b6125(0x1bd)](createServer,_0x54a130[_0x1b6125(0x1ec)](auth,defaultConfig));const _0x4c2ef4=[_0x54a130[_0x1b6125(0x1da)],_0x54a130['jWayo'],_0x54a130[_0x1b6125(0x1da)]];for(const _0x38b0f7 of _0x4c2ef4){const _0x160da5=await _0x54a130[_0x1b6125(0x1ec)](request,{'url':''+baseUrl+_0x38b0f7}),_0x292cfa=new URL(_0x160da5[_0x1b6125(0x1aa)]['location'])[_0x1b6125(0x20f)]['get'](_0x1b6125(0x1a2)),_0x2a6eb4=Buffer[_0x1b6125(0x1ff)](_0x292cfa,'base64'),_0x790ab5=JSON[_0x1b6125(0x1e0)](_0x2a6eb4);assert[_0x1b6125(0x1a5)](_0x160da5[_0x1b6125(0x20c)],0x12e),assert['include'](_0x160da5[_0x1b6125(0x1aa)][_0x1b6125(0x206)],_0x54a130[_0x1b6125(0x1e5)]),assert[_0x1b6125(0x1a5)](_0x790ab5[_0x1b6125(0x20b)],'/google.com');}});});