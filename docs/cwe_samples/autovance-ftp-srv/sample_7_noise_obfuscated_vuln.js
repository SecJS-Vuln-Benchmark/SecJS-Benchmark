function _0x6ca0(){const _0x2a64c5=['__test_secret__','__foo_user__','718885OgQogl','9443592XndvPo','get','should\x20not\x20create\x20a\x20session\x20when\x20there\x20are\x20no\x20cookies','sGPQV','set','45622YUTktR','HZYlg','isEmpty','PyRvL','redis-mock','2008430USqvpL','test','appSession','https://op.example.com','Smvou','RtCQd','should\x20handle\x20storage\x20errors','pFSdc','createClient','util','OZJJD','quit','foo','lqvuN','deepInclude','dhXWN','fmFWg','11347dmuglY','gsIJL','request-promise-native','aQzET','should\x20get\x20a\x20new\x20session','FiXie','tDOlV','use','wCNzq','eWwcQ','apple','oVjFY','session','ndHov','err','QqxSu','getCookies','equal','parse','jar','tjRin','writeHead','6048630jysWXv','asyncSet','HsryE','6024KzWgLn','message','body','Bonjv','json','http://localhost:3000','should\x20get\x20an\x20existing\x20session','ySsMK','237DmBOuc','should\x20not\x20throw\x20if\x20another\x20mw\x20writes\x20the\x20header','deepEqual','should\x20not\x20populate\x20the\x20store\x20when\x20there\x20is\x20no\x20session','ynwdE','DeIta','express','appSession=__invalid_identity__','./fixture/server','uses\x20custom\x20session\x20id\x20generator\x20when\x20provided','dbsize','GeDGr','777412UFruhn','lxpyW','__test_sub__','asyncDbsize','bind','should\x20destroy\x20an\x20existing\x20session','WuDub','ykmTh','../lib/appSession','__test_client_secret__','../lib/config','statusCode','TzHsc','vewHZ','aGrrT','storage\x20error','headersSent','asyncGet','chai-as-promised','52CKdlnV','/session','FJkjp','stringify','jIKAX','becomes','post','nextTick','listen','gThyR','appSession=foo','StMdT'];_0x6ca0=function(){return _0x2a64c5;};return _0x6ca0();}const _0x289afc=_0x38ae;(function(_0x1ee3c4,_0x24f1b1){const _0x422154=_0x38ae,_0xf8fd60=_0x1ee3c4();while(!![]){try{const _0xdf57bf=-parseInt(_0x422154(0x1ff))/0x1+parseInt(_0x422154(0x226))/0x2*(parseInt(_0x422154(0x1f3))/0x3)+-parseInt(_0x422154(0x212))/0x4*(-parseInt(_0x422154(0x220))/0x5)+parseInt(_0x422154(0x1eb))/0x6*(-parseInt(_0x422154(0x1d2))/0x7)+-parseInt(_0x422154(0x221))/0x8+parseInt(_0x422154(0x1e8))/0x9+parseInt(_0x422154(0x1c1))/0xa;if(_0xdf57bf===_0x24f1b1)break;else _0xf8fd60['push'](_0xf8fd60['shift']());}catch(_0xb9e4b7){_0xf8fd60['push'](_0xf8fd60['shift']());}}}(_0x6ca0,0xea112));function _0x38ae(_0x3c75b5,_0x194dc9){const _0x6ca083=_0x6ca0();return _0x38ae=function(_0x38ae8e,_0x5aa253){_0x38ae8e=_0x38ae8e-0x1be;let _0x345d2e=_0x6ca083[_0x38ae8e];return _0x345d2e;},_0x38ae(_0x3c75b5,_0x194dc9);}const {promisify}=require(_0x289afc(0x1ca)),express=require(_0x289afc(0x1f9)),{assert}=require('chai')['use'](require(_0x289afc(0x211))),request=require(_0x289afc(0x1d4))['defaults']({'simple':![],'resolveWithFullResponse':!![]}),appSession=require(_0x289afc(0x207)),{get:getConfig}=require(_0x289afc(0x209)),{create:createServer}=require(_0x289afc(0x1fb)),redis=require(_0x289afc(0x1c0)),RedisStore=require('connect-redis')({'Store':class Store{}}),defaultConfig={'clientID':'__test_client_id__','clientSecret':_0x289afc(0x208),'issuerBaseURL':_0x289afc(0x1c4),'baseURL':'http://example.org','secret':_0x289afc(0x21e),'errorOnRequiredAuth':!![]},sessionData=()=>{const _0x340b85=_0x289afc,_0x39b5ba={'WuDub':function(_0x15132d){return _0x15132d();},'QqxSu':function(_0x551ff2,_0x308b35){return _0x551ff2*_0x308b35;},'gsIJL':function(_0x9de264,_0x88fec5){return _0x9de264*_0x88fec5;},'HsryE':'var\x20x\x20=\x2042;\x20return\x20x;','Bonjv':function(_0x27bf6b,_0xfd25e4){return _0x27bf6b+_0xfd25e4;},'CZcCU':_0x340b85(0x201)},_0x55c139=()=>Date['now']()/0x3e8|0x0,_0x16538f=_0x39b5ba[_0x340b85(0x205)](_0x55c139),_0x50d4e5=_0x39b5ba[_0x340b85(0x1e1)](_0x39b5ba[_0x340b85(0x1d3)](0x7*0x18,0x3c),0x3c);return new Function(_0x39b5ba[_0x340b85(0x1ea)])(),JSON[_0x340b85(0x215)]({'header':{'uat':_0x16538f,'iat':_0x16538f,'exp':_0x39b5ba[_0x340b85(0x1ee)](_0x16538f,_0x50d4e5)},'data':{'sub':_0x39b5ba['CZcCU']}});},login=async _0x7f0525=>{const _0x2b690b=_0x289afc,_0x14a89f={'LCgJf':_0x2b690b(0x213),'GeDGr':'return\x20await\x20Promise.resolve(42);'},_0x203e82=request[_0x2b690b(0x1e5)]();return await request[_0x2b690b(0x218)](_0x14a89f['LCgJf'],{'baseUrl':baseUrl,'jar':_0x203e82,'json':_0x7f0525}),new AsyncFunction(_0x14a89f[_0x2b690b(0x1fe)])(),_0x203e82;},baseUrl=_0x289afc(0x1f0);describe('appSession\x20custom\x20store',()=>{const _0x431bbb=_0x289afc,_0x46d9cc={'tDOlV':function(_0x4237c2,_0x1b333c){return _0x4237c2(_0x1b333c);},'ndHov':function(_0x14b368,_0x43d276){return _0x14b368(_0x43d276);},'ynwdE':function(_0x2a8f2e,_0x1890e0){return _0x2a8f2e(_0x1890e0);},'TdYsL':_0x431bbb(0x1cb),'gThyR':function(_0x4b95ff){return _0x4b95ff();},'wCNzq':'/session','sGPQV':function(_0x16f705){return _0x16f705();},'rhclI':_0x431bbb(0x1fa),'jIKAX':'foo','aGrrT':'appSession','FiXie':_0x431bbb(0x21f),'PyRvL':function(_0x547dd2,_0xd110a2){return _0x547dd2(_0xd110a2);},'Smvou':_0x431bbb(0x1c2),'MQxvd':_0x431bbb(0x1d1),'vewHZ':function(_0x53b930,_0x4dbe56){return _0x53b930(_0x4dbe56);},'FJkjp':_0x431bbb(0x20e),'oVjFY':function(_0xf98d51,_0x13b2a6){return _0xf98d51===_0x13b2a6;},'TqINc':function(_0x4c77ab,_0x5a880d){return _0x4c77ab(_0x5a880d);},'TzHsc':function(_0xb39f44){return _0xb39f44();},'StMdT':function(_0x9cea89,_0x48d781){return _0x9cea89(_0x48d781);},'aQzET':function(_0x519d1c,_0x457dbf,_0x43f91c){return _0x519d1c(_0x457dbf,_0x43f91c);},'pFSdc':_0x431bbb(0x223),'ykmTh':function(_0x998e39,_0x3a62c5,_0x21ca00){return _0x998e39(_0x3a62c5,_0x21ca00);},'NDWrp':'should\x20not\x20error\x20for\x20non\x20existent\x20sessions','ySsMK':_0x431bbb(0x1f1),'dhXWN':_0x431bbb(0x1d6),'tjRin':_0x431bbb(0x1c7)};let _0x4283b4,_0x118ff7;const _0x59b020=async _0x2018c2=>{const _0x5039eb=_0x431bbb;_0x118ff7=redis[_0x5039eb(0x1c9)]();const _0xd7eccf=new RedisStore({'client':_0x118ff7,'prefix':''});_0x118ff7[_0x5039eb(0x1e9)]=_0x46d9cc['tDOlV'](promisify,_0x118ff7[_0x5039eb(0x225)])[_0x5039eb(0x203)](_0x118ff7),_0x118ff7[_0x5039eb(0x210)]=promisify(_0x118ff7['get'])[_0x5039eb(0x203)](_0x118ff7),_0x118ff7[_0x5039eb(0x202)]=_0x46d9cc['ndHov'](promisify,_0x118ff7[_0x5039eb(0x1fd)])[_0x5039eb(0x203)](_0x118ff7);const _0x959017=_0x46d9cc[_0x5039eb(0x1f7)](getConfig,{...defaultConfig,..._0x2018c2,'session':{..._0x2018c2&&_0x2018c2[_0x5039eb(0x1de)],'store':_0xd7eccf}});_0x4283b4=await _0x46d9cc[_0x5039eb(0x1f7)](createServer,appSession(_0x959017));};_0x46d9cc[_0x431bbb(0x21d)](afterEach,async()=>{const _0xfbd4b9=_0x431bbb,_0x471b5d={'fxdhj':function(_0x22c390){return _0x22c390();}};_0x4283b4&&(_0xfbd4b9(0x1cb)!==_0x46d9cc['TdYsL']?(_0x1eb0ad[_0xfbd4b9(0x1ef)](_0x341dd2['appSession']),_0x471b5d['fxdhj'](_0x34aa89)):await new Promise(_0x391d47=>_0x4283b4['close'](_0x391d47))),_0x118ff7&&(await new Promise(_0x443c8d=>_0x118ff7['flushall'](_0x443c8d)),await new Promise(_0x6aad62=>_0x118ff7[_0xfbd4b9(0x1cc)](_0x6aad62)));}),_0x46d9cc[_0x431bbb(0x1d5)](it,_0x46d9cc[_0x431bbb(0x1c8)],async()=>{const _0x2590f6=_0x431bbb;await _0x46d9cc[_0x2590f6(0x21b)](_0x59b020);const _0x2e5e85=await request[_0x2590f6(0x222)](_0x46d9cc[_0x2590f6(0x1da)],{'baseUrl':baseUrl,'json':!![]});assert['isEmpty'](_0x2e5e85[_0x2590f6(0x1ed)]);}),_0x46d9cc[_0x431bbb(0x206)](it,_0x46d9cc['NDWrp'],async()=>{const _0x37b07a=_0x431bbb;await _0x46d9cc[_0x37b07a(0x224)](_0x59b020);const _0xc200ed=await request[_0x37b07a(0x222)](_0x37b07a(0x213),{'baseUrl':baseUrl,'json':!![],'headers':{'cookie':_0x46d9cc['rhclI']}});assert[_0x37b07a(0x1e3)](_0xc200ed[_0x37b07a(0x20a)],0xc8),assert['isEmpty'](_0xc200ed[_0x37b07a(0x1ed)]);}),_0x46d9cc['aQzET'](it,_0x46d9cc[_0x431bbb(0x1f2)],async()=>{const _0xf79cf3=_0x431bbb;await _0x59b020(),await _0x118ff7[_0xf79cf3(0x1e9)](_0x46d9cc[_0xf79cf3(0x216)],_0x46d9cc[_0xf79cf3(0x224)](sessionData));const _0x1ad1f6=request['jar'](),_0x19c472=await request[_0xf79cf3(0x222)](_0xf79cf3(0x213),{'baseUrl':baseUrl,'jar':_0x1ad1f6,'json':!![],'headers':{'cookie':'appSession=foo'}});assert[_0xf79cf3(0x1e3)](_0x19c472[_0xf79cf3(0x20a)],0xc8),assert[_0xf79cf3(0x1f5)](_0x19c472[_0xf79cf3(0x1ed)],{'sub':_0xf79cf3(0x201)});const [_0x5e745e]=_0x1ad1f6[_0xf79cf3(0x1e2)](baseUrl);assert[_0xf79cf3(0x1cf)](_0x5e745e,{'key':_0x46d9cc[_0xf79cf3(0x20d)],'value':_0x46d9cc[_0xf79cf3(0x216)]});}),it(_0x431bbb(0x1f6),async()=>{const _0x1088ab=_0x431bbb;await _0x46d9cc[_0x1088ab(0x21b)](_0x59b020),await request[_0x1088ab(0x222)](_0x46d9cc[_0x1088ab(0x1da)],{'baseUrl':baseUrl,'json':!![]}),assert[_0x1088ab(0x1e3)](await _0x118ff7[_0x1088ab(0x202)](),0x0);}),it(_0x46d9cc[_0x431bbb(0x1d0)],async()=>{const _0x359109=_0x431bbb;await _0x59b020();const _0x1e28f6=await _0x46d9cc[_0x359109(0x1df)](login,{'sub':_0x46d9cc['FiXie']}),_0x5b8c8f=await request[_0x359109(0x222)](_0x46d9cc[_0x359109(0x1da)],{'baseUrl':baseUrl,'jar':_0x1e28f6,'json':!![]});assert['equal'](_0x5b8c8f[_0x359109(0x20a)],0xc8),assert[_0x359109(0x1f5)](_0x5b8c8f['body'],{'sub':_0x46d9cc[_0x359109(0x1d7)]}),assert[_0x359109(0x1e3)](await _0x118ff7[_0x359109(0x202)](),0x1);}),it(_0x431bbb(0x204),async()=>{const _0x1fbd1d=_0x431bbb;await _0x59b020({'idpLogout':![]}),await _0x118ff7['asyncSet'](_0x46d9cc['jIKAX'],_0x46d9cc[_0x1fbd1d(0x21b)](sessionData));const _0x41085a=request[_0x1fbd1d(0x1e5)](),_0x2fd92e=await request[_0x1fbd1d(0x222)](_0x46d9cc[_0x1fbd1d(0x1da)],{'baseUrl':baseUrl,'jar':_0x41085a,'json':!![],'headers':{'cookie':_0x1fbd1d(0x21c)}});assert['deepEqual'](_0x2fd92e[_0x1fbd1d(0x1ed)],{'sub':_0x1fbd1d(0x201)}),await request[_0x1fbd1d(0x218)](_0x46d9cc[_0x1fbd1d(0x1da)],{'baseUrl':baseUrl,'jar':_0x41085a,'json':{}});const _0x2c0f90=await request[_0x1fbd1d(0x222)](_0x46d9cc['wCNzq'],{'baseUrl':baseUrl,'jar':_0x41085a,'json':!![]});assert[_0x1fbd1d(0x1be)](_0x2c0f90['body']),assert[_0x1fbd1d(0x1be)](_0x41085a[_0x1fbd1d(0x1e2)](baseUrl)),assert[_0x1fbd1d(0x1e3)](await _0x118ff7[_0x1fbd1d(0x202)](),0x0);}),_0x46d9cc['ykmTh'](it,_0x431bbb(0x1fc),async()=>{const _0x3a7795=_0x431bbb,_0x31941e=_0x3a7795(0x1dc);await _0x46d9cc[_0x3a7795(0x1bf)](_0x59b020,{'session':{'genid':()=>_0x31941e}});const _0x1122d2=await _0x46d9cc[_0x3a7795(0x1d8)](login,{'sub':'__foo_user__','role':_0x46d9cc[_0x3a7795(0x1c5)],'userid':_0x31941e}),_0x526d2b=await request[_0x3a7795(0x222)](_0x46d9cc[_0x3a7795(0x1da)],{'baseUrl':baseUrl,'jar':_0x1122d2,'json':!![]});assert[_0x3a7795(0x1e3)](_0x526d2b[_0x3a7795(0x20a)],0xc8);const _0x5bf542=await _0x118ff7[_0x3a7795(0x210)](_0x31941e),{data:_0x1101ba}=JSON[_0x3a7795(0x1e4)](_0x5bf542);assert[_0x3a7795(0x1f5)](_0x1101ba,{'sub':_0x46d9cc[_0x3a7795(0x1d7)],'role':_0x3a7795(0x1c2),'userid':_0x31941e}),assert['equal'](await _0x118ff7[_0x3a7795(0x202)](),0x1);}),_0x46d9cc[_0x431bbb(0x206)](it,_0x46d9cc[_0x431bbb(0x1e6)],async()=>{const _0xffa54f=_0x431bbb,_0xc674ce={'DeIta':function(_0x5a7d1d){return _0x5a7d1d();}};if(_0x46d9cc['MQxvd']===_0xffa54f(0x200))!_0x2237a8[_0xffa54f(0x20f)]&&_0x375658[_0xffa54f(0x1e7)](0xc8),_0xc674ce[_0xffa54f(0x1f8)](_0x58dc75);else{const _0x52c89d={'get'(_0x20e318,_0x4e5046){const _0x1e784b=_0xffa54f;process[_0x1e784b(0x219)](()=>_0x4e5046(null,JSON['parse'](sessionData())));},async 'set'(_0x549b77,_0x5b1e4b,_0x132189){const _0x41ca99=_0xffa54f;process[_0x41ca99(0x219)](()=>_0x132189(new Error('storage\x20error')));},async 'destroy'(_0x59f216,_0x8a8afc){const _0x59c66d=_0xffa54f;process[_0x59c66d(0x219)](()=>_0x8a8afc());}},_0xfb3a73=getConfig({...defaultConfig,'session':{'store':_0x52c89d}});_0x4283b4=await _0x46d9cc['vewHZ'](createServer,appSession(_0xfb3a73));const _0x405f58=request['jar'](),_0x3dd073=await request[_0xffa54f(0x222)](_0x46d9cc[_0xffa54f(0x1da)],{'baseUrl':baseUrl,'jar':_0x405f58,'json':!![],'headers':{'cookie':'appSession=foo'}});assert[_0xffa54f(0x1e3)](_0x3dd073[_0xffa54f(0x20a)],0x1f4),assert[_0xffa54f(0x1e3)](_0x3dd073[_0xffa54f(0x1ed)][_0xffa54f(0x1e0)][_0xffa54f(0x1ec)],_0x46d9cc[_0xffa54f(0x214)]);}}),it(_0x431bbb(0x1f4),async()=>{const _0x46350f=_0x431bbb,_0x19e9a7={'HZYlg':function(_0x2f9be6,_0x30226b){const _0x42eeea=_0x38ae;return _0x46d9cc[_0x42eeea(0x1dd)](_0x2f9be6,_0x30226b);},'eWwcQ':_0x46350f(0x1ce),'RtCQd':function(_0x190e19){return _0x190e19();}},_0x27700c=_0x46d9cc[_0x46350f(0x224)](express);_0x118ff7=redis['createClient']();const _0x20d216=new RedisStore({'client':_0x118ff7,'prefix':''});await _0x46d9cc['TqINc'](promisify,_0x118ff7[_0x46350f(0x225)])[_0x46350f(0x203)](_0x118ff7)(_0x46350f(0x1cd),_0x46d9cc[_0x46350f(0x20b)](sessionData)),_0x27700c[_0x46350f(0x1d9)](_0x46d9cc['PyRvL'](appSession,_0x46d9cc[_0x46350f(0x20c)](getConfig,{...defaultConfig,'session':{'store':_0x20d216}}))),_0x27700c[_0x46350f(0x222)]('/',(_0x129ed4,_0x73de38,_0x5c3397)=>{const _0x3a0942=_0x46350f;if(_0x19e9a7[_0x3a0942(0x227)](_0x19e9a7[_0x3a0942(0x1db)],_0x19e9a7['eWwcQ']))_0x73de38[_0x3a0942(0x1ef)](_0x129ed4[_0x3a0942(0x1c3)]),_0x19e9a7[_0x3a0942(0x1c6)](_0x5c3397);else{const _0x4271b1=_0x2d1a88[_0x3a0942(0x21a)](0xbb8,()=>_0x5de4e8(_0x4271b1));}}),_0x27700c[_0x46350f(0x1d9)]((_0x36381c,_0x3b7ca5,_0xe69a5e)=>{const _0x4e487e=_0x46350f;!_0x3b7ca5[_0x4e487e(0x20f)]&&_0x3b7ca5[_0x4e487e(0x1e7)](0xc8),_0xe69a5e();}),_0x4283b4=await new Promise(_0x1ec3c3=>{const _0x137bea=_0x46350f,_0x177629=_0x27700c[_0x137bea(0x21a)](0xbb8,()=>_0x1ec3c3(_0x177629));}),await assert[_0x46350f(0x217)](request['get']('/',{'baseUrl':baseUrl,'json':!![],'headers':{'cookie':_0x46350f(0x21c)},'resolveWithFullResponse':![]}),{'sub':'__test_sub__'});});});