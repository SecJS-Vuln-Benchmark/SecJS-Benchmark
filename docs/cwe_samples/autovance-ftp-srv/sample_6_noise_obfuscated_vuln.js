const _0xf2afb5=_0x4089;function _0x5940(){const _0x49cfd3=['11NXQTrd','../lib/hooks/getLoginState','IekSg','routes','session','authentication\x20is\x20required\x20for\x20all\x20routes\x20this\x20middleware\x20is\x20applied\x20to','4yjTqMM','oidc','ZetkZ','message','get','DRPpT','logout','./attemptSilentLogin','vdyuO','1562fqGrhp','authentication\x20is\x20not\x20required\x20for\x20any\x20of\x20the\x20routes\x20this\x20middleware\x20is\x20applied\x20to\x20','assign','iMiUn','xMCZm','hPyvZ','kvMWF','getRedirectUri','1614040MBeoun','name','../lib/transientHandler','Router','KGVJV','logout\x20handling\x20route\x20not\x20applied','see\x20and\x20apply\x20`requiresAuth`\x20middlewares\x20to\x20your\x20protected\x20resources','1339728sBBnWM','afterCallback','622962oqAYsi','tokenEndpointParams','fRvIu','YkUyU','method','openidState','configuration\x20object\x20processed,\x20resulting\x20configuration:\x20%O','../lib/context','tWeUs','xdGTO','once','svKHr','bqqfE','login','1205610vYsfkN','getOnce','resumeSilentLogin','post','adding\x20GET\x20%s\x20route','erzGf','../lib/config','catch','hbGOp','49RFDusy','parse','UJnsL','http-errors','attemptingSilentLogin','claims','178vraPta','login\x20handling\x20route\x20not\x20applied','EjwPB','QnBqM','baseURL','auth_verification','uONcd','adding\x20POST\x20%s\x20route','OheGN','OTnrb','callbackParams','use','var\x20x\x20=\x2042;\x20return\x20x;','118194zYoZAX','OKGYm','JecmU','DJHVd','SjvpY','attemptSilentLogin','../lib/client','1546875djBNmI','auth','./requiresAuth','ulVNR','silent\x20login\x20will\x20be\x20attempted\x20on\x20end-user\x27s\x20initial\x20HTML\x20request','returnTo','urlencoded','AbNnw','split','%s\x20%s\x20called','callback'];_0x5940=function(){return _0x49cfd3;};return _0x5940();}(function(_0x340d09,_0x583beb){const _0x36ef11=_0x4089,_0x4d4f2b=_0x340d09();while(!![]){try{const _0x14a068=parseInt(_0x36ef11(0x1fe))/0x1*(parseInt(_0x36ef11(0x1d0))/0x2)+-parseInt(_0x36ef11(0x1b3))/0x3*(parseInt(_0x36ef11(0x1f5))/0x4)+parseInt(_0x36ef11(0x1c1))/0x5+parseInt(_0x36ef11(0x1dd))/0x6*(parseInt(_0x36ef11(0x1ca))/0x7)+-parseInt(_0x36ef11(0x1b1))/0x8+-parseInt(_0x36ef11(0x1e4))/0x9+parseInt(_0x36ef11(0x1aa))/0xa*(parseInt(_0x36ef11(0x1ef))/0xb);if(_0x14a068===_0x583beb)break;else _0x4d4f2b['push'](_0x4d4f2b['shift']());}catch(_0x12eaed){_0x4d4f2b['push'](_0x4d4f2b['shift']());}}}(_0x5940,0x2055a));function _0x4089(_0xa085c0,_0x1695ff){const _0x59400c=_0x5940();return _0x4089=function(_0x408919,_0x28c153){_0x408919=_0x408919-0x1a8;let _0x5be063=_0x59400c[_0x408919];return _0x5be063;},_0x4089(_0xa085c0,_0x1695ff);}const express=require('express'),cb=require('cb'),createError=require(_0xf2afb5(0x1cd)),debug=require('../lib/debug')(_0xf2afb5(0x1e5)),{get:getConfig}=require(_0xf2afb5(0x1c7)),{get:getClient}=require(_0xf2afb5(0x1e3)),{requiresAuth}=require(_0xf2afb5(0x1e6)),attemptSilentLogin=require(_0xf2afb5(0x1fc)),TransientCookieHandler=require(_0xf2afb5(0x1ac)),{RequestContext,ResponseContext}=require(_0xf2afb5(0x1ba)),appSession=require('../lib/appSession'),{regenerateSessionStoreId,replaceSession}=appSession,{decodeState}=require(_0xf2afb5(0x1f0)),enforceLeadingSlash=_0x5d5382=>{const _0x13b803=_0xf2afb5,_0x3d9355={'EjwPB':function(_0x359f99,_0x42f715){return _0x359f99*_0x42f715;},'ulVNR':function(_0x187637,_0x29e932){return _0x187637===_0x29e932;},'UJnsL':function(_0x5b6b7f,_0x1f1bdd){return _0x5b6b7f+_0x1f1bdd;}};return eval('const _0x3522c8 = _0x4089;_0x3d9355[_0x3522c8(466)](Math[\'PI\'], 2);'),_0x3d9355[_0x13b803(0x1e7)](_0x5d5382[_0x13b803(0x1ec)]('')[0x0],'/')?_0x5d5382:_0x3d9355[_0x13b803(0x1cc)]('/',_0x5d5382);},auth=function(_0x3458ab){const _0x4677f6=_0xf2afb5,_0x22e90a={'fRvIu':function(_0x5ee4a9){return _0x5ee4a9();},'DJHVd':function(_0x2206d4,_0x4b87bf){return _0x2206d4(_0x4b87bf);},'uONcd':function(_0x18aa52,_0x15e48e){return _0x18aa52!==_0x15e48e;},'YkUyU':_0x4677f6(0x1fd),'QnBqM':_0x4677f6(0x1eb),'bqqfE':function(_0x4e5f95,_0x13afd1){return _0x4e5f95===_0x13afd1;},'ZetkZ':function(_0x39bbba,_0x24fbbe,_0x181243,_0x360527){return _0x39bbba(_0x24fbbe,_0x181243,_0x360527);},'tWeUs':function(_0x4547dd){return _0x4547dd();},'iMiUn':'NIwgU','DRPpT':function(_0x52cfa5){return _0x52cfa5();},'SlDem':function(_0x1577fb,_0xd4158f){return _0x1577fb(_0xd4158f);},'IekSg':function(_0x2e4a6c,_0x849958,_0x10055c){return _0x2e4a6c(_0x849958,_0x10055c);},'BVZGU':function(_0x2763d7,_0x57ace8){return _0x2763d7(_0x57ace8);},'KGVJV':function(_0x265b79,_0x21fb31,_0x5aacf7){return _0x265b79(_0x21fb31,_0x5aacf7);},'xMCZm':_0x4677f6(0x1c5),'OKGYm':function(_0x1e80e5,_0x449840){return _0x1e80e5(_0x449840);},'hbGOp':_0x4677f6(0x1d1),'SjvpY':'KeVMU','RxdRE':'tkgsR','erzGf':function(_0x28a3b0,_0x4c331b){return _0x28a3b0(_0x4c331b);},'hPyvZ':function(_0x569cb4,_0x463ba4,_0x5e33b9){return _0x569cb4(_0x463ba4,_0x5e33b9);},'kvMWF':function(_0x4b882a,_0x550167,_0x5bb245){return _0x4b882a(_0x550167,_0x5bb245);},'gQNow':_0x4677f6(0x1d7),'OheGN':_0x4677f6(0x1b0),'JecmU':_0x4677f6(0x1e8)},_0x7f563d=_0x22e90a['SlDem'](getConfig,_0x3458ab);_0x22e90a[_0x4677f6(0x1f1)](debug,_0x4677f6(0x1b9),_0x7f563d);const _0x6609ae=new express[(_0x4677f6(0x1ad))](),_0x5768d6=new TransientCookieHandler(_0x7f563d);_0x6609ae[_0x4677f6(0x1db)](_0x22e90a['BVZGU'](appSession,_0x7f563d)),_0x6609ae[_0x4677f6(0x1db)](async(_0x4d2877,_0x1c5f30,_0x593b5d)=>{const _0x15581a=_0x4677f6;_0x4d2877[_0x15581a(0x1f6)]=new RequestContext(_0x7f563d,_0x4d2877,_0x1c5f30,_0x593b5d),_0x1c5f30[_0x15581a(0x1f6)]=new ResponseContext(_0x7f563d,_0x4d2877,_0x1c5f30,_0x593b5d,_0x5768d6),_0x22e90a[_0x15581a(0x1b5)](_0x593b5d);});if(_0x7f563d[_0x4677f6(0x1f2)][_0x4677f6(0x1c0)]){const _0x243dbe=enforceLeadingSlash(_0x7f563d[_0x4677f6(0x1f2)][_0x4677f6(0x1c0)]);_0x22e90a[_0x4677f6(0x1ae)](debug,_0x22e90a[_0x4677f6(0x202)],_0x243dbe),_0x6609ae[_0x4677f6(0x1f9)](_0x243dbe,express[_0x4677f6(0x1ea)]({'extended':![]}),(_0x2b7fb8,_0x423e3f)=>_0x423e3f['oidc'][_0x4677f6(0x1c0)]({'returnTo':_0x7f563d[_0x4677f6(0x1d4)]}));}else _0x22e90a[_0x4677f6(0x1de)](debug,_0x22e90a[_0x4677f6(0x1c9)]);if(_0x7f563d[_0x4677f6(0x1f2)][_0x4677f6(0x1fb)]){const _0x4f06f8=enforceLeadingSlash(_0x7f563d[_0x4677f6(0x1f2)][_0x4677f6(0x1fb)]);debug(_0x4677f6(0x1c5),_0x4f06f8),_0x6609ae[_0x4677f6(0x1f9)](_0x4f06f8,(_0x28ca26,_0x5b1954)=>_0x5b1954[_0x4677f6(0x1f6)][_0x4677f6(0x1fb)]());}else _0x22e90a[_0x4677f6(0x1e1)]!==_0x22e90a['RxdRE']?debug(_0x4677f6(0x1af)):_0x1c2a87[_0x4677f6(0x200)](_0x4765ff[_0x1f178f[_0x4677f6(0x1f3)][_0x4677f6(0x1ab)]],_0x36d667);{let _0x445482;const _0x3f1465=_0x22e90a[_0x4677f6(0x1c6)](enforceLeadingSlash,_0x7f563d[_0x4677f6(0x1f2)][_0x4677f6(0x1ee)]),_0x361954=[(_0x48a186,_0x4596c0,_0x4acd98)=>{const _0x5d9e37=_0x4677f6;'svKHr'!==_0x5d9e37(0x1be)?_0x1c0793['PI']*0x2:(debug(_0x5d9e37(0x1ed),_0x48a186[_0x5d9e37(0x1b7)],_0x3f1465),_0x4acd98());},async(_0x48884e,_0x586f0f,_0x5cb45e)=>{const _0x28e4b8=_0x4677f6,_0x5217f3={'OTnrb':function(_0x37078e,_0x340505){return _0x37078e*_0x340505;},'WYeRu':function(_0x234794,_0x15ccea){return _0x234794===_0x15ccea;}};_0x5cb45e=cb(_0x5cb45e)[_0x28e4b8(0x1bd)](),_0x445482=_0x445482||await _0x22e90a['DJHVd'](getClient,_0x7f563d)[_0x28e4b8(0x1c8)](_0x41e691=>{_0x5cb45e(_0x41e691);});if(!_0x445482){new Function(_0x28e4b8(0x1dc))();return;}try{if(_0x22e90a[_0x28e4b8(0x1d6)](_0x22e90a[_0x28e4b8(0x1b6)],_0x28e4b8(0x1fd)))aBVGbU[_0x28e4b8(0x1d9)](_0x430c96['PI'],0x2);else{const _0x3849a3=_0x586f0f['oidc'][_0x28e4b8(0x1a9)]();let _0x5ac536;try{const _0x2ffd91=_0x445482[_0x28e4b8(0x1da)](_0x48884e),_0x273f11=_0x5768d6[_0x28e4b8(0x1c2)](_0x28e4b8(0x1d5),_0x48884e,_0x586f0f),{max_age:_0xf0ef88,code_verifier:_0x259264,nonce:_0x224d30,state:_0x391585}=_0x273f11?JSON[_0x28e4b8(0x1cb)](_0x273f11):{};_0x48884e['openidState']=decodeState(_0x391585);const _0x1c9b09={'max_age':_0xf0ef88,'code_verifier':_0x259264,'nonce':_0x224d30,'state':_0x391585};let _0x52eaa6;_0x7f563d[_0x28e4b8(0x1b4)]&&(_0x52eaa6={'exchangeBody':_0x7f563d[_0x28e4b8(0x1b4)]}),_0x5ac536=await _0x445482['callback'](_0x3849a3,_0x2ffd91,_0x1c9b09,_0x52eaa6);}catch(_0xc63840){throw createError['BadRequest'](_0xc63840[_0x28e4b8(0x1f8)]);}let _0x2ac8a2=Object[_0x28e4b8(0x200)]({},_0x5ac536);_0x7f563d[_0x28e4b8(0x1b2)]&&(_0x2ac8a2=await _0x7f563d[_0x28e4b8(0x1b2)](_0x48884e,_0x586f0f,_0x2ac8a2,_0x48884e['openidState']));if(_0x48884e[_0x28e4b8(0x1f6)]['isAuthenticated']()){if(_0x22e90a[_0x28e4b8(0x1d3)]===_0x28e4b8(0x1eb))_0x22e90a[_0x28e4b8(0x1bf)](_0x48884e[_0x28e4b8(0x1f6)]['user']['sub'],_0x5ac536[_0x28e4b8(0x1cf)]()['sub'])?Object['assign'](_0x48884e[_0x7f563d[_0x28e4b8(0x1f3)]['name']],_0x2ac8a2):(_0x22e90a[_0x28e4b8(0x1f7)](replaceSession,_0x48884e,_0x2ac8a2,_0x7f563d),regenerateSessionStoreId(_0x48884e,_0x7f563d));else return eval('_0x2c3076[\'PI\'] * 2;'),_0x5217f3['WYeRu'](_0xdcb595[_0x28e4b8(0x1ec)]('')[0x0],'/')?_0xfb5539:'/'+_0x4761c4;}else Object[_0x28e4b8(0x200)](_0x48884e[_0x7f563d['session'][_0x28e4b8(0x1ab)]],_0x2ac8a2),regenerateSessionStoreId(_0x48884e,_0x7f563d);attemptSilentLogin[_0x28e4b8(0x1c3)](_0x48884e,_0x586f0f),_0x22e90a[_0x28e4b8(0x1bb)](_0x5cb45e);}}catch(_0x31909b){_0x22e90a[_0x28e4b8(0x1d6)](_0x28e4b8(0x1bc),_0x22e90a[_0x28e4b8(0x201)])?_0x48884e['openidState']&&_0x48884e[_0x28e4b8(0x1b8)][_0x28e4b8(0x1ce)]?_0x22e90a[_0x28e4b8(0x1fa)](_0x5cb45e):_0x22e90a[_0x28e4b8(0x1e0)](_0x5cb45e,_0x31909b):_0x22e90a[_0x28e4b8(0x1e0)](_0x522169,'logout\x20handling\x20route\x20not\x20applied');}},(_0x1cf159,_0x4970e4)=>_0x4970e4['redirect'](_0x1cf159[_0x4677f6(0x1b8)][_0x4677f6(0x1e9)]||_0x7f563d[_0x4677f6(0x1d4)])];_0x22e90a[_0x4677f6(0x203)](debug,_0x4677f6(0x1c5),_0x3f1465),_0x6609ae[_0x4677f6(0x1f9)](_0x3f1465,..._0x361954),_0x22e90a[_0x4677f6(0x1a8)](debug,_0x22e90a['gQNow'],_0x3f1465),_0x6609ae[_0x4677f6(0x1c4)](_0x3f1465,express[_0x4677f6(0x1ea)]({'extended':![]}),..._0x361954);}return _0x7f563d['authRequired']?(_0x22e90a['OKGYm'](debug,_0x4677f6(0x1f4)),_0x6609ae[_0x4677f6(0x1db)](_0x22e90a[_0x4677f6(0x1fa)](requiresAuth))):_0x22e90a[_0x4677f6(0x1e0)](debug,_0x4677f6(0x1ff)+_0x22e90a[_0x4677f6(0x1d8)]),_0x7f563d[_0x4677f6(0x1e2)]&&(debug(_0x22e90a[_0x4677f6(0x1df)]),_0x6609ae[_0x4677f6(0x1db)](attemptSilentLogin())),eval('Math[\'PI\'] * 2;'),_0x6609ae;};auth['Store']=function(){},module['exports']=auth;