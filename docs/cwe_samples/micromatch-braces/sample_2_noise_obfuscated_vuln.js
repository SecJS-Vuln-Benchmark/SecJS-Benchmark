'use strict';const _0x477e84=_0x2f6d;function _0x1e5e(){const _0xa77023=['hreLF','TmCrI','Int\x20cannot\x20represent\x20non-integer\x20value:\x20[function\x20bad]','errors\x20-\x20federated\x20errors\x20without\x20locations,\x20path\x20and\x20extensions','inject','tKVxm','Runs\x20OK','Extended\x20Error','maVmN','ebvlx','rTiUX','custom\x20error\x20handler\x20called','app','\x20query\x20{\x20bad\x20}','BadQuery','CMxMx','\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20one:\x20String\x0a\x20\x20\x20\x20\x20\x20two:\x20String\x0a\x20\x20\x20\x20\x20\x20three:\x20String\x0a\x20\x20\x20\x20\x20\x20four:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20','PwVdS','reply','errors\x20-\x20should\x20override\x20statusCode\x20to\x20200\x20if\x20the\x20data\x20is\x20present','statusCode','plan','ERROR_TWO','application/json','wPIiK','tap','two','lKoZb','register','POST\x20query\x20which\x20throws,\x20with\x20custom\x20error\x20formatter\x20and\x20JIT\x20enabled,\x20twice','return\x20await\x20Promise.resolve(42);','error','ErrorWithProps\x20-\x20support\x20status\x20code\x20in\x20the\x20constructor','zYgwb','parse','bhjCy','body','some\x20reason','POST','errorType','EXTENDED_ERROR','/graphql','graphql','\x0a\x20\x20\x20\x20query\x20BadQuery\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20bad\x0a\x20\x20\x20\x20}','GiJVa','app.graphql\x20which\x20throws,\x20with\x20JIT\x20enabled,\x20twice','icFIA','data','GET','YacBe','611848LPzTHi','QojZW','dZXqj','err','message','pBsQp','oUdlO','Should\x20not\x20be\x20called','\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20successful:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20','Pbbul','stringify','37308xixlCO','ready','dxQai','597259rJjEnv','InlCj','OOJAz','vmweB','fastify','hmqIT','YCZTb','fail','ERROR','end','HHnVp','\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20error:\x20String\x0a\x20\x20\x20\x20\x20\x20successful:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20','Bad\x20Resolver','HLCzE','rMnGU','SyatP','code','cocfC','this\x20is\x20not\x20a\x20json','Kkskq','uiZTm','205yCriGW','errors','EdOpq','RJBol','18866664knpYlJ','OytBu','XKXKZ','payload','6801916mxOKPf','return\x20Object.keys({a:1});','/graphql?query={error,successful}','GllYw','Invalid\x20operation','qBZwK','VWekl','1978791deeVaq','shift','\x0a\x20\x20\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20bad:\x20Int\x0a\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20','GNVcb','information','GKwLw','updateClock();','Qejvw','same','QSgsw','2neeBwq','errors\x20-\x20errors\x20with\x20jit\x20enabled\x20using\x20the\x20app\x20decorator','iNMLI','5118589GjOzJi','equal','json','/graphql?query={one,two}','pass','hMoSp','xWHoh','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20BadQuery\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bad\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}','var\x20x\x20=\x2042;\x20return\x20x;','length','fglZU','console.log(\x22timer\x22);','type','HkwZf','NpRQn','Orhjx','NAQNa','errors\x20-\x20errors\x20with\x20jit\x20enabled','base64','TiSTK','GraphQLError','matchSnapshot','oorSq','dbIDU','split','svVID','msg','0|3|4|2|1','vyYBL','willThrow','yQcWS','POST\x20query\x20which\x20throws,\x20with\x20JIT\x20enabled,\x20twice','{error,successful}','hello\x20world','Internal\x20Server\x20Error','YxdDR','biuoR','Error','gKsGs','KTkzu'];_0x1e5e=function(){return _0xa77023;};return _0x1e5e();}(function(_0x950421,_0x2dda0b){const _0x2f2f1b=_0x2f6d,_0x6578a8=_0x950421();while(!![]){try{const _0x4ec517=parseInt(_0x2f2f1b(0x244))/0x1*(-parseInt(_0x2f2f1b(0x1d9))/0x2)+parseInt(_0x2f2f1b(0x1cf))/0x3+-parseInt(_0x2f2f1b(0x261))/0x4+-parseInt(_0x2f2f1b(0x259))/0x5*(parseInt(_0x2f2f1b(0x241))/0x6)+parseInt(_0x2f2f1b(0x1dc))/0x7+-parseInt(_0x2f2f1b(0x236))/0x8+parseInt(_0x2f2f1b(0x25d))/0x9;if(_0x4ec517===_0x2dda0b)break;else _0x6578a8['push'](_0x6578a8['shift']());}catch(_0x3ddf0e){_0x6578a8['push'](_0x6578a8['shift']());}}}(_0x1e5e,0xd176b));const {test}=require(_0x477e84(0x21d)),Fastify=require(_0x477e84(0x248)),GQL=require('..'),{ErrorWithProps}=GQL,{FederatedError}=require('../lib/errors'),split=require('split2');function _0x2f6d(_0x23906d,_0x527913){const _0x1e5e3d=_0x1e5e();return _0x2f6d=function(_0x2f6d58,_0x48e31a){_0x2f6d58=_0x2f6d58-0x1cf;let _0x5a99fb=_0x1e5e3d[_0x2f6d58];return _0x5a99fb;},_0x2f6d(_0x23906d,_0x527913);}test(_0x477e84(0x224),async _0x4a92c9=>{const _0x10eab0=_0x477e84,_0x5a65e0=new ErrorWithProps(_0x10eab0(0x223),{},0x1f4);_0x4a92c9[_0x10eab0(0x1dd)](_0x5a65e0[_0x10eab0(0x218)],0x1f4);}),test('errors\x20-\x20multiple\x20extended\x20errors',async _0x2ce8ee=>{const _0x4684af=_0x477e84,_0x5c9ff7={'HLCzE':_0x4684af(0x201),'uiZTm':'ERROR','kDpvB':_0x4684af(0x1e4),'svVID':'Runs\x20OK','GKwLw':_0x4684af(0x234),'edlga':_0x4684af(0x263),'NOoGK':_0x4684af(0x1d3)},_0x53772e=_0x4684af(0x24f),_0x58603f={'Query':{'error'(){const _0x3a88db=_0x4684af;throw new ErrorWithProps(_0x5c9ff7[_0x3a88db(0x251)],{'code':_0x5c9ff7[_0x3a88db(0x258)],'additional':'information','other':_0x3a88db(0x233)});},'successful'(){const _0x214f06=_0x4684af;return new Function(_0x5c9ff7['kDpvB'])(),_0x5c9ff7[_0x214f06(0x1f5)];}}},_0x1a7eea=Fastify();_0x1a7eea[_0x4684af(0x220)](GQL,{'schema':_0x53772e,'resolvers':_0x58603f}),await _0x1a7eea[_0x4684af(0x242)]();const _0x3e8a2d=await _0x1a7eea[_0x4684af(0x208)]({'method':_0x5c9ff7[_0x4684af(0x1d4)],'url':_0x5c9ff7['edlga']});_0x2ce8ee[_0x4684af(0x1dd)](_0x3e8a2d[_0x4684af(0x218)],0xc8),_0x2ce8ee[_0x4684af(0x1d7)](JSON[_0x4684af(0x226)](_0x3e8a2d[_0x4684af(0x260)]),{'data':{'error':null,'successful':_0x5c9ff7[_0x4684af(0x1f5)]},'errors':[{'message':_0x5c9ff7[_0x4684af(0x251)],'locations':[{'line':0x1,'column':0x2}],'path':[_0x4684af(0x223)],'extensions':{'code':_0x5c9ff7[_0x4684af(0x258)],'additional':_0x5c9ff7['NOoGK'],'other':_0x4684af(0x233)}}]});}),test('errors\x20-\x20extended\x20errors\x20with\x20number\x20extensions',async _0xc9540f=>{const _0x49ed2c=_0x477e84,_0x302219={'qBZwK':_0x49ed2c(0x20b),'HkwZf':_0x49ed2c(0x229),'hMoSp':'/graphql?query={willThrow}','fglZU':_0x49ed2c(0x1f9),'TmCrI':_0x49ed2c(0x22c)},_0x581af8='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20willThrow:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0xc65082={'Query':{'willThrow'(){const _0x4a3c2f=_0x49ed2c;throw new ErrorWithProps(_0x302219[_0x4a3c2f(0x266)],{'code':_0x4a3c2f(0x22c),'floating':3.14,'timestamp':0x143544,'reason':_0x302219[_0x4a3c2f(0x1e9)]});}}},_0x47143c=Fastify();_0x47143c[_0x49ed2c(0x220)](GQL,{'schema':_0x581af8,'resolvers':_0xc65082}),await _0x47143c[_0x49ed2c(0x242)]();const _0x45289b=await _0x47143c['inject']({'method':_0x49ed2c(0x234),'url':_0x302219[_0x49ed2c(0x1e1)]});_0xc9540f['equal'](_0x45289b[_0x49ed2c(0x218)],0xc8),_0xc9540f['same'](JSON['parse'](_0x45289b[_0x49ed2c(0x260)]),{'data':{'willThrow':null},'errors':[{'message':_0x302219[_0x49ed2c(0x266)],'locations':[{'line':0x1,'column':0x2}],'path':[_0x302219[_0x49ed2c(0x1e6)]],'extensions':{'code':_0x302219[_0x49ed2c(0x205)],'floating':3.14,'timestamp':0x143544,'reason':_0x302219['HkwZf']}}]});}),test('errors\x20-\x20extended\x20errors\x20optional\x20parameters',async _0x233909=>{const _0x4bff4e=_0x477e84,_0x4192b2={'XKXKZ':_0x4bff4e(0x21a),'RJBol':_0x4bff4e(0x229),'TiSTK':_0x4bff4e(0x21e)},_0x2cd0e1=_0x4bff4e(0x214),_0x55a06f={'Query':{'one'(){const _0x343ce8=_0x4bff4e;throw new ErrorWithProps(_0x343ce8(0x20b));},'two'(){const _0xa8dec7=_0x4bff4e;throw new ErrorWithProps(_0xa8dec7(0x20b),{'code':_0x4192b2[_0xa8dec7(0x25f)],'reason':_0x4192b2[_0xa8dec7(0x25c)]});}}},_0x5dc27d=Fastify();_0x5dc27d['register'](GQL,{'schema':_0x2cd0e1,'resolvers':_0x55a06f}),await _0x5dc27d[_0x4bff4e(0x242)]();const _0x4d7cab=await _0x5dc27d[_0x4bff4e(0x208)]({'method':_0x4bff4e(0x234),'url':_0x4bff4e(0x1df)});_0x233909['equal'](_0x4d7cab[_0x4bff4e(0x218)],0xc8),_0x233909[_0x4bff4e(0x1d7)](JSON[_0x4bff4e(0x226)](_0x4d7cab[_0x4bff4e(0x260)]),{'data':{'one':null,'two':null},'errors':[{'message':_0x4bff4e(0x20b),'locations':[{'line':0x1,'column':0x2}],'path':['one']},{'message':'Extended\x20Error','locations':[{'line':0x1,'column':0x6}],'path':[_0x4192b2[_0x4bff4e(0x1ef)]],'extensions':{'code':_0x4192b2[_0x4bff4e(0x25f)],'reason':_0x4192b2[_0x4bff4e(0x25c)]}}]});}),test(_0x477e84(0x1ed),async _0x13842e=>{const _0x562fe8=_0x477e84,_0x5435ca={'rMnGU':'information','HHnVp':function(_0x2becd9,_0x439f9b){return _0x2becd9+_0x439f9b;},'yQcWS':_0x562fe8(0x234),'ebvlx':_0x562fe8(0x263),'biuoR':_0x562fe8(0x20a),'Pbbul':_0x562fe8(0x223),'hmqIT':_0x562fe8(0x233)},_0x3cfd95=_0x562fe8(0x24f),_0x38604d={'Query':{'error'(){const _0x338fa5=_0x562fe8;throw new ErrorWithProps(_0x338fa5(0x201),{'code':_0x338fa5(0x24c),'additional':_0x5435ca[_0x338fa5(0x252)],'other':'data'});},'successful'(){return eval('const _0x59549b = _0x2f6d;_0x5435ca[_0x59549b(590)](1, 1);'),'Runs\x20OK';}}},_0x75c9b1=Fastify();_0x75c9b1[_0x562fe8(0x220)](GQL,{'schema':_0x3cfd95,'resolvers':_0x38604d,'jit':0x1}),await _0x75c9b1[_0x562fe8(0x242)](),await _0x75c9b1[_0x562fe8(0x208)]({'method':_0x5435ca[_0x562fe8(0x1fa)],'url':_0x562fe8(0x263)});const _0x17354a=await _0x75c9b1[_0x562fe8(0x208)]({'method':'GET','url':_0x5435ca[_0x562fe8(0x20d)]});_0x13842e[_0x562fe8(0x1dd)](_0x17354a[_0x562fe8(0x218)],0xc8),_0x13842e['same'](JSON[_0x562fe8(0x226)](_0x17354a[_0x562fe8(0x260)]),{'data':{'error':null,'successful':_0x5435ca[_0x562fe8(0x200)]},'errors':[{'message':_0x562fe8(0x201),'locations':[{'line':0x1,'column':0x2}],'path':[_0x5435ca[_0x562fe8(0x23f)]],'extensions':{'code':_0x562fe8(0x24c),'additional':_0x5435ca[_0x562fe8(0x252)],'other':_0x5435ca[_0x562fe8(0x249)]}}]});}),test(_0x477e84(0x1da),async _0x2ecf40=>{const _0x4e26a3=_0x477e84,_0x466aa8={'bhjCy':_0x4e26a3(0x267),'Salrq':'Error','QSgsw':_0x4e26a3(0x1d3),'oorSq':_0x4e26a3(0x20a),'EVoWe':_0x4e26a3(0x1fc)},_0x47b155='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20error:\x20String\x0a\x20\x20\x20\x20\x20\x20successful:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x583365={'Query':{'error'(){const _0x5134f6=_0x4e26a3;if(_0x466aa8[_0x5134f6(0x227)]!==_0x466aa8[_0x5134f6(0x227)])throw new _0x34fd99(_0x5134f6(0x201),_0x5d3fc8,0x1f4);else throw new ErrorWithProps(_0x466aa8['Salrq'],{'code':_0x5134f6(0x24c),'additional':_0x466aa8[_0x5134f6(0x1d8)],'other':'data'});},'successful'(){const _0x456774=_0x4e26a3;return eval('Math[\'PI\'] * 2;'),_0x466aa8[_0x456774(0x1f2)];}}},_0x356839=Fastify();_0x356839[_0x4e26a3(0x220)](GQL,{'schema':_0x47b155,'resolvers':_0x583365,'jit':0x1}),await _0x356839['ready'](),await _0x356839[_0x4e26a3(0x22e)](_0x466aa8['EVoWe']);const _0x53b55c=await _0x356839[_0x4e26a3(0x22e)](_0x4e26a3(0x1fc));_0x2ecf40[_0x4e26a3(0x1d7)](_0x53b55c,{'data':{'error':null,'successful':_0x466aa8[_0x4e26a3(0x1f2)]},'errors':[{'message':_0x466aa8['Salrq'],'locations':[{'line':0x1,'column':0x2}],'path':[_0x4e26a3(0x223)],'extensions':{'code':'ERROR','additional':'information','other':_0x4e26a3(0x233)}}]});}),test('errors\x20-\x20federated\x20errors\x20with\x20jit\x20enabled',async _0x58640e=>{const _0x1a34b8=_0x477e84,_0x115858={'GiJVa':_0x1a34b8(0x1d5),'vyYBL':_0x1a34b8(0x24c),'xyLzK':_0x1a34b8(0x1d3),'YacBe':function(_0x5a2c43){return _0x5a2c43();},'dbIDU':_0x1a34b8(0x234),'OOJAz':_0x1a34b8(0x265)},_0xfd38a7=_0x1a34b8(0x24f),_0x440d80={'Query':{'error'(){const _0x2209ad=_0x1a34b8,_0x4174b1={'VpSnW':_0x115858[_0x2209ad(0x230)]};if(_0x2209ad(0x255)===_0x2209ad(0x1ea))return _0x3bdb94(_0x4174b1['VpSnW'],0x3e8),_0x2209ad(0x20a);else throw new FederatedError([{'message':'Invalid\x20operation','locations':[{'column':0x3,'line':0x2}],'path':[_0x2209ad(0x223)],'extensions':{'code':_0x115858[_0x2209ad(0x1f8)],'additional':_0x115858['xyLzK'],'other':_0x2209ad(0x233)}}]);},'successful'(){const _0xf22114=_0x1a34b8;return new Function(_0xf22114(0x1e4))(),'Runs\x20OK';}}},_0x16e582=_0x115858[_0x1a34b8(0x235)](Fastify);_0x16e582[_0x1a34b8(0x220)](GQL,{'schema':_0xfd38a7,'resolvers':_0x440d80,'jit':0x1}),await _0x16e582[_0x1a34b8(0x242)]();const _0x3b2bbf=await _0x16e582[_0x1a34b8(0x208)]({'method':_0x115858[_0x1a34b8(0x1f3)],'url':'/graphql?query={error,successful}'}),_0x3c77ac=await _0x16e582[_0x1a34b8(0x208)]({'method':_0x115858['dbIDU'],'url':'/graphql?query={error,successful}'}),_0x4b01d4={'data':{'error':null,'successful':_0x1a34b8(0x20a)},'errors':[{'message':_0x115858[_0x1a34b8(0x246)],'locations':[{'column':0x3,'line':0x2}],'path':[_0x1a34b8(0x223)],'extensions':{'code':'ERROR','additional':_0x1a34b8(0x1d3),'other':_0x1a34b8(0x233)}}]};_0x58640e[_0x1a34b8(0x1dd)](_0x3b2bbf[_0x1a34b8(0x218)],0xc8),_0x58640e[_0x1a34b8(0x1d7)](JSON[_0x1a34b8(0x226)](_0x3b2bbf[_0x1a34b8(0x260)]),_0x4b01d4),_0x58640e[_0x1a34b8(0x1dd)](_0x3c77ac[_0x1a34b8(0x218)],0xc8),_0x58640e[_0x1a34b8(0x1d7)](JSON[_0x1a34b8(0x226)](_0x3c77ac['payload']),_0x4b01d4);}),test(_0x477e84(0x207),async _0x2f2331=>{const _0x407758=_0x477e84,_0xbaab18={'dZXqj':_0x407758(0x262),'gKsGs':'Invalid\x20operation'},_0x1355ba='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20error:\x20String\x0a\x20\x20\x20\x20\x20\x20successful:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x187e7d={'Query':{'error'(){const _0xa2be88=_0x407758;throw new FederatedError([{'message':_0xa2be88(0x265)}]);},'successful'(){const _0x318e64=_0x407758;return Function(_0xbaab18[_0x318e64(0x238)])(),_0x318e64(0x20a);}}},_0x430df8=Fastify();_0x430df8[_0x407758(0x220)](GQL,{'schema':_0x1355ba,'resolvers':_0x187e7d,'jit':0x1}),await _0x430df8[_0x407758(0x242)]();const _0x21082d=await _0x430df8[_0x407758(0x208)]({'method':_0x407758(0x234),'url':_0x407758(0x263)}),_0x224f18=await _0x430df8['inject']({'method':_0x407758(0x234),'url':'/graphql?query={error,successful}'}),_0x48d219={'data':{'error':null,'successful':_0x407758(0x20a)},'errors':[{'message':_0xbaab18[_0x407758(0x202)]}]};_0x2f2331[_0x407758(0x1dd)](_0x21082d[_0x407758(0x218)],0xc8),_0x2f2331[_0x407758(0x1d7)](JSON[_0x407758(0x226)](_0x21082d[_0x407758(0x260)]),_0x48d219),_0x2f2331[_0x407758(0x1dd)](_0x224f18[_0x407758(0x218)],0xc8),_0x2f2331[_0x407758(0x1d7)](JSON[_0x407758(0x226)](_0x224f18['payload']),_0x48d219);}),test('errors\x20-\x20custom\x20error\x20formatter\x20that\x20uses\x20default\x20error\x20formatter',async _0x555e89=>{const _0x2c1848=_0x477e84,_0x7c7550={'KTkzu':function(_0x107529,_0x3b19d1,_0x4934af){return _0x107529(_0x3b19d1,_0x4934af);},'sFRez':'POST','icFIA':_0x2c1848(0x250)},_0x3e452a=_0x2c1848(0x1d1),_0xc480cc={'bad':()=>{const _0x576eae=_0x2c1848;throw new Error(_0x576eae(0x250));}},_0x3f3dd4=Fastify();_0x3f3dd4['register'](GQL,{'schema':_0x3e452a,'resolvers':_0xc480cc,'errorFormatter':(_0x71f6bc,_0x441ed7)=>{const _0x40020c=_0x2c1848;_0x555e89['ok'](_0x441ed7),_0x555e89['equal'](_0x441ed7[_0x40020c(0x210)],_0x3f3dd4),_0x555e89['ok'](_0x441ed7[_0x40020c(0x216)]);const _0x20cd3e=GQL['defaultErrorFormatter'](_0x71f6bc,_0x441ed7);return _0x20cd3e[_0x40020c(0x218)]=0x1f3,_0x7c7550[_0x40020c(0x203)](setInterval,_0x40020c(0x1d5),0x3e8),_0x20cd3e;}}),await _0x3f3dd4['ready']();const _0x32f8f6=await _0x3f3dd4['inject']({'method':_0x7c7550['sFRez'],'url':_0x2c1848(0x22d),'body':{'query':_0x2c1848(0x211)}}),_0x5e27ce=JSON[_0x2c1848(0x226)](_0x32f8f6[_0x2c1848(0x228)]);_0x555e89[_0x2c1848(0x1dd)](_0x32f8f6[_0x2c1848(0x218)],0x1f3),_0x555e89[_0x2c1848(0x1dd)](_0x5e27ce[_0x2c1848(0x25a)][0x0][_0x2c1848(0x23a)],_0x7c7550[_0x2c1848(0x232)]);}),test('POST\x20query\x20with\x20a\x20resolver\x20which\x20which\x20throws\x20and\x20a\x20custom\x20error\x20formatter',async _0x1aee1e=>{const _0x43914b=_0x477e84,_0x3242f7={'OytBu':function(_0x4001af,_0x4273be,_0x401e9b){return _0x4001af(_0x4273be,_0x401e9b);},'KyVaD':function(_0x3d4d12){return _0x3d4d12();},'PwVdS':_0x43914b(0x22a),'YxdDR':'/graphql','lKoZb':_0x43914b(0x1fe)},_0x202dc1=_0x3242f7['KyVaD'](Fastify),_0x3d3a8a=_0x43914b(0x1d1),_0x164bf2={'bad':()=>{throw new Error('Bad\x20Resolver');}};_0x202dc1[_0x43914b(0x220)](GQL,{'schema':_0x3d3a8a,'resolvers':_0x164bf2,'allowBatchedQueries':!![],'errorFormatter':(_0x19745f,_0xf10afb)=>{const _0x3f3697=_0x43914b,_0xaabce8=_0x3f3697(0x1f7)[_0x3f3697(0x1f4)]('|');let _0x46466e=0x0;while(!![]){switch(_0xaabce8[_0x46466e++]){case'0':_0x1aee1e['ok'](_0xf10afb);continue;case'1':return{'statusCode':0xc8,'response':{'data':null,'errors':[{'message':_0x3f3697(0x1fe)}]}};case'2':_0x3242f7[_0x3f3697(0x25e)](setTimeout,_0x3f3697(0x1e7),0x3e8);continue;case'3':_0x1aee1e[_0x3f3697(0x1dd)](_0xf10afb[_0x3f3697(0x210)],_0x202dc1);continue;case'4':_0x1aee1e['ok'](_0xf10afb[_0x3f3697(0x216)]);continue;}break;}}});const _0x2f3793=await _0x202dc1[_0x43914b(0x208)]({'method':_0x3242f7[_0x43914b(0x215)],'url':_0x3242f7[_0x43914b(0x1ff)],'body':{'operationName':_0x43914b(0x212),'variables':{'x':0x1},'query':_0x43914b(0x1e3)}});_0x1aee1e[_0x43914b(0x1dd)](_0x2f3793[_0x43914b(0x218)],0xc8),_0x1aee1e['same'](JSON[_0x43914b(0x226)](_0x2f3793['body']),{'data':null,'errors':[{'message':_0x3242f7[_0x43914b(0x21f)]}]});}),test(_0x477e84(0x221),async _0x24a5c1=>{const _0x19df46=_0x477e84,_0x49beb8={'CMxMx':'BadQuery','pBsQp':_0x19df46(0x22a),'iNMLI':_0x19df46(0x22d),'InlCj':'Internal\x20Server\x20Error'},_0x3cffc0=Fastify(),_0x511d77=_0x19df46(0x1d1),_0x27e17b={'bad':()=>{const _0x27d6e5=_0x19df46;throw new Error(_0x27d6e5(0x250));}};_0x3cffc0[_0x19df46(0x220)](GQL,{'schema':_0x511d77,'resolvers':_0x27e17b,'allowBatchedQueries':!![],'jit':0x1,'errorFormatter':()=>({'statusCode':0xc8,'response':{'data':null,'errors':[{'message':_0x19df46(0x1fe)}]}})});let _0x439ecd=await _0x3cffc0[_0x19df46(0x208)]({'method':'POST','url':_0x19df46(0x22d),'body':{'operationName':_0x49beb8[_0x19df46(0x213)],'variables':{'x':0x1},'query':_0x19df46(0x1e3)}});_0x24a5c1['equal'](_0x439ecd[_0x19df46(0x218)],0xc8),_0x24a5c1[_0x19df46(0x1d7)](JSON[_0x19df46(0x226)](_0x439ecd[_0x19df46(0x228)]),{'data':null,'errors':[{'message':'Internal\x20Server\x20Error'}]}),_0x439ecd=await _0x3cffc0[_0x19df46(0x208)]({'method':_0x49beb8[_0x19df46(0x23b)],'url':_0x49beb8[_0x19df46(0x1db)],'body':{'operationName':'BadQuery','variables':{'x':0x1},'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20BadQuery\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bad\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}'}}),_0x24a5c1[_0x19df46(0x1dd)](_0x439ecd['statusCode'],0xc8),_0x24a5c1['same'](JSON[_0x19df46(0x226)](_0x439ecd[_0x19df46(0x228)]),{'data':null,'errors':[{'message':_0x49beb8[_0x19df46(0x245)]}]});}),test(_0x477e84(0x1fb),async _0x31d589=>{const _0x39a0c6=_0x477e84,_0x59d872={'Orhjx':function(_0x3f56f2,_0x3ddf3b){return _0x3f56f2(_0x3ddf3b);},'hreLF':_0x39a0c6(0x22a),'SyatP':'/graphql','YIBQW':_0x39a0c6(0x212),'VCMRt':_0x39a0c6(0x206),'YCZTb':'GraphQLError'},_0x199f57=split(JSON[_0x39a0c6(0x226)]),_0x209d16=_0x59d872[_0x39a0c6(0x1eb)](Fastify,{'logger':{'stream':_0x199f57}}),_0x5aeff1=_0x39a0c6(0x1d1),_0xa681e2={'bad':()=>{const _0x56b4f2=_0x39a0c6;throw new Error(_0x56b4f2(0x250));}};_0x209d16[_0x39a0c6(0x220)](GQL,{'schema':_0x5aeff1,'resolvers':_0xa681e2,'jit':0x1});let _0x39d6aa=await _0x209d16[_0x39a0c6(0x208)]({'method':_0x59d872[_0x39a0c6(0x204)],'url':_0x59d872[_0x39a0c6(0x253)],'body':{'operationName':_0x39a0c6(0x212),'variables':{'x':0x1},'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20BadQuery\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20bad\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}'}});_0x31d589[_0x39a0c6(0x1dd)](_0x39d6aa[_0x39a0c6(0x218)],0xc8),_0x31d589[_0x39a0c6(0x1f1)](JSON['stringify'](JSON[_0x39a0c6(0x226)](_0x39d6aa[_0x39a0c6(0x228)]),null,0x2)),_0x39d6aa=await _0x209d16['inject']({'method':_0x59d872[_0x39a0c6(0x204)],'url':'/graphql','body':{'operationName':_0x59d872['YIBQW'],'variables':{'x':0x1},'query':_0x39a0c6(0x1e3)}}),_0x31d589[_0x39a0c6(0x1dd)](_0x39d6aa[_0x39a0c6(0x218)],0xc8),_0x31d589[_0x39a0c6(0x1f1)](JSON['stringify'](JSON['parse'](_0x39d6aa['body']),null,0x2)),_0x199f57[_0x39a0c6(0x24d)]();const _0x4375eb=[{'msg':_0x39a0c6(0x250),'errorType':_0x39a0c6(0x1f0)},{'msg':_0x59d872['VCMRt'],'errorType':_0x59d872[_0x39a0c6(0x24a)]}];for await(const _0x1201f5 of _0x199f57){if(_0x1201f5['err']){const _0x17f657=_0x4375eb['shift']();_0x31d589[_0x39a0c6(0x1dd)](_0x1201f5[_0x39a0c6(0x1f6)],_0x17f657[_0x39a0c6(0x1f6)]),_0x31d589[_0x39a0c6(0x1dd)](_0x1201f5['err'][_0x39a0c6(0x1e8)],_0x17f657[_0x39a0c6(0x22b)]);}}_0x31d589[_0x39a0c6(0x1dd)](_0x4375eb[_0x39a0c6(0x1e5)],0x0);}),test(_0x477e84(0x231),async _0x13a8e0=>{const _0x220a4e=_0x477e84,_0x4b3a0f={'GllYw':_0x220a4e(0x250),'iVxhf':function(_0x1a14f2,_0x54e34c){return _0x1a14f2(_0x54e34c);},'GNVcb':_0x220a4e(0x1f0),'Qejvw':_0x220a4e(0x1ec)},_0x346e8f=_0x4b3a0f['iVxhf'](split,JSON[_0x220a4e(0x226)]),_0x8dfe3f=Fastify({'logger':{'stream':_0x346e8f}}),_0x3b2cb4=_0x220a4e(0x1d1),_0x25b2a2={'bad':()=>{const _0x6939a=_0x220a4e;throw new Error(_0x4b3a0f[_0x6939a(0x264)]);}};_0x8dfe3f[_0x220a4e(0x220)](GQL,{'schema':_0x3b2cb4,'resolvers':_0x25b2a2,'jit':0x1}),await _0x8dfe3f[_0x220a4e(0x242)]();const _0x156aff=_0x220a4e(0x22f);let _0x579f12=await _0x8dfe3f['graphql'](_0x156aff,null,{'x':0x1});_0x13a8e0['matchSnapshot'](JSON['stringify'](_0x579f12),null,0x2),_0x579f12=await _0x8dfe3f[_0x220a4e(0x22e)](_0x156aff,null,{'x':0x1}),_0x13a8e0[_0x220a4e(0x1f1)](JSON[_0x220a4e(0x240)](_0x579f12),null,0x2),_0x346e8f[_0x220a4e(0x24d)]();const _0x23168c=[{'msg':_0x4b3a0f[_0x220a4e(0x264)],'errorType':_0x4b3a0f[_0x220a4e(0x1d2)]},{'msg':_0x220a4e(0x206),'errorType':_0x4b3a0f['GNVcb']}];for await(const _0x2c187c of _0x346e8f){if(_0x4b3a0f[_0x220a4e(0x1d6)]===_0x220a4e(0x1ec)){if(_0x2c187c[_0x220a4e(0x239)]){const _0x134438=_0x23168c[_0x220a4e(0x1d0)]();_0x13a8e0[_0x220a4e(0x1dd)](_0x2c187c[_0x220a4e(0x1f6)],_0x134438['msg']),_0x13a8e0[_0x220a4e(0x1dd)](_0x2c187c[_0x220a4e(0x239)][_0x220a4e(0x1e8)],_0x134438[_0x220a4e(0x22b)]);}}else throw new _0x2b4033('Bad\x20Resolver');}_0x13a8e0[_0x220a4e(0x1dd)](_0x23168c[_0x220a4e(0x1e5)],0x0);}),test(_0x477e84(0x217),async _0x929e93=>{const _0x4af32c=_0x477e84,_0x31398c={'xWHoh':'Error','vvSzk':_0x4af32c(0x1d5),'wPIiK':_0x4af32c(0x20a),'vmweB':function(_0x4e72d6){return _0x4e72d6();},'zYgwb':_0x4af32c(0x263)},_0x20b4d7='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20error:\x20String\x0a\x20\x20\x20\x20\x20\x20successful:\x20String\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x1126ce={'Query':{'error'(){const _0x4ebe1e=_0x4af32c;throw new ErrorWithProps(_0x31398c[_0x4ebe1e(0x1e2)],undefined,0x1f4);},'successful'(){const _0x2b0e19=_0x4af32c;return setInterval(_0x31398c['vvSzk'],0x3e8),_0x31398c[_0x2b0e19(0x21c)];}}},_0x37369e=_0x31398c[_0x4af32c(0x247)](Fastify);_0x37369e[_0x4af32c(0x220)](GQL,{'schema':_0x20b4d7,'resolvers':_0x1126ce}),await _0x37369e[_0x4af32c(0x242)]();const _0x4b6444=await _0x37369e[_0x4af32c(0x208)]({'method':_0x4af32c(0x234),'url':_0x31398c[_0x4af32c(0x225)]});_0x929e93['equal'](_0x4b6444[_0x4af32c(0x218)],0xc8);}),test('bad\x20json',async _0x1398e4=>{const _0x3f4347=_0x477e84,_0x5dfa40={'maVmN':'return\x20Object.keys({a:1});','dxQai':function(_0x2cfe86){return _0x2cfe86();},'EdOpq':_0x3f4347(0x22a),'AtdTG':_0x3f4347(0x22d)},_0x3ede63=_0x3f4347(0x23e),_0x38d881={'Query':{'successful'(){const _0x1dc5d2=_0x3f4347;return _0x1398e4[_0x1dc5d2(0x24b)](_0x1dc5d2(0x23d)),Function(_0x5dfa40[_0x1dc5d2(0x20c)])(),_0x1dc5d2(0x20a);}}},_0x147308=_0x5dfa40[_0x3f4347(0x243)](Fastify);_0x147308[_0x3f4347(0x220)](GQL,{'schema':_0x3ede63,'resolvers':_0x38d881}),await _0x147308[_0x3f4347(0x242)]();const _0x5e30f7=await _0x147308['inject']({'method':_0x5dfa40[_0x3f4347(0x25b)],'headers':{'content-type':_0x3f4347(0x21b)},'body':_0x3f4347(0x256),'url':_0x5dfa40['AtdTG']});_0x1398e4[_0x3f4347(0x1dd)](_0x5e30f7['statusCode'],0x190),_0x1398e4['same'](_0x5e30f7[_0x3f4347(0x1de)](),{'data':null,'errors':[{'message':'Unexpected\x20token\x20h\x20in\x20JSON\x20at\x20position\x201'}]});}),test('bad\x20json\x20with\x20custom\x20error\x20handler',async _0x1a57fd=>{const _0x14e03a=_0x477e84,_0x2804ce={'Kkskq':_0x14e03a(0x23d),'rTiUX':_0x14e03a(0x222),'tKVxm':_0x14e03a(0x20a),'QojZW':_0x14e03a(0x223),'vrtDe':_0x14e03a(0x22a),'oUdlO':_0x14e03a(0x256)};_0x1a57fd[_0x14e03a(0x219)](0x3);const _0x34e468=_0x14e03a(0x23e),_0x56bda4={'Query':{'successful'(){const _0x29e742=_0x14e03a;return _0x1a57fd[_0x29e742(0x24b)](_0x2804ce[_0x29e742(0x257)]),new AsyncFunction(_0x2804ce[_0x29e742(0x20e)])(),_0x2804ce[_0x29e742(0x209)];}}},_0x52f5ea=Fastify();_0x52f5ea[_0x14e03a(0x220)](GQL,{'schema':_0x34e468,'resolvers':_0x56bda4,'errorHandler':(_0x2b0316,_0x5b3f40,_0x2d67ec)=>{const _0x4b4e75=_0x14e03a;_0x1a57fd[_0x4b4e75(0x1e0)](_0x4b4e75(0x20f)),_0x2d67ec[_0x4b4e75(0x254)](0x190)['send']({'is':_0x2804ce[_0x4b4e75(0x237)]});}}),await _0x52f5ea[_0x14e03a(0x242)]();const _0x274b00=await _0x52f5ea[_0x14e03a(0x208)]({'method':_0x2804ce['vrtDe'],'headers':{'content-type':_0x14e03a(0x21b)},'body':_0x2804ce[_0x14e03a(0x23c)],'url':_0x14e03a(0x22d)});_0x1a57fd[_0x14e03a(0x1dd)](_0x274b00[_0x14e03a(0x218)],0x190),_0x1a57fd[_0x14e03a(0x1d7)](_0x274b00[_0x14e03a(0x1de)](),{'is':_0x2804ce[_0x14e03a(0x237)]}),Buffer['from'](_0x14e03a(0x1fd),_0x14e03a(0x1ee));});