const _0x4f1659=_0xc8b3;function _0xc8b3(_0x17fe0b,_0x122dfb){const _0x44e9ff=_0x44e9();return _0xc8b3=function(_0xc8b34e,_0xe0a59e){_0xc8b34e=_0xc8b34e-0x1bb;let _0x533b11=_0x44e9ff[_0xc8b34e];return _0x533b11;},_0xc8b3(_0x17fe0b,_0x122dfb);}(function(_0x59c69e,_0x222518){const _0x4fd094=_0xc8b3,_0x5ad57b=_0x59c69e();while(!![]){try{const _0x13683e=-parseInt(_0x4fd094(0x20e))/0x1+-parseInt(_0x4fd094(0x1d3))/0x2*(-parseInt(_0x4fd094(0x1be))/0x3)+-parseInt(_0x4fd094(0x1fe))/0x4*(-parseInt(_0x4fd094(0x20a))/0x5)+-parseInt(_0x4fd094(0x215))/0x6+-parseInt(_0x4fd094(0x1de))/0x7+-parseInt(_0x4fd094(0x1ce))/0x8+parseInt(_0x4fd094(0x1d7))/0x9;if(_0x13683e===_0x222518)break;else _0x5ad57b['push'](_0x5ad57b['shift']());}catch(_0x1a3381){_0x5ad57b['push'](_0x5ad57b['shift']());}}}(_0x44e9,0x63f57));import{describe,it,expect}from'vitest';function _0x44e9(){const _0x15eb04=['aBQFI','FvMzZ','https://example.com?empty&hasvalue=test','ZwXbC','ugbjS','malformed\x20or\x20suspicious\x20URLs','CNsKp','https://example.com/?empty&hasvalue=test','https://subdomain.example.com/page?param=value#section','OKtiB','gfdct','should\x20encode\x20hash\x20fragments','tQSgI','toThrow','ftp://example.com/test','forEach','http://example.com/','http://user%24(calc)r:pass%24(calc)word@domain.com/','YXuxo','ZZWhI','javascript:eval(\x22malicious\x20code\x22)','https://www.example.com:$(calc.exe)/foo','InmJE','should\x20encode\x20special\x20characters\x20in\x20pathname','tBnlc','GdlGr','bNjHM','157371aTcxvI','https://example.com/#%24(calc)','AFEcO','should\x20allow\x20valid\x20URLs','ZJJBc','http://localhost:3000/api','lqbUi','rAzpp','IGZcs','should\x20reject\x20URLs\x20with\x20spaces\x20in\x20hostname','CzqIe','xIgTG','should\x20properly\x20encode\x20URL\x20components','eeRqk','IZiSs','https://user:pass@example.com/secure','5213008qKKwyF','https://www.google.com/','dKXMc','toBe','ZFYZT','10AGllzV','ppydU','https://api.github.com/users/octocat','file://c:/windows/system32/calc.exe','7923087XkdoLs','qIqWT','should\x20handle\x20URLs\x20with\x20command\x20injection\x20attempts\x20in\x20path','Invalid\x20url\x20to\x20pass\x20to\x20open()','RJVuU','https://127.0.0.1:8080/','should\x20handle\x20minimal\x20URLs','3877839ijUtfh','http://a.com','HqzPo','https://example.com/?param=%24(calc.exe)','bkuGC','data:text/html,<script>alert(\x22XSS\x22)</script>','https://example.com/$(calc.exe)','XGKhE','should\x20encode\x20query\x20parameters','AGfgL','should\x20reject\x20malicious\x20hosts','https://example.com?key=value\x20with\x20spaces&another=test','should\x20handle\x20URLs\x20with\x20suspicious\x20query\x20parameters','should\x20handle\x20URL\x20with\x20all\x20components','sanitizeUrl','http://example.com','http://user$(calc)r:pass$(calc)word@domain.com','https://www.google.com','XCDLG','should\x20reject\x20invalid\x20protocols','heRTw','https://example.com#$(calc)','dSWKA','should\x20handle\x20URLs\x20with\x20authentication\x20info','WXUil','http://test.com/path/to/resource','javascript:alert(\x22XSS\x22)','ssh://test.com/whoami','aYUUy','rsAKt','FhPLI','lPpuk','28CdxGnD','ZZWhH','hTxGW','WWpbC','https://user:pass@example.com:8080/path/to/resource?param=value&other=test#fragment','JLPFk','iwTnD','should\x20reject:\x20','cAGIh','https://api.example.com/v1/users?limit=10&offset=0#results','hhGXx','should\x20preserve\x20valid\x20URL\x20structure','557585qYxpNp','AjzMn','PJAYJ','GvtHI','181029fQzwyk','https://exam\x20ple.com','should\x20encode\x20basic\x20auth','javascript:$(cmd\x20/c\x20whoami\x20>\x20c:\x5ctemp\x5cpwned.txt)','http://www.a.com/%24(calc.exe)','XXNBh','gOoOj','763104uWuuMD','epnMW','https://127.0.0.1:8080','https://example.com/#section%2520with%2520spaces','brBXE','http://localhost:3000/','ajPOQ','https://example.com/%24(calc.exe)','https://example.com/path%2520with%2520spaces','LQpnn','XUVxM','should\x20handle\x20URLs\x20with\x20suspicious\x20fragments'];_0x44e9=function(){return _0x15eb04;};return _0x44e9();}import{sanitizeUrl}from'./utils';describe(_0x4f1659(0x1ec),()=>{const _0x23c61a=_0x4f1659,_0x11c187={'vYgIY':_0x23c61a(0x1ef),'XUVxM':_0x23c61a(0x1f7),'rmCVr':_0x23c61a(0x1d5),'cAGIh':_0x23c61a(0x229),'Dsddv':'http://localhost:3000','XXNBh':_0x23c61a(0x217),'rsAKt':function(_0x184d5e,_0x16e258){return _0x184d5e(_0x16e258);},'gifEe':_0x23c61a(0x232),'PJAYJ':'telnet://malicious.com/dir','qIqWT':'file://localhost/etc/passwd','eUQIb':_0x23c61a(0x1d6),'DnNYy':_0x23c61a(0x1f8),'dSWKA':_0x23c61a(0x211),'CzqIe':'https://www.$(calc.exe).com/foo','ZFYZT':function(_0x68c4b1,_0x3dc7c4){return _0x68c4b1!==_0x3dc7c4;},'ajPOQ':'cMbNA','AGfgL':function(_0x397e4c,_0x4eff3d){return _0x397e4c(_0x4eff3d);},'RJVuU':function(_0x29cfd0,_0x510d01){return _0x29cfd0(_0x510d01);},'WCqCC':_0x23c61a(0x228),'dKXMc':function(_0x13cf4e,_0x5ca5e9,_0x33965e){return _0x13cf4e(_0x5ca5e9,_0x33965e);},'ohqWB':_0x23c61a(0x1c7),'WXUil':_0x23c61a(0x238),'tBnlc':function(_0x501792,_0x324645,_0x149999){return _0x501792(_0x324645,_0x149999);},'iwTnD':_0x23c61a(0x1e6),'qxqgQ':_0x23c61a(0x22c),'ZZWhH':_0x23c61a(0x210),'XIAvm':_0x23c61a(0x207),'ZwXbC':function(_0x479564,_0xb32184){return _0x479564(_0xb32184);},'XugIO':_0x23c61a(0x1eb),'FvMzZ':function(_0x24571c,_0x353d11){return _0x24571c(_0x353d11);},'fDxrp':function(_0x44fd6e,_0x32b975){return _0x44fd6e(_0x32b975);},'fvGvI':function(_0x1f9a0d,_0x21f445){return _0x1f9a0d(_0x21f445);},'CNsKp':_0x23c61a(0x1df),'FhPLI':_0x23c61a(0x208),'XCDLG':function(_0x586340,_0x3aa417,_0x11b279){return _0x586340(_0x3aa417,_0x11b279);},'AjzMn':_0x23c61a(0x1f5),'HqzPo':function(_0x3ca585,_0x30c418,_0x13646c){return _0x3ca585(_0x30c418,_0x13646c);},'WWpbC':_0x23c61a(0x1e1),'AFEcO':_0x23c61a(0x1f3),'OKtiB':_0x23c61a(0x1bf),'heRTw':_0x23c61a(0x1e4),'JLPFk':_0x23c61a(0x1ea),'LQpnn':_0x23c61a(0x220),'GdlGr':_0x23c61a(0x1c1),'piWuF':_0x23c61a(0x1f1),'lqbUi':function(_0xa3d3f9,_0x411735,_0x2ca489){return _0xa3d3f9(_0x411735,_0x2ca489);},'XVfVO':_0x23c61a(0x1e8),'FeOPh':_0x23c61a(0x1ca),'aBQFI':'should\x20handle\x20complex\x20URLs'};describe(_0x11c187[_0x23c61a(0x1bc)],()=>{const _0x16085f=_0x23c61a,_0x39248f={'gOoOj':function(_0x9eec33,_0x1e4d27,_0x2a42b9){return _0x9eec33(_0x1e4d27,_0x2a42b9);}},_0xecbd5c=[{'input':_0x16085f(0x1ed),'expected':_0x16085f(0x231)},{'input':_0x11c187['vYgIY'],'expected':_0x16085f(0x1cf)},{'input':_0x16085f(0x1f7),'expected':_0x11c187[_0x16085f(0x21f)]},{'input':_0x11c187['rmCVr'],'expected':_0x16085f(0x1d5)},{'input':_0x11c187['cAGIh'],'expected':_0x11c187[_0x16085f(0x206)]},{'input':_0x11c187['Dsddv'],'expected':_0x16085f(0x21a)},{'input':_0x11c187[_0x16085f(0x213)],'expected':_0x16085f(0x1dc)}];_0xecbd5c['forEach'](({input:_0x40c78e,expected:_0x33309})=>{const _0x35e846=_0x16085f,_0x8400ab={'lfXbD':function(_0x27f594,_0x4e220f){return _0x27f594(_0x4e220f);}};_0x39248f[_0x35e846(0x214)](it,'should\x20sanitize:\x20'+_0x40c78e,()=>{const _0x3284a2=_0x35e846,_0x5d4aa6=sanitizeUrl(_0x40c78e);_0x8400ab['lfXbD'](expect,_0x5d4aa6)[_0x3284a2(0x1d1)](_0x33309);});});}),describe(_0x11c187['piWuF'],()=>{const _0x57da69=_0x23c61a,_0x43bcab={'brBXE':function(_0x42886c,_0x513c39){const _0x433af1=_0xc8b3;return _0x11c187[_0x433af1(0x1fb)](_0x42886c,_0x513c39);},'rAzpp':_0x11c187['gifEe'],'ZJJBc':function(_0x24cc07,_0x2b329d,_0x45721d){return _0x24cc07(_0x2b329d,_0x45721d);}},_0x396385=[_0x57da69(0x22f),_0x57da69(0x1f9),_0x11c187[_0x57da69(0x20c)],'file:///C:/Windows/System32/calc.exe',_0x11c187[_0x57da69(0x1d8)],_0x11c187['eUQIb'],_0x11c187['DnNYy'],_0x57da69(0x235),'javascript:$(calc.exe)?response_type=code.....',_0x11c187[_0x57da69(0x1f4)],_0x57da69(0x1e3)];_0x396385[_0x57da69(0x230)](_0x402354=>{const _0x8bcf0=_0x57da69,_0x35456d={'YWRtX':function(_0x52bc71,_0x51d3ed){const _0x3b9809=_0xc8b3;return _0x43bcab[_0x3b9809(0x219)](_0x52bc71,_0x51d3ed);},'GvtHI':'http://user$(calc)r:pass$(calc)word@domain.com','hTxGW':_0x43bcab[_0x8bcf0(0x1c5)],'eeRqk':function(_0x14f4eb,_0x3e80da){return _0x14f4eb===_0x3e80da;},'XGKhE':function(_0x484618,_0x5adb8f){return _0x484618(_0x5adb8f);}};_0x43bcab[_0x8bcf0(0x1c2)](it,_0x8bcf0(0x205)+_0x402354,()=>{const _0x1d8d94=_0x8bcf0;if(_0x35456d[_0x1d8d94(0x1cb)]('HrSEN',_0x1d8d94(0x237))){const _0x2c6438=_0x35456d['YWRtX'](_0x2742df,_0x35456d[_0x1d8d94(0x20d)]);_0x35456d['YWRtX'](_0x8e9f3f,_0x2c6438)[_0x1d8d94(0x1d1)](_0x35456d[_0x1d8d94(0x200)]);}else _0x35456d[_0x1d8d94(0x1e5)](expect,()=>sanitizeUrl(_0x402354))[_0x1d8d94(0x22e)](_0x1d8d94(0x1da));});});}),_0x11c187[_0x23c61a(0x1c4)](describe,_0x11c187['XVfVO'],()=>{const _0x1e14aa=_0x23c61a,_0x368c05={'epnMW':function(_0x53c7b2,_0x19b8b1){return _0x53c7b2(_0x19b8b1);},'lPpuk':function(_0x39db0c,_0xe05a39,_0x2dd1e7){return _0x39db0c(_0xe05a39,_0x2dd1e7);}},_0x3a0fbb=[_0x11c187[_0x1e14aa(0x1c8)],_0x1e14aa(0x236)];_0x3a0fbb[_0x1e14aa(0x230)](_0x5e5615=>{const _0x278a62=_0x1e14aa,_0x5aec7e={'bkuGC':function(_0x51036a,_0x53fc4a){const _0x59c649=_0xc8b3;return _0x368c05[_0x59c649(0x216)](_0x51036a,_0x53fc4a);},'MKhmM':_0x278a62(0x1da)};_0x368c05[_0x278a62(0x1fd)](it,_0x278a62(0x205)+_0x5e5615,()=>{const _0x272bb1=_0x278a62;_0x5aec7e[_0x272bb1(0x1e2)](expect,()=>sanitizeUrl(_0x5e5615))['toThrow'](_0x5aec7e['MKhmM']);});});}),describe(_0x11c187['FeOPh'],()=>{const _0x3510c2=_0x23c61a,_0x42fcdb={'IGZcs':function(_0x26e174,_0x9e12){const _0x576915=_0xc8b3;return _0x11c187[_0x576915(0x1db)](_0x26e174,_0x9e12);},'gfdct':_0x3510c2(0x1e9),'YXuxo':'https://example.com/?key=value%20with%20spaces&another=test','dqysv':function(_0x4f35e0,_0xd0b2e8,_0x452c3b){return _0x4f35e0(_0xd0b2e8,_0x452c3b);},'bNjHM':_0x3510c2(0x223),'mtxSz':_0x11c187['WCqCC']};_0x11c187[_0x3510c2(0x1d0)](it,_0x11c187['ohqWB'],()=>{const _0x4b3000=_0x3510c2;_0x11c187[_0x4b3000(0x1fb)](expect,()=>sanitizeUrl(_0x4b3000(0x20f)))[_0x4b3000(0x22e)]();}),_0x11c187[_0x3510c2(0x1d0)](it,_0x11c187[_0x3510c2(0x1f6)],()=>{const _0x47ef26=_0x3510c2,_0x301078=_0x42fcdb[_0x47ef26(0x1c6)](sanitizeUrl,'https://example.com/path\x20with\x20spaces');expect(_0x301078)['toBe'](_0x47ef26(0x21d));}),_0x11c187[_0x3510c2(0x1bb)](it,_0x11c187[_0x3510c2(0x204)],()=>{const _0x41f75c=_0x3510c2,_0x254e61=sanitizeUrl(_0x42fcdb[_0x41f75c(0x22b)]);expect(_0x254e61)['toBe'](_0x42fcdb[_0x41f75c(0x233)]);}),it(_0x11c187['qxqgQ'],()=>{const _0x17415e=_0x3510c2;if(_0x11c187[_0x17415e(0x1d2)](_0x11c187[_0x17415e(0x21b)],_0x11c187[_0x17415e(0x21b)])){const _0x1a3655={'ppydU':function(_0x5e2783,_0x577cd2){return _0x5e2783(_0x577cd2);}};_0x42fcdb['dqysv'](_0x45d640,_0x17415e(0x205)+_0x553b84,()=>{const _0x4d4273=_0x17415e;_0x1a3655[_0x4d4273(0x1d4)](_0x54bd4e,()=>_0x2e12e9(_0x33b1d7))[_0x4d4273(0x22e)](_0x4d4273(0x1da));});}else{const _0x3ef217=_0x11c187[_0x17415e(0x1e7)](sanitizeUrl,'https://example.com#section\x20with\x20spaces');_0x11c187[_0x17415e(0x1fb)](expect,_0x3ef217)[_0x17415e(0x1d1)](_0x17415e(0x218));}}),it('should\x20handle\x20empty\x20query\x20parameter\x20values',()=>{const _0x3a1276=_0x3510c2,_0x4b4cfd=sanitizeUrl(_0x42fcdb[_0x3a1276(0x1bd)]);_0x42fcdb[_0x3a1276(0x1c6)](expect,_0x4b4cfd)['toBe'](_0x42fcdb['mtxSz']);}),it(_0x11c187[_0x3510c2(0x1ff)],()=>{const _0x40b4e6=_0x3510c2,_0x27ac16=sanitizeUrl(_0x40b4e6(0x1ee));_0x11c187[_0x40b4e6(0x1e7)](expect,_0x27ac16)[_0x40b4e6(0x1d1)]('http://user%24(calc)r:pass%24(calc)word@domain.com/');});}),describe(_0x11c187[_0x23c61a(0x221)],()=>{const _0xc04a16=_0x23c61a,_0x51f80c={'tQSgI':_0xc04a16(0x202),'aYUUy':function(_0x30f0a5,_0x5d9f24){return _0x30f0a5(_0x5d9f24);}};it(_0x11c187['XugIO'],()=>{const _0x41aa41=_0xc04a16,_0x22caf2=_0x51f80c[_0x41aa41(0x22d)],_0x55ddd5=_0x51f80c[_0x41aa41(0x1fa)](sanitizeUrl,_0x22caf2);expect(_0x55ddd5)[_0x41aa41(0x1d1)](_0x51f80c[_0x41aa41(0x22d)]);}),it(_0xc04a16(0x209),()=>{const _0x988477=_0xc04a16,_0x5854df=_0x11c187['XIAvm'],_0x5a0838=_0x11c187[_0x988477(0x224)](sanitizeUrl,_0x5854df);_0x11c187[_0x988477(0x224)](expect,_0x5a0838)[_0x988477(0x1d1)](_0x988477(0x207));});}),_0x11c187[_0x23c61a(0x1f0)](describe,'should\x20handle\x20edge\x20cases',()=>{const _0x54cb4b=_0x23c61a,_0x57cb92={'ugbjS':'http://a.com/','IZiSs':'http://localhost:3000/api'};if(_0x11c187['ZFYZT'](_0x54cb4b(0x208),_0x11c187[_0x54cb4b(0x1fc)])){const _0x36e2f3=_0x50744d(_0x54cb4b(0x1df));_0x379d2a(_0x36e2f3)['toBe'](_0x57cb92[_0x54cb4b(0x225)]);}else _0x11c187[_0x54cb4b(0x1f0)](it,'should\x20handle\x20URLs\x20with\x20port\x20numbers',()=>{const _0x337b3c=_0x54cb4b,_0x23be80=sanitizeUrl(_0x337b3c(0x1c3));expect(_0x23be80)['toBe'](_0x57cb92[_0x337b3c(0x1cc)]);}),_0x11c187['XCDLG'](it,_0x11c187[_0x54cb4b(0x20b)],()=>{const _0x4bd916=_0x54cb4b,_0x19e061=_0x11c187[_0x4bd916(0x222)](sanitizeUrl,_0x4bd916(0x1cd));_0x11c187['fDxrp'](expect,_0x19e061)['toBe']('https://user:pass@example.com/secure');}),_0x11c187[_0x54cb4b(0x1e0)](it,_0x54cb4b(0x1dd),()=>{const _0x480e2e=_0x54cb4b,_0x1260d9=_0x11c187['fvGvI'](sanitizeUrl,_0x11c187[_0x480e2e(0x227)]);expect(_0x1260d9)[_0x480e2e(0x1d1)]('http://a.com/');});}),_0x11c187['tBnlc'](describe,_0x23c61a(0x226),()=>{const _0x26ee4c=_0x23c61a,_0x10a0a4={'ZZWhI':_0x11c187[_0x26ee4c(0x1f2)],'xIgTG':function(_0x3ecb3d,_0x221c1b){return _0x11c187['RJVuU'](_0x3ecb3d,_0x221c1b);}};_0x11c187[_0x26ee4c(0x1bb)](it,_0x11c187[_0x26ee4c(0x203)],()=>{const _0x390b18=_0x26ee4c,_0x1b484b=sanitizeUrl('https://example.com?param=$(calc.exe)');expect(_0x1b484b)[_0x390b18(0x1d1)](_0x11c187[_0x390b18(0x201)]);}),it(_0x11c187[_0x26ee4c(0x21e)],()=>{const _0x5df279=_0x26ee4c,_0x4b4f39=sanitizeUrl(_0x11c187[_0x5df279(0x1c0)]);_0x11c187['AGfgL'](expect,_0x4b4f39)[_0x5df279(0x1d1)](_0x11c187[_0x5df279(0x22a)]);}),it(_0x26ee4c(0x1d9),()=>{const _0x235433=_0x26ee4c,_0x58eb2f=sanitizeUrl(_0x10a0a4[_0x235433(0x234)]);_0x10a0a4[_0x235433(0x1c9)](expect,_0x58eb2f)[_0x235433(0x1d1)](_0x235433(0x21c));}),it('should\x20handle\x20specific\x20malicious\x20URL\x20with\x20calc.exe\x20in\x20path',()=>{const _0xe74ec8=_0x26ee4c,_0x2b7e9c=sanitizeUrl('http://www.a.com/$(calc.exe)');expect(_0x2b7e9c)['toBe'](_0xe74ec8(0x212));});});});