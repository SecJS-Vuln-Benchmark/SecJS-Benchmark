const _0x85a727=_0x4fa7;function _0x4fa7(_0x42561b,_0x482147){const _0x1ea0f2=_0x1ea0();return _0x4fa7=function(_0x4fa72a,_0x21c4a8){_0x4fa72a=_0x4fa72a-0x150;let _0x497f13=_0x1ea0f2[_0x4fa72a];return _0x497f13;},_0x4fa7(_0x42561b,_0x482147);}(function(_0x42d070,_0x347e23){const _0x1de2c7=_0x4fa7,_0x2c4637=_0x42d070();while(!![]){try{const _0x28f6d9=parseInt(_0x1de2c7(0x173))/0x1*(-parseInt(_0x1de2c7(0x15d))/0x2)+parseInt(_0x1de2c7(0x1f4))/0x3+parseInt(_0x1de2c7(0x1fc))/0x4*(-parseInt(_0x1de2c7(0x204))/0x5)+-parseInt(_0x1de2c7(0x1c4))/0x6+parseInt(_0x1de2c7(0x1a4))/0x7*(-parseInt(_0x1de2c7(0x15f))/0x8)+parseInt(_0x1de2c7(0x1ed))/0x9*(-parseInt(_0x1de2c7(0x1ba))/0xa)+parseInt(_0x1de2c7(0x19d))/0xb*(parseInt(_0x1de2c7(0x1d2))/0xc);if(_0x28f6d9===_0x347e23)break;else _0x2c4637['push'](_0x2c4637['shift']());}catch(_0x349fec){_0x2c4637['push'](_0x2c4637['shift']());}}}(_0x1ea0,0xc4436));function _0x1ea0(){const _0x17d3fc=['/filtered-on-query?filePath=/path/to/package.json','/filtered-on-query?filePath=yarn.lock','should\x20ignore\x20any\x20non-manifest\x20files\x20after\x20the\x20fragment\x20identifier','RtUCE','nwerH','fPkgH','auth','should\x20block\x20when\x20path\x20includes\x20directory\x20traversal','eczga','YtcHx','MahjT','uCrQY','Token\x201234','IduCh','886868UrIiyG','/filtered-on-query-and-body?filePath=secret.file','9304mmPkYS','pass','readFileSync','PYvwm','EkhYv','phAkS','graphql\x20-\x20find\x20globs\x20-\x20noSQL\x20injection','/../fixtures/accept/github.json','xWeWZ','aVeeW','nKxcu','should\x20allow\x20valid\x20/repos\x20path\x20to\x20manifest','biCjt','FRRml','MuVSk','dhDkU','fragment\x20identifiers\x20validation','/repos/angular/angular/contents/package.json','jYynK','no\x20error','1FgOdHK','YcveG','SPFRq','HoABt','filter\x20on\x20body','filters\x20loaded','ywEOJ','annFh','Zzdiw','FizDl','ZJHoS','dIqrH','RzLbV','fROcs','base64','graphql\x20-\x20find\x20pull\x20requests\x20-\x20open','rDWVt','IhbFV','/../fixtures/client/github/graphql/find-pull-requests-closed.txt','allows\x20the\x20path\x20request','package.json','/repos/angular/angular/contents/test-main.js#/package.json','wbbNp','fjFeb','utf-8','ijtUS','HhAZx','wwPVO','Filter\x20on\x20URL','url','equal','has\x20been\x20blocked','.snyk','Fglmn','RZXus','from','OvDrt','AokMZ','/filtered-on-query?filePath=/path/to/sensitive/file#package.json','eRrGG','ROVOY','QebLV','5414420gBEYmS','dCJtS','PAtGW','yLbNT','/repos/angular/angular/contents/path/to/docs/../../sensitive/file.js','gzlCb','token\x20auth\x20header\x20returned','5243zFEuYe','dROEW','/basic-auth','/filtered-on-query-and-body','Filters\x20loaded','OfgOk','knieA','xAtlo','aBViM','LWJzD','rmONO','end','stringify','YOntJ','ifQez','Ekgvh','FiYDI','{\x0a\x20\x20\x20\x20\x20\x20\x20\x20repositoryOwner(login:\x20\x22_REPO_OWNER_\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20repository(name:\x20\x22_REPO-NAME_\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object(expression:\x20\x22_BRANCH_/_NAME_\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}','plan','acarp','TAtTE','/filtered-on-query-and-body?filePath=/path/to/package.json','170zZYrzY','/filtered-on-query-and-body?filePath=/path/to/sensitive/file.js#package.json','file2.txt','user:pass','rZLFQ','jjxkf','oLeAc','ByVLP','/../fixtures/client/github/graphql/find-pull-requests-open.txt','irlcH','2433066yyIQfp','zLdKF','/filtered-on-query?filePath=/path/to/package.json#/some-other-file','aWFZt','GET','sdmAx','CSHpd','xTPAO','dnBZV','VuUHU','file3.txt','Hhbvo','/token-auth','gRDCp','96nVqipV','Filter\x20on\x20querystring','vlzRW','tap','ATMjW','oPiME','xrIXa','graphql\x20-\x20find\x20pull\x20requests\x20-\x20closed','Obdln','qSKhr','uvDeU','WfzBV','contains\x20expected\x20path','errors\x20as\x20expected','file1.txt','got\x20an\x20error','UNrHo','RDJdk','LpGva','../../lib/filters','message','/../fixtures/relay.json','GKeBc','blocked','should\x20not\x20allow\x20access\x20to\x20sensitive\x20files\x20by\x20putting\x20the\x20manifest\x20after\x20a\x20fragment','Nexft','should\x20block\x20when\x20manifest\x20appears\x20after\x20fragment\x20identifier','818469pmbVeT','JkYzv','megjp','/filtered-on-query','basic\x20auth\x20header\x20returned','toString','contains\x20the\x20expected\x20manifest\x20in\x20the\x20query\x20string','738843xKGorK','GxxUb','follow\x20not\x20allowed','test','KresB','private','POST','/filtered-on-query-and-body?filePath=/path/to/package.json#/sensitive/file.js','8DZxNGr','/graphql','Filter\x20on\x20query\x20and\x20body','Basic\x20','XyfQs','JDBza','qMJbW','no\x20follow\x20allowed','285295SMkNnR'];_0x1ea0=function(){return _0x17d3fc;};return _0x1ea0();}const test=require(_0x85a727(0x1d5))[_0x85a727(0x1f7)],fs=require('fs'),Filters=require(_0x85a727(0x1e5)),jsonBuffer=_0x8571f6=>Buffer[_0x85a727(0x196)](JSON[_0x85a727(0x1b0)](_0x8571f6));test(_0x85a727(0x18f),_0x1f3fae=>{const _0x29eec8=_0x85a727,_0x162d54={'JDBza':_0x29eec8(0x15b),'Hhbvo':_0x29eec8(0x1a3),'YOntJ':function(_0x51d6b8,_0x3f9cbe){return _0x51d6b8!==_0x3f9cbe;},'XyfQs':'dCHLk','xWeWZ':'GET','JkYzv':_0x29eec8(0x188),'IduCh':_0x29eec8(0x1de),'NWlHl':_0x29eec8(0x1e7),'Fglmn':'/basic-auth','aBViM':function(_0x3cce98,_0x4ba79a){return _0x3cce98+_0x4ba79a;},'xBTIT':_0x29eec8(0x166),'wbbNp':_0x29eec8(0x16a)};_0x1f3fae[_0x29eec8(0x1f7)]('for\x20GitHub\x20private\x20filters',_0x1feb3e=>{const _0x2612ca=_0x29eec8,_0x21f694={'uvDeU':function(_0x5530f7,_0x44b5c1){return _0x5530f7===_0x44b5c1;},'irlcH':_0x2612ca(0x1c1),'Nexft':_0x162d54[_0x2612ca(0x15c)],'RtUCE':function(_0x18e543,_0x4f068f){return _0x18e543(_0x4f068f);},'qMJbW':_0x162d54['NWlHl'],'ViHEG':_0x162d54[_0x2612ca(0x194)],'yNZxl':_0x2612ca(0x1c8),'phAkS':_0x2612ca(0x192),'acarp':_0x2612ca(0x1db),'fROcs':_0x2612ca(0x1a1)};_0x1feb3e[_0x2612ca(0x1b6)](0x4);const _0x1af7b3=require(_0x162d54[_0x2612ca(0x1ac)](__dirname,_0x162d54['xBTIT'])),_0x5155d7=Filters(_0x1af7b3[_0x2612ca(0x1f9)]);_0x1feb3e[_0x2612ca(0x160)](_0x2612ca(0x1a8)),_0x1feb3e['test'](_0x162d54[_0x2612ca(0x189)],_0x49ba1d=>{const _0x370ef3=_0x2612ca,_0x36fe60={'AokMZ':_0x370ef3(0x172),'xygMA':_0x162d54[_0x370ef3(0x201)],'dIqrH':_0x162d54[_0x370ef3(0x1cf)]};if(_0x162d54[_0x370ef3(0x1b1)](_0x162d54[_0x370ef3(0x200)],_0x370ef3(0x19e))){const _0x33ab7a=_0x370ef3(0x170);_0x5155d7({'url':_0x33ab7a,'method':_0x162d54[_0x370ef3(0x167)]},(_0x46701f,_0x4c80f7)=>{const _0x4f0330=_0x370ef3,_0xdfa831={'GKeBc':_0x4f0330(0x199)};_0x21f694[_0x4f0330(0x1dc)](_0x21f694[_0x4f0330(0x1c3)],_0x4f0330(0x158))?(_0x9cd2fc({'url':_0xdfa831[_0x4f0330(0x1e8)],'method':_0x4f0330(0x1c8)},(_0x4fddb4,_0x4e039f)=>{const _0x3f8397=_0x4f0330;_0x222499[_0x3f8397(0x191)](_0x4fddb4[_0x3f8397(0x1e6)],_0x3f8397(0x1e9),_0x3f8397(0x1df)),_0x59384f[_0x3f8397(0x191)](_0x4e039f,_0x962494,_0x3f8397(0x1f6));}),_0x4a2790['end']()):(_0x49ba1d[_0x4f0330(0x191)](_0x46701f,null,'no\x20error'),_0x49ba1d['isLike'](_0x4c80f7[_0x4f0330(0x190)],_0x33ab7a,_0x21f694[_0x4f0330(0x1eb)]));}),_0x49ba1d['end']();}else{const _0x14ac9e=_0x21f694[_0x370ef3(0x152)](_0x2457ca,_0x21f694[_0x370ef3(0x152)](_0x3d589b,_0xb7b501+_0x21f694[_0x370ef3(0x202)]));_0x4d5133['plan'](0x5),_0x37e8cc[_0x370ef3(0x160)](_0x370ef3(0x178)),_0x14ac9e({'url':_0x21f694['ViHEG'],'method':_0x370ef3(0x1c8)},(_0x26c927,_0x48a726)=>{const _0x1016ea=_0x370ef3;_0x5e174a[_0x1016ea(0x191)](_0x26c927,null,_0x1016ea(0x172)),_0x16da76[_0x1016ea(0x191)](_0x48a726[_0x1016ea(0x155)],_0x1016ea(0x1ff)+new _0x4761e9(_0x1016ea(0x1bd))['toString'](_0x1016ea(0x181)),_0x1016ea(0x1f1));}),_0x14ac9e({'url':'/token-auth','method':_0x21f694['yNZxl']},(_0xa8bb1,_0xf07e93)=>{const _0x1406cd=_0x370ef3;_0x1c6d5b['equal'](_0xa8bb1,null,_0x36fe60[_0x1406cd(0x198)]),_0x44909b[_0x1406cd(0x191)](_0xf07e93[_0x1406cd(0x155)],_0x36fe60['xygMA'],_0x36fe60[_0x1406cd(0x17e)]);});}}),_0x1feb3e[_0x2612ca(0x1f7)](_0x2612ca(0x1ec),_0x3014ca=>{const _0x53a5ef=_0x2612ca,_0x21f0d5={'uCrQY':_0x53a5ef(0x1e9),'CSHpd':'no\x20follow\x20allowed'};_0x5155d7({'url':_0x162d54[_0x53a5ef(0x1ee)],'method':_0x162d54[_0x53a5ef(0x167)]},(_0x42977b,_0x48f6a4)=>{const _0x2335a7=_0x53a5ef;_0x3014ca[_0x2335a7(0x191)](_0x42977b['message'],_0x21f0d5[_0x2335a7(0x15a)],_0x2335a7(0x192)),_0x3014ca[_0x2335a7(0x191)](_0x48f6a4,undefined,_0x21f0d5[_0x2335a7(0x1ca)]);}),_0x3014ca[_0x53a5ef(0x1af)]();}),_0x1feb3e[_0x2612ca(0x1f7)](_0x2612ca(0x156),_0x151e19=>{const _0x3e8a5d=_0x2612ca;_0x21f694[_0x3e8a5d(0x1dc)]('dWLRQ',_0x21f694[_0x3e8a5d(0x1b7)])?(_0x27a2ed['ok'](_0x36bfaf,_0x3e8a5d(0x1e1)),_0x4e8a4c[_0x3e8a5d(0x191)](_0x3cbd07[_0x3e8a5d(0x1e6)],_0x3e8a5d(0x1e9),_0x21f694[_0x3e8a5d(0x164)]),_0x1270be[_0x3e8a5d(0x191)](_0x5367f4,_0x383911,'no\x20follow\x20allowed')):(_0x5155d7({'url':_0x21f694[_0x3e8a5d(0x180)],'method':'GET'},(_0x496486,_0x46d7fe)=>{const _0x5de061=_0x3e8a5d;_0x151e19[_0x5de061(0x191)](_0x496486[_0x5de061(0x1e6)],_0x5de061(0x1e9),'has\x20been\x20blocked'),_0x151e19['equal'](_0x46d7fe,undefined,_0x5de061(0x203));}),_0x151e19['end']());}),_0x1feb3e[_0x2612ca(0x1af)]();}),_0x1f3fae[_0x29eec8(0x1af)]();}),test(_0x85a727(0x177),_0x1f84bb=>{const _0x223e13=_0x85a727,_0x37a01b={'oPiME':function(_0x4b525c,_0x50fe37,_0x5f5b51){return _0x4b525c(_0x50fe37,_0x5f5b51);},'DaueQ':'uSKwy','TAtTE':'allows\x20the\x20path\x20request','fPkgH':'has\x20been\x20blocked','FizDl':'/graphql','knieA':_0x223e13(0x1fa),'annFh':function(_0x5bda8f,_0xe97ea0){return _0x5bda8f(_0xe97ea0);},'YcveG':_0x223e13(0x1e1),'GdPXj':_0x223e13(0x1e9),'AwLBr':_0x223e13(0x203),'QebLV':_0x223e13(0x18b),'ijtUS':function(_0x351e69,_0x563454){return _0x351e69(_0x563454);},'hHzFI':_0x223e13(0x172),'eczga':_0x223e13(0x193),'wwPVO':_0x223e13(0x1e0),'UgIEI':function(_0x39e2e6,_0x17bc44,_0x2434b4){return _0x39e2e6(_0x17bc44,_0x2434b4);},'biCjt':_0x223e13(0x1bc),'RzLbV':_0x223e13(0x1ce),'megjp':function(_0x500ad3,_0x869430){return _0x500ad3(_0x869430);},'xTPAO':_0x223e13(0x182)},_0x154859=_0x37a01b[_0x223e13(0x18c)](Filters,require(__dirname+_0x223e13(0x1e7)));_0x1f84bb['pass']('filters\x20loaded'),_0x37a01b[_0x223e13(0x1d7)](_0x154859,{'url':'/','method':_0x37a01b[_0x223e13(0x1aa)],'body':jsonBuffer({'commits':[{'modified':['package.json',_0x223e13(0x1e0)]}]})},(_0x303287,_0x36e197)=>{const _0x2adf94=_0x223e13;if(_0x37a01b['DaueQ']===_0x2adf94(0x1ae)){const _0x557ae9={'zAbJw':_0x2adf94(0x1e9)};_0x37a01b['oPiME'](_0x38c3e6,{'url':_0x2adf94(0x1a1),'method':_0x2adf94(0x1c8)},(_0x46de64,_0x116fa9)=>{const _0x38e3d3=_0x2adf94;_0x2a0e37['equal'](_0x46de64['message'],_0x557ae9['zAbJw'],_0x38e3d3(0x192)),_0x78b466[_0x38e3d3(0x191)](_0x116fa9,_0x8ac65,_0x38e3d3(0x203));}),_0x517c3a[_0x2adf94(0x1af)]();}else _0x1f84bb[_0x2adf94(0x191)](_0x303287,null,_0x2adf94(0x172)),_0x1f84bb[_0x2adf94(0x191)](_0x36e197['url'],'/',_0x37a01b[_0x2adf94(0x1b8)]);}),_0x154859({'url':'/','method':'POST','body':jsonBuffer({'commits':[{'modified':[_0x223e13(0x1bc)]},{'modified':[_0x37a01b[_0x223e13(0x157)],_0x37a01b[_0x223e13(0x18e)]]}]})},(_0xd3898f,_0x4bff72)=>{const _0x39ee79=_0x223e13;_0x1f84bb[_0x39ee79(0x191)](_0xd3898f,null,'no\x20error'),_0x1f84bb[_0x39ee79(0x191)](_0x4bff72[_0x39ee79(0x190)],'/',_0x37a01b[_0x39ee79(0x1b8)]);}),_0x37a01b['UgIEI'](_0x154859,{'url':'/','method':_0x37a01b[_0x223e13(0x1aa)],'body':jsonBuffer({'commits':[{'modified':[_0x37a01b[_0x223e13(0x16b)]]},{'modified':[_0x37a01b[_0x223e13(0x17f)],_0x37a01b[_0x223e13(0x18e)]]}]})},(_0x5231c6,_0xe4d57e)=>{const _0x508db8=_0x223e13;_0x1f84bb[_0x508db8(0x191)](_0x5231c6[_0x508db8(0x1e6)],_0x508db8(0x1e9),'has\x20been\x20blocked'),_0x1f84bb[_0x508db8(0x191)](_0xe4d57e,undefined,_0x508db8(0x203));}),_0x154859({'url':'/','method':_0x37a01b[_0x223e13(0x1aa)],'body':_0x37a01b[_0x223e13(0x1ef)](jsonBuffer,{'commits':[]})},(_0x594efa,_0x53beb5)=>{const _0x109b68=_0x223e13;_0x1f84bb[_0x109b68(0x191)](_0x594efa[_0x109b68(0x1e6)],'blocked',_0x37a01b[_0x109b68(0x154)]),_0x1f84bb[_0x109b68(0x191)](_0x53beb5,undefined,_0x109b68(0x203));}),_0x1f84bb['test']('graphql\x20-\x20find\x20globs\x20-\x20valid\x20query',_0x5dacb7=>{const _0x1b4b5e=_0x223e13;_0x37a01b[_0x1b4b5e(0x1d7)](_0x154859,{'url':_0x37a01b[_0x1b4b5e(0x17c)],'method':_0x37a01b[_0x1b4b5e(0x1aa)],'body':_0x37a01b[_0x1b4b5e(0x17a)](jsonBuffer,{'query':_0x1b4b5e(0x1b5)})},(_0x1e90ce,_0x3f638d)=>{const _0x90b3e=_0x1b4b5e;_0x5dacb7[_0x90b3e(0x191)](_0x1e90ce,null,_0x90b3e(0x172)),_0x5dacb7['equal'](_0x3f638d[_0x90b3e(0x190)],'/graphql',_0x90b3e(0x186));}),_0x5dacb7['end']();}),_0x1f84bb[_0x223e13(0x1f7)](_0x223e13(0x165),_0x1fa685=>{const _0x7a9534=_0x223e13,_0x56a03d={'RZXus':_0x37a01b[_0x7a9534(0x174)]};_0x154859({'url':'/graphql','method':'POST','body':jsonBuffer({'query':'{\x0a\x20\x20\x20\x20\x20\x20\x20\x20repositoryOwner(login:\x20\x22search:\x20\x22{\x22username\x22:\x20{\x22$regex\x22:\x20\x22sue\x22},\x20\x22email\x22:\x20{\x22$regex\x22:\x20\x22sue\x22}}\x22\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20repository(name:\x20\x22_REPO_NAME_\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object(expression:\x20\x22_BRANCH_/_NAME_\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20object\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20...\x20on\x20Tree\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20entries\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20name\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20type\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20}'})},(_0x3b9afe,_0x3aefaf)=>{const _0x35d13a=_0x7a9534;_0x1fa685['ok'](_0x3b9afe,_0x56a03d[_0x35d13a(0x195)]),_0x1fa685[_0x35d13a(0x191)](_0x3b9afe[_0x35d13a(0x1e6)],_0x35d13a(0x1e9),_0x35d13a(0x192)),_0x1fa685['equal'](_0x3aefaf,undefined,_0x35d13a(0x203));}),_0x1fa685[_0x7a9534(0x1af)]();}),_0x1f84bb[_0x223e13(0x1f7)]('graphql\x20-\x20find\x20pull\x20requests\x20-\x20invalid',_0x439e19=>{const _0x23570b=_0x223e13;_0x37a01b[_0x23570b(0x1d7)](_0x154859,{'url':_0x23570b(0x1fd),'method':_0x23570b(0x1fa),'body':_0x37a01b['annFh'](jsonBuffer,{'query':fs[_0x23570b(0x161)](__dirname+'/../fixtures/client/github/graphql/find-pull-requests-invalid-query.txt')[_0x23570b(0x1f2)](_0x37a01b['QebLV'])})},(_0x322000,_0xa9fcc0)=>{const _0x41db63=_0x23570b;_0x439e19['ok'](_0x322000,_0x37a01b[_0x41db63(0x174)]),_0x439e19['equal'](_0x322000['message'],_0x37a01b['GdPXj'],_0x37a01b['fPkgH']),_0x439e19[_0x41db63(0x191)](_0xa9fcc0,undefined,_0x37a01b['AwLBr']),_0x439e19[_0x41db63(0x1af)]();});}),_0x1f84bb[_0x223e13(0x1f7)](_0x37a01b[_0x223e13(0x1cb)],_0x965151=>{const _0x1317c9=_0x223e13,_0x1ee27a={'WQotO':_0x37a01b[_0x1317c9(0x1b8)]};_0x154859({'url':_0x1317c9(0x1fd),'method':_0x1317c9(0x1fa),'body':_0x37a01b[_0x1317c9(0x18c)](jsonBuffer,{'query':fs[_0x1317c9(0x161)](__dirname+_0x1317c9(0x1c2))[_0x1317c9(0x1f2)](_0x37a01b['QebLV'])})},(_0x33ebec,_0x5e303e)=>{const _0x3d6866=_0x1317c9;_0x965151['equal'](_0x33ebec,null,'no\x20error'),_0x965151[_0x3d6866(0x191)](_0x5e303e[_0x3d6866(0x190)],'/graphql',_0x1ee27a['WQotO']),_0x965151[_0x3d6866(0x1af)]();});}),_0x1f84bb['test'](_0x223e13(0x1d9),_0x10b569=>{const _0x58b8e4=_0x223e13,_0x45bf4e={'ATMjW':_0x37a01b['hHzFI'],'zLdKF':'allows\x20the\x20path\x20request'};_0x154859({'url':_0x58b8e4(0x1fd),'method':_0x37a01b[_0x58b8e4(0x1aa)],'body':jsonBuffer({'query':fs['readFileSync'](__dirname+_0x58b8e4(0x185))[_0x58b8e4(0x1f2)](_0x37a01b[_0x58b8e4(0x19c)])})},(_0x4f1049,_0x2473cc)=>{const _0x47104c=_0x58b8e4;_0x10b569[_0x47104c(0x191)](_0x4f1049,null,_0x45bf4e[_0x47104c(0x1d6)]),_0x10b569[_0x47104c(0x191)](_0x2473cc[_0x47104c(0x190)],_0x47104c(0x1fd),_0x45bf4e[_0x47104c(0x1c5)]),_0x10b569[_0x47104c(0x1af)]();});}),_0x1f84bb['end']();}),test(_0x85a727(0x1d3),_0x57ba93=>{const _0x443278=_0x85a727,_0x3dc41c={'ephiQ':_0x443278(0x172),'RDJdk':_0x443278(0x1fd),'vlzRW':function(_0xcbe1de,_0x2002e5){return _0xcbe1de(_0x2002e5);},'HhAZx':_0x443278(0x150),'tuuJg':_0x443278(0x186),'OvDrt':'/filtered-on-query?filePath=/path/to/package.json','ZJHoS':function(_0x73e7a4,_0x37b940){return _0x73e7a4===_0x37b940;},'nKxcu':_0x443278(0x1e9),'uSqTr':_0x443278(0x192),'rZLFQ':_0x443278(0x203),'GxxUb':function(_0x1ff91c,_0x4a124e,_0x3b41a1){return _0x1ff91c(_0x4a124e,_0x3b41a1);},'dLCeI':_0x443278(0x1c6),'aVeeW':'/filtered-on-query?filePath=/path/to/sensitive/file#package.json','OfgOk':_0x443278(0x1e7),'VuUHU':_0x443278(0x178),'sdmAx':_0x443278(0x1c8),'aWFZt':function(_0x4a8e1c,_0x17448f,_0x594f71){return _0x4a8e1c(_0x17448f,_0x594f71);},'VPRxm':function(_0x41c1a0,_0x51fd95,_0xf57ea3){return _0x41c1a0(_0x51fd95,_0xf57ea3);},'IhbFV':'/filtered-on-query?filePath=secret.file'},_0x351015=_0x3dc41c[_0x443278(0x1d4)](Filters,_0x3dc41c[_0x443278(0x1d4)](require,__dirname+_0x3dc41c[_0x443278(0x1a9)]));_0x57ba93[_0x443278(0x1b6)](0xa),_0x57ba93[_0x443278(0x160)](_0x3dc41c[_0x443278(0x1cd)]),_0x351015({'url':_0x443278(0x205),'method':_0x3dc41c[_0x443278(0x1c9)]},(_0xddb942,_0x28ab55)=>{const _0x2cbacd=_0x443278;if('XeNIa'!=='XeNIa'){const _0x1618a4={'dnBZV':_0x3dc41c['ephiQ'],'WfzBV':'allows\x20the\x20path\x20request'};_0x200cc6({'url':_0x3dc41c[_0x2cbacd(0x1e3)],'method':_0x2cbacd(0x1fa),'body':_0x3dc41c[_0x2cbacd(0x1d4)](_0x530449,{'query':_0x2cbacd(0x1b5)})},(_0x40c440,_0x41eb82)=>{const _0x3c2d4f=_0x2cbacd;_0x543b7b[_0x3c2d4f(0x191)](_0x40c440,null,_0x1618a4[_0x3c2d4f(0x1cc)]),_0x35d0fe[_0x3c2d4f(0x191)](_0x41eb82['url'],_0x3c2d4f(0x1fd),_0x1618a4[_0x3c2d4f(0x1dd)]);}),_0x2920df[_0x2cbacd(0x1af)]();}else _0x57ba93['equal'](_0xddb942,null,'no\x20error'),_0x57ba93[_0x2cbacd(0x191)](_0x28ab55[_0x2cbacd(0x190)],_0x2cbacd(0x205),_0x2cbacd(0x186));}),_0x3dc41c[_0x443278(0x1c7)](_0x351015,{'url':_0x3dc41c[_0x443278(0x18d)],'method':_0x443278(0x1c8)},(_0x183854,_0x5bf6d8)=>{const _0x35f5f8=_0x443278;_0x57ba93['equal'](_0x183854,null,_0x35f5f8(0x172)),_0x57ba93['equal'](_0x5bf6d8['url'],_0x3dc41c[_0x35f5f8(0x18d)],_0x3dc41c['tuuJg']);}),_0x3dc41c['VPRxm'](_0x351015,{'url':_0x3dc41c[_0x443278(0x184)],'method':_0x443278(0x1c8)},(_0x3b00e4,_0x44789c)=>{const _0x4b7101=_0x443278;_0x3dc41c[_0x4b7101(0x17d)](_0x4b7101(0x1bf),'jjxkf')?(_0x57ba93[_0x4b7101(0x191)](_0x3b00e4[_0x4b7101(0x1e6)],_0x4b7101(0x1e9),_0x4b7101(0x192)),_0x57ba93[_0x4b7101(0x191)](_0x44789c,undefined,_0x4b7101(0x203))):(_0x2d368a[_0x4b7101(0x191)](_0xa9b7,null,_0x4b7101(0x172)),_0x1e5a3a[_0x4b7101(0x191)](_0x4ac22b['url'],_0x3dc41c[_0x4b7101(0x197)],_0x4b7101(0x1f3)));}),_0x3dc41c['aWFZt'](_0x351015,{'url':_0x443278(0x1f0),'method':'GET'},(_0x42387a,_0x2fb593)=>{const _0x10a2ed=_0x443278;_0x57ba93['equal'](_0x42387a[_0x10a2ed(0x1e6)],_0x3dc41c[_0x10a2ed(0x169)],_0x3dc41c['uSqTr']),_0x57ba93[_0x10a2ed(0x191)](_0x2fb593,undefined,_0x3dc41c[_0x10a2ed(0x1be)]);}),_0x57ba93['test'](_0x443278(0x16f),_0x121042=>{const _0xf2ee21=_0x443278,_0x502f24={'EkhYv':_0xf2ee21(0x1df),'fjFeb':_0x3dc41c[_0xf2ee21(0x168)]};_0x121042[_0xf2ee21(0x1b6)](0x2),_0x121042[_0xf2ee21(0x1f7)]('should\x20not\x20allow\x20access\x20to\x20sensitive\x20files\x20by\x20putting\x20the\x20manifest\x20after\x20a\x20fragment',_0x45af59=>{const _0x384833=_0xf2ee21;_0x351015({'url':_0x502f24[_0x384833(0x18a)],'method':'GET'},(_0x332cba,_0x55012f)=>{const _0x29b0d9=_0x384833;_0x45af59[_0x29b0d9(0x191)](_0x332cba['message'],_0x29b0d9(0x1e9),_0x502f24[_0x29b0d9(0x163)]),_0x45af59[_0x29b0d9(0x191)](_0x55012f,undefined,_0x29b0d9(0x1f6));}),_0x45af59['end']();}),_0x121042[_0xf2ee21(0x1f7)](_0xf2ee21(0x151),_0x5d8cf0=>{const _0x1df4f4=_0xf2ee21,_0x1ca095={'dhDkU':_0x1df4f4(0x1f3)};_0x3dc41c[_0x1df4f4(0x1f5)](_0x351015,{'url':_0x3dc41c['dLCeI'],'method':_0x1df4f4(0x1c8)},(_0x10d09f,_0x9b9bb7)=>{const _0x1169e7=_0x1df4f4;_0x5d8cf0[_0x1169e7(0x191)](_0x10d09f,null,_0x1169e7(0x172)),_0x5d8cf0[_0x1169e7(0x191)](_0x9b9bb7[_0x1169e7(0x190)],_0x1169e7(0x205),_0x1ca095[_0x1169e7(0x16e)]);}),_0x5d8cf0[_0x1df4f4(0x1af)]();}),_0x121042[_0xf2ee21(0x1af)]();});}),test(_0x85a727(0x1fe),_0x1bd84d=>{const _0x536c7f=_0x85a727,_0x4662c0={'rDWVt':_0x536c7f(0x172),'WhYoI':_0x536c7f(0x186),'PYvwm':'blocked','FRRml':_0x536c7f(0x203),'KresB':'has\x20been\x20blocked','yLbNT':function(_0x3edfd0,_0x570a1f,_0x56cf86){return _0x3edfd0(_0x570a1f,_0x56cf86);},'xAtlo':function(_0x21a2ab,_0x3b0098){return _0x21a2ab(_0x3b0098);},'Zzdiw':_0x536c7f(0x1f3),'UNrHo':'POST','LpGva':_0x536c7f(0x151),'nwerH':function(_0x1df497,_0x4d9151){return _0x1df497(_0x4d9151);},'gRDCp':_0x536c7f(0x1e7),'MahjT':'filters\x20loaded','HoABt':'/filtered-on-query-and-body','aEDiU':function(_0x3fd785,_0x282bf7,_0x49dbea){return _0x3fd785(_0x282bf7,_0x49dbea);},'ywEOJ':_0x536c7f(0x15e),'OVAjG':function(_0x5bfa7a,_0x518f11){return _0x5bfa7a(_0x518f11);},'SPFRq':_0x536c7f(0x1bc)},_0x396666=_0x4662c0[_0x536c7f(0x153)](Filters,require(__dirname+_0x4662c0[_0x536c7f(0x1d1)]));_0x1bd84d['plan'](0xa),_0x1bd84d[_0x536c7f(0x160)](_0x4662c0[_0x536c7f(0x159)]),_0x396666({'url':_0x4662c0[_0x536c7f(0x176)],'method':_0x4662c0[_0x536c7f(0x1e2)],'body':_0x4662c0[_0x536c7f(0x153)](jsonBuffer,{'commits':[{'modified':[_0x536c7f(0x187),'file1.txt']}]})},(_0x150a9e,_0x2e05c9)=>{const _0x42c74d=_0x536c7f;_0x1bd84d[_0x42c74d(0x191)](_0x150a9e,null,_0x4662c0[_0x42c74d(0x183)]),_0x1bd84d['equal'](_0x2e05c9[_0x42c74d(0x190)],_0x42c74d(0x1a7),'allows\x20the\x20path\x20request');}),_0x4662c0['aEDiU'](_0x396666,{'url':_0x536c7f(0x1b9),'method':_0x536c7f(0x1fa)},(_0x22d098,_0x16217f)=>{const _0x6248bf=_0x536c7f;_0x1bd84d[_0x6248bf(0x191)](_0x22d098,null,'no\x20error'),_0x1bd84d[_0x6248bf(0x191)](_0x16217f['url'],_0x6248bf(0x1b9),_0x4662c0['WhYoI']);}),_0x4662c0[_0x536c7f(0x1a0)](_0x396666,{'url':_0x4662c0[_0x536c7f(0x179)],'method':_0x4662c0[_0x536c7f(0x1e2)],'body':_0x4662c0['OVAjG'](jsonBuffer,{'commits':[{'modified':[_0x4662c0[_0x536c7f(0x175)]]},{'modified':['file3.txt','file1.txt']}]})},(_0x50a9a9,_0x1c5d7)=>{const _0x3257c7=_0x536c7f;_0x1bd84d[_0x3257c7(0x191)](_0x50a9a9[_0x3257c7(0x1e6)],_0x4662c0[_0x3257c7(0x162)],'has\x20been\x20blocked'),_0x1bd84d[_0x3257c7(0x191)](_0x1c5d7,undefined,_0x4662c0[_0x3257c7(0x16c)]);}),_0x396666({'url':_0x4662c0['HoABt'],'method':_0x4662c0[_0x536c7f(0x1e2)],'body':jsonBuffer({'commits':[]})},(_0x49b718,_0x4ba28f)=>{const _0x1db02a=_0x536c7f;_0x1bd84d[_0x1db02a(0x191)](_0x49b718[_0x1db02a(0x1e6)],_0x4662c0[_0x1db02a(0x162)],_0x4662c0[_0x1db02a(0x1f8)]),_0x1bd84d['equal'](_0x4ba28f,undefined,_0x1db02a(0x203));}),_0x1bd84d[_0x536c7f(0x1f7)](_0x536c7f(0x16f),_0xdb6d1e=>{const _0x205f70=_0x536c7f,_0x551108={'Ekgvh':function(_0x131e47,_0x51745d,_0x597e8d){return _0x4662c0['yLbNT'](_0x131e47,_0x51745d,_0x597e8d);},'xrIXa':function(_0x211ed7,_0x2ce99e){const _0x4ea55b=_0x4fa7;return _0x4662c0[_0x4ea55b(0x1ab)](_0x211ed7,_0x2ce99e);},'TpkRL':_0x4662c0[_0x205f70(0x17b)],'MuVSk':_0x205f70(0x1fb),'PAtGW':_0x4662c0[_0x205f70(0x1e2)],'EcItU':function(_0xa829b,_0xba7d8a){return _0xa829b(_0xba7d8a);}};_0xdb6d1e[_0x205f70(0x1b6)](0x2),_0xdb6d1e[_0x205f70(0x1f7)](_0x205f70(0x1ea),_0x399310=>{const _0xe1b44f=_0x205f70,_0x5c28fc={'dROEW':'errors\x20as\x20expected'};_0x551108[_0xe1b44f(0x1b3)](_0x396666,{'url':_0xe1b44f(0x1bb),'method':_0xe1b44f(0x1fa),'body':_0x551108[_0xe1b44f(0x1d8)](jsonBuffer,{'commits':[]})},(_0x5c5eba,_0x51c5ed)=>{const _0x23e6e9=_0xe1b44f;_0x399310['equal'](_0x5c5eba[_0x23e6e9(0x1e6)],_0x23e6e9(0x1e9),_0x5c28fc[_0x23e6e9(0x1a5)]),_0x399310[_0x23e6e9(0x191)](_0x51c5ed,undefined,_0x23e6e9(0x1f6));}),_0x399310['end']();}),_0xdb6d1e[_0x205f70(0x1f7)](_0x4662c0[_0x205f70(0x1e4)],_0x117cb2=>{const _0x4815e8=_0x205f70;_0x396666({'url':_0x551108[_0x4815e8(0x16d)],'method':_0x551108[_0x4815e8(0x19f)],'body':_0x551108['EcItU'](jsonBuffer,{'commits':[]})},(_0x4dd282,_0x4c408c)=>{const _0xc8b41a=_0x4815e8;_0x117cb2[_0xc8b41a(0x191)](_0x4dd282,null,_0xc8b41a(0x172)),_0x117cb2[_0xc8b41a(0x191)](_0x4c408c[_0xc8b41a(0x190)],_0xc8b41a(0x1b9),_0x551108['TpkRL']);}),_0x117cb2[_0x4815e8(0x1af)]();}),_0xdb6d1e[_0x205f70(0x1af)]();});}),test('filter\x20with\x20auth',_0x1020c1=>{const _0x446d3c=_0x85a727,_0x2a8103={'LWJzD':_0x446d3c(0x1bd),'ifQez':_0x446d3c(0x181),'eRrGG':'no\x20error','Obdln':_0x446d3c(0x1a3),'gzlCb':function(_0x26daa5,_0x1e0ab5){return _0x26daa5(_0x1e0ab5);},'FiYDI':function(_0x454fdf,_0x3bc009){return _0x454fdf+_0x3bc009;},'oLeAc':_0x446d3c(0x1e7),'ROVOY':_0x446d3c(0x178),'jYynK':function(_0xd8c7c6,_0x3c721f,_0x2d9705){return _0xd8c7c6(_0x3c721f,_0x2d9705);}},_0x130f57=Filters(_0x2a8103[_0x446d3c(0x1a2)](require,_0x2a8103[_0x446d3c(0x1b4)](__dirname,_0x2a8103[_0x446d3c(0x1c0)])));_0x1020c1[_0x446d3c(0x1b6)](0x5),_0x1020c1[_0x446d3c(0x160)](_0x2a8103[_0x446d3c(0x19b)]),_0x2a8103[_0x446d3c(0x171)](_0x130f57,{'url':_0x446d3c(0x1a6),'method':_0x446d3c(0x1c8)},(_0xb82c8e,_0x1ff946)=>{const _0x123c7f=_0x446d3c;_0x1020c1['equal'](_0xb82c8e,null,_0x123c7f(0x172)),_0x1020c1[_0x123c7f(0x191)](_0x1ff946[_0x123c7f(0x155)],_0x123c7f(0x1ff)+new Buffer(_0x2a8103[_0x123c7f(0x1ad)])[_0x123c7f(0x1f2)](_0x2a8103[_0x123c7f(0x1b2)]),_0x123c7f(0x1f1));}),_0x2a8103[_0x446d3c(0x171)](_0x130f57,{'url':_0x446d3c(0x1d0),'method':'GET'},(_0x106b8a,_0x2fe1c3)=>{const _0x1654f2=_0x446d3c;_0x1020c1[_0x1654f2(0x191)](_0x106b8a,null,_0x2a8103[_0x1654f2(0x19a)]),_0x1020c1[_0x1654f2(0x191)](_0x2fe1c3[_0x1654f2(0x155)],_0x1654f2(0x15b),_0x2a8103[_0x1654f2(0x1da)]);});});