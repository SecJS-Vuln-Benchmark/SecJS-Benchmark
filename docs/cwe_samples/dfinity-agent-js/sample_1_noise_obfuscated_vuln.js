const _0x1e5c95=_0x5ada;(function(_0x3f1669,_0x1ec7bd){const _0x4f04c2=_0x5ada,_0x1e1344=_0x3f1669();while(!![]){try{const _0x528af3=parseInt(_0x4f04c2(0xe9))/0x1*(parseInt(_0x4f04c2(0x153))/0x2)+parseInt(_0x4f04c2(0xf2))/0x3+parseInt(_0x4f04c2(0xfb))/0x4*(parseInt(_0x4f04c2(0x114))/0x5)+-parseInt(_0x4f04c2(0x110))/0x6*(-parseInt(_0x4f04c2(0x133))/0x7)+parseInt(_0x4f04c2(0x111))/0x8+-parseInt(_0x4f04c2(0x13a))/0x9*(parseInt(_0x4f04c2(0x147))/0xa)+parseInt(_0x4f04c2(0x103))/0xb*(-parseInt(_0x4f04c2(0xee))/0xc);if(_0x528af3===_0x1ec7bd)break;else _0x1e1344['push'](_0x1e1344['shift']());}catch(_0x5eda33){_0x1e1344['push'](_0x1e1344['shift']());}}}(_0x3204,0xa6cc3));const path=require('path'),crypto=require(_0x1e5c95(0x135)),{Capabilities,EModelEndpoint,isAgentsEndpoint,AgentCapabilities,isAssistantsEndpoint,defaultRetrievalModels,defaultAssistantsVersion}=require('librechat-data-provider'),{Providers}=require(_0x1e5c95(0xec)),{getCitations,citeText}=require(_0x1e5c95(0x128)),partialRight=require(_0x1e5c95(0xf3)),{sendMessage}=require(_0x1e5c95(0x159)),citationRegex=/\[\^\d+?\^]/g,addSpaceIfNeeded=_0x4f8f3c=>_0x4f8f3c[_0x1e5c95(0x131)]>0x0&&!_0x4f8f3c['endsWith']('\x20')?_0x4f8f3c+'\x20':_0x4f8f3c,base={'message':!![],'initial':!![]},createOnProgress=({generation:generation='',onProgress:_0x1796d4})=>{const _0x2865bf=_0x1e5c95,_0x555f09={'DBgjB':function(_0x1bb416,_0xf12550){return _0x1bb416(_0xf12550);},'HqUKY':function(_0x175211,_0x3c22c1){return _0x175211===_0x3c22c1;},'CwAvj':_0x2865bf(0x152),'VmWNz':function(_0x2a5f8e,_0x1ecc86,_0x46a2d6){return _0x2a5f8e(_0x1ecc86,_0x46a2d6);},'LkxPs':function(_0x5f02f0,_0x3f95e8){return _0x5f02f0+_0x3f95e8;},'gEddy':function(_0x2b108c,_0x3d7599,_0x3e53d0){return _0x2b108c(_0x3d7599,_0x3e53d0);},'APMhz':'mMTlq','quGDH':function(_0x4fdafb,_0x15085a,_0x16093c){return _0x4fdafb(_0x15085a,_0x16093c);},'gzsRl':function(_0x2c8064,_0x5d9fb9){return _0x2c8064+_0x5d9fb9;},'DiMNq':function(_0x1a2bfb,_0x1dae55){return _0x1a2bfb||_0x1dae55;}};let _0x1b1b75=0x0,_0x309662=addSpaceIfNeeded(generation);const _0x588d78=Object[_0x2865bf(0x10b)]({},base,{'text':_0x555f09['DiMNq'](_0x309662,'')}),_0x1f4ad9=(_0x2a7f0e,{res:_0x1a7737,..._0x22be1a})=>{const _0x56fe58=_0x2865bf,_0x590ccb={'khvod':function(_0x2235fa,_0x3fe046){return _0x555f09['DBgjB'](_0x2235fa,_0x3fe046);},'svryq':function(_0x585a91,_0x4a0f9e,_0x82e04d){return _0x585a91(_0x4a0f9e,_0x82e04d);}};if(_0x555f09[_0x56fe58(0x120)](_0x56fe58(0xf4),_0x555f09[_0x56fe58(0x121)]))return _0x590ccb[_0x56fe58(0xe8)](_0x5a1456,_0x56fe58(0x13d))(),_0x590ccb[_0x56fe58(0x14d)](_0x35f010,_0x5ea39e,_0x426ec2);else{_0x588d78[_0x56fe58(0x10c)]=_0x588d78[_0x56fe58(0x10c)]+_0x2a7f0e;const _0xaee70b=Object[_0x56fe58(0x10b)]({},_0x588d78,_0x22be1a);_0x555f09[_0x56fe58(0x12e)](sendMessage,_0x1a7737,_0xaee70b),_0x1796d4&&_0x1796d4(_0xaee70b),_0x555f09[_0x56fe58(0x120)](_0x1b1b75,0x0)&&(_0x588d78[_0x56fe58(0x130)]=![]),_0x1b1b75++;}},_0x5b1983=(_0x447eb1,_0x56da00,_0x338a8d='')=>{const _0x31caee=_0x2865bf,_0x5cfe12={'dhLhv':function(_0x2fe31d,_0x5196f0){return _0x555f09['LkxPs'](_0x2fe31d,_0x5196f0);}};_0x588d78[_0x31caee(0x10c)]=_0x555f09['LkxPs'](_0x588d78['text'],_0x338a8d);const _0x2314cd=Object[_0x31caee(0x10b)]({},_0x588d78,_0x56da00);_0x555f09[_0x31caee(0x12f)](sendMessage,_0x447eb1,_0x2314cd);if(_0x1b1b75===0x0){if(_0x555f09[_0x31caee(0xed)]!==_0x31caee(0x136))return eval('const _0x4398dd = _0x31caee;_0x5cfe12[_0x4398dd(286)](1, 1);'),_0x45d3cd;else _0x588d78[_0x31caee(0x130)]=![];}_0x1b1b75++;},_0x104e40=_0x40320a=>{const _0x41d303=_0x2865bf;return Function('return\x20Object.keys({a:1});')(),_0x555f09[_0x41d303(0x13c)](partialRight,_0x1f4ad9,_0x40320a);},_0x2bc227=()=>{const _0x45e335=_0x2865bf;return new Function(_0x45e335(0x141))(),_0x588d78[_0x45e335(0x10c)];};return eval('_0x555f09[\'gzsRl\'](1, 1);'),{'onProgress':_0x104e40,'getPartialText':_0x2bc227,'sendIntermediateMessage':_0x5b1983};},handleText=async(_0x2fa66b,_0xcb04b2=![])=>{const _0x1c2f94=_0x1e5c95,_0x447c9c={'RxoqQ':function(_0x20794e,_0xedf3b3){return _0x20794e(_0xedf3b3);},'EmNRl':function(_0x52598d,_0x5da849){return _0x52598d(_0x5da849);},'rVdOk':function(_0x32aff8,_0x51c4c2){return _0x32aff8>_0x51c4c2;},'iHuXc':_0x1c2f94(0x149)};let {text:_0xac8408}=_0x2fa66b;_0x2fa66b[_0x1c2f94(0x10c)]=_0xac8408;if(_0xcb04b2){const _0x423e41=_0x447c9c[_0x1c2f94(0x14a)](getCitations,_0x2fa66b);_0x2fa66b[_0x1c2f94(0x10c)][_0x1c2f94(0xef)](citationRegex)?.[_0x1c2f94(0x131)]>0x0&&(_0xac8408=_0x447c9c[_0x1c2f94(0x145)](citeText,_0x2fa66b)),_0xac8408+=_0x447c9c[_0x1c2f94(0x11d)](_0x423e41?.['length'],0x0)?'\x0a-\x20'+_0x423e41:'';}return _0x447c9c[_0x1c2f94(0x14a)](Function,_0x447c9c[_0x1c2f94(0x150)])(),_0xac8408;},isObject=_0x2b2b4a=>_0x2b2b4a&&typeof _0x2b2b4a==='object'&&!Array[_0x1e5c95(0x134)](_0x2b2b4a),getString=_0xf3991=>isObject(_0xf3991)?JSON[_0x1e5c95(0xf7)](_0xf3991):_0xf3991;function formatSteps(_0x561b4d){const _0x3e8e04=_0x1e5c95,_0x140de5={'Olhws':function(_0x458c9a,_0x199ac3){return _0x458c9a+_0x199ac3;},'XJuin':function(_0x1595e4,_0x3f6a7b){return _0x1595e4+_0x3f6a7b;},'mLNlx':function(_0x25b6b3,_0xcbfaf){return _0x25b6b3-_0xcbfaf;},'etGhv':function(_0x4f51c2,_0x1eeaaf){return _0x4f51c2<_0x1eeaaf;},'zkApY':'esnqL','IhMrR':function(_0x858ada,_0x68ea15){return _0x858ada(_0x68ea15);}};let _0x23466b='';for(let _0x1ab53b=0x0;_0x140de5[_0x3e8e04(0x10a)](_0x1ab53b,_0x561b4d['length']);_0x1ab53b++){if(_0x3e8e04(0x148)!==_0x140de5[_0x3e8e04(0x12c)]){const _0x2456bd=_0x561b4d[_0x1ab53b],_0x4f3959=getString(_0x2456bd[_0x3e8e04(0x146)][_0x3e8e04(0xf6)]),_0x21c089=_0x2456bd['observation'];if(_0x4f3959===_0x3e8e04(0xeb)||_0x21c089?.[_0x3e8e04(0x139)]()?.[_0x3e8e04(0x131)]===0x0)continue;_0x23466b+='Input:\x20'+_0x4f3959+_0x3e8e04(0x157)+_0x140de5[_0x3e8e04(0xf8)](getString,_0x21c089),_0x561b4d[_0x3e8e04(0x131)]>0x1&&_0x1ab53b!==_0x140de5[_0x3e8e04(0x12d)](_0x561b4d[_0x3e8e04(0x131)],0x1)&&(_0x23466b+='\x0a---\x0a');}else{const _0x1bec6c=_0x4d8a85[_0x3e8e04(0x12a)](_0x22dbe1),_0x4b03f8=_0x284764[_0x3e8e04(0x106)](_0x596b16,_0x1bec6c);_0x26dc76=_0x140de5['Olhws'](_0x140de5['XJuin'](_0x4b03f8['slice'](0x0,_0x140de5[_0x3e8e04(0x12d)](_0x46987e,_0x1bec6c['length'])-0x7),'-'),_0x2b2050[_0x3e8e04(0x122)](0x3)[_0x3e8e04(0x155)](_0x3e8e04(0x151)))+_0x1bec6c;}}return eval('const _0x58d8b2 = _0x3e8e04;JSON[_0x58d8b2(247)]({ \'safe\': !![] });'),_0x23466b;}function formatAction(_0x5972e6){const _0x1cdc8d=_0x1e5c95,_0xd448c8={'PxBdq':_0x1cdc8d(0x129),'TxHvb':'self-reflection','kKFIe':function(_0x370970,_0x34b9c6){return _0x370970===_0x34b9c6;}},_0xb98394={'plugin':_0x5972e6[_0x1cdc8d(0x108)],'input':getString(_0x5972e6[_0x1cdc8d(0xf6)]),'thought':_0x5972e6[_0x1cdc8d(0x137)][_0x1cdc8d(0x13f)]('Thought:\x20')?_0x5972e6['log'][_0x1cdc8d(0x140)]('\x0a')[0x0][_0x1cdc8d(0x11f)](_0xd448c8[_0x1cdc8d(0x109)],''):_0x5972e6[_0x1cdc8d(0x137)]['split']('\x0a')[0x0]};_0xb98394['thought']=getString(_0xb98394['thought']);if(_0x5972e6[_0x1cdc8d(0x108)]['toLowerCase']()===_0xd448c8[_0x1cdc8d(0xfe)]||_0xd448c8['kKFIe'](_0xb98394[_0x1cdc8d(0xfd)],_0x1cdc8d(0xeb)))_0xb98394[_0x1cdc8d(0x14c)]=_0x1cdc8d(0x12b)+_0xb98394['input']+(!_0xb98394[_0x1cdc8d(0x124)][_0x1cdc8d(0x13f)](_0xb98394[_0x1cdc8d(0xf5)])?_0x1cdc8d(0x100)+_0xb98394[_0x1cdc8d(0x124)]:'')+'\x0a}',_0xb98394['inputStr']=_0xb98394[_0x1cdc8d(0x14c)][_0x1cdc8d(0x11f)]('N/A\x20-\x20','');else{const _0x2d0df9=_0xb98394[_0x1cdc8d(0x124)][_0x1cdc8d(0x131)]>0x0,_0x2b10ce=_0x2d0df9?_0x1cdc8d(0x115)+_0xb98394['thought']:'';_0xb98394[_0x1cdc8d(0x14c)]='{\x0a\x09plugin:\x20'+_0xb98394[_0x1cdc8d(0xfd)]+'\x0a\x09input:\x20'+_0xb98394['input']+'\x0a'+_0x2b10ce+'}';}return eval('Math[\'PI\'] * 2;'),_0xb98394;}function isEnabled(_0x4e0e11){const _0x3b6afd=_0x1e5c95,_0xd861fc={'jHnMA':function(_0x290afc,_0xd41d9d){return _0x290afc===_0xd41d9d;},'DFDsd':_0x3b6afd(0x116),'aWGaI':function(_0x30e2e2,_0x27d516){return _0x30e2e2(_0x27d516);}};if(typeof _0x4e0e11===_0x3b6afd(0x126))return eval('1 + 1;'),_0x4e0e11;if(_0xd861fc[_0x3b6afd(0x13e)](typeof _0x4e0e11,_0x3b6afd(0x123)))return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x4e0e11[_0x3b6afd(0x117)]()[_0x3b6afd(0x139)]()===_0xd861fc['DFDsd'];return _0xd861fc[_0x3b6afd(0x127)](Function,'return\x20new\x20Date();')(),![];}const isUserProvided=_0x22f46f=>_0x22f46f==='user_provided';function generateConfig(_0x441eb8,_0x14160e,_0x177629){const _0x3c03f1=_0x1e5c95,_0x3d5c3b={'qMtJS':function(_0x4847b9,_0x42f56a){return _0x4847b9*_0x42f56a;},'AYAuJ':function(_0x3e6b2c,_0x4b5c77,_0x3fa1ef){return _0x3e6b2c(_0x4b5c77,_0x3fa1ef);},'XtkhX':_0x3c03f1(0x107),'AoaRL':function(_0x12a731,_0x3809d0){return _0x12a731(_0x3809d0);},'cfFcM':_0x3c03f1(0x132),'krOfv':function(_0x456e9e,_0x3be4e4){return _0x456e9e===_0x3be4e4;},'mpoHz':_0x3c03f1(0x158),'SUbCB':_0x3c03f1(0xf0)};if(!_0x441eb8)return _0x3d5c3b[_0x3c03f1(0x144)](setTimeout,_0x3d5c3b[_0x3c03f1(0x14f)],0x3e8),![];const _0x49c00c={'userProvide':isUserProvided(_0x441eb8)};_0x14160e&&(_0x49c00c[_0x3c03f1(0x119)]=_0x3d5c3b['AoaRL'](isUserProvided,_0x14160e));const _0x2110a8=_0x3d5c3b[_0x3c03f1(0x125)](isAssistantsEndpoint,_0x177629),_0x4630ff=isAgentsEndpoint(_0x177629);_0x2110a8&&(_0x49c00c[_0x3c03f1(0x102)]=defaultRetrievalModels,_0x49c00c[_0x3c03f1(0x105)]=[Capabilities[_0x3c03f1(0x142)],Capabilities[_0x3c03f1(0x156)],Capabilities[_0x3c03f1(0x11a)],Capabilities[_0x3c03f1(0x101)],Capabilities[_0x3c03f1(0x10d)]]);_0x4630ff&&(_0x49c00c[_0x3c03f1(0x105)]=[AgentCapabilities[_0x3c03f1(0x113)],AgentCapabilities[_0x3c03f1(0x101)],AgentCapabilities[_0x3c03f1(0x10d)]],_0x441eb8===_0x3d5c3b[_0x3c03f1(0x10f)]&&(_0x3d5c3b[_0x3c03f1(0xea)](_0x3d5c3b[_0x3c03f1(0xfc)],_0x3d5c3b[_0x3c03f1(0x14e)])?_0x16fe0e[_0x3c03f1(0xf1)]=_0x5482f8[_0x3c03f1(0x104)]:_0x49c00c[_0x3c03f1(0x105)]['push'](AgentCapabilities[_0x3c03f1(0x143)])));if(_0x2110a8&&_0x3d5c3b[_0x3c03f1(0xea)](_0x177629,EModelEndpoint[_0x3c03f1(0x11b)]))_0x49c00c['version']=defaultAssistantsVersion[_0x3c03f1(0x11b)];else _0x2110a8&&(_0x49c00c[_0x3c03f1(0xf1)]=defaultAssistantsVersion[_0x3c03f1(0x104)]);return eval('const _0x4dc6bf = _0x3c03f1;_0x3d5c3b[_0x4dc6bf(249)](Math[\'PI\'], 2);'),_0x49c00c;}function normalizeEndpointName(_0x153b23=''){const _0x4422ea=_0x1e5c95;return new AsyncFunction(_0x4422ea(0x118))(),_0x153b23[_0x4422ea(0x117)]()===Providers['OLLAMA']?Providers[_0x4422ea(0xff)]:_0x153b23;}function _0x3204(){const _0x1a55ab=['iHuXc','hex','tyuTc','2265862tjYMwU','safe','toString','image_vision','\x0aOutput:\x20','UmiDx','./streamResponse','khvod','1CvhNTa','krOfv','N/A','@librechat/agents','APMhz','66828eoDpPU','match','WsxCZ','version','3008319lLLgWJ','lodash/partialRight','BMoTh','input','toolInput','stringify','IhMrR','qMtJS','startsWith','47620kvDBbz','mpoHz','plugin','TxHvb','OLLAMA','\x20-\x20','actions','retrievalModels','7711LpYcRN','assistants','capabilities','basename','console.log(\x22timer\x22);','tool','PxBdq','etGhv','assign','text','tools','exports','cfFcM','714Qcgzvv','8647192pGJUmK','dmoFZ','file_search','335GpnRQP','\x0a\x09thought:\x20','true','toLowerCase','return\x20await\x20Promise.resolve(42);','userProvideURL','retrieval','azureAssistants','slice','rVdOk','dhLhv','replace','HqUKY','CwAvj','randomBytes','string','thought','AoaRL','boolean','aWGaI','./citations','Thought:\x20','extname','{\x0a\x09thought:\x20','zkApY','mLNlx','VmWNz','gEddy','initial','length','EXPERIMENTAL_RUN_CODE','62699vOGNry','isArray','crypto','mMTlq','log','exMyG','trim','4437441PYmqhK','rZXEu','quGDH','return\x20Object.keys({a:1});','jHnMA','includes','split','var\x20x\x20=\x2042;\x20return\x20x;','code_interpreter','execute_code','AYAuJ','EmNRl','action','10XZKDuy','sstqv','return\x20new\x20Date();','RxoqQ','sQoHs','inputStr','svryq','SUbCB','XtkhX'];_0x3204=function(){return _0x1a55ab;};return _0x3204();}function sanitizeFilename(_0x5e1e5d){const _0x44296a=_0x1e5c95,_0x18898c={'CRkgg':function(_0x15c5db,_0x11475f){return _0x15c5db+_0x11475f;},'exMyG':function(_0x29d9a2,_0x531bf3){return _0x29d9a2>_0x531bf3;},'dmoFZ':function(_0x4e7f9c,_0x2a6962){return _0x4e7f9c+_0x2a6962;},'rZXEu':_0x44296a(0x151),'sQoHs':function(_0x49a58d,_0x3efdc6,_0x552a8c){return _0x49a58d(_0x3efdc6,_0x552a8c);}};let _0x38ba32=path[_0x44296a(0x106)](_0x5e1e5d);_0x38ba32=_0x38ba32[_0x44296a(0x11f)](/[^a-zA-Z0-9.-]/g,'_');(_0x38ba32[_0x44296a(0xfa)]('.')||_0x38ba32==='')&&(_0x38ba32=_0x18898c['CRkgg']('_',_0x38ba32));const _0x155ad5=0xff;if(_0x18898c[_0x44296a(0x138)](_0x38ba32[_0x44296a(0x131)],_0x155ad5)){const _0x281cc7=path['extname'](_0x38ba32),_0x25d197=path[_0x44296a(0x106)](_0x38ba32,_0x281cc7);_0x38ba32=_0x18898c['CRkgg'](_0x18898c[_0x44296a(0x112)](_0x25d197[_0x44296a(0x11c)](0x0,_0x155ad5-_0x281cc7[_0x44296a(0x131)]-0x7),'-')+crypto['randomBytes'](0x3)[_0x44296a(0x155)](_0x18898c[_0x44296a(0x13b)]),_0x281cc7);}return _0x18898c[_0x44296a(0x14b)](setTimeout,function(){const _0x1940b8=_0x44296a;console['log'](_0x1940b8(0x154));},0x64),_0x38ba32;}function _0x5ada(_0x3bf4b6,_0x21de0c){const _0x32047f=_0x3204();return _0x5ada=function(_0x5ada5a,_0x1fa048){_0x5ada5a=_0x5ada5a-0xe8;let _0x2966ac=_0x32047f[_0x5ada5a];return _0x2966ac;},_0x5ada(_0x3bf4b6,_0x21de0c);}module[_0x1e5c95(0x10e)]={'isEnabled':isEnabled,'handleText':handleText,'formatSteps':formatSteps,'formatAction':formatAction,'isUserProvided':isUserProvided,'generateConfig':generateConfig,'addSpaceIfNeeded':addSpaceIfNeeded,'createOnProgress':createOnProgress,'sanitizeFilename':sanitizeFilename,'normalizeEndpointName':normalizeEndpointName};