const _0x35b2e0=_0x5981;function _0x5981(_0x50abb0,_0x548f39){const _0xf455f5=_0xf455();return _0x5981=function(_0x5981a7,_0x1555b5){_0x5981a7=_0x5981a7-0x12f;let _0x1f93f9=_0xf455f5[_0x5981a7];return _0x1f93f9;},_0x5981(_0x50abb0,_0x548f39);}function _0xf455(){const _0x5dd73f=['~/server/services/Files/process','Router','~/server/services/Files/images/avatar','565672UvkArz','fileStrategy','error','5HHNAob','28phFyzp','65914kVYmgG','body','1152873SQYyMK','express','status','263298dmvIzG','1310476ZQjMSy','2651300lKdyIO','post','An\x20error\x20occurred\x20while\x20uploading\x20the\x20profile\x20picture','locals','SMwCy','readFile','file','~/server/services/Files/strategies','304662PxXWuy','app','3RvcZCp','json'];_0xf455=function(){return _0x5dd73f;};return _0xf455();}(function(_0x251378,_0x4c4b57){const _0x9739ca=_0x5981,_0x56a52d=_0x251378();while(!![]){try{const _0x3d1f81=-parseInt(_0x9739ca(0x147))/0x1+-parseInt(_0x9739ca(0x13b))/0x2*(parseInt(_0x9739ca(0x13d))/0x3)+-parseInt(_0x9739ca(0x132))/0x4*(-parseInt(_0x9739ca(0x145))/0x5)+-parseInt(_0x9739ca(0x131))/0x6+-parseInt(_0x9739ca(0x146))/0x7*(parseInt(_0x9739ca(0x142))/0x8)+parseInt(_0x9739ca(0x149))/0x9+parseInt(_0x9739ca(0x133))/0xa;if(_0x3d1f81===_0x4c4b57)break;else _0x56a52d['push'](_0x56a52d['shift']());}catch(_0x84d807){_0x56a52d['push'](_0x56a52d['shift']());}}}(_0xf455,0x2af0a));const fs=require('fs')['promises'],express=require(_0x35b2e0(0x12f)),{getStrategyFunctions}=require(_0x35b2e0(0x13a)),{resizeAvatar}=require(_0x35b2e0(0x141)),{filterFile}=require(_0x35b2e0(0x13f)),{logger}=require('~/config'),router=express[_0x35b2e0(0x140)]();router[_0x35b2e0(0x134)]('/',async(_0x630782,_0x441b38)=>{const _0x35d810=_0x35b2e0,_0x5d45ee={'SMwCy':function(_0x1f765d,_0x3fb566){return _0x1f765d(_0x3fb566);}};try{filterFile({'req':_0x630782,'file':_0x630782[_0x35d810(0x139)],'image':!![],'isAvatar':!![]});const _0x326451=_0x630782['user']['id'],{manual:_0x503bbd}=_0x630782[_0x35d810(0x148)],_0xb9c0c9=await fs[_0x35d810(0x138)](_0x630782['file']['path']);if(!_0x326451)throw new Error('User\x20ID\x20is\x20undefined');const _0x58cb3c=_0x630782[_0x35d810(0x13c)][_0x35d810(0x136)][_0x35d810(0x143)],_0x195779=_0x630782[_0x35d810(0x13c)][_0x35d810(0x136)]['imageOutputType'],_0x15c7f2=await resizeAvatar({'userId':_0x326451,'input':_0xb9c0c9,'desiredFormat':_0x195779}),{processAvatar:_0x3c98b0}=_0x5d45ee[_0x35d810(0x137)](getStrategyFunctions,_0x58cb3c),_0x2d8667=await _0x5d45ee['SMwCy'](_0x3c98b0,{'buffer':_0x15c7f2,'userId':_0x326451,'manual':_0x503bbd});_0x441b38[_0x35d810(0x13e)]({'url':_0x2d8667});}catch(_0x3f230f){const _0x2a00bb=_0x35d810(0x135);logger[_0x35d810(0x144)](_0x2a00bb,_0x3f230f),_0x441b38[_0x35d810(0x130)](0x1f4)[_0x35d810(0x13e)]({'message':_0x2a00bb});}}),module['exports']=router;