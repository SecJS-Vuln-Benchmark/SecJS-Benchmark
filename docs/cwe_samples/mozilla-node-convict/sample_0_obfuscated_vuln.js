const _0x551997=_0xdce1;function _0x4a6d(){const _0x2b9dfe=['findFirst','iqYdv','includes','../utils/prisma','xMqDZ','createdBy','25720NadHjg','stringify','mObnu','680487pdSYsR','FAILED\x20TO\x20CREATE\x20INVITE.','claimed','update','../utils/http','createMany','makeCode','workspaceIds','Could\x20not\x20add\x20user\x20to\x20workspaces\x20automatically','557436NSVEBz','get','claimedBy','31070TKnRsp','KrqDK','ZNxZi','995rXYshs','yPomL','KojFb','1113380rxMcvG','KwxRY','396IhxUBf','invites','count','error','AmqBd','5010AituEZ','84MdGqKu','create','ZNJLt','nqqwN','2zsZnGr','disabled','AzTDX','where','UIanl','vTeyX','exports','vYnle','36sRoMcE','QzaBm','./workspaceUsers','map','filter','findMany','WmBir','message','191542dYiJtP'];_0x4a6d=function(){return _0x2b9dfe;};return _0x4a6d();}function _0xdce1(_0x58748a,_0x342805){const _0x4a6d07=_0x4a6d();return _0xdce1=function(_0xdce1bf,_0x2f5dbf){_0xdce1bf=_0xdce1bf-0xce;let _0xcd4d7f=_0x4a6d07[_0xdce1bf];return _0xcd4d7f;},_0xdce1(_0x58748a,_0x342805);}(function(_0x26c2ef,_0xc57bd3){const _0x27defd=_0xdce1,_0x3b5ee6=_0x26c2ef();while(!![]){try{const _0xb245e8=parseInt(_0x27defd(0xf6))/0x1+-parseInt(_0x27defd(0xe6))/0x2*(parseInt(_0x27defd(0x100))/0x3)+-parseInt(_0x27defd(0xda))/0x4+-parseInt(_0x27defd(0xd7))/0x5*(-parseInt(_0x27defd(0xe1))/0x6)+parseInt(_0x27defd(0xe2))/0x7*(parseInt(_0x27defd(0xfd))/0x8)+-parseInt(_0x27defd(0xdc))/0x9*(-parseInt(_0x27defd(0xd4))/0xa)+parseInt(_0x27defd(0xd1))/0xb*(parseInt(_0x27defd(0xee))/0xc);if(_0xb245e8===_0xc57bd3)break;else _0x3b5ee6['push'](_0x3b5ee6['shift']());}catch(_0xe4b22a){_0x3b5ee6['push'](_0x3b5ee6['shift']());}}}(_0x4a6d,0x2be89));const {safeJsonParse}=require(_0x551997(0x104)),prisma=require(_0x551997(0xfa)),Invite={'makeCode':()=>{const _0x338d48=_0x551997,_0x1b49cf=require('uuid-apikey');return _0x1b49cf[_0x338d48(0xe3)]()['apiKey'];},'create':async function({createdByUserId:createdByUserId=0x0,workspaceIds:workspaceIds=[]}){const _0x12335f=_0x551997,_0x12bb57={'CYbYG':_0x12335f(0x101)};try{const _0x22246b=await prisma[_0x12335f(0xdd)][_0x12335f(0xe3)]({'data':{'code':this[_0x12335f(0xce)](),'createdBy':createdByUserId,'workspaceIds':JSON[_0x12335f(0xfe)](workspaceIds)}});return{'invite':_0x22246b,'error':null};}catch(_0x374c78){return console[_0x12335f(0xdf)](_0x12bb57['CYbYG'],_0x374c78[_0x12335f(0xf5)]),{'invite':null,'error':_0x374c78[_0x12335f(0xf5)]};}},'deactivate':async function(_0x4665db=null){const _0x21a219=_0x551997,_0x2f70fa={'iqYdv':function(_0x514308,_0x177122){return _0x514308===_0x177122;},'QzaBm':_0x21a219(0xe0),'xxgMr':_0x21a219(0xd8),'uoTOh':_0x21a219(0xe7)};try{return _0x2f70fa[_0x21a219(0xf8)](_0x2f70fa[_0x21a219(0xef)],_0x2f70fa['xxgMr'])?(_0x5c0581[_0x21a219(0xdf)](_0x31eee4[_0x21a219(0xf5)]),[]):(await prisma[_0x21a219(0xdd)]['update']({'where':{'id':Number(_0x4665db)},'data':{'status':_0x2f70fa['uoTOh']}}),{'success':!![],'error':null});}catch(_0x379740){return console[_0x21a219(0xdf)](_0x379740[_0x21a219(0xf5)]),{'success':![],'error':_0x379740[_0x21a219(0xf5)]};}},'markClaimed':async function(_0xd8f5da=null,_0x32e23c){const _0x27bb61=_0x551997,_0x1a56ca={'UIanl':_0x27bb61(0x102),'ZNxZi':'./workspace'};try{const _0x2e50ba=await prisma['invites'][_0x27bb61(0x103)]({'where':{'id':Number(_0xd8f5da)},'data':{'status':_0x1a56ca[_0x27bb61(0xea)],'claimedBy':_0x32e23c['id']}});try{if(!!_0x2e50ba?.[_0x27bb61(0xcf)]){const {Workspace:_0x3a511c}=require(_0x1a56ca[_0x27bb61(0xd6)]),{WorkspaceUser:_0xf2db37}=require(_0x27bb61(0xf0)),_0x2e8d37=(await _0x3a511c[_0x27bb61(0xe9)]({}))['map'](_0x2cdeab=>_0x2cdeab['id']),_0xd1e128=safeJsonParse(_0x2e50ba[_0x27bb61(0xcf)])[_0x27bb61(0xf1)](_0x37af7a=>Number(_0x37af7a))[_0x27bb61(0xf2)](_0x30ae6c=>_0x2e8d37[_0x27bb61(0xf9)](_0x30ae6c));if(_0xd1e128['length']!==0x0)await _0xf2db37[_0x27bb61(0x105)](_0x32e23c['id'],_0xd1e128);}}catch(_0x503362){console[_0x27bb61(0xdf)](_0x27bb61(0xd0),_0x503362[_0x27bb61(0xf5)]);}return{'success':!![],'error':null};}catch(_0x5390dc){return console['error'](_0x5390dc['message']),{'success':![],'error':_0x5390dc[_0x27bb61(0xf5)]};}},'get':async function(_0x4516a0={}){const _0x11aed1=_0x551997;try{const _0x3c6862=await prisma['invites'][_0x11aed1(0xf7)]({'where':_0x4516a0});return _0x3c6862||null;}catch(_0xdbc9d9){return console[_0x11aed1(0xdf)](_0xdbc9d9[_0x11aed1(0xf5)]),null;}},'count':async function(_0x56b19f={}){const _0x4f4347=_0x551997,_0x9f1859={'nqqwN':function(_0x4b1d51,_0x34a796){return _0x4b1d51===_0x34a796;},'KrqDK':'KwxRY'};try{if(_0x4f4347(0xf4)===_0x4f4347(0xff))return _0x2f9188[_0x4f4347(0xdf)](_0x3a0c10[_0x4f4347(0xf5)]),[];else{const _0x14d649=await prisma['invites'][_0x4f4347(0xde)]({'where':_0x56b19f});return _0x14d649;}}catch(_0x234080){return _0x9f1859[_0x4f4347(0xe5)](_0x9f1859[_0x4f4347(0xd5)],_0x4f4347(0xdb))?(console['error'](_0x234080[_0x4f4347(0xf5)]),0x0):(_0x25fbf8[_0x4f4347(0xdf)](_0x23aad2['message']),![]);}},'delete':async function(_0x2087c8={}){const _0x494ea4=_0x551997;try{return await prisma[_0x494ea4(0xdd)]['deleteMany']({'where':_0x2087c8}),!![];}catch(_0x3a457b){return console[_0x494ea4(0xdf)](_0x3a457b[_0x494ea4(0xf5)]),![];}},'where':async function(_0x3581d7={},_0x562eef){const _0x3d3b88=_0x551997,_0x519c05={'mgZDh':function(_0x4eb5e8,_0xe3446f){return _0x4eb5e8===_0xe3446f;},'vTeyX':'xMqDZ'};try{const _0x49b245=await prisma[_0x3d3b88(0xdd)][_0x3d3b88(0xf3)]({'where':_0x3581d7,'take':_0x562eef||undefined});return _0x49b245;}catch(_0x28e28d){return _0x519c05['mgZDh'](_0x3d3b88(0xfb),_0x519c05[_0x3d3b88(0xeb)])?(console[_0x3d3b88(0xdf)](_0x28e28d[_0x3d3b88(0xf5)]),[]):(_0x570811[_0x3d3b88(0xdf)](_0x3d3b88(0x101),_0x212c6b[_0x3d3b88(0xf5)]),{'invite':null,'error':_0xa67aa9[_0x3d3b88(0xf5)]});}},'whereWithUsers':async function(_0x27aa80={},_0xee1381){const _0x5fe968=_0x551997,_0x4629ce={'AzTDX':'./user','KojFb':_0x5fe968(0xe4)},{User:_0x5722c3}=require(_0x4629ce[_0x5fe968(0xe8)]);try{const _0x5b42b0=await this['where'](_0x27aa80,_0xee1381);for(const _0x2ca2bc of _0x5b42b0){if(_0x2ca2bc[_0x5fe968(0xd3)]){const _0x521411=await _0x5722c3[_0x5fe968(0xd2)]({'id':_0x2ca2bc[_0x5fe968(0xd3)]});_0x2ca2bc['claimedBy']={'id':_0x521411?.['id'],'username':_0x521411?.['username']};}if(_0x2ca2bc['createdBy']){if(_0x4629ce[_0x5fe968(0xd9)]!==_0x5fe968(0xed)){const _0xb16741=await _0x5722c3['get']({'id':_0x2ca2bc[_0x5fe968(0xfc)]});_0x2ca2bc[_0x5fe968(0xfc)]={'id':_0xb16741?.['id'],'username':_0xb16741?.['username']};}else return _0x43890c[_0x5fe968(0xdf)](_0x4a2575['message']),0x0;}}return _0x5b42b0;}catch(_0x29452b){return console[_0x5fe968(0xdf)](_0x29452b[_0x5fe968(0xf5)]),[];}}};module[_0x551997(0xec)]={'Invite':Invite};