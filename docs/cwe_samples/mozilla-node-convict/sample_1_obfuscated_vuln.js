const _0x5d6c35=_0x5ea0;(function(_0x36a513,_0x160ce9){const _0x1d6762=_0x5ea0,_0x22dedc=_0x36a513();while(!![]){try{const _0x39dfb9=parseInt(_0x1d6762(0x176))/0x1+parseInt(_0x1d6762(0x137))/0x2+parseInt(_0x1d6762(0x159))/0x3+parseInt(_0x1d6762(0x149))/0x4*(-parseInt(_0x1d6762(0x134))/0x5)+parseInt(_0x1d6762(0x16f))/0x6+-parseInt(_0x1d6762(0x157))/0x7*(-parseInt(_0x1d6762(0x153))/0x8)+parseInt(_0x1d6762(0x133))/0x9*(-parseInt(_0x1d6762(0x14f))/0xa);if(_0x39dfb9===_0x160ce9)break;else _0x22dedc['push'](_0x22dedc['shift']());}catch(_0x205491){_0x22dedc['push'](_0x22dedc['shift']());}}}(_0x52da,0xe8cfe));function _0x5ea0(_0x429322,_0x24d090){const _0x52da45=_0x52da();return _0x5ea0=function(_0x5ea05d,_0x536736){_0x5ea05d=_0x5ea05d-0x130;let _0x162232=_0x52da45[_0x5ea05d];return _0x162232;},_0x5ea0(_0x429322,_0x24d090);}const prisma=require('../utils/prisma'),{EventLogs}=require(_0x5d6c35(0x15f)),User={'writable':[_0x5d6c35(0x15e),_0x5d6c35(0x146),_0x5d6c35(0x145),_0x5d6c35(0x160),_0x5d6c35(0x147)],'validations':{'username':(_0x41e904='')=>{const _0x5c4cf9=_0x5d6c35,_0x3400f8={'gbFjG':function(_0x2218ba,_0x1e1599){return _0x2218ba(_0x1e1599);},'fsaTg':'Username\x20must\x20be\x20at\x20least\x202\x20characters'};try{if(_0x3400f8[_0x5c4cf9(0x13a)](String,_0x41e904)[_0x5c4cf9(0x14d)]>0x64)throw new Error('Username\x20cannot\x20be\x20longer\x20than\x20100\x20characters');if(_0x3400f8[_0x5c4cf9(0x13a)](String,_0x41e904)['length']<0x2)throw new Error(_0x3400f8[_0x5c4cf9(0x171)]);return _0x3400f8[_0x5c4cf9(0x13a)](String,_0x41e904);}catch(_0x2e8826){throw new Error(_0x2e8826['message']);}}},'castColumnValue':function(_0x23c1e8,_0x12fca2){const _0x38174d=_0x5d6c35,_0xd51523={'wsXfF':function(_0xcfa049,_0x35b2e2){return _0xcfa049(_0x35b2e2);}};switch(_0x23c1e8){case _0x38174d(0x147):return Number(_0xd51523[_0x38174d(0x173)](Boolean,_0x12fca2));default:return _0xd51523[_0x38174d(0x173)](String,_0x12fca2);}},'filterFields':function(_0x4419fb={}){const {password:_0x27e8ae,..._0x417ed0}=_0x4419fb;return{..._0x417ed0};},'create':async function({username:_0x383d6d,password:_0x2b00ec,role:role='default'}){const _0x2a44bc=_0x5d6c35,_0x4c963a={'yvuMQ':_0x2a44bc(0x142)},_0x41ec53=this[_0x2a44bc(0x158)](_0x2b00ec);if(!_0x41ec53[_0x2a44bc(0x143)])return{'user':null,'error':_0x41ec53[_0x2a44bc(0x162)]};try{const _0xa93c99=require(_0x4c963a[_0x2a44bc(0x150)]),_0x5d50ee=_0xa93c99[_0x2a44bc(0x167)](_0x2b00ec,0xa),_0x5c5601=await prisma['users']['create']({'data':{'username':this['validations'][_0x2a44bc(0x15e)](_0x383d6d),'password':_0x5d50ee,'role':String(role)}});return{'user':this['filterFields'](_0x5c5601),'error':null};}catch(_0x5a8101){return console[_0x2a44bc(0x162)](_0x2a44bc(0x14c),_0x5a8101[_0x2a44bc(0x16e)]),{'user':null,'error':_0x5a8101[_0x2a44bc(0x16e)]};}},'loggedChanges':function(_0x5153e9,_0x11284f={}){const _0x1e4712=_0x5d6c35,_0x155a6a={'MXgLE':function(_0xcda077,_0x2d84e8){return _0xcda077!==_0x2d84e8;}},_0xd3950d={},_0xe7fe54=[_0x1e4712(0x146)];return Object[_0x1e4712(0x165)](_0x5153e9)[_0x1e4712(0x15a)](_0x52791b=>{const _0x2fe33c=_0x1e4712;!_0xe7fe54[_0x2fe33c(0x148)](_0x52791b)&&_0x155a6a[_0x2fe33c(0x166)](_0x5153e9[_0x52791b],_0x11284f[_0x52791b])&&(_0xd3950d[_0x52791b]=_0x11284f[_0x52791b]+_0x2fe33c(0x144)+_0x5153e9[_0x52791b]);}),_0xd3950d;},'update':async function(_0x7e63bf,_0x72a7c6={}){const _0x2d44db=_0x5d6c35,_0x5062e5={'SyzCS':'No\x20user\x20id\x20provided\x20for\x20update','aLnFC':function(_0x4bd14b,_0x9fcacc){return _0x4bd14b===_0x9fcacc;},'kPDIX':'No\x20valid\x20updates\x20applied.','hBHlx':'password','eDpoN':_0x2d44db(0x142)};try{if(!_0x7e63bf)throw new Error(_0x5062e5[_0x2d44db(0x141)]);const _0x4b8f25=await prisma[_0x2d44db(0x131)][_0x2d44db(0x138)]({'where':{'id':parseInt(_0x7e63bf)}});if(!_0x4b8f25)return{'success':![],'error':_0x2d44db(0x152)};Object['entries'](_0x72a7c6)[_0x2d44db(0x15a)](([_0x3031fa,_0x311336])=>{const _0x45d70b=_0x2d44db;if(this[_0x45d70b(0x139)][_0x45d70b(0x148)](_0x3031fa)){this['validations'][_0x45d70b(0x16d)](_0x3031fa)?_0x72a7c6[_0x3031fa]=this['validations'][_0x3031fa](this[_0x45d70b(0x161)](_0x3031fa,_0x311336)):_0x72a7c6[_0x3031fa]=this['castColumnValue'](_0x3031fa,_0x311336);return;}delete _0x72a7c6[_0x3031fa];});if(_0x5062e5['aLnFC'](Object[_0x2d44db(0x165)](_0x72a7c6)[_0x2d44db(0x14d)],0x0))return{'success':![],'error':_0x5062e5[_0x2d44db(0x132)]};if(_0x72a7c6[_0x2d44db(0x16d)](_0x5062e5[_0x2d44db(0x174)])){const _0x37f2b0=this[_0x2d44db(0x158)](_0x72a7c6['password']);if(!_0x37f2b0[_0x2d44db(0x143)])return{'success':![],'error':_0x37f2b0[_0x2d44db(0x162)]};const _0x149831=require(_0x5062e5['eDpoN']);_0x72a7c6[_0x2d44db(0x146)]=_0x149831[_0x2d44db(0x167)](_0x72a7c6[_0x2d44db(0x146)],0xa);}const _0x4e6603=await prisma[_0x2d44db(0x131)]['update']({'where':{'id':parseInt(_0x7e63bf)},'data':_0x72a7c6});return await EventLogs[_0x2d44db(0x154)](_0x2d44db(0x168),{'username':_0x4e6603[_0x2d44db(0x15e)],'changes':this['loggedChanges'](_0x72a7c6,_0x4b8f25)},_0x7e63bf),{'success':!![],'error':null};}catch(_0x38fa93){return console['error'](_0x38fa93[_0x2d44db(0x16e)]),{'success':![],'error':_0x38fa93[_0x2d44db(0x16e)]};}},'_update':async function(_0xc94793=null,_0x5b07d6={}){const _0x7ee1b8=_0x5d6c35;if(!_0xc94793)throw new Error(_0x7ee1b8(0x16c));try{const _0x32a1a7=await prisma[_0x7ee1b8(0x131)][_0x7ee1b8(0x175)]({'where':{'id':_0xc94793},'data':_0x5b07d6});return{'user':_0x32a1a7,'message':null};}catch(_0x100feb){return console[_0x7ee1b8(0x162)](_0x100feb[_0x7ee1b8(0x16e)]),{'user':null,'message':_0x100feb[_0x7ee1b8(0x16e)]};}},'get':async function(_0x59ce81={}){const _0x10a9d7=_0x5d6c35;try{const _0x470f7c=await prisma['users']['findFirst']({'where':_0x59ce81});return _0x470f7c?this[_0x10a9d7(0x14e)]({..._0x470f7c}):null;}catch(_0x43077e){return console[_0x10a9d7(0x162)](_0x43077e[_0x10a9d7(0x16e)]),null;}},'_get':async function(_0x3e758b={}){const _0x481b68=_0x5d6c35,_0x5e6515={'dbUvp':_0x481b68(0x13e),'tTcHD':_0x481b68(0x136)};try{const _0xe0fde9=await prisma[_0x481b68(0x131)][_0x481b68(0x156)]({'where':_0x3e758b});return _0xe0fde9?{..._0xe0fde9}:null;}catch(_0x398ee0){return _0x5e6515[_0x481b68(0x14a)]===_0x5e6515[_0x481b68(0x13b)]?(_0x46c375[_0x481b68(0x162)](_0x5754b4[_0x481b68(0x16e)]),{'success':![],'error':_0x2d3778[_0x481b68(0x16e)]}):(console['error'](_0x398ee0['message']),null);}},'count':async function(_0x16ecd9={}){const _0xf539e7=_0x5d6c35,_0x53e7ea={'HmYur':function(_0x574e21,_0x433ca6){return _0x574e21!==_0x433ca6;}};try{if(_0x53e7ea['HmYur']('NRxwL',_0xf539e7(0x140)))return _0x44b0ed[_0xf539e7(0x162)](_0x3921e1['message']),{'user':null,'message':_0x20dde8[_0xf539e7(0x16e)]};else{const _0x20e31a=await prisma[_0xf539e7(0x131)][_0xf539e7(0x163)]({'where':_0x16ecd9});return _0x20e31a;}}catch(_0x391687){return console[_0xf539e7(0x162)](_0x391687['message']),0x0;}},'delete':async function(_0x2cd559={}){const _0x37a3e0=_0x5d6c35;try{return await prisma[_0x37a3e0(0x131)][_0x37a3e0(0x15d)]({'where':_0x2cd559}),!![];}catch(_0x40f4c6){return console[_0x37a3e0(0x162)](_0x40f4c6[_0x37a3e0(0x16e)]),![];}},'where':async function(_0x383d9f={},_0x43925b=null){const _0x187470=_0x5d6c35,_0x53d468={'duQDO':function(_0x4dc68,_0x28a94b){return _0x4dc68!==_0x28a94b;}};try{const _0x16f826=await prisma[_0x187470(0x131)][_0x187470(0x14b)]({'where':_0x383d9f,..._0x53d468[_0x187470(0x170)](_0x43925b,null)?{'take':_0x43925b}:{}});return _0x16f826[_0x187470(0x15c)](_0x2cbeb5=>this[_0x187470(0x14e)](_0x2cbeb5));}catch(_0xb525a){return console[_0x187470(0x162)](_0xb525a[_0x187470(0x16e)]),[];}},'checkPasswordComplexity':function(_0x25ae26=''){const _0x447d3c=_0x5d6c35,_0x24900c={'WhMBV':_0x447d3c(0x146),'OJWEH':_0x447d3c(0x162),'eGThI':function(_0x401302,_0x2c2db3){return _0x401302+_0x2c2db3;},'rDnKa':'No\x20error.'},_0x1b9df5=require(_0x447d3c(0x13c)),_0x274db0={'min':process['env']['PASSWORDMINCHAR']||0x8,'max':process[_0x447d3c(0x172)]['PASSWORDMAXCHAR']||0xfa,'lowerCase':process['env'][_0x447d3c(0x15b)]||0x0,'upperCase':process[_0x447d3c(0x172)][_0x447d3c(0x13f)]||0x0,'numeric':process[_0x447d3c(0x172)][_0x447d3c(0x135)]||0x0,'symbol':process['env'][_0x447d3c(0x130)]||0x0,'requirementCount':process[_0x447d3c(0x172)]['PASSWORDREQUIREMENTS']||0x0},_0x2e59d1=_0x1b9df5(_0x274db0,_0x24900c[_0x447d3c(0x13d)])[_0x447d3c(0x164)](_0x25ae26);if(_0x2e59d1[_0x447d3c(0x16d)](_0x24900c[_0x447d3c(0x16a)])){let _0x543ce4='',_0x415cf3='';for(let _0x4e546c=0x0;_0x4e546c<_0x2e59d1['error'][_0x447d3c(0x151)][_0x447d3c(0x14d)];_0x4e546c++){_0x543ce4+=_0x24900c[_0x447d3c(0x16b)](_0x415cf3,_0x2e59d1[_0x447d3c(0x162)][_0x447d3c(0x151)][_0x4e546c][_0x447d3c(0x16e)]),_0x415cf3=',\x20';}return{'checkedOK':![],'error':_0x543ce4};}return{'checkedOK':!![],'error':_0x24900c[_0x447d3c(0x169)]};}};function _0x52da(){const _0x30f1c5=['length','filterFields','10UfUeul','yvuMQ','details','User\x20not\x20found','70168rCVYrJ','logEvent','exports','findFirst','1148QRsSIh','checkPasswordComplexity','4700730dDqeeb','forEach','PASSWORDLOWERCASE','map','deleteMany','username','./eventLogs','role','castColumnValue','error','count','validate','keys','MXgLE','hashSync','user_updated','rDnKa','OJWEH','eGThI','No\x20user\x20id\x20provided\x20for\x20update','hasOwnProperty','message','2504718xsZnpc','duQDO','fsaTg','env','wsXfF','hBHlx','update','1340003MxiEhG','PASSWORDSYMBOL','users','kPDIX','38516715FBOvEr','5wJOTeR','PASSWORDNUMERIC','flhiH','1146252qjoWzL','findUnique','writable','gbFjG','tTcHD','joi-password-complexity','WhMBV','kPGMB','PASSWORDUPPERCASE','NRxwL','SyzCS','bcrypt','checkedOK','\x20=>\x20','pfpFilename','password','suspended','includes','410812YdiNkq','dbUvp','findMany','FAILED\x20TO\x20CREATE\x20USER.'];_0x52da=function(){return _0x30f1c5;};return _0x52da();}module[_0x5d6c35(0x155)]={'User':User};