const _0x22ec0e=_0x26b4;function _0x8867(){const _0x10ae0a=['chrome','exit','status','Chromium\x20not\x20found,\x20please\x20specify\x20Chromium\x20executable\x20path\x20in\x20the\x20settings\x20page.','ombbJ','LOCALAPPDATA','154dOoYuy','hISMN','exports','request','includes','HBjCg','/usr/bin/chromium','xPhIB','3011988LhioWV','FGFtJ','../../src/util','TzPYk','#playwright_chromium','newPage','ProgramFiles(x86)','close','Chromium','chromium','41421mEYojV','uWFYp','linux','platform','screenshotDir','DClVo','sync','Crfgf','check','google-chrome','czGOE','FIvwR','lWUgb','/snap/bin/chromium','bnTeW','log','863631figNIi','RSrhB','../database','push','96649LAUNxA','toLocaleLowerCase','Installed\x20Chromium','iJdGf','apt\x20update\x20&&\x20apt\x20--yes\x20--no-install-recommends\x20install\x20chromium\x20fonts-indic\x20fonts-noto\x20fonts-noto-cjk','Vcamq','args','PBcyI','LyhRH','xEwXf','muhyv','tTZzn','nLDOT','SgLZk','\x5cGoogle\x5cChrome\x5cApplication\x5cchrome.exe','protocol','eEhNT','responseEnd','child_process','2283828krSemr','playwright-core','sign','XMpjx','eZNvt','exec','execSync','FFcUN','GyPlr','join','/Applications/Google\x20Chrome.app/Contents/MacOS/Google\x20Chrome','55GysotQ','fromCharCode','XEonr','win32','message','goto','NYVLd','hDHGg','name','688IGGEPA','Installing\x20Chromium,\x20please\x20wait...','chromeExecutable','ZMDSf','msg','string','Testing\x20Chromium\x20executable:\x20','darwin','apt\x20install\x20chromium\x20exited\x20with\x20code\x20','PROGRAMFILES','Invalid\x20url\x20protocol,\x20only\x20http\x20and\x20https\x20are\x20allowed.','mbYki','.png','5751090ZCoCkZ','jWaQK','command-exists','Installing\x20Chromium...','timing','http:','409900AUDsOb','cnJpR','newContext','get','mwQEc','addJQ','UPTIME_KUMA_ALLOW_ALL_CHROME_EXEC','allow-all-chrome-exec','9lsOcHS','toString','./monitor-type','ping','/Applications/Chromium.app/Contents/MacOS/Chromium','../config','\x5cChromium\x5cApplication\x5cchrome.exe','rUcaj','version','url','env','iIXFl','wHZyL','SPwSK','networkidle','https:','/usr/bin/google-chrome','OIjnp','rYoPk','info','170qtfrrE','ldFeX','jwtSecret','launch','KSFyg'];_0x8867=function(){return _0x10ae0a;};return _0x8867();}(function(_0x165810,_0x52d6c2){const _0x5f5db1=_0x26b4,_0x3d2773=_0x165810();while(!![]){try{const _0x342cca=parseInt(_0x5f5db1(0x1de))/0x1+parseInt(_0x5f5db1(0x1b1))/0x2*(parseInt(_0x5f5db1(0x1ce))/0x3)+parseInt(_0x5f5db1(0x21c))/0x4*(parseInt(_0x5f5db1(0x200))/0x5)+-parseInt(_0x5f5db1(0x1c4))/0x6+parseInt(_0x5f5db1(0x1e2))/0x7*(parseInt(_0x5f5db1(0x209))/0x8)+parseInt(_0x5f5db1(0x224))/0x9*(-parseInt(_0x5f5db1(0x216))/0xa)+parseInt(_0x5f5db1(0x1bc))/0xb*(-parseInt(_0x5f5db1(0x1f5))/0xc);if(_0x342cca===_0x52d6c2)break;else _0x3d2773['push'](_0x3d2773['shift']());}catch(_0x28a529){_0x3d2773['push'](_0x3d2773['shift']());}}}(_0x8867,0x94fe8));const {MonitorType}=require(_0x22ec0e(0x226)),{chromium}=require(_0x22ec0e(0x1f6)),{UP,log}=require(_0x22ec0e(0x1c6)),{Settings}=require('../settings'),commandExistsSync=require(_0x22ec0e(0x218))[_0x22ec0e(0x1d4)],childProcess=require(_0x22ec0e(0x1f4)),path=require('path'),Database=require(_0x22ec0e(0x1e0)),jwt=require('jsonwebtoken'),config=require(_0x22ec0e(0x1a2));let browser=null,allowedList=[],lastAutoDetectChromeExecutable=null;if(process['platform']===_0x22ec0e(0x203)){allowedList[_0x22ec0e(0x1e1)](process[_0x22ec0e(0x1a7)][_0x22ec0e(0x1bb)]+_0x22ec0e(0x1f0)),allowedList[_0x22ec0e(0x1e1)](process[_0x22ec0e(0x1a7)][_0x22ec0e(0x212)]+_0x22ec0e(0x1f0)),allowedList[_0x22ec0e(0x1e1)](process[_0x22ec0e(0x1a7)][_0x22ec0e(0x1ca)]+_0x22ec0e(0x1f0)),allowedList[_0x22ec0e(0x1e1)](process[_0x22ec0e(0x1a7)]['LOCALAPPDATA']+_0x22ec0e(0x1a3)),allowedList[_0x22ec0e(0x1e1)](process[_0x22ec0e(0x1a7)][_0x22ec0e(0x212)]+_0x22ec0e(0x1a3)),allowedList[_0x22ec0e(0x1e1)](process['env'][_0x22ec0e(0x1ca)]+_0x22ec0e(0x1a3));for(let i=0x41;i<=0x5a;i++){let drive=String[_0x22ec0e(0x201)](i);allowedList[_0x22ec0e(0x1e1)](drive+':\x5cProgram\x20Files\x5cGoogle\x5cChrome\x5cApplication\x5cchrome.exe'),allowedList[_0x22ec0e(0x1e1)](drive+':\x5cProgram\x20Files\x20(x86)\x5cGoogle\x5cChrome\x5cApplication\x5cchrome.exe');}}else{if(process[_0x22ec0e(0x1d1)]===_0x22ec0e(0x1d0))allowedList=[_0x22ec0e(0x1cd),'chromium-browser',_0x22ec0e(0x1d7),_0x22ec0e(0x1c2),'/usr/bin/chromium-browser',_0x22ec0e(0x1ad),_0x22ec0e(0x1db)];else process[_0x22ec0e(0x1d1)]===_0x22ec0e(0x210)&&(allowedList=[_0x22ec0e(0x1ff),_0x22ec0e(0x1a1)]);}log['debug'](_0x22ec0e(0x1b6),allowedList);async function isAllowedChromeExecutable(_0x24d781){const _0x1666c4=_0x22ec0e;console[_0x1666c4(0x1dd)](config[_0x1666c4(0x1e8)]);if(config['args'][_0x1666c4(0x223)]||process['env'][_0x1666c4(0x222)]==='1')return!![];return allowedList[_0x1666c4(0x1c0)](_0x24d781);}async function getBrowser(){const _0x3ef8bf=_0x22ec0e,_0x32b0c3={'addJQ':function(_0x392606,_0x95402){return _0x392606(_0x95402);}};if(browser&&browser['isConnected']())return'RSrhB'===_0x3ef8bf(0x1df)?browser:_0x34829d;else{let _0x45afd7=await Settings[_0x3ef8bf(0x21f)](_0x3ef8bf(0x20b));return _0x45afd7=await _0x32b0c3[_0x3ef8bf(0x221)](prepareChromeExecutable,_0x45afd7),browser=await chromium[_0x3ef8bf(0x1b4)]({'executablePath':_0x45afd7}),browser;}}async function prepareChromeExecutable(_0x4dec97){const _0x4cad1f=_0x22ec0e,_0x3526bc={'mwQEc':'Chromium','bnTeW':function(_0x379930,_0x421549){return _0x379930+_0x421549;},'rUcaj':_0x4cad1f(0x211),'ZMDSf':function(_0x2bf43c,_0x1fd7f6){return _0x2bf43c===_0x1fd7f6;},'FIvwR':_0x4cad1f(0x1e4),'jWaQK':'utf8','PBcyI':function(_0xf60e5f,_0x4ea9a3){return _0xf60e5f+_0x4ea9a3;},'muhyv':'Chromium\x20version:\x20','LyhRH':function(_0x39e18a){return _0x39e18a();},'cnJpR':function(_0x15b3b7,_0x1c1f8d){return _0x15b3b7(_0x1c1f8d);},'xtXLJ':_0x4cad1f(0x20a),'eEhNT':_0x4cad1f(0x219),'ombbJ':_0x4cad1f(0x20e),'GgZqL':function(_0x143718,_0x44a511){return _0x143718===_0x44a511;},'CZxfb':_0x4cad1f(0x1c8),'crECI':function(_0x12f5b2,_0x1bdc49){return _0x12f5b2!==_0x1bdc49;},'GyPlr':'qrqrd','rYoPk':_0x4cad1f(0x1c1),'Vlssx':_0x4cad1f(0x1c2),'XJkOc':function(_0x53659d,_0x2686b3){return _0x53659d(_0x2686b3);},'iIXFl':_0x4cad1f(0x1d3),'Crfgf':'This\x20Chromium\x20executable\x20path\x20is\x20not\x20allowed\x20by\x20default.\x20If\x20you\x20are\x20sure\x20this\x20is\x20safe,\x20please\x20add\x20an\x20environment\x20variable\x20UPTIME_KUMA_ALLOW_ALL_CHROME_EXEC=1\x20to\x20allow\x20it.'};if(typeof _0x4dec97===_0x3526bc[_0x4cad1f(0x1ba)]&&_0x3526bc['GgZqL'](_0x4dec97[_0x4cad1f(0x1e3)](),_0x3526bc['CZxfb']))_0x4dec97=undefined;else{if(!_0x4dec97){if(_0x3526bc['crECI'](_0x3526bc[_0x4cad1f(0x1fd)],_0x3526bc[_0x4cad1f(0x1af)]))process[_0x4cad1f(0x1a7)]['UPTIME_KUMA_IS_CONTAINER']?(_0x4dec97=_0x3526bc['Vlssx'],!_0x3526bc['cnJpR'](commandExistsSync,_0x4dec97)&&await new Promise((_0xaec55a,_0x223652)=>{const _0x423333=_0x4cad1f;log[_0x423333(0x1b0)](_0x423333(0x1cc),_0x3526bc[_0x423333(0x1f2)]);let _0x4e880f=childProcess[_0x423333(0x1fa)](_0x423333(0x1e6));_0x4e880f['on'](_0x423333(0x1b7),_0x1f1256=>{const _0x31e3cb=_0x423333;log[_0x31e3cb(0x1b0)](_0x3526bc[_0x31e3cb(0x220)],_0x3526bc[_0x31e3cb(0x1dc)](_0x3526bc[_0x31e3cb(0x1a4)],_0x1f1256));if(_0x3526bc[_0x31e3cb(0x20c)](_0x1f1256,0x0)){log[_0x31e3cb(0x1b0)](_0x3526bc[_0x31e3cb(0x220)],_0x3526bc[_0x31e3cb(0x1d9)]);let _0xb4d078=childProcess[_0x31e3cb(0x1fb)](_0x4dec97+'\x20--version')[_0x31e3cb(0x225)](_0x3526bc[_0x31e3cb(0x217)]);log['info'](_0x31e3cb(0x1cc),_0x3526bc[_0x31e3cb(0x1e9)](_0x3526bc[_0x31e3cb(0x1ec)],_0xb4d078)),_0x3526bc[_0x31e3cb(0x1ea)](_0xaec55a);}else _0x3526bc[_0x31e3cb(0x20c)](_0x1f1256,0x64)?_0x3526bc[_0x31e3cb(0x21d)](_0x223652,new Error(_0x3526bc['xtXLJ'])):_0x223652(new Error(_0x3526bc[_0x31e3cb(0x1e9)]('apt\x20install\x20chromium\x20failed\x20with\x20code\x20',_0x1f1256)));});})):_0x4dec97=findChrome(allowedList);else throw new _0x580079(_0x12f65e[_0x4cad1f(0x204)]);}else{if(!await _0x3526bc['XJkOc'](isAllowedChromeExecutable,_0x4dec97)){if(_0x3526bc[_0x4cad1f(0x20c)](_0x3526bc['iIXFl'],_0x3526bc[_0x4cad1f(0x1a8)]))throw new Error(_0x3526bc[_0x4cad1f(0x1d5)]);else return!![];}}}return _0x4dec97;}function findChrome(_0x529c45){const _0xa5de7f=_0x22ec0e,_0x51b982={'SPwSK':_0xa5de7f(0x223),'XMpjx':function(_0x3fd4c7,_0x228408){return _0x3fd4c7===_0x228408;},'mbYki':_0xa5de7f(0x1c5),'nLDOT':function(_0x53eded,_0x142bc1){return _0x53eded(_0x142bc1);},'pvCZU':function(_0x137a2b,_0x3d6522){return _0x137a2b===_0x3d6522;},'wHZyL':_0xa5de7f(0x1c3),'SgLZk':_0xa5de7f(0x1b9)};if(lastAutoDetectChromeExecutable){if(commandExistsSync(lastAutoDetectChromeExecutable)){if(_0x51b982[_0xa5de7f(0x214)]!==_0x51b982['mbYki']){_0x5ea461[_0xa5de7f(0x1b8)]=_0x4cbdc7,_0x4109a3[_0xa5de7f(0x20d)]=_0x18bd6d['status']();const _0x3398cf=_0x3c32b7[_0xa5de7f(0x1bf)]()['timing']();_0x4f348d[_0xa5de7f(0x227)]=_0x3398cf['responseEnd'];}else return lastAutoDetectChromeExecutable;}}for(let _0x153f1e of _0x529c45){if(_0x51b982[_0xa5de7f(0x1ee)](commandExistsSync,_0x153f1e)){if(_0x51b982['pvCZU'](_0x51b982[_0xa5de7f(0x1a9)],_0xa5de7f(0x1b5))){_0xf2e014[_0xa5de7f(0x1dd)](_0x5c5165[_0xa5de7f(0x1e8)]);if(_0x491eac[_0xa5de7f(0x1e8)][_0x51b982[_0xa5de7f(0x1aa)]]||_0x51b982[_0xa5de7f(0x1f8)](_0x296f16[_0xa5de7f(0x1a7)]['UPTIME_KUMA_ALLOW_ALL_CHROME_EXEC'],'1'))return!![];return _0x3c6183[_0xa5de7f(0x1c0)](_0x429968);}else return lastAutoDetectChromeExecutable=_0x153f1e,_0x153f1e;}}throw new Error(_0x51b982[_0xa5de7f(0x1ef)]);}async function resetChrome(){const _0x195394=_0x22ec0e;browser&&(await browser[_0x195394(0x1cb)](),browser=null);}function _0x26b4(_0x108187,_0x381ae3){const _0x8867a3=_0x8867();return _0x26b4=function(_0x26b4e7,_0x1e9708){_0x26b4e7=_0x26b4e7-0x1a1;let _0x4172b4=_0x8867a3[_0x26b4e7];return _0x4172b4;},_0x26b4(_0x108187,_0x381ae3);}async function testChrome(_0x4879bb){const _0x1595de=_0x22ec0e,_0x222bfa={'tTZzn':function(_0xf8021,_0x3aa14a){return _0xf8021(_0x3aa14a);},'gFWWC':function(_0x3c8356,_0x1c5b12){return _0x3c8356===_0x1c5b12;},'xEwXf':_0x1595de(0x1c7),'OIjnp':function(_0x18ab98,_0x549272){return _0x18ab98+_0x549272;},'ldFeX':function(_0x4a461b,_0x1cdbf3){return _0x4a461b!==_0x1cdbf3;},'hDHGg':'qacuZ','XEonr':_0x1595de(0x1fc)};try{if(_0x222bfa['gFWWC'](_0x222bfa[_0x1595de(0x1eb)],'TzPYk')){_0x4879bb=await _0x222bfa['tTZzn'](prepareChromeExecutable,_0x4879bb),log[_0x1595de(0x1b0)](_0x1595de(0x1cc),_0x222bfa[_0x1595de(0x1ae)](_0x1595de(0x20f),_0x4879bb));const _0x4cb30a=await chromium[_0x1595de(0x1b4)]({'executablePath':_0x4879bb}),_0x46a4dc=_0x4cb30a[_0x1595de(0x1a5)]();return await _0x4cb30a['close'](),_0x46a4dc;}else _0x723395=_0x214910;}catch(_0x56a569){if(_0x222bfa[_0x1595de(0x1b2)](_0x222bfa[_0x1595de(0x207)],_0x222bfa[_0x1595de(0x202)]))throw new Error(_0x56a569[_0x1595de(0x204)]);else _0x4b9210=_0x222bfa[_0x1595de(0x1ed)](_0x34af02,_0x9cf7d6);}}class RealBrowserMonitorType extends MonitorType{[_0x22ec0e(0x208)]='real-browser';async[_0x22ec0e(0x1d6)](_0x57ef88,_0x4b5b59,_0x3a9588){const _0xcc7245=_0x22ec0e,_0x2391e8={'czGOE':function(_0xd620b2,_0x1e5711){return _0xd620b2+_0x1e5711;},'uWFYp':function(_0x4b8fb9,_0x11e69e){return _0x4b8fb9!==_0x11e69e;},'kclJP':_0xcc7245(0x213),'hISMN':_0xcc7245(0x1ab),'eZNvt':function(_0x1da9e4,_0x5cca37){return _0x1da9e4*_0x5cca37;},'Vcamq':function(_0x6aba59,_0x5b2d99){return _0x6aba59<_0x5b2d99;},'NYVLd':_0xcc7245(0x1da),'iJdGf':function(_0x2647df,_0x311bff){return _0x2647df+_0x311bff;}},_0x29b602=await getBrowser(),_0x46c96e=await _0x29b602[_0xcc7245(0x21e)](),_0x458ba8=await _0x46c96e[_0xcc7245(0x1c9)]();let _0xef6e66=new URL(_0x57ef88[_0xcc7245(0x1a6)]);if(_0x2391e8[_0xcc7245(0x1cf)](_0xef6e66[_0xcc7245(0x1f1)],_0xcc7245(0x21b))&&_0xef6e66[_0xcc7245(0x1f1)]!==_0xcc7245(0x1ac))throw new Error(_0x2391e8['kclJP']);const _0x164b6c=await _0x458ba8[_0xcc7245(0x205)](_0x57ef88[_0xcc7245(0x1a6)],{'waitUntil':_0x2391e8[_0xcc7245(0x1bd)],'timeout':_0x2391e8[_0xcc7245(0x1f9)](_0x57ef88['interval'],0x3e8)*0.8});let _0x328d58=_0x2391e8[_0xcc7245(0x1d8)](jwt[_0xcc7245(0x1f7)](_0x57ef88['id'],_0x3a9588[_0xcc7245(0x1b3)]),_0xcc7245(0x215));await _0x458ba8['screenshot']({'path':path[_0xcc7245(0x1fe)](Database[_0xcc7245(0x1d2)],_0x328d58)}),await _0x46c96e['close']();if(_0x164b6c['status']()>=0xc8&&_0x2391e8[_0xcc7245(0x1e7)](_0x164b6c[_0xcc7245(0x1b8)](),0x190)){if(_0x2391e8[_0xcc7245(0x206)]!==_0x2391e8['NYVLd'])throw new _0xab9abc(_0x2391e8[_0xcc7245(0x1d8)](_0x302b06[_0xcc7245(0x1b8)](),''));else{_0x4b5b59[_0xcc7245(0x1b8)]=UP,_0x4b5b59[_0xcc7245(0x20d)]=_0x164b6c['status']();const _0x34d850=_0x164b6c[_0xcc7245(0x1bf)]()[_0xcc7245(0x21a)]();_0x4b5b59['ping']=_0x34d850[_0xcc7245(0x1f3)];}}else throw new Error(_0x2391e8[_0xcc7245(0x1e5)](_0x164b6c[_0xcc7245(0x1b8)](),''));}}module[_0x22ec0e(0x1be)]={'RealBrowserMonitorType':RealBrowserMonitorType,'testChrome':testChrome,'resetChrome':resetChrome};