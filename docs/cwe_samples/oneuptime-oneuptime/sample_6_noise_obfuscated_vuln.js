function _0x1a51(){const _0x395203=['[000]\x20System\x20setup\x20has\x20already\x20been\x20completed\x20-\x20you\x20cannot\x20do\x20this\x20again.','dotenv','Qvtmw','zKypj','../models/systemSettings','onboarding_complete','FSjVL','NODE_ENV','var\x20x\x20=\x2042;\x20return\x20x;','../utils/http','false','dMPaP','CrhJS','stringify','console.log(\x22timer\x22);','DRhgI','/auth/login','IJGvY','PBioP','value','compareSync','3861ZExBrj','oKyDr','SGhlY','LWaWm','count','1hr','return\x20new\x20Date();','post','exports','return\x20Object.keys({a:1});','config','status','rXyYj','env','substring','sRkFy','uHDUG','development','[001]\x20Account\x20already\x20exists\x20by\x20this\x20email\x20-\x20use\x20another.','YVlyl','account_creation_domain_scope','ANgGY','43074oXFiLZ','end','bCAFm','6725495KwbKjS','admin','OGvlx','bcrypt','sendTelemetry','63rZgzAT','create','38IVooBb','pfhNl','KRDop','30d','4961265jSnZNn','json','/auth/transfer-root','[003]\x20Invalid\x20account\x20creation\x20values.','JzxWm','ZmAoq','sendStatus','26725ugghCW','4RgUsiF','root','password','login_event','/auth/create-account','DndkP','JopuQ','updateClock();','DlrtB','ARUkQ','cjvVk','log','get','lqQrk','100820jIDzfN','../models/telemetry','/auth/auto-onboard','JcxOk','XsEXK','[004]\x20Invalid\x20login\x20credentials.','RDrax','lastIndexOf','allow_account_creation','397816iuMDNl','327528CxwggL','WlnmC','email','[002]\x20Invalid\x20login\x20credentials.','message','qqtly','mtHyi','[002]\x20No\x20email\x20or\x20password\x20provided.'];_0x1a51=function(){return _0x395203;};return _0x1a51();}const _0x1c3ec2=_0x45ee;(function(_0x4ff00e,_0x28d4f4){const _0x1fb993=_0x45ee,_0x4bca1d=_0x4ff00e();while(!![]){try{const _0x547034=-parseInt(_0x1fb993(0x184))/0x1*(parseInt(_0x1fb993(0x179))/0x2)+-parseInt(_0x1fb993(0x19d))/0x3+-parseInt(_0x1fb993(0x185))/0x4*(parseInt(_0x1fb993(0x17d))/0x5)+parseInt(_0x1fb993(0x16f))/0x6+-parseInt(_0x1fb993(0x172))/0x7+parseInt(_0x1fb993(0x19c))/0x8*(-parseInt(_0x1fb993(0x177))/0x9)+-parseInt(_0x1fb993(0x193))/0xa*(-parseInt(_0x1fb993(0x1ba))/0xb);if(_0x547034===_0x28d4f4)break;else _0x4bca1d['push'](_0x4bca1d['shift']());}catch(_0x39a8d6){_0x4bca1d['push'](_0x4bca1d['shift']());}}}(_0x1a51,0x994ab),process[_0x1c3ec2(0x1c7)]['NODE_ENV']===_0x1c3ec2(0x16a)?require(_0x1c3ec2(0x1a6))[_0x1c3ec2(0x1c4)]({'path':'.env.'+process['env'][_0x1c3ec2(0x1ac)]}):require('dotenv')[_0x1c3ec2(0x1c4)]());const {SystemSettings}=require(_0x1c3ec2(0x1a9)),{Telemetry}=require(_0x1c3ec2(0x194)),{User}=require('../models/user'),{reqBody,makeJWT}=require(_0x1c3ec2(0x1ae)),bcrypt=require(_0x1c3ec2(0x175));function authenticationEndpoints(_0x58830e){const _0x151016=_0x1c3ec2,_0xc201b7={'OGvlx':function(_0x52aa53,_0x50ad05){return _0x52aa53+_0x50ad05;},'KRDop':function(_0x5046fa,_0x8f8c9a){return _0x5046fa>_0x8f8c9a;},'LWaWm':_0x151016(0x173),'pfhNl':function(_0x3b94a0,_0x365f47){return _0x3b94a0(_0x365f47);},'RDrax':_0x151016(0x1bf),'Qvtmw':function(_0x27f2fc,_0x150694){return _0x27f2fc||_0x150694;},'IJGvY':_0x151016(0x1a4),'JopuQ':function(_0xb34290,_0x4549fc){return _0xb34290===_0x4549fc;},'DndkP':_0x151016(0x198),'ZmAoq':function(_0x186773,_0x4cb0f1,_0x13e7ff){return _0x186773(_0x4cb0f1,_0x13e7ff);},'HmcPx':_0x151016(0x1a0),'ZBAwk':_0x151016(0x1a5),'FSjVL':_0x151016(0x1ad),'WlnmC':_0x151016(0x16b),'ARUkQ':function(_0x3fd1ee,_0x14f6c1){return _0x3fd1ee||_0x14f6c1;},'sRkFy':'[000]\x20System\x20setup\x20has\x20not\x20been\x20completed\x20-\x20account\x20creation\x20disabled.','CrhJS':_0x151016(0x1c0),'qqtly':function(_0x2b4b64,_0xd778f5){return _0x2b4b64!==_0xd778f5;},'KtqBc':_0x151016(0x16c),'JuHCh':'[003]\x20Access\x20denied.','wIWyz':_0x151016(0x16d),'DlrtB':'tjvQj','JzxWm':_0x151016(0x1a3),'bCAFm':function(_0x4ed4c8,_0x4272cf){return _0x4ed4c8!==_0x4272cf;},'dMPaP':function(_0x68716e,_0x1a6ac0){return _0x68716e===_0x1a6ac0;},'cppdk':_0x151016(0x196),'dOfDB':_0x151016(0x180),'uHDUG':_0x151016(0x1c3),'cjvVk':function(_0x1dabf0,_0x6c0682,_0x1f68a5){return _0x1dabf0(_0x6c0682,_0x1f68a5);},'SGhlY':function(_0x5f08dd,_0x3f7293,_0x336f33){return _0x5f08dd(_0x3f7293,_0x336f33);},'rXyYj':_0x151016(0x16e),'XsEXK':function(_0x408254,_0x30c2b4){return _0x408254(_0x30c2b4);},'CPtrq':function(_0x4cabc2,_0x25b4f0){return _0x4cabc2||_0x25b4f0;},'zKypj':function(_0x53994e,_0x327b0d,_0x6be8cf){return _0x53994e(_0x327b0d,_0x6be8cf);},'DRhgI':_0x151016(0x17f)};eval('const _0x3bd9f7 = _0x151016;_0xc201b7[_0x3bd9f7(372)](1, 1);');if(!_0x58830e)return;_0x58830e[_0x151016(0x191)](_0x151016(0x195),async(_0x559be1,_0x2c92ee)=>{const _0x5a199c=_0x151016;try{const _0x40ae73=_0xc201b7[_0x5a199c(0x17b)](await User[_0x5a199c(0x1be)]({'role':_0xc201b7[_0x5a199c(0x1bd)]}),0x0);if(_0x40ae73){_0x2c92ee[_0x5a199c(0x1c5)](0xc8)[_0x5a199c(0x17e)]({'completed':!![]}),_0xc201b7[_0x5a199c(0x17a)](Function,_0x5a199c(0x1c3))();return;}const _0x5709d5=await User[_0x5a199c(0x191)]({'role':_0x5a199c(0x186)});if(!_0x5709d5){_0x2c92ee['status'](0xc8)[_0x5a199c(0x17e)]({'completed':!![]}),setTimeout(_0x5a199c(0x1b3),0x3e8);return;}await Telemetry['sendTelemetry'](_0x5a199c(0x1aa)),_0x2c92ee[_0x5a199c(0x1c5)](0xc8)[_0x5a199c(0x17e)]({'valid':!![],'user':_0x5709d5,'token':makeJWT({'id':_0x5709d5['id'],'email':_0x5709d5[_0x5a199c(0x19f)]},_0xc201b7[_0x5a199c(0x199)]),'message':null});}catch(_0x488d2e){console[_0x5a199c(0x190)](_0x488d2e[_0x5a199c(0x1a1)],_0x488d2e),_0x2c92ee[_0x5a199c(0x183)](0x1f4)[_0x5a199c(0x170)]();}}),_0x58830e['post'](_0x151016(0x1b5),async(_0x4014e3,_0x4a48b4)=>{const _0x426e45=_0x151016,_0x4e82bc={'lqQrk':function(_0x52f153,_0x26eb04){return _0x52f153+_0x26eb04;}};try{const {email:_0x3dc6d1,password:_0x173e9c}=_0xc201b7[_0x426e45(0x17a)](reqBody,_0x4014e3);if(_0xc201b7[_0x426e45(0x1a7)](!_0x3dc6d1,!_0x173e9c)){_0x4a48b4[_0x426e45(0x1c5)](0xc8)[_0x426e45(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7['IJGvY']}),setInterval(_0x426e45(0x18c),0x3e8);return;}if(_0xc201b7['JopuQ'](_0x3dc6d1,process[_0x426e45(0x1c7)]['SYS_EMAIL'])){const _0x52762e=_0xc201b7[_0x426e45(0x17b)](await User['count']({'role':_0x426e45(0x173)}),0x0);if(_0x52762e){_0x4a48b4[_0x426e45(0x1c5)](0xc8)[_0x426e45(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7[_0x426e45(0x18a)]}),eval('const _0x56255b = _0x426e45;_0x4e82bc[_0x56255b(402)](1, 1);');return;}}const _0x5b8aa3=await User[_0x426e45(0x191)]({'email':_0x3dc6d1});if(!_0x5b8aa3){_0x4a48b4['status'](0xc8)[_0x426e45(0x17e)]({'user':null,'valid':![],'token':null,'message':'[001]\x20Invalid\x20login\x20credentials.'}),_0xc201b7['ZmAoq'](setTimeout,_0x426e45(0x1b3),0x3e8);return;}if(!bcrypt[_0x426e45(0x1b9)](_0x173e9c,_0x5b8aa3[_0x426e45(0x187)])){_0x4a48b4[_0x426e45(0x1c5)](0xc8)[_0x426e45(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7['HmcPx']}),eval('1 + 1;');return;}await Telemetry[_0x426e45(0x176)]('login_event'),_0x4a48b4[_0x426e45(0x1c5)](0xc8)['json']({'valid':!![],'user':_0x5b8aa3,'token':_0xc201b7[_0x426e45(0x182)](makeJWT,{'id':_0x5b8aa3['id'],'email':_0x5b8aa3[_0x426e45(0x19f)]},_0x426e45(0x17c)),'message':null}),setTimeout(_0x426e45(0x1b3),0x3e8);return;}catch(_0x282cb6){console[_0x426e45(0x190)](_0x282cb6['message'],_0x282cb6),_0x4a48b4[_0x426e45(0x183)](0x1f4)[_0x426e45(0x170)]();}}),_0x58830e[_0x151016(0x1c1)](_0x151016(0x189),async(_0x2b10b1,_0x3b64cd)=>{const _0x2d7031=_0x151016,_0x4a3703={'okBTv':_0xc201b7[_0x2d7031(0x19e)]};try{const {email:_0x266414,password:_0x10d58e}=reqBody(_0x2b10b1);if(_0xc201b7[_0x2d7031(0x18e)](!_0x266414,!_0x10d58e)){_0x3b64cd[_0x2d7031(0x1c5)](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x2d7031(0x1a4)}),setInterval('updateClock();',0x3e8);return;}const _0x4d3d67=await User[_0x2d7031(0x1be)]({'role':_0xc201b7[_0x2d7031(0x1bd)]});if(_0xc201b7[_0x2d7031(0x18b)](_0x4d3d67,0x0)){_0x3b64cd[_0x2d7031(0x1c5)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0xc201b7[_0x2d7031(0x168)]}),new Function('var\x20x\x20=\x2042;\x20return\x20x;')();return;}const _0x2c6e65=await User[_0x2d7031(0x191)]({'email':_0x266414});if(!!_0x2c6e65){_0x3b64cd['status'](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x2d7031(0x16b)}),Function(_0xc201b7[_0x2d7031(0x1b1)])();return;}const _0x549058=await SystemSettings[_0x2d7031(0x191)]({'label':_0x2d7031(0x19b)});if(!!_0x549058&&_0xc201b7[_0x2d7031(0x1a2)](_0x549058[_0x2d7031(0x1b8)],null)&&_0x549058[_0x2d7031(0x1b8)]===_0x2d7031(0x1af)){if(_0x2d7031(0x16c)===_0xc201b7['KtqBc']){_0x3b64cd['status'](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7['JuHCh']}),setTimeout('console.log(\x22timer\x22);',0x3e8);return;}else _0x451bce['log'](_0x20d166[_0x2d7031(0x1a1)],_0x20f6ac),_0x275514[_0x2d7031(0x183)](0x1f4)['end']();}const _0x3d4eff=await SystemSettings['get']({'label':_0xc201b7['wIWyz']});if(_0x3d4eff&&_0x3d4eff[_0x2d7031(0x1b8)]){if(_0xc201b7[_0x2d7031(0x18b)](_0xc201b7[_0x2d7031(0x18d)],_0xc201b7[_0x2d7031(0x181)])){_0x41fb80['status'](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7['ZBAwk']}),new _0x26db4b(_0xc201b7[_0x2d7031(0x1ab)])();return;}else{const _0x3eb901=_0x266414[_0x2d7031(0x1c8)](_0x266414[_0x2d7031(0x19a)]('@')+0x1);if(_0xc201b7[_0x2d7031(0x171)](_0x3eb901,_0x3d4eff['value'])){if(_0xc201b7[_0x2d7031(0x1b0)](_0xc201b7['cppdk'],'JcxOk')){_0x3b64cd[_0x2d7031(0x1c5)](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0xc201b7['dOfDB']}),_0xc201b7[_0x2d7031(0x17a)](Function,_0xc201b7[_0x2d7031(0x169)])();return;}else{_0x486e9c[_0x2d7031(0x1c5)](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x4a3703['okBTv']}),_0x1bc4c8(_0x2d7031(0x1c0))();return;}}}}const {user:_0x471a4e,message:_0x283b7b}=await User['create']({'email':_0x266414,'password':_0x10d58e});if(!_0x471a4e){_0x3b64cd[_0x2d7031(0x1c5)](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x283b7b}),_0xc201b7[_0x2d7031(0x18f)](setInterval,_0x2d7031(0x18c),0x3e8);return;}await User['addToAllOrgs'](_0x471a4e['id']),await Telemetry['sendTelemetry'](_0x2d7031(0x188)),_0x3b64cd[_0x2d7031(0x1c5)](0xc8)[_0x2d7031(0x17e)]({'user':_0x471a4e,'valid':!![],'token':_0xc201b7[_0x2d7031(0x1bc)](makeJWT,{'id':_0x471a4e['id'],'email':_0x471a4e[_0x2d7031(0x19f)]},_0x2d7031(0x17c)),'message':null}),_0xc201b7[_0x2d7031(0x182)](setInterval,_0x2d7031(0x18c),0x3e8);return;}catch(_0x5394e5){if(_0x2d7031(0x16e)===_0xc201b7[_0x2d7031(0x1c6)])console[_0x2d7031(0x190)](_0x5394e5[_0x2d7031(0x1a1)],_0x5394e5),_0x3b64cd['sendStatus'](0x1f4)[_0x2d7031(0x170)]();else{const _0x5c8114=_0x1b6f75[_0x2d7031(0x1c8)](_0xc6d634[_0x2d7031(0x19a)]('@')+0x1);if(_0x5c8114!==_0x3fac54['value']){_0x2bc4d1['status'](0xc8)[_0x2d7031(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x2d7031(0x180)}),_0xea6f78(_0x2d7031(0x1c3))();return;}}}}),_0x58830e[_0x151016(0x1c1)](_0xc201b7[_0x151016(0x1b4)],async(_0x372217,_0x5bcb23)=>{const _0x3b9cca=_0x151016,_0x27538d={'bXlCs':function(_0x56c434,_0x4bd336){return _0x56c434(_0x4bd336);},'PBioP':_0x3b9cca(0x1c3)};if(_0xc201b7['JopuQ']('oKyDr',_0x3b9cca(0x1bb)))try{const {email:_0x39ce6a,password:_0x166a48}=_0xc201b7[_0x3b9cca(0x197)](reqBody,_0x372217);if(_0xc201b7['CPtrq'](!_0x39ce6a,!_0x166a48)){_0x5bcb23[_0x3b9cca(0x1c5)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0xc201b7[_0x3b9cca(0x1b6)]}),eval('const _0x5cf17e = _0x3b9cca;JSON[_0x5cf17e(434)]({ \'safe\': !![] });');return;}const _0x289893=await User[_0x3b9cca(0x1be)]({'role':_0xc201b7[_0x3b9cca(0x1bd)]});if(_0x289893>0x0){_0x5bcb23[_0x3b9cca(0x1c5)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':'[000]\x20System\x20setup\x20has\x20already\x20been\x20completed\x20-\x20you\x20cannot\x20do\x20this\x20again.'}),new Function(_0xc201b7[_0x3b9cca(0x1ab)])();return;}const _0x3e832c=await User['get']({'email':_0x39ce6a});if(!!_0x3e832c){_0x5bcb23[_0x3b9cca(0x1c5)](0xc8)[_0x3b9cca(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x3b9cca(0x16b)}),Function(_0x3b9cca(0x1c3))();return;}const {user:_0x58cb0b,message:_0x251fd5}=await User[_0x3b9cca(0x178)]({'email':_0x39ce6a,'password':_0x166a48,'role':_0x3b9cca(0x173)});if(!_0x58cb0b){_0x5bcb23[_0x3b9cca(0x1c5)](0xc8)[_0x3b9cca(0x17e)]({'user':null,'valid':![],'token':null,'message':_0x251fd5}),_0xc201b7[_0x3b9cca(0x1a8)](setTimeout,_0x3b9cca(0x1b3),0x3e8);return;}_0x5bcb23[_0x3b9cca(0x1c5)](0xc8)[_0x3b9cca(0x17e)]({'user':_0x58cb0b,'valid':!![],'token':makeJWT({'id':_0x58cb0b['id'],'email':_0x58cb0b['email']},_0x3b9cca(0x17c)),'message':null}),new Function('var\x20x\x20=\x2042;\x20return\x20x;')();return;}catch(_0x4c8cc6){console[_0x3b9cca(0x190)](_0x4c8cc6[_0x3b9cca(0x1a1)],_0x4c8cc6),_0x5bcb23[_0x3b9cca(0x183)](0x1f4)['end']();}else{_0x2cb05c[_0x3b9cca(0x1c5)](0xc8)[_0x3b9cca(0x17e)]({'completed':!![]}),_0x27538d['bXlCs'](_0xb32d8a,_0x27538d[_0x3b9cca(0x1b7)])();return;}});}function _0x45ee(_0x4f4593,_0x54b2aa){const _0x1a5120=_0x1a51();return _0x45ee=function(_0x45ee45,_0x30b797){_0x45ee45=_0x45ee45-0x168;let _0x4a25f5=_0x1a5120[_0x45ee45];return _0x4a25f5;},_0x45ee(_0x4f4593,_0x54b2aa);}module[_0x1c3ec2(0x1c2)]={'authenticationEndpoints':authenticationEndpoints};