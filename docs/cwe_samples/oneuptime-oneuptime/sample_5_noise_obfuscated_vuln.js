const _0x2d9021=_0x5e37;function _0x5e37(_0xdaab79,_0x4975f2){const _0x4304cc=_0x4304();return _0x5e37=function(_0x5e37b7,_0x2b85fe){_0x5e37b7=_0x5e37b7-0xe0;let _0x441078=_0x4304cc[_0x5e37b7];return _0x441078;},_0x5e37(_0xdaab79,_0x4975f2);}(function(_0x379f48,_0x3761b9){const _0x5cd127=_0x5e37,_0xabe2b=_0x379f48();while(!![]){try{const _0x31e758=-parseInt(_0x5cd127(0xf4))/0x1+-parseInt(_0x5cd127(0xe0))/0x2+-parseInt(_0x5cd127(0x123))/0x3*(-parseInt(_0x5cd127(0x141))/0x4)+parseInt(_0x5cd127(0x107))/0x5*(-parseInt(_0x5cd127(0x12e))/0x6)+-parseInt(_0x5cd127(0x120))/0x7+-parseInt(_0x5cd127(0x128))/0x8+parseInt(_0x5cd127(0x143))/0x9;if(_0x31e758===_0x3761b9)break;else _0xabe2b['push'](_0xabe2b['shift']());}catch(_0x50da9f){_0xabe2b['push'](_0xabe2b['shift']());}}}(_0x4304,0x3e650),process[_0x2d9021(0x117)]['NODE_ENV']==='development'?require(_0x2d9021(0xec))['config']({'path':_0x2d9021(0x112)+process['env']['NODE_ENV']}):require('dotenv')['config']());const {SystemSettings}=require(_0x2d9021(0x108)),{Telemetry}=require(_0x2d9021(0x118)),{User}=require('../models/user'),{reqBody,makeJWT}=require('../utils/http'),bcrypt=require(_0x2d9021(0xfa));function _0x4304(){const _0x70f8ca=['SYS_EMAIL','NHEjm','/auth/transfer-root','[000]\x20System\x20setup\x20has\x20already\x20been\x20completed\x20-\x20you\x20cannot\x20do\x20this\x20again.','[004]\x20Invalid\x20login\x20credentials.','dotenv','return\x20await\x20Promise.resolve(42);','gldWH','wmXSC','account_creation_domain_scope','var\x20x\x20=\x2042;\x20return\x20x;','USSVW','GMxkB','182203kebOwf','create','UstEE','KmTZt','zxSUg','onboarding_complete','bcrypt','stringify','[003]\x20Invalid\x20account\x20creation\x20values.','sSYRC','uphJw','cMcoD','return\x20new\x20Date();','iUVgf','status','CHYeI','TQdwA','ndclJ','ShZfj','15EAFpde','../models/systemSettings','[001]\x20Invalid\x20login\x20credentials.','eJaEs','/auth/auto-onboard','Hnsmz','post','YzdEi','[002]\x20No\x20email\x20or\x20password\x20provided.','gxlCZ','IrPQQ','.env.','oPNjq','admin','count','sendStatus','env','../models/telemetry','login_event','vzwiP','RVJCG','rMVbi','bAYCO','return\x20Object.keys({a:1});','vMrlV','3359559TEumgN','oHxVU','password','287931ifsPhx','IpjAn','[000]\x20System\x20setup\x20has\x20not\x20been\x20completed\x20-\x20account\x20creation\x20disabled.','eLUSa','eMxzr','1752448fDorkr','updateClock();','addToAllOrgs','GonYL','[003]\x20Access\x20denied.','tAden','984702gDQuvJ','exports','root','compareSync','fBpOB','Qwswa','HvDMt','json','message','ZFreI','QIXSI','get','jJVDu','[002]\x20Invalid\x20login\x20credentials.','30d','CbdsR','1hr','PuYqO','email','12OgIjJu','mkNAd','14308065DaQFIH','TDSna','log','value','ytHcd','/auth/create-account','kdIgw','allow_account_creation','/auth/login','pJahx','drixD','ZRmbr','UMiiZ','497202ROvKJE','kFTuu','false','end','sendTelemetry','[001]\x20Account\x20already\x20exists\x20by\x20this\x20email\x20-\x20use\x20another.','fSjQF'];_0x4304=function(){return _0x70f8ca;};return _0x4304();}function authenticationEndpoints(_0x1c6ea2){const _0x552b0a=_0x2d9021,_0xc42106={'fBpOB':function(_0x57e998,_0xa1a607){return _0x57e998(_0xa1a607);},'mkNAd':function(_0x491737,_0xa9b652){return _0x491737>_0xa9b652;},'TQdwA':_0x552b0a(0x114),'IrPQQ':_0x552b0a(0xed),'wmXSC':_0x552b0a(0xf9),'vMrlV':function(_0x1c61ba,_0x2972ce){return _0x1c61ba===_0x2972ce;},'ndclJ':_0x552b0a(0x133),'cMcoD':function(_0xbdf02c,_0x59f2ca){return _0xbdf02c+_0x59f2ca;},'CbdsR':function(_0xd23a00,_0x1c76ce){return _0xd23a00*_0x1c76ce;},'Rculd':function(_0x4837db,_0x4a45c4,_0x1d6517){return _0x4837db(_0x4a45c4,_0x1d6517);},'yvskc':_0x552b0a(0x113),'lpWzA':function(_0x56813d,_0x421444){return _0x56813d(_0x421444);},'VawiB':function(_0x4b410b,_0x14c4cf){return _0x4b410b||_0x14c4cf;},'kFTuu':_0x552b0a(0x10f),'QIXSI':_0x552b0a(0xeb),'CHYeI':function(_0x1878a7,_0x2cd6ec){return _0x1878a7!==_0x2cd6ec;},'PuYqO':_0x552b0a(0x13b),'oHxVU':_0x552b0a(0x100),'fSjQF':_0x552b0a(0x119),'fNLGw':function(_0x1fc7dc,_0x459726,_0x4b3b79){return _0x1fc7dc(_0x459726,_0x4b3b79);},'sSYRC':_0x552b0a(0x13c),'TDSna':'[001]\x20Account\x20already\x20exists\x20by\x20this\x20email\x20-\x20use\x20another.','RcTsr':function(_0xfc6891,_0x5c70d2){return _0xfc6891!==_0x5c70d2;},'ytHcd':_0x552b0a(0xf6),'eMxzr':_0x552b0a(0x134),'USSVW':function(_0x1f5bba,_0x4bea52){return _0x1f5bba||_0x4bea52;},'tAden':_0x552b0a(0x125),'eLUSa':function(_0x1333e5,_0x3c9fb4,_0x12ead4){return _0x1333e5(_0x3c9fb4,_0x12ead4);},'ShZfj':_0x552b0a(0x12c),'vzwiP':_0x552b0a(0xf0),'ZFreI':function(_0x181a4c,_0x4fc9d6,_0x5898c5){return _0x181a4c(_0x4fc9d6,_0x5898c5);},'gxlCZ':function(_0x421fc0,_0x579691){return _0x421fc0===_0x579691;},'iUVgf':_0x552b0a(0x14f),'bAYCO':function(_0x2148aa,_0x2ceb5c){return _0x2148aa===_0x2ceb5c;},'jJVDu':_0x552b0a(0xee),'IpjAn':function(_0x401e38,_0x68e7bd){return _0x401e38!==_0x68e7bd;},'KWCwi':_0x552b0a(0x10c),'yaEoN':_0x552b0a(0x10e),'eJaEs':function(_0xac4fb7,_0x10314f){return _0xac4fb7>_0x10314f;},'ZRmbr':_0x552b0a(0xf1),'rMVbi':function(_0x2689e7,_0x4b0bb3,_0x58b5e7){return _0x2689e7(_0x4b0bb3,_0x58b5e7);},'NHEjm':_0x552b0a(0x10b),'kdIgw':_0x552b0a(0x148)};new Function(_0x552b0a(0xf1))();if(!_0x1c6ea2)return;_0x1c6ea2[_0x552b0a(0x139)](_0xc42106[_0x552b0a(0xe8)],async(_0x3cac39,_0x7433f)=>{const _0xd60601=_0x552b0a,_0x37e7b6={'drixD':function(_0xb16f17,_0x8b5537){return _0xb16f17+_0x8b5537;}};try{const _0x16e032=_0xc42106[_0xd60601(0x142)](await User[_0xd60601(0x115)]({'role':_0xc42106[_0xd60601(0x104)]}),0x0);if(_0x16e032){_0x7433f['status'](0xc8)[_0xd60601(0x135)]({'completed':!![]}),new AsyncFunction(_0xc42106[_0xd60601(0x111)])();return;}const _0x5b33b1=await User[_0xd60601(0x139)]({'role':_0xd60601(0x130)});if(!_0x5b33b1){_0x7433f[_0xd60601(0x102)](0xc8)[_0xd60601(0x135)]({'completed':!![]}),eval('const _0x5b3544 = _0xd60601;_0x37e7b6[_0x5b3544(333)](1, 1);');return;}await Telemetry[_0xd60601(0xe4)](_0xc42106[_0xd60601(0xef)]),_0x7433f[_0xd60601(0x102)](0xc8)[_0xd60601(0x135)]({'valid':!![],'user':_0x5b33b1,'token':makeJWT({'id':_0x5b33b1['id'],'email':_0x5b33b1[_0xd60601(0x140)]},_0xd60601(0x13e)),'message':null});}catch(_0x514186){if(_0xc42106[_0xd60601(0x11f)](_0xc42106[_0xd60601(0x105)],'Qwswa'))console[_0xd60601(0x145)](_0x514186[_0xd60601(0x136)],_0x514186),_0x7433f['sendStatus'](0x1f4)['end']();else{_0x488d4f['status'](0xc8)[_0xd60601(0x135)]({'user':null,'valid':![],'token':null,'message':'[002]\x20No\x20email\x20or\x20password\x20provided.'}),_0xc42106[_0xd60601(0x132)](_0x2b62e2,'return\x20new\x20Date();')();return;}}}),_0x1c6ea2[_0x552b0a(0x10d)](_0x552b0a(0x14b),async(_0xb258b3,_0x4b7397)=>{const _0x29aefa=_0x552b0a,_0x257b91={'zxSUg':function(_0x1a036f,_0x3cbb19){return _0x1a036f+_0x3cbb19;},'GonYL':function(_0x1d3109,_0x1b3741){const _0x2375c4=_0x5e37;return _0xc42106[_0x2375c4(0x13d)](_0x1d3109,_0x1b3741);},'erXYG':_0x29aefa(0x12c),'RVJCG':function(_0x457392,_0x262ece,_0x12d6c9){return _0xc42106['Rculd'](_0x457392,_0x262ece,_0x12d6c9);}};try{if(_0xc42106['yvskc']===_0x29aefa(0xfe))HQycCh[_0x29aefa(0xf8)](0x1,0x1);else{const {email:_0x5e65a0,password:_0x4eaa30}=_0xc42106['lpWzA'](reqBody,_0xb258b3);if(_0xc42106['VawiB'](!_0x5e65a0,!_0x4eaa30)){_0x4b7397['status'](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x29aefa(0xe1)]}),setTimeout('console.log(\x22timer\x22);',0x3e8);return;}if(_0xc42106[_0x29aefa(0x11f)](_0x5e65a0,process[_0x29aefa(0x117)][_0x29aefa(0xe7)])){const _0x4320be=await User[_0x29aefa(0x115)]({'role':_0xc42106[_0x29aefa(0x104)]})>0x0;if(_0x4320be){_0x4b7397['status'](0xc8)[_0x29aefa(0x135)]({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x29aefa(0x138)]}),new AsyncFunction(_0x29aefa(0xed))();return;}}const _0x1d54b2=await User[_0x29aefa(0x139)]({'email':_0x5e65a0});if(!_0x1d54b2){_0x4b7397[_0x29aefa(0x102)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x29aefa(0x109)}),eval('const _0x992c37 = _0x29aefa;_0x257b91[_0x992c37(299)](Math[\'PI\'], 2);');return;}if(!bcrypt[_0x29aefa(0x131)](_0x4eaa30,_0x1d54b2[_0x29aefa(0x122)])){if(_0xc42106[_0x29aefa(0x103)]('KxOwV',_0x29aefa(0xf3))){_0x4b7397[_0x29aefa(0x102)](0xc8)[_0x29aefa(0x135)]({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x29aefa(0x13f)]}),Function(_0xc42106['oHxVU'])();return;}else{const _0x5a98b2={'LAKdy':'safe'};_0x4bbfc0['status'](0xc8)[_0x29aefa(0x135)]({'user':null,'valid':![],'token':null,'message':_0x257b91['erXYG']}),_0x257b91[_0x29aefa(0x11b)](_0x303d43,function(){_0x17f5fd['log'](_0x5a98b2['LAKdy']);},0x64);return;}}await Telemetry[_0x29aefa(0xe4)](_0xc42106[_0x29aefa(0xe6)]),_0x4b7397['status'](0xc8)['json']({'valid':!![],'user':_0x1d54b2,'token':_0xc42106['fNLGw'](makeJWT,{'id':_0x1d54b2['id'],'email':_0x1d54b2[_0x29aefa(0x140)]},_0xc42106['sSYRC']),'message':null}),eval('const _0x573f31 = _0x29aefa;_0xc42106[_0x573f31(255)](1, 1);');return;}}catch(_0x1c0b58){console[_0x29aefa(0x145)](_0x1c0b58['message'],_0x1c0b58),_0x4b7397['sendStatus'](0x1f4)[_0x29aefa(0xe3)]();}}),_0x1c6ea2[_0x552b0a(0x10d)](_0xc42106[_0x552b0a(0x149)],async(_0xb0a887,_0x5f42a2)=>{const _0x477f75=_0x552b0a,_0xb1700={'pJahx':'safe'};try{if(_0xc42106['RcTsr'](_0xc42106[_0x477f75(0x147)],_0xc42106[_0x477f75(0x127)])){const {email:_0x576ae7,password:_0xbb9c6}=reqBody(_0xb0a887);if(_0xc42106[_0x477f75(0xf2)](!_0x576ae7,!_0xbb9c6)){_0x5f42a2[_0x477f75(0x102)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x477f75(0x10f)}),eval('const _0x391219 = _0x477f75;JSON[_0x391219(251)]({ \'safe\': !![] });');return;}const _0x5ad7da=await User[_0x477f75(0x115)]({'role':_0x477f75(0x114)});if(_0x5ad7da===0x0){_0x5f42a2['status'](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x477f75(0x12d)]}),Function(_0x477f75(0x11e))();return;}const _0x1e3101=await User[_0x477f75(0x139)]({'email':_0x576ae7});if(!!_0x1e3101){_0x5f42a2[_0x477f75(0x102)](0xc8)[_0x477f75(0x135)]({'user':null,'valid':![],'token':null,'message':'[001]\x20Account\x20already\x20exists\x20by\x20this\x20email\x20-\x20use\x20another.'}),_0xc42106[_0x477f75(0x126)](setInterval,_0x477f75(0x129),0x3e8);return;}const _0x5d8f3d=await SystemSettings[_0x477f75(0x139)]({'label':_0x477f75(0x14a)});if(!!_0x5d8f3d&&_0xc42106[_0x477f75(0x103)](_0x5d8f3d[_0x477f75(0x146)],null)&&_0x5d8f3d[_0x477f75(0x146)]===_0x477f75(0xe2)){_0x5f42a2[_0x477f75(0x102)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x477f75(0x106)]}),setTimeout(function(){const _0x4f6c9a=_0x477f75;console[_0x4f6c9a(0x145)](_0xb1700[_0x4f6c9a(0x14c)]);},0x64);return;}const _0x389cce=await SystemSettings[_0x477f75(0x139)]({'label':_0xc42106[_0x477f75(0x11a)]});if(!!_0x389cce&&_0xc42106[_0x477f75(0x103)](_0x389cce['value'],null)&&!_0x576ae7['includes'](_0x389cce[_0x477f75(0x146)])){_0x5f42a2['status'](0xc8)[_0x477f75(0x135)]({'user':null,'valid':![],'token':null,'message':_0x477f75(0xfc)}),new AsyncFunction(_0xc42106['IrPQQ'])();return;}const {user:_0x8a30f6,message:_0xb16f1b}=await User[_0x477f75(0xf5)]({'email':_0x576ae7,'password':_0xbb9c6});if(!_0x8a30f6){_0x5f42a2[_0x477f75(0x102)](0xc8)[_0x477f75(0x135)]({'user':null,'valid':![],'token':null,'message':_0xb16f1b}),_0xc42106[_0x477f75(0x137)](setInterval,_0x477f75(0x129),0x3e8);return;}await User[_0x477f75(0x12a)](_0x8a30f6['id']),await Telemetry['sendTelemetry'](_0xc42106['fSjQF']),_0x5f42a2[_0x477f75(0x102)](0xc8)[_0x477f75(0x135)]({'user':_0x8a30f6,'valid':!![],'token':_0xc42106['Rculd'](makeJWT,{'id':_0x8a30f6['id'],'email':_0x8a30f6[_0x477f75(0x140)]},_0x477f75(0x13c)),'message':null}),new Function(_0x477f75(0xf1))();return;}else{_0x3ee5cf[_0x477f75(0x102)](0xc8)[_0x477f75(0x135)]({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x477f75(0x144)]}),new _0x36a86a(_0xc42106[_0x477f75(0x111)])();return;}}catch(_0x16f558){_0xc42106[_0x477f75(0x110)](_0xc42106[_0x477f75(0x101)],_0x477f75(0x14f))?(console[_0x477f75(0x145)](_0x16f558[_0x477f75(0x136)],_0x16f558),_0x5f42a2[_0x477f75(0x116)](0x1f4)['end']()):0x1+0x1;}}),_0x1c6ea2['post'](_0x552b0a(0xe9),async(_0x3d8293,_0xb0ea54)=>{const _0x20595e=_0x552b0a,_0x2e2095={'KmTZt':_0x20595e(0x100)};if(_0xc42106[_0x20595e(0x11d)](_0x20595e(0xee),_0xc42106[_0x20595e(0x13a)]))try{const {email:_0x1fbb1a,password:_0x1a95f5}=reqBody(_0x3d8293);if(!_0x1fbb1a||!_0x1a95f5){if(_0xc42106[_0x20595e(0x124)](_0xc42106['KWCwi'],_0xc42106['yaEoN'])){_0xb0ea54[_0x20595e(0x102)](0xc8)[_0x20595e(0x135)]({'user':null,'valid':![],'token':null,'message':_0xc42106[_0x20595e(0xe1)]}),Function(_0xc42106[_0x20595e(0x121)])();return;}else _0x16413d[_0x20595e(0x145)](_0x5aaf09[_0x20595e(0x136)],_0x5cc8ff),_0x48c4f9[_0x20595e(0x116)](0x1f4)['end']();}const _0x4a1520=await User[_0x20595e(0x115)]({'role':_0x20595e(0x114)});if(_0xc42106[_0x20595e(0x10a)](_0x4a1520,0x0)){_0xb0ea54[_0x20595e(0x102)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x20595e(0xea)}),new Function(_0xc42106[_0x20595e(0x14e)])();return;}const _0x4fe082=await User[_0x20595e(0x139)]({'email':_0x1fbb1a});if(!!_0x4fe082){_0xb0ea54[_0x20595e(0x102)](0xc8)[_0x20595e(0x135)]({'user':null,'valid':![],'token':null,'message':_0x20595e(0xe5)}),new AsyncFunction(_0x20595e(0xed))();return;}const {user:_0x2c53a0,message:_0x480f0b}=await User[_0x20595e(0xf5)]({'email':_0x1fbb1a,'password':_0x1a95f5,'role':_0xc42106[_0x20595e(0x104)]});if(!_0x2c53a0){_0xb0ea54[_0x20595e(0x102)](0xc8)[_0x20595e(0x135)]({'user':null,'valid':![],'token':null,'message':_0x480f0b}),_0xc42106[_0x20595e(0x11c)](setTimeout,'console.log(\x22timer\x22);',0x3e8);return;}_0xb0ea54['status'](0xc8)['json']({'user':_0x2c53a0,'valid':!![],'token':_0xc42106['Rculd'](makeJWT,{'id':_0x2c53a0['id'],'email':_0x2c53a0[_0x20595e(0x140)]},_0xc42106[_0x20595e(0xfd)]),'message':null}),eval('const _0x1ee93b = _0x20595e;_0xc42106[_0x1ee93b(255)](1, 1);');return;}catch(_0x4c6e7a){console[_0x20595e(0x145)](_0x4c6e7a['message'],_0x4c6e7a),_0xb0ea54[_0x20595e(0x116)](0x1f4)[_0x20595e(0xe3)]();}else{_0x485830[_0x20595e(0x102)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x20595e(0x13b)}),_0x34fe39(_0x2e2095[_0x20595e(0xf7)])();return;}});}module[_0x2d9021(0x12f)]={'authenticationEndpoints':authenticationEndpoints};