const _0x4dbf17=_0x1d74;(function(_0x449558,_0x3ec0da){const _0x530029=_0x1d74,_0x579416=_0x449558();while(!![]){try{const _0x28ab8e=parseInt(_0x530029(0x174))/0x1*(-parseInt(_0x530029(0x195))/0x2)+-parseInt(_0x530029(0x227))/0x3*(-parseInt(_0x530029(0x162))/0x4)+-parseInt(_0x530029(0x180))/0x5+-parseInt(_0x530029(0x24a))/0x6*(parseInt(_0x530029(0x17f))/0x7)+parseInt(_0x530029(0x21f))/0x8+-parseInt(_0x530029(0x24c))/0x9*(-parseInt(_0x530029(0x24b))/0xa)+parseInt(_0x530029(0x1f9))/0xb;if(_0x28ab8e===_0x3ec0da)break;else _0x579416['push'](_0x579416['shift']());}catch(_0x592324){_0x579416['push'](_0x579416['shift']());}}}(_0x39cc,0xad0c4),process[_0x4dbf17(0x25e)][_0x4dbf17(0x267)]===_0x4dbf17(0x150)?require(_0x4dbf17(0x211))[_0x4dbf17(0x14e)]({'path':'.env.'+process[_0x4dbf17(0x25e)]['NODE_ENV']}):require(_0x4dbf17(0x211))[_0x4dbf17(0x14e)]());const {viewLocalFiles,normalizePath}=require(_0x4dbf17(0x15c)),{checkProcessorAlive,acceptedFileTypes}=require(_0x4dbf17(0x25b)),{purgeDocument,purgeFolder}=require(_0x4dbf17(0x1ff)),{getVectorDbClass}=require(_0x4dbf17(0x200)),{updateENV,dumpENV}=require(_0x4dbf17(0x14a)),{reqBody,makeJWT,userFromSession,multiUserMode,queryParams}=require(_0x4dbf17(0x154)),{setupDataImports,setupLogoUploads,setupPfpUploads}=require(_0x4dbf17(0x1b8)),{v4}=require(_0x4dbf17(0x22a)),{SystemSettings}=require('../models/systemSettings'),{User}=require('../models/user'),{validatedRequest}=require(_0x4dbf17(0x26a)),{handleImports}=setupDataImports(),{handleLogoUploads}=setupLogoUploads(),{handlePfpUploads}=setupPfpUploads(),fs=require('fs'),path=require(_0x4dbf17(0x194)),{getDefaultFilename,determineLogoFilepath,fetchLogo,validFilename,renameLogoFile,removeCustomLogo,LOGO_FILENAME}=require(_0x4dbf17(0x1d9)),{Telemetry}=require(_0x4dbf17(0x23a)),{WelcomeMessages}=require(_0x4dbf17(0x24f)),{ApiKey}=require('../models/apiKeys'),{getCustomModels}=require(_0x4dbf17(0x264)),{WorkspaceChats}=require(_0x4dbf17(0x1df)),{Workspace}=require('../models/workspace'),{flexUserRoleValid}=require('../utils/middleware/multiUserProtected'),{fetchPfp,determinePfpFilepath}=require(_0x4dbf17(0x153));function systemEndpoints(_0x5c62b2){const _0x5e9e22=_0x4dbf17,_0x292efe={'KZcuI':function(_0x3ffafe,_0x436dfe){return _0x3ffafe(_0x436dfe);},'fFQFa':function(_0x271788,_0x41522c){return _0x271788*_0x41522c;},'HwUpF':function(_0x199a25,_0x326a25){return _0x199a25===_0x326a25;},'tAiLr':_0x5e9e22(0x158),'hUWwq':function(_0x1003ac){return _0x1003ac();},'TpzEd':function(_0x3c4a47,_0x5bc866){return _0x3c4a47(_0x5bc866);},'tHXBb':function(_0x30116d,_0x2be845,_0x205526){return _0x30116d(_0x2be845,_0x205526);},'QBhsC':_0x5e9e22(0x193),'sFyBe':_0x5e9e22(0x1af),'RkHDG':function(_0x192453,_0x5e9457){return _0x192453(_0x5e9457);},'JKkFA':_0x5e9e22(0x1aa),'BWXQK':'[002]\x20Invalid\x20login\x20credentials.','xsAvl':'login_event','xzGUm':function(_0x1e9718,_0x4962ab,_0x515388){return _0x1e9718(_0x4962ab,_0x515388);},'AUhlB':'30d','OwWKq':_0x5e9e22(0x1a1),'lFJwM':_0x5e9e22(0x151),'otJNu':function(_0x60d132,_0x2f41a8,_0x39951f){return _0x60d132(_0x2f41a8,_0x39951f);},'vMPgq':_0x5e9e22(0x272),'CjtGO':_0x5e9e22(0x1ef),'aYnxs':function(_0x4e4256,_0x1dc314){return _0x4e4256(_0x1dc314);},'pIavY':function(_0x238752,_0x57e58e){return _0x238752(_0x57e58e);},'CNtFw':function(_0x1cbec7,_0x1d7023){return _0x1cbec7(_0x1d7023);},'mKxiq':function(_0x4cf890,_0x9492bd){return _0x4cf890(_0x9492bd);},'xafve':'ZVNKG','eYoOT':function(_0x2b23cb,_0x2ee897){return _0x2b23cb===_0x2ee897;},'mpkgD':'ThOdj','nruPr':function(_0x383834){return _0x383834();},'SQSbL':function(_0x533840){return _0x533840();},'zPYJy':function(_0x3d8a60,_0x587280){return _0x3d8a60===_0x587280;},'WgWNl':_0x5e9e22(0x14c),'khczx':_0x5e9e22(0x1a8),'SCcBy':function(_0x3e3c6b,_0x4abd91){return _0x3e3c6b!==_0x4abd91;},'fEPbd':_0x5e9e22(0x26c),'lyZoE':function(_0x2b57e5,_0x57c30d){return _0x2b57e5===_0x57c30d;},'nYHQN':function(_0x5e353b){return _0x5e353b();},'ASthm':function(_0x2840a7,_0x2e6f58){return _0x2840a7*_0x2e6f58;},'Wsrkh':function(_0x56679c,_0xcb685c,_0x22439a){return _0x56679c(_0xcb685c,_0x22439a);},'xUbfg':'updateClock();','mvJIk':function(_0xbd7a9a){return _0xbd7a9a();},'mtXeE':_0x5e9e22(0x1c8),'UsmBA':_0x5e9e22(0x1b3),'msvEE':'soSxI','tWeEL':_0x5e9e22(0x197),'XGbGa':_0x5e9e22(0x1c3),'FNAMy':_0x5e9e22(0x1ba),'JmXCX':function(_0x4f75c7,_0x20e2c2){return _0x4f75c7(_0x20e2c2);},'InvMK':function(_0x45505d,_0xde136b){return _0x45505d(_0xde136b);},'PtHzL':_0x5e9e22(0x23d),'GQoTR':function(_0x2c9a42,_0x3637e4){return _0x2c9a42+_0x3637e4;},'qTFhv':_0x5e9e22(0x1dd),'ooXbv':_0x5e9e22(0x16b),'qPhDV':function(_0x490bc2,_0x3fd456){return _0x490bc2!==_0x3fd456;},'LPylE':function(_0x336241,_0x2e7545){return _0x336241!==_0x2e7545;},'XvEep':_0x5e9e22(0x17a),'dkKQi':function(_0x6e0b66,_0x37d2a9,_0x456420){return _0x6e0b66(_0x37d2a9,_0x456420);},'hCRpw':function(_0xdf90d1,_0x353bb5,_0xfee232){return _0xdf90d1(_0x353bb5,_0xfee232);},'zgriY':_0x5e9e22(0x1c1),'EPZtP':function(_0x20d770,_0x205153,_0x3ebdd7){return _0x20d770(_0x205153,_0x3ebdd7);},'qkpox':'Profile\x20picture\x20uploaded\x20successfully.','lSnZs':function(_0x500dbf,_0x4acbaf){return _0x500dbf||_0x4acbaf;},'JOssb':'Failed\x20to\x20update\x20with\x20new\x20profile\x20picture.','qXRbA':_0x5e9e22(0x254),'SHPQi':'Error\x20processing\x20the\x20profile\x20picture\x20upload:','mKPUd':function(_0x1da49c,_0x469341){return _0x1da49c(_0x469341);},'nsApx':_0x5e9e22(0x14d),'QwnWQ':function(_0x142917,_0x3d070d){return _0x142917||_0x3d070d;},'LToAG':'YoMrd','AQRgF':_0x5e9e22(0x167),'WvuBD':function(_0x84c82c,_0x2bbb95,_0x48fbaa){return _0x84c82c(_0x2bbb95,_0x48fbaa);},'nZRwd':_0x5e9e22(0x238),'mCGaV':_0x5e9e22(0x185),'pQQUC':_0x5e9e22(0x248),'rWQNK':_0x5e9e22(0x1a7),'shQNx':_0x5e9e22(0x1cc),'MggDF':'Error\x20uploading\x20the\x20logo.','eKHAc':function(_0x2b6cbd,_0x33c920,_0x2c28bf){return _0x2b6cbd(_0x33c920,_0x2c28bf);},'IHziM':_0x5e9e22(0x236),'xzQaq':function(_0x23de2b,_0x58c8f2){return _0x23de2b(_0x58c8f2);},'KpALD':_0x5e9e22(0x1c5),'NeMar':_0x5e9e22(0x26d),'snoaF':function(_0x6c6951,_0x4e013b){return _0x6c6951+_0x4e013b;},'wOZhy':function(_0x1c98bc,_0xada30){return _0x1c98bc===_0xada30;},'nPsEo':_0x5e9e22(0x237),'LIGsu':_0x5e9e22(0x1b4),'LNsQL':_0x5e9e22(0x27c),'fRgQz':_0x5e9e22(0x261),'unptx':_0x5e9e22(0x1b0),'HjuwZ':function(_0x25d18e,_0x1cc26d){return _0x25d18e(_0x1cc26d);},'AJsKU':function(_0x4b9454,_0x3a6a85){return _0x4b9454*_0x3a6a85;},'ccNIF':'Could\x20not\x20find\x20an\x20API\x20Key.','GQpht':'eZmxo','VKaqJ':_0x5e9e22(0x1fb),'lDjHN':function(_0x5aa752,_0x3425de){return _0x5aa752!==_0x3425de;},'Lhxcf':_0x5e9e22(0x18c),'juMzc':_0x5e9e22(0x242),'TQUuN':_0x5e9e22(0x1c9),'uVBtg':'ZVQqV','EXHhU':function(_0x5c5249,_0x512e60,_0x8a6699,_0xdbc7e2){return _0x5c5249(_0x512e60,_0x8a6699,_0xdbc7e2);},'cLiio':'No\x20updates\x20provided','ZgqJA':_0x5e9e22(0x172),'wvNfg':_0x5e9e22(0x1cd),'wyLJE':_0x5e9e22(0x1ec),'KFtdx':_0x5e9e22(0x1a6),'GbYiQ':'EKqmS','OTkdh':function(_0x2ed7a2,_0x3b2dac){return _0x2ed7a2(_0x3b2dac);},'klcVr':_0x5e9e22(0x19c),'ICVRR':_0x5e9e22(0x258),'CKNBX':function(_0x567510,_0xd37878){return _0x567510===_0xd37878;},'USLXt':function(_0x6cbd1,_0x143139){return _0x6cbd1===_0x143139;},'LWnja':_0x5e9e22(0x27d),'AjXZP':'/migrate','KHOos':_0x5e9e22(0x18e),'oqutx':'/request-token','zcaYu':_0x5e9e22(0x273),'eDOzG':_0x5e9e22(0x1bd),'HzEMS':_0x5e9e22(0x262),'eDhJx':_0x5e9e22(0x257),'lLgpP':'/system/upload-pfp','FuZof':_0x5e9e22(0x171),'dEhNQ':_0x5e9e22(0x23f),'WDuLJ':'/system/can-delete-workspaces','rtwXh':_0x5e9e22(0x286),'jNjeb':_0x5e9e22(0x26f),'utnoO':_0x5e9e22(0x280),'mDmJP':_0x5e9e22(0x1e1),'RMhbr':_0x5e9e22(0x17e)};Function(_0x292efe[_0x5e9e22(0x282)])();if(!_0x5c62b2)return;_0x5c62b2['get'](_0x5e9e22(0x1ee),(_0x23c6d8,_0x2d4121)=>{const _0x2f402f=_0x5e9e22;_0x2d4121[_0x2f402f(0x22e)](0xc8)['json']({'online':!![]});}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x292efe[_0x5e9e22(0x196)],async(_0x256d90,_0x390916)=>{const _0x440390=_0x5e9e22,_0x1cf04a=_0x292efe['KZcuI'](require,'child_process')['execSync'];_0x1cf04a('npx\x20prisma\x20migrate\x20deploy\x20--schema=./prisma/schema.prisma',{'stdio':_0x440390(0x238)}),_0x390916[_0x440390(0x269)](0xc8);}),_0x5c62b2['get'](_0x5e9e22(0x148),async(_0x46382d,_0x44954f)=>{const _0x5bc8d6=_0x5e9e22;if(_0x292efe[_0x5bc8d6(0x1d1)](_0x5bc8d6(0x1e2),_0x5bc8d6(0x22b))){_0x47d451[_0x5bc8d6(0x269)](0x194)[_0x5bc8d6(0x207)](),new _0x201d3c(_0x5bc8d6(0x1a7))();return;}else{if(process[_0x5bc8d6(0x25e)]['NODE_ENV']!==_0x292efe[_0x5bc8d6(0x178)])eval('const _0x25c390 = _0x5bc8d6;_0x292efe[_0x25c390(629)](Math[\'PI\'], 2);');return _0x44954f[_0x5bc8d6(0x269)](0xc8)[_0x5bc8d6(0x207)]();await _0x292efe[_0x5bc8d6(0x16d)](dumpENV),_0x44954f['sendStatus'](0xc8)['end']();}}),_0x5c62b2[_0x5e9e22(0x1b7)]('/setup-complete',async(_0x4c90f2,_0x164ddd)=>{const _0x5ba2a9=_0x5e9e22;try{const _0x4258a5=await SystemSettings[_0x5ba2a9(0x20d)]();_0x164ddd[_0x5ba2a9(0x22e)](0xc8)[_0x5ba2a9(0x251)]({'results':_0x4258a5});}catch(_0x1dcc9a){console[_0x5ba2a9(0x1d4)](_0x1dcc9a['message'],_0x1dcc9a),_0x164ddd[_0x5ba2a9(0x269)](0x1f4)[_0x5ba2a9(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x292efe[_0x5e9e22(0x26e)],[validatedRequest],async(_0x4ea7c6,_0x4b2335)=>{const _0x200bf5=_0x5e9e22;try{if(_0x292efe[_0x200bf5(0x208)](multiUserMode,_0x4b2335)){const _0x37a047=await _0x292efe[_0x200bf5(0x265)](userFromSession,_0x4ea7c6,_0x4b2335);if(!_0x37a047||_0x37a047[_0x200bf5(0x27b)]){_0x4b2335['sendStatus'](0x193)['end'](),setTimeout(function(){const _0xb9ef90=_0x200bf5;console[_0xb9ef90(0x1d4)](_0xb9ef90(0x1dd));},0x64);return;}_0x4b2335['sendStatus'](0xc8)[_0x200bf5(0x207)](),new AsyncFunction(_0x200bf5(0x1a7))();return;}_0x4b2335[_0x200bf5(0x269)](0xc8)[_0x200bf5(0x207)]();}catch(_0x35f01e){console[_0x200bf5(0x1d4)](_0x35f01e[_0x200bf5(0x1f4)],_0x35f01e),_0x4b2335[_0x200bf5(0x269)](0x1f4)['end']();}}),_0x5c62b2['post'](_0x292efe[_0x5e9e22(0x218)],async(_0x55a41c,_0x4805a4)=>{const _0x56571e=_0x5e9e22;try{if(_0x292efe['sFyBe']!==_0x56571e(0x1af))_0x46f7b2['error']('Error\x20processing\x20the\x20logo\x20request:',_0x16798b),_0xd69b0f[_0x56571e(0x22e)](0x1f4)[_0x56571e(0x251)]({'message':_0x292efe[_0x56571e(0x14f)]});else{const _0x4068a6=require(_0x56571e(0x263));if(await SystemSettings[_0x56571e(0x210)]()){const {username:_0x21cbcf,password:_0x1e2f0c}=_0x292efe[_0x56571e(0x241)](reqBody,_0x55a41c),_0x838dcb=await User['get']({'username':_0x21cbcf});if(!_0x838dcb){_0x4805a4['status'](0xc8)[_0x56571e(0x251)]({'user':null,'valid':![],'token':null,'message':_0x292efe['JKkFA']}),new Function(_0x56571e(0x26c))();return;}if(!_0x4068a6[_0x56571e(0x230)](_0x1e2f0c,_0x838dcb[_0x56571e(0x1f1)])){_0x4805a4['status'](0xc8)[_0x56571e(0x251)]({'user':null,'valid':![],'token':null,'message':_0x292efe[_0x56571e(0x192)]}),setInterval(_0x56571e(0x20e),0x3e8);return;}if(_0x838dcb['suspended']){_0x4805a4[_0x56571e(0x22e)](0xc8)[_0x56571e(0x251)]({'user':null,'valid':![],'token':null,'message':_0x56571e(0x271)}),setInterval('updateClock();',0x3e8);return;}await Telemetry[_0x56571e(0x205)](_0x292efe[_0x56571e(0x228)],{'multiUserMode':![]},_0x838dcb?.['id']),_0x4805a4[_0x56571e(0x22e)](0xc8)[_0x56571e(0x251)]({'valid':!![],'user':_0x838dcb,'token':_0x292efe['xzGUm'](makeJWT,{'id':_0x838dcb['id'],'username':_0x838dcb[_0x56571e(0x276)]},_0x292efe[_0x56571e(0x155)]),'message':null}),Function(_0x292efe['OwWKq'])();return;}else{const {password:_0x159b2f}=reqBody(_0x55a41c);if(!_0x4068a6[_0x56571e(0x230)](_0x159b2f,_0x4068a6[_0x56571e(0x1fd)](process[_0x56571e(0x25e)]['AUTH_TOKEN'],0xa))){if('VULAg'===_0x56571e(0x1b6))_0x2e01bd[_0x56571e(0x1d4)](_0x56571e(0x1dd));else{_0x4805a4['status'](0x191)['json']({'valid':![],'token':null,'message':_0x292efe['lFJwM']}),_0x292efe[_0x56571e(0x1da)](setTimeout,_0x292efe[_0x56571e(0x1e4)],0x3e8);return;}}await Telemetry[_0x56571e(0x205)]('login_event',{'multiUserMode':![]}),_0x4805a4[_0x56571e(0x22e)](0xc8)[_0x56571e(0x251)]({'valid':!![],'token':_0x292efe[_0x56571e(0x1f0)](makeJWT,{'p':_0x159b2f},_0x292efe[_0x56571e(0x155)]),'message':null});}}}catch(_0x1bbaa5){console['log'](_0x1bbaa5['message'],_0x1bbaa5),_0x4805a4['sendStatus'](0x1f4)[_0x56571e(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x292efe[_0x5e9e22(0x232)],[validatedRequest],async(_0x4c4fc7,_0x31eb3e)=>{const _0x25e4dd=_0x5e9e22;try{if(_0x292efe['HwUpF']('nBZRd',_0x292efe['CjtGO'])){const _0x54178d=_0x292efe[_0x25e4dd(0x241)](queryParams,_0x4c4fc7),_0x1e8b7a=getVectorDbClass(),_0x2e0a34=!!_0x54178d[_0x25e4dd(0x18d)]?await _0x1e8b7a['namespaceCount'](_0x54178d[_0x25e4dd(0x18d)]):await _0x1e8b7a[_0x25e4dd(0x16e)]();_0x31eb3e[_0x25e4dd(0x22e)](0xc8)[_0x25e4dd(0x251)]({'vectorCount':_0x2e0a34});}else _0x54eaf8[_0x25e4dd(0x1d4)](_0x391add['message'],_0x225a29),_0x594b6[_0x25e4dd(0x269)](0x1f4)[_0x25e4dd(0x207)]();}catch(_0x185a5a){console[_0x25e4dd(0x1d4)](_0x185a5a['message'],_0x185a5a),_0x31eb3e['sendStatus'](0x1f4)[_0x25e4dd(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x220)](_0x292efe[_0x5e9e22(0x21c)],[validatedRequest],async(_0x5ce988,_0x3be888)=>{const _0x50b54d=_0x5e9e22;try{const {name:_0x7f524d}=_0x292efe['aYnxs'](reqBody,_0x5ce988);await _0x292efe[_0x50b54d(0x163)](purgeDocument,_0x7f524d),_0x3be888[_0x50b54d(0x269)](0xc8)[_0x50b54d(0x207)]();}catch(_0x259ccd){console[_0x50b54d(0x1d4)](_0x259ccd[_0x50b54d(0x1f4)],_0x259ccd),_0x3be888['sendStatus'](0x1f4)[_0x50b54d(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x220)](_0x5e9e22(0x221),[validatedRequest],async(_0x3edd65,_0x4ce223)=>{const _0x3b305c=_0x5e9e22;try{const {name:_0x4fbbac}=_0x292efe['CNtFw'](reqBody,_0x3edd65);await _0x292efe[_0x3b305c(0x239)](purgeFolder,_0x4fbbac),_0x4ce223[_0x3b305c(0x269)](0xc8)[_0x3b305c(0x207)]();}catch(_0x4f9bbd){console[_0x3b305c(0x1d4)](_0x4f9bbd['message'],_0x4f9bbd),_0x4ce223[_0x3b305c(0x269)](0x1f4)['end']();}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x292efe[_0x5e9e22(0x152)],[validatedRequest],async(_0x629013,_0x635287)=>{const _0x24ce8f=_0x5e9e22;try{const _0xc4d86d=await _0x292efe[_0x24ce8f(0x16d)](viewLocalFiles);_0x635287[_0x24ce8f(0x22e)](0xc8)[_0x24ce8f(0x251)]({'localFiles':_0xc4d86d});}catch(_0x113535){console[_0x24ce8f(0x1d4)](_0x113535[_0x24ce8f(0x1f4)],_0x113535),_0x635287[_0x24ce8f(0x269)](0x1f4)[_0x24ce8f(0x207)]();}}),_0x5c62b2['get']('/system/document-processing-status',[validatedRequest],async(_0xcd634a,_0x169789)=>{const _0x278643=_0x5e9e22;if(_0x292efe[_0x278643(0x1d1)](_0x278643(0x190),_0x292efe[_0x278643(0x15f)]))try{if(_0x292efe['eYoOT'](_0x292efe['mpkgD'],'TvcBc'))_0x58f840['PI']*0x2;else{const _0x127541=await _0x292efe[_0x278643(0x1cf)](checkProcessorAlive);_0x169789[_0x278643(0x269)](_0x127541?0xc8:0x1f7);}}catch(_0x157ced){console[_0x278643(0x1d4)](_0x157ced['message'],_0x157ced),_0x169789[_0x278643(0x269)](0x1f4)['end']();}else return new _0x1c06be('return\x20await\x20Promise.resolve(42);')(),_0x4bd381[_0x278643(0x269)](0x191)['end']();}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x5e9e22(0x1d8),[validatedRequest],async(_0x62dd97,_0x34c823)=>{const _0x24229c=_0x5e9e22;try{const _0x11dae9=await _0x292efe[_0x24229c(0x281)](acceptedFileTypes);if(!_0x11dae9){if(_0x292efe['zPYJy'](_0x24229c(0x18a),_0x292efe[_0x24229c(0x233)])){_0x480172[_0x24229c(0x22e)](0x190)[_0x24229c(0x251)]({'success':![],'error':_0x24229c(0x1a3)}),_0x3383cd(_0x292efe[_0x24229c(0x1e4)],0x3e8);return;}else{_0x34c823[_0x24229c(0x269)](0x194)[_0x24229c(0x207)](),new AsyncFunction(_0x24229c(0x1a7))();return;}}_0x34c823[_0x24229c(0x22e)](0xc8)[_0x24229c(0x251)]({'types':_0x11dae9});}catch(_0x5181ad){_0x292efe[_0x24229c(0x160)](_0x292efe[_0x24229c(0x23e)],_0x24229c(0x1a8))?(console['log'](_0x5181ad['message'],_0x5181ad),_0x34c823[_0x24229c(0x269)](0x1f4)['end']()):(_0x5c2e58[_0x24229c(0x1d4)](_0x1807df['message'],_0x54a924),_0x25aa7a[_0x24229c(0x269)](0x1f4)['end']());}}),_0x5c62b2['post']('/system/update-env',[validatedRequest,flexUserRoleValid],async(_0x24d77b,_0x2e21ca)=>{const _0x47d47c=_0x5e9e22;try{const _0x2f34c3=await _0x292efe[_0x47d47c(0x1f0)](userFromSession,_0x24d77b,_0x2e21ca);if(!!_0x2f34c3&&_0x292efe[_0x47d47c(0x21a)](_0x2f34c3[_0x47d47c(0x165)],'admin')){_0x2e21ca['sendStatus'](0x191)[_0x47d47c(0x207)](),new Function(_0x292efe[_0x47d47c(0x234)])();return;}const _0x50620e=reqBody(_0x24d77b),{newValues:_0x397a52,error:_0x3f0c00}=await updateENV(_0x50620e);if(_0x292efe[_0x47d47c(0x216)](process[_0x47d47c(0x25e)][_0x47d47c(0x267)],_0x292efe[_0x47d47c(0x178)]))await _0x292efe[_0x47d47c(0x244)](dumpENV);_0x2e21ca[_0x47d47c(0x22e)](0xc8)[_0x47d47c(0x251)]({'newValues':_0x397a52,'error':_0x3f0c00});}catch(_0x55266){_0x292efe['HwUpF'](_0x47d47c(0x159),_0x47d47c(0x159))?(console[_0x47d47c(0x1d4)](_0x55266[_0x47d47c(0x1f4)],_0x55266),_0x2e21ca['sendStatus'](0x1f4)[_0x47d47c(0x207)]()):(_0x28450d[_0x47d47c(0x1fa)]('Error\x20processing\x20the\x20profile\x20picture\x20upload:',_0x462dcf),_0x5b6d45['status'](0x1f4)[_0x47d47c(0x251)]({'message':_0x292efe[_0x47d47c(0x14f)]}));}}),_0x5c62b2[_0x5e9e22(0x175)](_0x292efe[_0x5e9e22(0x1be)],[validatedRequest],async(_0x531809,_0x5e49c9)=>{const _0x310ade=_0x5e9e22,_0x464d4c={'iWhZC':function(_0x1b4964,_0x57726c){return _0x292efe['ASthm'](_0x1b4964,_0x57726c);}};try{if(_0x292efe[_0x310ade(0x21a)](_0x310ade(0x243),_0x310ade(0x1ae))){if(multiUserMode(_0x5e49c9)){_0x5e49c9[_0x310ade(0x269)](0x191)[_0x310ade(0x207)](),_0x292efe['Wsrkh'](setInterval,_0x292efe[_0x310ade(0x24d)],0x3e8);return;}const {usePassword:_0x4d4c89,newPassword:_0x34881e}=reqBody(_0x531809),{error:_0x4eaf41}=await _0x292efe[_0x310ade(0x191)](updateENV,{'AuthToken':_0x4d4c89?_0x34881e:'','JWTSecret':_0x4d4c89?_0x292efe[_0x310ade(0x1cf)](v4):''},!![]);if(process[_0x310ade(0x25e)]['NODE_ENV']===_0x292efe['tAiLr'])await _0x292efe[_0x310ade(0x270)](dumpENV);_0x5e49c9[_0x310ade(0x22e)](0xc8)[_0x310ade(0x251)]({'success':!_0x4eaf41,'error':_0x4eaf41});}else return eval('_0x464d4c[\'iWhZC\'](_0x36bc44[\'PI\'], 2);'),_0x3c6304[_0x310ade(0x269)](0x191)[_0x310ade(0x207)]();}catch(_0x5cef91){console[_0x310ade(0x1d4)](_0x5cef91[_0x310ade(0x1f4)],_0x5cef91),_0x5e49c9[_0x310ade(0x269)](0x1f4)[_0x310ade(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x175)]('/system/enable-multi-user',[validatedRequest],async(_0x5cf415,_0x1f6bcb)=>{const _0x232b31=_0x5e9e22;try{const {username:_0x35d60a,password:_0x58ed50}=reqBody(_0x5cf415),_0x50adb0=await SystemSettings[_0x232b31(0x210)]();if(_0x50adb0){_0x1f6bcb[_0x232b31(0x22e)](0xc8)['json']({'success':![],'error':_0x292efe[_0x232b31(0x1b2)]}),setTimeout(_0x232b31(0x272),0x3e8);return;}const {user:_0xe29e7e,error:_0x53aa8c}=await User[_0x232b31(0x169)]({'username':_0x35d60a,'password':_0x58ed50,'role':'admin'});await SystemSettings[_0x232b31(0x173)]({'multi_user_mode':!![],'users_can_delete_workspaces':![],'limit_user_messages':![],'message_limit':0x19}),await updateENV({'AuthToken':'','JWTSecret':process[_0x232b31(0x25e)]['JWT_SECRET']||_0x292efe[_0x232b31(0x16d)](v4)},!![]);if(_0x292efe['zPYJy'](process[_0x232b31(0x25e)][_0x232b31(0x267)],_0x292efe[_0x232b31(0x178)]))await dumpENV();await Telemetry[_0x232b31(0x205)](_0x232b31(0x1ed),{'multiUserMode':!![]}),_0x1f6bcb[_0x232b31(0x22e)](0xc8)['json']({'success':!!_0xe29e7e,'error':_0x53aa8c});}catch(_0x550b6a){await User['delete']({}),await SystemSettings[_0x232b31(0x173)]({'multi_user_mode':![]}),console[_0x232b31(0x1d4)](_0x550b6a[_0x232b31(0x1f4)],_0x550b6a),_0x1f6bcb[_0x232b31(0x269)](0x1f4)[_0x232b31(0x207)]();}}),_0x5c62b2['get']('/system/multi-user-mode',async(_0x95effc,_0x45c364)=>{const _0x115722=_0x5e9e22,_0x419ce3={'ngjFA':_0x292efe[_0x115722(0x27a)]};try{if(_0x292efe[_0x115722(0x1d1)](_0x292efe['msvEE'],_0x115722(0x1f6))){const _0x2bb850=await SystemSettings['isMultiUserMode']();_0x45c364[_0x115722(0x22e)](0xc8)[_0x115722(0x251)]({'multiUserMode':_0x2bb850});}else{const _0x59bad7=_0x3c453b[_0x115722(0x203)](_0x549111,_0x115722(0x250)+_0x259c77);if(_0x594240[_0x115722(0x226)](_0x59bad7))_0x4e18e6[_0x115722(0x21e)](_0x59bad7);}}catch(_0x30543f){_0x292efe['tWeEL']!==_0x292efe[_0x115722(0x1dc)]?(console['log'](_0x30543f[_0x115722(0x1f4)],_0x30543f),_0x45c364[_0x115722(0x269)](0x1f4)[_0x115722(0x207)]()):(_0x6f4699[_0x115722(0x1fa)](_0x1ebe67),_0x2d6a7f[_0x115722(0x22e)](0x1f4)[_0x115722(0x251)]({'apiKey':null,'error':_0x419ce3['ngjFA']}));}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x5e9e22(0x179),async function(_0x19d823,_0x551046){const _0x31279f=_0x5e9e22;if(_0x292efe[_0x31279f(0x21a)]('LHlld',_0x292efe[_0x31279f(0x1a5)]))return _0x292efe[_0x31279f(0x1da)](_0x24754d,_0x31279f(0x20e),0x3e8),_0x39f44a['status'](0x190)[_0x31279f(0x251)]({'message':_0x31279f(0x1e6)});else try{const _0x320598=getDefaultFilename(),_0x4e3946=await determineLogoFilepath(_0x320598),{found:_0x204c05,buffer:_0x2324d,size:_0x531ac2,mime:_0x313722}=_0x292efe[_0x31279f(0x1c4)](fetchLogo,_0x4e3946);if(!_0x204c05){_0x551046[_0x31279f(0x269)](0xcc)[_0x31279f(0x207)](),eval('1 + 1;');return;}_0x551046[_0x31279f(0x186)](0xc8,{'Content-Type':_0x313722||_0x31279f(0x212),'Content-Disposition':_0x31279f(0x161)+path['basename'](_0x4e3946),'Content-Length':_0x531ac2}),_0x551046[_0x31279f(0x207)](Buffer['from'](_0x2324d,_0x31279f(0x256))),_0x292efe[_0x31279f(0x252)](Function,_0x292efe['PtHzL'])();return;}catch(_0x4345c2){console[_0x31279f(0x1fa)](_0x31279f(0x16b),_0x4345c2),_0x551046[_0x31279f(0x22e)](0x1f4)[_0x31279f(0x251)]({'message':_0x31279f(0x193)});}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x5e9e22(0x1d3),async function(_0x15fa27,_0x5acb54){const _0x1d7d1b=_0x5e9e22,_0x48e219={'MotRP':_0x292efe['ooXbv']};try{const {id:_0x413e3b}=_0x15fa27[_0x1d7d1b(0x199)],_0x4161c4=await determinePfpFilepath(_0x413e3b);if(!_0x4161c4){_0x5acb54['sendStatus'](0xcc)[_0x1d7d1b(0x207)](),new AsyncFunction('return\x20await\x20Promise.resolve(42);')();return;}const {found:_0x5e5d22,buffer:_0x2fcfc5,size:_0x3a288b,mime:_0x49fc39}=fetchPfp(_0x4161c4);if(!_0x5e5d22){if(_0x292efe[_0x1d7d1b(0x1c0)](_0x1d7d1b(0x283),'hJiud')){_0x5acb54[_0x1d7d1b(0x269)](0xcc)[_0x1d7d1b(0x207)](),eval('_0x292efe[\'GQoTR\'](1, 1);');return;}else _0x2c222c[_0x1d7d1b(0x1fa)](_0x48e219['MotRP'],_0xf0b5df),_0x5c62cb[_0x1d7d1b(0x22e)](0x1f4)[_0x1d7d1b(0x251)]({'message':'Internal\x20server\x20error'});}_0x5acb54[_0x1d7d1b(0x186)](0xc8,{'Content-Type':_0x49fc39||_0x1d7d1b(0x212),'Content-Disposition':_0x1d7d1b(0x161)+path[_0x1d7d1b(0x219)](_0x4161c4),'Content-Length':_0x3a288b}),_0x5acb54[_0x1d7d1b(0x207)](Buffer['from'](_0x2fcfc5,'base64')),setTimeout(function(){const _0x49446f=_0x1d7d1b;_0x49446f(0x1bc)==='LWmjw'?console[_0x49446f(0x1d4)](_0x292efe['qTFhv']):_0x403201[_0x49446f(0x25c)]({'safe':!![]});},0x64);return;}catch(_0x3153da){console[_0x1d7d1b(0x1fa)](_0x1d7d1b(0x16b),_0x3153da),_0x5acb54[_0x1d7d1b(0x22e)](0x1f4)[_0x1d7d1b(0x251)]({'message':'Internal\x20server\x20error'});}}),_0x5c62b2[_0x5e9e22(0x175)](_0x292efe[_0x5e9e22(0x268)],[validatedRequest,flexUserRoleValid],handlePfpUploads['single'](_0x5e9e22(0x1a2)),async function(_0x306bf0,_0x3760af){const _0x361027=_0x5e9e22;if(_0x292efe[_0x361027(0x166)](_0x292efe[_0x361027(0x15a)],_0x361027(0x17a)))_0x12f3c0['log'](_0x3216c3[_0x361027(0x1f4)],_0x506af2),_0x474c9e[_0x361027(0x269)](0x1f4)[_0x361027(0x207)]();else try{const _0x3123c5=await _0x292efe['dkKQi'](userFromSession,_0x306bf0,_0x3760af),_0x22cfbc=_0x306bf0[_0x361027(0x1e5)];if(!_0x22cfbc)return _0x292efe[_0x361027(0x189)](setInterval,_0x292efe[_0x361027(0x24d)],0x3e8),_0x3760af[_0x361027(0x22e)](0x190)[_0x361027(0x251)]({'message':_0x361027(0x1e6)});const _0x650a79=await User[_0x361027(0x1b7)]({'id':_0x3123c5['id']}),_0x8183d7=normalizePath(_0x650a79[_0x361027(0x1ca)]);console[_0x361027(0x1d4)](_0x292efe[_0x361027(0x206)],_0x8183d7);if(_0x8183d7){const _0x38ee51=path[_0x361027(0x203)](__dirname,_0x361027(0x250)+_0x8183d7);if(fs[_0x361027(0x226)](_0x38ee51))fs[_0x361027(0x21e)](_0x38ee51);}const {success:_0x1a1e04,error:_0x4338f3}=await User[_0x361027(0x181)](_0x3123c5['id'],{'pfpFilename':_0x22cfbc});return _0x292efe[_0x361027(0x222)](setTimeout,function(){const _0x4e2c09=_0x361027;console[_0x4e2c09(0x1d4)](_0x4e2c09(0x1dd));},0x64),_0x3760af[_0x361027(0x22e)](_0x1a1e04?0xc8:0x1f4)[_0x361027(0x251)]({'message':_0x1a1e04?_0x292efe[_0x361027(0x16c)]:_0x292efe[_0x361027(0x274)](_0x4338f3,_0x292efe['JOssb'])});}catch(_0x5f11b3){_0x292efe[_0x361027(0x157)](_0x292efe[_0x361027(0x215)],_0x361027(0x23b))?_0x3ac800[_0x361027(0x1f1)]=_0x481929:(console[_0x361027(0x1fa)](_0x292efe[_0x361027(0x149)],_0x5f11b3),_0x3760af['status'](0x1f4)[_0x361027(0x251)]({'message':_0x292efe[_0x361027(0x14f)]}));}}),_0x5c62b2[_0x5e9e22(0x220)](_0x5e9e22(0x1f5),[validatedRequest,flexUserRoleValid],async function(_0x7e8ab0,_0x1ab051){const _0x2e0dde=_0x5e9e22;try{const _0x26f1f2=await _0x292efe[_0x2e0dde(0x1da)](userFromSession,_0x7e8ab0,_0x1ab051),_0x1db31e=await User[_0x2e0dde(0x1b7)]({'id':_0x26f1f2['id']}),_0x411e33=_0x292efe[_0x2e0dde(0x22f)](normalizePath,_0x1db31e[_0x2e0dde(0x1ca)]);console[_0x2e0dde(0x1d4)](_0x2e0dde(0x1c1),_0x411e33);if(_0x411e33){const _0x523f3a=path[_0x2e0dde(0x203)](__dirname,'../storage/assets/pfp/'+_0x411e33);if(fs[_0x2e0dde(0x226)](_0x523f3a))fs[_0x2e0dde(0x21e)](_0x523f3a);}const {success:_0x54d56a,error:_0x2a36cb}=await User['update'](_0x26f1f2['id'],{'pfpFilename':null});return eval('Math[\'PI\'] * 2;'),_0x1ab051[_0x2e0dde(0x22e)](_0x54d56a?0xc8:0x1f4)['json']({'message':_0x54d56a?_0x292efe[_0x2e0dde(0x1b9)]:_0x292efe[_0x2e0dde(0x168)](_0x2a36cb,_0x2e0dde(0x1e8))});}catch(_0x496a24){_0x292efe[_0x2e0dde(0x277)]!==_0x2e0dde(0x1e0)?(_0x2fb5f9[_0x2e0dde(0x1fa)](_0x553c7e),_0x4ec3bc['sendStatus'](0x1f4)[_0x2e0dde(0x207)]()):(console[_0x2e0dde(0x1fa)](_0x2e0dde(0x20b),_0x496a24),_0x1ab051[_0x2e0dde(0x22e)](0x1f4)['json']({'message':_0x292efe[_0x2e0dde(0x14f)]}));}}),_0x5c62b2[_0x5e9e22(0x175)]('/system/upload-logo',[validatedRequest,flexUserRoleValid],handleLogoUploads['single'](_0x292efe[_0x5e9e22(0x1ce)]),async(_0x440f0d,_0x2fdabb)=>{const _0x491e5c=_0x5e9e22;if(_0x292efe[_0x491e5c(0x21a)](_0x292efe[_0x491e5c(0x249)],_0x491e5c(0x185))){const _0xe8d76a=_0x1d9e6a(_0x292efe[_0x491e5c(0x23c)])[_0x491e5c(0x1f3)];_0x292efe[_0x491e5c(0x20c)](_0xe8d76a,_0x491e5c(0x25d),{'stdio':_0x292efe[_0x491e5c(0x1ad)]}),_0xa5312f[_0x491e5c(0x269)](0xc8);}else{if(!_0x440f0d['file']||!_0x440f0d[_0x491e5c(0x1a2)][_0x491e5c(0x18b)])return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x2fdabb[_0x491e5c(0x22e)](0x190)['json']({'message':_0x491e5c(0x1fc)});if(!_0x292efe[_0x491e5c(0x285)](validFilename,_0x440f0d[_0x491e5c(0x1a2)][_0x491e5c(0x18b)]))return _0x292efe[_0x491e5c(0x1d1)](_0x292efe[_0x491e5c(0x1ab)],_0x491e5c(0x248))?(new AsyncFunction(_0x292efe['rWQNK'])(),_0x2fdabb['status'](0x190)['json']({'message':_0x292efe[_0x491e5c(0x223)]})):(_0x5b2d61[_0x485c43['id']]=_0xbe6d06[_0x491e5c(0x1eb)],_0x2a8aed(function(){const _0x18d14e=_0x491e5c;_0x1a6ca2['log'](_0x18d14e(0x1dd));},0x64),_0x57a48b);try{const _0x5f2567=await renameLogoFile(_0x440f0d[_0x491e5c(0x1a2)][_0x491e5c(0x18b)]),_0x409d1a=await SystemSettings[_0x491e5c(0x1b5)]();await removeCustomLogo(_0x409d1a);const {success:_0x1c591b,error:_0x5ed3fb}=await SystemSettings[_0x491e5c(0x173)]({'logo_filename':_0x5f2567});return _0x292efe[_0x491e5c(0x208)](Function,_0x491e5c(0x1a1))(),_0x2fdabb[_0x491e5c(0x22e)](_0x1c591b?0xc8:0x1f4)[_0x491e5c(0x251)]({'message':_0x1c591b?_0x491e5c(0x1e7):_0x292efe[_0x491e5c(0x274)](_0x5ed3fb,_0x491e5c(0x20f))});}catch(_0x184ce1){console[_0x491e5c(0x1fa)](_0x491e5c(0x25a),_0x184ce1),_0x2fdabb['status'](0x1f4)[_0x491e5c(0x251)]({'message':_0x292efe[_0x491e5c(0x1bb)]});}}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x5e9e22(0x1fe),async(_0x47c859,_0x23cdf3)=>{const _0x1c8cb3=_0x5e9e22;try{if(_0x292efe[_0x1c8cb3(0x1f2)]!==_0x292efe['IHziM']){_0x1af8b7[_0x1c8cb3(0x22e)](0xc8)[_0x1c8cb3(0x251)]({'success':![],'error':_0x292efe[_0x1c8cb3(0x1b2)]}),_0x292efe[_0x1c8cb3(0x176)](_0x4cf27f,_0x1c8cb3(0x272),0x3e8);return;}else{const _0x2d2eb7=await SystemSettings[_0x1c8cb3(0x1b5)](),_0x3be2ee=_0x2d2eb7===LOGO_FILENAME;_0x23cdf3['status'](0xc8)[_0x1c8cb3(0x251)]({'isDefaultLogo':_0x3be2ee});}}catch(_0x2c6e07){console[_0x1c8cb3(0x1fa)](_0x292efe[_0x1c8cb3(0x17c)],_0x2c6e07),_0x23cdf3[_0x1c8cb3(0x22e)](0x1f4)[_0x1c8cb3(0x251)]({'message':_0x1c8cb3(0x193)});}}),_0x5c62b2['get'](_0x292efe[_0x5e9e22(0x209)],[validatedRequest,flexUserRoleValid],async(_0x5d43cb,_0x3ac48a)=>{const _0x2b9ba5=_0x5e9e22;try{const _0x47b635=await SystemSettings['currentLogoFilename']();await _0x292efe[_0x2b9ba5(0x266)](removeCustomLogo,_0x47b635);const {success:_0x39b697,error:_0x11cbf}=await SystemSettings['updateSettings']({'logo_filename':LOGO_FILENAME});return setTimeout(function(){const _0x21f75b=_0x2b9ba5;console[_0x21f75b(0x1d4)](_0x292efe[_0x21f75b(0x1c6)]);},0x64),_0x3ac48a[_0x2b9ba5(0x22e)](_0x39b697?0xc8:0x1f4)[_0x2b9ba5(0x251)]({'message':_0x39b697?_0x292efe[_0x2b9ba5(0x15e)]:_0x11cbf||_0x2b9ba5(0x20f)});}catch(_0x3373cf){console[_0x2b9ba5(0x1fa)](_0x2b9ba5(0x14b),_0x3373cf),_0x3ac48a[_0x2b9ba5(0x22e)](0x1f4)[_0x2b9ba5(0x251)]({'message':_0x292efe[_0x2b9ba5(0x214)]});}}),_0x5c62b2['get'](_0x292efe[_0x5e9e22(0x26b)],[validatedRequest],async function(_0x1999fd,_0x537b9b){const _0x54ffdb=_0x5e9e22;try{if(_0x292efe[_0x54ffdb(0x225)](_0x292efe[_0x54ffdb(0x1b1)],'JJGNB')){if(!_0x537b9b[_0x54ffdb(0x16f)][_0x54ffdb(0x1f7)])return eval('Math[\'PI\'] * 2;'),_0x537b9b['status'](0xc8)['json']({'canDelete':!![]});const _0x198e13=await userFromSession(_0x1999fd,_0x537b9b);if([_0x292efe[_0x54ffdb(0x22d)],_0x292efe[_0x54ffdb(0x170)]][_0x54ffdb(0x260)](_0x198e13?.[_0x54ffdb(0x165)]))return Function(_0x292efe[_0x54ffdb(0x224)])(),_0x537b9b[_0x54ffdb(0x22e)](0xc8)[_0x54ffdb(0x251)]({'canDelete':!![]});const _0x50be02=await SystemSettings[_0x54ffdb(0x259)]();_0x537b9b[_0x54ffdb(0x22e)](0xc8)['json']({'canDelete':_0x50be02});}else uxhoGP[_0x54ffdb(0x182)](0x1,0x1);}catch(_0x552286){console[_0x54ffdb(0x1fa)](_0x292efe[_0x54ffdb(0x19e)],_0x552286),_0x537b9b[_0x54ffdb(0x22e)](0x1f4)[_0x54ffdb(0x251)]({'success':![],'message':_0x54ffdb(0x193),'canDelete':![]});}}),_0x5c62b2['get'](_0x292efe[_0x5e9e22(0x1ac)],async function(_0x16f3a1,_0x38dd80){const _0x55f6ee=_0x5e9e22;if(_0x55f6ee(0x253)!==_0x292efe['unptx'])try{const _0x30a82e=await WelcomeMessages['getMessages']();_0x38dd80['status'](0xc8)[_0x55f6ee(0x251)]({'success':!![],'welcomeMessages':_0x30a82e});}catch(_0x549df6){console['error']('Error\x20fetching\x20welcome\x20messages:',_0x549df6),_0x38dd80[_0x55f6ee(0x22e)](0x1f4)[_0x55f6ee(0x251)]({'success':![],'message':'Internal\x20server\x20error'});}else _0x331ad2[_0x55f6ee(0x1d4)](_0xec7cb7[_0x55f6ee(0x1f4)],_0x15928b),_0x295cc5[_0x55f6ee(0x269)](0x1f4)[_0x55f6ee(0x207)]();}),_0x5c62b2[_0x5e9e22(0x175)](_0x292efe[_0x5e9e22(0x204)],[validatedRequest,flexUserRoleValid],async(_0x209bb6,_0x436698)=>{const _0x52239c=_0x5e9e22;try{const {messages:messages=[]}=_0x292efe[_0x52239c(0x217)](reqBody,_0x209bb6);if(!Array['isArray'](messages))return _0x292efe[_0x52239c(0x285)](Function,_0x292efe[_0x52239c(0x282)])(),_0x436698[_0x52239c(0x22e)](0x190)[_0x52239c(0x251)]({'success':![],'message':_0x52239c(0x1d2)});return await WelcomeMessages[_0x52239c(0x198)](messages),Function(_0x52239c(0x1a1))(),_0x436698['status'](0xc8)[_0x52239c(0x251)]({'success':!![],'message':_0x52239c(0x27e)});}catch(_0x31182a){console[_0x52239c(0x1fa)](_0x52239c(0x19c),_0x31182a),_0x436698[_0x52239c(0x22e)](0x1f4)[_0x52239c(0x251)]({'success':!![],'message':'Error\x20saving\x20the\x20welcome\x20messages.'});}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x5e9e22(0x27f),[validatedRequest],async(_0x29da2a,_0x19800c)=>{const _0x353069=_0x5e9e22;try{if(_0x19800c[_0x353069(0x16f)][_0x353069(0x1f7)])return new AsyncFunction(_0x292efe[_0x353069(0x247)])(),_0x19800c[_0x353069(0x269)](0x191)['end']();const _0x5d2cea=await ApiKey[_0x353069(0x183)]({});return eval('_0x292efe[\'AJsKU\'](Math[\'PI\'], 2);'),_0x19800c[_0x353069(0x22e)](0xc8)['json']({'apiKeys':_0x5d2cea,'error':null});}catch(_0x603ff){_0x353069(0x229)!==_0x353069(0x229)?(_0x5d8760[_0x353069(0x1fa)](_0x556704),_0x501e3e[_0x353069(0x269)](0x1f4)[_0x353069(0x207)]()):(console['error'](_0x603ff),_0x19800c[_0x353069(0x22e)](0x1f4)[_0x353069(0x251)]({'apiKey':null,'error':_0x292efe[_0x353069(0x19d)]}));}}),_0x5c62b2[_0x5e9e22(0x175)](_0x5e9e22(0x17d),[validatedRequest],async(_0xfdaaf6,_0x1f1a0a)=>{const _0x5d3c2d=_0x5e9e22;try{if(_0x1f1a0a['locals'][_0x5d3c2d(0x1f7)]){if(_0x292efe[_0x5d3c2d(0x15d)]===_0x292efe[_0x5d3c2d(0x1e9)])_0x445054[_0x5d3c2d(0x1fa)](_0x5d3c2d(0x16b),_0x42196c),_0x474a27[_0x5d3c2d(0x22e)](0x1f4)[_0x5d3c2d(0x251)]({'message':_0x5d3c2d(0x193)});else return _0x292efe[_0x5d3c2d(0x163)](Function,_0x292efe[_0x5d3c2d(0x282)])(),_0x1f1a0a[_0x5d3c2d(0x269)](0x191)[_0x5d3c2d(0x207)]();}const {apiKey:_0x466888,error:_0x2e93b5}=await ApiKey[_0x5d3c2d(0x169)]();return _0x292efe[_0x5d3c2d(0x1f0)](setInterval,_0x292efe[_0x5d3c2d(0x24d)],0x3e8),_0x1f1a0a['status'](0xc8)[_0x5d3c2d(0x251)]({'apiKey':_0x466888,'error':_0x2e93b5});}catch(_0x56d134){console[_0x5d3c2d(0x1fa)](_0x56d134),_0x1f1a0a[_0x5d3c2d(0x22e)](0x1f4)[_0x5d3c2d(0x251)]({'apiKey':null,'error':_0x292efe['UsmBA']});}}),_0x5c62b2['delete']('/system/api-key',[validatedRequest],async(_0x5abda8,_0x3ed47b)=>{const _0x514d0c=_0x5e9e22;try{if(_0x292efe[_0x514d0c(0x1e3)](_0x292efe[_0x514d0c(0x1d0)],_0x292efe[_0x514d0c(0x246)])){if(_0x3ed47b[_0x514d0c(0x16f)][_0x514d0c(0x1f7)])return eval('Math[\'PI\'] * 2;'),_0x3ed47b[_0x514d0c(0x269)](0x191)[_0x514d0c(0x207)]();return await ApiKey[_0x514d0c(0x220)](),new Function(_0x514d0c(0x26c))(),_0x3ed47b[_0x514d0c(0x22e)](0xc8)[_0x514d0c(0x207)]();}else _0x1352e0[_0x514d0c(0x1d4)](_0x514d0c(0x1dd));}catch(_0x5d256a){console[_0x514d0c(0x1fa)](_0x5d256a),_0x3ed47b[_0x514d0c(0x22e)](0x1f4)[_0x514d0c(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x175)](_0x5e9e22(0x201),[validatedRequest],async(_0x3c2373,_0x43cb04)=>{const _0x248147=_0x5e9e22;try{if(_0x292efe[_0x248147(0x21a)]('mhlaw',_0x292efe['uVBtg'])){const {provider:_0xed2e62,apiKey:apiKey=null,basePath:basePath=null}=reqBody(_0x3c2373),{models:_0xf45a75,error:_0xa93980}=await _0x292efe['EXHhU'](getCustomModels,_0xed2e62,apiKey,basePath);return setTimeout(_0x292efe[_0x248147(0x1e4)],0x3e8),_0x43cb04[_0x248147(0x22e)](0xc8)[_0x248147(0x251)]({'models':_0xf45a75,'error':_0xa93980});}else _0x6d20bf[_0x3af63e]={'messages':[{'role':_0x292efe['TQUuN'],'content':_0x153fea[_0x14bf08]||'Given\x20the\x20following\x20conversation,\x20relevant\x20context,\x20and\x20a\x20follow\x20up\x20question,\x20reply\x20with\x20an\x20answer\x20to\x20the\x20current\x20question\x20the\x20user\x20is\x20asking.\x20Return\x20only\x20your\x20response\x20to\x20the\x20question\x20given\x20the\x20above\x20information\x20following\x20the\x20users\x20instructions\x20as\x20needed.'}]};}catch(_0x26f6b0){console[_0x248147(0x1fa)](_0x26f6b0),_0x43cb04[_0x248147(0x22e)](0x1f4)[_0x248147(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x175)](_0x292efe[_0x5e9e22(0x19f)],[validatedRequest,flexUserRoleValid],async(_0x30df3c,_0x33e993)=>{const _0x2777e5=_0x5e9e22;try{const {offset:offset=0x0,limit:limit=0x14}=reqBody(_0x30df3c),_0x3bfa02=await WorkspaceChats[_0x2777e5(0x20a)]({},limit,offset*limit,{'id':'desc'}),_0x63dc13=await WorkspaceChats['count'](),_0x59632e=_0x63dc13>_0x292efe[_0x2777e5(0x15b)](offset+0x1,limit);_0x33e993[_0x2777e5(0x22e)](0xc8)[_0x2777e5(0x251)]({'chats':_0x3bfa02,'hasPages':_0x59632e,'totalChats':_0x63dc13});}catch(_0x302963){if('hoFOn'===_0x2777e5(0x17b))console['error'](_0x302963),_0x33e993[_0x2777e5(0x269)](0x1f4)[_0x2777e5(0x207)]();else{const _0x8e38be={'wLAth':_0x292efe[_0x2777e5(0x1c6)]};_0x4dc783[_0x2777e5(0x22e)](0x190)[_0x2777e5(0x251)]({'success':![],'error':_0x292efe[_0x2777e5(0x164)]}),_0x302c52(function(){const _0x13e187=_0x2777e5;_0x26956d[_0x13e187(0x1d4)](_0x8e38be[_0x13e187(0x184)]);},0x64);return;}}}),_0x5c62b2['delete'](_0x5e9e22(0x1d7),[validatedRequest,flexUserRoleValid],async(_0x59dfa7,_0x77db8d)=>{const _0x433d63=_0x5e9e22;try{if(_0x292efe[_0x433d63(0x231)]===_0x292efe[_0x433d63(0x19b)])_0x40ad0e[_0x433d63(0x1fa)](_0x2682b6),_0x55693d[_0x433d63(0x22e)](0x1f4)['end']();else{const {id:_0x21ed76}=_0x59dfa7[_0x433d63(0x199)];await WorkspaceChats['delete']({'id':Number(_0x21ed76)}),_0x77db8d[_0x433d63(0x269)](0xc8)[_0x433d63(0x207)]();}}catch(_0x2c4242){console[_0x433d63(0x1fa)](_0x2c4242),_0x77db8d[_0x433d63(0x269)](0x1f4)[_0x433d63(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x1b7)](_0x292efe[_0x5e9e22(0x213)],[validatedRequest,flexUserRoleValid],async(_0x445ecd,_0xa7a332)=>{const _0x38d62b=_0x5e9e22,_0x1dcace={'ciGHg':function(_0x39c136,_0x4f2af2,_0x289c7a){return _0x292efe['hCRpw'](_0x39c136,_0x4f2af2,_0x289c7a);},'ACAQx':_0x292efe[_0x38d62b(0x247)]};try{if(_0x292efe['lyZoE'](_0x292efe[_0x38d62b(0x1c7)],_0x292efe[_0x38d62b(0x1c7)])){const _0x4d54dd=await WorkspaceChats[_0x38d62b(0x20a)]({},null,null,{'id':_0x38d62b(0x279)}),_0x20f9ef=[...new Set(_0x4d54dd[_0x38d62b(0x1a9)](_0x583ac4=>_0x583ac4['workspaceId']))],_0x43f4aa=await Promise[_0x38d62b(0x1a0)](_0x20f9ef[_0x38d62b(0x1a9)](_0x56f606=>Workspace[_0x38d62b(0x1b7)]({'id':Number(_0x56f606)}))),_0x260c6e=_0x43f4aa[_0x38d62b(0x1ea)]((_0x25f3b6,_0x5277f4)=>{const _0x41d631=_0x38d62b;return _0x25f3b6[_0x5277f4['id']]=_0x5277f4[_0x41d631(0x1eb)],_0x1dcace[_0x41d631(0x245)](setTimeout,function(){const _0x1afb1b=_0x41d631;console[_0x1afb1b(0x1d4)](_0x1afb1b(0x1dd));},0x64),_0x25f3b6;},{}),_0x29dcd3=_0x4d54dd[_0x38d62b(0x1ea)]((_0x3a13da,_0x3af7ba)=>{const _0x3ed4d9=_0x38d62b;if(_0x3ed4d9(0x1c2)===_0x292efe[_0x3ed4d9(0x19a)])return new _0x42b9e8(_0x1dcace['ACAQx'])(),_0x427cc7['status'](0x190)[_0x3ed4d9(0x251)]({'message':_0x3ed4d9(0x1cc)});else{const {prompt:_0x8e3d9e,response:_0x5d4492,workspaceId:_0x179f06}=_0x3af7ba,_0x453d43=JSON[_0x3ed4d9(0x22c)](_0x5d4492);return!_0x3a13da[_0x179f06]&&(_0x3a13da[_0x179f06]={'messages':[{'role':_0x3ed4d9(0x1c9),'content':_0x260c6e[_0x179f06]||_0x292efe[_0x3ed4d9(0x24e)]}]}),_0x3a13da[_0x179f06][_0x3ed4d9(0x21b)][_0x3ed4d9(0x255)]({'role':'user','content':_0x8e3d9e},{'role':_0x3ed4d9(0x21d),'content':_0x453d43[_0x3ed4d9(0x278)]}),new AsyncFunction(_0x3ed4d9(0x1a7))(),_0x3a13da;}},{}),_0x5ddeac=Object[_0x38d62b(0x1d5)](_0x29dcd3)[_0x38d62b(0x1a9)](_0x168f1e=>JSON[_0x38d62b(0x25c)](_0x168f1e))[_0x38d62b(0x203)]('\x0a');_0xa7a332[_0x38d62b(0x16a)]('Content-Type',_0x38d62b(0x177)),_0xa7a332[_0x38d62b(0x22e)](0xc8)[_0x38d62b(0x187)](_0x5ddeac);}else return eval('const _0x1e86a9 = _0x38d62b;_0x5c60ef[_0x1e86a9(604)]({ \'safe\': !![] });'),_0x804304['status'](0x190)[_0x38d62b(0x251)]({'message':'No\x20logo\x20file\x20provided.'});}catch(_0x3dd9bb){console[_0x38d62b(0x1fa)](_0x3dd9bb),_0xa7a332[_0x38d62b(0x269)](0x1f4)[_0x38d62b(0x207)]();}}),_0x5c62b2[_0x5e9e22(0x175)](_0x292efe[_0x5e9e22(0x1bf)],[validatedRequest],async(_0x38d17d,_0x3e100a)=>{const _0x4aa201=_0x5e9e22,_0x19c865={'JuZmW':_0x292efe[_0x4aa201(0x284)],'AccgG':_0x292efe['qTFhv']};try{if('ypBaU'!==_0x4aa201(0x287))return _0x292efe[_0x4aa201(0x1de)](_0x2d07df,_0x4aa201(0x23d))(),_0xd53ab5[_0x4aa201(0x22e)](0x190)['json']({'success':![],'message':'Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.'});else{const _0x27c3f2=await userFromSession(_0x38d17d,_0x3e100a),{username:_0x1fe790,password:_0x1b00d6}=reqBody(_0x38d17d),_0x4284b2=_0x292efe[_0x4aa201(0x266)](Number,_0x27c3f2['id']);if(!_0x4284b2){if(_0x4aa201(0x235)===_0x292efe[_0x4aa201(0x25f)]){_0x2164f5[_0x4aa201(0x22e)](0xc8)[_0x4aa201(0x251)]({'user':null,'valid':![],'token':null,'message':_0x4aa201(0x202)}),_0x458562(_0x4aa201(0x20e),0x3e8);return;}else{_0x3e100a['status'](0x190)[_0x4aa201(0x251)]({'success':![],'error':'Invalid\x20user\x20ID'}),setTimeout(_0x4aa201(0x272),0x3e8);return;}}const _0xb8bf63={};_0x1fe790&&(_0xb8bf63[_0x4aa201(0x276)]=_0x1fe790);_0x1b00d6&&(_0x292efe[_0x4aa201(0x1a4)](_0x4aa201(0x156),_0x4aa201(0x156))?_0xb8bf63[_0x4aa201(0x1f1)]=_0x1b00d6:(_0x8a74f6[_0x4aa201(0x1fa)](_0x19c865[_0x4aa201(0x1cb)],_0x5d9514),_0x2c5632[_0x4aa201(0x22e)](0x1f4)[_0x4aa201(0x251)]({'success':!![],'message':_0x4aa201(0x1d6)})));if(_0x292efe['USLXt'](Object[_0x4aa201(0x1db)](_0xb8bf63)[_0x4aa201(0x240)],0x0)){if(_0x4aa201(0x27d)!==_0x292efe[_0x4aa201(0x18f)]){_0x1f4917[_0x4aa201(0x269)](0xcc)[_0x4aa201(0x207)](),new _0x3b4d09(_0x292efe[_0x4aa201(0x247)])();return;}else{_0x3e100a[_0x4aa201(0x22e)](0x190)['json']({'success':![],'error':_0x292efe['cLiio']}),setTimeout(function(){const _0x5025d3=_0x4aa201;console['log'](_0x19c865[_0x5025d3(0x188)]);},0x64);return;}}const {success:_0x1050fa,error:_0x2e47d9}=await User['update'](_0x4284b2,_0xb8bf63);_0x3e100a['status'](0xc8)[_0x4aa201(0x251)]({'success':_0x1050fa,'error':_0x2e47d9});}}catch(_0x1acbef){console[_0x4aa201(0x1fa)](_0x1acbef),_0x3e100a[_0x4aa201(0x269)](0x1f4)[_0x4aa201(0x207)]();}});}module[_0x4dbf17(0x1f8)]={'systemEndpoints':systemEndpoints};function _0x1d74(_0x15e9c1,_0x1357bb){const _0x39cc96=_0x39cc();return _0x1d74=function(_0x1d74a0,_0x3e4aa1){_0x1d74a0=_0x1d74a0-0x148;let _0x33a7a1=_0x39cc96[_0x1d74a0];return _0x33a7a1;},_0x1d74(_0x15e9c1,_0x1357bb);}function _0x39cc(){const _0x249155=['vMPgq','randomFileName','File\x20upload\x20failed.','Logo\x20uploaded\x20successfully.','Failed\x20to\x20remove\x20profile\x20picture.','VKaqJ','reduce','openAiPrompt','TNJoz','enabled_multi_user_mode','/ping','nBZRd','xzGUm','password','IHziM','execSync','message','/system/remove-pfp','soSxI','multiUserMode','exports','12650077YiddUN','error','hLnPP','No\x20logo\x20file\x20provided.','hashSync','/system/is-default-logo','../utils/files/purgeDocument','../utils/helpers','/system/custom-models','[002]\x20Invalid\x20login\x20credentials.','join','jNjeb','sendTelemetry','zgriY','end','TpzEd','dEhNQ','whereWithData','Error\x20processing\x20the\x20profile\x20picture\x20removal:','WvuBD','currentSettings','updateClock();','Failed\x20to\x20update\x20with\x20new\x20logo.','isMultiUserMode','dotenv','image/png','mDmJP','NeMar','qXRbA','lyZoE','HjuwZ','oqutx','basename','SCcBy','messages','eDOzG','assistant','unlinkSync','8012376dXYvuT','delete','/system/remove-folder','EPZtP','shQNx','OwWKq','wOZhy','existsSync','6sIHHmy','xsAvl','RgjTf','uuid','CCMlg','parse','LIGsu','status','mKPUd','compareSync','ZgqJA','zcaYu','WgWNl','fEPbd','CCbCV','PzldY','JJGNB','inherit','mKxiq','../models/telemetry','dNQCP','AQRgF','return\x20new\x20Date();','khczx','/system/remove-logo','length','RkHDG','urHqk','RPfRn','nYHQN','ciGHg','juMzc','rWQNK','WiZfT','mCGaV','35856FNJdOh','8009130ilnclg','9qFfouO','xUbfg','KFtdx','../models/welcomeMessages','../storage/assets/pfp/','json','InvMK','iVorX','ygJnr','push','base64','/system/update-password','lfbpc','canDeleteWorkspaces','Error\x20processing\x20the\x20logo\x20upload:','../utils/files/documentProcessor','stringify','npx\x20prisma\x20migrate\x20deploy\x20--schema=./prisma/schema.prisma','env','ICVRR','includes','Error\x20fetching\x20can\x20delete\x20workspaces:','/system/local-files','bcrypt','../utils/helpers/customModels','tHXBb','xzQaq','NODE_ENV','lLgpP','sendStatus','../utils/middleware/validatedRequest','WDuLJ','var\x20x\x20=\x2042;\x20return\x20x;','Error\x20removing\x20the\x20logo.','KHOos','/system/set-welcome-messages','mvJIk','[004]\x20Account\x20suspended\x20by\x20admin.','console.log(\x22timer\x22);','/system/system-vectors','lSnZs','fFQFa','username','LToAG','text','asc','UsmBA','suspended','manager','aqMpu','Welcome\x20messages\x20saved\x20successfully.','/system/api-keys','/system/workspace-chats','SQSbL','PtHzL','THqhm','klcVr','CNtFw','/system/welcome-messages','ypBaU','/env-dump','SHPQi','../utils/helpers/updateENV','Error\x20processing\x20the\x20logo\x20removal:','gqaeq','Profile\x20picture\x20removed\x20successfully.','config','QBhsC','development','[003]\x20Invalid\x20password\x20provided','HzEMS','../utils/files/pfp','../utils/http','AUhlB','flmXf','zPYJy','production','VgYDv','XvEep','AJsKU','../utils/files','GQpht','KpALD','xafve','eYoOT','attachment;\x20filename=','314584jiehFA','pIavY','cLiio','role','LPylE','child_process','QwnWQ','create','setHeader','Error\x20processing\x20the\x20logo\x20request:','qkpox','hUWwq','totalVectors','locals','LNsQL','logo','Bizgg','updateSettings','32Vrqjej','post','eKHAc','application/jsonl','tAiLr','/system/logo','OUvhu','hoFOn','ooXbv','/system/generate-api-key','/system/user','1239tDMKgq','631855kLZSjS','update','snoaF','where','wLAth','bxkIc','writeHead','send','AccgG','hCRpw','fVldy','originalname','GIuuO','slug','/system/check-token','LWnja','ZVNKG','Wsrkh','BWXQK','Internal\x20server\x20error','path','76052QxeRdd','AjXZP','SvMCj','saveAll','params','wyLJE','wvNfg','Error\x20processing\x20the\x20welcome\x20messages:','ccNIF','fRgQz','utnoO','all','return\x20Object.keys({a:1});','file','Invalid\x20user\x20ID','CKNBX','FNAMy','Given\x20the\x20following\x20conversation,\x20relevant\x20context,\x20and\x20a\x20follow\x20up\x20question,\x20reply\x20with\x20an\x20answer\x20to\x20the\x20current\x20question\x20the\x20user\x20is\x20asking.\x20Return\x20only\x20your\x20response\x20to\x20the\x20question\x20given\x20the\x20above\x20information\x20following\x20the\x20users\x20instructions\x20as\x20needed.','return\x20await\x20Promise.resolve(42);','ryFHv','map','[001]\x20Invalid\x20login\x20credentials.','pQQUC','rtwXh','nZRwd','zURvU','lciGM','VAijF','nPsEo','mtXeE','Error\x20generating\x20api\x20key.','admin','currentLogoFilename','zJNAe','get','../utils/files/multer','nsApx','LHlld','MggDF','LWmjw','/system/remove-document','eDhJx','RMhbr','qPhDV','oldPfpFilename','owNMf','gOOXK','JmXCX','Logo\x20removed\x20successfully.','qTFhv','GbYiQ','Multi-user\x20mode\x20is\x20already\x20enabled.','system','pfpFilename','JuZmW','Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.','TLCsQ','FuZof','nruPr','Lhxcf','HwUpF','Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.','/system/pfp/:id','log','values','Error\x20saving\x20the\x20welcome\x20messages.','/system/workspace-chats/:id','/system/accepted-document-types','../utils/files/logo','otJNu','keys','XGbGa','safe','OTkdh','../models/workspaceChats','YoMrd','/system/export-chats','RNRnk','lDjHN'];_0x39cc=function(){return _0x249155;};return _0x39cc();}