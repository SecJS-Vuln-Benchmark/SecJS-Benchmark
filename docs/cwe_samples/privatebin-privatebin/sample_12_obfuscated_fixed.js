const _0x108c5d=_0x4158;function _0x4158(_0x23e20c,_0x5e5da9){const _0x28734f=_0x2873();return _0x4158=function(_0x4158b9,_0x43ab4b){_0x4158b9=_0x4158b9-0x1ba;let _0x297486=_0x28734f[_0x4158b9];return _0x297486;},_0x4158(_0x23e20c,_0x5e5da9);}(function(_0x2fc3cc,_0x3a7333){const _0x59048a=_0x4158,_0x5b4e1c=_0x2fc3cc();while(!![]){try{const _0x1c35bf=parseInt(_0x59048a(0x1c3))/0x1+parseInt(_0x59048a(0x1cd))/0x2*(-parseInt(_0x59048a(0x1da))/0x3)+parseInt(_0x59048a(0x1d7))/0x4+-parseInt(_0x59048a(0x1ce))/0x5+parseInt(_0x59048a(0x1c7))/0x6+-parseInt(_0x59048a(0x1bf))/0x7+parseInt(_0x59048a(0x1d9))/0x8*(parseInt(_0x59048a(0x1ba))/0x9);if(_0x1c35bf===_0x3a7333)break;else _0x5b4e1c['push'](_0x5b4e1c['shift']());}catch(_0x3e0b12){_0x5b4e1c['push'](_0x5b4e1c['shift']());}}}(_0x2873,0xbc5ee));function _0x2873(){const _0x4a69e3=['server/utils/yml','server/utils/opennebula','HblLB','QjyXh','split','2aXTslV','7695030kFeKQo','server/utils/constants','server/utils/constants/commands/user','opennebula','kBByq','x509','AiyGN','vGbMN','immutable','2334260zWNoQh','gECnL','132424FcmDre','2228409fpxvgJ','1251TJIyuc','rkMxz','exports','server/routes/api/auth/utils','toObject','5866196JAYvxS','msZqr','OxClW','server/utils/logger','876006MTqFqL','HZYRZ','USER','mCQdo','785790hGkDXj'];_0x2873=function(){return _0x4a69e3;};return _0x2873();}const {Map}=require(_0x108c5d(0x1d6)),{login,setUser,setPass,setType,setTfaToken,setRemember,setNext,setRes,setNodeConnect,connectOpennebula,updaterResponse,remoteLogin,x509Login}=require(_0x108c5d(0x1bd)),{defaults,httpCodes}=require(_0x108c5d(0x1cf)),{Actions}=require(_0x108c5d(0x1d0)),{getFireedgeConfig}=require(_0x108c5d(0x1c8)),{getDefaultParamsOfOpennebulaCommand}=require(_0x108c5d(0x1c9)),{writeInLogger}=require(_0x108c5d(0x1c2)),{internalServerError,unauthorized}=httpCodes,{httpMethod,defaultEmptyFunction}=defaults,{GET}=httpMethod,loginUser=(_0x455b9d='',_0x446b09='',_0x1750f5=defaultEmptyFunction,_0x4bdc9a=defaultEmptyFunction)=>{const _0x15b3e0=_0x108c5d,_0x41d50b={'HZYRZ':function(_0x51510a){return _0x51510a();},'AiyGN':_0x15b3e0(0x1bb),'LnZGE':function(_0x4b713d,_0x72eacc){return _0x4b713d(_0x72eacc);}};_0x446b09&&_0x446b09[_0x15b3e0(0x1c5)]&&!_0x455b9d?_0x1750f5(_0x446b09):'cVdPS'!==_0x41d50b[_0x15b3e0(0x1d4)]?_0x41d50b['LnZGE'](_0x4bdc9a,_0x455b9d):_0x41d50b[_0x15b3e0(0x1c4)](_0x265c3b);},coreAuth=(_0x59d15f={},_0x107ee1=defaultEmptyFunction,_0x355b9b={},_0x2db19c={},_0xa5a2fa=defaultEmptyFunction)=>{const _0x423fa9=_0x108c5d,_0x5c0659={'QjyXh':function(_0x5a2c92,_0x5cbe5f){return _0x5a2c92(_0x5cbe5f);},'msZqr':function(_0x9de871,_0x6b8426){return _0x9de871||_0x6b8426;},'MEEwj':function(_0x33ed33,_0x235845){return _0x33ed33(_0x235845);},'kBByq':function(_0x1240d0,_0x3fa5a3,_0x4ae957,_0x2ceec6,_0x590d5b){return _0x1240d0(_0x3fa5a3,_0x4ae957,_0x2ceec6,_0x590d5b);},'vGbMN':function(_0x5ee808,_0x1d2738){return _0x5ee808&&_0x1d2738;},'JsDKn':function(_0x448916,_0x181d16,_0x2e162d){return _0x448916(_0x181d16,_0x2e162d);},'OxClW':function(_0x49de39){return _0x49de39();}},{user:_0x46491b,token:_0x34da00,type:_0x39e6b3,token2fa:_0x203948,remember:_0x1b8af6}=_0x355b9b;setNext(_0x107ee1),setNodeConnect(_0xa5a2fa),updaterResponse(new Map(internalServerError)[_0x423fa9(0x1be)]());if(_0x5c0659[_0x423fa9(0x1d5)](_0x46491b,_0x34da00)){const _0x4f12e5=_0x5c0659['JsDKn'](connectOpennebula,_0x46491b,_0x34da00),_0x11747f=_0x5caf04=>{const _0x328394=_0x423fa9,_0x205754='5|1|4|6|3|2|0'[_0x328394(0x1cc)]('|');let _0x31f807=0x0;while(!![]){switch(_0x205754[_0x31f807++]){case'0':_0x5c0659[_0x328394(0x1cb)](login,_0x5caf04);continue;case'1':_0x5c0659[_0x328394(0x1cb)](setUser,_0x46491b||'');continue;case'2':setRemember(_0x5c0659[_0x328394(0x1c0)](_0x1b8af6,![]));continue;case'3':_0x5c0659['MEEwj'](setTfaToken,_0x203948||'');continue;case'4':setPass(_0x34da00||'');continue;case'5':_0x5c0659[_0x328394(0x1cb)](setRes,_0x59d15f);continue;case'6':setType(_0x5c0659['msZqr'](_0x39e6b3,''));continue;}break;}},_0x4bac51=_0x49af52=>{const _0x7f70f8=_0x423fa9;setRes(_0x59d15f);const _0x11b909=_0x49af52?internalServerError:unauthorized;updaterResponse(new Map(_0x11b909)[_0x7f70f8(0x1be)]()),writeInLogger(_0x11b909),_0x107ee1();};_0x4f12e5({'action':Actions['USER_INFO'],'parameters':getDefaultParamsOfOpennebulaCommand(Actions['USER_INFO'],GET),'callback':(_0x235ee2,_0x4107ad)=>{const _0x4ecc87=_0x423fa9;_0x5c0659[_0x4ecc87(0x1d2)](loginUser,_0x235ee2,_0x4107ad,_0x11747f,_0x4bac51);},'fillHookResource':![]});}else _0x5c0659[_0x423fa9(0x1c1)](_0x107ee1);},remoteAuth=(_0x120bf0={},_0x27bb20=defaultEmptyFunction,_0x49dd5c={},_0xdbde84,_0xedae60=defaultEmptyFunction,_0x510b2f)=>{const _0x1171e0=_0x108c5d,_0x3420a0={'gECnL':function(_0x18eb16,_0x3cd5c0){return _0x18eb16(_0x3cd5c0);},'mCQdo':function(_0x45c16a,_0x199645){return _0x45c16a(_0x199645);},'oIipT':_0x1171e0(0x1d3),'ZevFN':function(_0x25ed06,_0x25e155,_0x43c29d){return _0x25ed06(_0x25e155,_0x43c29d);}},{user:_0x3e928a}=_0x49dd5c;_0x3420a0[_0x1171e0(0x1d8)](setNext,_0x27bb20),_0x3420a0[_0x1171e0(0x1c6)](setNodeConnect,_0xedae60),_0x3420a0[_0x1171e0(0x1c6)](updaterResponse,new Map(internalServerError)['toObject']());if(_0x3e928a)switch(_0x510b2f){case _0x3420a0['oIipT']:_0x3420a0['ZevFN'](x509Login,_0x3e928a,_0x120bf0);break;default:remoteLogin(_0x3e928a,_0x120bf0);break;}else _0x27bb20();},selectTypeAuth=(_0x49fa75={},_0x2b3c6e=defaultEmptyFunction,_0x2c7c15={},_0x204a67={},_0xc63208=defaultEmptyFunction)=>{const _0xafc44e=_0x108c5d,_0x56d98c={'HblLB':function(_0x44303d){return _0x44303d();}},_0x2493a7=_0x56d98c[_0xafc44e(0x1ca)](getFireedgeConfig),_0x3ffdb0={'remote':()=>remoteAuth(_0x49fa75,_0x2b3c6e,_0x2c7c15,_0x204a67,_0xc63208),'x509':()=>remoteAuth(_0x49fa75,_0x2b3c6e,_0x2c7c15,_0x204a67,_0xc63208,_0xafc44e(0x1d3)),'opennebula':()=>coreAuth(_0x49fa75,_0x2b3c6e,_0x2c7c15,_0x204a67,_0xc63208)},_0x2a5535=_0x3ffdb0[_0x2493a7?.['auth']]||_0x3ffdb0[_0xafc44e(0x1d1)];return _0x2a5535();};module[_0x108c5d(0x1bc)]={'selectTypeAuth':selectTypeAuth};