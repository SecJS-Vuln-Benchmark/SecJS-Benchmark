const _0x1419af=_0x1e95;(function(_0x31e6a5,_0x1193f0){const _0x5bc26b=_0x1e95,_0x5e0c0b=_0x31e6a5();while(!![]){try{const _0x125622=parseInt(_0x5bc26b(0x16e))/0x1+-parseInt(_0x5bc26b(0x135))/0x2+parseInt(_0x5bc26b(0x115))/0x3+parseInt(_0x5bc26b(0x11e))/0x4*(parseInt(_0x5bc26b(0x152))/0x5)+parseInt(_0x5bc26b(0x141))/0x6*(-parseInt(_0x5bc26b(0x155))/0x7)+-parseInt(_0x5bc26b(0x150))/0x8+parseInt(_0x5bc26b(0x142))/0x9*(parseInt(_0x5bc26b(0x16b))/0xa);if(_0x125622===_0x1193f0)break;else _0x5e0c0b['push'](_0x5e0c0b['shift']());}catch(_0x56f407){_0x5e0c0b['push'](_0x5e0c0b['shift']());}}}(_0xaa16,0x4a701));const {DateTime}=require('luxon'),{parse}=require(_0x1419af(0x14e)),{global,Array}=require(_0x1419af(0x16c)),{Actions:ActionUsers}=require('server/utils/constants/commands/user'),{Actions:ActionZones}=require('server/utils/constants/commands/zone'),{defaults,httpCodes}=require(_0x1419af(0x13a)),{getFireedgeConfig}=require(_0x1419af(0x171)),{createJWT,check2Fa}=require(_0x1419af(0x139)),{httpResponse,encrypt,getSunstoneAuth}=require(_0x1419af(0x123)),{responseOpennebula,getDefaultParamsOfOpennebulaCommand}=require(_0x1419af(0x173)),{httpMethod,defaultSessionExpiration,default2FAOpennebulaVar,defaultNamespace,defaultEmptyFunction,defaultSessionLimitExpiration,defaultRememberSessionExpiration}=defaults,{ok,unauthorized,accepted,internalServerError}=httpCodes,{GET}=httpMethod,{USER_INFO,USER_POOL_INFO}=ActionUsers,{ZONE_POOL_INFO}=ActionZones;let user='',pass='',type='',tfatoken='',remember=![],next=defaultEmptyFunction,req={},res={},nodeConnect=defaultEmptyFunction;const getUser=()=>user,getPass=()=>pass,setUser=_0x492591=>{return user=_0x492591,user;},setPass=_0x33a920=>{return pass=_0x33a920,pass;},setType=_0x508a8b=>{return type=_0x508a8b,type;},setTfaToken=_0x28ef07=>{return tfatoken=_0x28ef07,tfatoken;},setRemember=_0x27ca86=>{return remember=_0x27ca86,remember;},setNext=(_0x3b9fff=defaultEmptyFunction)=>{return next=_0x3b9fff,next;},setReq=(_0x4928d5={})=>{return req=_0x4928d5,req;},setNodeConnect=(_0x3efcd2=defaultEmptyFunction)=>{return nodeConnect=_0x3efcd2,nodeConnect;},setRes=(_0x4c1273={})=>{return res=_0x4c1273,res;},setDates=()=>{const _0xb641cc=_0x1419af,_0x3bcee6={'oMMuh':function(_0x2ec285,_0x1ef378,_0x38059a){return _0x2ec285(_0x1ef378,_0x38059a);},'GAJDl':'seconds'},_0x485b3f=getFireedgeConfig(),_0x182cd0=remember?_0x485b3f['session_remember_expiration']||defaultRememberSessionExpiration:_0x485b3f['session_expiration']||defaultSessionExpiration,_0x4da325=_0x3bcee6['oMMuh'](parseInt,_0x485b3f['minimum_opennebula_expiration'],0xa)||defaultSessionLimitExpiration,_0x1373d9=DateTime[_0xb641cc(0x143)](),_0x8e8a1e=_0x1373d9['plus']({'minutes':_0x182cd0}),_0xb49ab2=_0x8e8a1e['diff'](_0x1373d9,_0x3bcee6[_0xb641cc(0x127)]);return{'now':_0x1373d9,'nowUnix':_0x1373d9['toSeconds'](),'limitToken':_0x182cd0,'limitExpirationReuseToken':_0x4da325,'expireTime':_0x8e8a1e[_0xb641cc(0x161)](),'relativeTime':_0xb49ab2[_0xb641cc(0x118)]};},connectOpennebula=(_0x1fff0f='',_0x3ddbbf='')=>{const _0x4607cf=_0x1419af,_0x161e08={'hdzSv':function(_0x2e747e,_0x188bf7){return _0x2e747e||_0x188bf7;}},_0xd60fb4=_0x1fff0f||user,_0x5ddf38=_0x161e08[_0x4607cf(0x129)](_0x3ddbbf,pass);return nodeConnect(_0xd60fb4,_0x5ddf38);},updaterResponse=_0x1754b8=>{const _0x3396fb=_0x1419af,_0xb257cc={'BJBud':function(_0x43d031,_0x36c360){return _0x43d031 in _0x36c360;}};_0xb257cc[_0x3396fb(0x148)]('id',_0x1754b8)&&_0x3396fb(0x131)in _0x1754b8&&res?.[_0x3396fb(0x172)]?.[_0x3396fb(0x149)]&&(res[_0x3396fb(0x172)][_0x3396fb(0x149)]=_0x1754b8);},validate2faAuthentication=_0x3a7f2d=>{const _0x5e9439=_0x1419af,_0x3b3de0={'gUIPr':function(_0x13fecd,_0x215e74){return _0x13fecd<=_0x215e74;},'BCPpv':function(_0x300f97,_0x5661a8){return _0x300f97(_0x5661a8);},'ZLIRk':function(_0x1251a8,_0x721f92,_0x5130cf){return _0x1251a8(_0x721f92,_0x5130cf);},'arKwQ':function(_0x24dbe8,_0x55ea39,_0x197dc2){return _0x24dbe8(_0x55ea39,_0x197dc2);},'fDunj':function(_0x4ff7a9,_0x4c2c82,_0x3391e7,_0x38776f){return _0x4ff7a9(_0x4c2c82,_0x3391e7,_0x38776f);},'sknZJ':_0x5e9439(0x158),'KCYCQ':function(_0x31cd60,_0x595d2a){return _0x31cd60!==_0x595d2a;},'cYOca':'NDOUs'};let _0x40a4ab=![];const _0x58d1a3=_0x3a7f2d?.['TEMPLATE'];if(_0x58d1a3?.[_0x5e9439(0x128)]?.[default2FAOpennebulaVar]||_0x58d1a3?.[_0x5e9439(0x177)]?.[default2FAOpennebulaVar]){if(_0x5e9439(0x124)!=='VzXmI'){if(_0x3b3de0[_0x5e9439(0x11d)](tfatoken['length'],0x0))_0x3b3de0[_0x5e9439(0x157)](updaterResponse,_0x3b3de0[_0x5e9439(0x13f)](httpResponse,accepted,{'id':_0x3a7f2d?.['ID']}));else{const _0x4b1765=_0x58d1a3[_0x5e9439(0x177)]?.[default2FAOpennebulaVar]||_0x58d1a3['SUNSTONE']?.[default2FAOpennebulaVar];!_0x3b3de0[_0x5e9439(0x137)](check2Fa,_0x4b1765,tfatoken)?_0x3b3de0['BCPpv'](updaterResponse,_0x3b3de0[_0x5e9439(0x130)](httpResponse,unauthorized,'',_0x3b3de0[_0x5e9439(0x16f)])):_0x3b3de0[_0x5e9439(0x13c)](_0x3b3de0[_0x5e9439(0x167)],'NDOUs')?(_0x754b6a(),_0x2cd3e2(_0x1e529d[_0x5e9439(0x168)])&&(_0x9efcfd=![],_0x121069(_0xe891f0[_0x5e9439(0x168)]))):_0x40a4ab=!![];}}else _0x30050e['users'][_0x520d63]={'tokens':[]};}else _0x40a4ab=!![];return _0x40a4ab;},genJWT=(_0x54d00b,_0x4de671)=>{const _0x297f5f=_0x1419af,_0x462a46={'kvQyu':function(_0x573c7b,_0x36baf8){return _0x573c7b(_0x36baf8);},'FLzzW':function(_0x4c303f,_0x59de3e,_0x55c4e2){return _0x4c303f(_0x59de3e,_0x55c4e2);}};if(_0x54d00b?.[_0x297f5f(0x134)]&&_0x54d00b?.['token']&&_0x4de671?.['ID']&&_0x4de671?.[_0x297f5f(0x15f)]){const {ID:_0x217fea,TEMPLATE:_0xaba5f9,NAME:_0x5aea13}=_0x4de671,_0x156cd7=createJWT({'id':_0x217fea,'user':_0x5aea13,'token':_0x54d00b[_0x297f5f(0x140)]});if(_0x156cd7){const _0x5c22ac={'token':_0x156cd7,'id':_0x217fea};_0xaba5f9?.[_0x297f5f(0x128)]?.[_0x297f5f(0x114)]&&(_0x5c22ac[_0x297f5f(0x136)]=_0xaba5f9[_0x297f5f(0x128)]['LANG']),_0x462a46['kvQyu'](updaterResponse,_0x462a46[_0x297f5f(0x12b)](httpResponse,ok,_0x5c22ac));}}},getCreatedTokenOpennebula=(_0x2bb2bf='')=>{const _0x23d659=_0x1419af,_0x2e8c7a={'ppSPd':function(_0x15cd04,_0x5429e2){return _0x15cd04===_0x5429e2;},'ttgxB':function(_0x49529d,_0x4a2201){return _0x49529d<=_0x4a2201;},'iPYMQ':function(_0x51418f,_0x3b0a6a){return _0x51418f>_0x3b0a6a;}},{now:_0x188b02,nowUnix:_0x1a40c4,limitExpirationReuseToken:_0x8cfe4d}=setDates();if(_0x2bb2bf&&global?.[_0x23d659(0x160)]?.[_0x2bb2bf]?.['tokens']){let _0x16469a={'token':'','time':0x0};global[_0x23d659(0x160)][_0x2bb2bf][_0x23d659(0x117)][_0x23d659(0x17f)]((_0x3a003={},_0xa10c81=0x0)=>{const _0x16a0f3=_0x23d659;if(_0x2e8c7a[_0x16a0f3(0x13b)](_0x16a0f3(0x15c),_0x16a0f3(0x15c))){const _0x3a59fa=parseInt(_0x3a003[_0x16a0f3(0x134)],0xa);_0x2e8c7a[_0x16a0f3(0x13e)](_0x3a59fa,_0x1a40c4)&&delete global[_0x16a0f3(0x160)][_0x2bb2bf][_0x16a0f3(0x117)][_0xa10c81],_0x2e8c7a[_0x16a0f3(0x15a)](DateTime['fromSeconds'](_0x3a59fa)[_0x16a0f3(0x147)]({'minutes':_0x8cfe4d}),_0x188b02)&&_0x2e8c7a['iPYMQ'](_0x3a59fa,_0x16469a[_0x16a0f3(0x134)])&&(_0x16469a={'token':_0x3a003[_0x16a0f3(0x140)],'time':_0x3a003['time']});}else return _0x17342=_0x5e4f37,_0x31bec8;});if(_0x16469a['token']&&_0x16469a['time'])return _0x16469a;}},setZones=()=>{const _0xf492b7=_0x1419af,_0x4c6de6={'KJyUL':function(_0x207e7b,_0x3d3f6d,_0x1f2daf,_0x3bf5ea,_0x496771,_0x1bda65){return _0x207e7b(_0x3d3f6d,_0x1f2daf,_0x3bf5ea,_0x496771,_0x1bda65);},'LPxYl':function(_0x7a6293){return _0x7a6293();}};if(global&&!global[_0xf492b7(0x156)]){const _0x184484=_0x4c6de6[_0xf492b7(0x12e)](connectOpennebula);_0x184484({'action':ZONE_POOL_INFO,'parameters':getDefaultParamsOfOpennebulaCommand(ZONE_POOL_INFO,GET),'callback':(_0x487515,_0x108d2c)=>{const _0x57f250=_0xf492b7;_0x4c6de6[_0x57f250(0x145)](responseOpennebula,()=>undefined,_0x487515,_0x108d2c,_0x354278=>{const _0x345826=_0x57f250,_0x57ef27={'Gxvba':function(_0x4e39d6,_0x58160e){return _0x4e39d6(_0x58160e);}};if(_0x354278&&_0x354278['ZONE_POOL']&&_0x354278['ZONE_POOL']['ZONE']){const _0x5423a5=!Array['isArray'](_0x354278[_0x345826(0x17c)][_0x345826(0x151)])?[_0x354278['ZONE_POOL'][_0x345826(0x151)]]:_0x354278[_0x345826(0x17c)][_0x345826(0x151)];global[_0x345826(0x156)]=_0x5423a5['map'](_0x142d0e=>{const _0x5e867e=_0x345826,_0x55af3d=_0x142d0e?.['TEMPLATE']?.['ENDPOINT']||'',_0x171602=_0x55af3d&&_0x57ef27[_0x5e867e(0x12c)](parse,_0x55af3d),_0x152de4=_0x171602[_0x5e867e(0x116)]||'',_0x1426a5={'id':_0x142d0e['ID']||'','name':_0x142d0e[_0x5e867e(0x15f)]||'','rpc':_0x55af3d,'zeromq':_0x5e867e(0x122)+_0x152de4+':2101'};return _0x142d0e?.['TEMPLATE']?.[_0x5e867e(0x182)]&&(_0x1426a5[_0x5e867e(0x13d)]=_0x142d0e?.[_0x5e867e(0x120)]?.['FIREEDGE_ENDPOINT']),_0x1426a5;});}},next);},'fillHookResource':![]});}},createTokenServerAdmin=({username:_0x38f429,key:_0xbae2c6,iv:_0x3de82b,serverAdmin:serverAdmin=_0x38f429})=>{const _0x38e343=_0x1419af,_0x2c9229={'XYRGE':function(_0x228be1,_0x434133){return _0x228be1&&_0x434133;},'EQlaj':function(_0x2449b6,_0x4f40f1,_0x5b3ba9,_0x4385e9){return _0x2449b6(_0x4f40f1,_0x5b3ba9,_0x4385e9);}};if(_0x2c9229[_0x38e343(0x133)](_0x38f429,_0xbae2c6)&&_0x3de82b){const {expireTime:_0x1a86c8}=setDates(),_0xfb1a99=parseInt(_0x1a86c8,0xa);return{'token':_0x2c9229[_0x38e343(0x170)](encrypt,serverAdmin+':'+_0x38f429+':'+_0xfb1a99,_0xbae2c6,_0x3de82b),'time':_0xfb1a99};}},wrapUserWithServerAdmin=(_0xdf5dbf={},_0x3f2d56={})=>{const _0x224915=_0x1419af,_0x17cd1c={'VVHBe':function(_0x2c7022,_0x4cfea6){return _0x2c7022&&_0x4cfea6;},'MHhJj':function(_0x5ee762){return _0x5ee762();},'lDHDe':function(_0x584d69,_0x18d876,_0x140d27,_0x320968){return _0x584d69(_0x18d876,_0x140d27,_0x320968);},'cWOgi':_0x224915(0x15d),'GAdLp':function(_0x7032d6,_0x2ffaae){return _0x7032d6(_0x2ffaae);},'XXLOT':_0x224915(0x17d),'Cvoww':function(_0x19d010,_0x3f8b73,_0x114247){return _0x19d010(_0x3f8b73,_0x114247);},'errit':function(_0x526183){return _0x526183();}};let _0x1cecf7='',_0x46468e='',_0x45f0ea='';const {relativeTime:_0x563eeb,expireTime:_0x550b08}=setDates();if(_0x563eeb&&_0xdf5dbf?.[_0x224915(0x168)]&&(_0x1cecf7=_0xdf5dbf[_0x224915(0x168)][_0x224915(0x15f)])&&(_0x46468e=_0xdf5dbf[_0x224915(0x168)]['PASSWORD'])&&_0x3f2d56&&(_0x45f0ea=_0x3f2d56['NAME'])&&_0x3f2d56['ID']&&_0x3f2d56[_0x224915(0x120)]){if(_0x224915(0x174)!==_0x17cd1c[_0x224915(0x179)]){const _0x29ee95=_0x1cecf7+':'+_0x45f0ea;let _0x2fa160,_0x4cec72=![];const _0x30d41d=_0x17cd1c[_0x224915(0x178)](getCreatedTokenOpennebula,_0x29ee95);_0x30d41d?_0x2fa160=_0x30d41d:(_0x4cec72=!![],_0x2fa160=createTokenServerAdmin({'serverAdmin':_0x1cecf7,'username':_0x45f0ea,'key':_0x46468e[_0x224915(0x169)](0x0,0x20),'iv':_0x46468e[_0x224915(0x169)](0x0,0x10)}));if(_0x2fa160){if(_0x4cec72){!global[_0x224915(0x160)]&&(global['users']={});if(!global[_0x224915(0x160)][_0x29ee95]){if(_0x17cd1c[_0x224915(0x146)]!==_0x17cd1c[_0x224915(0x146)])return _0x4b324c=_0x956a42,_0x589df7;else global['users'][_0x29ee95]={'tokens':[]};}!_0x30d41d&&global[_0x224915(0x160)][_0x29ee95][_0x224915(0x117)][_0x224915(0x181)]({'token':_0x2fa160['token'],'time':_0x17cd1c[_0x224915(0x165)](parseInt,_0x550b08,0xa)});}genJWT(_0x2fa160,{'NAME':_0x29ee95,'ID':_0x3f2d56['ID'],'TEMPLATE':_0x3f2d56[_0x224915(0x120)]}),_0x17cd1c[_0x224915(0x153)](next);}}else{if(_0x17cd1c['VVHBe'](_0x1ff23a,_0x3cfbcc)&&_0x5e328c){const {expireTime:_0x49b109}=_0x17cd1c[_0x224915(0x153)](_0xd14893),_0x4a505a=_0x8f27a8(_0x49b109,0xa);return{'token':_0x17cd1c[_0x224915(0x119)](_0x588e44,_0x18b393+':'+_0x175614+':'+_0x4a505a,_0x1353c3,_0x2f78eb),'time':_0x4a505a};}}}else updaterResponse(_0x17cd1c[_0x224915(0x178)](httpResponse,internalServerError)),_0x17cd1c[_0x224915(0x11c)](next);},getServerAdmin=()=>{const _0x534abe=_0x1419af,_0x915254={'kDigv':function(_0x45ecd4){return _0x45ecd4();},'VEASv':function(_0x5189c6,_0x41fa59){return _0x5189c6!==_0x41fa59;},'RlzDc':_0x534abe(0x14b)},_0x3e77b4=_0x915254[_0x534abe(0x17e)](getSunstoneAuth),{username:_0x48b79c,key:_0x48abaf,iv:_0x29f7b3}=_0x3e77b4;if(_0x48b79c&&_0x48abaf&&_0x29f7b3){if(_0x915254['VEASv'](_0x534abe(0x14f),_0x915254['RlzDc']))return{..._0x3e77b4,'token':createTokenServerAdmin({'serverAdmin':_0x48b79c,'username':_0x48b79c,'key':_0x48abaf,'iv':_0x29f7b3})};else _0x1b095b[_0x534abe(0x160)]={};}},getServerAdminAndWrapUser=(_0x2a438d={})=>{const _0x6ef128=_0x1419af,_0x1e0a94={'EpneG':function(_0x3940e8,_0x52049a){return _0x3940e8&&_0x52049a;},'ApLlu':function(_0x1d8610,_0x1a0642){return _0x1d8610(_0x1a0642);},'SMjKe':function(_0x402c00,_0x5e411e,_0x26fa91){return _0x402c00(_0x5e411e,_0x26fa91);}},_0x121cb8=getServerAdmin(),{username:_0x3956e1,token:_0x20909b}=_0x121cb8;if(_0x1e0a94['EpneG'](_0x3956e1,_0x20909b)){const _0xb3a783=connectOpennebula(_0x3956e1+':'+_0x3956e1,_0x20909b[_0x6ef128(0x140)]);_0x1e0a94['ApLlu'](_0xb3a783,{'action':USER_INFO,'parameters':_0x1e0a94['SMjKe'](getDefaultParamsOfOpennebulaCommand,USER_INFO,GET),'callback':(_0x29fa51,_0x131472)=>{responseOpennebula(updaterResponse,_0x29fa51,_0x131472,(_0x1fac36={})=>wrapUserWithServerAdmin(_0x1fac36,_0x2a438d),next);},'fillHookResource':![]});}},remoteLogin=(_0x2a8d12='')=>{const _0x264c18=_0x1419af,_0x13d7d7={'HKXmV':function(_0x6476b5){return _0x6476b5();},'eeOZz':_0x264c18(0x126),'WNLFo':function(_0xec131f,_0x51f635){return _0xec131f(_0x51f635);},'QXZlX':function(_0x42f0e1,_0x4b9640,_0x44591f){return _0x42f0e1(_0x4b9640,_0x44591f);}},_0x51f07f=getServerAdmin(),{username:_0x463cf1,token:_0x4d69c0}=_0x51f07f,[_0x6ccf4e,_0x2b00aa=_0x6ccf4e]=_0x2a8d12[_0x264c18(0x15b)](':');if(_0x463cf1&&_0x4d69c0&&_0x6ccf4e&&_0x2b00aa){const _0x1eab99=connectOpennebula(_0x463cf1+':'+_0x463cf1,_0x4d69c0['token']);_0x1eab99({'action':USER_POOL_INFO,'parameters':_0x13d7d7[_0x264c18(0x11f)](getDefaultParamsOfOpennebulaCommand,USER_POOL_INFO,GET),'callback':(_0x12a9ac,_0x2ab789)=>{const _0x64bddc=_0x264c18;if(_0x64bddc(0x126)===_0x13d7d7[_0x64bddc(0x12f)]){const _0x6e02ad=_0x2ab789?.[_0x64bddc(0x175)]?.[_0x64bddc(0x168)]||[];if(_0x6e02ad['length']){const _0x26661e=_0x6e02ad[_0x64bddc(0x12d)](_0x5eb9ef=>_0x5eb9ef['NAME']===_0x6ccf4e&&_0x5eb9ef[_0x64bddc(0x138)]===_0x2b00aa&&_0x5eb9ef[_0x64bddc(0x180)]===_0x64bddc(0x11a));_0x26661e?(setZones(),_0x13d7d7[_0x64bddc(0x154)](getServerAdminAndWrapUser,_0x26661e)):next();}}else _0x13d7d7['HKXmV'](_0x4331b5);},'fillHookResource':![]});}},x509Login=(_0x4ff954='')=>{const _0x36982b=_0x1419af,_0x365ef6={'utYKF':function(_0x4e0dc1,_0x5d3557){return _0x4e0dc1===_0x5d3557;},'afPYk':_0x36982b(0x17b),'KkWCm':function(_0x4adaf4){return _0x4adaf4();},'JVNAW':function(_0x238193,_0x436b1d){return _0x238193(_0x436b1d);},'Hioel':function(_0x27d345,_0x4d06dd,_0x50adf8){return _0x27d345(_0x4d06dd,_0x50adf8);},'RROgv':function(_0x182ada,_0x546b27){return _0x182ada(_0x546b27);}},_0x30c220=getServerAdmin(),{username:_0x23532c,token:_0x48a5b9}=_0x30c220;if(_0x23532c&&_0x48a5b9&&_0x4ff954){const _0x5c110f=_0x14c893=>/,/[_0x36982b(0x16a)](_0x14c893)?_0x14c893['split'](',')['reverse']()['join']('/'):_0x14c893,_0xfed6f=_0x365ef6[_0x36982b(0x166)](_0x5c110f,_0x4ff954),_0x2a4cee=_0x365ef6['Hioel'](connectOpennebula,_0x23532c+':'+_0x23532c,_0x48a5b9[_0x36982b(0x140)]);_0x365ef6['RROgv'](_0x2a4cee,{'action':USER_POOL_INFO,'parameters':_0x365ef6[_0x36982b(0x176)](getDefaultParamsOfOpennebulaCommand,USER_POOL_INFO,GET),'callback':(_0x228174,_0x2b8d31)=>{const _0x4613db=_0x36982b,_0x360073=_0x2b8d31?.[_0x4613db(0x175)]?.[_0x4613db(0x168)]||[];if(_0x360073[_0x4613db(0x121)]){if(_0x365ef6['utYKF'](_0x4613db(0x16d),_0x365ef6[_0x4613db(0x12a)]))_0x1d7cc6[_0x4613db(0x172)]['httpCode']=_0x478fa7;else{const _0x24877f=_0x360073[_0x4613db(0x12d)](_0xe6843d=>_0xe6843d[_0x4613db(0x138)][_0x4613db(0x14a)](_0xfed6f)&&_0xe6843d[_0x4613db(0x180)]===_0x4613db(0x17a));_0x24877f?(setZones(),getServerAdminAndWrapUser(_0x24877f)):_0x365ef6[_0x4613db(0x11b)](next);}}},'fillHookResource':![]});}},login=_0x13ff52=>{const _0x399901=_0x1419af,_0x10063a={'EWxZr':function(_0x358ada){return _0x358ada();},'wgQSa':function(_0x419f73,_0x5e9dd1){return _0x419f73!==_0x5e9dd1;},'DcFqU':_0x399901(0x162),'XaEpC':function(_0x1eb085,_0x8cbb4b){return _0x1eb085(_0x8cbb4b);},'bPdMt':function(_0x19aa93,_0x350761){return _0x19aa93(_0x350761);}};let _0x5d02d3=![];if(_0x13ff52){const _0x3b8ac0=getFireedgeConfig(),_0x1ee746=_0x3b8ac0[_0x399901(0x132)]||defaultNamespace,_0x3d26f1='['+_0x1ee746+'.'+USER_INFO+']';if(_0x13ff52[_0x399901(0x14d)]&&_0x13ff52[_0x399901(0x14d)](_0x3d26f1)>=0x0){if(_0x10063a[_0x399901(0x164)](_0x10063a[_0x399901(0x163)],_0x399901(0x162))){const _0x1121bf=_0x3c5ca6['find'](_0x1f8291=>_0x1f8291[_0x399901(0x138)]['includes'](_0x1cf739)&&_0x1f8291[_0x399901(0x180)]===_0x399901(0x17a));_0x1121bf?(_0x10063a[_0x399901(0x125)](_0x379e80),_0x38db2d(_0x1121bf)):_0x110378();}else _0x10063a[_0x399901(0x14c)](updaterResponse,_0x10063a[_0x399901(0x159)](httpResponse,unauthorized));}else{if(_0x399901(0x15e)!==_0x399901(0x144))_0x5d02d3=!![];else return _0x169361=_0x9798c2,_0x50feff;}_0x13ff52['USER']&&(_0x10063a['EWxZr'](setZones),validate2faAuthentication(_0x13ff52[_0x399901(0x168)])&&(_0x5d02d3=![],_0x10063a[_0x399901(0x159)](getServerAdminAndWrapUser,_0x13ff52[_0x399901(0x168)])));}_0x5d02d3&&next();};module['exports']={'login':login,'getUser':getUser,'getPass':getPass,'setType':setType,'setUser':setUser,'setPass':setPass,'setTfaToken':setTfaToken,'setRemember':setRemember,'setNext':setNext,'setReq':setReq,'setRes':setRes,'updaterResponse':updaterResponse,'setNodeConnect':setNodeConnect,'connectOpennebula':connectOpennebula,'getCreatedTokenOpennebula':getCreatedTokenOpennebula,'createTokenServerAdmin':createTokenServerAdmin,'remoteLogin':remoteLogin,'x509Login':x509Login,'getServerAdmin':getServerAdmin};function _0x1e95(_0x1ddfe4,_0x46e318){const _0xaa1638=_0xaa16();return _0x1e95=function(_0x1e95fa,_0x253d35){_0x1e95fa=_0x1e95fa-0x114;let _0x436f1b=_0xaa1638[_0x1e95fa];return _0x436f1b;},_0x1e95(_0x1ddfe4,_0x46e318);}function _0xaa16(){const _0x15f2ca=['DcFqU','wgQSa','Cvoww','JVNAW','cYOca','USER','substring','test','10eDAooG','window-or-global','HPKZp','89632arfPhx','sknZJ','EQlaj','server/utils/yml','locals','server/utils/opennebula','UJPmD','USER_POOL','Hioel','FIREEDGE','GAdLp','cWOgi','x509','rmlWz','ZONE_POOL','yvEIk','kDigv','forEach','AUTH_DRIVER','push','FIREEDGE_ENDPOINT','LANG','1555032aeSHGR','hostname','tokens','seconds','lDHDe','public','KkWCm','errit','gUIPr','3352GROWzt','QXZlX','TEMPLATE','length','tcp://','server/utils/server','xSelW','EWxZr','nJjVV','GAJDl','SUNSTONE','hdzSv','afPYk','FLzzW','Gxvba','find','LPxYl','eeOZz','fDunj','message','namespace','XYRGE','time','438438mPNwsG','language','arKwQ','PASSWORD','server/utils/jwt','server/utils/constants','ppSPd','KCYCQ','fireedge','ttgxB','ZLIRk','token','726pcZwmW','1977741JTYJMs','local','BtykT','KJyUL','XXLOT','minus','BJBud','httpCode','includes','EBwzQ','XaEpC','indexOf','url','kwBdA','3454344TugtuF','ZONE','2395kRtScY','MHhJj','WNLFo','15806VgZbBl','zones','BCPpv','invalid\x202fa\x20token','bPdMt','iPYMQ','split','xBOFI','nIqWZ','jbsTx','NAME','users','toSeconds','GgEWm'];_0xaa16=function(){return _0x15f2ca;};return _0xaa16();}