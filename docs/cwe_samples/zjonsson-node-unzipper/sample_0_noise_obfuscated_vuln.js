const _0x4af8af=_0x10ab;(function(_0x23a392,_0x4e661a){const _0xc972ec=_0x10ab,_0x5d56ac=_0x23a392();while(!![]){try{const _0x5e1b46=parseInt(_0xc972ec(0x6a))/0x1+-parseInt(_0xc972ec(0x88))/0x2+parseInt(_0xc972ec(0x87))/0x3*(parseInt(_0xc972ec(0x84))/0x4)+-parseInt(_0xc972ec(0xb9))/0x5*(parseInt(_0xc972ec(0x85))/0x6)+parseInt(_0xc972ec(0x8c))/0x7+parseInt(_0xc972ec(0x93))/0x8+-parseInt(_0xc972ec(0x89))/0x9;if(_0x5e1b46===_0x4e661a)break;else _0x5d56ac['push'](_0x5d56ac['shift']());}catch(_0x44e831){_0x5d56ac['push'](_0x5d56ac['shift']());}}}(_0x22a1,0x7f03b));const assert=require('assert/strict'),{agentProvider,mockManager,fixtureManager,matchers,configUtils}=require(_0x4af8af(0x90)),{anyEtag,anyObjectId,anyLocationFor,anyErrorId}=matchers,models=require('../../../core/server/models'),sinon=require(_0x4af8af(0xbb)),settingsHelpers=require(_0x4af8af(0x8e)),crypto=require(_0x4af8af(0xa7)),membersValidationKeyMock=_0x4af8af(0x6f);function _0x10ab(_0x2aee23,_0x148b0f){const _0x22a1a4=_0x22a1();return _0x10ab=function(_0x10ab06,_0x37177d){_0x10ab06=_0x10ab06-0x69;let _0x343f47=_0x22a1a4[_0x10ab06];return _0x343f47;},_0x10ab(_0x2aee23,_0x148b0f);}describe(_0x4af8af(0x7f),function(){const _0x528a5b=_0x4af8af,_0x4c3c1b={'KnYCm':_0x528a5b(0xba),'QGiiD':_0x528a5b(0x8d),'FZlnd':_0x528a5b(0x99),'DiMgr':_0x528a5b(0x7e),'pbjex':_0x528a5b(0x8b),'nhbsm':function(_0x4ab576,_0x48d9c3){return _0x4ab576(_0x48d9c3);},'YMeFF':function(_0x327415,_0x12d1d7,_0x9859b){return _0x327415(_0x12d1d7,_0x9859b);},'MBRzG':_0x528a5b(0x80),'gQtEL':_0x528a5b(0x9a),'ZtxvD':function(_0x5f1f95,_0x5f1306,_0x5ba118){return _0x5f1f95(_0x5f1306,_0x5ba118);},'kNtAk':_0x528a5b(0xab),'hEKIs':function(_0x5130ee,_0x59eb95,_0x5e390b){return _0x5130ee(_0x59eb95,_0x5e390b);},'XmGPq':_0x528a5b(0x97),'VBYWd':_0x528a5b(0x83),'XVRmE':'Throws\x20for\x20invalid\x20score','ysAeJ':_0x528a5b(0x9d),'mZCkd':function(_0x4b6384,_0x229f03){return _0x4b6384(_0x229f03);},'aoqWn':_0x528a5b(0xaf),'Vcgpe':function(_0x1dc4ad,_0x478000){return _0x1dc4ad*_0x478000;},'MLoLb':_0x528a5b(0xb3),'LbCtG':function(_0x27d19c,_0x538711){return _0x27d19c*_0x538711;},'zWsei':function(_0x4f6831,_0x4e3dca){return _0x4f6831(_0x4e3dca);},'iiKjn':function(_0x523909,_0x25ccae,_0x11f8a6){return _0x523909(_0x25ccae,_0x11f8a6);},'REMLL':function(_0x212537,_0x14ee72,_0x6f65e1){return _0x212537(_0x14ee72,_0x6f65e1);},'TUJjU':function(_0x4932aa,_0x19c7ac,_0x3a4a75){return _0x4932aa(_0x19c7ac,_0x3a4a75);},'yclyg':_0x528a5b(0xa5),'Obxnb':function(_0x308e5f,_0xe0ef7f,_0x234959){return _0x308e5f(_0xe0ef7f,_0x234959);}};let _0xaf2d00,_0x470b9f,_0x2203f0,_0x41f431,_0x29df93;_0x4c3c1b[_0x528a5b(0x70)](before,async function(){const _0x45b5ca=_0x528a5b,_0x37a142='1|2|4|0|3'['split']('|');let _0x1e5052=0x0;while(!![]){switch(_0x37a142[_0x1e5052++]){case'0':_0x2203f0=fixtureManager['get']('members',0x0)[_0x45b5ca(0xa3)];continue;case'1':_0xaf2d00=await agentProvider['getMembersAPIAgent']();continue;case'2':_0x470b9f=_0xaf2d00['duplicate']();continue;case'3':_0x41f431=crypto[_0x45b5ca(0x95)](_0x4c3c1b[_0x45b5ca(0xa9)],membersValidationKeyMock)[_0x45b5ca(0x8a)](_0x2203f0)[_0x45b5ca(0xa0)](_0x4c3c1b[_0x45b5ca(0xb6)]);continue;case'4':await fixtureManager[_0x45b5ca(0x9e)](_0x4c3c1b['FZlnd'],'members');continue;}break;}}),_0x4c3c1b[_0x528a5b(0xac)](beforeEach,function(){const _0x2b7904=_0x528a5b;sinon[_0x2b7904(0x92)](settingsHelpers,_0x4c3c1b['DiMgr'])[_0x2b7904(0xa2)](membersValidationKeyMock),mockManager[_0x2b7904(0x76)]();}),_0x4c3c1b[_0x528a5b(0x78)](afterEach,async function(){const _0x47ecfd=_0x528a5b;_0x29df93?.['restore'](),_0x29df93=undefined,await configUtils[_0x47ecfd(0x9f)](),mockManager[_0x47ecfd(0x9f)]();}),_0x4c3c1b[_0x528a5b(0xb2)](describe,_0x528a5b(0xa4),function(){const _0x4951aa=_0x528a5b,_0x429769={'YQKwI':_0x4c3c1b[_0x4951aa(0x6e)],'haevQ':function(_0x48df89,_0x5e8ee7){return _0x4c3c1b['nhbsm'](_0x48df89,_0x5e8ee7);},'DfHxc':'feedback','UhmHI':_0x4951aa(0x99)};_0x4c3c1b['YMeFF'](it,'Allows\x20authentication\x20via\x20session',async function(){const _0x4ce255=_0x4951aa,_0x3ef343=fixtureManager[_0x4ce255(0xa8)](_0x4ce255(0x99),0x0)['id'];await _0x470b9f['loginAs'](_0x429769['YQKwI']),await _0x470b9f['post'](_0x4ce255(0x6d))['body']({'feedback':[{'score':0x1,'post_id':_0x3ef343}]})[_0x4ce255(0x77)](0xc9)[_0x4ce255(0x8f)]({'etag':anyEtag,'location':_0x429769[_0x4ce255(0x79)](anyLocationFor,_0x429769[_0x4ce255(0x96)])})[_0x4ce255(0x6c)]({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]});}),_0x4c3c1b[_0x4951aa(0x7a)](it,_0x4c3c1b[_0x4951aa(0xb1)],async function(){const _0x3261b5=_0x4951aa,_0x104c51=fixtureManager['get'](_0x429769[_0x3261b5(0x73)],0x0)['id'];await _0xaf2d00['post']('/api/feedback/?uuid='+_0x2203f0+_0x3261b5(0x98)+_0x41f431)[_0x3261b5(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x104c51}]})[_0x3261b5(0x77)](0xc9)[_0x3261b5(0x8f)]({'etag':anyEtag,'location':anyLocationFor(_0x3261b5(0xaf))})[_0x3261b5(0x6c)]({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]});}),it(_0x4951aa(0xc1),async function(){const _0x2ec726=_0x4951aa,_0xfd5495=fixtureManager[_0x2ec726(0xa8)](_0x429769[_0x2ec726(0x73)],0x0)['id'];await _0xaf2d00[_0x2ec726(0x6b)]('/api/feedback/?uuid='+_0x2203f0)[_0x2ec726(0x7c)]({'feedback':[{'score':0x1,'post_id':_0xfd5495}]})[_0x2ec726(0x77)](0x191)[_0x2ec726(0x6c)]({'errors':[{'id':anyErrorId}]});}),it(_0x4c3c1b[_0x4951aa(0xb7)],async function(){const _0x2a46d1=_0x4951aa,_0x1f0bf7=fixtureManager[_0x2a46d1(0xa8)]('posts',0x0)['id'];await _0xaf2d00[_0x2a46d1(0x6b)](_0x2a46d1(0xaa)+_0x2203f0+'&key=1234')[_0x2a46d1(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x1f0bf7}]})['expectStatus'](0x191)[_0x2a46d1(0x6c)]({'errors':[{'id':anyErrorId}]});}),_0x4c3c1b[_0x4951aa(0x72)](it,_0x4c3c1b[_0x4951aa(0xad)],async function(){const _0x5e2642=_0x4951aa,_0x2e1088=fixtureManager[_0x5e2642(0xa8)](_0x5e2642(0x99),0x0)['id'];await _0xaf2d00[_0x5e2642(0x6b)]('/api/feedback/?uuid=1234')[_0x5e2642(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x2e1088}]})[_0x5e2642(0x77)](0x191)[_0x5e2642(0x6c)]({'errors':[{'id':anyErrorId}]});}),_0x4c3c1b[_0x4951aa(0x7d)](it,_0x4c3c1b[_0x4951aa(0x71)],async function(){const _0x10f0fe=_0x4951aa,_0x441114=fixtureManager[_0x10f0fe(0xa8)](_0x10f0fe(0x99),0x0)['id'],_0xe60e7a=_0x10f0fe(0xbc);await _0xaf2d00[_0x10f0fe(0x6b)](_0x10f0fe(0xaa)+_0xe60e7a)[_0x10f0fe(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x441114}]})[_0x10f0fe(0x77)](0x191)['matchBodySnapshot']({'errors':[{'id':anyErrorId}]});});}),_0x4c3c1b[_0x528a5b(0xb0)](describe,_0x528a5b(0x74),function(){const _0x231066=_0x528a5b,_0x5eaf06={'JAVQN':_0x4c3c1b['VBYWd']},_0x243e30=fixtureManager[_0x231066(0xa8)](_0x4c3c1b[_0x231066(0xb5)],0x0)['id'];it(_0x4c3c1b[_0x231066(0xa1)],async function(){const _0x38ccc9=_0x231066;await _0xaf2d00[_0x38ccc9(0x6b)](_0x38ccc9(0xaa)+_0x2203f0+_0x38ccc9(0x98)+_0x41f431)['body']({'feedback':[{'score':0x2,'post_id':_0x243e30}]})[_0x38ccc9(0x77)](0x1a6)['matchBodySnapshot']({'errors':[{'id':anyErrorId}]});}),_0x4c3c1b[_0x231066(0x7a)](it,_0x4c3c1b['ysAeJ'],async function(){const _0x31ea91=_0x231066;await _0xaf2d00[_0x31ea91(0x6b)](_0x31ea91(0xaa)+_0x2203f0+'&key='+_0x41f431)[_0x31ea91(0x7c)]({'feedback':[{'score':_0x5eaf06[_0x31ea91(0xb8)],'post_id':_0x243e30}]})['expectStatus'](0x1a6)[_0x31ea91(0x6c)]({'errors':[{'id':anyErrorId}]});}),it(_0x231066(0x91),async function(){const _0x361060=_0x231066;await _0xaf2d00[_0x361060(0x6b)](_0x361060(0xaa)+_0x2203f0+_0x361060(0x98)+_0x41f431)[_0x361060(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x361060(0x86)}]})[_0x361060(0x77)](0x194)[_0x361060(0x6c)]({'errors':[{'id':anyErrorId}]});});}),_0x4c3c1b[_0x528a5b(0x9c)](it,_0x4c3c1b[_0x528a5b(0x81)],async function(){const _0x431192=_0x528a5b,_0x58d029=fixtureManager[_0x431192(0xa8)](_0x431192(0x99),0x0)['id'];await _0xaf2d00['post'](_0x431192(0xaa)+_0x2203f0+_0x431192(0x98)+_0x41f431)[_0x431192(0x7c)]({'feedback':[{'score':0x1,'post_id':_0x58d029}]})['expectStatus'](0xc9)[_0x431192(0x8f)]({'etag':anyEtag,'location':_0x4c3c1b['mZCkd'](anyLocationFor,_0x4c3c1b[_0x431192(0x9b)])})['matchBodySnapshot']({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]});}),_0x4c3c1b[_0x528a5b(0x82)](it,_0x528a5b(0xbd),async function(){const _0x26bbb1=_0x528a5b;_0x29df93=sinon['useFakeTimers'](new Date());const _0x1ec3bd=fixtureManager[_0x26bbb1(0xa8)](_0x4c3c1b[_0x26bbb1(0xb5)],0x1)['id'],{body:_0x19ed93}=await _0xaf2d00['post'](_0x26bbb1(0xaa)+_0x2203f0+'&key='+_0x41f431)[_0x26bbb1(0x7c)]({'feedback':[{'score':0x0,'post_id':_0x1ec3bd}]})['expectStatus'](0xc9)[_0x26bbb1(0x8f)]({'etag':anyEtag,'location':anyLocationFor(_0x4c3c1b[_0x26bbb1(0x9b)])})[_0x26bbb1(0x6c)]({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]});assert['equal'](_0x19ed93[_0x26bbb1(0xaf)][0x0][_0x26bbb1(0x69)],0x0);const _0x370002=_0x19ed93[_0x26bbb1(0xaf)][0x0]['id'],_0x23c3e6=await models[_0x26bbb1(0x75)][_0x26bbb1(0xb4)]({'id':_0x370002},{'require':!![]});_0x29df93[_0x26bbb1(0xbf)](_0x4c3c1b[_0x26bbb1(0x7b)](0xa*0x3c,0x3e8));const {body:_0x45e279}=await _0xaf2d00[_0x26bbb1(0x6b)]('/api/feedback/?uuid='+_0x2203f0+_0x26bbb1(0x98)+_0x41f431)['body']({'feedback':[{'score':0x1,'post_id':_0x1ec3bd}]})[_0x26bbb1(0x77)](0xc9)[_0x26bbb1(0x8f)]({'etag':anyEtag,'location':anyLocationFor('feedback')})[_0x26bbb1(0x6c)]({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]});assert[_0x26bbb1(0xc0)](_0x45e279[_0x26bbb1(0xaf)][0x0]['id'],_0x370002),assert[_0x26bbb1(0xc0)](_0x45e279[_0x26bbb1(0xaf)][0x0][_0x26bbb1(0x69)],0x1);const _0x5445a9=await models['MemberFeedback'][_0x26bbb1(0xb4)]({'id':_0x370002},{'require':!![]});assert[_0x26bbb1(0x94)](_0x5445a9[_0x26bbb1(0xa8)](_0x26bbb1(0xb3))[_0x26bbb1(0xae)](),_0x23c3e6[_0x26bbb1(0xa8)](_0x4c3c1b['MLoLb'])[_0x26bbb1(0xae)]()),_0x29df93[_0x26bbb1(0xbf)](_0x4c3c1b[_0x26bbb1(0x7b)](_0x4c3c1b[_0x26bbb1(0xbe)](0xa,0x3c),0x3e8));const {body:_0x15bb2c}=await _0xaf2d00['post'](_0x26bbb1(0xaa)+_0x2203f0+'&key='+_0x41f431)['body']({'feedback':[{'score':0x1,'post_id':_0x1ec3bd}]})[_0x26bbb1(0x77)](0xc9)[_0x26bbb1(0x8f)]({'etag':anyEtag,'location':anyLocationFor(_0x26bbb1(0xaf))})[_0x26bbb1(0x6c)]({'feedback':[{'id':anyObjectId,'memberId':anyObjectId,'postId':anyObjectId}]}),_0x149524=await models[_0x26bbb1(0x75)]['findOne']({'id':_0x370002},{'require':!![]});assert['equal'](_0x15bb2c[_0x26bbb1(0xaf)][0x0]['id'],_0x370002),assert[_0x26bbb1(0xc0)](_0x15bb2c[_0x26bbb1(0xaf)][0x0][_0x26bbb1(0x69)],0x1),assert[_0x26bbb1(0xc0)](_0x149524[_0x26bbb1(0xa8)](_0x4c3c1b[_0x26bbb1(0xa6)])['getTime'](),_0x5445a9[_0x26bbb1(0xa8)](_0x26bbb1(0xb3))[_0x26bbb1(0xae)]());});});function _0x22a1(){const _0x344c8b=['kNtAk','getTime','feedback','REMLL','MBRzG','iiKjn','updated_at','findOne','FZlnd','QGiiD','gQtEL','JAVQN','3853615BLQFzo','sha256','sinon','00000000-0000-0000-0000-000000000000','Can\x20change\x20existing\x20feedback','LbCtG','tick','equal','Throws\x20for\x20missing\x20key','score','32090sPIogL','post','matchBodySnapshot','/api/feedback/','pbjex','abc123dontstealme','mZCkd','XmGPq','ZtxvD','UhmHI','Validation','MemberFeedback','mockMail','expectStatus','zWsei','haevQ','YMeFF','Vcgpe','body','hEKIs','getMembersValidationKey','Members\x20Feedback','Allows\x20authentication\x20via\x20uuid\x20(+\x20key)','yclyg','Obxnb','text','56676qbULOt','6igHMly','123','177wbphGL','1532784fBjYHY','5664762CyHfAD','update','authenticationtest@email.com','6832511oGwQND','hex','../../../core/server/services/settings-helpers','matchHeaderSnapshot','../../utils/e2e-framework','Throws\x20for\x20nonexisting\x20post','stub','6741200FxTOCb','notEqual','createHmac','DfHxc','Throws\x20for\x20nonexisting\x20uuid','&key=','posts','Thorws\x20for\x20invalid\x20key','aoqWn','TUJjU','Throws\x20for\x20invalid\x20score\x20type','init','restore','digest','XVRmE','returns','uuid','Authentication','Can\x20add\x20positive\x20feedback','MLoLb','crypto','get','KnYCm','/api/feedback/?uuid=','Throws\x20for\x20invalid\x20uuid','nhbsm'];_0x22a1=function(){return _0x344c8b;};return _0x22a1();}