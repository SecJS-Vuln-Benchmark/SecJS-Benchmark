function _0xbd1e(_0x1933e7,_0x31f35c){const _0x435d1f=_0x435d();return _0xbd1e=function(_0xbd1eeb,_0xece5f0){_0xbd1eeb=_0xbd1eeb-0x183;let _0x2ba6fc=_0x435d1f[_0xbd1eeb];return _0x2ba6fc;},_0xbd1e(_0x1933e7,_0x31f35c);}const _0x588faa=_0xbd1e;function _0x435d(){const _0x501608=['slice','../log','looking\x20for\x20a\x20rule\x20match','pNhGn','mfWEX','info','path','gRYnO','eKLWd','../config','Expected\x20array\x20of\x20filter\x20rules,\x20got\x20\x27','976AzRvCZ','OGJGO','gFpSm','regex','undefsafe','qvfqn','sryiP','../try-json-parse','warn','body','CkRMy','QXEth','exec','split','get','filter','sLZqj','map','CaWdu','toLowerCase','ezNCE','replace','method','VwAZd','WEzYU','nobHX','XrcfA','1931244jhwfSh','xuylw','uWWds','TBmii','249996OzkijL','some','adding\x20new\x20filter\x20rule','length','UatFg','any','\x27\x20instead.','XXvyF','queryParam','isArray','blocked','45626mzjYZT','name','path-to-regexp','2550680wUujIG','ZmYSM','sUpZQ','../auth-header','125478ZvrMLm','MdTXC','debug','minimatch','test','336620wSvKqI','146388KgfMkj','TyOWj','failed\x20to\x20test\x20regex\x20rule'];_0x435d=function(){return _0x501608;};return _0x435d();}(function(_0x3f3991,_0x308bda){const _0x4b85b2=_0xbd1e,_0xa67b1b=_0x3f3991();while(!![]){try{const _0x30187c=-parseInt(_0x4b85b2(0x1a3))/0x1+-parseInt(_0x4b85b2(0x1a2))/0x2+parseInt(_0x4b85b2(0x19d))/0x3+-parseInt(_0x4b85b2(0x18b))/0x4+-parseInt(_0x4b85b2(0x199))/0x5+parseInt(_0x4b85b2(0x187))/0x6+-parseInt(_0x4b85b2(0x196))/0x7*(-parseInt(_0x4b85b2(0x1b1))/0x8);if(_0x30187c===_0x308bda)break;else _0xa67b1b['push'](_0xa67b1b['shift']());}catch(_0x21a0c9){_0xa67b1b['push'](_0xa67b1b['shift']());}}}(_0x435d,0x424cb));const minimatch=require(_0x588faa(0x1a0)),pathRegexp=require(_0x588faa(0x198)),qs=require('qs'),undefsafe=require(_0x588faa(0x1b5)),replace=require('../replace-vars'),authHeader=require(_0x588faa(0x19c)),tryJSONParse=require(_0x588faa(0x1b8)),logger=require(_0x588faa(0x1a7));module['exports']=_0x2d8837=>{const _0x18c9fc=_0x588faa,_0x497d1b={'qvfqn':function(_0x36d917,_0x510d6e){return _0x36d917+_0x510d6e;},'OGJGO':function(_0x3ef828,_0x5a7c41){return _0x3ef828-_0x5a7c41;},'NMbon':function(_0x550856,_0x54ada5,_0x27f5bc,_0x2404fa){return _0x550856(_0x54ada5,_0x27f5bc,_0x2404fa);},'eKLWd':function(_0x22369c,_0x53d39a,_0x8babd7,_0x48604e){return _0x22369c(_0x53d39a,_0x8babd7,_0x48604e);},'pNhGn':function(_0x137ef7,_0x25138c){return _0x137ef7===_0x25138c;},'gRYnO':function(_0xe8fcb0,_0x71430a){return _0xe8fcb0!==_0x71430a;},'UatFg':function(_0xf663b8,_0x226614){return _0xf663b8!==_0x226614;},'daxuf':_0x18c9fc(0x190),'uWWds':_0x18c9fc(0x1bb),'xuylw':'STkTQ','YEJZs':function(_0x252f5f,_0x1e9761){return _0x252f5f(_0x1e9761);},'CaWdu':function(_0x11b769,_0x1879f1){return _0x11b769!==_0x1879f1;},'ZmYSM':_0x18c9fc(0x192),'XrcfA':'rule\x20matched','ezNCE':function(_0x78dcee,_0x66ad9e){return _0x78dcee+_0x66ad9e;},'nobHX':function(_0x2b243e,_0x27a9cc,_0x183539){return _0x2b243e(_0x27a9cc,_0x183539);},'UpIzL':_0x18c9fc(0x1a5),'HRpvP':_0x18c9fc(0x1bf),'znUdX':_0x18c9fc(0x18d),'sryiP':function(_0x2a92d8,_0x147833,_0x4ca122){return _0x2a92d8(_0x147833,_0x4ca122);},'fuYUp':_0x18c9fc(0x19e)};let _0x43644f=[];const _0x5147db=require(_0x18c9fc(0x1af));if(Array[_0x18c9fc(0x194)](_0x2d8837)){if(_0x497d1b['fuYUp']===_0x18c9fc(0x18a))return![];else _0x43644f=_0x2d8837;}else{if(_0x2d8837)try{_0x43644f=require(_0x2d8837);}catch(_0x47c0f2){logger[_0x18c9fc(0x1b9)]({'ruleSource':_0x2d8837,'error':_0x47c0f2},'Unable\x20to\x20parse\x20rule\x20source,\x20ignoring');}}if(!Array['isArray'](_0x43644f))throw new Error(_0x18c9fc(0x1b0)+typeof _0x43644f+_0x18c9fc(0x191));logger[_0x18c9fc(0x1ab)]({'rulesCount':_0x43644f[_0x18c9fc(0x18e)]},'loading\x20new\x20rules');const _0x1dc6da=_0x43644f[_0x18c9fc(0x1c2)](_0x8edf70=>{const _0x24b5b4=_0x18c9fc,_0x165030={'sLZqj':function(_0x5df86a,_0x5a95b2,_0x3f047e){const _0x2c337d=_0xbd1e;return _0x497d1b[_0x2c337d(0x185)](_0x5df86a,_0x5a95b2,_0x3f047e);},'sUpZQ':_0x497d1b['UpIzL']},_0x2b5917=[];let {method:_0xe0fa2b,origin:_0x9803cb,path:_0x3ee389,valid:_0x3f4d6d,stream:_0x1408f7}=_0x8edf70;_0xe0fa2b=(_0xe0fa2b||_0x497d1b['HRpvP'])[_0x24b5b4(0x1c4)](),_0x3f4d6d=_0x3f4d6d||[];const _0x5c7477=_0x3f4d6d[_0x24b5b4(0x1c0)](_0x2b96c7=>!!_0x2b96c7[_0x24b5b4(0x1ac)]&&!_0x2b96c7['regex']),_0x4bc59d=_0x3f4d6d['filter'](_0x1e7339=>!!_0x1e7339['path']&&!!_0x1e7339[_0x24b5b4(0x1b4)]),_0x37c167=_0x3f4d6d[_0x24b5b4(0x1c0)](_0x1cebc7=>!!_0x1cebc7[_0x24b5b4(0x193)]),_0x148dcd={};_0x3ee389=(_0x3ee389||'')[_0x24b5b4(0x1c6)](/(\${.*?})/g,(_0x41f195,_0x18b557)=>{const _0x3db906=_0x24b5b4,_0xd4f1e3=_0x18b557['slice'](0x2,-0x1);return _0x148dcd[_0xd4f1e3]=_0x5147db[_0xd4f1e3]||'',_0x497d1b[_0x3db906(0x1b6)](':',_0xd4f1e3);}),_0x9803cb=replace(_0x9803cb,_0x5147db);_0x497d1b[_0x24b5b4(0x18f)](_0x3ee389[0x0],'/')&&(_0x3ee389=_0x497d1b['qvfqn']('/',_0x3ee389));logger['info']({'method':_0xe0fa2b,'path':_0x3ee389},_0x497d1b['znUdX']);const _0x587ab2=_0x497d1b['sryiP'](pathRegexp,_0x3ee389,_0x2b5917);return _0x1dfa2a=>{const _0x3a6d76=_0x24b5b4,_0x1642c7={'JKZYG':function(_0x440290,_0x5b53e2){const _0x441939=_0xbd1e;return _0x497d1b[_0x441939(0x1b2)](_0x440290,_0x5b53e2);},'VwAZd':function(_0x123e7d,_0x28d98f,_0x5154fd,_0xbb2ba0){return _0x497d1b['NMbon'](_0x123e7d,_0x28d98f,_0x5154fd,_0xbb2ba0);},'gFpSm':'Unable\x20to\x20parse\x20rule\x20source,\x20ignoring','QXEth':function(_0x21711d,_0x38ee09,_0x1ec1a2,_0x1ef4c7){const _0x27ec13=_0xbd1e;return _0x497d1b[_0x27ec13(0x1ae)](_0x21711d,_0x38ee09,_0x1ec1a2,_0x1ef4c7);}};if(_0x497d1b[_0x3a6d76(0x1a9)](_0x3a6d76(0x1aa),'mfWEX')){if(_0x497d1b[_0x3a6d76(0x1ad)](_0x1dfa2a[_0x3a6d76(0x1c7)][_0x3a6d76(0x1c4)](),_0xe0fa2b)&&_0x497d1b['UatFg'](_0xe0fa2b,_0x497d1b['daxuf']))return _0x497d1b[_0x3a6d76(0x189)]!==_0x3a6d76(0x184)?![]:![];const _0x3aef1a=_0x1dfa2a['url'][_0x3a6d76(0x1be)]('#')[0x0],_0xa43598=_0x3aef1a[_0x3a6d76(0x1be)]('?');let [_0x2a800d,_0x5af16f]=[_0xa43598[0x0],_0xa43598[_0x3a6d76(0x1a6)](0x1)['join']('?')];const _0x23b0e2=_0x587ab2[_0x3a6d76(0x1bd)](_0x2a800d);if(!_0x23b0e2)return![];for(let _0x3f9188=0x1;_0x3f9188<_0x23b0e2[_0x3a6d76(0x18e)];_0x3f9188++){const _0x2262c0=_0x148dcd[_0x2b5917[_0x3f9188-0x1][_0x3a6d76(0x197)]];if(_0x2262c0){if(_0x497d1b[_0x3a6d76(0x188)]==='STkTQ')_0x2a800d=_0x2a800d[_0x3a6d76(0x1c6)](_0x23b0e2[_0x3f9188],_0x2262c0);else{const _0x2558a0=_0x230651[_0xa69f4a[_0x1642c7['JKZYG'](_0x2a0f60,0x1)][_0x3a6d76(0x197)]];_0x2558a0&&(_0x5a3ba8=_0x196914[_0x3a6d76(0x1c6)](_0x135a1a[_0x2a2b5f],_0x2558a0));}}}if(_0x5c7477[_0x3a6d76(0x18e)]||_0x4bc59d[_0x3a6d76(0x18e)]||_0x37c167['length']){let _0x59452d,_0x268d8a;_0x5c7477[_0x3a6d76(0x18e)]&&(_0x268d8a=_0x497d1b['YEJZs'](tryJSONParse,_0x1dfa2a['body']),_0x59452d=_0x5c7477['some'](({path:_0x5cba6c,value:_0x4cb8c8})=>{const _0xafcf0c=_0x3a6d76;return _0x1642c7[_0xafcf0c(0x183)](undefsafe,_0x268d8a,_0x5cba6c,_0x4cb8c8);}));!_0x59452d&&_0x4bc59d[_0x3a6d76(0x18e)]&&(_0x268d8a=_0x268d8a||tryJSONParse(_0x1dfa2a[_0x3a6d76(0x1ba)]),_0x59452d=_0x4bc59d[_0x3a6d76(0x18c)](({path:_0xb2f932,regex:_0x4cdd45})=>{const _0x1d782f=_0x3a6d76;try{const _0xfd90d6=new RegExp(_0x4cdd45);return _0xfd90d6[_0x1d782f(0x1a1)](_0x165030[_0x1d782f(0x1c1)](undefsafe,_0x268d8a,_0xb2f932));}catch(_0x3dcd16){return logger['error']({'error':_0x3dcd16,'path':_0xb2f932,'regex':_0x4cdd45},_0x165030[_0x1d782f(0x19b)]),![];}}));if(!_0x59452d&&_0x37c167[_0x3a6d76(0x18e)]){if(_0x497d1b[_0x3a6d76(0x1c3)](_0x497d1b[_0x3a6d76(0x19a)],_0x3a6d76(0x1a4))){const _0x1f1783=qs['parse'](_0x5af16f);_0x59452d=_0x37c167[_0x3a6d76(0x18c)](({queryParam:_0x5752cd,values:_0x3b3708})=>{return _0x3b3708['some'](_0x2a005f=>minimatch(_0x1f1783[_0x5752cd]||'',_0x2a005f));});}else _0x59c5b[_0x3a6d76(0x1b9)]({'ruleSource':_0x323a53,'error':_0x42782c},_0x1642c7[_0x3a6d76(0x1b3)]);}if(!_0x59452d)return![];}return logger['debug']({'path':_0x3ee389,'origin':_0x9803cb,'url':_0x2a800d,'querystring':_0x5af16f},_0x497d1b[_0x3a6d76(0x186)]),_0x5af16f=_0x5af16f?'?'+_0x5af16f:'',{'url':_0x497d1b[_0x3a6d76(0x1c5)](_0x9803cb+_0x2a800d,_0x5af16f),'auth':_0x8edf70['auth']&&authHeader(_0x8edf70['auth']),'stream':_0x1408f7};}else return _0x1642c7[_0x3a6d76(0x1bc)](_0x203ed7,_0xaafde6,_0xd58036,_0x5d0de6);};});return(_0x289bab,_0x484ca8)=>{const _0x4984cc=_0x18c9fc;let _0xabdb83=![];logger[_0x4984cc(0x19f)]({'rulesCount':_0x1dc6da['length']},_0x4984cc(0x1a8));for(const _0x11000d of _0x1dc6da){_0xabdb83=_0x11000d(_0x289bab);if(_0xabdb83)break;}if(!_0xabdb83)return _0x484ca8(Error(_0x4984cc(0x195)));return _0x497d1b[_0x4984cc(0x1b7)](_0x484ca8,null,_0xabdb83);};};