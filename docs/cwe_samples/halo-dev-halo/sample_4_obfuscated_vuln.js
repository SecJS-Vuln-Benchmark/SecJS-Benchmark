const _0x57873b=_0x6624;(function(_0x6549ac,_0x3ecb77){const _0x13e8a9=_0x6624,_0x5b1dcb=_0x6549ac();while(!![]){try{const _0x238d30=-parseInt(_0x13e8a9(0x13e))/0x1+parseInt(_0x13e8a9(0x121))/0x2+parseInt(_0x13e8a9(0x161))/0x3+parseInt(_0x13e8a9(0x11a))/0x4*(parseInt(_0x13e8a9(0x15c))/0x5)+parseInt(_0x13e8a9(0x15e))/0x6*(-parseInt(_0x13e8a9(0x14c))/0x7)+-parseInt(_0x13e8a9(0x13d))/0x8*(-parseInt(_0x13e8a9(0x141))/0x9)+-parseInt(_0x13e8a9(0xfe))/0xa*(parseInt(_0x13e8a9(0x158))/0xb);if(_0x238d30===_0x3ecb77)break;else _0x5b1dcb['push'](_0x5b1dcb['shift']());}catch(_0x5ad1){_0x5b1dcb['push'](_0x5b1dcb['shift']());}}}(_0x51ec,0xd2907));import{dom,qs$}from'./dom.js';import{i18n$}from'./i18n.js';const reComment=/^\s*#\s*/;function directiveFromLine(_0x499001){const _0xc458ec=_0x6624,_0x15aaf2={'iHGDj':function(_0x3a6248,_0x266891){return _0x3a6248===_0x266891;}},_0x2e6824=reComment[_0xc458ec(0x133)](_0x499001);return _0x15aaf2[_0xc458ec(0x118)](_0x2e6824,null)?_0x499001[_0xc458ec(0x105)]():_0x499001[_0xc458ec(0x148)](_0x2e6824['index']+_0x2e6824[0x0][_0xc458ec(0x162)])['trim']();}CodeMirror[_0x57873b(0x11b)]('ubo-whitelist-directives',function(){const _0x389851=_0x57873b,_0x52a5ca={'gedzV':function(_0x1af3bd){return _0x1af3bd();},'aihfl':_0x389851(0x125),'nxfNN':_0x389851(0x134),'obxlu':function(_0x57cfad,_0x2eee44){return _0x57cfad===_0x2eee44;},'hEhEp':_0x389851(0xfc),'xQIRR':'error','vujPx':function(_0x3a2185,_0x2fecfb){return _0x3a2185===_0x2fecfb;},'NKvxf':'DOYTA','ALJOM':function(_0x3f4870,_0x3f3d5c){return _0x3f4870===_0x3f3d5c;},'QOidm':'HSKNX'},_0x8ad3f1=/^\/.+\/$/;return{'token':function _0x58ef65(_0x30504e){const _0x5797bc=_0x389851,_0x4f3b7a={'srjAt':_0x52a5ca[_0x5797bc(0x130)]},_0x211baa=_0x30504e[_0x5797bc(0x13f)][_0x5797bc(0x105)]();_0x30504e['skipToEnd']();if(reBadHostname===undefined)return _0x5797bc(0x154)===_0x52a5ca[_0x5797bc(0x10a)]?null:null;if(reComment[_0x5797bc(0x124)](_0x211baa))return _0x52a5ca[_0x5797bc(0x14f)](_0x52a5ca[_0x5797bc(0x10e)],_0x52a5ca[_0x5797bc(0x10e)])?_0x5797bc(0x129):_0x5797bc(0x12b);if(_0x52a5ca[_0x5797bc(0x14f)](_0x211baa[_0x5797bc(0x153)]('/'),-0x1)){if(reBadHostname['test'](_0x211baa))return _0x5797bc(0x12b);if(whitelistDefaultSet[_0x5797bc(0x12a)](_0x211baa[_0x5797bc(0x105)]()))return _0x5797bc(0x125);return null;}if(_0x8ad3f1[_0x5797bc(0x124)](_0x211baa)){try{new RegExp(_0x211baa[_0x5797bc(0x148)](0x1,-0x1));}catch{return _0x52a5ca[_0x5797bc(0x114)];}return null;}if(reHostnameExtractor[_0x5797bc(0x124)](_0x211baa)===![])return _0x52a5ca[_0x5797bc(0x128)](_0x52a5ca[_0x5797bc(0x100)],'DOYTA')?_0x5797bc(0x12b):_0x4f3b7a[_0x5797bc(0x132)];if(whitelistDefaultSet[_0x5797bc(0x12a)](_0x211baa[_0x5797bc(0x105)]())){if(_0x52a5ca[_0x5797bc(0x14b)](_0x52a5ca[_0x5797bc(0x110)],_0x52a5ca[_0x5797bc(0x110)]))return _0x5797bc(0x125);else _0x52a5ca[_0x5797bc(0x10d)](_0x24bb3c);}return null;}};});let reBadHostname,reHostnameExtractor,whitelistDefaultSet=new Set();const messaging=vAPI[_0x57873b(0x160)],noopFunc=function(){};let cachedWhitelist='';const cmEditor=new CodeMirror(qs$('#whitelist'),{'autofocus':!![],'lineNumbers':!![],'lineWrapping':!![],'styleActiveLine':!![]});uBlockDashboard[_0x57873b(0x137)](cmEditor);function _0x6624(_0x3c62b7,_0x219590){const _0x51ec7a=_0x51ec();return _0x6624=function(_0x408919,_0x3b1fed){_0x408919=_0x408919-0xfc;let _0x27f288=_0x51ec7a[_0x408919];return _0x27f288;},_0x6624(_0x3c62b7,_0x219590);}function getEditorText(){const _0x730b88=_0x57873b,_0x1d6ee5={'zyAVo':function(_0x46bb42,_0x578b43){return _0x46bb42===_0x578b43;}},_0xa53de6=cmEditor[_0x730b88(0x13a)]()['trimEnd']();return _0x1d6ee5[_0x730b88(0x11f)](_0xa53de6,'')?_0xa53de6:_0xa53de6+'\x0a';}function setEditorText(_0x814dc3){const _0x1c8c66=_0x57873b;cmEditor[_0x1c8c66(0x11c)](_0x814dc3['trimEnd']()+'\x0a');}function _0x51ec(){const _0x10f591=['20vubgOa','cloud','NKvxf','WOplQ','data:text/plain;charset=utf-8,','TFKfk','size','trim','#importWhitelistFromFile','iJgul','send','join','nxfNN','text','save','gedzV','hEhEp','eFdJd','QOidm','click','mergeNewLines','https://github.com/gorhill/uBlock/wiki/Dashboard:-Trusted-sites','xQIRR','whitelistDefault','onPull','#exportWhitelistToFile','iHGDj','EAHfH','448toFfSF','defineMode','setValue','sort','whitelistExportFilename','zyAVo','reBadHostname','2964432aOotrp','.cm-error','result','test','keyword','commands','lfNBE','vujPx','comment','has','error','#whitelistApply','clearHistory','QrdfL','zSmJC','aihfl','replace','srjAt','exec','jxaeR','hasUnsavedData','type','patchCodeMirrorEditor','getWhitelist','#whitelistRevert','getValue','change','push','8EBceDE','695124FCeivG','string','whitelist','2384919fQDorL','load','#importFilePicker','TWYNr','hMvnG','changes','from','slice','dVJNe','zUVeX','ALJOM','954632XxsdkN','VOpFj','files','obxlu','{{datetime}}','dateNowToSensibleString','value','indexOf','ReuMO','dashboard','readAsText','map','771474XRThhV','wikilink','DGKZf','reHostnameExtractor','7035kItXCk','TAsTP','24tRIOUK','disabled','messaging','1015728pdMFfY','length','yeIwE','#whitelist'];_0x51ec=function(){return _0x10f591;};return _0x51ec();}function whitelistChanged(){const _0x437d65=_0x57873b,_0x49f57e={'WOplQ':_0x437d65(0x122),'OBkbO':function(_0x156e16,_0x39ef65){return _0x156e16(_0x39ef65);},'TWYNr':function(_0x5a4e9e,_0x171cfd){return _0x5a4e9e||_0x171cfd;},'VOpFj':_0x437d65(0x139),'DGKZf':function(_0x8dd682,_0x5d13ae){return _0x8dd682&&_0x5d13ae;}},_0x231eee=qs$(_0x437d65(0xfd)),_0x2504a2=qs$(_0x231eee,_0x49f57e[_0x437d65(0x101)])!==null,_0x1677ba=getEditorText()[_0x437d65(0x105)](),_0x4759e3=_0x1677ba!==cachedWhitelist;_0x49f57e['OBkbO'](qs$,_0x437d65(0x12c))[_0x437d65(0x15f)]=_0x49f57e[_0x437d65(0x144)](!_0x4759e3,_0x2504a2),qs$(_0x49f57e[_0x437d65(0x14d)])[_0x437d65(0x15f)]=!_0x4759e3,CodeMirror[_0x437d65(0x126)][_0x437d65(0x10c)]=_0x49f57e[_0x437d65(0x15a)](_0x4759e3,!_0x2504a2)?applyChanges:noopFunc;}cmEditor['on'](_0x57873b(0x146),whitelistChanged);async function renderWhitelist(){const _0x1492ce=_0x57873b,_0x1eccba={'zUVeX':function(_0x10b1fb,_0x2b8b18){return _0x10b1fb(_0x2b8b18);},'weiJE':_0x1492ce(0x138),'EwNJH':function(_0x7f4f60,_0x16c735){return _0x7f4f60===_0x16c735;},'lfNBE':function(_0x408efa,_0x19d2a9){return _0x408efa===_0x19d2a9;}},_0x4814e3=await messaging[_0x1492ce(0x108)](_0x1492ce(0x155),{'what':_0x1eccba['weiJE']}),_0x3dce16=_0x1eccba['EwNJH'](reBadHostname,undefined);_0x3dce16&&(reBadHostname=new RegExp(_0x4814e3[_0x1492ce(0x120)]),reHostnameExtractor=new RegExp(_0x4814e3[_0x1492ce(0x15b)]),whitelistDefaultSet=new Set(_0x4814e3[_0x1492ce(0x115)]));const _0x405749=new Set(whitelistDefaultSet);for(const _0x5677b6 of _0x4814e3['whitelist']){const _0x3c983c=directiveFromLine(_0x5677b6);if(_0x1eccba['lfNBE'](whitelistDefaultSet[_0x1492ce(0x12a)](_0x3c983c),![]))continue;_0x405749['delete'](_0x3c983c);if(_0x1eccba[_0x1492ce(0x127)](_0x405749['size'],0x0))break;}_0x405749[_0x1492ce(0x104)]!==0x0&&_0x4814e3[_0x1492ce(0x140)][_0x1492ce(0x13c)](...Array[_0x1492ce(0x147)](_0x405749)[_0x1492ce(0x157)](_0x1c6909=>'#\x20'+_0x1c6909));_0x4814e3['whitelist'][_0x1492ce(0x11d)]((_0x3ddada,_0x2bf4aa)=>{const _0x1cafb2=_0x1492ce,_0x3a98d3=_0x1eccba[_0x1cafb2(0x14a)](directiveFromLine,_0x3ddada),_0x370b66=directiveFromLine(_0x2bf4aa),_0x4118cd=whitelistDefaultSet[_0x1cafb2(0x12a)](_0x3a98d3);if(_0x4118cd!==whitelistDefaultSet[_0x1cafb2(0x12a)](_0x370b66))return _0x4118cd?-0x1:0x1;return _0x3a98d3['localeCompare'](_0x370b66);});const _0x468b68=_0x4814e3['whitelist'][_0x1492ce(0x109)]('\x0a')[_0x1492ce(0x105)]();cachedWhitelist=_0x468b68,setEditorText(_0x468b68),_0x3dce16&&cmEditor[_0x1492ce(0x12d)]();}function handleImportFilePicker(){const _0x57d906=_0x57873b,_0x1eb83b={'tCIAI':_0x57d906(0x125),'QrdfL':_0x57d906(0x142),'hMvnG':function(_0x31d2e4){return _0x31d2e4();},'QbXXT':'EAHfH'},_0x2ddde8=this[_0x57d906(0x14e)][0x0];if(_0x2ddde8===undefined||_0x2ddde8['name']==='')return;if(_0x2ddde8[_0x57d906(0x136)]['indexOf'](_0x57d906(0x10b))!==0x0){if(_0x1eb83b['QbXXT']===_0x57d906(0x119))return;else return _0x1eb83b['tCIAI'];}const _0x4e3b4f=new FileReader();_0x4e3b4f['onload']=_0x4a0bcf=>{const _0x5aafb7=_0x57d906;if(_0x4a0bcf[_0x5aafb7(0x136)]!==_0x1eb83b[_0x5aafb7(0x12e)])return;const _0x375218=uBlockDashboard['mergeNewLines'](_0x1eb83b[_0x5aafb7(0x145)](getEditorText)[_0x5aafb7(0x105)](),_0x4e3b4f[_0x5aafb7(0x123)][_0x5aafb7(0x105)]());setEditorText(_0x375218);},_0x4e3b4f[_0x57d906(0x156)](_0x2ddde8);}function startImportFilePicker(){const _0x969841=_0x57873b,_0x1f9d93=qs$(_0x969841(0x143));_0x1f9d93[_0x969841(0x152)]='',_0x1f9d93['click']();}function exportWhitelistToFile(){const _0x2c83cb=_0x57873b,_0x1db611={'KUUjE':function(_0x6424e4){return _0x6424e4();},'zSmJC':function(_0x467b50,_0x185aae){return _0x467b50(_0x185aae);},'eFdJd':function(_0x356fb9,_0x3789c0){return _0x356fb9(_0x3789c0);},'TFKfk':function(_0x13c2d9,_0x4c7d73){return _0x13c2d9+_0x4c7d73;}},_0x37ee21=_0x1db611['KUUjE'](getEditorText);if(_0x37ee21==='')return;const _0x43615c=_0x1db611[_0x2c83cb(0x12f)](i18n$,_0x2c83cb(0x11e))[_0x2c83cb(0x131)](_0x2c83cb(0x150),uBlockDashboard[_0x2c83cb(0x151)]())[_0x2c83cb(0x131)](/ +/g,'_');vAPI['download']({'url':_0x2c83cb(0x102)+_0x1db611[_0x2c83cb(0x10f)](encodeURIComponent,_0x1db611[_0x2c83cb(0x103)](_0x37ee21,'\x0a')),'filename':_0x43615c});}async function applyChanges(){const _0x356e01=_0x57873b,_0x29d926={'TAsTP':function(_0x459760){return _0x459760();}};cachedWhitelist=_0x29d926[_0x356e01(0x15d)](getEditorText)[_0x356e01(0x105)](),await messaging['send'](_0x356e01(0x155),{'what':'setWhitelist','whitelist':cachedWhitelist}),renderWhitelist();}function revertChanges(){setEditorText(cachedWhitelist);}function getCloudData(){const _0x43baa1={'EpFFt':function(_0x2336c5){return _0x2336c5();}};return _0x43baa1['EpFFt'](getEditorText);}function setCloudData(_0x5c60fc,_0x3a1d9b){const _0x6d0915=_0x57873b,_0x1e3264={'sfDiz':'string','dVJNe':function(_0x4cab9a){return _0x4cab9a();}};if(typeof _0x5c60fc!==_0x1e3264['sfDiz'])return;_0x3a1d9b&&(_0x5c60fc=uBlockDashboard[_0x6d0915(0x112)](_0x1e3264[_0x6d0915(0x149)](getEditorText)[_0x6d0915(0x105)](),_0x5c60fc)),setEditorText(_0x5c60fc[_0x6d0915(0x105)]());}self[_0x57873b(0xff)]['onPush']=getCloudData,self['cloud'][_0x57873b(0x116)]=setCloudData,self[_0x57873b(0x159)]=_0x57873b(0x113),self[_0x57873b(0x135)]=function(){const _0x1f8bed=_0x57873b,_0x38c51f={'iJgul':function(_0x3727bd){return _0x3727bd();}};return _0x38c51f[_0x1f8bed(0x107)](getEditorText)[_0x1f8bed(0x105)]()!==cachedWhitelist;},dom['on'](_0x57873b(0x106),'click',startImportFilePicker),dom['on'](_0x57873b(0x143),_0x57873b(0x13b),handleImportFilePicker),dom['on'](_0x57873b(0x117),_0x57873b(0x111),exportWhitelistToFile),dom['on'](_0x57873b(0x12c),_0x57873b(0x111),()=>{applyChanges();}),dom['on'](_0x57873b(0x139),_0x57873b(0x111),revertChanges),renderWhitelist();