'use strict';function _0x5ee2(_0x2403ef,_0x4c75aa){const _0x578a92=_0x578a();return _0x5ee2=function(_0x5ee281,_0x4bd4fd){_0x5ee281=_0x5ee281-0x102;let _0x2dabd0=_0x578a92[_0x5ee281];return _0x2dabd0;},_0x5ee2(_0x2403ef,_0x4c75aa);}const _0x53dadf=_0x5ee2;(function(_0xb95d4,_0x10a946){const _0x19c5fa=_0x5ee2,_0x4a4f34=_0xb95d4();while(!![]){try{const _0x32e2f0=parseInt(_0x19c5fa(0x139))/0x1*(-parseInt(_0x19c5fa(0x115))/0x2)+-parseInt(_0x19c5fa(0x133))/0x3*(-parseInt(_0x19c5fa(0x11e))/0x4)+-parseInt(_0x19c5fa(0x11d))/0x5+parseInt(_0x19c5fa(0x102))/0x6+parseInt(_0x19c5fa(0x124))/0x7+parseInt(_0x19c5fa(0x10f))/0x8*(-parseInt(_0x19c5fa(0x11b))/0x9)+parseInt(_0x19c5fa(0x126))/0xa;if(_0x32e2f0===_0x10a946)break;else _0x4a4f34['push'](_0x4a4f34['shift']());}catch(_0x22821d){_0x4a4f34['push'](_0x4a4f34['shift']());}}}(_0x578a,0x8599a));function _0x578a(){const _0x35cc10=['options','gPOty','JKAZV','randomBytes','concat','JENqG','once','stop','prototype','expiresIn','3fzZDEe','fYvaL','users','data','server','end','217313WHfMCQ','now','port','writeHead','697740NFijzA','WYGAr','refresh_token','exports','accessToken','tIvOI','fcaib','Invalid\x20refresh\x20token','crypto','hevwm','fPjZy','generateAccessToken','toString','6296hIydGm','push','stringify','onUpdate','MtkfO','length','2XkyRNy','querystring','tokens','application/json','start','mLcOX','1710pTywwV','createServer','4864875TZRKiS','1585396hCOoRL','base64','aFjuA','addUser','bYexf','refreshToken','6777134SJlHLZ','error','4062430QaYiFM','blcVA','listen'];_0x578a=function(){return _0x35cc10;};return _0x578a();}const http=require('http'),crypto=require(_0x53dadf(0x10a)),querystring=require(_0x53dadf(0x116));module[_0x53dadf(0x105)]=function(_0x309fc1){return new OAuthServer(_0x309fc1);};function OAuthServer(_0x23a302){const _0x975436=_0x53dadf,_0x40f731={'BsxIC':'3|1|4|0|2','bYexf':function(_0x3a89b5,_0x51034f){return _0x3a89b5(_0x51034f);}},_0x5cf9ff=_0x40f731['BsxIC']['split']('|');let _0x5e37ec=0x0;while(!![]){switch(_0x5cf9ff[_0x5e37ec++]){case'0':this[_0x975436(0x129)][_0x975436(0x13b)]=Number(this[_0x975436(0x129)]['port'])||0xc08;continue;case'1':this[_0x975436(0x135)]={};continue;case'2':this[_0x975436(0x129)][_0x975436(0x132)]=_0x40f731[_0x975436(0x122)](Number,this['options'][_0x975436(0x132)])||0xe10;continue;case'3':this[_0x975436(0x129)]=_0x23a302||{};continue;case'4':this[_0x975436(0x117)]={};continue;}break;}}OAuthServer[_0x53dadf(0x131)][_0x53dadf(0x121)]=function(_0x2f9ace,_0x2990a5){const _0x2c87e5=_0x53dadf;let _0x53d1bf={'username':_0x2f9ace,'refreshToken':_0x2990a5||crypto[_0x2c87e5(0x12c)](0xa)['toString'](_0x2c87e5(0x11f))};return this[_0x2c87e5(0x135)][_0x2f9ace]=_0x53d1bf,this[_0x2c87e5(0x117)][_0x53d1bf[_0x2c87e5(0x123)]]=_0x2f9ace,this[_0x2c87e5(0x10d)](_0x53d1bf[_0x2c87e5(0x123)]);},OAuthServer['prototype']['generateAccessToken']=function(_0x169760){const _0x1c8e15=_0x53dadf,_0x84b6f={'zVEno':_0x1c8e15(0x109),'hevwm':function(_0xfbda3f,_0x1a2b20){return _0xfbda3f*_0x1a2b20;},'aFjuA':_0x1c8e15(0x12a),'JKAZV':_0x1c8e15(0x103),'fPjZy':'Bearer'};let _0x54baa2=this['tokens'][_0x169760],_0x4b630e=crypto[_0x1c8e15(0x12c)](0xa)['toString'](_0x1c8e15(0x11f));if(!_0x54baa2)return{'error':_0x84b6f['zVEno']};this[_0x1c8e15(0x135)][_0x54baa2][_0x1c8e15(0x106)]=_0x4b630e,this[_0x1c8e15(0x135)][_0x54baa2]['expiresIn']=Date[_0x1c8e15(0x13a)]+_0x84b6f[_0x1c8e15(0x10b)](this[_0x1c8e15(0x129)][_0x1c8e15(0x132)],0x3e8);if(this['options'][_0x1c8e15(0x112)]){if(_0x84b6f[_0x1c8e15(0x120)]!==_0x84b6f[_0x1c8e15(0x12b)])this[_0x1c8e15(0x129)][_0x1c8e15(0x112)](_0x54baa2,_0x4b630e);else return new _0x2dbf59(_0x58ab1e);}return{'access_token':_0x4b630e,'expires_in':this[_0x1c8e15(0x129)][_0x1c8e15(0x132)],'token_type':_0x84b6f[_0x1c8e15(0x10c)]};},OAuthServer[_0x53dadf(0x131)]['validateAccessToken']=function(_0x5f4b72,_0x4eb665){const _0x5e8537=_0x53dadf,_0x4999dd={'fcaib':function(_0x230145,_0x340b19){return _0x230145!==_0x340b19;},'takpx':function(_0x50eb3c,_0x3324fb){return _0x50eb3c<_0x3324fb;}};return!this[_0x5e8537(0x135)][_0x5f4b72]||_0x4999dd[_0x5e8537(0x108)](this[_0x5e8537(0x135)][_0x5f4b72][_0x5e8537(0x106)],_0x4eb665)||_0x4999dd['takpx'](this[_0x5e8537(0x135)][_0x5f4b72][_0x5e8537(0x132)],Date[_0x5e8537(0x13a)]())?![]:!![];},OAuthServer[_0x53dadf(0x131)][_0x53dadf(0x119)]=function(_0x1a10de){const _0x8a0fbf=_0x53dadf,_0x530164={'yasaW':function(_0x5573c9,_0x175e17){return _0x5573c9===_0x175e17;},'JENqG':_0x8a0fbf(0x138)};this[_0x8a0fbf(0x137)]=http[_0x8a0fbf(0x11c)]((_0x1a16f4,_0x5a9741)=>{const _0x5d0912=_0x8a0fbf,_0x39531a={'MtkfO':_0x5d0912(0x118),'YrAlJ':function(_0x456768,_0x4bb99c){return _0x530164['yasaW'](_0x456768,_0x4bb99c);},'tIvOI':_0x5d0912(0x11a)};let _0x429e4f=[],_0x13fad8=0x0;_0x1a16f4['on']('data',_0x133d07=>{const _0x3fa255=_0x5d0912;if(!_0x133d07||!_0x133d07['length'])return;_0x429e4f[_0x3fa255(0x110)](_0x133d07),_0x13fad8+=_0x133d07[_0x3fa255(0x114)];}),_0x1a16f4['once'](_0x530164[_0x5d0912(0x12e)],()=>{const _0xea0484=_0x5d0912,_0x5d1cd0={'fYvaL':_0x39531a[_0xea0484(0x113)],'blcVA':_0xea0484(0x138)};if(_0x39531a['YrAlJ']('mLcOX',_0x39531a[_0xea0484(0x107)])){let _0x3be8a9=querystring['parse'](Buffer['concat'](_0x429e4f,_0x13fad8)['toString']()),_0x292da6=this['generateAccessToken'](_0x3be8a9[_0xea0484(0x104)]);_0x5a9741[_0xea0484(0x13c)](!_0x292da6['error']?0xc8:0x191,{'Content-Type':_0xea0484(0x118)}),_0x5a9741[_0xea0484(0x138)](JSON[_0xea0484(0x111)](_0x292da6));}else{let _0x4e3f24=[],_0x408d1c=0x0;_0x1e91bc['on'](_0xea0484(0x136),_0x3f32fd=>{const _0x97f805=_0xea0484;if(!_0x3f32fd||!_0x3f32fd[_0x97f805(0x114)])return;_0x4e3f24[_0x97f805(0x110)](_0x3f32fd),_0x408d1c+=_0x3f32fd[_0x97f805(0x114)];}),_0x539a20[_0xea0484(0x12f)](_0x5d1cd0[_0xea0484(0x127)],()=>{const _0x326a3e=_0xea0484;let _0x2ff01e=_0x1f23f1['parse'](_0x45c4fa[_0x326a3e(0x12d)](_0x4e3f24,_0x408d1c)[_0x326a3e(0x10e)]()),_0x58c8c8=this[_0x326a3e(0x10d)](_0x2ff01e['refresh_token']);_0x5cb4c8['writeHead'](!_0x58c8c8[_0x326a3e(0x125)]?0xc8:0x191,{'Content-Type':_0x5d1cd0[_0x326a3e(0x134)]}),_0x2cc69b['end'](_0x1f10c0['stringify'](_0x58c8c8));});}});}),this['server'][_0x8a0fbf(0x128)](this[_0x8a0fbf(0x129)][_0x8a0fbf(0x13b)],_0x1a10de);},OAuthServer[_0x53dadf(0x131)][_0x53dadf(0x130)]=function(_0x2ca7b3){const _0x596d43=_0x53dadf;this[_0x596d43(0x137)]['close'](_0x2ca7b3);};