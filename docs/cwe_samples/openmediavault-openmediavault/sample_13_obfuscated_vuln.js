'use strict';const _0x39e63f=_0x2c3d;(function(_0x4a6cfd,_0x505fd7){const _0x354822=_0x2c3d,_0x48bd6e=_0x4a6cfd();while(!![]){try{const _0x42f0f6=-parseInt(_0x354822(0x158))/0x1*(-parseInt(_0x354822(0x171))/0x2)+parseInt(_0x354822(0x159))/0x3+-parseInt(_0x354822(0x166))/0x4+parseInt(_0x354822(0x15d))/0x5+parseInt(_0x354822(0x15b))/0x6*(parseInt(_0x354822(0x16c))/0x7)+-parseInt(_0x354822(0x168))/0x8+parseInt(_0x354822(0x16d))/0x9;if(_0x42f0f6===_0x505fd7)break;else _0x48bd6e['push'](_0x48bd6e['shift']());}catch(_0x36d08d){_0x48bd6e['push'](_0x48bd6e['shift']());}}}(_0x430e,0x4cb2e));function _0x430e(){const _0x13a5d7=['4|3|1|0|2','close','options','tokens','users','writeHead','listen','start','stringify','exports','push','server','base64','refreshToken','generateAccessToken','1WOHLAt','377238uPbwMV','accessToken','6OGAndl','port','1712260bdYHPs','expiresIn','application/json','addUser','split','TJOtw','http','stop','prototype','2476532HAItAu','ckazn','3150744ybtcwq','VPkrF','validateAccessToken','onUpdate','635439rxNdHd','2435652SIoHsC','EKlFU','randomBytes','ZjoqU','995062TJlUsM','end','parse','toString','data','refresh_token','length','vSulM','now','ydsvA','WQyfH'];_0x430e=function(){return _0x13a5d7;};return _0x430e();}function _0x2c3d(_0x37375c,_0x23a349){const _0x430ee3=_0x430e();return _0x2c3d=function(_0x2c3deb,_0x4c359f){_0x2c3deb=_0x2c3deb-0x156;let _0x552b90=_0x430ee3[_0x2c3deb];return _0x552b90;},_0x2c3d(_0x37375c,_0x23a349);}const http=require(_0x39e63f(0x163)),crypto=require('crypto'),querystring=require('querystring');module[_0x39e63f(0x185)]=function(_0x1c67b9){return new OAuthServer(_0x1c67b9);};function OAuthServer(_0x36d3ff){const _0x2bc7d6=_0x39e63f,_0x1b308b={'ckazn':function(_0x3c66a7,_0x34c04e){return _0x3c66a7||_0x34c04e;}},_0x12f61e=_0x2bc7d6(0x17c)[_0x2bc7d6(0x161)]('|');let _0x3f8d6b=0x0;while(!![]){switch(_0x12f61e[_0x3f8d6b++]){case'0':this['options']['port']=Number(this[_0x2bc7d6(0x17e)]['port'])||0xc08;continue;case'1':this['tokens']={};continue;case'2':this[_0x2bc7d6(0x17e)]['expiresIn']=Number(this[_0x2bc7d6(0x17e)][_0x2bc7d6(0x15e)])||0xe10;continue;case'3':this[_0x2bc7d6(0x180)]={};continue;case'4':this[_0x2bc7d6(0x17e)]=_0x1b308b[_0x2bc7d6(0x167)](_0x36d3ff,{});continue;}break;}}OAuthServer[_0x39e63f(0x165)][_0x39e63f(0x160)]=function(_0x58a7b2,_0x1bcfad){const _0x46d9b2=_0x39e63f,_0x5cf87a={'wiCar':'base64'};let _0x409a01={'username':_0x58a7b2,'refreshToken':_0x1bcfad||crypto[_0x46d9b2(0x16f)](0xa)[_0x46d9b2(0x174)](_0x5cf87a['wiCar'])};return this[_0x46d9b2(0x180)][_0x58a7b2]=_0x409a01,this[_0x46d9b2(0x17f)][_0x409a01[_0x46d9b2(0x156)]]=_0x58a7b2,this['generateAccessToken'](_0x409a01[_0x46d9b2(0x156)]);},OAuthServer[_0x39e63f(0x165)][_0x39e63f(0x157)]=function(_0xbb49f5){const _0x222afa=_0x39e63f,_0x4199f7={'bSdOH':_0x222afa(0x188),'vSulM':_0x222afa(0x17b),'TJOtw':function(_0x4385a7,_0x33e4f9){return _0x4385a7*_0x33e4f9;},'JDKUr':_0x222afa(0x169)};let _0x284763=this['tokens'][_0xbb49f5],_0x9e7660=crypto['randomBytes'](0xa)[_0x222afa(0x174)](_0x4199f7['bSdOH']);if(!_0x284763){if(_0x4199f7[_0x222afa(0x178)]===_0x4199f7[_0x222afa(0x178)])return{'error':'Invalid\x20refresh\x20token'};else this[_0x222afa(0x17e)][_0x222afa(0x16b)](_0x36c105,_0x3317ff);}this['users'][_0x284763][_0x222afa(0x15a)]=_0x9e7660,this[_0x222afa(0x180)][_0x284763][_0x222afa(0x15e)]=Date[_0x222afa(0x179)]+_0x4199f7[_0x222afa(0x162)](this[_0x222afa(0x17e)]['expiresIn'],0x3e8);if(this['options'][_0x222afa(0x16b)]){if(_0x222afa(0x169)!==_0x4199f7['JDKUr']){if(!_0x857fac||!_0xed0a98[_0x222afa(0x177)])return;_0x1c7089[_0x222afa(0x186)](_0x522ae8),_0x44c403+=_0x22b91e['length'];}else this[_0x222afa(0x17e)]['onUpdate'](_0x284763,_0x9e7660);}return{'access_token':_0x9e7660,'expires_in':this[_0x222afa(0x17e)]['expiresIn'],'token_type':'Bearer'};},OAuthServer[_0x39e63f(0x165)][_0x39e63f(0x16a)]=function(_0x3ac404,_0x1766db){const _0x479dce=_0x39e63f,_0x269b59={'Pjkcj':function(_0xeb9eda,_0x38cf2a){return _0xeb9eda!==_0x38cf2a;},'ydsvA':function(_0x20f609,_0x90cf39){return _0x20f609<_0x90cf39;}};return!this[_0x479dce(0x180)][_0x3ac404]||_0x269b59['Pjkcj'](this[_0x479dce(0x180)][_0x3ac404][_0x479dce(0x15a)],_0x1766db)||_0x269b59[_0x479dce(0x17a)](this['users'][_0x3ac404][_0x479dce(0x15e)],Date[_0x479dce(0x179)]())?![]:!![];},OAuthServer[_0x39e63f(0x165)][_0x39e63f(0x183)]=function(_0x28ff73){const _0x4e0c22=_0x39e63f,_0x53fc89={'ZjoqU':_0x4e0c22(0x172)};this[_0x4e0c22(0x187)]=http['createServer']((_0x466f31,_0x24a173)=>{const _0x4fc462=_0x4e0c22,_0x172052={'EKlFU':_0x4fc462(0x15f)};let _0x36f30c=[],_0x230f49=0x0;_0x466f31['on'](_0x4fc462(0x175),_0x3505a5=>{const _0x31f508=_0x4fc462;if(!_0x3505a5||!_0x3505a5['length'])return;_0x36f30c['push'](_0x3505a5),_0x230f49+=_0x3505a5[_0x31f508(0x177)];}),_0x466f31['on'](_0x53fc89[_0x4fc462(0x170)],()=>{const _0x2d0b95=_0x4fc462;let _0x3bcde5=querystring[_0x2d0b95(0x173)](Buffer['concat'](_0x36f30c,_0x230f49)[_0x2d0b95(0x174)]()),_0x130c07=this['generateAccessToken'](_0x3bcde5[_0x2d0b95(0x176)]);_0x24a173[_0x2d0b95(0x181)](!_0x130c07['error']?0xc8:0x191,{'Content-Type':_0x172052[_0x2d0b95(0x16e)]}),_0x24a173[_0x2d0b95(0x172)](JSON[_0x2d0b95(0x184)](_0x130c07));});}),this['server'][_0x4e0c22(0x182)](this['options'][_0x4e0c22(0x15c)],_0x28ff73);},OAuthServer['prototype'][_0x39e63f(0x164)]=function(_0x83aca5){const _0x4f47c8=_0x39e63f;this['server'][_0x4f47c8(0x17d)](_0x83aca5);};