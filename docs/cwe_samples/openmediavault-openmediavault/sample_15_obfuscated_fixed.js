'use strict';const _0x245c23=_0x1220;function _0x32c8(){const _0x1c4969=['EKqFy','nsDsx','qgtmW','hfFBD','TaBDU','8617UFiegD','UeHZr','gOXjl','oyGZE','push','pZTEe','TnMbA','laeer','read','EsFhd','should\x20sign\x20large\x20message\x20without\x20cache\x20dir','zGiPl','should\x20sign\x20message','ExVTB','bhuHU','QXAMS','gfGKZ','From:\x20saatja\x20aadress\x0aTo:\x20Saaja\x20aadress\x0aSubject:\x20pealkiri\x0a\x20\x20mitmel\x0a\x20\x20real\x0aMessage-Id:\x20test\x0a\x0atere\x20tere\x0ateine\x20rida\x0a','Jsolc','VkELP','AZYbU','723024oTshNV','Message-Id:\x20test\x0a','true','SDPMf','crypto','5qCuRtE','2bsXAyI','should\x20sign\x20large\x20message\x20as\x20Buffer','qttof','not','node.ee','FRXLh','rDLoa','tpMkw','utf-8','dksoP','TLxkP','\x20\x20mitmel\x0a','uqcGd','tSBfX','bcBxq','RJgyS','-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIIBywIBAAJhANCx7ncKUfQ8wBUYmMqq6ky8rBB0NL8knBf3+uA7q/CSxpX6sQ8N\x0adFNtEeEd7gu7BWEM7+PkO1P0M78eZOvVmput8BP9R44ARpgHY4V0qSCdUt4rD32n\x0awfjlGbh8p5ua5wIDAQABAmAm+uUQpQPTu7kg95wqVqw2sxLsa9giT6M8MtxQH7Uo\x0a1TF0eAO0TQ4KOxgY1S9OT5sGPVKnag258m3qX7o5imawcuyStb68DQgAUg6xv7Af\x0aAqAEDfYN5HW6xK+X81jfOUECMQDr7XAS4PERATvgb1B3vRu5UEbuXcenHDYgdoyT\x0a3qJFViTbep4qeaflF0uF9eFveMcCMQDic10rJ8fopGD7/a45O4VJb0+lRXVdqZxJ\x0aQzAp+zVKWqDqPfX7L93SQLzOGhdd7OECMQDeQyD7WBkjSQNMy/GF7I1qxrscIxNN\x0aVqGTcbu8Lti285Hjhx/sqhHHHGwU9vB7oM8CMQDKTS3Kw/s/xrot5O+kiZwFgr+w\x0acmDrj/7jJHb+ykFNb7GaEkiSYqzUjKkfpweBDYECMFJUyzuuFJAjq3BXmGJlyykQ\x0aTweUw+zMVdSXjO+FCPcYNi6CP1t1KoESzGKBVoqA/g==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----','sqzXH','DKCJM','ocPEy','dkim','toString','ebvAM','PXxYC','vhqfv','13opmaeI','digest','iLLeo','39421140DMZJYw','update','MGFYP','qYobY','timeout','1272uKTzvg','false','kpYkA','usingCache','expect','OPZDI','ioCEU','should\x20sign\x20large\x20message\x20as\x20String','qnenM','chai','From:\x20saatja\x20aadress\x0a','/rootertewywrtyreetwert','588yhMxHo','should\x20sign\x20large\x20message\x20using\x20cache\x20dir','apFMb','AszdU','SKIiI','hex','BOpNk','IELPk','FUjMZ','bjeRv','USYCF','4195794pMcQhQ','lNtTo','DKIM-Signature:\x20v=1;\x20a=rsa-sha256;\x20c=relaxed/relaxed;\x20d=node.ee;\x20q=dns/txt;\x0d\x0a','UzlCW','120IueMmn','exist','createHash','Subject:\x20pealkiri\x0a','\x20KVPF5T1oB8/oY6TFqyyuECRrI4D2CfG3VXWBShK32r1Wtv7eWN04b4s\x0d\x0a','rKPZF','ZAEIE','write','To:\x20Saaja\x20aadress\x0a','ztWur','XZmGV','join','ZoqkL','RXsqf','indexOf','fuerF','YoISv','sign','BLMmM','equal','cache','X-Zone-Loop','ZbvHu','SPObi','../../lib/dkim','bh=ST+2Z7mCDd8CPa6pWbCWnFBLKyl8/I5d0JCaEQub550=','PassThrough','enUap','16078d67ecb4c9954f2568b3bd20e8b5','readFileSync','658664wxBweK','substr','md5','\x20b=tey8mL2VQVuy/phh7yEKi86Y0Yyzyy04qTy73G4yg3qdEDB7uymjNr32ruRPVFmC9PimIK75p\x0d\x0a','end','tere\x20tere\x0a','\x20s=dkim;\x20bh=h2JdEKA6yVYSGuI3DQCDlg2KL+96GxA7Yw7owvsYDUM=;\x0d\x0a','UEzNK','RACrw','readable','ScDmu','jbSYV','error','teine\x20rida\x0a','gte','VRgKb','CXmjE','concat','17034776NrSAiB','iNBQK','createReadStream','from','LHctO','OpFop','34788kycsVo','/fixtures/large.eml','KfquW','euvyh','length'];_0x32c8=function(){return _0x1c4969;};return _0x32c8();}(function(_0xe77598,_0x5e5a50){const _0x13b2fc=_0x1220,_0x16b402=_0xe77598();while(!![]){try{const _0x385fe6=parseInt(_0x13b2fc(0xff))/0x1*(-parseInt(_0x13b2fc(0xc2))/0x2)+parseInt(_0x13b2fc(0x95))/0x3*(parseInt(_0x13b2fc(0xda))/0x4)+-parseInt(_0x13b2fc(0xfe))/0x5*(parseInt(_0x13b2fc(0xa0))/0x6)+parseInt(_0x13b2fc(0xe4))/0x7*(-parseInt(_0x13b2fc(0x89))/0x8)+parseInt(_0x13b2fc(0xf9))/0x9*(-parseInt(_0x13b2fc(0xa4))/0xa)+-parseInt(_0x13b2fc(0xd4))/0xb+-parseInt(_0x13b2fc(0x84))/0xc*(-parseInt(_0x13b2fc(0x81))/0xd);if(_0x385fe6===_0x5e5a50)break;else _0x16b402['push'](_0x16b402['shift']());}catch(_0x7d8d0f){_0x16b402['push'](_0x16b402['shift']());}}}(_0x32c8,0xe16e7));const chai=require(_0x245c23(0x92)),expect=chai[_0x245c23(0x8d)],path=require('path'),crypto=require(_0x245c23(0xfd)),fs=require('fs'),PassThrough=require('stream')[_0x245c23(0xbe)],DKIM=require(_0x245c23(0xbc));chai['config']['includeStack']=!![];function _0x1220(_0x581d68,_0x99f97f){const _0x32c899=_0x32c8();return _0x1220=function(_0x12204b,_0x1f9d22){_0x12204b=_0x12204b-0x75;let _0x516027=_0x32c899[_0x12204b];return _0x516027;},_0x1220(_0x581d68,_0x99f97f);}const privateKey=_0x245c23(0x78);describe('DKIM\x20Tests',function(){const _0x731916=_0x245c23,_0x4df2aa={'BSVPe':function(_0x4a8d7a,_0x3a8d12){return _0x4a8d7a>=_0x3a8d12;},'oCgTS':_0x731916(0x98),'IELPk':function(_0x2623f0,_0x249956){return _0x2623f0(_0x249956);},'LHctO':function(_0x5387c6,_0x3cb2e7){return _0x5387c6+_0x3cb2e7;},'ioCEU':_0x731916(0xc5),'dUbna':_0x731916(0xac),'jbSYV':'node.ee','fuerF':_0x731916(0xc6),'PXxYC':function(_0x6ff626,_0x4c064a){return _0x6ff626(_0x4c064a);},'ExVTB':_0x731916(0xc0),'FRXLh':function(_0x1744e1){return _0x1744e1();},'ZAEIE':_0x731916(0xdc),'sLYve':'/fixtures/large.eml','SKIiI':_0x731916(0xce),'FKtoq':function(_0x3cbe95,_0x45e612){return _0x3cbe95===_0x45e612;},'kSRFi':_0x731916(0x7c),'apFMb':_0x731916(0xa3),'oyGZE':_0x731916(0x7e),'AZYbU':function(_0x470b0c){return _0x470b0c();},'ScDmu':_0x731916(0xbd),'iNBQK':_0x731916(0xc4),'kpYkA':function(_0x10f9f7){return _0x10f9f7();},'iLLeo':'readable','uqcGd':function(_0x372a5f,_0x18272e){return _0x372a5f(_0x18272e);},'laeer':_0x731916(0x9a),'CXmjE':function(_0x458540){return _0x458540();},'bhuHU':function(_0x3aa26a,_0x1be2c0){return _0x3aa26a===_0x1be2c0;},'ztWur':'OMmGx','qwxIV':function(_0x3020ff,_0x1f1501){return _0x3020ff!==_0x1f1501;},'AmUBx':function(_0x17aba9,_0x3a05c7){return _0x17aba9(_0x3a05c7);},'nsDsx':function(_0x202b64,_0x122e9e){return _0x202b64(_0x122e9e);},'YoISv':_0x731916(0xb6),'SDPMf':function(_0x154190,_0x240839){return _0x154190(_0x240839);},'Jsolc':_0x731916(0xb8),'RXsqf':function(_0x3b14c5,_0x310fa2){return _0x3b14c5(_0x310fa2);},'RJgyS':function(_0x353ec3){return _0x353ec3();},'DjjXy':function(_0x15191c,_0x496f12){return _0x15191c===_0x496f12;},'DKCJM':function(_0x37d6e5,_0x242a99){return _0x37d6e5(_0x242a99);},'zGiPl':_0x731916(0xb9),'OPZDI':function(_0x56494c,_0x5ac85a){return _0x56494c(_0x5ac85a);},'tSBfX':function(_0xec49bf){return _0xec49bf();},'USYCF':_0x731916(0x107),'qnenM':function(_0x5a9ae9,_0x27eee1){return _0x5a9ae9*_0x27eee1;},'hfFBD':_0x731916(0x96),'qgtmW':'should\x20emit\x20cache\x20error'};this[_0x731916(0x88)](_0x4df2aa[_0x731916(0x91)](0x64,0x3e8)),it(_0x731916(0xf0),function(_0x296202){const _0x4ada54=_0x731916,_0x2808b2={'TnMbA':'NODST','SPObi':function(_0x1bf653,_0x5ee3e1){return _0x1bf653*_0x5ee3e1;},'EKqFy':function(_0x318688,_0x389409){return _0x318688===_0x389409;},'enUap':function(_0x4fccd2,_0x3d8fef){return _0x4fccd2(_0x3d8fef);},'FUjMZ':function(_0x3225fc,_0x513f15){return _0x3225fc+_0x513f15;},'BOpNk':function(_0x35f742,_0x29872c){return _0x4df2aa['LHctO'](_0x35f742,_0x29872c);},'qttof':function(_0x3d90be,_0x2d687d){return _0x3d90be+_0x2d687d;},'ocPEy':function(_0x412f3c,_0x540f6b){return _0x412f3c+_0x540f6b;},'XZmGV':function(_0x421b2d,_0x3ccd52){const _0x196dcc=_0x1220;return _0x4df2aa[_0x196dcc(0xd8)](_0x421b2d,_0x3ccd52);},'UeHZr':function(_0x3c2867,_0x2a9611){return _0x3c2867+_0x2a9611;},'QXAMS':_0x4ada54(0xa2),'bcBxq':_0x4ada54(0xc8),'EDjMK':'\x20h=from:subject:message-id:to;\x0d\x0a','VRgKb':_0x4df2aa[_0x4ada54(0x8f)],'bjeRv':_0x4df2aa['dUbna'],'wcrNl':_0x4ada54(0x10a),'UEzNK':_0x4ada54(0xcf),'dksoP':function(_0x33b41b){return _0x33b41b();}};let _0x244544=_0x4ada54(0xf5),_0x410606=new PassThrough(),_0x1848c6=new DKIM({'domainName':_0x4df2aa['jbSYV'],'keySelector':_0x4ada54(0x7c),'privateKey':privateKey}),_0x3e22ab=_0x1848c6[_0x4ada54(0xb5)](_0x410606),_0x257293=[],_0xe6c0ac=![],_0x3402e1=()=>{const _0x3ecec5=_0x4ada54;if('WizYd'!==_0x2808b2[_0x3ecec5(0xea)]){let _0x4530a7=_0x3e22ab[_0x3ecec5(0xec)](_0x2808b2[_0x3ecec5(0xbb)](0xa,0x400));if(_0x2808b2[_0x3ecec5(0xdf)](_0x4530a7,null)){_0xe6c0ac=![];return;}_0xe6c0ac=!![],_0x257293[_0x3ecec5(0xe8)](_0x4530a7),_0x2808b2[_0x3ecec5(0xbf)](setImmediate,_0x3402e1);}else _0x3703c4();};_0x3e22ab['on'](_0x4ada54(0xcb),()=>{!_0xe6c0ac&&_0x3402e1();}),_0x3e22ab['on'](_0x4df2aa[_0x4ada54(0xb3)],()=>{const _0x5aa439=_0x4ada54;let _0x58dd99=Buffer[_0x5aa439(0xd3)](_0x257293)[_0x5aa439(0x7d)]();_0x2808b2[_0x5aa439(0xbf)](expect,_0x58dd99)['to'][_0x5aa439(0xb7)](_0x2808b2[_0x5aa439(0x9d)](_0x2808b2[_0x5aa439(0x9b)](_0x2808b2[_0x5aa439(0x9d)](_0x2808b2[_0x5aa439(0x9d)](_0x2808b2[_0x5aa439(0x101)](_0x2808b2[_0x5aa439(0x7b)](_0x2808b2[_0x5aa439(0xae)](_0x2808b2[_0x5aa439(0xe5)](_0x2808b2[_0x5aa439(0xae)](_0x2808b2[_0x5aa439(0xe5)](_0x2808b2[_0x5aa439(0xf3)],_0x2808b2[_0x5aa439(0x76)]),_0x2808b2['EDjMK']),_0x2808b2[_0x5aa439(0xd1)]),_0x5aa439(0xa8))+_0x5aa439(0x93),_0x2808b2[_0x5aa439(0x9e)])+_0x5aa439(0xa7)+_0x2808b2['wcrNl'],'\x20\x20real\x0a'),_0x5aa439(0xfa)),'\x0a'),_0x5aa439(0xc7)),_0x2808b2[_0x5aa439(0xc9)])),_0x296202();});let _0x4d6473=0x0,_0x488e2e=Buffer[_0x4ada54(0xd7)](_0x244544),_0x12e498=()=>{const _0x4ce08e=_0x4ada54;if(_0x4df2aa['BSVPe'](_0x4d6473,_0x488e2e[_0x4ce08e(0xde)])){if(_0x4ce08e(0xe6)===_0x4df2aa['oCgTS'])_0x231cee(_0x5b3fbe)['to'][_0x4ce08e(0x102)][_0x4ce08e(0xa5)],_0x2808b2[_0x4ce08e(0x108)](_0x37f0ba);else return _0x410606[_0x4ce08e(0xc6)]();}_0x410606[_0x4ce08e(0xab)](Buffer[_0x4ce08e(0xd7)]([_0x488e2e[_0x4d6473++]])),_0x4df2aa[_0x4ce08e(0x9c)](setImmediate,_0x12e498);};_0x12e498();}),it(_0x4df2aa[_0x731916(0xe2)],function(_0x2c17c6){const _0x58311d=_0x731916,_0x4d816a={'XtAYV':function(_0x342d47){return _0x342d47();},'pZTEe':function(_0x303a7b,_0x57fa75){return _0x303a7b===_0x57fa75;},'TLxkP':_0x4df2aa[_0x58311d(0xaa)],'lNtTo':function(_0x50e94f,_0x375ad6){return _0x50e94f(_0x375ad6);}};let _0xfc7043=new DKIM({'domainName':_0x4df2aa[_0x58311d(0xcd)],'keySelector':_0x58311d(0x7c),'privateKey':privateKey,'cacheDir':path[_0x58311d(0xaf)](__dirname,'cache')}),_0x69331b=_0xfc7043[_0x58311d(0xb5)](fs[_0x58311d(0xd6)](_0x4df2aa[_0x58311d(0xd8)](__dirname,_0x4df2aa['sLYve'])));_0x69331b['on'](_0x4df2aa[_0x58311d(0x99)],_0x13e7ad=>{const _0x2933c8=_0x58311d;_0x4df2aa[_0x2933c8(0x9c)](expect,_0x13e7ad)['to'][_0x2933c8(0x102)][_0x2933c8(0xa5)],_0x2c17c6();});let _0x58afa9=[],_0x1fe0d9=![],_0x516124=()=>{const _0x51c3cc=_0x58311d;if(_0x51c3cc(0x105)!==_0x51c3cc(0xed)){let _0x439d7f=_0x69331b[_0x51c3cc(0xec)]();if(_0x439d7f===null){if(_0x4d816a[_0x51c3cc(0xe9)](_0x4d816a[_0x51c3cc(0x109)],'KfquW')){_0x1fe0d9=![];return;}else!_0x24ac2f&&_0x5670fd();}_0x1fe0d9=!![],_0x58afa9[_0x51c3cc(0xe8)](_0x439d7f),_0x4d816a[_0x51c3cc(0xa1)](setImmediate,_0x516124);}else _0x4d816a['XtAYV'](_0x1064e6);};_0x69331b['on'](_0x58311d(0xcb),()=>{!_0x1fe0d9&&_0x516124();}),_0x69331b['on']('end',()=>{const _0x5ec627=_0x58311d;let _0x37060c=Buffer[_0x5ec627(0xd3)](_0x58afa9)[_0x5ec627(0x7d)]();expect(_0x37060c[_0x5ec627(0xb2)]('bh=ST+2Z7mCDd8CPa6pWbCWnFBLKyl8/I5d0JCaEQub550='))['is'][_0x5ec627(0xd0)](0x0),_0x4df2aa[_0x5ec627(0x7f)](expect,crypto[_0x5ec627(0xa6)](_0x5ec627(0xc4))[_0x5ec627(0x85)](Buffer['from'](_0x37060c[_0x5ec627(0xc3)](_0x37060c['indexOf'](_0x5ec627(0xb9)))))['digest'](_0x5ec627(0x9a)))['to'][_0x5ec627(0xb7)](_0x4df2aa['ExVTB']),_0x4df2aa[_0x5ec627(0x9c)](expect,_0x69331b[_0x5ec627(0x8c)])['to']['be'][_0x5ec627(0xfb)],_0x4df2aa[_0x5ec627(0x104)](_0x2c17c6);});}),it(_0x731916(0xee),function(_0x362158){const _0xb390bd=_0x731916;let _0x5e3094=new DKIM({'domainName':_0x4df2aa['jbSYV'],'keySelector':_0xb390bd(0x7c),'privateKey':privateKey}),_0x4fcbe1=_0x5e3094[_0xb390bd(0xb5)](fs[_0xb390bd(0xd6)](__dirname+'/fixtures/large.eml'));_0x4fcbe1['on'](_0xb390bd(0xce),_0x25ebe4=>{const _0x58726=_0xb390bd;expect(_0x25ebe4)['to'][_0x58726(0x102)][_0x58726(0xa5)],_0x362158();});let _0x50da8b=[],_0x4098bd=![],_0x2e22f1=()=>{const _0x291599=_0xb390bd;let _0x34d178=_0x4fcbe1[_0x291599(0xec)]();if(_0x4df2aa['FKtoq'](_0x34d178,null)){_0x4098bd=![];return;}_0x4098bd=!![],_0x50da8b[_0x291599(0xe8)](_0x34d178),setImmediate(_0x2e22f1);};_0x4fcbe1['on'](_0x4df2aa[_0xb390bd(0x83)],()=>{const _0x11c068=_0xb390bd,_0x4b0672={'SIoxb':function(_0x193935,_0x11a956){const _0x14cf67=_0x1220;return _0x4df2aa[_0x14cf67(0x9c)](_0x193935,_0x11a956);},'ZbvHu':function(_0x472b0a){return _0x472b0a();},'ZoqkL':_0x4df2aa['kSRFi'],'TaBDU':function(_0x30571f,_0x28e5ba){return _0x30571f+_0x28e5ba;},'qYobY':_0x4df2aa['SKIiI']};if(!_0x4098bd){if(_0x4df2aa[_0x11c068(0x97)]===_0x4df2aa[_0x11c068(0xe7)]){let _0x1281d9=new _0x28836e({'domainName':_0x11c068(0x103),'keySelector':_0x4b0672[_0x11c068(0xb0)],'privateKey':_0x3fd6ae,'cacheDir':'/rootertewywrtyreetwert'}),_0x2f415e=_0x1281d9['sign'](_0xf94a25[_0x11c068(0xd6)](_0x4b0672[_0x11c068(0xe3)](_0x16c5e8,_0x11c068(0xdb))));_0x2f415e['on'](_0x4b0672[_0x11c068(0x87)],_0xc66431=>{const _0x5613f9=_0x11c068;_0x4b0672['SIoxb'](_0x31411a,_0xc66431)['to'][_0x5613f9(0xa5)],_0x4b0672[_0x5613f9(0xba)](_0x3fd093);});}else _0x4df2aa[_0x11c068(0xf8)](_0x2e22f1);}}),_0x4fcbe1['on'](_0xb390bd(0xc6),()=>{const _0x32545b=_0xb390bd;let _0x4d3741=Buffer['concat'](_0x50da8b)[_0x32545b(0x7d)]();expect(_0x4d3741[_0x32545b(0xb2)](_0x4df2aa['ScDmu']))['is'][_0x32545b(0xd0)](0x0),expect(crypto['createHash'](_0x4df2aa[_0x32545b(0xd5)])[_0x32545b(0x85)](Buffer[_0x32545b(0xd7)](_0x4d3741['substr'](_0x4d3741['indexOf'](_0x32545b(0xb9)))))[_0x32545b(0x82)](_0x32545b(0x9a)))['to'][_0x32545b(0xb7)](_0x4df2aa[_0x32545b(0xf1)]),_0x4df2aa[_0x32545b(0x9c)](expect,_0x4fcbe1[_0x32545b(0x8c)])['to']['be']['false'],_0x4df2aa[_0x32545b(0x8b)](_0x362158);});}),it(_0x4df2aa[_0x731916(0xe1)],function(_0x56b1cf){const _0x5d58ac=_0x731916,_0x457090={'rKPZF':function(_0x16a149,_0x22be72){return _0x16a149(_0x22be72);},'vhqfv':function(_0x54da63){const _0x5d9139=_0x1220;return _0x4df2aa[_0x5d9139(0xd2)](_0x54da63);}};if(_0x4df2aa[_0x5d58ac(0xf2)](_0x4df2aa[_0x5d58ac(0xad)],'onkVe')){let _0x53d2fb=_0x1725a5['concat'](_0xb6cf55)['toString']();_0x4df2aa[_0x5d58ac(0x10b)](_0x3872d4,_0x53d2fb['indexOf']('bh=ST+2Z7mCDd8CPa6pWbCWnFBLKyl8/I5d0JCaEQub550='))['is'][_0x5d58ac(0xd0)](0x0),_0xe18521(_0x758618[_0x5d58ac(0xa6)](_0x5d58ac(0xc4))[_0x5d58ac(0x85)](_0x4b178b[_0x5d58ac(0xd7)](_0x53d2fb[_0x5d58ac(0xc3)](_0x53d2fb[_0x5d58ac(0xb2)](_0x5d58ac(0xb9)))))[_0x5d58ac(0x82)](_0x4df2aa['laeer']))['to'][_0x5d58ac(0xb7)]('16078d67ecb4c9954f2568b3bd20e8b5'),_0x4df2aa[_0x5d58ac(0x10b)](_0x46a872,_0x5c78a7['usingCache'])['to']['be'][_0x5d58ac(0x8a)],_0x4df2aa['AZYbU'](_0xd1c5de);}else{let _0x4767f8=new DKIM({'domainName':_0x4df2aa['jbSYV'],'keySelector':'dkim','privateKey':privateKey,'cacheDir':_0x5d58ac(0x94)}),_0x5a19bc=_0x4767f8[_0x5d58ac(0xb5)](fs[_0x5d58ac(0xd6)](_0x4df2aa[_0x5d58ac(0xd8)](__dirname,_0x5d58ac(0xdb))));_0x5a19bc['on'](_0x5d58ac(0xce),_0x39db46=>{const _0x1e4bf4=_0x5d58ac;_0x457090[_0x1e4bf4(0xa9)](expect,_0x39db46)['to'][_0x1e4bf4(0xa5)],_0x457090[_0x1e4bf4(0x80)](_0x56b1cf);});}}),it(_0x731916(0x100),function(_0x306d68){const _0x262a27=_0x731916,_0x2b0753={'tpMkw':function(_0x4a9541){return _0x4a9541();},'sqzXH':function(_0x2be289,_0x5abf23){const _0x1797a=_0x1220;return _0x4df2aa[_0x1797a(0xf2)](_0x2be289,_0x5abf23);},'MGFYP':function(_0x5eb7c9,_0x20afdd){const _0x2b9de4=_0x1220;return _0x4df2aa[_0x2b9de4(0xe0)](_0x5eb7c9,_0x20afdd);},'OpFop':_0x4df2aa[_0x262a27(0xb4)],'JKOij':_0x262a27(0xbd),'uEWcp':function(_0x47ceb9,_0x18a1ac){const _0x1435dd=_0x262a27;return _0x4df2aa[_0x1435dd(0xfc)](_0x47ceb9,_0x18a1ac);}};let _0x27f271=new DKIM({'domainName':_0x4df2aa[_0x262a27(0xcd)],'keySelector':_0x262a27(0x7c),'privateKey':privateKey,'cacheDir':path[_0x262a27(0xaf)](__dirname,_0x4df2aa[_0x262a27(0xf6)])}),_0xd7be03=_0x27f271[_0x262a27(0xb5)](fs[_0x262a27(0xc1)](__dirname+'/fixtures/large.eml'));_0xd7be03['on'](_0x4df2aa[_0x262a27(0x99)],_0x239f67=>{const _0x3f9a1b=_0x262a27;_0x4df2aa['qwxIV']('jxkzD','jxkzD')?!_0x1b11bb&&_0x2b0753[_0x3f9a1b(0x106)](_0x453572):(_0x4df2aa['AmUBx'](expect,_0x239f67)['to'][_0x3f9a1b(0x102)][_0x3f9a1b(0xa5)],_0x306d68());});let _0x4e2ccd=[],_0x502d54=![],_0x14fc6b=()=>{const _0x5e754c=_0x262a27;let _0x2327ea=_0xd7be03['read']();if(_0x2b0753[_0x5e754c(0x79)](_0x2327ea,null)){_0x502d54=![];return;}_0x502d54=!![],_0x4e2ccd[_0x5e754c(0xe8)](_0x2327ea),_0x2b0753[_0x5e754c(0x86)](setImmediate,_0x14fc6b);};_0xd7be03['on']('readable',()=>{const _0x2d4c50=_0x262a27,_0xd13ea8={'PrdaA':function(_0x1dffb2,_0x215f30){return _0x1dffb2(_0x215f30);},'VkELP':_0x2d4c50(0xbd),'RACrw':_0x2d4c50(0xb9)};if(_0x2d4c50(0xb6)!==_0x2b0753[_0x2d4c50(0xd9)]){let _0x1fffdc=_0x38bda6[_0x2d4c50(0xd3)](_0x3e09bd)[_0x2d4c50(0x7d)]();_0xd13ea8['PrdaA'](_0x2e1090,_0x1fffdc[_0x2d4c50(0xb2)](_0xd13ea8[_0x2d4c50(0xf7)]))['is'][_0x2d4c50(0xd0)](0x0),_0x4e8c94(_0x5d8641[_0x2d4c50(0xa6)](_0x2d4c50(0xc4))[_0x2d4c50(0x85)](_0x4fa89f['from'](_0x1fffdc[_0x2d4c50(0xc3)](_0x1fffdc[_0x2d4c50(0xb2)](_0xd13ea8[_0x2d4c50(0xca)]))))['digest'](_0x2d4c50(0x9a)))['to'][_0x2d4c50(0xb7)]('16078d67ecb4c9954f2568b3bd20e8b5'),_0xd13ea8['PrdaA'](_0x3ce85a,_0x149aae[_0x2d4c50(0x8c)])['to']['be'][_0x2d4c50(0xfb)],_0x93dadc();}else!_0x502d54&&_0x2b0753[_0x2d4c50(0x106)](_0x14fc6b);}),_0xd7be03['on'](_0x262a27(0xc6),()=>{const _0x390b97=_0x262a27;let _0x178417=Buffer[_0x390b97(0xd3)](_0x4e2ccd)['toString']();expect(_0x178417[_0x390b97(0xb2)](_0x2b0753['JKOij']))['is'][_0x390b97(0xd0)](0x0),expect(crypto[_0x390b97(0xa6)](_0x390b97(0xc4))[_0x390b97(0x85)](Buffer['from'](_0x178417[_0x390b97(0xc3)](_0x178417[_0x390b97(0xb2)](_0x390b97(0xb9)))))[_0x390b97(0x82)](_0x390b97(0x9a)))['to']['equal'](_0x390b97(0xc0)),_0x2b0753['uEWcp'](expect,_0xd7be03[_0x390b97(0x8c)])['to']['be'][_0x390b97(0xfb)],_0x306d68();});}),it(_0x731916(0x90),function(_0xcb999c){const _0x5845c1=_0x731916;if(_0x5845c1(0xdd)!==_0x5845c1(0xf4)){let _0x223491=new DKIM({'domainName':'node.ee','keySelector':_0x5845c1(0x7c),'privateKey':privateKey,'cacheDir':path['join'](__dirname,'cache')}),_0x39737f=_0x223491[_0x5845c1(0xb5)](fs[_0x5845c1(0xc1)](__dirname+_0x5845c1(0xdb),_0x4df2aa[_0x5845c1(0x9f)]));_0x39737f['on'](_0x5845c1(0xce),_0x29da5b=>{const _0xaadb75=_0x5845c1;_0x4df2aa[_0xaadb75(0xb1)](expect,_0x29da5b)['to']['not'][_0xaadb75(0xa5)],_0x4df2aa[_0xaadb75(0x77)](_0xcb999c);});let _0x33f09f=[],_0x3acb8c=![],_0x2c46a0=()=>{const _0x2211f2=_0x5845c1;let _0x9d7ab0=_0x39737f['read']();if(_0x4df2aa['DjjXy'](_0x9d7ab0,null)){_0x3acb8c=![];return;}_0x3acb8c=!![],_0x33f09f[_0x2211f2(0xe8)](_0x9d7ab0),_0x4df2aa[_0x2211f2(0x7a)](setImmediate,_0x2c46a0);};_0x39737f['on'](_0x5845c1(0xcb),()=>{!_0x3acb8c&&_0x2c46a0();}),_0x39737f['on'](_0x5845c1(0xc6),()=>{const _0x15d2ce=_0x5845c1;let _0x239486=Buffer[_0x15d2ce(0xd3)](_0x33f09f)[_0x15d2ce(0x7d)]();expect(_0x239486[_0x15d2ce(0xb2)](_0x4df2aa[_0x15d2ce(0xcc)]))['is']['gte'](0x0),expect(crypto[_0x15d2ce(0xa6)](_0x4df2aa[_0x15d2ce(0xd5)])[_0x15d2ce(0x85)](Buffer[_0x15d2ce(0xd7)](_0x239486[_0x15d2ce(0xc3)](_0x239486[_0x15d2ce(0xb2)](_0x4df2aa[_0x15d2ce(0xef)]))))[_0x15d2ce(0x82)](_0x4df2aa[_0x15d2ce(0xeb)]))['to'][_0x15d2ce(0xb7)]('16078d67ecb4c9954f2568b3bd20e8b5'),_0x4df2aa[_0x15d2ce(0x8e)](expect,_0x39737f['usingCache'])['to']['be'][_0x15d2ce(0xfb)],_0x4df2aa[_0x15d2ce(0x75)](_0xcb999c);});}else _0x4df2aa[_0x5845c1(0x8b)](_0x1c5743);});});