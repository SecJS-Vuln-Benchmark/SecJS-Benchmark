'use strict';const _0x3939be=_0x2aa8;function _0x4acc(){const _0x51b0bd=['B:\x20Y\x09\x0d\x0a\x09Z\x20\x20','SoEEE','equal','DKIM\x20Sign\x20Tests','b:Y\x20Z\x0d\x0ad:X\x0d\x0a','message-id:references','From:\x20andris@node.ee','includeStack','SsmJN','DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=node.ee;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=pVd+Dp+EjmYBcc1AWlBAP4ESpuAJ2WMS4gbxWLoeUZ1vZRodVN7K9UXvcCsLuqjJktCZMN2+8dyEUaYW2VIcxg4sVBCS1wqB/tqYZ/gxXLnG2/nZf4fyD2vxltJP4pDL','should\x20create\x20relaxed\x20headers','4337792EqWmZx','message-id','D:\x20X','expect','zqLAB','should\x20sign\x20headers','CABli','a:X\x0d\x0ab:Y\x20Z\x0d\x0a','a:b','16473897KHNysn','1786527wZaqRs','581408rXbuKd','tLjDr','WnNml','oAYiA','GQxMk','A:\x20X','replace','node.ee','-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIIBywIBAAJhANCx7ncKUfQ8wBUYmMqq6ky8rBB0NL8knBf3+uA7q/CSxpX6sQ8N\x0adFNtEeEd7gu7BWEM7+PkO1P0M78eZOvVmput8BP9R44ARpgHY4V0qSCdUt4rD32n\x0awfjlGbh8p5ua5wIDAQABAmAm+uUQpQPTu7kg95wqVqw2sxLsa9giT6M8MtxQH7Uo\x0a1TF0eAO0TQ4KOxgY1S9OT5sGPVKnag258m3qX7o5imawcuyStb68DQgAUg6xv7Af\x0aAqAEDfYN5HW6xK+X81jfOUECMQDr7XAS4PERATvgb1B3vRu5UEbuXcenHDYgdoyT\x0a3qJFViTbep4qeaflF0uF9eFveMcCMQDic10rJ8fopGD7/a45O4VJb0+lRXVdqZxJ\x0aQzAp+zVKWqDqPfX7L93SQLzOGhdd7OECMQDeQyD7WBkjSQNMy/GF7I1qxrscIxNN\x0aVqGTcbu8Lti285Hjhx/sqhHHHGwU9vB7oM8CMQDKTS3Kw/s/xrot5O+kiZwFgr+w\x0acmDrj/7jJHb+ykFNb7GaEkiSYqzUjKkfpweBDYECMFJUyzuuFJAjq3BXmGJlyykQ\x0aTweUw+zMVdSXjO+FCPcYNi6CP1t1KoESzGKBVoqA/g==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----','dkim','Message-ID:\x20<testkiri@kreata.ee>','462119iIoSZx','GrMAn','deep','40avjnzq','DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=xn--mriaad-polteism-zvbj.info;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=oBJ1MkwEkftfXa2AK4Expjp2xgIcAR43SVrftSEHVQ6F1SlGjP3EKP+cn/hLkhUel3rY0icthk/myDu6uhTBmM6DMtzIBW/7uQd6q9hfgaiYnw5Iew2tZc4TzBEYSdKi','z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=','To:andris@kreata.ee','../../lib/dkim/sign','4382331qbkzaW','chai','a:c','should\x20skip\x20specific\x20headers','OQuux','should\x20sign\x20headers\x20for\x20unicode\x20domain','DCOdt','XEPII','relaxedHeaders','sha256','60pzifbm','1050678gppqhM','ODGvz','C:\x20X','a:b:c:d'];_0x4acc=function(){return _0x51b0bd;};return _0x4acc();}function _0x2aa8(_0x2cbbdd,_0x2081d5){const _0x4accde=_0x4acc();return _0x2aa8=function(_0x2aa88e,_0x558d2b){_0x2aa88e=_0x2aa88e-0x6b;let _0x3668e3=_0x4accde[_0x2aa88e];return _0x3668e3;},_0x2aa8(_0x2cbbdd,_0x2081d5);}(function(_0x1b9961,_0x1a4d83){const _0xc2dd56=_0x2aa8,_0x12e144=_0x1b9961();while(!![]){try{const _0x2b1820=-parseInt(_0xc2dd56(0x8b))/0x1+-parseInt(_0xc2dd56(0x72))/0x2+parseInt(_0xc2dd56(0x9f))/0x3+-parseInt(_0xc2dd56(0x8c))/0x4*(-parseInt(_0xc2dd56(0x9a))/0x5)+parseInt(_0xc2dd56(0x71))/0x6*(-parseInt(_0xc2dd56(0x97))/0x7)+-parseInt(_0xc2dd56(0x81))/0x8+parseInt(_0xc2dd56(0x8a))/0x9;if(_0x2b1820===_0x1a4d83)break;else _0x12e144['push'](_0x12e144['shift']());}catch(_0x1b93e6){_0x12e144['push'](_0x12e144['shift']());}}}(_0x4acc,0xe56f6));const chai=require(_0x3939be(0xa0)),expect=chai[_0x3939be(0x84)];let sign=require(_0x3939be(0x9e));chai['config'][_0x3939be(0x7d)]=!![];const privateKey=_0x3939be(0x94);describe(_0x3939be(0x79),function(){const _0x22da86=_0x3939be,_0x55cc05={'CABli':_0x22da86(0x76),'TpBMZ':_0x22da86(0x75),'SsmJN':_0x22da86(0x88),'oAYiA':_0x22da86(0x89),'ODGvz':_0x22da86(0x74),'KDsFu':_0x22da86(0x83),'DyhmS':function(_0x50ac80,_0x50a68b){return _0x50ac80(_0x50a68b);},'zqLAB':_0x22da86(0x7a),'XEPII':'from','GrMAn':_0x22da86(0x82),'GQxMk':_0x22da86(0x96),'WnNml':_0x22da86(0x70),'SoEEE':_0x22da86(0x7b),'xiSbz':function(_0x4b8448,_0xaa79d3,_0x19ac17,_0x2b65de,_0x2f465c){return _0x4b8448(_0xaa79d3,_0x19ac17,_0x2b65de,_0x2f465c);},'OQuux':_0x22da86(0x80),'tLjDr':function(_0x543ee1,_0x824e72,_0x1d2796){return _0x543ee1(_0x824e72,_0x1d2796);},'yOYhm':_0x22da86(0xa2),'DCOdt':_0x22da86(0x86)};it(_0x55cc05[_0x22da86(0x6b)],function(){const _0x3d6c03=_0x22da86;let _0x1b6c5c=[{'key':'a','line':_0x3d6c03(0x91)},{'key':'b','line':_0x55cc05[_0x3d6c03(0x87)]}];expect(sign[_0x3d6c03(0x6f)](_0x1b6c5c,_0x55cc05['TpBMZ']))['to']['deep'][_0x3d6c03(0x78)]({'headers':_0x55cc05[_0x3d6c03(0x7e)],'fieldNames':_0x55cc05[_0x3d6c03(0x8f)]});}),_0x55cc05[_0x22da86(0x8d)](it,_0x55cc05['yOYhm'],function(){const _0x15dcb0=_0x22da86;let _0x54aae9=[{'key':'a','line':_0x15dcb0(0x91)},{'key':'b','line':_0x55cc05['CABli']},{'key':'c','line':_0x55cc05[_0x15dcb0(0x73)]},{'key':'d','line':_0x55cc05['KDsFu']}];_0x55cc05['DyhmS'](expect,sign[_0x15dcb0(0x6f)](_0x54aae9,'a:b:c:d',_0x15dcb0(0xa1)))['to'][_0x15dcb0(0x99)][_0x15dcb0(0x78)]({'headers':_0x55cc05[_0x15dcb0(0x85)],'fieldNames':'b:d'});}),_0x55cc05['tLjDr'](it,_0x55cc05[_0x22da86(0x6d)],function(){const _0xf00bce=_0x22da86;let _0x1a605a=[{'key':_0x55cc05[_0xf00bce(0x6e)],'line':_0xf00bce(0x7c)},{'key':'to','line':_0xf00bce(0x9d)},{'key':_0x55cc05[_0xf00bce(0x98)],'line':_0x55cc05[_0xf00bce(0x90)]}],_0x46d268=sign(_0x1a605a,_0x55cc05[_0xf00bce(0x8e)],_0xf00bce(0x9c),{'skipFields':_0x55cc05[_0xf00bce(0x77)],'domainName':_0xf00bce(0x93),'keySelector':_0xf00bce(0x95),'privateKey':privateKey});expect(_0x46d268[_0xf00bce(0x92)](/\r?\n\s*/g,'')[_0xf00bce(0x92)](/\s+/g,''))['to']['equal'](_0xf00bce(0x7f));}),it(_0x22da86(0x6c),function(){const _0x267185=_0x22da86;let _0x5366cb=[{'key':'from','line':_0x267185(0x7c)},{'key':'to','line':_0x267185(0x9d)}],_0x4d2e8a=_0x55cc05['xiSbz'](sign,_0x5366cb,_0x55cc05[_0x267185(0x8e)],_0x267185(0x9c),{'domainName':'müriaad-polüteism.info','keySelector':_0x267185(0x95),'privateKey':privateKey});expect(_0x4d2e8a[_0x267185(0x92)](/\r?\n\s*/g,'')[_0x267185(0x92)](/\s+/g,''))['to']['equal'](_0x267185(0x9b));});});