const _0x1e849e=_0x5a17;(function(_0x2dbee7,_0x1e1906){const _0xda8d08=_0x5a17,_0x49ccfe=_0x2dbee7();while(!![]){try{const _0x4e6c1e=-parseInt(_0xda8d08(0x1db))/0x1*(-parseInt(_0xda8d08(0x1c5))/0x2)+parseInt(_0xda8d08(0x1dc))/0x3+-parseInt(_0xda8d08(0x1fb))/0x4*(-parseInt(_0xda8d08(0x1ea))/0x5)+parseInt(_0xda8d08(0x1f8))/0x6+parseInt(_0xda8d08(0x1f4))/0x7*(parseInt(_0xda8d08(0x1e2))/0x8)+parseInt(_0xda8d08(0x1de))/0x9*(parseInt(_0xda8d08(0x1c3))/0xa)+parseInt(_0xda8d08(0x1b3))/0xb*(-parseInt(_0xda8d08(0x1cd))/0xc);if(_0x4e6c1e===_0x1e1906)break;else _0x49ccfe['push'](_0x49ccfe['shift']());}catch(_0x4a9906){_0x49ccfe['push'](_0x49ccfe['shift']());}}}(_0x3b27,0x9c690));function _0x3b27(){const _0x428bfc=['<p>it\x20has\x20been\x20<strike>1\x20day</strike>\x200\x20days\x20since\x20our\x20last\x20test\x20failure</p>','10ciPVwa','FxYwh','BYkdP','<h5\x20id=\x22heading--trout\x22>Test\x20Heading</h5>','<p><span>a</span></p>','<textarea>hullo</textarea>','vclsp','<p>1\x20+\x201\x20is\x20<del>3</del>\x20<ins>2</ins></p>','<div\x20align=\x22center\x22>hello</div>','WXhjy','7JxVtCH','lBoHm','<h3\x20id=\x22heading--dashed-name\x22>Test\x20Heading</h3>','<h1>Test\x20Heading</h1>','5338500xBPUpB','https://www.google.com/maps/embed?|https://www.openstreetmap.org/export/embed.html?','<div><p\x20class=\x22funky\x22\x20wrong=\x271\x27>hello</p></div>','2333996eZheSy','hello','<span\x20class=\x22fa\x20fa-spin\x20-bbcode-s\x22>a</span>','Unit\x20|\x20Utility\x20|\x20sanitizer','allows\x20protocol\x20relative\x20urls','<p><i></i></p>','KYycW','1\x20+\x201\x20is\x20<del>3</del>\x20<ins>2</ins>','<h4\x20id=\x22heading--underscored_name\x22>Test\x20Heading</h4>','<div\x20dir=\x22rtl\x22>RTL\x20text</div>','wWoIP','BnBzH','<blockquote>a\x0a</blockquote>','https://eviltrout.com/evil/trout','XtONg','<center>hello</center>','NlKsW','<dl><dt>Forum</dt><dd>Software</dd></dl>','LptvR','&lt;_&lt;','UVfIt','<i\x20class=\x22fa-bug\x20fa-spin\x22>bug</i>','<progress>hello','jLXvI','<h6\x20id=\x22heading--discourse\x22>Test\x20Heading</h6>','<span\x20class=\x22-bbcode-s\x20fa\x20fa-spin\x22>a</span>','wLDfU','<div><p>hello</p></div>','<kbd>Ctrl</kbd>+<kbd>C</kbd>','replace','/foo/bar.html','http://google.com/test%27onmouseover=alert(%27XSS!%27);//.swf','//eviltrout.com/evil/trout','<button>press\x20me!</button>','aBokL','dHrDm','<div><script>alert(\x27hi\x27);</script></div>','sanitize','allows\x20full\x20urls','OfeKc','<div></div>','<i>bug</i>','allows\x20https\x20urls','xSYKa','<span\x20class=\x22bbcode-s\x22>a</span>','xWScq','allows\x20relative\x20urls','XzuGu','ABKBz','Xhbgr','it\x20sanitizes\x20spans','ypRyA','http://google.com/test\x27onmouseover=alert(\x27XSS!\x27);//.swf','<i\x20class=\x22fa\x20fa-bug\x20fa-spin\x22\x20style=\x22font-size:600%\x22></i>\x0a<!--\x20-->','http://eviltrout.com/evil/trout','<h2\x20id=\x22heading--cool\x22>Test\x20Heading</h2>','21392503fJqZVu','<h1\x20id=\x22heading--\x22>Test\x20Heading</h1>','pufoA','<h1\x20id=\x22heading--test\x22>Test\x20Heading</h1>','Esmpy','vhzwa','nYjIx','<p><abbr\x20title=\x22JavaScript\x22>JS</abbr></p>','match','<p><span\x20class=\x22bbcode-s\x22>a</span></p>','sfIII','lQJzP','NpKff','<h3>Test\x20Heading</h3>','<canvas>draw\x20me!</canvas>','hullo','100IYPtEY','it\x20has\x20been\x20<s>1\x20day</s>\x200\x20days\x20since\x20our\x20last\x20test\x20failure','2fGXAHU','<h1\x20id=\x22test-heading--cool\x22>Test\x20Heading</h1>','hello<script>alert(42)</script>','<blockquote>a\x0a</blockquote>\x0a','<sup>high</sup>\x20<sub>low</sub>\x20<big>HUGE</big>','<p>Hey</p><video\x20autoplay><source\x20src=\x22http://example.com/music.mp4\x22\x20type=\x22audio/mpeg\x22></video>','OOaUN','press\x20me!','24ryUrBF','TjjrC','<iframe\x20src=\x22http://discourse.org\x22\x20width=\x22100\x22\x20height=\x2242\x22></iframe>','CXozg','MWcIP','CVoEv','&lt;3\x20&lt;3','fljZn','pgGne','<p>Hey</p><video\x20autoplay\x20muted><source\x20src=\x22http://example.com/music.mp4\x22\x20type=\x22audio/mpeg\x22></video>','equal','<h1\x20id=\x22heading--with\x20space\x22>Test\x20Heading</h1>','it\x20allows\x20iframe\x20to\x20google\x20maps','it\x20does\x20not\x20allow\x20centering','195472HmLJfH','3492228ZVBVPU','<iframe\x20src=\x22https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d2624.9983685732213!2d2.29432085!3d48.85824149999999!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1385737436368\x22\x20width=\x22100\x22\x20height=\x2242\x22></iframe>','369531fjqFpq','<h1\x20id=\x22heading--with*char\x22>Test\x20Heading</h1>','YDUUU','it\x20does\x20not\x20double\x20sanitize','5626528gGLEAG','hLWFw','BXIrL','cook','<p><sup>high</sup>\x20<sub>low</sub>\x20<big>HUGE</big></p>','<iframe\x20width=\x22425\x22\x20height=\x22350\x22\x20frameborder=\x220\x22\x20marginheight=\x220\x22\x20marginwidth=\x220\x22\x20src=\x22https://www.openstreetmap.org/export/embed.html?bbox=22.49454975128174%2C51.220338322410775%2C22.523088455200195%2C51.23345342732931&amp;layer=mapnik\x22></iframe>','autoplay\x20videos\x20must\x20be\x20muted'];_0x3b27=function(){return _0x428bfc;};return _0x3b27();}function _0x5a17(_0x54de2e,_0x340321){const _0x3b2794=_0x3b27();return _0x5a17=function(_0x5a17bc,_0x26d33a){_0x5a17bc=_0x5a17bc-0x192;let _0x4ab86f=_0x3b2794[_0x5a17bc];return _0x4ab86f;},_0x5a17(_0x54de2e,_0x340321);}import _0x186ea9,{buildOptions}from'pretty-text/pretty-text';import{module,test}from'qunit';import{hrefAllowed}from'pretty-text/sanitizer';module(_0x1e849e(0x1fe),function(){const _0x21a5f3=_0x1e849e,_0x4ca37b={'XtONg':function(_0x48c624,_0x435ab5){return _0x48c624(_0x435ab5);},'zyNaH':_0x21a5f3(0x1f9),'dHrDm':_0x21a5f3(0x210),'vhzwa':_0x21a5f3(0x19f),'gIWch':_0x21a5f3(0x1a3),'biqaW':_0x21a5f3(0x1fa),'jLXvI':_0x21a5f3(0x196),'TjjrC':'<3\x20<3','Xhbgr':'<_<','OfeKc':function(_0x16efc4,_0x16af64,_0x5472d2,_0x492429){return _0x16efc4(_0x16af64,_0x5472d2,_0x492429);},'Esmpy':'<p>hello</p>','xSYKa':'<a\x20href=\x27http://disneyland.disney.go.com/\x27>disney</a>\x20<a\x20href=\x27http://reddit.com\x27>reddit</a>','wLDfU':'<p><a\x20href=\x22http://disneyland.disney.go.com/\x22>disney</a>\x20<a\x20href=\x22http://reddit.com\x22>reddit</a></p>','ABKBz':function(_0x151bb1,_0x2ca6e2,_0xff23d5,_0xc4a57f){return _0x151bb1(_0x2ca6e2,_0xff23d5,_0xc4a57f);},'pgGne':_0x21a5f3(0x1da),'nYjIx':_0x21a5f3(0x1c8),'pufoA':_0x21a5f3(0x207),'wWoIP':function(_0x29d9cc,_0x29cf5e,_0x387d23,_0x1ab54b){return _0x29d9cc(_0x29cf5e,_0x387d23,_0x1ab54b);},'NlKsW':'<iframe\x20src=\x22https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d2624.9983685732213!2d2.29432085!3d48.85824149999999!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1385737436368\x22\x20width=\x22100\x22\x20height=\x2242\x22></iframe>','BXIrL':_0x21a5f3(0x1d9),'OOaUN':_0x21a5f3(0x1e7),'MWcIP':_0x21a5f3(0x1c2),'FxYwh':_0x21a5f3(0x1cc),'KYycW':'draw\x20me!','fljZn':'<p>[the\x20answer](javascript:alert(42))</p>','aBokL':'it\x20doesn\x27t\x20circumvent\x20XSS\x20with\x20comments','xIFcE':_0x21a5f3(0x194),'XzuGu':'<p><span>a</span></p>','tqqhG':_0x21a5f3(0x1ad),'sfIII':function(_0x3382cb,_0x861614,_0x1373d7,_0x50c244){return _0x3382cb(_0x861614,_0x1373d7,_0x50c244);},'odNrS':_0x21a5f3(0x1a7),'BnBzH':function(_0x353cbe,_0x565492,_0x22c7f0){return _0x353cbe(_0x565492,_0x22c7f0);},'lQJzP':_0x21a5f3(0x197),'hLWFw':function(_0x5c9a7d,_0x17d273,_0x382f0d){return _0x5c9a7d(_0x17d273,_0x382f0d);},'NpKff':_0x21a5f3(0x1e9),'CVoEv':function(_0x5bf1c5,_0x1b594a,_0x514969){return _0x5bf1c5(_0x1b594a,_0x514969);},'lBoHm':function(_0x2f2b44,_0xb3c885,_0x1de205){return _0x2f2b44(_0xb3c885,_0x1de205);},'xWScq':function(_0x360632,_0x49c68c,_0x123221){return _0x360632(_0x49c68c,_0x123221);},'WXhjy':_0x21a5f3(0x1c0),'hAGdi':_0x21a5f3(0x1a9),'LptvR':function(_0x3a2fb6,_0x5280d1,_0x22f47d){return _0x3a2fb6(_0x5280d1,_0x22f47d);},'vclsp':_0x21a5f3(0x1a1),'YDUUU':function(_0x54afa0,_0x4edced){return _0x54afa0(_0x4edced);},'LOmoY':_0x21a5f3(0x19a),'ypRyA':_0x21a5f3(0x1a0),'UVfIt':function(_0x417791,_0x4d45fc,_0x2e5753){return _0x417791(_0x4d45fc,_0x2e5753);},'BYkdP':'poorly\x20formed\x20ids\x20on\x20headings','CXozg':'urlAllowed'};test(_0x4ca37b[_0x21a5f3(0x1ae)],function(_0x5f43b5){const _0x455554=_0x21a5f3,_0x45e7ed=new _0x186ea9(_0x4ca37b[_0x455554(0x209)](buildOptions,{'siteSettings':{'allowed_iframes':_0x4ca37b['zyNaH']}})),_0x50c08d=(_0x3063a1,_0x2502f9,_0x5b37b9)=>_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1e5)](_0x3063a1),_0x2502f9[_0x455554(0x198)](/\/>/g,'>'),_0x5b37b9);_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed['sanitize'](_0x4ca37b[_0x455554(0x19e)]),_0x455554(0x1a4)),_0x5f43b5['equal'](_0x45e7ed[_0x455554(0x1a0)](_0x4ca37b[_0x455554(0x1b8)]),_0x4ca37b['gIWch']),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x4ca37b['biqaW']),_0x4ca37b[_0x455554(0x192)]),_0x5f43b5['equal'](_0x45e7ed[_0x455554(0x1a0)](_0x4ca37b[_0x455554(0x1ce)]),_0x455554(0x1d3)),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x4ca37b[_0x455554(0x1ac)]),_0x455554(0x20e)),_0x4ca37b[_0x455554(0x1a2)](_0x50c08d,_0x455554(0x1c7),_0x4ca37b[_0x455554(0x1b7)],'it\x20sanitizes\x20while\x20cooking'),_0x50c08d(_0x4ca37b[_0x455554(0x1a6)],_0x4ca37b[_0x455554(0x195)],'we\x20can\x20embed\x20proper\x20links'),_0x4ca37b[_0x455554(0x1ab)](_0x50c08d,_0x455554(0x20a),_0x455554(0x1fc),_0x4ca37b[_0x455554(0x1d5)]),_0x4ca37b[_0x455554(0x1ab)](_0x50c08d,_0x4ca37b[_0x455554(0x1b9)],_0x4ca37b[_0x455554(0x1b5)],_0x455554(0x1e1)),_0x50c08d(_0x455554(0x1cf),'','it\x20does\x20not\x20allow\x20most\x20iframes'),_0x4ca37b[_0x455554(0x205)](_0x50c08d,_0x455554(0x1dd),_0x4ca37b[_0x455554(0x20b)],_0x4ca37b[_0x455554(0x1e4)]),_0x50c08d(_0x4ca37b[_0x455554(0x1cb)],_0x455554(0x1e7),'it\x20allows\x20iframe\x20to\x20OpenStreetMap'),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x455554(0x1ef)),_0x4ca37b[_0x455554(0x1d1)]),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x455554(0x19c)),_0x4ca37b[_0x455554(0x1eb)]),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x455554(0x1c1)),_0x4ca37b[_0x455554(0x201)]),_0x5f43b5[_0x455554(0x1d7)](_0x45e7ed[_0x455554(0x1a0)](_0x455554(0x211)),_0x455554(0x1fc)),_0x4ca37b['OfeKc'](_0x50c08d,'[the\x20answer](javascript:alert(42))',_0x4ca37b[_0x455554(0x1d4)],'it\x20prevents\x20XSS'),_0x4ca37b[_0x455554(0x1ab)](_0x50c08d,_0x455554(0x1b0),_0x455554(0x200),_0x4ca37b[_0x455554(0x19d)]),_0x50c08d(_0x4ca37b['xIFcE'],_0x4ca37b[_0x455554(0x1aa)],_0x455554(0x1ad)),_0x4ca37b['wWoIP'](_0x50c08d,_0x455554(0x1fd),_0x455554(0x1ee),_0x4ca37b['tqqhG']),_0x4ca37b[_0x455554(0x1bd)](_0x50c08d,_0x4ca37b['odNrS'],_0x455554(0x1bc),'it\x20sanitizes\x20spans'),_0x4ca37b[_0x455554(0x206)](_0x50c08d,_0x4ca37b[_0x455554(0x1be)],'<p><kbd>Ctrl</kbd>+<kbd>C</kbd></p>'),_0x4ca37b['hLWFw'](_0x50c08d,'it\x20has\x20been\x20<strike>1\x20day</strike>\x200\x20days\x20since\x20our\x20last\x20test\x20failure',_0x4ca37b[_0x455554(0x1bf)]),_0x50c08d(_0x455554(0x1c4),'<p>it\x20has\x20been\x20<s>1\x20day</s>\x200\x20days\x20since\x20our\x20last\x20test\x20failure</p>'),_0x4ca37b[_0x455554(0x1d2)](_0x50c08d,_0x455554(0x1f2),_0x455554(0x1f2)),_0x4ca37b['BnBzH'](_0x50c08d,_0x455554(0x202),_0x455554(0x1f1)),_0x4ca37b[_0x455554(0x1f5)](_0x50c08d,'<abbr\x20title=\x22JavaScript\x22>JS</abbr>',_0x455554(0x1ba)),_0x50c08d(_0x455554(0x20c),_0x455554(0x20c)),_0x4ca37b[_0x455554(0x1a8)](_0x50c08d,_0x455554(0x1c9),_0x455554(0x1e6)),_0x4ca37b['CVoEv'](_0x50c08d,'<div\x20dir=\x22rtl\x22>RTL\x20text</div>',_0x455554(0x204));}),_0x4ca37b[_0x21a5f3(0x20f)](test,'ids\x20on\x20headings',function(_0x2333a1){const _0x32f9e1=_0x21a5f3,_0x39ed64=new _0x186ea9(_0x4ca37b['XtONg'](buildOptions,{'siteSettings':{}}));_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64[_0x32f9e1(0x1a0)](_0x4ca37b[_0x32f9e1(0x1f3)]),'<h3>Test\x20Heading</h3>'),_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64['sanitize'](_0x32f9e1(0x1b6)),_0x32f9e1(0x1b6)),_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64[_0x32f9e1(0x1a0)](_0x32f9e1(0x1b2)),'<h2\x20id=\x22heading--cool\x22>Test\x20Heading</h2>'),_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64[_0x32f9e1(0x1a0)]('<h3\x20id=\x22heading--dashed-name\x22>Test\x20Heading</h3>'),_0x32f9e1(0x1f6)),_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64[_0x32f9e1(0x1a0)](_0x32f9e1(0x203)),'<h4\x20id=\x22heading--underscored_name\x22>Test\x20Heading</h4>'),_0x2333a1['equal'](_0x39ed64[_0x32f9e1(0x1a0)](_0x32f9e1(0x1ed)),'<h5\x20id=\x22heading--trout\x22>Test\x20Heading</h5>'),_0x2333a1[_0x32f9e1(0x1d7)](_0x39ed64['sanitize'](_0x32f9e1(0x193)),_0x32f9e1(0x193));}),_0x4ca37b[_0x21a5f3(0x1e3)](test,_0x21a5f3(0x1e8),function(_0x408219){const _0x3b4398=_0x21a5f3;let _0x3d6626=new _0x186ea9(buildOptions({'siteSettings':{}}));_0x408219['ok'](_0x3d6626[_0x3b4398(0x1a0)]('<p>Hey</p><video\x20autoplay\x20src=\x22http://example.com/music.mp4\x22/>')[_0x3b4398(0x1bb)](/muted/)),_0x408219['ok'](_0x3d6626[_0x3b4398(0x1a0)](_0x3b4398(0x1ca))[_0x3b4398(0x1bb)](/muted/)),_0x408219['ok'](_0x3d6626[_0x3b4398(0x1a0)](_0x3b4398(0x1d6))[_0x3b4398(0x1bb)](/muted/)),_0x408219['notOk'](_0x3d6626['sanitize']('<p>Hey</p><video><source\x20src=\x22http://example.com/music.mp4\x22\x20type=\x22audio/mpeg\x22></video>')[_0x3b4398(0x1bb)](/muted/));}),test(_0x4ca37b[_0x21a5f3(0x1ec)],function(_0xb6bfba){const _0x42a141=_0x21a5f3;let _0x56ff3e=new _0x186ea9(buildOptions({'siteSettings':{}}));_0xb6bfba['equal'](_0x56ff3e[_0x42a141(0x1a0)]('<h1\x20id=\x22evil-trout\x22>Test\x20Heading</h1>'),_0x42a141(0x1f7)),_0xb6bfba[_0x42a141(0x1d7)](_0x56ff3e['sanitize'](_0x42a141(0x1b4)),_0x42a141(0x1f7)),_0xb6bfba[_0x42a141(0x1d7)](_0x56ff3e[_0x42a141(0x1a0)](_0x42a141(0x1d8)),_0x42a141(0x1f7)),_0xb6bfba[_0x42a141(0x1d7)](_0x56ff3e[_0x42a141(0x1a0)](_0x42a141(0x1df)),_0x42a141(0x1f7)),_0xb6bfba[_0x42a141(0x1d7)](_0x56ff3e[_0x42a141(0x1a0)](_0x42a141(0x1b4)),_0x42a141(0x1f7)),_0xb6bfba[_0x42a141(0x1d7)](_0x56ff3e['sanitize'](_0x42a141(0x1c6)),_0x42a141(0x1f7));}),test(_0x4ca37b[_0x21a5f3(0x1d0)],function(_0xda05e7){const _0xf41973=_0x21a5f3,_0x503308=(_0x18402e,_0x5b2a84)=>_0xda05e7['equal'](hrefAllowed(_0x18402e),_0x18402e,_0x5b2a84);_0x4ca37b[_0xf41973(0x1e3)](_0x503308,_0xf41973(0x199),_0x4ca37b['hAGdi']),_0x4ca37b[_0xf41973(0x20d)](_0x503308,_0xf41973(0x1b1),_0x4ca37b[_0xf41973(0x1f0)]),_0x503308(_0xf41973(0x208),_0xf41973(0x1a5)),_0x4ca37b[_0xf41973(0x1d2)](_0x503308,_0xf41973(0x19b),_0xf41973(0x1ff)),_0xda05e7['equal'](_0x4ca37b[_0xf41973(0x1e0)](hrefAllowed,_0xf41973(0x1af)),_0x4ca37b['LOmoY'],'escape\x20single\x20quotes');});});