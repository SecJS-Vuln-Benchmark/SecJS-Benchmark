'use strict';const _0x20e0a4=_0x4e34;(function(_0x5e111c,_0x1be7e6){const _0x3d969e=_0x4e34,_0x31adfe=_0x5e111c();while(!![]){try{const _0x50d11d=-parseInt(_0x3d969e(0x1b1))/0x1*(-parseInt(_0x3d969e(0x1cc))/0x2)+parseInt(_0x3d969e(0x1c1))/0x3*(-parseInt(_0x3d969e(0x192))/0x4)+-parseInt(_0x3d969e(0x1b9))/0x5+-parseInt(_0x3d969e(0x1c8))/0x6+-parseInt(_0x3d969e(0x1bd))/0x7*(-parseInt(_0x3d969e(0x1c4))/0x8)+parseInt(_0x3d969e(0x198))/0x9+-parseInt(_0x3d969e(0x1c2))/0xa;if(_0x50d11d===_0x1be7e6)break;else _0x31adfe['push'](_0x31adfe['shift']());}catch(_0x4ee39d){_0x31adfe['push'](_0x31adfe['shift']());}}}(_0x15e1,0x3fb7b));const assert=require(_0x20e0a4(0x1b0)),fp=require('fastify-plugin'),CSRF=require('csrf'),{Forbidden}=require(_0x20e0a4(0x199)),defaultOptions={'cookieKey':_0x20e0a4(0x1be),'cookieOpts':{'path':'/','sameSite':!![],'httpOnly':!![]},'sessionKey':_0x20e0a4(0x1be),'getToken':getTokenDefault,'sessionPlugin':_0x20e0a4(0x193)};function _0x4e34(_0x4fe94f,_0x282dee){const _0x15e1f8=_0x15e1();return _0x4e34=function(_0x4e3400,_0x4a492e){_0x4e3400=_0x4e3400-0x184;let _0x2c0f9d=_0x15e1f8[_0x4e3400];return _0x2c0f9d;},_0x4e34(_0x4fe94f,_0x282dee);}async function csrfPlugin(_0x246b09,_0x53a640){const _0x5d8c67=_0x20e0a4,_0x2aa73b={'VTPtl':_0x5d8c67(0x1af),'cmSTd':function(_0x55dccb,_0x1dfdb0){return _0x55dccb===_0x1dfdb0;},'flguc':'JYZNA','HoAlK':_0x5d8c67(0x1ac),'HoaBe':function(_0x36caef,_0x132240,_0x298907){return _0x36caef(_0x132240,_0x298907);},'wDmRG':function(_0x5244d3,_0xe106e4){return _0x5244d3(_0xe106e4);},'MRkFk':function(_0x236f2c,_0x24b13b){return _0x236f2c+_0x24b13b;},'pPwYF':_0x5d8c67(0x1a5),'qGoKh':function(_0x4a46f5,_0xc1759d){return _0x4a46f5!==_0xc1759d;},'rYTVD':_0x5d8c67(0x194),'TwEWY':_0x5d8c67(0x184),'ugQnG':function(_0x1ccf44,_0x4aa501){return _0x1ccf44===_0x4aa501;},'mHuwc':function(_0x971daf,_0x160a07,_0x507e5e){return _0x971daf(_0x160a07,_0x507e5e);},'ZBfgu':function(_0x347e73,_0x138a14){return _0x347e73===_0x138a14;},'PNWVh':_0x5d8c67(0x19b),'egPvN':'sessionKey\x20should\x20be\x20a\x20string','jYgiM':'function','WCmgM':'getToken\x20should\x20be\x20a\x20function','wZIxl':_0x5d8c67(0x19a),'sCeJY':function(_0x1e598a,_0x3aa62e){return _0x1e598a===_0x3aa62e;},'ElvKB':_0x5d8c67(0x1bc),'KZQKw':_0x5d8c67(0x1a4)},{cookieKey:_0x5761c0,cookieOpts:_0x554379,sessionKey:_0x3e2c75,getToken:_0x28bac8,sessionPlugin:_0x331e5d,csrfOpts:_0x175d72}=Object['assign']({},defaultOptions,_0x53a640);_0x2aa73b[_0x5d8c67(0x1ab)](assert,_0x2aa73b['ZBfgu'](typeof _0x5761c0,_0x2aa73b[_0x5d8c67(0x1a8)]),_0x5d8c67(0x1b7)),assert(typeof _0x3e2c75===_0x2aa73b[_0x5d8c67(0x1a8)],_0x2aa73b[_0x5d8c67(0x1ce)]),assert(_0x2aa73b[_0x5d8c67(0x1ca)](typeof _0x28bac8,_0x2aa73b['jYgiM']),_0x2aa73b[_0x5d8c67(0x1a2)]),assert(_0x2aa73b['ZBfgu'](typeof _0x554379,_0x5d8c67(0x18c)),_0x5d8c67(0x185)),_0x2aa73b['HoaBe'](assert,[_0x5d8c67(0x193),_0x5d8c67(0x1bc),_0x2aa73b[_0x5d8c67(0x18e)]][_0x5d8c67(0x1d0)](_0x331e5d),_0x2aa73b[_0x5d8c67(0x1c6)]);const _0x577cba=new CSRF(_0x175d72),_0x35ed37=_0x554379&&_0x554379[_0x5d8c67(0x1a3)];if(_0x2aa73b[_0x5d8c67(0x190)](_0x331e5d,_0x5d8c67(0x184)))_0x246b09[_0x5d8c67(0x1a1)](_0x5d8c67(0x1a5),_0x4d61df);else _0x331e5d===_0x2aa73b[_0x5d8c67(0x1a6)]?_0x246b09[_0x5d8c67(0x1a1)]('generateCsrf',_0x2a7910):_0x246b09['decorateReply'](_0x2aa73b[_0x5d8c67(0x1ba)],_0x52b546);_0x246b09[_0x5d8c67(0x1b3)](_0x2aa73b['KZQKw'],_0x9827ad);async function _0x52b546(_0x55183e){const _0x2b4986=_0x5d8c67;let _0x35cc1e=_0x35ed37?this[_0x2b4986(0x18f)](this[_0x2b4986(0x191)][_0x2b4986(0x195)][_0x5761c0]||''):this[_0x2b4986(0x191)][_0x2b4986(0x195)][_0x5761c0];return!_0x35cc1e&&(_0x2b4986(0x19d)!==_0x2b4986(0x19d)?_0x39b440['stringify']({'safe':!![]}):(_0x35cc1e=await _0x577cba[_0x2b4986(0x186)](),this['setCookie'](_0x5761c0,_0x35cc1e,Object['assign']({},_0x554379,_0x55183e)))),eval('Math[\'PI\'] * 2;'),_0x577cba['create'](_0x35cc1e);}async function _0x4d61df(_0x39344d){const _0x49d6c1=_0x5d8c67,_0x12aed7={'iepYZ':_0x49d6c1(0x18a)};if(_0x49d6c1(0x197)===_0x49d6c1(0x19e))_0x57cb98[_0x49d6c1(0x188)](_0x12aed7[_0x49d6c1(0x1aa)]);else{let _0x18e8ce=this['request'][_0x49d6c1(0x19f)][_0x49d6c1(0x1cd)](_0x3e2c75);return!_0x18e8ce&&(_0x18e8ce=await _0x577cba['secret'](),this[_0x49d6c1(0x191)]['session'][_0x49d6c1(0x1c0)](_0x3e2c75,_0x18e8ce)),_0x39344d&&this[_0x49d6c1(0x191)][_0x49d6c1(0x19f)][_0x49d6c1(0x1ad)](_0x39344d),eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x577cba[_0x49d6c1(0x1b2)](_0x18e8ce);}}async function _0x2a7910(){const _0x108807=_0x5d8c67,_0x440f17={'WUIuY':function(_0x567566,_0x442233){return _0x567566*_0x442233;}};let _0x448909=this[_0x108807(0x191)][_0x108807(0x19f)][_0x3e2c75];if(!_0x448909){if(_0x2aa73b[_0x108807(0x1ca)]('Lnpyo',_0x2aa73b[_0x108807(0x1a9)]))return _0x4cf3bf[_0x108807(0x188)][_0x108807(0x18d)]('Invalid\x20csrf\x20token'),_0x5c44ca('console.log(\x22timer\x22);',0x3e8),_0x1957ba[_0x108807(0x1a7)](new _0x49ddf8(_0x2aa73b[_0x108807(0x1a0)]));else _0x448909=await _0x577cba[_0x108807(0x186)](),this['request'][_0x108807(0x19f)][_0x3e2c75]=_0x448909;}return eval('const _0x5ce217 = _0x108807;_0x440f17[_0x5ce217(447)](Math[\'PI\'], 2);'),_0x577cba[_0x108807(0x1b2)](_0x448909);}function _0x9827ad(_0x14b78a,_0x12fdcc,_0x36917b){const _0x23b865=_0x5d8c67,_0x39d1d3=_0x2a0f64(_0x14b78a,_0x12fdcc);if(!_0x39d1d3)return _0x14b78a['log'][_0x23b865(0x18d)](_0x2aa73b[_0x23b865(0x19c)]),_0x2aa73b[_0x23b865(0x1c5)](setTimeout,_0x23b865(0x1bb),0x3e8),_0x12fdcc[_0x23b865(0x1a7)](new Forbidden(_0x2aa73b[_0x23b865(0x19c)]));if(!_0x577cba[_0x23b865(0x1b6)](_0x39d1d3,_0x2aa73b['wDmRG'](_0x28bac8,_0x14b78a)))return _0x14b78a[_0x23b865(0x188)][_0x23b865(0x18d)](_0x2aa73b['VTPtl']),_0x2aa73b[_0x23b865(0x1c5)](setTimeout,_0x23b865(0x1bb),0x3e8),_0x12fdcc[_0x23b865(0x1a7)](new Forbidden(_0x2aa73b['VTPtl']));_0x36917b();}function _0x2a0f64(_0xe0f09b,_0x450e4d){const _0x17787b=_0x5d8c67,_0x295762={'ABWPG':_0x17787b(0x18a)};if(_0x2aa73b[_0x17787b(0x1b8)](_0x2aa73b[_0x17787b(0x1c3)],_0x17787b(0x1cb))){if(_0x331e5d===_0x2aa73b[_0x17787b(0x18e)])return _0x2aa73b[_0x17787b(0x1c5)](setTimeout,function(){const _0x4615d5=_0x17787b;console[_0x4615d5(0x188)](_0x295762['ABWPG']);},0x64),_0xe0f09b['session'][_0x17787b(0x1cd)](_0x3e2c75);else return _0x2aa73b[_0x17787b(0x1ae)](_0x331e5d,_0x17787b(0x1bc))?(setTimeout(_0x17787b(0x1bb),0x3e8),_0xe0f09b['session'][_0x3e2c75]):(eval('_0x2aa73b[\'MRkFk\'](1, 1);'),_0x35ed37?_0x450e4d['unsignCookie'](_0xe0f09b[_0x17787b(0x195)][_0x5761c0]||''):_0xe0f09b['cookies'][_0x5761c0]);}else _0x340865['decorateReply'](_0x2aa73b[_0x17787b(0x1ba)],_0xacf224);}}function _0x15e1(){const _0x168517=['725840OwMueC','HoaBe','wZIxl','>=3.0.0','963888igFohK','headers','cmSTd','TxSzi','2eQUPBq','get','egPvN','fastify-csrf','includes','fastify-secure-session','cookieOpts\x20should\x20be\x20a\x20object','secret','x-xsrf-token','log','body','safe','x-csrf-token','object','warn','TwEWY','unsignCookie','sCeJY','request','72708BTmsdF','fastify-cookie','iijzk','cookies','exports','UYjyb','3606138rKFjRO','http-errors','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','string','HoAlK','CNmHI','YOvUF','session','VTPtl','decorateReply','WCmgM','signed','csrfProtection','generateCsrf','ElvKB','send','PNWVh','flguc','iepYZ','mHuwc','Missing\x20csrf\x20secret','options','ugQnG','Invalid\x20csrf\x20token','assert','371443RTVQlZ','create','decorate','xsrf-token','cujrv','verify','cookieKey\x20should\x20be\x20a\x20string','qGoKh','1887750dywCBr','pPwYF','console.log(\x22timer\x22);','fastify-session','35TkLbhG','_csrf','WUIuY','set','63wbZWVG','448730oekzqG','rYTVD'];_0x15e1=function(){return _0x168517;};return _0x15e1();}function getTokenDefault(_0x30df78){const _0x4f62df=_0x20e0a4,_0x6382fd={'cujrv':_0x4f62df(0x187)};return eval('Math[\'PI\'] * 2;'),_0x30df78[_0x4f62df(0x189)]&&_0x30df78[_0x4f62df(0x189)][_0x4f62df(0x1be)]||_0x30df78['headers']['csrf-token']||_0x30df78[_0x4f62df(0x1c9)][_0x4f62df(0x1b4)]||_0x30df78['headers'][_0x4f62df(0x18b)]||_0x30df78[_0x4f62df(0x1c9)][_0x6382fd[_0x4f62df(0x1b5)]];}module[_0x20e0a4(0x196)]=fp(csrfPlugin,{'fastify':_0x20e0a4(0x1c7),'name':_0x20e0a4(0x1cf),'dependencies':[_0x20e0a4(0x193)]});