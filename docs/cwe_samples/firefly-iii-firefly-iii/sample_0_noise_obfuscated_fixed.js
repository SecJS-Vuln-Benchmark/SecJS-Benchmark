'use strict';const _0x5038f3=_0xfcda;(function(_0x2aa98b,_0x3c6687){const _0x97fef=_0xfcda,_0x36fe67=_0x2aa98b();while(!![]){try{const _0x51c1f0=parseInt(_0x97fef(0x14a))/0x1*(-parseInt(_0x97fef(0x191))/0x2)+-parseInt(_0x97fef(0x186))/0x3*(-parseInt(_0x97fef(0x179))/0x4)+-parseInt(_0x97fef(0x157))/0x5+parseInt(_0x97fef(0x154))/0x6+parseInt(_0x97fef(0x17f))/0x7+parseInt(_0x97fef(0x17d))/0x8+-parseInt(_0x97fef(0x15c))/0x9*(parseInt(_0x97fef(0x176))/0xa);if(_0x51c1f0===_0x3c6687)break;else _0x36fe67['push'](_0x36fe67['shift']());}catch(_0x40b0b7){_0x36fe67['push'](_0x36fe67['shift']());}}}(_0x34e5,0x90e62));function _0x34e5(){const _0x42ce24=['158852bHbeRF','Missing\x20csrf\x20secret','object','fastify-session','x-xsrf-token','send','csrf','secret','getToken\x20should\x20be\x20a\x20function','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','4399434PZMvwe','cookies','generateCsrf','1855295qmjLcy','stringify','exports','request','setCookie','261whBxIr','x-csrf-token','includes','decorateReply','AmxXw','LREhu','fastify-plugin','verify','options','TykYC','string','create','var\x20x\x20=\x2042;\x20return\x20x;','http-errors','headers','function','qffSA','_csrf','fastify-secure-session','xaPcN','MQrbE','cookieKey\x20should\x20be\x20a\x20string','body','csrf-token','mGbgK','log','7660uaLLMH','signed','>=3.0.0','132TCgNAB','assert','get','return\x20new\x20Date();','1600936UsooLI','dyaDn','4427962yLBAQt','unsignCookie','VMrGs','Invalid\x20csrf\x20token','lduRd','session','mDhOr','5115AKIarM','csrfProtection','zWzbq','cookieOpts\x20should\x20be\x20a\x20object','UISQo','console.log(\x22timer\x22);','fastify-csrf','QltlS','return\x20await\x20Promise.resolve(42);','assign','UcGYQ','8ylRSjN','decorate','fastify-cookie'];_0x34e5=function(){return _0x42ce24;};return _0x34e5();}const assert=require(_0x5038f3(0x17a)),fp=require(_0x5038f3(0x162)),CSRF=require(_0x5038f3(0x150)),{Forbidden}=require(_0x5038f3(0x169)),defaultOptions={'cookieKey':'_csrf','cookieOpts':{'path':'/','sameSite':!![]},'sessionKey':_0x5038f3(0x16d),'getToken':getTokenDefault,'sessionPlugin':_0x5038f3(0x149)};async function csrfPlugin(_0x49803e,_0x1d2fb2){const _0x57f8e8=_0x5038f3,_0xb0e29c={'TykYC':function(_0x40472a,_0x22245b,_0x3039ca){return _0x40472a(_0x22245b,_0x3039ca);},'FyMHn':_0x57f8e8(0x18b),'AmxXw':function(_0x121fe1,_0x278e63){return _0x121fe1!==_0x278e63;},'BLQWk':function(_0x188919,_0x5ac23e){return _0x188919(_0x5ac23e);},'UISQo':_0x57f8e8(0x17c),'mDhOr':function(_0x5c7f3f,_0x2065f0){return _0x5c7f3f+_0x2065f0;},'dyaDn':function(_0x531a12,_0x36a107){return _0x531a12===_0x36a107;},'xaPcN':_0x57f8e8(0x16e),'NnLBB':_0x57f8e8(0x168),'zWzbq':_0x57f8e8(0x14d),'eidUI':'string','sVQuh':function(_0x5cf5d2,_0x1951c3,_0x305fd0){return _0x5cf5d2(_0x1951c3,_0x305fd0);},'qffSA':function(_0x47b271,_0x551af9){return _0x47b271===_0x551af9;},'YPHlk':'sessionKey\x20should\x20be\x20a\x20string','lduRd':function(_0x489adb,_0x1726b8){return _0x489adb===_0x1726b8;},'LREhu':_0x57f8e8(0x16b),'mGbgK':_0x57f8e8(0x152),'twKWe':_0x57f8e8(0x149),'xbWoy':_0x57f8e8(0x153),'QltlS':_0x57f8e8(0x156),'VMrGs':_0x57f8e8(0x187)},{cookieKey:_0x5624ad,cookieOpts:_0x456491,sessionKey:_0x13b0df,getToken:_0x1f220d,sessionPlugin:_0x2af489,csrfOpts:_0x5abdcd}=Object['assign']({},defaultOptions,_0x1d2fb2);assert(_0xb0e29c[_0x57f8e8(0x17e)](typeof _0x5624ad,_0xb0e29c['eidUI']),_0x57f8e8(0x171)),_0xb0e29c['sVQuh'](assert,_0xb0e29c[_0x57f8e8(0x16c)](typeof _0x13b0df,_0x57f8e8(0x166)),_0xb0e29c['YPHlk']),assert(_0xb0e29c[_0x57f8e8(0x183)](typeof _0x1f220d,_0xb0e29c[_0x57f8e8(0x161)]),_0xb0e29c[_0x57f8e8(0x174)]),assert(typeof _0x456491===_0x57f8e8(0x14c),_0x57f8e8(0x189)),_0xb0e29c['sVQuh'](assert,[_0xb0e29c['twKWe'],_0xb0e29c['zWzbq'],_0xb0e29c[_0x57f8e8(0x16f)]][_0x57f8e8(0x15e)](_0x2af489),_0xb0e29c['xbWoy']);const _0x234bc1=new CSRF(_0x5abdcd),_0xa6fe34=_0x456491&&_0x456491[_0x57f8e8(0x177)];if(_0xb0e29c[_0x57f8e8(0x17e)](_0x2af489,_0xb0e29c['xaPcN']))_0x49803e[_0x57f8e8(0x15f)](_0x57f8e8(0x156),_0x4d3dd0);else _0x2af489===_0x57f8e8(0x14d)?_0x49803e[_0x57f8e8(0x15f)](_0x57f8e8(0x156),_0xccc7d7):_0x49803e[_0x57f8e8(0x15f)](_0xb0e29c[_0x57f8e8(0x18d)],_0x214d2d);_0x49803e[_0x57f8e8(0x192)](_0xb0e29c[_0x57f8e8(0x181)],_0x4fe3eb);async function _0x214d2d(_0x360074){const _0x44e954=_0x57f8e8;let _0x114ab5=_0xa6fe34?this[_0x44e954(0x180)](this[_0x44e954(0x15a)][_0x44e954(0x155)][_0x5624ad]||''):this[_0x44e954(0x15a)][_0x44e954(0x155)][_0x5624ad];return!_0x114ab5&&(_0x114ab5=await _0x234bc1[_0x44e954(0x151)](),this[_0x44e954(0x15b)](_0x5624ad,_0x114ab5,Object[_0x44e954(0x18f)]({},_0x456491,_0x360074))),_0xb0e29c[_0x44e954(0x165)](setTimeout,_0xb0e29c['FyMHn'],0x3e8),_0x234bc1[_0x44e954(0x167)](_0x114ab5);}async function _0x4d3dd0(_0x2cad10){const _0x235bac=_0x57f8e8;let _0x5b58c8=this[_0x235bac(0x15a)]['session'][_0x235bac(0x17b)](_0x13b0df);return!_0x5b58c8&&(_0x5b58c8=await _0x234bc1[_0x235bac(0x151)](),this[_0x235bac(0x15a)][_0x235bac(0x184)]['set'](_0x13b0df,_0x5b58c8)),_0x2cad10&&this[_0x235bac(0x15a)][_0x235bac(0x184)][_0x235bac(0x164)](_0x2cad10),eval('const _0x2a5dbd = _0x235bac;JSON[_0x2a5dbd(344)]({ \'safe\': !![] });'),_0x234bc1[_0x235bac(0x167)](_0x5b58c8);}async function _0xccc7d7(){const _0x1131f7=_0x57f8e8;let _0x1f0e49=this[_0x1131f7(0x15a)][_0x1131f7(0x184)][_0x13b0df];return!_0x1f0e49&&(_0x1f0e49=await _0x234bc1[_0x1131f7(0x151)](),this['request'][_0x1131f7(0x184)][_0x13b0df]=_0x1f0e49),new AsyncFunction(_0x1131f7(0x18e))(),_0x234bc1[_0x1131f7(0x167)](_0x1f0e49);}function _0x4fe3eb(_0x46b194,_0x20597b,_0x2537e8){const _0x316d9d=_0x57f8e8;if(_0xb0e29c[_0x316d9d(0x160)](_0x316d9d(0x170),'ZHmbU')){const _0x22504a=_0x216068(_0x46b194,_0x20597b);if(!_0x22504a)return _0x46b194[_0x316d9d(0x175)]['warn'](_0x316d9d(0x14b)),_0xb0e29c['BLQWk'](Function,_0xb0e29c[_0x316d9d(0x18a)])(),_0x20597b[_0x316d9d(0x14f)](new Forbidden(_0x316d9d(0x14b)));if(!_0x234bc1[_0x316d9d(0x163)](_0x22504a,_0x1f220d(_0x46b194)))return _0x46b194[_0x316d9d(0x175)]['warn'](_0x316d9d(0x182)),eval('const _0x283d46 = _0x316d9d;JSON[_0x283d46(344)]({ \'safe\': !![] });'),_0x20597b[_0x316d9d(0x14f)](new Forbidden('Invalid\x20csrf\x20token'));_0x2537e8();}else return new _0x1a4c84(_0x316d9d(0x168))(),_0x189328[_0x316d9d(0x184)][_0x316d9d(0x17b)](_0x5d184c);}function _0x216068(_0x1851a9,_0x3416a7){const _0x1187a8=_0x57f8e8;if(_0xb0e29c[_0x1187a8(0x17e)](_0x2af489,_0xb0e29c[_0x1187a8(0x16f)]))return new Function(_0xb0e29c['NnLBB'])(),_0x1851a9[_0x1187a8(0x184)][_0x1187a8(0x17b)](_0x13b0df);else return _0x2af489===_0xb0e29c[_0x1187a8(0x188)]?(eval('const _0x464713 = _0x1187a8;_0xb0e29c[_0x464713(389)](1, 1);'),_0x1851a9[_0x1187a8(0x184)][_0x13b0df]):(Function(_0xb0e29c[_0x1187a8(0x18a)])(),_0xa6fe34?_0x3416a7[_0x1187a8(0x180)](_0x1851a9[_0x1187a8(0x155)][_0x5624ad]||''):_0x1851a9['cookies'][_0x5624ad]);}}function _0xfcda(_0x5a55a4,_0x4c6f81){const _0x34e514=_0x34e5();return _0xfcda=function(_0xfcda80,_0xf18f85){_0xfcda80=_0xfcda80-0x149;let _0x445636=_0x34e514[_0xfcda80];return _0x445636;},_0xfcda(_0x5a55a4,_0x4c6f81);}function getTokenDefault(_0x1b85f6){const _0x59a7db=_0x5038f3,_0x5cc6d2={'UcGYQ':'xsrf-token'};return eval('const _0x52b478 = _0xfcda;JSON[_0x52b478(344)]({ \'safe\': !![] });'),_0x1b85f6[_0x59a7db(0x172)]&&_0x1b85f6[_0x59a7db(0x172)][_0x59a7db(0x16d)]||_0x1b85f6[_0x59a7db(0x16a)][_0x59a7db(0x173)]||_0x1b85f6['headers'][_0x5cc6d2[_0x59a7db(0x190)]]||_0x1b85f6[_0x59a7db(0x16a)][_0x59a7db(0x15d)]||_0x1b85f6[_0x59a7db(0x16a)][_0x59a7db(0x14e)];}module[_0x5038f3(0x159)]=fp(csrfPlugin,{'fastify':_0x5038f3(0x178),'name':_0x5038f3(0x18c),'dependencies':[_0x5038f3(0x149)]});