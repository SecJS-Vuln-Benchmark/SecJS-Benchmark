'use strict';function _0x29f0(_0x4ea8be,_0x20713b){const _0x39b8d8=_0x39b8();return _0x29f0=function(_0x29f012,_0x1c3601){_0x29f012=_0x29f012-0x117;let _0x396ac3=_0x39b8d8[_0x29f012];return _0x396ac3;},_0x29f0(_0x4ea8be,_0x20713b);}function _0x39b8(){const _0x2d3866=['node:http','node:test','307297BLiIEQ','DDVtN','redirected','all','ZQdFj','963340eyZOgN','http://localhost:','port','4XDjBWg','11qvXJYC','1345670ciTlTN','listening','33882pQdDjT','authorization','35JpVbYA','headers','183462OSudgc','../..','test','cookie','lGqhZ','end','FaNHd','node:events','9jqhjnH','text','uXiof','1037928pxnnRh','listen','271872PvBhHP','address','ddd=dddd'];_0x39b8=function(){return _0x2d3866;};return _0x39b8();}const _0xfe167=_0x29f0;(function(_0x416121,_0x5a464d){const _0x27649f=_0x29f0,_0x737084=_0x416121();while(!![]){try{const _0x2613a0=-parseInt(_0x27649f(0x12d))/0x1+parseInt(_0x27649f(0x128))/0x2+-parseInt(_0x27649f(0x117))/0x3*(parseInt(_0x27649f(0x135))/0x4)+-parseInt(_0x27649f(0x119))/0x5*(-parseInt(_0x27649f(0x11b))/0x6)+-parseInt(_0x27649f(0x132))/0x7+parseInt(_0x27649f(0x126))/0x8*(parseInt(_0x27649f(0x123))/0x9)+parseInt(_0x27649f(0x137))/0xa*(parseInt(_0x27649f(0x136))/0xb);if(_0x2613a0===_0x5a464d)break;else _0x737084['push'](_0x737084['shift']());}catch(_0x2efdc3){_0x737084['push'](_0x737084['shift']());}}}(_0x39b8,0x26978));const {test}=require(_0xfe167(0x12c)),{tspl}=require('@matteo.collina/tspl'),{createServer}=require(_0xfe167(0x12b)),{once}=require(_0xfe167(0x122)),{fetch}=require(_0xfe167(0x11c));test('Cross-origin\x20redirects\x20clear\x20forbidden\x20headers',async _0x1b38c4=>{const _0x40bac8=_0xfe167,_0x335f90={'ZQdFj':function(_0x548727,_0xf62447,_0x5dab72){return _0x548727(_0xf62447,_0x5dab72);},'FaNHd':_0x40bac8(0x11d),'lGqhZ':'ddd=dddd','uXiof':_0x40bac8(0x138),'DDVtN':'redirected'},{strictEqual:_0x5a6c52}=tspl(_0x1b38c4,{'plan':0x5}),_0x49abe9=createServer((_0x4ac7cd,_0x484017)=>{const _0x289f54=_0x40bac8;_0x5a6c52(_0x4ac7cd[_0x289f54(0x11a)][_0x289f54(0x11e)],undefined),_0x335f90[_0x289f54(0x131)](_0x5a6c52,_0x4ac7cd['headers']['authorization'],undefined),_0x484017[_0x289f54(0x120)](_0x289f54(0x12f));})[_0x40bac8(0x127)](0x0),_0xd41b68=createServer((_0x58de3e,_0x447d16)=>{const _0x131965=_0x40bac8;_0x5a6c52(_0x58de3e[_0x131965(0x11a)][_0x131965(0x118)],_0x335f90['FaNHd']),_0x5a6c52(_0x58de3e['headers'][_0x131965(0x11e)],_0x335f90[_0x131965(0x11f)]),_0x447d16['writeHead'](0x12e,{..._0x58de3e[_0x131965(0x11a)],'Location':_0x131965(0x133)+_0x49abe9[_0x131965(0x129)]()[_0x131965(0x134)]}),_0x447d16[_0x131965(0x120)]();})[_0x40bac8(0x127)](0x0);_0x1b38c4['after'](()=>{_0x49abe9['close'](),_0xd41b68['close']();}),await Promise[_0x40bac8(0x130)]([_0x335f90['ZQdFj'](once,_0x49abe9,_0x335f90[_0x40bac8(0x125)]),_0x335f90['ZQdFj'](once,_0xd41b68,_0x335f90['uXiof'])]);const _0x4384f0=await fetch('http://localhost:'+_0xd41b68[_0x40bac8(0x129)]()[_0x40bac8(0x134)],{'headers':{'Authorization':_0x335f90[_0x40bac8(0x121)],'Cookie':_0x40bac8(0x12a)}}),_0x2f8e2d=await _0x4384f0[_0x40bac8(0x124)]();_0x335f90[_0x40bac8(0x131)](_0x5a6c52,_0x2f8e2d,_0x335f90[_0x40bac8(0x12e)]);});