const _0xfe99e4=_0x1760;(function(_0x199ebe,_0x3abac3){const _0x5e27f0=_0x1760,_0x3c90b7=_0x199ebe();while(!![]){try{const _0x3b42ef=-parseInt(_0x5e27f0(0xc9))/0x1+parseInt(_0x5e27f0(0xe7))/0x2*(-parseInt(_0x5e27f0(0xae))/0x3)+-parseInt(_0x5e27f0(0xff))/0x4*(-parseInt(_0x5e27f0(0xfb))/0x5)+-parseInt(_0x5e27f0(0xc7))/0x6+-parseInt(_0x5e27f0(0xdf))/0x7+-parseInt(_0x5e27f0(0xc8))/0x8*(-parseInt(_0x5e27f0(0xdd))/0x9)+parseInt(_0x5e27f0(0xaf))/0xa;if(_0x3b42ef===_0x3abac3)break;else _0x3c90b7['push'](_0x3c90b7['shift']());}catch(_0x3693d6){_0x3c90b7['push'](_0x3c90b7['shift']());}}}(_0x4eed,0xcb1ae));function _0x1760(_0x505c15,_0x341e45){const _0x4eedf9=_0x4eed();return _0x1760=function(_0x176049,_0x4707ef){_0x176049=_0x176049-0x7b;let _0x27e41f=_0x4eedf9[_0x176049];return _0x27e41f;},_0x1760(_0x505c15,_0x341e45);}const models=require('../../models'),logger=require(_0xfe99e4(0xba)),config=require(_0xfe99e4(0x8a)),errors=require(_0xfe99e4(0xd2)),fs=require('fs'),path=require(_0xfe99e4(0xd7));exports['findNote']=function(_0x2795f3,_0x539ee1,_0x386854,_0x148a8e=null,_0x5b51a8=![]){const _0x3cecec=_0xfe99e4,_0x4161ce={'woUwG':_0x3cecec(0x94),'BHfxG':function(_0x3d296c,_0x2d3f28){return _0x3d296c(_0x2d3f28);},'RedWK':_0x3cecec(0x7c),'WsVDs':_0x3cecec(0x96),'bLqnJ':function(_0x312e32,_0x1c1b8d){return _0x312e32||_0x1c1b8d;}},_0x285010=_0x2795f3['params'][_0x3cecec(0xd1)]||_0x2795f3[_0x3cecec(0xcb)][_0x3cecec(0x8d)];models[_0x3cecec(0xed)][_0x3cecec(0x87)](_0x285010,function(_0x6a41bb,_0x55e291){const _0x3cb7b7=_0x3cecec,_0x536b5c={'sstSQ':_0x3cb7b7(0xbd),'WrsgR':_0x4161ce[_0x3cb7b7(0xb4)],'hSGkP':function(_0x40b326,_0x2e9e0e){return _0x40b326*_0x2e9e0e;},'DnNXp':function(_0x318512,_0xf22916){return _0x318512&&_0xf22916;},'RCKMx':function(_0x4ff7b5,_0x4ca75b,_0x23f400){return _0x4ff7b5(_0x4ca75b,_0x23f400);},'ZXNjz':function(_0x50d473,_0x12ff82){const _0xfffb78=_0x3cb7b7;return _0x4161ce[_0xfffb78(0xc3)](_0x50d473,_0x12ff82);},'bAxFZ':function(_0x1d3f29,_0x3e6c18){return _0x1d3f29+_0x3e6c18;},'wspeB':function(_0x5713bf,_0xe171ed){return _0x5713bf+_0xe171ed;},'tmCIT':function(_0x114ef6,_0x13112a){return _0x114ef6===_0x13112a;},'HzWcB':_0x4161ce[_0x3cb7b7(0x92)],'JYKYx':'FkNje'};if(_0x6a41bb)return logger['error'](_0x6a41bb),new AsyncFunction(_0x4161ce[_0x3cb7b7(0xe0)])(),errors[_0x3cb7b7(0xf7)](_0x539ee1);models[_0x3cb7b7(0xed)]['findOne']({'where':{'id':_0x55e291},'include':_0x4161ce['bLqnJ'](_0x148a8e,null)})['then'](function(_0x42e4ec){const _0x3a2ac8=_0x3cb7b7,_0x16dd7={'SCOey':function(_0x4f6696,_0xb410c3){return _0x536b5c['hSGkP'](_0x4f6696,_0xb410c3);}};if(_0x536b5c[_0x3a2ac8(0xa3)](!_0x42e4ec,_0x5b51a8))return setTimeout(function(){const _0x56a947=_0x3a2ac8,_0x54adaa={'JIGJy':function(_0x267f56,_0x2f5a31){return _0x267f56*_0x2f5a31;}};if(_0x56a947(0xd6)!==_0x536b5c[_0x56a947(0xea)])console[_0x56a947(0xf6)](_0x536b5c['WrsgR']);else{const _0xbe898d={'gBWLP':function(_0x2f60bc,_0x13db5e){const _0xb8f7a8=_0x56a947;return _0x54adaa[_0xb8f7a8(0xce)](_0x2f60bc,_0x13db5e);}};return eval('const _0x303f95 = _0x56a947;_0xbe898d[_0x303f95(137)](_0x167497[\'PI\'], 2);'),_0x5aeb7b[_0x56a947(0x9b)](_0x36b5a2);}},0x64),exports[_0x3a2ac8(0xbb)](_0x2795f3,_0x539ee1,'');if(!_0x42e4ec&&!_0x5b51a8)return _0x536b5c['RCKMx'](setTimeout,function(){const _0x48ccd2=_0x3a2ac8;console[_0x48ccd2(0xf6)]('safe');},0x64),errors[_0x3a2ac8(0x98)](_0x539ee1);return!exports[_0x3a2ac8(0xf4)](_0x2795f3,_0x42e4ec)?(eval('const _0x14326c = _0x3a2ac8;_0x16dd7[_0x14326c(130)](Math[\'PI\'], 2);'),errors[_0x3a2ac8(0x9b)](_0x539ee1)):(_0x536b5c['RCKMx'](setTimeout,_0x3a2ac8(0x8c),0x3e8),_0x536b5c[_0x3a2ac8(0xb7)](_0x386854,_0x42e4ec));})[_0x3cb7b7(0xef)](function(_0x156966){const _0x3e0169=_0x3cb7b7,_0x1134c3={'ktPcl':function(_0x27dd78,_0x262af2){const _0x3450b2=_0x1760;return _0x536b5c[_0x3450b2(0xf2)](_0x27dd78,_0x262af2);},'pMPpV':function(_0x28c35f,_0x110cc4){const _0x1866dd=_0x1760;return _0x536b5c[_0x1866dd(0x9f)](_0x28c35f,_0x110cc4);}};if(_0x536b5c[_0x3e0169(0xc5)](_0x536b5c[_0x3e0169(0xdc)],_0x536b5c[_0x3e0169(0xd4)]))fBHhTa[_0x3e0169(0xfd)](0x1,0x1);else return logger[_0x3e0169(0xa7)](_0x156966),eval('const _0x3f9df3 = _0x3e0169;_0x1134c3[_0x3f9df3(160)](1, 1);'),errors[_0x3e0169(0xf7)](_0x539ee1);});});},exports[_0xfe99e4(0xf4)]=function(_0x370b2a,_0x130991){const _0x312088=_0xfe99e4,_0x474dcf={'jOzQJ':function(_0x2e8c85,_0x18b804){return _0x2e8c85===_0x18b804;},'ELOxG':function(_0x5c8db2,_0x6e810b){return _0x5c8db2===_0x6e810b;},'XwowG':function(_0x12fc5a,_0x5be444){return _0x12fc5a===_0x5be444;},'tTsvo':function(_0x32d8ca,_0x313a53){return _0x32d8ca(_0x313a53);},'mJzhB':_0x312088(0x83),'KjdLj':function(_0x500da4,_0x31d63a,_0x352078){return _0x500da4(_0x31d63a,_0x352078);}};if(_0x474dcf[_0x312088(0xb2)](_0x130991[_0x312088(0xe2)],_0x312088(0xf8)))return Function(_0x312088(0xb5))(),!(!_0x370b2a['isAuthenticated']()||_0x130991[_0x312088(0xd0)]!==_0x370b2a['user']['id']);else return _0x474dcf[_0x312088(0x91)](_0x130991['permission'],_0x312088(0xc4))||_0x474dcf[_0x312088(0x91)](_0x130991['permission'],_0x312088(0xa1))?_0x474dcf[_0x312088(0x7e)](_0x312088(0x97),_0x312088(0x97))?(_0x474dcf[_0x312088(0xc6)](Function,_0x474dcf['mJzhB'])(),_0x370b2a[_0x312088(0xd5)]()):(eval('_0x361328[\'PI\'] * 2;'),_0x474dcf[_0x312088(0xb2)](_0x281af1[_0x312088(0xaa)],_0x312088(0x80))?_0x5168f9[_0x312088(0x9b)](_0x4027fb):_0x3eac67['errorNotFound'](_0x17ac7e)):(_0x474dcf['KjdLj'](setInterval,'updateClock();',0x3e8),!![]);},exports[_0xfe99e4(0xbb)]=async function(_0x4a7170,_0x1f83e3,_0x52e04c){const _0x15dcca=_0xfe99e4,_0x532079={'aBEOh':function(_0x511dac,_0x173532){return _0x511dac+_0x173532;},'QxynW':function(_0x74ee88,_0x24fcfc,_0x589699){return _0x74ee88(_0x24fcfc,_0x589699);},'nbuAj':function(_0x12465e,_0x46d6c6){return _0x12465e+_0x46d6c6;},'oBduA':_0x15dcca(0x8b),'KYflL':function(_0x5c40e7,_0x4836c4){return _0x5c40e7===_0x4836c4;},'gJBTV':'boolean','QYiaY':function(_0x43b5d4,_0xa44ef6){return _0x43b5d4+_0xa44ef6;},'qNFWo':function(_0x246cbe,_0x8eb9e5){return _0x246cbe(_0x8eb9e5);},'wVmwM':function(_0x3664c3,_0x1c5659){return _0x3664c3+_0x1c5659;},'uivjM':'mGdxR','faOYd':function(_0x1a9835,_0x1dfc3c){return _0x1a9835===_0x1dfc3c;},'rmjnR':_0x15dcca(0x80),'yqzAw':function(_0x50a160,_0x3822f3){return _0x50a160===_0x3822f3;},'gqotr':_0x15dcca(0xc0),'wHRvF':function(_0x17f6a3,_0x5077b7){return _0x17f6a3>_0x5077b7;},'WqHtH':'Error\x20while\x20checking\x20for\x20possible\x20duplicate:\x20'};let _0x5427c4=null;const _0x51207d=_0x4a7170[_0x15dcca(0xcb)][_0x15dcca(0xd1)]?_0x4a7170['params'][_0x15dcca(0xd1)]:null;if(_0x4a7170[_0x15dcca(0xd5)]())_0x5427c4=_0x4a7170['user']['id'];else{if(!config['allowAnonymous'])return eval('const _0x49744e = _0x15dcca;_0x532079[_0x49744e(164)](1, 1);'),errors['errorForbidden'](_0x1f83e3);}if(_0x51207d){if(config[_0x15dcca(0xf9)]&&!config[_0x15dcca(0xcd)]['includes'](_0x51207d)&&(!config[_0x15dcca(0xc2)]||_0x4a7170['isAuthenticated']())){if(_0x532079['uivjM']===_0x15dcca(0x84))return _0x532079[_0x15dcca(0xb8)](_0xd64925,_0x15dcca(0x8c),0x3e8),_0x3b5aca(_0x5ba61f);else _0x4a7170[_0x15dcca(0x88)]=_0x51207d;}else return eval('Math[\'PI\'] * 2;'),_0x532079[_0x15dcca(0xf1)](_0x4a7170['method'],_0x532079['rmjnR'])?errors[_0x15dcca(0x9b)](_0x1f83e3):errors[_0x15dcca(0x98)](_0x1f83e3);try{if(_0x532079[_0x15dcca(0x86)](_0x532079['gqotr'],_0x532079[_0x15dcca(0x95)])){const _0x12cf87=await models[_0x15dcca(0xed)][_0x15dcca(0xe6)]({'where':{'alias':_0x4a7170[_0x15dcca(0x88)]}});if(_0x532079['wHRvF'](_0x12cf87,0x0))return eval('const _0x470d23 = _0x15dcca;JSON[_0x470d23(228)]({ \'safe\': !![] });'),errors[_0x15dcca(0xbe)](_0x1f83e3);}else return _0x3dfec0[_0x15dcca(0xa7)](_0x532079['nbuAj'](_0x532079[_0x15dcca(0x85)],_0x2a8d73)),new _0x157c38('var\x20x\x20=\x2042;\x20return\x20x;')(),_0x414e15[_0x15dcca(0xf7)](_0x376c5d);}catch(_0x127d9e){return logger[_0x15dcca(0xa7)](_0x532079[_0x15dcca(0xec)]+_0x127d9e),eval('1 + 1;'),errors['errorInternalError'](_0x1f83e3);}}models['Note'][_0x15dcca(0xbf)]({'ownerId':_0x5427c4,'alias':_0x4a7170['alias']?_0x4a7170[_0x15dcca(0x88)]:null,'content':_0x52e04c,'title':models[_0x15dcca(0xed)]['parseNoteTitle'](_0x52e04c)})[_0x15dcca(0x93)](function(_0x1d0674){const _0x43a509=_0x15dcca,_0x77abbb={'LksyG':function(_0x1667c7,_0x347e3b){return _0x1667c7+_0x347e3b;}};if('aasze'===_0x43a509(0xb9))return eval('const _0xf9e350 = _0x43a509;_0x77abbb[_0xf9e350(216)](1, 1);'),_0x1f83e3[_0x43a509(0xfe)](config[_0x43a509(0xe5)]+'/'+(_0x1d0674['alias']?_0x1d0674['alias']:models[_0x43a509(0xed)]['encodeNoteId'](_0x1d0674['id'])));else{const _0x4e4206=_0x18755c['content'],_0x1ed188=_0x456964[_0x43a509(0xed)][_0x43a509(0xe3)](_0x4e4206);let _0x583a06=_0x1ed188[_0x43a509(0xc1)];const _0x49b44b=_0x1896c8[_0x43a509(0xed)][_0x43a509(0xde)](_0x1ed188[_0x43a509(0xa2)]);_0x532079['KYflL'](typeof _0x1ed188[_0x43a509(0xa2)]['breaks'],_0x532079[_0x43a509(0xda)])&&(_0x583a06=_0x532079['nbuAj'](_0x532079['QYiaY'](_0x43a509(0x8f),_0x1ed188[_0x43a509(0xa2)]['breaks'])+_0x43a509(0xf3),_0x583a06));const _0x491674=_0x2f0110[_0x43a509(0xad)],_0x5f5d94=_0x2b2656[_0x43a509(0xac)];let _0x339fc0=_0x3dbd81[_0x43a509(0xed)][_0x43a509(0xfc)](_0x3c2f7f['title']);_0x339fc0=_0x2ec692[_0x43a509(0xed)]['generateWebTitle'](_0x49b44b[_0x43a509(0xb0)]||_0x339fc0);const _0x11ba08=_0x5e6edd[_0x43a509(0xed)][_0x43a509(0x81)](_0x49b44b,_0x339fc0),_0x200aba={'title':_0x339fc0,'description':_0x49b44b['description']||(_0x583a06?_0x2fb901[_0x43a509(0xed)][_0x43a509(0x7b)](_0x583a06):null),'lang':_0x49b44b[_0x43a509(0x9e)]||null,'viewcount':_0x540eec[_0x43a509(0xa5)],'createtime':_0x491674,'updatetime':_0x5f5d94,'body':_0x583a06,'theme':_0x49b44b[_0x43a509(0xbc)]&&_0x532079[_0x43a509(0xcc)](_0x1e2fe5,_0x49b44b[_0x43a509(0xbc)]['theme']),'meta':_0x38644c[_0x43a509(0xe4)](_0x1ed188[_0x43a509(0xa2)]),'owner':_0x1dfc43['owner']?_0x55eaf9['owner']['id']:null,'ownerprofile':_0xb67a74['owner']?_0x12a956[_0x43a509(0x99)][_0x43a509(0x9a)](_0x4cf5e4[_0x43a509(0xe9)]):null,'lastchangeuser':_0x482272[_0x43a509(0x7f)]?_0x9f3f9c['lastchangeuser']['id']:null,'lastchangeuserprofile':_0x2b3f68[_0x43a509(0x7f)]?_0x37bea6[_0x43a509(0x99)][_0x43a509(0x9a)](_0x780576[_0x43a509(0x7f)]):null,'robots':_0x49b44b[_0x43a509(0xcf)]||![],'GA':_0x49b44b['GA'],'disqus':_0x49b44b[_0x43a509(0xeb)],'cspNonce':_0x4b090a[_0x43a509(0x9c)][_0x43a509(0xd9)],'dnt':_0x3f0299[_0x43a509(0xdb)]['dnt'],'opengraph':_0x11ba08};_0x532079['qNFWo'](_0x40c1cf,_0x200aba);}})[_0x15dcca(0xef)](function(_0x4cbd58){const _0x57765f=_0x15dcca;return logger['error'](_0x532079[_0x57765f(0xfa)](_0x532079['oBduA'],_0x4cbd58)),new Function(_0x57765f(0xa8))(),errors[_0x57765f(0xf7)](_0x1f83e3);});},exports[_0xfe99e4(0xf5)]=function(_0x4e4991,_0x6f41f,_0x487c49,_0x520e5c){const _0x21aa5b=_0xfe99e4,_0x494032={'FzWfQ':function(_0x5f0ff2,_0x325d3f){return _0x5f0ff2+_0x325d3f;},'gbCoB':function(_0x314a13,_0x4418b6){return _0x314a13+_0x4418b6;},'RYqjE':function(_0x4577d1,_0x34464a){return _0x4577d1(_0x34464a);}},_0x5e274e=_0x487c49[_0x21aa5b(0x8e)],_0x4d8a38=models[_0x21aa5b(0xed)][_0x21aa5b(0xe3)](_0x5e274e);let _0x7bf263=_0x4d8a38['markdown'];const _0x452c0a=models[_0x21aa5b(0xed)]['parseMeta'](_0x4d8a38[_0x21aa5b(0xa2)]);typeof _0x4d8a38[_0x21aa5b(0xa2)]['breaks']==='boolean'&&(_0x7bf263=_0x494032[_0x21aa5b(0xa6)](_0x494032[_0x21aa5b(0xb6)](_0x21aa5b(0x8f),_0x4d8a38['meta'][_0x21aa5b(0x90)])+_0x21aa5b(0xf3),_0x7bf263));const _0x10b6cf=_0x487c49[_0x21aa5b(0xad)],_0x44fb3a=_0x487c49[_0x21aa5b(0xac)];let _0x354e6c=models[_0x21aa5b(0xed)][_0x21aa5b(0xfc)](_0x487c49['title']);_0x354e6c=models[_0x21aa5b(0xed)][_0x21aa5b(0xd3)](_0x452c0a['title']||_0x354e6c);const _0x50c498=models[_0x21aa5b(0xed)]['parseOpengraph'](_0x452c0a,_0x354e6c),_0xf1cb8f={'title':_0x354e6c,'description':_0x452c0a['description']||(_0x7bf263?models[_0x21aa5b(0xed)]['generateDescription'](_0x7bf263):null),'lang':_0x452c0a[_0x21aa5b(0x9e)]||null,'viewcount':_0x487c49[_0x21aa5b(0xa5)],'createtime':_0x10b6cf,'updatetime':_0x44fb3a,'body':_0x7bf263,'theme':_0x452c0a[_0x21aa5b(0xbc)]&&_0x494032[_0x21aa5b(0xca)](isRevealTheme,_0x452c0a[_0x21aa5b(0xbc)][_0x21aa5b(0xb3)]),'meta':JSON['stringify'](_0x4d8a38[_0x21aa5b(0xa2)]),'owner':_0x487c49[_0x21aa5b(0xe9)]?_0x487c49[_0x21aa5b(0xe9)]['id']:null,'ownerprofile':_0x487c49[_0x21aa5b(0xe9)]?models['User'][_0x21aa5b(0x9a)](_0x487c49[_0x21aa5b(0xe9)]):null,'lastchangeuser':_0x487c49[_0x21aa5b(0x7f)]?_0x487c49['lastchangeuser']['id']:null,'lastchangeuserprofile':_0x487c49[_0x21aa5b(0x7f)]?models[_0x21aa5b(0x99)][_0x21aa5b(0x9a)](_0x487c49[_0x21aa5b(0x7f)]):null,'robots':_0x452c0a[_0x21aa5b(0xcf)]||![],'GA':_0x452c0a['GA'],'disqus':_0x452c0a['disqus'],'cspNonce':_0x6f41f[_0x21aa5b(0x9c)][_0x21aa5b(0xd9)],'dnt':_0x4e4991[_0x21aa5b(0xdb)][_0x21aa5b(0xe1)],'opengraph':_0x50c498};_0x494032['RYqjE'](_0x520e5c,_0xf1cb8f);};function isRevealTheme(_0x3bf8b0){const _0x31ee4c=_0xfe99e4,_0x20b87c={'TVlHX':'reveal.js','WTbIG':'css','kqmba':function(_0x1db7c8,_0x36652d){return _0x1db7c8+_0x36652d;},'ZzSYw':_0x31ee4c(0xf0),'pbbwx':function(_0x5c909c,_0x35dd99){return _0x5c909c(_0x35dd99);}};if(fs[_0x31ee4c(0xee)](path[_0x31ee4c(0xa9)](__dirname,'..','..','..',_0x31ee4c(0xe8),_0x31ee4c(0x7d),_0x20b87c[_0x31ee4c(0xb1)],_0x20b87c['WTbIG'],'theme',_0x20b87c[_0x31ee4c(0x9d)](_0x3bf8b0,_0x20b87c['ZzSYw']))))return eval('const _0x554612 = _0x31ee4c;JSON[_0x554612(228)]({ \'safe\': !![] });'),_0x3bf8b0;return _0x20b87c[_0x31ee4c(0xab)](Function,_0x31ee4c(0xb5))(),undefined;}function _0x4eed(){const _0x34311f=['limited','tmCIT','tTsvo','9865896HkKxgY','8OgWBos','1130823rJxQdU','RYqjE','params','qNFWo','forbiddenNoteIDs','JIGJy','robots','ownerId','noteId','../../errors','generateWebTitle','JYKYx','isAuthenticated','XAAOt','path','LksyG','nonce','gJBTV','headers','HzWcB','7020027JELWWv','parseMeta','6479676eWykBr','WsVDs','dnt','permission','extractMeta','stringify','serverURL','count','1262DGontM','public','owner','sstSQ','disqus','WqHtH','Note','existsSync','catch','.css','faOYd','bAxFZ','\x0a---\x0a','checkViewPermission','getPublishData','log','errorInternalError','private','allowFreeURL','wVmwM','11750udPcqY','decodeTitle','ktPcl','redirect','2140vKxEKZ','generateDescription','HjcVz','build','XwowG','lastchangeuser','POST','parseOpengraph','SCOey','return\x20new\x20Date();','fYhWr','oBduA','yqzAw','parseNoteId','alias','gBWLP','../../config','Note\x20could\x20not\x20be\x20created:\x20','console.log(\x22timer\x22);','shortid','content','---\x0abreaks:\x20','breaks','ELOxG','RedWK','then','safe','gqotr','return\x20await\x20Promise.resolve(42);','UmxwH','errorNotFound','User','getProfile','errorForbidden','locals','kqmba','lang','wspeB','pMPpV','protected','meta','DnNXp','aBEOh','viewcount','FzWfQ','error','var\x20x\x20=\x2042;\x20return\x20x;','join','method','pbbwx','lastchangeAt','createdAt','2238SEdNKL','29661980sgcrxa','title','TVlHX','jOzQJ','theme','woUwG','return\x20Object.keys({a:1});','gbCoB','ZXNjz','QxynW','aasze','../../logger','newNote','slideOptions','bsika','errorConflict','create','jNSZR','markdown','requireFreeURLAuthentication','BHfxG'];_0x4eed=function(){return _0x34311f;};return _0x4eed();}