const _0x14c6f9=_0x7700;(function(_0x382458,_0x2a941a){const _0x2926da=_0x7700,_0x44c06a=_0x382458();while(!![]){try{const _0x1f4104=parseInt(_0x2926da(0x177))/0x1+-parseInt(_0x2926da(0x1ea))/0x2*(parseInt(_0x2926da(0x1e8))/0x3)+-parseInt(_0x2926da(0x174))/0x4+parseInt(_0x2926da(0x1a3))/0x5*(parseInt(_0x2926da(0x148))/0x6)+-parseInt(_0x2926da(0x167))/0x7*(-parseInt(_0x2926da(0x1c2))/0x8)+-parseInt(_0x2926da(0x14c))/0x9+-parseInt(_0x2926da(0x199))/0xa*(-parseInt(_0x2926da(0x1eb))/0xb);if(_0x1f4104===_0x2a941a)break;else _0x44c06a['push'](_0x44c06a['shift']());}catch(_0xab2356){_0x44c06a['push'](_0x44c06a['shift']());}}}(_0x1d48,0xd423f));const assert=require('assert'),fs=require('fs'),{expect}=require('chai'),saml20=require(_0x14c6f9(0x1d3))['Saml20'],utils=require('../lib/passport-wsfed-saml2/utils'),SamlPassport=require(_0x14c6f9(0x1a0))[_0x14c6f9(0x140)];function _0x1d48(){const _0x485909=['yjMTW','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier','array','The\x20signing\x20certificate\x20is\x20invalid\x20(error:0688010A:asn1\x20encoding\x20routines::nested\x20asn1\x20error,\x20error:06800066:asn1\x20encoding\x20routines::bad\x20object\x20header)','The\x20signing\x20certificate\x20is\x20invalid\x20(error:0D07803A:asn1\x20encoding\x20routines:asn1_item_embed_d2i:nested\x20asn1\x20error,\x20error:0D068066:asn1\x20encoding\x20routines:asn1_check_tlen:bad\x20object\x20header)','UWxhq','Signature\x20was\x20found\x20more\x20than\x20one\x20time\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])','SPNameQualifier\x20attribute\x20in\x20the\x20NameID\x20element\x20does\x20not\x20match\x20urn:myapp','EtXTz','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','urn:issuer','undefined','CiCmA','wAatj','YNkqR','log','should\x20validate\x20certificate\x20expiration\x20with\x20non-embedded\x20cert','1752mTcEBJ','parentNode','azMZf','hnpPc','urn:myapp','zriDp','/samples/plain/samlresponse_saml20_invalid_cert.txt','TFXFo','AraxA','includes','GwlGM','вКонтакте','Signature\x20is\x20missing\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])','DEpJh','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/groups','tQtSc','EqzYo','saml','Ckduu','lUltT','zcGpu','Recipient\x20is\x20invalid.\x20Configured:\x20bar','SVLUl','should\x20validate\x20the\x20SPNameQualifier\x20when\x20the\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:2.0:nameid-format:transient\x22','xkVXl','WkuAr','CWYus','yIYhz','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress','acIUJ','include','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name','Admins','MqMwG','validate\x20saml\x20assertion\x20(signature\x20checks)','X509Certificate','ojilx','GMdvt','3dnygsr','getElementsByTagName','162056uhlvvP','70103BWNsSs','Layfr','removeChild','mHEyy','/test-auth0.key','SAML','iavSg','DaAme','0|4|1|3|2','create','WEgMX','KkTcn','OXgzu','3104010BUexdL','iSePO','bxxeN','should\x20parse\x20attributes','14468724fwExkY','search','GdAxO','lifetimeInSeconds','Error\x20message\x20for\x20invalid\x20certificate\x20is\x20incorrect','XLaVy','validateSamlAssertion','email','jOXtl','DMqhh','CImLL','should\x20ignore\x20the\x20NameQualifier\x20validation\x20when\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22','urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified','119B9E027959CDB7C662CFD075D9E2EF384E445F','Contributors','nktfN','eMsXK','should\x20fail\x20when\x20signature\x20is\x20not\x20found','сообщить\x20вКонтакте','GAvMB','Nmlgq','should\x20validate\x20recipent','IuVdQ','/test-auth0.cer','xJreO','ARVaH','not','22449HLFMhC','LPvQb','exist','should\x20validate\x20expiration\x20with\x20default\x20clockSkew','length','recipient','kYrtX','AkWyU','Gfglx','stringify','hnysj','MdVoJ','PqTmT','2832772hfRPkq','should\x20ignore\x20the\x20SPNameQualifier\x20validation\x20when\x20the\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature></saml:Assertion>','1638244MwHcWG','parseSamlAssertion','attributes','0|3|6|4|5|2|7|1|8','tymEU','UrIJk','YnGbp','erIPF','lbFXj','safe','message','urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified','PpDNR','ZWTxD','readFileSync','bHUMY','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_nPmKm9IskDCo61hUea4DX7o3POLbLcUK\x22\x20IssueInstant=\x222016-08-02T21:59:48.654Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_nPmKm9IskDCo61hUea4DX7o3POLbLcUK\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>UYsy9NacnRqnSTbidM8WBBgS+Op0G05iBJTX0T1WlUk=</DigestValue></Reference></SignedInfo><SignatureValue>VzRQaMR5Qk1P+g1tqJRKroq4JJx00FZ0rZxO4vG2gGkBXJ8262B4VUHOkxyPHNH1l/DuxSnNsL8AAbZfn8EdxMdToPvm2hkqygyA5W20o6g6eSC41rDOavTzesOKoXn3Uq9DOiUXve5ieYYCt5bQcoSCVT6uhVEKMhdcLhaB507qj9Gzcfp0E4F57ezRTTnVVEF/wCJ5j0QTMA2Wh09fxNkGijlE8KHzDJZapN4tDCzmK8qY7211gKuTfKYJGXYA4hSxw9fiQGDEPKRYA6tWf0HO5Vd8edRg2ZHr7AgjuCPp5Fj8VOP+KppA1YFBbq4Eqqt6KHg91KJlGs3ivpmwPw==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22\x20SPNameQualifier=\x22other-qualifier\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-08-02T22:09:48.654Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-08-02T21:59:48.654Z\x22\x20NotOnOrAfter=\x222016-08-02T22:09:48.654Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-08-02T21:59:48.654Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','dAfBK','JJaAr','dKbhy','The\x20signing\x20certificate\x20was\x20unexpectedly\x20valid','ECSSK','Foo\x20Bar','MdhiG','kOCPC','The\x20signing\x20certificate\x20is\x20invalid\x20(PEM_read_bio_PUBKEY\x20failed)','AfgcL','zMlrJ','WVUGH','PEfMe','vgJKx','kbtTw','assertion\x20has\x20expired.','PkHtY','640YNuEiO','Ilzby','should\x20validate\x20certificate\x20expiration\x20with\x20embedded\x20cert','issuer','should\x20should\x20allow\x20expired\x20cert\x20if\x20option\x20not\x20passed','ulMDi','сообщить@bar.com','../lib/passport-wsfed-saml2/saml','rpzUu','saml\x202.0\x20assertion','5dAyyoi','The\x20signing\x20certificate\x20is\x20not\x20currently\x20valid.','aRwuG','Sxmtt','split','toString','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','PxhaK','should\x20fail\x20when\x20signature\x20is\x20found\x20twice','foo@bar.com','equal','tzooD','RqFoq','foo'];_0x1d48=function(){return _0x485909;};return _0x1d48();}function _0x7700(_0x2c2e38,_0x1f3ee6){const _0x1d4824=_0x1d48();return _0x7700=function(_0x770081,_0x203cb4){_0x770081=_0x770081-0x13d;let _0x5b9d6c=_0x1d4824[_0x770081];return _0x5b9d6c;},_0x7700(_0x2c2e38,_0x1f3ee6);}describe(_0x14c6f9(0x1a2),function(){const _0x374e27=_0x14c6f9,_0x31c9bc={'WkuAr':_0x374e27(0x1ac),'DMqhh':function(_0x418c60,_0xaf995b){return _0x418c60(_0xaf995b);},'erIPF':_0x374e27(0x1b0),'acIUJ':_0x374e27(0x18d),'WEgMX':_0x374e27(0x1b3),'UrIJk':_0x374e27(0x1d0),'bxxeN':_0x374e27(0x1e2),'ulMDi':_0x374e27(0x15a),'TFXFo':_0x374e27(0x1bb),'aRwuG':_0x374e27(0x19c),'AfgcL':function(_0x392fe9,_0xacf9a4){return _0x392fe9!==_0xacf9a4;},'MqMwG':function(_0x3c9dba,_0x4a89e2){return _0x3c9dba+_0x4a89e2;},'hnysj':_0x374e27(0x1c6),'gkMGs':'Signature\x20is\x20missing\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])','PgfMq':function(_0x3eba0d){return _0x3eba0d();},'JJaAr':_0x374e27(0x1b2),'MqTns':_0x374e27(0x1e1),'UUciI':_0x374e27(0x1de),'DaAme':function(_0x1488aa){return _0x1488aa();},'nktfN':function(_0x58f759,_0x25ee7a){return _0x58f759!==_0x25ee7a;},'iavSg':'CiCmA','tymEU':_0x374e27(0x187),'MdVoJ':_0x374e27(0x163),'yFSYw':function(_0x3d2a3d){return _0x3d2a3d();},'ZWTxD':function(_0xd1a15c,_0x2b423e){return _0xd1a15c+_0x2b423e;},'GMdvt':_0x374e27(0x1b8),'LPvQb':function(_0x91ad2f,_0x12bba0){return _0x91ad2f(_0x12bba0);},'Gfglx':function(_0x184462,_0x3186d7){return _0x184462(_0x3186d7);},'ARVaH':function(_0x1e0cb,_0x39dd55){return _0x1e0cb(_0x39dd55);},'hnpPc':_0x374e27(0x1a4),'wAatj':function(_0x2d05e2){return _0x2d05e2();},'CWYus':_0x374e27(0x198),'iSePO':_0x374e27(0x1b6),'dKbhy':function(_0x13a0b8){return _0x13a0b8();},'DqlPb':function(_0x2c7c95,_0x512319){return _0x2c7c95(_0x512319);},'MdhiG':function(_0x1b2e91){return _0x1b2e91();},'YnGbp':'wuOJL','ojilx':function(_0x4abbc2,_0x3e7b48){return _0x4abbc2(_0x3e7b48);},'Sxmtt':function(_0x5911af){return _0x5911af();},'yIYhz':function(_0x55616b,_0x41f52f){return _0x55616b+_0x41f52f;},'lUltT':_0x374e27(0x1e5),'Layfr':'bar','eLHBv':'console.log(\x22timer\x22);','LJsOX':function(_0x2bc998){return _0x2bc998();},'CImLL':_0x374e27(0x182),'AvFPi':'http://schemas.microsoft.com/ws/2008/06/identity/claims/authenticationmethod','HOwXV':function(_0x1e8f0a,_0x5e5baa){return _0x1e8f0a(_0x5e5baa);},'DEpJh':_0x374e27(0x1d7),'GAvMB':_0x374e27(0x19f),'Cenga':_0x374e27(0x15e),'JLIJp':_0x374e27(0x1b5),'GwlGM':_0x374e27(0x18b),'Ckduu':_0x374e27(0x159),'SVLUl':function(_0x3fba34,_0x13491b){return _0x3fba34+_0x13491b;},'WVUGH':_0x374e27(0x1b7),'PEfMe':'PUavO','YNkqR':function(_0x7dcc72,_0x39a466,_0x3342c2){return _0x7dcc72(_0x39a466,_0x3342c2);},'lbFXj':_0x374e27(0x1ab),'Nmlgq':'/test-auth0.pem','KLyTE':_0x374e27(0x13f),'rpzUu':'urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified','xkVXl':_0x374e27(0x14b),'PpDNR':_0x374e27(0x157),'zMlrJ':function(_0x11e766,_0x341765,_0x39a08e){return _0x11e766(_0x341765,_0x39a08e);},'zriDp':'should\x20validate\x20expiration\x20with\x20overriden\x20clockSkew','Ilzby':_0x374e27(0x19d),'HersT':_0x374e27(0x19b),'azMZf':_0x374e27(0x161),'AraxA':function(_0x8c669f,_0x5152e4,_0x5ea186){return _0x8c669f(_0x5152e4,_0x5ea186);},'WBxNr':'should\x20extract\x20authentication\x20context\x20from\x20assertion\x20as\x20a\x20user\x20prop'},_0x329ac9={'cert':fs['readFileSync'](_0x31c9bc[_0x374e27(0x184)](__dirname,_0x31c9bc[_0x374e27(0x160)])),'key':fs[_0x374e27(0x185)](__dirname+_0x31c9bc['KLyTE']),'issuer':_0x31c9bc[_0x374e27(0x1c9)],'lifetimeInSeconds':0x258,'audiences':_0x31c9bc['hnysj'],'attributes':{'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress':_0x31c9bc[_0x374e27(0x1db)],'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name':_0x374e27(0x18d)},'nameIdentifier':_0x374e27(0x1b0),'nameIdentifierFormat':_0x31c9bc[_0x374e27(0x1a1)]};it(_0x31c9bc[_0x374e27(0x1da)],function(_0xfb637d){const _0x33ad79=_0x374e27,_0x2736b4=saml20[_0x33ad79(0x144)](_0x329ac9),_0x51f766=fs[_0x33ad79(0x185)](__dirname+_0x33ad79(0x163))[_0x33ad79(0x1a8)](),_0x2f10ef=new SamlPassport({'cert':_0x51f766,'realm':_0x33ad79(0x1c6),'checkRecipient':![]});_0x2f10ef[_0x33ad79(0x152)](_0x2736b4,function(_0x972bd2,_0x21d568){const _0x55a362=_0x33ad79,_0x56a3f6=_0x55a362(0x17a)['split']('|');let _0xd0f110=0x0;while(!![]){switch(_0x56a3f6[_0xd0f110++]){case'0':eval('const _0x1d44dd = _0x55a362;JSON[_0x1d44dd(368)]({ \'safe\': !![] });');continue;case'1':assert[_0x55a362(0x1ad)](_0x55a362(0x1bb),_0x21d568[_0x55a362(0x19c)]);continue;case'2':assert['equal'](_0x31c9bc[_0x55a362(0x1db)],_0x21d568[_0x55a362(0x1de)]);continue;case'3':if(_0x972bd2)return _0x31c9bc[_0x55a362(0x155)](_0xfb637d,_0x972bd2);continue;case'4':assert['equal'](_0x31c9bc[_0x55a362(0x17e)],_0x21d568[_0x55a362(0x1b2)]);continue;case'5':assert[_0x55a362(0x1ad)](_0x31c9bc[_0x55a362(0x1df)],_0x21d568[_0x55a362(0x1e1)]);continue;case'6':assert['ok'](_0x21d568);continue;case'7':assert[_0x55a362(0x1ad)](_0x55a362(0x1ac),_0x21d568[_0x55a362(0x153)]);continue;case'8':_0xfb637d();continue;}break;}});}),it(_0x31c9bc[_0x374e27(0x183)],function(_0x5dae9f){const _0x885448=_0x374e27;if(_0x31c9bc[_0x885448(0x191)](_0x885448(0x13e),_0x885448(0x13e))){_0xdc7f46(function(){const _0x267f8e=_0x885448;_0xae0b4a[_0x267f8e(0x1c0)](_0x267f8e(0x180));},0x64);if(_0x38137f)return _0x4a7c11(_0x536b53);_0x31c9bc[_0x885448(0x155)](_0x1c4d26,_0x47b617)['to'][_0x885448(0x169)],_0x31c9bc[_0x885448(0x155)](_0x33c6ae,_0x2097d6[_0x885448(0x1d0)])['to']['be']['an'](_0x31c9bc[_0x885448(0x145)]),_0x352956(_0x516b1b[_0x31c9bc[_0x885448(0x17c)]])['to']['include'](_0x31c9bc[_0x885448(0x14a)]),_0x67994c(_0x22998b[_0x31c9bc[_0x885448(0x17c)]])['to'][_0x885448(0x1e0)](_0x31c9bc[_0x885448(0x19e)]),_0x56a76b();}else{const _0x58bb78='<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22\x20IssueInstant=\x222016-08-02T21:54:04.971Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>p7iHnIt5xJZNimGNxh4d9R2J7DML8WNrMwMxmZ1WwSU=</DigestValue></Reference></SignedInfo><SignatureValue>pb1Wp/LFbigEj+TNm7gkAwlfIc17LNwUXVTgM8RQnMvYJfIPZbl1yo5xMCh6ObMFwCs1T+gKI5C7jMloX2QhWD/XUffBKiDfkZUg7NI/Jyt5m+Bdst12SNhHBVsNilL9ZCuf+QtQD7301gUhVHP6Ramf4y+XNod9AfzhFLYNfl6fhf/5KA/KkjiOwYW5Ps/43OMXXSeVaeQ7JRU8XqyKbwlB+YXGseFLnyZopv8Cw9Bb2935ADLX111oFBkiRhnMUJW0LMbSWM6UVJ4V0qoW9h+f3isN5+R87RECNeAQP3WSBiddnEuSdhgQYQVnb6s0mThpvs7uvIOlog0FqeSrvQ==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22\x20NameQualifier=\x22name-qualifier\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-08-02T21:54:04.971Z\x22\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-08-02T21:54:04.971Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>',_0x22b66c=fs[_0x885448(0x185)](_0x31c9bc[_0x885448(0x1e3)](__dirname,'/test-auth0.cer'))[_0x885448(0x1a8)](),_0x481f71=new SamlPassport({'cert':_0x22b66c,'realm':_0x31c9bc[_0x885448(0x171)],'checkRecipient':![],'checkExpiration':![]});_0x481f71[_0x885448(0x152)](_0x58bb78,function(_0x2edb8d,_0x2bc27b){const _0x4233a0=_0x885448,_0x12dd88='5|0|4|3|7|6|1|2|8'[_0x4233a0(0x1a7)]('|');let _0x423b6c=0x0;while(!![]){switch(_0x12dd88[_0x423b6c++]){case'0':if(_0x2edb8d)return _0x5dae9f(_0x2edb8d);continue;case'1':assert[_0x4233a0(0x1ad)](_0x4233a0(0x1ac),_0x2bc27b[_0x4233a0(0x153)]);continue;case'2':assert[_0x4233a0(0x1ad)](_0x31c9bc['TFXFo'],_0x2bc27b[_0x31c9bc['aRwuG']]);continue;case'3':assert[_0x4233a0(0x1ad)](_0x4233a0(0x1b0),_0x2bc27b[_0x4233a0(0x1b2)]);continue;case'4':assert['ok'](_0x2bc27b);continue;case'5':setTimeout(function(){const _0x4e59ac=_0x4233a0;console[_0x4e59ac(0x1c0)](_0x4e59ac(0x180));},0x64);continue;case'6':assert[_0x4233a0(0x1ad)](_0x31c9bc[_0x4233a0(0x1db)],_0x2bc27b[_0x4233a0(0x1de)]);continue;case'7':assert[_0x4233a0(0x1ad)]('Foo\x20Bar',_0x2bc27b[_0x4233a0(0x1e1)]);continue;case'8':_0x5dae9f();continue;}break;}});}}),it(_0x374e27(0x175),function(_0x41549e){const _0x1c31cf=_0x374e27;if(_0x31c9bc[_0x1c31cf(0x15b)](_0x31c9bc[_0x1c31cf(0x141)],_0x1c31cf(0x1bd)))_0x14169b['ok'](_0x48a679),_0x44dea0['ok'](!_0x2fecc7),_0x49b979[_0x1c31cf(0x1ad)](_0x23eb99[_0x1c31cf(0x181)],_0x31c9bc['gkMGs']),_0x31c9bc['PgfMq'](_0x5d34fa);else{const _0x2ffd46=_0x31c9bc[_0x1c31cf(0x17b)],_0x2b868c=fs[_0x1c31cf(0x185)](_0x31c9bc['MqMwG'](__dirname,_0x31c9bc['MdVoJ']))[_0x1c31cf(0x1a8)](),_0xbfdacf=new SamlPassport({'cert':_0x2b868c,'realm':_0x1c31cf(0x1c6),'checkRecipient':![],'checkExpiration':![]});_0xbfdacf[_0x1c31cf(0x152)](_0x2ffd46,function(_0x489fc8,_0x250a3f){const _0xed59ad=_0x1c31cf;setTimeout('console.log(\x22timer\x22);',0x3e8);if(_0x489fc8)return _0x41549e(_0x489fc8);assert['ok'](_0x250a3f),assert[_0xed59ad(0x1ad)](_0x31c9bc[_0xed59ad(0x17e)],_0x250a3f[_0x31c9bc[_0xed59ad(0x189)]]),assert[_0xed59ad(0x1ad)](_0x31c9bc[_0xed59ad(0x1df)],_0x250a3f[_0x31c9bc['MqTns']]),assert[_0xed59ad(0x1ad)](_0xed59ad(0x1ac),_0x250a3f[_0x31c9bc['UUciI']]),assert[_0xed59ad(0x1ad)](_0x31c9bc[_0xed59ad(0x1db)],_0x250a3f[_0xed59ad(0x153)]),assert[_0xed59ad(0x1ad)](_0xed59ad(0x1bb),_0x250a3f[_0x31c9bc[_0xed59ad(0x1a5)]]),_0x31c9bc[_0xed59ad(0x142)](_0x41549e);});}}),it('should\x20validate\x20the\x20NameQualifier\x20when\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22',function(_0x3f9eac){const _0x3b89b0=_0x374e27,_0x157f48='<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_dZZwXmRpwYcaIdFA5l0qSCCuu0if9UNo\x22\x20IssueInstant=\x222016-09-29T12:34:13.488Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_dZZwXmRpwYcaIdFA5l0qSCCuu0if9UNo\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>ndqj65JwACeDERG2aZF6k0IF85KshkhgILzxhbKRyiw=</DigestValue></Reference></SignedInfo><SignatureValue>LPcIU9W9HmX1QM+baMPLTj9StBFRksnDoFn/HVd8uLJgdH8Xeiv9TOQGElmSaBLypjCeN6ILq6pcZ0mxMC9zfd9X3WKmYtcrGI1BugATeNsqUm63x+Msau8pNuZrNNbfIQvLooMhF4T92ym2ADSm+zCQVNwBH7/v0rVIE6MEy8AYqqfpvH9CR88XQYMCSgKN0JQ2FPbcHvhIX7Hl+xG6PSzgfznE8dcWBUi24FajyGpqlNm8O3uHCfjR3wzO42UQIJFOJOiLb7QGNyWE1KXKYWyzZgAxGQuRUcbYxcnKTbVK3b3TBH+p2ZR+a2ktKmvqNBvQxy6tE4UXDIIpvmknSw==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20NameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:44:13.488Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:34:13.488Z\x22\x20NotOnOrAfter=\x222016-09-29T12:44:13.488Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:34:13.488Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>',_0x252117=fs[_0x3b89b0(0x185)](_0x31c9bc[_0x3b89b0(0x184)](__dirname,_0x3b89b0(0x163)))[_0x3b89b0(0x1a8)](),_0x299a39=new SamlPassport({'cert':_0x252117,'realm':'urn:myapp','checkRecipient':![],'checkExpiration':![]});_0x299a39[_0x3b89b0(0x152)](_0x157f48,function(_0x17c58c,_0x22a507){const _0x100a68=_0x3b89b0;assert[_0x100a68(0x1ad)](_0x17c58c[_0x100a68(0x181)],'NameQualifier\x20attribute\x20in\x20the\x20NameID\x20element\x20does\x20not\x20match\x20urn:issuer'),_0x31c9bc['yFSYw'](_0x3f9eac);});}),_0x31c9bc['YNkqR'](it,_0x374e27(0x1d9),function(_0x4fe1d6){const _0x439d34=_0x374e27,_0x5d2ed6=_0x439d34(0x1a9),_0x2f27cf=fs[_0x439d34(0x185)](_0x31c9bc[_0x439d34(0x1e3)](__dirname,_0x31c9bc[_0x439d34(0x172)]))[_0x439d34(0x1a8)](),_0x4a4ed0=new SamlPassport({'cert':_0x2f27cf,'realm':'urn:myapp','checkRecipient':![],'checkExpiration':![]});_0x4a4ed0[_0x439d34(0x152)](_0x5d2ed6,function(_0x1588cb,_0x44ae5f){const _0x50b4bb=_0x439d34;assert[_0x50b4bb(0x1ad)](_0x1588cb[_0x50b4bb(0x181)],_0x31c9bc[_0x50b4bb(0x1e7)]),_0x4fe1d6();});}),_0x31c9bc[_0x374e27(0x192)](it,'should\x20parse\x20attributes\x20with\x20multiple\x20values',function(_0x19be9b){const _0x1e7f29=_0x374e27,_0x5b17b9={'ECSSK':'safe'};_0x329ac9[_0x1e7f29(0x179)]={'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/groups':[_0x31c9bc[_0x1e7f29(0x14a)],_0x1e7f29(0x15a)]};const _0x32f81a=saml20['create'](_0x329ac9),_0x315297=fs[_0x1e7f29(0x185)](_0x31c9bc['MqMwG'](__dirname,_0x31c9bc[_0x1e7f29(0x172)]))['toString'](),_0x485f3e=new SamlPassport({'cert':_0x315297,'realm':_0x31c9bc['hnysj'],'checkRecipient':![]});_0x485f3e['validateSamlAssertion'](_0x32f81a,function(_0x940dea,_0x57ffdc){const _0x2ce227=_0x1e7f29;setTimeout(function(){const _0x5ed811=_0x7700;console[_0x5ed811(0x1c0)](_0x5b17b9[_0x5ed811(0x18c)]);},0x64);if(_0x940dea)return _0x31c9bc[_0x2ce227(0x155)](_0x19be9b,_0x940dea);expect(_0x57ffdc)['to'][_0x2ce227(0x169)],expect(_0x57ffdc[_0x31c9bc[_0x2ce227(0x17c)]])['to']['be']['an']('array'),_0x31c9bc[_0x2ce227(0x168)](expect,_0x57ffdc[_0x31c9bc[_0x2ce227(0x17c)]])['to']['include'](_0x31c9bc[_0x2ce227(0x14a)]),expect(_0x57ffdc[_0x31c9bc[_0x2ce227(0x17c)]])['to'][_0x2ce227(0x1e0)](_0x2ce227(0x15a)),_0x19be9b();});}),it(_0x374e27(0x16a),function(_0x2635ce){const _0xb0ff8a=_0x374e27;_0x329ac9[_0xb0ff8a(0x14f)]=-0xf0;const _0x539d8d=saml20[_0xb0ff8a(0x144)](_0x329ac9),_0x2e47e4=fs[_0xb0ff8a(0x185)](__dirname+'/test-auth0.cer')['toString'](),_0x377ede=new SamlPassport({'cert':_0x2e47e4,'realm':_0xb0ff8a(0x1c6),'checkRecipient':![]});_0x377ede[_0xb0ff8a(0x152)](_0x539d8d,function(_0x5ef5b5,_0x30a905){const _0x44301b=_0xb0ff8a;_0x31c9bc[_0x44301b(0x16f)](expect,_0x5ef5b5)['to'][_0x44301b(0x169)],_0x31c9bc[_0x44301b(0x168)](expect,_0x5ef5b5['message'])['to']['equal'](_0x44301b(0x197)),_0x31c9bc['ARVaH'](expect,_0x30a905)['to']['not'][_0x44301b(0x169)],_0x2635ce();});}),_0x31c9bc['YNkqR'](it,_0x31c9bc[_0x374e27(0x1c7)],function(_0x3dd1fd){const _0x14c0fd=_0x374e27;if(_0x31c9bc[_0x14c0fd(0x1dc)]===_0x31c9bc[_0x14c0fd(0x149)]){const _0x165c8d={'GdAxO':function(_0x22786f,_0x4d6b9d){return _0x22786f(_0x4d6b9d);},'EqzYo':_0x31c9bc[_0x14c0fd(0x1c5)],'PqTmT':function(_0x9b592b,_0x4ed30d){return _0x31c9bc['Gfglx'](_0x9b592b,_0x4ed30d);}},_0x55264e=_0x38e8fd[_0x14c0fd(0x144)](_0x11c6d0),_0x4df4f9=_0x2d6b8a[_0x14c0fd(0x185)](_0x31c9bc['MqMwG'](_0x267fcd,_0x31c9bc[_0x14c0fd(0x172)]))[_0x14c0fd(0x1a8)](),_0x544af5=new _0x5aad05({'cert':_0x4df4f9,'realm':_0x14c0fd(0x1c6),'checkRecipient':![],'checkCertExpiration':!![]}),_0x5c8289=_0x5b321b[_0x14c0fd(0x178)](_0x55264e);_0x1c5162[_0x14c0fd(0x1ad)](_0x5c8289[_0x14c0fd(0x1e9)]('X509Certificate')[_0x14c0fd(0x16b)],0x1);const _0x4d5d93=_0x5c8289[_0x14c0fd(0x1e9)](_0x14c0fd(0x1e5))[0x0];_0x4d5d93['parentNode'][_0x14c0fd(0x13d)](_0x4d5d93),_0x3161df[_0x14c0fd(0x1ad)](_0x5c8289[_0x14c0fd(0x1e9)](_0x14c0fd(0x1e5))['length'],0x0),_0x544af5[_0x14c0fd(0x152)](_0x5c8289,function(_0x57826f,_0x51763a){const _0x40beda=_0x14c0fd;_0x165c8d[_0x40beda(0x14e)](_0x2546ed,_0x57826f)['to'][_0x40beda(0x169)],_0x3f8f74(_0x57826f['message'])['to']['equal'](_0x165c8d[_0x40beda(0x1d2)]),_0x165c8d[_0x40beda(0x173)](_0x4182b3,_0x51763a)['to'][_0x40beda(0x166)][_0x40beda(0x169)],_0x63a484();});}else{_0x329ac9['lifetimeInSeconds']=-0xf0;const _0x465743=saml20[_0x14c0fd(0x144)](_0x329ac9),_0xc8ef7d=fs[_0x14c0fd(0x185)](__dirname+_0x31c9bc[_0x14c0fd(0x172)])[_0x14c0fd(0x1a8)](),_0xd0faa0=new SamlPassport({'cert':_0xc8ef7d,'realm':_0x14c0fd(0x1c6),'checkRecipient':![],'clockSkew':0x5});_0xd0faa0[_0x14c0fd(0x152)](_0x465743,function(_0x48b19c,_0x500a4b){const _0x5e8e25=_0x14c0fd;expect(_0x48b19c)['to']['not']['exist'],expect(_0x500a4b)['to'][_0x5e8e25(0x169)],_0x31c9bc[_0x5e8e25(0x1be)](_0x3dd1fd);});}}),_0x31c9bc[_0x374e27(0x1bf)](it,_0x31c9bc[_0x374e27(0x19a)],function(_0x101541){const _0xd877b0=_0x374e27,_0x37d161={'zcGpu':function(_0x1feb8b,_0x1dff0d){return _0x1feb8b(_0x1dff0d);},'AkWyU':function(_0x6f2b1e){const _0x3282a8=_0x7700;return _0x31c9bc[_0x3282a8(0x18a)](_0x6f2b1e);}};_0x329ac9['lifetimeInSeconds']=0x2710;const _0x1ffef5=saml20[_0xd877b0(0x144)](_0x329ac9),_0x5935b3=fs['readFileSync'](_0x31c9bc[_0xd877b0(0x1e3)](__dirname,_0x31c9bc[_0xd877b0(0x172)]))[_0xd877b0(0x1a8)](),_0x36208b=new SamlPassport({'cert':_0x5935b3,'realm':_0xd877b0(0x1c6),'checkRecipient':![]});_0x36208b['validateSamlAssertion'](_0x1ffef5,function(_0x3b0776,_0x3ab482){const _0x3391f5=_0xd877b0;expect(_0x3b0776)['to'][_0x3391f5(0x166)][_0x3391f5(0x169)],_0x37d161[_0x3391f5(0x1d6)](expect,_0x3ab482)['to'][_0x3391f5(0x169)],_0x37d161[_0x3391f5(0x16e)](_0x101541);});}),it(_0x31c9bc['HersT'],function(_0x3f606c){const _0x2706f3=_0x374e27,_0x5dfbe7=saml20[_0x2706f3(0x144)](_0x329ac9),_0x2c679e=fs['readFileSync'](_0x31c9bc[_0x2706f3(0x1e3)](__dirname,_0x31c9bc['MdVoJ']))[_0x2706f3(0x1a8)](),_0x278480=new SamlPassport({'cert':_0x2c679e,'realm':_0x2706f3(0x1c6),'checkRecipient':![],'checkCertExpiration':!![]});_0x278480[_0x2706f3(0x152)](_0x5dfbe7,function(_0x4dd25b,_0x1f217e){const _0x4c35d0=_0x2706f3;_0x31c9bc['Gfglx'](expect,_0x4dd25b)['to'][_0x4c35d0(0x169)],_0x31c9bc[_0x4c35d0(0x165)](expect,_0x4dd25b['message'])['to']['equal'](_0x31c9bc[_0x4c35d0(0x1c5)]),_0x31c9bc['DqlPb'](expect,_0x1f217e)['to']['be'][_0x4c35d0(0x1bc)],_0x31c9bc[_0x4c35d0(0x18e)](_0x3f606c);});}),_0x31c9bc['YNkqR'](it,_0x374e27(0x1c1),function(_0x40bfbe){const _0x30d267=_0x374e27,_0x2d22c0=saml20[_0x30d267(0x144)](_0x329ac9),_0x3137cc=fs[_0x30d267(0x185)](_0x31c9bc[_0x30d267(0x1dd)](__dirname,_0x30d267(0x163)))[_0x30d267(0x1a8)](),_0x16b00c=new SamlPassport({'cert':_0x3137cc,'realm':_0x31c9bc[_0x30d267(0x171)],'checkRecipient':![],'checkCertExpiration':!![]}),_0x49baa2=utils[_0x30d267(0x178)](_0x2d22c0);assert[_0x30d267(0x1ad)](_0x49baa2[_0x30d267(0x1e9)](_0x31c9bc['lUltT'])[_0x30d267(0x16b)],0x1);const _0x262a06=_0x49baa2[_0x30d267(0x1e9)](_0x31c9bc[_0x30d267(0x1d5)])[0x0];_0x262a06[_0x30d267(0x1c3)][_0x30d267(0x13d)](_0x262a06),assert[_0x30d267(0x1ad)](_0x49baa2[_0x30d267(0x1e9)](_0x30d267(0x1e5))[_0x30d267(0x16b)],0x0),_0x16b00c[_0x30d267(0x152)](_0x49baa2,function(_0x43d01e,_0x49d6b4){const _0x35c3e5=_0x30d267,_0x1193cf={'kbtTw':_0x31c9bc[_0x35c3e5(0x17e)],'eMsXK':_0x35c3e5(0x153),'EtXTz':function(_0x4055d5,_0xa09e6c){return _0x4055d5+_0xa09e6c;},'JenVc':_0x31c9bc['MdVoJ'],'XLaVy':_0x35c3e5(0x1c6)};if(_0x35c3e5(0x16d)!==_0x31c9bc[_0x35c3e5(0x17d)])expect(_0x43d01e)['to'][_0x35c3e5(0x169)],_0x31c9bc[_0x35c3e5(0x1e6)](expect,_0x43d01e[_0x35c3e5(0x181)])['to'][_0x35c3e5(0x1ad)](_0x35c3e5(0x1a4)),_0x31c9bc[_0x35c3e5(0x16f)](expect,_0x49d6b4)['to'][_0x35c3e5(0x166)][_0x35c3e5(0x169)],_0x31c9bc[_0x35c3e5(0x1a6)](_0x40bfbe);else{const _0x5bf981={'bHUMY':_0x1193cf[_0x35c3e5(0x196)],'yjMTW':_0x35c3e5(0x18d),'tQtSc':_0x35c3e5(0x1ac),'jOXtl':_0x35c3e5(0x1de),'OXgzu':_0x1193cf[_0x35c3e5(0x15c)]},_0x2ba935='<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22\x20IssueInstant=\x222016-08-02T21:54:04.971Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>p7iHnIt5xJZNimGNxh4d9R2J7DML8WNrMwMxmZ1WwSU=</DigestValue></Reference></SignedInfo><SignatureValue>pb1Wp/LFbigEj+TNm7gkAwlfIc17LNwUXVTgM8RQnMvYJfIPZbl1yo5xMCh6ObMFwCs1T+gKI5C7jMloX2QhWD/XUffBKiDfkZUg7NI/Jyt5m+Bdst12SNhHBVsNilL9ZCuf+QtQD7301gUhVHP6Ramf4y+XNod9AfzhFLYNfl6fhf/5KA/KkjiOwYW5Ps/43OMXXSeVaeQ7JRU8XqyKbwlB+YXGseFLnyZopv8Cw9Bb2935ADLX111oFBkiRhnMUJW0LMbSWM6UVJ4V0qoW9h+f3isN5+R87RECNeAQP3WSBiddnEuSdhgQYQVnb6s0mThpvs7uvIOlog0FqeSrvQ==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22\x20NameQualifier=\x22name-qualifier\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-08-02T21:54:04.971Z\x22\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-08-02T21:54:04.971Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>',_0x50922f=_0x2341f3[_0x35c3e5(0x185)](_0x1193cf[_0x35c3e5(0x1b9)](_0xce2d22,_0x1193cf['JenVc']))[_0x35c3e5(0x1a8)](),_0x3ef218=new _0x54bb95({'cert':_0x50922f,'realm':_0x1193cf[_0x35c3e5(0x151)],'checkRecipient':![],'checkExpiration':![]});_0x3ef218[_0x35c3e5(0x152)](_0x2ba935,function(_0x116665,_0x564906){const _0x220f5c=_0x35c3e5,_0x197fe5={'kOCPC':_0x220f5c(0x180)};_0xf82cf3(function(){const _0x294a6b=_0x220f5c;_0x58eb47[_0x294a6b(0x1c0)](_0x197fe5[_0x294a6b(0x18f)]);},0x64);if(_0x116665)return _0x17acb5(_0x116665);_0x2ce668['ok'](_0x564906),_0x24c0ba[_0x220f5c(0x1ad)](_0x5bf981[_0x220f5c(0x186)],_0x564906[_0x220f5c(0x1b2)]),_0x192732['equal'](_0x5bf981[_0x220f5c(0x1b1)],_0x564906[_0x220f5c(0x1e1)]),_0x28a49b['equal'](_0x5bf981['tQtSc'],_0x564906[_0x5bf981[_0x220f5c(0x154)]]),_0x3b6447[_0x220f5c(0x1ad)](_0x5bf981[_0x220f5c(0x1d1)],_0x564906[_0x5bf981[_0x220f5c(0x147)]]),_0xf978ca['equal'](_0x220f5c(0x1bb),_0x564906[_0x220f5c(0x19c)]),_0x5a25d6();});}});}),_0x31c9bc[_0x374e27(0x1bf)](it,_0x31c9bc[_0x374e27(0x1c4)],function(_0x51e192){const _0x546435=_0x374e27;_0x329ac9[_0x546435(0x14f)]=0x258,_0x329ac9[_0x546435(0x16c)]=_0x546435(0x1b0);const _0x8f84e3=saml20[_0x546435(0x144)](_0x329ac9),_0x237d8a=fs[_0x546435(0x185)](__dirname+_0x31c9bc[_0x546435(0x172)])[_0x546435(0x1a8)](),_0x4c906c=new SamlPassport({'cert':_0x237d8a,'realm':_0x546435(0x1c6),'recipientUrl':_0x31c9bc[_0x546435(0x1ec)]});_0x4c906c[_0x546435(0x152)](_0x8f84e3,function(_0x4108e4,_0x2a2e6a){const _0x424cd0=_0x546435;expect(_0x4108e4)['to'][_0x424cd0(0x169)],expect(_0x4108e4[_0x424cd0(0x181)])['to']['equal'](_0x424cd0(0x1d7)),_0x31c9bc[_0x424cd0(0x165)](expect,_0x2a2e6a)['to'][_0x424cd0(0x166)][_0x424cd0(0x169)],_0x31c9bc['PgfMq'](_0x51e192);});}),_0x31c9bc[_0x374e27(0x1ca)](it,_0x31c9bc['WBxNr'],function(_0x1e1b5d){const _0x15485f=_0x374e27;if(_0x15485f(0x1ae)===_0x15485f(0x1ae)){const _0xe464ca={'cert':fs[_0x15485f(0x185)](__dirname+'/test-auth0.pem'),'key':fs[_0x15485f(0x185)](_0x31c9bc[_0x15485f(0x1e3)](__dirname,_0x15485f(0x13f))),'issuer':_0x15485f(0x1bb),'lifetimeInSeconds':0x258,'audiences':_0x31c9bc[_0x15485f(0x171)],'attributes':{'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress':_0x31c9bc[_0x15485f(0x15f)],'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name':_0x31c9bc['Cenga']},'nameIdentifier':_0x15485f(0x1cd),'nameIdentifierFormat':_0x15485f(0x158)},_0x1e731e=saml20[_0x15485f(0x144)](_0xe464ca),_0x3d062d=fs['readFileSync'](__dirname+'/test-auth0.cer')[_0x15485f(0x1a8)](),_0xdfb37a=new SamlPassport({'cert':_0x3d062d,'realm':_0x31c9bc[_0x15485f(0x171)],'checkRecipient':![]});_0xdfb37a[_0x15485f(0x152)](_0x1e731e,function(_0x1acacb,_0x4e9b00){const _0x16bc98=_0x15485f,_0x1ec138=_0x16bc98(0x143)[_0x16bc98(0x1a7)]('|');let _0x4bb622=0x0;while(!![]){switch(_0x1ec138[_0x4bb622++]){case'0':setTimeout(_0x31c9bc['eLHBv'],0x3e8);continue;case'1':assert['ok'](_0x4e9b00);continue;case'2':_0x31c9bc['LJsOX'](_0x1e1b5d);continue;case'3':assert[_0x16bc98(0x1ad)](_0x31c9bc[_0x16bc98(0x156)],_0x4e9b00[_0x31c9bc['AvFPi']]);continue;case'4':if(_0x1acacb)return _0x31c9bc['HOwXV'](_0x1e1b5d,_0x1acacb);continue;}break;}});}else _0x28757b(_0x18b461)['to'][_0x15485f(0x169)],_0x344f7e(_0x174132['message'])['to'][_0x15485f(0x1ad)](_0x31c9bc[_0x15485f(0x1cf)]),_0xea613a(_0x4d0ee8)['to'][_0x15485f(0x166)][_0x15485f(0x169)],_0x189033();}),it('should\x20fail\x20when\x20the\x20X509Certificate\x20is\x20invalid',function(_0xe233ef){const _0x5f368c=_0x374e27,_0x44f86c={'xJreO':_0x5f368c(0x190),'PxhaK':'The\x20signing\x20certificate\x20is\x20invalid\x20(error:0906700D:PEM\x20routines:PEM_ASN1_read_bio:ASN1\x20lib,\x20error:0D07803A:asn1\x20encoding\x20routines:ASN1_ITEM_EX_D2I:nested\x20asn1\x20error,\x20error:0D068066:asn1\x20encoding\x20routines:ASN1_CHECK_TLEN:bad\x20object\x20header)','uTRoT':_0x31c9bc['JLIJp'],'RqFoq':_0x5f368c(0x1b4),'IuVdQ':_0x31c9bc[_0x5f368c(0x1cc)]},_0x482c18=fs[_0x5f368c(0x185)](__dirname+_0x5f368c(0x1c8))[_0x5f368c(0x1a8)](),_0x1893f7={'checkDestination':![],'thumbprint':_0x31c9bc[_0x5f368c(0x1d4)]},_0x5af710=new SamlPassport(_0x1893f7);_0x5af710[_0x5f368c(0x152)](_0x482c18,function(_0x2f361a,_0x279024){const _0x1137d1=_0x5f368c;expect(_0x2f361a)['to'][_0x1137d1(0x169)];const _0x346fae=[_0x44f86c[_0x1137d1(0x164)],_0x44f86c[_0x1137d1(0x1aa)],_0x44f86c['uTRoT'],_0x44f86c[_0x1137d1(0x1af)]];assert['ok'](_0x2f361a,_0x44f86c[_0x1137d1(0x162)]),assert['ok'](_0x346fae[_0x1137d1(0x1cb)](_0x2f361a[_0x1137d1(0x181)]),_0x1137d1(0x150)),_0xe233ef();});}),describe(_0x374e27(0x1e4),function(){const _0x499919=_0x374e27,_0xe34375={'vgJKx':function(_0x39494f,_0x3979d3){const _0x29aaf3=_0x7700;return _0x31c9bc[_0x29aaf3(0x1d8)](_0x39494f,_0x3979d3);},'dAfBK':_0x31c9bc[_0x499919(0x171)],'KkTcn':_0x31c9bc[_0x499919(0x193)]};_0x31c9bc[_0x499919(0x194)]==='PUavO'?(_0x31c9bc[_0x499919(0x1bf)](it,_0x499919(0x15d),function(_0xcd44a3){const _0xdce5e2=_0x499919,_0x1a1ac9=_0xdce5e2(0x1ba),_0x193ac3=fs['readFileSync'](_0xe34375[_0xdce5e2(0x195)](__dirname,_0xdce5e2(0x163)))[_0xdce5e2(0x1a8)](),_0x421c97=new SamlPassport({'cert':_0x193ac3,'realm':_0xe34375['dAfBK'],'checkRecipient':![]});_0x421c97[_0xdce5e2(0x152)](_0x1a1ac9,function(_0x34d7dc,_0xe1c4d3){const _0x37a878=_0xdce5e2;assert['ok'](_0x34d7dc),assert['ok'](!_0xe1c4d3),assert[_0x37a878(0x1ad)](_0x34d7dc[_0x37a878(0x181)],_0x37a878(0x1ce)),_0xcd44a3();});}),it(_0x31c9bc[_0x499919(0x17f)],function(_0x35ecf2){const _0x2e635a=_0x499919,_0x5d44aa=_0x2e635a(0x176),_0x1d094f=fs[_0x2e635a(0x185)](__dirname+_0x2e635a(0x163))[_0x2e635a(0x1a8)](),_0x2c8078=new SamlPassport({'cert':_0x1d094f,'realm':_0xe34375[_0x2e635a(0x188)],'checkRecipient':![]});_0x2c8078[_0x2e635a(0x152)](_0x5d44aa,function(_0x302eeb,_0x132ebb){const _0x42d313=_0x2e635a;assert['ok'](_0x302eeb),assert['ok'](!_0x132ebb),assert['equal'](_0x302eeb['message'],_0x42d313(0x1b7)),_0x35ecf2();});})):(_0x23d237['ok'](_0x5ee4a2),_0x55be70['ok'](!_0x275925),_0x3a1823[_0x499919(0x1ad)](_0x1b9669[_0x499919(0x181)],_0xe34375[_0x499919(0x146)]),_0x1840d0());}),text[_0x374e27(0x14d)](/[0-9]+/);});