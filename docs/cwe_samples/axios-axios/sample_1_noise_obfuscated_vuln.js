const _0x9e7ddf=_0x2823;function _0x55fd(){const _0x100e75=['QSTLx','205027ftoocg','encrypt/decrypt','payload','value','DzBce','8vTMwIP','\x22exp\x22\x20claim\x20timestamp\x20check\x20failed','should\x20fail\x20to\x20decrypt\x20a\x20payload\x20with\x20the\x20incorrect\x20secret','objectContaining','should\x20encrypt/decrypt\x20a\x20payload\x20with\x20the\x20correct\x20secret','322168norJzB','7967736ictFkV','YCRiI','86916KjtyyO','MqedP','nQHVV','toEqual','BSSHw','2077630VVcdfC','YupEV','634DhTNeL','rejects','97794DHzQPV','wgPnD','floor','toThrowError','now','3735rbEBzz','ueLtn','should\x20fail\x20to\x20encrypt\x20if\x20a\x20secret\x20is\x20not\x20provided'];_0x55fd=function(){return _0x100e75;};return _0x55fd();}function _0x2823(_0x18ef0c,_0x5bb2f6){const _0x55fd46=_0x55fd();return _0x2823=function(_0x2823ef,_0x20e1f2){_0x2823ef=_0x2823ef-0x132;let _0x5189f6=_0x55fd46[_0x2823ef];return _0x5189f6;},_0x2823(_0x18ef0c,_0x5bb2f6);}(function(_0x554c40,_0x6157eb){const _0x39420b=_0x2823,_0x1abebb=_0x554c40();while(!![]){try{const _0x5d99bc=parseInt(_0x39420b(0x143))/0x1+parseInt(_0x39420b(0x138))/0x2*(parseInt(_0x39420b(0x13f))/0x3)+parseInt(_0x39420b(0x150))/0x4+parseInt(_0x39420b(0x136))/0x5+parseInt(_0x39420b(0x13a))/0x6+parseInt(_0x39420b(0x14d))/0x7+parseInt(_0x39420b(0x148))/0x8*(-parseInt(_0x39420b(0x14e))/0x9);if(_0x5d99bc===_0x6157eb)break;else _0x1abebb['push'](_0x1abebb['shift']());}catch(_0x421b1e){_0x1abebb['push'](_0x1abebb['shift']());}}}(_0x55fd,0x343ce));import{describe,expect,it}from'vitest';import{generateSecret}from'../test/utils';import{decrypt,encrypt}from'./cookies';describe(_0x9e7ddf(0x144),async()=>{const _0x410da9=_0x9e7ddf,_0x2dfe1c={'DzBce':_0x410da9(0x146),'vImYx':function(_0x598639,_0x286822){return _0x598639*_0x286822;},'YupEV':function(_0x64c8f5,_0x3bd0b8){return _0x64c8f5+_0x3bd0b8;},'MqedP':function(_0x1e2442,_0x49381f){return _0x1e2442/_0x49381f;},'ZpsVE':function(_0xaa8037,_0xbf395){return _0xaa8037(_0xbf395);},'wgPnD':function(_0x294ef1,_0x3c2f0f){return _0x294ef1/_0x3c2f0f;},'YCRiI':function(_0x11c683,_0x3b125e){return _0x11c683(_0x3b125e);},'fvILx':function(_0x2f6850,_0x108a39){return _0x2f6850*_0x108a39;},'ueLtn':function(_0x4a649f,_0x5aabe2){return _0x4a649f+_0x5aabe2;},'Ogena':function(_0x110a5c,_0x46fbe0){return _0x110a5c*_0x46fbe0;},'nQHVV':function(_0xc26a15,_0x5a7fb4){return _0xc26a15+_0x5a7fb4;},'QKMyV':function(_0x246f92,_0xcce61){return _0x246f92(_0xcce61);},'QSTLx':_0x410da9(0x14a),'TBpcN':'should\x20fail\x20to\x20decrypt\x20when\x20expired','BSSHw':function(_0x5c10f9,_0x5c9052,_0x249ece){return _0x5c10f9(_0x5c9052,_0x249ece);}},_0x2d85f5=await _0x2dfe1c['QKMyV'](generateSecret,0x20),_0x35d59a=await generateSecret(0x20);it(_0x410da9(0x14c),async()=>{const _0x418f01=_0x410da9,_0x1b0c48={'key':_0x2dfe1c['DzBce']},_0x4e54e3=_0x2dfe1c['vImYx'](0x3c,0x3c),_0x47952a=Math[_0x418f01(0x13c)](_0x2dfe1c[_0x418f01(0x137)](_0x2dfe1c[_0x418f01(0x132)](Date[_0x418f01(0x13e)](),0x3e8),_0x4e54e3)),_0x4716c1=await encrypt(_0x1b0c48,_0x2d85f5,_0x47952a),_0x410824=await decrypt(_0x4716c1,_0x2d85f5);_0x2dfe1c['ZpsVE'](expect,_0x410824[_0x418f01(0x145)])[_0x418f01(0x134)](expect[_0x418f01(0x14b)](_0x1b0c48));}),it(_0x2dfe1c[_0x410da9(0x142)],async()=>{const _0x4d7815=_0x410da9,_0x248f26={'key':_0x4d7815(0x146)},_0x13d670=0x3c*0x3c,_0x183572=Math[_0x4d7815(0x13c)](Date[_0x4d7815(0x13e)]()/0x3e8+_0x13d670),_0x2dc471=await encrypt(_0x248f26,_0x2d85f5,_0x183572);await expect(()=>decrypt(_0x2dc471,_0x35d59a))[_0x4d7815(0x139)][_0x4d7815(0x13d)]();}),it(_0x2dfe1c['TBpcN'],async()=>{const _0x3d9093=_0x410da9,_0x2ab743={'key':_0x2dfe1c[_0x3d9093(0x147)]},_0x4a93ef=Math[_0x3d9093(0x13c)](_0x2dfe1c[_0x3d9093(0x13b)](Date[_0x3d9093(0x13e)](),0x3e8)-0x3c),_0x3b3c3b=await encrypt(_0x2ab743,_0x2d85f5,_0x4a93ef);await _0x2dfe1c[_0x3d9093(0x14f)](expect,()=>decrypt(_0x3b3c3b,_0x2d85f5))[_0x3d9093(0x139)]['toThrowError'](_0x3d9093(0x149));}),_0x2dfe1c[_0x410da9(0x135)](it,_0x410da9(0x141),async()=>{const _0x2fb9c6=_0x410da9,_0x20ab85={'key':_0x2fb9c6(0x146)},_0x386810=_0x2dfe1c['fvILx'](0x3c,0x3c),_0x327609=Math[_0x2fb9c6(0x13c)](_0x2dfe1c[_0x2fb9c6(0x140)](Date['now']()/0x3e8,_0x386810));await _0x2dfe1c['YCRiI'](expect,()=>encrypt(_0x20ab85,'',_0x327609))[_0x2fb9c6(0x139)][_0x2fb9c6(0x13d)]();}),_0x2dfe1c[_0x410da9(0x135)](it,'should\x20fail\x20to\x20decrypt\x20if\x20a\x20secret\x20is\x20not\x20provided',async()=>{const _0x16ad5e=_0x410da9,_0x46ba2f={'key':_0x16ad5e(0x146)},_0x359f04=_0x2dfe1c['Ogena'](0x3c,0x3c),_0x5b1adc=Math[_0x16ad5e(0x13c)](_0x2dfe1c[_0x16ad5e(0x133)](Date['now']()/0x3e8,_0x359f04)),_0x55d1bf=await encrypt(_0x46ba2f,_0x2d85f5,_0x5b1adc);await expect(()=>decrypt(_0x55d1bf,''))[_0x16ad5e(0x139)]['toThrowError']();});});