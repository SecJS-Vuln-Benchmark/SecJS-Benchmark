const _0x5ef122=_0xd17d;(function(_0x2d8701,_0x123937){const _0x2034ca=_0xd17d,_0x3e2695=_0x2d8701();while(!![]){try{const _0x55d801=-parseInt(_0x2034ca(0x12b))/0x1*(parseInt(_0x2034ca(0x149))/0x2)+-parseInt(_0x2034ca(0x11c))/0x3*(-parseInt(_0x2034ca(0x114))/0x4)+parseInt(_0x2034ca(0x138))/0x5*(parseInt(_0x2034ca(0x121))/0x6)+-parseInt(_0x2034ca(0x116))/0x7*(parseInt(_0x2034ca(0x133))/0x8)+parseInt(_0x2034ca(0x139))/0x9*(parseInt(_0x2034ca(0x12c))/0xa)+-parseInt(_0x2034ca(0x147))/0xb*(parseInt(_0x2034ca(0x106))/0xc)+parseInt(_0x2034ca(0x13c))/0xd;if(_0x55d801===_0x123937)break;else _0x3e2695['push'](_0x3e2695['shift']());}catch(_0x4c73f8){_0x3e2695['push'](_0x3e2695['shift']());}}}(_0x2ec9,0x6a8ec));function _0xd17d(_0x56b432,_0x1fc6bd){const _0x2ec94f=_0x2ec9();return _0xd17d=function(_0xd17de9,_0x4c5e11){_0xd17de9=_0xd17de9-0x104;let _0x1ab8e5=_0x2ec94f[_0xd17de9];return _0x1ab8e5;},_0xd17d(_0x56b432,_0x1fc6bd);}function _0x2ec9(){const _0x7d792e=['swaVT','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','VrNTJ','utf-8','SAML\x20response\x20tests','2704812deGQZn','./test/static/saml_external_ns.pem','372bdNqUw','assertIsNodeLike','PUuRL','36XdDdsm','fvkMO','aawvR','signature\x20wrapping\x20attack.','test\x20validating\x20wrapped\x20assertion\x20signature','//*[local-name(.)=\x27Assertion\x27]','kpgzk','aaBfZ','./test/static/saml_external_ns.xml','IJePk','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','diYEv','jWPfc','test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element','8AlbzWJ','hqEcr','7tzNzIO','cZPpr','Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20','throw','bXzvI','pGtcP','1148379dRTuBB','publicCert','./test/static/valid_saml_withcomments.xml','VmZOq','GwzmA','144fUXvlQ','rErCp','test\x20validating\x20SAML\x20response','parseFromString','test\x20validating\x20SAML\x20response\x20WithComments','wYOVr','readFileSync','jVNZG','TfYrd','loadSignature','2573NrxEwe','40410YyEylv','./test/static/id_with_quotes.xml','./test/static/feide_public.pem','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','DOMParser','true','select1','1136664YPGpil','dMUWE','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','id\x20should\x20not\x20contain\x20quotes','exqdp','84640QxUKnx','630HkMISa','checkSignature','./test/static/valid_saml.xml','4420897XTJjVu','bypEt','zYGqw','cQfit','yhoVg','./test/static/valid_saml_signature_wrapping.xml'];_0x2ec9=function(){return _0x7d792e;};return _0x2ec9();}import{SignedXml}from'../src/index';import*as _0x478210 from'xpath';import*as _0x8caceb from'@xmldom/xmldom';import*as _0x375b41 from'fs';import{expect}from'chai';import*as _0x27e5d5 from'@xmldom/is-dom-node';describe(_0x5ef122(0x146),function(){const _0x20defb=_0x5ef122,_0x3ca748={'jVNZG':function(_0x305725,_0x50dae0){return _0x305725===_0x50dae0;},'oTDLD':_0x20defb(0x120),'exqdp':_0x20defb(0x12e),'TfYrd':function(_0x599d84,_0x179511){return _0x599d84(_0x179511);},'VrNTJ':_0x20defb(0x141),'bypEt':_0x20defb(0x145),'bXzvI':function(_0xcc4075,_0x51f6b8,_0x503c1a){return _0xcc4075(_0x51f6b8,_0x503c1a);},'zYGqw':function(_0x50cd48,_0x2201df){return _0x50cd48+_0x2201df;},'jWPfc':_0x20defb(0x110),'hqEcr':function(_0x2e71a9,_0x3bcfa3){return _0x2e71a9(_0x3bcfa3);},'qhcRC':_0x20defb(0x12f),'FvfAb':function(_0x3d1585,_0x89836b,_0x3fd28a){return _0x3d1585(_0x89836b,_0x3fd28a);},'mFuZB':'id\x20should\x20not\x20contain\x20quotes','cZPpr':_0x20defb(0x140),'pGtcP':_0x20defb(0x12d),'diYEv':function(_0x27922b,_0x1b4c62){return _0x27922b(_0x1b4c62);},'dMUWE':'oVPTB','rErCp':function(_0x1ea5fe,_0x9155af,_0x5a2083){return _0x1ea5fe(_0x9155af,_0x5a2083);},'PUuRL':_0x20defb(0x123),'wYOVr':function(_0x387e65,_0x11ea39,_0x4cf3af){return _0x387e65(_0x11ea39,_0x4cf3af);},'bLQJn':_0x20defb(0x113)};_0x3ca748[_0x20defb(0x122)](it,_0x3ca748[_0x20defb(0x105)],function(){const _0x2e1715=_0x20defb;if(_0x3ca748[_0x2e1715(0x128)](_0x3ca748['oTDLD'],_0x2e1715(0x120))){const _0x46dbb5=_0x375b41[_0x2e1715(0x127)](_0x2e1715(0x13b),_0x2e1715(0x145)),_0x34391f=new _0x8caceb[(_0x2e1715(0x130))]()[_0x2e1715(0x124)](_0x46dbb5),_0x10a848=_0x478210['select1'](_0x2e1715(0x143),_0x34391f);_0x27e5d5[_0x2e1715(0x104)](_0x10a848);const _0x3c1d7d=new SignedXml();_0x3c1d7d[_0x2e1715(0x11d)]=_0x375b41['readFileSync'](_0x3ca748[_0x2e1715(0x137)]),_0x3c1d7d[_0x2e1715(0x12a)](_0x10a848);const _0x57cbbd=_0x3c1d7d['checkSignature'](_0x46dbb5);_0x3ca748[_0x2e1715(0x129)](expect,_0x57cbbd)['to']['be'][_0x2e1715(0x131)];}else _0x5ca94b['checkSignature'](_0x398fae);}),_0x3ca748[_0x20defb(0x126)](it,_0x20defb(0x10a),function(){const _0x4c6f51=_0x20defb,_0x3d0fce=_0x375b41[_0x4c6f51(0x127)](_0x3ca748[_0x4c6f51(0x144)],_0x3ca748[_0x4c6f51(0x13d)]),_0x421255=new _0x8caceb['DOMParser']()['parseFromString'](_0x3d0fce),_0xf8778d=_0x478210[_0x4c6f51(0x132)]('//*[local-name(.)=\x27Assertion\x27]',_0x421255);_0x27e5d5[_0x4c6f51(0x104)](_0xf8778d);const _0x60cd2d=_0x478210[_0x4c6f51(0x132)](_0x4c6f51(0x12f),_0xf8778d);_0x27e5d5[_0x4c6f51(0x104)](_0x60cd2d);const _0x3bfb5e=new SignedXml();_0x3bfb5e['publicCert']=_0x375b41[_0x4c6f51(0x127)](_0x3ca748[_0x4c6f51(0x137)]),_0x3bfb5e[_0x4c6f51(0x12a)](_0x60cd2d),_0x3ca748[_0x4c6f51(0x11a)](expect,function(){const _0xfa07a3=_0x4c6f51;_0x3bfb5e[_0xfa07a3(0x13a)](_0x3d0fce);},_0x3ca748[_0x4c6f51(0x13e)](_0x4c6f51(0x118),'same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20')+_0x4c6f51(0x109))['to'][_0x4c6f51(0x119)]();}),_0x3ca748[_0x20defb(0x126)](it,_0x3ca748['bLQJn'],function(){const _0x2cda66=_0x20defb,_0x5e0cbd=_0x375b41[_0x2cda66(0x127)](_0x2cda66(0x10e),'utf-8'),_0x3e9a79=new _0x8caceb[(_0x2cda66(0x130))]()[_0x2cda66(0x124)](_0x5e0cbd),_0x2a5991=_0x478210[_0x2cda66(0x132)](_0x3ca748[_0x2cda66(0x112)],_0x3e9a79);_0x27e5d5[_0x2cda66(0x104)](_0x2a5991);const _0x5c1183=new SignedXml();_0x5c1183[_0x2cda66(0x11d)]=_0x375b41['readFileSync'](_0x2cda66(0x148)),_0x5c1183[_0x2cda66(0x12a)](_0x2a5991);const _0x2060fe=_0x5c1183[_0x2cda66(0x13a)](_0x5e0cbd);_0x3ca748[_0x2cda66(0x115)](expect,_0x2060fe)['to']['be']['true'];}),it(_0x20defb(0x135),function(){const _0x23f9f6=_0x20defb,_0x565db={'swaVT':_0x23f9f6(0x145),'KhANF':_0x3ca748['qhcRC'],'rZwpq':_0x3ca748[_0x23f9f6(0x137)],'IJePk':function(_0x512a34,_0xa10ed4,_0x3a65fb){return _0x3ca748['FvfAb'](_0x512a34,_0xa10ed4,_0x3a65fb);},'kpgzk':_0x3ca748['mFuZB'],'aawvR':_0x23f9f6(0x107),'aaBfZ':_0x3ca748[_0x23f9f6(0x117)]},_0x4bce88=_0x375b41[_0x23f9f6(0x127)](_0x3ca748[_0x23f9f6(0x11b)],_0x23f9f6(0x145)),_0x584d88=new _0x8caceb[(_0x23f9f6(0x130))]()['parseFromString'](_0x4bce88),_0x43c9ca=_0x478210['select1'](_0x23f9f6(0x10b),_0x584d88);_0x27e5d5[_0x23f9f6(0x104)](_0x43c9ca);const _0x66cf83=_0x478210[_0x23f9f6(0x132)](_0x23f9f6(0x12f),_0x43c9ca);_0x27e5d5[_0x23f9f6(0x104)](_0x66cf83);const _0x5946cf=new SignedXml();_0x5946cf[_0x23f9f6(0x11d)]=_0x375b41[_0x23f9f6(0x127)](_0x23f9f6(0x12e)),_0x5946cf[_0x23f9f6(0x12a)](_0x66cf83),expect(function(){const _0x4fc774=_0x23f9f6;if(_0x565db[_0x4fc774(0x108)]!==_0x565db[_0x4fc774(0x10d)])_0x5946cf[_0x4fc774(0x13a)](_0x4bce88);else{const _0x17cc26=_0x11e6a5[_0x4fc774(0x127)]('./test/static/id_with_quotes.xml',_0x565db[_0x4fc774(0x142)]),_0x2b4e0c=new _0x1cf6a6[(_0x4fc774(0x130))]()['parseFromString'](_0x17cc26),_0x2c19a5=_0x28ff52[_0x4fc774(0x132)](_0x4fc774(0x10b),_0x2b4e0c);_0x23b9a2['assertIsNodeLike'](_0x2c19a5);const _0x46b27e=_0x147c79['select1'](_0x565db['KhANF'],_0x2c19a5);_0x624c99[_0x4fc774(0x104)](_0x46b27e);const _0x440c2c=new _0x442268();_0x440c2c[_0x4fc774(0x11d)]=_0x1a642e[_0x4fc774(0x127)](_0x565db['rZwpq']),_0x440c2c['loadSignature'](_0x46b27e),_0x565db[_0x4fc774(0x10f)](_0x567242,function(){const _0xe585f=_0x4fc774;_0x440c2c[_0xe585f(0x13a)](_0x17cc26);},_0x565db[_0x4fc774(0x10c)])['to'][_0x4fc774(0x119)]();}},_0x23f9f6(0x136))['to'][_0x23f9f6(0x119)]();}),it(_0x20defb(0x125),function(){const _0xdb82c3=_0x20defb,_0x2fbd60={'LNrYk':_0xdb82c3(0x11e),'cQfit':_0x3ca748[_0xdb82c3(0x137)],'VmZOq':function(_0x496312,_0x5d74a9){const _0x1c3f3f=_0xdb82c3;return _0x3ca748[_0x1c3f3f(0x111)](_0x496312,_0x5d74a9);}};if(_0x3ca748[_0xdb82c3(0x134)]!==_0x3ca748[_0xdb82c3(0x134)]){const _0x279968=_0x5b5d04['readFileSync'](_0x2fbd60['LNrYk'],_0xdb82c3(0x145)),_0x36b155=new _0x361f15['DOMParser']()[_0xdb82c3(0x124)](_0x279968),_0x3ebc68=_0x422142[_0xdb82c3(0x132)](_0xdb82c3(0x143),_0x36b155);_0x136b84[_0xdb82c3(0x104)](_0x3ebc68);const _0x3d620a=new _0xec23f4();_0x3d620a[_0xdb82c3(0x11d)]=_0xe93078[_0xdb82c3(0x127)](_0x2fbd60[_0xdb82c3(0x13f)]),_0x3d620a[_0xdb82c3(0x12a)](_0x3ebc68),_0x2fbd60[_0xdb82c3(0x11f)](_0x509a1b,()=>_0x3d620a[_0xdb82c3(0x13a)](_0x279968))['to']['throw'](/^invalid signature/);}else{const _0x5724a8=_0x375b41['readFileSync'](_0xdb82c3(0x11e),_0x3ca748['bypEt']),_0x52177d=new _0x8caceb[(_0xdb82c3(0x130))]()[_0xdb82c3(0x124)](_0x5724a8),_0x2be8a8=_0x478210['select1']('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x52177d);_0x27e5d5['assertIsNodeLike'](_0x2be8a8);const _0x5360b2=new SignedXml();_0x5360b2[_0xdb82c3(0x11d)]=_0x375b41[_0xdb82c3(0x127)](_0x3ca748[_0xdb82c3(0x137)]),_0x5360b2[_0xdb82c3(0x12a)](_0x2be8a8),_0x3ca748[_0xdb82c3(0x129)](expect,()=>_0x5360b2[_0xdb82c3(0x13a)](_0x5724a8))['to']['throw'](/^invalid signature/);}});});