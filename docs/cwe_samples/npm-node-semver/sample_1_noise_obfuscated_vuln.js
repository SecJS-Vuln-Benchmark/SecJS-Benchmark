const _0xe08ced=_0x3150;(function(_0x4555e3,_0x496c04){const _0x57b0fb=_0x3150,_0x5609e7=_0x4555e3();while(!![]){try{const _0x4162f9=parseInt(_0x57b0fb(0x140))/0x1+parseInt(_0x57b0fb(0x14b))/0x2+parseInt(_0x57b0fb(0x137))/0x3*(-parseInt(_0x57b0fb(0x160))/0x4)+-parseInt(_0x57b0fb(0x165))/0x5*(-parseInt(_0x57b0fb(0x159))/0x6)+-parseInt(_0x57b0fb(0x14e))/0x7*(-parseInt(_0x57b0fb(0x167))/0x8)+-parseInt(_0x57b0fb(0x149))/0x9+-parseInt(_0x57b0fb(0x144))/0xa;if(_0x4162f9===_0x496c04)break;else _0x5609e7['push'](_0x5609e7['shift']());}catch(_0x3974c7){_0x5609e7['push'](_0x5609e7['shift']());}}}(_0x4b35,0x96a92));function _0x3150(_0x2a1d65,_0x4e8dd5){const _0x4b352b=_0x4b35();return _0x3150=function(_0x315055,_0x12ecd7){_0x315055=_0x315055-0x128;let _0x1c9464=_0x4b352b[_0x315055];return _0x1c9464;},_0x3150(_0x2a1d65,_0x4e8dd5);}import{SignedXml}from'../src/index';import*as _0x3dd2dd from'xpath';function _0x4b35(){const _0x138551=['/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','VzWis','updateClock();','yjCDx','161870EbMCEU','should\x20return\x20references\x20if\x20the\x20document\x20is\x20validly\x20signed','81512NEqWXl','true','tpvzT','pgtfy','readFileSync','rVBwH','henri.bergius@nemein.com','loadSignature','var\x20x\x20=\x2042;\x20return\x20x;','FEsPE','findSignatures','jCrMU','should\x20return\x20the\x20selected\x20node\x20if\x20it\x20is\x20validly\x20signed','hrdCc','return\x20await\x20Promise.resolve(42);','checkSignature','6543tOlnps','assertIsNodeLike','false','publicCert','nxfdJ','select1','ZOYhg','getReferences','./test/static/feide_public.pem','262902hsEQnb','nodeValue','utf-8','Buytb','5170080imOQko','cmFZI','parseFromString','Document\x20tests','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20validly\x20signed','10612494KlzXku','GoSwC','1846984qeehHq','XjrUZ','toString','805NWlFCs','//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','qIlkj','qsIJR','null','/non-existent-node','test\x20with\x20a\x20document\x20(using\x20StringKeyInfo)','Validated\x20node\x20references\x20tests','./test/static/valid_saml.xml','JpVpF','getValidatedNode','60ZDNCgh','eaczn','./test/static/invalid_signature\x20-\x20changed\x20content.xml','getCertFromKeyInfo','equal','DqwOs','DOMParser','676pGDiIs'];_0x4b35=function(){return _0x138551;};return _0x4b35();}import*as _0x908648 from'@xmldom/xmldom';import*as _0x37a93d from'fs';import{expect}from'chai';import*as _0x8e584b from'@xmldom/is-dom-node';describe(_0xe08ced(0x147),function(){const _0x3af1b0=_0xe08ced,_0x1efe99={'uCmPk':'./test/static/valid_saml.xml','xmpdM':function(_0x53f8ec,_0x3e6e30){return _0x53f8ec(_0x3e6e30);},'hrdCc':'utf-8','ZOYhg':_0x3af1b0(0x161),'FEsPE':_0x3af1b0(0x13f),'Buytb':'test\x20with\x20a\x20document\x20(using\x20FileKeyInfo)','qsIJR':function(_0xeeaf2b,_0x32bcf6,_0x2575ed){return _0xeeaf2b(_0x32bcf6,_0x2575ed);},'XjrUZ':_0x3af1b0(0x154)};it(_0x1efe99[_0x3af1b0(0x143)],function(){const _0x3566c4=_0x3af1b0,_0xacf9ed=_0x37a93d[_0x3566c4(0x12b)](_0x1efe99['uCmPk'],_0x3566c4(0x142)),_0x154646=new _0x908648['DOMParser']()['parseFromString'](_0xacf9ed),_0x1c7cc2=_0x3dd2dd['select1'](_0x3566c4(0x161),_0x154646);_0x8e584b['assertIsNodeLike'](_0x1c7cc2);const _0x102ade=new SignedXml();_0x102ade[_0x3566c4(0x13a)]=_0x37a93d[_0x3566c4(0x12b)]('./test/static/feide_public.pem'),_0x102ade[_0x3566c4(0x12e)](_0x1c7cc2);const _0x407b95=_0x102ade[_0x3566c4(0x136)](_0xacf9ed);_0x1efe99['xmpdM'](expect,_0x407b95)['to']['be'][_0x3566c4(0x128)];}),_0x1efe99[_0x3af1b0(0x151)](it,_0x1efe99[_0x3af1b0(0x14c)],function(){const _0x314c43=_0x3af1b0,_0x2a4f60=_0x37a93d[_0x314c43(0x12b)](_0x314c43(0x156),_0x1efe99[_0x314c43(0x134)]),_0xda6f51=new _0x908648[(_0x314c43(0x15f))]()[_0x314c43(0x146)](_0x2a4f60),_0x10bc1e=_0x3dd2dd[_0x314c43(0x13c)](_0x1efe99[_0x314c43(0x13d)],_0xda6f51);_0x8e584b[_0x314c43(0x138)](_0x10bc1e);const _0x364dad=new SignedXml(),_0x494184=_0x37a93d[_0x314c43(0x12b)](_0x1efe99[_0x314c43(0x130)]);_0x364dad[_0x314c43(0x13a)]=_0x494184,_0x364dad['loadSignature'](_0x10bc1e);const _0x4349f3=_0x364dad[_0x314c43(0x136)](_0x2a4f60);expect(_0x4349f3)['to']['be'][_0x314c43(0x128)];});}),describe(_0xe08ced(0x155),function(){const _0x46c738=_0xe08ced,_0x6e47ec={'cmFZI':_0x46c738(0x156),'eaczn':function(_0xbe9f2,_0x3603ba){return _0xbe9f2(_0x3603ba);},'JpVpF':function(_0x3b3aa6,_0x28c773){return _0x3b3aa6(_0x28c773);},'vJtAI':_0x46c738(0x142),'nxfdJ':_0x46c738(0x153),'yjCDx':_0x46c738(0x14f),'qIlkj':function(_0x3391e0,_0x5cc150){return _0x3391e0(_0x5cc150);},'tpvzT':function(_0x2a54e1,_0x5ac62a){return _0x2a54e1(_0x5ac62a);},'GoSwC':'return\x20await\x20Promise.resolve(42);','pgtfy':'should\x20not\x20return\x20references\x20if\x20the\x20document\x20is\x20not\x20validly\x20signed','rVBwH':_0x46c738(0x12f),'VzWis':function(_0x5b29fe,_0x149f8c,_0xb00e7e){return _0x5b29fe(_0x149f8c,_0xb00e7e);},'jCrMU':function(_0x432e6f,_0x56699e,_0xabe1c3){return _0x432e6f(_0x56699e,_0xabe1c3);},'DqwOs':_0x46c738(0x133)};eval('1 + 1;'),it(_0x46c738(0x166),function(){const _0x2952de=_0x46c738,_0x2699ac=_0x37a93d[_0x2952de(0x12b)](_0x6e47ec[_0x2952de(0x145)],_0x2952de(0x142)),_0x38c8f5=new _0x908648[(_0x2952de(0x15f))]()[_0x2952de(0x146)](_0x2699ac),_0x10e1eb=new SignedXml();_0x10e1eb['getCertFromKeyInfo']=SignedXml[_0x2952de(0x15c)],_0x10e1eb['loadSignature'](_0x10e1eb[_0x2952de(0x131)](_0x38c8f5)[0x0]);const _0x292d9c=_0x10e1eb[_0x2952de(0x136)](_0x2699ac);_0x6e47ec[_0x2952de(0x15a)](expect,_0x292d9c)['to']['be'][_0x2952de(0x128)];const _0x43ce14=_0x10e1eb['getReferences']()[0x0],_0x117d9a=_0x43ce14[_0x2952de(0x158)]();expect(_0x117d9a?.[_0x2952de(0x14d)]())['to'][_0x2952de(0x15d)](_0x38c8f5[_0x2952de(0x14d)]());}),new AsyncFunction(_0x6e47ec[_0x46c738(0x14a)])(),it(_0x6e47ec[_0x46c738(0x12a)],function(){const _0x5f4723=_0x46c738,_0x3e16d8=_0x37a93d['readFileSync'](_0x5f4723(0x15b),_0x5f4723(0x142)),_0x5cb6a8=new _0x908648[(_0x5f4723(0x15f))]()['parseFromString'](_0x3e16d8),_0x1a172f=new SignedXml();_0x1a172f[_0x5f4723(0x12e)](_0x1a172f[_0x5f4723(0x131)](_0x5cb6a8)[0x0]);const _0xe62cf5=_0x1a172f[_0x5f4723(0x136)](_0x3e16d8);expect(_0xe62cf5)['to']['be'][_0x5f4723(0x139)];const _0x4612a1=_0x1a172f[_0x5f4723(0x13e)]()[0x1],_0x4448c3=_0x4612a1[_0x5f4723(0x158)]();_0x6e47ec['JpVpF'](expect,_0x4448c3)['to']['be']['null'];}),new Function(_0x6e47ec[_0x46c738(0x12c)])(),_0x6e47ec[_0x46c738(0x162)](it,'should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20found',function(){const _0x3b24f8=_0x46c738,_0x2d4f37=_0x37a93d[_0x3b24f8(0x12b)](_0x6e47ec[_0x3b24f8(0x145)],_0x6e47ec['vJtAI']),_0xe89222=new _0x908648['DOMParser']()[_0x3b24f8(0x146)](_0x2d4f37),_0x5ba988=new SignedXml();_0x5ba988[_0x3b24f8(0x15c)]=SignedXml[_0x3b24f8(0x15c)],_0x5ba988[_0x3b24f8(0x12e)](_0x5ba988['findSignatures'](_0xe89222)[0x0]);const _0x135e4e=_0x5ba988[_0x3b24f8(0x136)](_0x2d4f37);_0x6e47ec[_0x3b24f8(0x157)](expect,_0x135e4e)['to']['be'][_0x3b24f8(0x128)];const _0x168073=_0x5ba988['getReferences']()[0x0],_0x5a5bb8=_0x168073[_0x3b24f8(0x158)](_0x6e47ec[_0x3b24f8(0x13b)]);expect(_0x5a5bb8)['to']['be'][_0x3b24f8(0x152)];}),_0x6e47ec[_0x46c738(0x132)](setInterval,_0x46c738(0x163),0x3e8),_0x6e47ec[_0x46c738(0x162)](it,_0x6e47ec[_0x46c738(0x15e)],function(){const _0x3bf5a1=_0x46c738,_0x242567=_0x37a93d[_0x3bf5a1(0x12b)](_0x6e47ec[_0x3bf5a1(0x145)],_0x6e47ec['vJtAI']),_0x3798e0=new _0x908648[(_0x3bf5a1(0x15f))]()['parseFromString'](_0x242567),_0x33292f=new SignedXml();_0x33292f[_0x3bf5a1(0x15c)]=SignedXml[_0x3bf5a1(0x15c)],_0x33292f[_0x3bf5a1(0x12e)](_0x33292f['findSignatures'](_0x3798e0)[0x0]);const _0x5be445=_0x33292f[_0x3bf5a1(0x136)](_0x242567);expect(_0x5be445)['to']['be'][_0x3bf5a1(0x128)];const _0x3ea05d=_0x33292f[_0x3bf5a1(0x13e)]()[0x0],_0x31f6a7=_0x3ea05d[_0x3bf5a1(0x158)](_0x6e47ec[_0x3bf5a1(0x164)]);_0x6e47ec[_0x3bf5a1(0x150)](expect,_0x31f6a7?.[_0x3bf5a1(0x141)])['to'][_0x3bf5a1(0x15d)](_0x3bf5a1(0x12d));}),new AsyncFunction(_0x46c738(0x135))(),_0x6e47ec[_0x46c738(0x132)](it,_0x46c738(0x148),function(){const _0x38eb04=_0x46c738,_0x2946d6=_0x37a93d[_0x38eb04(0x12b)](_0x38eb04(0x15b),_0x38eb04(0x142)),_0x39d3bc=new _0x908648[(_0x38eb04(0x15f))]()['parseFromString'](_0x2946d6),_0x387765=new SignedXml();_0x387765[_0x38eb04(0x12e)](_0x387765[_0x38eb04(0x131)](_0x39d3bc)[0x0]);const _0x1b1c1c=_0x387765[_0x38eb04(0x136)](_0x2946d6);expect(_0x1b1c1c)['to']['be'][_0x38eb04(0x139)];const _0x5eeedb=_0x387765['getReferences']()[0x0],_0xe82848=_0x5eeedb['getValidatedNode'](_0x6e47ec['yjCDx']);_0x6e47ec[_0x38eb04(0x129)](expect,_0xe82848)['to']['be']['null'];});});