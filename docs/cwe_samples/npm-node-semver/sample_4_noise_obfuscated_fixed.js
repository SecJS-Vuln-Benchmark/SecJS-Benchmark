const _0x55b59f=_0x561a;(function(_0x13f132,_0x5a4d2b){const _0x418b53=_0x561a,_0x14ac9b=_0x13f132();while(!![]){try{const _0x448066=parseInt(_0x418b53(0xfc))/0x1+parseInt(_0x418b53(0x10b))/0x2+parseInt(_0x418b53(0xff))/0x3*(parseInt(_0x418b53(0x102))/0x4)+-parseInt(_0x418b53(0xe3))/0x5*(parseInt(_0x418b53(0x103))/0x6)+-parseInt(_0x418b53(0xf8))/0x7*(-parseInt(_0x418b53(0x10a))/0x8)+-parseInt(_0x418b53(0xe1))/0x9*(parseInt(_0x418b53(0xf4))/0xa)+-parseInt(_0x418b53(0x108))/0xb;if(_0x448066===_0x5a4d2b)break;else _0x14ac9b['push'](_0x14ac9b['shift']());}catch(_0x3c27b1){_0x14ac9b['push'](_0x14ac9b['shift']());}}}(_0x5ab6,0x350a7));function _0x5ab6(){const _0x9521=['signatureAlgorithm','</book>','crypto','chai','addReference','<library>','readFileSync','getSignedXml','HMAC\x20tests','1409890HcKIcI','../index','utf-8','checkSignature','35707MHdbNG','CCLNN','NutwM','</library>','68586kQdusl','tJzOq','@xmldom/xmldom','51468ApnOgz','MOByy','TfyNE','4dUwzMz','33906TkUKKG','loadSignature','enableHMAC','GzIXZ','SETsO','91421kUNXMp','select','472AOXYnz','456996kkzwuU','//*[local-name(.)=\x27book\x27]','<name>Harry\x20Potter</name>','omwsg','Usadh','parseFromString','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','true','vrDYE','./test/static/hmac.key','jmkYz','9JhgRMP','computeSignature','220DUgIIp','expect','false','test\x20validating\x20HMAC\x20signature','DOMParser','xpath','SignedXml','signingCert'];_0x5ab6=function(){return _0x9521;};return _0x5ab6();}const crypto=require(_0x55b59f(0xf5)),xpath=require(_0x55b59f(0xe8)),xmldom=require(_0x55b59f(0xfe)),fs=require('fs'),{sign}=require(_0x55b59f(0xed)),expect=require(_0x55b59f(0xee))[_0x55b59f(0xe4)];function _0x561a(_0x2bb3de,_0x2a1b4a){const _0x5ab6c4=_0x5ab6();return _0x561a=function(_0x561a24,_0x2e28e8){_0x561a24=_0x561a24-0xda;let _0x109a98=_0x5ab6c4[_0x561a24];return _0x109a98;},_0x561a(_0x2bb3de,_0x2a1b4a);}describe(_0x55b59f(0xf3),function(){const _0x278aa8=_0x55b59f,_0xa6bf55={'MOByy':'./test/static/hmac_signature.xml','omwsg':_0x278aa8(0xf6),'SETsO':'./test/static/hmac-foobar.key','tJzOq':function(_0x29888e,_0x23dffa){return _0x29888e(_0x23dffa);},'CCLNN':function(_0x7b29fe,_0x4f2a56){return _0x7b29fe+_0x4f2a56;},'AauGR':function(_0x518811,_0x45cb27){return _0x518811+_0x45cb27;},'GzIXZ':'<book>','jmkYz':_0x278aa8(0xec),'Usadh':_0x278aa8(0xfb),'TfvSD':_0x278aa8(0x10c),'vrDYE':_0x278aa8(0xdc),'NutwM':function(_0x2a5e08,_0x5eb238,_0x28cd59){return _0x2a5e08(_0x5eb238,_0x28cd59);},'PNjQP':'test\x20HMAC\x20signature\x20with\x20incorrect\x20key','TfyNE':function(_0x1f7288,_0x3a815a,_0x153557){return _0x1f7288(_0x3a815a,_0x153557);}};_0xa6bf55[_0x278aa8(0xfa)](it,_0x278aa8(0xe6),function(){const _0x392f1f=_0x278aa8,_0x12189e=fs[_0x392f1f(0xf1)](_0xa6bf55[_0x392f1f(0x100)],_0xa6bf55[_0x392f1f(0x10e)]),_0x59f74=new xmldom['DOMParser']()[_0x392f1f(0xdb)](_0x12189e),_0x5cad7b=xpath['select']('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x59f74)[0x0],_0x5c4235=new crypto['SignedXml']();_0x5c4235['enableHMAC'](),_0x5c4235[_0x392f1f(0xea)]=fs['readFileSync']('./test/static/hmac.key'),_0x5c4235['loadSignature'](_0x5cad7b);const _0x301838=_0x5c4235[_0x392f1f(0xf7)](_0x12189e);expect(_0x301838)['to']['be'][_0x392f1f(0xdd)];}),it(_0xa6bf55['PNjQP'],function(){const _0x4439ae=_0x278aa8,_0x47d1ce=fs[_0x4439ae(0xf1)](_0xa6bf55['MOByy'],_0xa6bf55[_0x4439ae(0x10e)]),_0x39056b=new xmldom[(_0x4439ae(0xe7))]()[_0x4439ae(0xdb)](_0x47d1ce),_0x57355b=xpath[_0x4439ae(0x109)](_0x4439ae(0xdc),_0x39056b)[0x0],_0x92f387=new crypto[(_0x4439ae(0xe9))]();_0x92f387[_0x4439ae(0x105)](),_0x92f387[_0x4439ae(0xea)]=fs[_0x4439ae(0xf1)](_0xa6bf55[_0x4439ae(0x107)]),_0x92f387['loadSignature'](_0x57355b);const _0x2ca2ab=_0x92f387[_0x4439ae(0xf7)](_0x47d1ce);_0xa6bf55[_0x4439ae(0xfd)](expect,_0x2ca2ab)['to']['be'][_0x4439ae(0xe5)];}),_0xa6bf55[_0x278aa8(0x101)](it,'test\x20create\x20and\x20validate\x20HMAC\x20signature',function(){const _0xa741b1=_0x278aa8,_0x32e77e=_0xa6bf55[_0xa741b1(0xf9)](_0xa6bf55['AauGR'](_0xa741b1(0xf0),_0xa6bf55[_0xa741b1(0x106)])+_0xa741b1(0x10d)+_0xa6bf55[_0xa741b1(0xe0)],_0xa6bf55[_0xa741b1(0xda)]),_0x3d6ee3=new crypto['SignedXml']();_0x3d6ee3[_0xa741b1(0x105)](),_0x3d6ee3['signingKey']=fs[_0xa741b1(0xf1)](_0xa741b1(0xdf)),_0x3d6ee3[_0xa741b1(0xeb)]='http://www.w3.org/2000/09/xmldsig#hmac-sha1',_0x3d6ee3[_0xa741b1(0xef)](_0xa6bf55['TfvSD']),_0x3d6ee3[_0xa741b1(0xe2)](_0x32e77e);const _0x2dd312=new xmldom[(_0xa741b1(0xe7))]()[_0xa741b1(0xdb)](_0x3d6ee3[_0xa741b1(0xf2)]()),_0x60be99=xpath[_0xa741b1(0x109)](_0xa6bf55[_0xa741b1(0xde)],_0x2dd312)[0x0],_0x362653=new crypto[(_0xa741b1(0xe9))]();_0x362653[_0xa741b1(0x105)](),_0x362653[_0xa741b1(0xea)]=fs[_0xa741b1(0xf1)](_0xa741b1(0xdf)),_0x362653[_0xa741b1(0x104)](_0x60be99);const _0x1db3bb=_0x362653['checkSignature'](_0x3d6ee3['getSignedXml']());_0xa6bf55[_0xa741b1(0xfd)](expect,_0x1db3bb)['to']['be'][_0xa741b1(0xdd)];});});