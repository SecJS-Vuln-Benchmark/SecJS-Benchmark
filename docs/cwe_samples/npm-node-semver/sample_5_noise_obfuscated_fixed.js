var _0x6de452=_0x1077;function _0x379b(){var _0x523381=['Cfwzk','Jklhu','uvgfu','pmozK','test\x20validating\x20SAML\x20response','readFileSync','KgNWc','182900ADWOcs','./test/static/saml_external_ns.xml','signature\x20wrapping\x20attack.','split','./test/static/valid_saml_signature_wrapping.xml','xVBLV','aIWas','yvoHH','//*[local-name(.)=\x27Assertion\x27]','144GDEHCR','xpath','YwwbC','./test/static/id_with_quotes.xml','wbLMT','select','Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20','checkSignature','throws','NjLGL','equal','./test/static/saml_external_ns.pem','8qEKPkZ','roSlf','HcFSH','EsfES','pBLem','./test/static/saml_wrapped_signed_info_node.xml','./test/static/valid_saml_withcomments.xml','mCjDc','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','DOMParser','./test/static/valid_saml_with_digest_comment.xml','./test/static/saml_multiple_signed_info_nodes.xml','724381oyVafp','loadSignature','SDBGf','hYmsH','1337307cCIVUB','5|4|7|1|3|8|6|0|2','references','vJuDi','3329250mFVOBQ','RnNjoyUguwze5w2R+cboyTHlkQk=','657856bmcFVR','./test/static/feide_public.pem','parseFromString','IwpFS','could\x20not\x20load\x20signature\x20that\x20contains\x20multiple\x20SignedInfo\x20nodes','2794071eXORmh','SignedXml','rvMOH','syblT','UACPP','keyInfoProvider','YgWtb','yVIvC','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','QPdex','same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20','KLCve','./test/static/invalid_saml_no_signed_info.xml','HyOLf','oVbHa','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','length','UZXEF','digestValue','DscFn','done','@xmldom/xmldom','vEEyd','utf-8','YDfHH','TkSHa','test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element','12XZABSa','select1','FileKeyInfo','../index','goaDk','5758746WSTirn','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','0|1|5|6|10|2|9|4|7|8|3'];_0x379b=function(){return _0x523381;};return _0x379b();}(function(_0x338102,_0x45cfec){var _0x4e253f=_0x1077,_0x14c85a=_0x338102();while(!![]){try{var _0x5f01ad=parseInt(_0x4e253f(0x1c8))/0x1+-parseInt(_0x4e253f(0x1d2))/0x2+-parseInt(_0x4e253f(0x1cc))/0x3*(parseInt(_0x4e253f(0x198))/0x4)+parseInt(_0x4e253f(0x1d0))/0x5+parseInt(_0x4e253f(0x19d))/0x6+-parseInt(_0x4e253f(0x1d7))/0x7*(-parseInt(_0x4e253f(0x1bc))/0x8)+-parseInt(_0x4e253f(0x1b0))/0x9*(parseInt(_0x4e253f(0x1a7))/0xa);if(_0x5f01ad===_0x45cfec)break;else _0x14c85a['push'](_0x14c85a['shift']());}catch(_0x3e9fde){_0x14c85a['push'](_0x14c85a['shift']());}}}(_0x379b,0xc0f1c));function _0x1077(_0x2d2305,_0x4c3aae){var _0x379bb5=_0x379b();return _0x1077=function(_0x1077bb,_0x35cb84){_0x1077bb=_0x1077bb-0x191;var _0x47187f=_0x379bb5[_0x1077bb];return _0x47187f;},_0x1077(_0x2d2305,_0x4c3aae);}var crypto=require(_0x6de452(0x19b)),xpath=require(_0x6de452(0x1b1)),xmldom=require(_0x6de452(0x192)),fs=require('fs');exports[_0x6de452(0x1a4)]=function(_0x6e886){var _0x8d3cd8=_0x6de452,_0x853ef4={'BGvIP':'./test/static/valid_saml.xml','syblT':_0x8d3cd8(0x194),'UZXEF':_0x8d3cd8(0x1df),'xVBLV':'./test/static/feide_public.pem'},_0x4462ef=fs[_0x8d3cd8(0x1a5)](_0x853ef4['BGvIP'],_0x853ef4[_0x8d3cd8(0x1da)]),_0x18860f=new xmldom['DOMParser']()['parseFromString'](_0x4462ef),_0x116ef1=xpath[_0x8d3cd8(0x1b5)](_0x853ef4[_0x8d3cd8(0x1e8)],_0x18860f)[0x0],_0x5aff18=new crypto[(_0x8d3cd8(0x1d8))]();_0x5aff18[_0x8d3cd8(0x1dc)]=new crypto[(_0x8d3cd8(0x19a))](_0x853ef4[_0x8d3cd8(0x1ac)]),_0x5aff18['loadSignature'](_0x116ef1);var _0x4a7a7c=_0x5aff18[_0x8d3cd8(0x1b7)](_0x4462ef);_0x6e886[_0x8d3cd8(0x1ba)](_0x4a7a7c,!![]),_0x6e886[_0x8d3cd8(0x191)]();},exports['test\x20validating\x20wrapped\x20assertion\x20signature']=function(_0x2880d6){var _0xabdd70=_0x6de452,_0x28259e={'NjLGL':_0xabdd70(0x194),'uvgfu':'//*[local-name(.)=\x27Assertion\x27]','rvMOH':_0xabdd70(0x1c4),'wbLMT':function(_0x161be1,_0xe5fd7f){return _0x161be1+_0xe5fd7f;},'MLQQh':_0xabdd70(0x1b6),'prBoC':_0xabdd70(0x1e1)},_0x241d9b=fs['readFileSync'](_0xabdd70(0x1ab),_0x28259e[_0xabdd70(0x1b9)]),_0x514a7e=new xmldom[(_0xabdd70(0x1c5))]()[_0xabdd70(0x1d4)](_0x241d9b),_0x32e869=xpath[_0xabdd70(0x1b5)](_0x28259e[_0xabdd70(0x1a2)],_0x514a7e)[0x0],_0x359d29=xpath[_0xabdd70(0x1b5)](_0x28259e[_0xabdd70(0x1d9)],_0x32e869)[0x0],_0x18239b=new crypto[(_0xabdd70(0x1d8))]();_0x18239b[_0xabdd70(0x1dc)]=new crypto['FileKeyInfo'](_0xabdd70(0x1d3)),_0x18239b[_0xabdd70(0x1c9)](_0x359d29),_0x2880d6[_0xabdd70(0x1b8)](function(){var _0x565909=_0xabdd70;_0x18239b[_0x565909(0x1b7)](_0x241d9b);},Error,_0x28259e[_0xabdd70(0x1b4)](_0x28259e['wbLMT'](_0x28259e['MLQQh'],_0x28259e['prBoC']),_0xabdd70(0x1a9))),_0x2880d6['done']();},exports[_0x6de452(0x197)]=function(_0xee9dde){var _0xf698b0=_0x6de452,_0x5430e2={'HyOLf':_0xf698b0(0x1bb),'pBLem':_0xf698b0(0x1a8),'KOOOt':_0xf698b0(0x194),'iWiXV':_0xf698b0(0x19e)},_0xf0715a='5|1|6|7|3|0|2|4|8'[_0xf698b0(0x1aa)]('|'),_0x572144=0x0;while(!![]){switch(_0xf0715a[_0x572144++]){case'0':_0x2e346b[_0xf698b0(0x1c9)](_0x303f2a);continue;case'1':var _0x1fefa0=new xmldom[(_0xf698b0(0x1c5))]()[_0xf698b0(0x1d4)](_0x34dd48);continue;case'2':var _0x30fed4=_0x2e346b[_0xf698b0(0x1b7)](_0x34dd48);continue;case'3':_0x2e346b[_0xf698b0(0x1dc)]=new crypto['FileKeyInfo'](_0x5430e2[_0xf698b0(0x1e4)]);continue;case'4':_0xee9dde[_0xf698b0(0x1ba)](_0x30fed4,!![]);continue;case'5':var _0x34dd48=fs[_0xf698b0(0x1a5)](_0x5430e2[_0xf698b0(0x1c0)],_0x5430e2['KOOOt']);continue;case'6':var _0x303f2a=xpath['select'](_0x5430e2['iWiXV'],_0x1fefa0)[0x0];continue;case'7':var _0x2e346b=new crypto['SignedXml']();continue;case'8':_0xee9dde['done']();continue;}break;}},exports[_0x6de452(0x1e6)]=function(_0x488856){var _0x3288f7=_0x6de452,_0xaa6e3d={'YwwbC':_0x3288f7(0x1cd),'goaDk':_0x3288f7(0x1d3),'yvoHH':_0x3288f7(0x194),'vEEyd':_0x3288f7(0x1b3)},_0x1bbbd5=fs[_0x3288f7(0x1a5)](_0xaa6e3d[_0x3288f7(0x193)],'utf-8'),_0x301249=new xmldom[(_0x3288f7(0x1c5))]()['parseFromString'](_0x1bbbd5),_0x210d71=xpath[_0x3288f7(0x1b5)](_0x3288f7(0x1af),_0x301249)[0x0],_0xdf4918=xpath[_0x3288f7(0x1b5)](_0x3288f7(0x1c4),_0x210d71)[0x0],_0x37f391=new crypto[(_0x3288f7(0x1d8))]();_0x37f391['keyInfoProvider']=new crypto['FileKeyInfo'](_0x3288f7(0x1d3)),_0x37f391[_0x3288f7(0x1c9)](_0xdf4918),_0x488856['throws'](function(){var _0x28456a=_0x3288f7,_0x5311ad={'Jklhu':_0xaa6e3d[_0x28456a(0x1b2)],'Cfwzk':_0xaa6e3d[_0x28456a(0x19c)],'tBwMT':_0x28456a(0x1c2),'dWeQN':_0xaa6e3d[_0x28456a(0x1ae)]};if(_0x28456a(0x1c3)!=='mCjDc'){var _0x3360b9=_0x5311ad[_0x28456a(0x1a1)][_0x28456a(0x1aa)]('|'),_0x5f370d=0x0;while(!![]){switch(_0x3360b9[_0x5f370d++]){case'0':_0x5b7414[_0x28456a(0x1ba)](_0xd685f,![]);continue;case'1':var _0xacf180=new _0x4a989f['SignedXml']();continue;case'2':_0x49d687[_0x28456a(0x191)]();continue;case'3':_0xacf180[_0x28456a(0x1dc)]=new _0x321f76[(_0x28456a(0x19a))](_0x5311ad[_0x28456a(0x1a0)]);continue;case'4':var _0x555041=new _0x243e93[(_0x28456a(0x1c5))]()[_0x28456a(0x1d4)](_0x477eab);continue;case'5':var _0x477eab=_0xedd000[_0x28456a(0x1a5)](_0x5311ad['tBwMT'],_0x5311ad['dWeQN']);continue;case'6':var _0xd685f=_0xacf180[_0x28456a(0x1b7)](_0x477eab);continue;case'7':var _0x1f035e=_0x233567[_0x28456a(0x1b5)](_0x28456a(0x1df),_0x555041)[0x0];continue;case'8':_0xacf180[_0x28456a(0x1c9)](_0x1f035e);continue;}break;}}else _0x37f391[_0x28456a(0x1b7)](_0x1bbbd5);},Error,'id\x20should\x20not\x20contain\x20quotes'),_0x488856['done']();},exports['test\x20validating\x20SAML\x20response\x20WithComments']=function(_0x3e6efd){var _0x3b134c=_0x6de452,_0x298bc5={'DscFn':_0x3b134c(0x1d3)},_0x806fcf=fs[_0x3b134c(0x1a5)](_0x3b134c(0x1c2),_0x3b134c(0x194)),_0x203c6e=new xmldom[(_0x3b134c(0x1c5))]()[_0x3b134c(0x1d4)](_0x806fcf),_0x3e372b=xpath[_0x3b134c(0x1b5)]('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x203c6e)[0x0],_0x2a6e38=new crypto[(_0x3b134c(0x1d8))]();_0x2a6e38[_0x3b134c(0x1dc)]=new crypto[(_0x3b134c(0x19a))](_0x298bc5[_0x3b134c(0x1ea)]),_0x2a6e38[_0x3b134c(0x1c9)](_0x3e372b);var _0x2b341e=_0x2a6e38[_0x3b134c(0x1b7)](_0x806fcf);_0x3e6efd[_0x3b134c(0x1ba)](_0x2b341e,![]),_0x3e6efd[_0x3b134c(0x191)]();},exports['test\x20validating\x20SAML\x20response\x20with\x20digest\x20comment']=function(_0x239ae4){var _0x5d0183=_0x6de452,_0x1ba6b9={'QPdex':'./test/static/valid_saml_with_digest_comment.xml','oVbHa':_0x5d0183(0x194),'hYmsH':'//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','YgWtb':_0x5d0183(0x1d3)},_0xd9b6c8=fs[_0x5d0183(0x1a5)](_0x1ba6b9[_0x5d0183(0x1e0)],_0x1ba6b9[_0x5d0183(0x1e5)]),_0x35866e=new xmldom['DOMParser']()[_0x5d0183(0x1d4)](_0xd9b6c8);const _0x34f157=xpath[_0x5d0183(0x199)](_0x5d0183(0x1af),_0x35866e),_0x46a915=xpath[_0x5d0183(0x199)](_0x1ba6b9[_0x5d0183(0x1cb)],_0x34f157);var _0x22fac8=new crypto[(_0x5d0183(0x1d8))]();_0x22fac8[_0x5d0183(0x1dc)]=new crypto[(_0x5d0183(0x19a))](_0x1ba6b9[_0x5d0183(0x1dd)]),_0x22fac8[_0x5d0183(0x1c9)](_0x46a915);var _0x3c13ba=_0x22fac8[_0x5d0183(0x1b7)](_0xd9b6c8);_0x239ae4[_0x5d0183(0x1ba)](_0x22fac8[_0x5d0183(0x1ce)][0x0]['digestValue'],_0x5d0183(0x1d1)),_0x239ae4['equal'](_0x3c13ba,![]),_0x239ae4[_0x5d0183(0x191)]();},exports['test\x20signature\x20contains\x20a\x20`SignedInfo`\x20node']=function(_0x19c62c){var _0x8d9e69=_0x6de452,_0x4abdcf={'yVIvC':_0x8d9e69(0x1c6),'wZMsj':_0x8d9e69(0x194),'vJuDi':_0x8d9e69(0x1af),'roSlf':_0x8d9e69(0x1d3),'UACPP':_0x8d9e69(0x1d1),'TkSHa':function(_0x26bc92,_0x47b0bc){return _0x26bc92===_0x47b0bc;},'pmozK':_0x8d9e69(0x1d5),'UHszE':_0x8d9e69(0x195)},_0x37cb29=fs[_0x8d9e69(0x1a5)](_0x8d9e69(0x1e3),_0x8d9e69(0x194)),_0x398f5c=new xmldom['DOMParser']()[_0x8d9e69(0x1d4)](_0x37cb29);const _0x3b8e41=xpath['select1'](_0x8d9e69(0x1df),_0x398f5c);var _0x4199b5=new crypto[(_0x8d9e69(0x1d8))]();_0x4199b5[_0x8d9e69(0x1dc)]=new crypto[(_0x8d9e69(0x19a))]('./test/static/feide_public.pem'),_0x19c62c[_0x8d9e69(0x1b8)](function(){var _0x282c80=_0x8d9e69;if(_0x4abdcf[_0x282c80(0x196)](_0x4abdcf[_0x282c80(0x1a3)],_0x4abdcf['UHszE'])){var _0x3bde6f=_0x2f5c21['readFileSync'](_0x4abdcf[_0x282c80(0x1de)],_0x4abdcf['wZMsj']),_0x34ddc5=new _0x1aaa7f['DOMParser']()[_0x282c80(0x1d4)](_0x3bde6f);const _0x175dbf=_0x3e6b7f[_0x282c80(0x199)](_0x4abdcf[_0x282c80(0x1cf)],_0x34ddc5),_0x53c02b=_0x37c008[_0x282c80(0x199)](_0x282c80(0x1c4),_0x175dbf);var _0x272848=new _0x48662d[(_0x282c80(0x1d8))]();_0x272848[_0x282c80(0x1dc)]=new _0x5177b9[(_0x282c80(0x19a))](_0x4abdcf[_0x282c80(0x1bd)]),_0x272848[_0x282c80(0x1c9)](_0x53c02b);var _0x414101=_0x272848[_0x282c80(0x1b7)](_0x3bde6f);_0x424cc2['equal'](_0x272848['references'][0x0][_0x282c80(0x1e9)],_0x4abdcf[_0x282c80(0x1db)]),_0x855706[_0x282c80(0x1ba)](_0x414101,![]),_0x1d3b23[_0x282c80(0x191)]();}else _0x4199b5[_0x282c80(0x1c9)](_0x3b8e41);},Error,'no\x20signed\x20info\x20node\x20found'),_0x19c62c['done']();},exports['test\x20validation\x20ignores\x20an\x20additional\x20wrapped\x20`SignedInfo`\x20node']=function(_0xf321e0){var _0x45e735=_0x6de452,_0x43a260={'KgNWc':'//*[local-name(.)=\x27Assertion\x27]','HcFSH':'//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]'},_0x5149b7=_0x45e735(0x19f)[_0x45e735(0x1aa)]('|'),_0x5006bc=0x0;while(!![]){switch(_0x5149b7[_0x5006bc++]){case'0':var _0x1582cb=fs['readFileSync'](_0x45e735(0x1c1),_0x45e735(0x194));continue;case'1':var _0x2ae615=new xmldom[(_0x45e735(0x1c5))]()['parseFromString'](_0x1582cb);continue;case'2':_0x3dcbeb[_0x45e735(0x1dc)]=new crypto[(_0x45e735(0x19a))](_0x45e735(0x1bb));continue;case'3':_0xf321e0[_0x45e735(0x191)]();continue;case'4':_0xf321e0['equal'](_0x3dcbeb[_0x45e735(0x1ce)][_0x45e735(0x1e7)],0x1);continue;case'5':var _0x2cfbff=xpath['select'](_0x43a260[_0x45e735(0x1a6)],_0x2ae615)[0x0];continue;case'6':var _0x3764cf=xpath[_0x45e735(0x1b5)](_0x43a260[_0x45e735(0x1be)],_0x2cfbff)[0x0];continue;case'7':var _0x4feefb=_0x3dcbeb[_0x45e735(0x1b7)](_0x1582cb);continue;case'8':_0xf321e0[_0x45e735(0x1ba)](_0x4feefb,!![]);continue;case'9':_0x3dcbeb['loadSignature'](_0x3764cf);continue;case'10':var _0x3dcbeb=new crypto[(_0x45e735(0x1d8))]();continue;}break;}},exports['test\x20signature\x20does\x20not\x20contain\x20multiple\x20`SignedInfo`\x20nodes']=function(_0x2622b9){var _0x17b2ed=_0x6de452,_0x528831={'czIPA':'1|7|2|6|4|5|0|3','KLCve':_0x17b2ed(0x1d6),'UzYin':_0x17b2ed(0x1c7),'aIWas':'//*[local-name(.)=\x27Assertion\x27]','SDBGf':_0x17b2ed(0x1bb),'EsfES':_0x17b2ed(0x1c4)},_0x2f5e2e=_0x528831['czIPA'][_0x17b2ed(0x1aa)]('|'),_0x822248=0x0;while(!![]){switch(_0x2f5e2e[_0x822248++]){case'0':_0x2622b9[_0x17b2ed(0x1b8)](function(){var _0x26a053=_0x17b2ed;_0x4a54b1[_0x26a053(0x1c9)](_0x137367);},Error,_0x528831[_0x17b2ed(0x1e2)]);continue;case'1':var _0x450c19=fs['readFileSync'](_0x528831['UzYin'],'utf-8');continue;case'2':var _0x33a36f=xpath[_0x17b2ed(0x1b5)](_0x528831[_0x17b2ed(0x1ad)],_0xf7963f)[0x0];continue;case'3':_0x2622b9[_0x17b2ed(0x191)]();continue;case'4':var _0x4a54b1=new crypto['SignedXml']();continue;case'5':_0x4a54b1['keyInfoProvider']=new crypto[(_0x17b2ed(0x19a))](_0x528831[_0x17b2ed(0x1ca)]);continue;case'6':var _0x137367=xpath[_0x17b2ed(0x1b5)](_0x528831[_0x17b2ed(0x1bf)],_0x33a36f)[0x0];continue;case'7':var _0xf7963f=new xmldom[(_0x17b2ed(0x1c5))]()['parseFromString'](_0x450c19);continue;}break;}};