const _0x23d206=_0x30d3;(function(_0x472157,_0x5e98a2){const _0x1f4c9e=_0x30d3,_0x5ce0c4=_0x472157();while(!![]){try{const _0xb128c2=-parseInt(_0x1f4c9e(0xa3))/0x1+parseInt(_0x1f4c9e(0x127))/0x2+parseInt(_0x1f4c9e(0xba))/0x3+-parseInt(_0x1f4c9e(0x12c))/0x4*(-parseInt(_0x1f4c9e(0x9a))/0x5)+-parseInt(_0x1f4c9e(0x112))/0x6+parseInt(_0x1f4c9e(0xa2))/0x7+parseInt(_0x1f4c9e(0xef))/0x8;if(_0xb128c2===_0x5e98a2)break;else _0x5ce0c4['push'](_0x5ce0c4['shift']());}catch(_0x158220){_0x5ce0c4['push'](_0x5ce0c4['shift']());}}}(_0x4cc2,0x34fe9));function _0x30d3(_0x16046d,_0x10d600){const _0x4cc23c=_0x4cc2();return _0x30d3=function(_0x30d35c,_0x5a3ad3){_0x30d35c=_0x30d35c-0x99;let _0x1aa331=_0x4cc23c[_0x30d35c];return _0x1aa331;},_0x30d3(_0x16046d,_0x10d600);}import{describe,it,expect,beforeEach,afterEach,vi}from'vitest';import{webcrypto}from'node:crypto';const mockCrypto=webcrypto;function _0x4cc2(){const _0xad6ee=['jKoTt','toBe','mock-uuid-v4-from-crypto-api','Advanced\x20Security\x20and\x20Resource\x20Testing','197106lryvvC','250222ZBAcDj','mockRestore','should\x20use\x20high\x20precision\x20(64-bit)\x20path\x20when\x20available','hDntw','gEVHX','SGTjE','TqEKv','should\x20produce\x20a\x20uniform\x20distribution\x20(passes\x20Chi-squared\x20test)','should\x20handle\x20concurrent\x20access\x20without\x20race\x20conditions','SJYax','VRpdI','Tixty','LVvVc','rlbYC','generateSecureIdSync','gvNUJ','../src/security-kit.js','0x7d70a3d70a3d7000','wNtUD','rEqhI','wKjFJ','Mojsa','cXlAo','303000JyypRt','doMock','resolves','hbaYV','xzfiP','development','fill','KDTFD','floor','fghHw','HKTKa','IjLSY','rQmDD','should\x20return\x20deterministically\x20based\x20on\x20the\x20underlying\x20random\x20number','rFCda','should\x20return\x20an\x20integer\x20within\x20the\x20specified\x20range','RuuRt','AlhAy','CjjcR','[secure-helpers]\x20param','GmIzB','cGFLB','calls','SjrdJ','test','should\x20throw\x20CryptoUnavailableError\x20when\x20no\x20API\x20is\x20found','should\x20correctly\x20identify\x20development\x20via\x20NODE_ENV','{\x22__proto__\x22:\x20{\x22polluted\x22:\x20true}}','bqcKU','VwNke','OLRIx','Tvpnk','length','should\x20throw\x20InvalidParameterError\x20for\x20a\x20wide\x20range\x20of\x20invalid\x20types','toBeLessThanOrEqual','NyCrv','VTLji','TyDWa','getMockImplementation','Lqbde','EZBvQ','JycSY','rGKwR','parse','message','security-kit','kfVsZ','RGIEP','hZQfX','nthLa','AKSCz','CryptoUnavailableError','sByoC','2771128Qcqorn','isInteger','tSqli','should\x20correctly\x20handle\x20odd\x20lengths\x20by\x20slicing','InvalidParameterError','myynb','hoWZU','CfgiS','ckTeJ','should\x20correctly\x20identify\x20production\x20via\x20NODE_ENV','atHNz','NpOWV','QLWMm','rejects','WTJkB','should\x20handle\x20boundary\x20lengths\x201\x20and\x201024','zaoHB','BZyei','MCmvH','BabPa','QsMWd','oVPxr','shouldExecuteThrottledAsync','info','DIzWM','teyeY','toThrow','defineProperty','qMhLR','PRbry','mockImplementationOnce','should\x20use\x20crypto.randomUUID\x20when\x20available','GXkPH','\x20degrees\x20of\x20freedom.','eESAJ','1887630kHWhIy','IdVFv','should\x20set\x20RFC\x204122\x20version\x20and\x20variant\x20bits\x20correctly\x20in\x20fallback','msdYa','njSRi','aba','QVNCy','rzsqv','toMatch','toHaveLength','NODE_ENV','vGRjL','pRkQb','toBeInstanceOf','should\x20generate\x20an\x20ID\x20of\x20the\x20default\x20length\x20(12)','crypto','toBeUndefined','EGjNc','fnzEa','nLGOb','VdpVd','268582OkgARy','CryptoUnavailableError\x20has\x20correct\x20name\x20and\x20default/custom\x20messages','VJryh','DfjwM','vqFUH','8CNuiuc','GzvgW','lYHSp','PYsIB','name','xMJct','RATsZ','MnzEc','0x828f5c28f5c29000','toHaveBeenCalledTimes','aBKwf','kpMOB','CCPMk','production','NKVmW','LJUDO','ITcwf','keys','YvJmu','node:crypto','mock','clearAllMocks','owYwZ','BigUint64Array','getRandomValues','mcsky','LGJRM','uIjvp','should\x20use\x20rejection\x20sampling\x20to\x20prevent\x20modulo\x20bias','randomUUID','reject','NkdET','agecO','size','[secure-helpers]\x20test','FpuUh','each','SoEJQ','ANYWB','yXrHJ','mLNYE','NuDOe','apUBR','gdaGA','env','IVHMV','getSecureRandom','Kyqxh','isDevelopment','kfGlU','ADmDV','LlstP','getSecureRandomAsync','map','should\x20use\x20the\x20mocked\x20crypto\x20API','QDOQs','doUnmock','lDxNM','toBeGreaterThanOrEqual','OaANc','mFlnj','getSecureRandomInt','param','uMqNu','szjMz','InvalidParameterError\x20has\x20correct\x20name\x20and\x20message\x20format','isProduction','document','jinAH','430130LlRMgb','mocked','mockImplementation','resetModules'];_0x4cc2=function(){return _0xad6ee;};return _0x4cc2();}import*as _0x271666 from'../src/security-kit.js';const {CryptoUnavailableError,InvalidParameterError,generateSecureId,generateSecureIdSync,generateSecureUUID,getSecureRandomInt,getSecureRandomAsync,getSecureRandom,shouldExecuteThrottledAsync,shouldExecuteThrottled}=_0x271666;function chiSquaredTest(_0x10633a,_0x2b38fb){const _0x2c88d4=_0x30d3,_0x29cb16={'OLRIx':function(_0x3f8b8a,_0x2518e2){return _0x3f8b8a/_0x2518e2;},'tSqli':function(_0x190560,_0x889de2){return _0x190560/_0x889de2;},'MsVfO':function(_0x2d6068,_0x11cefa){return _0x2d6068-_0x11cefa;},'cXlAo':function(_0x106212,_0x3f5612){return _0x106212<_0x3f5612;}},_0x39464b=Object[_0x2c88d4(0x13d)](_0x10633a),_0x196c8d=_0x39464b[_0x2c88d4(0xda)],_0x12d0d3=_0x29cb16[_0x2c88d4(0xd8)](_0x2b38fb,_0x196c8d),_0x2c9895=_0x196c8d-0x1,_0x4c9a0e={0x1:3.84,0x2:5.99,0x3:7.81,0x4:9.49,0x5:11.07,0x9:16.92,0xf:0x19},_0x2c9c1e=_0x4c9a0e[_0x2c9895];if(!_0x2c9c1e)throw new Error('No\x20critical\x20value\x20for\x20'+_0x2c9895+_0x2c88d4(0x110));let _0xb64168=0x0;for(const _0x14db78 of _0x39464b){_0xb64168+=_0x29cb16[_0x2c88d4(0xf1)](_0x29cb16['MsVfO'](_0x10633a[_0x14db78],_0x12d0d3)**0x2,_0x12d0d3);}return _0x29cb16[_0x2c88d4(0xb9)](_0xb64168,_0x2c9c1e);}function createTestRunner(_0x2dd27f,_0x54b56e){const _0x3d0013={'qMhLR':'mccWc','MCmvH':function(_0x40d2a0,_0x3f38a3){return _0x40d2a0(_0x3f38a3);},'kfGlU':function(_0x7b388d,_0x8f42f1){return _0x7b388d(_0x8f42f1);}};return _0xbbecc6=>{const _0x10585f=_0x30d3;if(_0x54b56e)return _0x3d0013['qMhLR']!==_0x3d0013[_0x10585f(0x10b)]?_0x35390f(_0x5d7bb1):_0x3d0013[_0x10585f(0x101)](_0x2dd27f,_0xbbecc6);else{if('wbuHg'!=='ErjQj')try{return Promise['resolve'](_0x3d0013[_0x10585f(0x15d)](_0x2dd27f,_0xbbecc6));}catch(_0x11d378){if(_0x10585f(0xe2)!=='EZBvQ')_0x14c918[_0x10585f(0x141)]();else return Promise['reject'](_0x11d378);}else return _0x361f08[_0x10585f(0x14a)](_0x35a10d);}};}describe(_0x23d206(0xe7),()=>{const _0x22972f=_0x23d206,_0x1e0c8e={'wKjFJ':function(_0x34c128,_0x3842f9){return _0x34c128(_0x3842f9);},'xzfiP':function(_0x4280f4,_0x40b814){return _0x4280f4!==_0x40b814;},'Kyqxh':'xAhpO','fnzEa':_0x22972f(0xed),'RGIEP':_0x22972f(0xd2),'yXrHJ':function(_0x3f925b,_0x1343a0){return _0x3f925b(_0x1343a0);},'cSUNg':_0x22972f(0xcd),'NkdET':function(_0x4294bf,_0x5e6f03){return _0x4294bf===_0x5e6f03;},'BZyei':'nNJRt','szjMz':function(_0x4f2d1f,_0x558aa0,_0x344fa9){return _0x4f2d1f(_0x558aa0,_0x344fa9);},'CjjcR':_0x22972f(0x128),'OaANc':function(_0x41d2e5,_0x20374c,_0x2dee23){return _0x41d2e5(_0x20374c,_0x2dee23);},'mIwTG':function(_0x580f01){return _0x580f01();},'JycSY':'Crypto\x20hardware\x20failure','gEVHX':function(_0xa955d7,_0x5b7d33,_0x2d26ae){return _0xa955d7(_0x5b7d33,_0x2d26ae);},'lDxNM':_0x22972f(0x162),'mSybN':'should\x20propagate\x20underlying\x20errors\x20from\x20a\x20faulty\x20crypto.getRandomValues','NpOWV':function(_0xb30bab){return _0xb30bab();},'CfgiS':function(_0x3335dc,_0x4905ab){return _0x3335dc(_0x4905ab);},'rlbYC':function(_0x41ee48,_0x36fc19,_0x3c0f10){return _0x41ee48(_0x36fc19,_0x3c0f10);},'pRkQb':_0x22972f(0x16d),'AlhAy':_0x22972f(0x120),'paWMt':_0x22972f(0xfe),'uMqNu':_0x22972f(0xf2),'NyCrv':_0x22972f(0xdb),'hbaYV':function(_0x202060,_0xbed2b2){return _0x202060(_0xbed2b2);},'QknEB':_0x22972f(0xd9),'VwNke':_0x22972f(0x10e),'gvNUJ':function(_0x64afc0,_0x6c0282,_0x1e464f){return _0x64afc0(_0x6c0282,_0x1e464f);},'ITcwf':_0x22972f(0x114),'DIzWM':function(_0x38ea0c,_0x37a2ed){return _0x38ea0c(_0x37a2ed);},'JjfGG':function(_0x462c6b,_0x2fc92f){return _0x462c6b===_0x2fc92f;},'PpjNc':_0x22972f(0x99),'QDOQs':function(_0x5bb9a7,_0x2f20c,_0x22969e){return _0x5bb9a7(_0x2f20c,_0x22969e);},'BndEC':function(_0x4254ce,_0x1a2119){return _0x4254ce<_0x1a2119;},'BabPa':_0x22972f(0xc9),'WZQfL':_0x22972f(0x148),'QLWMm':_0x22972f(0xaa),'HKTKa':function(_0x1d4154){return _0x1d4154();},'VTLji':function(_0x248f17,_0x307799){return _0x248f17(_0x307799);},'NKVmW':_0x22972f(0xa5),'LJUDO':function(_0x3d0d28,_0x10e0fd,_0x19ce6a){return _0x3d0d28(_0x10e0fd,_0x19ce6a);},'sByoC':function(_0x36daf2,_0x45c7bd){return _0x36daf2*_0x45c7bd;},'TqEKv':_0x22972f(0x108),'KDTFD':_0x22972f(0xbf),'VJryh':_0x22972f(0x139),'IdVFv':_0x22972f(0xb3),'CCPMk':_0x22972f(0xd5),'GmIzB':_0x22972f(0xe6),'AVivt':function(_0x48f5c5,_0x4525fb,_0x55b768){return _0x48f5c5(_0x4525fb,_0x55b768);},'pnTWB':_0x22972f(0xf8),'eESAJ':_0x22972f(0x121),'hvoXF':function(_0xe0d5d,_0x4328ef,_0x3ad94b){return _0xe0d5d(_0x4328ef,_0x3ad94b);},'WTJkB':function(_0x4a8553,_0x56b383,_0x11d5dc){return _0x4a8553(_0x56b383,_0x11d5dc);},'rGKwR':'generateSecureId','Mypse':function(_0x47d178,_0x39d1ae,_0x478e38){return _0x47d178(_0x39d1ae,_0x478e38);},'mLNYE':_0x22972f(0x160),'LbSVX':_0x22972f(0x15a),'xMJct':_0x22972f(0x105),'SoEJQ':function(_0x5ba5d0,_0x5490ae,_0x2ee20b){return _0x5ba5d0(_0x5490ae,_0x2ee20b);},'vqFUH':_0x22972f(0xa1)};beforeEach(()=>{const _0x1c3021=_0x22972f;vi[_0x1c3021(0x141)]();}),_0x1e0c8e[_0x22972f(0xf6)](afterEach,()=>{const _0x1d44d4=_0x22972f;if(_0x1e0c8e[_0x1d44d4(0xbe)](_0x1e0c8e[_0x1d44d4(0x15b)],_0x1d44d4(0x156)))vi[_0x1d44d4(0x9b)](mockCrypto[_0x1d44d4(0x144)])[_0x1d44d4(0xa4)]();else{const _0x39f952=new _0x437ea8();_0x206d9c(_0x39f952)['toBeInstanceOf'](_0xe09e45),_0x1e0c8e[_0x1d44d4(0xb7)](_0x451bf2,_0x39f952['name'])['toBe'](_0x1d44d4(0xed)),_0x1e0c8e[_0x1d44d4(0xb7)](_0x145ceb,_0x39f952[_0x1d44d4(0xe6)])[_0x1d44d4(0x11a)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x438ff6=new _0x4e4b06(_0x1d44d4(0xd2));_0x1e0c8e[_0x1d44d4(0xb7)](_0x6f69ed,_0x438ff6[_0x1d44d4(0xe6)])[_0x1d44d4(0x9f)](_0x1d44d4(0x14e));}}),describe('Error\x20Classes',()=>{const _0x32abdd=_0x22972f,_0x3b19b0={'vGRjL':function(_0x6604be,_0x4bec41){const _0xf5c3c4=_0x30d3;return _0x1e0c8e[_0xf5c3c4(0xb7)](_0x6604be,_0x4bec41);},'POFRk':function(_0x45469a,_0x50378f){return _0x45469a(_0x50378f);},'ADmDV':_0x1e0c8e[_0x32abdd(0x124)],'rQmDD':function(_0x3fe8f6,_0x4c1fef){return _0x3fe8f6(_0x4c1fef);},'zaoHB':_0x1e0c8e[_0x32abdd(0xe9)],'jKoTt':function(_0x1b18b2,_0x2b0cb6){const _0x52d9e9=_0x32abdd;return _0x1e0c8e[_0x52d9e9(0x153)](_0x1b18b2,_0x2b0cb6);},'WdNwH':_0x32abdd(0x16a),'LVvVc':_0x32abdd(0xf3),'RuuRt':function(_0x4b4a85,_0x39262a){const _0xe036db=_0x32abdd;return _0x1e0c8e[_0xe036db(0xb7)](_0x4b4a85,_0x39262a);},'rzsqv':_0x1e0c8e['cSUNg']};_0x1e0c8e[_0x32abdd(0x14b)](_0x1e0c8e['BZyei'],_0x1e0c8e[_0x32abdd(0x100)])?(_0x1e0c8e[_0x32abdd(0x16c)](it,_0x1e0c8e[_0x32abdd(0xcc)],()=>{const _0x124c2a=_0x32abdd,_0x333d10=new CryptoUnavailableError();_0x3b19b0[_0x124c2a(0x11d)](expect,_0x333d10)[_0x124c2a(0x11f)](Error),_0x3b19b0['POFRk'](expect,_0x333d10['name'])[_0x124c2a(0x9f)](_0x3b19b0[_0x124c2a(0x15e)]),_0x3b19b0[_0x124c2a(0xc6)](expect,_0x333d10[_0x124c2a(0xe6)])[_0x124c2a(0x11a)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x21672e=new CryptoUnavailableError(_0x3b19b0[_0x124c2a(0xff)]);_0x3b19b0[_0x124c2a(0x9e)](expect,_0x21672e['message'])[_0x124c2a(0x9f)](_0x124c2a(0x14e));}),_0x1e0c8e[_0x32abdd(0x167)](it,_0x32abdd(0x16d),()=>{const _0x5127ab=_0x32abdd,_0x4e3d4c=new InvalidParameterError(_0x3b19b0['WdNwH']);expect(_0x4e3d4c)[_0x5127ab(0x11f)](RangeError),expect(_0x4e3d4c[_0x5127ab(0x130)])[_0x5127ab(0x9f)](_0x3b19b0[_0x5127ab(0xaf)]),_0x3b19b0[_0x5127ab(0xca)](expect,_0x4e3d4c['message'])['toBe'](_0x3b19b0[_0x5127ab(0x119)]);})):_0x3e23c1[_0x32abdd(0x9b)](_0x135d5d[_0x32abdd(0x144)])['mockRestore']();}),_0x1e0c8e[_0x22972f(0xfd)](describe,'Crypto\x20API\x20Discovery\x20and\x20Resilience',()=>{const _0x19f6fa=_0x22972f,_0xe1f4fd={'rFCda':function(_0x4458fe){return _0x1e0c8e['mIwTG'](_0x4458fe);},'RATsZ':function(_0xe8c1f5,_0xc87f43){const _0x183017=_0x30d3;return _0x1e0c8e[_0x183017(0xb7)](_0xe8c1f5,_0xc87f43);},'PcjyC':'../src/security-kit.js','fghHw':function(_0x5e2a73){return _0x5e2a73();},'PYsIB':_0x1e0c8e[_0x19f6fa(0xe3)]};_0x1e0c8e[_0x19f6fa(0xa7)](it,_0x1e0c8e[_0x19f6fa(0x165)],async()=>{const _0xf26161=_0x19f6fa;await _0xe1f4fd[_0xf26161(0xc8)](generateSecureId),_0xe1f4fd[_0xf26161(0x132)](expect,mockCrypto[_0xf26161(0x144)])[_0xf26161(0x135)](0x1);}),_0x1e0c8e[_0x19f6fa(0x16c)](it,_0x19f6fa(0xd3),async()=>{const _0x19dc41=_0x19f6fa;vi[_0x19dc41(0x9d)](),Object[_0x19dc41(0x10a)](globalThis,_0x19dc41(0x121),{'value':undefined,'configurable':!![]}),vi[_0x19dc41(0xbb)](_0x19dc41(0x13f),()=>({'webcrypto':undefined}));const {generateSecureId:_0x95e10c,CryptoUnavailableError:_0x35e458}=await import(_0xe1f4fd['PcjyC']);await expect(_0xe1f4fd[_0x19dc41(0xc3)](_0x95e10c))[_0x19dc41(0xfc)][_0x19dc41(0x109)](_0x35e458),vi[_0x19dc41(0x164)](_0x19dc41(0x13f)),vi[_0x19dc41(0x9d)]();}),it(_0x1e0c8e['mSybN'],async()=>{const _0x2e74c4=_0x19f6fa,_0x51820f=new Error(_0xe1f4fd[_0x2e74c4(0x12f)]);vi[_0x2e74c4(0x9b)](mockCrypto[_0x2e74c4(0x144)])[_0x2e74c4(0x9c)](()=>{throw _0x51820f;}),await expect(generateSecureId())[_0x2e74c4(0xfc)][_0x2e74c4(0x109)](_0x51820f);});}),describe['each']([[_0x1e0c8e[_0x22972f(0xe4)],generateSecureId,!![]],[_0x22972f(0xb1),generateSecureIdSync,![]]])('%s',(_0x3352d3,_0xda999d,_0x28bf51)=>{const _0x268457=_0x22972f,_0x276ebf={'aBKwf':function(_0x25fd0a,_0x57a2b0){return _0x25fd0a(_0x57a2b0);},'nthLa':_0x268457(0xf3),'wNtUD':function(_0x31153e,_0x4e23c8,_0x52fe8b){return _0x1e0c8e['rlbYC'](_0x31153e,_0x4e23c8,_0x52fe8b);},'SGTjE':_0x1e0c8e[_0x268457(0x11e)],'lYHSp':_0x268457(0x14e),'DfjwM':function(_0x123d9b,_0x4b4b34){return _0x123d9b===_0x4b4b34;},'FpuUh':function(_0xd1ffa6,_0x4e7be8){const _0x38ec9f=_0x268457;return _0x1e0c8e[_0x38ec9f(0xf6)](_0xd1ffa6,_0x4e7be8);}},_0x3bc6f5=createTestRunner(_0xda999d,_0x28bf51);_0x1e0c8e['rlbYC'](it,_0x1e0c8e[_0x268457(0xcb)],async()=>{const _0x12ddc9=_0x268457,_0x424ae6=await _0x1e0c8e[_0x12ddc9(0xfa)](_0x3bc6f5);expect(_0x424ae6)[_0x12ddc9(0x11b)](0xc),_0x1e0c8e['CfgiS'](expect,_0x424ae6)[_0x12ddc9(0x11a)](/^[0-9a-f]{12}$/);}),it(_0x1e0c8e['paWMt'],async()=>{const _0xeefc1e=_0x268457;expect(await _0x276ebf['aBKwf'](_0x3bc6f5,0x1))[_0xeefc1e(0x11b)](0x1),expect(await _0x3bc6f5(0x400))[_0xeefc1e(0x11b)](0x400);}),it(_0x1e0c8e[_0x268457(0x16b)],async()=>{const _0x27ac54=_0x268457;vi['mocked'](mockCrypto[_0x27ac54(0x144)])['mockImplementation'](_0x27aac0=>_0x27aac0['fill'](0xab)),expect(await _0x1e0c8e[_0x27ac54(0xb7)](_0x3bc6f5,0x3))[_0x27ac54(0x9f)](_0x27ac54(0x117));}),_0x1e0c8e[_0x268457(0xb0)](it,_0x1e0c8e[_0x268457(0xdd)],async()=>{const _0x43ced0=_0x268457,_0x395191={'YvJmu':function(_0x2c9d67,_0x1935e0){return _0x276ebf['aBKwf'](_0x2c9d67,_0x1935e0);},'Tixty':function(_0x19f331,_0x1e7de6){return _0x19f331(_0x1e7de6);},'bpayr':_0x276ebf[_0x43ced0(0x12e)]},_0x23d3a2=[0x0,0x401,null,NaN,Infinity,[],{},'string',!![]];for(const _0xcad16a of _0x23d3a2){if(_0x276ebf[_0x43ced0(0x12a)](_0x43ced0(0xe1),'Lqbde'))await _0x276ebf[_0x43ced0(0x14f)](expect,_0x3bc6f5(_0xcad16a))[_0x43ced0(0xfc)][_0x43ced0(0x109)](InvalidParameterError);else{const _0x5c0d1d={'njSRi':function(_0x6015db,_0x264c3f){const _0x3cb75b=_0x43ced0;return _0x276ebf[_0x3cb75b(0x136)](_0x6015db,_0x264c3f);},'ANYWB':_0x276ebf[_0x43ced0(0xeb)],'QVNCy':_0x43ced0(0xcd)};_0x276ebf[_0x43ced0(0xb5)](_0x18e301,_0x43ced0(0x128),()=>{const _0x2b813d=_0x43ced0,_0x3fdbca=new _0x453300();_0x395191[_0x2b813d(0x13e)](_0x9607b7,_0x3fdbca)[_0x2b813d(0x11f)](_0x609e9e),_0x1456d2(_0x3fdbca[_0x2b813d(0x130)])[_0x2b813d(0x9f)]('CryptoUnavailableError'),_0x395191[_0x2b813d(0xae)](_0x33edac,_0x3fdbca[_0x2b813d(0xe6)])[_0x2b813d(0x11a)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x3c2bc5=new _0x2c51c4(_0x2b813d(0xd2));_0x3f92ba(_0x3c2bc5[_0x2b813d(0xe6)])[_0x2b813d(0x9f)](_0x395191['bpayr']);}),_0xc3d1d1(_0x276ebf[_0x43ced0(0xa8)],()=>{const _0x38a1b5=_0x43ced0,_0x16278d=new _0x3be573(_0x38a1b5(0x16a));_0x5c0d1d[_0x38a1b5(0x116)](_0x253ce4,_0x16278d)[_0x38a1b5(0x11f)](_0x19e369),_0x148c52(_0x16278d[_0x38a1b5(0x130)])['toBe'](_0x5c0d1d[_0x38a1b5(0x152)]),_0x5c365d(_0x16278d[_0x38a1b5(0xe6)])[_0x38a1b5(0x9f)](_0x5c0d1d[_0x38a1b5(0x118)]);});}}});}),_0x1e0c8e['WTJkB'](describe,'generateSecureUUID',()=>{const _0x2c7f3d=_0x22972f,_0x420363={'LlstP':_0x2c7f3d(0x103),'ZJTMi':function(_0x23183a,_0x3e44cd){const _0xc17431=_0x2c7f3d;return _0x1e0c8e[_0xc17431(0x153)](_0x23183a,_0x3e44cd);}};if(_0x1e0c8e[_0x2c7f3d(0x14b)]('cqpNA',_0x1e0c8e['QknEB']))_0x442028[_0x2c7f3d(0x158)][_0x2c7f3d(0x11c)]=_0x503085,_0x1ff58c[_0x2c7f3d(0x9d)]();else{const _0x5a6600=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;it(_0x1e0c8e[_0x2c7f3d(0xd7)],async()=>{const _0x1bd131=_0x2c7f3d,_0xbaa0a4=await generateSecureUUID();expect(_0xbaa0a4)[_0x1bd131(0x9f)]('mock-uuid-v4-from-crypto-api'),_0x1e0c8e[_0x1bd131(0xbd)](expect,mockCrypto[_0x1bd131(0x149)])[_0x1bd131(0x135)](0x1);}),_0x1e0c8e[_0x2c7f3d(0xb2)](it,_0x1e0c8e[_0x2c7f3d(0x13c)],async()=>{const _0x66f323=_0x2c7f3d;if(_0x420363[_0x66f323(0x15f)]!==_0x66f323(0xac)){vi['mocked'](mockCrypto)[_0x66f323(0x149)]=undefined,vi[_0x66f323(0x9b)](mockCrypto[_0x66f323(0x144)])['mockImplementation'](_0x7361b5=>_0x7361b5[_0x66f323(0xc0)](0xff));const _0x553343=await generateSecureUUID();_0x420363['ZJTMi'](expect,_0x553343)[_0x66f323(0x11a)](_0x5a6600),expect(_0x553343[0xe])[_0x66f323(0x9f)]('4'),expect(['8','9','a','b'])['toContain'](_0x553343[0x13]),vi[_0x66f323(0x9b)](mockCrypto)[_0x66f323(0x149)]=vi['fn'](()=>_0x66f323(0xa0));}else _0x5c3a2c[0x0]=_0x53cdd5('0x828f5c28f5c29000');});}}),_0x1e0c8e['Mypse'](describe,_0x22972f(0x169),()=>{const _0x4d9599=_0x22972f,_0x2ca7d2={'RcneC':function(_0x1d1852,_0x53006f){return _0x1e0c8e['JjfGG'](_0x1d1852,_0x53006f);},'fafCy':_0x1e0c8e['PpjNc'],'TyDWa':function(_0x1c51b3,_0x6b80d7,_0x1636b0){const _0x453956=_0x30d3;return _0x1e0c8e[_0x453956(0x163)](_0x1c51b3,_0x6b80d7,_0x1636b0);},'HEquB':'../src/security-kit.js','mFlnj':function(_0x5b32c6,_0x59119e){return _0x1e0c8e['BndEC'](_0x5b32c6,_0x59119e);},'agecO':function(_0x4d9422,_0x27741b,_0x38695b){return _0x4d9422(_0x27741b,_0x38695b);},'uIjvp':function(_0x51402c,_0x4a29d0,_0x50e2d7){return _0x51402c(_0x4a29d0,_0x50e2d7);}};it(_0x1e0c8e[_0x4d9599(0x102)],async()=>{const _0x4f9e82=_0x4d9599;if(_0x2ca7d2['RcneC']('jinAH',_0x2ca7d2['fafCy'])){const _0x1fa2c0=await _0x2ca7d2[_0x4f9e82(0xdf)](getSecureRandomInt,0x1,0x64);expect(Number[_0x4f9e82(0xf0)](_0x1fa2c0))[_0x4f9e82(0x9f)](!![]),expect(_0x1fa2c0)[_0x4f9e82(0x166)](0x1),expect(_0x1fa2c0)[_0x4f9e82(0xdc)](0x64);}else return _0x3511b3[0x0]=0x19,_0x6194a9;}),it(_0x1e0c8e['WZQfL'],async()=>{const _0x58edaf=_0x4d9599,_0x3ef7f5=0x0,_0x30d994=0x14;vi['mocked'](mockCrypto[_0x58edaf(0x144)])[_0x58edaf(0x10d)](_0x32b7a9=>{return _0x32b7a9[0x0]=0x19,_0x32b7a9;})[_0x58edaf(0x10d)](_0x3ae949=>{return _0x3ae949[0x0]=0xa,_0x3ae949;});const _0x3de249=await getSecureRandomInt(_0x3ef7f5,_0x30d994);_0x1e0c8e[_0x58edaf(0x107)](expect,mockCrypto[_0x58edaf(0x144)])['toHaveBeenCalledTimes'](0x2),_0x1e0c8e[_0x58edaf(0x153)](expect,_0x3de249)[_0x58edaf(0x9f)](0xa);}),it(_0x1e0c8e[_0x4d9599(0xfb)],async()=>{const _0x4a97c2=_0x4d9599,{webcrypto:_0x5c81eb}=await vi['importActual'](_0x4a97c2(0x13f));vi[_0x4a97c2(0x9d)](),Object['defineProperty'](globalThis,'crypto',{'value':_0x5c81eb,'configurable':!![]});const {getSecureRandomInt:_0x178122}=await import(_0x2ca7d2['HEquB']),_0x348aeb=0x0,_0x5ba1a3=0x5,_0x484a6c=0x7530,_0x34f953={0x0:0x0,0x1:0x0,0x2:0x0,0x3:0x0,0x4:0x0,0x5:0x0};for(let _0xd94493=0x0;_0x2ca7d2[_0x4a97c2(0x168)](_0xd94493,_0x484a6c);_0xd94493++){_0x34f953[await _0x2ca7d2[_0x4a97c2(0x14c)](_0x178122,_0x348aeb,_0x5ba1a3)]++;}expect(_0x2ca7d2[_0x4a97c2(0x147)](chiSquaredTest,_0x34f953,_0x484a6c))[_0x4a97c2(0x9f)](!![]),Object[_0x4a97c2(0x10a)](globalThis,_0x4a97c2(0x121),{'value':mockCrypto,'configurable':!![]});});}),describe[_0x22972f(0x150)]([[_0x1e0c8e[_0x22972f(0x154)],getSecureRandomAsync,!![]],[_0x1e0c8e['LbSVX'],getSecureRandom,![]]])('%s',(_0x172dce,_0x2d2059,_0x2de37b)=>{const _0x56bcf1=_0x22972f,_0x1e25d3={'atHNz':function(_0xc0b9e9){const _0x30dce9=_0x30d3;return _0x1e0c8e[_0x30dce9(0xc4)](_0xc0b9e9);},'msdYa':function(_0x1631b9,_0x3eafb0){return _0x1631b9(_0x3eafb0);},'IVHMV':function(_0x53450e,_0x35db70){const _0x4649d1=_0x30d3;return _0x1e0c8e[_0x4649d1(0x107)](_0x53450e,_0x35db70);},'oVPxr':_0x56bcf1(0xb4),'UnJJm':function(_0x167d8b,_0x26421f){return _0x167d8b===_0x26421f;},'bqcKU':_0x56bcf1(0xf4),'GXkPH':_0x56bcf1(0xe8),'EGjNc':function(_0x29fed3,_0x47fa50){const _0x433b0d=_0x56bcf1;return _0x1e0c8e[_0x433b0d(0xde)](_0x29fed3,_0x47fa50);}},_0x259346=()=>createTestRunner(_0x2d2059,_0x2de37b)();_0x1e0c8e['gEVHX'](it,_0x1e0c8e[_0x56bcf1(0x13a)],async()=>{const _0x3dd565=_0x56bcf1;await _0x1e25d3[_0x3dd565(0xf9)](_0x259346),expect(mockCrypto['getRandomValues'])['toHaveBeenCalledTimes'](0x1),_0x1e25d3[_0x3dd565(0x115)](expect,vi[_0x3dd565(0x9b)](mockCrypto[_0x3dd565(0x144)])[_0x3dd565(0x140)][_0x3dd565(0xd0)][0x0][0x0])[_0x3dd565(0x11f)](BigUint64Array);}),_0x1e0c8e[_0x56bcf1(0x13b)](it,'should\x20use\x20fallback\x20(32-bit)\x20path\x20when\x20BigUint64Array\x20is\x20NOT\x20available',async()=>{const _0x23d5fa=_0x56bcf1;if(_0x1e25d3['UnJJm'](_0x1e25d3[_0x23d5fa(0xd6)],_0x1e25d3[_0x23d5fa(0x10f)]))_0x4e3b75[0x0]=_0x1e25d3[_0x23d5fa(0x159)](_0x195888,_0x1e25d3[_0x23d5fa(0x104)]);else{const _0x731b29=globalThis['BigUint64Array'];globalThis['BigUint64Array']=undefined,await _0x1e25d3[_0x23d5fa(0xf9)](_0x259346),_0x1e25d3[_0x23d5fa(0x123)](expect,mockCrypto['getRandomValues'])[_0x23d5fa(0x135)](0x1),expect(vi[_0x23d5fa(0x9b)](mockCrypto[_0x23d5fa(0x144)])[_0x23d5fa(0x140)][_0x23d5fa(0xd0)][0x0][0x0])['toBeInstanceOf'](Uint32Array),globalThis[_0x23d5fa(0x143)]=_0x731b29;}});}),describe['each']([[_0x1e0c8e[_0x22972f(0x131)],shouldExecuteThrottledAsync,!![]],['shouldExecuteThrottled',shouldExecuteThrottled,![]]])('%s',(_0x490ff7,_0x2ead5d,_0x23365e)=>{const _0x411590=_0x22972f,_0x5f522c={'owYwZ':function(_0xc870d3,_0x13e7f8){return _0xc870d3 instanceof _0x13e7f8;},'AKSCz':function(_0x4ded4a,_0x370988){return _0x4ded4a*_0x370988;},'LGJRM':function(_0x538ae0,_0x495291){return _0x538ae0+_0x495291;},'gdaGA':function(_0x2a4d74,_0x454fbc){const _0x489307=_0x30d3;return _0x1e0c8e[_0x489307(0xee)](_0x2a4d74,_0x454fbc);},'hoWZU':'0x7d70a3d70a3d7000','SjrdJ':function(_0x2944dc,_0x315f53){return _0x2944dc!==_0x315f53;},'nLGOb':function(_0x2c91d9,_0x3330d9){return _0x2c91d9(_0x3330d9);}},_0x1cc67d=_0x1114e2=>createTestRunner(_0x2ead5d,_0x23365e)(_0x1114e2);it(_0x411590(0xc7),async()=>{const _0x453113=_0x411590,_0x2ddde5={'NuDOe':function(_0x183080,_0x2ac071){return _0x183080===_0x2ac071;},'GzvgW':'dgBrH','DYgtn':function(_0xb9d60d,_0x47fd3e){return _0xb9d60d(_0x47fd3e);},'hZQfX':_0x5f522c[_0x453113(0xf5)]};if(_0x5f522c[_0x453113(0xd1)]('mcsky',_0x453113(0x145)))return _0x5f522c[_0x453113(0x142)](_0xbe7e4c,_0x5d5046)?_0x475afd[0x0]=_0x5956bd(_0x453113(0x134)):_0xb809f2[0x0]=_0x2aabbf[_0x453113(0xc2)](_0x5f522c[_0x453113(0xec)](0.51,_0x5f522c[_0x453113(0x146)](0xffffffff,0x1))),_0x13cb6c;else{const _0x37b35c=vi['mocked'](mockCrypto[_0x453113(0x144)])[_0x453113(0xe0)]();vi[_0x453113(0x9b)](mockCrypto[_0x453113(0x144)])[_0x453113(0x9c)](_0x501049=>{const _0x22c86c=_0x453113;if(_0x501049 instanceof BigUint64Array){if(_0x2ddde5[_0x22c86c(0x155)](_0x2ddde5['GzvgW'],_0x2ddde5[_0x22c86c(0x12d)]))_0x501049[0x0]=_0x2ddde5['DYgtn'](BigInt,_0x2ddde5[_0x22c86c(0xea)]);else return _0x3bfcf1[0x0]=0xa,_0x1241f3;}else _0x501049[0x0]=Math['floor'](0.49*(0xffffffff+0x1));return _0x501049;}),await expect(_0x5f522c[_0x453113(0x125)](_0x1cc67d,0.5))[_0x453113(0xbc)][_0x453113(0x9f)](!![]),vi[_0x453113(0x9b)](mockCrypto[_0x453113(0x144)])['mockImplementation'](_0x4731bd=>{const _0xa4cb3d=_0x453113;return _0x4731bd instanceof BigUint64Array?_0x4731bd[0x0]=BigInt(_0xa4cb3d(0x134)):_0x4731bd[0x0]=Math[_0xa4cb3d(0xc2)](_0x5f522c[_0xa4cb3d(0x157)](0.51,0xffffffff+0x1)),_0x4731bd;}),await expect(_0x1cc67d(0.5))[_0x453113(0xbc)]['toBe'](![]),vi[_0x453113(0x9b)](mockCrypto['getRandomValues'])[_0x453113(0x9c)](_0x37b35c);}});}),_0x1e0c8e[_0x22972f(0x151)](describe,'Environment-dependent\x20logic',()=>{const _0x58454e=_0x22972f,_0x486e5d={'IjLSY':function(_0x1a15a9,_0x15d26c){return _0x1a15a9(_0x15d26c);},'ckTeJ':_0x1e0c8e[_0x58454e(0x129)],'hDntw':_0x1e0c8e[_0x58454e(0xc1)],'rEqhI':_0x1e0c8e[_0x58454e(0x113)],'MnzEc':_0x1e0c8e[_0x58454e(0x138)],'Mojsa':_0x58454e(0x106),'cGFLB':_0x1e0c8e[_0x58454e(0xe9)],'VRpdI':_0x1e0c8e[_0x58454e(0xce)]},_0x86e06e=process[_0x58454e(0x158)][_0x58454e(0x11c)];_0x1e0c8e['DIzWM'](afterEach,()=>{const _0xd3b634=_0x58454e;if(_0x1e0c8e[_0xd3b634(0xbe)](_0x1e0c8e['TqEKv'],_0x1e0c8e[_0xd3b634(0xa9)]))return _0x2139c8['resolve'](_0x486e5d['IjLSY'](_0x32a4aa,_0x45e16c));else process[_0xd3b634(0x158)]['NODE_ENV']=_0x86e06e,vi[_0xd3b634(0x9d)]();}),_0x1e0c8e['AVivt'](it,_0x58454e(0xd4),async()=>{const _0x203a53=_0x58454e;process[_0x203a53(0x158)][_0x203a53(0x11c)]=_0x1e0c8e['KDTFD'],vi['resetModules']();const {environment:_0xa974a}=await import('../src/security-kit.js');_0x1e0c8e[_0x203a53(0xde)](expect,_0xa974a[_0x203a53(0x15c)])[_0x203a53(0x9f)](!![]);}),it(_0x1e0c8e['pnTWB'],async()=>{const _0x5f16ab=_0x58454e;process[_0x5f16ab(0x158)][_0x5f16ab(0x11c)]=_0x486e5d[_0x5f16ab(0xf7)],vi[_0x5f16ab(0x9d)]();const {environment:_0x2b5741}=await import(_0x5f16ab(0xb3));_0x486e5d[_0x5f16ab(0xc5)](expect,_0x2b5741[_0x5f16ab(0x16e)])['toBe'](!![]);}),it('should\x20not\x20be\x20vulnerable\x20to\x20prototype\x20pollution\x20in\x20dev\x20logs',async()=>{const _0x4fb003=_0x58454e;process[_0x4fb003(0x158)]['NODE_ENV']=_0x486e5d[_0x4fb003(0xa6)],vi[_0x4fb003(0x9d)]();const {secureDevLog:_0x17537f}=await import(_0x486e5d[_0x4fb003(0xb6)]),_0x3d9f8f=globalThis[_0x4fb003(0x16f)];globalThis['document']=undefined;const _0x11b4e6=JSON[_0x4fb003(0xe5)](_0x486e5d[_0x4fb003(0x133)]);_0x17537f(_0x486e5d[_0x4fb003(0xb8)],_0x486e5d[_0x4fb003(0xcf)],_0x486e5d[_0x4fb003(0xad)],_0x11b4e6),expect({}['polluted'])[_0x4fb003(0x122)](),globalThis[_0x4fb003(0x16f)]=_0x3d9f8f;});}),describe(_0x1e0c8e[_0x22972f(0x12b)],()=>{const _0x1456f7=_0x22972f,_0x2a8764={'VdpVd':function(_0x2b9102,_0x41168d){return _0x2b9102(_0x41168d);},'kpMOB':function(_0x35604e,_0x2f4ed3){return _0x35604e(_0x2f4ed3);},'PRbry':_0x1e0c8e[_0x1456f7(0x111)]};_0x1e0c8e['hvoXF'](it,_0x1456f7(0xab),async()=>{const _0x2e4a29=_0x1456f7,{webcrypto:_0x238cb4}=await vi['importActual'](_0x2e4a29(0x13f));vi['resetModules'](),Object[_0x2e4a29(0x10a)](globalThis,_0x2e4a29(0x121),{'value':_0x238cb4,'configurable':!![]});const {generateSecureId:_0x5a953d}=await import(_0x2e4a29(0xb3)),_0x388f7c=_0x2a8764[_0x2e4a29(0x126)](Array,0x64)[_0x2e4a29(0xc0)](0x0)[_0x2e4a29(0x161)](()=>_0x5a953d(0x10)),_0x35d370=await Promise['all'](_0x388f7c),_0x44bb27=new Set(_0x35d370);_0x2a8764[_0x2e4a29(0x137)](expect,_0x44bb27[_0x2e4a29(0x14d)])['toBe'](0x64),Object[_0x2e4a29(0x10a)](globalThis,_0x2a8764[_0x2e4a29(0x10c)],{'value':mockCrypto,'configurable':!![]});});});});