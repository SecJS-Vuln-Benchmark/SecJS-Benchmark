'use strict';function _0x4a3c(){const _0x2acfe7=['1792023VjrbOR','join','exist','shift','hash','qCnts','iEqEF','3368FMoDgG','yJOVj','includeStack','GgTNx','pLUOz','qDIVy','fPirY','equal','MgLJA','XvYYb','ZYhAU','2890YhDnns','25362YFDTEb','RZley','from','expect','/fixtures/message1.eml','2vJkYco','config','mQDzt','replace','readFile','102662vWvPGL','return\x20Object.keys({a:1});','Should\x20calculate\x20body\x20hash\x20byte\x20by\x20byte','write','not','bztEL','79048yTggSD','qKOMB','split','23243OZKbcu','utf-8','end','sha256','150DRahzE','\x0d\x0a\x0d\x0a','3675540hrQKnV','kBzca','222oznjjF','length','DoWsa','3966006DhBVtw'];_0x4a3c=function(){return _0x2acfe7;};return _0x4a3c();}function _0x40cc(_0x19bcf1,_0x16cec6){const _0x4a3ca9=_0x4a3c();return _0x40cc=function(_0x40cceb,_0x32cb8a){_0x40cceb=_0x40cceb-0x9e;let _0x1b5248=_0x4a3ca9[_0x40cceb];return _0x1b5248;},_0x40cc(_0x19bcf1,_0x16cec6);}const _0x31ced0=_0x40cc;(function(_0x46f722,_0x321db1){const _0xa94327=_0x40cc,_0x5e4fae=_0x46f722();while(!![]){try{const _0x391fb2=-parseInt(_0xa94327(0xae))/0x1+-parseInt(_0xa94327(0xc6))/0x2*(-parseInt(_0xa94327(0xad))/0x3)+-parseInt(_0xa94327(0x9f))/0x4*(-parseInt(_0xa94327(0xa6))/0x5)+-parseInt(_0xa94327(0xaa))/0x6*(-parseInt(_0xa94327(0xcb))/0x7)+parseInt(_0xa94327(0xb5))/0x8*(parseInt(_0xa94327(0xc1))/0x9)+parseInt(_0xa94327(0xc0))/0xa*(-parseInt(_0xa94327(0xa2))/0xb)+-parseInt(_0xa94327(0xa8))/0xc;if(_0x391fb2===_0x321db1)break;else _0x5e4fae['push'](_0x5e4fae['shift']());}catch(_0x2d5234){_0x5e4fae['push'](_0x5e4fae['shift']());}}}(_0x4a3c,0xe43fb));const chai=require('chai'),expect=chai[_0x31ced0(0xc4)];let fs=require('fs'),RelaxedBody=require('../../lib/dkim/relaxed-body');chai[_0x31ced0(0xc7)][_0x31ced0(0xb7)]=!![],describe('DKIM\x20RelaxedBody\x20Tests',function(){const _0x32a414=_0x31ced0,_0x1a41e0={'qKOMB':function(_0x402580,_0x5f1cf9){return _0x402580(_0x5f1cf9);},'kBzca':_0x32a414(0xa3),'qDIVy':_0x32a414(0xbb),'OLvQZ':_0x32a414(0xa7),'yJOVj':_0x32a414(0xa5),'ZYhAU':'return\x20Object.keys({a:1});','aGxCH':'D2H5TEwtUgM2u8Ew0gG6vnt/Na6L+Zep7apmSmfy8IQ=','DoWsa':_0x32a414(0xc5),'iEqEF':function(_0x5d3d65,_0x2cf9ed,_0x196cc3){return _0x5d3d65(_0x2cf9ed,_0x196cc3);}};_0x1a41e0[_0x32a414(0xb4)](it,_0x32a414(0xcd),function(_0xd0f163){const _0x48833b=_0x32a414,_0x865d0f={'mQDzt':function(_0x317aea,_0x371dbd){return _0x317aea(_0x371dbd);},'GgTNx':'D2H5TEwtUgM2u8Ew0gG6vnt/Na6L+Zep7apmSmfy8IQ=','MgLJA':function(_0x3a251d){return _0x3a251d();},'RZley':function(_0x42a1e7,_0x32fd4a){return _0x1a41e0['qKOMB'](_0x42a1e7,_0x32fd4a);},'XvYYb':_0x48833b(0xa5)};fs[_0x48833b(0xca)](__dirname+_0x48833b(0xc5),_0x1a41e0[_0x48833b(0xa9)],(_0x4bdc00,_0x3b27ae)=>{const _0x36426c=_0x48833b;_0x865d0f['mQDzt'](expect,_0x4bdc00)['to'][_0x36426c(0xcf)][_0x36426c(0xb0)],_0x3b27ae=_0x3b27ae[_0x36426c(0xc9)](/\r?\n/g,'\x0d\x0a'),_0x3b27ae=_0x3b27ae[_0x36426c(0xa1)](_0x36426c(0xa7)),_0x3b27ae[_0x36426c(0xb1)](),_0x3b27ae=_0x3b27ae[_0x36426c(0xaf)](_0x36426c(0xa7)),_0x3b27ae=Buffer[_0x36426c(0xc3)](_0x3b27ae);let _0x1fdfde=new RelaxedBody({'hashAlgo':_0x865d0f[_0x36426c(0xbe)],'debug':!![]});_0x1fdfde['on'](_0x36426c(0xb2),_0x4dd3bb=>{const _0x14ff25=_0x36426c;_0x865d0f[_0x14ff25(0xc8)](expect,_0x4dd3bb)['to'][_0x14ff25(0xbc)](_0x865d0f[_0x14ff25(0xb8)]),_0x865d0f[_0x14ff25(0xbd)](_0xd0f163);});let _0x31beea=0x0,_0x3a6b23=()=>{const _0x182838=_0x36426c;if(_0x31beea>=_0x3b27ae[_0x182838(0xab)])return _0x865d0f[_0x182838(0xc8)](Function,_0x182838(0xcc))(),_0x1fdfde[_0x182838(0xa4)]();let _0x45e744=Buffer[_0x182838(0xc3)]([_0x3b27ae[_0x31beea++]]);_0x1fdfde[_0x182838(0xce)](_0x45e744),_0x865d0f[_0x182838(0xc2)](setImmediate,_0x3a6b23);};_0x865d0f[_0x36426c(0xc8)](setImmediate,_0x3a6b23);});}),it('Should\x20calculate\x20body\x20hash\x20all\x20at\x20once',function(_0x3e45ac){const _0x309079=_0x32a414,_0x36e949={'qCnts':function(_0x2cdb58,_0x46a6c0){return _0x2cdb58(_0x46a6c0);},'pLUOz':_0x1a41e0[_0x309079(0xbf)],'xIFJh':_0x1a41e0['aGxCH']};fs['readFile'](__dirname+_0x1a41e0[_0x309079(0xac)],_0x1a41e0[_0x309079(0xa9)],(_0x41f004,_0x23ad8a)=>{const _0x219ffb=_0x309079;if(_0x1a41e0[_0x219ffb(0xba)]===_0x219ffb(0x9e))return _0x36e949[_0x219ffb(0xb3)](_0x5050d1,_0x36e949[_0x219ffb(0xb9)])(),_0x2bb797[_0x219ffb(0xa4)]();else{_0x1a41e0[_0x219ffb(0xa0)](expect,_0x41f004)['to']['not'][_0x219ffb(0xb0)],_0x23ad8a=_0x23ad8a['replace'](/\r?\n/g,'\x0d\x0a'),_0x23ad8a=_0x23ad8a['split'](_0x219ffb(0xa7)),_0x23ad8a[_0x219ffb(0xb1)](),_0x23ad8a=_0x23ad8a[_0x219ffb(0xaf)](_0x1a41e0['OLvQZ']),_0x23ad8a=Buffer[_0x219ffb(0xc3)](_0x23ad8a);let _0x5ebd8b=new RelaxedBody({'hashAlgo':_0x1a41e0[_0x219ffb(0xb6)],'debug':!![]});_0x5ebd8b['on'](_0x219ffb(0xb2),_0xfe5b8e=>{expect(_0xfe5b8e)['to']['equal'](_0x36e949['xIFJh']),_0x3e45ac();}),_0x1a41e0['qKOMB'](setImmediate,()=>_0x5ebd8b['end'](_0x23ad8a));}});});});