'use strict';const _0x4bb6be=_0x59fd;function _0x59fd(_0x4f82d8,_0x41900f){const _0x282fd6=_0x282f();return _0x59fd=function(_0x59fd7a,_0x165595){_0x59fd7a=_0x59fd7a-0x10d;let _0xde9155=_0x282fd6[_0x59fd7a];return _0xde9155;},_0x59fd(_0x4f82d8,_0x41900f);}(function(_0x45d9ba,_0x241959){const _0x259cb3=_0x59fd,_0x4e6511=_0x45d9ba();while(!![]){try{const _0x50a9f7=parseInt(_0x259cb3(0x139))/0x1*(parseInt(_0x259cb3(0x131))/0x2)+parseInt(_0x259cb3(0x143))/0x3+parseInt(_0x259cb3(0x11c))/0x4*(-parseInt(_0x259cb3(0x133))/0x5)+parseInt(_0x259cb3(0x12e))/0x6*(-parseInt(_0x259cb3(0x118))/0x7)+parseInt(_0x259cb3(0x125))/0x8+-parseInt(_0x259cb3(0x141))/0x9+parseInt(_0x259cb3(0x144))/0xa;if(_0x50a9f7===_0x241959)break;else _0x4e6511['push'](_0x4e6511['shift']());}catch(_0x33fb94){_0x4e6511['push'](_0x4e6511['shift']());}}}(_0x282f,0x7153c));function _0x282f(){const _0x461437=['dkim','jusTr','Message-ID:\x20<testkiri@kreata.ee>','usjXF','LZnGp','3735258jxonsa','C:\x20X','OLPIq','1765444LZOdMc','should\x20create\x20relaxed\x20headers','196790wJGsTu','Mjohz','replace','müriaad-polüteism.info','NpDXW','message-id:references','1ZbsbuV','should\x20sign\x20headers\x20for\x20unicode\x20domain','-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIIBywIBAAJhANCx7ncKUfQ8wBUYmMqq6ky8rBB0NL8knBf3+uA7q/CSxpX6sQ8N\x0adFNtEeEd7gu7BWEM7+PkO1P0M78eZOvVmput8BP9R44ARpgHY4V0qSCdUt4rD32n\x0awfjlGbh8p5ua5wIDAQABAmAm+uUQpQPTu7kg95wqVqw2sxLsa9giT6M8MtxQH7Uo\x0a1TF0eAO0TQ4KOxgY1S9OT5sGPVKnag258m3qX7o5imawcuyStb68DQgAUg6xv7Af\x0aAqAEDfYN5HW6xK+X81jfOUECMQDr7XAS4PERATvgb1B3vRu5UEbuXcenHDYgdoyT\x0a3qJFViTbep4qeaflF0uF9eFveMcCMQDic10rJ8fopGD7/a45O4VJb0+lRXVdqZxJ\x0aQzAp+zVKWqDqPfX7L93SQLzOGhdd7OECMQDeQyD7WBkjSQNMy/GF7I1qxrscIxNN\x0aVqGTcbu8Lti285Hjhx/sqhHHHGwU9vB7oM8CMQDKTS3Kw/s/xrot5O+kiZwFgr+w\x0acmDrj/7jJHb+ykFNb7GaEkiSYqzUjKkfpweBDYECMFJUyzuuFJAjq3BXmGJlyykQ\x0aTweUw+zMVdSXjO+FCPcYNi6CP1t1KoESzGKBVoqA/g==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----','equal','should\x20skip\x20specific\x20headers','D:\x20X','chai','FsTtX','3708513VOmhJM','a:b:c:d','804831ogjASf','8158730NdOLWI','DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=xn--mriaad-polteism-zvbj.info;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=oBJ1MkwEkftfXa2AK4Expjp2xgIcAR43SVrftSEHVQ6F1SlGjP3EKP+cn/hLkhUel3rY0icthk/myDu6uhTBmM6DMtzIBW/7uQd6q9hfgaiYnw5Iew2tZc4TzBEYSdKi','azQai','sILYf','wlQUn','message-id','a:X\x0d\x0ab:Y\x20Z\x0d\x0a','To:andris@kreata.ee','relaxedHeaders','sha256','from','Onqdm','b:Y\x20Z\x0d\x0ad:X\x0d\x0a','7iGpeaf','a:b','includeStack','config','72vpSlgG','From:\x20andris@node.ee','deep','pHZYJ','jtFFq','node.ee','DKIM\x20Sign\x20Tests','z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=','hTPVe','1922880IHDzFv','expect','../../lib/dkim/sign','A:\x20X'];_0x282f=function(){return _0x461437;};return _0x282f();}const chai=require(_0x4bb6be(0x13f)),expect=chai[_0x4bb6be(0x126)];let sign=require(_0x4bb6be(0x127));chai[_0x4bb6be(0x11b)][_0x4bb6be(0x11a)]=!![];const privateKey=_0x4bb6be(0x13b);describe(_0x4bb6be(0x122),function(){const _0x513d06=_0x4bb6be,_0x312b98={'NpDXW':'B:\x20Y\x09\x0d\x0a\x09Z\x20\x20','FsTtX':function(_0x49c90a,_0x9c86e7){return _0x49c90a(_0x9c86e7);},'Onqdm':_0x513d06(0x128),'hKquS':_0x513d06(0x13e),'pHZYJ':_0x513d06(0x115),'usjXF':_0x513d06(0x112),'azQai':_0x513d06(0x12b),'FHAgu':function(_0x3dd199,_0x49521e,_0x49f677,_0x4d3b4f,_0x47c26e){return _0x3dd199(_0x49521e,_0x49f677,_0x4d3b4f,_0x47c26e);},'jusTr':_0x513d06(0x114),'sILYf':_0x513d06(0x123),'wlQUn':_0x513d06(0x121),'Mjohz':_0x513d06(0x136),'jtFFq':_0x513d06(0x129),'hTPVe':_0x513d06(0x145),'OLPIq':function(_0x2ffb89,_0x12bc7a,_0x2acb2a){return _0x2ffb89(_0x12bc7a,_0x2acb2a);},'LZnGp':'should\x20sign\x20headers','jBKso':function(_0x1a0a5e,_0x5ac065,_0x1412e5){return _0x1a0a5e(_0x5ac065,_0x1412e5);}};it(_0x513d06(0x132),function(){const _0x5db4ab=_0x513d06;let _0x2aa551=[{'key':'a','line':_0x5db4ab(0x128)},{'key':'b','line':_0x312b98['NpDXW']}];_0x312b98[_0x5db4ab(0x140)](expect,sign[_0x5db4ab(0x113)](_0x2aa551,'a:b:c:d'))['to'][_0x5db4ab(0x11e)]['equal']({'headers':_0x5db4ab(0x111),'fieldNames':_0x5db4ab(0x119)});}),_0x312b98[_0x513d06(0x130)](it,_0x513d06(0x13d),function(){const _0x105374=_0x513d06;let _0x342322=[{'key':'a','line':_0x312b98[_0x105374(0x116)]},{'key':'b','line':_0x312b98[_0x105374(0x137)]},{'key':'c','line':_0x105374(0x12f)},{'key':'d','line':_0x312b98['hKquS']}];expect(sign[_0x105374(0x113)](_0x342322,_0x105374(0x142),'a:c'))['to']['deep']['equal']({'headers':_0x105374(0x117),'fieldNames':'b:d'});}),it(_0x312b98[_0x513d06(0x12d)],function(){const _0x29d119=_0x513d06;let _0x1e50e5=[{'key':_0x312b98[_0x29d119(0x11f)],'line':_0x29d119(0x11d)},{'key':'to','line':_0x312b98[_0x29d119(0x12c)]},{'key':_0x29d119(0x110),'line':_0x312b98[_0x29d119(0x10d)]}],_0x46c7c0=_0x312b98['FHAgu'](sign,_0x1e50e5,_0x312b98[_0x29d119(0x12a)],_0x312b98['sILYf'],{'skipFields':_0x29d119(0x138),'domainName':_0x312b98[_0x29d119(0x10f)],'keySelector':'dkim','privateKey':privateKey});expect(_0x46c7c0[_0x29d119(0x135)](/\r?\n\s*/g,'')[_0x29d119(0x135)](/\s+/g,''))['to'][_0x29d119(0x13c)]('DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=node.ee;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=pVd+Dp+EjmYBcc1AWlBAP4ESpuAJ2WMS4gbxWLoeUZ1vZRodVN7K9UXvcCsLuqjJktCZMN2+8dyEUaYW2VIcxg4sVBCS1wqB/tqYZ/gxXLnG2/nZf4fyD2vxltJP4pDL');}),_0x312b98['jBKso'](it,_0x513d06(0x13a),function(){const _0x512fc7=_0x513d06;let _0x5a6912=[{'key':'from','line':'From:\x20andris@node.ee'},{'key':'to','line':_0x312b98[_0x512fc7(0x12c)]}],_0x2b40d9=sign(_0x5a6912,_0x312b98[_0x512fc7(0x12a)],_0x312b98[_0x512fc7(0x10e)],{'domainName':_0x312b98[_0x512fc7(0x134)],'keySelector':_0x312b98[_0x512fc7(0x120)],'privateKey':privateKey});expect(_0x2b40d9[_0x512fc7(0x135)](/\r?\n\s*/g,'')['replace'](/\s+/g,''))['to'][_0x512fc7(0x13c)](_0x312b98[_0x512fc7(0x124)]);});});