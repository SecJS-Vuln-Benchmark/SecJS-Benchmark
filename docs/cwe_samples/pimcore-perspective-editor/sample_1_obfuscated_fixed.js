const _0x5d242e=_0x93ff;function _0x93ff(_0x4f9357,_0x422523){const _0x4b9039=_0x4b90();return _0x93ff=function(_0x93ff05,_0x3df67d){_0x93ff05=_0x93ff05-0x1e6;let _0x5c70bc=_0x4b9039[_0x93ff05];return _0x5c70bc;},_0x93ff(_0x4f9357,_0x422523);}(function(_0x1d54dd,_0x11947f){const _0x490203=_0x93ff,_0xdfe872=_0x1d54dd();while(!![]){try{const _0x1586f8=parseInt(_0x490203(0x216))/0x1*(-parseInt(_0x490203(0x1f8))/0x2)+-parseInt(_0x490203(0x1f2))/0x3*(-parseInt(_0x490203(0x211))/0x4)+parseInt(_0x490203(0x20f))/0x5+parseInt(_0x490203(0x1e9))/0x6*(-parseInt(_0x490203(0x213))/0x7)+parseInt(_0x490203(0x20e))/0x8+parseInt(_0x490203(0x1e8))/0x9*(-parseInt(_0x490203(0x1f3))/0xa)+parseInt(_0x490203(0x1ee))/0xb;if(_0x1586f8===_0x11947f)break;else _0xdfe872['push'](_0xdfe872['shift']());}catch(_0x13114f){_0xdfe872['push'](_0xdfe872['shift']());}}}(_0x4b90,0x28e86));function _0x4b90(){const _0x44326a=['https://www.facebook.com','id\x20token\x20is\x20invalid\x20for\x20this\x20user.','parse/node','Parse','JuEtC','getHeaderFromToken','update','includes','env','digest','crypto','ImQpB','XTtZa','vynJL','./httpsRequest','isArray','\x20|\x20from:\x20','Facebook\x20auth\x20is\x20not\x20configured.','iss','me?fields=id&access_token=','1832400PwAqCE','571260fmZXPB','jsonwebtoken','88yDKtBW','qMRYp','35mGjPZV','TESTING','RCFlx','11lmMLVe','cUqTF','mjVqv','ZnDmk','access_token','bSJmR','message','Facebook\x20auth\x20is\x20invalid\x20for\x20this\x20user.','ykIAR','Error','120978YyZKmA','57762YHXGxM','jwks-rsa','token','appSecret','hex','1441132QPuXwd','then','test','OBJECT_NOT_FOUND','6663EJfFEG','100oIAETN','appIds\x20must\x20be\x20an\x20array.','&appsecret_proof=','get','kQseh','31466VKToJK','rsaPublicKey'];_0x4b90=function(){return _0x44326a;};return _0x4b90();}const Parse=require(_0x5d242e(0x1fc))[_0x5d242e(0x1fd)],crypto=require(_0x5d242e(0x204)),jwksClient=require(_0x5d242e(0x1ea)),jwt=require(_0x5d242e(0x210)),httpsRequest=require(_0x5d242e(0x208)),authUtils=require('./utils'),TOKEN_ISSUER=_0x5d242e(0x1fa);function getAppSecretPath(_0x49b9cf,_0x3dc126={}){const _0x4b5ddd=_0x5d242e,_0x52f7b1={'qMRYp':'sha256','NJyWz':_0x4b5ddd(0x1ed)},_0x264764=_0x3dc126[_0x4b5ddd(0x1ec)];if(!_0x264764)return'';const _0x2e939f=crypto['createHmac'](_0x52f7b1[_0x4b5ddd(0x212)],_0x264764)[_0x4b5ddd(0x200)](_0x49b9cf[_0x4b5ddd(0x21a)])[_0x4b5ddd(0x203)](_0x52f7b1['NJyWz']);return _0x4b5ddd(0x1f5)+_0x2e939f;}function validateGraphToken(_0x2b1051,_0x20631d){const _0x49d1bf=_0x5d242e,_0x48ac97={'bSJmR':'Facebook\x20auth\x20is\x20invalid\x20for\x20this\x20user.','kQseh':function(_0x43911b,_0x3d6f02){return _0x43911b+_0x3d6f02;},'XTtZa':_0x49d1bf(0x20d),'mjVqv':function(_0x7bb019,_0x1d0dd5,_0x54d6cc){return _0x7bb019(_0x1d0dd5,_0x54d6cc);}};return graphRequest(_0x48ac97[_0x49d1bf(0x1f7)](_0x48ac97[_0x49d1bf(0x206)]+_0x2b1051['access_token'],_0x48ac97[_0x49d1bf(0x218)](getAppSecretPath,_0x2b1051,_0x20631d)))[_0x49d1bf(0x1ef)](_0x1df560=>{const _0x17af07=_0x49d1bf;if(_0x1df560&&_0x1df560['id']==_0x2b1051['id']||process[_0x17af07(0x202)][_0x17af07(0x214)]&&_0x2b1051['id']===_0x17af07(0x1f0))return;throw new Parse[(_0x17af07(0x1e7))](Parse['Error'][_0x17af07(0x1f1)],_0x48ac97[_0x17af07(0x21b)]);});}async function validateGraphAppId(_0x9f18f,_0x3ba7fc,_0x33ea78){const _0x1af837=_0x5d242e,_0x232ccc={'vynJL':function(_0x11ecb1,_0x33601c){return _0x11ecb1!==_0x33601c;},'XxsZj':_0x1af837(0x217),'ImQpB':function(_0x13f908,_0x539b24,_0x96488f){return _0x13f908(_0x539b24,_0x96488f);},'Mfrgg':_0x1af837(0x21d)};var _0x1def3a=_0x3ba7fc[_0x1af837(0x21a)];if(process[_0x1af837(0x202)][_0x1af837(0x214)]&&_0x1def3a===_0x1af837(0x1f0)){if(_0x232ccc[_0x1af837(0x207)](_0x1af837(0x217),_0x232ccc['XxsZj']))return _0x165f17(_0x137bca,_0x1d66a5,_0x40294f);else return;}if(!Array[_0x1af837(0x209)](_0x9f18f))throw new Parse['Error'](Parse[_0x1af837(0x1e7)][_0x1af837(0x1f1)],_0x1af837(0x1f4));if(!_0x9f18f['length'])throw new Parse[(_0x1af837(0x1e7))](Parse[_0x1af837(0x1e7)][_0x1af837(0x1f1)],_0x1af837(0x20b));const _0x3a07f1=await graphRequest('app?access_token='+_0x1def3a+_0x232ccc[_0x1af837(0x205)](getAppSecretPath,_0x3ba7fc,_0x33ea78));if(!_0x3a07f1||!_0x9f18f[_0x1af837(0x201)](_0x3a07f1['id']))throw new Parse['Error'](Parse[_0x1af837(0x1e7)]['OBJECT_NOT_FOUND'],_0x232ccc['Mfrgg']);}const getFacebookKeyByKeyId=async(_0x16bb3b,_0x494efb,_0x2020a4)=>{const _0x5d3d5d=_0x5d242e,_0x29d21b=jwksClient({'jwksUri':TOKEN_ISSUER+'/.well-known/oauth/openid/jwks/','cache':!![],'cacheMaxEntries':_0x494efb,'cacheMaxAge':_0x2020a4});let _0x3710ea;try{_0x3710ea=await authUtils['getSigningKey'](_0x29d21b,_0x16bb3b);}catch(_0xe2f581){throw new Parse[(_0x5d3d5d(0x1e7))](Parse['Error'][_0x5d3d5d(0x1f1)],'Unable\x20to\x20find\x20matching\x20key\x20for\x20Key\x20ID:\x20'+_0x16bb3b);}return _0x3710ea;},verifyIdToken=async({token:_0x11fbbe,id:_0x395337},{clientId:_0x172f54,cacheMaxEntries:_0x45bca1,cacheMaxAge:_0x19cc9e})=>{const _0x2ddfe1=_0x5d242e,_0x2f268b={'ykIAR':function(_0x4c533b,_0x538e1e){return _0x4c533b||_0x538e1e;}};if(!_0x11fbbe)throw new Parse[(_0x2ddfe1(0x1e7))](Parse[_0x2ddfe1(0x1e7)]['OBJECT_NOT_FOUND'],_0x2ddfe1(0x1fb));const {kid:_0x268eec,alg:_0x5d915c}=authUtils[_0x2ddfe1(0x1ff)](_0x11fbbe),_0x219340=0x36ee80;let _0x503fc3;_0x19cc9e=_0x2f268b[_0x2ddfe1(0x1e6)](_0x19cc9e,_0x219340),_0x45bca1=_0x45bca1||0x5;const _0x42f58b=await getFacebookKeyByKeyId(_0x268eec,_0x45bca1,_0x19cc9e),_0x5542f9=_0x42f58b['publicKey']||_0x42f58b[_0x2ddfe1(0x1f9)];try{_0x503fc3=jwt['verify'](_0x11fbbe,_0x5542f9,{'algorithms':_0x5d915c,'audience':_0x172f54});}catch(_0x4a951e){const _0xeb817f=_0x4a951e[_0x2ddfe1(0x21c)];throw new Parse[(_0x2ddfe1(0x1e7))](Parse[_0x2ddfe1(0x1e7)][_0x2ddfe1(0x1f1)],''+_0xeb817f);}if(_0x503fc3[_0x2ddfe1(0x20c)]!==TOKEN_ISSUER)throw new Parse[(_0x2ddfe1(0x1e7))](Parse[_0x2ddfe1(0x1e7)][_0x2ddfe1(0x1f1)],'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20'+TOKEN_ISSUER+_0x2ddfe1(0x20a)+_0x503fc3['iss']);if(_0x503fc3['sub']!==_0x395337)throw new Parse['Error'](Parse['Error'][_0x2ddfe1(0x1f1)],'auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');return _0x503fc3;};function validateAuthData(_0x1bfbc5,_0x705408){const _0x92eae3=_0x5d242e,_0x3e06d8={'RCFlx':function(_0x54a30f,_0x232406,_0x38c905){return _0x54a30f(_0x232406,_0x38c905);}};return _0x1bfbc5[_0x92eae3(0x1eb)]?_0x3e06d8[_0x92eae3(0x215)](verifyIdToken,_0x1bfbc5,_0x705408):validateGraphToken(_0x1bfbc5,_0x705408);}function validateAppId(_0x52b3c0,_0x447193,_0x113f37){const _0x2cf02b=_0x5d242e,_0xf1093e={'zIQwt':function(_0x334401,_0x75dea8,_0x3738e6,_0x377c13){return _0x334401(_0x75dea8,_0x3738e6,_0x377c13);}};return _0x447193[_0x2cf02b(0x1eb)]?Promise['resolve']():_0xf1093e['zIQwt'](validateGraphAppId,_0x52b3c0,_0x447193,_0x113f37);}function graphRequest(_0x2c3c7d){const _0x368de4=_0x5d242e,_0x30541e={'ZnDmk':function(_0x58e15e,_0x3dad5d){return _0x58e15e+_0x3dad5d;},'JuEtC':'https://graph.facebook.com/'};return httpsRequest[_0x368de4(0x1f6)](_0x30541e[_0x368de4(0x219)](_0x30541e[_0x368de4(0x1fe)],_0x2c3c7d));}module['exports']={'validateAppId':validateAppId,'validateAuthData':validateAuthData};