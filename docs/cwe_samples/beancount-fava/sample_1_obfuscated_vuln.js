function _0x4c16(){const _0x40dc9a=['should\x20encrypt/decrypt\x20a\x20payload\x20with\x20the\x20correct\x20secret','qJysD','vWiDP','iDOwO','should\x20fail\x20to\x20decrypt\x20when\x20expired','256548JNsYSU','578075QLSZFE','toEqual','objectContaining','payload','1602825iBOKQc','aavBJ','UUgdc','13gjcDZc','should\x20fail\x20to\x20decrypt\x20a\x20payload\x20with\x20the\x20incorrect\x20secret','toThrowError','QGHvj','30GgnuyN','9161076CnpMUY','2583sayaXi','gBWBv','nozvn','piuzW','should\x20fail\x20to\x20decrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','value','14epYpZP','encrypt/decrypt','\x22exp\x22\x20claim\x20timestamp\x20check\x20failed','agAII','floor','tBTyt','NYNgi','should\x20fail\x20to\x20encrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','4147YRIQza','3410cvSiHO','dQIIY','now','rejects','9928fXQwBK','594FWLATI','WQnlV','30VUIjhe','xEIBp'];_0x4c16=function(){return _0x40dc9a;};return _0x4c16();}function _0x3229(_0xff09b0,_0x167d25){const _0x4c1618=_0x4c16();return _0x3229=function(_0x32291e,_0x51ad8d){_0x32291e=_0x32291e-0x125;let _0x9619bb=_0x4c1618[_0x32291e];return _0x9619bb;},_0x3229(_0xff09b0,_0x167d25);}const _0x11d6cb=_0x3229;(function(_0x3d589e,_0x2f67a9){const _0x36513d=_0x3229,_0x255a70=_0x3d589e();while(!![]){try{const _0x595ce0=parseInt(_0x36513d(0x12f))/0x1*(parseInt(_0x36513d(0x127))/0x2)+-parseInt(_0x36513d(0x137))/0x3*(-parseInt(_0x36513d(0x13e))/0x4)+-parseInt(_0x36513d(0x13f))/0x5*(-parseInt(_0x36513d(0x14a))/0x6)+parseInt(_0x36513d(0x143))/0x7+-parseInt(_0x36513d(0x134))/0x8*(parseInt(_0x36513d(0x14c))/0x9)+-parseInt(_0x36513d(0x130))/0xa*(parseInt(_0x36513d(0x135))/0xb)+parseInt(_0x36513d(0x14b))/0xc*(-parseInt(_0x36513d(0x146))/0xd);if(_0x595ce0===_0x2f67a9)break;else _0x255a70['push'](_0x255a70['shift']());}catch(_0x42dd73){_0x255a70['push'](_0x255a70['shift']());}}}(_0x4c16,0x52df5));import{describe,expect,it}from'vitest';import{generateSecret}from'../test/utils';import{decrypt,encrypt}from'./cookies';describe(_0x11d6cb(0x128),async()=>{const _0x818cd5=_0x11d6cb,_0x20ab10={'qJysD':function(_0x537dc3,_0x1479c4){return _0x537dc3(_0x1479c4);},'UUgdc':function(_0x28e0d2,_0x1d260b){return _0x28e0d2+_0x1d260b;},'tBTyt':function(_0x33c546,_0x3bbbdb,_0x365457,_0x43c240){return _0x33c546(_0x3bbbdb,_0x365457,_0x43c240);},'WQnlV':_0x818cd5(0x126),'agAII':function(_0x216e6c,_0x4728c9){return _0x216e6c-_0x4728c9;},'xEIBp':function(_0x52f971,_0x2a031b){return _0x52f971/_0x2a031b;},'mQzHV':function(_0x3e0674,_0x1ddb19,_0x114376,_0x1fb8bc){return _0x3e0674(_0x1ddb19,_0x114376,_0x1fb8bc);},'nozvn':function(_0x324f29,_0x163a4e){return _0x324f29*_0x163a4e;},'iDOwO':function(_0x58edaf,_0x20abaf){return _0x58edaf+_0x20abaf;},'aavBJ':function(_0x145293,_0x5d43f3){return _0x145293/_0x5d43f3;},'gBWBv':function(_0x464ce5,_0x4d504b){return _0x464ce5*_0x4d504b;},'piuzW':function(_0x23dc2e,_0x3f7396){return _0x23dc2e+_0x3f7396;},'dQIIY':function(_0x235f49,_0x42ddeb){return _0x235f49(_0x42ddeb);},'vWiDP':function(_0x3b75af,_0x1fa2f0,_0x530f69){return _0x3b75af(_0x1fa2f0,_0x530f69);},'NYNgi':_0x818cd5(0x12e),'QGHvj':_0x818cd5(0x125)},_0x24d765=await _0x20ab10[_0x818cd5(0x131)](generateSecret,0x20),_0x378e02=await generateSecret(0x20);it(_0x818cd5(0x139),async()=>{const _0x53a9cb=_0x818cd5,_0x31ad20={'key':'value'},_0x92a0ba=0x3c*0x3c,_0x168ef1=Math['floor'](Date[_0x53a9cb(0x132)]()/0x3e8+_0x92a0ba),_0x33db78=await encrypt(_0x31ad20,_0x24d765,_0x168ef1),_0x744d9d=await decrypt(_0x33db78,_0x24d765);_0x20ab10[_0x53a9cb(0x13a)](expect,_0x744d9d[_0x53a9cb(0x142)])[_0x53a9cb(0x140)](expect[_0x53a9cb(0x141)](_0x31ad20));}),_0x20ab10[_0x818cd5(0x13b)](it,_0x818cd5(0x147),async()=>{const _0x933924=_0x818cd5,_0x3bbb10={'key':_0x933924(0x126)},_0x593be4=0x3c*0x3c,_0x59dd51=Math[_0x933924(0x12b)](_0x20ab10[_0x933924(0x145)](Date[_0x933924(0x132)]()/0x3e8,_0x593be4)),_0xf35f7e=await _0x20ab10[_0x933924(0x12c)](encrypt,_0x3bbb10,_0x24d765,_0x59dd51);await _0x20ab10[_0x933924(0x13a)](expect,()=>decrypt(_0xf35f7e,_0x378e02))['rejects'][_0x933924(0x148)]();}),it(_0x818cd5(0x13d),async()=>{const _0x17d2ff=_0x818cd5,_0x101076={'key':_0x20ab10[_0x17d2ff(0x136)]},_0x77a6c8=Math[_0x17d2ff(0x12b)](_0x20ab10[_0x17d2ff(0x12a)](_0x20ab10['xEIBp'](Date[_0x17d2ff(0x132)](),0x3e8),0x3c)),_0x139796=await _0x20ab10['mQzHV'](encrypt,_0x101076,_0x24d765,_0x77a6c8);await expect(()=>decrypt(_0x139796,_0x24d765))[_0x17d2ff(0x133)][_0x17d2ff(0x148)](_0x17d2ff(0x129));}),it(_0x20ab10[_0x818cd5(0x12d)],async()=>{const _0x57dafa=_0x818cd5,_0x2c0a28={'key':_0x57dafa(0x126)},_0x17c165=_0x20ab10[_0x57dafa(0x14e)](0x3c,0x3c),_0x36ebc9=Math[_0x57dafa(0x12b)](_0x20ab10[_0x57dafa(0x13c)](_0x20ab10[_0x57dafa(0x144)](Date['now'](),0x3e8),_0x17c165));await _0x20ab10[_0x57dafa(0x13a)](expect,()=>encrypt(_0x2c0a28,'',_0x36ebc9))[_0x57dafa(0x133)]['toThrowError']();}),it(_0x20ab10[_0x818cd5(0x149)],async()=>{const _0x3d1ba5=_0x818cd5,_0x3f8730={'key':_0x20ab10['WQnlV']},_0x9ed08=_0x20ab10[_0x3d1ba5(0x14d)](0x3c,0x3c),_0x1bb81d=Math[_0x3d1ba5(0x12b)](_0x20ab10[_0x3d1ba5(0x14f)](_0x20ab10[_0x3d1ba5(0x138)](Date[_0x3d1ba5(0x132)](),0x3e8),_0x9ed08)),_0x3d298b=await encrypt(_0x3f8730,_0x24d765,_0x1bb81d);await expect(()=>decrypt(_0x3d298b,''))[_0x3d1ba5(0x133)]['toThrowError']();});});