const _0x39a54c=_0x59d2;(function(_0x2ab7a8,_0x853ebd){const _0x574a23=_0x59d2,_0x412fa3=_0x2ab7a8();while(!![]){try{const _0x37bd46=-parseInt(_0x574a23(0x188))/0x1*(-parseInt(_0x574a23(0x1cf))/0x2)+parseInt(_0x574a23(0x1b8))/0x3+parseInt(_0x574a23(0x178))/0x4+-parseInt(_0x574a23(0x19a))/0x5+-parseInt(_0x574a23(0x1da))/0x6*(parseInt(_0x574a23(0x1b6))/0x7)+-parseInt(_0x574a23(0x17a))/0x8+parseInt(_0x574a23(0x1d6))/0x9;if(_0x37bd46===_0x853ebd)break;else _0x412fa3['push'](_0x412fa3['shift']());}catch(_0x52e427){_0x412fa3['push'](_0x412fa3['shift']());}}}(_0x2b4d,0x3afcb));const {DateTime}=require(_0x39a54c(0x1c2)),{parse}=require(_0x39a54c(0x193)),{global,Array}=require(_0x39a54c(0x1a3)),{Actions:ActionUsers}=require(_0x39a54c(0x1ba)),{Actions:ActionZones}=require(_0x39a54c(0x1d5)),{defaults,httpCodes}=require(_0x39a54c(0x1a2)),{getFireedgeConfig}=require(_0x39a54c(0x1a6)),{createJWT,check2Fa}=require('server/utils/jwt'),{httpResponse,encrypt,getSunstoneAuth}=require('server/utils/server'),{responseOpennebula,getDefaultParamsOfOpennebulaCommand}=require('server/utils/opennebula'),{httpMethod,defaultSessionExpiration,default2FAOpennebulaVar,defaultNamespace,defaultEmptyFunction,defaultSessionLimitExpiration,defaultRememberSessionExpiration}=defaults,{ok,unauthorized,accepted,internalServerError}=httpCodes,{GET}=httpMethod,{USER_INFO,USER_POOL_INFO}=ActionUsers,{ZONE_POOL_INFO}=ActionZones;let user='',pass='',type='',tfatoken='',remember=![],next=defaultEmptyFunction,req={},res={},nodeConnect=defaultEmptyFunction;const getUser=()=>user,getPass=()=>pass,setUser=_0x2de0bf=>{const _0x30082e=_0x39a54c;return user=_0x2de0bf,new AsyncFunction(_0x30082e(0x1c7))(),user;},setPass=_0x2d61d0=>{const _0x334c9b={'xIPsH':'return\x20await\x20Promise.resolve(42);'};return pass=_0x2d61d0,new AsyncFunction(_0x334c9b['xIPsH'])(),pass;},setType=_0x213a67=>{const _0x731e1e=_0x39a54c;return type=_0x213a67,new AsyncFunction(_0x731e1e(0x1c7))(),type;},setTfaToken=_0x145d80=>{const _0x4af9de=_0x39a54c;return tfatoken=_0x145d80,new Function(_0x4af9de(0x19e))(),tfatoken;},setRemember=_0x50d0b4=>{const _0x175f95=_0x39a54c;return remember=_0x50d0b4,setInterval(_0x175f95(0x1d4),0x3e8),remember;},setNext=(_0x3a29ca=defaultEmptyFunction)=>{const _0x52d563={'QhUkS':function(_0x3cedca,_0x91b844){return _0x3cedca*_0x91b844;}};return next=_0x3a29ca,eval('const _0x478db8 = _0x59d2;_0x52d563[_0x478db8(412)](Math[\'PI\'], 2);'),next;},setReq=(_0x4f0f1a={})=>{const _0x393f5b=_0x39a54c,_0x3ddcad={'VurDp':function(_0x5b5dbd,_0x2ed2c4){return _0x5b5dbd(_0x2ed2c4);},'jrVtv':_0x393f5b(0x1b4)};return req=_0x4f0f1a,_0x3ddcad[_0x393f5b(0x177)](Function,_0x3ddcad[_0x393f5b(0x17e)])(),req;},setNodeConnect=(_0x4162fd=defaultEmptyFunction)=>{return nodeConnect=_0x4162fd,eval('Math[\'PI\'] * 2;'),nodeConnect;},setRes=(_0x4aabfb={})=>{const _0x39a338=_0x39a54c;return res=_0x4aabfb,Function(_0x39a338(0x197))(),res;},setDates=()=>{const _0x6ffe0e=_0x39a54c,_0x246b4a={'mpPtz':function(_0x3cc916,_0x2a4505){return _0x3cc916*_0x2a4505;},'ypZVU':function(_0x36f5b9,_0x5849e5,_0x470856){return _0x36f5b9(_0x5849e5,_0x470856);}},_0x375e73=getFireedgeConfig(),_0x294523=remember?_0x375e73['session_remember_expiration']||defaultRememberSessionExpiration:_0x375e73['session_expiration']||defaultSessionExpiration,_0x18c44a=_0x246b4a[_0x6ffe0e(0x1db)](parseInt,_0x375e73[_0x6ffe0e(0x1ce)],0xa)||defaultSessionLimitExpiration,_0x5b5583=DateTime[_0x6ffe0e(0x1ae)](),_0x21e8bb=_0x5b5583[_0x6ffe0e(0x19b)]({'minutes':_0x294523}),_0x253449=_0x21e8bb['diff'](_0x5b5583,_0x6ffe0e(0x1de));return eval('const _0x14e84a = _0x6ffe0e;_0x246b4a[_0x14e84a(441)](Math[\'PI\'], 2);'),{'now':_0x5b5583,'nowUnix':_0x5b5583['toSeconds'](),'limitToken':_0x294523,'limitExpirationReuseToken':_0x18c44a,'expireTime':_0x21e8bb[_0x6ffe0e(0x196)](),'relativeTime':_0x253449[_0x6ffe0e(0x1de)]};},connectOpennebula=(_0x117a72='',_0x527dd0='')=>{const _0x58c9fd=_0x39a54c,_0xa15649={'Dotmt':function(_0x2773f2,_0x1e9a67){return _0x2773f2||_0x1e9a67;},'IbtYd':function(_0x270e32,_0x341ae6){return _0x270e32(_0x341ae6);},'udUTf':function(_0x3f52dc,_0xd26ea,_0xaacc3b){return _0x3f52dc(_0xd26ea,_0xaacc3b);}},_0x5cbbed=_0xa15649['Dotmt'](_0x117a72,user),_0x455445=_0x527dd0||pass;return _0xa15649[_0x58c9fd(0x1b5)](Function,_0x58c9fd(0x1b4))(),_0xa15649[_0x58c9fd(0x17f)](nodeConnect,_0x5cbbed,_0x455445);},updaterResponse=_0x133924=>{const _0x32b843=_0x39a54c;'id'in _0x133924&&'message'in _0x133924&&res?.[_0x32b843(0x1d1)]?.['httpCode']&&(res[_0x32b843(0x1d1)]['httpCode']=_0x133924);},validate2faAuthentication=_0x3d026c=>{const _0x42adb4=_0x39a54c,_0xf61b61={'gDSfW':function(_0x40b3b1,_0x46f556){return _0x40b3b1(_0x46f556);},'IHhgf':function(_0x2d0e25,_0x3946eb){return _0x2d0e25(_0x3946eb);},'joxxF':function(_0x50b1c8,_0x1484d9){return _0x50b1c8+_0x1484d9;},'rpyhy':function(_0x57c6fc,_0x4a1d92,_0x4feaf1){return _0x57c6fc(_0x4a1d92,_0x4feaf1);},'dbuRy':function(_0x2ca522,_0x29ebf3,_0x25ec3d,_0x3f57e9){return _0x2ca522(_0x29ebf3,_0x25ec3d,_0x3f57e9);},'nFuGA':function(_0x128323,_0x2b5385){return _0x128323===_0x2b5385;},'TFTTF':'SIHgG'};let _0x29d594=![];const _0x18fc51=_0x3d026c?.[_0x42adb4(0x1d8)];if(_0x18fc51?.[_0x42adb4(0x189)]?.[default2FAOpennebulaVar]||_0x18fc51?.[_0x42adb4(0x1e4)]?.[default2FAOpennebulaVar]){if(tfatoken[_0x42adb4(0x190)]<=0x0)updaterResponse(httpResponse(accepted,{'id':_0x3d026c?.['ID']}));else{const _0x2da71c=_0x18fc51[_0x42adb4(0x1e4)]?.[default2FAOpennebulaVar]||_0x18fc51[_0x42adb4(0x189)]?.[default2FAOpennebulaVar];!_0xf61b61['rpyhy'](check2Fa,_0x2da71c,tfatoken)?updaterResponse(_0xf61b61[_0x42adb4(0x191)](httpResponse,unauthorized,'',_0x42adb4(0x1a7))):_0x29d594=!![];}}else{if(_0xf61b61[_0x42adb4(0x1d2)](_0xf61b61[_0x42adb4(0x1a5)],_0x42adb4(0x194))){const _0x3d3b09=_0x24559f['find'](_0x47ac50=>_0x47ac50['PASSWORD'][_0x42adb4(0x1d7)](_0x301836)&&_0x47ac50[_0x42adb4(0x1dd)]===_0x42adb4(0x1d3));_0x3d3b09?(_0xf61b61[_0x42adb4(0x1e3)](_0x280c27,_0x52aac8),_0x4c23da(),_0xf61b61[_0x42adb4(0x182)](_0x4d05b9,_0x3d3b09)):_0x2e40ca();}else _0x29d594=!![];}return eval('const _0x252604 = _0x42adb4;_0xf61b61[_0x252604(461)](1, 1);'),_0x29d594;},genJWT=(_0x38c6cd,_0x252045)=>{const _0x22b67d=_0x39a54c,_0x36de4d={'pBwfo':function(_0x179389){return _0x179389();},'aToMO':_0x22b67d(0x185),'KiNOX':function(_0x4efb07,_0x280331){return _0x4efb07(_0x280331);},'bpVqo':function(_0x2ed144,_0x156627,_0x18668e){return _0x2ed144(_0x156627,_0x18668e);}};if(_0x38c6cd?.['time']&&_0x38c6cd?.['token']&&_0x252045?.['ID']&&_0x252045?.[_0x22b67d(0x1d9)]){const {ID:_0x1ada31,TEMPLATE:_0x31da17,NAME:_0x38c5b8}=_0x252045,_0x2e27f2=createJWT({'id':_0x1ada31,'user':_0x38c5b8,'token':_0x38c6cd['token']});if(_0x2e27f2){if(_0x36de4d[_0x22b67d(0x1b0)]===_0x36de4d['aToMO']){const _0x16ae0b={'token':_0x2e27f2,'id':_0x1ada31};_0x31da17?.[_0x22b67d(0x189)]?.[_0x22b67d(0x183)]&&(_0x16ae0b[_0x22b67d(0x1be)]=_0x31da17[_0x22b67d(0x189)][_0x22b67d(0x183)]),_0x36de4d[_0x22b67d(0x18b)](updaterResponse,_0x36de4d[_0x22b67d(0x1af)](httpResponse,ok,_0x16ae0b));}else _0x36de4d[_0x22b67d(0x1cb)](_0x52f165);}}},getCreatedTokenOpennebula=(_0x1474ce='')=>{const _0x3380ce=_0x39a54c,_0x1af039={'GWBXI':function(_0x1d575e,_0x3ce563){return _0x1d575e>_0x3ce563;},'vylra':function(_0x5d46ed,_0x4e751d){return _0x5d46ed>_0x4e751d;},'bUPAY':function(_0x549210){return _0x549210();},'CvlDo':function(_0x262a29,_0x103a18,_0x3aae19){return _0x262a29(_0x103a18,_0x3aae19);}},{now:_0x453eaf,nowUnix:_0x53201a,limitExpirationReuseToken:_0x4aae8f}=_0x1af039[_0x3380ce(0x1b2)](setDates);if(_0x1474ce&&global?.[_0x3380ce(0x1ab)]?.[_0x1474ce]?.[_0x3380ce(0x1b1)]){let _0x3a9587={'token':'','time':0x0};global[_0x3380ce(0x1ab)][_0x1474ce]['tokens'][_0x3380ce(0x1c1)]((_0x1a0d3a={},_0xc4f28c=0x0)=>{const _0x35a7de=_0x3380ce,_0x4f8d17=parseInt(_0x1a0d3a[_0x35a7de(0x1bf)],0xa);_0x4f8d17<=_0x53201a&&delete global['users'][_0x1474ce][_0x35a7de(0x1b1)][_0xc4f28c],_0x1af039[_0x35a7de(0x1ca)](DateTime[_0x35a7de(0x19f)](_0x4f8d17)[_0x35a7de(0x1e0)]({'minutes':_0x4aae8f}),_0x453eaf)&&_0x1af039['vylra'](_0x4f8d17,_0x3a9587[_0x35a7de(0x1bf)])&&(_0x3a9587={'token':_0x1a0d3a[_0x35a7de(0x180)],'time':_0x1a0d3a[_0x35a7de(0x1bf)]});});if(_0x3a9587[_0x3380ce(0x180)]&&_0x3a9587[_0x3380ce(0x1bf)])return _0x1af039[_0x3380ce(0x1ac)](setTimeout,function(){const _0x9c76ef=_0x3380ce;console[_0x9c76ef(0x1bd)]('safe');},0x64),_0x3a9587;}},setZones=()=>{const _0x6329fa=_0x39a54c,_0x578a1={'ZObOi':function(_0x5598ff){return _0x5598ff();}};if(global&&!global[_0x6329fa(0x179)]){const _0x175be2=_0x578a1[_0x6329fa(0x1a8)](connectOpennebula);_0x175be2({'action':ZONE_POOL_INFO,'parameters':getDefaultParamsOfOpennebulaCommand(ZONE_POOL_INFO,GET),'callback':(_0x413f39,_0x2deba1)=>{const _0x5af02a={'hnhzr':function(_0x56054a,_0x46a9e6){return _0x56054a(_0x46a9e6);}};responseOpennebula(()=>undefined,_0x413f39,_0x2deba1,_0x23223d=>{const _0x34e9f2=_0x59d2;if(_0x23223d&&_0x23223d[_0x34e9f2(0x1b7)]&&_0x23223d[_0x34e9f2(0x1b7)][_0x34e9f2(0x1aa)]){const _0x1a2887=!Array[_0x34e9f2(0x1c5)](_0x23223d[_0x34e9f2(0x1b7)][_0x34e9f2(0x1aa)])?[_0x23223d['ZONE_POOL'][_0x34e9f2(0x1aa)]]:_0x23223d[_0x34e9f2(0x1b7)][_0x34e9f2(0x1aa)];global[_0x34e9f2(0x179)]=_0x1a2887['map'](_0x41b2fa=>{const _0x4bc4c7=_0x34e9f2,_0x2a1b8d=_0x41b2fa?.['TEMPLATE']?.[_0x4bc4c7(0x17b)]||'',_0x2020bb=_0x2a1b8d&&_0x5af02a['hnhzr'](parse,_0x2a1b8d),_0x1d4f1a=_0x2020bb[_0x4bc4c7(0x186)]||'',_0x2e5678={'id':_0x41b2fa['ID']||'','name':_0x41b2fa[_0x4bc4c7(0x1d9)]||'','rpc':_0x2a1b8d,'zeromq':_0x4bc4c7(0x1bb)+_0x1d4f1a+':2101'};return _0x41b2fa?.['TEMPLATE']?.[_0x4bc4c7(0x19d)]&&(_0x2e5678['fireedge']=_0x41b2fa?.[_0x4bc4c7(0x1d8)]?.[_0x4bc4c7(0x19d)]),setInterval(_0x4bc4c7(0x1d4),0x3e8),_0x2e5678;});}},next);},'fillHookResource':![]});}},createTokenServerAdmin=({username:_0x16f77e,key:_0x2484c7,iv:_0x4b2044,serverAdmin:serverAdmin=_0x16f77e})=>{const _0x13d9fc=_0x39a54c,_0x9d22be={'fefga':function(_0x2cf1ad,_0x1d8727,_0x364e1c){return _0x2cf1ad(_0x1d8727,_0x364e1c);},'BlurJ':_0x13d9fc(0x19e)};if(_0x16f77e&&_0x2484c7&&_0x4b2044){const {expireTime:_0x260f4b}=setDates(),_0x8c3823=_0x9d22be[_0x13d9fc(0x18c)](parseInt,_0x260f4b,0xa);return new Function(_0x9d22be[_0x13d9fc(0x18f)])(),{'token':encrypt(serverAdmin+':'+_0x16f77e+':'+_0x8c3823,_0x2484c7,_0x4b2044),'time':_0x8c3823};}},wrapUserWithServerAdmin=(_0x3a8dc6={},_0x1ce689={})=>{const _0x1b937c=_0x39a54c,_0x1e36a9={'IqFkO':function(_0x4e379c,_0x5c98b3){return _0x4e379c*_0x5c98b3;},'GZcie':function(_0x36d7cb){return _0x36d7cb();},'LVKBt':function(_0x3599fe,_0x59a2e5){return _0x3599fe(_0x59a2e5);},'DELqx':function(_0x9155ef,_0x38a55a){return _0x9155ef!==_0x38a55a;},'wZJZU':'gtyXw','KVikw':function(_0x50f152,_0x996ec9,_0x191a86){return _0x50f152(_0x996ec9,_0x191a86);}};let _0x36c236='',_0x4295d0='',_0x26b819='';const {relativeTime:_0x50cd76,expireTime:_0x5b5160}=_0x1e36a9[_0x1b937c(0x17d)](setDates);if(_0x50cd76&&_0x3a8dc6?.[_0x1b937c(0x1dc)]&&(_0x36c236=_0x3a8dc6[_0x1b937c(0x1dc)][_0x1b937c(0x1d9)])&&(_0x4295d0=_0x3a8dc6['USER'][_0x1b937c(0x1d0)])&&_0x1ce689&&(_0x26b819=_0x1ce689['NAME'])&&_0x1ce689['ID']&&_0x1ce689[_0x1b937c(0x1d8)]){const _0x3c760a=_0x36c236+':'+_0x26b819;let _0x3bd47f,_0xdf52a=![];const _0x460db1=_0x1e36a9[_0x1b937c(0x199)](getCreatedTokenOpennebula,_0x3c760a);_0x460db1?_0x3bd47f=_0x460db1:(_0xdf52a=!![],_0x3bd47f=_0x1e36a9[_0x1b937c(0x199)](createTokenServerAdmin,{'serverAdmin':_0x36c236,'username':_0x26b819,'key':_0x4295d0[_0x1b937c(0x181)](0x0,0x20),'iv':_0x4295d0[_0x1b937c(0x181)](0x0,0x10)}));if(_0x3bd47f){if(_0xdf52a){!global[_0x1b937c(0x1ab)]&&(global[_0x1b937c(0x1ab)]={});if(!global[_0x1b937c(0x1ab)][_0x3c760a]){if(_0x1e36a9[_0x1b937c(0x1a0)](_0x1e36a9['wZJZU'],'SYLmN'))global[_0x1b937c(0x1ab)][_0x3c760a]={'tokens':[]};else return _0xc06ffd=_0x4683cf,eval('const _0xcb6228 = _0x1b937c;_0x1e36a9[_0xcb6228(425)](_0x410dc2[\'PI\'], 2);'),_0xa24aa4;}!_0x460db1&&global[_0x1b937c(0x1ab)][_0x3c760a][_0x1b937c(0x1b1)][_0x1b937c(0x1df)]({'token':_0x3bd47f[_0x1b937c(0x180)],'time':_0x1e36a9['KVikw'](parseInt,_0x5b5160,0xa)});}genJWT(_0x3bd47f,{'NAME':_0x3c760a,'ID':_0x1ce689['ID'],'TEMPLATE':_0x1ce689[_0x1b937c(0x1d8)]}),next();}}else updaterResponse(httpResponse(internalServerError)),next();},getServerAdmin=()=>{const _0xdcb854=_0x39a54c,_0x4f5bc4={'PQHfX':function(_0x567d01,_0x377b18,_0x57f731){return _0x567d01(_0x377b18,_0x57f731);}},_0x6dace0=getSunstoneAuth(),{username:_0x1548c6,key:_0x41595c,iv:_0x56f3a6}=_0x6dace0;if(_0x1548c6&&_0x41595c&&_0x56f3a6)return _0x4f5bc4[_0xdcb854(0x17c)](setInterval,_0xdcb854(0x1d4),0x3e8),{..._0x6dace0,'token':createTokenServerAdmin({'serverAdmin':_0x1548c6,'username':_0x1548c6,'key':_0x41595c,'iv':_0x56f3a6})};},getServerAdminAndWrapUser=(_0xbdfd4={})=>{const _0x56e14c=_0x39a54c,_0x5be694={'aXWuf':function(_0x351c08,_0x8efb5f){return _0x351c08(_0x8efb5f);},'JfOOs':function(_0x50afb3,_0x49f772,_0x2332cd){return _0x50afb3(_0x49f772,_0x2332cd);}},_0x5f0038=getServerAdmin(),{username:_0x4e14df,token:_0x4c3f40}=_0x5f0038;if(_0x4e14df&&_0x4c3f40){const _0x3d44a1=connectOpennebula(_0x4e14df+':'+_0x4e14df,_0x4c3f40['token']);_0x5be694['aXWuf'](_0x3d44a1,{'action':USER_INFO,'parameters':_0x5be694[_0x56e14c(0x1ad)](getDefaultParamsOfOpennebulaCommand,USER_INFO,GET),'callback':(_0x21a105,_0x5d72c2)=>{responseOpennebula(updaterResponse,_0x21a105,_0x5d72c2,(_0x42ae9a={})=>wrapUserWithServerAdmin(_0x42ae9a,_0xbdfd4),next);},'fillHookResource':![]});}},remoteLogin=(_0x3f0838='',_0x311c1c={})=>{const _0x39db10=_0x39a54c,_0x2355d0={'ovSex':function(_0x2bf77d,_0x5e97e2){return _0x2bf77d(_0x5e97e2);},'jTUkg':function(_0x1cd919){return _0x1cd919();},'zedaF':function(_0x4d6686){return _0x4d6686();},'cEITP':function(_0x6ca2a9,_0x146498){return _0x6ca2a9(_0x146498);},'VZhuL':function(_0xd512d3,_0x53365f,_0x2ac94b){return _0xd512d3(_0x53365f,_0x2ac94b);}},_0x557f39=getServerAdmin(),{username:_0x2a0784,token:_0x26f8a2}=_0x557f39,[_0x15dd1e,_0xa8fe3=_0x15dd1e]=_0x3f0838[_0x39db10(0x1b3)](':');if(_0x2a0784&&_0x26f8a2&&_0x15dd1e&&_0xa8fe3){const _0x1d4648=connectOpennebula(_0x2a0784+':'+_0x2a0784,_0x26f8a2['token']);_0x2355d0[_0x39db10(0x1c9)](_0x1d4648,{'action':USER_POOL_INFO,'parameters':_0x2355d0[_0x39db10(0x1e1)](getDefaultParamsOfOpennebulaCommand,USER_POOL_INFO,GET),'callback':(_0x2e8218,_0x26800a)=>{const _0x1c6bce=_0x39db10,_0x5e2d57=_0x26800a?.['USER_POOL']?.[_0x1c6bce(0x1dc)]||[];if(_0x5e2d57['length']){const _0x368fcb=_0x5e2d57['find'](_0x1135b7=>_0x1135b7[_0x1c6bce(0x1d9)]===_0x15dd1e&&_0x1135b7['PASSWORD']===_0xa8fe3&&_0x1135b7[_0x1c6bce(0x1dd)]==='public');_0x368fcb?(_0x2355d0[_0x1c6bce(0x195)](setRes,_0x311c1c),setZones(),_0x2355d0[_0x1c6bce(0x195)](getServerAdminAndWrapUser,_0x368fcb)):_0x2355d0[_0x1c6bce(0x1cc)](next);}else _0x2355d0['zedaF'](next);},'fillHookResource':![]});}},x509Login=(_0x288e2d='',_0x50f54e={})=>{const _0x2fe9c8=_0x39a54c,_0x2f48c7={'szSCX':function(_0x2b24d5,_0x5540ab,_0x5787eb){return _0x2b24d5(_0x5540ab,_0x5787eb);},'NeAZs':function(_0x143409,_0x477c78){return _0x143409===_0x477c78;},'XaMeW':_0x2fe9c8(0x184),'xrxme':function(_0xa9ec4f){return _0xa9ec4f();},'mpTZD':function(_0x133471,_0xc81c7f){return _0x133471(_0xc81c7f);},'mimzE':function(_0x34a3c9,_0x22b5f8){return _0x34a3c9===_0x22b5f8;},'wOrRU':_0x2fe9c8(0x1c0),'rxsQi':function(_0x2601a0,_0x3c4839){return _0x2601a0(_0x3c4839);},'XSzUL':function(_0x1d3c1d,_0x41414b){return _0x1d3c1d(_0x41414b);}},_0x9c89da=_0x2f48c7[_0x2fe9c8(0x18a)](getServerAdmin),{username:_0x41bda4,token:_0x3cdbf0}=_0x9c89da;if(_0x41bda4&&_0x3cdbf0&&_0x288e2d){if(_0x2f48c7['mimzE'](_0x2f48c7[_0x2fe9c8(0x1c4)],_0x2f48c7[_0x2fe9c8(0x1c4)])){const _0x5d1c25=_0x292dbe=>/,/['test'](_0x292dbe)?_0x292dbe['split'](',')[_0x2fe9c8(0x1c3)]()['join']('/'):_0x292dbe,_0xf03364=_0x2f48c7['rxsQi'](_0x5d1c25,_0x288e2d),_0x1cf873=_0x2f48c7[_0x2fe9c8(0x1bc)](connectOpennebula,_0x41bda4+':'+_0x41bda4,_0x3cdbf0[_0x2fe9c8(0x180)]);_0x2f48c7[_0x2fe9c8(0x198)](_0x1cf873,{'action':USER_POOL_INFO,'parameters':_0x2f48c7['szSCX'](getDefaultParamsOfOpennebulaCommand,USER_POOL_INFO,GET),'callback':(_0x304e15,_0x8bf8a9)=>{const _0x1b8636=_0x2fe9c8;if(_0x2f48c7['NeAZs'](_0x1b8636(0x184),_0x2f48c7[_0x1b8636(0x1c6)])){const _0x187cc0=_0x8bf8a9?.['USER_POOL']?.['USER']||[];if(_0x187cc0[_0x1b8636(0x190)]){const _0x5b74df=_0x187cc0[_0x1b8636(0x1c8)](_0x1c886f=>_0x1c886f['PASSWORD'][_0x1b8636(0x1d7)](_0xf03364)&&_0x1c886f[_0x1b8636(0x1dd)]===_0x1b8636(0x1d3));_0x5b74df?(setRes(_0x50f54e),_0x2f48c7[_0x1b8636(0x18a)](setZones),_0x2f48c7[_0x1b8636(0x1e2)](getServerAdminAndWrapUser,_0x5b74df)):_0x2f48c7[_0x1b8636(0x18a)](next);}else next();}else!_0x217b9e['users']&&(_0x2f3fa0[_0x1b8636(0x1ab)]={}),!_0x109c82[_0x1b8636(0x1ab)][_0x223587]&&(_0x1fcc4a[_0x1b8636(0x1ab)][_0x8dae25]={'tokens':[]}),!_0x305eb9&&_0x3bf718[_0x1b8636(0x1ab)][_0xb67d08][_0x1b8636(0x1b1)]['push']({'token':_0x195ccc[_0x1b8636(0x180)],'time':_0x2f48c7[_0x1b8636(0x1bc)](_0x211c8,_0x5032c2,0xa)});},'fillHookResource':![]});}else _0x5c9ba3(_0x3e2435,_0x2f96a2,_0x81c0ae,(_0x58d512={})=>_0x3413e2(_0x58d512,_0x53ea82),_0x36a3f2);}},login=_0x45856d=>{const _0x1aa316=_0x39a54c,_0xa38607={'HxBbk':function(_0x46d84a){return _0x46d84a();},'iyCPE':function(_0x2ccb5c,_0xf6750e,_0x1f9693){return _0x2ccb5c(_0xf6750e,_0x1f9693);},'LTETL':'var\x20x\x20=\x2042;\x20return\x20x;','aDyrN':function(_0x184245,_0x210025,_0x1f0a55,_0x121acb){return _0x184245(_0x210025,_0x1f0a55,_0x121acb);},'XZnRf':_0x1aa316(0x18d),'qHCrD':function(_0x3f3bf1,_0x124ee1){return _0x3f3bf1(_0x124ee1);},'kphCx':function(_0x37868a){return _0x37868a();}};let _0x4baf1a=![];if(_0x45856d){const _0x471b8a=getFireedgeConfig(),_0x381667=_0x471b8a['namespace']||defaultNamespace,_0x14b12b='['+_0x381667+'.'+USER_INFO+']';if(_0x45856d[_0x1aa316(0x187)]&&_0x45856d[_0x1aa316(0x187)](_0x14b12b)>=0x0){if('gJJrU'===_0xa38607['XZnRf'])_0xa38607[_0x1aa316(0x18e)](updaterResponse,_0xa38607[_0x1aa316(0x18e)](httpResponse,unauthorized));else{if(_0x5a273c&&_0x176d0e&&_0x552f51){const {expireTime:_0x43aeb7}=_0xa38607['HxBbk'](_0x5295d4),_0x2d12d9=_0xa38607[_0x1aa316(0x192)](_0x4c68a4,_0x43aeb7,0xa);return new _0x574eee(_0xa38607[_0x1aa316(0x1a4)])(),{'token':_0xa38607[_0x1aa316(0x1a1)](_0x53f6c7,_0xa4ea8c+':'+_0x40cd17+':'+_0x2d12d9,_0x5215f2,_0x539b7c),'time':_0x2d12d9};}}}else _0x4baf1a=!![];_0x45856d[_0x1aa316(0x1dc)]&&(_0xa38607['kphCx'](setZones),validate2faAuthentication(_0x45856d[_0x1aa316(0x1dc)])&&(_0x4baf1a=![],getServerAdminAndWrapUser(_0x45856d[_0x1aa316(0x1dc)])));}_0x4baf1a&&next();};module['exports']={'login':login,'getUser':getUser,'getPass':getPass,'setType':setType,'setUser':setUser,'setPass':setPass,'setTfaToken':setTfaToken,'setRemember':setRemember,'setNext':setNext,'setReq':setReq,'setRes':setRes,'updaterResponse':updaterResponse,'setNodeConnect':setNodeConnect,'connectOpennebula':connectOpennebula,'getCreatedTokenOpennebula':getCreatedTokenOpennebula,'createTokenServerAdmin':createTokenServerAdmin,'remoteLogin':remoteLogin,'x509Login':x509Login,'getServerAdmin':getServerAdmin};function _0x59d2(_0x11c481,_0x15ecfd){const _0x2b4d84=_0x2b4d();return _0x59d2=function(_0x59d2ec,_0x5018d4){_0x59d2ec=_0x59d2ec-0x177;let _0x2b8dd7=_0x2b4d84[_0x59d2ec];return _0x2b8dd7;},_0x59d2(_0x11c481,_0x15ecfd);}function _0x2b4d(){const _0x54cc31=['fromSeconds','DELqx','aDyrN','server/utils/constants','window-or-global','LTETL','TFTTF','server/utils/yml','invalid\x202fa\x20token','ZObOi','IqFkO','ZONE','users','CvlDo','JfOOs','local','bpVqo','aToMO','tokens','bUPAY','split','return\x20new\x20Date();','IbtYd','1939tZDwFK','ZONE_POOL','422970bzKxKL','mpPtz','server/utils/constants/commands/user','tcp://','szSCX','log','language','time','iCEXo','forEach','luxon','reverse','wOrRU','isArray','XaMeW','return\x20await\x20Promise.resolve(42);','find','cEITP','GWBXI','pBwfo','jTUkg','joxxF','minimum_opennebula_expiration','88rSuidU','PASSWORD','locals','nFuGA','x509','updateClock();','server/utils/constants/commands/zone','4137741dHbZNi','includes','TEMPLATE','NAME','6072KItMPH','ypZVU','USER','AUTH_DRIVER','seconds','push','minus','VZhuL','mpTZD','gDSfW','FIREEDGE','VurDp','644400ESnCGN','zones','2239456hkFHJW','ENDPOINT','PQHfX','GZcie','jrVtv','udUTf','token','substring','IHhgf','LANG','OhOcb','RQPwv','hostname','indexOf','10967LXaDUS','SUNSTONE','xrxme','KiNOX','fefga','gJJrU','qHCrD','BlurJ','length','dbuRy','iyCPE','url','XLfEB','ovSex','toSeconds','return\x20Object.keys({a:1});','XSzUL','LVKBt','2212600DOYjYv','plus','QhUkS','FIREEDGE_ENDPOINT','var\x20x\x20=\x2042;\x20return\x20x;'];_0x2b4d=function(){return _0x54cc31;};return _0x2b4d();}