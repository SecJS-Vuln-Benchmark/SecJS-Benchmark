const _0x1afe50=_0x3563;function _0x3563(_0x356f0d,_0x42f8d4){const _0x2f3afe=_0x2f3a();return _0x3563=function(_0x356305,_0x371534){_0x356305=_0x356305-0x113;let _0x1c597e=_0x2f3afe[_0x356305];return _0x1c597e;},_0x3563(_0x356f0d,_0x42f8d4);}(function(_0x33e883,_0x4df15d){const _0x4e2d52=_0x3563,_0x2baf80=_0x33e883();while(!![]){try{const _0x1fe932=-parseInt(_0x4e2d52(0x136))/0x1+-parseInt(_0x4e2d52(0x11f))/0x2+parseInt(_0x4e2d52(0x12a))/0x3+parseInt(_0x4e2d52(0x120))/0x4*(parseInt(_0x4e2d52(0x127))/0x5)+parseInt(_0x4e2d52(0x121))/0x6*(parseInt(_0x4e2d52(0x116))/0x7)+parseInt(_0x4e2d52(0x122))/0x8+-parseInt(_0x4e2d52(0x128))/0x9;if(_0x1fe932===_0x4df15d)break;else _0x2baf80['push'](_0x2baf80['shift']());}catch(_0x43413d){_0x2baf80['push'](_0x2baf80['shift']());}}}(_0x2f3a,0xc764a));function _0x2f3a(){const _0xb15dbf=['FWOJQ','4|2|5|6|0|3|1','5691035rkphwl','7023060jchymJ','split','2192517fbnwBv','server/utils/constants','fInGr','YRMsg','server/utils/constants/commands/user','dysKt','LTsjr','jVMQG','CsdZE','toObject','pbGAk','JMADW','974234sdTkMA','ozYct','server/routes/api/auth/utils','opennebula','50855GuiIvW','zLXsu','x509','bTkcG','server/utils/yml','LoKhh','auth','exports','uDYBp','1236718tcGwcv','4YFdhQo','222GYWdYi','8414368ilNkke','USER_INFO','server/utils/opennebula'];_0x2f3a=function(){return _0xb15dbf;};return _0x2f3a();}const {Map}=require('immutable'),{login,setUser,setPass,setType,setTfaToken,setRemember,setNext,setRes,setNodeConnect,connectOpennebula,updaterResponse,remoteLogin,x509Login}=require(_0x1afe50(0x114)),{defaults,httpCodes}=require(_0x1afe50(0x12b)),{Actions}=require(_0x1afe50(0x12e)),{getFireedgeConfig}=require(_0x1afe50(0x11a)),{getDefaultParamsOfOpennebulaCommand}=require(_0x1afe50(0x124)),{writeInLogger}=require('server/utils/logger'),{internalServerError,unauthorized}=httpCodes,{httpMethod,defaultEmptyFunction}=defaults,{GET}=httpMethod,loginUser=(_0x5ddede='',_0xd27474='',_0x167993=defaultEmptyFunction,_0x50eb46=defaultEmptyFunction)=>{const _0x3eaa0c=_0x1afe50,_0x9238={'jVMQG':function(_0x5e881c,_0x408a77){return _0x5e881c(_0x408a77);}};_0xd27474&&_0xd27474['USER']&&!_0x5ddede?_0x9238[_0x3eaa0c(0x131)](_0x167993,_0xd27474):_0x50eb46(_0x5ddede);},coreAuth=(_0x4339b5={},_0x42cb8d=defaultEmptyFunction,_0x2d4278={},_0x3ab29d={},_0x149079=defaultEmptyFunction)=>{const _0x1543bd=_0x1afe50,_0x615b0={'ozYct':_0x1543bd(0x126),'zLXsu':function(_0x1aabcd,_0x263d03){return _0x1aabcd(_0x263d03);},'fInGr':function(_0x3a8cda,_0x4c32e6){return _0x3a8cda(_0x4c32e6);},'LoKhh':function(_0x9159da,_0x1e3cd8){return _0x9159da||_0x1e3cd8;},'FWOJQ':function(_0x35f672){return _0x35f672();},'uDYBp':function(_0x4eda2e,_0xec742d,_0x20ede8,_0x4d79ce,_0x43b6c6){return _0x4eda2e(_0xec742d,_0x20ede8,_0x4d79ce,_0x43b6c6);},'dysKt':function(_0xe9d5d5,_0x5a10fb){return _0xe9d5d5!==_0x5a10fb;},'LTsjr':_0x1543bd(0x12d),'kGtep':function(_0xabe642,_0x3eb341){return _0xabe642(_0x3eb341);},'JMADW':function(_0x2f6a39,_0x529419,_0x231431){return _0x2f6a39(_0x529419,_0x231431);}},{user:_0x428d26,token:_0x23cc1d,type:_0x5bfd2b,token2fa:_0x26a74b,remember:_0x4b66b2}=_0x2d4278;setNext(_0x42cb8d),setNodeConnect(_0x149079),updaterResponse(new Map(internalServerError)[_0x1543bd(0x133)]());if(_0x428d26&&_0x23cc1d){if(_0x615b0[_0x1543bd(0x12f)](_0x615b0[_0x1543bd(0x130)],_0x1543bd(0x12d)))_0x364e75(_0x2d538a,_0xd8a7fe,_0x5bf60c,_0x32bbee);else{const _0x5e7561=connectOpennebula(_0x428d26,_0x23cc1d),_0x428fe4=_0x11b33f=>{const _0x53537f=_0x1543bd,_0x1637ab=_0x615b0[_0x53537f(0x113)][_0x53537f(0x129)]('|');let _0x2813bd=0x0;while(!![]){switch(_0x1637ab[_0x2813bd++]){case'0':setTfaToken(_0x26a74b||'');continue;case'1':_0x615b0[_0x53537f(0x117)](login,_0x11b33f);continue;case'2':_0x615b0[_0x53537f(0x12c)](setUser,_0x428d26||'');continue;case'3':setRemember(_0x4b66b2||![]);continue;case'4':_0x615b0[_0x53537f(0x12c)](setRes,_0x4339b5);continue;case'5':setPass(_0x615b0[_0x53537f(0x11b)](_0x23cc1d,''));continue;case'6':setType(_0x615b0[_0x53537f(0x11b)](_0x5bfd2b,''));continue;}break;}},_0x1bd3bf=_0x4f0a8f=>{const _0x57251f=_0x1543bd;setRes(_0x4339b5);const _0x31dfa7=_0x4f0a8f?internalServerError:unauthorized;updaterResponse(new Map(_0x31dfa7)[_0x57251f(0x133)]()),writeInLogger(_0x31dfa7),_0x615b0[_0x57251f(0x125)](_0x42cb8d);};_0x615b0['kGtep'](_0x5e7561,{'action':Actions[_0x1543bd(0x123)],'parameters':_0x615b0[_0x1543bd(0x135)](getDefaultParamsOfOpennebulaCommand,Actions[_0x1543bd(0x123)],GET),'callback':(_0x1adf1b,_0x82c0de)=>{const _0x506cb9=_0x1543bd;_0x615b0[_0x506cb9(0x11e)](loginUser,_0x1adf1b,_0x82c0de,_0x428fe4,_0x1bd3bf);},'fillHookResource':![]});}}else _0x42cb8d();},remoteAuth=(_0x57cacc={},_0x4ba7b0=defaultEmptyFunction,_0x4eaa7d={},_0x5ea999,_0x105bc3=defaultEmptyFunction,_0x1f3a64)=>{const _0x542dfe=_0x1afe50,_0xdadcf1={'pbGAk':function(_0x5cdee1,_0x268c68){return _0x5cdee1(_0x268c68);},'bTkcG':function(_0x3cf372,_0x1d0c67,_0x208e83){return _0x3cf372(_0x1d0c67,_0x208e83);},'bzEYB':function(_0x399b1c){return _0x399b1c();}},{user:_0x54b67e}=_0x4eaa7d;_0xdadcf1[_0x542dfe(0x134)](setNext,_0x4ba7b0),setNodeConnect(_0x105bc3),updaterResponse(new Map(internalServerError)[_0x542dfe(0x133)]());if(_0x54b67e)switch(_0x1f3a64){case'x509':x509Login(_0x54b67e,_0x57cacc);break;default:_0xdadcf1[_0x542dfe(0x119)](remoteLogin,_0x54b67e,_0x57cacc);break;}else _0xdadcf1['bzEYB'](_0x4ba7b0);},selectTypeAuth=(_0x5811a3={},_0x3b3648=defaultEmptyFunction,_0x171499={},_0x46aaa4={},_0x2f43b1=defaultEmptyFunction)=>{const _0x35bded=_0x1afe50,_0x529e10={'CsdZE':'return\x20await\x20Promise.resolve(42);'},_0x53c034=getFireedgeConfig(),_0x5d9b10={'remote':()=>remoteAuth(_0x5811a3,_0x3b3648,_0x171499,_0x46aaa4,_0x2f43b1),'x509':()=>remoteAuth(_0x5811a3,_0x3b3648,_0x171499,_0x46aaa4,_0x2f43b1,_0x35bded(0x118)),'opennebula':()=>coreAuth(_0x5811a3,_0x3b3648,_0x171499,_0x46aaa4,_0x2f43b1)},_0x2911ea=_0x5d9b10[_0x53c034?.[_0x35bded(0x11c)]]||_0x5d9b10[_0x35bded(0x115)];return new AsyncFunction(_0x529e10[_0x35bded(0x132)])(),_0x2911ea();};module[_0x1afe50(0x11d)]={'selectTypeAuth':selectTypeAuth};