const _0x359b15=_0x3a73;(function(_0x4c7581,_0x3e56c4){const _0x1caa8c=_0x3a73,_0x34f59f=_0x4c7581();while(!![]){try{const _0x41917d=parseInt(_0x1caa8c(0xd2))/0x1+parseInt(_0x1caa8c(0xe3))/0x2*(parseInt(_0x1caa8c(0xd4))/0x3)+parseInt(_0x1caa8c(0xec))/0x4*(parseInt(_0x1caa8c(0xd7))/0x5)+parseInt(_0x1caa8c(0xe8))/0x6*(parseInt(_0x1caa8c(0xe1))/0x7)+parseInt(_0x1caa8c(0xd9))/0x8*(parseInt(_0x1caa8c(0xda))/0x9)+-parseInt(_0x1caa8c(0xe5))/0xa+-parseInt(_0x1caa8c(0xdd))/0xb;if(_0x41917d===_0x3e56c4)break;else _0x34f59f['push'](_0x34f59f['shift']());}catch(_0x2ce51d){_0x34f59f['push'](_0x34f59f['shift']());}}}(_0x47fb,0xc54d8));const {Map}=require('immutable'),{login,setUser,setPass,setType,setTfaToken,setRemember,setNext,setRes,setNodeConnect,connectOpennebula,updaterResponse,remoteLogin,x509Login}=require(_0x359b15(0xdc)),{defaults,httpCodes}=require(_0x359b15(0xf2)),{Actions}=require('server/utils/constants/commands/user'),{getFireedgeConfig}=require('server/utils/yml'),{getDefaultParamsOfOpennebulaCommand}=require(_0x359b15(0xef)),{writeInLogger}=require(_0x359b15(0xdb)),{internalServerError,unauthorized}=httpCodes,{httpMethod,defaultEmptyFunction}=defaults,{GET}=httpMethod,loginUser=(_0x575768='',_0x3f8cb4='',_0x67037f=defaultEmptyFunction,_0x16ae11=defaultEmptyFunction)=>{const _0x565209=_0x359b15,_0x181cf9={'EtRiH':function(_0xaf4f23,_0x179ab2){return _0xaf4f23(_0x179ab2);}};_0x3f8cb4&&_0x3f8cb4[_0x565209(0xe6)]&&!_0x575768?_0x181cf9[_0x565209(0xdf)](_0x67037f,_0x3f8cb4):_0x181cf9[_0x565209(0xdf)](_0x16ae11,_0x575768);},coreAuth=(_0xfa2af8={},_0x23e648=defaultEmptyFunction,_0x37445d={},_0x30eacf={},_0x3676fc=defaultEmptyFunction)=>{const _0x4b8fbe=_0x359b15,_0x2c9a3d={'bbZCL':function(_0x1587c2,_0x440ad4){return _0x1587c2(_0x440ad4);},'ZPIwY':function(_0x500205,_0x2be807){return _0x500205||_0x2be807;},'XDrLF':function(_0x1d62c2,_0x1c8313){return _0x1d62c2(_0x1c8313);},'uXhKv':function(_0x2eee12,_0x5643b5){return _0x2eee12(_0x5643b5);},'jkLPy':function(_0x124d35,_0x30eae3){return _0x124d35&&_0x30eae3;},'ouwHv':function(_0x5c7914,_0x55db11,_0x2f98bf){return _0x5c7914(_0x55db11,_0x2f98bf);}},{user:_0x5d68f5,token:_0x59c249,type:_0x4b6668,token2fa:_0x5e7676,remember:_0x478b96}=_0x37445d;setRes(_0xfa2af8),_0x2c9a3d['XDrLF'](setNext,_0x23e648),_0x2c9a3d['XDrLF'](setNodeConnect,_0x3676fc),_0x2c9a3d[_0x4b8fbe(0xf4)](updaterResponse,new Map(internalServerError)[_0x4b8fbe(0xed)]());if(_0x2c9a3d[_0x4b8fbe(0xee)](_0x5d68f5,_0x59c249)){const _0x156340=connectOpennebula(_0x5d68f5,_0x59c249),_0x513186=_0x5ee8fb=>{const _0x4a6a8e=_0x4b8fbe;_0x2c9a3d['bbZCL'](setUser,_0x2c9a3d[_0x4a6a8e(0xf0)](_0x5d68f5,'')),_0x2c9a3d[_0x4a6a8e(0xf1)](setPass,_0x2c9a3d[_0x4a6a8e(0xf0)](_0x59c249,'')),setType(_0x2c9a3d[_0x4a6a8e(0xf0)](_0x4b6668,'')),setTfaToken(_0x5e7676||''),setRemember(_0x478b96||![]),login(_0x5ee8fb);},_0x1531e9=_0x270082=>{const _0x52b609=_0x4b8fbe,_0x3e057a=_0x270082?internalServerError:unauthorized;_0x2c9a3d[_0x52b609(0xf1)](updaterResponse,new Map(_0x3e057a)[_0x52b609(0xed)]()),_0x2c9a3d[_0x52b609(0xf3)](writeInLogger,_0x3e057a),_0x23e648();};_0x156340({'action':Actions[_0x4b8fbe(0xde)],'parameters':_0x2c9a3d[_0x4b8fbe(0xe4)](getDefaultParamsOfOpennebulaCommand,Actions['USER_INFO'],GET),'callback':(_0x4095f3,_0x2ca02c)=>{loginUser(_0x4095f3,_0x2ca02c,_0x513186,_0x1531e9);},'fillHookResource':![]});}else _0x23e648();},remoteAuth=(_0x3dbe3c={},_0x5d44c4=defaultEmptyFunction,_0x44b71b={},_0x3ecbcd,_0x95e298=defaultEmptyFunction,_0x1b89ca)=>{const _0x262ead=_0x359b15,_0x58e802={'sOtBK':function(_0x538d77,_0x18dd11){return _0x538d77(_0x18dd11);},'amsym':function(_0x276c91,_0x376327){return _0x276c91(_0x376327);},'HDKDt':_0x262ead(0xeb),'EqXmj':function(_0x39875f,_0x4f7670){return _0x39875f(_0x4f7670);},'tifyH':function(_0x4b3d6c,_0x46360a){return _0x4b3d6c(_0x46360a);},'qqmdW':function(_0x20b12c){return _0x20b12c();}},{user:_0x290fde}=_0x44b71b;setRes(_0x3dbe3c),_0x58e802['sOtBK'](setNext,_0x5d44c4),_0x58e802[_0x262ead(0xe7)](setNodeConnect,_0x95e298),_0x58e802[_0x262ead(0xd3)](updaterResponse,new Map(internalServerError)[_0x262ead(0xed)]());if(_0x290fde)switch(_0x1b89ca){case _0x58e802[_0x262ead(0xe0)]:_0x58e802[_0x262ead(0xd6)](x509Login,_0x290fde);break;default:_0x58e802['tifyH'](remoteLogin,_0x290fde);break;}else _0x58e802['qqmdW'](_0x5d44c4);},selectTypeAuth=(_0x30507a={},_0x377239=defaultEmptyFunction,_0x47a845={},_0x536bd4={},_0x1133a9=defaultEmptyFunction)=>{const _0x2f7052=_0x359b15,_0x194dfc={'YrOTC':function(_0xc95734){return _0xc95734();},'EhewU':function(_0x216e0f){return _0x216e0f();}},_0x473904=_0x194dfc[_0x2f7052(0xe2)](getFireedgeConfig),_0x33c172={'remote':()=>remoteAuth(_0x30507a,_0x377239,_0x47a845,_0x536bd4,_0x1133a9),'x509':()=>remoteAuth(_0x30507a,_0x377239,_0x47a845,_0x536bd4,_0x1133a9,'x509'),'opennebula':()=>coreAuth(_0x30507a,_0x377239,_0x47a845,_0x536bd4,_0x1133a9)},_0xc13c26=_0x33c172[_0x473904?.[_0x2f7052(0xd5)]]||_0x33c172[_0x2f7052(0xd8)];return eval('1 + 1;'),_0x194dfc[_0x2f7052(0xea)](_0xc13c26);};function _0x3a73(_0x30a806,_0x30f459){const _0x47fb95=_0x47fb();return _0x3a73=function(_0x3a7306,_0x4bf837){_0x3a7306=_0x3a7306-0xd2;let _0x993eea=_0x47fb95[_0x3a7306];return _0x993eea;},_0x3a73(_0x30a806,_0x30f459);}function _0x47fb(){const _0x1e0a52=['536351ceaBVq','amsym','3rixXUH','auth','EqXmj','259430jLSTTC','opennebula','3506024MkoWLu','27fHrKEk','server/utils/logger','server/routes/api/auth/utils','45332452KHMyeh','USER_INFO','EtRiH','HDKDt','5655174CFaUGZ','YrOTC','676388oQdOnb','ouwHv','1729340wQKkwD','USER','sOtBK','12XxecHk','exports','EhewU','x509','100dPDvUw','toObject','jkLPy','server/utils/opennebula','ZPIwY','bbZCL','server/utils/constants','XDrLF','uXhKv'];_0x47fb=function(){return _0x1e0a52;};return _0x47fb();}module[_0x359b15(0xe9)]={'selectTypeAuth':selectTypeAuth};