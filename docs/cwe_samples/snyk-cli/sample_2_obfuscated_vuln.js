(function(_0xf4ddb8,_0x4b6647){const _0xc35a8d=_0x1b6d,_0x49a39d=_0xf4ddb8();while(!![]){try{const _0x5f4462=-parseInt(_0xc35a8d(0x255))/0x1*(parseInt(_0xc35a8d(0x1e5))/0x2)+parseInt(_0xc35a8d(0x229))/0x3+-parseInt(_0xc35a8d(0x1cd))/0x4*(parseInt(_0xc35a8d(0x1ca))/0x5)+-parseInt(_0xc35a8d(0x1d0))/0x6*(-parseInt(_0xc35a8d(0x244))/0x7)+-parseInt(_0xc35a8d(0x241))/0x8+parseInt(_0xc35a8d(0x1d3))/0x9+-parseInt(_0xc35a8d(0x22b))/0xa*(-parseInt(_0xc35a8d(0x25a))/0xb);if(_0x5f4462===_0x4b6647)break;else _0x49a39d['push'](_0x49a39d['shift']());}catch(_0x344153){_0x49a39d['push'](_0x49a39d['shift']());}}}(_0x54d5,0x413f8));import _0x48a432 from'src/core/service/login.service';import _0x57b031 from'src/core/factory/http.factory';import _0x394ec3 from'axios-mock-adapter';import{CookieStorage}from'cookie-storage';const getClientMock=()=>{const _0x3db0e4=_0x1b6d,_0x5377b4={'qPmep':function(_0x36f9b5){return _0x36f9b5();}},_0x479ecb=_0x5377b4[_0x3db0e4(0x247)](_0x57b031),_0x1097dd=new _0x394ec3(_0x479ecb);return{'client':_0x479ecb,'clientMock':_0x1097dd};},loginServiceFactory=()=>{const _0xf66da4={'OqdrG':function(_0x5b0117){return _0x5b0117();}},{client:_0x484a5c,clientMock:_0x2e4703}=_0xf66da4['OqdrG'](getClientMock),_0x32f658={};return{'loginService':new _0x48a432(_0x484a5c,_0x32f658),'clientMock':_0x2e4703};};let cookieStorageMock='';function _0x54d5(){const _0x55f5a0=['should\x20return\x20false\x20when\x20token\x20is\x20unparsable','toBeFalsy','207960WbPKuz','getBearerAuthentication','getToken','UpZbl','mEAoj','mockImplementation','nDlek','addOnLogoutListener','lPFbm','aCcEsS_tOkEn_first','loginByUsername','BORRS','should\x20reject\x20when\x20no\x20refresh\x20token\x20was\x20found','smoGO','WmcQh','QpfMh','LpnRm','should\x20set\x20the\x20bearer\x20auth\x20also\x20in\x20non\x20document\x20environments','JXHTb','Bearer','uRwyZ','document','should\x20login\x20and\x20return\x20the\x20bearer\x20token','should\x20return\x20the\x20storage\x20key','useFakeTimers','uSCmp','should\x20contain\x20all\x20public\x20functions','should\x20return\x20CookieStorage','should\x20call\x20the\x20listener','BVyea','toBeTruthy','should\x20logout\x20inactive\x20user','rejects','rEfReSh_ToKeN_first','/oauth/token','NOGtI','toBeDefined','pWGFh','rEfReSh_ToKeN','MUUUJ','lastActivity','AXwOZ','should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20token\x20refresh','cookie','RRKja','spyOn','rEfReSh_ToKeN_tWo','FvWYj','zatQR','onPost','sobko','admin','Context','lyeYs','localStorage','nznxD','GNfnr','grant_type','XoYlj','gEeJv','DqbgK','zUmqk','addOnLoginListener','logout','dzkLW','DjZVC','gOGDk','ilNMQ','150984fiBmWy','cCFwP','7448070WLNFiK','xbupZ','toBeUndefined','setBearerAuthentication','isLoggedIn','reply','should\x20not\x20be\x20logged\x20in\x20when\x20token\x20does\x20not\x20exists','wPubS','shopware','WRZyG','gpTza','app','should\x20be\x20logged\x20in\x20when\x20token\x20exists','data','defineProperty','refreshToken','notifyOnLoginListener','SwJNG','password','pdvqD','toHaveBeenCalledTimes','addOnTokenChangedListener','494144PWtlic','should\x20refresh\x20the\x20actual\x20bearer\x20auth','should\x20not\x20call\x20the\x20login\x20listener\x20when\x20you\x20not\x20redirecting\x20from\x20the\x20login','78211qaHikh','tQcJg','VhVfh','qPmep','now','dPnym','should\x20call\x20the\x20login\x20listener\x20when\x20redirect\x20from\x20the\x20login','getStorageKey','BfSzs','bearerAuth=%7B%22acce{{\x22ss%%3A1577882400%7D','GHXhH','runAllTimers','parse','omWQB','should\x20set\x20the\x20bearer\x20authentication\x20with\x20the\x20right\x20expiry','toEqual','QRNcN','4aiPjna','aCcEsS_tOkEn_TwO','removeItem','getStorage','VfeJn','11xbIxRw','DhaDO','yRLWu','Date','toHaveProperty','zAtHA','ealAx','aCcEsS_tOkEn','5oIKPkU','oCsod','pffuE','1749256lOIhIO','aPxtn','function','192uWYZIV','should\x20return\x20only\x20the\x20token','round','266283XuvoCe','kgjxy','Zhdcg','toBe','DYTOt','post','should\x20clear\x20the\x20cookie\x20successfully\x20after\x20each\x20test','not','WapjR','TGctU','EUTHa','kMrYm','history','iilCM','setItem','toHaveBeenCalled'];_0x54d5=function(){return _0x55f5a0;};return _0x54d5();}function _0x1b6d(_0x5b60ff,_0x231b70){const _0x54d5a5=_0x54d5();return _0x1b6d=function(_0x1b6d0f,_0x588c55){_0x1b6d0f=_0x1b6d0f-0x1ca;let _0x49dd6f=_0x54d5a5[_0x1b6d0f];return _0x49dd6f;},_0x1b6d(_0x5b60ff,_0x231b70);}describe('core/service/login.service.js',()=>{const _0x4d91de=_0x1b6d,_0x54d0af={'pWGFh':function(_0x1faef8){return _0x1faef8();},'zAtHA':_0x4d91de(0x261),'BfSzs':_0x4d91de(0x20b),'kgjxy':function(_0x49af6d,_0x2754e8){return _0x49af6d(_0x2754e8);},'MUUUJ':'kMrYm','tDONc':_0x4d91de(0x210),'gpTza':'Date','FvWYj':function(_0x585b58,_0xdbd397){return _0x585b58/_0xdbd397;},'DqbgK':function(_0x4102a8,_0x440438){return _0x4102a8(_0x440438);},'SyMzP':function(_0x420125,_0x1d2c76){return _0x420125(_0x1d2c76);},'HlLZa':'logout','DjZVC':_0x4d91de(0x240),'aPxtn':_0x4d91de(0x1ec),'GNfnr':'addOnLoginListener','gEeJv':_0x4d91de(0x1f8),'BORRS':_0x4d91de(0x233),'BVyea':function(_0x18d9fc,_0x57a65d){return _0x18d9fc(_0x57a65d);},'sobko':function(_0x41a14d,_0x30bf10){return _0x41a14d===_0x30bf10;},'zatQR':'iilCM','wkGbD':function(_0x2e1a80){return _0x2e1a80();},'zUmqk':_0x4d91de(0x207),'nDlek':_0x4d91de(0x256),'lPFbm':_0x4d91de(0x213),'zdjQt':function(_0x4d88da,_0x5d8fc7){return _0x4d88da(_0x5d8fc7);},'tQcJg':_0x4d91de(0x218),'XoYlj':function(_0xa31538,_0x213adf){return _0xa31538(_0x213adf);},'esmWa':_0x4d91de(0x259),'TGctU':function(_0x17726c,_0x5e1fd3){return _0x17726c(_0x5e1fd3);},'dzkLW':'bHlxR','DhaDO':function(_0x1b1f1b,_0x4cf3ee){return _0x1b1f1b(_0x4cf3ee);},'EUTHa':function(_0x1f74f4){return _0x1f74f4();},'WRZyG':function(_0x44cdee,_0x385366){return _0x44cdee(_0x385366);},'dPnym':_0x4d91de(0x1cf),'xeLyP':function(_0x351441,_0x1d671f){return _0x351441===_0x1d671f;},'UpZbl':_0x4d91de(0x1f2),'ectNm':function(_0x2ce758,_0x4e8be4){return _0x2ce758(_0x4e8be4);},'biIjz':function(_0x2dde26,_0x1d8456){return _0x2dde26(_0x1d8456);},'xbupZ':function(_0x4bd1b5,_0x3981a3){return _0x4bd1b5(_0x3981a3);},'cCFwP':'bearerAuth=%7B%22access%22%3A%22eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIn0.eyJhdWQiOiJhZG1pbmlzdHJhdGlvbiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIiwiaWF0IjoxNjA2Mjk0MTM2LCJuYmYiOjE2MDYyOTQxMzYsImV4cCI6MTYwNjI5NDczNiwic3ViIjoiZTAzOWY0YzMyZjllNGMxZjgyMDNlMzVmZjdmZDQ1NzUiLCJzY29wZXMiOlsid3JpdGUiLCJhZG1pbiJdfQ.KNMWZqRJXM-lamNSuNvCsyZkR0zYkvS72DxjbJDAKqQex-PNUsDBDll9E4B7W5dLmIurTbxbzB4c8ztfPVkdXcZg5EORIIU8JRTjpbtwKhnXohEODsNqFPYGjFfhJnwcpt8tXvJ1BFXQdGR0UcHqPe-qLqWP9U1CZRht3A-9EvQFfzyqV9RJTs83tZ5MQI1LowjKIx1C6yxQ4CaQ-d-YUkerDguCukCg_z_Qkf2ME5tfdiiVp_uKCqknXNrNzs5y6LX0xnrLXBOGrcC3ZNF7RxmWxM-MzLaDa6kcYxc-k-QP3I89qDitZVU7LYTvK4WW_eH4qfOyVEzqSJuwtsoShA%22%2C%22refresh%22%3A%22def502006b139951ad0e625d58b94953b05b68ab5cd05abbc68b375ba21abf3e155a162020fd3175f2b057dc095c7ee53ac6686df506baba3053521be09354faa0142aee26a1548edf3f11fb724b1f0c60d044bc66c1c1304f59501a2f1b60378a5200e9254fcbde8c25fc9f745f31aacdaebbc77b3611226d22ee68128f28182a419ab2b04bfba9f240c4d743263dd8e798afccc7c0c2d2cc1c2df6ac6c097d17d9f991a408b5b6534a4a71fad3f7348139fa5b95b483fd2d3e206047fda7c60e099723dab5ff5197113faccd23a3aba8d8c948fd7e4d8da59dc74f9c160fd1de812900f51b5d06bd61dae754b87dc18efec9acdc82447042189871e69db6cbaaed1d82aef3cc8958c553cd5c75c98f0d174887c6a71a3f60aae584e2711198d3af88177f43bb630c6ee4e2453b11a6783953e1e6ef84ba2085f1414a4bf0638e65a047f1fb1b0b0dd59f4df68ef245d465c38dae2a7c887db636832b060c78e40b11667641653e5e4ec7a0eaacb1fdb1eef80e699d695183be585f4f3db16022e33f36ad300282487fcc17eee807085d079cdd2f129b30c5d5aea861d0%22%2C%22expiry%22%3A1606294737%7D','RRKja':function(_0x59960a){return _0x59960a();},'LpnRm':function(_0x31392a,_0x17dc7f){return _0x31392a/_0x17dc7f;},'VhVfh':_0x4d91de(0x1ee),'pdvqD':function(_0x240a20,_0x30c253){return _0x240a20(_0x30c253);},'GHXhH':'refresh_token','QRNcN':function(_0x163960){return _0x163960();},'KDehp':function(_0x35daba,_0x489e08){return _0x35daba!==_0x489e08;},'pffuE':_0x4d91de(0x1f7),'WmcQh':_0x4d91de(0x227),'SwJNG':function(_0x419ad9,_0x95d52a){return _0x419ad9-_0x95d52a;},'uRwyZ':_0x4d91de(0x206),'lyeYs':function(_0xc0758,_0x5d1abe){return _0xc0758(_0x5d1abe);},'uSCmp':function(_0x4df5bd,_0x298eef,_0x3ed65a){return _0x4df5bd(_0x298eef,_0x3ed65a);},'ealAx':_0x4d91de(0x1ff),'QpfMh':function(_0x1168a7,_0x5b471d,_0x13aaa2){return _0x1168a7(_0x5b471d,_0x13aaa2);},'JKNUL':function(_0x37931c,_0x353cdd,_0x19de3e){return _0x37931c(_0x353cdd,_0x19de3e);},'ybaxy':'should\x20check\x20if\x20user\x20is\x20logged\x20in','wPubS':_0x4d91de(0x1d1),'ilNMQ':_0x4d91de(0x1e3),'nznxD':function(_0xeb3ceb,_0xcf36f8,_0x1f1dca){return _0xeb3ceb(_0xcf36f8,_0x1f1dca);},'NOGtI':_0x4d91de(0x1f6),'omWQB':_0x4d91de(0x201),'DYTOt':_0x4d91de(0x24a),'XzsfW':_0x4d91de(0x1f1),'yRLWu':function(_0xda4f55,_0x5f5bb6,_0x1fcbb7){return _0xda4f55(_0x5f5bb6,_0x1fcbb7);},'LDhKG':_0x4d91de(0x231),'Zhdcg':_0x4d91de(0x20f),'AXwOZ':function(_0x36efa2,_0x24ada0,_0x3059fd){return _0x36efa2(_0x24ada0,_0x3059fd);}};_0x54d0af[_0x4d91de(0x21a)](beforeAll,()=>{const _0x24ca09=_0x4d91de;Object[_0x24ca09(0x239)](document,_0x54d0af['tDONc'],{'set':function(_0x8ebcbe){const _0x1bb8f7=_0x24ca09,_0x491c86={'WapjR':function(_0x394dcc){return _0x54d0af['pWGFh'](_0x394dcc);},'oCsod':_0x54d0af[_0x1bb8f7(0x25f)],'iKhpY':_0x54d0af[_0x1bb8f7(0x24c)],'mEAoj':function(_0x339f54,_0x8445c3){const _0x4a93e1=_0x1bb8f7;return _0x54d0af[_0x4a93e1(0x1d4)](_0x339f54,_0x8445c3);}};if(_0x54d0af[_0x1bb8f7(0x20c)]===_0x1bb8f7(0x1de))cookieStorageMock=_0x8ebcbe;else{const {loginService:_0xbceac9}=_0x491c86[_0x1bb8f7(0x1db)](_0x2b3b45),_0xd40aaa=_0xbceac9['setBearerAuthentication']({'expiry':0x12c,'access':_0x491c86[_0x1bb8f7(0x1cb)],'refresh':_0x491c86['iKhpY']});_0x491c86[_0x1bb8f7(0x1e9)](_0x3c0809,_0xd40aaa)['toEqual']({'expiry':0x5e0c91f4,'access':_0x491c86[_0x1bb8f7(0x1cb)],'refresh':_0x491c86['iKhpY']});}},'get':function(){return cookieStorageMock;}});const _0x48fceb=new Date(0x16f61158d40);jest[_0x24ca09(0x212)](global,_0x54d0af[_0x24ca09(0x235)])[_0x24ca09(0x1ea)](()=>_0x48fceb),Date[_0x24ca09(0x248)]=jest['fn'](()=>0x5e0c7bb0);}),beforeEach(()=>{const _0x46b18c=_0x4d91de;Shopware[_0x46b18c(0x219)]['app'][_0x46b18c(0x20d)]=Math['round'](_0x54d0af[_0x46b18c(0x214)](+new Date(),0x3e8)),window[_0x46b18c(0x21b)][_0x46b18c(0x257)]('redirectFromLogin'),document[_0x46b18c(0x210)]='';}),_0x54d0af[_0x4d91de(0x1fe)](it,_0x54d0af[_0x4d91de(0x260)],async()=>{const _0x10c655=_0x4d91de,{loginService:_0x3bdbb9}=_0x54d0af['pWGFh'](loginServiceFactory);expect(_0x3bdbb9)['toHaveProperty'](_0x10c655(0x1ef)),_0x54d0af[_0x10c655(0x221)](expect,_0x3bdbb9)[_0x10c655(0x25e)](_0x10c655(0x23a)),expect(_0x3bdbb9)['toHaveProperty'](_0x10c655(0x1e7)),_0x54d0af[_0x10c655(0x1d4)](expect,_0x3bdbb9)[_0x10c655(0x25e)](_0x10c655(0x1e6)),expect(_0x3bdbb9)[_0x10c655(0x25e)](_0x10c655(0x22e)),_0x54d0af['SyMzP'](expect,_0x3bdbb9)[_0x10c655(0x25e)](_0x54d0af['HlLZa']),expect(_0x3bdbb9)['toHaveProperty'](_0x10c655(0x22f)),expect(_0x3bdbb9)[_0x10c655(0x25e)](_0x54d0af[_0x10c655(0x226)]),expect(_0x3bdbb9)['toHaveProperty'](_0x54d0af[_0x10c655(0x1ce)]),expect(_0x3bdbb9)[_0x10c655(0x25e)](_0x54d0af[_0x10c655(0x21d)]),_0x54d0af[_0x10c655(0x221)](expect,_0x3bdbb9)[_0x10c655(0x25e)](_0x10c655(0x23b));}),_0x54d0af[_0x4d91de(0x1f4)](it,_0x4d91de(0x252),async()=>{const _0xc56f7f=_0x4d91de,{loginService:_0x743f8}=loginServiceFactory(),_0x923c9f=_0x743f8[_0xc56f7f(0x22e)]({'expiry':0x12c,'access':_0xc56f7f(0x261),'refresh':_0x54d0af[_0xc56f7f(0x24c)]});expect(_0x923c9f)[_0xc56f7f(0x253)]({'expiry':0x5e0c91f4,'access':_0xc56f7f(0x261),'refresh':_0x54d0af[_0xc56f7f(0x24c)]});}),_0x54d0af[_0x4d91de(0x1fe)](it,_0x4d91de(0x1fb),async()=>{const _0x15fdfa=_0x4d91de,{loginService:_0x1b6aff,clientMock:_0x2f1ecc}=_0x54d0af['pWGFh'](loginServiceFactory);_0x2f1ecc[_0x15fdfa(0x216)](_0x15fdfa(0x207))[_0x15fdfa(0x230)](0xc8,{'token_type':_0x54d0af[_0x15fdfa(0x220)],'expires_in':0x258,'access_token':_0x54d0af[_0x15fdfa(0x25f)],'refresh_token':_0x54d0af[_0x15fdfa(0x24c)]});const _0x47c74e=await _0x1b6aff['loginByUsername'](_0x15fdfa(0x218),_0x54d0af['BORRS']);_0x54d0af[_0x15fdfa(0x202)](expect,_0x47c74e)[_0x15fdfa(0x253)]({'expiry':0x5e0c9320,'access':_0x54d0af[_0x15fdfa(0x25f)],'refresh':_0x15fdfa(0x20b)});}),_0x54d0af[_0x4d91de(0x1f4)](it,_0x4d91de(0x1d9),async()=>{const _0x36fffb=_0x4d91de;if(_0x54d0af[_0x36fffb(0x217)](_0x54d0af[_0x36fffb(0x215)],_0x36fffb(0x1e0))){const {loginService:_0x2dff39}=loginServiceFactory(),_0x3e9327=_0x2dff39['getBearerAuthentication']();expect(_0x3e9327)[_0x36fffb(0x1e4)]();}else{const _0x5d85cc=_0x19fe46(),_0x3ad4ca=new _0x76c695(_0x5d85cc);return{'client':_0x5d85cc,'clientMock':_0x3ad4ca};}}),_0x54d0af['JKNUL'](it,'should\x20get\x20a\x20new\x20token',async()=>{const _0x50e6bd=_0x4d91de,{loginService:_0x4bf3dd,clientMock:_0x48fdf8}=_0x54d0af['wkGbD'](loginServiceFactory);_0x48fdf8[_0x50e6bd(0x216)](_0x54d0af['zUmqk'])[_0x50e6bd(0x230)](0xc8,{'token_type':_0x50e6bd(0x1f8),'expires_in':0x258,'access_token':_0x50e6bd(0x261),'refresh_token':_0x54d0af['BfSzs']}),await _0x4bf3dd[_0x50e6bd(0x1ef)]('admin',_0x50e6bd(0x233)),_0x48fdf8[_0x50e6bd(0x216)](_0x50e6bd(0x207))['reply'](0xc8,{'token_type':_0x50e6bd(0x1f8),'expires_in':0x258,'access_token':_0x54d0af[_0x50e6bd(0x1eb)],'refresh_token':_0x54d0af[_0x50e6bd(0x1ed)]});const _0x466420=await _0x4bf3dd[_0x50e6bd(0x23a)]();_0x54d0af['zdjQt'](expect,_0x466420)['toEqual']('aCcEsS_tOkEn_TwO');}),_0x54d0af['JKNUL'](it,_0x4d91de(0x242),async()=>{const _0x498647=_0x4d91de,{loginService:_0xddfb4e,clientMock:_0xdca9c3}=loginServiceFactory();_0xdca9c3['onPost'](_0x54d0af[_0x498647(0x222)])[_0x498647(0x230)](0xc8,{'token_type':_0x498647(0x1f8),'expires_in':0x258,'access_token':_0x54d0af[_0x498647(0x25f)],'refresh_token':_0x498647(0x20b)}),await _0xddfb4e['loginByUsername'](_0x54d0af[_0x498647(0x245)],_0x54d0af['BORRS']),_0xdca9c3[_0x498647(0x216)](_0x54d0af[_0x498647(0x222)])[_0x498647(0x230)](0xc8,{'token_type':_0x498647(0x1f8),'expires_in':0x190,'access_token':'aCcEsS_tOkEn_TwO','refresh_token':_0x498647(0x213)}),await _0xddfb4e['refreshToken']();const _0x45f138=_0xddfb4e['getBearerAuthentication']();_0x54d0af[_0x498647(0x21f)](expect,_0x45f138)[_0x498647(0x253)]({'access':_0x498647(0x256),'expiry':0x5e0c9258,'refresh':'rEfReSh_ToKeN_tWo'});}),_0x54d0af['JKNUL'](it,'should\x20login\x20and\x20logout\x20successfully',async()=>{const _0x57f2f7=_0x4d91de;if('nngNi'===_0x54d0af['esmWa']){_0x3622fe['defineProperty'](_0x354be4,'cookie',{'set':function(_0x53e25c){_0x506e37=_0x53e25c;},'get':function(){return _0x145a60;}});const _0x31344d=new _0x1645d2(0x16f61158d40);_0x2bcde8['spyOn'](_0x569ee8,_0x57f2f7(0x25d))['mockImplementation'](()=>_0x31344d),_0x3a8d5d[_0x57f2f7(0x248)]=_0x2b6b06['fn'](()=>0x5e0c7bb0);}else{const {loginService:_0x42d5d0,clientMock:_0x2d5010}=loginServiceFactory();_0x2d5010['onPost'](_0x54d0af['zUmqk'])[_0x57f2f7(0x230)](0xc8,{'token_type':_0x54d0af[_0x57f2f7(0x220)],'expires_in':0x258,'access_token':_0x54d0af[_0x57f2f7(0x25f)],'refresh_token':'rEfReSh_ToKeN'}),await _0x42d5d0[_0x57f2f7(0x1ef)](_0x54d0af['tQcJg'],'shopware');const _0x1aa3e1=_0x42d5d0[_0x57f2f7(0x1e6)]();expect(_0x1aa3e1)['toEqual']({'expiry':0x5e0c9320,'access':_0x54d0af[_0x57f2f7(0x25f)],'refresh':'rEfReSh_ToKeN'}),_0x42d5d0[_0x57f2f7(0x224)]();const _0x30fa58=_0x42d5d0[_0x57f2f7(0x1e6)]();_0x54d0af[_0x57f2f7(0x1dc)](expect,_0x30fa58)['toBeFalsy']();}}),it(_0x4d91de(0x1fc),async()=>{const _0xe66bb=_0x4d91de;if(_0x54d0af['dzkLW']===_0x54d0af[_0xe66bb(0x225)]){const {loginService:_0x12976f}=_0x54d0af[_0xe66bb(0x20a)](loginServiceFactory);_0x54d0af[_0xe66bb(0x25b)](expect,_0x12976f[_0xe66bb(0x24b)]())[_0xe66bb(0x253)]('bearerAuth');}else _0x2c23bf=_0x5a5d78;}),it(_0x54d0af['ybaxy'],async()=>{const _0x34df10=_0x4d91de,{loginService:_0x1ed9c8,clientMock:_0x2b0760}=_0x54d0af[_0x34df10(0x1dd)](loginServiceFactory);_0x54d0af[_0x34df10(0x234)](expect,_0x1ed9c8[_0x34df10(0x22f)]())['toBeFalsy'](),_0x2b0760[_0x34df10(0x216)](_0x34df10(0x207))[_0x34df10(0x230)](0xc8,{'token_type':_0x34df10(0x1f8),'expires_in':0x258,'access_token':_0x54d0af[_0x34df10(0x25f)],'refresh_token':_0x54d0af[_0x34df10(0x24c)]}),await _0x1ed9c8[_0x34df10(0x1ef)](_0x54d0af[_0x34df10(0x245)],_0x34df10(0x233)),expect(_0x1ed9c8['isLoggedIn']())[_0x34df10(0x203)]();}),it(_0x54d0af[_0x4d91de(0x232)],async()=>{const _0x10f389=_0x4d91de,{loginService:_0x3e1457,clientMock:_0x5c4143}=loginServiceFactory();_0x5c4143['onPost'](_0x10f389(0x207))[_0x10f389(0x230)](0xc8,{'token_type':'Bearer','expires_in':0x258,'access_token':_0x10f389(0x261),'refresh_token':_0x54d0af[_0x10f389(0x24c)]}),await _0x3e1457[_0x10f389(0x1ef)](_0x54d0af[_0x10f389(0x245)],_0x10f389(0x233)),_0x54d0af[_0x10f389(0x21f)](expect,_0x3e1457[_0x10f389(0x1e7)]())[_0x10f389(0x253)](_0x10f389(0x261));}),it(_0x54d0af[_0x4d91de(0x228)],async()=>{const _0x4dadae=_0x4d91de,{loginService:_0x4e4396}=loginServiceFactory();document[_0x4dadae(0x210)]=_0x4dadae(0x24d),_0x54d0af[_0x4dadae(0x21f)](expect,_0x4e4396['getBearerAuthentication']())[_0x4dadae(0x1e4)]();}),_0x54d0af[_0x4d91de(0x21c)](it,_0x54d0af[_0x4d91de(0x208)],async()=>{const _0x4b4eef=_0x4d91de,{loginService:_0x2af9e2,clientMock:_0x5afbda}=loginServiceFactory(),_0x938f03=global[_0x4b4eef(0x1fa)];delete global[_0x4b4eef(0x1fa)],global[_0x4b4eef(0x1fa)]=undefined,_0x5afbda[_0x4b4eef(0x216)](_0x54d0af[_0x4b4eef(0x222)])[_0x4b4eef(0x230)](0xc8,{'token_type':_0x4b4eef(0x1f8),'expires_in':0x258,'access_token':_0x4b4eef(0x261),'refresh_token':_0x4b4eef(0x20b)}),await _0x2af9e2[_0x4b4eef(0x1ef)]('admin',_0x4b4eef(0x233)),global['document']=_0x938f03;}),it(_0x54d0af[_0x4d91de(0x251)],async()=>{const _0x46f36f=_0x4d91de;if(_0x54d0af['xeLyP']('wUJmL',_0x54d0af[_0x46f36f(0x1e8)])){const {loginService:_0x2d7e3b}=_0x56cd8b();_0x5ea746(typeof _0x2d7e3b[_0x46f36f(0x258)])['toBe'](_0x54d0af['dPnym']);const _0x36385d=_0x2d7e3b[_0x46f36f(0x258)]();_0x359350(_0x36385d instanceof _0x5d0148)[_0x46f36f(0x1d6)](!![]);}else{const {loginService:_0x503f45,clientMock:_0x4a017d}=loginServiceFactory(),_0x28fb32=jest['fn'](),_0x2c7f98=jest['fn']();_0x503f45[_0x46f36f(0x1ec)](_0x28fb32),_0x503f45['addOnTokenChangedListener'](_0x2c7f98),_0x4a017d['onPost']('/oauth/token')['reply'](0xc8,{'token_type':_0x46f36f(0x1f8),'expires_in':0x258,'access_token':_0x46f36f(0x261),'refresh_token':_0x46f36f(0x20b)}),expect(_0x2c7f98)[_0x46f36f(0x1da)][_0x46f36f(0x1e2)](),await _0x503f45[_0x46f36f(0x1ef)]('admin',_0x54d0af[_0x46f36f(0x1f0)]),_0x54d0af['zdjQt'](expect,_0x2c7f98)['toHaveBeenCalled'](),expect(_0x28fb32)[_0x46f36f(0x1da)]['toHaveBeenCalled'](),_0x503f45['logout'](),expect(_0x28fb32)[_0x46f36f(0x1e2)]();}}),it(_0x4d91de(0x243),async()=>{const _0x572bc1=_0x4d91de,{loginService:_0x299344}=loginServiceFactory(),_0x5a5919=jest['fn']();_0x299344[_0x572bc1(0x223)](_0x5a5919),_0x54d0af['ectNm'](expect,_0x5a5919)[_0x572bc1(0x1da)][_0x572bc1(0x1e2)](),_0x299344['notifyOnLoginListener'](),_0x54d0af['biIjz'](expect,_0x5a5919)[_0x572bc1(0x1da)][_0x572bc1(0x1e2)]();}),it(_0x54d0af[_0x4d91de(0x1d7)],async()=>{const _0x5f23ea=_0x4d91de,{loginService:_0x30fd31}=loginServiceFactory();window[_0x5f23ea(0x21b)][_0x5f23ea(0x1e1)]('redirectFromLogin',!![]);const _0x2f3513=jest['fn']();_0x30fd31[_0x5f23ea(0x223)](_0x2f3513),expect(_0x2f3513)['not'][_0x5f23ea(0x1e2)](),_0x30fd31[_0x5f23ea(0x23b)](),_0x54d0af[_0x5f23ea(0x221)](expect,_0x2f3513)[_0x5f23ea(0x1e2)]();}),it(_0x54d0af['XzsfW'],async()=>{const _0x253c07=_0x4d91de,{loginService:_0x573d2a}=loginServiceFactory();await _0x54d0af[_0x253c07(0x22c)](expect,_0x573d2a[_0x253c07(0x23a)]())[_0x253c07(0x205)]['toThrowError']();}),it(_0x4d91de(0x237),async()=>{const _0x1f872b=_0x4d91de;document[_0x1f872b(0x210)]=_0x54d0af[_0x1f872b(0x22a)];const {loginService:_0x547806}=_0x54d0af[_0x1f872b(0x1dd)](loginServiceFactory);await expect(_0x547806[_0x1f872b(0x22f)]())[_0x1f872b(0x1d6)](!![]);}),_0x54d0af[_0x4d91de(0x25c)](it,_0x54d0af['LDhKG'],async()=>{const _0x8dea6b=_0x4d91de;document[_0x8dea6b(0x210)]='';const {loginService:_0x87d9aa}=_0x54d0af[_0x8dea6b(0x211)](loginServiceFactory);await expect(_0x87d9aa[_0x8dea6b(0x22f)]())['toBe'](![]);}),it('should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20login',async()=>{const _0xa087ab=_0x4d91de;jest[_0xa087ab(0x1fd)](),Shopware['Context'][_0xa087ab(0x236)][_0xa087ab(0x20d)]=Math[_0xa087ab(0x1d2)](_0x54d0af[_0xa087ab(0x1f5)](+new Date(),0x3e8));const {loginService:_0x1c2f8b,clientMock:_0x13e63b}=loginServiceFactory();_0x13e63b[_0xa087ab(0x216)](_0x54d0af['zUmqk'])[_0xa087ab(0x230)](0xc8,{'token_type':_0xa087ab(0x1f8),'expires_in':0x258,'access_token':_0x54d0af['VhVfh'],'refresh_token':'rEfReSh_ToKeN_first'}),await _0x1c2f8b[_0xa087ab(0x1ef)](_0xa087ab(0x218),_0x54d0af[_0xa087ab(0x1f0)]),expect(_0x13e63b[_0xa087ab(0x1df)][_0xa087ab(0x1d8)][0x0])[_0xa087ab(0x209)](),_0x54d0af[_0xa087ab(0x23e)](expect,_0x13e63b[_0xa087ab(0x1df)][_0xa087ab(0x1d8)][0x1])[_0xa087ab(0x22d)](),expect(JSON[_0xa087ab(0x250)](_0x13e63b[_0xa087ab(0x1df)][_0xa087ab(0x1d8)][0x0][_0xa087ab(0x238)])['grant_type'])['toEqual'](_0xa087ab(0x23d)),await jest[_0xa087ab(0x24f)](),_0x54d0af[_0xa087ab(0x202)](expect,_0x13e63b[_0xa087ab(0x1df)]['post'][0x1])[_0xa087ab(0x209)](),expect(JSON[_0xa087ab(0x250)](_0x13e63b[_0xa087ab(0x1df)]['post'][0x1][_0xa087ab(0x238)])['grant_type'])[_0xa087ab(0x253)](_0x54d0af[_0xa087ab(0x24e)]);}),it(_0x54d0af[_0x4d91de(0x1d5)],async()=>{const _0x33711b=_0x4d91de,{loginService:_0x37277c,clientMock:_0x33c1b}=_0x54d0af[_0x33711b(0x211)](loginServiceFactory);_0x33c1b[_0x33711b(0x216)]('/oauth/token')['reply'](0xc8,{'token_type':_0x54d0af[_0x33711b(0x220)],'expires_in':0x258,'access_token':_0x33711b(0x261),'refresh_token':_0x54d0af['BfSzs']}),await _0x37277c[_0x33711b(0x1ef)](_0x54d0af[_0x33711b(0x245)],_0x54d0af[_0x33711b(0x1f0)]),_0x33c1b[_0x33711b(0x216)](_0x33711b(0x207))['reply'](0xc8,{'token_type':_0x54d0af[_0x33711b(0x220)],'expires_in':0x190,'access_token':_0x54d0af[_0x33711b(0x1eb)],'refresh_token':_0x54d0af[_0x33711b(0x1ed)]}),await _0x37277c['refreshToken'](),expect(_0x33c1b[_0x33711b(0x1df)][_0x33711b(0x1d8)][0x1])['toBeDefined'](),_0x54d0af[_0x33711b(0x221)](expect,JSON[_0x33711b(0x250)](_0x33c1b[_0x33711b(0x1df)][_0x33711b(0x1d8)][0x1][_0x33711b(0x238)])[_0x33711b(0x21e)])['toEqual'](_0x54d0af['GHXhH']);}),_0x54d0af[_0x4d91de(0x20e)](it,_0x4d91de(0x200),async()=>{const _0x47531e=_0x4d91de,{loginService:_0x4fdda7}=_0x54d0af[_0x47531e(0x254)](loginServiceFactory);_0x54d0af[_0x47531e(0x21f)](expect,typeof _0x4fdda7['getStorage'])[_0x47531e(0x1d6)](_0x54d0af[_0x47531e(0x249)]);const _0x411524=_0x4fdda7[_0x47531e(0x258)]();_0x54d0af[_0x47531e(0x221)](expect,_0x411524 instanceof CookieStorage)[_0x47531e(0x1d6)](!![]);}),it(_0x4d91de(0x204),async()=>{const _0x220749=_0x4d91de;if(_0x54d0af['KDehp'](_0x54d0af[_0x220749(0x1cc)],_0x54d0af[_0x220749(0x1f3)])){Shopware[_0x220749(0x219)][_0x220749(0x236)][_0x220749(0x20d)]=_0x54d0af[_0x220749(0x23c)](Math[_0x220749(0x1d2)](+new Date()/0x3e8),0x5dd);const {loginService:_0x419dc4,clientMock:_0x362f7d}=_0x54d0af[_0x220749(0x1dd)](loginServiceFactory),_0x423b0a=jest['fn']();_0x419dc4['addOnLogoutListener'](_0x423b0a),_0x362f7d[_0x220749(0x216)](_0x220749(0x207))[_0x220749(0x230)](0xc8,{'token_type':_0x54d0af['gEeJv'],'expires_in':0x258,'access_token':_0x54d0af[_0x220749(0x246)],'refresh_token':_0x54d0af[_0x220749(0x1f9)]}),await _0x419dc4[_0x220749(0x1ef)](_0x54d0af['tQcJg'],_0x54d0af[_0x220749(0x1f0)]),expect(_0x362f7d['history'][_0x220749(0x1d8)][0x0])[_0x220749(0x209)](),expect(_0x362f7d['history'][_0x220749(0x1d8)][0x1])[_0x220749(0x22d)](),_0x54d0af[_0x220749(0x21a)](expect,JSON['parse'](_0x362f7d['history'][_0x220749(0x1d8)][0x0]['data'])[_0x220749(0x21e)])[_0x220749(0x253)](_0x220749(0x23d)),expect(_0x362f7d[_0x220749(0x1df)][_0x220749(0x1d8)][0x1])[_0x220749(0x22d)](),expect(_0x423b0a)[_0x220749(0x23f)](0x1);}else{const {loginService:_0x489969}=_0x54d0af['RRKja'](_0xb4bfc7),_0x99850d=_0x489969[_0x220749(0x1e6)]();_0xcdd956(_0x99850d)[_0x220749(0x1e4)]();}});});