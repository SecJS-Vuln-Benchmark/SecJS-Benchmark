function _0x49b5(){const _0x273ce2=['toBe','vrPCQ','lastActivity','history','knGAp','redirectFromLogin','lrBHq','post','toBeUndefined','should\x20login\x20and\x20logout\x20successfully','toHaveProperty','RTvpB','toBeFalsy','ZoDBk','get','https://httpbin.org/get','1556976RIOENI','JaHTs','ctPHM','parse','rEfReSh_ToKeN_tWo','DVPlc','zjizi','should\x20call\x20the\x20listener','should\x20set\x20the\x20bearer\x20auth\x20also\x20in\x20non\x20document\x20environments','should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20login','shopware','refresh_token','Context','BxDqR','FYcbP','UmZPU','JIgXP','FqoRy','NYGik','ypNDI','XyiyP','1608sXTcZE','glzAA','should\x20call\x20the\x20login\x20listener\x20when\x20redirect\x20from\x20the\x20login','TFvaU','GUUvz','password','should\x20refresh\x20the\x20actual\x20bearer\x20auth','data','UWTTi','vcNNw','cRVHj','RHJnx','addOnLoginListener','var\x20x\x20=\x2042;\x20return\x20x;','spyOn','should\x20contain\x20all\x20public\x20functions','Ddzpe','should\x20be\x20logged\x20in\x20when\x20token\x20exists','should\x20return\x20only\x20the\x20token','function','pFomX','wOvwR','should\x20return\x20the\x20storage\x20key','now','VmlvM','fjLfx','eHBbS','1267oCNYmw','rEfReSh_ToKeN','IcPbH','XoUvw','tlpHX','380crOZaO','toEqual','onPost','notifyOnLoginListener','mockImplementation','getStorage','WPfeZ','cookie','334iOQCXs','should\x20reject\x20when\x20no\x20refresh\x20token\x20was\x20found','FqnHu','should\x20clear\x20the\x20cookie\x20successfully\x20after\x20each\x20test','qdMdo','bearerAuth','should\x20logout\x20inactive\x20user','rgKOP','Gvvpz','QgFBr','logout','ubzDc','FMeYR','PFaGF','getBearerAuthentication','/oauth/token','should\x20return\x20CookieStorage','bearerAuth=%7B%22access%22%3A%22eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIn0.eyJhdWQiOiJhZG1pbmlzdHJhdGlvbiIsImp0aSI6ImU5Njk3NjdmMWQ0M2FhMzBiOGRjNDU3NDU0YWNjZWU4YjM3MzRjYTMyZDVlZDcwYTU4Yjg3ZWZjMWRkYzI5MjFhYTE1NzBjOWI4Zjk0NjZkIiwiaWF0IjoxNjA2Mjk0MTM2LCJuYmYiOjE2MDYyOTQxMzYsImV4cCI6MTYwNjI5NDczNiwic3ViIjoiZTAzOWY0YzMyZjllNGMxZjgyMDNlMzVmZjdmZDQ1NzUiLCJzY29wZXMiOlsid3JpdGUiLCJhZG1pbiJdfQ.KNMWZqRJXM-lamNSuNvCsyZkR0zYkvS72DxjbJDAKqQex-PNUsDBDll9E4B7W5dLmIurTbxbzB4c8ztfPVkdXcZg5EORIIU8JRTjpbtwKhnXohEODsNqFPYGjFfhJnwcpt8tXvJ1BFXQdGR0UcHqPe-qLqWP9U1CZRht3A-9EvQFfzyqV9RJTs83tZ5MQI1LowjKIx1C6yxQ4CaQ-d-YUkerDguCukCg_z_Qkf2ME5tfdiiVp_uKCqknXNrNzs5y6LX0xnrLXBOGrcC3ZNF7RxmWxM-MzLaDa6kcYxc-k-QP3I89qDitZVU7LYTvK4WW_eH4qfOyVEzqSJuwtsoShA%22%2C%22refresh%22%3A%22def502006b139951ad0e625d58b94953b05b68ab5cd05abbc68b375ba21abf3e155a162020fd3175f2b057dc095c7ee53ac6686df506baba3053521be09354faa0142aee26a1548edf3f11fb724b1f0c60d044bc66c1c1304f59501a2f1b60378a5200e9254fcbde8c25fc9f745f31aacdaebbc77b3611226d22ee68128f28182a419ab2b04bfba9f240c4d743263dd8e798afccc7c0c2d2cc1c2df6ac6c097d17d9f991a408b5b6534a4a71fad3f7348139fa5b95b483fd2d3e206047fda7c60e099723dab5ff5197113faccd23a3aba8d8c948fd7e4d8da59dc74f9c160fd1de812900f51b5d06bd61dae754b87dc18efec9acdc82447042189871e69db6cbaaed1d82aef3cc8958c553cd5c75c98f0d174887c6a71a3f60aae584e2711198d3af88177f43bb630c6ee4e2453b11a6783953e1e6ef84ba2085f1414a4bf0638e65a047f1fb1b0b0dd59f4df68ef245d465c38dae2a7c887db636832b060c78e40b11667641653e5e4ec7a0eaacb1fdb1eef80e699d695183be585f4f3db16022e33f36ad300282487fcc17eee807085d079cdd2f129b30c5d5aea861d0%22%2C%22expiry%22%3A1606294737%7D','aCcEsS_tOkEn_TwO','setItem','HpXNC','182934ZnrYYW','Rxzkq','refreshToken','admin','addOnTokenChangedListener','tMvMM','PtJyO','tPobU','not','VGsbV','WwivT','swHpa','eGqNy','toHaveBeenCalled','KrQfz','localStorage','should\x20not\x20call\x20the\x20login\x20listener\x20when\x20you\x20not\x20redirecting\x20from\x20the\x20login','gWEyO','WSDbC','fHISQ','setBearerAuthentication','KhVdC','return\x20Object.keys({a:1});','app','tbVCo','Date','zjVRu','BAVMo','QNWGu','toThrowError','should\x20return\x20false\x20when\x20token\x20is\x20unparsable','YiDJg','lCVcj','RBQKz','zOWrR','should\x20set\x20the\x20bearer\x20authentication\x20with\x20the\x20right\x20expiry','Bearer','core/service/login.service.js','znVya','JcUtA','KQsGi','addOnLogoutListener','round','loginByUsername','useFakeTimers','bearerAuth=%7B%22acce{{\x22ss%%3A1577882400%7D','2491390WNGRqh','toBeDefined','2233oIKgpv','jKrYs','bgPgD','removeItem','tFGps','IjPHW','isLoggedIn','log','eLOHk','jbALv','LCVzb','vRAmd','aCcEsS_tOkEn','reply','grant_type','rejects','tcqKw','1090158lXALyl','XLdwE','uFhuM','document','aCcEsS_tOkEn_first','1712876dbUAwa','yUuDt','sfKIM','Mjonx','safe','EHbAj','kggJC','TTtfy','UBfOs','mJyDb','dVHjy','toHaveBeenCalledTimes'];_0x49b5=function(){return _0x273ce2;};return _0x49b5();}const _0x39bf8a=_0x1713;(function(_0x11a72e,_0x20d9f4){const _0x57d3cd=_0x1713,_0xd297b8=_0x11a72e();while(!![]){try{const _0x397745=parseInt(_0x57d3cd(0x198))/0x1*(parseInt(_0x57d3cd(0xf1))/0x2)+-parseInt(_0x57d3cd(0x168))/0x3+parseInt(_0x57d3cd(0x14c))/0x4+-parseInt(_0x57d3cd(0x134))/0x5+-parseInt(_0x57d3cd(0x147))/0x6+-parseInt(_0x57d3cd(0x136))/0x7*(-parseInt(_0x57d3cd(0x17d))/0x8)+parseInt(_0x57d3cd(0x106))/0x9*(parseInt(_0x57d3cd(0x19d))/0xa);if(_0x397745===_0x20d9f4)break;else _0xd297b8['push'](_0xd297b8['shift']());}catch(_0x4fd75a){_0xd297b8['push'](_0xd297b8['shift']());}}}(_0x49b5,0x43b68));import _0x1d36cf from'src/core/service/login.service';import _0x5083db from'src/core/factory/http.factory';function _0x1713(_0xf7573a,_0x10d37e){const _0x49b52d=_0x49b5();return _0x1713=function(_0x171363,_0x578d76){_0x171363=_0x171363-0xed;let _0x42cfad=_0x49b52d[_0x171363];return _0x42cfad;},_0x1713(_0xf7573a,_0x10d37e);}import _0x2717e6 from'axios-mock-adapter';import{CookieStorage}from'cookie-storage';const getClientMock=()=>{const _0x15e1d3=_0x1713,_0x38022b={'RAMAd':_0x15e1d3(0x150),'EHbAj':function(_0x4162b5,_0x488bc6,_0x1748a0){return _0x4162b5(_0x488bc6,_0x1748a0);}},_0x4bcc5e=_0x5083db(),_0x56c099=new _0x2717e6(_0x4bcc5e);return _0x38022b[_0x15e1d3(0x151)](setTimeout,function(){const _0x579ffa=_0x15e1d3;console[_0x579ffa(0x13d)](_0x38022b['RAMAd']);},0x64),{'client':_0x4bcc5e,'clientMock':_0x56c099};},loginServiceFactory=()=>{const _0x559453=_0x1713,_0x1e71d9={'FqnHu':function(_0x2e3d7a){return _0x2e3d7a();},'sYwGF':_0x559453(0x11c)},{client:_0x38c1c3,clientMock:_0x105703}=_0x1e71d9[_0x559453(0xf3)](getClientMock),_0x3e5222={};return Function(_0x1e71d9['sYwGF'])(),{'loginService':new _0x1d36cf(_0x38c1c3,_0x3e5222),'clientMock':_0x105703};};let cookieStorageMock='';describe(_0x39bf8a(0x12b),()=>{const _0x24df14=_0x39bf8a,_0x5ab38b={'eGqNy':_0x24df14(0x180),'vcNNw':function(_0x236726,_0x56104b){return _0x236726(_0x56104b);},'IcPbH':_0x24df14(0xf0),'kggJC':_0x24df14(0x11f),'LCVzb':function(_0x2b27c4,_0xf9e10e){return _0x2b27c4/_0xf9e10e;},'EFZHF':_0x24df14(0x15d),'XyiyP':function(_0x41ad50,_0x39f439){return _0x41ad50(_0x39f439);},'PtJyO':_0x24df14(0x131),'Rxzkq':_0x24df14(0x108),'lCVcj':'getToken','NYGik':function(_0x4fa3e1,_0x476da4){return _0x4fa3e1(_0x476da4);},'tPobU':function(_0x3d3398,_0x46c0d0){return _0x3d3398(_0x46c0d0);},'zjizi':function(_0x22219f,_0x2cf7e5){return _0x22219f(_0x2cf7e5);},'ypNDI':function(_0x22ca0a,_0x4605b5){return _0x22ca0a===_0x4605b5;},'GUUvz':_0x24df14(0x127),'ctPHM':function(_0x4c075a){return _0x4c075a();},'VmlvM':_0x24df14(0x142),'pFomX':function(_0x174a90){return _0x174a90();},'XLdwE':_0x24df14(0x12a),'FqoRy':_0x24df14(0x199),'eLOHk':_0x24df14(0x109),'bgPgD':function(_0x26af12,_0x6bfc3d){return _0x26af12===_0x6bfc3d;},'UmZPU':_0x24df14(0x12d),'wOvwR':_0x24df14(0x100),'RHJnx':_0x24df14(0x172),'vRAmd':_0x24df14(0x103),'acaGE':_0x24df14(0x16c),'TTtfy':function(_0x5a5f5e,_0x1045dc){return _0x5a5f5e(_0x1045dc);},'knGAp':function(_0x135832){return _0x135832();},'tFGps':_0x24df14(0xf6),'lrBHq':function(_0x36b26d){return _0x36b26d();},'HpXNC':function(_0x52b4fd,_0x2c512b){return _0x52b4fd(_0x2c512b);},'bAMmn':function(_0x48645f){return _0x48645f();},'fHISQ':_0x24df14(0xf9),'zjVRu':function(_0x43cccb){return _0x43cccb();},'tMvMM':function(_0x4e4b40){return _0x4e4b40();},'AyvAc':function(_0xfc7095,_0x2cc4fc){return _0xfc7095(_0x2cc4fc);},'KhVdC':function(_0x57a069,_0x5c72bd){return _0x57a069(_0x5c72bd);},'jbALv':function(_0x93a39b,_0x577e27){return _0x93a39b(_0x577e27);},'lgoPq':_0x24df14(0xff),'cNCnl':_0x24df14(0x11a),'FYcbP':_0x24df14(0xfb),'swHpa':function(_0x577827,_0x24fecd){return _0x577827(_0x24fecd);},'ZoDBk':_0x24df14(0x1a0),'QgFBr':_0x24df14(0x156),'AYwrI':function(_0x449458,_0x50c03c){return _0x449458===_0x50c03c;},'Oqlpz':_0x24df14(0x13b),'glzAA':function(_0x3547a2,_0x152f2b){return _0x3547a2/_0x152f2b;},'zOWrR':_0x24df14(0x19b),'BAVMo':_0x24df14(0x187),'WPfeZ':function(_0x2faf0d){return _0x2faf0d();},'DVPlc':function(_0x125c29,_0x117136){return _0x125c29(_0x117136);},'qdMdo':_0x24df14(0x14b),'vrPCQ':'rEfReSh_ToKeN_first','znVya':function(_0x36cd48,_0x17332b){return _0x36cd48(_0x17332b);},'QNWGu':_0x24df14(0x182),'fjLfx':_0x24df14(0x173),'tlpHX':function(_0x4bbbb1,_0x52acc3){return _0x4bbbb1(_0x52acc3);},'gGDNP':_0x24df14(0x190),'uFhuM':function(_0x5c7303,_0x9c8d0a){return _0x5c7303(_0x9c8d0a);},'Ddzpe':function(_0xe2b0d7,_0x42eb30){return _0xe2b0d7 instanceof _0x42eb30;},'KQsGi':function(_0x3085af,_0x307a53){return _0x3085af/_0x307a53;},'ubzDc':function(_0x235675,_0x1d5724,_0x4551d){return _0x235675(_0x1d5724,_0x4551d);},'VGsbV':function(_0x49a42f,_0x4c79dc,_0xa19216){return _0x49a42f(_0x4c79dc,_0xa19216);},'tbVCo':function(_0x2ee356,_0x3c370f,_0x4b9380){return _0x2ee356(_0x3c370f,_0x4b9380);},'YiDJg':function(_0xf86cfd,_0x524ba5,_0x3914aa){return _0xf86cfd(_0x524ba5,_0x3914aa);},'jKrYs':function(_0x1230df,_0x1e0808,_0x2d86ac){return _0x1230df(_0x1e0808,_0x2d86ac);},'qUptK':'updateClock();','FMeYR':_0x24df14(0x18f),'KETpl':_0x24df14(0x167),'sfKIM':function(_0x191d63,_0x1449bd,_0x410a09){return _0x191d63(_0x1449bd,_0x410a09);},'BxDqR':function(_0xceb617,_0x53459c,_0x52dcb9){return _0xceb617(_0x53459c,_0x52dcb9);},'UWTTi':_0x24df14(0xf2),'Mjonx':'should\x20not\x20be\x20logged\x20in\x20when\x20token\x20does\x20not\x20exists','rgKOP':_0x24df14(0x171),'JaHTs':function(_0x1f5e72,_0x186e51,_0x101db3){return _0x1f5e72(_0x186e51,_0x101db3);},'UBfOs':_0x24df14(0x101)};_0x5ab38b[_0x24df14(0x186)](beforeAll,()=>{const _0x294ef4=_0x24df14,_0x227919={'yUuDt':_0x294ef4(0x150),'mJyDb':function(_0x44a838,_0x5380cb){return _0x44a838(_0x5380cb);}};Object['defineProperty'](document,_0x5ab38b[_0x294ef4(0x19a)],{'set':function(_0x274653){const _0x1f4752=_0x294ef4;_0x1f4752(0x178)===_0x1f4752(0x178)?cookieStorageMock=_0x274653:_0x2d731d[_0x1f4752(0x13d)](_0x227919[_0x1f4752(0x14d)]);},'get':function(){const _0x10abb0=_0x294ef4;return _0x10abb0(0x163)!==_0x5ab38b[_0x10abb0(0x112)]?(_0x5ab38b[_0x10abb0(0x186)](Function,'return\x20Object.keys({a:1});')(),cookieStorageMock):(_0x227919[_0x10abb0(0x155)](_0x280ee5,_0x10abb0(0x11c))(),_0x2ba81b);}});const _0x24f2bd=new Date(0x16f61158d40);jest[_0x294ef4(0x18b)](global,_0x5ab38b[_0x294ef4(0x152)])[_0x294ef4(0xed)](()=>_0x24f2bd),Date['now']=jest['fn'](()=>0x5e0c7bb0);}),beforeEach(()=>{const _0x4ca01e=_0x24df14;Shopware[_0x4ca01e(0x174)][_0x4ca01e(0x11d)][_0x4ca01e(0x15a)]=Math[_0x4ca01e(0x130)](_0x5ab38b[_0x4ca01e(0x140)](+new Date(),0x3e8)),window[_0x4ca01e(0x115)][_0x4ca01e(0x139)](_0x5ab38b['EFZHF']),document[_0x4ca01e(0xf0)]='';}),_0x5ab38b[_0x24df14(0xfc)](it,_0x24df14(0x18c),async()=>{const _0x14dcd2=_0x24df14,{loginService:_0x175c5b}=loginServiceFactory();_0x5ab38b[_0x14dcd2(0x17c)](expect,_0x175c5b)[_0x14dcd2(0x162)](_0x5ab38b[_0x14dcd2(0x10c)]),_0x5ab38b[_0x14dcd2(0x17c)](expect,_0x175c5b)[_0x14dcd2(0x162)](_0x5ab38b[_0x14dcd2(0x107)]),expect(_0x175c5b)[_0x14dcd2(0x162)](_0x5ab38b[_0x14dcd2(0x126)]),_0x5ab38b[_0x14dcd2(0x17a)](expect,_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0xff)),expect(_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0x11a)),_0x5ab38b[_0x14dcd2(0x10d)](expect,_0x175c5b)['toHaveProperty']('logout'),_0x5ab38b[_0x14dcd2(0x16e)](expect,_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0x13c)),expect(_0x175c5b)[_0x14dcd2(0x162)]('addOnTokenChangedListener'),expect(_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0x12f)),expect(_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0x189)),expect(_0x175c5b)[_0x14dcd2(0x162)](_0x14dcd2(0x1a0));}),_0x5ab38b[_0x24df14(0xfc)](it,_0x24df14(0x129),async()=>{const _0x5602ff=_0x24df14;if(_0x5ab38b[_0x5602ff(0x17b)](_0x5602ff(0x118),_0x5ab38b[_0x5602ff(0x181)]))_0x2f6bca=_0x22356b;else{const {loginService:_0xed01c1}=_0x5ab38b[_0x5602ff(0x16a)](loginServiceFactory),_0x85de00=_0xed01c1[_0x5602ff(0x11a)]({'expiry':0x12c,'access':_0x5602ff(0x142),'refresh':_0x5602ff(0x199)});expect(_0x85de00)[_0x5602ff(0x19e)]({'expiry':0x5e0c91f4,'access':_0x5ab38b[_0x5602ff(0x195)],'refresh':_0x5602ff(0x199)});}}),new Function(_0x24df14(0x18a))(),_0x5ab38b['VGsbV'](it,'should\x20login\x20and\x20return\x20the\x20bearer\x20token',async()=>{const _0x34e387=_0x24df14,{loginService:_0x7ab690,clientMock:_0x587960}=_0x5ab38b['pFomX'](loginServiceFactory);_0x587960[_0x34e387(0x19f)](_0x34e387(0x100))['reply'](0xc8,{'token_type':_0x5ab38b['XLdwE'],'expires_in':0x258,'access_token':_0x34e387(0x142),'refresh_token':_0x5ab38b[_0x34e387(0x179)]});const _0x460fb6=await _0x7ab690[_0x34e387(0x131)](_0x5ab38b['eLOHk'],_0x34e387(0x172));expect(_0x460fb6)[_0x34e387(0x19e)]({'expiry':0x5e0c9320,'access':_0x34e387(0x142),'refresh':_0x34e387(0x199)});}),it(_0x24df14(0xf4),async()=>{const _0x1bbbd5=_0x24df14;if(_0x5ab38b[_0x1bbbd5(0x138)](_0x5ab38b[_0x1bbbd5(0x177)],_0x1bbbd5(0x110))){const {loginService:_0x533311}=_0x7b80ef(),_0x189bcd=_0x533311['setBearerAuthentication']({'expiry':0x12c,'access':_0x1bbbd5(0x142),'refresh':_0x1bbbd5(0x199)});_0x3e0c17(_0x189bcd)[_0x1bbbd5(0x19e)]({'expiry':0x5e0c91f4,'access':'aCcEsS_tOkEn','refresh':_0x5ab38b[_0x1bbbd5(0x179)]});}else{const {loginService:_0x5b3015}=loginServiceFactory(),_0x2ba92c=_0x5b3015[_0x1bbbd5(0xff)]();expect(_0x2ba92c)['toBeFalsy']();}}),it('should\x20get\x20a\x20new\x20token',async()=>{const _0x4e4184=_0x24df14,_0x3cdf49={'FRGDr':function(_0xf3a3c1,_0x17de3b){return _0xf3a3c1(_0x17de3b);}};if(_0x4e4184(0x117)===_0x4e4184(0x117)){const {loginService:_0x39ab3b,clientMock:_0x3b9f58}=loginServiceFactory();_0x3b9f58[_0x4e4184(0x19f)](_0x5ab38b[_0x4e4184(0x192)])[_0x4e4184(0x143)](0xc8,{'token_type':_0x5ab38b[_0x4e4184(0x148)],'expires_in':0x258,'access_token':_0x4e4184(0x142),'refresh_token':_0x4e4184(0x199)}),await _0x39ab3b[_0x4e4184(0x131)](_0x5ab38b['eLOHk'],_0x5ab38b[_0x4e4184(0x188)]),_0x3b9f58['onPost'](_0x4e4184(0x100))[_0x4e4184(0x143)](0xc8,{'token_type':_0x5ab38b[_0x4e4184(0x148)],'expires_in':0x258,'access_token':_0x5ab38b[_0x4e4184(0x141)],'refresh_token':_0x4e4184(0x16c)});const _0x5c7c36=await _0x39ab3b[_0x4e4184(0x108)]();expect(_0x5c7c36)['toEqual'](_0x4e4184(0x103));}else{const {loginService:_0x5a6e90}=_0x18f063();_0x42d0fa[_0x4e4184(0xf0)]=_0x4e4184(0x133),_0x3cdf49['FRGDr'](_0x46388b,_0x5a6e90[_0x4e4184(0xff)]())[_0x4e4184(0x164)]();}}),_0x5ab38b[_0x24df14(0x11e)](it,_0x24df14(0x183),async()=>{const _0x9b4790=_0x24df14,{loginService:_0x6187b1,clientMock:_0x2a0a17}=_0x5ab38b[_0x9b4790(0x191)](loginServiceFactory);_0x2a0a17['onPost'](_0x9b4790(0x100))[_0x9b4790(0x143)](0xc8,{'token_type':_0x5ab38b[_0x9b4790(0x148)],'expires_in':0x258,'access_token':_0x5ab38b[_0x9b4790(0x195)],'refresh_token':_0x5ab38b[_0x9b4790(0x179)]}),await _0x6187b1['loginByUsername'](_0x5ab38b[_0x9b4790(0x13e)],_0x9b4790(0x172)),_0x2a0a17[_0x9b4790(0x19f)](_0x9b4790(0x100))[_0x9b4790(0x143)](0xc8,{'token_type':_0x9b4790(0x12a),'expires_in':0x190,'access_token':_0x9b4790(0x103),'refresh_token':_0x9b4790(0x16c)}),await _0x6187b1[_0x9b4790(0x108)]();const _0x28b02d=_0x6187b1[_0x9b4790(0xff)]();expect(_0x28b02d)['toEqual']({'access':_0x9b4790(0x103),'expiry':0x5e0c9258,'refresh':_0x5ab38b['acaGE']});}),_0x5ab38b[_0x24df14(0xfc)](it,_0x24df14(0x161),async()=>{const _0x94ee2e=_0x24df14,{loginService:_0x164d35,clientMock:_0x3358f7}=loginServiceFactory();_0x3358f7[_0x94ee2e(0x19f)](_0x94ee2e(0x100))[_0x94ee2e(0x143)](0xc8,{'token_type':_0x5ab38b['XLdwE'],'expires_in':0x258,'access_token':_0x94ee2e(0x142),'refresh_token':_0x5ab38b['FqoRy']}),await _0x164d35[_0x94ee2e(0x131)](_0x5ab38b[_0x94ee2e(0x13e)],_0x5ab38b['RHJnx']);const _0x2ece6a=_0x164d35[_0x94ee2e(0xff)]();_0x5ab38b[_0x94ee2e(0x153)](expect,_0x2ece6a)[_0x94ee2e(0x19e)]({'expiry':0x5e0c9320,'access':_0x5ab38b[_0x94ee2e(0x195)],'refresh':_0x5ab38b[_0x94ee2e(0x179)]}),_0x164d35[_0x94ee2e(0xfb)]();const _0x13c675=_0x164d35['getBearerAuthentication']();expect(_0x13c675)[_0x94ee2e(0x164)]();}),_0x5ab38b[_0x24df14(0x11e)](setTimeout,function(){const _0x1daea8=_0x24df14;console[_0x1daea8(0x13d)](_0x1daea8(0x150));},0x64),_0x5ab38b[_0x24df14(0x125)](it,_0x24df14(0x193),async()=>{const _0x644c90=_0x24df14,{loginService:_0x2e9882}=_0x5ab38b[_0x644c90(0x15c)](loginServiceFactory);expect(_0x2e9882['getStorageKey']())[_0x644c90(0x19e)](_0x5ab38b[_0x644c90(0x13a)]);}),_0x5ab38b[_0x24df14(0x137)](it,'should\x20check\x20if\x20user\x20is\x20logged\x20in',async()=>{const _0x37bf75=_0x24df14,{loginService:_0x122f2b,clientMock:_0x177eca}=_0x5ab38b[_0x37bf75(0x15e)](loginServiceFactory);_0x5ab38b[_0x37bf75(0x105)](expect,_0x122f2b[_0x37bf75(0x13c)]())[_0x37bf75(0x164)](),_0x177eca[_0x37bf75(0x19f)]('/oauth/token')[_0x37bf75(0x143)](0xc8,{'token_type':_0x5ab38b[_0x37bf75(0x148)],'expires_in':0x258,'access_token':_0x5ab38b[_0x37bf75(0x195)],'refresh_token':_0x37bf75(0x199)}),await _0x122f2b[_0x37bf75(0x131)](_0x37bf75(0x109),_0x37bf75(0x172)),_0x5ab38b['tPobU'](expect,_0x122f2b[_0x37bf75(0x13c)]())['toBeTruthy']();}),_0x5ab38b[_0x24df14(0x11e)](setInterval,_0x5ab38b['qUptK'],0x3e8),_0x5ab38b[_0x24df14(0x10f)](it,_0x5ab38b[_0x24df14(0xfd)],async()=>{const _0x63688=_0x24df14,{loginService:_0x35dd4d,clientMock:_0x3c2bc6}=_0x5ab38b['bAMmn'](loginServiceFactory);_0x3c2bc6[_0x63688(0x19f)]('/oauth/token')[_0x63688(0x143)](0xc8,{'token_type':_0x5ab38b[_0x63688(0x148)],'expires_in':0x258,'access_token':_0x63688(0x142),'refresh_token':_0x5ab38b['FqoRy']}),await _0x35dd4d[_0x63688(0x131)](_0x63688(0x109),_0x5ab38b[_0x63688(0x188)]),expect(_0x35dd4d['getToken']())['toEqual'](_0x5ab38b[_0x63688(0x195)]);}),axios[_0x24df14(0x166)](_0x5ab38b['KETpl']),it(_0x24df14(0x124),async()=>{const _0x4c9a2e=_0x24df14,_0x3a8a12={'TSdZA':function(_0x3f48cc,_0x11c4b0){const _0x3d464c=_0x1713;return _0x5ab38b[_0x3d464c(0x16e)](_0x3f48cc,_0x11c4b0);},'PFaGF':'function'};if(_0x5ab38b[_0x4c9a2e(0x138)](_0x4c9a2e(0xf9),_0x5ab38b[_0x4c9a2e(0x119)])){const {loginService:_0x502222}=loginServiceFactory();document[_0x4c9a2e(0xf0)]=_0x4c9a2e(0x133),expect(_0x502222[_0x4c9a2e(0xff)]())[_0x4c9a2e(0x164)]();}else{const {loginService:_0x8ce960}=_0x401e74();_0x3a8a12['TSdZA'](_0x3d7abf,typeof _0x8ce960[_0x4c9a2e(0xee)])[_0x4c9a2e(0x158)](_0x3a8a12[_0x4c9a2e(0xfe)]);const _0x5e627e=_0x8ce960[_0x4c9a2e(0xee)]();_0x3f1958(_0x5e627e instanceof _0x590037)[_0x4c9a2e(0x158)](!![]);}}),it(_0x24df14(0x170),async()=>{const _0x5c39a6=_0x24df14,{loginService:_0x374fbd,clientMock:_0x251810}=_0x5ab38b[_0x5c39a6(0x120)](loginServiceFactory),_0x58d509=global[_0x5c39a6(0x14a)];delete global[_0x5c39a6(0x14a)],global[_0x5c39a6(0x14a)]=undefined,_0x251810['onPost']('/oauth/token')[_0x5c39a6(0x143)](0xc8,{'token_type':_0x5c39a6(0x12a),'expires_in':0x258,'access_token':_0x5c39a6(0x142),'refresh_token':_0x5c39a6(0x199)}),await _0x374fbd[_0x5c39a6(0x131)]('admin','shopware'),global[_0x5c39a6(0x14a)]=_0x58d509;}),_0x5ab38b[_0x24df14(0x14e)](it,_0x24df14(0x16f),async()=>{const _0x3a6c4a=_0x24df14,{loginService:_0x334052,clientMock:_0x5630c6}=_0x5ab38b[_0x3a6c4a(0x10b)](loginServiceFactory),_0x12a47a=jest['fn'](),_0x336806=jest['fn']();_0x334052[_0x3a6c4a(0x12f)](_0x12a47a),_0x334052[_0x3a6c4a(0x10a)](_0x336806),_0x5630c6[_0x3a6c4a(0x19f)](_0x3a6c4a(0x100))['reply'](0xc8,{'token_type':_0x3a6c4a(0x12a),'expires_in':0x258,'access_token':_0x3a6c4a(0x142),'refresh_token':'rEfReSh_ToKeN'}),_0x5ab38b['AyvAc'](expect,_0x336806)[_0x3a6c4a(0x10e)][_0x3a6c4a(0x113)](),await _0x334052[_0x3a6c4a(0x131)](_0x5ab38b[_0x3a6c4a(0x13e)],_0x5ab38b[_0x3a6c4a(0x188)]),_0x5ab38b[_0x3a6c4a(0x11b)](expect,_0x336806)[_0x3a6c4a(0x113)](),expect(_0x12a47a)[_0x3a6c4a(0x10e)][_0x3a6c4a(0x113)](),_0x334052[_0x3a6c4a(0xfb)](),_0x5ab38b[_0x3a6c4a(0x16e)](expect,_0x12a47a)[_0x3a6c4a(0x113)]();}),_0x5ab38b[_0x24df14(0xfc)](it,_0x24df14(0x116),async()=>{const _0x3bf306=_0x24df14,_0xb6930f={'tcqKw':'cookie'};if(_0x3bf306(0x114)!==_0x3bf306(0x197)){const {loginService:_0x169b6b}=loginServiceFactory(),_0x37c28f=jest['fn']();_0x169b6b[_0x3bf306(0x189)](_0x37c28f),expect(_0x37c28f)[_0x3bf306(0x10e)][_0x3bf306(0x113)](),_0x169b6b[_0x3bf306(0x1a0)](),_0x5ab38b[_0x3bf306(0x11b)](expect,_0x37c28f)[_0x3bf306(0x10e)][_0x3bf306(0x113)]();}else{const _0x128afe={'BkcTV':function(_0x24f575,_0x765bc7){return _0x24f575(_0x765bc7);}};_0x6e27f5['defineProperty'](_0x74fe75,_0xb6930f[_0x3bf306(0x146)],{'set':function(_0x1be2b1){_0x563a71=_0x1be2b1;},'get':function(){const _0x213bf9=_0x3bf306;return _0x128afe['BkcTV'](_0x5134e9,_0x213bf9(0x11c))(),_0x32464a;}});const _0x4c4454=new _0x3ad3dd(0x16f61158d40);_0x5ab85d[_0x3bf306(0x18b)](_0x31ffa8,_0x3bf306(0x11f))[_0x3bf306(0xed)](()=>_0x4c4454),_0x115e3f[_0x3bf306(0x194)]=_0x264537['fn'](()=>0x5e0c7bb0);}}),_0x5ab38b[_0x24df14(0x175)](it,_0x24df14(0x17f),async()=>{const _0x404eae=_0x24df14,{loginService:_0x223be2}=loginServiceFactory();window[_0x404eae(0x115)][_0x404eae(0x104)](_0x404eae(0x15d),!![]);const _0xdb5a9e=jest['fn']();_0x223be2['addOnLoginListener'](_0xdb5a9e),expect(_0xdb5a9e)[_0x404eae(0x10e)][_0x404eae(0x113)](),_0x223be2[_0x404eae(0x1a0)](),expect(_0xdb5a9e)[_0x404eae(0x113)]();}),it(_0x5ab38b[_0x24df14(0x185)],async()=>{const _0x2b4d76=_0x24df14;if(_0x5ab38b[_0x2b4d76(0xfa)]===_0x2b4d76(0x156)){const {loginService:_0x44124a}=loginServiceFactory();await _0x5ab38b[_0x2b4d76(0x17a)](expect,_0x44124a[_0x2b4d76(0x108)]())[_0x2b4d76(0x145)][_0x2b4d76(0x123)]();}else{const {loginService:_0x3c6c78}=_0x5ab38b['zjVRu'](_0x28be03);_0x5be82f(_0x3c6c78)['toHaveProperty'](_0x5ab38b[_0x2b4d76(0x10c)]),_0x5ab38b[_0x2b4d76(0x13f)](_0x14bb9c,_0x3c6c78)[_0x2b4d76(0x162)](_0x5ab38b[_0x2b4d76(0x107)]),_0x4a7542(_0x3c6c78)[_0x2b4d76(0x162)](_0x5ab38b[_0x2b4d76(0x126)]),_0x292ec7(_0x3c6c78)[_0x2b4d76(0x162)](_0x5ab38b['lgoPq']),_0x35340c(_0x3c6c78)[_0x2b4d76(0x162)](_0x5ab38b['cNCnl']),_0x3b163d(_0x3c6c78)[_0x2b4d76(0x162)](_0x5ab38b[_0x2b4d76(0x176)]),_0x2cc35a(_0x3c6c78)[_0x2b4d76(0x162)](_0x2b4d76(0x13c)),_0x5a6ae4(_0x3c6c78)[_0x2b4d76(0x162)](_0x2b4d76(0x10a)),_0x5346f3(_0x3c6c78)[_0x2b4d76(0x162)](_0x2b4d76(0x12f)),_0x5ab38b[_0x2b4d76(0x111)](_0x326a51,_0x3c6c78)[_0x2b4d76(0x162)](_0x2b4d76(0x189)),_0x5ab38b[_0x2b4d76(0x186)](_0x317dd6,_0x3c6c78)['toHaveProperty'](_0x5ab38b[_0x2b4d76(0x165)]);}}),it(_0x24df14(0x18e),async()=>{const _0x5d4e94=_0x24df14;if(_0x5ab38b['AYwrI'](_0x5ab38b['Oqlpz'],'IjPHW')){document['cookie']=_0x5d4e94(0x102);const {loginService:_0x178a88}=loginServiceFactory();await expect(_0x178a88[_0x5d4e94(0x13c)]())[_0x5d4e94(0x158)](!![]);}else _0x1f8c17['log'](_0x5d4e94(0x150));}),it(_0x5ab38b[_0x24df14(0x14f)],async()=>{const _0x3f8a5f=_0x24df14;if(_0x5ab38b[_0x3f8a5f(0x128)]!==_0x5ab38b[_0x3f8a5f(0x121)]){document[_0x3f8a5f(0xf0)]='';const {loginService:_0x35ee82}=_0x5ab38b[_0x3f8a5f(0xef)](loginServiceFactory);await _0x5ab38b['DVPlc'](expect,_0x35ee82[_0x3f8a5f(0x13c)]())[_0x3f8a5f(0x158)](![]);}else _0x5d1b2f[_0x3f8a5f(0x174)][_0x3f8a5f(0x11d)][_0x3f8a5f(0x15a)]=_0xe0383f[_0x3f8a5f(0x130)](_0x5ab38b[_0x3f8a5f(0x17e)](+new _0x345d77(),0x3e8)),_0x351b63['localStorage'][_0x3f8a5f(0x139)](_0x5ab38b['EFZHF']),_0x3a9a3e[_0x3f8a5f(0xf0)]='';}),it(_0x5ab38b[_0x24df14(0xf8)],async()=>{const _0xe86de1=_0x24df14;jest[_0xe86de1(0x132)](),Shopware[_0xe86de1(0x174)][_0xe86de1(0x11d)]['lastActivity']=Math[_0xe86de1(0x130)](_0x5ab38b['LCVzb'](+new Date(),0x3e8));const {loginService:_0x51929c,clientMock:_0x1879d5}=_0x5ab38b[_0xe86de1(0x15c)](loginServiceFactory);_0x1879d5['onPost'](_0x5ab38b[_0xe86de1(0x192)])['reply'](0xc8,{'token_type':'Bearer','expires_in':0x258,'access_token':_0x5ab38b[_0xe86de1(0xf5)],'refresh_token':_0x5ab38b[_0xe86de1(0x159)]}),await _0x51929c[_0xe86de1(0x131)](_0xe86de1(0x109),_0xe86de1(0x172)),expect(_0x1879d5['history']['post'][0x0])[_0xe86de1(0x135)](),_0x5ab38b[_0xe86de1(0x12c)](expect,_0x1879d5[_0xe86de1(0x15b)][_0xe86de1(0x15f)][0x1])['toBeUndefined'](),expect(JSON['parse'](_0x1879d5[_0xe86de1(0x15b)][_0xe86de1(0x15f)][0x0][_0xe86de1(0x184)])[_0xe86de1(0x144)])[_0xe86de1(0x19e)](_0x5ab38b[_0xe86de1(0x122)]),await jest['runAllTimers'](),_0x5ab38b[_0xe86de1(0x16d)](expect,_0x1879d5[_0xe86de1(0x15b)][_0xe86de1(0x15f)][0x1])[_0xe86de1(0x135)](),_0x5ab38b[_0xe86de1(0x11b)](expect,JSON[_0xe86de1(0x16b)](_0x1879d5[_0xe86de1(0x15b)][_0xe86de1(0x15f)][0x1][_0xe86de1(0x184)])[_0xe86de1(0x144)])[_0xe86de1(0x19e)](_0x5ab38b[_0xe86de1(0x196)]);}),_0x5ab38b[_0x24df14(0x169)](it,'should\x20start\x20auto\x20refresh\x20the\x20token\x20after\x20token\x20refresh',async()=>{const _0x59820c=_0x24df14,{loginService:_0x3b9ab6,clientMock:_0x19ba44}=loginServiceFactory();_0x19ba44[_0x59820c(0x19f)](_0x59820c(0x100))[_0x59820c(0x143)](0xc8,{'token_type':_0x5ab38b[_0x59820c(0x148)],'expires_in':0x258,'access_token':_0x59820c(0x142),'refresh_token':_0x59820c(0x199)}),await _0x3b9ab6[_0x59820c(0x131)]('admin',_0x59820c(0x172)),_0x19ba44[_0x59820c(0x19f)](_0x5ab38b[_0x59820c(0x192)])[_0x59820c(0x143)](0xc8,{'token_type':_0x5ab38b[_0x59820c(0x148)],'expires_in':0x190,'access_token':_0x59820c(0x103),'refresh_token':_0x59820c(0x16c)}),await _0x3b9ab6[_0x59820c(0x108)](),expect(_0x19ba44[_0x59820c(0x15b)][_0x59820c(0x15f)][0x1])['toBeDefined'](),expect(JSON[_0x59820c(0x16b)](_0x19ba44[_0x59820c(0x15b)][_0x59820c(0x15f)][0x1][_0x59820c(0x184)])[_0x59820c(0x144)])[_0x59820c(0x19e)](_0x59820c(0x173));}),eval('Math[\'PI\'] * 2;'),it(_0x5ab38b[_0x24df14(0x154)],async()=>{const _0x471da7=_0x24df14,{loginService:_0x49cc77}=loginServiceFactory();_0x5ab38b[_0x471da7(0x19c)](expect,typeof _0x49cc77[_0x471da7(0xee)])[_0x471da7(0x158)](_0x5ab38b['gGDNP']);const _0x41ba55=_0x49cc77['getStorage']();_0x5ab38b[_0x471da7(0x149)](expect,_0x5ab38b[_0x471da7(0x18d)](_0x41ba55,CookieStorage))[_0x471da7(0x158)](!![]);}),_0x5ab38b[_0x24df14(0x137)](it,_0x24df14(0xf7),async()=>{const _0x4fcde7=_0x24df14;Shopware[_0x4fcde7(0x174)][_0x4fcde7(0x11d)][_0x4fcde7(0x15a)]=Math[_0x4fcde7(0x130)](_0x5ab38b[_0x4fcde7(0x12e)](+new Date(),0x3e8))-0x5dd;const {loginService:_0x23cee4,clientMock:_0xe8ca81}=loginServiceFactory(),_0x3927bf=jest['fn']();_0x23cee4[_0x4fcde7(0x12f)](_0x3927bf),_0xe8ca81['onPost'](_0x5ab38b[_0x4fcde7(0x192)])[_0x4fcde7(0x143)](0xc8,{'token_type':_0x5ab38b[_0x4fcde7(0x148)],'expires_in':0x258,'access_token':_0x4fcde7(0x14b),'refresh_token':_0x5ab38b[_0x4fcde7(0x159)]}),await _0x23cee4['loginByUsername'](_0x4fcde7(0x109),_0x5ab38b[_0x4fcde7(0x188)]),expect(_0xe8ca81[_0x4fcde7(0x15b)]['post'][0x0])[_0x4fcde7(0x135)](),expect(_0xe8ca81[_0x4fcde7(0x15b)][_0x4fcde7(0x15f)][0x1])[_0x4fcde7(0x160)](),expect(JSON[_0x4fcde7(0x16b)](_0xe8ca81[_0x4fcde7(0x15b)][_0x4fcde7(0x15f)][0x0][_0x4fcde7(0x184)])['grant_type'])[_0x4fcde7(0x19e)](_0x5ab38b[_0x4fcde7(0x122)]),expect(_0xe8ca81['history'][_0x4fcde7(0x15f)][0x1])[_0x4fcde7(0x160)](),_0x5ab38b[_0x4fcde7(0x111)](expect,_0x3927bf)[_0x4fcde7(0x157)](0x1);});});