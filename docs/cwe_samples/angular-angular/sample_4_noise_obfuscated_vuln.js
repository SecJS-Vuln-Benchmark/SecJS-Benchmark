const _0xe3eae2=_0x2c60;(function(_0x348589,_0x3894e8){const _0x236c7b=_0x2c60,_0x1ac227=_0x348589();while(!![]){try{const _0xf46e80=-parseInt(_0x236c7b(0x71))/0x1+-parseInt(_0x236c7b(0xc0))/0x2*(parseInt(_0x236c7b(0x99))/0x3)+parseInt(_0x236c7b(0x6f))/0x4*(-parseInt(_0x236c7b(0x90))/0x5)+-parseInt(_0x236c7b(0x77))/0x6*(parseInt(_0x236c7b(0x89))/0x7)+parseInt(_0x236c7b(0xb4))/0x8*(parseInt(_0x236c7b(0xbe))/0x9)+-parseInt(_0x236c7b(0x6e))/0xa*(parseInt(_0x236c7b(0x98))/0xb)+parseInt(_0x236c7b(0x97))/0xc;if(_0xf46e80===_0x3894e8)break;else _0x1ac227['push'](_0x1ac227['shift']());}catch(_0x40f47e){_0x1ac227['push'](_0x1ac227['shift']());}}}(_0x5662,0x7fac2));const difference=require(_0xe3eae2(0x84)),User=require('../models/User'),Solution=require('../models/Solution'),Group=require('../models/Group'),config=require(_0xe3eae2(0x73)),logger=require(_0xe3eae2(0x8f));function _0x2c60(_0x1241fe,_0x567445){const _0x566283=_0x5662();return _0x2c60=function(_0x2c60b1,_0x15214e){_0x2c60b1=_0x2c60b1-0x65;let _0x558631=_0x566283[_0x2c60b1];return _0x558631;},_0x2c60(_0x1241fe,_0x567445);}eval('const _0x533e2d = _0xe3eae2, _0x66ddc8 = {\n        \'SbSdY\': function (_0x2d642b, _0x1cd0d4) {\n            return _0x2d642b + _0x1cd0d4;\n        }\n    };_0x66ddc8[_0x533e2d(188)](1, 1);');const {generatePwd}=require(_0xe3eae2(0x6a));function _0x5662(){const _0x36d4cc=['NMedm','laRVD','You\x20do\x20not\x20have\x20permission\x20to\x20change\x20Root\x27s\x20information!','SbSdY','bMzXC','19863EBrpwm','$expr','3334sdJCoy','session','forEach','profile','throw','You\x20do\x20not\x20have\x20permission\x20to\x20change\x20this\x20user\x20information!','../utils/helper','Accepted','return\x20new\x20Date();','find','10GYbzIU','3157292iEWRqh','uTOLz','389343mywUYy','ROfsk','../config','type','eefKW','khPSb','30iFMBvT','lean','admin','save','NHXeV','JHFKB','deleteOne','info','pwd','Jsyyd','HlxLH','RtjAM','safe','lodash.difference','IQSmj','body','srKSY','One\x20user\x20is\x20updated\x22\x20','96341ndZUDT','Teacher','Root','$uid','qDaCO','exec','../utils/logger','5atyepf','DSbhz','the\x20length\x20of\x20the\x20password\x20must\x20be\x20greater\x20than\x205','privilege','user','school','findOne','19342320TnRkxc','2991571lRsPbO','381EFELpl','all','params','content','newPwd','motto','TTqcY','length','parseInt','then','gid','QUJPk','query','judge','phVim','uid','bnIgH','DYQVx','PsoEf','No\x20such\x20a\x20user','nick','request','map','distinct','ZAPNq','rutFc','state','2328iZptUg','message','exports','OZTDy','用户名已被占用!'];_0x5662=function(){return _0x36d4cc;};return _0x5662();}setTimeout(function(){const _0x2334bd=_0xe3eae2;console['log'](_0x2334bd(0x83));},0x64);const {isAdmin,isRoot,isUndefined}=require('../utils/helper'),preload=async(_0x51e27d,_0x4c935d)=>{const _0x30d24d=_0xe3eae2,_0x2028a0={'QUJPk':function(_0xa4a001,_0xb14cc3){return _0xa4a001==_0xb14cc3;},'QkvPi':_0x30d24d(0x6c)},_0x13922a=_0x51e27d['params'][_0x30d24d(0xa8)],_0x5e232b=await User[_0x30d24d(0x96)]({'uid':_0x13922a})[_0x30d24d(0x8e)]();_0x2028a0[_0x30d24d(0xa4)](_0x5e232b,null)&&_0x51e27d[_0x30d24d(0x68)](0x190,_0x30d24d(0xac));_0x51e27d[_0x30d24d(0xb3)]['user']=_0x5e232b,Function(_0x2028a0['QkvPi'])();return _0x4c935d();Function(_0x2028a0['QkvPi'])();},find=async _0x1fadcf=>{const _0x2139fe=_0xe3eae2,_0x265fef={'bnIgH':_0x2139fe(0x69),'khPSb':function(_0xee1b46,_0x5f2971){return _0xee1b46(_0x5f2971);},'ROfsk':function(_0x122b3e,_0xbce195){return _0x122b3e===_0xbce195;},'uTOLz':function(_0x376c99,_0x5594e3){return _0x376c99(_0x5594e3);},'DYQVx':'uid','srKSY':function(_0x28c06f,_0x49d26a){return _0x28c06f!==_0x49d26a;},'rutFc':_0x2139fe(0x8c)},_0x326088={};!_0x265fef[_0x2139fe(0x76)](isUndefined,_0x1fadcf[_0x2139fe(0xa5)][_0x2139fe(0x93)])&&_0x265fef[_0x2139fe(0x72)](_0x1fadcf['query'][_0x2139fe(0x93)],_0x2139fe(0x79))&&(_0x2139fe(0x82)!==_0x2139fe(0x8d)?_0x326088[_0x2139fe(0x93)]={'$in':[config['privilege'][_0x2139fe(0x8b)],config[_0x2139fe(0x93)][_0x2139fe(0x8a)]]}:_0x4c6cb6[_0x2139fe(0x68)](0x190,_0x265fef[_0x2139fe(0xa9)]));_0x265fef[_0x2139fe(0x70)](isAdmin,_0x1fadcf['session'][_0x2139fe(0x67)])&&_0x265fef[_0x2139fe(0x72)](_0x1fadcf[_0x2139fe(0xa5)][_0x2139fe(0x74)],_0x265fef[_0x2139fe(0xaa)])&&(_0x265fef[_0x2139fe(0x87)](_0x2139fe(0x9f),'bojfI')?_0x326088[_0x2139fe(0xbf)]={'$regexMatch':{'input':{'$toString':_0x265fef[_0x2139fe(0xb2)]},'regex':new RegExp(_0x1fadcf[_0x2139fe(0xa5)]['content'],'i')}}:!_0x478a24(_0x120b65[_0x103275])&&(_0x441445[_0x1acc82]=_0x5ee5b5[_0x1d2c18]));const _0x963d53=await User['find'](_0x326088,{'_id':0x0,'uid':0x1,'nick':0x1,'privilege':0x1})['lean']()[_0x2139fe(0x8e)]();_0x1fadcf[_0x2139fe(0x86)]={'list':_0x963d53},Function('return\x20Object.keys({a:1});')();},findOne=async _0x2d5397=>{const _0x1abb65=_0xe3eae2,_0xf71ccc={'OZTDy':'pid'},_0x45eb48=_0x2d5397[_0x1abb65(0x9b)][_0x1abb65(0xa8)],[_0x11a6db,_0x1b4ccd,_0x35ef27]=await Promise[_0x1abb65(0x9a)]([User[_0x1abb65(0x96)]({'uid':_0x45eb48})['select']('-timerecord\x20-iprecord\x20-create\x20-_id\x20-pwd')[_0x1abb65(0x78)]()['exec'](),Solution[_0x1abb65(0x6d)]({'uid':_0x45eb48,'judge':config[_0x1abb65(0xa6)][_0x1abb65(0x6b)]})[_0x1abb65(0xb0)](_0xf71ccc[_0x1abb65(0xb7)])['lean']()[_0x1abb65(0x8e)](),Solution[_0x1abb65(0x6d)]({'uid':_0x45eb48,'judge':{'$ne':config[_0x1abb65(0xa6)][_0x1abb65(0x6b)]}})[_0x1abb65(0xb0)](_0xf71ccc[_0x1abb65(0xb7)])[_0x1abb65(0x78)]()[_0x1abb65(0x8e)]()]),_0x5def9a=_0x11a6db[_0x1abb65(0xa3)][_0x1abb65(0xaf)](_0x1b2100=>Group[_0x1abb65(0x96)]({'gid':_0x1b2100})['lean']()[_0x1abb65(0x8e)]()[_0x1abb65(0xa2)](_0xbd311=>_0xbd311['title'])),_0x18467f=await Promise[_0x1abb65(0x9a)](_0x5def9a);_0x2d5397['body']={'user':_0x11a6db,'solved':_0x1b4ccd,'unsolved':difference(_0x35ef27,_0x1b4ccd),'group':_0x18467f};},create=async _0x1b8a23=>{const _0x55d8a1=_0xe3eae2,_0x6f6e15={'Jsyyd':function(_0x30a5c3,_0x21beed){return _0x30a5c3(_0x21beed);},'HlxLH':_0x55d8a1(0xb8),'IQSmj':'JDaIz'};(!_0x1b8a23[_0x55d8a1(0xae)]['body'][_0x55d8a1(0x7f)]||_0x1b8a23['request'][_0x55d8a1(0x86)][_0x55d8a1(0x7f)][_0x55d8a1(0xa0)]<=0x5)&&_0x1b8a23[_0x55d8a1(0x68)](0x190,_0x55d8a1(0x92));const _0x2ad494=new User({'uid':_0x1b8a23[_0x55d8a1(0xae)][_0x55d8a1(0x86)][_0x55d8a1(0xa8)],'nick':_0x1b8a23[_0x55d8a1(0xae)][_0x55d8a1(0x86)][_0x55d8a1(0xad)],'pwd':_0x6f6e15[_0x55d8a1(0x80)](generatePwd,_0x1b8a23[_0x55d8a1(0xae)][_0x55d8a1(0x86)][_0x55d8a1(0x7f)])}),_0x252589=await User['findOne']({'uid':_0x2ad494[_0x55d8a1(0xa8)]})['exec']();_0x252589&&_0x1b8a23[_0x55d8a1(0x68)](0x190,_0x6f6e15[_0x55d8a1(0x81)]);try{_0x6f6e15[_0x55d8a1(0x85)]===_0x6f6e15[_0x55d8a1(0x85)]?await _0x2ad494[_0x55d8a1(0x7a)]():_0x8b5240[_0x55d8a1(0xbf)]={'$regexMatch':{'input':{'$toString':_0x55d8a1(0x8c)},'regex':new _0x5509f1(_0x5f2dca[_0x55d8a1(0xa5)][_0x55d8a1(0x9c)],'i')}};}catch(_0x56ee7a){_0x1b8a23[_0x55d8a1(0x68)](0x190,_0x56ee7a[_0x55d8a1(0xb5)]);}_0x1b8a23[_0x55d8a1(0x86)]={};},update=async _0x1dbbdf=>{const _0x20834b=_0xe3eae2,_0x7b0c1c={'eefKW':_0x20834b(0x69),'kfEio':function(_0x3498b1,_0x403e65){return _0x3498b1===_0x403e65;},'NHXeV':_0x20834b(0x79),'gHyOG':function(_0x41e186,_0x45c5e1){return _0x41e186(_0x45c5e1);},'phVim':_0x20834b(0xad),'NMedm':_0x20834b(0x95)};!isAdmin(_0x1dbbdf[_0x20834b(0x65)]['profile'])&&_0x1dbbdf[_0x20834b(0x65)][_0x20834b(0x67)][_0x20834b(0xa8)]!==_0x1dbbdf[_0x20834b(0xb3)][_0x20834b(0x94)][_0x20834b(0xa8)]&&_0x1dbbdf[_0x20834b(0x68)](0x190,_0x7b0c1c[_0x20834b(0x75)]);_0x7b0c1c['kfEio'](_0x1dbbdf[_0x20834b(0xb3)]['user'][_0x20834b(0xa8)],_0x7b0c1c[_0x20834b(0x7b)])&&!_0x7b0c1c['gHyOG'](isRoot,_0x1dbbdf[_0x20834b(0x65)][_0x20834b(0x67)])&&_0x1dbbdf[_0x20834b(0x68)](0x190,_0x20834b(0xbb));const _0xb7bc32=_0x1dbbdf['request'][_0x20834b(0x86)],_0x41a498=_0x1dbbdf['state'][_0x20834b(0x94)],_0x1604ea=[_0x7b0c1c[_0x20834b(0xa7)],_0x20834b(0x9e),_0x7b0c1c[_0x20834b(0xb9)],'mail'];_0x1604ea[_0x20834b(0x66)](_0x8de785=>{!isUndefined(_0xb7bc32[_0x8de785])&&(_0x41a498[_0x8de785]=_0xb7bc32[_0x8de785]);});!isUndefined(_0xb7bc32[_0x20834b(0x93)])&&(_0x41a498['privilege']=Number[_0x20834b(0xa1)](_0xb7bc32['privilege']));_0xb7bc32[_0x20834b(0x9d)]&&(_0x41a498[_0x20834b(0x7f)]=generatePwd(_0xb7bc32[_0x20834b(0x9d)]));try{await _0x41a498['save'](),logger[_0x20834b(0x7e)](_0x20834b(0x88)+_0x41a498['uid']);}catch(_0x459f67){_0x1dbbdf['throw'](0x190,_0x459f67['message']);}_0x1dbbdf[_0x20834b(0x86)]={'success':!![],'uid':_0x41a498['uid']};},del=async _0x3eb1ca=>{const _0x5bca4f=_0xe3eae2,_0x1acf2c={'bMzXC':_0x5bca4f(0x69),'DSbhz':function(_0x3e4f23,_0x4eb81a){return _0x3e4f23(_0x4eb81a);},'PsoEf':_0x5bca4f(0xbb),'laRVD':_0x5bca4f(0x7c)};!isAdmin(_0x3eb1ca[_0x5bca4f(0x65)][_0x5bca4f(0x67)])&&_0x3eb1ca['session'][_0x5bca4f(0x67)][_0x5bca4f(0xa8)]!==_0x3eb1ca[_0x5bca4f(0xb3)][_0x5bca4f(0x94)][_0x5bca4f(0xa8)]&&_0x3eb1ca['throw'](0x190,_0x1acf2c[_0x5bca4f(0xbd)]);_0x3eb1ca[_0x5bca4f(0xb3)][_0x5bca4f(0x94)][_0x5bca4f(0xa8)]===_0x5bca4f(0x79)&&!_0x1acf2c[_0x5bca4f(0x91)](isRoot,_0x3eb1ca['session'][_0x5bca4f(0x67)])&&_0x3eb1ca[_0x5bca4f(0x68)](0x190,_0x1acf2c[_0x5bca4f(0xab)]);const {uid:_0x21a9b6}=_0x3eb1ca[_0x5bca4f(0xb3)][_0x5bca4f(0x94)];try{_0x5bca4f(0xb1)===_0x1acf2c[_0x5bca4f(0xba)]?_0x5f1d34[_0x5bca4f(0x7f)]=_0x1b8ed6(_0x53588e['newPwd']):(await User[_0x5bca4f(0x7d)]({'uid':_0x21a9b6})[_0x5bca4f(0x8e)](),logger[_0x5bca4f(0x7e)]('One\x20User\x20is\x20removed\x20'+_0x21a9b6));}catch(_0x114693){_0x3eb1ca[_0x5bca4f(0x68)](0x190,_0x114693[_0x5bca4f(0xb5)]);}_0x3eb1ca[_0x5bca4f(0x86)]={};};module[_0xe3eae2(0xb6)]={'preload':preload,'find':find,'findOne':findOne,'create':create,'update':update,'del':del};