const _0x1a263d=_0x5a8f;(function(_0x33c49d,_0x14bec6){const _0x248707=_0x5a8f,_0x23d417=_0x33c49d();while(!![]){try{const _0x5b4819=-parseInt(_0x248707(0x20e))/0x1+-parseInt(_0x248707(0x1be))/0x2*(-parseInt(_0x248707(0x1cd))/0x3)+parseInt(_0x248707(0x205))/0x4*(-parseInt(_0x248707(0x1d4))/0x5)+-parseInt(_0x248707(0x1c0))/0x6+-parseInt(_0x248707(0x1dc))/0x7+parseInt(_0x248707(0x1bc))/0x8*(parseInt(_0x248707(0x1f7))/0x9)+-parseInt(_0x248707(0x1f3))/0xa*(-parseInt(_0x248707(0x1b9))/0xb);if(_0x5b4819===_0x14bec6)break;else _0x23d417['push'](_0x23d417['shift']());}catch(_0x151338){_0x23d417['push'](_0x23d417['shift']());}}}(_0x5c04,0xb3e77));function _0x5a8f(_0x4f0189,_0x4fb084){const _0x5c0462=_0x5c04();return _0x5a8f=function(_0x5a8f05,_0x38eb78){_0x5a8f05=_0x5a8f05-0x1b7;let _0x4d4227=_0x5c0462[_0x5a8f05];return _0x4d4227;},_0x5a8f(_0x4f0189,_0x4fb084);}const {inflateRawSync}=require(_0x1a263d(0x1d7)),base64url=require(_0x1a263d(0x1fb)),getKey=require('../help/get_key'),{KeyStore}=require(_0x1a263d(0x211)),errors=require(_0x1a263d(0x1b7)),{check,decrypt,keyManagementDecrypt}=require(_0x1a263d(0x1ba)),JWK=require(_0x1a263d(0x1e5)),{createSecretKey}=require(_0x1a263d(0x1da)),generateCEK=require(_0x1a263d(0x1ca)),validateHeaders=require(_0x1a263d(0x1c6)),{detect:resolveSerialization}=require(_0x1a263d(0x1c9)),SINGLE_RECIPIENT=new Set(['compact',_0x1a263d(0x219)]),combineHeader=(_0x2b1775={},_0x164e50={},_0xef78b7={})=>{const _0x157b5a=_0x1a263d,_0x49b64f={'AHyqX':function(_0x1beccc,_0x412e22){return _0x1beccc===_0x412e22;},'IQLph':'string','TvNsC':function(_0x48febc,_0x53bf24){return _0x48febc===_0x53bf24;}};typeof _0x2b1775===_0x157b5a(0x1d1)&&(_0x2b1775=base64url[_0x157b5a(0x1cf)]['decode'](_0x2b1775));const _0x438190=_0x2b1775['p2s']||_0x164e50[_0x157b5a(0x1d9)]||_0xef78b7[_0x157b5a(0x1d9)],_0x3dba68=_0x2b1775['apu']||_0x164e50[_0x157b5a(0x200)]||_0xef78b7[_0x157b5a(0x200)],_0x4ae77d=_0x2b1775[_0x157b5a(0x1de)]||_0x164e50['apv']||_0xef78b7[_0x157b5a(0x1de)],_0x3a962c=_0x2b1775['iv']||_0x164e50['iv']||_0xef78b7['iv'],_0x13c194=_0x2b1775[_0x157b5a(0x1df)]||_0x164e50[_0x157b5a(0x1df)]||_0xef78b7[_0x157b5a(0x1df)];return{..._0x2b1775,..._0x164e50,..._0xef78b7,...typeof _0x438190===_0x157b5a(0x1d1)?{'p2s':base64url[_0x157b5a(0x1f6)](_0x438190)}:undefined,..._0x49b64f[_0x157b5a(0x1fc)](typeof _0x3dba68,_0x49b64f[_0x157b5a(0x1dd)])?{'apu':base64url[_0x157b5a(0x1f6)](_0x3dba68)}:undefined,...typeof _0x4ae77d===_0x157b5a(0x1d1)?{'apv':base64url[_0x157b5a(0x1f6)](_0x4ae77d)}:undefined,..._0x49b64f[_0x157b5a(0x1e0)](typeof _0x3a962c,_0x49b64f[_0x157b5a(0x1dd)])?{'iv':base64url['decodeToBuffer'](_0x3a962c)}:undefined,...typeof _0x13c194==='string'?{'tag':base64url['decodeToBuffer'](_0x13c194)}:undefined};},validateAlgorithms=(_0x1c37e1,_0x1b9cd1)=>{const _0x4f4cb4=_0x1a263d,_0x5ee0ab={'qAvNk':function(_0x543757,_0x258e9f){return _0x543757!==_0x258e9f;}};if(_0x5ee0ab[_0x4f4cb4(0x1e4)](_0x1c37e1,undefined)&&(!Array[_0x4f4cb4(0x1f1)](_0x1c37e1)||_0x1c37e1[_0x4f4cb4(0x1c2)](_0x20a52f=>typeof _0x20a52f!==_0x4f4cb4(0x1d1)||!_0x20a52f)))throw new TypeError('\x22'+_0x1b9cd1+'\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings');if(!_0x1c37e1)return undefined;return new Set(_0x1c37e1);},jweDecrypt=(_0x2810f5,_0x1b6883,_0x254577,_0x3f3e65,{crit:crit=[],complete:complete=![],keyManagementAlgorithms:_0x2d69bb,contentEncryptionAlgorithms:_0x2124a8,maxPBES2Count:maxPBES2Count=0x2710}={})=>{const _0x3579f4=_0x1a263d,_0x48e775={'QVWjC':function(_0x36c517,_0x42f5db,_0x58ae1f,_0x4a7840,_0x4a9d6b){return _0x36c517(_0x42f5db,_0x58ae1f,_0x4a7840,_0x4a9d6b);},'nWjgi':_0x3579f4(0x1ec),'siakH':function(_0x2fe9f5,_0x463933,_0x348875,_0x4aaa74,_0x1b1d32,_0x2189ac){return _0x2fe9f5(_0x463933,_0x348875,_0x4aaa74,_0x1b1d32,_0x2189ac);},'sPKsZ':function(_0x2f1e8b,_0x694db3,_0x5edc86){return _0x2f1e8b(_0x694db3,_0x5edc86);},'sjKkO':'keyManagementAlgorithms','UBvhD':'\x22crit\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','YLMVn':function(_0x35fa6e,_0x574080){return _0x35fa6e(_0x574080);},'sPjFJ':function(_0xbf50ea,_0x171859){return _0xbf50ea===_0x171859;},'PMtWS':'general','ivNPz':'compact','DxTZW':function(_0x1b23a7,_0x1f2009){return _0x1b23a7 instanceof _0x1f2009;},'Exkbo':function(_0x994c44,_0x4c51b2){return _0x994c44===_0x4c51b2;},'gVopj':_0x3579f4(0x209),'eBGiK':_0x3579f4(0x218),'qNrtX':function(_0x40510a,_0x29e65f){return _0x40510a!==_0x29e65f;},'FpmVq':_0x3579f4(0x1e2),'YPVKX':function(_0x5498a3,_0x128b0e){return _0x5498a3===_0x128b0e;},'GkmKM':_0x3579f4(0x214),'OTzfP':_0x3579f4(0x1c1),'wlVgv':function(_0x57b87,_0x31beb4){return _0x57b87>_0x31beb4;},'sEPMm':_0x3579f4(0x1fa),'AqftF':function(_0x1d1f24,_0x58effe){return _0x1d1f24===_0x58effe;},'SsMra':'Afvbg','DxANw':function(_0xdd45f0,_0x412bba){return _0xdd45f0(_0x412bba);},'YULMU':_0x3579f4(0x1d8),'qJzBV':function(_0x43e86f,_0x35036e,_0x590f27,_0x873520,_0x298f60){return _0x43e86f(_0x35036e,_0x590f27,_0x873520,_0x298f60);},'VYHjX':function(_0x477631,_0x5612c){return _0x477631(_0x5612c);},'SLIbI':function(_0x234712,_0xbd5a53){return _0x234712||_0xbd5a53;},'lhIiT':function(_0x40a8e1,_0x3f8b8d,_0x2dad2d,_0x5786d1,_0x56be38){return _0x40a8e1(_0x3f8b8d,_0x2dad2d,_0x5786d1,_0x56be38);},'VbYpP':function(_0x4514a6,_0x542604,_0x1862d0,_0x551d30,_0x2d27d7,_0x5a4880){return _0x4514a6(_0x542604,_0x1862d0,_0x551d30,_0x2d27d7,_0x5a4880);},'LGTpx':_0x3579f4(0x20a)};_0x3f3e65=getKey(_0x3f3e65,!![]),_0x2d69bb=_0x48e775[_0x3579f4(0x1d0)](validateAlgorithms,_0x2d69bb,_0x48e775[_0x3579f4(0x1e6)]),_0x2124a8=validateAlgorithms(_0x2124a8,'contentEncryptionAlgorithms');if(!Array[_0x3579f4(0x1f1)](crit)||crit['some'](_0x12594d=>typeof _0x12594d!==_0x3579f4(0x1d1)||!_0x12594d))throw new TypeError(_0x48e775['UBvhD']);!_0x1b6883&&(_0x1b6883=_0x48e775[_0x3579f4(0x1c8)](resolveSerialization,_0x254577));let _0x258698,_0x105a09,_0x13378b,_0x5bdff4,_0x52f22c,_0x175313,_0x77d4cc,_0x3a2495,_0x4e1b07,_0x2cb250,_0x38e419,_0x8a5e85;if(_0x48e775['sPjFJ'](_0x1b6883,_0x48e775[_0x3579f4(0x203)])&&_0x48e775[_0x3579f4(0x1e3)](_0x254577['recipients'][_0x3579f4(0x1bd)],0x1)){_0x1b6883=_0x3579f4(0x219);const {recipients:_0x20f1b1,..._0x40615b}=_0x254577;_0x254577={..._0x40615b,..._0x20f1b1[0x0]};}if(SINGLE_RECIPIENT[_0x3579f4(0x1e8)](_0x1b6883)){_0x48e775['sPjFJ'](_0x1b6883,_0x48e775['ivNPz'])?[_0x77d4cc,_0x5bdff4,_0x52f22c,_0x105a09,_0x3a2495]=_0x254577['split']('.'):{protected:_0x77d4cc,encrypted_key:_0x5bdff4,iv:_0x52f22c,ciphertext:_0x105a09,tag:_0x3a2495,unprotected:_0x4e1b07,aad:_0x38e419,header:_0x8a5e85}=_0x254577;!_0x2810f5&&validateHeaders(_0x77d4cc,_0x4e1b07,[{'header':_0x8a5e85}],!![],crit);_0x175313=combineHeader(_0x77d4cc,_0x4e1b07,_0x8a5e85),{alg:_0x258698,enc:_0x13378b}=_0x175313;if(_0x2d69bb&&!_0x2d69bb[_0x3579f4(0x1e8)](_0x258698))throw new errors[(_0x3579f4(0x1f4))]('key\x20management\x20algorithm\x20not\x20whitelisted');if(_0x2124a8&&!_0x2124a8[_0x3579f4(0x1e8)](_0x13378b))throw new errors['JOSEAlgNotWhitelisted'](_0x3579f4(0x1bf));if(_0x48e775[_0x3579f4(0x1d5)](_0x3f3e65,KeyStore)){const _0x134bb4=_0x3f3e65;let _0x160cc9;if(_0x48e775['Exkbo'](_0x175313[_0x3579f4(0x1fe)],_0x48e775['gVopj']))_0x160cc9=_0x134bb4[_0x3579f4(0x1ef)]({'kid':_0x175313[_0x3579f4(0x1c7)],'alg':_0x175313[_0x3579f4(0x1e1)],'key_ops':['decrypt']});else{if(_0x3579f4(0x1c5)===_0x3579f4(0x1db)){const _0x343c9a=_0x48e775[_0x3579f4(0x1fd)](_0x67de61,_0x4d0e04,_0x70f118,_0x42de54[_0x3579f4(0x1f6)](_0x1bb424),_0x36f8a0);_0x49dd5e=_0x5dc6e1[_0x3579f4(0x1f5)](_0x5432f2(_0x343c9a),{'alg':_0x2bf9db,'use':'enc'});}else _0x160cc9=_0x134bb4[_0x3579f4(0x1ef)]({'kid':_0x175313[_0x3579f4(0x1c7)],'alg':_0x175313[_0x3579f4(0x1fe)],'key_ops':[_0x48e775['eBGiK']]});}switch(_0x160cc9[_0x3579f4(0x1bd)]){case 0x0:throw new errors[(_0x3579f4(0x213))]();case 0x1:_0x3f3e65=_0x160cc9[0x0];break;default:{const _0x42ac6b=[];for(const _0x4d21d6 of _0x160cc9){try{return jweDecrypt(!![],_0x1b6883,_0x254577,_0x4d21d6,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x2124a8?[..._0x2124a8]:undefined,'keyManagementAlgorithms':_0x2d69bb?[..._0x2d69bb]:undefined});}catch(_0x1f835a){if(_0x48e775[_0x3579f4(0x210)](_0x48e775[_0x3579f4(0x1d6)],_0x3579f4(0x1f2))){_0x42ac6b['push'](_0x1f835a);continue;}else({protected:_0x16e590,encrypted_key:_0x1924f9,iv:_0xdd8987,ciphertext:_0x273b2f,tag:_0x18683d,unprotected:_0x4db164,aad:_0x2e9d4c,header:_0x400b80}=_0x9ccff9);}}const _0x5433ff=new errors[(_0x3579f4(0x217))](_0x42ac6b);if([..._0x5433ff][_0x3579f4(0x1c2)](_0x1134dd=>_0x1134dd instanceof errors[_0x3579f4(0x1d3)])){if(_0x48e775['YPVKX'](_0x3579f4(0x214),_0x48e775[_0x3579f4(0x20f)]))throw new errors[(_0x3579f4(0x1d3))]();else throw new _0x190b82[(_0x3579f4(0x1d3))]();}throw _0x5433ff;}}}check(_0x3f3e65,..._0x258698===_0x3579f4(0x209)?[_0x3579f4(0x21a),_0x13378b]:['keyManagementDecrypt',_0x258698]);if(_0x258698[_0x3579f4(0x20c)](_0x48e775[_0x3579f4(0x1eb)])){if(_0x175313&&_0x48e775[_0x3579f4(0x1ff)](_0x175313[_0x3579f4(0x204)],maxPBES2Count))throw new errors[(_0x3579f4(0x212))](_0x48e775[_0x3579f4(0x1c4)]);}try{if(_0x48e775['AqftF'](_0x258698,_0x48e775[_0x3579f4(0x1cb)]))_0x2cb250=JWK[_0x3579f4(0x1f5)](_0x3f3e65,{'alg':_0x13378b,'use':'enc'});else{if(_0x48e775['sPjFJ'](_0x258698,_0x3579f4(0x20d))){if(_0x48e775['SsMra']!==_0x48e775[_0x3579f4(0x1e9)])throw new _0x5a1424[(_0x3579f4(0x1f4))](_0x48e775[_0x3579f4(0x208)]);else{const _0x1c1670=keyManagementDecrypt(_0x258698,_0x3f3e65,undefined,_0x175313);_0x2cb250=JWK[_0x3579f4(0x1f5)](_0x48e775[_0x3579f4(0x1ce)](createSecretKey,_0x1c1670),{'alg':_0x13378b,'use':'enc'});}}else{if(_0x48e775[_0x3579f4(0x1e7)]!==_0x48e775[_0x3579f4(0x1e7)])_0x48e775[_0x3579f4(0x1f8)](_0x5205ad,_0x33de5e,_0x62df45,[{'header':_0x268ea5}],!![],_0x21d6ae);else{const _0x25ffc0=_0x48e775[_0x3579f4(0x207)](keyManagementDecrypt,_0x258698,_0x3f3e65,base64url[_0x3579f4(0x1f6)](_0x5bdff4),_0x175313);_0x2cb250=JWK[_0x3579f4(0x1f5)](_0x48e775[_0x3579f4(0x1ee)](createSecretKey,_0x25ffc0),{'alg':_0x13378b,'use':'enc'});}}}}catch(_0x3b94d5){_0x2cb250=_0x48e775[_0x3579f4(0x1c8)](generateCEK,_0x13378b);}let _0x3ccd9f;_0x38e419?_0x3ccd9f=Buffer[_0x3579f4(0x206)]([Buffer[_0x3579f4(0x1f9)](_0x48e775[_0x3579f4(0x201)](_0x77d4cc,'')),Buffer['from']('.'),Buffer[_0x3579f4(0x1f9)](_0x38e419)]):_0x3ccd9f=Buffer['from'](_0x77d4cc||'');try{_0x52f22c=base64url[_0x3579f4(0x1f6)](_0x52f22c);}catch(_0xfd55a){}try{_0x3a2495=base64url['decodeToBuffer'](_0x3a2495);}catch(_0x14042d){}let _0x5a448f=_0x48e775[_0x3579f4(0x20b)](decrypt,_0x13378b,_0x2cb250,base64url[_0x3579f4(0x1f6)](_0x105a09),{'iv':_0x52f22c,'tag':_0x3a2495,'aad':_0x3ccd9f});_0x175313[_0x3579f4(0x1ed)]&&(_0x5a448f=_0x48e775[_0x3579f4(0x1c8)](inflateRawSync,_0x5a448f));if(complete){const _0x4e0203={'cleartext':_0x5a448f,'key':_0x3f3e65,'cek':_0x2cb250};if(_0x38e419)_0x4e0203['aad']=_0x38e419;if(_0x8a5e85)_0x4e0203[_0x3579f4(0x1cc)]=_0x8a5e85;if(_0x4e1b07)_0x4e0203[_0x3579f4(0x1bb)]=_0x4e1b07;if(_0x77d4cc)_0x4e0203[_0x3579f4(0x1ea)]=base64url['JSON'][_0x3579f4(0x1f0)](_0x77d4cc);return _0x4e0203;}return _0x5a448f;}validateHeaders(_0x254577[_0x3579f4(0x1ea)],_0x254577[_0x3579f4(0x1bb)],_0x254577[_0x3579f4(0x1b8)][_0x3579f4(0x1d2)](({header:_0x76e9f1})=>({'header':_0x76e9f1})),!![],crit);const {recipients:_0x36fc6b,..._0x4e3329}=_0x254577,_0x5430c7=[];for(const _0xa8a43 of _0x36fc6b){try{return _0x48e775[_0x3579f4(0x215)](jweDecrypt,!![],_0x3579f4(0x219),{..._0x4e3329,..._0xa8a43},_0x3f3e65,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x2124a8?[..._0x2124a8]:undefined,'keyManagementAlgorithms':_0x2d69bb?[..._0x2d69bb]:undefined});}catch(_0x5ee4a0){_0x5430c7[_0x3579f4(0x1c3)](_0x5ee4a0);continue;}}const _0x59f9ec=new errors[(_0x3579f4(0x217))](_0x5430c7);if([..._0x59f9ec]['some'](_0x40d5e6=>_0x40d5e6 instanceof errors[_0x3579f4(0x1d3)])){if(_0x48e775[_0x3579f4(0x21b)]===_0x3579f4(0x20a))throw new errors[(_0x3579f4(0x1d3))]();else _0x3f93fa=_0x27c163[_0x3579f4(0x1f9)](_0x29f20f||'');}else{if([..._0x59f9ec][_0x3579f4(0x202)](_0x9cb879=>_0x9cb879 instanceof errors[_0x3579f4(0x213)]))throw new errors[(_0x3579f4(0x213))]();}throw _0x59f9ec;};function _0x5c04(){const _0x6cb7fb=['../help/base64url','AHyqX','QVWjC','alg','wlVgv','apu','SLIbI','every','PMtWS','p2c','30740smAUTC','concat','qJzBV','nWjgi','dir','RDFgy','lhIiT','startsWith','ECDH-ES','690155ZsVzNl','GkmKM','qNrtX','../jwks','JWEInvalid','JWKSNoMatchingKey','LSzjc','VbYpP','exports','JOSEMultiError','unwrapKey','flattened','decrypt','LGTpx','../errors','recipients','5764orscYd','../jwa','unprotected','1418072xrMdqf','length','24304UBNlud','content\x20encryption\x20algorithm\x20not\x20whitelisted','61494PlLyhA','PBES2','some','push','sEPMm','EoLsz','./validate_headers','kid','YLMVn','./serializers','./generate_cek','gVopj','header','21FApwXD','DxANw','JSON','sPKsZ','string','map','JWEDecryptionFailed','35NbYUpX','DxTZW','FpmVq','zlib','jnbVo','p2s','../help/key_object','mUBqF','7369579VgGwBz','IQLph','apv','tag','TvNsC','enc','PdJtC','sPjFJ','qAvNk','../jwk','sjKkO','YULMU','has','SsMra','protected','OTzfP','key\x20management\x20algorithm\x20not\x20whitelisted','zip','VYHjX','all','decode','isArray','AYmpR','30010YTdGkF','JOSEAlgNotWhitelisted','asKey','decodeToBuffer','45PvsVQD','siakH','from','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds'];_0x5c04=function(){return _0x6cb7fb;};return _0x5c04();}module[_0x1a263d(0x216)]=jweDecrypt['bind'](undefined,![],undefined);