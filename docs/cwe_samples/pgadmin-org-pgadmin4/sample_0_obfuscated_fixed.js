const _0x5874b9=_0x3a7a;(function(_0x492a43,_0x59f40d){const _0xe46c78=_0x3a7a,_0x4a20ee=_0x492a43();while(!![]){try{const _0x28d252=parseInt(_0xe46c78(0x1ed))/0x1*(parseInt(_0xe46c78(0x1ba))/0x2)+parseInt(_0xe46c78(0x1f2))/0x3*(parseInt(_0xe46c78(0x1e9))/0x4)+parseInt(_0xe46c78(0x1fa))/0x5+parseInt(_0xe46c78(0x1c4))/0x6+-parseInt(_0xe46c78(0x1b4))/0x7*(parseInt(_0xe46c78(0x201))/0x8)+-parseInt(_0xe46c78(0x1cb))/0x9*(parseInt(_0xe46c78(0x1fe))/0xa)+parseInt(_0xe46c78(0x1af))/0xb*(-parseInt(_0xe46c78(0x1bb))/0xc);if(_0x28d252===_0x59f40d)break;else _0x4a20ee['push'](_0x4a20ee['shift']());}catch(_0x630a98){_0x4a20ee['push'](_0x4a20ee['shift']());}}}(_0x4d90,0xb0faa));import _0x427b76 from'ava';function _0x3a7a(_0x3d6022,_0x1e8a35){const _0x4d902b=_0x4d90();return _0x3a7a=function(_0x3a7a6c,_0x5b9feb){_0x3a7a6c=_0x3a7a6c-0x1ae;let _0x3d71c6=_0x4d902b[_0x3a7a6c];return _0x3d71c6;},_0x3a7a(_0x3d6022,_0x1e8a35);}import*as _0x4f2218 from'crypto';const {FlattenedEncrypt,flattenedDecrypt}=await import(_0x5874b9(0x1e0));function _0x4d90(){const _0x1ebc15=['JWE\x20format\x20validation','lNKgc','dlksD','Cmggz','throwsAsync','hndXp','missing\x20JWE\x20Algorithm\x20(alg)\x20in\x20JWE\x20Header','decrypt\x20PBES2\x20p2c\x20limit','setProtectedHeader','set','randomFillSync','JWE\x20AAD\x20incorrect\x20type','aGAbG','A128CBC-HS256','JWE\x20Ciphertext\x20missing\x20or\x20incorrect\x20type','ahRzT','RoICq','#dist','tag','JWE\x20Protected,\x20JWE\x20Unprotected\x20Header,\x20and\x20JWE\x20Per-Recipient\x20Unprotected\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','context','QZosR','ERR_JWE_DECRYPTION_FAILED','setKeyManagementParameters','encrypt','wkmbl','12992KOLqWZ','protected','baz','slice','1783knymaE','decryption\x20operation\x20failed','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','before','JWE\x20Authentication\x20Tag\x20missing\x20or\x20incorrect\x20type','1092OkEMKi','Flattened\x20JWE\x20must\x20be\x20an\x20object','JWE\x20Shared\x20Unprotected\x20Header\x20incorrect\x20type','additionalAuthenticatedData','plaintext','CpgJx','UPGJG','encrypted_key','463040IDAGaa','NFQJq','Encountered\x20unexpected\x20JWE\x20Encrypted\x20Key','secret','673240WeQeGp','JWE\x20Protected\x20Header\x20incorrect\x20type','egeRv','24vvNten','vGlbR','SPpgQ','385JxAePr','foo','header','hmYiF','prototype','1993845eOEktI','ERR_JWE_INVALID','pupto','A128GCM','The\x20Fellowship\x20of\x20the\x20Ring','initializationVector','514dIChOM','295080DhJBld','dir','bar','MkROP','pOnsQ','PBES2-HS256+A128KW','wetuM','GnnJH','unprotected','7473252bgVvkz','ciphertext','JWE\x20Encrypted\x20Key\x20incorrect\x20type','setUnprotectedHeader','aad','Nsorv','setAdditionalAuthenticatedData','72BIRUbU','AES\x20CBC\x20+\x20HMAC','OZzvT','SiLtX'];_0x4d90=function(){return _0x1ebc15;};return _0x4d90();}_0x427b76[_0x5874b9(0x1f0)](async _0x14e3ee=>{const _0x19f49d=_0x5874b9,_0x389aac={'UPGJG':function(_0x441eaf,_0x3e068b){return _0x441eaf(_0x3e068b);},'SPpgQ':'Itâ€™s\x20a\x20dangerous\x20business,\x20Frodo,\x20going\x20out\x20your\x20door.','lNKgc':_0x19f49d(0x1b8)},_0x3a197b=TextEncoder[_0x19f49d(0x1b3)]['encode']['bind'](new TextEncoder());_0x14e3ee[_0x19f49d(0x1e3)]['plaintext']=_0x389aac['UPGJG'](_0x3a197b,_0x389aac[_0x19f49d(0x1ae)]),_0x14e3ee['context'][_0x19f49d(0x1f5)]=_0x389aac[_0x19f49d(0x1f8)](_0x3a197b,_0x389aac[_0x19f49d(0x1d0)]),_0x14e3ee[_0x19f49d(0x1e3)][_0x19f49d(0x1b9)]=new Uint8Array(0xc),_0x14e3ee[_0x19f49d(0x1e3)][_0x19f49d(0x1fd)]=new Uint8Array(0x10);}),_0x427b76(_0x5874b9(0x1cf),async _0x56a2b9=>{const _0x51dea5=_0x5874b9,_0x31651d={'Nsorv':_0x51dea5(0x1bd),'GnnJH':'A128GCM','ahRzT':_0x51dea5(0x1b5),'Cmggz':'JOSE\x20Header\x20missing','SiLtX':'JWE\x20Initialization\x20Vector\x20missing\x20or\x20incorrect\x20type','egeRv':_0x51dea5(0x1dd),'QZosR':_0x51dea5(0x1f1),'hndXp':function(_0x3c1770,_0x4af8ee,_0xb5f14a){return _0x3c1770(_0x4af8ee,_0xb5f14a);},'CpgJx':'JWE\x20Protected\x20Header\x20is\x20invalid','TKvhC':_0x51dea5(0x1c6),'OZzvT':_0x51dea5(0x1da),'hmYiF':_0x51dea5(0x1f4),'MkROP':function(_0x168287,_0x3a34a1,_0x417b87){return _0x168287(_0x3a34a1,_0x417b87);},'vGlbR':'JWE\x20Per-Recipient\x20Unprotected\x20Header\x20incorrect\x20type','pupto':'missing\x20JWE\x20Encryption\x20Algorithm\x20(enc)\x20in\x20JWE\x20Header','GulIR':_0x51dea5(0x1fc)},_0x3574ae=await new FlattenedEncrypt(_0x56a2b9[_0x51dea5(0x1e3)]['plaintext'])[_0x51dea5(0x1d7)]({'bar':_0x51dea5(0x1eb)})[_0x51dea5(0x1c7)]({'foo':_0x31651d[_0x51dea5(0x1c9)]})['setSharedUnprotectedHeader']({'alg':_0x51dea5(0x1bc),'enc':_0x31651d[_0x51dea5(0x1c2)]})[_0x51dea5(0x1ca)](_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1f5)])[_0x51dea5(0x1e7)](_0x56a2b9[_0x51dea5(0x1e3)]['secret']);{await _0x56a2b9['throwsAsync'](flattenedDecrypt(null,_0x56a2b9[_0x51dea5(0x1e3)]['secret']),{'message':_0x51dea5(0x1f3),'code':_0x31651d[_0x51dea5(0x1de)]});}{const _0x682a7f={..._0x3574ae};delete _0x682a7f[_0x51dea5(0x1ea)],delete _0x682a7f[_0x51dea5(0x1b1)],delete _0x682a7f[_0x51dea5(0x1c3)],await _0x56a2b9[_0x51dea5(0x1d3)](flattenedDecrypt(_0x682a7f,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d[_0x51dea5(0x1d2)],'code':_0x31651d['ahRzT']});}{const _0x462f8a={..._0x3574ae};delete _0x462f8a['iv'];const _0x18b564={'message':_0x31651d[_0x51dea5(0x1ce)],'code':_0x51dea5(0x1b5)};await _0x56a2b9[_0x51dea5(0x1d3)](flattenedDecrypt(_0x462f8a,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),_0x18b564),_0x462f8a['iv']=null,await _0x56a2b9[_0x51dea5(0x1d3)](flattenedDecrypt(_0x462f8a,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),_0x18b564);}{const _0x2edc3e={..._0x3574ae};delete _0x2edc3e[_0x51dea5(0x1c5)];const _0x591a48={'message':_0x31651d[_0x51dea5(0x200)],'code':_0x51dea5(0x1b5)};await _0x56a2b9[_0x51dea5(0x1d3)](flattenedDecrypt(_0x2edc3e,_0x56a2b9['context'][_0x51dea5(0x1fd)]),_0x591a48),_0x2edc3e[_0x51dea5(0x1c5)]=null,await _0x56a2b9['throwsAsync'](flattenedDecrypt(_0x2edc3e,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),_0x591a48);}{const _0x38e85c={..._0x3574ae};delete _0x38e85c[_0x51dea5(0x1e1)];const _0x37a028={'message':_0x31651d[_0x51dea5(0x1e4)],'code':_0x51dea5(0x1b5)};await _0x56a2b9[_0x51dea5(0x1d3)](_0x31651d[_0x51dea5(0x1d4)](flattenedDecrypt,_0x38e85c,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),_0x37a028),_0x38e85c['tag']=null,await _0x56a2b9[_0x51dea5(0x1d3)](flattenedDecrypt(_0x38e85c,_0x56a2b9[_0x51dea5(0x1e3)]['secret']),_0x37a028);}{const _0x5d9823={..._0x3574ae};_0x5d9823[_0x51dea5(0x1ea)]=null,await _0x56a2b9['throwsAsync'](flattenedDecrypt(_0x5d9823,_0x56a2b9['context'][_0x51dea5(0x1fd)]),{'message':_0x51dea5(0x1ff),'code':_0x51dea5(0x1b5)});}{const _0x1703d2={..._0x3574ae},_0x114662={'message':_0x31651d[_0x51dea5(0x1f7)],'code':_0x31651d[_0x51dea5(0x1de)]};_0x1703d2[_0x51dea5(0x1ea)]='1'+_0x1703d2[_0x51dea5(0x1ea)],await _0x56a2b9['throwsAsync'](flattenedDecrypt(_0x1703d2,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),_0x114662);}{const _0x59cce3={..._0x3574ae};_0x59cce3['encrypted_key']=null,await _0x56a2b9[_0x51dea5(0x1d3)](_0x31651d[_0x51dea5(0x1d4)](flattenedDecrypt,_0x59cce3,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d['TKvhC'],'code':_0x51dea5(0x1b5)});}{const _0x504b9e={..._0x3574ae};_0x504b9e[_0x51dea5(0x1c8)]=null,await _0x56a2b9[_0x51dea5(0x1d3)](_0x31651d[_0x51dea5(0x1d4)](flattenedDecrypt,_0x504b9e,_0x56a2b9[_0x51dea5(0x1e3)]['secret']),{'message':_0x31651d[_0x51dea5(0x1cd)],'code':_0x31651d[_0x51dea5(0x1de)]});}{const _0xb432df={..._0x3574ae};_0xb432df[_0x51dea5(0x1b1)]=null,await _0x56a2b9['throwsAsync'](_0x31651d[_0x51dea5(0x1d4)](flattenedDecrypt,_0xb432df,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d[_0x51dea5(0x1b2)],'code':_0x31651d['ahRzT']});}{const _0x30d10a={..._0x3574ae};_0x30d10a['unprotected']=null,await _0x56a2b9['throwsAsync'](_0x31651d[_0x51dea5(0x1be)](flattenedDecrypt,_0x30d10a,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d[_0x51dea5(0x202)],'code':_0x31651d[_0x51dea5(0x1de)]});}{const _0x30c1ca={..._0x3574ae};_0x30c1ca[_0x51dea5(0x1c3)]={'foo':'bar'},await _0x56a2b9[_0x51dea5(0x1d3)](_0x31651d[_0x51dea5(0x1be)](flattenedDecrypt,_0x30c1ca,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x51dea5(0x1e2),'code':_0x31651d[_0x51dea5(0x1de)]});}{const _0x1919b6={..._0x3574ae};_0x1919b6[_0x51dea5(0x1c3)]={'enc':_0x51dea5(0x1b7)},await _0x56a2b9[_0x51dea5(0x1d3)](_0x31651d[_0x51dea5(0x1be)](flattenedDecrypt,_0x1919b6,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x51dea5(0x1d5),'code':_0x51dea5(0x1b5)});}{const _0x367f98={..._0x3574ae};_0x367f98[_0x51dea5(0x1c3)]={'alg':_0x51dea5(0x1bc)},await _0x56a2b9['throwsAsync'](flattenedDecrypt(_0x367f98,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d[_0x51dea5(0x1b6)],'code':_0x31651d[_0x51dea5(0x1de)]});}{const _0x5773d7={..._0x3574ae};_0x5773d7[_0x51dea5(0x1f9)]=_0x51dea5(0x1b0),await _0x56a2b9['throwsAsync'](_0x31651d[_0x51dea5(0x1d4)](flattenedDecrypt,_0x5773d7,_0x56a2b9[_0x51dea5(0x1e3)][_0x51dea5(0x1fd)]),{'message':_0x31651d['GulIR'],'code':'ERR_JWE_INVALID'});}}),_0x427b76(_0x5874b9(0x1cc),async _0x264566=>{const _0x47bdd6=_0x5874b9,_0xc9532d={'wetuM':'dir','NFQJq':'foo','dlksD':function(_0x311461,_0x54cd71,_0x5140b9){return _0x311461(_0x54cd71,_0x5140b9);},'wkmbl':_0x47bdd6(0x1e5),'RoICq':_0x47bdd6(0x1ee)},_0x59a344=_0x4f2218[_0x47bdd6(0x1d9)](new Uint8Array(0x20)),_0x2472e8=await new FlattenedEncrypt(_0x264566[_0x47bdd6(0x1e3)][_0x47bdd6(0x1f6)])['setProtectedHeader']({'alg':_0xc9532d[_0x47bdd6(0x1c1)],'enc':_0x47bdd6(0x1dc)})['encrypt'](_0x59a344);{const _0x4a32fc={..._0x2472e8};_0x4a32fc[_0x47bdd6(0x1e1)]=_0xc9532d[_0x47bdd6(0x1fb)],await _0x264566[_0x47bdd6(0x1d3)](flattenedDecrypt(_0x4a32fc,_0x59a344),{'code':'ERR_JWE_DECRYPTION_FAILED','message':_0x47bdd6(0x1ee)});}{const _0x2f1fda={..._0x2472e8};_0x2f1fda[_0x47bdd6(0x1c5)]=_0xc9532d[_0x47bdd6(0x1fb)],await _0x264566[_0x47bdd6(0x1d3)](_0xc9532d[_0x47bdd6(0x1d1)](flattenedDecrypt,_0x2f1fda,_0x59a344),{'code':_0xc9532d[_0x47bdd6(0x1e8)],'message':_0xc9532d[_0x47bdd6(0x1df)]});}{const _0xa7aae9=new Uint8Array(0x20);_0xa7aae9[_0x47bdd6(0x1d8)](_0x59a344[_0x47bdd6(0x1ec)](0x0,0x10),0x10),_0xa7aae9[_0x47bdd6(0x1d8)](_0x59a344['slice'](0x10),0x0),await _0x264566[_0x47bdd6(0x1d3)](_0xc9532d[_0x47bdd6(0x1d1)](flattenedDecrypt,_0x2472e8,_0xa7aae9),{'code':_0x47bdd6(0x1e5),'message':'decryption\x20operation\x20failed'});}}),_0x427b76(_0x5874b9(0x1d6),async _0x36934c=>{const _0x2f0560=_0x5874b9,_0x13e9fa={'ytYmb':_0x2f0560(0x1c0),'aGAbG':_0x2f0560(0x1dc),'pOnsQ':function(_0xfe016e,_0x4afc64,_0x36f23c,_0x3fd04e){return _0xfe016e(_0x4afc64,_0x36f23c,_0x3fd04e);},'xDykW':'ERR_JWE_INVALID'},_0x4e4dc9=await new FlattenedEncrypt(new Uint8Array(0x0))['setProtectedHeader']({'alg':_0x13e9fa['ytYmb'],'enc':_0x13e9fa[_0x2f0560(0x1db)]})[_0x2f0560(0x1e6)]({'p2c':0x801})[_0x2f0560(0x1e7)](new Uint8Array(0x20));await _0x36934c['throwsAsync'](_0x13e9fa[_0x2f0560(0x1bf)](flattenedDecrypt,_0x4e4dc9,new Uint8Array(0x20),{'maxPBES2Count':0x800}),{'message':_0x2f0560(0x1ef),'code':_0x13e9fa['xDykW']});});