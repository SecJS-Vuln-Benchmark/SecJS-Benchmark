const _0x3d7c61=_0x366e;(function(_0x1aff69,_0x426ba0){const _0x237396=_0x366e,_0x5c9e97=_0x1aff69();while(!![]){try{const _0x485c54=-parseInt(_0x237396(0x103))/0x1*(parseInt(_0x237396(0x18f))/0x2)+parseInt(_0x237396(0x209))/0x3+-parseInt(_0x237396(0x1bc))/0x4+-parseInt(_0x237396(0x11c))/0x5*(parseInt(_0x237396(0x1cf))/0x6)+parseInt(_0x237396(0x158))/0x7+-parseInt(_0x237396(0x1f5))/0x8+parseInt(_0x237396(0xfa))/0x9;if(_0x485c54===_0x426ba0)break;else _0x5c9e97['push'](_0x5c9e97['shift']());}catch(_0x1ab8c4){_0x5c9e97['push'](_0x5c9e97['shift']());}}}(_0x1593,0xadfd3));function _0x1593(){const _0xe6aa8f=['RANEx','FOO','versions','protected','msSnu','jFxPo','ITQel','JWE\x20must\x20only\x20have\x20one\x20Content\x20Encryption\x20algorithm\x20(encrypt)','compact','IAuCk','JSON','rYsQF','lmzFN','JWE\x20\x22zip\x22\x20only\x20DEF\x20is\x20supported','JWE\x20Compact\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients,\x20JWE\x20unprotected\x20headers\x20or\x20AAD','HjALm','key\x20management\x20algorithm\x20not\x20whitelisted','iqCcm','cPcFA','slice','ERR_JOSE_NOT_SUPPORTED','\x22enc\x22\x20value\x20must\x20be\x20supported\x20error\x20(when\x20no\x20alg\x20was\x20specified)','etDCv','yTRna','hAKOU','vQsAi','\x22zip\x22\x20Header\x20Parameter\x20MUST\x20be\x20integrity\x20protected','XveXL','JWE\x20must\x20only\x20have\x20one\x20Content\x20Encryption\x20algorithm\x20(decrypt)','lKpFp','obByi','KtqwB','header','dVuSx','A256CBC-HS512','bneCb','JWE\x20encrypt\x20rejects\x20other','invalid\x20iv','fPEzg','BPBkO','ljDfg','aes_cbc_hmac_sha2\x20decrypt\x20iv\x20check\x20(invalid\x20length)','recipients','JOSEAlgNotWhitelisted','JWEInvalid','electron','enc','RUsdF','A192GCMKW','oNmui','tNiXG','...','qfOcu','19869237VmiFqA','JWE\x20\x22zip\x22\x20only\x20DEF\x20is\x20supported\x20(decrypt)','rdfPN','UtuUp','YqoSR','ViAcq','OjhDo','yUYSd','JWE\x20must\x20have\x20a\x20Content\x20Encryption\x20algorithm\x20(decrypt)','1031OPqqmn','cleartext\x20argument\x20must\x20be\x20a\x20Buffer\x20or\x20a\x20string','there\x20must\x20only\x20be\x20one\x20Content\x20Encryption\x20algorithm','cUhig','xLEYM','ERR_JWE_DECRYPTION_FAILED','JWE\x20malformed\x20or\x20invalid\x20serialization','JogIk','ECDH-ES','FTATr','BioTM','general','qFLvO','\x22contentEncryptionAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','nkyHy','decode','throws','missing\x20Content\x20Encryption\x20algorithm','fcYXr','sxroa','EExGe','YYPiw','\x22sig\x22\x20key\x20is\x20not\x20usable\x20for\x20signing','Mrxkn','ehSmw','31400icrgll','RWpDK','JWEDecryptionFailed','UsFIy','QxMqO','A256KW','JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist','pass','MsiHb','Encrypt','unprotected','JWE\x20no\x20alg/enc\x20specified\x20(multi\x20recipient)\x20with\x20per-recipient\x20headers','kid_3','ewowB','PwXbC','VtwjB','compact\x20parts\x20length\x20check','bZocH','GQujG','sytDh','gyFIK','decrypt\x20PBES2\x20p2c\x20limit','recipient','JkiWK','RSA','JWE\x20oct\x20dir\x20is\x20only\x20usable\x20with\x20a\x20single\x20recipient','VihVm','zip','a\x20key\x20with\x20\x22use\x22:\x22sig\x22\x20is\x20not\x20usable\x20for\x20encryption','encode','vQDSd','contentEncryptionAlgorithms\x20option\x20be\x20an\x20array\x20of\x20strings','JWE\x20EC\x20ECDH-ES\x20is\x20only\x20usable\x20with\x20a\x20single\x20recipient','qwvSS','JWE\x20encrypt\x20protectedHeader\x20rejects\x20non\x20objects\x20if\x20provided','deepEqual','fmlgB','RrzOH','fdnFZ','XYiuF','JWE\x20keystore\x20match\x20multi\x20but\x20fails\x20with\x20decryption\x20error','A128GCM','dOyZV','serialization\x20must\x20be\x20one\x20of\x20\x22compact\x22,\x20\x22flattened\x22,\x20\x22general\x22','JWE\x20encrypt\x20aad\x20rejects\x20non\x20buffers\x20and\x20non\x20strings','RSA-OAEP','JWE\x20no\x20alg\x20specified\x20but\x20cannot\x20resolve','FDZze','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','XdDlN','sign','header\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided','\x22keyManagementAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','ESIFT','yoUPL','true','tag','DjLyN','dir\x20and\x20ECDH-ES\x20alg\x20may\x20only\x20be\x20used\x20with\x20a\x20single\x20recipient','aad','4897844rHxayD','BthXW','ChZHN','A256GCMKW','flattened','ERR_JOSE_MULTIPLE_ERRORS','only\x20\x22DEF\x22\x20compression\x20algorithm\x20is\x20supported','npZdg','fmPow','mSZPN','JWE\x20encrypt\x20unprotectedHeader\x20rejects\x20non\x20objects\x20if\x20provided','svVZj','JWE\x20compact\x20does\x20not\x20support\x20aad','CFAWp','TyPek','oviJZ','Utynu','missing\x20recipients','rWixh','WRUyo','KjWfz','kRqCY','QTIUi','xCLlk','Laypy','ZddDe','MInCO','JWE\x20no\x20alg\x20specified\x20(single\x20rsa),\x20with\x20unprotected\x20header','zrBjN','TQLRM','RSA1_5','CZVdT','JWE\x20encrypt\x20accepts\x20string','aqpQX','pPESF','aes_gcm\x20decrypt\x20iv\x20check\x20(invalid\x20length)','xRVjV','TpHas','rGMUa','JajCb','A128GCMKW','CnNGk','AdXtp','jwk\x20key\x20id','JWE\x20general\x20fails\x20with\x20decryption\x20error','JOSEMultiError','JWE\x20no\x20alg/enc\x20specified\x20(single\x20oct)','tPKAb','QTuum','sig','A128KW','GtvDB','kid','AdITV','YTdNp','2446soKCzu','OmBrC','PBES2-HS256+A128KW','eJJjY','decodeToBuffer','qZlLm','ukJAk','forEach','WffVu','cSRGo','vhXRL','IMNHx','JWE\x20\x22zip\x22\x20must\x20be\x20integrity\x20protected','DEF','EVruU','decrypt','from','ERR_JOSE_ALG_NOT_WHITELISTED','JjbhI','ezLbl','lksmx','JWE\x20Shared\x20Protected,\x20JWE\x20Shared\x20Unprotected\x20and\x20JWE\x20Per-Recipient\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','UxkNh','MVnJj','JWE\x20no\x20alg/enc\x20specified\x20(single\x20rsa),\x20no\x20protected\x20header','sHNTr','pRZXr','JWE\x20no\x20alg/enc\x20specified\x20(multi\x20recipient)','pdvho','XvfQL','DWoIH','cNSTQ','MTrzN','kid_2','tsADr','sQDCd','gfxTG','invalid\x20tag','LbvrF','unsupported\x20encrypt\x20alg:\x20foo','lFnwE','sTmhN','dir','JWE\x20encrypt\x20accepts\x20buffer','TKRZl','2368116Kawoco','CwfUC','PBES2-HS384+A192KW','ECDH-ES+A128KW','eRrfO','oct','JWE\x20decrypt\x20contentEncryptionAlgorithms\x20whitelist','hhZUz','lYPHS','wyqzb','XIFzO','RDIuG','A128CBC-HS256','MUwWM','ziGKK','ZQMyZ','\x22enc\x22\x20value\x20must\x20be\x20supported\x20error','EeUMj','AHUkc','78CUqJBo','bar','IVYUN','slqND','NtGbq','nFCew','qUBjy','tsAgI','gmZHu','JWE\x20encrypt\x20per-recipient\x20header\x20rejects\x20non\x20objects\x20if\x20provided','JWE\x20no\x20alg/enc\x20specified\x20(only\x20on\x20a\x20key)','QoTAv','JWKKeySupport','RkuMb','ZjGbJ','RAcxJ','OYToW','rSxBe','FhvsW','iPwpR','encrypt','FdQie','mzHAT','.....','aes_cbc_hmac_sha2\x20decrypt\x20tag\x20check\x20(missing)','could\x20not\x20resolve\x20a\x20usable\x20\x22alg\x22\x20for\x20a\x20recipient','fDRBy','eJDlp','IGVmk','ZCcoE','ndWof','aad\x20argument\x20must\x20be\x20a\x20Buffer\x20or\x20a\x20string\x20when\x20provided','GWDGi','stmhz','JWE\x20compact\x20does\x20not\x20support\x20unprotected\x20header','constructor','tPEwb','KeyStore','4880672zjgBbq','rYMrv','wkWxa','wmiAB','SMOQe','DoJSk','aes_gcm\x20decrypt\x20tag\x20check\x20(missing)','lXQWy','qbTmk','IWcHB','JWE\x20prot,\x20unprot\x20and\x20per-recipient\x20headers\x20must\x20be\x20disjoint','foo','kvuyz','spJdz','JOSENotSupported','vTuSM','alg','ERR_JWE_INVALID','FMGxm','nSDlv','1049820NoURZQ','HS256','PNflo','LoOqZ','OTzSy','eUmsa','keyManagementAlgorithms\x20option\x20be\x20an\x20array\x20of\x20strings'];_0x1593=function(){return _0xe6aa8f;};return _0x1593();}function _0x366e(_0x476948,_0x23a681){const _0x1593da=_0x1593();return _0x366e=function(_0x366e50,_0x1e0a09){_0x366e50=_0x366e50-0xe1;let _0x3d5827=_0x1593da[_0x366e50];return _0x3d5827;},_0x366e(_0x476948,_0x23a681);}const test=require('ava'),base64url=require('../../lib/help/base64url'),{JWKS,JWK:{generateSync},JWE,errors}=require('../..');test(_0x3d7c61(0x20f),_0x1d3aff=>{const _0x2b4130=_0x3d7c61,_0x3a3be7={'DoJSk':_0x2b4130(0x20a),'Utynu':_0x2b4130(0x200),'hAago':_0x2b4130(0x150)};;[{},new Object(),![],null,Infinity,0x0,'',Buffer['from'](_0x2b4130(0x200))]['forEach'](_0x4cb1b8=>{_0x1d3aff['throws'](()=>{const _0x1ad317=_0x366e;JWE['decrypt']({'header':{'alg':_0x3a3be7[_0x1ad317(0x1fa)]},'payload':_0x3a3be7[_0x1ad317(0x168)],'ciphertext':_0x1ad317(0x1d0)},generateSync('oct'),{'keyManagementAlgorithms':_0x4cb1b8});},{'instanceOf':TypeError,'message':_0x3a3be7['hAago']}),_0x1d3aff['throws'](()=>{const _0x31ea43=_0x366e;JWE['decrypt']({'header':{'alg':_0x31ea43(0x20a)},'payload':_0x3a3be7['Utynu'],'ciphertext':_0x31ea43(0x1d0)},generateSync(_0x31ea43(0x1c1)),{'keyManagementAlgorithms':[_0x4cb1b8]});},{'instanceOf':TypeError,'message':'\x22keyManagementAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings'});});}),test(_0x3d7c61(0x13b),_0x3e4ebe=>{const _0x5d8d32=_0x3d7c61,_0x5ea51f={'MTrzN':_0x5d8d32(0x20a),'dOyZV':'bar','ZAnKU':_0x5d8d32(0x1c1),'FTATr':_0x5d8d32(0x110),'nodot':'foo'};;[{},new Object(),![],null,Infinity,0x0,'',Buffer[_0x5d8d32(0x19f)](_0x5ea51f['nodot'])][_0x5d8d32(0x196)](_0x285fa5=>{const _0x401ebd=_0x5d8d32,_0x367a6c={'vTuSM':_0x5ea51f['dOyZV']};_0x3e4ebe[_0x401ebd(0x113)](()=>{const _0x4c379f=_0x401ebd;JWE[_0x4c379f(0x19e)]({'header':{'alg':_0x5ea51f[_0x4c379f(0x1af)]},'payload':_0x4c379f(0x200),'ciphertext':_0x5ea51f[_0x4c379f(0x146)]},generateSync(_0x5ea51f['ZAnKU']),{'contentEncryptionAlgorithms':_0x285fa5});},{'instanceOf':TypeError,'message':_0x5ea51f[_0x401ebd(0x10c)]}),_0x3e4ebe[_0x401ebd(0x113)](()=>{const _0x11dedf=_0x401ebd;JWE[_0x11dedf(0x19e)]({'header':{'alg':_0x11dedf(0x20a)},'payload':'foo','ciphertext':_0x367a6c[_0x11dedf(0x204)]},generateSync('oct'),{'contentEncryptionAlgorithms':[_0x285fa5]});},{'instanceOf':TypeError,'message':_0x401ebd(0x110)});});}),test(_0x3d7c61(0x12c),_0x4fa9dd=>{const _0x4a5842=_0x3d7c61,_0x1f3a3a={'hcWda':function(_0x4738df,_0x5b5e66){return _0x4738df(_0x5b5e66);},'SMOQe':_0x4a5842(0x1c1),'vhXRL':_0x4a5842(0xf8),'UDDeg':function(_0x1fcdf9,_0x16e968){return _0x1fcdf9(_0x16e968);},'TQLRM':_0x4a5842(0x206),'CZVdT':_0x4a5842(0x109)};_0x4fa9dd['throws'](()=>{const _0x48fb2e=_0x4a5842;JWE[_0x48fb2e(0x19e)]('',_0x1f3a3a['hcWda'](generateSync,_0x1f3a3a[_0x48fb2e(0x1f9)]));},{'instanceOf':errors['JWEInvalid'],'code':_0x1f3a3a[_0x4a5842(0x175)],'message':_0x1f3a3a[_0x4a5842(0x177)]}),_0x4fa9dd[_0x4a5842(0x113)](()=>{const _0x4d0656=_0x4a5842;JWE[_0x4d0656(0x19e)](_0x1f3a3a[_0x4d0656(0x199)],_0x1f3a3a['UDDeg'](generateSync,_0x1f3a3a['SMOQe']));},{'instanceOf':errors[_0x4a5842(0xf1)],'code':_0x4a5842(0x206),'message':_0x1f3a3a[_0x4a5842(0x177)]}),_0x4fa9dd['throws'](()=>{const _0x45bc74=_0x4a5842;JWE['decrypt'](_0x45bc74(0x1e6),generateSync(_0x1f3a3a[_0x45bc74(0x1f9)]));},{'instanceOf':errors['JWEInvalid'],'code':_0x4a5842(0x206),'message':_0x1f3a3a[_0x4a5842(0x177)]});}),test(_0x3d7c61(0x14a),_0x135763=>{const _0x512568=_0x3d7c61,_0x5a30e4={'RWpDK':_0x512568(0x1c1),'cUhig':_0x512568(0x14e),'mIrpj':_0x512568(0x1e8)},_0xda828e=generateSync(_0x5a30e4[_0x512568(0x11d)],undefined,{'key_ops':[_0x5a30e4[_0x512568(0x106)]]});_0x135763['throws'](()=>{const _0x42464f=_0x512568;JWE[_0x42464f(0x1e3)](_0x42464f(0x200),_0xda828e);},{'instanceOf':errors[_0x512568(0xf1)],'code':_0x512568(0x206),'message':_0x5a30e4['mIrpj']});}),test(_0x3d7c61(0x1aa),_0x36463c=>{const _0x97116e=_0x3d7c61,_0x5d2eba={'QoTAv':_0x97116e(0x200),'yIPXW':function(_0x41dbdf,_0x3a351a){return _0x41dbdf(_0x3a351a);},'vQDSd':'RSA','FehTO':function(_0xeea86e,_0x31ef18,_0x4547fd){return _0xeea86e(_0x31ef18,_0x4547fd);},'JtoJa':_0x97116e(0x1c1),'TKRZl':function(_0x33e9f2,_0x160192){return _0x33e9f2 in _0x160192;},'iyyCJ':'electron','EVruU':function(_0x4f4385,_0x1d8b31){return _0x4f4385(_0x1d8b31);},'SyGcC':_0x97116e(0x1c8),'nkyHy':function(_0x27d1f6,_0x467d40){return _0x27d1f6 in _0x467d40;},'slqND':'A256GCMKW'},_0x31e161=new JWE[(_0x97116e(0x125))](_0x5d2eba[_0x97116e(0x1da)]);_0x31e161[_0x97116e(0x132)](_0x5d2eba['yIPXW'](generateSync,_0x5d2eba[_0x97116e(0x13a)])),_0x31e161[_0x97116e(0x132)](_0x5d2eba['FehTO'](generateSync,_0x5d2eba['JtoJa'],0x100));!_0x5d2eba[_0x97116e(0x1bb)](_0x5d2eba['iyyCJ'],process['versions'])&&_0x31e161[_0x97116e(0x132)](_0x5d2eba[_0x97116e(0x19d)](generateSync,'EC'));const _0x4a5bb3=_0x31e161[_0x97116e(0x1e3)](_0x97116e(0x10e));_0x36463c['is'](_0x4a5bb3[_0x97116e(0x126)],undefined),_0x36463c[_0x97116e(0x13f)](base64url[_0x97116e(0x21a)]['decode'](_0x4a5bb3[_0x97116e(0x213)]),{'enc':_0x5d2eba['SyGcC']}),_0x36463c[_0x97116e(0x13f)](_0x4a5bb3[_0x97116e(0xef)][0x0][_0x97116e(0xe5)],{'alg':_0x97116e(0x149)});if(!_0x5d2eba[_0x97116e(0x111)](_0x97116e(0xf2),process['versions'])){_0x36463c['deepEqual'](_0x4a5bb3[_0x97116e(0xef)][0x1][_0x97116e(0xe5)],{'alg':_0x97116e(0x121)});const {epk:_0x2805b5,..._0x2785a2}=_0x4a5bb3[_0x97116e(0xef)][0x2]['header'];_0x36463c[_0x97116e(0x13f)](_0x2785a2,{'alg':_0x97116e(0x1bf)});}else{const {alg:_0x39d5ce,..._0x1328bd}=_0x4a5bb3[_0x97116e(0xef)][0x1][_0x97116e(0xe5)];_0x36463c['is'](_0x39d5ce,_0x5d2eba[_0x97116e(0x1d2)]),_0x36463c[_0x97116e(0x153)]('iv'in _0x1328bd),_0x36463c[_0x97116e(0x153)](_0x97116e(0x154)in _0x1328bd);}}),test(_0x3d7c61(0x127),_0x39d9f7=>{const _0x3f716b=_0x3d7c61,_0x46078e={'Kcrbn':_0x3f716b(0x1c1),'NtGbq':_0x3f716b(0x206),'CwfUC':_0x3f716b(0xea),'kZEhZ':_0x3f716b(0x200),'zyuEm':_0x3f716b(0x134),'etDCv':function(_0xe6ecd5,_0x17f6f8,_0x51a4c0,_0x57fb55){return _0xe6ecd5(_0x17f6f8,_0x51a4c0,_0x57fb55);},'QxMqO':_0x3f716b(0x128),'RkuMb':function(_0xc29522,_0x410382){return _0xc29522 in _0x410382;},'JajCb':_0x3f716b(0x1b0),'npZdg':_0x3f716b(0x149),'TyPek':'kid_1','nSDlv':'electron','LdmJT':function(_0x247788,_0x53ae45){return _0x247788!==_0x53ae45;},'Bacid':_0x3f716b(0x1c4),'NcRzu':_0x3f716b(0x12b),'FMGxm':_0x3f716b(0x154)},_0x2e737d=new JWE[(_0x3f716b(0x125))](_0x46078e['kZEhZ']),_0x43c71a=generateSync(_0x46078e['zyuEm'],undefined,{'kid':'kid_1'});_0x2e737d[_0x3f716b(0x132)](_0x43c71a,{'kid':_0x43c71a[_0x3f716b(0x18c)]});const _0x4fed12=_0x46078e[_0x3f716b(0x226)](generateSync,_0x3f716b(0x1c1),0x100,{'kid':_0x46078e[_0x3f716b(0x120)]});_0x2e737d[_0x3f716b(0x132)](_0x4fed12,{'kid':_0x4fed12[_0x3f716b(0x18c)]});if(!_0x46078e[_0x3f716b(0x1dc)](_0x3f716b(0xf2),process['versions'])){const _0x331ba2=generateSync('EC',undefined,{'kid':_0x46078e[_0x3f716b(0x17f)]});_0x2e737d[_0x3f716b(0x132)](_0x331ba2,{'kid':_0x331ba2['kid']});}const _0x4e543c=_0x2e737d[_0x3f716b(0x1e3)](_0x3f716b(0x10e));_0x39d9f7['is'](_0x4e543c[_0x3f716b(0x126)],undefined),_0x39d9f7[_0x3f716b(0x13f)](base64url['JSON'][_0x3f716b(0x112)](_0x4e543c[_0x3f716b(0x213)]),{'enc':_0x3f716b(0x1c8)}),_0x39d9f7[_0x3f716b(0x13f)](_0x4e543c[_0x3f716b(0xef)][0x0]['header'],{'alg':_0x46078e[_0x3f716b(0x15f)],'kid':_0x46078e[_0x3f716b(0x166)]});if(!(_0x46078e[_0x3f716b(0x208)]in process[_0x3f716b(0x212)])){_0x39d9f7['deepEqual'](_0x4e543c[_0x3f716b(0xef)][0x1][_0x3f716b(0xe5)],{'alg':'A256KW','kid':'kid_3'});const {epk:_0x3495a1,..._0x155f1d}=_0x4e543c['recipients'][0x2][_0x3f716b(0xe5)];_0x39d9f7['deepEqual'](_0x155f1d,{'alg':_0x3f716b(0x1bf),'kid':_0x46078e[_0x3f716b(0x17f)]});}else{if(_0x46078e['LdmJT'](_0x46078e['Bacid'],_0x46078e['NcRzu'])){const {alg:_0x308f81,kid:_0x44f926,..._0x44db48}=_0x4e543c[_0x3f716b(0xef)][0x1]['header'];_0x39d9f7['is'](_0x308f81,'A256GCMKW'),_0x39d9f7['is'](_0x44f926,_0x3f716b(0x128)),_0x39d9f7['true']('iv'in _0x44db48),_0x39d9f7[_0x3f716b(0x153)](_0x46078e[_0x3f716b(0x207)]in _0x44db48);}else{const _0x14b327=_0x466bd9(_0x46078e['Kcrbn'],_0x109dfd,{'alg':_0x3f716b(0x1c8)}),_0xa160f=_0x49784f[_0x3f716b(0x1e3)]['flattened'](_0x3f716b(0x200),_0x14b327,{'alg':_0x3f716b(0x1b9),'enc':_0x14b327[_0x3f716b(0x205)]});_0xa160f['iv']=_0x5be02d['encode'](_0xf45236[_0x3f716b(0x193)](_0xa160f['iv'])['slice'](0x1)),_0x14f94c[_0x3f716b(0x113)](()=>{const _0x35ed02=_0x3f716b;_0x8a7d2[_0x35ed02(0x19e)](_0xa160f,_0x14b327);},{'instanceOf':_0xb7a5af[_0x3f716b(0xf1)],'code':_0x46078e[_0x3f716b(0x1d3)],'message':_0x46078e[_0x3f716b(0x1bd)]});}}}),test(_0x3d7c61(0x1a7),_0x16f891=>{const _0x5a8273=_0x3d7c61,_0x359ecc={'vZZsu':function(_0x2b43eb,_0x5e67a4){return _0x2b43eb(_0x5e67a4);},'TmnDt':_0x5a8273(0x134)},_0xc37017=new JWE['Encrypt'](_0x5a8273(0x200));_0xc37017[_0x5a8273(0x132)](_0x359ecc['vZZsu'](generateSync,_0x359ecc['TmnDt']));const _0x45f6e6=_0xc37017[_0x5a8273(0x1e3)]('flattened');_0x16f891['is'](_0x45f6e6[_0x5a8273(0x126)],undefined),_0x16f891['is'](_0x45f6e6[_0x5a8273(0xe5)],undefined),_0x16f891[_0x5a8273(0x13f)](base64url['JSON']['decode'](_0x45f6e6[_0x5a8273(0x213)]),{'alg':_0x5a8273(0x149),'enc':'A128CBC-HS256'});}),test('JWE\x20no\x20alg/enc\x20specified\x20(single\x20rsa),\x20with\x20protected\x20header',_0x5e7248=>{const _0x38ff8f=_0x3d7c61,_0x185e54={'VVWkO':function(_0x2d66df,_0x24f967,_0x264fa8,_0x30cd0f){return _0x2d66df(_0x24f967,_0x264fa8,_0x30cd0f);},'lsvlV':_0x38ff8f(0x200),'Hxukd':_0x38ff8f(0x15c),'bZocH':_0x38ff8f(0x1c8)},_0x5dcb4d=_0x185e54['VVWkO'](generateSync,'RSA',undefined,{'kid':'jwk\x20key\x20id'}),_0x3e2658=new JWE['Encrypt'](_0x185e54['lsvlV'],{'kid':_0x5dcb4d['kid']});_0x3e2658[_0x38ff8f(0x132)](_0x5dcb4d);const _0x1291ca=_0x3e2658[_0x38ff8f(0x1e3)](_0x185e54['Hxukd']);_0x5e7248['is'](_0x1291ca[_0x38ff8f(0x126)],undefined),_0x5e7248['is'](_0x1291ca[_0x38ff8f(0xe5)],undefined),_0x5e7248[_0x38ff8f(0x13f)](base64url[_0x38ff8f(0x21a)][_0x38ff8f(0x112)](_0x1291ca[_0x38ff8f(0x213)]),{'alg':_0x38ff8f(0x149),'enc':_0x185e54[_0x38ff8f(0x12d)],'kid':_0x38ff8f(0x183)});}),test('JWE\x20no\x20alg\x20specified\x20(single\x20rsa),\x20with\x20protected\x20header',_0xd082b9=>{const _0x146172=_0x3d7c61,_0x56c49f={'FDZze':function(_0x4745c9,_0x41a4ef){return _0x4745c9(_0x41a4ef);},'ChZHN':_0x146172(0x200),'OjhDo':_0x146172(0xe7),'TpHas':_0x146172(0x149)},_0x50ef97=_0x56c49f[_0x146172(0x14b)](generateSync,_0x146172(0x134)),_0x23eb50=new JWE[(_0x146172(0x125))](_0x56c49f[_0x146172(0x15a)],{'enc':_0x56c49f['OjhDo']});_0x23eb50['recipient'](_0x50ef97);const _0x3155e2=_0x23eb50[_0x146172(0x1e3)](_0x146172(0x15c));_0xd082b9['is'](_0x3155e2[_0x146172(0x126)],undefined),_0xd082b9['is'](_0x3155e2[_0x146172(0xe5)],undefined),_0xd082b9[_0x146172(0x13f)](base64url[_0x146172(0x21a)][_0x146172(0x112)](_0x3155e2[_0x146172(0x213)]),{'alg':_0x56c49f[_0x146172(0x17d)],'enc':_0x56c49f[_0x146172(0x100)]});}),test(_0x3d7c61(0x173),_0x2563ee=>{const _0x1cdc85=_0x3d7c61,_0x35abf7={'WogWS':function(_0x53039a,_0x36ae52){return _0x53039a(_0x36ae52);},'lmzFN':'RSA','qKiXy':_0x1cdc85(0xe7),'RrzOH':_0x1cdc85(0x15c),'wmiAB':_0x1cdc85(0x149)},_0x148dfd=_0x35abf7['WogWS'](generateSync,_0x35abf7[_0x1cdc85(0x21c)]),_0x33573a=new JWE[(_0x1cdc85(0x125))](_0x1cdc85(0x200),undefined,undefined,{'enc':_0x35abf7['qKiXy']});_0x33573a['recipient'](_0x148dfd);const _0x9a0e74=_0x33573a[_0x1cdc85(0x1e3)](_0x35abf7[_0x1cdc85(0x141)]);_0x2563ee['deepEqual'](_0x9a0e74[_0x1cdc85(0x126)],{'enc':_0x1cdc85(0xe7)}),_0x2563ee['is'](_0x9a0e74['header'],undefined),_0x2563ee['deepEqual'](base64url['JSON'][_0x1cdc85(0x112)](_0x9a0e74[_0x1cdc85(0x213)]),{'alg':_0x35abf7[_0x1cdc85(0x1f8)]});}),test(_0x3d7c61(0x186),_0x334ef4=>{const _0x408bc2=_0x3d7c61,_0x380a6c={'WffVu':function(_0x3e3065,_0x57f9ca){return _0x3e3065(_0x57f9ca);},'ZYkYp':'RSA','nVYix':_0x408bc2(0xe7),'tPEwb':'flattened','pfkKC':_0x408bc2(0x149),'PNflo':function(_0x53eb6a,_0x19f4a5,_0x33ed50){return _0x53eb6a(_0x19f4a5,_0x33ed50);},'UxkNh':_0x408bc2(0x1c1),'oNmui':function(_0x5697a2,_0xbe82ed){return _0x5697a2 in _0xbe82ed;},'msSnu':_0x408bc2(0xf2),'stmhz':_0x408bc2(0x1a2),'sytDh':_0x408bc2(0x1c8),'lksmx':_0x408bc2(0xfd),'BPBkO':_0x408bc2(0x1d6),'obByi':_0x408bc2(0x180)},_0x1ff90b=new JWE[(_0x408bc2(0x125))](_0x408bc2(0x200));_0x1ff90b[_0x408bc2(0x132)](_0x380a6c[_0x408bc2(0x20b)](generateSync,_0x380a6c[_0x408bc2(0x1a5)],0x80));const _0x4cf2c1=_0x1ff90b['encrypt'](_0x380a6c[_0x408bc2(0x1f3)]);_0x334ef4['is'](_0x4cf2c1[_0x408bc2(0x126)],undefined),_0x334ef4['is'](_0x4cf2c1[_0x408bc2(0xe5)],undefined);if(!_0x380a6c[_0x408bc2(0xf6)](_0x380a6c[_0x408bc2(0x214)],process['versions']))_0x380a6c[_0x408bc2(0x1f0)]!==_0x408bc2(0x1a2)?_0xc84426[_0x408bc2(0x1e3)](_0x2e75ae):_0x334ef4[_0x408bc2(0x13f)](base64url[_0x408bc2(0x21a)][_0x408bc2(0x112)](_0x4cf2c1[_0x408bc2(0x213)]),{'alg':_0x408bc2(0x18a),'enc':_0x380a6c[_0x408bc2(0x12f)]});else{if(_0x380a6c[_0x408bc2(0x1a3)]===_0x380a6c[_0x408bc2(0xec)]){const _0x3b1e84=_0x380a6c[_0x408bc2(0x197)](_0xb9e5a,_0x380a6c['ZYkYp']),_0x4c30b3=new _0x18c565[(_0x408bc2(0x125))](_0x408bc2(0x200),{'enc':_0x380a6c['nVYix']});_0x4c30b3[_0x408bc2(0x132)](_0x3b1e84);const _0x229380=_0x4c30b3[_0x408bc2(0x1e3)](_0x380a6c[_0x408bc2(0x1f3)]);_0x56f37a['is'](_0x229380[_0x408bc2(0x126)],_0x136b7b),_0x1d323b['is'](_0x229380[_0x408bc2(0xe5)],_0x109d6a),_0xca1c79[_0x408bc2(0x13f)](_0x4aa296['JSON'][_0x408bc2(0x112)](_0x229380[_0x408bc2(0x213)]),{'alg':_0x380a6c['pfkKC'],'enc':'A256CBC-HS512'});}else{const {iv:_0x172ec0,tag:_0x439825,..._0x3fdd3a}=base64url[_0x408bc2(0x21a)][_0x408bc2(0x112)](_0x4cf2c1[_0x408bc2(0x213)]);_0x334ef4['deepEqual'](_0x3fdd3a,{'alg':_0x380a6c[_0x408bc2(0xe3)],'enc':_0x380a6c['sytDh']}),_0x334ef4['truthy'](_0x172ec0),_0x334ef4['truthy'](_0x439825);}}}),test('JWE\x20no\x20alg/enc\x20specified\x20(single\x20ec)',_0x18b692=>{const _0x4436c5=_0x3d7c61,_0x17f15b={'kRqCY':function(_0x30f05d,_0x2c1c22){return _0x30f05d(_0x2c1c22);},'svVZj':_0x4436c5(0x10b)},_0x6fb48f=new JWE['Encrypt'](_0x4436c5(0x200));_0x6fb48f[_0x4436c5(0x132)](_0x17f15b[_0x4436c5(0x16d)](generateSync,'EC'));const _0x29343c=_0x6fb48f[_0x4436c5(0x1e3)]('flattened');_0x18b692['is'](_0x29343c[_0x4436c5(0x126)],undefined),_0x18b692['is'](_0x29343c['header'],undefined);const {epk:_0x2d1ac6,..._0x2a4f0a}=base64url[_0x4436c5(0x21a)][_0x4436c5(0x112)](_0x29343c[_0x4436c5(0x213)]);_0x18b692[_0x4436c5(0x13f)](_0x2a4f0a,{'alg':_0x17f15b[_0x4436c5(0x163)],'enc':_0x4436c5(0x1c8)});}),test(_0x3d7c61(0x1d9),_0x2fd39c=>{const _0x509c66=_0x3d7c61,_0x3092aa={'ziGKK':_0x509c66(0x200),'zrBjN':function(_0x422ae8,_0x2584e6,_0x261d7d,_0x33dcb7){return _0x422ae8(_0x2584e6,_0x261d7d,_0x33dcb7);},'ukJAk':_0x509c66(0x176)},_0x4ba7b3=new JWE[(_0x509c66(0x125))](_0x3092aa[_0x509c66(0x1ca)]);_0x4ba7b3[_0x509c66(0x132)](_0x3092aa[_0x509c66(0x174)](generateSync,_0x509c66(0x134),undefined,{'alg':_0x3092aa[_0x509c66(0x195)],'use':_0x509c66(0xf3)}));const _0x43f238=_0x4ba7b3[_0x509c66(0x1e3)](_0x509c66(0x15c));_0x2fd39c['is'](_0x43f238[_0x509c66(0x126)],undefined),_0x2fd39c['is'](_0x43f238['header'],undefined),_0x2fd39c['deepEqual'](base64url[_0x509c66(0x21a)][_0x509c66(0x112)](_0x43f238[_0x509c66(0x213)]),{'alg':_0x3092aa[_0x509c66(0x195)],'enc':_0x509c66(0x1c8)});}),test('aes_cbc_hmac_sha2\x20decrypt\x20iv\x20check\x20(missing)',_0x230a35=>{const _0x336e78=_0x3d7c61,_0x225d48={'FhFtH':function(_0x2efa73,_0x40b042,_0x10bcc3,_0x15dd00){return _0x2efa73(_0x40b042,_0x10bcc3,_0x15dd00);},'lFnwE':_0x336e78(0x1c1),'XdDlN':'ERR_JWE_INVALID','hhZUz':_0x336e78(0x109)},_0x33e729=_0x225d48['FhFtH'](generateSync,_0x225d48[_0x336e78(0x1b7)],undefined,{'alg':_0x336e78(0x1c8)}),_0x24a250=JWE[_0x336e78(0x1e3)][_0x336e78(0x15c)](_0x336e78(0x200),_0x33e729,{'alg':_0x336e78(0x1b9),'enc':_0x33e729[_0x336e78(0x205)]});delete _0x24a250['iv'],_0x230a35[_0x336e78(0x113)](()=>{const _0x361f5d=_0x336e78;JWE[_0x361f5d(0x19e)](_0x24a250,_0x33e729);},{'instanceOf':errors['JWEInvalid'],'code':_0x225d48[_0x336e78(0x14d)],'message':_0x225d48[_0x336e78(0x1c3)]});}),test(_0x3d7c61(0xee),_0x2a2846=>{const _0x1b167b=_0x3d7c61,_0x4c398e={'FdQie':function(_0x1c0a15,_0x532740){return _0x1c0a15(_0x532740);},'nFCew':_0x1b167b(0x1c1),'sHNTr':function(_0x1b49bd,_0x2bdff1){return _0x1b49bd!==_0x2bdff1;},'AHUkc':_0x1b167b(0xf4),'gseKX':_0x1b167b(0x1c8),'xIPTm':_0x1b167b(0x1b9),'ULcGT':_0x1b167b(0x206)},_0xc76eb3=generateSync(_0x1b167b(0x1c1),undefined,{'alg':_0x4c398e['gseKX']}),_0x3006ec=JWE[_0x1b167b(0x1e3)][_0x1b167b(0x15c)](_0x1b167b(0x200),_0xc76eb3,{'alg':_0x4c398e['xIPTm'],'enc':_0xc76eb3[_0x1b167b(0x205)]});_0x3006ec['iv']=base64url['encode'](base64url[_0x1b167b(0x193)](_0x3006ec['iv'])[_0x1b167b(0x223)](0x1)),_0x2a2846['throws'](()=>{const _0x35e2ac=_0x1b167b;_0x4c398e[_0x35e2ac(0x1a8)](_0x4c398e[_0x35e2ac(0x1ce)],_0x4c398e[_0x35e2ac(0x1ce)])?_0x4d9efd[_0x35e2ac(0x19e)]('',_0x4c398e[_0x35e2ac(0x1e4)](_0x38ab03,_0x4c398e[_0x35e2ac(0x1d4)])):JWE[_0x35e2ac(0x19e)](_0x3006ec,_0xc76eb3);},{'instanceOf':errors['JWEInvalid'],'code':_0x4c398e['ULcGT'],'message':_0x1b167b(0xea)});}),test(_0x3d7c61(0x1e7),_0x1e5f21=>{const _0x5c04fd=_0x3d7c61,_0x3d6205={'xLEYM':function(_0x22209d,_0x47aa23,_0x2156a3,_0x275c24){return _0x22209d(_0x47aa23,_0x2156a3,_0x275c24);},'ewowB':'oct','tsADr':_0x5c04fd(0x1b9),'kvuyz':_0x5c04fd(0x109)},_0x4231f5=_0x3d6205[_0x5c04fd(0x107)](generateSync,_0x3d6205[_0x5c04fd(0x129)],undefined,{'alg':_0x5c04fd(0x1c8)}),_0x1be560=JWE[_0x5c04fd(0x1e3)][_0x5c04fd(0x15c)](_0x5c04fd(0x200),_0x4231f5,{'alg':_0x3d6205[_0x5c04fd(0x1b1)],'enc':_0x4231f5[_0x5c04fd(0x205)]});delete _0x1be560['tag'],_0x1e5f21[_0x5c04fd(0x113)](()=>{const _0x1b97f0=_0x5c04fd;JWE[_0x1b97f0(0x19e)](_0x1be560,_0x4231f5);},{'instanceOf':errors[_0x5c04fd(0xf1)],'code':_0x5c04fd(0x206),'message':_0x3d6205[_0x5c04fd(0x201)]});}),test('aes_cbc_hmac_sha2\x20decrypt\x20tag\x20check\x20(invalid\x20length)',_0x500e66=>{const _0x50a605=_0x3d7c61,_0x2672ba={'dVuSx':_0x50a605(0x1c1),'mzHAT':_0x50a605(0x1b9),'fOKzy':'ERR_JWE_INVALID'},_0x38d1ad=generateSync(_0x2672ba[_0x50a605(0xe6)],undefined,{'alg':_0x50a605(0x1c8)}),_0x4bcec5=JWE['encrypt'][_0x50a605(0x15c)]('foo',_0x38d1ad,{'alg':_0x2672ba[_0x50a605(0x1e5)],'enc':_0x38d1ad[_0x50a605(0x205)]});_0x4bcec5[_0x50a605(0x154)]=base64url[_0x50a605(0x139)](base64url['decodeToBuffer'](_0x4bcec5[_0x50a605(0x154)])['slice'](0x1)),_0x500e66[_0x50a605(0x113)](()=>{const _0x485acb=_0x50a605;JWE[_0x485acb(0x19e)](_0x4bcec5,_0x38d1ad);},{'instanceOf':errors[_0x50a605(0xf1)],'code':_0x2672ba['fOKzy'],'message':_0x50a605(0x1b4)});}),test('aes_gcm\x20decrypt\x20iv\x20check\x20(missing)',_0x561d04=>{const _0x36890a=_0x3d7c61,_0x5419ed={'HjALm':'oct','fmlgB':_0x36890a(0x145),'YTdNp':_0x36890a(0x1b9)},_0x560085=generateSync(_0x5419ed[_0x36890a(0x21f)],0x80,{'alg':_0x5419ed[_0x36890a(0x140)]}),_0x88cf81=JWE[_0x36890a(0x1e3)][_0x36890a(0x15c)](_0x36890a(0x200),_0x560085,{'alg':_0x5419ed[_0x36890a(0x18e)],'enc':_0x560085[_0x36890a(0x205)]});delete _0x88cf81['iv'],_0x561d04[_0x36890a(0x113)](()=>{JWE['decrypt'](_0x88cf81,_0x560085);},{'instanceOf':errors[_0x36890a(0xf1)],'code':_0x36890a(0x206),'message':_0x36890a(0x109)});}),test(_0x3d7c61(0x17b),_0x28fb2f=>{const _0x145b4f=_0x3d7c61,_0x292628={'sxroa':function(_0x21628d,_0x17db28){return _0x21628d===_0x17db28;},'hAKOU':'mSZPN','vYORH':_0x145b4f(0x1c1),'cPcFA':_0x145b4f(0x200),'dvwAT':'dir','KjWfz':'ERR_JWE_INVALID'},_0x491861=generateSync(_0x292628['vYORH'],0x80,{'alg':'A128GCM'}),_0x4f98ee=JWE[_0x145b4f(0x1e3)]['flattened'](_0x292628[_0x145b4f(0x222)],_0x491861,{'alg':_0x292628['dvwAT'],'enc':_0x491861['alg']});_0x4f98ee['iv']=base64url[_0x145b4f(0x139)](base64url[_0x145b4f(0x193)](_0x4f98ee['iv'])[_0x145b4f(0x223)](0x1)),_0x28fb2f[_0x145b4f(0x113)](()=>{const _0x3c3af5=_0x145b4f;_0x292628[_0x3c3af5(0x116)](_0x3c3af5(0x161),_0x292628[_0x3c3af5(0x228)])?JWE[_0x3c3af5(0x19e)](_0x4f98ee,_0x491861):_0x3d93bb['is'](_0x29279c[_0x3c3af5(0x1f2)],_0x4d9910['JOSEAlgNotWhitelisted']);},{'instanceOf':errors[_0x145b4f(0xf1)],'code':_0x292628[_0x145b4f(0x16c)],'message':_0x145b4f(0xea)});}),test(_0x3d7c61(0x1fb),_0x4e16ea=>{const _0x466ebd=_0x3d7c61,_0x445df3={'aqpQX':_0x466ebd(0x145),'EExGe':_0x466ebd(0x1b9)},_0x59d037=generateSync(_0x466ebd(0x1c1),0x80,{'alg':_0x445df3[_0x466ebd(0x179)]}),_0x5d26b3=JWE[_0x466ebd(0x1e3)]['flattened'](_0x466ebd(0x200),_0x59d037,{'alg':_0x445df3[_0x466ebd(0x117)],'enc':_0x59d037['alg']});delete _0x5d26b3['tag'],_0x4e16ea[_0x466ebd(0x113)](()=>{const _0x5e3ea0=_0x466ebd;JWE[_0x5e3ea0(0x19e)](_0x5d26b3,_0x59d037);},{'instanceOf':errors[_0x466ebd(0xf1)],'code':_0x466ebd(0x206),'message':_0x466ebd(0x109)});}),test('aes_gcm\x20decrypt\x20tag\x20check\x20(invalid\x20length)',_0x33dc9b=>{const _0x26512f=_0x3d7c61,_0x26a096={'ITQel':function(_0xeae9a8,_0x5f1905,_0x4846f7,_0x417728){return _0xeae9a8(_0x5f1905,_0x4846f7,_0x417728);},'SqCNC':_0x26512f(0x1b9)},_0x23d70a=_0x26a096[_0x26512f(0x216)](generateSync,_0x26512f(0x1c1),0x80,{'alg':'A128GCM'}),_0x31cfb3=JWE[_0x26512f(0x1e3)]['flattened']('foo',_0x23d70a,{'alg':_0x26a096['SqCNC'],'enc':_0x23d70a['alg']});_0x31cfb3['tag']=base64url[_0x26512f(0x139)](base64url['decodeToBuffer'](_0x31cfb3[_0x26512f(0x154)])['slice'](0x1)),_0x33dc9b[_0x26512f(0x113)](()=>{const _0x2daf5d=_0x26512f;JWE[_0x2daf5d(0x19e)](_0x31cfb3,_0x23d70a);},{'instanceOf':errors[_0x26512f(0xf1)],'code':_0x26512f(0x206),'message':_0x26512f(0x1b4)});}),test(_0x3d7c61(0x1ba),_0x2106bc=>{const _0x5044a3=_0x3d7c61,_0x2fe8fe={'wNfAo':_0x5044a3(0x1c1)},_0x12e302=generateSync(_0x2fe8fe['wNfAo']);JWE['encrypt'](Buffer[_0x5044a3(0x19f)]('foo'),_0x12e302),_0x2106bc[_0x5044a3(0x123)]();}),test(_0x3d7c61(0x178),_0x5e89aa=>{const _0x492799=_0x3d7c61,_0x401a2b=generateSync(_0x492799(0x1c1));JWE[_0x492799(0x1e3)]('foo',_0x401a2b),_0x5e89aa[_0x492799(0x123)]();}),test(_0x3d7c61(0xe9),_0x47c401=>{const _0x24de92=_0x3d7c61,_0x3ad0b1={'eYimN':function(_0x38868a,_0x407e98){return _0x38868a(_0x407e98);}},_0x5e43e1=_0x3ad0b1['eYimN'](generateSync,_0x24de92(0x1c1));[[],{},![],!![],undefined,null,Infinity,0x0][_0x24de92(0x196)](_0x3f5f9e=>{const _0x423817=_0x24de92;_0x47c401['throws'](()=>{const _0x418c7a=_0x366e;JWE[_0x418c7a(0x1e3)](_0x3f5f9e,_0x5e43e1);},{'instanceOf':TypeError,'message':_0x423817(0x104)});});}),test(_0x3d7c61(0x13e),_0x4bed49=>{const _0x1b7e88=_0x3d7c61,_0x27246e={'rGMUa':_0x1b7e88(0x200),'ZERFV':function(_0x28f9a6,_0x586757){return _0x28f9a6(_0x586757);},'pdvho':_0x1b7e88(0x1c1)},_0x2efc55=_0x27246e['ZERFV'](generateSync,_0x27246e[_0x1b7e88(0x1ab)]);[[],![],!![],null,Infinity,0x0,Buffer[_0x1b7e88(0x19f)](_0x1b7e88(0x200))][_0x1b7e88(0x196)](_0x1db9a3=>{const _0x4a5c5d=_0x1b7e88;_0x4bed49[_0x4a5c5d(0x113)](()=>{const _0x12569c=_0x4a5c5d;JWE['encrypt'](_0x27246e[_0x12569c(0x17e)],_0x2efc55,_0x1db9a3);},{'instanceOf':TypeError,'message':'protectedHeader\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided'});});}),test(_0x3d7c61(0x162),_0x3bbcbe=>{const _0x35ce9a=_0x3d7c61,_0x1b43c8={'gfxTG':_0x35ce9a(0x200)};;[[],![],!![],null,Infinity,0x0,Buffer[_0x35ce9a(0x19f)](_0x1b43c8[_0x35ce9a(0x1b3)])][_0x35ce9a(0x196)](_0x373ddf=>{const _0x42df83=_0x35ce9a;_0x3bbcbe[_0x42df83(0x113)](()=>{const _0x195f08=_0x42df83;new JWE['Encrypt'](_0x195f08(0x200),undefined,undefined,_0x373ddf);},{'instanceOf':TypeError,'message':'unprotectedHeader\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided'});});}),test(_0x3d7c61(0x1d8),_0x36ca84=>{const _0x52fdfc=_0x3d7c61,_0xb25af9={'QTuum':_0x52fdfc(0x14f),'tNiXG':_0x52fdfc(0x200)},_0x2c53c8=generateSync(_0x52fdfc(0x1c1)),_0x44fb81=new JWE[(_0x52fdfc(0x125))]('foo');[[],![],!![],null,Infinity,0x0,Buffer[_0x52fdfc(0x19f)](_0xb25af9[_0x52fdfc(0xf7)])]['forEach'](_0x5900f4=>{const _0xc56240=_0x52fdfc;_0x36ca84[_0xc56240(0x113)](()=>{const _0x43e5f3=_0xc56240;_0x44fb81[_0x43e5f3(0x132)](_0x2c53c8,_0x5900f4);},{'instanceOf':TypeError,'message':_0xb25af9[_0xc56240(0x188)]});});}),test(_0x3d7c61(0x148),_0x2edb88=>{;[[],![],!![],null,Infinity,0x0]['forEach'](_0x8f64b7=>{const _0x5f4bea=_0x366e;_0x2edb88[_0x5f4bea(0x113)](()=>{const _0x1a2908=_0x5f4bea;new JWE['Encrypt'](_0x1a2908(0x200),undefined,_0x8f64b7);},{'instanceOf':TypeError,'message':_0x5f4bea(0x1ee)});});}),test('JWE\x20must\x20have\x20recipients',_0x2d06ad=>{const _0x15d1ff=_0x3d7c61,_0x7a13b7={'qfOcu':'bar','DjLyN':function(_0x4b1b8c,_0x592983){return _0x4b1b8c(_0x592983);},'QTIUi':function(_0x48f2fd,_0x395dab){return _0x48f2fd===_0x395dab;},'qwvSS':_0x15d1ff(0x218),'sQDCd':_0x15d1ff(0x200)},_0x17ce82=new JWE[(_0x15d1ff(0x125))](_0x7a13b7[_0x15d1ff(0x1b2)]);_0x2d06ad[_0x15d1ff(0x113)](()=>{const _0x43329b=_0x15d1ff,_0x4edca4={'IMNHx':_0x43329b(0x200),'gmZHu':_0x7a13b7[_0x43329b(0xf9)],'yUYSd':function(_0x47837f,_0x29432b){const _0x239dbd=_0x43329b;return _0x7a13b7[_0x239dbd(0x155)](_0x47837f,_0x29432b);},'MUwWM':'oct'};_0x7a13b7[_0x43329b(0x16e)](_0x43329b(0x198),'cvzWP')?_0x1e78d7[_0x43329b(0x19e)]({'header':{'alg':'HS256'},'payload':_0x4edca4[_0x43329b(0x19a)],'ciphertext':_0x4edca4[_0x43329b(0x1d7)]},_0x4edca4[_0x43329b(0x101)](_0x336efa,_0x4edca4[_0x43329b(0x1c9)]),{'contentEncryptionAlgorithms':[_0x2b5108]}):_0x17ce82['encrypt'](_0x7a13b7[_0x43329b(0x13d)]);},{'instanceOf':errors['JWEInvalid'],'code':_0x15d1ff(0x206),'message':_0x15d1ff(0x169)});}),test('JWE\x20valid\x20serialization\x20must\x20be\x20provided',_0x312555=>{const _0x80471a=_0x3d7c61,_0x506921={'KidjS':_0x80471a(0x200),'jFxPo':_0x80471a(0x147)};;[[],![],!![],null,Infinity,0x0,_0x80471a(0x200),''][_0x80471a(0x196)](_0x5f9ab0=>{const _0x2ee012=_0x80471a,_0x4ca130=new JWE[(_0x2ee012(0x125))](_0x506921['KidjS']);_0x312555[_0x2ee012(0x113)](()=>{_0x4ca130['encrypt'](_0x5f9ab0);},{'instanceOf':TypeError,'message':_0x506921[_0x2ee012(0x215)]});});}),test('JWE\x20compact\x20does\x20not\x20support\x20multiple\x20recipients',_0x3a3a34=>{const _0x564a55=_0x3d7c61,_0x5de663={'Mrxkn':'compact','FCVxK':function(_0x272c32,_0x41c78f){return _0x272c32(_0x41c78f);},'ViAcq':_0x564a55(0x1c1),'YYPiw':_0x564a55(0x200),'ZCcoE':_0x564a55(0x21e)},_0x44ed71=_0x5de663['FCVxK'](generateSync,_0x5de663[_0x564a55(0xff)]),_0x227c83=generateSync('EC'),_0x10f17a=new JWE[(_0x564a55(0x125))](_0x5de663[_0x564a55(0x118)]);_0x10f17a[_0x564a55(0x132)](_0x44ed71),_0x10f17a[_0x564a55(0x132)](_0x227c83),_0x3a3a34[_0x564a55(0x113)](()=>{const _0x49ca43=_0x564a55;_0x10f17a[_0x49ca43(0x1e3)](_0x5de663[_0x49ca43(0x11a)]);},{'instanceOf':errors[_0x564a55(0xf1)],'code':_0x564a55(0x206),'message':_0x5de663[_0x564a55(0x1ec)]});}),test(_0x3d7c61(0x1f1),_0x9c7f91=>{const _0x5c5934=_0x3d7c61,_0x534470={'ITahl':_0x5c5934(0x206)},_0x3a4dbd=generateSync(_0x5c5934(0x1c1));_0x9c7f91[_0x5c5934(0x113)](()=>{const _0x1c61f5=_0x5c5934;JWE[_0x1c61f5(0x1e3)]('foo',_0x3a4dbd,undefined,undefined,{'foo':0x1});},{'instanceOf':errors['JWEInvalid'],'code':_0x534470['ITahl'],'message':_0x5c5934(0x21e)});}),test(_0x3d7c61(0x164),_0x19bafc=>{const _0x325757=_0x3d7c61,_0x47a2fd={'sTmhN':function(_0x156dd7,_0x2096a3){return _0x156dd7(_0x2096a3);},'fmPow':_0x325757(0x206)},_0x3cbc87=_0x47a2fd[_0x325757(0x1b8)](generateSync,_0x325757(0x1c1));_0x19bafc[_0x325757(0x113)](()=>{const _0x4a9014=_0x325757;JWE[_0x4a9014(0x1e3)](_0x4a9014(0x200),_0x3cbc87,undefined,_0x4a9014(0x157));},{'instanceOf':errors[_0x325757(0xf1)],'code':_0x47a2fd[_0x325757(0x160)],'message':_0x325757(0x21e)});}),test('JWE\x20flattened\x20does\x20not\x20support\x20multiple\x20recipients',_0x562bb5=>{const _0x4a0ed3=_0x3d7c61,_0x542bd4={'BthXW':_0x4a0ed3(0x15c),'XYiuF':function(_0x255f7b,_0x45b298){return _0x255f7b(_0x45b298);},'XFGVc':function(_0x27fa55,_0x2f1949){return _0x27fa55(_0x2f1949);},'XvfQL':'foo','XveXL':_0x4a0ed3(0x206)},_0x304605=_0x542bd4[_0x4a0ed3(0x143)](generateSync,_0x4a0ed3(0x1c1)),_0x1ee59c=_0x542bd4['XFGVc'](generateSync,'EC'),_0x54ba93=new JWE['Encrypt'](_0x542bd4[_0x4a0ed3(0x1ac)]);_0x54ba93[_0x4a0ed3(0x132)](_0x304605),_0x54ba93[_0x4a0ed3(0x132)](_0x1ee59c),_0x562bb5[_0x4a0ed3(0x113)](()=>{const _0x3a9bd8=_0x4a0ed3;_0x54ba93[_0x3a9bd8(0x1e3)](_0x542bd4[_0x3a9bd8(0x159)]);},{'instanceOf':errors[_0x4a0ed3(0xf1)],'code':_0x542bd4[_0x4a0ed3(0x22b)],'message':'Flattened\x20JWE\x20JSON\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients'});}),test(_0x3d7c61(0x217),_0x16a052=>{const _0x290093=_0x3d7c61,_0xfeb521={'hoetC':_0x290093(0x10e),'eRrfO':_0x290093(0x1c1),'aGhaF':function(_0x3edc36,_0x1bf6c5){return _0x3edc36(_0x1bf6c5);},'ZQMyZ':_0x290093(0x134),'LoOqZ':_0x290093(0x200),'ZjGbJ':_0x290093(0x1c8),'ESIFT':_0x290093(0x206),'GtvDB':_0x290093(0x105)},_0xb16e1c=generateSync(_0xfeb521[_0x290093(0x1c0)]),_0x4e9474=_0xfeb521['aGhaF'](generateSync,_0xfeb521[_0x290093(0x1cb)]),_0x412f20=new JWE[(_0x290093(0x125))](_0xfeb521[_0x290093(0x20c)]);_0x412f20[_0x290093(0x132)](_0xb16e1c,{'enc':_0xfeb521[_0x290093(0x1dd)]}),_0x412f20[_0x290093(0x132)](_0x4e9474,{'enc':'A128GCM'}),_0x16a052['throws'](()=>{const _0x200bf5=_0x290093;_0x412f20[_0x200bf5(0x1e3)](_0xfeb521['hoetC']);},{'instanceOf':errors['JWEInvalid'],'code':_0xfeb521[_0x290093(0x151)],'message':_0xfeb521[_0x290093(0x18b)]});}),test(_0x3d7c61(0xe1),_0x2ccbe7=>{const _0x9b958f=_0x3d7c61,_0x420398={'Laypy':function(_0x41163c,_0x78ec94){return _0x41163c(_0x78ec94);},'tkIur':_0x9b958f(0x134),'IWcHB':_0x9b958f(0x200),'OmBrC':_0x9b958f(0x10e),'oviJZ':_0x9b958f(0x206),'WRUyo':_0x9b958f(0x105)},_0x5de97a=_0x420398[_0x9b958f(0x170)](generateSync,_0x9b958f(0x1c1)),_0x4c506d=generateSync(_0x420398['tkIur']),_0x1d2391=new JWE[(_0x9b958f(0x125))](_0x420398[_0x9b958f(0x1fe)]);_0x1d2391[_0x9b958f(0x132)](_0x5de97a,{'enc':_0x9b958f(0x145)}),_0x1d2391['recipient'](_0x4c506d,{'enc':_0x9b958f(0x145)});const _0x542084=_0x1d2391[_0x9b958f(0x1e3)](_0x420398[_0x9b958f(0x190)]);_0x2ccbe7[_0x9b958f(0x113)](()=>{const _0xda0c65=_0x9b958f;_0x542084[_0xda0c65(0xef)][0x0][_0xda0c65(0xe5)]['enc']=_0xda0c65(0x1c8),JWE[_0xda0c65(0x19e)](_0x542084,_0x5de97a);},{'instanceOf':errors[_0x9b958f(0xf1)],'code':_0x420398[_0x9b958f(0x167)],'message':_0x420398[_0x9b958f(0x16b)]});}),test(_0x3d7c61(0x102),_0x1fd293=>{const _0x3f5223=_0x3d7c61,_0x41f95b={'xCLlk':'oct','LbvrF':'RSA','YqoSR':_0x3f5223(0x200),'ehSmw':_0x3f5223(0x145),'tPKAb':_0x3f5223(0x10e),'CnNGk':_0x3f5223(0x114)},_0xb8f3bd=generateSync(_0x41f95b[_0x3f5223(0x16f)]),_0x568994=generateSync(_0x41f95b[_0x3f5223(0x1b5)]),_0x46d9fc=new JWE['Encrypt'](_0x41f95b[_0x3f5223(0xfe)]);_0x46d9fc[_0x3f5223(0x132)](_0xb8f3bd,{'enc':_0x41f95b[_0x3f5223(0x11b)]}),_0x46d9fc[_0x3f5223(0x132)](_0x568994,{'enc':_0x3f5223(0x145)});const _0xb7d97c=_0x46d9fc['encrypt'](_0x41f95b[_0x3f5223(0x187)]);_0x1fd293['throws'](()=>{const _0x2ac9af=_0x3f5223;delete _0xb7d97c[_0x2ac9af(0xef)][0x0]['header'][_0x2ac9af(0xf3)],delete _0xb7d97c[_0x2ac9af(0xef)][0x1][_0x2ac9af(0xe5)]['enc'],JWE['decrypt'](_0xb7d97c,_0xb8f3bd);},{'instanceOf':errors['JWEInvalid'],'code':_0x3f5223(0x206),'message':_0x41f95b[_0x3f5223(0x181)]});}),test(_0x3d7c61(0x135),_0x1c907d=>{const _0x226d13=_0x3d7c61,_0x4396f6={'qVKVL':function(_0x34d061,_0x48fa3a,_0x1ac337,_0x3629c9){return _0x34d061(_0x48fa3a,_0x1ac337,_0x3629c9);},'UsFIy':'A128CBC-HS256','CFAWp':_0x226d13(0xf3),'eJJjY':function(_0x5b1fc3,_0x253a3c){return _0x5b1fc3(_0x253a3c);},'qFDgS':_0x226d13(0x134),'FhvsW':_0x226d13(0x200)},_0x460119=_0x4396f6['qVKVL'](generateSync,_0x226d13(0x1c1),undefined,{'alg':_0x4396f6[_0x226d13(0x11f)],'use':_0x4396f6[_0x226d13(0x165)]}),_0x5d989e=_0x4396f6[_0x226d13(0x192)](generateSync,_0x4396f6['qFDgS']),_0x5e8301=new JWE['Encrypt'](_0x4396f6[_0x226d13(0x1e1)]);_0x5e8301[_0x226d13(0x132)](_0x460119,{'alg':_0x226d13(0x1b9)}),_0x5e8301['recipient'](_0x5d989e),_0x1c907d['throws'](()=>{const _0x2c1851=_0x226d13;_0x5e8301[_0x2c1851(0x1e3)](_0x2c1851(0x10e));},{'instanceOf':errors[_0x226d13(0xf1)],'code':_0x226d13(0x206),'message':_0x226d13(0x156)});}),test(_0x3d7c61(0x13c),_0x528b41=>{const _0x1d8a29=_0x3d7c61,_0x42f132={'RDIuG':function(_0x33668f,_0x9ea1cb,_0x5ca195,_0x59f2ba){return _0x33668f(_0x9ea1cb,_0x5ca195,_0x59f2ba);},'IGVmk':_0x1d8a29(0x10b),'rSxBe':_0x1d8a29(0x200),'ogCad':'dir\x20and\x20ECDH-ES\x20alg\x20may\x20only\x20be\x20used\x20with\x20a\x20single\x20recipient'},_0x42d4de=_0x42f132[_0x1d8a29(0x1c7)](generateSync,'EC',undefined,{'alg':_0x42f132[_0x1d8a29(0x1eb)],'use':_0x1d8a29(0xf3)}),_0x4541ff=generateSync(_0x1d8a29(0x134)),_0x423f55=new JWE[(_0x1d8a29(0x125))](_0x42f132[_0x1d8a29(0x1e0)]);_0x423f55[_0x1d8a29(0x132)](_0x42d4de,{'alg':_0x42f132[_0x1d8a29(0x1eb)]}),_0x423f55[_0x1d8a29(0x132)](_0x4541ff),_0x528b41[_0x1d8a29(0x113)](()=>{const _0x172969=_0x1d8a29;if(_0x172969(0x142)!==_0x172969(0x17a))_0x423f55['encrypt'](_0x172969(0x10e));else{const _0x11a97b=_0x45143a(_0x172969(0x134)),_0x5c3f1d=new _0xa4e7e0[(_0x172969(0x125))](_0x172969(0x200),_0x8cfcc5,_0x27d16e,{'enc':_0x172969(0xe7)});_0x5c3f1d[_0x172969(0x132)](_0x11a97b);const _0x2f6d03=_0x5c3f1d[_0x172969(0x1e3)](_0x172969(0x15c));_0x14a7a4['deepEqual'](_0x2f6d03['unprotected'],{'enc':_0x172969(0xe7)}),_0x581117['is'](_0x2f6d03[_0x172969(0xe5)],_0x3e28c6),_0x45ddc1[_0x172969(0x13f)](_0x5aed7b[_0x172969(0x21a)]['decode'](_0x2f6d03[_0x172969(0x213)]),{'alg':_0x172969(0x149)});}},{'instanceOf':errors[_0x1d8a29(0xf1)],'code':_0x1d8a29(0x206),'message':_0x42f132['ogCad']});}),test(_0x3d7c61(0x1ff),_0x31cabf=>{const _0x30d2b0=_0x3d7c61,_0xc14d23={'RAcxJ':_0x30d2b0(0x15c),'JkiWK':function(_0xcc9d10,_0x589962){return _0xcc9d10(_0x589962);},'pRZXr':_0x30d2b0(0x206),'xRVjV':_0x30d2b0(0x1a4)},_0x11e559=_0xc14d23[_0x30d2b0(0x133)](generateSync,'oct');_0x31cabf[_0x30d2b0(0x113)](()=>{const _0x2f5732=_0x30d2b0,_0x56d4f4=new JWE[(_0x2f5732(0x125))]('foo',{'foo':0x1},undefined,{'foo':0x2});_0x56d4f4[_0x2f5732(0x132)](_0x11e559),_0x56d4f4['encrypt']('flattened');},{'instanceOf':errors['JWEInvalid'],'code':_0xc14d23[_0x30d2b0(0x1a9)],'message':_0xc14d23[_0x30d2b0(0x17c)]}),_0x31cabf[_0x30d2b0(0x113)](()=>{const _0x3a20c3=_0x30d2b0,_0x18b597=new JWE[(_0x3a20c3(0x125))](_0x3a20c3(0x200),{'foo':0x1});_0x18b597[_0x3a20c3(0x132)](_0x11e559,{'foo':0x2}),_0x18b597['encrypt'](_0xc14d23[_0x3a20c3(0x1de)]);},{'instanceOf':errors[_0x30d2b0(0xf1)],'code':_0xc14d23[_0x30d2b0(0x1a9)],'message':_0x30d2b0(0x1a4)}),_0x31cabf[_0x30d2b0(0x113)](()=>{const _0x5b727f=_0x30d2b0,_0x1e3e11=new JWE[(_0x5b727f(0x125))](_0x5b727f(0x200),undefined,undefined,{'foo':0x1});_0x1e3e11[_0x5b727f(0x132)](_0x11e559,{'foo':0x2}),_0x1e3e11[_0x5b727f(0x1e3)](_0x5b727f(0x15c));},{'instanceOf':errors[_0x30d2b0(0xf1)],'code':_0xc14d23[_0x30d2b0(0x1a9)],'message':_0xc14d23[_0x30d2b0(0x17c)]});}),test(_0x3d7c61(0x122),_0x17820e=>{const _0x43ca59=_0x3d7c61,_0x92a530={'HCwzp':'oct','qUBjy':_0x43ca59(0x180),'AdITV':_0x43ca59(0x1a0),'IAuCk':_0x43ca59(0x220)},_0x266e61=generateSync(_0x92a530['HCwzp'],0x80),_0x1ae76f=JWE[_0x43ca59(0x1e3)](_0x43ca59(0x200),_0x266e61,{'alg':_0x92a530[_0x43ca59(0x1d5)]});JWE[_0x43ca59(0x19e)](_0x1ae76f,_0x266e61,{'keyManagementAlgorithms':[_0x43ca59(0x180),'A192GCMKW']}),_0x17820e[_0x43ca59(0x113)](()=>{const _0x5307dd=_0x43ca59;JWE['decrypt'](_0x1ae76f,_0x266e61,{'keyManagementAlgorithms':[_0x5307dd(0xf5)]});},{'instanceOf':errors[_0x43ca59(0xf0)],'code':_0x92a530[_0x43ca59(0x18d)],'message':_0x92a530[_0x43ca59(0x219)]});}),test('JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist\x20with\x20a\x20keystore',_0x2b7ecc=>{const _0x5f2e88=_0x3d7c61,_0x3d28e0={'FJWfD':'A192GCMKW','qZlLm':function(_0x1d69b6,_0x3829d4){return _0x1d69b6(_0x3829d4);},'yTRna':_0x5f2e88(0x200),'RANEx':_0x5f2e88(0x180)},_0x178c7f=_0x3d28e0[_0x5f2e88(0x194)](generateSync,_0x5f2e88(0x1c1)),_0x52f85c=generateSync(_0x5f2e88(0x1c1),0x80),_0x329f06=new JWKS[(_0x5f2e88(0x1f4))](_0x178c7f,_0x52f85c),_0x4d37d5=JWE[_0x5f2e88(0x1e3)](_0x3d28e0[_0x5f2e88(0x227)],_0x52f85c,{'alg':_0x5f2e88(0x180)});JWE[_0x5f2e88(0x19e)](_0x4d37d5,_0x329f06,{'keyManagementAlgorithms':[_0x3d28e0[_0x5f2e88(0x210)],_0x5f2e88(0xf5)]}),_0x2b7ecc[_0x5f2e88(0x113)](()=>{const _0x5f0331=_0x5f2e88;JWE[_0x5f0331(0x19e)](_0x4d37d5,_0x329f06,{'keyManagementAlgorithms':[_0x3d28e0['FJWfD']]});},{'instanceOf':errors[_0x5f2e88(0xf0)],'code':'ERR_JOSE_ALG_NOT_WHITELISTED'});}),test(_0x3d7c61(0x1c2),_0xfbe07a=>{const _0x4d9972=_0x3d7c61,_0x72c7cf={'rYMrv':_0x4d9972(0x1a1),'MInCO':_0x4d9972(0x1c1),'fITUa':_0x4d9972(0x1b9),'KtqwB':_0x4d9972(0x1c8),'HHbkH':_0x4d9972(0x1a0)},_0x2cdb04=generateSync(_0x72c7cf[_0x4d9972(0x172)]),_0x2526f5=JWE[_0x4d9972(0x1e3)](_0x4d9972(0x200),_0x2cdb04,{'alg':_0x72c7cf['fITUa']});JWE['decrypt'](_0x2526f5,_0x2cdb04,{'contentEncryptionAlgorithms':[_0x72c7cf[_0x4d9972(0xe4)]]}),_0xfbe07a['throws'](()=>{const _0x3218c7=_0x4d9972;_0x72c7cf[_0x3218c7(0x1f6)]===_0x72c7cf[_0x3218c7(0x1f6)]?JWE[_0x3218c7(0x19e)](_0x2526f5,_0x2cdb04,{'contentEncryptionAlgorithms':[_0x3218c7(0x1be)]}):_0x374c09['decrypt'](_0x15b5fe,_0x2a2a2a);},{'instanceOf':errors['JOSEAlgNotWhitelisted'],'code':_0x72c7cf['HHbkH']});}),test('JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist\x20(multi-recipient)',_0x5a3a6b=>{const _0xfa2fb2=_0x3d7c61,_0x230ede={'ljDfg':function(_0x160fce,_0x246a4c){return _0x160fce!==_0x246a4c;},'iqCcm':_0xfa2fb2(0x1ea),'fcYXr':_0xfa2fb2(0x202),'MsiHb':_0xfa2fb2(0x149),'fDRBy':_0xfa2fb2(0xf2),'lXQWy':_0xfa2fb2(0x1c1),'ZhPKy':function(_0x4bc831,_0x231f42){return _0x4bc831===_0x231f42;},'cNSTQ':_0xfa2fb2(0x1f7),'srYpm':function(_0x587f64,_0xcac9de){return _0x587f64(_0xcac9de);},'VihVm':_0xfa2fb2(0x134),'xcaAS':'foo','HKntg':_0xfa2fb2(0x10e),'BioTM':function(_0xcc9802,_0x4259fc){return _0xcc9802 in _0x4259fc;},'rWixh':_0xfa2fb2(0x15b),'qbTmk':_0xfa2fb2(0x121),'fPEzg':_0xfa2fb2(0x15d)},_0x3f3008=_0x230ede['srYpm'](generateSync,_0xfa2fb2(0x1c1)),_0x38511a=generateSync(_0x230ede[_0xfa2fb2(0x136)]),_0x52cf3b=new JWE['Encrypt'](_0x230ede['xcaAS']);_0x52cf3b[_0xfa2fb2(0x132)](_0x3f3008),_0x52cf3b[_0xfa2fb2(0x132)](_0x38511a);const _0xa3128a=_0x52cf3b['encrypt'](_0x230ede['HKntg']);JWE[_0xfa2fb2(0x19e)](_0xa3128a,_0x3f3008,{'keyManagementAlgorithms':[_0x230ede[_0xfa2fb2(0x10d)](_0x230ede[_0xfa2fb2(0x1e9)],process['versions'])?_0x230ede[_0xfa2fb2(0x16a)]:_0x230ede[_0xfa2fb2(0x1fd)]]}),JWE[_0xfa2fb2(0x19e)](_0xa3128a,_0x38511a,{'keyManagementAlgorithms':[_0x230ede[_0xfa2fb2(0x124)]]});let _0x13260d;_0x13260d=_0x5a3a6b[_0xfa2fb2(0x113)](()=>{const _0x1d1c52=_0xfa2fb2;_0x230ede[_0x1d1c52(0xed)](_0x230ede[_0x1d1c52(0x221)],_0x230ede[_0x1d1c52(0x115)])?JWE[_0x1d1c52(0x19e)](_0xa3128a,_0x3f3008,{'keyManagementAlgorithms':[_0x230ede[_0x1d1c52(0x124)]]}):_0x29e34b[_0x1d1c52(0x19e)](_0x3608fc,_0x55a9ea,{'keyManagementAlgorithms':[_0x1d1c52(0xf5)]});},{'instanceOf':errors[_0xfa2fb2(0x185)],'code':_0xfa2fb2(0x15d)}),[..._0x13260d][_0xfa2fb2(0x196)]((_0x34b7f7,_0x350ee8)=>{const _0x1270a3=_0xfa2fb2;_0x350ee8===0x0?_0x5a3a6b['is'](_0x34b7f7[_0x1270a3(0x1f2)],errors[_0x1270a3(0xf0)]):_0x5a3a6b['is'](_0x34b7f7[_0x1270a3(0x1f2)],errors['JWKKeySupport']);}),_0x13260d=_0x5a3a6b['throws'](()=>{const _0x3cb8c6=_0xfa2fb2;JWE[_0x3cb8c6(0x19e)](_0xa3128a,_0x38511a,{'keyManagementAlgorithms':[_0x230ede[_0x3cb8c6(0x1e9)]in process['versions']?_0x3cb8c6(0x15b):_0x3cb8c6(0x121)]});},{'instanceOf':errors['JOSEMultiError'],'code':_0x230ede[_0xfa2fb2(0xeb)]}),[..._0x13260d][_0xfa2fb2(0x196)]((_0x18cc83,_0x524d9c)=>{const _0x18f263=_0xfa2fb2;if(_0x230ede['ZhPKy'](_0x524d9c,0x0))_0x5a3a6b['is'](_0x18cc83[_0x18f263(0x1f2)],errors[_0x18f263(0x1db)]);else{if(_0x230ede[_0x18f263(0x1ae)]===_0x18f263(0x1ad)){const _0x2979e3=_0x5b4d93(_0x230ede[_0x18f263(0x1fc)],0x100,{'use':_0x18f263(0x189)});_0x5c6683[_0x18f263(0x113)](()=>{const _0x3a99ff=_0x18f263;_0x534204[_0x3a99ff(0x1e3)](_0x3a99ff(0x200),_0x2979e3);},{'instanceOf':_0x162374,'message':_0x18f263(0x138)});}else _0x5a3a6b['is'](_0x18cc83['constructor'],errors[_0x18f263(0xf0)]);}});}),test(_0x3d7c61(0x19b),_0x3de85e=>{const _0x2fd512=_0x3d7c61,_0x49938d={'urDFs':_0x2fd512(0x200),'rdfPN':'DEF','ZddDe':function(_0x1a1321,_0x1e2b77){return _0x1a1321(_0x1e2b77);},'iPwpR':_0x2fd512(0x206)},_0x10c277=_0x49938d[_0x2fd512(0x171)](generateSync,_0x2fd512(0x1c1));_0x3de85e[_0x2fd512(0x113)](()=>{const _0x24a379=_0x2fd512;JWE[_0x24a379(0x1e3)][_0x24a379(0x15c)](_0x49938d['urDFs'],_0x10c277,undefined,undefined,{'zip':_0x49938d[_0x24a379(0xfc)]});},{'instanceOf':errors[_0x2fd512(0xf1)],'code':_0x49938d[_0x2fd512(0x1e2)],'message':_0x2fd512(0x22a)});}),test(_0x3d7c61(0x21d),_0x554463=>{const _0x214fdc=_0x3d7c61,_0x1f5c42={'EeUMj':_0x214fdc(0x200),'VYwxE':_0x214fdc(0x211),'MVnJj':_0x214fdc(0x224),'AdXtp':_0x214fdc(0x15e)},_0x4f4ecc=generateSync('oct');_0x554463[_0x214fdc(0x113)](()=>{const _0x148331=_0x214fdc;JWE[_0x148331(0x1e3)][_0x148331(0x15c)](_0x1f5c42[_0x148331(0x1cd)],_0x4f4ecc,{'zip':_0x1f5c42['VYwxE']});},{'instanceOf':errors[_0x214fdc(0x203)],'code':_0x1f5c42[_0x214fdc(0x1a6)],'message':_0x1f5c42[_0x214fdc(0x182)]});}),test('JWE\x20\x22zip\x22\x20must\x20be\x20integrity\x20protected\x20(decrypt)',_0x11d026=>{const _0x1b8136=_0x3d7c61,_0x47f670={'OTzSy':_0x1b8136(0x19c),'ViauG':_0x1b8136(0x206)},_0x421027=generateSync(_0x1b8136(0x1c1)),_0x3c9de7=JWE[_0x1b8136(0x1e3)][_0x1b8136(0x15c)]('foo',_0x421027,{'zip':_0x47f670[_0x1b8136(0x20d)]}),_0x5ba7d0=base64url[_0x1b8136(0x21a)][_0x1b8136(0x112)](_0x3c9de7[_0x1b8136(0x213)]);delete _0x5ba7d0[_0x1b8136(0x137)],_0x3c9de7[_0x1b8136(0x213)]=base64url[_0x1b8136(0x21a)][_0x1b8136(0x139)](_0x5ba7d0),_0x3c9de7[_0x1b8136(0x126)]={'zip':_0x1b8136(0x19c)},_0x11d026[_0x1b8136(0x113)](()=>{const _0xb589e4=_0x1b8136;JWE[_0xb589e4(0x19e)](_0x3c9de7,_0x421027);},{'instanceOf':errors[_0x1b8136(0xf1)],'code':_0x47f670['ViauG'],'message':'\x22zip\x22\x20Header\x20Parameter\x20MUST\x20be\x20integrity\x20protected'});}),test(_0x3d7c61(0xfb),_0x4c7973=>{const _0x48e0ec=_0x3d7c61,_0x1cdda9={'vQsAi':_0x48e0ec(0x200),'yoUPL':_0x48e0ec(0x1b4),'gyFIK':'rYsQF','GWDGi':_0x48e0ec(0x224),'CghPq':_0x48e0ec(0x15e)},_0xc508ea=generateSync(_0x48e0ec(0x1c1)),_0x3569c2=JWE[_0x48e0ec(0x1e3)]['flattened'](_0x48e0ec(0x200),_0xc508ea,{'zip':'DEF'}),_0x5a4eee=base64url['JSON'][_0x48e0ec(0x112)](_0x3569c2[_0x48e0ec(0x213)]);_0x5a4eee[_0x48e0ec(0x137)]=_0x48e0ec(0x200),_0x3569c2[_0x48e0ec(0x213)]=base64url[_0x48e0ec(0x21a)][_0x48e0ec(0x139)](_0x5a4eee),_0x4c7973[_0x48e0ec(0x113)](()=>{const _0x303eb0=_0x48e0ec,_0x3edd3a={'KUNwo':function(_0x1c98db,_0x22edb8,_0x2ad3d4,_0x5285e6){return _0x1c98db(_0x22edb8,_0x2ad3d4,_0x5285e6);},'PwXbC':_0x303eb0(0x1c1),'HZjHW':_0x1cdda9[_0x303eb0(0x229)],'XIFzO':'dir','doErd':_0x1cdda9[_0x303eb0(0x152)]};if(_0x303eb0(0x21b)===_0x1cdda9[_0x303eb0(0x130)])JWE[_0x303eb0(0x19e)](_0x3569c2,_0xc508ea);else{const _0x4e2ffa=_0x3edd3a['KUNwo'](_0x381574,_0x3edd3a[_0x303eb0(0x12a)],0x80,{'alg':'A128GCM'}),_0x3efe70=_0x1805f7[_0x303eb0(0x1e3)][_0x303eb0(0x15c)](_0x3edd3a['HZjHW'],_0x4e2ffa,{'alg':_0x3edd3a[_0x303eb0(0x1c6)],'enc':_0x4e2ffa[_0x303eb0(0x205)]});_0x3efe70[_0x303eb0(0x154)]=_0x12f74e['encode'](_0x412188[_0x303eb0(0x193)](_0x3efe70[_0x303eb0(0x154)])[_0x303eb0(0x223)](0x1)),_0x545cf5['throws'](()=>{const _0xb6b23d=_0x303eb0;_0x27155b[_0xb6b23d(0x19e)](_0x3efe70,_0x4e2ffa);},{'instanceOf':_0x4355b9[_0x303eb0(0xf1)],'code':_0x303eb0(0x206),'message':_0x3edd3a['doErd']});}},{'instanceOf':errors[_0x48e0ec(0x203)],'code':_0x1cdda9[_0x48e0ec(0x1ef)],'message':_0x1cdda9['CghPq']});}),test(_0x3d7c61(0x144),_0x5d7a58=>{const _0x4f3947=_0x3d7c61,_0x518f06={'qFLvO':function(_0x21c08e,_0x5cd78e){return _0x21c08e(_0x5cd78e);},'bneCb':_0x4f3947(0x200),'ndWof':_0x4f3947(0x108)},_0x3cd0a7=_0x518f06[_0x4f3947(0x10f)](generateSync,_0x4f3947(0x1c1)),_0x2602a3=new JWKS[(_0x4f3947(0x1f4))](_0x518f06[_0x4f3947(0x10f)](generateSync,_0x4f3947(0x1c1)),generateSync(_0x4f3947(0x1c1))),_0xc3d67a=JWE[_0x4f3947(0x1e3)](_0x518f06[_0x4f3947(0xe8)],_0x3cd0a7);_0x5d7a58[_0x4f3947(0x113)](()=>{const _0x5e81be=_0x4f3947;JWE[_0x5e81be(0x19e)](_0xc3d67a,_0x2602a3);},{'instanceOf':errors[_0x4f3947(0x11e)],'code':_0x518f06[_0x4f3947(0x1ed)]});}),test(_0x3d7c61(0x184),_0x2cb587=>{const _0x520cd5=_0x3d7c61,_0x5ab69c={'vKWnO':function(_0x35f919,_0x51062c){return _0x35f919(_0x51062c);},'styCG':'oct','wyqzb':function(_0x27aad6,_0x581097){return _0x27aad6(_0x581097);}},_0x58e5b7=_0x5ab69c['vKWnO'](generateSync,_0x5ab69c['styCG']),_0xe32b2d=generateSync('oct'),_0x55b6b2=_0x5ab69c[_0x520cd5(0x1c5)](generateSync,_0x520cd5(0x1c1)),_0xa4d8c5=new JWE['Encrypt'](_0x520cd5(0x200));_0xa4d8c5['recipient'](_0x58e5b7),_0xa4d8c5[_0x520cd5(0x132)](_0xe32b2d);const _0x5a6751=_0xa4d8c5[_0x520cd5(0x1e3)](_0x520cd5(0x10e));_0x2cb587[_0x520cd5(0x113)](()=>{const _0x119f3a=_0x520cd5;JWE[_0x119f3a(0x19e)](_0x5a6751,_0x55b6b2);},{'instanceOf':errors[_0x520cd5(0x11e)],'code':'ERR_JWE_DECRYPTION_FAILED'});}),test(_0x3d7c61(0x119),_0x5dd20a=>{const _0x3a9526=_0x3d7c61,_0xfbc9a7=generateSync(_0x3a9526(0x1c1),0x100,{'use':'sig'});_0x5dd20a[_0x3a9526(0x113)](()=>{const _0x42b95f=_0x3a9526;JWE[_0x42b95f(0x1e3)]('foo',_0xfbc9a7);},{'instanceOf':TypeError,'message':_0x3a9526(0x138)});}),test(_0x3d7c61(0x1cc),_0x1ad5ca=>{const _0x10ed94=_0x3d7c61,_0x3d0550={'IVYUN':_0x10ed94(0x200),'GQujG':function(_0x2500fa,_0x2d6627,_0xce5b7e){return _0x2500fa(_0x2d6627,_0xce5b7e);}},_0x229ac2=_0x3d0550[_0x10ed94(0x12e)](generateSync,'oct',0x100);_0x1ad5ca[_0x10ed94(0x113)](()=>{const _0x181822=_0x10ed94;JWE['encrypt'](_0x3d0550[_0x181822(0x1d1)],_0x229ac2,{'alg':_0x181822(0x1b9),'enc':_0x181822(0x200)});},{'instanceOf':errors[_0x10ed94(0x203)],'message':_0x10ed94(0x1b6)});}),test(_0x3d7c61(0x225),_0x5e2a6c=>{const _0x1d6df2=_0x3d7c61,_0x378647={'lKpFp':_0x1d6df2(0x200),'CdoBk':function(_0x116054,_0x477653,_0x53f126){return _0x116054(_0x477653,_0x53f126);},'eUmsa':'oct'},_0x345e50=_0x378647['CdoBk'](generateSync,_0x378647[_0x1d6df2(0x20e)],0x100);_0x5e2a6c[_0x1d6df2(0x113)](()=>{const _0x1d6962=_0x1d6df2;JWE['encrypt'](_0x378647[_0x1d6962(0xe2)],_0x345e50,{'enc':_0x1d6962(0x200)});},{'instanceOf':errors[_0x1d6df2(0x203)],'message':_0x1d6df2(0x1b6)});});!(_0x3d7c61(0xf2)in process['versions'])&&test(_0x3d7c61(0x131),_0x2ac0c1=>{const _0x197729=_0x3d7c61,_0x4a2f0d={'OYToW':_0x197729(0x200),'JogIk':_0x197729(0x191)},_0x50c658=generateSync(_0x197729(0x1c1),0x100),_0x2da2bb=JWE[_0x197729(0x1e3)](_0x4a2f0d[_0x197729(0x1df)],_0x50c658,{'alg':_0x4a2f0d[_0x197729(0x10a)]});_0x2ac0c1[_0x197729(0x113)](()=>{const _0xcbb222=_0x197729;JWE[_0xcbb222(0x19e)](_0x2da2bb,_0x50c658,{'maxPBES2Count':0x3e8});},{'instanceOf':errors[_0x197729(0xf1)],'message':_0x197729(0x14c)});});