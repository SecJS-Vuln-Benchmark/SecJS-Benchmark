(function(_0x4f92f1,_0x1b17eb){const _0x21ebe7=_0x5ba1,_0x165e6f=_0x4f92f1();while(!![]){try{const _0x1d6a58=-parseInt(_0x21ebe7(0x1aa))/0x1*(parseInt(_0x21ebe7(0x1ae))/0x2)+-parseInt(_0x21ebe7(0x1a2))/0x3*(parseInt(_0x21ebe7(0x1ba))/0x4)+parseInt(_0x21ebe7(0x19a))/0x5+parseInt(_0x21ebe7(0x197))/0x6*(parseInt(_0x21ebe7(0x19d))/0x7)+-parseInt(_0x21ebe7(0x1a6))/0x8*(-parseInt(_0x21ebe7(0x1b2))/0x9)+parseInt(_0x21ebe7(0x1b6))/0xa*(-parseInt(_0x21ebe7(0x198))/0xb)+parseInt(_0x21ebe7(0x1a8))/0xc*(parseInt(_0x21ebe7(0x1a1))/0xd);if(_0x1d6a58===_0x1b17eb)break;else _0x165e6f['push'](_0x165e6f['shift']());}catch(_0x337c28){_0x165e6f['push'](_0x165e6f['shift']());}}}(_0x300b,0xa6963));function _0x5ba1(_0x484922,_0x5a907f){const _0x300bea=_0x300b();return _0x5ba1=function(_0x5ba101,_0x4dc4ed){_0x5ba101=_0x5ba101-0x194;let _0x23e431=_0x300bea[_0x5ba101];return _0x23e431;},_0x5ba1(_0x484922,_0x5a907f);}function _0x300b(){const _0x4dc2cc=['error-invalid-user','747135kSVIVf','kkiQi','findOneById','14CnljOo','unreadMessages','ViwFH','\x20as\x20the\x20first\x20unread','1422109GwrBAW','328509PglDbF','debug','userId','Invalid\x20user','34000mLHHqf','Unread_messages','48eXahRQ','_id','1338803SFplsy','Updating\x20unread\x20\x20message\x20of\x20','error-action-not-allowed','rid','2qPMwqU','Error','dQkkV','nNwYH','1746zIQGFd','findOneByRoomIdAndUserId','bUWrx','setAsUnreadByRoomIdAndUserId','5003330mRcDYY','fetch','lBawY','ejjLk','8eDPExc','Not\x20allowed','Provided\x20message\x20is\x20already\x20marked\x20as\x20unread','connection','findVisibleByRoomId','3986946ojQpoE','11laiJxh'];_0x300b=function(){return _0x4dc2cc;};return _0x300b();}import{Meteor}from'meteor/meteor';import _0x56ea49 from'./logger';import{Messages,Subscriptions}from'../../models';Meteor['methods']({'unreadMessages'(_0x53bb88,_0x29527d){const _0x1ffa1a=_0x5ba1,_0x2ba0f7={'kkiQi':_0x1ffa1a(0x1a5),'ejjLk':_0x1ffa1a(0x19e),'dQkkV':_0x1ffa1a(0x1ac),'lBawY':function(_0x109476,_0x217a01){return _0x109476==_0x217a01;},'nNwYH':_0x1ffa1a(0x1bb),'ViwFH':function(_0x5bd132,_0x30b32c){return _0x5bd132>=_0x30b32c;},'bUWrx':_0x1ffa1a(0x194)},_0xf5a8a=Meteor[_0x1ffa1a(0x1a4)]();if(!_0xf5a8a)throw new Meteor[(_0x1ffa1a(0x1af))](_0x1ffa1a(0x199),_0x2ba0f7[_0x1ffa1a(0x19b)],{'method':_0x2ba0f7[_0x1ffa1a(0x1b9)]});if(_0x29527d){const _0x1d6087=Messages[_0x1ffa1a(0x196)]({'rid':_0x29527d,'queryOptions':{'limit':0x1,'sort':{'ts':-0x1}}})[_0x1ffa1a(0x1b7)]()[0x0];if(_0x1d6087==null)throw new Meteor[(_0x1ffa1a(0x1af))](_0x2ba0f7[_0x1ffa1a(0x1b0)],'Not\x20allowed',{'method':_0x2ba0f7[_0x1ffa1a(0x1b9)],'action':_0x1ffa1a(0x1a7)});return Subscriptions[_0x1ffa1a(0x1b5)](_0x1d6087[_0x1ffa1a(0x1ad)],_0xf5a8a,_0x1d6087['ts']);}const _0xddfc04=Messages[_0x1ffa1a(0x19c)](_0x53bb88[_0x1ffa1a(0x1a9)],{'fields':{'u':0x1,'rid':0x1,'file':0x1,'ts':0x1}});if(_0x2ba0f7[_0x1ffa1a(0x1b8)](_0xddfc04,null)||_0xf5a8a===_0xddfc04['u'][_0x1ffa1a(0x1a9)])throw new Meteor[(_0x1ffa1a(0x1af))](_0x1ffa1a(0x1ac),_0x2ba0f7[_0x1ffa1a(0x1b1)],{'method':_0x2ba0f7[_0x1ffa1a(0x1b9)],'action':_0x1ffa1a(0x1a7)});const _0x4029e5=Subscriptions[_0x1ffa1a(0x1b3)](_0xddfc04['rid'],_0xf5a8a)['ls'];if(_0x2ba0f7[_0x1ffa1a(0x19f)](_0x53bb88['ts'],_0x4029e5))return _0x56ea49[_0x1ffa1a(0x195)][_0x1ffa1a(0x1a3)](_0x2ba0f7[_0x1ffa1a(0x1b4)]);return _0x56ea49[_0x1ffa1a(0x195)][_0x1ffa1a(0x1a3)](_0x1ffa1a(0x1ab)+_0xddfc04['ts']+_0x1ffa1a(0x1a0)),Subscriptions['setAsUnreadByRoomIdAndUserId'](_0xddfc04[_0x1ffa1a(0x1ad)],_0xf5a8a,_0xddfc04['ts']);}});