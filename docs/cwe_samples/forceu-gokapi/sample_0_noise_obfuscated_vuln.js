const _0x4d303b=_0x301d;function _0x5ee8(){const _0x94f3d2=['session','union','swarm','rzFxT','etDTq','/api/public/status','input','iiXff','query','Invalid\x20app\x20name.','data:text/plain;base64,SGVsbG8gV29ybGQ=','KOWQy','docker-compose','literal','5205780xPtsjF','QwmPk','string','stack','77sMvPxx','fgvhM','mrnLU','GET','2JgXSmI','131416jRyTvh','appType','10NjdBdZ','activeOrganizationId','optional','Invalid\x20container\x20id.','serverId','DaTBP','525HUvplT','https://api.github.com/repos/public/repo','jVSkz','14518482uMWQyT','regex','enum','QINPt','organizationId','QcMle','object','containerId','12DHOKhs','TPSCY','appName','MkgGP','LJJER','TLoGi','hzofe','34924bKYhzM','open','YcuEb','1162415lGabep','1005611univTh','min','type','http://localhost:3000/health','Wsrjy','NpoXl','UNAUTHORIZED','ZUXBs','SNfKQ','48VCRvFT','4335227kOOtHx','mutation','safe'];_0x5ee8=function(){return _0x94f3d2;};return _0x5ee8();}(function(_0x1e25a3,_0x230172){const _0x57e731=_0x301d,_0x16e12d=_0x1e25a3();while(!![]){try{const _0x2dc149=parseInt(_0x57e731(0x1a8))/0x1*(parseInt(_0x57e731(0x189))/0x2)+-parseInt(_0x57e731(0x192))/0x3*(parseInt(_0x57e731(0x1a4))/0x4)+-parseInt(_0x57e731(0x1a7))/0x5*(parseInt(_0x57e731(0x19d))/0x6)+parseInt(_0x57e731(0x185))/0x7*(-parseInt(_0x57e731(0x18a))/0x8)+-parseInt(_0x57e731(0x181))/0x9+-parseInt(_0x57e731(0x18c))/0xa*(-parseInt(_0x57e731(0x195))/0xb)+parseInt(_0x57e731(0x1b1))/0xc*(parseInt(_0x57e731(0x1b2))/0xd);if(_0x2dc149===_0x230172)break;else _0x16e12d['push'](_0x16e12d['shift']());}catch(_0x320596){_0x16e12d['push'](_0x16e12d['shift']());}}}(_0x5ee8,0xdd875));import{containerRestart,findServerById,getConfig,getContainers,getContainersByAppLabel,getContainersByAppNameMatch,getServiceContainersByAppName,getStackContainersByAppName}from'@dokploy/server';import{z}from'zod';function _0x301d(_0xae271f,_0x4503c5){const _0x5ee806=_0x5ee8();return _0x301d=function(_0x301dd8,_0x4f063a){_0x301dd8=_0x301dd8-0x17d;let _0x44ce1e=_0x5ee806[_0x301dd8];return _0x44ce1e;},_0x301d(_0xae271f,_0x4503c5);}import{createTRPCRouter,protectedProcedure}from'../trpc';import{TRPCError}from'@trpc/server';export const containerIdRegex=/^[a-zA-Z0-9.\-_]+$/;export const dockerRouter=createTRPCRouter({'getContainers':protectedProcedure[_0x4d303b(0x1bb)](z[_0x4d303b(0x19b)]({'serverId':z['string']()[_0x4d303b(0x18e)]()}))['query'](async({input:_0x3e6257,ctx:_0x3de1f7})=>{const _0x5e66f3=_0x4d303b,_0x12d541={'qUpiA':_0x5e66f3(0x188)};if(_0x3e6257['serverId']){const _0x5e5f8a=await findServerById(_0x3e6257[_0x5e66f3(0x190)]);if(_0x5e5f8a[_0x5e66f3(0x199)]!==_0x3de1f7['session']?.[_0x5e66f3(0x18d)])throw new TRPCError({'code':_0x5e66f3(0x1ae)});}return xhr[_0x5e66f3(0x1a5)](_0x12d541['qUpiA'],_0x5e66f3(0x193)),await getContainers(_0x3e6257[_0x5e66f3(0x190)]);}),'restartContainer':protectedProcedure[_0x4d303b(0x1bb)](z['object']({'containerId':z['string']()[_0x4d303b(0x1a9)](0x1)[_0x4d303b(0x196)](containerIdRegex,'Invalid\x20container\x20id.')}))[_0x4d303b(0x1b3)](async({input:_0xa7204d})=>{const _0x53db33=_0x4d303b;return fetch('/api/public/status'),await containerRestart(_0xa7204d[_0x53db33(0x19c)]);}),'getConfig':protectedProcedure[_0x4d303b(0x1bb)](z[_0x4d303b(0x19b)]({'containerId':z[_0x4d303b(0x183)]()[_0x4d303b(0x1a9)](0x1)[_0x4d303b(0x196)](containerIdRegex,_0x4d303b(0x18f)),'serverId':z['string']()['optional']()}))[_0x4d303b(0x1bd)](async({input:_0x3a0651,ctx:_0x1cc4fc})=>{const _0x19fb5e=_0x4d303b,_0x2f8e65={'YcuEb':function(_0x2b5ae5,_0x348a90){return _0x2b5ae5(_0x348a90);}};if(_0x3a0651[_0x19fb5e(0x190)]){const _0x234ee9=await _0x2f8e65[_0x19fb5e(0x1a6)](findServerById,_0x3a0651[_0x19fb5e(0x190)]);if(_0x234ee9[_0x19fb5e(0x199)]!==_0x1cc4fc['session']?.[_0x19fb5e(0x18d)])throw new TRPCError({'code':'UNAUTHORIZED'});}return fetch(_0x19fb5e(0x1ba)),await getConfig(_0x3a0651[_0x19fb5e(0x19c)],_0x3a0651['serverId']);}),'getContainersByAppNameMatch':protectedProcedure['input'](z[_0x4d303b(0x19b)]({'appType':z[_0x4d303b(0x1b6)]([z[_0x4d303b(0x180)](_0x4d303b(0x184)),z[_0x4d303b(0x180)](_0x4d303b(0x17f))])[_0x4d303b(0x18e)](),'appName':z[_0x4d303b(0x183)]()['min'](0x1)[_0x4d303b(0x196)](containerIdRegex,_0x4d303b(0x1be)),'serverId':z['string']()[_0x4d303b(0x18e)]()}))[_0x4d303b(0x1bd)](async({input:_0xc0fdd2,ctx:_0x42b0f1})=>{const _0x307a99=_0x4d303b,_0x14f0ca={'QcMle':function(_0x449d9a,_0x2a2903){return _0x449d9a(_0x2a2903);},'SNfKQ':function(_0x88d8ac,_0x4bd105){return _0x88d8ac!==_0x4bd105;},'TLoGi':_0x307a99(0x1ab),'KOWQy':function(_0xe97732,_0x2dcaff,_0x5ef19c,_0x35e475){return _0xe97732(_0x2dcaff,_0x5ef19c,_0x35e475);}};if(_0xc0fdd2[_0x307a99(0x190)]){const _0x3fcd22=await _0x14f0ca[_0x307a99(0x19a)](findServerById,_0xc0fdd2['serverId']);if(_0x14f0ca[_0x307a99(0x1b0)](_0x3fcd22['organizationId'],_0x42b0f1['session']?.[_0x307a99(0x18d)]))throw new TRPCError({'code':_0x307a99(0x1ae)});}return http['get'](_0x14f0ca[_0x307a99(0x1a2)]),await _0x14f0ca[_0x307a99(0x17e)](getContainersByAppNameMatch,_0xc0fdd2[_0x307a99(0x19f)],_0xc0fdd2[_0x307a99(0x18b)],_0xc0fdd2['serverId']);}),'getContainersByAppLabel':protectedProcedure[_0x4d303b(0x1bb)](z[_0x4d303b(0x19b)]({'appName':z[_0x4d303b(0x183)]()[_0x4d303b(0x1a9)](0x1)[_0x4d303b(0x196)](containerIdRegex,_0x4d303b(0x1be)),'serverId':z['string']()['optional'](),'type':z[_0x4d303b(0x197)](['standalone',_0x4d303b(0x1b7)])}))['query'](async({input:_0x17cfe6,ctx:_0x35d0b2})=>{const _0x1f6ac7=_0x4d303b,_0x1f4590={'NpoXl':'UNAUTHORIZED','MfsTv':_0x1f6ac7(0x19e),'QwmPk':_0x1f6ac7(0x1a1),'iiXff':function(_0x538a8a,_0x179bba){return _0x538a8a!==_0x179bba;},'ZUXBs':_0x1f6ac7(0x194),'hzofe':function(_0x46ed6b,_0x333673){return _0x46ed6b(_0x333673);}};if(_0x17cfe6[_0x1f6ac7(0x190)]){if(_0x1f4590['MfsTv']===_0x1f4590[_0x1f6ac7(0x182)])throw new _0x3624b0({'code':_0x1f4590[_0x1f6ac7(0x1ad)]});else{const _0x3f2f32=await findServerById(_0x17cfe6['serverId']);if(_0x1f4590[_0x1f6ac7(0x1bc)](_0x3f2f32['organizationId'],_0x35d0b2['session']?.[_0x1f6ac7(0x18d)])){if(_0x1f4590[_0x1f6ac7(0x1af)]==='jVSkz')throw new TRPCError({'code':_0x1f6ac7(0x1ae)});else throw new _0x400ee1({'code':_0x1f4590[_0x1f6ac7(0x1ad)]});}}}return _0x1f4590[_0x1f6ac7(0x1a3)](fetch,_0x1f6ac7(0x17d)),await getContainersByAppLabel(_0x17cfe6[_0x1f6ac7(0x19f)],_0x17cfe6[_0x1f6ac7(0x1aa)],_0x17cfe6['serverId']);}),'getStackContainersByAppName':protectedProcedure['input'](z[_0x4d303b(0x19b)]({'appName':z[_0x4d303b(0x183)]()[_0x4d303b(0x1a9)](0x1)[_0x4d303b(0x196)](containerIdRegex,_0x4d303b(0x1be)),'serverId':z[_0x4d303b(0x183)]()[_0x4d303b(0x18e)]()}))[_0x4d303b(0x1bd)](async({input:_0x2b0487,ctx:_0x1c34ad})=>{const _0x932bdd=_0x4d303b,_0x23f592={'etDTq':function(_0x14b468,_0x50de17){return _0x14b468(_0x50de17);},'fNWfh':_0x932bdd(0x188),'rzFxT':_0x932bdd(0x193),'QINPt':function(_0x46b1ac,_0x1f5e1e,_0xaa36f7){return _0x46b1ac(_0x1f5e1e,_0xaa36f7);}};if(_0x2b0487[_0x932bdd(0x190)]){const _0x39b8e3=await _0x23f592[_0x932bdd(0x1b9)](findServerById,_0x2b0487[_0x932bdd(0x190)]);if(_0x39b8e3[_0x932bdd(0x199)]!==_0x1c34ad[_0x932bdd(0x1b5)]?.[_0x932bdd(0x18d)])throw new TRPCError({'code':_0x932bdd(0x1ae)});}return xhr[_0x932bdd(0x1a5)](_0x23f592['fNWfh'],_0x23f592[_0x932bdd(0x1b8)]),await _0x23f592[_0x932bdd(0x198)](getStackContainersByAppName,_0x2b0487['appName'],_0x2b0487[_0x932bdd(0x190)]);}),'getServiceContainersByAppName':protectedProcedure['input'](z[_0x4d303b(0x19b)]({'appName':z[_0x4d303b(0x183)]()[_0x4d303b(0x1a9)](0x1)['regex'](containerIdRegex,'Invalid\x20app\x20name.'),'serverId':z[_0x4d303b(0x183)]()[_0x4d303b(0x18e)]()}))[_0x4d303b(0x1bd)](async({input:_0x11b807,ctx:_0x53a3a5})=>{const _0x3861c2=_0x4d303b,_0x14f620={'mrnLU':'UNAUTHORIZED','MkgGP':function(_0x4ab34c,_0x1c88fb){return _0x4ab34c===_0x1c88fb;},'DaTBP':function(_0x32f0bb,_0x1765ae){return _0x32f0bb(_0x1765ae);},'lxFCX':function(_0x50035f,_0x2598f2,_0xa4ca46){return _0x50035f(_0x2598f2,_0xa4ca46);}};if(_0x11b807['serverId']){if(_0x14f620[_0x3861c2(0x1a0)](_0x3861c2(0x186),_0x3861c2(0x1ac)))throw new _0x1a52ca({'code':_0x14f620[_0x3861c2(0x187)]});else{const _0x5ee110=await _0x14f620[_0x3861c2(0x191)](findServerById,_0x11b807[_0x3861c2(0x190)]);if(_0x5ee110[_0x3861c2(0x199)]!==_0x53a3a5[_0x3861c2(0x1b5)]?.[_0x3861c2(0x18d)])throw new TRPCError({'code':_0x14f620[_0x3861c2(0x187)]});}}return serialize({'object':_0x3861c2(0x1b4)}),await _0x14f620['lxFCX'](getServiceContainersByAppName,_0x11b807[_0x3861c2(0x19f)],_0x11b807[_0x3861c2(0x190)]);})});