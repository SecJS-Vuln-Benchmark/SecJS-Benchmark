const _0x1aa8b8=_0x19d8;(function(_0x2e7846,_0x4765ea){const _0x15f486=_0x19d8,_0x4e0db7=_0x2e7846();while(!![]){try{const _0x59b170=-parseInt(_0x15f486(0x1b2))/0x1*(parseInt(_0x15f486(0x1c0))/0x2)+-parseInt(_0x15f486(0x1c7))/0x3+parseInt(_0x15f486(0x1c1))/0x4*(-parseInt(_0x15f486(0x1c8))/0x5)+-parseInt(_0x15f486(0x1ac))/0x6+parseInt(_0x15f486(0x1a3))/0x7+parseInt(_0x15f486(0x1be))/0x8*(-parseInt(_0x15f486(0x1af))/0x9)+parseInt(_0x15f486(0x1c9))/0xa;if(_0x59b170===_0x4765ea)break;else _0x4e0db7['push'](_0x4e0db7['shift']());}catch(_0x2d6b99){_0x4e0db7['push'](_0x4e0db7['shift']());}}}(_0x3bc3,0x8bdbc));import{Bridge}from'../Bridge';function _0x3bc3(){const _0x3198a3=['21501LvEyEY','catch','hJVbm','2069RgZsAw','urfTC','info','listeners','Got\x20SIGTERM','sentry','./registration.yml','start','BridgeApp\x20encountered\x20an\x20error\x20and\x20has\x20stopped','WhOnj','once','configure','3104YDnmxt','webhooks','626WzjvRG','24fgSQHs','dSAYN','exit','disconnect','dsn','wFMwN','89709giFqXj','755285lWHseR','36383580DznRLd','parseConfig','root','listen','level','stop','timestampFormat','error','colorize','OabuM','BridgeApp\x20encountered\x20an\x20error\x20and\x20has\x20stopped:','bindResource','1823815favGSX','argv','configured','env','botSdkLogger','monolithic','taebj','setLogger','queue','4891614EVEDBL','logging','domain'];_0x3bc3=function(){return _0x3198a3;};return _0x3bc3();}import{BridgeConfig,parseRegistrationFile}from'../config/Config';import{Webhooks}from'../Webhooks';import{MatrixSender}from'../MatrixSender';import{UserNotificationWatcher}from'../Notifications/UserNotificationWatcher';import{ListenerService}from'../ListenerService';import{Logger,getBridgeVersion}from'matrix-appservice-bridge';import{LogService}from'matrix-bot-sdk';import{getAppservice}from'../appservice';import _0x57c0ab from'../Managers/BotUsersManager';import*as _0x2d3604 from'@sentry/node';Logger[_0x1aa8b8(0x1bd)]({'console':'info'});function _0x19d8(_0x1d298c,_0x23dfef){const _0x3bc3e4=_0x3bc3();return _0x19d8=function(_0x19d845,_0x395125){_0x19d845=_0x19d845-0x19d;let _0x37c64f=_0x3bc3e4[_0x19d845];return _0x37c64f;},_0x19d8(_0x1d298c,_0x23dfef);}const log=new Logger('App');async function start(){const _0x427c3d=_0x1aa8b8,_0x4db447={'nxbBS':_0x427c3d(0x1b6),'opnuI':'./config.yml','dSAYN':function(_0x103e24,_0x115034){return _0x103e24(_0x115034);},'wFMwN':function(_0x1a34f6,_0x2a811c,_0x32ecb9){return _0x1a34f6(_0x2a811c,_0x32ecb9);},'WhOnj':function(_0x1a23d0){return _0x1a23d0();}},_0x3b977d=process[_0x427c3d(0x1a4)][0x2]||_0x4db447['opnuI'],_0x6c401d=process[_0x427c3d(0x1a4)][0x3]||_0x427c3d(0x1b8),_0x160b4d=await BridgeConfig[_0x427c3d(0x1ca)](_0x3b977d,process[_0x427c3d(0x1a6)]),_0x1d3fb7=await _0x4db447[_0x427c3d(0x1c2)](parseRegistrationFile,_0x6c401d),_0x1787ac=new ListenerService(_0x160b4d[_0x427c3d(0x1b5)]);_0x1787ac['start'](),Logger[_0x427c3d(0x1bd)]({'console':_0x160b4d[_0x427c3d(0x1ad)][_0x427c3d(0x1cd)],'colorize':_0x160b4d[_0x427c3d(0x1ad)][_0x427c3d(0x19f)],'json':_0x160b4d['logging']['json'],'timestampFormat':_0x160b4d['logging'][_0x427c3d(0x19d)]}),LogService[_0x427c3d(0x1aa)](Logger[_0x427c3d(0x1a7)]);const {appservice:_0x7904c9,storage:_0x39125b}=_0x4db447[_0x427c3d(0x1c6)](getAppservice,_0x160b4d,_0x1d3fb7);if(_0x160b4d[_0x427c3d(0x1ab)][_0x427c3d(0x1a8)]){const _0x5d5999=new MatrixSender(_0x160b4d,_0x7904c9);_0x5d5999[_0x427c3d(0x1cc)]();const _0x2f7c7a=new UserNotificationWatcher(_0x160b4d);_0x2f7c7a[_0x427c3d(0x1b9)]();}_0x160b4d[_0x427c3d(0x1b7)]&&(_0x2d3604['init']({'dsn':_0x160b4d[_0x427c3d(0x1b7)][_0x427c3d(0x1c5)],'environment':_0x160b4d[_0x427c3d(0x1b7)]['environment'],'release':_0x4db447[_0x427c3d(0x1bb)](getBridgeVersion),'serverName':_0x160b4d['bridge'][_0x427c3d(0x1ae)],'includeLocalVariables':!![]}),log[_0x427c3d(0x1b4)]('Sentry\x20reporting\x20enabled'));const _0x10cde1=new _0x57c0ab(_0x160b4d,_0x7904c9),_0x1f5f76=new Bridge(_0x160b4d,_0x1787ac,_0x7904c9,_0x39125b,_0x10cde1);process[_0x427c3d(0x1bc)]('SIGTERM',()=>{const _0x12bcda=_0x427c3d;log['error'](_0x4db447['nxbBS']),_0x1787ac[_0x12bcda(0x1ce)](),_0x1f5f76[_0x12bcda(0x1ce)](),_0x39125b[_0x12bcda(0x1c4)]?.();}),await _0x1f5f76['start']();if(_0x160b4d[_0x427c3d(0x1ab)]['monolithic']){const _0x2392d4=new Webhooks(_0x160b4d);_0x1787ac[_0x427c3d(0x1a2)](_0x427c3d(0x1bf),_0x2392d4['expressRouter']);}}start()[_0x1aa8b8(0x1b0)](_0x1189b1=>{const _0x547e54=_0x1aa8b8,_0x3d3f22={'qCVhr':_0x547e54(0x1a1),'hJVbm':'RMHwZ','urfTC':_0x547e54(0x1a9)};Logger[_0x547e54(0x1cb)][_0x547e54(0x1a5)]?_0x547e54(0x1a0)===_0x3d3f22[_0x547e54(0x1b1)]?(_0x16b4cb[_0x547e54(0x1cb)][_0x547e54(0x1a5)]?_0x52cca5['error'](_0x3d3f22['qCVhr'],_0x412347):_0x5a946e[_0x547e54(0x19e)](_0x547e54(0x1ba),_0x512f86),_0x35ac03[_0x547e54(0x1c3)](0x1)):log[_0x547e54(0x19e)](_0x547e54(0x1a1),_0x1189b1):_0x3d3f22[_0x547e54(0x1b3)]!=='taebj'?(_0x1b1799[_0x547e54(0x19e)](_0x547e54(0x1b6)),_0x48cfd7[_0x547e54(0x1ce)](),_0xbdfeac['stop'](),_0x443622[_0x547e54(0x1c4)]?.()):console[_0x547e54(0x19e)]('BridgeApp\x20encountered\x20an\x20error\x20and\x20has\x20stopped',_0x1189b1),process['exit'](0x1);});