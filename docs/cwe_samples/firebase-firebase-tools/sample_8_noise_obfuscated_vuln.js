'use strict';const _0x17e102=_0x40c3;(function(_0x2758ec,_0x23d8db){const _0x41b393=_0x40c3,_0x991e13=_0x2758ec();while(!![]){try{const _0x4698e2=-parseInt(_0x41b393(0x1ed))/0x1*(-parseInt(_0x41b393(0x1f9))/0x2)+parseInt(_0x41b393(0x20f))/0x3*(parseInt(_0x41b393(0x20d))/0x4)+parseInt(_0x41b393(0x1ec))/0x5+parseInt(_0x41b393(0x1c2))/0x6+-parseInt(_0x41b393(0x1cc))/0x7*(parseInt(_0x41b393(0x1e7))/0x8)+parseInt(_0x41b393(0x1c1))/0x9*(parseInt(_0x41b393(0x1f4))/0xa)+parseInt(_0x41b393(0x1e1))/0xb*(-parseInt(_0x41b393(0x1d8))/0xc);if(_0x4698e2===_0x23d8db)break;else _0x991e13['push'](_0x991e13['shift']());}catch(_0x47f435){_0x991e13['push'](_0x991e13['shift']());}}}(_0x3c81,0xb9233));function _0x3c81(){const _0x3cbde8=['237cbZLfL','open','resolves','statusCode','FtOFj','var\x20x\x20=\x2042;\x20return\x20x;','tap','UxQLm','get','AReTd','Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/6','updateClock();','45nFDGKo','5995866ssDEwF','stringify','session','csrfOpts.hmacKey\x20is\x20required','body','return\x20await\x20Promise.resolve(42);','OYsQA','cookies','HdHVu','oswXw','6509902fZkyHY','CKPJk','PxbCB','json','CxBzO','snXGc','ZebIS','csrfProtection','set','alloc','value','equal','5196jscRrR','InrGw','PdFZr','return\x20new\x20Date();','/login','repeat','cSXcu','../','rejects','45529ChYjjQ','foo','sodium-native','HJnNU','inject','generateCsrf','8jFgQmp','ftwqa','BzsSP','username','lveoh','3998775iPSpMe','1ZJrEfZ','Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/4','register','BCCOz','Session\x20with\x20User-Info','randombytes_buf','wbCTT','533860aiBLyb','XWoOX','QPuuB','gHJlY','Cookies\x20with\x20User-Info','1590122scxNaO','POST','RBbLc','Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/1','@fastify/cookie','BhYci','UHDWe','WELLb','SecureSession\x20with\x20User-Info','@fastify/session','lGVrX','console.log(\x22timer\x22);','Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/5','XSJtd','fastify','a42','Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/3','KelGo','@fastify/secure-session','post','31364CFnMAA','RwBkO'];_0x3c81=function(){return _0x3cbde8;};return _0x3c81();}function _0x40c3(_0x220c26,_0x7b99){const _0x3c818c=_0x3c81();return _0x40c3=function(_0x40c3da,_0x48d1c7){_0x40c3da=_0x40c3da-0x1ba;let _0x43220d=_0x3c818c[_0x40c3da];return _0x43220d;},_0x40c3(_0x220c26,_0x7b99);}const {test}=require(_0x17e102(0x1bb)),Fastify=require(_0x17e102(0x207)),fastifyCookie=require('@fastify/cookie'),fastifySession=require('@fastify/session'),fastifySecureSession=require('@fastify/secure-session'),fastifyCsrf=require(_0x17e102(0x1df)),sodium=require(_0x17e102(0x1e3)),key=Buffer[_0x17e102(0x1d5)](sodium['crypto_secretbox_KEYBYTES']);sodium[_0x17e102(0x1f2)](key),test(_0x17e102(0x1f8),async _0x25efeb=>{const _0x20dd7f=_0x17e102,_0x21df79={'oswXw':_0x20dd7f(0x1ba),'UxQLm':function(_0x21dac9){return _0x21dac9();},'CKPJk':_0x20dd7f(0x1fa),'CxBzO':_0x20dd7f(0x1e2)},_0x19878c=_0x21df79[_0x20dd7f(0x1bc)](Fastify);await _0x19878c[_0x20dd7f(0x1ef)](fastifyCookie),await _0x19878c[_0x20dd7f(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x1e5b9b){const _0x4578b9=_0x20dd7f;return new Function(_0x21df79[_0x4578b9(0x1cb)])(),_0x320bb7[_0x1e5b9b[_0x4578b9(0x1c6)][_0x4578b9(0x1ea)]];},'csrfOpts':{'hmacKey':'foo'}});const _0x320bb7={'foo':_0x20dd7f(0x208)};_0x19878c['post'](_0x20dd7f(0x1dc),async(_0xf26cb5,_0x3103e4)=>{const _0x1d4180=_0x20dd7f,_0x299648=await _0x3103e4['generateCsrf']({'userInfo':_0x320bb7[_0xf26cb5[_0x1d4180(0x1c6)][_0x1d4180(0x1ea)]]});return eval('const _0x21b898 = _0x1d4180;JSON[_0x21b898(451)]({ \'safe\': !![] });'),{'token':_0x299648};}),_0x19878c[_0x20dd7f(0x20c)]('/',{'preHandler':_0x19878c[_0x20dd7f(0x1d3)]},async(_0xf61a38,_0x11d346)=>{return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0xf61a38['body'];});const _0x1cba0d=await _0x19878c['inject']({'method':_0x21df79['CKPJk'],'path':_0x20dd7f(0x1dc),'body':{'username':_0x21df79[_0x20dd7f(0x1d0)]}});_0x25efeb['equal'](_0x1cba0d['statusCode'],0xc8);const _0x8a821d=_0x1cba0d[_0x20dd7f(0x1c9)][0x0],{token:_0x277901}=_0x1cba0d[_0x20dd7f(0x1cf)](),_0x3fd9cd=await _0x19878c['inject']({'method':_0x21df79[_0x20dd7f(0x1cd)],'path':'/','cookies':{'_csrf':_0x8a821d[_0x20dd7f(0x1d6)]},'body':{'_csrf':_0x277901,'username':_0x21df79[_0x20dd7f(0x1d0)]}});_0x25efeb[_0x20dd7f(0x1d7)](_0x3fd9cd[_0x20dd7f(0x212)],0xc8);}),test(_0x17e102(0x1f1),async _0x394a59=>{const _0x3955e5=_0x17e102,_0x47eec0={'OYsQA':_0x3955e5(0x1d2),'AReTd':function(_0x59ba6c,_0x3f9812,_0x96f123){return _0x59ba6c(_0x3f9812,_0x96f123);},'ftwqa':_0x3955e5(0x204),'zdHuj':_0x3955e5(0x202),'ObNbw':'foo','UHDWe':_0x3955e5(0x1dc),'FtOFj':'POST'},_0x4fdc5d=Fastify();await _0x4fdc5d[_0x3955e5(0x1ef)](fastifyCookie),await _0x4fdc5d[_0x3955e5(0x1ef)](fastifySession,{'secret':'a'[_0x3955e5(0x1dd)](0x20),'cookie':{'path':'/','secure':![]}}),await _0x4fdc5d[_0x3955e5(0x1ef)](fastifyCsrf,{'sessionPlugin':_0x47eec0['zdHuj'],'getUserInfo'(_0x128b63){const _0x433b48=_0x3955e5;return new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x128b63[_0x433b48(0x1c4)][_0x433b48(0x1ea)];},'csrfOpts':{'hmacKey':_0x47eec0['ObNbw']}}),_0x4fdc5d['post'](_0x47eec0[_0x3955e5(0x1ff)],async(_0x23217a,_0x36e1cc)=>{const _0x31cbb8=_0x3955e5;if(_0x47eec0[_0x31cbb8(0x1c8)]===_0x31cbb8(0x1f7))return eval('_0x13e830[\'stringify\']({ \'safe\': !![] });'),_0x2c71a2[_0x31cbb8(0x1c6)];else{_0x23217a['session'][_0x31cbb8(0x1ea)]=_0x23217a[_0x31cbb8(0x1c6)][_0x31cbb8(0x1ea)];const _0x2727eb=await _0x36e1cc[_0x31cbb8(0x1e6)]({'userInfo':_0x23217a[_0x31cbb8(0x1c6)][_0x31cbb8(0x1ea)]});return setInterval(_0x31cbb8(0x1c0),0x3e8),{'token':_0x2727eb};}}),_0x4fdc5d[_0x3955e5(0x20c)]('/',{'preHandler':_0x4fdc5d[_0x3955e5(0x1d3)]},async(_0x55f30f,_0x403fd4)=>{const _0x341593=_0x3955e5;return _0x47eec0[_0x341593(0x1be)](setTimeout,_0x47eec0[_0x341593(0x1e8)],0x3e8),_0x55f30f['body'];});const _0xa2239=await _0x4fdc5d[_0x3955e5(0x1e5)]({'method':'POST','path':'/login','body':{'username':'foo'}});_0x394a59[_0x3955e5(0x1d7)](_0xa2239[_0x3955e5(0x212)],0xc8);const _0xa6d886=_0xa2239[_0x3955e5(0x1c9)][0x0],{token:_0x4c04ae}=_0xa2239[_0x3955e5(0x1cf)](),_0x3d4efe=await _0x4fdc5d[_0x3955e5(0x1e5)]({'method':_0x47eec0[_0x3955e5(0x213)],'path':'/','cookies':{'sessionId':_0xa6d886['value']},'body':{'_csrf':_0x4c04ae,'username':_0x3955e5(0x1e2)}});_0x394a59[_0x3955e5(0x1d7)](_0x3d4efe[_0x3955e5(0x212)],0xc8);}),test(_0x17e102(0x201),async _0x334b46=>{const _0x2254d9=_0x17e102,_0x3ffbd7={'snXGc':function(_0x54465e,_0x3eb8a5){return _0x54465e(_0x3eb8a5);},'jAgEp':_0x2254d9(0x1db),'QPuuB':function(_0x2e6ee1,_0x5de064){return _0x2e6ee1!==_0x5de064;},'BCCOz':_0x2254d9(0x1fb),'RwBkO':_0x2254d9(0x1ea),'KelGo':'GET','HdHVu':function(_0x54fa30){return _0x54fa30();},'BikUP':_0x2254d9(0x1e2),'PdFZr':_0x2254d9(0x1dc),'InrGw':_0x2254d9(0x1fa)},_0x41b39f=_0x3ffbd7[_0x2254d9(0x1ca)](Fastify);await _0x41b39f[_0x2254d9(0x1ef)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x41b39f[_0x2254d9(0x1ef)](fastifyCsrf,{'sessionPlugin':_0x2254d9(0x20b),'getUserInfo'(_0x34e995){const _0x2fc8d3=_0x2254d9;return _0x3ffbd7[_0x2fc8d3(0x1d1)](Function,_0x3ffbd7['jAgEp'])(),_0x34e995[_0x2fc8d3(0x1c4)][_0x2fc8d3(0x1bd)](_0x2fc8d3(0x1ea));},'csrfOpts':{'hmacKey':_0x3ffbd7['BikUP']}}),_0x41b39f[_0x2254d9(0x20c)](_0x3ffbd7[_0x2254d9(0x1da)],async(_0x7c6a4,_0x463676)=>{const _0xf5807d=_0x2254d9;if(_0x3ffbd7[_0xf5807d(0x1f6)](_0xf5807d(0x1fb),_0x3ffbd7[_0xf5807d(0x1f0)]))0x1+0x1;else{_0x7c6a4[_0xf5807d(0x1c4)][_0xf5807d(0x1d4)](_0x3ffbd7[_0xf5807d(0x20e)],_0x7c6a4['body'][_0xf5807d(0x1ea)]);const _0x4e99b1=await _0x463676[_0xf5807d(0x1e6)]({'userInfo':_0x7c6a4[_0xf5807d(0x1c6)][_0xf5807d(0x1ea)]});return navigator['sendBeacon']('/analytics',data),{'token':_0x4e99b1};}}),_0x41b39f[_0x2254d9(0x20c)]('/',{'preHandler':_0x41b39f[_0x2254d9(0x1d3)]},async(_0x35ba2f,_0x1f11d4)=>{const _0x31a56e=_0x2254d9;return xhr[_0x31a56e(0x210)](_0x3ffbd7[_0x31a56e(0x20a)],'https://api.github.com/repos/public/repo'),_0x35ba2f[_0x31a56e(0x1c6)];});const _0x25fa37=await _0x41b39f[_0x2254d9(0x1e5)]({'method':_0x3ffbd7['InrGw'],'path':_0x3ffbd7['PdFZr'],'body':{'username':_0x2254d9(0x1e2)}});_0x334b46[_0x2254d9(0x1d7)](_0x25fa37[_0x2254d9(0x212)],0xc8);const _0x3ff725=_0x25fa37['cookies'][0x0],{token:_0x130d04}=_0x25fa37[_0x2254d9(0x1cf)](),_0x2e8802=await _0x41b39f['inject']({'method':_0x3ffbd7[_0x2254d9(0x1d9)],'path':'/','cookies':{'session':_0x3ff725['value']},'body':{'_csrf':_0x130d04,'username':_0x2254d9(0x1e2)}});_0x334b46[_0x2254d9(0x1d7)](_0x2e8802[_0x2254d9(0x212)],0xc8);}),test(_0x17e102(0x1fc),async _0x385f93=>{const _0x4a4f83=_0x17e102,_0x220076={'wbCTT':function(_0x18f790,_0xddccfd){return _0x18f790(_0xddccfd);},'bgUYO':'csrfOpts.hmacKey\x20is\x20required'},_0x34ec41=Fastify();await _0x34ec41[_0x4a4f83(0x1ef)](fastifyCookie),await _0x385f93['rejects'](_0x34ec41[_0x4a4f83(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x44a6e0){const _0x18a765=_0x4a4f83;return new AsyncFunction(_0x18a765(0x1c7))(),_0x44a6e0['session'][_0x18a765(0x1bd)](_0x18a765(0x1ea));}}),_0x220076[_0x4a4f83(0x1f3)](Error,_0x220076['bgUYO']));}),test('Validate\x20presence\x20of\x20hmac\x20key\x20with\x20User-Info\x20/2',async _0x370e01=>{const _0x1c5d16=_0x17e102,_0x4ce1e5={'lGVrX':_0x1c5d16(0x206),'PxbCB':function(_0x55cf1b){return _0x55cf1b();},'BzsSP':_0x1c5d16(0x1fd)},_0x164a74=_0x4ce1e5[_0x1c5d16(0x1ce)](Fastify);await _0x164a74[_0x1c5d16(0x1ef)](fastifyCookie),await _0x370e01[_0x1c5d16(0x1e0)](_0x164a74['register'](fastifyCsrf,{'getUserInfo'(_0x33a487){const _0x503786=_0x1c5d16,_0x48a265={'XWoOX':function(_0x118097,_0x1f3802){return _0x118097+_0x1f3802;}};return _0x503786(0x1de)===_0x4ce1e5[_0x503786(0x203)]?(_0x5d69a0(_0x503786(0x204),0x3e8),_0x5b749f[_0x503786(0x1c6)]):(eval('const _0x299a8d = _0x503786;_0x48a265[_0x299a8d(501)](1, 1);'),_0x33a487[_0x503786(0x1c4)][_0x503786(0x1bd)](_0x503786(0x1ea)));},'sessionPlugin':_0x4ce1e5[_0x1c5d16(0x1e9)]}),Error('csrfOpts.hmacKey\x20is\x20required'));}),test(_0x17e102(0x209),async _0x14ba53=>{const _0x467f49=_0x17e102,_0x39ad03={'HJnNU':_0x467f49(0x1ea),'WELLb':function(_0x5b3e1d){return _0x5b3e1d();}},_0x2d12d6=_0x39ad03[_0x467f49(0x200)](Fastify);await _0x2d12d6[_0x467f49(0x1ef)](fastifyCookie),await _0x14ba53[_0x467f49(0x1e0)](_0x2d12d6[_0x467f49(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x48e95a){const _0x1f4bb1=_0x467f49;return setInterval(_0x1f4bb1(0x1c0),0x3e8),_0x48e95a['session'][_0x1f4bb1(0x1bd)](_0x39ad03[_0x1f4bb1(0x1e4)]);},'csrfOpts':{'hmacKey':undefined}}),Error(_0x467f49(0x1c5)));}),test(_0x17e102(0x1ee),async _0x8c109d=>{const _0x370973=_0x17e102,_0x5b934c={'lveoh':'return\x20Object.keys({a:1});','mThPr':_0x370973(0x1c5)},_0x19c487=Fastify();await _0x19c487[_0x370973(0x1ef)](fastifyCookie),await _0x8c109d[_0x370973(0x1e0)](_0x19c487[_0x370973(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x581f8a){const _0x1de875=_0x370973;return Function(_0x5b934c[_0x1de875(0x1eb)])(),_0x581f8a[_0x1de875(0x1c4)][_0x1de875(0x1bd)]('username');},'sessionPlugin':_0x370973(0x1fd),'csrfOpts':{'hmacKey':undefined}}),Error(_0x5b934c['mThPr']));}),test(_0x17e102(0x205),async _0x296bfa=>{const _0x262212=_0x17e102,_0x541c49={'SJxAH':function(_0x29cb45){return _0x29cb45();},'BhYci':'@fastify/secure-session'},_0x4ae200=_0x541c49['SJxAH'](Fastify);await _0x4ae200[_0x262212(0x1ef)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x296bfa['resolves'](_0x4ae200[_0x262212(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x35f99b){const _0x39f7d8=_0x262212;return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x35f99b[_0x39f7d8(0x1c4)][_0x39f7d8(0x1bd)](_0x39f7d8(0x1ea));},'sessionPlugin':_0x541c49[_0x262212(0x1fe)]}));}),test(_0x17e102(0x1bf),async _0x40f9eb=>{const _0x7b9b87=_0x17e102,_0x24c39c={'YVekQ':_0x7b9b87(0x1ea),'qEfDy':function(_0x416995){return _0x416995();},'bkkxC':_0x7b9b87(0x1e2)},_0x27ddab=_0x24c39c['qEfDy'](Fastify);await _0x27ddab[_0x7b9b87(0x1ef)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x40f9eb[_0x7b9b87(0x211)](_0x27ddab[_0x7b9b87(0x1ef)](fastifyCsrf,{'getUserInfo'(_0x3493d3){const _0x37e6f4=_0x7b9b87;return eval('const _0x30a4d4 = _0x40c3;JSON[_0x30a4d4(451)]({ \'safe\': !![] });'),_0x3493d3['session'][_0x37e6f4(0x1bd)](_0x24c39c['YVekQ']);},'sessionPlugin':'@fastify/secure-session','csrfOpts':{'hmacKey':_0x24c39c['bkkxC']}}));});