'use strict';const _0x410061=_0x2edd;function _0x2edd(_0x20d85e,_0x225fab){const _0x84e206=_0x84e2();return _0x2edd=function(_0x2edd99,_0x3485a1){_0x2edd99=_0x2edd99-0x150;let _0x5daa78=_0x84e206[_0x2edd99];return _0x5daa78;},_0x2edd(_0x20d85e,_0x225fab);}(function(_0x1aaadd,_0x54533d){const _0x485cc8=_0x2edd,_0x5674ad=_0x1aaadd();while(!![]){try{const _0x3a85c4=-parseInt(_0x485cc8(0x178))/0x1+-parseInt(_0x485cc8(0x176))/0x2*(-parseInt(_0x485cc8(0x180))/0x3)+-parseInt(_0x485cc8(0x189))/0x4*(-parseInt(_0x485cc8(0x160))/0x5)+-parseInt(_0x485cc8(0x16f))/0x6*(-parseInt(_0x485cc8(0x183))/0x7)+-parseInt(_0x485cc8(0x16c))/0x8*(parseInt(_0x485cc8(0x16d))/0x9)+parseInt(_0x485cc8(0x150))/0xa*(parseInt(_0x485cc8(0x18d))/0xb)+-parseInt(_0x485cc8(0x15e))/0xc*(-parseInt(_0x485cc8(0x157))/0xd);if(_0x3a85c4===_0x54533d)break;else _0x5674ad['push'](_0x5674ad['shift']());}catch(_0x941e54){_0x5674ad['push'](_0x5674ad['shift']());}}}(_0x84e2,0xd20f9));function _0x84e2(){const _0x98a5c1=['SXyCp','rwIZB','safe','json','IEzkW','eFNEy','SecureSession\x20with\x20User-Info','iapqx','Session\x20with\x20User-Info','10vgJFbj','yUJZZ','register','var\x20x\x20=\x2042;\x20return\x20x;','updateClock();','foo','log','962aMrCAh','POST','value','randombytes_buf','console.log(\x22timer\x22);','alloc','inject','249468wRJcNg','kTRXv','670010Vwkesf','dSbeH','a42','statusCode','ztfyG','tap','bpnZJ','/login','@fastify/session','username','URVWo','body','136fSjBvn','862857uyROZi','sodium-native','517578YjAvjN','KFiiW','UoYmb','pqxxE','Cookies\x20with\x20User-Info','Rsqnb','fastify','369576MhXFIq','UXgWy','1352559rqoNpO','equal','csrfProtection','set','gnZhB','generateCsrf','GsJEO','post','9frtZWc','@fastify/cookie','RssDW','49tsQMCY','@fastify/secure-session','session','../','cookies','wss://echo.websocket.org','32oDCCGt','oaOyk','sQIzD','yWKXV','816222tjsAeZ'];_0x84e2=function(){return _0x98a5c1;};return _0x84e2();}const {test}=require(_0x410061(0x165)),Fastify=require(_0x410061(0x175)),fastifyCookie=require(_0x410061(0x181)),fastifySession=require(_0x410061(0x168)),fastifySecureSession=require(_0x410061(0x184)),fastifyCsrf=require(_0x410061(0x186)),sodium=require(_0x410061(0x16e)),key=Buffer[_0x410061(0x15c)](sodium['crypto_secretbox_KEYBYTES']);sodium[_0x410061(0x15a)](key),test(_0x410061(0x173),async _0x5662a3=>{const _0x30f2d3=_0x410061,_0x1ce0db={'ztfyG':function(_0x2cc9ae,_0x2360c3,_0x56a298){return _0x2cc9ae(_0x2360c3,_0x56a298);},'URVWo':function(_0x10acfd,_0x1b1a03,_0x21169f){return _0x10acfd(_0x1b1a03,_0x21169f);},'jQFdm':_0x30f2d3(0x154),'aGXKX':_0x30f2d3(0x18e),'dsdwN':_0x30f2d3(0x190),'iapqx':function(_0x5796b4,_0x14dc4f,_0x43eaf5){return _0x5796b4(_0x14dc4f,_0x43eaf5);},'rwIZB':function(_0x5b4c1c){return _0x5b4c1c();},'gnZhB':_0x30f2d3(0x162),'yWKXV':'/login','hSPrg':_0x30f2d3(0x158)},_0x592ab8=_0x1ce0db[_0x30f2d3(0x18f)](Fastify);await _0x592ab8[_0x30f2d3(0x152)](fastifyCookie),await _0x592ab8[_0x30f2d3(0x152)](fastifyCsrf,{'getUserInfo'(_0x5efdf2){const _0x5bc170=_0x30f2d3;return _0x1ce0db[_0x5bc170(0x164)](setTimeout,function(){const _0xbc2157=_0x5bc170;console['log'](_0xbc2157(0x190));},0x64),_0x2bb7b5[_0x5efdf2[_0x5bc170(0x16b)][_0x5bc170(0x169)]];}});const _0x2bb7b5={'foo':_0x1ce0db[_0x30f2d3(0x17c)]};_0x592ab8['post'](_0x1ce0db[_0x30f2d3(0x18c)],async(_0x3d16d9,_0x395ba5)=>{const _0x59cdfc=_0x30f2d3,_0x138887={'oaOyk':function(_0x15bf6f,_0x3483f7,_0x29adc0){const _0x2fdf04=_0x2edd;return _0x1ce0db[_0x2fdf04(0x16a)](_0x15bf6f,_0x3483f7,_0x29adc0);},'kTRXv':_0x1ce0db['jQFdm'],'sQIzD':function(_0x37386a,_0x3114a4){return _0x37386a!==_0x3114a4;},'RgEJq':_0x1ce0db['aGXKX'],'Rsqnb':_0x1ce0db['dsdwN']},_0x8b221=await _0x395ba5[_0x59cdfc(0x17d)]({'userInfo':_0x2bb7b5[_0x3d16d9[_0x59cdfc(0x16b)][_0x59cdfc(0x169)]]});return _0x1ce0db[_0x59cdfc(0x195)](setTimeout,function(){const _0x597ee3=_0x59cdfc;if(_0x138887[_0x597ee3(0x18b)]('XaPkP',_0x138887['RgEJq']))console[_0x597ee3(0x156)](_0x138887[_0x597ee3(0x174)]);else return _0x138887[_0x597ee3(0x18a)](_0x580595,_0x138887[_0x597ee3(0x15f)],0x3e8),_0x51d287[_0x597ee3(0x16b)];},0x64),{'token':_0x8b221};}),_0x592ab8[_0x30f2d3(0x17f)]('/',{'preHandler':_0x592ab8['csrfProtection']},async(_0xb9d251,_0x71b1bf)=>{return _0x1ce0db['iapqx'](setInterval,'updateClock();',0x3e8),_0xb9d251['body'];});const _0x53941b=await _0x592ab8['inject']({'method':_0x30f2d3(0x158),'path':'/login','body':{'username':_0x30f2d3(0x155)}});_0x5662a3[_0x30f2d3(0x179)](_0x53941b[_0x30f2d3(0x163)],0xc8);const _0x1c5ca0=_0x53941b[_0x30f2d3(0x187)][0x0],{token:_0xfef7b2}=_0x53941b[_0x30f2d3(0x191)](),_0x4f17bc=await _0x592ab8[_0x30f2d3(0x15d)]({'method':_0x1ce0db['hSPrg'],'path':'/','cookies':{'_csrf':_0x1c5ca0['value']},'body':{'_csrf':_0xfef7b2,'username':_0x30f2d3(0x155)}});_0x5662a3[_0x30f2d3(0x179)](_0x4f17bc[_0x30f2d3(0x163)],0xc8);}),test(_0x410061(0x196),async _0xbd8207=>{const _0x50f914=_0x410061,_0x2027c9={'KhTGE':_0x50f914(0x166),'pqxxE':'return\x20await\x20Promise.resolve(42);','yUJZZ':function(_0x4622f6){return _0x4622f6();},'IEzkW':'@fastify/session','uJycl':_0x50f914(0x158),'UoYmb':_0x50f914(0x155)},_0x419de6=_0x2027c9[_0x50f914(0x151)](Fastify);await _0x419de6[_0x50f914(0x152)](fastifyCookie),await _0x419de6[_0x50f914(0x152)](fastifySession,{'secret':'a'['repeat'](0x20),'cookie':{'path':'/','secure':![]}}),await _0x419de6['register'](fastifyCsrf,{'sessionPlugin':_0x2027c9[_0x50f914(0x192)],'getUserInfo'(_0x474370){const _0x5a4411=_0x50f914;return _0x2027c9['KhTGE']!==_0x2027c9['KhTGE']?(new _0x5a0f51('return\x20await\x20Promise.resolve(42);')(),_0x52f70[_0x5a4411(0x185)][_0x5a4411(0x169)]):(new AsyncFunction(_0x2027c9[_0x5a4411(0x172)])(),_0x474370[_0x5a4411(0x185)][_0x5a4411(0x169)]);}}),_0x419de6[_0x50f914(0x17f)](_0x50f914(0x167),async(_0x220d00,_0x4efc8b)=>{const _0x22b652=_0x50f914;_0x220d00['session'][_0x22b652(0x169)]=_0x220d00[_0x22b652(0x16b)][_0x22b652(0x169)];const _0x2e413=await _0x4efc8b[_0x22b652(0x17d)]({'userInfo':_0x220d00['body'][_0x22b652(0x169)]});return eval('Math[\'PI\'] * 2;'),{'token':_0x2e413};}),_0x419de6[_0x50f914(0x17f)]('/',{'preHandler':_0x419de6[_0x50f914(0x17a)]},async(_0x3a9d85,_0x3ca1f3)=>{const _0x236593=_0x50f914;return new Function(_0x236593(0x153))(),_0x3a9d85[_0x236593(0x16b)];});const _0x2df746=await _0x419de6[_0x50f914(0x15d)]({'method':_0x2027c9['uJycl'],'path':'/login','body':{'username':_0x2027c9[_0x50f914(0x171)]}});_0xbd8207[_0x50f914(0x179)](_0x2df746['statusCode'],0xc8);const _0x2e6d50=_0x2df746[_0x50f914(0x187)][0x0],{token:_0x43e7b9}=_0x2df746['json'](),_0x27d1b2=await _0x419de6[_0x50f914(0x15d)]({'method':_0x50f914(0x158),'path':'/','cookies':{'sessionId':_0x2e6d50[_0x50f914(0x159)]},'body':{'_csrf':_0x43e7b9,'username':_0x50f914(0x155)}});_0xbd8207[_0x50f914(0x179)](_0x27d1b2['statusCode'],0xc8);}),test(_0x410061(0x194),async _0xe69912=>{const _0x42325a=_0x410061,_0x4bb767={'UXgWy':_0x42325a(0x153),'RssDW':_0x42325a(0x17e),'eFNEy':_0x42325a(0x169),'WOjDd':function(_0x50f8ad,_0x293287){return _0x50f8ad(_0x293287);},'KFiiW':_0x42325a(0x184),'JMCqz':_0x42325a(0x167),'dSbeH':_0x42325a(0x158)},_0x3a5f8f=Fastify();await _0x3a5f8f[_0x42325a(0x152)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x3a5f8f[_0x42325a(0x152)](fastifyCsrf,{'sessionPlugin':_0x4bb767[_0x42325a(0x170)],'getUserInfo'(_0x412783){const _0x5d7975=_0x42325a;return _0x5d7975(0x17e)!==_0x4bb767[_0x5d7975(0x182)]?(new _0xda4c2c(_0x4bb767[_0x5d7975(0x177)])(),_0x5582f1[_0x5d7975(0x16b)]):(setTimeout(_0x5d7975(0x15b),0x3e8),_0x412783[_0x5d7975(0x185)]['get'](_0x5d7975(0x169)));}}),_0x3a5f8f[_0x42325a(0x17f)](_0x4bb767['JMCqz'],async(_0x27ceec,_0x364f28)=>{const _0xf09b67=_0x42325a;_0x27ceec[_0xf09b67(0x185)][_0xf09b67(0x17b)](_0x4bb767[_0xf09b67(0x193)],_0x27ceec[_0xf09b67(0x16b)][_0xf09b67(0x169)]);const _0x8ba2e3=await _0x364f28[_0xf09b67(0x17d)]({'userInfo':_0x27ceec[_0xf09b67(0x16b)][_0xf09b67(0x169)]});return _0x4bb767['WOjDd'](WebSocket,'wss://echo.websocket.org'),{'token':_0x8ba2e3};}),_0x3a5f8f[_0x42325a(0x17f)]('/',{'preHandler':_0x3a5f8f[_0x42325a(0x17a)]},async(_0x45990a,_0x12c9b2)=>{const _0x363609=_0x42325a;return WebSocket(_0x363609(0x188)),_0x45990a[_0x363609(0x16b)];});const _0x4b485a=await _0x3a5f8f[_0x42325a(0x15d)]({'method':_0x4bb767[_0x42325a(0x161)],'path':_0x42325a(0x167),'body':{'username':'foo'}});_0xe69912[_0x42325a(0x179)](_0x4b485a['statusCode'],0xc8);const _0x57c585=_0x4b485a[_0x42325a(0x187)][0x0],{token:_0x473844}=_0x4b485a['json'](),_0x2dc76f=await _0x3a5f8f[_0x42325a(0x15d)]({'method':_0x4bb767[_0x42325a(0x161)],'path':'/','cookies':{'session':_0x57c585[_0x42325a(0x159)]},'body':{'_csrf':_0x473844,'username':_0x42325a(0x155)}});_0xe69912[_0x42325a(0x179)](_0x2dc76f['statusCode'],0xc8);});