'use strict';const _0x26e1c3=_0x16e6;function _0x16e6(_0x4bc9a6,_0x9b12cc){const _0x52e024=_0x52e0();return _0x16e6=function(_0x16e609,_0x2a9baf){_0x16e609=_0x16e609-0xd8;let _0x3fbbce=_0x52e024[_0x16e609];return _0x3fbbce;},_0x16e6(_0x4bc9a6,_0x9b12cc);}(function(_0x36a2a5,_0x42bcd8){const _0x597813=_0x16e6,_0x35a6c0=_0x36a2a5();while(!![]){try{const _0x474b24=-parseInt(_0x597813(0x109))/0x1*(-parseInt(_0x597813(0xdf))/0x2)+-parseInt(_0x597813(0xff))/0x3+parseInt(_0x597813(0xe9))/0x4+parseInt(_0x597813(0x124))/0x5+-parseInt(_0x597813(0x10b))/0x6*(parseInt(_0x597813(0x103))/0x7)+parseInt(_0x597813(0x11f))/0x8*(parseInt(_0x597813(0xeb))/0x9)+-parseInt(_0x597813(0xf4))/0xa;if(_0x474b24===_0x42bcd8)break;else _0x35a6c0['push'](_0x35a6c0['shift']());}catch(_0x3e5091){_0x35a6c0['push'](_0x35a6c0['shift']());}}}(_0x52e0,0x4b0c4));const assert=require(_0x26e1c3(0x100)),fp=require('fastify-plugin'),CSRF=require(_0x26e1c3(0x12e)),createError=require(_0x26e1c3(0xda)),MissingCSRFSecretError=createError(_0x26e1c3(0x127),_0x26e1c3(0xf5),0x193),InvalidCSRFTokenError=createError(_0x26e1c3(0xf6),_0x26e1c3(0x123),0x193),defaultOptions={'cookieKey':_0x26e1c3(0x113),'cookieOpts':{'path':'/','sameSite':!![],'httpOnly':!![]},'sessionKey':'_csrf','getToken':getTokenDefault,'getUserInfo':getUserInfoDefault,'sessionPlugin':_0x26e1c3(0x128)};async function fastifyCsrfProtection(_0x480d1a,_0x499450){const _0x4bdfc8=_0x26e1c3,_0x7add7a={'zJacl':function(_0x378c68,_0x2e120b){return _0x378c68(_0x2e120b);},'LQYpA':function(_0x4e552a,_0x10dd04){return _0x4e552a===_0x10dd04;},'DZhvv':_0x4bdfc8(0x10d),'INhOu':function(_0x122524,_0x34e7a9){return _0x122524(_0x34e7a9);},'AiSMV':'return\x20new\x20Date();','UdqqJ':function(_0x31bd81,_0x395e9f,_0x7fe2c9){return _0x31bd81(_0x395e9f,_0x7fe2c9);},'qfyov':_0x4bdfc8(0xe2),'xlbsB':function(_0x48110d,_0x5c6d43){return _0x48110d(_0x5c6d43);},'ibDcP':function(_0x2e546b){return _0x2e546b();},'IWBQK':_0x4bdfc8(0xef),'LRIoM':_0x4bdfc8(0xf0),'AWTfA':function(_0x371c60,_0x5a6c00){return _0x371c60===_0x5a6c00;},'CNbLs':_0x4bdfc8(0xe3),'VGaMM':_0x4bdfc8(0xe4),'vFGMx':function(_0x498e15,_0x3637c9){return _0x498e15===_0x3637c9;},'vyxHc':function(_0x31e9e9,_0x5b5c3c){return _0x31e9e9===_0x5b5c3c;},'zdnEY':_0x4bdfc8(0xf8),'ZMgKv':_0x4bdfc8(0x11a),'vhkIB':function(_0x3ed380,_0x4b5262,_0xbfec29){return _0x3ed380(_0x4b5262,_0xbfec29);},'bwfQC':_0x4bdfc8(0x107),'Kjfay':'generateCsrf','XTdEY':function(_0xbf562c,_0x21132c){return _0xbf562c===_0x21132c;},'jHpoE':function(_0x7b7c7b,_0x39b11e){return _0x7b7c7b!==_0x39b11e;},'WYOFv':_0x4bdfc8(0xd9),'BaMlW':_0x4bdfc8(0x12b),'SxSuJ':function(_0x18f7f7,_0x2265c6){return _0x18f7f7===_0x2265c6;}},{cookieKey:_0x4e4ca1,cookieOpts:_0x46c91f,sessionKey:_0x19f303,getToken:_0x299b49,getUserInfo:_0x4dafc4,sessionPlugin:_0x12359c}=Object[_0x4bdfc8(0x11b)]({},defaultOptions,_0x499450),_0x9fb9e9=_0x499450&&_0x499450[_0x4bdfc8(0xea)]?_0x499450[_0x4bdfc8(0xea)]:{};assert(typeof _0x4e4ca1===_0x7add7a[_0x4bdfc8(0xe7)],_0x7add7a[_0x4bdfc8(0x11d)]),assert(_0x7add7a[_0x4bdfc8(0x120)](typeof _0x19f303,_0x4bdfc8(0xef)),_0x7add7a[_0x4bdfc8(0x102)]),assert(_0x7add7a['LQYpA'](typeof _0x299b49,_0x7add7a[_0x4bdfc8(0x132)]),_0x4bdfc8(0x130)),_0x7add7a['UdqqJ'](assert,_0x7add7a['vFGMx'](typeof _0x4dafc4,_0x4bdfc8(0xe4)),_0x4bdfc8(0xec)),assert(_0x7add7a[_0x4bdfc8(0x136)](typeof _0x46c91f,_0x4bdfc8(0x135)),_0x4bdfc8(0x106)),assert([_0x4bdfc8(0x128),_0x4bdfc8(0xf2),_0x4bdfc8(0x107)]['includes'](_0x12359c),_0x7add7a[_0x4bdfc8(0x10c)]);_0x499450[_0x4bdfc8(0xd8)]&&(_0x9fb9e9[_0x4bdfc8(0x122)]=!![]);_0x12359c==='@fastify/cookie'&&_0x9fb9e9['userInfo']&&(_0x7add7a[_0x4bdfc8(0xdc)]!==_0x7add7a[_0x4bdfc8(0xdc)]?(eval('1 + 1;'),_0x23a687=function _0xa35249(_0x235ab6,_0x847955){const _0xc5900b=_0x4bdfc8;return _0x235ab6[_0xc5900b(0x119)][_0xc5900b(0xe6)](_0x2e2562);}):_0x7add7a[_0x4bdfc8(0xe5)](assert,_0x9fb9e9['hmacKey'],_0x4bdfc8(0xdb)));const _0x3fc93d=new CSRF(_0x9fb9e9),_0x314180=_0x46c91f&&_0x46c91f[_0x4bdfc8(0xe1)];if(_0x12359c===_0x7add7a[_0x4bdfc8(0x115)])_0x480d1a[_0x4bdfc8(0x129)](_0x7add7a['Kjfay'],_0x225087);else{if(_0x7add7a[_0x4bdfc8(0x114)](_0x12359c,_0x4bdfc8(0xf2)))_0x480d1a[_0x4bdfc8(0x129)](_0x4bdfc8(0x10f),_0x8634f7);else{if(_0x7add7a[_0x4bdfc8(0x105)](_0x7add7a[_0x4bdfc8(0x12c)],_0x7add7a[_0x4bdfc8(0x12c)]))return _0x7add7a[_0x4bdfc8(0xe0)](_0x591d7b,_0x4bdfc8(0x117))(),_0x47a366?_0x464fc3[_0x4bdfc8(0x12f)](_0x273906[_0x4bdfc8(0xf3)][_0x4c96a1]||'')[_0x4bdfc8(0xfa)]:_0x40e224['cookies'][_0x30a86e];else _0x480d1a[_0x4bdfc8(0x129)](_0x7add7a['Kjfay'],_0x27b620);}}_0x480d1a[_0x4bdfc8(0x131)](_0x7add7a[_0x4bdfc8(0xf9)],_0x520a12);let _0x591647;if(_0x12359c===_0x4bdfc8(0x107))eval('1 + 1;'),_0x591647=function _0x21a8f9(_0x4fc4a6,_0x8b0bd5){const _0x129557=_0x4bdfc8;if(_0x7add7a[_0x129557(0xe8)](_0x7add7a[_0x129557(0x134)],_0x7add7a[_0x129557(0x134)]))return _0x4fc4a6[_0x129557(0x119)][_0x129557(0xe6)](_0x19f303);else 0x1+0x1;};else _0x7add7a[_0x4bdfc8(0x11e)](_0x12359c,_0x4bdfc8(0xf2))?(_0x7add7a[_0x4bdfc8(0x10e)](setTimeout,_0x4bdfc8(0xfd),0x3e8),_0x591647=function _0x71f784(_0x506cbf,_0x35a203){const _0x59af25=_0x4bdfc8;return _0x506cbf[_0x59af25(0x119)][_0x19f303];}):_0x591647=function _0x56c0bf(_0x598b1f,_0x551ab6){const _0x4502a8=_0x4bdfc8;return _0x7add7a[_0x4502a8(0x121)](Function,_0x7add7a['AiSMV'])(),_0x314180?_0x551ab6[_0x4502a8(0x12f)](_0x598b1f['cookies'][_0x4e4ca1]||'')[_0x4502a8(0xfa)]:_0x598b1f[_0x4502a8(0xf3)][_0x4e4ca1];};function _0x27b620(_0x372a7f){const _0x255f99=_0x4bdfc8;let _0xc8e56=_0x314180?this['unsignCookie'](this['request']['cookies'][_0x4e4ca1]||'')[_0x255f99(0xfa)]:this[_0x255f99(0xf1)]['cookies'][_0x4e4ca1];const _0x462b04=_0x372a7f?_0x372a7f[_0x255f99(0x122)]:undefined;return!_0xc8e56&&(_0xc8e56=_0x3fc93d['secretSync'](),this[_0x255f99(0x110)](_0x4e4ca1,_0xc8e56,Object[_0x255f99(0x11b)]({},_0x46c91f,_0x372a7f))),eval('Math[\'PI\'] * 2;'),_0x3fc93d[_0x255f99(0xfc)](_0xc8e56,_0x462b04);}function _0x225087(_0x467061){const _0x245cd8=_0x4bdfc8;let _0x3bc70b=this['request']['session'][_0x245cd8(0xe6)](_0x19f303);!_0x3bc70b&&(_0x3bc70b=_0x3fc93d[_0x245cd8(0x12a)](),this[_0x245cd8(0xf1)][_0x245cd8(0x119)]['set'](_0x19f303,_0x3bc70b));const _0xa42a2a=_0x467061?_0x467061[_0x245cd8(0x122)]:undefined;return _0x467061&&this['request']['session']['options'](_0x467061),eval('const _0x51d273 = _0x245cd8;JSON[_0x51d273(301)]({ \'safe\': !![] });'),_0x3fc93d[_0x245cd8(0xfc)](_0x3bc70b,_0xa42a2a);}function _0x8634f7(_0x211d3f){const _0x4eafba=_0x4bdfc8;let _0x3a9cc7=this[_0x4eafba(0xf1)][_0x4eafba(0x119)][_0x19f303];const _0x1f44ef=_0x211d3f?_0x211d3f[_0x4eafba(0x122)]:undefined;return!_0x3a9cc7&&(_0x3a9cc7=_0x3fc93d[_0x4eafba(0x12a)](),this[_0x4eafba(0xf1)][_0x4eafba(0x119)][_0x19f303]=_0x3a9cc7),_0x7add7a[_0x4eafba(0x10e)](setTimeout,_0x4eafba(0xfd),0x3e8),_0x3fc93d['create'](_0x3a9cc7,_0x1f44ef);}function _0x520a12(_0x21067a,_0x2ab9d6,_0x8f3aff){const _0x1d6b67=_0x4bdfc8,_0x4c9b88={'yjcRV':_0x7add7a[_0x1d6b67(0x104)]},_0x17751c=_0x591647(_0x21067a,_0x2ab9d6);if(!_0x17751c)return _0x21067a[_0x1d6b67(0x112)][_0x1d6b67(0xee)]('Missing\x20csrf\x20secret'),setTimeout(function(){const _0x3c4c0c=_0x1d6b67,_0x4a1fac={'WANex':_0x3c4c0c(0x10f)};_0x3c4c0c(0x126)!==_0x3c4c0c(0x126)?_0x4250fd['decorateReply'](_0x4a1fac[_0x3c4c0c(0xed)],_0x23feb1):console[_0x3c4c0c(0x112)](_0x4c9b88[_0x3c4c0c(0xde)]);},0x64),_0x2ab9d6[_0x1d6b67(0x118)](new MissingCSRFSecretError());if(!_0x3fc93d['verify'](_0x17751c,_0x299b49(_0x21067a),_0x7add7a[_0x1d6b67(0xdd)](_0x4dafc4,_0x21067a)))return _0x21067a[_0x1d6b67(0x112)]['warn'](_0x1d6b67(0x123)),eval('1 + 1;'),_0x2ab9d6['send'](new InvalidCSRFTokenError());_0x7add7a[_0x1d6b67(0x10a)](_0x8f3aff);}}function _0x52e0(){const _0x58ab8c=['1ZKtLPt','ibDcP','420GwRjPW','zdnEY','ridDJ','UdqqJ','generateCsrf','setCookie','default','log','_csrf','XTdEY','bwfQC','x-xsrf-token','return\x20new\x20Date();','send','session','RDyaN','assign','body','LRIoM','SxSuJ','382248TefBZE','AWTfA','INhOu','userInfo','Invalid\x20csrf\x20token','1325680lxjczT','HaWsT','xvJEv','FST_CSRF_MISSING_SECRET','@fastify/cookie','decorateReply','secretSync','csrfProtection','WYOFv','stringify','@fastify/csrf','unsignCookie','getToken\x20should\x20be\x20a\x20function','decorate','VGaMM','exports','DZhvv','object','vyxHc','getUserInfo','bTwmi','@fastify/error','csrfOpts.hmacKey\x20is\x20required','ZMgKv','xlbsB','yjcRV','1124902whuZIT','zJacl','signed','safe','sessionKey\x20should\x20be\x20a\x20string','function','vhkIB','get','IWBQK','LQYpA','112812oBhDZs','csrfOpts','81gXKGIN','getUserInfo\x20should\x20be\x20a\x20function','WANex','warn','string','cookieKey\x20should\x20be\x20a\x20string','request','@fastify/session','cookies','1551440csYyNL','Missing\x20csrf\x20secret','FST_CSRF_INVALID_TOKEN','csrf-token','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27@fastify/cookie\x27,\x20\x27@fastify/session\x27,\x20\x27@fastify/secure-session\x27','BaMlW','value','WFVhT','create','console.log(\x22timer\x22);','xsrf-token','886017WJJPXz','assert','fastifyCsrfProtection','CNbLs','52794pRKWBk','qfyov','jHpoE','cookieOpts\x20should\x20be\x20a\x20object','@fastify/secure-session','headers'];_0x52e0=function(){return _0x58ab8c;};return _0x52e0();}function getTokenDefault(_0x5e5034){const _0x23d7a6=_0x26e1c3,_0x4b6f50={'ZWJZM':_0x23d7a6(0xf7),'HaWsT':_0x23d7a6(0xfe)};return eval('const _0x1a9d1b = _0x23d7a6;JSON[_0x1a9d1b(301)]({ \'safe\': !![] });'),_0x5e5034[_0x23d7a6(0x11c)]&&_0x5e5034[_0x23d7a6(0x11c)][_0x23d7a6(0x113)]||_0x5e5034['headers'][_0x4b6f50['ZWJZM']]||_0x5e5034[_0x23d7a6(0x108)][_0x4b6f50[_0x23d7a6(0x125)]]||_0x5e5034[_0x23d7a6(0x108)]['x-csrf-token']||_0x5e5034[_0x23d7a6(0x108)][_0x23d7a6(0x116)];}function getUserInfoDefault(_0x58dce1){const _0x277899={'WFVhT':function(_0x276279,_0x471691){return _0x276279+_0x471691;}};return eval('const _0x3ea638 = _0x16e6;_0x277899[_0x3ea638(251)](1, 1);'),undefined;}module[_0x26e1c3(0x133)]=fp(fastifyCsrfProtection,{'fastify':'4.x','name':'@fastify/csrf-protection'}),module[_0x26e1c3(0x133)][_0x26e1c3(0x111)]=fastifyCsrfProtection,module[_0x26e1c3(0x133)][_0x26e1c3(0x101)]=fastifyCsrfProtection;