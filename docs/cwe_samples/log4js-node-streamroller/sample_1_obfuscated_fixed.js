'use strict';const _0x5dc4a6=_0x3245;(function(_0x4c6db7,_0x533f93){const _0x521caa=_0x3245,_0x321837=_0x4c6db7();while(!![]){try{const _0x2405be=parseInt(_0x521caa(0x98))/0x1+-parseInt(_0x521caa(0xbc))/0x2+parseInt(_0x521caa(0xb6))/0x3+-parseInt(_0x521caa(0x88))/0x4+-parseInt(_0x521caa(0x86))/0x5*(parseInt(_0x521caa(0xd6))/0x6)+parseInt(_0x521caa(0x97))/0x7*(parseInt(_0x521caa(0xaa))/0x8)+-parseInt(_0x521caa(0xa3))/0x9*(-parseInt(_0x521caa(0x94))/0xa);if(_0x2405be===_0x533f93)break;else _0x321837['push'](_0x321837['shift']());}catch(_0x52277b){_0x321837['push'](_0x321837['shift']());}}}(_0x1d17,0xe8491));const assert=require(_0x5dc4a6(0x8f)),request=require(_0x5dc4a6(0x84)),context=require('../../test-helpers/context'),Koa=require(_0x5dc4a6(0xa9));describe('ctx.redirect(url)',()=>{const _0x4fdda6=_0x5dc4a6,_0x312fce={'ZzbBw':function(_0x1b17df){return _0x1b17df();},'jhtCQ':_0x4fdda6(0x9d),'WPapA':_0x4fdda6(0xba),'DxcHE':_0x4fdda6(0xbd),'qcLSW':_0x4fdda6(0xd2),'HBtOu':function(_0x51f709){return _0x51f709();},'mSkve':_0x4fdda6(0xac),'ZQjqO':function(_0x3d527b){return _0x3d527b();},'mBmjZ':_0x4fdda6(0x85),'OcVHi':'back','sOGuU':function(_0x5ba7fd,_0x47663f,_0x24953b){return _0x5ba7fd(_0x47663f,_0x24953b);},'yFvnj':'should\x20redirect\x20to\x20Referrer','SrdAI':function(_0x27cd57,_0x22b57e,_0x4532a8){return _0x27cd57(_0x22b57e,_0x4532a8);},'ONfzx':'should\x20default\x20to\x20alt','JOisq':_0x4fdda6(0xce),'hhOso':'<script>','YeOqq':function(_0x1804e7,_0x5bcc77){return _0x1804e7(_0x5bcc77);},'ZyCkm':'should\x20escape\x20the\x20url','vIFqj':function(_0x359061,_0x50c4f5,_0x1c6abe){return _0x359061(_0x50c4f5,_0x1c6abe);},'UAswp':_0x4fdda6(0xd7),'PpQpK':_0x4fdda6(0xb8),'PEYSq':function(_0x2e9034,_0x24c1b0,_0x16df54){return _0x2e9034(_0x24c1b0,_0x16df54);},'kaKIg':function(_0x9afee1){return _0x9afee1();},'flbgt':_0x4fdda6(0xd0),'kuybU':_0x4fdda6(0xc7),'yoeyg':function(_0x1ee257,_0x438d23,_0x728e21){return _0x1ee257(_0x438d23,_0x728e21);},'Pikob':_0x4fdda6(0xb3),'vIwXL':function(_0x40c6aa,_0x445178,_0x1e522a){return _0x40c6aa(_0x445178,_0x1e522a);},'KYUri':function(_0xa015d8,_0x2a1253,_0x31289c){return _0xa015d8(_0x2a1253,_0x31289c);},'OQGCK':'when\x20content-type\x20was\x20present'};_0x312fce[_0x4fdda6(0xad)](it,_0x312fce['flbgt'],()=>{const _0xc944ec=_0x4fdda6,_0x482eeb=_0x312fce['ZzbBw'](context);_0x482eeb[_0xc944ec(0xd4)](_0xc944ec(0xb8)),assert['strictEqual'](_0x482eeb[_0xc944ec(0xa0)][_0xc944ec(0xb2)][_0xc944ec(0xa4)],_0x312fce[_0xc944ec(0xc8)]),assert[_0xc944ec(0xa2)](_0x482eeb[_0xc944ec(0x8e)],0x12e);}),it(_0x312fce['kuybU'],()=>{const _0x9a47a5=_0x4fdda6,_0x32ca34=context();_0x32ca34[_0x9a47a5(0xd4)](_0x9a47a5(0xc5)),assert[_0x9a47a5(0xa2)](_0x32ca34['response'][_0x9a47a5(0xb2)][_0x9a47a5(0xa4)],_0x312fce[_0x9a47a5(0xb1)]),assert['strictEqual'](_0x32ca34['status'],0x12e);}),it(_0x4fdda6(0xbb),_0xa6f1c0=>{const _0x1521e8=_0x4fdda6,_0x1a6653={'oiAvX':function(_0x590a5a){return _0x590a5a();}};if(_0x312fce['DxcHE']!==_0x312fce['qcLSW']){const _0x1eb470=new Koa();_0x1eb470[_0x1521e8(0xaf)](_0x2eb3e2=>{const _0x1612f8=_0x1521e8;_0x2eb3e2[_0x1612f8(0xd4)](_0x1612f8(0xc6));}),request(_0x1eb470['callback']())['get']('/')[_0x1521e8(0xcf)]((_0x5ea02b,_0x4d5a30)=>{const _0x525030=_0x1521e8;if(_0x5ea02b)return _0xa6f1c0(_0x5ea02b);assert[_0x525030(0xa2)](_0x4d5a30[_0x525030(0x8e)],0x12e),assert[_0x525030(0xa2)](_0x4d5a30['headers'][_0x525030(0xa4)],'http://google.com/%F0%9F%98%93'),_0x1a6653['oiAvX'](_0xa6f1c0);});}else{const _0x11ae80=_0x54baa3(),_0x200c03=_0x1521e8(0xb8);_0x11ae80[_0x1521e8(0x8e)]=0x12d,_0x11ae80['header'][_0x1521e8(0x91)]=_0x1521e8(0xc3),_0x11ae80[_0x1521e8(0xd4)]('http://google.com'),_0x5b5f01[_0x1521e8(0xa2)](_0x11ae80[_0x1521e8(0x8e)],0x12d),_0x1025f6[_0x1521e8(0xa2)](_0x11ae80[_0x1521e8(0xd8)],'Redirecting\x20to\x20'+_0x200c03+'/.');}}),_0x312fce[_0x4fdda6(0xc2)](describe,'with\x20\x22back\x22',()=>{const _0xad184=_0x4fdda6;_0x312fce['sOGuU'](it,_0x312fce[_0xad184(0xca)],()=>{const _0x5bef47=_0xad184,_0x5460ba=_0x312fce['HBtOu'](context);_0x5460ba[_0x5bef47(0xbe)][_0x5bef47(0x8c)]['referrer']=_0x312fce['mSkve'],_0x5460ba[_0x5bef47(0xd4)](_0x5bef47(0xc0)),assert[_0x5bef47(0xa2)](_0x5460ba['response'][_0x5bef47(0xb2)]['location'],_0x312fce[_0x5bef47(0xb5)]);}),_0x312fce[_0xad184(0xd5)](it,'should\x20redirect\x20to\x20Referer',()=>{const _0x2f622f=_0xad184,_0x5f11ef=_0x312fce[_0x2f622f(0x90)](context);_0x5f11ef[_0x2f622f(0xbe)][_0x2f622f(0x8c)][_0x2f622f(0xcd)]=_0x312fce[_0x2f622f(0xb5)],_0x5f11ef[_0x2f622f(0xd4)]('back'),assert[_0x2f622f(0xa2)](_0x5f11ef[_0x2f622f(0xa0)]['header'][_0x2f622f(0xa4)],'/login');}),it(_0x312fce['ONfzx'],()=>{const _0x1ca992=_0xad184,_0x5ad8c5=_0x312fce[_0x1ca992(0x83)](context);_0x5ad8c5['redirect'](_0x1ca992(0xc0),_0x312fce['mBmjZ']),assert[_0x1ca992(0xa2)](_0x5ad8c5[_0x1ca992(0xa0)][_0x1ca992(0xb2)][_0x1ca992(0xa4)],_0x1ca992(0x85));}),it(_0xad184(0x87),()=>{const _0x339006=_0xad184,_0x4ba6d8=context();_0x4ba6d8[_0x339006(0xd4)](_0x312fce[_0x339006(0x95)]),assert['strictEqual'](_0x4ba6d8[_0x339006(0xa0)][_0x339006(0xb2)][_0x339006(0xa4)],'/');});}),describe(_0x312fce[_0x4fdda6(0xa6)],()=>{const _0x33dce8=_0x4fdda6,_0x135981={'rbfxK':function(_0x3036fc){return _0x3036fc();},'vEAVz':_0x312fce[_0x33dce8(0xc8)],'nLXLV':_0x33dce8(0x92),'xESvs':_0x312fce[_0x33dce8(0xc9)],'ixBCf':_0x312fce[_0x33dce8(0x9c)],'qXzBv':function(_0x1aec0a,_0x514c97){const _0x38c86b=_0x33dce8;return _0x312fce[_0x38c86b(0xb9)](_0x1aec0a,_0x514c97);}};_0x312fce[_0x33dce8(0xd5)](it,_0x33dce8(0xab),()=>{const _0x1adead=_0x33dce8,_0x1950a2=_0x135981[_0x1adead(0xa8)](context),_0x13c00c=_0x135981[_0x1adead(0x9a)];_0x1950a2['header'][_0x1adead(0x91)]=_0x135981['nLXLV'],_0x1950a2[_0x1adead(0xd4)](_0x13c00c),assert['strictEqual'](_0x1950a2[_0x1adead(0xa0)][_0x1adead(0xb2)][_0x135981['xESvs']],_0x1adead(0x8d)),assert[_0x1adead(0xa2)](_0x1950a2['body'],_0x1adead(0x8b)+_0x13c00c+'\x22>'+_0x13c00c+'</a>.');}),_0x312fce['sOGuU'](it,_0x312fce[_0x33dce8(0xcc)],()=>{const _0x561b38=_0x33dce8,_0x287720=_0x135981[_0x561b38(0xa8)](context);let _0x1b58b0=_0x135981['ixBCf'];_0x287720['header'][_0x561b38(0x91)]=_0x561b38(0x92),_0x287720[_0x561b38(0xd4)](_0x1b58b0),_0x1b58b0=_0x135981[_0x561b38(0xcb)](escape,_0x1b58b0),assert['strictEqual'](_0x287720[_0x561b38(0xa0)][_0x561b38(0xb2)][_0x561b38(0xce)],_0x561b38(0x8d)),assert[_0x561b38(0xa2)](_0x287720[_0x561b38(0xd8)],_0x561b38(0x8b)+_0x1b58b0+'\x22>'+_0x1b58b0+_0x561b38(0x9e));});}),_0x312fce[_0x4fdda6(0xc4)](describe,_0x4fdda6(0xb0),()=>{const _0x5645b6=_0x4fdda6;_0x312fce[_0x5645b6(0x9f)](it,_0x5645b6(0x9b),()=>{const _0xba7031=_0x5645b6,_0x5f3e6a=context(),_0x5c466d='http://google.com';_0x5f3e6a['header'][_0xba7031(0x91)]=_0xba7031(0xc3),_0x5f3e6a[_0xba7031(0xd4)](_0x5c466d),assert[_0xba7031(0xa2)](_0x5f3e6a[_0xba7031(0xd8)],'Redirecting\x20to\x20'+_0x5c466d+'/.');});}),_0x312fce[_0x4fdda6(0xad)](describe,_0x4fdda6(0xae),()=>{const _0x4fa4b5={'FMKdL':'http://google.com'};_0x312fce['sOGuU'](it,_0x312fce['UAswp'],()=>{const _0x3b6f27=_0x3245,_0x32c02e=context(),_0x4b3daf=_0x3b6f27(0xb8);_0x32c02e[_0x3b6f27(0x8e)]=0x12d,_0x32c02e[_0x3b6f27(0xb2)][_0x3b6f27(0x91)]=_0x3b6f27(0xc3),_0x32c02e[_0x3b6f27(0xd4)](_0x4fa4b5[_0x3b6f27(0xa1)]),assert[_0x3b6f27(0xa2)](_0x32c02e[_0x3b6f27(0x8e)],0x12d),assert[_0x3b6f27(0xa2)](_0x32c02e[_0x3b6f27(0xd8)],_0x3b6f27(0xb7)+_0x4b3daf+'/.');});}),_0x312fce[_0x4fdda6(0x8a)](describe,_0x4fdda6(0x93),()=>{const _0x2a490b=_0x4fdda6,_0x158338={'VkHqt':_0x312fce[_0x2a490b(0xbf)]};_0x312fce[_0x2a490b(0xad)](it,_0x2a490b(0x89),()=>{const _0x41c12d=_0x2a490b,_0x4cf31a=context(),_0x1dab67=_0x158338[_0x41c12d(0xb4)];_0x4cf31a[_0x41c12d(0x8e)]=0x130,_0x4cf31a[_0x41c12d(0xb2)][_0x41c12d(0x91)]=_0x41c12d(0xc3),_0x4cf31a[_0x41c12d(0xd4)](_0x158338['VkHqt']),assert[_0x41c12d(0xa2)](_0x4cf31a[_0x41c12d(0x8e)],0x12e),assert['strictEqual'](_0x4cf31a[_0x41c12d(0xd8)],_0x41c12d(0xb7)+_0x1dab67+'/.');});}),describe(_0x312fce['OQGCK'],()=>{const _0xdabc89=_0x4fdda6;it(_0xdabc89(0xa7),()=>{const _0x4d5ffd=_0xdabc89,_0xc597f0=_0x312fce['kaKIg'](context);_0xc597f0[_0x4d5ffd(0xd8)]={};const _0x141ee9='http://google.com';_0xc597f0[_0x4d5ffd(0xb2)][_0x4d5ffd(0x91)]=_0x4d5ffd(0xc3),_0xc597f0[_0x4d5ffd(0xd4)](_0x312fce[_0x4d5ffd(0xbf)]),assert[_0x4d5ffd(0xa2)](_0xc597f0['status'],0x12e),assert[_0x4d5ffd(0xa2)](_0xc597f0[_0x4d5ffd(0xd8)],_0x4d5ffd(0xb7)+_0x141ee9+'/.'),assert[_0x4d5ffd(0xa2)](_0xc597f0['type'],_0x4d5ffd(0xc3));});});});function _0x1d17(){const _0x4c90a7=['28567VdRBSc','508812fRaQQr','&amp;','vEAVz','should\x20respond\x20with\x20text','hhOso','http://google.com/','</a>.','vIFqj','response','FMKdL','strictEqual','9TKvuiY','location','sHrUq','Pikob','should\x20overwrite\x20content-type','rbfxK','../..','1848uwlWBn','should\x20respond\x20with\x20html','/login','PEYSq','when\x20status\x20is\x20301','use','when\x20text\x20is\x20accepted','WPapA','header','when\x20html\x20is\x20accepted','VkHqt','mSkve','1706916IGVBTz','Redirecting\x20to\x20','http://google.com','YeOqq','http://google.com/@apple.com','should\x20auto\x20fix\x20not\x20encode\x20url','713016ippeOV','DpLia','req','PpQpK','back','&quot;','yoeyg','text/plain','vIwXL','http://google.com\x5c@apple.com','http://google.com/ðŸ˜“','should\x20formatting\x20url\x20before\x20redirect','jhtCQ','JOisq','yFvnj','qXzBv','ZyCkm','referer','content-type','end','should\x20redirect\x20to\x20the\x20given\x20url','&lt;','vPbUK','hjncB','redirect','SrdAI','4762458QdDCWR','should\x20not\x20change\x20the\x20status\x20code','body','HBtOu','supertest','/index.html','5wAdjjQ','should\x20default\x20redirect\x20to\x20/','2234840EGjEap','should\x20change\x20the\x20status\x20code','KYUri','Redirecting\x20to\x20<a\x20href=\x22','headers','text/html;\x20charset=utf-8','status','assert','ZQjqO','accept','text/html','when\x20status\x20is\x20304','6399070qUXCFZ','OcVHi','replace'];_0x1d17=function(){return _0x4c90a7;};return _0x1d17();}function _0x3245(_0x10786c,_0x12c47a){const _0x1d1740=_0x1d17();return _0x3245=function(_0x3245af,_0x2e6173){_0x3245af=_0x3245af-0x83;let _0x4f85d5=_0x1d1740[_0x3245af];return _0x4f85d5;},_0x3245(_0x10786c,_0x12c47a);}function escape(_0x429539){const _0x511f1a=_0x5dc4a6,_0x424780={'hjncB':_0x511f1a(0x99),'sHrUq':'&gt;'};return String(_0x429539)[_0x511f1a(0x96)](/&/g,_0x424780[_0x511f1a(0xd3)])['replace'](/"/g,_0x511f1a(0xc1))[_0x511f1a(0x96)](/</g,_0x511f1a(0xd1))[_0x511f1a(0x96)](/>/g,_0x424780[_0x511f1a(0xa5)]);}