const _0x9ffa9c=_0x5b62;(function(_0x51103e,_0x198ae8){const _0x30547a=_0x5b62,_0x14a249=_0x51103e();while(!![]){try{const _0x58f831=-parseInt(_0x30547a(0x13b))/0x1+-parseInt(_0x30547a(0x18a))/0x2*(-parseInt(_0x30547a(0x155))/0x3)+-parseInt(_0x30547a(0x156))/0x4*(parseInt(_0x30547a(0x150))/0x5)+parseInt(_0x30547a(0x15c))/0x6+parseInt(_0x30547a(0x138))/0x7+parseInt(_0x30547a(0x174))/0x8*(parseInt(_0x30547a(0x14a))/0x9)+-parseInt(_0x30547a(0x177))/0xa;if(_0x58f831===_0x198ae8)break;else _0x14a249['push'](_0x14a249['shift']());}catch(_0x54ad70){_0x14a249['push'](_0x14a249['shift']());}}}(_0x1634,0xbd511));function _0x5b62(_0x30bf49,_0x293b14){const _0x16346e=_0x1634();return _0x5b62=function(_0x5b62d3,_0x278c7e){_0x5b62d3=_0x5b62d3-0x138;let _0xeb47dc=_0x16346e[_0x5b62d3];return _0xeb47dc;},_0x5b62(_0x30bf49,_0x293b14);}import{Meteor}from'meteor/meteor';import _0xb023c3 from'underscore';import _0x53a79e from'underscore.string';function _0x1634(){const _0x5ce97d=['emoji.updateCustom','_id','coYrP','png','Name','contentType','ATMMG','yQXpq','userId','safe','error-input-is-not-a-valid-field','iEPOU','5629136czdtLc','length','akBcb','4194670igAxaF','name','jsZES','tYDwr','LuKDO','pksTQ','deleteFile','cLHVH','insertOrUpdateEmoji','MyyLI','oRBJn','readStream','aliases','manage-emoji','pCIUN','FVCnC','concat','setExtension','FcQUl','14aDOzPD','405748VKltBR','without','newFile','225122rDUyrd','RdvJo','hWcYh','\x20is\x20not\x20a\x20valid\x20alias\x20set','setName','extension','broadcast','The\x20field\x20Name\x20is\x20required','split','setAliases','Error','findByNameOrAliasExceptID','VKNnh','\x20is\x20not\x20a\x20valid\x20name','previousName','18IgBBRh','yknCX','jDcjH','replace','Custom_Emoji_Error_Name_Or_Alias_Already_In_Use','CmFDC','7100195kRXtzn','end','SApcj','getFileWithReadStream','test','18099wnUgcg','4xrEogf','previousExtension','fetch','not_authorized','methods','TOkHW','7995540BIxeIP','JABcM','Alias_Set','bindEnvironment','findByNameOrAlias','JqGcU','return\x20await\x20Promise.resolve(42);','KZVne','error-the-field-is-required','log','tIfWv','PSvGL'];_0x1634=function(){return _0x5ce97d;};return _0x1634();}import _0x33fe0c from'limax';import{hasPermission}from'../../../authorization';import{EmojiCustom}from'../../../models';import{RocketChatFileEmojiCustomInstance}from'../startup/emoji-custom';import{api}from'../../../../server/sdk/api';Meteor[_0x9ffa9c(0x15a)]({'insertOrUpdateEmoji'(_0xbe4bec){const _0x36af9e=_0x9ffa9c,_0x49eae6={'CmFDC':_0x36af9e(0x159),'LuKDO':_0x36af9e(0x164),'yknCX':_0x36af9e(0x17f),'oRBJn':'Name','RdvJo':_0x36af9e(0x171),'SApcj':function(_0x5771d7,_0x17560d,_0x3f7204){return _0x5771d7(_0x17560d,_0x3f7204);},'hWcYh':function(_0x2cfab3,_0x184106){return _0x2cfab3===_0x184106;},'cLHVH':_0x36af9e(0x147),'OpmTH':_0x36af9e(0x172),'TOkHW':'svg+xml','jDcjH':_0x36af9e(0x16b),'FVCnC':_0x36af9e(0x16f),'FcQUl':_0x36af9e(0x168),'KZVne':function(_0x23a29c,_0x51ea69){return _0x23a29c===_0x51ea69;},'MyyLI':_0x36af9e(0x15d),'iEPOU':_0x36af9e(0x167),'tIfWv':function(_0xddd77d,_0x18c661){return _0xddd77d(_0x18c661);},'mQDqZ':function(_0x43f210,_0x3b5369){return _0x43f210(_0x3b5369);},'ATMMG':function(_0xa06f87,_0x384a59){return _0xa06f87(_0x384a59);},'tYDwr':_0x36af9e(0x151),'coYrP':function(_0x1300c2,_0x4a1508){return _0x1300c2!==_0x4a1508;},'pCIUN':_0x36af9e(0x179),'akBcb':_0x36af9e(0x17c),'JqGcU':_0x36af9e(0x162)};if(!_0x49eae6[_0x36af9e(0x152)](hasPermission,this[_0x36af9e(0x170)],_0x36af9e(0x184)))throw new Meteor[(_0x36af9e(0x145))](_0x49eae6[_0x36af9e(0x14f)]);if(!_0x53a79e['trim'](_0xbe4bec[_0x36af9e(0x178)]))throw new Meteor[(_0x36af9e(0x145))](_0x49eae6['LuKDO'],_0x36af9e(0x142),{'method':_0x49eae6[_0x36af9e(0x14b)],'field':_0x36af9e(0x16c)});_0xbe4bec[_0x36af9e(0x178)]=_0x49eae6[_0x36af9e(0x152)](_0x33fe0c,_0xbe4bec[_0x36af9e(0x178)],{'replacement':'_'}),_0xbe4bec['aliases']=_0x49eae6['SApcj'](_0x33fe0c,_0xbe4bec[_0x36af9e(0x183)],{'replacement':'_'});const _0x5bf274=/[\s,:><&"'\/\\\(\)]/,_0x29904b=/[:><&\|"'\/\\\(\)]/;_0xbe4bec[_0x36af9e(0x178)]=_0xbe4bec[_0x36af9e(0x178)][_0x36af9e(0x14d)](/:/g,''),_0xbe4bec[_0x36af9e(0x183)]=_0xbe4bec[_0x36af9e(0x183)][_0x36af9e(0x14d)](/:/g,'');if(_0x5bf274[_0x36af9e(0x154)](_0xbe4bec['name']))throw new Meteor[(_0x36af9e(0x145))](_0x36af9e(0x172),_0xbe4bec[_0x36af9e(0x178)]+_0x36af9e(0x148),{'method':_0x49eae6['yknCX'],'input':_0xbe4bec[_0x36af9e(0x178)],'field':_0x49eae6[_0x36af9e(0x181)]});if(_0xbe4bec[_0x36af9e(0x183)]){if(_0x49eae6[_0x36af9e(0x13d)](_0x36af9e(0x147),_0x49eae6[_0x36af9e(0x17e)])){if(_0x29904b['test'](_0xbe4bec[_0x36af9e(0x183)]))throw new Meteor[(_0x36af9e(0x145))](_0x49eae6['OpmTH'],_0xbe4bec['aliases']+_0x36af9e(0x13e),{'method':_0x49eae6[_0x36af9e(0x14b)],'input':_0xbe4bec[_0x36af9e(0x183)],'field':_0x36af9e(0x15e)});_0xbe4bec[_0x36af9e(0x183)]=_0xbe4bec['aliases'][_0x36af9e(0x143)](/[\s,]/),_0xbe4bec[_0x36af9e(0x183)]=_0xbe4bec['aliases']['filter'](Boolean),_0xbe4bec[_0x36af9e(0x183)]=_0xb023c3[_0x36af9e(0x139)](_0xbe4bec['aliases'],_0xbe4bec[_0x36af9e(0x178)]);}else throw new _0x4bc248['Error'](_0x49eae6[_0x36af9e(0x14f)]);}else _0xbe4bec['aliases']=[];_0xbe4bec[_0x36af9e(0x140)]=_0x49eae6[_0x36af9e(0x13d)](_0xbe4bec['extension'],_0x49eae6[_0x36af9e(0x15b)])?_0x49eae6[_0x36af9e(0x14c)]:_0xbe4bec[_0x36af9e(0x140)];let _0x409d29=[];if(_0xbe4bec[_0x36af9e(0x169)]){_0x409d29=EmojiCustom[_0x36af9e(0x146)](_0xbe4bec[_0x36af9e(0x178)],_0xbe4bec[_0x36af9e(0x169)])[_0x36af9e(0x158)]();for(const _0x306855 of _0xbe4bec[_0x36af9e(0x183)]){_0x409d29=_0x409d29['concat'](EmojiCustom[_0x36af9e(0x146)](_0x306855,_0xbe4bec[_0x36af9e(0x169)])[_0x36af9e(0x158)]());}}else{_0x409d29=EmojiCustom['findByNameOrAlias'](_0xbe4bec['name'])[_0x36af9e(0x158)]();for(const _0x695c14 of _0xbe4bec[_0x36af9e(0x183)]){_0x409d29=_0x409d29[_0x36af9e(0x187)](EmojiCustom[_0x36af9e(0x160)](_0x695c14)[_0x36af9e(0x158)]());}}if(_0x409d29[_0x36af9e(0x175)]>0x0)throw new Meteor[(_0x36af9e(0x145))](_0x36af9e(0x14e),'The\x20custom\x20emoji\x20or\x20one\x20of\x20its\x20aliases\x20is\x20already\x20in\x20use',{'method':_0x36af9e(0x17f)});if(!_0xbe4bec[_0x36af9e(0x169)]){if(_0x49eae6[_0x36af9e(0x186)]===_0x49eae6['FVCnC']){const _0xff11d={'name':_0xbe4bec[_0x36af9e(0x178)],'aliases':_0xbe4bec['aliases'],'extension':_0xbe4bec[_0x36af9e(0x140)]},_0x4c32ad=EmojiCustom['create'](_0xff11d);return api[_0x36af9e(0x141)](_0x49eae6[_0x36af9e(0x189)],_0xff11d),setTimeout(function(){const _0x1d71fd=_0x36af9e;console[_0x1d71fd(0x165)]('safe');},0x64),_0x4c32ad;}else throw new _0x555ed0[(_0x36af9e(0x145))](_0x49eae6[_0x36af9e(0x17b)],_0x36af9e(0x142),{'method':_0x49eae6[_0x36af9e(0x14b)],'field':_0x49eae6[_0x36af9e(0x181)]});}if(_0xbe4bec[_0x36af9e(0x13a)]){if(_0x49eae6[_0x36af9e(0x163)](_0x49eae6[_0x36af9e(0x180)],_0x49eae6[_0x36af9e(0x173)]))_0x59aeda[_0x36af9e(0x13f)](_0x3048f9[_0x36af9e(0x169)],_0x234f5b['name']);else{const _0x4b9197='2|4|1|3|0'[_0x36af9e(0x143)]('|');let _0x17900e=0x0;while(!![]){switch(_0x4b9197[_0x17900e++]){case'0':EmojiCustom[_0x36af9e(0x188)](_0xbe4bec[_0x36af9e(0x169)],_0xbe4bec[_0x36af9e(0x140)]);continue;case'1':RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](_0x49eae6[_0x36af9e(0x166)](encodeURIComponent,_0xbe4bec[_0x36af9e(0x149)]+'.'+_0xbe4bec[_0x36af9e(0x140)]));continue;case'2':RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](encodeURIComponent(_0xbe4bec[_0x36af9e(0x178)]+'.'+_0xbe4bec[_0x36af9e(0x140)]));continue;case'3':RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](_0x49eae6['mQDqZ'](encodeURIComponent,_0xbe4bec['previousName']+'.'+_0xbe4bec['previousExtension']));continue;case'4':RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](encodeURIComponent(_0xbe4bec[_0x36af9e(0x178)]+'.'+_0xbe4bec[_0x36af9e(0x157)]));continue;}break;}}}else{if(_0xbe4bec[_0x36af9e(0x178)]!==_0xbe4bec['previousName']){const _0x1bee37=RocketChatFileEmojiCustomInstance[_0x36af9e(0x153)](_0x49eae6[_0x36af9e(0x16e)](encodeURIComponent,_0xbe4bec[_0x36af9e(0x149)]+'.'+_0xbe4bec[_0x36af9e(0x157)]));if(_0x1bee37!==null){RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](encodeURIComponent(_0xbe4bec['name']+'.'+_0xbe4bec[_0x36af9e(0x140)]));const _0x19e1df=RocketChatFileEmojiCustomInstance['createWriteStream'](_0x49eae6[_0x36af9e(0x16e)](encodeURIComponent,_0xbe4bec['name']+'.'+_0xbe4bec[_0x36af9e(0x157)]),_0x1bee37[_0x36af9e(0x16d)]);_0x19e1df['on'](_0x49eae6[_0x36af9e(0x17a)],Meteor[_0x36af9e(0x15f)](()=>RocketChatFileEmojiCustomInstance[_0x36af9e(0x17d)](encodeURIComponent(_0xbe4bec[_0x36af9e(0x149)]+'.'+_0xbe4bec['previousExtension'])))),_0x1bee37[_0x36af9e(0x182)]['pipe'](_0x19e1df);}}}return _0x49eae6[_0x36af9e(0x16a)](_0xbe4bec[_0x36af9e(0x178)],_0xbe4bec[_0x36af9e(0x149)])&&(_0x49eae6[_0x36af9e(0x185)]===_0x49eae6[_0x36af9e(0x176)]?_0x126904['log'](_0x49eae6[_0x36af9e(0x13c)]):EmojiCustom[_0x36af9e(0x13f)](_0xbe4bec['_id'],_0xbe4bec[_0x36af9e(0x178)])),_0xbe4bec[_0x36af9e(0x183)]?EmojiCustom[_0x36af9e(0x144)](_0xbe4bec[_0x36af9e(0x169)],_0xbe4bec[_0x36af9e(0x183)]):EmojiCustom[_0x36af9e(0x144)](_0xbe4bec[_0x36af9e(0x169)],[]),api[_0x36af9e(0x141)](_0x49eae6[_0x36af9e(0x189)],_0xbe4bec),new AsyncFunction(_0x49eae6[_0x36af9e(0x161)])(),!![];}});