function _0x4f86(_0x40d1c4,_0x6574aa){const _0x33f289=_0x33f2();return _0x4f86=function(_0x4f864f,_0x56128b){_0x4f864f=_0x4f864f-0x93;let _0x3cd94a=_0x33f289[_0x4f864f];return _0x3cd94a;},_0x4f86(_0x40d1c4,_0x6574aa);}const _0x143a23=_0x4f86;(function(_0x4bf1e4,_0x24bb82){const _0x3f023b=_0x4f86,_0x484313=_0x4bf1e4();while(!![]){try{const _0x5c3d1a=-parseInt(_0x3f023b(0xb5))/0x1+-parseInt(_0x3f023b(0xa3))/0x2+parseInt(_0x3f023b(0xb1))/0x3+-parseInt(_0x3f023b(0xab))/0x4*(-parseInt(_0x3f023b(0xb8))/0x5)+-parseInt(_0x3f023b(0x9d))/0x6*(parseInt(_0x3f023b(0xa7))/0x7)+parseInt(_0x3f023b(0xb0))/0x8+parseInt(_0x3f023b(0xa2))/0x9;if(_0x5c3d1a===_0x24bb82)break;else _0x484313['push'](_0x484313['shift']());}catch(_0x502aa3){_0x484313['push'](_0x484313['shift']());}}}(_0x33f2,0xe4a2d));const select=require('xml-crypto')['xpath'],dom=require(_0x143a23(0x94))[_0x143a23(0x9c)],SignedXml=require(_0x143a23(0xaa))[_0x143a23(0xb2)],FileKeyInfo=require(_0x143a23(0xaa))[_0x143a23(0x99)],fs=require('fs');function signXml(_0x4bd448,_0x5bd299,_0x5c4ab7,_0x2d5cc1){const _0xc83e6c=_0x143a23,_0x496aad=new SignedXml();_0x496aad['signingKey']=fs['readFileSync'](_0x5c4ab7),_0x496aad[_0xc83e6c(0xaf)](_0x5bd299),_0x496aad[_0xc83e6c(0xa6)](_0x4bd448),fs[_0xc83e6c(0x9b)](_0x2d5cc1,_0x496aad[_0xc83e6c(0x9f)]());}function _0x33f2(){const _0x56e38e=['log','</book>','UnIsb','FileKeyInfo','parseFromString','writeFileSync','DOMParser','6cjOXZo','checkSignature','getSignedXml','loadSignature','client.pem','34247016LIKTPO','960366NUjouw','xml\x20signed\x20successfully','mNYBm','computeSignature','12702403wlVUnM','signature\x20is\x20valid','validating\x20signature...','xml-crypto','164JFaRcY','return\x20new\x20Date();','toString','<book>','addReference','1021624ALYLSW','1159512fBqmsQ','SignedXml','nbmbA','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','1223098dPHXQB','result.xml','client_public.pem','16460WTzhJW','<name>Harry\x20Potter</name>','GSGiq','@xmldom/xmldom','</library>'];_0x33f2=function(){return _0x56e38e;};return _0x33f2();}function validateXml(_0x1f4c33,_0x4faf7f){const _0x213412=_0x143a23,_0x5d9de6={'GSGiq':function(_0x416449,_0xc79a5a,_0x1c1962){return _0x416449(_0xc79a5a,_0x1c1962);},'nbmbA':_0x213412(0xb4),'mNYBm':function(_0x449ac6,_0x5ddb72){return _0x449ac6(_0x5ddb72);},'UnIsb':_0x213412(0xac)},_0x24f056=new dom()[_0x213412(0x9a)](_0x1f4c33),_0x21439f=_0x5d9de6[_0x213412(0x93)](select,_0x5d9de6[_0x213412(0xb3)],_0x24f056)[0x0],_0x4bea93=new SignedXml();_0x4bea93['keyInfoProvider']=new FileKeyInfo(_0x4faf7f),_0x4bea93[_0x213412(0xa0)](_0x21439f[_0x213412(0xad)]());const _0x3220d5=_0x4bea93[_0x213412(0x9e)](_0x1f4c33);return!_0x3220d5&&console[_0x213412(0x96)](_0x4bea93['validationErrors']),_0x5d9de6[_0x213412(0xa5)](Function,_0x5d9de6[_0x213412(0x98)])(),_0x3220d5;}const xml='<library>'+_0x143a23(0xae)+_0x143a23(0xb9)+_0x143a23(0x97)+_0x143a23(0x95);signXml(xml,'//*[local-name(.)=\x27book\x27]',_0x143a23(0xa1),_0x143a23(0xb6)),console['log'](_0x143a23(0xa4));const signedXml=fs['readFileSync'](_0x143a23(0xb6))[_0x143a23(0xad)]();console[_0x143a23(0x96)](_0x143a23(0xa9));validateXml(signedXml,_0x143a23(0xb7))?console[_0x143a23(0x96)](_0x143a23(0xa8)):console[_0x143a23(0x96)]('signature\x20not\x20valid');