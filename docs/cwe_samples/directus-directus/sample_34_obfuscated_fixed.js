function _0x2f6a(_0x51acf5,_0x291f01){const _0x5f2df8=_0x5f2d();return _0x2f6a=function(_0x2f6ae8,_0x1932c4){_0x2f6ae8=_0x2f6ae8-0x1d4;let _0x55a318=_0x5f2df8[_0x2f6ae8];return _0x55a318;},_0x2f6a(_0x51acf5,_0x291f01);}const _0x4facd2=_0x2f6a;(function(_0x48b6e2,_0x5ced95){const _0x4f6cba=_0x2f6a,_0x5bcc5a=_0x48b6e2();while(!![]){try{const _0x41b5b1=parseInt(_0x4f6cba(0x21f))/0x1*(parseInt(_0x4f6cba(0x225))/0x2)+-parseInt(_0x4f6cba(0x1ea))/0x3+-parseInt(_0x4f6cba(0x204))/0x4+parseInt(_0x4f6cba(0x205))/0x5+-parseInt(_0x4f6cba(0x232))/0x6+parseInt(_0x4f6cba(0x212))/0x7*(parseInt(_0x4f6cba(0x1f6))/0x8)+parseInt(_0x4f6cba(0x23b))/0x9;if(_0x41b5b1===_0x5ced95)break;else _0x5bcc5a['push'](_0x5bcc5a['shift']());}catch(_0xb08984){_0x5bcc5a['push'](_0x5bcc5a['shift']());}}}(_0x5f2d,0xd3a96));const {Capabilities,EModelEndpoint,isAgentsEndpoint,AgentCapabilities,isAssistantsEndpoint,defaultRetrievalModels,defaultAssistantsVersion}=require(_0x4facd2(0x223)),{Providers}=require('@librechat/agents'),{getCitations,citeText}=require('./citations'),partialRight=require('lodash/partialRight'),{sendMessage}=require(_0x4facd2(0x215)),citationRegex=/\[\^\d+?\^]/g,addSpaceIfNeeded=_0x5506d2=>_0x5506d2[_0x4facd2(0x210)]>0x0&&!_0x5506d2[_0x4facd2(0x21c)]('\x20')?_0x5506d2+'\x20':_0x5506d2,base={'message':!![],'initial':!![]},createOnProgress=({generation:generation='',onProgress:_0x3f41ec})=>{const _0x260956=_0x4facd2,_0x581b15={'qVknF':function(_0x19aa2b,_0x19437f){return _0x19aa2b+_0x19437f;},'NFWlH':function(_0x43e2af,_0x464703,_0x52e759){return _0x43e2af(_0x464703,_0x52e759);},'JaXct':function(_0x1776bd,_0x4e68bb){return _0x1776bd(_0x4e68bb);},'UqHsh':function(_0x2e7153,_0x566f6d){return _0x2e7153(_0x566f6d);},'Whild':function(_0x3ce4d5,_0x3550e2){return _0x3ce4d5>_0x3550e2;},'rYVoT':function(_0x1a1eb1,_0x4b8bfa){return _0x1a1eb1===_0x4b8bfa;},'Wztmn':'AcJUF','LYCQv':_0x260956(0x239),'xafhm':function(_0x282699,_0x4391bc,_0x2ae3c9){return _0x282699(_0x4391bc,_0x2ae3c9);},'RBZMj':function(_0x1d1d93,_0x89396){return _0x1d1d93||_0x89396;}};let _0xe91c35=0x0,_0x1f1906=_0x581b15[_0x260956(0x20a)](addSpaceIfNeeded,generation);const _0x2cb970=Object[_0x260956(0x235)]({},base,{'text':_0x581b15['RBZMj'](_0x1f1906,'')}),_0x25891b=(_0x28e51b,{res:_0x4190d2,..._0x43645d})=>{const _0x2103af=_0x260956;_0x2cb970[_0x2103af(0x1d7)]=_0x581b15[_0x2103af(0x1f2)](_0x2cb970[_0x2103af(0x1d7)],_0x28e51b);const _0x29a61b=Object['assign']({},_0x2cb970,_0x43645d);_0x581b15[_0x2103af(0x203)](sendMessage,_0x4190d2,_0x29a61b),_0x3f41ec&&_0x581b15[_0x2103af(0x20a)](_0x3f41ec,_0x29a61b),_0xe91c35===0x0&&(_0x2cb970['initial']=![]),_0xe91c35++;},_0x14ee99=(_0x536c26,_0x4271b6,_0x1d4803='')=>{const _0x53e93d=_0x260956,_0x13f3b2={'HLyZr':function(_0x2b3b3f,_0x11d58d){const _0x5c636c=_0x2f6a;return _0x581b15[_0x5c636c(0x1fa)](_0x2b3b3f,_0x11d58d);},'RhocV':function(_0xed1a94,_0x5984aa){const _0x1c0b8f=_0x2f6a;return _0x581b15[_0x1c0b8f(0x1fc)](_0xed1a94,_0x5984aa);},'JWSGa':function(_0x1f5d64,_0x2b07cf){return _0x1f5d64(_0x2b07cf);}};_0x2cb970[_0x53e93d(0x1d7)]=_0x581b15[_0x53e93d(0x1f2)](_0x2cb970[_0x53e93d(0x1d7)],_0x1d4803);const _0xab6e5c=Object[_0x53e93d(0x235)]({},_0x2cb970,_0x4271b6);_0x581b15['NFWlH'](sendMessage,_0x536c26,_0xab6e5c);if(_0xe91c35===0x0){if(_0x581b15[_0x53e93d(0x1fd)]('AcJUF',_0x581b15['Wztmn']))_0x2cb970[_0x53e93d(0x208)]=![];else{let {text:_0x225dbe}=_0x208a24;_0x36fa63[_0x53e93d(0x1d7)]=_0x225dbe;if(_0x1cfcf0){const _0x39290a=_0x13f3b2[_0x53e93d(0x227)](_0x295f86,_0x27a251);_0x13f3b2['RhocV'](_0x6b1a85[_0x53e93d(0x1d7)]['match'](_0x56b2ee)?.[_0x53e93d(0x210)],0x0)&&(_0x225dbe=_0x13f3b2['JWSGa'](_0x26715f,_0x554ffd)),_0x225dbe+=_0x39290a?.['length']>0x0?'\x0a-\x20'+_0x39290a:'';}return _0x225dbe;}}_0xe91c35++;},_0x463a92=_0x5e1251=>{const _0x25b367=_0x260956;return _0x581b15[_0x25b367(0x1fd)](_0x25b367(0x239),_0x581b15[_0x25b367(0x206)])?_0x581b15[_0x25b367(0x22b)](partialRight,_0x25891b,_0x5e1251):_0x2f840f;},_0x22bd55=()=>{const _0x424354=_0x260956;return _0x2cb970[_0x424354(0x1d7)];};return{'onProgress':_0x463a92,'getPartialText':_0x22bd55,'sendIntermediateMessage':_0x14ee99};},handleText=async(_0x49a98a,_0x517d99=![])=>{const _0x59c68b=_0x4facd2,_0x49af6e={'fLuoB':function(_0x1951b0,_0x170cba){return _0x1951b0>_0x170cba;},'wGEyy':function(_0x4e91da,_0xf0a6d2){return _0x4e91da!==_0xf0a6d2;},'zIQYA':_0x59c68b(0x20e)};let {text:_0x10e482}=_0x49a98a;_0x49a98a[_0x59c68b(0x1d7)]=_0x10e482;if(_0x517d99){const _0x3f7828=getCitations(_0x49a98a);if(_0x49af6e[_0x59c68b(0x20b)](_0x49a98a['text'][_0x59c68b(0x213)](citationRegex)?.[_0x59c68b(0x210)],0x0)){if(_0x49af6e[_0x59c68b(0x224)](_0x49af6e[_0x59c68b(0x233)],_0x49af6e['zIQYA'])){const _0x3cf660=_0x5ef7fa(_0x538d84);_0x23dbc6[_0x59c68b(0x1d7)][_0x59c68b(0x213)](_0x33cc84)?.[_0x59c68b(0x210)]>0x0&&(_0x4a83df=_0x4f8bec(_0x3a74c7)),_0x1c7dc9+=_0x3cf660?.[_0x59c68b(0x210)]>0x0?_0x59c68b(0x1d4)+_0x3cf660:'';}else _0x10e482=citeText(_0x49a98a);}_0x10e482+=_0x3f7828?.[_0x59c68b(0x210)]>0x0?_0x59c68b(0x1d4)+_0x3f7828:'';}return _0x10e482;},isObject=_0x2bc462=>_0x2bc462&&typeof _0x2bc462===_0x4facd2(0x1df)&&!Array['isArray'](_0x2bc462),getString=_0x4f17ef=>isObject(_0x4f17ef)?JSON[_0x4facd2(0x1d5)](_0x4f17ef):_0x4f17ef;function formatSteps(_0x3b8c31){const _0x42fdb9=_0x4facd2,_0x32aa68={'AXkFc':function(_0x502541,_0x3a45f3){return _0x502541<_0x3a45f3;},'ZyClQ':function(_0x701d50,_0x4d5f38){return _0x701d50!==_0x4d5f38;},'fRfaF':_0x42fdb9(0x226),'Eelxg':function(_0x464c88,_0xfb8378){return _0x464c88(_0xfb8378);},'OjDgy':function(_0x444608,_0x1d4168){return _0x444608===_0x1d4168;},'TRkoO':function(_0x3a3d52,_0xa957){return _0x3a3d52(_0xa957);},'pQcHs':function(_0x44cdbe,_0x43c394){return _0x44cdbe>_0x43c394;}};let _0x1660e8='';for(let _0x295a98=0x0;_0x32aa68[_0x42fdb9(0x230)](_0x295a98,_0x3b8c31[_0x42fdb9(0x210)]);_0x295a98++){if(_0x32aa68['ZyClQ'](_0x32aa68[_0x42fdb9(0x23d)],_0x42fdb9(0x1d6))){const _0x207e27=_0x3b8c31[_0x295a98],_0x433f88=_0x32aa68['Eelxg'](getString,_0x207e27[_0x42fdb9(0x22e)]['toolInput']),_0x2e9125=_0x207e27['observation'];if(_0x433f88===_0x42fdb9(0x22a)||_0x32aa68[_0x42fdb9(0x1fe)](_0x2e9125?.['trim']()?.[_0x42fdb9(0x210)],0x0))continue;_0x1660e8+=_0x42fdb9(0x1e4)+_0x433f88+_0x42fdb9(0x220)+_0x32aa68[_0x42fdb9(0x20f)](getString,_0x2e9125),_0x32aa68[_0x42fdb9(0x231)](_0x3b8c31[_0x42fdb9(0x210)],0x1)&&_0x32aa68[_0x42fdb9(0x228)](_0x295a98,_0x3b8c31['length']-0x1)&&(_0x1660e8+='\x0a---\x0a');}else _0x1505f1[_0x42fdb9(0x208)]=![];}return _0x1660e8;}function formatAction(_0x3a3bfd){const _0x8c750f=_0x4facd2,_0x27377c={'QIjjt':_0x8c750f(0x1e5),'ccoFc':function(_0x54ba81,_0x4e4a81){return _0x54ba81(_0x4e4a81);},'aXqGK':_0x8c750f(0x1f5),'krGlV':'N/A','PoWRq':_0x8c750f(0x21b),'DjdkI':_0x8c750f(0x219)},_0xdd5c87={'plugin':_0x3a3bfd['tool'],'input':getString(_0x3a3bfd['toolInput']),'thought':_0x3a3bfd[_0x8c750f(0x1e7)]['includes'](_0x27377c[_0x8c750f(0x238)])?_0x3a3bfd[_0x8c750f(0x1e7)][_0x8c750f(0x20d)]('\x0a')[0x0]['replace']('Thought:\x20',''):_0x3a3bfd[_0x8c750f(0x1e7)]['split']('\x0a')[0x0]};_0xdd5c87[_0x8c750f(0x1dc)]=_0x27377c[_0x8c750f(0x222)](getString,_0xdd5c87[_0x8c750f(0x1dc)]);if(_0x3a3bfd[_0x8c750f(0x201)][_0x8c750f(0x216)]()===_0x27377c['aXqGK']||_0xdd5c87['plugin']===_0x27377c[_0x8c750f(0x202)])_0xdd5c87['inputStr']=_0x8c750f(0x23c)+_0xdd5c87['input']+(!_0xdd5c87[_0x8c750f(0x1dc)][_0x8c750f(0x1e8)](_0xdd5c87[_0x8c750f(0x1f9)])?_0x27377c[_0x8c750f(0x1d8)]+_0xdd5c87[_0x8c750f(0x1dc)]:'')+'\x0a}',_0xdd5c87[_0x8c750f(0x1f0)]=_0xdd5c87[_0x8c750f(0x1f0)]['replace'](_0x27377c['DjdkI'],'');else{const _0xea554b=_0xdd5c87[_0x8c750f(0x1dc)][_0x8c750f(0x210)]>0x0,_0x39a343=_0xea554b?_0x8c750f(0x1e0)+_0xdd5c87['thought']:'';_0xdd5c87[_0x8c750f(0x1f0)]=_0x8c750f(0x1dd)+_0xdd5c87[_0x8c750f(0x22c)]+_0x8c750f(0x22f)+_0xdd5c87['input']+'\x0a'+_0x39a343+'}';}return _0xdd5c87;}function isEnabled(_0x3eaf5e){const _0x59807c=_0x4facd2,_0x38d563={'lgtuT':_0x59807c(0x21b),'JQUPJ':function(_0x13e25b,_0x4d7926){return _0x13e25b===_0x4d7926;},'mwONk':_0x59807c(0x1d9),'SZXfx':_0x59807c(0x1f3),'aqRkA':_0x59807c(0x207)};if(_0x38d563['JQUPJ'](typeof _0x3eaf5e,_0x59807c(0x221))){if(_0x38d563[_0x59807c(0x1fb)](_0x38d563[_0x59807c(0x1ee)],_0x38d563[_0x59807c(0x1ee)]))return _0x3eaf5e;else{const _0x4d462b=_0x48f62b[_0x59807c(0x1dc)][_0x59807c(0x210)]>0x0,_0x48a826=_0x4d462b?_0x59807c(0x1e0)+_0x3d4485[_0x59807c(0x1dc)]:'';_0x6e604a['inputStr']=_0x59807c(0x1dd)+_0x306dc3[_0x59807c(0x22c)]+_0x59807c(0x22f)+_0x105f5e['input']+'\x0a'+_0x48a826+'}';}}if(_0x38d563['JQUPJ'](typeof _0x3eaf5e,_0x59807c(0x22d))){if(_0x59807c(0x1f7)!==_0x38d563[_0x59807c(0x21e)])return _0x3eaf5e[_0x59807c(0x216)]()['trim']()===_0x38d563[_0x59807c(0x1f1)];else _0x2929ad[_0x59807c(0x1f0)]='{\x0a\x09thought:\x20'+_0x16aa74[_0x59807c(0x1f9)]+(!_0x3748ef[_0x59807c(0x1dc)][_0x59807c(0x1e8)](_0x18eeef[_0x59807c(0x1f9)])?_0x38d563[_0x59807c(0x1f4)]+_0x12230a[_0x59807c(0x1dc)]:'')+'\x0a}',_0x3ff97d[_0x59807c(0x1f0)]=_0x25c80e['inputStr'][_0x59807c(0x217)](_0x59807c(0x219),'');}return![];}function _0x5f2d(){const _0x157d4c=['JgtYv','image_vision','assistants','Input:\x20','Thought:\x20','retrieval','log','includes','toolInput','1742847ARXpWc','exports','code_interpreter','tools','mwONk','capabilities','inputStr','aqRkA','qVknF','hNUVS','lgtuT','self-reflection','8EuhCDP','XVIqk','retrievalModels','input','UqHsh','JQUPJ','Whild','rYVoT','OjDgy','version','YqSsV','tool','krGlV','NFWlH','6423220atlzru','1463940zaNSDS','LYCQv','true','initial','iHqTX','JaXct','fLuoB','file_search','split','VnVdg','TRkoO','length','eInJK','6167868ozKkWV','match','actions','./streamResponse','toLowerCase','replace','QoFmT','N/A\x20-\x20','dCkUb','\x20-\x20','endsWith','MoyPB','SZXfx','24HlGrbg','\x0aOutput:\x20','boolean','ccoFc','librechat-data-provider','wGEyy','64274YYoiQI','cLZEh','HLyZr','ZyClQ','yaerV','N/A','xafhm','plugin','string','action','\x0a\x09input:\x20','AXkFc','pQcHs','5117748cUcvqF','zIQYA','push','assign','azureAssistants','PpITI','QIjjt','sNQZZ','hoMEv','17653302keAhkX','{\x0a\x09thought:\x20','fRfaF','\x0a-\x20','stringify','nIdnj','text','PoWRq','ulbVi','zFadV','userProvideURL','thought','{\x0a\x09plugin:\x20','OLLAMA','object','\x0a\x09thought:\x20'];_0x5f2d=function(){return _0x157d4c;};return _0x5f2d();}const isUserProvided=_0x179364=>_0x179364==='user_provided';function generateConfig(_0xaf8750,_0x332c8e,_0x55e22f){const _0x5990cb=_0x4facd2,_0x4ad16f={'hoMEv':function(_0x1ce9dc,_0x3b54f0){return _0x1ce9dc(_0x3b54f0);},'JgtYv':_0x5990cb(0x1e5),'dCkUb':function(_0x2d661b,_0x4fba37){return _0x2d661b===_0x4fba37;},'iHqTX':_0x5990cb(0x219),'QoFmT':function(_0x59bccf,_0x5dc758){return _0x59bccf>_0x5dc758;},'YqSsV':function(_0x32360f,_0x36d3e0){return _0x32360f!==_0x36d3e0;},'MoyPB':'dOlmN','VnXeb':function(_0x201ff6,_0x3fbd03){return _0x201ff6!==_0x3fbd03;},'pLEkT':'jwMKb','yaerV':function(_0x5e144d,_0x1a44f3){return _0x5e144d===_0x1a44f3;},'PpITI':function(_0x287950,_0x524ab7){return _0x287950===_0x524ab7;}};if(!_0xaf8750){if(_0x4ad16f[_0x5990cb(0x200)](_0x5990cb(0x211),_0x4ad16f[_0x5990cb(0x21d)]))return![];else _0x25bf53[_0x5990cb(0x1ff)]=_0x4f5864[_0x5990cb(0x1e3)];}const _0x49683e={'userProvide':isUserProvided(_0xaf8750)};_0x332c8e&&(_0x49683e[_0x5990cb(0x1db)]=isUserProvided(_0x332c8e));const _0x2bb937=isAssistantsEndpoint(_0x55e22f),_0x4bea38=isAgentsEndpoint(_0x55e22f);_0x2bb937&&(_0x49683e[_0x5990cb(0x1f8)]=defaultRetrievalModels,_0x49683e[_0x5990cb(0x1ef)]=[Capabilities[_0x5990cb(0x1ec)],Capabilities[_0x5990cb(0x1e2)],Capabilities[_0x5990cb(0x1e6)],Capabilities['actions'],Capabilities[_0x5990cb(0x1ed)]]);if(_0x4bea38){if(_0x4ad16f['VnXeb'](_0x4ad16f['pLEkT'],_0x5990cb(0x1da)))_0x49683e[_0x5990cb(0x1ef)]=[AgentCapabilities[_0x5990cb(0x20c)],AgentCapabilities[_0x5990cb(0x214)],AgentCapabilities['tools']],_0x4ad16f[_0x5990cb(0x229)](_0xaf8750,'EXPERIMENTAL_RUN_CODE')&&_0x49683e['capabilities'][_0x5990cb(0x234)](AgentCapabilities['execute_code']);else{const _0x2f59f0={'plugin':_0x3290a0[_0x5990cb(0x201)],'input':_0x4ad16f['hoMEv'](_0x5e5e03,_0x40dbaa[_0x5990cb(0x1e9)]),'thought':_0x450137[_0x5990cb(0x1e7)][_0x5990cb(0x1e8)](_0x4ad16f[_0x5990cb(0x1e1)])?_0x227fbe[_0x5990cb(0x1e7)][_0x5990cb(0x20d)]('\x0a')[0x0][_0x5990cb(0x217)](_0x4ad16f['JgtYv'],''):_0x4678b2[_0x5990cb(0x1e7)]['split']('\x0a')[0x0]};_0x2f59f0[_0x5990cb(0x1dc)]=_0x4ad16f[_0x5990cb(0x23a)](_0x4f6199,_0x2f59f0[_0x5990cb(0x1dc)]);if(_0x3d582d[_0x5990cb(0x201)][_0x5990cb(0x216)]()==='self-reflection'||_0x4ad16f[_0x5990cb(0x21a)](_0x2f59f0[_0x5990cb(0x22c)],_0x5990cb(0x22a)))_0x2f59f0[_0x5990cb(0x1f0)]=_0x5990cb(0x23c)+_0x2f59f0[_0x5990cb(0x1f9)]+(!_0x2f59f0['thought'][_0x5990cb(0x1e8)](_0x2f59f0[_0x5990cb(0x1f9)])?_0x5990cb(0x21b)+_0x2f59f0[_0x5990cb(0x1dc)]:'')+'\x0a}',_0x2f59f0['inputStr']=_0x2f59f0[_0x5990cb(0x1f0)]['replace'](_0x4ad16f[_0x5990cb(0x209)],'');else{const _0x2eaadc=_0x4ad16f[_0x5990cb(0x218)](_0x2f59f0[_0x5990cb(0x1dc)]['length'],0x0),_0x2b9b07=_0x2eaadc?'\x0a\x09thought:\x20'+_0x2f59f0[_0x5990cb(0x1dc)]:'';_0x2f59f0[_0x5990cb(0x1f0)]=_0x5990cb(0x1dd)+_0x2f59f0['plugin']+_0x5990cb(0x22f)+_0x2f59f0[_0x5990cb(0x1f9)]+'\x0a'+_0x2b9b07+'}';}return _0x2f59f0;}}if(_0x2bb937&&_0x4ad16f[_0x5990cb(0x237)](_0x55e22f,EModelEndpoint[_0x5990cb(0x236)]))_0x49683e[_0x5990cb(0x1ff)]=defaultAssistantsVersion[_0x5990cb(0x236)];else _0x2bb937&&(_0x49683e[_0x5990cb(0x1ff)]=defaultAssistantsVersion[_0x5990cb(0x1e3)]);return _0x49683e;}function normalizeEndpointName(_0x5ede0c=''){const _0x3d3e46=_0x4facd2;return _0x5ede0c[_0x3d3e46(0x216)]()===Providers[_0x3d3e46(0x1de)]?Providers[_0x3d3e46(0x1de)]:_0x5ede0c;}module[_0x4facd2(0x1eb)]={'isEnabled':isEnabled,'handleText':handleText,'formatSteps':formatSteps,'formatAction':formatAction,'isUserProvided':isUserProvided,'generateConfig':generateConfig,'addSpaceIfNeeded':addSpaceIfNeeded,'createOnProgress':createOnProgress,'normalizeEndpointName':normalizeEndpointName};