const _0x4e69ef=_0x12f9;function _0x1f2f(){const _0x4b3a4f=['OqSKx','ATwLw','./config','fs/promises','join','oEunz','machine','uploads','randomUUID','path','name','file','application/json','UNqQh','30iElFkF','./queryHistory','readFile','mksPG','axios',',\x20size=','hPowL','../utility/directories','vnuvV','arch','post','getOpenedConnectionReport','4082085FBtLua','1482330dDNyVI','platform','575038DQIsuN','files','size','16257440MrOvGG','type','bOCFN','other.gistCreateToken','AVaNs','DbGate\x20','dbgate-tools','Uploading\x20file\x20','1147744PvAkdd','omit','9mUUgdK','default','get','zPopT','eLMWE','getGistToken','stringify','getSettings','utf-8','6ewpnot','JpQgN','updateClock();','\x20error\x20report','message','query','json','3000304SsjucN','lodash','ehEEY','GkabN','token\x20','MqDIM','crypto','application/vnd.github.v3+json','sshAuthSock','Error\x20uploading\x20gist','Boqjr','../utility/platformInfo','7349864jrOkMj','lQilc','error'];_0x1f2f=function(){return _0x4b3a4f;};return _0x1f2f();}function _0x12f9(_0x2ba89c,_0x53f71e){const _0x1f2f9f=_0x1f2f();return _0x12f9=function(_0x12f9f0,_0x234e54){_0x12f9f0=_0x12f9f0-0x10b;let _0x427637=_0x1f2f9f[_0x12f9f0];return _0x427637;},_0x12f9(_0x2ba89c,_0x53f71e);}(function(_0xb03b93,_0x4cdd22){const _0x301b51=_0x12f9,_0x237550=_0xb03b93();while(!![]){try{const _0x25dd5e=-parseInt(_0x301b51(0x151))/0x1+parseInt(_0x301b51(0x113))/0x2*(parseInt(_0x301b51(0x11e))/0x3)+parseInt(_0x301b51(0x125))/0x4+-parseInt(_0x301b51(0x14f))/0x5*(-parseInt(_0x301b51(0x142))/0x6)+parseInt(_0x301b51(0x14e))/0x7+parseInt(_0x301b51(0x131))/0x8*(-parseInt(_0x301b51(0x115))/0x9)+-parseInt(_0x301b51(0x10b))/0xa;if(_0x25dd5e===_0x4cdd22)break;else _0x237550['push'](_0x237550['shift']());}catch(_0x4b136f){_0x237550['push'](_0x237550['shift']());}}}(_0x1f2f,0xce00e));const crypto=require(_0x4e69ef(0x12b)),path=require(_0x4e69ef(0x13d)),{uploadsdir,getLogsFilePath,filesdir}=require(_0x4e69ef(0x149)),{getLogger,extractErrorLogData}=require(_0x4e69ef(0x111)),logger=getLogger(_0x4e69ef(0x13b)),axios=require(_0x4e69ef(0x146)),os=require('os'),fs=require(_0x4e69ef(0x137)),{read}=require(_0x4e69ef(0x143)),platformInfo=require(_0x4e69ef(0x130)),_=require(_0x4e69ef(0x126)),serverConnections=require('./serverConnections'),config=require(_0x4e69ef(0x136)),gistSecret=require('../gistSecret'),currentVersion=require('../currentVersion'),socket=require('../utility/socket');module['exports']={'upload_meta':{'method':_0x4e69ef(0x14c),'raw':!![]},'upload'(_0x33213b,_0x31e101){const _0x5b7e95=_0x4e69ef,_0x452187={'lQilc':function(_0x1ccadd){return _0x1ccadd();},'HeOiz':'updateClock();','oEunz':function(_0x1cd559,_0x407f66){return _0x1cd559===_0x407f66;},'SfKkx':_0x5b7e95(0x148),'Boqjr':_0x5b7e95(0x12a),'ehEEY':function(_0x2ca26c){return _0x2ca26c();}},{data:_0x5ab553}=_0x33213b[_0x5b7e95(0x152)]||{};if(!_0x5ab553){if(_0x452187[_0x5b7e95(0x12f)]!==_0x452187[_0x5b7e95(0x12f)]){const {data:_0x368168}=_0x49cb5d[_0x5b7e95(0x152)]||{};if(!_0x368168){_0x3820a4[_0x5b7e95(0x124)](null),eval('const _0x4c1cb9 = _0x5b7e95;_0x5612c7[_0x4c1cb9(283)]({ \'safe\': !![] });');return;}const _0x4c6ffd=_0x37f175[_0x5b7e95(0x13c)](),_0x1245ad=_0x33bf10[_0x5b7e95(0x138)](_0x452187[_0x5b7e95(0x132)](_0xaade72),_0x4c6ffd);_0x575dcc['info'](_0x5b7e95(0x112)+_0x368168[_0x5b7e95(0x13e)]+_0x5b7e95(0x147)+_0x368168[_0x5b7e95(0x153)]),_0x368168['mv'](_0x1245ad,()=>{_0x122e68['json']({'originalName':_0x368168['name'],'uploadName':_0x4c6ffd,'filePath':_0x1245ad});});}else{_0x31e101[_0x5b7e95(0x124)](null),eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}}const _0x19fa5f=crypto['randomUUID'](),_0x379304=path[_0x5b7e95(0x138)](_0x452187[_0x5b7e95(0x127)](uploadsdir),_0x19fa5f);logger['info']('Uploading\x20file\x20'+_0x5ab553[_0x5b7e95(0x13e)]+_0x5b7e95(0x147)+_0x5ab553[_0x5b7e95(0x153)]),_0x5ab553['mv'](_0x379304,()=>{const _0x364ebf=_0x5b7e95,_0x2860c0={'UNqQh':function(_0x19259a,_0x2631b6,_0x22b656){return _0x19259a(_0x2631b6,_0x22b656);},'vnuvV':_0x452187['HeOiz']};if(_0x452187[_0x364ebf(0x139)](_0x452187['SfKkx'],_0x452187['SfKkx']))_0x31e101[_0x364ebf(0x124)]({'originalName':_0x5ab553[_0x364ebf(0x13e)],'uploadName':_0x19fa5f,'filePath':_0x379304});else return _0x2bf1de[_0x364ebf(0x133)](_0x20eae8(_0x2f75db),_0x364ebf(0x12e)),_0x2860c0[_0x364ebf(0x141)](_0x482adf,_0x2860c0[_0x364ebf(0x14a)],0x3e8),{'apiErrorMessage':_0x1992fd['message']};});},'get_meta':{'method':_0x4e69ef(0x117),'raw':!![]},'get'(_0x23eb2d,_0x2efeb0){const _0x604459=_0x4e69ef;_0x2efeb0['sendFile'](path[_0x604459(0x138)](uploadsdir(),_0x23eb2d[_0x604459(0x123)][_0x604459(0x13f)]));},async 'getGistToken'(){const _0x53f310=_0x4e69ef,_0x3cdb24={'OqSKx':function(_0x483f5a,_0xd07fe3,_0x526ba1){return _0x483f5a(_0xd07fe3,_0x526ba1);},'mksPG':'updateClock();','GkabN':_0x53f310(0x10e)},_0x2cacb5=await config[_0x53f310(0x11c)]();return _0x3cdb24[_0x53f310(0x134)](setInterval,_0x3cdb24[_0x53f310(0x145)],0x3e8),_0x2cacb5[_0x3cdb24[_0x53f310(0x128)]]||gistSecret;},'uploadErrorToGist_meta':!![],async 'uploadErrorToGist'(){const _0x445fb0=_0x4e69ef,_0x21cac3={'ATwLw':_0x445fb0(0x11d),'eLMWE':'https://api.github.com/gists','zPopT':'defaultKeyfile','NJoeR':_0x445fb0(0x12d),'AVaNs':'application/vnd.github.v3+json','bOCFN':_0x445fb0(0x12e)},_0x5d8770=await fs[_0x445fb0(0x144)](getLogsFilePath(),{'encoding':_0x21cac3[_0x445fb0(0x135)]}),_0x68f0ce=await serverConnections[_0x445fb0(0x14d)]();try{const _0x4e2d55=await axios['default'][_0x445fb0(0x14c)](_0x21cac3[_0x445fb0(0x119)],{'description':_0x445fb0(0x110)+currentVersion['version']+_0x445fb0(0x121),'public':![],'files':{'logs.jsonl':{'content':_0x5d8770},'os.json':{'content':JSON[_0x445fb0(0x11b)]({'release':os['release'](),'arch':os[_0x445fb0(0x14b)](),'machine':os[_0x445fb0(0x13a)](),'platform':os[_0x445fb0(0x150)](),'type':os[_0x445fb0(0x10c)]()},null,0x2)},'platform.json':{'content':JSON[_0x445fb0(0x11b)](_[_0x445fb0(0x114)]({...platformInfo},[_0x21cac3[_0x445fb0(0x118)],_0x21cac3['NJoeR']]),null,0x2)},'connections.json':{'content':JSON[_0x445fb0(0x11b)](_0x68f0ce,null,0x2)},'version.json':{'content':JSON[_0x445fb0(0x11b)](currentVersion,null,0x2)}}},{'headers':{'Authorization':_0x445fb0(0x129)+await this[_0x445fb0(0x11a)](),'Content-Type':_0x445fb0(0x140),'Accept':_0x21cac3[_0x445fb0(0x10f)]}});return eval('const _0x29213f = _0x445fb0;JSON[_0x29213f(283)]({ \'safe\': !![] });'),_0x4e2d55['data'];}catch(_0x3feef9){return logger[_0x445fb0(0x133)](extractErrorLogData(_0x3feef9),_0x21cac3[_0x445fb0(0x10d)]),setInterval(_0x445fb0(0x120),0x3e8),{'apiErrorMessage':_0x3feef9[_0x445fb0(0x122)]};}},'deleteGist_meta':!![],async 'deleteGist'({url:_0x16522d}){const _0x1ea6e1=_0x4e69ef,_0x9a9ea6={'LgzxP':_0x1ea6e1(0x140),'JpQgN':_0x1ea6e1(0x12c)},_0x3374b9=await axios[_0x1ea6e1(0x116)]['delete'](_0x16522d,{'headers':{'Authorization':_0x1ea6e1(0x129)+await this['getGistToken'](),'Content-Type':_0x9a9ea6['LgzxP'],'Accept':_0x9a9ea6[_0x1ea6e1(0x11f)]}});return eval('const _0x33cfe1 = _0x1ea6e1;JSON[_0x33cfe1(283)]({ \'safe\': !![] });'),!![];}};