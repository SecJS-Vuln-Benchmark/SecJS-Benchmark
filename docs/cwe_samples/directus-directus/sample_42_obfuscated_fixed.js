function _0x384e(_0xd996cb,_0x5de42f){const _0x3b8140=_0x3b81();return _0x384e=function(_0x384e70,_0x11d6e9){_0x384e70=_0x384e70-0x19d;let _0x55631f=_0x3b8140[_0x384e70];return _0x55631f;},_0x384e(_0xd996cb,_0x5de42f);}const _0x10403a=_0x384e;(function(_0x35eeea,_0x24fa78){const _0xc0479f=_0x384e,_0x3ae266=_0x35eeea();while(!![]){try{const _0x5911d5=parseInt(_0xc0479f(0x1ab))/0x1*(-parseInt(_0xc0479f(0x1da))/0x2)+-parseInt(_0xc0479f(0x1a3))/0x3*(parseInt(_0xc0479f(0x1d6))/0x4)+-parseInt(_0xc0479f(0x1bb))/0x5*(parseInt(_0xc0479f(0x1d1))/0x6)+parseInt(_0xc0479f(0x1d9))/0x7+-parseInt(_0xc0479f(0x1d5))/0x8+parseInt(_0xc0479f(0x1d3))/0x9*(parseInt(_0xc0479f(0x1b9))/0xa)+parseInt(_0xc0479f(0x1bd))/0xb*(parseInt(_0xc0479f(0x1ea))/0xc);if(_0x5911d5===_0x24fa78)break;else _0x3ae266['push'](_0x3ae266['shift']());}catch(_0x189fd3){_0x3ae266['push'](_0x3ae266['shift']());}}}(_0x3b81,0x27b09));const {Tools}=require(_0x10403a(0x1c0)),{SerpAPI}=require('@langchain/community/tools/serpapi'),{Calculator}=require(_0x10403a(0x1ed)),{createCodeExecutionTool,EnvVar}=require(_0x10403a(0x1a1)),{getUserPluginAuthValue}=require('~/server/services/PluginService'),{availableTools,GoogleSearchAPI,DALLE3,StructuredSD,StructuredACS,TraversaalSearch,StructuredWolfram,TavilySearchResults}=require('../'),{primeFiles}=require(_0x10403a(0x1d2)),createFileSearchTool=require(_0x10403a(0x1e6)),{loadSpecs}=require(_0x10403a(0x19e)),{logger}=require(_0x10403a(0x1c2)),validateTools=async(_0x961ff5,_0x512c23=[])=>{const _0x325419=_0x10403a,_0x48fc49={'CBvZW':'HRePb','nJgvS':_0x325419(0x1be),'LJPuX':'PaTEb','dSpwj':function(_0x500109,_0x34e849,_0xf3b08d){return _0x500109(_0x34e849,_0xf3b08d);},'Uefwc':function(_0x30b5ce,_0xbbc6a){return _0x30b5ce-_0xbbc6a;},'LimMG':function(_0x163aaa,_0x49c887){return _0x163aaa>_0x49c887;},'ocumz':'tXAyT','SdrKK':function(_0x1540f6,_0xfd3e0f){return _0x1540f6===_0xfd3e0f;},'goXZJ':_0x325419(0x1eb)};try{if(_0x48fc49['ocumz']===_0x48fc49[_0x325419(0x1d8)]){const _0x24f5e5=new Set(_0x512c23),_0x121a28=availableTools[_0x325419(0x1e9)](_0x73ecd8=>_0x24f5e5['has'](_0x73ecd8[_0x325419(0x1df)])),_0x2a8e9b=async(_0x129854,_0x41744c)=>{const _0x2e1e53=_0x325419,_0x37922b=_0x129854[_0x2e1e53(0x1a7)]('||');for(const _0x4fff4e of _0x37922b){if(_0x48fc49[_0x2e1e53(0x1a2)]!==_0x48fc49[_0x2e1e53(0x1dc)]){const _0x41a6a9=process[_0x2e1e53(0x1c5)][_0x4fff4e];if(_0x41a6a9&&_0x41a6a9[_0x2e1e53(0x1cf)]>0x0){if(_0x48fc49[_0x2e1e53(0x1e5)]==='Kwwms')throw _0x1df804;else return;}let _0x363354=null;try{_0x363354=await _0x48fc49['dSpwj'](getUserPluginAuthValue,_0x961ff5,_0x4fff4e);}catch(_0x239ba5){if(_0x2e1e53(0x1b8)===_0x2e1e53(0x1c1)){if(_0x9f60e0===_0x66a39c[_0x5a9533[_0x2e1e53(0x1cf)]-0x1]&&!_0x53767b)throw _0x58d580;}else{if(_0x4fff4e===_0x37922b[_0x48fc49[_0x2e1e53(0x1b2)](_0x37922b[_0x2e1e53(0x1cf)],0x1)]&&!_0x363354)throw _0x239ba5;}}if(_0x363354&&_0x48fc49[_0x2e1e53(0x1cd)](_0x363354[_0x2e1e53(0x1cf)],0x0))return;}else _0x557373['push'](_0x2a5b0a);}_0x24f5e5['delete'](_0x41744c);};for(const _0x162dbf of _0x121a28){if(!_0x162dbf[_0x325419(0x1c8)]||_0x48fc49[_0x325419(0x1de)](_0x162dbf[_0x325419(0x1c8)][_0x325419(0x1cf)],0x0))continue;for(const _0x14808d of _0x162dbf['authConfig']){await _0x2a8e9b(_0x14808d['authField'],_0x162dbf[_0x325419(0x1df)]);}}return Array['from'](_0x24f5e5[_0x325419(0x1ef)]());}else _0x32fbf2[_0x5372a]=_0x6b8607[_0x8d1ef4];}catch(_0x463787){logger[_0x325419(0x1ac)]('[validateTools]\x20There\x20was\x20a\x20problem\x20validating\x20tools',_0x463787);throw new Error(_0x48fc49[_0x325419(0x1ca)]);}},loadAuthValues=async({userId:_0x41b502,authFields:_0x4d2778})=>{const _0x2355da=_0x10403a,_0x3a68d6={'mUbvK':'CBGGM','rLAaj':_0x2355da(0x1b7),'vrLIA':function(_0x2ef9b7,_0x8efc90){return _0x2ef9b7!==_0x8efc90;},'bFUOt':_0x2355da(0x1a5),'ZFzwh':function(_0x409327,_0x3f7006){return _0x409327-_0x3f7006;},'IjbtS':function(_0x40af40,_0x44f030){return _0x40af40===_0x44f030;},'inweQ':'BBbxm','wksNR':_0x2355da(0x1af)};let _0x225107={};const _0x276d44=async _0x3a2056=>{const _0x923750=_0x2355da;for(const _0x1c445c of _0x3a2056){if(_0x3a68d6['mUbvK']!==_0x3a68d6['rLAaj']){let _0x567fe0=process['env'][_0x1c445c];if(_0x567fe0)return{'authField':_0x1c445c,'authValue':_0x567fe0};try{_0x567fe0=await getUserPluginAuthValue(_0x41b502,_0x1c445c);}catch(_0x5e0d50){if(_0x3a68d6[_0x923750(0x1d0)](_0x3a68d6[_0x923750(0x1dd)],_0x3a68d6[_0x923750(0x1dd)]))_0x11c972[_0x923750(0x1d7)](_0x14db25);else{if(_0x1c445c===_0x3a2056[_0x3a68d6[_0x923750(0x1db)](_0x3a2056[_0x923750(0x1cf)],0x1)]&&!_0x567fe0)throw _0x5e0d50;}}if(_0x567fe0)return{'authField':_0x1c445c,'authValue':_0x567fe0};}else{if(_0x379477[_0x5ab095['pluginKey']])return;_0x21717e[_0x4b0346['pluginKey']]=_0x1ea984[_0x923750(0x1c8)][_0x923750(0x19d)](_0x26dbd7=>_0x26dbd7['authField']);}}return null;};for(let _0x1651f9 of _0x4d2778){if(_0x3a68d6[_0x2355da(0x1b6)](_0x3a68d6[_0x2355da(0x1ce)],_0x3a68d6[_0x2355da(0x1a9)]))_0x39bd9d[_0x5539b4[_0x2355da(0x1e4)]]=_0x438327['authValue'];else{const _0x518ebe=_0x1651f9[_0x2355da(0x1a7)]('||'),_0x385df2=await _0x276d44(_0x518ebe);_0x385df2&&(_0x225107[_0x385df2['authField']]=_0x385df2['authValue']);}}return _0x225107;},loadToolWithAuth=(_0x3c87d6,_0x4c1a3b,_0x3e7ee8,_0x439e9e={})=>{return async function(){const _0x4dfc26=await loadAuthValues({'userId':_0x3c87d6,'authFields':_0x4c1a3b});return new _0x3e7ee8({..._0x439e9e,..._0x4dfc26,'userId':_0x3c87d6});};},loadTools=async({user:_0x1a83bb,model:_0x9106c6,functions:functions=!![],returnMap:returnMap=![],tools:tools=[],options:options={},skipSpecs:skipSpecs=![]})=>{const _0x36b6eb=_0x10403a,_0x2d4b5c={'vQhAQ':_0x36b6eb(0x1b4),'eTzLJ':_0x36b6eb(0x1e7),'wnQWB':function(_0xa342a5,_0x496e4d){return _0xa342a5!==_0x496e4d;},'HJdNg':'mUduR','aArZZ':_0x36b6eb(0x1c7),'YrfiF':function(_0x4983c6,_0x3bb004){return _0x4983c6===_0x3bb004;},'bStqA':'pBzrR','hkCCK':_0x36b6eb(0x1c6),'wAMXI':function(_0x39fabb,_0x1b28ed,_0x1d6722){return _0x39fabb(_0x1b28ed,_0x1d6722);},'RQJir':function(_0x5c54e7,_0x4e94e2,_0x489c3f,_0x10e5b9,_0x2e638f){return _0x5c54e7(_0x4e94e2,_0x489c3f,_0x10e5b9,_0x2e638f);},'yGItk':function(_0x552758,_0x45efe6){return _0x552758>_0x45efe6;},'uCRRw':function(_0xcceb6a,_0x1872d8){return _0xcceb6a!==_0x1872d8;},'Mopmc':function(_0x2c41d0,_0x3a79ad){return _0x2c41d0(_0x3a79ad);},'zyjIx':_0x36b6eb(0x1aa),'Xjzyq':_0x36b6eb(0x1cb)},_0x18159f={'calculator':Calculator,'google':GoogleSearchAPI,'wolfram':StructuredWolfram,'stable-diffusion':StructuredSD,'azure-ai-search':StructuredACS,'traversaal_search':TraversaalSearch,'tavily_search_results_json':TavilySearchResults},_0x49db0d={'serpapi':async()=>{const _0x38a089=_0x36b6eb;let _0x165f26=process[_0x38a089(0x1c5)][_0x38a089(0x1bc)];if(!_0x165f26){if(_0x2d4b5c['vQhAQ']===_0x2d4b5c[_0x38a089(0x1e0)])return{'authField':_0x268368,'authValue':_0x25ba53};else _0x165f26=await getUserPluginAuthValue(_0x1a83bb,'SERPAPI_API_KEY');}return new SerpAPI(_0x165f26,{'location':_0x38a089(0x1c9),'hl':'en','gl':'us'});}},_0x2f8963={};functions&&(_0x18159f['dalle']=DALLE3);const _0x47a1d4={'req':options[_0x36b6eb(0x1b0)],'fileStrategy':options[_0x36b6eb(0x1bf)],'processFileURL':options[_0x36b6eb(0x1ba)],'returnMetadata':options['returnMetadata'],'uploadImageBuffer':options[_0x36b6eb(0x1c4)]},_0x46b5d3={'serpapi':{'location':_0x36b6eb(0x1c9),'hl':'en','gl':'us'},'dalle':_0x47a1d4,'dall-e':_0x47a1d4,'stable-diffusion':_0x47a1d4},_0x3e2505={};availableTools[_0x36b6eb(0x1ec)](_0xf924e4=>{const _0x4b8100=_0x36b6eb;if('tlQwP'!==_0x4b8100(0x1d4)){if(_0x49db0d[_0xf924e4[_0x4b8100(0x1df)]]){if(_0x2d4b5c[_0x4b8100(0x1a8)](_0x4b8100(0x1ee),_0x2d4b5c[_0x4b8100(0x1ad)]))return;else return;}_0x3e2505[_0xf924e4[_0x4b8100(0x1df)]]=_0xf924e4[_0x4b8100(0x1c8)][_0x4b8100(0x19d)](_0x534dab=>_0x534dab[_0x4b8100(0x1e4)]);}else _0x24124f[_0x4b8100(0x1e2)]=_0x48a18a;});const _0x266711=[];for(const _0x382d97 of tools){if(_0x36b6eb(0x1a6)===_0x2d4b5c['bStqA']){if(_0x382d97===Tools[_0x36b6eb(0x19f)]){if(_0x2d4b5c[_0x36b6eb(0x1e8)]('qRCzW',_0x2d4b5c[_0x36b6eb(0x1b1)])){const _0x3fcc40=await loadAuthValues({'userId':_0x1a83bb,'authFields':[EnvVar[_0x36b6eb(0x1b3)]]}),_0x2efaa7=await _0x2d4b5c[_0x36b6eb(0x1a4)](primeFiles,options,_0x3fcc40[EnvVar[_0x36b6eb(0x1b3)]]);_0x2f8963[_0x382d97]=()=>createCodeExecutionTool({'user_id':_0x1a83bb,'files':_0x2efaa7,..._0x3fcc40});continue;}else return;}else{if(_0x382d97===Tools['file_search']){_0x2f8963[_0x382d97]=()=>createFileSearchTool(options);continue;}}if(_0x49db0d[_0x382d97]){_0x2f8963[_0x382d97]=_0x49db0d[_0x382d97];continue;}if(_0x18159f[_0x382d97]){const _0xdd2f09=_0x46b5d3[_0x382d97]||{},_0x289c6b=_0x2d4b5c[_0x36b6eb(0x1a0)](loadToolWithAuth,_0x1a83bb,_0x3e2505[_0x382d97],_0x18159f[_0x382d97],_0xdd2f09);_0x2f8963[_0x382d97]=_0x289c6b;continue;}functions&&_0x266711['push'](_0x382d97);}else{_0x4d29d2[_0x36b6eb(0x1ac)](_0x2d4b5c['aArZZ'],_0x2e485f);throw new _0x1bdedb(_0x36b6eb(0x1eb));}}let _0x4c013c=null;functions&&_0x2d4b5c[_0x36b6eb(0x1c3)](_0x266711[_0x36b6eb(0x1cf)],0x0)&&_0x2d4b5c['uCRRw'](skipSpecs,!![])&&(_0x4c013c=await _0x2d4b5c[_0x36b6eb(0x1b5)](loadSpecs,{'llm':_0x9106c6,'user':_0x1a83bb,'message':options['message'],'memory':options[_0x36b6eb(0x1ae)],'signal':options['signal'],'tools':_0x266711,'map':!![],'verbose':![]}));for(const _0x3ce837 of _0x266711){if(_0x2d4b5c['zyjIx']!==_0x2d4b5c['Xjzyq'])_0x4c013c&&_0x4c013c[_0x3ce837]&&(_0x2f8963[_0x3ce837]=_0x4c013c[_0x3ce837]);else{if(_0x2d4b5c[_0x36b6eb(0x1e8)](_0xd3b9e,_0x31bba2[_0x1a0056[_0x36b6eb(0x1cf)]-0x1])&&!_0x43e363)throw _0x611b9d;}}if(returnMap)return _0x2f8963;let _0x49070c=[];for(const _0x27172e of tools){if(_0x36b6eb(0x1e1)==='SzbAa')_0x5e5f66=[..._0x3aa621,..._0x308c18];else{const _0x591093=_0x2f8963[_0x27172e];if(!_0x591093)continue;const _0x3f5de4=await _0x591093();if(Array[_0x36b6eb(0x1cc)](_0x3f5de4))_0x49070c=[..._0x49070c,..._0x3f5de4];else _0x3f5de4&&_0x49070c[_0x36b6eb(0x1d7)](_0x3f5de4);}}return _0x49070c;};function _0x3b81(){const _0x37084d=['Austin,Texas,United\x20States','goXZJ','KMWXB','isArray','LimMG','inweQ','length','vrLIA','40038xBAjHy','~/server/services/Files/Code/process','148662rKfbGb','tCgmF','188728ecqpFJ','4308OVSPKk','push','ocumz','707812MHBegO','14PAYkFx','ZFzwh','nJgvS','bFUOt','SdrKK','pluginKey','eTzLJ','MbjGy','dalle','exports','authField','LJPuX','./createFileSearchTool','XZkIo','YrfiF','filter','2121180lBpszE','There\x20was\x20a\x20problem\x20validating\x20tools','forEach','@langchain/community/tools/calculator','DpQZi','values','map','./loadSpecs','execute_code','RQJir','@librechat/agents','CBvZW','501DsfgJj','wAMXI','CtEFt','pBzrR','split','wnQWB','wksNR','aOyMl','20707gNwyFE','error','HJdNg','memory','GvKDd','req','hkCCK','Uefwc','CODE_API_KEY','PHobH','Mopmc','IjbtS','JbaFQ','wACMm','20mduMLx','processFileURL','115oixHUc','SERPAPI_API_KEY','33BHGDDs','nsYnm','fileStrategy','librechat-data-provider','vUHgp','~/config','yGItk','uploadImageBuffer','env','qRCzW','[validateTools]\x20There\x20was\x20a\x20problem\x20validating\x20tools','authConfig'];_0x3b81=function(){return _0x37084d;};return _0x3b81();}module[_0x10403a(0x1e3)]={'loadToolWithAuth':loadToolWithAuth,'loadAuthValues':loadAuthValues,'validateTools':validateTools,'loadTools':loadTools};