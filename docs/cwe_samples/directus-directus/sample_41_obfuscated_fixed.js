function _0x1b8f(_0x2fe184,_0x1ae94d){const _0xda5c79=_0xda5c();return _0x1b8f=function(_0x1b8f2e,_0x50686b){_0x1b8f2e=_0x1b8f2e-0x130;let _0x3ad374=_0xda5c79[_0x1b8f2e];return _0x3ad374;},_0x1b8f(_0x2fe184,_0x1ae94d);}function _0xda5c(){const _0x1f412a=['error','source','describe','11yVOXcy','length','post','\x0aRelevance:\x20','pop','A\x20natural\x20language\x20query\x20to\x20search\x20for\x20relevant\x20information\x20in\x20the\x20files.\x20Be\x20specific\x20and\x20use\x20keywords\x20related\x20to\x20the\x20information\x20you\x27re\x20looking\x20for.\x20The\x20query\x20will\x20be\x20used\x20for\x20semantic\x20similarity\x20matching\x20against\x20the\x20file\x20contents.','~/models/File','/query','join','file_search','9mvVCaq','6096210fHneXv','relevanceScore','page_content','\x0a---\x0a','content','wJjRP','10561572glAtqH','110418naTDHO','Error\x20encountered\x20in\x20`file_search`\x20while\x20querying\x20file_id\x20','sort','451227IbTKxG','catch','split','map','221839LQqUpK','65JCFjmQ','File:\x20','filename','RAG_API_URL','_id','all','env','file_id','zod','headers','authorization','4EztHSC','librechat-data-provider','4WjFPOg','4023448OKNSQQ','flatMap','data','axios','file_ids','@langchain/core/tools','object','281330FcnhrN','exports','\x0aContent:\x20','metadata'];_0xda5c=function(){return _0x1f412a;};return _0xda5c();}const _0x3d3367=_0x1b8f;(function(_0x56259b,_0x3ce81f){const _0x59b01e=_0x1b8f,_0xd508b1=_0x56259b();while(!![]){try{const _0x1d249a=parseInt(_0x59b01e(0x14b))/0x1*(parseInt(_0x59b01e(0x157))/0x2)+parseInt(_0x59b01e(0x147))/0x3*(-parseInt(_0x59b01e(0x159))/0x4)+-parseInt(_0x59b01e(0x14c))/0x5*(-parseInt(_0x59b01e(0x144))/0x6)+parseInt(_0x59b01e(0x161))/0x7+-parseInt(_0x59b01e(0x15a))/0x8+parseInt(_0x59b01e(0x13c))/0x9*(-parseInt(_0x59b01e(0x13d))/0xa)+-parseInt(_0x59b01e(0x132))/0xb*(-parseInt(_0x59b01e(0x143))/0xc);if(_0x1d249a===_0x3ce81f)break;else _0xd508b1['push'](_0xd508b1['shift']());}catch(_0x593c30){_0xd508b1['push'](_0xd508b1['shift']());}}}(_0xda5c,0x53135));const {z}=require(_0x3d3367(0x154)),axios=require(_0x3d3367(0x15d)),{tool}=require(_0x3d3367(0x15f)),{Tools,EToolResources}=require(_0x3d3367(0x158)),{getFiles}=require(_0x3d3367(0x138)),{logger}=require('~/config'),createFileSearchTool=async _0x3f232b=>{const _0x414dec=_0x3d3367,_0x201a1c={'wJjRP':function(_0x1ac836,_0x1e97d0){return _0x1ac836(_0x1e97d0);}},{req:_0x5c3dc2,tool_resources:_0x59468b}=_0x3f232b,_0x3fe498=_0x59468b?.[EToolResources[_0x414dec(0x13b)]]?.[_0x414dec(0x15e)]??[],_0x19319c=(await _0x201a1c[_0x414dec(0x142)](getFiles,{'file_id':{'$in':_0x3fe498}}))[_0x414dec(0x14a)](_0x1eca21=>({'file_id':_0x1eca21[_0x414dec(0x153)],'filename':_0x1eca21[_0x414dec(0x14e)]})),_0x1cb41f=_0x19319c['map'](_0x460e2d=>'-\x20'+_0x460e2d[_0x414dec(0x14e)])[_0x414dec(0x13a)]('\x0a'),_0x286017='Performs\x20a\x20semantic\x20search\x20based\x20on\x20a\x20natural\x20language\x20query\x20across\x20the\x20following\x20files:\x0a'+_0x1cb41f,_0x5cb495=tool(async({query:_0x1eef9f})=>{const _0x5e753b=_0x414dec;if(_0x19319c[_0x5e753b(0x133)]===0x0)return'No\x20files\x20to\x20search.\x20Instruct\x20the\x20user\x20to\x20add\x20files\x20for\x20the\x20search.';const _0x55a7ca=_0x5c3dc2[_0x5e753b(0x155)][_0x5e753b(0x156)][_0x5e753b(0x149)]('\x20')[0x1];if(!_0x55a7ca)return'There\x20was\x20an\x20error\x20authenticating\x20the\x20file\x20search\x20request.';const _0x1a544f=_0x19319c[_0x5e753b(0x14a)](_0x5e090f=>axios[_0x5e753b(0x134)](process[_0x5e753b(0x152)][_0x5e753b(0x14f)]+_0x5e753b(0x139),{'file_id':_0x5e090f[_0x5e753b(0x153)],'query':_0x1eef9f,'k':0x5},{'headers':{'Authorization':'Bearer\x20'+_0x55a7ca,'Content-Type':'application/json'}})[_0x5e753b(0x148)](_0x28c01f=>{const _0x2a295e=_0x5e753b;return logger[_0x2a295e(0x165)](_0x2a295e(0x145)+_0x5e090f[_0x2a295e(0x150)]+':',_0x28c01f),null;})),_0x35432e=await Promise[_0x5e753b(0x151)](_0x1a544f),_0x415282=_0x35432e['filter'](_0x37cb36=>_0x37cb36!==null);if(_0x415282[_0x5e753b(0x133)]===0x0)return'No\x20results\x20found\x20or\x20errors\x20occurred\x20while\x20searching\x20the\x20files.';const _0x2803cb=_0x415282[_0x5e753b(0x15b)](_0x2be84a=>_0x2be84a[_0x5e753b(0x15c)]['map'](([_0x510074,_0x45ccf4])=>({'filename':_0x510074[_0x5e753b(0x164)][_0x5e753b(0x130)][_0x5e753b(0x149)]('/')[_0x5e753b(0x136)](),'content':_0x510074[_0x5e753b(0x13f)],'relevanceScore':_0x45ccf4})))[_0x5e753b(0x146)]((_0x253f19,_0x5adbda)=>_0x5adbda[_0x5e753b(0x13e)]-_0x253f19[_0x5e753b(0x13e)]),_0xf7fb44=_0x2803cb[_0x5e753b(0x14a)](_0x59e2f5=>_0x5e753b(0x14d)+_0x59e2f5[_0x5e753b(0x14e)]+_0x5e753b(0x135)+_0x59e2f5[_0x5e753b(0x13e)]['toFixed'](0x4)+_0x5e753b(0x163)+_0x59e2f5[_0x5e753b(0x141)]+'\x0a')[_0x5e753b(0x13a)](_0x5e753b(0x140));return _0xf7fb44;},{'name':Tools['file_search'],'description':_0x286017,'schema':z[_0x414dec(0x160)]({'query':z['string']()[_0x414dec(0x131)](_0x414dec(0x137))})});return _0x5cb495;};module[_0x3d3367(0x162)]=createFileSearchTool;