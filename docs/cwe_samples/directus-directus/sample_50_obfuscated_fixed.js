function _0x2dfd(_0x172a0d,_0x19846d){const _0x12ec8a=_0x12ec();return _0x2dfd=function(_0x2dfddf,_0x48f71b){_0x2dfddf=_0x2dfddf-0x16e;let _0x4c130e=_0x12ec8a[_0x2dfddf];return _0x4c130e;},_0x2dfd(_0x172a0d,_0x19846d);}const _0x12ee71=_0x2dfd;(function(_0x6ac40c,_0x2850d5){const _0x28915b=_0x2dfd,_0x57cfdd=_0x6ac40c();while(!![]){try{const _0x3d4791=-parseInt(_0x28915b(0x184))/0x1+-parseInt(_0x28915b(0x175))/0x2+-parseInt(_0x28915b(0x1bf))/0x3*(-parseInt(_0x28915b(0x189))/0x4)+-parseInt(_0x28915b(0x197))/0x5*(parseInt(_0x28915b(0x1a4))/0x6)+parseInt(_0x28915b(0x19a))/0x7+-parseInt(_0x28915b(0x1bd))/0x8+parseInt(_0x28915b(0x1aa))/0x9*(parseInt(_0x28915b(0x1a8))/0xa);if(_0x3d4791===_0x2850d5)break;else _0x57cfdd['push'](_0x57cfdd['shift']());}catch(_0x3439e4){_0x57cfdd['push'](_0x57cfdd['shift']());}}}(_0x12ec,0x9c334));const {Session,Balance,getFiles,deleteFiles,deleteConvos,deletePresets,deleteMessages,deleteUserById}=require('~/models'),User=require(_0x12ee71(0x172)),{updateUserPluginAuth,deleteUserPluginAuth}=require(_0x12ee71(0x1b5)),{updateUserPluginsService,deleteUserKey}=require(_0x12ee71(0x170)),{verifyEmail,resendVerificationEmail}=require('~/server/services/AuthService'),{processDeleteRequest}=require(_0x12ee71(0x199)),{deleteAllSharedLinks}=require('~/models/Share'),{Transaction}=require(_0x12ee71(0x1ab)),{logger}=require(_0x12ee71(0x1b0)),getUserController=async(_0x3ed28b,_0x3794d0)=>{const _0x2846e9=_0x12ee71;_0x3794d0['status'](0xc8)[_0x2846e9(0x1b7)](_0x3ed28b[_0x2846e9(0x18e)]);},getTermsStatusController=async(_0x1d4ac7,_0x8e57a9)=>{const _0x3327ba=_0x12ee71;try{const _0xe9ba15=await User['findById'](_0x1d4ac7[_0x3327ba(0x18e)]['id']);if(!_0xe9ba15)return _0x8e57a9[_0x3327ba(0x191)](0x194)[_0x3327ba(0x19c)]({'message':'User\x20not\x20found'});_0x8e57a9['status'](0xc8)[_0x3327ba(0x19c)]({'termsAccepted':!!_0xe9ba15[_0x3327ba(0x17c)]});}catch(_0x2c8a47){logger['error'](_0x3327ba(0x188),_0x2c8a47),_0x8e57a9[_0x3327ba(0x191)](0x1f4)[_0x3327ba(0x19c)]({'message':_0x3327ba(0x17d)});}},acceptTermsController=async(_0x3a6636,_0x55de9d)=>{const _0x33cc72=_0x12ee71,_0x3f199f={'KRGZt':_0x33cc72(0x187),'fyCLR':function(_0x34f4d7,_0x2ff33d){return _0x34f4d7===_0x2ff33d;},'HCWoa':_0x33cc72(0x192),'zdIqg':_0x33cc72(0x18d),'cvmqv':_0x33cc72(0x1a2)};try{if(_0x3f199f['fyCLR'](_0x33cc72(0x16e),_0x33cc72(0x181))){_0xbecbb3[_0x33cc72(0x177)](_0x3f199f[_0x33cc72(0x1b9)],_0x27d0fa);const {status:_0x5490c7,message:_0xbe7760}=_0x1658a7;_0x4abf80[_0x33cc72(0x191)](_0x5490c7)[_0x33cc72(0x1b7)]({'message':_0xbe7760});}else{const _0x2228e3=await User[_0x33cc72(0x1b6)](_0x3a6636[_0x33cc72(0x18e)]['id'],{'termsAccepted':!![]},{'new':!![]});if(!_0x2228e3)return _0x55de9d[_0x33cc72(0x191)](0x194)[_0x33cc72(0x19c)]({'message':_0x3f199f[_0x33cc72(0x19d)]});_0x55de9d['status'](0xc8)[_0x33cc72(0x19c)]({'message':_0x3f199f['zdIqg']});}}catch(_0x3d78a4){if(_0x3f199f[_0x33cc72(0x1b3)]===_0x33cc72(0x1a2))logger['error'](_0x33cc72(0x1a9),_0x3d78a4),_0x55de9d[_0x33cc72(0x191)](0x1f4)[_0x33cc72(0x19c)]({'message':_0x33cc72(0x173)});else return _0xe8d39[_0x33cc72(0x191)](0xc8)['json'](_0x5f3cc0);}},deleteUserFiles=async _0x52a3ef=>{const _0x592abd=_0x12ee71,_0x179a26={'lZhPh':function(_0x36308c,_0xd3b28){return _0x36308c(_0xd3b28);},'SUhTk':_0x592abd(0x1ac)};try{const _0x2ac543=await _0x179a26[_0x592abd(0x1ba)](getFiles,{'user':_0x52a3ef['user']['id']});await processDeleteRequest({'req':_0x52a3ef,'files':_0x2ac543});}catch(_0x1884da){logger[_0x592abd(0x177)](_0x179a26[_0x592abd(0x16f)],_0x1884da);}},updateUserPluginsController=async(_0x26165f,_0x4c9e99)=>{const _0x3db02d=_0x12ee71,_0x5ef7fe={'LLSlP':_0x3db02d(0x173),'uytrF':function(_0xd2fc22,_0x1f5488){return _0xd2fc22 instanceof _0x1f5488;},'hRJHk':_0x3db02d(0x187),'AUQZs':_0x3db02d(0x1bb),'LRcfB':'xSjhZ','AnVUC':function(_0x5ee81d,_0x1d9b34){return _0x5ee81d<_0x1d9b34;},'zQlaR':function(_0x22ba1d,_0x35264d){return _0x22ba1d instanceof _0x35264d;},'bEOXy':_0x3db02d(0x1a3),'VlfOW':function(_0x3f424e,_0x2e2342){return _0x3f424e===_0x2e2342;},'AsnoZ':_0x3db02d(0x18c),'zpAaW':function(_0x75dc4d,_0x2c499a){return _0x75dc4d>_0x2c499a;},'OpHOA':_0x3db02d(0x176),'HIAxa':_0x3db02d(0x18f)},{user:_0x4eeb87}=_0x26165f,{pluginKey:_0x2460cf,action:_0x6186a3,auth:_0x134a85,isEntityTool:_0x13d423}=_0x26165f['body'];let _0x444f85;try{if(!_0x13d423){const _0x40c379=await updateUserPluginsService(_0x4eeb87,_0x2460cf,_0x6186a3);if(_0x5ef7fe[_0x3db02d(0x1a5)](_0x40c379,Error)){logger[_0x3db02d(0x177)](_0x5ef7fe['hRJHk'],_0x40c379);const {status:_0x3ce9a2,message:_0x9dc5c7}=_0x40c379;_0x4c9e99[_0x3db02d(0x191)](_0x3ce9a2)[_0x3db02d(0x1b7)]({'message':_0x9dc5c7});}}if(_0x134a85){const _0x125375=Object[_0x3db02d(0x17f)](_0x134a85),_0xfc896e=Object[_0x3db02d(0x171)](_0x134a85);if(_0x6186a3===_0x5ef7fe[_0x3db02d(0x1a0)]&&_0x125375[_0x3db02d(0x17a)]>0x0){if(_0x5ef7fe[_0x3db02d(0x1bc)]!==_0x3db02d(0x179))for(let _0x2adca4=0x0;_0x5ef7fe[_0x3db02d(0x194)](_0x2adca4,_0x125375[_0x3db02d(0x17a)]);_0x2adca4++){if('bhPcA'!=='bhPcA')_0x4c230a['error'](_0x3db02d(0x1a9),_0x3eaff0),_0x4744df[_0x3db02d(0x191)](0x1f4)[_0x3db02d(0x19c)]({'message':_0x5ef7fe[_0x3db02d(0x186)]});else{_0x444f85=await updateUserPluginAuth(_0x4eeb87['id'],_0x125375[_0x2adca4],_0x2460cf,_0xfc896e[_0x2adca4]);if(_0x5ef7fe[_0x3db02d(0x1b4)](_0x444f85,Error)){logger['error'](_0x5ef7fe[_0x3db02d(0x1b2)],_0x444f85);const {status:_0x114109,message:_0x395856}=_0x444f85;_0x4c9e99[_0x3db02d(0x191)](_0x114109)[_0x3db02d(0x1b7)]({'message':_0x395856});}}}else return _0x5120e6[_0x3db02d(0x191)](0xc8)[_0x3db02d(0x19c)](_0x19d357);}if(_0x5ef7fe[_0x3db02d(0x195)](_0x6186a3,_0x5ef7fe[_0x3db02d(0x17e)])&&_0x5ef7fe[_0x3db02d(0x1ad)](_0x125375[_0x3db02d(0x17a)],0x0))for(let _0x1b0b10=0x0;_0x5ef7fe[_0x3db02d(0x194)](_0x1b0b10,_0x125375[_0x3db02d(0x17a)]);_0x1b0b10++){_0x444f85=await deleteUserPluginAuth(_0x4eeb87['id'],_0x125375[_0x1b0b10]);if(_0x5ef7fe[_0x3db02d(0x1b4)](_0x444f85,Error)){logger[_0x3db02d(0x177)](_0x3db02d(0x1a3),_0x444f85);const {status:_0x496fb2,message:_0x4945cd}=_0x444f85;_0x4c9e99[_0x3db02d(0x191)](_0x496fb2)[_0x3db02d(0x1b7)]({'message':_0x4945cd});}}}_0x4c9e99[_0x3db02d(0x191)](0xc8)['send']();}catch(_0xdf7a2e){return logger[_0x3db02d(0x177)](_0x5ef7fe[_0x3db02d(0x180)],_0xdf7a2e),_0x4c9e99[_0x3db02d(0x191)](0x1f4)[_0x3db02d(0x19c)]({'message':_0x5ef7fe[_0x3db02d(0x1a7)]});}},deleteUserController=async(_0x155ce6,_0x520b90)=>{const _0x53d46c=_0x12ee71,_0x4767e8={'TDTGX':function(_0x81e449,_0x577f26){return _0x81e449(_0x577f26);},'xGpQx':function(_0x5e6310,_0x1f2625){return _0x5e6310(_0x1f2625);},'jFnsL':function(_0x57cb26,_0x48e34c,_0x35a76f){return _0x57cb26(_0x48e34c,_0x35a76f);},'lgwnT':function(_0x226c4f,_0x55aaee){return _0x226c4f===_0x55aaee;},'bAGOB':'qDlgs','UNDZA':'[deleteUserController]','UFESU':_0x53d46c(0x18f)},{user:_0xb0df6}=_0x155ce6;try{await deleteMessages({'user':_0xb0df6['id']}),await Session['deleteMany']({'user':_0xb0df6['id']}),await Transaction['deleteMany']({'user':_0xb0df6['id']}),await deleteUserKey({'userId':_0xb0df6['id'],'all':!![]}),await Balance[_0x53d46c(0x19e)]({'user':_0xb0df6[_0x53d46c(0x196)]}),await deletePresets(_0xb0df6['id']),await _0x4767e8[_0x53d46c(0x190)](deleteConvos,_0xb0df6['id']),await deleteUserPluginAuth(_0xb0df6['id'],null,!![]),await deleteUserById(_0xb0df6['id']),await _0x4767e8[_0x53d46c(0x17b)](deleteAllSharedLinks,_0xb0df6['id']),await _0x4767e8[_0x53d46c(0x190)](deleteUserFiles,_0x155ce6),await _0x4767e8[_0x53d46c(0x182)](deleteFiles,null,_0xb0df6['id']),logger['info'](_0x53d46c(0x185)+_0xb0df6[_0x53d46c(0x1a6)]+_0x53d46c(0x1ae)+_0xb0df6['id']),_0x520b90['status'](0xc8)[_0x53d46c(0x1b7)]({'message':_0x53d46c(0x19f)});}catch(_0x434e8f){if(_0x4767e8['lgwnT'](_0x53d46c(0x1a1),_0x4767e8[_0x53d46c(0x1b1)]))_0xb7143['status'](0xc8)[_0x53d46c(0x1b7)](_0x488f18[_0x53d46c(0x18e)]);else return logger[_0x53d46c(0x177)](_0x4767e8[_0x53d46c(0x1b8)],_0x434e8f),_0x520b90[_0x53d46c(0x191)](0x1f4)[_0x53d46c(0x19c)]({'message':_0x4767e8['UFESU']});}},verifyEmailController=async(_0x3b67ef,_0x152f21)=>{const _0x119e53=_0x12ee71,_0x4ec083={'iTrtv':_0x119e53(0x1ac),'yvzqt':_0x119e53(0x193),'gxkYW':_0x119e53(0x174),'JGgSH':_0x119e53(0x1af)};try{if('Ztxec'!==_0x4ec083[_0x119e53(0x1be)]){const _0x546652=await verifyEmail(_0x3b67ef);if(_0x546652 instanceof Error){if(_0x119e53(0x174)!==_0x4ec083[_0x119e53(0x183)])_0x11daa1[_0x119e53(0x177)](_0x4ec083[_0x119e53(0x19b)],_0x274329);else return _0x152f21[_0x119e53(0x191)](0x190)[_0x119e53(0x19c)](_0x546652);}else return _0x152f21[_0x119e53(0x191)](0xc8)['json'](_0x546652);}else return _0x4e38d9['status'](0x190)['json'](_0x1433c6);}catch(_0x2ca700){return logger[_0x119e53(0x177)](_0x4ec083[_0x119e53(0x178)],_0x2ca700),_0x152f21['status'](0x1f4)['json']({'message':_0x119e53(0x18f)});}},resendVerificationController=async(_0x1780d5,_0x40403c)=>{const _0x4de254=_0x12ee71,_0x5accfb={'FyHGe':function(_0x52d34f,_0xd0c921){return _0x52d34f(_0xd0c921);},'ppGzM':function(_0x3a5efe,_0x4c8246){return _0x3a5efe instanceof _0x4c8246;}};try{const _0x485cfb=await _0x5accfb[_0x4de254(0x18b)](resendVerificationEmail,_0x1780d5);return _0x5accfb[_0x4de254(0x198)](_0x485cfb,Error)?_0x40403c['status'](0x190)[_0x4de254(0x19c)](_0x485cfb):_0x40403c[_0x4de254(0x191)](0xc8)[_0x4de254(0x19c)](_0x485cfb);}catch(_0x18f97f){return logger[_0x4de254(0x177)](_0x4de254(0x1af),_0x18f97f),_0x40403c[_0x4de254(0x191)](0x1f4)['json']({'message':_0x4de254(0x18f)});}};module[_0x12ee71(0x18a)]={'getUserController':getUserController,'getTermsStatusController':getTermsStatusController,'acceptTermsController':acceptTermsController,'deleteUserController':deleteUserController,'verifyEmailController':verifyEmailController,'updateUserPluginsController':updateUserPluginsController,'resendVerificationController':resendVerificationController};function _0x12ec(){const _0x376727=['User\x20deleted\x20account.\x20Email:\x20','LLSlP','[userPluginsService]','Error\x20fetching\x20terms\x20acceptance\x20status:','1302644OuGahA','exports','FyHGe','uninstall','Terms\x20accepted\x20successfully','user','Something\x20went\x20wrong.','TDTGX','status','User\x20not\x20found','EwTPv','AnVUC','VlfOW','_id','6640bgPPSY','ppGzM','~/server/services/Files/process','2873913XRuPmJ','iTrtv','json','HCWoa','deleteMany','User\x20deleted','AUQZs','mDbye','vGlTt','[authService]','5538mpMmpn','uytrF','email','HIAxa','3546870vrXRSK','Error\x20accepting\x20terms:','63yLxpUv','~/models/Transaction','[deleteUserFiles]','zpAaW','\x20ID:\x20','[verifyEmailController]','~/config','bAGOB','bEOXy','cvmqv','zQlaR','~/server/services/PluginService','findByIdAndUpdate','send','UNDZA','KRGZt','lZhPh','install','LRcfB','8345624WrAJcb','yvzqt','9mRMYqW','GQrRV','SUhTk','~/server/services/UserService','values','~/models/User','Error\x20accepting\x20terms','TeSGz','460576GCCaSV','[updateUserPluginsController]','error','JGgSH','yMiFV','length','xGpQx','termsAccepted','Error\x20fetching\x20terms\x20acceptance\x20status','AsnoZ','keys','OpHOA','gvKma','jFnsL','gxkYW','731320QEWGqF'];_0x12ec=function(){return _0x376727;};return _0x12ec();}