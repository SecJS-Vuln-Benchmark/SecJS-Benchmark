function _0x5e13(){const _0x5bdf76=['~/server/utils','~/server/services/Endpoints/bedrock','modelSpecs','oZmmI','Only\x20the\x20\x22','gptPlugins','10oDoSgl','locals','preset','app','vQJSv','attachments','~/server/services/Endpoints/gptPlugins','anthropic','azureAssistants','2799324LTkKPa','\x22\x20endpoint\x20can\x20have\x20tools\x20defined\x20in\x20the\x20preset','RHGtg','enforce','list','1513015ASINvb','DDrNX','~/server/services/Endpoints/custom','vCjyl','~/server/services/Endpoints/openAI','gETVx','Model\x20spec\x20mismatch','custom','6906xDMyaf','agents','1172943dvNlMH','NGxuA','25460WboeoN','~/server/controllers/ModelController','50tsBvRu','seJSg','openAI','azureOpenAI','~/server/services/Endpoints/anthropic','endpointOption','jSfsw','name','bedrock','yGJYR','XOlel','288LSkQgS','WEMSJ','body','sTtnG','endpoint','3200Ztsvhz','assistants','tjSIR','files','150928tBCzLi','No\x20model\x20spec\x20selected','~/server/services/Endpoints/assistants','Error\x20parsing\x20conversation','18319367bZhjHl','buildOptions','modelsConfig','google','find','~/server/services/Endpoints/agents','Error\x20parsing\x20model\x20spec','dwiuC'];_0x5e13=function(){return _0x5bdf76;};return _0x5e13();}const _0xd5d03c=_0x4f24;(function(_0x8b4b0e,_0x507c0a){const _0x36e1fd=_0x4f24,_0x3d1d50=_0x8b4b0e();while(!![]){try{const _0x3e03c3=parseInt(_0x36e1fd(0x140))/0x1*(-parseInt(_0x36e1fd(0x13e))/0x2)+parseInt(_0x36e1fd(0x13c))/0x3+-parseInt(_0x36e1fd(0x12d))/0x4+parseInt(_0x36e1fd(0x10e))/0x5*(-parseInt(_0x36e1fd(0x13a))/0x6)+-parseInt(_0x36e1fd(0x132))/0x7+-parseInt(_0x36e1fd(0x112))/0x8*(-parseInt(_0x36e1fd(0x109))/0x9)+-parseInt(_0x36e1fd(0x124))/0xa*(-parseInt(_0x36e1fd(0x116))/0xb);if(_0x3e03c3===_0x507c0a)break;else _0x3d1d50['push'](_0x3d1d50['shift']());}catch(_0x25caeb){_0x3d1d50['push'](_0x3d1d50['shift']());}}}(_0x5e13,0x5a91e));const {parseCompactConvo,EModelEndpoint,isAgentsEndpoint}=require('librechat-data-provider'),{getModelsConfig}=require(_0xd5d03c(0x13f)),azureAssistants=require('~/server/services/Endpoints/azureAssistants'),assistants=require(_0xd5d03c(0x114)),gptPlugins=require(_0xd5d03c(0x12a)),{processFiles}=require('~/server/services/Files/process'),anthropic=require(_0xd5d03c(0x144)),bedrock=require(_0xd5d03c(0x11f)),openAI=require(_0xd5d03c(0x136)),agents=require(_0xd5d03c(0x11b)),custom=require(_0xd5d03c(0x134)),google=require('~/server/services/Endpoints/google'),{handleError}=require(_0xd5d03c(0x11e)),buildFunction={[EModelEndpoint[_0xd5d03c(0x142)]]:openAI['buildOptions'],[EModelEndpoint[_0xd5d03c(0x119)]]:google[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x139)]]:custom['buildOptions'],[EModelEndpoint[_0xd5d03c(0x13b)]]:agents[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x106)]]:bedrock[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x143)]]:openAI[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x12b)]]:anthropic[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x123)]]:gptPlugins[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x10f)]]:assistants[_0xd5d03c(0x117)],[EModelEndpoint[_0xd5d03c(0x12c)]]:azureAssistants[_0xd5d03c(0x117)]};async function buildEndpointOption(_0x3d99c1,_0x2e1910,_0xbb46c2){const _0x25e5bc=_0xd5d03c,_0x449615={'oZmmI':function(_0x15e392,_0x349be7){return _0x15e392(_0x349be7);},'dwiuC':_0x25e5bc(0x115),'UNfmD':function(_0x5d4a73,_0x27f81a){return _0x5d4a73===_0x27f81a;},'vQJSv':_0x25e5bc(0x107),'gETVx':'TADMA','seJSg':function(_0x324fd1,_0x3ebc9d,_0x831e23){return _0x324fd1(_0x3ebc9d,_0x831e23);},'XOlel':_0x25e5bc(0x113),'vCjyl':function(_0xbee7d3,_0x56b6b5){return _0xbee7d3!==_0x56b6b5;},'sTtnG':function(_0x5e6eb4,_0x47367d){return _0x5e6eb4!==_0x47367d;},'NGxuA':function(_0x527aac,_0x582976){return _0x527aac===_0x582976;},'RHGtg':function(_0x310a92,_0x35db55){return _0x310a92(_0x35db55);},'WEMSJ':function(_0x270350){return _0x270350();}},{endpoint:_0x1acd11,endpointType:_0x5958}=_0x3d99c1['body'];let _0x16d5bd;try{_0x449615['UNfmD'](_0x449615[_0x25e5bc(0x128)],_0x25e5bc(0x146))?_0x4d519e[_0x25e5bc(0x10b)][_0x25e5bc(0x145)]['attachments']=_0x449615[_0x25e5bc(0x121)](_0xac41b,_0x479ca1[_0x25e5bc(0x10b)]['files']):_0x16d5bd=_0x449615[_0x25e5bc(0x121)](parseCompactConvo,{'endpoint':_0x1acd11,'endpointType':_0x5958,'conversation':_0x3d99c1['body']});}catch(_0x9300d0){return handleError(_0x2e1910,{'text':'Error\x20parsing\x20conversation'});}if(_0x3d99c1[_0x25e5bc(0x127)][_0x25e5bc(0x125)]['modelSpecs']?.[_0x25e5bc(0x131)]&&_0x3d99c1[_0x25e5bc(0x127)][_0x25e5bc(0x125)][_0x25e5bc(0x120)]?.[_0x25e5bc(0x130)]){const {list:_0x4f5f52}=_0x3d99c1[_0x25e5bc(0x127)][_0x25e5bc(0x125)]['modelSpecs'],{spec:_0x8b753e}=_0x16d5bd;if(!_0x8b753e)return'TADMA'!==_0x449615[_0x25e5bc(0x137)]?_0x1f3f7d(_0x16f079,{'text':'No\x20model\x20spec\x20selected'}):_0x449615[_0x25e5bc(0x141)](handleError,_0x2e1910,{'text':_0x449615[_0x25e5bc(0x108)]});const _0x2e8fe9=_0x4f5f52[_0x25e5bc(0x11a)](_0x1dd717=>_0x1dd717[_0x25e5bc(0x147)]===_0x8b753e);if(!_0x2e8fe9)return handleError(_0x2e1910,{'text':'Invalid\x20model\x20spec'});if(_0x449615[_0x25e5bc(0x135)](_0x1acd11,_0x2e8fe9[_0x25e5bc(0x126)][_0x25e5bc(0x10d)]))return _0x449615['seJSg'](handleError,_0x2e1910,{'text':_0x25e5bc(0x138)});if(_0x449615[_0x25e5bc(0x10c)](_0x2e8fe9[_0x25e5bc(0x126)][_0x25e5bc(0x10d)],EModelEndpoint['gptPlugins'])&&_0x2e8fe9[_0x25e5bc(0x126)]['tools'])return _0x449615[_0x25e5bc(0x13d)](_0x25e5bc(0x133),_0x25e5bc(0x133))?handleError(_0x2e1910,{'text':_0x25e5bc(0x122)+EModelEndpoint['gptPlugins']+_0x25e5bc(0x12e)}):_0x58cc5d(_0x5c2bd1,{'text':_0x449615[_0x25e5bc(0x11d)]});try{_0x16d5bd=parseCompactConvo({'endpoint':_0x1acd11,'endpointType':_0x5958,'conversation':_0x2e8fe9[_0x25e5bc(0x126)]});}catch(_0x3ee81a){return _0x449615[_0x25e5bc(0x141)](handleError,_0x2e1910,{'text':_0x25e5bc(0x11c)});}}const _0x1f1427=buildFunction[_0x5958??_0x1acd11],_0x2f1703=_0x449615[_0x25e5bc(0x12f)](isAgentsEndpoint,_0x1acd11)?(..._0x59f0fd)=>_0x1f1427(_0x3d99c1,..._0x59f0fd):_0x1f1427;_0x3d99c1['body'][_0x25e5bc(0x145)]=_0x2f1703(_0x1acd11,_0x16d5bd,_0x5958);const _0x5ad171=await _0x449615[_0x25e5bc(0x121)](getModelsConfig,_0x3d99c1);_0x3d99c1['body'][_0x25e5bc(0x145)][_0x25e5bc(0x118)]=_0x5ad171;if(_0x3d99c1[_0x25e5bc(0x10b)][_0x25e5bc(0x111)]){if(_0x25e5bc(0x110)!==_0x25e5bc(0x110))return _0x2cfcee(_0x54341b,{'text':_0x25e5bc(0x11c)});else _0x3d99c1[_0x25e5bc(0x10b)][_0x25e5bc(0x145)][_0x25e5bc(0x129)]=_0x449615[_0x25e5bc(0x12f)](processFiles,_0x3d99c1[_0x25e5bc(0x10b)]['files']);}_0x449615[_0x25e5bc(0x10a)](_0xbb46c2);}function _0x4f24(_0x2e4fb7,_0x386d87){const _0x5e13a7=_0x5e13();return _0x4f24=function(_0x4f24d0,_0x4efa4b){_0x4f24d0=_0x4f24d0-0x106;let _0x4a99c0=_0x5e13a7[_0x4f24d0];return _0x4a99c0;},_0x4f24(_0x2e4fb7,_0x386d87);}module['exports']=buildEndpointOption;