const _0x1ea74b=_0x28a4;function _0x2f87(){const _0x434260=['uMeDi','createElement','7DRILQh','directUploadUrl','autoloadImage','sbUqa','filter','saveButton','HCDst','name','signed_id','WgEtM','addEventListener','attachmentCounter','[data-dropzone]','nextElementSibling','editlabel','return\x20new\x20Date();','ImjCV','TVlZg','readAsDataURL','5772072HADMwl','modal','map','validated','error','value','ppBUO','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','appendChild','innerHTML','img','assign','button[data-dropzone-save]','zjeGU','add','click','uploadFiles','removable','auzEZ','zxIyr','locales','\x20data-filename=\x22','[data-dropzone-items]','filename','cancelButton','var\x20x\x20=\x2042;\x20return\x20x;','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','1386530MKNBjG','children','Iybwy','5745sUksQg','MVXmJ','[data-dropzone-no-items]','checked','items','[data-filename=\x22','input','arrayBuffer','firstChild','JqpdL','jTiZF','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button>','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','closest','urkpv','138237ctyzpj','QZdML','handleButtonClick','hepkA','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22\x22\x20alt=\x22','button[data-dropzone-cancel]','EyOtZ','errors','</ul>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','BTtgT','div','trim','image','type','data-attachment-id=\x22','<li>','ACUan','248CttgxQ','createUploadItem','\x0a\x20\x20\x20\x20\x20\x20<li\x20','forEach','upload','validate','push','dropZone','options','6099IiNJNj','VALIDATED','541330qCBuKu','button','dataset','uploadFile','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20class=\x22sm\x22\x20type=\x22text\x22\x20value=\x22','emptyItems','length','error-warning-line','EQNMd','876TXkPiZ','BZzSC','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','textContent','ERROR','then','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20data-template=\x22','Thhbc','18ObcqoE','</li>','remove','multiple','inpRN','qJFBg','classList','from','\x22></progress>\x0a\x20\x20\x20\x20\x20\x20</li>','uploadItems','removeAttribute','</div>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','8241506fIKkku','parse','validation_error','JiUtz','\x22]\x20progress','setProgressBar','modalTitle','querySelector','vJxyl','is-disabled','titled','bind','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','JLKKh','addlabel','test','src','48pWrvBP','updateDropZone','attachmentId','MwXKW','fufMX','disabled','title','UUcjE','148bMLOkD','RMfdx'];_0x2f87=function(){return _0x434260;};return _0x2f87();}(function(_0x4d39be,_0x1c35f5){const _0x20bdb2=_0x28a4,_0x23673d=_0x4d39be();while(!![]){try{const _0x3fa562=parseInt(_0x20bdb2(0x1e0))/0x1*(parseInt(_0x20bdb2(0x1d7))/0x2)+-parseInt(_0x20bdb2(0x24d))/0x3*(parseInt(_0x20bdb2(0x218))/0x4)+-parseInt(_0x20bdb2(0x1e2))/0x5*(parseInt(_0x20bdb2(0x210))/0x6)+-parseInt(_0x20bdb2(0x21c))/0x7*(-parseInt(_0x20bdb2(0x22f))/0x8)+-parseInt(_0x20bdb2(0x1f3))/0x9*(parseInt(_0x20bdb2(0x24a))/0xa)+parseInt(_0x20bdb2(0x25c))/0xb*(parseInt(_0x20bdb2(0x1eb))/0xc)+-parseInt(_0x20bdb2(0x1ff))/0xd;if(_0x3fa562===_0x1c35f5)break;else _0x23673d['push'](_0x23673d['shift']());}catch(_0x4413d7){_0x23673d['push'](_0x23673d['shift']());}}}(_0x2f87,0x8586d));import{Uploader}from'src/decidim/direct_uploads/redesigned_uploader';import _0x1707ba from'src/decidim/redesigned_icon';import{truncateFilename}from'src/decidim/direct_uploads/upload_utility';import{escapeHtml,escapeQuotes}from'src/decidim/utilities/text';const STATUS={'VALIDATED':_0x1ea74b(0x232),'ERROR':'error'};function _0x28a4(_0x99e7f6,_0xce39a4){const _0x2f872f=_0x2f87();return _0x28a4=function(_0x28a477,_0x32d708){_0x28a477=_0x28a477-0x1cf;let _0x1320c1=_0x2f872f[_0x28a477];return _0x1320c1;},_0x28a4(_0x99e7f6,_0xce39a4);}export default class UploadModal{constructor(_0x14f950,_0xa29ea0={}){const _0x249e28=_0x1ea74b,_0x4dca20={'MVXmJ':_0x249e28(0x202),'auzEZ':_0x249e28(0x23b),'zjeGU':'[data-dialog-title]','Iybwy':_0x249e28(0x228),'urkpv':_0x249e28(0x245)};this['button']=_0x14f950;let _0x1d36ed={};try{_0x249e28(0x202)!==_0x4dca20[_0x249e28(0x24e)]?(this[_0x249e28(0x251)]['push'](_0x426f54),this[_0x249e28(0x21e)](_0x336587,_0x24a141)):_0x1d36ed=JSON['parse'](_0x14f950[_0x249e28(0x1e4)]['upload']);}catch(_0x13494f){}this[_0x249e28(0x1df)]=Object[_0x249e28(0x23a)](_0x1d36ed,_0xa29ea0),this['modal']=document['querySelector']('#'+_0x14f950[_0x249e28(0x1e4)]['dialogOpen']),this[_0x249e28(0x221)]=this[_0x249e28(0x230)][_0x249e28(0x206)](_0x4dca20[_0x249e28(0x241)]),this[_0x249e28(0x247)]=this[_0x249e28(0x230)][_0x249e28(0x206)](_0x249e28(0x262)),this[_0x249e28(0x205)]=this[_0x249e28(0x230)][_0x249e28(0x206)](_0x4dca20[_0x249e28(0x23c)]),this[_0x249e28(0x1de)]=this[_0x249e28(0x230)][_0x249e28(0x206)](_0x4dca20[_0x249e28(0x24c)]),this['emptyItems']=this['modal'][_0x249e28(0x206)](_0x249e28(0x24f)),this['uploadItems']=this['modal'][_0x249e28(0x206)](_0x4dca20[_0x249e28(0x25b)]),this[_0x249e28(0x253)]=this[_0x249e28(0x1de)]['querySelector']('input'),this['items']=[],this[_0x249e28(0x227)]=0x0,this[_0x249e28(0x243)]=JSON['parse'](this[_0x249e28(0x1fc)]['dataset'][_0x249e28(0x243)]),this[_0x249e28(0x211)]();}[_0x1ea74b(0x23f)](_0x4fa184){const _0x31e77b=_0x1ea74b,_0x534116={'mSCoC':function(_0x32bae6,_0x27b97b){return _0x32bae6===_0x27b97b;},'inpRN':_0x31e77b(0x214)};if(this['options'][_0x31e77b(0x1f6)])Array[_0x31e77b(0x1fa)](_0x4fa184)[_0x31e77b(0x1da)](_0x55e84f=>this[_0x31e77b(0x1e5)](_0x55e84f));else{if(!this[_0x31e77b(0x1fc)][_0x31e77b(0x24b)][_0x31e77b(0x1e8)]){if(_0x534116['mSCoC'](_0x534116[_0x31e77b(0x1f7)],'fezcO')){const _0x3aae07=this[_0x31e77b(0x227)];return this[_0x31e77b(0x227)]+=0x1,eval('1 + 1;'),_0x3aae07;}else this['uploadFile'](_0x4fa184[0x0]);}}}[_0x1ea74b(0x1e5)](_0x38f1db){const _0x51e762=_0x1ea74b,_0x4c1d73={'MwXKW':function(_0x57047b,_0x4a2bf7){return _0x57047b>_0x4a2bf7;},'BZzSC':_0x51e762(0x1cf),'nEptJ':_0x51e762(0x256)},_0x5ea304=new Uploader(this,{'file':_0x38f1db,'url':this['input'][_0x51e762(0x1e4)][_0x51e762(0x21d)],'attachmentName':_0x38f1db[_0x51e762(0x223)]}),_0x387ca6=this[_0x51e762(0x1d8)](_0x38f1db,_0x5ea304[_0x51e762(0x264)]);this[_0x51e762(0x1fc)][_0x51e762(0x237)](_0x387ca6),_0x5ea304['errors'][_0x51e762(0x1e8)]?this[_0x51e762(0x211)]():_0x4c1d73['nEptJ']===_0x51e762(0x257)?_0x4d374d[_0x51e762(0x250)]=_0x4c1d73[_0x51e762(0x213)](this['uploadItems'][_0x51e762(0x24b)][_0x51e762(0x1e8)],0x0):_0x5ea304[_0x51e762(0x1db)]['create']((_0x131fa6,_0x27f678)=>{const _0x40364a=_0x51e762;_0x4c1d73[_0x40364a(0x1ec)]!==_0x40364a(0x1cf)?_0x1b5248=_0x3531bf[_0x40364a(0x200)](_0x30168a[_0x40364a(0x1e4)]['upload']):_0x131fa6?_0x5ea304[_0x40364a(0x264)]=[_0x131fa6]:(_0x38f1db['hiddenField']=_0x27f678[_0x40364a(0x224)],_0x5ea304[_0x40364a(0x1dc)](_0x27f678['signed_id'])[_0x40364a(0x1f0)](()=>{const _0x1dfb26=_0x40364a;_0x5ea304[_0x1dfb26(0x264)][_0x1dfb26(0x1e8)]?this['uploadItems']['replaceChild'](this['createUploadItem'](_0x38f1db,_0x5ea304[_0x1dfb26(0x264)],{'value':0x64}),_0x387ca6):(this[_0x1dfb26(0x251)][_0x1dfb26(0x1dd)](_0x38f1db),this[_0x1dfb26(0x21e)](_0x387ca6,_0x38f1db)),this['updateDropZone']();}));});}[_0x1ea74b(0x21e)](_0x39a5f8,_0x263366){const _0x3a9a6b=_0x1ea74b,_0x5f3810={'Thhbc':_0x3a9a6b(0x1d6),'zxIyr':'img','EyOtZ':_0x3a9a6b(0x22b)};if(!/image/[_0x3a9a6b(0x20e)](_0x263366[_0x3a9a6b(0x1d3)])){Function(_0x5f3810[_0x3a9a6b(0x263)])();return;}const _0x1cd42b=new FileReader();_0x1cd42b[_0x3a9a6b(0x22e)](_0x263366),_0x1cd42b['onload']=({target:{result:_0x31d62a}})=>{const _0x3ab16c=_0x3a9a6b;if('ACUan'===_0x5f3810[_0x3ab16c(0x1f2)]){const _0x246fec=_0x39a5f8[_0x3ab16c(0x206)](_0x5f3810[_0x3ab16c(0x242)]);_0x246fec[_0x3ab16c(0x20f)]=_0x31d62a;}else this[_0x3ab16c(0x251)]=[],this[_0x3ab16c(0x1fc)][_0x3ab16c(0x1ee)]='',this['updateDropZone']();};}async['preloadFiles'](_0xea602a){const _0x30e81e=_0x1ea74b,{src:_0x4b6533}=_0xea602a[_0x30e81e(0x206)](_0x30e81e(0x239))||{};let _0x664754='',_0xa3b7aa='';_0x4b6533&&(_0x664754=await fetch(_0x4b6533)[_0x30e81e(0x1f0)](_0x383722=>_0x383722[_0x30e81e(0x254)]()),_0xa3b7aa=_0x30e81e(0x1d2));const _0x58d5f3=new File([_0x664754],_0xea602a['dataset'][_0x30e81e(0x246)],{'type':_0xa3b7aa}),_0x13a0c2=this[_0x30e81e(0x1d8)](_0x58d5f3,[],{..._0xea602a[_0x30e81e(0x1e4)],'value':0x64});_0x58d5f3['attachmentId']=_0xea602a[_0x30e81e(0x1e4)][_0x30e81e(0x212)],this[_0x30e81e(0x251)][_0x30e81e(0x1dd)](_0x58d5f3),this['uploadItems'][_0x30e81e(0x237)](_0x13a0c2),this[_0x30e81e(0x21e)](_0x13a0c2,_0x58d5f3);}['getOrdinalNumber'](){const _0x48115b=_0x1ea74b,_0x1d4a7f={'hepkA':function(_0x18cf58,_0x2c8ee1){return _0x18cf58+_0x2c8ee1;}},_0x1bc77b=this['attachmentCounter'];return this[_0x48115b(0x227)]+=0x1,eval('const _0x5c9a21 = _0x48115b;_0x1d4a7f[_0x5c9a21(607)](1, 1);'),_0x1bc77b;}['updateDropZone'](){const _0x385e86=_0x1ea74b,_0x2896b0={'RMfdx':function(_0x2edabb,_0x4a0b9c){return _0x2edabb>_0x4a0b9c;},'ppBUO':_0x385e86(0x215),'EQNMd':'is-disabled','WgEtM':'label'},{children:_0x6be4f1}=this[_0x385e86(0x1fc)],_0x47356c=_0x6be4f1[_0x385e86(0x1e8)]>0x0;this[_0x385e86(0x1fc)]['hidden']=!_0x47356c,this['saveButton'][_0x385e86(0x215)]=_0x2896b0[_0x385e86(0x219)](Array[_0x385e86(0x1fa)](_0x6be4f1)[_0x385e86(0x220)](({dataset:{state:_0x53326c}})=>_0x53326c===STATUS[_0x385e86(0x1ef)])[_0x385e86(0x1e8)],0x0);const _0x2d2c41=!_0x6be4f1['length']||this[_0x385e86(0x1df)][_0x385e86(0x1f6)];this[_0x385e86(0x253)][_0x385e86(0x215)]=!_0x2d2c41,_0x2d2c41?(this[_0x385e86(0x1e7)][_0x385e86(0x1f9)][_0x385e86(0x1f5)](_0x385e86(0x208)),this[_0x385e86(0x1e7)][_0x385e86(0x206)]('label')[_0x385e86(0x1fd)](_0x2896b0[_0x385e86(0x235)])):(this[_0x385e86(0x1e7)][_0x385e86(0x1f9)][_0x385e86(0x23d)](_0x2896b0[_0x385e86(0x1ea)]),this[_0x385e86(0x1e7)][_0x385e86(0x206)](_0x2896b0[_0x385e86(0x225)])['setAttribute'](_0x2896b0['ppBUO'],!![]));}[_0x1ea74b(0x1d8)](_0x1c742c,_0x3c8f9a,_0x4c386c={}){const _0x32796c=_0x1ea74b,_0x126cb1={'qJFBg':function(_0x38ae15,_0x468ccb){return _0x38ae15(_0x468ccb);},'HCDst':function(_0xa10190,_0x567d4d){return _0xa10190(_0x567d4d);},'sbUqa':function(_0x5e1aa4,_0x58e4e9){return _0x5e1aa4(_0x58e4e9);},'uMeDi':_0x32796c(0x1d0),'TVlZg':_0x32796c(0x248)},_0xf399e1=_0x32796c(0x261)+_0x1c742c[_0x32796c(0x223)]+'\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<span>'+escapeHtml(truncateFilename(_0x1c742c[_0x32796c(0x223)]))+'</span>\x0a\x20\x20\x20\x20',_0x22f00d='\x0a\x20\x20\x20\x20\x20\x20<div>'+_0x126cb1[_0x32796c(0x1f8)](_0x1707ba,_0x32796c(0x1e9))+_0x32796c(0x1fe)+_0x126cb1[_0x32796c(0x222)](escapeHtml,_0x126cb1[_0x32796c(0x21f)](truncateFilename,_0x1c742c[_0x32796c(0x223)]))+_0x32796c(0x249)+this[_0x32796c(0x243)][_0x32796c(0x201)]+'</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<ul>'+_0x3c8f9a[_0x32796c(0x231)](_0x3ff1f3=>_0x32796c(0x1d5)+_0x3ff1f3+_0x32796c(0x1f4))['join']('\x0a')+_0x32796c(0x265),_0x49d54a=_0x32796c(0x261)+_0x1c742c[_0x32796c(0x223)]+_0x32796c(0x20b)+this[_0x32796c(0x243)]['filename']+_0x32796c(0x260)+escapeHtml(truncateFilename(_0x1c742c['name']))+_0x32796c(0x236)+this[_0x32796c(0x243)][_0x32796c(0x216)]+_0x32796c(0x1e6)+escapeQuotes(_0x4c386c[_0x32796c(0x216)]||truncateFilename(_0x1c742c['name']))+_0x32796c(0x1ed);let _0x3d21d2=STATUS[_0x32796c(0x1e1)],_0x4e4aae=_0xf399e1,_0x1a41c6='ok';_0x3c8f9a[_0x32796c(0x1e8)]&&(_0x32796c(0x217)===_0x32796c(0x217)?(_0x3d21d2=STATUS['ERROR'],_0x4e4aae=_0x22f00d,_0x1a41c6=_0x32796c(0x233)):this[_0x32796c(0x1e3)]['innerHTML']=this[_0x32796c(0x205)][_0x32796c(0x1e4)][_0x32796c(0x20d)]);!_0x3c8f9a[_0x32796c(0x1e8)]&&this[_0x32796c(0x1df)][_0x32796c(0x209)]&&(_0x4e4aae=_0x49d54a,_0x1a41c6='titled');const _0xaa6d6d=_0x4c386c[_0x32796c(0x212)]?_0x32796c(0x1d4)+_0x4c386c[_0x32796c(0x212)]+'\x22':'',_0x225a63=_0x32796c(0x1d9)+_0xaa6d6d+_0x32796c(0x244)+_0x126cb1[_0x32796c(0x1f8)](escapeQuotes,_0x1c742c['name'])+'\x22\x20data-state=\x22'+_0x3d21d2+_0x32796c(0x1f1)+_0x1a41c6+_0x32796c(0x259)+_0x4e4aae[_0x32796c(0x1d1)]()+_0x32796c(0x258)+this[_0x32796c(0x243)][_0x32796c(0x1f5)]+'</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<progress\x20max=\x22100\x22\x20value=\x22'+(_0x4c386c[_0x32796c(0x234)]||0x0)+_0x32796c(0x1fb),_0x2b7f1b=document[_0x32796c(0x21b)](_0x126cb1[_0x32796c(0x21a)]);_0x2b7f1b['innerHTML']=_0x225a63[_0x32796c(0x1d1)]();const _0x3a2d8f=_0x2b7f1b[_0x32796c(0x255)];return _0x3a2d8f[_0x32796c(0x206)](_0x32796c(0x1e3))[_0x32796c(0x226)](_0x32796c(0x23e),this[_0x32796c(0x25e)][_0x32796c(0x20a)](this)),new Function(_0x126cb1[_0x32796c(0x22d)])(),_0x3a2d8f;}['handleButtonClick']({currentTarget:_0xae4179}){const _0x2bc5b3=_0x1ea74b,_0x5f58e4={'aePuN':'[data-filename]','JLKKh':_0x2bc5b3(0x25d)},_0x4b268f=_0xae4179[_0x2bc5b3(0x25a)](_0x5f58e4['aePuN']),{filename:_0x216075}=_0x4b268f[_0x2bc5b3(0x1e4)];_0x4b268f[_0x2bc5b3(0x1f5)]();const _0x4637a7=this[_0x2bc5b3(0x251)]['findIndex'](({name:_0x1dee3d})=>_0x1dee3d===_0x216075);_0x4637a7>-0x1&&(_0x2bc5b3(0x25d)===_0x5f58e4[_0x2bc5b3(0x20c)]?this[_0x2bc5b3(0x251)][_0x4637a7][_0x2bc5b3(0x240)]=!![]:this[_0x2bc5b3(0x211)]()),this[_0x2bc5b3(0x211)]();}[_0x1ea74b(0x204)](_0x36f089,_0x5b2a2f){const _0xfc2409=_0x1ea74b;this['uploadItems']['querySelector'](_0xfc2409(0x252)+escapeQuotes(_0x36f089)+_0xfc2409(0x203))[_0xfc2409(0x234)]=_0x5b2a2f;}['updateAddAttachmentsButton'](){const _0x9bfbe=_0x1ea74b,_0x57cdfe={'ImjCV':function(_0x403a9c,_0x38531b){return _0x403a9c>_0x38531b;}};this[_0x9bfbe(0x1fc)]['children'][_0x9bfbe(0x1e8)]===0x0?'SYMBz'===_0x9bfbe(0x207)?this[_0x9bfbe(0x1e3)]['innerHTML']=this[_0x9bfbe(0x205)][_0x9bfbe(0x1e4)][_0x9bfbe(0x22a)]:this['button']['innerHTML']=this[_0x9bfbe(0x205)][_0x9bfbe(0x1e4)][_0x9bfbe(0x20d)]:this[_0x9bfbe(0x1e3)][_0x9bfbe(0x238)]=this[_0x9bfbe(0x205)][_0x9bfbe(0x1e4)][_0x9bfbe(0x22a)];const _0x2942a4=this[_0x9bfbe(0x1e3)][_0x9bfbe(0x229)];_0x2942a4&&(_0x2942a4[_0x9bfbe(0x250)]=_0x57cdfe[_0x9bfbe(0x22c)](this[_0x9bfbe(0x1fc)]['children'][_0x9bfbe(0x1e8)],0x0));}['cleanAllFiles'](){const _0x2a47a8=_0x1ea74b;this[_0x2a47a8(0x251)]=[],this['uploadItems'][_0x2a47a8(0x1ee)]='',this['updateDropZone']();}}