'use strict';var _0x2bfb33=_0x3c56;(function(_0x25abd2,_0x30d112){var _0x3728cb=_0x3c56,_0x3278bb=_0x25abd2();while(!![]){try{var _0x126735=parseInt(_0x3728cb(0xf9))/0x1+-parseInt(_0x3728cb(0xfc))/0x2*(-parseInt(_0x3728cb(0xe5))/0x3)+-parseInt(_0x3728cb(0xcc))/0x4*(-parseInt(_0x3728cb(0xf1))/0x5)+parseInt(_0x3728cb(0x107))/0x6+parseInt(_0x3728cb(0x105))/0x7+parseInt(_0x3728cb(0x115))/0x8+-parseInt(_0x3728cb(0x10c))/0x9*(parseInt(_0x3728cb(0xdb))/0xa);if(_0x126735===_0x30d112)break;else _0x3278bb['push'](_0x3278bb['shift']());}catch(_0x2ce7eb){_0x3278bb['push'](_0x3278bb['shift']());}}}(_0x215f,0x30857));var AuthorizeHandler=require(_0x2bfb33(0xba)),Request=require(_0x2bfb33(0x10a)),Response=require(_0x2bfb33(0xfd)),Promise=require(_0x2bfb33(0xf8)),sinon=require('sinon'),should=require(_0x2bfb33(0xf5));function _0x3c56(_0x5f41b0,_0xdcfd05){var _0x215f3d=_0x215f();return _0x3c56=function(_0x3c566f,_0x105e5e){_0x3c566f=_0x3c566f-0xb9;var _0x160fb6=_0x215f3d[_0x3c566f];return _0x160fb6;},_0x3c56(_0x5f41b0,_0xdcfd05);}describe(_0x2bfb33(0xc0),function(){var _0xbb23e0=_0x2bfb33,_0x37943a={'lXyxP':function(_0x541d1c,_0x26c01b){return _0x541d1c===_0x26c01b;},'jzmQm':_0xbb23e0(0x113),'eUcsA':'whLON','rcsqn':_0xbb23e0(0x106),'ahDvM':_0xbb23e0(0xec),'wmtSz':_0xbb23e0(0xe8),'adBwl':_0xbb23e0(0xdf),'ujiRD':_0xbb23e0(0xcd),'gWBlS':_0xbb23e0(0xc9),'ZoXgp':function(_0x59863b,_0x4b02aa,_0x297b6f){return _0x59863b(_0x4b02aa,_0x297b6f);},'gaudw':_0xbb23e0(0xfb),'rzfJz':_0xbb23e0(0xbd),'eaLOF':_0xbb23e0(0xc7),'ZjrJl':_0xbb23e0(0xfa),'bKADv':_0xbb23e0(0xf6),'LKDgK':_0xbb23e0(0x103),'DLNII':_0xbb23e0(0xc6),'NOjsM':'handle()','IBdtM':function(_0x2be127,_0x27e1cd,_0x28d947){return _0x2be127(_0x27e1cd,_0x28d947);},'UJQiM':function(_0x236f90,_0x13c0fd,_0x556c93){return _0x236f90(_0x13c0fd,_0x556c93);},'eVQUo':_0xbb23e0(0xea),'FuZWD':_0xbb23e0(0xca),'RResa':_0xbb23e0(0xef)};describe(_0x37943a[_0xbb23e0(0xeb)],function(){var _0xe8add3=_0xbb23e0,_0x9a19d5={'nrFoi':_0x37943a[_0xe8add3(0xd3)],'nvEjb':_0x37943a[_0xe8add3(0xd5)],'Yizaa':_0x37943a[_0xe8add3(0xde)]};_0x37943a[_0xe8add3(0xc5)](it,_0xe8add3(0xd8),function(){var _0x1a1680=_0xe8add3;if(_0x37943a[_0x1a1680(0xe7)](_0x37943a[_0x1a1680(0xe3)],_0x37943a[_0x1a1680(0xf3)])){var _0x513042=_0x9a19d5[_0x1a1680(0xcb)][_0x1a1680(0x110)]('|'),_0x14a1e2=0x0;while(!![]){switch(_0x513042[_0x14a1e2++]){case'0':_0x2504d1[_0x1a1680(0xf4)][_0x1a1680(0xdd)][_0x1a1680(0xd6)][_0x1a1680(0xf5)][_0x1a1680(0xbc)][_0x1a1680(0xf0)](0x3);continue;case'1':_0x1e4974['saveAuthorizationCode']['firstCall'][_0x1a1680(0xd6)][0x2][_0x1a1680(0xf5)][_0x1a1680(0x108)](_0x1a1680(0xe0));continue;case'2':_0x5864d9['saveAuthorizationCode'][_0x1a1680(0xdd)][_0x1a1680(0x10b)][_0x1a1680(0xf5)]['equal'](_0x568577);continue;case'3':_0x58c9bc['saveAuthorizationCode'][_0x1a1680(0x10d)][_0x1a1680(0xf5)][_0x1a1680(0x108)](0x1);continue;case'4':_0x5011f8[_0x1a1680(0xf4)][_0x1a1680(0xdd)][_0x1a1680(0xd6)][0x1][_0x1a1680(0xf5)][_0x1a1680(0x108)](_0x1a1680(0xfa));continue;case'5':_0x195026[_0x1a1680(0xf4)][_0x1a1680(0xdd)]['args'][0x0]['should'][_0x1a1680(0xd7)]({'authorizationCode':_0x1a1680(0x116),'expiresAt':_0x1a1680(0xc7),'redirectUri':_0x1a1680(0xf6),'scope':_0x9a19d5[_0x1a1680(0xb9)],'codeChallenge':_0x9a19d5[_0x1a1680(0x117)],'codeChallengeMethod':'bez'});continue;}break;}}else{var _0x2bf442={'getClient':sinon[_0x1a1680(0xc2)]()[_0x1a1680(0x111)]({'grants':[_0x37943a[_0x1a1680(0xd4)]],'redirectUris':[_0x1a1680(0xe1)]}),'saveAuthorizationCode':sinon[_0x1a1680(0xc2)]()[_0x1a1680(0x111)]({'authorizationCode':_0x1a1680(0xcf)})},_0xd5762f=new AuthorizeHandler({'authenticateHandler':{'handle':sinon['stub']()[_0x1a1680(0x111)]({'name':_0x1a1680(0x104)})},'authorizationCodeLifetime':0x7b,'allowEmptyState':!![],'model':_0x2bf442}),_0x4dd219=new Request({'body':{'client_id':_0x37943a[_0x1a1680(0xd2)],'response_type':_0x37943a[_0x1a1680(0xf2)]},'headers':{},'method':{},'query':{}}),_0x2539aa=new Response({});return _0xd5762f[_0x1a1680(0x101)](_0x4dd219,_0x2539aa)[_0x1a1680(0x109)](function(){var _0x248dfa=_0x1a1680;_0x2bf442[_0x248dfa(0x100)][_0x248dfa(0xf5)][_0x248dfa(0x108)](_0x4dd219);})[_0x1a1680(0xd0)](should[_0x1a1680(0x112)]);}});}),_0x37943a['IBdtM'](describe,_0xbb23e0(0xd1),function(){var _0x452e60=_0xbb23e0;it(_0x452e60(0xdc),function(){var _0x5aaac7=_0x452e60,_0x3fd1d6={'generateAuthorizationCode':sinon[_0x5aaac7(0xc2)]()['returns']({}),'getAccessToken':function(){},'getClient':function(){},'saveAuthorizationCode':function(){}},_0x4c81c5=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0x3fd1d6});return _0x4c81c5[_0x5aaac7(0xfe)]()['then'](function(){var _0x11eeef=_0x5aaac7;_0x3fd1d6[_0x11eeef(0xfe)][_0x11eeef(0x10d)][_0x11eeef(0xf5)][_0x11eeef(0x108)](0x1),_0x3fd1d6['generateAuthorizationCode'][_0x11eeef(0xdd)]['thisValue']['should'][_0x11eeef(0x108)](_0x3fd1d6);})[_0x5aaac7(0xd0)](should[_0x5aaac7(0x112)]);});}),_0x37943a[_0xbb23e0(0xed)](describe,_0x37943a['eVQUo'],function(){var _0x516128=_0xbb23e0;it(_0x516128(0xc1),function(){var _0x17e76c=_0x516128;if('pDPzk'!==_0x17e76c(0xce))_0x132b86[_0x17e76c(0x100)][_0x17e76c(0xf5)][_0x17e76c(0x108)](_0x422dee);else{var _0x172e24={'getAccessToken':function(){},'getClient':sinon[_0x17e76c(0xc2)]()[_0x17e76c(0x111)]({'grants':[_0x17e76c(0x106)],'redirectUris':[_0x17e76c(0xbe)]}),'saveAuthorizationCode':function(){}},_0x11e94a=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0x172e24}),_0x5496d3=new Request({'body':{'client_id':0x3039,'client_secret':_0x37943a[_0x17e76c(0xff)]},'headers':{},'method':{},'query':{}});return _0x11e94a[_0x17e76c(0xc4)](_0x5496d3)[_0x17e76c(0x109)](function(){var _0x12766e=_0x17e76c;_0x172e24[_0x12766e(0xc4)][_0x12766e(0x10d)][_0x12766e(0xf5)]['equal'](0x1),_0x172e24['getClient']['firstCall']['args'][_0x12766e(0xf5)]['have'][_0x12766e(0xf0)](0x2),_0x172e24[_0x12766e(0xc4)][_0x12766e(0xdd)]['args'][0x0]['should'][_0x12766e(0x108)](0x3039),_0x172e24[_0x12766e(0xc4)][_0x12766e(0xdd)][_0x12766e(0x10b)][_0x12766e(0xf5)][_0x12766e(0x108)](_0x172e24);})[_0x17e76c(0xd0)](should[_0x17e76c(0x112)]);}});}),describe(_0x37943a['FuZWD'],function(){var _0x35dbcd=_0xbb23e0,_0x549a07={'RsRyG':function(_0x18656b,_0x24db9d){return _0x18656b!==_0x24db9d;}};it(_0x37943a[_0x35dbcd(0xe9)],function(){var _0x22c9f3=_0x35dbcd,_0x2b239b={'Mnlxb':function(_0x538021,_0xd487ac){return _0x549a07['RsRyG'](_0x538021,_0xd487ac);}},_0x3b2c22={'handle':sinon['stub']()['returns'](Promise[_0x22c9f3(0xbf)]({}))},_0x30ffc9={'getClient':function(){},'saveAuthorizationCode':function(){}},_0x53c0c9=new AuthorizeHandler({'authenticateHandler':_0x3b2c22,'authorizationCodeLifetime':0x78,'model':_0x30ffc9}),_0x5c5740=new Request({'body':{},'headers':{},'method':{},'query':{}}),_0x5f3e48=new Response();return _0x53c0c9[_0x22c9f3(0xd9)](_0x5c5740,_0x5f3e48)['then'](function(){var _0x3c2567=_0x22c9f3;_0x2b239b['Mnlxb'](_0x3c2567(0xc3),_0x3c2567(0xc3))?(_0x39456d[_0x3c2567(0xc4)][_0x3c2567(0x10d)]['should'][_0x3c2567(0x108)](0x1),_0x757bf['getClient'][_0x3c2567(0xdd)][_0x3c2567(0xd6)][_0x3c2567(0xf5)][_0x3c2567(0xbc)][_0x3c2567(0xf0)](0x2),_0x1999a2[_0x3c2567(0xc4)]['firstCall'][_0x3c2567(0xd6)][0x0][_0x3c2567(0xf5)][_0x3c2567(0x108)](0x3039),_0x4cb455[_0x3c2567(0xc4)][_0x3c2567(0xdd)][_0x3c2567(0x10b)][_0x3c2567(0xf5)]['equal'](_0x310117)):(_0x3b2c22[_0x3c2567(0x101)][_0x3c2567(0x10d)][_0x3c2567(0xf5)][_0x3c2567(0x108)](0x1),_0x3b2c22['handle'][_0x3c2567(0xdd)][_0x3c2567(0xd6)][_0x3c2567(0xf5)][_0x3c2567(0xbc)][_0x3c2567(0xf0)](0x2),_0x3b2c22['handle'][_0x3c2567(0xdd)]['args'][0x0][_0x3c2567(0xf5)][_0x3c2567(0x108)](_0x5c5740),_0x3b2c22[_0x3c2567(0x101)][_0x3c2567(0xdd)][_0x3c2567(0xd6)][0x1][_0x3c2567(0xf5)][_0x3c2567(0x108)](_0x5f3e48));})[_0x22c9f3(0xd0)](should[_0x22c9f3(0x112)]);});}),_0x37943a[_0xbb23e0(0xe4)](describe,_0x37943a[_0xbb23e0(0xf7)],function(){var _0xf035fb=_0xbb23e0,_0xd0f617={'jXHYM':_0x37943a[_0xf035fb(0xee)],'WKUvH':'foo','zFBaP':_0xf035fb(0xf6),'OmLvg':_0x37943a[_0xf035fb(0x10e)],'mnMcp':_0xf035fb(0xfa)};_0x37943a['ZoXgp'](it,_0xf035fb(0x114),function(){var _0x16a0e1=_0xf035fb,_0x2b0ffa={'getAccessToken':function(){},'getClient':function(){},'saveAuthorizationCode':sinon[_0x16a0e1(0xc2)]()[_0x16a0e1(0x111)]({})},_0x34f416=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0x2b0ffa});return _0x34f416[_0x16a0e1(0xf4)](_0x16a0e1(0x116),_0x37943a['eaLOF'],_0x16a0e1(0xcd),_0x37943a[_0x16a0e1(0xe6)],_0x37943a[_0x16a0e1(0xe2)],_0x16a0e1(0xe0),_0x16a0e1(0xc9),_0x37943a['LKDgK'])[_0x16a0e1(0x109)](function(){var _0x23c372=_0x16a0e1;_0xd0f617[_0x23c372(0xc8)]===_0x23c372(0x102)?(_0x56871f[_0x23c372(0x101)][_0x23c372(0x10d)][_0x23c372(0xf5)][_0x23c372(0x108)](0x1),_0x4bee63['handle'][_0x23c372(0xdd)][_0x23c372(0xd6)][_0x23c372(0xf5)]['have'][_0x23c372(0xf0)](0x2),_0x31df54[_0x23c372(0x101)][_0x23c372(0xdd)]['args'][0x0][_0x23c372(0xf5)][_0x23c372(0x108)](_0x2dbf1b),_0x24aa76[_0x23c372(0x101)]['firstCall']['args'][0x1]['should'][_0x23c372(0x108)](_0x4fbd54)):(_0x2b0ffa[_0x23c372(0xf4)]['callCount'][_0x23c372(0xf5)]['equal'](0x1),_0x2b0ffa[_0x23c372(0xf4)][_0x23c372(0xdd)][_0x23c372(0xd6)][_0x23c372(0xf5)][_0x23c372(0xbc)][_0x23c372(0xf0)](0x3),_0x2b0ffa[_0x23c372(0xf4)][_0x23c372(0xdd)][_0x23c372(0xd6)][0x0][_0x23c372(0xf5)][_0x23c372(0xd7)]({'authorizationCode':_0xd0f617['WKUvH'],'expiresAt':_0x23c372(0xc7),'redirectUri':_0xd0f617[_0x23c372(0xda)],'scope':_0x23c372(0xcd),'codeChallenge':_0x23c372(0xc9),'codeChallengeMethod':_0xd0f617[_0x23c372(0xbb)]}),_0x2b0ffa[_0x23c372(0xf4)][_0x23c372(0xdd)]['args'][0x1][_0x23c372(0xf5)][_0x23c372(0x108)](_0xd0f617[_0x23c372(0x10f)]),_0x2b0ffa[_0x23c372(0xf4)][_0x23c372(0xdd)]['args'][0x2][_0x23c372(0xf5)][_0x23c372(0x108)]('boz'),_0x2b0ffa[_0x23c372(0xf4)][_0x23c372(0xdd)]['thisValue']['should'][_0x23c372(0x108)](_0x2b0ffa));})[_0x16a0e1(0xd0)](should['fail']);});});});function _0x215f(){var _0x3bceb7=['firstCall','gWBlS','3|0|5|4|1|2','boz','/abc','bKADv','jzmQm','IBdtM','2190mCXGfb','ZjrJl','lXyxP','code','rzfJz','getClient()','NOjsM','123','UJQiM','DLNII','saveAuthorizationCode()','length','1865110phJuCo','wmtSz','eUcsA','saveAuthorizationCode','should','baz','RResa','bluebird','108261HTMFhR','biz','secret','914aoZKaq','../../../lib/response','generateAuthorizationCode','gaudw','request','handle','eszmU','bez','xyz','927199JqDBqY','authorization_code','1270752FCNQDG','equal','then','../../../lib/request','thisValue','2942343AAAOxX','callCount','LKDgK','mnMcp','split','returns','fail','KtVcw','should\x20call\x20`model.saveAuthorizationCode()`','2778472hpkANe','foo','Yizaa','nvEjb','../../../lib/handlers/authorize-handler','OmLvg','have','should\x20call\x20`authenticateHandler.getUser()`','http://example.com/cb','resolve','AuthorizeHandler','should\x20call\x20`model.getClient()`','stub','zYaWK','getClient','ZoXgp','kbGND','bar','jXHYM','buz','getUser()','nrFoi','4slKwCR','qux','pDPzk','code_abc','catch','generateAuthorizationCode()','ahDvM','adBwl','rcsqn','ujiRD','args','eql','should\x20extend\x20model\x20object\x20with\x20request\x20context','getUser','zFBaP','40pjNMAQ','should\x20call\x20`model.generateAuthorizationCode()`'];_0x215f=function(){return _0x3bceb7;};return _0x215f();}