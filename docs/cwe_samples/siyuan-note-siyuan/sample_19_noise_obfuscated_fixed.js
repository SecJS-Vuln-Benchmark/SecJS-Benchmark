const _0x3a9ac9=_0x428c;(function(_0x18e19a,_0x1dc4b7){const _0x2c1a59=_0x428c,_0x1f9cc3=_0x18e19a();while(!![]){try{const _0x4568a9=-parseInt(_0x2c1a59(0x204))/0x1*(parseInt(_0x2c1a59(0x19f))/0x2)+parseInt(_0x2c1a59(0x1c9))/0x3*(-parseInt(_0x2c1a59(0x1a2))/0x4)+-parseInt(_0x2c1a59(0x1e9))/0x5*(-parseInt(_0x2c1a59(0x1c1))/0x6)+parseInt(_0x2c1a59(0x19b))/0x7+parseInt(_0x2c1a59(0x1e3))/0x8*(parseInt(_0x2c1a59(0x1c7))/0x9)+-parseInt(_0x2c1a59(0x1b8))/0xa+-parseInt(_0x2c1a59(0x1c8))/0xb;if(_0x4568a9===_0x1dc4b7)break;else _0x1f9cc3['push'](_0x1f9cc3['shift']());}catch(_0x47d97a){_0x1f9cc3['push'](_0x1f9cc3['shift']());}}}(_0x3300,0x463ed));import{fileURLToPath,pathToFileURL}from'url';import{dirname,join}from'path';import{createHash}from'crypto';globalThis[_0x3a9ac9(0x1ed)]={'createHash':createHash};const __filename=fileURLToPath(import.meta[_0x3a9ac9(0x1b6)]),__dirname=dirname(__filename),clientModule=await import(pathToFileURL(join(__dirname,'..',_0x3a9ac9(0x1d3)))[_0x3a9ac9(0x1e4)]),serverModule=await import(pathToFileURL(join(__dirname,'..',_0x3a9ac9(0x1e5)))['href']),rfc5054={'N_base10':_0x3a9ac9(0x1ae),'g_base10':'2','k_base16':_0x3a9ac9(0x1bf)};console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1fd)),console[_0x3a9ac9(0x207)]('====================================='),console[_0x3a9ac9(0x207)]('üì¶\x20Creating\x20client\x20session\x20factory...');const SRP6JavascriptClientSession=clientModule[_0x3a9ac9(0x1f4)](rfc5054[_0x3a9ac9(0x1b1)],rfc5054['g_base10'],rfc5054[_0x3a9ac9(0x1b4)]);console['log']('‚úÖ\x20Client\x20session\x20factory\x20created'),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1d4));const SRP6JavascriptServerSession=serverModule[_0x3a9ac9(0x1f4)](rfc5054[_0x3a9ac9(0x1b1)],rfc5054[_0x3a9ac9(0x1f7)],rfc5054[_0x3a9ac9(0x1b4)]);console[_0x3a9ac9(0x207)]('‚úÖ\x20Server\x20session\x20factory\x20created'),console['log'](_0x3a9ac9(0x1e0)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1d9)),console['log'](_0x3a9ac9(0x1f6));const client=new SRP6JavascriptClientSession();console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1e2)),console[_0x3a9ac9(0x207)]('üßÇ\x20Generating\x20random\x20salt...');const salt=client[_0x3a9ac9(0x19d)]();console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1a3)+salt['substring'](0x0,0x10)+_0x3a9ac9(0x1c4));const username=_0x3a9ac9(0x1a7),password=_0x3a9ac9(0x1b5);function _0x3300(){const _0x5e942c=['==============','This\x20indicates\x20a\x20problem\x20with\x20the\x20SRP\x20implementation.','28876AwWYjf','‚úÖ\x20Salt\x20generated:\x20','fromPrivateStoreState','üîç\x20Server\x20Step\x202:\x20Verifying\x20credentials...','getState','tom@arcot.com','===========================','\x20\x20\x20Error:\x20','randomA','üñ•Ô∏è\x20\x20Server\x20session\x20key:\x20','\x0aüèÅ\x20All\x20tests\x20completed\x20successfully!','warn','21766174458617435773191008891802753781907668374255538511144643224689886235383840957210909013086056401571399717235807266581649606472148410291413364152197364477180887395655483738115072677402235101762521901569820740293149529620419333266262073471054548368736039519702486226506248861060256971802984953561121442680157668000761429988222457090413873973970171927093992114751765168063614761119615476233422096442783117971236371647333871414335895773474667308967050807005509320424799678417036867928316761272274230314067548291133582479583061439577559347101961771406173684378522703483495337037655006751328447510550299250924469288819','\x0aüß™\x20RFC\x205054\x20ENTROPY\x20TEST\x20(SHOULD\x20FAIL)','stringify','N_base10','‚ùå\x20FAILURE:\x20Session\x20keys\x20do\x20not\x20match!','‚úÖ\x20ENTROPY\x20FIX\x20CONFIRMED:\x20Client\x20A\x20is\x20','k_base16','password1234','url','‚úÖ\x20Client\x20verified\x20server\x20proof:\x20','1622250ersldD','üèóÔ∏è\x20\x20Server\x20Step\x201:\x20Generating\x20challenge...','‚úÖ\x20Client\x20ES\x20module\x20loaded\x20successfully','‚úÖ\x20SRP\x20authentication\x20phase\x20completed','üìã\x20This\x20codebase\x20uses\x202048-bit\x20N,\x20expected\x20length:\x20','Session\x20key\x20mismatch\x20-\x20SRP\x20protocol\x20failed','\x20chars,\x20matches\x20expected\x20','5b9e8ef059c6b32ea59fc1d322d37f04aa30bae5aa9003b8321e21ddb04e300','üîç\x20SERVER\x20randomB\x20hex\x20length:\x20','204LtXoyA','message','\x20bytes)','...','module','üåê\x20Testing\x20backward\x20compatibility\x20with\x20browser.js...','27svRjUG','6576284MFdkOU','69MqdXlD','‚ùå\x20CLIENT\x20randomA\x20value:\x20','‚úÖ\x20Browser.js\x20compatibility\x20test\x20passed','parse','step2','üíæ\x20Server\x20private\x20state\x20restored\x20from\x20cache','randomB','‚úÖ\x20Verifier\x20generated:\x20','\x20characters','‚ö†Ô∏è\x20\x20Browser.js\x20compatibility\x20test\x20skipped:\x20','client.mjs','üì¶\x20Creating\x20server\x20session\x20factory...','=========================','\x20\x20\x20A:\x20','‚ùå\x20CRITICAL\x20ERROR\x20in\x20SRP\x20authentication:','\x0aüö™\x20LOGIN\x20PHASE','=====================','‚úÖ\x20Client\x20generated\x20credentials:','‚úÖ\x20SRP\x20registration\x20phase\x20completed','stack','getSessionKey','\x20chars','\x20chars,\x20should\x20be\x20','\x0aüîê\x20REGISTRATION\x20PHASE','exit','‚úÖ\x20Client\x20session\x20created','1257384EzIBee','href','server.mjs','\x0aüîë\x20SESSION\x20KEY\x20VERIFICATION','YES','üîê\x20Shared\x20key\x20length:\x20','84405VGIgGM','‚ùå\x20ENTROPY\x20BUG:\x20Server\x20B\x20is\x20','‚úÖ\x20CORRECT\x20N\x20value:\x20','‚úÖ\x20Client\x20step1\x20completed\x20-\x20State:\x20','nodeCrypto','step3','substring','üîç\x20SERVER\x20randomB\x20value:\x20','üîë\x20Password:\x20','üîó\x20Browser-Server\x20key\x20match:\x20','üë§\x20User:\x20','default','\x20\x20\x20Final\x20Client\x20State:\x20','üë§\x20Creating\x20client\x20session...','g_base10','‚úÖ\x20Server\x20B\x20entropy\x20correct:\x20','üíæ\x20Server\x20private\x20state\x20cached\x20(','üîç\x20Client\x20Step\x203:\x20Verifying\x20server\x20proof...','toPrivateStoreState','‚úÖ\x20Session\x20keys\x20generated\x20and\x20verified','üöÄ\x20Starting\x20SRP\x20ES\x20Module\x20Test\x20Suite','error','toHex','length','‚úÖ\x20Server\x20ES\x20module\x20loaded\x20successfully','‚ùå\x20ENTROPY\x20BUG:\x20Client\x20A\x20is\x20','======================================','109459JimJDt','‚úÖ\x20CORRECT\x20N\x20hex\x20length:\x20','\x20chars\x20matches\x20expected\x20','log','3477145ZmIcvK','‚úÖ\x20SUCCESS:\x20Session\x20keys\x20match\x20perfectly!','generateRandomSalt','step1','6AquhrN'];_0x3300=function(){return _0x5e942c;};return _0x3300();}console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1f3)+username),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1f1)+password),console['log']('üîê\x20Generating\x20verifier...');const verifier=client['generateVerifier'](salt,username,password);console['log'](_0x3a9ac9(0x1d0)+verifier[_0x3a9ac9(0x1ef)](0x0,0x10)+_0x3a9ac9(0x1c4)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1d8)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1a0)),console[_0x3a9ac9(0x207)]('üì§\x20Client\x20Step\x201:\x20Sending\x20credentials\x20to\x20start\x20authentication...'),client[_0x3a9ac9(0x19e)](username,password),console['log'](_0x3a9ac9(0x1ec)+client[_0x3a9ac9(0x1a6)]()),console['log'](_0x3a9ac9(0x1b9));const serverWillDie=new SRP6JavascriptServerSession(),B=serverWillDie[_0x3a9ac9(0x19e)](username,salt,verifier);console[_0x3a9ac9(0x207)]('‚úÖ\x20Server\x20generated\x20challenge\x20B:\x20'+B[_0x3a9ac9(0x1ef)](0x0,0x10)+_0x3a9ac9(0x1c4));const privateState=serverWillDie[_0x3a9ac9(0x1fb)](),cacheJson=JSON[_0x3a9ac9(0x1b0)](privateState);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1f9)+cacheJson[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1c3)),console[_0x3a9ac9(0x207)]('üì§\x20Client\x20Step\x202:\x20Creating\x20password\x20proof...');const credentials=client[_0x3a9ac9(0x1cd)](salt,B);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1da)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1d6)+credentials['A'][_0x3a9ac9(0x1ef)](0x0,0x10)+'...'),console[_0x3a9ac9(0x207)]('\x20\x20\x20M1:\x20'+credentials['M1'][_0x3a9ac9(0x1ef)](0x0,0x10)+_0x3a9ac9(0x1c4)),console[_0x3a9ac9(0x207)]('\x20\x20\x20Client\x20State:\x20'+client[_0x3a9ac9(0x1a6)]()),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1a5));const newPrivate=JSON[_0x3a9ac9(0x1cc)](cacheJson),server=new SRP6JavascriptServerSession();server[_0x3a9ac9(0x1a4)](newPrivate),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1ce));try{const M2=server[_0x3a9ac9(0x1cd)](credentials['A'],credentials['M1']);console[_0x3a9ac9(0x207)]('‚úÖ\x20Server\x20verified\x20credentials\x20and\x20generated\x20M2:\x20'+M2[_0x3a9ac9(0x1ef)](0x0,0x10)+_0x3a9ac9(0x1c4)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1fa));const step3Result=client[_0x3a9ac9(0x1ee)](M2);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1b7)+step3Result),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1f5)+client[_0x3a9ac9(0x1a6)]()),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1e6)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1a8));const clientSessionKey=client[_0x3a9ac9(0x1dd)](),serverSessionKey=server[_0x3a9ac9(0x1dd)]();console[_0x3a9ac9(0x207)]('üë§\x20Client\x20session\x20key:\x20'+clientSessionKey),console['log'](_0x3a9ac9(0x1ab)+serverSessionKey);if(clientSessionKey===serverSessionKey)console[_0x3a9ac9(0x207)](_0x3a9ac9(0x19c)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1e8)+clientSessionKey[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1d1));else{console[_0x3a9ac9(0x1fe)](_0x3a9ac9(0x1b2)),console[_0x3a9ac9(0x1fe)](_0x3a9ac9(0x1a1));throw new Error(_0x3a9ac9(0x1bd));}console[_0x3a9ac9(0x207)]('\x0aüéâ\x20ES\x20MODULE\x20TEST\x20RESULTS'),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1d5)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1ba)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x201)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1db)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1bb)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1fc)),console['log']('‚úÖ\x20Full\x20SRP\x20round-trip\x20successful'),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1af)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x203));const testClient=new SRP6JavascriptClientSession(),testServer=new SRP6JavascriptServerSession(),clientA=testClient[_0x3a9ac9(0x1aa)](testClient['N']),clientAHex=testClient[_0x3a9ac9(0x1ff)](clientA);console[_0x3a9ac9(0x207)]('‚ùå\x20CLIENT\x20randomA\x20hex\x20length:\x20'+clientAHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1de)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1ca)+clientAHex[_0x3a9ac9(0x1ef)](0x0,0x20)+_0x3a9ac9(0x1c4));const serverB=testServer[_0x3a9ac9(0x1cf)](),serverBHex=testServer[_0x3a9ac9(0x1ff)](serverB);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1c0)+serverBHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1de)),console['log'](_0x3a9ac9(0x1f0)+serverBHex[_0x3a9ac9(0x1ef)](0x0,0x20)+'...');const clientNActual=testClient['N'],clientNHex=testClient['toHex'](clientNActual);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x205)+clientNHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1de)),console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1eb)+clientNHex[_0x3a9ac9(0x1ef)](0x0,0x20)+'...');const expectedNLength=0x200;console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1bc)+expectedNLength+'\x20chars');clientAHex[_0x3a9ac9(0x200)]!==expectedNLength?console[_0x3a9ac9(0x1fe)](_0x3a9ac9(0x202)+clientAHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1df)+expectedNLength):console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1b3)+clientAHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x1be)+expectedNLength);serverBHex[_0x3a9ac9(0x200)]!==expectedNLength?console[_0x3a9ac9(0x1fe)](_0x3a9ac9(0x1ea)+serverBHex['length']+'\x20chars,\x20should\x20be\x20'+expectedNLength):console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1f8)+serverBHex[_0x3a9ac9(0x200)]+'\x20chars\x20matches\x20expected\x20'+expectedNLength);clientNHex[_0x3a9ac9(0x200)]!==expectedNLength?console[_0x3a9ac9(0x1fe)]('‚ùå\x20PARAMETER\x20BUG:\x20N\x20is\x20'+clientNHex['length']+_0x3a9ac9(0x1df)+expectedNLength):console[_0x3a9ac9(0x207)]('‚úÖ\x20N\x20parameter\x20correct:\x20'+clientNHex[_0x3a9ac9(0x200)]+_0x3a9ac9(0x206)+expectedNLength);console[_0x3a9ac9(0x207)]('\x0aüìä\x20COMPATIBILITY\x20TEST'),console['log'](_0x3a9ac9(0x1d9));try{const {createRequire}=await import(_0x3a9ac9(0x1c5)),require=createRequire(import.meta[_0x3a9ac9(0x1b6)]);console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1c6));const BrowserSRP6JavascriptClientSession=require('../browser.js')(rfc5054['N_base10'],rfc5054[_0x3a9ac9(0x1f7)],rfc5054['k_base16']),bclient=new BrowserSRP6JavascriptClientSession();bclient['step1'](username,password);const bserver=new SRP6JavascriptServerSession(),bB=bserver[_0x3a9ac9(0x19e)](username,salt,verifier),bcredentials=bclient[_0x3a9ac9(0x1cd)](salt,bB),bM2=bserver['step2'](bcredentials['A'],bcredentials['M1']);bclient[_0x3a9ac9(0x1ee)](bM2);const bclientSessionKey=bclient[_0x3a9ac9(0x1dd)](),bserverSessionKey=bserver[_0x3a9ac9(0x1dd)]();bclientSessionKey===bserverSessionKey?(console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1cb)),console['log'](_0x3a9ac9(0x1f2)+(bclientSessionKey===serverSessionKey?_0x3a9ac9(0x1e7):'NO'))):console[_0x3a9ac9(0x1fe)]('‚ùå\x20Browser.js\x20compatibility\x20test\x20failed');}catch(_0x285287){console[_0x3a9ac9(0x1ad)](_0x3a9ac9(0x1d2)+_0x285287[_0x3a9ac9(0x1c2)]);}}catch(_0x5a889a){console['error'](_0x3a9ac9(0x1d7)),console[_0x3a9ac9(0x1fe)](_0x3a9ac9(0x1a9)+_0x5a889a['message']),console[_0x3a9ac9(0x1fe)]('\x20\x20\x20Stack:\x20'+_0x5a889a[_0x3a9ac9(0x1dc)]);throw _0x5a889a;}function _0x428c(_0x394d28,_0x33e42e){const _0x3300ff=_0x3300();return _0x428c=function(_0x428c25,_0x54aaa9){_0x428c25=_0x428c25-0x19b;let _0x1a354a=_0x3300ff[_0x428c25];return _0x1a354a;},_0x428c(_0x394d28,_0x33e42e);}console[_0x3a9ac9(0x207)](_0x3a9ac9(0x1ac)),process[_0x3a9ac9(0x1e1)](0x0);