const _0x2e6757=_0x380e;function _0x380e(_0x2d760e,_0x4e7dec){const _0xbe48a8=_0xbe48();return _0x380e=function(_0x380e43,_0x5eedca){_0x380e43=_0x380e43-0x15c;let _0xd2087e=_0xbe48a8[_0x380e43];return _0xd2087e;},_0x380e(_0x2d760e,_0x4e7dec);}(function(_0x27def1,_0x474253){const _0x569157=_0x380e,_0x298665=_0x27def1();while(!![]){try{const _0x4bb016=-parseInt(_0x569157(0x16a))/0x1*(-parseInt(_0x569157(0x1a9))/0x2)+-parseInt(_0x569157(0x180))/0x3+parseInt(_0x569157(0x19b))/0x4+-parseInt(_0x569157(0x15f))/0x5+-parseInt(_0x569157(0x181))/0x6+-parseInt(_0x569157(0x16d))/0x7*(-parseInt(_0x569157(0x1b6))/0x8)+-parseInt(_0x569157(0x18d))/0x9*(-parseInt(_0x569157(0x196))/0xa);if(_0x4bb016===_0x474253)break;else _0x298665['push'](_0x298665['shift']());}catch(_0x5a774b){_0x298665['push'](_0x298665['shift']());}}}(_0xbe48,0x8b771));import{fileURLToPath,pathToFileURL}from'url';import{dirname,join}from'path';import{createHash}from'crypto';globalThis[_0x2e6757(0x1a6)]={'createHash':createHash};const __filename=fileURLToPath(import.meta[_0x2e6757(0x17a)]),__dirname=dirname(__filename),clientModule=await import(pathToFileURL(join(__dirname,'..',_0x2e6757(0x184)))['href']),serverModule=await import(pathToFileURL(join(__dirname,'..','server.mjs'))[_0x2e6757(0x18b)]),rfc5054={'N_base10':_0x2e6757(0x1b2),'g_base10':'2','k_base16':_0x2e6757(0x16e)};console['log'](_0x2e6757(0x1b1)),console['log'](_0x2e6757(0x170)),console[_0x2e6757(0x1af)]('ğŸ“¦\x20Creating\x20client\x20session\x20factory...');const SRP6JavascriptClientSession=clientModule[_0x2e6757(0x18a)](rfc5054['N_base10'],rfc5054[_0x2e6757(0x17d)],rfc5054[_0x2e6757(0x182)]);console[_0x2e6757(0x1af)](_0x2e6757(0x15e)),console['log'](_0x2e6757(0x190));const SRP6JavascriptServerSession=serverModule['default'](rfc5054['N_base10'],rfc5054[_0x2e6757(0x17d)],rfc5054['k_base16']);console[_0x2e6757(0x1af)](_0x2e6757(0x19d)),console[_0x2e6757(0x1af)](_0x2e6757(0x177)),console[_0x2e6757(0x1af)](_0x2e6757(0x160)),console[_0x2e6757(0x1af)](_0x2e6757(0x175));const client=new SRP6JavascriptClientSession();console[_0x2e6757(0x1af)]('âœ…\x20Client\x20session\x20created'),console[_0x2e6757(0x1af)](_0x2e6757(0x165));const salt=client['generateRandomSalt']();function _0xbe48(){const _0x31daf8=['21766174458617435773191008891802753781907668374255538511144643224689886235383840957210909013086056401571399717235807266581649606472148410291413364152197364477180887395655483738115072677402235101762521901569820740293149529620419333266262073471054548368736039519702486226506248861060256971802984953561121442680157668000761429988222457090413873973970171927093992114751765168063614761119615476233422096442783117971236371647333871414335895773474667308967050807005509320424799678417036867928316761272274230314067548291133582479583061439577559347101961771406173684378522703483495337037655006751328447510550299250924469288819','ğŸ”‘\x20Password:\x20','âœ…\x20Session\x20keys\x20generated\x20and\x20verified','generateVerifier','31616TzvLCH','ğŸ”\x20Server\x20Step\x202:\x20Verifying\x20credentials...','\x20\x20\x20M1:\x20','âœ…\x20Client\x20session\x20factory\x20created','4978745duZcas','=====================','../browser.js','âœ…\x20Verifier\x20generated:\x20','ğŸ“¤\x20Client\x20Step\x202:\x20Creating\x20password\x20proof...','ğŸ”\x20Client\x20Step\x203:\x20Verifying\x20server\x20proof...','ğŸ§‚\x20Generating\x20random\x20salt...','ğŸ—ï¸\x20\x20Server\x20Step\x201:\x20Generating\x20challenge...','ğŸ”—\x20Browser-Server\x20key\x20match:\x20','âŒ\x20FAILURE:\x20Session\x20keys\x20do\x20not\x20match!','...','6pMjwBS','âœ…\x20Client\x20verified\x20server\x20proof:\x20','=========================','336BJMmCu','5b9e8ef059c6b32ea59fc1d322d37f04aa30bae5aa9003b8321e21ddb04e300','ğŸŒ\x20Testing\x20backward\x20compatibility\x20with\x20browser.js...','=====================================','âœ…\x20SRP\x20registration\x20phase\x20completed','\x20\x20\x20Final\x20Client\x20State:\x20','âœ…\x20Client\x20step1\x20completed\x20-\x20State:\x20','âœ…\x20SRP\x20authentication\x20phase\x20completed','ğŸ‘¤\x20Creating\x20client\x20session...','âœ…\x20Full\x20SRP\x20round-trip\x20successful','\x0ağŸ”\x20REGISTRATION\x20PHASE','âœ…\x20Server\x20verified\x20credentials\x20and\x20generated\x20M2:\x20','password1234','url','toPrivateStoreState','N_base10','g_base10','getSessionKey','length','850029NypKBh','3450024KJYbXG','k_base16','error','client.mjs','\x20characters','fromPrivateStoreState','warn','âœ…\x20Client\x20ES\x20module\x20loaded\x20successfully','Session\x20key\x20mismatch\x20-\x20SRP\x20protocol\x20failed','default','href','âœ…\x20Browser.js\x20compatibility\x20test\x20passed','6906699gccfXv','===========================','âš ï¸\x20\x20Browser.js\x20compatibility\x20test\x20skipped:\x20','ğŸ“¦\x20Creating\x20server\x20session\x20factory...','\x0ağŸ”‘\x20SESSION\x20KEY\x20VERIFICATION','substring','\x20\x20\x20Stack:\x20','\x20\x20\x20Client\x20State:\x20','getState','10ilefRJ','\x0ağŸ‰\x20ES\x20MODULE\x20TEST\x20RESULTS','==============','\x0ağŸ“Š\x20COMPATIBILITY\x20TEST','âœ…\x20Client\x20generated\x20credentials:','1411520dcmIjE','âœ…\x20Salt\x20generated:\x20','âœ…\x20Server\x20session\x20factory\x20created','\x20bytes)','module','message','âŒ\x20CRITICAL\x20ERROR\x20in\x20SRP\x20authentication:','parse','âœ…\x20Server\x20ES\x20module\x20loaded\x20successfully','ğŸ”\x20Shared\x20key\x20length:\x20','step1','nodeCrypto','ğŸ’¾\x20Server\x20private\x20state\x20cached\x20(','ğŸ“¤\x20Client\x20Step\x201:\x20Sending\x20credentials\x20to\x20start\x20authentication...','371786PcUKVf','\x0ağŸšª\x20LOGIN\x20PHASE','ğŸ‘¤\x20User:\x20','step2','ğŸ‘¤\x20Client\x20session\x20key:\x20','\x0ağŸ\x20All\x20tests\x20completed\x20successfully!','log','ğŸ’¾\x20Server\x20private\x20state\x20restored\x20from\x20cache','ğŸš€\x20Starting\x20SRP\x20ES\x20Module\x20Test\x20Suite'];_0xbe48=function(){return _0x31daf8;};return _0xbe48();}console[_0x2e6757(0x1af)](_0x2e6757(0x19c)+salt['substring'](0x0,0x10)+_0x2e6757(0x169));const username='tom@arcot.com',password=_0x2e6757(0x179);console['log'](_0x2e6757(0x1ab)+username),console[_0x2e6757(0x1af)](_0x2e6757(0x1b3)+password),console[_0x2e6757(0x1af)]('ğŸ”\x20Generating\x20verifier...');const verifier=client[_0x2e6757(0x1b5)](salt,username,password);console[_0x2e6757(0x1af)](_0x2e6757(0x162)+verifier[_0x2e6757(0x192)](0x0,0x10)+_0x2e6757(0x169)),console['log'](_0x2e6757(0x1aa)),console[_0x2e6757(0x1af)](_0x2e6757(0x198)),console[_0x2e6757(0x1af)](_0x2e6757(0x1a8)),client[_0x2e6757(0x1a5)](username,password),console['log'](_0x2e6757(0x173)+client['getState']()),console[_0x2e6757(0x1af)](_0x2e6757(0x166));const serverWillDie=new SRP6JavascriptServerSession(),B=serverWillDie[_0x2e6757(0x1a5)](username,salt,verifier);console['log']('âœ…\x20Server\x20generated\x20challenge\x20B:\x20'+B[_0x2e6757(0x192)](0x0,0x10)+'...');const privateState=serverWillDie[_0x2e6757(0x17b)](),cacheJson=JSON['stringify'](privateState);console[_0x2e6757(0x1af)](_0x2e6757(0x1a7)+cacheJson[_0x2e6757(0x17f)]+_0x2e6757(0x19e)),console['log'](_0x2e6757(0x163));const credentials=client['step2'](salt,B);console[_0x2e6757(0x1af)](_0x2e6757(0x19a)),console[_0x2e6757(0x1af)]('\x20\x20\x20A:\x20'+credentials['A'][_0x2e6757(0x192)](0x0,0x10)+_0x2e6757(0x169)),console[_0x2e6757(0x1af)](_0x2e6757(0x15d)+credentials['M1'][_0x2e6757(0x192)](0x0,0x10)+'...'),console[_0x2e6757(0x1af)](_0x2e6757(0x194)+client[_0x2e6757(0x195)]()),console[_0x2e6757(0x1af)](_0x2e6757(0x15c));const newPrivate=JSON[_0x2e6757(0x1a2)](cacheJson),server=new SRP6JavascriptServerSession();server[_0x2e6757(0x186)](newPrivate),console[_0x2e6757(0x1af)](_0x2e6757(0x1b0));try{const M2=server[_0x2e6757(0x1ac)](credentials['A'],credentials['M1']);console[_0x2e6757(0x1af)](_0x2e6757(0x178)+M2[_0x2e6757(0x192)](0x0,0x10)+'...'),console[_0x2e6757(0x1af)](_0x2e6757(0x164));const step3Result=client['step3'](M2);console['log'](_0x2e6757(0x16b)+step3Result),console['log'](_0x2e6757(0x172)+client['getState']()),console[_0x2e6757(0x1af)](_0x2e6757(0x191)),console[_0x2e6757(0x1af)](_0x2e6757(0x18e));const clientSessionKey=client[_0x2e6757(0x17e)](),serverSessionKey=server[_0x2e6757(0x17e)]();console['log'](_0x2e6757(0x1ad)+clientSessionKey),console[_0x2e6757(0x1af)]('ğŸ–¥ï¸\x20\x20Server\x20session\x20key:\x20'+serverSessionKey);if(clientSessionKey===serverSessionKey)console[_0x2e6757(0x1af)]('âœ…\x20SUCCESS:\x20Session\x20keys\x20match\x20perfectly!'),console['log'](_0x2e6757(0x1a4)+clientSessionKey[_0x2e6757(0x17f)]+_0x2e6757(0x185));else{console[_0x2e6757(0x183)](_0x2e6757(0x168)),console[_0x2e6757(0x183)]('This\x20indicates\x20a\x20problem\x20with\x20the\x20SRP\x20implementation.');throw new Error(_0x2e6757(0x189));}console[_0x2e6757(0x1af)](_0x2e6757(0x197)),console[_0x2e6757(0x1af)](_0x2e6757(0x16c)),console[_0x2e6757(0x1af)](_0x2e6757(0x188)),console['log'](_0x2e6757(0x1a3)),console['log'](_0x2e6757(0x171)),console[_0x2e6757(0x1af)](_0x2e6757(0x174)),console['log'](_0x2e6757(0x1b4)),console[_0x2e6757(0x1af)](_0x2e6757(0x176)),console['log'](_0x2e6757(0x199)),console[_0x2e6757(0x1af)]('=====================');try{const {createRequire}=await import(_0x2e6757(0x19f)),require=createRequire(import.meta[_0x2e6757(0x17a)]);console[_0x2e6757(0x1af)](_0x2e6757(0x16f));const BrowserSRP6JavascriptClientSession=require(_0x2e6757(0x161))(rfc5054[_0x2e6757(0x17c)],rfc5054[_0x2e6757(0x17d)],rfc5054[_0x2e6757(0x182)]),bclient=new BrowserSRP6JavascriptClientSession();bclient['step1'](username,password);const bserver=new SRP6JavascriptServerSession(),bB=bserver[_0x2e6757(0x1a5)](username,salt,verifier),bcredentials=bclient[_0x2e6757(0x1ac)](salt,bB),bM2=bserver['step2'](bcredentials['A'],bcredentials['M1']);bclient['step3'](bM2);const bclientSessionKey=bclient[_0x2e6757(0x17e)](),bserverSessionKey=bserver[_0x2e6757(0x17e)]();bclientSessionKey===bserverSessionKey?(console['log'](_0x2e6757(0x18c)),console[_0x2e6757(0x1af)](_0x2e6757(0x167)+(bclientSessionKey===serverSessionKey?'YES':'NO'))):console[_0x2e6757(0x183)]('âŒ\x20Browser.js\x20compatibility\x20test\x20failed');}catch(_0x598588){console[_0x2e6757(0x187)](_0x2e6757(0x18f)+_0x598588[_0x2e6757(0x1a0)]);}}catch(_0x5bc8a1){console[_0x2e6757(0x183)](_0x2e6757(0x1a1)),console[_0x2e6757(0x183)]('\x20\x20\x20Error:\x20'+_0x5bc8a1[_0x2e6757(0x1a0)]),console[_0x2e6757(0x183)](_0x2e6757(0x193)+_0x5bc8a1['stack']);throw _0x5bc8a1;}console[_0x2e6757(0x1af)](_0x2e6757(0x1ae)),process['exit'](0x0);