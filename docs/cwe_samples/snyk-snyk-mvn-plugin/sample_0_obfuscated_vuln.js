function _0x1f97(_0x352070,_0x4472eb){const _0x147651=_0x1476();return _0x1f97=function(_0x1f9765,_0x222fa7){_0x1f9765=_0x1f9765-0x15b;let _0x37ec43=_0x147651[_0x1f9765];return _0x37ec43;},_0x1f97(_0x352070,_0x4472eb);}const _0x405411=_0x1f97;(function(_0x40458e,_0x1fb321){const _0x52ca93=_0x1f97,_0xad357f=_0x40458e();while(!![]){try{const _0x52bc10=parseInt(_0x52ca93(0x15c))/0x1+parseInt(_0x52ca93(0x1aa))/0x2+parseInt(_0x52ca93(0x1a3))/0x3*(parseInt(_0x52ca93(0x1ae))/0x4)+parseInt(_0x52ca93(0x169))/0x5+-parseInt(_0x52ca93(0x17f))/0x6*(-parseInt(_0x52ca93(0x181))/0x7)+parseInt(_0x52ca93(0x187))/0x8+-parseInt(_0x52ca93(0x16f))/0x9*(parseInt(_0x52ca93(0x1c7))/0xa);if(_0x52bc10===_0x1fb321)break;else _0xad357f['push'](_0xad357f['shift']());}catch(_0xd01d91){_0xad357f['push'](_0xad357f['shift']());}}}(_0x1476,0x42cd5));import{fileURLToPath,pathToFileURL}from'url';import{dirname,join}from'path';import{createHash}from'crypto';globalThis['nodeCrypto']={'createHash':createHash};const __filename=fileURLToPath(import.meta['url']),__dirname=dirname(__filename),clientModule=await import(pathToFileURL(join(__dirname,'..','client.mjs'))[_0x405411(0x1af)]),serverModule=await import(pathToFileURL(join(__dirname,'..',_0x405411(0x1a0)))[_0x405411(0x1af)]),rfc5054={'N_base10':_0x405411(0x16d),'g_base10':'2','k_base16':_0x405411(0x1a1)};console[_0x405411(0x16e)](_0x405411(0x192)),console[_0x405411(0x16e)]('====================================='),console['log'](_0x405411(0x1c5));const SRP6JavascriptClientSession=clientModule[_0x405411(0x183)](rfc5054[_0x405411(0x196)],rfc5054[_0x405411(0x193)],rfc5054[_0x405411(0x1b2)]);console['log'](_0x405411(0x16a)),console[_0x405411(0x16e)]('üì¶\x20Creating\x20server\x20session\x20factory...');const SRP6JavascriptServerSession=serverModule['default'](rfc5054[_0x405411(0x196)],rfc5054[_0x405411(0x193)],rfc5054[_0x405411(0x1b2)]);function _0x1476(){const _0x88927d=['159mwRXar','toPrivateStoreState','‚úÖ\x20Browser.js\x20compatibility\x20test\x20passed','üîç\x20Server\x20Step\x202:\x20Verifying\x20credentials...','==============','\x20chars','‚úÖ\x20Server\x20verified\x20credentials\x20and\x20generated\x20M2:\x20','653028hCUvcO','‚ùå\x20Browser.js\x20compatibility\x20test\x20failed','‚ùå\x20CLIENT\x20randomA\x20value:\x20','üë§\x20User:\x20','26876QXcicr','href','‚úÖ\x20Full\x20SRP\x20round-trip\x20successful','getState','k_base16','../browser.js','‚ùå\x20ENTROPY\x20BUG:\x20Server\x20B\x20is\x20','‚úÖ\x20ENTROPY\x20FIX\x20CONFIRMED:\x20Client\x20A\x20is\x20','=========================','generateVerifier','‚ùå\x20PARAMETER\x20BUG:\x20N\x20is\x20','üîê\x20Shared\x20key\x20length:\x20','\x20\x20\x20M1:\x20','‚úÖ\x20Salt\x20generated:\x20','\x20\x20\x20Stack:\x20','\x20chars,\x20should\x20be\x20','üíæ\x20Server\x20private\x20state\x20restored\x20from\x20cache','exit','\x20chars\x20matches\x20expected\x20','\x0aüîë\x20SESSION\x20KEY\x20VERIFICATION','‚úÖ\x20SRP\x20registration\x20phase\x20completed','‚ùå\x20CLIENT\x20randomA\x20hex\x20length:\x20','step2','üì¶\x20Creating\x20client\x20session\x20factory...','step3','430CNBXAP','üßÇ\x20Generating\x20random\x20salt...','‚úÖ\x20Server\x20generated\x20challenge\x20B:\x20','401846HtNsZL','üë§\x20Creating\x20client\x20session...','randomB','step1','‚úÖ\x20Session\x20keys\x20generated\x20and\x20verified','‚úÖ\x20Verifier\x20generated:\x20','\x0aüîê\x20REGISTRATION\x20PHASE','message','‚úÖ\x20SRP\x20authentication\x20phase\x20completed','\x20characters','‚ùå\x20ENTROPY\x20BUG:\x20Client\x20A\x20is\x20','üíæ\x20Server\x20private\x20state\x20cached\x20(','YES','954575XCbPLf','‚úÖ\x20Client\x20session\x20factory\x20created','üîó\x20Browser-Server\x20key\x20match:\x20','...','21766174458617435773191008891802753781907668374255538511144643224689886235383840957210909013086056401571399717235807266581649606472148410291413364152197364477180887395655483738115072677402235101762521901569820740293149529620419333266262073471054548368736039519702486226506248861060256971802984953561121442680157668000761429988222457090413873973970171927093992114751765168063614761119615476233422096442783117971236371647333871414335895773474667308967050807005509320424799678417036867928316761272274230314067548291133582479583061439577559347101961771406173684378522703483495337037655006751328447510550299250924469288819','log','367128ZJmPLi','======================================','password1234','\x20\x20\x20Final\x20Client\x20State:\x20','üåê\x20Testing\x20backward\x20compatibility\x20with\x20browser.js...','toHex','üîë\x20Password:\x20','tom@arcot.com','error','This\x20indicates\x20a\x20problem\x20with\x20the\x20SRP\x20implementation.','üìã\x20This\x20codebase\x20uses\x202048-bit\x20N,\x20expected\x20length:\x20','length','üîê\x20Generating\x20verifier...','‚úÖ\x20Server\x20ES\x20module\x20loaded\x20successfully','üèóÔ∏è\x20\x20Server\x20Step\x201:\x20Generating\x20challenge...','=====================','23496xPOWFe','‚úÖ\x20Client\x20generated\x20credentials:','385cNaAPv','\x20chars,\x20matches\x20expected\x20','default','\x20bytes)','‚úÖ\x20Client\x20step1\x20completed\x20-\x20State:\x20','‚úÖ\x20CORRECT\x20N\x20value:\x20','4295320EvNSVW','‚úÖ\x20Server\x20session\x20factory\x20created','‚ö†Ô∏è\x20\x20Browser.js\x20compatibility\x20test\x20skipped:\x20','‚úÖ\x20Client\x20verified\x20server\x20proof:\x20','\x0aüö™\x20LOGIN\x20PHASE','üñ•Ô∏è\x20\x20Server\x20session\x20key:\x20','üîç\x20SERVER\x20randomB\x20hex\x20length:\x20','‚úÖ\x20N\x20parameter\x20correct:\x20','\x0aüìä\x20COMPATIBILITY\x20TEST','generateRandomSalt','getSessionKey','üöÄ\x20Starting\x20SRP\x20ES\x20Module\x20Test\x20Suite','g_base10','‚úÖ\x20Client\x20session\x20created','‚úÖ\x20Client\x20ES\x20module\x20loaded\x20successfully','N_base10','\x0aüéâ\x20ES\x20MODULE\x20TEST\x20RESULTS','‚ùå\x20FAILURE:\x20Session\x20keys\x20do\x20not\x20match!','parse','\x20\x20\x20Error:\x20','Session\x20key\x20mismatch\x20-\x20SRP\x20protocol\x20failed','warn','randomA','‚úÖ\x20SUCCESS:\x20Session\x20keys\x20match\x20perfectly!','module','server.mjs','5b9e8ef059c6b32ea59fc1d322d37f04aa30bae5aa9003b8321e21ddb04e300','substring'];_0x1476=function(){return _0x88927d;};return _0x1476();}console['log'](_0x405411(0x188)),console[_0x405411(0x16e)](_0x405411(0x162)),console[_0x405411(0x16e)]('====================='),console['log'](_0x405411(0x15d));const client=new SRP6JavascriptClientSession();console[_0x405411(0x16e)](_0x405411(0x194)),console['log'](_0x405411(0x1c8));const salt=client[_0x405411(0x190)]();console[_0x405411(0x16e)](_0x405411(0x1bb)+salt[_0x405411(0x1a2)](0x0,0x10)+_0x405411(0x16c));const username=_0x405411(0x176),password=_0x405411(0x171);console[_0x405411(0x16e)](_0x405411(0x1ad)+username),console[_0x405411(0x16e)](_0x405411(0x175)+password),console['log'](_0x405411(0x17b));const verifier=client[_0x405411(0x1b7)](salt,username,password);console[_0x405411(0x16e)](_0x405411(0x161)+verifier[_0x405411(0x1a2)](0x0,0x10)+_0x405411(0x16c)),console[_0x405411(0x16e)](_0x405411(0x18b)),console[_0x405411(0x16e)](_0x405411(0x1a7)),console[_0x405411(0x16e)]('üì§\x20Client\x20Step\x201:\x20Sending\x20credentials\x20to\x20start\x20authentication...'),client['step1'](username,password),console[_0x405411(0x16e)](_0x405411(0x185)+client[_0x405411(0x1b1)]()),console[_0x405411(0x16e)](_0x405411(0x17d));const serverWillDie=new SRP6JavascriptServerSession(),B=serverWillDie['step1'](username,salt,verifier);console[_0x405411(0x16e)](_0x405411(0x15b)+B[_0x405411(0x1a2)](0x0,0x10)+_0x405411(0x16c));const privateState=serverWillDie[_0x405411(0x1a4)](),cacheJson=JSON['stringify'](privateState);console['log'](_0x405411(0x167)+cacheJson[_0x405411(0x17a)]+_0x405411(0x184)),console[_0x405411(0x16e)]('üì§\x20Client\x20Step\x202:\x20Creating\x20password\x20proof...');const credentials=client[_0x405411(0x1c4)](salt,B);console[_0x405411(0x16e)](_0x405411(0x180)),console['log']('\x20\x20\x20A:\x20'+credentials['A'][_0x405411(0x1a2)](0x0,0x10)+_0x405411(0x16c)),console['log'](_0x405411(0x1ba)+credentials['M1']['substring'](0x0,0x10)+'...'),console[_0x405411(0x16e)]('\x20\x20\x20Client\x20State:\x20'+client[_0x405411(0x1b1)]()),console[_0x405411(0x16e)](_0x405411(0x1a6));const newPrivate=JSON[_0x405411(0x199)](cacheJson),server=new SRP6JavascriptServerSession();server['fromPrivateStoreState'](newPrivate),console[_0x405411(0x16e)](_0x405411(0x1be));try{const M2=server[_0x405411(0x1c4)](credentials['A'],credentials['M1']);console[_0x405411(0x16e)](_0x405411(0x1a9)+M2['substring'](0x0,0x10)+_0x405411(0x16c)),console[_0x405411(0x16e)]('üîç\x20Client\x20Step\x203:\x20Verifying\x20server\x20proof...');const step3Result=client[_0x405411(0x1c6)](M2);console[_0x405411(0x16e)](_0x405411(0x18a)+step3Result),console[_0x405411(0x16e)](_0x405411(0x172)+client[_0x405411(0x1b1)]()),console['log'](_0x405411(0x1c1)),console[_0x405411(0x16e)]('===========================');const clientSessionKey=client[_0x405411(0x191)](),serverSessionKey=server[_0x405411(0x191)]();console['log']('üë§\x20Client\x20session\x20key:\x20'+clientSessionKey),console[_0x405411(0x16e)](_0x405411(0x18c)+serverSessionKey);if(clientSessionKey===serverSessionKey)console[_0x405411(0x16e)](_0x405411(0x19e)),console[_0x405411(0x16e)](_0x405411(0x1b9)+clientSessionKey[_0x405411(0x17a)]+_0x405411(0x165));else{console[_0x405411(0x177)](_0x405411(0x198)),console['error'](_0x405411(0x178));throw new Error(_0x405411(0x19b));}console[_0x405411(0x16e)](_0x405411(0x197)),console[_0x405411(0x16e)](_0x405411(0x1b6)),console[_0x405411(0x16e)](_0x405411(0x195)),console[_0x405411(0x16e)](_0x405411(0x17c)),console['log'](_0x405411(0x1c2)),console['log'](_0x405411(0x164)),console[_0x405411(0x16e)](_0x405411(0x160)),console[_0x405411(0x16e)](_0x405411(0x1b0)),console[_0x405411(0x16e)]('\x0aüß™\x20RFC\x205054\x20ENTROPY\x20TEST\x20(SHOULD\x20FAIL)'),console[_0x405411(0x16e)](_0x405411(0x170));const testClient=new SRP6JavascriptClientSession(),testServer=new SRP6JavascriptServerSession(),clientA=testClient[_0x405411(0x19d)](testClient['N']),clientAHex=testClient[_0x405411(0x174)](clientA);console[_0x405411(0x16e)](_0x405411(0x1c3)+clientAHex[_0x405411(0x17a)]+_0x405411(0x1a8)),console[_0x405411(0x16e)](_0x405411(0x1ac)+clientAHex['substring'](0x0,0x20)+_0x405411(0x16c));const serverB=testServer[_0x405411(0x15e)](),serverBHex=testServer[_0x405411(0x174)](serverB);console[_0x405411(0x16e)](_0x405411(0x18d)+serverBHex[_0x405411(0x17a)]+_0x405411(0x1a8)),console[_0x405411(0x16e)]('üîç\x20SERVER\x20randomB\x20value:\x20'+serverBHex[_0x405411(0x1a2)](0x0,0x20)+_0x405411(0x16c));const clientNActual=testClient['N'],clientNHex=testClient[_0x405411(0x174)](clientNActual);console['log']('‚úÖ\x20CORRECT\x20N\x20hex\x20length:\x20'+clientNHex[_0x405411(0x17a)]+_0x405411(0x1a8)),console[_0x405411(0x16e)](_0x405411(0x186)+clientNHex[_0x405411(0x1a2)](0x0,0x20)+_0x405411(0x16c));const expectedNLength=0x200;console[_0x405411(0x16e)](_0x405411(0x179)+expectedNLength+_0x405411(0x1a8));clientAHex[_0x405411(0x17a)]!==expectedNLength?console[_0x405411(0x177)](_0x405411(0x166)+clientAHex[_0x405411(0x17a)]+_0x405411(0x1bd)+expectedNLength):console[_0x405411(0x16e)](_0x405411(0x1b5)+clientAHex[_0x405411(0x17a)]+_0x405411(0x182)+expectedNLength);serverBHex[_0x405411(0x17a)]!==expectedNLength?console[_0x405411(0x177)](_0x405411(0x1b4)+serverBHex[_0x405411(0x17a)]+'\x20chars,\x20should\x20be\x20'+expectedNLength):console['log']('‚úÖ\x20Server\x20B\x20entropy\x20correct:\x20'+serverBHex[_0x405411(0x17a)]+_0x405411(0x1c0)+expectedNLength);clientNHex[_0x405411(0x17a)]!==expectedNLength?console['error'](_0x405411(0x1b8)+clientNHex[_0x405411(0x17a)]+_0x405411(0x1bd)+expectedNLength):console[_0x405411(0x16e)](_0x405411(0x18e)+clientNHex[_0x405411(0x17a)]+_0x405411(0x1c0)+expectedNLength);console[_0x405411(0x16e)](_0x405411(0x18f)),console[_0x405411(0x16e)](_0x405411(0x17e));try{const {createRequire}=await import(_0x405411(0x19f)),require=createRequire(import.meta['url']);console[_0x405411(0x16e)](_0x405411(0x173));const BrowserSRP6JavascriptClientSession=require(_0x405411(0x1b3))(rfc5054[_0x405411(0x196)],rfc5054[_0x405411(0x193)],rfc5054[_0x405411(0x1b2)]),bclient=new BrowserSRP6JavascriptClientSession();bclient[_0x405411(0x15f)](username,password);const bserver=new SRP6JavascriptServerSession(),bB=bserver['step1'](username,salt,verifier),bcredentials=bclient[_0x405411(0x1c4)](salt,bB),bM2=bserver['step2'](bcredentials['A'],bcredentials['M1']);bclient[_0x405411(0x1c6)](bM2);const bclientSessionKey=bclient[_0x405411(0x191)](),bserverSessionKey=bserver[_0x405411(0x191)]();bclientSessionKey===bserverSessionKey?(console[_0x405411(0x16e)](_0x405411(0x1a5)),console[_0x405411(0x16e)](_0x405411(0x16b)+(bclientSessionKey===serverSessionKey?_0x405411(0x168):'NO'))):console['error'](_0x405411(0x1ab));}catch(_0x1eca5c){console[_0x405411(0x19c)](_0x405411(0x189)+_0x1eca5c[_0x405411(0x163)]);}}catch(_0x3f1fb2){console[_0x405411(0x177)]('‚ùå\x20CRITICAL\x20ERROR\x20in\x20SRP\x20authentication:'),console[_0x405411(0x177)](_0x405411(0x19a)+_0x3f1fb2[_0x405411(0x163)]),console[_0x405411(0x177)](_0x405411(0x1bc)+_0x3f1fb2['stack']);throw _0x3f1fb2;}console[_0x405411(0x16e)]('\x0aüèÅ\x20All\x20tests\x20completed\x20successfully!'),process[_0x405411(0x1bf)](0x0);