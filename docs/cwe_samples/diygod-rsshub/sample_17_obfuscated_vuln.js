function _0x4b8e(_0xfef4dc,_0x6c5fdb){const _0x429d86=_0x429d();return _0x4b8e=function(_0x4b8eb0,_0x6249c8){_0x4b8eb0=_0x4b8eb0-0x126;let _0x307a09=_0x429d86[_0x4b8eb0];return _0x307a09;},_0x4b8e(_0xfef4dc,_0x6c5fdb);}(function(_0x1a3c05,_0x3df28f){const _0x572359=_0x4b8e,_0x575dcc=_0x1a3c05();while(!![]){try{const _0x37b3f9=parseInt(_0x572359(0x169))/0x1+-parseInt(_0x572359(0x1ea))/0x2+-parseInt(_0x572359(0x172))/0x3+-parseInt(_0x572359(0x165))/0x4+-parseInt(_0x572359(0x1ab))/0x5*(-parseInt(_0x572359(0x1e7))/0x6)+-parseInt(_0x572359(0x1c7))/0x7*(parseInt(_0x572359(0x143))/0x8)+parseInt(_0x572359(0x1c5))/0x9;if(_0x37b3f9===_0x3df28f)break;else _0x575dcc['push'](_0x575dcc['shift']());}catch(_0x1fd6e4){_0x575dcc['push'](_0x575dcc['shift']());}}}(_0x429d,0x4c917));import _0xa97d71 from'is-url';import _0x5dc1a2 from'jquery';import _0x2fe0a1 from'lodash';import _0x47f830 from'turndown';import*as _0x4d9df2 from'./compose_ui';function _0x429d(){const _0x2189fd=['get_message_recipient_row','hQDwo','<strong>','wtwSh','<pre><code>','GtOcc','BZHss','mXwwE','faaZH','tTrpL','charAt','gFqup','obUcI','listItem','Olsje','$1$2.\x20','children','MrfRk','RyuCP','attr','mcpXs','fenced','.messagebox-content','append','message_inline_image','contents','content','getSelection','ranges','.message_header','jgtjE','IMG','tvrsq','prototype','dWhvK','DMyRI','turndown','first','IKskc','982095IhotEn','zqMAP','XbWrU','childNodes','tNhQK','wLzYp','.recipient_row','text/html','ZCjEv','ASFgg','ymgwS','bZjhT','value','links','HJSeY','phkAe','WPlZw','hKDtM','qfczw','#333','copy','nodeName','exec','test','saZrQ','copytempdiv','11610306RoJyjW','UMlwQ','14gosYNE','<div>','EfMzU','range','yoJNC','puNUa','zulip-code-block','closest','prepend','shift_pressed','removeAllRanges','VrHtB','filter','find','strike','currentTarget','FyDeX','hZqmK','originalEvent','style','img','start_id','fencedCodeBlock','css','title','parents','EjjxQ','rangeCount','classList','yBqqx','Yjhsg','GiFmg','6QaHSza','atx','.message_edit_content','383572djixnN','dataset','parentNode','firstChild','skip_same_td_check','match','compose_close','AoGjd','blQwU','trim','current','parseFromString','htMzg','gxGcI','start','<span>','nextSibling','UClJB','TGdoH','execCommand','JQYjE','startContainer','CODE','EEkHk','getRangeAt','CbrWO','BLdFn','math','TWIZi','UQplv','rPXVN','qXxqT','uTqLP','#copytempdiv','visible_range','innerHTML','href','setTimeout','clipboardData','id_for_recipient_row','UMDyt','MUYiP','grPpP','HVdcg','prev','strikethrough','uBBZB','textarea#compose-textarea','<p>','vRRZP','2134024lkaPeq','selectAllChildren','ShZyS','VwTgi','qXOnO','last','class','contains','preventDefault','hUVVp','body','udQpB','eKWpM','remove','aria-label','replaceAll','parentElement','escape','UwQxW','SsYeF','qfXpm','zPhWY','-99999px','FQJWk','get_message_recipient_header','SZpWE','aaVws','WYkRL','alt','.selectable_row','textContent','codeLanguage','egfOi','addRule','2004020IVgoWv','getData','getAttribute','hasAttribute','320498wGKauY','lCwsv','length','bDHiE','src','oZRri','geoaQ','yzwOk','includes','801093PWairh','firstElementChild','whiteSpace','RPrUy','.message_row','end_id','replace','text','rhmMC','#FFF','.selectable_row,\x20.message_header','pQrkf','{3,}','call','XzTjw','csUHz','querySelector','endContainer'];_0x429d=function(){return _0x2189fd;};return _0x429d();}import*as _0x33d66e from'./message_lists';import*as _0x362ea5 from'./rows';function find_boundary_tr(_0xd2da7d,_0x38551f){const _0x566f58=_0x4b8e,_0x5d8d6f={'ASFgg':function(_0x2bdc2d,_0x11fc62){return _0x2bdc2d<_0x11fc62;},'tvrsq':function(_0x2add12,_0x5c3323){return _0x2add12===_0x5c3323;}};let _0x297163,_0x25d5eb=![],_0x5efa3d=_0xd2da7d;if(_0x5efa3d[_0x566f58(0x16b)]===0x0)return undefined;for(_0x297163=0x0;!_0x5efa3d['is'](_0x566f58(0x176))&&_0x5d8d6f[_0x566f58(0x1b4)](_0x297163,0xa);_0x297163+=0x1){_0x5efa3d=_0x38551f(_0x5efa3d);}if(_0x5d8d6f[_0x566f58(0x1a4)](_0x297163,0xa))return'cSbeA'!==_0x566f58(0x18c)?undefined:_0x543a61?_0x4025dd[_0x566f58(0x152)](/(\n+\s*)+/g,'\x0a'):'';else _0x297163!==0x0&&(_0x25d5eb=!![]);return[_0x362ea5['id'](_0x5efa3d),_0x25d5eb];}function construct_recipient_header(_0x1a589e){const _0x443c1f=_0x4b8e,_0x9916b5={'RJGEi':function(_0x4d00f9,_0x4cdf7e){return _0x4d00f9(_0x4cdf7e);}},_0x228a46=_0x362ea5[_0x443c1f(0x15b)](_0x1a589e)[_0x443c1f(0x179)]()[_0x443c1f(0x152)](/\s+/g,'\x20')[_0x443c1f(0x178)](/^\s/,'')[_0x443c1f(0x178)](/\s$/,'');return _0x9916b5['RJGEi'](_0x5dc1a2,_0x443c1f(0x141))[_0x443c1f(0x19b)](_0x9916b5['RJGEi'](_0x5dc1a2,_0x443c1f(0x186))[_0x443c1f(0x179)](_0x228a46));}function construct_copy_div(_0x54ff8f,_0x3294eb,_0x1a321e){const _0x2fcc0d=_0x4b8e,_0x40b0de={'IKskc':function(_0x4f2315,_0x1c690d){return _0x4f2315(_0x1c690d);},'xfPxz':function(_0x25369f,_0xb87371){return _0x25369f===_0xb87371;},'WPlZw':function(_0x474201,_0x53fce6){return _0x474201!==_0x53fce6;},'LgAJQ':_0x2fcc0d(0x1e5),'CivLz':function(_0x3255f5,_0x4ba556){return _0x3255f5(_0x4ba556);},'AZaXK':_0x2fcc0d(0x1f9)};if(_0x40b0de['xfPxz'](_0x33d66e['current'],undefined))return;const _0x51b983=_0x362ea5[_0x2fcc0d(0x133)](_0x3294eb,_0x1a321e),_0x2c4f28=_0x51b983[0x0],_0x594d13=_0x362ea5[_0x2fcc0d(0x184)](_0x2c4f28),_0x189b36=_0x362ea5['id_for_recipient_row'](_0x594d13);let _0x53c42b=![],_0x39e4a0=_0x189b36;for(const _0x589db0 of _0x51b983){const _0x5d730f=_0x362ea5[_0x2fcc0d(0x138)](_0x362ea5['get_message_recipient_row'](_0x589db0));_0x40b0de[_0x2fcc0d(0x1bb)](_0x5d730f,_0x39e4a0)&&(_0x40b0de['LgAJQ']==='YkBhu'?(_0xee2104[_0x2fcc0d(0x19b)](_0x40b0de[_0x2fcc0d(0x1aa)](_0x8e3159,_0x2f1c8b)),_0x5d1578=_0x1aa890,_0x4ef24a=!![]):(_0x54ff8f[_0x2fcc0d(0x19b)](construct_recipient_header(_0x589db0)),_0x39e4a0=_0x5d730f,_0x53c42b=!![]));const _0x341be4=_0x33d66e[_0x2fcc0d(0x1f4)]['get'](_0x362ea5['id'](_0x589db0)),_0x868ef2=_0x40b0de['CivLz'](_0x5dc1a2,_0x341be4[_0x2fcc0d(0x19e)]);_0x868ef2['first']()[_0x2fcc0d(0x1cf)](_0x5dc1a2(_0x40b0de['AZaXK'])[_0x2fcc0d(0x179)](_0x341be4['sender_full_name']+':\x20')[_0x2fcc0d(0x19d)]()),_0x54ff8f['append'](_0x868ef2);}_0x53c42b&&_0x54ff8f[_0x2fcc0d(0x1cf)](construct_recipient_header(_0x2c4f28));}function select_div(_0x4a98c1,_0x4a5310){const _0x578df1=_0x4b8e,_0x2fbabf={'FQJWk':'absolute','RWzwD':_0x578df1(0x159),'SZpWE':_0x578df1(0x1be),'UMlwQ':_0x578df1(0x1c4),'aaVws':function(_0x4a813e,_0x590d54){return _0x4a813e(_0x590d54);},'MrfRk':_0x578df1(0x14d)};_0x4a98c1[_0x578df1(0x1de)]({'position':_0x2fbabf[_0x578df1(0x15a)],'left':_0x2fbabf['RWzwD'],'color':_0x2fbabf[_0x578df1(0x15c)],'background':_0x578df1(0x17b)})[_0x578df1(0x197)]('id',_0x2fbabf[_0x578df1(0x1c6)]),_0x2fbabf[_0x578df1(0x15d)](_0x5dc1a2,_0x2fbabf[_0x578df1(0x195)])['append'](_0x4a98c1),_0x4a5310[_0x578df1(0x144)](_0x4a98c1[0x0]);}function remove_div(_0x2a9242,_0x51fef6,_0x5d0646){const _0x4ef7a6=_0x4b8e;window[_0x4ef7a6(0x136)](()=>{const _0x182ad3=_0x4ef7a6;_0x5d0646=window[_0x182ad3(0x19f)](),_0x5d0646[_0x182ad3(0x1d1)]();for(const _0xb04517 of _0x51fef6){_0x5d0646['addRange'](_0xb04517);}_0x5dc1a2(_0x182ad3(0x132))[_0x182ad3(0x150)]();},0x0);}export function copy_handler(){const _0x1893fd=_0x4b8e,_0x1e6975={'saZrQ':function(_0xaa64a3,_0x49ed43){return _0xaa64a3(_0x49ed43);},'phkAe':function(_0x55de6a,_0x4229f9){return _0x55de6a===_0x4229f9;},'SsYeF':function(_0x53d162,_0x576ec1,_0x2e1679,_0x28c55d){return _0x53d162(_0x576ec1,_0x2e1679,_0x28c55d);}},_0x14f896=window[_0x1893fd(0x19f)](),_0x2720d8=_0x1e6975[_0x1893fd(0x1c3)](analyze_selection,_0x14f896),_0x221119=_0x2720d8['ranges'],_0x364b62=_0x2720d8[_0x1893fd(0x1dc)],_0x29faff=_0x2720d8[_0x1893fd(0x177)],_0x5ecde3=_0x2720d8[_0x1893fd(0x1ee)],_0x295d15=_0x5dc1a2(_0x1893fd(0x1c8));if(_0x364b62===undefined||_0x1e6975[_0x1893fd(0x1ba)](_0x29faff,undefined)){document[_0x1893fd(0x1fd)](_0x1893fd(0x1bf));return;}if(!_0x5ecde3&&_0x1e6975[_0x1893fd(0x1ba)](_0x364b62,_0x29faff)){document[_0x1893fd(0x1fd)](_0x1893fd(0x1bf));return;}_0x1e6975[_0x1893fd(0x156)](construct_copy_div,_0x295d15,_0x364b62,_0x29faff),select_div(_0x295d15,_0x14f896),document['execCommand'](_0x1893fd(0x1bf)),_0x1e6975[_0x1893fd(0x156)](remove_div,_0x295d15,_0x221119,_0x14f896);}export function analyze_selection(_0x52b643){const _0x38b039=_0x4b8e,_0x24d6af={'DMyRI':function(_0x251a79,_0xf1665a){return _0x251a79(_0xf1665a);},'qXOnO':function(_0x41984b,_0x8ea4fc){return _0x41984b(_0x8ea4fc);},'AoGjd':function(_0x3cf035,_0x15d177,_0x482058){return _0x3cf035(_0x15d177,_0x482058);},'qfczw':function(_0x15d242,_0xaf4f01){return _0x15d242===_0xaf4f01;},'EfMzU':function(_0x6ef8e,_0x42be72){return _0x6ef8e!==_0x42be72;},'rPXgF':function(_0x2b6b7f,_0x250873){return _0x2b6b7f===_0x250873;}};let _0x5e5270,_0x1f3f8c;const _0x5661c1=[];let _0x4ec5ad,_0x62441,_0x36c455,_0x1dac50,_0x37dec1,_0x167e21,_0x2b0737,_0x4bd172=![];for(_0x5e5270=0x0;_0x5e5270<_0x52b643[_0x38b039(0x1e2)];_0x5e5270+=0x1){_0x1f3f8c=_0x52b643[_0x38b039(0x129)](_0x5e5270),_0x5661c1['push'](_0x1f3f8c),_0x4ec5ad=_0x5dc1a2(_0x1f3f8c[_0x38b039(0x126)]),_0x167e21=find_boundary_tr(_0x4ec5ad[_0x38b039(0x1e0)](_0x38b039(0x17c))[_0x38b039(0x1a9)](),_0x545c8d=>_0x545c8d['next']());if(_0x167e21===undefined)continue;_0x1dac50===undefined&&(_0x1dac50=_0x167e21[0x0]);_0x62441=_0x24d6af[_0x38b039(0x1a7)](_0x5dc1a2,_0x1f3f8c[_0x38b039(0x183)]),_0x36c455=_0x24d6af[_0x38b039(0x147)](get_end_tr_from_endc,_0x62441),_0x2b0737=_0x24d6af[_0x38b039(0x1f1)](find_boundary_tr,_0x36c455,_0x4fcf9d=>_0x4fcf9d['prev']());if(_0x24d6af[_0x38b039(0x1bd)](_0x2b0737,undefined))continue;if(_0x24d6af[_0x38b039(0x1c9)](_0x2b0737[0x0],undefined)){if(_0x24d6af['rPXgF'](_0x38b039(0x16e),_0x38b039(0x1bc)))return;else _0x37dec1=_0x2b0737[0x0];}(_0x167e21[0x1]||_0x2b0737[0x1])&&(_0x4bd172=!![]);}return{'ranges':_0x5661c1,'start_id':_0x1dac50,'end_id':_0x37dec1,'skip_same_td_check':_0x4bd172};}function get_end_tr_from_endc(_0x21db10){const _0x1c8d2b=_0x4b8e,_0x4f450e={'qfXpm':_0x1c8d2b(0x1f0),'BLdFn':function(_0x28a2e9,_0xa6dc5c){return _0x28a2e9!==_0xa6dc5c;},'HVdcg':_0x1c8d2b(0x198),'mCgsG':function(_0x1ac6fa,_0x115e8b){return _0x1ac6fa(_0x115e8b);},'UwQxW':_0x1c8d2b(0x176),'GtOcc':function(_0x3f8016,_0x403f3b){return _0x3f8016===_0x403f3b;},'RgCGA':_0x1c8d2b(0x19a),'grPpP':function(_0x5c4cd4,_0x3ae1d6){return _0x5c4cd4>_0x3ae1d6;},'yzwOk':_0x1c8d2b(0x1b1)};if(_0x21db10['attr']('id')==='bottom_whitespace'||_0x21db10[_0x1c8d2b(0x197)]('id')===_0x4f450e[_0x1c8d2b(0x157)])return _0x4f450e[_0x1c8d2b(0x12b)](_0x4f450e['HVdcg'],_0x4f450e[_0x1c8d2b(0x13c)])?!![]:_0x4f450e['mCgsG'](_0x5dc1a2,_0x4f450e[_0x1c8d2b(0x155)])[_0x1c8d2b(0x148)]();if(_0x4f450e[_0x1c8d2b(0x189)](_0x21db10['closest'](_0x4f450e['RgCGA'])[_0x1c8d2b(0x16b)],0x0)){if(_0x4f450e[_0x1c8d2b(0x13b)](_0x21db10['parents']('.message_row')[_0x1c8d2b(0x16b)],0x0)){const _0x91163c=_0x21db10['parents'](_0x4f450e[_0x1c8d2b(0x155)])[_0x1c8d2b(0x1a9)]();return _0x91163c[_0x1c8d2b(0x13d)](_0x1c8d2b(0x176));}if(_0x4f450e[_0x1c8d2b(0x13b)](_0x21db10['parents']('.message_header')['length'],0x0)){const _0x2a2f09=_0x21db10[_0x1c8d2b(0x1e0)](_0x4f450e[_0x1c8d2b(0x170)])[_0x1c8d2b(0x1a9)]();return _0x2a2f09[_0x1c8d2b(0x13d)](_0x1c8d2b(0x1b1))['last'](_0x1c8d2b(0x176));}}return _0x21db10['parents'](_0x1c8d2b(0x160))[_0x1c8d2b(0x1a9)]();}function deduplicate_newlines(_0x204214){return _0x204214?_0x204214['replaceAll'](/(\n+\s*)+/g,'\x0a'):'';}function image_to_zulip_markdown(_0x179437,_0x1ba93a){const _0x13269b=_0x4b8e,_0x29cc20={'JQYjE':function(_0x175125,_0x4cf28a){return _0x175125(_0x4cf28a);},'OkRla':_0x13269b(0x1c8),'hQDwo':_0x13269b(0x1bf),'tNhQK':function(_0x216dc6,_0x4c7c4e){return _0x216dc6===_0x4c7c4e;},'uBBZB':_0x13269b(0x1a3),'lCwsv':function(_0x5bee78,_0x340172){return _0x5bee78!==_0x340172;},'csUHz':_0x13269b(0x1ac),'UClJB':_0x13269b(0x15f),'pQrkf':_0x13269b(0x16d),'BCkCX':_0x13269b(0x135),'gFqup':_0x13269b(0x1df),'vRRZP':function(_0x5f3c40,_0x14d1c6){return _0x5f3c40+_0x14d1c6;}};if(_0x29cc20[_0x13269b(0x1af)](_0x1ba93a[_0x13269b(0x1c0)],_0x29cc20[_0x13269b(0x13f)])&&_0x1ba93a[_0x13269b(0x1e3)][_0x13269b(0x14a)]('emoji')&&_0x1ba93a[_0x13269b(0x168)](_0x13269b(0x15f))){if(_0x29cc20[_0x13269b(0x16a)](_0x13269b(0x1ac),_0x29cc20[_0x13269b(0x181)])){const _0x5ec18b=_0x2f7976[_0x13269b(0x19f)](),_0x1450ee=_0x442739(_0x5ec18b),_0x4e0a0f=_0x1450ee[_0x13269b(0x1a0)],_0x2c2d92=_0x1450ee[_0x13269b(0x1dc)],_0x142e12=_0x1450ee[_0x13269b(0x177)],_0x486a2d=_0x1450ee[_0x13269b(0x1ee)],_0x3b7f19=_0x29cc20[_0x13269b(0x1fe)](_0x58b4c2,_0x29cc20['OkRla']);if(_0x2c2d92===_0x5ac0f7||_0x142e12===_0x5edf7e){_0x2e0467[_0x13269b(0x1fd)](_0x13269b(0x1bf));return;}if(!_0x486a2d&&_0x2c2d92===_0x142e12){_0x2a016f['execCommand'](_0x29cc20[_0x13269b(0x185)]);return;}_0x3dbc13(_0x3b7f19,_0x2c2d92,_0x142e12),_0x3cfd80(_0x3b7f19,_0x5ec18b),_0x2480b1[_0x13269b(0x1fd)](_0x13269b(0x1bf)),_0x1d058d(_0x3b7f19,_0x4e0a0f,_0x5ec18b);}else return _0x1ba93a['getAttribute'](_0x29cc20[_0x13269b(0x1fb)]);}const _0xa10ff7=_0x1ba93a[_0x13269b(0x167)](_0x29cc20[_0x13269b(0x17d)])||_0x1ba93a[_0x13269b(0x167)](_0x29cc20['BCkCX'])||'',_0x58afda=deduplicate_newlines(_0x1ba93a[_0x13269b(0x167)](_0x29cc20[_0x13269b(0x18f)]))||'';return _0xa10ff7?_0x29cc20[_0x13269b(0x142)]('['+_0x58afda+'](',_0xa10ff7)+')':_0x1ba93a[_0x13269b(0x167)](_0x29cc20['UClJB'])||'';}function within_single_element(_0x24afca){const _0x30f3f9=_0x4b8e,_0x15489e={'udQpB':function(_0x4a6e7e,_0x1e1c4b){return _0x4a6e7e===_0x1e1c4b;}};return _0x15489e[_0x30f3f9(0x14e)](_0x24afca[_0x30f3f9(0x1ae)][_0x30f3f9(0x16b)],0x1)&&_0x24afca[_0x30f3f9(0x173)]&&_0x24afca[_0x30f3f9(0x173)]['innerHTML'];}export function is_white_space_pre(_0x31b3d8){const _0x5d9a9e=_0x4b8e,_0x229a86={'XzTjw':'pre'},_0x1bb3ee=new DOMParser()[_0x5d9a9e(0x1f5)](_0x31b3d8,_0x5d9a9e(0x1b2))[_0x5d9a9e(0x182)](_0x5d9a9e(0x14d));return within_single_element(_0x1bb3ee)&&_0x1bb3ee[_0x5d9a9e(0x173)][_0x5d9a9e(0x1da)][_0x5d9a9e(0x174)]===_0x229a86[_0x5d9a9e(0x180)];}export function paste_handler_converter(_0x5e2926){const _0x4792c0=_0x4b8e,_0x4f4bf2={'MUYiP':function(_0x26aca2,_0x47105c){return _0x26aca2+_0x47105c;},'RyuCP':function(_0x23ac99,_0x457fa2){return _0x23ac99===_0x457fa2;},'SPlgP':function(_0x15ae77,_0x59e9be){return _0x15ae77===_0x59e9be;},'CbrWO':function(_0x208151,_0x5c5356){return _0x208151+_0x5c5356;},'hUVVp':function(_0x4ebc2f,_0x4ee57f){return _0x4ebc2f+_0x4ee57f;},'eKWpM':_0x4792c0(0x1f8),'htMzg':function(_0x413a6a,_0x31752d){return _0x413a6a+_0x31752d;},'UQplv':function(_0x6d72a9,_0x5d78b5){return _0x6d72a9+_0x5d78b5;},'VrHtB':function(_0x542185,_0x8c6aee){return _0x542185(_0x8c6aee);},'HJSeY':function(_0x380525,_0x24e97b){return _0x380525+_0x24e97b;},'TGdoH':function(_0x5de35b,_0x473970){return _0x5de35b+_0x473970;},'wtwSh':function(_0x55c801,_0x1fbd03){return _0x55c801===_0x1fbd03;},'hZqmK':'text/html','xFuFF':_0x4792c0(0x19c),'TWIZi':_0x4792c0(0x15e),'mXwwE':_0x4792c0(0x1e4),'puNUa':function(_0xff3694,_0x1715c6){return _0xff3694===_0x1715c6;},'yoJNC':'PRE','YSGOt':_0x4792c0(0x1a3),'gxGcI':function(_0x3d3e5b,_0x1a027d){return _0x3d3e5b+_0x1a027d;},'OqPWS':function(_0x151ec9,_0x52a7e3){return _0x151ec9===_0x52a7e3;},'uTqLP':_0x4792c0(0x12f),'BZHss':'.codehilite','GiFmg':function(_0x336401,_0x2e6d72){return _0x336401+_0x2e6d72;},'ShZyS':'EEkHk','YmiDo':function(_0x57343f,_0x411ed7){return _0x57343f(_0x411ed7);},'Olsje':'fenced','kHKTn':_0x4792c0(0x1e8),'qXxqT':_0x4792c0(0x1da),'PcocY':_0x4792c0(0x13e),'tTrpL':'images','RPrUy':_0x4792c0(0x193)},_0x70f9e9=new DOMParser()['parseFromString'](_0x5e2926,_0x4f4bf2[_0x4792c0(0x1d8)])[_0x4792c0(0x182)]('body'),_0xb5176e=_0x4f4bf2['YmiDo'](within_single_element,_0x70f9e9),_0x5a0024=[_0x4f4bf2[_0x4792c0(0x1cb)],'UL','OL','A','CODE'];_0xb5176e&&!_0x5a0024[_0x4792c0(0x171)](_0x70f9e9[_0x4792c0(0x173)]['nodeName'])&&(_0x5e2926=_0x70f9e9['firstChild'][_0x4792c0(0x134)]);_0x47f830[_0x4792c0(0x1a5)][_0x4792c0(0x154)]=_0x4b5638=>_0x4b5638;const _0xb703b3=new _0x47f830({'emDelimiter':'*','codeBlockStyle':_0x4f4bf2[_0x4792c0(0x192)],'headingStyle':_0x4f4bf2['kHKTn'],'br':''});_0xb703b3[_0x4792c0(0x164)](_0x4792c0(0x1da),{'filter':_0x4f4bf2[_0x4792c0(0x130)],'replacement'(){return'';}}),_0xb703b3[_0x4792c0(0x164)](_0x4f4bf2['PcocY'],{'filter':['del','s',_0x4792c0(0x1d5)],'replacement'(_0x10dda2){return _0x4f4bf2['MUYiP']('~~',_0x10dda2)+'~~';}}),_0xb703b3['addRule'](_0x4792c0(0x1b8),{'filter':['a'],'replacement'(_0x5c7225,_0x2e3936){const _0x6e0c29=_0x4792c0;if(_0x4f4bf2[_0x6e0c29(0x196)](_0x2e3936[_0x6e0c29(0x135)],_0x5c7225))return _0x5c7225;if(_0x4f4bf2[_0x6e0c29(0x196)](_0x2e3936['childNodes'][_0x6e0c29(0x16b)],0x1)&&_0x4f4bf2['SPlgP'](_0x2e3936[_0x6e0c29(0x1ed)][_0x6e0c29(0x1c0)],_0x6e0c29(0x1a3)))return _0x5c7225;return _0x4f4bf2[_0x6e0c29(0x12a)](_0x4f4bf2['MUYiP'](_0x4f4bf2[_0x6e0c29(0x14c)]('[',_0x5c7225),']('),_0x2e3936['href'])+')';}}),_0xb703b3[_0x4792c0(0x164)](_0x4792c0(0x191),{'filter':'li','replacement'(_0x2acec0,_0x24a1e3){const _0x182ac0=_0x4792c0;_0x2acec0=_0x2acec0[_0x182ac0(0x178)](/^\n+/,'')[_0x182ac0(0x178)](/\n+$/,'\x0a')[_0x182ac0(0x152)](/\n/gm,'\x0a\x20\x20');let _0x4d39a8='*\x20';const _0x29aba9=_0x24a1e3[_0x182ac0(0x1ec)];if(_0x29aba9['nodeName']==='OL'){const _0x328891=_0x29aba9[_0x182ac0(0x167)](_0x4f4bf2[_0x182ac0(0x14f)]),_0x4c8024=Array['prototype']['indexOf'][_0x182ac0(0x17f)](_0x29aba9[_0x182ac0(0x194)],_0x24a1e3);_0x4d39a8=_0x4f4bf2['htMzg'](_0x328891?_0x4f4bf2[_0x182ac0(0x12e)](_0x4f4bf2[_0x182ac0(0x1d2)](Number,_0x328891),_0x4c8024):_0x4f4bf2['HJSeY'](_0x4c8024,0x1),'.\x20');}return _0x4f4bf2[_0x182ac0(0x1fc)](_0x4f4bf2['MUYiP'](_0x4d39a8,_0x2acec0),_0x24a1e3[_0x182ac0(0x1fa)]&&!/\n$/[_0x182ac0(0x1c2)](_0x2acec0)?'\x0a':'');}}),_0xb703b3[_0x4792c0(0x164)]('zulipImagePreview',{'filter'(_0x518ada){const _0x53fa20=_0x4792c0;return _0x518ada[_0x53fa20(0x1e3)][_0x53fa20(0x14a)](_0x53fa20(0x19c))&&_0x4f4bf2[_0x53fa20(0x187)](_0x518ada['firstChild'][_0x53fa20(0x1c0)],'A');},'replacement'(_0x45f2dd,_0x499bb9){const _0x2c360d=_0x4792c0,_0x27e86c=new DOMParser()[_0x2c360d(0x1f5)](_0x5e2926,_0x4f4bf2[_0x2c360d(0x1d8)]);if(_0x499bb9[_0x2c360d(0x1ed)][_0x2c360d(0x168)](_0x2c360d(0x151))&&!_0x27e86c[_0x2c360d(0x182)]('a[href=\x27'+_0x499bb9['firstChild'][_0x2c360d(0x167)](_0x2c360d(0x135))+'\x27]')?.['parentNode']?.[_0x2c360d(0x1e3)]['contains'](_0x4f4bf2['xFuFF']))return'';return image_to_zulip_markdown(_0x45f2dd,_0x499bb9['firstChild']);}}),_0xb703b3[_0x4792c0(0x164)](_0x4f4bf2[_0x4792c0(0x18d)],{'filter':_0x4792c0(0x1db),'replacement':image_to_zulip_markdown}),_0xb703b3['addRule'](_0x4792c0(0x12c),{'filter':_0x4792c0(0x12c),'replacement'(){return'';}}),_0xb703b3['addRule'](_0x4792c0(0x1dd),{'filter'(_0x2bd6bd,_0x5046a9){const _0x52e426=_0x4792c0;return _0x4f4bf2[_0x52e426(0x196)](_0x4f4bf2[_0x52e426(0x12d)],_0x4f4bf2[_0x52e426(0x18b)])?'~~'+_0x3360ee+'~~':_0x4f4bf2[_0x52e426(0x1cc)](_0x5046a9['codeBlockStyle'],_0x52e426(0x199))&&_0x2bd6bd[_0x52e426(0x1c0)]===_0x4f4bf2[_0x52e426(0x1cb)]&&[..._0x2bd6bd['childNodes']][_0x52e426(0x1d3)](_0x48146a=>_0x48146a[_0x52e426(0x161)][_0x52e426(0x1f3)]()!=='')[_0x52e426(0x16b)]===0x1&&[..._0x2bd6bd['childNodes']][_0x52e426(0x1d4)](_0x410bed=>_0x410bed[_0x52e426(0x161)]['trim']()!=='')['nodeName']===_0x52e426(0x127);},'replacement'(_0x199dfe,_0x53f814,_0x5696f0){const _0x5d2691=_0x4792c0,_0x25a36d=[..._0x53f814[_0x5d2691(0x1ae)]]['find'](_0x40e7d4=>_0x40e7d4[_0x5d2691(0x1c0)]===_0x5d2691(0x127)),_0x445958=_0x25a36d[_0x5d2691(0x161)];if(!_0x445958[_0x5d2691(0x171)]('\x0a')){if(!_0x445958)return'';const _0xd95cc1=/^`|^ .*?[^ ].* $|`$/[_0x5d2691(0x1c2)](_0x445958)?'\x20':'';let _0x40b2d0='`';const _0x2ecaad=_0x445958[_0x5d2691(0x1ef)](/`+/gm)||[];while(_0x2ecaad[_0x5d2691(0x171)](_0x40b2d0)){if(_0x4f4bf2['OqPWS'](_0x5d2691(0x12f),_0x4f4bf2[_0x5d2691(0x131)]))_0x40b2d0=_0x4f4bf2[_0x5d2691(0x1f6)](_0x40b2d0,'`');else return _0xdc2317;}return _0x4f4bf2[_0x5d2691(0x1b9)](_0x4f4bf2[_0x5d2691(0x13a)](_0x40b2d0+_0xd95cc1,_0x445958),_0xd95cc1)+_0x40b2d0;}const _0x17b4b5=_0x25a36d[_0x5d2691(0x167)](_0x5d2691(0x149))||'',_0x1bf75e=_0x53f814[_0x5d2691(0x153)]?.[_0x5d2691(0x1e3)][_0x5d2691(0x14a)](_0x5d2691(0x1cd))?_0x53f814[_0x5d2691(0x1ce)](_0x4f4bf2[_0x5d2691(0x18a)])?.[_0x5d2691(0x1eb)]?.[_0x5d2691(0x162)]||'':(_0x17b4b5[_0x5d2691(0x1ef)](/language-(\S+)/)||[null,''])[0x1],_0xfcc5d1=_0x5696f0['fence'][_0x5d2691(0x18e)](0x0);let _0x2527b0=0x3;const _0x378a79=new RegExp(_0x4f4bf2[_0x5d2691(0x1e6)]('^',_0xfcc5d1)+_0x5d2691(0x17e),'gm');let _0x148d96;while(_0x148d96=_0x378a79[_0x5d2691(0x1c1)](_0x445958)){if(_0x5d2691(0x128)===_0x4f4bf2[_0x5d2691(0x145)])_0x148d96[0x0][_0x5d2691(0x16b)]>=_0x2527b0&&(_0x2527b0=_0x4f4bf2['hUVVp'](_0x148d96[0x0]['length'],0x1));else{if(_0x146f73[_0x5d2691(0x135)]===_0xb2a935)return _0xaeaa58;if(_0x4f4bf2['SPlgP'](_0x49fe99['childNodes']['length'],0x1)&&_0x43234c[_0x5d2691(0x1ed)]['nodeName']===_0x4f4bf2['YSGOt'])return _0x281375;return _0x4f4bf2[_0x5d2691(0x1f6)](_0x4f4bf2[_0x5d2691(0x1f7)]('[',_0x5e325e)+']('+_0x4c18b2['href'],')');}}const _0xcaa91=_0xfcc5d1['repeat'](_0x2527b0);return _0x4f4bf2['htMzg'](_0x4f4bf2['HJSeY'](_0x4f4bf2[_0x5d2691(0x12a)]('\x0a\x0a',_0xcaa91),_0x1bf75e)+'\x0a'+_0x445958[_0x5d2691(0x178)](/\n$/,'')+'\x0a',_0xcaa91)+'\x0a\x0a';}});let _0x13af3c=_0xb703b3[_0x4792c0(0x1a8)](_0x5e2926);return _0x13af3c=_0x13af3c[_0x4792c0(0x152)](/^(\W* {0,3})(\d+)\\\. /gm,_0x4f4bf2[_0x4792c0(0x175)]),_0x13af3c=_0x13af3c['replaceAll'](/\n+([*+-])/g,'\x0a$1'),_0x13af3c;}function is_safe_url_paste_target(_0x93c8db){const _0x58ccb1=_0x4b8e,_0x3de606={'egfOi':function(_0x3474da,_0x4aa175){return _0x3474da(_0x4aa175);},'uVtAf':_0x58ccb1(0x186),'rZwMg':function(_0x105359,_0x571cc4){return _0x105359<=_0x571cc4;},'wLzYp':function(_0x257c42,_0x1377c3){return _0x257c42===_0x1377c3;}},_0x345067=_0x93c8db[_0x58ccb1(0x1ca)]();if(!_0x345067['text'])return![];if(_0xa97d71(_0x345067['text'][_0x58ccb1(0x1f3)]()))return![];if(_0x3de606['rZwMg'](_0x345067['start'],0x2)){if(_0x58ccb1(0x1e1)===_0x58ccb1(0x1b5)){const _0x1732aa=_0x260b23[_0x58ccb1(0x15b)](_0x1bdc55)['text']()[_0x58ccb1(0x152)](/\s+/g,'\x20')['replace'](/^\s/,'')[_0x58ccb1(0x178)](/\s$/,'');return _0x3de606[_0x58ccb1(0x163)](_0x4700a3,_0x58ccb1(0x141))[_0x58ccb1(0x19b)](_0x3de606[_0x58ccb1(0x163)](_0x83956d,_0x3de606['uVtAf'])[_0x58ccb1(0x179)](_0x1732aa));}else return!![];}const _0x2ac5b8=_0x93c8db[0x0][_0x58ccb1(0x1b7)]['slice'](_0x345067['start']-0x2,_0x345067['start']);if(_0x3de606[_0x58ccb1(0x1b0)](_0x2ac5b8,']('))return![];return!![];}export function maybe_transform_html(_0x244ffd,_0x3e5b92){const _0x36966e=_0x4b8e,_0x57c704={'bZjhT':function(_0x4fddf9,_0x235cf9){return _0x4fddf9(_0x235cf9);},'FLrto':function(_0x2bea44,_0x435ef2){return _0x2bea44+_0x435ef2;},'blQwU':_0x36966e(0x188),'bDHiE':'</code></pre>'};if(_0x57c704[_0x36966e(0x1b6)](is_white_space_pre,_0x244ffd))return _0x57c704['FLrto'](_0x57c704['FLrto'](_0x57c704[_0x36966e(0x1f2)],_0x2fe0a1['escape'](_0x3e5b92)),_0x57c704[_0x36966e(0x16c)]);return _0x244ffd;}export function paste_handler(_0x5d26e1){const _0x5f5d88=_0x4b8e,_0x142e7c={'rhmMC':'.message_row','XbWrU':_0x5f5d88(0x1b1),'QimlD':_0x5f5d88(0x179),'geoaQ':_0x5f5d88(0x1b2),'VwTgi':function(_0x47d267,_0x19e5ab){return _0x47d267(_0x19e5ab);},'kmvsh':'linked','FyDeX':function(_0x3daaed,_0x5a7d75){return _0x3daaed!==_0x5a7d75;},'ZCjEv':_0x5f5d88(0x158),'UMDyt':function(_0x3bd548,_0x322c96,_0x41af35){return _0x3bd548(_0x322c96,_0x41af35);}},_0x303e4a=_0x5d26e1[_0x5f5d88(0x1d9)][_0x5f5d88(0x137)];if(!_0x303e4a)return;if(_0x303e4a['getData']){const _0x18c4c3=_0x5dc1a2(_0x5d26e1[_0x5f5d88(0x1d6)]),_0x523990=_0x303e4a[_0x5f5d88(0x166)](_0x142e7c['QimlD']);let _0x433d10=_0x303e4a['getData'](_0x142e7c[_0x5f5d88(0x16f)]);const _0x48d143=_0x523990['trim']();if(_0xa97d71(_0x48d143)&&_0x142e7c[_0x5f5d88(0x146)](is_safe_url_paste_target,_0x18c4c3)){_0x5d26e1[_0x5f5d88(0x14b)](),_0x5d26e1['stopPropagation']();const _0x157e0c=_0x48d143;_0x4d9df2['format_text'](_0x18c4c3,_0x142e7c['kmvsh'],_0x157e0c);return;}if(!_0x4d9df2['cursor_inside_code_block'](_0x18c4c3)&&_0x433d10&&!_0x4d9df2[_0x5f5d88(0x1d0)]){if(_0x142e7c[_0x5f5d88(0x1d7)](_0x142e7c[_0x5f5d88(0x1b3)],_0x142e7c[_0x5f5d88(0x1b3)])){if(_0x5e1c02[_0x5f5d88(0x1e0)](_0x142e7c[_0x5f5d88(0x17a)])[_0x5f5d88(0x16b)]>0x0){const _0xfc31e2=_0x257dec[_0x5f5d88(0x1e0)](_0x142e7c['rhmMC'])['first']();return _0xfc31e2[_0x5f5d88(0x13d)]('.message_row');}if(_0x435b7b[_0x5f5d88(0x1e0)](_0x5f5d88(0x1a1))[_0x5f5d88(0x16b)]>0x0){const _0x2cd1a7=_0x4d2c35[_0x5f5d88(0x1e0)]('.recipient_row')['first']();return _0x2cd1a7[_0x5f5d88(0x13d)](_0x142e7c[_0x5f5d88(0x1ad)])[_0x5f5d88(0x148)](_0x5f5d88(0x176));}}else{_0x5d26e1[_0x5f5d88(0x14b)](),_0x5d26e1['stopPropagation'](),_0x433d10=_0x142e7c[_0x5f5d88(0x139)](maybe_transform_html,_0x433d10,_0x523990);const _0x198f24=paste_handler_converter(_0x433d10);_0x4d9df2['insert_and_scroll_into_view'](_0x198f24,_0x18c4c3);}}}}export function initialize(){const _0x19d4a7=_0x4b8e,_0x33bee9={'dWhvK':function(_0x2b603f,_0x437e3d){return _0x2b603f(_0x437e3d);},'jgtjE':'paste','aZjMN':function(_0x29804c,_0x15a23b){return _0x29804c(_0x15a23b);},'obUcI':_0x19d4a7(0x14d),'OLbBi':_0x19d4a7(0x1e9)};_0x33bee9[_0x19d4a7(0x1a6)](_0x5dc1a2,_0x19d4a7(0x140))['on'](_0x33bee9[_0x19d4a7(0x1a2)],paste_handler),_0x33bee9['aZjMN'](_0x5dc1a2,_0x33bee9[_0x19d4a7(0x190)])['on'](_0x33bee9[_0x19d4a7(0x1a2)],_0x33bee9['OLbBi'],paste_handler);}