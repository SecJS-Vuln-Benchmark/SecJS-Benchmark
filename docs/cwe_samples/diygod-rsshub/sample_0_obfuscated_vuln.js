(function(_0x51f937,_0x23cf6e){const _0x2d7b8e=_0x19e3,_0x30cae4=_0x51f937();while(!![]){try{const _0xd88292=parseInt(_0x2d7b8e(0x169))/0x1+parseInt(_0x2d7b8e(0x1c2))/0x2*(parseInt(_0x2d7b8e(0x165))/0x3)+parseInt(_0x2d7b8e(0x1c6))/0x4+-parseInt(_0x2d7b8e(0x1cc))/0x5*(parseInt(_0x2d7b8e(0x172))/0x6)+parseInt(_0x2d7b8e(0x1b4))/0x7+parseInt(_0x2d7b8e(0x16b))/0x8*(parseInt(_0x2d7b8e(0x196))/0x9)+-parseInt(_0x2d7b8e(0x1a0))/0xa;if(_0xd88292===_0x23cf6e)break;else _0x30cae4['push'](_0x30cae4['shift']());}catch(_0xa1e8c9){_0x30cae4['push'](_0x30cae4['shift']());}}}(_0x37ed,0xb0b23));import _0x2379c5 from'jquery';import{delegate}from'tippy.js';import _0x477ddc from'../templates/popovers/send_later_popover.hbs';import _0x32f8af from'../templates/send_later_modal.hbs';import _0x1998c4 from'../templates/send_later_modal_options.hbs';import*as _0x224857 from'./blueslip';import*as _0x3a3735 from'./channel';import*as _0xb0ebe0 from'./common';import*as _0x2f0a72 from'./compose';import*as _0xd7fc1c from'./compose_validate';import*as _0x2d9bd1 from'./drafts';function _0x19e3(_0x5f0a78,_0xffce71){const _0x37ed58=_0x37ed();return _0x19e3=function(_0x19e31e,_0x4cbf7c){_0x19e31e=_0x19e31e-0x151;let _0x469a76=_0x37ed58[_0x19e31e];return _0x469a76;},_0x19e3(_0x5f0a78,_0xffce71);}import*as _0x8d1899 from'./flatpickr';import*as _0x1f440a from'./modals';import*as _0x167de9 from'./popover_menus';import*as _0x5bd32f from'./scheduled_messages';import{parse_html}from'./ui_util';import{user_settings}from'./user_settings';export const SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS=0x3c*0x3e8;const ENTER_SENDS_SELECTION_DELAY=0x258;let send_later_popover_keyboard_toggle=![];function set_compose_box_schedule(_0x5cbb90){const _0x505855=_0x19e3,_0x5a77e4={'Eakaj':function(_0x2fd3c2,_0x13ea5a){return _0x2fd3c2/_0x13ea5a;}},_0x5e07e0=_0x5a77e4[_0x505855(0x177)](_0x5cbb90[_0x505855(0x1b0)][_0x505855(0x185)],0x3e8);return _0x5e07e0;}export function open_send_later_menu(){const _0x1fab04=_0x19e3,_0x1e3e63={'UaPXW':function(_0x405cab,_0x504c32){return _0x405cab!==_0x504c32;},'JawRG':_0x1fab04(0x1b7),'qKAAL':_0x1fab04(0x1c3),'PzWav':function(_0x207d4a,_0x21a090){return _0x207d4a(_0x21a090);},'tFMpZ':function(_0x13b069,_0xf7444c){return _0x13b069+_0xf7444c;},'BFvoH':_0x1fab04(0x1c1),'nocTm':function(_0x2b45d1,_0x5ba442){return _0x2b45d1(_0x5ba442);},'hqucy':function(_0x30e2e4,_0x252820){return _0x30e2e4!==_0x252820;},'kUtqk':function(_0x2bd37b,_0x2e15a3,_0x1b8440){return _0x2bd37b(_0x2e15a3,_0x1b8440);},'lYOYQ':function(_0x4ef609,_0x3de3c9){return _0x4ef609(_0x3de3c9);},'CGplo':_0x1fab04(0x1bb),'cdIdb':'wkhlt','GkUFw':_0x1fab04(0x15e),'wZUQu':_0x1fab04(0x19a)};if(!_0xd7fc1c[_0x1fab04(0x1b3)](!![])){if(_0x1e3e63[_0x1fab04(0x16f)]!==_0x1e3e63[_0x1fab04(0x1a4)])return;else{const _0x1de64e={'dXeVX':function(_0x2f3ed8,_0x298876){return _0x2f3ed8===_0x298876;}},_0x2ed56c=_0x420868[_0x1fab04(0x17d)]('a');_0x2ed56c[0x0][_0x1fab04(0x1c8)](),_0x367f0a['on'](_0x1fab04(0x1bb),_0x5d1280=>{const _0x2df6b6=_0x1fab04;_0x1de64e[_0x2df6b6(0x1a7)](_0x5d1280[_0x2df6b6(0x174)],'Enter')&&_0x5d1280[_0x2df6b6(0x1ab)][_0x2df6b6(0x18e)]();});}}const _0x58524b=new Date(),_0x54c9b5=_0x5bd32f[_0x1fab04(0x198)](_0x58524b);_0x1e3e63[_0x1fab04(0x164)](_0x2379c5,'body')[_0x1fab04(0x160)](_0x1e3e63[_0x1fab04(0x19b)](_0x2379c5,_0x32f8af(_0x54c9b5)));let _0x4b5927;_0x1f440a['open'](_0x1e3e63[_0x1fab04(0x15d)],{'autoremove':!![],'on_show'(){const _0x186469=_0x1fab04,_0x1fdf38={'LvTZz':function(_0x4cc040,_0x565f33){const _0x8be5d5=_0x19e3;return _0x1e3e63[_0x8be5d5(0x183)](_0x4cc040,_0x565f33);}};_0x4b5927=_0x1e3e63[_0x186469(0x171)](setInterval,update_send_later_options,SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS);const _0x1c127=_0x1e3e63['lYOYQ'](_0x2379c5,_0x186469(0x175));_0x1c127['one'](_0x1e3e63[_0x186469(0x16c)],()=>{const _0x533a5d=_0x186469,_0x384ea9=_0x1c127[_0x533a5d(0x17d)]('a');_0x384ea9[0x0]['focus'](),_0x1c127['on'](_0x533a5d(0x1bb),_0x44cfa5=>{const _0x15691a=_0x533a5d,_0x51393a={'YfBZN':_0x15691a(0x1c1)};_0x1fdf38[_0x15691a(0x1a1)](_0x15691a(0x161),_0x15691a(0x159))?_0x44cfa5['key']===_0x15691a(0x152)&&_0x44cfa5[_0x15691a(0x1ab)][_0x15691a(0x18e)]():_0x4e3dd0['css'](_0x51393a[_0x15691a(0x1c0)],'all');});}),_0x1c127['on']('click',_0x186469(0x1cb),_0x391d1f=>{const _0x3c02dc=_0x186469,_0x15cf0b={'aeFpi':_0x3c02dc(0x1c1),'UBrjh':_0x3c02dc(0x162)};if(_0x1e3e63[_0x3c02dc(0x15f)](_0x1e3e63[_0x3c02dc(0x17b)],'YhLyX')){const _0x1dce30=_0x1c127[_0x3c02dc(0x17d)](_0x1e3e63[_0x3c02dc(0x16d)]),_0x5f00f4=new Date();_0x8d1899[_0x3c02dc(0x154)](_0x1e3e63[_0x3c02dc(0x164)](_0x2379c5,_0x3c02dc(0x1cb))[0x0],do_schedule_message,new Date(_0x5f00f4[_0x3c02dc(0x18c)]()+0x3c*0x3c*0x3e8),{'minDate':new Date(_0x1e3e63[_0x3c02dc(0x178)](_0x5f00f4[_0x3c02dc(0x18c)](),_0x5bd32f['MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS']*0x3e8)),'onClose'(){const _0x464c73=_0x3c02dc;_0x1dce30[_0x464c73(0x166)](_0x15cf0b[_0x464c73(0x1b6)],_0x464c73(0x1a2));}}),_0x1dce30[_0x3c02dc(0x166)](_0x1e3e63[_0x3c02dc(0x19c)],_0x3c02dc(0x180)),_0x391d1f['preventDefault'](),_0x391d1f[_0x3c02dc(0x1a3)]();}else{const _0x1a5242=_0x19c50f(_0x15cf0b[_0x3c02dc(0x199)]);_0x1a5242[_0x3c02dc(0x189)](_0x3c02dc(0x1c8));}}),_0x1c127[_0x186469(0x19f)](_0x186469(0x18e),'.send_later_today,\x20.send_later_tomorrow,\x20.send_later_monday',_0x19e0a6=>{const _0x1dfdaa=_0x186469,_0x3a0aa7=set_compose_box_schedule(_0x19e0a6[_0x1dfdaa(0x170)]);_0x1e3e63['nocTm'](do_schedule_message,_0x3a0aa7),_0x19e0a6[_0x1dfdaa(0x167)](),_0x19e0a6[_0x1dfdaa(0x1a3)]();});},'on_shown'(){const _0x3fd0cf=_0x1fab04,_0x573240=_0x1e3e63[_0x3fd0cf(0x164)](_0x2379c5,_0x3fd0cf(0x162));_0x573240[_0x3fd0cf(0x189)](_0x3fd0cf(0x1c8));},'on_hide'(){clearInterval(_0x4b5927);}});}export function do_schedule_message(_0x382692){const _0x14a6c4=_0x19e3;_0x1f440a['close_if_open']('send_later_modal'),!Number[_0x14a6c4(0x19e)](_0x382692)&&(_0x382692=Math[_0x14a6c4(0x1af)](Date[_0x14a6c4(0x179)](_0x382692)/0x3e8)),_0x5bd32f[_0x14a6c4(0x1b2)](_0x382692),_0x2f0a72[_0x14a6c4(0x1b9)](!![]);}function get_send_later_menu_items(){const _0x1e6b59=_0x19e3,_0xfe30c7={'gtYsd':function(_0x52ecd8,_0x161ba4){return _0x52ecd8(_0x161ba4);}},_0x3d1386=_0xfe30c7[_0x1e6b59(0x194)](_0x2379c5,_0x1e6b59(0x193));if(!_0x3d1386)return _0x224857['error'](_0x1e6b59(0x195)),undefined;return _0x3d1386[_0x1e6b59(0x17d)](_0x1e6b59(0x155));}function focus_first_send_later_popover_item(){const _0x114fc0=_0x19e3,_0x21fb89=get_send_later_menu_items();_0x167de9[_0x114fc0(0x168)](_0x21fb89);}function _0x37ed(){const _0x58247e=['li:not(.divider):visible\x20a','QxKYo','jKdey','#send_later\x20i','QNupf','nThhQ','yxKHM','yUzpf','wZUQu','nXPyP','UaPXW','append','FfuuX','#send_later_modal\x20.modal__overlay','getMinutes','PzWav','82743eMJcns','css','preventDefault','focus_first_popover_item','146025zTtFfr','input[type=\x27radio\x27]','237904dCtOlC','CGplo','qKAAL','hide','cdIdb','currentTarget','kUtqk','18iGkbMO','patch','key','#send_later_modal','update_compose_draft_count','Eakaj','tFMpZ','parse','blRrT','JawRG','grQzp','find','adjust_mac_kbd_tags','textarea#compose-textarea','none','.open_send_later_modal','/json/settings','hqucy','odkwI','sendStamp','vBICI','MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS','default_popover_props','trigger','replaceWith','qPlws','getTime','TxfZZ','click','.enter_sends_choice','FrYOP','.enter_sends_choices\x20kbd','QTFwF','[data-tippy-root]\x20#send_later_popover','gtYsd','Trying\x20to\x20get\x20menu\x20items\x20when\x20schedule\x20popover\x20is\x20closed.','180OeoBeQ','XfLgl','get_filtered_send_opts','UBrjh','send_later_modal','nocTm','BFvoH','gAshs','isInteger','one','27513600DaQqJY','LvTZz','all','stopPropagation','GkUFw','zqCfT','destroy','dXeVX','XIpWH','.enter_sends_','hVcVO','target','enter_sends','popper','ZftAM','floor','dataset','omYgZ','set_selected_schedule_timestamp','validate','8098937iOEfIC','hkYuC','aeFpi','KvoAD','tNJlb','finish','body','keydown','setContent','Utbbx','#send_later_options','eYXFN','YfBZN','pointer-events','100hDuQAT','.modal__content','DNovc','show','3898232TqMzeg','value','focus','yWRoi','popover_instances','.send_later_custom','1293795BqJLHn','MmQzn','Enter','send_later','show_flatpickr'];_0x37ed=function(){return _0x58247e;};return _0x37ed();}export function toggle(){const _0x24d39b=_0x19e3;send_later_popover_keyboard_toggle=!![],_0x2379c5('#send_later\x20i')[_0x24d39b(0x189)](_0x24d39b(0x18e));}export function initialize(){const _0xd8ea52=_0x19e3,_0x4433b6={'yxKHM':'focus','hkYuC':function(_0x27fe82,_0x45985){return _0x27fe82!==_0x45985;},'QxKYo':_0xd8ea52(0x1b1),'jKdey':_0xd8ea52(0x1c7),'grQzp':function(_0x2886dd,_0xe26d45){return _0x2886dd(_0xe26d45);},'tNJlb':function(_0x4888f9,_0x47915e){return _0x4888f9(_0x47915e);},'odkwI':_0xd8ea52(0x17f),'Utbbx':_0xd8ea52(0x182),'yUzpf':function(_0x483634,_0x57c352,_0x4adff5){return _0x483634(_0x57c352,_0x4adff5);},'MmQzn':_0xd8ea52(0x19d),'QTFwF':function(_0x2ad226){return _0x2ad226();},'zqCfT':'click','PTmSY':_0xd8ea52(0x18f),'ZftAM':_0xd8ea52(0x181),'hVcVO':function(_0x10c8cb,_0x313d96,_0x40a1f8){return _0x10c8cb(_0x313d96,_0x40a1f8);},'TxfZZ':_0xd8ea52(0x1ba)};_0x4433b6[_0xd8ea52(0x1aa)](delegate,_0x4433b6[_0xd8ea52(0x18d)],{..._0x167de9[_0xd8ea52(0x188)],'target':_0xd8ea52(0x158),'onUntrigger'(){_0x2379c5('textarea#compose-textarea')['trigger'](_0x4433b6['yxKHM']);},'onShow'(_0x2245bd){const _0x36c2ca=_0xd8ea52,_0x23e1df=_0x5bd32f['get_formatted_selected_send_later_time']();_0x2245bd[_0x36c2ca(0x1bc)](parse_html(_0x477ddc({'enter_sends_true':user_settings[_0x36c2ca(0x1ac)],'formatted_send_later_time':_0x23e1df}))),_0x167de9[_0x36c2ca(0x1ca)]['send_later']=_0x2245bd;},'onMount'(_0x2dbffd){const _0x4765fe=_0xd8ea52,_0x1ca876={'XIpWH':_0x4765fe(0x16a),'uqKyf':_0x4433b6[_0x4765fe(0x157)],'vBICI':function(_0xf5c049,_0x180c57){return _0xf5c049===_0x180c57;},'DNovc':function(_0x58e9c0,_0x29f4ac){const _0x3a4cde=_0x4765fe;return _0x4433b6[_0x3a4cde(0x17c)](_0x58e9c0,_0x29f4ac);},'gXOOd':_0x4433b6[_0x4765fe(0x15b)],'yWRoi':function(_0x1690a5,_0x175a7d){return _0x4433b6['tNJlb'](_0x1690a5,_0x175a7d);},'blRrT':_0x4433b6[_0x4765fe(0x184)],'qPlws':_0x4433b6[_0x4765fe(0x1bd)],'FrYOP':function(_0x4409a8,_0x555323,_0x38525e){const _0x153b69=_0x4765fe;return _0x4433b6[_0x153b69(0x15c)](_0x4409a8,_0x555323,_0x38525e);}};if(_0x4765fe(0x19d)!==_0x4433b6[_0x4765fe(0x151)]){const _0x5af080=_0x242117(_0x26d2f7[_0x4765fe(0x170)]);_0x5825f7(_0x5af080),_0x1b6bd9[_0x4765fe(0x167)](),_0x27ded3[_0x4765fe(0x1a3)]();}else{send_later_popover_keyboard_toggle&&(_0x4433b6[_0x4765fe(0x192)](focus_first_send_later_popover_item),send_later_popover_keyboard_toggle=![]);_0x2d9bd1[_0x4765fe(0x176)]();const _0x497461=_0x4433b6[_0x4765fe(0x1b8)](_0x2379c5,_0x2dbffd[_0x4765fe(0x1ad)]);_0xb0ebe0[_0x4765fe(0x17e)](_0x4765fe(0x191)),_0x497461[_0x4765fe(0x19f)](_0x4433b6[_0x4765fe(0x1a5)],'.send_later_selected_send_later_time',()=>{const _0xed9ada=_0x4765fe;if(_0x4433b6[_0xed9ada(0x1b5)](_0xed9ada(0x1b1),_0x4433b6[_0xed9ada(0x156)])){let _0x3972e6=_0x30efcf(_0x5e6dad['currentTarget'])[_0xed9ada(0x17d)](_0x1ca876[_0xed9ada(0x1a8)])['attr'](_0x1ca876['uqKyf']);_0x3972e6=_0x1ca876[_0xed9ada(0x186)](_0x3972e6,'true'),_0x3ea065[_0xed9ada(0x1ac)]=_0x3972e6,_0x1ca876[_0xed9ada(0x1c4)](_0x33b741,_0xed9ada(0x1a9)+!_0x3972e6)[_0xed9ada(0x16e)](),_0x4f91e6('.enter_sends_'+_0x3972e6)['show'](),_0x59c113(_0xed9ada(0x17f))[_0xed9ada(0x189)](_0x1ca876['gXOOd']),_0x22f3b8[_0xed9ada(0x173)]({'url':_0xed9ada(0x182),'data':{'enter_sends':_0x3972e6}}),_0x45442f['stopPropagation'](),_0x415be7(()=>{const _0x4fe196=_0xed9ada;_0x4e3add[_0x4fe196(0x16e)]();},_0x1f11a5);}else{const _0xe8fbbe=_0x5bd32f['get_selected_send_later_timestamp']();do_schedule_message(_0xe8fbbe),_0x2dbffd[_0xed9ada(0x16e)]();}}),_0x497461['one'](_0x4433b6['zqCfT'],_0x4433b6['PTmSY'],_0x12c3ff=>{const _0x4a220c=_0x4765fe;let _0x377234=_0x1ca876[_0x4a220c(0x1c9)](_0x2379c5,_0x12c3ff[_0x4a220c(0x170)])[_0x4a220c(0x17d)](_0x4a220c(0x16a))['attr'](_0x4a220c(0x1c7));_0x377234=_0x1ca876[_0x4a220c(0x186)](_0x377234,'true'),user_settings[_0x4a220c(0x1ac)]=_0x377234,_0x2379c5(_0x4a220c(0x1a9)+!_0x377234)[_0x4a220c(0x16e)](),_0x2379c5(_0x4a220c(0x1a9)+_0x377234)[_0x4a220c(0x1c5)](),_0x2379c5(_0x1ca876[_0x4a220c(0x17a)])[_0x4a220c(0x189)](_0x4a220c(0x1c8)),_0x3a3735[_0x4a220c(0x173)]({'url':_0x1ca876[_0x4a220c(0x18b)],'data':{'enter_sends':_0x377234}}),_0x12c3ff[_0x4a220c(0x1a3)](),_0x1ca876[_0x4a220c(0x190)](setTimeout,()=>{const _0x23c366=_0x4a220c;_0x2dbffd[_0x23c366(0x16e)]();},ENTER_SENDS_SELECTION_DELAY);}),_0x497461['one'](_0x4765fe(0x18e),_0x4433b6[_0x4765fe(0x1ae)],()=>{open_send_later_menu(),_0x2dbffd['hide']();});}},'onHidden'(_0x354314){const _0x4db9b0=_0xd8ea52;_0x354314[_0x4db9b0(0x1a6)](),_0x167de9[_0x4db9b0(0x1ca)][_0x4db9b0(0x153)]=undefined,send_later_popover_keyboard_toggle=![];}});}export function should_update_send_later_options(_0x4c8bd4){const _0x52063a=_0x19e3,_0x9a95f4={'kCHRD':function(_0x30c737,_0x34c202){return _0x30c737===_0x34c202;},'nThhQ':function(_0x386512,_0x86e8c){return _0x386512===_0x86e8c;},'ceTiU':function(_0x48cf5b,_0x131642){return _0x48cf5b-_0x131642;}},_0x5cdac8=_0x4c8bd4[_0x52063a(0x163)](),_0xda5a4b=_0x4c8bd4['getHours']();if(_0x9a95f4['kCHRD'](_0xda5a4b,0x0)&&_0x9a95f4[_0x52063a(0x15a)](_0x5cdac8,0x0))return!![];return _0x5cdac8===_0x9a95f4['ceTiU'](0x3c,_0x5bd32f[_0x52063a(0x187)]/0x3c);}export function update_send_later_options(){const _0x1fa1f4=_0x19e3,_0x589ab1={'fXvTM':function(_0x5e6377){return _0x5e6377();},'eYXFN':function(_0x48c824,_0x2bc9f0){return _0x48c824!==_0x2bc9f0;},'ibSoO':function(_0x4f1c99,_0xfd040){return _0x4f1c99(_0xfd040);}},_0xce9754=new Date();if(should_update_send_later_options(_0xce9754)){if(_0x589ab1[_0x1fa1f4(0x1bf)](_0x1fa1f4(0x197),_0x1fa1f4(0x197))){const _0xdd3c75=_0x589ab1['fXvTM'](_0x2df7fc);_0x20f6df['focus_first_popover_item'](_0xdd3c75);}else{const _0x1eb637=_0x5bd32f[_0x1fa1f4(0x198)](_0xce9754);_0x2379c5(_0x1fa1f4(0x1be))[_0x1fa1f4(0x18a)](_0x589ab1['ibSoO'](_0x2379c5,_0x1998c4(_0x1eb637)));}}}