(function(_0x553268,_0x46437f){const _0x2d994a=_0x2cc1,_0x9a6558=_0x553268();while(!![]){try{const _0x1b8b65=-parseInt(_0x2d994a(0x1e3))/0x1*(-parseInt(_0x2d994a(0x1b1))/0x2)+-parseInt(_0x2d994a(0x1fc))/0x3+-parseInt(_0x2d994a(0x1d0))/0x4*(-parseInt(_0x2d994a(0x1b0))/0x5)+parseInt(_0x2d994a(0x1bb))/0x6+-parseInt(_0x2d994a(0x1f3))/0x7+parseInt(_0x2d994a(0x210))/0x8+-parseInt(_0x2d994a(0x208))/0x9*(parseInt(_0x2d994a(0x201))/0xa);if(_0x1b8b65===_0x46437f)break;else _0x9a6558['push'](_0x9a6558['shift']());}catch(_0x528401){_0x9a6558['push'](_0x9a6558['shift']());}}}(_0x4aeb,0x6f725));import _0x3cea42 from'clipboard';import _0x25545c from'jquery';import _0x2657c5 from'minimalistic-assert';import _0x2ed071 from'../templates/popovers/actions_popover.hbs';import*as _0x1655a6 from'./blueslip';import*as _0x1cdf15 from'./compose_reply';import*as _0x2a5895 from'./condense';import{show_copied_confirmation}from'./copied_tooltip';import*as _0x5b958e from'./emoji_picker';import*as _0x3cecd9 from'./message_edit';import*as _0x140bbd from'./message_lists';import*as _0x1e7eea from'./message_viewport';import*as _0x556230 from'./popover_menus';import*as _0x364669 from'./popover_menus_data';import*as _0x26fde1 from'./popovers';import*as _0x20801d from'./read_receipts';import*as _0x36427c from'./rows';import*as _0x556546 from'./stream_popover';import{parse_html}from'./ui_util';import*as _0x3bfd72 from'./unread_ops';function _0x2cc1(_0x1e0a0f,_0x197b4c){const _0x4aebb7=_0x4aeb();return _0x2cc1=function(_0x2cc17e,_0xf8526c){_0x2cc17e=_0x2cc17e-0x1ad;let _0xaf9b50=_0x4aebb7[_0x2cc17e];return _0xaf9b50;},_0x2cc1(_0x1e0a0f,_0x197b4c);}let message_actions_popover_keyboard_toggle=![];function get_action_menu_menu_items(){const _0x31395c=_0x2cc1,_0x2307b0={'tpNPg':'li:not(.divider):visible\x20a'},_0x5a70ff=_0x25545c('[data-tippy-root]\x20.actions_popover');if(!_0x5a70ff)return _0x1655a6[_0x31395c(0x214)](_0x31395c(0x211)),undefined;return _0x5a70ff[_0x31395c(0x21d)](_0x2307b0[_0x31395c(0x1da)]);}function focus_first_action_popover_item(){const _0x14ad41=_0x2cc1,_0x7ff4a3={'veEqx':function(_0x107e4e){return _0x107e4e();}},_0x4c44ea=_0x7ff4a3['veEqx'](get_action_menu_menu_items);_0x556230[_0x14ad41(0x1b5)](_0x4c44ea);}function _0x4aeb(){const _0xd29eb4=['4PMNLut','eEKUs','removeClass','.message_row','get_row','ZKEZa','build_move_topic_to_stream_popover','CLNrO','WwNBU','any_active','tpNPg','LVCzI','RCcpS','GBJrZ','hide_current_popover_if_visible','hide_all','tLqvh','setContent','BROse','172sDhezd','closest','collapse','.popover_toggle_collapse',':focus','RBALz','KtXGl','destroy','hide_revealed_message','is_message_actions_popover_displayed','view','currentTarget','get_message_selection','UvsgT','IsTGo','.actions_hover\x20.message-actions-menu-button','4658654NevABX','vZuOU','.message_controls','zDBlq','quote_and_reply','locally_echoed','wsENb','.mark_as_unread','delete_message','1036980kUQnZk','register_popover_menu','HgjyU','.rehide_muted_user_message','stopPropagation','505580LPNohQ','trigger','data','fqaYe','start','is_editing','top','45nYYYVR','VSnMI','.respond_button','GKRYI','success','get','UUsGc','Buhjx','6030640gZxWwn','Trying\x20to\x20get\x20menu\x20items\x20when\x20action\x20popover\x20is\x20closed.','UTyaY','Pyaai','error','Azxbo','toggle_emoji_popover','cekIo','message_containers','LSEDy','obQaf','maybe_scroll_to_show_message_top','xQThF','find','get_actions_popover_content_context','message_actions','bottom','show_user_list','current','pRQFA','61895SIOkJJ','644tHGaEf','is_hidden','fpQVP','has_actions_popover','focus_first_popover_item','preventDefault','CwfIP','mcjIJ','click','min(max(320px,\x20100vw),\x20350px)','5393184RYIZTd','message-id','reference','popover_instances','cHsQf','parentElement','uncollapse','addClass','CODbG','one','popper','collapsed','MPTyC','blur','pZlOq','selection_within_message_id','.view_read_receipts','ugyKR','popover\x20respond','SQJHQ','.popover_edit_message,\x20.popover_view_source'];_0x4aeb=function(){return _0xd29eb4;};return _0x4aeb();}export function toggle_message_actions_menu(_0x2976f1){const _0x52bd78=_0x2cc1,_0x22d881={'eEKUs':_0x52bd78(0x1b9)};if(_0x556230[_0x52bd78(0x1ec)]())return _0x26fde1['hide_all'](),!![];if(_0x2976f1[_0x52bd78(0x1f8)]||_0x3cecd9[_0x52bd78(0x206)](_0x2976f1['id']))return!![];_0x26fde1[_0x52bd78(0x1d9)]()&&_0x26fde1[_0x52bd78(0x1df)]();_0x1e7eea[_0x52bd78(0x21b)]();const _0x540be6=_0x25545c('.selected_message\x20.actions_hover\x20.message-actions-menu-button');return message_actions_popover_keyboard_toggle=!![],_0x540be6[_0x52bd78(0x202)](_0x22d881[_0x52bd78(0x1d1)]),!![];}export function initialize(){const _0x23a23e=_0x2cc1,_0x31a00f={'UTyaY':function(_0x18f5e8,_0x301bea){return _0x18f5e8(_0x301bea);},'BROse':_0x23a23e(0x1d3),'LVCzI':_0x23a23e(0x1b4),'cHsQf':'bottom','Buhjx':function(_0x2ea4ad,_0x4a9096){return _0x2ea4ad===_0x4a9096;},'zDBlq':_0x23a23e(0x1f0),'HgjyU':_0x23a23e(0x1bc),'WwNBU':_0x23a23e(0x1f5),'SQJHQ':function(_0x4bd544,_0xaa2e21){return _0x4bd544!==_0xaa2e21;},'IsTGo':function(_0x434fc9,_0x3d4c4c){return _0x434fc9(_0x3d4c4c);},'KtXGl':_0x23a23e(0x1b8),'xepKr':_0x23a23e(0x213),'ugyKR':_0x23a23e(0x1b9),'cekIo':_0x23a23e(0x20a),'CwfIP':_0x23a23e(0x1cf),'xQThF':'.popover_move_message','UUsGc':_0x23a23e(0x1fa),'ZKEZa':_0x23a23e(0x1ff),'RCcpS':'.delete_message','fqaYe':'.reaction_button','QruDp':'.copy_link','pRQFA':_0x23a23e(0x20c),'VSnMI':_0x23a23e(0x1f2),'vZuOU':_0x23a23e(0x1ba),'wsENb':'flip'};_0x556230[_0x23a23e(0x1fd)](_0x31a00f[_0x23a23e(0x209)],{'maxWidth':_0x31a00f[_0x23a23e(0x1f4)],'placement':_0x31a00f[_0x23a23e(0x1bf)],'popperOptions':{'modifiers':[{'name':_0x31a00f[_0x23a23e(0x1f9)],'options':{'fallbackPlacements':[_0x23a23e(0x207),'left']}}]},'onShow'(_0x569322){const _0x17fb10=_0x23a23e;_0x556230['on_show_prep'](_0x569322);const _0x159ef2=_0x31a00f['UTyaY'](_0x25545c,_0x569322['reference'])['closest'](_0x31a00f[_0x17fb10(0x1e2)]),_0x5bbce6=_0x36427c['id'](_0x159ef2),_0x5cacc1=_0x364669[_0x17fb10(0x21e)](_0x5bbce6);_0x569322[_0x17fb10(0x1e1)](_0x31a00f[_0x17fb10(0x212)](parse_html,_0x31a00f[_0x17fb10(0x212)](_0x2ed071,_0x5cacc1))),_0x159ef2[_0x17fb10(0x1c2)](_0x31a00f[_0x17fb10(0x1db)]);},'onMount'(_0x79d072){const _0xa10734=_0x23a23e,_0x3789e5={'GKRYI':_0xa10734(0x1d3),'fpQVP':_0xa10734(0x1b4),'obQaf':function(_0x36e8bb,_0x3d8fa1){return _0x36e8bb===_0x3d8fa1;},'tLqvh':'CbZGo','Azxbo':'message-id','pZlOq':function(_0x153cf6,_0x5b5a70){const _0x6da57a=_0xa10734;return _0x31a00f[_0x6da57a(0x1ce)](_0x153cf6,_0x5b5a70);},'RBALz':function(_0xf1e804,_0x549650){return _0x31a00f['UTyaY'](_0xf1e804,_0x549650);},'LSEDy':function(_0x2585cf,_0x2cfa5c){const _0x589074=_0xa10734;return _0x31a00f[_0x589074(0x1f1)](_0x2585cf,_0x2cfa5c);},'CLNrO':_0x31a00f[_0xa10734(0x1e9)],'GBJrZ':function(_0x417121,_0x320fbb){return _0x417121(_0x320fbb);},'CODbG':function(_0x31f015,_0x25f665){return _0x31f015!==_0x25f665;}},_0x493c24=_0x25545c(_0x79d072['reference'])[_0xa10734(0x1e4)](_0xa10734(0x1d3)),_0x1df6b7=_0x36427c['id'](_0x493c24);let _0x3212f6;_0x1cdf15[_0xa10734(0x1ca)]()===_0x1df6b7&&(_0x3212f6=_0x1cdf15[_0xa10734(0x1ef)]());if(message_actions_popover_keyboard_toggle){if(_0x31a00f['xepKr']===_0xa10734(0x1c7)){const _0x57fbfd=_0x474491(_0x527ecf[_0xa10734(0x1ee)])[_0xa10734(0x203)](_0xa10734(0x1bc));_0x94069a[_0xa10734(0x200)](),_0x2ced77['preventDefault'](),_0x40056a[_0xa10734(0x216)](_0x1c5c20['reference'][_0xa10734(0x1c0)],_0x57fbfd,{'placement':_0x31a00f[_0xa10734(0x1bf)]}),_0x516f1d['hide_current_popover_if_visible'](_0xf8c1d6);}else focus_first_action_popover_item(),message_actions_popover_keyboard_toggle=![];}_0x556230[_0xa10734(0x1be)]['message_actions']=_0x79d072;const _0x517095=_0x25545c(_0x79d072[_0xa10734(0x1c5)]);_0x517095[_0xa10734(0x1c4)](_0x31a00f[_0xa10734(0x1cc)],_0x31a00f[_0xa10734(0x217)],_0x2689d0=>{const _0xcad78e=_0xa10734;_0x1cdf15[_0xcad78e(0x1f7)]({'trigger':_0xcad78e(0x1cd),'message_id':_0x1df6b7,'quote_content':_0x3212f6}),_0x2689d0[_0xcad78e(0x1b6)](),_0x2689d0[_0xcad78e(0x200)](),_0x556230[_0xcad78e(0x1de)](_0x79d072);}),_0x517095['one'](_0x31a00f[_0xa10734(0x1cc)],_0x31a00f[_0xa10734(0x1b7)],_0x215b11=>{const _0x4cbca=_0xa10734;if(_0x3789e5[_0x4cbca(0x21a)](_0x3789e5[_0x4cbca(0x1e0)],_0x3789e5[_0x4cbca(0x1e0)])){const _0x1aca4e=_0x25545c(_0x215b11[_0x4cbca(0x1ee)])[_0x4cbca(0x203)](_0x3789e5[_0x4cbca(0x215)]);_0x2657c5(_0x3789e5[_0x4cbca(0x1c9)](_0x140bbd[_0x4cbca(0x1ae)],undefined));const _0x1bed59=_0x140bbd[_0x4cbca(0x1ae)][_0x4cbca(0x1d4)](_0x1aca4e);_0x3cecd9[_0x4cbca(0x205)](_0x1bed59),_0x215b11[_0x4cbca(0x1b6)](),_0x215b11[_0x4cbca(0x200)](),_0x556230[_0x4cbca(0x1de)](_0x79d072);}else{const _0x5e9871=_0xe4bc14(_0x120ed6[_0x4cbca(0x1bd)])['closest'](_0x3789e5[_0x4cbca(0x20b)]);_0x5e9871[_0x4cbca(0x1d2)](_0x3789e5[_0x4cbca(0x1b3)]),_0x16c783['destroy'](),_0x5665e7[_0x4cbca(0x1be)][_0x4cbca(0x21f)]=_0x22fe77,_0x115888=![];}}),_0x517095['one'](_0xa10734(0x1b9),_0x31a00f[_0xa10734(0x21c)],_0x2912a3=>{const _0x14a866=_0xa10734,_0x316cd7=_0x3789e5['RBALz'](_0x25545c,_0x2912a3[_0x14a866(0x1ee)])[_0x14a866(0x203)](_0x3789e5[_0x14a866(0x215)]);_0x3789e5[_0x14a866(0x1e8)](_0x2657c5,_0x140bbd[_0x14a866(0x1ae)]!==undefined),_0x140bbd[_0x14a866(0x1ae)]['select_id'](_0x316cd7);const _0x57b021=_0x140bbd['current'][_0x14a866(0x20d)](_0x316cd7);_0x556546[_0x14a866(0x1d6)](_0x57b021['stream_id'],_0x57b021['topic'],![],_0x57b021),_0x2912a3[_0x14a866(0x1b6)](),_0x2912a3['stopPropagation'](),_0x556230['hide_current_popover_if_visible'](_0x79d072);}),_0x517095[_0xa10734(0x1c4)](_0x31a00f['ugyKR'],_0x31a00f[_0xa10734(0x20e)],_0x3fcdaa=>{const _0x370313=_0xa10734,_0x36de17=_0x25545c(_0x3fcdaa['currentTarget'])['data']('message-id');_0x3bfd72['mark_as_unread_from_here'](_0x36de17),_0x3fcdaa['preventDefault'](),_0x3fcdaa[_0x370313(0x200)](),_0x556230[_0x370313(0x1de)](_0x79d072);}),_0x517095[_0xa10734(0x1c4)](_0x31a00f[_0xa10734(0x1cc)],_0xa10734(0x1e6),_0x42c683=>{const _0x24d20e=_0xa10734,_0x38764b=_0x3789e5['RBALz'](_0x25545c,_0x42c683[_0x24d20e(0x1ee)])[_0x24d20e(0x203)](_0x24d20e(0x1bc));_0x2657c5(_0x140bbd[_0x24d20e(0x1ae)]!==undefined);const _0x1e4990=_0x140bbd['current'][_0x24d20e(0x20d)](_0x38764b);_0x3789e5['LSEDy'](_0x2657c5,_0x3789e5['pZlOq'](_0x1e4990,undefined)),_0x1e4990[_0x24d20e(0x1c6)]?_0x2a5895[_0x24d20e(0x1c1)](_0x1e4990):_0x2a5895[_0x24d20e(0x1e5)](_0x1e4990),_0x42c683[_0x24d20e(0x1b6)](),_0x42c683[_0x24d20e(0x200)](),_0x556230['hide_current_popover_if_visible'](_0x79d072);}),_0x517095[_0xa10734(0x1c4)](_0xa10734(0x1b9),_0x31a00f[_0xa10734(0x1d5)],_0x1e3c31=>{const _0x154382=_0xa10734;if(_0x3789e5[_0x154382(0x1c9)](_0x3789e5[_0x154382(0x1d7)],_0x3789e5[_0x154382(0x1d7)])){const _0x941150=_0x251c98(_0x546766[_0x154382(0x1ee)])[_0x154382(0x203)](_0x154382(0x1bc));_0x4c2599(_0x23b9af[_0x154382(0x1ae)]!==_0x1b8004);const _0x16cc42=_0xa25ffb[_0x154382(0x1ae)][_0x154382(0x1d4)](_0x941150);_0x4009d3['start'](_0x16cc42),_0x1c70b4['preventDefault'](),_0x1fdb32[_0x154382(0x200)](),_0x556744[_0x154382(0x1de)](_0x24c3ea);}else{const _0x5c1c30=_0x3789e5[_0x154382(0x219)](_0x25545c,_0x1e3c31['currentTarget'])[_0x154382(0x203)](_0x3789e5['Azxbo']);_0x3789e5[_0x154382(0x1dd)](_0x2657c5,_0x3789e5[_0x154382(0x1c3)](_0x140bbd[_0x154382(0x1ae)],undefined));const _0x588682=_0x140bbd['current']['get_row'](_0x5c1c30),_0x4abb32=_0x140bbd[_0x154382(0x1ae)]['get'](_0x36427c['id'](_0x588682)),_0xa73bb3=_0x140bbd[_0x154382(0x1ae)][_0x154382(0x1ed)][_0x154382(0x218)][_0x154382(0x20d)](_0x4abb32['id']);_0x588682&&!_0xa73bb3[_0x154382(0x1b2)]&&_0x140bbd[_0x154382(0x1ae)][_0x154382(0x1ed)][_0x154382(0x1eb)](_0x5c1c30),_0x1e3c31[_0x154382(0x1b6)](),_0x1e3c31[_0x154382(0x200)](),_0x556230[_0x154382(0x1de)](_0x79d072);}}),_0x517095[_0xa10734(0x1c4)](_0xa10734(0x1b9),_0xa10734(0x1cb),_0x501a24=>{const _0x158a57=_0xa10734,_0x3ce8a9=_0x25545c(_0x501a24[_0x158a57(0x1ee)])[_0x158a57(0x203)](_0x158a57(0x1bc));_0x20801d[_0x158a57(0x1ad)](_0x3ce8a9),_0x501a24[_0x158a57(0x1b6)](),_0x501a24[_0x158a57(0x200)](),_0x556230[_0x158a57(0x1de)](_0x79d072);}),_0x517095[_0xa10734(0x1c4)](_0x31a00f['ugyKR'],_0x31a00f[_0xa10734(0x1dc)],_0x4eb97d=>{const _0x286102=_0xa10734;if(_0x31a00f[_0x286102(0x20f)]('UvsgT',_0x31a00f[_0x286102(0x1f6)])){const _0x46d446=_0x25545c(_0x4eb97d[_0x286102(0x1ee)])[_0x286102(0x203)](_0x31a00f[_0x286102(0x1fe)]);_0x3cecd9[_0x286102(0x1fb)](_0x46d446),_0x4eb97d[_0x286102(0x1b6)](),_0x4eb97d[_0x286102(0x200)](),_0x556230['hide_current_popover_if_visible'](_0x79d072);}else _0x7af835['collapse'](_0x434844);}),_0x517095[_0xa10734(0x1c4)](_0xa10734(0x1b9),_0x31a00f[_0xa10734(0x204)],_0x580b0f=>{const _0x35554b=_0xa10734,_0xd808c6=_0x25545c(_0x580b0f[_0x35554b(0x1ee)])[_0x35554b(0x203)]('message-id');_0x580b0f[_0x35554b(0x200)](),_0x580b0f[_0x35554b(0x1b6)](),_0x5b958e[_0x35554b(0x216)](_0x79d072[_0x35554b(0x1bd)][_0x35554b(0x1c0)],_0xd808c6,{'placement':_0x35554b(0x220)}),_0x556230['hide_current_popover_if_visible'](_0x79d072);}),new _0x3cea42(_0x517095[_0xa10734(0x21d)](_0x31a00f['QruDp'])[0x0])['on'](_0x31a00f[_0xa10734(0x1af)],()=>{const _0x4809d2=_0xa10734;_0x31a00f[_0x4809d2(0x212)](show_copied_confirmation,_0x25545c(_0x79d072['reference'])['closest'](_0x31a00f[_0x4809d2(0x1d8)])[0x0]),setTimeout(()=>{const _0x15ea4c=_0x4809d2;_0x25545c(_0x15ea4c(0x1e7))['trigger'](_0x15ea4c(0x1c8));},0x0),_0x556230[_0x4809d2(0x1de)](_0x79d072);});},'onHidden'(_0xf2fee3){const _0x385642=_0x23a23e,_0x38c737=_0x25545c(_0xf2fee3[_0x385642(0x1bd)])[_0x385642(0x1e4)]('.message_row');_0x38c737[_0x385642(0x1d2)](_0x31a00f[_0x385642(0x1db)]),_0xf2fee3[_0x385642(0x1ea)](),_0x556230[_0x385642(0x1be)][_0x385642(0x21f)]=undefined,message_actions_popover_keyboard_toggle=![];}});}