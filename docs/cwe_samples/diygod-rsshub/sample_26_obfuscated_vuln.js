(function(_0x3dc8c9,_0xb15482){const _0x29ba25=_0x3a0c,_0x383f82=_0x3dc8c9();while(!![]){try{const _0x39b790=-parseInt(_0x29ba25(0x20d))/0x1+parseInt(_0x29ba25(0x230))/0x2+parseInt(_0x29ba25(0x243))/0x3+parseInt(_0x29ba25(0x218))/0x4+-parseInt(_0x29ba25(0x1fc))/0x5*(-parseInt(_0x29ba25(0x23f))/0x6)+-parseInt(_0x29ba25(0x22b))/0x7*(parseInt(_0x29ba25(0x22c))/0x8)+parseInt(_0x29ba25(0x219))/0x9*(parseInt(_0x29ba25(0x233))/0xa);if(_0x39b790===_0xb15482)break;else _0x383f82['push'](_0x383f82['shift']());}catch(_0xc52e75){_0x383f82['push'](_0x383f82['shift']());}}}(_0x311a,0x9819a));import _0x364373 from'jquery';import{delegate}from'tippy.js';import _0x354cd1 from'../templates/popovers/send_later_popover.hbs';import _0x9f613d from'../templates/send_later_modal.hbs';import _0x320f11 from'../templates/send_later_modal_options.hbs';import*as _0x5789aa from'./blueslip';import*as _0x43c9ec from'./channel';import*as _0x5932e9 from'./common';import*as _0x1f5257 from'./compose';import*as _0x54d087 from'./compose_validate';function _0x3a0c(_0x5e4c6c,_0x43101b){const _0x311aee=_0x311a();return _0x3a0c=function(_0x3a0c03,_0xc52757){_0x3a0c03=_0x3a0c03-0x1f4;let _0x1780fe=_0x311aee[_0x3a0c03];return _0x1780fe;},_0x3a0c(_0x5e4c6c,_0x43101b);}import*as _0x214ff8 from'./drafts';import*as _0x364a1a from'./flatpickr';import*as _0x5c6693 from'./modals';import*as _0x3a513c from'./popover_menus';import*as _0x4299a3 from'./scheduled_messages';import{parse_html}from'./ui_util';import{user_settings}from'./user_settings';export const SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS=0x3c*0x3e8;const ENTER_SENDS_SELECTION_DELAY=0x258;let send_later_popover_keyboard_toggle=![];function set_compose_box_schedule(_0x10c7a1){const _0x127a77=_0x3a0c,_0x4f009f=_0x10c7a1[_0x127a77(0x22a)][_0x127a77(0x24e)]/0x3e8;return _0x4f009f;}export function open_send_later_menu(){const _0x561a04=_0x3a0c,_0x4860bc={'gLsmd':'all','SZUYe':function(_0xcdd21e,_0x30e6ce){return _0xcdd21e(_0x30e6ce);},'cMquj':_0x561a04(0x224),'FIKHu':function(_0x1154bc,_0x569647){return _0x1154bc*_0x569647;},'yYklD':function(_0x516fe4,_0x2a636b){return _0x516fe4*_0x2a636b;},'hrCAp':_0x561a04(0x25b),'HvKYU':function(_0x2399cf,_0x204e83){return _0x2399cf(_0x204e83);},'Iffuc':function(_0x38785d,_0x2252a9,_0x4bbb8f){return _0x38785d(_0x2252a9,_0x4bbb8f);},'SGSaw':'#send_later_modal','JNwzA':_0x561a04(0x254),'DkZhA':_0x561a04(0x263),'LZRkv':_0x561a04(0x261),'vZmdw':function(_0x262b3f,_0x1b1958){return _0x262b3f(_0x1b1958);},'cvJtF':_0x561a04(0x23d)};if(!_0x54d087['validate'](!![]))return;const _0x1be5d2=new Date(),_0x2d12c8=_0x4299a3[_0x561a04(0x1f9)](_0x1be5d2);_0x364373(_0x561a04(0x20b))[_0x561a04(0x216)](_0x364373(_0x4860bc['vZmdw'](_0x9f613d,_0x2d12c8)));let _0x6bd633;_0x5c6693['open'](_0x4860bc['cvJtF'],{'autoremove':!![],'on_show'(){const _0x3c06a2=_0x561a04;_0x6bd633=_0x4860bc[_0x3c06a2(0x229)](setInterval,update_send_later_options,SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS);const _0x52ba4f=_0x364373(_0x4860bc[_0x3c06a2(0x258)]);_0x52ba4f[_0x3c06a2(0x21a)]('keydown',()=>{const _0x1e9e7b=_0x3c06a2,_0x4861e8=_0x52ba4f[_0x1e9e7b(0x20f)]('a');_0x4861e8[0x0]['focus'](),_0x52ba4f['on'](_0x1e9e7b(0x20a),_0x43ee24=>{const _0x2170f5=_0x1e9e7b;_0x43ee24[_0x2170f5(0x1fe)]===_0x2170f5(0x244)&&_0x43ee24['target'][_0x2170f5(0x254)]();});}),_0x52ba4f['on']('click',_0x4860bc[_0x3c06a2(0x250)],_0x19ae4c=>{const _0x4aaf7b=_0x3c06a2,_0x366470={'TOpnu':'pointer-events','gjBAn':_0x4860bc[_0x4aaf7b(0x202)]},_0x2da435=_0x52ba4f['find'](_0x4aaf7b(0x217)),_0x1e1287=new Date();_0x364a1a[_0x4aaf7b(0x238)](_0x4860bc[_0x4aaf7b(0x251)](_0x364373,_0x4860bc[_0x4aaf7b(0x250)])[0x0],do_schedule_message,new Date(_0x1e1287[_0x4aaf7b(0x212)]()+_0x4860bc[_0x4aaf7b(0x21d)](0x3c,0x3c)*0x3e8),{'minDate':new Date(_0x1e1287[_0x4aaf7b(0x212)]()+_0x4860bc[_0x4aaf7b(0x237)](_0x4299a3[_0x4aaf7b(0x234)],0x3e8)),'onClose'(){const _0x2af53d=_0x4aaf7b;_0x2da435[_0x2af53d(0x208)](_0x366470[_0x2af53d(0x211)],_0x366470[_0x2af53d(0x226)]);}}),_0x2da435[_0x4aaf7b(0x208)](_0x4860bc[_0x4aaf7b(0x1f4)],_0x4aaf7b(0x24c)),_0x19ae4c[_0x4aaf7b(0x22e)](),_0x19ae4c[_0x4aaf7b(0x21e)]();}),_0x52ba4f[_0x3c06a2(0x21a)](_0x4860bc[_0x3c06a2(0x24d)],_0x4860bc[_0x3c06a2(0x21c)],_0x11b48e=>{const _0x534dd5=_0x3c06a2,_0x5d649e=set_compose_box_schedule(_0x11b48e[_0x534dd5(0x1fa)]);_0x4860bc['HvKYU'](do_schedule_message,_0x5d649e),_0x11b48e['preventDefault'](),_0x11b48e[_0x534dd5(0x21e)]();});},'on_shown'(){const _0x1a83c6=_0x561a04,_0x37aca1=_0x364373(_0x4860bc['LZRkv']);_0x37aca1[_0x1a83c6(0x22f)](_0x1a83c6(0x20e));},'on_hide'(){const _0x32c962=_0x561a04;_0x4860bc[_0x32c962(0x251)](clearInterval,_0x6bd633);}});}export function do_schedule_message(_0x463a2b){const _0x5a18f5=_0x3a0c,_0x2edeec={'yzErJ':'send_later_modal'};_0x5c6693['close_if_open'](_0x2edeec[_0x5a18f5(0x206)]),!Number['isInteger'](_0x463a2b)&&(_0x463a2b=Math[_0x5a18f5(0x201)](Date[_0x5a18f5(0x228)](_0x463a2b)/0x3e8)),_0x4299a3[_0x5a18f5(0x262)](_0x463a2b),_0x1f5257['finish'](!![]);}function get_send_later_menu_items(){const _0x4546f6=_0x3a0c,_0x4edf15={'uRgwr':function(_0x2240e8,_0x15a304){return _0x2240e8(_0x15a304);},'hmTeZ':_0x4546f6(0x23a)},_0x23db91=_0x4edf15['uRgwr'](_0x364373,_0x4edf15[_0x4546f6(0x245)]);if(!_0x23db91)return _0x5789aa[_0x4546f6(0x236)](_0x4546f6(0x25a)),undefined;return _0x23db91[_0x4546f6(0x20f)]('li:not(.divider):visible\x20a');}function focus_first_send_later_popover_item(){const _0x43f197=_0x3a0c,_0x48c679=get_send_later_menu_items();_0x3a513c[_0x43f197(0x240)](_0x48c679);}export function toggle(){const _0x551e10=_0x3a0c;send_later_popover_keyboard_toggle=!![],_0x364373('#send_later\x20i')[_0x551e10(0x22f)](_0x551e10(0x254));}function _0x311a(){const _0xe6b318=['.modal__content','2386380iIAGqe','63tfwvlh','one','get_selected_send_later_timestamp','DkZhA','FIKHu','stopPropagation','gwPed','AnpdW','hbrxS','default_popover_props','XGlgo','.send_later_custom','textarea#compose-textarea','gjBAn','send_later','parse','Iffuc','dataset','14JePrDL','2509832vAuOuu','rnIFc','preventDefault','trigger','869112sKlVQD','.enter_sends_choice','.open_send_later_modal','306080UMiNhH','MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS','true','error','yYklD','show_flatpickr','Wnmie','[data-tippy-root]\x20#send_later_popover','sokzr','EceGO','send_later_modal','hKErn','1307670ndYImy','focus_first_popover_item','hocnI','show','586881maiSHL','Enter','hmTeZ','IKMwX','KgTYm','SSdUy','.enter_sends_choices\x20kbd','#send_later_options','popover_instances','none','JNwzA','sendStamp','hide_current_popover_if_visible','cMquj','SZUYe','enter_sends','getMinutes','click','attr','VHVjJ','sJcTE','SGSaw','vIYVx','Trying\x20to\x20get\x20menu\x20items\x20when\x20schedule\x20popover\x20is\x20closed.','pointer-events','#send_later\x20i','target','HGxCv','bKIQr','keKTP','#send_later_modal\x20.modal__overlay','set_selected_schedule_timestamp','.send_later_today,\x20.send_later_tomorrow,\x20.send_later_monday','ZOvSF','replaceWith','hrCAp','ClZXe','ONTCP','KNMxC','tGVWC','get_filtered_send_opts','currentTarget','value','10ecFpQC','adjust_mac_kbd_tags','key','destroy','update_compose_draft_count','floor','gLsmd','vIcNa','patch','get_formatted_selected_send_later_time','yzErJ','YSvMi','css','rxiNF','keydown','body','WzHsY','626464xPCdxh','focus','find','hfbnG','TOpnu','getTime','mWxqw','getHours','GbYqC','append'];_0x311a=function(){return _0xe6b318;};return _0x311a();}export function initialize(){const _0x556d68=_0x3a0c,_0x1ee2f8={'EceGO':function(_0xd4268b,_0x18a367){return _0xd4268b===_0x18a367;},'KgTYm':_0x556d68(0x244),'rnIFc':function(_0x24b1d2,_0x1e859b){return _0x24b1d2!==_0x1e859b;},'qffVb':'vGTWU','AnpdW':_0x556d68(0x20e),'hfbnG':function(_0x4cadb3,_0x1fda90){return _0x4cadb3(_0x1fda90);},'hocnI':function(_0x6c58a3,_0x17cb04){return _0x6c58a3(_0x17cb04);},'hbrxS':function(_0x16190e,_0x52f672){return _0x16190e===_0x52f672;},'vIcNa':_0x556d68(0x246),'mWxqw':_0x556d68(0x235),'SSdUy':function(_0x419a02,_0x1454d4){return _0x419a02(_0x1454d4);},'sTngG':'textarea#compose-textarea','JtGHT':'/json/settings','ClZXe':function(_0x5bdc06,_0x9c4360,_0x3c9b6a){return _0x5bdc06(_0x9c4360,_0x3c9b6a);},'WzHsY':function(_0x38dc89){return _0x38dc89();},'rxiNF':_0x556d68(0x254),'GbYqC':'.send_later_selected_send_later_time','Svvzs':_0x556d68(0x232),'hKErn':'body'};_0x1ee2f8[_0x556d68(0x1f5)](delegate,_0x1ee2f8[_0x556d68(0x23e)],{..._0x3a513c[_0x556d68(0x222)],'target':_0x556d68(0x25c),'onUntrigger'(){const _0x34055b=_0x556d68;if(_0x1ee2f8[_0x34055b(0x22d)](_0x34055b(0x23b),_0x1ee2f8['qffVb']))_0x364373(_0x34055b(0x225))[_0x34055b(0x22f)](_0x1ee2f8[_0x34055b(0x220)]);else{const _0x53ac0b={'sJcTE':function(_0x24a247,_0x4e3eec){const _0xd20f30=_0x34055b;return _0x1ee2f8[_0xd20f30(0x23c)](_0x24a247,_0x4e3eec);},'OdVQj':_0x1ee2f8[_0x34055b(0x247)]},_0x17e12a=_0x46195e['find']('a');_0x17e12a[0x0][_0x34055b(0x20e)](),_0x272d97['on'](_0x34055b(0x20a),_0x40c742=>{const _0x51b83f=_0x34055b;_0x53ac0b[_0x51b83f(0x257)](_0x40c742[_0x51b83f(0x1fe)],_0x53ac0b['OdVQj'])&&_0x40c742[_0x51b83f(0x25d)][_0x51b83f(0x254)]();});}},'onShow'(_0x2360b0){const _0xe18998=_0x556d68,_0x1d7d63=_0x4299a3[_0xe18998(0x205)]();_0x2360b0['setContent'](_0x1ee2f8[_0xe18998(0x210)](parse_html,_0x1ee2f8['hocnI'](_0x354cd1,{'enter_sends_true':user_settings[_0xe18998(0x252)],'formatted_send_later_time':_0x1d7d63}))),_0x3a513c[_0xe18998(0x24b)]['send_later']=_0x2360b0;},'onMount'(_0x4edf8b){const _0x5bc71d=_0x556d68,_0x2f987c={'HGxCv':function(_0x590bbb,_0x1319d1){return _0x590bbb===_0x1319d1;},'DEheR':function(_0x26fd59,_0x2be896){return _0x26fd59-_0x2be896;}};send_later_popover_keyboard_toggle&&(_0x1ee2f8[_0x5bc71d(0x20c)](focus_first_send_later_popover_item),send_later_popover_keyboard_toggle=![]);_0x214ff8[_0x5bc71d(0x200)]();const _0x5914e9=_0x364373(_0x4edf8b['popper']);_0x5932e9[_0x5bc71d(0x1fd)](_0x5bc71d(0x249)),_0x5914e9[_0x5bc71d(0x21a)](_0x1ee2f8[_0x5bc71d(0x209)],_0x1ee2f8[_0x5bc71d(0x215)],()=>{const _0x1aea93=_0x5bc71d,_0x31549d=_0x4299a3[_0x1aea93(0x21b)]();_0x1ee2f8[_0x1aea93(0x210)](do_schedule_message,_0x31549d),_0x3a513c[_0x1aea93(0x24f)](_0x4edf8b);}),_0x5914e9[_0x5bc71d(0x21a)](_0x5bc71d(0x254),_0x5bc71d(0x231),_0x1a0a21=>{const _0x51a92a=_0x5bc71d,_0x3d48fb={'YSvMi':function(_0x3d11a2){return _0x3d11a2();},'ONTCP':function(_0x2e2182,_0x24a176){return _0x2e2182!==_0x24a176;}};if(_0x1ee2f8[_0x51a92a(0x221)](_0x51a92a(0x246),_0x1ee2f8[_0x51a92a(0x203)])){let _0x8967dc=_0x1ee2f8[_0x51a92a(0x241)](_0x364373,_0x1a0a21['currentTarget'])[_0x51a92a(0x20f)]('input[type=\x27radio\x27]')[_0x51a92a(0x255)](_0x51a92a(0x1fb));_0x8967dc=_0x8967dc===_0x1ee2f8[_0x51a92a(0x213)],user_settings[_0x51a92a(0x252)]=_0x8967dc,_0x1ee2f8[_0x51a92a(0x241)](_0x364373,'.enter_sends_'+!_0x8967dc)['hide'](),_0x1ee2f8[_0x51a92a(0x248)](_0x364373,'.enter_sends_'+_0x8967dc)[_0x51a92a(0x242)](),_0x364373(_0x1ee2f8['sTngG'])[_0x51a92a(0x22f)](_0x51a92a(0x20e)),_0x43c9ec[_0x51a92a(0x204)]({'url':_0x1ee2f8['JtGHT'],'data':{'enter_sends':_0x8967dc}}),_0x1a0a21[_0x51a92a(0x21e)](),_0x1ee2f8[_0x51a92a(0x1f5)](setTimeout,()=>{const _0x4a1186=_0x51a92a,_0x40346a={'Wnmie':function(_0x5eafa3){const _0x1a5f2b=_0x3a0c;return _0x3d48fb[_0x1a5f2b(0x207)](_0x5eafa3);}};_0x3d48fb[_0x4a1186(0x1f6)](_0x4a1186(0x25f),_0x4a1186(0x21f))?_0x3a513c[_0x4a1186(0x24f)](_0x4edf8b):(_0x40346a[_0x4a1186(0x239)](_0x4a031c),_0x2e344b[_0x4a1186(0x24f)](_0x2ab586));},ENTER_SENDS_SELECTION_DELAY);}else{const _0x2aea8f=_0x84fee6[_0x51a92a(0x253)](),_0xfc671d=_0x20ffff[_0x51a92a(0x214)]();if(_0x2f987c[_0x51a92a(0x25e)](_0xfc671d,0x0)&&_0x2f987c[_0x51a92a(0x25e)](_0x2aea8f,0x0))return!![];return _0x2aea8f===_0x2f987c['DEheR'](0x3c,_0x393e14[_0x51a92a(0x234)]/0x3c);}}),_0x5914e9[_0x5bc71d(0x21a)](_0x1ee2f8[_0x5bc71d(0x209)],_0x1ee2f8['Svvzs'],()=>{const _0x21c56d=_0x5bc71d;open_send_later_menu(),_0x3a513c[_0x21c56d(0x24f)](_0x4edf8b);});},'onHidden'(_0x137b0e){const _0x41da74=_0x556d68;_0x41da74(0x256)===_0x41da74(0x256)?(_0x137b0e[_0x41da74(0x1ff)](),_0x3a513c[_0x41da74(0x24b)][_0x41da74(0x227)]=undefined,send_later_popover_keyboard_toggle=![]):_0x34aa8a(_0x41da74(0x225))[_0x41da74(0x22f)](_0x1ee2f8['AnpdW']);}});}export function should_update_send_later_options(_0x22e594){const _0x2859ce=_0x3a0c,_0x270926={'qvbcz':function(_0x4ea02d,_0x4abf1a){return _0x4ea02d(_0x4abf1a);},'vIYVx':function(_0x12ca45,_0x17e84c){return _0x12ca45===_0x17e84c;},'tGVWC':function(_0x5cf908,_0x1d3150){return _0x5cf908/_0x1d3150;}},_0x23af81=_0x22e594[_0x2859ce(0x253)](),_0x7acbd4=_0x22e594['getHours']();if(_0x270926[_0x2859ce(0x259)](_0x7acbd4,0x0)&&_0x23af81===0x0){if(_0x2859ce(0x223)===_0x2859ce(0x223))return!![];else{const _0x2dcfec=_0x270926['qvbcz'](_0x43d12a,_0x2859ce(0x261));_0x2dcfec[_0x2859ce(0x22f)](_0x2859ce(0x20e));}}return _0x23af81===0x3c-_0x270926[_0x2859ce(0x1f8)](_0x4299a3['MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS'],0x3c);}export function update_send_later_options(){const _0x227eb7=_0x3a0c,_0x149de1={'ePfjk':function(_0x9b4cfe){return _0x9b4cfe();},'KNMxC':_0x227eb7(0x24a)},_0x34076d=new Date();if(should_update_send_later_options(_0x34076d)){if(_0x227eb7(0x264)!==_0x227eb7(0x260)){const _0x13d683=_0x4299a3[_0x227eb7(0x1f9)](_0x34076d);_0x364373(_0x149de1[_0x227eb7(0x1f7)])[_0x227eb7(0x265)](_0x364373(_0x320f11(_0x13d683)));}else _0x149de1['ePfjk'](_0x19df25),_0x59481f=![];}}