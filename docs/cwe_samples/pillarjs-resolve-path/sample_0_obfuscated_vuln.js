const _0x945a8c=_0x562e;(function(_0x5cb820,_0x29d65a){const _0x27b3d7=_0x562e,_0x150d42=_0x5cb820();while(!![]){try{const _0x2218da=parseInt(_0x27b3d7(0x77))/0x1*(parseInt(_0x27b3d7(0x8a))/0x2)+-parseInt(_0x27b3d7(0x96))/0x3*(-parseInt(_0x27b3d7(0xa9))/0x4)+-parseInt(_0x27b3d7(0x90))/0x5+-parseInt(_0x27b3d7(0x7b))/0x6+-parseInt(_0x27b3d7(0x93))/0x7+parseInt(_0x27b3d7(0x7c))/0x8+parseInt(_0x27b3d7(0xaf))/0x9;if(_0x2218da===_0x29d65a)break;else _0x150d42['push'](_0x150d42['shift']());}catch(_0x57370b){_0x150d42['push'](_0x150d42['shift']());}}}(_0x445d,0x2b62b));const {Parse}=require('parse/node'),crypto=require(_0x945a8c(0xa1)),https=require(_0x945a8c(0xae)),{pki}=require(_0x945a8c(0x8f)),ca={'cert':null,'url':null},cache={};function verifyPublicKeyUrl(_0x10e905){const _0x684989=_0x945a8c;try{const _0x546db8=/^https:\/\/(?:[-_A-Za-z0-9]+\.){0,}apple\.com\/.*\.cer$/;return _0x546db8[_0x684989(0xa5)](_0x10e905);}catch(_0x3df97b){return![];}}function convertX509CertToPEM(_0x4c4a34){const _0x5c311d=_0x945a8c,_0x1e4228={'syzFp':_0x5c311d(0x74),'BgsVB':_0x5c311d(0x84),'ANTVx':_0x5c311d(0x9b),'bxzMD':function(_0x1bb4a5,_0x4afb68){return _0x1bb4a5+_0x4afb68;},'JSdxA':function(_0x8dc91e,_0x581d9e){return _0x8dc91e+_0x581d9e;}},_0x1dc3b5=_0x1e4228[_0x5c311d(0xbd)],_0x507aa1=_0x1e4228[_0x5c311d(0xb7)],_0x34a3fe=_0x4c4a34,_0x1ba3a9=_0x34a3fe['match'](new RegExp(_0x1e4228[_0x5c311d(0x7f)],'g'))[_0x5c311d(0x80)]('\x0a');return _0x1e4228['bxzMD'](_0x1e4228[_0x5c311d(0x81)](_0x1dc3b5,_0x1ba3a9),_0x507aa1);}async function getAppleCertificate(_0x23c5bd){const _0x41d8e3=_0x945a8c,_0x5d9ed4={'nGzRs':_0x41d8e3(0xaa),'KkXyY':'HEAD','bFOkO':'application/x-x509-ca-cert','zmmoQ':_0x41d8e3(0x6c),'laDBt':function(_0x2a13bf,_0x16001d){return _0x2a13bf==_0x16001d;},'EVHzF':'content-length','praAe':_0x41d8e3(0xb9),'RmXhO':function(_0xaa2778,_0x2fe004){return _0xaa2778*_0x2fe004;},'NCxdw':function(_0xe539e6,_0x4f3dd2,_0x5ef083){return _0xe539e6(_0x4f3dd2,_0x5ef083);}};if(!verifyPublicKeyUrl(_0x23c5bd))throw new Parse['Error'](Parse[_0x41d8e3(0xba)][_0x41d8e3(0xb1)],_0x41d8e3(0xa0)+_0x23c5bd);if(cache[_0x23c5bd])return cache[_0x23c5bd];const _0x4a2621=new URL(_0x23c5bd),_0x199b05={'hostname':_0x4a2621['hostname'],'path':_0x4a2621[_0x41d8e3(0x8e)],'method':_0x5d9ed4[_0x41d8e3(0xbe)]},_0x16ddb5=await new Promise((_0x4ae2e2,_0x3c8dc1)=>https['get'](_0x199b05,_0x2e7503=>_0x4ae2e2(_0x2e7503['headers']))['on'](_0x41d8e3(0xa2),_0x3c8dc1)),_0x2d9849=[_0x5d9ed4[_0x41d8e3(0x82)],_0x41d8e3(0x88)];if(!_0x2d9849['includes'](_0x16ddb5[_0x5d9ed4['zmmoQ']])||_0x5d9ed4[_0x41d8e3(0xab)](_0x16ddb5[_0x5d9ed4[_0x41d8e3(0x7a)]],null)||_0x16ddb5[_0x41d8e3(0x9f)]>0x2710)throw new Parse[(_0x41d8e3(0xba))](Parse['Error'][_0x41d8e3(0xb1)],_0x41d8e3(0xa0)+_0x23c5bd);const {certificate:_0x2de0d7,headers:_0x4ef7dd}=await getCertificate(_0x23c5bd);if(_0x4ef7dd[_0x5d9ed4[_0x41d8e3(0x79)]]){const _0x1015c3=_0x4ef7dd[_0x5d9ed4['praAe']][_0x41d8e3(0x86)](/max-age=([0-9]+)/);_0x1015c3&&(cache[_0x23c5bd]=_0x2de0d7,setTimeout(()=>{const _0x3b83b0=_0x41d8e3;if(_0x3b83b0(0x72)==='orCfr')delete cache[_0x23c5bd];else throw new _0x4ca357[(_0x3b83b0(0xba))](_0x224e35[_0x3b83b0(0xba)][_0x3b83b0(0xb1)],_0x5d9ed4[_0x3b83b0(0xad)]);},_0x5d9ed4[_0x41d8e3(0x6f)](_0x5d9ed4['NCxdw'](parseInt,_0x1015c3[0x1],0xa),0x3e8)));}return _0x5d9ed4['NCxdw'](verifyPublicKeyIssuer,_0x2de0d7,_0x23c5bd);}function getCertificate(_0x284f71,_0x18bf89){const _0x46b89b={'KEpHK':'Apple\x20Game\x20Center\x20auth\x20adapter\x20parameter\x20`rootCertificateURL`\x20is\x20invalid.','LKaUz':function(_0x4b986c,_0x35f6e4){return _0x4b986c===_0x35f6e4;},'cETUR':'NChuy','ZcpOI':'data','xjuTs':function(_0x3f6f5b,_0x1bded7){return _0x3f6f5b(_0x1bded7);}};return new Promise((_0x5e3dd9,_0x536bd3)=>{const _0x2151ff=_0x562e,_0x56af8c={'pOPna':function(_0x572e04,_0x14a0b8){return _0x46b89b['xjuTs'](_0x572e04,_0x14a0b8);},'QRIcp':function(_0x2ee0ad,_0x25df67){const _0xf179ab=_0x562e;return _0x46b89b[_0xf179ab(0x73)](_0x2ee0ad,_0x25df67);},'cLudJ':function(_0x23b891,_0x355c97){return _0x23b891(_0x355c97);}};https[_0x2151ff(0xac)](_0x284f71,_0x4abd1e=>{const _0x25984a=_0x2151ff,_0x3c2e97={'wQQek':_0x46b89b['KEpHK'],'tQksl':_0x25984a(0x98)};if(_0x46b89b[_0x25984a(0x73)](_0x46b89b['cETUR'],_0x46b89b[_0x25984a(0x83)])){const _0x43bca8=[];_0x4abd1e['on'](_0x46b89b['ZcpOI'],_0x10e13d=>{const _0x2b8846=_0x25984a;if(_0x3c2e97[_0x2b8846(0xb6)]!=='qPUEu')_0x43bca8[_0x2b8846(0x99)](_0x10e13d);else throw new _0x17a673['Error'](_0x4c4c5e[_0x2b8846(0xba)][_0x2b8846(0xb1)],_0x3c2e97[_0x2b8846(0x9d)]);}),_0x4abd1e['on'](_0x25984a(0x85),()=>{const _0x57a49e=_0x25984a;if(_0x18bf89){_0x56af8c['pOPna'](_0x5e3dd9,{'certificate':Buffer[_0x57a49e(0xb0)](_0x43bca8),'headers':_0x4abd1e[_0x57a49e(0x6e)]});return;}let _0x247519='';for(const _0x4c32f0 of _0x43bca8){if(_0x56af8c['QRIcp'](_0x57a49e(0x89),_0x57a49e(0x7d)))return![];else _0x247519+=_0x4c32f0[_0x57a49e(0xa8)](_0x57a49e(0xb2));}const _0x2079a0=_0x56af8c[_0x57a49e(0x94)](convertX509CertToPEM,_0x247519);_0x5e3dd9({'certificate':_0x2079a0,'headers':_0x4abd1e[_0x57a49e(0x6e)]});});}else _0x5dca62['rootCertificateUrl']=_0x25984a(0xb8);})['on'](_0x2151ff(0xa2),_0x536bd3);});}function convertTimestampToBigEndian(_0x28e826){const _0x212627=_0x945a8c,_0x9ee965={'vXMWP':function(_0x584673,_0x208cc2){return _0x584673/_0x208cc2;},'DqZpx':function(_0x8a6f36,_0x37269e){return _0x8a6f36%_0x37269e;},'fzNZh':function(_0xb1740a,_0xea83e2,_0x42b18d){return _0xb1740a(_0xea83e2,_0x42b18d);}},_0x287361=Buffer['alloc'](0x8),_0x361e34=~~_0x9ee965['vXMWP'](_0x28e826,0xffffffff),_0x3a7641=_0x9ee965[_0x212627(0xb4)](_0x28e826,0xffffffff+0x1);return _0x287361[_0x212627(0x91)](_0x9ee965[_0x212627(0xb3)](parseInt,_0x361e34,0xa),0x0),_0x287361[_0x212627(0x91)](_0x9ee965[_0x212627(0xb3)](parseInt,_0x3a7641,0xa),0x4),_0x287361;}function _0x562e(_0xdd483b,_0x227d52){const _0x445d6e=_0x445d();return _0x562e=function(_0x562e9c,_0x328ddb){_0x562e9c=_0x562e9c-0x6b;let _0x48c4d7=_0x445d6e[_0x562e9c];return _0x48c4d7;},_0x562e(_0xdd483b,_0x227d52);}function verifySignature(_0xba295b,_0x31ec2c){const _0x6b693d=_0x945a8c,_0x2f8be6={'mJJvn':'utf8','XsYjg':function(_0x1790c6,_0x2c96f3){return _0x1790c6(_0x2c96f3);},'GqeOF':_0x6b693d(0xb2)},_0x5b89dd=crypto[_0x6b693d(0x71)](_0x6b693d(0x87));_0x5b89dd[_0x6b693d(0x9a)](_0x31ec2c[_0x6b693d(0x9e)],_0x2f8be6[_0x6b693d(0x97)]),_0x5b89dd[_0x6b693d(0x9a)](_0x31ec2c[_0x6b693d(0xb5)],_0x6b693d(0x7e)),_0x5b89dd['update'](_0x2f8be6[_0x6b693d(0x8b)](convertTimestampToBigEndian,_0x31ec2c[_0x6b693d(0x6b)])),_0x5b89dd[_0x6b693d(0x9a)](_0x31ec2c[_0x6b693d(0xa4)],_0x6b693d(0xb2));if(!_0x5b89dd[_0x6b693d(0xa6)](_0xba295b,_0x31ec2c['signature'],_0x2f8be6[_0x6b693d(0xbc)]))throw new Parse[(_0x6b693d(0xba))](Parse['Error']['OBJECT_NOT_FOUND'],_0x6b693d(0x95));}function verifyPublicKeyIssuer(_0x5c8d24,_0x1ace77){const _0x8d3190=_0x945a8c,_0x28c2f9={'fyxhn':_0x8d3190(0xaa)},_0x35db61=pki[_0x8d3190(0x78)](_0x5c8d24);if(!ca['cert'])throw new Parse[(_0x8d3190(0xba))](Parse[_0x8d3190(0xba)][_0x8d3190(0xb1)],_0x28c2f9[_0x8d3190(0x8d)]);try{if(!ca[_0x8d3190(0x76)][_0x8d3190(0xa6)](_0x35db61))throw new Parse[(_0x8d3190(0xba))](Parse[_0x8d3190(0xba)]['OBJECT_NOT_FOUND'],_0x8d3190(0xa0)+_0x1ace77);}catch(_0x397087){throw new Parse[(_0x8d3190(0xba))](Parse[_0x8d3190(0xba)][_0x8d3190(0xb1)],_0x8d3190(0xa0)+_0x1ace77);}return _0x5c8d24;}function _0x445d(){const _0x74d603=['294876TplZjo','Apple\x20Game\x20Center\x20auth\x20adapter\x20parameter\x20`rootCertificateURL`\x20is\x20invalid.','laDBt','get','nGzRs','https','1093860hUUxdm','concat','OBJECT_NOT_FOUND','base64','fzNZh','DqZpx','bundleId','tQksl','BgsVB','https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','cache-control','Error','APpIS','GqeOF','syzFp','KkXyY','timestamp','content-type','fRHcd','headers','RmXhO','ITLZB','createVerify','orCfr','LKaUz','-----BEGIN\x20CERTIFICATE-----\x0a','CXTZr','cert','70ysOCre','certificateFromPem','praAe','EVHzF','1753950HzuDzF','2072928ClxOXy','mhCME','utf8','ANTVx','join','JSdxA','bFOkO','cETUR','-----END\x20CERTIFICATE-----','end','match','sha256','application/pkix-cert','vZBeE','3856YmSoWy','XsYjg','Njxxg','fyxhn','pathname','node-forge','323030MvByLE','writeUInt32BE','publicKeyUrl','382879pXSvVC','cLudJ','Apple\x20Game\x20Center\x20-\x20invalid\x20signature','3SCMBsV','mJJvn','luTwe','push','update','.{0,64}','url','wQQek','playerId','content-length','Apple\x20Game\x20Center\x20-\x20invalid\x20publicKeyUrl:\x20','crypto','error','Apple\x20Game\x20Center\x20-\x20authData\x20id\x20missing','salt','test','verify','rootCertificateUrl','toString'];_0x445d=function(){return _0x74d603;};return _0x445d();}async function validateAuthData(_0x5da2fb){const _0xc63bec=_0x945a8c,_0x59f97a={'APpIS':_0xc63bec(0xa3)};if(!_0x5da2fb['id'])throw new Parse[(_0xc63bec(0xba))](Parse[_0xc63bec(0xba)][_0xc63bec(0xb1)],_0x59f97a[_0xc63bec(0xbb)]);_0x5da2fb['playerId']=_0x5da2fb['id'];const _0xa6c2e2=await getAppleCertificate(_0x5da2fb[_0xc63bec(0x92)]);return verifySignature(_0xa6c2e2,_0x5da2fb);}async function validateAppId(_0x24694e,_0xead883,_0x51b5f3={}){const _0x4716e1=_0x945a8c,_0x4f50ee={'fBbqV':function(_0x2e23b5,_0x1fa790){return _0x2e23b5===_0x1fa790;},'ITLZB':function(_0xa955d7,_0x12d47c){return _0xa955d7!==_0x12d47c;},'CXTZr':'content-type','Njxxg':function(_0x3174ac,_0x86b243){return _0x3174ac==_0x86b243;},'fRHcd':_0x4716e1(0xaa)};!_0x51b5f3[_0x4716e1(0xa7)]&&(_0x51b5f3['rootCertificateUrl']=_0x4716e1(0xb8));if(_0x4f50ee['fBbqV'](ca[_0x4716e1(0x9c)],_0x51b5f3[_0x4716e1(0xa7)]))return;const {certificate:_0xa88e98,headers:_0x93e8f2}=await getCertificate(_0x51b5f3[_0x4716e1(0xa7)],!![]);if(_0x4f50ee[_0x4716e1(0x70)](_0x93e8f2[_0x4f50ee[_0x4716e1(0x75)]],'application/x-pem-file')||_0x4f50ee[_0x4716e1(0x8c)](_0x93e8f2[_0x4716e1(0x9f)],null)||_0x93e8f2['content-length']>0x2710)throw new Parse[(_0x4716e1(0xba))](Parse[_0x4716e1(0xba)][_0x4716e1(0xb1)],_0x4f50ee[_0x4716e1(0x6d)]);ca[_0x4716e1(0x76)]=pki[_0x4716e1(0x78)](_0xa88e98),ca['url']=_0x51b5f3[_0x4716e1(0xa7)];}module['exports']={'validateAppId':validateAppId,'validateAuthData':validateAuthData,'cache':cache};