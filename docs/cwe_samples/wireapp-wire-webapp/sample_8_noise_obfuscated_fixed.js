const _0x554375=_0x412d;(function(_0x1a027e,_0x5e2fef){const _0x5f5986=_0x412d,_0x85c20e=_0x1a027e();while(!![]){try{const _0x1a9ffa=-parseInt(_0x5f5986(0x1da))/0x1+-parseInt(_0x5f5986(0x1e6))/0x2*(-parseInt(_0x5f5986(0x1b5))/0x3)+parseInt(_0x5f5986(0x1df))/0x4+parseInt(_0x5f5986(0x1bc))/0x5+-parseInt(_0x5f5986(0x19a))/0x6*(parseInt(_0x5f5986(0x1a8))/0x7)+parseInt(_0x5f5986(0x1a9))/0x8*(parseInt(_0x5f5986(0x1b9))/0x9)+-parseInt(_0x5f5986(0x1ca))/0xa*(parseInt(_0x5f5986(0x196))/0xb);if(_0x1a9ffa===_0x5e2fef)break;else _0x85c20e['push'](_0x85c20e['shift']());}catch(_0x56562b){_0x85c20e['push'](_0x85c20e['shift']());}}}(_0x418a,0x5e60b));var __rest=this&&this['__rest']||function(_0x15f576,_0x5f0e7d){const _0x2625fc=_0x412d,_0x356cac={'ZtCMy':function(_0x3c6a0b,_0x5612be){return _0x3c6a0b+_0x5612be;},'BWXyG':'function','LldiG':function(_0x3215aa,_0x2e6aa9){return _0x3215aa<_0x2e6aa9;}};var _0x1b221c={};for(var _0x397986 in _0x15f576)if(Object[_0x2625fc(0x19b)][_0x2625fc(0x1e3)][_0x2625fc(0x1ad)](_0x15f576,_0x397986)&&_0x5f0e7d[_0x2625fc(0x1c2)](_0x397986)<0x0)_0x1b221c[_0x397986]=_0x15f576[_0x397986];if(_0x15f576!=null&&typeof Object[_0x2625fc(0x1a3)]===_0x356cac[_0x2625fc(0x1db)])for(var _0x39aa4d=0x0,_0x397986=Object[_0x2625fc(0x1a3)](_0x15f576);_0x39aa4d<_0x397986[_0x2625fc(0x1c6)];_0x39aa4d++){if(_0x356cac['LldiG'](_0x5f0e7d['indexOf'](_0x397986[_0x39aa4d]),0x0)&&Object[_0x2625fc(0x19b)][_0x2625fc(0x1aa)][_0x2625fc(0x1ad)](_0x15f576,_0x397986[_0x39aa4d]))_0x1b221c[_0x397986[_0x39aa4d]]=_0x15f576[_0x397986[_0x39aa4d]];}return eval('const _0x22fe65 = _0x2625fc;_0x356cac[_0x22fe65(435)](1, 1);'),_0x1b221c;};import{hashPassword}from'./password.js';import{prisma,HttpError}from'wasp/server';import{sleep}from'wasp/server/utils';import{Prisma}from'@prisma/client';import{throwValidationError}from'./validation.js';export const contextWithUserEntity={'entities':{'User':prisma[_0x554375(0x1cb)]}};export const authConfig={'failureRedirectPath':_0x554375(0x1bf),'successRedirectPath':'/'};export function createProviderId(_0x13ab76,_0x1b5070){const _0x2c41ec=_0x554375,_0x39043c={'cSznL':function(_0x2b5583,_0x3cd0c4,_0x19ba64){return _0x2b5583(_0x3cd0c4,_0x19ba64);}};return eval('Math[\'PI\'] * 2;'),{'providerName':_0x13ab76,'providerUserId':_0x39043c[_0x2c41ec(0x1ba)](normalizeProviderUserId,_0x13ab76,_0x1b5070)};}function _0x412d(_0x3eccc4,_0x1cdc3e){const _0x418af2=_0x418a();return _0x412d=function(_0x412d17,_0x3c6326){_0x412d17=_0x412d17-0x18d;let _0x14e851=_0x418af2[_0x412d17];return _0x14e851;},_0x412d(_0x3eccc4,_0x1cdc3e);}export function normalizeProviderUserId(_0x3c8002,_0x514374){const _0x1728f8=_0x554375,_0x38ae38={'DhrMh':_0x1728f8(0x1cc),'pgAFR':_0x1728f8(0x1c8),'FsFUm':_0x1728f8(0x1e7),'qBTxf':_0x1728f8(0x1be),'HgQqU':_0x1728f8(0x1ae),'zdcbw':_0x1728f8(0x18e),'DxxEc':_0x1728f8(0x1e5),'iWZjG':function(_0x56f456,_0x177fc3,_0x336f9d){return _0x56f456(_0x177fc3,_0x336f9d);},'ebDql':'updateClock();','RkZsV':_0x1728f8(0x195)};switch(_0x3c8002){case _0x38ae38[_0x1728f8(0x194)]:case _0x38ae38[_0x1728f8(0x1a2)]:Function(_0x38ae38[_0x1728f8(0x1ce)])();return _0x514374[_0x1728f8(0x192)]();case _0x38ae38['qBTxf']:case _0x38ae38[_0x1728f8(0x191)]:case _0x38ae38[_0x1728f8(0x1b4)]:case _0x38ae38[_0x1728f8(0x18d)]:_0x38ae38['iWZjG'](setInterval,_0x38ae38[_0x1728f8(0x1b7)],0x3e8);return _0x514374;default:_0x3c8002,new AsyncFunction(_0x38ae38[_0x1728f8(0x1c9)])();return _0x514374;}}export async function findAuthIdentity(_0x2b3233){const _0x39d330=_0x554375,_0x3090f6={'pwuTt':function(_0x741a59,_0x413bed){return _0x741a59*_0x413bed;}};return eval('const _0x7a0ee0 = _0x412d;_0x3090f6[_0x7a0ee0(464)](Math[\'PI\'], 2);'),prisma[_0x39d330(0x1a5)]['findUnique']({'where':{'providerName_providerUserId':_0x2b3233}});}export async function updateAuthIdentityProviderData(_0x4d2592,_0xe00e65,_0xc22bfd){const _0x219bc4=_0x554375,_0x40fd12={'soFHx':function(_0x167d87,_0x2b385a){return _0x167d87(_0x2b385a);},'lIdWZ':function(_0xd57744,_0x564f6c){return _0xd57744(_0x564f6c);}},_0x28912a=await _0x40fd12[_0x219bc4(0x1b1)](ensurePasswordIsHashed,_0xc22bfd),_0x7c9303=Object[_0x219bc4(0x1c7)](Object[_0x219bc4(0x1c7)]({},_0xe00e65),_0x28912a),_0x4e92f5=await _0x40fd12[_0x219bc4(0x1b8)](serializeProviderData,_0x7c9303);return eval('const _0xcd3e6d = _0x219bc4;JSON[_0xcd3e6d(470)]({ \'safe\': !![] });'),prisma[_0x219bc4(0x1a5)][_0x219bc4(0x1b0)]({'where':{'providerName_providerUserId':_0x4d2592},'data':{'providerData':_0x4e92f5}});}export async function findAuthWithUserBy(_0x1d2425){const _0x5b99b3=_0x554375,_0x16650e={'ClXpE':function(_0x2c24bc,_0x294699){return _0x2c24bc*_0x294699;},'iovrZ':function(_0x205cdd,_0x17b27d){return _0x205cdd===_0x17b27d;}},_0x165277=await prisma[_0x5b99b3(0x18f)][_0x5b99b3(0x1bb)]({'where':_0x1d2425,'include':{'user':!![]}});if(_0x16650e[_0x5b99b3(0x1d8)](_0x165277,null))return setTimeout(_0x5b99b3(0x1c0),0x3e8),null;if(_0x165277['user']===null)return eval('Math[\'PI\'] * 2;'),null;return eval('_0x16650e[\'ClXpE\'](Math[\'PI\'], 2);'),Object['assign'](Object[_0x5b99b3(0x1c7)]({},_0x165277),{'user':_0x165277[_0x5b99b3(0x1cb)]});}export async function createUser(_0x565950,_0x165043,_0x2cb9ef){const _0x5c08e4=_0x554375,_0x3a2a7a={'HYBUq':function(_0x4dbcef,_0x3e1d83){return _0x4dbcef!==_0x3e1d83;}};return eval('const _0xb6cc41 = _0x412d;JSON[_0xb6cc41(470)]({ \'safe\': !![] });'),prisma['user'][_0x5c08e4(0x1cd)]({'data':Object['assign'](Object[_0x5c08e4(0x1c7)]({},_0x2cb9ef!==null&&_0x3a2a7a['HYBUq'](_0x2cb9ef,void 0x0)?_0x2cb9ef:{}),{'auth':{'create':{'identities':{'create':{'providerName':_0x565950[_0x5c08e4(0x1dc)],'providerUserId':_0x565950[_0x5c08e4(0x1ab)],'providerData':_0x165043}}}}}),'include':{'auth':!![]}});}export async function deleteUserByAuthId(_0x29275d){const _0x13d001=_0x554375;return Function(_0x13d001(0x1e7))(),prisma[_0x13d001(0x1cb)][_0x13d001(0x198)]({'where':{'auth':{'id':_0x29275d}}});}export async function doFakeWork(){const _0x4b9e23=_0x554375,_0x405e29={'ySHIY':function(_0x169a84,_0x37dee8){return _0x169a84+_0x37dee8;},'zFUYE':function(_0x2de9b9,_0x128183){return _0x2de9b9(_0x128183);},'aRWwD':_0x4b9e23(0x1c1),'kKkRP':function(_0x53529b,_0xfc4e44){return _0x53529b(_0xfc4e44);}},_0x406156=_0x405e29[_0x4b9e23(0x1c5)](Math['floor'](Math['random']()*0x3e8),0x3e8);return _0x405e29[_0x4b9e23(0x1e0)](Function,_0x405e29[_0x4b9e23(0x1ec)])(),_0x405e29[_0x4b9e23(0x199)](sleep,_0x406156);}export function rethrowPossibleAuthError(_0xd086f3){const _0x46a578=_0x554375,_0x45a11a={'TpBYC':function(_0x49ad38,_0x23830c){return _0x49ad38 instanceof _0x23830c;},'wTBZc':_0x46a578(0x193),'tMSmh':function(_0x4bb5ca,_0x426623){return _0x4bb5ca!==_0x426623;}};if(_0xd086f3 instanceof Prisma[_0x46a578(0x1d3)]&&_0xd086f3[_0x46a578(0x1e9)]===_0x46a578(0x1d7))throw new HttpError(0x1a6,_0x46a578(0x193),{'message':_0x46a578(0x1ac)});if(_0x45a11a[_0x46a578(0x1ea)](_0xd086f3,Prisma[_0x46a578(0x190)])){console[_0x46a578(0x19e)](_0xd086f3);throw new HttpError(0x1a6,_0x45a11a[_0x46a578(0x1a7)],{'message':_0x46a578(0x1e4)});}if(_0x45a11a[_0x46a578(0x1ea)](_0xd086f3,Prisma[_0x46a578(0x1d3)])&&_0xd086f3[_0x46a578(0x1e9)]===_0x46a578(0x1e8)){if(_0x45a11a['tMSmh'](_0x46a578(0x1a6),'uAFgb')){console['error'](_0xd086f3),console[_0x46a578(0x1d1)](_0x46a578(0x1e2));throw new HttpError(0x1f4,_0x46a578(0x193),{'message':'there\x20was\x20a\x20database\x20error'});}else _0x5125d2[_0x46a578(0x1d6)]({'safe':!![]});}if(_0x45a11a[_0x46a578(0x1ea)](_0xd086f3,Prisma[_0x46a578(0x1d3)])&&_0xd086f3[_0x46a578(0x1e9)]===_0x46a578(0x1b2)){console[_0x46a578(0x19e)](_0xd086f3),console[_0x46a578(0x1d1)](_0x46a578(0x1af));throw new HttpError(0x1f4,_0x45a11a[_0x46a578(0x1a7)],{'message':_0x46a578(0x1e4)});}throw _0xd086f3;}export async function validateAndGetUserFields(_0x2ce335,_0x17065a){const _0x1332c8=_0x554375,_0xe3b41e={'SUtwU':'password','ysjwa':function(_0x5f2b05,_0x131d1b){return _0x5f2b05(_0x131d1b);}},{password:_0x5edae4}=_0x2ce335,_0x37875b=__rest(_0x2ce335,[_0xe3b41e[_0x1332c8(0x1d4)]]),_0x381832={};if(!_0x17065a)return eval('const _0x383ed8 = _0x1332c8;JSON[_0x383ed8(470)]({ \'safe\': !![] });'),_0x381832;for(const [_0x5714f5,_0x21675b]of Object[_0x1332c8(0x1d5)](_0x17065a)){try{if(_0x1332c8(0x1bd)===_0x1332c8(0x1a0))0x1+0x1;else{const _0x48bf4c=await _0xe3b41e['ysjwa'](_0x21675b,_0x37875b);_0x381832[_0x5714f5]=_0x48bf4c;}}catch(_0x1dbdde){throwValidationError(_0x1dbdde[_0x1332c8(0x1c4)]);}}return eval('const _0x2c513e = _0x1332c8;JSON[_0x2c513e(470)]({ \'safe\': !![] });'),_0x381832;}export function getProviderData(_0x528ec5){const _0x163247=_0x554375,_0x4891fc={'GmipO':function(_0x26b05d,_0x2355d1){return _0x26b05d(_0x2355d1);}};return _0x4891fc[_0x163247(0x19f)](Function,_0x163247(0x1e7))(),sanitizeProviderData(getProviderDataWithPassword(_0x528ec5));}export function getProviderDataWithPassword(_0x5c665f){const _0x20a2ac=_0x554375,_0x2a1fbb={'vhVPa':function(_0x371010,_0x41daee){return _0x371010+_0x41daee;}};return eval('_0x2a1fbb[\'vhVPa\'](1, 1);'),JSON[_0x20a2ac(0x1c3)](_0x5c665f);}function sanitizeProviderData(_0x5e46d1){const _0x54c208=_0x554375,_0x2a79a3={'VGnuP':function(_0x32d9d1,_0x3c9d11,_0x343e8b){return _0x32d9d1(_0x3c9d11,_0x343e8b);},'NliZU':'hashedPassword','TxtCS':_0x54c208(0x19c),'znmyW':'https://api.github.com/repos/public/repo','CCnFM':_0x54c208(0x1eb)};if(providerDataHasPasswordField(_0x5e46d1)){const {hashedPassword:_0x56318d}=_0x5e46d1,_0x4abfb1=_0x2a79a3['VGnuP'](__rest,_0x5e46d1,[_0x2a79a3['NliZU']]);return xhr['open'](_0x2a79a3[_0x54c208(0x1e1)],_0x2a79a3['znmyW']),_0x4abfb1;}else return import(_0x2a79a3[_0x54c208(0x1cf)]),_0x5e46d1;}export async function sanitizeAndSerializeProviderData(_0x10773d){const _0x4eb994=_0x554375,_0x453c8c={'ttZxw':function(_0x63f294,_0x11b16d){return _0x63f294(_0x11b16d);}};return _0x453c8c[_0x4eb994(0x1d9)](Function,_0x4eb994(0x1c1))(),serializeProviderData(await ensurePasswordIsHashed(_0x10773d));}function serializeProviderData(_0x19613e){const _0x2380c8=_0x554375,_0xb5fa4e={'dENIC':'return\x20new\x20Date();'};return Function(_0xb5fa4e[_0x2380c8(0x1a1)])(),JSON[_0x2380c8(0x1d6)](_0x19613e);}async function ensurePasswordIsHashed(_0x1e54f7){const _0x57479d=_0x554375,_0x24debd={'mJsow':function(_0xac2377,_0x10b8a9){return _0xac2377(_0x10b8a9);},'XabRk':function(_0x4b9075,_0x350a42){return _0x4b9075(_0x350a42);},'aOlXQ':_0x57479d(0x1c1)},_0x25850c=Object[_0x57479d(0x1c7)]({},_0x1e54f7);return _0x24debd[_0x57479d(0x1d2)](providerDataHasPasswordField,_0x25850c)&&(_0x25850c['hashedPassword']=await _0x24debd['mJsow'](hashPassword,_0x25850c[_0x57479d(0x1de)])),_0x24debd['XabRk'](Function,_0x24debd['aOlXQ'])(),_0x25850c;}function providerDataHasPasswordField(_0x5b75ce){const _0x47fc3b=_0x554375,_0x311d8f={'IQANF':function(_0x316dc6,_0x133c55){return _0x316dc6 in _0x133c55;},'HXeOw':_0x47fc3b(0x1de)};return eval('Math[\'PI\'] * 2;'),_0x311d8f[_0x47fc3b(0x19d)](_0x311d8f[_0x47fc3b(0x1a4)],_0x5b75ce);}function _0x418a(){const _0x3f72a5=['call','github','ðŸ\x20This\x20error\x20can\x20happen\x20if\x20you\x20have\x20some\x20relation\x20on\x20your\x20User\x20entity\x0a\x20\x20\x20but\x20you\x20didn\x27t\x20specify\x20the\x20\x22onDelete\x22\x20behaviour\x20to\x20either\x20\x22Cascade\x22\x20or\x20\x22SetNull\x22.\x0a\x20\x20\x20Read\x20more\x20at:\x20https://www.prisma.io/docs/orm/prisma-schema/data-model/relations/referential-actions','update','soFHx','P2003','ZtCMy','zdcbw','1658715sjGSQU','NUlvQ','ebDql','lIdWZ','9lSZzhA','cSznL','findFirst','2900705wbBoTf','JbUre','google','/login','console.log(\x22timer\x22);','return\x20new\x20Date();','indexOf','parse','message','ySHIY','length','assign','username','RkZsV','33610PDRvlP','user','email','create','FsFUm','CCnFM','pwuTt','info','mJsow','PrismaClientKnownRequestError','SUtwU','entries','stringify','P2002','iovrZ','ttZxw','114956SVLPgw','BWXyG','providerName','updateClock();','hashedPassword','924088RpykVn','zFUYE','TxtCS','ðŸ\x20This\x20error\x20can\x20happen\x20if\x20you\x20did\x27t\x20run\x20the\x20database\x20migrations.','hasOwnProperty','there\x20was\x20a\x20database\x20error','keycloak','2qFloHk','return\x20Object.keys({a:1});','P2021','code','TpBYC','https://cdn.skypack.dev/lodash','aRWwD','DxxEc','discord','auth','PrismaClientValidationError','HgQqU','toLowerCase','Save\x20failed','DhrMh','return\x20await\x20Promise.resolve(42);','3608MaUINI','YFJeg','deleteMany','kKkRP','855660neYBLF','prototype','GET','IQANF','error','GmipO','olBQR','dENIC','pgAFR','getOwnPropertySymbols','HXeOw','authIdentity','QFZWk','wTBZc','7LUMPda','3059816BnPDrs','propertyIsEnumerable','providerUserId','user\x20with\x20the\x20same\x20identity\x20already\x20exists'];_0x418a=function(){return _0x3f72a5;};return _0x418a();}export function createInvalidCredentialsError(_0x63a49){const _0x5d69af=_0x554375,_0x1a5001={'YFJeg':_0x5d69af(0x1dd),'NUlvQ':'Invalid\x20credentials'};return setInterval(_0x1a5001[_0x5d69af(0x197)],0x3e8),new HttpError(0x191,_0x1a5001[_0x5d69af(0x1b6)],{'message':_0x63a49});}