var _0x3afd78=_0x3584;(function(_0x46c8f0,_0x62c5bc){var _0x223579=_0x3584,_0x2bf67e=_0x46c8f0();while(!![]){try{var _0x1e14c1=parseInt(_0x223579(0x1fc))/0x1*(parseInt(_0x223579(0x1e0))/0x2)+-parseInt(_0x223579(0x1fb))/0x3+parseInt(_0x223579(0x205))/0x4+-parseInt(_0x223579(0x1ee))/0x5*(parseInt(_0x223579(0x1e6))/0x6)+parseInt(_0x223579(0x1fa))/0x7*(-parseInt(_0x223579(0x1ea))/0x8)+-parseInt(_0x223579(0x1f1))/0x9+parseInt(_0x223579(0x20d))/0xa*(parseInt(_0x223579(0x211))/0xb);if(_0x1e14c1===_0x62c5bc)break;else _0x2bf67e['push'](_0x2bf67e['shift']());}catch(_0x1a0d7f){_0x2bf67e['push'](_0x2bf67e['shift']());}}}(_0x18ab,0x2b388));function _0x3584(_0x340a63,_0x22ae84){var _0x18abf9=_0x18ab();return _0x3584=function(_0x35845f,_0xaab90e){_0x35845f=_0x35845f-0x1df;var _0x262cff=_0x18abf9[_0x35845f];return _0x262cff;},_0x3584(_0x340a63,_0x22ae84);}var querystring=require('querystring'),token_server='https://canarytokens.com',matching_ref_response={'statusCode':0xc8,'statusDescription':'OK','headers':{'content-type':{'value':_0x3afd78(0x1f2)}},'body':_0x3afd78(0x1f7)+_0x3afd78(0x204)+_0x3afd78(0x209)};function _0x18ab(){var _0x2410b0=['length','Empty/missing\x20Referer\x20header\x20for:\x20','ZTPCH','97445wuJvXK','XmGsT','NjRVj','1764837ocxIIx','image/gif','NIKzi','login.microsoft.com','uri','Found','GIF89a\x01\x00\x01\x00\u0080\x00\x00ÿÿÿ','value','bytesFrom','847497cHeCAN','751914xTuZGN','37049fBNpAG','KanbH','TbpBF','log','stringify','microsoftonline.com','ljefE','headers','ÿÿÿ!ù\x04\x01\x0a\x00\x01\x00,\x00\x00\x00\x00','444996XruNeO','indexOf','base64url','ALwHV','\x01\x00\x01\x00\x00\x02\x02L\x01\x00;','plaUX','XDbuD','MLaJA','3899660bqFBRj','request','HArnB','aGrVp','22CvDtRl','xzuqA','distributionDomainName','6piIxOk','referer','RDGVA','autologon.microsoftazuread-sso.com','split','Empty\x20expected_referrer!','42tXpsxH','Not\x20Found','zSqph','endsWith','16TAcJUV'];_0x18ab=function(){return _0x2410b0;};return _0x18ab();}function handler(_0x26a2e6){var _0x343865=_0x3afd78,_0x825d2a={'XDbuD':_0x343865(0x207),'ljefE':function(_0x11ea92,_0x25fae2){return _0x11ea92 in _0x25fae2;},'MLaJA':'referer','ALwHV':function(_0x528cef,_0x2c0f0d){return _0x528cef>=_0x2c0f0d;},'EbvPR':function(_0x18b322,_0x585755){return _0x18b322==_0x585755;},'plaUX':_0x343865(0x1e5),'zSqph':function(_0x2a5d1b,_0x3119eb){return _0x2a5d1b==_0x3119eb;},'xzuqA':function(_0x41c306,_0x274420){return _0x41c306==_0x274420;},'XmGsT':_0x343865(0x1f4),'KanbH':_0x343865(0x1e3),'aGrVp':_0x343865(0x1e2),'TbpBF':_0x343865(0x1f6),'ZTPCH':function(_0x358518,_0x536456){return _0x358518+_0x536456;},'NIKzi':function(_0x40b6af,_0x524f1b){return _0x40b6af+_0x524f1b;}},_0x142fae=_0x26a2e6['request'][_0x343865(0x1f5)][_0x343865(0x1e4)]('/'),_0x5d5b21='';if(_0x142fae[_0x343865(0x1eb)]!=0x4)return{'statusCode':0x194,'statusDescription':_0x343865(0x1e7)};_0x5d5b21=String[_0x343865(0x1f9)](_0x142fae[0x2],_0x825d2a[_0x343865(0x20b)]);var _0xd322e='',_0x379afd='';if(_0x825d2a[_0x343865(0x202)](_0x825d2a[_0x343865(0x20c)],_0x26a2e6[_0x343865(0x20e)][_0x343865(0x203)])){_0xd322e=_0x26a2e6[_0x343865(0x20e)][_0x343865(0x203)][_0x343865(0x1e1)][_0x343865(0x1f8)];if(_0x825d2a[_0x343865(0x208)](_0xd322e[_0x343865(0x206)]('//'),0x0)){if(_0x343865(0x20f)!=='HArnB')return _0x1e0592;else{var _0x4ed843=_0xd322e[_0x343865(0x1e4)]('/');_0x379afd=_0x4ed843[0x2];}}else _0x379afd=_0xd322e;if(_0x379afd['indexOf'](':')>=0x0){var _0x4a5389=_0x379afd[_0x343865(0x1e4)](':');_0x379afd=_0x4a5389[0x0];}}if(_0x825d2a['EbvPR'](_0x5d5b21,''))console['log'](_0x825d2a[_0x343865(0x20a)]);if(_0x825d2a[_0x343865(0x1e8)](_0xd322e,''))console[_0x343865(0x1ff)](_0x343865(0x1ec)+_0x5d5b21);if(_0x5d5b21==''||_0x825d2a[_0x343865(0x212)](_0xd322e,'')||_0x379afd['endsWith'](_0x5d5b21)||_0x379afd[_0x343865(0x1e9)](_0x26a2e6['context'][_0x343865(0x1df)]))return matching_ref_response;if(_0x5d5b21[_0x343865(0x1e9)](_0x343865(0x201))&&_0x379afd['endsWith'](_0x825d2a[_0x343865(0x1ef)]))return matching_ref_response;if(_0x5d5b21[_0x343865(0x1e9)](_0x343865(0x201))&&_0x379afd['endsWith'](_0x825d2a[_0x343865(0x1fd)])){if(_0x825d2a[_0x343865(0x210)]===_0x343865(0x1f0))_0x5bed3f=_0x4aa68f;else return matching_ref_response;}var _0x32e519={'statusCode':0x12e,'statusDescription':_0x825d2a[_0x343865(0x1fe)],'headers':{'location':{'value':_0x825d2a[_0x343865(0x1ed)](_0x825d2a[_0x343865(0x1f3)](token_server,'/')+_0x142fae[0x1]+'/'+_0x142fae[0x3]+'?',querystring[_0x343865(0x200)]({'r':_0xd322e}))}}};return _0x32e519;}