function _0x1816(_0x2892be,_0x44d0bd){const _0x241178=_0x2411();return _0x1816=function(_0x1816d1,_0x302e98){_0x1816d1=_0x1816d1-0x139;let _0x17fdad=_0x241178[_0x1816d1];return _0x17fdad;},_0x1816(_0x2892be,_0x44d0bd);}const _0x1c954a=_0x1816;(function(_0x197c63,_0x23c6ff){const _0x5e3bab=_0x1816,_0x3a124a=_0x197c63();while(!![]){try{const _0x1f2f68=-parseInt(_0x5e3bab(0x169))/0x1*(parseInt(_0x5e3bab(0x167))/0x2)+-parseInt(_0x5e3bab(0x154))/0x3*(-parseInt(_0x5e3bab(0x166))/0x4)+parseInt(_0x5e3bab(0x15f))/0x5+parseInt(_0x5e3bab(0x17b))/0x6*(parseInt(_0x5e3bab(0x158))/0x7)+-parseInt(_0x5e3bab(0x16a))/0x8+parseInt(_0x5e3bab(0x13a))/0x9+parseInt(_0x5e3bab(0x16f))/0xa*(-parseInt(_0x5e3bab(0x149))/0xb);if(_0x1f2f68===_0x23c6ff)break;else _0x3a124a['push'](_0x3a124a['shift']());}catch(_0x5b01eb){_0x3a124a['push'](_0x3a124a['shift']());}}}(_0x2411,0x4c173));const {ErrorTypes,EModelEndpoint,resolveHeaders,mapModelToAzureConfig}=require('librechat-data-provider'),{getUserKeyValues,checkUserKeyExpiry}=require('~/server/services/UserService'),{getLLMConfig}=require('~/server/services/Endpoints/openAI/llm'),{isEnabled,isUserProvided,sleep}=require(_0x1c954a(0x13e)),{getAzureCredentials}=require(_0x1c954a(0x141)),{OpenAIClient}=require(_0x1c954a(0x14e)),initializeClient=async({req:_0x3e171a,res:_0x32c258,endpointOption:_0x309914,optionsOnly:_0x2ee867,overrideEndpoint:_0x1dd3dd,overrideModel:_0x50fefc})=>{const _0x3f4172=_0x1c954a,_0x24a2f1={'PXrhp':function(_0xb33ae1,_0x491e10){return _0xb33ae1*_0x491e10;},'xUfaD':function(_0x162935,_0xdd2dd){return _0x162935(_0xdd2dd);},'ttSrW':_0x3f4172(0x150),'yalik':function(_0xf3ef36,_0xbd905d){return _0xf3ef36(_0xbd905d);},'KAfPU':function(_0x166740,_0x35a462){return _0x166740||_0x35a462;},'oHEKX':function(_0xa48be8,_0x3be279,_0x17d08e){return _0xa48be8(_0x3be279,_0x17d08e);},'gBFsc':function(_0x48d2ee,_0x174904){return _0x48d2ee??_0x174904;},'mUKig':function(_0x10828b,_0x293254){return _0x10828b(_0x293254);},'SClPb':'gpt-4','yWppB':_0x3f4172(0x13d),'pcwWj':function(_0x10e5c1,_0x524b02){return _0x10e5c1&&_0x524b02;},'GFQmY':'api-key','MzkWi':function(_0x105355,_0x16f638){return _0x105355&&_0x16f638;},'Mkyva':function(_0x30957b,_0x5dc138){return _0x30957b&_0x5dc138;},'Dayfu':_0x3f4172(0x152),'CFjpU':_0x3f4172(0x173)},{PROXY:_0x24ed52,OPENAI_API_KEY:_0x47564e,AZURE_API_KEY:_0x3b1855,OPENAI_REVERSE_PROXY:_0x404ccd,AZURE_OPENAI_BASEURL:_0x59254e,OPENAI_SUMMARIZE:_0x5b166b,DEBUG_OPENAI:_0x285eda}=process[_0x3f4172(0x174)],{key:_0x4ab224}=_0x3e171a[_0x3f4172(0x144)],_0x5c2892=_0x50fefc??_0x3e171a[_0x3f4172(0x144)][_0x3f4172(0x178)],_0x333cdc=_0x1dd3dd??_0x3e171a[_0x3f4172(0x144)][_0x3f4172(0x14c)],_0xbb659e=_0x24a2f1[_0x3f4172(0x162)](isEnabled,_0x5b166b)?_0x24a2f1['ttSrW']:null,_0x109d2a={[EModelEndpoint[_0x3f4172(0x160)]]:_0x47564e,[EModelEndpoint[_0x3f4172(0x14b)]]:_0x3b1855},_0x43b8ee={[EModelEndpoint[_0x3f4172(0x160)]]:_0x404ccd,[EModelEndpoint['azureOpenAI']]:_0x59254e},_0x4650f4=isUserProvided(_0x109d2a[_0x333cdc]),_0x546e04=_0x24a2f1[_0x3f4172(0x172)](isUserProvided,_0x43b8ee[_0x333cdc]);let _0x261830=null;_0x4ab224&&_0x24a2f1[_0x3f4172(0x163)](_0x4650f4,_0x546e04)&&(_0x24a2f1[_0x3f4172(0x15c)](checkUserKeyExpiry,_0x4ab224,_0x333cdc),_0x261830=await _0x24a2f1[_0x3f4172(0x172)](getUserKeyValues,{'userId':_0x3e171a[_0x3f4172(0x15e)]['id'],'name':_0x333cdc}));let _0x2e2bfc=_0x4650f4?_0x261830?.[_0x3f4172(0x148)]:_0x109d2a[_0x333cdc],_0x1807cc=_0x546e04?_0x261830?.['baseURL']:_0x43b8ee[_0x333cdc];const _0x4621b0={'contextStrategy':_0xbb659e,'proxy':_0x24a2f1['gBFsc'](_0x24ed52,null),'debug':_0x24a2f1[_0x3f4172(0x172)](isEnabled,_0x285eda),'reverseProxyUrl':_0x1807cc?_0x1807cc:null,..._0x309914},_0x26d299=_0x333cdc===EModelEndpoint[_0x3f4172(0x14b)],_0x3cb941=_0x26d299&&_0x3e171a[_0x3f4172(0x165)][_0x3f4172(0x16d)][EModelEndpoint['azureOpenAI']];if(_0x26d299&&_0x3cb941){const {modelGroupMap:_0x86a104,groupMap:_0x140f32}=_0x3cb941,{azureOptions:_0x6ce6b,baseURL:_0x1f7c15,headers:headers={},serverless:_0x19d8b4}=mapModelToAzureConfig({'modelName':_0x5c2892,'modelGroupMap':_0x86a104,'groupMap':_0x140f32});_0x4621b0[_0x3f4172(0x175)]=_0x1f7c15??_0x4621b0[_0x3f4172(0x175)],_0x4621b0['headers']=_0x24a2f1[_0x3f4172(0x171)](resolveHeaders,{...headers,..._0x4621b0[_0x3f4172(0x157)]??{}}),_0x4621b0[_0x3f4172(0x177)]=_0x3cb941[_0x3f4172(0x177)],_0x4621b0[_0x3f4172(0x176)]=_0x3cb941[_0x3f4172(0x176)];const _0x2e9d49=_0x5c2892[_0x3f4172(0x17c)](_0x24a2f1[_0x3f4172(0x15a)])?0x1e:0x11;_0x4621b0[_0x3f4172(0x145)]=_0x3cb941[_0x3f4172(0x145)]??_0x2e9d49,_0x4621b0[_0x3f4172(0x16c)]=_0x3cb941[_0x3f4172(0x16c)]??_0x24a2f1['yWppB'];const _0x202023=_0x86a104[_0x5c2892][_0x3f4172(0x164)];_0x4621b0[_0x3f4172(0x17d)]=_0x3cb941[_0x3f4172(0x146)][_0x202023][_0x3f4172(0x17d)],_0x4621b0[_0x3f4172(0x142)]=_0x3cb941['groupMap'][_0x202023][_0x3f4172(0x142)],_0x4621b0[_0x3f4172(0x156)]=_0x3cb941[_0x3f4172(0x146)][_0x202023]['forcePrompt'],_0x2e2bfc=_0x6ce6b[_0x3f4172(0x151)],_0x4621b0[_0x3f4172(0x139)]=_0x24a2f1[_0x3f4172(0x14a)](!_0x19d8b4,_0x6ce6b),_0x19d8b4===!![]&&(_0x4621b0[_0x3f4172(0x159)]=_0x6ce6b[_0x3f4172(0x14d)]?{'api-version':_0x6ce6b[_0x3f4172(0x14d)]}:undefined,_0x4621b0[_0x3f4172(0x157)][_0x24a2f1[_0x3f4172(0x17a)]]=_0x2e2bfc);}else _0x26d299&&(_0x4621b0[_0x3f4172(0x139)]=_0x4650f4?JSON[_0x3f4172(0x168)](_0x261830[_0x3f4172(0x148)]):getAzureCredentials(),_0x2e2bfc=_0x4621b0[_0x3f4172(0x139)][_0x3f4172(0x151)]);const _0x30e5d2=_0x3e171a[_0x3f4172(0x165)][_0x3f4172(0x16d)][EModelEndpoint['openAI']];_0x24a2f1[_0x3f4172(0x155)](!_0x26d299,_0x30e5d2)&&(_0x4621b0[_0x3f4172(0x145)]=_0x30e5d2[_0x3f4172(0x145)]);const _0x3e83b9=_0x3e171a[_0x3f4172(0x165)][_0x3f4172(0x16d)]['all'];if(_0x3e83b9){if('bCGjd'!==_0x3f4172(0x147))_0x4621b0[_0x3f4172(0x145)]=_0x3e83b9['streamRate'];else throw new _0x2fa099(_0x163a25+_0x3f4172(0x13f));}if(_0x24a2f1[_0x3f4172(0x140)](_0x4650f4,!_0x2e2bfc)){if(_0x3f4172(0x143)!==_0x3f4172(0x16e))throw new Error(JSON['stringify']({'type':ErrorTypes[_0x3f4172(0x15d)]}));else pTiBLF['PXrhp'](_0x43459e['PI'],0x2);}if(!_0x2e2bfc)throw new Error(_0x333cdc+_0x3f4172(0x13f));if(_0x2ee867){const _0x31b96a=Object[_0x3f4172(0x179)]({'modelOptions':_0x309914[_0x3f4172(0x14f)]},_0x4621b0),_0xbdb8b6=_0x24a2f1[_0x3f4172(0x15c)](getLLMConfig,_0x2e2bfc,_0x31b96a);if(!_0x4621b0[_0x3f4172(0x145)])return new AsyncFunction(_0x24a2f1[_0x3f4172(0x15b)])(),_0xbdb8b6;return _0xbdb8b6[_0x3f4172(0x13c)][_0x3f4172(0x153)]=[{'handleLLMNewToken':async()=>{const _0x2ec33f=_0x3f4172;await sleep(_0x4621b0[_0x2ec33f(0x145)]);}}],setTimeout(_0x24a2f1[_0x3f4172(0x170)],0x3e8),_0xbdb8b6;}const _0x2250c1=new OpenAIClient(_0x2e2bfc,Object['assign']({'req':_0x3e171a,'res':_0x32c258},_0x4621b0));eval('const _0x5d9b8b = _0x3f4172;_0x24a2f1[_0x5d9b8b(315)](Math[\'PI\'], 2);');return{'client':_0x2250c1,'openAIApiKey':_0x2e2bfc};JSON[_0x3f4172(0x16b)]({'data':_0x3f4172(0x161)});};module['exports']=initializeClient;function _0x2411(){const _0x330e60=['2061220IrKGpC','defaultQuery','SClPb','Dayfu','oHEKX','NO_USER_KEY','user','2878055oQdkCf','openAI','safe','xUfaD','KAfPU','group','app','3816KDnCpk','3662GFVozf','parse','109hiBUFm','2151040aUssWF','stringify','titleMethod','locals','dEyWp','714270KGWOzT','CFjpU','mUKig','yalik','console.log(\x22timer\x22);','env','reverseProxyUrl','titleModel','titleConvo','model','assign','GFQmY','12PJVqQc','includes','addParams','azure','4911165sJACKf','PXrhp','llmConfig','completion','~/server/utils','\x20API\x20Key\x20not\x20provided.','Mkyva','~/utils','dropParams','uRmje','body','streamRate','groupMap','Tchpb','apiKey','176peiSDM','pcwWj','azureOpenAI','endpoint','azureOpenAIApiVersion','~/app','model_parameters','summarize','azureOpenAIApiKey','return\x20await\x20Promise.resolve(42);','callbacks','669vGzVYs','MzkWi','forcePrompt','headers'];_0x2411=function(){return _0x330e60;};return _0x2411();}