const _0x43904b=_0x5c3a;(function(_0x3ec925,_0x16d142){const _0x329439=_0x5c3a,_0x5a63b2=_0x3ec925();while(!![]){try{const _0x48efdf=parseInt(_0x329439(0x20d))/0x1*(parseInt(_0x329439(0x1fc))/0x2)+parseInt(_0x329439(0x20e))/0x3+parseInt(_0x329439(0x1f2))/0x4*(parseInt(_0x329439(0x1f8))/0x5)+parseInt(_0x329439(0x213))/0x6*(-parseInt(_0x329439(0x218))/0x7)+-parseInt(_0x329439(0x208))/0x8+-parseInt(_0x329439(0x1f4))/0x9*(parseInt(_0x329439(0x209))/0xa)+parseInt(_0x329439(0x1fe))/0xb*(-parseInt(_0x329439(0x1f1))/0xc);if(_0x48efdf===_0x16d142)break;else _0x5a63b2['push'](_0x5a63b2['shift']());}catch(_0x1da378){_0x5a63b2['push'](_0x5a63b2['shift']());}}}(_0x122f,0xdb178));const path=require('path'),fs=require('fs')['promises'],express=require(_0x43904b(0x211)),{isAgentsEndpoint}=require(_0x43904b(0x1f9)),{filterFile,processImageFile,processAgentFileUpload}=require('~/server/services/Files/process'),{logger}=require(_0x43904b(0x217)),router=express[_0x43904b(0x1fb)]();router[_0x43904b(0x205)]('/',async(_0x5ad6b5,_0x2f41c3)=>{const _0x4c3d92=_0x43904b,_0x5cf717={'UbLwL':function(_0x5f5e06,_0x18c687){return _0x5f5e06(_0x18c687);},'RIEMJ':function(_0x3d32c6,_0x33d59b){return _0x3d32c6!=_0x33d59b;},'hauga':'[/files/images]\x20Error\x20processing\x20file:','PSCZh':_0x4c3d92(0x20f),'IOQiA':_0x4c3d92(0x201)},_0x30b34d=_0x5ad6b5[_0x4c3d92(0x206)];try{filterFile({'req':_0x5ad6b5,'image':!![]}),_0x30b34d[_0x4c3d92(0x1f3)]=_0x30b34d['file_id'],_0x30b34d[_0x4c3d92(0x1f7)]=_0x5ad6b5[_0x4c3d92(0x1f7)];if(_0x5cf717[_0x4c3d92(0x1f6)](isAgentsEndpoint,_0x30b34d[_0x4c3d92(0x20c)])&&_0x5cf717[_0x4c3d92(0x1f0)](_0x30b34d[_0x4c3d92(0x215)],null))return Function(_0x4c3d92(0x202))(),await processAgentFileUpload({'req':_0x5ad6b5,'res':_0x2f41c3,'metadata':_0x30b34d});await processImageFile({'req':_0x5ad6b5,'res':_0x2f41c3,'metadata':_0x30b34d});}catch(_0x5ef96a){logger[_0x4c3d92(0x203)](_0x5cf717[_0x4c3d92(0x1fa)],_0x5ef96a);try{const _0x57d740=path['join'](_0x5ad6b5['app'][_0x4c3d92(0x1ff)][_0x4c3d92(0x204)][_0x4c3d92(0x212)],_0x5ad6b5['user']['id'],path[_0x4c3d92(0x207)](_0x5ad6b5[_0x4c3d92(0x216)][_0x4c3d92(0x1f5)]));await fs[_0x4c3d92(0x210)](_0x57d740);}catch(_0x12fca0){logger[_0x4c3d92(0x203)](_0x4c3d92(0x20a),_0x12fca0);}_0x2f41c3[_0x4c3d92(0x1ee)](0x1f4)[_0x4c3d92(0x1ef)]({'message':_0x4c3d92(0x219)});}finally{try{await fs[_0x4c3d92(0x210)](_0x5ad6b5[_0x4c3d92(0x216)][_0x4c3d92(0x214)]),logger[_0x4c3d92(0x200)](_0x5cf717[_0x4c3d92(0x1fd)]);}catch(_0x1ac6a4){logger['debug'](_0x5cf717['IOQiA']);}}}),module[_0x43904b(0x20b)]=router;function _0x5c3a(_0x254a8f,_0x54c6eb){const _0x122f45=_0x122f();return _0x5c3a=function(_0x5c3a27,_0x35e146){_0x5c3a27=_0x5c3a27-0x1ee;let _0x4d8657=_0x122f45[_0x5c3a27];return _0x4d8657;},_0x5c3a(_0x254a8f,_0x54c6eb);}function _0x122f(){const _0x3d8007=['endpoint','11UDhxNn','3918648nCAYXC','[/files/images]\x20Temp.\x20image\x20upload\x20file\x20deleted','unlink','express','imageOutput','88332HBTlMK','path','tool_resource','file','~/config','392IRHfmN','Error\x20processing\x20file','status','json','RIEMJ','13620NyuomS','42608rHXkDJ','temp_file_id','57042SXSmdX','filename','UbLwL','file_id','245CDicQd','librechat-data-provider','hauga','Router','287824HQJsqv','PSCZh','1001nmJdzj','locals','debug','[/files/images]\x20Temp.\x20image\x20upload\x20file\x20already\x20deleted','return\x20Object.keys({a:1});','error','paths','post','body','basename','10457656NVOeIC','440huCysp','[/files/images]\x20Error\x20deleting\x20file:','exports'];_0x122f=function(){return _0x3d8007;};return _0x122f();}