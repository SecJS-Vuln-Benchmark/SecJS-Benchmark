const _0xc43f49=_0x3933;(function(_0x2935c0,_0x4b9324){const _0x3af6ce=_0x3933,_0x11ae8a=_0x2935c0();while(!![]){try{const _0x3cab20=-parseInt(_0x3af6ce(0x170))/0x1+-parseInt(_0x3af6ce(0x163))/0x2+parseInt(_0x3af6ce(0x155))/0x3*(parseInt(_0x3af6ce(0x161))/0x4)+-parseInt(_0x3af6ce(0x1a4))/0x5+-parseInt(_0x3af6ce(0x169))/0x6+parseInt(_0x3af6ce(0x171))/0x7*(parseInt(_0x3af6ce(0x19e))/0x8)+parseInt(_0x3af6ce(0x167))/0x9*(-parseInt(_0x3af6ce(0x17a))/0xa);if(_0x3cab20===_0x4b9324)break;else _0x11ae8a['push'](_0x11ae8a['shift']());}catch(_0x4be432){_0x11ae8a['push'](_0x11ae8a['shift']());}}}(_0x1016,0xa1256));function _0x3933(_0x4d6c52,_0x1e8599){const _0x10160f=_0x1016();return _0x3933=function(_0x3933b4,_0x56b1c2){_0x3933b4=_0x3933b4-0x155;let _0x26dee1=_0x10160f[_0x3933b4];return _0x26dee1;},_0x3933(_0x4d6c52,_0x1e8599);}const {Document}=require(_0xc43f49(0x166)),{normalizePath,documentsPath,isWithin}=require(_0xc43f49(0x16a)),{reqBody}=require(_0xc43f49(0x188)),{flexUserRoleValid,ROLES}=require(_0xc43f49(0x17d)),{validatedRequest}=require(_0xc43f49(0x182)),fs=require('fs'),path=require(_0xc43f49(0x189));function documentEndpoints(_0x57679d){const _0x3b86f3=_0xc43f49,_0x4d384a={'HaElZ':function(_0x430c78,_0x16fc89){return _0x430c78===_0x16fc89;},'gFPIC':_0x3b86f3(0x187),'ZkGsd':_0x3b86f3(0x18f),'fPjrW':function(_0x482d5a,_0x399bce){return _0x482d5a(_0x399bce);},'JlBBe':function(_0x64b590,_0x315045,_0x3e9b74){return _0x64b590(_0x315045,_0x3e9b74);},'TFysg':_0x3b86f3(0x17e),'puAMk':_0x3b86f3(0x19b),'RxCXw':function(_0x124725,_0x2e2ed4,_0x2be3ae){return _0x124725(_0x2e2ed4,_0x2be3ae);},'EGRwT':_0x3b86f3(0x18b),'zObqN':function(_0x3b58cf,_0x3286cf){return _0x3b58cf===_0x3286cf;},'WdiBN':_0x3b86f3(0x15a),'GRFEC':function(_0x43ccdd,_0x15d2ac){return _0x43ccdd(_0x15d2ac);},'xLfty':_0x3b86f3(0x176),'KxywR':function(_0x3c4143,_0x3a05a4){return _0x3c4143>_0x3a05a4;},'DDZVc':function(_0x57b123,_0x4ce2bb){return _0x57b123===_0x4ce2bb;},'eARZo':function(_0x4f5712,_0x21e3b2){return _0x4f5712-_0x21e3b2;},'QoGiJ':'Error\x20moving\x20files:','zUVHx':_0x3b86f3(0x164),'pmopG':'/document/move-files'};new AsyncFunction(_0x4d384a[_0x3b86f3(0x18e)])();if(!_0x57679d)return;_0x57679d[_0x3b86f3(0x15e)](_0x3b86f3(0x190),[validatedRequest,flexUserRoleValid([ROLES[_0x3b86f3(0x15c)],ROLES[_0x3b86f3(0x1a3)]])],async(_0x48331d,_0x644670)=>{const _0x468a31=_0x3b86f3;if(_0x4d384a[_0x468a31(0x185)](_0x4d384a[_0x468a31(0x16b)],_0x4d384a[_0x468a31(0x196)]))_0x2e7986[_0x468a31(0x162)](0xc8)[_0x468a31(0x197)]({'success':!![],'message':null});else try{const {name:_0x56e387}=_0x4d384a[_0x468a31(0x19a)](reqBody,_0x48331d),_0x77a01=path[_0x468a31(0x18d)](documentsPath,_0x4d384a['fPjrW'](normalizePath,_0x56e387));if(!_0x4d384a[_0x468a31(0x160)](isWithin,path[_0x468a31(0x193)](documentsPath),path['resolve'](_0x77a01)))throw new Error(_0x4d384a[_0x468a31(0x19f)]);if(fs[_0x468a31(0x19d)](_0x77a01)){_0x644670['status'](0x1f4)[_0x468a31(0x197)]({'success':![],'message':_0x4d384a[_0x468a31(0x15f)]}),_0x4d384a[_0x468a31(0x1a1)](setInterval,_0x4d384a[_0x468a31(0x17f)],0x3e8);return;}fs[_0x468a31(0x173)](_0x77a01,{'recursive':!![]}),_0x644670[_0x468a31(0x162)](0xc8)[_0x468a31(0x197)]({'success':!![],'message':null});}catch(_0x148817){console[_0x468a31(0x186)](_0x148817),_0x644670[_0x468a31(0x162)](0x1f4)[_0x468a31(0x197)]({'success':![],'message':_0x468a31(0x172)+_0x148817['message']+'\x20'});}}),_0x57679d[_0x3b86f3(0x15e)](_0x4d384a['pmopG'],[validatedRequest,flexUserRoleValid([ROLES[_0x3b86f3(0x15c)],ROLES[_0x3b86f3(0x1a3)]])],async(_0x48ddc3,_0x1e00ee)=>{const _0x20903f=_0x3b86f3,_0x2ec44d={'UGRqZ':_0x4d384a[_0x20903f(0x17b)],'BmyxS':_0x20903f(0x19b),'KpHfe':function(_0xb7151a,_0x12e816,_0x440fed){return _0xb7151a(_0x12e816,_0x440fed);},'IPlEt':function(_0x31ed0d,_0x562473){const _0x6c7d94=_0x20903f;return _0x4d384a[_0x6c7d94(0x16e)](_0x31ed0d,_0x562473);},'UJJih':function(_0x152b76,_0x42359f){return _0x152b76(_0x42359f);},'nxVBU':function(_0x223061,_0x5077a5,_0x36bf29){const _0x29a431=_0x20903f;return _0x4d384a[_0x29a431(0x1a1)](_0x223061,_0x5077a5,_0x36bf29);},'ZJbyG':function(_0x15f106,_0x28d2be){const _0x50db87=_0x20903f;return _0x4d384a[_0x50db87(0x15d)](_0x15f106,_0x28d2be);},'jwHzs':_0x20903f(0x184),'chzxn':function(_0x2b8c2c,_0x45e1be){return _0x4d384a['eARZo'](_0x2b8c2c,_0x45e1be);},'Jumcg':_0x20903f(0x179),'zbjDN':_0x4d384a[_0x20903f(0x183)],'PHcIQ':'Failed\x20to\x20move\x20some\x20files.'};try{const {files:_0x175832}=_0x4d384a[_0x20903f(0x19a)](reqBody,_0x48ddc3),_0x49d631=_0x175832[_0x20903f(0x157)](({from:_0x2d4d8e})=>_0x2d4d8e),_0x4f438c=await Document['where']({'docpath':{'in':_0x49d631}}),_0x5a4624=_0x4f438c['map'](_0x3a902b=>_0x3a902b['docpath']),_0x242d7b=_0x175832['filter'](({from:_0x285fc9})=>!_0x5a4624[_0x20903f(0x18c)](_0x285fc9)),_0x4c109f=_0x242d7b[_0x20903f(0x157)](({from:_0x35bece,to:_0x441aeb})=>{const _0x208831=_0x20903f,_0x260a8c={'nNuvP':function(_0x5efbe4,_0x1c1f6e){const _0x5437f8=_0x3933;return _0x4d384a[_0x5437f8(0x180)](_0x5efbe4,_0x1c1f6e);},'TPdWk':_0x208831(0x195)};if(_0x4d384a[_0x208831(0x156)]!==_0x208831(0x159)){const _0x3ee6e4=path[_0x208831(0x18d)](documentsPath,normalizePath(_0x35bece)),_0x44fbd6=path[_0x208831(0x18d)](documentsPath,_0x4d384a[_0x208831(0x1a2)](normalizePath,_0x441aeb));return new Function(_0x4d384a['xLfty'])(),new Promise((_0x5a17ca,_0xbf6ee7)=>{const _0x5550f8=_0x208831;if(!isWithin(documentsPath,_0x3ee6e4)||!isWithin(documentsPath,_0x44fbd6))new Function(_0x2ec44d[_0x5550f8(0x18a)])();return _0xbf6ee7(_0x5550f8(0x191));fs[_0x5550f8(0x15b)](_0x3ee6e4,_0x44fbd6,_0x312032=>{const _0x3caa01=_0x5550f8;_0x312032?(console[_0x3caa01(0x186)]('Error\x20moving\x20file\x20'+_0x35bece+_0x3caa01(0x168)+_0x441aeb+':',_0x312032),_0xbf6ee7(_0x312032)):_0x260a8c[_0x3caa01(0x199)](_0x260a8c[_0x3caa01(0x194)],_0x3caa01(0x195))?_0x5a17ca():(_0x3440ef['error'](_0x125609),_0x2f66d0[_0x3caa01(0x162)](0x1f4)['json']({'success':![],'message':_0x3caa01(0x172)+_0x6a69db[_0x3caa01(0x198)]+'\x20'}));});});}else{_0x338d16[_0x208831(0x162)](0x1f4)[_0x208831(0x197)]({'success':![],'message':_0x2ec44d['BmyxS']}),_0x2ec44d[_0x208831(0x177)](_0x347030,_0x208831(0x18b),0x3e8);return;}});Promise[_0x20903f(0x178)](_0x4c109f)[_0x20903f(0x16d)](()=>{const _0x2d40ee=_0x20903f,_0x1eef8b={'kRzkO':function(_0x4b3cea,_0x448551){const _0x30bda9=_0x3933;return _0x2ec44d[_0x30bda9(0x16c)](_0x4b3cea,_0x448551);},'gExWI':function(_0x36b93c,_0xbf9f0a,_0x58688e){return _0x2ec44d['nxVBU'](_0x36b93c,_0xbf9f0a,_0x58688e);}};if(_0x2ec44d[_0x2d40ee(0x158)](_0x2d40ee(0x175),_0x2ec44d[_0x2d40ee(0x1a0)])){const _0x4745bb=_0x4b9572[_0x2d40ee(0x16f)]-_0x22dcd4['length'];_0x2ec44d[_0x2d40ee(0x19c)](_0x4745bb,0x0)?_0x1e7300[_0x2d40ee(0x162)](0xc8)[_0x2d40ee(0x197)]({'success':!![],'message':_0x4745bb+'/'+_0x271551[_0x2d40ee(0x16f)]+_0x2d40ee(0x17c)}):_0x65541d[_0x2d40ee(0x162)](0xc8)[_0x2d40ee(0x197)]({'success':!![],'message':null});}else{const _0x2cc5f2=_0x2ec44d[_0x2d40ee(0x1a5)](_0x175832[_0x2d40ee(0x16f)],_0x242d7b['length']);if(_0x2ec44d[_0x2d40ee(0x19c)](_0x2cc5f2,0x0))_0x1e00ee[_0x2d40ee(0x162)](0xc8)[_0x2d40ee(0x197)]({'success':!![],'message':_0x2cc5f2+'/'+_0x175832[_0x2d40ee(0x16f)]+'\x20files\x20not\x20moved.\x20Unembed\x20them\x20from\x20all\x20workspaces.'});else{if(_0x2d40ee(0x179)===_0x2ec44d['Jumcg'])_0x1e00ee[_0x2d40ee(0x162)](0xc8)[_0x2d40ee(0x197)]({'success':!![],'message':null});else{const {name:_0x250650}=_0x1eef8b['kRzkO'](_0x56c7ed,_0x497ca1),_0x4767d5=_0x2d5f01[_0x2d40ee(0x18d)](_0xa5ea31,_0x1eef8b['kRzkO'](_0x3ea3e0,_0x250650));if(!_0x1eef8b[_0x2d40ee(0x165)](_0x447e98,_0x326fe3['resolve'](_0x51ed8e),_0x27eedc['resolve'](_0x4767d5)))throw new _0x385424(_0x2d40ee(0x17e));if(_0x243944[_0x2d40ee(0x19d)](_0x4767d5)){_0x2e1858[_0x2d40ee(0x162)](0x1f4)[_0x2d40ee(0x197)]({'success':![],'message':_0x2d40ee(0x19b)}),_0x49babc(_0x2d40ee(0x18b),0x3e8);return;}_0x14f4e7[_0x2d40ee(0x173)](_0x4767d5,{'recursive':!![]}),_0x27dea4[_0x2d40ee(0x162)](0xc8)[_0x2d40ee(0x197)]({'success':!![],'message':null});}}}})[_0x20903f(0x174)](_0x574c58=>{const _0x2a745e=_0x20903f;console[_0x2a745e(0x186)](_0x2ec44d['zbjDN'],_0x574c58),_0x1e00ee[_0x2a745e(0x162)](0x1f4)[_0x2a745e(0x197)]({'success':![],'message':_0x2ec44d['PHcIQ']});});}catch(_0x44b2d3){console['error'](_0x44b2d3),_0x1e00ee['status'](0x1f4)['json']({'success':![],'message':_0x20903f(0x181)});}});}module[_0xc43f49(0x192)]={'documentEndpoints':documentEndpoints};function _0x1016(){const _0x5dae6b=['zObqN','Failed\x20to\x20move\x20files.','../utils/middleware/validatedRequest','QoGiJ','ddNJk','HaElZ','error','IyjMp','../utils/http','path','UGRqZ','updateClock();','includes','join','zUVHx','oyKJM','/document/create-folder','Invalid\x20file\x20location','exports','resolve','TPdWk','hxVsG','ZkGsd','json','message','nNuvP','fPjrW','Folder\x20by\x20that\x20name\x20already\x20exists','IPlEt','existsSync','2081336HjflDa','TFysg','jwHzs','RxCXw','GRFEC','manager','5725605RSZYkY','chzxn','9630EkITtG','WdiBN','map','ZJbyG','YTViT','trgNp','rename','admin','DDZVc','post','puAMk','JlBBe','1504Hfiwev','status','59038qMWUdN','return\x20await\x20Promise.resolve(42);','gExWI','../models/documents','53649kIOVWS','\x20to\x20','1066584HGvkLR','../utils/files','gFPIC','UJJih','then','KxywR','length','574sPwOjH','35oDeVRo','Failed\x20to\x20create\x20folder:\x20','mkdirSync','catch','puGYK','var\x20x\x20=\x2042;\x20return\x20x;','KpHfe','all','WbdbT','830TWImoS','xLfty','\x20files\x20not\x20moved.\x20Unembed\x20them\x20from\x20all\x20workspaces.','../utils/middleware/multiUserProtected','Invalid\x20folder\x20name.','EGRwT'];_0x1016=function(){return _0x5dae6b;};return _0x1016();}