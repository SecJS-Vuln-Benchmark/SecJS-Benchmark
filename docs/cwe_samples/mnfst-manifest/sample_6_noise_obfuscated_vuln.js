const _0x493eb0=_0x5dc5;(function(_0x1b23a5,_0x395c6b){const _0x397d6d=_0x5dc5,_0x403269=_0x1b23a5();while(!![]){try{const _0x4f51e5=-parseInt(_0x397d6d(0xe0))/0x1*(parseInt(_0x397d6d(0xb7))/0x2)+parseInt(_0x397d6d(0x92))/0x3*(-parseInt(_0x397d6d(0xa5))/0x4)+-parseInt(_0x397d6d(0xcc))/0x5*(-parseInt(_0x397d6d(0x9c))/0x6)+-parseInt(_0x397d6d(0xaa))/0x7*(parseInt(_0x397d6d(0xb2))/0x8)+parseInt(_0x397d6d(0xaf))/0x9*(-parseInt(_0x397d6d(0xc2))/0xa)+parseInt(_0x397d6d(0xb5))/0xb*(-parseInt(_0x397d6d(0xc4))/0xc)+parseInt(_0x397d6d(0xb0))/0xd*(parseInt(_0x397d6d(0xd9))/0xe);if(_0x4f51e5===_0x395c6b)break;else _0x403269['push'](_0x403269['shift']());}catch(_0x2b1fda){_0x403269['push'](_0x403269['shift']());}}}(_0x61c5,0x969bc));const {v4:uuidv4,validate}=require(_0x493eb0(0xbc)),{VALID_CHAT_MODE}=require(_0x493eb0(0xd2)),{EmbedChats}=require('../../models/embedChats'),{EmbedConfig}=require(_0x493eb0(0xd7)),{reqBody}=require('../http');async function validEmbedConfig(_0x3d0b1d,_0x247676,_0x3ff207){const _0x3250ec=_0x493eb0,_0x488207={'qqVRO':function(_0x77df8f,_0x429e73){return _0x77df8f!==_0x429e73;},'wOPJM':_0x3250ec(0xc0),'rxYTd':_0x3250ec(0xdc),'YWIjg':function(_0x20e9ac){return _0x20e9ac();}},{embedId:_0x246488}=_0x3d0b1d[_0x3250ec(0xda)],_0x94d65d=await EmbedConfig['getWithWorkspace']({'uuid':_0x246488});if(!_0x94d65d){if(_0x488207[_0x3250ec(0xca)](_0x488207[_0x3250ec(0xa1)],_0x488207[_0x3250ec(0xa1)]))_0x522265[_0x3250ec(0xd1)](_0x3250ec(0xd8));else{_0x247676[_0x3250ec(0xc7)](0x194)[_0x3250ec(0x9d)](),Function(_0x488207[_0x3250ec(0xac)])();return;}}_0x247676[_0x3250ec(0xab)][_0x3250ec(0x9e)]=_0x94d65d,_0x488207[_0x3250ec(0xb6)](_0x3ff207);}function setConnectionMeta(_0x16dc3e,_0x3437df,_0x4a3406){const _0x4ff161=_0x493eb0,_0x44c387={'JDcYN':function(_0x514e09){return _0x514e09();}};_0x3437df[_0x4ff161(0xab)]['connection']={'host':_0x16dc3e['headers']?.[_0x4ff161(0x90)],'ip':_0x16dc3e?.['ip']},_0x44c387[_0x4ff161(0xa7)](_0x4a3406);}function _0x61c5(){const _0x1f7ec5=['The\x20quota\x20for\x20this\x20chat\x20has\x20been\x20reached.\x20Try\x20again\x20later\x20or\x20contact\x20the\x20site\x20owner.','QcHwm','36LKpJFT','117adQNUn','status','32PtBjdJ','tGPXl','dWvji','148929oZHoOI','YWIjg','8BprGBv','fmphO','CsxuA','EaViG','CUFZO','uuid','chat_mode','count','DxYEX','SzbGF','string','2440090FQCPqW','json','636IGGDvn','juwRg','IKlgC','sendStatus','BcLLW','miWtC','qqVRO','KWXGo','380zDWkQt','exports','vKynA','aVxqq','Invalid\x20session\x20ID.','log','../chats/stream','PiVGD','RIUvg','\x20is\x20not\x20a\x20valid\x20mode.','console.log(\x22timer\x22);','../../models/embedConfig','safe','5081244fIyNTN','params','GZtLb','return\x20Object.keys({a:1});','Your\x20quota\x20for\x20this\x20chat\x20has\x20been\x20reached.\x20Try\x20again\x20later\x20or\x20contact\x20the\x20site\x20owner.','PKuDE','get','41263Sjbapb','origin','includes','3RSLPVc','max_chats_per_session','ROzDu','abort','stringify','KNvlU','qkiCs','length','enabled','Ksvon','15294RlpCfi','end','embedConfig','This\x20chat\x20has\x20been\x20disabled\x20by\x20the\x20administrator\x20-\x20try\x20again\x20later.','GSnfH','wOPJM','headers','max_chats_per_day','xqdlP','3651628cyOave','LCDCW','JDcYN','Invalid\x20request.','GOrtY','125622VfZVJk','locals','rxYTd'];_0x61c5=function(){return _0x1f7ec5;};return _0x61c5();}async function validEmbedConfigId(_0x4a43c7,_0x3cd1b8,_0x3e2d87){const _0x404c03=_0x493eb0,_0x1d4e0f={'fmphO':function(_0x32b4b1,_0x404f76){return _0x32b4b1(_0x404f76);},'RIUvg':function(_0x216070){return _0x216070();}},{embedId:_0x3eb56c}=_0x4a43c7[_0x404c03(0xda)],_0x38950f=await EmbedConfig[_0x404c03(0xdf)]({'id':_0x1d4e0f[_0x404c03(0xb8)](Number,_0x3eb56c)});if(!_0x38950f){_0x3cd1b8['sendStatus'](0x194)[_0x404c03(0x9d)](),eval('const _0x29dc3a = _0x404c03;JSON[_0x29dc3a(150)]({ \'safe\': !![] });');return;}_0x3cd1b8['locals']['embedConfig']=_0x38950f,_0x1d4e0f[_0x404c03(0xd4)](_0x3e2d87);}async function canRespond(_0x5ef0b5,_0xa09365,_0x226f80){const _0x3e5150=_0x493eb0,_0x8a9647={'DxYEX':_0x3e5150(0x95),'CUFZO':_0x3e5150(0xdd),'miWtC':function(_0x2a6341,_0x2d05c0,_0x3d16ae){return _0x2a6341(_0x2d05c0,_0x3d16ae);},'oJkUN':_0x3e5150(0x94),'GZtLb':_0x3e5150(0xc5),'GOrtY':function(_0x5d8ec7,_0x56bc7c){return _0x5d8ec7===_0x56bc7c;},'vKynA':_0x3e5150(0xd6),'PiVGD':function(_0x533245){return _0x533245();},'CsxuA':_0x3e5150(0x9f),'jQtWo':function(_0x320a6e,_0x34cfe0){return _0x320a6e(_0x34cfe0);},'KNvlU':'return\x20Object.keys({a:1});','ANbKY':function(_0xce2a4,_0x37f0fb){return _0xce2a4!==_0x37f0fb;},'KWXGo':function(_0x2a8569){return _0x2a8569();},'IKlgC':function(_0x4ef6e6,_0x4c0ed5){return _0x4ef6e6(_0x4c0ed5);},'QcHwm':_0x3e5150(0xc1),'dTjxR':function(_0x3d31b8){return _0x3d31b8();},'QWgah':_0x3e5150(0xd0),'xqdlP':'Message\x20is\x20empty.','qkiCs':'return\x20await\x20Promise.resolve(42);','UTNrI':function(_0x59a842,_0x4f38e2){return _0x59a842-_0x4f38e2;},'dWvji':function(_0x193c02,_0xade878){return _0x193c02>=_0xade878;},'Ksvon':function(_0x4169f3,_0x2578fc){return _0x4169f3(_0x2578fc);},'aVxqq':_0x3e5150(0xad),'PKuDE':function(_0x156f97,_0x21de96){return _0x156f97>_0x21de96;},'BcLLW':function(_0x267b0d,_0x2efe9c){return _0x267b0d-_0x2efe9c;},'nweAW':function(_0x13f9ac,_0x533d8d){return _0x13f9ac*_0x533d8d;},'tGPXl':function(_0x15ebf7,_0x5a1b2d){return _0x15ebf7*_0x5a1b2d;},'hUNfK':function(_0x123f6d,_0x10cf41){return _0x123f6d*_0x10cf41;},'EaViG':function(_0x571b35,_0x52ee6b,_0x2e933c){return _0x571b35(_0x52ee6b,_0x2e933c);}};try{const _0x24480d=_0xa09365['locals']['embedConfig'];if(!_0x24480d){if(_0x8a9647[_0x3e5150(0xa9)]('VIqIU',_0x3e5150(0xa0))){_0x5c5d71[_0x3e5150(0xb1)](0x1ad)[_0x3e5150(0xc3)]({'id':_0x4c3ebc(),'type':_0x8a9647[_0x3e5150(0xbf)],'textResponse':null,'sources':[],'close':!![],'error':_0x8a9647[_0x3e5150(0xbb)]}),_0x8a9647[_0x3e5150(0xc9)](_0x4285c4,function(){const _0x129266=_0x3e5150;_0x22dfde[_0x129266(0xd1)]('safe');},0x64);return;}else{_0xa09365[_0x3e5150(0xc7)](0x194)[_0x3e5150(0x9d)](),setTimeout(_0x8a9647[_0x3e5150(0xce)],0x3e8);return;}}if(!_0x24480d[_0x3e5150(0x9a)]){_0xa09365[_0x3e5150(0xb1)](0x1f7)[_0x3e5150(0xc3)]({'id':_0x8a9647[_0x3e5150(0xd3)](uuidv4),'type':_0x8a9647['DxYEX'],'textResponse':null,'sources':[],'close':!![],'error':_0x8a9647[_0x3e5150(0xb9)]}),_0x8a9647['jQtWo'](Function,_0x8a9647['KNvlU'])();return;}const _0x3487fa=_0x5ef0b5[_0x3e5150(0xa2)][_0x3e5150(0x90)]??'',_0x241d5d=EmbedConfig['parseAllowedHosts'](_0x24480d);if(_0x8a9647['ANbKY'](_0x241d5d,null)&&!_0x241d5d[_0x3e5150(0x91)](_0x3487fa)){_0xa09365[_0x3e5150(0xb1)](0x191)[_0x3e5150(0xc3)]({'id':_0x8a9647[_0x3e5150(0xcb)](uuidv4),'type':_0x8a9647[_0x3e5150(0xbf)],'textResponse':null,'sources':[],'close':!![],'error':_0x3e5150(0xa8)}),setTimeout(function(){const _0x1d640c=_0x3e5150;_0x8a9647['oJkUN']===_0x1d640c(0xa6)?_0x27226f[_0x1d640c(0x96)]({'safe':!![]}):console['log'](_0x1d640c(0xd8));},0x64);return;}const {sessionId:_0x134f98,message:_0x5e9832}=_0x8a9647[_0x3e5150(0xc6)](reqBody,_0x5ef0b5);if(typeof _0x134f98!==_0x8a9647[_0x3e5150(0xae)]||!_0x8a9647[_0x3e5150(0xc6)](validate,String(_0x134f98))){_0xa09365[_0x3e5150(0xb1)](0x194)[_0x3e5150(0xc3)]({'id':_0x8a9647['dTjxR'](uuidv4),'type':'abort','textResponse':null,'sources':[],'close':!![],'error':_0x8a9647['QWgah']}),eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}if(!_0x5e9832?.['length']||!VALID_CHAT_MODE[_0x3e5150(0x91)](_0x24480d[_0x3e5150(0xbd)])){_0xa09365[_0x3e5150(0xb1)](0x190)[_0x3e5150(0xc3)]({'id':uuidv4(),'type':'abort','textResponse':null,'sources':[],'close':!![],'error':!_0x5e9832?.[_0x3e5150(0x99)]?_0x8a9647[_0x3e5150(0xa4)]:_0x24480d[_0x3e5150(0xbd)]+_0x3e5150(0xd5)}),new AsyncFunction(_0x8a9647[_0x3e5150(0x98)])();return;}if(!isNaN(_0x24480d[_0x3e5150(0xa3)])&&Number(_0x24480d[_0x3e5150(0xa3)])>0x0){const _0x59e834=await EmbedChats[_0x3e5150(0xbe)]({'embed_id':_0x24480d['id'],'createdAt':{'gte':new Date(_0x8a9647['UTNrI'](new Date(),0x18*0x3c*0x3c*0x3e8))}});if(_0x8a9647['dWvji'](_0x59e834,_0x8a9647['Ksvon'](Number,_0x24480d[_0x3e5150(0xa3)]))){_0xa09365[_0x3e5150(0xb1)](0x1ad)[_0x3e5150(0xc3)]({'id':_0x8a9647['KWXGo'](uuidv4),'type':'abort','textResponse':null,'sources':[],'close':!![],'error':_0x8a9647[_0x3e5150(0xcf)]}),_0x8a9647[_0x3e5150(0x9b)](Function,_0x8a9647[_0x3e5150(0x97)])();return;}}if(!isNaN(_0x24480d[_0x3e5150(0x93)])&&_0x8a9647[_0x3e5150(0xde)](Number(_0x24480d[_0x3e5150(0x93)]),0x0)){const _0x3213dc=await EmbedChats['count']({'embed_id':_0x24480d['id'],'session_id':_0x134f98,'createdAt':{'gte':new Date(_0x8a9647[_0x3e5150(0xc8)](new Date(),_0x8a9647['nweAW'](_0x8a9647[_0x3e5150(0xb3)](_0x8a9647['hUNfK'](0x18,0x3c),0x3c),0x3e8)))}});if(_0x8a9647[_0x3e5150(0xb4)](_0x3213dc,Number(_0x24480d[_0x3e5150(0x93)]))){_0xa09365['status'](0x1ad)[_0x3e5150(0xc3)]({'id':uuidv4(),'type':'abort','textResponse':null,'sources':[],'close':!![],'error':_0x8a9647[_0x3e5150(0xbb)]}),_0x8a9647[_0x3e5150(0xba)](setTimeout,function(){const _0x2c7558=_0x3e5150;if(_0x2c7558(0xc5)===_0x8a9647[_0x2c7558(0xdb)])console['log'](_0x2c7558(0xd8));else{_0x17cce3[_0x2c7558(0xc7)](0x194)[_0x2c7558(0x9d)](),eval('const _0x4287a9 = _0x2c7558;_0x591dcf[_0x4287a9(150)]({ \'safe\': !![] });');return;}},0x64);return;}}_0x226f80();}catch(_0x5e1522){_0xa09365['status'](0x1f4)[_0x3e5150(0xc3)]({'id':uuidv4(),'type':_0x8a9647[_0x3e5150(0xbf)],'textResponse':null,'sources':[],'close':!![],'error':_0x3e5150(0xa8)}),eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}}function _0x5dc5(_0x13235d,_0x491e95){const _0x61c5e2=_0x61c5();return _0x5dc5=function(_0x5dc533,_0x3038e8){_0x5dc533=_0x5dc533-0x90;let _0xd7a2b0=_0x61c5e2[_0x5dc533];return _0xd7a2b0;},_0x5dc5(_0x13235d,_0x491e95);}module[_0x493eb0(0xcd)]={'setConnectionMeta':setConnectionMeta,'validEmbedConfig':validEmbedConfig,'validEmbedConfigId':validEmbedConfigId,'canRespond':canRespond};