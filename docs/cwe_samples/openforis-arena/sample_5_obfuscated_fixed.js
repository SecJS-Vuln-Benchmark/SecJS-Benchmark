'use strict';const _0x3f0cb0=_0x4cb5;function _0x3cd0(){const _0x27d951=['not','expect','sha256','hash','join','CHJPM','D2H5TEwtUgM2u8Ew0gG6vnt/Na6L+Zep7apmSmfy8IQ=','WIXRt','1648qtOvtg','3195345YridEs','HoDbw','../../lib/dkim/relaxed-body','315siFMam','hNYGs','utf-8','write','dPYEP','replace','oorNQ','from','config','equal','uZiUM','RdFfB','RBuTU','EGapu','PIBAl','/fixtures/message1.eml','length','end','gsODC','2974XeCGHD','30681bApgmz','YoiTT','5465436fnWpDr','exist','EWWRh','shift','iPwKQ','pbadx','ShvvD','7329830TdaING','xbYMW','2639876yduAHj','chai','readFile','\x0d\x0a\x0d\x0a','CWQbb','324142TfELUW','split','Uofty','FEVDf','HrmmI','dDMkG'];_0x3cd0=function(){return _0x27d951;};return _0x3cd0();}(function(_0x42c4be,_0x151e25){const _0x511280=_0x4cb5,_0x1ecc16=_0x42c4be();while(!![]){try{const _0x57707a=-parseInt(_0x511280(0x12d))/0x1*(parseInt(_0x511280(0x140))/0x2)+-parseInt(_0x511280(0x12a))/0x3+-parseInt(_0x511280(0x14c))/0x4+parseInt(_0x511280(0x14a))/0x5+parseInt(_0x511280(0x143))/0x6+parseInt(_0x511280(0x151))/0x7+parseInt(_0x511280(0x15f))/0x8*(parseInt(_0x511280(0x141))/0x9);if(_0x57707a===_0x151e25)break;else _0x1ecc16['push'](_0x1ecc16['shift']());}catch(_0x39fe79){_0x1ecc16['push'](_0x1ecc16['shift']());}}}(_0x3cd0,0xe3867));const chai=require(_0x3f0cb0(0x14d)),expect=chai[_0x3f0cb0(0x158)];function _0x4cb5(_0x510baa,_0xa5e0cd){const _0x3cd0ff=_0x3cd0();return _0x4cb5=function(_0x4cb52b,_0x32fd70){_0x4cb52b=_0x4cb52b-0x12a;let _0xf677d5=_0x3cd0ff[_0x4cb52b];return _0xf677d5;},_0x4cb5(_0x510baa,_0xa5e0cd);}let fs=require('fs'),RelaxedBody=require(_0x3f0cb0(0x12c));chai[_0x3f0cb0(0x135)]['includeStack']=!![],describe('DKIM\x20RelaxedBody\x20Tests',function(){const _0x45904d=_0x3f0cb0,_0xe089d3={'xbYMW':function(_0x539728,_0x56b3f3){return _0x539728(_0x56b3f3);},'oorNQ':function(_0x18276d,_0x1e859c){return _0x18276d>=_0x1e859c;},'RBuTU':_0x45904d(0x15a),'EGapu':_0x45904d(0x13c),'FEVDf':function(_0x30c9f2,_0x45cc18){return _0x30c9f2===_0x45cc18;},'YoiTT':_0x45904d(0x15e),'CWQbb':_0x45904d(0x14f),'TdXdu':_0x45904d(0x159),'CHJPM':function(_0x59def7){return _0x59def7();},'HrmmI':_0x45904d(0x12f),'pbadx':'Should\x20calculate\x20body\x20hash\x20byte\x20by\x20byte','crTGe':function(_0x3ea0be,_0x2c3d59,_0x585c69){return _0x3ea0be(_0x2c3d59,_0x585c69);}};it(_0xe089d3[_0x45904d(0x148)],function(_0x1bda1e){const _0x5d0770=_0x45904d,_0x20ced5={'dDMkG':function(_0x5984f0,_0x381d7a){const _0x4bc621=_0x4cb5;return _0xe089d3[_0x4bc621(0x14b)](_0x5984f0,_0x381d7a);},'Uofty':function(_0x178236){return _0x178236();},'rxvlh':function(_0x2c3fc7,_0x3c37c2){const _0x402dad=_0x4cb5;return _0xe089d3[_0x402dad(0x133)](_0x2c3fc7,_0x3c37c2);},'uZiUM':_0x5d0770(0x14f),'PIBAl':_0xe089d3[_0x5d0770(0x139)]};fs[_0x5d0770(0x14e)](__dirname+_0xe089d3[_0x5d0770(0x13a)],'utf-8',(_0x4d8c05,_0x39a7f8)=>{const _0x3f844b=_0x5d0770,_0x299104={'ShvvD':function(_0x5adb31,_0x2d27b5){return _0x20ced5['rxvlh'](_0x5adb31,_0x2d27b5);}};expect(_0x4d8c05)['to'][_0x3f844b(0x157)][_0x3f844b(0x144)],_0x39a7f8=_0x39a7f8[_0x3f844b(0x132)](/\r?\n/g,'\x0d\x0a'),_0x39a7f8=_0x39a7f8[_0x3f844b(0x152)](_0x20ced5[_0x3f844b(0x137)]),_0x39a7f8[_0x3f844b(0x146)](),_0x39a7f8=_0x39a7f8['join'](_0x20ced5[_0x3f844b(0x137)]),_0x39a7f8=Buffer[_0x3f844b(0x134)](_0x39a7f8);let _0x54d925=new RelaxedBody({'hashAlgo':_0x3f844b(0x159),'debug':!![]});_0x54d925['on'](_0x20ced5[_0x3f844b(0x13b)],_0x3dcc61=>{const _0x349a52=_0x3f844b;_0x20ced5[_0x349a52(0x156)](expect,_0x3dcc61)['to']['equal']('D2H5TEwtUgM2u8Ew0gG6vnt/Na6L+Zep7apmSmfy8IQ='),_0x20ced5[_0x349a52(0x153)](_0x1bda1e);});let _0x3859d3=0x0,_0xd05ca0=()=>{const _0x37753b=_0x3f844b;if(_0x299104[_0x37753b(0x149)](_0x3859d3,_0x39a7f8['length']))return _0x54d925[_0x37753b(0x13e)]();let _0x27c918=Buffer['from']([_0x39a7f8[_0x3859d3++]]);_0x54d925[_0x37753b(0x130)](_0x27c918),setImmediate(_0xd05ca0);};_0x20ced5['dDMkG'](setImmediate,_0xd05ca0);});}),_0xe089d3['crTGe'](it,'Should\x20calculate\x20body\x20hash\x20all\x20at\x20once',function(_0x138d17){const _0x581a08=_0x45904d,_0x513487={'RdFfB':function(_0x1babf8){const _0x5c139a=_0x4cb5;return _0xe089d3[_0x5c139a(0x15c)](_0x1babf8);},'EWWRh':function(_0x1586db,_0x5650ef){return _0x1586db(_0x5650ef);},'gsODC':_0x581a08(0x15d),'dPYEP':_0x581a08(0x14f),'hNYGs':'sha256'};fs[_0x581a08(0x14e)](__dirname+_0xe089d3['EGapu'],_0xe089d3[_0x581a08(0x155)],(_0x22d10b,_0x3d76fc)=>{const _0x5694de=_0x581a08;if(_0xe089d3[_0x5694de(0x154)]('WIXRt',_0xe089d3[_0x5694de(0x142)])){_0xe089d3['xbYMW'](expect,_0x22d10b)['to']['not'][_0x5694de(0x144)],_0x3d76fc=_0x3d76fc['replace'](/\r?\n/g,'\x0d\x0a'),_0x3d76fc=_0x3d76fc['split'](_0xe089d3[_0x5694de(0x150)]),_0x3d76fc[_0x5694de(0x146)](),_0x3d76fc=_0x3d76fc[_0x5694de(0x15b)](_0xe089d3[_0x5694de(0x150)]),_0x3d76fc=Buffer[_0x5694de(0x134)](_0x3d76fc);let _0x2c3d9f=new RelaxedBody({'hashAlgo':_0xe089d3['TdXdu'],'debug':!![]});_0x2c3d9f['on'](_0xe089d3['RBuTU'],_0x511651=>{const _0x8ac3ea=_0x5694de;expect(_0x511651)['to'][_0x8ac3ea(0x136)](_0x8ac3ea(0x15d)),_0x513487[_0x8ac3ea(0x138)](_0x138d17);}),setImmediate(()=>_0x2c3d9f['end'](_0x3d76fc));}else{const _0x2e3b38={'HoDbw':function(_0x4d32c7,_0x326b99){return _0x513487['EWWRh'](_0x4d32c7,_0x326b99);},'iPwKQ':_0x513487[_0x5694de(0x13f)]};_0x3f41cc(_0x36c5cb)['to'][_0x5694de(0x157)][_0x5694de(0x144)],_0x20197d=_0x5c3b05[_0x5694de(0x132)](/\r?\n/g,'\x0d\x0a'),_0x3a1061=_0x5df94d[_0x5694de(0x152)](_0x513487[_0x5694de(0x131)]),_0x52ee9d[_0x5694de(0x146)](),_0x1dc510=_0x3f666a[_0x5694de(0x15b)](_0x513487[_0x5694de(0x131)]),_0x4beacb=_0x4ba24e[_0x5694de(0x134)](_0x5015fc);let _0x3b6f1b=new _0x29c683({'hashAlgo':_0x513487[_0x5694de(0x12e)],'debug':!![]});_0x3b6f1b['on'](_0x5694de(0x15a),_0x55691c=>{const _0xc3f568=_0x5694de;_0x2e3b38[_0xc3f568(0x12b)](_0x369db7,_0x55691c)['to']['equal'](_0x2e3b38[_0xc3f568(0x147)]),_0x32aff3();});let _0x5af981=0x0,_0x27417e=()=>{const _0x1f00d4=_0x5694de;if(_0x5af981>=_0x4b8d76[_0x1f00d4(0x13d)])return _0x3b6f1b[_0x1f00d4(0x13e)]();let _0xcf93ab=_0x31bf52[_0x1f00d4(0x134)]([_0x4e8ea1[_0x5af981++]]);_0x3b6f1b['write'](_0xcf93ab),_0x2e3b38[_0x1f00d4(0x12b)](_0x19f6cd,_0x27417e);};_0x513487[_0x5694de(0x145)](_0x31b143,_0x27417e);}});});});