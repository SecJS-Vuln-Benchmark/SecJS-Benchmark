'use strict';const _0x6b73f5=_0x149e;function _0x38ab(){const _0x2eb06e=['EBNOo','Utils','58axOCYw','headers','text/plain;x=y','HScOM','message','Host','WWW-Authenticate','supports\x20attributes','MOEHO','returns\x20the\x20correct\x20package\x20version\x20number','2318649CVnhEB','10353230qVUnCr','parseHost()','iyBwW','8000','errors\x20on\x20header\x20too\x20long','IMxIN','zxUnL','experiment','hFFJA','74475JBwqKk','4099802eXGLOg','/resource/4?filter=a','252BnbvBF','instanceof','[123:123:123]','uPVSA','10802vtpfmU','port','RcWsZ','Mfher','equal','VFPwP','test','code','lab','hvcTm','parseAuthorizationHeader','TYEOb','9zAAGVk','EBqMn','parses\x20IPv6\x20headers','returns\x20port\x20443\x20for\x20non\x20tls\x20node\x20request','UgyVA','AclEE','unauthorized','8299360jlUdUm','parseHost','Scheme\x20a=\x22','cvtMC','bWVUE','MXzqY','../package.json','RxORx','Hawk\x20a=\x22b\x22,\x20error=\x22kaboom\x22','../lib','example.com','name','MOjEd','UngDI','utils','POST','vxCoP','output','LXRnE','DBMUk','urASq','[123:123:123]:8000','vlyKq','ECHvY','kaboom','script','ETdVE','4EtnHBL','UZHzH','Hawk\x20error=\x22kaboom\x22','14984244KQXfaf','HEIdA','version'];_0x38ab=function(){return _0x2eb06e;};return _0x38ab();}(function(_0x487c59,_0x1fb53a){const _0x116e8b=_0x149e,_0x3894c2=_0x487c59();while(!![]){try{const _0xf03b21=parseInt(_0x116e8b(0x13d))/0x1*(parseInt(_0x116e8b(0x122))/0x2)+parseInt(_0x116e8b(0x12c))/0x3*(parseInt(_0x116e8b(0x11a))/0x4)+-parseInt(_0x116e8b(0x136))/0x5*(parseInt(_0x116e8b(0x139))/0x6)+-parseInt(_0x116e8b(0x137))/0x7+parseInt(_0x116e8b(0x150))/0x8+parseInt(_0x116e8b(0x149))/0x9*(parseInt(_0x116e8b(0x12d))/0xa)+-parseInt(_0x116e8b(0x11d))/0xb;if(_0xf03b21===_0x1fb53a)break;else _0x3894c2['push'](_0x3894c2['shift']());}catch(_0x646610){_0x3894c2['push'](_0x3894c2['shift']());}}}(_0x38ab,0x8eebc));function _0x149e(_0x2e0307,_0x522c2f){const _0x38ab5e=_0x38ab();return _0x149e=function(_0x149e41,_0x5b56f5){_0x149e41=_0x149e41-0x10b;let _0x1d06a9=_0x38ab5e[_0x149e41];return _0x1d06a9;},_0x149e(_0x2e0307,_0x522c2f);}const Code=require(_0x6b73f5(0x144)),Hawk=require(_0x6b73f5(0x159)),Lab=require(_0x6b73f5(0x145)),Package=require(_0x6b73f5(0x156)),internals={},lab=exports['lab']=Lab[_0x6b73f5(0x118)](),describe=lab[_0x6b73f5(0x134)],it=lab[_0x6b73f5(0x143)],expect=Code['expect'];describe(_0x6b73f5(0x121),()=>{const _0x4e3799=_0x6b73f5,_0x37341d={'hvcTm':_0x4e3799(0x10e),'zxUnL':_0x4e3799(0x124),'UZHzH':function(_0x5195b4,_0x38dbeb){return _0x5195b4(_0x38dbeb);},'vxCoP':function(_0x37431f){return _0x37431f();},'EBNOo':_0x4e3799(0x15a),'TMJqy':_0x4e3799(0x138),'Mfher':'[123:123:123]','AclEE':function(_0x39f94c,_0x6ef30d){return _0x39f94c(_0x6ef30d);},'nkmMT':_0x4e3799(0x127),'AVscJ':_0x4e3799(0x114),'vlyKq':function(_0x1eb4a5){return _0x1eb4a5();},'xbonw':function(_0x2b2252,_0x5128de){return _0x2b2252<_0x5128de;},'VFPwP':function(_0x291388,_0x1440b8){return _0x291388(_0x1440b8);},'uPVSA':function(_0x3820ea,_0x51cbba,_0x6eb553){return _0x3820ea(_0x51cbba,_0x6eb553);},'hFFJA':function(_0x466876,_0x5eaaed,_0x270dbf){return _0x466876(_0x5eaaed,_0x270dbf);},'DBMUk':function(_0x25953d,_0x384672){return _0x25953d<_0x384672;},'MxUtz':_0x4e3799(0x111),'cvtMC':'supports\x20attributes','UngDI':function(_0x4da36d,_0x272b15,_0x3e4b60){return _0x4da36d(_0x272b15,_0x3e4b60);},'urASq':_0x4e3799(0x128),'RxORx':_0x4e3799(0x11c),'TYEOb':_0x4e3799(0x117),'RcWsZ':'Hawk\x20a=\x22b\x22,\x20error=\x22kaboom\x22','dVRWj':function(_0x1fb3f1,_0x4638e7,_0x91b74e){return _0x1fb3f1(_0x4638e7,_0x91b74e);},'MOjEd':'version()'};describe(_0x4e3799(0x12e),()=>{const _0x98ad53=_0x4e3799,_0xa4bce9={'qRIeh':function(_0x5c5599,_0x56291d){return _0x37341d['xbonw'](_0x5c5599,_0x56291d);},'HScOM':function(_0x40eec0,_0x25317d){const _0xeb2391=_0x149e;return _0x37341d[_0xeb2391(0x142)](_0x40eec0,_0x25317d);},'UUEeJ':function(_0x44b163){return _0x44b163();}};_0x37341d['uPVSA'](it,'returns\x20port\x2080\x20for\x20non\x20tls\x20node\x20request',_0x4688d0=>{const _0x5e92b7=_0x149e,_0x53074a={'method':_0x37341d[_0x5e92b7(0x146)],'url':_0x5e92b7(0x138),'headers':{'host':_0x5e92b7(0x15a),'content-type':_0x37341d[_0x5e92b7(0x133)]}};_0x37341d[_0x5e92b7(0x11b)](expect,Hawk[_0x5e92b7(0x10d)][_0x5e92b7(0x151)](_0x53074a,_0x5e92b7(0x127))[_0x5e92b7(0x13e)])['to'][_0x5e92b7(0x141)](0x50),_0x37341d['vxCoP'](_0x4688d0);}),_0x37341d[_0x98ad53(0x13c)](it,_0x98ad53(0x14c),_0x59f6a5=>{const _0x3a1089=_0x98ad53,_0x1fd1eb={'method':_0x3a1089(0x10e),'url':'/resource/4?filter=a','headers':{'host':_0x37341d[_0x3a1089(0x120)],'content-type':_0x37341d['zxUnL']},'connection':{'encrypted':!![]}};_0x37341d[_0x3a1089(0x11b)](expect,Hawk['utils'][_0x3a1089(0x151)](_0x1fd1eb,_0x3a1089(0x127))[_0x3a1089(0x13e)])['to'][_0x3a1089(0x141)](0x1bb),_0x59f6a5();}),_0x37341d[_0x98ad53(0x135)](it,'returns\x20port\x20443\x20for\x20non\x20tls\x20node\x20request\x20(IPv6)',_0x3e2e93=>{const _0xd6037b=_0x98ad53,_0x15b69d={'method':_0x37341d[_0xd6037b(0x146)],'url':_0x37341d['TMJqy'],'headers':{'host':_0x37341d[_0xd6037b(0x140)],'content-type':_0xd6037b(0x124)},'connection':{'encrypted':!![]}};_0x37341d[_0xd6037b(0x14e)](expect,Hawk['utils'][_0xd6037b(0x151)](_0x15b69d,_0x37341d['nkmMT'])['port'])['to'][_0xd6037b(0x141)](0x1bb),_0x3e2e93();}),_0x37341d[_0x98ad53(0x135)](it,_0x98ad53(0x14b),_0x268354=>{const _0x3cc06e=_0x98ad53,_0xb36a60={'method':_0x37341d[_0x3cc06e(0x146)],'url':'/resource/4?filter=a','headers':{'host':_0x37341d['AVscJ'],'content-type':_0x3cc06e(0x124)},'connection':{'encrypted':!![]}},_0x1fc354=Hawk[_0x3cc06e(0x10d)][_0x3cc06e(0x151)](_0xb36a60,_0x3cc06e(0x127));_0x37341d[_0x3cc06e(0x14e)](expect,_0x1fc354[_0x3cc06e(0x13e)])['to']['equal'](_0x3cc06e(0x130)),_0x37341d['UZHzH'](expect,_0x1fc354[_0x3cc06e(0x15b)])['to'][_0x3cc06e(0x141)](_0x3cc06e(0x13b)),_0x37341d[_0x3cc06e(0x115)](_0x268354);}),it(_0x98ad53(0x131),_0x37be8f=>{const _0x46e070=_0x98ad53;let _0x24d28f='';for(let _0x314694=0x0;_0xa4bce9['qRIeh'](_0x314694,0x1388);++_0x314694){_0x24d28f+='x';}_0xa4bce9[_0x46e070(0x125)](expect,Hawk[_0x46e070(0x10d)]['parseHost']({'headers':{'host':_0x24d28f}}))['to']['be']['null'](),_0xa4bce9['UUEeJ'](_0x37be8f);});}),describe('parseAuthorizationHeader()',()=>{const _0x514b0b=_0x4e3799,_0x56dd06={'hKJNl':function(_0x4c70f9,_0xe750b2,_0x209405){return _0x4c70f9(_0xe750b2,_0x209405);},'IMxIN':_0x37341d[_0x514b0b(0x153)]};it('errors\x20on\x20header\x20too\x20long',_0x2fa585=>{const _0x29e129=_0x514b0b,_0x43ec9a={'MOEHO':_0x29e129(0x117),'MXzqY':_0x29e129(0x11c),'ECHvY':function(_0x225ad8){return _0x37341d['vxCoP'](_0x225ad8);},'uaQyq':function(_0x46934e){const _0x2fd06f=_0x29e129;return _0x37341d[_0x2fd06f(0x10f)](_0x46934e);}};let _0x11a543=_0x29e129(0x152);for(let _0x9d21c2=0x0;_0x37341d[_0x29e129(0x112)](_0x9d21c2,0x1388);++_0x9d21c2){_0x37341d['MxUtz']===_0x29e129(0x111)?_0x11a543+='x':(_0x56dd06['hKJNl'](_0x19dd0e,'returns\x20a\x20hawk\x20401',_0xe5d2ed=>{const _0x474a64=_0x29e129;_0xddcca7(_0x33893f[_0x474a64(0x10d)][_0x474a64(0x14f)](_0x43ec9a[_0x474a64(0x12a)])[_0x474a64(0x110)][_0x474a64(0x123)][_0x474a64(0x128)])['to']['equal'](_0x43ec9a[_0x474a64(0x155)]),_0x43ec9a[_0x474a64(0x116)](_0xe5d2ed);}),_0x40273e(_0x56dd06[_0x29e129(0x132)],_0x5cf641=>{const _0x99f6e2=_0x29e129;_0x207fb8(_0x2a4052[_0x99f6e2(0x10d)][_0x99f6e2(0x14f)](_0x43ec9a[_0x99f6e2(0x12a)],{'a':'b'})[_0x99f6e2(0x110)][_0x99f6e2(0x123)][_0x99f6e2(0x128)])['to']['equal'](_0x99f6e2(0x158)),_0x43ec9a['uaQyq'](_0x5cf641);}));}_0x11a543+='\x22';const _0x156797=Hawk[_0x29e129(0x10d)][_0x29e129(0x147)](_0x11a543,['a']);expect(_0x156797)['to']['be'][_0x29e129(0x13a)](Error),expect(_0x156797[_0x29e129(0x126)])['to'][_0x29e129(0x141)]('Header\x20length\x20too\x20long'),_0x2fa585();});}),_0x37341d['dVRWj'](describe,_0x37341d[_0x4e3799(0x10b)],()=>{const _0x245dd4=_0x4e3799;_0x37341d[_0x245dd4(0x10c)](it,_0x245dd4(0x12b),_0x3ee82a=>{const _0x1fcd95=_0x245dd4;_0x37341d[_0x1fcd95(0x142)](expect,Hawk[_0x1fcd95(0x10d)][_0x1fcd95(0x11f)]())['to'][_0x1fcd95(0x141)](Package['version']),_0x3ee82a();});}),describe('unauthorized()',()=>{const _0x4ac63b=_0x4e3799,_0x41c54d={'ETdVE':_0x37341d[_0x4ac63b(0x113)],'iyBwW':_0x37341d[_0x4ac63b(0x157)],'EBqMn':function(_0x59a41b){const _0x41b993=_0x4ac63b;return _0x37341d[_0x41b993(0x10f)](_0x59a41b);},'HEIdA':function(_0x1a069b,_0x537dbf){const _0x23bf70=_0x4ac63b;return _0x37341d[_0x23bf70(0x11b)](_0x1a069b,_0x537dbf);},'bWVUE':_0x37341d[_0x4ac63b(0x148)],'UgyVA':_0x37341d[_0x4ac63b(0x13f)]};it('returns\x20a\x20hawk\x20401',_0x47e5e6=>{const _0x249382=_0x4ac63b;expect(Hawk[_0x249382(0x10d)][_0x249382(0x14f)](_0x249382(0x117))['output'][_0x249382(0x123)][_0x41c54d[_0x249382(0x119)]])['to'][_0x249382(0x141)](_0x41c54d[_0x249382(0x12f)]),_0x41c54d[_0x249382(0x14a)](_0x47e5e6);}),it(_0x4ac63b(0x129),_0x19835d=>{const _0x27e934=_0x4ac63b;_0x41c54d[_0x27e934(0x11e)](expect,Hawk['utils']['unauthorized'](_0x41c54d[_0x27e934(0x154)],{'a':'b'})[_0x27e934(0x110)][_0x27e934(0x123)][_0x27e934(0x128)])['to']['equal'](_0x41c54d[_0x27e934(0x14d)]),_0x19835d();});});});