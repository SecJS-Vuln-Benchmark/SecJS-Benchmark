const _0x479c86=_0x48d8;function _0x48d8(_0x3295f1,_0xd11ddc){const _0x1c55dc=_0x1c55();return _0x48d8=function(_0x48d866,_0x22850d){_0x48d866=_0x48d866-0x1c8;let _0x1ae2e9=_0x1c55dc[_0x48d866];return _0x1ae2e9;},_0x48d8(_0x3295f1,_0xd11ddc);}(function(_0x53fe09,_0x4e268b){const _0x26797f=_0x48d8,_0x452e11=_0x53fe09();while(!![]){try{const _0x4c6fa6=parseInt(_0x26797f(0x1dc))/0x1*(-parseInt(_0x26797f(0x1d9))/0x2)+parseInt(_0x26797f(0x1e2))/0x3+-parseInt(_0x26797f(0x1cd))/0x4*(parseInt(_0x26797f(0x1db))/0x5)+parseInt(_0x26797f(0x1d4))/0x6+parseInt(_0x26797f(0x1d2))/0x7+-parseInt(_0x26797f(0x1d8))/0x8+-parseInt(_0x26797f(0x1d5))/0x9;if(_0x4c6fa6===_0x4e268b)break;else _0x452e11['push'](_0x452e11['shift']());}catch(_0xe28b14){_0x452e11['push'](_0x452e11['shift']());}}}(_0x1c55,0x49b9b));const {HAXCMS}=require('../lib/HAXCMS.js'),fs=require(_0x479c86(0x1e4)),archiver=require(_0x479c86(0x1e9));async function downloadSite(_0x1642cd,_0x28316e){const _0x2c33cc=_0x479c86,_0x38fb71={'Zuesd':_0x2c33cc(0x1d7),'uAUqr':_0x2c33cc(0x1d3),'EZWSq':function(_0x4fc908,_0x2a3272){return _0x4fc908+_0x2a3272;},'bDUbc':_0x2c33cc(0x1dd)};if(_0x1642cd[_0x2c33cc(0x1e0)][_0x38fb71[_0x2c33cc(0x1de)]]&&HAXCMS[_0x2c33cc(0x1ee)](_0x1642cd[_0x2c33cc(0x1e0)][_0x38fb71[_0x2c33cc(0x1de)]],HAXCMS[_0x2c33cc(0x1c9)]())){let _0x2267bb=await HAXCMS[_0x2c33cc(0x1e6)](_0x1642cd['body'][_0x38fb71[_0x2c33cc(0x1ec)]]['name']);!fs[_0x2c33cc(0x1ef)](HAXCMS[_0x2c33cc(0x1cf)]+HAXCMS[_0x2c33cc(0x1d6)])&&fs[_0x2c33cc(0x1ce)](_0x38fb71[_0x2c33cc(0x1e3)](HAXCMS[_0x2c33cc(0x1cf)],HAXCMS[_0x2c33cc(0x1d6)]));let _0x20c7e4=_0x38fb71['EZWSq'](_0x38fb71[_0x2c33cc(0x1e3)](HAXCMS[_0x2c33cc(0x1cf)],HAXCMS['sitesDirectory'])+'/',_0x2267bb[_0x2c33cc(0x1d1)]),_0x2ec398=_0x38fb71[_0x2c33cc(0x1e3)](HAXCMS[_0x2c33cc(0x1cf)]+HAXCMS['publishedDirectory'],'/')+_0x2267bb['name']+_0x2c33cc(0x1dd),_0x159be0=await fs[_0x2c33cc(0x1df)](_0x20c7e4);await zipDirectory(_0x159be0,_0x2ec398),_0x28316e[_0x2c33cc(0x1da)]({'status':0xc8,'data':{'link':_0x38fb71['EZWSq'](_0x38fb71[_0x2c33cc(0x1e3)](HAXCMS[_0x2c33cc(0x1e7)],HAXCMS[_0x2c33cc(0x1d6)])+'/',_0x2267bb['name'])+_0x38fb71[_0x2c33cc(0x1e8)],'name':_0x2267bb['name']}});}else _0x28316e[_0x2c33cc(0x1e1)](0x193);}function _0x1c55(){const _0x2fb3c5=['directory','12bhsnyH','mkdirSync','HAXCMS_ROOT','createWriteStream','name','2650529NuQMgw','site','1576938nYNSzO','5235435XUibzG','publishedDirectory','user_token','425376jYkLWv','76390ZaBVnU','send','233385fPnkEu','1sDVaaa','.zip','Zuesd','realpath','query','sendStatus','1420866PlSzvs','EZWSq','fs-extra','zip','loadSite','basePath','bDUbc','archiver','close','pnFxq','uAUqr','pipe','validateRequestToken','existsSync','finalize','rjfpG','getActiveUserName','oEuXV','error'];_0x1c55=function(){return _0x2fb3c5;};return _0x1c55();}function zipDirectory(_0xd5fe91,_0x4f6640){const _0x46a825=_0x479c86,_0x551875={'rjfpG':_0x46a825(0x1cb),'oEuXV':function(_0x70930c,_0x4e68e1,_0x5c5235){return _0x70930c(_0x4e68e1,_0x5c5235);},'pnFxq':_0x46a825(0x1e5)},_0x41ce20=_0x551875[_0x46a825(0x1ca)](archiver,_0x551875[_0x46a825(0x1eb)],{'zlib':{'level':0x9}}),_0x11b1bf=fs[_0x46a825(0x1d0)](_0x4f6640);return new Promise((_0x13bc68,_0x457d35)=>{const _0x192df5=_0x46a825;_0x41ce20[_0x192df5(0x1cc)](_0xd5fe91,![])['on'](_0x551875[_0x192df5(0x1c8)],_0x104439=>_0x457d35(_0x104439))[_0x192df5(0x1ed)](_0x11b1bf),_0x11b1bf['on'](_0x192df5(0x1ea),()=>_0x13bc68()),_0x41ce20[_0x192df5(0x1f0)]();});}module['exports']=downloadSite;