function _0x461d(_0x4f2c0a,_0x3aeb74){const _0xafd603=_0xafd6();return _0x461d=function(_0x461d9b,_0xc05dc){_0x461d9b=_0x461d9b-0x1eb;let _0x365658=_0xafd603[_0x461d9b];return _0x365658;},_0x461d(_0x4f2c0a,_0x3aeb74);}const _0x2ba96a=_0x461d;(function(_0x362d5e,_0x4abdd2){const _0x34249e=_0x461d,_0x9e12af=_0x362d5e();while(!![]){try{const _0x28da86=parseInt(_0x34249e(0x24a))/0x1*(-parseInt(_0x34249e(0x219))/0x2)+parseInt(_0x34249e(0x255))/0x3*(-parseInt(_0x34249e(0x26f))/0x4)+-parseInt(_0x34249e(0x234))/0x5+parseInt(_0x34249e(0x23b))/0x6+-parseInt(_0x34249e(0x269))/0x7*(parseInt(_0x34249e(0x230))/0x8)+parseInt(_0x34249e(0x21e))/0x9+-parseInt(_0x34249e(0x1ef))/0xa;if(_0x28da86===_0x4abdd2)break;else _0x9e12af['push'](_0x9e12af['shift']());}catch(_0x3ff71e){_0x9e12af['push'](_0x9e12af['shift']());}}}(_0xafd6,0xb7a08));const ldap=require('../lib/Adapters/Auth/ldap'),mockLdapServer=require('./MockLdapServer'),fs=require('fs'),port=0x3039,sslport=0x303a;function _0xafd6(){const _0x553616=['then','NPAKZ','wrong!','message','jjCtC','cpsIB','Should\x20succeed\x20with\x20right\x20credentials','EDeVw','kDoAc','QLBqB','password','close','Should\x20succeed\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20the\x20expected\x20certificate','1600004ebyBQw','pGcHA','readFileSync','jRGxA','ouvuu','pKecx','20rJjbEV','uAqSS','VTdOn','catch','qDQRd','2473500TACvFa','oaPSF','mArEO','SwJYn','rAkkm','LDAPS:\x20Certificate\x20mismatch','mMOBp','hXePB','aJLhR','Should\x20fail\x20with\x20missing\x20options','roHYL','DggCp','ldap://localhost:','wnoJy','equalTo','/support/cert/anothercert.pem','testuser','finally','vSSaG','LDAP:\x20User\x20not\x20in\x20group','ZBpjj','Should\x20fail\x20with\x20wrong\x20credentials','Vrziz','yETVN','JmwJv','uMBjb','CulAq','User','get','XupuA','CMSch','Should\x20succeed\x20if\x20user\x20is\x20in\x20given\x20group','powerusers','uyTan','Avvkp','yGzGV','Ermwk','RtSJH','Secxi','TZYFQ','groupTheUserIsNotIn','uid={{id}},\x20o=example','2dPnxaX','bIykk','ONgxV','ldaps://localhost:','RnmIh','13460625BAUNEu','KZtlx','LDAP\x20group\x20search\x20failed','wMwpB','lPZqg','qQIXz','iHUye','akkSU','pgesV','bbTtZ','DzOrP','CYEWC','Vcrdg','gVxBP','mzUDn','Should\x20delete\x20the\x20password\x20from\x20authData\x20after\x20validation','zzbeE','DxiXc','8MaNKwf','LDAP:\x20Wrong\x20username\x20or\x20password','secret','CGHnH','1438755tXwRmq','o=example','Should\x20fail\x20if\x20the\x20LDAP\x20server\x20encounters\x20an\x20error\x20while\x20searching','NeAns','mFKmr','lYvUJ','XUFsp','4349640FLkeiY','uid=testuser,\x20o=example','UoluB','toBeUndefined','o=invalid','ywMLa','jsrfm','Should\x20fail\x20if\x20user\x20is\x20not\x20in\x20given\x20group','toEqual','BREUQ','pFYLc','first','(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20certifcate\x20matches\x20but\x20credentials\x20are\x20wrong','authData','190681SSsxIH','fail','EolSl','vaiVO','Zayxe','IRCfk','CcCfE','gCfvT','lnHmf','ARyLX','nxafH','308445lLLuHz','IwpaW','ldap','/support/cert/cert.pem','EcOnZ','validateAuthData','CoamB'];_0xafd6=function(){return _0x553616;};return _0xafd6();}it(_0x2ba96a(0x1f8),_0x5308f8=>{const _0x24cb8c=_0x2ba96a,_0x71e4a5={'akkSU':function(_0xc88d98,_0x5f42da,_0x2b66e0){return _0xc88d98(_0x5f42da,_0x2b66e0);},'fXXIo':'LDAP\x20auth\x20configuration\x20missing','Secxi':function(_0x200ccc){return _0x200ccc();},'ARyLX':'testpw'};ldap['validateAuthData']({'id':_0x24cb8c(0x1ff),'password':_0x71e4a5[_0x24cb8c(0x253)]})[_0x24cb8c(0x25c)](_0x5308f8[_0x24cb8c(0x24b)])[_0x24cb8c(0x1ed)](_0x2473d3=>{const _0x32d8e2=_0x24cb8c;_0x71e4a5[_0x32d8e2(0x225)](jequal,_0x2473d3[_0x32d8e2(0x25f)],_0x71e4a5['fXXIo']),_0x71e4a5[_0x32d8e2(0x215)](_0x5308f8);});}),it('Should\x20return\x20a\x20resolved\x20promise\x20when\x20validating\x20the\x20app\x20id',_0x599c3c=>{const _0x4f8dac=_0x2ba96a;ldap['validateAppId']()[_0x4f8dac(0x25c)](_0x599c3c)[_0x4f8dac(0x1ed)](_0x599c3c[_0x4f8dac(0x24b)]);}),it(_0x2ba96a(0x262),_0x142adb=>{const _0x65baca=_0x2ba96a,_0x50695f={'QOqUr':_0x65baca(0x235),'pFYLc':function(_0x36a944,_0x5970ca,_0x28e73c){return _0x36a944(_0x5970ca,_0x28e73c);},'iHUye':_0x65baca(0x23c)};_0x50695f[_0x65baca(0x245)](mockLdapServer,port,_0x50695f[_0x65baca(0x224)])[_0x65baca(0x25c)](_0x35c0a3=>{const _0x3598b6=_0x65baca,_0xa58a4f={'suffix':_0x50695f['QOqUr'],'url':_0x3598b6(0x1fb)+port,'dn':_0x3598b6(0x218)};ldap[_0x3598b6(0x25a)]({'id':_0x3598b6(0x1ff),'password':_0x3598b6(0x232)},_0xa58a4f)[_0x3598b6(0x25c)](_0x142adb)[_0x3598b6(0x1ed)](_0x142adb[_0x3598b6(0x24b)])[_0x3598b6(0x200)](()=>_0x35c0a3[_0x3598b6(0x267)]());});}),it('Should\x20succeed\x20with\x20right\x20credentials\x20when\x20LDAPS\x20is\x20used\x20and\x20certifcate\x20is\x20not\x20checked',_0xc65cd0=>{const _0x43b34f=_0x2ba96a,_0x286c9c={'wMwpB':_0x43b34f(0x235),'mMOBp':'testuser','DzOrP':_0x43b34f(0x232)};mockLdapServer(sslport,_0x43b34f(0x23c),![],!![])[_0x43b34f(0x25c)](_0x1ac028=>{const _0x368d68=_0x43b34f,_0x574e73={'suffix':_0x286c9c[_0x368d68(0x221)],'url':_0x368d68(0x21c)+sslport,'dn':_0x368d68(0x218),'tlsOptions':{'rejectUnauthorized':![]}};ldap[_0x368d68(0x25a)]({'id':_0x286c9c[_0x368d68(0x1f5)],'password':_0x286c9c[_0x368d68(0x228)]},_0x574e73)['then'](_0xc65cd0)['catch'](_0xc65cd0['fail'])[_0x368d68(0x200)](()=>_0x1ac028[_0x368d68(0x267)]());});}),it(_0x2ba96a(0x268),_0x125f98=>{const _0xa4011d=_0x2ba96a,_0x22d997={'qQIXz':'o=example','vaiVO':_0xa4011d(0x218),'jjCtC':_0xa4011d(0x258),'roHYL':function(_0x64b4ed,_0x40a24c,_0x487def,_0x2305ad,_0x36b565){return _0x64b4ed(_0x40a24c,_0x487def,_0x2305ad,_0x36b565);}};_0x22d997[_0xa4011d(0x1f9)](mockLdapServer,sslport,_0xa4011d(0x23c),![],!![])['then'](_0xa129ed=>{const _0x2679e1=_0xa4011d,_0xe1ee25={'suffix':_0x22d997[_0x2679e1(0x223)],'url':_0x2679e1(0x21c)+sslport,'dn':_0x22d997[_0x2679e1(0x24d)],'tlsOptions':{'ca':fs[_0x2679e1(0x26b)](__dirname+_0x22d997[_0x2679e1(0x260)]),'rejectUnauthorized':!![]}};ldap[_0x2679e1(0x25a)]({'id':_0x2679e1(0x1ff),'password':'secret'},_0xe1ee25)[_0x2679e1(0x25c)](_0x125f98)[_0x2679e1(0x1ed)](_0x125f98['fail'])[_0x2679e1(0x200)](()=>_0xa129ed[_0x2679e1(0x267)]());});}),it('Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20not\x20the\x20expected\x20certificate',_0x4569d3=>{const _0x27a9c4=_0x2ba96a,_0x51bd8d={'CGHnH':_0x27a9c4(0x235),'lnHmf':_0x27a9c4(0x218),'tqFIT':_0x27a9c4(0x1ff)};mockLdapServer(sslport,_0x27a9c4(0x23c),![],!![])[_0x27a9c4(0x25c)](_0x490c15=>{const _0x47c1ef=_0x27a9c4,_0x21273c={'wnoJy':function(_0x4befa4,_0x39f6ac,_0xb9edfe){return _0x4befa4(_0x39f6ac,_0xb9edfe);}},_0xd77d00={'suffix':_0x51bd8d[_0x47c1ef(0x233)],'url':_0x47c1ef(0x21c)+sslport,'dn':_0x51bd8d[_0x47c1ef(0x252)],'tlsOptions':{'ca':fs[_0x47c1ef(0x26b)](__dirname+_0x47c1ef(0x1fe)),'rejectUnauthorized':!![]}};ldap[_0x47c1ef(0x25a)]({'id':_0x51bd8d['tqFIT'],'password':_0x47c1ef(0x232)},_0xd77d00)['then'](_0x4569d3['fail'])['catch'](_0x52f94b=>{const _0x310b0c=_0x47c1ef;_0x21273c[_0x310b0c(0x1fc)](jequal,_0x52f94b['message'],_0x310b0c(0x1f4)),_0x4569d3();})[_0x47c1ef(0x200)](()=>_0x490c15['close']());});}),it(_0x2ba96a(0x248),_0x16bc15=>{const _0x1cb7dd=_0x2ba96a,_0x1fdf50={'rkFVT':function(_0x3a29e0,_0x9a8b07,_0x207352){return _0x3a29e0(_0x9a8b07,_0x207352);},'bIykk':_0x1cb7dd(0x231),'SwJYn':_0x1cb7dd(0x235),'pgesV':'uid={{id}},\x20o=example','EcOnZ':function(_0x16cc25,_0x2b978d){return _0x16cc25+_0x2b978d;},'zGwiR':'testuser','CoamB':function(_0xb0f977,_0x4fe35c,_0x26339e,_0x2634bb,_0x156eeb){return _0xb0f977(_0x4fe35c,_0x26339e,_0x2634bb,_0x156eeb);},'CYEWC':_0x1cb7dd(0x23c)};_0x1fdf50[_0x1cb7dd(0x25b)](mockLdapServer,sslport,_0x1fdf50[_0x1cb7dd(0x229)],![],!![])[_0x1cb7dd(0x25c)](_0x33fa17=>{const _0x386fa3=_0x1cb7dd,_0x3886db={'suffix':_0x1fdf50[_0x386fa3(0x1f2)],'url':'ldaps://localhost:'+sslport,'dn':_0x1fdf50[_0x386fa3(0x226)],'tlsOptions':{'ca':fs[_0x386fa3(0x26b)](_0x1fdf50[_0x386fa3(0x259)](__dirname,_0x386fa3(0x258))),'rejectUnauthorized':!![]}};ldap[_0x386fa3(0x25a)]({'id':_0x1fdf50['zGwiR'],'password':'wrong!'},_0x3886db)[_0x386fa3(0x25c)](_0x16bc15[_0x386fa3(0x24b)])[_0x386fa3(0x1ed)](_0x16ec2f=>{const _0x56956d=_0x386fa3;_0x1fdf50['rkFVT'](jequal,_0x16ec2f[_0x56956d(0x25f)],_0x1fdf50[_0x56956d(0x21a)]),_0x16bc15();})['finally'](()=>_0x33fa17[_0x386fa3(0x267)]());});}),it(_0x2ba96a(0x204),_0xe34d4c=>{const _0x451f06=_0x2ba96a,_0x2ded3e={'UoluB':function(_0x5eb6a6,_0x26e155,_0x20ed2a){return _0x5eb6a6(_0x26e155,_0x20ed2a);},'Zayxe':_0x451f06(0x235)};mockLdapServer(port,_0x451f06(0x23c))[_0x451f06(0x25c)](_0x2f2723=>{const _0x1fab4f=_0x451f06,_0x5c61af={'xOHYR':_0x1fab4f(0x1f1),'KZtlx':'pZwUG','qDQRd':function(_0x55e975,_0x1063e7,_0x1a19f9){const _0xc1f66f=_0x1fab4f;return _0x2ded3e[_0xc1f66f(0x23d)](_0x55e975,_0x1063e7,_0x1a19f9);},'CMSch':function(_0xe8fdb8){return _0xe8fdb8();}},_0x359c98={'suffix':_0x2ded3e[_0x1fab4f(0x24e)],'url':_0x1fab4f(0x1fb)+port,'dn':_0x1fab4f(0x218)};ldap[_0x1fab4f(0x25a)]({'id':_0x1fab4f(0x1ff),'password':_0x1fab4f(0x25e)},_0x359c98)[_0x1fab4f(0x25c)](_0xe34d4c['fail'])[_0x1fab4f(0x1ed)](_0x3f4e2d=>{const _0x21798f=_0x1fab4f,_0x1f5018={'gCfvT':function(_0x31db4e,_0x3199cb,_0x3e94d3){return _0x31db4e(_0x3199cb,_0x3e94d3);},'kDoAc':'LDAP\x20group\x20search\x20failed','aXALX':function(_0x3502e3){return _0x3502e3();},'oaPSF':_0x21798f(0x218),'LUKkt':_0x21798f(0x247),'zzbeE':_0x21798f(0x1ff)};if(_0x5c61af['xOHYR']===_0x5c61af[_0x21798f(0x21f)]){const _0x3dd5eb={'suffix':_0x21798f(0x235),'url':_0x21798f(0x1fb)+_0x185c1f,'dn':_0x1f5018[_0x21798f(0x1f0)],'groupCn':_0x21798f(0x20f),'groupFilter':_0x1f5018['LUKkt']};_0x23d852['validateAuthData']({'id':_0x1f5018[_0x21798f(0x22e)],'password':_0x21798f(0x232)},_0x3dd5eb)[_0x21798f(0x25c)](_0xb504cd[_0x21798f(0x24b)])[_0x21798f(0x1ed)](_0x4a4f48=>{const _0x4324bc=_0x21798f;_0x1f5018[_0x4324bc(0x251)](_0x5e9774,_0x4a4f48['message'],_0x1f5018[_0x4324bc(0x264)]),_0x1f5018['aXALX'](_0x2c3e36);})[_0x21798f(0x200)](()=>_0x14fa0a[_0x21798f(0x267)]());}else _0x5c61af[_0x21798f(0x1ee)](jequal,_0x3f4e2d[_0x21798f(0x25f)],'LDAP:\x20Wrong\x20username\x20or\x20password'),_0x5c61af[_0x21798f(0x20d)](_0xe34d4c);})['finally'](()=>_0x2f2723[_0x1fab4f(0x267)]());});}),it(_0x2ba96a(0x20e),_0x16689c=>{const _0x29128f=_0x2ba96a,_0x5ee72f={'gVxBP':_0x29128f(0x247),'jyako':_0x29128f(0x232),'mzUDn':_0x29128f(0x23c)};mockLdapServer(port,_0x5ee72f[_0x29128f(0x22c)])[_0x29128f(0x25c)](_0x375703=>{const _0x47f384=_0x29128f,_0x24de5f={'suffix':_0x47f384(0x235),'url':_0x47f384(0x1fb)+port,'dn':_0x47f384(0x218),'groupCn':_0x47f384(0x20f),'groupFilter':_0x5ee72f[_0x47f384(0x22b)]};ldap[_0x47f384(0x25a)]({'id':'testuser','password':_0x5ee72f['jyako']},_0x24de5f)[_0x47f384(0x25c)](_0x16689c)[_0x47f384(0x1ed)](_0x16689c[_0x47f384(0x24b)])[_0x47f384(0x200)](()=>_0x375703[_0x47f384(0x267)]());});}),it(_0x2ba96a(0x242),_0x5a97f7=>{const _0x282a32=_0x2ba96a,_0x507961={'NPAKZ':_0x282a32(0x202),'vSSaG':function(_0x53c01d){return _0x53c01d();},'uAqSS':function(_0x2213aa,_0xd7a27b,_0x57b536){return _0x2213aa(_0xd7a27b,_0x57b536);},'lPZqg':_0x282a32(0x231),'npgnU':_0x282a32(0x265),'DoAqs':'qkgpO','AOwHn':_0x282a32(0x218),'AodCQ':_0x282a32(0x217),'ONgxV':_0x282a32(0x1ff)};mockLdapServer(port,_0x282a32(0x23c))['then'](_0x1b7dae=>{const _0x23d8f6=_0x282a32;if(_0x507961['npgnU']!==_0x507961['DoAqs']){const _0x214871={'suffix':_0x23d8f6(0x235),'url':_0x23d8f6(0x1fb)+port,'dn':_0x507961['AOwHn'],'groupCn':_0x507961['AodCQ'],'groupFilter':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))'};ldap[_0x23d8f6(0x25a)]({'id':_0x507961[_0x23d8f6(0x21b)],'password':_0x23d8f6(0x232)},_0x214871)[_0x23d8f6(0x25c)](_0x5a97f7['fail'])[_0x23d8f6(0x1ed)](_0xcc2ab3=>{const _0x451461=_0x23d8f6;jequal(_0xcc2ab3[_0x451461(0x25f)],_0x507961[_0x451461(0x25d)]),_0x507961[_0x451461(0x201)](_0x5a97f7);})['finally'](()=>_0x1b7dae[_0x23d8f6(0x267)]());}else _0x507961[_0x23d8f6(0x1eb)](_0x85387a,_0x331952['message'],_0x507961[_0x23d8f6(0x222)]),_0x475622();});}),it('Should\x20fail\x20if\x20the\x20LDAP\x20server\x20does\x20not\x20allow\x20searching\x20inside\x20the\x20provided\x20suffix',_0x5ec50b=>{const _0x1a2937=_0x2ba96a,_0x38fd97={'NeAns':_0x1a2937(0x220),'VTdOn':function(_0x5f595b){return _0x5f595b();},'yGzGV':'uid={{id}},\x20o=example','bbTtZ':_0x1a2937(0x20f),'EDeVw':_0x1a2937(0x247),'kiDBe':_0x1a2937(0x232),'RnmIh':function(_0x5631e8,_0x4bd68a,_0x4256bc){return _0x5631e8(_0x4bd68a,_0x4256bc);}};_0x38fd97[_0x1a2937(0x21d)](mockLdapServer,port,_0x1a2937(0x23c))[_0x1a2937(0x25c)](_0x3b3fd8=>{const _0x31606b=_0x1a2937,_0x1666e5={'uyTan':_0x38fd97[_0x31606b(0x237)],'JmwJv':function(_0x539f10){const _0x5b8bf2=_0x31606b;return _0x38fd97[_0x5b8bf2(0x1ec)](_0x539f10);}},_0x4c58f1={'suffix':_0x31606b(0x23f),'url':'ldap://localhost:'+port,'dn':_0x38fd97[_0x31606b(0x212)],'groupCn':_0x38fd97[_0x31606b(0x227)],'groupFilter':_0x38fd97[_0x31606b(0x263)]};ldap[_0x31606b(0x25a)]({'id':'testuser','password':_0x38fd97['kiDBe']},_0x4c58f1)['then'](_0x5ec50b[_0x31606b(0x24b)])[_0x31606b(0x1ed)](_0x23d3e8=>{const _0x1b54b6=_0x31606b;jequal(_0x23d3e8[_0x1b54b6(0x25f)],_0x1666e5[_0x1b54b6(0x210)]),_0x1666e5[_0x1b54b6(0x207)](_0x5ec50b);})[_0x31606b(0x200)](()=>_0x3b3fd8['close']());});}),it(_0x2ba96a(0x236),_0x4a7bb0=>{const _0x174e1e=_0x2ba96a,_0x21c858={'jRGxA':function(_0x244b66,_0x228d25){return _0x244b66!==_0x228d25;},'DxiXc':_0x174e1e(0x214),'jsrfm':'LDAP\x20group\x20search\x20failed','ySkit':_0x174e1e(0x218),'mFKmr':_0x174e1e(0x232),'ouvuu':function(_0x5795b7,_0x5a061e,_0x151d6c,_0x260da5){return _0x5795b7(_0x5a061e,_0x151d6c,_0x260da5);}};_0x21c858[_0x174e1e(0x26d)](mockLdapServer,port,_0x174e1e(0x23c),!![])['then'](_0x360af4=>{const _0x71b451=_0x174e1e,_0x267d32={'nxafH':function(_0x290788,_0x4c7064){const _0x24ad1e=_0x461d;return _0x21c858[_0x24ad1e(0x26c)](_0x290788,_0x4c7064);},'uMBjb':_0x21c858[_0x71b451(0x22f)],'yETVN':_0x21c858[_0x71b451(0x241)]},_0x5b5aa1={'suffix':_0x71b451(0x235),'url':_0x71b451(0x1fb)+port,'dn':_0x21c858['ySkit'],'groupCn':_0x71b451(0x20f),'groupFilter':_0x71b451(0x247)};ldap[_0x71b451(0x25a)]({'id':_0x71b451(0x1ff),'password':_0x21c858[_0x71b451(0x238)]},_0x5b5aa1)['then'](_0x4a7bb0['fail'])[_0x71b451(0x1ed)](_0x5829dc=>{const _0x23704a=_0x71b451,_0x57c50e={'IwpaW':_0x23704a(0x235),'aJLhR':_0x23704a(0x1ff)};if(_0x267d32[_0x23704a(0x254)](_0x267d32[_0x23704a(0x208)],_0x267d32[_0x23704a(0x208)])){const _0x1f266e={'suffix':_0x57c50e[_0x23704a(0x256)],'url':_0x23704a(0x1fb)+_0x4b38d9,'dn':_0x23704a(0x218),'groupCn':_0x23704a(0x217),'groupFilter':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))'};_0x15519e[_0x23704a(0x25a)]({'id':_0x57c50e[_0x23704a(0x1f7)],'password':_0x23704a(0x232)},_0x1f266e)[_0x23704a(0x25c)](_0x43f613[_0x23704a(0x24b)])['catch'](_0x1f9e2c=>{const _0x79dc97=_0x23704a;_0x491844(_0x1f9e2c[_0x79dc97(0x25f)],'LDAP:\x20User\x20not\x20in\x20group'),_0x5d8aa1();})[_0x23704a(0x200)](()=>_0x164906[_0x23704a(0x267)]());}else jequal(_0x5829dc[_0x23704a(0x25f)],_0x267d32[_0x23704a(0x206)]),_0x4a7bb0();})['finally'](()=>_0x360af4[_0x71b451(0x267)]());});}),it(_0x2ba96a(0x22d),_0x1466be=>{const _0x4c26e4=_0x2ba96a,_0x5aa048={'JLdpW':function(_0x22575b,_0x43ab6b){return _0x22575b(_0x43ab6b);},'vedRC':_0x4c26e4(0x1ff),'pKecx':_0x4c26e4(0x235),'BREUQ':_0x4c26e4(0x218),'IRCfk':_0x4c26e4(0x232)};mockLdapServer(port,_0x4c26e4(0x23c),!![])['then'](_0x4a2490=>{const _0x50a0ff=_0x4c26e4,_0x4f8227={'suffix':_0x5aa048[_0x50a0ff(0x26e)],'url':'ldap://localhost:'+port,'dn':_0x5aa048[_0x50a0ff(0x244)]},_0xa3cf75={'id':_0x50a0ff(0x1ff),'password':_0x5aa048[_0x50a0ff(0x24f)]};ldap['validateAuthData'](_0xa3cf75,_0x4f8227)['then'](()=>{const _0xc5728a=_0x50a0ff;_0x5aa048['JLdpW'](expect,_0xa3cf75)[_0xc5728a(0x243)]({'id':_0x5aa048['vedRC']}),_0x1466be();})[_0x50a0ff(0x1ed)](_0x1466be[_0x50a0ff(0x24b)])[_0x50a0ff(0x200)](()=>_0x4a2490['close']());});}),it('Should\x20not\x20save\x20the\x20password\x20in\x20the\x20user\x20record\x20after\x20authentication',_0x121ff5=>{const _0x53647a=_0x2ba96a,_0x3b48b8={'TZYFQ':_0x53647a(0x257),'lYvUJ':_0x53647a(0x235),'ZBpjj':function(_0x3e7fd7,_0x526cba){return _0x3e7fd7(_0x526cba);},'DggCp':_0x53647a(0x23c)};mockLdapServer(port,_0x3b48b8[_0x53647a(0x1fa)],!![])[_0x53647a(0x25c)](_0x10279a=>{const _0x1a2d34=_0x53647a,_0x16d3e9={'XupuA':_0x1a2d34(0x235),'cpsIB':function(_0x205fe3,_0x12e575){return _0x205fe3+_0x12e575;},'EolSl':_0x1a2d34(0x240),'ugycx':function(_0x2ecc74,_0x2d6ce0){return _0x2ecc74(_0x2d6ce0);},'QRvNl':_0x3b48b8[_0x1a2d34(0x216)]},_0x3ff35e={'suffix':_0x3b48b8[_0x1a2d34(0x239)],'url':_0x1a2d34(0x1fb)+port,'dn':_0x1a2d34(0x218)};_0x3b48b8[_0x1a2d34(0x203)](reconfigureServer,{'auth':{'ldap':_0x3ff35e}})[_0x1a2d34(0x25c)](()=>{const _0x29a8f6=_0x1a2d34,_0x3313f9={'JZFuO':_0x16d3e9[_0x29a8f6(0x20c)],'Avvkp':function(_0x587c00,_0x3f8489){const _0x4001e0=_0x29a8f6;return _0x16d3e9[_0x4001e0(0x261)](_0x587c00,_0x3f8489);},'hXePB':_0x16d3e9[_0x29a8f6(0x24c)],'rAkkm':function(_0x55d3fd,_0x276a38){return _0x16d3e9['ugycx'](_0x55d3fd,_0x276a38);},'Vrziz':_0x29a8f6(0x249),'CulAq':_0x29a8f6(0x1ff),'pGcHA':'uid=testuser,\x20o=example'},_0x6d51cf={'authData':{'id':_0x29a8f6(0x1ff),'password':_0x29a8f6(0x232)}};Parse[_0x29a8f6(0x20a)]['logInWith'](_0x16d3e9['QRvNl'],_0x6d51cf)[_0x29a8f6(0x25c)](_0x4b27c3=>{const _0x350cff=_0x29a8f6,_0x49ec78={'Vcrdg':_0x3313f9[_0x350cff(0x26a)]},_0x386a9f=new Parse['Query']('User');_0x386a9f[_0x350cff(0x1fd)]('objectId',_0x4b27c3['id'])[_0x350cff(0x246)]({'useMasterKey':!![]})[_0x350cff(0x25c)](_0x2f7d80=>{const _0x3ef709=_0x350cff,_0x3722e4={'XUFsp':_0x3313f9['JZFuO'],'CcCfE':_0x3ef709(0x218),'Ermwk':function(_0x115b36,_0x14b96d){const _0x4be975=_0x3ef709;return _0x3313f9[_0x4be975(0x211)](_0x115b36,_0x14b96d);}};_0x3ef709(0x240)!==_0x3313f9[_0x3ef709(0x1f6)]?_0x479a4f(_0x7878a6,_0x49ec78[_0x3ef709(0x22a)],![],!![])[_0x3ef709(0x25c)](_0x52d54d=>{const _0xef747e=_0x3ef709,_0x289507={'suffix':_0x3722e4[_0xef747e(0x23a)],'url':_0xef747e(0x21c)+_0x524d61,'dn':_0x3722e4[_0xef747e(0x250)],'tlsOptions':{'ca':_0x52d4e8[_0xef747e(0x26b)](_0x3722e4[_0xef747e(0x213)](_0x48d618,_0xef747e(0x258))),'rejectUnauthorized':!![]}};_0x162574[_0xef747e(0x25a)]({'id':_0xef747e(0x1ff),'password':_0xef747e(0x232)},_0x289507)[_0xef747e(0x25c)](_0x246b98)[_0xef747e(0x1ed)](_0x3892c3[_0xef747e(0x24b)])[_0xef747e(0x200)](()=>_0x52d54d[_0xef747e(0x267)]());}):(_0x3313f9[_0x3ef709(0x1f3)](expect,_0x2f7d80[_0x3ef709(0x20b)](_0x3313f9[_0x3ef709(0x205)]))[_0x3ef709(0x243)]({'ldap':{'id':_0x3313f9[_0x3ef709(0x209)]}}),expect(_0x2f7d80[_0x3ef709(0x20b)](_0x3313f9[_0x3ef709(0x205)])['ldap'][_0x3ef709(0x266)])[_0x3ef709(0x23e)](),_0x121ff5());})[_0x350cff(0x1ed)](_0x121ff5[_0x350cff(0x24b)])['finally'](()=>_0x10279a[_0x350cff(0x267)]());});});});});