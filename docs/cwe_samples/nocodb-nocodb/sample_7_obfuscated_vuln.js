function _0x21a5(){const _0x3f7790=['hPqPp','/uploads','apiKey','discounts','pageName','post','Login\x20successful','piwkY','csurf','RIGgF','../lib/auth','/admin/settings/update','length','tWcWX','includes','/admin/settings/pages/edit/:page','getThemes','cZmNE','findOneAndUpdate','json','Failed\x20deleting\x20menu.','join','PDZij','amount','session','footerHtml','/admin/login','helpers','wQKMt','NzVxe','GCSpZ','Page\x20not\x20found','YNbMF','Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today','/admin/settings/menu/delete','userPassword','File\x20uploaded\x20successfully','findOne','file','dashboard','mongoSanitize','AllHtmlEntities','Permission\x20denied','users','xMean','ordersAmount','scVoU','messageType','pageSlug','_id','TDOnt','permalink','/admin/testEmail','Create','app','Failed\x20creating\x20menu.','limit','/admin/settings/discount/create','WYLaw','/admin','16NmuRob','unlinkSync','NeDLe','2reEICZ','errors','KaQdz','Already\x20setup.','yuITi','Qsiux','gTfcE','settings-discount-edit','FygCK','getId','WVQPI','toDate','WPVaJ','multer','getConfig','Permalink\x20already\x20exists','allowedMimeType','cCZmn','deleteMenu','productImage','wpSJb','Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date','VyQHI','public/uploads','ptffv','productId','File\x20upload\x20error.\x20Please\x20try\x20again.','244730aHlhti','$orderProductCount','Static\x20pages','originalname','uploadFile','googleAnalytics','orderMenu','insertOne','arPks','checkDirectorySync','sHAeY','get','fileSizeLimit','isAfter','NiNsB','sum','result','/admin/setup','zygty','kPXvT','yEjYs','DHRdd','isValid','deleteOne','0|2|5|1|4|3','mongodb','toString','afALp','params','createReadStream','404\x20Error\x20-\x20Page\x20not\x20found','redirect','1527520xBvhNP','/admin/login_action','env','hAXnG','colors','value','Login','email','ZMWxP','settings-page','/admin/settings/menu/saveOrder','Discount\x20code\x20edit','decode','toArray','$orderProducts','path','cKZGc','pujzI','Router','find','Error\x20updating\x20page.\x20Please\x20try\x20again.','Your\x20email\x20settings\x20are\x20working','/admin/settings/discount/new','handlebars','Page\x20updated\x20successfully','MBRqq','BSvsm','pipe','HDFAH','/admin/file/upload','/admin/settings/page','API\x20Key\x20generated','productsSold','sendEmail','compare','dIxMH','settings','orders','discountId','emailAddress','express','PfOMG','undefined','size','split','Menu\x20updated\x20successfully.','File\x20type\x20not\x20allowed\x20or\x20too\x20large.\x20Please\x20try\x20again.','/admin/settings/discount/edit/:id','Error\x20deleting\x20discount\x20code.\x20Please\x20try\x20again.','HDjTT','ObjectID','New\x20page\x20successfully\x20created','/admin/setup_action','then','JaBAi','Discount\x20code','$or','bKpsE','Test\x20email\x20sent','pageId','settings-discounts','end','1043810mGeuRP','$o.v.quantity','/admin/settings','User\x20account\x20inserted','Failed\x20updating\x20menu.','KrLtS','lSNpN','editDiscount','TCAyl','Update','Menu\x20deleted\x20successfully.','yXwpF','nNDaS','newMenu','code','/admin/settings/discount/update','66cqCSSo','zBtNl','ZCceo','insertedId','PrjKx','showFooter','isAdmin','/admin/settings/menu/update','page','userId','Setup','header','Discount\x20code\x20already\x20exists','config','usersName','qQyAu','DD/MM/YYYY\x20HH:mm','Referer','pLHjC','DsYtj','783108DhDBFF','YJFHK','fsCVH','start','user','bcryptjs','replace','kfGrw','/admin/searchall','fgaix','needsSetup','docId','Cart\x20settings','dMlXN','customers','snoSL','bqoXr','pages','/admin/dashboard','1136fVLLpv','updateMenu','KJkgv','FCzmq','updateConfig','clearSessionValue','CGOIa','Failed\x20saving\x20menu\x20order','login','zlgLu','aggregate','sortMenu','setup','BfwgH','BRHla','status','type','1716RLeVDk','vZlRr','tfutg','mgtBf','csrfToken','settings-menu','orderEmail','/admin/settings/menu','img','Discount\x20code\x20create','mgCbc','settings-discount-new','Menu\x20created\x20successfully.','products','getMenu','37261FpwNEV','public/uploads/','red','iXXZs','message','searchValue','Setup\x20failed','HjpHt','body','updateOne','../lib/schema','pageEnabled','YpzwW','keys','$o.v.productId','newDiscount','DwSoF','NODE_ENV','sort','test','1036046aHtwzI','xFFSj','delete','Cart\x20menu','hByjG','createWriteStream','hashSync','render','$orderTotal','tSiAL','pageContent','IGTpf','lookup','OdfCX','aKnYE','countDocuments','$o.v.title','BONnw','Uqdmb'];_0x21a5=function(){return _0x3f7790;};return _0x21a5();}const _0x4e5062=_0x2eed;function _0x2eed(_0xcc34e9,_0x3d583e){const _0x21a596=_0x21a5();return _0x2eed=function(_0x2eed4f,_0x29c201){_0x2eed4f=_0x2eed4f-0xac;let _0x59b061=_0x21a596[_0x2eed4f];return _0x59b061;},_0x2eed(_0xcc34e9,_0x3d583e);}(function(_0x2b38c6,_0x7c518f){const _0x2d3e65=_0x2eed,_0x51a834=_0x2b38c6();while(!![]){try{const _0x4ea61d=parseInt(_0x2d3e65(0x19f))/0x1*(parseInt(_0x2d3e65(0x184))/0x2)+-parseInt(_0x2d3e65(0x10f))/0x3*(-parseInt(_0x2d3e65(0xfe))/0x4)+parseInt(_0x2d3e65(0xc7))/0x5+-parseInt(_0x2d3e65(0xd7))/0x6*(parseInt(_0x2d3e65(0x11e))/0x7)+parseInt(_0x2d3e65(0x181))/0x8*(-parseInt(_0x2d3e65(0xeb))/0x9)+-parseInt(_0x2d3e65(0x1bf))/0xa+-parseInt(_0x2d3e65(0x132))/0xb;if(_0x4ea61d===_0x7c518f)break;else _0x51a834['push'](_0x51a834['shift']());}catch(_0x5be64e){_0x51a834['push'](_0x51a834['shift']());}}}(_0x21a5,0x214e9));const express=require(_0x4e5062(0xb1)),common=require('../lib/common'),{restrict,checkAccess}=require(_0x4e5062(0x14f)),escape=require('html-entities')[_0x4e5062(0x16e)],colors=require(_0x4e5062(0x1c3)),bcrypt=require(_0x4e5062(0xf0)),moment=require('moment'),fs=require('fs'),path=require(_0x4e5062(0x1ce)),multer=require(_0x4e5062(0x191)),mime=require('mime-type/with-db'),csrf=require(_0x4e5062(0x14d)),{validateJson}=require(_0x4e5062(0x128)),ObjectId=require(_0x4e5062(0x1b8))[_0x4e5062(0xbb)],router=express[_0x4e5062(0x1d1)](),csrfProtection=csrf({'cookie':!![]}),emailRegex=/\S+@\S+\.\S+/,numericRegex=/^\d*\.?\d*$/;router[_0x4e5062(0x1aa)](_0x4e5062(0x180),restrict,(_0x19bced,_0xb5112a,_0xcf26fc)=>{const _0x46771b=_0x4e5062,_0x2254ec={'cZmNE':_0x46771b(0xfd)};_0xb5112a[_0x46771b(0x1be)](_0x2254ec[_0x46771b(0x156)]);}),router['get']('/admin/logout',(_0x41c708,_0x24acaa)=>{const _0x4167fe=_0x4e5062;_0x41c708['session'][_0x4167fe(0xef)]=null,_0x41c708['session'][_0x4167fe(0x122)]=null,_0x41c708['session'][_0x4167fe(0x174)]=null,_0x24acaa[_0x4167fe(0x1be)]('/');});process[_0x4e5062(0x1c1)][_0x4e5062(0x12f)]==='test'&&router['get']('/admin/csrf',csrfProtection,(_0x484f11,_0x5e2892,_0x27d3f1)=>{const _0x42cbcf=_0x4e5062;_0x5e2892['json']({'csrf':_0x484f11[_0x42cbcf(0x113)]()});});router[_0x4e5062(0x1aa)](_0x4e5062(0x15f),async(_0x46e7f2,_0x535db2)=>{const _0x345204=_0x4e5062,_0x132e1e={'qQyAu':_0x345204(0x1c5),'WYLaw':'Referer','MBRqq':_0x345204(0x174),'ZMlIB':_0x345204(0xdc)},_0x23c0a9=_0x46e7f2[_0x345204(0x17b)]['db'],_0x2527b0=await _0x23c0a9[_0x345204(0x170)][_0x345204(0x141)]({});_0x2527b0&&_0x2527b0>0x0?(_0x46e7f2[_0x345204(0x15d)][_0x345204(0xf5)]=![],_0x535db2[_0x345204(0x139)](_0x345204(0x106),{'title':_0x132e1e[_0x345204(0xe6)],'referringUrl':_0x46e7f2[_0x345204(0xe2)](_0x132e1e[_0x345204(0x17f)]),'config':_0x46e7f2[_0x345204(0x17b)][_0x345204(0xe4)],'message':common[_0x345204(0x103)](_0x46e7f2[_0x345204(0x15d)],_0x345204(0x122)),'messageType':common[_0x345204(0x103)](_0x46e7f2[_0x345204(0x15d)],_0x132e1e[_0x345204(0x1d8)]),'helpers':_0x46e7f2[_0x345204(0x1d6)][_0x345204(0x160)],'showFooter':_0x132e1e['ZMlIB']})):(_0x46e7f2[_0x345204(0x15d)][_0x345204(0xf5)]=!![],_0x535db2[_0x345204(0x1be)](_0x345204(0x1b0)));}),router['post'](_0x4e5062(0x1c0),async(_0x223273,_0x5078f2)=>{const _0x3772ed=_0x4e5062,_0x35587e={'qzNjC':_0x3772ed(0x14b),'UpSyX':'Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.','MTTaQ':function(_0xfd423,_0x17c059){return _0xfd423===_0x17c059;}},_0x1c5286=_0x223273[_0x3772ed(0x17b)]['db'],_0x2b6537=await _0x1c5286['users'][_0x3772ed(0x16a)]({'userEmail':common[_0x3772ed(0x16d)](_0x223273[_0x3772ed(0x126)]['email'])});if(!_0x2b6537||_0x35587e['MTTaQ'](_0x2b6537,null)){_0x5078f2[_0x3772ed(0x10d)](0x190)[_0x3772ed(0x158)]({'message':'A\x20user\x20with\x20that\x20email\x20does\x20not\x20exist.'});return;}bcrypt[_0x3772ed(0x1e1)](_0x223273[_0x3772ed(0x126)]['password'],_0x2b6537[_0x3772ed(0x168)])[_0x3772ed(0xbe)](_0x21ad15=>{const _0x626598=_0x3772ed;if(_0x21ad15){_0x223273[_0x626598(0x15d)]['user']=_0x223273[_0x626598(0x126)][_0x626598(0x1c6)],_0x223273['session'][_0x626598(0xe5)]=_0x2b6537[_0x626598(0xe5)],_0x223273[_0x626598(0x15d)][_0x626598(0xe0)]=_0x2b6537[_0x626598(0x176)][_0x626598(0x1b9)](),_0x223273[_0x626598(0x15d)][_0x626598(0xdd)]=_0x2b6537[_0x626598(0xdd)],_0x5078f2[_0x626598(0x10d)](0xc8)[_0x626598(0x158)]({'message':_0x35587e['qzNjC']});return;}_0x5078f2['status'](0x190)[_0x626598(0x158)]({'message':_0x35587e['UpSyX']});});}),router['get']('/admin/setup',async(_0x11aa55,_0x381d54)=>{const _0x417203=_0x4e5062,_0x44c769={'nNDaS':'showFooter'},_0x28f33e=_0x11aa55[_0x417203(0x17b)]['db'],_0x1afc97=await _0x28f33e[_0x417203(0x170)][_0x417203(0x141)]({});_0x11aa55['session'][_0x417203(0xf5)]=![];if(_0x1afc97===0x0){_0x11aa55[_0x417203(0x15d)][_0x417203(0xf5)]=!![],_0x381d54[_0x417203(0x139)](_0x417203(0x10a),{'title':_0x417203(0xe1),'config':_0x11aa55['app']['config'],'helpers':_0x11aa55[_0x417203(0x1d6)][_0x417203(0x160)],'message':common['clearSessionValue'](_0x11aa55['session'],_0x417203(0x122)),'messageType':common[_0x417203(0x103)](_0x11aa55[_0x417203(0x15d)],'messageType'),'showFooter':_0x44c769[_0x417203(0xd3)]});return;}_0x381d54['redirect'](_0x417203(0x15f));}),router[_0x4e5062(0x14a)](_0x4e5062(0xbd),async(_0x18ec20,_0x3b3a1c)=>{const _0x4de4fb=_0x4e5062,_0x59c8dc={'tfutg':_0x4de4fb(0x1b7),'HjpHt':function(_0x2edfc1,_0x510530){return _0x2edfc1!==_0x510530;},'cKZGc':function(_0x55bd52,_0x86a14e){return _0x55bd52+_0x86a14e;},'CGOIa':_0x4de4fb(0x187)},_0x329736=_0x18ec20[_0x4de4fb(0x17b)]['db'],_0x3a2de7={'usersName':_0x18ec20['body'][_0x4de4fb(0xe5)],'userEmail':_0x18ec20[_0x4de4fb(0x126)]['userEmail'],'userPassword':bcrypt[_0x4de4fb(0x138)](_0x18ec20['body'][_0x4de4fb(0x168)],0xa),'isAdmin':!![],'isOwner':!![]},_0xa13762=await _0x329736[_0x4de4fb(0x170)]['countDocuments']({});if(_0xa13762===0x0){if(_0x59c8dc[_0x4de4fb(0x125)](_0x4de4fb(0x198),'wpSJb')){if(_0x5a33ec){const _0x3f4d9d=_0x59c8dc[_0x4de4fb(0x111)][_0x4de4fb(0xb5)]('|');let _0x1c28d5=0x0;while(!![]){switch(_0x3f4d9d[_0x1c28d5++]){case'0':_0x41bc8d[_0x4de4fb(0x15d)]['user']=_0x50b2c4[_0x4de4fb(0x126)][_0x4de4fb(0x1c6)];continue;case'1':_0x1e79ae[_0x4de4fb(0x15d)][_0x4de4fb(0xdd)]=_0x490048[_0x4de4fb(0xdd)];continue;case'2':_0x37b648[_0x4de4fb(0x15d)][_0x4de4fb(0xe5)]=_0xd95295[_0x4de4fb(0xe5)];continue;case'3':return;case'4':_0x4a4952[_0x4de4fb(0x10d)](0xc8)[_0x4de4fb(0x158)]({'message':_0x4de4fb(0x14b)});continue;case'5':_0x3e2427[_0x4de4fb(0x15d)][_0x4de4fb(0xe0)]=_0x2d1acb['_id'][_0x4de4fb(0x1b9)]();continue;}break;}}_0x14990a['status'](0x190)['json']({'message':'Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.'});}else try{await _0x329736[_0x4de4fb(0x170)][_0x4de4fb(0x1a6)](_0x3a2de7),_0x3b3a1c[_0x4de4fb(0x10d)](0xc8)[_0x4de4fb(0x158)]({'message':_0x4de4fb(0xca)});return;}catch(_0x1d3ace){console['error'](colors[_0x4de4fb(0x120)](_0x59c8dc[_0x4de4fb(0x1cf)]('Failed\x20to\x20insert\x20user:\x20',_0x1d3ace))),_0x3b3a1c[_0x4de4fb(0x10d)](0xc8)[_0x4de4fb(0x158)]({'message':_0x4de4fb(0x124)});return;}}_0x3b3a1c[_0x4de4fb(0x10d)](0xc8)['json']({'message':_0x59c8dc[_0x4de4fb(0x104)]});}),router[_0x4e5062(0x1aa)](_0x4e5062(0xfd),csrfProtection,restrict,async(_0x1e04ac,_0x4b57e7)=>{const _0x4179ed=_0x4e5062,_0x32a167={'ktAXK':function(_0x1cddc5,_0x4fd964){return _0x1cddc5===_0x4fd964;},'snoSL':_0x4179ed(0x105),'BONnw':_0x4179ed(0x13a),'YJFHK':_0x4179ed(0x1cd),'zBtNl':_0x4179ed(0x12c),'pLHjC':_0x4179ed(0x142),'mzamS':function(_0x213aba,_0x5f3fc3){return _0x213aba>_0x5f3fc3;},'afALp':_0x4179ed(0x133),'ZYFKk':_0x4179ed(0x174)},_0x49eddb=_0x1e04ac[_0x4179ed(0x17b)]['db'],_0x4d48c1={'productsCount':await _0x49eddb[_0x4179ed(0x11c)][_0x4179ed(0x141)]({'productPublished':!![]}),'ordersCount':await _0x49eddb['orders'][_0x4179ed(0x141)]({}),'ordersAmount':await _0x49eddb[_0x4179ed(0xae)][_0x4179ed(0x108)]([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x32a167[_0x4179ed(0x143)]}}}])[_0x4179ed(0x1cc)](),'productsSold':await _0x49eddb[_0x4179ed(0xae)][_0x4179ed(0x108)]([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x4179ed(0x1a0)}}}])[_0x4179ed(0x1cc)](),'topProducts':await _0x49eddb[_0x4179ed(0xae)][_0x4179ed(0x108)]([{'$project':{'_id':0x0}},{'$project':{'o':{'$objectToArray':_0x32a167[_0x4179ed(0xec)]}}},{'$unwind':'$o'},{'$group':{'_id':_0x32a167[_0x4179ed(0xd8)],'title':{'$last':_0x32a167[_0x4179ed(0xe9)]},'productImage':{'$last':'$o.v.productImage'},'count':{'$sum':_0x4179ed(0xc8)}}},{'$sort':{'count':-0x1}},{'$limit':0x5}])['toArray']()};_0x4d48c1[_0x4179ed(0x172)][_0x4179ed(0x151)]>0x0&&(_0x4d48c1[_0x4179ed(0x172)]=_0x4d48c1[_0x4179ed(0x172)][0x0][_0x4179ed(0x1ae)]);if(_0x32a167['mzamS'](_0x4d48c1[_0x4179ed(0x1df)]['length'],0x0)){if(_0x32a167[_0x4179ed(0x1ba)]!==_0x4179ed(0x133)){const _0x561e6e=_0x58732a[_0x4179ed(0x1a5)](_0x39c015,_0xbb795c);if(_0x32a167['ktAXK'](_0x561e6e,![])){_0x88f2df[_0x4179ed(0x10d)](0x190)['json']({'message':_0x32a167[_0x4179ed(0xfa)]});return;}_0x1bc068['status'](0xc8)[_0x4179ed(0x158)]({});}else _0x4d48c1['productsSold']=_0x4d48c1[_0x4179ed(0x1df)][0x0]['sum'];}else _0x4d48c1[_0x4179ed(0x1df)]=0x0;_0x4b57e7[_0x4179ed(0x139)](_0x4179ed(0x16c),{'title':'Cart\x20dashboard','session':_0x1e04ac[_0x4179ed(0x15d)],'admin':!![],'dashboardData':_0x4d48c1,'themes':common[_0x4179ed(0x155)](),'message':common[_0x4179ed(0x103)](_0x1e04ac[_0x4179ed(0x15d)],_0x4179ed(0x122)),'messageType':common['clearSessionValue'](_0x1e04ac['session'],_0x32a167['ZYFKk']),'helpers':_0x1e04ac['handlebars'][_0x4179ed(0x160)],'config':_0x1e04ac[_0x4179ed(0x17b)][_0x4179ed(0xe4)],'csrfToken':_0x1e04ac['csrfToken']()});}),router[_0x4e5062(0x1aa)](_0x4e5062(0xc9),csrfProtection,restrict,(_0x31af1c,_0x4154c5)=>{const _0x8b6486=_0x4e5062,_0xb58fb4={'bKpsE':_0x8b6486(0xad),'TCAyl':_0x8b6486(0xf7),'CgBBq':_0x8b6486(0x174),'Uqdmb':function(_0x224e89,_0x291406){return _0x224e89!==_0x291406;},'sHAeY':_0x8b6486(0xb3),'FygCK':function(_0x5661f0,_0x4478a9){return _0x5661f0!==_0x4478a9;}};_0x4154c5[_0x8b6486(0x139)](_0xb58fb4[_0x8b6486(0xc2)],{'title':_0xb58fb4[_0x8b6486(0xcf)],'session':_0x31af1c[_0x8b6486(0x15d)],'admin':!![],'themes':common[_0x8b6486(0x155)](),'message':common['clearSessionValue'](_0x31af1c['session'],_0x8b6486(0x122)),'messageType':common[_0x8b6486(0x103)](_0x31af1c['session'],_0xb58fb4['CgBBq']),'helpers':_0x31af1c[_0x8b6486(0x1d6)][_0x8b6486(0x160)],'config':_0x31af1c[_0x8b6486(0x17b)][_0x8b6486(0xe4)],'footerHtml':_0xb58fb4[_0x8b6486(0x144)](typeof _0x31af1c[_0x8b6486(0x17b)][_0x8b6486(0xe4)][_0x8b6486(0x15e)],_0xb58fb4[_0x8b6486(0x1a9)])?escape[_0x8b6486(0x1cb)](_0x31af1c[_0x8b6486(0x17b)][_0x8b6486(0xe4)]['footerHtml']):null,'googleAnalytics':_0xb58fb4[_0x8b6486(0x18c)](typeof _0x31af1c[_0x8b6486(0x17b)][_0x8b6486(0xe4)][_0x8b6486(0x1a4)],_0xb58fb4['sHAeY'])?escape['decode'](_0x31af1c['app']['config'][_0x8b6486(0x1a4)]):null,'csrfToken':_0x31af1c['csrfToken']()});}),router['post']('/admin/createApiKey',restrict,checkAccess,async(_0x4a3f92,_0x268403)=>{const _0x497d57=_0x4e5062,_0x157b27={'BRHla':function(_0x327def,_0x382b59){return _0x327def(_0x382b59);}},_0x104f2c=_0x4a3f92['app']['db'],_0x59c680=await _0x104f2c[_0x497d57(0x170)][_0x497d57(0x157)]({'_id':_0x157b27[_0x497d57(0x10c)](ObjectId,_0x4a3f92[_0x497d57(0x15d)]['userId']),'isAdmin':!![]},{'$set':{'apiKey':new ObjectId()}},{'returnOriginal':![]});if(_0x59c680['value']&&_0x59c680['value'][_0x497d57(0x147)]){_0x268403[_0x497d57(0x10d)](0xc8)[_0x497d57(0x158)]({'message':_0x497d57(0x1de),'apiKey':_0x59c680['value']['apiKey']});return;}_0x268403[_0x497d57(0x10d)](0x190)[_0x497d57(0x158)]({'message':'Failed\x20to\x20generate\x20API\x20Key'});}),router[_0x4e5062(0x14a)](_0x4e5062(0x150),restrict,checkAccess,(_0x59aae8,_0x2fb521)=>{const _0xd96706=_0x4e5062,_0x474962={'KrLtS':_0xd96706(0x16f)},_0x1b33b7=common[_0xd96706(0x102)](_0x59aae8[_0xd96706(0x126)]);if(_0x1b33b7===!![]){_0x59aae8[_0xd96706(0x17b)][_0xd96706(0xe4)]=common[_0xd96706(0x192)](),_0x2fb521[_0xd96706(0x10d)](0xc8)[_0xd96706(0x158)]({'message':'Settings\x20successfully\x20updated'});return;}_0x2fb521[_0xd96706(0x10d)](0x190)[_0xd96706(0x158)]({'message':_0x474962[_0xd96706(0xcc)]});}),router['get'](_0x4e5062(0x116),csrfProtection,restrict,async(_0x225868,_0x4392c6)=>{const _0x49d82c=_0x4e5062,_0x2b8531={'PfOMG':_0x49d82c(0x114),'vZlRr':_0x49d82c(0x135),'bqoXr':_0x49d82c(0x122),'zlgLu':_0x49d82c(0x174)},_0x58a9f5=_0x225868['app']['db'];_0x4392c6['render'](_0x2b8531[_0x49d82c(0xb2)],{'title':_0x2b8531[_0x49d82c(0x110)],'session':_0x225868['session'],'admin':!![],'message':common[_0x49d82c(0x103)](_0x225868[_0x49d82c(0x15d)],_0x2b8531[_0x49d82c(0xfb)]),'messageType':common['clearSessionValue'](_0x225868['session'],_0x2b8531[_0x49d82c(0x107)]),'helpers':_0x225868[_0x49d82c(0x1d6)][_0x49d82c(0x160)],'config':_0x225868[_0x49d82c(0x17b)]['config'],'menu':common['sortMenu'](await common[_0x49d82c(0x11d)](_0x58a9f5)),'csrfToken':_0x225868[_0x49d82c(0x113)]()});}),router[_0x4e5062(0x1aa)]('/admin/settings/pages',csrfProtection,restrict,async(_0x35ba5e,_0x54f869)=>{const _0x2b9dc6=_0x4e5062,_0x4234c9={'HDjTT':_0x2b9dc6(0x1a1),'Qsiux':_0x2b9dc6(0x122),'TDOnt':_0x2b9dc6(0x174)},_0x280fb4=_0x35ba5e[_0x2b9dc6(0x17b)]['db'],_0x23ae50=await _0x280fb4[_0x2b9dc6(0xfc)][_0x2b9dc6(0x1d2)]({})[_0x2b9dc6(0x1cc)]();_0x54f869[_0x2b9dc6(0x139)]('settings-pages',{'title':_0x4234c9[_0x2b9dc6(0xba)],'pages':_0x23ae50,'session':_0x35ba5e[_0x2b9dc6(0x15d)],'admin':!![],'message':common[_0x2b9dc6(0x103)](_0x35ba5e[_0x2b9dc6(0x15d)],_0x4234c9[_0x2b9dc6(0x189)]),'messageType':common[_0x2b9dc6(0x103)](_0x35ba5e[_0x2b9dc6(0x15d)],_0x4234c9[_0x2b9dc6(0x177)]),'helpers':_0x35ba5e[_0x2b9dc6(0x1d6)][_0x2b9dc6(0x160)],'config':_0x35ba5e['app'][_0x2b9dc6(0xe4)],'menu':common[_0x2b9dc6(0x109)](await common[_0x2b9dc6(0x11d)](_0x280fb4)),'csrfToken':_0x35ba5e['csrfToken']()});}),router['get']('/admin/settings/pages/new',csrfProtection,restrict,checkAccess,async(_0xd05387,_0x1980a3)=>{const _0x517ccc=_0x4e5062,_0x5ac9bf={'GCSpZ':_0x517ccc(0x1c8),'xMean':'messageType'},_0x10d1fc=_0xd05387[_0x517ccc(0x17b)]['db'];_0x1980a3[_0x517ccc(0x139)](_0x5ac9bf[_0x517ccc(0x163)],{'title':_0x517ccc(0x1a1),'session':_0xd05387[_0x517ccc(0x15d)],'admin':!![],'button_text':_0x517ccc(0x17a),'message':common[_0x517ccc(0x103)](_0xd05387['session'],'message'),'messageType':common[_0x517ccc(0x103)](_0xd05387[_0x517ccc(0x15d)],_0x5ac9bf[_0x517ccc(0x171)]),'helpers':_0xd05387['handlebars'][_0x517ccc(0x160)],'config':_0xd05387['app']['config'],'menu':common['sortMenu'](await common['getMenu'](_0x10d1fc)),'csrfToken':_0xd05387['csrfToken']()});}),router['get'](_0x4e5062(0x154),csrfProtection,restrict,checkAccess,async(_0x6924c4,_0xc4d30a)=>{const _0x2e7243=_0x4e5062,_0x55ebc3={'dMlXN':_0x2e7243(0x1bd),'arPks':_0x2e7243(0xdc),'ecTAB':_0x2e7243(0x1a1),'scVoU':_0x2e7243(0xd0)},_0x58d6bd=_0x6924c4[_0x2e7243(0x17b)]['db'],_0x8b810d=await _0x58d6bd['pages'][_0x2e7243(0x16a)]({'_id':common['getId'](_0x6924c4[_0x2e7243(0x1bb)][_0x2e7243(0xdf)])}),_0x39348a=common['sortMenu'](await common[_0x2e7243(0x11d)](_0x58d6bd));if(!_0x8b810d){_0xc4d30a['status'](0x194)[_0x2e7243(0x139)]('error',{'title':_0x2e7243(0x1bd),'config':_0x6924c4[_0x2e7243(0x17b)][_0x2e7243(0xe4)],'message':_0x55ebc3[_0x2e7243(0xf8)],'helpers':_0x6924c4[_0x2e7243(0x1d6)]['helpers'],'showFooter':_0x55ebc3[_0x2e7243(0x1a7)],'menu':_0x39348a});return;}_0xc4d30a['render'](_0x2e7243(0x1c8),{'title':_0x55ebc3['ecTAB'],'page':_0x8b810d,'button_text':_0x55ebc3[_0x2e7243(0x173)],'session':_0x6924c4[_0x2e7243(0x15d)],'admin':!![],'message':common['clearSessionValue'](_0x6924c4[_0x2e7243(0x15d)],_0x2e7243(0x122)),'messageType':common['clearSessionValue'](_0x6924c4[_0x2e7243(0x15d)],_0x2e7243(0x174)),'helpers':_0x6924c4[_0x2e7243(0x1d6)][_0x2e7243(0x160)],'config':_0x6924c4['app']['config'],'menu':_0x39348a,'csrfToken':_0x6924c4['csrfToken']()});}),router[_0x4e5062(0x14a)](_0x4e5062(0x1dd),restrict,checkAccess,async(_0x5ee86f,_0x1e2fed)=>{const _0x2a2cb0=_0x4e5062,_0x50fc6b={'lhbsX':'Failed\x20to\x20insert\x20user:\x20','dIxMH':_0x2a2cb0(0x124),'DwSoF':function(_0x184b83,_0x1f71b1){return _0x184b83===_0x1f71b1;},'PrjKx':_0x2a2cb0(0x159),'DWdeQ':_0x2a2cb0(0xd1),'mgCbc':_0x2a2cb0(0x1c2),'NeDLe':_0x2a2cb0(0x1d7),'pujzI':'KaQdz','yEjYs':_0x2a2cb0(0x1d3)},_0x93c351=_0x5ee86f['app']['db'],_0x181544={'pageName':_0x5ee86f['body'][_0x2a2cb0(0x149)],'pageSlug':_0x5ee86f['body'][_0x2a2cb0(0x175)],'pageEnabled':_0x5ee86f[_0x2a2cb0(0x126)][_0x2a2cb0(0x129)],'pageContent':_0x5ee86f['body'][_0x2a2cb0(0x13c)]};if(_0x5ee86f[_0x2a2cb0(0x126)]['pageId']){if(_0x50fc6b[_0x2a2cb0(0x119)]!=='ZBHZD'){const _0x4be0ad=await _0x93c351['pages'][_0x2a2cb0(0x16a)]({'_id':common[_0x2a2cb0(0x18d)](_0x5ee86f[_0x2a2cb0(0x126)][_0x2a2cb0(0xc4)])});if(!_0x4be0ad){_0x1e2fed[_0x2a2cb0(0x10d)](0x190)[_0x2a2cb0(0x158)]({'message':'Page\x20not\x20found'});return;}try{const _0xd2ef9a=await _0x93c351[_0x2a2cb0(0xfc)][_0x2a2cb0(0x157)]({'_id':common['getId'](_0x5ee86f['body'][_0x2a2cb0(0xc4)])},{'$set':_0x181544},{'returnOriginal':![]});_0x1e2fed['status'](0xc8)[_0x2a2cb0(0x158)]({'message':_0x50fc6b[_0x2a2cb0(0x183)],'pageId':_0x5ee86f[_0x2a2cb0(0x126)]['pageId'],'page':_0xd2ef9a[_0x2a2cb0(0x1c4)]});}catch(_0x2566c1){if(_0x50fc6b['DwSoF'](_0x2a2cb0(0x186),_0x50fc6b[_0x2a2cb0(0x1d0)]))_0x1e2fed[_0x2a2cb0(0x10d)](0x190)[_0x2a2cb0(0x158)]({'message':_0x50fc6b[_0x2a2cb0(0x1b3)]});else{_0x17c852['error'](_0x1810e9[_0x2a2cb0(0x120)](_0x50fc6b['lhbsX']+_0x2a741a)),_0x4fbd4c[_0x2a2cb0(0x10d)](0xc8)['json']({'message':_0x50fc6b[_0x2a2cb0(0xac)]});return;}}}else{const _0x262114=_0x165d7d[_0x2a2cb0(0x196)](_0x5a965e,_0x141a19[_0x2a2cb0(0x126)]['menuId']);if(_0x50fc6b[_0x2a2cb0(0x12e)](_0x262114,![])){_0x472056['status'](0x190)['json']({'message':_0x50fc6b[_0x2a2cb0(0xdb)]});return;}_0x4c47fe[_0x2a2cb0(0x10d)](0xc8)['json']({'message':_0x50fc6b['DWdeQ']});}}else try{const _0x1d31a4=await _0x93c351['pages']['insertOne'](_0x181544);_0x1e2fed[_0x2a2cb0(0x10d)](0xc8)[_0x2a2cb0(0x158)]({'message':_0x2a2cb0(0xbc),'pageId':_0x1d31a4['insertedId']});return;}catch(_0x5eb3b2){_0x1e2fed[_0x2a2cb0(0x10d)](0x190)['json']({'message':'Error\x20creating\x20page.\x20Please\x20try\x20again.'});}}),router['post']('/admin/settings/page/delete',restrict,checkAccess,async(_0x464c24,_0x522c39)=>{const _0x4f87af=_0x4e5062,_0x442867={'fgaix':'Error\x20deleting\x20page.\x20Please\x20try\x20again.'},_0x5e388a=_0x464c24[_0x4f87af(0x17b)]['db'],_0x3197e7=await _0x5e388a[_0x4f87af(0xfc)][_0x4f87af(0x16a)]({'_id':common[_0x4f87af(0x18d)](_0x464c24[_0x4f87af(0x126)]['pageId'])});if(!_0x3197e7){_0x522c39['status'](0x190)[_0x4f87af(0x158)]({'message':_0x4f87af(0x164)});return;}try{await _0x5e388a[_0x4f87af(0xfc)][_0x4f87af(0x1b6)]({'_id':common[_0x4f87af(0x18d)](_0x464c24[_0x4f87af(0x126)][_0x4f87af(0xc4)])},{}),_0x522c39[_0x4f87af(0x10d)](0xc8)['json']({'message':'Page\x20successfully\x20deleted'});return;}catch(_0x3004a3){_0x522c39['status'](0x190)[_0x4f87af(0x158)]({'message':_0x442867[_0x4f87af(0xf4)]});}}),router['post']('/admin/settings/menu/new',restrict,checkAccess,(_0xa723d9,_0xfb0f16)=>{const _0x307646=_0x4e5062,_0x3511d2={'tSiAL':function(_0x5be1c6,_0x2406c0){return _0x5be1c6===_0x2406c0;}},_0x2662df=common[_0x307646(0xd4)](_0xa723d9);if(_0x3511d2[_0x307646(0x13b)](_0x2662df,![])){_0xfb0f16[_0x307646(0x10d)](0x190)[_0x307646(0x158)]({'message':_0x307646(0x17c)});return;}_0xfb0f16[_0x307646(0x10d)](0xc8)['json']({'message':_0x307646(0x11b)});}),router[_0x4e5062(0x14a)](_0x4e5062(0xde),restrict,checkAccess,(_0xf2810e,_0x22047c)=>{const _0x553338=_0x4e5062,_0xb64633={'wQKMt':function(_0x4bbb52,_0x55cf03){return _0x4bbb52===_0x55cf03;},'oMdPa':function(_0x27ed5c,_0x584874){return _0x27ed5c!==_0x584874;},'hByjG':_0x553338(0x121),'YNbMF':_0x553338(0xcb),'BSvsm':_0x553338(0xb6)},_0x5139ae=common[_0x553338(0xff)](_0xf2810e);if(_0xb64633[_0x553338(0x161)](_0x5139ae,![])){if(_0xb64633['oMdPa'](_0xb64633[_0x553338(0x136)],_0xb64633[_0x553338(0x136)])){_0x2760ed[_0x553338(0x10d)](0x190)[_0x553338(0x158)]({'message':_0x553338(0x164)});return;}else{_0x22047c[_0x553338(0x10d)](0x190)['json']({'message':_0xb64633[_0x553338(0x165)]});return;}}_0x22047c[_0x553338(0x10d)](0xc8)['json']({'message':_0xb64633[_0x553338(0x1d9)]});}),router['post'](_0x4e5062(0x167),restrict,checkAccess,(_0x21d199,_0x33e6c4)=>{const _0xad4ab6=_0x4e5062,_0x1f47f0=common[_0xad4ab6(0x196)](_0x21d199,_0x21d199[_0xad4ab6(0x126)]['menuId']);if(_0x1f47f0===![]){_0x33e6c4[_0xad4ab6(0x10d)](0x190)['json']({'message':'Failed\x20deleting\x20menu.'});return;}_0x33e6c4[_0xad4ab6(0x10d)](0xc8)[_0xad4ab6(0x158)]({'message':_0xad4ab6(0xd1)});}),router[_0x4e5062(0x14a)](_0x4e5062(0x1c9),restrict,checkAccess,(_0x2ab580,_0x45d340)=>{const _0x403252=_0x4e5062,_0x4de25a={'yDSVB':function(_0x1bc52a,_0x14d484){return _0x1bc52a===_0x14d484;}},_0x4a3dbd=common[_0x403252(0x1a5)](_0x2ab580,_0x45d340);if(_0x4de25a['yDSVB'](_0x4a3dbd,![])){_0x45d340['status'](0x190)[_0x403252(0x158)]({'message':_0x403252(0x105)});return;}_0x45d340[_0x403252(0x10d)](0xc8)[_0x403252(0x158)]({});}),router[_0x4e5062(0x14a)]('/admin/validatePermalink',async(_0x4aa583,_0x470764)=>{const _0x3bf846=_0x4e5062,_0x2b89c9={'ZMWxP':'undefined','ZMiij':function(_0x5e5998,_0x5da1c8){return _0x5e5998>_0x5da1c8;},'DsYtj':_0x3bf846(0x193),'NzVxe':'Permalink\x20validated\x20successfully'},_0x3b6ccc=_0x4aa583[_0x3bf846(0x17b)]['db'];let _0x3c36db={};typeof _0x4aa583['body'][_0x3bf846(0xf6)]===_0x2b89c9[_0x3bf846(0x1c7)]||_0x4aa583[_0x3bf846(0x126)]['docId']===''?_0x3c36db={'productPermalink':_0x4aa583['body']['permalink']}:_0x3c36db={'productPermalink':_0x4aa583['body'][_0x3bf846(0x178)],'_id':{'$ne':common[_0x3bf846(0x18d)](_0x4aa583[_0x3bf846(0x126)]['docId'])}};const _0x517e68=await _0x3b6ccc[_0x3bf846(0x11c)][_0x3bf846(0x141)](_0x3c36db);if(_0x517e68&&_0x2b89c9['ZMiij'](_0x517e68,0x0)){_0x470764['status'](0x190)[_0x3bf846(0x158)]({'message':_0x2b89c9[_0x3bf846(0xea)]});return;}_0x470764[_0x3bf846(0x10d)](0xc8)['json']({'message':_0x2b89c9[_0x3bf846(0x162)]});}),router['get']('/admin/settings/discounts',csrfProtection,restrict,checkAccess,async(_0x43a704,_0x4805bb)=>{const _0x28602a=_0x4e5062,_0x137030={'ZCceo':_0x28602a(0x122),'RIGgF':_0x28602a(0x174)},_0x743cfa=_0x43a704[_0x28602a(0x17b)]['db'],_0x1b581f=await _0x743cfa[_0x28602a(0x148)][_0x28602a(0x1d2)]({})[_0x28602a(0x1cc)]();_0x4805bb['render'](_0x28602a(0xc5),{'title':_0x28602a(0xc0),'config':_0x43a704[_0x28602a(0x17b)]['config'],'session':_0x43a704[_0x28602a(0x15d)],'discounts':_0x1b581f,'admin':!![],'message':common[_0x28602a(0x103)](_0x43a704[_0x28602a(0x15d)],_0x137030[_0x28602a(0xd9)]),'messageType':common[_0x28602a(0x103)](_0x43a704[_0x28602a(0x15d)],_0x137030[_0x28602a(0x14e)]),'helpers':_0x43a704[_0x28602a(0x1d6)][_0x28602a(0x160)],'csrfToken':_0x43a704['csrfToken']()});}),router[_0x4e5062(0x1aa)](_0x4e5062(0xb8),csrfProtection,restrict,checkAccess,async(_0x5d4b5b,_0x428429)=>{const _0x285ef6=_0x4e5062,_0x254690={'WPVaJ':_0x285ef6(0x174)},_0x359afd=_0x5d4b5b[_0x285ef6(0x17b)]['db'],_0x25cabf=await _0x359afd['discounts']['findOne']({'_id':common[_0x285ef6(0x18d)](_0x5d4b5b[_0x285ef6(0x1bb)]['id'])});_0x428429[_0x285ef6(0x139)](_0x285ef6(0x18b),{'title':_0x285ef6(0x1ca),'session':_0x5d4b5b['session'],'admin':!![],'discount':_0x25cabf,'message':common[_0x285ef6(0x103)](_0x5d4b5b['session'],_0x285ef6(0x122)),'messageType':common[_0x285ef6(0x103)](_0x5d4b5b['session'],_0x254690[_0x285ef6(0x190)]),'helpers':_0x5d4b5b[_0x285ef6(0x1d6)][_0x285ef6(0x160)],'config':_0x5d4b5b[_0x285ef6(0x17b)][_0x285ef6(0xe4)],'csrfToken':_0x5d4b5b[_0x285ef6(0x113)]()});}),router[_0x4e5062(0x14a)](_0x4e5062(0xd6),restrict,checkAccess,async(_0x14a7e8,_0xc33e56)=>{const _0x2ab17f=_0x4e5062,_0x2d0447={'kfGrw':function(_0x2df115,_0x3201c6){return _0x2df115(_0x3201c6);},'hfbpg':function(_0x5a4739,_0x305ed1,_0x14ab3b){return _0x5a4739(_0x305ed1,_0x14ab3b);},'QXVKH':_0x2ab17f(0xe7),'yuITi':function(_0x55b4af,_0x5b7203){return _0x55b4af(_0x5b7203);},'hPqPp':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today','DHRdd':function(_0x2ca569,_0x1e4c85){return _0x2ca569(_0x1e4c85);},'yXwpF':'Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date'},_0x126177=_0x14a7e8[_0x2ab17f(0x17b)]['db'],_0xab4f1={'discountId':_0x14a7e8[_0x2ab17f(0x126)][_0x2ab17f(0xaf)],'code':_0x14a7e8[_0x2ab17f(0x126)]['code'],'type':_0x14a7e8[_0x2ab17f(0x126)][_0x2ab17f(0x10e)],'value':_0x2d0447[_0x2ab17f(0xf2)](parseInt,_0x14a7e8['body']['value']),'start':_0x2d0447['hfbpg'](moment,_0x14a7e8['body']['start'],_0x2d0447['QXVKH'])[_0x2ab17f(0x18f)](),'end':moment(_0x14a7e8[_0x2ab17f(0x126)][_0x2ab17f(0xc6)],_0x2ab17f(0xe7))[_0x2ab17f(0x18f)]()},_0x2f4008=validateJson(_0x2ab17f(0xce),_0xab4f1);if(!_0x2f4008[_0x2ab17f(0x1af)]){_0xc33e56[_0x2ab17f(0x10d)](0x190)['json'](_0x2f4008['errors']);return;}if(_0x2d0447[_0x2ab17f(0x188)](moment,_0xab4f1[_0x2ab17f(0xee)])['isBefore'](moment())){_0xc33e56['status'](0x190)['json']({'message':_0x2d0447[_0x2ab17f(0x145)]});return;}if(!moment(_0xab4f1[_0x2ab17f(0xc6)])['isAfter'](_0x2d0447[_0x2ab17f(0x1b4)](moment,_0xab4f1[_0x2ab17f(0xee)]))){_0xc33e56['status'](0x190)['json']({'message':_0x2d0447[_0x2ab17f(0xd2)]});return;}const _0x4574ba=await _0x126177[_0x2ab17f(0x148)]['countDocuments']({'code':_0xab4f1[_0x2ab17f(0xd5)],'_id':{'$ne':common['getId'](_0xab4f1[_0x2ab17f(0xaf)])}});if(_0x4574ba){_0xc33e56['status'](0x190)[_0x2ab17f(0x158)]({'message':_0x2ab17f(0xe3)});return;}delete _0xab4f1[_0x2ab17f(0xaf)];try{await _0x126177['discounts'][_0x2ab17f(0x127)]({'_id':common[_0x2ab17f(0x18d)](_0x14a7e8[_0x2ab17f(0x126)][_0x2ab17f(0xaf)])},{'$set':_0xab4f1},{}),_0xc33e56['status'](0xc8)[_0x2ab17f(0x158)]({'message':'Successfully\x20saved','discount':_0xab4f1});}catch(_0x1a152e){_0xc33e56[_0x2ab17f(0x10d)](0x190)[_0x2ab17f(0x158)]({'message':'Failed\x20to\x20save.\x20Please\x20try\x20again'});}}),router['get'](_0x4e5062(0x1d5),csrfProtection,restrict,checkAccess,async(_0x53c6b7,_0x19a526)=>{const _0x1a140e=_0x4e5062;_0x19a526[_0x1a140e(0x139)](_0x1a140e(0x11a),{'title':_0x1a140e(0x118),'session':_0x53c6b7[_0x1a140e(0x15d)],'admin':!![],'message':common[_0x1a140e(0x103)](_0x53c6b7['session'],_0x1a140e(0x122)),'messageType':common[_0x1a140e(0x103)](_0x53c6b7['session'],_0x1a140e(0x174)),'helpers':_0x53c6b7['handlebars']['helpers'],'config':_0x53c6b7['app'][_0x1a140e(0xe4)],'csrfToken':_0x53c6b7[_0x1a140e(0x113)]()});}),router['post'](_0x4e5062(0x17e),csrfProtection,restrict,checkAccess,async(_0xd7919b,_0x3eb72a)=>{const _0x3cbe32=_0x4e5062,_0x11950a={'tWcWX':function(_0x4b3c58,_0x58347c){return _0x4b3c58(_0x58347c);},'YpzwW':function(_0x494484,_0x230be3,_0x69e039){return _0x494484(_0x230be3,_0x69e039);},'JaBAi':_0x3cbe32(0xe3),'IGTpf':function(_0x5d2940){return _0x5d2940();},'WVQPI':_0x3cbe32(0x166),'piwkY':function(_0x2cf3f7,_0x40d7ee){return _0x2cf3f7(_0x40d7ee);},'ycZUh':_0x3cbe32(0x199),'KJkgv':'Discount\x20code\x20created\x20successfully'},_0x166399=_0xd7919b[_0x3cbe32(0x17b)]['db'],_0x5a791c={'code':_0xd7919b[_0x3cbe32(0x126)]['code'],'type':_0xd7919b[_0x3cbe32(0x126)][_0x3cbe32(0x10e)],'value':_0x11950a[_0x3cbe32(0x152)](parseInt,_0xd7919b['body'][_0x3cbe32(0x1c4)]),'start':moment(_0xd7919b[_0x3cbe32(0x126)][_0x3cbe32(0xee)],_0x3cbe32(0xe7))[_0x3cbe32(0x18f)](),'end':moment(_0xd7919b[_0x3cbe32(0x126)]['end'],'DD/MM/YYYY\x20HH:mm')[_0x3cbe32(0x18f)]()},_0x6a6281=_0x11950a[_0x3cbe32(0x12a)](validateJson,_0x3cbe32(0x12d),_0x5a791c);if(!_0x6a6281[_0x3cbe32(0x1af)]){_0x3eb72a[_0x3cbe32(0x10d)](0x190)[_0x3cbe32(0x158)](_0x6a6281[_0x3cbe32(0x185)]);return;}const _0xe4d299=await _0x166399[_0x3cbe32(0x148)]['countDocuments']({'code':_0x5a791c[_0x3cbe32(0xd5)]});if(_0xe4d299){_0x3eb72a[_0x3cbe32(0x10d)](0x190)[_0x3cbe32(0x158)]({'message':_0x11950a[_0x3cbe32(0xbf)]});return;}if(moment(_0x5a791c[_0x3cbe32(0xee)])['isBefore'](_0x11950a[_0x3cbe32(0x13d)](moment))){_0x3eb72a[_0x3cbe32(0x10d)](0x190)[_0x3cbe32(0x158)]({'message':_0x11950a[_0x3cbe32(0x18e)]});return;}if(!_0x11950a[_0x3cbe32(0x14c)](moment,_0x5a791c[_0x3cbe32(0xc6)])[_0x3cbe32(0x1ac)](moment(_0x5a791c['start']))){_0x3eb72a[_0x3cbe32(0x10d)](0x190)[_0x3cbe32(0x158)]({'message':_0x11950a['ycZUh']});return;}const _0x4fae82=await _0x166399['discounts']['insertOne'](_0x5a791c);_0x3eb72a['status'](0xc8)[_0x3cbe32(0x158)]({'message':_0x11950a[_0x3cbe32(0x100)],'discountId':_0x4fae82[_0x3cbe32(0xda)]});}),router[_0x4e5062(0x134)]('/admin/settings/discount/delete',restrict,checkAccess,async(_0x5715dc,_0x24d00e)=>{const _0x27112b=_0x4e5062,_0x5ed931=_0x5715dc['app']['db'];try{await _0x5ed931[_0x27112b(0x148)][_0x27112b(0x1b6)]({'_id':common[_0x27112b(0x18d)](_0x5715dc[_0x27112b(0x126)][_0x27112b(0xaf)])},{}),_0x24d00e[_0x27112b(0x10d)](0xc8)[_0x27112b(0x158)]({'message':'Discount\x20code\x20successfully\x20deleted'});return;}catch(_0x187246){_0x24d00e[_0x27112b(0x10d)](0x190)[_0x27112b(0x158)]({'message':_0x27112b(0xb9)});}});const upload=multer({'dest':_0x4e5062(0x11f)});router[_0x4e5062(0x14a)](_0x4e5062(0x1dc),restrict,checkAccess,upload['single'](_0x4e5062(0x1a3)),async(_0x27b140,_0x81755f)=>{const _0x31b38f=_0x4e5062,_0x149db6={'mgtBf':function(_0x4000e1,_0x26e2d6){return _0x4000e1>_0x26e2d6;},'RlAQu':_0x31b38f(0xb7),'OfqCl':_0x31b38f(0x19b),'ihonR':_0x31b38f(0x146),'LmLds':_0x31b38f(0x169)},_0x18085c=_0x27b140[_0x31b38f(0x17b)]['db'];if(_0x27b140[_0x31b38f(0x16b)]){const _0x4b835b=_0x27b140[_0x31b38f(0x16b)],_0x455e98=mime[_0x31b38f(0x13e)](_0x4b835b[_0x31b38f(0x1a2)]);if(!common[_0x31b38f(0x194)][_0x31b38f(0x153)](_0x455e98)||_0x149db6[_0x31b38f(0x112)](_0x4b835b[_0x31b38f(0xb4)],common[_0x31b38f(0x1ab)])){fs[_0x31b38f(0x182)](_0x4b835b[_0x31b38f(0x1ce)]),_0x81755f[_0x31b38f(0x10d)](0x190)[_0x31b38f(0x158)]({'message':_0x149db6['RlAQu']});return;}const _0x2e4696=await _0x18085c[_0x31b38f(0x11c)]['findOne']({'_id':common[_0x31b38f(0x18d)](_0x27b140[_0x31b38f(0x126)][_0x31b38f(0x19d)])});if(!_0x2e4696){fs[_0x31b38f(0x182)](_0x4b835b['path']),_0x81755f[_0x31b38f(0x10d)](0x190)[_0x31b38f(0x158)]({'message':_0x31b38f(0x19e)});return;}const _0x23ded9=_0x2e4696['_id'][_0x31b38f(0x1b9)](),_0x393db2=path[_0x31b38f(0x15a)](_0x149db6['OfqCl'],_0x23ded9);common[_0x31b38f(0x1a8)](_0x393db2);const _0x1ca120=fs[_0x31b38f(0x1bc)](_0x4b835b['path']),_0x549d13=fs[_0x31b38f(0x137)](path[_0x31b38f(0x15a)](_0x393db2,_0x4b835b[_0x31b38f(0x1a2)][_0x31b38f(0xf1)](/ /g,'_')));_0x1ca120[_0x31b38f(0x1da)](_0x549d13),_0x1ca120['on'](_0x31b38f(0xc6),()=>{}),fs[_0x31b38f(0x182)](_0x4b835b[_0x31b38f(0x1ce)]);const _0x4f1208=path['join'](_0x149db6['ihonR'],_0x23ded9,_0x4b835b['originalname'][_0x31b38f(0xf1)](/ /g,'_'));!_0x2e4696[_0x31b38f(0x197)]&&await _0x18085c[_0x31b38f(0x11c)]['updateOne']({'_id':common[_0x31b38f(0x18d)](_0x27b140[_0x31b38f(0x126)][_0x31b38f(0x19d)])},{'$set':{'productImage':_0x4f1208}},{'multi':![]});_0x81755f[_0x31b38f(0x10d)](0xc8)['json']({'message':_0x149db6['LmLds']});return;}_0x81755f[_0x31b38f(0x10d)](0x190)[_0x31b38f(0x158)]({'message':_0x31b38f(0x19e)});}),router[_0x4e5062(0x14a)](_0x4e5062(0x179),restrict,(_0x5b4c60,_0x473c9e)=>{const _0x285858=_0x4e5062,_0x262a88={'FCzmq':'expressCart\x20test\x20email','lSNpN':_0x285858(0x1d4)},_0x3058be=_0x5b4c60[_0x285858(0x17b)][_0x285858(0xe4)];common[_0x285858(0x1e0)](_0x3058be[_0x285858(0xb0)],_0x262a88[_0x285858(0x101)],_0x262a88[_0x285858(0xcd)]),_0x473c9e[_0x285858(0x10d)](0xc8)[_0x285858(0x158)]({'message':_0x285858(0xc3)});}),router[_0x4e5062(0x14a)](_0x4e5062(0xf3),restrict,async(_0x2b033a,_0x57d755,_0x85180d)=>{const _0x1bd7a9=_0x4e5062,_0x11cfc8={'zygty':_0x1bd7a9(0x106),'gTfcE':'Login','iQONA':_0x1bd7a9(0xe8),'OdfCX':_0x1bd7a9(0x174),'BfwgH':'showFooter','PDZij':'/admin/dashboard','HDFAH':function(_0x4d97d0,_0x1127c8){return _0x4d97d0!==_0x1127c8;},'VyQHI':_0x1bd7a9(0x117),'JTHnS':function(_0x3e4d8c,_0x2f3d71){return _0x3e4d8c===_0x2f3d71;},'kPXvT':'zNQFN','cCZmn':_0x1bd7a9(0xed),'ptffv':function(_0x4194da,_0x2958ba){return _0x4194da!==_0x2958ba;}},_0x4dc8b4=_0x2b033a[_0x1bd7a9(0x17b)]['db'],_0x59f7c7=_0x2b033a[_0x1bd7a9(0x126)][_0x1bd7a9(0x123)],_0x26bc74=0x5;let _0x12d829=[],_0x34e61a=[],_0x4c032c=[];const _0x42f2c1={},_0x3cee8d={},_0x4b3497={};if(ObjectId[_0x1bd7a9(0x1b5)](_0x2b033a[_0x1bd7a9(0x126)]['searchValue']))return _0x12d829=await _0x4dc8b4[_0x1bd7a9(0xf9)][_0x1bd7a9(0x1d2)]({'_id':ObjectId(_0x59f7c7)})[_0x1bd7a9(0x17d)](_0x26bc74)[_0x1bd7a9(0x130)]({'created':0x1})[_0x1bd7a9(0x1cc)](),_0x34e61a=await _0x4dc8b4[_0x1bd7a9(0xae)][_0x1bd7a9(0x1d2)]({'_id':ObjectId(_0x59f7c7)})[_0x1bd7a9(0x17d)](_0x26bc74)[_0x1bd7a9(0x130)]({'orderDate':0x1})['toArray'](),_0x4c032c=await _0x4dc8b4[_0x1bd7a9(0x11c)][_0x1bd7a9(0x1d2)]({'_id':ObjectId(_0x59f7c7)})['limit'](_0x26bc74)['sort']({'productAddedDate':0x1})['toArray'](),_0x57d755['status'](0xc8)[_0x1bd7a9(0x158)]({'customers':_0x12d829,'orders':_0x34e61a,'products':_0x4c032c});if(emailRegex[_0x1bd7a9(0x131)](_0x2b033a[_0x1bd7a9(0x126)]['searchValue']))_0x42f2c1[_0x1bd7a9(0x1c6)]=_0x59f7c7,_0x3cee8d[_0x1bd7a9(0x115)]=_0x59f7c7;else numericRegex['test'](_0x2b033a[_0x1bd7a9(0x126)][_0x1bd7a9(0x123)])?_0x11cfc8[_0x1bd7a9(0x1db)](_0x1bd7a9(0x1ad),'ShNFC')?(_0x3cee8d[_0x1bd7a9(0x15c)]=_0x2b033a['body'][_0x1bd7a9(0x123)],_0x4b3497['productPrice']=_0x2b033a[_0x1bd7a9(0x126)][_0x1bd7a9(0x123)]):(_0x46fe9d['session'][_0x1bd7a9(0xf5)]=![],_0xc63449[_0x1bd7a9(0x139)](_0x11cfc8[_0x1bd7a9(0x1b1)],{'title':_0x11cfc8[_0x1bd7a9(0x18a)],'referringUrl':_0x39eedf['header'](_0x11cfc8['iQONA']),'config':_0x49e28b[_0x1bd7a9(0x17b)]['config'],'message':_0x2415ee[_0x1bd7a9(0x103)](_0x3c7ec3[_0x1bd7a9(0x15d)],'message'),'messageType':_0x24dab6[_0x1bd7a9(0x103)](_0x17e0cd[_0x1bd7a9(0x15d)],_0x11cfc8[_0x1bd7a9(0x13f)]),'helpers':_0x577c51[_0x1bd7a9(0x1d6)]['helpers'],'showFooter':_0x11cfc8[_0x1bd7a9(0x10b)]})):(_0x42f2c1['$or']=[{'firstName':{'$regex':new RegExp(_0x59f7c7,_0x11cfc8[_0x1bd7a9(0x19a)])}},{'lastName':{'$regex':new RegExp(_0x59f7c7,_0x11cfc8[_0x1bd7a9(0x19a)])}}],_0x3cee8d[_0x1bd7a9(0xc1)]=[{'orderFirstname':{'$regex':new RegExp(_0x59f7c7,_0x1bd7a9(0x117))}},{'orderLastname':{'$regex':new RegExp(_0x59f7c7,_0x11cfc8[_0x1bd7a9(0x19a)])}}],_0x4b3497[_0x1bd7a9(0xc1)]=[{'productTitle':{'$regex':new RegExp(_0x59f7c7,_0x11cfc8['VyQHI'])}},{'productDescription':{'$regex':new RegExp(_0x59f7c7,_0x11cfc8[_0x1bd7a9(0x19a)])}}]);if(Object[_0x1bd7a9(0x12b)](_0x42f2c1)[_0x1bd7a9(0x151)]>0x0){if(_0x11cfc8['JTHnS'](_0x11cfc8[_0x1bd7a9(0x1b2)],_0x11cfc8[_0x1bd7a9(0x195)])){_0x66696c[_0x1bd7a9(0x182)](_0x28c36c[_0x1bd7a9(0x1ce)]),_0x4bc3df[_0x1bd7a9(0x10d)](0x190)['json']({'message':_0x1bd7a9(0xb7)});return;}else _0x12d829=await _0x4dc8b4[_0x1bd7a9(0xf9)]['find'](_0x42f2c1)[_0x1bd7a9(0x17d)](_0x26bc74)[_0x1bd7a9(0x130)]({'created':0x1})['toArray']();}return Object[_0x1bd7a9(0x12b)](_0x3cee8d)[_0x1bd7a9(0x151)]>0x0&&(_0x34e61a=await _0x4dc8b4['orders'][_0x1bd7a9(0x1d2)](_0x3cee8d)[_0x1bd7a9(0x17d)](_0x26bc74)[_0x1bd7a9(0x130)]({'orderDate':0x1})[_0x1bd7a9(0x1cc)]()),Object[_0x1bd7a9(0x12b)](_0x4b3497)['length']>0x0&&(_0x11cfc8[_0x1bd7a9(0x19c)](_0x1bd7a9(0x140),_0x1bd7a9(0x140))?_0x2051c8[_0x1bd7a9(0x1be)](_0x11cfc8[_0x1bd7a9(0x15b)]):_0x4c032c=await _0x4dc8b4[_0x1bd7a9(0x11c)][_0x1bd7a9(0x1d2)](_0x4b3497)['limit'](_0x26bc74)[_0x1bd7a9(0x130)]({'productAddedDate':0x1})[_0x1bd7a9(0x1cc)]()),_0x57d755[_0x1bd7a9(0x10d)](0xc8)[_0x1bd7a9(0x158)]({'customers':_0x12d829,'orders':_0x34e61a,'products':_0x4c032c});}),module['exports']=router;