function _0x18ec(){const _0x126814=['cwrmx','yNCOj','Menu\x20updated\x20successfully.','exports','$orderProductCount','Permalink\x20already\x20exists','session','fDeMy','/admin/settings/menu/update','Error\x20deleting\x20discount\x20code.\x20Please\x20try\x20again.','/admin/settings/menu/new','code','footerHtml','Update','lookup','ouPPz','Setup\x20failed','emailAddress','keys','McfhC','EtRNu','nrTLB','0|5|1|3|4|2','Already\x20setup.','userId','split','Discount\x20code\x20edit','$o.v.productId','unlinkSync','/admin/createApiKey','nlJYF','get','end','aWmoe','deleteOne','BdMbt','message','/admin/settings/update','../lib/schema','$orderTotal','fbWWf','Lqqvp','Login\x20successful','sghLT','DD/MM/YYYY\x20HH:mm','Failed\x20to\x20generate\x20API\x20Key','/admin/login','searchValue','value','API\x20Key\x20generated','getConfig','iNmFc','Error\x20creating\x20page.\x20Please\x20try\x20again.','LaFJP','toString','/admin/settings/menu/delete','yDIST','Error\x20deleting\x20page.\x20Please\x20try\x20again.','RsCyR','qOwtd','kpjrc','Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date','RevpZ','YziIH','ooahm','delete','express','find','OnKTz','XvAdO','/admin/validatePermalink','checkDirectorySync','customers','helpers','/admin/dashboard','Failed\x20creating\x20menu.','settings-pages','header','nZXsC','settings-page','pipe','mPZvV','undefined','vHlEK','aggregate','3PGgSCi','3|4|0|1|2|5','tMuFP','127507jRFigI','status','Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.','colors','/admin/settings/pages/edit/:page','pageEnabled','luhsX','/admin/searchall','originalname','wnDaK','/admin/file/upload','404\x20Error\x20-\x20Page\x20not\x20found','sortMenu','xcgFS','HjfHp','isBefore','/admin/settings/page','login','Permalink\x20validated\x20successfully','gOWxD','createWriteStream','errors','user','productPrice','qBLCs','Create','sNvVq','NdvSR','deleteMenu','FCMES','hTbrs','multer','yvZCK','oGokH','email','join','1216372XvxMUv','/admin/settings/discount/delete','/admin/settings/discount/update','EJhQr','605JeGFrO','sygjp','post','isAfter','compare','messageType','aoagG','RUidf','dashboard','IloMy','img','Discount\x20code','lmsJk','Failed\x20updating\x20menu.','error','../lib/common','getThemes','Cart\x20settings','handlebars','Failed\x20saving\x20menu\x20order','users','/admin/setup','qRkHC','Static\x20pages','/admin/logout','/admin','Menu\x20created\x20successfully.','usersName','Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today','EZTNO','Discount\x20code\x20successfully\x20deleted','replace','html-entities','productId','Failed\x20deleting\x20menu.','CizWt','htYRp','iEDeo','findOneAndUpdate','discountId','updateConfig','nDjLg','productsSold','length','Menu\x20deleted\x20successfully.','decode','type','koilv','start','Page\x20updated\x20successfully','redirect','33617160omnfiZ','5ZLVObI','needsSetup','BljIK','/admin/settings/menu','file','uQnsA','sort','sum','18pdUvDa','wtKRm','settings-discount-new','1870064jKXlkv','isValid','BIRQC','290270haTIXe','Discount\x20code\x20create','config','toDate','sendEmail','../lib/auth','/uploads','/admin/settings/menu/saveOrder','googleAnalytics','/admin/settings/page/delete','render','xkULl','NCWCH','Page\x20successfully\x20deleted','products','mongoSanitize','ordersAmount','File\x20uploaded\x20successfully','xwCLq','2522376GrrKVU','WyEIK','CzgXH','path','AllHtmlEntities','discounts','Permission\x20denied','User\x20account\x20inserted','_id','KLNud','$o.v.quantity','$or','Discount\x20code\x20already\x20exists','fileSizeLimit','wzQnv','224QHpCcE','getId','fVLmp','showFooter','orders','rUaVX','OqegG','orderEmail','Test\x20email\x20sent','Referer','updateMenu','File\x20upload\x20error.\x20Please\x20try\x20again.','mime-type/with-db','Setup','findOne','getMenu','then','insertedId','/admin/settings','JfwDd','docId','test','zbTrz','nfXtT','newDiscount','qeJCU','File\x20type\x20not\x20allowed\x20or\x20too\x20large.\x20Please\x20try\x20again.','single','allowedMimeType','isAdmin','BMXWx','public/uploads/','xihLE','New\x20page\x20successfully\x20created','fZKTW','$o.v.title','params','Successfully\x20saved','updateOne','insertOne','kwwgJ','editDiscount','Page\x20not\x20found','DHixL','pageContent','KZZcN','userPassword','omVDB','pageId','ijcsY','Failed\x20to\x20insert\x20user:\x20','app','Discount\x20code\x20created\x20successfully','apiKey','pages','173772DWNhPi','pageSlug','ObjectID','countDocuments','/admin/testEmail','limit','json','body','aRPpA','MVXOm','DOAPg','toArray','Your\x20email\x20settings\x20are\x20working','settings-discount-edit','fwCVo','clearSessionValue','moment'];_0x18ec=function(){return _0x126814;};return _0x18ec();}const _0xa5ffe0=_0x2a13;(function(_0x200c00,_0x3d3f3e){const _0x149ffb=_0x2a13,_0x579a94=_0x200c00();while(!![]){try{const _0x7b163c=parseInt(_0x149ffb(0x266))/0x1*(parseInt(_0x149ffb(0x2ca))/0x2)+-parseInt(_0x149ffb(0x263))/0x3*(parseInt(_0x149ffb(0x28a))/0x4)+-parseInt(_0x149ffb(0x2c2))/0x5*(parseInt(_0x149ffb(0x2e3))/0x6)+-parseInt(_0x149ffb(0x2cd))/0x7+-parseInt(_0x149ffb(0x2f2))/0x8*(parseInt(_0x149ffb(0x1fd))/0x9)+parseInt(_0x149ffb(0x2d0))/0xa*(-parseInt(_0x149ffb(0x28e))/0xb)+parseInt(_0x149ffb(0x2c1))/0xc;if(_0x7b163c===_0x3d3f3e)break;else _0x579a94['push'](_0x579a94['shift']());}catch(_0x175eb9){_0x579a94['push'](_0x579a94['shift']());}}}(_0x18ec,0xc8413));const express=require(_0xa5ffe0(0x250)),common=require(_0xa5ffe0(0x29d)),{restrict,checkAccess}=require(_0xa5ffe0(0x2d5)),escape=require(_0xa5ffe0(0x2ae))[_0xa5ffe0(0x2e7)],colors=require(_0xa5ffe0(0x269)),bcrypt=require('bcryptjs'),moment=require(_0xa5ffe0(0x20d)),fs=require('fs'),path=require('path'),multer=require(_0xa5ffe0(0x285)),mime=require(_0xa5ffe0(0x2fe)),{validateJson}=require(_0xa5ffe0(0x234)),ObjectId=require('mongodb')[_0xa5ffe0(0x1ff)],router=express['Router'](),emailRegex=/\S+@\S+\.\S+/,numericRegex=/^\d*\.?\d*$/;function _0x2a13(_0x3ff0e8,_0x477f7a){const _0x18ecaa=_0x18ec();return _0x2a13=function(_0x2a1353,_0x4e01f9){_0x2a1353=_0x2a1353-0x1e2;let _0xc919c1=_0x18ecaa[_0x2a1353];return _0xc919c1;},_0x2a13(_0x3ff0e8,_0x477f7a);}router[_0xa5ffe0(0x22d)](_0xa5ffe0(0x2a7),restrict,(_0x15dbf7,_0x97653c,_0x1dd4f1)=>{const _0x2a4ac0=_0xa5ffe0;_0x97653c[_0x2a4ac0(0x2c0)](_0x2a4ac0(0x258));}),router[_0xa5ffe0(0x22d)](_0xa5ffe0(0x2a6),(_0xdca1f,_0xf3cdef)=>{const _0xe58fd7=_0xa5ffe0;_0xdca1f[_0xe58fd7(0x214)][_0xe58fd7(0x27c)]=null,_0xdca1f['session'][_0xe58fd7(0x232)]=null,_0xdca1f[_0xe58fd7(0x214)][_0xe58fd7(0x293)]=null,_0xf3cdef[_0xe58fd7(0x2c0)]('/');}),router['get'](_0xa5ffe0(0x23c),async(_0x33e07a,_0x1131aa)=>{const _0x4d8849=_0xa5ffe0,_0x2e6ee7={'McfhC':function(_0x5eb506,_0x59226e){return _0x5eb506>_0x59226e;},'WyEIK':_0x4d8849(0x277),'iNmFc':_0x4d8849(0x293),'JfwDd':_0x4d8849(0x2a3)},_0x909e4a=_0x33e07a[_0x4d8849(0x1f9)]['db'],_0x5c5a12=await _0x909e4a[_0x4d8849(0x2a2)][_0x4d8849(0x200)]({});_0x5c5a12&&_0x2e6ee7[_0x4d8849(0x221)](_0x5c5a12,0x0)?(_0x33e07a['session'][_0x4d8849(0x2c3)]=![],_0x1131aa[_0x4d8849(0x2da)](_0x2e6ee7[_0x4d8849(0x2e4)],{'title':'Login','referringUrl':_0x33e07a[_0x4d8849(0x25b)](_0x4d8849(0x2fb)),'config':_0x33e07a[_0x4d8849(0x1f9)][_0x4d8849(0x2d2)],'message':common[_0x4d8849(0x20c)](_0x33e07a['session'],_0x4d8849(0x232)),'messageType':common[_0x4d8849(0x20c)](_0x33e07a[_0x4d8849(0x214)],_0x2e6ee7[_0x4d8849(0x241)]),'helpers':_0x33e07a['handlebars']['helpers'],'showFooter':'showFooter'})):(_0x33e07a[_0x4d8849(0x214)][_0x4d8849(0x2c3)]=!![],_0x1131aa[_0x4d8849(0x2c0)](_0x2e6ee7[_0x4d8849(0x305)]));}),router[_0xa5ffe0(0x290)]('/admin/login_action',async(_0x1484e9,_0x59e687)=>{const _0x179323=_0xa5ffe0,_0xeb0a37={'bQzNz':_0x179323(0x264),'RsCyR':_0x179323(0x238),'DHixL':_0x179323(0x268)},_0x229e90=_0x1484e9[_0x179323(0x1f9)]['db'],_0x30321f=await _0x229e90['users'][_0x179323(0x300)]({'userEmail':common[_0x179323(0x2df)](_0x1484e9[_0x179323(0x204)][_0x179323(0x288)])});if(!_0x30321f||_0x30321f===null){_0x59e687[_0x179323(0x267)](0x190)['json']({'message':'A\x20user\x20with\x20that\x20email\x20does\x20not\x20exist.'});return;}bcrypt[_0x179323(0x292)](_0x1484e9[_0x179323(0x204)]['password'],_0x30321f['userPassword'])[_0x179323(0x302)](_0x4e5659=>{const _0xde8f5b=_0x179323;if(_0x4e5659){const _0x534304=_0xeb0a37['bQzNz'][_0xde8f5b(0x227)]('|');let _0x4ef580=0x0;while(!![]){switch(_0x534304[_0x4ef580++]){case'0':_0x1484e9['session'][_0xde8f5b(0x226)]=_0x30321f[_0xde8f5b(0x2eb)][_0xde8f5b(0x244)]();continue;case'1':_0x1484e9[_0xde8f5b(0x214)][_0xde8f5b(0x1e3)]=_0x30321f[_0xde8f5b(0x1e3)];continue;case'2':_0x59e687['status'](0xc8)['json']({'message':_0xeb0a37[_0xde8f5b(0x248)]});continue;case'3':_0x1484e9[_0xde8f5b(0x214)]['user']=_0x1484e9[_0xde8f5b(0x204)][_0xde8f5b(0x288)];continue;case'4':_0x1484e9[_0xde8f5b(0x214)]['usersName']=_0x30321f[_0xde8f5b(0x2a9)];continue;case'5':return;}break;}}_0x59e687[_0xde8f5b(0x267)](0x190)['json']({'message':_0xeb0a37[_0xde8f5b(0x1f1)]});});}),router[_0xa5ffe0(0x22d)](_0xa5ffe0(0x2a3),async(_0x336466,_0x1c68c7)=>{const _0x57ee25=_0xa5ffe0,_0x1980f6={'gOWxD':function(_0x1ef338,_0x5e2c62){return _0x1ef338===_0x5e2c62;},'MVXOm':_0x57ee25(0x232),'koilv':_0x57ee25(0x293),'ZJVuI':_0x57ee25(0x23c)},_0x31de5d=_0x336466['app']['db'],_0x470747=await _0x31de5d['users'][_0x57ee25(0x200)]({});_0x336466[_0x57ee25(0x214)][_0x57ee25(0x2c3)]=![];if(_0x1980f6[_0x57ee25(0x279)](_0x470747,0x0)){_0x336466['session']['needsSetup']=!![],_0x1c68c7[_0x57ee25(0x2da)]('setup',{'title':_0x57ee25(0x2ff),'config':_0x336466[_0x57ee25(0x1f9)][_0x57ee25(0x2d2)],'helpers':_0x336466[_0x57ee25(0x2a0)][_0x57ee25(0x257)],'message':common['clearSessionValue'](_0x336466[_0x57ee25(0x214)],_0x1980f6[_0x57ee25(0x206)]),'messageType':common[_0x57ee25(0x20c)](_0x336466[_0x57ee25(0x214)],_0x1980f6[_0x57ee25(0x2bd)]),'showFooter':'showFooter'});return;}_0x1c68c7[_0x57ee25(0x2c0)](_0x1980f6['ZJVuI']);}),router['post']('/admin/setup_action',async(_0x2a8f13,_0x17adbd)=>{const _0x2382fe=_0xa5ffe0,_0x572c6d={'DOAPg':function(_0x5ba431,_0x5b7a5){return _0x5ba431===_0x5b7a5;},'ZoMHL':function(_0x381021,_0x3dfb51){return _0x381021+_0x3dfb51;}},_0x19c289=_0x2a8f13[_0x2382fe(0x1f9)]['db'],_0xedb1d3={'usersName':_0x2a8f13[_0x2382fe(0x204)][_0x2382fe(0x2a9)],'userEmail':_0x2a8f13[_0x2382fe(0x204)]['userEmail'],'userPassword':bcrypt['hashSync'](_0x2a8f13[_0x2382fe(0x204)][_0x2382fe(0x1f4)],0xa),'isAdmin':!![],'isOwner':!![]},_0xa17dc=await _0x19c289[_0x2382fe(0x2a2)][_0x2382fe(0x200)]({});if(_0xa17dc===0x0)try{if(_0x2382fe(0x29a)===_0x2382fe(0x24e))_0x514810['email']=_0x1a39f5,_0x45fe8c['orderEmail']=_0x13146d;else{await _0x19c289['users'][_0x2382fe(0x1ed)](_0xedb1d3),_0x17adbd[_0x2382fe(0x267)](0xc8)[_0x2382fe(0x203)]({'message':_0x2382fe(0x2ea)});return;}}catch(_0x258317){if(_0x572c6d[_0x2382fe(0x207)](_0x2382fe(0x309),_0x2382fe(0x265))){_0x16657d[_0x2382fe(0x267)](0x190)[_0x2382fe(0x203)]({'message':_0x2382fe(0x2aa)});return;}else{console['error'](colors['red'](_0x572c6d['ZoMHL'](_0x2382fe(0x1f8),_0x258317))),_0x17adbd[_0x2382fe(0x267)](0xc8)[_0x2382fe(0x203)]({'message':_0x2382fe(0x21e)});return;}}_0x17adbd['status'](0xc8)[_0x2382fe(0x203)]({'message':_0x2382fe(0x225)});}),router['get'](_0xa5ffe0(0x258),restrict,async(_0x32710a,_0x5d723c)=>{const _0x25ff7d=_0xa5ffe0,_0x558990={'fDeMy':_0x25ff7d(0x224),'vHlEK':_0x25ff7d(0x238),'fwCVo':_0x25ff7d(0x1e9),'PdMxO':_0x25ff7d(0x2ed),'LaFJP':function(_0x2c855c,_0x375aaa){return _0x2c855c===_0x375aaa;},'yvZCK':'jsSMD','RUidf':_0x25ff7d(0x296),'NCWCH':'Cart\x20dashboard','yDIST':_0x25ff7d(0x232),'aWmoe':'messageType'},_0x118c5e=_0x32710a['app']['db'],_0x4e80fc={'productsCount':await _0x118c5e[_0x25ff7d(0x2de)]['countDocuments']({'productPublished':!![]}),'ordersCount':await _0x118c5e[_0x25ff7d(0x2f6)][_0x25ff7d(0x200)]({}),'ordersAmount':await _0x118c5e[_0x25ff7d(0x2f6)]['aggregate']([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x25ff7d(0x235)}}}])['toArray'](),'productsSold':await _0x118c5e['orders']['aggregate']([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x25ff7d(0x212)}}}])[_0x25ff7d(0x208)](),'topProducts':await _0x118c5e[_0x25ff7d(0x2f6)][_0x25ff7d(0x262)]([{'$project':{'_id':0x0}},{'$project':{'o':{'$objectToArray':'$orderProducts'}}},{'$unwind':'$o'},{'$group':{'_id':_0x25ff7d(0x229),'title':{'$last':_0x558990[_0x25ff7d(0x20b)]},'productImage':{'$last':'$o.v.productImage'},'count':{'$sum':_0x558990['PdMxO']}}},{'$sort':{'count':-0x1}},{'$limit':0x5}])[_0x25ff7d(0x208)]()};if(_0x4e80fc[_0x25ff7d(0x2e0)][_0x25ff7d(0x2b9)]>0x0){if(_0x558990[_0x25ff7d(0x243)](_0x558990[_0x25ff7d(0x286)],_0x558990[_0x25ff7d(0x286)]))_0x4e80fc[_0x25ff7d(0x2e0)]=_0x4e80fc[_0x25ff7d(0x2e0)][0x0][_0x25ff7d(0x2c9)];else{const _0x37d439=_0x558990[_0x25ff7d(0x215)][_0x25ff7d(0x227)]('|');let _0xba557f=0x0;while(!![]){switch(_0x37d439[_0xba557f++]){case'0':_0x316b3a[_0x25ff7d(0x214)][_0x25ff7d(0x27c)]=_0x256143[_0x25ff7d(0x204)][_0x25ff7d(0x288)];continue;case'1':_0xbd0ec1[_0x25ff7d(0x214)][_0x25ff7d(0x226)]=_0x449723[_0x25ff7d(0x2eb)]['toString']();continue;case'2':return;case'3':_0xaea2ea[_0x25ff7d(0x214)][_0x25ff7d(0x1e3)]=_0x5ca94a[_0x25ff7d(0x1e3)];continue;case'4':_0x48efa2[_0x25ff7d(0x267)](0xc8)[_0x25ff7d(0x203)]({'message':_0x558990[_0x25ff7d(0x261)]});continue;case'5':_0x2acddd['session']['usersName']=_0x1d979b[_0x25ff7d(0x2a9)];continue;}break;}}}_0x4e80fc['productsSold']['length']>0x0?_0x4e80fc['productsSold']=_0x4e80fc[_0x25ff7d(0x2b8)][0x0][_0x25ff7d(0x2c9)]:_0x4e80fc['productsSold']=0x0,_0x5d723c[_0x25ff7d(0x2da)](_0x558990[_0x25ff7d(0x295)],{'title':_0x558990[_0x25ff7d(0x2dc)],'session':_0x32710a[_0x25ff7d(0x214)],'admin':!![],'dashboardData':_0x4e80fc,'themes':common[_0x25ff7d(0x29e)](),'message':common[_0x25ff7d(0x20c)](_0x32710a['session'],_0x558990[_0x25ff7d(0x246)]),'messageType':common[_0x25ff7d(0x20c)](_0x32710a[_0x25ff7d(0x214)],_0x558990[_0x25ff7d(0x22f)]),'helpers':_0x32710a['handlebars']['helpers'],'config':_0x32710a[_0x25ff7d(0x1f9)][_0x25ff7d(0x2d2)]});}),router[_0xa5ffe0(0x22d)](_0xa5ffe0(0x304),restrict,(_0x85fa4f,_0x419d5c)=>{const _0x4b901f=_0xa5ffe0,_0x359a01={'xihLE':_0x4b901f(0x293),'zbTrz':function(_0x16c263,_0x312ee8){return _0x16c263!==_0x312ee8;}};_0x419d5c[_0x4b901f(0x2da)]('settings',{'title':_0x4b901f(0x29f),'session':_0x85fa4f[_0x4b901f(0x214)],'admin':!![],'themes':common[_0x4b901f(0x29e)](),'message':common[_0x4b901f(0x20c)](_0x85fa4f[_0x4b901f(0x214)],'message'),'messageType':common['clearSessionValue'](_0x85fa4f[_0x4b901f(0x214)],_0x359a01[_0x4b901f(0x1e6)]),'helpers':_0x85fa4f[_0x4b901f(0x2a0)][_0x4b901f(0x257)],'config':_0x85fa4f[_0x4b901f(0x1f9)]['config'],'footerHtml':_0x359a01[_0x4b901f(0x308)](typeof _0x85fa4f[_0x4b901f(0x1f9)][_0x4b901f(0x2d2)]['footerHtml'],'undefined')?escape[_0x4b901f(0x2bb)](_0x85fa4f[_0x4b901f(0x1f9)]['config'][_0x4b901f(0x21a)]):null,'googleAnalytics':typeof _0x85fa4f[_0x4b901f(0x1f9)][_0x4b901f(0x2d2)][_0x4b901f(0x2d8)]!==_0x4b901f(0x260)?escape[_0x4b901f(0x2bb)](_0x85fa4f[_0x4b901f(0x1f9)][_0x4b901f(0x2d2)][_0x4b901f(0x2d8)]):null});}),router['post'](_0xa5ffe0(0x22b),restrict,checkAccess,async(_0x43f5eb,_0x51c2b7)=>{const _0x1a240a=_0xa5ffe0,_0x3bc61e=_0x43f5eb['app']['db'],_0x27dc9e=await _0x3bc61e[_0x1a240a(0x2a2)][_0x1a240a(0x2b4)]({'_id':ObjectId(_0x43f5eb[_0x1a240a(0x214)]['userId']),'isAdmin':!![]},{'$set':{'apiKey':new ObjectId()}},{'returnOriginal':![]});if(_0x27dc9e[_0x1a240a(0x23e)]&&_0x27dc9e['value'][_0x1a240a(0x1fb)]){_0x51c2b7[_0x1a240a(0x267)](0xc8)[_0x1a240a(0x203)]({'message':_0x1a240a(0x23f),'apiKey':_0x27dc9e[_0x1a240a(0x23e)]['apiKey']});return;}_0x51c2b7['status'](0x190)['json']({'message':_0x1a240a(0x23b)});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x233),restrict,checkAccess,(_0x3b4f6c,_0x2e5f61)=>{const _0x557d4e=_0xa5ffe0,_0xa76b95={'xghzn':'Settings\x20successfully\x20updated'},_0xa0889d=common[_0x557d4e(0x2b6)](_0x3b4f6c[_0x557d4e(0x204)]);if(_0xa0889d===!![]){_0x3b4f6c[_0x557d4e(0x1f9)][_0x557d4e(0x2d2)]=common[_0x557d4e(0x240)](),_0x2e5f61['status'](0xc8)[_0x557d4e(0x203)]({'message':_0xa76b95['xghzn']});return;}_0x2e5f61['status'](0x190)[_0x557d4e(0x203)]({'message':_0x557d4e(0x2e9)});}),router['get'](_0xa5ffe0(0x2c5),restrict,async(_0x3febd2,_0x212144)=>{const _0x52ac7f=_0xa5ffe0,_0x757d2a={'fGGlK':'Cart\x20menu','fbWWf':_0x52ac7f(0x232),'wnDaK':_0x52ac7f(0x293)},_0x513d2f=_0x3febd2[_0x52ac7f(0x1f9)]['db'];_0x212144['render']('settings-menu',{'title':_0x757d2a['fGGlK'],'session':_0x3febd2['session'],'admin':!![],'message':common[_0x52ac7f(0x20c)](_0x3febd2[_0x52ac7f(0x214)],_0x757d2a[_0x52ac7f(0x236)]),'messageType':common['clearSessionValue'](_0x3febd2[_0x52ac7f(0x214)],_0x757d2a[_0x52ac7f(0x26f)]),'helpers':_0x3febd2[_0x52ac7f(0x2a0)][_0x52ac7f(0x257)],'config':_0x3febd2['app'][_0x52ac7f(0x2d2)],'menu':common[_0x52ac7f(0x272)](await common['getMenu'](_0x513d2f))});}),router['get']('/admin/settings/pages',restrict,async(_0x4537d6,_0x4524b0)=>{const _0x3f3e88=_0xa5ffe0,_0x5a3113={'wKWRE':_0x3f3e88(0x25a),'qOwtd':_0x3f3e88(0x232)},_0x49b0ab=_0x4537d6[_0x3f3e88(0x1f9)]['db'],_0x4da4b2=await _0x49b0ab[_0x3f3e88(0x1fc)][_0x3f3e88(0x251)]({})[_0x3f3e88(0x208)]();_0x4524b0[_0x3f3e88(0x2da)](_0x5a3113['wKWRE'],{'title':_0x3f3e88(0x2a5),'pages':_0x4da4b2,'session':_0x4537d6['session'],'admin':!![],'message':common[_0x3f3e88(0x20c)](_0x4537d6['session'],_0x5a3113[_0x3f3e88(0x249)]),'messageType':common['clearSessionValue'](_0x4537d6[_0x3f3e88(0x214)],_0x3f3e88(0x293)),'helpers':_0x4537d6[_0x3f3e88(0x2a0)]['helpers'],'config':_0x4537d6[_0x3f3e88(0x1f9)][_0x3f3e88(0x2d2)],'menu':common[_0x3f3e88(0x272)](await common['getMenu'](_0x49b0ab))});}),router[_0xa5ffe0(0x22d)]('/admin/settings/pages/new',restrict,checkAccess,async(_0x414866,_0x328435)=>{const _0x4e9e2f=_0xa5ffe0,_0x9a1bee={'cnOSl':_0x4e9e2f(0x25d),'Lqqvp':'message','BHdhG':'messageType'},_0x4e97bd=_0x414866[_0x4e9e2f(0x1f9)]['db'];_0x328435[_0x4e9e2f(0x2da)](_0x9a1bee['cnOSl'],{'title':_0x4e9e2f(0x2a5),'session':_0x414866[_0x4e9e2f(0x214)],'admin':!![],'button_text':_0x4e9e2f(0x27f),'message':common['clearSessionValue'](_0x414866[_0x4e9e2f(0x214)],_0x9a1bee[_0x4e9e2f(0x237)]),'messageType':common[_0x4e9e2f(0x20c)](_0x414866[_0x4e9e2f(0x214)],_0x9a1bee['BHdhG']),'helpers':_0x414866['handlebars']['helpers'],'config':_0x414866[_0x4e9e2f(0x1f9)][_0x4e9e2f(0x2d2)],'menu':common[_0x4e9e2f(0x272)](await common[_0x4e9e2f(0x301)](_0x4e97bd))});}),router[_0xa5ffe0(0x22d)](_0xa5ffe0(0x26a),restrict,checkAccess,async(_0x14fe52,_0x1b8d38)=>{const _0x10d1bc=_0xa5ffe0,_0x43e0ef={'uQnsA':_0x10d1bc(0x29c),'wzQnv':_0x10d1bc(0x271),'nUtuY':_0x10d1bc(0x2f5),'sRuzO':_0x10d1bc(0x2a5),'xkULl':_0x10d1bc(0x21b)},_0x335b4f=_0x14fe52[_0x10d1bc(0x1f9)]['db'],_0x566310=await _0x335b4f['pages'][_0x10d1bc(0x300)]({'_id':common['getId'](_0x14fe52[_0x10d1bc(0x1ea)]['page'])}),_0x88b700=common['sortMenu'](await common[_0x10d1bc(0x301)](_0x335b4f));if(!_0x566310){_0x1b8d38[_0x10d1bc(0x267)](0x194)[_0x10d1bc(0x2da)](_0x43e0ef[_0x10d1bc(0x2c7)],{'title':'404\x20Error\x20-\x20Page\x20not\x20found','config':_0x14fe52[_0x10d1bc(0x1f9)][_0x10d1bc(0x2d2)],'message':_0x43e0ef[_0x10d1bc(0x2f1)],'helpers':_0x14fe52['handlebars'][_0x10d1bc(0x257)],'showFooter':_0x43e0ef['nUtuY'],'menu':_0x88b700});return;}_0x1b8d38[_0x10d1bc(0x2da)](_0x10d1bc(0x25d),{'title':_0x43e0ef['sRuzO'],'page':_0x566310,'button_text':_0x43e0ef[_0x10d1bc(0x2db)],'session':_0x14fe52['session'],'admin':!![],'message':common[_0x10d1bc(0x20c)](_0x14fe52[_0x10d1bc(0x214)],_0x10d1bc(0x232)),'messageType':common[_0x10d1bc(0x20c)](_0x14fe52[_0x10d1bc(0x214)],_0x10d1bc(0x293)),'helpers':_0x14fe52[_0x10d1bc(0x2a0)]['helpers'],'config':_0x14fe52[_0x10d1bc(0x1f9)][_0x10d1bc(0x2d2)],'menu':_0x88b700});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x276),restrict,checkAccess,async(_0x363172,_0x48ee68)=>{const _0x5b810f=_0xa5ffe0,_0x34ceef={'CizWt':_0x5b810f(0x232),'oGokH':_0x5b810f(0x2f5),'kpjrc':_0x5b810f(0x1f0),'fVLmp':_0x5b810f(0x2cf),'nZXsC':_0x5b810f(0x1e7)},_0x14d44f=_0x363172[_0x5b810f(0x1f9)]['db'],_0x4538cc={'pageName':_0x363172[_0x5b810f(0x204)]['pageName'],'pageSlug':_0x363172[_0x5b810f(0x204)][_0x5b810f(0x1fe)],'pageEnabled':_0x363172[_0x5b810f(0x204)][_0x5b810f(0x26b)],'pageContent':_0x363172[_0x5b810f(0x204)][_0x5b810f(0x1f2)]};if(_0x363172['body']['pageId']){const _0x3ff4f7=await _0x14d44f[_0x5b810f(0x1fc)][_0x5b810f(0x300)]({'_id':common['getId'](_0x363172[_0x5b810f(0x204)]['pageId'])});if(!_0x3ff4f7){_0x48ee68[_0x5b810f(0x267)](0x190)[_0x5b810f(0x203)]({'message':_0x34ceef[_0x5b810f(0x24a)]});return;}try{if(_0x34ceef[_0x5b810f(0x2f4)]===_0x5b810f(0x2cf)){const _0x249d79=await _0x14d44f['pages'][_0x5b810f(0x2b4)]({'_id':common[_0x5b810f(0x2f3)](_0x363172['body'][_0x5b810f(0x1f6)])},{'$set':_0x4538cc},{'returnOriginal':![]});_0x48ee68[_0x5b810f(0x267)](0xc8)[_0x5b810f(0x203)]({'message':_0x5b810f(0x2bf),'pageId':_0x363172[_0x5b810f(0x204)][_0x5b810f(0x1f6)],'page':_0x249d79[_0x5b810f(0x23e)]});}else _0x1699d2[_0x5b810f(0x214)]['needsSetup']=![],_0x3dc59f[_0x5b810f(0x2da)]('login',{'title':'Login','referringUrl':_0x101c1e['header']('Referer'),'config':_0x1d30a3[_0x5b810f(0x1f9)][_0x5b810f(0x2d2)],'message':_0x2fab70[_0x5b810f(0x20c)](_0x3c4cc4['session'],_0x34ceef[_0x5b810f(0x2b1)]),'messageType':_0x58c628[_0x5b810f(0x20c)](_0x2ebb71[_0x5b810f(0x214)],_0x5b810f(0x293)),'helpers':_0x3cdf30['handlebars'][_0x5b810f(0x257)],'showFooter':_0x34ceef[_0x5b810f(0x287)]});}catch(_0x1446cc){_0x48ee68[_0x5b810f(0x267)](0x190)[_0x5b810f(0x203)]({'message':'Error\x20updating\x20page.\x20Please\x20try\x20again.'});}}else try{const _0x320c85=await _0x14d44f[_0x5b810f(0x1fc)][_0x5b810f(0x1ed)](_0x4538cc);_0x48ee68[_0x5b810f(0x267)](0xc8)[_0x5b810f(0x203)]({'message':_0x34ceef[_0x5b810f(0x25c)],'pageId':_0x320c85[_0x5b810f(0x303)]});return;}catch(_0x1dca4a){_0x48ee68[_0x5b810f(0x267)](0x190)[_0x5b810f(0x203)]({'message':_0x5b810f(0x242)});}}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x2d9),restrict,checkAccess,async(_0x2219b6,_0xea8340)=>{const _0x741b26=_0xa5ffe0,_0xc45518={'XRrvN':_0x741b26(0x1f0),'qBLCs':_0x741b26(0x1e8),'hTbrs':function(_0x439c02,_0x54724a){return _0x439c02===_0x54724a;},'xwCLq':_0x741b26(0x2dd),'xcgFS':_0x741b26(0x247)},_0x4913e9=_0x2219b6[_0x741b26(0x1f9)]['db'],_0x193c1e=await _0x4913e9[_0x741b26(0x1fc)][_0x741b26(0x300)]({'_id':common[_0x741b26(0x2f3)](_0x2219b6['body'][_0x741b26(0x1f6)])});if(!_0x193c1e){if(_0x741b26(0x1e8)!==_0xc45518[_0x741b26(0x27e)]){_0x4ecbbf[_0x741b26(0x267)](0x190)['json']({'message':_0xc45518['XRrvN']});return;}else{_0xea8340[_0x741b26(0x267)](0x190)[_0x741b26(0x203)]({'message':_0x741b26(0x1f0)});return;}}try{if(_0xc45518[_0x741b26(0x284)]('bkjzy','bkjzy')){await _0x4913e9['pages'][_0x741b26(0x230)]({'_id':common[_0x741b26(0x2f3)](_0x2219b6[_0x741b26(0x204)][_0x741b26(0x1f6)])},{}),_0xea8340['status'](0xc8)[_0x741b26(0x203)]({'message':_0xc45518[_0x741b26(0x2e2)]});return;}else _0x2704da['amount']=_0x5e539c[_0x741b26(0x204)][_0x741b26(0x23d)],_0x32652e[_0x741b26(0x27d)]=_0x22d0d1[_0x741b26(0x204)]['searchValue'];}catch(_0x56a200){_0xea8340[_0x741b26(0x267)](0x190)[_0x741b26(0x203)]({'message':_0xc45518[_0x741b26(0x273)]});}}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x218),restrict,checkAccess,(_0x2f015a,_0xdf2dcd)=>{const _0x498f5f=_0xa5ffe0,_0x1ee84b={'nrTLB':_0x498f5f(0x1f0),'lPpgs':_0x498f5f(0x2a8)},_0x2e73e6=common['newMenu'](_0x2f015a);if(_0x2e73e6===![]){if(_0x498f5f(0x253)===_0x498f5f(0x253)){_0xdf2dcd[_0x498f5f(0x267)](0x190)[_0x498f5f(0x203)]({'message':_0x498f5f(0x259)});return;}else{_0x1553c4['status'](0x190)[_0x498f5f(0x203)]({'message':_0x1ee84b[_0x498f5f(0x223)]});return;}}_0xdf2dcd[_0x498f5f(0x267)](0xc8)[_0x498f5f(0x203)]({'message':_0x1ee84b['lPpgs']});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x216),restrict,checkAccess,(_0x17b310,_0xba23dd)=>{const _0x4b2e35=_0xa5ffe0,_0x3d54cf={'rUaVX':function(_0x859eb9,_0x454efe){return _0x859eb9===_0x454efe;},'BljIK':_0x4b2e35(0x29b)},_0x4fb27c=common[_0x4b2e35(0x2fc)](_0x17b310);if(_0x3d54cf[_0x4b2e35(0x2f7)](_0x4fb27c,![])){_0xba23dd[_0x4b2e35(0x267)](0x190)[_0x4b2e35(0x203)]({'message':_0x3d54cf[_0x4b2e35(0x2c4)]});return;}_0xba23dd[_0x4b2e35(0x267)](0xc8)[_0x4b2e35(0x203)]({'message':_0x4b2e35(0x210)});}),router['post'](_0xa5ffe0(0x245),restrict,checkAccess,(_0x3223fc,_0x59530a)=>{const _0x39bff4=_0xa5ffe0,_0x1e0fd1={'KLNud':function(_0x1841ae,_0x21ebb5){return _0x1841ae===_0x21ebb5;},'bdzuX':'cwrmx'},_0x5e84aa=common[_0x39bff4(0x282)](_0x3223fc,_0x3223fc['body']['menuId']);if(_0x1e0fd1[_0x39bff4(0x2ec)](_0x5e84aa,![])){if(_0x39bff4(0x20e)===_0x1e0fd1['bdzuX']){_0x59530a[_0x39bff4(0x267)](0x190)['json']({'message':_0x39bff4(0x2b0)});return;}else{_0x4249a3['status'](0x190)['json']({'message':'A\x20user\x20with\x20that\x20email\x20does\x20not\x20exist.'});return;}}_0x59530a[_0x39bff4(0x267)](0xc8)['json']({'message':_0x39bff4(0x2ba)});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x2d7),restrict,checkAccess,(_0x13f479,_0x3033bf)=>{const _0x3f06ef=_0xa5ffe0,_0x51779c={'ijcsY':function(_0x5b20e3,_0x815593){return _0x5b20e3===_0x815593;},'IloMy':_0x3f06ef(0x2a1)},_0x160ef3=common['orderMenu'](_0x13f479,_0x3033bf);if(_0x51779c[_0x3f06ef(0x1f7)](_0x160ef3,![])){_0x3033bf['status'](0x190)[_0x3f06ef(0x203)]({'message':_0x51779c[_0x3f06ef(0x297)]});return;}_0x3033bf[_0x3f06ef(0x267)](0xc8)[_0x3f06ef(0x203)]({});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x254),async(_0x18fa02,_0x11d751)=>{const _0x245362=_0xa5ffe0,_0x19237b={'wtKRm':function(_0x512df3,_0x422f1f){return _0x512df3===_0x422f1f;}},_0x4541c0=_0x18fa02['app']['db'];let _0x478e04={};typeof _0x18fa02[_0x245362(0x204)][_0x245362(0x306)]===_0x245362(0x260)||_0x19237b[_0x245362(0x2cb)](_0x18fa02['body'][_0x245362(0x306)],'')?_0x478e04={'productPermalink':_0x18fa02['body']['permalink']}:_0x478e04={'productPermalink':_0x18fa02['body']['permalink'],'_id':{'$ne':common[_0x245362(0x2f3)](_0x18fa02[_0x245362(0x204)][_0x245362(0x306)])}};const _0x8c6157=await _0x4541c0['products']['countDocuments'](_0x478e04);if(_0x8c6157&&_0x8c6157>0x0){_0x11d751[_0x245362(0x267)](0x190)[_0x245362(0x203)]({'message':_0x245362(0x213)});return;}_0x11d751[_0x245362(0x267)](0xc8)[_0x245362(0x203)]({'message':_0x245362(0x278)});}),router[_0xa5ffe0(0x22d)]('/admin/settings/discounts',restrict,checkAccess,async(_0x54185c,_0x22b7a6)=>{const _0x247ad5=_0xa5ffe0,_0x11a6cf={'nDjLg':'settings-discounts','qeJCU':_0x247ad5(0x299)},_0x6252f=_0x54185c['app']['db'],_0x52375f=await _0x6252f[_0x247ad5(0x2e8)][_0x247ad5(0x251)]({})[_0x247ad5(0x208)]();_0x22b7a6['render'](_0x11a6cf[_0x247ad5(0x2b7)],{'title':_0x11a6cf[_0x247ad5(0x30b)],'config':_0x54185c['app'][_0x247ad5(0x2d2)],'session':_0x54185c[_0x247ad5(0x214)],'discounts':_0x52375f,'admin':!![],'message':common['clearSessionValue'](_0x54185c['session'],_0x247ad5(0x232)),'messageType':common['clearSessionValue'](_0x54185c['session'],'messageType'),'helpers':_0x54185c[_0x247ad5(0x2a0)][_0x247ad5(0x257)]});}),router[_0xa5ffe0(0x22d)]('/admin/settings/discount/edit/:id',restrict,checkAccess,async(_0x42c7e7,_0x457b04)=>{const _0x4491ac=_0xa5ffe0,_0x284038={'XAnwl':_0x4491ac(0x293)},_0x12e948=_0x42c7e7[_0x4491ac(0x1f9)]['db'],_0x4b47d0=await _0x12e948[_0x4491ac(0x2e8)][_0x4491ac(0x300)]({'_id':common[_0x4491ac(0x2f3)](_0x42c7e7[_0x4491ac(0x1ea)]['id'])});_0x457b04['render'](_0x4491ac(0x20a),{'title':_0x4491ac(0x228),'session':_0x42c7e7[_0x4491ac(0x214)],'admin':!![],'discount':_0x4b47d0,'message':common['clearSessionValue'](_0x42c7e7[_0x4491ac(0x214)],_0x4491ac(0x232)),'messageType':common[_0x4491ac(0x20c)](_0x42c7e7[_0x4491ac(0x214)],_0x284038['XAnwl']),'helpers':_0x42c7e7[_0x4491ac(0x2a0)][_0x4491ac(0x257)],'config':_0x42c7e7[_0x4491ac(0x1f9)][_0x4491ac(0x2d2)]});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x28c),restrict,checkAccess,async(_0x220a2c,_0x29906e)=>{const _0x4b913a=_0xa5ffe0,_0x1b5ce6={'aoagG':function(_0x2c8dc4,_0x23ebe8){return _0x2c8dc4(_0x23ebe8);},'sghLT':function(_0x4d9c39,_0x2deaea,_0x16528e){return _0x4d9c39(_0x2deaea,_0x16528e);},'EZTNO':'DD/MM/YYYY\x20HH:mm','luhsX':function(_0x31ebd7,_0x5d80dc){return _0x31ebd7(_0x5d80dc);},'nlJYF':function(_0x2c9fb1,_0x466dc1){return _0x2c9fb1(_0x466dc1);},'KZZcN':_0x4b913a(0x24b),'uxxcw':_0x4b913a(0x2ef),'sygjp':function(_0x482ec7,_0x1bfd15){return _0x482ec7!==_0x1bfd15;},'HjfHp':_0x4b913a(0x205),'EJhQr':_0x4b913a(0x1eb),'ouPPz':'Failed\x20to\x20save.\x20Please\x20try\x20again'},_0x48fa6e=_0x220a2c['app']['db'],_0x401341={'discountId':_0x220a2c['body'][_0x4b913a(0x2b5)],'code':_0x220a2c[_0x4b913a(0x204)][_0x4b913a(0x219)],'type':_0x220a2c[_0x4b913a(0x204)]['type'],'value':_0x1b5ce6[_0x4b913a(0x294)](parseInt,_0x220a2c[_0x4b913a(0x204)]['value']),'start':_0x1b5ce6[_0x4b913a(0x239)](moment,_0x220a2c[_0x4b913a(0x204)][_0x4b913a(0x2be)],_0x1b5ce6[_0x4b913a(0x2ab)])[_0x4b913a(0x2d3)](),'end':moment(_0x220a2c['body']['end'],_0x4b913a(0x23a))['toDate']()},_0x2fcb9d=validateJson(_0x4b913a(0x1ef),_0x401341);if(!_0x2fcb9d['result']){_0x29906e[_0x4b913a(0x267)](0x190)[_0x4b913a(0x203)](_0x2fcb9d[_0x4b913a(0x27b)]);return;}if(_0x1b5ce6['luhsX'](moment,_0x401341['start'])[_0x4b913a(0x275)](moment())){_0x29906e['status'](0x190)[_0x4b913a(0x203)]({'message':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today'});return;}if(!_0x1b5ce6[_0x4b913a(0x26c)](moment,_0x401341[_0x4b913a(0x22e)])[_0x4b913a(0x291)](_0x1b5ce6[_0x4b913a(0x22c)](moment,_0x401341[_0x4b913a(0x2be)]))){_0x29906e[_0x4b913a(0x267)](0x190)['json']({'message':_0x1b5ce6[_0x4b913a(0x1f3)]});return;}const _0x137526=await _0x48fa6e[_0x4b913a(0x2e8)]['countDocuments']({'code':_0x401341[_0x4b913a(0x219)],'_id':{'$ne':common[_0x4b913a(0x2f3)](_0x401341[_0x4b913a(0x2b5)])}});if(_0x137526){_0x29906e[_0x4b913a(0x267)](0x190)[_0x4b913a(0x203)]({'message':_0x1b5ce6['uxxcw']});return;}delete _0x401341[_0x4b913a(0x2b5)];try{if(_0x1b5ce6[_0x4b913a(0x28f)](_0x1b5ce6[_0x4b913a(0x274)],_0x1b5ce6[_0x4b913a(0x274)])){_0x4a9dca[_0x4b913a(0x267)](0x190)[_0x4b913a(0x203)](_0x432b67[_0x4b913a(0x27b)]);return;}else await _0x48fa6e[_0x4b913a(0x2e8)]['updateOne']({'_id':common[_0x4b913a(0x2f3)](_0x220a2c['body'][_0x4b913a(0x2b5)])},{'$set':_0x401341},{}),_0x29906e['status'](0xc8)[_0x4b913a(0x203)]({'message':_0x1b5ce6[_0x4b913a(0x28d)],'discount':_0x401341});}catch(_0x169488){_0x29906e[_0x4b913a(0x267)](0x190)['json']({'message':_0x1b5ce6[_0x4b913a(0x21d)]});}}),router['get']('/admin/settings/discount/new',restrict,checkAccess,async(_0x4b7437,_0x151cde)=>{const _0x4d41f5=_0xa5ffe0,_0x3d0f5a={'htYRp':_0x4d41f5(0x2cc),'qRkHC':_0x4d41f5(0x2d1),'BMXWx':_0x4d41f5(0x293)};_0x151cde[_0x4d41f5(0x2da)](_0x3d0f5a[_0x4d41f5(0x2b2)],{'title':_0x3d0f5a[_0x4d41f5(0x2a4)],'session':_0x4b7437[_0x4d41f5(0x214)],'admin':!![],'message':common['clearSessionValue'](_0x4b7437[_0x4d41f5(0x214)],_0x4d41f5(0x232)),'messageType':common[_0x4d41f5(0x20c)](_0x4b7437[_0x4d41f5(0x214)],_0x3d0f5a[_0x4d41f5(0x1e4)]),'helpers':_0x4b7437[_0x4d41f5(0x2a0)][_0x4d41f5(0x257)],'config':_0x4b7437[_0x4d41f5(0x1f9)][_0x4d41f5(0x2d2)]});}),router[_0xa5ffe0(0x290)]('/admin/settings/discount/create',restrict,checkAccess,async(_0x4c305f,_0x13cc8a)=>{const _0x2288e1=_0xa5ffe0,_0x4a239f={'mPZvV':function(_0x5a628d,_0x2c0ae4){return _0x5a628d(_0x2c0ae4);},'dUxoj':function(_0x22df6a,_0x57e2ad,_0x1636d5){return _0x22df6a(_0x57e2ad,_0x1636d5);},'iEDeo':function(_0x4ac694,_0x1bc049,_0x28cf1b){return _0x4ac694(_0x1bc049,_0x28cf1b);},'OnKTz':_0x2288e1(0x30a),'FCMES':_0x2288e1(0x2ef),'sNvVq':function(_0x13c30a){return _0x13c30a();},'OqegG':_0x2288e1(0x24b)},_0x1b017f=_0x4c305f['app']['db'],_0x1f2305={'code':_0x4c305f[_0x2288e1(0x204)]['code'],'type':_0x4c305f['body'][_0x2288e1(0x2bc)],'value':_0x4a239f[_0x2288e1(0x25f)](parseInt,_0x4c305f[_0x2288e1(0x204)]['value']),'start':_0x4a239f['dUxoj'](moment,_0x4c305f[_0x2288e1(0x204)][_0x2288e1(0x2be)],_0x2288e1(0x23a))[_0x2288e1(0x2d3)](),'end':_0x4a239f[_0x2288e1(0x2b3)](moment,_0x4c305f[_0x2288e1(0x204)]['end'],_0x2288e1(0x23a))['toDate']()},_0x41cd91=validateJson(_0x4a239f[_0x2288e1(0x252)],_0x1f2305);if(!_0x41cd91['result']){_0x13cc8a[_0x2288e1(0x267)](0x190)['json'](_0x41cd91['errors']);return;}const _0x5d7299=await _0x1b017f[_0x2288e1(0x2e8)]['countDocuments']({'code':_0x1f2305[_0x2288e1(0x219)]});if(_0x5d7299){_0x13cc8a[_0x2288e1(0x267)](0x190)[_0x2288e1(0x203)]({'message':_0x4a239f[_0x2288e1(0x283)]});return;}if(_0x4a239f['mPZvV'](moment,_0x1f2305[_0x2288e1(0x2be)])[_0x2288e1(0x275)](_0x4a239f[_0x2288e1(0x280)](moment))){_0x13cc8a[_0x2288e1(0x267)](0x190)[_0x2288e1(0x203)]({'message':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today'});return;}if(!moment(_0x1f2305['end'])[_0x2288e1(0x291)](moment(_0x1f2305[_0x2288e1(0x2be)]))){_0x13cc8a[_0x2288e1(0x267)](0x190)[_0x2288e1(0x203)]({'message':_0x4a239f[_0x2288e1(0x2f8)]});return;}const _0x32609b=await _0x1b017f[_0x2288e1(0x2e8)][_0x2288e1(0x1ed)](_0x1f2305);_0x13cc8a['status'](0xc8)[_0x2288e1(0x203)]({'message':_0x2288e1(0x1fa),'discountId':_0x32609b[_0x2288e1(0x303)]});}),router[_0xa5ffe0(0x24f)](_0xa5ffe0(0x28b),restrict,checkAccess,async(_0x3349d3,_0x10e533)=>{const _0x48752c=_0xa5ffe0,_0x496beb={'xpDen':_0x48752c(0x2ac)},_0x2fdc00=_0x3349d3[_0x48752c(0x1f9)]['db'];try{await _0x2fdc00[_0x48752c(0x2e8)][_0x48752c(0x230)]({'_id':common[_0x48752c(0x2f3)](_0x3349d3[_0x48752c(0x204)][_0x48752c(0x2b5)])},{}),_0x10e533[_0x48752c(0x267)](0xc8)[_0x48752c(0x203)]({'message':_0x496beb['xpDen']});return;}catch(_0x244ca1){_0x10e533['status'](0x190)['json']({'message':_0x48752c(0x217)});}});const upload=multer({'dest':_0xa5ffe0(0x1e5)});router[_0xa5ffe0(0x290)](_0xa5ffe0(0x270),restrict,checkAccess,upload[_0xa5ffe0(0x30d)]('uploadFile'),async(_0x3cb98e,_0x281daa)=>{const _0x5795b5=_0xa5ffe0,_0x5dd3cd={'YziIH':_0x5795b5(0x258),'EtRNu':function(_0x27ce0b,_0x118733){return _0x27ce0b>_0x118733;},'nkNgi':function(_0x41a9ff,_0x2f4143){return _0x41a9ff!==_0x2f4143;},'BdMbt':_0x5795b5(0x22e),'CzgXH':_0x5795b5(0x2e1)},_0x5e971b=_0x3cb98e[_0x5795b5(0x1f9)]['db'];if(_0x3cb98e['file']){const _0x37c87b=_0x3cb98e[_0x5795b5(0x2c6)],_0x4c95f8=mime[_0x5795b5(0x21c)](_0x37c87b[_0x5795b5(0x26e)]);if(!common[_0x5795b5(0x1e2)]['includes'](_0x4c95f8)||_0x5dd3cd[_0x5795b5(0x222)](_0x37c87b['size'],common[_0x5795b5(0x2f0)])){fs['unlinkSync'](_0x37c87b[_0x5795b5(0x2e6)]),_0x281daa['status'](0x190)[_0x5795b5(0x203)]({'message':_0x5795b5(0x30c)});return;}const _0x180fcb=await _0x5e971b['products'][_0x5795b5(0x300)]({'_id':common[_0x5795b5(0x2f3)](_0x3cb98e[_0x5795b5(0x204)][_0x5795b5(0x2af)])});if(!_0x180fcb){if(_0x5dd3cd['nkNgi'](_0x5795b5(0x20f),_0x5795b5(0x20f)))_0x1606c0[_0x5795b5(0x2c0)](_0x5dd3cd[_0x5795b5(0x24d)]);else{fs[_0x5795b5(0x22a)](_0x37c87b[_0x5795b5(0x2e6)]),_0x281daa[_0x5795b5(0x267)](0x190)[_0x5795b5(0x203)]({'message':_0x5795b5(0x2fd)});return;}}const _0x46685a=_0x180fcb[_0x5795b5(0x2eb)][_0x5795b5(0x244)](),_0x482d4a=path[_0x5795b5(0x289)]('public/uploads',_0x46685a);common[_0x5795b5(0x255)](_0x482d4a);const _0x360ed0=fs['createReadStream'](_0x37c87b[_0x5795b5(0x2e6)]),_0x12492b=fs[_0x5795b5(0x27a)](path['join'](_0x482d4a,_0x37c87b[_0x5795b5(0x26e)][_0x5795b5(0x2ad)](/ /g,'_')));_0x360ed0[_0x5795b5(0x25e)](_0x12492b),_0x360ed0['on'](_0x5dd3cd[_0x5795b5(0x231)],()=>{}),fs[_0x5795b5(0x22a)](_0x37c87b[_0x5795b5(0x2e6)]);const _0x25b0ee=path['join'](_0x5795b5(0x2d6),_0x46685a,_0x37c87b[_0x5795b5(0x26e)][_0x5795b5(0x2ad)](/ /g,'_'));!_0x180fcb['productImage']&&await _0x5e971b['products'][_0x5795b5(0x1ec)]({'_id':common[_0x5795b5(0x2f3)](_0x3cb98e[_0x5795b5(0x204)][_0x5795b5(0x2af)])},{'$set':{'productImage':_0x25b0ee}},{'multi':![]});_0x281daa[_0x5795b5(0x267)](0xc8)[_0x5795b5(0x203)]({'message':_0x5dd3cd[_0x5795b5(0x2e5)]});return;}_0x281daa[_0x5795b5(0x267)](0x190)[_0x5795b5(0x203)]({'message':_0x5795b5(0x2fd)});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x201),restrict,(_0x5eaac4,_0x5d26a9)=>{const _0x34fe52=_0xa5ffe0,_0x506c05={'VyUae':'expressCart\x20test\x20email','omVDB':_0x34fe52(0x209)},_0x49e3bc=_0x5eaac4[_0x34fe52(0x1f9)][_0x34fe52(0x2d2)];common[_0x34fe52(0x2d4)](_0x49e3bc[_0x34fe52(0x21f)],_0x506c05['VyUae'],_0x506c05[_0x34fe52(0x1f5)]),_0x5d26a9[_0x34fe52(0x267)](0xc8)[_0x34fe52(0x203)]({'message':_0x34fe52(0x2fa)});}),router[_0xa5ffe0(0x290)](_0xa5ffe0(0x26d),restrict,async(_0x2c8aff,_0x3c4aa4,_0x39e376)=>{const _0x57ae55=_0xa5ffe0,_0x51324f={'kwwgJ':function(_0x328c00,_0x4e30b7){return _0x328c00(_0x4e30b7);},'NdvSR':_0x57ae55(0x298),'RevpZ':function(_0x1bc34b,_0x1bd83b){return _0x1bc34b>_0x1bd83b;}},_0x5cf659=_0x2c8aff[_0x57ae55(0x1f9)]['db'],_0x4be7d5=_0x2c8aff[_0x57ae55(0x204)][_0x57ae55(0x23d)],_0xae3e49=0x5;let _0x1246fc=[],_0x45c5d9=[],_0x3cbda1=[];const _0x58a43d={},_0x312f62={},_0x1a11d6={};if(ObjectId[_0x57ae55(0x2ce)](_0x2c8aff[_0x57ae55(0x204)]['searchValue']))return _0x1246fc=await _0x5cf659[_0x57ae55(0x256)]['find']({'_id':_0x51324f[_0x57ae55(0x1ee)](ObjectId,_0x4be7d5)})[_0x57ae55(0x202)](_0xae3e49)[_0x57ae55(0x2c8)]({'created':0x1})['toArray'](),_0x45c5d9=await _0x5cf659[_0x57ae55(0x2f6)][_0x57ae55(0x251)]({'_id':ObjectId(_0x4be7d5)})[_0x57ae55(0x202)](_0xae3e49)['sort']({'orderDate':0x1})[_0x57ae55(0x208)](),_0x3cbda1=await _0x5cf659[_0x57ae55(0x2de)][_0x57ae55(0x251)]({'_id':ObjectId(_0x4be7d5)})[_0x57ae55(0x202)](_0xae3e49)[_0x57ae55(0x2c8)]({'productAddedDate':0x1})[_0x57ae55(0x208)](),_0x3c4aa4[_0x57ae55(0x267)](0xc8)[_0x57ae55(0x203)]({'customers':_0x1246fc,'orders':_0x45c5d9,'products':_0x3cbda1});if(emailRegex[_0x57ae55(0x307)](_0x2c8aff['body'][_0x57ae55(0x23d)]))_0x58a43d[_0x57ae55(0x288)]=_0x4be7d5,_0x312f62[_0x57ae55(0x2f9)]=_0x4be7d5;else numericRegex[_0x57ae55(0x307)](_0x2c8aff[_0x57ae55(0x204)][_0x57ae55(0x23d)])?(_0x312f62['amount']=_0x2c8aff[_0x57ae55(0x204)][_0x57ae55(0x23d)],_0x1a11d6['productPrice']=_0x2c8aff[_0x57ae55(0x204)]['searchValue']):(_0x58a43d[_0x57ae55(0x2ee)]=[{'firstName':{'$regex':new RegExp(_0x4be7d5,_0x57ae55(0x298))}},{'lastName':{'$regex':new RegExp(_0x4be7d5,_0x51324f[_0x57ae55(0x281)])}}],_0x312f62['$or']=[{'orderFirstname':{'$regex':new RegExp(_0x4be7d5,_0x57ae55(0x298))}},{'orderLastname':{'$regex':new RegExp(_0x4be7d5,_0x51324f[_0x57ae55(0x281)])}}],_0x1a11d6[_0x57ae55(0x2ee)]=[{'productTitle':{'$regex':new RegExp(_0x4be7d5,_0x57ae55(0x298))}},{'productDescription':{'$regex':new RegExp(_0x4be7d5,_0x51324f['NdvSR'])}}]);return Object['keys'](_0x58a43d)[_0x57ae55(0x2b9)]>0x0&&(_0x1246fc=await _0x5cf659[_0x57ae55(0x256)][_0x57ae55(0x251)](_0x58a43d)[_0x57ae55(0x202)](_0xae3e49)[_0x57ae55(0x2c8)]({'created':0x1})[_0x57ae55(0x208)]()),Object['keys'](_0x312f62)[_0x57ae55(0x2b9)]>0x0&&(_0x45c5d9=await _0x5cf659['orders']['find'](_0x312f62)[_0x57ae55(0x202)](_0xae3e49)['sort']({'orderDate':0x1})[_0x57ae55(0x208)]()),_0x51324f[_0x57ae55(0x24c)](Object[_0x57ae55(0x220)](_0x1a11d6)[_0x57ae55(0x2b9)],0x0)&&(_0x3cbda1=await _0x5cf659[_0x57ae55(0x2de)][_0x57ae55(0x251)](_0x1a11d6)[_0x57ae55(0x202)](_0xae3e49)[_0x57ae55(0x2c8)]({'productAddedDate':0x1})['toArray']()),_0x3c4aa4[_0x57ae55(0x267)](0xc8)[_0x57ae55(0x203)]({'customers':_0x1246fc,'orders':_0x45c5d9,'products':_0x3cbda1});}),module[_0xa5ffe0(0x211)]=router;