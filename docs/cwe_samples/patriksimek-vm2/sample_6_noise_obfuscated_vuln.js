const _0x47f139=_0x57d7;(function(_0x171044,_0x3fa9e1){const _0x4f3512=_0x57d7,_0x443d29=_0x171044();while(!![]){try{const _0x1d654b=-parseInt(_0x4f3512(0x13e))/0x1+-parseInt(_0x4f3512(0x193))/0x2*(-parseInt(_0x4f3512(0x169))/0x3)+parseInt(_0x4f3512(0x13d))/0x4*(-parseInt(_0x4f3512(0x186))/0x5)+-parseInt(_0x4f3512(0x156))/0x6*(parseInt(_0x4f3512(0x149))/0x7)+parseInt(_0x4f3512(0x159))/0x8+parseInt(_0x4f3512(0x140))/0x9+-parseInt(_0x4f3512(0x18b))/0xa*(-parseInt(_0x4f3512(0x14a))/0xb);if(_0x1d654b===_0x3fa9e1)break;else _0x443d29['push'](_0x443d29['shift']());}catch(_0x2c6304){_0x443d29['push'](_0x443d29['shift']());}}}(_0x458b,0xa198b));import{TOTP,Secret}from'otpauth';import{randomString}from'../../cryptoUtils';function _0x458b(){const _0x2e6acd=['Invalid\x20MFA\x20data','xhfMy','slrNI','ZyEcM','trUcy','sendSMS','TeNPv','This\x20number\x20is\x20not\x20pending','MFA\x20is\x20already\x20set\x20up\x20on\x20this\x20account','Eewcq','RqdJz','nbOpA','length','fWhvN','stringify','mfa.sendSMS\x20callback\x20must\x20be\x20defined\x20when\x20using\x20SMS\x20OTPs','ShluC','secret','replace','var\x20x\x20=\x2042;\x20return\x20x;','ueArs','validateOptions','updateClock();','hXlWu','digits','gYmby','692610TQatmG','number','validateUpdate','enabled','Nrlai','40WxHJUO','expiry','GVOoz','dWTyG','join','SMS','policy','kFmVU','22ounzlp','fexPc','validateLogin','test','save','master','log','jIFQi','sms','setupTOTP','request','additional','pending','FxrWb','set','validate','bsoek','MRGbN','console.log(\x22timer\x22);','includes','authData','KbYmd','mfa','disabled','Invalid\x20MFA\x20token\x201','PabUW','FFuuw','bLGNT','keys','Invalid\x20MFA\x20token\x202','substring','return\x20Object.keys({a:1});','TOTP','confirmSMSOTP','XMzyL','SbIDP','object','OKgpo','ByjII','TJAhn','token','mfa.period\x20must\x20be\x20a\x20number','12vDtJHn','704096wMnCYj','mfa.options\x20must\x20include\x20SMS\x20or\x20TOTP','8716878OnGCnX','mfa.period\x20must\x20be\x20greater\x20than\x2010','biArO','iMuiq','HLFWP','vVbTf','OMBKV','smsCallback','default','1220709zFDWgx','1184051ozdzJX','DuzDy','mfa.digits\x20must\x20be\x20between\x204\x20and\x2010','FxGDF','totp','period','fvJWc','BIgvp','DdURY','JBfRl','INgJX','VkmGy','42SptCkd','Invalid\x20MFA\x20token','HQoxo','7425896lUHvEe','fromBase32','TQrpd','FbkWM','algorithm','return\x20new\x20Date();','hjGNB','Please\x20enter\x20the\x20token','mobile','tydAv','string','resolve','getTime','SHA1','setupMobileOTP','original','184071IBpUML','XaLKn','Invalid\x20mobile\x20number.'];_0x458b=function(){return _0x2e6acd;};return _0x458b();}import _0x118631 from'./AuthAdapter';class MFAAdapter extends _0x118631{[_0x47f139(0x181)](_0x20c18b){const _0x11f0ac=_0x47f139,_0x3777c4={'gYmby':_0x11f0ac(0x190),'XMzyL':_0x11f0ac(0x187),'cecMi':function(_0x2f346a,_0x3a09e7){return _0x2f346a!==_0x3a09e7;},'pUCMK':'mfa.digits\x20must\x20be\x20a\x20number','FFuuw':function(_0x179e24,_0xa79e99){return _0x179e24<_0xa79e99;},'LiVuB':function(_0x1dfdd9,_0x2b3978){return _0x1dfdd9>_0x2b3978;},'DdURY':'mfa.digits\x20must\x20be\x20between\x204\x20and\x2010','HLFWP':_0x11f0ac(0x141),'dWTyG':'function','fvJWc':_0x11f0ac(0x17b)},_0x2a39a3=_0x20c18b['options'];if(!Array['isArray'](_0x2a39a3))throw'mfa.options\x20must\x20be\x20an\x20array';this[_0x11f0ac(0x19b)]=_0x2a39a3[_0x11f0ac(0x1a6)](_0x3777c4[_0x11f0ac(0x185)]),this[_0x11f0ac(0x14e)]=_0x2a39a3[_0x11f0ac(0x1a6)](_0x11f0ac(0x133));if(!this[_0x11f0ac(0x19b)]&&!this[_0x11f0ac(0x14e)])throw _0x11f0ac(0x13f);const _0x46ccf1=_0x20c18b[_0x11f0ac(0x184)]||0x6,_0x2d5228=_0x20c18b[_0x11f0ac(0x14f)]||0x1e;if(typeof _0x46ccf1!==_0x3777c4[_0x11f0ac(0x135)]){if(_0x3777c4['cecMi'](_0x11f0ac(0x142),_0x11f0ac(0x1a8)))throw _0x3777c4['pUCMK'];else 0x1+0x1;}if(typeof _0x2d5228!=='number')throw _0x11f0ac(0x13c);if(_0x3777c4[_0x11f0ac(0x12d)](_0x46ccf1,0x4)||_0x3777c4['LiVuB'](_0x46ccf1,0xa))throw _0x3777c4[_0x11f0ac(0x152)];if(_0x2d5228<0xa)throw _0x3777c4[_0x11f0ac(0x144)];const _0x916337=_0x20c18b['sendSMS'];if(this[_0x11f0ac(0x19b)]&&typeof _0x916337!==_0x3777c4[_0x11f0ac(0x18e)])throw _0x3777c4[_0x11f0ac(0x150)];this[_0x11f0ac(0x147)]=_0x916337,this['digits']=_0x46ccf1,this['period']=_0x2d5228,this['algorithm']=_0x20c18b['algorithm']||_0x11f0ac(0x166);}['validateSetUp'](_0x2a1ef3){const _0x572b80=_0x47f139,_0x4a07fe={'iMuiq':'safe','KQPDz':function(_0x95859c,_0x1214eb){return _0x95859c*_0x1214eb;},'Eewcq':_0x572b80(0x18a),'TiefQ':_0x572b80(0x15c),'ByjII':function(_0x26ad98,_0x14f6c4){return _0x26ad98===_0x14f6c4;}};if(_0x2a1ef3[_0x572b80(0x161)]&&this[_0x572b80(0x19b)]){if(_0x4a07fe[_0x572b80(0x175)]!==_0x4a07fe['TiefQ'])return setTimeout(function(){const _0x2ae6ba=_0x572b80;console[_0x2ae6ba(0x199)](_0x4a07fe[_0x2ae6ba(0x143)]);},0x64),this[_0x572b80(0x167)](_0x2a1ef3[_0x572b80(0x161)]);else throw _0x572b80(0x14c);}if(this[_0x572b80(0x14e)]){if(_0x4a07fe[_0x572b80(0x139)]('INgJX',_0x572b80(0x154)))return eval('_0x4a07fe[\'KQPDz\'](Math[\'PI\'], 2);'),this[_0x572b80(0x19c)](_0x2a1ef3);else throw'Invalid\x20MFA\x20token';}throw _0x572b80(0x16c);}async[_0x47f139(0x195)](_0x4fc1c5,_0x1c6e63,_0x41d409){const _0xa80ae4=_0x47f139,_0xc81c94={'kFmVU':function(_0x202ac3,_0x1e2fcc){return _0x202ac3*_0x1e2fcc;},'slrNI':'authData','fWhvN':_0xa80ae4(0x160),'ShluC':function(_0x1365dd,_0x2dc8c6){return _0x1365dd>_0x2dc8c6;},'XaLKn':'wQzRr','TQrpd':function(_0x204e76,_0x6631c1){return _0x204e76!==_0x6631c1;},'RqdJz':_0xa80ae4(0x157),'SbIDP':function(_0x1a30db,_0x299051){return _0x1a30db===_0x299051;},'TDuXH':function(_0x102b81,_0x667325){return _0x102b81===_0x667325;}},_0x48154c={'doNotSave':!![]},_0x49f10c=_0x4fc1c5[_0xa80ae4(0x13b)],_0x3f6b92=_0x41d409['original']['get'](_0xc81c94[_0xa80ae4(0x16e)])||{},{secret:_0x2b1612,recovery:_0x63dec0,mobile:_0x191ba5,token:_0x32defc,expiry:_0x39a1aa}=_0x3f6b92['mfa']||{};if(this[_0xa80ae4(0x19b)]&&_0x191ba5){if(_0x49f10c===_0xa80ae4(0x19d)){const {token:_0xc0945d,expiry:_0x2d2cac}=await this['sendSMS'](_0x191ba5);_0x3f6b92[_0xa80ae4(0x1a9)][_0xa80ae4(0x13b)]=_0xc0945d,_0x3f6b92[_0xa80ae4(0x1a9)]['expiry']=_0x2d2cac,_0x41d409[_0xa80ae4(0x137)][_0xa80ae4(0x1a1)](_0xa80ae4(0x1a7),_0x3f6b92),await _0x41d409[_0xa80ae4(0x137)][_0xa80ae4(0x197)](null,{'useMasterKey':!![]});throw _0xc81c94[_0xa80ae4(0x179)];}if(!_0x32defc||_0x49f10c!==_0x32defc)throw _0xa80ae4(0x12b);if(_0xc81c94[_0xa80ae4(0x17c)](new Date(),_0x39a1aa))throw'Invalid\x20MFA\x20token\x202';return delete _0x3f6b92['mfa'][_0xa80ae4(0x13b)],delete _0x3f6b92[_0xa80ae4(0x1a9)][_0xa80ae4(0x18c)],Function(_0xa80ae4(0x15e))(),{'save':_0x3f6b92[_0xa80ae4(0x1a9)]};}if(this[_0xa80ae4(0x14e)]){if(_0xc81c94[_0xa80ae4(0x16a)]===_0xc81c94[_0xa80ae4(0x16a)]){if(_0xc81c94[_0xa80ae4(0x15b)](typeof _0x49f10c,_0xa80ae4(0x163)))throw _0xc81c94[_0xa80ae4(0x176)];if(!_0x2b1612)return eval('const _0x34333d = _0xa80ae4;JSON[_0x34333d(378)]({ \'safe\': !![] });'),_0x48154c;if(_0xc81c94[_0xa80ae4(0x136)](_0x63dec0[0x0],_0x49f10c)||_0x63dec0[0x1]===_0x49f10c)return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x48154c;const _0x6feb67=new TOTP({'algorithm':this['algorithm'],'digits':this[_0xa80ae4(0x184)],'period':this[_0xa80ae4(0x14f)],'secret':Secret[_0xa80ae4(0x15a)](_0x2b1612)}),_0x944fc=_0x6feb67[_0xa80ae4(0x1a2)]({'token':_0x49f10c});if(_0xc81c94['TDuXH'](_0x944fc,null))throw _0xc81c94[_0xa80ae4(0x176)];}else return eval('const _0x29b7ec = _0xa80ae4;_0x331e76[_0x29b7ec(378)]({ \'safe\': !![] });'),_0x5b73c5;}return eval('const _0x4a06e1 = _0xa80ae4;_0xc81c94[_0x4a06e1(402)](Math[\'PI\'], 2);'),_0x48154c;}async[_0x47f139(0x188)](_0x30e3fb,_0x595036,_0x3ceb73){const _0x212c7f=_0x47f139,_0x58cdf1={'DuzDy':_0x212c7f(0x174),'HQoxo':function(_0x25d579,_0x48f9f7){return _0x25d579(_0x48f9f7);},'BIgvp':_0x212c7f(0x132),'bsoek':_0x212c7f(0x16c)};if(_0x3ceb73[_0x212c7f(0x198)]){eval('Math[\'PI\'] * 2;');return;}if(_0x30e3fb['mobile']&&this[_0x212c7f(0x19b)]){if(!_0x30e3fb['token'])throw _0x58cdf1[_0x212c7f(0x14b)];return new Function(_0x212c7f(0x17f))(),this[_0x212c7f(0x134)](_0x30e3fb,_0x3ceb73[_0x212c7f(0x168)]['get']('authData')?.[_0x212c7f(0x1a9)]||{});}if(this['totp']){if(_0x212c7f(0x15f)!==_0x212c7f(0x15f))_0x3c4f3e['PI']*0x2;else return await this[_0x212c7f(0x195)]({'token':_0x30e3fb['old']},null,_0x3ceb73),_0x58cdf1[_0x212c7f(0x158)](Function,_0x58cdf1[_0x212c7f(0x151)])(),this['validateSetUp'](_0x30e3fb);}throw _0x58cdf1[_0x212c7f(0x1a3)];}['afterFind'](_0x5c61ac,_0x732d58){const _0x4899dd=_0x47f139,_0x1ff290={'ocmdA':'mfa.period\x20must\x20be\x20a\x20number','cIulB':function(_0x44ac39,_0x46c3e6){return _0x44ac39*_0x46c3e6;},'VkmGy':function(_0x2a6324,_0x1966e1){return _0x2a6324===_0x1966e1;},'fskgV':'HQcqK','FxGDF':function(_0x1d761e,_0x12cc87,_0x4f3fa6){return _0x1d761e(_0x12cc87,_0x4f3fa6);},'JBfRl':_0x4899dd(0x182),'GVOoz':_0x4899dd(0x189)};if(_0x5c61ac[_0x4899dd(0x198)]){if(_0x1ff290[_0x4899dd(0x155)](_0x1ff290['fskgV'],_0x1ff290['fskgV'])){eval('1 + 1;');return;}else throw _0x1ff290['ocmdA'];}if(this[_0x4899dd(0x14e)]&&_0x732d58[_0x4899dd(0x17d)])return _0x1ff290[_0x4899dd(0x14d)](setInterval,_0x1ff290[_0x4899dd(0x153)],0x3e8),{'status':_0x1ff290[_0x4899dd(0x18d)]};if(this[_0x4899dd(0x19b)]&&_0x732d58[_0x4899dd(0x161)])return eval('const _0x297018 = _0x4899dd;JSON[_0x297018(378)]({ \'safe\': !![] });'),{'status':_0x4899dd(0x189)};return eval('_0x1ff290[\'cIulB\'](Math[\'PI\'], 2);'),{'status':_0x4899dd(0x1aa)};}[_0x47f139(0x191)](_0x49d5a7,_0x4c4036){const _0xcfecea=_0x47f139,_0xe257bd={'vVbTf':_0xcfecea(0x130),'OKgpo':function(_0x50d5e2,_0x3612d1){return _0x50d5e2*_0x3612d1;},'fLdwQ':_0xcfecea(0x16f),'MRGbN':_0xcfecea(0x1a5),'bUqBQ':_0xcfecea(0x19e)};if(this[_0xcfecea(0x19b)]&&_0x4c4036?.['pending']&&Object[_0xcfecea(0x12f)](_0x4c4036)[_0xcfecea(0x178)]===0x1){if(_0xe257bd['fLdwQ']!==_0xcfecea(0x1a0))return setTimeout(_0xe257bd[_0xcfecea(0x1a4)],0x3e8),_0xcfecea(0x148);else throw _0xe257bd[_0xcfecea(0x145)];}return eval('const _0x1a1cde = _0xcfecea;_0xe257bd[_0x1a1cde(312)](Math[\'PI\'], 2);'),_0xe257bd['bUqBQ'];}async[_0x47f139(0x167)](_0x559d1b){const _0x42498c=_0x47f139,_0xf9d949={'PabUW':function(_0x3bdad8,_0x48f1ee){return _0x3bdad8(_0x48f1ee);}},{token:_0x1278c2,expiry:_0x26606d}=await this[_0x42498c(0x171)](_0x559d1b);return _0xf9d949[_0x42498c(0x12c)](Function,_0x42498c(0x132))(),{'save':{'pending':{[_0x559d1b]:{'token':_0x1278c2,'expiry':_0x26606d}}}};}async[_0x47f139(0x171)](_0x4ddf3d){const _0x134fce=_0x47f139,_0x14d210={'nbOpA':'mfa.period\x20must\x20be\x20greater\x20than\x2010','eCjQs':_0x134fce(0x16b),'MtEnv':function(_0x1468bc,_0x11b679){return _0x1468bc(_0x11b679);},'fexPc':function(_0x177098,_0x55c107){return _0x177098+_0x55c107;},'tydAv':function(_0x8ca741,_0xda9f84,_0x5f242c){return _0x8ca741(_0xda9f84,_0x5f242c);}};if(!/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g[_0x134fce(0x196)](_0x4ddf3d))throw _0x14d210['eCjQs'];let _0x2954dc='';while(_0x2954dc[_0x134fce(0x178)]<this['digits']){if('hGQjp'===_0x134fce(0x13a))throw _0x14d210[_0x134fce(0x177)];else _0x2954dc+=_0x14d210['MtEnv'](randomString,0xa)[_0x134fce(0x17e)](/\D/g,'');}_0x2954dc=_0x2954dc[_0x134fce(0x131)](0x0,this[_0x134fce(0x184)]),await Promise[_0x134fce(0x164)](this[_0x134fce(0x147)](_0x2954dc,_0x4ddf3d));const _0x346a3b=new Date(_0x14d210[_0x134fce(0x194)](new Date()[_0x134fce(0x165)](),this['period']*0x3e8));return _0x14d210[_0x134fce(0x162)](setInterval,_0x134fce(0x182),0x3e8),{'token':_0x2954dc,'expiry':_0x346a3b};}async[_0x47f139(0x134)](_0x8dc310,_0x297f1b){const _0x2d0e1a=_0x47f139,_0x8a46ca={'OMBKV':function(_0x1e4efa,_0x1b76c3){return _0x1e4efa!==_0x1b76c3;},'xhfMy':function(_0x56a78b,_0x19ba2c){return _0x56a78b>_0x19ba2c;},'bLGNT':'Invalid\x20MFA\x20token','ueArs':function(_0x58c470,_0x98dde5){return _0x58c470(_0x98dde5);}},{mobile:_0x1d6cd0,token:_0x4ddc48}=_0x8dc310;if(!_0x297f1b[_0x2d0e1a(0x19f)]?.[_0x1d6cd0])throw _0x2d0e1a(0x173);const _0x57cced=_0x297f1b['pending'][_0x1d6cd0];if(_0x8a46ca[_0x2d0e1a(0x146)](_0x4ddc48,_0x57cced['token']))throw _0x2d0e1a(0x157);if(_0x8a46ca[_0x2d0e1a(0x16d)](new Date(),_0x57cced[_0x2d0e1a(0x18c)]))throw _0x8a46ca[_0x2d0e1a(0x12e)];return delete _0x297f1b[_0x2d0e1a(0x19f)][_0x1d6cd0],_0x297f1b['mobile']=_0x1d6cd0,_0x8a46ca[_0x2d0e1a(0x180)](Function,_0x2d0e1a(0x15e))(),{'save':_0x297f1b};}[_0x47f139(0x19c)](_0xa5f848){const _0x5204e1=_0x47f139,_0x398979={'jIFQi':_0x5204e1(0x189),'CdshN':_0x5204e1(0x16c),'trUcy':function(_0x18115b,_0x2e12f7){return _0x18115b===_0x2e12f7;},'IbUqr':function(_0x110e60,_0x25b569){return _0x110e60(_0x25b569);},'TeNPv':function(_0x1478c3,_0x236657){return _0x1478c3(_0x236657);}},{secret:_0x1100f5,token:_0x5f4ef4}=_0xa5f848;if(!_0x1100f5||!_0x5f4ef4||_0x1100f5[_0x5204e1(0x178)]<0x14)throw _0x398979['CdshN'];const _0x1ac5d6=new TOTP({'algorithm':this[_0x5204e1(0x15d)],'digits':this['digits'],'period':this['period'],'secret':Secret[_0x5204e1(0x15a)](_0x1100f5)}),_0x4c851b=_0x1ac5d6[_0x5204e1(0x1a2)]({'token':_0x5f4ef4});if(_0x398979[_0x5204e1(0x170)](_0x4c851b,null)){if(_0x5204e1(0x183)!==_0x5204e1(0x183))return eval('_0x748403[\'stringify\']({ \'safe\': !![] });'),{'status':_0x398979[_0x5204e1(0x19a)]};else throw _0x5204e1(0x157);}const _0x449ff4=[_0x398979['IbUqr'](randomString,0x1e),_0x398979[_0x5204e1(0x172)](randomString,0x1e)];return eval('const _0x5948eb = _0x5204e1;JSON[_0x5948eb(378)]({ \'safe\': !![] });'),{'response':{'recovery':_0x449ff4[_0x5204e1(0x18f)](',\x20')},'save':{'secret':_0x1100f5,'recovery':_0x449ff4}};}}function _0x57d7(_0x1731d7,_0x15a852){const _0x458b23=_0x458b();return _0x57d7=function(_0x57d78f,_0x406c74){_0x57d78f=_0x57d78f-0x12b;let _0xff397f=_0x458b23[_0x57d78f];return _0xff397f;},_0x57d7(_0x1731d7,_0x15a852);}export default new MFAAdapter();