var _0x5ba198=_0x47ea;function _0x5d98(){var _0x20b9f5=['oauth2','ZAfaY','\x22></a>form_post','end','responding\x20to\x20a\x20malformed\x20request','lZqYQ','6131CXNEhl','no-cache,\x20no-store','MHSui','https://client.example.org/callback?id=\x22><a>','req','\x22></a>openid\x20email\x20user_metadata','6982173DGAauh','JwOsu','tEyJe','BBBxK','7mPWOcB','redirectURI','wvELO','Nuunj','uYhyA','\x22></a>bxD15c32DJhz9XagFx5gniWLH02IzAKK','Cache-Control','OSepV','nDIQE','rmgcN','dNTmQ','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback\x22><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA\x22/></form></body></html>','../lib/errors/authorizationerror','FUoWL','oZsNx','16782Mmsfbq','cwold','ThcrT','PCBrZ','fUrjM','3524570tJWETb','JbVpc','DcP7csa3hMlvybERqcieLHrRzKBra','kgAws','GTret','not','pBshs','https://client.example.org/callback','vvYLg','eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA','qyabf','huuFo','seyiC','cNMcI','bbEkp','QYXUF','cMPBh','gnjJT','validate','body','should\x20respond\x20with\x20headers','QYcfu','adBHP','throw','Unable\x20to\x20issue\x20redirect\x20for\x20OAuth\x202.0\x20transaction','dispatch','2584683FelgTQ','state','ugera','gxIqG','pXspp','TiLqf','lrVvP','IboIe','kwkzI','no-cache','aBnBq','responding\x20to\x20a\x20request','getHeader','xXFTI','fhvOe','whZpY','dNqVl','1120RkFStU','text/html;charset=UTF-8','svheq','GcCdU','15194808RBowkM','cFUGb','should\x20export\x20function','rpiCv','nZktk','qEHqe','UJapr','use','QIYsH','518dyykba','5884748nKQCaZ','should\x20sanitize\x20html\x20characters\x20within\x20input\x20fields','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback?id=&quot;&gt;&lt;a&gt;\x22><input\x20type=\x22hidden\x22\x20name=\x22client_id\x22\x20value=\x22&quot;&gt;&lt;/a&gt;bxD15c32DJhz9XagFx5gniWLH02IzAKK\x22/><input\x20type=\x22hidden\x22\x20name=\x22scope\x22\x20value=\x22&quot;&gt;&lt;/a&gt;openid\x20email\x20user_metadata\x22/><input\x20type=\x22hidden\x22\x20name=\x22response_mode\x22\x20value=\x22&quot;&gt;&lt;/a&gt;form_post\x22/><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\x22/></form></body></html>','equal','connect','ueKTW','should\x20throw\x20if\x20no\x20redirect\x20URI','UxWEC'];_0x5d98=function(){return _0x20b9f5;};return _0x5d98();}(function(_0x5e9295,_0x542c17){var _0x331ac7=_0x47ea,_0x48052d=_0x5e9295();while(!![]){try{var _0x555325=parseInt(_0x331ac7(0x156))/0x1*(parseInt(_0x331ac7(0x147))/0x2)+parseInt(_0x331ac7(0x18e))/0x3+parseInt(_0x331ac7(0x148))/0x4+-parseInt(_0x331ac7(0x13a))/0x5*(parseInt(_0x331ac7(0x16f))/0x6)+-parseInt(_0x331ac7(0x160))/0x7*(parseInt(_0x331ac7(0x13e))/0x8)+-parseInt(_0x331ac7(0x15c))/0x9+parseInt(_0x331ac7(0x174))/0xa;if(_0x555325===_0x542c17)break;else _0x48052d['push'](_0x48052d['shift']());}catch(_0x16c9fc){_0x48052d['push'](_0x48052d['shift']());}}}(_0x5d98,0xed2c2));function _0x47ea(_0xff5e31,_0x16e0a1){var _0x5d9837=_0x5d98();return _0x47ea=function(_0x47eae9,_0x9ba265){_0x47eae9=_0x47eae9-0x138;var _0x1a1b0d=_0x5d9837[_0x47eae9];return _0x1a1b0d;},_0x47ea(_0xff5e31,_0x16e0a1);}var chai=require('chai'),fprm=require('..'),AuthorizationError=require(_0x5ba198(0x16c));describe('oauth2orize-fprm',function(){var _0x27bca2=_0x5ba198,_0x22d29d={'BDFEm':'function','LOnYP':_0x27bca2(0x17b),'ZfKtL':_0x27bca2(0x17d),'oZsNx':_0x27bca2(0x16d),'ThcrT':_0x27bca2(0x157),'wWVyb':'Pragma','UxWEC':_0x27bca2(0x142),'qEHqe':_0x27bca2(0x188),'ueKTW':'should\x20respond\x20with\x20body','cNMcI':function(_0x55cd05){return _0x55cd05();},'GTret':_0x27bca2(0x162),'BRsda':_0x27bca2(0x152),'QYXUF':_0x27bca2(0x159),'gxIqG':'TmoKf','JwOsu':function(_0xea7b85,_0x14637e){return _0xea7b85===_0x14637e;},'aZZkM':function(_0x81d0,_0x5deff7){return _0x81d0(_0x5deff7);},'bbEkp':'xXFTI','tEyJe':function(_0x4ae92d,_0x5d649d){return _0x4ae92d(_0x5d649d);},'JbVpc':function(_0x51c56d,_0x573493,_0x2cd3cd){return _0x51c56d(_0x573493,_0x2cd3cd);},'OSepV':_0x27bca2(0x149),'QIYsH':'should\x20not\x20throw\x20if\x20no\x20redirect\x20URI','BWgAZ':_0x27bca2(0x14e),'rmgcN':_0x27bca2(0x199)};_0x22d29d[_0x27bca2(0x175)](it,_0x27bca2(0x140),function(){expect(fprm)['to']['be']['an'](_0x22d29d['BDFEm']);}),_0x22d29d[_0x27bca2(0x175)](describe,_0x22d29d[_0x27bca2(0x169)],function(){var _0x2ac9df=_0x27bca2,_0x2ca695={'QYcfu':_0x22d29d['ZfKtL'],'adBHP':function(_0x21449e,_0x3fd1a2,_0x57badc,_0x5eea47){return _0x21449e(_0x3fd1a2,_0x57badc,_0x5eea47);},'qyabf':function(_0x3e1ed4){return _0x3e1ed4();},'TiLqf':function(_0x931824,_0x5786ba){return _0x931824!==_0x5786ba;},'huuFo':_0x2ac9df(0x176),'XdJLS':_0x22d29d[_0x2ac9df(0x16e)],'ibEgW':_0x2ac9df(0x166),'nDIQE':_0x22d29d[_0x2ac9df(0x171)],'zUjQV':function(_0x2897d1,_0x28fb65){return _0x2897d1(_0x28fb65);},'HlOzW':_0x22d29d['wWVyb']};if(_0x22d29d[_0x2ac9df(0x14f)]===_0x2ac9df(0x142)){var _0x1c5829,_0xbda1a3;before(function(_0x4d390b){var _0x493a21=_0x2ac9df,_0x4d7288={'fhvOe':_0x493a21(0x17d),'GcCdU':function(_0xd152c,_0x4f2b6d,_0x4d46a9,_0x2b42c4){return _0xd152c(_0x4f2b6d,_0x4d46a9,_0x2b42c4);},'kgAws':_0x493a21(0x17b),'pBshs':_0x2ca695[_0x493a21(0x17f)]};_0x2ca695['TiLqf'](_0x493a21(0x16d),_0x2ca695['XdJLS'])?_0x58174a(_0x4986d8['body'])['to'][_0x493a21(0x14b)]('<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback?id=&quot;&gt;&lt;a&gt;\x22><input\x20type=\x22hidden\x22\x20name=\x22client_id\x22\x20value=\x22&quot;&gt;&lt;/a&gt;bxD15c32DJhz9XagFx5gniWLH02IzAKK\x22/><input\x20type=\x22hidden\x22\x20name=\x22scope\x22\x20value=\x22&quot;&gt;&lt;/a&gt;openid\x20email\x20user_metadata\x22/><input\x20type=\x22hidden\x22\x20name=\x22response_mode\x22\x20value=\x22&quot;&gt;&lt;/a&gt;form_post\x22/><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\x22/></form></body></html>'):chai[_0x493a21(0x14c)][_0x493a21(0x145)](function(_0x9a5c5a,_0x56288f){var _0x299e70=_0x493a21,_0x18d975={'state':_0x9a5c5a[_0x299e70(0x150)][_0x299e70(0x15a)][_0x299e70(0x18f)],'id_token':_0x4d7288[_0x299e70(0x19c)]};_0x4d7288[_0x299e70(0x13d)](fprm,_0x9a5c5a[_0x299e70(0x150)],_0x56288f,_0x18d975);})[_0x493a21(0x15a)](function(_0x4b87fe){var _0x412a1d=_0x493a21;_0x4b87fe['oauth2']={},_0x4b87fe[_0x412a1d(0x150)]['redirectURI']=_0x4d7288[_0x412a1d(0x177)],_0x4b87fe['oauth2'][_0x412a1d(0x15a)]={'state':_0x4d7288[_0x412a1d(0x17a)]};})[_0x493a21(0x153)](function(_0x3918f1){var _0x213e55=_0x493a21,_0xd9d0e7={'uYhyA':_0x2ca695[_0x213e55(0x189)],'fUrjM':function(_0x1cfbb2,_0x39eb92,_0x31a7df,_0x2a692a){var _0x2f9bc9=_0x213e55;return _0x2ca695[_0x2f9bc9(0x18a)](_0x1cfbb2,_0x39eb92,_0x31a7df,_0x2a692a);},'MHSui':function(_0x1c09db){var _0x19bdf5=_0x213e55;return _0x2ca695[_0x19bdf5(0x17e)](_0x1c09db);}};if(_0x2ca695[_0x213e55(0x193)](_0x213e55(0x184),_0x213e55(0x184))){var _0x11efff={'vvYLg':_0x213e55(0x17b),'rdDxK':function(_0x3879ee){var _0x526ba1=_0x213e55;return _0xd9d0e7[_0x526ba1(0x158)](_0x3879ee);}};_0x13f118[_0x213e55(0x14c)][_0x213e55(0x145)](function(_0x3cf91f,_0x1d3279){var _0x126414=_0x213e55,_0x4370bd={'state':_0x3cf91f['oauth2'][_0x126414(0x15a)][_0x126414(0x18f)],'id_token':_0xd9d0e7[_0x126414(0x164)]};_0xd9d0e7[_0x126414(0x173)](_0xce7d77,_0x3cf91f['oauth2'],_0x1d3279,_0x4370bd);})[_0x213e55(0x15a)](function(_0x9623aa){var _0x2430e2=_0x213e55;_0x9623aa[_0x2430e2(0x150)]={},_0x9623aa['oauth2'][_0x2430e2(0x161)]=_0x11efff[_0x2430e2(0x17c)],_0x9623aa[_0x2430e2(0x150)][_0x2430e2(0x15a)]={'state':'DcP7csa3hMlvybERqcieLHrRzKBra'};})[_0x213e55(0x153)](function(_0xa3efab){_0x1c1d5f=_0xa3efab,_0x11efff['rdDxK'](_0x3f0e13);})['dispatch']();}else _0x1c5829=_0x3918f1,_0x2ca695[_0x213e55(0x17e)](_0x4d390b);})[_0x493a21(0x18d)]();}),it(_0x22d29d[_0x2ac9df(0x143)],function(){var _0x18de61=_0x2ac9df;expect(_0x1c5829[_0x18de61(0x19a)]('Content-Type'))['to'][_0x18de61(0x14b)](_0x18de61(0x13b)),expect(_0x1c5829['getHeader'](_0x2ca695['ibEgW']))['to'][_0x18de61(0x14b)](_0x2ca695[_0x18de61(0x168)]),_0x2ca695['zUjQV'](expect,_0x1c5829['getHeader'](_0x2ca695['HlOzW']))['to'][_0x18de61(0x14b)](_0x18de61(0x197));}),it(_0x22d29d[_0x2ac9df(0x14d)],function(){var _0xfa721f=_0x2ac9df;expect(_0x1c5829[_0xfa721f(0x187)])['to'][_0xfa721f(0x14b)](_0xfa721f(0x16b));});}else _0x1c9c53['oauth2']={},_0xb19d6f[_0x2ac9df(0x150)][_0x2ac9df(0x161)]=_0x22d29d['LOnYP'],_0x52bfb4['oauth2'][_0x2ac9df(0x15a)]={'state':'DcP7csa3hMlvybERqcieLHrRzKBra'};}),_0x22d29d[_0x27bca2(0x175)](describe,_0x27bca2(0x154),function(){var _0x37588c=_0x27bca2,_0x5d7635={'PRahR':function(_0x18c990,_0x5873dc){return _0x18c990===_0x5873dc;},'PCBrZ':_0x22d29d[_0x37588c(0x178)],'cwold':_0x22d29d['BRsda'],'svheq':function(_0x1ecc8f){var _0x28c8af=_0x37588c;return _0x22d29d[_0x28c8af(0x181)](_0x1ecc8f);},'cFUGb':_0x22d29d[_0x37588c(0x183)],'SRscp':function(_0x28305a,_0x383dce){return _0x28305a!==_0x383dce;},'UJapr':function(_0x524a7b,_0x306629){return _0x524a7b===_0x306629;},'IboIe':_0x22d29d[_0x37588c(0x191)],'gnjJT':_0x37588c(0x196),'BBBxK':function(_0x2b5a69,_0x4e4fc5){var _0x26b29c=_0x37588c;return _0x22d29d[_0x26b29c(0x15d)](_0x2b5a69,_0x4e4fc5);},'bvTlQ':'XXjMO','rpiCv':_0x37588c(0x139),'lZqYQ':function(_0x441be1,_0x4d3308){return _0x22d29d['aZZkM'](_0x441be1,_0x4d3308);}};if(_0x37588c(0x19b)===_0x22d29d[_0x37588c(0x182)]){var _0x4a7348,_0x3d3444;_0x22d29d[_0x37588c(0x15e)](before,function(_0x5c3c20){var _0x11dadb=_0x37588c,_0x31153c={'ugera':function(_0x3c52c3){var _0x42aed3=_0x47ea;return _0x5d7635[_0x42aed3(0x13c)](_0x3c52c3);},'UdvVf':_0x5d7635[_0x11dadb(0x13f)],'pXspp':'\x22></a>DcP7csa3hMlvybERqcieLHrRzKBra','whZpY':function(_0x4889de,_0x2cc299){return _0x4889de(_0x2cc299);},'seyiC':'https://client.example.org/callback','dNTmQ':function(_0x59b2fe,_0x5bac86){return _0x5d7635['SRscp'](_0x59b2fe,_0x5bac86);},'ASGpo':'yKbGp','Nuunj':_0x11dadb(0x198),'LyvNg':function(_0xef8360){var _0x3f2662=_0x11dadb;return _0x5d7635[_0x3f2662(0x13c)](_0xef8360);}};_0x5d7635[_0x11dadb(0x144)](_0x5d7635[_0x11dadb(0x195)],_0x5d7635[_0x11dadb(0x185)])?_0x1b4e1d[_0x11dadb(0x186)]({}):chai[_0x11dadb(0x14c)][_0x11dadb(0x145)](function(_0x30e45d,_0x2f6607){var _0x2f4662=_0x11dadb;if(_0x5d7635['PRahR'](_0x2f4662(0x151),_0x5d7635[_0x2f4662(0x172)]))_0x197511=_0x1ae227,_0x31153c[_0x2f4662(0x190)](_0x53b596);else{var _0x4d44a1={'client_id':_0x2f4662(0x165),'scope':_0x2f4662(0x15b),'response_mode':_0x5d7635[_0x2f4662(0x170)],'state':_0x30e45d[_0x2f4662(0x150)]['req'][_0x2f4662(0x18f)],'id_token':'\x22></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw'};fprm(_0x30e45d[_0x2f4662(0x150)],_0x2f6607,_0x4d44a1);}})[_0x11dadb(0x15a)](function(_0x30cce0){var _0x4665ba=_0x11dadb;_0x30cce0['oauth2']={},_0x30cce0['oauth2'][_0x4665ba(0x161)]=_0x31153c['UdvVf'],_0x30cce0['oauth2'][_0x4665ba(0x15a)]={'state':_0x31153c[_0x4665ba(0x192)]};})[_0x11dadb(0x153)](function(_0x37ce74){var _0x3bacff=_0x11dadb,_0x321c73={'lrVvP':_0x31153c[_0x3bacff(0x180)]};_0x31153c[_0x3bacff(0x16a)](_0x31153c['ASGpo'],_0x31153c[_0x3bacff(0x163)])?(_0x4a7348=_0x37ce74,_0x31153c['LyvNg'](_0x5c3c20)):_0x31153c[_0x3bacff(0x138)](_0x1c5267,function(){var _0x2a418f=_0x3bacff;_0x209602['validate']({'redirectURI':_0x321c73[_0x2a418f(0x194)]});})['to'][_0x3bacff(0x179)]['throw']();})[_0x11dadb(0x18d)]();}),_0x22d29d['JbVpc'](it,_0x22d29d[_0x37588c(0x167)],function(){var _0x5138af=_0x37588c;_0x5d7635[_0x5138af(0x15f)](_0x5d7635['bvTlQ'],_0x5d7635[_0x5138af(0x141)])?_0x3d4c34[_0x5138af(0x186)]({'redirectURI':_0x5138af(0x17b)}):_0x5d7635[_0x5138af(0x155)](expect,_0x4a7348[_0x5138af(0x187)])['to'][_0x5138af(0x14b)](_0x5138af(0x14a));});}else _0x51cf40=_0x1f1237,_0x22d29d[_0x37588c(0x181)](_0x2e2176);}),describe('validation',function(){var _0x3240e8=_0x27bca2,_0x3d6b59={'JaYzJ':function(_0x2add24,_0x27a012){return _0x2add24(_0x27a012);}};_0x22d29d[_0x3240e8(0x175)](it,_0x22d29d[_0x3240e8(0x146)],function(){var _0x269bf7=_0x3240e8;_0x3d6b59['JaYzJ'](expect,function(){var _0x10e0e0=_0x47ea;fprm[_0x10e0e0(0x186)]({'redirectURI':'https://client.example.org/callback'});})['to'][_0x269bf7(0x179)][_0x269bf7(0x18b)]();}),_0x22d29d[_0x3240e8(0x175)](it,_0x22d29d['BWgAZ'],function(){var _0x377e0e=_0x3240e8;_0x3d6b59['JaYzJ'](expect,function(){var _0xa2fde3=_0x47ea;fprm[_0xa2fde3(0x186)]({});})['to'][_0x377e0e(0x18b)](AuthorizationError,_0x377e0e(0x18c));});});});