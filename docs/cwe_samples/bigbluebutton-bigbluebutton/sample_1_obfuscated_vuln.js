const _0x4941b7=_0x56d8;(function(_0x474fb7,_0x254d42){const _0x4bfbef=_0x56d8,_0x2b67c6=_0x474fb7();while(!![]){try{const _0x4eb1c6=parseInt(_0x4bfbef(0x135))/0x1+parseInt(_0x4bfbef(0x1a9))/0x2*(-parseInt(_0x4bfbef(0x14e))/0x3)+parseInt(_0x4bfbef(0x13f))/0x4+parseInt(_0x4bfbef(0x125))/0x5*(-parseInt(_0x4bfbef(0x170))/0x6)+parseInt(_0x4bfbef(0x13c))/0x7*(-parseInt(_0x4bfbef(0x17e))/0x8)+parseInt(_0x4bfbef(0x1c5))/0x9*(-parseInt(_0x4bfbef(0x166))/0xa)+-parseInt(_0x4bfbef(0x1bb))/0xb*(-parseInt(_0x4bfbef(0x15e))/0xc);if(_0x4eb1c6===_0x254d42)break;else _0x2b67c6['push'](_0x2b67c6['shift']());}catch(_0x430c29){_0x2b67c6['push'](_0x2b67c6['shift']());}}}(_0x262d,0x7d818));function _0x56d8(_0x56b4b5,_0x49c591){const _0x262d1c=_0x262d();return _0x56d8=function(_0x56d849,_0x14e3d9){_0x56d849=_0x56d849-0x11c;let _0x2526e4=_0x262d1c[_0x56d849];return _0x2526e4;},_0x56d8(_0x56b4b5,_0x49c591);}const assert=require(_0x4941b7(0x131)),fs=require('fs'),{expect}=require(_0x4941b7(0x18c)),saml20=require(_0x4941b7(0x189))[_0x4941b7(0x139)],utils=require('../lib/passport-wsfed-saml2/utils'),SamlPassport=require('../lib/passport-wsfed-saml2/saml')['SAML'];describe('saml\x202.0\x20assertion',function(){const _0x3fbaee=_0x4941b7,_0x23031b={'hwTHI':function(_0x52a7ef,_0x49bc57){return _0x52a7ef(_0x49bc57);},'zQimW':function(_0x5b2fbc,_0x42e6c4){return _0x5b2fbc+_0x42e6c4;},'pJMNJ':_0x3fbaee(0x18d),'SJwUO':_0x3fbaee(0x17c),'teueu':function(_0x3f0eb3){return _0x3f0eb3();},'UESko':_0x3fbaee(0x192),'pBzUL':_0x3fbaee(0x124),'yBiPV':_0x3fbaee(0x1bf),'DQYej':'<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22\x20IssueInstant=\x222016-08-02T21:54:04.971Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_ne0Z8R1z9xdbekXeWrAAg7srNB78exsb\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>p7iHnIt5xJZNimGNxh4d9R2J7DML8WNrMwMxmZ1WwSU=</DigestValue></Reference></SignedInfo><SignatureValue>pb1Wp/LFbigEj+TNm7gkAwlfIc17LNwUXVTgM8RQnMvYJfIPZbl1yo5xMCh6ObMFwCs1T+gKI5C7jMloX2QhWD/XUffBKiDfkZUg7NI/Jyt5m+Bdst12SNhHBVsNilL9ZCuf+QtQD7301gUhVHP6Ramf4y+XNod9AfzhFLYNfl6fhf/5KA/KkjiOwYW5Ps/43OMXXSeVaeQ7JRU8XqyKbwlB+YXGseFLnyZopv8Cw9Bb2935ADLX111oFBkiRhnMUJW0LMbSWM6UVJ4V0qoW9h+f3isN5+R87RECNeAQP3WSBiddnEuSdhgQYQVnb6s0mThpvs7uvIOlog0FqeSrvQ==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22\x20NameQualifier=\x22name-qualifier\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-08-02T21:54:04.971Z\x22\x20NotOnOrAfter=\x222016-08-02T22:04:04.971Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-08-02T21:54:04.971Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','mtIzX':function(_0x170a3f,_0x4e3ab0){return _0x170a3f+_0x4e3ab0;},'BrKxh':_0x3fbaee(0x1a8),'QSfqG':_0x3fbaee(0x187),'Vaqfu':function(_0x2897c4,_0x3dc63d){return _0x2897c4+_0x3dc63d;},'cJRBQ':_0x3fbaee(0x1cb),'yOMhH':function(_0x17fbac,_0x1fdc82){return _0x17fbac+_0x1fdc82;},'mnsvh':_0x3fbaee(0x13b),'ZvHKK':function(_0x23f92b){return _0x23f92b();},'fRYxu':function(_0x5c98bf,_0x622159){return _0x5c98bf!==_0x622159;},'QlzLO':'Admins','soopB':_0x3fbaee(0x1a7),'bdSFH':function(_0x491606,_0x15b7fd){return _0x491606+_0x15b7fd;},'niQdW':function(_0x39926d,_0x326310){return _0x39926d===_0x326310;},'qQemy':'NADDQ','cqNtC':function(_0xcf942d,_0x8a939a){return _0xcf942d+_0x8a939a;},'cbxQe':_0x3fbaee(0x155),'vkvoi':_0x3fbaee(0x1b8),'ppWVg':_0x3fbaee(0x132),'jpbHP':function(_0x580195,_0x175246){return _0x580195(_0x175246);},'bjQAZ':function(_0x15c671,_0x57cf50){return _0x15c671+_0x57cf50;},'lJwgI':_0x3fbaee(0x14f),'tLkwW':function(_0x681e95,_0x2699e2){return _0x681e95(_0x2699e2);},'fZrcn':'The\x20signing\x20certificate\x20is\x20not\x20currently\x20valid.','WbjVb':'X509Certificate','rvcmQ':_0x3fbaee(0x175),'rjpdF':_0x3fbaee(0x17d),'QuWAs':function(_0x14b93f,_0x643ac8){return _0x14b93f+_0x643ac8;},'KMtUK':_0x3fbaee(0x171),'PfQNE':'сообщить@bar.com','mHVFY':_0x3fbaee(0x19f),'XlfeE':_0x3fbaee(0x1a2),'lcnjY':_0x3fbaee(0x182),'DZcsB':_0x3fbaee(0x1b2),'WjyDP':_0x3fbaee(0x148),'RhvaI':_0x3fbaee(0x1ae),'tQGkf':'<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','JTIUJ':'Signature\x20is\x20missing\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])','trRzs':'should\x20fail\x20when\x20signature\x20is\x20not\x20found','xQsrx':_0x3fbaee(0x18b),'WHmVX':function(_0x26e4f0,_0x2f036d,_0x2488d4){return _0x26e4f0(_0x2f036d,_0x2488d4);},'znCSX':_0x3fbaee(0x183),'yuPzO':function(_0x4179e9,_0x536a91,_0x2d1b68){return _0x4179e9(_0x536a91,_0x2d1b68);},'hjceQ':'should\x20ignore\x20the\x20NameQualifier\x20validation\x20when\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22','DFJij':_0x3fbaee(0x1b7),'ZBKZg':_0x3fbaee(0x1b1),'wlLFC':_0x3fbaee(0x122),'Smxmc':'should\x20parse\x20attributes\x20with\x20multiple\x20values','sDxAz':function(_0x2694cd,_0x27d232,_0x17cc53){return _0x2694cd(_0x27d232,_0x17cc53);},'tlFOY':_0x3fbaee(0x1b3),'Thlfj':'should\x20validate\x20certificate\x20expiration\x20with\x20non-embedded\x20cert','wiMDO':_0x3fbaee(0x1a4),'ngmAO':_0x3fbaee(0x17b)},_0x166789={'cert':fs[_0x3fbaee(0x1bd)](__dirname+_0x23031b[_0x3fbaee(0x150)]),'key':fs[_0x3fbaee(0x1bd)](__dirname+_0x23031b[_0x3fbaee(0x15d)]),'issuer':_0x3fbaee(0x192),'lifetimeInSeconds':0x258,'audiences':_0x23031b['SJwUO'],'attributes':{'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress':_0x3fbaee(0x132),'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name':_0x3fbaee(0x155)},'nameIdentifier':_0x23031b['yBiPV'],'nameIdentifierFormat':_0x3fbaee(0x1a2)};_0x23031b[_0x3fbaee(0x1cf)](it,_0x23031b[_0x3fbaee(0x176)],function(_0x36ff14){const _0x2218ff=_0x3fbaee,_0x3dc526={'ozICf':function(_0x3688a5,_0xf4c9e){const _0x5c7835=_0x56d8;return _0x23031b[_0x5c7835(0x174)](_0x3688a5,_0xf4c9e);},'DRSyL':'foo','RXhrU':_0x2218ff(0x132),'TgjJM':_0x2218ff(0x192)},_0x2acca9=saml20[_0x2218ff(0x152)](_0x166789),_0x3962a7=fs[_0x2218ff(0x1bd)](_0x23031b[_0x2218ff(0x1b6)](__dirname,_0x23031b[_0x2218ff(0x1c7)]))['toString'](),_0x3ac33f=new SamlPassport({'cert':_0x3962a7,'realm':_0x23031b[_0x2218ff(0x133)],'checkRecipient':![]});_0x3ac33f[_0x2218ff(0x1c2)](_0x2acca9,function(_0x22364f,_0x575f67){const _0x49d1bd=_0x2218ff;if(_0x22364f)return _0x3dc526[_0x49d1bd(0x134)](_0x36ff14,_0x22364f);assert['ok'](_0x575f67),assert['equal'](_0x3dc526[_0x49d1bd(0x1ce)],_0x575f67[_0x49d1bd(0x14f)]),assert['equal'](_0x49d1bd(0x155),_0x575f67[_0x49d1bd(0x1b8)]),assert['equal'](_0x3dc526[_0x49d1bd(0x1c6)],_0x575f67[_0x49d1bd(0x124)]),assert['equal'](_0x3dc526[_0x49d1bd(0x1c6)],_0x575f67['email']),assert['equal'](_0x3dc526[_0x49d1bd(0x1cd)],_0x575f67['issuer']),_0x36ff14();});}),_0x23031b[_0x3fbaee(0x121)](it,_0x23031b[_0x3fbaee(0x13e)],function(_0x4575fc){const _0xc993d1=_0x3fbaee,_0x334891=_0x23031b[_0xc993d1(0x13d)],_0x11ab2e=fs[_0xc993d1(0x1bd)](_0x23031b[_0xc993d1(0x19c)](__dirname,_0xc993d1(0x18d)))[_0xc993d1(0x12c)](),_0x268722=new SamlPassport({'cert':_0x11ab2e,'realm':_0x23031b[_0xc993d1(0x133)],'checkRecipient':![],'checkExpiration':![]});_0x268722[_0xc993d1(0x1c2)](_0x334891,function(_0x20a839,_0x210c19){const _0x462edf=_0xc993d1,_0x1a19d4=_0x462edf(0x197)[_0x462edf(0x163)]('|');let _0x3c178f=0x0;while(!![]){switch(_0x1a19d4[_0x3c178f++]){case'0':if(_0x20a839)return _0x23031b[_0x462edf(0x174)](_0x4575fc,_0x20a839);continue;case'1':assert[_0x462edf(0x162)](_0x462edf(0x132),_0x210c19[_0x462edf(0x142)]);continue;case'2':_0x23031b['teueu'](_0x4575fc);continue;case'3':assert[_0x462edf(0x162)](_0x23031b[_0x462edf(0x12b)],_0x210c19[_0x462edf(0x143)]);continue;case'4':assert[_0x462edf(0x162)](_0x462edf(0x155),_0x210c19['http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name']);continue;case'5':assert['ok'](_0x210c19);continue;case'6':assert[_0x462edf(0x162)](_0x462edf(0x132),_0x210c19[_0x23031b[_0x462edf(0x153)]]);continue;case'7':assert[_0x462edf(0x162)](_0x23031b['yBiPV'],_0x210c19[_0x462edf(0x14f)]);continue;}break;}});}),it(_0x23031b[_0x3fbaee(0x157)],function(_0x32ae7f){const _0x190f00=_0x3fbaee,_0x4f1edf={'nhhqP':_0x190f00(0x155),'qsReI':_0x190f00(0x1b8),'VQZji':_0x190f00(0x132),'JArwI':'urn:issuer','IYeRO':_0x190f00(0x143)},_0x11731d='<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_nPmKm9IskDCo61hUea4DX7o3POLbLcUK\x22\x20IssueInstant=\x222016-08-02T21:59:48.654Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_nPmKm9IskDCo61hUea4DX7o3POLbLcUK\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>UYsy9NacnRqnSTbidM8WBBgS+Op0G05iBJTX0T1WlUk=</DigestValue></Reference></SignedInfo><SignatureValue>VzRQaMR5Qk1P+g1tqJRKroq4JJx00FZ0rZxO4vG2gGkBXJ8262B4VUHOkxyPHNH1l/DuxSnNsL8AAbZfn8EdxMdToPvm2hkqygyA5W20o6g6eSC41rDOavTzesOKoXn3Uq9DOiUXve5ieYYCt5bQcoSCVT6uhVEKMhdcLhaB507qj9Gzcfp0E4F57ezRTTnVVEF/wCJ5j0QTMA2Wh09fxNkGijlE8KHzDJZapN4tDCzmK8qY7211gKuTfKYJGXYA4hSxw9fiQGDEPKRYA6tWf0HO5Vd8edRg2ZHr7AgjuCPp5Fj8VOP+KppA1YFBbq4Eqqt6KHg91KJlGs3ivpmwPw==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22\x20SPNameQualifier=\x22other-qualifier\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-08-02T22:09:48.654Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-08-02T21:59:48.654Z\x22\x20NotOnOrAfter=\x222016-08-02T22:09:48.654Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-08-02T21:59:48.654Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>',_0x24d976=fs[_0x190f00(0x1bd)](__dirname+_0x190f00(0x18d))[_0x190f00(0x12c)](),_0x5975ab=new SamlPassport({'cert':_0x24d976,'realm':_0x23031b[_0x190f00(0x133)],'checkRecipient':![],'checkExpiration':![]});_0x5975ab[_0x190f00(0x1c2)](_0x11731d,function(_0x5a7993,_0x426860){const _0x19b2b7=_0x190f00;if(_0x5a7993)return _0x32ae7f(_0x5a7993);assert['ok'](_0x426860),assert[_0x19b2b7(0x162)](_0x19b2b7(0x1bf),_0x426860[_0x19b2b7(0x14f)]),assert['equal'](_0x4f1edf['nhhqP'],_0x426860[_0x4f1edf['qsReI']]),assert[_0x19b2b7(0x162)](_0x4f1edf[_0x19b2b7(0x1be)],_0x426860[_0x19b2b7(0x124)]),assert[_0x19b2b7(0x162)]('foo@bar.com',_0x426860[_0x19b2b7(0x142)]),assert['equal'](_0x4f1edf['JArwI'],_0x426860[_0x4f1edf[_0x19b2b7(0x140)]]),_0x32ae7f();});}),it(_0x23031b['ZBKZg'],function(_0x5a831c){const _0x5ee1a9=_0x3fbaee,_0x28f41e=_0x5ee1a9(0x1cb),_0x1bfd0f=fs['readFileSync'](_0x23031b[_0x5ee1a9(0x19c)](__dirname,_0x5ee1a9(0x18d)))[_0x5ee1a9(0x12c)](),_0xd2f565=new SamlPassport({'cert':_0x1bfd0f,'realm':_0x23031b[_0x5ee1a9(0x133)],'checkRecipient':![],'checkExpiration':![]});_0xd2f565[_0x5ee1a9(0x1c2)](_0x28f41e,function(_0x5c9d73,_0x565ba0){const _0x2e4cad=_0x5ee1a9;assert[_0x2e4cad(0x162)](_0x5c9d73['message'],_0x2e4cad(0x188)),_0x5a831c();});}),it(_0x23031b[_0x3fbaee(0x196)],function(_0x14147e){const _0x3bc20d=_0x3fbaee,_0x24ee58={'lwcVY':_0x23031b[_0x3bc20d(0x141)]},_0x269dcd=_0x23031b[_0x3bc20d(0x15a)],_0x26e567=fs[_0x3bc20d(0x1bd)](_0x23031b[_0x3bc20d(0x195)](__dirname,_0x23031b[_0x3bc20d(0x1c7)]))[_0x3bc20d(0x12c)](),_0xbc9fbf=new SamlPassport({'cert':_0x26e567,'realm':_0x3bc20d(0x17c),'checkRecipient':![],'checkExpiration':![]});_0xbc9fbf['validateSamlAssertion'](_0x269dcd,function(_0x316f01,_0x10bf66){const _0xcc7db3=_0x3bc20d;assert[_0xcc7db3(0x162)](_0x316f01[_0xcc7db3(0x158)],_0x24ee58[_0xcc7db3(0x1bc)]),_0x14147e();});}),it(_0x23031b[_0x3fbaee(0x154)],function(_0x4b791b){const _0x229271=_0x3fbaee,_0xd25946={'JEBgj':function(_0x3f2fc8,_0x37c357){return _0x3f2fc8(_0x37c357);},'AQoRm':function(_0x18aaae,_0xf1202b){return _0x18aaae(_0xf1202b);},'PAjfA':function(_0x2da1a2,_0x3cfb22){return _0x2da1a2(_0x3cfb22);},'iYtyp':_0x23031b[_0x229271(0x1a5)],'PKDmN':function(_0x37667b,_0x304514){const _0x4eedfa=_0x229271;return _0x23031b[_0x4eedfa(0x174)](_0x37667b,_0x304514);},'gDuZP':_0x229271(0x1b0),'VGBat':function(_0xc9bc58){return _0xc9bc58();},'crXei':function(_0x471311){return _0x23031b['ZvHKK'](_0x471311);}};if(_0x23031b[_0x229271(0x1b9)](_0x229271(0x193),_0x229271(0x16c))){_0x166789['attributes']={'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/groups':[_0x23031b[_0x229271(0x1ab)],_0x229271(0x161)]};const _0x24d9ab=saml20[_0x229271(0x152)](_0x166789),_0x434c79=fs[_0x229271(0x1bd)](_0x23031b[_0x229271(0x19c)](__dirname,_0x23031b[_0x229271(0x1c7)]))[_0x229271(0x12c)](),_0x2a0323=new SamlPassport({'cert':_0x434c79,'realm':_0x229271(0x17c),'checkRecipient':![]});_0x2a0323[_0x229271(0x1c2)](_0x24d9ab,function(_0x503542,_0x2d3641){const _0x36cf53=_0x229271;if(_0x503542)return _0xd25946['JEBgj'](_0x4b791b,_0x503542);_0xd25946[_0x36cf53(0x137)](expect,_0x2d3641)['to'][_0x36cf53(0x15b)],_0xd25946[_0x36cf53(0x199)](expect,_0x2d3641[_0xd25946[_0x36cf53(0x19b)]])['to']['be']['an'](_0x36cf53(0x16a)),_0xd25946[_0x36cf53(0x16f)](expect,_0x2d3641[_0xd25946[_0x36cf53(0x19b)]])['to'][_0x36cf53(0x164)](_0xd25946['gDuZP']),expect(_0x2d3641[_0xd25946[_0x36cf53(0x19b)]])['to'][_0x36cf53(0x164)](_0x36cf53(0x161)),_0xd25946['VGBat'](_0x4b791b);});}else{const _0xaee06f=_0x23031b[_0x229271(0x16e)],_0x4186a3=_0x598367['readFileSync'](_0x23031b[_0x229271(0x12e)](_0x439900,_0x229271(0x18d)))[_0x229271(0x12c)](),_0x5821b2=new _0x155562({'cert':_0x4186a3,'realm':'urn:myapp','checkRecipient':![],'checkExpiration':![]});_0x5821b2[_0x229271(0x1c2)](_0xaee06f,function(_0x2aef57,_0x2e3de0){const _0x32049d=_0x229271;_0x57477c[_0x32049d(0x162)](_0x2aef57['message'],'NameQualifier\x20attribute\x20in\x20the\x20NameID\x20element\x20does\x20not\x20match\x20urn:issuer'),_0xd25946['crXei'](_0x180ee4);});}}),it('should\x20validate\x20expiration\x20with\x20default\x20clockSkew',function(_0x302d24){const _0x543588=_0x3fbaee,_0x251dc8={'LwlGv':_0x23031b[_0x543588(0x1cc)],'XrFTD':_0x543588(0x14d),'tEmsu':function(_0x547810,_0x410e08){const _0x34106b=_0x543588;return _0x23031b[_0x34106b(0x1b4)](_0x547810,_0x410e08);},'VMGqJ':_0x23031b[_0x543588(0x133)]};if(_0x23031b[_0x543588(0x1ba)](_0x543588(0x177),_0x23031b[_0x543588(0x15c)])){_0x166789[_0x543588(0x1c9)]=-0xf0;const _0x3de11f=saml20['create'](_0x166789),_0x49b343=fs['readFileSync'](_0x23031b[_0x543588(0x1d0)](__dirname,'/test-auth0.cer'))[_0x543588(0x12c)](),_0x208d88=new SamlPassport({'cert':_0x49b343,'realm':_0x23031b[_0x543588(0x133)],'checkRecipient':![]});_0x208d88[_0x543588(0x1c2)](_0x3de11f,function(_0x5a429b,_0x161945){const _0x4bb391=_0x543588;expect(_0x5a429b)['to'][_0x4bb391(0x15b)],expect(_0x5a429b[_0x4bb391(0x158)])['to']['equal'](_0x251dc8[_0x4bb391(0x185)]),expect(_0x161945)['to'][_0x4bb391(0x1aa)]['exist'],_0x302d24();});}else{const _0x498c5d={'cjxgr':_0x251dc8[_0x543588(0x160)]},_0x2b76a0='<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>',_0x50e60e=_0x395431[_0x543588(0x1bd)](_0x251dc8[_0x543588(0x128)](_0x243399,_0x543588(0x18d)))['toString'](),_0xae055c=new _0x3d3703({'cert':_0x50e60e,'realm':_0x251dc8['VMGqJ'],'checkRecipient':![]});_0xae055c[_0x543588(0x1c2)](_0x2b76a0,function(_0x4322e3,_0x110b51){const _0x136032=_0x543588;_0x23f321['ok'](_0x4322e3),_0x364e5b['ok'](!_0x110b51),_0x39b372[_0x136032(0x162)](_0x4322e3[_0x136032(0x158)],_0x498c5d[_0x136032(0x194)]),_0xb99ff7();});}}),_0x23031b['WHmVX'](it,_0x3fbaee(0x1ac),function(_0x2f50da){const _0x3179bb=_0x3fbaee;_0x166789[_0x3179bb(0x1c9)]=-0xf0;const _0x5abc9b=saml20[_0x3179bb(0x152)](_0x166789),_0x481bfe=fs[_0x3179bb(0x1bd)](__dirname+_0x23031b[_0x3179bb(0x1c7)])[_0x3179bb(0x12c)](),_0x3004e1=new SamlPassport({'cert':_0x481bfe,'realm':_0x23031b[_0x3179bb(0x133)],'checkRecipient':![],'clockSkew':0x5});_0x3004e1[_0x3179bb(0x1c2)](_0x5abc9b,function(_0x48da2c,_0x5f0bf5){const _0x347cb4=_0x3179bb;_0x23031b[_0x347cb4(0x174)](expect,_0x48da2c)['to'][_0x347cb4(0x1aa)][_0x347cb4(0x15b)],expect(_0x5f0bf5)['to']['exist'],_0x2f50da();});}),it('should\x20should\x20allow\x20expired\x20cert\x20if\x20option\x20not\x20passed',function(_0x14e51e){const _0x1e450d=_0x3fbaee,_0x73a797={'kppgT':_0x1e450d(0x1bf),'mvRAK':_0x23031b['cbxQe'],'OnFOM':_0x23031b[_0x1e450d(0x169)],'OOmCj':_0x23031b[_0x1e450d(0x1a1)],'LWVvb':_0x23031b[_0x1e450d(0x153)],'tHObk':_0x23031b['UESko'],'nTBTp':_0x1e450d(0x143),'lbtSU':function(_0x3d3014){return _0x3d3014();},'KlTNO':function(_0x345177,_0xae7144){return _0x345177===_0xae7144;},'eecoP':_0x1e450d(0x14b),'GaXgM':function(_0x3ff639,_0x5c2497){return _0x23031b['jpbHP'](_0x3ff639,_0x5c2497);}};_0x166789['lifetimeInSeconds']=0x2710;const _0x243930=saml20[_0x1e450d(0x152)](_0x166789),_0x502351=fs[_0x1e450d(0x1bd)](_0x23031b[_0x1e450d(0x19e)](__dirname,_0x23031b[_0x1e450d(0x1c7)]))[_0x1e450d(0x12c)](),_0x26f332=new SamlPassport({'cert':_0x502351,'realm':_0x23031b['SJwUO'],'checkRecipient':![]});_0x26f332[_0x1e450d(0x1c2)](_0x243930,function(_0xf453bb,_0x546c4d){const _0x6896be=_0x1e450d;if(_0x73a797[_0x6896be(0x123)](_0x73a797['eecoP'],_0x73a797['eecoP']))expect(_0xf453bb)['to'][_0x6896be(0x1aa)][_0x6896be(0x15b)],_0x73a797[_0x6896be(0x15f)](expect,_0x546c4d)['to'][_0x6896be(0x15b)],_0x73a797[_0x6896be(0x1c0)](_0x14e51e);else{if(_0x50041e)return _0x49921e(_0x4f5376);_0x565824['ok'](_0x766445),_0x1b3444['equal'](_0x73a797[_0x6896be(0x198)],_0x403db4[_0x6896be(0x14f)]),_0x36bb5a[_0x6896be(0x162)](_0x73a797[_0x6896be(0x172)],_0x3cdb28[_0x73a797[_0x6896be(0x1b5)]]),_0x57b50f[_0x6896be(0x162)](_0x73a797[_0x6896be(0x184)],_0xf0fd3e[_0x73a797[_0x6896be(0x1c3)]]),_0x3dce38[_0x6896be(0x162)](_0x73a797[_0x6896be(0x184)],_0x53caa8[_0x6896be(0x142)]),_0x4719a3[_0x6896be(0x162)](_0x73a797[_0x6896be(0x173)],_0x390b47[_0x73a797[_0x6896be(0x1a6)]]),_0x73a797[_0x6896be(0x1c0)](_0x1fb4d0);}});}),_0x23031b[_0x3fbaee(0x16d)](it,_0x23031b[_0x3fbaee(0x179)],function(_0x1acd32){const _0x1bafb5=_0x3fbaee,_0x26a72e=saml20[_0x1bafb5(0x152)](_0x166789),_0x4381cf=fs[_0x1bafb5(0x1bd)](__dirname+_0x1bafb5(0x18d))['toString'](),_0xa3b181=new SamlPassport({'cert':_0x4381cf,'realm':_0x1bafb5(0x17c),'checkRecipient':![],'checkCertExpiration':!![]});_0xa3b181[_0x1bafb5(0x1c2)](_0x26a72e,function(_0x67d20f,_0x165e09){const _0x1d4c90=_0x1bafb5;expect(_0x67d20f)['to'][_0x1d4c90(0x15b)],expect(_0x67d20f[_0x1d4c90(0x158)])['to']['equal'](_0x1d4c90(0x11d)),expect(_0x165e09)['to']['be'][_0x1d4c90(0x1ad)],_0x1acd32();});}),_0x23031b[_0x3fbaee(0x1cf)](it,_0x23031b[_0x3fbaee(0x1c4)],function(_0x18ef67){const _0x35efd2=_0x3fbaee,_0x1e11aa=saml20['create'](_0x166789),_0x3fa8df=fs[_0x35efd2(0x1bd)](__dirname+_0x35efd2(0x18d))[_0x35efd2(0x12c)](),_0x5b3657=new SamlPassport({'cert':_0x3fa8df,'realm':'urn:myapp','checkRecipient':![],'checkCertExpiration':!![]}),_0x30f0b5=utils[_0x35efd2(0x1af)](_0x1e11aa);assert['equal'](_0x30f0b5['getElementsByTagName'](_0x23031b['WbjVb'])[_0x35efd2(0x130)],0x1);const _0x2ab035=_0x30f0b5[_0x35efd2(0x126)](_0x23031b[_0x35efd2(0x13a)])[0x0];_0x2ab035['parentNode']['removeChild'](_0x2ab035),assert[_0x35efd2(0x162)](_0x30f0b5[_0x35efd2(0x126)](_0x23031b[_0x35efd2(0x13a)])[_0x35efd2(0x130)],0x0),_0x5b3657[_0x35efd2(0x1c2)](_0x30f0b5,function(_0x26a0e5,_0x258217){const _0x47c970=_0x35efd2,_0x1873d9={'FyjtK':_0x23031b[_0x47c970(0x1d1)],'BKGNM':'Foo\x20Bar','YEWRP':_0x47c970(0x192),'ZSNHs':function(_0x3e0aae,_0x8e005d){return _0x23031b['cqNtC'](_0x3e0aae,_0x8e005d);},'wyREL':_0x23031b[_0x47c970(0x1c7)]};if(_0x23031b['niQdW'](_0x47c970(0x146),_0x47c970(0x146)))_0x23031b[_0x47c970(0x136)](expect,_0x26a0e5)['to'][_0x47c970(0x15b)],expect(_0x26a0e5['message'])['to'][_0x47c970(0x162)](_0x23031b[_0x47c970(0x17f)]),_0x23031b[_0x47c970(0x136)](expect,_0x258217)['to'][_0x47c970(0x1aa)][_0x47c970(0x15b)],_0x23031b['teueu'](_0x18ef67);else{const _0x25a511={'qSsVr':function(_0x3bb85a,_0x21de63){return _0x3bb85a(_0x21de63);},'DFhIy':_0x1873d9[_0x47c970(0x18a)],'UBSdm':_0x1873d9[_0x47c970(0x147)],'hcBWd':'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name','cwZHT':_0x47c970(0x132),'kvwHf':'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress','NnBoq':_0x1873d9[_0x47c970(0x19d)]},_0x13d88b=_0x3c3f8f[_0x47c970(0x152)](_0x41dcc9),_0x590ddf=_0x111b0a[_0x47c970(0x1bd)](_0x1873d9[_0x47c970(0x14a)](_0xe04a93,_0x1873d9['wyREL']))[_0x47c970(0x12c)](),_0x4b3138=new _0x459d0b({'cert':_0x590ddf,'realm':_0x47c970(0x17c),'checkRecipient':![]});_0x4b3138['validateSamlAssertion'](_0x13d88b,function(_0x64f3f7,_0x432355){const _0x27c03c=_0x47c970;if(_0x64f3f7)return _0x25a511['qSsVr'](_0xc1fc04,_0x64f3f7);_0x30195c['ok'](_0x432355),_0x26a8e5[_0x27c03c(0x162)](_0x27c03c(0x1bf),_0x432355[_0x25a511[_0x27c03c(0x181)]]),_0x1e1a31['equal'](_0x25a511[_0x27c03c(0x11f)],_0x432355[_0x25a511[_0x27c03c(0x120)]]),_0x50c024[_0x27c03c(0x162)](_0x25a511['cwZHT'],_0x432355[_0x25a511[_0x27c03c(0x151)]]),_0x3ad6db[_0x27c03c(0x162)](_0x25a511[_0x27c03c(0x12d)],_0x432355[_0x27c03c(0x142)]),_0x1733b4['equal'](_0x25a511[_0x27c03c(0x18e)],_0x432355[_0x27c03c(0x143)]),_0x1147e1();});}});}),it(_0x3fbaee(0x165),function(_0x5afacd){const _0x578435=_0x3fbaee,_0xf7259e={'WQMfm':_0x578435(0x12a),'YcfZC':function(_0x5b2aa7,_0xb1dd52){const _0x4a700e=_0x578435;return _0x23031b[_0x4a700e(0x174)](_0x5b2aa7,_0xb1dd52);}};_0x166789[_0x578435(0x1c9)]=0x258,_0x166789[_0x578435(0x11c)]=_0x23031b[_0x578435(0x17a)];const _0x294183=saml20[_0x578435(0x152)](_0x166789),_0x26539a=fs['readFileSync'](_0x23031b['yOMhH'](__dirname,_0x578435(0x18d)))[_0x578435(0x12c)](),_0x1fdfa2=new SamlPassport({'cert':_0x26539a,'realm':_0x23031b[_0x578435(0x133)],'recipientUrl':_0x23031b['rvcmQ']});_0x1fdfa2[_0x578435(0x1c2)](_0x294183,function(_0x396f90,_0x1f28f9){const _0x1b2b7e=_0x578435;expect(_0x396f90)['to']['exist'],expect(_0x396f90[_0x1b2b7e(0x158)])['to'][_0x1b2b7e(0x162)](_0xf7259e['WQMfm']),_0xf7259e[_0x1b2b7e(0x14c)](expect,_0x1f28f9)['to'][_0x1b2b7e(0x1aa)][_0x1b2b7e(0x15b)],_0x5afacd();});}),it(_0x3fbaee(0x127),function(_0x4142ce){const _0x5afc84=_0x3fbaee,_0x408c92={'cert':fs['readFileSync'](_0x23031b[_0x5afc84(0x186)](__dirname,_0x23031b[_0x5afc84(0x150)])),'key':fs[_0x5afc84(0x1bd)](_0x23031b['zQimW'](__dirname,_0x5afc84(0x18b))),'issuer':_0x5afc84(0x192),'lifetimeInSeconds':0x258,'audiences':_0x23031b[_0x5afc84(0x133)],'attributes':{'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress':_0x23031b['PfQNE'],'http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name':_0x5afc84(0x19a)},'nameIdentifier':_0x23031b['mHVFY'],'nameIdentifierFormat':_0x23031b[_0x5afc84(0x167)]},_0x48302d=saml20['create'](_0x408c92),_0x109913=fs[_0x5afc84(0x1bd)](__dirname+_0x5afc84(0x18d))['toString'](),_0x1a555b=new SamlPassport({'cert':_0x109913,'realm':_0x5afc84(0x17c),'checkRecipient':![]});_0x1a555b[_0x5afc84(0x1c2)](_0x48302d,function(_0x5084c5,_0x321ecd){const _0x1f8144=_0x5afc84;if(_0x5084c5)return _0x23031b['hwTHI'](_0x4142ce,_0x5084c5);assert['ok'](_0x321ecd),assert[_0x1f8144(0x162)](_0x23031b[_0x1f8144(0x1c1)],_0x321ecd[_0x1f8144(0x1a3)]),_0x4142ce();});}),_0x23031b[_0x3fbaee(0x16d)](it,_0x23031b[_0x3fbaee(0x12f)],function(_0x41b622){const _0x46b5d0=_0x3fbaee,_0x22874e={'UnXpv':function(_0xc77d7c,_0x18ecd3){return _0xc77d7c!==_0x18ecd3;},'dXQxf':'BkFxm','aHsZS':function(_0x30ac4c,_0x11b48e){return _0x30ac4c(_0x11b48e);},'WSfZf':_0x23031b[_0x46b5d0(0x156)],'CdJfa':_0x23031b['DZcsB'],'JFyRT':_0x46b5d0(0x11e),'UaCdz':_0x23031b[_0x46b5d0(0x145)]},_0x365e62=fs[_0x46b5d0(0x1bd)](__dirname+_0x23031b[_0x46b5d0(0x138)])[_0x46b5d0(0x12c)](),_0xabced3={'checkDestination':![],'thumbprint':_0x46b5d0(0x1ca)},_0x72f37=new SamlPassport(_0xabced3);_0x72f37[_0x46b5d0(0x1c2)](_0x365e62,function(_0x26ef11,_0x5a8374){const _0x53937b=_0x46b5d0;if(_0x22874e[_0x53937b(0x149)]('BkFxm',_0x22874e[_0x53937b(0x168)]))_0x23234e(_0x2fdfbe)['to']['exist'],_0x2684e0(_0x45e9ec[_0x53937b(0x158)])['to']['equal'](_0x53937b(0x11d)),_0x53168c(_0x559e7d)['to']['be'][_0x53937b(0x1ad)],_0x35a3d8();else{_0x22874e['aHsZS'](expect,_0x26ef11)['to'][_0x53937b(0x15b)];const _0x12283f=[_0x22874e[_0x53937b(0x144)],_0x22874e['CdJfa'],_0x53937b(0x16b),_0x22874e[_0x53937b(0x129)]];assert['ok'](_0x26ef11,_0x53937b(0x1a0)),assert['ok'](_0x12283f[_0x53937b(0x1c8)](_0x26ef11[_0x53937b(0x158)]),_0x22874e[_0x53937b(0x191)]),_0x41b622();}});}),describe(_0x23031b['ngmAO'],function(){const _0x935219=_0x3fbaee,_0x4f14c9={'qJbeT':_0x23031b[_0x935219(0x190)]};it(_0x23031b[_0x935219(0x178)],function(_0x2f2b2c){const _0x4d9258=_0x935219,_0x48883f=_0x23031b[_0x4d9258(0x159)],_0x251cb5=fs[_0x4d9258(0x1bd)](_0x23031b['zQimW'](__dirname,_0x4d9258(0x18d)))[_0x4d9258(0x12c)](),_0x497eac=new SamlPassport({'cert':_0x251cb5,'realm':_0x23031b[_0x4d9258(0x133)],'checkRecipient':![]});_0x497eac[_0x4d9258(0x1c2)](_0x48883f,function(_0x799525,_0x14870c){const _0xe0122c=_0x4d9258;assert['ok'](_0x799525),assert['ok'](!_0x14870c),assert['equal'](_0x799525[_0xe0122c(0x158)],_0x4f14c9[_0xe0122c(0x180)]),_0x2f2b2c();});}),it('should\x20fail\x20when\x20signature\x20is\x20found\x20twice',function(_0x1b0633){const _0x5a0377=_0x935219,_0x5e4f61=_0x5a0377(0x18f),_0x577ecd=fs['readFileSync'](__dirname+_0x23031b[_0x5a0377(0x1c7)])[_0x5a0377(0x12c)](),_0x3df71f=new SamlPassport({'cert':_0x577ecd,'realm':_0x5a0377(0x17c),'checkRecipient':![]});_0x3df71f[_0x5a0377(0x1c2)](_0x5e4f61,function(_0x509710,_0xde983a){const _0x4c92d3=_0x5a0377;assert['ok'](_0x509710),assert['ok'](!_0xde983a),assert[_0x4c92d3(0x162)](_0x509710[_0x4c92d3(0x158)],'Signature\x20was\x20found\x20more\x20than\x20one\x20time\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])'),_0x1b0633();});});});});function _0x262d(){const _0x5ec467=['fRYxu','niQdW','22352BWtyfk','lwcVY','readFileSync','VQZji','foo','lbtSU','rjpdF','validateSamlAssertion','LWVvb','Thlfj','9cIBNTh','RXhrU','pJMNJ','includes','lifetimeInSeconds','119B9E027959CDB7C662CFD075D9E2EF384E445F','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_dZZwXmRpwYcaIdFA5l0qSCCuu0if9UNo\x22\x20IssueInstant=\x222016-09-29T12:34:13.488Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_dZZwXmRpwYcaIdFA5l0qSCCuu0if9UNo\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>ndqj65JwACeDERG2aZF6k0IF85KshkhgILzxhbKRyiw=</DigestValue></Reference></SignedInfo><SignatureValue>LPcIU9W9HmX1QM+baMPLTj9StBFRksnDoFn/HVd8uLJgdH8Xeiv9TOQGElmSaBLypjCeN6ILq6pcZ0mxMC9zfd9X3WKmYtcrGI1BugATeNsqUm63x+Msau8pNuZrNNbfIQvLooMhF4T92ym2ADSm+zCQVNwBH7/v0rVIE6MEy8AYqqfpvH9CR88XQYMCSgKN0JQ2FPbcHvhIX7Hl+xG6PSzgfznE8dcWBUi24FajyGpqlNm8O3uHCfjR3wzO42UQIJFOJOiLb7QGNyWE1KXKYWyzZgAxGQuRUcbYxcnKTbVK3b3TBH+p2ZR+a2ktKmvqNBvQxy6tE4UXDIIpvmknSw==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20NameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:44:13.488Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:34:13.488Z\x22\x20NotOnOrAfter=\x222016-09-29T12:44:13.488Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:34:13.488Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','soopB','TgjJM','DRSyL','WHmVX','cqNtC','lJwgI','recipient','The\x20signing\x20certificate\x20is\x20not\x20currently\x20valid.','The\x20signing\x20certificate\x20is\x20invalid\x20(error:0688010A:asn1\x20encoding\x20routines::nested\x20asn1\x20error,\x20error:06800066:asn1\x20encoding\x20routines::bad\x20object\x20header)','UBSdm','hcBWd','yuPzO','should\x20validate\x20the\x20SPNameQualifier\x20when\x20the\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:2.0:nameid-format:transient\x22','KlTNO','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress','10RgcTIX','getElementsByTagName','should\x20extract\x20authentication\x20context\x20from\x20assertion\x20as\x20a\x20user\x20prop','tEmsu','JFyRT','Recipient\x20is\x20invalid.\x20Configured:\x20bar','UESko','toString','cwZHT','yOMhH','wiMDO','length','assert','foo@bar.com','SJwUO','ozICf','937432weqRIL','tLkwW','AQoRm','RhvaI','Saml20','WbjVb','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/groups','3905286vYLyQK','DQYej','hjceQ','647692ZEOoCl','IYeRO','BrKxh','email','issuer','WSfZf','WjyDP','jJAyb','BKGNM','Error\x20message\x20for\x20invalid\x20certificate\x20is\x20incorrect','UnXpv','ZSNHs','baLTO','YcfZC','Signature\x20is\x20missing\x20(xpath:\x20/*[local-name(.)=\x27Assertion\x27]/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27])','66qlAbLH','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier','KMtUK','kvwHf','create','pBzUL','Smxmc','Foo\x20Bar','lcnjY','DFJij','message','tQGkf','QSfqG','exist','qQemy','xQsrx','8508csCEvs','GaXgM','XrFTD','Contributors','equal','split','include','should\x20validate\x20recipent','5057770vQiEqi','XlfeE','dXQxf','vkvoi','array','The\x20signing\x20certificate\x20is\x20invalid\x20(error:0D07803A:asn1\x20encoding\x20routines:asn1_item_embed_d2i:nested\x20asn1\x20error,\x20error:0D068066:asn1\x20encoding\x20routines:asn1_check_tlen:bad\x20object\x20header)','fjhfe','sDxAz','cJRBQ','PKDmN','2500986SgeVmF','/test-auth0.pem','mvRAK','tHObk','hwTHI','bar','znCSX','NADDQ','trRzs','tlFOY','yBiPV','validate\x20saml\x20assertion\x20(signature\x20checks)','urn:myapp','urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified','8tOLVsa','fZrcn','qJbeT','DFhIy','The\x20signing\x20certificate\x20is\x20invalid\x20(PEM_read_bio_PUBKEY\x20failed)','should\x20parse\x20attributes','OOmCj','LwlGv','QuWAs','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement></saml:Assertion>','NameQualifier\x20attribute\x20in\x20the\x20NameID\x20element\x20does\x20not\x20match\x20urn:issuer','saml','FyjtK','/test-auth0.key','chai','/test-auth0.cer','NnBoq','<saml:Assertion\x20xmlns:saml=\x22urn:oasis:names:tc:SAML:2.0:assertion\x22\x20Version=\x222.0\x22\x20ID=\x22_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22\x20IssueInstant=\x222016-09-29T12:35:22.345Z\x22><saml:Issuer>urn:issuer</saml:Issuer><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature><saml:Subject><saml:NameID\x20Format=\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22\x20SPNameQualifier=\x22invalid-value\x22>foo</saml:NameID><saml:SubjectConfirmation\x20Method=\x22urn:oasis:names:tc:SAML:2.0:cm:bearer\x22><saml:SubjectConfirmationData\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22/></saml:SubjectConfirmation></saml:Subject><saml:Conditions\x20NotBefore=\x222016-09-29T12:35:22.345Z\x22\x20NotOnOrAfter=\x222016-09-29T12:45:22.345Z\x22><saml:AudienceRestriction><saml:Audience>urn:myapp</saml:Audience></saml:AudienceRestriction></saml:Conditions><saml:AttributeStatement\x20xmlns:xs=\x22http://www.w3.org/2001/XMLSchema\x22\x20xmlns:xsi=\x22http://www.w3.org/2001/XMLSchema-instance\x22><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>foo@bar.com</saml:AttributeValue></saml:Attribute><saml:Attribute\x20Name=\x22http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name\x22><saml:AttributeValue\x20xsi:type=\x22xs:anyType\x22>Foo\x20Bar</saml:AttributeValue></saml:Attribute></saml:AttributeStatement><saml:AuthnStatement\x20AuthnInstant=\x222016-09-29T12:35:22.345Z\x22><saml:AuthnContext><saml:AuthnContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:unspecified</saml:AuthnContextClassRef></saml:AuthnContext></saml:AuthnStatement><Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22><SignedInfo><CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/><SignatureMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\x22/><Reference\x20URI=\x22#_muhd3ZBmN9LK3Ev08rkc8CA40YvNOkGl\x22><Transforms><Transform\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#enveloped-signature\x22/><Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/></Transforms><DigestMethod\x20Algorithm=\x22http://www.w3.org/2001/04/xmlenc#sha256\x22/><DigestValue>Gsh2DubHXYDeuHyBa+DU1k5G43UjyQsyPRYVgEqpTD8=</DigestValue></Reference></SignedInfo><SignatureValue>mubsqLCaM16gT2rAFLl8XDuLWTALH6cdRMM/kNHLpVzO5PA6FGVPX5ojW2UCKGOhGHn0Hd/mYCOCtgAROphWjxpQl5TDyeQE0frjKs8ik0V/Jjy5T6PeWKHLqN6sHbP6YpkGixshCWtop8JOs6SijM9PBGnWal6Nx5bUMBfAyUnGyIhLwNaE8Z4NHkyAqmdxgLS0e8w5qngKQaUlyERZCrqKQ4w8VaHFG4Dos36XVfh+U7udo3IlbrpBLsu9xG1Azxe2iPC6+84xC09P6EvQylvTnz5NU4jhk10SmmRjZ6AVvzJTz/gbVfRfZoEAUhCuIIh3HuRwf400ESf38ouZTA==</SignatureValue><KeyInfo><X509Data><X509Certificate>MIIEDzCCAvegAwIBAgIJALr9HwgrQ7GeMA0GCSqGSIb3DQEBBQUAMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDAeFw0xMjEyMjkxNTMwNDdaFw0xMzAxMjgxNTMwNDdaMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMZiVmNHiXLldrgbS50ONNOH7pJ2zg6OcSMkYZGDZJbOZ/TqwauC6JOnI7+xtkPJsQHZSFJs4U0srjZKzDCmaz2jLAJDShP2jaXlrki16nDLPE//IGAg3BJguSmBCWpDbSm92V9hSsE+Mhx6bDaJiw8yQ+Q8iSm0aTQZtp6O4ICMu00ESdh9NJqIECELvP31ADV1Xhj7IbyyVPDFxMv3ol5BySE9wwwOFUq/wv7Xz9LRiUjUzPO+Lq3OM3o/uCDbk7jD7XrGUuOydALD8ULsXp4EuDO+nFbeXB/iKndZynuVKokirywl2nD2IP0/yncdLQZ8ByIyqP3G82fq/l8p7AsCAwEAAaOBxzCBxDAdBgNVHQ4EFgQUHI2rUXeBjTv1zAllaPGrHFcEK0YwgZQGA1UdIwSBjDCBiYAUHI2rUXeBjTv1zAllaPGrHFcEK0ahZqRkMGIxGDAWBgNVBAMTD2F1dGgwLmF1dGgwLmNvbTESMBAGA1UEChMJQXV0aDAgTExDMQswCQYDVQQGEwJVUzETMBEGA1UECBMKV2FzaGluZ3RvbjEQMA4GA1UEBxMHUmVkbW9uZIIJALr9HwgrQ7GeMAwGA1UdEwQFMAMBAf8wDQYJKoZIhvcNAQEFBQADggEBAFrXIhCy4T4eGrikb0R2wHv/uS548r3pZyBV0CDbcRwAtbnpJMvkGFqKVp4pmyoIDSVNK/j+sLEshB20XftezHZyRJbCUbtKvXQ6FsxoeZMlN0ITYKTaoBZKhUxxj90otAhNC58qwGUPqt2LewJhHyLucKkGJ1mQ3b5xKZ532ToufouH9VLhig3H1KnxWo/zMD6Ke8cCk6qO9htuhI06s3GQGS1QWQtAmm17C6TfKgDwQFZwhqHUUZnwKRH8gU6OgZsvhgV1B7H5mjZcu57KMiDBekU9MEY0DCVTN3WkmcTII668zLsJrkNX6PEfck1AMBbVE6pEUKcWwq3uaLvlAUo=</X509Certificate></X509Data></KeyInfo></Signature></saml:Assertion>','JTIUJ','UaCdz','urn:issuer','jJqUI','cjxgr','Vaqfu','wlLFC','0|5|7|4|6|1|3|2','kppgT','PAjfA','сообщить\x20вКонтакте','iYtyp','mtIzX','YEWRP','bjQAZ','вКонтакте','The\x20signing\x20certificate\x20was\x20unexpectedly\x20valid','ppWVg','urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified','http://schemas.microsoft.com/ws/2008/06/identity/claims/authenticationmethod','should\x20fail\x20when\x20the\x20X509Certificate\x20is\x20invalid','mnsvh','nTBTp','assertion\x20has\x20expired.','SPNameQualifier\x20attribute\x20in\x20the\x20NameID\x20element\x20does\x20not\x20match\x20urn:myapp','11694BELfMK','not','QlzLO','should\x20validate\x20expiration\x20with\x20overriden\x20clockSkew','undefined','/samples/plain/samlresponse_saml20_invalid_cert.txt','parseSamlAssertion','Admins','should\x20validate\x20the\x20NameQualifier\x20when\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:2.0:nameid-format:persistent\x22','The\x20signing\x20certificate\x20is\x20invalid\x20(error:0906700D:PEM\x20routines:PEM_ASN1_read_bio:ASN1\x20lib,\x20error:0D07803A:asn1\x20encoding\x20routines:ASN1_ITEM_EX_D2I:nested\x20asn1\x20error,\x20error:0D068066:asn1\x20encoding\x20routines:ASN1_CHECK_TLEN:bad\x20object\x20header)','should\x20validate\x20certificate\x20expiration\x20with\x20embedded\x20cert','bdSFH','OnFOM','zQimW','should\x20ignore\x20the\x20SPNameQualifier\x20validation\x20when\x20the\x20nameid\x20format\x20is\x20\x22urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified\x22','http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name'];_0x262d=function(){return _0x5ec467;};return _0x262d();}