'use strict';var _0x5c4f92=_0x34c9;(function(_0x597a9b,_0x5503a8){var _0x444360=_0x34c9,_0x144984=_0x597a9b();while(!![]){try{var _0x343a69=-parseInt(_0x444360(0xab))/0x1*(-parseInt(_0x444360(0x9b))/0x2)+parseInt(_0x444360(0xca))/0x3*(-parseInt(_0x444360(0xc7))/0x4)+-parseInt(_0x444360(0x94))/0x5*(-parseInt(_0x444360(0xa6))/0x6)+parseInt(_0x444360(0xb4))/0x7+parseInt(_0x444360(0xb5))/0x8*(-parseInt(_0x444360(0xb8))/0x9)+parseInt(_0x444360(0xb7))/0xa+-parseInt(_0x444360(0xc2))/0xb;if(_0x343a69===_0x5503a8)break;else _0x144984['push'](_0x144984['shift']());}catch(_0x166fa4){_0x144984['push'](_0x144984['shift']());}}}(_0x31a5,0x5ca95));function _0x31a5(){var _0x300b7b=['checkServerIdentity','DNS:a.com','bar.com','DNS:*b.a.com','Host:\x20a.com.\x20is\x20not\x20cert\x27s\x20CN:\x20.a.com','4ptExFt','xn--bcher-kva.example.com','assert','tls','\x20!=\x20','Host:\x20a.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','Host:\x20b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','b.a.com','b.com','IP\x20Address:127.0.0.1','skip','52122voEblD','Host:\x20null.\x20is\x20not\x20cert\x27s\x20CN:\x20a.com','a.com','error','Host:\x20a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','25261VXcfmi','127.0.0.1','IP:\x20127.0.0.2\x20is\x20not\x20in\x20the\x20cert\x27s\x20list:\x20','*.a.com','Host:\x20localhost.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','DNS:*.com','URI:http://*.b.a.com/','DNS:A.COM','Host:\x20c.b.a.com.\x20is\x20not\x20in\x20the\x20cert\x27s\x20altnames:\x20','3656716dSNIdt','1219112tAWenI','URI:http://a.b.a.com/','1623490jzJMRh','18jIkBeH','Cert\x20is\x20empty','*n.b.com','DNS:omg.com','Host:\x20\x0a.b.com.\x20is\x20not\x20cert\x27s\x20CN:\x20*n.b.com','a.co.uk','\x20failed:\x20','Test#','*.example.com','xn--*.example.com','8071888SicWow','oWMwj','a.b.a.com','Host:\x20ba.com.\x20is\x20not\x20cert\x27s\x20CN:\x20*.a.com','inspect','4BdmJIr','DNS:*.a.com','cert','114459mLywgR','c.b.a.com','a-cb.a.com','b*b.a.com','a.com.','reason','A.COM','foo.com','415xQtEDf','IP:\x20127.0.0.1\x20is\x20not\x20in\x20the\x20cert\x27s\x20list:\x20'];_0x31a5=function(){return _0x300b7b;};return _0x31a5();}function _0x34c9(_0x584ef0,_0x443502){var _0x31a522=_0x31a5();return _0x34c9=function(_0x34c920,_0x345e2e){_0x34c920=_0x34c920-0x93;var _0x22d764=_0x31a522[_0x34c920];return _0x22d764;},_0x34c9(_0x584ef0,_0x443502);}var common=require('../common'),assert=require(_0x5c4f92(0x9d)),util=require('util');if(!common['hasCrypto']){common[_0x5c4f92(0xa5)]('missing\x20crypto');return;}var tls=require(_0x5c4f92(0x9e)),tests=[{'host':![],'cert':{'subject':{'CN':'a.com'}},'error':'Host:\x20false.\x20is\x20not\x20cert\x27s\x20CN:\x20a.com'},{'host':null,'cert':{'subject':{'CN':'a.com'}},'error':_0x5c4f92(0xa7)},{'host':undefined,'cert':{'subject':{'CN':_0x5c4f92(0xa8)}},'error':'Host:\x20undefined.\x20is\x20not\x20cert\x27s\x20CN:\x20a.com'},{'host':'a.com','cert':{'subject':{'CN':_0x5c4f92(0xa8)}}},{'host':'a.com','cert':{'subject':{'CN':_0x5c4f92(0xd0)}}},{'host':'a.com','cert':{'subject':{'CN':'b.com'}},'error':'Host:\x20a.com.\x20is\x20not\x20cert\x27s\x20CN:\x20b.com'},{'host':_0x5c4f92(0xa8),'cert':{'subject':{'CN':_0x5c4f92(0xce)}}},{'host':_0x5c4f92(0xa8),'cert':{'subject':{'CN':'.a.com'}},'error':_0x5c4f92(0x9a)},{'host':_0x5c4f92(0xa2),'cert':{'subject':{'CN':_0x5c4f92(0xae)}}},{'host':'ba.com','cert':{'subject':{'CN':_0x5c4f92(0xae)}},'error':_0x5c4f92(0xc5)},{'host':'\x0a.b.com','cert':{'subject':{'CN':_0x5c4f92(0xba)}},'error':_0x5c4f92(0xbc)},{'host':'b.a.com','cert':{'subjectaltname':_0x5c4f92(0xbb),'subject':{'CN':'*.a.com'}},'error':_0x5c4f92(0xa1)+_0x5c4f92(0xbb)},{'host':_0x5c4f92(0xa2),'cert':{'subject':{'CN':_0x5c4f92(0xcd)}},'error':'Host:\x20b.a.com.\x20is\x20not\x20cert\x27s\x20CN:\x20b*b.a.com'},{'host':_0x5c4f92(0xa8),'cert':{},'error':_0x5c4f92(0xb9)},{'host':_0x5c4f92(0x93),'cert':{'subject':{'CN':[_0x5c4f92(0x93),_0x5c4f92(0x98)]}}},{'host':'a.com','cert':{'subjectaltname':'DNS:*','subject':{'CN':'b.com'}},'error':_0x5c4f92(0xaa)+'DNS:*'},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':_0x5c4f92(0xb0),'subject':{'CN':_0x5c4f92(0xa3)}},'error':_0x5c4f92(0xaa)+_0x5c4f92(0xb0)},{'host':_0x5c4f92(0xbd),'cert':{'subjectaltname':'DNS:*.co.uk','subject':{'CN':'b.com'}}},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':'DNS:*.a.com','subject':{'CN':_0x5c4f92(0xa8)}},'error':_0x5c4f92(0xaa)+'DNS:*.a.com'},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':_0x5c4f92(0xc8),'subject':{'CN':_0x5c4f92(0xa3)}},'error':_0x5c4f92(0xaa)+_0x5c4f92(0xc8)},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':_0x5c4f92(0x97),'subject':{'CN':_0x5c4f92(0xa3)}}},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':_0x5c4f92(0xb2),'subject':{'CN':_0x5c4f92(0xa3)}}},{'host':_0x5c4f92(0xa8),'cert':{'subjectaltname':_0x5c4f92(0xc8),'subject':{}},'error':_0x5c4f92(0xaa)+_0x5c4f92(0xc8)},{'host':_0x5c4f92(0xa2),'cert':{'subjectaltname':_0x5c4f92(0xc8),'subject':{}}},{'host':_0x5c4f92(0xcb),'cert':{'subjectaltname':_0x5c4f92(0xc8),'subject':{}},'error':_0x5c4f92(0xb3)+_0x5c4f92(0xc8)},{'host':_0x5c4f92(0xa2),'cert':{'subjectaltname':_0x5c4f92(0x99),'subject':{}}},{'host':_0x5c4f92(0xcc),'cert':{'subjectaltname':'DNS:*b.a.com','subject':{}}},{'host':_0x5c4f92(0xc4),'cert':{'subjectaltname':_0x5c4f92(0x99),'subject':{}},'error':_0x5c4f92(0xa0)+_0x5c4f92(0x99)},{'host':_0x5c4f92(0xc4),'cert':{'subjectaltname':'DNS:*b.a.com,\x20DNS:a.b.a.com','subject':{}}},{'host':_0x5c4f92(0xc4),'cert':{'subjectaltname':_0x5c4f92(0xb6),'subject':{}}},{'host':'a.b.a.com','cert':{'subjectaltname':_0x5c4f92(0xb1),'subject':{}},'error':_0x5c4f92(0xa0)+'URI:http://*.b.a.com/'},{'host':_0x5c4f92(0xc4),'cert':{'subjectaltname':'IP\x20Address:127.0.0.1','subject':{}},'error':_0x5c4f92(0xa0)+'IP\x20Address:127.0.0.1'},{'host':'127.0.0.1','cert':{'subjectaltname':_0x5c4f92(0xa4),'subject':{}}},{'host':'127.0.0.2','cert':{'subjectaltname':_0x5c4f92(0xa4),'subject':{}},'error':_0x5c4f92(0xad)+_0x5c4f92(0xac)},{'host':_0x5c4f92(0xac),'cert':{'subjectaltname':_0x5c4f92(0x97),'subject':{}},'error':_0x5c4f92(0x95)},{'host':'localhost','cert':{'subjectaltname':'DNS:a.com','subject':{'CN':'localhost'}},'error':_0x5c4f92(0xaf)+'DNS:a.com'},{'host':_0x5c4f92(0x9c),'cert':{'subject':{'CN':_0x5c4f92(0xc0)}}},{'host':_0x5c4f92(0x9c),'cert':{'subject':{'CN':_0x5c4f92(0xc1)}},'error':'Host:\x20xn--bcher-kva.example.com.\x20is\x20not\x20cert\x27s\x20CN:\x20'+'xn--*.example.com'}];tests['forEach'](function(_0x5de6c8,_0x140823){var _0x2fc315=_0x5c4f92,_0x2761c1={'oWMwj':function(_0x40f40d,_0x4481d4){return _0x40f40d+_0x4481d4;},'sxgcx':function(_0x435b0c,_0x13e870){return _0x435b0c+_0x13e870;}},_0x4236ad=tls[_0x2fc315(0x96)](_0x5de6c8['host'],_0x5de6c8[_0x2fc315(0xc9)]);assert['equal'](_0x4236ad&&_0x4236ad[_0x2fc315(0xcf)],_0x5de6c8[_0x2fc315(0xa9)],_0x2761c1[_0x2fc315(0xc3)](_0x2761c1['sxgcx'](_0x2fc315(0xbf)+_0x140823+_0x2fc315(0xbe),util[_0x2fc315(0xc6)](_0x5de6c8)),'\x0a')+_0x5de6c8[_0x2fc315(0xa9)]+_0x2fc315(0x9f)+(_0x4236ad&&_0x4236ad[_0x2fc315(0xcf)]));});