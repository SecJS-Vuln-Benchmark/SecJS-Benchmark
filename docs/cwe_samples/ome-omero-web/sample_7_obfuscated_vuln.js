const _0xeae9d3=_0x132d;function _0x132d(_0xe2b7f5,_0x297a8){const _0x4101d0=_0x4101();return _0x132d=function(_0x132d33,_0x1f79b1){_0x132d33=_0x132d33-0x161;let _0xf048f8=_0x4101d0[_0x132d33];return _0xf048f8;},_0x132d(_0xe2b7f5,_0x297a8);}(function(_0x4102f1,_0xe88498){const _0x2facd5=_0x132d,_0x1f238b=_0x4102f1();while(!![]){try{const _0x1daeb4=parseInt(_0x2facd5(0x189))/0x1+-parseInt(_0x2facd5(0x191))/0x2+parseInt(_0x2facd5(0x18a))/0x3+-parseInt(_0x2facd5(0x163))/0x4+-parseInt(_0x2facd5(0x1a0))/0x5*(-parseInt(_0x2facd5(0x17c))/0x6)+-parseInt(_0x2facd5(0x177))/0x7*(parseInt(_0x2facd5(0x17f))/0x8)+parseInt(_0x2facd5(0x161))/0x9;if(_0x1daeb4===_0xe88498)break;else _0x1f238b['push'](_0x1f238b['shift']());}catch(_0x225e96){_0x1f238b['push'](_0x1f238b['shift']());}}}(_0x4101,0x74fe6));function _0x4101(){const _0x238172=['Document\x20tests','./test/static/feide_public.pem','112234wXPYLC','285969MZkUvB','GaTBg','true','Validated\x20node\x20references\x20tests','test\x20with\x20a\x20document\x20(using\x20FileKeyInfo)','equal','jASfJ','951024GFjrEu','vxLro','PIzQb','test\x20with\x20a\x20document\x20(using\x20StringKeyInfo)','loadSignature','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','henri.bergius@nemein.com','PGYxG','YyyFM','ivGjr','null','parseFromString','DOMParser','false','readFileSync','16005rqOSpf','should\x20return\x20references\x20if\x20the\x20document\x20is\x20validly\x20signed','toString','KSLBb','should\x20not\x20return\x20references\x20if\x20the\x20document\x20is\x20not\x20validly\x20signed','PGfZU','11136420jgHDWP','./test/static/invalid_signature\x20-\x20changed\x20content.xml','256372HXCncQ','//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','lurVC','/non-existent-node','RePJg','ZDvhg','rFbbB','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20validly\x20signed','cKFGJ','SwXMx','BlKum','getCertFromKeyInfo','getValidatedNode','findSignatures','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20found','checkSignature','iMEIm','utf-8','./test/static/valid_saml.xml','PmfAZ','96285Nycadt','should\x20return\x20the\x20selected\x20node\x20if\x20it\x20is\x20validly\x20signed','mAJiE','dahWs','PqqKx','774RAWmdJ','getReferences','select1','488LIhZCF','uIzLt','dNrpG','DPZgc','assertIsNodeLike','feTcX','publicCert','ZOsQs'];_0x4101=function(){return _0x238172;};return _0x4101();}import{SignedXml}from'../src/index';import*as _0x33c3e4 from'xpath';import*as _0xe8a96b from'@xmldom/xmldom';import*as _0x4ac7b5 from'fs';import{expect}from'chai';import*as _0x43968c from'@xmldom/is-dom-node';describe(_0xeae9d3(0x187),function(){const _0x25aa2b=_0xeae9d3,_0x38f0ac={'BlKum':_0x25aa2b(0x175),'PIzQb':_0x25aa2b(0x174),'ZiYQc':_0x25aa2b(0x18e),'tkvtZ':_0x25aa2b(0x194),'mAJiE':'ChPrq','RePJg':function(_0x129486,_0xe3d495,_0x1a9b05){return _0x129486(_0xe3d495,_0x1a9b05);}};_0x38f0ac[_0x25aa2b(0x167)](it,'test\x20with\x20a\x20document\x20(using\x20FileKeyInfo)',function(){const _0x3987fc=_0x25aa2b,_0x4ad455=_0x4ac7b5['readFileSync'](_0x38f0ac[_0x3987fc(0x16d)],_0x38f0ac['PIzQb']),_0x20a73c=new _0xe8a96b[(_0x3987fc(0x19d))]()[_0x3987fc(0x19c)](_0x4ad455),_0x330dd1=_0x33c3e4[_0x3987fc(0x17e)](_0x3987fc(0x196),_0x20a73c);_0x43968c[_0x3987fc(0x183)](_0x330dd1);const _0x469dcd=new SignedXml();_0x469dcd['publicCert']=_0x4ac7b5['readFileSync'](_0x3987fc(0x188)),_0x469dcd[_0x3987fc(0x195)](_0x330dd1);const _0x219640=_0x469dcd[_0x3987fc(0x172)](_0x4ad455);expect(_0x219640)['to']['be']['true'];}),it('test\x20with\x20a\x20document\x20(using\x20StringKeyInfo)',function(){const _0x329ac0=_0x25aa2b;if(_0x38f0ac['mAJiE']===_0x38f0ac[_0x329ac0(0x179)]){const _0x2e4a59=_0x4ac7b5['readFileSync'](_0x329ac0(0x175),_0x38f0ac[_0x329ac0(0x193)]),_0x11cd54=new _0xe8a96b[(_0x329ac0(0x19d))]()[_0x329ac0(0x19c)](_0x2e4a59),_0x37a6c2=_0x33c3e4[_0x329ac0(0x17e)]('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x11cd54);_0x43968c[_0x329ac0(0x183)](_0x37a6c2);const _0x230bac=new SignedXml(),_0x58cc9d=_0x4ac7b5[_0x329ac0(0x19f)]('./test/static/feide_public.pem');_0x230bac[_0x329ac0(0x185)]=_0x58cc9d,_0x230bac[_0x329ac0(0x195)](_0x37a6c2);const _0x47fe61=_0x230bac[_0x329ac0(0x172)](_0x2e4a59);expect(_0x47fe61)['to']['be']['true'];}else{const _0x11f1fe={'SwXMx':'./test/static/valid_saml.xml','YyyFM':function(_0x51d013,_0x6728da){return _0x51d013(_0x6728da);},'feTcX':_0x329ac0(0x174)};_0x46d25e(_0x38f0ac['ZiYQc'],function(){const _0x3096c5=_0x329ac0,_0x31e462=_0x34aa17[_0x3096c5(0x19f)](_0x11f1fe[_0x3096c5(0x16c)],_0x3096c5(0x174)),_0x283c04=new _0x3f7c16[(_0x3096c5(0x19d))]()[_0x3096c5(0x19c)](_0x31e462),_0x1b3fbf=_0xe8b22d[_0x3096c5(0x17e)](_0x3096c5(0x196),_0x283c04);_0x3f319b['assertIsNodeLike'](_0x1b3fbf);const _0x28791a=new _0x74265();_0x28791a[_0x3096c5(0x185)]=_0x5d98b7[_0x3096c5(0x19f)]('./test/static/feide_public.pem'),_0x28791a['loadSignature'](_0x1b3fbf);const _0x57c8cb=_0x28791a[_0x3096c5(0x172)](_0x31e462);_0x11f1fe[_0x3096c5(0x199)](_0x5ca0ac,_0x57c8cb)['to']['be'][_0x3096c5(0x18c)];}),_0x115297(_0x38f0ac['tkvtZ'],function(){const _0x4b3928=_0x329ac0,_0xbfc52d=_0x1cd692[_0x4b3928(0x19f)]('./test/static/valid_saml.xml',_0x11f1fe[_0x4b3928(0x184)]),_0x1bbd38=new _0x32e804[(_0x4b3928(0x19d))]()[_0x4b3928(0x19c)](_0xbfc52d),_0x3e632b=_0x444972['select1'](_0x4b3928(0x196),_0x1bbd38);_0x2828aa[_0x4b3928(0x183)](_0x3e632b);const _0x5cbb80=new _0x453982(),_0x3dad97=_0x18485b[_0x4b3928(0x19f)](_0x4b3928(0x188));_0x5cbb80[_0x4b3928(0x185)]=_0x3dad97,_0x5cbb80[_0x4b3928(0x195)](_0x3e632b);const _0x387bc8=_0x5cbb80[_0x4b3928(0x172)](_0xbfc52d);_0x5de100(_0x387bc8)['to']['be'][_0x4b3928(0x18c)];});}});}),describe(_0xeae9d3(0x18d),function(){const _0x3e0368=_0xeae9d3,_0x5ad75e={'PmfAZ':_0x3e0368(0x175),'ZOsQs':'utf-8','uIzLt':function(_0x4ecd64,_0x27452d){return _0x4ecd64(_0x27452d);},'DPZgc':_0x3e0368(0x197),'lurVC':function(_0x36558a,_0x293a0f){return _0x36558a===_0x293a0f;},'iMEIm':_0x3e0368(0x162),'TVSIQ':function(_0x4604ba,_0x3d9c68){return _0x4604ba(_0x3d9c68);},'PGfZU':function(_0x523fb1,_0x45cfc5){return _0x523fb1(_0x45cfc5);},'jASfJ':function(_0xb122a3,_0x8ee278){return _0xb122a3(_0x8ee278);},'PqqKx':_0x3e0368(0x166),'vxLro':'//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','GaTBg':function(_0x492ff8,_0x2dc485){return _0x492ff8(_0x2dc485);},'cKFGJ':function(_0x34c535,_0x3574d3){return _0x34c535!==_0x3574d3;},'ImWYR':function(_0x4afff4,_0xc1745e){return _0x4afff4(_0xc1745e);},'dNrpG':_0x3e0368(0x1a1),'pMUfC':_0x3e0368(0x1a4),'PGYxG':_0x3e0368(0x178),'eRdBe':_0x3e0368(0x16a)};it(_0x5ad75e[_0x3e0368(0x181)],function(){const _0x7ab470=_0x3e0368,_0x18ee43=_0x4ac7b5[_0x7ab470(0x19f)](_0x5ad75e[_0x7ab470(0x176)],_0x5ad75e[_0x7ab470(0x186)]),_0x277320=new _0xe8a96b[(_0x7ab470(0x19d))]()['parseFromString'](_0x18ee43),_0xc4e45f=new SignedXml();_0xc4e45f[_0x7ab470(0x16e)]=SignedXml[_0x7ab470(0x16e)],_0xc4e45f[_0x7ab470(0x195)](_0xc4e45f[_0x7ab470(0x170)](_0x277320)[0x0]);const _0x32710a=_0xc4e45f[_0x7ab470(0x172)](_0x18ee43);_0x5ad75e['uIzLt'](expect,_0x32710a)['to']['be']['true'];const _0x31e8e3=_0xc4e45f[_0x7ab470(0x17d)]()[0x0],_0x5b448c=_0x31e8e3[_0x7ab470(0x16f)]();expect(_0x5b448c?.[_0x7ab470(0x1a2)]())['to'][_0x7ab470(0x18f)](_0x277320['toString']());}),it(_0x5ad75e['pMUfC'],function(){const _0xa62477=_0x3e0368;if(_0x5ad75e[_0xa62477(0x165)](_0xa62477(0x19a),_0xa62477(0x19a))){const _0x971cc2=_0x4ac7b5[_0xa62477(0x19f)](_0x5ad75e[_0xa62477(0x173)],_0x5ad75e[_0xa62477(0x186)]),_0x27a606=new _0xe8a96b[(_0xa62477(0x19d))]()[_0xa62477(0x19c)](_0x971cc2),_0x5a5610=new SignedXml();_0x5a5610[_0xa62477(0x195)](_0x5a5610['findSignatures'](_0x27a606)[0x0]);const _0x4208b1=_0x5a5610[_0xa62477(0x172)](_0x971cc2);_0x5ad75e['TVSIQ'](expect,_0x4208b1)['to']['be'][_0xa62477(0x19e)];const _0x4227f0=_0x5a5610[_0xa62477(0x17d)]()[0x1],_0x570e7f=_0x4227f0[_0xa62477(0x16f)]();_0x5ad75e[_0xa62477(0x1a5)](expect,_0x570e7f)['to']['be'][_0xa62477(0x19b)];}else{const _0x122071=_0x28575c[_0xa62477(0x19f)](_0x5ad75e[_0xa62477(0x176)],_0x5ad75e[_0xa62477(0x186)]),_0x2045a3=new _0x59572e[(_0xa62477(0x19d))]()[_0xa62477(0x19c)](_0x122071),_0x42c03f=new _0x4e1668();_0x42c03f[_0xa62477(0x16e)]=_0x14a3e0[_0xa62477(0x16e)],_0x42c03f[_0xa62477(0x195)](_0x42c03f[_0xa62477(0x170)](_0x2045a3)[0x0]);const _0x3c5323=_0x42c03f[_0xa62477(0x172)](_0x122071);_0x5ad75e[_0xa62477(0x180)](_0x57e63a,_0x3c5323)['to']['be']['true'];const _0x17766b=_0x42c03f[_0xa62477(0x17d)]()[0x0],_0x2fcec1=_0x17766b[_0xa62477(0x16f)](_0xa62477(0x164));_0x5ad75e[_0xa62477(0x180)](_0x35ff3d,_0x2fcec1?.['nodeValue'])['to'][_0xa62477(0x18f)](_0x5ad75e[_0xa62477(0x182)]);}}),it(_0x3e0368(0x171),function(){const _0x22d83d=_0x3e0368,_0x5cd48c=_0x4ac7b5[_0x22d83d(0x19f)](_0x5ad75e[_0x22d83d(0x176)],_0x5ad75e[_0x22d83d(0x186)]),_0x1234ed=new _0xe8a96b['DOMParser']()['parseFromString'](_0x5cd48c),_0x42fec2=new SignedXml();_0x42fec2[_0x22d83d(0x16e)]=SignedXml[_0x22d83d(0x16e)],_0x42fec2[_0x22d83d(0x195)](_0x42fec2['findSignatures'](_0x1234ed)[0x0]);const _0xfa9da1=_0x42fec2[_0x22d83d(0x172)](_0x5cd48c);_0x5ad75e[_0x22d83d(0x190)](expect,_0xfa9da1)['to']['be'][_0x22d83d(0x18c)];const _0x1e854e=_0x42fec2[_0x22d83d(0x17d)]()[0x0],_0x583f1e=_0x1e854e[_0x22d83d(0x16f)](_0x5ad75e[_0x22d83d(0x17b)]);_0x5ad75e[_0x22d83d(0x180)](expect,_0x583f1e)['to']['be'][_0x22d83d(0x19b)];}),it(_0x5ad75e[_0x3e0368(0x198)],function(){const _0xf4df13=_0x3e0368,_0xb529d=_0x4ac7b5[_0xf4df13(0x19f)](_0xf4df13(0x175),_0x5ad75e[_0xf4df13(0x186)]),_0x22f139=new _0xe8a96b[(_0xf4df13(0x19d))]()[_0xf4df13(0x19c)](_0xb529d),_0xad57ed=new SignedXml();_0xad57ed[_0xf4df13(0x16e)]=SignedXml['getCertFromKeyInfo'],_0xad57ed[_0xf4df13(0x195)](_0xad57ed[_0xf4df13(0x170)](_0x22f139)[0x0]);const _0x29b280=_0xad57ed[_0xf4df13(0x172)](_0xb529d);expect(_0x29b280)['to']['be'][_0xf4df13(0x18c)];const _0x3884f9=_0xad57ed[_0xf4df13(0x17d)]()[0x0],_0x81d298=_0x3884f9['getValidatedNode'](_0x5ad75e[_0xf4df13(0x192)]);_0x5ad75e[_0xf4df13(0x18b)](expect,_0x81d298?.['nodeValue'])['to'][_0xf4df13(0x18f)](_0xf4df13(0x197));}),it(_0x5ad75e['eRdBe'],function(){const _0x39120f=_0x3e0368,_0x4d8411={'KSLBb':_0x39120f(0x162),'ZDvhg':_0x39120f(0x164),'rFbbB':function(_0x1200e2,_0x53af04){return _0x1200e2(_0x53af04);}};if(_0x5ad75e[_0x39120f(0x16b)]('dahWs',_0x39120f(0x17a))){const _0x1cd2bb=_0x93940d['readFileSync'](_0x4d8411[_0x39120f(0x1a3)],'utf-8'),_0x2e2e8f=new _0x1cd5e0[(_0x39120f(0x19d))]()[_0x39120f(0x19c)](_0x1cd2bb),_0x1814b1=new _0x414497();_0x1814b1[_0x39120f(0x195)](_0x1814b1[_0x39120f(0x170)](_0x2e2e8f)[0x0]);const _0x18be8d=_0x1814b1[_0x39120f(0x172)](_0x1cd2bb);_0x2f0063(_0x18be8d)['to']['be'][_0x39120f(0x19e)];const _0x156386=_0x1814b1[_0x39120f(0x17d)]()[0x0],_0x2a242b=_0x156386[_0x39120f(0x16f)](_0x4d8411[_0x39120f(0x168)]);_0x4d8411[_0x39120f(0x169)](_0x16bb9d,_0x2a242b)['to']['be']['null'];}else{const _0x2ba1e0=_0x4ac7b5[_0x39120f(0x19f)](_0x5ad75e[_0x39120f(0x173)],_0x5ad75e[_0x39120f(0x186)]),_0xc84030=new _0xe8a96b[(_0x39120f(0x19d))]()[_0x39120f(0x19c)](_0x2ba1e0),_0x52b060=new SignedXml();_0x52b060[_0x39120f(0x195)](_0x52b060[_0x39120f(0x170)](_0xc84030)[0x0]);const _0x4fc0f3=_0x52b060[_0x39120f(0x172)](_0x2ba1e0);expect(_0x4fc0f3)['to']['be'][_0x39120f(0x19e)];const _0xe06cde=_0x52b060['getReferences']()[0x0],_0x2a2dc9=_0xe06cde[_0x39120f(0x16f)](_0x5ad75e[_0x39120f(0x192)]);_0x5ad75e['ImWYR'](expect,_0x2a2dc9)['to']['be'][_0x39120f(0x19b)];}});});