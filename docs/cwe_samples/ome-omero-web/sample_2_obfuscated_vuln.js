function _0x529f(_0x329e74,_0x55ad1b){const _0x3d10bd=_0x3d10();return _0x529f=function(_0x529f42,_0x24bf8f){_0x529f42=_0x529f42-0x1cc;let _0x34fa47=_0x3d10bd[_0x529f42];return _0x34fa47;},_0x529f(_0x329e74,_0x55ad1b);}function _0x3d10(){const _0x7936c9=['select','crypto','enableHMAC','./test/static/hmac-foobar.key','computeSignature','PNzIE','41gdljGx','DOMParser','parseFromString','vdqTL','aQpIP','test\x20create\x20and\x20validate\x20HMAC\x20signature','123024YTcSeu','<book>','<library>','RJIzf','5610gxnqud','</library>','@xmldom/xmldom','signingCert','./test/static/hmac.key','loadSignature','signingKey','1832kNmQnI','//*[local-name(.)=\x27book\x27]','699738IFNBZZ','UyIHo','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','</book>','getSignedXml','signatureAlgorithm','checkSignature','17878DpQcBP','648152LJJNVH','utf-8','hARnk','480788JcjrXI','readFileSync','xpath','SignedXml','./test/static/hmac_signature.xml','ckToD','8710HfQlHr','27hIhWwt','3705kZmaAH','UTpjo','false','true','http://www.w3.org/2000/09/xmldsig#hmac-sha1'];_0x3d10=function(){return _0x7936c9;};return _0x3d10();}const _0x51c736=_0x529f;(function(_0x4d743c,_0x72cf8c){const _0x23cb77=_0x529f,_0x358866=_0x4d743c();while(!![]){try{const _0x454c90=parseInt(_0x23cb77(0x1cd))/0x1*(parseInt(_0x23cb77(0x1e7))/0x2)+-parseInt(_0x23cb77(0x1d3))/0x3+parseInt(_0x23cb77(0x1de))/0x4*(-parseInt(_0x23cb77(0x1f3))/0x5)+parseInt(_0x23cb77(0x1e0))/0x6+-parseInt(_0x23cb77(0x1eb))/0x7+-parseInt(_0x23cb77(0x1e8))/0x8*(parseInt(_0x23cb77(0x1f2))/0x9)+parseInt(_0x23cb77(0x1f1))/0xa*(parseInt(_0x23cb77(0x1d7))/0xb);if(_0x454c90===_0x72cf8c)break;else _0x358866['push'](_0x358866['shift']());}catch(_0x41dc40){_0x358866['push'](_0x358866['shift']());}}}(_0x3d10,0x396c5));const crypto=require('../index'),xpath=require(_0x51c736(0x1ed)),xmldom=require(_0x51c736(0x1d9)),fs=require('fs'),{sign}=require(_0x51c736(0x1f9)),expect=require('chai')['expect'];describe('HMAC\x20tests',function(){const _0x1ffa07=_0x51c736,_0x495ec3={'UyIHo':'./test/static/hmac_signature.xml','nowEg':_0x1ffa07(0x1e9),'PNzIE':function(_0x1a9a2b,_0xe44b2c){return _0x1a9a2b(_0xe44b2c);},'aQpIP':_0x1ffa07(0x1e2),'sgwWq':_0x1ffa07(0x1fb),'vdqTL':function(_0x2ce6b2,_0x3ed619){return _0x2ce6b2+_0x3ed619;},'UTpjo':_0x1ffa07(0x1d5),'iDzuR':_0x1ffa07(0x1d4),'ELaMp':_0x1ffa07(0x1e3),'RJIzf':_0x1ffa07(0x1d8),'ckToD':_0x1ffa07(0x1f7),'hARnk':function(_0x241551,_0x214117){return _0x241551(_0x214117);},'RXExM':'test\x20HMAC\x20signature\x20with\x20incorrect\x20key'};it('test\x20validating\x20HMAC\x20signature',function(){const _0x327ca5=_0x1ffa07,_0xd481a=fs['readFileSync'](_0x495ec3[_0x327ca5(0x1e1)],_0x495ec3['nowEg']),_0x2bacf2=new xmldom['DOMParser']()[_0x327ca5(0x1cf)](_0xd481a),_0x2ed005=xpath['select'](_0x327ca5(0x1e2),_0x2bacf2)[0x0],_0x1112b6=new crypto[(_0x327ca5(0x1ee))]();_0x1112b6[_0x327ca5(0x1fa)](),_0x1112b6[_0x327ca5(0x1da)]=fs[_0x327ca5(0x1ec)](_0x327ca5(0x1db)),_0x1112b6[_0x327ca5(0x1dc)](_0x2ed005);const _0x6f444e=_0x1112b6[_0x327ca5(0x1e6)](_0xd481a);_0x495ec3[_0x327ca5(0x1cc)](expect,_0x6f444e)['to']['be']['true'];}),it(_0x495ec3['RXExM'],function(){const _0x26a0a4=_0x1ffa07,_0x31ce2f=fs[_0x26a0a4(0x1ec)](_0x26a0a4(0x1ef),_0x26a0a4(0x1e9)),_0x387771=new xmldom[(_0x26a0a4(0x1ce))]()[_0x26a0a4(0x1cf)](_0x31ce2f),_0xf41687=xpath[_0x26a0a4(0x1f8)](_0x495ec3[_0x26a0a4(0x1d1)],_0x387771)[0x0],_0x1995ba=new crypto[(_0x26a0a4(0x1ee))]();_0x1995ba[_0x26a0a4(0x1fa)](),_0x1995ba['signingCert']=fs[_0x26a0a4(0x1ec)](_0x495ec3['sgwWq']),_0x1995ba[_0x26a0a4(0x1dc)](_0xf41687);const _0x16d4e1=_0x1995ba[_0x26a0a4(0x1e6)](_0x31ce2f);_0x495ec3[_0x26a0a4(0x1cc)](expect,_0x16d4e1)['to']['be'][_0x26a0a4(0x1f5)];}),it(_0x1ffa07(0x1d2),function(){const _0x4987e2=_0x1ffa07,_0xb50a81=_0x495ec3[_0x4987e2(0x1d0)](_0x495ec3[_0x4987e2(0x1f4)],_0x495ec3['iDzuR'])+'<name>Harry\x20Potter</name>'+_0x495ec3['ELaMp']+_0x495ec3[_0x4987e2(0x1d6)],_0x3d6d1d=new crypto[(_0x4987e2(0x1ee))]();_0x3d6d1d['enableHMAC'](),_0x3d6d1d[_0x4987e2(0x1dd)]=fs[_0x4987e2(0x1ec)](_0x4987e2(0x1db)),_0x3d6d1d[_0x4987e2(0x1e5)]=_0x495ec3[_0x4987e2(0x1f0)],_0x3d6d1d['addReference'](_0x4987e2(0x1df)),_0x3d6d1d[_0x4987e2(0x1fc)](_0xb50a81);const _0x46bc06=new xmldom[(_0x4987e2(0x1ce))]()['parseFromString'](_0x3d6d1d[_0x4987e2(0x1e4)]()),_0x394ecf=xpath[_0x4987e2(0x1f8)](_0x495ec3['aQpIP'],_0x46bc06)[0x0],_0x1e72c9=new crypto[(_0x4987e2(0x1ee))]();_0x1e72c9[_0x4987e2(0x1fa)](),_0x1e72c9[_0x4987e2(0x1da)]=fs[_0x4987e2(0x1ec)](_0x4987e2(0x1db)),_0x1e72c9['loadSignature'](_0x394ecf);const _0x443a6e=_0x1e72c9['checkSignature'](_0x3d6d1d[_0x4987e2(0x1e4)]());_0x495ec3[_0x4987e2(0x1ea)](expect,_0x443a6e)['to']['be'][_0x4987e2(0x1f6)];});});