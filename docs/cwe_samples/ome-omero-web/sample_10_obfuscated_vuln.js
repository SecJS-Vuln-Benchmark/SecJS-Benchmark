const _0x524e68=_0x296c;(function(_0x227da6,_0x53a411){const _0x2bba36=_0x296c,_0x3d0c9a=_0x227da6();while(!![]){try{const _0x4f77cc=-parseInt(_0x2bba36(0xca))/0x1*(-parseInt(_0x2bba36(0xb5))/0x2)+parseInt(_0x2bba36(0xb9))/0x3+parseInt(_0x2bba36(0xa5))/0x4*(-parseInt(_0x2bba36(0xeb))/0x5)+-parseInt(_0x2bba36(0xae))/0x6*(parseInt(_0x2bba36(0xc7))/0x7)+-parseInt(_0x2bba36(0xd8))/0x8+parseInt(_0x2bba36(0xe4))/0x9+-parseInt(_0x2bba36(0xe0))/0xa*(parseInt(_0x2bba36(0xa7))/0xb);if(_0x4f77cc===_0x53a411)break;else _0x3d0c9a['push'](_0x3d0c9a['shift']());}catch(_0xd3b763){_0x3d0c9a['push'](_0x3d0c9a['shift']());}}}(_0x3819,0x3c5ae));import{SignedXml}from'../src/index';import*as _0x2251de from'xpath';import*as _0x4faec8 from'@xmldom/xmldom';import*as _0x465d6f from'fs';function _0x3819(){const _0x50783a=['//*[local-name(.)=\x27Assertion\x27][1]','DOMParser','giqei','GpasP','338460MvlEdD','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','./test/static/valid_saml_withcomments.xml','./test/static/feide_public.pem','4420836TNJRpR','throws\x20an\x20error\x20for\x20a\x20document\x20with\x20no\x20`SignedInfo`\x20node','vKlPj','utf-8','PBken','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','30lgrFVY','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','test\x20validating\x20wrapped\x20assertion\x20signature','./test/static/saml_multiple_signed_info_nodes.xml','throw','lISgT','digestValue','87320cFpAeZ','could\x20not\x20load\x20signature\x20that\x20contains\x20multiple\x20SignedInfo\x20nodes','99taNFsL','checkSignature','eWPjI','equal','readFileSync','lAtub','fFWDV','1854AUOOOC','./test/static/valid_saml_signature_wrapping.xml','./test/static/id_with_quotes.xml','assertIsNodeLike','signature\x20wrapping\x20attack.','btRBy','test\x20signature\x20throws\x20if\x20multiple\x20`SignedInfo`\x20nodes\x20are\x20found','801634rgRQZr','WDGTW','parseFromString','./test/static/saml_external_ns.xml','569106UZIYET','SAML\x20response\x20tests','osbbP','test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element','getReferences','length','PIqos','vUYVk','loads\x20digest\x20value\x20from\x20text\x20content\x20instead\x20of\x20comment','wLmSw','id\x20should\x20not\x20contain\x20quotes','./test/static/valid_saml.xml','xtIrj','TXcdw','7042uekpdQ','select1','HASNN','1HoKhIu','PgNaF','//*[local-name(.)=\x27Assertion\x27]','HkOFy','publicCert','true','lqgVn','GKFDr','./test/static/saml_external_ns.pem','false','./test/static/valid_saml_with_digest_comment.xml','test\x20validation\x20ignores\x20an\x20additional\x20wrapped\x20`SignedInfo`\x20node','RFGMy','for\x20a\x20SAML\x20response\x20with\x20a\x20digest\x20value\x20comment','704488dMQuPD','same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20','loadSignature','PcGuZ'];_0x3819=function(){return _0x50783a;};return _0x3819();}import{expect}from'chai';function _0x296c(_0x16fe5b,_0x3c3e38){const _0x3819d9=_0x3819();return _0x296c=function(_0x296cb7,_0x5d85e2){_0x296cb7=_0x296cb7-0x9f;let _0x103a86=_0x3819d9[_0x296cb7];return _0x103a86;},_0x296c(_0x16fe5b,_0x3c3e38);}import*as _0x206062 from'@xmldom/is-dom-node';describe(_0x524e68(0xba),function(){const _0x593923=_0x524e68,_0x222421={'TXcdw':'utf-8','fFWDV':_0x593923(0x9f),'osbbP':_0x593923(0xaf),'GpasP':'//*[local-name(.)=\x27Assertion\x27]','wLmSw':_0x593923(0xe9),'xtIrj':'./test/static/feide_public.pem','IMePG':function(_0x596695,_0x5e5fda,_0x5a3342){return _0x596695(_0x5e5fda,_0x5a3342);},'PgNaF':function(_0x1a11cd,_0x5bce9f){return _0x1a11cd+_0x5bce9f;},'GKFDr':_0x593923(0xb2),'sDLsi':_0x593923(0xb0),'lqgVn':_0x593923(0xe2),'giqei':function(_0x32b0bb,_0x25f5d1){return _0x32b0bb(_0x25f5d1);},'PcGuZ':'./test/static/invalid_saml_no_signed_info.xml','HYFvR':_0x593923(0xd2),'yMHRd':_0x593923(0xdc),'vUYVk':'RnNjoyUguwze5w2R+cboyTHlkQk=','PBken':function(_0x2733b7,_0x63edab,_0x1d1f4){return _0x2733b7(_0x63edab,_0x1d1f4);},'jOyGN':'test\x20validating\x20SAML\x20response','owfKO':_0x593923(0xa0),'lISgT':function(_0x1ea0d9,_0x2f3c30,_0x3cc995){return _0x1ea0d9(_0x2f3c30,_0x3cc995);},'eWPjI':_0x593923(0xea),'HkOFy':'test\x20validating\x20SAML\x20response\x20WithComments','HASNN':_0x593923(0xe5),'DlqOY':function(_0x1768d1,_0x3d578a,_0x5c1901){return _0x1768d1(_0x3d578a,_0x5c1901);},'RFGMy':function(_0x5de694,_0x504ad3,_0x3afbce){return _0x5de694(_0x504ad3,_0x3afbce);},'btRBy':_0x593923(0xd7)};it(_0x222421['jOyGN'],function(){const _0x41efce=_0x593923,_0x4dae85=_0x465d6f['readFileSync'](_0x41efce(0xc4),_0x222421['TXcdw']),_0x7fcc47=new _0x4faec8[(_0x41efce(0xdd))]()[_0x41efce(0xb7)](_0x4dae85),_0x10bcdd=_0x2251de[_0x41efce(0xc8)](_0x222421[_0x41efce(0xad)],_0x7fcc47);_0x206062[_0x41efce(0xb1)](_0x10bcdd);const _0x1ab788=new SignedXml();_0x1ab788['publicCert']=_0x465d6f['readFileSync']('./test/static/feide_public.pem'),_0x1ab788[_0x41efce(0xda)](_0x10bcdd);const _0x125b44=_0x1ab788[_0x41efce(0xa8)](_0x4dae85);expect(_0x125b44)['to']['be'][_0x41efce(0xcf)];}),it(_0x222421['owfKO'],function(){const _0x4d6df1=_0x593923,_0x97a6b7=_0x465d6f[_0x4d6df1(0xab)](_0x222421[_0x4d6df1(0xbb)],_0x4d6df1(0xe7)),_0x205b0a=new _0x4faec8[(_0x4d6df1(0xdd))]()[_0x4d6df1(0xb7)](_0x97a6b7),_0x560434=_0x2251de[_0x4d6df1(0xc8)](_0x222421[_0x4d6df1(0xdf)],_0x205b0a);_0x206062[_0x4d6df1(0xb1)](_0x560434);const _0x1199ec=_0x2251de['select1'](_0x222421[_0x4d6df1(0xc2)],_0x560434);_0x206062[_0x4d6df1(0xb1)](_0x1199ec);const _0x5dfa29=new SignedXml();_0x5dfa29[_0x4d6df1(0xce)]=_0x465d6f[_0x4d6df1(0xab)](_0x222421[_0x4d6df1(0xc5)]),_0x5dfa29[_0x4d6df1(0xda)](_0x1199ec),_0x222421['IMePG'](expect,function(){_0x5dfa29['checkSignature'](_0x97a6b7);},_0x222421[_0x4d6df1(0xcb)](_0x222421['PgNaF']('Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20',_0x4d6df1(0xd9)),_0x222421[_0x4d6df1(0xd1)]))['to'][_0x4d6df1(0xa2)]();}),_0x222421[_0x593923(0xa3)](it,_0x593923(0xbc),function(){const _0x283904=_0x593923,_0x2db464=_0x465d6f[_0x283904(0xab)](_0x283904(0xb8),_0x222421[_0x283904(0xc6)]),_0x100a89=new _0x4faec8[(_0x283904(0xdd))]()[_0x283904(0xb7)](_0x2db464),_0xb089b8=_0x2251de[_0x283904(0xc8)](_0x283904(0xe1),_0x100a89);_0x206062[_0x283904(0xb1)](_0xb089b8);const _0x88331=new SignedXml();_0x88331[_0x283904(0xce)]=_0x465d6f['readFileSync'](_0x283904(0xd2)),_0x88331[_0x283904(0xda)](_0xb089b8);const _0x4420b1=_0x88331['checkSignature'](_0x2db464);expect(_0x4420b1)['to']['be'][_0x283904(0xcf)];}),it(_0x222421[_0x593923(0xa9)],function(){const _0x35a020=_0x593923,_0x2e6ece=_0x465d6f[_0x35a020(0xab)](_0x222421['sDLsi'],_0x35a020(0xe7)),_0xb2bad2=new _0x4faec8[(_0x35a020(0xdd))]()['parseFromString'](_0x2e6ece),_0x1ec85c=_0x2251de[_0x35a020(0xc8)](_0x35a020(0xcc),_0xb2bad2);_0x206062[_0x35a020(0xb1)](_0x1ec85c);const _0x25ca44=_0x2251de[_0x35a020(0xc8)](_0x222421[_0x35a020(0xc2)],_0x1ec85c);_0x206062[_0x35a020(0xb1)](_0x25ca44);const _0xdc2c62=new SignedXml();_0xdc2c62[_0x35a020(0xce)]=_0x465d6f[_0x35a020(0xab)](_0x35a020(0xe3)),_0xdc2c62['loadSignature'](_0x25ca44),expect(function(){const _0x36fbc3=_0x35a020;_0xdc2c62[_0x36fbc3(0xa8)](_0x2e6ece);},_0x35a020(0xc3))['to'][_0x35a020(0xa2)]();}),it(_0x222421[_0x593923(0xcd)],function(){const _0x43e53d=_0x593923,_0xf23743=_0x465d6f[_0x43e53d(0xab)](_0x222421[_0x43e53d(0xd0)],_0x43e53d(0xe7)),_0x2d6881=new _0x4faec8[(_0x43e53d(0xdd))]()[_0x43e53d(0xb7)](_0xf23743),_0x60adb5=_0x2251de['select1'](_0x222421[_0x43e53d(0xad)],_0x2d6881);_0x206062[_0x43e53d(0xb1)](_0x60adb5);const _0x5e87cb=new SignedXml();_0x5e87cb['publicCert']=_0x465d6f[_0x43e53d(0xab)](_0x222421[_0x43e53d(0xc5)]),_0x5e87cb[_0x43e53d(0xda)](_0x60adb5),_0x222421[_0x43e53d(0xde)](expect,()=>_0x5e87cb[_0x43e53d(0xa8)](_0xf23743))['to'][_0x43e53d(0xa2)](/^invalid signature/);}),it(_0x222421[_0x593923(0xc9)],function(){const _0x2df428=_0x593923,_0x185894=_0x465d6f[_0x2df428(0xab)](_0x222421[_0x2df428(0xdb)],_0x222421[_0x2df428(0xc6)]),_0x40a70e=new _0x4faec8[(_0x2df428(0xdd))]()['parseFromString'](_0x185894),_0x598fc4=_0x2251de[_0x2df428(0xc8)](_0x222421[_0x2df428(0xad)],_0x40a70e);_0x206062[_0x2df428(0xb1)](_0x598fc4);const _0xbfd1f0=new SignedXml(),_0x5212e3=_0x465d6f[_0x2df428(0xab)](_0x222421[_0x2df428(0xc5)]);_0xbfd1f0['publicCert']=_0x5212e3,expect(()=>_0xbfd1f0[_0x2df428(0xda)](_0x598fc4))['to'][_0x2df428(0xa2)]('no\x20signed\x20info\x20node\x20found');}),_0x222421['DlqOY'](it,_0x593923(0xd5),function(){const _0x277d04=_0x593923,_0x2c6c62=_0x465d6f['readFileSync']('./test/static/saml_wrapped_signed_info_node.xml',_0x222421[_0x277d04(0xc6)]),_0x328e3d=new _0x4faec8[(_0x277d04(0xdd))]()[_0x277d04(0xb7)](_0x2c6c62),_0x90e59a=_0x2251de[_0x277d04(0xc8)]('//*[local-name(.)=\x27Assertion\x27]',_0x328e3d);_0x206062[_0x277d04(0xb1)](_0x90e59a);const _0x1ef07a=_0x2251de['select1'](_0x222421[_0x277d04(0xc2)],_0x90e59a);_0x206062['assertIsNodeLike'](_0x1ef07a);const _0x26d8b8=new SignedXml();_0x26d8b8[_0x277d04(0xce)]=_0x465d6f['readFileSync'](_0x222421['HYFvR']),_0x26d8b8[_0x277d04(0xda)](_0x1ef07a),expect(_0x26d8b8[_0x277d04(0xbd)]()[_0x277d04(0xbe)])['to'][_0x277d04(0xaa)](0x1);const _0x2141f5=_0x26d8b8[_0x277d04(0xa8)](_0x2c6c62);_0x222421[_0x277d04(0xde)](expect,_0x2141f5)['to']['be']['true'];}),_0x222421[_0x593923(0xd6)](it,_0x593923(0xb4),function(){const _0x2001af=_0x593923,_0x3f5eda=_0x465d6f['readFileSync'](_0x2001af(0xa1),_0x222421[_0x2001af(0xc6)]),_0x4838bd=new _0x4faec8[(_0x2001af(0xdd))]()[_0x2001af(0xb7)](_0x3f5eda),_0x758a74=_0x2251de[_0x2001af(0xc8)](_0x222421['yMHRd'],_0x4838bd);_0x206062['assertIsNodeLike'](_0x758a74);const _0x46927f=_0x2251de[_0x2001af(0xc8)](_0x2001af(0xe9),_0x758a74);_0x206062[_0x2001af(0xb1)](_0x46927f);const _0x2bb9fd=new SignedXml();_0x2bb9fd['publicCert']=_0x465d6f[_0x2001af(0xab)](_0x2001af(0xd2)),_0x222421['giqei'](expect,()=>_0x2bb9fd['loadSignature'](_0x46927f))['to'][_0x2001af(0xa2)](_0x2001af(0xa6));}),describe(_0x222421[_0x593923(0xb3)],()=>{const _0x69aab1=_0x593923,_0x24e1f7={'luXaD':_0x69aab1(0xe7),'vKlPj':_0x69aab1(0xe9),'PIqos':'./test/static/feide_public.pem','WDGTW':function(_0x1731cc,_0x117b70){return _0x1731cc(_0x117b70);},'lAtub':_0x222421[_0x69aab1(0xc0)]};_0x222421[_0x69aab1(0xe8)](it,_0x69aab1(0xc1),function(){const _0x3f0056=_0x69aab1,_0x3b578a=_0x465d6f['readFileSync'](_0x3f0056(0xd4),_0x24e1f7['luXaD']),_0x360c7e=new _0x4faec8[(_0x3f0056(0xdd))]()['parseFromString'](_0x3b578a),_0x4857fb=_0x2251de[_0x3f0056(0xc8)](_0x3f0056(0xcc),_0x360c7e);_0x206062[_0x3f0056(0xb1)](_0x4857fb);const _0x348a6e=_0x2251de['select1'](_0x24e1f7[_0x3f0056(0xe6)],_0x4857fb);_0x206062[_0x3f0056(0xb1)](_0x348a6e);const _0x276b5b=new SignedXml();_0x276b5b[_0x3f0056(0xce)]=_0x465d6f[_0x3f0056(0xab)](_0x24e1f7[_0x3f0056(0xbf)]),_0x276b5b[_0x3f0056(0xda)](_0x348a6e),_0x24e1f7[_0x3f0056(0xb6)](expect,_0x276b5b['getReferences']()[0x0][_0x3f0056(0xa4)])['to']['equal'](_0x24e1f7[_0x3f0056(0xac)]),_0x24e1f7[_0x3f0056(0xb6)](expect,_0x276b5b['checkSignature'](_0x3b578a))['to']['be'][_0x3f0056(0xd3)];});});});