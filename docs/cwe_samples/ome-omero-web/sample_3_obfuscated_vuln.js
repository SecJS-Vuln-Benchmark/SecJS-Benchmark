var _0x3a7896=_0xafd8;function _0x1281(){var _0x82ff68=['JYwVj','./test/static/saml_external_ns.pem','883194wIzAiy','tVNeJ','test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element','test\x20validating\x20SAML\x20response\x20with\x20digest\x20comment','./test/static/valid_saml_with_digest_comment.xml','4555688ZfgLNT','loadSignature','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','references','qWjrA','5689435aqvNHg','digestValue','wmhsr','sMMwU','done','BlOPy','./test/static/feide_public.pem','test\x20validating\x20SAML\x20response\x20WithComments','xpath','JlmNv','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','1104461wMNODr','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','KAmvX','sxpNd','throws','nwTxL','VAbVJ','test\x20validating\x20wrapped\x20assertion\x20signature','//*[local-name(.)=\x27Assertion\x27]','0|2|7|5|1|6|3|4|8','tWcIi','checkSignature','DOMParser','keyInfoProvider','./test/static/id_with_quotes.xml','PczbT','./test/static/saml_wrapped_signed_info_node.xml','qUnAY','select','FileKeyInfo','QEwVZ','select1','utf-8','5119112Gbecql','no\x20signed\x20info\x20node\x20found','hZLNg','signature\x20wrapping\x20attack.','split','./test/static/invalid_saml_no_signed_info.xml','1526112SlYrRf','./test/static/saml_external_ns.xml','equal','KJJFV','21Crpgsk','xqOiU','qkPnV','./test/static/valid_saml_signature_wrapping.xml','./test/static/valid_saml.xml','test\x20signature\x20does\x20not\x20contain\x20multiple\x20`SignedInfo`\x20nodes','igRHd','aXXgU','xYdmD','2517846fKDcJx','test\x20signature\x20contains\x20a\x20`SignedInfo`\x20node','could\x20not\x20load\x20signature\x20that\x20contains\x20multiple\x20SignedInfo\x20nodes','Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20','test\x20validating\x20SAML\x20response','readFileSync','parseFromString','SignedXml','mIrKK','brvwW','@xmldom/xmldom','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','aPWnb'];_0x1281=function(){return _0x82ff68;};return _0x1281();}(function(_0x291687,_0x29b54e){var _0x3fce2e=_0xafd8,_0x59f9a9=_0x291687();while(!![]){try{var _0xe8e920=-parseInt(_0x3fce2e(0x1c2))/0x1+parseInt(_0x3fce2e(0x1df))/0x2+-parseInt(_0x3fce2e(0x19e))/0x3+-parseInt(_0x3fce2e(0x1b2))/0x4+parseInt(_0x3fce2e(0x1b7))/0x5+parseInt(_0x3fce2e(0x1ad))/0x6+-parseInt(_0x3fce2e(0x195))/0x7*(-parseInt(_0x3fce2e(0x1d9))/0x8);if(_0xe8e920===_0x29b54e)break;else _0x59f9a9['push'](_0x59f9a9['shift']());}catch(_0x3f23c1){_0x59f9a9['push'](_0x59f9a9['shift']());}}}(_0x1281,0xd8198));function _0xafd8(_0x13c9bc,_0xad1cc8){var _0x1281ab=_0x1281();return _0xafd8=function(_0xafd832,_0x5d4046){_0xafd832=_0xafd832-0x193;var _0x46be7a=_0x1281ab[_0xafd832];return _0x46be7a;},_0xafd8(_0x13c9bc,_0xad1cc8);}var crypto=require('../index'),xpath=require(_0x3a7896(0x1bf)),xmldom=require(_0x3a7896(0x1a8)),fs=require('fs');exports[_0x3a7896(0x1a2)]=function(_0x5861e0){var _0x34b7f1=_0x3a7896,_0x3d8677={'nwTxL':_0x34b7f1(0x199),'tVNeJ':'utf-8','QEwVZ':'./test/static/feide_public.pem'},_0x222cb9='1|0|8|7|6|3|2|4|5'[_0x34b7f1(0x1dd)]('|'),_0x258f37=0x0;while(!![]){switch(_0x222cb9[_0x258f37++]){case'0':var _0x2b51dc=new xmldom[(_0x34b7f1(0x1ce))]()[_0x34b7f1(0x1a4)](_0xfd3759);continue;case'1':var _0xfd3759=fs['readFileSync'](_0x3d8677[_0x34b7f1(0x1c7)],_0x3d8677[_0x34b7f1(0x1ae)]);continue;case'2':var _0x18a6b1=_0x12ec29['checkSignature'](_0xfd3759);continue;case'3':_0x12ec29[_0x34b7f1(0x1b3)](_0x4d443c);continue;case'4':_0x5861e0[_0x34b7f1(0x193)](_0x18a6b1,!![]);continue;case'5':_0x5861e0[_0x34b7f1(0x1bb)]();continue;case'6':_0x12ec29['keyInfoProvider']=new crypto[(_0x34b7f1(0x1d5))](_0x3d8677[_0x34b7f1(0x1d6)]);continue;case'7':var _0x12ec29=new crypto['SignedXml']();continue;case'8':var _0x4d443c=xpath['select']('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x2b51dc)[0x0];continue;}break;}},exports[_0x3a7896(0x1c9)]=function(_0x95580f){var _0xd9d970=_0x3a7896,_0x213660={'okkso':_0xd9d970(0x1bd),'sMMwU':_0xd9d970(0x1c1),'tWcIi':function(_0x486c5a,_0x3533a2){return _0x486c5a+_0x3533a2;},'xCBPa':function(_0x20f3f9,_0x38dbec){return _0x20f3f9+_0x38dbec;},'sxpNd':'same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20'},_0x5018c8='6|5|2|4|1|3|7|8|0'[_0xd9d970(0x1dd)]('|'),_0x458e93=0x0;while(!![]){switch(_0x5018c8[_0x458e93++]){case'0':_0x95580f[_0xd9d970(0x1bb)]();continue;case'1':var _0x5e7e53=new crypto[(_0xd9d970(0x1a5))]();continue;case'2':var _0x52ceaf=xpath[_0xd9d970(0x1d4)]('//*[local-name(.)=\x27Assertion\x27]',_0x2efcab)[0x0];continue;case'3':_0x5e7e53[_0xd9d970(0x1cf)]=new crypto[(_0xd9d970(0x1d5))](_0x213660['okkso']);continue;case'4':var _0x325dd9=xpath['select'](_0x213660[_0xd9d970(0x1ba)],_0x52ceaf)[0x0];continue;case'5':var _0x2efcab=new xmldom[(_0xd9d970(0x1ce))]()['parseFromString'](_0x58c064);continue;case'6':var _0x58c064=fs[_0xd9d970(0x1a3)](_0xd9d970(0x198),_0xd9d970(0x1d8));continue;case'7':_0x5e7e53[_0xd9d970(0x1b3)](_0x325dd9);continue;case'8':_0x95580f[_0xd9d970(0x1c6)](function(){var _0x303c78=_0xd9d970;_0x5e7e53[_0x303c78(0x1cd)](_0x58c064);},Error,_0x213660[_0xd9d970(0x1cc)](_0x213660['xCBPa'](_0xd9d970(0x1a1),_0x213660[_0xd9d970(0x1c5)]),_0xd9d970(0x1dc)));continue;}break;}},exports[_0x3a7896(0x1af)]=function(_0x1e53c1){var _0x2737c9=_0x3a7896,_0x4619d4={'KJJFV':_0x2737c9(0x1e0),'PczbT':_0x2737c9(0x1c3)},_0x3eabfa=fs[_0x2737c9(0x1a3)](_0x4619d4[_0x2737c9(0x194)],'utf-8'),_0x1e318f=new xmldom[(_0x2737c9(0x1ce))]()[_0x2737c9(0x1a4)](_0x3eabfa),_0x9ef769=xpath[_0x2737c9(0x1d4)](_0x4619d4[_0x2737c9(0x1d1)],_0x1e318f)[0x0],_0x3631c5=new crypto[(_0x2737c9(0x1a5))]();_0x3631c5['keyInfoProvider']=new crypto[(_0x2737c9(0x1d5))](_0x2737c9(0x1ac)),_0x3631c5['loadSignature'](_0x9ef769);var _0xd1fab5=_0x3631c5[_0x2737c9(0x1cd)](_0x3eabfa);_0x1e53c1['equal'](_0xd1fab5,!![]),_0x1e53c1[_0x2737c9(0x1bb)]();},exports[_0x3a7896(0x1b4)]=function(_0x4414a5){var _0x735f7c=_0x3a7896,_0xa3d27e={'JYwVj':'./test/static/valid_saml_withcomments.xml','wmhsr':_0x735f7c(0x1d8),'brvwW':_0x735f7c(0x1bd),'qkPnV':_0x735f7c(0x19d),'qUnAY':_0x735f7c(0x1c1),'JlmNv':'id\x20should\x20not\x20contain\x20quotes'},_0x57389c=fs['readFileSync'](_0x735f7c(0x1d0),_0x735f7c(0x1d8)),_0x96f344=new xmldom['DOMParser']()[_0x735f7c(0x1a4)](_0x57389c),_0x36da81=xpath[_0x735f7c(0x1d4)]('//*[local-name(.)=\x27Assertion\x27]',_0x96f344)[0x0],_0x3efaaa=xpath[_0x735f7c(0x1d4)](_0xa3d27e[_0x735f7c(0x1d3)],_0x36da81)[0x0],_0x560793=new crypto['SignedXml']();_0x560793[_0x735f7c(0x1cf)]=new crypto[(_0x735f7c(0x1d5))](_0xa3d27e[_0x735f7c(0x1a7)]),_0x560793[_0x735f7c(0x1b3)](_0x3efaaa),_0x4414a5[_0x735f7c(0x1c6)](function(){var _0x40c164=_0x735f7c,_0x504a21={'aXXgU':_0xa3d27e[_0x40c164(0x1ab)],'mIrKK':_0xa3d27e[_0x40c164(0x1b9)],'KAmvX':_0xa3d27e[_0x40c164(0x1a7)]};if(_0x40c164(0x19d)!==_0xa3d27e[_0x40c164(0x197)]){var _0x3beb82=_0x40c164(0x1cb)[_0x40c164(0x1dd)]('|'),_0x5919ba=0x0;while(!![]){switch(_0x3beb82[_0x5919ba++]){case'0':var _0x43c716=_0x3fc5cc['readFileSync'](_0x504a21[_0x40c164(0x19c)],_0x504a21[_0x40c164(0x1a6)]);continue;case'1':_0x35f2bf[_0x40c164(0x1cf)]=new _0x1fb389['FileKeyInfo'](_0x504a21[_0x40c164(0x1c4)]);continue;case'2':var _0xcead37=new _0x26e35a[(_0x40c164(0x1ce))]()[_0x40c164(0x1a4)](_0x43c716);continue;case'3':var _0x174224=_0x35f2bf[_0x40c164(0x1cd)](_0x43c716);continue;case'4':_0x3ec2d7[_0x40c164(0x193)](_0x174224,![]);continue;case'5':var _0x35f2bf=new _0x182659[(_0x40c164(0x1a5))]();continue;case'6':_0x35f2bf['loadSignature'](_0x2e6434);continue;case'7':var _0x2e6434=_0x366466['select'](_0x40c164(0x1a9),_0xcead37)[0x0];continue;case'8':_0x551cbb[_0x40c164(0x1bb)]();continue;}break;}}else _0x560793['checkSignature'](_0x57389c);},Error,_0xa3d27e[_0x735f7c(0x1c0)]),_0x4414a5[_0x735f7c(0x1bb)]();},exports[_0x3a7896(0x1be)]=function(_0x264ee9){var _0x5532fb=_0x3a7896,_0x3a3215={'xqOiU':'/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]'},_0x4699f8=fs[_0x5532fb(0x1a3)]('./test/static/valid_saml_withcomments.xml',_0x5532fb(0x1d8)),_0x2f4aa5=new xmldom[(_0x5532fb(0x1ce))]()[_0x5532fb(0x1a4)](_0x4699f8),_0x5de971=xpath[_0x5532fb(0x1d4)](_0x3a3215[_0x5532fb(0x196)],_0x2f4aa5)[0x0],_0x89ff4c=new crypto['SignedXml']();_0x89ff4c['keyInfoProvider']=new crypto[(_0x5532fb(0x1d5))](_0x5532fb(0x1bd)),_0x89ff4c[_0x5532fb(0x1b3)](_0x5de971);var _0x49ea82=_0x89ff4c[_0x5532fb(0x1cd)](_0x4699f8);_0x264ee9[_0x5532fb(0x193)](_0x49ea82,![]),_0x264ee9[_0x5532fb(0x1bb)]();},exports[_0x3a7896(0x1b0)]=function(_0x513909){var _0x30ce3a=_0x3a7896,_0x3d29f5={'XDDqL':_0x30ce3a(0x1d8),'aPWnb':_0x30ce3a(0x1c1),'igRHd':_0x30ce3a(0x1bd),'qWjrA':'RnNjoyUguwze5w2R+cboyTHlkQk='},_0x3bd6a8=fs[_0x30ce3a(0x1a3)](_0x30ce3a(0x1b1),_0x3d29f5['XDDqL']),_0x55475f=new xmldom[(_0x30ce3a(0x1ce))]()[_0x30ce3a(0x1a4)](_0x3bd6a8);const _0x1990b3=xpath[_0x30ce3a(0x1d7)](_0x30ce3a(0x1ca),_0x55475f),_0x2440c7=xpath[_0x30ce3a(0x1d7)](_0x3d29f5[_0x30ce3a(0x1aa)],_0x1990b3);var _0xa2a29c=new crypto[(_0x30ce3a(0x1a5))]();_0xa2a29c[_0x30ce3a(0x1cf)]=new crypto['FileKeyInfo'](_0x3d29f5[_0x30ce3a(0x19b)]),_0xa2a29c[_0x30ce3a(0x1b3)](_0x2440c7);var _0x344eb0=_0xa2a29c[_0x30ce3a(0x1cd)](_0x3bd6a8);_0x513909[_0x30ce3a(0x193)](_0xa2a29c[_0x30ce3a(0x1b5)][0x0][_0x30ce3a(0x1b8)],_0x3d29f5[_0x30ce3a(0x1b6)]),_0x513909[_0x30ce3a(0x193)](_0x344eb0,![]),_0x513909[_0x30ce3a(0x1bb)]();},exports[_0x3a7896(0x19f)]=function(_0x35e16f){var _0xb69e75=_0x3a7896,_0x592057={'VAbVJ':_0xb69e75(0x1de),'vYIAx':'./test/static/feide_public.pem'},_0x25b9d7=fs['readFileSync'](_0x592057[_0xb69e75(0x1c8)],_0xb69e75(0x1d8)),_0x2bc58b=new xmldom[(_0xb69e75(0x1ce))]()[_0xb69e75(0x1a4)](_0x25b9d7);const _0x313bc1=xpath['select1'](_0xb69e75(0x1a9),_0x2bc58b);var _0x1594f9=new crypto['SignedXml']();_0x1594f9[_0xb69e75(0x1cf)]=new crypto['FileKeyInfo'](_0x592057['vYIAx']),_0x35e16f[_0xb69e75(0x1c6)](function(){var _0x5927eb=_0xb69e75;_0x1594f9[_0x5927eb(0x1b3)](_0x313bc1);},Error,_0xb69e75(0x1da)),_0x35e16f[_0xb69e75(0x1bb)]();},exports['test\x20validation\x20ignores\x20an\x20additional\x20wrapped\x20`SignedInfo`\x20node']=function(_0xc4a767){var _0x224d84=_0x3a7896,_0x300ce2={'BlOPy':_0x224d84(0x1c1)},_0x5a9aaa=fs[_0x224d84(0x1a3)](_0x224d84(0x1d2),_0x224d84(0x1d8)),_0x56e765=new xmldom['DOMParser']()['parseFromString'](_0x5a9aaa),_0x263b12=xpath[_0x224d84(0x1d4)](_0x224d84(0x1ca),_0x56e765)[0x0],_0x20e947=xpath['select'](_0x300ce2[_0x224d84(0x1bc)],_0x263b12)[0x0],_0x48f091=new crypto[(_0x224d84(0x1a5))]();_0x48f091[_0x224d84(0x1cf)]=new crypto[(_0x224d84(0x1d5))](_0x224d84(0x1ac)),_0x48f091[_0x224d84(0x1b3)](_0x20e947),_0xc4a767[_0x224d84(0x193)](_0x48f091['references']['length'],0x1);var _0x130501=_0x48f091['checkSignature'](_0x5a9aaa);_0xc4a767[_0x224d84(0x193)](_0x130501,!![]),_0xc4a767[_0x224d84(0x1bb)]();},exports[_0x3a7896(0x19a)]=function(_0x35caf1){var _0x39f9fd=_0x3a7896,_0x15c85c={'hZLNg':'./test/static/saml_multiple_signed_info_nodes.xml','fxjhy':_0x39f9fd(0x1d8),'hzzFa':'./test/static/saml_external_ns.pem'},_0x35cf27=fs['readFileSync'](_0x15c85c[_0x39f9fd(0x1db)],_0x15c85c['fxjhy']),_0x1c1430=new xmldom[(_0x39f9fd(0x1ce))]()[_0x39f9fd(0x1a4)](_0x35cf27),_0x24160a=xpath[_0x39f9fd(0x1d4)](_0x39f9fd(0x1ca),_0x1c1430)[0x0],_0x27577d=xpath[_0x39f9fd(0x1d4)](_0x39f9fd(0x1c1),_0x24160a)[0x0],_0x3e4c6b=new crypto[(_0x39f9fd(0x1a5))]();_0x3e4c6b[_0x39f9fd(0x1cf)]=new crypto['FileKeyInfo'](_0x15c85c['hzzFa']),_0x35caf1[_0x39f9fd(0x1c6)](function(){var _0x36a806=_0x39f9fd;_0x3e4c6b[_0x36a806(0x1b3)](_0x27577d);},Error,_0x39f9fd(0x1a0)),_0x35caf1['done']();};