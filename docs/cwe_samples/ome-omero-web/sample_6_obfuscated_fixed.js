const _0x474006=_0x3c79;function _0x3c79(_0x38a603,_0x2e56a2){const _0x2f842b=_0x2f84();return _0x3c79=function(_0x3c7911,_0x298064){_0x3c7911=_0x3c7911-0x124;let _0x17c7fc=_0x2f842b[_0x3c7911];return _0x17c7fc;},_0x3c79(_0x38a603,_0x2e56a2);}(function(_0x56331c,_0x443a28){const _0x581d90=_0x3c79,_0x9dbb9c=_0x56331c();while(!![]){try{const _0x3144e7=-parseInt(_0x581d90(0x129))/0x1*(parseInt(_0x581d90(0x15b))/0x2)+parseInt(_0x581d90(0x173))/0x3+parseInt(_0x581d90(0x156))/0x4*(-parseInt(_0x581d90(0x178))/0x5)+parseInt(_0x581d90(0x17e))/0x6+parseInt(_0x581d90(0x15e))/0x7*(-parseInt(_0x581d90(0x15f))/0x8)+-parseInt(_0x581d90(0x169))/0x9*(-parseInt(_0x581d90(0x148))/0xa)+parseInt(_0x581d90(0x181))/0xb;if(_0x3144e7===_0x443a28)break;else _0x9dbb9c['push'](_0x9dbb9c['shift']());}catch(_0x49eae2){_0x9dbb9c['push'](_0x9dbb9c['shift']());}}}(_0x2f84,0xd6e44));function _0x2f84(){const _0x1a3a6f=['[...<paths>]','could\x20not\x20read\x20project\x20dir\x20package.json','description','edgesOut','spec','realpath','sEWyH','inventory','top','oBcdu','execWorkspaces','flatOptions','packument','YvClg','rawSpec','package','validRange','JRYCj','libnpmdiff','QoMVG','globalDir','210jnOBjj','Needs\x20to\x20be\x20run\x20from\x20a\x20project\x20dir\x20in\x20order\x20to\x20diff\x20two\x20versions.','Needs\x20multiple\x20arguments\x20to\x20compare\x20or\x20run\x20from\x20a\x20project\x20dir.','WkIIl','ignoreImplicitWorkspace','workspacePaths','vniYX','FvtgO','fetchSpec','GYXWr','KIfZF','Can\x27t\x20use\x20more\x20than\x20two\x20--diff\x20arguments.','npm-package-arg','nzUNE','3478520hofKUg','edgesIn','filter','tag','retrieveSpecs','3081254oVlHUF','workspace','diff-unified','164675ZCjEOt','248pUWpYS','packageName','npm-pick-manifest','name','params','include-workspace-root','query','package.json','MiIwo','file:','481284XJxyVP','registry','pacote','mcDqa','workspaces','LxHqD','eBuQQ','npm','type','output','5050296fVcHcR','verbose','get','values','Spec\x20type\x20','5YftVKy','tkYeN','path','diff-name-only','diff-ignore-all-space','directory','6183798XTpsdu','loadActual','length','2009337dlnSXQ','ifVgs','read-package-json-fast','diff','usage','config','liypm','diff-text','ngQhp','wSmVZ','Pizir','global','yLErx','exec','aanhd','convertVersionsToSpecs','1afcLXu','findVersionsByPackageName','usageError','version','next','tKsSC','prefix','failed\x20to\x20load\x20actual\x20install\x20tree','biOOD','value'];_0x2f84=function(){return _0x1a3a6f;};return _0x2f84();}const {resolve}=require(_0x474006(0x17a)),semver=require('semver'),libnpmdiff=require(_0x474006(0x145)),npa=require(_0x474006(0x154)),Arborist=require('@npmcli/arborist'),pacote=require(_0x474006(0x16b)),pickManifest=require(_0x474006(0x161)),log=require('../utils/log-shim'),readPackage=require(_0x474006(0x183)),BaseCommand=require('../base-command.js');class Diff extends BaseCommand{static [_0x474006(0x135)]='The\x20registry\x20diff\x20command';static [_0x474006(0x162)]=_0x474006(0x184);static [_0x474006(0x185)]=[_0x474006(0x133)];static [_0x474006(0x163)]=[_0x474006(0x184),_0x474006(0x17b),_0x474006(0x15d),_0x474006(0x17c),'diff-no-prefix','diff-src-prefix','diff-dst-prefix',_0x474006(0x188),'global',_0x474006(0x159),_0x474006(0x15c),_0x474006(0x16d),_0x474006(0x164)];static [_0x474006(0x14c)]=![];async[_0x474006(0x126)](_0x20dccf){const _0x49468c=_0x474006,_0x4c4c63={'LxHqD':_0x49468c(0x184),'USHhm':_0x49468c(0x124)},_0x3babf6=this['npm'][_0x49468c(0x186)][_0x49468c(0x175)](_0x4c4c63[_0x49468c(0x16e)])[_0x49468c(0x158)](_0x69e0bf=>_0x69e0bf);if(_0x3babf6[_0x49468c(0x180)]>0x2)throw this['usageError'](_0x49468c(0x153));!this[_0x49468c(0x12f)]&&(this[_0x49468c(0x12f)]=this[_0x49468c(0x170)][_0x49468c(0x12f)]);this['npm']['config'][_0x49468c(0x175)](_0x4c4c63['USHhm'])?this[_0x49468c(0x13b)]=resolve(this[_0x49468c(0x170)][_0x49468c(0x147)],'..'):this[_0x49468c(0x13b)]=this[_0x49468c(0x12f)];const [_0x2c94c6,_0xd66abb]=await this[_0x49468c(0x15a)](_0x3babf6);log['info'](_0x4c4c63['LxHqD'],{'src':_0x2c94c6,'dst':_0xd66abb});const _0x515a82=await libnpmdiff([_0x2c94c6,_0xd66abb],{...this[_0x49468c(0x170)][_0x49468c(0x13e)],'diffFiles':_0x20dccf,'where':this[_0x49468c(0x13b)]});return this[_0x49468c(0x170)][_0x49468c(0x172)](_0x515a82);}async[_0x474006(0x13d)](_0xdc26b0,_0xfde8e){const _0x30592e=_0x474006;await this['setWorkspaces'](_0xfde8e);for(const _0x39fa55 of this[_0x30592e(0x14d)]){this[_0x30592e(0x13b)]=_0x39fa55,this[_0x30592e(0x12f)]=_0x39fa55,await this[_0x30592e(0x126)](_0xdc26b0);}}async[_0x474006(0x160)](_0xf4c73a){const _0x38e5d6=_0x474006,_0x5787b1={'KIfZF':_0x38e5d6(0x184),'YvClg':_0x38e5d6(0x134)};let _0x1955f1;try{const _0x5581e3=await readPackage(resolve(this[_0x38e5d6(0x12f)],_0x38e5d6(0x166)));_0x1955f1=_0x5581e3[_0x38e5d6(0x162)];}catch(_0x225d6e){log[_0x38e5d6(0x174)](_0x5787b1[_0x38e5d6(0x152)],_0x5787b1[_0x38e5d6(0x140)]);}if(!_0x1955f1)throw this[_0x38e5d6(0x12b)](_0x38e5d6(0x14a));return _0x1955f1;}async[_0x474006(0x15a)]([_0x13d442,_0xbeff30]){const _0x1d9da4=_0x474006,_0x1ce8af={'wSmVZ':_0x1d9da4(0x130),'sEWyH':_0x1d9da4(0x159),'tKsSC':_0x1d9da4(0x184),'biOOD':function(_0x2f5145,_0x5a24c1){return _0x2f5145!==_0x5a24c1;},'dDJNv':'FvtgO','nzUNE':'name','mcDqa':_0x1d9da4(0x151),'ngQhp':function(_0x3ae728){return _0x3ae728();},'kApcy':function(_0x38e0b4){return _0x38e0b4();},'liypm':function(_0x36f918,_0x5dab80){return _0x36f918===_0x5dab80;},'gkoeb':function(_0x427361,_0xd2975f){return _0x427361===_0xd2975f;}};if(_0x13d442&&_0xbeff30){const _0x36f7aa=await this[_0x1d9da4(0x128)]([_0x13d442,_0xbeff30]);return this['findVersionsByPackageName'](_0x36f7aa);}if(!_0x13d442){const _0x2dd3ab=await this[_0x1d9da4(0x160)](this[_0x1d9da4(0x12f)]);return[_0x2dd3ab+'@'+this[_0x1d9da4(0x170)][_0x1d9da4(0x186)][_0x1d9da4(0x175)](_0x1ce8af[_0x1d9da4(0x139)]),'file:'+this['prefix']];}let _0x5edd62,_0x40df68;try{const _0x1601a6=await readPackage(resolve(this[_0x1d9da4(0x12f)],'package.json'));_0x40df68=_0x1601a6[_0x1d9da4(0x162)];}catch(_0x175a63){log[_0x1d9da4(0x174)](_0x1ce8af[_0x1d9da4(0x12e)],_0x1d9da4(0x134)),_0x5edd62=!![];}const _0x384ea5=this[_0x1d9da4(0x12b)](_0x1d9da4(0x14a));if(semver[_0x1d9da4(0x143)](_0x13d442)){if(!_0x40df68)throw _0x384ea5;return[_0x40df68+'@'+_0x13d442,_0x1d9da4(0x168)+this[_0x1d9da4(0x12f)]];}const _0x5ae5e0=npa(_0x13d442);if(_0x5ae5e0[_0x1d9da4(0x16a)]){if(_0x1ce8af[_0x1d9da4(0x131)](_0x1d9da4(0x14f),_0x1ce8af['dDJNv']))_0x2d6cdb[_0x1d9da4(0x174)](_0x1d9da4(0x184),_0x1ce8af[_0x1d9da4(0x18a)]);else{let _0x574da0,_0x479807;try{const _0x85fde9={...this[_0x1d9da4(0x170)][_0x1d9da4(0x13e)],'path':this[_0x1d9da4(0x13b)]},_0x15f887=new Arborist(_0x85fde9);_0x574da0=await _0x15f887[_0x1d9da4(0x17f)](_0x85fde9),_0x479807=_0x574da0&&_0x574da0[_0x1d9da4(0x13a)][_0x1d9da4(0x165)](_0x1ce8af[_0x1d9da4(0x155)],_0x5ae5e0['name'])[_0x1d9da4(0x176)]()[_0x1d9da4(0x12d)]()['value'];}catch(_0x443e4a){log[_0x1d9da4(0x174)](_0x1ce8af['tKsSC'],_0x1ce8af[_0x1d9da4(0x18a)]);}if(!_0x479807||!_0x479807[_0x1d9da4(0x162)]||!_0x479807[_0x1d9da4(0x142)]||!_0x479807[_0x1d9da4(0x142)][_0x1d9da4(0x12c)]){if(_0x1ce8af[_0x1d9da4(0x131)](_0x1ce8af[_0x1d9da4(0x16c)],_0x1d9da4(0x182))){if(_0x5edd62)throw _0x384ea5;return[_0x5ae5e0[_0x1d9da4(0x162)]+'@'+_0x5ae5e0[_0x1d9da4(0x150)],'file:'+this[_0x1d9da4(0x12f)]];}else throw this[_0x1d9da4(0x12b)](_0x1d9da4(0x153));}const _0xf4a043=()=>(_0x574da0&&_0x574da0[_0x1d9da4(0x136)][_0x1d9da4(0x175)](_0x5ae5e0[_0x1d9da4(0x162)])||{})[_0x1d9da4(0x137)],_0x675929=()=>{const _0x364b25=_0x1d9da4;for(const _0x2aebc0 of _0x479807[_0x364b25(0x157)]){return _0x2aebc0[_0x364b25(0x137)];}},_0x4c6723=_0x1d9da4(0x168)+_0x479807[_0x1d9da4(0x138)];let _0x5263ce;if(_0x5ae5e0[_0x1d9da4(0x141)])_0x5263ce=_0x5ae5e0[_0x1d9da4(0x141)];else{const _0xe59f8a=_0x1ce8af[_0x1d9da4(0x189)](_0xf4a043)||_0x1ce8af['kApcy'](_0x675929),_0x364b29=await pacote[_0x1d9da4(0x13f)](_0x5ae5e0,{...this[_0x1d9da4(0x170)]['flatOptions'],'preferOnline':!![]});_0x5263ce=pickManifest(_0x364b29,_0xe59f8a,{...this[_0x1d9da4(0x170)][_0x1d9da4(0x13e)]})[_0x1d9da4(0x12c)];}return[_0x5ae5e0['name']+'@'+_0x4c6723,_0x5ae5e0['name']+'@'+_0x5263ce];}}else{if(_0x1ce8af[_0x1d9da4(0x187)](_0x5ae5e0[_0x1d9da4(0x171)],_0x1d9da4(0x17d)))return[_0x1d9da4(0x168)+_0x5ae5e0[_0x1d9da4(0x150)],'file:'+this[_0x1d9da4(0x12f)]];else{if(_0x1ce8af['gkoeb'](_0x1d9da4(0x179),_0x1d9da4(0x179)))throw this['usageError'](_0x1d9da4(0x177)+_0x5ae5e0[_0x1d9da4(0x171)]+'\x20not\x20supported.');else throw this[_0x1d9da4(0x12b)](_0x1d9da4(0x14a));}}}async[_0x474006(0x128)]([_0x14a768,_0x3d8142]){const _0xe4448e=_0x474006,_0x1a8624={'vniYX':_0xe4448e(0x134),'oBcdu':function(_0xe5d697,_0x1be390){return _0xe5d697&&_0x1be390;},'QoMVG':function(_0x24dfff,_0xc30266){return _0x24dfff!==_0xc30266;},'aanhd':'UJWyx','WkIIl':_0xe4448e(0x167),'pOTnq':_0xe4448e(0x149),'eBuQQ':function(_0x49b22c,_0x1c2f67){return _0x49b22c&&_0x1c2f67;},'JRYCj':function(_0x3ffb54,_0x2fb680){return _0x3ffb54(_0x2fb680);}},_0x5ae6d2=semver[_0xe4448e(0x143)](_0x14a768),_0x19d632=semver[_0xe4448e(0x143)](_0x3d8142);if(_0x1a8624[_0xe4448e(0x13c)](_0x5ae6d2,_0x19d632)){if(_0x1a8624[_0xe4448e(0x146)]('UJWyx',_0x1a8624[_0xe4448e(0x127)]))_0x17f3ea[_0xe4448e(0x174)](_0xe4448e(0x184),_0x1a8624[_0xe4448e(0x14e)]);else{let _0x10aa2e;try{const _0x1aaa57=await readPackage(resolve(this['prefix'],_0xe4448e(0x166)));_0x10aa2e=_0x1aaa57[_0xe4448e(0x162)];}catch(_0x503ca5){log[_0xe4448e(0x174)](_0xe4448e(0x184),_0xe4448e(0x134));}if(!_0x10aa2e){if(_0xe4448e(0x167)!==_0x1a8624[_0xe4448e(0x14b)])this[_0xe4448e(0x12f)]=this[_0xe4448e(0x170)]['prefix'];else throw this['usageError'](_0x1a8624['pOTnq']);}return[_0x10aa2e+'@'+_0x14a768,_0x10aa2e+'@'+_0x3d8142];}}if(!_0x5ae6d2&&_0x19d632)return[_0x14a768,npa(_0x14a768)[_0xe4448e(0x162)]+'@'+_0x3d8142];if(_0x1a8624[_0xe4448e(0x16f)](_0x5ae6d2,!_0x19d632))return[_0x1a8624[_0xe4448e(0x144)](npa,_0x3d8142)[_0xe4448e(0x162)]+'@'+_0x14a768,_0x3d8142];return[_0x14a768,_0x3d8142];}async[_0x474006(0x12a)](_0x361fe6){const _0x15c5c6=_0x474006,_0x3d6bc9={'Pizir':function(_0x22b53d,_0x1c5813){return _0x22b53d(_0x1c5813);},'yLErx':_0x15c5c6(0x184)};let _0x5e9ebb;try{const _0x4d0f34={...this[_0x15c5c6(0x170)][_0x15c5c6(0x13e)],'path':this[_0x15c5c6(0x13b)]},_0x1aa74c=new Arborist(_0x4d0f34);_0x5e9ebb=await _0x1aa74c[_0x15c5c6(0x17f)](_0x4d0f34);}catch(_0x365ca1){log[_0x15c5c6(0x174)](_0x3d6bc9[_0x15c5c6(0x125)],'failed\x20to\x20load\x20actual\x20install\x20tree');}return _0x361fe6['map'](_0x109341=>{const _0x369bea=_0x15c5c6,_0x3677ec=_0x3d6bc9[_0x369bea(0x18b)](npa,_0x109341);if(_0x3677ec['rawSpec'])return _0x109341;const _0xc4def2=_0x5e9ebb&&_0x5e9ebb[_0x369bea(0x13a)][_0x369bea(0x165)](_0x369bea(0x162),_0x3677ec[_0x369bea(0x162)])[_0x369bea(0x176)]()[_0x369bea(0x12d)]()[_0x369bea(0x132)],_0x3a9ebd=!_0xc4def2||!_0xc4def2[_0x369bea(0x142)]||!_0xc4def2[_0x369bea(0x142)][_0x369bea(0x12c)]?_0x3677ec[_0x369bea(0x150)]:_0x369bea(0x168)+_0xc4def2[_0x369bea(0x138)];return _0x3677ec[_0x369bea(0x162)]+'@'+_0x3a9ebd;});}}module['exports']=Diff;