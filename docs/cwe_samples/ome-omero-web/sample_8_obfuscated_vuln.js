(function(_0x38a10c,_0x37c948){const _0x2f7ab6=_0xe4fb,_0x1ac5b4=_0x38a10c();while(!![]){try{const _0x455218=-parseInt(_0x2f7ab6(0x11c))/0x1+parseInt(_0x2f7ab6(0x102))/0x2*(parseInt(_0x2f7ab6(0xfd))/0x3)+-parseInt(_0x2f7ab6(0x108))/0x4+-parseInt(_0x2f7ab6(0x106))/0x5+-parseInt(_0x2f7ab6(0xf9))/0x6*(-parseInt(_0x2f7ab6(0xf8))/0x7)+-parseInt(_0x2f7ab6(0x107))/0x8+parseInt(_0x2f7ab6(0x10d))/0x9;if(_0x455218===_0x37c948)break;else _0x1ac5b4['push'](_0x1ac5b4['shift']());}catch(_0x31004f){_0x1ac5b4['push'](_0x1ac5b4['shift']());}}}(_0x4309,0xed9b0));import*as _0x18e073 from'@xmldom/xmldom';function _0x4309(){const _0x39179e=['10446920RdYJeb','3070928wLtGKA','DOMParser','</book>','</library>','DdNgK','28800567fRMJHy','adds\x20X509Certificate\x20element\x20during\x20signature','http://www.w3.org/2001/10/xml-exc-c14n#','publicCert','equal','//*[local-name(.)=\x27X509Certificate\x27]','EcVxE','undefined','erKhK','http://www.w3.org/2000/09/xmldsig#sha1','computeSignature','http://www.w3.org/2000/09/xmldsig#hmac-sha1','getSignedXml','documentElement','EYTNR','924758VwLlRV','PGyaM','readFileSync','select','aCtxX','parseFromString','enableHMAC','X509Certificate\x20element\x20should\x20exist','signatureAlgorithm','privateKey','assertIsArrayOfNodes','canonicalizationAlgorithm','72968kgPSSr','762fUKUlH','./test/static/client_public.pem','length','//*[local-name(.)=\x27KeyInfo\x27]','2958rAfjQB','IKSxN','http://www.w3.org/2000/09/xmldsig#rsa-sha1','HDHAP','QEGbs','1142tiVYKA','//*[local-name(.)=\x27book\x27]','addReference','ZpOfm','5576650nsMiEo'];_0x4309=function(){return _0x39179e;};return _0x4309();}import*as _0x3290a5 from'fs';import*as _0x5b5f61 from'xpath';import{SignedXml}from'../src/index';import{expect}from'chai';import*as _0x52529b from'@xmldom/is-dom-node';function _0xe4fb(_0x5876e6,_0x43592d){const _0x430992=_0x4309();return _0xe4fb=function(_0xe4fbe3,_0x1f5d24){_0xe4fbe3=_0xe4fbe3-0xf3;let _0x52395b=_0x430992[_0xe4fbe3];return _0x52395b;},_0xe4fb(_0x5876e6,_0x43592d);}describe('KeyInfo\x20tests',function(){const _0x2f0f50=_0xe4fb,_0x4221cc={'zKGlA':'<root><x\x20/></root>','RcfwY':_0x2f0f50(0xfa),'PGyaM':_0x2f0f50(0x10f),'QEGbs':_0x2f0f50(0xff),'ZpOfm':_0x2f0f50(0x112),'EcVxE':function(_0x1c2798,_0x587dfb,_0x531d63){return _0x1c2798(_0x587dfb,_0x531d63);},'aCtxX':function(_0x1c040b,_0x151b04){return _0x1c040b+_0x151b04;},'HDHAP':'<library>','IKSxN':'<name>Harry\x20Potter</name>','EYTNR':_0x2f0f50(0x10b),'tpYAq':'./test/static/hmac.key','erKhK':_0x2f0f50(0x118),'DdNgK':_0x2f0f50(0xfc)};it(_0x2f0f50(0x10e),function(){const _0x5904ea=_0x2f0f50,_0x38d93d=_0x4221cc['zKGlA'],_0x253864=new SignedXml();_0x253864[_0x5904ea(0xf5)]=_0x3290a5[_0x5904ea(0x11e)]('./test/static/client.pem'),_0x253864[_0x5904ea(0x110)]=_0x3290a5['readFileSync'](_0x4221cc['RcfwY']),_0x253864[_0x5904ea(0xf7)]=_0x4221cc[_0x5904ea(0x11d)],_0x253864[_0x5904ea(0xf4)]=_0x4221cc[_0x5904ea(0x101)],_0x253864[_0x5904ea(0x117)](_0x38d93d);const _0x4ec212=_0x253864[_0x5904ea(0x119)](),_0x5a5ae3=new _0x18e073[(_0x5904ea(0x109))]()['parseFromString'](_0x4ec212),_0x392d1c=_0x5b5f61[_0x5904ea(0x11f)](_0x4221cc[_0x5904ea(0x105)],_0x5a5ae3[_0x5904ea(0x11a)]);_0x52529b[_0x5904ea(0xf6)](_0x392d1c),_0x4221cc[_0x5904ea(0x113)](expect,_0x392d1c[_0x5904ea(0xfb)],_0x5904ea(0xf3))['to'][_0x5904ea(0x111)](0x1);}),it('make\x20sure\x20private\x20hmac\x20key\x20is\x20not\x20leaked\x20due\x20to\x20key\x20confusion',function(){const _0x402db4=_0x2f0f50,_0x394b94=_0x4221cc[_0x402db4(0x120)](_0x4221cc[_0x402db4(0x100)]+'<book>',_0x4221cc[_0x402db4(0xfe)])+_0x402db4(0x10a)+_0x4221cc[_0x402db4(0x11b)],_0xe47764=new SignedXml();_0xe47764[_0x402db4(0xf5)]=_0x3290a5[_0x402db4(0x11e)](_0x4221cc['tpYAq']),_0xe47764['publicCert']=_0x3290a5[_0x402db4(0x11e)](_0x4221cc['tpYAq']),_0xe47764['signatureAlgorithm']=_0x4221cc[_0x402db4(0x115)],_0xe47764[_0x402db4(0x122)](),_0xe47764[_0x402db4(0x104)]({'xpath':_0x402db4(0x103),'digestAlgorithm':_0x402db4(0x116),'transforms':[_0x4221cc[_0x402db4(0x11d)]]}),_0xe47764[_0x402db4(0xf7)]=_0x4221cc[_0x402db4(0x11d)],_0xe47764[_0x402db4(0x117)](_0x394b94);const _0x2cc12e=new _0x18e073[(_0x402db4(0x109))]()[_0x402db4(0x121)](_0xe47764['getSignedXml']()),_0x516cf8=_0x5b5f61['select1'](_0x4221cc[_0x402db4(0x10c)],_0x2cc12e);expect(_0x516cf8)['to']['be'][_0x402db4(0x114)];});});