'use strict';const _0x23bdb1=_0x5296;(function(_0x40794c,_0x5f1b5e){const _0x49f18f=_0x5296,_0x4f01af=_0x40794c();while(!![]){try{const _0x262fd3=-parseInt(_0x49f18f(0x19d))/0x1+parseInt(_0x49f18f(0x18f))/0x2*(parseInt(_0x49f18f(0x18a))/0x3)+-parseInt(_0x49f18f(0x1b5))/0x4*(parseInt(_0x49f18f(0x1ba))/0x5)+-parseInt(_0x49f18f(0x170))/0x6+parseInt(_0x49f18f(0x198))/0x7*(-parseInt(_0x49f18f(0x1b2))/0x8)+-parseInt(_0x49f18f(0x181))/0x9*(parseInt(_0x49f18f(0x199))/0xa)+-parseInt(_0x49f18f(0x1bd))/0xb*(-parseInt(_0x49f18f(0x187))/0xc);if(_0x262fd3===_0x5f1b5e)break;else _0x4f01af['push'](_0x4f01af['shift']());}catch(_0x4c0883){_0x4f01af['push'](_0x4f01af['shift']());}}}(_0x5bea,0x8eaf4));function _0x5bea(){const _0x14a721=['feed','yargs','../lib/misc/message_builder','HKPOP','ilfuj','fNzUV','connect','node-opcua','UZeDP','\x20client\x20->\x20server\x20:\x20packet\x20length\x20','reason','MSG','analyseExtensionObject','1802061JxYSfj','log','../lib/misc/binaryStream','ERR','IfiPa','stringify','19638240eNGsDY','../lib/misc/analyzePacket','DSHPJ','3vMuxCn','BAYlg','../lib/datamodel/structures','add','decode','1462108stXNLW','HEL','gNcqi','argv','hexDump','block','\x20registering\x20OPCUA\x20server\x20on\x20port\x20','toString','yellow','41993yiQdXW','50xbbRsu','messageHeaderToString','portServer','FPKtm','911756LNlQIQ','tnHUU','write','iEILY','bold','chalk','port','net','connected','server\x20disconnected\x20(CLOSE)','OPN','length','akMKd','egIYd','hostname','jkNRi','\x20reason:','readMessageHeader','biNDO','Socket','red','1016tQkZGA','data','TCPErrorMessage','1076SGUrDA','MuOIv','BinaryStream','pyqzd','ACK','4145meqwUS','listen','ERROR\x20:\x20','22rPCumQ','\x20server\x20->\x20client\x20:\x20packet\x20length\x20','3131298LyskHN','msgType','end','server\x20disconnected\x20(END)'];_0x5bea=function(){return _0x14a721;};return _0x5bea();}const net=require(_0x23bdb1(0x1a4)),chalk=require(_0x23bdb1(0x1a2)),argv=require(_0x23bdb1(0x175))['usage']('Usage:\x20$0\x20--portServer\x20[num]\x20--port\x20[num]\x20\x20--hostname\x20<hostname>\x20-block')[_0x23bdb1(0x192)],opcua=require(_0x23bdb1(0x17b)),hexDump=require('node-opcua-utils')[_0x23bdb1(0x193)],MessageBuilder=require(_0x23bdb1(0x176))['MessageBuilder'],BinaryStream=require(_0x23bdb1(0x183))[_0x23bdb1(0x1b7)],analyseExtensionObject=require(_0x23bdb1(0x188))[_0x23bdb1(0x180)],messageHeaderToString=require('../lib/misc/message_header')[_0x23bdb1(0x19a)],s=require(_0x23bdb1(0x18c)),remote_port=parseInt(argv[_0x23bdb1(0x1a3)],0xa)||0x12e9,hostname=argv[_0x23bdb1(0x1ab)]||'localhost',my_port=parseInt(argv[_0x23bdb1(0x19b)],0xa)||remote_port+0x1,TrafficAnalyser=function(_0x1861a5){this['id']=_0x1861a5;};function _0x5296(_0x1f2a0b,_0x43dbe5){const _0x5bea6e=_0x5bea();return _0x5296=function(_0x529603,_0x328cbb){_0x529603=_0x529603-0x170;let _0x220848=_0x5bea6e[_0x529603];return _0x220848;},_0x5296(_0x1f2a0b,_0x43dbe5);}TrafficAnalyser['prototype'][_0x23bdb1(0x18d)]=function(_0x3ce286){const _0x2da3a4=_0x23bdb1,_0x1d0c20={'FPKtm':function(_0x17d4c8,_0x5abe6c){return _0x17d4c8(_0x5abe6c);},'SiWzj':function(_0x4a7e5e,_0x464814){return _0x4a7e5e+_0x464814;},'DSHPJ':_0x2da3a4(0x1ad),'HKPOP':_0x2da3a4(0x184),'BAYlg':function(_0x4ac0d3,_0x3cd6f9){return _0x4ac0d3+_0x3cd6f9;},'DLVLc':function(_0x44852b,_0xc3429e){return _0x44852b+_0xc3429e;},'gNcqi':'full_message_body','egIYd':function(_0x5834ee,_0x506920){return _0x5834ee%_0x506920;},'fNzUV':_0x2da3a4(0x1af),'kpwcd':function(_0x47e83c,_0x20423b){return _0x47e83c(_0x20423b);},'MuOIv':function(_0x404ff2,_0x5640e3){return _0x404ff2!==_0x5640e3;},'aMbgX':'QXdfq'},_0xc88726=new BinaryStream(_0x3ce286);if(argv[_0x2da3a4(0x194)]){console[_0x2da3a4(0x182)](hexDump(_0x3ce286));return;}const _0x13f5c0=opcua[_0x2da3a4(0x1ae)](_0xc88726);if(_0x13f5c0[_0x2da3a4(0x171)]===_0x1d0c20[_0x2da3a4(0x177)]){const _0x2e6689=new s[(_0x2da3a4(0x1b4))]();_0x2e6689[_0x2da3a4(0x18e)](_0xc88726),console[_0x2da3a4(0x182)](_0x1d0c20[_0x2da3a4(0x18b)](_0x1d0c20['DLVLc']('\x20Error\x200x',_0x2e6689['statusCode'][_0x2da3a4(0x196)]())+_0x1d0c20[_0x2da3a4(0x189)],_0x2e6689[_0x2da3a4(0x17e)])),console['log'](hexDump(_0x3ce286));}const _0x143f36=new MessageBuilder();_0x143f36['on'](_0x1d0c20[_0x2da3a4(0x191)],function(_0x50cd76){const _0xe9e913=_0x2da3a4;console[_0xe9e913(0x182)](_0x1d0c20[_0xe9e913(0x19c)](hexDump,_0x50cd76));try{analyseExtensionObject(_0x50cd76);}catch(_0x1a694e){console[_0xe9e913(0x182)](chalk['red']('ERROR\x20:\x20'),_0x1a694e);}});switch(_0x13f5c0[_0x2da3a4(0x171)]){case _0x2da3a4(0x190):case _0x2da3a4(0x1b9):if(_0x1d0c20[_0x2da3a4(0x1aa)](this['id'],0x2)){if(_0x2da3a4(0x1b8)===_0x2da3a4(0x19e)){const _0x349a3f=new _0x532a4f[(_0x2da3a4(0x1b4))]();_0x349a3f[_0x2da3a4(0x18e)](_0x3aed5f),_0x5e078a[_0x2da3a4(0x182)](_0x1d0c20['SiWzj']('\x20Error\x200x',_0x349a3f['statusCode']['toString']())+_0x1d0c20[_0x2da3a4(0x189)]+_0x349a3f['reason']),_0x3ddab0[_0x2da3a4(0x182)](_0x29e510(_0x373f93));}else console[_0x2da3a4(0x182)](chalk[_0x2da3a4(0x1b1)][_0x2da3a4(0x1a1)](JSON[_0x2da3a4(0x186)](_0x13f5c0,null,'')));}else _0x1d0c20[_0x2da3a4(0x179)]===_0x2da3a4(0x1af)?console['log'](chalk['yellow'][_0x2da3a4(0x1a1)](JSON[_0x2da3a4(0x186)](_0x13f5c0,null,''))):_0x524345[_0x2da3a4(0x182)](_0x5ecd9e[_0x2da3a4(0x1b1)][_0x2da3a4(0x1a1)](_0x25a3f2['stringify'](_0x4dff9b,null,'')));break;case _0x2da3a4(0x1a7):case'CLO':case _0x2da3a4(0x17f):_0x1d0c20[_0x2da3a4(0x1aa)](this['id'],0x2)?console['log'](chalk[_0x2da3a4(0x1b1)][_0x2da3a4(0x1a1)](_0x1d0c20['kpwcd'](messageHeaderToString,_0x3ce286))):_0x1d0c20[_0x2da3a4(0x1b6)]('QXdfq',_0x1d0c20['aMbgX'])?_0x4af051[_0x2da3a4(0x182)](_0x493d88[_0x2da3a4(0x1b1)](_0x2da3a4(0x1bc)),_0xc8cb70):console[_0x2da3a4(0x182)](chalk[_0x2da3a4(0x197)][_0x2da3a4(0x1a1)](_0x1d0c20['kpwcd'](messageHeaderToString,_0x3ce286)));_0x143f36[_0x2da3a4(0x174)](_0x3ce286);break;case _0x1d0c20['HKPOP']:console[_0x2da3a4(0x182)](_0x1d0c20['kpwcd'](hexDump,_0x3ce286));break;default:break;}},require('net')['createServer'](function(_0x44d91c){const _0x3755c5=_0x23bdb1,_0x5530a7={'KHqJP':function(_0x489cdb,_0x2a054c){return _0x489cdb+_0x2a054c;},'jkNRi':function(_0x3522c2,_0x52fe66){return _0x3522c2(_0x52fe66);},'akMKd':'vDJIe','IfiPa':_0x3755c5(0x173),'UZeDP':'close','uRLBm':_0x3755c5(0x172)};console[_0x3755c5(0x182)](_0x3755c5(0x1a5));const _0x18228c=new TrafficAnalyser(0x1),_0x486c2f=new TrafficAnalyser(0x2),_0x5afb47=new net[(_0x3755c5(0x1b0))]();_0x5afb47[_0x3755c5(0x17a)](remote_port,hostname),_0x5afb47['on'](_0x3755c5(0x1b3),function(_0x1d932c){const _0x562162=_0x3755c5;console[_0x562162(0x182)](_0x562162(0x1be)+_0x1d932c[_0x562162(0x1a8)]),_0x486c2f['add'](_0x1d932c);try{_0x44d91c[_0x562162(0x19f)](_0x1d932c);}catch(_0x1c8b72){}}),_0x44d91c['on'](_0x3755c5(0x1b3),function(_0x25cf92){const _0x233d81=_0x3755c5;console['log'](_0x5530a7['KHqJP'](_0x233d81(0x17d),_0x25cf92[_0x233d81(0x1a8)])),_0x18228c['add'](_0x25cf92),_0x5afb47['write'](_0x25cf92);}),_0x44d91c['on'](_0x5530a7[_0x3755c5(0x17c)],function(){const _0x3cb684=_0x3755c5;console[_0x3cb684(0x182)](_0x3cb684(0x1a6)),_0x5afb47['end']();}),_0x44d91c['on'](_0x5530a7['uRLBm'],function(){const _0x43fbf1=_0x3755c5,_0x49189f={'iEILY':function(_0x4c4238,_0x509389){const _0x4f8d46=_0x5296;return _0x5530a7[_0x4f8d46(0x1ac)](_0x4c4238,_0x509389);}};_0x5530a7[_0x43fbf1(0x1a9)]===_0x43fbf1(0x178)?_0x3fcb9e['log'](_0x426196[_0x43fbf1(0x197)][_0x43fbf1(0x1a1)](_0x49189f[_0x43fbf1(0x1a0)](_0x3b22f9,_0x24a818))):console[_0x43fbf1(0x182)](_0x5530a7[_0x43fbf1(0x185)]);});})[_0x23bdb1(0x1bb)](my_port),console[_0x23bdb1(0x182)](_0x23bdb1(0x195)+my_port),console[_0x23bdb1(0x182)]('\x20\x20+->\x20redirecting\x20conversation\x20to\x20server\x20port\x20'+remote_port);