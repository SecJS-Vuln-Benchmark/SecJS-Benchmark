const _0x4a4ea8=_0x43de;function _0x48fb(){const _0x1ad971=['ERROR','validation_error','53938zUVDFm','dataset','\x22]\x20progress','101668AHInJK','parse','</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<progress\x20max=\x22100\x22\x20value=\x22','xOSIe','lQUXk','241696fiIjCs','length','addlabel','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','YESbA','is-disabled','button','CDYVg','uploadFile','locales','titled','error','wMOcz','firstChild','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','autoloadImage','div','DFCWU','upload','[data-filename=\x22','LSDIo','[data-dropzone]','assign','createElement','join','setAttribute','signed_id','\x0a\x20\x20\x20\x20\x20\x20<div>','VALIDATED','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','<li>','items','HUPXL','title','sWoGH','name','4615713xcynbU','createUploadItem','cvZgH','WCTCC','value','input','textContent','getOrdinalNumber','iVTGD','removable','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>','attachmentId','[data-dropzone-items]','forEach','FXEMx','[data-dialog-title]','MLkoa','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<span>','yLFcm','button[data-dropzone-cancel]','jfBfQ','setProgressBar','saveButton','\x22></progress>\x0a\x20\x20\x20\x20\x20\x20</li>','hcrnJ','validate','click','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button>','OeTJt','modal','</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<ul>','cZuNE','hidden','nextElementSibling','test','then','filename','HfnDd','validated','3032883rfJeqx','innerHTML','emptyItems','</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20class=\x22sm\x22\x20type=\x22text\x22\x20value=\x22','trim','cancelButton','uploadItems','attachmentCounter','handleButtonClick','appendChild','editlabel','\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22\x22\x20alt=\x22','\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20data-template=\x22','classList','errors','from','push','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label>','hiddenField','dialogOpen','</div>\x0a\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>','\x22\x20data-state=\x22','closest','mDDjA','685391EhKrmk','checked','disabled','children','map','add','create','findIndex','removeAttribute','ooSqP','addEventListener','type','querySelector','dropZone','30UUNqaP','updateAddAttachmentsButton','3385968DxDUFD','[data-dropzone-no-items]','kHlgF','options','modalTitle','\x22\x20/>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20','BIGXj','updateDropZone','button[data-dropzone-save]','spkPg','uploadFiles','cleanAllFiles','remove','OLyWk','19LQBKwF','multiple','replaceChild','[data-filename]'];_0x48fb=function(){return _0x1ad971;};return _0x48fb();}(function(_0x5efa33,_0x3e6a49){const _0xe21065=_0x43de,_0xc1d708=_0x5efa33();while(!![]){try{const _0x369f7d=parseInt(_0xe21065(0x217))/0x1*(-parseInt(_0xe21065(0x21d))/0x2)+parseInt(_0xe21065(0x249))/0x3+-parseInt(_0xe21065(0x220))/0x4*(parseInt(_0xe21065(0x207))/0x5)+-parseInt(_0xe21065(0x209))/0x6+parseInt(_0xe21065(0x1f9))/0x7+parseInt(_0xe21065(0x225))/0x8+parseInt(_0xe21065(0x1e1))/0x9;if(_0x369f7d===_0x3e6a49)break;else _0xc1d708['push'](_0xc1d708['shift']());}catch(_0x552b9a){_0xc1d708['push'](_0xc1d708['shift']());}}}(_0x48fb,0xbd12a));import{Uploader}from'src/decidim/direct_uploads/redesigned_uploader';function _0x43de(_0x30502c,_0x15ef9c){const _0x48fb52=_0x48fb();return _0x43de=function(_0x43dee5,_0x1b1c1a){_0x43dee5=_0x43dee5-0x1da;let _0x45e98c=_0x48fb52[_0x43dee5];return _0x45e98c;},_0x43de(_0x30502c,_0x15ef9c);}import _0x1a3663 from'src/decidim/redesigned_icon';import{truncateFilename}from'src/decidim/direct_uploads/upload_utility';import{escapeHtml,escapeQuotes}from'src/decidim/utilities/text';const STATUS={'VALIDATED':_0x4a4ea8(0x1e0),'ERROR':'error'};export default class UploadModal{constructor(_0xec4501,_0x2d82bb={}){const _0x2d96d5=_0x4a4ea8,_0x335624={'xOSIe':_0x2d96d5(0x20a),'MLkoa':_0x2d96d5(0x255),'cvZgH':_0x2d96d5(0x24e)};this['button']=_0xec4501;let _0x4f51c1={};try{_0x4f51c1=JSON[_0x2d96d5(0x221)](_0xec4501[_0x2d96d5(0x21e)][_0x2d96d5(0x237)]);}catch(_0x296250){}this[_0x2d96d5(0x20c)]=Object[_0x2d96d5(0x23b)](_0x4f51c1,_0x2d82bb),this['modal']=document['querySelector']('#'+_0xec4501[_0x2d96d5(0x21e)][_0x2d96d5(0x1f4)]),this[_0x2d96d5(0x25f)]=this[_0x2d96d5(0x266)][_0x2d96d5(0x205)]('button[data-dropzone-save]'),this[_0x2d96d5(0x1e6)]=this[_0x2d96d5(0x266)][_0x2d96d5(0x205)](_0x2d96d5(0x25c)),this[_0x2d96d5(0x20d)]=this[_0x2d96d5(0x266)][_0x2d96d5(0x205)](_0x2d96d5(0x258)),this[_0x2d96d5(0x206)]=this[_0x2d96d5(0x266)][_0x2d96d5(0x205)](_0x2d96d5(0x23a)),this['emptyItems']=this[_0x2d96d5(0x266)][_0x2d96d5(0x205)](_0x335624[_0x2d96d5(0x223)]),this[_0x2d96d5(0x1e7)]=this['modal'][_0x2d96d5(0x205)](_0x335624[_0x2d96d5(0x259)]),this[_0x2d96d5(0x24e)]=this[_0x2d96d5(0x206)][_0x2d96d5(0x205)](_0x335624[_0x2d96d5(0x24b)]),this[_0x2d96d5(0x244)]=[],this[_0x2d96d5(0x1e8)]=0x0,this[_0x2d96d5(0x22e)]=JSON[_0x2d96d5(0x221)](this['uploadItems'][_0x2d96d5(0x21e)][_0x2d96d5(0x22e)]),this['updateDropZone']();}[_0x4a4ea8(0x213)](_0x1e3ca5){const _0x1f67ae=_0x4a4ea8;if(this[_0x1f67ae(0x20c)][_0x1f67ae(0x218)])Array['from'](_0x1e3ca5)[_0x1f67ae(0x256)](_0x144cbb=>this[_0x1f67ae(0x22d)](_0x144cbb));else!this['uploadItems'][_0x1f67ae(0x1fc)][_0x1f67ae(0x226)]&&this['uploadFile'](_0x1e3ca5[0x0]);}[_0x4a4ea8(0x22d)](_0x1888c3){const _0x36941f=_0x4a4ea8,_0x59fcbd={'aeQee':_0x36941f(0x258),'YESbA':_0x36941f(0x255),'OeTJt':_0x36941f(0x251)},_0x57f5d3=new Uploader(this,{'file':_0x1888c3,'url':this[_0x36941f(0x24e)][_0x36941f(0x21e)]['directUploadUrl'],'attachmentName':_0x1888c3[_0x36941f(0x248)]}),_0x26c958=this[_0x36941f(0x24a)](_0x1888c3,_0x57f5d3[_0x36941f(0x1ef)]);this[_0x36941f(0x1e7)][_0x36941f(0x1ea)](_0x26c958),_0x57f5d3['errors']['length']?this[_0x36941f(0x210)]():_0x57f5d3[_0x36941f(0x237)][_0x36941f(0x1ff)]((_0x2a399d,_0x3f8c2d)=>{const _0x322a63=_0x36941f;_0x2a399d?_0x57f5d3[_0x322a63(0x1ef)]=[_0x2a399d]:(_0x1888c3[_0x322a63(0x1f3)]=_0x3f8c2d[_0x322a63(0x23f)],_0x57f5d3[_0x322a63(0x262)](_0x3f8c2d[_0x322a63(0x23f)])[_0x322a63(0x1dd)](()=>{const _0x5b3b62=_0x322a63,_0x52c73d={'kHlgF':_0x5b3b62(0x25c),'HfnDd':_0x59fcbd['aeQee'],'OLyWk':_0x5b3b62(0x23a),'HUPXL':_0x59fcbd[_0x5b3b62(0x229)]};if(_0x57f5d3[_0x5b3b62(0x1ef)][_0x5b3b62(0x226)])this['uploadItems'][_0x5b3b62(0x219)](this[_0x5b3b62(0x24a)](_0x1888c3,_0x57f5d3[_0x5b3b62(0x1ef)],{'value':0x64}),_0x26c958);else{if(_0x5b3b62(0x251)!==_0x59fcbd[_0x5b3b62(0x265)]){this['button']=_0xef2008;let _0x585978={};try{_0x585978=_0x4627e9[_0x5b3b62(0x221)](_0x2ac5b8['dataset'][_0x5b3b62(0x237)]);}catch(_0x1d49a7){}this[_0x5b3b62(0x20c)]=_0x41968b[_0x5b3b62(0x23b)](_0x585978,_0x4fc3d9),this[_0x5b3b62(0x266)]=_0x1d4304[_0x5b3b62(0x205)]('#'+_0xea8f70[_0x5b3b62(0x21e)][_0x5b3b62(0x1f4)]),this['saveButton']=this[_0x5b3b62(0x266)][_0x5b3b62(0x205)](_0x5b3b62(0x211)),this['cancelButton']=this[_0x5b3b62(0x266)][_0x5b3b62(0x205)](_0x52c73d[_0x5b3b62(0x20b)]),this['modalTitle']=this['modal']['querySelector'](_0x52c73d[_0x5b3b62(0x1df)]),this[_0x5b3b62(0x206)]=this[_0x5b3b62(0x266)][_0x5b3b62(0x205)](_0x52c73d[_0x5b3b62(0x216)]),this[_0x5b3b62(0x1e3)]=this[_0x5b3b62(0x266)][_0x5b3b62(0x205)](_0x5b3b62(0x20a)),this[_0x5b3b62(0x1e7)]=this[_0x5b3b62(0x266)][_0x5b3b62(0x205)](_0x52c73d[_0x5b3b62(0x245)]),this[_0x5b3b62(0x24e)]=this[_0x5b3b62(0x206)][_0x5b3b62(0x205)](_0x5b3b62(0x24e)),this[_0x5b3b62(0x244)]=[],this['attachmentCounter']=0x0,this[_0x5b3b62(0x22e)]=_0x26f7ca[_0x5b3b62(0x221)](this['uploadItems'][_0x5b3b62(0x21e)][_0x5b3b62(0x22e)]),this[_0x5b3b62(0x210)]();}else this[_0x5b3b62(0x244)][_0x5b3b62(0x1f1)](_0x1888c3),this[_0x5b3b62(0x234)](_0x26c958,_0x1888c3);}this[_0x5b3b62(0x210)]();}));});}[_0x4a4ea8(0x234)](_0x4c2eca,_0x5d81fa){const _0x52f49b=_0x4a4ea8;if(!/image/[_0x52f49b(0x1dc)](_0x5d81fa[_0x52f49b(0x204)]))return;const _0x1d9924=new FileReader();_0x1d9924['readAsDataURL'](_0x5d81fa),_0x1d9924['onload']=({target:{result:_0x31c334}})=>{const _0x11e08f=_0x4c2eca['querySelector']('img');_0x11e08f['src']=_0x31c334;};}async['preloadFiles'](_0x172f06){const _0x21a659=_0x4a4ea8,{src:_0x3097ff}=_0x172f06['querySelector']('img')||{};let _0x4eaa84='',_0xd442c3='';_0x3097ff&&(_0x4eaa84=await fetch(_0x3097ff)[_0x21a659(0x1dd)](_0x38a0fa=>_0x38a0fa['arrayBuffer']()),_0xd442c3='image');const _0x234685=new File([_0x4eaa84],_0x172f06['dataset'][_0x21a659(0x1de)],{'type':_0xd442c3}),_0xd656b5=this[_0x21a659(0x24a)](_0x234685,[],{..._0x172f06[_0x21a659(0x21e)],'value':0x64});_0x234685[_0x21a659(0x254)]=_0x172f06[_0x21a659(0x21e)][_0x21a659(0x254)],this[_0x21a659(0x244)]['push'](_0x234685),this['uploadItems'][_0x21a659(0x1ea)](_0xd656b5),this[_0x21a659(0x234)](_0xd656b5,_0x234685);}[_0x4a4ea8(0x250)](){const _0x41abcb=_0x4a4ea8,_0x1bea0f=this[_0x41abcb(0x1e8)];return this[_0x41abcb(0x1e8)]+=0x1,_0x1bea0f;}[_0x4a4ea8(0x210)](){const _0x4d2199=_0x4a4ea8,_0x30c1f8={'FXEMx':_0x4d2199(0x1fb),'DFCWU':_0x4d2199(0x22a),'LSDIo':'label'},{children:_0x2fbe7c}=this['uploadItems'],_0x1d0f33=_0x2fbe7c[_0x4d2199(0x226)]>0x0;this['uploadItems'][_0x4d2199(0x1da)]=!_0x1d0f33,this[_0x4d2199(0x25f)][_0x4d2199(0x1fb)]=Array[_0x4d2199(0x1f0)](_0x2fbe7c)['filter'](({dataset:{state:_0x4df2c8}})=>_0x4df2c8===STATUS[_0x4d2199(0x21b)])[_0x4d2199(0x226)]>0x0;const _0x92991f=!_0x2fbe7c[_0x4d2199(0x226)]||this[_0x4d2199(0x20c)][_0x4d2199(0x218)];this['input']['disabled']=!_0x92991f,_0x92991f?(this[_0x4d2199(0x1e3)][_0x4d2199(0x1ee)][_0x4d2199(0x215)](_0x4d2199(0x22a)),this[_0x4d2199(0x1e3)][_0x4d2199(0x205)]('label')[_0x4d2199(0x201)](_0x30c1f8[_0x4d2199(0x257)])):(this['emptyItems'][_0x4d2199(0x1ee)][_0x4d2199(0x1fe)](_0x30c1f8[_0x4d2199(0x236)]),this['emptyItems'][_0x4d2199(0x205)](_0x30c1f8[_0x4d2199(0x239)])[_0x4d2199(0x23e)](_0x4d2199(0x1fb),!![]));}[_0x4a4ea8(0x24a)](_0x147fd9,_0x4acf20,_0x217d91={}){const _0x3c548b=_0x4a4ea8,_0x5d2ea8={'mDDjA':function(_0x434d98,_0xa94934){return _0x434d98(_0xa94934);},'JbSYK':'error-warning-line','lQUXk':function(_0x2f55d0,_0x2c2f9e){return _0x2f55d0(_0x2c2f9e);},'spkPg':function(_0x26dce2,_0x35536a){return _0x26dce2(_0x35536a);},'jfBfQ':_0x3c548b(0x22f),'ooSqP':_0x3c548b(0x235),'hcrnJ':'button','sNZON':_0x3c548b(0x263)},_0x2cfbb2=_0x3c548b(0x1ec)+_0x147fd9[_0x3c548b(0x248)]+_0x3c548b(0x25a)+escapeHtml(_0x5d2ea8[_0x3c548b(0x1f8)](truncateFilename,_0x147fd9[_0x3c548b(0x248)]))+'</span>\x0a\x20\x20\x20\x20',_0x41bc91=_0x3c548b(0x240)+_0x1a3663(_0x5d2ea8['JbSYK'])+_0x3c548b(0x1f5)+_0x5d2ea8[_0x3c548b(0x224)](escapeHtml,truncateFilename(_0x147fd9[_0x3c548b(0x248)]))+_0x3c548b(0x233)+this[_0x3c548b(0x22e)][_0x3c548b(0x21c)]+_0x3c548b(0x267)+_0x4acf20[_0x3c548b(0x1fd)](_0x182577=>_0x3c548b(0x243)+_0x182577+'</li>')[_0x3c548b(0x23d)]('\x0a')+'</ul>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20',_0x4d4854=_0x3c548b(0x1ec)+_0x147fd9[_0x3c548b(0x248)]+_0x3c548b(0x1f2)+this[_0x3c548b(0x22e)][_0x3c548b(0x1de)]+_0x3c548b(0x253)+escapeHtml(_0x5d2ea8['spkPg'](truncateFilename,_0x147fd9[_0x3c548b(0x248)]))+_0x3c548b(0x228)+this[_0x3c548b(0x22e)][_0x3c548b(0x246)]+_0x3c548b(0x1e4)+_0x5d2ea8[_0x3c548b(0x1f8)](escapeQuotes,_0x217d91[_0x3c548b(0x246)]||truncateFilename(_0x147fd9[_0x3c548b(0x248)]))+_0x3c548b(0x20e);let _0x58eb0f=STATUS[_0x3c548b(0x241)],_0x5e54cc=_0x2cfbb2,_0x1c80d0='ok';_0x4acf20[_0x3c548b(0x226)]&&(_0x58eb0f=STATUS[_0x3c548b(0x21b)],_0x5e54cc=_0x41bc91,_0x1c80d0=_0x3c548b(0x230));!_0x4acf20[_0x3c548b(0x226)]&&this[_0x3c548b(0x20c)][_0x3c548b(0x22f)]&&(_0x5e54cc=_0x4d4854,_0x1c80d0=_0x5d2ea8[_0x3c548b(0x25d)]);const _0x5356e0=_0x217d91[_0x3c548b(0x254)]?'data-attachment-id=\x22'+_0x217d91[_0x3c548b(0x254)]+'\x22':'',_0x1195e9='\x0a\x20\x20\x20\x20\x20\x20<li\x20'+_0x5356e0+'\x20data-filename=\x22'+_0x5d2ea8[_0x3c548b(0x212)](escapeQuotes,_0x147fd9['name'])+_0x3c548b(0x1f6)+_0x58eb0f+_0x3c548b(0x1ed)+_0x1c80d0+_0x3c548b(0x242)+_0x5e54cc['trim']()+_0x3c548b(0x264)+this[_0x3c548b(0x22e)]['remove']+_0x3c548b(0x222)+(_0x217d91['value']||0x0)+_0x3c548b(0x260),_0x2a699f=document[_0x3c548b(0x23c)](_0x5d2ea8[_0x3c548b(0x202)]);_0x2a699f[_0x3c548b(0x1e2)]=_0x1195e9[_0x3c548b(0x1e5)]();const _0x892bad=_0x2a699f[_0x3c548b(0x232)];return _0x892bad['querySelector'](_0x5d2ea8[_0x3c548b(0x261)])[_0x3c548b(0x203)](_0x5d2ea8['sNZON'],this[_0x3c548b(0x1e9)]['bind'](this)),_0x892bad;}['handleButtonClick']({currentTarget:_0x2ac954}){const _0x1dd50a=_0x4a4ea8,_0xb4995={'cZuNE':function(_0x692333,_0xc00e08){return _0x692333>_0xc00e08;}},_0x5dfa8d=_0x2ac954[_0x1dd50a(0x1f7)](_0x1dd50a(0x21a)),{filename:_0x311643}=_0x5dfa8d[_0x1dd50a(0x21e)];_0x5dfa8d[_0x1dd50a(0x215)]();const _0x523560=this[_0x1dd50a(0x244)][_0x1dd50a(0x200)](({name:_0x30d345})=>_0x30d345===_0x311643);_0xb4995[_0x1dd50a(0x268)](_0x523560,-0x1)&&(_0x1dd50a(0x231)===_0x1dd50a(0x22c)?this[_0x1dd50a(0x1e7)][_0x1dd50a(0x205)]('[data-filename=\x22'+_0x24ef40(_0x162dc9)+_0x1dd50a(0x21f))[_0x1dd50a(0x24d)]=_0x408374:this['items'][_0x523560][_0x1dd50a(0x252)]=!![]),this[_0x1dd50a(0x210)]();}[_0x4a4ea8(0x25e)](_0x11f30b,_0x4e80bd){const _0x2ba447=_0x4a4ea8,_0x205d82={'yLFcm':function(_0x2bd95c,_0x2e6383){return _0x2bd95c(_0x2e6383);}};this[_0x2ba447(0x1e7)][_0x2ba447(0x205)](_0x2ba447(0x238)+_0x205d82[_0x2ba447(0x25b)](escapeQuotes,_0x11f30b)+_0x2ba447(0x21f))[_0x2ba447(0x24d)]=_0x4e80bd;}[_0x4a4ea8(0x208)](){const _0x53d77d=_0x4a4ea8,_0x754d83={'BIGXj':function(_0x4294db,_0x43da96){return _0x4294db===_0x43da96;},'sWoGH':function(_0x5e04ce,_0x5e5f81){return _0x5e04ce===_0x5e5f81;}};_0x754d83[_0x53d77d(0x20f)](this['uploadItems']['children']['length'],0x0)?_0x754d83[_0x53d77d(0x247)](_0x53d77d(0x24c),_0x53d77d(0x24c))?this[_0x53d77d(0x22b)][_0x53d77d(0x1e2)]=this['modalTitle']['dataset'][_0x53d77d(0x227)]:(this['items']=[],this['uploadItems'][_0x53d77d(0x24f)]='',this[_0x53d77d(0x210)]()):this[_0x53d77d(0x22b)][_0x53d77d(0x1e2)]=this['modalTitle']['dataset'][_0x53d77d(0x1eb)];const _0x116145=this[_0x53d77d(0x22b)][_0x53d77d(0x1db)];_0x116145&&(_0x116145[_0x53d77d(0x1fa)]=this[_0x53d77d(0x1e7)][_0x53d77d(0x1fc)][_0x53d77d(0x226)]>0x0);}[_0x4a4ea8(0x214)](){const _0x3e4e6d=_0x4a4ea8;this[_0x3e4e6d(0x244)]=[],this[_0x3e4e6d(0x1e7)]['textContent']='',this[_0x3e4e6d(0x210)]();}}