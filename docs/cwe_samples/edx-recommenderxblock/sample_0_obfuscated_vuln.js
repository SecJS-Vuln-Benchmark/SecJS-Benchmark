const _0x395ed1=_0x5925;(function(_0x37a697,_0x369928){const _0x374f76=_0x5925,_0x215b5a=_0x37a697();while(!![]){try{const _0x19180d=-parseInt(_0x374f76(0x11d))/0x1*(parseInt(_0x374f76(0x105))/0x2)+parseInt(_0x374f76(0xf4))/0x3*(-parseInt(_0x374f76(0x123))/0x4)+parseInt(_0x374f76(0xe7))/0x5*(-parseInt(_0x374f76(0xed))/0x6)+-parseInt(_0x374f76(0xfe))/0x7+parseInt(_0x374f76(0x104))/0x8*(-parseInt(_0x374f76(0x12b))/0x9)+-parseInt(_0x374f76(0xee))/0xa*(-parseInt(_0x374f76(0xfa))/0xb)+parseInt(_0x374f76(0x10d))/0xc;if(_0x19180d===_0x369928)break;else _0x215b5a['push'](_0x215b5a['shift']());}catch(_0x5b8dbd){_0x215b5a['push'](_0x215b5a['shift']());}}}(_0x463a,0xd7f8d));import{CapabilityDelegation}from'./CapabilityDelegation.js';function _0x463a(){const _0x486a9a=['PArzX','mgrqy','jEepD','proofPurpose','invocation\x20target\x20(','TTESc','capabilityAction','GpzPx','92WXmYix','string','inmnd','\x22\x20does\x20not\x20match\x20the\x20','_getCapabilityDelegationClass','Invocation\x20target\x20(','348ThcvkB','\x22expectedTarget\x22\x20must\x20be\x20a\x20string\x20or\x20array.','IUXKB','gEVlQ','Capability\x20action\x20\x22','vWcxq','\x22\x20is\x20not\x20allowed\x20by\x20the\x20','capability;\x20allowed\x20actions\x20are:\x20','27dzsfyN',')\x20must\x20be\x20a\x20string\x20that\x20','capability','KFeWo','MICpH','isValidTarget','controller','error','expresses\x20an\x20absolute\x20URI.','vXLWg','CXRxb','A\x20delegated\x20capability\x20must\x20not\x20be\x20invoked\x20before\x20the\x20\x22created\x22\x20','URI.','term','expected\x20action\x20of\x20\x22','isArray','object','IibKn','3320meEkyc','expectedAction','date\x20in\x20its\x20delegation\x20proof.','_runChecksBeforeChainVerification','invocationTarget','includes','6180Futxzm','20unAUjr','expectedTarget','_runChecksAfterChainVerification','valid','Expected\x20target\x20(','length','31761JBimGO',')\x20does\x20not\x20match\x20','\x22capability\x22\x20must\x20be\x20a\x20string\x20or\x20object.','ELKWC','map','parentCapability','4302287NnFgxL','KlOMF','ItVWg','treYl','2466443wKdVXM','details','gnZrw','\x22expectedAction\x22\x20must\x20be\x20a\x20string.','\x22expectedTargets\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','(or\x20its\x20controller)\x20used\x20to\x20invoke.','3747872LFSblH','16574mPkoCS','getAllowedActions','LlUzF','_runBaseProofValidation','isController','KmUsT','zfZzd','created','50730972mcjtlG','\x22invocationTarget\x22\x20must\x20be\x20a\x20string\x20that\x20expresses\x20an\x20absolute\x20','HrWOI','cWfsk','Parameters\x20for\x20both\x20creating\x20and\x20verifying\x20a\x20proof\x20must\x20not\x20be\x20','\x22capability\x22\x20must\x20be\x20a\x20string\x20if\x20it\x20is\x20a\x20root\x20capability.','nNtZC','KheMC'];_0x463a=function(){return _0x486a9a;};return _0x463a();}function _0x5925(_0x15a6e6,_0x75fd3d){const _0x463a31=_0x463a();return _0x5925=function(_0x5925d8,_0x491475){_0x5925d8=_0x5925d8-0xe1;let _0x1d1071=_0x463a31[_0x5925d8];return _0x1d1071;},_0x5925(_0x15a6e6,_0x75fd3d);}import{CapabilityProofPurpose}from'./CapabilityProofPurpose.js';import*as _0x17b83b from'./utils.js';export class CapabilityInvocation extends CapabilityProofPurpose{constructor({capability:_0x1e48c5,capabilityAction:_0x513aee,invocationTarget:_0x1220f7,allowTargetAttenuation:_0x516ca1,controller:_0x1ec53d,date:_0x1d5ece,expectedAction:_0x269276,expectedRootCapability:_0x761675,expectedTarget:_0x5b54e9,inspectCapabilityChain:_0x210fa9,maxChainLength:_0x227cd1,maxClockSkew:_0x3f266e,maxDelegationTtl:_0x2b3641,maxTimestampDelta:_0x3a0f11,suite:_0x13205a}={}){const _0x3b1d83=_0x5925,_0x51f92c={'cPstJ':function(_0x2e82d5,_0x246073){return _0x2e82d5+_0x246073;},'urUnm':function(_0xf1df37,_0x53eba9){return _0xf1df37&&_0x53eba9;},'gnZrw':'capabilityInvocation','KFeWo':_0x3b1d83(0x11e),'IUXKB':_0x3b1d83(0xfc),'TTESc':_0x3b1d83(0x110),'nNtZC':'\x22capabilityAction\x22\x20must\x20be\x20a\x20string.','IibKn':function(_0x393d58,_0x17f513){return _0x393d58===_0x17f513;},'MICpH':function(_0xdc2d56,_0x917096){return _0xdc2d56!==_0x917096;},'gEVlQ':function(_0x3d0d34,_0x5f1d8f){return _0x3d0d34===_0x5f1d8f;}},_0x5dbef4=_0x1e48c5||_0x513aee||_0x1220f7,_0x455093=_0x1ec53d||_0x1d5ece||_0x269276||_0x761675||_0x5b54e9||_0x210fa9||_0x13205a;if(_0x51f92c['urUnm'](_0x5dbef4,_0x455093))throw new Error(_0x3b1d83(0x111)+'provided\x20together.');super({'allowTargetAttenuation':_0x516ca1,'controller':_0x1ec53d,'date':_0x1d5ece,'expectedRootCapability':_0x761675,'inspectCapabilityChain':_0x210fa9,'maxChainLength':_0x227cd1,'maxClockSkew':_0x3f266e,'maxDelegationTtl':_0x2b3641,'maxTimestampDelta':_0x3a0f11,'suite':_0x13205a,'term':_0x51f92c[_0x3b1d83(0x100)]});if(!_0x455093){if(typeof _0x1e48c5===_0x3b1d83(0xe5)){if(!(_0x1e48c5&&_0x1e48c5['parentCapability']))throw new Error(_0x3b1d83(0x112));}else{if(typeof _0x1e48c5!==_0x51f92c[_0x3b1d83(0x12e)]){if(_0x51f92c[_0x3b1d83(0x125)]!==_0x51f92c[_0x3b1d83(0x11a)])throw new TypeError(_0x3b1d83(0xf6));else throw new _0x501358(_0x51f92c['cPstJ'](_0x3b1d83(0x122)+_0x1690c6+')\x20does\x20not\x20match\x20','capability\x20target\x20('+_0x3b780f+').'));}}if(typeof _0x513aee!==_0x51f92c[_0x3b1d83(0x12e)])throw new TypeError(_0x51f92c[_0x3b1d83(0x113)]);if(!(_0x51f92c[_0x3b1d83(0xe6)](typeof _0x1220f7,_0x51f92c['KFeWo'])&&_0x1220f7['includes'](':')))throw new TypeError(_0x3b1d83(0x10e)+_0x3b1d83(0xe1));this[_0x3b1d83(0x12d)]=_0x1e48c5,this['capabilityAction']=_0x513aee,this['invocationTarget']=_0x1220f7;}else{if(_0x51f92c[_0x3b1d83(0x12f)](typeof _0x269276,_0x51f92c[_0x3b1d83(0x12e)]))throw new TypeError(_0x3b1d83(0x101));if(!(typeof _0x5b54e9===_0x51f92c[_0x3b1d83(0x12e)]||Array[_0x3b1d83(0xe4)](_0x5b54e9)))throw new TypeError(_0x3b1d83(0x124));const _0x5bfc3d=Array[_0x3b1d83(0xe4)](_0x5b54e9)?_0x5b54e9:[_0x5b54e9];for(const _0x2c170c of _0x5bfc3d){if(!(_0x51f92c[_0x3b1d83(0x126)](typeof _0x2c170c,_0x51f92c[_0x3b1d83(0x12e)])&&_0x2c170c[_0x3b1d83(0xec)](':')))throw new Error(_0x3b1d83(0x102));}this[_0x3b1d83(0xef)]=_0x5b54e9,this[_0x3b1d83(0xe8)]=_0x269276;}}async['update'](_0x2b85ac){const _0x17ebb6=_0x5925,{capability:_0x4c81f6,capabilityAction:_0x2e410e,invocationTarget:_0x1a604d}=this;return _0x2b85ac[_0x17ebb6(0x118)]=this[_0x17ebb6(0xe2)],_0x2b85ac[_0x17ebb6(0x12d)]=_0x4c81f6,_0x2b85ac[_0x17ebb6(0xeb)]=_0x1a604d,_0x2b85ac['capabilityAction']=_0x2e410e,_0x2b85ac;}async['match'](_0x1e68b7,{document:_0x582afb,documentLoader:_0x399774}){const _0x4714bf=_0x5925,_0x2c266c={'LlUzF':function(_0x33d45c,_0x381509){return _0x33d45c!==_0x381509;},'ELKWC':function(_0x335793,_0x2b6e29){return _0x335793===_0x2b6e29;}},{expectedAction:_0x461d6d,expectedTarget:_0x5ccb3e}=this;try{if(_0x2c266c[_0x4714bf(0x107)](_0x4714bf(0x135),'wwbuP'))_0x17b83b['checkProofContext']({'proof':_0x1e68b7});else throw new _0x5f41a7(_0x4714bf(0xf6));}catch(_0x4f8f84){return![];}if(!_0x1e68b7['capability'])return![];if(!(await super['match'](_0x1e68b7,{'document':_0x582afb,'documentLoader':_0x399774})&&_0x461d6d===_0x1e68b7[_0x4714bf(0x11b)]))return![];if(Array[_0x4714bf(0xe4)](_0x5ccb3e))return _0x5ccb3e['includes'](_0x1e68b7['invocationTarget']);return _0x2c266c[_0x4714bf(0xf7)](_0x5ccb3e,_0x1e68b7['invocationTarget']);}[_0x395ed1(0x121)](){return CapabilityDelegation;}['_getTailCapability']({proof:_0x387d3c}){const _0x591e43=_0x395ed1;return{'capability':_0x387d3c[_0x591e43(0x12d)]};}async[_0x395ed1(0xea)]({dereferencedChain:_0x5e13b7,proof:_0x253393}){const _0x114656=_0x395ed1,_0x339178={'zfZzd':_0x114656(0xe9),'fZCtn':function(_0x523c08,_0x6090a1){return _0x523c08>_0x6090a1;},'treYl':function(_0x4d7a4e,_0x5dbc3c){return _0x4d7a4e+_0x5dbc3c;},'mgrqy':function(_0x58d856,_0xee0a5e){return _0x58d856+_0xee0a5e;},'inmnd':function(_0x5dabe4,_0x2450c4){return _0x5dabe4!==_0x2450c4;},'HrWOI':_0x114656(0x11e),'vXLWg':_0x114656(0x133),'KlOMF':'jkEEA','KmUsT':_0x114656(0x11c),'vWcxq':function(_0x24cd2d,_0x4b7c94){return _0x24cd2d+_0x4b7c94;}},{allowTargetAttenuation:_0x4bc43f,expectedAction:_0x326f01,expectedTarget:_0x1a8565}=this,_0x1b4e09=_0x5e13b7[_0x5e13b7[_0x114656(0xf3)]-0x1],{capabilityAction:_0x15738a}=_0x253393,_0x152c49=_0x17b83b[_0x114656(0x106)]({'capability':_0x1b4e09});if(_0x339178['fZCtn'](_0x152c49[_0x114656(0xf3)],0x0)&&!_0x152c49[_0x114656(0xec)](_0x15738a))throw new Error(_0x339178[_0x114656(0xfd)](_0x339178[_0x114656(0x116)]('Capability\x20action\x20\x22'+_0x15738a+_0x114656(0x129),_0x114656(0x12a)),_0x152c49[_0x114656(0xf8)](_0x12f744=>'\x22'+_0x12f744+'\x22')['join'](',\x20')));if(_0x339178[_0x114656(0x11f)](_0x15738a,_0x326f01))throw new Error(_0x114656(0x127)+_0x15738a+_0x114656(0x120)+(_0x114656(0xe3)+_0x326f01+'\x22.'));const _0x2dcafd=_0x17b83b['getTarget']({'capability':_0x1b4e09}),{invocationTarget:_0x29ffa7}=_0x253393;if(!(typeof _0x29ffa7===_0x339178['HrWOI']&&_0x29ffa7[_0x114656(0xec)](':')))throw new TypeError(_0x114656(0x122)+_0x29ffa7+_0x114656(0x12c)+_0x339178[_0x114656(0x134)]);if(!_0x17b83b[_0x114656(0x130)]({'invocationTarget':_0x29ffa7,'baseInvocationTarget':_0x2dcafd,'allowTargetAttenuation':_0x4bc43f})){if(_0x339178[_0x114656(0xfb)]!=='jkEEA'){if(!(_0x3427d6&&_0x4aaf16['parentCapability']))throw new _0x1e87cf(_0x114656(0x112));}else throw new Error(_0x114656(0x122)+_0x29ffa7+')\x20does\x20not\x20match\x20'+('capability\x20target\x20('+_0x2dcafd+').'));}if(!(Array['isArray'](_0x1a8565)&&_0x1a8565[_0x114656(0xec)](_0x29ffa7)||typeof _0x1a8565===_0x339178[_0x114656(0x10f)]&&_0x29ffa7===_0x1a8565))throw new Error(_0x114656(0xf2)+_0x1a8565+_0x114656(0xf5)+(_0x114656(0x119)+_0x29ffa7+').'));if(_0x1b4e09[_0x114656(0xf9)]){const _0x2cdb2b=Date['parse'](_0x253393[_0x114656(0x10c)]),[_0x4e117a]=_0x17b83b['getDelegationProofs']({'capability':_0x1b4e09}),_0x6656fa=Date['parse'](_0x4e117a['created']),{maxClockSkew:_0x287158}=this;if(_0x17b83b['compareTime']({'t1':_0x2cdb2b,'t2':_0x6656fa,'maxClockSkew':_0x287158})<0x0){if(_0x114656(0x117)!==_0x339178[_0x114656(0x10a)])throw new Error(_0x339178[_0x114656(0x128)](_0x114656(0x136),_0x339178[_0x114656(0x10b)]));else throw new _0x53bdd6(_0x114656(0x136)+_0x339178[_0x114656(0x10b)]);}}return{'capabilityChainMeta':[]};}async[_0x395ed1(0xf0)]({dereferencedChain:_0x2d5624,proof:_0x10e473,validateOptions:_0x5f083a}){const _0x334257=_0x395ed1,_0x358a8c={'KheMC':function(_0x2e1b48,_0x5b67eb){return _0x2e1b48-_0x5b67eb;},'lRkRx':function(_0x5a151f,_0x50045d){return _0x5a151f+_0x50045d;},'PArzX':_0x334257(0x103)},_0x1d73c7=_0x2d5624[_0x358a8c[_0x334257(0x114)](_0x2d5624[_0x334257(0xf3)],0x1)],{verificationMethod:_0x337991}=_0x5f083a;if(!_0x17b83b[_0x334257(0x109)]({'capability':_0x1d73c7,'verificationMethod':_0x337991})){const _0x50dc76=new Error(_0x358a8c['lRkRx']('The\x20capability\x20controller\x20does\x20not\x20match\x20the\x20verification\x20method\x20',_0x358a8c[_0x334257(0x115)]));_0x50dc76[_0x334257(0xff)]={'capability':_0x1d73c7,'verificationMethod':_0x337991};throw _0x50dc76;}const _0x559d74=await this[_0x334257(0x108)]({'proof':_0x10e473,'validateOptions':_0x5f083a});if(!_0x559d74[_0x334257(0xf1)])throw _0x559d74[_0x334257(0x132)];return _0x559d74['invoker']=_0x559d74[_0x334257(0x131)],_0x559d74;}}