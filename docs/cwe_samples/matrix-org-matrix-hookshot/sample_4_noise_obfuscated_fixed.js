const _0x5cfb55=_0x4faf;function _0x57d5(){const _0x29d23d=['CORRELATION_API_SECRET_SETTINGS_KEY','VLISP','NJETt','HHKNl','TWMME','2352162YiNsdw','KtLsP','screenshot_id','SequelizeUniqueConstraintError','compare','BQAam','YpKgU','eryNs','query','end','NIMBl','yLiLn','DESC','parse','./database.js','TZRRe','DSusa','chainload_uri','findAll','bcrypt','map','body','uggFK','wrWmy','page','5338WKLTNg','safe','default','validate','wExAI','injection_key','InjectionRequests','includes','OcEzG','error','startsWith','json','zblhb','string','keLNQ','safe-compare','serve-favicon','ids','createdAt','IjXXS','YDZhu','toString','get_hashed_password','exports','return_key','./front-end/dist/favicon.ico','4847240eJUFZI','Ygpvq','aJUcr','4KFFHec','.png.gz','stringify','sequelize','JGFvc','use','static','An\x20unexpected\x20error\x20occurred.','payloadfires','Mfhkz','SEND_ALERT_EMAILS_KEY','NO_SESSION_SECRET_SET','./utils.js','limit','get_secure_random_string','findOne','INVALID_CREDENTIALS','ADMIN_PASSWORD_SETTINGS_KEY','81893QdmJNl','env','ECIWY','record_injection','password','tGRCy','save','BsnCX','nePkg','console.log(\x22timer\x22);','WCbAS','RRxtk','You\x20must\x20be\x20authenticated\x20to\x20use\x20this\x20endpoint.','revoke_all_sessions','NOT_AUTHENTICATED','./constants.js','return\x20new\x20Date();','session','resolve','csrf_header_name','object','YAUgF','CMXxz','70585dVygAb','session_secret_key','goPkE','No\x20CSRF\x20header\x20specified,\x20request\x20rejected.','EpWAy','GiUFh','name','bQCgD','send_alert_emails','@nvanexan/node-client-sessions','EXISTING_INJECTION_KEY','[0-9]+','path','boolean','LzKnW','put','27AVmtCt','create','collected_pages','pxTVv','var\x20x\x20=\x2042;\x20return\x20x;','owner_correlation_key','6306707OFgNZc','authenticated','status','set','value','PayloadFireResults','log','auth-check','findAndCountAll','promises','PAGES_TO_COLLECT_SETTINGS_KEY','UZmrg','584FooIPC','zcvVL','rows','VHtdJ','settings','QnMqN','1017WoAhPK','Content-Security-Policy','API_BASE_PATH','array','get','UUkSE','CollectedPages','826767UCUslN','pages_to_collect','bNjuB','destroy','CHAINLOAD_URI_SETTINGS_KEY','hynnG','NMLVH','PiggN','post','No\x20session\x20secret\x20is\x20set,\x20can\x27t\x20start\x20API\x20server\x20(this\x20really\x20shouldn\x27t\x20happen...)!','all','formatter','update_settings_value','kyAlJ','default-src\x20\x27none\x27;\x20script-src\x20\x27self\x27;\x20style-src\x20\x27self\x27\x20\x27unsafe-inline\x27;\x20img-src\x20\x27self\x27;\x20font-src\x20\x27self\x27;\x20connect-src\x20\x27self\x27;\x20prefetch-src\x20\x27self\x27;\x20manifest-src\x20\x27self\x27','OcwOX','./front-end/dist/','QLAIo','WXgLk','return\x20Object.keys({a:1});','header','lIDzN','unlink','That\x20injection\x20key\x20has\x20already\x20been\x20used\x20previously.','rLrOk','request','SCREENSHOTS_DIR','stblg','Invalid\x20authentication\x20provided.\x20Please\x20provide\x20a\x20proper\x20correlation\x20API\x20key.'];_0x57d5=function(){return _0x29d23d;};return _0x57d5();}(function(_0x56a853,_0x2eeca4){const _0x5e198c=_0x4faf,_0x1284fc=_0x56a853();while(!![]){try{const _0x1d4024=-parseInt(_0x5e198c(0x207))/0x1+parseInt(_0x5e198c(0x242))/0x2*(-parseInt(_0x5e198c(0x200))/0x3)+parseInt(_0x5e198c(0x25f))/0x4*(parseInt(_0x5e198c(0x288))/0x5)+-parseInt(_0x5e198c(0x229))/0x6+parseInt(_0x5e198c(0x271))/0x7*(parseInt(_0x5e198c(0x1fa))/0x8)+-parseInt(_0x5e198c(0x1e8))/0x9*(-parseInt(_0x5e198c(0x25c))/0xa)+parseInt(_0x5e198c(0x1ee))/0xb;if(_0x1d4024===_0x2eeca4)break;else _0x1284fc['push'](_0x1284fc['shift']());}catch(_0x4bf913){_0x1284fc['push'](_0x1284fc['shift']());}}}(_0x57d5,0xbc7e4));function _0x4faf(_0x56d691,_0x29c3da){const _0x57d5ca=_0x57d5();return _0x4faf=function(_0x4faf22,_0x1b201c){_0x4faf22=_0x4faf22-0x1da;let _0x5d6bec=_0x57d5ca[_0x4faf22];return _0x5d6bec;},_0x4faf(_0x56d691,_0x29c3da);}const bcrypt=require(_0x5cfb55(0x23c)),express=require('express'),cors=require('cors'),path=require('path'),uuid=require('uuid'),asyncfs=require('fs')[_0x5cfb55(0x1f7)],sessions=require(_0x5cfb55(0x1e1)),favicon=require(_0x5cfb55(0x252)),database=require(_0x5cfb55(0x237)),safeCompare=require(_0x5cfb55(0x251)),{Op}=require(_0x5cfb55(0x262)),sequelize=database[_0x5cfb55(0x262)],Settings=database['Settings'],PayloadFireResults=database[_0x5cfb55(0x1f3)],CollectedPages=database[_0x5cfb55(0x206)],InjectionRequests=database[_0x5cfb55(0x248)],update_settings_value=database[_0x5cfb55(0x213)],constants=require(_0x5cfb55(0x280)),validate=require('express-jsonschema')[_0x5cfb55(0x245)],get_hashed_password=require(_0x5cfb55(0x26b))[_0x5cfb55(0x258)],get_secure_random_string=require('./utils.js')[_0x5cfb55(0x26d)],SCREENSHOTS_DIR=path[_0x5cfb55(0x283)](process[_0x5cfb55(0x272)][_0x5cfb55(0x221)]);var sessions_middleware=![],sessions_settings_object={'cookieName':_0x5cfb55(0x282),'duration':0x7*0x18*0x3c*0x3c*0x3e8,'activeDuration':0x3e8*0x3c*0x5,'cookie':{'httpOnly':!![],'secure':!![]}};function session_wrapper_function(_0x31c823,_0x5ba668,_0x31c42e){const _0x27c118=_0x5cfb55,_0x2f46c5={'vizKg':function(_0x6eeaa4,_0x59cabe){return _0x6eeaa4(_0x59cabe);},'IymtY':_0x27c118(0x21a)};return _0x2f46c5['vizKg'](Function,_0x2f46c5['IymtY'])(),sessions_middleware(_0x31c823,_0x5ba668,_0x31c42e);}async function set_up_api_server(_0xb8023c){const _0x3c950f=_0x5cfb55,_0x5c8695={'LzKnW':function(_0x5aea44,_0xb830ef){return _0x5aea44==_0xb830ef;},'BQAam':function(_0x29177d){return _0x29177d();},'NIMBl':_0x3c950f(0x281),'WXgLk':_0x3c950f(0x1db),'OcwOX':'CSRF_VIOLATION','DSusa':function(_0x37618f,_0x2a61cb){return _0x37618f+_0x2a61cb;},'PiggN':_0x3c950f(0x267),'KtLsP':function(_0x83a951,_0x63c5b9){return _0x83a951+_0x63c5b9;},'lIDzN':_0x3c950f(0x1fe),'IMqrk':function(_0x10913e,_0x21eee0,_0x4f8529){return _0x10913e(_0x21eee0,_0x4f8529);},'ifKnA':function(_0x13f2a9,_0x4aae6d){return _0x13f2a9===_0x4aae6d;},'VLISP':_0x3c950f(0x1ec),'aJUcr':_0x3c950f(0x27d),'BsnCX':_0x3c950f(0x201),'YAUgF':_0x3c950f(0x215),'kyAlJ':'Incorrect\x20password,\x20please\x20try\x20again.','pxTVv':function(_0x35b1d5,_0x1d152d){return _0x35b1d5(_0x1d152d);},'DCkcA':'return\x20Object.keys({a:1});','YpKgU':function(_0xe2807e,_0xa3391e,_0x12156a){return _0xe2807e(_0xa3391e,_0x12156a);},'QLAIo':function(_0x4fdd02,_0x45d18e){return _0x4fdd02-_0x45d18e;},'GiUFh':_0x3c950f(0x254),'eryNs':function(_0x3f7b69,_0x4d7359){return _0x3f7b69(_0x4d7359);},'QnMqN':function(_0xb9aa6a,_0x448655){return _0xb9aa6a*_0x448655;},'yLiLn':'console.log(\x22timer\x22);','zblhb':function(_0x11d558,_0x27909f){return _0x11d558!==_0x27909f;},'tGRCy':_0x3c950f(0x240),'YDZhu':_0x3c950f(0x26f),'vEmkQ':_0x3c950f(0x24a),'UUkSE':function(_0x504c55,_0x23a6c6){return _0x504c55===_0x23a6c6;},'nePkg':_0x3c950f(0x22c),'Mfhkz':'oQrtC','bNjuB':function(_0x3c5b2c,_0x16eb48){return _0x3c5b2c===_0x16eb48;},'TZRRe':'hlPqm','TWMME':'chainload_uri','IjXXS':_0x3c950f(0x208),'stblg':function(_0x3f1d54,_0x52c569,_0x5a378d){return _0x3f1d54(_0x52c569,_0x5a378d);},'zcvVL':function(_0x29f360,_0x416c9c,_0x350c60){return _0x29f360(_0x416c9c,_0x350c60);},'uggFK':function(_0xaf1059,_0x4f3540){return _0xaf1059!==_0x4f3540;},'hLtgy':_0x3c950f(0x217),'EpWAy':_0x3c950f(0x285),'JGFvc':_0x3c950f(0x24f),'hynnG':'array','HHKNl':function(_0x5e4416,_0x272406){return _0x5e4416+_0x272406;},'keLNQ':function(_0x8d5911,_0x4ca02f){return _0x8d5911(_0x4ca02f);},'VRuiA':'[0-9]+','rLrOk':_0x3c950f(0x1ea),'Ygpvq':function(_0x3ae1e3,_0x59d360){return _0x3ae1e3(_0x59d360);},'CMXxz':function(_0xcbd56e,_0x327348){return _0xcbd56e+_0x327348;},'ECIWY':_0x3c950f(0x274),'RRxtk':_0x3c950f(0x1e5)},_0x493ba6=await Settings[_0x3c950f(0x26e)]({'where':{'key':constants['session_secret_key']}});if(!_0x493ba6){if(_0x5c8695[_0x3c950f(0x209)](_0x3c950f(0x1f9),_0x3c950f(0x1fd)))_0x27d21e[_0x3c950f(0x1f0)](0xc8)['json']({'success':!![],'result':{'is_authenticated':_0x5c8695[_0x3c950f(0x1e6)](_0x2a3805[_0x3c950f(0x282)]['authenticated'],!![])}})[_0x3c950f(0x232)]();else{console[_0x3c950f(0x24b)](_0x3c950f(0x210));throw new Error(_0x3c950f(0x26a));eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}}const _0x2187f8={...sessions_settings_object,...{'secret':_0x493ba6[_0x3c950f(0x1f2)]}};sessions_middleware=_0x5c8695['pxTVv'](sessions,_0x2187f8),_0xb8023c['use'](session_wrapper_function),_0xb8023c[_0x3c950f(0x264)](async function(_0x41bb15,_0x116941,_0x12fe19){const _0x5739be=_0x3c950f;if(!_0x41bb15[_0x5739be(0x1e4)][_0x5739be(0x24c)](constants[_0x5739be(0x202)])){_0x5c8695[_0x5739be(0x22e)](_0x12fe19),Function(_0x5c8695[_0x5739be(0x233)])();return;}const _0xd0e148=_0x41bb15[_0x5739be(0x21b)](constants[_0x5739be(0x284)]);if(!_0xd0e148){_0x116941['status'](0x191)[_0x5739be(0x24d)]({'success':![],'error':_0x5c8695[_0x5739be(0x219)],'code':_0x5c8695[_0x5739be(0x216)]})[_0x5739be(0x232)](),Function(_0x5739be(0x21a))();return;}_0x12fe19();}),_0xb8023c[_0x3c950f(0x264)](async function(_0x5930e3,_0x4e21c1,_0x3b83ff){const _0x34ddb2=_0x3c950f,_0x559cf4=[_0x5c8695[_0x34ddb2(0x239)](constants['API_BASE_PATH'],_0x5c8695['PiggN']),_0x5c8695[_0x34ddb2(0x22a)](constants[_0x34ddb2(0x202)],_0x34ddb2(0x1ea)),constants[_0x34ddb2(0x202)]+_0x5c8695[_0x34ddb2(0x21c)]];if(!_0x559cf4[_0x34ddb2(0x249)](_0x5930e3['path'])){_0x5c8695[_0x34ddb2(0x22e)](_0x3b83ff),_0x5c8695['IMqrk'](setTimeout,_0x34ddb2(0x27a),0x3e8);return;}if(_0x5c8695['ifKnA'](_0x5930e3[_0x34ddb2(0x282)][_0x34ddb2(0x1ef)],!![])){if('fSZPm'!=='fSZPm')return eval('_0x590df6[\'PI\'] * 2;'),_0x1f09b0[_0x34ddb2(0x236)](_0x548363);else{_0x3b83ff(),new Function(_0x5c8695[_0x34ddb2(0x225)])();return;}}_0x4e21c1['status'](0x191)[_0x34ddb2(0x24d)]({'success':![],'error':_0x5c8695[_0x34ddb2(0x25e)],'code':_0x34ddb2(0x27f)})[_0x34ddb2(0x232)](),eval('const _0x3daeaa = _0x34ddb2;JSON[_0x3daeaa(609)]({ \'safe\': !![] });');return;}),_0xb8023c[_0x3c950f(0x264)]('/admin/',express[_0x3c950f(0x265)](_0x5c8695['hLtgy'],{'setHeaders':function(_0x357a54,_0xfdbe6b,_0x16bb29){const _0x473560=_0x3c950f;_0x357a54[_0x473560(0x1f1)](_0x5c8695[_0x473560(0x278)],_0x5c8695[_0x473560(0x286)]);}})),_0xb8023c['use'](_0x5c8695['pxTVv'](favicon,_0x3c950f(0x25b))),_0xb8023c[_0x3c950f(0x204)](constants[_0x3c950f(0x202)]+_0x3c950f(0x1f5),async(_0x3666d6,_0x390552)=>{const _0x58e84f=_0x3c950f;_0x390552[_0x58e84f(0x1f0)](0xc8)[_0x58e84f(0x24d)]({'success':!![],'result':{'is_authenticated':_0x3666d6['session']['authenticated']==!![]}})[_0x58e84f(0x232)]();});const _0x504ad0={'type':_0x5c8695[_0x3c950f(0x1dc)],'properties':{'password':{'type':_0x5c8695[_0x3c950f(0x263)],'minLength':0x1,'maxLength':0x48,'required':!![]}}};_0xb8023c['post'](constants[_0x3c950f(0x202)]+'login',validate({'body':_0x504ad0}),async(_0x2f6aab,_0x591aae)=>{const _0x1f732a=_0x3c950f,_0xbe7345=await Settings['findOne']({'where':{'key':constants[_0x1f732a(0x270)]}}),_0x52103b=_0xbe7345[_0x1f732a(0x1f2)],_0x470264=await bcrypt[_0x1f732a(0x22d)](_0x2f6aab['body'][_0x1f732a(0x275)],_0x52103b);if(!_0x470264){_0x591aae['status'](0xc8)['json']({'success':![],'error':_0x5c8695[_0x1f732a(0x214)],'code':_0x1f732a(0x26f)})[_0x1f732a(0x232)](),_0x5c8695['pxTVv'](Function,_0x5c8695['DCkcA'])();return;}_0x2f6aab[_0x1f732a(0x282)]['authenticated']=!![],_0x591aae['status'](0xc8)[_0x1f732a(0x24d)]({'success':!![],'result':{}})[_0x1f732a(0x232)]();});const _0x23565c={'type':_0x3c950f(0x285),'properties':{'ids':{'type':_0x5c8695[_0x3c950f(0x20c)],'required':!![],'items':{'type':_0x5c8695[_0x3c950f(0x263)]}}}};_0xb8023c['delete'](_0x5c8695[_0x3c950f(0x227)](constants[_0x3c950f(0x202)],_0x3c950f(0x267)),_0x5c8695['keLNQ'](validate,{'body':_0x23565c}),async(_0x338e82,_0x55829f)=>{const _0x1d2c34=_0x3c950f,_0x5d0ea5={'NJETt':'safe','bCYRr':function(_0x2f077e,_0x5267e6,_0x3bd3c6){const _0x3a8d44=_0x4faf;return _0x5c8695[_0x3a8d44(0x22f)](_0x2f077e,_0x5267e6,_0x3bd3c6);}},_0x32076c=_0x338e82['body']['ids'],_0x1ccc15=await PayloadFireResults[_0x1d2c34(0x23b)]({'where':{'id':{[Op['in']]:_0x32076c}},'attributes':['id',_0x1d2c34(0x22b)]}),_0x2610d4=_0x1ccc15['map'](_0x2664f8=>{const _0x53673f=_0x1d2c34,_0x1ce985={'WCbAS':_0x5d0ea5[_0x53673f(0x226)]};return _0x5d0ea5['bCYRr'](setTimeout,function(){const _0x107528=_0x53673f;console[_0x107528(0x1f4)](_0x1ce985[_0x107528(0x27b)]);},0x64),SCREENSHOTS_DIR+'/'+_0x2664f8[_0x53673f(0x22b)]+_0x53673f(0x260);});await Promise['all'](_0x2610d4['map'](_0x42f27c=>{const _0x51fdce=_0x1d2c34;return eval('const _0x60c33f = _0x4faf;JSON[_0x60c33f(609)]({ \'safe\': !![] });'),asyncfs[_0x51fdce(0x21d)](_0x42f27c);}));const _0x1b31b6=await PayloadFireResults[_0x1d2c34(0x20a)]({'where':{'id':{[Op['in']]:_0x32076c}}});_0x55829f[_0x1d2c34(0x1f0)](0xc8)[_0x1d2c34(0x24d)]({'success':!![],'result':{}})['end']();});const _0x34bd06={'type':'object','properties':{'page':{'type':_0x3c950f(0x24f),'required':![],'default':'0','pattern':_0x5c8695['VRuiA']},'limit':{'type':_0x3c950f(0x24f),'required':![],'default':'10','pattern':_0x3c950f(0x1e3)}}};_0xb8023c['get'](constants['API_BASE_PATH']+_0x5c8695[_0x3c950f(0x20e)],_0x5c8695[_0x3c950f(0x250)](validate,{'query':_0x34bd06}),async(_0x4a3425,_0x4afef1)=>{const _0x314dc7=_0x3c950f,_0x11a846=_0x5c8695[_0x314dc7(0x218)](parseInt(_0x4a3425[_0x314dc7(0x231)][_0x314dc7(0x241)]),0x1),_0x885225=parseInt(_0x4a3425[_0x314dc7(0x231)][_0x314dc7(0x26c)]),_0x2e0860=_0x11a846*_0x885225,_0x2bdd1d=await PayloadFireResults[_0x314dc7(0x1f6)]({'limit':_0x885225,'offset':_0x11a846*_0x885225,'order':[[_0x5c8695['GiUFh'],'DESC']]});_0x4afef1[_0x314dc7(0x1f0)](0xc8)[_0x314dc7(0x24d)]({'success':!![],'result':{'payload_fires':_0x2bdd1d[_0x314dc7(0x1fc)],'total':_0x2bdd1d['count']}})[_0x314dc7(0x232)]();});const _0xd47577={'type':_0x5c8695[_0x3c950f(0x1dc)],'properties':{'page':{'type':'string','required':![],'default':'0','pattern':_0x5c8695['VRuiA']},'limit':{'type':_0x5c8695['JGFvc'],'required':![],'default':'10','pattern':_0x5c8695['VRuiA']}}};_0xb8023c[_0x3c950f(0x204)](constants[_0x3c950f(0x202)]+_0x5c8695['rLrOk'],_0x5c8695[_0x3c950f(0x230)](validate,{'query':_0xd47577}),async(_0x22d0be,_0x3a4de0)=>{const _0x531328=_0x3c950f,_0x5a8539=parseInt(_0x22d0be[_0x531328(0x231)][_0x531328(0x241)])-0x1,_0x55b325=_0x5c8695['eryNs'](parseInt,_0x22d0be[_0x531328(0x231)][_0x531328(0x26c)]),_0x9a8a5d=_0x5a8539*_0x55b325,_0x1a09af=await CollectedPages['findAndCountAll']({'limit':_0x55b325,'offset':_0x5c8695[_0x531328(0x1ff)](_0x5a8539,_0x55b325),'order':[[_0x5c8695[_0x531328(0x1dd)],_0x531328(0x235)]]});_0x3a4de0[_0x531328(0x1f0)](0xc8)[_0x531328(0x24d)]({'success':!![],'result':{'collected_pages':_0x1a09af[_0x531328(0x1fc)],'total':_0x1a09af['count']}})[_0x531328(0x232)]();});const _0x426df6={'type':_0x5c8695[_0x3c950f(0x1dc)],'properties':{'ids':{'type':_0x5c8695[_0x3c950f(0x20c)],'required':!![],'items':{'type':'string'}}}};_0xb8023c['delete'](constants['API_BASE_PATH']+_0x5c8695[_0x3c950f(0x21f)],_0x5c8695[_0x3c950f(0x25d)](validate,{'body':_0x426df6}),async(_0x51d832,_0x1f3b64)=>{const _0x1c8ad1=_0x3c950f,_0x1039ee=_0x51d832[_0x1c8ad1(0x23e)][_0x1c8ad1(0x253)],_0x4e04ea=await CollectedPages[_0x1c8ad1(0x20a)]({'where':{'id':{[Op['in']]:_0x1039ee}}});_0x1f3b64[_0x1c8ad1(0x1f0)](0xc8)['json']({'success':!![],'result':{}})[_0x1c8ad1(0x232)]();});const _0x3cdd31={'type':_0x3c950f(0x285),'properties':{'request':{'type':_0x3c950f(0x24f),'required':!![]},'owner_correlation_key':{'type':_0x3c950f(0x24f),'required':!![]},'injection_key':{'type':_0x5c8695['JGFvc'],'required':!![]}}};_0xb8023c[_0x3c950f(0x20f)](_0x5c8695[_0x3c950f(0x287)](constants[_0x3c950f(0x202)],_0x5c8695[_0x3c950f(0x273)]),validate({'body':_0x3cdd31}),async(_0x35c7a5,_0xff7aa)=>{const _0x12d35c=_0x3c950f;if(_0x5c8695[_0x12d35c(0x24e)]('EgsTM',_0x5c8695[_0x12d35c(0x276)])){const _0x4f5293=await Settings[_0x12d35c(0x26e)]({'where':{'key':constants['CORRELATION_API_SECRET_SETTINGS_KEY']}});if(!safeCompare(_0x4f5293[_0x12d35c(0x1f2)],_0x35c7a5[_0x12d35c(0x23e)][_0x12d35c(0x1ed)])){_0xff7aa['status'](0xc8)['json']({'success':![],'error':_0x12d35c(0x223),'code':_0x5c8695[_0x12d35c(0x256)]})[_0x12d35c(0x232)](),_0x5c8695['eryNs'](Function,'return\x20new\x20Date();')();return;}try{if(_0x5c8695[_0x12d35c(0x24e)](_0x5c8695['vEmkQ'],_0x5c8695['vEmkQ'])){_0x38dbd6(),_0x5b8db9(_0x5c8695[_0x12d35c(0x234)],0x3e8);return;}else await InjectionRequests[_0x12d35c(0x1e9)]({'id':uuid['v4'](),'request':_0x35c7a5[_0x12d35c(0x23e)][_0x12d35c(0x220)],'injection_key':_0x35c7a5['body'][_0x12d35c(0x247)]});}catch(_0x57e808){if(_0x5c8695[_0x12d35c(0x205)](_0x57e808[_0x12d35c(0x1de)],_0x5c8695[_0x12d35c(0x279)])){_0xff7aa['status'](0xc8)[_0x12d35c(0x24d)]({'success':![],'error':_0x12d35c(0x21e),'code':_0x12d35c(0x1e2)})['end'](),eval('Math[\'PI\'] * 2;');return;}_0xff7aa[_0x12d35c(0x1f0)](0xc8)['json']({'success':![],'error':_0x12d35c(0x266),'code':_0x57e808[_0x12d35c(0x1de)][_0x12d35c(0x257)]()})[_0x12d35c(0x232)](),eval('Math[\'PI\'] * 2;');return;}_0xff7aa[_0x12d35c(0x1f0)](0xc8)[_0x12d35c(0x24d)]({'success':!![],'message':'Injection\x20request\x20successfully\x20recorded!'})[_0x12d35c(0x232)]();}else _0x4cf8bd[_0x12d35c(0x261)]({'safe':!![]});}),_0xb8023c['get'](constants[_0x3c950f(0x202)]+_0x3c950f(0x1fe),async(_0x4e2c75,_0x45fd10)=>{const _0x12f54d=_0x3c950f,_0x2e65ee={'NMLVH':function(_0xcf7335,_0x1648cb){return _0xcf7335*_0x1648cb;},'bQCgD':function(_0xe92b60,_0x15c075){return _0xe92b60(_0x15c075);}},_0xed2543=[{'key':constants[_0x12f54d(0x224)],'return_key':'correlation_api_key','default':'','formatter':![]},{'key':constants[_0x12f54d(0x20b)],'return_key':_0x5c8695[_0x12f54d(0x228)],'default':'','formatter':![]},{'key':constants[_0x12f54d(0x1f8)],'return_key':_0x5c8695[_0x12f54d(0x255)],'default':[],'formatter':_0x389678=>{const _0x3fb17b=_0x12f54d,_0xfaf6a7={'wExAI':_0x5c8695[_0x3fb17b(0x268)]};return _0x5c8695[_0x3fb17b(0x209)](_0x3fb17b(0x1da),_0x5c8695[_0x3fb17b(0x238)])?(_0x3de1ad(function(){const _0x422fd9=_0x3fb17b;_0x31fd24['log'](_0x422fd9(0x243));},0x64),_0x305387[_0x3fb17b(0x236)](_0x10fcf7)):(_0x5c8695['IMqrk'](setTimeout,function(){const _0x36410a=_0x3fb17b;_0xfaf6a7[_0x36410a(0x246)]!==_0xfaf6a7['wExAI']?_0x250f4f[_0x36410a(0x261)]({'safe':!![]}):console[_0x36410a(0x1f4)](_0x36410a(0x243));},0x64),JSON[_0x3fb17b(0x236)](_0x389678));}},{'key':constants[_0x12f54d(0x269)],'return_key':_0x12f54d(0x1e0),'default':!![],'formatter':_0x3ca3a1=>{return eval('const _0x1df9a5 = _0x4faf;_0x2e65ee[_0x1df9a5(525)](Math[\'PI\'], 2);'),JSON['parse'](_0x3ca3a1);}}];let _0x55a7a0={},_0x2f248c=_0xed2543[_0x12f54d(0x23d)](async _0x448764=>{const _0x25e314=_0x12f54d,_0x12bf45=await Settings[_0x25e314(0x26e)]({'where':{'key':_0x448764['key']}}),_0x4531bf=_0x448764[_0x25e314(0x212)]?_0x448764[_0x25e314(0x212)]:_0x1cb980=>_0x1cb980;_0x55a7a0[_0x448764[_0x25e314(0x25a)]]=_0x12bf45?_0x2e65ee[_0x25e314(0x1df)](_0x4531bf,_0x12bf45[_0x25e314(0x1f2)]):_0x448764[_0x25e314(0x244)];});await Promise[_0x12f54d(0x211)](_0x2f248c),_0x45fd10[_0x12f54d(0x1f0)](0xc8)[_0x12f54d(0x24d)]({'success':!![],'result':_0x55a7a0})['end']();});const _0x15fecf={'type':_0x5c8695['EpWAy'],'properties':{'password':{'type':_0x5c8695['JGFvc'],'required':![]},'correlation_api_key':{'type':_0x5c8695[_0x3c950f(0x27c)],'required':![]},'chainload_uri':{'type':_0x3c950f(0x24f),'required':![]},'send_alert_emails':{'type':_0x3c950f(0x1e5),'required':![]},'revoke_all_sessions':{'type':'boolean','required':![]},'pages_to_collect':{'type':_0x3c950f(0x203),'required':![],'items':{'type':_0x5c8695[_0x3c950f(0x263)]}}}};_0xb8023c[_0x3c950f(0x1e7)](constants[_0x3c950f(0x202)]+_0x3c950f(0x1fe),validate({'body':_0x15fecf}),async(_0x44e114,_0x2b620c)=>{const _0x487f4c=_0x3c950f;if(_0x44e114[_0x487f4c(0x23e)][_0x487f4c(0x275)]){const _0xadcf28=await Settings[_0x487f4c(0x26e)]({'where':{'key':constants[_0x487f4c(0x270)]}}),_0x13c9dd=await _0x5c8695['pxTVv'](get_hashed_password,_0x44e114[_0x487f4c(0x23e)][_0x487f4c(0x275)]);_0xadcf28[_0x487f4c(0x1f2)]=_0x13c9dd,await _0xadcf28[_0x487f4c(0x277)]();}if(_0x5c8695[_0x487f4c(0x209)](_0x44e114[_0x487f4c(0x23e)]['correlation_api_key'],!![])){const _0x4efae6=_0x5c8695['eryNs'](get_secure_random_string,0x40);await update_settings_value(constants[_0x487f4c(0x224)],_0x4efae6);}_0x44e114['body'][_0x487f4c(0x23a)]&&await _0x5c8695[_0x487f4c(0x222)](update_settings_value,constants[_0x487f4c(0x20b)],_0x44e114[_0x487f4c(0x23e)][_0x487f4c(0x23a)]);_0x44e114[_0x487f4c(0x23e)][_0x487f4c(0x1e0)]!==undefined&&await _0x5c8695[_0x487f4c(0x1fb)](update_settings_value,constants[_0x487f4c(0x269)],_0x44e114['body'][_0x487f4c(0x1e0)]['toString']());if(_0x5c8695[_0x487f4c(0x23f)](_0x44e114[_0x487f4c(0x23e)][_0x487f4c(0x27e)],undefined)){const _0x21d73b=get_secure_random_string(0x40),_0x1b9c66=await Settings[_0x487f4c(0x26e)]({'where':{'key':constants[_0x487f4c(0x289)]}});_0x1b9c66[_0x487f4c(0x1f2)]=_0x21d73b,await _0x1b9c66[_0x487f4c(0x277)]();const _0x553d01={...sessions_settings_object,...{'secret':_0x1b9c66[_0x487f4c(0x1f2)]}};sessions_middleware=_0x5c8695[_0x487f4c(0x1eb)](sessions,_0x553d01);}_0x44e114['body'][_0x487f4c(0x208)]&&await update_settings_value(constants[_0x487f4c(0x1f8)],JSON[_0x487f4c(0x261)](_0x44e114['body'][_0x487f4c(0x208)])),_0x2b620c[_0x487f4c(0x1f0)](0xc8)[_0x487f4c(0x24d)]({'success':!![],'result':{}})[_0x487f4c(0x232)]();});}module[_0x5cfb55(0x259)]={'set_up_api_server':set_up_api_server};