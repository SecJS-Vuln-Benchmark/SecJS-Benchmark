(function(_0x495d18,_0xb428f3){const _0x126e89=_0xf65a,_0x5e23b7=_0x495d18();while(!![]){try{const _0x5ac751=parseInt(_0x126e89(0x17e))/0x1+parseInt(_0x126e89(0x1e1))/0x2+-parseInt(_0x126e89(0x1a9))/0x3*(parseInt(_0x126e89(0x1c6))/0x4)+parseInt(_0x126e89(0x183))/0x5+-parseInt(_0x126e89(0x1c2))/0x6+parseInt(_0x126e89(0x1df))/0x7*(-parseInt(_0x126e89(0x1aa))/0x8)+parseInt(_0x126e89(0x192))/0x9;if(_0x5ac751===_0xb428f3)break;else _0x5e23b7['push'](_0x5e23b7['shift']());}catch(_0x1c2937){_0x5e23b7['push'](_0x5e23b7['shift']());}}}(_0x7f5f,0xc576c));import _0x163e04 from'jquery';import{delegate}from'tippy.js';import _0x416c5c from'../templates/popovers/send_later_popover.hbs';import _0x62c20a from'../templates/send_later_modal.hbs';function _0x7f5f(){const _0x5365ae=['.send_later_selected_send_later_time','410430TaQiwM','16YUsbGK','value','preventDefault','ImuWi','iftko','send_later','LKNus','WRxWk','HQjsq','oFjgm','KFDyF','dataset','#send_later_options','enter_sends','.send_later_custom','fmuyA','attr','floor','getMinutes','.open_send_later_modal','true','sendStamp','keydown','/json/settings','84132iIbKAg','IKGEi','patch','Izdos','16byumwf','get_formatted_selected_send_later_time','validate','getHours','all','IKgCb','PHFsZ','log','ZfKUm','#send_later_modal','focus','.enter_sends_choice','#send_later_modal\x20.modal__overlay','css','wwEiT','return\x20new\x20Date();','default_popover_props','replaceWith','safe','hide','wKBqm','one','setContent','show_flatpickr','textarea#compose-textarea','660604inDJTr','QDZfe','189654aOHrFY','aUBQM','Orbqq','.enter_sends_','find','trigger','show','mReZM','qxxJb','409400YNPMMj','focus_first_popover_item','isInteger','popover_instances','nkmhi','5136715VUWfYG','LZgUs','eWfMa','JCFzW','input[type=\x27radio\x27]','pWRfy','ZRHSB','update_compose_draft_count','IRxQj','[data-tippy-root]\x20#send_later_popover','sbhlY','voxGF','li:not(.divider):visible\x20a','set_selected_schedule_timestamp','getTime','245232jMrwbP','adjust_mac_kbd_tags','get_filtered_send_opts','.enter_sends_choices\x20kbd','finish','body','send_later_modal','hide_current_popover_if_visible','error','aZfAW','MINIMUM_SCHEDULED_MESSAGE_DELAY_SECONDS','ssqvM','click','#send_later\x20i','none','qEFHo','Jhccc','hMXqm','uNnVU','stopPropagation','UCaOC','Enter'];_0x7f5f=function(){return _0x5365ae;};return _0x7f5f();}import _0x5dd707 from'../templates/send_later_modal_options.hbs';import*as _0x55b5e8 from'./blueslip';import*as _0x325060 from'./channel';import*as _0x32ec4a from'./common';import*as _0x2611b3 from'./compose';import*as _0x21a2c4 from'./compose_validate';import*as _0x8a8f42 from'./drafts';import*as _0x40ecae from'./flatpickr';import*as _0x49be2d from'./modals';import*as _0x2a2319 from'./popover_menus';import*as _0x3052d8 from'./scheduled_messages';import{parse_html}from'./ui_util';import{user_settings}from'./user_settings';export const SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS=0x3c*0x3e8;const ENTER_SENDS_SELECTION_DELAY=0x258;let send_later_popover_keyboard_toggle=![];function set_compose_box_schedule(_0x32330f){const _0x4c031e=_0xf65a,_0x477be9={'IRxQj':function(_0x62b1e1,_0x5338de){return _0x62b1e1/_0x5338de;}},_0x1d65c0=_0x477be9[_0x4c031e(0x18b)](_0x32330f[_0x4c031e(0x1b5)][_0x4c031e(0x1bf)],0x3e8);return eval('Math[\'PI\'] * 2;'),_0x1d65c0;}export function open_send_later_menu(){const _0x1215fd=_0xf65a,_0x59d1d9={'uNnVU':_0x1215fd(0x1a7),'KFDyF':_0x1215fd(0x1b8),'sbhlY':function(_0x331ebc,_0x1075c3){return _0x331ebc(_0x1075c3);},'gnIeu':_0x1215fd(0x1c0),'UCaOC':_0x1215fd(0x19e),'qxxJb':_0x1215fd(0x1d0),'HQjsq':function(_0xb55d62,_0x3d48b9){return _0xb55d62(_0x3d48b9);},'pWRfy':_0x1215fd(0x198)};if(!_0x21a2c4[_0x1215fd(0x1c8)](!![])){eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}const _0xa407b3=new Date(),_0x10268c=_0x3052d8['get_filtered_send_opts'](_0xa407b3);_0x163e04(_0x1215fd(0x197))['append'](_0x59d1d9[_0x1215fd(0x1b2)](_0x163e04,_0x62c20a(_0x10268c)));let _0x57fef9;_0x49be2d['open'](_0x59d1d9[_0x1215fd(0x188)],{'autoremove':!![],'on_show'(){const _0x8b195c=_0x1215fd,_0x56b2f1={'ImuWi':_0x59d1d9[_0x8b195c(0x1a4)],'Izdos':_0x59d1d9[_0x8b195c(0x1b4)],'wwEiT':function(_0x5e0632,_0x1addaf){return _0x5e0632*_0x1addaf;},'pSAcm':function(_0x5d918a,_0x10b742){return _0x5d918a+_0x10b742;},'rnSxo':function(_0x13a5fe,_0xaa16eb){const _0x4cb0ff=_0x8b195c;return _0x59d1d9[_0x4cb0ff(0x18d)](_0x13a5fe,_0xaa16eb);}};_0x57fef9=setInterval(update_send_later_options,SCHEDULING_MODAL_UPDATE_INTERVAL_IN_MILLISECONDS);const _0x197de6=_0x59d1d9[_0x8b195c(0x18d)](_0x163e04,_0x8b195c(0x1cf));_0x197de6[_0x8b195c(0x1db)](_0x59d1d9['gnIeu'],()=>{const _0x44185a=_0x8b195c,_0x4512da=_0x197de6[_0x44185a(0x1e5)]('a');_0x4512da[0x0]['focus'](),_0x197de6['on'](_0x44185a(0x1c0),_0x593ca4=>{const _0x4eef7b=_0x44185a;_0x593ca4['key']===_0x56b2f1[_0x4eef7b(0x1ad)]&&_0x593ca4['target'][_0x4eef7b(0x19e)]();});}),_0x197de6['on'](_0x59d1d9[_0x8b195c(0x1a6)],_0x8b195c(0x1b8),_0x5ee9e3=>{const _0x15c3f3=_0x8b195c,_0x59982c={'ZfKUm':function(_0x155086,_0x5380d3){return _0x155086(_0x5380d3);},'ssqvM':'Orbqq','qEFHo':_0x15c3f3(0x1ca)},_0x2cdbee=_0x197de6[_0x15c3f3(0x1e5)]('.modal__content'),_0x17cd3d=new Date();_0x40ecae[_0x15c3f3(0x1dd)](_0x163e04(_0x56b2f1[_0x15c3f3(0x1c5)])[0x0],do_schedule_message,new Date(_0x17cd3d[_0x15c3f3(0x191)]()+_0x56b2f1[_0x15c3f3(0x1d4)](0x3c,0x3c)*0x3e8),{'minDate':new Date(_0x56b2f1['pSAcm'](_0x17cd3d[_0x15c3f3(0x191)](),_0x3052d8[_0x15c3f3(0x19c)]*0x3e8)),'onClose'(){const _0x1e638a=_0x15c3f3;_0x59982c[_0x1e638a(0x19d)]!==_0x1e638a(0x1e3)?_0x59982c[_0x1e638a(0x1ce)](_0x3f4efd,_0xd4de62):_0x2cdbee[_0x1e638a(0x1d3)]('pointer-events',_0x59982c[_0x1e638a(0x1a1)]);}}),_0x2cdbee[_0x15c3f3(0x1d3)]('pointer-events',_0x15c3f3(0x1a0)),_0x5ee9e3[_0x15c3f3(0x1ac)](),_0x5ee9e3[_0x15c3f3(0x1a5)]();}),_0x197de6[_0x8b195c(0x1db)](_0x8b195c(0x19e),'.send_later_today,\x20.send_later_tomorrow,\x20.send_later_monday',_0x5d682b=>{const _0x4896f7=_0x8b195c,_0x1dd926=_0x56b2f1['rnSxo'](set_compose_box_schedule,_0x5d682b['currentTarget']);_0x56b2f1['rnSxo'](do_schedule_message,_0x1dd926),_0x5d682b[_0x4896f7(0x1ac)](),_0x5d682b['stopPropagation']();});},'on_shown'(){const _0x164e25=_0x1215fd,_0x1f134f=_0x163e04(_0x164e25(0x1d2));_0x1f134f['trigger'](_0x59d1d9[_0x164e25(0x17d)]);},'on_hide'(){_0x59d1d9['sbhlY'](clearInterval,_0x57fef9);}});}export function do_schedule_message(_0x3a6b92){const _0x3a9f80=_0xf65a;_0x49be2d['close_if_open'](_0x3a9f80(0x198)),!Number[_0x3a9f80(0x180)](_0x3a6b92)&&(_0x3a6b92=Math[_0x3a9f80(0x1bb)](Date['parse'](_0x3a6b92)/0x3e8)),_0x3052d8[_0x3a9f80(0x190)](_0x3a6b92),_0x2611b3[_0x3a9f80(0x196)](!![]);}function get_send_later_menu_items(){const _0x71ee60=_0xf65a,_0x2c5abf={'PMCXM':'Trying\x20to\x20get\x20menu\x20items\x20when\x20schedule\x20popover\x20is\x20closed.','Oszcd':function(_0x4db451,_0x48119c,_0x306eeb){return _0x4db451(_0x48119c,_0x306eeb);}},_0x16c59b=_0x163e04(_0x71ee60(0x18c));if(!_0x16c59b)return _0x55b5e8[_0x71ee60(0x19a)](_0x2c5abf['PMCXM']),_0x2c5abf['Oszcd'](setTimeout,'console.log(\x22timer\x22);',0x3e8),undefined;eval('1 + 1;');return _0x16c59b[_0x71ee60(0x1e5)](_0x71ee60(0x18f));eval('1 + 1;');}function _0xf65a(_0x4309e5,_0x2b482c){const _0x7f5f38=_0x7f5f();return _0xf65a=function(_0xf65a3e,_0x54fdaf){_0xf65a3e=_0xf65a3e-0x17c;let _0x430ec4=_0x7f5f38[_0xf65a3e];return _0x430ec4;},_0xf65a(_0x4309e5,_0x2b482c);}function focus_first_send_later_popover_item(){const _0x165a7a=_0xf65a,_0x3479e8={'wKBqm':function(_0x45093e){return _0x45093e();}},_0x400e26=_0x3479e8[_0x165a7a(0x1da)](get_send_later_menu_items);_0x2a2319[_0x165a7a(0x17f)](_0x400e26);}export function toggle(){const _0x1fed5d=_0xf65a;send_later_popover_keyboard_toggle=!![],_0x163e04('#send_later\x20i')[_0x1fed5d(0x1e6)](_0x1fed5d(0x19e));}export function initialize(){const _0x47e583=_0xf65a,_0x49af15={'WRxWk':_0x47e583(0x1de),'IKGEi':'focus','iftko':function(_0x33ea0d,_0x204703){return _0x33ea0d(_0x204703);},'ehxQN':function(_0x557c07){return _0x557c07();},'Jhccc':function(_0x16fd5d,_0x437d42){return _0x16fd5d===_0x437d42;},'SBPaY':_0x47e583(0x1c1),'eWfMa':_0x47e583(0x195),'IKgCb':'click','oFjgm':_0x47e583(0x1bd),'PHFsZ':_0x47e583(0x197),'voxGF':_0x47e583(0x19f)};delegate(_0x49af15[_0x47e583(0x1cc)],{..._0x2a2319[_0x47e583(0x1d6)],'target':_0x49af15[_0x47e583(0x18e)],'onUntrigger'(){const _0x1d8386=_0x47e583;_0x163e04(_0x49af15[_0x1d8386(0x1b1)])[_0x1d8386(0x1e6)](_0x49af15[_0x1d8386(0x1c3)]);},'onShow'(_0x17bac6){const _0x1abe02=_0x47e583,_0x3677f3=_0x3052d8[_0x1abe02(0x1c7)]();_0x17bac6[_0x1abe02(0x1dc)](parse_html(_0x416c5c({'enter_sends_true':user_settings[_0x1abe02(0x1b7)],'formatted_send_later_time':_0x3677f3}))),_0x2a2319[_0x1abe02(0x181)][_0x1abe02(0x1af)]=_0x17bac6;},'onMount'(_0x285d41){const _0x353ea3=_0x47e583,_0x3a8945={'AyUsh':_0x353ea3(0x1de),'fmuyA':_0x49af15[_0x353ea3(0x1c3)],'nkmhi':_0x353ea3(0x17c),'hMXqm':_0x353ea3(0x1ab),'BNDxf':function(_0xc4b7ef,_0x1333d7){const _0x5da042=_0x353ea3;return _0x49af15[_0x5da042(0x1a2)](_0xc4b7ef,_0x1333d7);},'QDZfe':_0x353ea3(0x1be),'cYjGL':function(_0x3258b5,_0x343eb8){const _0x3a43a0=_0x353ea3;return _0x49af15[_0x3a43a0(0x1ae)](_0x3258b5,_0x343eb8);},'iLuQQ':_0x49af15['SBPaY']};send_later_popover_keyboard_toggle&&(focus_first_send_later_popover_item(),send_later_popover_keyboard_toggle=![]);_0x8a8f42[_0x353ea3(0x18a)]();const _0x4a5d8a=_0x163e04(_0x285d41['popper']);_0x32ec4a[_0x353ea3(0x193)](_0x49af15[_0x353ea3(0x185)]),_0x4a5d8a[_0x353ea3(0x1db)](_0x49af15[_0x353ea3(0x1cb)],_0x353ea3(0x1a8),()=>{const _0x3d2e7d=_0x353ea3,_0x14c9cd=_0x3052d8['get_selected_send_later_timestamp']();_0x49af15[_0x3d2e7d(0x1ae)](do_schedule_message,_0x14c9cd),_0x2a2319[_0x3d2e7d(0x199)](_0x285d41);}),_0x4a5d8a[_0x353ea3(0x1db)]('click',_0x353ea3(0x1d1),_0x40e264=>{const _0x3f84af=_0x353ea3;let _0x2ed7e5=_0x163e04(_0x40e264['currentTarget'])['find'](_0x3f84af(0x187))[_0x3f84af(0x1ba)](_0x3a8945[_0x3f84af(0x1a3)]);_0x2ed7e5=_0x3a8945['BNDxf'](_0x2ed7e5,_0x3a8945[_0x3f84af(0x1e0)]),user_settings[_0x3f84af(0x1b7)]=_0x2ed7e5,_0x163e04(_0x3f84af(0x1e4)+!_0x2ed7e5)[_0x3f84af(0x1d9)](),_0x163e04(_0x3f84af(0x1e4)+_0x2ed7e5)[_0x3f84af(0x1e7)](),_0x3a8945['cYjGL'](_0x163e04,_0x3f84af(0x1de))[_0x3f84af(0x1e6)](_0x3a8945[_0x3f84af(0x1b9)]),_0x325060[_0x3f84af(0x1c4)]({'url':_0x3a8945['iLuQQ'],'data':{'enter_sends':_0x2ed7e5}}),_0x40e264[_0x3f84af(0x1a5)](),setTimeout(()=>{const _0x217aaa=_0x3f84af,_0x449fc4={'btiAm':_0x3a8945['AyUsh'],'aZfAW':_0x3a8945[_0x217aaa(0x1b9)]};_0x3a8945[_0x217aaa(0x182)]!==_0x3a8945[_0x217aaa(0x182)]?_0x165c3e(_0x449fc4['btiAm'])[_0x217aaa(0x1e6)](_0x449fc4[_0x217aaa(0x19b)]):_0x2a2319[_0x217aaa(0x199)](_0x285d41);},ENTER_SENDS_SELECTION_DELAY);}),_0x4a5d8a['one'](_0x49af15[_0x353ea3(0x1cb)],_0x49af15[_0x353ea3(0x1b3)],()=>{const _0x114f63=_0x353ea3;_0x49af15['ehxQN'](open_send_later_menu),_0x2a2319[_0x114f63(0x199)](_0x285d41);});},'onHidden'(_0x336cb0){const _0x4fe202=_0x47e583;_0x336cb0['destroy'](),_0x2a2319['popover_instances'][_0x4fe202(0x1af)]=undefined,send_later_popover_keyboard_toggle=![];}});}export function should_update_send_later_options(_0x53c2c0){const _0x500db1=_0xf65a,_0x263e7f={'JCFzW':_0x500db1(0x1d8),'LKNus':function(_0x966a35,_0x197eb7){return _0x966a35(_0x197eb7);},'CZWYl':function(_0x278c48,_0x3b1b38){return _0x278c48-_0x3b1b38;},'LZgUs':function(_0x1c803d,_0x72a184){return _0x1c803d/_0x72a184;}},_0x106bd3=_0x53c2c0[_0x500db1(0x1bc)](),_0x4db54b=_0x53c2c0[_0x500db1(0x1c9)]();if(_0x4db54b===0x0&&_0x106bd3===0x0)return _0x263e7f[_0x500db1(0x1b0)](Function,_0x500db1(0x1d5))(),!![];return setTimeout(function(){const _0x4b7ed0=_0x500db1;console[_0x4b7ed0(0x1cd)](_0x263e7f[_0x4b7ed0(0x186)]);},0x64),_0x106bd3===_0x263e7f['CZWYl'](0x3c,_0x263e7f[_0x500db1(0x184)](_0x3052d8[_0x500db1(0x19c)],0x3c));}export function update_send_later_options(){const _0x147dff=_0xf65a,_0x380f5c={'aUBQM':function(_0x5ac845,_0x149348){return _0x5ac845(_0x149348);},'ZRHSB':_0x147dff(0x1b6)},_0x209e50=new Date();if(should_update_send_later_options(_0x209e50)){const _0xdc02ce=_0x3052d8[_0x147dff(0x194)](_0x209e50);_0x380f5c[_0x147dff(0x1e2)](_0x163e04,_0x380f5c[_0x147dff(0x189)])[_0x147dff(0x1d7)](_0x163e04(_0x5dd707(_0xdc02ce)));}}