'use strict';const _0x5e6fc7=_0x33ac;(function(_0x3471dc,_0x1eef50){const _0x2cee7a=_0x33ac,_0x557fda=_0x3471dc();while(!![]){try{const _0x214255=-parseInt(_0x2cee7a(0x21f))/0x1*(-parseInt(_0x2cee7a(0x201))/0x2)+parseInt(_0x2cee7a(0x1f0))/0x3*(parseInt(_0x2cee7a(0x26e))/0x4)+-parseInt(_0x2cee7a(0x1ec))/0x5*(parseInt(_0x2cee7a(0x21d))/0x6)+parseInt(_0x2cee7a(0x246))/0x7*(-parseInt(_0x2cee7a(0x225))/0x8)+parseInt(_0x2cee7a(0x26c))/0x9*(parseInt(_0x2cee7a(0x237))/0xa)+parseInt(_0x2cee7a(0x20f))/0xb+parseInt(_0x2cee7a(0x20a))/0xc*(-parseInt(_0x2cee7a(0x247))/0xd);if(_0x214255===_0x1eef50)break;else _0x557fda['push'](_0x557fda['shift']());}catch(_0x1eb7e0){_0x557fda['push'](_0x557fda['shift']());}}}(_0x4ee3,0x3bcf9));const {createPublicKey,createSecretKey}=require(_0x5e6fc7(0x27a)),Cache=require('mnemonist/lru-cache'),{hsAlgorithms,verifySignature,detectPublicKeyAlgorithms}=require(_0x5e6fc7(0x1ef)),createDecoder=require('./decoder'),{TokenError}=require(_0x5e6fc7(0x1ff)),{getAsyncKey,ensurePromiseCallback,hashToken}=require('./utils'),defaultCacheSize=0x3e8;function exactStringClaimMatcher(_0x3a4ac2,_0x208985){return _0x3a4ac2===_0x208985;}function checkAreCompatibleAlgorithms(_0x167ad3,_0x154cf4){const _0x54184f=_0x5e6fc7;for(const _0x113ea6 of _0x167ad3){if(_0x154cf4[_0x54184f(0x1f9)](_0x113ea6))return;}throw new TokenError(TokenError[_0x54184f(0x25e)]['invalidKey'],'Invalid\x20public\x20key\x20provided\x20for\x20algorithms\x20'+_0x167ad3[_0x54184f(0x24b)](',\x20')+'.');}function prepareKeyOrSecret(_0x15f9d9,_0xce2a9c){const _0x39896d=_0x5e6fc7,_0xa4172b={'nzvyc':_0x39896d(0x21c),'lFAwN':function(_0x594a41,_0x4b582d){return _0x594a41(_0x4b582d);}};return typeof _0x15f9d9===_0xa4172b['nzvyc']&&(_0x15f9d9=Buffer['from'](_0x15f9d9,_0x39896d(0x23a))),_0xce2a9c?createSecretKey(_0x15f9d9):_0xa4172b[_0x39896d(0x269)](createPublicKey,_0x15f9d9);}function ensureStringClaimMatcher(_0x1e12b1){const _0x55f643=_0x5e6fc7,_0x354938={'bANFf':function(_0x507ace,_0x5bc5f4){return _0x507ace===_0x5bc5f4;}};return!Array[_0x55f643(0x226)](_0x1e12b1)&&(_0x1e12b1=[_0x1e12b1]),_0x1e12b1[_0x55f643(0x26f)](_0x48be10=>_0x48be10)[_0x55f643(0x253)](_0x11d788=>{const _0x17e9ae=_0x55f643;if(_0x11d788&&_0x354938['bANFf'](typeof _0x11d788[_0x17e9ae(0x1e2)],_0x17e9ae(0x22a)))return _0x11d788;return{'test':exactStringClaimMatcher['bind'](null,_0x11d788)};});}function createCache(_0x18886b){const _0x4d7d4e=_0x5e6fc7,_0x18fe62={'DvZzi':function(_0x561c7e,_0xc3165b,_0x146d88){return _0x561c7e(_0xc3165b,_0x146d88);},'fmgCQ':function(_0x49a99e,_0x1e8a81){return _0x49a99e===_0x1e8a81;},'gTGyC':function(_0x30ffc6,_0x32287d){return _0x30ffc6>_0x32287d;}},_0x14f129=_0x18fe62[_0x4d7d4e(0x270)](parseInt,_0x18fe62[_0x4d7d4e(0x258)](_0x18886b,!![])?defaultCacheSize:_0x18886b,0xa);return _0x18fe62['gTGyC'](_0x14f129,0x0)?new Cache(_0x14f129):null;}function cacheSet({cache:_0x4a8d0c,token:_0x4bfbf9,cacheTTL:_0x3f2a92,payload:_0x551a28,ignoreExpiration:_0x447793,ignoreNotBefore:_0x3e88ad,maxAge:_0x325a55,clockTimestamp:clockTimestamp=Date[_0x5e6fc7(0x1f7)](),clockTolerance:_0x3ec689,errorCacheTTL:_0x23e87d,cacheKeyBuilder:_0x390aa5},_0x2599b0){const _0x1c7426=_0x5e6fc7,_0xc0a611={'WsQbx':function(_0x53d22c,_0x3ad608){return _0x53d22c+_0x3ad608;},'xoqda':function(_0x3f1688,_0x243c93){return _0x3f1688===_0x243c93;},'vwfDb':'qQTza','sXXdP':function(_0x3075cb,_0x5f0ec1){return _0x3075cb-_0x5f0ec1;},'ikrZB':function(_0x49d5d8,_0x1a7fc6){return _0x49d5d8*_0x1a7fc6;},'aLqyO':function(_0xccf4d7,_0x29fe48){return _0xccf4d7*_0x29fe48;},'sQuHX':function(_0x5b8eb2,_0x3fc317){return _0x5b8eb2+_0x3fc317;}};if(!_0x4a8d0c)return _0x2599b0;const _0x2c8e4e=[_0x2599b0,0x0,0x0];if(_0x2599b0 instanceof TokenError){const _0x4aec44=typeof _0x23e87d==='function'?_0x23e87d(_0x2599b0):_0x23e87d;return _0x2c8e4e[0x2]=_0xc0a611[_0x1c7426(0x25c)](clockTimestamp+_0x3ec689,_0x4aec44),_0x4a8d0c[_0x1c7426(0x208)](_0x390aa5(_0x4bfbf9),_0x2c8e4e),_0x2599b0;}const _0x88aa80=_0x551a28&&_0xc0a611['xoqda'](typeof _0x551a28['iat'],'number');if(_0x88aa80){if(_0xc0a611[_0x1c7426(0x21a)]!=='qQTza'){if(_0x5c24ce[_0x1c7426(0x1f9)](_0x3c64a))return;}else{_0x2c8e4e[0x1]=!_0x3e88ad&&typeof _0x551a28[_0x1c7426(0x271)]===_0x1c7426(0x268)?_0xc0a611[_0x1c7426(0x1f5)](_0xc0a611[_0x1c7426(0x25f)](_0x551a28['nbf'],0x3e8),_0x3ec689):0x0;if(!_0x447793){if(typeof _0x551a28[_0x1c7426(0x221)]===_0x1c7426(0x268))_0x2c8e4e[0x2]=_0xc0a611[_0x1c7426(0x1fe)](_0x551a28['exp'],0x3e8)+_0x3ec689;else _0x325a55&&(_0x2c8e4e[0x2]=_0xc0a611[_0x1c7426(0x256)](_0xc0a611['sQuHX'](_0x551a28[_0x1c7426(0x1e9)]*0x3e8,_0x325a55),_0x3ec689));}}}const _0x19bb3d=_0xc0a611[_0x1c7426(0x25c)](clockTimestamp,_0x3ec689)+_0x3f2a92;return _0x2c8e4e[0x2]=_0x2c8e4e[0x2]===0x0?_0x19bb3d:Math['min'](_0x2c8e4e[0x2],_0x19bb3d),_0x4a8d0c['set'](_0x390aa5(_0x4bfbf9),_0x2c8e4e),_0x2599b0;}function _0x4ee3(){const _0x1fc1a7=['QiDlO','jti','utf-8','\x20at\x20','length','invalidOption','lLzhw','invalidType','missingRequiredClaim','WCdEd','SgAYn','The\x20key\x20option\x20is\x20missing.','The\x20clockTolerance\x20option\x20must\x20be\x20a\x20positive\x20number.','EtOrn','110439qetTjK','5213nUJCRq','SeDmO','FBldy','\x20claim\x20values\x20are\x20allowed.','join','The\x20errorCacheTTL\x20option\x20must\x20be\x20a\x20number\x20greater\x20than\x20-1\x20or\x20a\x20function.','NAFUA','PKkca','LZILe','\x20claim\x20value\x20is\x20not\x20allowed.','vBZxi','The\x20token\x20signature\x20is\x20invalid.','map','xABZW','push','sQuHX','qvezO','fmgCQ','wpCeM','Not\x20all\x20of\x20the\x20','JbDvl','WsQbx','exports','codes','ikrZB','some','code','JcoOJ','get','dbnYM','\x20claim\x20must\x20be\x20a\x20','allowedAlgorithms','qoyZL','number','lFAwN','bind','nekHY','1346202PhCKQO','IkUYY','4BrMPMX','filter','DvZzi','nbf','HDWLG','YAPJe','keyFetchingError','jLHqU','BuwjK','dHoaq','ywTBM','hZvTw','node:crypto','xfzbu','cache','KREGY','zplbo','GayYw','McxtO','test','oBmHX','tjHEG','The\x20token\x20algorithm\x20is\x20invalid.','syAPz','aud','DcTZF','iat','The\x20','toISOString','920qVtzxa','BsEtJ','The\x20key\x20option\x20must\x20be\x20a\x20string,\x20a\x20buffer\x20or\x20a\x20function\x20returning\x20the\x20algorithm\x20secret\x20or\x20public\x20key.','./crypto','1214067fUObCo','has\x20expired','nPgcG','Cannot\x20fetch\x20key.','LEyJV','sXXdP','invalidClaimType','now','vEaPi','includes','aUbIE','GYfcX','lScgu','None\x20of\x20','aLqyO','./error','PudQM','217862QgbJnw','TJSqN','BUnRI','wEkym','toLowerCase','iYdAy','nonce','set','AMPlv','27312rHShPN','uLACN','FAST_JWT_INACTIVE','invalidSignature','object','2529329ykOkRR','sbdyD','date','The\x20key\x20returned\x20from\x20the\x20callback\x20must\x20be\x20a\x20string\x20or\x20a\x20buffer\x20containing\x20a\x20secret\x20or\x20a\x20public\x20key.','HxPkV','will\x20be\x20active','wrap','undefined','The\x20clockTimestamp\x20option\x20must\x20be\x20a\x20positive\x20number.','aOoff','kiXGO','vwfDb','invalidAlgorithm','string','3138nOhKnv','wykUX','2GJxSxu','GmhJL','exp','sapmg','INVALID_OPTION','expired','24SvyDWm','isArray','sCnPG','every','lSfIV','function','fEgLd','TlkZu','from','alg','SCkFl','bAzCE','jLnGW','missingKey','kVLPW','uqnES','YtTPn','JgeBD','30QTcIiH'];_0x4ee3=function(){return _0x1fc1a7;};return _0x4ee3();}function handleCachedResult(_0x1f1e77,_0x2e5101,_0x1becd9){const _0x22d707=_0x5e6fc7,_0x5448d1={'sbdyD':function(_0x486924,_0x195cd9){return _0x486924(_0x195cd9);},'syAPz':function(_0x14193d,_0x4dd741,_0x3b58f1){return _0x14193d(_0x4dd741,_0x3b58f1);}};if(_0x1f1e77 instanceof TokenError){if(!_0x2e5101)throw _0x1f1e77;_0x5448d1[_0x22d707(0x210)](_0x2e5101,_0x1f1e77);}else{if(!_0x2e5101)return _0x1f1e77;_0x5448d1[_0x22d707(0x1e6)](_0x2e5101,null,_0x1f1e77);}return _0x1becd9;}function validateAlgorithmAndSignature(_0x34f536,_0x3f587a,_0x2d53d9,_0x4e0488,_0x2c7fe6){const _0x2c3b66=_0x5e6fc7,_0x75cdc1={'FBldy':_0x2c3b66(0x1e5),'vEaPi':'tanJu'};if(!_0x2c7fe6[_0x2c3b66(0x1f9)](_0x3f587a[_0x2c3b66(0x22e)]))throw new TokenError(TokenError[_0x2c3b66(0x25e)][_0x2c3b66(0x21b)],_0x75cdc1[_0x2c3b66(0x249)]);if(_0x2d53d9&&!verifySignature(_0x3f587a[_0x2c3b66(0x22e)],_0x4e0488,_0x34f536,_0x2d53d9)){if(_0x75cdc1['vEaPi']!==_0x75cdc1[_0x2c3b66(0x1f8)])throw new _0x12335d(_0x13221f['codes'][_0x2c3b66(0x23d)],_0x2c3b66(0x244));else throw new TokenError(TokenError['codes'][_0x2c3b66(0x20d)],_0x2c3b66(0x252));}}function validateClaimType(_0x1233f7,_0x3d8ccb,_0x538cd0,_0x41f9d3){const _0x541b3e=_0x5e6fc7,_0x1a2d38=_0x538cd0?_0x541b3e(0x1ea)+_0x3d8ccb+'\x20claim\x20must\x20be\x20a\x20'+_0x41f9d3+'\x20or\x20an\x20array\x20of\x20'+_0x41f9d3+'s.':'The\x20'+_0x3d8ccb+_0x541b3e(0x265)+_0x41f9d3+'.';if(_0x1233f7[_0x541b3e(0x253)](_0x112c9b=>typeof _0x112c9b)[_0x541b3e(0x260)](_0x4dcd88=>_0x4dcd88!==_0x41f9d3))throw new TokenError(TokenError['codes'][_0x541b3e(0x1f6)],_0x1a2d38);}function _0x33ac(_0x1a04bb,_0x4ff6f2){const _0x4ee33c=_0x4ee3();return _0x33ac=function(_0x33ac82,_0x4d6c57){_0x33ac82=_0x33ac82-0x1e2;let _0x5d1fcd=_0x4ee33c[_0x33ac82];return _0x5d1fcd;},_0x33ac(_0x1a04bb,_0x4ff6f2);}function validateClaimValues(_0x1b4836,_0x49912b,_0x13eb59,_0x3297f0){const _0x563eeb=_0x5e6fc7,_0x34d8b5=_0x3297f0?_0x563eeb(0x25a)+_0x49912b+_0x563eeb(0x24a):_0x563eeb(0x1ea)+_0x49912b+'\x20claim\x20value\x20is\x20not\x20allowed.';if(!_0x1b4836[_0x563eeb(0x228)](_0x55505f=>_0x13eb59[_0x563eeb(0x260)](_0x46476d=>_0x46476d[_0x563eeb(0x1e2)](_0x55505f))))throw new TokenError(TokenError['codes']['invalidClaimValue'],_0x34d8b5);}function validateClaimArrayValues(_0x5a4c7e,_0x229679,_0x3905a0,_0x17d09d){const _0x47c6dd=_0x5e6fc7,_0x689510=_0x17d09d?_0x47c6dd(0x1fd)+_0x229679+'\x20claim\x20values\x20are\x20allowed.':_0x47c6dd(0x1ea)+_0x229679+_0x47c6dd(0x250);if(!_0x5a4c7e[_0x47c6dd(0x260)](_0x3158e1=>_0x3905a0[_0x47c6dd(0x260)](_0x2331bc=>_0x2331bc[_0x47c6dd(0x1e2)](_0x3158e1))))throw new TokenError(TokenError[_0x47c6dd(0x25e)]['invalidClaimValue'],_0x689510);}function validateClaimDateValue(_0x3ac985,_0x366a76,_0x497ae6,_0x1a3a7e,_0x4ebb17,_0x43a5fc){const _0x4c102f=_0x5e6fc7,_0x5f1de4={'wEkym':function(_0xfb8494,_0x79703a){return _0xfb8494+_0x79703a;},'vBZxi':function(_0x513c1b,_0x1d88c4){return _0x513c1b*_0x1d88c4;}},_0x479195=_0x5f1de4[_0x4c102f(0x204)](_0x5f1de4[_0x4c102f(0x251)](_0x3ac985,0x3e8),_0x366a76||0x0),_0x5e92b2=_0x1a3a7e?_0x497ae6>=_0x479195:_0x497ae6<=_0x479195;if(!_0x5e92b2)throw new TokenError(TokenError['codes'][_0x4ebb17],'The\x20token\x20'+_0x43a5fc+_0x4c102f(0x23b)+new Date(_0x479195)[_0x4c102f(0x1eb)]()+'.');}function verifyToken(_0x169ffa,{input:_0x172434,header:_0x40bf6e,payload:_0x2d6bbc,signature:_0x560b9c},{validators:_0x40dbf7,allowedAlgorithms:_0x12bcbd,checkTyp:_0x327453,clockTimestamp:_0x3dcfdb,requiredClaims:_0x1477e5}){const _0x51e493=_0x5e6fc7,_0x3eae37={'lScgu':function(_0x235562,_0x12ffd0){return _0x235562 instanceof _0x12ffd0;},'VixzE':function(_0xd3c621,_0x5c96ec){return _0xd3c621&&_0x5c96ec;},'NAFUA':_0x51e493(0x243),'YAPJe':function(_0x2ef394,_0x440774,_0xb8b79c,_0x170ee5,_0x2b40ff,_0x33d07b){return _0x2ef394(_0x440774,_0xb8b79c,_0x170ee5,_0x2b40ff,_0x33d07b);},'TJSqN':function(_0x44dc37,_0xe9192a){return _0x44dc37!==_0xe9192a;},'AMPlv':_0x51e493(0x233),'TlkZu':_0x51e493(0x211),'KREGY':_0x51e493(0x268),'Nqzrq':function(_0x217c3e,_0x4382f7){return _0x217c3e===_0x4382f7;},'lgvgW':function(_0x5a0fe1,_0x138588,_0x2340d1,_0x6d1a82,_0x15fa13,_0x143d2d,_0x2a942a){return _0x5a0fe1(_0x138588,_0x2340d1,_0x6d1a82,_0x15fa13,_0x143d2d,_0x2a942a);},'JgeBD':function(_0x22a344,_0x3d23f3,_0x1a971a,_0x10cf9f,_0x220707){return _0x22a344(_0x3d23f3,_0x1a971a,_0x10cf9f,_0x220707);}},_0x274e85=_0x3eae37[_0x51e493(0x1fc)](_0x169ffa,Buffer)?_0x169ffa[_0x51e493(0x23c)]:!!_0x169ffa;if(_0x3eae37['VixzE'](_0x274e85,!_0x560b9c))throw new TokenError(TokenError[_0x51e493(0x25e)]['missingSignature'],'The\x20token\x20signature\x20is\x20missing.');else{if(!_0x274e85&&_0x560b9c)throw new TokenError(TokenError[_0x51e493(0x25e)][_0x51e493(0x232)],_0x3eae37[_0x51e493(0x24d)]);}_0x3eae37[_0x51e493(0x273)](validateAlgorithmAndSignature,_0x172434,_0x40bf6e,_0x560b9c,_0x169ffa,_0x12bcbd);if(_0x327453&&(_0x3eae37[_0x51e493(0x202)](typeof _0x40bf6e['typ'],'string')||_0x327453!==_0x40bf6e['typ'][_0x51e493(0x205)]()['replace'](/^application\//,'')))throw new TokenError(TokenError[_0x51e493(0x25e)][_0x51e493(0x23f)],'Invalid\x20typ.');if(_0x1477e5)for(const _0x5d207a of _0x1477e5){if(!(_0x5d207a in _0x2d6bbc))throw new TokenError(TokenError['codes'][_0x51e493(0x240)],_0x51e493(0x1ea)+_0x5d207a+'\x20claim\x20is\x20required.');}const _0x1dc65c=_0x3dcfdb||Date[_0x51e493(0x1f7)]();for(const {type:_0x106ba1,claim:_0x255941,allowed:_0x4601d5,array:_0x1e6ca8,modifier:_0x540d23,greater:_0x17b86b,errorCode:_0x4f9eda,errorVerb:_0x5b0ccd}of _0x40dbf7){const _0x1d4d94=_0x2d6bbc[_0x255941],_0x1d3a9d=Array['isArray'](_0x1d4d94),_0x31e688=_0x1d3a9d?_0x1d4d94:[_0x1d4d94];if(!(_0x255941 in _0x2d6bbc)){if(_0x3eae37[_0x51e493(0x209)]===_0x51e493(0x231))_0xb9c748=[_0xad5d35];else continue;}validateClaimType(_0x31e688,_0x255941,_0x1e6ca8,_0x106ba1===_0x3eae37['TlkZu']?_0x3eae37[_0x51e493(0x27d)]:_0x51e493(0x21c));if(_0x3eae37['Nqzrq'](_0x106ba1,_0x3eae37[_0x51e493(0x22c)])){if(_0x51e493(0x23e)!==_0x51e493(0x23e))return _0x2fcdb8(_0x810fd0(_0x3f9cc2,new _0x3ba83a(_0x3d6701[_0x51e493(0x25e)][_0x51e493(0x274)],_0x51e493(0x212))));else _0x3eae37['lgvgW'](validateClaimDateValue,_0x1d4d94,_0x540d23,_0x1dc65c,_0x17b86b,_0x4f9eda,_0x5b0ccd);}else _0x1e6ca8?_0x3eae37[_0x51e493(0x236)](validateClaimArrayValues,_0x31e688,_0x255941,_0x4601d5,_0x1d3a9d):validateClaimValues(_0x31e688,_0x255941,_0x4601d5,_0x1d3a9d);}}function verify({key:_0x5d093c,allowedAlgorithms:_0x4246bf,complete:_0x475141,cacheTTL:_0x3850d9,checkTyp:_0x27d4ed,clockTimestamp:_0x117f27,clockTolerance:_0x1f85c0,ignoreExpiration:_0x251380,ignoreNotBefore:_0x54a426,maxAge:_0xf715ac,isAsync:_0x1c9b95,validators:_0x14c27a,decode:_0x3b3493,cache:_0x2b5dbd,requiredClaims:_0x41e203,errorCacheTTL:_0x1579bb,cacheKeyBuilder:_0x191d56},_0x53c7a6,_0x2b559d){const _0x3ee2ab=_0x5e6fc7,_0x35e2d4={'fEgLd':'The\x20clockTimestamp\x20option\x20must\x20be\x20a\x20positive\x20number.','tjHEG':function(_0x3f433d,_0x23fcae,_0x5391e6){return _0x3f433d(_0x23fcae,_0x5391e6);},'sCnPG':_0x3ee2ab(0x1f3),'dbnYM':'string','FrPyz':_0x3ee2ab(0x23a),'kiXGO':_0x3ee2ab(0x279),'QiDlO':function(_0x490db3,_0x3405e8){return _0x490db3(_0x3405e8);},'JcoOJ':_0x3ee2ab(0x212),'EtOrn':_0x3ee2ab(0x241),'HhJBM':function(_0x34a46d,_0x1318f9){return _0x34a46d===_0x1318f9;},'aOoff':function(_0x1e3791,_0x2dc14f,_0x39f25d){return _0x1e3791(_0x2dc14f,_0x39f25d);},'GYfcX':function(_0x38501b,_0x583258,_0x1d428f){return _0x38501b(_0x583258,_0x1d428f);},'ASRfO':function(_0x1946aa,_0x32e597){return _0x1946aa(_0x32e597);},'mZMcH':_0x3ee2ab(0x216),'YtTPn':function(_0x3d5789,_0xd0df10){return _0x3d5789===_0xd0df10;},'HxPkV':function(_0x2426af,_0x495cff){return _0x2426af<=_0x495cff;},'nPgcG':function(_0x14ea71,_0x368e81){return _0x14ea71(_0x368e81);},'ywTBM':function(_0x29a409,_0x4dfe2a,_0x365689,_0x1ba56d){return _0x29a409(_0x4dfe2a,_0x365689,_0x1ba56d);},'xABZW':function(_0x326ee7,_0x855a8b,_0x8e35a3){return _0x326ee7(_0x855a8b,_0x8e35a3);},'BsEtJ':function(_0xae8f85,_0x3bfced,_0x5abe5b,_0x24131a){return _0xae8f85(_0x3bfced,_0x5abe5b,_0x24131a);}},[_0x2549b7,_0x49655e]=_0x1c9b95?_0x35e2d4['ASRfO'](ensurePromiseCallback,_0x2b559d):[];if(_0x2b5dbd){const [_0x512841,_0x5ce989,_0xe7903]=_0x2b5dbd[_0x3ee2ab(0x263)](_0x35e2d4[_0x3ee2ab(0x238)](_0x191d56,_0x53c7a6))||[undefined,0x0,0x0],_0x47dbda=_0x117f27||Date[_0x3ee2ab(0x1f7)]();if(typeof _0x512841!==_0x35e2d4['mZMcH']&&(_0x5ce989===0x0||_0x47dbda<_0x5ce989&&_0x35e2d4[_0x3ee2ab(0x235)](_0x512841[_0x3ee2ab(0x261)],_0x3ee2ab(0x20c))||_0x47dbda>=_0x5ce989&&_0x512841[_0x3ee2ab(0x261)]!==_0x3ee2ab(0x20c))&&(_0xe7903===0x0||_0x35e2d4[_0x3ee2ab(0x213)](_0x47dbda,_0xe7903)))return handleCachedResult(_0x512841,_0x2549b7,_0x49655e);}let _0x3bc65e;try{_0x3bc65e=_0x35e2d4[_0x3ee2ab(0x1f2)](_0x3b3493,_0x53c7a6);}catch(_0xc0fce9){if(_0x2549b7)return _0x2549b7(_0xc0fce9),_0x49655e;throw _0xc0fce9;}const {header:_0x2450a9,payload:_0x2612f4,signature:_0xdbd468,input:_0x112d58}=_0x3bc65e,_0x42c95b={'cache':_0x2b5dbd,'token':_0x53c7a6,'cacheTTL':_0x3850d9,'errorCacheTTL':_0x1579bb,'ignoreExpiration':_0x251380,'ignoreNotBefore':_0x54a426,'maxAge':_0xf715ac,'clockTimestamp':_0x117f27,'clockTolerance':_0x1f85c0,'payload':_0x2612f4,'cacheKeyBuilder':_0x191d56},_0xc9123d={'validators':_0x14c27a,'allowedAlgorithms':_0x4246bf,'checkTyp':_0x27d4ed,'clockTimestamp':_0x117f27,'clockTolerance':_0x1f85c0,'requiredClaims':_0x41e203};if(!_0x2549b7)try{return _0x35e2d4[_0x3ee2ab(0x278)](verifyToken,_0x5d093c,_0x3bc65e,_0xc9123d),_0x35e2d4[_0x3ee2ab(0x254)](cacheSet,_0x42c95b,_0x475141?{'header':_0x2450a9,'payload':_0x2612f4,'signature':_0xdbd468,'input':_0x112d58}:_0x2612f4);}catch(_0x48e2e2){throw _0x35e2d4[_0x3ee2ab(0x218)](cacheSet,_0x42c95b,_0x48e2e2);}return _0x35e2d4[_0x3ee2ab(0x1ed)](getAsyncKey,_0x5d093c,{'header':_0x2450a9,'payload':_0x2612f4,'signature':_0xdbd468},(_0x31addf,_0x5f0e00)=>{const _0x311d68=_0x3ee2ab;if(_0x31addf)return _0x2549b7(_0x35e2d4['tjHEG'](cacheSet,_0x42c95b,TokenError[_0x311d68(0x215)](_0x31addf,TokenError[_0x311d68(0x25e)][_0x311d68(0x274)],_0x35e2d4[_0x311d68(0x227)])));if(typeof _0x5f0e00===_0x35e2d4[_0x311d68(0x264)])_0x5f0e00=Buffer[_0x311d68(0x22d)](_0x5f0e00,_0x35e2d4['FrPyz']);else{if(!(_0x5f0e00 instanceof Buffer)){if(_0x35e2d4[_0x311d68(0x219)]!==_0x35e2d4[_0x311d68(0x219)])_0x81c57=_0x20d26d[_0x311d68(0x22d)](_0x4e0cc7,_0x311d68(0x23a));else return _0x35e2d4['QiDlO'](_0x2549b7,_0x35e2d4[_0x311d68(0x1e4)](cacheSet,_0x42c95b,new TokenError(TokenError[_0x311d68(0x25e)][_0x311d68(0x274)],_0x35e2d4[_0x311d68(0x262)])));}}try{const _0x42de5e=_0x35e2d4['QiDlO'](detectPublicKeyAlgorithms,_0x5f0e00);if(_0xc9123d[_0x311d68(0x266)]['length'])checkAreCompatibleAlgorithms(_0x4246bf,_0x42de5e);else{if(_0x311d68(0x241)!==_0x35e2d4[_0x311d68(0x245)])throw new _0x32ee34(_0x40df59['codes']['invalidOption'],_0x35e2d4[_0x311d68(0x22b)]);else _0xc9123d[_0x311d68(0x266)]=_0x42de5e;}_0x5f0e00=prepareKeyOrSecret(_0x5f0e00,_0x35e2d4['HhJBM'](_0x42de5e[0x0],hsAlgorithms[0x0])),verifyToken(_0x5f0e00,_0x3bc65e,_0xc9123d);}catch(_0x547eb5){return _0x2549b7(cacheSet(_0x42c95b,_0x547eb5));}_0x35e2d4['aOoff'](_0x2549b7,null,_0x35e2d4[_0x311d68(0x1fb)](cacheSet,_0x42c95b,_0x475141?{'header':_0x2450a9,'payload':_0x2612f4,'signature':_0xdbd468,'input':_0x53c7a6}:_0x2612f4));}),_0x49655e;}module[_0x5e6fc7(0x25d)]=function createVerifier(_0x30bb53){const _0x23c5d2=_0x5e6fc7,_0x12c40d={'IkUYY':function(_0x555127,_0x2145ec,_0x542728,_0x20749a,_0x32fcf5){return _0x555127(_0x2145ec,_0x542728,_0x20749a,_0x32fcf5);},'LZILe':_0x23c5d2(0x252),'SgAYn':function(_0x499bf8,_0x9bac9e,_0x55a5e1,_0x51f457,_0x4470a2){return _0x499bf8(_0x9bac9e,_0x55a5e1,_0x51f457,_0x4470a2);},'PudQM':function(_0x14a0e9,_0xab31ac){return _0x14a0e9!==_0xab31ac;},'wykUX':function(_0x4ba658,_0x4c6726){return _0x4ba658!==_0x4c6726;},'GayYw':function(_0x48d3f8,_0x3705c7){return _0x48d3f8(_0x3705c7);},'hNhNj':function(_0x3919db,_0x2a015a,_0x301757){return _0x3919db(_0x2a015a,_0x301757);},'CdiYR':_0x23c5d2(0x268),'McxtO':function(_0x22e2f1,_0x160f64){return _0x22e2f1<_0x160f64;},'SeDmO':_0x23c5d2(0x244),'LEyJV':function(_0x2467d0,_0x1ce565){return _0x2467d0!==_0x1ce565;},'uqnES':function(_0x461e9b,_0x2979d2){return _0x461e9b<_0x2979d2;},'PKkca':'The\x20cacheTTL\x20option\x20must\x20be\x20a\x20positive\x20number.','nekHY':'The\x20requiredClaims\x20option\x20must\x20be\x20an\x20array.','xfzbu':_0x23c5d2(0x211),'BUnRI':_0x23c5d2(0x271),'sapmg':'inactive','BuwjK':_0x23c5d2(0x214),'DcTZF':'exp','oBmHX':_0x23c5d2(0x1f1),'aUbIE':function(_0x32db58,_0x5b497c){return _0x32db58===_0x5b497c;},'jLHqU':_0x23c5d2(0x239),'lSfIV':function(_0x2e0a3d,_0x2aa2c9){return _0x2e0a3d(_0x2aa2c9);},'HDWLG':_0x23c5d2(0x21c),'wpCeM':_0x23c5d2(0x1e7),'JbDvl':_0x23c5d2(0x27e),'bAzCE':function(_0x556d22,_0x26dcfe){return _0x556d22(_0x26dcfe);},'fHLUc':_0x23c5d2(0x267),'SCkFl':_0x23c5d2(0x20b),'GmhJL':'sub','dHoaq':_0x23c5d2(0x22a)};let {key:_0x1a4f16,algorithms:_0x2f85f3,complete:_0x11e2c1,cache:_0x3378a4,cacheTTL:_0x442fdc,errorCacheTTL:_0x3037bb,checkTyp:_0x496d5d,clockTimestamp:_0x4b96ca,clockTolerance:_0x5076e6,ignoreExpiration:_0x15a1fd,ignoreNotBefore:_0x3137cb,maxAge:_0xcf274a,allowedJti:_0x5781a7,allowedAud:_0x551e63,allowedIss:_0x5c4da7,allowedSub:_0x1c4198,allowedNonce:_0x4c16ed,requiredClaims:_0x16cbb6,cacheKeyBuilder:_0x207cb0}={'cacheTTL':0x927c0,'clockTolerance':0x0,'errorCacheTTL':-0x1,'cacheKeyBuilder':hashToken,..._0x30bb53};!Array[_0x23c5d2(0x226)](_0x2f85f3)&&(_0x2f85f3=[]);const _0x57b529=typeof _0x1a4f16;if(_0x12c40d[_0x23c5d2(0x200)](_0x57b529,_0x23c5d2(0x21c))&&_0x12c40d[_0x23c5d2(0x21e)](_0x57b529,_0x23c5d2(0x20e))&&_0x57b529!=='function')throw new TokenError(TokenError[_0x23c5d2(0x25e)][_0x23c5d2(0x223)],_0x23c5d2(0x1ee));if(_0x1a4f16&&_0x57b529!==_0x23c5d2(0x22a)){const _0x47af0e=_0x12c40d[_0x23c5d2(0x27f)](detectPublicKeyAlgorithms,_0x1a4f16);_0x2f85f3[_0x23c5d2(0x23c)]?checkAreCompatibleAlgorithms(_0x2f85f3,_0x47af0e):_0x2f85f3=_0x47af0e,_0x1a4f16=_0x12c40d['hNhNj'](prepareKeyOrSecret,_0x1a4f16,_0x47af0e[0x0]===hsAlgorithms[0x0]);}if(_0x4b96ca&&(_0x12c40d[_0x23c5d2(0x21e)](typeof _0x4b96ca,_0x23c5d2(0x268))||_0x4b96ca<0x0))throw new TokenError(TokenError[_0x23c5d2(0x25e)]['invalidOption'],_0x23c5d2(0x217));if(_0x5076e6&&(typeof _0x5076e6!==_0x12c40d['CdiYR']||_0x12c40d[_0x23c5d2(0x280)](_0x5076e6,0x0)))throw new TokenError(TokenError[_0x23c5d2(0x25e)][_0x23c5d2(0x23d)],_0x12c40d[_0x23c5d2(0x248)]);if(_0x442fdc&&(_0x12c40d[_0x23c5d2(0x1f4)](typeof _0x442fdc,_0x23c5d2(0x268))||_0x12c40d[_0x23c5d2(0x234)](_0x442fdc,0x0)))throw new TokenError(TokenError[_0x23c5d2(0x25e)][_0x23c5d2(0x23d)],_0x12c40d[_0x23c5d2(0x24e)]);if(_0x3037bb&&typeof _0x3037bb!==_0x23c5d2(0x22a)&&typeof _0x3037bb!==_0x23c5d2(0x268)||_0x3037bb<-0x1)throw new TokenError(TokenError['codes']['invalidOption'],_0x23c5d2(0x24c));if(_0x16cbb6&&!Array[_0x23c5d2(0x226)](_0x16cbb6))throw new TokenError(TokenError[_0x23c5d2(0x25e)][_0x23c5d2(0x23d)],_0x12c40d[_0x23c5d2(0x26b)]);const _0xafe140=[];if(!_0x3137cb){if(_0x23c5d2(0x257)===_0x23c5d2(0x206)){if(!_0x37112f['includes'](_0x32a346[_0x23c5d2(0x22e)]))throw new _0x1f210a(_0x4359b4[_0x23c5d2(0x25e)]['invalidAlgorithm'],_0x23c5d2(0x1e5));if(_0x2510a9&&!_0x12c40d[_0x23c5d2(0x26d)](_0x98cf35,_0x59a141[_0x23c5d2(0x22e)],_0x4700b2,_0x63a452,_0x5939fe))throw new _0x3b76b1(_0x3d4cb0[_0x23c5d2(0x25e)][_0x23c5d2(0x20d)],_0x12c40d[_0x23c5d2(0x24f)]);}else _0xafe140[_0x23c5d2(0x255)]({'type':_0x12c40d['xfzbu'],'claim':_0x12c40d[_0x23c5d2(0x203)],'errorCode':_0x12c40d[_0x23c5d2(0x222)],'errorVerb':_0x12c40d[_0x23c5d2(0x276)],'greater':!![],'modifier':-_0x5076e6});}!_0x15a1fd&&_0xafe140[_0x23c5d2(0x255)]({'type':_0x23c5d2(0x211),'claim':_0x12c40d[_0x23c5d2(0x1e8)],'errorCode':_0x23c5d2(0x224),'errorVerb':_0x12c40d[_0x23c5d2(0x1e3)],'modifier':+_0x5076e6});_0x12c40d[_0x23c5d2(0x1fa)](typeof _0xcf274a,_0x23c5d2(0x268))&&_0xafe140['push']({'type':_0x12c40d[_0x23c5d2(0x27b)],'claim':'iat','errorCode':_0x23c5d2(0x224),'errorVerb':'has\x20expired','modifier':_0xcf274a});_0x5781a7&&_0xafe140[_0x23c5d2(0x255)]({'type':_0x23c5d2(0x21c),'claim':_0x12c40d[_0x23c5d2(0x275)],'allowed':_0x12c40d[_0x23c5d2(0x229)](ensureStringClaimMatcher,_0x5781a7)});_0x551e63&&_0xafe140[_0x23c5d2(0x255)]({'type':_0x12c40d[_0x23c5d2(0x272)],'claim':_0x12c40d[_0x23c5d2(0x259)],'allowed':_0x12c40d[_0x23c5d2(0x229)](ensureStringClaimMatcher,_0x551e63),'array':!![]});if(_0x5c4da7){if(_0x12c40d[_0x23c5d2(0x25b)]===_0x12c40d['JbDvl'])_0xafe140[_0x23c5d2(0x255)]({'type':_0x12c40d[_0x23c5d2(0x272)],'claim':'iss','allowed':_0x12c40d['bAzCE'](ensureStringClaimMatcher,_0x5c4da7)});else return typeof _0x526202===_0x23c5d2(0x21c)&&(_0x542dd1=_0x3723e8['from'](_0x4ac42d,_0x23c5d2(0x23a))),_0x49462b?_0x176bf6(_0x2acb53):_0x31f7cf(_0x5a6218);}_0x1c4198&&(_0x12c40d['fHLUc']===_0x12c40d[_0x23c5d2(0x22f)]?_0x12c40d[_0x23c5d2(0x242)](_0x5eab64,_0x1471ff,_0x3407a4,_0x287365,_0x5028aa):_0xafe140[_0x23c5d2(0x255)]({'type':_0x23c5d2(0x21c),'claim':_0x12c40d[_0x23c5d2(0x220)],'allowed':ensureStringClaimMatcher(_0x1c4198)}));_0x4c16ed&&_0xafe140[_0x23c5d2(0x255)]({'type':_0x12c40d[_0x23c5d2(0x272)],'claim':_0x23c5d2(0x207),'allowed':ensureStringClaimMatcher(_0x4c16ed)});const _0x2057d0=_0x496d5d?_0x496d5d[_0x23c5d2(0x205)]()['replace'](/^application\//,''):null,_0x5e9ed8={'key':_0x1a4f16,'allowedAlgorithms':_0x2f85f3,'complete':_0x11e2c1,'cacheTTL':_0x442fdc,'errorCacheTTL':_0x3037bb,'checkTyp':_0x2057d0,'clockTimestamp':_0x4b96ca,'clockTolerance':_0x5076e6,'ignoreExpiration':_0x15a1fd,'ignoreNotBefore':_0x3137cb,'maxAge':_0xcf274a,'isAsync':_0x57b529===_0x12c40d[_0x23c5d2(0x277)],'validators':_0xafe140,'decode':_0x12c40d[_0x23c5d2(0x27f)](createDecoder,{'complete':!![]}),'cache':_0x12c40d[_0x23c5d2(0x230)](createCache,_0x3378a4),'requiredClaims':_0x16cbb6,'cacheKeyBuilder':_0x207cb0},_0x325981=verify[_0x23c5d2(0x26a)](null,_0x5e9ed8);return _0x325981[_0x23c5d2(0x27c)]=_0x5e9ed8[_0x23c5d2(0x27c)],_0x325981;};