'use strict';const _0x43a10d=_0x22ac;function _0x22ac(_0x4e4c3e,_0x2c4cf3){const _0x178fc9=_0x178f();return _0x22ac=function(_0x22ac00,_0x360c93){_0x22ac00=_0x22ac00-0xdd;let _0x33de71=_0x178fc9[_0x22ac00];return _0x33de71;},_0x22ac(_0x4e4c3e,_0x2c4cf3);}(function(_0x20acea,_0x9285a5){const _0x2dc381=_0x22ac,_0x2f3e11=_0x20acea();while(!![]){try{const _0xa0f6e1=parseInt(_0x2dc381(0x11f))/0x1*(-parseInt(_0x2dc381(0x135))/0x2)+parseInt(_0x2dc381(0x165))/0x3+-parseInt(_0x2dc381(0x242))/0x4+parseInt(_0x2dc381(0x23f))/0x5+-parseInt(_0x2dc381(0x259))/0x6+parseInt(_0x2dc381(0x273))/0x7*(parseInt(_0x2dc381(0x138))/0x8)+parseInt(_0x2dc381(0x120))/0x9*(-parseInt(_0x2dc381(0x1ba))/0xa);if(_0xa0f6e1===_0x9285a5)break;else _0x2f3e11['push'](_0x2f3e11['shift']());}catch(_0x33b8ad){_0x2f3e11['push'](_0x2f3e11['shift']());}}}(_0x178f,0x9495b));const {createHash}=require(_0x43a10d(0x1ca)),{readFileSync}=require(_0x43a10d(0x102)),{resolve}=require(_0x43a10d(0x1c4)),{test}=require('node:test'),{createSigner,createVerifier,TokenError}=require(_0x43a10d(0x1a4)),{hashToken}=require('../src/utils'),privateKeys={'HS':'secretsecretsecret','ES256':readFileSync(resolve(__dirname,'../benchmarks/keys/es-256-private.key')),'ES384':readFileSync(resolve(__dirname,_0x43a10d(0x16a))),'ES512':readFileSync(resolve(__dirname,_0x43a10d(0x1fc))),'RS':readFileSync(resolve(__dirname,_0x43a10d(0x220))),'RSX509':readFileSync(resolve(__dirname,_0x43a10d(0x1ac))),'PPRS':readFileSync(resolve(__dirname,_0x43a10d(0x190))),'PS':readFileSync(resolve(__dirname,_0x43a10d(0xfa))),'Ed25519':readFileSync(resolve(__dirname,'../benchmarks/keys/ed-25519-private.key')),'Ed448':readFileSync(resolve(__dirname,'../benchmarks/keys/ed-448-private.key'))},publicKeys={'HS':_0x43a10d(0x16f),'ES256':readFileSync(resolve(__dirname,_0x43a10d(0x230))),'ES384':readFileSync(resolve(__dirname,'../benchmarks/keys/es-384-public.key')),'ES512':readFileSync(resolve(__dirname,_0x43a10d(0x1bb))),'RS':readFileSync(resolve(__dirname,'../benchmarks/keys/rs-512-public.key')),'RSX509':readFileSync(resolve(__dirname,'../benchmarks/keys/rs-x509-public.key')),'PPRS':readFileSync(resolve(__dirname,'../benchmarks/keys/pprs-512-public.key')),'PS':readFileSync(resolve(__dirname,_0x43a10d(0x24a))),'Ed25519':readFileSync(resolve(__dirname,_0x43a10d(0xe3))),'Ed448':readFileSync(resolve(__dirname,'../benchmarks/keys/ed-448-public.key'))};function verify(_0xc7543c,_0x2f2fd4,_0x46ccb7){const _0x1754df=_0x43a10d,_0x488bc1=createVerifier({'key':_0x1754df(0x199),..._0x2f2fd4});return _0x488bc1(_0xc7543c,_0x46ccb7);}test(_0x43a10d(0x218),async _0x322642=>{const _0x16a56e=_0x43a10d,_0x4c46af={'oQrEE':_0x16a56e(0x1f8),'fZhpl':_0x16a56e(0x199),'JXtFU':'utf-8'};_0x322642['plan'](0x1),verify(_0x16a56e(0x235),{'key':async _0x42aea8=>{const _0x55cd80=_0x16a56e;return _0x322642[_0x55cd80(0x1a8)]['deepStrictEqual'](_0x42aea8,{'header':{'typ':_0x55cd80(0x1d4),'alg':_0x4c46af[_0x55cd80(0x1dc)]},'payload':{'a':0x1},'signature':_0x55cd80(0x127)}),Buffer['from'](_0x4c46af['fZhpl'],_0x4c46af[_0x55cd80(0x14c)]);},'noTimestamp':!![],'complete':!![]});}),test(_0x43a10d(0x264),_0xe2e0e6=>{const _0x2f0a66=_0x43a10d,_0x2f62af={'oFVHa':function(_0x2332d6,_0xacff9b,_0x4d1e2f){return _0x2332d6(_0xacff9b,_0x4d1e2f);},'rUPVN':function(_0x4ffd70,_0x271f7a,_0x36888d){return _0x4ffd70(_0x271f7a,_0x36888d);},'BZSHK':_0x2f0a66(0x235),'vtFjc':'jwt','hiMPv':_0x2f0a66(0x1ee),'KTJCw':_0x2f0a66(0x1f8)};_0xe2e0e6[_0x2f0a66(0x1a8)][_0x2f0a66(0x25c)](_0x2f62af[_0x2f0a66(0x161)](verify,_0x2f0a66(0x235),{'noTimestamp':!![]}),{'a':0x1}),_0xe2e0e6[_0x2f0a66(0x1a8)]['deepStrictEqual'](_0x2f62af[_0x2f0a66(0x115)](verify,_0x2f0a66(0x111),{'clockTimestamp':0x77ce2a80}),{'a':0x1,'iat':0x77359400,'exp':0x7d2b7500}),_0xe2e0e6[_0x2f0a66(0x1a8)][_0x2f0a66(0x25c)](_0x2f62af[_0x2f0a66(0x115)](verify,_0x2f62af['BZSHK'],{'checkTyp':_0x2f62af['vtFjc'],'noTimestamp':!![]}),{'a':0x1}),_0xe2e0e6[_0x2f0a66(0x1a8)][_0x2f0a66(0x25c)](verify(_0x2f62af[_0x2f0a66(0x13f)],{'checkTyp':_0x2f62af['vtFjc']}),{'a':0x1}),_0xe2e0e6['assert'][_0x2f0a66(0x123)](()=>verify('eyJhbGciOiJIUzI1NiJ9.eyJhIjoxfQ.LrlPmSL4FxrzAHJSYbKzsA997COXdYCeFKlt3zt5DIY',{'checkTyp':_0x2f0a66(0x142)}),{'message':_0x2f0a66(0x25a)}),_0xe2e0e6[_0x2f0a66(0x1a8)][_0x2f0a66(0x123)](()=>verify(_0x2f0a66(0x1a7),{'checkTyp':'JWT'}),{'message':_0x2f0a66(0x25a)}),_0xe2e0e6[_0x2f0a66(0x1a8)][_0x2f0a66(0x25c)](_0x2f62af[_0x2f0a66(0x115)](verify,_0x2f0a66(0x235),{'noTimestamp':!![],'complete':!![]}),{'header':{'typ':_0x2f0a66(0x1d4),'alg':_0x2f62af[_0x2f0a66(0x240)]},'payload':{'a':0x1},'signature':_0x2f0a66(0x127),'input':_0x2f0a66(0xfb)}),_0xe2e0e6[_0x2f0a66(0x1a8)]['deepStrictEqual'](_0x2f62af[_0x2f0a66(0x115)](verify,_0x2f0a66(0x255),{'key':publicKeys[_0x2f0a66(0x14e)]}),{'a':0x1});}),test(_0x43a10d(0x1c6),async _0x5471b4=>{const _0x4d76e5=_0x43a10d,_0x57218b={'nheZg':function(_0x1a3b51,_0x32e5d4,_0x5ade94){return _0x1a3b51(_0x32e5d4,_0x5ade94);},'tAzbS':_0x4d76e5(0x235),'iPMrN':_0x4d76e5(0x1f8),'SheHT':'JWT','OJvqE':_0x4d76e5(0x127)};_0x5471b4[_0x4d76e5(0x1a8)]['deepStrictEqual'](await _0x57218b['nheZg'](verify,_0x57218b[_0x4d76e5(0x1c8)],{'key':(_0xfaff11,_0x476af6)=>setTimeout(()=>_0x476af6(null,_0x4d76e5(0x199)),0xa),'noTimestamp':!![]}),{'a':0x1}),_0x5471b4[_0x4d76e5(0x1a8)]['deepStrictEqual'](await _0x57218b[_0x4d76e5(0x233)](verify,_0x4d76e5(0x235),{'algorithms':[_0x57218b[_0x4d76e5(0x1e0)]],'key':(_0x40986d,_0x3b58cf)=>setTimeout(()=>_0x3b58cf(null,_0x4d76e5(0x199)),0xa),'noTimestamp':!![],'complete':!![]}),{'header':{'typ':_0x57218b[_0x4d76e5(0x19f)],'alg':'HS256'},'payload':{'a':0x1},'signature':_0x57218b['OJvqE'],'input':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM'});}),test(_0x43a10d(0x1e1),async _0x96ef89=>{const _0xb112a1=_0x43a10d,_0x37b305={'antKT':function(_0x5e5dc2,_0x17ccde,_0x39dc89){return _0x5e5dc2(_0x17ccde,_0x39dc89);}};_0x96ef89[_0xb112a1(0x1a8)][_0xb112a1(0x25c)](await _0x37b305[_0xb112a1(0x24f)](verify,_0xb112a1(0x235),{'key':async()=>Buffer[_0xb112a1(0x10e)](_0xb112a1(0x199),_0xb112a1(0x213)),'noTimestamp':!![]}),{'a':0x1});}),test(_0x43a10d(0x174),async _0x35a376=>{const _0x25ede6=_0x43a10d,_0x3887de={'sHYew':function(_0x201df5,_0x5279eb,_0x1b3b47){return _0x201df5(_0x5279eb,_0x1b3b47);},'lpNVt':_0x25ede6(0x235)};_0x35a376[_0x25ede6(0x1a8)]['deepStrictEqual'](await _0x3887de['sHYew'](verify,_0x3887de[_0x25ede6(0xdf)],{'noTimestamp':!![]}),{'a':0x1});}),test(_0x43a10d(0x11a),_0x1f1232=>{const _0x37bb51=_0x43a10d,_0x4ee30c={'pUaWG':function(_0x9c8864,_0x1f6785){return _0x9c8864==_0x1f6785;},'GzmSk':function(_0xe694be,_0x5d66e3,_0x993d77,_0x22b722){return _0xe694be(_0x5d66e3,_0x993d77,_0x22b722);}};_0x4ee30c[_0x37bb51(0x225)](verify,_0x37bb51(0x235),{'key':async()=>Buffer[_0x37bb51(0x10e)](_0x37bb51(0x199),_0x37bb51(0x213)),'noTimestamp':!![]},(_0x3d227a,_0x5a8b18)=>{const _0x3efaf7=_0x37bb51;_0x1f1232['assert']['ok'](_0x4ee30c[_0x3efaf7(0x196)](_0x3d227a,null)),_0x1f1232[_0x3efaf7(0x1a8)][_0x3efaf7(0x25c)](_0x5a8b18,{'a':0x1});});}),test(_0x43a10d(0x1b8),async _0x3ba064=>{const _0x4e1f7c=_0x43a10d,_0x3d8303={'kmyYv':_0x4e1f7c(0x1a9)},_0x43478a=verify(_0x3d8303[_0x4e1f7c(0x248)],{'key':publicKeys[_0x4e1f7c(0x272)]});_0x3ba064[_0x4e1f7c(0x1a8)][_0x4e1f7c(0x25c)](_0x43478a['a'],0x1);}),test(_0x43a10d(0x1cd),async _0x59bbc2=>{const _0x132fd9=_0x43a10d,_0xac7171={'WeITh':'Zdsdq','TpLlG':_0x132fd9(0x182),'ubjhE':'The\x20token\x20signature\x20is\x20invalid.'};_0x59bbc2['assert'][_0x132fd9(0x123)](()=>verify(_0x132fd9(0x182),{}),{'message':_0x132fd9(0x124)}),await _0x59bbc2[_0x132fd9(0x1a8)][_0x132fd9(0x157)](async()=>{const _0x20f9f9=_0x132fd9;if('Zdsdq'===_0xac7171['WeITh'])return verify(_0xac7171['TpLlG'],{'key':async()=>_0x20f9f9(0x199)});else throw new _0x523a9d(_0x20f9f9(0x126));},{'message':_0xac7171[_0x132fd9(0x210)]});}),test('it\x20requires\x20a\x20signature\x20or\x20a\x20key',async _0x75e8e4=>{const _0x116ba4=_0x43a10d,_0x131685={'KXowO':_0x116ba4(0x246),'LHjLR':_0x116ba4(0x15a)};_0x75e8e4[_0x116ba4(0x1a8)]['throws'](()=>verify(_0x116ba4(0x21b),{}),{'message':_0x131685[_0x116ba4(0x21d)]}),_0x75e8e4['assert'][_0x116ba4(0x123)](()=>verify(_0x116ba4(0x235),{'key':''}),{'message':_0x131685[_0x116ba4(0x1a5)]});}),test(_0x43a10d(0x1d3),async _0xd9ca90=>{const _0x166613=_0x43a10d,_0xe56214={'QuKRu':_0x166613(0x126),'ebbgl':function(_0x1c7c35,_0x46ca90,_0x1f2019){return _0x1c7c35(_0x46ca90,_0x1f2019);},'hmqaD':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM'};await _0xd9ca90['assert'][_0x166613(0x157)](_0xe56214[_0x166613(0x1cb)](verify,_0xe56214[_0x166613(0x116)],{'key':async()=>{const _0x3277b4=_0x166613;throw new Error(_0xe56214[_0x3277b4(0x1d7)]);}}),{'message':_0x166613(0x1f3)}),await _0xd9ca90['assert'][_0x166613(0x157)](verify(_0xe56214[_0x166613(0x116)],{'key':async()=>{throw new TokenError(null,'FAILED');}}),{'message':_0xe56214['QuKRu']});}),test(_0x43a10d(0x252),_0x298d78=>{const _0x500cf9=_0x43a10d,_0x3b0916={'ICkaK':_0x500cf9(0x126),'rtKHK':function(_0x8b99a9,_0x5647f0){return _0x8b99a9 instanceof _0x5647f0;},'kKYnR':'Cannot\x20fetch\x20key.'};verify(_0x500cf9(0x235),{'key':(_0x2fc098,_0x5611bc)=>{_0x5611bc(new Error(_0x3b0916['ICkaK']));}},_0x500bea=>{const _0x394720=_0x500cf9;_0x298d78['assert']['ok'](_0x3b0916[_0x394720(0x1be)](_0x500bea,TokenError)),_0x298d78[_0x394720(0x1a8)]['equal'](_0x500bea[_0x394720(0x143)],_0x3b0916[_0x394720(0x105)]);});}),test(_0x43a10d(0x1b2),_0x4e2a46=>{const _0x12c462=_0x43a10d,_0x27425c={'XySIA':function(_0x5b7384,_0x4b7cd8){return _0x5b7384!==_0x4b7cd8;},'lwBUv':_0x12c462(0x25d),'qdWDY':_0x12c462(0x13a),'RVjQb':function(_0x1ff6c3,_0x334939){return _0x1ff6c3 instanceof _0x334939;}};verify(_0x12c462(0x235),{'key':(_0xaf9239,_0x33e3e8)=>{const _0x5390ac=_0x12c462;process[_0x5390ac(0x191)](()=>_0x33e3e8(null,_0x5390ac(0x126)));}},_0x4f454b=>{const _0x556a2c=_0x12c462;if(_0x27425c['XySIA'](_0x27425c[_0x556a2c(0x214)],_0x27425c[_0x556a2c(0x17f)]))_0x4e2a46[_0x556a2c(0x1a8)]['ok'](_0x27425c[_0x556a2c(0x16d)](_0x4f454b,TokenError)),_0x4e2a46['assert'][_0x556a2c(0x192)](_0x4f454b[_0x556a2c(0x143)],_0x556a2c(0x124));else throw new _0x2455cb(_0x556a2c(0x270));});}),test('it\x20handles\x20decoding\x20errors',async _0x7aba1d=>{const _0x5ae7e4=_0x43a10d;_0x7aba1d[_0x5ae7e4(0x1a8)][_0x5ae7e4(0x123)](()=>verify('TOKEN',{'algorithms':[_0x5ae7e4(0x1f8)],'key':_0x5ae7e4(0x199)}),{'message':_0x5ae7e4(0x162)}),await _0x7aba1d['assert'][_0x5ae7e4(0x157)](async()=>verify(_0x5ae7e4(0xeb),{'algorithms':[_0x5ae7e4(0x1f8)],'key':()=>_0x5ae7e4(0x199)}),{'message':_0x5ae7e4(0x162)});}),test('it\x20validates\x20if\x20the\x20token\x20is\x20not\x20using\x20an\x20allowed\x20algorithm\x20-\x20sync\x20',_0x4be1b6=>{const _0x564c63=_0x43a10d,_0x1ec842={'jWjWQ':function(_0x4348aa,_0x576055,_0x4bb8be){return _0x4348aa(_0x576055,_0x4bb8be);},'Qdivj':_0x564c63(0x15b),'vokvJ':_0x564c63(0x278),'maxGA':_0x564c63(0x250)};_0x4be1b6[_0x564c63(0x1a8)][_0x564c63(0x123)](()=>{const _0x2147d2=_0x564c63;return _0x1ec842[_0x2147d2(0x10f)](verify,_0x2147d2(0x183),{'algorithms':[_0x1ec842['Qdivj'],_0x1ec842[_0x2147d2(0x17e)]],'key':publicKeys['RS']});},{'message':_0x1ec842[_0x564c63(0x113)]});}),test('it\x20validates\x20if\x20the\x20token\x20is\x20using\x20one\x20of\x20the\x20allowed\x20algorithm\x20-\x20sync\x20',_0x5b4966=>{const _0x34ec0b=_0x43a10d,_0x40e21f={'UWsev':_0x34ec0b(0x235),'ADlaE':_0x34ec0b(0x1f8),'eMNYE':function(_0x38b124,_0x4321dc,_0x5492a5){return _0x38b124(_0x4321dc,_0x5492a5);},'znxXX':_0x34ec0b(0x199),'IVrcf':_0x34ec0b(0x177),'YJEzo':_0x34ec0b(0x1a6),'GzWuD':_0x34ec0b(0x278),'TOnae':_0x34ec0b(0x13d),'hmywX':_0x34ec0b(0x132)};_0x5b4966['assert']['deepStrictEqual'](verify(_0x40e21f[_0x34ec0b(0xf0)],{'noTimestamp':!![]}),{'a':0x1}),_0x5b4966[_0x34ec0b(0x1a8)][_0x34ec0b(0x25c)](verify(_0x40e21f[_0x34ec0b(0xf0)],{'noTimestamp':!![],'algorithms':[_0x40e21f[_0x34ec0b(0x257)]]}),{'a':0x1}),_0x5b4966[_0x34ec0b(0x1a8)][_0x34ec0b(0x25c)](verify('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM',{'noTimestamp':!![],'algorithms':[_0x34ec0b(0x15b),'HS256']}),{'a':0x1}),_0x5b4966[_0x34ec0b(0x1a8)]['deepStrictEqual'](_0x40e21f[_0x34ec0b(0x200)](verify,_0x40e21f['UWsev'],{'noTimestamp':!![],'algorithms':[_0x34ec0b(0x15b),_0x40e21f['ADlaE']],'key':_0x40e21f[_0x34ec0b(0x114)]}),{'a':0x1}),_0x5b4966[_0x34ec0b(0x1a8)]['deepStrictEqual'](verify(_0x40e21f[_0x34ec0b(0xf0)],{'noTimestamp':!![],'algorithms':[_0x34ec0b(0x15b),_0x34ec0b(0x1c0),_0x34ec0b(0x243),_0x34ec0b(0x1f8),_0x34ec0b(0x129),_0x34ec0b(0xe8),_0x34ec0b(0x244),_0x40e21f[_0x34ec0b(0x279)],_0x40e21f[_0x34ec0b(0x237)],_0x40e21f[_0x34ec0b(0x26c)],_0x40e21f[_0x34ec0b(0x1b0)],_0x40e21f[_0x34ec0b(0x198)],_0x34ec0b(0xe4)]}),{'a':0x1});}),test('it\x20validates\x20if\x20the\x20token\x20can\x20be\x20verified\x20with\x20X509\x20public\x20key\x20certificate\x20',_0x11d825=>{const _0x546ce0=_0x43a10d,_0x187a2c={'PRXQY':_0x546ce0(0x21a)};_0x11d825[_0x546ce0(0x1a8)][_0x546ce0(0x25c)](verify(_0x187a2c[_0x546ce0(0x1a3)],{'noTimestamp':!![],'key':publicKeys[_0x546ce0(0x1d2)]}),{'a':0x1});}),test(_0x43a10d(0x164),_0x5edf88=>{const _0x3e02b6=_0x43a10d,_0x31afe4={'bcBUe':'ES256','aeYZM':_0x3e02b6(0x22b)};_0x5edf88[_0x3e02b6(0x1a8)][_0x3e02b6(0x123)](()=>{const _0x5394a0=_0x3e02b6;return verify(_0x5394a0(0x183),{'algorithms':[_0x31afe4[_0x5394a0(0x184)]],'key':publicKeys['RS']});},{'message':_0x31afe4[_0x3e02b6(0x20d)]});}),test(_0x43a10d(0x18d),_0x29079b=>{const _0x4a773b=_0x43a10d,_0x4dd2df={'hDazz':'secret','eLhQC':function(_0x2e2bf2,_0x2487bf,_0x38883b){return _0x2e2bf2(_0x2487bf,_0x38883b);},'hIWJV':'SIABs','ZvGYK':_0x4a773b(0xf9),'bbmod':_0x4a773b(0x183),'rBODG':_0x4a773b(0x188),'LvxMp':function(_0x5e3aa2,_0x1b8355,_0x7165bb){return _0x5e3aa2(_0x1b8355,_0x7165bb);}};_0x29079b['assert'][_0x4a773b(0x123)](()=>{const _0x3e74c9=_0x4a773b;if(_0x4dd2df[_0x3e74c9(0x147)]!==_0x4dd2df[_0x3e74c9(0x1eb)])return verify(_0x4dd2df['bbmod'],{});else{const _0x430d2b=_0x2ce40f({'key':_0x4dd2df['hDazz'],..._0x20a509});return _0x4dd2df['eLhQC'](_0x430d2b,_0x14315b,_0x439691);}},{'message':_0x4dd2df[_0x4a773b(0x208)]}),_0x29079b[_0x4a773b(0x1a8)][_0x4a773b(0x25c)](_0x4dd2df[_0x4a773b(0x181)](verify,_0x4a773b(0x183),{'ignoreNotBefore':!![]}),{'a':0x1,'iat':0x0,'nbf':0x77359400});}),test(_0x43a10d(0xde),_0x5dad3c=>{const _0x94fe33=_0x43a10d,_0x3d740c={'Vchfj':function(_0x1019a4,_0x16f163){return _0x1019a4(_0x16f163);},'ulHaI':function(_0x10451c,_0x13b449){return _0x10451c/_0x13b449;},'wLdvt':function(_0x26937b,_0x5eca87){return _0x26937b/_0x5eca87;},'QXLpt':function(_0x4eb9bf,_0x1fae14){return _0x4eb9bf+_0x1fae14;}},_0x55255f=Date[_0x94fe33(0x234)](),_0x5f3743=0x3e8,_0x2deeb7=_0x3d740c[_0x94fe33(0x108)](createSigner,{'key':_0x94fe33(0x199),'clockTimestamp':_0x55255f,'notBefore':_0x5f3743})({'a':0x1});_0x5dad3c['assert'][_0x94fe33(0x25c)](verify(_0x2deeb7,{'clockTolerance':0x1388}),{'a':0x1,'iat':Math['floor'](_0x3d740c['ulHaI'](_0x55255f,0x3e8)),'nbf':Math[_0x94fe33(0x18b)](_0x3d740c[_0x94fe33(0x193)](_0x3d740c[_0x94fe33(0x10b)](_0x55255f,_0x5f3743),0x3e8))});}),test(_0x43a10d(0x229),_0x5e1116=>{const _0x4d1179=_0x43a10d,_0x333aed={'ZUtjT':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjEwMCwiZXhwIjoxMDF9.ULKqTsvUYm7iNOKA6bP5NXsa1A8vofgPIGiC182Vf_Q','xUebd':_0x4d1179(0x17a)};_0x5e1116[_0x4d1179(0x1a8)][_0x4d1179(0x123)](()=>{const _0x5a3a44=_0x4d1179;return verify(_0x333aed[_0x5a3a44(0x26a)],{});},{'message':_0x333aed[_0x4d1179(0x14a)]}),_0x5e1116[_0x4d1179(0x1a8)][_0x4d1179(0x25c)](verify(_0x333aed['ZUtjT'],{'ignoreExpiration':!![]}),{'a':0x1,'iat':0x64,'exp':0x65});}),test('it\x20validates\x20if\x20the\x20token\x20has\x20not\x20expired\x20(via\x20maxAge)\x20only\x20if\x20explicitily\x20enabled',_0x1eae25=>{const _0x164697=_0x43a10d,_0x20b6ba={'fRErA':_0x164697(0x216),'WeufE':function(_0x43e32c,_0x228fd2){return _0x43e32c(_0x228fd2);}};_0x1eae25[_0x164697(0x1a8)][_0x164697(0x123)](()=>{const _0x3b3c1b=_0x164697;return verify(_0x20b6ba[_0x3b3c1b(0x10c)],{'maxAge':0x30d40});},{'message':_0x164697(0x144)}),_0x1eae25['assert']['deepStrictEqual'](_0x20b6ba[_0x164697(0x24d)](verify,_0x20b6ba[_0x164697(0x10c)]),{'a':0x1,'iat':0x64});}),test('it\x20validates\x20if\x20the\x20token\x20has\x20not\x20expired\x20including\x20the\x20clock\x20tolerance',_0x15528b=>{const _0x5ef5fc=_0x43a10d,_0xf73753={'MOGsL':function(_0x2ca404,_0x245313){return _0x2ca404/_0x245313;},'aurGv':function(_0x1e63e5,_0xdea05e){return _0x1e63e5+_0xdea05e;}},_0x38f7c4=Date[_0x5ef5fc(0x234)]()-0x1388,_0x326532=0x3e8,_0x135296=createSigner({'key':_0x5ef5fc(0x199),'clockTimestamp':_0x38f7c4,'expiresIn':_0x326532})({'a':0x1});_0x15528b['assert'][_0x5ef5fc(0x25c)](verify(_0x135296,{'clockTolerance':0x1388}),{'a':0x1,'iat':Math['floor'](_0x38f7c4/0x3e8),'exp':Math[_0x5ef5fc(0x18b)](_0xf73753[_0x5ef5fc(0x154)](_0xf73753['aurGv'](_0x38f7c4,_0x326532),0x3e8))});}),test(_0x43a10d(0xf4),_0x234b7c=>{const _0x3b1755=_0x43a10d,_0x5346e4={'PmJbj':_0x3b1755(0x247),'mKKTc':function(_0x14191a,_0x1ac855){return _0x14191a===_0x1ac855;},'bffiw':_0x3b1755(0x211),'lumJf':_0x3b1755(0x153),'PBfcs':_0x3b1755(0x1bc),'QHINz':function(_0x2c96a9,_0x359418,_0x1f96d6){return _0x2c96a9(_0x359418,_0x1f96d6);},'lCLKA':_0x3b1755(0x187),'vDndm':_0x3b1755(0x19d),'tCMme':_0x3b1755(0x22f),'yTtQJ':_0x3b1755(0x1e2),'kJpjI':_0x3b1755(0x12f),'CdCJM':function(_0x124b7a,_0x169401,_0x344926){return _0x124b7a(_0x169401,_0x344926);},'PYvoP':_0x3b1755(0x1f6),'GeZlU':function(_0x3b0c5e,_0x39e166,_0x1f8173){return _0x3b0c5e(_0x39e166,_0x1f8173);},'SUhha':'SUB'};_0x234b7c[_0x3b1755(0x1a8)][_0x3b1755(0x123)](()=>{const _0x1c2f24=_0x3b1755;return verify(_0x1c2f24(0x20b),{'allowedJti':_0x5346e4[_0x1c2f24(0x133)]});},{'message':_0x5346e4[_0x3b1755(0x224)]}),_0x234b7c[_0x3b1755(0x1a8)][_0x3b1755(0x123)](()=>{const _0x3b0423=_0x3b1755;return _0x5346e4[_0x3b0423(0x179)](_0x3b0423(0x211),_0x5346e4[_0x3b0423(0x1f0)])?verify(_0x3b0423(0x263),{'allowedJti':_0x3b0423(0x247)}):_0x4e3a0a(_0x37fed2,{'requiredClaims':[_0x3b0423(0x131)]});},{'message':_0x5346e4[_0x3b1755(0x152)]}),_0x234b7c[_0x3b1755(0x1a8)][_0x3b1755(0x123)](()=>{return verify('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedJti':[/abc/,'cde']});},{'message':_0x3b1755(0x1bc)}),_0x234b7c[_0x3b1755(0x1a8)]['deepStrictEqual'](_0x5346e4[_0x3b1755(0x12d)](verify,_0x3b1755(0x263),{'allowedJti':_0x3b1755(0x187)}),{'a':0x1,'jti':_0x5346e4[_0x3b1755(0x110)],'aud':[_0x5346e4[_0x3b1755(0x269)],_0x5346e4[_0x3b1755(0x112)]],'iss':_0x5346e4[_0x3b1755(0x13e)],'sub':_0x3b1755(0x221),'nonce':_0x5346e4[_0x3b1755(0x260)]}),_0x234b7c[_0x3b1755(0x1a8)][_0x3b1755(0x25c)](_0x5346e4[_0x3b1755(0x163)](verify,_0x3b1755(0x263),{'allowedJti':[_0x5346e4[_0x3b1755(0x139)],_0x3b1755(0x187)]}),{'a':0x1,'jti':_0x3b1755(0x187),'aud':[_0x3b1755(0x19d),_0x5346e4[_0x3b1755(0x112)]],'iss':_0x3b1755(0x1e2),'sub':_0x3b1755(0x221),'nonce':_0x5346e4[_0x3b1755(0x260)]}),_0x234b7c[_0x3b1755(0x1a8)][_0x3b1755(0x25c)](_0x5346e4['GeZlU'](verify,_0x3b1755(0x263),{'allowedJti':[_0x3b1755(0x1f6),/^J/]}),{'a':0x1,'jti':_0x3b1755(0x187),'aud':['AUD1',_0x3b1755(0x22f)],'iss':_0x5346e4[_0x3b1755(0x13e)],'sub':_0x5346e4[_0x3b1755(0x202)],'nonce':_0x3b1755(0x12f)});}),test(_0x43a10d(0x262),_0x59e76b=>{const _0x5729a7=_0x43a10d,_0x6c1676={'BDkEg':function(_0x1f244a,_0x3f14dc,_0x27f702){return _0x1f244a(_0x3f14dc,_0x27f702);},'CEaWy':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw','smLQR':'cde','ZMZNd':_0x5729a7(0x197),'rKRXg':_0x5729a7(0x1c7),'UzAcq':_0x5729a7(0x254),'GNtBw':_0x5729a7(0x201),'bymGq':_0x5729a7(0x1e2),'fZTGd':_0x5729a7(0x221),'zXOLZ':_0x5729a7(0x187),'HEXDe':_0x5729a7(0x19d),'fZEyh':_0x5729a7(0x12f)};_0x59e76b[_0x5729a7(0x1a8)]['throws'](()=>{const _0x2e6963=_0x5729a7;return _0x6c1676[_0x2e6963(0x156)](verify,_0x2e6963(0x20b),{'allowedAud':_0x2e6963(0x1f9)});},{'message':_0x6c1676['ZMZNd']}),_0x59e76b[_0x5729a7(0x1a8)]['throws'](()=>{const _0xcb478e=_0x5729a7;return _0x6c1676[_0xcb478e(0x156)](verify,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOjEsImF1ZCI6WzIuMSwyLjJdLCJpc3MiOjMsInN1YiI6NCwibm9uY2UiOjV9._qE95j2r4UQ8BEXGZRv9stn5OLg1I3nQBEV4WKdABMg',{'allowedAud':'AUD2'});},{'message':_0x6c1676[_0x5729a7(0x24c)]}),_0x59e76b[_0x5729a7(0x1a8)]['throws'](()=>{const _0x1524d7=_0x5729a7;return verify(_0x6c1676[_0x1524d7(0x1cf)],{'allowedAud':_0x1524d7(0x1f9)});},{'message':_0x5729a7(0x1c7)}),_0x59e76b[_0x5729a7(0x1a8)]['throws'](()=>{const _0x43192c=_0x5729a7;return _0x6c1676[_0x43192c(0x156)](verify,_0x43192c(0x263),{'allowedAud':[/abc/,_0x6c1676[_0x43192c(0x1ff)]]});},{'message':_0x6c1676['rKRXg']}),_0x59e76b[_0x5729a7(0x1a8)][_0x5729a7(0x25c)](verify(_0x6c1676['UzAcq'],{'allowedAud':_0x6c1676[_0x5729a7(0x137)]}),{'a':0x1,'jti':'JTI','aud':[_0x6c1676['GNtBw'],'DUA2'],'iss':_0x6c1676[_0x5729a7(0x1db)],'sub':_0x6c1676[_0x5729a7(0x172)],'nonce':_0x5729a7(0x12f)}),_0x59e76b[_0x5729a7(0x1a8)][_0x5729a7(0x25c)](_0x6c1676[_0x5729a7(0x156)](verify,_0x5729a7(0x263),{'allowedAud':[_0x5729a7(0x1f6),_0x5729a7(0x19d)]}),{'a':0x1,'jti':_0x6c1676['zXOLZ'],'aud':[_0x6c1676['HEXDe'],'DUA2'],'iss':'ISS','sub':_0x5729a7(0x221),'nonce':_0x6c1676[_0x5729a7(0x217)]}),_0x59e76b[_0x5729a7(0x1a8)][_0x5729a7(0x25c)](verify('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedAud':[_0x5729a7(0x1f6),/^D/]}),{'a':0x1,'jti':_0x5729a7(0x187),'aud':[_0x6c1676[_0x5729a7(0x249)],_0x5729a7(0x22f)],'iss':_0x6c1676[_0x5729a7(0x1db)],'sub':'SUB','nonce':_0x5729a7(0x12f)});}),test(_0x43a10d(0x10a),_0x3eaefb=>{const _0x23564c=_0x43a10d,_0x46a45d={'rmNrA':function(_0x27b4a3,_0x1f202d,_0x451633){return _0x27b4a3(_0x1f202d,_0x451633);},'HrrSb':_0x23564c(0x20b),'ErQiJ':_0x23564c(0x263),'JnrAb':_0x23564c(0xfc),'JxQTX':_0x23564c(0x268),'ARHtl':'The\x20iss\x20claim\x20value\x20is\x20not\x20allowed.','QZStp':_0x23564c(0x187),'FSXSa':_0x23564c(0x19d),'GbnZj':_0x23564c(0x22f),'bYmJl':_0x23564c(0x1e2),'IAbJC':'SUB','jlyhU':_0x23564c(0x12f)};_0x3eaefb[_0x23564c(0x1a8)]['throws'](()=>{const _0x41a534=_0x23564c;return _0x46a45d[_0x41a534(0x106)](verify,_0x46a45d[_0x41a534(0x109)],{'allowedIss':'ISS1'});},{'message':_0x46a45d[_0x23564c(0x15d)]}),_0x3eaefb[_0x23564c(0x1a8)][_0x23564c(0x123)](()=>{const _0x3402a1=_0x23564c;return verify(_0x46a45d[_0x3402a1(0xe1)],{'allowedIss':_0x3402a1(0x146)});},{'message':_0x23564c(0x241)}),_0x3eaefb['assert'][_0x23564c(0x123)](()=>{const _0x1e33fd=_0x23564c;return verify(_0x46a45d[_0x1e33fd(0xe1)],{'allowedIss':[/abc/,_0x46a45d[_0x1e33fd(0x1bf)]]});},{'message':_0x46a45d[_0x23564c(0x1fe)]}),_0x3eaefb['assert']['deepStrictEqual'](verify('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedIss':'ISS'}),{'a':0x1,'jti':_0x46a45d[_0x23564c(0x195)],'aud':[_0x46a45d[_0x23564c(0x160)],_0x46a45d['GbnZj']],'iss':_0x46a45d[_0x23564c(0x103)],'sub':_0x46a45d[_0x23564c(0xef)],'nonce':_0x23564c(0x12f)}),_0x3eaefb[_0x23564c(0x1a8)]['deepStrictEqual'](verify(_0x23564c(0x263),{'allowedIss':[_0x23564c(0x1f6),_0x46a45d[_0x23564c(0x103)]]}),{'a':0x1,'jti':_0x46a45d[_0x23564c(0x195)],'aud':[_0x23564c(0x19d),_0x23564c(0x22f)],'iss':_0x46a45d[_0x23564c(0x103)],'sub':_0x23564c(0x221),'nonce':'NONCE'}),_0x3eaefb[_0x23564c(0x1a8)][_0x23564c(0x25c)](verify(_0x46a45d[_0x23564c(0xe1)],{'allowedIss':[_0x23564c(0x1f6),/^I/]}),{'a':0x1,'jti':_0x46a45d['QZStp'],'aud':[_0x46a45d[_0x23564c(0x160)],_0x46a45d[_0x23564c(0x18a)]],'iss':_0x23564c(0x1e2),'sub':_0x46a45d[_0x23564c(0xef)],'nonce':_0x46a45d[_0x23564c(0x11c)]});}),test(_0x43a10d(0xe5),_0x20cbc3=>{const _0x180eec=_0x43a10d,_0x3bac38={'YFlET':function(_0x5a27be,_0x776131,_0xe6e19f){return _0x5a27be(_0x776131,_0xe6e19f);},'vwbOW':_0x180eec(0x20b),'ZRVxD':_0x180eec(0x18e),'qGIqa':_0x180eec(0x263),'DFwtZ':'SUB','BQEXm':_0x180eec(0x187),'CgDZL':_0x180eec(0x19d),'YMSvH':_0x180eec(0x22f),'GxFek':_0x180eec(0x1f6)};_0x20cbc3[_0x180eec(0x1a8)][_0x180eec(0x123)](()=>{const _0x260039=_0x180eec;return _0x3bac38[_0x260039(0x26b)](verify,_0x3bac38['vwbOW'],{'allowedSub':_0x3bac38[_0x260039(0x238)]});},{'message':_0x180eec(0x16e)}),_0x20cbc3['assert']['throws'](()=>{const _0x58b719=_0x180eec;return verify(_0x3bac38[_0x58b719(0xe6)],{'allowedSub':_0x58b719(0x18e)});},{'message':_0x180eec(0x1c9)}),_0x20cbc3[_0x180eec(0x1a8)][_0x180eec(0x123)](()=>{const _0x4083d3=_0x180eec;return verify(_0x3bac38['qGIqa'],{'allowedSub':[/abc/,_0x4083d3(0xfc)]});},{'message':_0x180eec(0x1c9)}),_0x20cbc3[_0x180eec(0x1a8)][_0x180eec(0x25c)](verify(_0x3bac38['qGIqa'],{'allowedSub':_0x3bac38[_0x180eec(0x277)]}),{'a':0x1,'jti':_0x3bac38['BQEXm'],'aud':[_0x3bac38[_0x180eec(0x10d)],'DUA2'],'iss':_0x180eec(0x1e2),'sub':_0x3bac38[_0x180eec(0x277)],'nonce':_0x180eec(0x12f)}),_0x20cbc3[_0x180eec(0x1a8)][_0x180eec(0x25c)](_0x3bac38['YFlET'](verify,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedSub':[_0x180eec(0x1f6),'SUB']}),{'a':0x1,'jti':_0x180eec(0x187),'aud':[_0x180eec(0x19d),_0x3bac38[_0x180eec(0x170)]],'iss':_0x180eec(0x1e2),'sub':_0x180eec(0x221),'nonce':_0x180eec(0x12f)}),_0x20cbc3[_0x180eec(0x1a8)][_0x180eec(0x25c)](_0x3bac38['YFlET'](verify,_0x3bac38[_0x180eec(0xe6)],{'allowedSub':[_0x3bac38[_0x180eec(0xfd)],/^S/]}),{'a':0x1,'jti':_0x3bac38['BQEXm'],'aud':['AUD1',_0x3bac38['YMSvH']],'iss':_0x180eec(0x1e2),'sub':_0x3bac38['DFwtZ'],'nonce':_0x180eec(0x12f)});}),test(_0x43a10d(0x205),_0x5c7a5c=>{const _0x28f39e=_0x43a10d,_0xe2e7b9={'KfCRt':function(_0x3330b9,_0x5e15bd,_0x14b234){return _0x3330b9(_0x5e15bd,_0x14b234);},'nguah':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw','UVFlB':_0x28f39e(0x18f),'EVTub':_0x28f39e(0x23d),'oUXaF':_0x28f39e(0xf7),'RcMqe':function(_0x3b401e,_0x25e0f3,_0x82345d){return _0x3b401e(_0x25e0f3,_0x82345d);},'YGBft':function(_0x4fb24e,_0x485c44,_0x4136cc){return _0x4fb24e(_0x485c44,_0x4136cc);},'jCLcC':_0x28f39e(0x166),'GhuYh':_0x28f39e(0x12f),'kKKmW':_0x28f39e(0x187),'DVmmg':_0x28f39e(0x19d),'IzcoM':'DUA2','wFkfO':_0x28f39e(0x1e2),'ntJyH':_0x28f39e(0x221),'QxUsw':function(_0x410bf8,_0x3a5b69,_0x2d1c0a){return _0x410bf8(_0x3a5b69,_0x2d1c0a);}};_0x5c7a5c[_0x28f39e(0x1a8)][_0x28f39e(0x123)](()=>{const _0x5e4e0e=_0x28f39e;return _0xe2e7b9['UVFlB']===_0xe2e7b9[_0x5e4e0e(0x226)]?_0xe2e7b9[_0x5e4e0e(0x18c)](_0x2071a4,_0xe2e7b9[_0x5e4e0e(0x19e)],{'allowedNonce':_0x5e4e0e(0xf7)}):verify(_0x5e4e0e(0x20b),{'allowedNonce':_0xe2e7b9[_0x5e4e0e(0x185)]});},{'message':_0x28f39e(0x121)}),_0x5c7a5c[_0x28f39e(0x1a8)][_0x28f39e(0x123)](()=>{const _0x2d0275=_0x28f39e;return _0xe2e7b9[_0x2d0275(0x1ad)](verify,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedNonce':_0xe2e7b9['oUXaF']});},{'message':_0xe2e7b9[_0x28f39e(0x232)]}),_0x5c7a5c[_0x28f39e(0x1a8)]['throws'](()=>{const _0x23c7ea=_0x28f39e;return _0xe2e7b9[_0x23c7ea(0x1e9)](verify,_0x23c7ea(0x263),{'allowedNonce':[/abc/,_0x23c7ea(0xfc)]});},{'message':_0xe2e7b9['jCLcC']}),_0x5c7a5c[_0x28f39e(0x1a8)]['deepStrictEqual'](verify('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedNonce':_0xe2e7b9[_0x28f39e(0x13b)]}),{'a':0x1,'jti':_0xe2e7b9['kKKmW'],'aud':[_0xe2e7b9[_0x28f39e(0x1e5)],_0xe2e7b9['IzcoM']],'iss':_0x28f39e(0x1e2),'sub':'SUB','nonce':_0xe2e7b9[_0x28f39e(0x13b)]}),_0x5c7a5c[_0x28f39e(0x1a8)][_0x28f39e(0x25c)](verify(_0x28f39e(0x263),{'allowedNonce':[_0x28f39e(0x1f6),_0xe2e7b9['GhuYh']]}),{'a':0x1,'jti':_0xe2e7b9[_0x28f39e(0x1d8)],'aud':[_0x28f39e(0x19d),_0xe2e7b9['IzcoM']],'iss':_0xe2e7b9[_0x28f39e(0x145)],'sub':_0xe2e7b9[_0x28f39e(0x19a)],'nonce':_0x28f39e(0x12f)}),_0x5c7a5c[_0x28f39e(0x1a8)][_0x28f39e(0x25c)](_0xe2e7b9[_0x28f39e(0x1b5)](verify,'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedNonce':[_0x28f39e(0x1f6),/^N/]}),{'a':0x1,'jti':_0xe2e7b9[_0x28f39e(0x1d8)],'aud':[_0x28f39e(0x19d),_0x28f39e(0x22f)],'iss':_0xe2e7b9[_0x28f39e(0x145)],'sub':_0xe2e7b9[_0x28f39e(0x19a)],'nonce':_0x28f39e(0x12f)});}),test(_0x43a10d(0x1c5),_0x4b3ae7=>{const _0x3ae1f1=_0x43a10d,_0x205577={'otAWG':function(_0x5e8c57,_0x468f46,_0x3ced32){return _0x5e8c57(_0x468f46,_0x3ced32);},'dzquU':'ISS','htNNw':_0x3ae1f1(0x26e),'ZkIVF':_0x3ae1f1(0x241)};_0x4b3ae7[_0x3ae1f1(0x1a8)]['throws'](()=>{const _0x4d0e61=_0x3ae1f1;return _0x205577[_0x4d0e61(0x1f2)](verify,_0x4d0e61(0x1f7),{'allowedIss':_0x205577[_0x4d0e61(0x149)]});},{'message':'The\x20iss\x20claim\x20value\x20is\x20not\x20allowed.'}),_0x4b3ae7[_0x3ae1f1(0x1a8)][_0x3ae1f1(0x123)](()=>{const _0x287179=_0x3ae1f1;return _0x205577[_0x287179(0x1f2)](verify,_0x205577[_0x287179(0xea)],{'allowedIss':_0x287179(0x1e2)});},{'message':_0x205577[_0x3ae1f1(0x194)]});}),test(_0x43a10d(0x266),_0x2a939c=>{const _0x37bf18=_0x43a10d,_0x14331a={'prpBb':function(_0xf7ac79,_0x53e8fe,_0x330466){return _0xf7ac79(_0x53e8fe,_0x330466);},'CSPnt':function(_0x3bc6ea,_0x42f118,_0x5b4d66){return _0x3bc6ea(_0x42f118,_0x5b4d66);},'QCunY':_0x37bf18(0x1e2)},_0xfcf012=_0x37bf18(0x1bd);_0x2a939c[_0x37bf18(0x1a8)][_0x37bf18(0x25c)](_0x14331a[_0x37bf18(0x101)](verify,_0xfcf012,{'allowedIss':_0x14331a[_0x37bf18(0x20a)],'requiredClaims':['iss']}),{'iss':_0x14331a[_0x37bf18(0x20a)]}),_0x2a939c[_0x37bf18(0x1a8)][_0x37bf18(0x123)](()=>{const _0x3047fe=_0x37bf18;return _0x14331a[_0x3047fe(0x228)](verify,_0xfcf012,{'allowedSub':'SUB','requiredClaims':[_0x3047fe(0x22d)]});},{'message':_0x37bf18(0x1a2)});}),test(_0x43a10d(0x275),_0x4e3372=>{const _0x2fe713=_0x43a10d,_0x5849b6={'gMejY':function(_0x93f6d1,_0x58826b,_0x216e5d){return _0x93f6d1(_0x58826b,_0x216e5d);},'IWmoZ':'customTwo','ngKqM':function(_0xef9780,_0x3a4d28,_0x16bf04){return _0xef9780(_0x3a4d28,_0x16bf04);},'fPqoz':'iss','QSgdf':_0x2fe713(0x180),'EjzoO':_0x2fe713(0x11d),'fvcVd':_0x2fe713(0x155)},_0x2fc89b='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJJU1MiLCJjdXN0b20iOiJjdXN0b20iLCJpYXQiOjE3MDgwMjQxMTh9.rD9GaHxuSB7mPkVQ2shj4yqPsvEuXWByMDNhMoch0xY';_0x4e3372['assert'][_0x2fe713(0x25c)](_0x5849b6['ngKqM'](verify,_0x2fc89b,{'requiredClaims':[_0x5849b6['fPqoz'],_0x5849b6[_0x2fe713(0x17b)]]}),{'iss':_0x2fe713(0x1e2),'custom':'custom','iat':0x65ce6136}),_0x4e3372['assert']['throws'](()=>{const _0x1515e9=_0x2fe713;return verify(_0x2fc89b,{'requiredClaims':[_0x1515e9(0x1cc)]});},{'message':_0x5849b6[_0x2fe713(0x14f)]}),_0x4e3372[_0x2fe713(0x1a8)]['throws'](()=>{const _0x58a47e=_0x2fe713;return _0x5849b6[_0x58a47e(0x1c1)](verify,_0x2fc89b,{'requiredClaims':[_0x5849b6[_0x58a47e(0x253)]]});},{'message':_0x5849b6[_0x2fe713(0x25b)]});}),test('it\x20skips\x20validation\x20when\x20an\x20allowed\x20claim\x20isn\x27t\x20present\x20in\x20the\x20payload',_0x96c521=>{const _0x3670d0=_0x43a10d,_0x2dd1fe={'NDWiu':_0x3670d0(0x1bd),'BYlpr':_0x3670d0(0x1e2)},_0xbf7a78=_0x2dd1fe['NDWiu'];_0x96c521[_0x3670d0(0x1a8)][_0x3670d0(0x25c)](verify(_0xbf7a78,{'allowedIss':_0x3670d0(0x1e2),'allowedAud':'AUD'}),{'iss':_0x2dd1fe[_0x3670d0(0x11e)]});}),test(_0x43a10d(0x1ef),_0xde8005=>{const _0x255503=_0x43a10d,_0x3e1a21={'GkAxq':'The\x20token\x20must\x20be\x20a\x20string\x20or\x20a\x20buffer.'};_0xde8005[_0x255503(0x1a8)][_0x255503(0x123)](()=>createVerifier({'key':_0x255503(0x199)})(0x7b),{'message':_0x3e1a21[_0x255503(0x22a)]});}),test(_0x43a10d(0x15c),_0xb42c71=>{const _0x397538=_0x43a10d,_0xfc64d5={'hGJDh':_0x397538(0x12c)};_0xb42c71['assert'][_0x397538(0x123)](()=>createVerifier({'key':0x7b}),{'message':_0xfc64d5[_0x397538(0x22e)]});}),test(_0x43a10d(0x206),_0x20f1d9=>{const _0x5aa828=_0x43a10d,_0x2f16f6={'XSnrZ':'The\x20clockTimestamp\x20option\x20must\x20be\x20a\x20positive\x20number.'};_0x20f1d9[_0x5aa828(0x1a8)][_0x5aa828(0x123)](()=>createVerifier({'key':_0x5aa828(0x199),'clockTimestamp':_0x5aa828(0x169)}),{'message':_0x5aa828(0x1b7)}),_0x20f1d9['assert']['throws'](()=>createVerifier({'key':_0x5aa828(0x199),'clockTimestamp':-0x1}),{'message':_0x2f16f6[_0x5aa828(0x222)]});}),test(_0x43a10d(0x22c),_0x2411fb=>{const _0x6ae9d6=_0x43a10d,_0x222222={'bhJHI':'The\x20clockTolerance\x20option\x20must\x20be\x20a\x20positive\x20number.'};_0x2411fb[_0x6ae9d6(0x1a8)][_0x6ae9d6(0x123)](()=>createVerifier({'key':'secret','clockTolerance':_0x6ae9d6(0x169)}),{'message':_0x222222[_0x6ae9d6(0x1de)]}),_0x2411fb[_0x6ae9d6(0x1a8)][_0x6ae9d6(0x123)](()=>createVerifier({'key':_0x6ae9d6(0x199),'clockTolerance':-0x1}),{'message':_0x6ae9d6(0x271)});}),test('options\x20validation\x20-\x20cacheTTL',_0x577d2f=>{const _0x272b70=_0x43a10d,_0x34a664={'ryotR':_0x272b70(0x1fa)};_0x577d2f[_0x272b70(0x1a8)][_0x272b70(0x123)](()=>createVerifier({'key':'secret','cacheTTL':_0x272b70(0x169)}),{'message':_0x34a664[_0x272b70(0x1d6)]}),_0x577d2f[_0x272b70(0x1a8)]['throws'](()=>createVerifier({'key':_0x272b70(0x199),'cacheTTL':-0x1}),{'message':_0x272b70(0x1fa)});}),test(_0x43a10d(0x119),_0x5eb864=>{const _0x2a8eaa=_0x43a10d;_0x5eb864[_0x2a8eaa(0x1a8)][_0x2a8eaa(0x123)](()=>createVerifier({'key':'secret','requiredClaims':_0x2a8eaa(0x1e2)}),{'message':_0x2a8eaa(0x140)});}),test('caching\x20-\x20sync',_0xbdbbbc=>{const _0x50be68=_0x43a10d,_0x210b1a={'NoAft':_0x50be68(0x235),'haPya':_0x50be68(0x199),'priBl':function(_0x545ccf,_0xefed15){return _0x545ccf(_0xefed15);},'Koctm':_0x50be68(0x124),'ZWjXv':function(_0x6aa3ec,_0x13dc14){return _0x6aa3ec(_0x13dc14);},'HfZCe':function(_0xc72ba6,_0x165458){return _0xc72ba6 instanceof _0x165458;}},_0x4db7a1=_0x210b1a[_0x50be68(0x207)],_0x315b70=_0x50be68(0x1f5),_0x206869=createVerifier({'key':_0x210b1a[_0x50be68(0xff)],'cache':!![]});_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x192)](_0x206869['cache'][_0x50be68(0x15e)],0x0),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x25c)](_0x210b1a[_0x50be68(0x1fb)](_0x206869,_0x4db7a1),{'a':0x1}),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x192)](_0x206869[_0x50be68(0x107)]['size'],0x1),_0xbdbbbc['assert'][_0x50be68(0x25c)](_0x206869(_0x4db7a1),{'a':0x1}),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x192)](_0x206869['cache'][_0x50be68(0x15e)],0x1),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x123)](()=>_0x206869(_0x315b70),{'message':_0x210b1a[_0x50be68(0xec)]}),_0xbdbbbc[_0x50be68(0x1a8)]['equal'](_0x206869[_0x50be68(0x107)][_0x50be68(0x15e)],0x2),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x123)](()=>_0x206869(_0x315b70),{'message':_0x210b1a[_0x50be68(0xec)]}),_0xbdbbbc[_0x50be68(0x1a8)][_0x50be68(0x192)](_0x206869[_0x50be68(0x107)][_0x50be68(0x15e)],0x2),_0xbdbbbc[_0x50be68(0x1a8)]['deepStrictEqual'](_0x206869['cache'][_0x50be68(0x21e)](_0x210b1a[_0x50be68(0x14b)](hashToken,_0x4db7a1))[0x0],{'a':0x1}),_0xbdbbbc[_0x50be68(0x1a8)]['ok'](_0x210b1a[_0x50be68(0x130)](_0x206869[_0x50be68(0x107)][_0x50be68(0x21e)](hashToken(_0x315b70))[0x0],TokenError));}),test(_0x43a10d(0x20e),_0x100ec0=>{const _0x2f16d1=_0x43a10d,_0xd0e84={'owDPK':_0x2f16d1(0x235),'wiRNj':function(_0x2e98f3,_0x1b08e0){return _0x2e98f3(_0x1b08e0);},'oSPHL':_0x2f16d1(0x199),'iJIeE':_0x2f16d1(0x124)},_0x5edbb7=_0xd0e84['owDPK'],_0xebf6a9='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.aaa',_0x10b9d3=_0xd0e84[_0x2f16d1(0x16c)](createVerifier,{'key':_0xd0e84[_0x2f16d1(0x189)],'cache':!![],'cacheKeyBuilder':_0x177c8d=>_0x177c8d});_0x100ec0[_0x2f16d1(0x1a8)][_0x2f16d1(0x192)](_0x10b9d3[_0x2f16d1(0x107)][_0x2f16d1(0x15e)],0x0),_0x100ec0['assert'][_0x2f16d1(0x25c)](_0xd0e84[_0x2f16d1(0x16c)](_0x10b9d3,_0x5edbb7),{'a':0x1}),_0x100ec0[_0x2f16d1(0x1a8)][_0x2f16d1(0x192)](_0x10b9d3[_0x2f16d1(0x107)][_0x2f16d1(0x15e)],0x1),_0x100ec0[_0x2f16d1(0x1a8)][_0x2f16d1(0x25c)](_0x10b9d3(_0x5edbb7),{'a':0x1}),_0x100ec0['assert'][_0x2f16d1(0x192)](_0x10b9d3[_0x2f16d1(0x107)][_0x2f16d1(0x15e)],0x1),_0x100ec0['assert']['throws'](()=>_0x10b9d3(_0xebf6a9),{'message':'The\x20token\x20signature\x20is\x20invalid.'}),_0x100ec0[_0x2f16d1(0x1a8)]['equal'](_0x10b9d3[_0x2f16d1(0x107)]['size'],0x2),_0x100ec0[_0x2f16d1(0x1a8)]['throws'](()=>_0x10b9d3(_0xebf6a9),{'message':_0xd0e84[_0x2f16d1(0x1d1)]}),_0x100ec0[_0x2f16d1(0x1a8)][_0x2f16d1(0x192)](_0x10b9d3[_0x2f16d1(0x107)][_0x2f16d1(0x15e)],0x2),_0x100ec0['assert']['deepStrictEqual'](_0x10b9d3[_0x2f16d1(0x107)]['get'](_0x5edbb7)[0x0],{'a':0x1}),_0x100ec0[_0x2f16d1(0x1a8)]['ok'](_0x10b9d3[_0x2f16d1(0x107)][_0x2f16d1(0x21e)](_0xebf6a9)[0x0]instanceof TokenError);}),test(_0x43a10d(0x122),async _0x8026f7=>{const _0x32747e=_0x43a10d,_0x5d0cb5={'Izdrc':function(_0xe709a0,_0x3be723){return _0xe709a0(_0x3be723);},'nzxMk':function(_0x4876c9,_0x2e5d8a){return _0x4876c9(_0x2e5d8a);},'FFPBi':'The\x20token\x20signature\x20is\x20invalid.'},_0x34cbfb='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM',_0x4696f4='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.aaa',_0xff1382=_0x5d0cb5[_0x32747e(0x117)](createVerifier,{'key':async()=>_0x32747e(0x199),'cache':!![]});_0x8026f7[_0x32747e(0x1a8)][_0x32747e(0x192)](_0xff1382[_0x32747e(0x107)][_0x32747e(0x15e)],0x0),_0x8026f7[_0x32747e(0x1a8)][_0x32747e(0x25c)](await _0x5d0cb5['nzxMk'](_0xff1382,_0x34cbfb),{'a':0x1}),_0x8026f7['assert'][_0x32747e(0x192)](_0xff1382[_0x32747e(0x107)]['size'],0x1),_0x8026f7[_0x32747e(0x1a8)][_0x32747e(0x25c)](await _0x5d0cb5[_0x32747e(0x117)](_0xff1382,_0x34cbfb),{'a':0x1}),_0x8026f7[_0x32747e(0x1a8)]['equal'](_0xff1382[_0x32747e(0x107)][_0x32747e(0x15e)],0x1),await _0x8026f7['assert']['rejects'](async()=>_0xff1382(_0x4696f4),{'message':_0x5d0cb5[_0x32747e(0x1b6)]}),_0x8026f7['assert']['equal'](_0xff1382[_0x32747e(0x107)][_0x32747e(0x15e)],0x2),await _0x8026f7[_0x32747e(0x1a8)][_0x32747e(0x157)](async()=>_0xff1382(_0x4696f4),{'message':_0x32747e(0x124)}),_0x8026f7[_0x32747e(0x1a8)]['equal'](_0xff1382[_0x32747e(0x107)]['size'],0x2),_0x8026f7[_0x32747e(0x1a8)][_0x32747e(0x25c)](_0xff1382['cache'][_0x32747e(0x21e)](hashToken(_0x34cbfb))[0x0],{'a':0x1}),_0x8026f7[_0x32747e(0x1a8)]['ok'](_0xff1382[_0x32747e(0x107)]['get'](hashToken(_0x4696f4))[0x0]instanceof TokenError);});for(const type of['HS','ES','RS','PS']){for(const bits of['256',_0x43a10d(0x16b),_0x43a10d(0x223)]){const algorithm=''+type+bits,privateKey=privateKeys[type==='ES'?algorithm:type],publicKey=publicKeys[type==='ES'?algorithm:type];test('caching\x20-\x20should\x20use\x20the\x20right\x20hash\x20method\x20for\x20storing\x20values\x20-\x20'+algorithm,_0x165d9a=>{const _0x39dcad=_0x43a10d,_0x1e2a6c={'otuTU':function(_0x3ae845,_0x43b004){return _0x3ae845(_0x43b004);},'mYykv':_0x39dcad(0x1d0)},_0x186c7f=createSigner({'algorithm':algorithm,'key':privateKey,'noTimestamp':0x1}),_0x7b0eb0=createVerifier({'algorithm':algorithm,'key':publicKey,'cache':!![]}),_0x5433ed=_0x186c7f({'a':0x1}),_0x223165=_0x1e2a6c[_0x39dcad(0x178)](createHash,_0x39dcad(0x1c2)+bits)[_0x39dcad(0x203)](_0x5433ed)[_0x39dcad(0x136)](_0x1e2a6c[_0x39dcad(0x173)]);_0x165d9a['assert']['deepStrictEqual'](_0x1e2a6c[_0x39dcad(0x178)](_0x7b0eb0,_0x5433ed),{'a':0x1}),_0x165d9a[_0x39dcad(0x1a8)][_0x39dcad(0x192)](_0x7b0eb0['cache'][_0x39dcad(0x15e)],0x1),_0x165d9a[_0x39dcad(0x1a8)][_0x39dcad(0x192)](Array[_0x39dcad(0x10e)](_0x7b0eb0[_0x39dcad(0x107)][_0x39dcad(0x17d)]())[0x0],_0x223165);});}}test('caching\x20-\x20should\x20use\x20the\x20right\x20hash\x20method\x20for\x20storing\x20values\x20-\x20EdDSA\x20with\x20Ed25519',_0x29ec27=>{const _0xfe63f=_0x43a10d,_0x33d017={'uNubl':function(_0x2c6421,_0x410565){return _0x2c6421(_0x410565);},'ZcwGp':_0xfe63f(0x1d0)},_0x1294c5=createSigner({'algorithm':_0xfe63f(0xe4),'key':privateKeys[_0xfe63f(0x14e)],'noTimestamp':0x1}),_0x1e01f0=_0x33d017[_0xfe63f(0x236)](createVerifier,{'key':publicKeys['Ed25519'],'cache':!![]}),_0x30b884=_0x33d017[_0xfe63f(0x236)](_0x1294c5,{'a':0x1}),_0x3b499c=_0x33d017[_0xfe63f(0x236)](createHash,'sha512')[_0xfe63f(0x203)](_0x30b884)['digest'](_0x33d017['ZcwGp']);_0x29ec27[_0xfe63f(0x1a8)][_0xfe63f(0x25c)](_0x1e01f0(_0x30b884),{'a':0x1}),_0x29ec27[_0xfe63f(0x1a8)][_0xfe63f(0x192)](_0x1e01f0[_0xfe63f(0x107)][_0xfe63f(0x15e)],0x1),_0x29ec27[_0xfe63f(0x1a8)][_0xfe63f(0x192)](Array[_0xfe63f(0x10e)](_0x1e01f0[_0xfe63f(0x107)][_0xfe63f(0x17d)]())[0x0],_0x3b499c);}),test(_0x43a10d(0x1c3),_0x522798=>{const _0x16c81a=_0x43a10d,_0x4a15c7={'qPAnQ':_0x16c81a(0xe2),'ACDyR':function(_0x2ef6e4,_0x3c8f3b){return _0x2ef6e4(_0x3c8f3b);}},_0x4025ac=createSigner({'algorithm':_0x16c81a(0xe4),'key':privateKeys[_0x16c81a(0xe2)],'noTimestamp':0x1,'header':{'crv':_0x4a15c7[_0x16c81a(0x24b)]}}),_0x53d2d8=createVerifier({'key':publicKeys[_0x16c81a(0xe2)],'cache':!![]}),_0x2d376d=_0x4025ac({'a':0x1}),_0x414c43=createHash(_0x16c81a(0x11b),{'outputLength':0x72})[_0x16c81a(0x203)](_0x2d376d)[_0x16c81a(0x136)]('hex');_0x522798['assert']['deepStrictEqual'](_0x4a15c7[_0x16c81a(0x1f4)](_0x53d2d8,_0x2d376d),{'a':0x1}),_0x522798[_0x16c81a(0x1a8)][_0x16c81a(0x192)](_0x53d2d8[_0x16c81a(0x107)][_0x16c81a(0x15e)],0x1),_0x522798[_0x16c81a(0x1a8)][_0x16c81a(0x192)](Array['from'](_0x53d2d8[_0x16c81a(0x107)][_0x16c81a(0x17d)]())[0x0],_0x414c43);}),test('caching\x20-\x20should\x20be\x20able\x20to\x20manipulate\x20cache\x20directly',_0x2299ef=>{const _0x304825=_0x43a10d,_0x66a425={'stYly':function(_0x4679ad,_0x293566){return _0x4679ad(_0x293566);},'irkcn':_0x304825(0x199),'oDQgx':function(_0x297762,_0x165f0e){return _0x297762(_0x165f0e);},'ZZAVy':_0x304825(0x1d5)};_0x2299ef[_0x304825(0x159)][_0x304825(0x1e6)]['enable']({'now':0x186a0});const _0x32e1d5=_0x66a425['stYly'](createSigner,{'key':_0x66a425[_0x304825(0x245)],'expiresIn':0x186a0}),_0x408688=createVerifier({'key':'secret','cache':!![]}),_0x4f77cf=_0x66a425[_0x304825(0x1ce)](_0x32e1d5,{'a':0x1});_0x2299ef[_0x304825(0x1a8)][_0x304825(0x192)](_0x408688[_0x304825(0x107)][_0x304825(0x15e)],0x0),_0x2299ef['assert']['deepStrictEqual'](_0x408688(_0x4f77cf),{'a':0x1,'iat':0x64,'exp':0xc8}),_0x2299ef[_0x304825(0x1a8)][_0x304825(0x192)](_0x408688['cache'][_0x304825(0x15e)],0x1),_0x2299ef['assert'][_0x304825(0x25c)](_0x408688['cache']['get'](_0x66a425[_0x304825(0x171)](hashToken,_0x4f77cf)),[{'a':0x1,'iat':0x64,'exp':0xc8},0x0,0x30d40]),_0x408688[_0x304825(0x107)][_0x304825(0x219)](),_0x2299ef[_0x304825(0x1a8)][_0x304825(0x192)](_0x408688['cache'][_0x304825(0x15e)],0x0),_0x408688[_0x304825(0x107)]['set'](_0x4f77cf,_0x66a425['ZZAVy']),_0x2299ef[_0x304825(0x1a8)]['deepStrictEqual'](_0x408688[_0x304825(0x107)][_0x304825(0x21e)](_0x4f77cf),_0x66a425[_0x304825(0x274)]),_0x408688['cache'][_0x304825(0xfe)](_0x4f77cf,null),_0x2299ef[_0x304825(0x1a8)][_0x304825(0x25c)](_0x408688[_0x304825(0x107)][_0x304825(0x21e)](_0x4f77cf),null),_0x2299ef[_0x304825(0x159)][_0x304825(0x1e6)]['reset']();}),test(_0x43a10d(0x1aa),_0x1224c2=>{const _0x514dc2=_0x43a10d,_0x50f458={'JfvQB':function(_0x5cf0b3,_0x180238){return _0x5cf0b3(_0x180238);},'rosZa':_0x514dc2(0xf2),'oYnrp':function(_0x52b75b,_0x181767){return _0x52b75b instanceof _0x181767;}};_0x1224c2[_0x514dc2(0x159)]['timers'][_0x514dc2(0x25f)]({'now':0x186a0});const _0x4fca1e=_0x50f458[_0x514dc2(0x100)](createSigner,{'key':_0x514dc2(0x199),'expiresIn':0x186a0}),_0x423821=createVerifier({'key':'secret','cache':!![]}),_0x1bd9cd=_0x4fca1e({'a':0x1});_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x192)](_0x423821[_0x514dc2(0x107)][_0x514dc2(0x15e)],0x0),_0x1224c2[_0x514dc2(0x1a8)]['deepStrictEqual'](_0x423821(_0x1bd9cd),{'a':0x1,'iat':0x64,'exp':0xc8}),_0x1224c2[_0x514dc2(0x1a8)]['equal'](_0x423821[_0x514dc2(0x107)][_0x514dc2(0x15e)],0x1),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x25c)](_0x423821(_0x1bd9cd),{'a':0x1,'iat':0x64,'exp':0xc8}),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x192)](_0x423821[_0x514dc2(0x107)]['size'],0x1),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x25c)](_0x423821[_0x514dc2(0x107)]['get'](hashToken(_0x1bd9cd)),[{'a':0x1,'iat':0x64,'exp':0xc8},0x0,0x30d40]),_0x1224c2['mock']['timers']['tick'](0x30d40),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x123)](()=>_0x423821(_0x1bd9cd),{'message':_0x50f458[_0x514dc2(0x1e3)]}),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x192)](_0x423821['cache'][_0x514dc2(0x15e)],0x1),_0x1224c2['assert']['ok'](_0x50f458[_0x514dc2(0x175)](_0x423821[_0x514dc2(0x107)]['get'](_0x50f458['JfvQB'](hashToken,_0x1bd9cd))[0x0],TokenError)),_0x1224c2['assert'][_0x514dc2(0x123)](()=>_0x423821(_0x1bd9cd),{'message':_0x50f458[_0x514dc2(0x1e3)]}),_0x1224c2[_0x514dc2(0x1a8)]['throws'](()=>_0x423821(_0x1bd9cd),{'message':_0x50f458[_0x514dc2(0x1e3)]}),_0x1224c2[_0x514dc2(0x159)][_0x514dc2(0x1e6)][_0x514dc2(0x12e)](),_0x423821[_0x514dc2(0x107)]['clear'](),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x123)](()=>_0x423821(_0x1bd9cd),{'message':_0x514dc2(0xf2)}),_0x1224c2['assert']['equal'](_0x423821[_0x514dc2(0x107)][_0x514dc2(0x15e)],0x1),_0x1224c2[_0x514dc2(0x1a8)]['ok'](_0x50f458[_0x514dc2(0x175)](_0x423821[_0x514dc2(0x107)]['get'](hashToken(_0x1bd9cd))[0x0],TokenError));const _0x69615c=createVerifier({'key':_0x514dc2(0x199),'cache':!![],'clockTimestamp':0x186a0});_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x25c)](_0x69615c(_0x1bd9cd),{'a':0x1,'iat':0x64,'exp':0xc8}),_0x1224c2[_0x514dc2(0x1a8)][_0x514dc2(0x192)](_0x69615c[_0x514dc2(0x107)][_0x514dc2(0x15e)],0x1),_0x1224c2['assert']['deepStrictEqual'](_0x69615c['cache'][_0x514dc2(0x21e)](hashToken(_0x1bd9cd)),[{'a':0x1,'iat':0x64,'exp':0xc8},0x0,0x30d40]);}),test('caching\x20-\x20should\x20correctly\x20expire\x20cached\x20token\x20using\x20the\x20maxAge\x20claim',_0x293da5=>{const _0x371670=_0x43a10d,_0x213920={'frRSG':_0x371670(0x199),'QlCsh':function(_0x51a26c,_0x1b1fec){return _0x51a26c(_0x1b1fec);},'IZZRk':function(_0x399b8e,_0x3a72c6){return _0x399b8e(_0x3a72c6);},'IROvP':function(_0x20ef79,_0x2bf13f){return _0x20ef79(_0x2bf13f);},'SoEkU':function(_0x55189b,_0x3d0df6){return _0x55189b(_0x3d0df6);},'vxACI':_0x371670(0xf2),'ZCJtZ':function(_0x2273d1,_0x31d3df){return _0x2273d1(_0x31d3df);}};_0x293da5[_0x371670(0x159)]['timers'][_0x371670(0x25f)]({'now':0x186a0});const _0x386b83=createSigner({'key':_0x213920[_0x371670(0xdd)]}),_0x133022=_0x213920[_0x371670(0x23a)](createVerifier,{'key':_0x371670(0x199),'cache':!![],'maxAge':0x186a0}),_0x205d28=_0x213920[_0x371670(0x215)](_0x386b83,{'a':0x1});_0x293da5['assert'][_0x371670(0x192)](_0x133022[_0x371670(0x107)][_0x371670(0x15e)],0x0),_0x293da5['assert'][_0x371670(0x25c)](_0x213920['IROvP'](_0x133022,_0x205d28),{'a':0x1,'iat':0x64}),_0x293da5[_0x371670(0x1a8)][_0x371670(0x192)](_0x133022['cache'][_0x371670(0x15e)],0x1),_0x293da5['assert'][_0x371670(0x25c)](_0x133022(_0x205d28),{'a':0x1,'iat':0x64}),_0x293da5[_0x371670(0x1a8)]['equal'](_0x133022[_0x371670(0x107)]['size'],0x1),_0x293da5[_0x371670(0x1a8)][_0x371670(0x25c)](_0x133022['cache'][_0x371670(0x21e)](_0x213920[_0x371670(0x24e)](hashToken,_0x205d28)),[{'a':0x1,'iat':0x64},0x0,0x30d40]),_0x293da5[_0x371670(0x159)][_0x371670(0x1e6)][_0x371670(0x1ec)](0x30d40),_0x293da5[_0x371670(0x1a8)]['throws'](()=>_0x133022(_0x205d28),{'message':_0x213920['vxACI']}),_0x293da5['assert'][_0x371670(0x192)](_0x133022[_0x371670(0x107)][_0x371670(0x15e)],0x1),_0x293da5[_0x371670(0x1a8)]['ok'](_0x133022[_0x371670(0x107)]['get'](_0x213920[_0x371670(0x1d9)](hashToken,_0x205d28))[0x0]instanceof TokenError),_0x293da5[_0x371670(0x1a8)]['throws'](()=>_0x133022(_0x205d28),{'message':_0x213920[_0x371670(0x1ab)]}),_0x293da5[_0x371670(0x1a8)][_0x371670(0x123)](()=>_0x133022(_0x205d28),{'message':_0x213920['vxACI']}),_0x293da5[_0x371670(0x159)][_0x371670(0x1e6)]['reset']();}),test(_0x43a10d(0x1df),_0x359a45=>{const _0x2c193b=_0x43a10d,_0xf3ca32={'mSolZ':'secret','YtCcZ':function(_0x1189b2,_0x114a0d){return _0x1189b2(_0x114a0d);},'EYBsX':_0x2c193b(0x21f),'HaaPG':function(_0xe07088,_0x334e0f){return _0xe07088(_0x334e0f);}};_0x359a45[_0x2c193b(0x159)][_0x2c193b(0x1e6)][_0x2c193b(0x25f)]({'now':0x186a0});const _0x4c85ea=createSigner({'key':_0xf3ca32[_0x2c193b(0xed)],'notBefore':0x30d40}),_0x3b2861=_0xf3ca32[_0x2c193b(0x239)](createVerifier,{'key':_0xf3ca32[_0x2c193b(0xed)],'cache':!![]}),_0x55700c=_0x4c85ea({'a':0x1});_0x359a45['assert'][_0x2c193b(0x192)](_0x3b2861[_0x2c193b(0x107)][_0x2c193b(0x15e)],0x0),_0x359a45['assert'][_0x2c193b(0x123)](()=>_0x3b2861(_0x55700c),{'message':_0x2c193b(0x21f)}),_0x359a45[_0x2c193b(0x1a8)]['equal'](_0x3b2861[_0x2c193b(0x107)][_0x2c193b(0x15e)],0x1),_0x359a45[_0x2c193b(0x1a8)]['throws'](()=>_0x3b2861(_0x55700c),{'message':_0xf3ca32[_0x2c193b(0x276)]}),_0x359a45[_0x2c193b(0x1a8)]['ok'](_0x3b2861[_0x2c193b(0x107)][_0x2c193b(0x21e)](_0xf3ca32[_0x2c193b(0x1b3)](hashToken,_0x55700c))[0x0]instanceof TokenError),_0x359a45['mock']['timers'][_0x2c193b(0x1ec)](0x30d40),_0x359a45[_0x2c193b(0x1a8)][_0x2c193b(0x25c)](_0x3b2861(_0x55700c),{'a':0x1,'iat':0x64,'nbf':0x12c}),_0x359a45['assert'][_0x2c193b(0x192)](_0x3b2861[_0x2c193b(0x107)]['size'],0x1),_0x359a45['assert'][_0x2c193b(0x25c)](_0xf3ca32[_0x2c193b(0x1b3)](_0x3b2861,_0x55700c),{'a':0x1,'iat':0x64,'nbf':0x12c}),_0x359a45['assert'][_0x2c193b(0x192)](_0x3b2861[_0x2c193b(0x107)][_0x2c193b(0x15e)],0x1),_0x359a45['assert'][_0x2c193b(0x25c)](_0x3b2861[_0x2c193b(0x107)][_0x2c193b(0x21e)](_0xf3ca32['YtCcZ'](hashToken,_0x55700c)),[{'a':0x1,'iat':0x64,'nbf':0x12c},0x493e0,0xdbba0]),_0x359a45[_0x2c193b(0x159)][_0x2c193b(0x1e6)][_0x2c193b(0x12e)]();}),test(_0x43a10d(0xf5),_0x3f7a59=>{const _0x253ae7=_0x43a10d,_0x4941ab={'LcsHy':function(_0x3c2035,_0x3cd975){return _0x3c2035(_0x3cd975);},'svEOL':function(_0xcadf50,_0x51417a){return _0xcadf50(_0x51417a);},'GTwjQ':function(_0x10e6d1,_0x2ab5ed){return _0x10e6d1(_0x2ab5ed);}};_0x3f7a59['mock'][_0x253ae7(0x1e6)]['enable']({'now':0x186a0});const _0x4b3651=createSigner({'key':_0x253ae7(0x199),'notBefore':0x30d40}),_0x50e6f8=createVerifier({'key':_0x253ae7(0x199),'cache':!![]}),_0x267d92=_0x4941ab[_0x253ae7(0x251)](_0x4b3651,{'a':0x1});_0x3f7a59[_0x253ae7(0x1a8)]['equal'](_0x50e6f8['cache']['size'],0x0),_0x3f7a59['assert'][_0x253ae7(0x123)](()=>_0x50e6f8(_0x267d92),{'message':_0x253ae7(0x21f)}),_0x3f7a59['assert'][_0x253ae7(0x192)](_0x50e6f8[_0x253ae7(0x107)][_0x253ae7(0x15e)],0x1),_0x3f7a59[_0x253ae7(0x1a8)][_0x253ae7(0x123)](()=>_0x50e6f8(_0x267d92),{'message':_0x253ae7(0x21f)}),_0x3f7a59[_0x253ae7(0x1a8)]['ok'](_0x50e6f8['cache'][_0x253ae7(0x21e)](_0x4941ab[_0x253ae7(0x251)](hashToken,_0x267d92))[0x0]instanceof TokenError),_0x3f7a59[_0x253ae7(0x159)][_0x253ae7(0x1e6)][_0x253ae7(0x1ec)](0x30d4a),_0x3f7a59[_0x253ae7(0x1a8)][_0x253ae7(0x25c)](_0x4941ab[_0x253ae7(0x104)](_0x50e6f8,_0x267d92),{'a':0x1,'iat':0x64,'nbf':0x12c}),_0x3f7a59['assert'][_0x253ae7(0x192)](_0x50e6f8[_0x253ae7(0x107)][_0x253ae7(0x15e)],0x1),_0x3f7a59['assert']['deepStrictEqual'](_0x50e6f8(_0x267d92),{'a':0x1,'iat':0x64,'nbf':0x12c}),_0x3f7a59['assert'][_0x253ae7(0x192)](_0x50e6f8['cache'][_0x253ae7(0x15e)],0x1),_0x3f7a59[_0x253ae7(0x1a8)][_0x253ae7(0x25c)](_0x50e6f8[_0x253ae7(0x107)][_0x253ae7(0x21e)](_0x4941ab[_0x253ae7(0x23b)](hashToken,_0x267d92)),[{'a':0x1,'iat':0x64,'nbf':0x12c},0x493e0,0xdbbaa]),_0x3f7a59[_0x253ae7(0x159)]['timers'][_0x253ae7(0x12e)]();}),test(_0x43a10d(0xf3),_0xa93fc3=>{const _0x113b66=_0x43a10d,_0x46bc43={'wrKdr':_0x113b66(0x21f),'sAkla':function(_0x4433e2,_0x4b85a0){return _0x4433e2(_0x4b85a0);},'FPmZs':function(_0x2eda65,_0xabd7ee){return _0x2eda65 instanceof _0xabd7ee;},'basfM':_0x113b66(0x1b1)};_0xa93fc3[_0x113b66(0x159)][_0x113b66(0x1e6)][_0x113b66(0x25f)]({'now':0x186a0});const _0x467853=createSigner({'key':_0x113b66(0x199),'expiresIn':0x61a80,'notBefore':0x30d40}),_0x309642=createVerifier({'key':_0x113b66(0x199),'cache':!![]}),_0x541331=_0x467853({'a':0x1});_0xa93fc3[_0x113b66(0x1a8)][_0x113b66(0x192)](_0x309642['cache']['size'],0x0),_0xa93fc3[_0x113b66(0x1a8)][_0x113b66(0x123)](()=>_0x309642(_0x541331),{'message':_0x46bc43['wrKdr']}),_0xa93fc3['assert'][_0x113b66(0x192)](_0x309642[_0x113b66(0x107)][_0x113b66(0x15e)],0x1),_0xa93fc3[_0x113b66(0x1a8)]['throws'](()=>_0x309642(_0x541331),{'message':_0x113b66(0x21f)}),_0xa93fc3['assert']['ok'](_0x309642[_0x113b66(0x107)]['get'](hashToken(_0x541331))[0x0]instanceof TokenError),_0xa93fc3['mock'][_0x113b66(0x1e6)][_0x113b66(0x1ec)](0x30d40),_0xa93fc3['assert'][_0x113b66(0x25c)](_0x46bc43[_0x113b66(0xee)](_0x309642,_0x541331),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0xa93fc3[_0x113b66(0x1a8)][_0x113b66(0x192)](_0x309642[_0x113b66(0x107)]['size'],0x1),_0xa93fc3['assert'][_0x113b66(0x25c)](_0x309642(_0x541331),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0xa93fc3[_0x113b66(0x1a8)]['equal'](_0x309642['cache'][_0x113b66(0x15e)],0x1),_0xa93fc3[_0x113b66(0x1a8)][_0x113b66(0x25c)](_0x309642[_0x113b66(0x107)][_0x113b66(0x21e)](hashToken(_0x541331)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x493e0,0x7a120]),_0xa93fc3[_0x113b66(0x159)][_0x113b66(0x1e6)][_0x113b66(0x1ec)](0x33450),_0xa93fc3[_0x113b66(0x1a8)]['throws'](()=>_0x309642(_0x541331),{'message':'The\x20token\x20has\x20expired\x20at\x201970-01-01T00:08:20.000Z.'}),_0xa93fc3[_0x113b66(0x1a8)]['equal'](_0x309642[_0x113b66(0x107)][_0x113b66(0x15e)],0x1),_0xa93fc3['assert']['ok'](_0x46bc43[_0x113b66(0x265)](_0x309642[_0x113b66(0x107)][_0x113b66(0x21e)](_0x46bc43[_0x113b66(0xee)](hashToken,_0x541331))[0x0],TokenError)),_0xa93fc3[_0x113b66(0x1a8)]['throws'](()=>_0x309642(_0x541331),{'message':_0x46bc43['basfM']}),_0xa93fc3[_0x113b66(0x1a8)][_0x113b66(0x123)](()=>_0x309642(_0x541331),{'message':_0x113b66(0x1b1)}),_0xa93fc3[_0x113b66(0x159)][_0x113b66(0x1e6)]['reset']();}),test(_0x43a10d(0x1ae),_0x43d5d1=>{const _0x3675e3=_0x43a10d,_0x509993={'LPlst':function(_0x3c8334,_0x4a4266){return _0x3c8334(_0x4a4266);},'rWKIu':_0x3675e3(0x199),'MApUr':'The\x20token\x20will\x20be\x20active\x20at\x201970-01-01T00:04:00.000Z.','CUBzk':function(_0x25fcdb,_0x55ace0){return _0x25fcdb(_0x55ace0);},'jDLhc':function(_0x585937,_0x15abba){return _0x585937(_0x15abba);},'yayCL':_0x3675e3(0x1ea)};_0x43d5d1[_0x3675e3(0x159)][_0x3675e3(0x1e6)][_0x3675e3(0x25f)]({'now':0x186a0});const _0x11252a=_0x509993[_0x3675e3(0x23c)](createSigner,{'key':'secret','expiresIn':0x61a80,'notBefore':0x30d40}),_0x2a1748=createVerifier({'key':_0x509993['rWKIu'],'cache':!![],'clockTolerance':0xea60}),_0xc3e78=_0x509993['LPlst'](_0x11252a,{'a':0x1});_0x43d5d1['assert'][_0x3675e3(0x192)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x0),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x123)](()=>_0x2a1748(_0xc3e78),{'message':_0x3675e3(0x25e)}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x192)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x123)](()=>_0x2a1748(_0xc3e78),{'message':_0x509993[_0x3675e3(0x19c)]}),_0x43d5d1['assert']['ok'](_0x2a1748['cache'][_0x3675e3(0x21e)](hashToken(_0xc3e78))[0x0]instanceof TokenError),_0x43d5d1['mock'][_0x3675e3(0x1e6)][_0x3675e3(0x1ec)](0x222e0),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748(_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1['assert'][_0x3675e3(0x192)](_0x2a1748['cache'][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748(_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1['assert'][_0x3675e3(0x192)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x21e)](_0x509993[_0x3675e3(0x1da)](hashToken,_0xc3e78)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x3a980,0x88b80]),_0x43d5d1[_0x3675e3(0x159)][_0x3675e3(0x1e6)][_0x3675e3(0x1ec)](0x249f0),_0x43d5d1[_0x3675e3(0x1a8)]['deepStrictEqual'](_0x509993[_0x3675e3(0x1a1)](_0x2a1748,_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x192)](_0x2a1748['cache'][_0x3675e3(0x15e)],0x1),_0x43d5d1['assert'][_0x3675e3(0x25c)](_0x509993[_0x3675e3(0x23c)](_0x2a1748,_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1[_0x3675e3(0x1a8)]['equal'](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748[_0x3675e3(0x107)]['get'](_0x509993[_0x3675e3(0x1a1)](hashToken,_0xc3e78)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x3a980,0x88b80]),_0x43d5d1[_0x3675e3(0x159)][_0x3675e3(0x1e6)][_0x3675e3(0x1ec)](0x249f0),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x509993[_0x3675e3(0x1da)](_0x2a1748,_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x192)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748(_0xc3e78),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x192)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x25c)](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x21e)](_0x509993[_0x3675e3(0x1a1)](hashToken,_0xc3e78)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x3a980,0x88b80]),_0x43d5d1[_0x3675e3(0x159)][_0x3675e3(0x1e6)][_0x3675e3(0x1ec)](0x186a0),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x123)](()=>_0x2a1748(_0xc3e78),{'message':_0x509993['yayCL']}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x192)](_0x2a1748['cache'][_0x3675e3(0x15e)],0x1),_0x43d5d1[_0x3675e3(0x1a8)]['ok'](_0x2a1748[_0x3675e3(0x107)][_0x3675e3(0x21e)](hashToken(_0xc3e78))[0x0]instanceof TokenError),_0x43d5d1['assert'][_0x3675e3(0x123)](()=>_0x2a1748(_0xc3e78),{'message':_0x3675e3(0x1ea)}),_0x43d5d1[_0x3675e3(0x1a8)][_0x3675e3(0x123)](()=>_0x2a1748(_0xc3e78),{'message':_0x3675e3(0x1ea)}),_0x43d5d1['mock'][_0x3675e3(0x1e6)][_0x3675e3(0x12e)]();}),test(_0x43a10d(0x256),_0x4430a0=>{const _0x1aa7f5=_0x43a10d,_0x29abfe={'jSwRh':function(_0x1efedb,_0x14d2bb){return _0x1efedb(_0x14d2bb);},'yMMts':'secret','CsVJE':function(_0x401a78,_0x3d89f8){return _0x401a78(_0x3d89f8);},'iFByR':'The\x20token\x20will\x20be\x20active\x20at\x201970-01-01T00:05:00.000Z.','fBMxr':function(_0x4baa67,_0x37e8d3){return _0x4baa67 instanceof _0x37e8d3;},'fTlEs':function(_0x17f089,_0x5d3d55){return _0x17f089(_0x5d3d55);},'mmTSr':function(_0x27dc06,_0x1bd71c){return _0x27dc06(_0x1bd71c);},'xnfQY':function(_0x23190c,_0x386d79){return _0x23190c(_0x386d79);},'wYiYQ':function(_0x569659,_0x362ef3){return _0x569659(_0x362ef3);},'MxBBp':'The\x20token\x20has\x20expired\x20at\x201970-01-01T00:08:20.000Z.'};_0x4430a0['mock'][_0x1aa7f5(0x1e6)][_0x1aa7f5(0x25f)]({'now':0x186a0});const _0x20d906=createSigner({'key':'secret','expiresIn':0x61a80,'notBefore':0x30d40}),_0x5cc9a8=_0x29abfe[_0x1aa7f5(0x20f)](createVerifier,{'key':_0x29abfe['yMMts'],'cache':!![]}),_0x1508a3=createVerifier({'key':_0x29abfe[_0x1aa7f5(0x258)],'cache':!![],'ignoreNotBefore':!![]}),_0xcc9e51=_0x29abfe[_0x1aa7f5(0x231)](createVerifier,{'key':_0x29abfe[_0x1aa7f5(0x258)],'cache':!![],'ignoreExpiration':!![]}),_0x37b097=_0x20d906({'a':0x1});_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x192)](_0x5cc9a8['cache'][_0x1aa7f5(0x15e)],0x0),_0x4430a0[_0x1aa7f5(0x1a8)]['throws'](()=>_0x5cc9a8(_0x37b097),{'message':_0x29abfe[_0x1aa7f5(0xf6)]}),_0x4430a0['assert'][_0x1aa7f5(0x192)](_0x5cc9a8[_0x1aa7f5(0x107)]['size'],0x1),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x123)](()=>_0x5cc9a8(_0x37b097),{'message':_0x1aa7f5(0x21f)}),_0x4430a0[_0x1aa7f5(0x1a8)]['ok'](_0x29abfe[_0x1aa7f5(0x261)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x21e)](_0x29abfe[_0x1aa7f5(0xf1)](hashToken,_0x37b097))[0x0],TokenError)),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0x29abfe['mmTSr'](_0x1508a3,_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x192)](_0x1508a3[_0x1aa7f5(0x107)]['size'],0x1),_0x4430a0['assert']['deepStrictEqual'](_0x29abfe[_0x1aa7f5(0x15f)](_0x1508a3,_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x192)](_0x1508a3[_0x1aa7f5(0x107)]['size'],0x1),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0x1508a3[_0x1aa7f5(0x107)]['get'](hashToken(_0x37b097)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x0,0x7a120]),_0x4430a0[_0x1aa7f5(0x159)][_0x1aa7f5(0x1e6)][_0x1aa7f5(0x1ec)](0x30d40),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0x5cc9a8(_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0['assert'][_0x1aa7f5(0x192)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x15e)],0x1),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0x5cc9a8(_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x192)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x15e)],0x1),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x21e)](hashToken(_0x37b097)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x493e0,0x7a120]),_0x4430a0[_0x1aa7f5(0x159)][_0x1aa7f5(0x1e6)]['tick'](0x33450),_0x4430a0[_0x1aa7f5(0x1a8)]['throws'](()=>_0x5cc9a8(_0x37b097),{'message':'The\x20token\x20has\x20expired\x20at\x201970-01-01T00:08:20.000Z.'}),_0x4430a0['assert'][_0x1aa7f5(0x192)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x15e)],0x1),_0x4430a0[_0x1aa7f5(0x1a8)]['ok'](_0x29abfe[_0x1aa7f5(0x261)](_0x5cc9a8[_0x1aa7f5(0x107)][_0x1aa7f5(0x21e)](_0x29abfe[_0x1aa7f5(0x12b)](hashToken,_0x37b097))[0x0],TokenError)),_0x4430a0['assert'][_0x1aa7f5(0x123)](()=>_0x5cc9a8(_0x37b097),{'message':_0x29abfe['MxBBp']}),_0x4430a0[_0x1aa7f5(0x1a8)]['throws'](()=>_0x5cc9a8(_0x37b097),{'message':_0x1aa7f5(0x1b1)}),_0x4430a0['assert'][_0x1aa7f5(0x25c)](_0xcc9e51(_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x192)](_0xcc9e51['cache'][_0x1aa7f5(0x15e)],0x1),_0x4430a0[_0x1aa7f5(0x1a8)][_0x1aa7f5(0x25c)](_0xcc9e51(_0x37b097),{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4}),_0x4430a0['assert']['equal'](_0xcc9e51[_0x1aa7f5(0x107)][_0x1aa7f5(0x15e)],0x1),_0x4430a0[_0x1aa7f5(0x1a8)]['deepStrictEqual'](_0xcc9e51[_0x1aa7f5(0x107)]['get'](hashToken(_0x37b097)),[{'a':0x1,'iat':0x64,'nbf':0x12c,'exp':0x1f4},0x493e0,0x10eff0]),_0x4430a0['mock'][_0x1aa7f5(0x1e6)]['reset']();}),test('options\x20validation\x20-\x20errorCacheTTL',_0xd1a23e=>{const _0x135762=_0x43a10d,_0x6bbbe7={'tdozJ':'The\x20errorCacheTTL\x20option\x20must\x20be\x20a\x20number\x20greater\x20than\x20-1\x20or\x20a\x20function.'};_0xd1a23e[_0x135762(0x1a8)][_0x135762(0x123)](()=>createVerifier({'key':_0x135762(0x199),'errorCacheTTL':'123'}),{'message':_0x6bbbe7[_0x135762(0x176)]}),_0xd1a23e[_0x135762(0x1a8)][_0x135762(0x123)](()=>createVerifier({'key':_0x135762(0x199),'errorCacheTTL':-0x2}),{'message':_0x6bbbe7[_0x135762(0x176)]});}),test(_0x43a10d(0x212),async _0xe619ee=>{const _0x11d7e0=_0x43a10d,_0x5ca63a={'SAsgG':function(_0x297b0b,_0x18d13b){return _0x297b0b===_0x18d13b;},'pOOOR':_0x11d7e0(0xe9),'mIMbo':_0x11d7e0(0x235),'RyujP':function(_0x5bf915,_0x479692){return _0x5bf915(_0x479692);},'YriPJ':function(_0xc9af49,_0x275392){return _0xc9af49(_0x275392);}};_0xe619ee[_0x11d7e0(0x159)][_0x11d7e0(0x1e6)][_0x11d7e0(0x25f)]({'now':0x0});const _0x3bc5b8=_0x5ca63a[_0x11d7e0(0x23e)],_0x5cb65c=_0x5ca63a['RyujP'](createVerifier,{'key':async()=>{const _0xfca0e2=_0x11d7e0;if(_0x5ca63a[_0xfca0e2(0x118)](_0x5ca63a[_0xfca0e2(0xe7)],'efXYS'))throw new Error(_0xfca0e2(0x270));else{const _0x5ab62d={'kNqjm':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjAsIm5iZiI6MjAwMDAwMDAwMH0.PlCCCgSnL38HaOY1-bkWnz-LX9WW2b772Zs3oxQJIv4'};_0x145af0[_0xfca0e2(0x1a8)][_0xfca0e2(0x123)](()=>{const _0x3c68f8=_0xfca0e2;return _0x5e41f7(_0x5ab62d[_0x3c68f8(0x1dd)],{'algorithms':[_0x3c68f8(0x244)],'key':_0x33d62e['RS']});},{'message':_0xfca0e2(0x22b)});}},'cache':!![],'clockTolerance':0x0});_0xe619ee[_0x11d7e0(0x1a8)][_0x11d7e0(0x192)](_0x5cb65c[_0x11d7e0(0x107)]['size'],0x0),await _0xe619ee['assert'][_0x11d7e0(0x157)](async()=>_0x5cb65c(_0x3bc5b8)),_0xe619ee['assert'][_0x11d7e0(0x192)](_0x5cb65c[_0x11d7e0(0x107)][_0x11d7e0(0x15e)],0x1),_0xe619ee['assert'][_0x11d7e0(0x25c)](_0x5cb65c['cache'][_0x11d7e0(0x21e)](_0x5ca63a[_0x11d7e0(0x227)](hashToken,_0x3bc5b8))[0x2],-0x1),_0xe619ee['mock']['timers'][_0x11d7e0(0x12e)]();}),test('errors\x20should\x20have\x20ttl\x20equal\x20to\x20errorCacheTTL',async _0x134911=>{const _0xc597bc=_0x43a10d,_0x21305f={'zfdyZ':_0xc597bc(0x270)};_0x134911['mock'][_0xc597bc(0x1e6)][_0xc597bc(0x25f)]({'now':0x0});const _0x1e405a=0x4e20,_0x21495b=_0xc597bc(0x235),_0x4142ef=createVerifier({'key':async()=>{throw new Error(_0x21305f['zfdyZ']);},'cache':!![],'clockTolerance':0x0,'errorCacheTTL':_0x1e405a});_0x134911[_0xc597bc(0x1a8)]['equal'](_0x4142ef['cache'][_0xc597bc(0x15e)],0x0),await _0x134911[_0xc597bc(0x1a8)][_0xc597bc(0x157)](async()=>_0x4142ef(_0x21495b)),_0x134911[_0xc597bc(0x1a8)][_0xc597bc(0x192)](_0x4142ef[_0xc597bc(0x107)][_0xc597bc(0x15e)],0x1),_0x134911[_0xc597bc(0x1a8)][_0xc597bc(0x25c)](_0x4142ef[_0xc597bc(0x107)][_0xc597bc(0x21e)](hashToken(_0x21495b))[0x2],_0x1e405a),_0x134911[_0xc597bc(0x159)]['timers'][_0xc597bc(0x12e)]();}),test(_0x43a10d(0x26f),async _0x233966=>{const _0x4819d3=_0x43a10d,_0x3ca6d5={'RqMPA':function(_0x213087,_0x7d1a6b){return _0x213087(_0x7d1a6b);},'OicNd':function(_0xa5d6d1,_0x258a9b){return _0xa5d6d1+_0x258a9b;}};_0x233966[_0x4819d3(0x159)][_0x4819d3(0x1e6)][_0x4819d3(0x25f)]({'now':0x0});const _0x91fe90=0x4e20,_0x350231='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM',_0x2e4c71=_0x3ca6d5['RqMPA'](createVerifier,{'key':async()=>{const _0x53ec2b=_0x4819d3;throw new Error(_0x53ec2b(0x270));},'cache':!![],'clockTolerance':0x0,'errorCacheTTL':_0x91fe90});_0x233966[_0x4819d3(0x1a8)][_0x4819d3(0x192)](_0x2e4c71['cache']['size'],0x0),await _0x233966[_0x4819d3(0x1a8)][_0x4819d3(0x157)](async()=>_0x2e4c71(_0x350231)),_0x233966['assert']['equal'](_0x2e4c71[_0x4819d3(0x107)][_0x4819d3(0x15e)],0x1),_0x233966[_0x4819d3(0x1a8)][_0x4819d3(0x25c)](_0x2e4c71[_0x4819d3(0x107)]['get'](hashToken(_0x350231))[0x2],_0x91fe90),_0x233966[_0x4819d3(0x159)][_0x4819d3(0x1e6)][_0x4819d3(0x1ec)](0x3e8),await _0x233966[_0x4819d3(0x1a8)]['rejects'](async()=>_0x2e4c71(_0x350231)),_0x233966['assert'][_0x4819d3(0x25c)](_0x2e4c71[_0x4819d3(0x107)][_0x4819d3(0x21e)](hashToken(_0x350231))[0x2],_0x91fe90),_0x233966[_0x4819d3(0x159)][_0x4819d3(0x1e6)]['tick'](_0x91fe90),await _0x233966[_0x4819d3(0x1a8)][_0x4819d3(0x157)](async()=>_0x2e4c71(_0x350231)),_0x233966['assert'][_0x4819d3(0x25c)](_0x2e4c71['cache'][_0x4819d3(0x21e)](hashToken(_0x350231))[0x2],_0x3ca6d5[_0x4819d3(0x1f1)](_0x91fe90+0x3e8,_0x91fe90)),_0x233966[_0x4819d3(0x159)][_0x4819d3(0x1e6)][_0x4819d3(0x12e)]();}),test('errors\x20should\x20have\x20ttl\x20equal\x20to\x20errorCacheTTL\x20as\x20function',async _0x3304fc=>{const _0x19ae5a=_0x43a10d,_0x49d77e={'tQsGA':function(_0xf808eb,_0x2bf881){return _0xf808eb===_0x2bf881;},'bzPNh':'FAST_JWT_KEY_FETCHING_ERROR','vUCPB':_0x19ae5a(0x1d4),'UpYUq':_0x19ae5a(0x134)};_0x3304fc[_0x19ae5a(0x159)][_0x19ae5a(0x1e6)][_0x19ae5a(0x25f)]({'now':0x0});const _0x4e4412=0x7d0,_0x14bf36=_0x424a38=>{const _0x430295=_0x19ae5a;if(_0x49d77e[_0x430295(0x14d)](_0x424a38[_0x430295(0x1b9)],_0x49d77e[_0x430295(0x141)]))return _0x4e4412;return 0x3e8;},_0x388c97='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM',_0x124244=createVerifier({'key':async()=>{const _0x4c348a=_0x19ae5a,_0x4ba0bf={'cUzxu':_0x49d77e['vUCPB'],'nlwvt':_0x4c348a(0x127)};if(_0x49d77e['UpYUq']!==_0x4c348a(0x13c))throw new Error(_0x4c348a(0x128));else _0x5d4b96['plan'](0x1),_0x2db987(_0x4c348a(0x235),{'key':async _0xcc61e5=>{const _0x49c093=_0x4c348a;return _0x47e93b[_0x49c093(0x1a8)][_0x49c093(0x25c)](_0xcc61e5,{'header':{'typ':_0x4ba0bf['cUzxu'],'alg':_0x49c093(0x1f8)},'payload':{'a':0x1},'signature':_0x4ba0bf['nlwvt']}),_0xf358a8[_0x49c093(0x10e)]('secret',_0x49c093(0x213));},'noTimestamp':!![],'complete':!![]});},'cache':!![],'clockTolerance':0x0,'errorCacheTTL':_0x14bf36});_0x3304fc['assert'][_0x19ae5a(0x192)](_0x124244[_0x19ae5a(0x107)][_0x19ae5a(0x15e)],0x0),await _0x3304fc[_0x19ae5a(0x1a8)][_0x19ae5a(0x157)](async()=>_0x124244(_0x388c97)),_0x3304fc[_0x19ae5a(0x1a8)][_0x19ae5a(0x192)](_0x124244[_0x19ae5a(0x107)][_0x19ae5a(0x15e)],0x1),_0x3304fc[_0x19ae5a(0x1a8)][_0x19ae5a(0x25c)](_0x124244[_0x19ae5a(0x107)][_0x19ae5a(0x21e)](hashToken(_0x388c97))[0x2],_0x4e4412),_0x3304fc[_0x19ae5a(0x159)][_0x19ae5a(0x1e6)][_0x19ae5a(0x12e)]();}),test('invalid\x20errorCacheTTL\x20function\x20should\x20be\x20handle\x20',async _0xb0d609=>{const _0x2887dd=_0x43a10d,_0x55cc66={'BVXel':_0x2887dd(0x199),'ORGHE':function(_0x305926,_0x193cfe){return _0x305926/_0x193cfe;},'wVmXv':function(_0xbf75c1,_0x44c3fd){return _0xbf75c1===_0x44c3fd;},'Jnzpc':'invalid','TIaHf':_0x2887dd(0x235),'YekUK':function(_0x357be3,_0x28a5ad){return _0x357be3(_0x28a5ad);}};_0xb0d609[_0x2887dd(0x159)][_0x2887dd(0x1e6)][_0x2887dd(0x25f)]({'now':0x0});const _0x3b1476=()=>{const _0x4bcf68=_0x2887dd,_0x13ddb8={'jaVGd':function(_0x443f8d,_0x3b4e5b){return _0x443f8d(_0x3b4e5b);},'IIzHK':_0x55cc66['BVXel'],'FuZzM':function(_0x1c69ee,_0x4aa657){return _0x1c69ee/_0x4aa657;},'MYkKe':function(_0x3d69d1,_0x158a01){const _0x4b409a=_0x22ac;return _0x55cc66[_0x4b409a(0x151)](_0x3d69d1,_0x158a01);}};if(_0x55cc66['wVmXv']('iLRnZ',_0x4bcf68(0x17c))){const _0x276773=_0x49cef8['now'](),_0x5f0cb0=0x3e8,_0x5b497e=_0x13ddb8[_0x4bcf68(0xe0)](_0x5c9bfd,{'key':_0x13ddb8[_0x4bcf68(0x1af)],'clockTimestamp':_0x276773,'notBefore':_0x5f0cb0})({'a':0x1});_0x2a2112['assert']['deepStrictEqual'](_0x15e816(_0x5b497e,{'clockTolerance':0x1388}),{'a':0x1,'iat':_0x174dcb[_0x4bcf68(0x18b)](_0x13ddb8[_0x4bcf68(0x150)](_0x276773,0x3e8)),'nbf':_0x360eab[_0x4bcf68(0x18b)](_0x13ddb8[_0x4bcf68(0x158)](_0x276773+_0x5f0cb0,0x3e8))});}else throw new Error(_0x4bcf68(0x19b));},_0x1fce2e=_0x55cc66[_0x2887dd(0x1b4)],_0x4ef405=_0x55cc66[_0x2887dd(0x12a)](createVerifier,{'key':()=>{throw new Error(_0x55cc66['Jnzpc']);},'cache':!![],'clockTolerance':0x0,'errorCacheTTL':_0x3b1476});_0xb0d609[_0x2887dd(0x1a8)][_0x2887dd(0x192)](_0x4ef405[_0x2887dd(0x107)][_0x2887dd(0x15e)],0x0),_0xb0d609[_0x2887dd(0x1a8)]['throws'](()=>_0x4ef405(_0x1fce2e)),_0xb0d609['assert'][_0x2887dd(0x192)](_0x4ef405['cache'][_0x2887dd(0x15e)],0x0),_0xb0d609['mock'][_0x2887dd(0x1e6)][_0x2887dd(0x12e)]();}),test(_0x43a10d(0x167),async _0x98e472=>{const _0x1c2d64=_0x43a10d,_0x59ba80={'BmvbN':'SUB1','ZxWRa':_0x1c2d64(0x16e),'eSwgC':_0x1c2d64(0x1c9),'IxjrA':'JTI','jDOIm':'DUA2','oKkAU':_0x1c2d64(0x1f6),'HmlQL':_0x1c2d64(0x221),'mFTes':_0x1c2d64(0x19d),'HXonn':_0x1c2d64(0x12f),'aaChm':function(_0x3a92e2,_0x50fa16,_0x2c48ee){return _0x3a92e2(_0x50fa16,_0x2c48ee);},'MsKsz':_0x1c2d64(0x263),'JFoPt':_0x1c2d64(0x20b),'TGZoO':_0x1c2d64(0xfc),'OZEUt':'XBlfY','Dlvrg':'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM','NFhNJ':function(_0x698a00,_0x1960c5){return _0x698a00(_0x1960c5);},'cyWzQ':'check'};_0x98e472[_0x1c2d64(0x159)][_0x1c2d64(0x1e6)]['enable']({'now':0x0});const _0x2c9590=_0x59ba80[_0x1c2d64(0x1e7)],_0x158c9a=_0x59ba80[_0x1c2d64(0x21c)](createVerifier,{'key':async()=>{const _0x538400=_0x1c2d64,_0x212177={'ZZJeB':_0x59ba80[_0x538400(0x168)],'SPCKQ':_0x59ba80['MsKsz'],'mRsGP':_0x59ba80[_0x538400(0x1e4)]};if('XBlfY'!==_0x59ba80[_0x538400(0x26d)]){const _0x562cac={'RNCsp':_0x538400(0x263),'KRxkP':_0x59ba80[_0x538400(0x186)]};_0x29221d['assert']['throws'](()=>{const _0x3bd34e=_0x538400;return _0x24f967(_0x212177['ZZJeB'],{'allowedSub':_0x3bd34e(0x18e)});},{'message':_0x59ba80[_0x538400(0x1a0)]}),_0x44e93a[_0x538400(0x1a8)][_0x538400(0x123)](()=>{const _0x30c5a2=_0x538400;return _0x1d1211(_0x562cac[_0x30c5a2(0x204)],{'allowedSub':_0x562cac[_0x30c5a2(0x1e8)]});},{'message':_0x59ba80[_0x538400(0x1fd)]}),_0x2b8ed1[_0x538400(0x1a8)][_0x538400(0x123)](()=>{const _0x5eaf1d=_0x538400;return _0x26a3b0(_0x212177['SPCKQ'],{'allowedSub':[/abc/,_0x212177[_0x5eaf1d(0x267)]]});},{'message':_0x59ba80[_0x538400(0x1fd)]}),_0x499d64[_0x538400(0x1a8)][_0x538400(0x25c)](_0x2e56c6('eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw',{'allowedSub':_0x538400(0x221)}),{'a':0x1,'jti':_0x59ba80[_0x538400(0x20c)],'aud':[_0x538400(0x19d),_0x59ba80['jDOIm']],'iss':_0x538400(0x1e2),'sub':_0x538400(0x221),'nonce':_0x538400(0x12f)}),_0x1c4759[_0x538400(0x1a8)]['deepStrictEqual'](_0x51f13e(_0x538400(0x263),{'allowedSub':[_0x59ba80[_0x538400(0x1ed)],_0x59ba80[_0x538400(0x209)]]}),{'a':0x1,'jti':_0x59ba80['IxjrA'],'aud':[_0x59ba80['mFTes'],_0x538400(0x22f)],'iss':_0x538400(0x1e2),'sub':_0x538400(0x221),'nonce':_0x59ba80[_0x538400(0x125)]}),_0x494166['assert'][_0x538400(0x25c)](_0x59ba80[_0x538400(0x148)](_0x110a14,_0x59ba80['MsKsz'],{'allowedSub':[_0x59ba80[_0x538400(0x1ed)],/^S/]}),{'a':0x1,'jti':_0x538400(0x187),'aud':[_0x538400(0x19d),_0x538400(0x22f)],'iss':'ISS','sub':_0x538400(0x221),'nonce':_0x538400(0x12f)});}else throw new Error(_0x538400(0x270));},'cache':!![]}),_0x449f8e=_0x59ba80[_0x1c2d64(0xf8)];_0x98e472[_0x1c2d64(0x1a8)][_0x1c2d64(0x192)](_0x158c9a[_0x1c2d64(0x107)]['size'],0x0),await _0x98e472[_0x1c2d64(0x1a8)][_0x1c2d64(0x157)](async()=>_0x158c9a(_0x2c9590)),_0x98e472[_0x1c2d64(0x1a8)]['equal'](_0x158c9a['cache'][_0x1c2d64(0x15e)],0x1),_0x158c9a[_0x1c2d64(0x107)][_0x1c2d64(0xfe)](_0x59ba80[_0x1c2d64(0x21c)](hashToken,_0x2c9590),[_0x449f8e,0x0,-0x1]),await _0x98e472['assert']['rejects'](async()=>_0x158c9a(_0x2c9590)),_0x98e472['assert']['notDeepStrictEqual'](_0x158c9a[_0x1c2d64(0x107)][_0x1c2d64(0x21e)](hashToken(_0x2c9590))[0x0],_0x449f8e),_0x98e472['mock']['timers'][_0x1c2d64(0x12e)]();});function _0x178f(){const _0x39796c=['../benchmarks/keys/es-256-public.key','CsVJE','jCLcC','nheZg','now','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM','uNubl','YJEzo','ZRVxD','YtCcZ','QlCsh','GTwjQ','LPlst','LUHmH','mIMbo','2542790OfhDfG','KTJCw','The\x20iss\x20claim\x20value\x20is\x20not\x20allowed.','2712272VOZEdo','RS512','ES256','irkcn','The\x20token\x20signature\x20is\x20missing.','JTI1','kmyYv','HEXDe','../benchmarks/keys/ps-512-public.key','qPAnQ','ZMZNd','WeufE','SoEkU','antKT','The\x20token\x20algorithm\x20is\x20invalid.','LcsHy','it\x20correctly\x20handle\x20errors\x20-\x20callback','IWmoZ','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEIiwiRFVBMiJdLCJpc3MiOiJJU1MiLCJzdWIiOiJTVUIiLCJub25jZSI6Ik5PTkNFIn0.lhu5t694BY0QmF7SChUw7Z9nUPtupWCkhrQ2rqN06GU','eyJhbGciOiJFZERTQSIsInR5cCI6IkpXVCIsImt0eSI6Ik9LUCIsImNydiI6IkVkMjU1MTkifQ.eyJhIjoxfQ.n4isU7JqaKRVOyx2ni7b_iaAzB75pAUCW6CetcoClhtJ5yDM7YkNMbKqmDUhTKMpupAcztIjX8m4mZwpA33HAA','caching\x20-\x20should\x20ignore\x20the\x20nbf\x20and\x20exp\x20when\x20asked\x20to','ADlaE','yMMts','135552JMtQWJ','Invalid\x20typ.','fvcVd','deepStrictEqual','Wshko','The\x20token\x20will\x20be\x20active\x20at\x201970-01-01T00:04:00.000Z.','enable','kJpjI','fBMxr','it\x20validates\x20the\x20aud\x20claim\x20only\x20if\x20explicitily\x20enabled','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOiJKVEkiLCJhdWQiOlsiQVVEMSIsIkRVQTIiXSwiaXNzIjoiSVNTIiwic3ViIjoiU1VCIiwibm9uY2UiOiJOT05DRSJ9.8fqzi23J-GjaD7rW3OYJv8UtBYkx8MOkViJjS4sXmVw','it\x20correctly\x20verifies\x20a\x20token\x20-\x20sync','FPmZs','it\x20validates\x20whether\x20a\x20required\x20claim\x20is\x20present\x20in\x20the\x20payload\x20or\x20not','mRsGP','The\x20iss\x20claim\x20must\x20be\x20a\x20string.','vDndm','ZUtjT','YFlET','GzWuD','OZEUt','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpc3MiOiJTVUZGSVhfSVNTIn0.YNfIVGQCnIk0sQzsvOnLl_ueRs64m2M2BgiKyczzsAk','errors\x20should\x20have\x20ttl\x20equal\x20to\x20errorCacheTTL','invalid','The\x20clockTolerance\x20option\x20must\x20be\x20a\x20positive\x20number.','PPRS','6503aBGbLN','ZZAVy','it\x20validates\x20whether\x20a\x20required\x20custom\x20claim\x20is\x20present\x20in\x20the\x20payload\x20or\x20not','EYBsX','DFwtZ','PS256','IVrcf','frRSG','it\x20validates\x20if\x20the\x20token\x20is\x20active\x20including\x20the\x20clock\x20tolerance','lpNVt','jaVGd','ErQiJ','Ed448','../benchmarks/keys/ed-25519-public.key','EdDSA','it\x20validates\x20the\x20sub\x20claim\x20only\x20if\x20explicitily\x20enabled','qGIqa','pOOOR','HS512','efXYS','htNNw','TOKEN','Koctm','mSolZ','sAkla','IAbJC','UWsev','fTlEs','The\x20token\x20has\x20expired\x20at\x201970-01-01T00:03:20.000Z.','caching\x20-\x20should\x20be\x20able\x20to\x20consider\x20both\x20nbf\x20and\x20exp\x20field\x20at\x20the\x20same\x20time','it\x20validates\x20the\x20jti\x20claim\x20only\x20if\x20explicitily\x20enabled','caching\x20-\x20should\x20correctly\x20expire\x20not\x20yet\x20cached\x20token\x20using\x20the\x20nbf\x20claim\x20while\x20checking\x20after\x20expiry\x20period','iFByR','NONCE1','cyWzQ','hFhHr','../benchmarks/keys/ps-512-private.key','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ','cde','GxFek','set','haPya','JfvQB','CSPnt','node:fs','bYmJl','svEOL','kKYnR','rmNrA','cache','Vchfj','HrrSb','it\x20validates\x20the\x20iss\x20claim\x20only\x20if\x20explicitily\x20enabled','QXLpt','fRErA','CgDZL','from','jWjWQ','lCLKA','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjIwMDAwMDAwMDAsImV4cCI6MjEwMDAwMDAwMH0.vrIO0e4YNXgzqdj7RcTqmP8AlCuvfYoxJCkma78eILA','tCMme','maxGA','znxXX','rUPVN','hmqaD','Izdrc','SAsgG','options\x20validation\x20-\x20requiredClaims','it\x20correctly\x20verifies\x20a\x20token\x20-\x20callback\x20-\x20key\x20as\x20promise','shake256','jlyhU','The\x20kid\x20claim\x20is\x20required.','BYlpr','10327tnLIzO','139095CUkTSa','The\x20nonce\x20claim\x20must\x20be\x20a\x20string.','caching\x20-\x20async','throws','The\x20token\x20signature\x20is\x20invalid.','HXonn','FAILED','57TF7smP9XDhIexBqPC-F1toZReYZLWb_YRU5tv0sxM','error\x20fetching\x20key','HS384','YekUK','wYiYQ','The\x20key\x20option\x20must\x20be\x20a\x20string,\x20a\x20buffer\x20or\x20a\x20function\x20returning\x20the\x20algorithm\x20secret\x20or\x20public\x20key.','QHINz','reset','NONCE','HfZCe','customTwo','PS512','PmJbj','MuAKe','74OTliIj','digest','GNtBw','8536fZYmPY','PYvoP','FrhCK','GhuYh','wLMpZ','PS384','yTtQJ','hiMPv','The\x20requiredClaims\x20option\x20must\x20be\x20an\x20array.','bzPNh','test','message','The\x20token\x20has\x20expired\x20at\x201970-01-01T00:05:00.000Z.','wFkfO','ISS1','hIWJV','aaChm','dzquU','xUebd','ZWjXv','JXtFU','tQsGA','Ed25519','EjzoO','FuZzM','ORGHE','PBfcs','The\x20jti\x20claim\x20must\x20be\x20a\x20string.','MOGsL','The\x20customTwo\x20claim\x20is\x20required.','BDkEg','rejects','MYkKe','mock','The\x20key\x20option\x20is\x20missing.','RS256','options\x20validation\x20-\x20key','JxQTX','size','xnfQY','FSXSa','oFVHa','The\x20token\x20is\x20malformed.','CdCJM','it\x20validates\x20if\x20the\x20public\x20key\x20is\x20consistent\x20with\x20the\x20allowed\x20algorithms\x20-\x20sync\x20','1316523XQuNTt','The\x20nonce\x20claim\x20value\x20is\x20not\x20allowed.','default\x20errorCacheTTL\x20should\x20not\x20cache\x20errors\x20when\x20sub\x20millisecond\x20execution','JFoPt','123','../benchmarks/keys/es-384-private.key','384','wiRNj','RVjQb','The\x20sub\x20claim\x20must\x20be\x20a\x20string.','secretsecretsecret','YMSvH','stYly','fZTGd','mYykv','it\x20correctly\x20verifies\x20a\x20token\x20-\x20async\x20-\x20static\x20key','oYnrp','tdozJ','ES384','otuTU','mKKTc','The\x20token\x20has\x20expired\x20at\x201970-01-01T00:01:41.000Z.','QSgdf','TJOuF','keys','vokvJ','qdWDY','custom','LvxMp','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.57TF7smP9XDhIexBqPC-aaa','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjAsIm5iZiI6MjAwMDAwMDAwMH0.PlCCCgSnL38HaOY1-bkWnz-LX9WW2b772Zs3oxQJIv4','bcBUe','oUXaF','BmvbN','JTI','The\x20token\x20will\x20be\x20active\x20at\x202033-05-18T03:33:20.000Z.','oSPHL','GbnZj','floor','KfCRt','it\x20validates\x20if\x20the\x20token\x20is\x20active\x20unless\x20explicitily\x20disabled','SUB1','sKjXH','../benchmarks/keys/pprs-512-private.key','nextTick','equal','wLdvt','ZkIVF','QZStp','pUaWG','The\x20aud\x20claim\x20must\x20be\x20a\x20string\x20or\x20an\x20array\x20of\x20strings.','hmywX','secret','ntJyH','invalid\x20errorCacheTTL\x20function','MApUr','AUD1','nguah','SheHT','ZxWRa','jDLhc','The\x20sub\x20claim\x20is\x20required.','PRXQY','../src','LHjLR','ES512','eyJhbGciOiJIUzI1NiIsInR5cCI6MX0.eyJhIjoxfQ.V6I7eoKYlMG7ipqpsWoZcNZaGOVGPom0rnztq1q2tS4','assert','eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjE2MzU0MjY2OTl9.c5VeTRDL43sMxEk4pV7AV6nGJeRbJYw6tdKGfzq6bvjT-ai29gQc7baTAmoo16EuboUwBHoz_OEOtwsePetoc0wKtDoXY7t6dBWznV2Z4_7YSrnt2U62FZrlVDoLPYJRRHhB6sR2YyidoUWzfs821_SpeTeT4Ls-tlqWjIGkpUDktZiPKYIt9LkLFgZDaCBeQr39BMCagD3p0yGYIWZJNsIQKNvvUHjtF4Io9buPwKKA6FAfYgM5c1aTAkhhnRjZSjW0vu-Osxlbu-XO0-IF-0c4eGgf2LAh_jGM4bF1nQmExKI9Q0IpvbPD8pSzcIPndiHdgGxrJy7X9GktN6Vi2DQazcIXtjBIaBNO4VKew5GNIbSb-lHyeO7WBENE3WrVImS_9_i3z81M-F0w1C6MqmnKZ3qKLna3OG1pYU4mVQ2rvBNdHuVOrtJyE0IiCDQS-RKaKM0lOprHy_B6_TNRp_Y9oBCVOY1Kr8fczigfArwSlPai051AncK-zfHZwvP7_uBKitncmNDjr19xiLa79Fbm6mkSA8tZindDvBml1ZF9apNF51CCdO-ce9yqj3Aem2n1VXHLuq9sdIk_mlSZn9aLDOPUI22DcdhcSsySdKdWSf9F7dj5c1J9ppwxTxK3LHjIeiaCJWCmKvfu73j_rpKzbFzzwotQ3bsRave8gdY','caching\x20-\x20should\x20correctly\x20expire\x20cached\x20token\x20using\x20the\x20exp\x20claim','vxACI','../benchmarks/keys/rs-x509-private.key','RcMqe','caching\x20-\x20should\x20be\x20able\x20to\x20consider\x20clockTolerance\x20on\x20both\x20nbf\x20and\x20exp\x20field','IIzHK','TOnae','The\x20token\x20has\x20expired\x20at\x201970-01-01T00:08:20.000Z.','it\x20correctly\x20handle\x20errors\x20-\x20evented\x20callback','HaaPG','TIaHf','QxUsw','FFPBi','The\x20clockTimestamp\x20option\x20must\x20be\x20a\x20positive\x20number.','it\x20correctly\x20verifies\x20a\x20token\x20-\x20token\x20signed\x20with\x20encrypted\x20private\x20key','code','160bTvsOP','../benchmarks/keys/es-512-public.key','The\x20jti\x20claim\x20value\x20is\x20not\x20allowed.','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJJU1MifQ.FKjJd2A-T8ufN7Y0LpjMR23P7CwEQ3Y-LBIYd2Vh_Rs','rtKHK','JnrAb','RS384','gMejY','sha','caching\x20-\x20should\x20use\x20the\x20right\x20hash\x20method\x20for\x20storing\x20values\x20-\x20EdDSA\x20with\x20Ed448','node:path','it\x20validates\x20allowed\x20claims\x20values\x20using\x20equality\x20when\x20appropriate','it\x20correctly\x20verifies\x20a\x20token\x20-\x20async\x20-\x20key\x20with\x20callback','None\x20of\x20aud\x20claim\x20values\x20are\x20allowed.','tAzbS','The\x20sub\x20claim\x20value\x20is\x20not\x20allowed.','node:crypto','ebbgl','kid','it\x20rejects\x20invalid\x20tokens','oDQgx','CEaWy','hex','iJIeE','RSX509','it\x20correctly\x20handle\x20errors\x20-\x20async\x20callback','JWT','WHATEVER','ryotR','QuKRu','kKKmW','ZCJtZ','CUBzk','bymGq','oQrEE','kNqjm','bhJHI','caching\x20-\x20should\x20correctly\x20expire\x20not\x20yet\x20cached\x20token\x20using\x20the\x20nbf\x20claim\x20at\x20exact\x20notBefore\x20time','iPMrN','it\x20correctly\x20verifies\x20a\x20token\x20-\x20async\x20-\x20key\x20as\x20promise','ISS','rosZa','TGZoO','DVmmg','timers','Dlvrg','KRxkP','YGBft','The\x20token\x20has\x20expired\x20at\x201970-01-01T00:09:20.000Z.','ZvGYK','tick','oKkAU','eyJhbGciOiJIUzI1NiIsInR5cCI6ImFwcGxpY2F0aW9uL2p3dCJ9.eyJhIjoxfQ.1ptuaNj5R0owE-5663LpMknK3eRgZVDHkMkOKkxlteM','token\x20type\x20validation','bffiw','OicNd','otAWG','Cannot\x20fetch\x20key.','ACDyR','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.aaa','ABX','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpc3MiOiJJU1NfUFJFRklYIn0.yAVrfuzH-1H_dzd8YhDV2ukWAGHB4DY4Wiv1cqz1JaY','HS256','AUD2','The\x20cacheTTL\x20option\x20must\x20be\x20a\x20positive\x20number.','priBl','../benchmarks/keys/es-512-private.key','eSwgC','ARHtl','smLQR','eMNYE','AUD','SUhha','update','RNCsp','it\x20validates\x20the\x20nonce\x20claim\x20only\x20if\x20explicitily\x20enabled','options\x20validation\x20-\x20clockTimestamp','NoAft','rBODG','HmlQL','QCunY','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJqdGkiOjEsImF1ZCI6MiwiaXNzIjozLCJzdWIiOjQsIm5vbmNlIjo1fQ.J-oaiNMlIJfH1jlNZcRjcEXdG5La4lKGjYtoLMs8vKM','IxjrA','aeYZM','caching\x20-\x20sync\x20-\x20custom\x20cacheKeyBuilder','jSwRh','ubjhE','EFdsc','default\x20errorCacheTTL\x20should\x20not\x20cache\x20errors','utf-8','lwBUv','IZZRk','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxLCJpYXQiOjEwMH0.5V5yFNSqmn0w6yDR1vUbykF36WwdQmADMTLJwiJtx8w','fZEyh','it\x20gets\x20the\x20correct\x20decoded\x20jwt\x20token\x20as\x20argument\x20on\x20the\x20key\x20callback','clear','eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.daq6gJpUPB2daOBWB3SdhMZsXiFfeCflJ36uztKVAzQu0apv-RRewfCFL2-M8iAu1ndAc-a57pG4TkRZjYw4UXD28hFZYjc4fBteoXyFWySkuqlFVCOph8gKkiFszLutE5sAJEoiGD_wnPw38pYj3d0sqsnDUezzNvEDK5Oa2_PYTnsQJi0JGupy2oE1RX7CuVVLBRnI8HOruMagn25FLShjjiiGw90yKq5AYk_Jlv8XFt4rypZj_O1JaGHVp3MTzrJ-Ku95BPDuhH4awBy8MSpPBtCoRPAUuP6jTetpCsRhmWlqf0OrmEMF81ZXlmS4LcbborwSTZ8cZvgc4OwIVU2I19fYLwDRqgL3GQy5GS8WGPTNbvwouvyTFr-omZtSeHUbguLTib5WYZlI1Sq9IPIG5dUDAlfWflPgOInZaE2n4kgGj2iKmUKWiGfuABSdsPgw2a1vTwQ5HZsljV0gHaz7WeCGJ8MZOMa7nvb3pDWfPjTBdcTZWvpzQWagRqVxCMK0gvSOaFLuvk89NFS-jr3eFkLVSAu07YWpPc80_QDcCMCqWU9JcW-FSUV3XHB5U6Yl8zDO6QKT4V-nWxLt8q1He3xHf27-7UoczzDC0-H-uIRjx-dPV_1B-b5axibEcQeNTEjOQv6KTrUOXVwyimLGUkoNUl9bKWyCfZ0QF8Q','eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhIjoxfQ.','NFhNJ','KXowO','get','The\x20token\x20will\x20be\x20active\x20at\x201970-01-01T00:05:00.000Z.','../benchmarks/keys/rs-512-private.key','SUB','XSnrZ','512','lumJf','GzmSk','EVTub','YriPJ','prpBb','it\x20validates\x20if\x20the\x20token\x20has\x20not\x20expired\x20(via\x20exp)\x20unless\x20explicitily\x20disabled','GkAxq','Invalid\x20public\x20key\x20provided\x20for\x20algorithms\x20ES256.','options\x20validation\x20-\x20clockTolerance','sub','hGJDh','DUA2'];_0x178f=function(){return _0x39796c;};return _0x178f();}