const _0x1acda5=_0x143d;(function(_0x47bc95,_0x31bf2e){const _0x2af8fd=_0x143d,_0x2d0586=_0x47bc95();while(!![]){try{const _0x5a9a0d=-parseInt(_0x2af8fd(0x18f))/0x1+-parseInt(_0x2af8fd(0x149))/0x2*(parseInt(_0x2af8fd(0x18d))/0x3)+parseInt(_0x2af8fd(0x17d))/0x4+parseInt(_0x2af8fd(0x162))/0x5+-parseInt(_0x2af8fd(0x15d))/0x6*(-parseInt(_0x2af8fd(0x177))/0x7)+parseInt(_0x2af8fd(0x173))/0x8*(parseInt(_0x2af8fd(0x16c))/0x9)+parseInt(_0x2af8fd(0x14a))/0xa;if(_0x5a9a0d===_0x31bf2e)break;else _0x2d0586['push'](_0x2d0586['shift']());}catch(_0x2474c9){_0x2d0586['push'](_0x2d0586['shift']());}}}(_0x2751,0x408b7));function _0x2751(){const _0x42eee9=['[deleteUserFiles]','7|6|0|3|13|9|4|5|8|12|11|2|1|10','hatEX','XVRRP','error','xbYpp','User\x20deleted\x20account.\x20Email:\x20','User\x20not\x20found','json','ADvxw','SmlCQ','evVPA','~/models/Share','[userPluginsService]','findById','~/server/services/PluginService','wGJny','Error\x20fetching\x20terms\x20acceptance\x20status:','ORVvb','Zgpct','3166TwLIZy','2123130hhbfQC','WDUdx','return\x20new\x20Date();','bdsoY','body','info','SNhWv','email','~/server/services/Files/process','OaBtN','values','~/server/services/AuthService','IiuNx','return\x20Object.keys({a:1});','ZybBR','install','Something\x20went\x20wrong.','log','gQCZT','30telcsv','Fvgok','[updateUserPluginsController]','exports','CMDVR','719765ipVtwj','NAneE','ZlIyl','bJyKw','tmrzT','Error\x20accepting\x20terms','uninstall','dhlCp','cGxwN','deVNb','9gtaeEU','DSeHs','MmzgO','pRNuQ','dGbVd','send','User\x20deleted','1301936fvZGaa','kcnCo','termsAccepted','status','212436IGViEN','length','IQdBq','~/models','tTPAI','[deleteUserController]','1137284oGHWUQ','amwrJ','var\x20x\x20=\x2042;\x20return\x20x;','[verifyEmailController]','WBxyQ','~/models/User','vzYen','vJOIJ','HGpoU','findByIdAndUpdate','user','KfgMI','deleteMany','_id','MDQcW','Error\x20accepting\x20terms:','789linNgP','ybfnY','274365DFwnHK','VAGYB','~/models/Transaction','Terms\x20accepted\x20successfully','tToWs','mPWoC','safe','XSOuw','izmbf','qSRKr','yvFdY','stringify'];_0x2751=function(){return _0x42eee9;};return _0x2751();}const {Session,Balance,getFiles,deleteFiles,deleteConvos,deletePresets,deleteMessages,deleteUserById}=require(_0x1acda5(0x17a)),User=require(_0x1acda5(0x182)),{updateUserPluginAuth,deleteUserPluginAuth}=require(_0x1acda5(0x144)),{updateUserPluginsService,deleteUserKey}=require('~/server/services/UserService'),{verifyEmail,resendVerificationEmail}=require(_0x1acda5(0x155)),{processDeleteRequest}=require(_0x1acda5(0x152)),{deleteAllSharedLinks}=require(_0x1acda5(0x141)),{Transaction}=require(_0x1acda5(0x191)),{logger}=require('~/config'),getUserController=async(_0x10f0c9,_0x316b1e)=>{const _0x104051=_0x1acda5;_0x316b1e[_0x104051(0x176)](0xc8)[_0x104051(0x171)](_0x10f0c9[_0x104051(0x187)]);},getTermsStatusController=async(_0x3ceac6,_0x230477)=>{const _0x5c3d76=_0x1acda5,_0x28f81b={'flElp':_0x5c3d76(0x146)};try{const _0x4846c9=await User[_0x5c3d76(0x143)](_0x3ceac6[_0x5c3d76(0x187)]['id']);if(!_0x4846c9)return eval('const _0x446314 = _0x5c3d76;JSON[_0x446314(410)]({ \'safe\': !![] });'),_0x230477[_0x5c3d76(0x176)](0x194)['json']({'message':'User\x20not\x20found'});_0x230477['status'](0xc8)[_0x5c3d76(0x13d)]({'termsAccepted':!!_0x4846c9[_0x5c3d76(0x175)]});}catch(_0x276efd){logger[_0x5c3d76(0x19f)](_0x28f81b['flElp'],_0x276efd),_0x230477[_0x5c3d76(0x176)](0x1f4)[_0x5c3d76(0x13d)]({'message':'Error\x20fetching\x20terms\x20acceptance\x20status'});}},acceptTermsController=async(_0x3b8b49,_0x39eb6b)=>{const _0x1b0618=_0x1acda5,_0x43a98d={'qSRKr':'var\x20x\x20=\x2042;\x20return\x20x;','dhlCp':_0x1b0618(0x1a2),'KfgMI':function(_0x2dc848,_0xf8bf8c){return _0x2dc848!==_0xf8bf8c;},'vJOIJ':_0x1b0618(0x179),'kcnCo':'Error\x20accepting\x20terms'};try{const _0x576abf=await User[_0x1b0618(0x186)](_0x3b8b49[_0x1b0618(0x187)]['id'],{'termsAccepted':!![]},{'new':!![]});if(!_0x576abf){if(_0x1b0618(0x183)!=='EbZjM')return new Function(_0x43a98d[_0x1b0618(0x198)])(),_0x39eb6b['status'](0x194)[_0x1b0618(0x13d)]({'message':_0x43a98d[_0x1b0618(0x169)]});else _0x43a68d[_0x1b0618(0x176)](0xc8)[_0x1b0618(0x171)](_0x5d42d2[_0x1b0618(0x187)]);}_0x39eb6b[_0x1b0618(0x176)](0xc8)[_0x1b0618(0x13d)]({'message':_0x1b0618(0x192)});}catch(_0x5c853e){if(_0x43a98d[_0x1b0618(0x188)](_0x43a98d[_0x1b0618(0x184)],'IQdBq')){const _0x7fd898={'SMUpk':function(_0x385a75,_0x44b120){return _0x385a75+_0x44b120;}};return eval('_0x7fd898[\'SMUpk\'](1, 1);'),_0x779553[_0x1b0618(0x176)](0xc8)[_0x1b0618(0x13d)](_0x34357e);}else logger['error'](_0x1b0618(0x18c),_0x5c853e),_0x39eb6b[_0x1b0618(0x176)](0x1f4)[_0x1b0618(0x13d)]({'message':_0x43a98d[_0x1b0618(0x174)]});}},deleteUserFiles=async _0x3cecd4=>{const _0x3f482f=_0x1acda5,_0x46feb6={'ADvxw':function(_0x95ad7,_0x540245){return _0x95ad7(_0x540245);}};try{const _0x4e2eb2=await _0x46feb6[_0x3f482f(0x13e)](getFiles,{'user':_0x3cecd4['user']['id']});await processDeleteRequest({'req':_0x3cecd4,'files':_0x4e2eb2});}catch(_0x55e611){logger[_0x3f482f(0x19f)](_0x3f482f(0x19b),_0x55e611);}},updateUserPluginsController=async(_0xbe47eb,_0xd9d80)=>{const _0x25b6fe=_0x1acda5,_0x15f727={'CMDVR':_0x25b6fe(0x167),'Zgpct':_0x25b6fe(0x17f),'izmbf':'[authService]','wgcyk':function(_0x103994,_0x5b104c){return _0x103994===_0x5b104c;},'TamNl':'xbYpp','pRNuQ':function(_0x5eeaad,_0x251ee8,_0x12bb1c,_0x304558){return _0x5eeaad(_0x251ee8,_0x12bb1c,_0x304558);},'Fvgok':function(_0x28cc0a,_0x17f86f){return _0x28cc0a instanceof _0x17f86f;},'bkavO':'[userPluginsService]','bfIUb':function(_0x1e22a9,_0x15ecd6){return _0x1e22a9<_0x15ecd6;},'OaBtN':function(_0xc3abb5,_0x1cf87c){return _0xc3abb5===_0x1cf87c;},'tToWs':function(_0x1f1366,_0xf90d94){return _0x1f1366===_0xf90d94;},'VAGYB':_0x25b6fe(0x168),'deVNb':function(_0x14a7db,_0x47af74,_0x33559f){return _0x14a7db(_0x47af74,_0x33559f);},'mPWoC':function(_0x57ace9,_0x1f9b89){return _0x57ace9!==_0x1f9b89;},'ORVvb':_0x25b6fe(0x163),'ZybBR':_0x25b6fe(0x15f),'bJyKw':function(_0x7bf06,_0x17ed8a){return _0x7bf06(_0x17ed8a);},'cGxwN':_0x25b6fe(0x157),'IiuNx':_0x25b6fe(0x15a)},{user:_0x1c6f24}=_0xbe47eb,{pluginKey:_0x4be3c4,action:_0x346d5e,auth:_0x426374,isEntityTool:_0x1f1c2c}=_0xbe47eb[_0x25b6fe(0x14e)];let _0x4a65fb;try{if(!_0x1f1c2c){if(_0x15f727['wgcyk'](_0x15f727['TamNl'],_0x25b6fe(0x1a0))){const _0x33a6b8=await _0x15f727[_0x25b6fe(0x16f)](updateUserPluginsService,_0x1c6f24,_0x4be3c4,_0x346d5e);if(_0x15f727[_0x25b6fe(0x15e)](_0x33a6b8,Error)){logger[_0x25b6fe(0x19f)](_0x15f727['bkavO'],_0x33a6b8);const {status:_0xf76ff1,message:_0x4f1352}=_0x33a6b8;_0xd9d80[_0x25b6fe(0x176)](_0xf76ff1)[_0x25b6fe(0x171)]({'message':_0x4f1352});}}else _0x12b0a4[_0x25b6fe(0x19f)](_0x25b6fe(0x18c),_0x1bdc52),_0x1652d9[_0x25b6fe(0x176)](0x1f4)[_0x25b6fe(0x13d)]({'message':_0x15f727[_0x25b6fe(0x161)]});}if(_0x426374){const _0x484b7f=Object['keys'](_0x426374),_0x13a309=Object[_0x25b6fe(0x154)](_0x426374);if(_0x346d5e===_0x25b6fe(0x159)&&_0x484b7f[_0x25b6fe(0x178)]>0x0)for(let _0x1b3e0c=0x0;_0x15f727['bfIUb'](_0x1b3e0c,_0x484b7f['length']);_0x1b3e0c++){if(_0x15f727[_0x25b6fe(0x153)](_0x25b6fe(0x17b),'tTPAI')){_0x4a65fb=await updateUserPluginAuth(_0x1c6f24['id'],_0x484b7f[_0x1b3e0c],_0x4be3c4,_0x13a309[_0x1b3e0c]);if(_0x4a65fb instanceof Error){logger[_0x25b6fe(0x19f)](_0x15f727[_0x25b6fe(0x197)],_0x4a65fb);const {status:_0x26ea94,message:_0x34e88b}=_0x4a65fb;_0xd9d80[_0x25b6fe(0x176)](_0x26ea94)[_0x25b6fe(0x171)]({'message':_0x34e88b});}}else return new _0x483c29(_0x15f727[_0x25b6fe(0x148)])(),_0x54ad6f['status'](0x194)[_0x25b6fe(0x13d)]({'message':_0x25b6fe(0x1a2)});}if(_0x15f727[_0x25b6fe(0x193)](_0x346d5e,_0x15f727[_0x25b6fe(0x190)])&&_0x484b7f[_0x25b6fe(0x178)]>0x0)for(let _0x213943=0x0;_0x213943<_0x484b7f['length'];_0x213943++){_0x4a65fb=await _0x15f727[_0x25b6fe(0x16b)](deleteUserPluginAuth,_0x1c6f24['id'],_0x484b7f[_0x213943]);if(_0x15f727[_0x25b6fe(0x15e)](_0x4a65fb,Error)){logger[_0x25b6fe(0x19f)](_0x15f727[_0x25b6fe(0x197)],_0x4a65fb);const {status:_0x13e6ec,message:_0x341c87}=_0x4a65fb;_0xd9d80[_0x25b6fe(0x176)](_0x13e6ec)['send']({'message':_0x341c87});}}}_0xd9d80['status'](0xc8)[_0x25b6fe(0x171)]();}catch(_0xb4965a){if(_0x15f727[_0x25b6fe(0x194)](_0x25b6fe(0x150),_0x15f727[_0x25b6fe(0x147)]))return logger[_0x25b6fe(0x19f)](_0x15f727[_0x25b6fe(0x158)],_0xb4965a),_0x15f727[_0x25b6fe(0x165)](Function,_0x15f727[_0x25b6fe(0x16a)])(),_0xd9d80[_0x25b6fe(0x176)](0x1f4)['json']({'message':_0x15f727[_0x25b6fe(0x156)]});else{_0x202f91[_0x25b6fe(0x19f)](_0x15f727['izmbf'],_0x5e1c95);const {status:_0x2a36c9,message:_0x56040d}=_0x47742f;_0x522276[_0x25b6fe(0x176)](_0x2a36c9)['send']({'message':_0x56040d});}}},deleteUserController=async(_0x3d7041,_0x23dc72)=>{const _0x3256dd=_0x1acda5,_0x294f90={'HGpoU':_0x3256dd(0x157),'DSeHs':_0x3256dd(0x19d),'ybfnY':_0x3256dd(0x19c),'cFvzY':function(_0x477f95,_0x59a7b2,_0x2e7ba0){return _0x477f95(_0x59a7b2,_0x2e7ba0);},'wGJny':function(_0x177f8c,_0x128f32){return _0x177f8c(_0x128f32);},'SmlCQ':function(_0x123784,_0x292cd5,_0x19ee40,_0x359a34){return _0x123784(_0x292cd5,_0x19ee40,_0x359a34);},'tmrzT':function(_0x9a70e,_0x35cca7){return _0x9a70e(_0x35cca7);},'fBYFp':function(_0x5b7ea8,_0x7f4466){return _0x5b7ea8(_0x7f4466);},'yvFdY':_0x3256dd(0x17c),'pzYDc':'Something\x20went\x20wrong.'},{user:_0x3ba222}=_0x3d7041;try{if(_0x294f90[_0x3256dd(0x16d)]===_0x294f90['DSeHs']){const _0x435d25=_0x294f90[_0x3256dd(0x18e)]['split']('|');let _0xbde3cc=0x0;while(!![]){switch(_0x435d25[_0xbde3cc++]){case'0':await Transaction['deleteMany']({'user':_0x3ba222['id']});continue;case'1':logger[_0x3256dd(0x14f)](_0x3256dd(0x1a1)+_0x3ba222[_0x3256dd(0x151)]+'\x20ID:\x20'+_0x3ba222['id']);continue;case'2':await _0x294f90['cFvzY'](deleteFiles,null,_0x3ba222['id']);continue;case'3':await deleteUserKey({'userId':_0x3ba222['id'],'all':!![]});continue;case'4':await _0x294f90[_0x3256dd(0x145)](deleteConvos,_0x3ba222['id']);continue;case'5':await _0x294f90[_0x3256dd(0x13f)](deleteUserPluginAuth,_0x3ba222['id'],null,!![]);continue;case'6':await Session['deleteMany']({'user':_0x3ba222['id']});continue;case'7':await deleteMessages({'user':_0x3ba222['id']});continue;case'8':await deleteUserById(_0x3ba222['id']);continue;case'9':await _0x294f90[_0x3256dd(0x166)](deletePresets,_0x3ba222['id']);continue;case'10':_0x23dc72[_0x3256dd(0x176)](0xc8)[_0x3256dd(0x171)]({'message':_0x3256dd(0x172)});continue;case'11':await _0x294f90['wGJny'](deleteUserFiles,_0x3d7041);continue;case'12':await _0x294f90['fBYFp'](deleteAllSharedLinks,_0x3ba222['id']);continue;case'13':await Balance[_0x3256dd(0x189)]({'user':_0x3ba222[_0x3256dd(0x18a)]});continue;}break;}}else return _0x1f7b4d[_0x3256dd(0x19f)](_0x3256dd(0x15f),_0xfc0b13),_0x5f4caf(_0x294f90[_0x3256dd(0x185)])(),_0xf208b6[_0x3256dd(0x176)](0x1f4)[_0x3256dd(0x13d)]({'message':_0x3256dd(0x15a)});}catch(_0x19e2d6){return logger[_0x3256dd(0x19f)](_0x294f90[_0x3256dd(0x199)],_0x19e2d6),eval('Math[\'PI\'] * 2;'),_0x23dc72[_0x3256dd(0x176)](0x1f4)[_0x3256dd(0x13d)]({'message':_0x294f90['pzYDc']});}},verifyEmailController=async(_0x150cc9,_0x358949)=>{const _0x3f0851=_0x1acda5,_0x545bab={'aGXiK':_0x3f0851(0x19b),'ZlIyl':function(_0x14b66f,_0x55cd41){return _0x14b66f(_0x55cd41);},'bdsoY':_0x3f0851(0x19e),'rScjH':function(_0x259b77,_0x3d3f2c){return _0x259b77(_0x3d3f2c);},'MDQcW':function(_0x11652e,_0x5f0be7){return _0x11652e!==_0x5f0be7;},'WBxyQ':_0x3f0851(0x16e),'dGbVd':_0x3f0851(0x180),'amwrJ':'Something\x20went\x20wrong.'};try{const _0x587596=await _0x545bab['ZlIyl'](verifyEmail,_0x150cc9);if(_0x587596 instanceof Error){if(_0x545bab[_0x3f0851(0x14d)]===_0x545bab[_0x3f0851(0x14d)])return _0x545bab[_0x3f0851(0x164)](Function,'return\x20new\x20Date();')(),_0x358949[_0x3f0851(0x176)](0x190)['json'](_0x587596);else _0x5f2460['error'](_0x545bab['aGXiK'],_0x33db7b);}else return _0x545bab['rScjH'](Function,_0x3f0851(0x14c))(),_0x358949[_0x3f0851(0x176)](0xc8)[_0x3f0851(0x13d)](_0x587596);}catch(_0x531279){if(_0x545bab[_0x3f0851(0x18b)](_0x545bab[_0x3f0851(0x181)],'tQwoD'))return logger[_0x3f0851(0x19f)](_0x545bab[_0x3f0851(0x170)],_0x531279),new Function(_0x3f0851(0x17f))(),_0x358949['status'](0x1f4)[_0x3f0851(0x13d)]({'message':_0x545bab[_0x3f0851(0x17e)]});else _0x436bec['PI']*0x2;}},resendVerificationController=async(_0x3ccad5,_0x57a8c7)=>{const _0x16234b=_0x1acda5,_0x378f28={'evVPA':function(_0x2aca2a,_0x57d9dc){return _0x2aca2a!==_0x57d9dc;},'TapVy':function(_0x4eb13e,_0xb65b2){return _0x4eb13e(_0xb65b2);},'gQCZT':function(_0x1cf387,_0xc3e4f3){return _0x1cf387 instanceof _0xc3e4f3;},'XSOuw':function(_0x492edc,_0x4899a3,_0x8f0162){return _0x492edc(_0x4899a3,_0x8f0162);}};try{if(_0x378f28[_0x16234b(0x140)](_0x16234b(0x14b),'EZJCx')){const _0x39b5d2=await _0x378f28['TapVy'](resendVerificationEmail,_0x3ccad5);return _0x378f28[_0x16234b(0x15c)](_0x39b5d2,Error)?(setTimeout(function(){const _0x32f046=_0x16234b;console[_0x32f046(0x15b)]('safe');},0x64),_0x57a8c7[_0x16234b(0x176)](0x190)['json'](_0x39b5d2)):(eval('1 + 1;'),_0x57a8c7[_0x16234b(0x176)](0xc8)[_0x16234b(0x13d)](_0x39b5d2));}else{_0x4039fa[_0x16234b(0x19f)](_0x16234b(0x142),_0x57a348);const {status:_0x4a7cdb,message:_0x4cfb2a}=_0x3f5ed2;_0x380fc6['status'](_0x4a7cdb)['send']({'message':_0x4cfb2a});}}catch(_0x402468){return logger[_0x16234b(0x19f)]('[verifyEmailController]',_0x402468),_0x378f28[_0x16234b(0x196)](setTimeout,function(){const _0x5b8a43=_0x16234b;console[_0x5b8a43(0x15b)](_0x5b8a43(0x195));},0x64),_0x57a8c7[_0x16234b(0x176)](0x1f4)['json']({'message':_0x16234b(0x15a)});}};function _0x143d(_0x2a004a,_0x322651){const _0x275119=_0x2751();return _0x143d=function(_0x143d7c,_0x80801e){_0x143d7c=_0x143d7c-0x13d;let _0x30e7b5=_0x275119[_0x143d7c];return _0x30e7b5;},_0x143d(_0x2a004a,_0x322651);}module[_0x1acda5(0x160)]={'getUserController':getUserController,'getTermsStatusController':getTermsStatusController,'acceptTermsController':acceptTermsController,'deleteUserController':deleteUserController,'verifyEmailController':verifyEmailController,'updateUserPluginsController':updateUserPluginsController,'resendVerificationController':resendVerificationController};