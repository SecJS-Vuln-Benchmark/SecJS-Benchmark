'use strict';const _0x5b62c6=_0x4f0f;(function(_0x5f1be0,_0x21a551){const _0x178bd4=_0x4f0f,_0x3420c9=_0x5f1be0();while(!![]){try{const _0x48f87c=parseInt(_0x178bd4(0x134))/0x1+-parseInt(_0x178bd4(0x12b))/0x2*(parseInt(_0x178bd4(0x100))/0x3)+-parseInt(_0x178bd4(0x16e))/0x4+-parseInt(_0x178bd4(0x126))/0x5+parseInt(_0x178bd4(0x135))/0x6+parseInt(_0x178bd4(0x172))/0x7*(parseInt(_0x178bd4(0x16a))/0x8)+-parseInt(_0x178bd4(0x107))/0x9*(-parseInt(_0x178bd4(0x131))/0xa);if(_0x48f87c===_0x21a551)break;else _0x3420c9['push'](_0x3420c9['shift']());}catch(_0x22f371){_0x3420c9['push'](_0x3420c9['shift']());}}}(_0x2a92,0x91609));const async=require('async'),passport=require(_0x5b62c6(0x128)),passportLocal=require(_0x5b62c6(0x139))['Strategy'],BearerStrategy=require(_0x5b62c6(0x162))[_0x5b62c6(0x15c)],winston=require(_0x5b62c6(0x15f)),meta=require(_0x5b62c6(0x106)),controllers=require(_0x5b62c6(0x147)),helpers=require(_0x5b62c6(0x10b)),plugins=require(_0x5b62c6(0x117));function _0x4f0f(_0x54c73a,_0x1b3682){const _0x2a9274=_0x2a92();return _0x4f0f=function(_0x4f0f73,_0x320eb0){_0x4f0f73=_0x4f0f73-0x100;let _0x41e31b=_0x2a9274[_0x4f0f73];return _0x41e31b;},_0x4f0f(_0x54c73a,_0x1b3682);}let loginStrategies=[];const Auth=module[_0x5b62c6(0x14c)];Auth[_0x5b62c6(0x130)]=function(_0x3576ee,_0x1db44e){const _0x4af7a9=_0x5b62c6,_0x211179={'cyJre':_0x4af7a9(0x12f),'vzACA':_0x4af7a9(0x13f),'VuWzs':function(_0x15c81b,_0xd6eccf,_0x2ae3e6,_0x5201f9){return _0x15c81b(_0xd6eccf,_0x2ae3e6,_0x5201f9);},'KhRET':function(_0x4ad278){return _0x4ad278();}},_0x49e745=passport[_0x4af7a9(0x130)]();_0x3576ee[_0x4af7a9(0x16c)]((_0x32738e,_0xbc31fd,_0x52b242)=>{_0x49e745(_0x32738e,_0xbc31fd,_0x52b242);});const _0x3581e1=passport[_0x4af7a9(0x102)]();_0x3576ee[_0x4af7a9(0x16c)]((_0x23f80f,_0x28a876,_0x55c845)=>{const _0x14b437=_0x4af7a9,_0xbe3d42={'DibUw':function(_0x1e7d78){return _0x1e7d78();}};_0x211179[_0x14b437(0x154)]===_0x211179[_0x14b437(0x164)]?(_0x2536de[_0x14b437(0x153)](_0x5c9601,_0x1e9db5),_0xbe3d42[_0x14b437(0x140)](_0x347dda)):_0x211179[_0x14b437(0x16d)](_0x3581e1,_0x23f80f,_0x28a876,_0x55c845);}),_0x3576ee[_0x4af7a9(0x16c)]((_0x5e7911,_0x51dd8d,_0x32f865)=>{const _0x5ac560=_0x4af7a9;Auth[_0x5ac560(0x153)](_0x5e7911,_0x51dd8d),_0x211179[_0x5ac560(0x160)](_0x32f865);}),Auth[_0x4af7a9(0x155)]=_0x3576ee,Auth[_0x4af7a9(0x13d)]=_0x1db44e;},Auth[_0x5b62c6(0x153)]=function setAuthVars(_0x380952){const _0x1f9e6e=_0x5b62c6,_0x7d0635=_0x380952[_0x1f9e6e(0x119)]();_0x380952[_0x1f9e6e(0x105)]=!_0x7d0635&&!!_0x380952[_0x1f9e6e(0x14a)];if(_0x380952[_0x1f9e6e(0x14a)])_0x380952[_0x1f9e6e(0x123)]=parseInt(_0x380952[_0x1f9e6e(0x14a)][_0x1f9e6e(0x123)],0xa);else _0x7d0635?'ymrda'===_0x1f9e6e(0x14f)?(_0x1eb193[_0x1f9e6e(0x102)]['ssoState']=_0x1547f3[_0x1f9e6e(0x15a)]&&_0x5aebc4[_0x1f9e6e(0x15a)](),_0x3e0183[_0x1f9e6e(0x103)]=_0x1df0ef[_0x1f9e6e(0x102)][_0x1f9e6e(0x167)]):_0x380952['uid']=-0x1:_0x380952[_0x1f9e6e(0x123)]=0x0;},Auth[_0x5b62c6(0x110)]=function(){return loginStrategies;},Auth[_0x5b62c6(0x148)]=async function(_0x5cc8c4,_0x1b7deb){const _0x3847d7=_0x5b62c6,_0x4eea2a={'kkjWu':function(_0x461a25,_0x3fc370){return _0x461a25>_0x3fc370;},'WCxwK':function(_0x58e186,_0x1707bb,_0x348772){return _0x58e186(_0x1707bb,_0x348772);},'Wapjh':function(_0x4711d2,_0x1e4594,_0x401352){return _0x4711d2(_0x1e4594,_0x401352);},'knVnz':function(_0x393253,_0x4cead7){return _0x393253===_0x4cead7;},'ioFbM':_0x3847d7(0x11b),'QcAQJ':_0x3847d7(0x15e),'jFuxo':function(_0x9e1945,_0x22e907){return _0x9e1945(_0x22e907);}};let {tokens:tokens=[]}=await meta['settings']['get']('core.api');tokens=tokens[_0x3847d7(0x122)]((_0xd0485a,_0xc21d78)=>{const _0x16905b=_0x3847d7;return _0xd0485a[_0xc21d78[_0x16905b(0x113)]]=_0xc21d78[_0x16905b(0x123)],_0xd0485a;},{});const _0x1dc130=tokens[_0x5cc8c4];_0x1dc130!==undefined?parseInt(_0x1dc130,0xa)>0x0?_0x4eea2a[_0x3847d7(0x138)](_0x4eea2a[_0x3847d7(0x141)],_0x4eea2a['QcAQJ'])?_0x4eea2a[_0x3847d7(0x12d)](_0x4eea2a[_0x3847d7(0x121)](_0x5d28e7,_0x32ca8e,0xa),0x0)?_0x4eea2a['Wapjh'](_0x38ec35,null,{'uid':_0x737780}):_0x25d885(null,{'master':!![]}):_0x1b7deb(null,{'uid':_0x1dc130}):_0x1b7deb(null,{'master':!![]}):_0x4eea2a['jFuxo'](_0x1b7deb,![]);},Auth[_0x5b62c6(0x13b)]=async function(_0x7410f){const _0x4157ec=_0x5b62c6,_0x5d7e50={'wgBRl':function(_0x29f2b3,_0x327c0e){return _0x29f2b3!==_0x327c0e;},'KjIEY':_0x4157ec(0x144),'kiMCy':_0x4157ec(0x11d),'kesPi':function(_0x370e2f,_0x181d3d){return _0x370e2f!==_0x181d3d;},'akjLc':_0x4157ec(0x175),'fqDMo':_0x4157ec(0x16b),'EZFfD':_0x4157ec(0x13e)};loginStrategies['length']=0x0;const {router:_0x282389}=_0x7410f;plugins[_0x4157ec(0x143)]['hasListeners'](_0x5d7e50['KjIEY'])?(winston['warn'](_0x4157ec(0x169)),plugins[_0x4157ec(0x143)][_0x4157ec(0x170)](_0x5d7e50['KjIEY'])):passport[_0x4157ec(0x16c)](new passportLocal({'passReqToCallback':!![]},controllers[_0x4157ec(0x163)][_0x4157ec(0x124)]));passport[_0x4157ec(0x16c)](_0x4157ec(0x120),new BearerStrategy({},Auth['verifyToken']));try{loginStrategies=await plugins[_0x4157ec(0x143)][_0x4157ec(0x170)](_0x4157ec(0x129),loginStrategies);}catch(_0x3f9f3c){winston[_0x4157ec(0x150)]('[authentication]\x20'+_0x3f9f3c['stack']);}loginStrategies=loginStrategies||[],loginStrategies[_0x4157ec(0x11e)](_0x51ae4f=>{const _0x3bcb07=_0x4157ec,_0x2ecb81={'lNhyG':_0x5d7e50['KjIEY'],'SYbwK':_0x3bcb07(0x159),'nhYMk':_0x5d7e50['kiMCy'],'aguwb':_0x3bcb07(0x10e),'gaSfd':function(_0x3297df,_0x4f6b8d){return _0x3297df(_0x4f6b8d);},'eQTzt':function(_0x44d985,_0x216a5f){const _0x435170=_0x3bcb07;return _0x5d7e50[_0x435170(0x13c)](_0x44d985,_0x216a5f);}};_0x51ae4f[_0x3bcb07(0x132)]&&_0x282389[_0x51ae4f[_0x3bcb07(0x101)]||_0x5d7e50[_0x3bcb07(0x115)]](_0x51ae4f[_0x3bcb07(0x132)],Auth['middleware'][_0x3bcb07(0x16f)],async(_0x16ae01,_0x148f59,_0x3d1095)=>{const _0x268921=_0x3bcb07;let _0x1c3a3b={'scope':_0x51ae4f[_0x268921(0x14d)],'prompt':_0x51ae4f[_0x268921(0x10c)]||undefined};_0x51ae4f[_0x268921(0x10a)]&&(_0x16ae01[_0x268921(0x102)][_0x268921(0x167)]=_0x16ae01[_0x268921(0x15a)]&&_0x16ae01[_0x268921(0x15a)](),_0x1c3a3b[_0x268921(0x103)]=_0x16ae01[_0x268921(0x102)][_0x268921(0x167)]),{opts:_0x1c3a3b}=await plugins['hooks'][_0x268921(0x170)](_0x268921(0x109),{'req':_0x16ae01,'res':_0x148f59,'opts':_0x1c3a3b}),passport[_0x268921(0x142)](_0x51ae4f[_0x268921(0x133)],_0x1c3a3b)(_0x16ae01,_0x148f59,_0x3d1095);}),_0x282389[_0x51ae4f[_0x3bcb07(0x12c)]||_0x3bcb07(0x175)](_0x51ae4f[_0x3bcb07(0x146)],(_0x5b5e41,_0x213d1b,_0x2ceed0)=>{const _0x3e1dfb=_0x3bcb07,_0x34885a={'JwrED':_0x3e1dfb(0x169),'DkZJK':_0x2ecb81[_0x3e1dfb(0x137)]};if(_0x51ae4f[_0x3e1dfb(0x10a)]===![]){if(_0x2ecb81[_0x3e1dfb(0x15b)]!==_0x2ecb81[_0x3e1dfb(0x104)])return _0x2ceed0();else _0x1a0498[_0x3e1dfb(0x168)](_0x34885a[_0x3e1dfb(0x161)]),_0xc030c1[_0x3e1dfb(0x143)][_0x3e1dfb(0x170)](_0x34885a['DkZJK']);}_0x2ceed0(_0x5b5e41[_0x3e1dfb(0x149)]['state']!==_0x5b5e41[_0x3e1dfb(0x102)][_0x3e1dfb(0x167)]?new Error(_0x2ecb81[_0x3e1dfb(0x136)]):null);},(_0x367445,_0x32444d,_0x29d406)=>{const _0x3c8a5e=_0x3bcb07,_0x521cd3={'ljTzc':function(_0x42c364,_0x484acc){const _0x459e0e=_0x4f0f;return _0x2ecb81[_0x459e0e(0x15d)](_0x42c364,_0x484acc);},'BJUxY':function(_0x4caed5,_0x22bf4e){const _0xc4cb2f=_0x4f0f;return _0x2ecb81[_0xc4cb2f(0x125)](_0x4caed5,_0x22bf4e);}};_0x367445['session'][_0x3c8a5e(0x13a)]=_0x367445['session']['registration']||{},_0x367445[_0x3c8a5e(0x102)][_0x3c8a5e(0x13a)][_0x3c8a5e(0x14e)]=_0x367445[_0x3c8a5e(0x102)][_0x3c8a5e(0x14e)],passport[_0x3c8a5e(0x142)](_0x51ae4f[_0x3c8a5e(0x133)],(_0x1c38db,_0x5580e3)=>{const _0x4ff2cb=_0x3c8a5e;if(_0x1c38db)return _0x367445['session']&&_0x367445['session'][_0x4ff2cb(0x13a)]&&delete _0x367445[_0x4ff2cb(0x102)][_0x4ff2cb(0x13a)],_0x521cd3[_0x4ff2cb(0x157)](_0x29d406,_0x1c38db);if(!_0x5580e3)return _0x367445[_0x4ff2cb(0x102)]&&_0x367445['session'][_0x4ff2cb(0x13a)]&&(_0x521cd3[_0x4ff2cb(0x116)](_0x4ff2cb(0x166),_0x4ff2cb(0x166))?_0x3c2cb7[_0x4ff2cb(0x123)]=0x0:delete _0x367445[_0x4ff2cb(0x102)][_0x4ff2cb(0x13a)]),helpers['redirect'](_0x32444d,_0x521cd3[_0x4ff2cb(0x116)](_0x51ae4f[_0x4ff2cb(0x114)],undefined)?_0x51ae4f['failureUrl']:'/login');_0x32444d[_0x4ff2cb(0x173)][_0x4ff2cb(0x14a)]=_0x5580e3,_0x32444d['locals'][_0x4ff2cb(0x145)]=_0x51ae4f,_0x29d406();})(_0x367445,_0x32444d,_0x29d406);},Auth['middleware'][_0x3bcb07(0x108)],(_0x2390bd,_0x32a3d9,_0x7c12e8)=>{const _0x49bfcd=_0x3bcb07,_0x6da1cc={'NCsBD':function(_0x3385a7,_0x34e447){const _0x462b62=_0x4f0f;return _0x5d7e50[_0x462b62(0x12a)](_0x3385a7,_0x34e447);}};async[_0x49bfcd(0x151)]([async[_0x49bfcd(0x127)](_0x2390bd[_0x49bfcd(0x11a)]['bind'](_0x2390bd),_0x32a3d9['locals'][_0x49bfcd(0x14a)]),async[_0x49bfcd(0x127)](controllers[_0x49bfcd(0x163)][_0x49bfcd(0x118)],_0x2390bd,_0x2390bd[_0x49bfcd(0x123)])],_0x46ff32=>{const _0x5d6a56=_0x49bfcd;if(_0x46ff32)return _0x7c12e8(_0x46ff32);helpers['redirect'](_0x32a3d9,_0x6da1cc[_0x5d6a56(0x165)](_0x51ae4f[_0x5d6a56(0x174)],undefined)?_0x51ae4f[_0x5d6a56(0x174)]:'/');});});});const _0x13f861=require(_0x4157ec(0x176)),_0x56f404=_0x13f861(),_0x401c84=[_0x56f404,Auth[_0x4157ec(0x13d)][_0x4157ec(0x16f)],Auth[_0x4157ec(0x13d)][_0x4157ec(0x171)]];_0x282389['post']('/register',_0x401c84,controllers[_0x4157ec(0x163)][_0x4157ec(0x112)]),_0x282389[_0x4157ec(0x158)](_0x4157ec(0x11f),_0x401c84,controllers[_0x4157ec(0x163)][_0x4157ec(0x12e)]),_0x282389[_0x4157ec(0x158)](_0x5d7e50[_0x4157ec(0x111)],controllers['authentication']['registerAbort']),_0x282389['post'](_0x5d7e50[_0x4157ec(0x14b)],Auth[_0x4157ec(0x13d)][_0x4157ec(0x16f)],Auth[_0x4157ec(0x13d)][_0x4157ec(0x171)],controllers[_0x4157ec(0x163)][_0x4157ec(0x11a)]),_0x282389[_0x4157ec(0x158)](_0x4157ec(0x10d),Auth['middleware'][_0x4157ec(0x16f)],controllers[_0x4157ec(0x163)][_0x4157ec(0x11c)]);},passport[_0x5b62c6(0x10f)]((_0x1b20c7,_0x3b9a29)=>{const _0xa96560=_0x5b62c6;_0x3b9a29(null,_0x1b20c7[_0xa96560(0x123)]);}),passport[_0x5b62c6(0x152)]((_0x11edcd,_0xe058fb)=>{const _0x65e5d3=_0x5b62c6,_0x56e8f5={'nJodh':function(_0x3c9072,_0x2e64ef,_0xc89f86){return _0x3c9072(_0x2e64ef,_0xc89f86);}};_0x56e8f5[_0x65e5d3(0x156)](_0xe058fb,null,{'uid':_0x11edcd});});function _0x2a92(){const _0xb28356=['uid','localLogin','eQTzt','3472045ZbZHQu','apply','passport','filter:auth.init','wgBRl','817636cTCUQb','callbackMethod','kkjWu','registerComplete','dCaoM','initialize','100uayKBo','url','name','512646UzZnoK','4248120qYmyxb','aguwb','lNhyG','knVnz','passport-local','registration','reloadRoutes','kesPi','middleware','/login','sMJdn','DibUw','ioFbM','authenticate','hooks','action:auth.overrideLogin','strategy','callbackURL','../controllers','verifyToken','query','user','EZFfD','exports','scope','returnTo','qxBbP','error','waterfall','deserializeUser','setAuthVars','cyJre','app','nJodh','ljTzc','post','iCbXh','csrfToken','SYbwK','Strategy','gaSfd','fCrjm','winston','KhRET','JwrED','passport-http-bearer','authentication','vzACA','NCsBD','jPpYe','ssoState','warn','[authentication]\x20Login\x20override\x20detected,\x20skipping\x20local\x20login\x20strategy.','1250840MtdXMC','/register/abort','use','VuWzs','2653196zllxZy','applyCSRF','fire','applyBlacklist','49TKaXTg','locals','successUrl','get','connect-multiparty','3vAauHy','urlMethod','session','state','nhYMk','loggedIn','../meta','42156TRrzsU','validateAuth','filter:auth.options','checkState','../controllers/helpers','prompt','/logout','[[error:csrf-invalid]]','serializeUser','getLoginStrategies','fqDMo','register','token','failureUrl','akjLc','BJUxY','../plugins','onSuccessfulLogin','isSpider','login','emrqX','logout','SfKLM','forEach','/register/complete','core.api','WCxwK','reduce'];_0x2a92=function(){return _0xb28356;};return _0x2a92();}