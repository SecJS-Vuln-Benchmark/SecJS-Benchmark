const _0x166652=_0x32e1;function _0x1550(){const _0xc4b036=['222690wWGeUO','Random\x20Integer\x20DoS\x20Protection','pbGWr','isInteger','node:crypto','UhRao','KzvRi','RhLZC','env','ATVpi','ZmAno','aiyZH','ZLbIE','WycqA','ZKAtu','HZued','fHLjE','DTXXj','YOwNo','clearAllMocks','DkhsY','should\x20use\x20crypto.randomUUID\x20when\x20available','generateSecureId','WkaaV','jXSge','JWdHp','OwuFY','toMrw','nvOSv','rbjnh','zHjgB','SSyMP','aUkCE','fqOnR','test','Environment-dependent\x20logic','Advanced\x20Security\x20and\x20Resource\x20Testing','should\x20use\x20the\x20mocked\x20crypto\x20API','XZObT','randomUUID','document','eILtF','info','doUnmock','{\x22__proto__\x22:\x20{\x22polluted\x22:\x20true}}','CUjJD','should\x20set\x20RFC\x204122\x20version\x20and\x20variant\x20bits\x20correctly\x20in\x20fallback','rRLqv','rywKF','MAX_SAFE_INTEGER','mockImplementation','WPiQH','each','development','keys','aLdDq','mvEYW','1183bjLnwl','message','OFnWE','getRandomValues','YeQTA','uvhsv','should\x20handle\x20malicious\x20large\x20length\x20values\x20gracefully','ESrJP','CImCQ','isDevelopment','EBAxY','vgzmu','FtQkz','ZqSpp','Crypto\x20API\x20Discovery\x20and\x20Resilience','eMChR','floor','BigUint64Array','vsCdO','fjFxx','should\x20generate\x20an\x20ID\x20of\x20the\x20default\x20length\x20(12)','oQPXa','EMeqI','should\x20not\x20be\x20vulnerable\x20to\x20prototype\x20pollution\x20in\x20dev\x20logs','toBeLessThanOrEqual','MIN_SAFE_INTEGER','iNcBK','now','rnMPK','NYttP','QsuKv','ZQvtx','nqZYW','Lcvci','814uQkXzg','should\x20include\x20circuit\x20breaker\x20protection\x20against\x20infinite\x20loops','yDTiI','XTUAZ','push','144mzSQYa','DjLcc','CbHJA','should\x20handle\x20BigInt\x20arithmetic\x20without\x2032-bit\x20overflow','IFFQd','sddyE','expected_failure','rkHmr','kbyQT','should\x20maintain\x20consistent\x20performance\x20under\x20DoS\x20attack\x20simulation','FSGrm','uCxIl','fWkBo','../src/security-kit.js','xfwKJ','vaPFc','polluted','BigInt\x20Buffer\x20Overflow\x20Protection','Ftzlc','zrrTJ','BGiky','RGTLx','parse','hrJEd','llzXF','568yqJCvo','5azFaIA','bQvND','eskji','toBeDefined','should\x20correctly\x20handle\x20odd\x20lengths\x20by\x20slicing','1469scEVJK','agXMd','mock','nNMAX','toThrow','vAclN','KFVqt','bPmZC','CtFkT','should\x20enforce\x20stricter\x20bounds\x20to\x20prevent\x20DoS\x20attacks','should\x20throw\x20InvalidParameterError\x20for\x20a\x20wide\x20range\x20of\x20invalid\x20types','FPlDI','calls','max','fAUWE','toBeGreaterThanOrEqual','dLZau','QnHPo','Owfju','CryptoUnavailableError','should\x20return\x20an\x20integer\x20within\x20the\x20specified\x20range','gptOc','vIQtf','MSUDo','reject','should\x20prevent\x20excessive\x20memory\x20allocation\x20in\x20generateSecureId','EhTzA','ORaYd','OXwOq','qqsaY','crypto','DzEED','xpufu','should\x20prevent\x20excessive\x20memory\x20allocation\x20in\x20generateSecureIdSync','8551845UtRDli','CryptoUnavailableError\x20has\x20correct\x20name\x20and\x20default/custom\x20messages','efpmy','getMockImplementation','generateSecureUUID','rprUj','WZLiB','pLUna','toBeInstanceOf','UpADZ','YlFTA','AOzeL','mock-uuid-v4-from-crypto-api','GApKa','should\x20produce\x20a\x20uniform\x20distribution\x20(passes\x20Chi-squared\x20test)','ZjZPD','FWpVR','should\x20use\x20optimized\x20hex\x20encoding\x20when\x20Buffer\x20is\x20available','DNfDt','gLrGi','ywPWc','fKGbg','doMock','QKzji','0x7d70a3d70a3d7000','production','XlDkx','JVkxv','mDZHh','mARuK','tdFYQ','QFSsj','vhAwY','rejects','toMatch','shouldExecuteThrottledAsync','should\x20return\x20deterministically\x20based\x20on\x20the\x20underlying\x20random\x20number','rYeQk','getSecureRandomInt','should\x20prevent\x20ranges\x20that\x20would\x20require\x20excessive\x20buffer\x20allocation','toBe','vUwqb','37437xPRpaA','GEUuv','Dcmyf','name','deadbeef12345678','security-kit','KoslZ','should\x20handle\x20large\x20ranges\x20using\x20BigInt\x20arithmetic\x20correctly','mockRestore','mockImplementationOnce','YYWkZ','DdGal','qGZbk','69170MoNBTf','AugNE','7200CiHHNw','RayDj','should\x20handle\x20boundary\x20lengths\x201\x20and\x20256','toHaveBeenCalledTimes','SOVzh','EUaKa','Oiuxl','xmrsb','param','filter','xiCkW','resolve','iHnFz','should\x20propagate\x20underlying\x20errors\x20from\x20a\x20faulty\x20crypto.getRandomValues','alPaE','should\x20have\x20circuit\x20breaker\x20protection\x20against\x20infinite\x20rejection\x20sampling','gXQwE','bglIf','FwVFG','aba','resetModules','wBHWt','ItsYN','ZZJxr','sodYg','importActual','AEhTZ','irwJe','1237062WwDBHK','resolves','defineProperty','aXxcF','length','uDzcg','Buffer','GfGYw','UFpUm','\x20degrees\x20of\x20freedom.','unwBQ','catch','nSzHQ','UkNrG','TxPkn','zlVbI','[secure-helpers]\x20param','should\x20use\x20rejection\x20sampling\x20to\x20prevent\x20modulo\x20bias','fQccd','QqBID','generateSecureIdSync','mocked','TYONh','ihOuN','toBeUndefined','fill','NODE_ENV','toHaveLength','toBeLessThan','UylbV','qROyD','kPIfi','ObrPD','ZaSpc','should\x20handle\x20concurrent\x20access\x20without\x20race\x20conditions','OTYza','TsKky','1NuxpfH','0x828f5c28f5c29000','should\x20correctly\x20identify\x20production\x20via\x20NODE_ENV','from','iVRZZ','Ebkvc','Vamgc','mockReturnValue','mOvRM'];_0x1550=function(){return _0xc4b036;};return _0x1550();}function _0x32e1(_0x21def8,_0x47506f){const _0x155055=_0x1550();return _0x32e1=function(_0x32e129,_0x2e7d09){_0x32e129=_0x32e129-0x1cc;let _0x3e2f42=_0x155055[_0x32e129];return _0x3e2f42;},_0x32e1(_0x21def8,_0x47506f);}(function(_0x3f48c1,_0x7f9627){const _0x57a742=_0x32e1,_0x591b8c=_0x3f48c1();while(!![]){try{const _0x49b977=-parseInt(_0x57a742(0x1fc))/0x1*(parseInt(_0x57a742(0x205))/0x2)+parseInt(_0x57a742(0x2d0))/0x3*(parseInt(_0x57a742(0x265))/0x4)+parseInt(_0x57a742(0x27f))/0x5*(parseInt(_0x57a742(0x1d7))/0x6)+parseInt(_0x57a742(0x23e))/0x7*(parseInt(_0x57a742(0x27e))/0x8)+parseInt(_0x57a742(0x2a6))/0x9+parseInt(_0x57a742(0x2dd))/0xa*(-parseInt(_0x57a742(0x260))/0xb)+parseInt(_0x57a742(0x2df))/0xc*(-parseInt(_0x57a742(0x284))/0xd);if(_0x49b977===_0x7f9627)break;else _0x591b8c['push'](_0x591b8c['shift']());}catch(_0x131657){_0x591b8c['push'](_0x591b8c['shift']());}}}(_0x1550,0xe239e));import{describe,it,expect,beforeEach,afterEach,vi}from'vitest';import{webcrypto}from'node:crypto';const mockCrypto=webcrypto;import*as _0x4286e4 from'../src/security-kit.js';const {CryptoUnavailableError,InvalidParameterError,generateSecureId,generateSecureIdSync,generateSecureUUID,getSecureRandomInt,getSecureRandomAsync,getSecureRandom,shouldExecuteThrottledAsync,shouldExecuteThrottled}=_0x4286e4;function chiSquaredTest(_0x4e1412,_0x4b2d49){const _0x5afc05=_0x32e1,_0x42b03f={'Ebkvc':function(_0x526c9c,_0x223784){return _0x526c9c/_0x223784;},'aUkCE':function(_0x206c1f,_0x4f4520){return _0x206c1f/_0x4f4520;},'cFrrD':function(_0x3f5dcd,_0x40fe0e){return _0x3f5dcd**_0x40fe0e;},'WycqA':function(_0x54cd40,_0x46d59e){return _0x54cd40<_0x46d59e;}},_0x36b605=Object[_0x5afc05(0x23b)](_0x4e1412),_0x3d3a3e=_0x36b605['length'],_0x40ff99=_0x42b03f[_0x5afc05(0x201)](_0x4b2d49,_0x3d3a3e),_0xb7b877=_0x3d3a3e-0x1,_0x3ac1d9={0x1:3.84,0x2:5.99,0x3:7.81,0x4:9.49,0x5:11.07,0x9:16.92,0xf:0x19},_0x3f43ca=_0x3ac1d9[_0xb7b877];if(!_0x3f43ca)throw new Error('No\x20critical\x20value\x20for\x20'+_0xb7b877+_0x5afc05(0x1e0));let _0x1ed7e0=0x0;for(const _0x197909 of _0x36b605){_0x1ed7e0+=_0x42b03f[_0x5afc05(0x225)](_0x42b03f['cFrrD'](_0x4e1412[_0x197909]-_0x40ff99,0x2),_0x40ff99);}return _0x42b03f[_0x5afc05(0x212)](_0x1ed7e0,_0x3f43ca);}function createTestRunner(_0x5c0f4b,_0x4aa1e5){const _0x14d25f={'aJLNp':function(_0x3e206e,_0x5afb02){return _0x3e206e(_0x5afb02);},'qGZbk':function(_0xee91c2,_0x424e42){return _0xee91c2(_0x424e42);}};return _0x1bfa98=>{const _0x389fb7=_0x32e1;if(_0x4aa1e5)return _0x14d25f['aJLNp'](_0x5c0f4b,_0x1bfa98);else try{return Promise[_0x389fb7(0x2ea)](_0x14d25f[_0x389fb7(0x2dc)](_0x5c0f4b,_0x1bfa98));}catch(_0x20a757){return Promise['reject'](_0x20a757);}};}describe(_0x166652(0x2d5),()=>{const _0xda3866=_0x166652,_0x381607={'FSGrm':function(_0x19272e,_0xc4169a){return _0x19272e!==_0xc4169a;},'rBjnS':_0xda3866(0x2a3),'Oiuxl':_0xda3866(0x2e7),'Dcmyf':function(_0x3e3a51,_0x34a306){return _0x3e3a51(_0x34a306);},'AugNE':'InvalidParameterError','DTXXj':_0xda3866(0x1e7),'sWiXI':'[secure-helpers]\x20test','RhLZC':function(_0x46c664,_0x5bc9dd,_0x339ef6){return _0x46c664(_0x5bc9dd,_0x339ef6);},'Lcvci':function(_0x46d56d){return _0x46d56d();},'UhRao':_0xda3866(0x2a2),'vhAwY':_0xda3866(0x209),'rnMPK':function(_0x32d915,_0x2de4e1,_0x58694a){return _0x32d915(_0x2de4e1,_0x58694a);},'YYWkZ':function(_0x532754,_0x373dc8,_0x152e06){return _0x532754(_0x373dc8,_0x152e06);},'rywKF':function(_0x331bc2,_0x9284a9){return _0x331bc2(_0x9284a9);},'gLrGi':function(_0x46d08f,_0x3f2889){return _0x46d08f(_0x3f2889);},'wBHWt':function(_0x12f55e,_0x2e7361){return _0x12f55e(_0x2e7361);},'uCxIl':function(_0x1593fd,_0x50731b){return _0x1593fd(_0x50731b);},'ZLbIE':_0xda3866(0x1ce),'mvEYW':_0xda3866(0x2eb),'EhTzA':function(_0x42c572,_0x2de728,_0x241d64){return _0x42c572(_0x2de728,_0x241d64);},'AEhTZ':function(_0x5e64e1,_0x4be4b0,_0x3e39ed){return _0x5e64e1(_0x4be4b0,_0x3e39ed);},'NcsIz':_0xda3866(0x2e1),'DkhsY':function(_0x3d4836,_0x11873c,_0x3d1e19){return _0x3d4836(_0x11873c,_0x3d1e19);},'YeQTA':function(_0x92f98c,_0x5654d2){return _0x92f98c===_0x5654d2;},'nvOSv':_0xda3866(0x2bb),'GfGYw':function(_0x137dd2,_0x12dbe5){return _0x137dd2(_0x12dbe5);},'mOvRM':_0xda3866(0x233),'KFVqt':_0xda3866(0x272),'YOwNo':_0xda3866(0x2b8),'HZued':function(_0x2e065d,_0x37e684){return _0x2e065d**_0x37e684;},'gptOc':function(_0x3ed467,_0xce7120){return _0x3ed467+_0xce7120;},'kbyQT':function(_0x5ead36,_0xfed270,_0x3332fa){return _0x5ead36(_0xfed270,_0x3332fa);},'DdGal':function(_0x50f724,_0x218054){return _0x50f724+_0x218054;},'rYeQk':_0xda3866(0x28b),'mPifO':_0xda3866(0x1f6),'miGEU':_0xda3866(0x298),'qjWWB':_0xda3866(0x1e8),'ItsYN':_0xda3866(0x2d7),'aLdDq':_0xda3866(0x2b4),'gYvNU':'should\x20use\x20high\x20precision\x20(64-bit)\x20path\x20when\x20available','xfwKJ':function(_0x5bf045,_0x503fa1,_0x46c9ac){return _0x5bf045(_0x503fa1,_0x46c9ac);},'mARuK':function(_0x4c0aa9,_0x276de3){return _0x4c0aa9+_0x276de3;},'FwVFG':'NXqCK','FPlDI':function(_0x5ce0c0,_0x4b6b89){return _0x5ce0c0(_0x4b6b89);},'WZLiB':function(_0x1d7a81,_0x14eff6){return _0x1d7a81(_0x14eff6);},'YAnHd':function(_0x43dbc6,_0x54ee46){return _0x43dbc6*_0x54ee46;},'Vamgc':_0xda3866(0x238),'QqBID':function(_0x4280ca,_0x26a194){return _0x4280ca instanceof _0x26a194;},'CImCQ':_0xda3866(0x251),'agXMd':_0xda3866(0x2bf),'JVkxv':_0xda3866(0x23a),'ihOuN':_0xda3866(0x22f),'ZjZPD':_0xda3866(0x227),'QnHPo':function(_0x5dea59,_0x1bdc2b){return _0x5dea59(_0x1bdc2b);},'OTYza':'should\x20correctly\x20identify\x20development\x20via\x20NODE_ENV','vaPFc':_0xda3866(0x1fe),'KoslZ':_0xda3866(0x255),'nqZYW':function(_0xe5bcc5,_0x13829a){return _0xe5bcc5(_0x13829a);},'eMChR':function(_0x6a856d,_0x2b39b5){return _0x6a856d/_0x2b39b5;},'PCixc':function(_0x141e3b,_0x45b4e9){return _0x141e3b-_0x45b4e9;},'eskji':function(_0x2371e6,_0x7ebe92){return _0x2371e6<_0x7ebe92;},'VTkGn':_0xda3866(0x25d),'XTUAZ':function(_0x2c4f63,_0x30f77d){return _0x2c4f63(_0x30f77d);},'ZZJxr':'pItSP','DjLcc':_0xda3866(0x2b7),'Ufccd':function(_0x4fddfb,_0x30892f){return _0x4fddfb(_0x30892f);},'QKzji':_0xda3866(0x29d),'EUaKa':function(_0x23d205,_0x4f8659,_0x42e0a5){return _0x23d205(_0x4f8659,_0x42e0a5);},'qROyD':_0xda3866(0x2a5),'iNcBK':function(_0x4e6fa8,_0x10c828,_0x31becd){return _0x4e6fa8(_0x10c828,_0x31becd);},'TxPkn':_0xda3866(0x2cd),'NYttP':function(_0x13c80e,_0x4f7768){return _0x13c80e(_0x4f7768);},'HiVAf':function(_0x1376ab,_0x35bd2f,_0x2298c5){return _0x1376ab(_0x35bd2f,_0x2298c5);},'tdFYQ':function(_0x4192ab,_0x4a220f){return _0x4192ab(_0x4a220f);},'VNVNW':function(_0x31e23d,_0xf970da,_0x11abfe){return _0x31e23d(_0xf970da,_0x11abfe);},'QsuKv':function(_0x300a01,_0x4e2d4b){return _0x300a01<_0x4e2d4b;},'ZnqHR':function(_0x562abe,_0x1e993b,_0x2be675){return _0x562abe(_0x1e993b,_0x2be675);},'fAUWE':_0xda3866(0x2a8),'PQltr':function(_0x125bf2,_0x42ca46){return _0x125bf2>=_0x42ca46;},'InEou':_0xda3866(0x206),'QFSsj':function(_0x938599,_0x19544f,_0x5e6a55){return _0x938599(_0x19544f,_0x5e6a55);},'zrrTJ':function(_0x526337,_0x405e20,_0x1b48aa){return _0x526337(_0x405e20,_0x1b48aa);},'qJDCf':'Error\x20Classes','CtFkT':_0xda3866(0x24c),'jXSge':_0xda3866(0x21b),'rRLqv':_0xda3866(0x2cc),'ZKAtu':'getSecureRandomAsync','XlDkx':'getSecureRandom','cLCKs':_0xda3866(0x2c9),'AOzeL':'shouldExecuteThrottled','JWdHp':_0xda3866(0x228),'hrJEd':_0xda3866(0x229)};_0x381607['nqZYW'](beforeEach,()=>{const _0x25927f=_0xda3866;if(_0x381607['FSGrm'](_0x381607['rBjnS'],_0x25927f(0x279)))vi[_0x25927f(0x218)]();else return _0x75f458['fill'](0xff),_0xd914f8;}),_0x381607[_0xda3866(0x28f)](afterEach,()=>{vi['mocked'](mockCrypto['getRandomValues'])['mockRestore']();}),_0x381607[_0xda3866(0x278)](describe,_0x381607['qJDCf'],()=>{const _0x1d26ee=_0xda3866,_0x4f2295={'WkaaV':function(_0x182b7d,_0x73483d){return _0x182b7d(_0x73483d);},'ORaYd':_0x381607['sWiXI']};_0x381607['RhLZC'](it,_0x1d26ee(0x2a7),()=>{const _0x2cb2c1=_0x1d26ee,_0x31dced=new CryptoUnavailableError();expect(_0x31dced)[_0x2cb2c1(0x2ae)](Error),expect(_0x31dced[_0x2cb2c1(0x2d3)])[_0x2cb2c1(0x2ce)](_0x2cb2c1(0x297)),expect(_0x31dced['message'])[_0x2cb2c1(0x2c8)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x26c44b=new CryptoUnavailableError('test');_0x4f2295[_0x2cb2c1(0x21c)](expect,_0x26c44b[_0x2cb2c1(0x23f)])[_0x2cb2c1(0x2ce)](_0x4f2295[_0x2cb2c1(0x29f)]);}),it('InvalidParameterError\x20has\x20correct\x20name\x20and\x20message\x20format',()=>{const _0x4bd616=_0x1d26ee,_0x2c1652=new InvalidParameterError(_0x381607[_0x4bd616(0x2e5)]);expect(_0x2c1652)['toBeInstanceOf'](RangeError),_0x381607[_0x4bd616(0x2d2)](expect,_0x2c1652[_0x4bd616(0x2d3)])[_0x4bd616(0x2ce)](_0x381607[_0x4bd616(0x2de)]),expect(_0x2c1652[_0x4bd616(0x23f)])[_0x4bd616(0x2ce)](_0x381607[_0x4bd616(0x216)]);});}),_0x381607[_0xda3866(0x219)](describe,_0x381607[_0xda3866(0x28c)],()=>{const _0x41bbdc=_0xda3866,_0x2c85a1={'GnDGC':function(_0x59f789){const _0x4c31d0=_0x32e1;return _0x381607[_0x4c31d0(0x25f)](_0x59f789);},'TYONh':_0x381607[_0x41bbdc(0x20a)],'iVRZZ':_0x381607[_0x41bbdc(0x2c6)],'irwJe':function(_0x585a60){const _0x27f975=_0x41bbdc;return _0x381607[_0x27f975(0x25f)](_0x585a60);}};_0x381607[_0x41bbdc(0x25a)](it,_0x41bbdc(0x22a),async()=>{const _0x13c1fe=_0x41bbdc;await _0x2c85a1['GnDGC'](generateSecureId),expect(mockCrypto['getRandomValues'])[_0x13c1fe(0x2e2)](0x1);}),it('should\x20throw\x20CryptoUnavailableError\x20when\x20no\x20API\x20is\x20found',async()=>{const _0x5b6b68=_0x41bbdc;vi[_0x5b6b68(0x1cf)](),Object[_0x5b6b68(0x1d9)](globalThis,_0x2c85a1[_0x5b6b68(0x1ed)],{'value':undefined,'configurable':!![]}),vi[_0x5b6b68(0x2bc)](_0x2c85a1['iVRZZ'],()=>({'webcrypto':undefined}));const {generateSecureId:_0x5f2248,CryptoUnavailableError:_0xc81e1c}=await import(_0x5b6b68(0x272));await expect(_0x2c85a1[_0x5b6b68(0x1d6)](_0x5f2248))[_0x5b6b68(0x2c7)][_0x5b6b68(0x288)](_0xc81e1c),vi[_0x5b6b68(0x230)](_0x2c85a1[_0x5b6b68(0x200)]),vi[_0x5b6b68(0x1cf)]();}),_0x381607['YYWkZ'](it,_0x41bbdc(0x2ec),async()=>{const _0x23ebca=_0x41bbdc,_0x1710e4=new Error('Crypto\x20hardware\x20failure');vi['mocked'](mockCrypto[_0x23ebca(0x241)])['mockImplementation'](()=>{throw _0x1710e4;}),await expect(_0x381607[_0x23ebca(0x25f)](generateSecureId))[_0x23ebca(0x2c7)][_0x23ebca(0x288)](_0x1710e4);});}),describe['each']([[_0x381607[_0xda3866(0x21d)],generateSecureId,!![]],[_0xda3866(0x1eb),generateSecureIdSync,![]]])('%s',(_0x1da74b,_0x1d67e0,_0x114e9c)=>{const _0x3da241=_0xda3866,_0xefef7c={'XFSLK':function(_0x5c9af0,_0x2b3595){return _0x5c9af0(_0x2b3595);},'ZmAno':function(_0x42cd4c,_0x15493b){return _0x42cd4c(_0x15493b);},'DzIaM':function(_0x5b6a78,_0x385ed1){const _0x3d722d=_0x32e1;return _0x381607[_0x3d722d(0x235)](_0x5b6a78,_0x385ed1);}};if(_0x381607[_0x3da241(0x23d)]===_0x3da241(0x2a4))return _0x381607[_0x3da241(0x235)](_0x30cafe,_0x475072);else{const _0x3d84dd=_0x381607[_0x3da241(0x29e)](createTestRunner,_0x1d67e0,_0x114e9c);it(_0x3da241(0x252),async()=>{const _0x2839b9=_0x3da241,_0x3a59c5=await _0x3d84dd();_0x381607[_0x2839b9(0x2b9)](expect,_0x3a59c5)[_0x2839b9(0x1f2)](0xc),_0x381607['wBHWt'](expect,_0x3a59c5)[_0x2839b9(0x2c8)](/^[0-9a-f]{12}$/);}),_0x381607[_0x3da241(0x1d5)](it,_0x381607['NcsIz'],async()=>{const _0x1d06e9=_0x3da241;expect(await _0xefef7c['XFSLK'](_0x3d84dd,0x1))[_0x1d06e9(0x1f2)](0x1),expect(await _0xefef7c[_0x1d06e9(0x20f)](_0x3d84dd,0x100))[_0x1d06e9(0x1f2)](0x100);}),it(_0x3da241(0x283),async()=>{const _0x51afb7=_0x3da241;vi[_0x51afb7(0x1ec)](mockCrypto[_0x51afb7(0x241)])[_0x51afb7(0x237)](_0x2c3e14=>_0x2c3e14[_0x51afb7(0x1f0)](0xab)),expect(await _0x381607[_0x51afb7(0x270)](_0x3d84dd,0x3))[_0x51afb7(0x2ce)](_0x381607[_0x51afb7(0x211)]);}),_0x381607[_0x3da241(0x219)](it,_0x3da241(0x28e),async()=>{const _0x55bad0=_0x3da241,_0x3b0227=[0x0,0x101,null,NaN,Infinity,[],{},'string',!![]];for(const _0x2f97d1 of _0x3b0227){await expect(_0xefef7c['DzIaM'](_0x3d84dd,_0x2f97d1))['rejects'][_0x55bad0(0x288)](InvalidParameterError);}});}}),describe(_0xda3866(0x2aa),()=>{const _0x36890b=_0xda3866,_0x42add9={'zHjgB':function(_0x22fdff,_0x349f71){return _0x22fdff(_0x349f71);}},_0x47b8a8=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i;_0x381607[_0x36890b(0x25a)](it,_0x36890b(0x21a),async()=>{const _0x3e3d7d=_0x36890b,_0x43d1f2=await generateSecureUUID();_0x42add9[_0x3e3d7d(0x223)](expect,_0x43d1f2)[_0x3e3d7d(0x2ce)](_0x3e3d7d(0x2b2)),expect(mockCrypto[_0x3e3d7d(0x22c)])[_0x3e3d7d(0x2e2)](0x1);}),it(_0x381607[_0x36890b(0x204)],async()=>{const _0x75c44c=_0x36890b;if(_0x381607[_0x75c44c(0x242)](_0x75c44c(0x2bb),_0x381607[_0x75c44c(0x221)])){vi[_0x75c44c(0x1ec)](mockCrypto)['randomUUID']=undefined,vi[_0x75c44c(0x1ec)](mockCrypto[_0x75c44c(0x241)])[_0x75c44c(0x237)](_0x3e191c=>_0x3e191c[_0x75c44c(0x1f0)](0xff));const _0x5eb3ae=await generateSecureUUID();_0x381607[_0x75c44c(0x1de)](expect,_0x5eb3ae)[_0x75c44c(0x2c8)](_0x47b8a8),expect(_0x5eb3ae[0xe])[_0x75c44c(0x2ce)]('4'),_0x381607[_0x75c44c(0x235)](expect,['8','9','a','b'])['toContain'](_0x5eb3ae[0x13]),vi['mocked'](mockCrypto)[_0x75c44c(0x22c)]=vi['fn'](()=>_0x75c44c(0x2b2));}else _0x10a941['mocked'](_0x4105cc[_0x75c44c(0x241)])[_0x75c44c(0x2d8)]();});}),describe(_0x381607[_0xda3866(0x234)],()=>{const _0x199135=_0xda3866,_0x530402={'Ftzlc':function(_0x4d761b,_0x4e667b){const _0x5fe25b=_0x32e1;return _0x381607[_0x5fe25b(0x235)](_0x4d761b,_0x4e667b);},'XZObT':_0x381607[_0x199135(0x217)],'vkrXB':function(_0x306507,_0x4f4986){const _0x1286db=_0x199135;return _0x381607[_0x1286db(0x214)](_0x306507,_0x4f4986);},'rprUj':function(_0x1b790b,_0x454cfe){const _0xc0bde0=_0x199135;return _0x381607[_0xc0bde0(0x214)](_0x1b790b,_0x454cfe);},'RayDj':function(_0x2b5805,_0x1527d4,_0x21600c){return _0x2b5805(_0x1527d4,_0x21600c);},'OwuFY':function(_0x1854ae,_0x222757){const _0x42a736=_0x199135;return _0x381607[_0x42a736(0x299)](_0x1854ae,_0x222757);},'FWpVR':function(_0x120fa6,_0x4f49c0){return _0x120fa6-_0x4f49c0;},'ZNvjj':function(_0x429d5d,_0x46e64e){return _0x429d5d(_0x46e64e);},'uDzcg':function(_0x2057c8,_0x38c9f8){return _0x2057c8-_0x38c9f8;},'UpADZ':function(_0x2478dd,_0x4a7490){return _0x2478dd(_0x4a7490);},'uvhsv':function(_0x5caf99,_0x4b75f0,_0x264487){const _0x597c9f=_0x199135;return _0x381607[_0x597c9f(0x26d)](_0x5caf99,_0x4b75f0,_0x264487);},'gXQwE':function(_0x310f08,_0x453204){const _0x25c11e=_0x199135;return _0x381607[_0x25c11e(0x2db)](_0x310f08,_0x453204);},'vIQtf':_0x381607[_0x199135(0x2cb)],'OFnWE':function(_0x57840a,_0x13b936){return _0x57840a(_0x13b936);},'aKUrI':_0x381607['mPifO']};it(_0x381607['miGEU'],async()=>{const _0x3413aa=_0x199135,_0x1a0c05=await getSecureRandomInt(0x1,0x64);expect(Number[_0x3413aa(0x208)](_0x1a0c05))[_0x3413aa(0x2ce)](!![]),expect(_0x1a0c05)[_0x3413aa(0x293)](0x1),expect(_0x1a0c05)[_0x3413aa(0x256)](0x64);}),_0x381607[_0x199135(0x2da)](it,_0x199135(0x28d),async()=>{const _0x32b769=_0x199135;if(_0x530402[_0x32b769(0x22b)]!==_0x32b769(0x2b8))_0x440cba[_0x32b769(0x264)](_0x5cfb44(0x100)['catch'](()=>_0x32b769(0x26b)),_0x530402[_0x32b769(0x277)](_0x4bebc1,0x101)[_0x32b769(0x1e2)](()=>_0x32b769(0x26b)));else{const _0x3a0e76=_0x530402['vkrXB'](0x2,0x1f),_0x48afdd=-_0x530402[_0x32b769(0x2ab)](0x2,0x1f);await _0x530402['Ftzlc'](expect,_0x530402[_0x32b769(0x2e0)](getSecureRandomInt,_0x48afdd,_0x530402[_0x32b769(0x21f)](_0x48afdd,0xa)))[_0x32b769(0x1d8)]['toBeDefined'](),await expect(getSecureRandomInt(_0x530402[_0x32b769(0x2b6)](_0x3a0e76,0xa),_0x3a0e76))[_0x32b769(0x1d8)]['toBeDefined'](),await _0x530402['ZNvjj'](expect,getSecureRandomInt(_0x530402[_0x32b769(0x1dc)](_0x48afdd,0x1),0x64))[_0x32b769(0x2c7)][_0x32b769(0x288)](InvalidParameterError),await _0x530402[_0x32b769(0x2af)](expect,_0x530402[_0x32b769(0x243)](getSecureRandomInt,0x64,_0x530402[_0x32b769(0x2ef)](_0x3a0e76,0x1)))[_0x32b769(0x2c7)][_0x32b769(0x288)](InvalidParameterError);}}),_0x381607[_0x199135(0x20c)](it,_0x381607['qjWWB'],async()=>{const _0x1d15d7=_0x199135,_0x2f4440={'CbHJA':_0x530402[_0x1d15d7(0x29a)]},_0x3edaee=0x0,_0x195002=0x14;vi[_0x1d15d7(0x1ec)](mockCrypto[_0x1d15d7(0x241)])['mockImplementationOnce'](_0x51ee1a=>{return _0x51ee1a[0x0]=0x19,_0x51ee1a;})[_0x1d15d7(0x2d9)](_0x2c380b=>{const _0x31d1a3=_0x1d15d7;if(_0x2f4440[_0x31d1a3(0x267)]===_0x2f4440[_0x31d1a3(0x267)])return _0x2c380b[0x0]=0xa,_0x2c380b;else _0x3a2d93[0x0]=_0x27554f(_0x31d1a3(0x1fd));});const _0x443496=await _0x530402[_0x1d15d7(0x2e0)](getSecureRandomInt,_0x3edaee,_0x195002);expect(mockCrypto[_0x1d15d7(0x241)])[_0x1d15d7(0x2e2)](0x2),expect(_0x443496)[_0x1d15d7(0x2ce)](0xa);}),it(_0x381607[_0x199135(0x1d1)],async()=>{const _0x5a0d9d=_0x199135,_0x5894b9=0x3b9aca00,_0x4b0b45=0x77359400,_0x499482=await getSecureRandomInt(_0x5894b9,_0x4b0b45);expect(Number[_0x5a0d9d(0x208)](_0x499482))[_0x5a0d9d(0x2ce)](!![]),_0x530402[_0x5a0d9d(0x240)](expect,_0x499482)[_0x5a0d9d(0x293)](_0x5894b9),expect(_0x499482)[_0x5a0d9d(0x256)](_0x4b0b45);}),_0x381607[_0x199135(0x2da)](it,_0x199135(0x261),async()=>{const _0x1c2081=_0x199135,_0x4192fd={'mDZHh':function(_0x15da8c,_0x20d87e){return _0x15da8c===_0x20d87e;},'SSyMP':_0x530402['aKUrI']};vi['mocked'](mockCrypto[_0x1c2081(0x241)])[_0x1c2081(0x237)](_0xb37f3f=>{const _0x3107ad=_0x1c2081;return _0x4192fd[_0x3107ad(0x2c2)](_0x4192fd[_0x3107ad(0x224)],_0x3107ad(0x1f6))?(_0xb37f3f[_0x3107ad(0x1f0)](0xff),_0xb37f3f):_0x1338f0[_0x3107ad(0x2ea)](_0x8e1b58(_0x5e4da3));}),await expect(getSecureRandomInt(0x0,0x1))[_0x1c2081(0x2c7)]['toThrow'](/Failed to generate random integer within reasonable iterations/);}),it(_0x381607[_0x199135(0x23c)],async()=>{const _0x75496=_0x199135,{webcrypto:_0xc1cd8e}=await vi['importActual'](_0x381607[_0x75496(0x2c6)]);vi[_0x75496(0x1cf)](),Object[_0x75496(0x1d9)](globalThis,_0x75496(0x2a2),{'value':_0xc1cd8e,'configurable':!![]});const {getSecureRandomInt:_0x1512fb}=await import(_0x381607[_0x75496(0x28a)]),_0x46dad9=0x0,_0x31b8de=0x5,_0x54563b=0x9c40,_0x36f526={0x0:0x0,0x1:0x0,0x2:0x0,0x3:0x0,0x4:0x0,0x5:0x0};for(let _0x330db1=0x0;_0x330db1<_0x54563b;_0x330db1++){_0x36f526[await _0x381607['AEhTZ'](_0x1512fb,_0x46dad9,_0x31b8de)]++;}expect(_0x381607[_0x75496(0x29e)](chiSquaredTest,_0x36f526,_0x54563b))[_0x75496(0x2ce)](!![]),Object[_0x75496(0x1d9)](globalThis,_0x381607[_0x75496(0x20a)],{'value':mockCrypto,'configurable':!![]});});}),describe['each']([[_0x381607[_0xda3866(0x213)],getSecureRandomAsync,!![]],[_0x381607[_0xda3866(0x2c0)],getSecureRandom,![]]])('%s',(_0x486537,_0x490dda,_0x5c8648)=>{const _0x50925a=_0xda3866,_0x1fd914=()=>createTestRunner(_0x490dda,_0x5c8648)();it(_0x381607['gYvNU'],async()=>{const _0x9b6559=_0x32e1;'aiyZH'===_0x9b6559(0x210)?(await _0x1fd914(),_0x381607[_0x9b6559(0x2d2)](expect,mockCrypto['getRandomValues'])[_0x9b6559(0x2e2)](0x1),expect(vi['mocked'](mockCrypto[_0x9b6559(0x241)])[_0x9b6559(0x286)][_0x9b6559(0x290)][0x0][0x0])['toBeInstanceOf'](BigUint64Array)):(_0x4a06bd['env'][_0x9b6559(0x1f1)]=_0x40e3cc,_0x161fae[_0x9b6559(0x1cf)]());}),_0x381607[_0x50925a(0x273)](it,'should\x20use\x20fallback\x20(32-bit)\x20path\x20when\x20BigUint64Array\x20is\x20NOT\x20available',async()=>{const _0xfc4855=_0x50925a,_0x3a6d43=globalThis['BigUint64Array'];globalThis[_0xfc4855(0x24f)]=undefined,await _0x1fd914(),_0x381607[_0xfc4855(0x270)](expect,mockCrypto['getRandomValues'])[_0xfc4855(0x2e2)](0x1),expect(vi[_0xfc4855(0x1ec)](mockCrypto['getRandomValues'])[_0xfc4855(0x286)][_0xfc4855(0x290)][0x0][0x0])[_0xfc4855(0x2ae)](Uint32Array),globalThis[_0xfc4855(0x24f)]=_0x3a6d43;});}),describe[_0xda3866(0x239)]([[_0x381607['cLCKs'],shouldExecuteThrottledAsync,!![]],[_0x381607[_0xda3866(0x2b1)],shouldExecuteThrottled,![]]])('%s',(_0x392ae3,_0x435950,_0x270c4a)=>{const _0x2d7e0d=_0xda3866,_0x5909a0={'vUwqb':function(_0x23b9ac,_0x4d9f69){return _0x381607['YAnHd'](_0x23b9ac,_0x4d9f69);},'ESrJP':function(_0x3606ee,_0x449fe6){return _0x3606ee(_0x449fe6);},'GEUuv':_0x381607[_0x2d7e0d(0x202)],'Owfju':function(_0x5a05bf,_0x4bf222){const _0xfdac01=_0x2d7e0d;return _0x381607[_0xfdac01(0x1ea)](_0x5a05bf,_0x4bf222);},'yeLhR':function(_0x5a5594,_0x42ccf7){return _0x5a5594+_0x42ccf7;}};if(_0x381607[_0x2d7e0d(0x246)]!==_0x2d7e0d(0x251))_0x3193c8[0x0]=_0x1fcc2d['floor'](_0x5909a0[_0x2d7e0d(0x2cf)](0.49,0xffffffff+0x1));else{const _0x3911a2=_0x1009cc=>createTestRunner(_0x435950,_0x270c4a)(_0x1009cc);_0x381607[_0x2d7e0d(0x2da)](it,_0x2d7e0d(0x2ca),async()=>{const _0x4c80a2=_0x2d7e0d,_0x5e2fae={'toMrw':function(_0x2bde57,_0x304133){return _0x2bde57 instanceof _0x304133;},'TsKky':function(_0x1dbca0,_0x3a3716){return _0x1dbca0*_0x3a3716;},'RGTLx':function(_0x4f1fa8,_0x4a5b64){return _0x381607['uCxIl'](_0x4f1fa8,_0x4a5b64);},'unwBQ':function(_0x771a16,_0x79aa92){const _0x1afb7c=_0x32e1;return _0x381607[_0x1afb7c(0x2c3)](_0x771a16,_0x79aa92);}};if(_0x381607[_0x4c80a2(0x1cd)]===_0x381607[_0x4c80a2(0x1cd)]){const _0x5a8890=vi[_0x4c80a2(0x1ec)](mockCrypto[_0x4c80a2(0x241)])[_0x4c80a2(0x2a9)]();vi[_0x4c80a2(0x1ec)](mockCrypto[_0x4c80a2(0x241)])[_0x4c80a2(0x237)](_0x889ca9=>{const _0x542722=_0x4c80a2,_0x40ecad={'KyzuV':function(_0x552513,_0x1f4f4b){const _0x37c4c9=_0x32e1;return _0x5909a0[_0x37c4c9(0x245)](_0x552513,_0x1f4f4b);}};if(_0x542722(0x1d3)===_0x5909a0[_0x542722(0x2d1)])_0x40ecad['KyzuV'](_0xe9c4b2,_0x5cd3c5)[_0x542722(0x2ae)](_0x5e4201);else return _0x5909a0[_0x542722(0x296)](_0x889ca9,BigUint64Array)?_0x889ca9[0x0]=_0x5909a0[_0x542722(0x245)](BigInt,_0x542722(0x2be)):_0x889ca9[0x0]=Math[_0x542722(0x24e)](0.49*_0x5909a0['yeLhR'](0xffffffff,0x1)),_0x889ca9;}),await _0x381607[_0x4c80a2(0x28f)](expect,_0x381607[_0x4c80a2(0x2ac)](_0x3911a2,0.5))['resolves'][_0x4c80a2(0x2ce)](!![]),vi[_0x4c80a2(0x1ec)](mockCrypto['getRandomValues'])[_0x4c80a2(0x237)](_0x4010d2=>{const _0x3ea750=_0x4c80a2;if(_0x4010d2 instanceof BigUint64Array)_0x4010d2[0x0]=_0x5e2fae[_0x3ea750(0x27a)](BigInt,_0x3ea750(0x1fd));else{if(_0x3ea750(0x287)===_0x3ea750(0x253))return _0x5e2fae[_0x3ea750(0x220)](_0x138e1c,_0x32871b)?_0x739915[0x0]=_0x4c51ec(_0x3ea750(0x2be)):_0xcdea78[0x0]=_0x46fae[_0x3ea750(0x24e)](_0x5e2fae[_0x3ea750(0x1fb)](0.49,0xffffffff+0x1)),_0x57af3c;else _0x4010d2[0x0]=Math['floor'](_0x5e2fae[_0x3ea750(0x1fb)](0.51,_0x5e2fae[_0x3ea750(0x1e1)](0xffffffff,0x1)));}return _0x4010d2;}),await expect(_0x3911a2(0.5))[_0x4c80a2(0x1d8)][_0x4c80a2(0x2ce)](![]),vi[_0x4c80a2(0x1ec)](mockCrypto[_0x4c80a2(0x241)])['mockImplementation'](_0x5a8890);}else{const _0x104441=_0x25e903['now']()-_0x3612dd;_0x4b8e44(_0x104441)[_0x4c80a2(0x1f3)](0x3e8);}});}}),_0x381607[_0xda3866(0x219)](describe,_0x381607[_0xda3866(0x21e)],()=>{const _0x4b290f=_0xda3866,_0x3616fa=process[_0x4b290f(0x20d)]['NODE_ENV'];afterEach(()=>{const _0x27c487=_0x4b290f;process[_0x27c487(0x20d)][_0x27c487(0x1f1)]=_0x3616fa,vi[_0x27c487(0x1cf)]();}),it(_0x381607[_0x4b290f(0x1fa)],async()=>{const _0x5891dc=_0x4b290f;process[_0x5891dc(0x20d)][_0x5891dc(0x1f1)]=_0x5891dc(0x23a),vi['resetModules']();const {environment:_0x26cbb5}=await import(_0x5891dc(0x272));expect(_0x26cbb5[_0x5891dc(0x247)])[_0x5891dc(0x2ce)](!![]);}),_0x381607[_0x4b290f(0x26d)](it,_0x381607[_0x4b290f(0x274)],async()=>{const _0x2f05c4=_0x4b290f;process['env']['NODE_ENV']=_0x381607[_0x2f05c4(0x285)],vi[_0x2f05c4(0x1cf)]();const {environment:_0xffec75}=await import('../src/security-kit.js');_0x381607[_0x2f05c4(0x28f)](expect,_0xffec75['isProduction'])['toBe'](!![]);}),it(_0x381607[_0x4b290f(0x2d6)],async()=>{const _0x329fbc=_0x4b290f;process[_0x329fbc(0x20d)][_0x329fbc(0x1f1)]=_0x381607[_0x329fbc(0x2c1)],vi[_0x329fbc(0x1cf)]();const {secureDevLog:_0x221e77}=await import('../src/security-kit.js'),_0x166b3c=globalThis[_0x329fbc(0x22d)];globalThis[_0x329fbc(0x22d)]=undefined;const _0x431ca5=JSON[_0x329fbc(0x27b)](_0x329fbc(0x231));_0x221e77(_0x381607[_0x329fbc(0x1ee)],_0x381607[_0x329fbc(0x2b5)],_0x329fbc(0x23f),_0x431ca5),_0x381607[_0x329fbc(0x295)](expect,{}[_0x329fbc(0x275)])[_0x329fbc(0x1ef)](),globalThis[_0x329fbc(0x22d)]=_0x166b3c;});}),describe(_0x381607[_0xda3866(0x27c)],()=>{const _0x3586ba=_0xda3866,_0x41c990={'GApKa':function(_0x301adc,_0x4e7276){const _0x172aa5=_0x32e1;return _0x381607[_0x172aa5(0x26f)](_0x301adc,_0x4e7276);},'vgzmu':_0x381607['VTkGn'],'EBAxY':_0x3586ba(0x2b0),'sddyE':function(_0x1c5188,_0x30e634){const _0x1d5e4c=_0x3586ba;return _0x381607[_0x1d5e4c(0x263)](_0x1c5188,_0x30e634);}};if(_0x381607[_0x3586ba(0x1d2)]!==_0x3586ba(0x1e3))_0x381607['rnMPK'](it,_0x3586ba(0x1f9),async()=>{const _0x3f8277=_0x3586ba,{webcrypto:_0x6cff7b}=await vi[_0x3f8277(0x1d4)](_0x3f8277(0x209));vi[_0x3f8277(0x1cf)](),Object[_0x3f8277(0x1d9)](globalThis,_0x3f8277(0x2a2),{'value':_0x6cff7b,'configurable':!![]});const {generateSecureId:_0x4862da}=await import(_0x3f8277(0x272)),_0x60f16f=_0x381607[_0x3f8277(0x25e)](Array,0x64)[_0x3f8277(0x1f0)](0x0)['map'](()=>_0x4862da(0x10)),_0x47b9ac=await Promise['all'](_0x60f16f),_0x5500d2=new Set(_0x47b9ac);expect(_0x5500d2['size'])[_0x3f8277(0x2ce)](0x64),Object[_0x3f8277(0x1d9)](globalThis,_0x381607[_0x3f8277(0x20a)],{'value':mockCrypto,'configurable':!![]});}),it(_0x381607[_0x3586ba(0x266)],async()=>{const _0x229625=_0x3586ba;if(_0x41c990[_0x229625(0x2b3)](_0x41c990[_0x229625(0x249)],_0x41c990[_0x229625(0x248)])){const _0x2a3436={'from':vi['fn']()[_0x229625(0x203)]({'toString':vi['fn']()[_0x229625(0x203)](_0x229625(0x2d4))})},_0x56a9ca=globalThis[_0x229625(0x1dd)];globalThis[_0x229625(0x1dd)]=_0x2a3436;try{const _0x5a5264=await generateSecureId(0x10);expect(_0x2a3436[_0x229625(0x1ff)])[_0x229625(0x2e2)](0x1),_0x41c990[_0x229625(0x26a)](expect,_0x5a5264)[_0x229625(0x2ce)](_0x229625(0x2d4));}finally{globalThis[_0x229625(0x1dd)]=_0x56a9ca;}}else _0x7f1afe['Buffer']=_0x410e32;});else{const _0x296c29=_0x3a5531[_0x3586ba(0x23b)](_0x2e0342),_0x56c002=_0x296c29[_0x3586ba(0x1db)],_0x1b8a6d=_0x53b279/_0x56c002,_0x590efb=_0x56c002-0x1,_0x50c260={0x1:3.84,0x2:5.99,0x3:7.81,0x4:9.49,0x5:11.07,0x9:16.92,0xf:0x19},_0x231fa8=_0x50c260[_0x590efb];if(!_0x231fa8)throw new _0x3fa3b1('No\x20critical\x20value\x20for\x20'+_0x590efb+_0x3586ba(0x1e0));let _0xa19acb=0x0;for(const _0x29b654 of _0x296c29){_0xa19acb+=_0x381607[_0x3586ba(0x24d)](_0x381607['PCixc'](_0x38dd94[_0x29b654],_0x1b8a6d)**0x2,_0x1b8a6d);}return _0x381607[_0x3586ba(0x281)](_0xa19acb,_0x231fa8);}}),describe('Buffer\x20Overflow\x20and\x20DoS\x20Protection\x20Tests',()=>{const _0x17d3e0=_0xda3866,_0xa3d2fd={'EMeqI':function(_0x13d01d,_0x31d02d){return _0x13d01d(_0x31d02d);},'qqsaY':function(_0x45c3b6,_0x2c3cf4){return _0x45c3b6(_0x2c3cf4);},'acFOK':function(_0x46f9a0,_0x563e79){const _0x50dbb4=_0x32e1;return _0x381607[_0x50dbb4(0x263)](_0x46f9a0,_0x563e79);},'UylbV':function(_0x5df32c,_0x369b83){return _0x5df32c**_0x369b83;},'CUjJD':function(_0x499c28,_0x208609){const _0x250d47=_0x32e1;return _0x381607[_0x250d47(0x1d0)](_0x499c28,_0x208609);},'ZqSpp':function(_0x435b24,_0x3fb176){const _0x153f02=_0x32e1;return _0x381607[_0x153f02(0x2c4)](_0x435b24,_0x3fb176);},'MSUDo':function(_0x1e1a4f,_0x18ce05){return _0x1e1a4f**_0x18ce05;},'dLZau':function(_0x3138d1,_0x384f72,_0x3d3755){return _0x3138d1(_0x384f72,_0x3d3755);},'eILtF':function(_0x351733,_0x5b5bae){return _0x351733-_0x5b5bae;},'SOVzh':function(_0x3bca13,_0x2579ba,_0x49ec4b){return _0x381607['VNVNW'](_0x3bca13,_0x2579ba,_0x49ec4b);},'vAclN':function(_0x5b4f41,_0x2ca778){return _0x5b4f41+_0x2ca778;},'IFFQd':function(_0x1ee91e,_0x305321){const _0x59f1c0=_0x32e1;return _0x381607[_0x59f1c0(0x25c)](_0x1ee91e,_0x305321);},'ZaSpc':function(_0xadc3f,_0x10f635,_0xbb16cf){return _0x381607['ZnqHR'](_0xadc3f,_0x10f635,_0xbb16cf);},'pbGWr':function(_0x2422eb,_0x2a0509){return _0x2422eb(_0x2a0509);},'xmrsb':_0x381607[_0x17d3e0(0x292)],'xiCkW':function(_0xf46c25,_0x1818f9){return _0xf46c25**_0x1818f9;},'llzXF':function(_0x25c5c3,_0x44317e){const _0x55f827=_0x17d3e0;return _0x381607[_0x55f827(0x214)](_0x25c5c3,_0x44317e);},'FzQjC':function(_0x313ef2,_0x65253e){return _0x381607['PQltr'](_0x313ef2,_0x65253e);},'bglIf':function(_0x2a24eb,_0x8158e){return _0x2a24eb**_0x8158e;},'aEaBh':function(_0x1a2f8c,_0x43ec92){return _0x1a2f8c(_0x43ec92);},'KDaof':function(_0x5b49ae,_0x3caa84){const _0x19b412=_0x17d3e0;return _0x381607[_0x19b412(0x2b9)](_0x5b49ae,_0x3caa84);}};describe('ID\x20Generation\x20DoS\x20Protection',()=>{const _0x5dce28=_0x17d3e0,_0x4869d7={'ATVpi':function(_0x4090b6,_0x58bb44){return _0x381607['Ufccd'](_0x4090b6,_0x58bb44);}};it(_0x381607[_0x5dce28(0x2bd)],async()=>{const _0x3d73a7=_0x5dce28;await expect(_0xa3d2fd[_0x3d73a7(0x254)](generateSecureId,0x100))[_0x3d73a7(0x1d8)][_0x3d73a7(0x1f2)](0x100),await _0xa3d2fd['qqsaY'](expect,_0xa3d2fd['acFOK'](generateSecureId,0x101))[_0x3d73a7(0x2c7)][_0x3d73a7(0x288)](InvalidParameterError),await _0xa3d2fd[_0x3d73a7(0x2a1)](expect,generateSecureId(0x101))[_0x3d73a7(0x2c7)][_0x3d73a7(0x288)](/length must be an integer between 1 and 256/);}),_0x381607[_0x5dce28(0x2e4)](it,_0x381607[_0x5dce28(0x1f5)],()=>{const _0x4f50de=_0x5dce28;expect(generateSecureIdSync(0x100))[_0x4f50de(0x1f2)](0x100),expect(()=>generateSecureIdSync(0x101))[_0x4f50de(0x288)](InvalidParameterError),_0x4869d7[_0x4f50de(0x20e)](expect,()=>generateSecureIdSync(0x101))[_0x4f50de(0x288)](/length must be an integer between 1 and 256/);}),it(_0x5dce28(0x244),async()=>{const _0x5d0bc3=_0x5dce28;if(_0x5d0bc3(0x1da)===_0x5d0bc3(0x2ad))return _0x1a197a[_0x5d0bc3(0x29c)](_0x523c36);else{const _0x2a31be=[0x3e8,0x2710,0x186a0,Number['MAX_SAFE_INTEGER'],0x2**0x14,_0xa3d2fd[_0x5d0bc3(0x1f4)](0x2,0x1e)];for(const _0x96a07 of _0x2a31be){await _0xa3d2fd[_0x5d0bc3(0x232)](expect,generateSecureId(_0x96a07))['rejects'][_0x5d0bc3(0x288)](InvalidParameterError),_0xa3d2fd[_0x5d0bc3(0x24b)](expect,()=>generateSecureIdSync(_0x96a07))['toThrow'](InvalidParameterError);}}});}),describe(_0x381607['InEou'],()=>{const _0x169d82=_0x17d3e0;_0x381607[_0x169d82(0x258)](it,'should\x20enforce\x20strict\x20range\x20boundaries\x20to\x20prevent\x20integer\x20overflow',async()=>{const _0x3de1f6=_0x169d82,_0x1e867a={'anvoA':function(_0xf6f76d,_0x41962e){return _0xf6f76d(_0x41962e);}};if(_0x3de1f6(0x222)===_0x3de1f6(0x1e6))_0x59f630(_0x1e867a['anvoA'](_0x49c869,0x100))[_0x3de1f6(0x1f2)](0x100),_0x1e867a['anvoA'](_0x46e149,()=>_0x322647(0x101))[_0x3de1f6(0x288)](_0x349d97),_0x379e78(()=>_0x4027c2(0x101))[_0x3de1f6(0x288)](/length must be an integer between 1 and 256/);else{const _0x247a6f=_0xa3d2fd[_0x3de1f6(0x29b)](0x2,0x1f),_0x281d2e=-_0xa3d2fd[_0x3de1f6(0x29b)](0x2,0x1f);await expect(getSecureRandomInt(0xf4240,0x1e8480))[_0x3de1f6(0x1d8)]['toBeDefined'](),await _0xa3d2fd[_0x3de1f6(0x24b)](expect,getSecureRandomInt(-0xf4240,-0x7a120))[_0x3de1f6(0x1d8)][_0x3de1f6(0x282)](),await expect(_0xa3d2fd[_0x3de1f6(0x294)](getSecureRandomInt,_0xa3d2fd[_0x3de1f6(0x22e)](_0x281d2e,0x1),0x0))[_0x3de1f6(0x2c7)][_0x3de1f6(0x288)](InvalidParameterError),await expect(getSecureRandomInt(0x0,_0x247a6f+0x1))[_0x3de1f6(0x2c7)]['toThrow'](InvalidParameterError),await _0xa3d2fd[_0x3de1f6(0x24b)](expect,getSecureRandomInt(Number[_0x3de1f6(0x257)],0x0))[_0x3de1f6(0x2c7)]['toThrow'](InvalidParameterError),await expect(_0xa3d2fd[_0x3de1f6(0x2e3)](getSecureRandomInt,0x0,Number[_0x3de1f6(0x236)]))[_0x3de1f6(0x2c7)]['toThrow'](InvalidParameterError);}}),it(_0x381607[_0x169d82(0x1e5)],async()=>{const _0x49b213=_0x169d82,_0x19e0ee=[[Number[_0x49b213(0x257)],Number[_0x49b213(0x236)]],[_0xa3d2fd[_0x49b213(0x289)](-(0x2**0x1f),0x1),0x2**0x1f]];for(const [_0x270273,_0x5410a1]of _0x19e0ee){(_0xa3d2fd[_0x49b213(0x269)](_0x270273,-_0xa3d2fd[_0x49b213(0x1f4)](0x2,0x1f))||_0x5410a1>0x2**0x1f)&&await expect(_0xa3d2fd[_0x49b213(0x1f8)](getSecureRandomInt,_0x270273,_0x5410a1))[_0x49b213(0x2c7)][_0x49b213(0x288)](InvalidParameterError);}}),it(_0x169d82(0x2ee),async()=>{const _0x296e62=_0x169d82;vi[_0x296e62(0x1ec)](mockCrypto[_0x296e62(0x241)])[_0x296e62(0x237)](_0x5eee1b=>{return _0x5eee1b['fill'](0xff),_0x5eee1b;}),await expect(getSecureRandomInt(0x0,0x1))[_0x296e62(0x2c7)]['toThrow'](/Failed to generate random integer within reasonable iterations/);const _0x8cd951=Date[_0x296e62(0x259)]();try{await getSecureRandomInt(0x0,0x1);}catch(_0x130d64){const _0x180258=Date['now']()-_0x8cd951;_0xa3d2fd[_0x296e62(0x207)](expect,_0x180258)[_0x296e62(0x1f3)](0x3e8);}});}),_0x381607[_0x17d3e0(0x2c5)](describe,'Memory\x20Exhaustion\x20Attack\x20Simulation',()=>{const _0xed8675=_0x17d3e0,_0x177733={'ObrPD':function(_0x55f46e,_0x3d76c3){return _0x55f46e(_0x3d76c3);},'vsCdO':_0xed8675(0x227),'fHLjE':function(_0x420f09,_0x5bde6b){const _0x33a3dd=_0xed8675;return _0x381607[_0x33a3dd(0x2b9)](_0x420f09,_0x5bde6b);},'UFpUm':_0xed8675(0x262),'UkNrG':function(_0x49ac86,_0x399061){return _0x49ac86<_0x399061;},'KzvRi':function(_0x852aef,_0x23ad18){return _0x852aef(_0x23ad18);},'rkHmr':function(_0x4c5a6c,_0xa6c7b){return _0x4c5a6c<_0xa6c7b;},'jUnSN':function(_0x2cb595,_0x404b0b){const _0xcf955=_0xed8675;return _0x381607[_0xcf955(0x24d)](_0x2cb595,_0x404b0b);},'fQccd':function(_0xa9ca14,_0x57dc64){const _0x42fd7f=_0xed8675;return _0x381607[_0x42fd7f(0x25b)](_0xa9ca14,_0x57dc64);}};if('hTJdV'==='VPFLY'){const _0x3095e7=new _0x3d144d();_0x1abd83(_0x3095e7)['toBeInstanceOf'](_0x13b7f7),_0x177733['ObrPD'](_0x91b36a,_0x3095e7['name'])['toBe'](_0xed8675(0x297)),_0x35518e(_0x3095e7[_0xed8675(0x23f)])[_0xed8675(0x2c8)](/\[secure-helpers\] A compliant Web Crypto API is not available/);const _0x3ca6fa=new _0x10b393(_0x177733[_0xed8675(0x250)]);_0x1151a6(_0x3ca6fa[_0xed8675(0x23f)])[_0xed8675(0x2ce)]('[secure-helpers]\x20test');}else _0x381607['HiVAf'](it,'should\x20handle\x20rapid\x20successive\x20large\x20requests\x20without\x20memory\x20issues',async()=>{const _0x5393e2=_0xed8675,_0x235104={'alPaE':function(_0x24dbb6,_0x349598){const _0xc6daae=_0x32e1;return _0x177733[_0xc6daae(0x215)](_0x24dbb6,_0x349598);}};if(_0x177733[_0x5393e2(0x1df)]!==_0x5393e2(0x262))_0x3a60c4[0x0]=_0x235104[_0x5393e2(0x2ed)](_0x4e86c1,_0x5393e2(0x2be));else{const _0x5b7c88=[];for(let _0x3ad7de=0x0;_0x177733[_0x5393e2(0x1e4)](_0x3ad7de,0x64);_0x3ad7de++){if(_0x5393e2(0x226)===_0x5393e2(0x2a0))return _0x1efc73[_0x5393e2(0x1f0)](0xff),_0x1c3af9;else _0x5b7c88[_0x5393e2(0x264)](_0x177733[_0x5393e2(0x1f7)](generateSecureId,0x100)[_0x5393e2(0x1e2)](()=>_0x5393e2(0x26b)),_0x177733[_0x5393e2(0x20b)](generateSecureId,0x101)[_0x5393e2(0x1e2)](()=>_0x5393e2(0x26b)));}const _0x25b99c=await Promise['all'](_0x5b7c88),_0x16b9a3=_0x25b99c[_0x5393e2(0x2e8)](_0x543fad=>_0x543fad!=='expected_failure')[_0x5393e2(0x1db)],_0x54d10f=_0x25b99c[_0x5393e2(0x2e8)](_0x5bb365=>_0x5bb365==='expected_failure')[_0x5393e2(0x1db)];expect(_0x16b9a3)['toBe'](0x64),expect(_0x54d10f)[_0x5393e2(0x2ce)](0x64);}}),_0x381607[_0xed8675(0x20c)](it,_0xed8675(0x26e),async()=>{const _0x12d29a=_0xed8675,_0x2010e0=0x32,_0x4b2523=[];for(let _0x23c2ca=0x0;_0x177733[_0x12d29a(0x26c)](_0x23c2ca,_0x2010e0);_0x23c2ca++){const _0x2ecbab=performance[_0x12d29a(0x259)]();try{await generateSecureId(0x3e8);}catch(_0xe190e1){expect(_0xe190e1)[_0x12d29a(0x2ae)](InvalidParameterError);}const _0x26b598=performance[_0x12d29a(0x259)]()-_0x2ecbab;_0x4b2523[_0x12d29a(0x264)](_0x26b598);}const _0xc87f00=_0x177733['jUnSN'](_0x4b2523['reduce']((_0x1b2bcd,_0x4469a9)=>_0x1b2bcd+_0x4469a9),_0x4b2523['length']),_0x24f213=Math[_0x12d29a(0x291)](..._0x4b2523);_0x177733[_0x12d29a(0x1e9)](expect,_0xc87f00)['toBeLessThan'](0x5),expect(_0x24f213)[_0x12d29a(0x1f3)](0x14);});}),describe(_0x17d3e0(0x276),()=>{const _0x437232=_0x17d3e0;if(_0x381607[_0x437232(0x242)](_0x437232(0x2ba),_0x437232(0x24a)))return _0x362075[0x0]=0x19,_0x139b6a;else it(_0x437232(0x268),async()=>{const _0x280667=_0x437232,_0xd40401={'YjvNT':function(_0x2bb57a,_0x563036){return _0x2bb57a(_0x563036);},'fWkBo':function(_0x115e45,_0x2f2f4e){return _0x115e45+_0x2f2f4e;}};if(_0x280667(0x2a8)===_0xa3d2fd[_0x280667(0x2e6)]){const _0xa4c407=[[0x0,_0xa3d2fd[_0x280667(0x22e)](_0xa3d2fd['UylbV'](0x2,0x20),0x1)],[0x3b9aca00,0x77359400],[-_0xa3d2fd[_0x280667(0x2e9)](0x2,0x1e),_0xa3d2fd[_0x280667(0x27d)](0x2,0x1e)]];for(const [_0x5dafeb,_0x3e7ffa]of _0xa4c407){if('bQvND'!==_0x280667(0x280))return _0x155cf1 instanceof _0x27731d?_0x4ee2fd[0x0]=_0xd40401['YjvNT'](_0x1dfae5,_0x280667(0x1fd)):_0x2b4146[0x0]=_0x50e97d[_0x280667(0x24e)](0.51*_0xd40401[_0x280667(0x271)](0xffffffff,0x1)),_0x1fc459;else{if(_0xa3d2fd['FzQjC'](_0x5dafeb,-_0xa3d2fd[_0x280667(0x1cc)](0x2,0x1f))&&_0x3e7ffa<=0x2**0x1f){const _0x319100=await _0xa3d2fd['dLZau'](getSecureRandomInt,_0x5dafeb,_0x3e7ffa);_0xa3d2fd['aEaBh'](expect,_0x319100)[_0x280667(0x293)](_0x5dafeb),expect(_0x319100)[_0x280667(0x256)](_0x3e7ffa),_0xa3d2fd['KDaof'](expect,Number[_0x280667(0x208)](_0x319100))['toBe'](!![]);}}}}else _0x2e7d40[_0x280667(0x218)]();}),it('should\x20detect\x20and\x20prevent\x20buffer\x20allocation\x20overflow\x20scenarios',async()=>{const _0x406f91=_0x437232,_0x5bf4db=[[Number[_0x406f91(0x257)],0x0],[0x0,Number[_0x406f91(0x236)]]];for(const [_0x2c3b9d,_0x32fef7]of _0x5bf4db){await expect(_0xa3d2fd['SOVzh'](getSecureRandomInt,_0x2c3b9d,_0x32fef7))[_0x406f91(0x2c7)]['toThrow'](InvalidParameterError);}});});});});