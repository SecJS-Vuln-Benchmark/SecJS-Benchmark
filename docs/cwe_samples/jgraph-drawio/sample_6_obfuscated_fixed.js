'use strict';var _0x191869=_0x1d8e;(function(_0x13c8e2,_0x4028c7){var _0x2292e4=_0x1d8e,_0x3b4eea=_0x13c8e2();while(!![]){try{var _0x333b4a=parseInt(_0x2292e4(0x12c))/0x1+parseInt(_0x2292e4(0x17e))/0x2+-parseInt(_0x2292e4(0x153))/0x3*(-parseInt(_0x2292e4(0x16b))/0x4)+parseInt(_0x2292e4(0x172))/0x5+-parseInt(_0x2292e4(0x13d))/0x6+parseInt(_0x2292e4(0x176))/0x7*(parseInt(_0x2292e4(0x15f))/0x8)+-parseInt(_0x2292e4(0x14c))/0x9;if(_0x333b4a===_0x4028c7)break;else _0x3b4eea['push'](_0x3b4eea['shift']());}catch(_0x5a2ad0){_0x3b4eea['push'](_0x3b4eea['shift']());}}}(_0x3945,0x63d00));var BN=require(_0x191869(0x165)),HmacDRBG=require('hmac-drbg'),utils=require(_0x191869(0x127)),curves=require('../curves'),rand=require(_0x191869(0x17c)),assert=utils[_0x191869(0x152)],KeyPair=require('./key'),Signature=require('./signature');function EC(_0x198013){var _0x5842af=_0x191869,_0x4f003a={'HKgxT':function(_0x3da048,_0x28b96f){return _0x3da048 instanceof _0x28b96f;},'MbDTw':function(_0x13feea,_0x261101){return _0x13feea===_0x261101;},'ziKDm':_0x5842af(0x12d),'WaMHj':function(_0x390415,_0x1ef5f8,_0x3eb971){return _0x390415(_0x1ef5f8,_0x3eb971);},'fIWnX':function(_0x4decb8,_0x27f940){return _0x4decb8+_0x27f940;},'quENT':function(_0x2e90a0,_0x168995){return _0x2e90a0 instanceof _0x168995;},'MEgqx':function(_0x1301d4,_0x341782){return _0x1301d4+_0x341782;}};if(!_0x4f003a[_0x5842af(0x17d)](this,EC))return new EC(_0x198013);if(_0x4f003a['MbDTw'](typeof _0x198013,_0x5842af(0x13c))){if(_0x5842af(0x174)===_0x4f003a[_0x5842af(0x141)])return new _0x1d518a(this,_0x5e1984);else _0x4f003a['WaMHj'](assert,Object[_0x5842af(0x12b)][_0x5842af(0x12f)][_0x5842af(0x13f)](curves,_0x198013),_0x4f003a['fIWnX'](_0x5842af(0x139),_0x198013)),_0x198013=curves[_0x198013];}if(_0x4f003a[_0x5842af(0x15c)](_0x198013,curves[_0x5842af(0x162)]))_0x198013={'curve':_0x198013};this[_0x5842af(0x169)]=_0x198013[_0x5842af(0x169)][_0x5842af(0x169)],this['n']=this[_0x5842af(0x169)]['n'],this['nh']=this['n']['ushrn'](0x1),this['g']=this[_0x5842af(0x169)]['g'],this['g']=_0x198013['curve']['g'],this['g']['precompute'](_0x4f003a[_0x5842af(0x134)](_0x198013['curve']['n']['bitLength'](),0x1)),this['hash']=_0x198013[_0x5842af(0x155)]||_0x198013[_0x5842af(0x169)][_0x5842af(0x155)];}function _0x1d8e(_0x109797,_0x5e2ed8){var _0x39453a=_0x3945();return _0x1d8e=function(_0x1d8e5a,_0x15e291){_0x1d8e5a=_0x1d8e5a-0x125;var _0x5dc339=_0x39453a[_0x1d8e5a];return _0x5dc339;},_0x1d8e(_0x109797,_0x5e2ed8);}module[_0x191869(0x178)]=EC,EC[_0x191869(0x12b)][_0x191869(0x129)]=function keyPair(_0x3c64a6){return new KeyPair(this,_0x3c64a6);},EC[_0x191869(0x12b)][_0x191869(0x167)]=function keyFromPrivate(_0x3d09b5,_0x155bad){var _0xf1dfc1=_0x191869;return KeyPair[_0xf1dfc1(0x171)](this,_0x3d09b5,_0x155bad);},EC[_0x191869(0x12b)][_0x191869(0x163)]=function keyFromPublic(_0x2662fb,_0x2a1930){var _0x400cbf=_0x191869;return KeyPair[_0x400cbf(0x13a)](this,_0x2662fb,_0x2a1930);},EC[_0x191869(0x12b)]['genKeyPair']=function genKeyPair(_0x5f14de){var _0x12fd27=_0x191869,_0x269a50={'AQPBq':function(_0x42233f,_0x1640c6){return _0x42233f(_0x1640c6);},'jQjoV':_0x12fd27(0x177)};if(!_0x5f14de)_0x5f14de={};var _0x3d90bf=new HmacDRBG({'hash':this['hash'],'pers':_0x5f14de[_0x12fd27(0x148)],'persEnc':_0x5f14de[_0x12fd27(0x180)]||_0x12fd27(0x177),'entropy':_0x5f14de[_0x12fd27(0x161)]||_0x269a50['AQPBq'](rand,this['hash'][_0x12fd27(0x132)]),'entropyEnc':_0x5f14de[_0x12fd27(0x161)]&&_0x5f14de[_0x12fd27(0x128)]||_0x269a50[_0x12fd27(0x181)],'nonce':this['n']['toArray']()}),_0x3a7f3a=this['n']['byteLength'](),_0x505b42=this['n'][_0x12fd27(0x182)](new BN(0x2));for(;;){var _0x4aa0c0=new BN(_0x3d90bf[_0x12fd27(0x13b)](_0x3a7f3a));if(_0x4aa0c0['cmp'](_0x505b42)>0x0)continue;return _0x4aa0c0['iaddn'](0x1),this[_0x12fd27(0x167)](_0x4aa0c0);}},EC[_0x191869(0x12b)]['_truncateToN']=function _truncateToN(_0x46860d,_0x1f0e0b,_0x32c886){var _0x29a918=_0x191869,_0x25b896={'wIlhN':'4|3|2|1|0|5','utowe':function(_0x36527e,_0x1ae6a0){return _0x36527e>_0x1ae6a0;},'Aprau':function(_0x468132,_0x5907d4){return _0x468132-_0x5907d4;},'KASPl':_0x29a918(0x168),'ZgfEx':function(_0x48a093,_0x188cd7){return _0x48a093*_0x188cd7;},'pJgXX':function(_0x2d226b,_0x13b097){return _0x2d226b===_0x13b097;},'kHtJe':_0x29a918(0x16e),'FRyuN':function(_0x5c51ce,_0x55354d){return _0x5c51ce>=_0x55354d;}},_0x301ca5=_0x25b896['wIlhN'][_0x29a918(0x144)]('|'),_0x13a582=0x0;while(!![]){switch(_0x301ca5[_0x13a582++]){case'0':if(_0x25b896['utowe'](_0xd33439,0x0))_0x46860d=_0x46860d[_0x29a918(0x15a)](_0xd33439);continue;case'1':var _0xd33439=_0x25b896[_0x29a918(0x15d)](_0x32c886,this['n']['bitLength']());continue;case'2':typeof _0x32c886!==_0x25b896[_0x29a918(0x147)]&&(_0x32c886=_0x25b896[_0x29a918(0x14d)](_0x2afa43,0x8));continue;case'3':if(BN[_0x29a918(0x149)](_0x46860d)||_0x25b896[_0x29a918(0x160)](typeof _0x46860d,_0x25b896[_0x29a918(0x147)]))_0x46860d=new BN(_0x46860d,0x10),_0x2afa43=_0x46860d['byteLength']();else{if(_0x25b896['pJgXX'](typeof _0x46860d,_0x25b896[_0x29a918(0x14e)]))_0x2afa43=_0x46860d[_0x29a918(0x137)],_0x46860d=new BN(_0x46860d,0x10);else{var _0x118247=_0x46860d[_0x29a918(0x143)]();_0x2afa43=_0x118247[_0x29a918(0x137)]+0x1>>>0x1,_0x46860d=new BN(_0x118247,0x10);}}continue;case'4':var _0x2afa43;continue;case'5':if(!_0x1f0e0b&&_0x25b896[_0x29a918(0x17a)](_0x46860d['cmp'](this['n']),0x0))return _0x46860d[_0x29a918(0x182)](this['n']);else return _0x46860d;continue;}break;}},EC[_0x191869(0x12b)][_0x191869(0x125)]=function sign(_0x473667,_0x118c55,_0x5abcb1,_0x276a99){var _0x2a75e8=_0x191869,_0xd68d44={'Isdvh':function(_0x42526a,_0x2f312c){return _0x42526a===_0x2f312c;},'gmltc':function(_0x589985,_0x14cbc6){return _0x589985|_0x14cbc6;},'YVrRR':function(_0x3fd1e9,_0x12ea79){return _0x3fd1e9!==_0x12ea79;}};_0xd68d44[_0x2a75e8(0x17f)](typeof _0x5abcb1,'object')&&(_0x276a99=_0x5abcb1,_0x5abcb1=null);if(!_0x276a99)_0x276a99={};_0x118c55=this[_0x2a75e8(0x167)](_0x118c55,_0x5abcb1),_0x473667=this[_0x2a75e8(0x151)](_0x473667,![],_0x276a99[_0x2a75e8(0x173)]);var _0x337c51=this['n']['byteLength'](),_0x464afb=_0x118c55[_0x2a75e8(0x12e)]()[_0x2a75e8(0x138)]('be',_0x337c51),_0x32ecd9=_0x473667[_0x2a75e8(0x138)]('be',_0x337c51),_0x556a12=new HmacDRBG({'hash':this[_0x2a75e8(0x155)],'entropy':_0x464afb,'nonce':_0x32ecd9,'pers':_0x276a99[_0x2a75e8(0x148)],'persEnc':_0x276a99[_0x2a75e8(0x180)]||_0x2a75e8(0x177)}),_0x419787=this['n']['sub'](new BN(0x1));for(var _0x4cf240=0x0;;_0x4cf240++){var _0x1cdca0=_0x276a99['k']?_0x276a99['k'](_0x4cf240):new BN(_0x556a12['generate'](this['n']['byteLength']()));_0x1cdca0=this['_truncateToN'](_0x1cdca0,!![]);if(_0x1cdca0[_0x2a75e8(0x179)](0x1)<=0x0||_0x1cdca0[_0x2a75e8(0x15b)](_0x419787)>=0x0)continue;var _0x13c080=this['g'][_0x2a75e8(0x15e)](_0x1cdca0);if(_0x13c080[_0x2a75e8(0x183)]())continue;var _0x19e4c8=_0x13c080[_0x2a75e8(0x13e)](),_0x4c25fe=_0x19e4c8[_0x2a75e8(0x131)](this['n']);if(_0x4c25fe[_0x2a75e8(0x179)](0x0)===0x0)continue;var _0x19d744=_0x1cdca0[_0x2a75e8(0x145)](this['n'])[_0x2a75e8(0x15e)](_0x4c25fe['mul'](_0x118c55[_0x2a75e8(0x12e)]())[_0x2a75e8(0x130)](_0x473667));_0x19d744=_0x19d744[_0x2a75e8(0x131)](this['n']);if(_0xd68d44[_0x2a75e8(0x17f)](_0x19d744[_0x2a75e8(0x179)](0x0),0x0))continue;var _0x54fef9=_0xd68d44[_0x2a75e8(0x142)](_0x13c080[_0x2a75e8(0x14f)]()['isOdd']()?0x1:0x0,_0xd68d44[_0x2a75e8(0x156)](_0x19e4c8[_0x2a75e8(0x15b)](_0x4c25fe),0x0)?0x2:0x0);return _0x276a99[_0x2a75e8(0x146)]&&_0x19d744['cmp'](this['nh'])>0x0&&(_0x19d744=this['n']['sub'](_0x19d744),_0x54fef9^=0x1),new Signature({'r':_0x4c25fe,'s':_0x19d744,'recoveryParam':_0x54fef9});}},EC[_0x191869(0x12b)]['verify']=function verify(_0x1fddc9,_0x195cb4,_0x39e019,_0x495564,_0x36a3a3){var _0x431ac6=_0x191869,_0x54af70={'KPxWf':_0x431ac6(0x136),'ZVpBz':_0x431ac6(0x126),'puKfm':function(_0x200ab4,_0x250c24){return _0x200ab4===_0x250c24;},'uHRsW':function(_0x23411f,_0x12ebff){return _0x23411f<_0x12ebff;},'rVbJx':function(_0x38cfe7,_0x457ba9){return _0x38cfe7>=_0x457ba9;}},_0x509972=_0x54af70[_0x431ac6(0x17b)][_0x431ac6(0x144)]('|'),_0x25448f=0x0;while(!![]){switch(_0x509972[_0x25448f++]){case'0':return _0x376287[_0x431ac6(0x164)](_0x4d0a96);case'1':_0x1fddc9=this[_0x431ac6(0x151)](_0x1fddc9,![],_0x36a3a3[_0x431ac6(0x173)]);continue;case'2':var _0x4f8ebf=_0x42c306['invm'](this['n']);continue;case'3':_0x39e019=this['keyFromPublic'](_0x39e019,_0x495564);continue;case'4':var _0x376287;continue;case'5':_0x195cb4=new Signature(_0x195cb4,_0x54af70[_0x431ac6(0x16d)]);continue;case'6':if(!this[_0x431ac6(0x169)][_0x431ac6(0x135)]){_0x376287=this['g'][_0x431ac6(0x16a)](_0x1ebbde,_0x39e019[_0x431ac6(0x16f)](),_0x33c3cb);if(_0x376287['isInfinity']())return![];return _0x54af70[_0x431ac6(0x170)](_0x376287[_0x431ac6(0x13e)]()[_0x431ac6(0x131)](this['n'])[_0x431ac6(0x15b)](_0x4d0a96),0x0);}continue;case'7':if(!_0x36a3a3)_0x36a3a3={};continue;case'8':_0x376287=this['g'][_0x431ac6(0x159)](_0x1ebbde,_0x39e019[_0x431ac6(0x16f)](),_0x33c3cb);continue;case'9':var _0x1ebbde=_0x4f8ebf[_0x431ac6(0x15e)](_0x1fddc9)['umod'](this['n']);continue;case'10':if(_0x4d0a96[_0x431ac6(0x179)](0x1)<0x0||_0x4d0a96[_0x431ac6(0x15b)](this['n'])>=0x0)return![];continue;case'11':if(_0x54af70[_0x431ac6(0x133)](_0x42c306[_0x431ac6(0x179)](0x1),0x0)||_0x54af70[_0x431ac6(0x175)](_0x42c306['cmp'](this['n']),0x0))return![];continue;case'12':var _0x4d0a96=_0x195cb4['r'];continue;case'13':var _0x33c3cb=_0x4f8ebf['mul'](_0x4d0a96)['umod'](this['n']);continue;case'14':if(_0x376287[_0x431ac6(0x183)]())return![];continue;case'15':var _0x42c306=_0x195cb4['s'];continue;}break;}},EC[_0x191869(0x12b)][_0x191869(0x150)]=function(_0x414e5c,_0x221e6a,_0x5fab68,_0x52c020){var _0x5ccbf6=_0x191869,_0x4a9323={'IllBc':function(_0x33c42c,_0x4f4545,_0x526ce9){return _0x33c42c(_0x4f4545,_0x526ce9);},'zwYRc':_0x5ccbf6(0x14a),'SxzOZ':function(_0x137a8a,_0x3013fa){return _0x137a8a&_0x3013fa;},'UKqBN':'Unable\x20to\x20find\x20sencond\x20key\x20candinate'};_0x4a9323[_0x5ccbf6(0x166)](assert,(0x3&_0x5fab68)===_0x5fab68,_0x4a9323[_0x5ccbf6(0x14b)]),_0x221e6a=new Signature(_0x221e6a,_0x52c020);var _0x1fbf06=this['n'],_0x384dce=new BN(_0x414e5c),_0x5d6ea7=_0x221e6a['r'],_0x548d3c=_0x221e6a['s'],_0x47c015=_0x4a9323[_0x5ccbf6(0x154)](_0x5fab68,0x1),_0x3bbb19=_0x5fab68>>0x1;if(_0x5d6ea7['cmp'](this[_0x5ccbf6(0x169)]['p'][_0x5ccbf6(0x131)](this['curve']['n']))>=0x0&&_0x3bbb19)throw new Error(_0x4a9323[_0x5ccbf6(0x157)]);if(_0x3bbb19)_0x5d6ea7=this[_0x5ccbf6(0x169)][_0x5ccbf6(0x12a)](_0x5d6ea7['add'](this['curve']['n']),_0x47c015);else _0x5d6ea7=this[_0x5ccbf6(0x169)]['pointFromX'](_0x5d6ea7,_0x47c015);var _0x3caa70=_0x221e6a['r'][_0x5ccbf6(0x145)](_0x1fbf06),_0x2cc4cc=_0x1fbf06[_0x5ccbf6(0x182)](_0x384dce)[_0x5ccbf6(0x15e)](_0x3caa70)['umod'](_0x1fbf06),_0x48c6b4=_0x548d3c[_0x5ccbf6(0x15e)](_0x3caa70)[_0x5ccbf6(0x131)](_0x1fbf06);return this['g'][_0x5ccbf6(0x16a)](_0x2cc4cc,_0x5d6ea7,_0x48c6b4);},EC[_0x191869(0x12b)][_0x191869(0x16c)]=function(_0x45c14b,_0x5f37b2,_0x48f7ae,_0x3b959f){var _0x3cf930=_0x191869,_0x45c9df={'RIYLL':function(_0x372bb4,_0x2a582b){return _0x372bb4!==_0x2a582b;},'osJzi':function(_0x30170d,_0x361f6f){return _0x30170d<_0x361f6f;},'oZGln':'Unable\x20to\x20find\x20valid\x20recovery\x20factor'};_0x5f37b2=new Signature(_0x5f37b2,_0x3b959f);if(_0x45c9df[_0x3cf930(0x140)](_0x5f37b2['recoveryParam'],null))return _0x5f37b2[_0x3cf930(0x158)];for(var _0x170e9c=0x0;_0x45c9df['osJzi'](_0x170e9c,0x4);_0x170e9c++){var _0x2eba75;try{_0x2eba75=this[_0x3cf930(0x150)](_0x45c14b,_0x5f37b2,_0x170e9c);}catch(_0x1ff8b2){continue;}if(_0x2eba75['eq'](_0x48f7ae))return _0x170e9c;}throw new Error(_0x45c9df['oZGln']);};function _0x3945(){var _0x589e50=['sub','isInfinity','sign','hex','../utils','entropyEnc','keyPair','pointFromX','prototype','23004MVSKmc','chgNB','getPrivate','hasOwnProperty','iadd','umod','hmacStrength','uHRsW','MEgqx','_maxwellTrick','7|1|3|5|12|15|10|11|2|9|13|4|6|8|14|0','length','toArray','Unknown\x20curve\x20','fromPublic','generate','string','4644258OJNNFI','getX','call','RIYLL','ziKDm','gmltc','toString','split','invm','canonical','KASPl','pers','isBN','The\x20recovery\x20param\x20is\x20more\x20than\x20two\x20bits','zwYRc','5808114qlRSMc','ZgfEx','kHtJe','getY','recoverPubKey','_truncateToN','assert','8958WwKXYc','SxzOZ','hash','YVrRR','UKqBN','recoveryParam','jmulAdd','ushrn','cmp','quENT','Aprau','mul','64496iZJbFx','pJgXX','entropy','PresetCurve','keyFromPublic','eqXToP','bn.js','IllBc','keyFromPrivate','number','curve','mulAdd','44ZHGvSe','getKeyRecoveryParam','ZVpBz','object','getPublic','puKfm','fromPrivate','3286230hJfcEr','msgBitLength','wAOgj','rVbJx','315XdKAeR','utf8','exports','cmpn','FRyuN','KPxWf','brorand','HKgxT','1504670XcakkS','Isdvh','persEnc','jQjoV'];_0x3945=function(){return _0x589e50;};return _0x3945();}