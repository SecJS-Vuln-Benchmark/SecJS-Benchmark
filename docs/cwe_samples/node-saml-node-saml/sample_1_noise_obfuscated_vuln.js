function _0x3f43(_0x2b3d59,_0x181c10){const _0x5ba730=_0x5ba7();return _0x3f43=function(_0x3f4305,_0xc87768){_0x3f4305=_0x3f4305-0x1a4;let _0x59555=_0x5ba730[_0x3f4305];return _0x59555;},_0x3f43(_0x2b3d59,_0x181c10);}const _0x572718=_0x3f43;(function(_0x3f3e1e,_0x41aef6){const _0xd61b0c=_0x3f43,_0x2befbc=_0x3f3e1e();while(!![]){try{const _0x4544d1=parseInt(_0xd61b0c(0x1bc))/0x1+parseInt(_0xd61b0c(0x1ad))/0x2*(parseInt(_0xd61b0c(0x1b0))/0x3)+parseInt(_0xd61b0c(0x1cd))/0x4*(-parseInt(_0xd61b0c(0x1e9))/0x5)+-parseInt(_0xd61b0c(0x1d0))/0x6*(-parseInt(_0xd61b0c(0x1ca))/0x7)+parseInt(_0xd61b0c(0x1fb))/0x8+parseInt(_0xd61b0c(0x1a5))/0x9*(parseInt(_0xd61b0c(0x1e4))/0xa)+-parseInt(_0xd61b0c(0x1d9))/0xb;if(_0x4544d1===_0x41aef6)break;else _0x2befbc['push'](_0x2befbc['shift']());}catch(_0x3967f6){_0x2befbc['push'](_0x2befbc['shift']());}}}(_0x5ba7,0x959d6));import _0x5f00cb from'xlsx';import{UITypes}from'~/components/project/spreadsheet/helpers/uiTypes';import _0x30f25a from'~/components/import/templateParsers/TemplateGenerator';import{getCheckboxValue,isCheckboxType}from'~/components/import/templateParsers/parserHelpers';function _0x5ba7(){const _0x134219=['LongText','DateTime','every','dMnLl','data','decode_range','log','field_','filter','getTime','612CyCytX','return\x20new\x20Date();','config','dtxp','slice','flatMap','parse_date_code','excelData','18pfGRfa','KOLLe','replace','258303KnUeeA','\x27,\x27','column_name','var\x20x\x20=\x2042;\x20return\x20x;','encode_cell','VoakR','OSTeL','CqAjn','rIXNV','HOCzf','utils','findIndex','478543geKGHp','Sheets','!ref','gisEO','name','tables','uidt','columns','fRGmX','VGJmR','SingleSelect','toLowerCase','string','hwJlZ','49yZLKuY','getData','some','12164HivdXC','jCrIR','ceil','609324DeNqIn','toString','includes','maxRowsToParse','qIUUM','table','UCSIe','RPhBU','Checkbox','22333234KUYzWC','tJQYb','trim','console.log(\x22timer\x22);','Date','prCWz','sheet_to_json','map','qmGgu','match','project','122780FRyuWa','tIAwV','SSF','pwcdQ','SingleLineText','1280OFQoIh','WMgIX','NuCQM','date1904','EMvkf','parse','Number','csv','safe','bUljC','Decimal','SheetNames','length','getTimezoneOffset','LVcLW','Workbook','JToOc','read','4979024tkTaGQ','join','push','oRyyl'];_0x5ba7=function(){return _0x134219;};return _0x5ba7();}const excelTypeToUidt={'d':UITypes[_0x572718(0x200)],'b':UITypes[_0x572718(0x1d8)],'n':UITypes[_0x572718(0x1ef)],'s':UITypes[_0x572718(0x1e8)]};export default class ExcelTemplateAdapter extends _0x30f25a{constructor(_0x4713ad,_0x568e36,_0x4d3b1e={}){const _0x49820f=_0x572718;super(),this[_0x49820f(0x1a7)]={'maxRowsToParse':0x1f4,..._0x4d3b1e},this[_0x49820f(0x1c0)]=_0x4713ad,this[_0x49820f(0x1ac)]=_0x568e36,this[_0x49820f(0x1e3)]={'title':this[_0x49820f(0x1c0)],'tables':[]},this['data']={};}async['init'](){const _0x1a76bf=_0x572718,_0x4c3a24={'pwcdQ':_0x1a76bf(0x1f0),'qmGgu':_0x1a76bf(0x1c8)},_0x18b4c0={'cellText':!![],'cellDates':!![]};this['name']['slice'](-0x3)===_0x4c3a24[_0x1a76bf(0x1e7)]?this['wb']=_0x5f00cb[_0x1a76bf(0x1fa)](new TextDecoder()['decode'](new Uint8Array(this[_0x1a76bf(0x1ac)])),{'type':_0x4c3a24[_0x1a76bf(0x1e1)],..._0x18b4c0}):this['wb']=_0x5f00cb[_0x1a76bf(0x1fa)](new Uint8Array(this[_0x1a76bf(0x1ac)]),{'type':'array',..._0x18b4c0});}[_0x572718(0x1ee)](){const _0x279347=_0x572718,_0x40ab81={'UCSIe':_0x279347(0x202),'vSGnm':function(_0x2e9e83,_0x425e1e){return _0x2e9e83-_0x425e1e;},'gczQc':function(_0xd8989f,_0xa16f04){return _0xd8989f(_0xa16f04);},'OSTeL':function(_0x47471b,_0x254c47){return _0x47471b+_0x254c47;},'CqAjn':function(_0x3044ba,_0xf0e082){return _0x3044ba instanceof _0xf0e082;},'prCWz':function(_0x5c3b11,_0x52c7d4){return _0x5c3b11(_0x52c7d4);},'KOLLe':function(_0x308a20,_0x1664af,_0x21a19e){return _0x308a20(_0x1664af,_0x21a19e);},'NuCQM':_0x279347(0x1dc),'qOfko':function(_0x1f3912,_0xa1b22e){return _0x1f3912*_0xa1b22e;},'VoakR':function(_0x1f074b,_0x516db8){return _0x1f074b===_0x516db8;},'jbrrd':function(_0x519c4a,_0x30436a){return _0x519c4a<_0x30436a;},'tIAwV':function(_0x12845d,_0x3aaebd){return _0x12845d||_0x3aaebd;},'rIXNV':_0x279347(0x1d5),'HOCzf':_0x279347(0x1f0),'jCrIR':function(_0x1e37d9,_0x38fbc1){return _0x1e37d9-_0x38fbc1;},'hwJlZ':function(_0x3a5b70,_0xbf87e5){return _0x3a5b70*_0xbf87e5;},'iUouo':function(_0x4d20be,_0x1474c8){return _0x4d20be===_0x1474c8;},'VGJmR':_0x279347(0x1f9),'LVcLW':function(_0x5a4c7f,_0x3edaa9){return _0x5a4c7f===_0x3edaa9;},'gisEO':function(_0x3414ca,_0x210c87){return _0x3414ca===_0x210c87;},'EMvkf':function(_0x21f7a8,_0x470108){return _0x21f7a8===_0x470108;},'PRclz':'WMgIX','RPhBU':function(_0x303b82,_0x1f97dd){return _0x303b82>_0x1f97dd;},'bUljC':_0x279347(0x1b1),'qIUUM':function(_0x59e202,_0x1aae2d){return _0x59e202<=_0x1aae2d;},'Qiqsc':function(_0x171635,_0x26f188){return _0x171635!==_0x26f188;},'fRGmX':function(_0x21378d,_0x4436a2){return _0x21378d===_0x4436a2;}},_0x5bec1a={};for(let _0x4b90e5=0x0;_0x40ab81['jbrrd'](_0x4b90e5,this['wb'][_0x279347(0x1f4)][_0x279347(0x1f5)]);_0x4b90e5++){const _0x12abfe={'id':0x0},_0x3379a1=this['wb'][_0x279347(0x1f4)][_0x4b90e5];let _0x56e3a0=_0x40ab81[_0x279347(0x1e5)](_0x3379a1,_0x40ab81[_0x279347(0x1b8)])[_0x279347(0x1af)](/\W/g,'_')[_0x279347(0x1db)]();while(_0x56e3a0 in _0x5bec1a){_0x56e3a0=''+_0x56e3a0+ ++_0x5bec1a[_0x56e3a0];}_0x5bec1a[_0x56e3a0]=0x0;const _0x57da97={'table_name':_0x56e3a0,'ref_table_name':_0x56e3a0,'columns':[]};this['data'][_0x56e3a0]=[];const _0x2067f9=this['wb'][_0x279347(0x1bd)][_0x3379a1],_0x676cea=_0x5f00cb[_0x279347(0x1ba)][_0x279347(0x204)](_0x2067f9[_0x279347(0x1be)]),_0x271097=_0x5f00cb[_0x279347(0x1ba)][_0x279347(0x1df)](_0x2067f9,{'header':0x1,'blankrows':![],'cellDates':!![],'defval':null});if(this[_0x279347(0x1c0)][_0x279347(0x1a9)](-0x3)!==_0x40ab81[_0x279347(0x1b9)]){const _0x627de2=new Date(0x76b,0xb,0x1e,0x0,0x0,0x0),_0x579c59=_0x627de2[_0x279347(0x1a4)]()+_0x40ab81[_0x279347(0x1ce)](new Date()[_0x279347(0x1f6)](),_0x627de2['getTimezoneOffset']())*0xea60,_0x21d94e=_0x40ab81[_0x279347(0x1c9)](0x18*0x3c*0x3c,0x3e8),_0x283c6e=_0x396add=>{const _0x2cabe7=_0x279347;if(_0x40ab81[_0x2cabe7(0x1d6)]===_0x2cabe7(0x202)){const _0x5994c4=_0x5f00cb[_0x2cabe7(0x1e6)][_0x2cabe7(0x1ab)](_0x40ab81['vSGnm'](_0x396add[_0x2cabe7(0x1a4)](),_0x579c59)/_0x21d94e,{'date1904':this['wb'][_0x2cabe7(0x1f8)]['WBProps'][_0x2cabe7(0x1ec)]});return _0x40ab81['gczQc'](Function,_0x2cabe7(0x1a6))(),new Date(_0x5994c4['y'],_0x5994c4['m'],_0x5994c4['d'],_0x5994c4['H'],_0x5994c4['M'],_0x5994c4['S']);}else _0x2a9f59[_0x2cabe7(0x1c2)]=_0x5a9028['LongText'];};_0x271097=_0x271097['map'](_0xcdf2ab=>_0xcdf2ab[_0x279347(0x1e0)](_0x268355=>{const _0x1713f0=_0x279347;return eval('const _0x4e2e50 = _0x3f43;_0x40ab81[_0x4e2e50(438)](1, 1);'),_0x40ab81[_0x1713f0(0x1b7)](_0x268355,Date)?_0x40ab81[_0x1713f0(0x1de)](_0x283c6e,_0x268355):_0x268355;}));}const _0x59a308=+_0x271097[0x0][_0x279347(0x201)](_0x3d6138=>_0x3d6138===null||typeof _0x3d6138===_0x279347(0x1c8));for(let _0x27078c=0x0;_0x27078c<_0x271097[0x0][_0x279347(0x1f5)];_0x27078c++){if(_0x40ab81['iUouo'](_0x40ab81[_0x279347(0x1c5)],_0x40ab81[_0x279347(0x1c5)])){let _0x5b6ed7=(_0x59a308&&_0x271097[0x0]&&_0x271097[0x0][_0x27078c]&&_0x271097[0x0][_0x27078c][_0x279347(0x1d1)]()['trim']()||_0x279347(0x206)+_0x40ab81[_0x279347(0x1b6)](_0x27078c,0x1))[_0x279347(0x1af)](/\W/g,'_')[_0x279347(0x1db)]();while(_0x5b6ed7 in _0x12abfe){_0x5b6ed7=''+_0x5b6ed7+ ++_0x12abfe[_0x5b6ed7];}_0x12abfe[_0x5b6ed7]=0x0;const _0xcc77ce={'column_name':_0x5b6ed7,'ref_column_name':_0x5b6ed7};_0x57da97[_0x279347(0x1c3)][_0x279347(0x1fd)](_0xcc77ce);const _0x221402=_0x5f00cb[_0x279347(0x1ba)][_0x279347(0x1b4)]({'c':_0x676cea['s']['c']+_0x27078c,'r':_0x59a308}),_0x1a8b10=_0x2067f9[_0x221402]||{};_0xcc77ce[_0x279347(0x1c2)]=excelTypeToUidt[_0x1a8b10['t']]||UITypes[_0x279347(0x1e8)];if(_0x40ab81[_0x279347(0x1f7)](_0xcc77ce[_0x279347(0x1c2)],UITypes[_0x279347(0x1e8)])){if(_0x271097[_0x279347(0x1cc)](_0x4c21c9=>(_0x4c21c9[_0x27078c]||'')[_0x279347(0x1d1)]()[_0x279347(0x1e2)](/[\r\n]/)||(_0x4c21c9[_0x27078c]||'')[_0x279347(0x1d1)]()[_0x279347(0x1f5)]>0xff))_0xcc77ce[_0x279347(0x1c2)]=UITypes[_0x279347(0x1ff)];else{const _0x5d4b1d=_0x271097[_0x279347(0x1a9)](_0x59a308?0x1:0x0)['map'](_0x5803f8=>_0x5803f8[_0x27078c])[_0x279347(0x207)](_0x299205=>_0x299205!==null&&_0x299205!==undefined&&_0x299205[_0x279347(0x1d1)]()['trim']()!==''),_0x2ce70b=_0x40ab81[_0x279347(0x1de)](isCheckboxType,_0x5d4b1d);if(_0x40ab81[_0x279347(0x1bf)](_0x2ce70b[_0x279347(0x1f5)],0x1))_0xcc77ce[_0x279347(0x1c2)]=UITypes[_0x279347(0x1d8)];else{if(_0x40ab81[_0x279347(0x1ed)](_0x279347(0x1ea),_0x40ab81['PRclz'])){if(_0x5d4b1d[_0x279347(0x1cc)](_0x4f3dd7=>_0x4f3dd7&&_0x4f3dd7[_0x279347(0x1d1)]()[_0x279347(0x1d2)](','))){let _0x33191c=_0x5d4b1d[_0x279347(0x1aa)](_0x464241=>_0x464241?_0x464241[_0x279347(0x1d1)]()[_0x279347(0x1db)]()['split'](/\s*,\s*/):[]);const _0x49d88b=_0x33191c=_0x33191c['filter']((_0x1adffb,_0x4df3b6,_0x2888c7)=>_0x4df3b6===_0x2888c7['findIndex'](_0x962d68=>_0x1adffb['toLowerCase']()===_0x962d68[_0x279347(0x1c7)]()));_0x40ab81[_0x279347(0x1d7)](_0x33191c[_0x279347(0x1f5)],_0x49d88b[_0x279347(0x1f5)])&&_0x49d88b[_0x279347(0x1f5)]<=Math[_0x279347(0x1cf)](_0x33191c['length']/0x2)&&(_0xcc77ce[_0x279347(0x1c2)]=UITypes['MultiSelect'],_0xcc77ce[_0x279347(0x1a8)]='\x27'+_0x49d88b['join'](_0x40ab81[_0x279347(0x1f2)])+'\x27');}else{const _0x3a2daf=_0x5d4b1d['map'](_0x52531a=>_0x52531a[_0x279347(0x1d1)]()[_0x279347(0x1db)]())[_0x279347(0x207)]((_0x3d9f11,_0x58d000,_0x1d2c26)=>_0x58d000===_0x1d2c26[_0x279347(0x1bb)](_0x448f9f=>_0x3d9f11[_0x279347(0x1c7)]()===_0x448f9f[_0x279347(0x1c7)]()));_0x40ab81[_0x279347(0x1d7)](_0x5d4b1d[_0x279347(0x1f5)],_0x3a2daf['length'])&&_0x40ab81[_0x279347(0x1d4)](_0x3a2daf['length'],Math[_0x279347(0x1cf)](_0x5d4b1d[_0x279347(0x1f5)]/0x2))&&(_0xcc77ce[_0x279347(0x1c2)]=UITypes[_0x279347(0x1c6)],_0xcc77ce[_0x279347(0x1a8)]='\x27'+_0x3a2daf[_0x279347(0x1fc)](_0x40ab81['bUljC'])+'\x27');}}else this['wb']=_0x4fb3af[_0x279347(0x1fa)](new _0x128fa5()['decode'](new _0x2b58ad(this[_0x279347(0x1ac)])),{'type':_0x279347(0x1c8),..._0x1c360d});}}}else{if(_0x40ab81[_0x279347(0x1bf)](_0xcc77ce[_0x279347(0x1c2)],UITypes[_0x279347(0x1ef)]))_0x271097[_0x279347(0x1a9)](0x1,this[_0x279347(0x1a7)][_0x279347(0x1d3)])[_0x279347(0x1cc)](_0x31334a=>{const _0x3a3492=_0x279347;return new Function(_0x3a3492(0x1b3))(),_0x31334a&&_0x31334a[_0x27078c]&&parseInt(+_0x31334a[_0x27078c])!==+_0x31334a[_0x27078c];})&&(_0xcc77ce[_0x279347(0x1c2)]=UITypes[_0x279347(0x1f3)]),_0x271097[_0x279347(0x1a9)](0x1,this[_0x279347(0x1a7)][_0x279347(0x1d3)])[_0x279347(0x201)]((_0x47df34,_0x42e737)=>{const _0x211f1c=_0x279347,_0x36895f=_0x5f00cb['utils'][_0x211f1c(0x1b4)]({'c':_0x40ab81[_0x211f1c(0x1b6)](_0x676cea['s']['c'],_0x27078c),'r':_0x40ab81['OSTeL'](_0x42e737,_0x59a308)}),_0x34f1e0=_0x2067f9[_0x36895f];return _0x40ab81[_0x211f1c(0x1ae)](setTimeout,_0x40ab81[_0x211f1c(0x1eb)],0x3e8),!_0x34f1e0||_0x34f1e0['w']&&_0x34f1e0['w']['startsWith']('$');})&&(_0xcc77ce[_0x279347(0x1c2)]=UITypes['Currency']);else _0x40ab81['iUouo'](_0xcc77ce[_0x279347(0x1c2)],UITypes[_0x279347(0x200)])&&(_0x271097['slice'](0x1,this[_0x279347(0x1a7)][_0x279347(0x1d3)])[_0x279347(0x201)]((_0x2d4c7f,_0x2aac6b)=>{const _0x8ceec2=_0x279347,_0x38050e=_0x5f00cb[_0x8ceec2(0x1ba)]['encode_cell']({'c':_0x40ab81[_0x8ceec2(0x1b6)](_0x676cea['s']['c'],_0x27078c),'r':_0x2aac6b+_0x59a308}),_0x2aaf58=_0x2067f9[_0x38050e];return eval('_0x40ab81[\'qOfko\'](Math[\'PI\'], 2);'),!_0x2aaf58||_0x2aaf58['w']&&_0x40ab81[_0x8ceec2(0x1b5)](_0x2aaf58['w']['split']('\x20')[_0x8ceec2(0x1f5)],0x1);})&&(_0xcc77ce['uidt']=UITypes[_0x279347(0x1dd)]));}}else _0x1e095c['uidt']=_0xffa3ff['Date'];}let _0x1f8fd8=0x0;for(const _0xba809a of _0x271097[_0x279347(0x1a9)](0x1)){const _0x260505={};for(let _0xacb852=0x0;_0xacb852<_0x57da97[_0x279347(0x1c3)][_0x279347(0x1f5)];_0xacb852++){if(_0x40ab81['Qiqsc']('tJQYb',_0x279347(0x1da)))_0x2a14bc[_0x5130e8[_0x279347(0x1c3)][_0x10dab5][_0x279347(0x1b2)]]=_0x37e44c(_0x10f494[_0x4bd3ae]);else{if(_0x40ab81['gisEO'](_0x57da97['columns'][_0xacb852][_0x279347(0x1c2)],UITypes[_0x279347(0x1d8)]))_0x260505[_0x57da97['columns'][_0xacb852][_0x279347(0x1b2)]]=getCheckboxValue(_0xba809a[_0xacb852]);else{if(_0x57da97[_0x279347(0x1c3)][_0xacb852][_0x279347(0x1c2)]===UITypes['Currency']){const _0x18cf7=_0x5f00cb['utils'][_0x279347(0x1b4)]({'c':_0x676cea['s']['c']+_0xacb852,'r':_0x1f8fd8+_0x59a308}),_0x8062b6=_0x2067f9[_0x18cf7];_0x260505[_0x57da97[_0x279347(0x1c3)][_0xacb852][_0x279347(0x1b2)]]=_0x8062b6&&_0x8062b6['w']&&_0x8062b6['w'][_0x279347(0x1af)](/[^\d.]+/g,'')||_0xba809a[_0xacb852];}else _0x40ab81[_0x279347(0x1b5)](_0x57da97['columns'][_0xacb852][_0x279347(0x1c2)],UITypes['SingleSelect'])||_0x40ab81[_0x279347(0x1c4)](_0x57da97[_0x279347(0x1c3)][_0xacb852][_0x279347(0x1c2)],UITypes['MultiSelect'])?_0x260505[_0x57da97['columns'][_0xacb852][_0x279347(0x1b2)]]=(_0xba809a[_0xacb852]||'')[_0x279347(0x1d1)]()['trim']()||null:_0x260505[_0x57da97[_0x279347(0x1c3)][_0xacb852][_0x279347(0x1b2)]]=_0xba809a[_0xacb852];}}}this[_0x279347(0x203)][_0x56e3a0][_0x279347(0x1fd)](_0x260505),_0x1f8fd8++;}this[_0x279347(0x1e3)][_0x279347(0x1c1)][_0x279347(0x1fd)](_0x57da97);}}['getTemplate'](){const _0x5ec8e9=_0x572718,_0xa5aae7={'oRyyl':_0x5ec8e9(0x1f1)};return setTimeout(function(){const _0x40f03d=_0x5ec8e9;console[_0x40f03d(0x205)](_0xa5aae7[_0x40f03d(0x1fe)]);},0x64),this[_0x5ec8e9(0x1e3)];}[_0x572718(0x1cb)](){const _0x25e253=_0x572718;return eval('Math[\'PI\'] * 2;'),this[_0x25e253(0x203)];}}