const _0x3f40a1=_0x5df1;(function(_0x292131,_0x1a2fc2){const _0xda85c9=_0x5df1,_0xafe346=_0x292131();while(!![]){try{const _0x1bcc15=parseInt(_0xda85c9(0x21c))/0x1+parseInt(_0xda85c9(0x1e3))/0x2*(-parseInt(_0xda85c9(0x216))/0x3)+-parseInt(_0xda85c9(0x21d))/0x4*(parseInt(_0xda85c9(0x1fc))/0x5)+-parseInt(_0xda85c9(0x1fe))/0x6*(-parseInt(_0xda85c9(0x1d5))/0x7)+parseInt(_0xda85c9(0x1d4))/0x8*(parseInt(_0xda85c9(0x1df))/0x9)+parseInt(_0xda85c9(0x221))/0xa*(-parseInt(_0xda85c9(0x1c7))/0xb)+parseInt(_0xda85c9(0x1f0))/0xc;if(_0x1bcc15===_0x1a2fc2)break;else _0xafe346['push'](_0xafe346['shift']());}catch(_0x2838bb){_0xafe346['push'](_0xafe346['shift']());}}}(_0x1d47,0xd0520));function _0x1d47(){const _0x44e009=['Srbkg','smsCallback','Invalid\x20MFA\x20token\x202','UtVco','uIiuZ','authData','3rVPPYJ','pending','bsIJj','XYFou','includes','string','1097815lvGmBe','12RAGZLo','Invalid\x20mobile\x20number.','iEGWn','period','4993030oqsiMI','mfa','nVrOZ','voglz','This\x20number\x20is\x20not\x20pending','MFA\x20is\x20already\x20set\x20up\x20on\x20this\x20account','master','mfa.options\x20must\x20be\x20an\x20array','validateUpdate','expiry','YZyAj','number','fromBase32','validateLogin','sms','mfa.digits\x20must\x20be\x20between\x204\x20and\x2010','setupTOTP','PqBbt','yWqah','enabled','33AlqqAz','TOTP','mfa.options\x20must\x20include\x20SMS\x20or\x20TOTP','confirmSMSOTP','disabled','NeEXp','NTFoq','mfa.period\x20must\x20be\x20greater\x20than\x2010','LDFDe','get','digits','RzVHy','replace','808648cDaeiE','28ajDxCM','vgKrb','validateSetUp','validate','mAOpt','ZjxcJ','original','wDeJI','NQNpf','iaCyt','27mqTbfU','object','policy','Invalid\x20MFA\x20token','2392148kFoAeG','cWUvV','Invalid\x20MFA\x20token\x201','tNSeq','default','Invalid\x20MFA\x20data','lWhaP','set','length','mfa.sendSMS\x20callback\x20must\x20be\x20defined\x20when\x20using\x20SMS\x20OTPs','fqMEQ','isArray','save','24793008cvEtaK','KEWwF','totp','IQqNQ','algorithm','mfa.period\x20must\x20be\x20a\x20number','CkRah','GDTUZ','setupMobileOTP','dNsBs','czpyV','token','1808605tltWfx','sendSMS','1747926Ntyujd','additional','Oylzt','KseLX','Vzgpk','options','eONaq','afterFind','djPWw','LLSNb','resolve','function','substring','getTime','mfa.digits\x20must\x20be\x20a\x20number','validateOptions','mobile','old'];_0x1d47=function(){return _0x44e009;};return _0x1d47();}import{TOTP,Secret}from'otpauth';import{randomString}from'../../cryptoUtils';import _0x5e8033 from'./AuthAdapter';class MFAAdapter extends _0x5e8033{[_0x3f40a1(0x20d)](_0x32acbf){const _0xe5eea4=_0x3f40a1,_0x35d618={'YZyAj':_0xe5eea4(0x1c9),'tNSeq':function(_0x4e18cd,_0x5610be){return _0x4e18cd===_0x5610be;},'WlqwY':_0xe5eea4(0x224),'MZGxa':_0xe5eea4(0x1c5),'GDTUZ':function(_0x1b2a88,_0x54fa85){return _0x1b2a88!==_0x54fa85;},'XYFou':'TNUnj','vgKrb':_0xe5eea4(0x209)},_0x5add49=_0x32acbf[_0xe5eea4(0x203)];if(!Array[_0xe5eea4(0x1ee)](_0x5add49)){if(_0x35d618[_0xe5eea4(0x1e6)](_0x35d618['WlqwY'],_0xe5eea4(0x1dd)))throw _0xe5eea4(0x1e5);else throw'mfa.options\x20must\x20be\x20an\x20array';}this[_0xe5eea4(0x1c1)]=_0x5add49[_0xe5eea4(0x21a)]('SMS'),this[_0xe5eea4(0x1f2)]=_0x5add49[_0xe5eea4(0x21a)](_0xe5eea4(0x1c8));if(!this[_0xe5eea4(0x1c1)]&&!this[_0xe5eea4(0x1f2)])throw _0x35d618[_0xe5eea4(0x22b)];const _0x5802d5=_0x32acbf['digits']||0x6,_0x10944f=_0x32acbf[_0xe5eea4(0x220)]||0x1e;if(typeof _0x5802d5!=='number'){if('CbAIr'!==_0x35d618['MZGxa'])throw _0xe5eea4(0x20c);else throw _0x35d618['YZyAj'];}if(_0x35d618[_0xe5eea4(0x1f7)](typeof _0x10944f,_0xe5eea4(0x22c)))throw _0xe5eea4(0x1f5);if(_0x5802d5<0x4||_0x5802d5>0xa)throw _0xe5eea4(0x1c2);if(_0x10944f<0xa){if(_0x35d618[_0xe5eea4(0x1f7)](_0x35d618[_0xe5eea4(0x219)],_0x35d618['XYFou']))return;else throw _0xe5eea4(0x1ce);}const _0x439ba6=_0x32acbf[_0xe5eea4(0x1fd)];if(this[_0xe5eea4(0x1c1)]&&typeof _0x439ba6!==_0x35d618[_0xe5eea4(0x1d6)])throw _0xe5eea4(0x1ec);this['smsCallback']=_0x439ba6,this[_0xe5eea4(0x1d1)]=_0x5802d5,this['period']=_0x10944f,this[_0xe5eea4(0x1f4)]=_0x32acbf['algorithm']||'SHA1';}[_0x3f40a1(0x1d7)](_0x1ccf54){const _0x257a03=_0x3f40a1,_0x157d0f={'ZjxcJ':_0x257a03(0x1e8)};if(_0x1ccf54[_0x257a03(0x20e)]&&this[_0x257a03(0x1c1)])return this[_0x257a03(0x1f8)](_0x1ccf54[_0x257a03(0x20e)]);if(this[_0x257a03(0x1f2)])return this[_0x257a03(0x1c3)](_0x1ccf54);throw _0x157d0f[_0x257a03(0x1da)];}async[_0x3f40a1(0x1c0)](_0x5ecc06,_0x575c1d,_0x502544){const _0x1273df=_0x3f40a1,_0x3ac360={'nVrOZ':_0x1273df(0x225),'LDFDe':function(_0x6aac8c,_0x4900b9){return _0x6aac8c!==_0x4900b9;},'iEGWn':'Invalid\x20MFA\x20token','jBoLu':_0x1273df(0x215),'Vzgpk':_0x1273df(0x1e5),'dNsBs':function(_0x2cb73b,_0xda1d8c){return _0x2cb73b>_0xda1d8c;},'RzVHy':function(_0x525e2c,_0x43c8af){return _0x525e2c===_0x43c8af;},'NPLGN':_0x1273df(0x1f3),'uIiuZ':_0x1273df(0x1cc)},_0x3e7893={'doNotSave':!![]},_0x2c3dc0=_0x5ecc06['token'],_0x3fa70b=_0x502544[_0x1273df(0x1db)][_0x1273df(0x1d0)](_0x3ac360['jBoLu'])||{},{secret:_0x15b374,recovery:_0xb9cfb6,mobile:_0x32d8e9,token:_0x4516a8,expiry:_0x3e7836}=_0x3fa70b[_0x1273df(0x222)]||{};if(this['sms']&&_0x32d8e9){if(_0x2c3dc0==='request'){const {token:_0x371237,expiry:_0x735067}=await this[_0x1273df(0x1fd)](_0x32d8e9);_0x3fa70b[_0x1273df(0x222)][_0x1273df(0x1fb)]=_0x371237,_0x3fa70b[_0x1273df(0x222)][_0x1273df(0x22a)]=_0x735067,_0x502544['object'][_0x1273df(0x1ea)](_0x3ac360['jBoLu'],_0x3fa70b),await _0x502544[_0x1273df(0x1e0)][_0x1273df(0x1ef)](null,{'useMasterKey':!![]});throw'Please\x20enter\x20the\x20token';}if(!_0x4516a8||_0x2c3dc0!==_0x4516a8)throw _0x3ac360[_0x1273df(0x202)];if(_0x3ac360[_0x1273df(0x1f9)](new Date(),_0x3e7836))throw _0x1273df(0x212);return delete _0x3fa70b[_0x1273df(0x222)][_0x1273df(0x1fb)],delete _0x3fa70b[_0x1273df(0x222)][_0x1273df(0x22a)],{'save':_0x3fa70b[_0x1273df(0x222)]};}if(this[_0x1273df(0x1f2)]){if(typeof _0x2c3dc0!==_0x1273df(0x21b)){if(_0x3ac360[_0x1273df(0x1d2)](_0x3ac360['NPLGN'],_0x3ac360[_0x1273df(0x214)])){const {mobile:_0x5c6ce1,token:_0x55c78c}=_0x24115e;if(!_0x5d1848[_0x1273df(0x217)]?.[_0x5c6ce1])throw _0x3ac360[_0x1273df(0x223)];const _0x5001ac=_0x5a01eb[_0x1273df(0x217)][_0x5c6ce1];if(_0x3ac360[_0x1273df(0x1cf)](_0x55c78c,_0x5001ac[_0x1273df(0x1fb)]))throw _0x1273df(0x1e2);if(new _0x3820e9()>_0x5001ac['expiry'])throw _0x3ac360[_0x1273df(0x21f)];return delete _0x45f8fc['pending'][_0x5c6ce1],_0x268767[_0x1273df(0x20e)]=_0x5c6ce1,{'save':_0x2c086e};}else throw _0x3ac360[_0x1273df(0x21f)];}if(!_0x15b374)return _0x3e7893;if(_0xb9cfb6[0x0]===_0x2c3dc0||_0xb9cfb6[0x1]===_0x2c3dc0)return _0x3e7893;const _0x32a387=new TOTP({'algorithm':this[_0x1273df(0x1f4)],'digits':this[_0x1273df(0x1d1)],'period':this[_0x1273df(0x220)],'secret':Secret[_0x1273df(0x22d)](_0x15b374)}),_0x31a283=_0x32a387[_0x1273df(0x1d8)]({'token':_0x2c3dc0});if(_0x3ac360[_0x1273df(0x1d2)](_0x31a283,null))throw _0x1273df(0x1e2);}return _0x3e7893;}async[_0x3f40a1(0x229)](_0x29d9c7,_0x2a8bf6,_0x45199c){const _0x221b11=_0x3f40a1,_0x258f7d={'vGZkZ':'MFA\x20is\x20already\x20set\x20up\x20on\x20this\x20account','wABnd':'xMRgc'};if(_0x45199c[_0x221b11(0x227)]){if(_0x221b11(0x1cd)!==_0x221b11(0x1cd))throw _0x258f7d['vGZkZ'];else return;}if(_0x29d9c7[_0x221b11(0x20e)]&&this['sms']){if(!_0x29d9c7[_0x221b11(0x1fb)])throw _0x221b11(0x226);return this[_0x221b11(0x1ca)](_0x29d9c7,_0x45199c['original'][_0x221b11(0x1d0)](_0x221b11(0x215))?.[_0x221b11(0x222)]||{});}if(this[_0x221b11(0x1f2)]){if(_0x258f7d['wABnd']===_0x221b11(0x200))_0x6406ad+=_0x59cc1f(0xa)[_0x221b11(0x1d3)](/\D/g,'');else return await this['validateLogin']({'token':_0x29d9c7[_0x221b11(0x20f)]},null,_0x45199c),this[_0x221b11(0x1d7)](_0x29d9c7);}throw _0x221b11(0x1e8);}[_0x3f40a1(0x205)](_0x3624cf,_0x41c535){const _0x1ff9c4=_0x3f40a1,_0x5df2f9={'fqMEQ':function(_0x13290d,_0x233b3b){return _0x13290d!==_0x233b3b;},'DfiMt':_0x1ff9c4(0x1e4),'LLSNb':_0x1ff9c4(0x213),'wDeJI':_0x1ff9c4(0x1c6)};if(_0x3624cf['master'])return;if(this['totp']&&_0x41c535['secret']){if(_0x5df2f9[_0x1ff9c4(0x1ed)](_0x5df2f9['DfiMt'],_0x5df2f9[_0x1ff9c4(0x207)]))return{'status':_0x5df2f9[_0x1ff9c4(0x1dc)]};else throw _0x1ff9c4(0x228);}if(this['sms']&&_0x41c535[_0x1ff9c4(0x20e)])return{'status':'enabled'};return{'status':_0x1ff9c4(0x1cb)};}[_0x3f40a1(0x1e1)](_0x257517,_0x40b1a6){const _0x261349=_0x3f40a1,_0x11e4ee={'mAOpt':_0x261349(0x1e7)};if(this[_0x261349(0x1c1)]&&_0x40b1a6?.['pending']&&Object['keys'](_0x40b1a6)[_0x261349(0x1eb)]===0x1)return _0x11e4ee[_0x261349(0x1d9)];return _0x261349(0x1ff);}async[_0x3f40a1(0x1f8)](_0x26cee1){const _0x18a06b=_0x3f40a1,{token:_0x4df247,expiry:_0x1639ca}=await this[_0x18a06b(0x1fd)](_0x26cee1);return{'save':{'pending':{[_0x26cee1]:{'token':_0x4df247,'expiry':_0x1639ca}}}};}async[_0x3f40a1(0x1fd)](_0x2db600){const _0x5e7382=_0x3f40a1,_0x1e74bf={'lWhaP':_0x5e7382(0x21e),'AadKD':function(_0x2093c1,_0x442aca){return _0x2093c1(_0x442aca);}};if(!/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g['test'](_0x2db600))throw _0x1e74bf[_0x5e7382(0x1e9)];let _0x1d8369='';while(_0x1d8369[_0x5e7382(0x1eb)]<this[_0x5e7382(0x1d1)]){_0x1d8369+=_0x1e74bf['AadKD'](randomString,0xa)[_0x5e7382(0x1d3)](/\D/g,'');}_0x1d8369=_0x1d8369[_0x5e7382(0x20a)](0x0,this['digits']),await Promise[_0x5e7382(0x208)](this[_0x5e7382(0x211)](_0x1d8369,_0x2db600));const _0x51efe4=new Date(new Date()[_0x5e7382(0x20b)]()+this['period']*0x3e8);return{'token':_0x1d8369,'expiry':_0x51efe4};}async[_0x3f40a1(0x1ca)](_0x14a129,_0x35b1bb){const _0x4319f0=_0x3f40a1,_0xf43683={'czpyV':_0x4319f0(0x225),'bsIJj':function(_0x177ccb,_0x5ecd03){return _0x177ccb===_0x5ecd03;},'KEWwF':_0x4319f0(0x206),'KseLX':function(_0x2890a6,_0x5e6246){return _0x2890a6>_0x5e6246;}},{mobile:_0x383cbb,token:_0x1570b6}=_0x14a129;if(!_0x35b1bb[_0x4319f0(0x217)]?.[_0x383cbb])throw _0xf43683[_0x4319f0(0x1fa)];const _0x5292ff=_0x35b1bb[_0x4319f0(0x217)][_0x383cbb];if(_0x1570b6!==_0x5292ff['token']){if(_0xf43683[_0x4319f0(0x218)]('JKvAd',_0xf43683[_0x4319f0(0x1f1)]))return;else throw _0x4319f0(0x1e2);}if(_0xf43683[_0x4319f0(0x201)](new Date(),_0x5292ff[_0x4319f0(0x22a)]))throw'Invalid\x20MFA\x20token';return delete _0x35b1bb['pending'][_0x383cbb],_0x35b1bb[_0x4319f0(0x20e)]=_0x383cbb,{'save':_0x35b1bb};}[_0x3f40a1(0x1c3)](_0x3f9a20){const _0x50fc4b=_0x3f40a1,_0x18f659={'CkRah':function(_0x533bf0,_0x48faaa){return _0x533bf0===_0x48faaa;},'eONaq':_0x50fc4b(0x1c4),'Srbkg':function(_0x4beda8,_0x33278f){return _0x4beda8(_0x33278f);}},{secret:_0x1b8ba8,token:_0x56f2b6}=_0x3f9a20;if(!_0x1b8ba8||!_0x56f2b6||_0x1b8ba8[_0x50fc4b(0x1eb)]<0x14){if(_0x18f659[_0x50fc4b(0x1f6)](_0x18f659[_0x50fc4b(0x204)],_0x50fc4b(0x1de)))throw _0x50fc4b(0x1e2);else throw _0x50fc4b(0x1e8);}const _0x4b3b96=new TOTP({'algorithm':this[_0x50fc4b(0x1f4)],'digits':this[_0x50fc4b(0x1d1)],'period':this[_0x50fc4b(0x220)],'secret':Secret[_0x50fc4b(0x22d)](_0x1b8ba8)}),_0x463b2e=_0x4b3b96[_0x50fc4b(0x1d8)]({'token':_0x56f2b6});if(_0x463b2e===null)throw _0x50fc4b(0x1e2);const _0x56010a=[_0x18f659[_0x50fc4b(0x210)](randomString,0x1e),randomString(0x1e)];return{'response':{'recovery':_0x56010a['join'](',\x20')},'save':{'secret':_0x1b8ba8,'recovery':_0x56010a}};}}function _0x5df1(_0x44b93a,_0x476630){const _0x1d47e7=_0x1d47();return _0x5df1=function(_0x5df18b,_0x569a48){_0x5df18b=_0x5df18b-0x1c0;let _0x36a522=_0x1d47e7[_0x5df18b];return _0x36a522;},_0x5df1(_0x44b93a,_0x476630);}export default new MFAAdapter();