const _0x230c10=_0xd183;(function(_0x5ec8e3,_0x12409d){const _0x522566=_0xd183,_0x114b9d=_0x5ec8e3();while(!![]){try{const _0x112d01=parseInt(_0x522566(0x133))/0x1*(-parseInt(_0x522566(0x168))/0x2)+parseInt(_0x522566(0x128))/0x3*(-parseInt(_0x522566(0x115))/0x4)+parseInt(_0x522566(0x18a))/0x5*(parseInt(_0x522566(0x171))/0x6)+parseInt(_0x522566(0x167))/0x7*(-parseInt(_0x522566(0x14e))/0x8)+-parseInt(_0x522566(0x157))/0x9*(-parseInt(_0x522566(0x12e))/0xa)+parseInt(_0x522566(0x165))/0xb+parseInt(_0x522566(0x14b))/0xc;if(_0x112d01===_0x12409d)break;else _0x114b9d['push'](_0x114b9d['shift']());}catch(_0x450810){_0x114b9d['push'](_0x114b9d['shift']());}}}(_0x223b,0xe67df));function _0xd183(_0x10ca8e,_0x15b7c4){const _0x223b39=_0x223b();return _0xd183=function(_0xd1834,_0x2eb802){_0xd1834=_0xd1834-0x10b;let _0x388d0f=_0x223b39[_0xd1834];return _0x388d0f;},_0xd183(_0x10ca8e,_0x15b7c4);}const GameCenterAuth=require(_0x230c10(0x169))[_0x230c10(0x10b)],{pki}=require(_0x230c10(0x15b)),fs=require('fs'),path=require(_0x230c10(0x141));describe(_0x230c10(0x114),function(){const _0x5f1251=_0x230c10,_0x3eb244={'JkGCi':_0x5f1251(0x177),'OkQGp':function(_0x5df7ff,_0x5c1669){return _0x5df7ff(_0x5c1669);},'cXGto':_0x5f1251(0x122),'tbacb':'GET','IbAkf':_0x5f1251(0x13a),'obmnq':'content-length','fILPa':_0x5f1251(0x147),'NunFE':_0x5f1251(0x175),'JznuT':function(_0x8410d1,_0x1d7b02,_0x3806ab){return _0x8410d1(_0x1d7b02,_0x3806ab);},'zIyiI':_0x5f1251(0x15f),'vIsYT':function(_0x28724b,_0x3ccee9,_0x121795){return _0x28724b(_0x3ccee9,_0x121795);},'MRhVe':_0x5f1251(0x17d),'FQFiR':function(_0x2faa6f,_0xac0306,_0x33628b){return _0x2faa6f(_0xac0306,_0x33628b);},'NwXZz':_0x5f1251(0x12b),'zaVgu':_0x5f1251(0x18c),'LVXGz':'Invalid\x20signature.','tLcPY':_0x5f1251(0x15e),'SHdtn':_0x5f1251(0x170),'MpVtI':'Invalid\x20publicKeyUrl','iBsda':_0x5f1251(0x116),'gZuDa':_0x5f1251(0x127),'gorSs':_0x5f1251(0x110),'kTgwF':_0x5f1251(0x14a),'bWqBF':_0x5f1251(0x144),'syWTW':_0x5f1251(0x173),'iKgpk':'cloud.xtralife.gamecenterauth','ijbBc':function(_0x246cbe,_0x30bfae,_0x3b29c8){return _0x246cbe(_0x30bfae,_0x3b29c8);},'IGDNo':_0x5f1251(0x176),'WydhM':_0x5f1251(0x182),'ppLiZ':function(_0x5ae41c,_0x467e1b,_0x391926){return _0x5ae41c(_0x467e1b,_0x391926);},'FcblV':_0x5f1251(0x18d),'LZPZm':function(_0x12daf5,_0x3e8412,_0xcf41eb){return _0x12daf5(_0x3e8412,_0xcf41eb);},'PUCyy':function(_0x3197c6,_0x5d987a,_0x14fef6){return _0x3197c6(_0x5d987a,_0x14fef6);},'CvKWr':_0x5f1251(0x12d),'gxGbX':_0x5f1251(0x129),'iOVWa':function(_0x1a0dcb,_0x2199c5,_0x350d77){return _0x1a0dcb(_0x2199c5,_0x350d77);},'DxJWa':function(_0x547a2f,_0x24603b,_0x46cc95){return _0x547a2f(_0x24603b,_0x46cc95);},'dcQvg':function(_0x29df73,_0x5513a2,_0xc595bb){return _0x29df73(_0x5513a2,_0xc595bb);}};let _0x2db521;_0x3eb244['OkQGp'](beforeEach,function(){const _0x5b7e76=_0x5f1251;_0x2db521=new GameCenterAuth[(_0x5b7e76(0x178))]();const _0x3bc7d2=fs['readFileSync'](path['resolve'](__dirname,_0x3eb244['JkGCi'])),_0x1b8dc0=fs[_0x5b7e76(0x121)](path['resolve'](__dirname,'../../support/cert/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem'))['toString']();_0x3eb244['OkQGp'](mockFetch,[{'url':_0x3eb244['cXGto'],'method':_0x3eb244[_0x5b7e76(0x189)],'response':{'ok':!![],'headers':new Map(),'arrayBuffer':()=>Promise['resolve'](_0x3bc7d2['buffer'][_0x5b7e76(0x152)](_0x3bc7d2['byteOffset'],_0x3bc7d2[_0x5b7e76(0x11a)]+_0x3bc7d2[_0x5b7e76(0x132)]))}},{'url':_0x3eb244[_0x5b7e76(0x188)],'method':_0x3eb244[_0x5b7e76(0x189)],'response':{'ok':!![],'headers':new Map([[_0x5b7e76(0x11e),_0x5b7e76(0x187)],[_0x3eb244[_0x5b7e76(0x10c)],_0x1b8dc0[_0x5b7e76(0x132)][_0x5b7e76(0x131)]()]]),'text':()=>Promise[_0x5b7e76(0x186)](_0x1b8dc0)}}]);}),describe(_0x3eb244[_0x5f1251(0x13e)],function(){const _0x3badb9=_0x5f1251,_0xcf3e26={'ZgOvv':_0x3badb9(0x177),'BsBAe':_0x3badb9(0x14f),'YEmsJ':_0x3eb244['tbacb'],'ZnWrx':_0x3badb9(0x187),'EAniE':_0x3eb244[_0x3badb9(0x10c)],'ONAkV':function(_0x5a2377,_0x3c201b){return _0x5a2377===_0x3c201b;},'VRMTC':_0x3eb244['fILPa'],'sfAVp':function(_0x1f1af4,_0xf2340e){return _0x1f1af4(_0xf2340e);},'gXFid':_0x3eb244[_0x3badb9(0x149)],'uQOFC':function(_0x33e4df,_0x3cd18d){return _0x33e4df(_0x3cd18d);}};it(_0x3badb9(0x172),async function(){const _0x5d9774=_0x3badb9,_0x44e6ed=[null,undefined,{},{'bundleId':''},{'enableInsecureAuth':![]}];for(const _0x16bbce of _0x44e6ed){if(_0xcf3e26[_0x5d9774(0x181)]('uDOlG',_0xcf3e26[_0x5d9774(0x183)]))_0xcf3e26['sfAVp'](expect,()=>_0x2db521[_0x5d9774(0x156)](_0x16bbce))[_0x5d9774(0x119)](JSON[_0x5d9774(0x11b)](_0x16bbce))['toThrow']();else{_0x1a5dbd=new _0x316ab2['constructor']();const _0x31388e=_0x488138['readFileSync'](_0x3b52b9[_0x5d9774(0x186)](_0x523a6e,_0xcf3e26[_0x5d9774(0x12c)])),_0x14af8b=_0xc699eb[_0x5d9774(0x121)](_0xccfa3e[_0x5d9774(0x186)](_0x6789e0,_0xcf3e26['BsBAe']))[_0x5d9774(0x131)]();_0x1e0e9c([{'url':'https://static.gc.apple.com/public-key/gc-prod-4.cer','method':_0xcf3e26[_0x5d9774(0x11d)],'response':{'ok':!![],'headers':new _0x30016b(),'arrayBuffer':()=>_0x4b6351['resolve'](_0x31388e[_0x5d9774(0x163)][_0x5d9774(0x152)](_0x31388e[_0x5d9774(0x11a)],_0x31388e[_0x5d9774(0x11a)]+_0x31388e[_0x5d9774(0x132)]))}},{'url':_0x5d9774(0x13a),'method':_0xcf3e26[_0x5d9774(0x11d)],'response':{'ok':!![],'headers':new _0x49511e([['content-type',_0xcf3e26[_0x5d9774(0x126)]],[_0xcf3e26['EAniE'],_0x14af8b[_0x5d9774(0x132)][_0x5d9774(0x131)]()]]),'text':()=>_0x108b48[_0x5d9774(0x186)](_0x14af8b)}}]);}}}),_0x3eb244[_0x3badb9(0x137)](it,_0x3badb9(0x185),function(){const _0x488cb6=_0x3badb9,_0x577319={'bundleId':_0xcf3e26[_0x488cb6(0x134)],'enableInsecureAuth':![]};_0xcf3e26[_0x488cb6(0x17e)](expect,()=>_0x2db521[_0x488cb6(0x156)](_0x577319))[_0x488cb6(0x179)][_0x488cb6(0x159)]();});}),describe(_0x5f1251(0x142),function(){const _0x2963a9=_0x5f1251;_0x3eb244['vIsYT'](it,_0x2963a9(0x160),async function(){const _0x46f633=_0x2963a9;await expectAsync(_0x2db521[_0x46f633(0x11f)]({}))[_0x46f633(0x112)](_0x3eb244[_0x46f633(0x17b)]);});}),_0x3eb244[_0x5f1251(0x18b)](describe,_0x5f1251(0x153),function(){const _0x17d469=_0x5f1251,_0x1229e5={'AGnFm':_0x3eb244[_0x17d469(0x136)],'PbtoI':function(_0x47e637,_0x2c080f,_0x3af5db){return _0x47e637(_0x2c080f,_0x3af5db);},'OeZJh':_0x3eb244[_0x17d469(0x16e)],'NVKVd':_0x3eb244[_0x17d469(0x143)],'RIUAH':function(_0x82d346,_0x108004){return _0x82d346(_0x108004);}};it(_0x17d469(0x124),async function(){const _0x10f4ce=_0x17d469,_0x29f49e=_0x1229e5[_0x10f4ce(0x150)];_0x1229e5[_0x10f4ce(0x139)](spyOn,_0x2db521,_0x1229e5['OeZJh'])[_0x10f4ce(0x184)][_0x10f4ce(0x14c)](new Error(_0x1229e5['NVKVd'])),await _0x1229e5['RIUAH'](expectAsync,_0x2db521[_0x10f4ce(0x12b)](_0x29f49e))['toBeRejectedWithError'](_0x10f4ce(0x145));}),it(_0x3eb244[_0x17d469(0x146)],async function(){const _0xfee13=_0x17d469,_0x196598='invalid-key',_0x21eb35={'id':_0x3eb244[_0xfee13(0x17c)],'publicKeyUrl':_0x3eb244[_0xfee13(0x174)],'timestamp':0x154294754f7,'salt':'saltST==','signature':_0xfee13(0x120)};_0x3eb244[_0xfee13(0x155)](spyOn,_0x2db521,_0x3eb244[_0xfee13(0x166)])['and'][_0xfee13(0x113)](Promise['resolve'](_0x196598)),_0x3eb244['JznuT'](spyOn,_0x2db521,_0x3eb244[_0xfee13(0x15c)])[_0xfee13(0x184)][_0xfee13(0x14c)](_0x3eb244[_0xfee13(0x12a)]),await expectAsync(_0x2db521[_0xfee13(0x11f)](_0x21eb35))[_0xfee13(0x112)](_0x3eb244['LVXGz']);});}),_0x3eb244[_0x5f1251(0x13f)](describe,_0x5f1251(0x117),function(){const _0x15aeeb=_0x5f1251;it(_0x3eb244[_0x15aeeb(0x118)],async function(){const _0x380625=_0x15aeeb,_0x38cbb5={'id':_0x380625(0x17d),'publicKeyUrl':_0x3eb244[_0x380625(0x174)],'timestamp':0x154294754f7,'salt':_0x3eb244['gZuDa'],'signature':_0x3eb244[_0x380625(0x17f)],'bundleId':_0x380625(0x175)};_0x3eb244['FQFiR'](spyOn,_0x2db521,_0x380625(0x12b))[_0x380625(0x184)][_0x380625(0x113)](Promise[_0x380625(0x186)](_0x380625(0x15a))),spyOn(_0x2db521,_0x380625(0x18c))['and'][_0x380625(0x113)](!![]),await _0x3eb244[_0x380625(0x154)](expectAsync,_0x2db521[_0x380625(0x11f)](_0x38cbb5))['toBeResolved']();});}),_0x3eb244[_0x5f1251(0x17a)](describe,_0x5f1251(0x130),function(){const _0x5a0c20=_0x5f1251,_0x3398b5={'aUCNg':_0x3eb244[_0x5a0c20(0x16e)],'SQXXx':function(_0x2bf4f8,_0x5beddb,_0x15f73b){return _0x2bf4f8(_0x5beddb,_0x15f73b);},'flHEY':function(_0x20b175,_0x5302c0){return _0x20b175(_0x5302c0);},'vtpOa':_0x3eb244[_0x5a0c20(0x11c)],'dDyFn':function(_0x5618bf,_0xd8b2e3){return _0x5618bf(_0xd8b2e3);},'ctsiL':_0x5a0c20(0x144),'dRceB':_0x3eb244['cXGto'],'kxrij':_0x5a0c20(0x176),'MoHTv':_0x3eb244['syWTW'],'eYZOz':_0x3eb244[_0x5a0c20(0x140)]};_0x3eb244[_0x5a0c20(0x10e)](it,_0x3eb244[_0x5a0c20(0x125)],async function(){const _0x34337b=_0x5a0c20,_0x6277bd=_0x34337b(0x122),_0x4db9e1='mockCertificate';spyOn(_0x2db521,_0x3398b5['aUCNg'])[_0x34337b(0x184)]['returnValue'](Promise['resolve']({'certificate':_0x4db9e1,'headers':new Map()})),_0x3398b5[_0x34337b(0x13d)](spyOn,pki,_0x34337b(0x10f))[_0x34337b(0x184)]['returnValue']({}),_0x2db521[_0x34337b(0x111)][_0x6277bd]=_0x4db9e1;const _0x1025d9=await _0x2db521[_0x34337b(0x12b)](_0x6277bd);_0x3398b5[_0x34337b(0x10d)](expect,_0x1025d9)[_0x34337b(0x15d)](_0x4db9e1);}),it(_0x5a0c20(0x16f),async function(){const _0x217551=_0x5a0c20,_0x2cf233={'id':_0x3eb244[_0x217551(0x13b)],'publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer','timestamp':0x16c7096de77,'signature':_0x217551(0x176),'salt':_0x3eb244[_0x217551(0x14d)]};_0x2db521['bundleId']=_0x3eb244[_0x217551(0x140)],_0x2db521['enableInsecureAuth']=![],_0x3eb244[_0x217551(0x161)](spyOn,_0x2db521,'verifyPublicKeyIssuer')[_0x217551(0x184)]['returnValue']();const _0x2b8743=await _0x2db521['getAppleCertificate'](_0x2cf233[_0x217551(0x180)]);_0x3eb244[_0x217551(0x154)](expect,()=>_0x2db521[_0x217551(0x18c)](_0x2b8743,_0x2cf233))[_0x217551(0x179)]['toThrow']();}),_0x3eb244[_0x5a0c20(0x138)](it,'should\x20not\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20secure\x20mode',async function(){const _0x1a3dc0=_0x5a0c20,_0xcc10f5={'id':_0x3eb244[_0x1a3dc0(0x13b)],'publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer','timestamp':0x16c7096de77,'signature':_0x3eb244[_0x1a3dc0(0x16d)],'salt':_0x1a3dc0(0x173),'bundleId':_0x1a3dc0(0x164)};_0x2db521[_0x1a3dc0(0x123)]=_0x1a3dc0(0x12f),_0x2db521[_0x1a3dc0(0x13c)]=![],_0x3eb244[_0x1a3dc0(0x137)](spyOn,_0x2db521,_0x1a3dc0(0x182))[_0x1a3dc0(0x184)][_0x1a3dc0(0x113)]();const _0x1aab3e=await _0x2db521[_0x1a3dc0(0x12b)](_0xcc10f5[_0x1a3dc0(0x180)]);expect(()=>_0x2db521[_0x1a3dc0(0x18c)](_0x1aab3e,_0xcc10f5))[_0x1a3dc0(0x179)]['toThrow']();}),_0x3eb244[_0x5a0c20(0x155)](it,'should\x20not\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20insecure\x20mode',async function(){const _0x21dcd1=_0x5a0c20,_0x8fb188={'id':_0x21dcd1(0x144),'publicKeyUrl':_0x21dcd1(0x122),'timestamp':0x16c7096de77,'signature':_0x21dcd1(0x176),'salt':_0x21dcd1(0x173),'bundleId':_0x21dcd1(0x164)};_0x2db521[_0x21dcd1(0x123)]=_0x21dcd1(0x12f),_0x2db521[_0x21dcd1(0x13c)]=!![],spyOn(_0x2db521,_0x3398b5[_0x21dcd1(0x16a)])['and'][_0x21dcd1(0x113)]();const _0x56ed55=await _0x2db521[_0x21dcd1(0x12b)](_0x8fb188[_0x21dcd1(0x180)]);_0x3398b5[_0x21dcd1(0x148)](expect,()=>_0x2db521[_0x21dcd1(0x18c)](_0x56ed55,_0x8fb188))[_0x21dcd1(0x179)][_0x21dcd1(0x159)]();}),_0x3eb244[_0x5a0c20(0x158)](it,_0x3eb244[_0x5a0c20(0x151)],async function(){const _0x3a83da=_0x5a0c20,_0x38cdee={'id':_0x3398b5[_0x3a83da(0x135)],'publicKeyUrl':_0x3398b5[_0x3a83da(0x16c)],'timestamp':0x16c7096de77,'signature':_0x3398b5['kxrij'],'salt':_0x3398b5[_0x3a83da(0x16b)],'bundleId':_0x3398b5[_0x3a83da(0x162)]};_0x2db521[_0x3a83da(0x13c)]=!![],_0x3398b5[_0x3a83da(0x13d)](spyOn,_0x2db521,_0x3a83da(0x182))[_0x3a83da(0x184)][_0x3a83da(0x113)]();const _0x122cbb=await _0x2db521[_0x3a83da(0x12b)](_0x38cdee['publicKeyUrl']);expect(()=>_0x2db521[_0x3a83da(0x18c)](_0x122cbb,_0x38cdee))[_0x3a83da(0x179)]['toThrow']();});});});function _0x223b(){const _0x29f8e0=['validKey','node-forge','zaVgu','toBe','https://malicious.url.com/key.cer','AuthData\x20id\x20is\x20missing.','should\x20throw\x20error\x20for\x20missing\x20authData\x20fields','ijbBc','eYZOz','buffer','com.example.insecure.app','6154225LUQtDA','NwXZz','2471AlTimH','4UgYCIt','../../../lib/Adapters/Auth/gcenter','vtpOa','MoHTv','dRceB','IGDNo','SHdtn','should\x20verify\x20signature\x20successfully','fetchCertificate','6AEfYjw','should\x20throw\x20error\x20for\x20invalid\x20options','DzqqrQ==','cXGto','com.valid.app','uqLBTr9Uex8zCpc1UQ1MIDMitb+HUat2Mah4Kw6AVLSGe0gGNJXlih2i5X+0ZwVY0S9zY2NHWi2gFjmhjt/4kxWGMkupqXX5H/qhE2m7hzox6lZJpH98ZEUbouWRfZX2ZhUlCkAX09oRNi7fI7mWL1/o88MaI/y6k6tLr14JTzmlxgdyhw+QRLxRPA6NuvUlRSJpyJ4aGtNH5/wHdKQWL8nUnFYiYmaY8R7IjzNxPfy8UJTUWmeZvMSgND4u8EjADPsz7ZtZyWAPi8kYcAb6M8k0jwLD3vrYCB8XXyO2RQb/FY2TM4zJuI7PzLlvvgOJXbbfVtHx7Evnm5NYoyzgzw==','../../support/cert/gc-prod-4.cer','constructor','not','dcQvg','zIyiI','MRhVe','1234567','uQOFC','gorSs','publicKeyUrl','ONAkV','verifyPublicKeyIssuer','VRMTC','and','should\x20validate\x20options\x20successfully\x20with\x20valid\x20parameters','resolve','application/x-pem-file','IbAkf','tbacb','7661330xsDHnB','iOVWa','verifySignature','should\x20fetch\x20and\x20validate\x20Apple\x20certificate','default','obmnq','flHEY','ppLiZ','certificateFromPem','validSignature','cache','toBeRejectedWithError','returnValue','GameCenterAuth\x20Adapter','13764abmNMH','should\x20throw\x20error\x20for\x20invalid\x20signature\x20verification','Test\x20payload\x20passing','kTgwF','withContext','byteOffset','stringify','WydhM','YEmsJ','content-type','validateAuthData','invalidSignature','readFileSync','https://static.gc.apple.com/public-key/gc-prod-4.cer','bundleId','should\x20throw\x20error\x20for\x20invalid\x20publicKeyUrl','FcblV','ZnWrx','saltST==','117LgdWoJ','Test\x20config\x20failing\x20due\x20to\x20missing\x20params\x20or\x20wrong\x20types','LVXGz','getAppleCertificate','ZgOvv','can\x20\x20use\x20bundle\x20id\x20from\x20authData\x20payload\x20in\x20insecure\x20mode','20MXmJYU','cloud.xtralife.gamecenterauth','Certificate\x20and\x20Signature\x20Validation','toString','length','298646fSXEac','gXFid','ctsiL','tLcPY','JznuT','LZPZm','PbtoI','https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','bWqBF','enableInsecureAuth','SQXXx','gxGbX','DxJWa','iKgpk','path','Test\x20payload\x20failing\x20due\x20to\x20missing\x20params\x20or\x20wrong\x20types','MpVtI','G:1965586982','Invalid\x20publicKeyUrl:\x20https://malicious.url.com/key.cer','iBsda','uDOlG','dDyFn','NunFE','should\x20successfully\x20process\x20valid\x20payload\x20and\x20save\x20auth\x20data','12592512ZHcTcZ','throwError','syWTW','35048RdeqGE','../../support/cert/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','AGnFm','CvKWr','slice','Test\x20payload\x20fails\x20due\x20to\x20incorrect\x20appId\x20/\x20certificate','OkQGp','FQFiR','validateOptions','364329ScZcCQ','PUCyy','toThrow'];_0x223b=function(){return _0x29f8e0;};return _0x223b();}