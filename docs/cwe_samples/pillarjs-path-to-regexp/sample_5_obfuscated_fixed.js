function _0x3076(){const _0x47a986=['readFileSync','SsBko','VbhRH','bpFBJ','VmlZP','https://example.com/introspect','OVuXg','dWNxB','should\x20support\x20loginWith\x20with\x20session\x20token\x20and\x20with/without\x20mutated\x20authData','toBeDefined','fakeid','fakeAuthProvider','G:1965586982','PlJol','MEqNZ','getTime','knHYF','gplpn','qiNsP','WkEoC','mXpqj','KrjOR','pjIHa','wqxut','Expiration\x20should\x20be\x20cleared','XaVyx','ZDJkc','nuIWx','DbCvn','bZOmi','diLzD','SMS','validateAuthData\x20invalid\x20accessToken','validateAuthData\x20should\x20fail\x20with\x20invalid\x20groups','JYxnQ','fwMPR','IwsMd','WbZic','kfHGg','first','constructor','fUKny','JDWZn','303616pbuOJD','IMxlQ','bAqwV','validateAppId','hDKbR','edCTo','validateAuthData\x20should\x20pass\x20validation','MycFz','YWOnY','MCkMA','sendSMS','cHRmr','unlink\x20and\x20link\x20with\x20custom\x20provider','Unable\x20to\x20find\x20matching\x20key\x20for\x20Key\x20ID:\x20','my-token','request','ZpHeP','gxSHG','RjWXF','FjGbl','myoauth','line','(using\x20client\x20id\x20as\x20array\x20with\x20multiple\x20items)\x20should\x20verify\x20id_token\x20(facebook.com)','TsUcs','TTgJG','xXJSn','OTP\x20TOTP\x20auth\x20adatper','jQeEy','RRFPF','INSERT\x20FACEBOOK\x20TOKEN\x20HERE','includes','pRKdb','DDGCM','eBNXH','microsoft','fetch','ZNaFq','iUXNt','should\x20throw\x20error\x20when\x20Facebook\x20request\x20appId\x20is\x20wrong\x20data\x20type','YCCoI','UAPOP','NCTvn','QljuU','NOYgv','FPBjZ','AzXAB','_User','zvbsa','VfFYC','HvjOM','zoVlO','sDNgD','vslJD','a_different_user_id','valid-token','_auth_data_myoauth','uFYig','yPePg','mcJCq','UogJQ','HIOPI','VWQFD','123','appsecret_proof','ZGvfA','kid','IqweE','validateAuthData\x20valid\x20accessToken','LRyaI','createdAt','database','find','Auth\x20token\x20should\x20be\x20cleared','sxfVt','YduGD','reject','(using\x20client\x20id\x20as\x20array)\x20should\x20not\x20verify\x20invalid\x20id_token','https://www.facebook.com','XTsDY','rppVC','qaaoi','mxClC','epfeD','sometoken','HockP','Invalid\x20authentication','OVNHT','LInqo','xyFsF','TOTP','QjvmX','stdqL','ekViy','nzxOl','getValidatorForProvider','JIcvV','cRnCu','../lib/Adapters/Auth/microsoft','nWshZ','_isLinked','xheRg','DaLZF','authData','NdvjJ','qddVB','gcWiY','validateAppId\x20valid\x20accessToken\x20appId','header','EDzVx','bgDZv','kwvCK','jiSKz','GGCsP','ADlLM','quyOd','QgTAl','/support/cert/game_center.pem','unknown','hvzlN','kvyGO','validateAuthData\x20should\x20throw\x20for\x20invalid\x20auth','Pkypb','jWyJr','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20client_id','adapter\x20should\x20load\x20default\x20cert','baFhb','LljCa','pHvSF','aMopj','validateAuthData\x20should\x20validate','UWhzY','SHA1','../lib/Adapters/Auth/google','QGvPi','updatedAt','xOtpv','VByLg','(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer','ruLTM','INSERT\x20CLIENT\x20ID\x20HERE','jzvjh','alg','properly\x20loads\x20custom\x20adapter\x20module\x20object\x20(again)','Lgmyy','secret\x20123','aDTah','INSERT\x20APPLE\x20TOKEN\x20HERE','dtcWf','provided\x20token\x20does\x20not\x20decode\x20as\x20JWT','CczrR','prurn','algorithms','POST','+11111111111','vFOmT','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20with\x20token\x20(apple.com)','BbnZM','facebook\x20limited\x20auth\x20adapter','SqoRb','DRtjp','google','jCOAX','toEqual','dcOlT','MXesZ','khwOu','HLTSS','INSERT\x20FACEBOOK\x20TOKEN\x20HERE\x20WITH\x20INVALID\x20JWT\x20ISSUER','tQxnU','mwtUz','rHSRn','adapter\x20should\x20throw','auth\x20data\x20is\x20invalid\x20for\x20this\x20user.','WADEC','secret_sauce','qFCRv','FMqDa','should\x20support\x20sync/async\x20validateAppId','QoNQV','jVWcy','installationId','SsWYQ','INSERT\x20ID\x20HERE','lUtmh','kJSpK','rEXox','vvgjC','validateAuthData\x20should\x20fail\x20with\x20error\x20description','rEyoU','validateAppId\x20valid\x20accessToken\x20invalid\x20appId','FUKMT','(using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(google.com)','map','Vaxvz','KidAo','_logInWith','custom\x20error\x20message','OddQJ','7bfa55ab-8fd7-4526-992e-6de3df16bf9c','CiUur','../lib/Adapters/Auth/utils','CkwGO','hZPac','fJWYN','jJwQC','mqlbl','using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(facebook.com)','1234','DBCUu','applicationId','CWLcy','instagram\x20auth\x20adapter','AnxkB','cEUsd','loadAuthAdapter','YbKip','https://static.gc.apple.com/public-key/gc-prod-6.cer','id\x20token\x20not\x20issued\x20by\x20correct\x20provider\x20-\x20expected:\x20accounts.google.com\x20or\x20https://accounts.google.com\x20|\x20from:\x20https://not.google.com','kDEMH','can\x20load\x20adapter','vUFFb','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(apple.com)','Nrpcr','549c33a1-3a6b-4732-8cf6-8f010ad4569c','JpXio','lMTKo','../lib/request','AwGPy','should\x20fail\x20to\x20validate\x20Microsoft\x20Graph\x20auth\x20with\x20bad\x20token','KMzWY','DtKhX','xpGKY','ESdnH','JICtb','HxKkp','JTwVY','success','WWjjb','OYchs','future\x20logins\x20reject\x20incorrect\x20TOTP\x20token','PNKmH','OBhaD','Apple\x20Game\x20Center\x20Auth\x20adapter','args','frKWg','eqPDT','../lib/Controllers/SchemaController','gcenter','should\x20not\x20verify\x20invalid\x20id_token','qQgtC','WHxUf','sort','Auth\x20token\x20should\x20have\x20a\x20value','should\x20fail\x20to\x20link\x20if\x20session\x20token\x20don\x27t\x20match\x20user','zcqmM','world','verify','PfoJP','IBAIG','User\x20should\x20not\x20be\x20linked\x20to\x20myoauth','should\x20only\x20create\x20a\x20single\x20user\x20with\x20REST\x20API','pwLyX','Ahrqj','RXkdG','validateAppId\x20valid\x20accessToken\x20appId\x20array','ZZQzD','Wnsvq','(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20missing\x20id_token','app','334470hRPgLk','NYHrK','https://cacerts.digicert.com/DigiCertTrustedG4CodeSigningRSA4096SHA3842021CA1.crt.pem','toBeNull','fkLzE','badtoken','defaultColumns','KIPDS','https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg','CvVgq','UnVNP','BURzg','JByrq','c194d902-e697-46c9-a303-82c2d914473c','http://example.com','SxZbg','XJsMJ','nHyme','OPXWh','/introspect','rest','OScUM','GFYHi','TggWH','User\x20should\x20be\x20linked\x20to\x20myoauth','5111136dBTGUd','EukdH','instagram','../lib/Adapters/Auth/httpsRequest','jwt\x20malformed','resolveTo','disabled','useridField','kayGA','pJUvR','RubWk','YACch','bwgEd','FEzlh','UpJrm','NzNdf','Google\x20Play\x20Games\x20Services\x20-\x20authData\x20is\x20invalid\x20for\x20this\x20user.','keycloak','weibo','hOwgy','nbthD','should\x20pass\x20in\x20api\x20url','oayjE','GduxK','hello','Missing\x20additional\x20authData\x20mfa','ttQty','facebook','phantauth','XZuWx','xGORl','GSynO','then','cloud.xtralife.gamecenterauth','the_token','LSwnn','key','https://not.facebook.com','QPURF','QoMcR','doZGG','TzZSV','EeSYI','synchronizedAuthToken','XnlXz','HNUYY','mcYaZ','qaYHm','lvjoB','function','yYHPN','authorizationHeader','verifyPublicKeyIssuer','../lib/Adapters/Auth/apple','meetup','should\x20use\x20default\x20api','UrEsR','FiHYW','KzoCU','asyncProvider','http://localhost:8378/1/users','HdziD','recovery','cLugU','RuMZb','qEcMi','ziNIM','OAuth2\x20token\x20introspection\x20endpoint\x20URL\x20is\x20missing\x20from\x20configuration!','ZWqlc','gHimc','./spec/support/CustomAuthFunction.js','_Installation','IvgAM','pczER','GStXq','PVihQ','tLaWj','ntVkJ','jsonwebtoken','MxIpl','fakeToken2','AgLYV','base32','validateAuthData\x20should\x20fail\x20without\x20config','jwt\x20audience\x20invalid.\x20expected:\x20secret','EbQrw','SmcMW','CUnWx','hgFUW','ACL','fknFw','PcoXy','id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com','Ccpgn','JjqNt','WjXJN','QhdRr','YSEmh','MEREI','MEGzB','RBnYX','blUIU','oORUC','DLDdG','./spec/support/CustomAuth.js','1632668VVbRYo','KaahD','grbPN','TGOZj','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(google.com)','application/x-www-form-urlencoded','xLUtI','NVrrQ','yMLHm','role1','zyhrY','Ppwoj','myUser','../lib/Adapters/Auth/facebook','NwLif','UBbCX','ypErU','mnZFr','FYzUn','tmbEw','107jJFifB','message','id\x20token\x20is\x20invalid\x20for\x20this\x20user.','password','AqjhV','PtPvn','JFoHT','ykAtA','mnnax','should\x20handle\x20Facebook\x20appSecret\x20for\x20validating\x20appIds','Facebook\x20auth\x20is\x20not\x20configured.','IRcTN','Should\x20validate\x20structure\x20of\x20','../lib/Adapters/Auth/gcenter','XoanO','can\x20enroll','yolo','IcFvo','keycloak\x20auth\x20adapter','WPkcV','test','sub','vYXcv','mfa','error','qOpSe','prototype','KwtQh','validateAppId\x20invalid\x20accessToken','mbDRq','ajYsM','janrainengage','4bcb1a1a-11f8-4e12-a3f6-73f7e25e355a','apple','iDHFX','xFvuj','should\x20use\x20access_token\x20for\x20validation\x20is\x20passed\x20and\x20responds\x20with\x20id\x20and\x20mail','validateAppId\x20appidField\x20optional','linkedin','HIuxE','789','can\x20login\x20with\x20valid\x20token','nsrhk','catch','oauth2Authentication','qWybm','(using\x20client\x20id\x20as\x20string)\x20should\x20verify\x20id_token\x20(apple.com)','invalid\x20user','validateAuthData\x20valid\x20accessToken\x20without\x20useridField','yDoOO','VzGmM','WpEnl','arCum','ABJhb','mskKS','http://localhost:8378/1/login','getHeaderFromToken','UOTVe','../lib/Adapters/Auth/gpgames','twitter','lEaby','UTwRN','qyyZm','properly\x20loads\x20OAuth2\x20adapter\x20via\x20the\x20\x22oauth2\x22\x20option','KYynF','Could\x20not\x20connect\x20to\x20the\x20authentication\x20server','Ejyte','shouldCancel','ebBmx','application/json','getSigningKey','hosting_error','appIds\x20must\x20be\x20an\x20array.','YVgGW','skoKd','userId','qRlBu','should\x20throw\x20error\x20with\x20with\x20invalid\x20user\x20id\x20(facebook.com)','CGeai','8850qAoeDU','HUrwp','_Default','OAuth2\x20configuration\x20is\x20missing\x20the\x20client\x20app\x20IDs\x20(\x22appIds\x22\x20config\x20parameter).','qlfMQ','authDataResponse','SjTPk','keys','Invalid\x20MFA\x20token','UnsOg','ShTqo','PcQnJ','QwvaL','Query','partially\x20enrolled\x20users\x20can\x20still\x20login','TrmdT','pending','aDEem','vkontakte','csFzy','crTbq','uYRFj','callFake','TbLQo','should\x20throw\x20error\x20with\x20invalid\x20user\x20id','MyVyW','secret','oWqOH','synchronizedExpiration','UbjlQ','YJgWB','https://appleid.apple.com','synchronizedUserId','VpPKl','now','65450mZxFAF','debug','validateAuthData\x20should\x20throw\x20error','rKsNu','An\x20error\x20occurred','acJdO','rjtPP','PBKkF','uqWAa','PmSTE','appId','access_token','gtkNq','sojRi','https://new-api.instagram.com/v1/me?fields=id&access_token=the_token','google\x20auth\x20adapter','Qoyag','resolve','Should\x20have\x20used\x20the\x20subclass.','EUNfC','Apple\x20Game\x20Center\x20-\x20invalid\x20publicKeyUrl:\x20','pszIl','Ngkzy','the_rsa_public_key','YYxhW','RS256','data','validateAuthData','Nmjhv','zbmmJ','kMDNc','FDuqi','validateAuthData\x20should\x20fail\x20if\x20OAuth2\x20tokenIntrospectionEndpointUrl\x20is\x20not\x20configured\x20properly','oIMph','405279bEzmek','yTspg','Dkagb','not','providerOptions','RrxFj','custom','code','appSecret','GJsJT','eDXKX','VDOOH','TgHNY','PifoI','uMpIV','OAuth2:\x20the\x20access_token\x27s\x20appID\x20is\x20empty\x20or\x20is\x20not\x20in\x20the\x20list\x20of\x20permitted\x20appIDs\x20in\x20the\x20auth\x20configuration.','com.example.com','kStfT','Ykbgg','WWkHs','YkXyT','bZZZN','hWZPb','24fsoUjQ','birFe','logInWith','sILdf','aRfRN','HyfOT','2|0|1|3|4','uUoTr','GjLla','nGwLu','https://graph.instagram.com/me?fields=id&access_token=the_token','sYEvA','jzHas','length','toBeRejectedWith','ajTTJ','LSxVF','should\x20not\x20decode\x20invalid\x20id_token','HrGYA','very.long.bad.token','abgoC','SCRIPT_FAILED','FYpWh','cmsvU','cyBIx','signUp','properly\x20loads\x20custom\x20adapter','toHaveBeenCalledTimes','validateAuthData\x20should\x20fail\x20connect\x20error','GdUOR','/realms/new/protocol/openid-connect/userinfo','cache','pyFnt','DOOzX','expiration_date','syncProvider','HZShV','hspNF','jABCA','sEKHc','plvTU','TtsED','iEYRe','getSessionToken','microsoft\x20graph\x20auth\x20adapter','otqdD','Vgfds','invalid_client_id','Missing\x20access\x20token\x20and/or\x20User\x20id','gJJWa','callThrough','UNQYl','split','UdlyR','../lib/Adapters/Auth/','tZZod','customAuthentication','98GgLvzO','iOfAp','id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://www.facebook.com\x20|\x20from:\x20https://not.facebook.com','https://not.apple.com','should\x20create\x20user\x20with\x20REST\x20API','OTHER_CAUSE','oOAqe','uiPCR','ksTcA','xDuII','dIFWz','zzyWP','EegCF','example.com','https://example.com/\x20\x5c.apple.com/public_key.cer','stringify','(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20missing\x20id_token','KWInE','https://oauth.vk.com/access_token?client_id=appId&client_secret=appSecret&v=5.124&grant_type=client_credentials','MCfig','KTKQV','otpauth','../lib/Adapters/Auth','appIds','toBeUndefined','tokenIntrospectionEndpointUrl','qsyLr','187JraRVE','AMhGt','OossF','pGukM','https://oauth.vk.com/access_token?client_id=appId&client_secret=appSecret&v=5.123&grant_type=client_credentials','uqLBTr9Uex8zCpc1UQ1MIDMitb+HUat2Mah4Kw6AVLSGe0gGNJXlih2i5X+0ZwVY0S9zY2NHWi2gFjmhjt/4kxWGMkupqXX5H/qhE2m7hzox6lZJpH98ZEUbouWRfZX2ZhUlCkAX09oRNi7fI7mWL1/o88MaI/y6k6tLr14JTzmlxgdyhw+QRLxRPA6NuvUlRSJpyJ4aGtNH5/wHdKQWL8nUnFYiYmaY8R7IjzNxPfy8UJTUWmeZvMSgND4u8EjADPsz7ZtZyWAPi8kYcAb6M8k0jwLD3vrYCB8XXyO2RQb/FY2TM4zJuI7PzLlvvgOJXbbfVtHx7Evnm5NYoyzgzw==','DuFBw','QxZNk','siyzg','Error','AoqJv','(using\x20client\x20id\x20as\x20array\x20with\x20multiple\x20items)\x20should\x20verify\x20id_token\x20(apple.com)','WldKd','https://new-api.instagram.com/v1/','zPNyj','rsEge','token','OinTo','validateAuthData\x20should\x20fail\x20without\x20user\x20id','myUser2','ZNIQI','JMQvh','WOTza','User\x20id\x20should\x20be\x20cleared','MmVNG','_registerAuthenticationProvider','current','toBe','SDvQn','ivTyI','invalid','wechat','LxbVM','validateAuthData\x20invalid\x20public\x20key\x20http\x20url','calls','tgnkt','hiaBP','Microsoft\x20Graph\x20auth\x20is\x20invalid\x20for\x20this\x20user.','PhiYN','should\x20provide\x20the\x20right\x20responses\x20for\x20adapter\x20','KhDAD','loggedOut','tuKwP','and','PitCS','GfytC','nVHtN','KaBrP','XpZtT','qChqb','JXGWS','wUpcp','uhMOA','should\x20handle\x20Facebook\x20appSecret\x20for\x20validating\x20auth\x20data','lWXAF','lOzOv','enaBN','SVDUn','the_user_id','https://not.google.com','userMail','SHFyp','fNXRf','XMxpJ','c521a272-2ac2-4d8b-b5ed-ea250336d8b1','Mdodb','ABGLE','TUYdA','LSFdo','JqKam','buybh','hFZpB','TCsMv','AehTt','toHaveBeenCalled','should\x20throw\x20error\x20if\x20public\x20key\x20used\x20to\x20encode\x20token\x20is\x20not\x20available','lZBZa','_unlinkFrom','objectId','aKvxU','afxGL','Pkfym','get','BWdab','htgMe','can\x20change\x20OTP\x20with\x20valid\x20token','save','https://example.com/\x20&.apple.com/public_key.cer','QJIdq','jMJEJ','ZhsjM','adapter','llOqw','BkNrk','rKpAN','OAuth2\x20access\x20token\x20is\x20invalid\x20for\x20this\x20user.','IeCok','zATqr','FYLYI','Tezlj','properly\x20loads\x20custom\x20adapter\x20module\x20object','fail','XEkoo','OCpAf','kBAJt','grKXL','FuZJX','NAaFF','Please\x20enter\x20the\x20token','user1','OuRyU','uccBL','oQKDg','KYrEP','phant\x20auth\x20adapter','generate','shouldError','OBJECT_NOT_FOUND','PhantAuth\x20auth\x20is\x20invalid\x20for\x20this\x20user.','PrzSc','path','QYsvj','github','qbBjl','RfPvM','WIoCi','AVngu','KVHCA','toJSON','User','kfOwM','cBJue','reset','https://static.gc.apple.com/public-key/gc-prod-4.cer','validateAuthData\x20should\x20fail\x20with\x20invalid\x20auth','tNNBs','should\x20throw\x20error\x20with\x20missing\x20id_token','Secret','SItAK','DzqqrQ==','response\x20object\x20without\x20data\x20child','apple\x20signin\x20auth\x20adapter','https://accounts.google.com','future\x20logins\x20require\x20SMS\x20code','PcpUc','GMkTK','../lib/Config','spotify','AuthenticationProviders','ZEzbQ','TAZsW','pQaqx','VdflN','XAhiq','Model\x20should\x20be\x20a\x20Parse.User','rTYqZ','zLVFP','username','Missing\x20keycloak\x20configuration','dDBTy','should\x20not\x20validate\x20Symantec\x20Cert','eqKWI','fRxed','oYGYl','Basic\x20dXNlcm5hbWU6cGFzc3dvcmQ=','enabled','vCSfC','abcd','properly\x20loads\x20a\x20custom\x20adapter\x20with\x20options','toHaveBeenCalledWith','should\x20not\x20fail\x20fetching\x20the\x20session','cIlxO','GoBHc','sessionToken','OTP\x20SMS\x20auth\x20adatper','wXIcu','group1','logIn','wQlYG','Bearer\x20sometoken','KpwOP','hvkGF'];_0x3076=function(){return _0x47a986;};return _0x3076();}function _0xab88(_0x495c78,_0x1cd8d9){const _0x307629=_0x3076();return _0xab88=function(_0xab8806,_0xa50f22){_0xab8806=_0xab8806-0xfc;let _0x158753=_0x307629[_0xab8806];return _0x158753;},_0xab88(_0x495c78,_0x1cd8d9);}const _0x306e7c=_0xab88;(function(_0xb16844,_0x3fdc6c){const _0x208565=_0xab88,_0x17ea04=_0xb16844();while(!![]){try{const _0xb72395=-parseInt(_0x208565(0x1d0))/0x1*(-parseInt(_0x208565(0x21f))/0x2)+parseInt(_0x208565(0x264))/0x3+parseInt(_0x208565(0x1bc))/0x4+-parseInt(_0x208565(0x13a))/0x5*(-parseInt(_0x208565(0x27b))/0x6)+-parseInt(_0x208565(0x2b4))/0x7*(parseInt(_0x208565(0x3b0))/0x8)+-parseInt(_0x208565(0x153))/0x9+-parseInt(_0x208565(0x242))/0xa*(-parseInt(_0x208565(0x2cf))/0xb);if(_0xb72395===_0x3fdc6c)break;else _0x17ea04['push'](_0x17ea04['shift']());}catch(_0x286169){_0x17ea04['push'](_0x17ea04['shift']());}}}(_0x3076,0x48598));const request=require(_0x306e7c(0x10f)),Config=require(_0x306e7c(0x361)),defaultColumns=require(_0x306e7c(0x123))[_0x306e7c(0x140)],authenticationLoader=require(_0x306e7c(0x2ca)),path=require(_0x306e7c(0x347)),responses={'gpgames':{'playerId':_0x306e7c(0x21b)},'instagram':{'id':'userId'},'janrainengage':{'stat':'ok','profile':{'identifier':_0x306e7c(0x21b)}},'janraincapture':{'stat':'ok','result':_0x306e7c(0x21b)},'line':{'userId':_0x306e7c(0x21b)},'vkontakte':{'response':[{'id':_0x306e7c(0x21b)}]},'google':{'sub':_0x306e7c(0x21b)},'wechat':{'errcode':0x0},'weibo':{'uid':'userId'},'qq':'callback(\x20{\x22openid\x22:\x22userId\x22}\x20);','phantauth':{'sub':_0x306e7c(0x21b)},'microsoft':{'id':'userId','mail':_0x306e7c(0x30b)}};describe(_0x306e7c(0x363),function(){const _0x9af79a=_0x306e7c,_0x3c958f={'AehTt':_0x9af79a(0x2b1),'QhdRr':function(_0x43f7b2,_0x31f3d1,_0x3f8489){return _0x43f7b2(_0x31f3d1,_0x3f8489);},'zbmmJ':'function','xFvuj':function(_0x190c9b,_0x4e5496,_0x54abc7){return _0x190c9b(_0x4e5496,_0x54abc7);},'JXGWS':_0x9af79a(0x177),'tgnkt':function(_0x588e2c){return _0x588e2c();},'DBEes':_0x9af79a(0x20b),'FEzlh':_0x9af79a(0x164),'HLTSS':_0x9af79a(0x321),'jflRP':function(_0x4748cb,_0x24995e,_0x34d205){return _0x4748cb(_0x24995e,_0x34d205);},'RrxFj':_0x9af79a(0x156),'pTuWp':_0x9af79a(0x3bf),'ZdDlh':function(_0x3459de,_0x17017c){return _0x3459de+_0x17017c;},'WPkcV':function(_0x2547e2,_0x11489f){return _0x2547e2===_0x11489f;},'fknFw':_0x9af79a(0x24c),'quyOd':'userId','FPBjZ':_0x9af79a(0x1dc),'KpwOP':_0x9af79a(0x246),'tuKwP':_0x9af79a(0x2ed),'FYpWh':function(_0x286238,_0x40eb65){return _0x286238!==_0x40eb65;},'ttQty':_0x9af79a(0x276),'jWyJr':'12345','sojRi':function(_0x58c9d8,_0x5c44f3,_0x37d420){return _0x58c9d8(_0x5c44f3,_0x37d420);},'PVihQ':function(_0x17742f,_0x19c469,_0x2bb9cd,_0x57c6f5){return _0x17742f(_0x19c469,_0x2bb9cd,_0x57c6f5);},'GXEqx':function(_0x729585,_0x187aa0){return _0x729585!==_0x187aa0;},'NnAFs':'oRvkO','HZShV':function(_0x1c8efb,_0x6fcef9){return _0x1c8efb(_0x6fcef9);},'fKTqn':_0x9af79a(0x14e),'YkXyT':_0x9af79a(0x1e0),'kWzEL':_0x9af79a(0x18f),'hiaBP':function(_0x24b68a,_0x6e2ac0){return _0x24b68a(_0x6e2ac0);},'ivTyI':function(_0x1d2208,_0x32b988){return _0x1d2208(_0x32b988);},'qbBjl':_0x9af79a(0x379),'pszIl':_0x9af79a(0x464),'GMkTK':function(_0x185eb5,_0x37d30e){return _0x185eb5(_0x37d30e);},'KIPDS':function(_0x363170,_0x335c82){return _0x363170===_0x335c82;},'AqjhV':'Xgtvx','UnVNP':_0x9af79a(0x1b4),'ZEzbQ':function(_0x3a381f,_0x36e390){return _0x3a381f(_0x36e390);},'uqWAa':function(_0x10b38c,_0x415fe9){return _0x10b38c(_0x415fe9);},'QwvaL':function(_0x1e8f0e,_0x1197f9){return _0x1e8f0e(_0x1197f9);},'LSxVF':function(_0x570b59){return _0x570b59();},'OVuXg':_0x9af79a(0x3b8),'KhDAD':_0x9af79a(0x1d3),'JByrq':_0x9af79a(0x33c),'AoqJv':_0x9af79a(0x390),'TrmdT':_0x9af79a(0x1e4),'vslJD':function(_0x3b4c79,_0x573f9f){return _0x3b4c79(_0x573f9f);},'ADlLM':_0x9af79a(0x18e),'JFoHT':_0x9af79a(0x29e),'buybh':function(_0x4a083f,_0x415c2b){return _0x4a083f(_0x415c2b);},'lyvcK':function(_0x3e6169,_0x515b49,_0x3323cf){return _0x3e6169(_0x515b49,_0x3323cf);},'GjLla':'myoauth','SjTPk':_0x9af79a(0x2e6),'pHvSF':function(_0x5816c4,_0x5eed64,_0x5272df){return _0x5816c4(_0x5eed64,_0x5272df);},'gDRzv':_0x9af79a(0x3f8),'RRFPF':_0x9af79a(0x39d),'AmcLK':_0x9af79a(0x3de),'xOtpv':function(_0x4ce93b,_0x575476){return _0x4ce93b(_0x575476);},'htgMe':function(_0x36ab8d,_0x4e3b9e,_0x2c26ed){return _0x36ab8d(_0x4e3b9e,_0x2c26ed);},'nHyme':'User\x20id\x20should\x20have\x20a\x20value','jJwQC':_0x9af79a(0x129),'GunLe':'Expiration\x20should\x20have\x20a\x20value','EEiiJ':_0x9af79a(0x2ef),'TggWH':function(_0x1b8679,_0x3a8b18){return _0x1b8679==_0x3a8b18;},'aKvxU':_0x9af79a(0x258),'nVHtN':function(_0x115035){return _0x115035();},'fJWYN':_0x9af79a(0x16b),'KYynF':_0x9af79a(0x12c),'crTbq':_0x9af79a(0x25d),'VzGmM':function(_0x29d1b1,_0x36b5f5){return _0x29d1b1(_0x36b5f5);},'hBwgO':function(_0x1dbf2b,_0x220c33){return _0x1dbf2b===_0x220c33;},'eDXKX':_0x9af79a(0x2b3),'Ahrqj':_0x9af79a(0x199),'vmWnI':_0x9af79a(0x3e6),'efolh':_0x9af79a(0x239),'TsUcs':function(_0x1a40c2,_0x438b9f){return _0x1a40c2!==_0x438b9f;},'WIoCi':_0x9af79a(0x19f),'PrzSc':_0x9af79a(0x38a),'cDEZh':function(_0x1542f3,_0x4e25b3,_0x1c8e73){return _0x1542f3(_0x4e25b3,_0x1c8e73);},'IBAIG':_0x9af79a(0x13f),'xheRg':'facebook','zvbsa':_0x9af79a(0x44a),'grKXL':function(_0x2bdc15,_0xcee0d3,_0x66e1f3){return _0x2bdc15(_0xcee0d3,_0x66e1f3);},'bIluQ':function(_0x28451b,_0x820397){return _0x28451b(_0x820397);},'TvUSM':function(_0x2fb83a){return _0x2fb83a();},'VDOOH':'gcenter','LSqjQ':_0x9af79a(0x349),'TUYdA':_0x9af79a(0x450),'qUjCg':_0x9af79a(0x1f6),'SHFyp':function(_0x30cdb7,_0x4d5ecd,_0x50e607){return _0x30cdb7(_0x4d5ecd,_0x50e607);},'pVzKc':_0x9af79a(0x131),'NVrrQ':_0x9af79a(0x12a),'yTspg':function(_0x2970d7,_0x1e0836,_0x6d5d23){return _0x2970d7(_0x1e0836,_0x6d5d23);},'OYchs':_0x9af79a(0x461),'fwSki':_0x9af79a(0x295),'JqFPW':_0x9af79a(0x333),'kvyGO':function(_0x1e7cbb,_0x57b333,_0xe69dd3){return _0x1e7cbb(_0x57b333,_0xe69dd3);},'afxGL':function(_0x1de3bd,_0x1efada,_0xaabbbc){return _0x1de3bd(_0x1efada,_0xaabbbc);},'hDKbR':function(_0x3f670b,_0x33a70f,_0x4cb5ca){return _0x3f670b(_0x33a70f,_0x4cb5ca);}};[_0x9af79a(0x1f1),_0x3c958f[_0x9af79a(0x26f)],'gpgames',_0x9af79a(0x16e),_0x3c958f['LSqjQ'],_0x9af79a(0x155),_0x3c958f[_0x9af79a(0x312)],_0x3c958f['qUjCg'],_0x9af79a(0x189),_0x3c958f['DBEes'],_0x9af79a(0x1ef),'janraincapture',_0x9af79a(0x3c5),'vkontakte','qq',_0x9af79a(0x362),_0x9af79a(0x2ee),_0x9af79a(0x165),_0x9af79a(0x16f),_0x9af79a(0x3d2),_0x3c958f[_0x9af79a(0x160)]][_0x9af79a(0x470)](function(_0x4dd5e7){const _0x397a62=_0x9af79a,_0x5135b2={'TbLQo':_0x3c958f[_0x397a62(0x422)]};it(_0x3c958f[_0x397a62(0x3dc)]+_0x4dd5e7,_0x4c3943=>{const _0x109813=_0x397a62,_0x589453=require(_0x3c958f['AehTt']+_0x4dd5e7);_0x3c958f[_0x109813(0x1b3)](jequal,typeof _0x589453['validateAuthData'],_0x3c958f[_0x109813(0x25f)]),_0x3c958f[_0x109813(0x1f3)](jequal,typeof _0x589453[_0x109813(0x3b3)],_0x109813(0x184));const _0x50fb31=_0x589453['validateAuthData']({},{}),_0x1a69bd=_0x589453[_0x109813(0x3b3)](_0x109813(0x139),_0x3c958f[_0x109813(0x301)],{});_0x3c958f[_0x109813(0x1b3)](jequal,_0x50fb31[_0x109813(0x3ad)],Promise[_0x109813(0x1ea)][_0x109813(0x3ad)]),jequal(_0x1a69bd[_0x109813(0x3ad)],Promise[_0x109813(0x1ea)][_0x109813(0x3ad)]),_0x50fb31['then'](()=>{},()=>{}),_0x1a69bd[_0x109813(0x173)](()=>{},()=>{}),_0x3c958f[_0x109813(0x2f2)](_0x4c3943);}),it(_0x397a62(0x2f6)+_0x4dd5e7,async()=>{const _0x51665c=_0x397a62,_0x24535f={'tQxLr':function(_0x22c382,_0x1ae28e){return _0x22c382===_0x1ae28e;},'FYLYI':'access_token','DbCvn':'userId'},_0x41d378=[_0x3c958f['DBEes'],_0x51665c(0x1f1),_0x51665c(0x124),_0x51665c(0x450),_0x3c958f['FEzlh']];if(_0x41d378[_0x51665c(0x3ce)](_0x4dd5e7))return;spyOn(require(_0x51665c(0x156)),_0x3c958f[_0x51665c(0x456)])[_0x51665c(0x2fa)][_0x51665c(0x235)](_0x5bae1b=>{const _0x13804b=_0x51665c;if(_0x24535f['tQxLr'](_0x5bae1b,_0x13804b(0x2d3))||_0x5bae1b==='https://oauth.vk.com/access_token?client_id=appId&client_secret=appSecret&v=5.124&grant_type=client_credentials')return{'access_token':_0x24535f[_0x13804b(0x331)]};return Promise[_0x13804b(0x253)](responses[_0x4dd5e7]||{'id':_0x24535f[_0x13804b(0x3a1)]});}),_0x3c958f['jflRP'](spyOn,require(_0x3c958f[_0x51665c(0x269)]),_0x3c958f['pTuWp'])[_0x51665c(0x2fa)][_0x51665c(0x235)](()=>{const _0x5458ac=_0x51665c;return Promise['resolve'](responses[_0x4dd5e7]||{'id':_0x5135b2[_0x5458ac(0x236)]});});const _0x579460=require(_0x3c958f['ZdDlh'](_0x3c958f[_0x51665c(0x318)],_0x4dd5e7));let _0x379e7c={};_0x3c958f[_0x51665c(0x1e3)](_0x4dd5e7,_0x51665c(0x231))&&(_0x379e7c={'appIds':_0x3c958f[_0x51665c(0x1ad)],'appSecret':_0x51665c(0x26c)},await _0x579460[_0x51665c(0x25d)]({'id':_0x51665c(0x21b)},_0x379e7c),_0x379e7c['appVersion']='5.123'),await _0x579460[_0x51665c(0x25d)]({'id':'userId'},_0x379e7c);});});const _0x19c6cc=function(){const _0x2cbf2c=_0x9af79a,_0x322095={'pQaqx':_0x3c958f[_0x2cbf2c(0x2f9)],'abgoC':function(_0x38dc08,_0x4275b6){const _0x317f97=_0x2cbf2c;return _0x3c958f[_0x317f97(0x291)](_0x38dc08,_0x4275b6);},'bwgEd':_0x3c958f[_0x2cbf2c(0x16d)]};return{'authData':{'id':_0x3c958f[_0x2cbf2c(0x42a)],'access_token':_0x3c958f[_0x2cbf2c(0x42a)],'expiration_date':new Date()[_0x2cbf2c(0x34f)]()},'shouldError':![],'loggedOut':![],'synchronizedUserId':null,'synchronizedAuthToken':null,'synchronizedExpiration':null,'authenticate':function(_0x393d92){const _0x449b5f=_0x2cbf2c;if(this[_0x449b5f(0x343)])_0x393d92[_0x449b5f(0x1e8)](this,_0x3c958f[_0x449b5f(0x383)]);else this[_0x449b5f(0x213)]?_0x393d92['error'](this,null):_0x393d92[_0x449b5f(0x119)](this,this[_0x449b5f(0x416)]);},'restoreAuthentication':function(_0x642485){const _0x7c143f=_0x2cbf2c;if(!_0x642485)return this[_0x7c143f(0x23f)]=null,this[_0x7c143f(0x17e)]=null,this[_0x7c143f(0x23b)]=null,!![];return this[_0x7c143f(0x23f)]=_0x642485['id'],this[_0x7c143f(0x17e)]=_0x642485[_0x7c143f(0x24d)],this[_0x7c143f(0x23b)]=_0x642485[_0x7c143f(0x29d)],!![];},'getAuthType':function(){const _0xb028ca=_0x2cbf2c;return _0x322095[_0xb028ca(0x28f)](_0xb028ca(0x276),_0x322095[_0xb028ca(0x15f)])?_0x2908f0[_0xb028ca(0x253)]({'playerId':_0x322095[_0xb028ca(0x366)]}):_0xb028ca(0x3c4);},'deauthenticate':function(){const _0x5adcad=_0x2cbf2c;this[_0x5adcad(0x2f8)]=!![],this['restoreAuthentication'](null);}};};Parse[_0x9af79a(0x350)]['extend']({'extended':function(){return!![];}});const _0x4e56e4=function(_0x47b5b5){const _0xe2406=_0x9af79a;return _0x3c958f[_0xe2406(0x24f)](_0x3b5427,undefined,_0x47b5b5);},_0x3b5427=function(_0x194f5b,_0x3538d5){const _0x4f2eae=_0x9af79a,_0xb43c45={'ClWDK':function(_0x585091,_0x1f1390){return _0x3c958f['HZShV'](_0x585091,_0x1f1390);}},_0x1969db={'authData':{'myoauth':_0x3c958f[_0x4f2eae(0x2f2)](_0x19c6cc)[_0x4f2eae(0x416)]}},_0x3daabf={'method':'POST','headers':{'X-Parse-Application-Id':'test','X-Parse-REST-API-Key':_0x3c958f['fKTqn'],'X-Parse-Installation-Id':_0x3c958f[_0x4f2eae(0x278)],'X-Parse-Session-Token':_0x194f5b,'Content-Type':_0x4f2eae(0x215)},'url':_0x3c958f['kWzEL'],'body':_0x1969db};return request(_0x3daabf)['then'](_0x1ae27c=>{const _0x187daa=_0x4f2eae;return _0x3538d5&&_0x3c958f[_0x187daa(0x19e)](_0x3538d5,null,_0x1ae27c,_0x1ae27c[_0x187daa(0x25c)]),{'res':_0x1ae27c,'body':_0x1ae27c[_0x187daa(0x25c)]};})[_0x4f2eae(0x1fb)](_0x5e1ccc=>{const _0x5cde1b=_0x4f2eae,_0x496183={'XAhiq':function(_0x2390da,_0x228f15){return _0x2390da(_0x228f15);},'IcFvo':function(_0x529be9){return _0x529be9();}};if(_0x3c958f['GXEqx'](_0x5cde1b(0x43f),_0x3c958f['NnAFs'])){_0x3538d5&&_0x3538d5(_0x5e1ccc);throw _0x5e1ccc;}else{_0x548567(_0x55b0e9)[_0x5cde1b(0x2ea)](null);const _0x3601b6=_0x5b9b88;_0x551662(_0x3601b6['objectId'])[_0x5cde1b(0x267)][_0x5cde1b(0x13d)](),_0xb43c45['ClWDK'](_0xc2d2fa,_0x3601b6[_0x5cde1b(0x31d)])[_0x5cde1b(0x267)][_0x5cde1b(0x2cc)](),_0x365c8d=_0x3601b6[_0x5cde1b(0x31d)],_0xb43c45['ClWDK'](_0x588686,(_0x690522,_0x561ff4,_0x7f2e40)=>{const _0x313613=_0x5cde1b;_0x17b2ba(_0x690522)['toBe'](null);const _0x4ef050=_0x7f2e40;_0x496183[_0x313613(0x368)](_0x595864,_0x4ef050[_0x313613(0x31d)])[_0x313613(0x267)]['toBeNull'](),_0x3b5ee4(_0x4ef050[_0x313613(0x31d)])['not'][_0x313613(0x2cc)](),_0x496183['XAhiq'](_0x6f6612,_0x4ef050[_0x313613(0x31d)])[_0x313613(0x2ea)](_0x4bc6cc),_0x496183[_0x313613(0x1e1)](_0x28c5ac);});}});};_0x3c958f['SHFyp'](it,_0x9af79a(0x2b8),_0x39f995=>{const _0x23b5ee=_0x9af79a,_0x248204={'Svvap':_0x3c958f[_0x23b5ee(0x34a)],'PfoJP':function(_0x127572){return _0x127572();},'MCkMA':_0x3c958f[_0x23b5ee(0x257)],'NCTvn':_0x23b5ee(0x194),'CUnWx':_0x23b5ee(0x3f0),'qyyZm':function(_0x16d446,_0x3ca420){return _0x16d446(_0x3ca420);},'JpXio':function(_0x32343a){return _0x32343a();}};_0x3c958f[_0x23b5ee(0x1e3)]('YqCpZ',_0x23b5ee(0x32f))?_0x2fe94d[_0x23b5ee(0x1e8)](this,_0x23b5ee(0x246)):_0x3c958f[_0x23b5ee(0x360)](_0x4e56e4,(_0x192b56,_0x4ebd6a,_0x18cfba)=>{const _0x57ac06=_0x23b5ee;_0x3c958f[_0x57ac06(0x29f)](expect,_0x192b56)[_0x57ac06(0x2ea)](null);const _0x36abfb=_0x18cfba;_0x3c958f[_0x57ac06(0x2f3)](ok,_0x36abfb[_0x57ac06(0x37c)]),_0x3c958f['hiaBP'](expect,_0x36abfb['objectId'])['not'][_0x57ac06(0x13d)](),_0x3c958f[_0x57ac06(0x2ec)](expect,_0x36abfb['objectId'])['not'][_0x57ac06(0x2cc)]();const _0x187dea=_0x36abfb[_0x57ac06(0x37c)],_0xd8a0a7=new Parse[(_0x57ac06(0x22c))]('_Session');_0xd8a0a7['equalTo'](_0x57ac06(0x37c),_0x187dea),_0xd8a0a7[_0x57ac06(0x3ac)]({'useMasterKey':!![]})[_0x57ac06(0x173)](_0x13552c=>{const _0x26a433=_0x57ac06;if(!_0x13552c){fail(_0x248204['Svvap']),_0x248204[_0x26a433(0x12e)](_0x39f995);return;}expect(_0x13552c[_0x26a433(0x321)](_0x248204[_0x26a433(0x3b9)]))['toEqual'](_0x26a433(0x1e0)),_0x39f995();})[_0x57ac06(0x1fb)](()=>{const _0x32703d=_0x57ac06;_0x248204[_0x32703d(0x3d9)]!==_0x248204[_0x32703d(0x1aa)]?(_0x248204[_0x32703d(0x20e)](fail,'should\x20not\x20fail\x20fetching\x20the\x20session'),_0x248204[_0x32703d(0x10d)](_0x39f995)):_0x3d0ef0['error'](this,null);});});}),_0x3c958f[_0x9af79a(0x30c)](it,_0x3c958f['pVzKc'],_0x1787c0=>{const _0x5a77f4=_0x9af79a;if('AKduD'!==_0x3c958f[_0x5a77f4(0x144)]){let _0x342bf1;_0x3c958f[_0x5a77f4(0x2ec)](_0x4e56e4,(_0x2b6611,_0x1bf19a,_0x30ef0f)=>{const _0x55c1d7=_0x5a77f4,_0x3706a4={'YduGD':function(_0x202f92,_0x4ad36e){const _0x46508b=_0xab88;return _0x3c958f[_0x46508b(0x141)](_0x202f92,_0x4ad36e);},'OCpAf':_0x3c958f[_0x55c1d7(0x1d4)],'KrjOR':function(_0x16cdc2,_0x1509d7){return _0x3c958f['ivTyI'](_0x16cdc2,_0x1509d7);}};if(_0x55c1d7(0x17a)===_0x55c1d7(0x17a)){_0x3c958f[_0x55c1d7(0x29f)](expect,_0x2b6611)[_0x55c1d7(0x2ea)](null);const _0x1ad902=_0x30ef0f;expect(_0x1ad902['objectId'])[_0x55c1d7(0x267)][_0x55c1d7(0x13d)](),expect(_0x1ad902[_0x55c1d7(0x31d)])['not'][_0x55c1d7(0x2cc)](),_0x342bf1=_0x1ad902['objectId'],_0x3c958f[_0x55c1d7(0x29f)](_0x4e56e4,(_0x9a3b18,_0x20c363,_0x41d464)=>{const _0x52d46c=_0x55c1d7,_0x300dd4={'WuhGE':function(_0x491b10,_0x167ace){return _0x491b10(_0x167ace);},'SQyMw':_0x52d46c(0x2ab)};if(_0x3706a4[_0x52d46c(0x3fa)](_0x3706a4[_0x52d46c(0x336)],_0x3706a4[_0x52d46c(0x336)])){expect(_0x9a3b18)[_0x52d46c(0x2ea)](null);const _0x3ff838=_0x41d464;_0x3706a4[_0x52d46c(0x39a)](expect,_0x3ff838['objectId'])[_0x52d46c(0x267)][_0x52d46c(0x13d)](),expect(_0x3ff838['objectId'])[_0x52d46c(0x267)][_0x52d46c(0x2cc)](),_0x3706a4[_0x52d46c(0x39a)](expect,_0x3ff838[_0x52d46c(0x31d)])['toBe'](_0x342bf1),_0x1787c0();}else _0x300dd4['WuhGE'](_0x817718,_0x45df61['message'])[_0x52d46c(0x2ea)](_0x300dd4['SQyMw']);});}else return _0x7e1358[_0x55c1d7(0x253)]({'data':{'sub':_0x55c1d7(0x38f),'roles':['role1'],'groups':[_0x55c1d7(0x425)]}});});}else return this[_0x5a77f4(0x23f)]=null,this[_0x5a77f4(0x17e)]=null,this[_0x5a77f4(0x23b)]=null,!![];}),it(_0x3c958f[_0x9af79a(0x1c3)],_0x4f5436=>{const _0x514c57=_0x9af79a;_0x3c958f[_0x514c57(0x38b)]===_0x3c958f[_0x514c57(0x38b)]?Parse['User'][_0x514c57(0x294)](_0x514c57(0x1c8),_0x3c958f[_0x514c57(0x2f7)])[_0x514c57(0x173)](_0x3b0b15=>{const _0x517cc7=_0x514c57;return _0x3b5427(_0x3b0b15[_0x517cc7(0x2a6)]());})[_0x514c57(0x173)](()=>{const _0x144963=_0x514c57;return Parse[_0x144963(0x350)]['logOut']();})['then'](()=>{const _0x56aa68=_0x514c57;return Parse['User'][_0x56aa68(0x294)](_0x56aa68(0x2e2),'password');})['then'](_0x4aaf3d=>{const _0x5f499f=_0x514c57;return _0x3c958f[_0x5f499f(0x364)](_0x3b5427,_0x4aaf3d[_0x5f499f(0x2a6)]());})[_0x514c57(0x173)](fail,({data:_0x16c600})=>{const _0x561b6b=_0x514c57;_0x3c958f['uqWAa'](expect,_0x16c600[_0x561b6b(0x26b)])[_0x561b6b(0x2ea)](0xd0),_0x3c958f[_0x561b6b(0x22b)](expect,_0x16c600[_0x561b6b(0x1e8)])[_0x561b6b(0x2ea)]('this\x20auth\x20is\x20already\x20used'),_0x3c958f[_0x561b6b(0x28b)](_0x4f5436);})[_0x514c57(0x1fb)](_0x4f5436[_0x514c57(0x334)]):_0x4eba5e(_0x2c0bdd[_0x514c57(0x1d1)])[_0x514c57(0x2ea)](_0x514c57(0x444));}),it(_0x9af79a(0x38d),async()=>{const _0x144169=_0x9af79a;if(_0x3c958f[_0x144169(0x141)](_0x144169(0x2dd),_0x144169(0x2dd))){const _0x206946={'validateAppId':()=>Promise[_0x144169(0x253)](),'validateAuthData':()=>Promise['resolve']()},_0x1e993a={'authData':{'id':_0x3c958f[_0x144169(0x146)],'token':'fakeToken'}},_0x4646ca={'authData':{'id':_0x144169(0x33c),'token':_0x144169(0x1a3)}};await reconfigureServer({'auth':{'fakeAuthProvider':_0x206946}});const _0x562573=await Parse[_0x144169(0x350)][_0x144169(0x27d)]('fakeAuthProvider',_0x1e993a),_0x4a16d7=await Parse['User'][_0x144169(0x27d)]('fakeAuthProvider',_0x1e993a,{'sessionToken':_0x562573[_0x144169(0x2a6)]()}),_0x2d0504=await Parse['User'][_0x144169(0x27d)](_0x3c958f[_0x144169(0x2d9)],_0x4646ca,{'sessionToken':_0x4a16d7[_0x144169(0x2a6)]()});expect(_0x562573['id'])[_0x144169(0x452)](_0x4a16d7['id']),_0x3c958f[_0x144169(0x24a)](expect,_0x562573['id'])['toEqual'](_0x2d0504['id']);}else{const _0x4f1dee='4|0|3|1|2'[_0x144169(0x2af)]('|');let _0xdb76f1=0x0;while(!![]){switch(_0x4f1dee[_0xdb76f1++]){case'0':this[_0x144169(0x23f)]=_0x6630b6['id'];continue;case'1':this[_0x144169(0x23b)]=_0x100b0e[_0x144169(0x29d)];continue;case'2':return!![];case'3':this[_0x144169(0x17e)]=_0x5155f0[_0x144169(0x24d)];continue;case'4':if(!_0xb94809)return this[_0x144169(0x23f)]=null,this[_0x144169(0x17e)]=null,this['synchronizedExpiration']=null,!![];continue;}break;}}}),_0x3c958f[_0x9af79a(0x265)](it,_0x3c958f[_0x9af79a(0x11b)],async()=>{const _0x3db9e9=_0x9af79a,_0x4deb57={'validateAppId':()=>!![],'appIds':_0x3db9e9(0x1e4),'validateAuthData':()=>Promise[_0x3db9e9(0x253)]()},_0x594619={'appIds':_0x3c958f[_0x3db9e9(0x22e)],'validateAppId':()=>Promise[_0x3db9e9(0x253)](!![]),'validateAuthData':()=>Promise['resolve']()},_0x5c742c={'authData':{'id':_0x3db9e9(0x33c),'token':'fakeToken'}},_0x57e32b=spyOn(_0x4deb57,_0x3db9e9(0x3b3)),_0x2417ce=_0x3c958f[_0x3db9e9(0x1f3)](spyOn,_0x594619,_0x3db9e9(0x3b3));await _0x3c958f[_0x3db9e9(0x3e4)](reconfigureServer,{'auth':{'asyncProvider':_0x594619,'syncProvider':_0x4deb57}});const _0x2bf458=await Parse[_0x3db9e9(0x350)][_0x3db9e9(0x27d)](_0x3c958f[_0x3db9e9(0x421)],_0x5c742c),_0x1cc8cc=await Parse[_0x3db9e9(0x350)][_0x3db9e9(0x27d)](_0x3c958f[_0x3db9e9(0x1d6)],_0x5c742c);_0x3c958f[_0x3db9e9(0x315)](expect,_0x2bf458[_0x3db9e9(0x2a6)]())[_0x3db9e9(0x38e)](),expect(_0x1cc8cc[_0x3db9e9(0x2a6)]())['toBeDefined'](),_0x3c958f[_0x3db9e9(0x24a)](expect,_0x57e32b)[_0x3db9e9(0x296)](0x1),_0x3c958f['HZShV'](expect,_0x2417ce)[_0x3db9e9(0x296)](0x1);}),it(_0x9af79a(0x3bc),async()=>{const _0x282741=_0x9af79a,_0xcc435c=_0x19c6cc();Parse['User'][_0x282741(0x2e8)](_0xcc435c);const _0x4ec228=await Parse['User']['_logInWith'](_0x282741(0x3c4));ok(_0x4ec228 instanceof Parse['User'],_0x282741(0x369)),strictEqual(Parse[_0x282741(0x350)][_0x282741(0x2e9)](),_0x4ec228),ok(_0x4ec228['extended'](),_0x282741(0x254)),_0x3c958f['lyvcK'](strictEqual,_0xcc435c[_0x282741(0x416)]['id'],_0xcc435c[_0x282741(0x23f)]),_0x3c958f[_0x282741(0x24f)](strictEqual,_0xcc435c[_0x282741(0x416)][_0x282741(0x24d)],_0xcc435c[_0x282741(0x17e)]),strictEqual(_0xcc435c[_0x282741(0x416)][_0x282741(0x29d)],_0xcc435c[_0x282741(0x23b)]),ok(_0x4ec228[_0x282741(0x413)](_0x3c958f['GjLla']),_0x282741(0x152)),await _0x4ec228[_0x282741(0x31c)](_0x3c958f[_0x282741(0x283)]),ok(!_0x4ec228[_0x282741(0x413)](_0x3c958f[_0x282741(0x283)]),_0x282741(0x130)),ok(!_0xcc435c[_0x282741(0x23f)],_0x3c958f[_0x282741(0x225)]),_0x3c958f[_0x282741(0x42f)](ok,!_0xcc435c[_0x282741(0x17e)],_0x3c958f['gDRzv']),ok(!_0xcc435c[_0x282741(0x23b)],_0x3c958f[_0x282741(0x3cc)]);const _0x687da2=Config[_0x282741(0x321)](Parse[_0x282741(0xfe)]),_0x304eed=await _0x687da2[_0x282741(0x3f6)][_0x282741(0x32a)][_0x282741(0x3f7)](_0x3c958f['AmcLK'],{'fields':Object['assign']({},defaultColumns[_0x282741(0x221)],defaultColumns[_0x282741(0x19a)])},{'objectId':_0x4ec228['id']},{});_0x3c958f['xOtpv'](expect,_0x304eed[_0x282741(0x288)])[_0x282741(0x2ea)](0x1),_0x3c958f['xOtpv'](expect,_0x304eed[0x0][_0x282741(0x3e7)])[_0x282741(0x2cc)](),expect(_0x304eed[0x0][_0x282741(0x3e7)])['not']['toBeNull'](),await _0x4ec228['_linkWith'](_0x282741(0x3c4)),_0x3c958f[_0x282741(0x323)](ok,_0xcc435c['synchronizedUserId'],_0x3c958f[_0x282741(0x14b)]),ok(_0xcc435c['synchronizedAuthToken'],_0x3c958f[_0x282741(0x47c)]),ok(_0xcc435c[_0x282741(0x23b)],_0x3c958f['GunLe']),ok(_0x4ec228[_0x282741(0x413)](_0x282741(0x3c4)),_0x282741(0x152));});function _0x457596(_0x5e7b11){const _0x92782=_0x9af79a;expect(typeof _0x5e7b11)[_0x92782(0x2ea)](_0x3c958f[_0x92782(0x25f)]);}function _0x1532b6(_0x1bc91a){const _0x3902b7=_0x9af79a;expect(_0x1bc91a)[_0x3902b7(0x267)]['toBeUndefined'](),_0x3c958f[_0x3902b7(0x437)](expect,typeof _0x1bc91a[_0x3902b7(0x40e)])[_0x3902b7(0x2ea)](_0x3c958f[_0x3902b7(0x25f)]),expect(typeof _0x1bc91a['getValidatorForProvider'])[_0x3902b7(0x2ea)](_0x3c958f['zbmmJ']);}function _0x505894(_0x19b3cc){const _0x35db48=_0x9af79a;if(_0x3c958f['EEiiJ']==='LxbVM'){expect(_0x19b3cc)['not']['toBeUndefined']();if(!_0x19b3cc)return;expect(typeof _0x19b3cc[_0x35db48(0x25d)])[_0x35db48(0x2ea)](_0x3c958f[_0x35db48(0x25f)]),expect(typeof _0x19b3cc[_0x35db48(0x3b3)])[_0x35db48(0x2ea)](_0x35db48(0x184));}else return _0x4c4906['resolve']({'active':!![],'sub':_0x35db48(0x38f)});}it(_0x3c958f['fwSki'],_0x1392c9=>{const _0x4fc60e=_0x9af79a,_0x57d568={'tLgWF':function(_0x3a1029,_0xd04590){return _0x3a1029(_0xd04590);},'EeSYI':_0x3c958f[_0x4fc60e(0x31e)],'UOTVe':function(_0x265614){const _0xb12260=_0x4fc60e;return _0x3c958f[_0xb12260(0x2fd)](_0x265614);}},_0x8ff9c4={'id':_0x3c958f[_0x4fc60e(0x47b)],'token':_0x3c958f[_0x4fc60e(0x210)]},_0x399acd={'validateAppId':function(){return Promise['resolve']();},'validateAuthData':function(_0x230806){const _0x3c55a7=_0x4fc60e;if(_0x3c958f[_0x3c55a7(0x151)](_0x230806['id'],_0x8ff9c4['id'])&&_0x230806[_0x3c55a7(0x2df)]==_0x8ff9c4[_0x3c55a7(0x2df)])return Promise[_0x3c55a7(0x253)]();return Promise[_0x3c55a7(0x3fb)]();}},_0x1076bf=spyOn(_0x399acd,_0x3c958f[_0x4fc60e(0x233)])[_0x4fc60e(0x2fa)][_0x4fc60e(0x2ad)](),_0x4bba0b=spyOn(_0x399acd,_0x4fc60e(0x3b3))[_0x4fc60e(0x2fa)]['callThrough'](),_0x20f906=_0x3c958f[_0x4fc60e(0x202)](authenticationLoader,{'customAuthentication':_0x399acd});_0x3c958f[_0x4fc60e(0x437)](_0x1532b6,_0x20f906);const {validator:_0x187ed2}=_0x20f906[_0x4fc60e(0x40e)](_0x4fc60e(0x2b3));_0x3c958f['ivTyI'](_0x457596,_0x187ed2),_0x187ed2(_0x8ff9c4,{},{})[_0x4fc60e(0x173)](()=>{const _0x17579f=_0x4fc60e,_0xfa12a9={'VbhRH':function(_0x51a9d6,_0x4de39f){return _0x57d568['tLgWF'](_0x51a9d6,_0x4de39f);}};'Ngkzy'===_0x57d568[_0x17579f(0x17d)]?(expect(_0x1076bf)['toHaveBeenCalled'](),expect(_0x4bba0b)[_0x17579f(0x267)][_0x17579f(0x319)](),_0x57d568[_0x17579f(0x209)](_0x1392c9)):_0xfa12a9[_0x17579f(0x387)](_0x1f65ad,_0x43d0b2[_0x17579f(0x1d1)])[_0x17579f(0x2ea)](_0x17579f(0x2ab));},_0xd4f38b=>{jfail(_0xd4f38b),_0x1392c9();});}),_0x3c958f[_0x9af79a(0x42f)](it,_0x3c958f['JqFPW'],_0x3abe48=>{const _0x5590d5=_0x9af79a,_0x250f02={'QljuU':function(_0x57e5ad){const _0x204828=_0xab88;return _0x3c958f[_0x204828(0x2fd)](_0x57e5ad);},'QGvPi':function(_0x4534f0,_0xf2a282){return _0x3c958f['hBwgO'](_0x4534f0,_0xf2a282);}},_0x24a6bc=authenticationLoader({'customAuthentication':path[_0x5590d5(0x253)](_0x5590d5(0x1bb))});_0x1532b6(_0x24a6bc);const {validator:_0x26534c}=_0x24a6bc[_0x5590d5(0x40e)](_0x3c958f[_0x5590d5(0x26e)]);_0x3c958f[_0x5590d5(0x315)](_0x457596,_0x26534c),_0x3c958f['PVihQ'](_0x26534c,{'token':_0x5590d5(0x3be)},{},{})[_0x5590d5(0x173)](()=>{const _0x2fb0cd=_0x5590d5;_0x250f02[_0x2fb0cd(0x3da)](_0x3abe48);},_0x2b5371=>{const _0x15ef73=_0x5590d5;if(_0x250f02[_0x15ef73(0x435)](_0x15ef73(0x3d7),_0x15ef73(0x126)))return _0x22c30a[_0x15ef73(0x253)]();else jfail(_0x2b5371),_0x250f02[_0x15ef73(0x3da)](_0x3abe48);});}),_0x3c958f[_0x9af79a(0x1f3)](it,_0x9af79a(0x43e),_0x294e8c=>{const _0x18f867=_0x9af79a,_0x3ebd6a={'ZsJBF':function(_0x395229){const _0x58f5e6=_0xab88;return _0x3c958f[_0x58f5e6(0x28b)](_0x395229);}},_0x548287=authenticationLoader({'customAuthentication':{'module':path[_0x18f867(0x253)](_0x3c958f[_0x18f867(0x133)]),'options':{'token':_0x18f867(0x3e6)}}});_0x1532b6(_0x548287);const {validator:_0xb2f47e}=_0x548287[_0x18f867(0x40e)](_0x18f867(0x2b3));_0x457596(_0xb2f47e),_0xb2f47e({'token':_0x3c958f['vmWnI']},{},{})[_0x18f867(0x173)](()=>{_0x3ebd6a['ZsJBF'](_0x294e8c);},_0x4e2261=>{jfail(_0x4e2261),_0x294e8c();});}),it('properly\x20loads\x20a\x20default\x20adapter\x20with\x20options',()=>{const _0x15d039=_0x9af79a,_0x51317a={'facebook':{'appIds':['a','b'],'appSecret':_0x3c958f['efolh']}},{adapter:_0x42b29d,appIds:_0x33a36f,providerOptions:_0x66290}=authenticationLoader['loadAuthAdapter']('facebook',_0x51317a);_0x505894(_0x42b29d),expect(_0x33a36f)[_0x15d039(0x452)](['a','b']),expect(_0x66290)[_0x15d039(0x452)](_0x51317a[_0x15d039(0x16e)]);}),_0x3c958f[_0x9af79a(0x427)](it,_0x9af79a(0x1d9),async()=>{const _0x905858=_0x9af79a,_0x70c769={'Ccpgn':_0x3c958f[_0x905858(0x346)],'NOYgv':_0x905858(0x1e5),'IUNdW':'appId','nuIWx':function(_0x1c1f86,_0x42c3b3){return _0x1c1f86(_0x42c3b3);},'HvjOM':'Basic\x20dXNlcm5hbWU6cGFzc3dvcmQ='},_0x848cc0=require(_0x3c958f[_0x905858(0x269)]);_0x3c958f['cDEZh'](spyOn,_0x848cc0,_0x3c958f['HLTSS'])[_0x905858(0x2fa)][_0x905858(0x235)](()=>{const _0x13be4f=_0x905858;if(_0x3c958f[_0x13be4f(0x3c7)](_0x3c958f[_0x13be4f(0x34c)],_0x3c958f['WIoCi'])){const _0x1e1920={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x70c769[_0x13be4f(0x1b0)],'useridField':_0x70c769[_0x13be4f(0x3db)],'appidField':_0x70c769['IUNdW'],'appIds':['a','b'],'authorizationHeader':_0x13be4f(0x373),'debug':!![]}},_0x410acf=_0xfc0fc[_0x13be4f(0x103)](_0x13be4f(0x1fc),_0x1e1920),_0x421a29=_0x410acf[_0x13be4f(0x2cb)],_0x36f0b9=_0x410acf[_0x13be4f(0x268)];_0x43dcf9(_0x36f0b9[_0x13be4f(0x2cd)])[_0x13be4f(0x452)](_0x70c769[_0x13be4f(0x1b0)]),_0x5ba9c1(_0x36f0b9[_0x13be4f(0x15a)])['toEqual'](_0x70c769[_0x13be4f(0x3db)]),_0xb66a2(_0x36f0b9['appidField'])[_0x13be4f(0x452)](_0x13be4f(0x24c)),_0x70c769['nuIWx'](_0x7e7202,_0x421a29)[_0x13be4f(0x452)](['a','b']),_0x70c769[_0x13be4f(0x3a0)](_0x1343f4,_0x36f0b9[_0x13be4f(0x186)])[_0x13be4f(0x452)](_0x70c769[_0x13be4f(0x3e1)]),_0x70c769['nuIWx'](_0x416a5f,_0x36f0b9[_0x13be4f(0x243)])['toEqual'](!![]);}else return Promise[_0x13be4f(0x253)]({'id':'a'});});const _0x50e067={'facebook':{'appIds':['a','b'],'appSecret':'secret_sauce'}},_0x1d0523={'access_token':_0x3c958f[_0x905858(0x12f)]},{adapter:_0x488457,appIds:_0x3d325d,providerOptions:_0x20bbf8}=authenticationLoader[_0x905858(0x103)](_0x3c958f[_0x905858(0x414)],_0x50e067);await _0x488457[_0x905858(0x3b3)](_0x3d325d,_0x1d0523,_0x20bbf8),_0x3c958f[_0x905858(0x437)](expect,_0x848cc0['get'][_0x905858(0x2f1)]['first']()['args'][0x0]['includes'](_0x905858(0x3ef)))['toBe'](!![]);}),_0x3c958f[_0x9af79a(0x31f)](it,_0x9af79a(0x3d6),async()=>{const _0x47d5c7=_0x9af79a,_0x149fd0=_0x3c958f[_0x47d5c7(0x22b)](require,_0x3c958f[_0x47d5c7(0x269)]);spyOn(_0x149fd0,_0x47d5c7(0x321))['and']['callFake'](()=>{return Promise['resolve']({'id':'a'});});const _0x27a56d={'facebook':{'appIds':'abcd','appSecret':'secret_sauce'}},_0x5a6abb={'access_token':_0x3c958f[_0x47d5c7(0x12f)]},{adapter:_0x453323,appIds:_0x306b6f,providerOptions:_0x28ad87}=authenticationLoader[_0x47d5c7(0x103)](_0x47d5c7(0x16e),_0x27a56d);await expectAsync(_0x453323[_0x47d5c7(0x3b3)](_0x306b6f,_0x5a6abb,_0x28ad87))['toBeRejectedWith'](new Parse[(_0x47d5c7(0x2d8))](Parse[_0x47d5c7(0x2d8)][_0x47d5c7(0x344)],_0x47d5c7(0x218)));}),it(_0x9af79a(0x304),async()=>{const _0x101083=_0x9af79a,_0x294284=_0x3c958f[_0x101083(0x360)](require,_0x3c958f[_0x101083(0x269)]);_0x3c958f[_0x101083(0x338)](spyOn,_0x294284,_0x3c958f['HLTSS'])[_0x101083(0x2fa)][_0x101083(0x235)](()=>{const _0x1c82a5=_0x101083;if(_0x3c958f[_0x1c82a5(0x3df)]===_0x1c82a5(0x24b))_0x1eacf4();else return Promise[_0x1c82a5(0x253)]();});const _0x201208={'facebook':{'appIds':['a','b'],'appSecret':_0x101083(0x45e)}},_0x4db3bb={'id':_0x3c958f[_0x101083(0x22e)],'access_token':_0x3c958f[_0x101083(0x22e)]},{adapter:_0x1270b6,providerOptions:_0x2b0c06}=authenticationLoader[_0x101083(0x103)]('facebook',_0x201208);await _0x1270b6['validateAuthData'](_0x4db3bb,_0x2b0c06),expect(_0x294284[_0x101083(0x321)][_0x101083(0x2f1)][_0x101083(0x3ac)]()[_0x101083(0x120)][0x0][_0x101083(0x3ce)](_0x101083(0x3ef)))[_0x101083(0x2ea)](!![]);}),_0x3c958f[_0x9af79a(0x3b4)](it,_0x9af79a(0x377),()=>{const _0x3c18ad=_0x9af79a,_0x254d7f={'custom':{'validateAppId':()=>{},'validateAuthData':()=>{},'appIds':['a','b']}},{adapter:_0x2a907f,appIds:_0x28bbe8,providerOptions:_0xb16994}=authenticationLoader[_0x3c18ad(0x103)](_0x3c18ad(0x26a),_0x254d7f);_0x3c958f[_0x3c18ad(0x437)](_0x505894,_0x2a907f),expect(_0x28bbe8)[_0x3c18ad(0x452)](['a','b']),_0x3c958f[_0x3c18ad(0x22b)](expect,_0xb16994)[_0x3c18ad(0x452)](_0x254d7f['custom']);}),_0x3c958f[_0x9af79a(0x1f3)](it,'can\x20disable\x20provider',async()=>{const _0x4160dc=_0x9af79a;await _0x3c958f['bIluQ'](reconfigureServer,{'auth':{'myoauth':{'enabled':![],'module':path[_0x4160dc(0x253)](__dirname,'support/myoauth')}}});const _0x11229=_0x3c958f['TvUSM'](_0x19c6cc);Parse[_0x4160dc(0x350)][_0x4160dc(0x2e8)](_0x11229),await expectAsync(Parse[_0x4160dc(0x350)][_0x4160dc(0x473)](_0x3c958f[_0x4160dc(0x283)]))[_0x4160dc(0x289)](new Parse[(_0x4160dc(0x2d8))](Parse[_0x4160dc(0x2d8)]['UNSUPPORTED_SERVICE'],'This\x20authentication\x20method\x20is\x20unsupported.'));});}),describe(_0x306e7c(0x100),()=>{const _0xad20f=_0x306e7c,_0x413f65={'LRynG':function(_0x39147b,_0x2e7eae){return _0x39147b===_0x2e7eae;},'qlfMQ':'userId','QPURF':function(_0x5ebbe6,_0x2e97d9,_0x4e98d8){return _0x5ebbe6(_0x2e97d9,_0x4e98d8);},'bgDZv':_0xad20f(0x175),'mxClC':_0xad20f(0x285),'dtcWf':function(_0x491e13,_0x3a7b73){return _0x491e13===_0x3a7b73;},'yxukq':_0xad20f(0x3ed),'qBZgF':_0xad20f(0x18c),'QYsvj':'get','xLUtI':function(_0x1ab92c,_0x4982f0){return _0x1ab92c(_0x4982f0);},'fRxed':_0xad20f(0x250),'OeRzF':'../lib/Adapters/Auth/instagram','KTKQV':_0xad20f(0x156),'UnsOg':_0xad20f(0x18a),'bLvth':_0xad20f(0x35b),'wUpcp':function(_0x3d7c94,_0xf39d16,_0x3fd1ea){return _0x3d7c94(_0xf39d16,_0x3fd1ea);}},_0x4fc274=_0x413f65['xLUtI'](require,_0x413f65['OeRzF']),_0x21c3f2=require(_0x413f65[_0xad20f(0x2c8)]);it(_0x413f65[_0xad20f(0x228)],async()=>{const _0xacba71=_0xad20f,_0x3f05be={'gxSHG':function(_0x355e91,_0x23a768){return _0x355e91(_0x23a768);},'gplpn':_0xacba71(0x405)};'dWNxB'!==_0xacba71(0x38c)?_0x3f05be[_0xacba71(0x3c1)](_0x1c3c32,_0x3274a5['message'])['toBe'](_0x3f05be[_0xacba71(0x396)]):(_0x413f65[_0xacba71(0x179)](spyOn,_0x21c3f2,_0xacba71(0x321))['and'][_0xacba71(0x235)](()=>{const _0x166b37=_0xacba71;if(_0x413f65['LRynG'](_0x166b37(0x1c7),_0x166b37(0x1c7)))return Promise['resolve']({'data':{'id':_0x413f65[_0x166b37(0x223)]}});else _0x2f6f8b(_0xe36106['message'])[_0x166b37(0x2ea)](_0x3f05be[_0x166b37(0x396)]);}),await _0x4fc274[_0xacba71(0x25d)]({'id':_0xacba71(0x21b),'access_token':_0x413f65['bgDZv']},{}),expect(_0x21c3f2[_0xacba71(0x321)])['toHaveBeenCalledWith'](_0x413f65[_0xacba71(0x401)]));}),it(_0x413f65['bLvth'],async()=>{const _0x114aa1=_0xad20f;_0x413f65['QPURF'](spyOn,_0x21c3f2,_0x114aa1(0x321))[_0x114aa1(0x2fa)][_0x114aa1(0x235)](()=>{const _0x2aabc8=_0x114aa1;return Promise[_0x2aabc8(0x253)]({'id':_0x413f65['qlfMQ']});}),await _0x4fc274[_0x114aa1(0x25d)]({'id':'userId','access_token':_0x413f65[_0x114aa1(0x41d)]},{}),expect(_0x21c3f2[_0x114aa1(0x321)])[_0x114aa1(0x378)](_0x413f65[_0x114aa1(0x401)]);}),_0x413f65[_0xad20f(0x302)](it,_0xad20f(0x168),async()=>{const _0x3b738b=_0xad20f;_0x413f65['QPURF'](spyOn,_0x21c3f2,_0x413f65[_0x3b738b(0x348)])['and'][_0x3b738b(0x235)](()=>{const _0x45e87f=_0x3b738b,_0x19f22b={'AgLYV':'Could\x20not\x20connect\x20to\x20the\x20authentication\x20server'};if(_0x413f65[_0x45e87f(0x443)](_0x413f65['yxukq'],_0x413f65['qBZgF']))_0x49d2f4(_0x49f586[_0x45e87f(0x1d1)])[_0x45e87f(0x2ea)](_0x19f22b[_0x45e87f(0x1a4)]);else return Promise[_0x45e87f(0x253)]({'data':{'id':_0x413f65[_0x45e87f(0x223)]}});}),await _0x4fc274[_0x3b738b(0x25d)]({'id':_0x413f65['qlfMQ'],'access_token':_0x413f65[_0x3b738b(0x41d)],'apiURL':_0x3b738b(0x2dc)},{}),_0x413f65[_0x3b738b(0x1c2)](expect,_0x21c3f2['get'])[_0x3b738b(0x378)](_0x413f65[_0x3b738b(0x371)]);});}),describe(_0x306e7c(0x251),()=>{const _0x5e0735=_0x306e7c,_0x24b32d={'jABCA':function(_0x3da667){return _0x3da667();},'dcOlT':function(_0x39df3a,_0x53a4f4){return _0x39df3a(_0x53a4f4);},'ZZQzD':'id\x20token\x20is\x20invalid\x20for\x20this\x20user.','HIuxE':_0x5e0735(0x444),'gJJWa':_0x5e0735(0x35d),'mcJCq':_0x5e0735(0x309),'WWkHs':function(_0x5d2ad2,_0x2f68ab,_0x5832c7){return _0x5d2ad2(_0x2f68ab,_0x5832c7);},'zcqmM':_0x5e0735(0x3ee),'DDGCM':function(_0x5e11b7,_0x2f6c72,_0x12051d){return _0x5e11b7(_0x2f6c72,_0x12051d);},'yMLHm':_0x5e0735(0x208),'Ejyte':_0x5e0735(0x12d),'Pkfym':_0x5e0735(0x175),'TAZsW':function(_0x164090,_0x2a1e54){return _0x164090===_0x2a1e54;},'CczrR':_0x5e0735(0x1cc),'XpZtT':function(_0x837b70,_0x54f3d9,_0x46d8b7){return _0x837b70(_0x54f3d9,_0x46d8b7);},'CvVgq':'INSERT\x20ID\x20HERE','YJgWB':_0x5e0735(0x1a7),'kiBeb':_0x5e0735(0x239),'mnZFr':_0x5e0735(0x25b),'JYxnQ':_0x5e0735(0x442),'rKpAN':_0x5e0735(0x43b),'OinTo':_0x5e0735(0x434),'JMQvh':_0x5e0735(0x478),'KMzWY':_0x5e0735(0x357),'pjIHa':function(_0x509bb6,_0x4e4992,_0x4a8332){return _0x509bb6(_0x4e4992,_0x4a8332);},'lAAxo':_0x5e0735(0x1c0),'dNDHm':_0x5e0735(0x42b),'lOzOv':_0x5e0735(0x237)},_0x55cb47=require(_0x24b32d[_0x5e0735(0x2e0)]),_0x5eae75=require(_0x5e0735(0x1a1)),_0x52519d=require(_0x24b32d[_0x5e0735(0x2e4)]);_0x24b32d[_0x5e0735(0x2ff)](it,_0x24b32d[_0x5e0735(0x112)],async()=>{const _0x23b79c=_0x5e0735;try{await _0x55cb47['validateAuthData']({},{}),_0x24b32d[_0x23b79c(0x2a1)](fail);}catch(_0x1a2992){_0x24b32d[_0x23b79c(0x453)](expect,_0x1a2992[_0x23b79c(0x1d1)])[_0x23b79c(0x2ea)](_0x24b32d[_0x23b79c(0x136)]);}}),_0x24b32d[_0x5e0735(0x3d0)](it,_0x5e0735(0x28c),async()=>{const _0x1ec4bc=_0x5e0735;try{await _0x55cb47['validateAuthData']({'id':'the_user_id','id_token':_0x1ec4bc(0x175)},{}),fail();}catch(_0x284d3c){expect(_0x284d3c[_0x1ec4bc(0x1d1)])[_0x1ec4bc(0x2ea)](_0x24b32d[_0x1ec4bc(0x1f7)]);}}),_0x24b32d[_0x5e0735(0x39b)](it,_0x5e0735(0x46f),async()=>{const _0x6bf0b4=_0x5e0735,_0x3e1b72={'iss':_0x24b32d[_0x6bf0b4(0x2ac)],'aud':_0x6bf0b4(0x239),'exp':Date[_0x6bf0b4(0x241)](),'sub':_0x24b32d[_0x6bf0b4(0x3ea)]},_0x290759={'header':{'kid':_0x6bf0b4(0x3ee),'alg':'RS256'}};spyOn(_0x52519d,_0x6bf0b4(0x208))[_0x6bf0b4(0x2fa)][_0x6bf0b4(0x235)](()=>_0x290759),_0x24b32d[_0x6bf0b4(0x277)](spyOn,_0x5eae75,_0x6bf0b4(0x12d))['and'][_0x6bf0b4(0x235)](()=>_0x3e1b72);const _0x12ba81=await _0x55cb47[_0x6bf0b4(0x25d)]({'id':_0x6bf0b4(0x309),'id_token':_0x6bf0b4(0x175)},{'clientId':_0x6bf0b4(0x239)});_0x24b32d[_0x6bf0b4(0x453)](expect,_0x12ba81)[_0x6bf0b4(0x452)](_0x3e1b72);}),it(_0x24b32d['lAAxo'],async()=>{const _0x222345=_0x5e0735,_0x431c5e={'iss':_0x222345(0x30a),'sub':'the_user_id'},_0x28b4b9={'header':{'kid':_0x24b32d[_0x222345(0x12b)],'alg':_0x222345(0x25b)}};_0x24b32d[_0x222345(0x3d0)](spyOn,_0x52519d,_0x24b32d[_0x222345(0x1c4)])[_0x222345(0x2fa)][_0x222345(0x235)](()=>_0x28b4b9),spyOn(_0x5eae75,_0x24b32d[_0x222345(0x212)])['and'][_0x222345(0x235)](()=>_0x431c5e);try{await _0x55cb47[_0x222345(0x25d)]({'id':_0x222345(0x309),'id_token':_0x24b32d[_0x222345(0x320)]},{'clientId':'secret'}),_0x24b32d[_0x222345(0x2a1)](fail);}catch(_0x161aa6){_0x24b32d[_0x222345(0x365)](_0x24b32d[_0x222345(0x445)],_0x24b32d[_0x222345(0x445)])?expect(_0x161aa6[_0x222345(0x1d1)])['toBe'](_0x222345(0x106)):_0x24b32d[_0x222345(0x453)](_0x5a5f9a,_0x393177[_0x222345(0x1d1)])[_0x222345(0x2ea)](_0x222345(0x222));}}),xit(_0x24b32d['dNDHm'],async()=>{const _0x81bdc0=_0x5e0735,_0x1ecc2a={'iss':_0x81bdc0(0x35d),'aud':_0x81bdc0(0x239),'exp':Date[_0x81bdc0(0x241)](),'sub':_0x81bdc0(0x309)},_0x18f68d={'header':{'kid':_0x24b32d[_0x81bdc0(0x12b)],'alg':_0x81bdc0(0x25b)}};_0x24b32d[_0x81bdc0(0x2ff)](spyOn,_0x52519d,_0x81bdc0(0x208))[_0x81bdc0(0x2fa)]['callFake'](()=>_0x18f68d),_0x24b32d['DDGCM'](spyOn,_0x5eae75,_0x81bdc0(0x12d))[_0x81bdc0(0x2fa)][_0x81bdc0(0x235)](()=>_0x1ecc2a);try{await _0x55cb47[_0x81bdc0(0x25d)]({'id':_0x24b32d[_0x81bdc0(0x143)],'token':_0x81bdc0(0x442)},{'clientId':'secret'}),fail();}catch(_0x487950){expect(_0x487950[_0x81bdc0(0x1d1)])[_0x81bdc0(0x2ea)](_0x24b32d[_0x81bdc0(0x23d)]);}}),_0x24b32d[_0x5e0735(0x3d0)](xit,_0x24b32d[_0x5e0735(0x306)],async()=>{const _0x1d5174=_0x5e0735,_0x21dee2={'iss':_0x1d5174(0x35d),'aud':_0x24b32d['kiBeb'],'exp':Date['now'](),'sub':_0x1d5174(0x309)},_0x30a656={'header':{'kid':_0x24b32d['zcqmM'],'alg':_0x24b32d[_0x1d5174(0x1cd)]}};_0x24b32d[_0x1d5174(0x277)](spyOn,_0x52519d,_0x24b32d['yMLHm'])['and'][_0x1d5174(0x235)](()=>_0x30a656),spyOn(_0x5eae75,_0x24b32d[_0x1d5174(0x212)])[_0x1d5174(0x2fa)]['callFake'](()=>_0x21dee2);try{await _0x55cb47[_0x1d5174(0x25d)]({'id':_0x1d5174(0x1ff),'token':_0x24b32d[_0x1d5174(0x3a7)]},{'clientId':_0x24b32d[_0x1d5174(0x32d)]}),fail();}catch(_0x569e01){_0x24b32d[_0x1d5174(0x453)](expect,_0x569e01[_0x1d5174(0x1d1)])[_0x1d5174(0x2ea)]('auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');}});}),describe('google\x20play\x20games\x20service\x20auth',()=>{const _0x76f70=_0x306e7c,_0x353a79={'OVNHT':function(_0x433da1,_0x52bf70){return _0x433da1===_0x52bf70;},'xDuII':'GVzYQ','ESdnH':function(_0x460ae5,_0x5cd4cf,_0x1b1abb){return _0x460ae5(_0x5cd4cf,_0x1b1abb);},'bqsJe':_0x76f70(0x24d),'CWLcy':function(_0x286593,_0x4934a8){return _0x286593(_0x4934a8);},'EAEsh':'../lib/Adapters/Auth/httpsRequest','ogUcK':_0x76f70(0x244)},_0x569777=require(_0x76f70(0x20a)),_0x26c841=require(_0x353a79['EAEsh']);it(_0x76f70(0x3b6),async()=>{const _0x48b9de=_0x76f70;_0x353a79[_0x48b9de(0x406)](_0x353a79[_0x48b9de(0x2bd)],_0x353a79[_0x48b9de(0x2bd)])?(spyOn(_0x26c841,_0x48b9de(0x321))['and'][_0x48b9de(0x235)](()=>{const _0x53a22a=_0x48b9de;return Promise[_0x53a22a(0x253)]({'playerId':_0x53a22a(0x21b)});}),await _0x569777[_0x48b9de(0x25d)]({'id':_0x48b9de(0x21b),'access_token':'access_token'})):_0x4da78f(_0x56ac2b[_0x48b9de(0x1d1)])[_0x48b9de(0x2ea)](_0x48b9de(0x474));}),it(_0x353a79['ogUcK'],async()=>{const _0x326195=_0x76f70,_0x27420b={'MEGzB':_0x326195(0x2ed)};_0x353a79[_0x326195(0x115)](spyOn,_0x26c841,_0x326195(0x321))[_0x326195(0x2fa)][_0x326195(0x235)](()=>{const _0x4ba7dc=_0x326195;return Promise[_0x4ba7dc(0x253)]({'playerId':_0x27420b[_0x4ba7dc(0x1b6)]});});try{await _0x569777['validateAuthData']({'id':_0x326195(0x21b),'access_token':_0x353a79['bqsJe']});}catch(_0x2b68b4){_0x353a79[_0x326195(0xff)](expect,_0x2b68b4[_0x326195(0x1d1)])['toBe'](_0x326195(0x163));}});}),describe(_0x306e7c(0x1e2),()=>{const _0x4e1990=_0x306e7c,_0x47427f={'HyfOT':'OAuth2\x20access\x20token\x20is\x20invalid\x20for\x20this\x20user.','aDTah':function(_0x5125e9){return _0x5125e9();},'rEyoU':function(_0x207b71,_0x22665b){return _0x207b71(_0x22665b);},'XMxpJ':_0x4e1990(0x2ab),'Mdodb':function(_0xf1050e){return _0xf1050e();},'qaYHm':_0x4e1990(0x305),'XoanO':function(_0x439bd5,_0x23ec68){return _0x439bd5(_0x23ec68);},'IMxlQ':_0x4e1990(0x403),'diLzD':_0x4e1990(0x164),'jCOAX':_0x4e1990(0x36d),'PcQnJ':function(_0x1335a6,_0x5bab66){return _0x1335a6===_0x5bab66;},'IRczA':_0x4e1990(0x234),'IjTNl':'RvIqk','pGukM':_0x4e1990(0x321),'nsrhk':'new','KXUXq':function(_0xff9f26){return _0xff9f26();},'rTYqZ':_0x4e1990(0x45c),'ZbzEf':_0x4e1990(0x1ab),'aTore':'dAiLK','oOAqe':function(_0x41044b,_0x1e02fc,_0x225d9f){return _0x41044b(_0x1e02fc,_0x225d9f);},'hWZPb':_0x4e1990(0x38f),'xGORl':_0x4e1990(0x1c5),'lMTKo':'http://example.com','ajYsM':'group1','qOpSe':function(_0x2daf54){return _0x2daf54();},'gcWiY':_0x4e1990(0x163),'kJSpK':_0x4e1990(0x425),'aeJbL':_0x4e1990(0x475),'zzyWP':'zQpuS','MxIpl':_0x4e1990(0x405),'tSGWw':function(_0x39dd6b,_0x4749e1){return _0x39dd6b(_0x4749e1);},'UTwRN':function(_0x233fb9,_0x288851){return _0x233fb9===_0x288851;},'PitCS':_0x4e1990(0x299),'XnlXz':_0x4e1990(0x382),'EFyBG':function(_0x3dc5e8,_0x3e0a41){return _0x3dc5e8(_0x3e0a41);},'DLDdG':_0x4e1990(0x156),'JIcvV':function(_0x525063,_0x1a1000,_0x343525){return _0x525063(_0x1a1000,_0x343525);},'ShTqo':_0x4e1990(0x2e1),'qddVB':_0x4e1990(0x1a6),'vfCIc':_0x4e1990(0x297),'LHtLf':_0x4e1990(0x46b),'HxKkp':function(_0x43fb68,_0x17e3d3,_0x1e7388){return _0x43fb68(_0x17e3d3,_0x1e7388);},'XmXCD':_0x4e1990(0x3a6),'hvzlN':function(_0x411470,_0x217f2a,_0x1386b5){return _0x411470(_0x217f2a,_0x1386b5);},'dDBTy':'validateAuthData\x20should\x20fail\x20with\x20invalid\x20roles'},_0x1b8602=require('../lib/Adapters/Auth/keycloak'),_0x175105=_0x47427f['EFyBG'](require,_0x47427f[_0x4e1990(0x1ba)]);_0x47427f[_0x4e1990(0x40f)](it,'validateAuthData\x20should\x20fail\x20without\x20access\x20token',async()=>{const _0x5e72a4=_0x4e1990,_0x9b4bbd={'id':_0x5e72a4(0x38f)};try{'CabCr'!==_0x5e72a4(0x3b5)?(await _0x1b8602[_0x5e72a4(0x25d)](_0x9b4bbd),_0x47427f[_0x5e72a4(0x441)](fail)):_0x2d28e3(_0x32110d[_0x5e72a4(0x1d1)])[_0x5e72a4(0x2ea)](_0x47427f[_0x5e72a4(0x280)]);}catch(_0x3beafc){_0x47427f[_0x5e72a4(0x46c)](expect,_0x3beafc[_0x5e72a4(0x1d1)])[_0x5e72a4(0x2ea)](_0x47427f[_0x5e72a4(0x30e)]);}}),it(_0x47427f[_0x4e1990(0x229)],async()=>{const _0x553721=_0x4e1990,_0x325b00={'access_token':'sometoken'};try{await _0x1b8602[_0x553721(0x25d)](_0x325b00),_0x47427f[_0x553721(0x310)](fail);}catch(_0x4df51d){_0x47427f[_0x553721(0x182)]===_0x553721(0x305)?_0x47427f['XoanO'](expect,_0x4df51d['message'])[_0x553721(0x2ea)](_0x553721(0x2ab)):(_0x309279('should\x20not\x20fail\x20fetching\x20the\x20session'),_0x499af5());}}),it(_0x47427f[_0x4e1990(0x418)],async()=>{const _0x3d0fb6=_0x4e1990,_0x15ad0a={'keycloak':{'config':null}},_0x456498={'id':_0x3d0fb6(0x38f),'access_token':_0x47427f[_0x3d0fb6(0x3b1)]},{adapter:_0x2e377e,providerOptions:_0x1a7363}=authenticationLoader['loadAuthAdapter'](_0x47427f['diLzD'],_0x15ad0a);try{await _0x2e377e['validateAuthData'](_0x456498,_0x1a7363),_0x47427f[_0x3d0fb6(0x310)](fail);}catch(_0x3eea2e){expect(_0x3eea2e[_0x3d0fb6(0x1d1)])[_0x3d0fb6(0x2ea)](_0x47427f[_0x3d0fb6(0x451)]);}}),it(_0x47427f['vfCIc'],async()=>{const _0x4c6c90=_0x4e1990,_0x14755b={'CkwGO':_0x4c6c90(0x217)};if(_0x47427f[_0x4c6c90(0x22a)](_0x47427f['IRczA'],_0x47427f['IjTNl']))_0x47427f[_0x4c6c90(0x1de)](_0x3ff886,_0x5ce4b0[_0x4c6c90(0x1d1)])[_0x4c6c90(0x2ea)](_0x4c6c90(0x1d2));else{spyOn(_0x175105,_0x47427f[_0x4c6c90(0x2d2)])['and'][_0x4c6c90(0x235)](()=>{const _0xbeeeb4=_0x4c6c90;return Promise[_0xbeeeb4(0x3fb)]({'text':JSON[_0xbeeeb4(0x2c3)]({'error':_0x14755b[_0xbeeeb4(0x479)]})});});const _0x539761={'keycloak':{'config':{'auth-server-url':_0x4c6c90(0x148),'realm':_0x47427f[_0x4c6c90(0x1fa)]}}},_0x16f5ac={'id':_0x4c6c90(0x38f),'access_token':_0x4c6c90(0x403)},{adapter:_0x6ee81e,providerOptions:_0x2e296f}=authenticationLoader[_0x4c6c90(0x103)](_0x4c6c90(0x164),_0x539761);try{await _0x6ee81e[_0x4c6c90(0x25d)](_0x16f5ac,_0x2e296f),_0x47427f['KXUXq'](fail);}catch(_0x5f2f94){_0x47427f[_0x4c6c90(0x46c)](expect,_0x5f2f94[_0x4c6c90(0x1d1)])['toBe'](_0x4c6c90(0x211));}}}),it(_0x47427f['LHtLf'],async()=>{const _0x56ded2=_0x4e1990,_0x15e371={'GGCsP':function(_0x25b2ca,_0x31d7ff){const _0x5585c4=_0xab88;return _0x47427f[_0x5585c4(0x1de)](_0x25b2ca,_0x31d7ff);},'EegCF':_0x47427f[_0x56ded2(0x36a)],'cRnCu':function(_0x31e567,_0x30379b){return _0x31e567!==_0x30379b;}};spyOn(_0x175105,_0x56ded2(0x321))[_0x56ded2(0x2fa)][_0x56ded2(0x235)](()=>{const _0xadfad7=_0x56ded2;if(_0x15e371[_0xadfad7(0x410)](_0xadfad7(0x261),_0xadfad7(0x40a)))return Promise[_0xadfad7(0x3fb)]({'text':JSON[_0xadfad7(0x2c3)]({'error_description':_0xadfad7(0x474)})});else _0x15e371[_0xadfad7(0x420)](_0x35d698,_0x2c7d39[_0xadfad7(0x1d1)])['toBe'](_0x15e371[_0xadfad7(0x2c0)]);});const _0x2ced19={'keycloak':{'config':{'auth-server-url':_0x56ded2(0x148),'realm':_0x47427f['nsrhk']}}},_0x420d14={'id':_0x56ded2(0x38f),'access_token':'sometoken'},{adapter:_0x50a8a6,providerOptions:_0x3ecb0d}=authenticationLoader['loadAuthAdapter']('keycloak',_0x2ced19);try{if(_0x47427f['ZbzEf']!==_0x47427f['aTore'])await _0x50a8a6[_0x56ded2(0x25d)](_0x420d14,_0x3ecb0d),_0x47427f[_0x56ded2(0x310)](fail);else return;}catch(_0x2157b9){_0x47427f[_0x56ded2(0x1de)](expect,_0x2157b9[_0x56ded2(0x1d1)])['toBe']('custom\x20error\x20message');}}),it(_0x4e1990(0x355),async()=>{const _0xad9bc2=_0x4e1990;_0x47427f[_0xad9bc2(0x2ba)](spyOn,_0x175105,_0xad9bc2(0x321))['and'][_0xad9bc2(0x235)](()=>{const _0x194092=_0xad9bc2;return Promise[_0x194092(0x253)]({});});const _0x5c61ef={'keycloak':{'config':{'auth-server-url':_0xad9bc2(0x148),'realm':_0x47427f[_0xad9bc2(0x1fa)]}}},_0x40c294={'id':_0x47427f[_0xad9bc2(0x27a)],'access_token':_0xad9bc2(0x403)},{adapter:_0x59dc85,providerOptions:_0x4f1d35}=authenticationLoader[_0xad9bc2(0x103)](_0x47427f[_0xad9bc2(0x3a3)],_0x5c61ef);try{await _0x59dc85[_0xad9bc2(0x25d)](_0x40c294,_0x4f1d35),fail();}catch(_0x5f4f61){expect(_0x5f4f61[_0xad9bc2(0x1d1)])['toBe'](_0xad9bc2(0x405));}}),_0x47427f[_0x4e1990(0x117)](it,_0x47427f['XmXCD'],async()=>{const _0x2217a4=_0x4e1990,_0x54d307={'KwtQh':_0x47427f['hWZPb'],'eqKWI':_0x47427f['xGORl'],'jBFQi':'unknown'};_0x47427f[_0x2217a4(0x2ba)](spyOn,_0x175105,_0x47427f[_0x2217a4(0x2d2)])['and'][_0x2217a4(0x235)](()=>{const _0x13b8c1=_0x2217a4;return Promise[_0x13b8c1(0x253)]({'data':{'sub':_0x54d307[_0x13b8c1(0x1eb)],'roles':[_0x54d307[_0x13b8c1(0x370)]],'groups':[_0x54d307['jBFQi']]}});});const _0xcf94bc={'keycloak':{'config':{'auth-server-url':_0x47427f[_0x2217a4(0x10e)],'realm':'new'}}},_0x2a4790={'id':_0x47427f[_0x2217a4(0x27a)],'access_token':_0x47427f['IMxlQ'],'roles':[_0x2217a4(0x1c5)],'groups':[_0x47427f['ajYsM']]},{adapter:_0x5bf1ed,providerOptions:_0x3e8856}=authenticationLoader['loadAuthAdapter'](_0x47427f[_0x2217a4(0x3a3)],_0xcf94bc);try{await _0x5bf1ed[_0x2217a4(0x25d)](_0x2a4790,_0x3e8856),_0x47427f[_0x2217a4(0x1e9)](fail);}catch(_0xb2592d){expect(_0xb2592d[_0x2217a4(0x1d1)])[_0x2217a4(0x2ea)](_0x2217a4(0x405));}}),_0x47427f[_0x4e1990(0x426)](it,_0x47427f[_0x4e1990(0x36e)],async()=>{const _0x3a17fe=_0x4e1990,_0x17212e={'SqoRb':_0x47427f[_0x3a17fe(0x27a)],'WkEoC':_0x47427f[_0x3a17fe(0x468)]};_0x47427f[_0x3a17fe(0x2ba)](spyOn,_0x175105,_0x47427f[_0x3a17fe(0x2d2)])[_0x3a17fe(0x2fa)][_0x3a17fe(0x235)](()=>{const _0x58b13c=_0x3a17fe;return Promise[_0x58b13c(0x253)]({'data':{'sub':_0x17212e[_0x58b13c(0x44e)],'roles':_0x17212e[_0x58b13c(0x398)],'groups':[_0x58b13c(0x37f)]}});});const _0x276348={'keycloak':{'config':{'auth-server-url':_0x3a17fe(0x148),'realm':_0x47427f[_0x3a17fe(0x1fa)]}}},_0x54831d={'id':_0x47427f['hWZPb'],'access_token':_0x3a17fe(0x403),'roles':[_0x3a17fe(0x1c5)],'groups':[_0x47427f[_0x3a17fe(0x1ee)]]},{adapter:_0x336959,providerOptions:_0x9f573a}=authenticationLoader['loadAuthAdapter'](_0x3a17fe(0x164),_0x276348);try{await _0x336959[_0x3a17fe(0x25d)](_0x54831d,_0x9f573a),fail();}catch(_0x421878){_0x47427f['aeJbL']!==_0x47427f[_0x3a17fe(0x2bf)]?expect(_0x421878[_0x3a17fe(0x1d1)])[_0x3a17fe(0x2ea)](_0x47427f[_0x3a17fe(0x1a2)]):_0x3deed9(_0x2419e1[_0x3a17fe(0x1d1)])[_0x3a17fe(0x2ea)](_0x47427f[_0x3a17fe(0x419)]);}}),_0x47427f[_0x4e1990(0x117)](it,'validateAuthData\x20should\x20handle\x20authentication',async()=>{const _0x528891=_0x4e1990,_0x54ca79={'qFCRv':function(_0x2086b5,_0x398b14){return _0x47427f['tSGWw'](_0x2086b5,_0x398b14);}};if(_0x47427f[_0x528891(0x20d)](_0x528891(0x2fe),_0x528891(0x2fe))){spyOn(_0x175105,_0x47427f[_0x528891(0x2d2)])[_0x528891(0x2fa)][_0x528891(0x235)](()=>{const _0x1ef077=_0x528891;return Promise['resolve']({'data':{'sub':_0x1ef077(0x38f),'roles':[_0x47427f[_0x1ef077(0x171)]],'groups':[_0x1ef077(0x37f)]}});});const _0x367634={'keycloak':{'config':{'auth-server-url':_0x528891(0x148),'realm':_0x47427f[_0x528891(0x1fa)]}}},_0x1eb807={'id':_0x47427f[_0x528891(0x27a)],'access_token':_0x528891(0x403),'roles':[_0x47427f[_0x528891(0x171)]],'groups':[_0x528891(0x37f)]},{adapter:_0x4d5d64,providerOptions:_0x5d84a9}=authenticationLoader[_0x528891(0x103)](_0x47427f[_0x528891(0x3a3)],_0x367634);await _0x4d5d64[_0x528891(0x25d)](_0x1eb807,_0x5d84a9),expect(_0x175105[_0x528891(0x321)])['toHaveBeenCalledWith']({'host':'http://example.com','path':_0x47427f[_0x528891(0x2fb)],'headers':{'Authorization':_0x47427f[_0x528891(0x17f)]}});}else _0x54ca79[_0x528891(0x45f)](_0x40ca06,_0x5e55e5[_0x528891(0x1d1)])['toBe']('auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');});}),describe('oauth2\x20auth\x20adapter',()=>{const _0x1bef77=_0x306e7c,_0x4ad0f4={'csFzy':'oauth2Authentication','YACch':function(_0x4f1303,_0x4bc141){return _0x4f1303(_0x4bc141);},'eqPDT':'sub','ykAtA':_0x1bef77(0x24c),'AzXAB':'Basic\x20dXNlcm5hbWU6cGFzc3dvcmQ=','QxZNk':_0x1bef77(0x38f),'mXpqj':_0x1bef77(0x403),'ZNaFq':function(_0x47fd54,_0x3faed3){return _0x47fd54!==_0x3faed3;},'vCSfC':function(_0x2fc68e,_0x13d4a7){return _0x2fc68e(_0x13d4a7);},'UfZAR':function(_0x226521,_0x182ddc){return _0x226521!==_0x182ddc;},'ySOkx':_0x1bef77(0x303),'BBrFK':_0x1bef77(0x3f2),'gtkNq':_0x1bef77(0x222),'txdXJ':_0x1bef77(0x32e),'nGwLu':_0x1bef77(0x2d7),'NwLif':_0x1bef77(0x38a),'grbPN':function(_0xcf00db,_0x3894a8,_0x27790f){return _0xcf00db(_0x3894a8,_0x27790f);},'aMKkH':_0x1bef77(0x273),'aDEem':_0x1bef77(0x36d),'zyhrY':function(_0xb76338,_0x1ae948){return _0xb76338(_0x1ae948);},'KzoCU':'nmiAs','ajTTJ':_0x1bef77(0x3bf),'lUtmh':_0x1bef77(0x19c),'DtKhX':function(_0x332de1,_0x674b73){return _0x332de1==_0x674b73;},'FuZJX':function(_0x577224,_0x2d9cad){return _0x577224==_0x2d9cad;},'PsuQj':function(_0x716ad5,_0x2d5542){return _0x716ad5!==_0x2d5542;},'yZGrk':_0x1bef77(0x37b),'XEkoo':_0x1bef77(0x196),'PNKmH':_0x1bef77(0x21b),'AVngu':function(_0xc928a1,_0x2a6888){return _0xc928a1===_0x2a6888;},'CiUur':_0x1bef77(0x176),'iEYRe':_0x1bef77(0x1a0),'fkLzE':'YtPuG','PBKkF':_0x1bef77(0x2c1),'UNQYl':_0x1bef77(0x14d),'RXkdG':_0x1bef77(0x448),'enaBN':_0x1bef77(0x1c1),'kfOwM':'token=sometoken','sDNgD':function(_0x118082,_0x2d07f0,_0x311294){return _0x118082(_0x2d07f0,_0x311294);},'hvkGF':function(_0x555440,_0x3ea160){return _0x555440!==_0x3ea160;},'tvKrG':_0x1bef77(0x162),'HQFmC':function(_0x340126,_0x4e0ebe){return _0x340126(_0x4e0ebe);},'Vaxvz':function(_0x6e115d,_0x1f957d){return _0x6e115d(_0x1f957d);},'LljCa':'../lib/Adapters/Auth/oauth2','DhWCZ':function(_0x58348d,_0x39de38){return _0x58348d(_0x39de38);},'cEUsd':_0x1bef77(0x156),'TtsED':function(_0x30f976,_0x1eb9d3,_0x11e6ca){return _0x30f976(_0x1eb9d3,_0x11e6ca);},'nWshZ':function(_0x1161e7,_0x2de587,_0x4a72d2){return _0x1161e7(_0x2de587,_0x4a72d2);},'SsBko':'validateAppId\x20should\x20fail\x20if\x20OAuth2\x20tokenIntrospectionEndpointUrl\x20is\x20not\x20configured\x20properly','ABJhb':'validateAppId\x20should\x20fail\x20without\x20appIds','stdqL':_0x1bef77(0x1ec),'AMhGt':function(_0x1a03b1,_0x1bcb6a,_0x4421cb){return _0x1a03b1(_0x1bcb6a,_0x4421cb);},'HdziD':function(_0x114c47,_0x445022,_0x5a24ae){return _0x114c47(_0x445022,_0x5a24ae);},'jiSKz':_0x1bef77(0x135),'WldKd':_0x1bef77(0x46d),'frKWg':_0x1bef77(0x262),'gHimc':function(_0xa2320a,_0x5176e0,_0x5a2a00){return _0xa2320a(_0x5176e0,_0x5a2a00);},'VmlZP':_0x1bef77(0x3a5)},_0x31e0f0=_0x4ad0f4[_0x1bef77(0x471)](require,_0x4ad0f4[_0x1bef77(0x42e)]),_0x3a161e=_0x4ad0f4['DhWCZ'](require,_0x4ad0f4[_0x1bef77(0x102)]);_0x4ad0f4[_0x1bef77(0x2a4)](it,_0x1bef77(0x20f),()=>{const _0x35597d=_0x1bef77,_0x3d96b3={'oauth2Authentication':{'oauth2':!![]}},_0x143934=authenticationLoader[_0x35597d(0x103)](_0x4ad0f4['csFzy'],_0x3d96b3);_0x4ad0f4[_0x35597d(0x15e)](expect,_0x143934[_0x35597d(0x32a)])[_0x35597d(0x452)](_0x31e0f0);}),it('properly\x20loads\x20OAuth2\x20adapter\x20with\x20options',()=>{const _0x3046ff=_0x1bef77,_0x5f1f13={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x3046ff(0x38a),'useridField':_0x4ad0f4['eqPDT'],'appidField':_0x4ad0f4[_0x3046ff(0x1d7)],'appIds':['a','b'],'authorizationHeader':_0x4ad0f4[_0x3046ff(0x3dd)],'debug':!![]}},_0xb1535c=authenticationLoader[_0x3046ff(0x103)](_0x3046ff(0x1fc),_0x5f1f13),_0x26d308=_0xb1535c['appIds'],_0x5dbdc2=_0xb1535c[_0x3046ff(0x268)];expect(_0x5dbdc2[_0x3046ff(0x2cd)])[_0x3046ff(0x452)](_0x3046ff(0x38a)),expect(_0x5dbdc2[_0x3046ff(0x15a)])[_0x3046ff(0x452)](_0x4ad0f4['eqPDT']),expect(_0x5dbdc2['appidField'])[_0x3046ff(0x452)]('appId'),_0x4ad0f4[_0x3046ff(0x15e)](expect,_0x26d308)['toEqual'](['a','b']),_0x4ad0f4[_0x3046ff(0x15e)](expect,_0x5dbdc2[_0x3046ff(0x186)])[_0x3046ff(0x452)](_0x4ad0f4[_0x3046ff(0x3dd)]),_0x4ad0f4[_0x3046ff(0x15e)](expect,_0x5dbdc2[_0x3046ff(0x243)])[_0x3046ff(0x452)](!![]);}),_0x4ad0f4[_0x1bef77(0x412)](it,_0x4ad0f4[_0x1bef77(0x386)],async()=>{const _0x932152=_0x1bef77,_0x2ee782={'oauth2Authentication':{'oauth2':!![],'appIds':['a','b'],'appidField':_0x932152(0x24c)}},_0x253a46={'id':_0x932152(0x38f),'access_token':_0x4ad0f4[_0x932152(0x399)]},{adapter:_0x443fe3,appIds:_0x5acfbd,providerOptions:_0x49ba59}=authenticationLoader[_0x932152(0x103)](_0x4ad0f4[_0x932152(0x232)],_0x2ee782);try{await _0x443fe3[_0x932152(0x3b3)](_0x5acfbd,_0x253a46,_0x49ba59);}catch(_0x4021b8){if(_0x4ad0f4[_0x932152(0x3d4)](_0x932152(0x317),_0x932152(0x454)))expect(_0x4021b8['message'])[_0x932152(0x2ea)]('OAuth2\x20token\x20introspection\x20endpoint\x20URL\x20is\x20missing\x20from\x20configuration!');else return _0x1e203c['resolve']({'active':!![],'sub':_0x4ad0f4[_0x932152(0x2d6)]});}}),it(_0x1bef77(0x1f5),async()=>{const _0x5b487e=_0x1bef77,_0x1de73d={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':'https://example.com/introspect'}},_0x4b4fd9={'id':_0x5b487e(0x38f),'access_token':_0x5b487e(0x403)},{adapter:_0x228a59,appIds:_0x4b5a55,providerOptions:_0x5c9c8f}=authenticationLoader[_0x5b487e(0x103)](_0x4ad0f4[_0x5b487e(0x232)],_0x1de73d);try{await _0x228a59[_0x5b487e(0x3b3)](_0x4b5a55,_0x4b4fd9,_0x5c9c8f);}catch(_0x2452ca){_0x4ad0f4[_0x5b487e(0x375)](fail,_0x2452ca);}}),it(_0x4ad0f4[_0x1bef77(0x205)],async()=>{const _0x5e5315=_0x1bef77,_0x31362b={'MmVNG':'userMail'};if(_0x5e5315(0x166)!==_0x5e5315(0x322)){const _0x5b410e={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x5e5315(0x38a),'appidField':_0x4ad0f4['ykAtA']}},_0x53b5b4={'id':_0x4ad0f4[_0x5e5315(0x2d6)],'access_token':_0x4ad0f4[_0x5e5315(0x399)]},{adapter:_0x3bfb6f,appIds:_0x4358f3,providerOptions:_0x3ecb74}=authenticationLoader[_0x5e5315(0x103)](_0x5e5315(0x1fc),_0x5b410e);try{await _0x3bfb6f[_0x5e5315(0x3b3)](_0x4358f3,_0x53b5b4,_0x3ecb74);}catch(_0x156884){if(_0x4ad0f4['UfZAR'](_0x4ad0f4['ySOkx'],_0x4ad0f4['BBrFK']))expect(_0x156884['message'])[_0x5e5315(0x2ea)](_0x4ad0f4[_0x5e5315(0x24e)]);else return _0x38b4dc[_0x5e5315(0x253)]({'data':{'id':_0x5e5315(0x21b)}});}}else return _0x3d6b02[_0x5e5315(0x253)]({'id':_0x5e5315(0x21b),'mail':_0x31362b[_0x5e5315(0x2e7)]});}),it('validateAppId\x20should\x20fail\x20empty\x20appIds',async()=>{const _0x2aa386=_0x1bef77,_0x501ff0={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x2aa386(0x38a),'appidField':'appId','appIds':[]}},_0x3ab7ae={'id':_0x2aa386(0x38f),'access_token':_0x4ad0f4[_0x2aa386(0x399)]},{adapter:_0x5664aa,appIds:_0x18e0ea,providerOptions:_0x403378}=authenticationLoader[_0x2aa386(0x103)](_0x4ad0f4[_0x2aa386(0x232)],_0x501ff0);try{await _0x5664aa[_0x2aa386(0x3b3)](_0x18e0ea,_0x3ab7ae,_0x403378);}catch(_0x3c13bc){expect(_0x3c13bc[_0x2aa386(0x1d1)])[_0x2aa386(0x2ea)](_0x2aa386(0x222));}}),it(_0x4ad0f4[_0x1bef77(0x40b)],async()=>{const _0x36536a=_0x1bef77,_0x21662b={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x36536a(0x38a),'appidField':_0x4ad0f4[_0x36536a(0x1d7)],'appIds':['a','b']}},_0x53c4fd={'id':'fakeid','access_token':'sometoken'},{adapter:_0x95474a,appIds:_0x2ac451,providerOptions:_0x5e73c4}=authenticationLoader[_0x36536a(0x103)](_0x4ad0f4['csFzy'],_0x21662b);spyOn(_0x3a161e,_0x36536a(0x3bf))[_0x36536a(0x2fa)]['callFake'](()=>{const _0x3d6354=_0x36536a;return Promise[_0x3d6354(0x253)]({});});try{await _0x95474a[_0x36536a(0x3b3)](_0x2ac451,_0x53c4fd,_0x5e73c4);}catch(_0x1f8a39){_0x4ad0f4[_0x36536a(0x375)](expect,_0x1f8a39[_0x36536a(0x1d1)])['toBe'](_0x4ad0f4['txdXJ']);}}),_0x4ad0f4[_0x1bef77(0x2d0)](it,'validateAppId\x20invalid\x20accessToken\x20appId',async()=>{const _0x47cf1e=_0x1bef77,_0x4f96d6={'cBJue':_0x47cf1e(0x1af)},_0x240dc7={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x4ad0f4[_0x47cf1e(0x1ca)],'appidField':'appId','appIds':['a','b']}},_0x21daa7={'id':_0x4ad0f4[_0x47cf1e(0x2d6)],'access_token':_0x4ad0f4['mXpqj']},{adapter:_0x4883ee,appIds:_0x2e94c9,providerOptions:_0x2e163f}=authenticationLoader['loadAuthAdapter'](_0x4ad0f4[_0x47cf1e(0x232)],_0x240dc7);_0x4ad0f4[_0x47cf1e(0x1be)](spyOn,_0x3a161e,'request')[_0x47cf1e(0x2fa)]['callFake'](()=>{const _0x508cba=_0x47cf1e;if(_0x4ad0f4[_0x508cba(0x284)]!==_0x508cba(0x3a8))return Promise[_0x508cba(0x253)]({'active':!![]});else _0x56f06f(_0x157c56[_0x508cba(0x1d1)])['toBe'](_0x4f96d6[_0x508cba(0x352)]);});try{await _0x4883ee[_0x47cf1e(0x3b3)](_0x2e94c9,_0x21daa7,_0x2e163f);}catch(_0x16e6a5){_0x4ad0f4[_0x47cf1e(0x15e)](expect,_0x16e6a5['message'])[_0x47cf1e(0x2ea)](_0x4ad0f4['aMKkH']);}}),_0x4ad0f4[_0x1bef77(0x190)](it,_0x1bef77(0x41a),async()=>{const _0x5a2b57=_0x1bef77,_0x274413={'uMpIV':function(_0x49a636,_0x1358ac){const _0x7bad18=_0xab88;return _0x4ad0f4[_0x7bad18(0x1c6)](_0x49a636,_0x1358ac);},'UXsGP':function(_0x23d95a,_0x38cac0){return _0x23d95a(_0x38cac0);},'vImZV':_0x4ad0f4[_0x5a2b57(0x18d)]},_0x54aaf6={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':'https://example.com/introspect','appidField':_0x4ad0f4[_0x5a2b57(0x1d7)],'appIds':['a','b']}},_0x23d43c={'id':_0x4ad0f4['QxZNk'],'access_token':_0x4ad0f4['mXpqj']},{adapter:_0x3a1631,appIds:_0x38809a,providerOptions:_0x476658}=authenticationLoader[_0x5a2b57(0x103)](_0x4ad0f4[_0x5a2b57(0x232)],_0x54aaf6);spyOn(_0x3a161e,_0x4ad0f4[_0x5a2b57(0x28a)])['and']['callFake'](()=>{const _0x5caf7d=_0x5a2b57,_0x4907ac={'yYHPN':function(_0x255c7a,_0x2ac4cf){const _0x179be8=_0xab88;return _0x274413[_0x179be8(0x272)](_0x255c7a,_0x2ac4cf);},'bZZZN':function(_0x5bd85c,_0x16b733){return _0x274413['UXsGP'](_0x5bd85c,_0x16b733);},'NFUKB':function(_0x2bcd46){return _0x2bcd46();}};if(_0x274413['vImZV']===_0x274413['vImZV'])return Promise[_0x5caf7d(0x253)]({'active':!![],'appId':'a'});else{_0x4907ac[_0x5caf7d(0x185)](_0x5ad55f,_0x13bd5c)['toBe'](null);const _0x9ee887=_0x1275c2;_0x59167a(_0x9ee887[_0x5caf7d(0x31d)])['not'][_0x5caf7d(0x13d)](),_0x1eb9c6(_0x9ee887[_0x5caf7d(0x31d)])['not']['toBeUndefined'](),_0x4907ac[_0x5caf7d(0x279)](_0x20ee1c,_0x9ee887[_0x5caf7d(0x31d)])[_0x5caf7d(0x2ea)](_0x3ea046),_0x4907ac['NFUKB'](_0x23a6a2);}});try{await _0x3a1631[_0x5a2b57(0x3b3)](_0x38809a,_0x23d43c,_0x476658);}catch(_0x513361){_0x5a2b57(0x19c)!==_0x4ad0f4[_0x5a2b57(0x467)]?_0x2f1c8f(_0x3660de[_0x5a2b57(0x1d1)])[_0x5a2b57(0x2ea)](_0x4ad0f4[_0x5a2b57(0x230)]):fail(_0x513361);}}),it(_0x4ad0f4[_0x1bef77(0x41f)],async()=>{const _0x562d90=_0x1bef77,_0xeec569={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x562d90(0x38a),'appidField':_0x562d90(0x24c),'appIds':['a','b']}},_0x2b268={'id':_0x4ad0f4[_0x562d90(0x2d6)],'access_token':_0x562d90(0x403)},{adapter:_0x367d92,appIds:_0x3d33f6,providerOptions:_0x55482f}=authenticationLoader[_0x562d90(0x103)](_0x4ad0f4[_0x562d90(0x232)],_0xeec569);_0x4ad0f4[_0x562d90(0x1be)](spyOn,_0x3a161e,_0x562d90(0x3bf))[_0x562d90(0x2fa)][_0x562d90(0x235)](()=>{const _0x3d8cef=_0x562d90;return Promise[_0x3d8cef(0x253)]({'active':!![],'appId':['a']});});try{if(_0x4ad0f4['PsuQj'](_0x562d90(0x37b),_0x4ad0f4['yZGrk'])){if(_0x4ad0f4[_0x562d90(0x113)](_0x54dc43['id'],_0x1a192c['id'])&&_0x4ad0f4[_0x562d90(0x339)](_0x4f8200[_0x562d90(0x2df)],_0x59f786['token']))return _0x1b71b4[_0x562d90(0x253)]();return _0x15b95a[_0x562d90(0x3fb)]();}else await _0x367d92[_0x562d90(0x3b3)](_0x3d33f6,_0x2b268,_0x55482f);}catch(_0x5ec8cd){_0x4ad0f4['YACch'](fail,_0x5ec8cd);}}),it(_0x4ad0f4[_0x1bef77(0x2db)],async()=>{const _0x5d9521=_0x1bef77,_0x3d6c0a={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x4ad0f4[_0x5d9521(0x1ca)],'appidField':_0x4ad0f4[_0x5d9521(0x1d7)],'appIds':['a','b']}},_0x42dd91={'id':_0x5d9521(0x38f),'access_token':_0x4ad0f4[_0x5d9521(0x399)]},{adapter:_0xaf897a,appIds:_0x37fee2,providerOptions:_0x575d67}=authenticationLoader[_0x5d9521(0x103)](_0x4ad0f4['csFzy'],_0x3d6c0a);_0x4ad0f4['grbPN'](spyOn,_0x3a161e,_0x4ad0f4[_0x5d9521(0x28a)])[_0x5d9521(0x2fa)][_0x5d9521(0x235)](()=>{const _0x337bf8=_0x5d9521;return Promise[_0x337bf8(0x253)]({'active':!![],'appId':'unknown'});});try{await _0xaf897a[_0x5d9521(0x3b3)](_0x37fee2,_0x42dd91,_0x575d67);}catch(_0x57aa69){expect(_0x57aa69[_0x5d9521(0x1d1)])[_0x5d9521(0x2ea)](_0x5d9521(0x273));}}),_0x4ad0f4[_0x1bef77(0x2a4)](it,_0x4ad0f4[_0x1bef77(0x121)],async()=>{const _0x4655b1=_0x1bef77,_0x4bc547={'HHNUh':function(_0x1387ce,_0x173cd7){return _0x1387ce(_0x173cd7);}},_0x27b1d3={'oauth2Authentication':{'oauth2':!![]}},_0x445fdb={'id':_0x4ad0f4[_0x4655b1(0x2d6)],'access_token':_0x4ad0f4[_0x4655b1(0x399)]},{adapter:_0x11437d,providerOptions:_0x5b62bf}=authenticationLoader[_0x4655b1(0x103)](_0x4ad0f4[_0x4655b1(0x232)],_0x27b1d3);try{await _0x11437d[_0x4655b1(0x25d)](_0x445fdb,_0x5b62bf);}catch(_0xd30bf8){_0x4655b1(0x118)===_0x4655b1(0x118)?expect(_0xd30bf8[_0x4655b1(0x1d1)])[_0x4655b1(0x2ea)](_0x4ad0f4[_0x4655b1(0x335)]):_0x4bc547['HHNUh'](_0x572183,_0x2c65b5['message'])['toBe']('auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');}}),_0x4ad0f4[_0x1bef77(0x198)](it,_0x4ad0f4[_0x1bef77(0x389)],async()=>{const _0x44b8df=_0x1bef77,_0x9b0f46={'doZGG':function(_0x1d1608,_0x3095a2){return _0x1d1608(_0x3095a2);},'ebBmx':_0x4ad0f4[_0x44b8df(0x11d)]};if(_0x4ad0f4[_0x44b8df(0x34d)](_0x4ad0f4[_0x44b8df(0x477)],_0x4ad0f4[_0x44b8df(0x2a5)])){const _0x23b11b={'GduxK':function(_0x3e2a38,_0x371ec2){const _0x12a158=_0x44b8df;return _0x9b0f46[_0x12a158(0x17b)](_0x3e2a38,_0x371ec2);},'fUKny':function(_0x5a1054,_0xaa75e6){return _0x5a1054(_0xaa75e6);}};let _0x22b503;_0x9b0f46['doZGG'](_0x9631af,(_0x50f23d,_0x59a04a,_0x506daf)=>{const _0x56bee1=_0x44b8df;_0x23b11b['GduxK'](_0x49fe55,_0x50f23d)[_0x56bee1(0x2ea)](null);const _0x1c69e4=_0x506daf;_0x15bff1(_0x1c69e4[_0x56bee1(0x31d)])['not'][_0x56bee1(0x13d)](),_0x51897c(_0x1c69e4[_0x56bee1(0x31d)])[_0x56bee1(0x267)]['toBeUndefined'](),_0x22b503=_0x1c69e4[_0x56bee1(0x31d)],_0x5dc9e5((_0x3b2b49,_0x379462,_0x14c4ad)=>{const _0x385773=_0x56bee1;_0x23b11b[_0x385773(0x16a)](_0x37c144,_0x3b2b49)[_0x385773(0x2ea)](null);const _0x76552a=_0x14c4ad;_0x23b11b[_0x385773(0x3ae)](_0x208c5e,_0x76552a[_0x385773(0x31d)])[_0x385773(0x267)][_0x385773(0x13d)](),_0x2d0dbc(_0x76552a['objectId'])[_0x385773(0x267)][_0x385773(0x2cc)](),_0x23b11b[_0x385773(0x3ae)](_0x306133,_0x76552a[_0x385773(0x31d)])[_0x385773(0x2ea)](_0x22b503),_0x16ac89();});});}else{const _0x5ebf7e={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x4ad0f4['NwLif'],'useridField':_0x44b8df(0x1e5),'appidField':_0x44b8df(0x24c),'appIds':['a','b'],'authorizationHeader':_0x44b8df(0x373)}},_0x2ddcbe={'id':_0x44b8df(0x38f),'access_token':_0x4ad0f4['mXpqj']},{adapter:_0x237909,providerOptions:_0x17ef9e}=authenticationLoader[_0x44b8df(0x103)]('oauth2Authentication',_0x5ebf7e);spyOn(_0x3a161e,_0x4ad0f4[_0x44b8df(0x28a)])[_0x44b8df(0x2fa)][_0x44b8df(0x235)](()=>{const _0xe4262a=_0x44b8df;return Promise[_0xe4262a(0x253)]({});});try{await _0x237909[_0x44b8df(0x25d)](_0x2ddcbe,_0x17ef9e);}catch(_0x18a1ce){if(_0x4ad0f4[_0x44b8df(0x13e)]===_0x4ad0f4['fkLzE'])expect(_0x18a1ce[_0x44b8df(0x1d1)])['toBe'](_0x44b8df(0x32e));else return _0x494b0e[_0x44b8df(0x253)]({'id':_0x9b0f46[_0x44b8df(0x214)]});}expect(_0x3a161e['request'])[_0x44b8df(0x378)]({'hostname':_0x4ad0f4[_0x44b8df(0x249)],'path':_0x4ad0f4[_0x44b8df(0x2ae)],'method':_0x4ad0f4[_0x44b8df(0x134)],'headers':{'Content-Type':_0x4ad0f4[_0x44b8df(0x307)],'Content-Length':0xf,'Authorization':_0x44b8df(0x373)}},_0x4ad0f4[_0x44b8df(0x351)]);}}),it(_0x1bef77(0x3f3),async()=>{const _0x38ae96=_0x1bef77,_0x445067={'OHxol':function(_0x23c066,_0x4d5ea1){return _0x23c066(_0x4d5ea1);},'PcoXy':_0x4ad0f4[_0x38ae96(0x2d6)]},_0x1e0372={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x38ae96(0x38a),'useridField':_0x4ad0f4[_0x38ae96(0x122)],'appidField':_0x4ad0f4[_0x38ae96(0x1d7)],'appIds':['a','b']}},_0x230f54={'id':_0x4ad0f4['QxZNk'],'access_token':_0x38ae96(0x403)},{adapter:_0x4f1bad,providerOptions:_0x31fa98}=authenticationLoader['loadAuthAdapter'](_0x4ad0f4[_0x38ae96(0x232)],_0x1e0372);_0x4ad0f4[_0x38ae96(0x3e3)](spyOn,_0x3a161e,_0x38ae96(0x3bf))[_0x38ae96(0x2fa)][_0x38ae96(0x235)](()=>{const _0x11e8c8=_0x38ae96,_0x511112={'DOOzX':function(_0x2f4e42,_0x1d6aa6){return _0x445067['OHxol'](_0x2f4e42,_0x1d6aa6);}};if('gWZDx'===_0x11e8c8(0x430))_0x511112[_0x11e8c8(0x29c)](_0x361224,_0x3f507b[_0x11e8c8(0x1d1)])[_0x11e8c8(0x2ea)](_0x11e8c8(0x1da));else return Promise['resolve']({'active':!![],'sub':_0x445067[_0x11e8c8(0x1ae)]});});try{await _0x4f1bad['validateAuthData'](_0x230f54,_0x31fa98);}catch(_0x23ee34){if(_0x4ad0f4[_0x38ae96(0x384)](_0x4ad0f4['tvKrG'],_0x38ae96(0x1b7)))_0x4ad0f4[_0x38ae96(0x1c6)](fail,_0x23ee34);else return _0x2f5406[_0x38ae96(0x253)]({'active':!![],'appId':'a'});}_0x4ad0f4[_0x38ae96(0x15e)](expect,_0x3a161e[_0x38ae96(0x3bf)])[_0x38ae96(0x378)]({'hostname':'example.com','path':_0x4ad0f4[_0x38ae96(0x2ae)],'method':_0x38ae96(0x448),'headers':{'Content-Type':_0x4ad0f4[_0x38ae96(0x307)],'Content-Length':0xf}},_0x4ad0f4['kfOwM']);}),_0x4ad0f4['grbPN'](it,_0x1bef77(0x200),async()=>{const _0x3dc8f7=_0x1bef77,_0xb7e426={'oauth2Authentication':{'oauth2':!![],'tokenIntrospectionEndpointUrl':_0x4ad0f4['NwLif'],'appidField':_0x4ad0f4['ykAtA'],'appIds':['a','b']}},_0x479828={'id':_0x3dc8f7(0x38f),'access_token':_0x4ad0f4[_0x3dc8f7(0x399)]},{adapter:_0x35811a,providerOptions:_0x3a32e7}=authenticationLoader[_0x3dc8f7(0x103)](_0x4ad0f4[_0x3dc8f7(0x232)],_0xb7e426);spyOn(_0x3a161e,_0x4ad0f4[_0x3dc8f7(0x28a)])[_0x3dc8f7(0x2fa)][_0x3dc8f7(0x235)](()=>{const _0xdd122e=_0x3dc8f7;return Promise[_0xdd122e(0x253)]({'active':!![],'sub':_0xdd122e(0x38f)});});try{await _0x35811a[_0x3dc8f7(0x25d)](_0x479828,_0x3a32e7);}catch(_0x498c64){_0x4ad0f4['HQFmC'](fail,_0x498c64);}});}),describe(_0x306e7c(0x35c),()=>{const _0x12c0d0=_0x306e7c,_0x3cfdc9={'Nmjhv':'OAuth2\x20token\x20introspection\x20endpoint\x20URL\x20is\x20missing\x20from\x20configuration!','cHRmr':'secret','JBdPb':'VpPKl','kStfT':_0x12c0d0(0x184),'FUKMT':function(_0x429fcf,_0x400be6){return _0x429fcf===_0x400be6;},'tNNBs':_0x12c0d0(0x407),'YbKip':function(_0x52aed1,_0x3679e6){return _0x52aed1(_0x3679e6);},'KSeNy':'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://www.facebook.com\x20|\x20from:\x20https://not.facebook.com','aRfRN':'fakeid','mskKS':'role1','cIlxO':_0x12c0d0(0x397),'kwvCK':_0x12c0d0(0x3e0),'bnPip':_0x12c0d0(0x3e9),'vYXcv':function(_0x53ad65,_0x597497){return _0x53ad65(_0x597497);},'nbthD':'Pgwey','IFeHY':_0x12c0d0(0x21a),'dFnOe':_0x12c0d0(0x46a),'MCfig':_0x12c0d0(0x208),'sYEvA':function(_0x873f42,_0x590050,_0x5775c1){return _0x873f42(_0x590050,_0x5775c1);},'UBbCX':_0x12c0d0(0x216),'pJUvR':'verify','jzvjh':_0x12c0d0(0x175),'hZPac':_0x12c0d0(0x3ee),'uccBL':function(_0x4e06b1){return _0x4e06b1();},'JViJp':_0x12c0d0(0x157),'ZhsjM':_0x12c0d0(0x309),'kkuTj':function(_0x406ec1,_0x859915){return _0x406ec1(_0x859915);},'cmsvU':'provided\x20token\x20does\x20not\x20decode\x20as\x20JWT','qWybm':function(_0x71bb8b,_0x2a0704,_0x20ccda){return _0x71bb8b(_0x2a0704,_0x20ccda);},'pRKdb':function(_0x10bd5d,_0x449279){return _0x10bd5d(_0x449279);},'HockP':_0x12c0d0(0x23e),'eBNXH':function(_0x43e4bc,_0x6db663,_0x4c16f1){return _0x43e4bc(_0x6db663,_0x4c16f1);},'oayjE':function(_0x3f5c0,_0x3f0e6f,_0x2dca3f){return _0x3f5c0(_0x3f0e6f,_0x2dca3f);},'DuFBw':function(_0x216c62,_0x200c1a){return _0x216c62(_0x200c1a);},'QgTAl':function(_0x336378,_0x5d3075,_0x5602f9){return _0x336378(_0x5d3075,_0x5602f9);},'qRlBu':_0x12c0d0(0x440),'rsEge':'https://not.apple.com','rBSjh':function(_0x2f4001,_0x16b984,_0xa17cfc){return _0x2f4001(_0x16b984,_0xa17cfc);},'uFYig':function(_0x4f949b,_0x353abb,_0x36526b){return _0x4f949b(_0x353abb,_0x36526b);},'SDvQn':function(_0x1e7743,_0x310344,_0x14410d){return _0x1e7743(_0x310344,_0x14410d);},'sxfVt':_0x12c0d0(0x25b),'kayGA':function(_0x361989,_0x71bacb,_0xe44515){return _0x361989(_0x71bacb,_0xe44515);},'oORUC':function(_0x438539,_0x2462be,_0x55dcb9){return _0x438539(_0x2462be,_0x55dcb9);},'LRyaI':'INSERT\x20APPLE\x20TOKEN\x20HERE\x20WITH\x20INVALID\x20JWT\x20ISSUER','TNdcc':function(_0x35836a,_0x497a69){return _0x35836a(_0x497a69);},'OScUM':'id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com','iUXNt':_0x12c0d0(0x43b),'IRcTN':_0x12c0d0(0x442),'fIsef':function(_0x3549de,_0x44c15d){return _0x3549de!==_0x44c15d;},'ypCHx':_0x12c0d0(0x466),'Qoyag':function(_0x4598ec){return _0x4598ec();},'HIOPI':function(_0x584d23,_0x2f405c){return _0x584d23!==_0x2f405c;},'HNUYY':_0x12c0d0(0x183),'ZpHeP':_0x12c0d0(0x1ff),'rKsNu':function(_0x148bf6){return _0x148bf6();},'oWqOH':'auth\x20data\x20is\x20invalid\x20for\x20this\x20user.','WOTza':_0x12c0d0(0x2aa),'JICtb':_0x12c0d0(0x3e5),'jMJEJ':function(_0x46c78b,_0x12e83c,_0x4a38cc){return _0x46c78b(_0x12e83c,_0x4a38cc);},'DaLZF':function(_0x3f7365,_0x3266c3,_0x5a3749){return _0x3f7365(_0x3266c3,_0x5a3749);},'WJeVq':function(_0x39e2cf,_0x30b803){return _0x39e2cf(_0x30b803);},'rjtPP':'jsonwebtoken','QJIdq':_0x12c0d0(0x478),'khwOu':function(_0x331826,_0x5ccddd,_0xa27429){return _0x331826(_0x5ccddd,_0xa27429);},'uUoTr':'should\x20not\x20decode\x20invalid\x20id_token','xpGKY':function(_0x77044c,_0x4453e9,_0x129ae9){return _0x77044c(_0x4453e9,_0x129ae9);},'sYdnd':_0x12c0d0(0x31a),'KOFte':_0x12c0d0(0x1fe),'RjWXF':function(_0x71d26d,_0x36c755,_0x2c05ad){return _0x71d26d(_0x36c755,_0x2c05ad);},'MyVyW':'(using\x20client\x20id\x20as\x20array)\x20should\x20verify\x20id_token\x20(apple.com)','RfPvM':_0x12c0d0(0x2da),'jQeEy':_0x12c0d0(0x439),'WbZic':_0x12c0d0(0x44b),'VdflN':function(_0x538fe3,_0x1d1bed,_0x2adac8){return _0x538fe3(_0x1d1bed,_0x2adac8);},'iDHFX':'(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','bpFBJ':function(_0x23baa9,_0x3ec149,_0x3a4a9d){return _0x23baa9(_0x3ec149,_0x3a4a9d);},'SVDUn':'should\x20throw\x20error\x20with\x20with\x20invalid\x20user\x20id\x20(apple.com)'},_0x56ffb8=require(_0x12c0d0(0x188)),_0x303e1b=require(_0x3cfdc9[_0x12c0d0(0x248)]),_0x1118f5=_0x3cfdc9[_0x12c0d0(0x2d5)](require,_0x3cfdc9[_0x12c0d0(0x327)]);_0x3cfdc9[_0x12c0d0(0x15b)](it,_0x12c0d0(0x2c4),async()=>{const _0x1ef3f0=_0x12c0d0,_0x27404b={'MycFz':function(_0x42df7f,_0x114f47){return _0x42df7f(_0x114f47);},'sFhKW':_0x3cfdc9[_0x1ef3f0(0x25e)]};try{await _0x56ffb8[_0x1ef3f0(0x25d)]({},{'clientId':_0x3cfdc9['cHRmr']}),fail();}catch(_0x135160){_0x1ef3f0(0x240)===_0x3cfdc9['JBdPb']?expect(_0x135160['message'])[_0x1ef3f0(0x2ea)]('id\x20token\x20is\x20invalid\x20for\x20this\x20user.'):_0x27404b[_0x1ef3f0(0x3b7)](_0x30fb95,_0x9a7b06[_0x1ef3f0(0x1d1)])['toBe'](_0x27404b['sFhKW']);}}),it(_0x12c0d0(0x138),async()=>{const _0x2680b0=_0x12c0d0;if(_0x3cfdc9[_0x2680b0(0x46e)](_0x2680b0(0x407),_0x3cfdc9[_0x2680b0(0x356)]))try{await _0x56ffb8[_0x2680b0(0x25d)]({},{'clientId':['secret']}),fail();}catch(_0x4045da){_0x3cfdc9['YbKip'](expect,_0x4045da[_0x2680b0(0x1d1)])[_0x2680b0(0x2ea)](_0x2680b0(0x1d2));}else _0x31172b(typeof _0x37ddbf)[_0x2680b0(0x2ea)](_0x3cfdc9[_0x2680b0(0x275)]);}),_0x3cfdc9[_0x12c0d0(0x455)](it,_0x3cfdc9[_0x12c0d0(0x282)],async()=>{const _0x1d5318=_0x12c0d0;if(_0x3cfdc9[_0x1d5318(0x37a)]===_0x3cfdc9[_0x1d5318(0x41e)])_0x3cfdc9[_0x1d5318(0x104)](_0x40d754,_0x2609e2[_0x1d5318(0x1d1)])['toBe'](_0x3cfdc9['KSeNy']);else try{if(_0x1d5318(0x127)===_0x3cfdc9['bnPip'])return _0x18b6b2[_0x1d5318(0x253)]({'data':{'sub':_0x3cfdc9[_0x1d5318(0x27f)],'roles':[_0x3cfdc9[_0x1d5318(0x206)]],'groups':['group1']}});else await _0x56ffb8[_0x1d5318(0x25d)]({'id':_0x1d5318(0x309),'token':'the_token'},{'clientId':_0x3cfdc9['cHRmr']}),fail();}catch(_0x1410d0){_0x3cfdc9[_0x1d5318(0x1e6)](expect,_0x1410d0[_0x1d5318(0x1d1)])[_0x1d5318(0x2ea)]('provided\x20token\x20does\x20not\x20decode\x20as\x20JWT');}}),_0x3cfdc9[_0x12c0d0(0x114)](it,_0x3cfdc9['sYdnd'],async()=>{const _0x277a20=_0x12c0d0;if(_0x3cfdc9[_0x277a20(0x167)]===_0x3cfdc9['nbthD']){const _0x24e33a={'header':{'kid':_0x277a20(0x1f8),'alg':_0x277a20(0x25b)}};try{_0x3cfdc9['IFeHY']===_0x3cfdc9['dFnOe']?_0x799a4d(_0x3b65b5[_0x277a20(0x1d1)])[_0x277a20(0x2ea)](_0x277a20(0x273)):(spyOn(_0x1118f5,_0x3cfdc9['MCfig'])[_0x277a20(0x2fa)]['callFake'](()=>_0x24e33a[_0x277a20(0x41b)]),await _0x56ffb8['validateAuthData']({'id':_0x277a20(0x309),'token':_0x277a20(0x175)},{'clientId':_0x277a20(0x239)}),fail());}catch(_0x1fb3c9){_0x3cfdc9[_0x277a20(0x104)](expect,_0x1fb3c9[_0x277a20(0x1d1)])[_0x277a20(0x2ea)](_0x277a20(0x3bd)+_0x24e33a[_0x277a20(0x41b)][_0x277a20(0x3f1)]);}}else this['loggedOut']=!![],this['restoreAuthentication'](null);}),_0x3cfdc9[_0x12c0d0(0x455)](it,'should\x20use\x20algorithm\x20from\x20key\x20header\x20to\x20verify\x20id_token\x20(apple.com)',async()=>{const _0x10832e=_0x12c0d0,_0x5079ae={'iss':_0x10832e(0x23e),'aud':_0x3cfdc9[_0x10832e(0x3bb)],'exp':Date[_0x10832e(0x241)](),'sub':'the_user_id'},_0xac7a44={'header':{'kid':_0x10832e(0x3ee),'alg':_0x10832e(0x25b)}},_0x142b7c={'kid':_0x10832e(0x3ee),'rsaPublicKey':_0x10832e(0x259)};_0x3cfdc9[_0x10832e(0x286)](spyOn,_0x1118f5,_0x10832e(0x208))['and'][_0x10832e(0x235)](()=>_0xac7a44[_0x10832e(0x41b)]),_0x3cfdc9[_0x10832e(0x286)](spyOn,_0x1118f5,_0x3cfdc9[_0x10832e(0x1cb)])['and'][_0x10832e(0x158)](_0x142b7c),_0x3cfdc9['sYEvA'](spyOn,_0x303e1b,_0x3cfdc9[_0x10832e(0x15c)])['and']['callFake'](()=>_0x5079ae);const _0xa21fce=await _0x56ffb8[_0x10832e(0x25d)]({'id':'the_user_id','token':_0x3cfdc9[_0x10832e(0x43c)]},{'clientId':_0x3cfdc9[_0x10832e(0x3bb)]});expect(_0xa21fce)[_0x10832e(0x452)](_0x5079ae),expect(_0x303e1b[_0x10832e(0x12d)]['calls'][_0x10832e(0x3ac)]()['args'][0x2][_0x10832e(0x447)])[_0x10832e(0x452)](_0xac7a44['header'][_0x10832e(0x43d)]);}),it(_0x12c0d0(0x125),async()=>{const _0x5abe25=_0x12c0d0,_0x2e7fb3={'header':{'kid':_0x3cfdc9[_0x5abe25(0x47a)],'alg':_0x5abe25(0x25b)}},_0x32e1ba={'kid':_0x3cfdc9[_0x5abe25(0x47a)],'rsaPublicKey':'the_rsa_public_key'};spyOn(_0x1118f5,_0x3cfdc9[_0x5abe25(0x2c7)])[_0x5abe25(0x2fa)]['callFake'](()=>_0x2e7fb3),spyOn(_0x1118f5,'getSigningKey')[_0x5abe25(0x2fa)][_0x5abe25(0x158)](_0x32e1ba);try{await _0x56ffb8[_0x5abe25(0x25d)]({'id':'the_user_id','token':_0x5abe25(0x175)},{'clientId':_0x3cfdc9[_0x5abe25(0x3bb)]}),_0x3cfdc9[_0x5abe25(0x33e)](fail);}catch(_0xec49d5){expect(_0xec49d5['message'])[_0x5abe25(0x2ea)](_0x3cfdc9['JViJp']);}}),it(_0x12c0d0(0x3fc),async()=>{const _0x3b5f79=_0x12c0d0;try{await _0x56ffb8[_0x3b5f79(0x25d)]({'id':_0x3cfdc9['ZhsjM'],'token':_0x3cfdc9[_0x3b5f79(0x43c)]},{'clientId':[_0x3b5f79(0x239)]}),fail();}catch(_0x566f63){_0x3cfdc9['kkuTj'](expect,_0x566f63[_0x3b5f79(0x1d1)])[_0x3b5f79(0x2ea)](_0x3cfdc9[_0x3b5f79(0x292)]);}}),_0x3cfdc9[_0x12c0d0(0x1b9)](it,_0x3cfdc9['KOFte'],async()=>{const _0x997d61=_0x12c0d0,_0x4fab0f={'iss':_0x997d61(0x23e),'aud':'secret','exp':Date[_0x997d61(0x241)](),'sub':_0x997d61(0x309)},_0x128ab9={'header':{'kid':_0x3cfdc9['hZPac'],'alg':_0x997d61(0x25b)}},_0x235af0={'kid':_0x997d61(0x3ee),'rsaPublicKey':_0x997d61(0x259)};_0x3cfdc9[_0x997d61(0x1fd)](spyOn,_0x1118f5,'getHeaderFromToken')[_0x997d61(0x2fa)][_0x997d61(0x235)](()=>_0x128ab9),spyOn(_0x1118f5,_0x997d61(0x216))[_0x997d61(0x2fa)][_0x997d61(0x158)](_0x235af0),spyOn(_0x303e1b,_0x997d61(0x12d))[_0x997d61(0x2fa)][_0x997d61(0x235)](()=>_0x4fab0f);const _0x5a731b=await _0x56ffb8[_0x997d61(0x25d)]({'id':_0x3cfdc9[_0x997d61(0x329)],'token':_0x3cfdc9[_0x997d61(0x43c)]},{'clientId':_0x3cfdc9[_0x997d61(0x3bb)]});_0x3cfdc9[_0x997d61(0x3cf)](expect,_0x5a731b)[_0x997d61(0x452)](_0x4fab0f);}),_0x3cfdc9[_0x12c0d0(0x3c2)](it,_0x3cfdc9[_0x12c0d0(0x238)],async()=>{const _0x461237=_0x12c0d0,_0x521c62={'iss':_0x3cfdc9[_0x461237(0x404)],'aud':_0x3cfdc9[_0x461237(0x3bb)],'exp':Date[_0x461237(0x241)](),'sub':_0x461237(0x309)},_0x4fff02={'header':{'kid':_0x3cfdc9['hZPac'],'alg':_0x461237(0x25b)}},_0x152491={'kid':_0x3cfdc9[_0x461237(0x47a)],'rsaPublicKey':'the_rsa_public_key'};_0x3cfdc9['eBNXH'](spyOn,_0x1118f5,_0x461237(0x208))[_0x461237(0x2fa)][_0x461237(0x235)](()=>_0x4fff02),_0x3cfdc9[_0x461237(0x169)](spyOn,_0x1118f5,_0x3cfdc9[_0x461237(0x1cb)])[_0x461237(0x2fa)][_0x461237(0x158)](_0x152491),_0x3cfdc9['sYEvA'](spyOn,_0x303e1b,_0x3cfdc9[_0x461237(0x15c)])[_0x461237(0x2fa)][_0x461237(0x235)](()=>_0x521c62);const _0x441591=await _0x56ffb8[_0x461237(0x25d)]({'id':_0x461237(0x309),'token':_0x3cfdc9[_0x461237(0x43c)]},{'clientId':[_0x3cfdc9[_0x461237(0x3bb)]]});_0x3cfdc9[_0x461237(0x2d5)](expect,_0x441591)[_0x461237(0x452)](_0x521c62);}),it(_0x3cfdc9[_0x12c0d0(0x34b)],async()=>{const _0x2931c7=_0x12c0d0,_0x3cfec1={'iss':_0x3cfdc9[_0x2931c7(0x404)],'aud':_0x3cfdc9['cHRmr'],'exp':Date[_0x2931c7(0x241)](),'sub':_0x2931c7(0x309)},_0x16af0c={'header':{'kid':_0x2931c7(0x3ee),'alg':_0x2931c7(0x25b)}},_0x54ec25={'kid':_0x2931c7(0x3ee),'rsaPublicKey':_0x2931c7(0x259)};spyOn(_0x1118f5,_0x3cfdc9[_0x2931c7(0x2c7)])[_0x2931c7(0x2fa)][_0x2931c7(0x235)](()=>_0x16af0c),_0x3cfdc9[_0x2931c7(0x423)](spyOn,_0x1118f5,_0x2931c7(0x216))[_0x2931c7(0x2fa)][_0x2931c7(0x158)](_0x54ec25),_0x3cfdc9[_0x2931c7(0x3d1)](spyOn,_0x303e1b,'verify')['and'][_0x2931c7(0x235)](()=>_0x3cfec1);const _0x3eea1c=await _0x56ffb8[_0x2931c7(0x25d)]({'id':_0x3cfdc9['ZhsjM'],'token':_0x3cfdc9[_0x2931c7(0x43c)]},{'clientId':[_0x3cfdc9['cHRmr'],_0x3cfdc9[_0x2931c7(0x21c)]]});_0x3cfdc9[_0x2931c7(0x2d5)](expect,_0x3eea1c)['toEqual'](_0x3cfec1);}),it(_0x12c0d0(0x10a),async()=>{const _0x151e3d=_0x12c0d0,_0x468c08={'iss':_0x3cfdc9[_0x151e3d(0x2de)],'sub':'the_user_id'},_0x3868c7={'header':{'kid':_0x151e3d(0x3ee),'alg':'RS256'}},_0x2b70bf={'kid':_0x3cfdc9[_0x151e3d(0x47a)],'rsaPublicKey':_0x151e3d(0x259)};_0x3cfdc9['rBSjh'](spyOn,_0x1118f5,_0x151e3d(0x208))[_0x151e3d(0x2fa)]['callFake'](()=>_0x3868c7),_0x3cfdc9[_0x151e3d(0x3e8)](spyOn,_0x1118f5,_0x3cfdc9[_0x151e3d(0x1cb)])[_0x151e3d(0x2fa)]['resolveTo'](_0x2b70bf),_0x3cfdc9[_0x151e3d(0x2eb)](spyOn,_0x303e1b,'verify')[_0x151e3d(0x2fa)]['callFake'](()=>_0x468c08);try{await _0x56ffb8[_0x151e3d(0x25d)]({'id':_0x3cfdc9[_0x151e3d(0x329)],'token':_0x151e3d(0x175)},{'clientId':_0x151e3d(0x239)}),fail();}catch(_0x127603){expect(_0x127603['message'])[_0x151e3d(0x2ea)]('id\x20token\x20not\x20issued\x20by\x20correct\x20OpenID\x20provider\x20-\x20expected:\x20https://appleid.apple.com\x20|\x20from:\x20https://not.apple.com');}}),xit(_0x3cfdc9[_0x12c0d0(0x3cb)],async()=>{const _0x549984=_0x12c0d0,_0x49f8e0={'iss':_0x549984(0x2b7),'sub':_0x549984(0x309)},_0x56205a={'header':{'kid':_0x3cfdc9[_0x549984(0x47a)],'alg':_0x3cfdc9['sxfVt']}},_0xf57858={'kid':_0x549984(0x3ee),'rsaPublicKey':_0x549984(0x259)};_0x3cfdc9[_0x549984(0x3d1)](spyOn,_0x1118f5,_0x3cfdc9['MCfig'])['and']['callFake'](()=>_0x56205a),_0x3cfdc9[_0x549984(0x15b)](spyOn,_0x1118f5,_0x549984(0x216))[_0x549984(0x2fa)][_0x549984(0x158)](_0xf57858),_0x3cfdc9[_0x549984(0x1b9)](spyOn,_0x303e1b,_0x549984(0x12d))[_0x549984(0x2fa)][_0x549984(0x235)](()=>_0x49f8e0);try{await _0x56ffb8[_0x549984(0x25d)]({'id':_0x549984(0x466),'token':_0x3cfdc9[_0x549984(0x3f4)]},{'clientId':['INSERT\x20CLIENT\x20ID\x20HERE']}),_0x3cfdc9['uccBL'](fail);}catch(_0x220f09){_0x3cfdc9['TNdcc'](expect,_0x220f09[_0x549984(0x1d1)])[_0x549984(0x2ea)](_0x3cfdc9[_0x549984(0x14f)]);}}),it(_0x3cfdc9[_0x12c0d0(0x3aa)],async()=>{const _0x36f902=_0x12c0d0,_0x2960ce={'iss':_0x36f902(0x2b7),'sub':_0x36f902(0x309)},_0xd6c60e={'header':{'kid':_0x3cfdc9[_0x36f902(0x47a)],'alg':'RS256'}},_0x41e34c={'kid':_0x3cfdc9[_0x36f902(0x47a)],'rsaPublicKey':_0x36f902(0x259)};spyOn(_0x1118f5,_0x3cfdc9[_0x36f902(0x2c7)])[_0x36f902(0x2fa)]['callFake'](()=>_0xd6c60e),spyOn(_0x1118f5,_0x36f902(0x216))[_0x36f902(0x2fa)][_0x36f902(0x158)](_0x41e34c),_0x3cfdc9[_0x36f902(0x1fd)](spyOn,_0x303e1b,_0x3cfdc9[_0x36f902(0x15c)])[_0x36f902(0x2fa)]['callFake'](()=>_0x2960ce);try{await _0x56ffb8[_0x36f902(0x25d)]({'id':'INSERT\x20ID\x20HERE','token':_0x3cfdc9['LRyaI']},{'clientId':_0x3cfdc9[_0x36f902(0x3d5)]}),fail();}catch(_0x21ca02){_0x3cfdc9['YbKip'](expect,_0x21ca02[_0x36f902(0x1d1)])[_0x36f902(0x2ea)](_0x36f902(0x1af));}}),_0x3cfdc9[_0x12c0d0(0x114)](xit,'(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId',async()=>{const _0x14b083=_0x12c0d0;try{await _0x56ffb8[_0x14b083(0x25d)]({'id':_0x14b083(0x466),'token':_0x3cfdc9['IRcTN']},{'clientId':_0x3cfdc9[_0x14b083(0x3bb)]}),fail();}catch(_0x4f6236){expect(_0x4f6236[_0x14b083(0x1d1)])[_0x14b083(0x2ea)]('jwt\x20audience\x20invalid.\x20expected:\x20secret');}}),_0x3cfdc9[_0x12c0d0(0x367)](xit,_0x3cfdc9[_0x12c0d0(0x1f2)],async()=>{const _0x5b7f33=_0x12c0d0,_0x1ec673={'QwScO':function(_0x5b18cd,_0x5cdfb2){return _0x5b18cd(_0x5cdfb2);}};if(_0x3cfdc9['fIsef'](_0x5b7f33(0x417),_0x5b7f33(0x469)))try{await _0x56ffb8[_0x5b7f33(0x25d)]({'id':_0x3cfdc9['ypCHx'],'token':_0x3cfdc9[_0x5b7f33(0x1db)]},{'clientId':[_0x5b7f33(0x239)]}),_0x3cfdc9[_0x5b7f33(0x252)](fail);}catch(_0x58de3f){_0x3cfdc9[_0x5b7f33(0x3ec)]('DGgoV',_0x3cfdc9[_0x5b7f33(0x180)])?expect(_0x58de3f[_0x5b7f33(0x1d1)])[_0x5b7f33(0x2ea)]('jwt\x20audience\x20invalid.\x20expected:\x20secret'):_0x1ec673['QwScO'](_0x3d2800,_0x549a3a[_0x5b7f33(0x1d1)])[_0x5b7f33(0x2ea)](_0x5b7f33(0x444));}else return _0xadba48[_0x5b7f33(0x3fb)]({'text':_0x1ce34b['stringify']({'error':'hosting_error'})});}),_0x3cfdc9[_0x12c0d0(0x388)](xit,'should\x20throw\x20error\x20with\x20invalid\x20user\x20id',async()=>{const _0x45c602=_0x12c0d0;try{await _0x56ffb8[_0x45c602(0x25d)]({'id':_0x3cfdc9[_0x45c602(0x3c0)],'token':_0x45c602(0x442)},{'clientId':'INSERT\x20CLIENT\x20ID\x20HERE'}),_0x3cfdc9[_0x45c602(0x245)](fail);}catch(_0x3ca091){expect(_0x3ca091[_0x45c602(0x1d1)])[_0x45c602(0x2ea)](_0x3cfdc9[_0x45c602(0x23a)]);}}),it(_0x3cfdc9[_0x12c0d0(0x308)],async()=>{const _0x2b60f5=_0x12c0d0,_0x9cdeb6={'iss':_0x3cfdc9[_0x2b60f5(0x404)],'aud':_0x3cfdc9[_0x2b60f5(0x2e5)],'sub':_0x3cfdc9[_0x2b60f5(0x116)]},_0x2475ba={'header':{'kid':_0x2b60f5(0x3ee),'alg':_0x3cfdc9[_0x2b60f5(0x3f9)]}},_0x1141c4={'kid':_0x3cfdc9[_0x2b60f5(0x47a)],'rsaPublicKey':'the_rsa_public_key'};_0x3cfdc9[_0x2b60f5(0x328)](spyOn,_0x1118f5,'getHeaderFromToken')[_0x2b60f5(0x2fa)][_0x2b60f5(0x235)](()=>_0x2475ba),spyOn(_0x1118f5,_0x3cfdc9[_0x2b60f5(0x1cb)])[_0x2b60f5(0x2fa)][_0x2b60f5(0x158)](_0x1141c4),_0x3cfdc9[_0x2b60f5(0x415)](spyOn,_0x303e1b,_0x2b60f5(0x12d))[_0x2b60f5(0x2fa)][_0x2b60f5(0x235)](()=>_0x9cdeb6);try{await _0x56ffb8[_0x2b60f5(0x25d)]({'id':_0x3cfdc9['ZhsjM'],'token':_0x2b60f5(0x175)},{'clientId':'secret'}),fail();}catch(_0x314b08){_0x3cfdc9['WJeVq'](expect,_0x314b08['message'])['toBe'](_0x3cfdc9[_0x2b60f5(0x23a)]);}});}),describe(_0x306e7c(0x11f),()=>{const _0x4e4b24=_0x306e7c,_0x1c12de={'PhiYN':'https://static.gc.apple.com/public-key/gc-prod-4.cer','TzZSV':_0x4e4b24(0x13c),'acJdO':'G:1965586982','UdlyR':_0x4e4b24(0x2d4),'yDoOO':_0x4e4b24(0x35a),'UogJQ':_0x4e4b24(0x174),'IvgAM':'gcenter','zlDIx':_0x4e4b24(0x105),'hFZpB':'com.example.com','zoVlO':function(_0x361f94,_0x3a8f02){return _0x361f94(_0x3a8f02);},'Pkypb':'Apple\x20Game\x20Center\x20-\x20invalid\x20signature','TTgJG':'http://static.gc.apple.com/public-key/gc-prod-4.cer','DRzIL':function(_0x37ad4b,_0x3a5ea6){return _0x37ad4b<=_0x3a5ea6;},'ekViy':function(_0x43ea4d,_0x3c24cb){return _0x43ea4d(_0x3c24cb);},'IwsMd':'Apple\x20Game\x20Center\x20auth\x20adapter\x20parameter\x20`rootCertificateURL`\x20is\x20invalid.','tZZod':function(_0x3a767c,_0x213b73){return _0x3a767c+_0x213b73;},'OBhaD':_0x4e4b24(0x424),'qFBue':_0x4e4b24(0x108),'qsyLr':_0x4e4b24(0x431),'uiPCR':function(_0x3cbe12,_0x386cc4,_0x1774c4){return _0x3cbe12(_0x386cc4,_0x1774c4);},'quiBe':'validateAuthData\x20invalid\x20signature\x20id','HrGYA':function(_0x450061,_0x5f3752,_0x10b551){return _0x450061(_0x5f3752,_0x10b551);}},_0x2d02d7=require(_0x4e4b24(0x1dd)),_0x5790f9=require('fs'),_0x448d0a=_0x5790f9['readFileSync'](_0x1c12de[_0x4e4b24(0x2b2)](__dirname,_0x1c12de[_0x4e4b24(0x11e)])),_0x18a586=_0x5790f9[_0x4e4b24(0x385)](__dirname+_0x1c12de[_0x4e4b24(0x11e)]);it(_0x1c12de['qFBue'],async()=>{const _0x52cffa=_0x4e4b24,_0x49aeeb={'gcenter':{'rootCertificateUrl':_0x52cffa(0x13c)}},{adapter:_0xcc4ac2,appIds:_0x3eccae,providerOptions:_0x500c7d}=authenticationLoader[_0x52cffa(0x103)](_0x52cffa(0x124),_0x49aeeb);await _0xcc4ac2[_0x52cffa(0x3b3)](_0x3eccae,{'publicKeyUrl':_0x1c12de[_0x52cffa(0x2f5)]},_0x500c7d);}),it(_0x1c12de[_0x4e4b24(0x2ce)],async()=>{const _0x3a6575=_0x4e4b24,_0x1d0e3d={'gcenter':{'rootCertificateUrl':_0x1c12de['TzZSV']}},{adapter:_0x14706d,appIds:_0x4f9c9b,providerOptions:_0x15d179}=authenticationLoader[_0x3a6575(0x103)](_0x3a6575(0x124),_0x1d0e3d);await _0x14706d[_0x3a6575(0x3b3)](_0x4f9c9b,{'publicKeyUrl':_0x3a6575(0x354)},_0x15d179);const _0x3cf532={'id':_0x1c12de['acJdO'],'publicKeyUrl':_0x3a6575(0x354),'timestamp':0x16c7096de77,'signature':_0x1c12de[_0x3a6575(0x2b0)],'salt':_0x1c12de[_0x3a6575(0x201)],'bundleId':_0x1c12de[_0x3a6575(0x3eb)]};_0x2d02d7[_0x3a6575(0x29a)][_0x3a6575(0x354)]=_0x448d0a,await _0x2d02d7[_0x3a6575(0x25d)](_0x3cf532);}),_0x1c12de[_0x4e4b24(0x2bb)](it,_0x1c12de['quiBe'],async()=>{const _0x727199=_0x4e4b24;_0x2d02d7[_0x727199(0x29a)][_0x727199(0x354)]=_0x448d0a,_0x2d02d7['cache']['https://static.gc.apple.com/public-key/gc-prod-6.cer']=_0x18a586;const {adapter:_0x4fbe94,appIds:_0x438a5b,providerOptions:_0x3112e7}=authenticationLoader[_0x727199(0x103)](_0x1c12de[_0x727199(0x19b)],{});await _0x4fbe94[_0x727199(0x3b3)](_0x438a5b,{'publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer'},_0x3112e7);const _0xccc1c4={'id':_0x1c12de[_0x727199(0x247)],'publicKeyUrl':_0x1c12de['zlDIx'],'timestamp':0x16c7096de77,'signature':'1234','salt':_0x727199(0x35a),'bundleId':_0x1c12de[_0x727199(0x316)]};await _0x1c12de[_0x727199(0x3e2)](expectAsync,_0x2d02d7[_0x727199(0x25d)](_0xccc1c4))[_0x727199(0x289)](new Parse[(_0x727199(0x2d8))](Parse[_0x727199(0x2d8)][_0x727199(0x290)],_0x1c12de[_0x727199(0x429)]));}),_0x1c12de[_0x4e4b24(0x28d)](it,_0x4e4b24(0x2f0),async()=>{const _0x33ebb8=_0x4e4b24,_0x6ef0d1={'gcenter':{'rootCertificateUrl':_0x33ebb8(0x13c)}},{adapter:_0x29fe77,appIds:_0x39e28b,providerOptions:_0x34e15e}=authenticationLoader[_0x33ebb8(0x103)](_0x1c12de[_0x33ebb8(0x19b)],_0x6ef0d1);await _0x29fe77[_0x33ebb8(0x3b3)](_0x39e28b,{'publicKeyUrl':'https://static.gc.apple.com/public-key/gc-prod-4.cer'},_0x34e15e);const _0x20e214=[_0x33ebb8(0x2c1),_0x1c12de[_0x33ebb8(0x3c8)],_0x33ebb8(0x142),_0x33ebb8(0x2c2),_0x33ebb8(0x326)];await Promise['all'](_0x20e214['map'](_0x4bd214=>expectAsync(_0x2d02d7[_0x33ebb8(0x25d)]({'id':_0x33ebb8(0x391),'timestamp':0x16c7096de77,'publicKeyUrl':_0x4bd214,'signature':_0x33ebb8(0xfc),'salt':_0x33ebb8(0x35a),'bundleId':_0x33ebb8(0x274)}))[_0x33ebb8(0x289)](new Parse[(_0x33ebb8(0x2d8))](Parse['Error'][_0x33ebb8(0x290)],_0x33ebb8(0x256)+_0x4bd214))));}),_0x1c12de[_0x4e4b24(0x2bb)](it,_0x4e4b24(0x36f),async()=>{const _0x4eae86=_0x4e4b24,_0x56c2e0={'gcenter':{'rootCertificateUrl':_0x1c12de[_0x4eae86(0x17c)]}},{adapter:_0x5bb778,appIds:_0x34bec4,providerOptions:_0x2974bd}=authenticationLoader[_0x4eae86(0x103)](_0x1c12de[_0x4eae86(0x19b)],_0x56c2e0);await _0x5bb778['validateAppId'](_0x34bec4,{'publicKeyUrl':_0x1c12de[_0x4eae86(0x2f5)]},_0x2974bd),_0x1c12de[_0x4eae86(0x3e2)](expect,()=>_0x2d02d7[_0x4eae86(0x187)](_0x448d0a,'https://static.gc.apple.com/public-key/gc-prod-4.cer'));}),_0x1c12de[_0x4e4b24(0x2bb)](it,_0x4e4b24(0x42c),async()=>{const _0x4c9985=_0x4e4b24,_0xa2e32f={'gcenter':{}},{adapter:_0x4d5e3d,appIds:_0xafd8ca,providerOptions:_0x28e622}=authenticationLoader[_0x4c9985(0x103)](_0x1c12de[_0x4c9985(0x19b)],_0xa2e32f);await _0x4d5e3d['validateAppId'](_0xafd8ca,{'publicKeyUrl':_0x1c12de['PhiYN']},_0x28e622);const _0x55050b=new Date();await _0x4d5e3d[_0x4c9985(0x3b3)](_0xafd8ca,{'publicKeyUrl':_0x1c12de['PhiYN']},_0x28e622);const _0x3468c2=new Date()[_0x4c9985(0x394)]()-_0x55050b['getTime']();expect(_0x1c12de['DRzIL'](_0x3468c2,0x1))['toBe'](!![]);}),_0x1c12de['HrGYA'](it,_0x4e4b24(0x45b),async()=>{const _0x3d4758=_0x4e4b24,_0x5d6588={'gcenter':{'rootCertificateUrl':'https://example.com'}},{adapter:_0x2b594d,appIds:_0x4dfb71,providerOptions:_0x58a75f}=authenticationLoader['loadAuthAdapter'](_0x1c12de[_0x3d4758(0x19b)],_0x5d6588);await _0x1c12de[_0x3d4758(0x40c)](expectAsync,_0x2b594d['validateAppId'](_0x4dfb71,{'publicKeyUrl':_0x3d4758(0x354)},_0x58a75f))[_0x3d4758(0x289)](new Parse[(_0x3d4758(0x2d8))](Parse[_0x3d4758(0x2d8)]['OBJECT_NOT_FOUND'],_0x1c12de[_0x3d4758(0x3a9)]));});}),describe(_0x306e7c(0x341),()=>{const _0x3cbde6=_0x306e7c,_0x5b76c7={'YYxhW':function(_0x39ecff){return _0x39ecff();},'XJsMJ':function(_0x565d56,_0x1657b9){return _0x565d56(_0x1657b9);},'QnXjo':function(_0x3d940e,_0x23dcff){return _0x3d940e(_0x23dcff);},'kMDNc':_0x3cbde6(0x403),'RubWk':'phantauth','UAPOP':_0x3cbde6(0x321),'ekKrl':'WMrRB','cLugU':_0x3cbde6(0x400),'xQQDF':_0x3cbde6(0x428)},_0x51fbab=_0x5b76c7['XJsMJ'](require,'../lib/Adapters/Auth/httpsRequest');it(_0x5b76c7['xQQDF'],async()=>{const _0x3eeba4=_0x3cbde6,_0x4c6e11={'qhMHu':function(_0x2e433e){const _0x17a84b=_0xab88;return _0x5b76c7[_0x17a84b(0x25a)](_0x2e433e);},'FjGbl':function(_0x24a731,_0x691f7b){const _0x2d8c7d=_0xab88;return _0x5b76c7[_0x2d8c7d(0x14a)](_0x24a731,_0x691f7b);},'knHYF':_0x3eeba4(0x199),'FjMIy':function(_0x19cd2e,_0x3989b0){return _0x5b76c7['QnXjo'](_0x19cd2e,_0x3989b0);}},_0x57affa={'id':'fakeid','access_token':_0x5b76c7[_0x3eeba4(0x260)]},{adapter:_0x123606}=authenticationLoader[_0x3eeba4(0x103)](_0x5b76c7[_0x3eeba4(0x15d)],{});spyOn(_0x51fbab,_0x5b76c7[_0x3eeba4(0x3d8)])[_0x3eeba4(0x2fa)][_0x3eeba4(0x235)](()=>Promise[_0x3eeba4(0x253)]({'sub':'invalidID'}));try{if(_0x5b76c7['ekKrl']===_0x5b76c7[_0x3eeba4(0x192)]){const _0x3818cb=_0x4c6e11[_0x3eeba4(0x3c3)](_0x38fac3,{'customAuthentication':{'module':_0x893bde[_0x3eeba4(0x253)](_0x4c6e11[_0x3eeba4(0x395)]),'options':{'token':_0x3eeba4(0x3e6)}}});_0x1fea4a(_0x3818cb);const {validator:_0x5c4ba6}=_0x3818cb[_0x3eeba4(0x40e)](_0x3eeba4(0x2b3));_0x4c6e11['FjMIy'](_0x47ea99,_0x5c4ba6),_0x5c4ba6({'token':'valid-token'},{},{})[_0x3eeba4(0x173)](()=>{_0x1791f2();},_0x51f2af=>{_0x2c29ae(_0x51f2af),_0x4c6e11['qhMHu'](_0x319bc1);});}else await _0x123606[_0x3eeba4(0x25d)](_0x57affa),fail();}catch(_0x5c3ecc){_0x5b76c7[_0x3eeba4(0x14a)](expect,_0x5c3ecc[_0x3eeba4(0x1d1)])[_0x3eeba4(0x2ea)](_0x3eeba4(0x345));}});}),describe(_0x306e7c(0x2a7),()=>{const _0x5a0008=_0x306e7c,_0x3e00c2={'yvqoe':'JqKam','ABGLE':function(_0x56ae76,_0x327aec,_0x3b6784){return _0x56ae76(_0x327aec,_0x3b6784);},'UbjlQ':_0x5a0008(0x2f4),'vTnCh':'fake@mail.com','jzHas':function(_0x25806a,_0x3fdb98){return _0x25806a(_0x3fdb98);},'blUIU':function(_0x92fe7f,_0x25d031,_0x528026){return _0x92fe7f(_0x25d031,_0x528026);},'ZRAwj':_0x5a0008(0x1f4),'oYGYl':_0x5a0008(0x111)},_0x166d96=require(_0x5a0008(0x411)),_0x451af7=_0x3e00c2[_0x5a0008(0x287)](require,_0x5a0008(0x156));_0x3e00c2[_0x5a0008(0x1b8)](it,_0x3e00c2['ZRAwj'],async()=>{const _0x54bce3=_0x5a0008,_0x2e1574={'xXJSn':'userMail'};_0x3e00c2['yvqoe']===_0x54bce3(0x314)?(_0x3e00c2[_0x54bce3(0x311)](spyOn,_0x451af7,_0x54bce3(0x321))[_0x54bce3(0x2fa)][_0x54bce3(0x235)](()=>{const _0x4012b9=_0x54bce3;return Promise[_0x4012b9(0x253)]({'id':_0x4012b9(0x21b),'mail':_0x2e1574[_0x4012b9(0x3c9)]});}),await _0x166d96[_0x54bce3(0x25d)]({'id':_0x54bce3(0x21b),'access_token':_0x54bce3(0x175)})):_0x41dd9f(_0x2ed0f5);}),_0x3e00c2[_0x5a0008(0x1b8)](it,_0x3e00c2[_0x5a0008(0x372)],_0x3ff340=>{const _0x2931e0=_0x5a0008,_0x239117={'mqlbl':function(_0x38ff7e,_0x31c3dc){return _0x38ff7e(_0x31c3dc);},'KidAo':_0x3e00c2[_0x2931e0(0x23c)],'bZOmi':function(_0xfb8ec7){return _0xfb8ec7();}},_0xedd7b4={'id':'fake-id','mail':_0x3e00c2['vTnCh'],'access_token':_0x2931e0(0x28e)};_0x166d96[_0x2931e0(0x25d)](_0xedd7b4)[_0x2931e0(0x173)](_0x3ff340[_0x2931e0(0x334)],_0xf4550b=>{const _0x417f5b=_0x2931e0;expect(_0xf4550b[_0x417f5b(0x26b)])[_0x417f5b(0x2ea)](Parse['Error'][_0x417f5b(0x344)]),_0x239117[_0x417f5b(0x47d)](expect,_0xf4550b[_0x417f5b(0x1d1)])['toBe'](_0x239117[_0x417f5b(0x472)]),_0x239117[_0x417f5b(0x3a2)](_0x3ff340);});});}),describe(_0x306e7c(0x44d),()=>{const _0x1a92f4=_0x306e7c,_0x1f3b26={'NAaFF':function(_0x4532a9){return _0x4532a9();},'rppVC':function(_0x18e359,_0x2730f2){return _0x18e359(_0x2730f2);},'kBAJt':'Facebook\x20auth\x20is\x20not\x20configured.','LQRdv':function(_0x5d30c7,_0x54666d){return _0x5d30c7===_0x54666d;},'RuMZb':_0x1a92f4(0x1b5),'Vgfds':_0x1a92f4(0x309),'baFhb':_0x1a92f4(0x239),'MWSgc':'provided\x20token\x20does\x20not\x20decode\x20as\x20JWT','otqdD':function(_0x37c2d2,_0xa941de){return _0x37c2d2===_0xa941de;},'bTIwb':'XZuWx','AwGPy':_0x1a92f4(0x259),'sILdf':function(_0x53732e,_0x54a598,_0x457557){return _0x53732e(_0x54a598,_0x457557);},'KYrEP':function(_0xf47746,_0x5c0281,_0x287be8){return _0xf47746(_0x5c0281,_0x287be8);},'PcpUc':'verify','CGeai':function(_0x183758,_0x298ff1){return _0x183758(_0x298ff1);},'xyFsF':_0x1a92f4(0x3ee),'hspNF':_0x1a92f4(0x25b),'TgHNY':function(_0x375f3c,_0x325ad5,_0x1a9ec3){return _0x375f3c(_0x325ad5,_0x1a9ec3);},'lZBZa':function(_0x2df2f7,_0x20cbc2,_0x40079c){return _0x2df2f7(_0x20cbc2,_0x40079c);},'BbnZM':_0x1a92f4(0x216),'KVHCA':_0x1a92f4(0x175),'fNXRf':function(_0x4fe407,_0x988a95){return _0x4fe407(_0x988a95);},'ziapC':_0x1a92f4(0x157),'WWjjb':function(_0x4a1e2b,_0x563072){return _0x4a1e2b===_0x563072;},'XTsDY':'pOJfw','AnxkB':function(_0x40bf52){return _0x40bf52();},'lFLHM':_0x1a92f4(0x3fd),'tmbEw':function(_0x45e7d2,_0x3287f6,_0xbf8529){return _0x45e7d2(_0x3287f6,_0xbf8529);},'PtPvn':function(_0x281ce8,_0x37c1b8,_0x4992fe){return _0x281ce8(_0x37c1b8,_0x4992fe);},'pyFnt':_0x1a92f4(0x440),'KaahD':function(_0x63f0a0,_0x439f08,_0x5f10ac){return _0x63f0a0(_0x439f08,_0x5f10ac);},'dRSrE':'getHeaderFromToken','epfeD':function(_0x175269,_0x86bd23,_0x43dc7c){return _0x175269(_0x86bd23,_0x43dc7c);},'QlUEi':function(_0x5e7fd6){return _0x5e7fd6();},'BURzg':function(_0x176a78,_0x4353ab){return _0x176a78(_0x4353ab);},'birFe':_0x1a92f4(0x2b6),'FMqDa':_0x1a92f4(0x178),'OossF':_0x1a92f4(0x43b),'Tezlj':_0x1a92f4(0x466),'plvTU':function(_0x33a17f){return _0x33a17f();},'tMEhP':_0x1a92f4(0x39f),'rocaX':function(_0x3c615b){return _0x3c615b();},'wqxut':_0x1a92f4(0x1a7),'EDzVx':'INSERT\x20FACEBOOK\x20TOKEN\x20HERE','sEKHc':function(_0x3986ad){return _0x3986ad();},'zATqr':function(_0x4bd57a,_0x24996c){return _0x4bd57a(_0x24996c);},'ZrqIV':'facebook','QUNHg':_0x1a92f4(0x1ff),'LSFdo':_0x1a92f4(0x150),'ZNIQI':_0x1a92f4(0x45c),'EjHUr':function(_0x156d3e,_0x551638){return _0x156d3e(_0x551638);},'NYHrK':_0x1a92f4(0x1a1),'GSynO':_0x1a92f4(0x478),'sBlEB':_0x1a92f4(0x2c4),'oIMph':function(_0x552455,_0x18dc73,_0x414821){return _0x552455(_0x18dc73,_0x414821);},'tQxnU':_0x1a92f4(0x138),'mcYaZ':_0x1a92f4(0x28c),'XaVyx':'should\x20throw\x20error\x20if\x20public\x20key\x20used\x20to\x20encode\x20token\x20is\x20not\x20available','oQKDg':function(_0x106a99,_0x1bf8d0){return _0x106a99(_0x1bf8d0);},'SeLJE':_0x1a92f4(0x476),'iNjwf':'should\x20use\x20algorithm\x20from\x20key\x20header\x20to\x20verify\x20id_token\x20(facebook.com)','ngmqZ':_0x1a92f4(0x1f0),'ruLTM':'(using\x20client\x20id\x20as\x20array)\x20should\x20verify\x20id_token\x20(facebook.com)','eEFtt':_0x1a92f4(0x10c),'UpJrm':'(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20with\x20invalid\x20jwt\x20issuer\x20(facebook.com)','iOfAp':'(using\x20client\x20id\x20as\x20string)\x20\x20with\x20token','FKnAP':function(_0x54d8a0,_0x2caca8,_0x384abb){return _0x54d8a0(_0x2caca8,_0x384abb);},'GdUOR':'(using\x20client\x20id\x20as\x20string)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId','jVWcy':function(_0x38ad3f,_0x2ca00e,_0x3baebb){return _0x38ad3f(_0x2ca00e,_0x3baebb);},'mwtUz':_0x1a92f4(0x147)},_0x577d16=require(_0x1a92f4(0x1c9)),_0x4001ea=_0x1f3b26['EjHUr'](require,_0x1f3b26[_0x1a92f4(0x13b)]),_0x25fbfd=require(_0x1f3b26[_0x1a92f4(0x172)]);_0x1f3b26[_0x1a92f4(0x1cf)](xit,_0x1f3b26['sBlEB'],async()=>{const _0x16d2e7=_0x1a92f4;try{await _0x577d16[_0x16d2e7(0x25d)]({},{'clientId':_0x16d2e7(0x239)}),_0x1f3b26[_0x16d2e7(0x33a)](fail);}catch(_0x1f16af){_0x1f3b26[_0x16d2e7(0x3ff)](expect,_0x1f16af[_0x16d2e7(0x1d1)])[_0x16d2e7(0x2ea)](_0x1f3b26[_0x16d2e7(0x337)]);}}),_0x1f3b26[_0x1a92f4(0x263)](xit,_0x1f3b26[_0x1a92f4(0x458)],async()=>{const _0x1bb848=_0x1a92f4;try{await _0x577d16['validateAuthData']({},{'clientId':['secret']}),_0x1f3b26[_0x1bb848(0x33a)](fail);}catch(_0x3d2e34){expect(_0x3d2e34[_0x1bb848(0x1d1)])[_0x1bb848(0x2ea)](_0x1bb848(0x1da));}}),_0x1f3b26[_0x1a92f4(0x1d5)](it,_0x1f3b26[_0x1a92f4(0x181)],async()=>{const _0x33f749=_0x1a92f4,_0x59467b={'YVgGW':function(_0x5cca7,_0x3e8b91){return _0x5cca7(_0x3e8b91);}};if(_0x1f3b26['LQRdv'](_0x1f3b26[_0x33f749(0x193)],_0x33f749(0x1b5)))try{await _0x577d16['validateAuthData']({'id':_0x1f3b26[_0x33f749(0x2a9)],'token':'the_token'},{'clientId':_0x1f3b26[_0x33f749(0x42d)]}),_0x1f3b26[_0x33f749(0x33a)](fail);}catch(_0x589208){expect(_0x589208[_0x33f749(0x1d1)])[_0x33f749(0x2ea)](_0x1f3b26['MWSgc']);}else{const _0x39dacd={'custom':{'validateAppId':()=>{},'validateAuthData':()=>{},'appIds':['a','b']}},{adapter:_0x39d385,appIds:_0x4b5023,providerOptions:_0x44998f}=_0x337b50[_0x33f749(0x103)](_0x33f749(0x26a),_0x39dacd);_0x4d7dd0(_0x39d385),_0x59467b[_0x33f749(0x219)](_0x51d432,_0x4b5023)[_0x33f749(0x452)](['a','b']),_0x461ae6(_0x44998f)['toEqual'](_0x39dacd['custom']);}}),it(_0x1f3b26[_0x1a92f4(0x39e)],async()=>{const _0xa60f49=_0x1a92f4,_0x528d2f={'header':{'kid':_0xa60f49(0x1f8),'alg':_0xa60f49(0x25b)}};try{spyOn(_0x25fbfd,_0xa60f49(0x208))[_0xa60f49(0x2fa)][_0xa60f49(0x235)](()=>_0x528d2f[_0xa60f49(0x41b)]),await _0x577d16[_0xa60f49(0x25d)]({'id':_0x1f3b26[_0xa60f49(0x2a9)],'token':_0xa60f49(0x175)},{'clientId':'secret'}),fail();}catch(_0x3edb92){expect(_0x3edb92['message'])[_0xa60f49(0x2ea)](_0xa60f49(0x3bd)+_0x528d2f['header']['kid']);}}),_0x1f3b26[_0x1a92f4(0x33f)](it_id,_0x1f3b26['SeLJE'])(it)(_0x1f3b26['iNjwf'],async()=>{const _0x14ea2b=_0x1a92f4;if(_0x1f3b26['bTIwb']!==_0x14ea2b(0x170)){if(_0x3f260b===_0x14ea2b(0x2d3)||_0x1f3b26[_0x14ea2b(0x2a8)](_0x56ded0,_0x14ea2b(0x2c6)))return{'access_token':'access_token'};return _0x277f80[_0x14ea2b(0x253)](_0x4f3661[_0x1359be]||{'id':'userId'});}else{const _0xc6c4a0={'iss':_0x14ea2b(0x3fd),'aud':_0x14ea2b(0x239),'exp':Date['now'](),'sub':_0x14ea2b(0x309)},_0x1b3458={'header':{'kid':_0x14ea2b(0x3ee),'alg':_0x14ea2b(0x25b)}},_0x3b9f13={'kid':_0x14ea2b(0x3ee),'rsaPublicKey':_0x1f3b26[_0x14ea2b(0x110)]};_0x1f3b26[_0x14ea2b(0x27e)](spyOn,_0x25fbfd,'getHeaderFromToken')['and'][_0x14ea2b(0x235)](()=>_0x1b3458[_0x14ea2b(0x41b)]),spyOn(_0x25fbfd,_0x14ea2b(0x216))[_0x14ea2b(0x2fa)][_0x14ea2b(0x158)](_0x3b9f13),_0x1f3b26[_0x14ea2b(0x340)](spyOn,_0x4001ea,_0x1f3b26[_0x14ea2b(0x35f)])['and'][_0x14ea2b(0x235)](()=>_0xc6c4a0);const _0x35cd45=await _0x577d16[_0x14ea2b(0x25d)]({'id':_0x14ea2b(0x309),'token':_0x14ea2b(0x175)},{'clientId':'secret'});_0x1f3b26[_0x14ea2b(0x21e)](expect,_0x35cd45)[_0x14ea2b(0x452)](_0xc6c4a0),expect(_0x4001ea['verify'][_0x14ea2b(0x2f1)][_0x14ea2b(0x3ac)]()[_0x14ea2b(0x120)][0x2][_0x14ea2b(0x447)])[_0x14ea2b(0x452)](_0x1b3458['header']['alg']);}}),_0x1f3b26[_0x1a92f4(0x1bd)](it,_0x1a92f4(0x125),async()=>{const _0x2af6c4=_0x1a92f4,_0x15a263={'header':{'kid':_0x1f3b26[_0x2af6c4(0x408)],'alg':_0x1f3b26[_0x2af6c4(0x2a0)]}},_0x298ed3={'kid':_0x1f3b26[_0x2af6c4(0x408)],'rsaPublicKey':'the_rsa_public_key'};_0x1f3b26[_0x2af6c4(0x270)](spyOn,_0x25fbfd,_0x2af6c4(0x208))['and'][_0x2af6c4(0x235)](()=>_0x15a263),_0x1f3b26['lZBZa'](spyOn,_0x25fbfd,_0x1f3b26[_0x2af6c4(0x44c)])[_0x2af6c4(0x2fa)][_0x2af6c4(0x158)](_0x298ed3);try{if(_0x2af6c4(0x20c)===_0x2af6c4(0x20c))await _0x577d16[_0x2af6c4(0x25d)]({'id':_0x1f3b26[_0x2af6c4(0x2a9)],'token':_0x1f3b26['KVHCA']},{'clientId':_0x1f3b26[_0x2af6c4(0x42d)]}),_0x1f3b26['NAaFF'](fail);else return _0xb23f13['User']['logOut']();}catch(_0x562e9b){_0x1f3b26[_0x2af6c4(0x30d)](expect,_0x562e9b[_0x2af6c4(0x1d1)])[_0x2af6c4(0x2ea)](_0x1f3b26['ziapC']);}}),it(_0x1a92f4(0x3fc),async()=>{const _0xc694ae=_0x1a92f4,_0x4a8ac4={'OPXWh':_0xc694ae(0x1a7)};try{_0x1f3b26[_0xc694ae(0x11a)](_0xc694ae(0x197),_0x1f3b26[_0xc694ae(0x3fe)])?_0x3673d8(_0x4bc0d8[_0xc694ae(0x1d1)])[_0xc694ae(0x2ea)](_0x4a8ac4[_0xc694ae(0x14c)]):(await _0x577d16[_0xc694ae(0x25d)]({'id':_0xc694ae(0x309),'token':_0x1f3b26[_0xc694ae(0x34e)]},{'clientId':[_0x1f3b26[_0xc694ae(0x42d)]]}),_0x1f3b26[_0xc694ae(0x101)](fail));}catch(_0x25aad7){expect(_0x25aad7[_0xc694ae(0x1d1)])['toBe'](_0xc694ae(0x444));}}),it_id(_0x1f3b26['ngmqZ'])(it)(_0x1a92f4(0x47e),async()=>{const _0x1d6dd5=_0x1a92f4,_0x12b71a={'iss':_0x1f3b26['lFLHM'],'aud':_0x1d6dd5(0x239),'exp':Date[_0x1d6dd5(0x241)](),'sub':_0x1f3b26['Vgfds']},_0x43a4b5={'header':{'kid':_0x1f3b26[_0x1d6dd5(0x408)],'alg':_0x1d6dd5(0x25b)}},_0x4e266f={'kid':_0x1f3b26['xyFsF'],'rsaPublicKey':_0x1d6dd5(0x259)};_0x1f3b26[_0x1d6dd5(0x27e)](spyOn,_0x25fbfd,'getHeaderFromToken')[_0x1d6dd5(0x2fa)]['callFake'](()=>_0x43a4b5),spyOn(_0x25fbfd,_0x1d6dd5(0x216))[_0x1d6dd5(0x2fa)]['resolveTo'](_0x4e266f),_0x1f3b26['KYrEP'](spyOn,_0x4001ea,'verify')[_0x1d6dd5(0x2fa)][_0x1d6dd5(0x235)](()=>_0x12b71a);const _0x1adbe4=await _0x577d16['validateAuthData']({'id':_0x1d6dd5(0x309),'token':_0x1f3b26['KVHCA']},{'clientId':_0x1f3b26[_0x1d6dd5(0x42d)]});_0x1f3b26[_0x1d6dd5(0x3ff)](expect,_0x1adbe4)[_0x1d6dd5(0x452)](_0x12b71a);}),it_id(_0x1a92f4(0x30f))(it)(_0x1f3b26[_0x1a92f4(0x43a)],async()=>{const _0x4407a7=_0x1a92f4,_0x2d0e52={'iss':'https://www.facebook.com','aud':_0x4407a7(0x239),'exp':Date[_0x4407a7(0x241)](),'sub':_0x4407a7(0x309)},_0x4acc8c={'header':{'kid':_0x1f3b26['xyFsF'],'alg':'RS256'}},_0x2a79ba={'kid':_0x1f3b26[_0x4407a7(0x408)],'rsaPublicKey':_0x4407a7(0x259)};spyOn(_0x25fbfd,'getHeaderFromToken')[_0x4407a7(0x2fa)][_0x4407a7(0x235)](()=>_0x4acc8c),spyOn(_0x25fbfd,_0x1f3b26[_0x4407a7(0x44c)])[_0x4407a7(0x2fa)][_0x4407a7(0x158)](_0x2a79ba),_0x1f3b26['tmbEw'](spyOn,_0x4001ea,_0x1f3b26[_0x4407a7(0x35f)])[_0x4407a7(0x2fa)][_0x4407a7(0x235)](()=>_0x2d0e52);const _0x2754d6=await _0x577d16[_0x4407a7(0x25d)]({'id':_0x1f3b26[_0x4407a7(0x2a9)],'token':_0x1f3b26['KVHCA']},{'clientId':[_0x4407a7(0x239)]});_0x1f3b26[_0x4407a7(0x21e)](expect,_0x2754d6)[_0x4407a7(0x452)](_0x2d0e52);}),_0x1f3b26[_0x1a92f4(0x330)](it_id,'e3f16404-18e9-4a87-a555-4710cfbdac67')(it)(_0x1a92f4(0x3c6),async()=>{const _0x282906=_0x1a92f4,_0x1995cb={'iss':_0x282906(0x3fd),'aud':_0x1f3b26[_0x282906(0x42d)],'exp':Date[_0x282906(0x241)](),'sub':_0x1f3b26['Vgfds']},_0x5af51b={'header':{'kid':'123','alg':_0x1f3b26[_0x282906(0x2a0)]}},_0x2f8098={'kid':_0x1f3b26['xyFsF'],'rsaPublicKey':_0x1f3b26[_0x282906(0x110)]};_0x1f3b26[_0x282906(0x1d5)](spyOn,_0x25fbfd,_0x282906(0x208))[_0x282906(0x2fa)][_0x282906(0x235)](()=>_0x5af51b),_0x1f3b26[_0x282906(0x27e)](spyOn,_0x25fbfd,_0x1f3b26[_0x282906(0x44c)])[_0x282906(0x2fa)][_0x282906(0x158)](_0x2f8098),spyOn(_0x4001ea,_0x1f3b26[_0x282906(0x35f)])[_0x282906(0x2fa)]['callFake'](()=>_0x1995cb);const _0x1b1e07=await _0x577d16[_0x282906(0x25d)]({'id':_0x1f3b26[_0x282906(0x2a9)],'token':_0x282906(0x175)},{'clientId':[_0x1f3b26['baFhb'],_0x1f3b26[_0x282906(0x29b)]]});_0x1f3b26[_0x282906(0x21e)](expect,_0x1b1e07)[_0x282906(0x452)](_0x1995cb);}),it_id(_0x1f3b26['eEFtt'])(it)(_0x1f3b26[_0x1a92f4(0x161)],async()=>{const _0x21b267=_0x1a92f4,_0x516495={'iss':'https://not.facebook.com','sub':_0x21b267(0x309)},_0x1945c4={'header':{'kid':_0x21b267(0x3ee),'alg':_0x1f3b26['hspNF']}},_0x45ee4a={'kid':_0x1f3b26[_0x21b267(0x408)],'rsaPublicKey':'the_rsa_public_key'};_0x1f3b26[_0x21b267(0x1bd)](spyOn,_0x25fbfd,_0x1f3b26['dRSrE'])['and']['callFake'](()=>_0x1945c4),spyOn(_0x25fbfd,_0x21b267(0x216))[_0x21b267(0x2fa)]['resolveTo'](_0x45ee4a),_0x1f3b26[_0x21b267(0x402)](spyOn,_0x4001ea,_0x21b267(0x12d))[_0x21b267(0x2fa)][_0x21b267(0x235)](()=>_0x516495);try{await _0x577d16['validateAuthData']({'id':_0x21b267(0x309),'token':_0x1f3b26[_0x21b267(0x34e)]},{'clientId':_0x1f3b26['baFhb']}),_0x1f3b26['QlUEi'](fail);}catch(_0x313542){_0x1f3b26[_0x21b267(0x145)](expect,_0x313542[_0x21b267(0x1d1)])[_0x21b267(0x2ea)](_0x1f3b26[_0x21b267(0x27c)]);}}),_0x1f3b26[_0x1a92f4(0x31b)](xit,_0x1a92f4(0x439),async()=>{const _0x39c972=_0x1a92f4,_0x2d7969={'iss':_0x1f3b26[_0x39c972(0x460)],'sub':_0x1f3b26['Vgfds']},_0x52f84c={'header':{'kid':_0x39c972(0x3ee),'alg':_0x1f3b26[_0x39c972(0x2a0)]}},_0x2cd8f6={'kid':_0x1f3b26[_0x39c972(0x408)],'rsaPublicKey':_0x39c972(0x259)};spyOn(_0x25fbfd,_0x39c972(0x208))[_0x39c972(0x2fa)][_0x39c972(0x235)](()=>_0x52f84c),spyOn(_0x25fbfd,_0x1f3b26['BbnZM'])[_0x39c972(0x2fa)][_0x39c972(0x158)](_0x2cd8f6),_0x1f3b26[_0x39c972(0x31b)](spyOn,_0x4001ea,_0x1f3b26[_0x39c972(0x35f)])[_0x39c972(0x2fa)]['callFake'](()=>_0x2d7969);try{if(_0x39c972(0x3ab)!==_0x39c972(0x293))await _0x577d16['validateAuthData']({'id':'INSERT\x20ID\x20HERE','token':_0x39c972(0x457)},{'clientId':[_0x1f3b26[_0x39c972(0x2d1)]]}),fail();else return _0x241e91[_0x39c972(0x253)]();}catch(_0xff2f78){expect(_0xff2f78[_0x39c972(0x1d1)])['toBe'](_0x1f3b26[_0x39c972(0x27c)]);}}),_0x1f3b26[_0x1a92f4(0x31b)](it,_0x1f3b26[_0x1a92f4(0x2b5)],async()=>{const _0x2d48ce=_0x1a92f4,_0x24d546={'iss':_0x2d48ce(0x178),'sub':_0x1f3b26[_0x2d48ce(0x2a9)]},_0x1b395d={'header':{'kid':_0x1f3b26[_0x2d48ce(0x408)],'alg':_0x1f3b26[_0x2d48ce(0x2a0)]}},_0x38f05b={'kid':'123','rsaPublicKey':_0x1f3b26['AwGPy']};_0x1f3b26[_0x2d48ce(0x1cf)](spyOn,_0x25fbfd,_0x2d48ce(0x208))[_0x2d48ce(0x2fa)][_0x2d48ce(0x235)](()=>_0x1b395d),_0x1f3b26[_0x2d48ce(0x27e)](spyOn,_0x25fbfd,_0x2d48ce(0x216))[_0x2d48ce(0x2fa)][_0x2d48ce(0x158)](_0x38f05b),_0x1f3b26[_0x2d48ce(0x1d5)](spyOn,_0x4001ea,_0x1f3b26[_0x2d48ce(0x35f)])['and'][_0x2d48ce(0x235)](()=>_0x24d546);try{await _0x577d16[_0x2d48ce(0x25d)]({'id':_0x1f3b26[_0x2d48ce(0x332)],'token':_0x2d48ce(0x457)},{'clientId':'INSERT\x20CLIENT\x20ID\x20HERE'}),_0x1f3b26[_0x2d48ce(0x2a3)](fail);}catch(_0x4e96dd){if(_0x2d48ce(0x204)!==_0x1f3b26['tMEhP'])_0x1f3b26[_0x2d48ce(0x145)](expect,_0x4e96dd[_0x2d48ce(0x1d1)])[_0x2d48ce(0x2ea)](_0x1f3b26['birFe']);else return _0x5b93c6[_0x2d48ce(0x253)]();}}),_0x1f3b26['FKnAP'](xit,_0x1f3b26[_0x1a92f4(0x298)],async()=>{const _0x43cb74=_0x1a92f4;try{await _0x577d16[_0x43cb74(0x25d)]({'id':_0x1f3b26[_0x43cb74(0x332)],'token':_0x43cb74(0x3cd)},{'clientId':_0x1f3b26['baFhb']}),_0x1f3b26['rocaX'](fail);}catch(_0x226e05){expect(_0x226e05[_0x43cb74(0x1d1)])[_0x43cb74(0x2ea)](_0x1f3b26[_0x43cb74(0x39c)]);}}),xit('(using\x20client\x20id\x20as\x20array)\x20should\x20throw\x20error\x20with\x20invalid\x20jwt\x20clientId',async()=>{const _0x2c7095=_0x1a92f4;try{await _0x577d16[_0x2c7095(0x25d)]({'id':_0x2c7095(0x466),'token':_0x1f3b26[_0x2c7095(0x41c)]},{'clientId':['secret']}),_0x1f3b26[_0x2c7095(0x2a2)](fail);}catch(_0x31b96f){_0x1f3b26[_0x2c7095(0x330)](expect,_0x31b96f[_0x2c7095(0x1d1)])[_0x2c7095(0x2ea)]('jwt\x20audience\x20invalid.\x20expected:\x20secret');}}),_0x1f3b26[_0x1a92f4(0x463)](xit,_0x1a92f4(0x237),async()=>{const _0x34c085=_0x1a92f4;try{await _0x577d16[_0x34c085(0x25d)]({'id':_0x1f3b26['QUNHg'],'token':_0x34c085(0x3cd)},{'clientId':_0x34c085(0x43b)}),fail();}catch(_0x2faf59){if(_0x1f3b26[_0x34c085(0x313)]!==_0x34c085(0x150)){const _0x4bbea2={'facebook':{'appIds':['a','b'],'appSecret':_0x1f3b26['baFhb']}},{adapter:_0x1a17b4,appIds:_0x4891d3,providerOptions:_0xfb1b4a}=_0x89b3e7[_0x34c085(0x103)](_0x1f3b26['ZrqIV'],_0x4bbea2);_0x2cef59(_0x1a17b4),_0x1f3b26[_0x34c085(0x3ff)](_0x3482b1,_0x4891d3)[_0x34c085(0x452)](['a','b']),_0x1f3b26[_0x34c085(0x3ff)](_0x151f76,_0xfb1b4a)[_0x34c085(0x452)](_0x4bbea2[_0x34c085(0x16e)]);}else _0x1f3b26[_0x34c085(0x145)](expect,_0x2faf59[_0x34c085(0x1d1)])[_0x34c085(0x2ea)]('auth\x20data\x20is\x20invalid\x20for\x20this\x20user.');}}),_0x1f3b26[_0x1a92f4(0x145)](it_id,_0x1f3b26[_0x1a92f4(0x459)])(it)(_0x1a92f4(0x21d),async()=>{const _0x2cb9c3=_0x1a92f4,_0x58bfb9={'iss':_0x1f3b26['lFLHM'],'aud':_0x2cb9c3(0x2aa),'sub':_0x2cb9c3(0x3e5)},_0x286725={'header':{'kid':'123','alg':'RS256'}},_0x39680f={'kid':_0x2cb9c3(0x3ee),'rsaPublicKey':_0x2cb9c3(0x259)};spyOn(_0x25fbfd,'getHeaderFromToken')[_0x2cb9c3(0x2fa)][_0x2cb9c3(0x235)](()=>_0x286725),spyOn(_0x25fbfd,_0x1f3b26[_0x2cb9c3(0x44c)])['and']['resolveTo'](_0x39680f),_0x1f3b26['PtPvn'](spyOn,_0x4001ea,_0x1f3b26[_0x2cb9c3(0x35f)])[_0x2cb9c3(0x2fa)][_0x2cb9c3(0x235)](()=>_0x58bfb9);try{await _0x577d16['validateAuthData']({'id':_0x1f3b26[_0x2cb9c3(0x2a9)],'token':_0x1f3b26[_0x2cb9c3(0x34e)]},{'clientId':_0x1f3b26['baFhb']}),fail();}catch(_0xd087d5){expect(_0xd087d5[_0x2cb9c3(0x1d1)])[_0x2cb9c3(0x2ea)](_0x1f3b26[_0x2cb9c3(0x2e3)]);}});}),describe(_0x306e7c(0x3ca),()=>{const _0x50f3ef=_0x306e7c,_0x4b0ba9={'Wnsvq':_0x50f3ef(0x409),'SsWYQ':_0x50f3ef(0x433),'DRtjp':_0x50f3ef(0x36c),'nzxOl':'password','ksTcA':function(_0x5b6bd7,_0x306d23){return _0x5b6bd7(_0x306d23);},'aKEQt':function(_0x19082e,_0x4561f5){return _0x19082e(_0x4561f5);},'OuRyU':function(_0x4541de,_0x3af319){return _0x4541de(_0x3af319);},'FYzUn':_0x50f3ef(0x416),'JDWZn':_0x50f3ef(0x374),'mnnax':function(_0x39c30d,_0x3006c7){return _0x39c30d(_0x3006c7);},'wXIcu':function(_0x26f698,_0x5c37de){return _0x26f698(_0x5c37de);},'GStXq':'POST','ntmmO':'authDataResponse','GfytC':function(_0xbc08d3,_0x4ff611){return _0xbc08d3(_0x4ff611);},'SxZbg':_0x50f3ef(0x227),'PlJol':function(_0x38de41,_0xe84a00){return _0x38de41(_0xe84a00);},'MEqNZ':_0x50f3ef(0x2c9),'Dkagb':function(_0x2bb825,_0xebd57a){return _0x2bb825===_0xebd57a;},'bAqwV':_0x50f3ef(0x45a),'ziNIM':function(_0x40a1c5,_0xe44ae5){return _0x40a1c5(_0xe44ae5);},'SItAK':_0x50f3ef(0x376),'SmcMW':'application/json','TGOZj':_0x50f3ef(0x1e4),'hdSme':'rest','EbQrw':_0x50f3ef(0x1df),'zLVFP':function(_0x1cae05,_0x506d02,_0x45731a){return _0x1cae05(_0x506d02,_0x45731a);},'JuOiM':'future\x20logins\x20require\x20TOTP\x20token','WjXJN':_0x50f3ef(0x11c)},_0x454dd7={'Content-Type':_0x4b0ba9[_0x50f3ef(0x1a9)],'X-Parse-Application-Id':_0x4b0ba9[_0x50f3ef(0x1bf)],'X-Parse-REST-API-Key':_0x4b0ba9['hdSme']};beforeEach(async()=>{const _0x2f85d2=_0x50f3ef;await reconfigureServer({'auth':{'mfa':{'enabled':!![],'options':[_0x4b0ba9[_0x2f85d2(0x137)]],'algorithm':_0x4b0ba9['SsWYQ'],'digits':0x6,'period':0x1e}}});}),it(_0x4b0ba9[_0x50f3ef(0x1a8)],async()=>{const _0x44ba77=_0x50f3ef,_0x384fc5=await Parse[_0x44ba77(0x350)][_0x44ba77(0x294)](_0x4b0ba9[_0x44ba77(0x44f)],_0x4b0ba9[_0x44ba77(0x40d)]),_0x5c0ca3=_0x4b0ba9['ksTcA'](require,_0x44ba77(0x2c9)),_0x42c676=new _0x5c0ca3[(_0x44ba77(0x358))](),_0x19d485=new _0x5c0ca3[(_0x44ba77(0x409))]({'algorithm':_0x4b0ba9[_0x44ba77(0x465)],'digits':0x6,'period':0x1e,'secret':_0x42c676}),_0x526e6e=_0x19d485['generate']();await _0x384fc5[_0x44ba77(0x325)]({'authData':{'mfa':{'secret':_0x42c676['base32'],'token':_0x526e6e}}},{'sessionToken':_0x384fc5['getSessionToken']()});const _0x5ea88f=_0x384fc5[_0x44ba77(0x321)](_0x44ba77(0x224));_0x4b0ba9[_0x44ba77(0x2bc)](expect,_0x5ea88f[_0x44ba77(0x1e7)])[_0x44ba77(0x38e)](),_0x4b0ba9['aKEQt'](expect,_0x5ea88f[_0x44ba77(0x1e7)][_0x44ba77(0x191)])[_0x44ba77(0x38e)](),_0x4b0ba9[_0x44ba77(0x33d)](expect,_0x5ea88f[_0x44ba77(0x1e7)][_0x44ba77(0x191)][_0x44ba77(0x2af)](',')['length'])[_0x44ba77(0x452)](0x2),await _0x384fc5[_0x44ba77(0x3d3)](),expect(_0x384fc5['get'](_0x4b0ba9[_0x44ba77(0x1ce)])[_0x44ba77(0x1e7)])[_0x44ba77(0x452)]({'status':_0x4b0ba9['JDWZn']});}),_0x4b0ba9['zLVFP'](it,_0x50f3ef(0x1f9),async()=>{const _0x541337=_0x50f3ef,_0x313fe9=await Parse['User'][_0x541337(0x294)](_0x541337(0x36c),_0x541337(0x1d3)),_0xe32051=_0x4b0ba9[_0x541337(0x1d8)](require,_0x541337(0x2c9)),_0x2bedcc=new _0xe32051['Secret'](),_0x3f81ae=new _0xe32051[(_0x541337(0x409))]({'algorithm':_0x4b0ba9[_0x541337(0x465)],'digits':0x6,'period':0x1e,'secret':_0x2bedcc}),_0x5dbea4=_0x3f81ae[_0x541337(0x342)]();await _0x313fe9[_0x541337(0x325)]({'authData':{'mfa':{'secret':_0x2bedcc[_0x541337(0x1a5)],'token':_0x5dbea4}}},{'sessionToken':_0x313fe9['getSessionToken']()});const _0x2d8333=await _0x4b0ba9[_0x541337(0x37e)](request,{'headers':_0x454dd7,'method':_0x4b0ba9[_0x541337(0x19d)],'url':_0x541337(0x207),'body':JSON[_0x541337(0x2c3)]({'username':_0x4b0ba9[_0x541337(0x44f)],'password':'password','authData':{'mfa':{'token':_0x3f81ae[_0x541337(0x342)]()}}})})[_0x541337(0x173)](_0xbf27ff=>_0xbf27ff['data']);expect(_0x2d8333['objectId'])[_0x541337(0x452)](_0x313fe9['id']),expect(_0x2d8333['sessionToken'])[_0x541337(0x38e)](),expect(_0x2d8333[_0x541337(0x416)])[_0x541337(0x452)]({'mfa':{'status':_0x4b0ba9[_0x541337(0x3af)]}}),expect(Object[_0x541337(0x226)](_0x2d8333)[_0x541337(0x128)]())['toEqual']([_0x541337(0x31d),_0x4b0ba9[_0x541337(0x44f)],_0x541337(0x3f5),_0x541337(0x436),_0x4b0ba9['FYzUn'],_0x541337(0x1ac),_0x541337(0x37c),_0x4b0ba9['ntmmO']][_0x541337(0x128)]());}),_0x4b0ba9[_0x50f3ef(0x36b)](it,_0x50f3ef(0x324),async()=>{const _0x54db55=_0x50f3ef,_0x54a2cb=await Parse[_0x54db55(0x350)][_0x54db55(0x294)](_0x54db55(0x36c),_0x54db55(0x1d3)),_0x976eaa=require('otpauth'),_0x52d372=new _0x976eaa[(_0x54db55(0x358))](),_0x4af070=new _0x976eaa[(_0x54db55(0x409))]({'algorithm':_0x4b0ba9[_0x54db55(0x465)],'digits':0x6,'period':0x1e,'secret':_0x52d372}),_0x200c5a=_0x4af070[_0x54db55(0x342)]();await _0x54a2cb['save']({'authData':{'mfa':{'secret':_0x52d372[_0x54db55(0x1a5)],'token':_0x200c5a}}},{'sessionToken':_0x54a2cb[_0x54db55(0x2a6)]()});const _0x49c54e=new _0x976eaa[(_0x54db55(0x358))](),_0x50ec13=new _0x976eaa['TOTP']({'algorithm':_0x54db55(0x433),'digits':0x6,'period':0x1e,'secret':_0x49c54e}),_0x5786eb=_0x50ec13[_0x54db55(0x342)]();await _0x54a2cb[_0x54db55(0x325)]({'authData':{'mfa':{'secret':_0x49c54e[_0x54db55(0x1a5)],'token':_0x5786eb,'old':_0x4af070['generate']()}}},{'sessionToken':_0x54a2cb[_0x54db55(0x2a6)]()}),await _0x54a2cb[_0x54db55(0x3d3)]({'useMasterKey':!![]}),_0x4b0ba9[_0x54db55(0x2fc)](expect,_0x54a2cb[_0x54db55(0x321)](_0x54db55(0x416))[_0x54db55(0x1e7)][_0x54db55(0x239)])[_0x54db55(0x452)](_0x49c54e[_0x54db55(0x1a5)]);}),it('cannot\x20change\x20OTP\x20with\x20invalid\x20token',async()=>{const _0x2992e6=_0x50f3ef,_0x396535=await Parse[_0x2992e6(0x350)]['signUp'](_0x2992e6(0x36c),_0x4b0ba9[_0x2992e6(0x40d)]),_0x4978e3=require(_0x2992e6(0x2c9)),_0x1cf5c7=new _0x4978e3[(_0x2992e6(0x358))](),_0x3b9978=new _0x4978e3[(_0x2992e6(0x409))]({'algorithm':_0x4b0ba9[_0x2992e6(0x465)],'digits':0x6,'period':0x1e,'secret':_0x1cf5c7}),_0xbaafd8=_0x3b9978[_0x2992e6(0x342)]();await _0x396535[_0x2992e6(0x325)]({'authData':{'mfa':{'secret':_0x1cf5c7[_0x2992e6(0x1a5)],'token':_0xbaafd8}}},{'sessionToken':_0x396535[_0x2992e6(0x2a6)]()});const _0x912949=new _0x4978e3['Secret'](),_0x4572e3=new _0x4978e3[(_0x2992e6(0x409))]({'algorithm':_0x2992e6(0x433),'digits':0x6,'period':0x1e,'secret':_0x912949}),_0x4eb01b=_0x4572e3[_0x2992e6(0x342)]();await expectAsync(_0x396535['save']({'authData':{'mfa':{'secret':_0x912949['base32'],'token':_0x4eb01b,'old':_0x2992e6(0x3ee)}}},{'sessionToken':_0x396535[_0x2992e6(0x2a6)]()}))[_0x2992e6(0x289)](new Parse['Error'](Parse['Error']['OTHER_CAUSE'],_0x4b0ba9[_0x2992e6(0x149)])),await _0x396535[_0x2992e6(0x3d3)]({'useMasterKey':!![]}),_0x4b0ba9[_0x2992e6(0x37e)](expect,_0x396535[_0x2992e6(0x321)](_0x2992e6(0x416))[_0x2992e6(0x1e7)][_0x2992e6(0x239)])[_0x2992e6(0x452)](_0x1cf5c7[_0x2992e6(0x1a5)]);}),it(_0x4b0ba9['JuOiM'],async()=>{const _0x2c8381=_0x50f3ef,_0xc69316=await Parse[_0x2c8381(0x350)][_0x2c8381(0x294)](_0x2c8381(0x36c),'password'),_0x521216=_0x4b0ba9[_0x2c8381(0x392)](require,_0x4b0ba9[_0x2c8381(0x393)]),_0xb1e58c=new _0x521216['Secret'](),_0x2e254f=new _0x521216[(_0x2c8381(0x409))]({'algorithm':_0x4b0ba9[_0x2c8381(0x465)],'digits':0x6,'period':0x1e,'secret':_0xb1e58c}),_0x32275e=_0x2e254f[_0x2c8381(0x342)]();await _0xc69316[_0x2c8381(0x325)]({'authData':{'mfa':{'secret':_0xb1e58c['base32'],'token':_0x32275e}}},{'sessionToken':_0xc69316['getSessionToken']()}),await _0x4b0ba9[_0x2c8381(0x2bc)](expectAsync,Parse['User'][_0x2c8381(0x380)](_0x2c8381(0x36c),_0x4b0ba9[_0x2c8381(0x40d)]))['toBeRejectedWith'](new Parse[(_0x2c8381(0x2d8))](Parse['Error'][_0x2c8381(0x2b9)],'Missing\x20additional\x20authData\x20mfa'));}),it(_0x4b0ba9[_0x50f3ef(0x1b2)],async()=>{const _0x8458ad=_0x50f3ef;if(_0x4b0ba9[_0x8458ad(0x266)]('mDQwI',_0x4b0ba9[_0x8458ad(0x3b2)]))_0x313a0f();else{const _0x2294a2=await Parse[_0x8458ad(0x350)]['signUp'](_0x4b0ba9[_0x8458ad(0x44f)],_0x8458ad(0x1d3)),_0xb5bb6c=require(_0x8458ad(0x2c9)),_0xac2627=new _0xb5bb6c['Secret'](),_0x42b0c5=new _0xb5bb6c[(_0x8458ad(0x409))]({'algorithm':_0x8458ad(0x433),'digits':0x6,'period':0x1e,'secret':_0xac2627}),_0x2b0184=_0x42b0c5[_0x8458ad(0x342)]();await _0x2294a2['save']({'authData':{'mfa':{'secret':_0xac2627[_0x8458ad(0x1a5)],'token':_0x2b0184}}},{'sessionToken':_0x2294a2[_0x8458ad(0x2a6)]()}),await _0x4b0ba9[_0x8458ad(0x195)](expectAsync,request({'headers':_0x454dd7,'method':_0x8458ad(0x448),'url':_0x8458ad(0x207),'body':JSON['stringify']({'username':_0x4b0ba9['DRtjp'],'password':_0x8458ad(0x1d3),'authData':{'mfa':{'token':_0x4b0ba9[_0x8458ad(0x359)]}}})})[_0x8458ad(0x1fb)](_0x51d863=>{const _0x5ba8f1=_0x8458ad;throw _0x51d863[_0x5ba8f1(0x25c)];}))[_0x8458ad(0x289)]({'code':Parse[_0x8458ad(0x2d8)][_0x8458ad(0x290)],'error':_0x4b0ba9[_0x8458ad(0x149)]});}});}),describe(_0x306e7c(0x37d),()=>{const _0xf5b481=_0x306e7c,_0x40dc9f={'DBCUu':_0xf5b481(0x281),'EukdH':function(_0x1b7d69,_0x57e8d6){return _0x1b7d69(_0x57e8d6);},'kDEMH':function(_0x51df8c,_0x2f5e5a){return _0x51df8c(_0x2f5e5a);},'JjqNt':function(_0x219701,_0x13ebda){return _0x219701===_0x13ebda;},'qChqb':_0xf5b481(0x10b),'dIFWz':_0xf5b481(0x36c),'WADEC':function(_0x309b0f,_0x59cf8b){return _0x309b0f(_0x59cf8b);},'BkNrk':_0xf5b481(0x416),'TdXqO':_0xf5b481(0x159),'prurn':'+11111111111','wQlYG':function(_0x1ad0b0,_0x2de4ea){return _0x1ad0b0(_0x2de4ea);},'QeZVI':'token','PifoI':'expiry','hYHdQ':function(_0x4573bd,_0x7995a1,_0x59b598){return _0x4573bd(_0x7995a1,_0x59b598);},'upBtT':'sendSMS','llOqw':_0xf5b481(0x1d3),'vUFFb':_0xf5b481(0x16c),'KWInE':_0xf5b481(0x448),'HUrwp':'request','pwLyX':_0xf5b481(0x207),'WpEnl':_0xf5b481(0x1ac),'VByLg':function(_0x3419da,_0x3e299c){return _0x3419da(_0x3e299c);},'QEaas':_0xf5b481(0x1e4),'jDjjl':_0xf5b481(0x3a4),'GJsJT':function(_0x2695d2,_0x31de5b){return _0x2695d2(_0x31de5b);},'UrEsR':function(_0x5a4337,_0x30c0be,_0x1295bd){return _0x5a4337(_0x30c0be,_0x1295bd);},'UWhzY':_0xf5b481(0x1df),'QoNQV':_0xf5b481(0x35e),'EUNfC':_0xf5b481(0x22d)},_0x139716={'Content-Type':_0xf5b481(0x215),'X-Parse-Application-Id':_0x40dc9f['QEaas'],'X-Parse-REST-API-Key':'rest'};let _0x395dca,_0x4e3cd7;const _0x1e2d20={'enabled':!![],'options':[_0x40dc9f['jDjjl']],'sendSMS'(_0x489855,_0xf1e2a8){const _0x25cf22=_0xf5b481,_0x2eaad7=_0x40dc9f[_0x25cf22(0xfd)][_0x25cf22(0x2af)]('|');let _0x2f9475=0x0;while(!![]){switch(_0x2eaad7[_0x2f9475++]){case'0':_0x40dc9f[_0x25cf22(0x154)](expect,_0xf1e2a8)['toBeDefined']();continue;case'1':_0x40dc9f[_0x25cf22(0x107)](expect,_0x489855['length'])[_0x25cf22(0x452)](0x6);continue;case'2':expect(_0x489855)[_0x25cf22(0x38e)]();continue;case'3':_0x395dca=_0x489855;continue;case'4':_0x4e3cd7=_0xf1e2a8;continue;}break;}},'digits':0x6,'period':0x1e};_0x40dc9f[_0xf5b481(0x26d)](beforeEach,async()=>{const _0x51aab5=_0xf5b481;_0x395dca='',_0x4e3cd7='',await _0x40dc9f[_0x51aab5(0x154)](reconfigureServer,{'auth':{'mfa':_0x1e2d20}});}),_0x40dc9f[_0xf5b481(0x18b)](it,_0x40dc9f[_0xf5b481(0x432)],async()=>{const _0x33e3f4=_0xf5b481;if(_0x40dc9f[_0x33e3f4(0x1b1)](_0x40dc9f[_0x33e3f4(0x300)],_0x33e3f4(0x1ed)))return _0x118622(_0x22573b,_0x16baf9);else{const _0xa87146=await Parse[_0x33e3f4(0x350)]['signUp'](_0x40dc9f['dIFWz'],'password'),_0x358bbc=_0xa87146[_0x33e3f4(0x2a6)](),_0x357823=spyOn(_0x1e2d20,_0x33e3f4(0x3ba))[_0x33e3f4(0x2fa)]['callThrough']();await _0xa87146['save']({'authData':{'mfa':{'mobile':_0x33e3f4(0x449)}}},{'sessionToken':_0x358bbc}),await _0xa87146[_0x33e3f4(0x3d3)]({'sessionToken':_0x358bbc}),_0x40dc9f[_0x33e3f4(0x45d)](expect,_0xa87146[_0x33e3f4(0x321)](_0x40dc9f[_0x33e3f4(0x32c)]))[_0x33e3f4(0x452)]({'mfa':{'status':_0x40dc9f['TdXqO']}}),_0x40dc9f[_0x33e3f4(0x154)](expect,_0x357823)[_0x33e3f4(0x378)](_0x395dca,_0x40dc9f[_0x33e3f4(0x446)]),await _0xa87146[_0x33e3f4(0x3d3)]({'useMasterKey':!![]});const _0x1e577e=_0xa87146[_0x33e3f4(0x321)](_0x40dc9f[_0x33e3f4(0x32c)])[_0x33e3f4(0x1e7)]?.[_0x33e3f4(0x22f)];_0x40dc9f[_0x33e3f4(0x381)](expect,_0x1e577e)[_0x33e3f4(0x38e)](),_0x40dc9f[_0x33e3f4(0x107)](expect,_0x1e577e[_0x33e3f4(0x449)])[_0x33e3f4(0x38e)](),_0x40dc9f['WADEC'](expect,Object[_0x33e3f4(0x226)](_0x1e577e[_0x33e3f4(0x449)]))[_0x33e3f4(0x452)]([_0x40dc9f['QeZVI'],_0x40dc9f[_0x33e3f4(0x271)]]),await _0xa87146[_0x33e3f4(0x325)]({'authData':{'mfa':{'mobile':_0x4e3cd7,'token':_0x395dca}}},{'sessionToken':_0x358bbc}),await _0xa87146[_0x33e3f4(0x3d3)]({'sessionToken':_0x358bbc}),_0x40dc9f[_0x33e3f4(0x107)](expect,_0xa87146['get'](_0x40dc9f[_0x33e3f4(0x32c)]))[_0x33e3f4(0x452)]({'mfa':{'status':_0x33e3f4(0x374)}});}}),it(_0x40dc9f[_0xf5b481(0x462)],async()=>{const _0xa7172f=_0xf5b481,_0x2a025a=await Parse[_0xa7172f(0x350)]['signUp']('username','password'),_0x27c515=_0x40dc9f['hYHdQ'](spyOn,_0x1e2d20,_0x40dc9f['upBtT'])[_0xa7172f(0x2fa)]['callThrough']();await _0x2a025a['save']({'authData':{'mfa':{'mobile':_0xa7172f(0x449)}}},{'sessionToken':_0x2a025a[_0xa7172f(0x2a6)]()}),await _0x2a025a[_0xa7172f(0x325)]({'authData':{'mfa':{'mobile':_0x4e3cd7,'token':_0x395dca}}},{'sessionToken':_0x2a025a[_0xa7172f(0x2a6)]()}),_0x27c515['calls'][_0xa7172f(0x353)](),await _0x40dc9f[_0xa7172f(0x381)](expectAsync,Parse['User'][_0xa7172f(0x380)]('username',_0x40dc9f[_0xa7172f(0x32b)]))[_0xa7172f(0x289)](new Parse[(_0xa7172f(0x2d8))](Parse[_0xa7172f(0x2d8)][_0xa7172f(0x2b9)],_0x40dc9f[_0xa7172f(0x109)]));const _0x3c8658=await request({'headers':_0x139716,'method':_0x40dc9f[_0xa7172f(0x2c5)],'url':_0xa7172f(0x207),'body':JSON[_0xa7172f(0x2c3)]({'username':_0x40dc9f[_0xa7172f(0x2be)],'password':_0xa7172f(0x1d3),'authData':{'mfa':{'token':_0x40dc9f[_0xa7172f(0x220)]}}})})[_0xa7172f(0x1fb)](_0x1accb5=>_0x1accb5[_0xa7172f(0x25c)]);expect(_0x3c8658)['toEqual']({'code':Parse[_0xa7172f(0x2d8)][_0xa7172f(0x290)],'error':_0xa7172f(0x33b)}),_0x40dc9f['wQlYG'](expect,_0x27c515)[_0xa7172f(0x378)](_0x395dca,_0x40dc9f[_0xa7172f(0x446)]);const _0xf481b0=await request({'headers':_0x139716,'method':_0x40dc9f['KWInE'],'url':_0x40dc9f[_0xa7172f(0x132)],'body':JSON[_0xa7172f(0x2c3)]({'username':_0xa7172f(0x36c),'password':_0x40dc9f[_0xa7172f(0x32b)],'authData':{'mfa':{'token':_0x395dca}}})})['then'](_0xab063a=>_0xab063a[_0xa7172f(0x25c)]);expect(_0xf481b0[_0xa7172f(0x31d)])['toEqual'](_0x2a025a['id']),_0x40dc9f[_0xa7172f(0x45d)](expect,_0xf481b0[_0xa7172f(0x37c)])['toBeDefined'](),_0x40dc9f[_0xa7172f(0x45d)](expect,_0xf481b0[_0xa7172f(0x416)])[_0xa7172f(0x452)]({'mfa':{'status':_0xa7172f(0x374)}}),expect(Object[_0xa7172f(0x226)](_0xf481b0)[_0xa7172f(0x128)]())['toEqual']([_0xa7172f(0x31d),_0xa7172f(0x36c),_0xa7172f(0x3f5),_0xa7172f(0x436),_0xa7172f(0x416),_0x40dc9f[_0xa7172f(0x203)],_0xa7172f(0x37c),'authDataResponse'][_0xa7172f(0x128)]());}),it(_0x40dc9f[_0xf5b481(0x255)],async()=>{const _0x523f42=_0xf5b481,_0x5e583c=await Parse[_0x523f42(0x350)][_0x523f42(0x294)](_0x40dc9f[_0x523f42(0x2be)],_0x40dc9f[_0x523f42(0x32b)]);await _0x5e583c[_0x523f42(0x325)]({'authData':{'mfa':{'mobile':_0x40dc9f['prurn']}}});const _0x3d469f=spyOn(_0x1e2d20,_0x523f42(0x3ba))[_0x523f42(0x2fa)]['callThrough']();await Parse[_0x523f42(0x350)]['logIn'](_0x40dc9f[_0x523f42(0x2be)],_0x40dc9f['llOqw']),_0x40dc9f[_0x523f42(0x438)](expect,_0x3d469f)['not'][_0x523f42(0x319)]();});});