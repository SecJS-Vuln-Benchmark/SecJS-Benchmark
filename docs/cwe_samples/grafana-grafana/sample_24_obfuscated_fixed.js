const _0x37eb1c=_0x234d;function _0x40d8(){const _0x5843db=['https://example.com/$(calc.exe)','bQOzN','ftp://example.com/test','oDUJx','xOJAJ','telnet://malicious.com/dir','1sFYJTT','should\x20handle\x20URL\x20with\x20all\x20components','https://www.example.com:$(calc.exe)/foo','AWKKI','RgTfn','fprNc','https://example.com/?key=value%20with%20spaces&another=test','should\x20handle\x20minimal\x20URLs','duDgZ','https://example.com#section\x20with\x20spaces','http://test.com/path/to/resource','JuPNK','toThrow','javascript:$(calc.exe)?response_type=code.....','http://example.com','CEaJQ','oIsMl','aExiP','should\x20encode\x20hash\x20fragments','file:///C:/Windows/System32/calc.exe','should\x20handle\x20edge\x20cases','ynhIr','XVzlq','DnwiD','dIBts','sVMCH','should\x20sanitize:\x20','oBjts','TYmyZ','Oqsph','javascript:eval(\x22malicious\x20code\x22)','nXuHg','CMrAe','should\x20handle\x20URLs\x20with\x20suspicious\x20fragments','should\x20preserve\x20valid\x20URL\x20structure','TZdWm','aqmva','cKwNJ','https://example.com/%24(calc.exe)','toBe','qZFNy','https://user:pass@example.com/secure','WobtI','https://127.0.0.1:8080/','vBDuL','should\x20handle\x20empty\x20query\x20parameter\x20values','oZSWh','32772qgzeOb','bVAmr','aEFop','zVEiW','javascript:$(cmd\x20/c\x20whoami\x20>\x20c:\x5ctemp\x5cpwned.txt)','Invalid\x20url\x20to\x20pass\x20to\x20open()','JJNwq','ptGJX','NekqQ','https://subdomain.example.com/page?param=value#section','ynuFV','https://example.com/#section%2520with%2520spaces','https://exam\x20ple.com','KqqWy','KOuqX','fBJbu','UtIUU','DKtqW','should\x20handle\x20URLs\x20with\x20authentication\x20info','https://example.com#$(calc)','sanitizeUrl','Buond','CPsDl','https://www.google.com/','ojBro','EycCi','EOwNe','https://example.com/#%24(calc)','NLnVK','hZESq','KCTDs','should\x20reject:\x20','kcKlM','360404dpwXoN','oytSz','80DZiCQn','TTtvn','ubfeF','irrCp','http://localhost:3000/','forEach','HSKcV','ZYAIS','KvbAK','http://localhost:3000','https://example.com/path\x20with\x20spaces','PgxGV','ImyUQ','EEATF','1317701AvjPQH','HhuSD','11172623HpeDHY','should\x20handle\x20complex\x20URLs','https://example.com/?param=%24(calc.exe)','rGGSq','should\x20encode\x20query\x20parameters','DWagX','NYeuk','should\x20handle\x20URLs\x20with\x20command\x20injection\x20attempts\x20in\x20path','1755656RDXYPM','zREhp','should\x20handle\x20URLs\x20with\x20suspicious\x20query\x20parameters','https://api.github.com/users/octocat','https://www.$(calc.exe).com/foo','file://c:/windows/system32/calc.exe','liFUc','should\x20handle\x20specific\x20malicious\x20URL\x20with\x20calc.exe\x20in\x20path','AAzeh','vcliz','http://www.a.com/%24(calc.exe)','should\x20handle\x20URLs\x20with\x20port\x20numbers','ztdzn','Shxkh','http://www.a.com/$(calc.exe)','IPBuY','mBfKU','http://example.com/','3414087nZPkVm','data:text/html,<script>alert(\x22XSS\x22)</script>','nzUYy','should\x20allow\x20valid\x20URLs','HVfMb','jiOCI','http://a.com/','https://example.com?key=value\x20with\x20spaces&another=test','witQR','should\x20properly\x20encode\x20URL\x20components','http://user$(calc)r:pass$(calc)word@domain.com','gFeom','10BlzPWH','http://localhost:3000/api','mdwfU','https://127.0.0.1:8080','https://api.example.com/v1/users?limit=10&offset=0#results','https://user:pass@example.com:8080/path/to/resource?param=value&other=test#fragment','7074oDfThp','ssh://test.com/whoami','632igsZTF','http://user%24(calc)r:pass%24(calc)word@domain.com/'];_0x40d8=function(){return _0x5843db;};return _0x40d8();}(function(_0x13d585,_0x538c79){const _0x372169=_0x234d,_0x5d9f11=_0x13d585();while(!![]){try{const _0x50b006=-parseInt(_0x372169(0x20e))/0x1*(parseInt(_0x372169(0x25e))/0x2)+parseInt(_0x372169(0x204))/0x3*(-parseInt(_0x372169(0x206))/0x4)+parseInt(_0x372169(0x260))/0x5*(parseInt(_0x372169(0x23d))/0x6)+-parseInt(_0x372169(0x26e))/0x7+parseInt(_0x372169(0x278))/0x8+-parseInt(_0x372169(0x28a))/0x9*(parseInt(_0x372169(0x1fe))/0xa)+parseInt(_0x372169(0x270))/0xb;if(_0x50b006===_0x538c79)break;else _0x5d9f11['push'](_0x5d9f11['shift']());}catch(_0x5aad34){_0x5d9f11['push'](_0x5d9f11['shift']());}}}(_0x40d8,0x315ce));import{describe,it,expect}from'vitest';function _0x234d(_0x42c093,_0xb0b470){const _0x40d8a5=_0x40d8();return _0x234d=function(_0x234d54,_0x5a30b6){_0x234d54=_0x234d54-0x1f4;let _0x308527=_0x40d8a5[_0x234d54];return _0x308527;},_0x234d(_0x42c093,_0xb0b470);}import{sanitizeUrl}from'./utils';describe(_0x37eb1c(0x251),()=>{const _0x1fe819=_0x37eb1c,_0x52fcbd={'CMrAe':function(_0x18dcdd,_0x17915c){return _0x18dcdd===_0x17915c;},'ynhIr':_0x1fe819(0x25d),'AAzeh':_0x1fe819(0x21c),'witQR':'https://www.google.com','NekqQ':_0x1fe819(0x254),'nXuHg':_0x1fe819(0x218),'sVMCH':_0x1fe819(0x246),'ImyUQ':_0x1fe819(0x269),'NYxNI':_0x1fe819(0x201),'cKwNJ':function(_0x4c6bfa,_0x25cd93,_0x3434e9){return _0x4c6bfa(_0x25cd93,_0x3434e9);},'bVAmr':_0x1fe819(0x20a),'oDUJx':_0x1fe819(0x205),'IPBuY':_0x1fe819(0x20d),'kmknb':_0x1fe819(0x221),'SVwxu':'file://localhost/etc/passwd','SIlRW':_0x1fe819(0x27d),'ztdzn':_0x1fe819(0x22c),'hZESq':_0x1fe819(0x21b),'ZYAIS':_0x1fe819(0x28b),'mmSID':_0x1fe819(0x242),'zREhp':'GRtcV','XVzlq':_0x1fe819(0x210),'AWKKI':function(_0x32d67e,_0x438d71){return _0x32d67e(_0x438d71);},'NLnVK':_0x1fe819(0x26a),'qiJVw':'https://example.com/path%2520with%2520spaces','CPsDl':function(_0x264bb7,_0x474d7a){return _0x264bb7(_0x474d7a);},'tvcXd':_0x1fe819(0x217),'JuPNK':'https://example.com/?empty&hasvalue=test','dIBts':_0x1fe819(0x1fc),'vBDuL':'should\x20reject\x20URLs\x20with\x20spaces\x20in\x20hostname','oIsMl':'should\x20encode\x20special\x20characters\x20in\x20pathname','HhuSD':function(_0x235971,_0x263b74,_0x1d1d8b){return _0x235971(_0x263b74,_0x1d1d8b);},'TZdWm':function(_0x47ef04,_0x14ec85,_0x1a8dbf){return _0x47ef04(_0x14ec85,_0x1a8dbf);},'irrCp':_0x1fe819(0x220),'liFUc':function(_0x167e26,_0x11b4d9,_0x3b3669){return _0x167e26(_0x11b4d9,_0x3b3669);},'CEaJQ':_0x1fe819(0x203),'bQOzN':function(_0x1bb6e6,_0x1fb784){return _0x1bb6e6(_0x1fb784);},'DKtqW':'https://api.example.com/v1/users?limit=10&offset=0#results','qZFNy':_0x1fe819(0x20f),'KvbAK':_0x1fe819(0x230),'NYeuk':function(_0xa87b68,_0x35be9b){return _0xa87b68(_0x35be9b);},'vcliz':function(_0x1867cd,_0x27ac4b,_0x26276e){return _0x1867cd(_0x27ac4b,_0x26276e);},'EOwNe':_0x1fe819(0x283),'xOJAJ':function(_0x451d4a,_0x50142b,_0x5d4efa){return _0x451d4a(_0x50142b,_0x5d4efa);},'TYmyZ':_0x1fe819(0x215),'sSiWB':'https://example.com?param=$(calc.exe)','Shxkh':function(_0x552b79,_0x918c33){return _0x552b79(_0x918c33);},'HVfMb':_0x1fe819(0x250),'JJNwq':_0x1fe819(0x258),'PgxGV':function(_0x4a94fe,_0x10dcdf){return _0x4a94fe(_0x10dcdf);},'PHXUY':function(_0x35c8a6,_0x162cbf){return _0x35c8a6===_0x162cbf;},'mBfKU':_0x1fe819(0x23c),'WobtI':_0x1fe819(0x208),'qgRTb':_0x1fe819(0x234),'jiOCI':_0x1fe819(0x27a),'RgTfn':function(_0x1ccf29,_0x297f5c,_0x937db3){return _0x1ccf29(_0x297f5c,_0x937db3);},'KOuqX':function(_0x453c82,_0x891393,_0x27eec1){return _0x453c82(_0x891393,_0x27eec1);},'Jtiyd':_0x1fe819(0x1f5),'Wcsnb':_0x1fe819(0x1fb),'rGGSq':function(_0x32db5e,_0x3ef270,_0x40b989){return _0x32db5e(_0x3ef270,_0x40b989);},'zVEiW':_0x1fe819(0x271),'ubfeF':_0x1fe819(0x222),'aEFop':'malformed\x20or\x20suspicious\x20URLs'};_0x52fcbd[_0x1fe819(0x212)](describe,_0x52fcbd['Jtiyd'],()=>{const _0x197cd8=_0x1fe819,_0x1c7532={'ojBro':function(_0x5e3aaa,_0x1f5b7c){const _0x26a92b=_0x234d;return _0x52fcbd[_0x26a92b(0x22e)](_0x5e3aaa,_0x1f5b7c);},'DnwiD':_0x52fcbd[_0x197cd8(0x223)]},_0x4ab31c=[{'input':_0x52fcbd[_0x197cd8(0x280)],'expected':_0x197cd8(0x289)},{'input':_0x52fcbd[_0x197cd8(0x1fa)],'expected':_0x52fcbd[_0x197cd8(0x245)]},{'input':_0x52fcbd[_0x197cd8(0x22d)],'expected':'http://test.com/path/to/resource'},{'input':_0x197cd8(0x27b),'expected':_0x197cd8(0x27b)},{'input':_0x52fcbd[_0x197cd8(0x227)],'expected':_0x52fcbd[_0x197cd8(0x227)]},{'input':_0x52fcbd[_0x197cd8(0x26c)],'expected':_0x197cd8(0x264)},{'input':_0x52fcbd['NYxNI'],'expected':_0x197cd8(0x239)}];_0x4ab31c[_0x197cd8(0x265)](({input:_0x36fe27,expected:_0x1bb2fe})=>{const _0x520a95=_0x197cd8,_0x2e3811={'ynuFV':function(_0x387a77,_0x3917dc){return _0x387a77(_0x3917dc);}};_0x1c7532[_0x520a95(0x255)](_0x520a95(0x25d),_0x1c7532[_0x520a95(0x225)])?it(_0x520a95(0x228)+_0x36fe27,()=>{const _0x5ca743=_0x520a95,_0x5f27b9=sanitizeUrl(_0x36fe27);_0x2e3811[_0x5ca743(0x247)](expect,_0x5f27b9)['toBe'](_0x1bb2fe);}):_0x795a45(_0x520a95(0x25c)+_0x3f2379,()=>{const _0x5396ef=_0x520a95;_0x553d0e(()=>_0x551521(_0x4afa28))[_0x5396ef(0x21a)](_0x5396ef(0x242));});});}),describe('should\x20reject\x20invalid\x20protocols',()=>{const _0x47bf83=_0x1fe819,_0x22d611={'AlMaY':function(_0x9ba908,_0x4be2f7,_0x438d75){return _0x52fcbd['cKwNJ'](_0x9ba908,_0x4be2f7,_0x438d75);}},_0x4dbd22=[_0x52fcbd[_0x47bf83(0x23e)],_0x52fcbd[_0x47bf83(0x20b)],_0x52fcbd[_0x47bf83(0x287)],_0x52fcbd['kmknb'],_0x52fcbd['SVwxu'],_0x52fcbd['SIlRW'],'javascript:alert(\x22XSS\x22)',_0x52fcbd[_0x47bf83(0x284)],_0x52fcbd[_0x47bf83(0x25a)],_0x47bf83(0x241),_0x52fcbd[_0x47bf83(0x267)]];_0x4dbd22[_0x47bf83(0x265)](_0x3b6b80=>{const _0x3496d8=_0x47bf83;_0x22d611['AlMaY'](it,_0x3496d8(0x25c)+_0x3b6b80,()=>{const _0x58c8c7=_0x3496d8;expect(()=>sanitizeUrl(_0x3b6b80))['toThrow'](_0x58c8c7(0x242));});});}),describe('should\x20reject\x20malicious\x20hosts',()=>{const _0x599d4e=_0x1fe819,_0x107695={'EycCi':_0x52fcbd[_0x599d4e(0x279)],'Buond':function(_0x589f9b,_0x4d3902){return _0x589f9b(_0x4d3902);},'mdwfU':_0x599d4e(0x242)},_0x3ac595=[_0x599d4e(0x27c),_0x52fcbd[_0x599d4e(0x224)]];_0x3ac595[_0x599d4e(0x265)](_0x4c5162=>{const _0x3d5150=_0x599d4e,_0x5dd0f5={'nzUYy':_0x52fcbd['mmSID'],'gFeom':function(_0x29f543,_0x40b6aa,_0x8a8842){const _0x271fe9=_0x234d;return _0x52fcbd[_0x271fe9(0x233)](_0x29f543,_0x40b6aa,_0x8a8842);}};_0x3d5150(0x25f)===_0x3d5150(0x25f)?_0x52fcbd[_0x3d5150(0x233)](it,_0x3d5150(0x25c)+_0x4c5162,()=>{const _0x36280b=_0x3d5150,_0x4d0cb3={'tGuOc':function(_0x1a7d05,_0x222421){return _0x1a7d05(_0x222421);}};_0x107695[_0x36280b(0x256)]===_0x107695[_0x36280b(0x256)]?_0x107695[_0x36280b(0x252)](expect,()=>sanitizeUrl(_0x4c5162))[_0x36280b(0x21a)](_0x107695[_0x36280b(0x200)]):_0x4d0cb3['tGuOc'](_0x2e9bd8,()=>_0x2c276d('https://exam\x20ple.com'))[_0x36280b(0x21a)]();}):_0x5dd0f5[_0x3d5150(0x1fd)](_0x47476c,'should\x20reject:\x20'+_0x3e1123,()=>{const _0x59593e=_0x3d5150;_0x3a39e3(()=>_0x5b7a64(_0x238164))[_0x59593e(0x21a)](_0x5dd0f5[_0x59593e(0x1f4)]);});});}),describe(_0x52fcbd['Wcsnb'],()=>{const _0x57e369=_0x1fe819,_0x1e9206={'Oqsph':function(_0x3f6ace,_0x1870e4){const _0x50f54c=_0x234d;return _0x52fcbd[_0x50f54c(0x253)](_0x3f6ace,_0x1870e4);},'duDgZ':function(_0x3757f2,_0x356946){return _0x3757f2(_0x356946);},'KqqWy':'https://example.com/?key=value%20with%20spaces&another=test'};it(_0x52fcbd[_0x57e369(0x23a)],()=>{const _0x5b33a3=_0x57e369;_0x1e9206[_0x5b33a3(0x22b)](expect,()=>sanitizeUrl(_0x5b33a3(0x249)))[_0x5b33a3(0x21a)]();}),it(_0x52fcbd[_0x57e369(0x21e)],()=>{const _0x50c955=_0x57e369,_0x16ee34=_0x52fcbd[_0x50c955(0x211)](sanitizeUrl,_0x52fcbd[_0x50c955(0x259)]);expect(_0x16ee34)['toBe'](_0x52fcbd['qiJVw']);}),_0x52fcbd[_0x57e369(0x26f)](it,_0x57e369(0x274),()=>{const _0x354229=_0x57e369,_0x84e6cb=sanitizeUrl(_0x354229(0x1f9));_0x1e9206[_0x354229(0x216)](expect,_0x84e6cb)[_0x354229(0x235)](_0x1e9206[_0x354229(0x24a)]);}),_0x52fcbd[_0x57e369(0x231)](it,_0x52fcbd[_0x57e369(0x263)],()=>{const _0x42452e=_0x57e369;if(_0x52fcbd[_0x42452e(0x22e)](_0x42452e(0x24d),_0x42452e(0x24d))){const _0xb3da03=_0x52fcbd[_0x42452e(0x253)](sanitizeUrl,_0x52fcbd['tvcXd']);_0x52fcbd[_0x42452e(0x253)](expect,_0xb3da03)['toBe'](_0x42452e(0x248));}else{const _0x51c94c=_0x2fadac(_0x42452e(0x1f9));_0x365db9(_0x51c94c)[_0x42452e(0x235)](_0x42452e(0x214));}}),_0x52fcbd['HhuSD'](it,_0x57e369(0x23b),()=>{const _0x29ecc2=_0x57e369,_0x5a1c20=sanitizeUrl('https://example.com?empty&hasvalue=test');expect(_0x5a1c20)[_0x29ecc2(0x235)](_0x52fcbd[_0x29ecc2(0x219)]);}),_0x52fcbd[_0x57e369(0x27e)](it,'should\x20encode\x20basic\x20auth',()=>{const _0x3e50a0=_0x57e369,_0x310cde=sanitizeUrl(_0x52fcbd[_0x3e50a0(0x226)]);expect(_0x310cde)[_0x3e50a0(0x235)](_0x3e50a0(0x207));});}),_0x52fcbd[_0x1fe819(0x273)](describe,_0x52fcbd[_0x1fe819(0x240)],()=>{const _0x53ed49=_0x1fe819,_0x224b60={'KCTDs':_0x52fcbd[_0x53ed49(0x24e)],'HSKcV':function(_0x2703cf,_0x49b93b){return _0x2703cf(_0x49b93b);}};it(_0x52fcbd[_0x53ed49(0x236)],()=>{const _0x53210c=_0x53ed49,_0xc9710e=_0x52fcbd[_0x53210c(0x21d)],_0xab89ec=sanitizeUrl(_0xc9710e);_0x52fcbd[_0x53210c(0x209)](expect,_0xab89ec)[_0x53210c(0x235)](_0x52fcbd[_0x53210c(0x21d)]);}),_0x52fcbd[_0x53ed49(0x231)](it,_0x52fcbd[_0x53ed49(0x268)],()=>{const _0x5b50c0=_0x53ed49,_0x21c621=_0x224b60[_0x5b50c0(0x25b)],_0x23b00d=sanitizeUrl(_0x21c621);_0x224b60[_0x5b50c0(0x266)](expect,_0x23b00d)[_0x5b50c0(0x235)](_0x5b50c0(0x202));});}),describe(_0x52fcbd[_0x1fe819(0x262)],()=>{const _0x312b7e=_0x1fe819,_0xafec7b={'DWagX':function(_0x5b5677,_0x607911){const _0x4b4891=_0x234d;return _0x52fcbd[_0x4b4891(0x253)](_0x5b5677,_0x607911);},'pPcPY':function(_0x2e0711,_0x3764e4){const _0x572c05=_0x234d;return _0x52fcbd[_0x572c05(0x276)](_0x2e0711,_0x3764e4);},'fprNc':'https://user:pass@example.com/secure','EEATF':function(_0x3d38a7,_0x471b59){return _0x52fcbd['bQOzN'](_0x3d38a7,_0x471b59);},'fBJbu':function(_0x4bd8f4,_0x2e45ae){return _0x4bd8f4(_0x2e45ae);},'TTtvn':_0x312b7e(0x1f8)};_0x52fcbd[_0x312b7e(0x281)](it,_0x52fcbd[_0x312b7e(0x257)],()=>{const _0x4293a2=_0x312b7e,_0x3abf00=_0xafec7b[_0x4293a2(0x275)](sanitizeUrl,_0x4293a2(0x1ff));expect(_0x3abf00)['toBe'](_0x4293a2(0x1ff));}),_0x52fcbd[_0x312b7e(0x20c)](it,_0x312b7e(0x24f),()=>{const _0x5215b6=_0x312b7e,_0x94cf20=sanitizeUrl(_0x5215b6(0x237));_0xafec7b['pPcPY'](expect,_0x94cf20)[_0x5215b6(0x235)](_0xafec7b[_0x5215b6(0x213)]);}),it(_0x52fcbd[_0x312b7e(0x22a)],()=>{const _0x2f39e6=_0x312b7e,_0x33da49=_0xafec7b[_0x2f39e6(0x26d)](sanitizeUrl,'http://a.com');_0xafec7b[_0x2f39e6(0x24c)](expect,_0x33da49)['toBe'](_0xafec7b[_0x2f39e6(0x261)]);});}),describe(_0x52fcbd[_0x1fe819(0x23f)],()=>{const _0x521cb0=_0x1fe819,_0x2786e9={'aExiP':_0x521cb0(0x286)};it(_0x52fcbd[_0x521cb0(0x1f7)],()=>{const _0x19a8c5=_0x521cb0,_0x7e5328=sanitizeUrl(_0x52fcbd['sSiWB']);expect(_0x7e5328)[_0x19a8c5(0x235)](_0x19a8c5(0x272));}),_0x52fcbd[_0x521cb0(0x212)](it,_0x521cb0(0x22f),()=>{const _0x2d8afb=_0x521cb0,_0x5bb73f=_0x52fcbd[_0x2d8afb(0x285)](sanitizeUrl,_0x52fcbd[_0x2d8afb(0x1f6)]);expect(_0x5bb73f)[_0x2d8afb(0x235)](_0x52fcbd[_0x2d8afb(0x243)]);}),_0x52fcbd[_0x521cb0(0x233)](it,_0x521cb0(0x277),()=>{const _0x3e05ad=_0x521cb0,_0x490bde={'aqmva':function(_0x128445,_0x9100d3){const _0x4554f3=_0x234d;return _0x52fcbd[_0x4554f3(0x26b)](_0x128445,_0x9100d3);},'oBjts':'Invalid\x20url\x20to\x20pass\x20to\x20open()'};if(_0x52fcbd['PHXUY'](_0x52fcbd[_0x3e05ad(0x288)],_0x3e05ad(0x244)))_0x490bde[_0x3e05ad(0x232)](_0x13e575,()=>_0xbc28f0(_0x4d100b))[_0x3e05ad(0x21a)](_0x490bde[_0x3e05ad(0x229)]);else{const _0x424561=sanitizeUrl(_0x52fcbd[_0x3e05ad(0x238)]);_0x52fcbd[_0x3e05ad(0x253)](expect,_0x424561)[_0x3e05ad(0x235)](_0x52fcbd['qgRTb']);}}),_0x52fcbd[_0x521cb0(0x24b)](it,_0x521cb0(0x27f),()=>{const _0x53a1e7=_0x521cb0,_0x1aef61=sanitizeUrl(_0x2786e9[_0x53a1e7(0x21f)]);expect(_0x1aef61)[_0x53a1e7(0x235)](_0x53a1e7(0x282));});});});