const _0x42bb3e=_0x239c;function _0x239c(_0x1cf43f,_0xd258cc){const _0x93e063=_0x93e0();return _0x239c=function(_0x239c3e,_0x2b7de5){_0x239c3e=_0x239c3e-0x6d;let _0x3d62ae=_0x93e063[_0x239c3e];return _0x3d62ae;},_0x239c(_0x1cf43f,_0xd258cc);}(function(_0x4e8bdf,_0x3eaa2c){const _0x3e5aec=_0x239c,_0x3e1a14=_0x4e8bdf();while(!![]){try{const _0x19a466=parseInt(_0x3e5aec(0xe5))/0x1+parseInt(_0x3e5aec(0xe8))/0x2+-parseInt(_0x3e5aec(0xac))/0x3*(parseInt(_0x3e5aec(0x8e))/0x4)+parseInt(_0x3e5aec(0x70))/0x5*(-parseInt(_0x3e5aec(0xd3))/0x6)+parseInt(_0x3e5aec(0x87))/0x7*(parseInt(_0x3e5aec(0x77))/0x8)+-parseInt(_0x3e5aec(0x73))/0x9*(parseInt(_0x3e5aec(0xc4))/0xa)+-parseInt(_0x3e5aec(0x8c))/0xb;if(_0x19a466===_0x3eaa2c)break;else _0x3e1a14['push'](_0x3e1a14['shift']());}catch(_0x2d5a01){_0x3e1a14['push'](_0x3e1a14['shift']());}}}(_0x93e0,0xbbf89));const request=require(_0x42bb3e(0xd8));function createProduct(){const _0x2c2ede=_0x42bb3e,_0xf3cefc={'jtzIF':'a\x20product','QhMTQ':_0x2c2ede(0xbf),'IrdgL':_0x2c2ede(0xa4)},_0x55f531=new Parse[(_0x2c2ede(0x72))]('name',{'base64':new Buffer(_0x2c2ede(0x82),_0x2c2ede(0xc6))[_0x2c2ede(0xd9)](_0xf3cefc[_0x2c2ede(0xea)])},'text');return setInterval(_0x2c2ede(0x91),0x3e8),_0x55f531[_0x2c2ede(0xeb)]()[_0x2c2ede(0x6e)](function(){const _0x1969fe=_0x2c2ede,_0x52c280={'DXkRU':_0x1969fe(0x82),'eFnHt':'base64','twxYf':_0x1969fe(0x90)},_0x3ff22b=new Parse[(_0x1969fe(0xee))]('_Product');return _0x3ff22b[_0x1969fe(0x7a)]({'download':_0x55f531,'icon':_0x55f531,'title':_0x1969fe(0xc2),'subtitle':_0xf3cefc['jtzIF'],'order':0x1,'productIdentifier':_0xf3cefc[_0x1969fe(0x97)]}),setTimeout(function(){const _0xc64e4f=_0x1969fe,_0x1d87c3={'YvyfB':_0x52c280[_0xc64e4f(0x86)],'rqCXf':'utf-8','IpVtO':_0x52c280['eFnHt'],'DQhDh':_0xc64e4f(0x71),'KyMxu':_0xc64e4f(0x91)};if(_0x52c280[_0xc64e4f(0xce)]!==_0x52c280[_0xc64e4f(0xce)]){const _0x481da2={'UseOM':_0xc64e4f(0xa0),'kVYtv':_0xc64e4f(0xbf)},_0x47876c=new _0x554134['File'](_0xc64e4f(0xaa),{'base64':new _0x49f6a0(_0x1d87c3[_0xc64e4f(0xca)],_0x1d87c3[_0xc64e4f(0xab)])[_0xc64e4f(0xd9)](_0x1d87c3[_0xc64e4f(0xc3)])},_0x1d87c3[_0xc64e4f(0xb4)]);return _0x47704e(_0x1d87c3[_0xc64e4f(0x93)],0x3e8),_0x47876c[_0xc64e4f(0xeb)]()[_0xc64e4f(0x6e)](function(){const _0x42453c=_0xc64e4f,_0xec7019=new _0xd9dac8[(_0x42453c(0xee))](_0x481da2[_0x42453c(0x98)]);return _0xec7019[_0x42453c(0x7a)]({'download':_0x47876c,'icon':_0x47876c,'title':_0x42453c(0xc2),'subtitle':'a\x20product','order':0x1,'productIdentifier':_0x481da2[_0x42453c(0x80)]}),_0x5af89e(function(){const _0x528df9=_0x42453c;_0x3352cf[_0x528df9(0xd1)](_0x528df9(0x96));},0x64),_0xec7019['save']();});}else console[_0xc64e4f(0xd1)](_0xc64e4f(0x96));},0x64),_0x3ff22b['save']();});}function _0x93e0(){const _0x463673=['DWuHr','diMJg','uvvLE','YvyfB','Should\x20not\x20be\x20able\x20to\x20save','INCORRECT_TYPE','hmElo','twxYf','title','pDYgr','log','should\x20not\x20be\x20able\x20to\x20remove\x20a\x20require\x20key\x20in\x20a\x20_Product','3430902tWiUQQ','Error','var\x20x\x20=\x2042;\x20return\x20x;','KqNof','rest','../lib/request','toString','receipt','another-product','obdyZ','ZZjQa','application/json','INVALID_JSON','TraKL','bmPyN','KnCXo','ubcYV','data','511444rmVEGu','HxzGL','lJjmP','1995820gmrAOz','xjoRB','IrdgL','save','SxRbR','object','Object','wBFyi','VamaJ','DhDjk','download','Query','http://localhost:8378/1/validate_purchase','then','OeiZI','5lumeOv','text','File','137916ZnjtxH','fjayX','status','a\x20new\x20title','160312uRfwQl','KelVR','Body\x20is\x20not\x20an\x20object','set','WIcPi','mOclW','ORJHX','qZeiD','Bytes','kVYtv','downloadName','download_file','POST','catch','IwQGP','DXkRU','462hJUmhy','hEzTN','__type','error','jPHEw','13978019ChojmG','message','4VDMSAt','zwLCG','DUGIu','updateClock();','should\x20fail\x20for\x20missing\x20product\x20identifier','KyMxu','QAXJd','return\x20new\x20Date();','safe','QhMTQ','UseOM','tfxnH','xWBAz','MYXlu','jFmdd','reject','get','lDSYx','_Product','toEqual','Should\x20not\x20succeed','tLYze','base64','rMDmf','NMqLg','LwykE','mdAfv','test','name','rqCXf','152667mXkcun','OwKqq','first','WNQVK','shXdV','should\x20fail\x20at\x20appstore\x20validation','toBe','rniXv','DQhDh','mDZHU','return\x20await\x20Promise.resolve(42);','Product\x20should\x20be\x20found','FhuTN','rMvTv','jOlzh','SDgEJ','should\x20bypass\x20appstore\x20validation\x20and\x20not\x20find\x20product','return\x20Object.keys({a:1});','izJAO','a-product','OZDfL','code','a\x20product','IpVtO','110goFBxp','rVUNu','utf-8'];_0x93e0=function(){return _0x463673;};return _0x93e0();}describe('test\x20validate_receipt\x20endpoint',()=>{const _0x4c5954=_0x42bb3e,_0x126095={'SxRbR':function(_0xdd5be1){return _0xdd5be1();},'xWBAz':'safe','JmjiK':function(_0x2d09ac,_0x1cacea){return _0x2d09ac===_0x1cacea;},'tfxnH':function(_0x4f3c8d,_0x576a57){return _0x4f3c8d(_0x576a57);},'mDZHU':_0x4c5954(0x81),'HxzGL':_0x4c5954(0x76),'ORJHX':_0x4c5954(0x83),'lJjmP':_0x4c5954(0xda),'uvvLE':'utf-8','shXdV':_0x4c5954(0xa4),'xjoRB':function(_0x180bac,_0x2508cd){return _0x180bac!=_0x2508cd;},'lDSYx':'object','WIcPi':_0x4c5954(0xe0),'SDgEJ':function(_0x5e0a3a,_0x5298bf){return _0x5e0a3a(_0x5298bf);},'FhuTN':function(_0x484cd5,_0x13cd2f){return _0x484cd5(_0x13cd2f);},'ubcYV':function(_0x376ad5,_0x450ede){return _0x376ad5(_0x450ede);},'jPHEw':_0x4c5954(0xa9),'hEzTN':_0x4c5954(0xd7),'FkjyU':'http://localhost:8378/1/validate_purchase','LwykE':function(_0xf889b,_0xab2208){return _0xf889b(_0xab2208);},'pDYgr':_0x4c5954(0xde),'hmElo':_0x4c5954(0x7f),'ZZjQa':'utf8','izJAO':function(_0x2f7397,_0x213498){return _0x2f7397!=_0x213498;},'MYXlu':_0x4c5954(0x79),'diMJg':function(_0x3a121e,_0x600f88){return _0x3a121e(_0x600f88);},'IwQGP':'Object\x20not\x20found.','vzYXt':_0x4c5954(0xbf),'mdAfv':'OwKqq','OeiZI':function(_0x2c32be,_0xe1d270){return _0x2c32be(_0xe1d270);},'rnKMk':'The\x20data\x20in\x20the\x20receipt-data\x20property\x20was\x20malformed\x20or\x20missing.','dzqpb':_0x4c5954(0xa2),'ppZBT':_0x4c5954(0xb9),'DhDjk':function(_0x148817,_0x200df0){return _0x148817!==_0x200df0;},'jOlzh':'tLYze','Qqvdy':_0x4c5954(0xf2),'VamaJ':function(_0x3ae75b,_0x4c9c0a){return _0x3ae75b(_0x4c9c0a);},'KelVR':_0x4c5954(0xcf),'kyuaQ':function(_0x4d308b){return _0x4d308b();},'rMDmf':_0x4c5954(0xc2),'NMqLg':function(_0x294789,_0x540e43){return _0x294789(_0x540e43);},'zwLCG':_0x4c5954(0x95),'WNQVK':function(_0x2e4eeb,_0x557e27){return _0x2e4eeb(_0x557e27);},'rVUNu':'title\x20is\x20required.','bmPyN':_0x4c5954(0xa0),'eiJSr':function(_0x5b5349,_0x485177){return _0x5b5349(_0x485177);},'rniXv':'should\x20bypass\x20appstore\x20validation','fjayX':function(_0xe5129d,_0x4e6930,_0x511402){return _0xe5129d(_0x4e6930,_0x511402);},'KqNof':function(_0x2dba4d,_0x3045b7,_0x4b2573){return _0x2dba4d(_0x3045b7,_0x4b2573);},'OZDfL':_0x4c5954(0xbc),'jFmdd':_0x4c5954(0xb1),'obdyZ':_0x4c5954(0xd2)};_0x126095['eiJSr'](beforeEach,_0x650606=>{const _0x24aa64=_0x4c5954;_0x126095['JmjiK'](_0x24aa64(0x94),_0x24aa64(0x94))?_0x126095[_0x24aa64(0xec)](createProduct)[_0x24aa64(0x6e)](_0x650606)[_0x24aa64(0x84)](function(_0x1f8d07){const _0x674ba8=_0x24aa64;console[_0x674ba8(0x8a)]({'err':_0x1f8d07}),_0x126095[_0x674ba8(0xec)](_0x650606);}):_0x487c6a[_0x24aa64(0xd1)](_0x126095[_0x24aa64(0x9a)]);}),it(_0x126095[_0x4c5954(0xb3)],async()=>{const _0x3365ea=_0x4c5954,_0x4d5a0e=await request({'headers':{'X-Parse-Application-Id':_0x3365ea(0xa9),'X-Parse-REST-API-Key':_0x3365ea(0xd7),'Content-Type':_0x3365ea(0xde)},'method':_0x126095['ORJHX'],'url':_0x3365ea(0x6d),'body':{'productIdentifier':'a-product','receipt':{'__type':_0x3365ea(0x7f),'base64':new Buffer(_0x126095['lJjmP'],_0x126095['uvvLE'])['toString'](_0x126095[_0x3365ea(0xb0)])},'bypassAppStoreValidation':!![]}}),_0x18f87b=_0x4d5a0e[_0x3365ea(0xe4)];if(_0x126095[_0x3365ea(0xe9)](typeof _0x18f87b,_0x126095[_0x3365ea(0x9f)]))fail(_0x3365ea(0x79));else{if(_0x126095[_0x3365ea(0x7b)]!==_0x3365ea(0xe0))_0x126095[_0x3365ea(0x99)](_0x2e4d05,_0x1889a6['get'](_0x126095[_0x3365ea(0xb5)]))[_0x3365ea(0xa1)](_0x4b78aa[_0x3365ea(0x9e)](_0x3365ea(0xf2))[_0x3365ea(0xaa)]()),_0x37dcc7(_0x4c4b70[_0x3365ea(0x9e)](_0x3365ea(0xcf)))['toEqual'](_0x126095[_0x3365ea(0xe6)]),_0x126095[_0x3365ea(0xec)](_0x1a4563);else{_0x126095[_0x3365ea(0xbb)](expect,_0x18f87b[_0x3365ea(0x89)])['toEqual'](_0x3365ea(0x72));const _0x25ac0d=_0x18f87b['url'],_0xeb0fd8=await _0x126095[_0x3365ea(0xb8)](request,{'url':_0x25ac0d});_0x126095[_0x3365ea(0xe3)](expect,_0xeb0fd8[_0x3365ea(0x71)])[_0x3365ea(0xb2)]('download_file');}}}),_0x126095[_0x4c5954(0x74)](it,'should\x20fail\x20for\x20missing\x20receipt',async()=>{const _0x338e74=_0x4c5954,_0x3da39f=await request({'headers':{'X-Parse-Application-Id':_0x126095[_0x338e74(0x8b)],'X-Parse-REST-API-Key':_0x126095['hEzTN'],'Content-Type':_0x338e74(0xde)},'url':_0x126095['FkjyU'],'method':_0x338e74(0x83),'body':{'productIdentifier':_0x338e74(0xbf),'bypassAppStoreValidation':!![]}})[_0x338e74(0x6e)](fail,_0x5c3f0c=>_0x5c3f0c),_0xbadf94=_0x3da39f['data'];_0x126095[_0x338e74(0xa7)](expect,_0xbadf94[_0x338e74(0xc1)])['toEqual'](Parse['Error'][_0x338e74(0xdf)]);}),_0x126095[_0x4c5954(0xd6)](it,_0x4c5954(0x92),async()=>{const _0x4dbf09=_0x4c5954,_0x310ebe=await request({'headers':{'X-Parse-Application-Id':_0x4dbf09(0xa9),'X-Parse-REST-API-Key':_0x4dbf09(0xd7),'Content-Type':_0x4dbf09(0xde)},'url':_0x4dbf09(0x6d),'method':_0x4dbf09(0x83),'body':{'receipt':{'__type':_0x4dbf09(0x7f),'base64':new Buffer('receipt',_0x126095['uvvLE'])[_0x4dbf09(0xd9)](_0x126095[_0x4dbf09(0xb0)])},'bypassAppStoreValidation':!![]}})['then'](fail,_0x3fcb93=>_0x3fcb93),_0x2b1efb=_0x310ebe[_0x4dbf09(0xe4)];_0x126095[_0x4dbf09(0xbb)](expect,_0x2b1efb[_0x4dbf09(0xc1)])[_0x4dbf09(0xa1)](Parse[_0x4dbf09(0xd4)][_0x4dbf09(0xdf)]);}),it(_0x126095[_0x4c5954(0xc0)],async()=>{const _0x1ce962=_0x4c5954,_0xfa90af=await request({'headers':{'X-Parse-Application-Id':_0x1ce962(0xa9),'X-Parse-REST-API-Key':_0x126095['hEzTN'],'Content-Type':_0x126095[_0x1ce962(0xd0)]},'url':_0x1ce962(0x6d),'method':_0x1ce962(0x83),'body':{'productIdentifier':_0x1ce962(0xdb),'receipt':{'__type':_0x126095[_0x1ce962(0xcd)],'base64':new Buffer(_0x126095[_0x1ce962(0xe7)],_0x126095[_0x1ce962(0xdd)])[_0x1ce962(0xd9)](_0x126095[_0x1ce962(0xb0)])},'bypassAppStoreValidation':!![]}})['catch'](_0x4218e3=>_0x4218e3),_0x4a7c68=_0xfa90af[_0x1ce962(0xe4)];_0x126095[_0x1ce962(0xbe)](typeof _0x4a7c68,_0x1ce962(0xed))?_0x126095['LwykE'](fail,_0x126095[_0x1ce962(0x9b)]):(expect(_0x4a7c68['code'])[_0x1ce962(0xa1)](Parse[_0x1ce962(0xd4)]['OBJECT_NOT_FOUND']),_0x126095[_0x1ce962(0xc8)](expect,_0x4a7c68[_0x1ce962(0x8a)])[_0x1ce962(0xa1)](_0x126095[_0x1ce962(0x85)]));}),_0x126095[_0x4c5954(0x74)](it,_0x126095[_0x4c5954(0x9c)],async()=>{const _0x1557bc=_0x4c5954,_0x2ba3f9={'DWuHr':_0x126095[_0x1557bc(0x9b)]},_0x29d6f9=await request({'headers':{'X-Parse-Application-Id':_0x126095['jPHEw'],'X-Parse-REST-API-Key':_0x126095[_0x1557bc(0x88)],'Content-Type':_0x1557bc(0xde)},'url':_0x1557bc(0x6d),'method':_0x126095[_0x1557bc(0x7d)],'body':{'productIdentifier':_0x126095['vzYXt'],'receipt':{'__type':'Bytes','base64':new Buffer(_0x1557bc(0xda),_0x126095[_0x1557bc(0xc9)])['toString'](_0x126095['shXdV'])}}}),_0xc48fd0=_0x29d6f9[_0x1557bc(0xe4)];typeof _0xc48fd0!='object'?_0x126095[_0x1557bc(0xa8)]!==_0x1557bc(0xad)?_0xa98a0c(_0x2ba3f9[_0x1557bc(0xc7)]):_0x126095['SDgEJ'](fail,_0x126095[_0x1557bc(0x9b)]):(_0x126095[_0x1557bc(0x6f)](expect,_0xc48fd0[_0x1557bc(0x75)])['toBe'](0x520a),_0x126095[_0x1557bc(0xa7)](expect,_0xc48fd0[_0x1557bc(0x8a)])['toBe'](_0x126095['rnKMk']));}),it('should\x20not\x20create\x20a\x20_Product',_0xf1090=>{const _0x4fd86e=_0x4c5954;if(_0x126095['ppZBT']===_0x4fd86e(0xef))_0x3645ef(_0x126095['dzqpb']),_0x7d5d5c();else{const _0x31d4bf=new Parse[(_0x4fd86e(0xee))]('_Product');_0x31d4bf['save']()[_0x4fd86e(0x6e)](function(){const _0x4944f2=_0x4fd86e;fail(_0x4944f2(0xcb)),_0xf1090();},function(_0x204b2a){const _0x2a98f5=_0x4fd86e;expect(_0x204b2a[_0x2a98f5(0xc1)])[_0x2a98f5(0xa1)](Parse[_0x2a98f5(0xd4)]['INCORRECT_TYPE']),_0xf1090();});}}),it('should\x20be\x20able\x20to\x20update\x20a\x20_Product',_0x2ce5a4=>{const _0x5a5f9b=_0x4c5954,_0x55a698={'KnCXo':_0x5a5f9b(0xa0),'XEaEO':_0x126095[_0x5a5f9b(0xa5)],'IjyDH':function(_0x2c733b,_0x3c1347){return _0x2c733b(_0x3c1347);},'mOclW':function(_0x2aca06){return _0x126095['kyuaQ'](_0x2aca06);}},_0xa5b00a=new Parse[(_0x5a5f9b(0xf3))](_0x5a5f9b(0xa0));_0xa5b00a[_0x5a5f9b(0xae)]()[_0x5a5f9b(0x6e)](function(_0x34cdc5){const _0x1984ae=_0x5a5f9b;if(!_0x34cdc5)return new AsyncFunction(_0x1984ae(0xb6))(),Promise[_0x1984ae(0x9d)](new Error(_0x1984ae(0xb7)));return _0x34cdc5[_0x1984ae(0x7a)](_0x1984ae(0xcf),_0x126095[_0x1984ae(0xe6)]),new Function(_0x1984ae(0xd5))(),_0x34cdc5[_0x1984ae(0xeb)]();})[_0x5a5f9b(0x6e)](function(_0x43fe55){const _0x56ea21=_0x5a5f9b;if(_0x126095[_0x56ea21(0xf1)](_0x56ea21(0xa3),_0x126095[_0x56ea21(0xba)])){const _0x59508c=new _0x4da315[(_0x56ea21(0xee))](_0x55a698[_0x56ea21(0xe2)]);return _0x59508c[_0x56ea21(0x7a)]({'download':_0x132a7e,'icon':_0x352e97,'title':_0x55a698['XEaEO'],'subtitle':'a\x20product','order':0x1,'productIdentifier':_0x56ea21(0xbf)}),_0x5123c3(function(){_0x5eff67['log']('safe');},0x64),_0x59508c[_0x56ea21(0xeb)]();}else _0x126095[_0x56ea21(0xb8)](expect,_0x43fe55[_0x56ea21(0x9e)](_0x126095['mDZHU']))['toEqual'](_0x43fe55[_0x56ea21(0x9e)](_0x126095['Qqvdy'])[_0x56ea21(0xaa)]()),_0x126095[_0x56ea21(0xf0)](expect,_0x43fe55[_0x56ea21(0x9e)](_0x126095['KelVR']))['toEqual'](_0x126095[_0x56ea21(0xe6)]),_0x126095['kyuaQ'](_0x2ce5a4);})[_0x5a5f9b(0x84)](function(_0x2a39f9){const _0x5cac61=_0x5a5f9b;_0x55a698['IjyDH'](fail,JSON['stringify'](_0x2a39f9)),_0x55a698[_0x5cac61(0x7c)](_0x2ce5a4);});}),it(_0x126095[_0x4c5954(0xdc)],_0x50cf57=>{const _0x4c84d2=_0x4c5954,_0x456f70={'cpQxo':function(_0x55e6fe,_0x1dd5de){const _0x4dab24=_0x239c;return _0x126095[_0x4dab24(0xaf)](_0x55e6fe,_0x1dd5de);},'DkEOX':_0x126095[_0x4c84d2(0xc5)],'qZeiD':function(_0x7059b3){const _0x435e59=_0x4c84d2;return _0x126095[_0x435e59(0xec)](_0x7059b3);}},_0x3350f0=new Parse[(_0x4c84d2(0xf3))](_0x126095[_0x4c84d2(0xe1)]);_0x3350f0[_0x4c84d2(0xae)]()['then'](function(_0x1173e7){const _0x463030=_0x4c84d2;if(!_0x1173e7)return Function(_0x463030(0xbd))(),Promise[_0x463030(0x9d)](new Error('Product\x20should\x20be\x20found'));return _0x1173e7['unset'](_0x126095[_0x463030(0x78)]),_0x126095[_0x463030(0xa6)](Function,_0x126095[_0x463030(0x8f)])(),_0x1173e7[_0x463030(0xeb)]();})[_0x4c84d2(0x6e)](function(){fail('Should\x20not\x20succeed'),_0x50cf57();})[_0x4c84d2(0x84)](function(_0x15814c){const _0x4e73b0=_0x4c84d2;_0x456f70['cpQxo'](expect,_0x15814c[_0x4e73b0(0xc1)])[_0x4e73b0(0xa1)](Parse[_0x4e73b0(0xd4)][_0x4e73b0(0xcc)]),_0x456f70['cpQxo'](expect,_0x15814c[_0x4e73b0(0x8d)])[_0x4e73b0(0xa1)](_0x456f70['DkEOX']),_0x456f70[_0x4e73b0(0x7e)](_0x50cf57);});});});