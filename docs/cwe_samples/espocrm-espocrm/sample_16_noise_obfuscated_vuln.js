const _0x42be97=_0x42ed;(function(_0x344890,_0x50c73b){const _0x3060a2=_0x42ed,_0x418501=_0x344890();while(!![]){try{const _0x5c58b1=-parseInt(_0x3060a2(0xd9))/0x1+-parseInt(_0x3060a2(0xd8))/0x2*(parseInt(_0x3060a2(0x10b))/0x3)+-parseInt(_0x3060a2(0xd2))/0x4+-parseInt(_0x3060a2(0xeb))/0x5+parseInt(_0x3060a2(0xf7))/0x6*(parseInt(_0x3060a2(0xfc))/0x7)+parseInt(_0x3060a2(0xd4))/0x8+parseInt(_0x3060a2(0xfe))/0x9;if(_0x5c58b1===_0x50c73b)break;else _0x418501['push'](_0x418501['shift']());}catch(_0x1c3f1e){_0x418501['push'](_0x418501['shift']());}}}(_0x5267,0x7f4d9));function _0x5267(){const _0x22c4b0=['3353464rOjVCp','ws:\x20connected\x20to\x20terminal\x20->','2366312AgdNGt','/run','Osqyk','data','28fYunha','9805aFIONN','sesssions','express','upgradeInsts','cAYXf','wiBhV','../utils/log','./remote-common','exit','rows','WfeJN','from','RTZhE','end','send','write','sessionLogger','forEach','4555925UFLpba','params','env','./session','listen','log','YqQXL','lwMJw','close','cols','MyYsf','use','5136XxdLiy','json','YlAPh','query','message','154gBetzK','pid','22854078EYmWQg','debug','keys','error','get','post','Created\x20terminal\x20with\x20PID:','destroy','kill','server','/terminals/:pid','urlencoded','body-parser','122823CSAllL','status','then','pafiB','/terminals/:pid/run-cmd','./dispatch-center'];_0x5267=function(){return _0x22c4b0;};return _0x5267();}const express=require(_0x42be97(0xdb)),app=express(),cors=require('cors'),log=require(_0x42be97(0xdf)),bodyParser=require(_0x42be97(0x10a)),{terminal,testConnection}=require(_0x42be97(0xee)),initWs=require(_0x42be97(0xd1)),{terminals}=require(_0x42be97(0xe0));app[_0x42be97(0xf6)](cors()),app[_0x42be97(0xf6)](bodyParser[_0x42be97(0x109)]({'extended':![]})),app[_0x42be97(0xf6)](bodyParser[_0x42be97(0xf8)]()),require('express-ws')(app),app[_0x42be97(0x103)]('/terminals',async function(_0x5c0dae,_0x52e3c2){const _0x2eebc6=_0x42be97,_0x115985={'pafiB':function(_0x5cd1ce,_0x23a01d,_0x4c6b7d){return _0x5cd1ce(_0x23a01d,_0x4c6b7d);},'YqQXL':_0x2eebc6(0x104)},{body:_0x42530e}=_0x5c0dae,{isTest:_0x413a3f}=_0x5c0dae[_0x2eebc6(0xfa)];if(_0x413a3f){const _0x135c8c=await testConnection(_0x42530e);_0x52e3c2[_0x2eebc6(0xe7)](_0x135c8c),_0x115985[_0x2eebc6(0x10e)](setTimeout,function(){const _0x289de1=_0x2eebc6;if('wiBhV'!==_0x289de1(0xde))try{_0xe19d0f[_0x289de1(0xe8)](_0x3ea783);}catch(_0x34383f){_0x2bb67c[_0x289de1(0x101)](_0x34383f);}else console[_0x289de1(0xf0)]('safe');},0x64);return;}const _0x5ab04c=await terminal(_0x42530e)[_0x2eebc6(0x10d)](_0x316053=>_0x316053)['catch'](_0x158036=>_0x158036),{pid:_0x2289ea}=_0x5ab04c;_0x2289ea?(log[_0x2eebc6(0xff)](_0x115985[_0x2eebc6(0xf1)],_0x2289ea),_0x52e3c2['end'](_0x2289ea)):(_0x52e3c2[_0x2eebc6(0x10c)](0x1f4),_0x52e3c2[_0x2eebc6(0xe6)](_0x5ab04c['stack']));}),app[_0x42be97(0x103)]('/terminals/:pid/size',function(_0x38761f,_0x2f4dca){const _0x40e522=_0x42be97,_0x114e3a={'WfeJN':function(_0x516bf2,_0x5ce43c,_0x5e0fbc){return _0x516bf2(_0x5ce43c,_0x5e0fbc);}},_0x202215=_0x38761f[_0x40e522(0xec)][_0x40e522(0xfd)],{sessionId:_0x157203}=_0x38761f[_0x40e522(0xfa)],_0x578e97=parseInt(_0x38761f[_0x40e522(0xfa)][_0x40e522(0xf4)],0xa),_0x31aee3=parseInt(_0x38761f[_0x40e522(0xfa)][_0x40e522(0xe2)],0xa),_0x2f8237=_0x114e3a[_0x40e522(0xe3)](terminals,_0x202215,_0x157203);_0x2f8237&&_0x2f8237['resize'](_0x578e97,_0x31aee3),_0x2f4dca['end']();}),app[_0x42be97(0x103)](_0x42be97(0x10f),async function(_0x2d30af,_0x2e7c60){const _0x38ce6a=_0x42be97,_0x22f081=_0x2d30af['params'][_0x38ce6a(0xfd)],{sessionId:_0xf1b078}=_0x2d30af[_0x38ce6a(0xfa)],{cmd:_0x5a9c35}=_0x2d30af['body'],_0x38d6cf=terminals(_0x22f081,_0xf1b078);let _0x56e429='';_0x38d6cf&&(_0x56e429=await _0x38d6cf['runCmd'](_0x5a9c35)),_0x2e7c60['end'](_0x56e429);}),app['ws'](_0x42be97(0x108),function(_0x20f576,_0x1feb6c){const _0x5437c4=_0x42be97,_0x4940c8={'Osqyk':function(_0xe22e79,_0x2efee){return _0xe22e79+_0x2efee;},'cAYXf':'YlAPh','lwMJw':_0x5437c4(0xd7)},{sessionId:_0x2c1ec7}=_0x1feb6c[_0x5437c4(0xfa)],_0x28de0d=terminals(_0x1feb6c[_0x5437c4(0xec)][_0x5437c4(0xfd)],_0x2c1ec7),{pid:_0x2020a9}=_0x28de0d;log[_0x5437c4(0xff)](_0x5437c4(0xd3),_0x2020a9),_0x28de0d['on'](_0x4940c8[_0x5437c4(0xf2)],function(_0x42d681){const _0xaa5a59=_0x5437c4;try{_0x28de0d[_0xaa5a59(0xe9)]&&_0x28de0d[_0xaa5a59(0xe9)][_0xaa5a59(0xe8)](_0x42d681),_0x20f576[_0xaa5a59(0xe7)](Buffer[_0xaa5a59(0xe4)](_0x42d681));}catch(_0x1d3c09){}});function _0x2d5f09(){const _0x57aa=_0x5437c4;_0x28de0d['kill'](),log['debug'](_0x4940c8[_0x57aa(0xd6)]('Closed\x20terminal\x20',_0x2020a9)),_0x20f576[_0x57aa(0xf3)]&&_0x20f576[_0x57aa(0xf3)]();}_0x28de0d['on'](_0x5437c4(0xf3),_0x2d5f09),_0x20f576['on'](_0x5437c4(0xfb),function(_0x4dd2b1){const _0x29450f=_0x5437c4,_0x13eebd={'RTZhE':function(_0x53bc8b,_0x43ab3a,_0x3c5dd1){return _0x53bc8b(_0x43ab3a,_0x3c5dd1);}};try{if(_0x4940c8[_0x29450f(0xdd)]===_0x29450f(0xf9))_0x28de0d[_0x29450f(0xe8)](_0x4dd2b1);else{const _0x4e1a01=_0x5f30da[_0x29450f(0xec)][_0x29450f(0xfd)],{sessionId:_0x2413f6}=_0x42f655[_0x29450f(0xfa)],_0x39e750=_0x13eebd[_0x29450f(0xe5)](_0x184e77,_0x1e8453[_0x29450f(0xfa)][_0x29450f(0xf4)],0xa),_0x7d296=_0x4837af(_0x58c18d[_0x29450f(0xfa)][_0x29450f(0xe2)],0xa),_0x4002e8=_0x42a2c0(_0x4e1a01,_0x2413f6);_0x4002e8&&_0x4002e8['resize'](_0x39e750,_0x7d296),_0x4be493[_0x29450f(0xe6)]();}}catch(_0x13a47f){log[_0x29450f(0x101)](_0x13a47f);}}),_0x20f576['on'](_0x5437c4(0x101),log['error']),_0x20f576['on'](_0x5437c4(0xf3),_0x2d5f09);}),app[_0x42be97(0x102)](_0x42be97(0xd5),function(_0x10c375,_0x56fa6d){const _0x345fdb=_0x42be97;_0x56fa6d[_0x345fdb(0xe7)]('ok');}),initWs(app);const runServer=function(){const _0x530a1a=_0x42be97,_0x1520d9={'MyYsf':_0x530a1a(0x107)},{electermPort:_0x17261d,electermHost:_0x24706a}=process[_0x530a1a(0xed)];app[_0x530a1a(0xef)](_0x17261d,_0x24706a,()=>{const _0x4375a0=_0x530a1a;log['info'](_0x1520d9[_0x4375a0(0xf5)],'runs\x20on',_0x24706a,_0x17261d);});},quitServer=()=>{const _0x2883cb=_0x42be97;Object[_0x2883cb(0x100)](global[_0x2883cb(0xdc)])[_0x2883cb(0xea)](_0x437e98=>{const _0x3a7283=_0x2883cb,_0x3fad0b=global[_0x3a7283(0xdc)][_0x437e98];_0x3fad0b&&_0x3fad0b[_0x3a7283(0x105)]&&_0x3fad0b[_0x3a7283(0x105)]();}),Object[_0x2883cb(0x100)](global[_0x2883cb(0xda)])[_0x2883cb(0xea)](_0x30d41e=>{const _0x29dc1e=_0x2883cb,{terminals:_0xf4853f,sftps:_0x4e2811}=global[_0x29dc1e(0xda)][_0x30d41e];_0x4e2811[_0x29dc1e(0xea)](_0x50890a=>{const _0x3c0c08=_0x29dc1e;_0x50890a[_0x3c0c08(0x106)]();}),_0xf4853f[_0x29dc1e(0xea)](_0x5b3c09=>{_0x5b3c09['kill']();});});};function _0x42ed(_0x2fea88,_0x3c5bf1){const _0x526751=_0x5267();return _0x42ed=function(_0x42edfb,_0x17576f){_0x42edfb=_0x42edfb-0xd1;let _0x43046d=_0x526751[_0x42edfb];return _0x43046d;},_0x42ed(_0x2fea88,_0x3c5bf1);}process['on'](_0x42be97(0xe1),quitServer),runServer();