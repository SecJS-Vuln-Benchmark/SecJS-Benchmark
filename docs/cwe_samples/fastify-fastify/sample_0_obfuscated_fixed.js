const _0x573bc3=_0xc951;(function(_0x32bf89,_0xf7a1e4){const _0x4ed35f=_0xc951,_0x59fe0e=_0x32bf89();while(!![]){try{const _0x3156d7=-parseInt(_0x4ed35f(0xeb))/0x1*(-parseInt(_0x4ed35f(0xdc))/0x2)+parseInt(_0x4ed35f(0xdd))/0x3+-parseInt(_0x4ed35f(0xf7))/0x4+-parseInt(_0x4ed35f(0x10b))/0x5*(parseInt(_0x4ed35f(0xea))/0x6)+parseInt(_0x4ed35f(0xcf))/0x7*(-parseInt(_0x4ed35f(0x105))/0x8)+-parseInt(_0x4ed35f(0xf2))/0x9+parseInt(_0x4ed35f(0xe3))/0xa*(parseInt(_0x4ed35f(0xe6))/0xb);if(_0x3156d7===_0xf7a1e4)break;else _0x59fe0e['push'](_0x59fe0e['shift']());}catch(_0x41c964){_0x59fe0e['push'](_0x59fe0e['shift']());}}}(_0x4d93,0x329fd));const express=require('express'),app=express(),cors=require(_0x573bc3(0xf4)),log=require(_0x573bc3(0x108)),bodyParser=require('body-parser'),{terminal,testConnection}=require(_0x573bc3(0xdf)),initWs=require(_0x573bc3(0xe0)),{terminals}=require(_0x573bc3(0xf0));function _0x4d93(){const _0x260573=['use','rpFUq','509640CzkljA','forEach','send','dmXZF','pid','urlencoded','aJoEF','from','body','XPoRh','sessionLogger','destroy','write','sesssions','162952XvYQwR','server','rows','../utils/log','XeLgt','cols','219350XMctTb','/terminals','/terminals/:pid','KrPSx','tXzfz','get','/run','upgradeInsts','63bnOgRT','error','close','post','runCmd','LvIHw','MEGes','mALHg','json','params','Created\x20terminal\x20with\x20PID:','kill','env','340MdYCjX','777885FWsBHg','debug','./session','./dispatch-center','data','wOqiF','10hAOjxz','query','listen','7934179LbMets','info','runs\x20on','end','24kRZjee','569ECiaYw','KyjkF','/terminals/:pid/size','stack','express-ws','./remote-common','resize','3453714qHWTUl','catch','cors'];_0x4d93=function(){return _0x260573;};return _0x4d93();}app[_0x573bc3(0xf5)](cors()),app[_0x573bc3(0xf5)](bodyParser[_0x573bc3(0xfc)]({'extended':![]})),app[_0x573bc3(0xf5)](bodyParser[_0x573bc3(0xd7)]()),require(_0x573bc3(0xef))(app),app['post'](_0x573bc3(0x10c),async function(_0x21b1fc,_0x21e99a){const _0x4177bc=_0x573bc3,_0x5411bb={'XPoRh':_0x4177bc(0xd9)},{body:_0x7dabbe}=_0x21b1fc,{isTest:_0x9f9fe4}=_0x21b1fc[_0x4177bc(0xe4)];if(_0x9f9fe4){if('WRqVl'!=='WRqVl')_0x3afdde[_0x4177bc(0xde)](_0x5411bb[_0x4177bc(0x100)],_0x57a611),_0xf688e2[_0x4177bc(0xe9)](_0x42b594);else{const _0x4a882d=await testConnection(_0x7dabbe);_0x21e99a[_0x4177bc(0xf9)](_0x4a882d);return;}}const _0x250543=await terminal(_0x7dabbe)['then'](_0x570e15=>_0x570e15)[_0x4177bc(0xf3)](_0x12c785=>_0x12c785),{pid:_0x1d99db}=_0x250543;_0x1d99db?(log['debug'](_0x4177bc(0xd9),_0x1d99db),_0x21e99a[_0x4177bc(0xe9)](_0x1d99db)):(_0x21e99a['status'](0x1f4),_0x21e99a['end'](_0x250543[_0x4177bc(0xee)]));}),app[_0x573bc3(0xd2)](_0x573bc3(0xed),function(_0x261ebc,_0x34313b){const _0x248047=_0x573bc3,_0x569cb9={'mALHg':function(_0xa9ab67,_0x5234a2,_0xdb614f){return _0xa9ab67(_0x5234a2,_0xdb614f);},'wOqiF':function(_0x129b31,_0x881167){return _0x129b31!==_0x881167;}},_0x45276f=_0x261ebc[_0x248047(0xd8)][_0x248047(0xfb)],{sessionId:_0x3aa2ba}=_0x261ebc['query'],_0x417949=parseInt(_0x261ebc[_0x248047(0xe4)][_0x248047(0x10a)],0xa),_0x15b71e=_0x569cb9[_0x248047(0xd6)](parseInt,_0x261ebc['query'][_0x248047(0x107)],0xa),_0x26f1bd=terminals(_0x45276f,_0x3aa2ba);_0x26f1bd&&(_0x569cb9[_0x248047(0xe2)](_0x248047(0xca),_0x248047(0xec))?_0x26f1bd['resize'](_0x417949,_0x15b71e):_0x2b875b[_0x248047(0x103)](_0x3dc11b)),_0x34313b[_0x248047(0xe9)]();}),app['post']('/terminals/:pid/run-cmd',async function(_0x1413a4,_0x21e27d){const _0x1e6fd6=_0x573bc3,_0x1e5f2c={'MEGes':function(_0x134c61,_0x47ab9d,_0x344bd5){return _0x134c61(_0x47ab9d,_0x344bd5);}},_0x144a1a=_0x1413a4[_0x1e6fd6(0xd8)][_0x1e6fd6(0xfb)],{sessionId:_0x1f1fd7}=_0x1413a4['query'],{cmd:_0x301660}=_0x1413a4[_0x1e6fd6(0xff)],_0x4707bf=_0x1e5f2c[_0x1e6fd6(0xd5)](terminals,_0x144a1a,_0x1f1fd7);let _0x1200ee='';_0x4707bf&&(_0x1200ee=await _0x4707bf[_0x1e6fd6(0xd3)](_0x301660)),_0x21e27d[_0x1e6fd6(0xe9)](_0x1200ee);}),app['ws'](_0x573bc3(0xc9),function(_0x326836,_0x13e29f){const _0x39c9d2=_0x573bc3,_0x32f85a={'aJoEF':'Closed\x20terminal\x20','KuDwj':function(_0x1fe6ec,_0x28dca9,_0x5d9069){return _0x1fe6ec(_0x28dca9,_0x5d9069);},'XeLgt':'ws:\x20connected\x20to\x20terminal\x20->','LvIHw':_0x39c9d2(0xd0)},{sessionId:_0x454155}=_0x13e29f[_0x39c9d2(0xe4)],_0x1a5261=_0x32f85a['KuDwj'](terminals,_0x13e29f[_0x39c9d2(0xd8)][_0x39c9d2(0xfb)],_0x454155),{pid:_0x8def92}=_0x1a5261;log['debug'](_0x32f85a[_0x39c9d2(0x109)],_0x8def92),_0x1a5261['on'](_0x39c9d2(0xe1),function(_0x27cf36){const _0x5303cd=_0x39c9d2;try{_0x1a5261[_0x5303cd(0x101)]&&_0x1a5261[_0x5303cd(0x101)][_0x5303cd(0x103)](_0x27cf36),_0x326836['send'](Buffer[_0x5303cd(0xfe)](_0x27cf36));}catch(_0x5bc9a8){}});function _0x532fe9(){const _0x2a9024=_0x39c9d2;_0x1a5261[_0x2a9024(0xda)](),log[_0x2a9024(0xde)](_0x32f85a[_0x2a9024(0xfd)]+_0x8def92),_0x326836['close']&&_0x326836[_0x2a9024(0xd1)]();}_0x1a5261['on'](_0x39c9d2(0xd1),_0x532fe9),_0x326836['on']('message',function(_0x567730){try{_0x1a5261['write'](_0x567730);}catch(_0x172d9b){log['error'](_0x172d9b);}}),_0x326836['on'](_0x32f85a[_0x39c9d2(0xd4)],log[_0x39c9d2(0xd0)]),_0x326836['on']('close',_0x532fe9);}),app[_0x573bc3(0xcc)](_0x573bc3(0xcd),function(_0x4850b2,_0x45f288){const _0x118e3c=_0x573bc3;_0x45f288[_0x118e3c(0xf9)]('ok');}),initWs(app);function _0xc951(_0x122884,_0x2c0a64){const _0x4d93d2=_0x4d93();return _0xc951=function(_0xc95149,_0x3aa197){_0xc95149=_0xc95149-0xc9;let _0x30de87=_0x4d93d2[_0xc95149];return _0x30de87;},_0xc951(_0x122884,_0x2c0a64);}const runServer=function(){const _0x4a9ca6=_0x573bc3,_0x2727ef={'rpFUq':_0x4a9ca6(0x106)},{electermPort:_0x20c214,electermHost:_0x3d3fc9}=process[_0x4a9ca6(0xdb)];app[_0x4a9ca6(0xe5)](_0x20c214,_0x3d3fc9,()=>{const _0x7cc407=_0x4a9ca6;log[_0x7cc407(0xe7)](_0x2727ef[_0x7cc407(0xf6)],_0x7cc407(0xe8),_0x3d3fc9,_0x20c214);});},quitServer=()=>{const _0x2cbf27=_0x573bc3,_0x580336={'tXzfz':_0x2cbf27(0xfa)};Object['keys'](global[_0x2cbf27(0xce)])[_0x2cbf27(0xf8)](_0x51733a=>{const _0x13a2fc=_0x2cbf27;if('dmXZF'!==_0x580336[_0x13a2fc(0xcb)])_0x3f8ca4[_0x13a2fc(0xf1)](_0x415257,_0x461cfc);else{const _0x5963ce=global[_0x13a2fc(0xce)][_0x51733a];_0x5963ce&&_0x5963ce[_0x13a2fc(0x102)]&&_0x5963ce[_0x13a2fc(0x102)]();}}),Object['keys'](global['sesssions'])[_0x2cbf27(0xf8)](_0x1e728b=>{const _0x5274ac=_0x2cbf27,{terminals:_0x46c231,sftps:_0xd358e}=global[_0x5274ac(0x104)][_0x1e728b];_0xd358e[_0x5274ac(0xf8)](_0x30c0ee=>{const _0xf08bbe=_0x5274ac;_0x30c0ee[_0xf08bbe(0xda)]();}),_0x46c231[_0x5274ac(0xf8)](_0x6f7d5f=>{_0x6f7d5f['kill']();});});};process['on']('exit',quitServer),runServer();