const _0x36ba43=_0x2c51;(function(_0x42495e,_0x122b72){const _0x309b8e=_0x2c51,_0x2ca6b2=_0x42495e();while(!![]){try{const _0x203cb7=-parseInt(_0x309b8e(0xb6))/0x1*(-parseInt(_0x309b8e(0xaf))/0x2)+parseInt(_0x309b8e(0xc9))/0x3*(-parseInt(_0x309b8e(0xbc))/0x4)+parseInt(_0x309b8e(0xb2))/0x5*(parseInt(_0x309b8e(0xa6))/0x6)+-parseInt(_0x309b8e(0xa9))/0x7+-parseInt(_0x309b8e(0xab))/0x8+-parseInt(_0x309b8e(0xb3))/0x9+parseInt(_0x309b8e(0xc1))/0xa;if(_0x203cb7===_0x122b72)break;else _0x2ca6b2['push'](_0x2ca6b2['shift']());}catch(_0x615fcd){_0x2ca6b2['push'](_0x2ca6b2['shift']());}}}(_0x3e34,0xd4e83));const crypto=require(_0x36ba43(0xcd)),xpath=require(_0x36ba43(0xb4)),xmldom=require(_0x36ba43(0xac)),fs=require('fs'),expect=require(_0x36ba43(0xcc))['expect'];function _0x2c51(_0xfff6a4,_0x14c8ca){const _0x3e346b=_0x3e34();return _0x2c51=function(_0x2c518f,_0x9ee9ee){_0x2c518f=_0x2c518f-0xa4;let _0x333bac=_0x3e346b[_0x2c518f];return _0x333bac;},_0x2c51(_0xfff6a4,_0x14c8ca);}let sigAlgs;function _0x3e34(){const _0x33347f=['addReference','test\x20create\x20and\x20validate\x20HMAC\x20signature','gZBvq','false','epRQS','2364mJQDcI','bHOXr','HMAC\x20tests','6937546GxkBYl','AMtZu','8089304DAJkvA','@xmldom/xmldom','./test/static/hmac.key','readFileSync','4DgdAwA','loadSignature','FileKeyInfo','15530qOkUNJ','302895pTEgLT','xpath','checkSignature','322189HdHmuD','DOMParser','utf-8','PFcSq','select','<library>','24fepLQQ','SignatureAlgorithms','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','./test/static/hmac_signature.xml','qGuKv','14382270prwSFa','enableHMAC','keyInfoProvider','SignedXml','signingKey','<book>','computeSignature','true','199203zRVULZ','./test/static/hmac-foobar.key','signatureAlgorithm','chai','../index','</library>','getSignedXml','IRLXC','aiXcq'];_0x3e34=function(){return _0x33347f;};return _0x3e34();}describe(_0x36ba43(0xa8),function(){const _0x3ae765=_0x36ba43,_0x538687={'bHOXr':_0x3ae765(0xbf),'IRLXC':function(_0x39cb64,_0x487c29){return _0x39cb64(_0x487c29);},'gZBvq':_0x3ae765(0xb8),'iQunn':_0x3ae765(0xca),'aiXcq':function(_0x36a019,_0xc8c535){return _0x36a019+_0xc8c535;},'ovAIq':_0x3ae765(0xbb),'PFcSq':'</book>','qGuKv':_0x3ae765(0xce),'AMtZu':_0x3ae765(0xbe),'epRQS':function(_0x243089,_0x5deb81,_0x366fda){return _0x243089(_0x5deb81,_0x366fda);},'hyBAh':'test\x20validating\x20HMAC\x20signature','uMEHF':'test\x20HMAC\x20signature\x20with\x20incorrect\x20key','YYkWS':function(_0x40dd96,_0x34e1a2,_0x44500b){return _0x40dd96(_0x34e1a2,_0x44500b);}};beforeEach(function(){const _0xf90b0c=_0x3ae765;sigAlgs=crypto[_0xf90b0c(0xc4)][_0xf90b0c(0xbd)],crypto[_0xf90b0c(0xc4)][_0xf90b0c(0xc2)]();}),afterEach(function(){const _0x5326cc=_0x3ae765;crypto[_0x5326cc(0xc4)]['SignatureAlgorithms']=sigAlgs;}),_0x538687[_0x3ae765(0xa5)](it,_0x538687['hyBAh'],function(){const _0x483c81=_0x3ae765,_0x52b129=fs[_0x483c81(0xae)](_0x538687[_0x483c81(0xa7)],_0x483c81(0xb8)),_0x2d2532=new xmldom[(_0x483c81(0xb7))]()['parseFromString'](_0x52b129),_0x4eeb4a=xpath[_0x483c81(0xba)](_0x483c81(0xbe),_0x2d2532)[0x0],_0x574e79=new crypto['SignedXml']();_0x574e79['keyInfoProvider']=new crypto[(_0x483c81(0xb1))](_0x483c81(0xad)),_0x574e79[_0x483c81(0xb0)](_0x4eeb4a);const _0x1abd52=_0x574e79[_0x483c81(0xb5)](_0x52b129);_0x538687[_0x483c81(0xd0)](expect,_0x1abd52)['to']['be']['true'];}),it(_0x538687['uMEHF'],function(){const _0x2e57cd=_0x3ae765,_0x2a7d3a=fs['readFileSync'](_0x538687[_0x2e57cd(0xa7)],_0x538687[_0x2e57cd(0xd4)]),_0x16a2f4=new xmldom[(_0x2e57cd(0xb7))]()['parseFromString'](_0x2a7d3a),_0x123297=xpath[_0x2e57cd(0xba)](_0x2e57cd(0xbe),_0x16a2f4)[0x0],_0x921583=new crypto[(_0x2e57cd(0xc4))]();_0x921583['keyInfoProvider']=new crypto[(_0x2e57cd(0xb1))](_0x538687['iQunn']),_0x921583['loadSignature'](_0x123297);const _0x5808b2=_0x921583[_0x2e57cd(0xb5)](_0x2a7d3a);_0x538687[_0x2e57cd(0xd0)](expect,_0x5808b2)['to']['be'][_0x2e57cd(0xa4)];}),_0x538687['YYkWS'](it,_0x3ae765(0xd3),function(){const _0x5ae39f=_0x3ae765,_0x696439=_0x538687[_0x5ae39f(0xd1)](_0x538687['ovAIq']+_0x5ae39f(0xc6),'<name>Harry\x20Potter</name>')+_0x538687[_0x5ae39f(0xb9)]+_0x538687[_0x5ae39f(0xc0)],_0x53ee22=new crypto[(_0x5ae39f(0xc4))]();_0x53ee22[_0x5ae39f(0xc5)]=fs['readFileSync']('./test/static/hmac.key'),_0x53ee22[_0x5ae39f(0xcb)]='http://www.w3.org/2000/09/xmldsig#hmac-sha1',_0x53ee22[_0x5ae39f(0xd2)]('//*[local-name(.)=\x27book\x27]'),_0x53ee22[_0x5ae39f(0xc7)](_0x696439);const _0x4b1638=new xmldom[(_0x5ae39f(0xb7))]()['parseFromString'](_0x53ee22[_0x5ae39f(0xcf)]()),_0x453727=xpath[_0x5ae39f(0xba)](_0x538687[_0x5ae39f(0xaa)],_0x4b1638)[0x0],_0x4daa45=new crypto['SignedXml']();_0x4daa45[_0x5ae39f(0xc3)]=new crypto[(_0x5ae39f(0xb1))]('./test/static/hmac.key'),_0x4daa45[_0x5ae39f(0xb0)](_0x453727);const _0x1cb791=_0x4daa45[_0x5ae39f(0xb5)](_0x53ee22[_0x5ae39f(0xcf)]());expect(_0x1cb791)['to']['be'][_0x5ae39f(0xc8)];});});