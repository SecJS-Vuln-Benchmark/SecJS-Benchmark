'use strict';const _0x1aedfa=_0x188a;(function(_0x878cb4,_0x5f4a13){const _0x2ec49a=_0x188a,_0x57c654=_0x878cb4();while(!![]){try{const _0x5798c7=parseInt(_0x2ec49a(0x1eb))/0x1+parseInt(_0x2ec49a(0x18f))/0x2*(parseInt(_0x2ec49a(0x1be))/0x3)+parseInt(_0x2ec49a(0x1f0))/0x4+-parseInt(_0x2ec49a(0x174))/0x5*(parseInt(_0x2ec49a(0x1e9))/0x6)+parseInt(_0x2ec49a(0x20b))/0x7*(-parseInt(_0x2ec49a(0x1d8))/0x8)+parseInt(_0x2ec49a(0x172))/0x9*(parseInt(_0x2ec49a(0x15c))/0xa)+parseInt(_0x2ec49a(0x194))/0xb*(-parseInt(_0x2ec49a(0x1e1))/0xc);if(_0x5798c7===_0x5f4a13)break;else _0x57c654['push'](_0x57c654['shift']());}catch(_0x17d609){_0x57c654['push'](_0x57c654['shift']());}}}(_0x2f7c,0x1a1f6));function _0x188a(_0x5884f2,_0x417da2){const _0x2f7cc9=_0x2f7c();return _0x188a=function(_0x188a7c,_0x2d4218){_0x188a7c=_0x188a7c-0x157;let _0x3cd305=_0x2f7cc9[_0x188a7c];return _0x3cd305;},_0x188a(_0x5884f2,_0x417da2);}const should=require('should'),chalk=require(_0x1aedfa(0x178)),sinon=require(_0x1aedfa(0x162)),{assert}=require(_0x1aedfa(0x1ce)),{hexDump}=require(_0x1aedfa(0x1e8)),{make_debugLog,make_errorLog}=require(_0x1aedfa(0x1e8)),{StatusCodes,StatusCode}=require(_0x1aedfa(0x206)),{compare_buffers}=require('node-opcua-utils'),debugLog=make_debugLog(_0x1aedfa(0x1dc)),errorLog=make_errorLog(_0x1aedfa(0x1dc)),{FakeServer}=require(_0x1aedfa(0x1a0)),port=0x162e,{AcknowledgeMessage,TCPErrorMessage,ClientTCP_transport,packTcpMessage}=require('..'),{MessageBuilderBase,writeTCPMessageHeader}=require('..');function _0x2f7c(){const _0x3da2e6=['bold','dHqiu','unexpected\x20data\x20received','ULvMp','yepOZ','dkpAe','rmurU','cptSS','shutdown','rvMOt','\x20err\x20=\x20','GEQbJ','callCount','mFoeT','close\x20event\x20shall\x20only\x20be\x20received\x20once','15650GSmRrG','url','\x20UNWANTED\x20PACKET','should\x20dispose\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20socket\x20is\x20closed\x20by\x20the\x20other\x20end','should\x20report\x20an\x20error\x20if\x20the\x20server\x20close\x20the\x20socket\x20unexpectedly','2103805UgyYPx','TVdJU','tNQZH','zXirJ','YNRhk','GQjzV','FRotJ','ZNmnf','VdFTy','TXagf','XskHX','mBFlW','../dist/test_helpers','eql','usYex','should','expecting\x20one\x20of\x20those\x20error\x20message.\x20got:\x20','4|3|1|0|5|2','QTOfp','VosuL','mOtnJ','bNBBM','HsmEa','kZQqc','hgxQu','yellow','wCdYy','tYrzA','JWvPa','4|1|3|5|0|2|6','2|4|0|1|3','close','mkSFE','LSupn','cMSnL','qFpkk','zaEgM','LgXhl','close\x20event\x20shall\x20have\x20err===null,\x20when\x20disconnection\x20is\x20initiated\x20by\x20the\x20client\x20itself','LRAkd','SxMrv','tPECt','75gfikQe','OJwEl','hRZLz','\x20Aborting\x20server\x20','dFwhB','slice','zRdZW','copy','end','TicnL','PdRFx','Timeout','oGcvm','DtnAe','keBpS','alloc','node-opcua-assert','xwYlm','match','\x0acounter\x20=\x20','spy','ZbDRT','should\x20close\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20disconnect()\x20is\x20called','XlzIL','jMuqx','should\x20returns\x20an\x20error\x20if\x20url\x20has\x20invalid\x20port','56ltdRcp','red','jbBvj','containEql','TEST','lmyvm','JIDZS','ayeyY','TTcoP','12qXsvUg','cnDHu','should\x20report\x20an\x20error\x20if\x20the\x20server\x20reports\x20a\x20protocol\x20version\x20mismatch','NwCVz','xzugG','SCIBb','Zkbvs','node-opcua-debug','1500puHbhJ','PJIhi','152321AXsyct','nXvEr','exist','ElclS','IqWbs','423124amjLQh','MSG','BadProtocolVersionUnsupported','ChGYL','qkoLN','BcKRu','ERR','disconnect','ZgTMx','ACK','timeout','jaujE','qHfvE','xESEh','pOpjF','the\x20close\x20event\x20should\x20pass\x20a\x20valid\x20Error\x20object\x20because\x20disconnection\x20is\x20caused\x20by\x20external\x20event','yHuld','XQaWc','OgVVT','removeAllListeners','pushResponse','WeXVm','node-opcua-status-code','headerSize','lGPSi','writeUInt16BE','FXIfm','194957jBdjFh','write','writeUInt32BE','connect','cPjVh','MrXpw','IFGRh','bgWhite','Should\x20have\x20raised\x20a\x20timeout\x20error','Should\x20have\x20raised\x20a\x20connection\x20error','bHMOC','oCXvl','283190vWbLpj','cEbxw','cfyBc','PQXOZ','eKlcE','zgWfG','sinon','husMf','ZOWTm','description','HmQqF','iiLQd','length','gtwYU','opc.tcp://localhost:XXXXX/SomeAddress','nrCGI','Tbxic','AUrby','lessThan','message','BwTbC','OcLbE','63zhDAvi','equal','3175Asocvn','WmqMI','CRVIJ','kpnMc','chalk','faCEd','xpBVE','jsbZY','split','instanceOf','PPHeh','cyan'];_0x2f7c=function(){return _0x3da2e6;};return _0x2f7c();}describe('testing\x20ClientTCP_transport',function(){const _0x279a38=_0x1aedfa,_0x1e483a={'nhEip':_0x279a38(0x1f6),'xwYlm':function(_0xf1d796,_0x18a6bf){return _0xf1d796(_0x18a6bf);},'hgxQu':function(_0x539f16,_0x2f9d5a){return _0x539f16===_0x2f9d5a;},'GEQbJ':_0x279a38(0x171),'xVZFT':function(_0x477a08,_0x45f971){return _0x477a08===_0x45f971;},'PGBKR':_0x279a38(0x20e),'eAcre':'connection_break','XlzIL':function(_0x18e332,_0x4a259d){return _0x18e332(_0x4a259d);},'dFwhB':function(_0x4d4e2b,_0x18c0b6,_0x56f90a){return _0x4d4e2b(_0x18c0b6,_0x56f90a);},'ZOWTm':'\x0acounter\x20=\x20','dkpAe':_0x279a38(0x182),'hRZLz':_0x279a38(0x17e),'bHMOC':_0x279a38(0x1f9),'QTOfp':_0x279a38(0x1a5),'TXagf':'5|4|0|1|3|2','jaujE':_0x279a38(0x159),'LSupn':function(_0x2a37d8,_0x57d916){return _0x2a37d8!==_0x57d916;},'tYrzA':_0x279a38(0x1d6),'HsmEa':'mdtKK','gtwYU':function(_0x21e626,_0x21f6ca){return _0x21e626(_0x21f6ca);},'bNBBM':function(_0x59fa42,_0x18307e){return _0x59fa42!==_0x18307e;},'cMSnL':_0x279a38(0x17b),'oGcvm':_0x279a38(0x1b2),'lGPSi':function(_0x346bb6){return _0x346bb6();},'tPECt':'transport.connect\x20should\x20have\x20raised\x20a\x20connection\x20error','jbBvj':function(_0x57cd1f,_0x4d98bf,_0x450f04){return _0x57cd1f(_0x4d98bf,_0x450f04);},'GQjzV':function(_0x27b71a,_0x499378){return _0x27b71a===_0x499378;},'TaPjY':_0x279a38(0x20a),'NhtRu':function(_0x10e589,_0x1dedbc){return _0x10e589!==_0x1dedbc;},'HmQqF':_0x279a38(0x1df),'Jxitw':_0x279a38(0x1a2),'mPIwx':_0x279a38(0x163),'cPjVh':_0x279a38(0x191),'qFpkk':function(_0x21b23d,_0x373b8d,_0x541a31){return _0x21b23d(_0x373b8d,_0x541a31);},'MrXpw':_0x279a38(0x1c1),'rmurU':function(_0x1ac7bd,_0x5c19fd){return _0x1ac7bd===_0x5c19fd;},'pOpjF':function(_0x156233,_0x56588f){return _0x156233(_0x56588f);},'zsuyN':_0x279a38(0x196),'NwCVz':_0x279a38(0x18a),'wCdYy':'xFIEK','zgWfG':function(_0x19d28b,_0x53d5dd,_0x31b61a){return _0x19d28b(_0x53d5dd,_0x31b61a);},'LRAkd':'yTFoK','rvMOt':_0x279a38(0x1b3),'kZQqc':_0x279a38(0x18e),'mBFlW':function(_0x1b658d,_0x6a6cf3){return _0x1b658d(_0x6a6cf3);},'faCEd':_0x279a38(0x1ff),'zXirJ':function(_0x3e8bd6){return _0x3e8bd6();},'XQaWc':function(_0x360c8e,_0x1c5646,_0xfefb37){return _0x360c8e(_0x1c5646,_0xfefb37);},'oCXvl':_0x279a38(0x1c6),'kpnMc':_0x279a38(0x1fc),'mkSFE':'yyNty','zRdZW':function(_0x3e2eb1){return _0x3e2eb1();},'IqWbs':function(_0x22ad63,_0x1e84d6){return _0x22ad63(_0x1e84d6);},'OgVVT':_0x279a38(0x16a),'fwquv':function(_0x1cc85e,_0x564f66,_0x27949d){return _0x1cc85e(_0x564f66,_0x27949d);},'TAtGk':function(_0x309f9c,_0x37d708,_0x369f86){return _0x309f9c(_0x37d708,_0x369f86);},'mOtnJ':_0x279a38(0x1e3),'FRotJ':function(_0x44f4c9,_0x1241ce,_0x2e64e6){return _0x44f4c9(_0x1241ce,_0x2e64e6);}};this['timeout'](0x3a98);let _0x572f01,_0x5e504f,_0x56c97f,_0x520441,_0x4252d2,_0x5a84be;beforeEach(function(_0xa226dd){const _0x1f1b78=_0x279a38,_0x32b73c={'Zkbvs':function(_0x395409,_0x516364){const _0x511e4d=_0x188a;return _0x1e483a[_0x511e4d(0x1ac)](_0x395409,_0x516364);},'WmqMI':_0x1e483a[_0x1f1b78(0x18b)]};if(_0x1e483a['xVZFT']('ZWhvS',_0x1f1b78(0x16b))){const _0x410fc9=_0x587e4d(_0x13a9a2[_0x1f1b78(0x1f2)]),_0x27f325=_0x253013(_0x1e483a['nhEip'],_0x410fc9);_0x126963[_0x1f1b78(0x20c)](_0x27f325),_0x1e483a[_0x1f1b78(0x1cf)](_0x4a1cce,function(){const _0xcd90df=_0x1f1b78;_0x579526[_0xcd90df(0x1c6)]();});}else _0x572f01=new ClientTCP_transport(),_0x5e504f=sinon[_0x1f1b78(0x1d2)](),_0x572f01['on']('close',_0x5e504f),_0x56c97f=sinon[_0x1f1b78(0x1d2)](),_0x572f01['on'](_0x1e483a['PGBKR'],_0x56c97f),_0x520441=sinon['spy'](),_0x572f01['on'](_0x1e483a['eAcre'],_0x520441),_0x4252d2=new FakeServer({'port':port}),_0x4252d2['initialize'](_0x4fc297=>{const _0xeccae7=_0x1f1b78;_0x32b73c[_0xeccae7(0x1e7)]('BxFVC',_0x32b73c[_0xeccae7(0x175)])?(_0x330561[_0xeccae7(0x1ed)](_0x34bcc2),_0xb6f052['end']()):(_0x5a84be=_0x4252d2[_0xeccae7(0x190)],_0xa226dd(_0x4fc297));});}),_0x1e483a['pOpjF'](afterEach,function(_0x11e338){const _0x339bd5={'VosuL':function(_0x484504,_0xd5cf0b){const _0x3bfc98=_0x188a;return _0x1e483a[_0x3bfc98(0x1d5)](_0x484504,_0xd5cf0b);}};_0x572f01['disconnect'](function(_0x5e565a){_0x572f01['removeAllListeners'](),_0x572f01=null,_0x4252d2['shutdown'](function(_0x577841){const _0x2111d7=_0x188a;_0x4252d2=null,_0x339bd5[_0x2111d7(0x1a7)](_0x11e338,_0x577841);});});});const _0x5aa9dd=new AcknowledgeMessage({'protocolVersion':0x0,'receiveBufferSize':0x2000,'sendBufferSize':0x2000,'maxMessageSize':0x186a0,'maxChunkCount':0x927c0});it('TCS1\x20should\x20create\x20and\x20connect\x20to\x20a\x20client\x20TCP',function(_0x25dc1e){const _0x3bb568=_0x279a38,_0x406b9f=sinon[_0x3bb568(0x1d2)](function(_0x2b7bb8,_0x474ec3){const _0x3b83c6=_0x3bb568,_0x578f3e={'TTcoP':function(_0x25ac1c,_0x57a138,_0x2d9bb5){const _0x550e76=_0x188a;return _0x1e483a[_0x550e76(0x1c2)](_0x25ac1c,_0x57a138,_0x2d9bb5);},'tpsrp':_0x1e483a['ZOWTm'],'CRVIJ':function(_0x45a14e,_0x15e0da){return _0x45a14e(_0x15e0da);},'TicnL':function(_0x2ad4b6,_0x23af92){return _0x1e483a['xwYlm'](_0x2ad4b6,_0x23af92);},'TVdJU':_0x1e483a[_0x3b83c6(0x185)]};if('zbXOZ'===_0x1e483a[_0x3b83c6(0x1c0)]){_0x578f3e[_0x3b83c6(0x1e0)](_0x1c4896,_0x5df638['cyan'][_0x3b83c6(0x180)](_0x578f3e['tpsrp']),_0x503582),_0x578f3e[_0x3b83c6(0x176)](_0x273a32,_0x111a90[_0x3b83c6(0x1ad)]['bold'](_0x578f3e[_0x3b83c6(0x1c7)](_0x36008a,_0x477f91)));if(_0x1a5524===0x1){const _0x271144=_0x4e0af4(_0x3b83c6(0x1f9),_0x1813c0);_0x32a5c7+=0x1,_0x35aacf[_0x3b83c6(0x20c)](_0x271144);return;}_0x41c46b(![],_0x578f3e[_0x3b83c6(0x195)]);}else{assert(_0x474ec3);const _0x5627d0=packTcpMessage(_0x1e483a[_0x3b83c6(0x15a)],_0x5aa9dd);_0x2b7bb8[_0x3b83c6(0x20c)](_0x5627d0);}});_0x4252d2['pushResponse'](_0x406b9f),_0x572f01['connect'](_0x5a84be,function(_0x1b1444){const _0x267929=_0x3bb568;_0x56c97f['callCount'][_0x267929(0x1a3)][_0x267929(0x1a1)](0x1),_0x5e504f[_0x267929(0x18c)][_0x267929(0x1a3)][_0x267929(0x1a1)](0x0),_0x520441['callCount'][_0x267929(0x1a3)]['eql'](0x0),_0x406b9f[_0x267929(0x18c)][_0x267929(0x1a3)][_0x267929(0x1a1)](0x1),_0x572f01[_0x267929(0x1f7)](function(_0x4969eb){const _0x506ef7=_0x267929;_0x56c97f['callCount'][_0x506ef7(0x1a3)][_0x506ef7(0x1a1)](0x1),_0x5e504f[_0x506ef7(0x18c)][_0x506ef7(0x1a3)]['eql'](0x1),_0x520441['callCount'][_0x506ef7(0x1a3)][_0x506ef7(0x1a1)](0x0),_0x406b9f['callCount'][_0x506ef7(0x1a3)][_0x506ef7(0x1a1)](0x1),_0x25dc1e(_0x4969eb);});});}),_0x1e483a['fwquv'](it,'TCS2\x20should\x20report\x20a\x20time\x20out\x20error\x20if\x20trying\x20to\x20connect\x20to\x20a\x20non\x20responding\x20server',function(_0x51de13){const _0x451b0b=_0x279a38,_0x4f7dac=sinon[_0x451b0b(0x1d2)](function(_0x24d035,_0x253cc2){});_0x4252d2['pushResponse'](_0x4f7dac),_0x572f01[_0x451b0b(0x1fa)]=0x1f4,_0x572f01['connect'](_0x5a84be,function(_0x45a9a3){const _0x4cbb2a=_0x451b0b;if(_0x45a9a3){const _0x539cf4=_0x1e483a[_0x4cbb2a(0x1a6)][_0x4cbb2a(0x17c)]('|');let _0x32495a=0x0;while(!![]){switch(_0x539cf4[_0x32495a++]){case'0':_0x520441[_0x4cbb2a(0x18c)]['should']['eql'](0x0);continue;case'1':_0x5e504f[_0x4cbb2a(0x18c)]['should'][_0x4cbb2a(0x1a1)](0x0);continue;case'2':_0x51de13();continue;case'3':_0x56c97f[_0x4cbb2a(0x18c)][_0x4cbb2a(0x1a3)][_0x4cbb2a(0x1a1)](0x0);continue;case'4':_0x45a9a3['message'][_0x4cbb2a(0x1a3)][_0x4cbb2a(0x1db)](_0x4cbb2a(0x1c9));continue;case'5':_0x4f7dac['callCount'][_0x4cbb2a(0x1a3)]['eql'](0x1);continue;}break;}}else _0x51de13(new Error(_0x4cbb2a(0x158)));});}),_0x1e483a[_0x279a38(0x161)](it,_0x279a38(0x193),function(_0x3d3447){const _0x58ee28=_0x279a38,_0x1efdd9={'PdRFx':_0x1e483a[_0x58ee28(0x19d)],'VdFTy':function(_0x54fd7d,_0x26c4cb){return _0x54fd7d===_0x26c4cb;},'TLaRQ':'4|1|3|2|0','yepOZ':function(_0x1a3680){return _0x1a3680();},'zaEgM':function(_0x183b90,_0x4dfe2d){return _0x183b90(_0x4dfe2d);},'JWvPa':_0x1e483a[_0x58ee28(0x1fb)]};if(_0x1e483a[_0x58ee28(0x1b5)](_0x1e483a[_0x58ee28(0x1af)],_0x1e483a[_0x58ee28(0x1aa)])){const _0x5d356c=sinon['spy'](function(_0x2fd267,_0x912c0d){const _0x43d25e=_0x58ee28,_0x6accc9={'nXvEr':_0x1efdd9[_0x43d25e(0x1c8)],'xpBVE':_0x43d25e(0x158)};if(_0x1efdd9[_0x43d25e(0x19c)](_0x43d25e(0x1bf),_0x43d25e(0x200))){if(_0x5a4af1){const _0x120285=_0x6accc9[_0x43d25e(0x1ec)][_0x43d25e(0x17c)]('|');let _0x569016=0x0;while(!![]){switch(_0x120285[_0x569016++]){case'0':_0x4eeae8[_0x43d25e(0x18c)][_0x43d25e(0x1a3)][_0x43d25e(0x1a1)](0x0);continue;case'1':_0x1d6889[_0x43d25e(0x18c)]['should'][_0x43d25e(0x1a1)](0x0);continue;case'2':_0xf5964e();continue;case'3':_0x7b1a4f['callCount'][_0x43d25e(0x1a3)][_0x43d25e(0x1a1)](0x1);continue;case'4':_0x84a2e4[_0x43d25e(0x18c)]['should'][_0x43d25e(0x1a1)](0x0);continue;case'5':_0x3e0738['message']['should'][_0x43d25e(0x1db)](_0x43d25e(0x1c9));continue;}break;}}else _0x259283(new _0x5e970d(_0x6accc9[_0x43d25e(0x17a)]));}else should[_0x43d25e(0x1ed)](_0x912c0d),_0x2fd267[_0x43d25e(0x1c6)]();});_0x4252d2[_0x58ee28(0x204)](_0x5d356c),_0x572f01[_0x58ee28(0x1fa)]=0x3e8,_0x572f01['connect'](_0x5a84be,function(_0x43b2c4){const _0x1b5d20=_0x58ee28;if(_0x43b2c4){const _0x2f00e9=_0x1efdd9['TLaRQ'][_0x1b5d20(0x17c)]('|');let _0x316c48=0x0;while(!![]){switch(_0x2f00e9[_0x316c48++]){case'0':_0x1efdd9[_0x1b5d20(0x184)](_0x3d3447);continue;case'1':_0x56c97f[_0x1b5d20(0x18c)][_0x1b5d20(0x1a3)][_0x1b5d20(0x1a1)](0x0);continue;case'2':_0x520441['callCount']['should'][_0x1b5d20(0x1a1)](0x0);continue;case'3':_0x5e504f['callCount'][_0x1b5d20(0x1a3)][_0x1b5d20(0x1a1)](0x0);continue;case'4':_0x43b2c4[_0x1b5d20(0x16f)][_0x1b5d20(0x1a3)]['match'](/Connection aborted/);continue;}break;}}else _0x1efdd9[_0x1b5d20(0x1b8)](_0x3d3447,new Error(_0x1efdd9[_0x1b5d20(0x1b0)]));});}else{const _0x16db0d={'xESEh':function(_0x112aea,_0x50da30){const _0x298181=_0x58ee28;return _0x1efdd9[_0x298181(0x1b8)](_0x112aea,_0x50da30);}};_0x23fafb[_0x58ee28(0x203)](),_0x3ec3d8=null,_0x5c87b2[_0x58ee28(0x188)](function(_0x154540){const _0x591012=_0x58ee28;_0x5c433e=null,_0x16db0d[_0x591012(0x1fd)](_0x5df840,_0x154540);});}});function _0x1c5f7e(_0x22212e){const _0x27d8e6=_0x279a38;return _0x1e483a[_0x27d8e6(0x169)](assert,_0x22212e instanceof StatusCode),new TCPErrorMessage({'statusCode':_0x22212e,'reason':_0x22212e[_0x27d8e6(0x165)]});}_0x1e483a['TAtGk'](it,_0x1e483a[_0x279a38(0x1a8)],function(_0x1a0c26){const _0x98c961=_0x279a38,_0x32a644={'dHqiu':function(_0x3c814b,_0xb2b7a6){return _0x3c814b(_0xb2b7a6);},'cEbxw':function(_0x227f21,_0x5a1995,_0x5a42e8){return _0x227f21(_0x5a1995,_0x5a42e8);}},_0x2cb73a=sinon[_0x98c961(0x1d2)](function(_0x27e37d,_0x477597){const _0x7f92b6=_0x98c961,_0x3fe257=_0x32a644[_0x7f92b6(0x181)](_0x1c5f7e,StatusCodes[_0x7f92b6(0x1f2)]),_0x16646d=_0x32a644[_0x7f92b6(0x15d)](packTcpMessage,_0x7f92b6(0x1f6),_0x3fe257);_0x27e37d['write'](_0x16646d),_0x32a644[_0x7f92b6(0x181)](setImmediate,function(){const _0xa4fe09=_0x7f92b6;_0x27e37d[_0xa4fe09(0x1c6)]();});});_0x4252d2[_0x98c961(0x204)](_0x2cb73a),_0x572f01[_0x98c961(0x1fa)]=0x3e8,_0x572f01[_0x98c961(0x20e)](_0x5a84be,function(_0x4e41c4){const _0x429cf9=_0x98c961,_0x2e42ad={'kheMW':function(_0x2c9bb2,_0x1aa827,_0x4e4449){const _0x509677=_0x188a;return _0x1e483a[_0x509677(0x1c2)](_0x2c9bb2,_0x1aa827,_0x4e4449);},'aGlMn':_0x429cf9(0x18a),'SCIBb':function(_0x1591fb,_0x512caa){return _0x1591fb(_0x512caa);}};if(_0x1e483a[_0x429cf9(0x1a9)](_0x429cf9(0x17b),_0x1e483a[_0x429cf9(0x1b6)])){_0x4b2264&&_0x2e42ad['kheMW'](_0x5d178d,_0x3442d0[_0x429cf9(0x157)][_0x429cf9(0x1d9)](_0x2e42ad['aGlMn']),_0x115b2f[_0x429cf9(0x16f)]);_0x2e42ad[_0x429cf9(0x1e6)](_0x4f7754,!_0x33c68f);const _0x1f7288=_0x5db8a8(_0x429cf9(0x1f1),'F',_0x33e096['headerSize'],_0x3b7996['length']);_0x5863ac[_0x429cf9(0x1c5)](_0x1f7288,_0x4dabe0[_0x429cf9(0x207)],0x0,_0x459f3f[_0x429cf9(0x168)]),_0x6000c6[_0x429cf9(0x20c)](_0x1f7288);}else{if(_0x4e41c4){const _0x554472=_0x1e483a[_0x429cf9(0x1ca)][_0x429cf9(0x17c)]('|');let _0x259889=0x0;while(!![]){switch(_0x554472[_0x259889++]){case'0':_0x5e504f[_0x429cf9(0x18c)]['should'][_0x429cf9(0x1a1)](0x0);continue;case'1':_0x520441[_0x429cf9(0x18c)][_0x429cf9(0x1a3)]['eql'](0x0);continue;case'2':_0x4e41c4[_0x429cf9(0x16f)][_0x429cf9(0x1a3)][_0x429cf9(0x1d0)](/The applications do not have compatible protocol versions/);continue;case'3':_0x1e483a[_0x429cf9(0x208)](_0x1a0c26);continue;case'4':_0x56c97f[_0x429cf9(0x18c)][_0x429cf9(0x1a3)][_0x429cf9(0x1a1)](0x0);continue;}break;}}else _0x1e483a[_0x429cf9(0x169)](_0x1a0c26,new Error(_0x1e483a[_0x429cf9(0x1bd)]));}});}),it('should\x20connect\x20and\x20forward\x20subsequent\x20message\x20chunks\x20after\x20a\x20valid\x20HEL/ACK\x20transaction',function(_0x3040d5){const _0x41d1fb=_0x279a38,_0x20b55f={'eKlcE':function(_0x1590b8,_0x2af000,_0x49f3c3){const _0x1b04f5=_0x188a;return _0x1e483a[_0x1b04f5(0x1b7)](_0x1590b8,_0x2af000,_0x49f3c3);},'gzOQR':_0x1e483a[_0x41d1fb(0x210)],'SZgGx':function(_0x38faab,_0x43cd17){const _0x14dea1=_0x41d1fb;return _0x1e483a[_0x14dea1(0x186)](_0x38faab,_0x43cd17);},'XskHX':function(_0x2f2390,_0xfe0f77){return _0x2f2390(_0xfe0f77);},'jwyUI':function(_0x317f53){return _0x317f53();},'PQXOZ':function(_0x2ef334,_0x167abe){const _0x1936b1=_0x41d1fb;return _0x1e483a[_0x1936b1(0x1fe)](_0x2ef334,_0x167abe);},'BcKRu':function(_0x413d6d,_0x442d2d){const _0x58ce51=_0x41d1fb;return _0x1e483a[_0x58ce51(0x186)](_0x413d6d,_0x442d2d);},'Tbxic':_0x41d1fb(0x1f1),'AUrby':function(_0x501e70,_0x997cad,_0x4c1229,_0x589955,_0x4f3724){return _0x501e70(_0x997cad,_0x4c1229,_0x589955,_0x4f3724);},'cnDHu':function(_0x41b82e,_0xf9e1d3){return _0x41b82e!==_0xf9e1d3;},'yPPnf':_0x1e483a['zsuyN'],'AWemi':'GCrhf','CVOBg':_0x1e483a[_0x41d1fb(0x1e4)]},_0x3283de=Buffer[_0x41d1fb(0x1cd)](0xa);_0x3283de['writeUInt32BE'](0xdeadbeef,0x0),_0x3283de[_0x41d1fb(0x20d)](0xfefefefe,0x4),_0x3283de[_0x41d1fb(0x209)](0xffff,0x8);let _0x4de957=0x1;const _0x503f46=sinon[_0x41d1fb(0x1d2)](function(_0x3f7803,_0x284290){const _0x58aa09=_0x41d1fb,_0x4086ad={'GeUtT':function(_0x1fccf0,_0x1b203c,_0xf1acfd){const _0x4edfd5=_0x188a;return _0x1e483a[_0x4edfd5(0x1da)](_0x1fccf0,_0x1b203c,_0xf1acfd);},'wyfyV':_0x58aa09(0x18a),'qkoLN':function(_0x52642c,_0x8a8d9a){return _0x52642c(_0x8a8d9a);}};debugLog(chalk['cyan']['bold'](_0x1e483a[_0x58aa09(0x164)]),_0x4de957),_0x1e483a[_0x58aa09(0x169)](debugLog,chalk['yellow'][_0x58aa09(0x180)](hexDump(_0x284290)));if(_0x1e483a[_0x58aa09(0x199)](_0x4de957,0x1)){if(_0x58aa09(0x20a)===_0x1e483a['TaPjY']){const _0x49b403=_0x1e483a[_0x58aa09(0x1da)](packTcpMessage,_0x1e483a[_0x58aa09(0x15a)],_0x5aa9dd);_0x4de957+=0x1,_0x3f7803[_0x58aa09(0x20c)](_0x49b403);}else _0x4086ad['GeUtT'](_0x52f2c7,_0x514346[_0x58aa09(0x157)][_0x58aa09(0x1d9)](_0x4086ad['wyfyV']),_0xba0c05['message']);}else{if(_0x4de957===0x2)_0x1e483a['NhtRu'](_0x1e483a[_0x58aa09(0x166)],_0x1e483a['Jxitw'])?(_0x4de957+=0x1,_0x284290[_0x58aa09(0x168)][_0x58aa09(0x1a3)][_0x58aa09(0x173)](0x12),_0x1e483a['dFwhB'](compare_buffers,_0x284290[_0x58aa09(0x1c3)](0x8),_0x3283de),_0x3f7803[_0x58aa09(0x20c)](_0x284290)):_0x448ecc(_0x9ea035[_0x58aa09(0x157)]['red'](_0x58aa09(0x18a)),_0x26ad61['message']);else{if(_0x1e483a['mPIwx']===_0x58aa09(0x205)){const _0x50d06d={'qebtv':function(_0x334ec7,_0x3e6135){const _0x3c3aa1=_0x58aa09;return _0x4086ad[_0x3c3aa1(0x1f4)](_0x334ec7,_0x3e6135);}};_0x4d0e22[_0x58aa09(0x1f7)](function(_0x499cf1){const _0x5abeae=_0x58aa09;_0x5c0f70[_0x5abeae(0x203)](),_0x4abd7d=null,_0x4c752a['shutdown'](function(_0xc15b13){_0x39599a=null,_0x50d06d['qebtv'](_0x35f1ed,_0xc15b13);});});}else _0x1e483a[_0x58aa09(0x169)](errorLog,_0x1e483a[_0x58aa09(0x20f)]);}}_0x4de957[_0x58aa09(0x1a3)]['be'][_0x58aa09(0x16e)](0x4);});_0x4252d2['pushResponse'](_0x503f46),_0x4252d2['pushResponse'](_0x503f46),_0x4252d2['pushResponse'](_0x503f46),_0x572f01[_0x41d1fb(0x1fa)]=0x3e8,_0x572f01['on']('chunk',function(_0x38a87f){const _0x90b623=_0x41d1fb,_0x6b6460={'ChGYL':function(_0x1078a9,_0x26a31a){return _0x1078a9(_0x26a31a);},'ZNmnf':_0x20b55f['gzOQR']};if(_0x20b55f['SZgGx'](_0x90b623(0x1ea),_0x90b623(0x1ea))){const _0x1abe51=_0x90b623(0x1b1)[_0x90b623(0x17c)]('|');let _0x92e9d0=0x0;while(!![]){switch(_0x1abe51[_0x92e9d0++]){case'0':_0x520441[_0x90b623(0x18c)][_0x90b623(0x1a3)][_0x90b623(0x1a1)](0x0);continue;case'1':compare_buffers(_0x38a87f[_0x90b623(0x1c3)](0x8),_0x3283de);continue;case'2':_0x503f46['callCount'][_0x90b623(0x1a3)][_0x90b623(0x1a1)](0x2);continue;case'3':_0x56c97f['callCount']['should'][_0x90b623(0x1a1)](0x1);continue;case'4':debugLog(chalk['cyan'][_0x90b623(0x180)](_0x20b55f[_0x90b623(0x19e)](hexDump,_0x38a87f)));continue;case'5':_0x5e504f['callCount'][_0x90b623(0x1a3)][_0x90b623(0x1a1)](0x0);continue;case'6':_0x20b55f['jwyUI'](_0x3040d5);continue;}break;}}else{const _0xd93af2=_0x20b55f[_0x90b623(0x160)](_0x15f6ab,_0x90b623(0x1f9),_0x1b1e3f);_0x5e863c+=0x1,_0xd46af[_0x90b623(0x20c)](_0xd93af2),_0x20b55f[_0x90b623(0x160)](_0x6b59e3,function(){const _0x3fe34e=_0x90b623;_0x6b6460[_0x3fe34e(0x1f3)](_0x4de3da,_0x6b6460[_0x3fe34e(0x19b)]),_0x4dcd67['end']();},0xa);}});function _0x3f774b(_0x59389d,_0x438dad,_0x5803ed,_0x45e304){const _0x6543e7=_0x41d1fb;_0x20b55f[_0x6543e7(0x15f)](assert,_0x20b55f[_0x6543e7(0x1f5)](_0x59389d,_0x20b55f['Tbxic']));const _0x2b4d87=_0x45e304+_0x5803ed,_0x2fc523=Buffer['alloc'](_0x2b4d87);return _0x20b55f[_0x6543e7(0x16d)](writeTCPMessageHeader,_0x20b55f[_0x6543e7(0x16c)],_0x438dad,_0x2b4d87,_0x2fc523),_0x2fc523;}_0x572f01[_0x41d1fb(0x20e)](_0x5a84be,_0x56a3e2=>{const _0x2e49fc=_0x41d1fb,_0x5cd41c={'zNoPp':function(_0x4b8c3f,_0xefba5e){const _0xd220af=_0x188a;return _0x20b55f[_0xd220af(0x15f)](_0x4b8c3f,_0xefba5e);},'xzugG':function(_0x567114,_0x278117){return _0x567114===_0x278117;}};if(_0x20b55f[_0x2e49fc(0x1e2)](_0x20b55f['yPPnf'],_0x20b55f['AWemi'])){_0x56a3e2&&_0x20b55f[_0x2e49fc(0x160)](errorLog,chalk[_0x2e49fc(0x157)][_0x2e49fc(0x1d9)](_0x20b55f['CVOBg']),_0x56a3e2[_0x2e49fc(0x16f)]);_0x20b55f['XskHX'](assert,!_0x56a3e2);const _0x2cb396=_0x20b55f[_0x2e49fc(0x16d)](_0x3f774b,_0x2e49fc(0x1f1),'F',_0x572f01['headerSize'],_0x3283de[_0x2e49fc(0x168)]);_0x3283de[_0x2e49fc(0x1c5)](_0x2cb396,_0x572f01['headerSize'],0x0,_0x3283de[_0x2e49fc(0x168)]),_0x572f01[_0x2e49fc(0x20c)](_0x2cb396);}else{_0x5cd41c['zNoPp'](_0x1a9319,_0x5cd41c[_0x2e49fc(0x1e5)](_0x4f13e4,'MSG'));const _0x1dca5e=_0x3e6ff7+_0x1b7f61,_0x1ee05f=_0x5ac09a[_0x2e49fc(0x1cd)](_0x1dca5e);return _0x410d53('MSG',_0x5d416f,_0x1dca5e,_0x1ee05f),_0x1ee05f;}});}),it(_0x279a38(0x1d4),function(_0x1bd151){const _0x34d0b4=_0x279a38,_0x1ff68c={'BwTbC':_0x1e483a[_0x34d0b4(0x210)],'mFoeT':'\x20err\x20=\x20','ZbDRT':function(_0x377e64,_0x53c2b7){return _0x377e64(_0x53c2b7);},'ZgTMx':function(_0x3ad726,_0xe608c2,_0x4a72b0){return _0x3ad726(_0xe608c2,_0x4a72b0);}};let _0x246cd4=0x1,_0x2f829c=![],_0x3fbf80=![];const _0x2a1f6b=sinon[_0x34d0b4(0x1d2)](function(_0x2ef6b2,_0x828e79){const _0x48a44d=_0x34d0b4;if(_0x1e483a[_0x48a44d(0x1ae)]==='iujRI')_0xb85be5(_0x1ff68c[_0x48a44d(0x170)]),_0x556e8c[_0x48a44d(0x1c6)]();else{debugLog(chalk[_0x48a44d(0x17f)][_0x48a44d(0x180)](_0x48a44d(0x1d1)),_0x246cd4),debugLog(chalk['yellow'][_0x48a44d(0x180)](_0x1e483a['gtwYU'](hexDump,_0x828e79)));if(_0x1e483a[_0x48a44d(0x199)](_0x246cd4,0x1)){const _0x2a95c7=packTcpMessage(_0x48a44d(0x1f9),_0x5aa9dd);_0x246cd4+=0x1,_0x2ef6b2[_0x48a44d(0x20c)](_0x2a95c7);return;}_0x1e483a[_0x48a44d(0x161)](assert,![],_0x1e483a['dkpAe']);}});_0x4252d2[_0x34d0b4(0x204)](_0x2a1f6b),_0x4252d2[_0x34d0b4(0x204)](_0x2a1f6b),_0x4252d2['on'](_0x34d0b4(0x1c6),function(){_0x2f829c=!![];}),_0x572f01[_0x34d0b4(0x1fa)]=0x3e8,_0x572f01['on'](_0x1e483a[_0x34d0b4(0x189)],function(_0x496100){const _0x1a2052=_0x34d0b4;_0x3fbf80[_0x1a2052(0x1a3)][_0x1a2052(0x1a1)](![],_0x1a2052(0x18e)),_0x3fbf80=!![],should(_0x496100)['be'][_0x1a2052(0x1a1)](null,_0x1a2052(0x1ba));}),_0x572f01['connect'](_0x5a84be,function(_0x2ae343){const _0x315f86=_0x34d0b4;_0x315f86(0x15e)!==_0x1e483a[_0x315f86(0x1bb)]?(_0x2ae343&&errorLog(chalk[_0x315f86(0x157)]['red'](_0x315f86(0x18a)),_0x2ae343[_0x315f86(0x16f)]),assert(!_0x2ae343),_0x2f829c[_0x315f86(0x1a3)][_0x315f86(0x173)](![]),_0x3fbf80[_0x315f86(0x1a3)]['equal'](![]),_0x572f01[_0x315f86(0x1f7)](function(_0x225c38){const _0x25a54a=_0x315f86,_0x203ec9={'SxMrv':_0x25a54a(0x167)};_0x225c38&&errorLog(chalk[_0x25a54a(0x157)][_0x25a54a(0x1d9)](_0x1ff68c[_0x25a54a(0x18d)]),_0x225c38[_0x25a54a(0x16f)]),_0x1ff68c[_0x25a54a(0x1d3)](assert,!_0x225c38),setImmediate(function(){const _0x2b3a11=_0x25a54a;_0x203ec9[_0x2b3a11(0x1bc)]!==_0x203ec9[_0x2b3a11(0x1bc)]?_0x370c0d[_0x2b3a11(0x1c6)]():(_0x2f829c['should']['equal'](!![]),_0x3fbf80['should'][_0x2b3a11(0x173)](!![]),_0x1bd151(_0x225c38));});})):(_0x5207f3+=0x1,_0x1fb613[_0x315f86(0x168)]['should']['equal'](0x12),_0x1ff68c[_0x315f86(0x1f8)](_0x29d28f,_0x19fc98[_0x315f86(0x1c3)](0x8),_0x4f32cb),_0x268fb3[_0x315f86(0x20c)](_0x544c44));});}),_0x1e483a[_0x279a38(0x19a)](it,_0x279a38(0x192),function(_0x3b2ad5){const _0x2e1e7a=_0x279a38,_0x130ae5={'HEVqV':'\x20Aborting\x20server\x20','keBpS':_0x2e1e7a(0x1d1),'DtnAe':function(_0x10a776,_0x29e2c7){return _0x10a776===_0x29e2c7;},'cptSS':function(_0x736aac,_0x15da97,_0x5eae47){const _0x18ad94=_0x2e1e7a;return _0x1e483a[_0x18ad94(0x201)](_0x736aac,_0x15da97,_0x5eae47);},'ElclS':function(_0x2c49a4,_0x848103,_0x5c6e14){const _0x18f34=_0x2e1e7a;return _0x1e483a[_0x18f34(0x161)](_0x2c49a4,_0x848103,_0x5c6e14);},'Kqsih':_0x2e1e7a(0x183)};let _0x20df3d=0x1,_0x2fda06=![],_0x29df08=![];const _0x5b7aaf=sinon['spy'](function(_0x177837,_0x105781){const _0x992da4=_0x2e1e7a,_0x381ef9={'YNRhk':function(_0x551811,_0x4a4e5f,_0x375f3f){return _0x551811(_0x4a4e5f,_0x375f3f);}};debugLog(chalk[_0x992da4(0x17f)][_0x992da4(0x180)](_0x130ae5[_0x992da4(0x1cc)]),_0x20df3d),debugLog(chalk[_0x992da4(0x1ad)][_0x992da4(0x180)](hexDump(_0x105781)));if(_0x130ae5[_0x992da4(0x1cb)](_0x20df3d,0x1)){const _0xadf8d4=_0x130ae5[_0x992da4(0x187)](packTcpMessage,_0x992da4(0x1f9),_0x5aa9dd);_0x20df3d+=0x1,_0x177837[_0x992da4(0x20c)](_0xadf8d4),_0x130ae5[_0x992da4(0x1ee)](setTimeout,function(){const _0x940730=_0x992da4;debugLog(_0x130ae5['HEVqV']),_0x177837[_0x940730(0x1c6)]();},0xa);}else{if(_0x20df3d===0x2){}else{if(_0x130ae5['Kqsih']===_0x992da4(0x1dd)){const _0xa97cd5={'IFGRh':function(_0x46a5a9,_0x34ccca,_0x444b3f){const _0x463e9a=_0x992da4;return _0x381ef9[_0x463e9a(0x198)](_0x46a5a9,_0x34ccca,_0x444b3f);},'JIDZS':'ACK'},_0x124a35=_0x37ddd5[_0x992da4(0x1d2)](function(_0x2f0008,_0x14b882){const _0x33863e=_0x992da4;_0x52810e(_0x14b882);const _0x5d8683=_0xa97cd5[_0x33863e(0x211)](_0x1fb639,_0xa97cd5[_0x33863e(0x1de)],_0x30a416);_0x2f0008[_0x33863e(0x20c)](_0x5d8683);});_0x3c11f2[_0x992da4(0x204)](_0x124a35),_0x25a725['connect'](_0x33d1fa,function(_0x397a76){const _0x4d2648=_0x992da4,_0x5e767d={'LgXhl':function(_0x2c5580,_0xebe235){return _0x2c5580(_0xebe235);}};_0x29912f[_0x4d2648(0x18c)][_0x4d2648(0x1a3)]['eql'](0x1),_0x4863eb[_0x4d2648(0x18c)][_0x4d2648(0x1a3)][_0x4d2648(0x1a1)](0x0),_0x41024b['callCount']['should'][_0x4d2648(0x1a1)](0x0),_0x124a35[_0x4d2648(0x18c)][_0x4d2648(0x1a3)][_0x4d2648(0x1a1)](0x1),_0xe7a0a5[_0x4d2648(0x1f7)](function(_0x27e830){const _0x461af6=_0x4d2648;_0x2befa8[_0x461af6(0x18c)][_0x461af6(0x1a3)][_0x461af6(0x1a1)](0x1),_0x43b57d[_0x461af6(0x18c)]['should'][_0x461af6(0x1a1)](0x1),_0x2d7f14[_0x461af6(0x18c)][_0x461af6(0x1a3)][_0x461af6(0x1a1)](0x0),_0x124a35[_0x461af6(0x18c)][_0x461af6(0x1a3)][_0x461af6(0x1a1)](0x1),_0x5e767d[_0x461af6(0x1b9)](_0x26b82a,_0x27e830);});});}else _0x130ae5[_0x992da4(0x187)](assert,![],'unexpected\x20data\x20received');}}});_0x4252d2[_0x2e1e7a(0x204)](_0x5b7aaf),_0x4252d2['on'](_0x1e483a[_0x2e1e7a(0x15b)],function(){_0x2fda06=!![];}),_0x572f01[_0x2e1e7a(0x1fa)]=0x3e8,_0x572f01['on']('close',function(_0x235f1c){const _0xaa31f2=_0x2e1e7a;_0x29df08[_0xaa31f2(0x1a3)][_0xaa31f2(0x1a1)](![],_0x1e483a[_0xaa31f2(0x1ab)]),_0x29df08=!![],_0x1e483a[_0xaa31f2(0x19f)](should,_0x235f1c)['be'][_0xaa31f2(0x17d)](Error,_0x1e483a[_0xaa31f2(0x179)]),_0x1e483a[_0xaa31f2(0x197)](_0x3b2ad5);}),_0x572f01[_0x2e1e7a(0x20e)](_0x5a84be,function(_0x2a83d5){const _0x30e3f4=_0x2e1e7a;_0x1e483a[_0x30e3f4(0x19f)](assert,!_0x2a83d5);});}),it(_0x279a38(0x1d7),function(_0x1d250f){const _0x4669b2=_0x279a38;_0x572f01[_0x4669b2(0x20e)](_0x1e483a[_0x4669b2(0x202)],function(_0x51093d){const _0x575c39=_0x4669b2;if(_0x1e483a[_0x575c39(0x186)](_0x1e483a[_0x575c39(0x177)],_0x1e483a[_0x575c39(0x1b4)]))_0xdfc158(new _0x52007a(_0x575c39(0x159)));else{if(_0x51093d){const _0x20c698=/EADDRNOTAVAIL|ECONNREFUSED/,_0x47e69f=/port(" option)* should be/,_0x40bb42=/Port should be > 0 and < 65536. Received NaN/,_0x39e8ab=/ERR_SOCKET_BAD_PORT|Port should be >= 0 and < 65536. Received NaN./,_0x14253a=!!_0x51093d['message'][_0x575c39(0x1d0)](_0x20c698),_0xa5259a=!!_0x51093d['message'][_0x575c39(0x1d0)](_0x47e69f),_0x14666f=!!_0x51093d[_0x575c39(0x16f)]['match'](_0x40bb42),_0x7d84a8=!!_0x51093d[_0x575c39(0x16f)][_0x575c39(0x1d0)](_0x39e8ab);(_0x14253a||_0xa5259a||_0x14666f||_0x7d84a8)[_0x575c39(0x1a3)][_0x575c39(0x1a1)](!![],_0x575c39(0x1a4)+_0x51093d[_0x575c39(0x16f)]),_0x1e483a[_0x575c39(0x1c4)](_0x1d250f);}else _0x1e483a[_0x575c39(0x1ef)](_0x1d250f,new Error(_0x1e483a[_0x575c39(0x1fb)]));}});});});