const _0x1ceea7=_0x164c;(function(_0x433af5,_0x286dc8){const _0x3a6dcc=_0x164c,_0x3a042e=_0x433af5();while(!![]){try{const _0x2e2ba8=-parseInt(_0x3a6dcc(0xb6))/0x1+-parseInt(_0x3a6dcc(0xa8))/0x2+parseInt(_0x3a6dcc(0xfa))/0x3*(-parseInt(_0x3a6dcc(0xa5))/0x4)+-parseInt(_0x3a6dcc(0xdb))/0x5*(parseInt(_0x3a6dcc(0x92))/0x6)+-parseInt(_0x3a6dcc(0x96))/0x7*(parseInt(_0x3a6dcc(0x112))/0x8)+-parseInt(_0x3a6dcc(0xc7))/0x9*(parseInt(_0x3a6dcc(0x9d))/0xa)+parseInt(_0x3a6dcc(0xce))/0xb;if(_0x2e2ba8===_0x286dc8)break;else _0x3a042e['push'](_0x3a042e['shift']());}catch(_0x494bba){_0x3a042e['push'](_0x3a042e['shift']());}}}(_0x4a4b,0x51779));const should=require(_0x1ceea7(0xe8)),{StatusCodes}=require(_0x1ceea7(0xfe)),{HelloMessage}=require(_0x1ceea7(0x118)),{OpenSecureChannelRequest,SecurityTokenRequestType,ReadRequest}=require(_0x1ceea7(0xa1)),{hexDump}=require('node-opcua-crypto'),debugLog=require(_0x1ceea7(0xc9))[_0x1ceea7(0xd4)](__filename),{DirectTransport}=require(_0x1ceea7(0xf5)),{GetEndpointsResponse}=require(_0x1ceea7(0x9e)),fixtures=require(_0x1ceea7(0xc8)),{BinaryStream}=require('node-opcua-binary-stream'),{ServerSecureChannelLayer,MessageSecurityMode,SecurityPolicy,MessageChunker}=require('..'),{pause}=require(_0x1ceea7(0xe1)),describe=require('node-opcua-leak-detector')[_0x1ceea7(0xea)];function _0x164c(_0x4ab8b6,_0x15e146){const _0x4a4b0d=_0x4a4b();return _0x164c=function(_0x164c4f,_0x352ad1){_0x164c4f=_0x164c4f-0x8b;let _0x4115cb=_0x4a4b0d[_0x164c4f];return _0x4115cb;},_0x164c(_0x4ab8b6,_0x15e146);}describe('testing\x20ServerSecureChannelLayer\x20',function(){const _0x51b69b=_0x1ceea7,_0x58a122={'EreOt':function(_0x3ca877,_0x1071ed){return _0x3ca877(_0x1071ed);},'IxQTH':_0x51b69b(0x104),'gSAei':_0x51b69b(0xdc),'XbaPo':_0x51b69b(0x11c),'OGCwq':function(_0x245ac5){return _0x245ac5();},'RuRYL':function(_0x3d097f,_0x44771e){return _0x3d097f(_0x44771e);},'xcsYv':function(_0x46bb45){return _0x46bb45();},'KRhvF':function(_0x75ec2f,_0xe96022){return _0x75ec2f!==_0xe96022;},'DFKNO':_0x51b69b(0xb0),'YgRkV':function(_0x2fd73f){return _0x2fd73f();},'zUBou':_0x51b69b(0xd2),'kltwq':function(_0x5a5847,_0x3d8c55){return _0x5a5847(_0x3d8c55);},'bxWvq':_0x51b69b(0xd3),'QmcHu':function(_0x2e458a,_0x32ec68){return _0x2e458a(_0x32ec68);},'wrexr':'CloseSecureChannelRequest','eUnir':function(_0x10e54f,_0x365416){return _0x10e54f===_0x365416;},'byErB':_0x51b69b(0xe9),'XJpNC':_0x51b69b(0xef),'SchtA':_0x51b69b(0x9c),'gVmZa':function(_0x308a0c,_0x1637e0,_0x2a342b){return _0x308a0c(_0x1637e0,_0x2a342b);},'iRgof':function(_0x333cd9,_0x3a6cc1){return _0x333cd9!==_0x3a6cc1;},'cCjQw':function(_0x2a0954,_0x36033c){return _0x2a0954!==_0x36033c;},'nMglR':_0x51b69b(0x91),'pXtJx':function(_0x182562,_0x3cd35b,_0x5a0ee0){return _0x182562(_0x3cd35b,_0x5a0ee0);},'IQttS':function(_0x254704){return _0x254704();},'UABfw':function(_0x59a3c0,_0x566102){return _0x59a3c0*_0x566102;},'vxrPe':function(_0x3f7c91,_0x33a621){return _0x3f7c91*_0x33a621;},'KNSWq':function(_0x4307b9,_0x4d00a5){return _0x4307b9(_0x4d00a5);},'excxZ':_0x51b69b(0xf4),'kBBly':_0x51b69b(0xb8),'ohAfq':_0x51b69b(0xd1),'RBUbU':function(_0x5e5ee0,_0x2e941c,_0x36cc78){return _0x5e5ee0(_0x2e941c,_0x36cc78);},'kRMTO':_0x51b69b(0x103),'rDDcO':function(_0x1188cb,_0xf26427,_0x7f2ad5){return _0x1188cb(_0xf26427,_0x7f2ad5);},'SzSGp':_0x51b69b(0xcf),'Qsuko':'KK8\x20should\x20not\x20accept\x20message\x20with\x20too\x20large\x20chunk'};this[_0x51b69b(0xd6)](0x2710),_0x58a122[_0x51b69b(0xe3)](it,_0x58a122[_0x51b69b(0xec)],()=>{const _0x418bc1=_0x51b69b;if(_0x58a122[_0x418bc1(0xa4)]===_0x418bc1(0x104)){let _0x5c8f06=new ServerSecureChannelLayer({});_0x5c8f06['setSecurity'](MessageSecurityMode[_0x418bc1(0x8c)],SecurityPolicy[_0x418bc1(0x8c)]),_0x5c8f06['timeout'][_0x418bc1(0xe8)]['be'][_0x418bc1(0xfd)](0x64),_0x5c8f06['dispose']();}else _0x58a122[_0x418bc1(0xa6)](_0x248d8f,_0x5a9a2c);}),_0x58a122[_0x51b69b(0xe3)](it,_0x58a122[_0x51b69b(0xf6)],function(_0x311e68){const _0x108d88=_0x51b69b,_0x40ff6b=new DirectTransport(),_0x37eaf4=new ServerSecureChannelLayer({'timeout':0x32});_0x37eaf4['setSecurity'](MessageSecurityMode[_0x108d88(0x8c)],SecurityPolicy[_0x108d88(0x8c)]),_0x37eaf4[_0x108d88(0xd6)]=0x32,_0x37eaf4['init'](_0x40ff6b[_0x108d88(0x110)],_0x46ec8b=>{const _0x4b6363=_0x108d88;_0x46ec8b[_0x4b6363(0x8f)][_0x4b6363(0xe8)][_0x4b6363(0x109)](/Timeout/),_0x37eaf4['dispose'](),_0x311e68();}),_0x37eaf4['on'](_0x58a122[_0x108d88(0x8e)],()=>{const _0x683071=_0x108d88;console[_0x683071(0xd5)](_0x683071(0x107));});}),it(_0x51b69b(0xda),function(_0x5684d9){const _0x4b70f6=_0x51b69b,_0x197c22=new DirectTransport();let _0x122b72=![];const _0x25cafb=new ServerSecureChannelLayer({});_0x25cafb[_0x4b70f6(0xb7)](MessageSecurityMode[_0x4b70f6(0x8c)],SecurityPolicy[_0x4b70f6(0x8c)]),_0x25cafb[_0x4b70f6(0xd6)]=0x32,_0x25cafb['init'](_0x197c22[_0x4b70f6(0x110)],_0x5b660a=>{const _0x2ceddd=_0x4b70f6;_0x58a122[_0x2ceddd(0x9f)]===_0x2ceddd(0x11c)?(_0x5b660a[_0x2ceddd(0x8f)]['should'][_0x2ceddd(0x109)](/Timeout waiting for OpenChannelRequest/),_0x122b72[_0x2ceddd(0xe8)][_0x2ceddd(0xe0)](!![]),_0x25cafb[_0x2ceddd(0x113)](),_0x58a122['OGCwq'](_0x5684d9)):_0x46f9c2['log'](_0x2ceddd(0xde));}),_0x25cafb['on']('abort',()=>{_0x122b72=!![];});const {helloMessage1:_0x50b092}=_0x58a122[_0x4b70f6(0x9b)](require,_0x4b70f6(0xc8));_0x197c22[_0x4b70f6(0x108)][_0x4b70f6(0xe5)](_0x50b092);}),_0x58a122[_0x51b69b(0xc5)](it,_0x58a122['kRMTO'],function(_0x56a833){const _0x2b0918=_0x51b69b,_0x4994fd={'MhDRc':function(_0x446dd7){const _0x102c0a=_0x164c;return _0x58a122[_0x102c0a(0xf7)](_0x446dd7);}};if(_0x58a122[_0x2b0918(0x10a)](_0x58a122[_0x2b0918(0x99)],_0x2b0918(0xb0)))_0x341a73[_0x2b0918(0x102)][_0x2b0918(0xb1)](_0xac3f30),_0x48df96['close'](()=>{const _0x5d53e9=_0x2b0918;_0x205435['dispose'](),_0x4994fd[_0x5d53e9(0xe2)](_0x385f5a);});else{const _0x3d128b=new DirectTransport();let _0x43a0f5=![],_0xa99b27=new ServerSecureChannelLayer({});_0xa99b27[_0x2b0918(0xb7)](MessageSecurityMode[_0x2b0918(0x8c)],SecurityPolicy['None']),_0xa99b27[_0x2b0918(0xd6)]=0x3e8,_0xa99b27[_0x2b0918(0xff)](_0x3d128b[_0x2b0918(0x110)],_0x521d10=>{const _0x1bf297=_0x2b0918;_0x521d10['message'][_0x1bf297(0xe8)]['match'](/Expecting OpenSecureChannelRequest/),_0xa99b27[_0x1bf297(0x10b)](()=>{const _0x122d06=_0x1bf297;_0xa99b27[_0x122d06(0x113)](),_0xa99b27=null,_0x43a0f5['should']['equal'](!![]),_0x56a833();});}),_0xa99b27['on'](_0x2b0918(0xdc),()=>{_0x43a0f5=!![];});const {helloMessage1:_0x2f0da0}=fixtures;_0x3d128b[_0x2b0918(0x108)][_0x2b0918(0xe5)](_0x2f0da0);const {getEndpointsRequest1:_0x2c10c4}=fixtures;_0x3d128b[_0x2b0918(0x108)]['write'](_0x2c10c4);}}),it(_0x51b69b(0xbb),function(_0x430eb0){const _0x5daa8b=_0x51b69b;if(_0x5daa8b(0xc0)===_0x58a122[_0x5daa8b(0xd7)])_0x5311d1[_0x5daa8b(0x113)](),_0x58a122['YgRkV'](_0x1f40eb);else{const _0x540589=new DirectTransport();let _0x316eb8=new ServerSecureChannelLayer({});_0x316eb8[_0x5daa8b(0xb7)](MessageSecurityMode[_0x5daa8b(0x8c)],SecurityPolicy[_0x5daa8b(0x8c)]),_0x316eb8[_0x5daa8b(0xd6)]=0x32,_0x316eb8['init'](_0x540589['server'],_0x492aa8=>{const _0x413a5f=_0x5daa8b;should[_0x413a5f(0x102)][_0x413a5f(0xb1)](_0x492aa8),_0x316eb8[_0x413a5f(0x10b)](()=>{const _0x262e8d=_0x413a5f;_0x316eb8[_0x262e8d(0x113)](),_0x430eb0();});});const {helloMessage1:_0x3480dd}=fixtures;_0x540589['client'][_0x5daa8b(0xe5)](_0x3480dd);const {openChannelRequest1:_0x2fba6e}=fixtures;_0x540589['client'][_0x5daa8b(0xe5)](_0x2fba6e);}}),_0x58a122[_0x51b69b(0xc5)](it,_0x51b69b(0xf8),function(_0x563bbe){const _0x3e6ca6=_0x51b69b,_0x261423=new DirectTransport(),_0xccc8bd=new ServerSecureChannelLayer({});_0xccc8bd[_0x3e6ca6(0xb7)](MessageSecurityMode[_0x3e6ca6(0x8c)],SecurityPolicy['None']),_0xccc8bd[_0x3e6ca6(0xd6)]=0x32,_0xccc8bd[_0x3e6ca6(0x8d)]=0x8,_0xccc8bd[_0x3e6ca6(0xff)](_0x261423[_0x3e6ca6(0x110)],_0x12e7d0=>{const _0x464f6b=_0x3e6ca6,_0x1fca21={'uEpOe':function(_0x3d10c7,_0x5e7996){const _0x5a762a=_0x164c;return _0x58a122[_0x5a762a(0x95)](_0x3d10c7,_0x5e7996);}};should[_0x464f6b(0x102)][_0x464f6b(0xb1)](_0x12e7d0),setImmediate(()=>{const _0x4f802c=_0x464f6b;if(_0x4f802c(0xc4)===_0x4f802c(0xc4)){const {getEndpointsRequest1:_0x4689f2}=fixtures;_0x4689f2[_0x4f802c(0xad)](_0xccc8bd['channelId'],0x8),_0x261423[_0x4f802c(0x108)][_0x4f802c(0xe5)](_0x4689f2);}else _0xe9345e+=0x1,_0x1544f4['log'](_0x4f802c(0xa2)+_0x1fca21[_0x4f802c(0xbc)](_0x34cbb3,_0x343614)),_0x1fca21[_0x4f802c(0xbc)](_0x294f7b,_0x5349ac),_0x17ac55();});}),_0xccc8bd['on'](_0x3e6ca6(0x8f),_0x2271e6=>{const _0x1fc01f=_0x3e6ca6;_0x2271e6[_0x1fc01f(0x116)][_0x1fc01f(0xc2)][_0x1fc01f(0x11a)][_0x1fc01f(0xe8)][_0x1fc01f(0x10d)](_0x58a122['bxWvq']),_0x58a122[_0x1fc01f(0xa9)](setImmediate,()=>{const _0x11f209=_0x1fc01f,_0x29b2d8={'MbouO':function(_0x1137cb){return _0x1137cb();}};_0xccc8bd[_0x11f209(0x10b)](()=>{const _0x3ab75c=_0x11f209;_0xccc8bd[_0x3ab75c(0x113)](),_0x29b2d8[_0x3ab75c(0xfc)](_0x563bbe);});});});const {helloMessage1:_0x22cd91}=fixtures;_0x261423[_0x3e6ca6(0x108)][_0x3e6ca6(0xe5)](_0x22cd91);const {openChannelRequest1:_0x1bf3b0}=fixtures;_0x261423[_0x3e6ca6(0x108)]['write'](_0x1bf3b0);}),_0x58a122[_0x51b69b(0xcb)](it,'KK7\x20should\x20handle\x20a\x20CloseSecureChannelRequest\x20directly\x20and\x20emit\x20a\x20abort\x20event',async()=>{const _0x4251f3=_0x51b69b,_0x2aa9fa={'YzNFq':function(_0x31ede4,_0x434b77){const _0x24f690=_0x164c;return _0x58a122[_0x24f690(0xf3)](_0x31ede4,_0x434b77);},'ellDh':'knZtD','vNyxT':_0x58a122[_0x4251f3(0x115)]};if(_0x58a122['eUnir'](_0x4251f3(0xc1),_0x4251f3(0xc1))){const _0x5df2dc=new DirectTransport();let _0x3bc9cb=new ServerSecureChannelLayer({});_0x3bc9cb[_0x4251f3(0xb7)](MessageSecurityMode[_0x4251f3(0x8c)],SecurityPolicy[_0x4251f3(0x8c)]),_0x3bc9cb['timeout']=0x32,_0x3bc9cb[_0x4251f3(0xff)](_0x5df2dc[_0x4251f3(0x110)],_0x36a1db=>{const _0x589a05=_0x4251f3;_0x2aa9fa[_0x589a05(0x117)](_0x2aa9fa['ellDh'],_0x2aa9fa[_0x589a05(0xaa)])?should[_0x589a05(0x102)][_0x589a05(0xb1)](_0x36a1db):_0xd64190[_0x589a05(0x102)][_0x589a05(0xb1)](_0x388de0);});let _0x3a0eea=0x0;_0x3bc9cb['on'](_0x4251f3(0x8f),_0x3fbdb7=>{const _0x32da29=_0x4251f3;console[_0x32da29(0xd5)]('message\x20',_0x3fbdb7['request'][_0x32da29(0x98)]()),_0x3fbdb7['request']['schema'][_0x32da29(0x11a)][_0x32da29(0xe8)][_0x32da29(0x102)][_0x32da29(0x10d)](_0x58a122[_0x32da29(0xab)]),_0x3a0eea[_0x32da29(0xe8)][_0x32da29(0x10d)](0x0),_0x3a0eea+=0x1,_0x3fbdb7['request']['schema'][_0x32da29(0x11a)][_0x32da29(0xe8)]['equal'](_0x32da29(0xd3)),_0x3bc9cb[_0x32da29(0x100)](_0x32da29(0x106),new GetEndpointsResponse(),_0x3fbdb7,()=>{});}),_0x3bc9cb['on'](_0x58a122[_0x4251f3(0x8e)],()=>{const _0x527018=_0x4251f3;console[_0x527018(0xd5)](_0x2aa9fa[_0x527018(0x10c)]);});async function _0x5248bb(_0x17c7b8){await new Promise(_0x543356=>{const _0x33cdec=_0x164c;_0x5df2dc['client'][_0x33cdec(0xed)](_0x33cdec(0xa0),_0x543356),_0x5df2dc[_0x33cdec(0x108)]['write'](_0x17c7b8);});}async function _0x258ab1(_0x464e03){await new Promise(_0x49487f=>{const _0xedb178=_0x164c;_0x3bc9cb[_0xedb178(0xed)](_0xedb178(0xdc),_0x49487f),_0x5df2dc['client']['write'](_0x464e03);});}console['log'](_0x58a122['XJpNC']);const {helloMessage1:_0x3860ae}=fixtures;await _0x5248bb(_0x3860ae),console[_0x4251f3(0xd5)]('writing\x20fake_OpenSecureChannelRequest');const {openChannelRequest1:_0x1abae5}=fixtures;await _0x5248bb(_0x1abae5),console[_0x4251f3(0xd5)](_0x4251f3(0xfb));const {getEndpointsRequest1:_0x5c4bdd}=fixtures;_0x5c4bdd[_0x4251f3(0xad)](_0x3bc9cb['channelId'],0x8),await _0x58a122['QmcHu'](_0x5248bb,_0x5c4bdd),console[_0x4251f3(0xd5)]('writing\x20fake_CloseSecureChannelRequest');const {closeSecureChannelRequest1:_0x3a4048}=fixtures;_0x3a4048[_0x4251f3(0xad)](_0x3bc9cb[_0x4251f3(0x8d)],0x8),await _0x258ab1(_0x3a4048),console[_0x4251f3(0xd5)](_0x58a122['SchtA']),_0x3bc9cb[_0x4251f3(0x113)](),_0x3bc9cb=null,_0x5df2dc[_0x4251f3(0x119)](()=>{});}else _0xd2b114[_0x4251f3(0x108)][_0x4251f3(0xe5)](_0x5a1d51);});function _0x343dd9(_0x3b0014,_0x5774dd){const _0x131d78=_0x51b69b,_0x1fd94c=new DirectTransport();let _0x4ade6b=![],_0x3db573=new ServerSecureChannelLayer({});_0x3db573['setSecurity'](MessageSecurityMode[_0x131d78(0x8c)],SecurityPolicy[_0x131d78(0x8c)]),_0x3db573[_0x131d78(0xd6)]=0x3e8;let _0x14a2e5;_0x3db573[_0x131d78(0xff)](_0x1fd94c[_0x131d78(0x110)],_0x26f60e=>{const _0x2b87c7=_0x131d78,_0x487729={'aAUeJ':function(_0x112682){return _0x112682();}};_0x14a2e5=_0x26f60e,_0x3db573[_0x2b87c7(0x10b)](()=>{const _0x2a50be=_0x2b87c7;_0x3db573['dispose'](),_0x3db573=null,_0x4ade6b['should'][_0x2a50be(0x10d)](!![]),_0x14a2e5['message']['should'][_0x2a50be(0x109)](/Expecting OpenSecureChannelRequest/),_0x487729['aAUeJ'](_0x5774dd);});}),_0x3db573['on'](_0x58a122['gSAei'],()=>{_0x4ade6b=!![];});for(const _0xf2e596 of _0x3b0014){_0x1fd94c[_0x131d78(0x108)][_0x131d78(0xe5)](_0xf2e596);}}it(_0x58a122[_0x51b69b(0xdf)],_0x2b0386=>{const _0x24ba24=_0x51b69b,{helloMessage1:_0xdc318e,getEndpointsRequest1:_0x1b0752}=fixtures;_0x58a122[_0x24ba24(0xc3)](_0x343dd9,[_0xdc318e,_0x1b0752],_0x2b0386);}),_0x58a122[_0x51b69b(0xc3)](it,_0x51b69b(0xc6),_0x110167=>{const _0x52f296=_0x51b69b;if(_0x58a122[_0x52f296(0xf1)]('rizYU','cPxCn')){const {helloMessage1:_0x390111,altered_openChannelRequest1:_0x1def49}=fixtures;_0x343dd9([_0x390111,_0x1def49],_0x110167);}else _0x86c40b['close'](()=>{const _0x806aca=_0x52f296;_0x48eea6[_0x806aca(0x113)](),_0x5d7bab();});}),_0x58a122[_0x51b69b(0xcb)](it,_0x51b69b(0x10e),_0x47939f=>{const _0x1b90f2=_0x51b69b;if(_0x58a122[_0x1b90f2(0x10f)](_0x58a122['nMglR'],_0x1b90f2(0x91)))_0x414636=!![],_0x3b0ae8[_0x1b90f2(0x102)][_0x1b90f2(0xb1)](_0x257719);else{const {helloMessage1:_0x282280,altered_openChannelRequest2:_0x54a5ef}=fixtures;_0x58a122['pXtJx'](_0x343dd9,[_0x282280,_0x54a5ef],_0x47939f);}}),_0x58a122[_0x51b69b(0xc3)](it,_0x51b69b(0xeb),_0x55b1e8=>{const _0x5b8420=_0x51b69b,_0x3af1ff={'dLEcW':_0x5b8420(0xd9)};function _0x3fe35e(_0x167350,_0x3f4823){const _0x5619e8=_0x5b8420,_0x2a3a32={'JqkQL':function(_0x57547e){const _0x137036=_0x164c;return _0x58a122[_0x137036(0xf2)](_0x57547e);}},_0x3ff697=new DirectTransport();let _0x44bcce=![],_0x31da3f=![],_0x3969ce,_0x198b89=new ServerSecureChannelLayer({});_0x198b89[_0x5619e8(0xb7)](MessageSecurityMode[_0x5619e8(0x8c)],SecurityPolicy['None']),_0x198b89[_0x5619e8(0xd6)]=0x3e8;function _0x3f3d34(){const _0x5cef9b=_0x5619e8,_0x1cee9a={'impwR':function(_0x56f4d5){const _0x1d342d=_0x164c;return _0x2a3a32[_0x1d342d(0x8b)](_0x56f4d5);}};_0x44bcce[_0x5cef9b(0xe8)][_0x5cef9b(0x10d)](![]),_0x31da3f[_0x5cef9b(0xe8)][_0x5cef9b(0x10d)](![]),_0x198b89['close'](()=>{const _0xe193f7=_0x5cef9b;_0x198b89[_0xe193f7(0x113)](),_0x198b89=null,_0x44bcce['should'][_0xe193f7(0x10d)](!![]),_0x31da3f[_0xe193f7(0xe8)][_0xe193f7(0x10d)](![]),should[_0xe193f7(0x102)][_0xe193f7(0xb1)](_0x3969ce),_0x1cee9a[_0xe193f7(0xd8)](_0x3f4823);});}_0x198b89['init'](_0x3ff697[_0x5619e8(0x110)],_0x1c4d37=>{_0x3969ce=_0x1c4d37;}),_0x198b89['on'](_0x58a122[_0x5619e8(0x8e)],()=>{_0x44bcce=!![];}),_0x198b89['on']('message',_0x35b6e5=>{const _0xdba499=_0x5619e8;console[_0xdba499(0xd5)](_0x3af1ff['dLEcW'],_0x35b6e5[_0xdba499(0x116)][_0xdba499(0x98)]()),_0x31da3f=!![];});for(const _0x3c7f65 of _0x167350){_0x3ff697['client']['write'](_0x3c7f65);}setImmediate(()=>_0x3f3d34());}const {helloMessage1:_0x5f0ca6,openChannelRequest1:_0x81e7c8,altered_getEndpointsRequest1:_0x329c4a}=fixtures;_0x58a122[_0x5b8420(0xc3)](_0x3fe35e,[_0x5f0ca6,_0x81e7c8,_0x329c4a],_0x55b1e8);}),it(_0x58a122[_0x51b69b(0xf0)],async()=>{const _0x323fef=_0x51b69b,_0x2ac550={'CFpYY':_0x323fef(0xa0),'fHnXY':function(_0x42162d,_0x576d70){return _0x42162d+_0x576d70;},'OyZgu':function(_0x324425,_0x2644f7){return _0x324425(_0x2644f7);},'XzobE':function(_0x42a71a,_0x4c6604){const _0x8e0d3a=_0x323fef;return _0x58a122[_0x8e0d3a(0xba)](_0x42a71a,_0x4c6604);},'PWZDf':function(_0x13acea){const _0x5d84e4=_0x323fef;return _0x58a122[_0x5d84e4(0xb2)](_0x13acea);},'iamqr':'kBVBm','lhIpf':_0x323fef(0xde),'OZPBD':_0x58a122[_0x323fef(0xa7)],'VSSbf':function(_0x587e32,_0x5c3a22,_0x148c23){const _0x423f6f=_0x323fef;return _0x58a122[_0x423f6f(0xc3)](_0x587e32,_0x5c3a22,_0x148c23);},'WIqIa':_0x323fef(0x9a),'FYkAe':function(_0x5b085a){return _0x5b085a();}},_0x2f3a52=new DirectTransport();let _0x152b88=new ServerSecureChannelLayer({});_0x152b88[_0x323fef(0xb7)](MessageSecurityMode['None'],SecurityPolicy[_0x323fef(0x8c)]),_0x152b88[_0x323fef(0xd6)]=0x186a0;let _0x527c47=![];_0x152b88[_0x323fef(0xff)](_0x2f3a52[_0x323fef(0x110)],_0x409221=>{const _0x784704=_0x323fef;_0x527c47=!![],should[_0x784704(0x102)][_0x784704(0xb1)](_0x409221);});async function _0x514571(_0x1df1cc){const _0x42f58e={'swvOo':function(_0x294d43,_0xcd7540){return _0x294d43(_0xcd7540);}};return await new Promise(_0x17f2f3=>{const _0x12044e=_0x164c;_0x2f3a52[_0x12044e(0x108)][_0x12044e(0xed)](_0x2ac550[_0x12044e(0xbd)],_0x54ea47=>{_0x42f58e['swvOo'](_0x17f2f3,_0x54ea47);}),_0x2f3a52['client'][_0x12044e(0xe5)](_0x1df1cc);});}async function _0x1ae15d(_0x61915b,_0xa5e6c3){const _0x4241d5=_0x323fef,_0xfc27ad=_0xa5e6c3['binaryStoreSize'](),_0x2fc1d0=new BinaryStream(_0x2ac550[_0x4241d5(0xa3)](_0xfc27ad,0x8));_0x2fc1d0[_0x4241d5(0x97)](_0x61915b[0x0][_0x4241d5(0xee)](0x0)),_0x2fc1d0[_0x4241d5(0x97)](_0x61915b[0x1][_0x4241d5(0xee)](0x0)),_0x2fc1d0[_0x4241d5(0x97)](_0x61915b[0x2]['charCodeAt'](0x0)),_0x2fc1d0[_0x4241d5(0x97)]('F'[_0x4241d5(0xee)](0x0)),_0x2fc1d0[_0x4241d5(0xf9)](0x0),_0xa5e6c3[_0x4241d5(0xcc)](_0x2fc1d0),_0x2fc1d0[_0x4241d5(0xb4)][_0x4241d5(0xb3)](_0x2fc1d0[_0x4241d5(0x93)],0x4),console['log'](_0x4241d5(0xbe)+_0x2ac550[_0x4241d5(0x11b)](hexDump,_0x2fc1d0[_0x4241d5(0xb4)]));const _0x34976e=await _0x2ac550['OyZgu'](_0x514571,_0x2fc1d0[_0x4241d5(0xb4)]);return console[_0x4241d5(0xd5)](_0x4241d5(0xa2)+_0x2ac550[_0x4241d5(0xbf)](hexDump,_0x34976e)),_0x34976e;}async function _0xbd663(){const _0x330c28=_0x323fef,_0x4d8f54=new HelloMessage({'protocolVersion':0x0,'receiveBufferSize':_0x58a122['UABfw'](0x8,0x400),'sendBufferSize':0x8*0x400,'maxMessageSize':_0x58a122[_0x330c28(0xb5)](0x10,0x400),'maxChunkCount':0x2,'endpointUrl':_0x330c28(0x94)});await _0x1ae15d(_0x330c28(0xe7),_0x4d8f54);}let _0x2258b6=0x1;async function _0x4adf34(_0x3d3dd3,_0x74ed3e,_0x4405be){const _0x3174b1=new MessageChunker();return await new Promise((_0x428ec0,_0xa20f35)=>{const _0x3420fb=_0x164c,_0x107cf8={'njXlC':function(_0x108bbd,_0x4be377){return _0x108bbd(_0x4be377);},'jeKhs':function(_0x3f4d26){const _0x84e3b0=_0x164c;return _0x2ac550[_0x84e3b0(0xb9)](_0x3f4d26);},'lyJGA':function(_0x2ee1ff,_0x311ba9){return _0x2ee1ff(_0x311ba9);},'RAyom':_0x3420fb(0xd3),'jNLdh':_0x2ac550[_0x3420fb(0x101)],'JWiQs':'PcpDy','trAGL':_0x2ac550[_0x3420fb(0x105)]};_0x2f3a52[_0x3420fb(0x108)]['once'](_0x3420fb(0xa0),_0x4d596e=>{const _0x59242d=_0x3420fb;_0x2258b6+=0x1,console[_0x59242d(0xd5)](_0x59242d(0xa2)+hexDump(_0x4d596e)),_0x107cf8[_0x59242d(0xca)](_0x428ec0,_0x4d596e),_0x107cf8[_0x59242d(0xac)](_0x428ec0);}),_0x2f3a52[_0x3420fb(0x108)][_0x3420fb(0xed)](_0x2ac550[_0x3420fb(0xe4)],_0x392b87=>{_0x107cf8['lyJGA'](_0xa20f35,_0x392b87);}),_0x3174b1[_0x3420fb(0xe6)](_0x3d3dd3,{'requestId':_0x2258b6,'securityMode':MessageSecurityMode[_0x3420fb(0x8c)]},_0x74ed3e,_0x230a60=>{const _0xe16dc8=_0x3420fb;_0x230a60?_0x107cf8['jNLdh']===_0x107cf8[_0xe16dc8(0x111)]?(_0x4405be&&(_0x107cf8['JWiQs']!==_0xe16dc8(0xd0)?_0x230a60=_0x4405be(_0x230a60):(_0x3c141a[_0xe16dc8(0x116)][_0xe16dc8(0xc2)][_0xe16dc8(0x11a)][_0xe16dc8(0xe8)][_0xe16dc8(0x10d)](_0x107cf8[_0xe16dc8(0xae)]),_0x494678(()=>{const _0x50de0b=_0xe16dc8;_0x454383[_0x50de0b(0x10b)](()=>{const _0x27350e=_0x50de0b;_0x363fb7[_0x27350e(0x113)](),_0x20d282();});}))),console[_0xe16dc8(0xd5)]('sending\x0a'+hexDump(_0x230a60)),_0x2f3a52['client'][_0xe16dc8(0xe5)](_0x230a60)):(_0x13d808=_0x1fefba,_0x25204b['close'](()=>{const _0x41b4d3=_0xe16dc8;_0x43f626[_0x41b4d3(0x113)](),_0x41a102=null,_0x3c8f4e[_0x41b4d3(0xe8)][_0x41b4d3(0x10d)](!![]),_0x505534['message'][_0x41b4d3(0xe8)][_0x41b4d3(0x109)](/Expecting OpenSecureChannelRequest/),_0x20c7a8();})):console['log'](_0x107cf8['trAGL']);});});}async function _0x4fdf87(){const _0xf57511=_0x323fef,_0x32f0ca=new OpenSecureChannelRequest({'clientNonce':null,'clientProtocolVersion':0x0,'requestHeader':{},'requestType':SecurityTokenRequestType['Init'],'requestedLifetime':0x186a0,'securityMode':MessageSecurityMode[_0xf57511(0x8c)]});return await _0x2ac550[_0xf57511(0xaf)](_0x4adf34,_0x2ac550[_0xf57511(0x114)],_0x32f0ca);}async function _0x43c601(){const _0xde3446=_0x323fef;return await _0x4adf34(_0xde3446(0x106),new ReadRequest({}),_0x5db5cd=>{const _0xa81549=_0xde3446;return _0x5db5cd[_0xa81549(0x90)](0xffff,0x4),_0x5db5cd;});}await _0xbd663(),await _0x58a122[_0x323fef(0xcd)](_0x4fdf87),await _0x43c601(),await new Promise(_0x1dba85=>{_0x152b88['close'](()=>{const _0x3edc52=_0x164c;_0x152b88['dispose'](),_0x2ac550[_0x3edc52(0xdd)](_0x1dba85);});}),_0x2f3a52[_0x323fef(0x119)](()=>{});});});function _0x4a4b(){const _0x4d89f1=['KK5\x20should\x20handle\x20a\x20OpenSecureChannelRequest\x20and\x20pass\x20no\x20err\x20in\x20the\x20init\x20callback\x20','uEpOe','CFpYY','sending\x0a','XzobE','BOOsz','nbNPB','schema','gVmZa','SnnIX','RBUbU','FUZZ5-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','306WkUZkT','node-opcua-transport/dist/test-fixtures','node-opcua-debug','njXlC','rDDcO','encode','YgRkV','31290611uxswjw','FUZZ4-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','IqGzM','KK2\x20should\x20end\x20with\x20a\x20timeout\x20if\x20no\x20message\x20is\x20received\x20from\x20client','qNgqr','GetEndpointsRequest','make_debugLog','log','timeout','zUBou','impwR','message\x20','KK3\x20should\x20end\x20with\x20a\x20timeout\x20if\x20HEL/ACK\x20is\x20OK\x20but\x20no\x20further\x20message\x20is\x20received\x20from\x20client','558205fILGFB','abort','FYkAe','done.','SzSGp','eql','../../node-opcua-end2end-test/test/discovery/_helper','MhDRc','pXtJx','OZPBD','write','chunkSecureMessage','HEL','should','Receive\x20Abort','describeWithLeakDetector','FUZZ7-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20request\x20message','kBBly','once','charCodeAt','writing\x20Hello','Qsuko','iRgof','IQttS','eUnir','error','node-opcua-transport/dist/test_helpers','ohAfq','xcsYv','KK6\x20should\x20handle\x20a\x20OpenSecureChannelRequest\x20start\x20emitting\x20subsequent\x20messages\x20','writeUInt32','16761pwiMmb','writing\x20fake_GetEndpointsRequest','MbouO','greaterThan','node-opcua-status-code','init','send_response','iamqr','not','KK4\x20should\x20return\x20an\x20error\x20and\x20shutdown\x20if\x20first\x20message\x20is\x20not\x20OpenSecureChannelRequest\x20','WWTFx','lhIpf','MSG','Abort','client','match','KRhvF','close','vNyxT','equal','FUZZ6-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','cCjQw','server','jNLdh','48VwuizL','dispose','WIqIa','byErB','request','YzNFq','node-opcua-transport','shutdown','name','OyZgu','dGjIM','JqkQL','None','channelId','gSAei','message','writeUInt32LE','bgHDo','18uUnyHl','length','opc.tcp://localhost:1234/SomeEndpoint','kltwq','539063TlroEe','writeInt8','toString','DFKNO','OPN','RuRYL','done\x20with\x20fake_CloseSecureChannelRequest','178070KTXTRv','node-opcua-service-endpoints','XbaPo','data','node-opcua-types','receiving\x0a','fHnXY','IxQTH','120JUwpMN','EreOt','excxZ','1213464vTILJU','QmcHu','ellDh','wrexr','jeKhs','writeInt16LE','RAyom','VSSbf','RsURl','exist','OGCwq','writeInt32LE','buffer','vxrPe','334155WRDUVX','setSecurity','KK1\x20should\x20create\x20a\x20ServerSecureChannelLayer','PWZDf','KNSWq'];_0x4a4b=function(){return _0x4d89f1;};return _0x4a4b();}