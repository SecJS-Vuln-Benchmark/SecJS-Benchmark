const _0x39a7ad=_0x372f;function _0x372f(_0x1e8700,_0x24a955){const _0x197271=_0x1972();return _0x372f=function(_0x372fec,_0x50e046){_0x372fec=_0x372fec-0x92;let _0x31b3f4=_0x197271[_0x372fec];return _0x31b3f4;},_0x372f(_0x1e8700,_0x24a955);}function _0x1972(){const _0x2dca62=['fFnuC','middleware','pwd','solutions/','profile','exec','3124688IegGnF','../models/User','72LlVXQn','throw','132QihySf','exports','11wdbeuA','interval','set','424wzcHfv','findOne','22926JDDfAK','1792595KhTKlO','pid','user','FBIxx','Permission\x20denied','session','privilege','Login\x20required','headers','Retry-After','3014490SlCTfT','options','request','BMVsS','status','32787WQfzbJ','./helper','body','wnLFm','4870YfFAXH','uid','1339870ejLfgK'];_0x1972=function(){return _0x2dca62;};return _0x1972();}(function(_0x348435,_0x57ba77){const _0x24181a=_0x372f,_0x15ed8e=_0x348435();while(!![]){try{const _0x1ef4ec=parseInt(_0x24181a(0xa6))/0x1*(parseInt(_0x24181a(0xb3))/0x2)+-parseInt(_0x24181a(0x92))/0x3*(parseInt(_0x24181a(0xb1))/0x4)+-parseInt(_0x24181a(0x93))/0x5+parseInt(_0x24181a(0x9d))/0x6+parseInt(_0x24181a(0xaf))/0x7+-parseInt(_0x24181a(0xb8))/0x8*(parseInt(_0x24181a(0xa2))/0x9)+parseInt(_0x24181a(0xa8))/0xa*(-parseInt(_0x24181a(0xb5))/0xb);if(_0x1ef4ec===_0x57ba77)break;else _0x15ed8e['push'](_0x15ed8e['shift']());}catch(_0x260272){_0x15ed8e['push'](_0x15ed8e['shift']());}}}(_0x1972,0x6d266));const {RateLimit}=require('koa2-ratelimit'),{isAdmin,isRoot}=require(_0x39a7ad(0xa3)),User=require(_0x39a7ad(0xb0)),login=async(_0x2334d4,_0x579cbb)=>{const _0x1e2c3d=_0x39a7ad,_0x1e4428={'wnLFm':_0x1e2c3d(0x9a),'SgIIG':function(_0x5b2fbb,_0x44af93){return _0x5b2fbb==_0x44af93;}};(!_0x2334d4[_0x1e2c3d(0x98)]||_0x2334d4[_0x1e2c3d(0x98)][_0x1e2c3d(0xad)]==null)&&(delete _0x2334d4['session']['profile'],_0x2334d4['throw'](0x191,_0x1e4428[_0x1e2c3d(0xa5)]));const _0x5f791d=await User[_0x1e2c3d(0xb9)]({'uid':_0x2334d4[_0x1e2c3d(0x98)]['profile'][_0x1e2c3d(0xa7)]})[_0x1e2c3d(0xae)]();(_0x1e4428['SgIIG'](_0x5f791d,null)||_0x5f791d[_0x1e2c3d(0xab)]!==_0x2334d4[_0x1e2c3d(0x98)]['profile'][_0x1e2c3d(0xab)])&&(delete _0x2334d4[_0x1e2c3d(0x98)][_0x1e2c3d(0xad)],_0x2334d4[_0x1e2c3d(0xb2)](0x191,_0x1e4428[_0x1e2c3d(0xa5)]));if(_0x5f791d[_0x1e2c3d(0x99)]!==_0x2334d4['session'][_0x1e2c3d(0xad)][_0x1e2c3d(0x99)])_0x2334d4['session'][_0x1e2c3d(0xad)][_0x1e2c3d(0x99)]=_0x5f791d[_0x1e2c3d(0x99)];await _0x579cbb();},admin=async(_0x1326ed,_0x90bc5a)=>{const _0x46aa87=_0x39a7ad,_0x596179={'BMVsS':function(_0x347a8a,_0x4dac50){return _0x347a8a(_0x4dac50);},'fFnuC':_0x46aa87(0x97)};if(_0x1326ed[_0x46aa87(0x98)][_0x46aa87(0xad)]&&_0x596179[_0x46aa87(0xa0)](isAdmin,_0x1326ed['session'][_0x46aa87(0xad)]))return _0x90bc5a();else _0x1326ed[_0x46aa87(0xb2)](0x193,_0x596179[_0x46aa87(0xa9)]);},root=async(_0x4d89f3,_0x19b1a7)=>{const _0xba1635=_0x39a7ad,_0x10bf5d={'FBIxx':_0xba1635(0x97)};if(_0x4d89f3['session'][_0xba1635(0xad)]&&isRoot(_0x4d89f3[_0xba1635(0x98)]['profile']))return _0x19b1a7();else _0x4d89f3[_0xba1635(0xb2)](0x193,_0x10bf5d[_0xba1635(0x96)]);},handler=async function(_0x58e441){const _0x3e2a6f=_0x39a7ad;_0x58e441[_0x3e2a6f(0xa1)]=0x1ad,_0x58e441[_0x3e2a6f(0xa4)]={'error':'请求次数过高，请过一会重试'},this['options']&&this[_0x3e2a6f(0x9e)][_0x3e2a6f(0x9b)]&&_0x58e441[_0x3e2a6f(0xb7)](_0x3e2a6f(0x9c),Math['ceil'](this[_0x3e2a6f(0x9e)][_0x3e2a6f(0xb6)]/0x3e8));},solutionCreateRateLimit=RateLimit[_0x39a7ad(0xaa)]({'interval':{'min':0x1},'max':0x3c,async 'keyGenerator'(_0x19399a){const _0x192cf7=_0x39a7ad,_0x2f4c5f=_0x19399a[_0x192cf7(0x9f)][_0x192cf7(0xa4)];return _0x192cf7(0xac)+_0x2f4c5f[_0x192cf7(0x94)]+'|\x20'+_0x19399a[_0x192cf7(0x9f)]['ip']+'\x20';},'handler':handler}),userCreateRateLimit=RateLimit[_0x39a7ad(0xaa)]({'interval':{'min':0x1},'max':0x1e,'prefixKey':_0x39a7ad(0x95),'handler':handler});module[_0x39a7ad(0xb4)]={'solutionCreateRateLimit':solutionCreateRateLimit,'userCreateRateLimit':userCreateRateLimit,'auth':{'login':login,'admin':admin,'root':root}};