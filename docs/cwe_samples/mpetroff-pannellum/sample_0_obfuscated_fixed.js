const _0xffc13b=_0x11f7;(function(_0x37fe72,_0xf27095){const _0x22b454=_0x11f7,_0x13ba66=_0x37fe72();while(!![]){try{const _0x55781e=-parseInt(_0x22b454(0x22e))/0x1*(-parseInt(_0x22b454(0x222))/0x2)+-parseInt(_0x22b454(0x239))/0x3*(parseInt(_0x22b454(0x21a))/0x4)+parseInt(_0x22b454(0x24b))/0x5*(-parseInt(_0x22b454(0x244))/0x6)+-parseInt(_0x22b454(0x20e))/0x7+parseInt(_0x22b454(0x23e))/0x8+-parseInt(_0x22b454(0x21f))/0x9*(-parseInt(_0x22b454(0x238))/0xa)+parseInt(_0x22b454(0x200))/0xb;if(_0x55781e===_0xf27095)break;else _0x13ba66['push'](_0x13ba66['shift']());}catch(_0x84e346){_0x13ba66['push'](_0x13ba66['shift']());}}}(_0x92c0,0x3acf7));function _0x11f7(_0x31fb1e,_0x26dcc3){const _0x92c0e7=_0x92c0();return _0x11f7=function(_0x11f7c3,_0x25e5b1){_0x11f7c3=_0x11f7c3-0x1ee;let _0x3bca7b=_0x92c0e7[_0x11f7c3];return _0x3bca7b;},_0x11f7(_0x31fb1e,_0x26dcc3);}const fs=require('fs'),path=require(_0xffc13b(0x23c)),{v4}=require(_0xffc13b(0x1ef)),defaultWhisper=_0xffc13b(0x208),fileSize={'Xenova/whisper-small':_0xffc13b(0x24f),'Xenova/whisper-large':'1.56GB'};class LocalWhisper{constructor({options:_0xdd4e73}){const _0x55a38a=_0xffc13b,_0x50be98={'SZJQk':_0x55a38a(0x20d)},_0x59c6d2=_0x55a38a(0x201)['split']('|');let _0x4234ab=0x0;while(!![]){switch(_0x59c6d2[_0x4234ab++]){case'0':this.#log(_0x50be98[_0x55a38a(0x232)]);continue;case'1':this['model']=_0xdd4e73?.['WhisperModelPref']??defaultWhisper;continue;case'2':this[_0x55a38a(0x240)]=fileSize[this[_0x55a38a(0x231)]];continue;case'3':this[_0x55a38a(0x22f)]=path[_0x55a38a(0x1f7)](process['env'][_0x55a38a(0x23b)]?path[_0x55a38a(0x1f7)](process[_0x55a38a(0x237)]['STORAGE_DIR'],'models'):path['resolve'](__dirname,'../../../server/storage/models'));continue;case'4':if(!fs['existsSync'](this['cacheDir']))fs[_0x55a38a(0x20b)](this['cacheDir'],{'recursive':!![]});continue;case'5':this['modelPath']=path['resolve'](this['cacheDir'],...this[_0x55a38a(0x231)][_0x55a38a(0x223)]('/'));continue;}break;}}#log(_0x49085e,..._0x72134e){const _0x277ac3=_0xffc13b;console[_0x277ac3(0x249)](_0x277ac3(0x217)+_0x49085e,..._0x72134e);}#validateAudioFile(_0x1e958f){const _0x38011e=_0xffc13b,_0x3bbf14={'fAcue':_0x38011e(0x215),'ombQK':function(_0x5e3a0b,_0x1c60af){return _0x5e3a0b*_0x1c60af;},'CkZbo':function(_0x1dcc9b,_0x11db36){return _0x1dcc9b>_0x11db36;},'RQDVl':_0x38011e(0x210),'bqzQg':_0x38011e(0x22c)},_0x3133d4=_0x1e958f[_0x38011e(0x1fc)][_0x38011e(0x24c)],_0x321747=_0x1e958f['data']['samples']/_0x3133d4;if(_0x3133d4<0xfa0)throw new Error(_0x3bbf14[_0x38011e(0x1f0)]);const _0x2096fa=_0x3bbf14[_0x38011e(0x207)](_0x3bbf14[_0x38011e(0x207)](0x4,0x3c),0x3c);if(_0x3bbf14[_0x38011e(0x206)](_0x321747,_0x2096fa))throw new Error(_0x3bbf14[_0x38011e(0x256)]);const _0x4c239e=0x3e80,_0x566a0a=_0x321747*_0x4c239e,_0x1bd445=0xdbba000;if(_0x3bbf14[_0x38011e(0x206)](_0x566a0a,_0x1bd445))throw new Error(_0x3bbf14[_0x38011e(0x241)]);return!![];}async #convertToWavAudioData(_0x1c72d2){const _0x4dfec2=_0xffc13b,_0x4dec91={'WPlft':function(_0x14efde,_0x1a2029){return _0x14efde(_0x1a2029);},'SpKDt':function(_0x18dbcf,_0x5d0174){return _0x18dbcf!==_0x5d0174;},'QgaVe':_0x4dfec2(0x23f),'SwFrd':_0x4dfec2(0x21d),'BtjaY':'error','Muxrd':function(_0x58a094,_0x2f52d1){return _0x58a094/_0x2f52d1;},'RxOsu':function(_0x23cfcd,_0x51372){return _0x23cfcd*_0x51372;},'cvGVf':function(_0x8864d3,_0xb073a9){return _0x8864d3+_0xb073a9;},'sCPcs':_0x4dfec2(0x216),'YQcXu':function(_0x4b499e){return _0x4b499e();},'OirWG':_0x4dfec2(0x1f9),'BOaiD':function(_0x486e55,_0x273529){return _0x486e55!==_0x273529;},'abDdW':_0x4dfec2(0x234),'DJOHR':_0x4dfec2(0x203),'nclIL':function(_0x49cdef,_0x42b41c){return _0x49cdef>_0x42b41c;},'fLxqD':function(_0x33eb70,_0x5cca8f){return _0x33eb70<_0x5cca8f;},'mqNTP':function(_0xbac5cb,_0x38355d){return _0xbac5cb/_0x38355d;}};try{let _0x109a0a;const _0x4a2039=require(_0x4dec91['sCPcs']),_0x467de7=_0x4dec91[_0x4dfec2(0x247)](require,'fluent-ffmpeg'),_0x594ec8=path[_0x4dfec2(0x1f7)](__dirname,_0x4dfec2(0x20f));if(!fs[_0x4dfec2(0x245)](_0x594ec8))fs[_0x4dfec2(0x20b)](_0x594ec8,{'recursive':!![]});const _0x4f14f8=path[_0x4dfec2(0x1f8)](_0x1c72d2)[_0x4dfec2(0x255)]();if(_0x4dec91['SpKDt'](_0x4f14f8,_0x4dfec2(0x228))){this.#log(_0x4dfec2(0x202)+_0x4f14f8+'\x20file\x20detected\x20-\x20converting\x20to\x20.wav');const _0xabe1ab=path[_0x4dfec2(0x1f7)](_0x594ec8,_0x4dec91['YQcXu'](v4)+_0x4dfec2(0x228)),_0x52d75f=new Promise(_0x57a6df=>{const _0x3740f4=_0x4dfec2,_0x4759dc={'MrtME':function(_0xb76ddb,_0x20ffe8){const _0x3ddbde=_0x11f7;return _0x4dec91[_0x3ddbde(0x247)](_0xb76ddb,_0x20ffe8);}};_0x4dec91['SpKDt'](_0x3740f4(0x23f),_0x4dec91[_0x3740f4(0x246)])?_0x46c64e[_0x3740f4(0x249)]('\x1b[32m[LocalWhisper]\x1b[0m\x20'+_0x1a1fa9,..._0x1ecfdf):_0x467de7(_0x1c72d2)[_0x3740f4(0x21e)](_0x4dec91[_0x3740f4(0x224)])['on'](_0x4dec91['BtjaY'],_0x51cd2f=>{const _0x3d9fb4=_0x3740f4;this.#log(_0x3d9fb4(0x209)+_0x51cd2f[_0x3d9fb4(0x204)]),_0x57a6df(![]);})['on'](_0x3740f4(0x23d),_0x27ef5b=>this.#log(_0x3740f4(0x1f5)+_0x27ef5b['targetSize']+_0x3740f4(0x23a)))['on'](_0x3740f4(0x20a),()=>{const _0x45d3a9=_0x3740f4;this.#log(_0x45d3a9(0x1ff)),_0x4759dc[_0x45d3a9(0x225)](_0x57a6df,!![]);})[_0x3740f4(0x252)](_0xabe1ab);}),_0x5240f9=await _0x52d75f;if(!_0x5240f9)throw new Error(_0x4dec91[_0x4dfec2(0x1ee)]);const _0x2c2dd3=[],_0x1cfff1=fs[_0x4dfec2(0x218)](_0xabe1ab);for await(let _0x555d90 of _0x1cfff1)_0x2c2dd3[_0x4dfec2(0x214)](_0x555d90);_0x109a0a=Buffer[_0x4dfec2(0x1f6)](_0x2c2dd3),fs[_0x4dfec2(0x1f1)](_0xabe1ab);}else{const _0x5b7d61=[],_0x5d1597=fs[_0x4dfec2(0x218)](_0x1c72d2);for await(let _0x56f130 of _0x5d1597)_0x5b7d61[_0x4dfec2(0x214)](_0x56f130);_0x109a0a=Buffer['concat'](_0x5b7d61);}const _0x24a855=new _0x4a2039[(_0x4dfec2(0x21c))](_0x109a0a);try{_0x4dec91[_0x4dfec2(0x227)](_0x4dfec2(0x213),_0x4dec91[_0x4dfec2(0x220)])?this.#validateAudioFile(_0x24a855):_0x17a8af[0x0][_0x27f511]=_0x4dec91[_0x4dfec2(0x248)](_0x4dec91[_0x4dfec2(0x230)](_0x307fe2,_0x4dec91[_0x4dfec2(0x229)](_0x1a9a7b[0x0][_0x543bfc],_0x594a41[0x1][_0x176bfa])),0x2);}catch(_0x2faa88){this.#log(_0x4dfec2(0x1fd)+_0x2faa88[_0x4dfec2(0x204)]);throw new Error(_0x4dfec2(0x233)+_0x2faa88['message']);}_0x24a855[_0x4dfec2(0x1fe)](_0x4dec91[_0x4dfec2(0x251)]),_0x24a855[_0x4dfec2(0x1fb)](0x3e80);let _0x4ce114=_0x24a855[_0x4dfec2(0x212)]();if(Array[_0x4dfec2(0x236)](_0x4ce114)){if(_0x4dec91[_0x4dfec2(0x235)](_0x4ce114['length'],0x1)){const _0x5af943=Math[_0x4dfec2(0x21b)](0x2);for(let _0x2572e9=0x0;_0x4dec91['fLxqD'](_0x2572e9,_0x4ce114[0x0]['length']);++_0x2572e9){_0x4ce114[0x0][_0x2572e9]=_0x4dec91[_0x4dfec2(0x20c)](_0x4dec91['RxOsu'](_0x5af943,_0x4ce114[0x0][_0x2572e9]+_0x4ce114[0x1][_0x2572e9]),0x2);}}_0x4ce114=_0x4ce114[0x0];}return _0x4ce114;}catch(_0x3476fe){return console[_0x4dfec2(0x242)](_0x4dfec2(0x243),_0x3476fe),null;}}async[_0xffc13b(0x253)](){const _0x257bdc=_0xffc13b,_0x564a7b={'whjcM':_0x257bdc(0x23d),'vjXDy':_0x257bdc(0x1f2),'keuRt':_0x257bdc(0x1f3)};!fs[_0x257bdc(0x245)](this[_0x257bdc(0x22d)])&&this.#log('The\x20native\x20whisper\x20model\x20has\x20never\x20been\x20run\x20and\x20will\x20be\x20downloaded\x20right\x20now.\x20Subsequent\x20runs\x20will\x20be\x20faster.\x20(~'+this[_0x257bdc(0x240)]+')');try{const _0xb0bdc4=(..._0x221d65)=>import(_0x257bdc(0x219))[_0x257bdc(0x22a)](({pipeline:_0x2ce53a})=>_0x2ce53a(..._0x221d65));return await _0xb0bdc4(_0x564a7b['vjXDy'],this[_0x257bdc(0x231)],{'cache_dir':this[_0x257bdc(0x22f)],...!fs[_0x257bdc(0x245)](this[_0x257bdc(0x22d)])?{'progress_callback':_0xc3153=>{const _0x43f9b0=_0x257bdc;if(!_0xc3153['hasOwnProperty'](_0x564a7b['whjcM']))return;console[_0x43f9b0(0x249)]('\x1b[34m[Embedding\x20-\x20Downloading\x20Model\x20Files]\x1b[0m\x20'+_0xc3153['file']+'\x20'+~~_0xc3153?.[_0x43f9b0(0x23d)]+'%');}}:{}});}catch(_0x7f975){this.#log(_0x564a7b[_0x257bdc(0x1f4)],_0x7f975);throw _0x7f975;}}async[_0xffc13b(0x221)](_0x53eb96,_0x49cfa4){const _0x5419eb=_0xffc13b,_0x4efd13={'IuvOI':function(_0x5a0ed6,_0x2e36d1){return _0x5a0ed6*_0x2e36d1;},'Nsipo':function(_0x1dfa39,_0x5d4a51){return _0x1dfa39>_0x5d4a51;},'pnCFM':_0x5419eb(0x210),'MqPjR':function(_0x12be44,_0x59d3d8,_0x41a570){return _0x12be44(_0x59d3d8,_0x41a570);},'aehPP':function(_0x585d26,_0x5a2cfd){return _0x585d26!==_0x5a2cfd;},'KAhVC':_0x5419eb(0x22b)};try{const _0x50fd59=new Promise(_0x2013ca=>this[_0x5419eb(0x253)]()[_0x5419eb(0x22a)](_0x550121=>_0x2013ca(_0x550121))),_0x1d7584=new Promise(_0x54cd52=>this.#convertToWavAudioData(_0x53eb96)[_0x5419eb(0x22a)](_0xecdc64=>_0x54cd52(_0xecdc64))),[_0x196da7,_0xd57ee7]=await Promise['all']([_0x1d7584,_0x50fd59]);if(!_0x196da7)return this.#log('Failed\x20to\x20parse\x20content\x20from\x20'+_0x49cfa4+'.'),{'content':null,'error':_0x5419eb(0x24d)+_0x49cfa4+'.'};this.#log(_0x5419eb(0x226));const {text:_0x49122c}=await _0x4efd13[_0x5419eb(0x1fa)](_0xd57ee7,_0x196da7,{'chunk_length_s':0x1e,'stride_length_s':0x5});return{'content':_0x49122c,'error':null};}catch(_0x2bbb25){if(_0x4efd13[_0x5419eb(0x254)](_0x4efd13['KAhVC'],_0x5419eb(0x205)))return{'content':null,'error':_0x2bbb25[_0x5419eb(0x204)]};else{const _0x3580b6=_0x3d343b[_0x5419eb(0x1fc)][_0x5419eb(0x24c)],_0x8b066b=_0x272506[_0x5419eb(0x211)]['samples']/_0x3580b6;if(_0x3580b6<0xfa0)throw new _0x72311f(_0x5419eb(0x215));const _0x4719ce=_0x4efd13[_0x5419eb(0x250)](_0x4efd13['IuvOI'](0x4,0x3c),0x3c);if(_0x4efd13[_0x5419eb(0x24e)](_0x8b066b,_0x4719ce))throw new _0x56af91(_0x4efd13['pnCFM']);const _0xac6eb3=0x3e80,_0x98ac49=_0x8b066b*_0xac6eb3,_0x43e792=0xdbba000;if(_0x4efd13[_0x5419eb(0x24e)](_0x98ac49,_0x43e792))throw new _0x2e1e5b(_0x5419eb(0x22c));return!![];}}}}module[_0xffc13b(0x24a)]={'LocalWhisper':LocalWhisper};function _0x92c0(){const _0x37073e=['KB\x20converted','STORAGE_DIR','path','progress','2495384olwOCW','divLY','fileSize','bqzQg','error','convertToWavAudioData','8274FWBXwq','existsSync','QgaVe','WPlft','Muxrd','log','exports','920FcPUYA','sampleRate','Failed\x20to\x20parse\x20content\x20from\x20','Nsipo','250mb','IuvOI','DJOHR','save','client','aehPP','toLowerCase','RQDVl','OirWG','uuid','fAcue','rmSync','automatic-speech-recognition','Failed\x20to\x20load\x20the\x20native\x20whisper\x20model:','keuRt','Conversion\x20Processing!\x20','concat','resolve','extname','[Conversion\x20Failed]:\x20Could\x20not\x20convert\x20file\x20to\x20.wav\x20format!','MqPjR','toSampleRate','fmt','Audio\x20validation\x20failed:\x20','toBitDepth','Conversion\x20Complete!\x20File\x20converted\x20to\x20.wav!','1539153SvUgOk','1|2|3|5|4|0','File\x20conversion\x20required!\x20','32f','message','lAkMw','CkZbo','ombQK','Xenova/whisper-small','Conversion\x20Error!\x20','end','mkdirSync','mqNTP','Initialized.','3067778vVSdSC','../../storage/tmp','Audio\x20file\x20duration\x20exceeds\x20maximum\x20limit\x20of\x204\x20hours.','data','getSamples','yOxlS','push','Audio\x20file\x20sample\x20rate\x20is\x20too\x20low\x20for\x20accurate\x20transcription.\x20Minimum\x20required\x20is\x204kHz.','wavefile','\x1b[32m[LocalWhisper]\x1b[0m\x20','createReadStream','@xenova/transformers','658156vHcSGy','sqrt','WaveFile','wav','toFormat','9qbCfEK','abDdW','processFile','2QBSyEO','split','SwFrd','MrtME','Transcribing\x20audio\x20data\x20to\x20text...','BOaiD','.wav','cvGVf','then','wpfVQ','Audio\x20file\x20exceeds\x20maximum\x20allowed\x20length.','modelPath','209489NcrKcZ','cacheDir','RxOsu','model','SZJQk','Invalid\x20audio\x20file:\x20','SDMbA','nclIL','isArray','env','4360810RdneVb','3kjlfiN'];_0x92c0=function(){return _0x37073e;};return _0x92c0();}