'use strict';const _0x5a83ac=_0x1b52;(function(_0x367db7,_0x10cec7){const _0x56b074=_0x1b52,_0x53c645=_0x367db7();while(!![]){try{const _0x51da44=parseInt(_0x56b074(0x256))/0x1*(parseInt(_0x56b074(0x143))/0x2)+parseInt(_0x56b074(0x19e))/0x3*(-parseInt(_0x56b074(0x26a))/0x4)+parseInt(_0x56b074(0xf6))/0x5*(parseInt(_0x56b074(0x217))/0x6)+parseInt(_0x56b074(0x13d))/0x7+parseInt(_0x56b074(0x19c))/0x8*(parseInt(_0x56b074(0x243))/0x9)+parseInt(_0x56b074(0x15b))/0xa+parseInt(_0x56b074(0x1cf))/0xb*(-parseInt(_0x56b074(0x220))/0xc);if(_0x51da44===_0x10cec7)break;else _0x53c645['push'](_0x53c645['shift']());}catch(_0x2495a5){_0x53c645['push'](_0x53c645['shift']());}}}(_0x1fc5,0x29332));function _0x1fc5(){const _0x498aa1=['\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded(contains:\x20\x22Hello\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','vggFJ','context','1873928aMWRkx','KplRi','ALaOc','address','zxwkp','DZtpC','104514ExhASd','FFxlk','\x0a\x20\x20\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20\x20\x20message:\x20String\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Mutation\x20{\x0a\x20\x20\x20\x20\x20\x20addNotification(message:\x20String):\x20Notification\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20\x20\x20notificationAdded:\x20Notification\x0a\x20\x20\x20\x20}\x0a\x20\x20','lQAMZ','cMiKy','subscription\x20works\x20with\x20`withFilter`\x20tool','dUcVh','RZurv','reply','syKLD','JVYCK','lyWkA','XIwUp','gbwVz','kmYuC','GHwHS','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notifications\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','zsofA','inject','AkFVk','fRSay','lbRQc','TqXpL','ZXNSk','3030410ZHtAjA','eoQeT','FNEJG','vjvQp','kwKWM','tickAsync','wDNZZ','ZKGrX','MJQbQ','data','oOVvF','RryfM','message','@fastify/websocket','mqemitter','NhjYX','subscribe','sESyy','ZdJFq','KBTJr','sgyrV','events','ETsQe','connectionInit','uPCkk','czqyz','hi\x20from\x20server','bYwWO','ZMXak','/graphql','equal','bjwgq','KmkOO','dbYYP','pttOi','jCaDg','LbQgo','AEDBo','graphql-ws','includes','notificationAdded','oNfRH','znqGk','JBxSX','antqz','ATggd','GoPbt','iBVBK','Notification\x20message','NrbXm','iKsLZ','xwQUq','subscription\x20context\x20is\x20extended\x20with\x20onConnect\x20return\x20value\x20if\x20connectionInit\x20extension\x20is\x20defined\x20in\x20gql_start\x20message','hNKHT','ZnPzv','kGDxy','connection_init','tEiWo','LmQld','ThhSa','WVFlz','UQAIt','RVwWG','server','NQrcr','634184RJxhqJ','type','97221mcFCFw','payload','PVafF','aHjAB','vagJb','wrong\x20messages\x20do\x20not\x20crash\x20the\x20server','lAnpu','DXYZb','decorateRequest','cpYEI','skjaP','fdeif','GClin','ImYLl','LQbLu','\x0a\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20message:\x20String\x0a\x20\x20}\x0a\x0a\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20}\x0a\x0a\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20notificationAdded:\x20Notification\x0a\x20\x20}\x0a','lzgsi','BhAMH','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mutation\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20addNotification(message:\x20\x22Hello\x20World\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','DKUAU','subscription\x20server\x20sends\x20update\x20to\x20subscriptions','foo','Zqwvk','jrujB','NOTIFICATION_ADDED','ZAbiN','Bhsid','custom\x20execution\x20error','XsLGh','subscription\x20server\x20exposes\x20pubsub','BFxQn','EwsUS','\x0a\x20\x20\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20\x20\x20message:\x20String\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20\x20\x20notificationAdded:\x20Notification\x0a\x20\x20\x20\x20}\x0a\x20\x20','0|1|2|3|4','fjhAH','ypFLp','publish','oZCBd','CjOgJ','pass','tgljX','__proto__','neGyS','register','bDbYI','utf8','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mutation\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20addNotification(message:\x20\x22Hello\x20World\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','xDqxH','@sinonjs/fake-timers','40909QHCoqM','PIqzX','UCfIt','admyP','foobar','complete','setEncoding','RkUzz','ZwBhy','xBNbZ','POST','filtered','YhxDW','irvoc','`withFilter`\x20tool\x20works\x20with\x20async\x20filters','PiDEL','NvmqG','lDGit','ZcWHQ','nwuki','open','\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20add(x:\x20Int,\x20y:\x20Int):\x20Int\x0a\x20\x20\x20\x20}\x0a\x20\x20','XCYtj','guixf','HxSTj','fXZue','PGsCP','HYHTT','dOfRv','gzAgf','QHYsW','fLIDp','close','FUIgO','NwTTY','subscription\x20passes\x20context\x20to\x20its\x20loaders','Hello\x20World','lJDWU','push','CfzAC','eGKIC','pubsub','teardown','subscription\x20server\x20sends\x20correct\x20error\x20if\x20execution\x20throws','emit','test','createWebSocketStream','GHixn','DwxcX','mrAtb','posIw','pNnbG','fKCpu','mqLKE','SkPbE','OwhyV','AuILK','RwSfo','xmpsv','request','GkzGK','McJrw','subscription\x20works\x20properly\x20if\x20onConnect\x20is\x20not\x20defined\x20and\x20connectionInit\x20extension\x20is\x20defined\x20in\x20gql_start\x20message','start','MWhVR','MeGSe','RmzxG','qrjtX','ZHaoi','get','BVGgB','request\x20and\x20reply\x20objects\x20in\x20subscription\x20context','6jkNbzK','WUEEa','YtDJb','bENtP','subscription\x20server\x20replies\x20with\x20connection_ack','DdZTX','cbpuD','LYQPr','BkOoc','3468HKsWOp','parse','EeRbh','YhwKQ','YIqbH','OwBfU','stop','BguuS','HRmTS','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','tCMXF','connection_ack','AmwKf','HMrCs','vKWTs','xKABr','cPPjb','JdiBc','constructor','xCVzh','xrTCr','nrXNr','zLBgU','bind','Yiovj','LnolF','error','BYrzd','FNIbZ','oLqlz','VTGws','JctHx','BmPbm','jQAFs','faTtD','18ouJFVB','yBCgG','biQuu','lBvGq','ikoJO','Hello\x20World\x20foobar','CgRHM','KhYSF','plan','VXqVa','DAiaT','MGMsI','qtcSq','ws://localhost:','Bearer\x20foobar','subscription\x20server\x20sends\x20update\x20to\x20subscriptions\x20with\x20custom\x20async\x20context','GnWZu','FAIyx','request\x20and\x20reply\x20objects\x20in\x20subscription\x20context\x20-\x20no\x20headers\x20wrapper','5UTDYEK','ovUKu','fail','SOcAs','KhftY','qAOXP','end','EeKIG','xaAcu','world','bbb','bZLmj','vVXFi','iOzKB','SCcOm','port','YZpKU','GyBhN','send','socket','4aOMPoc','kaboom','ohiOd','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20','destroy','MUGmn','jvLIX','clock','POepy','FcywN','KbJJl','context\x20is\x20not\x20missing','RwlaP','1426880vrYMcy','yVkwA','QyHTf','WEGlu','dkjBQ','qUBDk','bar','vkbPa','emitter','MDxKt','topic','zExjg','write','ymVAf','UIsic','headers','dsefu','oFBVs','NuzXv','fastify','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mutation\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20addNotification(message:\x20\x22filtered\x20should\x20not\x20pass\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20','kZhLG','gFZoW','xGGPP','jZapX','mYrqU','CEAAg','bjpCl','qqlyK','jcYaj','AneAn','\x0a\x20\x20\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20\x20\x20message:\x20String\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Mutation\x20{\x0a\x20\x20\x20\x20\x20\x20addNotification(message:\x20String!):\x20Notification!\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20\x20\x20notificationAdded(contains:\x20String):\x20Notification\x0a\x20\x20\x20\x20}\x0a\x20\x20','YhhGV','from','JNXPc','removeListener','tzTol','ghOri','iQKKS','knPOT','LcyxU','subscription\x20handles\x20`withFilter`\x20if\x20filter\x20throws','listen','bLhgQ','unAWe','pkyGv','aaxUd','EYGqX','KMTwD','CgygD','LNreh','SBCtk','jbXVL','XwOSR','uninstall','nYglV','subscription\x20server\x20replies\x20with\x20keep\x20alive\x20when\x20enabled','subscription\x20socket\x20protocol\x20different\x20than\x20graphql-ws,\x20protocol\x20=\x20foobar','uWwBh','IcYfK','RNPii','BYZoe','cQiBc','xpNbf','gfxUY','pRtHk','map','stringify'];_0x1fc5=function(){return _0x498aa1;};return _0x1fc5();}const {test,t}=require('tap'),Fastify=require(_0x5a83ac(0x109)),WebSocket=require('ws'),mq=require(_0x5a83ac(0x169)),{EventEmitter}=require(_0x5a83ac(0x170)),fastifyWebsocket=require(_0x5a83ac(0x168)),GQL=require('..'),{once}=require('events'),FakeTimers=require(_0x5a83ac(0x1ce));function _0x1b52(_0x4d0b9c,_0x1fff4d){const _0x1fc57f=_0x1fc5();return _0x1b52=function(_0x1b521b,_0x41754d){_0x1b521b=_0x1b521b-0xf5;let _0x1e908b=_0x1fc57f[_0x1b521b];return _0x1e908b;},_0x1b52(_0x4d0b9c,_0x1fff4d);}t['beforeEach'](({context:_0x318ced})=>{const _0x39521e=_0x5a83ac;_0x318ced[_0x39521e(0x271)]=FakeTimers['install']({'shouldClearNativeTimers':!![],'shouldAdvanceTime':!![],'advanceTimeDelta':0x28});}),t['afterEach'](({context:_0x125ecc})=>{const _0x5bf284=_0x5a83ac;_0x125ecc[_0x5bf284(0x271)][_0x5bf284(0x12c)]();}),test(_0x5a83ac(0x21b),_0x199cd0=>{const _0x4e0476=_0x5a83ac,_0x11e081={'iOzKB':function(_0x1f8f6c,_0x3b62a6){return _0x1f8f6c===_0x3b62a6;},'DAiaT':'DIrxN','LQbLu':_0x4e0476(0x135),'BkOoc':'ws://localhost:','PiDEL':_0x4e0476(0x1cb),'ikoJO':'connection_init','zsofA':function(_0x38292c){return _0x38292c();}},_0x4eb9c7=_0x11e081[_0x4e0476(0x154)](Fastify);_0x199cd0[_0x4e0476(0x1f9)](()=>_0x4eb9c7[_0x4e0476(0x1ef)]());const _0x50aae3=_0x4e0476(0x1e4),_0x1a346a={'Query':{'add':(_0x5c06d3,{x:_0x12d1ae,y:_0xf3d523})=>_0x12d1ae+_0xf3d523}};_0x4eb9c7[_0x4e0476(0x1c9)](GQL,{'schema':_0x50aae3,'resolvers':_0x1a346a,'subscription':!![]}),_0x4eb9c7[_0x4e0476(0x120)]({'port':0x0},_0x5b3929=>{const _0x264d3c=_0x4e0476,_0x18186b={'MWhVR':_0x264d3c(0x22b)};if(_0x11e081[_0x264d3c(0x263)](_0x11e081[_0x264d3c(0x24d)],_0x11e081[_0x264d3c(0x1ac)]))_0x476cc2['ok'](!_0x5aca0a[_0x264d3c(0x19f)][_0x264d3c(0x164)][_0x264d3c(0x183)][_0x264d3c(0x167)][_0x264d3c(0x182)](_0x264d3c(0x1da))),_0x4adef4[_0x264d3c(0x25c)]();else{_0x199cd0[_0x264d3c(0x23a)](_0x5b3929);const _0x5bcf62=_0x11e081[_0x264d3c(0x21f)]+_0x4eb9c7[_0x264d3c(0x19a)][_0x264d3c(0x140)]()[_0x264d3c(0x265)]+_0x264d3c(0x178),_0xb6d8ae=new WebSocket(_0x5bcf62,_0x264d3c(0x181)),_0x2eac7c=WebSocket['createWebSocketStream'](_0xb6d8ae,{'encoding':_0x11e081[_0x264d3c(0x1de)],'objectMode':!![]});_0x199cd0[_0x264d3c(0x1f9)](_0x2eac7c[_0x264d3c(0x26e)][_0x264d3c(0x237)](_0x2eac7c)),_0x2eac7c[_0x264d3c(0x1d5)](_0x11e081['PiDEL']),_0x2eac7c['write'](JSON['stringify']({'type':_0x11e081[_0x264d3c(0x247)]})),_0x2eac7c['on'](_0x264d3c(0x164),_0xca98e6=>{const _0x55abe2=_0x264d3c;_0x199cd0['equal'](_0xca98e6,JSON[_0x55abe2(0x139)]({'type':_0x18186b[_0x55abe2(0x20f)]})),_0x2eac7c[_0x55abe2(0x25c)](),_0x199cd0[_0x55abe2(0x25c)]();});}});}),test(_0x5a83ac(0x12e),_0x45df5a=>{const _0xbfef68=_0x5a83ac,_0x99825c={'pNnbG':function(_0x3b5e3d,_0x53a369){return _0x3b5e3d+_0x53a369;},'SCcOm':_0xbfef68(0x178),'NLSVL':_0xbfef68(0x181),'YIqbH':'utf8','MUGmn':_0xbfef68(0x193)},_0x1d8f71=Fastify();_0x45df5a[_0xbfef68(0x1f9)](()=>_0x1d8f71['close']());const _0x1eef6e=_0xbfef68(0x1e4),_0x3add66={'Query':{'add':(_0x57ac03,{x:_0x3dd6a9,y:_0x2c00ef})=>_0x3dd6a9+_0x2c00ef}};_0x1d8f71['register'](GQL,{'schema':_0x1eef6e,'resolvers':_0x3add66,'subscription':{'keepAlive':0x2710}}),_0x1d8f71[_0xbfef68(0x120)]({'port':0x0},_0x5574bf=>{const _0x34f657=_0xbfef68,_0x211dc5={'TqXpL':_0x34f657(0x22b)};_0x45df5a[_0x34f657(0x23a)](_0x5574bf);const _0x28e4e2=_0x99825c[_0x34f657(0x202)](_0x99825c[_0x34f657(0x202)](_0x34f657(0x250),_0x1d8f71['server']['address']()['port']),_0x99825c[_0x34f657(0x264)]),_0x581a7b=new WebSocket(_0x28e4e2,_0x99825c['NLSVL']),_0x1003af=WebSocket[_0x34f657(0x1fd)](_0x581a7b,{'encoding':_0x99825c[_0x34f657(0x224)],'objectMode':!![]});_0x45df5a['teardown'](_0x1003af[_0x34f657(0x26e)][_0x34f657(0x237)](_0x1003af)),_0x1003af[_0x34f657(0x1d5)](_0x34f657(0x1cb)),_0x1003af[_0x34f657(0x102)](JSON[_0x34f657(0x139)]({'type':_0x99825c[_0x34f657(0x26f)]})),_0x1003af['on']('data',_0x2dac92=>{const _0x2234e0=_0x34f657,_0x5d426f=JSON['parse'](_0x2dac92);if(_0x5d426f[_0x2234e0(0x19d)]===_0x211dc5[_0x2234e0(0x159)])return;_0x45df5a['equal'](_0x5d426f['type'],'ka'),_0x1003af[_0x2234e0(0x25c)](),_0x45df5a['end']();});});}),test(_0x5a83ac(0x1b2),_0x223c70=>{const _0x483a96=_0x5a83ac,_0x47cb90={'kwKWM':function(_0x5a70d2,_0x2d8d0b){return _0x5a70d2===_0x2d8d0b;},'LmQld':'POST','XwOSR':_0x483a96(0x178),'PGsCP':function(_0x26779c,_0x27f1b6){return _0x26779c===_0x27f1b6;},'qqXTJ':function(_0x449493,_0x48970e){return _0x449493===_0x48970e;},'EbPSh':_0x483a96(0x1d4),'dbYYP':function(_0x2e5b7f){return _0x2e5b7f();},'kjnxB':_0x483a96(0x193),'ymVAf':_0x483a96(0x20e),'TfKDl':'data','dnynq':function(_0x1b85dd){return _0x1b85dd();},'YhhGV':_0x483a96(0x18b)},_0x14cdd3=Fastify();_0x223c70[_0x483a96(0x1f9)](()=>_0x14cdd3[_0x483a96(0x1ef)]());const _0x328f14=()=>{const _0x5d25a2=_0x483a96,_0x4a7667={'FAIyx':'/fastify-websocket','ERiKp':function(_0x36d9e5,_0x210a54){const _0x467748=_0x1b52;return _0x47cb90[_0x467748(0x15f)](_0x36d9e5,_0x210a54);},'JdiBc':'RmzxG'};_0x14cdd3[_0x5d25a2(0x155)]({'method':_0x47cb90[_0x5d25a2(0x195)],'url':_0x5d25a2(0x178),'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notifications\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{const _0x1e83a0=_0x5d25a2;if(_0x4a7667['ERiKp'](_0x4a7667[_0x1e83a0(0x231)],_0x1e83a0(0x211)))_0x222882();else{const _0x30b0ba={'oLqlz':_0x1e83a0(0x175),'qrjtX':_0x1e83a0(0x167)};_0x3278ce[_0x1e83a0(0x214)](_0x4a7667[_0x1e83a0(0x254)],{'websocket':!![]},(_0x219ee1,_0x2e6ab8)=>{const _0x2d57e8=_0x1e83a0;_0x219ee1[_0x2d57e8(0x269)]['on'](_0x30b0ba[_0x2d57e8(0x212)],_0x4facd7=>{const _0xe7563=_0x2d57e8;_0x219ee1['socket'][_0xe7563(0x268)](_0x30b0ba[_0xe7563(0x23d)]);});});}});},_0x222882=()=>{const _0x457c14=_0x483a96;_0x14cdd3['inject']({'method':_0x47cb90[_0x457c14(0x195)],'url':_0x47cb90[_0x457c14(0x12b)],'body':{'query':_0x457c14(0x1b0)}},()=>{});},_0x23f5d0=_0x47cb90['dnynq'](mq),_0x28fbe4=_0x483a96(0x145);let _0x54fc33=0x1;const _0x1d7da9=[{'id':_0x54fc33,'message':_0x47cb90[_0x483a96(0x116)]}],_0x22cb64={'Query':{'notifications':()=>_0x1d7da9},'Mutation':{'addNotification':async(_0x5ec41b,{message:_0x3fa2eb})=>{const _0x2e0932=_0x483a96,_0x4897d8=_0x54fc33++,_0x326192={'id':_0x4897d8,'message':_0x3fa2eb};return _0x1d7da9[_0x2e0932(0x1f5)](_0x326192),await _0x23f5d0['emit']({'topic':_0x2e0932(0x1b6),'payload':{'notificationAdded':_0x326192}}),_0x326192;}},'Subscription':{'notificationAdded':{'subscribe':(_0x23487a,_0x2a269d,_0x161bd5)=>{const _0x2d5359=_0x483a96;return _0x161bd5[_0x2d5359(0x1f8)][_0x2d5359(0x16b)](_0x2d5359(0x1b6));}}}};_0x14cdd3[_0x483a96(0x1c9)](GQL,{'schema':_0x28fbe4,'resolvers':_0x22cb64,'subscription':{'emitter':_0x23f5d0}}),_0x14cdd3[_0x483a96(0x120)]({'port':0x0},_0x10ae74=>{const _0x145db1=_0x483a96;_0x223c70['error'](_0x10ae74);const _0x20e4f0=new WebSocket(_0x145db1(0x250)+_0x14cdd3[_0x145db1(0x19a)][_0x145db1(0x140)]()[_0x145db1(0x265)]+_0x47cb90[_0x145db1(0x12b)],_0x145db1(0x181)),_0x3a2cc5=WebSocket[_0x145db1(0x1fd)](_0x20e4f0,{'encoding':'utf8','objectMode':!![]});_0x223c70[_0x145db1(0x1f9)](_0x3a2cc5[_0x145db1(0x26e)][_0x145db1(0x237)](_0x3a2cc5)),_0x3a2cc5[_0x145db1(0x1d5)](_0x145db1(0x1cb)),_0x3a2cc5[_0x145db1(0x102)](JSON[_0x145db1(0x139)]({'type':_0x47cb90['kjnxB']})),_0x3a2cc5[_0x145db1(0x102)](JSON[_0x145db1(0x139)]({'id':0x1,'type':_0x47cb90[_0x145db1(0x103)],'payload':{'query':_0x145db1(0x26d)}})),_0x3a2cc5[_0x145db1(0x102)](JSON[_0x145db1(0x139)]({'id':0x2,'type':_0x145db1(0x20e),'payload':{'query':_0x145db1(0x26d)}})),_0x3a2cc5[_0x145db1(0x102)](JSON[_0x145db1(0x139)]({'id':0x2,'type':_0x145db1(0x226)})),_0x3a2cc5['on'](_0x47cb90['TfKDl'],_0x12ef0a=>{const _0x3f0ef5=_0x145db1,_0x4f5f50=JSON[_0x3f0ef5(0x221)](_0x12ef0a);if(_0x4f5f50['id']===0x1&&_0x47cb90['kwKWM'](_0x4f5f50[_0x3f0ef5(0x19d)],_0x3f0ef5(0x164)))_0x223c70[_0x3f0ef5(0x179)](_0x12ef0a,JSON[_0x3f0ef5(0x139)]({'type':_0x3f0ef5(0x164),'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':'Hello\x20World'}}}})),_0x3a2cc5[_0x3f0ef5(0x25c)](),_0x223c70[_0x3f0ef5(0x25c)]();else _0x47cb90[_0x3f0ef5(0x1e9)](_0x4f5f50['id'],0x2)&&_0x47cb90['qqXTJ'](_0x4f5f50[_0x3f0ef5(0x19d)],_0x47cb90['EbPSh'])&&_0x47cb90[_0x3f0ef5(0x17c)](_0x328f14);});});});class CustomPubSub{constructor(){const _0x682ec0=_0x5a83ac;this[_0x682ec0(0xfe)]=new EventEmitter();}async[_0x5a83ac(0x16b)](_0x3e4ef4,_0x520747){const _0x288261=_0x5a83ac,_0x4988b8=_0x3136b4=>{const _0x2e69e2=_0x1b52;_0x520747[_0x2e69e2(0x1f5)](_0x3136b4);},_0x596b79=()=>{const _0x13bb23=_0x1b52;this[_0x13bb23(0xfe)][_0x13bb23(0x119)](_0x3e4ef4,_0x4988b8);};this[_0x288261(0xfe)]['on'](_0x3e4ef4,_0x4988b8),_0x520747['close']=_0x596b79;}[_0x5a83ac(0x1c2)](_0x377e75,_0x5e8af5){const _0x36c10a=_0x5a83ac;this[_0x36c10a(0xfe)][_0x36c10a(0x1fb)](_0x377e75[_0x36c10a(0x100)],_0x377e75['payload']),_0x5e8af5();}}test('subscription\x20with\x20custom\x20pubsub',_0x1f14ec=>{const _0x38d6e8=_0x5a83ac,_0x5ea8d1={'fXZue':function(_0x18f2bd,_0x3a5294){return _0x18f2bd===_0x3a5294;},'zExjg':'AYwHy','GHixn':function(_0x26f159,_0xd49ba){return _0x26f159+_0xd49ba;},'tCMXF':_0x38d6e8(0x250),'ZpEZq':'/graphql','MGMsI':_0x38d6e8(0x1cb),'rlHyV':_0x38d6e8(0x20e),'BoJLV':function(_0x2764ee){return _0x2764ee();}},_0x166eb6=_0x5ea8d1['BoJLV'](Fastify);_0x1f14ec[_0x38d6e8(0x1f9)](()=>_0x166eb6['close']());const _0x1130ba=new CustomPubSub(),_0x1e9262=()=>{const _0x441149=_0x38d6e8,_0xc46e06={'LYQPr':function(_0x3230fd){return _0x3230fd();}};_0x166eb6[_0x441149(0x155)]({'method':_0x441149(0x1d9),'url':_0x441149(0x178),'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notifications\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{const _0x14df8c=_0x441149;_0xc46e06[_0x14df8c(0x21e)](_0x361bba);});},_0x361bba=()=>{const _0x467670=_0x38d6e8;_0x166eb6['inject']({'method':'POST','url':'/graphql','body':{'query':_0x467670(0x1b0)}},()=>{});},_0x5c8f7d=_0x38d6e8(0x145);let _0x3bbb74=0x1;const _0x5faae9=[{'id':_0x3bbb74,'message':_0x38d6e8(0x18b)}],_0xbabd={'Query':{'notifications':()=>_0x5faae9},'Mutation':{'addNotification':async(_0x2a23c3,{message:_0x172c6c})=>{const _0x1c2c12=_0x38d6e8,_0x1bd8ee={'lzgsi':function(_0x15426c,_0x570968){return _0x15426c(_0x570968);}};if(_0x5ea8d1[_0x1c2c12(0x1e8)](_0x5ea8d1[_0x1c2c12(0x101)],_0x1c2c12(0x1e7)))throw _0x1bd8ee[_0x1c2c12(0x1ae)](_0x398b88,_0x1c2c12(0x1b9));else{const _0x345067=_0x3bbb74++,_0x5023cd={'id':_0x345067,'message':_0x172c6c};return _0x5faae9[_0x1c2c12(0x1f5)](_0x5023cd),await _0x1130ba['emitter'][_0x1c2c12(0x1fb)](_0x1c2c12(0x1b6),{'notificationAdded':_0x5023cd}),_0x5023cd;}}},'Subscription':{'notificationAdded':{'subscribe':(_0x2a2fd6,_0xeaac55,{pubsub:_0x38d7a4})=>_0x38d7a4['subscribe'](_0x38d6e8(0x1b6))}}};_0x166eb6[_0x38d6e8(0x1c9)](GQL,{'schema':_0x5c8f7d,'resolvers':_0xbabd,'subscription':{'pubsub':_0x1130ba}}),_0x166eb6[_0x38d6e8(0x120)]({'port':0x0},_0x12b962=>{const _0x5c0b2c=_0x38d6e8,_0x473ad0={'kGDxy':_0x5c0b2c(0x164)};_0x1f14ec[_0x5c0b2c(0x23a)](_0x12b962);const _0x116515=new WebSocket(_0x5ea8d1[_0x5c0b2c(0x1fe)](_0x5ea8d1[_0x5c0b2c(0x22a)]+_0x166eb6[_0x5c0b2c(0x19a)][_0x5c0b2c(0x140)]()[_0x5c0b2c(0x265)],_0x5ea8d1['ZpEZq']),_0x5c0b2c(0x181)),_0x3251ea=WebSocket[_0x5c0b2c(0x1fd)](_0x116515,{'encoding':_0x5c0b2c(0x1cb),'objectMode':!![]});_0x1f14ec[_0x5c0b2c(0x1f9)](_0x3251ea[_0x5c0b2c(0x26e)][_0x5c0b2c(0x237)](_0x3251ea)),_0x3251ea[_0x5c0b2c(0x1d5)](_0x5ea8d1[_0x5c0b2c(0x24e)]),_0x3251ea[_0x5c0b2c(0x102)](JSON[_0x5c0b2c(0x139)]({'type':_0x5c0b2c(0x193)})),_0x3251ea['write'](JSON['stringify']({'id':0x1,'type':_0x5ea8d1['rlHyV'],'payload':{'query':_0x5c0b2c(0x26d)}})),_0x3251ea[_0x5c0b2c(0x102)](JSON[_0x5c0b2c(0x139)]({'id':0x2,'type':_0x5c0b2c(0x20e),'payload':{'query':_0x5c0b2c(0x26d)}})),_0x3251ea[_0x5c0b2c(0x102)](JSON['stringify']({'id':0x2,'type':'stop'})),_0x3251ea['on'](_0x5c0b2c(0x164),_0x1d3296=>{const _0x386fe4=_0x5c0b2c,_0x1d8ee8=JSON['parse'](_0x1d3296);if(_0x1d8ee8['id']===0x1&&_0x1d8ee8[_0x386fe4(0x19d)]==='data')_0x1f14ec[_0x386fe4(0x179)](_0x1d3296,JSON[_0x386fe4(0x139)]({'type':_0x473ad0[_0x386fe4(0x192)],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':'Hello\x20World'}}}})),_0x3251ea[_0x386fe4(0x25c)](),_0x1f14ec[_0x386fe4(0x25c)]();else _0x1d8ee8['id']===0x2&&_0x1d8ee8['type']===_0x386fe4(0x1d4)&&_0x1e9262();});});}),test('subscription\x20server\x20sends\x20update\x20to\x20subscriptions\x20with\x20custom\x20context',_0x21b0ed=>{const _0xd862d=_0x5a83ac,_0x338a31={'EeKIG':function(_0x10623e){return _0x10623e();},'KBTJr':_0xd862d(0x178),'aHjAB':function(_0x335b83,_0x1e26da){return _0x335b83===_0x1e26da;},'ZQTaR':_0xd862d(0xff),'bLhgQ':'Hello\x20World','ZnPzv':_0xd862d(0x250),'bjpCl':_0xd862d(0x181),'ZcWHQ':_0xd862d(0x193),'ATggd':_0xd862d(0x20e),'czqyz':_0xd862d(0x164)},_0x2296ae=Fastify();_0x21b0ed[_0xd862d(0x1f9)](()=>_0x2296ae[_0xd862d(0x1ef)]());const _0x39d1bb=()=>{const _0x481709=_0xd862d;_0x2296ae[_0x481709(0x155)]({'method':_0x481709(0x1d9),'url':_0x481709(0x178),'body':{'query':_0x481709(0x153)}},()=>{const _0x5dc2c7=_0x481709;_0x338a31[_0x5dc2c7(0x25d)](_0x4c4de5);});},_0x4c4de5=()=>{const _0x2705ee=_0xd862d;_0x2296ae[_0x2705ee(0x155)]({'method':_0x2705ee(0x1d9),'url':_0x338a31[_0x2705ee(0x16e)],'body':{'query':_0x2705ee(0x1b0)}},()=>{});},_0x2a4bf0=mq(),_0x1701b9=_0xd862d(0x145);let _0x45d90f=0x1;const _0x548fb6=[{'id':_0x45d90f,'message':_0xd862d(0x18b)}],_0x2aab81={'Query':{'notifications':()=>_0x548fb6},'Mutation':{'addNotification':async(_0x1f04eb,{message:_0x487b07})=>{const _0x501586=_0xd862d,_0x26f272=_0x45d90f++,_0x482e98={'id':_0x26f272,'message':_0x487b07};return _0x548fb6[_0x501586(0x1f5)](_0x482e98),await _0x2a4bf0[_0x501586(0x1fb)]({'topic':_0x501586(0x1b6),'payload':{'notificationAdded':_0x482e98}}),_0x482e98;}},'Subscription':{'notificationAdded':{'subscribe':(_0x3c8dfe,_0x14de00,{pubsub:_0x386ec6,topic:_0x5555a3})=>_0x386ec6['subscribe'](_0x5555a3)}}};_0x2296ae[_0xd862d(0x1c9)](GQL,{'schema':_0x1701b9,'resolvers':_0x2aab81,'subscription':{'emitter':_0x2a4bf0,'context':()=>({'topic':'NOTIFICATION_ADDED'})}}),_0x2296ae[_0xd862d(0x120)]({'port':0x0},_0x558ce1=>{const _0xfabca6=_0xd862d,_0xaed3fc={'Cvhic':function(_0x2a61ed,_0x23f2b5){const _0x313ba2=_0x1b52;return _0x338a31[_0x313ba2(0x1a1)](_0x2a61ed,_0x23f2b5);},'vFXBd':_0xfabca6(0xf9),'dXAdp':_0x338a31['ZQTaR'],'ZdJFq':function(_0x475510,_0x590f){const _0x5c0a73=_0xfabca6;return _0x338a31[_0x5c0a73(0x1a1)](_0x475510,_0x590f);},'EwsUS':_0xfabca6(0x164),'fdeif':_0x338a31[_0xfabca6(0x121)]};_0x21b0ed['error'](_0x558ce1);const _0x227623=new WebSocket(_0x338a31[_0xfabca6(0x191)]+_0x2296ae[_0xfabca6(0x19a)][_0xfabca6(0x140)]()[_0xfabca6(0x265)]+_0xfabca6(0x178),_0x338a31[_0xfabca6(0x111)]),_0x4a51a9=WebSocket[_0xfabca6(0x1fd)](_0x227623,{'encoding':'utf8','objectMode':!![]});_0x21b0ed[_0xfabca6(0x1f9)](_0x4a51a9[_0xfabca6(0x26e)][_0xfabca6(0x237)](_0x4a51a9)),_0x4a51a9['setEncoding'](_0xfabca6(0x1cb)),_0x4a51a9[_0xfabca6(0x102)](JSON[_0xfabca6(0x139)]({'type':_0x338a31[_0xfabca6(0x1e1)]})),_0x4a51a9[_0xfabca6(0x102)](JSON['stringify']({'id':0x1,'type':_0x338a31['ATggd'],'payload':{'query':_0xfabca6(0x26d)}})),_0x4a51a9['write'](JSON[_0xfabca6(0x139)]({'id':0x2,'type':_0x338a31[_0xfabca6(0x188)],'payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}})),_0x4a51a9[_0xfabca6(0x102)](JSON[_0xfabca6(0x139)]({'id':0x2,'type':_0xfabca6(0x226)})),_0x4a51a9['on'](_0x338a31[_0xfabca6(0x174)],_0x298b96=>{const _0x1d882c=_0xfabca6;if(_0xaed3fc['Cvhic'](_0xaed3fc['vFXBd'],_0xaed3fc['dXAdp']))_0x5d9bd5[_0x1d882c(0x1c5)]();else{const _0x1d3ec2=JSON['parse'](_0x298b96);if(_0xaed3fc['Cvhic'](_0x1d3ec2['id'],0x1)&&_0xaed3fc[_0x1d882c(0x16d)](_0x1d3ec2[_0x1d882c(0x19d)],_0xaed3fc[_0x1d882c(0x1bd)]))_0x21b0ed[_0x1d882c(0x179)](_0x298b96,JSON['stringify']({'type':_0xaed3fc[_0x1d882c(0x1bd)],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0xaed3fc[_0x1d882c(0x1a9)]}}}})),_0x4a51a9[_0x1d882c(0x25c)](),_0x21b0ed['end']();else _0x1d3ec2['id']===0x2&&_0x1d3ec2[_0x1d882c(0x19d)]===_0x1d882c(0x1d4)&&_0x39d1bb();}});});}),test(_0x5a83ac(0x12f),_0x1b3227=>{const _0x379602=_0x5a83ac,_0x3f1471={'ghOri':function(_0x5b0e11,_0x5ee8d6){return _0x5b0e11!==_0x5ee8d6;},'bjwgq':_0x379602(0x11a),'lyWkA':function(_0x374004,_0x35dc01){return _0x374004+_0x35dc01;},'DZtpC':_0x379602(0x178),'OwBfU':'foobar','pRtHk':'close','fjyjs':function(_0x1991e6){return _0x1991e6();}},_0x280a81=_0x3f1471['fjyjs'](Fastify),_0x5b6236='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20add(x:\x20Int,\x20y:\x20Int):\x20Int\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x2f3b18={'add':async({x:_0x1ad58e,y:_0x55c420})=>_0x1ad58e+_0x55c420};_0x1b3227[_0x379602(0x1f9)](_0x280a81[_0x379602(0x1ef)]),_0x280a81[_0x379602(0x1c9)](GQL,{'schema':_0x5b6236,'resolvers':_0x2f3b18,'subscription':!![]}),_0x280a81[_0x379602(0x120)]({'port':0x0},()=>{const _0x40b2d4=_0x379602;if(_0x3f1471[_0x40b2d4(0x11b)](_0x40b2d4(0x11a),_0x3f1471[_0x40b2d4(0x17a)]))this[_0x40b2d4(0xfe)][_0x40b2d4(0x119)](_0x3c6dea,_0x52ebfa);else{const _0x581daf=_0x3f1471[_0x40b2d4(0x14e)](_0x40b2d4(0x250),_0x280a81[_0x40b2d4(0x19a)]['address']()[_0x40b2d4(0x265)])+_0x3f1471[_0x40b2d4(0x142)],_0x5e3012=new WebSocket(_0x581daf,_0x3f1471[_0x40b2d4(0x225)]),_0x410803=WebSocket[_0x40b2d4(0x1fd)](_0x5e3012,{'encoding':_0x40b2d4(0x1cb),'objectMode':!![]});_0x1b3227['teardown'](_0x410803[_0x40b2d4(0x26e)][_0x40b2d4(0x237)](_0x410803)),_0x410803[_0x40b2d4(0x1d5)](_0x40b2d4(0x1cb)),_0x5e3012['on'](_0x3f1471[_0x40b2d4(0x137)],()=>{const _0x42c301=_0x40b2d4;_0x410803[_0x42c301(0x25c)](),_0x1b3227[_0x42c301(0x25c)]();});}});}),test('subscription\x20connection\x20is\x20closed\x20if\x20context\x20function\x20throws',_0x398303=>{const _0x4e63f3=_0x5a83ac,_0x123b67={'NvmqG':'SqnLa','CfzAC':_0x4e63f3(0x22b),'POepy':'connectionInit','cMiKy':_0x4e63f3(0x1cb),'XCYtj':function(_0xa202f0){return _0xa202f0();},'mkUYx':function(_0x1c32e0,_0x47de1f){return _0x1c32e0===_0x47de1f;},'FNIbZ':_0x4e63f3(0x178),'makMj':_0x4e63f3(0x181),'lJDWU':'connection_init','BmPbm':_0x4e63f3(0x1ef)},_0x135750=Fastify();_0x398303['teardown'](()=>_0x135750[_0x4e63f3(0x1ef)]());const _0x2e6655=_0x4e63f3(0x1e4),_0x127b4d={'Query':{'add':(_0x5a4c57,{x:_0x331dae,y:_0x253909})=>_0x331dae+_0x253909}};_0x135750['register'](GQL,{'schema':_0x2e6655,'resolvers':_0x127b4d,'subscription':{'context':function(){const _0x2810b8=_0x4e63f3;throw new Error(_0x2810b8(0x26b));}}}),_0x135750[_0x4e63f3(0x120)]({'port':0x0},_0x20d227=>{const _0x71dd31=_0x4e63f3,_0x1953fb={'QSWHU':_0x123b67[_0x71dd31(0x1f6)],'oZCBd':_0x123b67[_0x71dd31(0x272)],'xBNbZ':function(_0x17584f,_0x428fd6){return _0x17584f+_0x428fd6;},'tEiWo':_0x123b67[_0x71dd31(0x147)],'PEEmy':_0x71dd31(0x193),'RkUzz':function(_0x4cb048){const _0x3f247e=_0x71dd31;return _0x123b67[_0x3f247e(0x1e5)](_0x4cb048);}};if(_0x123b67['mkUYx'](_0x71dd31(0x10b),_0x71dd31(0x235))){_0x29a26e[_0x71dd31(0x23a)](_0x37ebd6);const _0x32435d=new _0x92fd0(_0x1953fb[_0x71dd31(0x1d8)](_0x71dd31(0x250),_0x2fb23b[_0x71dd31(0x19a)][_0x71dd31(0x140)]()[_0x71dd31(0x265)])+_0x71dd31(0x178),_0x71dd31(0x181)),_0x2a72d9=_0x1a87da[_0x71dd31(0x1fd)](_0x32435d,{'encoding':_0x1953fb[_0x71dd31(0x194)],'objectMode':!![]});_0x311262[_0x71dd31(0x1f9)](_0x2a72d9[_0x71dd31(0x26e)]['bind'](_0x2a72d9)),_0x2a72d9[_0x71dd31(0x1d5)](_0x71dd31(0x1cb)),_0x2a72d9['write'](_0x22c4ca[_0x71dd31(0x139)]({'type':_0x1953fb['PEEmy']})),_0x2a72d9['on']('data',_0x5d77bf=>{const _0xc12bc1=_0x71dd31,_0x207f19=_0x316ed7[_0xc12bc1(0x221)](_0x5d77bf);_0x207f19[_0xc12bc1(0x19d)]===_0x1953fb['QSWHU']&&(_0x2a72d9[_0xc12bc1(0x102)](_0x20b4ff[_0xc12bc1(0x139)]({'id':0x1,'type':_0xc12bc1(0x20e),'payload':{'query':_0xc12bc1(0x26d)},'extensions':[{'type':_0x1953fb[_0xc12bc1(0x1c3)]}]})),_0x2a72d9['end']());});}else{_0x398303[_0x71dd31(0x23a)](_0x20d227);const _0x4548b6='ws://localhost:'+_0x135750[_0x71dd31(0x19a)][_0x71dd31(0x140)]()[_0x71dd31(0x265)]+_0x123b67[_0x71dd31(0x23c)],_0x41bef3=new WebSocket(_0x4548b6,_0x123b67['makMj']),_0x318476=WebSocket[_0x71dd31(0x1fd)](_0x41bef3,{'encoding':_0x123b67[_0x71dd31(0x147)],'objectMode':!![]});_0x398303[_0x71dd31(0x1f9)](_0x318476[_0x71dd31(0x26e)][_0x71dd31(0x237)](_0x318476)),_0x318476[_0x71dd31(0x102)](JSON[_0x71dd31(0x139)]({'type':_0x123b67[_0x71dd31(0x1f4)]})),_0x398303[_0x71dd31(0x1f9)](_0x318476['destroy'][_0x71dd31(0x237)](_0x318476)),_0x318476[_0x71dd31(0x1d5)](_0x71dd31(0x1cb)),_0x41bef3['on'](_0x123b67[_0x71dd31(0x240)],()=>{const _0x59429f=_0x71dd31;'gVAom'!==_0x123b67[_0x59429f(0x1df)]?(_0x318476[_0x59429f(0x25c)](),_0x398303[_0x59429f(0x25c)]()):(this['emitter'][_0x59429f(0x1fb)](_0x3b97d1[_0x59429f(0x100)],_0xef134a[_0x59429f(0x19f)]),_0x1953fb[_0x59429f(0x1d6)](_0x36d92b));});}});}),test(_0x5a83ac(0x252),_0x15e336=>{const _0x44c457=_0x5a83ac,_0x2cd742={'sgyrV':_0x44c457(0x164),'KbJJl':function(_0x3d5137,_0x4d7a30){return _0x3d5137===_0x4d7a30;},'RVwWG':'FIrSY','lAnpu':function(_0x22a8e6){return _0x22a8e6();},'dsefu':_0x44c457(0x178),'FFxlk':_0x44c457(0x1f3),'DdZTX':function(_0x1c1fed){return _0x1c1fed();},'jrujB':_0x44c457(0x172),'kmYuC':function(_0x32a680,_0x33545d){return _0x32a680+_0x33545d;},'SOcAs':_0x44c457(0x250),'AxWqq':'graphql-ws','eyvOA':_0x44c457(0x1cb),'cpYEI':_0x44c457(0x193),'hQXcy':_0x44c457(0x20e),'aHHfc':_0x44c457(0x226)},_0x385353=Fastify();_0x15e336['teardown'](async()=>{const _0x220e38=_0x44c457;_0x2cd742[_0x220e38(0x274)](_0x2cd742[_0x220e38(0x199)],_0x2cd742[_0x220e38(0x199)])?await _0x385353[_0x220e38(0x1ef)]():(_0x42ed6f[_0x220e38(0x179)](_0x1331af,_0x524be3[_0x220e38(0x139)]({'type':_0x2cd742[_0x220e38(0x16f)],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x220e38(0x1f3)}}}})),_0x1f924f[_0x220e38(0x25c)]());});const _0x19cb07=()=>{const _0x3fa716=_0x44c457,_0x3916e6={'ypFLp':_0x3fa716(0x258)};if('oOVvF'===_0x3fa716(0x165))_0x385353[_0x3fa716(0x155)]({'method':_0x3fa716(0x1d9),'url':_0x3fa716(0x178),'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notifications\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{const _0x1eaa6a=_0x3fa716;_0x2cd742[_0x1eaa6a(0x1a4)](_0x9ed5fc);});else throw new _0x39e8a8(_0x3916e6[_0x3fa716(0x1c1)]);},_0x9ed5fc=()=>{const _0x336e0e=_0x44c457;_0x385353[_0x336e0e(0x155)]({'method':_0x336e0e(0x1d9),'url':_0x2cd742[_0x336e0e(0x106)],'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mutation\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20addNotification(message:\x20\x22Hello\x20World\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{});},_0x216fd0=mq(),_0x13b8f3=_0x44c457(0x145);let _0xad69e5=0x1;const _0x3bf4da=[{'id':_0xad69e5,'message':_0x44c457(0x18b)}],_0x29af7f={'Query':{'notifications':()=>_0x3bf4da},'Mutation':{'addNotification':async(_0x4f1c9b,{message:_0x26581c})=>{const _0x53f98e=_0x44c457,_0x158d58=_0xad69e5++,_0xff7b98={'id':_0x158d58,'message':_0x26581c};return _0x3bf4da[_0x53f98e(0x1f5)](_0xff7b98),await _0x216fd0[_0x53f98e(0x1fb)]({'topic':_0x53f98e(0x1b6),'payload':{'notificationAdded':_0xff7b98}}),_0xff7b98;}},'Subscription':{'notificationAdded':{'subscribe':(_0x325f54,_0xc7541,{pubsub:_0x3e41a6,topic:_0x34eca0})=>_0x3e41a6[_0x44c457(0x16b)](_0x34eca0)}}};_0x385353['register'](GQL,{'schema':_0x13b8f3,'resolvers':_0x29af7f,'subscription':{'emitter':_0x216fd0,'context':async()=>{const _0x56c169=_0x44c457;return await _0x15e336[_0x56c169(0x13c)][_0x56c169(0x271)][_0x56c169(0x160)](0xc8),{'topic':_0x56c169(0x1b6)};}}}),_0x385353[_0x44c457(0x120)]({'port':0x0},_0x15e267=>{const _0x5ee55b=_0x44c457,_0x580c47={'GClin':_0x5ee55b(0x20e),'eHYas':_0x2cd742[_0x5ee55b(0x1b5)]};if(_0x5ee55b(0x129)===_0x5ee55b(0x129)){_0x15e336['error'](_0x15e267);const _0x4dbe02=new WebSocket(_0x2cd742[_0x5ee55b(0x151)](_0x2cd742[_0x5ee55b(0x259)],_0x385353[_0x5ee55b(0x19a)][_0x5ee55b(0x140)]()['port'])+_0x5ee55b(0x178),_0x2cd742['AxWqq']),_0x5e0bad=WebSocket[_0x5ee55b(0x1fd)](_0x4dbe02,{'encoding':_0x2cd742['eyvOA'],'objectMode':!![]});_0x15e336[_0x5ee55b(0x1f9)](_0x5e0bad[_0x5ee55b(0x26e)][_0x5ee55b(0x237)](_0x5e0bad)),_0x5e0bad[_0x5ee55b(0x1d5)]('utf8'),_0x5e0bad[_0x5ee55b(0x102)](JSON['stringify']({'type':_0x2cd742[_0x5ee55b(0x1a7)]})),_0x5e0bad[_0x5ee55b(0x102)](JSON['stringify']({'id':0x1,'type':_0x2cd742['hQXcy'],'payload':{'query':_0x5ee55b(0x26d)}})),_0x5e0bad[_0x5ee55b(0x102)](JSON[_0x5ee55b(0x139)]({'id':0x2,'type':_0x2cd742['hQXcy'],'payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}})),_0x5e0bad[_0x5ee55b(0x102)](JSON['stringify']({'id':0x2,'type':_0x2cd742['aHHfc']})),_0x5e0bad['on'](_0x2cd742[_0x5ee55b(0x16f)],_0xecbc56=>{const _0x1f7e7e=_0x5ee55b,_0x171fb9=JSON[_0x1f7e7e(0x221)](_0xecbc56);if(_0x2cd742['KbJJl'](_0x171fb9['id'],0x1)&&_0x2cd742[_0x1f7e7e(0x274)](_0x171fb9[_0x1f7e7e(0x19d)],_0x2cd742[_0x1f7e7e(0x16f)]))_0x15e336[_0x1f7e7e(0x179)](_0xecbc56,JSON[_0x1f7e7e(0x139)]({'type':'data','id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x2cd742[_0x1f7e7e(0x144)]}}}})),_0x5e0bad[_0x1f7e7e(0x25c)](),_0x15e336['end']();else _0x2cd742[_0x1f7e7e(0x274)](_0x171fb9['id'],0x2)&&_0x2cd742[_0x1f7e7e(0x274)](_0x171fb9[_0x1f7e7e(0x19d)],_0x1f7e7e(0x1d4))&&_0x2cd742[_0x1f7e7e(0x21c)](_0x19cb07);});}else _0x1d0fca[_0x5ee55b(0x102)](_0x52d66f['stringify']({'id':0x1,'type':_0x580c47[_0x5ee55b(0x1aa)],'payload':{'query':_0x5ee55b(0x26d)},'extensions':[{'type':_0x580c47['eHYas']}]})),_0x5b48f9['end']();});}),test('subscription\x20connection\x20is\x20closed\x20if\x20async\x20context\x20function\x20throws',_0x55ef19=>{const _0x52d3aa=_0x5a83ac,_0x509d8e={'BhAMH':function(_0x16f43f,_0xcc891c){return _0x16f43f+_0xcc891c;},'JNXPc':function(_0x162328,_0x580034){return _0x162328+_0x580034;},'QBtRZ':_0x52d3aa(0x250),'ZVocz':_0x52d3aa(0x178),'gfyXl':'graphql-ws'},_0x2324aa=Fastify();_0x55ef19[_0x52d3aa(0x1f9)](async()=>{const _0x1ab190=_0x52d3aa;await _0x2324aa[_0x1ab190(0x1ef)]();});const _0x2c0696='\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20add(x:\x20Int,\x20y:\x20Int):\x20Int\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x1841bb={'Query':{'add':(_0x2cf3e9,{x:_0x400641,y:_0x4d22cb})=>_0x400641+_0x4d22cb}};_0x2324aa[_0x52d3aa(0x1c9)](GQL,{'schema':_0x2c0696,'resolvers':_0x1841bb,'subscription':{'context':async function(){const _0xd9e56f=_0x52d3aa;await _0x55ef19[_0xd9e56f(0x13c)]['clock'][_0xd9e56f(0x160)](0xc8);throw new Error('kaboom');}}}),_0x2324aa['listen']({'port':0x0},_0x404f4e=>{const _0xddf489=_0x52d3aa;_0x55ef19['error'](_0x404f4e);const _0x1a3fcd=_0x509d8e[_0xddf489(0x1af)](_0x509d8e[_0xddf489(0x118)](_0x509d8e['QBtRZ'],_0x2324aa[_0xddf489(0x19a)][_0xddf489(0x140)]()[_0xddf489(0x265)]),_0x509d8e['ZVocz']),_0x1ab393=new WebSocket(_0x1a3fcd,_0x509d8e['gfyXl']),_0x5cf56e=WebSocket['createWebSocketStream'](_0x1ab393,{'encoding':_0xddf489(0x1cb),'objectMode':!![]});_0x55ef19['teardown'](_0x5cf56e[_0xddf489(0x26e)][_0xddf489(0x237)](_0x5cf56e)),_0x5cf56e['setEncoding'](_0xddf489(0x1cb)),_0x5cf56e[_0xddf489(0x102)](JSON[_0xddf489(0x139)]({'type':_0xddf489(0x193)})),_0x1ab393['on'](_0xddf489(0x1ef),()=>{_0x5cf56e['end'](),_0x55ef19['end']();});});}),test(_0x5a83ac(0x1fa),_0x3cd681=>{const _0x4d5a98=_0x5a83ac,_0x57ec1f={'MJQbQ':function(_0x3155ec,_0x6014b8){return _0x3155ec===_0x6014b8;},'PVafF':_0x4d5a98(0x23a),'cQiBc':_0x4d5a98(0x178),'JctHx':_0x4d5a98(0x1cb),'YhxDW':function(_0x23316b){return _0x23316b();}},_0x5b0d50=_0x57ec1f[_0x4d5a98(0x1db)](Fastify);_0x3cd681[_0x4d5a98(0x1f9)](()=>_0x5b0d50[_0x4d5a98(0x1ef)]());const _0x45cc7a=mq(),_0x3337b4='\x0a\x20\x20\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20\x20\x20message:\x20String\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20\x20\x20notificationAdded:\x20Notification\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x4b9626={'Subscription':{'notificationAdded':{'subscribe':()=>{throw Error('custom\x20execution\x20error');}}}};_0x5b0d50[_0x4d5a98(0x1c9)](GQL,{'schema':_0x3337b4,'resolvers':_0x4b9626,'subscription':{'emitter':_0x45cc7a}}),_0x5b0d50[_0x4d5a98(0x120)]({'port':0x0},_0x5d95b4=>{const _0x4a8d5f=_0x4d5a98,_0x4cea2a={'lQAMZ':function(_0x44f249,_0x445b71){const _0x192f26=_0x1b52;return _0x57ec1f[_0x192f26(0x163)](_0x44f249,_0x445b71);},'ohiOd':_0x57ec1f[_0x4a8d5f(0x1a0)]};_0x3cd681[_0x4a8d5f(0x23a)](_0x5d95b4);const _0x1919cd=new WebSocket('ws://localhost:'+_0x5b0d50['server'][_0x4a8d5f(0x140)]()[_0x4a8d5f(0x265)]+_0x57ec1f[_0x4a8d5f(0x134)],_0x4a8d5f(0x181)),_0x2a54d3=WebSocket[_0x4a8d5f(0x1fd)](_0x1919cd,{'encoding':_0x4a8d5f(0x1cb),'objectMode':!![]});_0x3cd681['teardown'](_0x2a54d3[_0x4a8d5f(0x26e)][_0x4a8d5f(0x237)](_0x2a54d3)),_0x2a54d3[_0x4a8d5f(0x1d5)](_0x57ec1f[_0x4a8d5f(0x23f)]),_0x2a54d3[_0x4a8d5f(0x102)](JSON[_0x4a8d5f(0x139)]({'type':_0x4a8d5f(0x193)})),_0x2a54d3['write'](JSON[_0x4a8d5f(0x139)]({'id':0x1,'type':'start','payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}})),_0x2a54d3['on']('data',_0x443e94=>{const _0x324636=_0x4a8d5f;if('ZKGrX'===_0x324636(0x162)){const _0x4310a7=JSON[_0x324636(0x221)](_0x443e94);_0x4310a7['id']===0x1&&_0x4cea2a[_0x324636(0x146)](_0x4310a7[_0x324636(0x19d)],_0x4cea2a[_0x324636(0x26c)])&&(_0x3cd681[_0x324636(0x179)](_0x443e94,JSON[_0x324636(0x139)]({'type':_0x4cea2a[_0x324636(0x26c)],'id':0x1,'payload':_0x324636(0x1b9)})),_0x2a54d3[_0x324636(0x25c)](),_0x3cd681[_0x324636(0x25c)]());}else{_0x2fed3a['ok'](_0x3de380,'context\x20is\x20not\x20missing');const {username:_0x2b0a6f}=_0x2065cf;return _0x27fc68[_0x324636(0x138)](({obj:_0x46ac89})=>_0x46ac89['message']+'\x20'+_0x2b0a6f);}});});}),test(_0x5a83ac(0x1bb),_0x1e6243=>{const _0x1a8335=_0x5a83ac,_0x3da684={'jQAFs':_0x1a8335(0x1fc),'gbwVz':_0x1a8335(0x250),'xewdu':_0x1a8335(0x178),'xbzFL':_0x1a8335(0x1cb),'ZtvLR':'start'},_0x15dd53=Fastify();_0x1e6243['teardown'](()=>_0x15dd53[_0x1a8335(0x1ef)]());const _0x10c577=_0x1a8335(0x1ad),_0x4a2f7b=[],_0xc9cea3={'Query':{'notifications':()=>_0x4a2f7b},'Subscription':{'notificationAdded':{'subscribe':(_0x26a050,_0x157bf3,{pubsub:_0x938d15})=>_0x938d15[_0x1a8335(0x16b)](_0x1a8335(0x1b6))}}};_0x15dd53[_0x1a8335(0x1c9)](GQL,{'schema':_0x10c577,'resolvers':_0xc9cea3,'subscription':!![]}),_0x15dd53[_0x1a8335(0x120)]({'port':0x0},_0x1d2be1=>{const _0x24b624=_0x1a8335,_0x44a666={'gzAgf':_0x24b624(0x1b6),'skjaP':_0x3da684[_0x24b624(0x241)]};_0x1e6243[_0x24b624(0x23a)](_0x1d2be1);const _0x3fa334=new WebSocket(_0x3da684[_0x24b624(0x150)]+_0x15dd53[_0x24b624(0x19a)]['address']()[_0x24b624(0x265)]+_0x3da684['xewdu'],_0x24b624(0x181)),_0x232930=WebSocket[_0x24b624(0x1fd)](_0x3fa334,{'encoding':_0x3da684['xbzFL'],'objectMode':!![]});_0x1e6243['teardown'](_0x232930['destroy'][_0x24b624(0x237)](_0x232930)),_0x232930[_0x24b624(0x1d5)](_0x3da684['xbzFL']),_0x232930['write'](JSON[_0x24b624(0x139)]({'type':'connection_init'})),_0x232930['write'](JSON[_0x24b624(0x139)]({'id':0x1,'type':_0x3da684['ZtvLR'],'payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}})),_0x232930['on'](_0x24b624(0x164),_0x4b7e3f=>{const _0x37aca6=_0x24b624,_0xf08ca0=JSON[_0x37aca6(0x221)](_0x4b7e3f);_0xf08ca0[_0x37aca6(0x19d)]==='connection_ack'?_0x15dd53['graphql'][_0x37aca6(0x1f8)][_0x37aca6(0x1c2)]({'topic':_0x44a666[_0x37aca6(0x1ec)],'payload':{'notificationAdded':{'id':0x1,'message':_0x37aca6(0x1fc)}}}):(_0x1e6243['equal'](_0x4b7e3f,JSON[_0x37aca6(0x139)]({'type':'data','id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x44a666[_0x37aca6(0x1a8)]}}}})),_0x232930[_0x37aca6(0x25c)](),_0x1e6243[_0x37aca6(0x25c)]());});});}),test(_0x5a83ac(0x18f),_0xb235cd=>{const _0x38aa5f=_0x5a83ac,_0x4c8e9b={'uPCkk':_0x38aa5f(0x25f),'uWwBh':function(_0x57f872,_0x216dec){return _0x57f872===_0x216dec;},'NqtWo':_0x38aa5f(0x172),'xGGPP':_0x38aa5f(0x200),'iALXu':function(_0x4ad835,_0x1f12b2){return _0x4ad835+_0x1f12b2;},'OKLVO':_0x38aa5f(0x193),'XsLGh':function(_0x3b0401){return _0x3b0401();}},_0x58128a=_0x4c8e9b[_0x38aa5f(0x1ba)](Fastify);_0xb235cd[_0x38aa5f(0x1f9)](()=>_0x58128a[_0x38aa5f(0x1ef)]());const _0x96c474='\x0a\x20\x20\x20\x20type\x20Notification\x20{\x0a\x20\x20\x20\x20\x20\x20id:\x20ID!\x0a\x20\x20\x20\x20\x20\x20message:\x20String\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Query\x20{\x0a\x20\x20\x20\x20\x20\x20notifications:\x20[Notification]\x0a\x20\x20\x20\x20}\x0a\x0a\x20\x20\x20\x20type\x20Subscription\x20{\x0a\x20\x20\x20\x20\x20\x20notificationAdded:\x20Notification\x0a\x20\x20\x20\x20}\x0a\x20\x20',_0x4d5d9d={'Query':{'notifications':()=>[]},'Subscription':{'notificationAdded':{'subscribe':(_0x5931ae,_0x1df36b,{pubsub:_0x19458c,topic:_0x197af4,hello:_0x54000d})=>{const _0x4b9fde=_0x38aa5f;_0xb235cd[_0x4b9fde(0x179)](_0x54000d,_0x4c8e9b['uPCkk']),_0xb235cd[_0x4b9fde(0x25c)](),_0x19458c[_0x4b9fde(0x16b)](_0x197af4);}}}};_0x58128a[_0x38aa5f(0x1c9)](GQL,{'schema':_0x96c474,'resolvers':_0x4d5d9d,'subscription':{'onConnect':()=>({'hello':_0x38aa5f(0x25f)})}}),_0x58128a['listen']({'port':0x0},_0x25f478=>{const _0x4eb82f=_0x38aa5f;if(_0x4c8e9b[_0x4eb82f(0x130)](_0x4c8e9b[_0x4eb82f(0x10d)],_0x4eb82f(0x186)))_0x419673[_0x4eb82f(0x179)](_0x2b1a1a,_0x4c8e9b[_0x4eb82f(0x173)]),_0x565501[_0x4eb82f(0x25c)](),_0x2c0c7b['subscribe'](_0xdba850);else{_0xb235cd['error'](_0x25f478);const _0x2f4592=new WebSocket(_0x4c8e9b['iALXu'](_0x4eb82f(0x250),_0x58128a['server'][_0x4eb82f(0x140)]()[_0x4eb82f(0x265)])+_0x4eb82f(0x178),_0x4eb82f(0x181)),_0x330bab=WebSocket['createWebSocketStream'](_0x2f4592,{'encoding':_0x4eb82f(0x1cb),'objectMode':!![]});_0xb235cd[_0x4eb82f(0x1f9)](_0x330bab['destroy'][_0x4eb82f(0x237)](_0x330bab)),_0x330bab[_0x4eb82f(0x1d5)](_0x4eb82f(0x1cb)),_0x330bab[_0x4eb82f(0x102)](JSON['stringify']({'type':_0x4c8e9b['OKLVO']})),_0x330bab['on'](_0x4eb82f(0x164),_0x481e0f=>{const _0x535f6a=_0x4eb82f,_0x4a76c0=JSON[_0x535f6a(0x221)](_0x481e0f);_0x4c8e9b[_0x535f6a(0x130)](_0x4a76c0[_0x535f6a(0x19d)],_0x535f6a(0x22b))&&(_0x330bab['write'](JSON[_0x535f6a(0x139)]({'id':0x1,'type':_0x535f6a(0x20e),'payload':{'query':_0x535f6a(0x26d)},'extensions':[{'type':_0x4c8e9b['NqtWo']}]})),_0x330bab[_0x535f6a(0x25c)]());});}});}),test(_0x5a83ac(0x20d),_0x3e5af3=>{const _0x4ca819=_0x5a83ac,_0x2d0574={'NuzXv':function(_0x2d7888,_0x4c8a3e){return _0x2d7888===_0x4c8a3e;},'NQrcr':_0x4ca819(0x22b),'lJMBU':'start','RZurv':function(_0x451604,_0x53d9fd){return _0x451604+_0x53d9fd;},'detlj':function(_0x4459eb,_0x2acca1){return _0x4459eb+_0x2acca1;},'xKABr':'ws://localhost:','NQVyc':'/graphql','qqlyK':_0x4ca819(0x181),'BYrzd':'utf8','xrTCr':_0x4ca819(0x193),'ImYLl':_0x4ca819(0x164)},_0x2ea75a=Fastify();_0x3e5af3['teardown'](()=>_0x2ea75a[_0x4ca819(0x1ef)]());const _0x475cb1=_0x4ca819(0x1be),_0x58a3dc={'Query':{'notifications':()=>[]},'Subscription':{'notificationAdded':{'subscribe':(_0x5aa2d9,_0xb2eb0e,{pubsub:_0x49172f,topic:_0x51e36e,hello:_0x4a1413})=>{_0x3e5af3['end'](),_0x49172f['subscribe'](_0x51e36e);}}}};_0x2ea75a[_0x4ca819(0x1c9)](GQL,{'schema':_0x475cb1,'resolvers':_0x58a3dc,'subscription':!![]}),_0x2ea75a[_0x4ca819(0x120)]({'port':0x0},_0x7435ad=>{const _0x58b597=_0x4ca819,_0x46126d={'ZHaoi':function(_0x57241c,_0x23ae63){const _0x4eb644=_0x1b52;return _0x2d0574[_0x4eb644(0x108)](_0x57241c,_0x23ae63);},'SkPbE':_0x2d0574[_0x58b597(0x19b)],'JVYCK':_0x2d0574['lJMBU']};_0x3e5af3['error'](_0x7435ad);const _0x506269=new WebSocket(_0x2d0574[_0x58b597(0x14a)](_0x2d0574['detlj'](_0x2d0574[_0x58b597(0x22f)],_0x2ea75a[_0x58b597(0x19a)][_0x58b597(0x140)]()['port']),_0x2d0574['NQVyc']),_0x2d0574[_0x58b597(0x112)]),_0x38d639=WebSocket['createWebSocketStream'](_0x506269,{'encoding':_0x2d0574[_0x58b597(0x23b)],'objectMode':!![]});_0x3e5af3[_0x58b597(0x1f9)](_0x38d639[_0x58b597(0x26e)][_0x58b597(0x237)](_0x38d639)),_0x38d639[_0x58b597(0x1d5)]('utf8'),_0x38d639[_0x58b597(0x102)](JSON[_0x58b597(0x139)]({'type':_0x2d0574[_0x58b597(0x234)]})),_0x38d639['on'](_0x2d0574[_0x58b597(0x1ab)],_0x253d32=>{const _0x1cc1d5=_0x58b597,_0x5ed4d8=JSON[_0x1cc1d5(0x221)](_0x253d32);_0x46126d[_0x1cc1d5(0x213)](_0x5ed4d8[_0x1cc1d5(0x19d)],_0x46126d[_0x1cc1d5(0x205)])&&(_0x38d639['write'](JSON[_0x1cc1d5(0x139)]({'id':0x1,'type':_0x46126d[_0x1cc1d5(0x14d)],'payload':{'query':_0x1cc1d5(0x26d)},'extensions':[{'type':_0x1cc1d5(0x172)}]})),_0x38d639[_0x1cc1d5(0x25c)]());});});}),test(_0x5a83ac(0x148),_0x1851c4=>{const _0x237047=_0x5a83ac,_0x4f4558={'xDqxH':function(_0x50ff63,_0xf73e6d){return _0x50ff63===_0xf73e6d;},'AEDBo':_0x237047(0x16a),'elMHF':_0x237047(0x172),'xwQUq':_0x237047(0x164),'jcYaj':'POST','BYZoe':_0x237047(0x123),'TYxDv':function(_0x80c948,_0x2082f2){return _0x80c948+_0x2082f2;},'VTGws':function(_0x3e1669,_0x4fb7e2){return _0x3e1669+_0x4fb7e2;},'jCaDg':_0x237047(0x250),'KhYSF':'utf8','GoPbt':'start','oFBVs':_0x237047(0x226),'znqGk':function(_0x5fc13b){return _0x5fc13b();},'ALaOc':function(_0x534b1c,_0x407a7a,_0x400771){return _0x534b1c(_0x407a7a,_0x400771);}};_0x1851c4['plan'](0x4);const _0xd2c86e=_0x4f4558[_0x237047(0x185)](Fastify);_0x1851c4[_0x237047(0x1f9)](()=>_0xd2c86e[_0x237047(0x1ef)]());const {withFilter:_0x45f107}=GQL;let _0x1bae80=0x0;const _0x56f5dd=[],_0x4f58fa=_0x237047(0x115),_0x33a445={'Query':{'notifications':()=>_0x56f5dd},'Mutation':{'addNotification':async(_0x194573,{message:_0x1618e0},{pubsub:_0x3c4dc6})=>{const _0x5815d7=_0x237047;if(_0x4f4558['xDqxH'](_0x5815d7(0x14f),_0x4f4558[_0x5815d7(0x180)]))_0xe9f211();else{const _0x225ede=_0x1bae80++,_0x5e606f={'id':_0x225ede,'message':_0x1618e0};_0x56f5dd[_0x5815d7(0x1f5)](_0x5e606f),await _0x3c4dc6[_0x5815d7(0x1c2)]({'topic':'NOTIFICATION_ADDED','payload':{'notificationAdded':_0x5e606f}});}}},'Subscription':{'notificationAdded':{'subscribe':_0x4f4558[_0x237047(0x13f)](_0x45f107,(_0x322a21,_0x109636,{pubsub:_0x177908})=>_0x177908[_0x237047(0x16b)](_0x237047(0x1b6)),(_0x5868ad,{contains:_0x2e6b69})=>{const _0x27f59f=_0x237047;if(!_0x2e6b69)return!![];return _0x5868ad['notificationAdded'][_0x27f59f(0x167)][_0x27f59f(0x182)](_0x2e6b69);})}}};_0xd2c86e[_0x237047(0x1c9)](GQL,{'schema':_0x4f58fa,'resolvers':_0x33a445,'subscription':!![]}),_0xd2c86e[_0x237047(0x120)]({'port':0x0},_0x158e88=>{const _0x5be7a2=_0x237047,_0x1de087={'posIw':_0x5be7a2(0x178),'FlxXw':_0x4f4558[_0x5be7a2(0x18e)],'lBvGq':function(_0x50594b,_0x34501c){const _0x43df59=_0x5be7a2;return _0x4f4558[_0x43df59(0x1cd)](_0x50594b,_0x34501c);},'vjvQp':function(_0x124785,_0x292661){const _0x3826bb=_0x5be7a2;return _0x4f4558[_0x3826bb(0x1cd)](_0x124785,_0x292661);},'BVGgB':_0x4f4558[_0x5be7a2(0x113)]};if('pkyGv'!==_0x4f4558[_0x5be7a2(0x133)])_0x2171d0[_0x5be7a2(0x102)](_0x4b4b6a['stringify']({'id':0x1,'type':_0x5be7a2(0x20e),'payload':{'query':_0x5be7a2(0x26d)},'extensions':[{'type':_0x4f4558['elMHF']}]})),_0x4fe2be['end']();else{_0x1851c4['error'](_0x158e88);const _0x49f556=new WebSocket(_0x4f4558['TYxDv'](_0x4f4558[_0x5be7a2(0x23e)](_0x4f4558[_0x5be7a2(0x17e)],_0xd2c86e[_0x5be7a2(0x19a)][_0x5be7a2(0x140)]()['port']),_0x5be7a2(0x178)),'graphql-ws'),_0x349f17=WebSocket[_0x5be7a2(0x1fd)](_0x49f556,{'encoding':_0x5be7a2(0x1cb),'objectMode':!![]});_0x1851c4[_0x5be7a2(0x1f9)](_0x349f17['destroy'][_0x5be7a2(0x237)](_0x349f17)),_0x349f17[_0x5be7a2(0x1d5)](_0x4f4558[_0x5be7a2(0x24a)]),_0x349f17[_0x5be7a2(0x102)](JSON['stringify']({'type':_0x5be7a2(0x193)})),_0x349f17[_0x5be7a2(0x102)](JSON[_0x5be7a2(0x139)]({'id':0x1,'type':_0x4f4558[_0x5be7a2(0x189)],'payload':{'query':_0x5be7a2(0x13a)}})),_0x349f17['write'](JSON[_0x5be7a2(0x139)]({'id':0x2,'type':_0x5be7a2(0x20e),'payload':{'query':_0x5be7a2(0x229)}})),_0x349f17[_0x5be7a2(0x102)](JSON[_0x5be7a2(0x139)]({'id':0x2,'type':_0x4f4558[_0x5be7a2(0x107)]})),_0x349f17['on'](_0x4f4558[_0x5be7a2(0x18e)],_0x47aac4=>{const _0x5943e7=_0x5be7a2,_0x323158={'xmpsv':'ws://localhost:','qUBDk':_0x1de087[_0x5943e7(0x201)],'zLBgU':'utf8'},_0x25ad74=JSON[_0x5943e7(0x221)](_0x47aac4);if(_0x25ad74['id']===0x1&&_0x25ad74[_0x5943e7(0x19d)]===_0x1de087['FlxXw'])_0x1851c4['ok'](!_0x25ad74['payload'][_0x5943e7(0x164)][_0x5943e7(0x183)][_0x5943e7(0x167)][_0x5943e7(0x182)]('filtered')),_0x349f17['end']();else{if(_0x1de087[_0x5943e7(0x246)](_0x25ad74['id'],0x2)&&_0x25ad74[_0x5943e7(0x19d)]===_0x5943e7(0x1d4)){if(_0x1de087[_0x5943e7(0x15e)]('RlmNs','RlmNs'))_0xd2c86e['inject']({'method':_0x5943e7(0x1d9),'url':_0x1de087[_0x5943e7(0x201)],'body':{'query':_0x5943e7(0x10a)}},()=>{const _0x21cd65=_0x5943e7;_0x1851c4[_0x21cd65(0x1c5)]();}),_0xd2c86e[_0x5943e7(0x155)]({'method':_0x1de087[_0x5943e7(0x215)],'url':'/graphql','body':{'query':_0x5943e7(0x1cc)}},()=>{const _0x1bd6db=_0x5943e7;_0x1851c4[_0x1bd6db(0x1c5)]();});else{_0x5d5894[_0x5943e7(0x23a)](_0x33648b);const _0x99c9b5=_0x323158[_0x5943e7(0x209)]+_0x5e590b['server']['address']()[_0x5943e7(0x265)]+_0x323158[_0x5943e7(0xfb)],_0x1d038b=new _0x1b8453(_0x99c9b5,'graphql-ws'),_0x58c62e=_0x2d171e[_0x5943e7(0x1fd)](_0x1d038b,{'encoding':_0x323158[_0x5943e7(0x236)],'objectMode':!![]});_0x43fd4c[_0x5943e7(0x1f9)](_0x58c62e[_0x5943e7(0x26e)][_0x5943e7(0x237)](_0x58c62e)),_0x58c62e[_0x5943e7(0x1d5)](_0x5943e7(0x1cb)),_0x58c62e[_0x5943e7(0x102)](_0x48094b['stringify']({'type':_0x5943e7(0x193)})),_0x58c62e['on'](_0x5943e7(0x164),_0x2bf21c=>{const _0x2ab4a1=_0x5943e7;_0x4fdd63[_0x2ab4a1(0x179)](_0x2bf21c,_0xc835c7['stringify']({'type':'connection_ack'})),_0x58c62e[_0x2ab4a1(0x25c)](),_0x4931d2[_0x2ab4a1(0x25c)]();});}}}});}});}),test(_0x5a83ac(0x11f),_0x54c966=>{const _0x188400=_0x5a83ac,_0x5e0280={'RNPii':_0x188400(0x1b6),'jwvpz':function(_0x15fcb8,_0x30693f){return _0x15fcb8!==_0x30693f;},'NrGlB':_0x188400(0x258),'bDbYI':'utf8','MEkmi':_0x188400(0x164),'Zqwvk':function(_0x505e40,_0xdb4be7){return _0x505e40===_0xdb4be7;},'CEAAg':_0x188400(0x1da),'jbXVL':_0x188400(0x178),'dUcVh':function(_0x123a67,_0x52a84d){return _0x123a67+_0x52a84d;},'ypMaq':_0x188400(0x250),'iKsLZ':'graphql-ws','lDGit':_0x188400(0x20e),'dOfRv':_0x188400(0x226),'xaAcu':function(_0x2cf0fa){return _0x2cf0fa();},'DKUAU':function(_0x221e2d,_0xec89bd,_0x3007bd){return _0x221e2d(_0xec89bd,_0x3007bd);}};_0x54c966[_0x188400(0x24b)](0x4);const _0xe9f0df=_0x5e0280[_0x188400(0x25e)](Fastify);_0x54c966[_0x188400(0x1f9)](()=>_0xe9f0df[_0x188400(0x1ef)]());const {withFilter:_0x43e073}=GQL;let _0x61d1bf=0x0;const _0x120970=[],_0x16d2ba=_0x188400(0x115),_0xef8c5b={'Query':{'notifications':()=>_0x120970},'Mutation':{'addNotification':async(_0x18bcbc,{message:_0x37d857},{pubsub:_0x545e56})=>{const _0x5df24e=_0x188400,_0x15c166=_0x61d1bf++,_0x13b52f={'id':_0x15c166,'message':_0x37d857};_0x120970['push'](_0x13b52f),await _0x545e56[_0x5df24e(0x1c2)]({'topic':_0x5e0280[_0x5df24e(0x132)],'payload':{'notificationAdded':_0x13b52f}});}},'Subscription':{'notificationAdded':{'subscribe':_0x5e0280[_0x188400(0x1b1)](_0x43e073,(_0x31304f,_0x4e1752,{pubsub:_0x2a86a3})=>_0x2a86a3[_0x188400(0x16b)]('NOTIFICATION_ADDED'),(_0x371c40,{contains:_0x1b60e5})=>{const _0x2a19ef=_0x188400,_0x4ab037={'bgvkI':_0x2a19ef(0x251)};if(_0x1b60e5&&!_0x371c40[_0x2a19ef(0x183)][_0x2a19ef(0x167)][_0x2a19ef(0x182)](_0x1b60e5)){if(_0x5e0280['jwvpz'](_0x2a19ef(0x13b),_0x2a19ef(0x13b)))return _0xbbd5d1['equal'](_0x20b8c4[_0x2a19ef(0x14b)][_0x2a19ef(0x20a)][_0x2a19ef(0x1b3)](),_0x2a19ef(0xfc)),_0x11c3c1[_0x2a19ef(0x179)](_0x47946c[_0x2a19ef(0x14b)][_0x2a19ef(0x20a)][_0x2a19ef(0x105)]['authorization'],_0x4ab037['bgvkI']),_0x5cae8d[_0x2a19ef(0x1f8)][_0x2a19ef(0x16b)](_0x2a19ef(0x1b6));else throw new Error(_0x5e0280['NrGlB']);}return!![];})}}};_0xe9f0df[_0x188400(0x1c9)](GQL,{'schema':_0x16d2ba,'resolvers':_0xef8c5b,'subscription':!![]}),_0xe9f0df[_0x188400(0x120)]({'port':0x0},_0xc928b3=>{const _0x200696=_0x188400,_0x2b6ebc={'SJQOt':_0x200696(0x114),'yEzOv':_0x5e0280['bDbYI'],'IcYfK':_0x5e0280['MEkmi'],'AuILK':function(_0x386778){return _0x386778();},'gfxUY':function(_0x2b66c0,_0x30328a){const _0x102c37=_0x200696;return _0x5e0280[_0x102c37(0x1b4)](_0x2b66c0,_0x30328a);},'WVFlz':'ovPOV','vqeqx':_0x5e0280[_0x200696(0x110)],'KplRi':_0x200696(0x1d4),'HYHTT':'POST','yBCgG':_0x5e0280[_0x200696(0x12a)]};_0x54c966[_0x200696(0x23a)](_0xc928b3);const _0xbb9c39=new WebSocket(_0x5e0280[_0x200696(0x149)](_0x5e0280['ypMaq']+_0xe9f0df[_0x200696(0x19a)][_0x200696(0x140)]()[_0x200696(0x265)],_0x200696(0x178)),_0x5e0280[_0x200696(0x18d)]),_0x1f86fe=WebSocket[_0x200696(0x1fd)](_0xbb9c39,{'encoding':_0x5e0280[_0x200696(0x1ca)],'objectMode':!![]});_0x54c966[_0x200696(0x1f9)](_0x1f86fe[_0x200696(0x26e)][_0x200696(0x237)](_0x1f86fe)),_0x1f86fe[_0x200696(0x1d5)](_0x200696(0x1cb)),_0x1f86fe[_0x200696(0x102)](JSON[_0x200696(0x139)]({'type':_0x200696(0x193)})),_0x1f86fe[_0x200696(0x102)](JSON['stringify']({'id':0x1,'type':_0x200696(0x20e),'payload':{'query':_0x200696(0x13a)}})),_0x1f86fe[_0x200696(0x102)](JSON['stringify']({'id':0x2,'type':_0x5e0280[_0x200696(0x1e0)],'payload':{'query':_0x200696(0x229)}})),_0x1f86fe[_0x200696(0x102)](JSON[_0x200696(0x139)]({'id':0x2,'type':_0x5e0280[_0x200696(0x1eb)]})),_0x1f86fe['on'](_0x200696(0x164),_0x2280cc=>{const _0x470d43=_0x200696;if(_0x2b6ebc[_0x470d43(0x136)](_0x2b6ebc[_0x470d43(0x197)],_0x2b6ebc['WVFlz'])){const _0xdac2e=JSON[_0x470d43(0x221)](_0x2280cc);if(_0xdac2e['id']===0x1&&_0x2b6ebc['gfxUY'](_0xdac2e[_0x470d43(0x19d)],_0x2b6ebc[_0x470d43(0x131)]))_0x54c966['ok'](!_0xdac2e['payload'][_0x470d43(0x164)][_0x470d43(0x183)][_0x470d43(0x167)][_0x470d43(0x182)](_0x2b6ebc['vqeqx'])),_0x1f86fe[_0x470d43(0x25c)]();else _0x2b6ebc[_0x470d43(0x136)](_0xdac2e['id'],0x2)&&_0xdac2e[_0x470d43(0x19d)]===_0x2b6ebc[_0x470d43(0x13e)]&&(_0xe9f0df[_0x470d43(0x155)]({'method':_0x2b6ebc[_0x470d43(0x1ea)],'url':_0x470d43(0x178),'body':{'query':_0x470d43(0x10a)}},()=>{const _0x8c523d=_0x470d43;if(_0x8c523d(0xfd)!==_0x2b6ebc['SJQOt'])_0x54c966[_0x8c523d(0x1c5)]();else{if(!_0x1465bd)return!![];return _0x7e297d[_0x8c523d(0x183)]['message'][_0x8c523d(0x182)](_0x5c4bff);}}),_0xe9f0df[_0x470d43(0x155)]({'method':_0x470d43(0x1d9),'url':_0x2b6ebc[_0x470d43(0x244)],'body':{'query':_0x470d43(0x1cc)}},()=>{const _0xc6770d=_0x470d43;_0x54c966[_0xc6770d(0x1c5)]();}));}else{const _0x11b329={'NwTTY':function(_0x11403f,_0x144b83){return _0x11403f+_0x144b83;},'GkzGK':_0x470d43(0x250),'fKCpu':_0x470d43(0x178),'fIEDi':_0x470d43(0x181),'vKWTs':_0x2b6ebc['yEzOv'],'BPPEE':_0x2b6ebc['IcYfK']},_0x49faec=_0x2b6ebc[_0x470d43(0x207)](_0x43bf7f);_0x30b1e8[_0x470d43(0x1f9)](()=>_0x49faec[_0x470d43(0x1ef)]());const _0x487276=_0x470d43(0x1e4),_0x475f4e={'Query':{'add':(_0x508a2d,{x:_0x57bf81,y:_0x400d3d})=>_0x57bf81+_0x400d3d}};_0x49faec['register'](_0x45cb50,{'schema':_0x487276,'resolvers':_0x475f4e,'subscription':!![]}),_0x49faec['listen']({'port':0x0},_0x38ca8d=>{const _0x1941fb=_0x470d43,_0x291c7b={'hNKHT':_0x1941fb(0x22b)};_0x3cfda7[_0x1941fb(0x23a)](_0x38ca8d);const _0x10d4bd=_0x11b329[_0x1941fb(0x1f1)](_0x11b329[_0x1941fb(0x20b)],_0x49faec[_0x1941fb(0x19a)][_0x1941fb(0x140)]()[_0x1941fb(0x265)])+_0x11b329[_0x1941fb(0x203)],_0xfbb2f9=new _0x574bcc(_0x10d4bd,_0x11b329['fIEDi']),_0x1e4e1f=_0x368a87['createWebSocketStream'](_0xfbb2f9,{'encoding':_0x11b329[_0x1941fb(0x22e)],'objectMode':!![]});_0x68798f[_0x1941fb(0x1f9)](_0x1e4e1f[_0x1941fb(0x26e)][_0x1941fb(0x237)](_0x1e4e1f)),_0x1e4e1f[_0x1941fb(0x1d5)](_0x11b329['vKWTs']),_0x1e4e1f['write'](_0x49f123[_0x1941fb(0x139)]({'type':_0x1941fb(0x193)})),_0x1e4e1f['on'](_0x11b329['BPPEE'],_0x3d9dca=>{const _0x2f6520=_0x1941fb;_0x103f5c[_0x2f6520(0x179)](_0x3d9dca,_0x868db8[_0x2f6520(0x139)]({'type':_0x291c7b[_0x2f6520(0x190)]})),_0x1e4e1f[_0x2f6520(0x25c)](),_0x7b141a[_0x2f6520(0x25c)]();});});}});});}),test(_0x5a83ac(0x1dd),_0x33208c=>{const _0x5a513f=_0x5a83ac,_0x5c9b17={'xCVzh':_0x5a513f(0x1b6),'dkjBQ':function(_0x287d27,_0x4a5d03){return _0x287d27===_0x4a5d03;},'antqz':_0x5a513f(0x164),'MeGSe':'filtered','ZAbiN':'POST','ZMXak':_0x5a513f(0x23a),'eGKIC':function(_0x374058,_0x1323d3){return _0x374058===_0x1323d3;},'CgRHM':_0x5a513f(0x266),'zxwkp':function(_0x311df3,_0x1330f7){return _0x311df3+_0x1330f7;},'nYglV':_0x5a513f(0x181),'NrbXm':_0x5a513f(0x1cb),'EeRbh':'start','RryfM':_0x5a513f(0x226),'HMrCs':function(_0x58a44e,_0x2627b3,_0x3c616a){return _0x58a44e(_0x2627b3,_0x3c616a);}};_0x33208c['plan'](0x4);const _0x14ac87=Fastify();_0x33208c['teardown'](()=>_0x14ac87[_0x5a513f(0x1ef)]());const {withFilter:_0x510b3d}=GQL;let _0xf8daa6=0x0;const _0x489217=[],_0x57e95e=_0x5a513f(0x115),_0x2256fa={'Query':{'notifications':()=>_0x489217},'Mutation':{'addNotification':async(_0x54a9ef,{message:_0x1740e4},{pubsub:_0x252d5d})=>{const _0x10f0c6=_0x5a513f,_0x28182d=_0xf8daa6++,_0x564483={'id':_0x28182d,'message':_0x1740e4};_0x489217['push'](_0x564483),await _0x252d5d[_0x10f0c6(0x1c2)]({'topic':_0x5c9b17[_0x10f0c6(0x233)],'payload':{'notificationAdded':_0x564483}});}},'Subscription':{'notificationAdded':{'subscribe':_0x5c9b17[_0x5a513f(0x22d)](_0x510b3d,(_0x1942d3,_0x2438b7,{pubsub:_0x100325})=>_0x100325[_0x5a513f(0x16b)](_0x5a513f(0x1b6)),async(_0x2eda66,{contains:_0x4db636})=>{const _0x2676fb=_0x5a513f;if(!_0x4db636)return!![];return _0x2eda66[_0x2676fb(0x183)][_0x2676fb(0x167)][_0x2676fb(0x182)](_0x4db636);})}}};_0x14ac87[_0x5a513f(0x1c9)](GQL,{'schema':_0x57e95e,'resolvers':_0x2256fa,'subscription':!![]}),_0x14ac87[_0x5a513f(0x120)]({'port':0x0},_0x9e7fda=>{const _0x3b4ad0=_0x5a513f,_0x395f6d={'ZwBhy':_0x5c9b17[_0x3b4ad0(0x177)]};if(_0x5c9b17[_0x3b4ad0(0x1f7)](_0x5c9b17[_0x3b4ad0(0x249)],'bfyyU')){const _0x3d9957=_0x2fe6af[_0x3b4ad0(0x221)](_0x252cec);_0x3d9957['id']===0x1&&_0x3d9957[_0x3b4ad0(0x19d)]===_0x395f6d[_0x3b4ad0(0x1d7)]&&(_0x2de98d['equal'](_0x87ae1,_0x3f457d[_0x3b4ad0(0x139)]({'type':_0x395f6d[_0x3b4ad0(0x1d7)],'id':0x1,'payload':_0x3b4ad0(0x1b9)})),_0x3506b6[_0x3b4ad0(0x25c)](),_0x3cc751[_0x3b4ad0(0x25c)]());}else{_0x33208c[_0x3b4ad0(0x23a)](_0x9e7fda);const _0x1bbd68=new WebSocket(_0x5c9b17[_0x3b4ad0(0x141)](_0x5c9b17[_0x3b4ad0(0x141)]('ws://localhost:',_0x14ac87[_0x3b4ad0(0x19a)][_0x3b4ad0(0x140)]()[_0x3b4ad0(0x265)]),'/graphql'),_0x5c9b17[_0x3b4ad0(0x12d)]),_0x42121c=WebSocket[_0x3b4ad0(0x1fd)](_0x1bbd68,{'encoding':_0x5c9b17[_0x3b4ad0(0x18c)],'objectMode':!![]});_0x33208c[_0x3b4ad0(0x1f9)](_0x42121c[_0x3b4ad0(0x26e)][_0x3b4ad0(0x237)](_0x42121c)),_0x42121c[_0x3b4ad0(0x1d5)](_0x5c9b17[_0x3b4ad0(0x18c)]),_0x42121c[_0x3b4ad0(0x102)](JSON[_0x3b4ad0(0x139)]({'type':_0x3b4ad0(0x193)})),_0x42121c[_0x3b4ad0(0x102)](JSON[_0x3b4ad0(0x139)]({'id':0x1,'type':_0x5c9b17[_0x3b4ad0(0x222)],'payload':{'query':_0x3b4ad0(0x13a)}})),_0x42121c[_0x3b4ad0(0x102)](JSON['stringify']({'id':0x2,'type':_0x5c9b17['EeRbh'],'payload':{'query':_0x3b4ad0(0x229)}})),_0x42121c[_0x3b4ad0(0x102)](JSON[_0x3b4ad0(0x139)]({'id':0x2,'type':_0x5c9b17[_0x3b4ad0(0x166)]})),_0x42121c['on'](_0x5c9b17[_0x3b4ad0(0x187)],_0x4b610f=>{const _0xe05223=_0x3b4ad0,_0x2cf442=JSON[_0xe05223(0x221)](_0x4b610f);if(_0x5c9b17[_0xe05223(0xfa)](_0x2cf442['id'],0x1)&&_0x2cf442['type']===_0x5c9b17[_0xe05223(0x187)])_0x33208c['ok'](!_0x2cf442['payload']['data'][_0xe05223(0x183)][_0xe05223(0x167)][_0xe05223(0x182)](_0x5c9b17[_0xe05223(0x210)])),_0x42121c['end']();else _0x5c9b17[_0xe05223(0xfa)](_0x2cf442['id'],0x2)&&_0x2cf442[_0xe05223(0x19d)]==='complete'&&(_0x14ac87[_0xe05223(0x155)]({'method':_0x5c9b17['ZAbiN'],'url':_0xe05223(0x178),'body':{'query':_0xe05223(0x10a)}},()=>{const _0x405df3=_0xe05223;_0x33208c[_0x405df3(0x1c5)]();}),_0x14ac87['inject']({'method':_0x5c9b17[_0xe05223(0x1b7)],'url':_0xe05223(0x178),'body':{'query':_0xe05223(0x1cc)}},()=>{_0x33208c['pass']();}));});}});}),test('subscription\x20server\x20works\x20with\x20fastify\x20websocket',_0x7286a3=>{const _0x4bef46=_0x5a83ac,_0x183745={'zkTkD':_0x4bef46(0x167),'QYbOg':'/fastify-websocket','RwlaP':_0x4bef46(0x1d9),'UCfIt':_0x4bef46(0x178),'fjhAH':_0x4bef46(0x238),'WUEEa':_0x4bef46(0x1f3),'YdlWT':function(_0x29bb7b,_0x443eeb){return _0x29bb7b+_0x443eeb;},'pttOi':_0x4bef46(0x250),'ETsQe':_0x4bef46(0x1cb),'fLIDp':_0x4bef46(0x164),'eTNyg':_0x4bef46(0x193),'cjiUP':function(_0xb3b7c3){return _0xb3b7c3();},'cPPjb':function(_0x521382){return _0x521382();}},_0xe9bc4e=_0x183745['cjiUP'](Fastify);_0x7286a3['teardown'](()=>_0xe9bc4e[_0x4bef46(0x1ef)]()),_0x7286a3[_0x4bef46(0x24b)](0x3),_0xe9bc4e[_0x4bef46(0x1c9)](fastifyWebsocket,{'options':{'maxPayload':0x100000}}),_0xe9bc4e[_0x4bef46(0x1c9)](async function(_0x5bf09d){const _0x1bca66=_0x4bef46;_0x1bca66(0x17b)!==_0x1bca66(0x17b)?_0x4db315():_0x5bf09d[_0x1bca66(0x214)](_0x183745['QYbOg'],{'websocket':!![]},(_0x3f73f6,_0x53b3c1)=>{const _0x5be00a=_0x1bca66;_0x3f73f6[_0x5be00a(0x269)]['on'](_0x183745['zkTkD'],_0x44b828=>{const _0x4e84cc=_0x5be00a;_0x3f73f6[_0x4e84cc(0x269)]['send'](_0x4e84cc(0x175));});});});const _0x5f51f6=()=>{const _0x34d62c=_0x4bef46;_0xe9bc4e['inject']({'method':_0x183745[_0x34d62c(0xf5)],'url':_0x183745[_0x34d62c(0x1d1)],'body':{'query':_0x34d62c(0x1b0)}});},_0xaf18f2=_0x183745[_0x4bef46(0x230)](mq),_0x235c43=_0x4bef46(0x145);let _0x2bfac1=0x1;const _0xb13ece=[{'id':_0x2bfac1,'message':_0x4bef46(0x18b)}],_0x28d9f7={'Query':{'notifications':()=>_0xb13ece},'Mutation':{'addNotification':async(_0x3a44c8,{message:_0x32e35e})=>{const _0x895307=_0x4bef46,_0xca0ea5=_0x2bfac1++,_0x434963={'id':_0xca0ea5,'message':_0x32e35e};return _0xb13ece[_0x895307(0x1f5)](_0x434963),await _0xaf18f2[_0x895307(0x1fb)]({'topic':'NOTIFICATION_ADDED','payload':{'notificationAdded':_0x434963}}),_0x434963;}},'Subscription':{'notificationAdded':{'subscribe':(_0x2392e0,_0x2f76aa,{pubsub:_0x25c1ed})=>_0x25c1ed['subscribe'](_0x4bef46(0x1b6))}}};_0xe9bc4e['register'](GQL,{'schema':_0x235c43,'resolvers':_0x28d9f7,'subscription':{'emitter':_0xaf18f2}}),_0xe9bc4e['listen']({'port':0x0},_0x19d9c0=>{const _0x1eae95=_0x4bef46,_0x2ca286={'bENtP':_0x1eae95(0x175),'unAWe':_0x183745[_0x1eae95(0x1c0)],'syKLD':function(_0x39f5bf,_0x5413b1){return _0x39f5bf===_0x5413b1;},'LcyxU':_0x183745[_0x1eae95(0x218)]};_0x7286a3['error'](_0x19d9c0);const _0x3d893b=new WebSocket(_0x183745['YdlWT'](_0x183745[_0x1eae95(0x17d)]+_0xe9bc4e[_0x1eae95(0x19a)]['address']()[_0x1eae95(0x265)],_0x183745['QYbOg'])),_0x3d5ab3=WebSocket['createWebSocketStream'](_0x3d893b,{'encoding':'utf8','objectMode':!![]});_0x7286a3[_0x1eae95(0x1f9)](_0x3d5ab3[_0x1eae95(0x26e)][_0x1eae95(0x237)](_0x3d5ab3)),_0x3d5ab3['setEncoding'](_0x1eae95(0x1cb));const _0x22b962=new WebSocket(_0x183745[_0x1eae95(0x17d)]+_0xe9bc4e[_0x1eae95(0x19a)][_0x1eae95(0x140)]()[_0x1eae95(0x265)]+_0x183745[_0x1eae95(0x1d1)],_0x1eae95(0x181)),_0x4e06f3=WebSocket['createWebSocketStream'](_0x22b962,{'encoding':'utf8','objectMode':!![]});_0x7286a3['teardown'](_0x4e06f3['destroy']['bind'](_0x4e06f3)),_0x4e06f3[_0x1eae95(0x1d5)](_0x183745[_0x1eae95(0x171)]),_0x3d5ab3['on'](_0x183745[_0x1eae95(0x1ee)],_0x3b94dd=>{const _0x34af86=_0x1eae95;_0x7286a3[_0x34af86(0x179)](_0x3b94dd,_0x2ca286[_0x34af86(0x21a)]),_0x3d5ab3[_0x34af86(0x25c)]();}),_0x4e06f3['on'](_0x183745[_0x1eae95(0x1ee)],_0x422da8=>{const _0x5ee8c0=_0x1eae95,_0x1716d3={'BWdRy':_0x5ee8c0(0x1d9)};if(_0x2ca286[_0x5ee8c0(0x122)]!==_0x2ca286[_0x5ee8c0(0x122)])_0x3e150f[_0x5ee8c0(0x155)]({'method':_0x1716d3['BWdRy'],'url':_0x5ee8c0(0x178),'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20query\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notifications\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{_0x4e863a();});else{const _0x37a348=JSON[_0x5ee8c0(0x221)](_0x422da8);if(_0x2ca286[_0x5ee8c0(0x14c)](_0x37a348[_0x5ee8c0(0x19d)],'data'))_0x7286a3['equal'](_0x422da8,JSON[_0x5ee8c0(0x139)]({'type':_0x5ee8c0(0x164),'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x2ca286[_0x5ee8c0(0x11e)]}}}})),_0x4e06f3['end']();else{if(_0x5ee8c0(0x196)===_0x5ee8c0(0x1d0)){const _0x3ca355=_0x2caa92=>{const _0x2be348=_0x5ee8c0;_0x5df4fb[_0x2be348(0x1f5)](_0x2caa92);},_0x3b4273=()=>{const _0x4d75db=_0x5ee8c0;this[_0x4d75db(0xfe)]['removeListener'](_0x3a0b61,_0x3ca355);};this[_0x5ee8c0(0xfe)]['on'](_0x416108,_0x3ca355),_0x483794[_0x5ee8c0(0x1ef)]=_0x3b4273;}else _0x5f51f6();}}}),_0x3d5ab3['write']('hi\x20from\x20client'),_0x4e06f3[_0x1eae95(0x102)](JSON['stringify']({'type':_0x183745['eTNyg']})),_0x4e06f3[_0x1eae95(0x102)](JSON[_0x1eae95(0x139)]({'id':0x1,'type':_0x1eae95(0x20e),'payload':{'query':_0x1eae95(0x26d)}}));});}),test(_0x5a83ac(0x1f2),_0xa921de=>{const _0x3c5aba=_0x5a83ac,_0x426c1f={'DXYZb':_0x3c5aba(0x1d9),'EYGqX':_0x3c5aba(0x178),'aaxUd':function(_0x494e99,_0x164570){return _0x494e99+_0x164570;},'fRSay':function(_0x471ce4){return _0x471ce4();},'eoQeT':function(_0x1258c5,_0x10b851){return _0x1258c5===_0x10b851;},'FNEJG':_0x3c5aba(0x1d4),'QyHTf':_0x3c5aba(0x104),'cbpuD':function(_0x14e09c,_0x2bf14f){return _0x14e09c+_0x2bf14f;},'uFBoX':'utf8','CAePz':_0x3c5aba(0x20e),'nJiCy':_0x3c5aba(0x226),'vVXFi':_0x3c5aba(0x164),'BFxQn':function(_0x59b27d){return _0x59b27d();}},_0x11afa9=_0x426c1f['fRSay'](Fastify);_0xa921de['teardown'](async()=>{await _0x11afa9['close']();});const _0xe35246=()=>{const _0x10081e=_0x3c5aba;_0x11afa9[_0x10081e(0x155)]({'method':_0x426c1f[_0x10081e(0x1a5)],'url':_0x426c1f['EYGqX'],'body':{'query':_0x10081e(0x1b0)}},()=>{});},_0x33913e=_0x426c1f[_0x3c5aba(0x1bc)](mq),_0x15f3ac=_0x3c5aba(0x145);let _0x30ae6d=0x1;const _0x17179d=[{'id':_0x30ae6d,'message':'Notification\x20message'}],_0x15b8d7={'Notification':{'message':async(_0x576e90,_0x117638)=>{const _0x29c436=_0x3c5aba;_0xa921de['ok'](_0x117638,_0x29c436(0x275));const {username:_0x362cc2}=_0x117638;return _0x576e90[_0x29c436(0x138)](({obj:_0x5b0aa1})=>_0x5b0aa1[_0x29c436(0x167)]+'\x20'+_0x362cc2);}}},_0x5a5f0a={'Query':{'notifications':()=>_0x17179d},'Mutation':{'addNotification':async(_0x3c9493,{message:_0x1682f7})=>{const _0x221940=_0x3c5aba,_0x4e3b6a=_0x30ae6d++,_0x32576c={'id':_0x4e3b6a,'message':_0x1682f7};return _0x17179d['push'](_0x32576c),await _0x33913e[_0x221940(0x1fb)]({'topic':_0x221940(0x1b6),'payload':{'notificationAdded':_0x32576c}}),_0x32576c;}},'Subscription':{'notificationAdded':{'subscribe':(_0xeb9162,_0x8a2ef7,{pubsub:_0x175051,topic:_0x31a6af})=>_0x175051[_0x3c5aba(0x16b)](_0x31a6af)}}};_0x11afa9['register'](GQL,{'schema':_0x15f3ac,'resolvers':_0x5a5f0a,'loaders':_0x15b8d7,'subscription':{'emitter':_0x33913e,'context':()=>({'topic':_0x3c5aba(0x1b6),'username':_0x3c5aba(0x1d3)})}}),_0x11afa9[_0x3c5aba(0x120)]({'port':0x0},_0x558df9=>{const _0x2306c3=_0x3c5aba,_0x1f33a4={'GHwHS':function(_0x5ba654,_0x1821ab){const _0x1d2c23=_0x1b52;return _0x426c1f[_0x1d2c23(0x15c)](_0x5ba654,_0x1821ab);},'BguuS':function(_0x1e46ae,_0x454f9f){const _0x149032=_0x1b52;return _0x426c1f[_0x149032(0x15c)](_0x1e46ae,_0x454f9f);},'ZXNSk':_0x426c1f[_0x2306c3(0x15d)],'KMTwD':function(_0x1ef21d){const _0x4c5f1f=_0x2306c3;return _0x426c1f[_0x4c5f1f(0x157)](_0x1ef21d);}};if(_0x2306c3(0x104)===_0x426c1f[_0x2306c3(0xf8)]){_0xa921de['error'](_0x558df9);const _0x4a4db7=new WebSocket(_0x426c1f[_0x2306c3(0x21d)](_0x2306c3(0x250)+_0x11afa9['server']['address']()['port'],_0x426c1f[_0x2306c3(0x125)]),_0x2306c3(0x181)),_0xf70f86=WebSocket[_0x2306c3(0x1fd)](_0x4a4db7,{'encoding':_0x426c1f['uFBoX'],'objectMode':!![]});_0xa921de[_0x2306c3(0x1f9)](_0xf70f86['destroy']['bind'](_0xf70f86)),_0xf70f86['setEncoding']('utf8'),_0xf70f86[_0x2306c3(0x102)](JSON[_0x2306c3(0x139)]({'type':_0x2306c3(0x193)})),_0xf70f86[_0x2306c3(0x102)](JSON[_0x2306c3(0x139)]({'id':0x1,'type':_0x426c1f['CAePz'],'payload':{'query':_0x2306c3(0x26d)}})),_0xf70f86['write'](JSON['stringify']({'id':0x2,'type':_0x2306c3(0x20e),'payload':{'query':_0x2306c3(0x26d)}})),_0xf70f86[_0x2306c3(0x102)](JSON[_0x2306c3(0x139)]({'id':0x2,'type':_0x426c1f['nJiCy']})),_0xf70f86['on'](_0x426c1f[_0x2306c3(0x262)],_0x5a8ff4=>{const _0x3da6ce=_0x2306c3,_0x14764b=JSON[_0x3da6ce(0x221)](_0x5a8ff4);if(_0x14764b['id']===0x1&&_0x1f33a4[_0x3da6ce(0x152)](_0x14764b['type'],_0x3da6ce(0x164)))_0xa921de[_0x3da6ce(0x179)](_0x5a8ff4,JSON[_0x3da6ce(0x139)]({'type':_0x3da6ce(0x164),'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x3da6ce(0x248)}}}})),_0xf70f86['end'](),_0xa921de[_0x3da6ce(0x25c)]();else _0x14764b['id']===0x2&&_0x1f33a4[_0x3da6ce(0x227)](_0x14764b[_0x3da6ce(0x19d)],_0x1f33a4[_0x3da6ce(0x15a)])&&_0x1f33a4[_0x3da6ce(0x126)](_0xe35246);});}else{const _0x21a84b={'UQAIt':function(_0x3c0a78,_0x116cb9){return _0x3c0a78+_0x116cb9;},'cMDiS':function(_0x2c0a40,_0x44caf0){const _0x4014f2=_0x2306c3;return _0x426c1f[_0x4014f2(0x124)](_0x2c0a40,_0x44caf0);},'wDNZZ':_0x426c1f[_0x2306c3(0x125)],'oRZAh':_0x2306c3(0x1d3),'qAOXP':_0x2306c3(0x1cb)},_0x5eda05=_0x426c1f[_0x2306c3(0x157)](_0x352497),_0x498b6f=_0x2306c3(0x1e4),_0x5c8efb={'add':async({x:_0x7e4f50,y:_0x2fa0f0})=>_0x7e4f50+_0x2fa0f0};_0x3f110e['teardown'](_0x5eda05['close']),_0x5eda05[_0x2306c3(0x1c9)](_0xe17b6b,{'schema':_0x498b6f,'resolvers':_0x5c8efb,'subscription':!![]}),_0x5eda05[_0x2306c3(0x120)]({'port':0x0},()=>{const _0x182f13=_0x2306c3,_0x2218cb=_0x21a84b[_0x182f13(0x198)](_0x21a84b['cMDiS'](_0x182f13(0x250),_0x5eda05[_0x182f13(0x19a)][_0x182f13(0x140)]()[_0x182f13(0x265)]),_0x21a84b[_0x182f13(0x161)]),_0x393b7d=new _0x349f4f(_0x2218cb,_0x21a84b['oRZAh']),_0x411fe2=_0x2d2d29[_0x182f13(0x1fd)](_0x393b7d,{'encoding':_0x21a84b[_0x182f13(0x25b)],'objectMode':!![]});_0x46e8f7[_0x182f13(0x1f9)](_0x411fe2[_0x182f13(0x26e)][_0x182f13(0x237)](_0x411fe2)),_0x411fe2[_0x182f13(0x1d5)](_0x182f13(0x1cb)),_0x393b7d['on'](_0x182f13(0x1ef),()=>{const _0x32696c=_0x182f13;_0x411fe2[_0x32696c(0x25c)](),_0x59822d[_0x32696c(0x25c)]();});});}});}),test(_0x5a83ac(0x216),_0x3bf8b4=>{const _0x2ce66e=_0x5a83ac,_0x3224b5={'lbRQc':'POST','FcywN':_0x2ce66e(0x1b6),'jvLIX':_0x2ce66e(0x251),'LNreh':'kaboom','yttJE':_0x2ce66e(0xf7),'ngyGx':function(_0x45e4f3,_0x3522c7){return _0x45e4f3+_0x3522c7;},'LbQgo':_0x2ce66e(0x250),'YhwKQ':'connection_init','gFZoW':_0x2ce66e(0x20e),'CgygD':function(_0x4e40d7){return _0x4e40d7();},'KhftY':'foo','cvAry':'Notification\x20message'},_0x14552a=_0x3224b5[_0x2ce66e(0x127)](Fastify);_0x3bf8b4['teardown'](()=>_0x14552a[_0x2ce66e(0x1ef)]());const _0x2b7c68=()=>{const _0x287c96=_0x2ce66e;_0x14552a[_0x287c96(0x155)]({'method':'POST','url':_0x287c96(0x178),'body':{'query':_0x287c96(0x153)}},()=>{_0x48797b();});},_0x48797b=()=>{const _0x363de3=_0x2ce66e;_0x14552a[_0x363de3(0x155)]({'method':_0x3224b5[_0x363de3(0x158)],'url':_0x363de3(0x178),'body':{'query':_0x363de3(0x1b0)}},()=>{});},_0x3022ab=mq(),_0x56e4ec=_0x2ce66e(0x145);_0x14552a[_0x2ce66e(0x1a6)](_0x3224b5[_0x2ce66e(0x25a)],function(){return'bar';});let _0x1723ce=0x1;const _0x241ff3=[{'id':_0x1723ce,'message':_0x3224b5['cvAry']}],_0x2285fb={'Query':{'notifications':()=>_0x241ff3},'Mutation':{'addNotification':async(_0x110f19,{message:_0x21c19a})=>{const _0xbd177e=_0x2ce66e,_0xa99a05=_0x1723ce++,_0x34e286={'id':_0xa99a05,'message':_0x21c19a};return _0x241ff3[_0xbd177e(0x1f5)](_0x34e286),await _0x3022ab[_0xbd177e(0x1fb)]({'topic':_0x3224b5[_0xbd177e(0x273)],'payload':{'notificationAdded':_0x34e286}}),_0x34e286;}},'Subscription':{'notificationAdded':{'subscribe':(_0x3c7404,_0xb37038,_0x5759f5)=>{const _0x2ebdf8=_0x2ce66e;return _0x3bf8b4['equal'](_0x5759f5[_0x2ebdf8(0x14b)][_0x2ebdf8(0x20a)][_0x2ebdf8(0x1b3)](),_0x2ebdf8(0xfc)),_0x3bf8b4['equal'](_0x5759f5[_0x2ebdf8(0x14b)][_0x2ebdf8(0x20a)][_0x2ebdf8(0x105)]['authorization'],_0x3224b5['jvLIX']),_0x5759f5[_0x2ebdf8(0x1f8)]['subscribe'](_0x2ebdf8(0x1b6));}}}};_0x14552a[_0x2ce66e(0x1c9)](GQL,{'schema':_0x56e4ec,'resolvers':_0x2285fb,'subscription':{'emitter':_0x3022ab}}),_0x14552a[_0x2ce66e(0x120)]({'port':0x0},_0x406883=>{const _0x422a2d=_0x2ce66e,_0x186d35={'bZLmj':function(_0x3a1cfd,_0x5ef0a7){return _0x3a1cfd===_0x5ef0a7;},'BqBUb':_0x422a2d(0x20c),'AkFVk':_0x422a2d(0x164),'QHYsW':'complete','uMVnU':function(_0x1fd8e9){return _0x1fd8e9();}};if(_0x3224b5['yttJE']!=='imudA'){_0x3bf8b4[_0x422a2d(0x23a)](_0x406883);const _0x230171=new WebSocket(_0x3224b5['ngyGx'](_0x3224b5[_0x422a2d(0x17f)],_0x14552a['server']['address']()['port'])+'/graphql',_0x422a2d(0x181)),_0x3b7981=WebSocket[_0x422a2d(0x1fd)](_0x230171,{'encoding':_0x422a2d(0x1cb),'objectMode':!![]});_0x3bf8b4['teardown'](_0x3b7981[_0x422a2d(0x26e)][_0x422a2d(0x237)](_0x3b7981)),_0x3b7981['setEncoding'](_0x422a2d(0x1cb)),_0x3b7981[_0x422a2d(0x102)](JSON[_0x422a2d(0x139)]({'type':_0x3224b5[_0x422a2d(0x223)],'payload':{'headers':{'authorization':_0x3224b5[_0x422a2d(0x270)]}}})),_0x3b7981[_0x422a2d(0x102)](JSON[_0x422a2d(0x139)]({'id':0x1,'type':_0x3224b5[_0x422a2d(0x10c)],'payload':{'query':_0x422a2d(0x26d)}})),_0x3b7981[_0x422a2d(0x102)](JSON['stringify']({'id':0x2,'type':_0x3224b5[_0x422a2d(0x10c)],'payload':{'query':_0x422a2d(0x26d)}})),_0x3b7981[_0x422a2d(0x102)](JSON[_0x422a2d(0x139)]({'id':0x2,'type':_0x422a2d(0x226)})),_0x3b7981['on']('data',_0x18736a=>{const _0x308f80=_0x422a2d,_0x35259e={'GnWZu':_0x308f80(0x164),'sESyy':_0x308f80(0x1f3)},_0xa08555=JSON['parse'](_0x18736a);if(_0x186d35[_0x308f80(0x261)](_0xa08555['id'],0x1)&&_0xa08555['type']===_0x308f80(0x164))_0x186d35['BqBUb']===_0x308f80(0x22c)?(_0xe1ab7a[_0x308f80(0x179)](_0x450a1b,_0x98cf05[_0x308f80(0x139)]({'type':_0x35259e[_0x308f80(0x253)],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x35259e[_0x308f80(0x16c)]}}}})),_0x14d16d[_0x308f80(0x25c)](),_0x501e09[_0x308f80(0x25c)]()):(_0x3bf8b4[_0x308f80(0x179)](_0x18736a,JSON[_0x308f80(0x139)]({'type':_0x186d35[_0x308f80(0x156)],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':_0x308f80(0x1f3)}}}})),_0x3b7981[_0x308f80(0x25c)](),_0x3bf8b4[_0x308f80(0x25c)]());else _0xa08555['id']===0x2&&_0xa08555['type']===_0x186d35[_0x308f80(0x1ed)]&&_0x186d35['uMVnU'](_0x2b7c68);});}else throw new _0x1d5bd2(_0x3224b5[_0x422a2d(0x128)]);});}),test(_0x5a83ac(0x255),_0x63900f=>{const _0x1003c9=_0x5a83ac,_0x3ba6cf={'neGyS':_0x1003c9(0x20e),'faTtD':_0x1003c9(0x1d9),'FUIgO':'HQnaE','LnolF':_0x1003c9(0x257),'vagJb':_0x1003c9(0x178),'RBfsy':'bar','irvoc':'NOTIFICATION_ADDED','mqLKE':'Bearer\x20foobar','bYwWO':function(_0x38b74a,_0x27ea61){return _0x38b74a===_0x27ea61;},'YtDJb':_0x1003c9(0x164),'DwxcX':function(_0xee70d7,_0x506c3a){return _0xee70d7+_0x506c3a;},'yKXfD':_0x1003c9(0x250),'dGPtO':'graphql-ws','nwuki':_0x1003c9(0x1cb),'OwhyV':function(_0x2911f5){return _0x2911f5();},'HRmTS':function(_0x300159){return _0x300159();},'Wcqoa':_0x1003c9(0x1b3)},_0x564b72=_0x3ba6cf[_0x1003c9(0x206)](Fastify);_0x63900f['teardown'](()=>_0x564b72[_0x1003c9(0x1ef)]());const _0x45f8be=()=>{const _0x483d7f=_0x1003c9,_0xd65d65={'qtcSq':_0x3ba6cf[_0x483d7f(0x242)],'guixf':_0x483d7f(0x178),'RwSfo':function(_0x3c1b13,_0x533c8f){return _0x3c1b13===_0x533c8f;},'iQKKS':_0x3ba6cf[_0x483d7f(0x1f0)],'Bhsid':_0x483d7f(0x267)};if(_0x3ba6cf[_0x483d7f(0x239)]===_0x483d7f(0x257))_0x564b72[_0x483d7f(0x155)]({'method':_0x483d7f(0x1d9),'url':_0x3ba6cf['vagJb'],'body':{'query':_0x483d7f(0x153)}},()=>{const _0x294f2c=_0x483d7f,_0x325a43={'biQuu':_0xd65d65[_0x294f2c(0x24f)],'admyP':_0xd65d65[_0x294f2c(0x1e6)]};_0xd65d65[_0x294f2c(0x208)](_0xd65d65[_0x294f2c(0x11c)],_0xd65d65[_0x294f2c(0x1b8)])?_0x5c4ccb[_0x294f2c(0x155)]({'method':_0x325a43[_0x294f2c(0x245)],'url':_0x325a43[_0x294f2c(0x1d2)],'body':{'query':_0x294f2c(0x153)}},()=>{_0x3e50cb();}):_0x1632ea();});else{const _0x4fd212=_0x2a48fc['parse'](_0x48b1be);_0x4fd212[_0x483d7f(0x19d)]===_0x483d7f(0x22b)&&(_0x344765[_0x483d7f(0x102)](_0x187c42[_0x483d7f(0x139)]({'id':0x1,'type':_0x3ba6cf[_0x483d7f(0x1c8)],'payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'},'extensions':[{'type':_0x483d7f(0x172)}]})),_0xc423bf['end']());}},_0x1632ea=()=>{const _0x233cfc=_0x1003c9;_0x564b72['inject']({'method':_0x3ba6cf[_0x233cfc(0x242)],'url':_0x3ba6cf[_0x233cfc(0x1a2)],'body':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20mutation\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20addNotification(message:\x20\x22Hello\x20World\x22)\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}},()=>{});},_0xfa2fc9=_0x3ba6cf[_0x1003c9(0x228)](mq),_0x3f8c52=_0x1003c9(0x145);_0x564b72[_0x1003c9(0x1a6)](_0x3ba6cf['Wcqoa'],function(){const _0x29c4a7=_0x1003c9;if('jZapX'===_0x29c4a7(0x10e))return _0x3ba6cf['RBfsy'];else _0x175e30[_0x29c4a7(0x271)]['uninstall']();});let _0xf5d78=0x1;const _0x1f11bb=[{'id':_0xf5d78,'message':_0x1003c9(0x18b)}],_0x4ea7ab={'Query':{'notifications':()=>_0x1f11bb},'Mutation':{'addNotification':async(_0x80f7ee,{message:_0x2ba7fc})=>{const _0x5b4756=_0x1003c9,_0x4c09b1=_0xf5d78++,_0x1fc3ae={'id':_0x4c09b1,'message':_0x2ba7fc};return _0x1f11bb[_0x5b4756(0x1f5)](_0x1fc3ae),await _0xfa2fc9[_0x5b4756(0x1fb)]({'topic':_0x3ba6cf['irvoc'],'payload':{'notificationAdded':_0x1fc3ae}}),_0x1fc3ae;}},'Subscription':{'notificationAdded':{'subscribe':(_0x11dfd7,_0xaf6a10,_0x534f1a)=>{const _0x59b983=_0x1003c9,_0x33c5ff=_0x59b983(0x1bf)['split']('|');let _0x15884c=0x0;while(!![]){switch(_0x33c5ff[_0x15884c++]){case'0':_0x63900f[_0x59b983(0x179)](_0x534f1a[_0x59b983(0x14b)]['request']['foo'](),_0x3ba6cf['RBfsy']);continue;case'1':_0x63900f[_0x59b983(0x179)](_0x534f1a['reply'][_0x59b983(0x20a)][_0x59b983(0x105)]['authorization'],_0x3ba6cf[_0x59b983(0x204)]);continue;case'2':_0x63900f[_0x59b983(0x179)](_0x534f1a[_0x59b983(0x14b)][_0x59b983(0x20a)][_0x59b983(0x105)][_0x59b983(0x232)],Object);continue;case'3':_0x63900f[_0x59b983(0x179)](_0x534f1a[_0x59b983(0x14b)]['request']['headers'][_0x59b983(0x1c7)],{}[_0x59b983(0x1c7)]);continue;case'4':return _0x534f1a['pubsub'][_0x59b983(0x16b)](_0x3ba6cf[_0x59b983(0x1dc)]);}break;}}}}};_0x564b72[_0x1003c9(0x1c9)](GQL,{'schema':_0x3f8c52,'resolvers':_0x4ea7ab,'subscription':{'emitter':_0xfa2fc9}}),_0x564b72[_0x1003c9(0x120)]({'port':0x0},_0x28d8ef=>{const _0x3880af=_0x1003c9,_0x22c769={'VXqVa':function(_0x18c7eb,_0x496340){const _0x3b3c89=_0x1b52;return _0x3ba6cf[_0x3b3c89(0x176)](_0x18c7eb,_0x496340);},'avEwi':_0x3ba6cf[_0x3880af(0x219)],'tgljX':function(_0x308da8,_0x3eefa6){const _0x160502=_0x3880af;return _0x3ba6cf[_0x160502(0x176)](_0x308da8,_0x3eefa6);},'CjOgJ':function(_0xb89a6c,_0x4746ee){return _0xb89a6c===_0x4746ee;},'oNfRH':function(_0xb38ea9){return _0xb38ea9();}};_0x63900f['error'](_0x28d8ef);const _0x2d0b3f=new WebSocket(_0x3ba6cf[_0x3880af(0x1ff)](_0x3ba6cf['yKXfD'],_0x564b72[_0x3880af(0x19a)]['address']()['port'])+_0x3ba6cf[_0x3880af(0x1a2)],_0x3ba6cf['dGPtO']),_0x42a6ca=WebSocket[_0x3880af(0x1fd)](_0x2d0b3f,{'encoding':_0x3ba6cf[_0x3880af(0x1e2)],'objectMode':!![]});_0x63900f[_0x3880af(0x1f9)](_0x42a6ca[_0x3880af(0x26e)]['bind'](_0x42a6ca)),_0x42a6ca['setEncoding'](_0x3880af(0x1cb)),_0x42a6ca[_0x3880af(0x102)](JSON[_0x3880af(0x139)]({'type':_0x3880af(0x193),'payload':{'authorization':_0x3ba6cf[_0x3880af(0x204)],'constructor':'aaa','__proto__':_0x3880af(0x260)}})),_0x42a6ca[_0x3880af(0x102)](JSON[_0x3880af(0x139)]({'id':0x1,'type':_0x3880af(0x20e),'payload':{'query':_0x3880af(0x26d)}})),_0x42a6ca[_0x3880af(0x102)](JSON['stringify']({'id':0x2,'type':_0x3ba6cf['neGyS'],'payload':{'query':'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20subscription\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20notificationAdded\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20id\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20message\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'}})),_0x42a6ca['write'](JSON[_0x3880af(0x139)]({'id':0x2,'type':_0x3880af(0x226)})),_0x42a6ca['on'](_0x3880af(0x164),_0x490e84=>{const _0x2ccce2=_0x3880af,_0x543055=JSON[_0x2ccce2(0x221)](_0x490e84);if(_0x22c769[_0x2ccce2(0x24c)](_0x543055['id'],0x1)&&_0x543055[_0x2ccce2(0x19d)]==='data')_0x63900f[_0x2ccce2(0x179)](_0x490e84,JSON['stringify']({'type':_0x22c769['avEwi'],'id':0x1,'payload':{'data':{'notificationAdded':{'id':'1','message':'Hello\x20World'}}}})),_0x42a6ca[_0x2ccce2(0x25c)](),_0x63900f[_0x2ccce2(0x25c)]();else _0x22c769[_0x2ccce2(0x1c6)](_0x543055['id'],0x2)&&_0x22c769[_0x2ccce2(0x1c4)](_0x543055[_0x2ccce2(0x19d)],_0x2ccce2(0x1d4))&&_0x22c769[_0x2ccce2(0x184)](_0x45f8be);});});}),test(_0x5a83ac(0x1a3),async _0x1949e1=>{const _0x13fa98=_0x5a83ac,_0x5ca2bd={'iBVBK':function(_0x3a5718){return _0x3a5718();},'knPOT':_0x13fa98(0x181),'mYrqU':function(_0x13a191,_0x1301c3,_0x11ba71){return _0x13a191(_0x1301c3,_0x11ba71);}},_0x52f38c=_0x13fa98(0x1e4),_0x398345={'Query':{'add':async(_0x41a2be,{x:_0x3824a3,y:_0x573ea6})=>_0x3824a3+_0x573ea6}},_0x1cc141=_0x5ca2bd[_0x13fa98(0x18a)](Fastify);_0x1cc141[_0x13fa98(0x1c9)](GQL,{'schema':_0x52f38c,'resolvers':_0x398345,'subscription':!![]}),await _0x1cc141[_0x13fa98(0x120)]({'port':0x0}),_0x1949e1[_0x13fa98(0x1f9)](_0x1cc141['close']['bind'](_0x1cc141));const _0x4733fb=new WebSocket('ws://127.0.0.1:'+_0x1cc141[_0x13fa98(0x19a)][_0x13fa98(0x140)]()['port']+'/graphql',_0x5ca2bd[_0x13fa98(0x11d)]);await once(_0x4733fb,_0x13fa98(0x1e3)),_0x4733fb['_socket']['write'](Buffer[_0x13fa98(0x117)]([0xa2,0x0])),await _0x5ca2bd[_0x13fa98(0x10f)](once,_0x4733fb,'close');});