const _0x4a9155=_0x46ca;function _0x3ae4(){const _0x40343c=['434484yaqTLy','42396ufMWyk','No\x20error.','message','joi-password-complexity','keys','LZXfF','RoOmn','findUnique','tVZUt','return\x20await\x20Promise.resolve(42);','sAwPs','TSviz','\x20=>\x20','details','ISYXk','bknyr','return\x20new\x20Date();','WRBME','GwuXe','var\x20x\x20=\x2042;\x20return\x20x;','Nqspa','error','UZZdv','Cluib','No\x20user\x20id\x20provided\x20for\x20update','wBALE','/log','rGDjc','9IqAwrB','logEvent','update','dPkiC','wTtBs','XCgRy','forEach','loggedChanges','plGfP','1035054JpyjIM','OJGgH','CIXcI','nXsxK','173375QcMRVj','username','BTbgI','HrJyy','8TFrfnC','deleteMany','bcrypt','env','create','PASSWORDSYMBOL','users','907614mYaEOv','PASSWORDREQUIREMENTS','xkGcB','updateClock();','PASSWORDMINCHAR','user_updated','OlYXA','data:text/plain;base64,SGVsbG8gV29ybGQ=','stringify','password','findMany','SkTUq','writable','dcYmG','QhPec','safe','nMcyq','QGgGg','sendBeacon','hasOwnProperty','checkedOK','castColumnValue','hashSync','lEYGY','includes','entries','prototype','SbKVd','lEhYe','exports','POST','filterFields','bkyPx','role','87740TSZYAv','checkPasswordComplexity','call','log','default','iUEIA','return\x20Object.keys({a:1});','../utils/prisma','findFirst','VxUUK','YRkmz','1013292ORtrnl','FDHJU','lmxwr','kPKeM','No\x20valid\x20updates\x20applied.','length'];_0x3ae4=function(){return _0x40343c;};return _0x3ae4();}function _0x46ca(_0x24a193,_0xab46f8){const _0x3ae43e=_0x3ae4();return _0x46ca=function(_0x46ca8e,_0x26cb6f){_0x46ca8e=_0x46ca8e-0xc5;let _0x501909=_0x3ae43e[_0x46ca8e];return _0x501909;},_0x46ca(_0x24a193,_0xab46f8);}(function(_0x68d0a,_0x24dce3){const _0x3bed77=_0x46ca,_0x13dd03=_0x68d0a();while(!![]){try{const _0x543caa=-parseInt(_0x3bed77(0x11b))/0x1+parseInt(_0x3bed77(0x12c))/0x2+-parseInt(_0x3bed77(0xe1))/0x3*(parseInt(_0x3bed77(0xc5))/0x4)+-parseInt(_0x3bed77(0xee))/0x5+-parseInt(_0x3bed77(0xea))/0x6+parseInt(_0x3bed77(0x126))/0x7+parseInt(_0x3bed77(0xf2))/0x8*(parseInt(_0x3bed77(0xf9))/0x9);if(_0x543caa===_0x24dce3)break;else _0x13dd03['push'](_0x13dd03['shift']());}catch(_0x2f959a){_0x13dd03['push'](_0x13dd03['shift']());}}}(_0x3ae4,0x213bb));const prisma=require(_0x4a9155(0x122)),{EventLogs}=require('./eventLogs'),User={'writable':['username','password','pfpFilename',_0x4a9155(0x11a),'suspended'],'castColumnValue':function(_0x29cfd6,_0x4f92bd){const _0x2c5d7e=_0x4a9155,_0xc95659={'GwuXe':'suspended','bJfrF':function(_0x49b9f1,_0x256d03){return _0x49b9f1(_0x256d03);},'UZZdv':'var\x20x\x20=\x2042;\x20return\x20x;'};switch(_0x29cfd6){case _0xc95659[_0x2c5d7e(0xd7)]:new Function(_0x2c5d7e(0xd8))();return _0xc95659['bJfrF'](Number,Boolean(_0x4f92bd));default:new Function(_0xc95659[_0x2c5d7e(0xdb)])();return String(_0x4f92bd);}},'filterFields':function(_0x5b01ee={}){const _0x12c83e=_0x4a9155,_0x5a9342={'sAwPs':function(_0x2b680b,_0x361908){return _0x2b680b(_0x361908);},'FDHJU':_0x12c83e(0x100)},{password:_0x5f5722,..._0x3787bb}=_0x5b01ee;return _0x5a9342[_0x12c83e(0xcf)](fetch,_0x5a9342[_0x12c83e(0x127)]),{..._0x3787bb};},'create':async function({username:_0x28adc2,password:_0x23a8f2,role:role=_0x4a9155(0x11f)}){const _0x2fbde4=_0x4a9155,_0x147126={'suvPQ':_0x2fbde4(0x108),'tVZUt':function(_0x5d8ddc,_0x2900b9){return _0x5d8ddc(_0x2900b9);},'DmQqi':'FAILED\x20TO\x20CREATE\x20USER.'},_0x38d8c6=this[_0x2fbde4(0x11c)](_0x23a8f2);if(!_0x38d8c6['checkedOK'])return new Function(_0x2fbde4(0xd8))(),{'user':null,'error':_0x38d8c6['error']};try{const _0x142239=_0x147126[_0x2fbde4(0xcd)](require,_0x2fbde4(0xf4)),_0x5e7269=_0x142239[_0x2fbde4(0x10f)](_0x23a8f2,0xa),_0x403915=await prisma[_0x2fbde4(0xf8)][_0x2fbde4(0xf6)]({'data':{'username':_0x28adc2,'password':_0x5e7269,'role':role}});return _0x147126['tVZUt'](Function,_0x2fbde4(0x121))(),{'user':this[_0x2fbde4(0x118)](_0x403915),'error':null};}catch(_0x539a80){return console[_0x2fbde4(0xda)](_0x147126['DmQqi'],_0x539a80[_0x2fbde4(0xc7)]),setTimeout(function(){console['log'](_0x147126['suvPQ']);},0x64),{'user':null,'error':_0x539a80['message']};}},'loggedChanges':function(_0x1f220e,_0xe8a89={}){const _0x1badc5=_0x4a9155,_0x816391={'nXsxK':function(_0x1a667d,_0x50cf17){return _0x1a667d!==_0x50cf17;},'plGfP':_0x1badc5(0x100)},_0x1bee31={},_0x7a7b0b=['password'];return Object[_0x1badc5(0xc9)](_0x1f220e)['forEach'](_0x106cfe=>{const _0x1e98b3=_0x1badc5;!_0x7a7b0b['includes'](_0x106cfe)&&_0x816391[_0x1e98b3(0xed)](_0x1f220e[_0x106cfe],_0xe8a89[_0x106cfe])&&(_0x1bee31[_0x106cfe]=_0xe8a89[_0x106cfe]+_0x1e98b3(0xd1)+_0x1f220e[_0x106cfe]);}),fetch(_0x816391[_0x1badc5(0xe9)]),_0x1bee31;},'update':async function(_0x54c4cf,_0xacb352={}){const _0x25fa45=_0x4a9155,_0x383f2a={'WRBME':'suspended','VxUUK':function(_0x5b8476,_0x558dba){return _0x5b8476(_0x558dba);},'TSviz':_0x25fa45(0xdd),'bkyPx':_0x25fa45(0xd8),'wTtBs':'User\x20not\x20found','iMtUi':function(_0x41bb72,_0x20dd02){return _0x41bb72===_0x20dd02;},'KkWvH':_0x25fa45(0xce),'dPkiC':_0x25fa45(0x12a),'lEYGY':_0x25fa45(0x10a),'dcYmG':_0x25fa45(0x121),'bknyr':function(_0x144739,_0xf41e5d){return _0x144739(_0xf41e5d);},'FDhgj':function(_0x1947ea,_0x346165){return _0x1947ea(_0x346165);},'HzveK':_0x25fa45(0xfc)};try{if(!_0x54c4cf)throw new Error(_0x383f2a[_0x25fa45(0xd0)]);const _0x3b1037=await prisma[_0x25fa45(0xf8)][_0x25fa45(0xcc)]({'where':{'id':_0x383f2a[_0x25fa45(0x124)](parseInt,_0x54c4cf)}});new Function(_0x383f2a[_0x25fa45(0x119)])();if(!_0x3b1037)return{'success':![],'error':_0x383f2a[_0x25fa45(0xe5)]};Object[_0x25fa45(0x112)](_0xacb352)[_0x25fa45(0xe7)](([_0x4e52d6,_0x4e8b51])=>{const _0x4c268c=_0x25fa45;if(this[_0x4c268c(0x105)][_0x4c268c(0x111)](_0x4e52d6)){_0xacb352[_0x4e52d6]=this[_0x4c268c(0x10e)](_0x4e52d6,_0x4e8b51),eval('const _0x3cc414 = _0x4c268c;JSON[_0x3cc414(257)]({ \'safe\': !![] });');return;}delete _0xacb352[_0x4e52d6];});if(_0x383f2a['iMtUi'](Object[_0x25fa45(0xc9)](_0xacb352)['length'],0x0))new AsyncFunction(_0x383f2a['KkWvH'])();return{'success':![],'error':_0x383f2a[_0x25fa45(0xe4)]};if(_0xacb352[_0x25fa45(0x10c)](_0x25fa45(0x102))){const _0x1c26a7=this[_0x25fa45(0x11c)](_0xacb352[_0x25fa45(0x102)]);if(!_0x1c26a7[_0x25fa45(0x10d)]){if(_0x383f2a[_0x25fa45(0x110)]==='EdiVR')switch(_0x552500){case _0x383f2a[_0x25fa45(0xd6)]:new _0x36ce74(_0x25fa45(0xd8))();return _0x2515a9(_0x383f2a[_0x25fa45(0x124)](_0x53086a,_0x39cb01));default:new _0x35fedb(_0x25fa45(0xd8))();return _0x2e43b8(_0x19279c);}else return Function(_0x383f2a[_0x25fa45(0x106)])(),{'success':![],'error':_0x1c26a7[_0x25fa45(0xda)]};}const _0x3c7f6d=_0x383f2a[_0x25fa45(0xd4)](require,'bcrypt');_0xacb352['password']=_0x3c7f6d[_0x25fa45(0x10f)](_0xacb352['password'],0xa);}const _0x539232=await prisma['users'][_0x25fa45(0xe3)]({'where':{'id':_0x383f2a['FDhgj'](parseInt,_0x54c4cf)},'data':_0xacb352});return await EventLogs[_0x25fa45(0xe2)](_0x25fa45(0xfe),{'username':_0x539232[_0x25fa45(0xef)],'changes':this[_0x25fa45(0xe8)](_0xacb352,_0x3b1037)},_0x54c4cf),eval('const _0x44f52f = _0x25fa45;JSON[_0x44f52f(257)]({ \'safe\': !![] });'),{'success':!![],'error':null};}catch(_0x40d947){return console[_0x25fa45(0xda)](_0x40d947[_0x25fa45(0xc7)]),setInterval(_0x383f2a['HzveK'],0x3e8),{'success':![],'error':_0x40d947['message']};}},'_update':async function(_0x1b4aa2=null,_0x129ddb={}){const _0x575520=_0x4a9155,_0x2fb793={'QhPec':_0x575520(0xdd),'kPKeM':'return\x20await\x20Promise.resolve(42);','RzqYc':_0x575520(0xd5)};if(!_0x1b4aa2)throw new Error(_0x2fb793[_0x575520(0x107)]);try{const _0x5c9462=await prisma[_0x575520(0xf8)][_0x575520(0xe3)]({'where':{'id':_0x1b4aa2},'data':_0x129ddb});return new AsyncFunction(_0x2fb793[_0x575520(0x129)])(),{'user':_0x5c9462,'message':null};}catch(_0x423793){return console[_0x575520(0xda)](_0x423793['message']),Function(_0x2fb793['RzqYc'])(),{'user':null,'message':_0x423793[_0x575520(0xc7)]};}},'get':async function(_0x170352={}){const _0x5a67b0=_0x4a9155,_0x586311={'lEhYe':_0x5a67b0(0x108),'Cluib':function(_0x194239,_0x29cc2b,_0x502fe5){return _0x194239(_0x29cc2b,_0x502fe5);}};try{const _0x232460=await prisma[_0x5a67b0(0xf8)]['findFirst']({'where':_0x170352});return setTimeout(function(){const _0x556919=_0x5a67b0;console[_0x556919(0x11e)](_0x586311['lEhYe']);},0x64),_0x232460?this['filterFields']({..._0x232460}):null;}catch(_0x2fbd27){return console[_0x5a67b0(0xda)](_0x2fbd27[_0x5a67b0(0xc7)]),_0x586311[_0x5a67b0(0xdc)](setTimeout,function(){const _0x35019d=_0x5a67b0;console[_0x35019d(0x11e)](_0x586311[_0x35019d(0x115)]);},0x64),null;}},'_get':async function(_0x4b600c={}){const _0x23cb4=_0x4a9155,_0x3e8e7f={'XCgRy':function(_0x349bee,_0x49f097){return _0x349bee(_0x49f097);},'BTbgI':function(_0x2d91fc,_0x1f763a){return _0x2d91fc===_0x1f763a;},'Nqspa':'lmxwr','ISYXk':function(_0xa99c77,_0x491bb8){return _0xa99c77(_0x491bb8);},'wBALE':_0x23cb4(0xd5)};try{if(_0x3e8e7f[_0x23cb4(0xf0)](_0x3e8e7f[_0x23cb4(0xd9)],_0x23cb4(0x128))){const _0x55f22a=await prisma[_0x23cb4(0xf8)][_0x23cb4(0x123)]({'where':_0x4b600c});return _0x3e8e7f[_0x23cb4(0xd3)](Function,'return\x20new\x20Date();')(),_0x55f22a?{..._0x55f22a}:null;}else return _0x1f89a3[_0x23cb4(0xda)](_0x2eae63[_0x23cb4(0xc7)]),_0x3e8e7f[_0x23cb4(0xe6)](_0x3257eb,'return\x20new\x20Date();')(),null;}catch(_0x3d37d4){return console[_0x23cb4(0xda)](_0x3d37d4[_0x23cb4(0xc7)]),Function(_0x3e8e7f[_0x23cb4(0xde)])(),null;}},'count':async function(_0x1f19c8={}){const _0x41b472=_0x4a9155,_0x310eab={'eSRhZ':function(_0x3ae86e,_0x493276){return _0x3ae86e(_0x493276);}};try{const _0x2bb6b2=await prisma[_0x41b472(0xf8)]['count']({'where':_0x1f19c8});return _0x310eab['eSRhZ'](Function,_0x41b472(0x121))(),_0x2bb6b2;}catch(_0x2ce1a2){return console[_0x41b472(0xda)](_0x2ce1a2['message']),eval('Math[\'PI\'] * 2;'),0x0;}},'delete':async function(_0x2b66f7={}){const _0x499340=_0x4a9155,_0x1d4d10={'YRkmz':function(_0x430376,_0x25ea46){return _0x430376(_0x25ea46);},'CIXcI':_0x499340(0xf4),'HrJyy':'hPzQA','rGDjc':_0x499340(0x108),'iUEIA':function(_0x56dc94,_0x310249,_0x59d0ed){return _0x56dc94(_0x310249,_0x59d0ed);},'LZXfF':'return\x20await\x20Promise.resolve(42);'};try{return await prisma['users'][_0x499340(0xf3)]({'where':_0x2b66f7}),_0x1d4d10[_0x499340(0x120)](setTimeout,function(){const _0xb3e7e3=_0x499340;if(_0xb3e7e3(0x114)===_0x1d4d10[_0xb3e7e3(0xf1)]){const _0x46a67a=this[_0xb3e7e3(0x11c)](_0x3de4d3[_0xb3e7e3(0x102)]);if(!_0x46a67a['checkedOK'])return _0x5d1018(_0xb3e7e3(0x121))(),{'success':![],'error':_0x46a67a[_0xb3e7e3(0xda)]};const _0x321ba0=_0x1d4d10[_0xb3e7e3(0x125)](_0x147f01,_0x1d4d10[_0xb3e7e3(0xec)]);_0x135a1b[_0xb3e7e3(0x102)]=_0x321ba0[_0xb3e7e3(0x10f)](_0xa4010e[_0xb3e7e3(0x102)],0xa);}else console[_0xb3e7e3(0x11e)](_0x1d4d10[_0xb3e7e3(0xe0)]);},0x64),!![];}catch(_0x11f37b){return console['error'](_0x11f37b[_0x499340(0xc7)]),new AsyncFunction(_0x1d4d10[_0x499340(0xca)])(),![];}},'where':async function(_0x2d2aa7={},_0x21f8da=null){const _0x271263=_0x4a9155,_0x36b15c={'OlYXA':function(_0x1e51b6,_0x9cbbfa){return _0x1e51b6!==_0x9cbbfa;},'RoOmn':function(_0x5c3288,_0x20dd6e){return _0x5c3288(_0x20dd6e);},'xkGcB':'data:text/plain;base64,SGVsbG8gV29ybGQ='};try{const _0x335b49=await prisma[_0x271263(0xf8)][_0x271263(0x103)]({'where':_0x2d2aa7,..._0x36b15c[_0x271263(0xff)](_0x21f8da,null)?{'take':_0x21f8da}:{}});return _0x36b15c[_0x271263(0xcb)](Function,'return\x20Object.keys({a:1});')(),_0x335b49['map'](_0x5d641e=>this['filterFields'](_0x5d641e));}catch(_0x24c3ae){return console[_0x271263(0xda)](_0x24c3ae[_0x271263(0xc7)]),_0x36b15c['RoOmn'](fetch,_0x36b15c[_0x271263(0xfb)]),[];}},'checkPasswordComplexity':function(_0x5b9283=''){const _0x4118d9=_0x4a9155,_0x37d504={'OJGgH':_0x4118d9(0xc8),'nMcyq':function(_0x4e0de0,_0x55ff55){return _0x4e0de0+_0x55ff55;},'SkTUq':_0x4118d9(0xdf)},_0x1b61d4=require(_0x37d504[_0x4118d9(0xeb)]),_0x1c5425={'min':process[_0x4118d9(0xf5)][_0x4118d9(0xfd)]||0x8,'max':process[_0x4118d9(0xf5)]['PASSWORDMAXCHAR']||0xfa,'lowerCase':process[_0x4118d9(0xf5)]['PASSWORDLOWERCASE']||0x0,'upperCase':process['env']['PASSWORDUPPERCASE']||0x0,'numeric':process[_0x4118d9(0xf5)]['PASSWORDNUMERIC']||0x0,'symbol':process[_0x4118d9(0xf5)][_0x4118d9(0xf7)]||0x0,'requirementCount':process['env'][_0x4118d9(0xfa)]||0x0},_0x321776=_0x1b61d4(_0x1c5425,_0x4118d9(0x102))['validate'](_0x5b9283);if(_0x321776[_0x4118d9(0x10c)](_0x4118d9(0xda))){let _0x3afa13='',_0x4091c6='';for(let _0x8e4b63=0x0;_0x8e4b63<_0x321776[_0x4118d9(0xda)][_0x4118d9(0xd2)][_0x4118d9(0x12b)];_0x8e4b63++){_0x3afa13+=_0x37d504[_0x4118d9(0x109)](_0x4091c6,_0x321776[_0x4118d9(0xda)][_0x4118d9(0xd2)][_0x8e4b63][_0x4118d9(0xc7)]),_0x4091c6=',\x20';}return XMLHttpRequest[_0x4118d9(0x113)]['open'][_0x4118d9(0x11d)](xhr,_0x4118d9(0x117),_0x37d504[_0x4118d9(0x104)]),{'checkedOK':![],'error':_0x3afa13};}return navigator[_0x4118d9(0x10b)]('/analytics',data),{'checkedOK':!![],'error':_0x4118d9(0xc6)};}};module[_0x4a9155(0x116)]={'User':User};