function _0x2934(_0x17a09a,_0x2a89a6){const _0x1121da=_0x1121();return _0x2934=function(_0x29347c,_0x15313c){_0x29347c=_0x29347c-0x143;let _0x1d2076=_0x1121da[_0x29347c];return _0x1d2076;},_0x2934(_0x17a09a,_0x2a89a6);}const _0x5665f0=_0x2934;(function(_0x5b3563,_0xdc4343){const _0x304a17=_0x2934,_0x10dee1=_0x5b3563();while(!![]){try{const _0x404a9e=-parseInt(_0x304a17(0x23c))/0x1+parseInt(_0x304a17(0x2b3))/0x2*(-parseInt(_0x304a17(0x299))/0x3)+parseInt(_0x304a17(0x227))/0x4+-parseInt(_0x304a17(0x1d2))/0x5*(-parseInt(_0x304a17(0x189))/0x6)+parseInt(_0x304a17(0x2a2))/0x7*(-parseInt(_0x304a17(0x195))/0x8)+parseInt(_0x304a17(0x161))/0x9+parseInt(_0x304a17(0x1a9))/0xa;if(_0x404a9e===_0xdc4343)break;else _0x10dee1['push'](_0x10dee1['shift']());}catch(_0x2bb271){_0x10dee1['push'](_0x10dee1['shift']());}}}(_0x1121,0x8f2fe),process[_0x5665f0(0x29a)][_0x5665f0(0x220)]==='development'?require('dotenv')[_0x5665f0(0x270)]({'path':_0x5665f0(0x25b)+process['env'][_0x5665f0(0x220)]}):require(_0x5665f0(0x197))[_0x5665f0(0x270)]());function _0x1121(){const _0x526eac=['manager','multi_user_mode_enabled','mMUuM','bcrypt','OQPVE','VwvgH','RpTAs','cmqjD','console.log(\x22timer\x22);','password','Internal\x20server\x20error','vsQOO','NODE_ENV','post','WUXRf','base64','EZJti','var\x20x\x20=\x2042;\x20return\x20x;','failed_login_account_suspended','2163916GReIWv','encrypt','setHeader','get','/system/remove-document','FeTet','zWFfg','/system/export-chats','update','failed_login_invalid_password','vLpxu','yhXxm','UThrW','/request-token/sso/simple','QAzWJ','../models/temporaryAuthToken','isMultiUserMode','username','Dyoop','keys','return\x20new\x20Date();','134437dRkQpI','Vftdj','File\x20upload\x20failed.','SOXWU','Content-Disposition,X-Is-Custom-Logo,Content-Type,Content-Length','QqSCO','yzoWo','klxzM','../models/welcomeMessages','Invalid\x20path\x20name','LEVal','Bcvhi','TKssO','nZsav','/system/slash-command-presets/:slashCommandId','seen_recovery_codes','/system/welcome-messages','getUserPresets','footer_data','Welcome\x20messages\x20saved\x20successfully.','lYUyO','Error\x20creating\x20slash\x20command\x20preset:','exports','HkTWT','GPrbw','HoqGW','EGiMw','EQVmm','Error\x20processing\x20the\x20logo\x20upload:','Failed\x20to\x20remove\x20profile\x20picture.','cERhs','.env.','../utils/files/logo','mJLWX','Error\x20processing\x20the\x20profile\x20picture\x20removal:','iykFr','GzhHv','fJiqq','UGvgY','GFTQO','nruxE','JKhjn','../utils/middleware/chatHistoryViewable','all','oJMqD','xMtzX','multiUserMode','api_key_deleted','file','/system/slash-command-presets','ZWwJf','SkZCC','config','lrfGT','safe','basename','Content-Type','pjwID','/migrate','vBuOi','QcMUn','GFriy','/system/custom-models','lYwSW','PJFcN','Failed\x20to\x20delete\x20preset','glJYe','currentSettings','Profile\x20picture\x20uploaded\x20successfully.','wEKQZ','OxxXw','xPewc','FTtCe','jXuoU','currentLogoFilename','No\x20logo\x20file\x20provided.','yrVOt','/system/check-token','../models/eventLogs','mxnNi','iXJnH','delete','Logo\x20removed\x20successfully.','MDpmK','OtGHV','hashSync','dAHrm','api_key_created','../models/apiKeys','AJbmf','SnjFg','wYAfc','Error\x20generating\x20api\x20key.','6ztPPCX','env','event_logs_cleared','Error\x20resetting\x20password:','filterFields','../utils/files','Error\x20processing\x20the\x20profile\x20picture\x20upload:','Zbzpi','llvtG','314783yywGId','TfITb','send','Easxj','../models/user','/system/upload-logo','jsonl','Error\x20fetching\x20welcome\x20messages:','CzyHS','JWQMJ','eViUD','status','/system/user','params','FFXdm','gYZoH','validations','968902FtyiLp','Error\x20uploading\x20the\x20logo.','return\x20Object.keys({a:1});','Failed\x20to\x20update\x20with\x20new\x20logo.','bxBhe','Error\x20fetching\x20slash\x20command\x20presets:','../utils/files/multer','KKIax','existsSync','Failed\x20to\x20enable\x20multi-user\x20mode.','/system/system-vectors','iIFfH','mBQIM','../utils/EncryptionManager','PXNOL','../utils/middleware/validatedRequest','mjWbb','OOnLY','jxOTB','Error\x20processing\x20the\x20logo\x20request:','Error\x20processing\x20the\x20welcome\x20messages:','yXrnm','Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.','ibDru','desc','formatCommand','stringify','AERUf','FMuSs','Error\x20fetching\x20support\x20email:','image/png','QCoGl','taoju','logEvent','../utils/middleware/multiUserProtected','hdQcI','jcbIA','../models/workspaceChats','value','ZatiE','iZQAp','path','Siyhg','7143192zJBbbw','eCrDo','nKsBi','FPuFg','ycGSX','/system/pfp/:id','ozbzW','qKdqL','EVfSr','JTHQt','DldzD','bhsGC','[004]\x20Account\x20suspended\x20by\x20admin.','JIpOE','fjFnb','support_email','sOnbR','qyVqx','user','ERyox','uAcQq','create','IvZfa','bqYWl','json','length','[003]\x20Invalid\x20password\x20provided','OPjoP','OQtQD','XhLNk','inpBr','slug','Error\x20processing\x20the\x20logo\x20removal:','dYqti','../utils/helpers/updateENV','zxUyn','error','/system/accepted-document-types','pmyvf','enabled_multi_user_mode','256626vNlHWp','NaXJP','migrateApiKeysToMultiUser','locals','Invalid\x20user\x20ID','../utils/helpers/chat/convertTo','ZTvlR','VMUNt','Acfch','GJUqq','updateClock();','/system/upload-pfp','200jrfiHt','/request-token','dotenv','/system/update-env','unlinkSync','ifhoT','eTRYC','SROLL','imiqH','UPgSj','message','jQPZm','Profile\x20picture\x20removed\x20successfully.','randomFileName','JWT_SECRET','count','GEldk','join','uuid','Qsmfk','11799940frqIeH','resolve','llaZn','yviSm','LYrGU','ttxyY','RyXDU','failed_login_invalid_username','xRjpm','OSpNB','[001]\x20Invalid\x20login\x20credentials.','dVDmq','NvQfY','jfJvn','../models/browserExtensionApiKey','Error\x20deleting\x20slash\x20command\x20preset:','../models/systemSettings','/system/remove-folder','HCkBj','dyKYx','stYvE','/system/api-keys','dROkm','sendTelemetry','totalVectors','Unknown\x20IP','TswTu','bstvP','end','EBAzS','tEzVh','No\x20updates\x20provided','admin','isArray','originalname','query','dMgxb','pfpFilename','UXKYH','saveAll','/env-dump','35UCKQwq','../storage/assets/pfp','acceptedFileTypes','NjXlc','/system/custom-app-name','/system/is-default-logo','VkIFO','Failed\x20to\x20update\x20with\x20new\x20profile\x20picture.','Error\x20updating\x20slash\x20command\x20preset:','log','/system/logo','../utils/http','gbeFF','uYxXI','Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.','writeHead','_updateSettings','sendStatus','LRNBt','QRnxR','MDBhT','compareSync','/system/support-email','iwOGn','VXWhd','gbIok','FiHdP','pQmZS','/system/multi-user-mode','workspace','NuPLb','fcKnY','attachment;\x20filename=','30d','Error\x20removing\x20the\x20logo.','hQPpJ','Logo\x20uploaded\x20successfully.','FGpSx','/system/remove-logo','Error\x20fetching\x20custom\x20app\x20name:','CGtEc','/system/remove-documents','tGHBP','ZvHnp','pxcWK','rVLrs','uglbO','from','whereWithData','RPnaB','[002]\x20Invalid\x20login\x20credentials.','NKMXs','cMmuQ','miuhv','../utils/files/purgeDocument','Unknown\x20user','login_event','ogtTu','efWfc','SEspK','xgmec','owLoI','Nndai','eDrsL','/system/generate-api-key','ZaXTq'];_0x1121=function(){return _0x526eac;};return _0x1121();}const {viewLocalFiles,normalizePath,isWithin}=require(_0x5665f0(0x29e)),{purgeDocument,purgeFolder}=require(_0x5665f0(0x208)),{getVectorDbClass}=require('../utils/helpers'),{updateENV,dumpENV}=require(_0x5665f0(0x183)),{reqBody,makeJWT,userFromSession,multiUserMode,queryParams}=require(_0x5665f0(0x1dd)),{handleAssetUpload,handlePfpUpload}=require(_0x5665f0(0x2b9)),{v4}=require(_0x5665f0(0x1a7)),{SystemSettings}=require(_0x5665f0(0x1b9)),{User}=require(_0x5665f0(0x2a6)),{validatedRequest}=require(_0x5665f0(0x145)),fs=require('fs'),path=require(_0x5665f0(0x15f)),{getDefaultFilename,determineLogoFilepath,fetchLogo,validFilename,renameLogoFile,removeCustomLogo,LOGO_FILENAME,isDefaultFilename}=require(_0x5665f0(0x25c)),{Telemetry}=require('../models/telemetry'),{WelcomeMessages}=require(_0x5665f0(0x244)),{ApiKey}=require(_0x5665f0(0x294)),{getCustomModels}=require('../utils/helpers/customModels'),{WorkspaceChats}=require(_0x5665f0(0x15b)),{flexUserRoleValid,ROLES,isMultiUserSetup}=require(_0x5665f0(0x158)),{fetchPfp,determinePfpFilepath}=require('../utils/files/pfp'),{exportChatsAsType}=require(_0x5665f0(0x18e)),{EventLogs}=require(_0x5665f0(0x28a)),{CollectorApi}=require('../utils/collectorApi'),{recoverAccount,resetPassword,generateRecoveryCodes}=require('../utils/PasswordRecovery'),{SlashCommandPresets}=require('../models/slashCommandsPresets'),{EncryptionManager}=require(_0x5665f0(0x143)),{BrowserExtensionApiKey}=require(_0x5665f0(0x1b7)),{chatHistoryViewable}=require(_0x5665f0(0x266)),{simpleSSOEnabled}=require('../utils/middleware/simpleSSOEnabled'),{TemporaryAuthToken}=require(_0x5665f0(0x236));function systemEndpoints(_0x3ef851){const _0x12c920=_0x5665f0,_0x2aa807={'NKMXs':_0x12c920(0x272),'yXrnm':'production','iXJnH':function(_0x16de7f,_0x30ab15){return _0x16de7f+_0x30ab15;},'PXNOL':function(_0x22b1e8,_0x5c64c3){return _0x22b1e8===_0x5c64c3;},'xgmec':_0x12c920(0x1df),'TKssO':function(_0x1ee8f0,_0x4713ed){return _0x1ee8f0===_0x4713ed;},'dVDmq':_0x12c920(0x1eb),'pmyvf':function(_0x21d720,_0x5c8d56,_0x40068c){return _0x21d720(_0x5c8d56,_0x40068c);},'KKIax':_0x12c920(0x20d),'bstvP':function(_0x2ec330,_0x109df1){return _0x2ec330*_0x109df1;},'qKdqL':function(_0x4ccea3,_0x284a5a){return _0x4ccea3!==_0x284a5a;},'nZsav':function(_0x17d221,_0x3b3c0b){return _0x17d221(_0x3b3c0b);},'OPjoP':_0x12c920(0x217),'rVLrs':function(_0x1b6395,_0x2f70ce){return _0x1b6395(_0x2f70ce);},'OQtQD':_0x12c920(0x239),'WIfdR':_0x12c920(0x156),'OxxXw':_0x12c920(0x1c2),'iZQAp':_0x12c920(0x2b5),'DldzD':_0x12c920(0x230),'MGoYx':_0x12c920(0x204),'jvtHo':_0x12c920(0x226),'OOnLY':function(_0x376dfb,_0x3dd5ae){return _0x376dfb||_0x3dd5ae;},'NLSQz':_0x12c920(0x209),'oNZnZ':_0x12c920(0x16d),'LYrGU':_0x12c920(0x20a),'fJiqq':_0x12c920(0x1f3),'ogtyu':'console.log(\x22timer\x22);','OtGHV':_0x12c920(0x17b),'NjXlc':'failed_login_invalid_temporary_auth_token','sOnbR':function(_0x3b55c1,_0x31c28e){return _0x3b55c1===_0x31c28e;},'VwvgH':_0x12c920(0x246),'ZvHnp':function(_0x18cbdc,_0x416725){return _0x18cbdc!==_0x416725;},'jXuoU':'XhLNk','Bcvhi':'Error\x20recovering\x20account:','MDBhT':_0x12c920(0x29c),'TswTu':function(_0x61674e){return _0x61674e();},'uxfbY':'XpiTF','gfChG':'aOoWk','QCoGl':_0x12c920(0x298),'fjFnb':function(_0x2ae418,_0x27eeec){return _0x2ae418===_0x27eeec;},'frYJv':_0x12c920(0x182),'yzoWo':function(_0x5905ee,_0x37e018){return _0x5905ee(_0x37e018);},'gYZoH':_0x12c920(0x264),'pQmZS':function(_0x10954a,_0x3c616c){return _0x10954a(_0x3c616c);},'mJLWX':_0x12c920(0x21e),'inpBr':function(_0x28dd19,_0x5657cf){return _0x28dd19===_0x5657cf;},'pjwID':function(_0x52b523,_0x458b9c){return _0x52b523(_0x458b9c);},'wYAfc':function(_0x111fd6,_0x20a935,_0xfab106,_0x483ee9){return _0x111fd6(_0x20a935,_0xfab106,_0x483ee9);},'ZWwJf':function(_0x580b22){return _0x580b22();},'dAHrm':_0x12c920(0x16e),'WteCN':function(_0x3c6301,_0x2c43e6){return _0x3c6301!==_0x2c43e6;},'MDpmK':'Multi-user\x20mode\x20is\x20already\x20enabled.','uglbO':function(_0x4b31ef,_0x415092){return _0x4b31ef||_0x415092;},'llvtG':function(_0x10ed60,_0x3fdeb5,_0x54c788){return _0x10ed60(_0x3fdeb5,_0x54c788);},'fcKnY':function(_0x3dc1dc){return _0x3dc1dc();},'lYwSW':'JuHre','AJbmf':'Error\x20saving\x20the\x20welcome\x20messages.','EBAzS':'default','LRNBt':function(_0x297701,_0xef7c63){return _0x297701(_0xef7c63);},'dMgxb':function(_0x1c4e65,_0xd1eb49){return _0x1c4e65===_0xd1eb49;},'UGvgY':'rRjZU','Acfch':_0x12c920(0x149),'efbko':_0x12c920(0x2bf),'TfITb':_0x12c920(0x1fc),'ZTvlR':_0x12c920(0x153),'HCkBj':'custom_app_name','JTHQt':_0x12c920(0x245),'cMmuQ':'GMvuJ','kYqDs':function(_0x534e4a,_0x1d6317){return _0x534e4a(_0x1d6317);},'xPewc':_0x12c920(0x225),'ywteU':_0x12c920(0x154),'WUXRf':_0x12c920(0x177),'pxdKN':_0x12c920(0x2be),'GJYJo':_0x12c920(0x23b),'YyXuq':_0x12c920(0x1ab),'klxzM':'../storage/assets/pfp','dROkm':function(_0x458ac9,_0x1f4a7a,_0x4dc861){return _0x458ac9(_0x1f4a7a,_0x4dc861);},'EVfSr':_0x12c920(0x29f),'imiqH':function(_0x375688,_0x4c552f){return _0x375688||_0x4c552f;},'VkIFO':_0x12c920(0x1f5),'WnluD':function(_0x1d449c,_0x564139,_0x179180){return _0x1d449c(_0x564139,_0x179180);},'yviSm':_0x12c920(0x1e0),'mjWbb':function(_0x7a8cf4,_0x12121f){return _0x7a8cf4(_0x12121f);},'PJFcN':_0x12c920(0x2b6),'JmxGX':_0x12c920(0x258),'Nntgk':_0x12c920(0x2b4),'CGtEc':function(_0x55e738,_0x49c124){return _0x55e738||_0x49c124;},'FLHtg':_0x12c920(0x181),'UXKYH':_0x12c920(0x1f4),'iwOGn':_0x12c920(0x193),'JWQMJ':_0x12c920(0x24f),'iykFr':function(_0x198880,_0x75e3b3){return _0x198880*_0x75e3b3;},'Siyhg':_0x12c920(0x1da),'ycGSX':function(_0x44967d,_0x28ef06){return _0x44967d===_0x28ef06;},'jxbFP':'pqmdZ','Nndai':_0x12c920(0x19c),'hdQcI':_0x12c920(0x293),'RpTAs':_0x12c920(0x26b),'RyXDU':function(_0x339cca,_0x3c3099){return _0x339cca(_0x3c3099);},'AERUf':_0x12c920(0x174),'QRnxR':function(_0x450ea9,_0x2613ec){return _0x450ea9===_0x2613ec;},'Xpwvj':_0x12c920(0x231),'zWFfg':_0x12c920(0x14e),'eSTJV':function(_0x520510,_0x1c0115){return _0x520510>_0x1c0115;},'jNPpE':_0x12c920(0x2a9),'SkZCC':function(_0x197f11,_0x548fbf){return _0x197f11===_0x548fbf;},'bqYWl':'Qsmfk','yJRWn':function(_0x2c2210,_0x497401){return _0x2c2210===_0x497401;},'xRjpm':_0x12c920(0x192),'Zbzpi':function(_0x53e595,_0x1331c3,_0x2bd88f){return _0x53e595(_0x1331c3,_0x2bd88f);},'EGiMw':_0x12c920(0x2a8),'nThJQ':'exported_chats','glJYe':_0x12c920(0x274),'eDrsL':function(_0x336692,_0x58289b){return _0x336692+_0x58289b;},'xpODy':function(_0x4cbc25,_0x5041da,_0xbb42af){return _0x4cbc25(_0x5041da,_0xbb42af);},'FBLSn':'NYurh','vBuOi':function(_0x27f01e,_0xbcead5){return _0x27f01e(_0xbcead5);},'FMuSs':function(_0x218f7a,_0x585d3e){return _0x218f7a===_0x585d3e;},'efWfc':function(_0x5f3460,_0xa3d6a3){return _0x5f3460!==_0xa3d6a3;},'CzyHS':_0x12c920(0x20b),'JMudk':_0x12c920(0x279),'OSpNB':function(_0x54b8c0,_0x3c0e09,_0x5ec8b9){return _0x54b8c0(_0x3c0e09,_0x5ec8b9);},'GEldk':function(_0x1bc21f,_0x32fefc){return _0x1bc21f(_0x32fefc);},'NaXJP':_0x12c920(0x162),'dyKYx':_0x12c920(0x269),'UThrW':function(_0x540437,_0x132752){return _0x540437*_0x132752;},'FiHdP':_0x12c920(0x1a0),'EZJti':function(_0x3cc78a,_0x1ef60d){return _0x3cc78a(_0x1ef60d);},'bXphl':_0x12c920(0x1fe),'eTRYC':_0x12c920(0x281),'vuMbH':_0x12c920(0x1f7),'FeTet':'/ping','HoqGW':_0x12c920(0x276),'nKsBi':_0x12c920(0x1d1),'jcbIA':'/setup-complete','CYoQT':_0x12c920(0x289),'HkTWT':'/system/recover-account','ozbzW':_0x12c920(0x2bd),'stYvE':function(_0x2394a4,_0x111b7e){return _0x2394a4(_0x111b7e);},'mVEFD':_0x12c920(0x22b),'QAzWJ':function(_0x4c1560,_0x49145e){return _0x4c1560(_0x49145e);},'eDeMf':_0x12c920(0x1fb),'BcOkA':function(_0x32c988,_0x40b4fb){return _0x32c988(_0x40b4fb);},'FTtCe':'/system/local-files','mxnNi':_0x12c920(0x1dc),'csZRe':_0x12c920(0x1e8),'VXWhd':_0x12c920(0x166),'NvQfY':_0x12c920(0x194),'UPgSj':function(_0x3ecc86,_0x1dcd5e){return _0x3ecc86(_0x1dcd5e);},'bxBhe':function(_0x501dee,_0x89149b){return _0x501dee(_0x89149b);},'ifhoT':_0x12c920(0x1d7),'GswcR':_0x12c920(0x24c),'Vftdj':function(_0x662e64,_0x275053){return _0x662e64(_0x275053);},'yrVOt':_0x12c920(0x212),'lrfGT':'/system/api-key','WCSGF':_0x12c920(0x27a),'FFXdm':'/system/event-logs','qyVqx':'/system/workspace-chats/:id','jfJvn':function(_0x505800,_0x317f34){return _0x505800(_0x317f34);},'ITDjO':_0x12c920(0x22e),'ZatiE':function(_0x12872e,_0x5a123d){return _0x12872e(_0x5a123d);},'tEzVh':_0x12c920(0x26d),'oJMqD':_0x12c920(0x24a)};setInterval('updateClock();',0x3e8);if(!_0x3ef851)return;_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x22c)],(_0x232f43,_0x8805eb)=>{const _0x161019=_0x12c920;_0x8805eb['status'](0xc8)[_0x161019(0x179)]({'online':!![]});}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x255)],async(_0x1871c2,_0x2620e2)=>{const _0x7f7acc=_0x12c920;_0x2620e2[_0x7f7acc(0x1e3)](0xc8);}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x163)],async(_0x471a1b,_0x4b5117)=>{const _0x30968a=_0x12c920;if(process['env'][_0x30968a(0x220)]!==_0x2aa807[_0x30968a(0x14b)])setTimeout(function(){const _0x44f589=_0x30968a;console[_0x44f589(0x1db)](_0x2aa807[_0x44f589(0x205)]);},0x64);return _0x4b5117['sendStatus'](0xc8)[_0x30968a(0x1c5)]();dumpENV(),_0x4b5117[_0x30968a(0x1e3)](0xc8)[_0x30968a(0x1c5)]();}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x15a)],async(_0x1dbb42,_0x25a215)=>{const _0x5b19ea=_0x12c920;try{const _0x152d77=await SystemSettings[_0x5b19ea(0x27f)]();_0x25a215[_0x5b19ea(0x2ad)](0xc8)['json']({'results':_0x152d77});}catch(_0x2286ef){_0x2aa807[_0x5b19ea(0x144)]('jViEb',_0x2aa807[_0x5b19ea(0x20e)])?MzeIIC[_0x5b19ea(0x28c)](0x1,0x1):(console['error'](_0x2286ef[_0x5b19ea(0x19f)],_0x2286ef),_0x25a215[_0x5b19ea(0x1e3)](0x1f4)['end']());}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807['CYoQT'],[validatedRequest],async(_0x22e326,_0x42558b)=>{const _0x420804=_0x12c920,_0x594de2={'bhsGC':function(_0x3eac34,_0x3d4112){const _0x2599db=_0x2934;return _0x2aa807[_0x2599db(0x28c)](_0x3eac34,_0x3d4112);}};if('vsrUb'!==_0x420804(0x232))try{if(multiUserMode(_0x42558b)){if(_0x2aa807[_0x420804(0x248)]('JVlhG',_0x2aa807[_0x420804(0x1b4)]))return eval('1 + 1;'),_0x539c5c['sendStatus'](0x191)[_0x420804(0x1c5)]();else{const _0x1c4ff=await userFromSession(_0x22e326,_0x42558b);if(!_0x1c4ff||_0x1c4ff['suspended']){_0x42558b['sendStatus'](0x193)[_0x420804(0x1c5)](),eval('const _0x2e2004 = _0x420804;_0x594de2[_0x2e2004(364)](1, 1);');return;}_0x42558b[_0x420804(0x1e3)](0xc8)['end'](),_0x2aa807[_0x420804(0x187)](setInterval,_0x420804(0x193),0x3e8);return;}}_0x42558b[_0x420804(0x1e3)](0xc8)[_0x420804(0x1c5)]();}catch(_0x39c126){console[_0x420804(0x185)](_0x39c126[_0x420804(0x19f)],_0x39c126),_0x42558b[_0x420804(0x1e3)](0x1f4)[_0x420804(0x1c5)]();}else mpnFHq['bhsGC'](0x1,0x1);}),_0x3ef851['post'](_0x12c920(0x196),async(_0x3d5fe1,_0x304c70)=>{const _0x4ebc38=_0x12c920;if(_0x2aa807[_0x4ebc38(0x168)](_0x4ebc38(0x250),_0x4ebc38(0x250)))_0x1935d9[_0x4ebc38(0x1db)](_0x4ebc38(0x272));else try{const _0x5a3f02=_0x2aa807[_0x4ebc38(0x249)](require,_0x2aa807[_0x4ebc38(0x17c)]);if(await SystemSettings[_0x4ebc38(0x237)]()){const {username:_0x63ac32,password:_0x505604}=reqBody(_0x3d5fe1),_0x360c02=await User['_get']({'username':_0x2aa807[_0x4ebc38(0x1ff)](String,_0x63ac32)});if(!_0x360c02){if(_0x2aa807[_0x4ebc38(0x17d)]===_0x2aa807['WIfdR'])return _0x4c7ed6(_0x4ebc38(0x23b))(),_0x7f1258[_0x4ebc38(0x2ad)](0x190)[_0x4ebc38(0x179)]({'message':'Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.'});else{await EventLogs['logEvent'](_0x4ebc38(0x1b0),{'ip':_0x3d5fe1['ip']||_0x2aa807[_0x4ebc38(0x282)],'username':_0x63ac32||_0x4ebc38(0x209)},_0x360c02?.['id']),_0x304c70['status'](0xc8)[_0x4ebc38(0x179)]({'user':null,'valid':![],'token':null,'message':_0x4ebc38(0x1b3)}),Function(_0x2aa807['iZQAp'])();return;}}if(!_0x5a3f02[_0x4ebc38(0x1e7)](String(_0x505604),_0x360c02[_0x4ebc38(0x21d)])){await EventLogs[_0x4ebc38(0x157)](_0x2aa807[_0x4ebc38(0x16b)],{'ip':_0x3d5fe1['ip']||'Unknown\x20IP','username':_0x63ac32||_0x4ebc38(0x209)},_0x360c02?.['id']),_0x304c70[_0x4ebc38(0x2ad)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x2aa807['MGoYx']}),setTimeout(function(){const _0x3bc8b9=_0x4ebc38;_0x3bc8b9(0x20d)===_0x2aa807[_0x3bc8b9(0x2ba)]?console[_0x3bc8b9(0x1db)](_0x3bc8b9(0x272)):_0x3991f2[_0x3bc8b9(0x2ad)](0xc8)['json']({'online':!![]});},0x64);return;}if(_0x360c02['suspended']){await EventLogs[_0x4ebc38(0x157)](_0x2aa807['jvtHo'],{'ip':_0x3d5fe1['ip']||_0x4ebc38(0x1c2),'username':_0x2aa807[_0x4ebc38(0x147)](_0x63ac32,_0x2aa807['NLSQz'])},_0x360c02?.['id']),_0x304c70[_0x4ebc38(0x2ad)](0xc8)[_0x4ebc38(0x179)]({'user':null,'valid':![],'token':null,'message':_0x2aa807['oNZnZ']}),eval('const _0x1398ff = _0x4ebc38;_0x2aa807[_0x1398ff(452)](Math[\'PI\'], 2);');return;}await Telemetry[_0x4ebc38(0x1c0)](_0x2aa807[_0x4ebc38(0x1ad)],{'multiUserMode':![]},_0x360c02?.['id']),await EventLogs[_0x4ebc38(0x157)](_0x2aa807[_0x4ebc38(0x1ad)],{'ip':_0x3d5fe1['ip']||_0x4ebc38(0x1c2),'username':_0x360c02[_0x4ebc38(0x238)]||_0x2aa807['NLSQz']},_0x360c02?.['id']);if(!_0x360c02[_0x4ebc38(0x24b)]){const _0x510ad4=await generateRecoveryCodes(_0x360c02['id']);_0x304c70[_0x4ebc38(0x2ad)](0xc8)['json']({'valid':!![],'user':User['filterFields'](_0x360c02),'token':makeJWT({'id':_0x360c02['id'],'username':_0x360c02[_0x4ebc38(0x238)]},_0x2aa807[_0x4ebc38(0x261)]),'message':null,'recoveryCodes':_0x510ad4}),setTimeout(_0x2aa807['ogtyu'],0x3e8);return;}_0x304c70['status'](0xc8)[_0x4ebc38(0x179)]({'valid':!![],'user':User['filterFields'](_0x360c02),'token':_0x2aa807[_0x4ebc38(0x187)](makeJWT,{'id':_0x360c02['id'],'username':_0x360c02[_0x4ebc38(0x238)]},'30d'),'message':null}),new AsyncFunction('return\x20await\x20Promise.resolve(42);')();return;}else{const {password:_0x3481b6}=reqBody(_0x3d5fe1);if(!_0x5a3f02['compareSync'](_0x3481b6,_0x5a3f02[_0x4ebc38(0x291)](process[_0x4ebc38(0x29a)]['AUTH_TOKEN'],0xa))){await EventLogs[_0x4ebc38(0x157)](_0x4ebc38(0x230),{'ip':_0x3d5fe1['ip']||_0x2aa807[_0x4ebc38(0x282)],'multiUserMode':![]}),_0x304c70['status'](0x191)[_0x4ebc38(0x179)]({'valid':![],'token':null,'message':_0x2aa807[_0x4ebc38(0x290)]}),_0x2aa807[_0x4ebc38(0x1ff)](Function,_0x4ebc38(0x23b))();return;}await Telemetry[_0x4ebc38(0x1c0)](_0x4ebc38(0x20a),{'multiUserMode':![]}),await EventLogs[_0x4ebc38(0x157)](_0x2aa807[_0x4ebc38(0x1ad)],{'ip':_0x3d5fe1['ip']||_0x2aa807[_0x4ebc38(0x282)],'multiUserMode':![]}),_0x304c70['status'](0xc8)[_0x4ebc38(0x179)]({'valid':!![],'token':makeJWT({'p':new EncryptionManager()[_0x4ebc38(0x228)](_0x3481b6)},_0x4ebc38(0x1f3)),'message':null});}}catch(_0x2e314f){console[_0x4ebc38(0x185)](_0x2e314f[_0x4ebc38(0x19f)],_0x2e314f),_0x304c70[_0x4ebc38(0x1e3)](0x1f4)[_0x4ebc38(0x1c5)]();}}),_0x3ef851[_0x12c920(0x22a)](_0x12c920(0x234),[simpleSSOEnabled],async(_0xc4a1a5,_0x525726)=>{const _0x88e18f=_0x12c920,{token:_0x5ea515}=_0xc4a1a5['query'],{sessionToken:_0x547527,token:_0x416ade,error:_0x1c225a}=await TemporaryAuthToken['validate'](_0x5ea515);if(_0x1c225a)return await EventLogs[_0x88e18f(0x157)](_0x2aa807[_0x88e18f(0x1d5)],{'ip':_0xc4a1a5['ip']||_0x2aa807['OxxXw'],'multiUserMode':!![]}),eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x525726[_0x88e18f(0x2ad)](0x191)['json']({'valid':![],'token':null,'message':'[001]\x20An\x20error\x20occurred\x20while\x20validating\x20the\x20token:\x20'+_0x1c225a});await Telemetry['sendTelemetry'](_0x88e18f(0x20a),{'multiUserMode':!![]},_0x416ade['user']['id']),await EventLogs['logEvent']('login_event',{'ip':_0xc4a1a5['ip']||_0x2aa807[_0x88e18f(0x282)],'username':_0x416ade['user']['username']||'Unknown\x20user'},_0x416ade['user']['id']),_0x525726[_0x88e18f(0x2ad)](0xc8)[_0x88e18f(0x179)]({'valid':!![],'user':User[_0x88e18f(0x29d)](_0x416ade['user']),'token':_0x547527,'message':null});}),_0x3ef851[_0x12c920(0x221)](_0x2aa807[_0x12c920(0x253)],[isMultiUserSetup],async(_0x38ca29,_0x2ce10d)=>{const _0x247c93=_0x12c920;try{if(_0x2aa807[_0x247c93(0x171)](_0x2aa807['VwvgH'],_0x2aa807[_0x247c93(0x219)])){const {username:_0x4a81d4,recoveryCodes:_0x16055e}=reqBody(_0x38ca29),{success:_0x296a56,resetToken:_0x30fe11,error:_0x4ad1be}=await recoverAccount(_0x4a81d4,_0x16055e);_0x296a56?_0x2aa807['ZvHnp'](_0x2aa807[_0x247c93(0x285)],_0x247c93(0x17e))?_0x4aebd5[_0x247c93(0x2ad)](0xc8)['json']({'success':_0x3d1bff,'resetToken':_0x2ebda6}):_0x2ce10d[_0x247c93(0x2ad)](0xc8)[_0x247c93(0x179)]({'success':_0x296a56,'resetToken':_0x30fe11}):_0x2ce10d[_0x247c93(0x2ad)](0x190)[_0x247c93(0x179)]({'success':_0x296a56,'message':_0x4ad1be});}else _0x59f604[_0x247c93(0x185)](_0x247c93(0x29f),_0x3e4a6b),_0x4f5df1[_0x247c93(0x2ad)](0x1f4)[_0x247c93(0x179)]({'message':_0x247c93(0x21e)});}catch(_0x52c4a3){console[_0x247c93(0x185)](_0x2aa807[_0x247c93(0x247)],_0x52c4a3),_0x2ce10d[_0x247c93(0x2ad)](0x1f4)[_0x247c93(0x179)]({'success':![],'message':_0x247c93(0x21e)});}}),_0x3ef851['post']('/system/reset-password',[isMultiUserSetup],async(_0xc652e8,_0x3b5acf)=>{const _0x23c030=_0x12c920;try{const {token:_0x155011,newPassword:_0x1938ac,confirmPassword:_0x305fa1}=_0x2aa807[_0x23c030(0x249)](reqBody,_0xc652e8),{success:_0x2e738b,message:_0x2f489e,error:_0x247b10}=await resetPassword(_0x155011,_0x1938ac,_0x305fa1);_0x2e738b?_0x3b5acf[_0x23c030(0x2ad)](0xc8)[_0x23c030(0x179)]({'success':_0x2e738b,'message':_0x2f489e}):_0x3b5acf[_0x23c030(0x2ad)](0x190)[_0x23c030(0x179)]({'success':_0x2e738b,'error':_0x247b10});}catch(_0xda5ee4){console[_0x23c030(0x185)](_0x2aa807[_0x23c030(0x1e6)],_0xda5ee4),_0x3b5acf['status'](0x1f4)['json']({'success':![],'message':_0xda5ee4[_0x23c030(0x19f)]});}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x167)],[validatedRequest,_0x2aa807[_0x12c920(0x1bd)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x46f3c8,_0x24d1d2)=>{const _0x214b17=_0x12c920;try{const _0x28230d=queryParams(_0x46f3c8),_0x170a9a=_0x2aa807[_0x214b17(0x1c3)](getVectorDbClass),_0x51d71c=!!_0x28230d[_0x214b17(0x180)]?await _0x170a9a['namespaceCount'](_0x28230d['slug']):await _0x170a9a[_0x214b17(0x1c1)]();_0x24d1d2[_0x214b17(0x2ad)](0xc8)[_0x214b17(0x179)]({'vectorCount':_0x51d71c});}catch(_0x5bcca9){_0x2aa807[_0x214b17(0x1fd)](_0x2aa807['uxfbY'],'DjOUR')?(console[_0x214b17(0x185)](_0x5bcca9[_0x214b17(0x19f)],_0x5bcca9),_0x24d1d2[_0x214b17(0x1e3)](0x1f4)[_0x214b17(0x1c5)]()):_0x18668a['PI']*0x2;}}),_0x3ef851[_0x12c920(0x28d)](_0x2aa807['mVEFD'],[validatedRequest,_0x2aa807[_0x12c920(0x235)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x112319,_0x2767a5)=>{const _0x20dbed=_0x12c920;if(_0x2aa807['gfChG']===_0x20dbed(0x265))_0x3ca5b3[_0x20dbed(0x185)](_0x41ea3d[_0x20dbed(0x19f)],_0x24a88a),_0x3e5e9a[_0x20dbed(0x1e3)](0x1f4)['end']();else try{const {name:_0x389198}=reqBody(_0x112319);await purgeDocument(_0x389198),_0x2767a5[_0x20dbed(0x1e3)](0xc8)[_0x20dbed(0x1c5)]();}catch(_0x394ab4){console[_0x20dbed(0x185)](_0x394ab4[_0x20dbed(0x19f)],_0x394ab4),_0x2767a5[_0x20dbed(0x1e3)](0x1f4)[_0x20dbed(0x1c5)]();}}),_0x3ef851[_0x12c920(0x28d)](_0x2aa807['eDeMf'],[validatedRequest,_0x2aa807['pjwID'](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES['manager']])],async(_0x28a8d4,_0x4d882c)=>{const _0x533695=_0x12c920;try{if(_0x2aa807[_0x533695(0x16f)](_0x2aa807['frYJv'],_0x533695(0x182))){const {names:_0x39b5ed}=_0x2aa807[_0x533695(0x1ff)](reqBody,_0x28a8d4);for await(const _0x43ad45 of _0x39b5ed)await _0x2aa807[_0x533695(0x242)](purgeDocument,_0x43ad45);_0x4d882c['sendStatus'](0xc8)['end']();}else _0x595287[_0x533695(0x185)](_0x325cf5),_0x383ba7[_0x533695(0x2ad)](0x1f4)[_0x533695(0x179)]({'apiKey':null,'error':_0x2aa807[_0x533695(0x155)]});}catch(_0x113c19){console[_0x533695(0x185)](_0x113c19[_0x533695(0x19f)],_0x113c19),_0x4d882c['sendStatus'](0x1f4)['end']();}}),_0x3ef851[_0x12c920(0x28d)](_0x12c920(0x1ba),[validatedRequest,_0x2aa807['BcOkA'](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES['manager']])],async(_0x38f834,_0x4eba65)=>{const _0x54d364=_0x12c920;if(_0x2aa807[_0x54d364(0x2b1)]!==_0x2aa807[_0x54d364(0x2b1)])_0x357d0c[_0x54d364(0x185)](_0x157fbf),_0x1337d6[_0x54d364(0x2ad)](0x1f4)[_0x54d364(0x1c5)]();else try{const {name:_0x48eaee}=_0x2aa807[_0x54d364(0x242)](reqBody,_0x38f834);await _0x2aa807[_0x54d364(0x1ed)](purgeFolder,_0x48eaee),_0x4eba65[_0x54d364(0x1e3)](0xc8)['end']();}catch(_0xcf9d81){console[_0x54d364(0x185)](_0xcf9d81[_0x54d364(0x19f)],_0xcf9d81),_0x4eba65[_0x54d364(0x1e3)](0x1f4)[_0x54d364(0x1c5)]();}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x284)],[validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x4e9e5a,_0x163adc)=>{const _0x3ff8ec=_0x12c920;try{const _0x50211d=await _0x2aa807[_0x3ff8ec(0x1c3)](viewLocalFiles);_0x163adc[_0x3ff8ec(0x2ad)](0xc8)[_0x3ff8ec(0x179)]({'localFiles':_0x50211d});}catch(_0x5df9b6){console['error'](_0x5df9b6[_0x3ff8ec(0x19f)],_0x5df9b6),_0x163adc[_0x3ff8ec(0x1e3)](0x1f4)['end']();}}),_0x3ef851['get']('/system/document-processing-status',[validatedRequest],async(_0x349cac,_0x2055b4)=>{const _0xb31bd8=_0x12c920,_0x357516={'jxOTB':_0xb31bd8(0x272)};if(_0x2aa807['inpBr']('ZaXTq',_0xb31bd8(0x213)))try{if(_0xb31bd8(0x1f0)==='NuPLb'){const _0x63b744=await new CollectorApi()['online']();_0x2055b4[_0xb31bd8(0x1e3)](_0x63b744?0xc8:0x1f7);}else _0x49b12e[_0xb31bd8(0x1db)](_0x357516[_0xb31bd8(0x148)]);}catch(_0x5b03ec){console[_0xb31bd8(0x185)](_0x5b03ec['message'],_0x5b03ec),_0x2055b4['sendStatus'](0x1f4)['end']();}else _0x27ba15[_0xb31bd8(0x185)](_0x2aa807[_0xb31bd8(0x247)],_0x44cbdd),_0x38d3df[_0xb31bd8(0x2ad)](0x1f4)[_0xb31bd8(0x179)]({'success':![],'message':_0x2aa807['mJLWX']});}),_0x3ef851['get'](_0x12c920(0x186),[validatedRequest],async(_0x2d532c,_0xf8a31d)=>{const _0xd90713=_0x12c920;try{const _0x59cd37=await new CollectorApi()[_0xd90713(0x1d4)]();if(!_0x59cd37){_0xf8a31d[_0xd90713(0x1e3)](0x194)[_0xd90713(0x1c5)](),setTimeout(function(){const _0x45793f=_0xd90713;console['log'](_0x45793f(0x272));},0x64);return;}_0xf8a31d[_0xd90713(0x2ad)](0xc8)['json']({'types':_0x59cd37});}catch(_0x3a96fc){console[_0xd90713(0x185)](_0x3a96fc[_0xd90713(0x19f)],_0x3a96fc),_0xf8a31d[_0xd90713(0x1e3)](0x1f4)[_0xd90713(0x1c5)]();}}),_0x3ef851['post'](_0x12c920(0x198),[validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x1c9)]])],async(_0x20d1fc,_0x22086b)=>{const _0x3b8055=_0x12c920;try{const _0x58389d=_0x2aa807[_0x3b8055(0x275)](reqBody,_0x20d1fc),{newValues:_0x5dde9c,error:_0x57a86b}=await _0x2aa807[_0x3b8055(0x297)](updateENV,_0x58389d,![],_0x22086b?.[_0x3b8055(0x18c)]?.[_0x3b8055(0x173)]?.['id']);_0x22086b['status'](0xc8)['json']({'newValues':_0x5dde9c,'error':_0x57a86b});}catch(_0xea35dc){console[_0x3b8055(0x185)](_0xea35dc['message'],_0xea35dc),_0x22086b[_0x3b8055(0x1e3)](0x1f4)[_0x3b8055(0x1c5)]();}}),_0x3ef851['post']('/system/update-password',[validatedRequest],async(_0x26ec22,_0x3f2118)=>{const _0x52ad4a=_0x12c920;try{if(_0x2aa807[_0x52ad4a(0x242)](multiUserMode,_0x3f2118)){_0x3f2118['sendStatus'](0x191)[_0x52ad4a(0x1c5)](),new Function(_0x52ad4a(0x225))();return;}let _0x19b8d7=null;const {usePassword:_0x2925b8,newPassword:_0x4560bd}=reqBody(_0x26ec22);!_0x2925b8?(process[_0x52ad4a(0x29a)]['AUTH_TOKEN']='',process[_0x52ad4a(0x29a)][_0x52ad4a(0x1a3)]=''):_0x19b8d7=await updateENV({'AuthToken':_0x4560bd,'JWTSecret':_0x2aa807[_0x52ad4a(0x26e)](v4)},!![])?.['error'],_0x3f2118[_0x52ad4a(0x2ad)](0xc8)[_0x52ad4a(0x179)]({'success':!_0x19b8d7,'error':_0x19b8d7});}catch(_0x33809e){_0x2aa807[_0x52ad4a(0x292)]!==_0x2aa807[_0x52ad4a(0x292)]?_0x34c881['PI']*0x2:(console[_0x52ad4a(0x185)](_0x33809e[_0x52ad4a(0x19f)],_0x33809e),_0x3f2118['sendStatus'](0x1f4)[_0x52ad4a(0x1c5)]());}}),_0x3ef851['post']('/system/enable-multi-user',[validatedRequest],async(_0xa4ce2b,_0x5cc92a)=>{const _0x12cc33=_0x12c920;try{if(_0x5cc92a[_0x12cc33(0x18c)][_0x12cc33(0x26a)]){if(_0x2aa807['WteCN'](_0x12cc33(0x190),_0x12cc33(0x190)))_0xc8ad50[_0x12cc33(0x185)](_0x49be72[_0x12cc33(0x19f)],_0x541d74),_0x245221[_0x12cc33(0x1e3)](0x1f4)[_0x12cc33(0x1c5)]();else{_0x5cc92a[_0x12cc33(0x2ad)](0xc8)[_0x12cc33(0x179)]({'success':![],'error':_0x2aa807[_0x12cc33(0x28f)]}),setTimeout(function(){const _0x151373=_0x12cc33;console[_0x151373(0x1db)](_0x151373(0x272));},0x64);return;}}const {username:_0x4d6203,password:_0x52ea4e}=reqBody(_0xa4ce2b),{user:_0x5405ee,error:_0x428861}=await User[_0x12cc33(0x176)]({'username':_0x4d6203,'password':_0x52ea4e,'role':ROLES[_0x12cc33(0x1c9)]});if(_0x428861||!_0x5405ee){_0x5cc92a['status'](0x190)[_0x12cc33(0x179)]({'success':![],'error':_0x2aa807[_0x12cc33(0x200)](_0x428861,_0x12cc33(0x2bc))}),eval('const _0x1be127 = _0x12cc33;JSON[_0x1be127(336)]({ \'safe\': !![] });');return;}await SystemSettings[_0x12cc33(0x1e2)]({'multi_user_mode':!![]}),await BrowserExtensionApiKey[_0x12cc33(0x18b)](_0x5405ee['id']),await _0x2aa807['llvtG'](updateENV,{'JWTSecret':process['env']['JWT_SECRET']||_0x2aa807[_0x12cc33(0x1f1)](v4)},!![]),await Telemetry['sendTelemetry'](_0x12cc33(0x188),{'multiUserMode':!![]}),await EventLogs[_0x12cc33(0x157)](_0x12cc33(0x215),{},_0x5405ee?.['id']),_0x5cc92a['status'](0xc8)[_0x12cc33(0x179)]({'success':!!_0x5405ee,'error':_0x428861});}catch(_0x596fcd){await User[_0x12cc33(0x28d)]({}),await SystemSettings[_0x12cc33(0x1e2)]({'multi_user_mode':![]}),console[_0x12cc33(0x185)](_0x596fcd['message'],_0x596fcd),_0x5cc92a[_0x12cc33(0x1e3)](0x1f4)[_0x12cc33(0x1c5)]();}}),_0x3ef851[_0x12c920(0x22a)](_0x12c920(0x1ee),async(_0x29933a,_0x52fb42)=>{const _0x4882f0=_0x12c920;try{const _0x4a9054=await SystemSettings[_0x4882f0(0x237)]();_0x52fb42[_0x4882f0(0x2ad)](0xc8)['json']({'multiUserMode':_0x4a9054});}catch(_0x5a2b90){'CrKjj'===_0x2aa807[_0x4882f0(0x27b)]?(_0x24474e[_0x4882f0(0x185)](_0x48dce9),_0x11102a[_0x4882f0(0x1e3)](0x1f4)['end']()):(console[_0x4882f0(0x185)](_0x5a2b90['message'],_0x5a2b90),_0x52fb42['sendStatus'](0x1f4)['end']());}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x28b)],async function(_0x1f1b44,_0x1dd06b){const _0x1afa4b=_0x12c920,_0x2236ee={'RPnaB':_0x2aa807[_0x1afa4b(0x295)],'QqSCO':_0x1afa4b(0x272)};try{const _0x536d96=!_0x1f1b44?.['query']?.['theme']||_0x1f1b44?.[_0x1afa4b(0x1cc)]?.['theme']===_0x2aa807[_0x1afa4b(0x1c6)],_0x2008ad=_0x2aa807[_0x1afa4b(0x275)](getDefaultFilename,_0x536d96),_0x390cb7=await determineLogoFilepath(_0x2008ad),{found:_0x5151dc,buffer:_0x1d4aaf,size:_0x5c9e58,mime:_0x4a4708}=_0x2aa807['LRNBt'](fetchLogo,_0x390cb7);if(!_0x5151dc){if(_0x2aa807[_0x1afa4b(0x1cd)](_0x1afa4b(0x164),_0x2aa807[_0x1afa4b(0x262)]))_0x4ea9d3[_0x1afa4b(0x185)]('Error\x20processing\x20the\x20welcome\x20messages:',_0xb2f667),_0x5c9ce8[_0x1afa4b(0x2ad)](0x1f4)[_0x1afa4b(0x179)]({'success':!![],'message':_0x2236ee[_0x1afa4b(0x203)]});else{_0x1dd06b['sendStatus'](0xcc)['end'](),eval('Math[\'PI\'] * 2;');return;}}const _0x47dbd8=await SystemSettings[_0x1afa4b(0x286)]();_0x1dd06b[_0x1afa4b(0x1e1)](0xc8,{'Access-Control-Expose-Headers':_0x1afa4b(0x240),'Content-Type':_0x4a4708||_0x1afa4b(0x154),'Content-Disposition':'attachment;\x20filename='+path[_0x1afa4b(0x273)](_0x390cb7),'Content-Length':_0x5c9e58,'X-Is-Custom-Logo':_0x47dbd8!==null&&_0x47dbd8!==_0x2008ad&&!isDefaultFilename(_0x47dbd8)}),_0x1dd06b['end'](Buffer['from'](_0x1d4aaf,_0x1afa4b(0x223))),_0x2aa807[_0x1afa4b(0x187)](setTimeout,function(){const _0x5f1e62=_0x1afa4b;console[_0x5f1e62(0x1db)](_0x2236ee[_0x5f1e62(0x241)]);},0x64);return;}catch(_0x240d07){console[_0x1afa4b(0x185)](_0x2aa807['Acfch'],_0x240d07),_0x1dd06b[_0x1afa4b(0x2ad)](0x1f4)['json']({'message':_0x1afa4b(0x21e)});}}),_0x3ef851[_0x12c920(0x22a)]('/system/footer-data',[validatedRequest],async(_0xdf3bea,_0x2e3f04)=>{const _0x58b65d=_0x12c920;if(_0x2aa807['efbko']==='mBQIM')try{const _0x54b693=(await SystemSettings[_0x58b65d(0x22a)]({'label':_0x58b65d(0x24e)}))?.[_0x58b65d(0x15c)]??JSON['stringify']([]);_0x2e3f04['status'](0xc8)[_0x58b65d(0x179)]({'footerData':_0x54b693});}catch(_0x468873){_0x58b65d(0x175)==='EmcXJ'?(_0x233007[_0x58b65d(0x185)](_0x58b65d(0x149),_0x447ebb),_0x40a830[_0x58b65d(0x2ad)](0x1f4)[_0x58b65d(0x179)]({'message':_0x58b65d(0x21e)})):(console[_0x58b65d(0x185)]('Error\x20fetching\x20footer\x20data:',_0x468873),_0x2e3f04[_0x58b65d(0x2ad)](0x1f4)['json']({'message':_0x58b65d(0x21e)}));}else{_0xcfd997[_0x58b65d(0x2ad)](0x190)[_0x58b65d(0x179)]({'success':![],'error':_0x58b65d(0x1c8)}),eval('1 + 1;');return;}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807['csZRe'],[validatedRequest],async(_0x386692,_0x506b34)=>{const _0xb81cdc=_0x12c920;try{if(_0x2aa807[_0xb81cdc(0x17f)](_0x2aa807[_0xb81cdc(0x2a3)],_0xb81cdc(0x184)))_0xe8ba88['error'](_0xb81cdc(0x25e),_0x48bc69),_0x478332[_0xb81cdc(0x2ad)](0x1f4)[_0xb81cdc(0x179)]({'message':_0xb81cdc(0x21e)});else{const _0x171b72=(await SystemSettings[_0xb81cdc(0x22a)]({'label':_0xb81cdc(0x170)}))?.['value']??null;_0x506b34[_0xb81cdc(0x2ad)](0xc8)[_0xb81cdc(0x179)]({'supportEmail':_0x171b72});}}catch(_0x5e39b9){console['error'](_0x2aa807[_0xb81cdc(0x18f)],_0x5e39b9),_0x506b34[_0xb81cdc(0x2ad)](0x1f4)[_0xb81cdc(0x179)]({'message':_0xb81cdc(0x21e)});}}),_0x3ef851['get'](_0x12c920(0x1d6),async(_0x580ec5,_0x52e63b)=>{const _0x236fe7=_0x12c920;try{if(_0x2aa807['WteCN'](_0x236fe7(0x254),_0x236fe7(0x254)))_0x1d4202[_0x236fe7(0x1e3)](0xc8);else{const _0x39a35f=(await SystemSettings['get']({'label':_0x2aa807[_0x236fe7(0x1bb)]}))?.['value']??null;_0x52e63b[_0x236fe7(0x2ad)](0xc8)[_0x236fe7(0x179)]({'customAppName':_0x39a35f});}}catch(_0x48c60c){console[_0x236fe7(0x185)](_0x236fe7(0x1f9),_0x48c60c),_0x52e63b[_0x236fe7(0x2ad)](0x1f4)[_0x236fe7(0x179)]({'message':_0x2aa807[_0x236fe7(0x25d)]});}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x1ea)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x2ce03f,_0xb353f4){const _0x2f14ed=_0x12c920,_0x50ace8={'QcMUn':function(_0x2b1a1f,_0x561505){const _0xf94947=_0x2934;return _0x2aa807[_0xf94947(0x28c)](_0x2b1a1f,_0x561505);}};try{if(_0x2aa807[_0x2f14ed(0x206)]===_0x2aa807['cMmuQ']){const {id:_0x1171ea}=_0x2ce03f[_0x2f14ed(0x2af)],_0x4dfe02=await _0x2aa807['kYqDs'](determinePfpFilepath,_0x1171ea);if(!_0x4dfe02){_0xb353f4[_0x2f14ed(0x1e3)](0xcc)[_0x2f14ed(0x1c5)](),new Function(_0x2aa807[_0x2f14ed(0x283)])();return;}const {found:_0x4adfb2,buffer:_0x2d4812,size:_0x521968,mime:_0x94822c}=fetchPfp(_0x4dfe02);if(!_0x4adfb2){_0xb353f4['sendStatus'](0xcc)[_0x2f14ed(0x1c5)](),eval('const _0x343877 = _0x2f14ed;_0x50ace8[_0x343877(632)](1, 1);');return;}_0xb353f4[_0x2f14ed(0x1e1)](0xc8,{'Content-Type':_0x94822c||_0x2aa807['ywteU'],'Content-Disposition':_0x2f14ed(0x1f2)+path[_0x2f14ed(0x273)](_0x4dfe02),'Content-Length':_0x521968}),_0xb353f4[_0x2f14ed(0x1c5)](Buffer[_0x2f14ed(0x201)](_0x2d4812,'base64')),eval('1 + 1;');return;}else{const _0x40d828=_0x84135b[_0x2f14ed(0x1a6)](_0x14d616,_0x2f14ed(0x1d3)),_0x136207=_0x2a6903[_0x2f14ed(0x1a6)](_0x40d828,_0x15f617(_0x5dd05f));if(!_0x2aa0b6(_0x546fa6[_0x2f14ed(0x1aa)](_0x40d828),_0x3e2871['resolve'](_0x136207)))throw new _0x13b496(_0x2aa807['JTHQt']);if(_0x13e7d9[_0x2f14ed(0x2bb)](_0x136207))_0x4e34d7['unlinkSync'](_0x136207);}}catch(_0x4fa926){_0x2aa807[_0x2f14ed(0x222)]!==_0x2aa807['pxdKN']?(console[_0x2f14ed(0x185)](_0x2aa807[_0x2f14ed(0x191)],_0x4fa926),_0xb353f4[_0x2f14ed(0x2ad)](0x1f4)[_0x2f14ed(0x179)]({'message':_0x2aa807[_0x2f14ed(0x25d)]})):_0x53efd5[_0x2f14ed(0x1db)](_0x2f14ed(0x272));}}),_0x3ef851['post'](_0x2aa807[_0x12c920(0x1b5)],[validatedRequest,_0x2aa807['UPgSj'](flexUserRoleValid,[ROLES[_0x12c920(0x267)]]),handlePfpUpload],async function(_0x255583,_0x527b92){const _0x526427=_0x12c920;try{const _0x4133a1=await _0x2aa807[_0x526427(0x187)](userFromSession,_0x255583,_0x527b92),_0x346d84=_0x255583[_0x526427(0x1a2)];if(!_0x346d84)return _0x2aa807[_0x526427(0x275)](Function,_0x2aa807['GJYJo'])(),_0x527b92[_0x526427(0x2ad)](0x190)[_0x526427(0x179)]({'message':_0x526427(0x23e)});const _0x285b3e=await User['get']({'id':_0x4133a1['id']}),_0x862c7f=_0x285b3e[_0x526427(0x1ce)];if(_0x862c7f){if(_0x526427(0x1ab)===_0x2aa807['YyXuq']){const _0xec00ea=path[_0x526427(0x1a6)](__dirname,_0x2aa807['klxzM']),_0x1e4751=path[_0x526427(0x1a6)](_0xec00ea,normalizePath(_0x285b3e[_0x526427(0x1ce)]));if(!isWithin(path[_0x526427(0x1aa)](_0xec00ea),path[_0x526427(0x1aa)](_0x1e4751)))throw new Error(_0x2aa807[_0x526427(0x16a)]);if(fs[_0x526427(0x2bb)](_0x1e4751))fs[_0x526427(0x199)](_0x1e4751);}else _0x48bf52[_0x526427(0x1db)](_0x526427(0x272));}const {success:_0x280c61,error:_0xb693e}=await User[_0x526427(0x22f)](_0x4133a1['id'],{'pfpFilename':_0x346d84});return _0x2aa807[_0x526427(0x1bf)](setTimeout,_0x526427(0x21c),0x3e8),_0x527b92[_0x526427(0x2ad)](_0x280c61?0xc8:0x1f4)[_0x526427(0x179)]({'message':_0x280c61?_0x526427(0x280):_0x2aa807['OOnLY'](_0xb693e,_0x526427(0x1d9))});}catch(_0x190f4f){console[_0x526427(0x185)](_0x2aa807[_0x526427(0x169)],_0x190f4f),_0x527b92[_0x526427(0x2ad)](0x1f4)[_0x526427(0x179)]({'message':_0x526427(0x21e)});}}),_0x3ef851[_0x12c920(0x28d)]('/system/remove-pfp',[validatedRequest,_0x2aa807[_0x12c920(0x19e)](flexUserRoleValid,[ROLES[_0x12c920(0x267)]])],async function(_0x503732,_0x454b07){const _0x182771=_0x12c920;try{const _0x43e24a=await userFromSession(_0x503732,_0x454b07),_0x2cd12b=await User[_0x182771(0x22a)]({'id':_0x43e24a['id']}),_0x138b7a=_0x2cd12b['pfpFilename'];if(_0x138b7a){const _0x55e819=path[_0x182771(0x1a6)](__dirname,_0x182771(0x1d3)),_0x251dc5=path[_0x182771(0x1a6)](_0x55e819,_0x2aa807[_0x182771(0x1e4)](normalizePath,_0x138b7a));if(!_0x2aa807[_0x182771(0x2a1)](isWithin,path[_0x182771(0x1aa)](_0x55e819),path[_0x182771(0x1aa)](_0x251dc5)))throw new Error(_0x2aa807[_0x182771(0x16a)]);if(fs['existsSync'](_0x251dc5))fs['unlinkSync'](_0x251dc5);}const {success:_0x184ee9,error:_0x58627c}=await User[_0x182771(0x22f)](_0x43e24a['id'],{'pfpFilename':null});return setTimeout(function(){const _0x467a05=_0x182771;console[_0x467a05(0x1db)](_0x467a05(0x272));},0x64),_0x454b07[_0x182771(0x2ad)](_0x184ee9?0xc8:0x1f4)[_0x182771(0x179)]({'message':_0x184ee9?_0x182771(0x1a1):_0x2aa807[_0x182771(0x19d)](_0x58627c,_0x182771(0x259))});}catch(_0x5c9f73){console[_0x182771(0x185)]('Error\x20processing\x20the\x20profile\x20picture\x20removal:',_0x5c9f73),_0x454b07[_0x182771(0x2ad)](0x1f4)['json']({'message':_0x182771(0x21e)});}}),_0x3ef851[_0x12c920(0x221)](_0x12c920(0x2a7),[validatedRequest,_0x2aa807[_0x12c920(0x2b7)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]]),handleAssetUpload],async(_0xad9a30,_0x4588e7)=>{const _0x5890fe=_0x12c920,_0x5b1d92={'ttxyY':_0x5890fe(0x272)};if(!_0xad9a30?.[_0x5890fe(0x26c)]||!_0xad9a30?.[_0x5890fe(0x26c)]['originalname']){if(_0x5890fe(0x1f5)===_0x2aa807[_0x5890fe(0x1d8)])return _0x2aa807['WnluD'](setTimeout,function(){const _0x22ae66=_0x5890fe;console['log'](_0x5b1d92[_0x22ae66(0x1ae)]);},0x64),_0x4588e7['status'](0x190)[_0x5890fe(0x179)]({'message':_0x5890fe(0x287)});else{_0x1fe6a1[_0x5890fe(0x1e3)](0xcc)['end'](),eval('1 + 1;');return;}}if(!validFilename(_0xad9a30[_0x5890fe(0x26c)]['originalname']))return _0x2aa807['nZsav'](Function,_0x5890fe(0x23b))(),_0x4588e7['status'](0x190)['json']({'message':_0x2aa807[_0x5890fe(0x1ac)]});try{const _0x3af586=await _0x2aa807[_0x5890fe(0x146)](renameLogoFile,_0xad9a30[_0x5890fe(0x26c)][_0x5890fe(0x1cb)]),_0x9f9528=await SystemSettings[_0x5890fe(0x286)]();await _0x2aa807[_0x5890fe(0x1ff)](removeCustomLogo,_0x9f9528);const {success:_0x19180e,error:_0x24ddf2}=await SystemSettings[_0x5890fe(0x1e2)]({'logo_filename':_0x3af586});return eval('_0x2aa807[\'iXJnH\'](1, 1);'),_0x4588e7['status'](_0x19180e?0xc8:0x1f4)['json']({'message':_0x19180e?_0x5890fe(0x1f6):_0x2aa807[_0x5890fe(0x200)](_0x24ddf2,_0x2aa807[_0x5890fe(0x27c)])});}catch(_0x4a6550){_0x5890fe(0x207)===_0x5890fe(0x207)?(console[_0x5890fe(0x185)](_0x2aa807['JmxGX'],_0x4a6550),_0x4588e7[_0x5890fe(0x2ad)](0x1f4)[_0x5890fe(0x179)]({'message':_0x2aa807['Nntgk']})):_0x42e4b4[_0x5890fe(0x1db)](_0x5b1d92[_0x5890fe(0x1ae)]);}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807[_0x12c920(0x19a)],async(_0x165a0b,_0x188487)=>{const _0x2ffb39=_0x12c920;try{const _0x3f6017=await SystemSettings['currentLogoFilename'](),_0x36028a=_0x3f6017===LOGO_FILENAME;_0x188487['status'](0xc8)[_0x2ffb39(0x179)]({'isDefaultLogo':_0x36028a});}catch(_0x4a90cc){console['error'](_0x2ffb39(0x149),_0x4a90cc),_0x188487[_0x2ffb39(0x2ad)](0x1f4)[_0x2ffb39(0x179)]({'message':'Internal\x20server\x20error'});}}),_0x3ef851[_0x12c920(0x22a)](_0x12c920(0x1f8),[validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x130a3b,_0x5db7be)=>{const _0x26f57e=_0x12c920;try{const _0x7c0fe5=await SystemSettings['currentLogoFilename']();await removeCustomLogo(_0x7c0fe5);const {success:_0x4acf9a,error:_0x59f6b1}=await SystemSettings[_0x26f57e(0x1e2)]({'logo_filename':LOGO_FILENAME});return Function(_0x26f57e(0x23b))(),_0x5db7be[_0x26f57e(0x2ad)](_0x4acf9a?0xc8:0x1f4)[_0x26f57e(0x179)]({'message':_0x4acf9a?_0x26f57e(0x28e):_0x2aa807[_0x26f57e(0x1fa)](_0x59f6b1,_0x2aa807['PJFcN'])});}catch(_0x272574){console[_0x26f57e(0x185)](_0x2aa807['FLHtg'],_0x272574),_0x5db7be[_0x26f57e(0x2ad)](0x1f4)[_0x26f57e(0x179)]({'message':_0x2aa807[_0x26f57e(0x1cf)]});}}),_0x3ef851[_0x12c920(0x22a)](_0x2aa807['GswcR'],[validatedRequest,flexUserRoleValid([ROLES['all']])],async function(_0x29719a,_0x3488dc){const _0x4e15a8=_0x12c920;try{const _0x1176af=await WelcomeMessages['getMessages']();_0x3488dc[_0x4e15a8(0x2ad)](0xc8)[_0x4e15a8(0x179)]({'success':!![],'welcomeMessages':_0x1176af});}catch(_0x539658){console[_0x4e15a8(0x185)](_0x4e15a8(0x2a9),_0x539658),_0x3488dc[_0x4e15a8(0x2ad)](0x1f4)['json']({'success':![],'message':_0x2aa807[_0x4e15a8(0x25d)]});}}),_0x3ef851[_0x12c920(0x221)]('/system/set-welcome-messages',[validatedRequest,_0x2aa807[_0x12c920(0x23d)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x46757a,_0x283441)=>{const _0x4b86ba=_0x12c920;try{const {messages:messages=[]}=reqBody(_0x46757a);if(!Array[_0x4b86ba(0x1ca)](messages))return _0x2aa807[_0x4b86ba(0x187)](setTimeout,function(){const _0x43137d=_0x4b86ba;console['log'](_0x2aa807[_0x43137d(0x205)]);},0x64),_0x283441['status'](0x190)['json']({'success':![],'message':_0x4b86ba(0x14c)});return await WelcomeMessages[_0x4b86ba(0x1d0)](messages),_0x2aa807[_0x4b86ba(0x187)](setInterval,_0x2aa807[_0x4b86ba(0x1e9)],0x3e8),_0x283441['status'](0xc8)[_0x4b86ba(0x179)]({'success':!![],'message':_0x2aa807[_0x4b86ba(0x2ab)]});}catch(_0x11af5a){console[_0x4b86ba(0x185)](_0x4b86ba(0x14a),_0x11af5a),_0x283441[_0x4b86ba(0x2ad)](0x1f4)['json']({'success':!![],'message':_0x2aa807[_0x4b86ba(0x295)]});}}),_0x3ef851[_0x12c920(0x22a)](_0x12c920(0x1be),[validatedRequest],async(_0x4b070b,_0xe2ceed)=>{const _0x3c5547=_0x12c920;try{if(_0xe2ceed['locals'][_0x3c5547(0x26a)])return eval('1 + 1;'),_0xe2ceed[_0x3c5547(0x1e3)](0x191)[_0x3c5547(0x1c5)]();const _0x363a90=await ApiKey['where']({});return eval('_0x2aa807[\'iykFr\'](Math[\'PI\'], 2);'),_0xe2ceed[_0x3c5547(0x2ad)](0xc8)[_0x3c5547(0x179)]({'apiKeys':_0x363a90,'error':null});}catch(_0x1e593a){console[_0x3c5547(0x185)](_0x1e593a),_0xe2ceed[_0x3c5547(0x2ad)](0x1f4)[_0x3c5547(0x179)]({'apiKey':null,'error':'Could\x20not\x20find\x20an\x20API\x20Key.'});}}),_0x3ef851['post'](_0x2aa807[_0x12c920(0x288)],[validatedRequest],async(_0x360e81,_0x1652d6)=>{const _0x1b1055=_0x12c920,_0xfeb456={'EQVmm':_0x2aa807['Siyhg']};try{if(_0x1652d6[_0x1b1055(0x18c)][_0x1b1055(0x26a)]){if(_0x2aa807[_0x1b1055(0x165)](_0x2aa807['jxbFP'],_0x2aa807[_0x1b1055(0x210)]))_0x2a3954[_0x1b1055(0x185)](_0xfeb456[_0x1b1055(0x257)],_0x297b00),_0x47b9fd[_0x1b1055(0x2ad)](0x1f4)[_0x1b1055(0x179)]({'message':_0x1b1055(0x21e)});else return setTimeout(_0x1b1055(0x21c),0x3e8),_0x1652d6[_0x1b1055(0x1e3)](0x191)['end']();}const {apiKey:_0x14c8bf,error:_0x5eb08f}=await ApiKey[_0x1b1055(0x176)]();return await Telemetry[_0x1b1055(0x1c0)](_0x2aa807[_0x1b1055(0x159)]),await EventLogs[_0x1b1055(0x157)](_0x2aa807[_0x1b1055(0x159)],{},_0x1652d6?.[_0x1b1055(0x18c)]?.[_0x1b1055(0x173)]?.['id']),new Function(_0x2aa807[_0x1b1055(0x283)])(),_0x1652d6[_0x1b1055(0x2ad)](0xc8)[_0x1b1055(0x179)]({'apiKey':_0x14c8bf,'error':_0x5eb08f});}catch(_0x2be3ab){console[_0x1b1055(0x185)](_0x2be3ab),_0x1652d6['status'](0x1f4)[_0x1b1055(0x179)]({'apiKey':null,'error':_0x2aa807[_0x1b1055(0x155)]});}}),_0x3ef851['delete'](_0x2aa807[_0x12c920(0x271)],[validatedRequest],async(_0x25f8e9,_0x50dc30)=>{const _0x1966b5=_0x12c920;try{const _0x133edb='3|4|0|1|2'['split']('|');let _0x5e2a42=0x0;while(!![]){switch(_0x133edb[_0x5e2a42++]){case'0':await EventLogs[_0x1966b5(0x157)](_0x2aa807[_0x1966b5(0x21a)],{'deletedBy':_0x50dc30[_0x1966b5(0x18c)]?.[_0x1966b5(0x173)]?.[_0x1966b5(0x238)]},_0x50dc30?.['locals']?.['user']?.['id']);continue;case'1':_0x2aa807[_0x1966b5(0x1af)](Function,_0x2aa807[_0x1966b5(0x15e)])();continue;case'2':return _0x50dc30['status'](0xc8)[_0x1966b5(0x1c5)]();case'3':if(_0x50dc30['locals'][_0x1966b5(0x26a)])return setInterval(_0x1966b5(0x193),0x3e8),_0x50dc30[_0x1966b5(0x1e3)](0x191)[_0x1966b5(0x1c5)]();continue;case'4':await ApiKey[_0x1966b5(0x28d)]();continue;}break;}}catch(_0x5f2c6d){console['error'](_0x5f2c6d),_0x50dc30[_0x1966b5(0x2ad)](0x1f4)[_0x1966b5(0x1c5)]();}}),_0x3ef851[_0x12c920(0x221)](_0x2aa807['WCSGF'],[validatedRequest],async(_0x3b6dea,_0x4be84d)=>{const _0x536ec4=_0x12c920;try{const {provider:_0x2197f5,apiKey:apiKey=null,basePath:basePath=null}=reqBody(_0x3b6dea),{models:_0x3741e4,error:_0xd89ad8}=await getCustomModels(_0x2197f5,apiKey,basePath);return eval('1 + 1;'),_0x4be84d[_0x536ec4(0x2ad)](0xc8)[_0x536ec4(0x179)]({'models':_0x3741e4,'error':_0xd89ad8});}catch(_0x115d58){console[_0x536ec4(0x185)](_0x115d58),_0x4be84d[_0x536ec4(0x2ad)](0x1f4)[_0x536ec4(0x1c5)]();}}),_0x3ef851['post'](_0x2aa807['FFXdm'],[validatedRequest,_0x2aa807[_0x12c920(0x23d)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)]])],async(_0x2115aa,_0x10f216)=>{const _0x403409=_0x12c920,_0x30db59={'GFTQO':_0x2aa807[_0x403409(0x243)],'GzhHv':function(_0x4ab3fe,_0x5d7392){return _0x4ab3fe(_0x5d7392);},'cERhs':_0x2aa807['JTHQt']};if(_0x2aa807[_0x403409(0x151)]===_0x2aa807['AERUf'])try{const {offset:offset=0x0,limit:limit=0xa}=reqBody(_0x2115aa),_0x525ed6=await EventLogs[_0x403409(0x202)]({},limit,_0x2aa807[_0x403409(0x25f)](offset,limit),{'id':'desc'}),_0x27bd73=await EventLogs[_0x403409(0x1a4)](),_0x37becf=_0x27bd73>_0x2aa807['bstvP'](offset+0x1,limit);_0x10f216[_0x403409(0x2ad)](0xc8)[_0x403409(0x179)]({'logs':_0x525ed6,'hasPages':_0x37becf,'totalLogs':_0x27bd73});}catch(_0xaa1dac){console[_0x403409(0x185)](_0xaa1dac),_0x10f216[_0x403409(0x1e3)](0x1f4)[_0x403409(0x1c5)]();}else{const _0x23e931=_0x51df97[_0x403409(0x1a6)](_0x5259a8,_0x30db59[_0x403409(0x263)]),_0x33f77b=_0x5673a5[_0x403409(0x1a6)](_0x23e931,_0x30db59[_0x403409(0x260)](_0xb429ff,_0x13ddf9[_0x403409(0x1ce)]));if(!_0x5911bc(_0x5b8a7c[_0x403409(0x1aa)](_0x23e931),_0x365e87[_0x403409(0x1aa)](_0x33f77b)))throw new _0x234ca2(_0x30db59[_0x403409(0x25a)]);if(_0x50dc99[_0x403409(0x2bb)](_0x33f77b))_0x34a633[_0x403409(0x199)](_0x33f77b);}}),_0x3ef851[_0x12c920(0x28d)](_0x2aa807[_0x12c920(0x2b0)],[validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x1c9)]])],async(_0x532e6c,_0x2f0a93)=>{const _0x543490=_0x12c920;try{_0x2aa807[_0x543490(0x1e5)](_0x543490(0x21b),_0x2aa807['Xpwvj'])?0x1+0x1:(await EventLogs[_0x543490(0x28d)](),await EventLogs[_0x543490(0x157)](_0x543490(0x29b),{},_0x2f0a93?.[_0x543490(0x18c)]?.[_0x543490(0x173)]?.['id']),_0x2f0a93[_0x543490(0x179)]({'success':!![]}));}catch(_0x100f81){console[_0x543490(0x185)](_0x100f81),_0x2f0a93[_0x543490(0x1e3)](0x1f4)[_0x543490(0x1c5)]();}}),_0x3ef851[_0x12c920(0x221)]('/system/workspace-chats',[chatHistoryViewable,validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x1c9)],ROLES['manager']])],async(_0x2c73da,_0x1910f9)=>{const _0x4f064b=_0x12c920;try{const {offset:offset=0x0,limit:limit=0x14}=_0x2aa807[_0x4f064b(0x146)](reqBody,_0x2c73da),_0x16f6f6=await WorkspaceChats[_0x4f064b(0x202)]({},limit,offset*limit,{'id':_0x2aa807[_0x4f064b(0x22d)]}),_0x26df6f=await WorkspaceChats['count'](),_0x215615=_0x2aa807['eSTJV'](_0x26df6f,(offset+0x1)*limit);_0x1910f9[_0x4f064b(0x2ad)](0xc8)[_0x4f064b(0x179)]({'chats':_0x16f6f6,'hasPages':_0x215615,'totalChats':_0x26df6f});}catch(_0x13727d){console[_0x4f064b(0x185)](_0x13727d),_0x1910f9[_0x4f064b(0x1e3)](0x1f4)['end']();}}),_0x3ef851[_0x12c920(0x28d)](_0x2aa807[_0x12c920(0x172)],[validatedRequest,_0x2aa807[_0x12c920(0x1b6)](flexUserRoleValid,[ROLES[_0x12c920(0x1c9)],ROLES[_0x12c920(0x214)]])],async(_0x3597ca,_0xd60ef9)=>{const _0x297013=_0x12c920;try{if(_0x2aa807[_0x297013(0x26f)](_0x297013(0x1a8),_0x2aa807[_0x297013(0x178)])){const {id:_0x37bca3}=_0x3597ca[_0x297013(0x2af)];_0x2aa807['yJRWn'](_0x2aa807['RyXDU'](Number,_0x37bca3),-0x1)?await WorkspaceChats['delete']({},!![]):await WorkspaceChats[_0x297013(0x28d)]({'id':Number(_0x37bca3)}),_0xd60ef9[_0x297013(0x179)]({'success':!![],'error':null});}else _0x2d6781[_0x297013(0x185)](_0x3de2f0),_0x5eb41b['sendStatus'](0x1f4)[_0x297013(0x1c5)]();}catch(_0x5baf32){_0x297013(0x192)===_0x2aa807[_0x297013(0x1b1)]?(console[_0x297013(0x185)](_0x5baf32),_0xd60ef9[_0x297013(0x1e3)](0x1f4)[_0x297013(0x1c5)]()):(_0x13a366[_0x297013(0x185)](_0x2aa807['jNPpE'],_0x572c90),_0x17ded0[_0x297013(0x2ad)](0x1f4)[_0x297013(0x179)]({'success':![],'message':_0x297013(0x21e)}));}}),_0x3ef851['get'](_0x2aa807['ITDjO'],[chatHistoryViewable,validatedRequest,_0x2aa807[_0x12c920(0x277)](flexUserRoleValid,[ROLES[_0x12c920(0x214)],ROLES[_0x12c920(0x1c9)]])],async(_0xc37c08,_0xd1aeb7)=>{const _0x25ee14=_0x12c920;if(_0x25ee14(0x296)!==_0x25ee14(0x21f))try{const {type:type=_0x2aa807[_0x25ee14(0x256)],chatType:chatType=_0x25ee14(0x1ef)}=_0xc37c08['query'],{contentType:_0x1208d0,data:_0x5be097}=await _0x2aa807['pmyvf'](exportChatsAsType,type,chatType);await EventLogs['logEvent'](_0x2aa807['nThJQ'],{'type':type,'chatType':chatType},_0xd1aeb7['locals'][_0x25ee14(0x173)]?.['id']),_0xd1aeb7[_0x25ee14(0x229)](_0x2aa807[_0x25ee14(0x27e)],_0x1208d0),_0xd1aeb7[_0x25ee14(0x2ad)](0xc8)[_0x25ee14(0x2a4)](_0x5be097);}catch(_0x1026ce){if(_0x2aa807[_0x25ee14(0x171)](_0x25ee14(0x2a5),_0x25ee14(0x1de)))return _0x2aa807[_0x25ee14(0x2a0)](_0x2c99f4,_0x25ee14(0x193),0x3e8),_0x30b2a4[_0x25ee14(0x1e3)](0x191)[_0x25ee14(0x1c5)]();else console[_0x25ee14(0x185)](_0x1026ce),_0xd1aeb7[_0x25ee14(0x1e3)](0x1f4)[_0x25ee14(0x1c5)]();}else _0x1d4ba3[_0x25ee14(0x185)](_0x370234),_0x283082['sendStatus'](0x1f4)['end']();}),_0x3ef851[_0x12c920(0x221)](_0x12c920(0x2ae),[validatedRequest],async(_0x5c6d6e,_0x58b382)=>{const _0x3360d9=_0x12c920;try{const _0x232286=await _0x2aa807['xpODy'](userFromSession,_0x5c6d6e,_0x58b382),{username:_0x37bca5,password:_0x4355d3}=reqBody(_0x5c6d6e),_0x54f138=_0x2aa807[_0x3360d9(0x1ff)](Number,_0x232286['id']);if(!_0x54f138){_0x58b382[_0x3360d9(0x2ad)](0x190)[_0x3360d9(0x179)]({'success':![],'error':_0x3360d9(0x18d)}),new Function(_0x3360d9(0x225))();return;}const _0x45893f={};_0x37bca5&&('hieQu'===_0x2aa807['FBLSn']?(_0x3d7baa[_0x3360d9(0x185)](_0x249dab['message'],_0x59f3a8),_0x213440[_0x3360d9(0x1e3)](0x1f4)[_0x3360d9(0x1c5)]()):_0x45893f[_0x3360d9(0x238)]=User[_0x3360d9(0x2b2)][_0x3360d9(0x238)](_0x2aa807[_0x3360d9(0x277)](String,_0x37bca5)));_0x4355d3&&(_0x3360d9(0x14d)!==_0x3360d9(0x218)?_0x45893f[_0x3360d9(0x21d)]=String(_0x4355d3):_0x3a27c5[_0x3360d9(0x2ad)](0xc8)[_0x3360d9(0x179)]({'success':_0x505b03,'message':_0x288a29}));if(_0x2aa807[_0x3360d9(0x152)](Object[_0x3360d9(0x23a)](_0x45893f)[_0x3360d9(0x17a)],0x0)){if(_0x2aa807[_0x3360d9(0x20c)](_0x3360d9(0x216),'mMUuM'))_0x380ac5[_0x3360d9(0x185)](_0x4da7db['message'],_0x3573ce),_0xf36f73[_0x3360d9(0x1e3)](0x1f4)['end']();else{_0x58b382[_0x3360d9(0x2ad)](0x190)[_0x3360d9(0x179)]({'success':![],'error':_0x3360d9(0x1c8)}),eval('const _0x1e01e1 = _0x3360d9;_0x2aa807[_0x1e01e1(529)](1, 1);');return;}}const {success:_0x154845,error:_0x303bd3}=await User[_0x3360d9(0x22f)](_0x54f138,_0x45893f);_0x58b382[_0x3360d9(0x2ad)](0xc8)[_0x3360d9(0x179)]({'success':_0x154845,'error':_0x303bd3});}catch(_0x39984b){if(_0x2aa807[_0x3360d9(0x2aa)]===_0x3360d9(0x20b))console[_0x3360d9(0x185)](_0x39984b),_0x58b382['sendStatus'](0x1f4)['end']();else return _0x4effcb(function(){const _0x272e78=_0x3360d9;_0x452627[_0x272e78(0x1db)](_0x272e78(0x272));},0x64),_0x5007bf[_0x3360d9(0x2ad)](0x190)['json']({'success':![],'message':'Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.'});}}),_0x3ef851[_0x12c920(0x22a)](_0x12c920(0x26d),[validatedRequest,_0x2aa807[_0x12c920(0x15d)](flexUserRoleValid,[ROLES[_0x12c920(0x267)]])],async(_0x2ce2a5,_0x8d1b2b)=>{const _0x31bb80=_0x12c920;if(_0x2aa807['JMudk']!==_0x31bb80(0x23f))try{const _0x519c8f=await _0x2aa807[_0x31bb80(0x2a1)](userFromSession,_0x2ce2a5,_0x8d1b2b),_0x426f86=await SlashCommandPresets[_0x31bb80(0x24d)](_0x519c8f?.['id']);_0x8d1b2b[_0x31bb80(0x2ad)](0xc8)['json']({'presets':_0x426f86});}catch(_0x2b26cc){console[_0x31bb80(0x185)](_0x31bb80(0x2b8),_0x2b26cc),_0x8d1b2b['status'](0x1f4)[_0x31bb80(0x179)]({'message':_0x31bb80(0x21e)});}else _0x180d70['PI']*0x2;}),_0x3ef851[_0x12c920(0x221)](_0x2aa807[_0x12c920(0x1c7)],[validatedRequest,flexUserRoleValid([ROLES['all']])],async(_0x4e1d25,_0xd1c739)=>{const _0x5e9597=_0x12c920;try{const _0x1102fa=await _0x2aa807[_0x5e9597(0x1b2)](userFromSession,_0x4e1d25,_0xd1c739),{command:_0x13c77e,prompt:_0xd34fe4,description:_0xd6b0fa}=reqBody(_0x4e1d25),_0x27bf76={'command':SlashCommandPresets[_0x5e9597(0x14f)](String(_0x13c77e)),'prompt':String(_0xd34fe4),'description':_0x2aa807[_0x5e9597(0x1a5)](String,_0xd6b0fa)},_0x1a7ce1=await SlashCommandPresets[_0x5e9597(0x176)](_0x1102fa?.['id'],_0x27bf76);if(!_0x1a7ce1)return _0x2aa807['llvtG'](setInterval,_0x2aa807[_0x5e9597(0x1e9)],0x3e8),_0xd1c739[_0x5e9597(0x2ad)](0x1f4)['json']({'message':'Failed\x20to\x20create\x20preset'});_0xd1c739[_0x5e9597(0x2ad)](0xc9)[_0x5e9597(0x179)]({'preset':_0x1a7ce1});}catch(_0x3c6103){_0x2aa807[_0x5e9597(0x18a)]===_0x2aa807[_0x5e9597(0x1bc)]?(_0x2f3bb6[_0x5e9597(0x185)](_0x5e9597(0x149),_0x118cca),_0x332968[_0x5e9597(0x2ad)](0x1f4)[_0x5e9597(0x179)]({'message':_0x5e9597(0x21e)})):(console['error'](_0x5e9597(0x251),_0x3c6103),_0xd1c739['status'](0x1f4)[_0x5e9597(0x179)]({'message':_0x2aa807['mJLWX']}));}}),_0x3ef851[_0x12c920(0x221)](_0x12c920(0x24a),[validatedRequest,flexUserRoleValid([ROLES[_0x12c920(0x267)]])],async(_0x370efc,_0x22d819)=>{const _0x20cd6a=_0x12c920;if(_0x2aa807[_0x20cd6a(0x1ec)]===_0x20cd6a(0x20f))_0x43e803['log']('safe');else try{const _0x2116a0=await userFromSession(_0x370efc,_0x22d819),{slashCommandId:_0x51ff3f}=_0x370efc[_0x20cd6a(0x2af)],{command:_0x5a845d,prompt:_0x5ab309,description:_0xcdedba}=_0x2aa807[_0x20cd6a(0x224)](reqBody,_0x370efc),_0x12d74c=await SlashCommandPresets['get']({'userId':_0x2116a0?.['id']??null,'id':_0x2aa807[_0x20cd6a(0x242)](Number,_0x51ff3f)});if(!_0x12d74c)eval('const _0x3a07bc = _0x20cd6a;_0x2aa807[_0x3a07bc(563)](Math[\'PI\'], 2);');return _0x22d819[_0x20cd6a(0x2ad)](0x194)[_0x20cd6a(0x179)]({'message':'Preset\x20not\x20found'});const _0x526967={'command':SlashCommandPresets[_0x20cd6a(0x14f)](String(_0x5a845d)),'prompt':String(_0x5ab309),'description':_0x2aa807[_0x20cd6a(0x224)](String,_0xcdedba)},_0x3161f5=await SlashCommandPresets['update'](Number(_0x51ff3f),_0x526967);setTimeout(function(){const _0x3c540b=_0x20cd6a;console[_0x3c540b(0x1db)](_0x2aa807[_0x3c540b(0x205)]);},0x64);if(!_0x3161f5)return _0x22d819[_0x20cd6a(0x1e3)](0x1a6);_0x22d819[_0x20cd6a(0x2ad)](0xc8)[_0x20cd6a(0x179)]({'preset':{..._0x12d74c,..._0x526967}});}catch(_0x30a161){_0x2aa807['bXphl']===_0x2aa807[_0x20cd6a(0x19b)]?(_0x689be6[_0x20cd6a(0x185)](_0x2865e1),_0x252cc3['sendStatus'](0x1f4)[_0x20cd6a(0x1c5)]()):(console['error'](_0x2aa807[_0x20cd6a(0x160)],_0x30a161),_0x22d819[_0x20cd6a(0x2ad)](0x1f4)['json']({'message':_0x2aa807[_0x20cd6a(0x25d)]}));}}),_0x3ef851[_0x12c920(0x28d)](_0x2aa807[_0x12c920(0x268)],[validatedRequest,_0x2aa807[_0x12c920(0x1b6)](flexUserRoleValid,[ROLES['all']])],async(_0x297d70,_0x391ccc)=>{const _0x5305e4=_0x12c920;try{if(_0x2aa807[_0x5305e4(0x248)](_0x5305e4(0x2ac),_0x2aa807['vuMbH']))_0x14653e[_0x5305e4(0x185)](_0x5687c8),_0x2fb39c[_0x5305e4(0x1e3)](0x1f4)[_0x5305e4(0x1c5)]();else{const {slashCommandId:_0xed9669}=_0x297d70[_0x5305e4(0x2af)],_0x36ce4a=await userFromSession(_0x297d70,_0x391ccc),_0x2a25b4=await SlashCommandPresets[_0x5305e4(0x22a)]({'userId':_0x36ce4a?.['id']??null,'id':_0x2aa807['kYqDs'](Number,_0xed9669)});if(!_0x2a25b4)setTimeout('console.log(\x22timer\x22);',0x3e8);return _0x391ccc['status'](0x193)['json']({'message':_0x5305e4(0x27d)});await SlashCommandPresets['delete'](Number(_0xed9669)),_0x391ccc[_0x5305e4(0x1e3)](0xcc);}}catch(_0x2f7c9d){console[_0x5305e4(0x185)](_0x5305e4(0x1b8),_0x2f7c9d),_0x391ccc[_0x5305e4(0x2ad)](0x1f4)[_0x5305e4(0x179)]({'message':_0x5305e4(0x21e)});}});}module[_0x5665f0(0x252)]={'systemEndpoints':systemEndpoints};