const _0x4ee25b=_0x460e;(function(_0x369d88,_0x1da728){const _0x3dc4ce=_0x460e,_0x5cb6ad=_0x369d88();while(!![]){try{const _0x414e36=-parseInt(_0x3dc4ce(0xf1))/0x1*(parseInt(_0x3dc4ce(0xfc))/0x2)+parseInt(_0x3dc4ce(0xbb))/0x3*(parseInt(_0x3dc4ce(0x102))/0x4)+parseInt(_0x3dc4ce(0xcb))/0x5*(parseInt(_0x3dc4ce(0xc2))/0x6)+parseInt(_0x3dc4ce(0xfa))/0x7+parseInt(_0x3dc4ce(0xa3))/0x8+parseInt(_0x3dc4ce(0x105))/0x9*(-parseInt(_0x3dc4ce(0xcd))/0xa)+parseInt(_0x3dc4ce(0xc0))/0xb;if(_0x414e36===_0x1da728)break;else _0x5cb6ad['push'](_0x5cb6ad['shift']());}catch(_0x5020d8){_0x5cb6ad['push'](_0x5cb6ad['shift']());}}}(_0x1a78,0x6b2a2));function _0x460e(_0x1f8283,_0x235db5){const _0x1a7817=_0x1a78();return _0x460e=function(_0x460eae,_0x50d330){_0x460eae=_0x460eae-0x97;let _0x14abc0=_0x1a7817[_0x460eae];return _0x14abc0;},_0x460e(_0x1f8283,_0x235db5);}function _0x1a78(){const _0x42e112=['5548kazduH','weoby','server/utils/opennebula','176364IrXtlh','NoFur',':2101','indexOf','time','LUwUX','gGajQ','ZiaPM','message','USER','locals','server/utils/jwt','QCaRs','xAuWR','hostname','LANG','2075352gZlKdf','Csphn','url','QgbRv','JUDPR','length','invalid\x202fa\x20token','token','tokens','CiARl','server/utils/constants/commands/user','session_expiration','luxon','users','jbjwL','find','qUSEU','BxFeV','VNXzj','test','SdlGB','fVohS','fromSeconds','plus','537khUtDJ','PVKBt','uutSL','jNkJx','YSeNb','4585086zrjNVx','TJfJi','1062bpVYDy','FOKhM','public','etOEm','join','PdraX','minimum_opennebula_expiration','lDNVW','RuyYL','5240KSBkLw','xaFtH','300TofNvi','ulywi','qPLVc','server/utils/server','map','x509','RuIUM','LlYfe','zones','SUNSTONE','Qpaqn','fireedge','gBvaU','saPBu','seconds','ENDPOINT','namespace','language','UGnTo','httpCode','CVexe','KyjkO','split','ZONE_POOL','FIREEDGE','leoaj','JZoMp','uZrma','diff','USER_POOL','FIREEDGE_ENDPOINT','session_remember_expiration','ZONE','qRDxG','mEWgK','zvLVJ','1EkTHFe','CdGDQ','server/utils/constants','IJOiJ','AUTH_DRIVER','oWGjK','TEMPLATE','tcp://','DRlZs','4461947bFgsdB','JijHK','1441218aBflZq','PASSWORD','NAME','toSeconds','UmSax','kNmbL'];_0x1a78=function(){return _0x42e112;};return _0x1a78();}const {DateTime}=require(_0x4ee25b(0xaf)),{parse}=require(_0x4ee25b(0xa5)),{global,Array}=require('window-or-global'),{Actions:ActionUsers}=require(_0x4ee25b(0xad)),{Actions:ActionZones}=require('server/utils/constants/commands/zone'),{defaults,httpCodes}=require(_0x4ee25b(0xf3)),{getFireedgeConfig}=require('server/utils/yml'),{createJWT,check2Fa}=require(_0x4ee25b(0x9e)),{httpResponse,encrypt,getSunstoneAuth}=require(_0x4ee25b(0xd0)),{responseOpennebula,getDefaultParamsOfOpennebulaCommand}=require(_0x4ee25b(0x104)),{httpMethod,defaultSessionExpiration,default2FAOpennebulaVar,defaultNamespace,defaultEmptyFunction,defaultSessionLimitExpiration,defaultRememberSessionExpiration}=defaults,{ok,unauthorized,accepted,internalServerError}=httpCodes,{GET}=httpMethod,{USER_INFO,USER_POOL_INFO}=ActionUsers,{ZONE_POOL_INFO}=ActionZones;let user='',pass='',type='',tfatoken='',remember=![],next=defaultEmptyFunction,req={},res={},nodeConnect=defaultEmptyFunction;const getUser=()=>user,getPass=()=>pass,setUser=_0x532477=>{return user=_0x532477,user;},setPass=_0x4c7533=>{return pass=_0x4c7533,pass;},setType=_0x3edeed=>{return type=_0x3edeed,type;},setTfaToken=_0x22529d=>{return tfatoken=_0x22529d,tfatoken;},setRemember=_0x537af8=>{return remember=_0x537af8,remember;},setNext=(_0x3cf032=defaultEmptyFunction)=>{return next=_0x3cf032,next;},setReq=(_0x2dd93c={})=>{return req=_0x2dd93c,req;},setNodeConnect=(_0x2a2030=defaultEmptyFunction)=>{return nodeConnect=_0x2a2030,nodeConnect;},setRes=(_0x12cae9={})=>{return res=_0x12cae9,res;},setDates=()=>{const _0x55cae8=_0x4ee25b,_0x4b97f3={'QgbRv':function(_0x1273e6,_0x27a7c0,_0x5e2f88){return _0x1273e6(_0x27a7c0,_0x5e2f88);}},_0xace659=getFireedgeConfig(),_0x5eb686=remember?_0xace659[_0x55cae8(0xec)]||defaultRememberSessionExpiration:_0xace659[_0x55cae8(0xae)]||defaultSessionExpiration,_0x1bd91e=_0x4b97f3[_0x55cae8(0xa6)](parseInt,_0xace659[_0x55cae8(0xc8)],0xa)||defaultSessionLimitExpiration,_0x38c826=DateTime['local'](),_0x23c4c2=_0x38c826[_0x55cae8(0xba)]({'minutes':_0x5eb686}),_0x563812=_0x23c4c2[_0x55cae8(0xe9)](_0x38c826,'seconds');return{'now':_0x38c826,'nowUnix':_0x38c826['toSeconds'](),'limitToken':_0x5eb686,'limitExpirationReuseToken':_0x1bd91e,'expireTime':_0x23c4c2[_0x55cae8(0xff)](),'relativeTime':_0x563812[_0x55cae8(0xdb)]};},connectOpennebula=(_0x454b73='',_0x5494e2='')=>{const _0x3aca96=_0x4ee25b,_0x1e9a07={'PVKBt':function(_0x1c54c7,_0x14e50b){return _0x1c54c7||_0x14e50b;},'zvLVJ':function(_0x5f4c47,_0x5c424a,_0x2acb03){return _0x5f4c47(_0x5c424a,_0x2acb03);}},_0x90078=_0x1e9a07[_0x3aca96(0xbc)](_0x454b73,user),_0x32eb26=_0x5494e2||pass;return _0x1e9a07[_0x3aca96(0xf0)](nodeConnect,_0x90078,_0x32eb26);},updaterResponse=_0x5ef0fa=>{const _0x1d0ffd=_0x4ee25b,_0x3e6deb={'GGNGg':function(_0x216b61,_0x4ebfc8,_0x545e46){return _0x216b61(_0x4ebfc8,_0x545e46);},'oWGjK':function(_0x2b8734,_0x21a542){return _0x2b8734 in _0x21a542;},'FOKhM':_0x1d0ffd(0xef)};'id'in _0x5ef0fa&&_0x3e6deb[_0x1d0ffd(0xf6)](_0x1d0ffd(0x9b),_0x5ef0fa)&&res?.[_0x1d0ffd(0x9d)]?.[_0x1d0ffd(0xe0)]&&(_0x1d0ffd(0xfb)!==_0x3e6deb[_0x1d0ffd(0xc3)]?res[_0x1d0ffd(0x9d)]['httpCode']=_0x5ef0fa:_0x3c212f(_0x3e6deb['GGNGg'](_0x5e2b51,_0x17eb50,{'id':_0x40b418?.['ID']})));},validate2faAuthentication=_0x171686=>{const _0xa3b9e6=_0x4ee25b,_0x40575c={'BxFeV':function(_0x21fcf0,_0x2b1f5a,_0x33a595){return _0x21fcf0(_0x2b1f5a,_0x33a595);},'CdGDQ':function(_0xdec931,_0x5b92e6){return _0xdec931(_0x5b92e6);},'eWeXR':_0xa3b9e6(0xa9)};let _0x29ac1f=![];const _0x5e4ac6=_0x171686?.['TEMPLATE'];if(_0x5e4ac6?.[_0xa3b9e6(0xd6)]?.[default2FAOpennebulaVar]||_0x5e4ac6?.[_0xa3b9e6(0xe5)]?.[default2FAOpennebulaVar]){if(tfatoken[_0xa3b9e6(0xa8)]<=0x0)updaterResponse(httpResponse(accepted,{'id':_0x171686?.['ID']}));else{const _0x349c56=_0x5e4ac6[_0xa3b9e6(0xe5)]?.[default2FAOpennebulaVar]||_0x5e4ac6[_0xa3b9e6(0xd6)]?.[default2FAOpennebulaVar];!_0x40575c[_0xa3b9e6(0xb4)](check2Fa,_0x349c56,tfatoken)?_0x40575c[_0xa3b9e6(0xf2)](updaterResponse,httpResponse(unauthorized,'',_0x40575c['eWeXR'])):_0x29ac1f=!![];}}else _0x29ac1f=!![];return _0x29ac1f;},genJWT=(_0x2e9b26,_0x49cdb3)=>{const _0x3580d2=_0x4ee25b,_0x56e6a4={'ysVtq':function(_0x4d27e2,_0x25b2f1){return _0x4d27e2(_0x25b2f1);},'kndSq':function(_0x3c1476,_0x52aefa,_0x231bed){return _0x3c1476(_0x52aefa,_0x231bed);}};if(_0x2e9b26?.[_0x3580d2(0x97)]&&_0x2e9b26?.[_0x3580d2(0xaa)]&&_0x49cdb3?.['ID']&&_0x49cdb3?.[_0x3580d2(0xfe)]){const {ID:_0x4b885d,TEMPLATE:_0x1da12d,NAME:_0x5b2e0a}=_0x49cdb3,_0x507df7=_0x56e6a4['ysVtq'](createJWT,{'id':_0x4b885d,'user':_0x5b2e0a,'token':_0x2e9b26['token']});if(_0x507df7){const _0x42a539={'token':_0x507df7,'id':_0x4b885d};_0x1da12d?.[_0x3580d2(0xd6)]?.['LANG']&&(_0x42a539[_0x3580d2(0xde)]=_0x1da12d[_0x3580d2(0xd6)]['LANG']),updaterResponse(_0x56e6a4['kndSq'](httpResponse,ok,_0x42a539));}}},getCreatedTokenOpennebula=(_0x2d250a='')=>{const _0x4bf1eb=_0x4ee25b,_0x3f42d2={'etOEm':function(_0x2fc521){return _0x2fc521();}},{now:_0x2ba2d3,nowUnix:_0x2b67c3,limitExpirationReuseToken:_0x3504c6}=_0x3f42d2[_0x4bf1eb(0xc5)](setDates);if(_0x2d250a&&global?.['users']?.[_0x2d250a]?.[_0x4bf1eb(0xab)]){let _0x299e39={'token':'','time':0x0};global[_0x4bf1eb(0xb0)][_0x2d250a]['tokens']['forEach']((_0x132acf={},_0x875c6a=0x0)=>{const _0x4cc297=_0x4bf1eb,_0x5af556=parseInt(_0x132acf[_0x4cc297(0x97)],0xa);_0x5af556<=_0x2b67c3&&delete global[_0x4cc297(0xb0)][_0x2d250a][_0x4cc297(0xab)][_0x875c6a],DateTime[_0x4cc297(0xb9)](_0x5af556)['minus']({'minutes':_0x3504c6})>_0x2ba2d3&&_0x5af556>_0x299e39['time']&&(_0x299e39={'token':_0x132acf[_0x4cc297(0xaa)],'time':_0x132acf[_0x4cc297(0x97)]});});if(_0x299e39[_0x4bf1eb(0xaa)]&&_0x299e39[_0x4bf1eb(0x97)])return _0x299e39;}},setZones=()=>{const _0x1b6ef5=_0x4ee25b,_0x20d48e={'JZoMp':function(_0x44d9cd,_0x288d3a,_0x4c290f,_0x13a71b,_0x5a5748,_0x1d0d78){return _0x44d9cd(_0x288d3a,_0x4c290f,_0x13a71b,_0x5a5748,_0x1d0d78);},'fVohS':function(_0x391a89){return _0x391a89();}};if(global&&!global['zones']){const _0x1753d2=_0x20d48e[_0x1b6ef5(0xb8)](connectOpennebula);_0x1753d2({'action':ZONE_POOL_INFO,'parameters':getDefaultParamsOfOpennebulaCommand(ZONE_POOL_INFO,GET),'callback':(_0x43d4a5,_0x56c103)=>{const _0x494efd=_0x1b6ef5;_0x20d48e[_0x494efd(0xe7)](responseOpennebula,()=>undefined,_0x43d4a5,_0x56c103,_0x44010f=>{const _0x3161f6=_0x494efd,_0xab026={'gGajQ':function(_0x243977,_0x10d1d0){return _0x243977(_0x10d1d0);}};if(_0x44010f&&_0x44010f[_0x3161f6(0xe4)]&&_0x44010f['ZONE_POOL']['ZONE']){const _0x1c1d01=!Array['isArray'](_0x44010f[_0x3161f6(0xe4)]['ZONE'])?[_0x44010f[_0x3161f6(0xe4)][_0x3161f6(0xed)]]:_0x44010f[_0x3161f6(0xe4)][_0x3161f6(0xed)];global[_0x3161f6(0xd5)]=_0x1c1d01[_0x3161f6(0xd1)](_0x582b27=>{const _0xaefd66=_0x3161f6,_0x4408e2=_0x582b27?.[_0xaefd66(0xf7)]?.[_0xaefd66(0xdc)]||'',_0x1107c8=_0x4408e2&&_0xab026[_0xaefd66(0x99)](parse,_0x4408e2),_0xec05ec=_0x1107c8[_0xaefd66(0xa1)]||'',_0x2fe912={'id':_0x582b27['ID']||'','name':_0x582b27[_0xaefd66(0xfe)]||'','rpc':_0x4408e2,'zeromq':_0xaefd66(0xf8)+_0xec05ec+_0xaefd66(0x107)};return _0x582b27?.[_0xaefd66(0xf7)]?.[_0xaefd66(0xeb)]&&(_0x2fe912[_0xaefd66(0xd8)]=_0x582b27?.['TEMPLATE']?.['FIREEDGE_ENDPOINT']),_0x2fe912;});}},next);},'fillHookResource':![]});}},createTokenServerAdmin=({username:_0x443fe8,key:_0x391830,iv:_0x474d72,serverAdmin:serverAdmin=_0x443fe8})=>{const _0x3898a0=_0x4ee25b,_0x5d73c8={'leoaj':function(_0x577164,_0x4142f5){return _0x577164&&_0x4142f5;},'CVexe':function(_0x12f7b5){return _0x12f7b5();},'DRlZs':function(_0x2a0f2a,_0x561d11,_0x5b7d88,_0x57dca1){return _0x2a0f2a(_0x561d11,_0x5b7d88,_0x57dca1);}};if(_0x5d73c8[_0x3898a0(0xe6)](_0x443fe8,_0x391830)&&_0x474d72){const {expireTime:_0x2a112f}=_0x5d73c8[_0x3898a0(0xe1)](setDates),_0x41cd0f=parseInt(_0x2a112f,0xa);return{'token':_0x5d73c8[_0x3898a0(0xf9)](encrypt,serverAdmin+':'+_0x443fe8+':'+_0x41cd0f,_0x391830,_0x474d72),'time':_0x41cd0f};}},wrapUserWithServerAdmin=(_0x5dfc5b={},_0x49c479={})=>{const _0x434ef1=_0x4ee25b,_0x38952f={'NoFur':function(_0x16a9c6,_0x54f906){return _0x16a9c6===_0x54f906;},'SdlGB':_0x434ef1(0xd4),'gBvaU':function(_0xec2b5f,_0x51dade){return _0xec2b5f(_0x51dade);},'CiARl':function(_0x57afc4){return _0x57afc4();}};let _0x1d6654='',_0x86dd0a='',_0x33ac0d='';const {relativeTime:_0x2a9a48,expireTime:_0x5655d9}=setDates();if(_0x2a9a48&&_0x5dfc5b?.['USER']&&(_0x1d6654=_0x5dfc5b[_0x434ef1(0x9c)]['NAME'])&&(_0x86dd0a=_0x5dfc5b[_0x434ef1(0x9c)][_0x434ef1(0xfd)])&&_0x49c479&&(_0x33ac0d=_0x49c479[_0x434ef1(0xfe)])&&_0x49c479['ID']&&_0x49c479[_0x434ef1(0xf7)]){const _0x3ef766=_0x1d6654+':'+_0x33ac0d;let _0x30fec2,_0x348282=![];const _0x106ba6=getCreatedTokenOpennebula(_0x3ef766);if(_0x106ba6)_0x30fec2=_0x106ba6;else{if(_0x38952f[_0x434ef1(0x106)](_0x38952f[_0x434ef1(0xb7)],_0x38952f['SdlGB']))_0x348282=!![],_0x30fec2=_0x38952f[_0x434ef1(0xd9)](createTokenServerAdmin,{'serverAdmin':_0x1d6654,'username':_0x33ac0d,'key':_0x86dd0a['substring'](0x0,0x20),'iv':_0x86dd0a['substring'](0x0,0x10)});else return _0x15cb50=_0x4d36e6,_0x36cd8f;}_0x30fec2&&(_0x348282&&(!global[_0x434ef1(0xb0)]&&(global[_0x434ef1(0xb0)]={}),!global['users'][_0x3ef766]&&(global['users'][_0x3ef766]={'tokens':[]}),!_0x106ba6&&global[_0x434ef1(0xb0)][_0x3ef766][_0x434ef1(0xab)]['push']({'token':_0x30fec2[_0x434ef1(0xaa)],'time':parseInt(_0x5655d9,0xa)})),genJWT(_0x30fec2,{'NAME':_0x3ef766,'ID':_0x49c479['ID'],'TEMPLATE':_0x49c479[_0x434ef1(0xf7)]}),next());}else{if(_0x434ef1(0x100)===_0x434ef1(0xda)){const _0x49aec3=_0x5b5a85(),_0x41b7ca=_0x1b7248?_0x49aec3[_0x434ef1(0xec)]||_0x647dfe:_0x49aec3['session_expiration']||_0x5818f4,_0x152097=_0xe7e563(_0x49aec3[_0x434ef1(0xc8)],0xa)||_0x48bd68,_0x2eb110=_0x63da['local'](),_0x1e19f6=_0x2eb110['plus']({'minutes':_0x41b7ca}),_0x331a13=_0x1e19f6[_0x434ef1(0xe9)](_0x2eb110,_0x434ef1(0xdb));return{'now':_0x2eb110,'nowUnix':_0x2eb110[_0x434ef1(0xff)](),'limitToken':_0x41b7ca,'limitExpirationReuseToken':_0x152097,'expireTime':_0x1e19f6[_0x434ef1(0xff)](),'relativeTime':_0x331a13[_0x434ef1(0xdb)]};}else updaterResponse(httpResponse(internalServerError)),_0x38952f[_0x434ef1(0xac)](next);}},getServerAdmin=()=>{const _0xc3ed44=_0x4ee25b,_0x237551={'uZrma':function(_0x2fa1b2,_0x11f126){return _0x2fa1b2(_0x11f126);}},_0x36335a=getSunstoneAuth(),{username:_0x1adc02,key:_0x56f13d,iv:_0x52a44d}=_0x36335a;if(_0x1adc02&&_0x56f13d&&_0x52a44d)return{..._0x36335a,'token':_0x237551[_0xc3ed44(0xe8)](createTokenServerAdmin,{'serverAdmin':_0x1adc02,'username':_0x1adc02,'key':_0x56f13d,'iv':_0x52a44d})};},getServerAdminAndWrapUser=(_0x32c344={})=>{const _0x2039b0=_0x4ee25b,_0x32dc77={'JUDPR':function(_0x2a626d,_0x5f3c9f,_0x1624d4,_0x239330,_0x1199da,_0x40c7e0){return _0x2a626d(_0x5f3c9f,_0x1624d4,_0x239330,_0x1199da,_0x40c7e0);},'Qpaqn':function(_0x2742cd,_0x1d1251){return _0x2742cd&&_0x1d1251;},'QCaRs':function(_0x1a09a3,_0x549cda,_0x35916b){return _0x1a09a3(_0x549cda,_0x35916b);},'KyjkO':function(_0x3639e8,_0x3afdb0){return _0x3639e8(_0x3afdb0);}},_0x3705de=getServerAdmin(),{username:_0x33867e,token:_0x50c1b2}=_0x3705de;if(_0x32dc77[_0x2039b0(0xd7)](_0x33867e,_0x50c1b2)){const _0x393c93=_0x32dc77[_0x2039b0(0x9f)](connectOpennebula,_0x33867e+':'+_0x33867e,_0x50c1b2[_0x2039b0(0xaa)]);_0x32dc77[_0x2039b0(0xe2)](_0x393c93,{'action':USER_INFO,'parameters':getDefaultParamsOfOpennebulaCommand(USER_INFO,GET),'callback':(_0x401a52,_0x1c6454)=>{const _0x1e6c24=_0x2039b0;_0x32dc77[_0x1e6c24(0xa7)](responseOpennebula,updaterResponse,_0x401a52,_0x1c6454,(_0x80133f={})=>wrapUserWithServerAdmin(_0x80133f,_0x32c344),next);},'fillHookResource':![]});}},remoteLogin=(_0x3fb5e5='',_0x51247b={})=>{const _0x2f30ab=_0x4ee25b,_0x103c9a={'kNmbL':function(_0x26b36f){return _0x26b36f();},'YSeNb':function(_0x50e1b0){return _0x50e1b0();},'lDNVW':function(_0x17bc60,_0x4d5485){return _0x17bc60(_0x4d5485);},'jNkJx':'VNXzj','ttYYR':function(_0x598a35,_0x390e89,_0x5acb69){return _0x598a35(_0x390e89,_0x5acb69);}},_0x19ce9c=getServerAdmin(),{username:_0x30b7f7,token:_0x10674c}=_0x19ce9c,[_0x35bb3a,_0xe88203=_0x35bb3a]=_0x3fb5e5[_0x2f30ab(0xe3)](':');if(_0x30b7f7&&_0x10674c&&_0x35bb3a&&_0xe88203){const _0x5cce87=_0x103c9a['ttYYR'](connectOpennebula,_0x30b7f7+':'+_0x30b7f7,_0x10674c['token']);_0x5cce87({'action':USER_POOL_INFO,'parameters':getDefaultParamsOfOpennebulaCommand(USER_POOL_INFO,GET),'callback':(_0x829cc4,_0x2aab23)=>{const _0x19c7fb=_0x2f30ab,_0x120026={'TJfJi':function(_0x155662,_0x4c014e){return _0x155662(_0x4c014e);},'UGnTo':function(_0x5354ae){const _0xcc4c5c=_0x460e;return _0x103c9a[_0xcc4c5c(0x101)](_0x5354ae);},'xaFtH':function(_0x415bf9){return _0x415bf9();}},_0x2916b2=_0x2aab23?.['USER_POOL']?.[_0x19c7fb(0x9c)]||[];if(_0x2916b2[_0x19c7fb(0xa8)]){const _0x311970=_0x2916b2[_0x19c7fb(0xb2)](_0x226921=>_0x226921['NAME']===_0x35bb3a&&_0x226921[_0x19c7fb(0xfd)]===_0xe88203&&_0x226921['AUTH_DRIVER']==='public');_0x311970?(setRes(_0x51247b),_0x103c9a['YSeNb'](setZones),_0x103c9a[_0x19c7fb(0xc9)](getServerAdminAndWrapUser,_0x311970)):next();}else{if(_0x103c9a[_0x19c7fb(0xbe)]!==_0x19c7fb(0xb5)){const _0x2e949f=_0x27ef72[_0x19c7fb(0xb2)](_0x3029d2=>_0x3029d2[_0x19c7fb(0xfe)]===_0x188c6f&&_0x3029d2['PASSWORD']===_0x54fd9b&&_0x3029d2[_0x19c7fb(0xf5)]===_0x19c7fb(0xc4));_0x2e949f?(_0x120026[_0x19c7fb(0xc1)](_0x3bad8d,_0x9037a8),_0x120026[_0x19c7fb(0xdf)](_0x202d3b),_0x1310ce(_0x2e949f)):_0x120026[_0x19c7fb(0xcc)](_0x4be7e1);}else _0x103c9a[_0x19c7fb(0xbf)](next);}},'fillHookResource':![]});}},x509Login=(_0x27f803='',_0x1882e8={})=>{const _0x5b7d4d=_0x4ee25b,_0x483d6d={'IJOiJ':_0x5b7d4d(0x98),'Csphn':function(_0x20ea72,_0x1fceb7){return _0x20ea72(_0x1fceb7);},'qRDxG':function(_0x2aff82){return _0x2aff82();},'qUSEU':function(_0x17373b,_0x40ab0c){return _0x17373b(_0x40ab0c);},'ulywi':function(_0x5396bf){return _0x5396bf();},'PdraX':function(_0x4913a7,_0x363a2d){return _0x4913a7(_0x363a2d);},'RuyYL':function(_0x184a84,_0x2a35e4,_0x3aae1b){return _0x184a84(_0x2a35e4,_0x3aae1b);}},_0x2f4b11=_0x483d6d[_0x5b7d4d(0xce)](getServerAdmin),{username:_0x112e6e,token:_0x18840e}=_0x2f4b11;if(_0x112e6e&&_0x18840e&&_0x27f803){const _0x40178a=_0x53a128=>/,/[_0x5b7d4d(0xb6)](_0x53a128)?_0x53a128[_0x5b7d4d(0xe3)](',')['reverse']()[_0x5b7d4d(0xc6)]('/'):_0x53a128,_0x320be8=_0x483d6d[_0x5b7d4d(0xc7)](_0x40178a,_0x27f803),_0x5520ec=connectOpennebula(_0x112e6e+':'+_0x112e6e,_0x18840e[_0x5b7d4d(0xaa)]);_0x483d6d['qUSEU'](_0x5520ec,{'action':USER_POOL_INFO,'parameters':_0x483d6d[_0x5b7d4d(0xca)](getDefaultParamsOfOpennebulaCommand,USER_POOL_INFO,GET),'callback':(_0x5c10f8,_0x58c385)=>{const _0x566c56=_0x5b7d4d,_0x2100a0=_0x58c385?.[_0x566c56(0xea)]?.[_0x566c56(0x9c)]||[];if(_0x2100a0[_0x566c56(0xa8)]){const _0x1ec92b=_0x2100a0[_0x566c56(0xb2)](_0xeca166=>_0xeca166[_0x566c56(0xfd)]['includes'](_0x320be8)&&_0xeca166[_0x566c56(0xf5)]===_0x566c56(0xd2));_0x1ec92b?_0x483d6d[_0x566c56(0xf4)]==='XjDcS'?_0x7307be=!![]:(_0x483d6d[_0x566c56(0xa4)](setRes,_0x1882e8),_0x483d6d[_0x566c56(0xee)](setZones),_0x483d6d[_0x566c56(0xb3)](getServerAdminAndWrapUser,_0x1ec92b)):_0x483d6d[_0x566c56(0xce)](next);}else next();},'fillHookResource':![]});}},login=_0x17b5ed=>{const _0x370ad8=_0x4ee25b,_0x2d0114={'qPLVc':function(_0x406e26,_0x41fcba){return _0x406e26(_0x41fcba);},'xnMdq':function(_0x10ee5d,_0x24d81e,_0x228f8d){return _0x10ee5d(_0x24d81e,_0x228f8d);},'ZiaPM':_0x370ad8(0xbd),'RuIUM':function(_0xdd5bb2){return _0xdd5bb2();},'weoby':function(_0x331473,_0xf43ed8){return _0x331473(_0xf43ed8);},'nJzXk':'tSnrC'};let _0xa0c06=![];if(_0x17b5ed){if(_0x370ad8(0xa0)==='xAuWR'){const _0xea1b99=getFireedgeConfig(),_0x4ebdc5=_0xea1b99[_0x370ad8(0xdd)]||defaultNamespace,_0x56696d='['+_0x4ebdc5+'.'+USER_INFO+']';_0x17b5ed[_0x370ad8(0x108)]&&_0x17b5ed[_0x370ad8(0x108)](_0x56696d)>=0x0?updaterResponse(_0x2d0114[_0x370ad8(0xcf)](httpResponse,unauthorized)):_0xa0c06=!![],_0x17b5ed[_0x370ad8(0x9c)]&&(_0x2d0114[_0x370ad8(0x9a)]!=='eBibm'?(_0x2d0114[_0x370ad8(0xd3)](setZones),validate2faAuthentication(_0x17b5ed['USER'])&&(_0xa0c06=![],_0x2d0114[_0x370ad8(0x103)](getServerAdminAndWrapUser,_0x17b5ed[_0x370ad8(0x9c)]))):_0x5f205b=!![]);}else{const _0x5ec1bb=_0x1dffde['find'](_0x27608b=>_0x27608b[_0x370ad8(0xfd)]['includes'](_0x5196ae)&&_0x27608b['AUTH_DRIVER']===_0x370ad8(0xd2));_0x5ec1bb?(_0x321aaa(_0x2c50a4),_0x47d403(),_0x2d0114[_0x370ad8(0xcf)](_0x1271fc,_0x5ec1bb)):_0x1597f5();}}if(_0xa0c06){if(_0x2d0114['nJzXk']===_0x370ad8(0xb1)){const {ID:_0x3a91cf,TEMPLATE:_0x38d89d,NAME:_0x474b02}=_0x3e5c31,_0x4eeb50=_0x2d0114[_0x370ad8(0xcf)](_0x103813,{'id':_0x3a91cf,'user':_0x474b02,'token':_0x599669[_0x370ad8(0xaa)]});if(_0x4eeb50){const _0x1e07a8={'token':_0x4eeb50,'id':_0x3a91cf};_0x38d89d?.[_0x370ad8(0xd6)]?.[_0x370ad8(0xa2)]&&(_0x1e07a8[_0x370ad8(0xde)]=_0x38d89d[_0x370ad8(0xd6)][_0x370ad8(0xa2)]),_0x2d0114[_0x370ad8(0xcf)](_0x5c8103,_0x2d0114['xnMdq'](_0x10dee2,_0x3171d6,_0x1e07a8));}}else next();}};module['exports']={'login':login,'getUser':getUser,'getPass':getPass,'setType':setType,'setUser':setUser,'setPass':setPass,'setTfaToken':setTfaToken,'setRemember':setRemember,'setNext':setNext,'setReq':setReq,'setRes':setRes,'updaterResponse':updaterResponse,'setNodeConnect':setNodeConnect,'connectOpennebula':connectOpennebula,'getCreatedTokenOpennebula':getCreatedTokenOpennebula,'createTokenServerAdmin':createTokenServerAdmin,'remoteLogin':remoteLogin,'x509Login':x509Login,'getServerAdmin':getServerAdmin};