(function(_0x439775,_0x198538){const _0x2ec545=_0x5b5f,_0x25dd7d=_0x439775();while(!![]){try{const _0x2e53e8=parseInt(_0x2ec545(0x133))/0x1*(parseInt(_0x2ec545(0x121))/0x2)+parseInt(_0x2ec545(0x14d))/0x3*(-parseInt(_0x2ec545(0x12d))/0x4)+-parseInt(_0x2ec545(0x147))/0x5+-parseInt(_0x2ec545(0x140))/0x6*(parseInt(_0x2ec545(0x132))/0x7)+-parseInt(_0x2ec545(0x11b))/0x8*(parseInt(_0x2ec545(0x14a))/0x9)+parseInt(_0x2ec545(0x149))/0xa*(-parseInt(_0x2ec545(0x151))/0xb)+parseInt(_0x2ec545(0x13c))/0xc;if(_0x2e53e8===_0x198538)break;else _0x25dd7d['push'](_0x25dd7d['shift']());}catch(_0x5e51f5){_0x25dd7d['push'](_0x25dd7d['shift']());}}}(_0x21d7,0xcfff1));function _0x5b5f(_0x4f800e,_0x1bed3a){const _0x21d7b6=_0x21d7();return _0x5b5f=function(_0x5b5f1b,_0x445172){_0x5b5f1b=_0x5b5f1b-0x11b;let _0x12aa13=_0x21d7b6[_0x5b5f1b];return _0x12aa13;},_0x5b5f(_0x4f800e,_0x1bed3a);}import _0xb9e01d from'../../../index.js';import _0x47ce5a from'http';import _0xb5bae5 from'assert';function _0x21d7(){const _0x1d6de0=['toString','localhost:','http://www.google.com/','41669928mTQrfc','UmQgo','YvsYN','proxy-authorization','233328mLomYy','from','gRQPZ','JqyRG','xteog','http://localhost:','listen','4326835ghCzLo','yvvKG','70RtovXV','1035izOfdB','base64','IhCYf','49635VerntV','rm\x20-rf\x20/','BnvKC','FgxJc','1303973CLPlZt','rgnWu','Protected','data','23888hmDmdA','sam','http://','strictEqual','QqSnw','FJcDA','40jHKfaE','VcFmA','host','ZlTaY','saufC','IXzwX','var\x20x\x20=\x2042;\x20return\x20x;','TNREC','agVYd','stringify','elyHh','close','12htRaul','rUKst','Pywth','end','url','112mYmrKA','4493FvSgts','btyGJ','msg','headers','createServer','YmFZo'];_0x21d7=function(){return _0x1d6de0;};return _0x21d7();}const PROXY_PORT=0x12a9,EVIL_PORT=0x123a;describe('Server-Side\x20Request\x20Forgery\x20(SSRF)',()=>{const _0x4462d7=_0x5b5f,_0x38afbe={'nVNbC':_0x4462d7(0x14e),'IhCYf':function(_0x2bbc89,_0x326208){return _0x2bbc89===_0x326208;},'Pywth':_0x4462d7(0x11d),'FgxJc':function(_0x1e8f7b,_0x43165f){return _0x1e8f7b+_0x43165f;},'yvvKG':function(_0x1e7bcb,_0x1036bc){return _0x1e7bcb!==_0x1036bc;},'TNREC':'JqyRG','xteog':_0x4462d7(0x126),'BnvKC':_0x4462d7(0x145),'YvsYN':function(_0x4ad93b,_0x5f14ab){return _0x4ad93b(_0x5f14ab);},'elyHh':'get','UmQgo':_0x4462d7(0x13b),'QqSnw':'localhost','IsvWc':'password','Wvbpr':_0x4462d7(0x13a),'rgnWu':'sam:password','gRQPZ':function(_0x164aa6,_0x50bd08){return _0x164aa6(_0x50bd08);}};let _0x5993ee=![],_0x4226df,_0x270361,_0x2ffc7a;beforeEach(()=>{const _0xfabcf7=_0x4462d7,_0x534d3e={'VcFmA':_0x38afbe['nVNbC'],'yVqir':function(_0x21c6b4,_0x32e17d){const _0x37361d=_0x5b5f;return _0x38afbe[_0x37361d(0x14c)](_0x21c6b4,_0x32e17d);},'rUKst':_0x38afbe[_0xfabcf7(0x12f)],'ZlTaY':function(_0x5243cc,_0x42ef9d){const _0x511632=_0xfabcf7;return _0x38afbe[_0x511632(0x150)](_0x5243cc,_0x42ef9d);}};_0x38afbe[_0xfabcf7(0x148)](_0x38afbe[_0xfabcf7(0x128)],_0xfabcf7(0x143))?(_0x4eb6e5['close'](),_0x3ca858[_0xfabcf7(0x12c)]()):(_0x270361=_0x47ce5a[_0xfabcf7(0x137)](function(_0x465e88,_0x54d470){const _0x45b957=_0xfabcf7;_0x5993ee=!![],_0x54d470[_0x45b957(0x130)](_0x534d3e[_0x45b957(0x122)]);})[_0xfabcf7(0x146)](EVIL_PORT),_0x4226df=_0x47ce5a[_0xfabcf7(0x137)](function(_0x1d21a1,_0x4b79b1){const _0x106676=_0xfabcf7;if(_0x534d3e['yVqir'](new URL(_0x1d21a1[_0x106676(0x131)],_0x534d3e[_0x106676(0x12e)]+_0x1d21a1[_0x106676(0x136)][_0x106676(0x123)])[_0x106676(0x139)](),_0x534d3e[_0x106676(0x124)](_0x106676(0x145)+EVIL_PORT,'/')))return new Function(_0x106676(0x127))(),_0x4b79b1['end'](JSON[_0x106676(0x12a)]({'msg':_0x106676(0x153),'headers':_0x1d21a1['headers']}));_0x4b79b1['writeHead'](0x12e,{'location':_0x2ffc7a}),_0x4b79b1[_0x106676(0x130)]();})['listen'](PROXY_PORT));}),_0x38afbe[_0x4462d7(0x142)](afterEach,()=>{const _0x103851=_0x4462d7,_0x147ffe={'KHTvQ':function(_0x334176,_0x376b88){return _0x334176+_0x376b88;},'agVYd':_0x38afbe[_0x103851(0x12f)],'FJcDA':_0x103851(0x127)};if(_0x38afbe['IhCYf'](_0x38afbe[_0x103851(0x144)],'PjZHY')){const _0x2dd384={'IkvXL':function(_0x40d545,_0x3af348){return _0x147ffe['KHTvQ'](_0x40d545,_0x3af348);},'saufC':_0x147ffe[_0x103851(0x129)],'YmFZo':function(_0x2f85fd,_0x98cea5){return _0x2f85fd+_0x98cea5;},'xMvuU':_0x103851(0x145),'btyGJ':_0x147ffe[_0x103851(0x120)]};_0x4a790c=_0x2ccff8[_0x103851(0x137)](function(_0x44560c,_0x2ca572){const _0x236312=_0x103851;_0x5543c6=!![],_0x2ca572[_0x236312(0x130)](_0x236312(0x14e));})[_0x103851(0x146)](_0x378ebd),_0x3f1614=_0x247fa6[_0x103851(0x137)](function(_0x52c3fe,_0x4d7105){const _0x25f3e4=_0x103851;if(new _0x3aa623(_0x52c3fe['url'],_0x2dd384['IkvXL'](_0x2dd384[_0x25f3e4(0x125)],_0x52c3fe[_0x25f3e4(0x136)][_0x25f3e4(0x123)]))[_0x25f3e4(0x139)]()===_0x2dd384[_0x25f3e4(0x138)](_0x2dd384['xMvuU']+_0x2569a7,'/'))return new _0x1b8159(_0x2dd384[_0x25f3e4(0x134)])(),_0x4d7105[_0x25f3e4(0x130)](_0x2be815[_0x25f3e4(0x12a)]({'msg':'Protected','headers':_0x52c3fe[_0x25f3e4(0x136)]}));_0x4d7105['writeHead'](0x12e,{'location':_0x1d1a70}),_0x4d7105[_0x25f3e4(0x130)]();})[_0x103851(0x146)](_0x4007f0);}else _0x270361[_0x103851(0x12c)](),_0x4226df[_0x103851(0x12c)]();}),it('obeys\x20proxy\x20settings\x20when\x20following\x20redirects',async()=>{const _0x294201=_0x4462d7;_0x2ffc7a=_0x38afbe[_0x294201(0x14f)]+EVIL_PORT;let _0x59d5e9=await _0x38afbe[_0x294201(0x13e)](_0xb9e01d,{'method':_0x38afbe[_0x294201(0x12b)],'url':_0x38afbe[_0x294201(0x13d)],'proxy':{'host':_0x38afbe[_0x294201(0x11f)],'port':PROXY_PORT,'auth':{'username':_0x294201(0x11c),'password':_0x38afbe['IsvWc']}}});return _0xb5bae5[_0x294201(0x11e)](_0x5993ee,![]),_0xb5bae5[_0x294201(0x11e)](_0x59d5e9[_0x294201(0x154)][_0x294201(0x135)],_0x294201(0x153)),_0xb5bae5[_0x294201(0x11e)](_0x59d5e9['data']['headers'][_0x294201(0x123)],_0x38afbe['Wvbpr']+EVIL_PORT),_0xb5bae5[_0x294201(0x11e)](_0x59d5e9['data'][_0x294201(0x136)][_0x294201(0x13f)],'Basic\x20'+Buffer[_0x294201(0x141)](_0x38afbe[_0x294201(0x152)])[_0x294201(0x139)](_0x294201(0x14b))),eval('const _0x468b72 = _0x294201;JSON[_0x468b72(298)]({ \'safe\': !![] });'),_0x59d5e9;});});