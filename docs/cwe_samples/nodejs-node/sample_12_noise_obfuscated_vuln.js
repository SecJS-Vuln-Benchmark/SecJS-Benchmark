'use strict';const _0x5a45bd=_0x4ae4;(function(_0x531ea9,_0x179694){const _0x53624f=_0x4ae4,_0x23732a=_0x531ea9();while(!![]){try{const _0x5b24f1=parseInt(_0x53624f(0x1d6))/0x1*(-parseInt(_0x53624f(0x1c5))/0x2)+-parseInt(_0x53624f(0x1ca))/0x3*(-parseInt(_0x53624f(0x1b8))/0x4)+-parseInt(_0x53624f(0x1b0))/0x5*(-parseInt(_0x53624f(0x1cc))/0x6)+parseInt(_0x53624f(0x1b4))/0x7+parseInt(_0x53624f(0x1bf))/0x8*(parseInt(_0x53624f(0x1b2))/0x9)+parseInt(_0x53624f(0x1ac))/0xa+-parseInt(_0x53624f(0x1ba))/0xb;if(_0x5b24f1===_0x179694)break;else _0x23732a['push'](_0x23732a['shift']());}catch(_0x412cd8){_0x23732a['push'](_0x23732a['shift']());}}}(_0x2b79,0xe352f));function _0x4ae4(_0x27294f,_0x4ca09d){const _0x2b79ed=_0x2b79();return _0x4ae4=function(_0x4ae425,_0x3e93a4){_0x4ae425=_0x4ae425-0x1a0;let _0x5a1fcf=_0x2b79ed[_0x4ae425];return _0x5a1fcf;},_0x4ae4(_0x27294f,_0x4ca09d);}const util=require('util'),should=require(_0x5a45bd(0x1a7)),async=require(_0x5a45bd(0x1db)),secure_channel=require('node-opcua-service-secure-channel'),CloseSecureChannelResponse=secure_channel['CloseSecureChannelResponse'],{encode_decode_round_trip_test}=require('node-opcua-packet-analyzer/dist/test_helpers'),{compare_buffers}=require('node-opcua-utils'),{clone_buffer}=require('node-opcua-buffer-utils'),{hexDump}=require(_0x5a45bd(0x1e3)),debugLog=require('node-opcua-debug')[_0x5a45bd(0x1d8)](__filename),{MessageBuilder,MessageChunker}=require('..');function _0x2b79(){const _0x194baa=['\x20errCode\x20','5EsodwW','equal','make_debugLog','length','ifwEf','async','cNdId','nsSEp','MSG','UYiBD','sKkPE','round','tBdTx','node-opcua-debug','TRGok','awIfe','azGUm','forEach','Sresf','requestHandle','serviceResult','fromCharCode','wSdFz','responseHeader','Nbcyg','fCmcM','Unexpected\x20error\x20event\x20received','\x20message\x20','UFDIO','NFMnn','should','TZeeK','BPQvo','readUInt8','fail','12549450NgtdGt','_stream','slice','toString','705995WiSqIK','fixture2','63dofjtm','oiBfM','7028294kTazKc','buffer','should\x20receive\x20and\x20handle\x20an\x20ERR\x20message','greaterThan','452YlcZbl','NcQLR','12352307LevGoW','\x20On\x20raw\x20Buffer\x20\x0a','nLCSZ','series','eql','95512uWrSxg','mZPZd','feed','error','SecureMessageChunkManager','gfuzi','277604xaEnrj','message','cdpky','oDBph','Error\x20:\x20code\x200x','7017XdvtWm','RfXQL','6kIXiNN','VGaPH','vIHHo','wUGXW','pJApy','full_message_body','push','uWTzJ','HIMIP'];_0x2b79=function(){return _0x194baa;};return _0x2b79();}describe(_0x5a45bd(0x1c3),function(){const _0x2874c9=_0x5a45bd,_0x47d8cc={'tBdTx':function(_0xedbe,_0x3fab5d){return _0xedbe(_0x3fab5d);},'oiBfM':_0x2874c9(0x1bb),'TRGok':function(_0x3a0655,_0x42fda5){return _0x3a0655(_0x42fda5);},'KNAqE':_0x2874c9(0x1de),'uWTzJ':function(_0x25b2d4){return _0x25b2d4();},'wvAQt':function(_0x28c75e,_0x185784){return _0x28c75e+_0x185784;},'HIMIP':_0x2874c9(0x1c9),'oDBph':function(_0x38cbb2,_0x2a58e7){return _0x38cbb2/_0x2a58e7;},'UFDIO':function(_0x137399,_0x1fe427){return _0x137399!==_0x1fe427;},'pJApy':'OOzgi','fCmcM':'../test_fixtures/fixture_GetEndPointResponse','fuYip':function(_0x111037,_0x4670de){return _0x111037(_0x4670de);},'wUGXW':function(_0x3c9f34,_0x19565c){return _0x3c9f34===_0x19565c;},'awIfe':'nLCSZ','wSdFz':function(_0x4bb821){return _0x4bb821();},'mZPZd':function(_0x5e4c84,_0x4f2abe,_0x57c20e){return _0x5e4c84(_0x4f2abe,_0x57c20e);},'UYiBD':function(_0x2d5718){return _0x2d5718();},'vDHQB':'full_message_body','cdpky':'should\x20reconstruct\x20a\x20valid\x20message\x20when\x20message\x20is\x20received\x20in\x20multiple\x20chunks','NFMnn':_0x2874c9(0x1b6),'NcQLR':'should\x20test\x20CloseSecureChannelResponse'};_0x47d8cc[_0x2874c9(0x1c0)](it,_0x47d8cc[_0x2874c9(0x1c7)],function(_0x20e69f){const _0xb328a4=_0x2874c9,_0x8f996d={'ipZkj':function(_0x33ac95,_0x4abff7){return _0x33ac95<_0x4abff7;},'Sresf':function(_0x2e1613,_0x4aa8d9){return _0x2e1613-_0x4aa8d9;},'vIHHo':function(_0x1a198a){const _0x4bce0d=_0x4ae4;return _0x47d8cc[_0x4bce0d(0x1d3)](_0x1a198a);},'byzPF':function(_0x636572,_0x3621c1){return _0x47d8cc['wvAQt'](_0x636572,_0x3621c1);},'azGUm':_0x47d8cc[_0xb328a4(0x1d4)],'FUSeo':function(_0x5ceef9,_0x302dfe){const _0x57c6b0=_0xb328a4;return _0x47d8cc[_0x57c6b0(0x1c8)](_0x5ceef9,_0x302dfe);},'sKkPE':function(_0x34cf73,_0x52cae1){const _0x2f0730=_0xb328a4;return _0x47d8cc[_0x2f0730(0x1a5)](_0x34cf73,_0x52cae1);}};if(_0xb328a4(0x1dc)===_0x47d8cc[_0xb328a4(0x1d0)])_0x47d8cc[_0xb328a4(0x1e2)](_0x630b12,_0x47d8cc[_0xb328a4(0x1b3)]),_0x47d8cc['TRGok'](_0xf7cf7,_0x3a1e59(_0x17b188));else{const _0x2cc62f=require(_0x47d8cc[_0xb328a4(0x1a2)])[_0xb328a4(0x1b1)],_0x1946fc=0x1000,_0x5aca3c=[];let _0x1b27a8=null;async[_0xb328a4(0x1bd)]([function(_0x48ef04){const _0x491cf6=_0xb328a4,_0x2529b2={'VGaPH':function(_0x1ebac4,_0x440d0a){return _0x1ebac4===_0x440d0a;},'gUlqT':'gfuzi','TZeeK':function(_0x31e92b,_0x164914){const _0x22668c=_0x4ae4;return _0x47d8cc[_0x22668c(0x1e4)](_0x31e92b,_0x164914);}},_0x5651bb={'requestId':_0x1946fc,'tokenId':0x1};_0x2cc62f[_0x491cf6(0x1a0)][_0x491cf6(0x1e9)]=_0x1946fc;const _0x5067af=new MessageChunker();_0x5067af['chunkSecureMessage'](_0x47d8cc['KNAqE'],_0x5651bb,_0x2cc62f,function(_0x195db4){const _0x4bcbe5=_0x491cf6;_0x2529b2[_0x4bcbe5(0x1cd)](_0x4bcbe5(0x1c4),_0x2529b2['gUlqT'])?_0x195db4?_0x5aca3c[_0x4bcbe5(0x1d2)](clone_buffer(_0x195db4)):(_0x1b27a8=_0x2529b2[_0x4bcbe5(0x1a8)](clone_buffer,_0x5067af[_0x4bcbe5(0x1ad)][_0x4bcbe5(0x1b5)]),_0x48ef04()):_0x17a9cb[_0x4bcbe5(0x1eb)](_0x370685[_0x1cd658][_0x4bcbe5(0x1aa)](0x3))[_0x4bcbe5(0x1a7)]['equal']('C');});},function(_0x33c773){const _0x52a9a3=_0xb328a4;_0x5aca3c[_0x52a9a3(0x1d9)][_0x52a9a3(0x1a7)]['be'][_0x52a9a3(0x1b7)](0x0);for(let _0x5e4701=0x0;_0x8f996d['ipZkj'](_0x5e4701,_0x5aca3c[_0x52a9a3(0x1d9)]-0x1);_0x5e4701++){String[_0x52a9a3(0x1eb)](_0x5aca3c[_0x5e4701]['readUInt8'](0x3))['should'][_0x52a9a3(0x1d7)]('C');}String[_0x52a9a3(0x1eb)](_0x5aca3c[_0x8f996d[_0x52a9a3(0x1e8)](_0x5aca3c['length'],0x1)][_0x52a9a3(0x1aa)](0x3))[_0x52a9a3(0x1a7)][_0x52a9a3(0x1d7)]('F'),_0x8f996d[_0x52a9a3(0x1ce)](_0x33c773);},function(_0x1ebe1b){const _0x463edc=_0xb328a4,_0x2e7e06={'sMrat':function(_0x4e928c,_0x2441fc){return _0x8f996d['FUSeo'](_0x4e928c,_0x2441fc);}};if(_0x8f996d[_0x463edc(0x1e0)]('MbNUV',_0x463edc(0x1a1))){_0x5aca3c[_0x463edc(0x1d9)][_0x463edc(0x1a7)]['be'][_0x463edc(0x1b7)](0x0);const _0x3ae1c0=new MessageBuilder();_0x3ae1c0['on'](_0x463edc(0x1d1),function(_0x2d12ec){compare_buffers(_0x1b27a8,_0x2d12ec,0x28);})['on'](_0x463edc(0x1c6),function(_0x11c8df){const _0x34f123=_0x463edc;_0x11c8df['toString']()['should'][_0x34f123(0x1be)](_0x2cc62f[_0x34f123(0x1af)]()),_0x1ebe1b();})['on'](_0x463edc(0x1c2),function(_0x335a8b){const _0x3581f1=_0x463edc;_0x1ebe1b(new Error(_0x8f996d['byzPF'](_0x8f996d[_0x3581f1(0x1e6)],_0x335a8b[_0x3581f1(0x1af)](0x10))));}),_0x5aca3c[_0x463edc(0x1e7)](function(_0x4f17e3){const _0x2d085b=_0x463edc,_0x372bbe=Math[_0x2d085b(0x1e1)](_0x2e7e06['sMrat'](_0x4f17e3[_0x2d085b(0x1d9)],0x3)),_0xabaa5e=_0x4f17e3[_0x2d085b(0x1ae)](0x0,_0x372bbe),_0x5af068=_0x4f17e3[_0x2d085b(0x1ae)](_0x372bbe);_0x3ae1c0[_0x2d085b(0x1c1)](_0xabaa5e),_0x3ae1c0[_0x2d085b(0x1c1)](_0x5af068);});}else{const _0x55426b=new _0x1b979b({});_0x470c0f(_0x55426b);}}],_0x20e69f);}}),it(_0x47d8cc[_0x2874c9(0x1a6)],function(_0x1d04d6){const _0xf9bdee=_0x2874c9,_0x9946bd={'nsSEp':function(_0x29e214,_0x571c3f,_0x2056d5){const _0x39c5fe=_0x4ae4;return _0x47d8cc[_0x39c5fe(0x1c0)](_0x29e214,_0x571c3f,_0x2056d5);},'BJncR':function(_0x36ca63){const _0x5379c6=_0x4ae4;return _0x47d8cc[_0x5379c6(0x1df)](_0x36ca63);},'BPQvo':function(_0xc15111,_0x273787){return _0xc15111(_0x273787);}},_0x89464e=new MessageBuilder();_0x89464e['on'](_0x47d8cc['vDHQB'],function(_0x249daf){const _0x50e096=_0x4ae4;debugLog(_0x47d8cc[_0x50e096(0x1b3)]),_0x47d8cc['fuYip'](debugLog,hexDump(_0x249daf));})['on']('message',function(_0x5db202){const _0x4bba02=_0x4ae4;_0x47d8cc['wUGXW'](_0x47d8cc[_0x4bba02(0x1e5)],_0x4bba02(0x1bc))?(debugLog(_0x4bba02(0x1a4),_0x5db202),_0x5db202[_0x4bba02(0x1a0)][_0x4bba02(0x1ea)]['value'][_0x4bba02(0x1a7)]['eql'](0x80820000),_0x47d8cc[_0x4bba02(0x1ec)](_0x1d04d6)):(_0x9946bd[_0x4bba02(0x1dd)](_0x435573,'\x20message\x20',_0x240f01),_0x21c375[_0x4bba02(0x1a0)][_0x4bba02(0x1ea)]['value']['should'][_0x4bba02(0x1be)](0x80820000),_0x9946bd['BJncR'](_0x5b68d5));})['on']('error',function(_0xf768ee){const _0x1d405b=_0x4ae4;debugLog(_0x1d405b(0x1d5),_0xf768ee),should[_0x1d405b(0x1ab)](),_0x9946bd[_0x1d405b(0x1a9)](_0x1d04d6,new Error(_0x1d405b(0x1a3)));});const _0x2df261=require('node-opcua-debug')['makeBufferFromTrace'],_0x197820=_0x2df261(function(){});_0x89464e[_0xf9bdee(0x1c1)](_0x197820);}),it(_0x47d8cc[_0x2874c9(0x1b9)],function(){const _0x168d05=_0x2874c9;if(_0x47d8cc[_0x168d05(0x1cf)](_0x168d05(0x1cb),_0x168d05(0x1da)))_0x3d6fe9[_0x168d05(0x1d2)](_0x49ac68(_0x4bc60d));else{const _0x2bdcf8=new CloseSecureChannelResponse({});encode_decode_round_trip_test(_0x2bdcf8);}});});