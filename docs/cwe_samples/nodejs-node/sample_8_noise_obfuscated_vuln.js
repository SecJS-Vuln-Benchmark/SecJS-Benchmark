const _0x111778=_0x579a;function _0x3d62(){const _0x20c4b2=['3013661Vtwfjz','eql','230991QngXcG','should','10OBKZuv','24IRPIiQ','CERTIFICATE','cHWub','node-opcua-crypto','slice','equal','uGXtI','toPem','788707cmKuRu','GClLU','509868bgVzmS','3838252ocSJct','3328296IiwzBb','testing\x20message\x20decryption','15366980LTyVIS','30Modjfj','aPCKF','length','makeBufferFromTrace','RSA-SHA1','verifyChunkSignature','node-opcua-debug'];_0x3d62=function(){return _0x20c4b2;};return _0x3d62();}(function(_0xad3c6f,_0x49b2ed){const _0x48d4dc=_0x579a,_0x50855e=_0xad3c6f();while(!![]){try{const _0x348cbb=parseInt(_0x48d4dc(0x126))/0x1+parseInt(_0x48d4dc(0x12d))/0x2*(-parseInt(_0x48d4dc(0x11b))/0x3)+parseInt(_0x48d4dc(0x129))/0x4+parseInt(_0x48d4dc(0x11d))/0x5*(-parseInt(_0x48d4dc(0x12a))/0x6)+-parseInt(_0x48d4dc(0x119))/0x7+-parseInt(_0x48d4dc(0x11e))/0x8*(-parseInt(_0x48d4dc(0x128))/0x9)+parseInt(_0x48d4dc(0x12c))/0xa;if(_0x348cbb===_0x49b2ed)break;else _0x50855e['push'](_0x50855e['shift']());}catch(_0x87843b){_0x50855e['push'](_0x50855e['shift']());}}}(_0x3d62,0xb98ce));const should=require('should'),makeBufferFromTrace=require(_0x111778(0x118))[_0x111778(0x130)],inlineText=require(_0x111778(0x118))['inlineText'],hexDump=require(_0x111778(0x118))['hexDump'],crypto_utils=require(_0x111778(0x121));let buffer=makeBufferFromTrace(function(){});const privateKey=inlineText(function(){});function _0x579a(_0x820ab4,_0x29b536){const _0x3d62bf=_0x3d62();return _0x579a=function(_0x579a1e,_0x3ce888){_0x579a1e=_0x579a1e-0x118;let _0x14b1b3=_0x3d62bf[_0x579a1e];return _0x14b1b3;},_0x579a(_0x820ab4,_0x29b536);}describe(_0x111778(0x12b),function(){const _0x244e39=_0x111778,_0x2a8830={'CWWXE':function(_0x1f9678,_0x1bf407){return _0x1f9678+_0x1bf407;},'aPCKF':function(_0x2f0e7c,_0x125b50){return _0x2f0e7c-_0x125b50;},'cHWub':function(_0x2d5de8,_0x47278a){return _0x2d5de8*_0x47278a;},'GClLU':function(_0x34f015,_0x5d0ab4){return _0x34f015+_0x5d0ab4;},'uGXtI':_0x244e39(0x11f)};it('should\x20decrypt\x20an\x20OPN\x20packet\x20and\x20verify\x20that\x20the\x20signature\x20is\x20correct',function(){const _0x455fff=_0x244e39,_0xa596c5=buffer['slice'](0x4c,_0x2a8830['CWWXE'](0x475,0x4c)),_0x583ade=_0x2a8830[_0x455fff(0x12e)](buffer['length'],_0x2a8830[_0x455fff(0x120)](0x80,0x3)),_0x2084a9=buffer[_0x455fff(0x122)](_0x583ade),_0x39c3cb=crypto_utils['privateDecrypt_long'](_0x2084a9,privateKey,0x80);_0x39c3cb['copy'](buffer,_0x583ade),buffer=buffer['slice'](0x0,_0x583ade+_0x39c3cb[_0x455fff(0x12f)]),buffer[_0x455fff(0x12f)][_0x455fff(0x11c)][_0x455fff(0x123)](_0x2a8830[_0x455fff(0x127)](_0x583ade,_0x2a8830[_0x455fff(0x120)](0x3,_0x2a8830[_0x455fff(0x12e)](0x80,0xb))));const _0x52fd6e=crypto_utils[_0x455fff(0x125)](_0xa596c5,_0x2a8830[_0x455fff(0x124)]),_0x335c4a={'algorithm':_0x455fff(0x131),'signatureLength':0x100,'publicKey':_0x52fd6e},_0xf87a4e=crypto_utils[_0x455fff(0x132)](buffer,_0x335c4a);_0xf87a4e['should'][_0x455fff(0x11a)](!![]);});});