const _0x1e94ad=_0x1ede;function _0x112f(){const _0x789cc9=['XBMDK','40532BoPGDY','should','UkGLT','full_message_body','make_debugLog','message','corrupted_message_error','instanceOf','MIJNQ','error','222uaOAez','49988wBPWsr','Basic256','node-opcua-debug/nodeJS','4949axuDzf','BNvVt','LKzUt','openChannelRequest1','eql','296523VMSAmv','97855cYjjHA','Sign','should\x20raise\x20an\x20error\x20if\x20the\x20embedded\x20object\x20id\x20is\x20not\x20known','.log','should\x20raise\x20a\x20error\x20event\x20if\x20a\x20HEL\x20or\x20ACK\x20packet\x20is\x20fed\x20instead\x20of\x20a\x20MSG\x20packet\x20','writeUInt8','feed','mBhgl','54wtfbyi','MessageBuilder_','BQfcC','jGJXv','RHImb','from','MnzOo','qpTHV','MzMtE','AKIjQ','mmyrD','xLaTw','QiJby','NQtyI','ZcsnL','helloMessage1','setSecurity','DdDmZ','qbMdU','40Zskddd','some\x20random\x20packet\x20-\x20encrypted\x20','2984naOnOM','invalid_message','gglfv','should\x20not\x20get\x20there','log','FVFdm','should\x20emit\x20a\x20\x27invalid_sequence_number\x27\x20event\x20if\x20a\x20message\x20does\x20not\x20have\x20a\x201-increased\x20sequence\x20number','7466558MLjjTM','yyPFy','wFxcZ','1514896cvhasR','Uulxi','invalid_sequence_number','equal','GmoKV','YIKTQ','bondD','MessageBuilder','CImOz'];_0x112f=function(){return _0x789cc9;};return _0x112f();}(function(_0xf3c38f,_0x185cea){const _0x85c33c=_0x1ede,_0x70a064=_0xf3c38f();while(!![]){try{const _0x23c9ac=-parseInt(_0x85c33c(0x133))/0x1+parseInt(_0x85c33c(0x11e))/0x2+-parseInt(_0x85c33c(0x132))/0x3*(parseInt(_0x85c33c(0x128))/0x4)+-parseInt(_0x85c33c(0x13c))/0x5*(-parseInt(_0x85c33c(0x144))/0x6)+-parseInt(_0x85c33c(0x136))/0x7*(parseInt(_0x85c33c(0x159))/0x8)+-parseInt(_0x85c33c(0x13b))/0x9*(parseInt(_0x85c33c(0x157))/0xa)+parseInt(_0x85c33c(0x160))/0xb;if(_0x23c9ac===_0x185cea)break;else _0x70a064['push'](_0x70a064['shift']());}catch(_0x3553b6){_0x70a064['push'](_0x70a064['shift']());}}}(_0x112f,0x65d0c));const should=require(_0x1e94ad(0x129)),{MessageBuilder}=require('..'),{SecurityPolicy,MessageSecurityMode}=require('..'),packets=require('node-opcua-transport/dist/test-fixtures'),{redirectToFile}=require(_0x1e94ad(0x135)),debugLog=require('node-opcua-debug')[_0x1e94ad(0x12c)](__filename);function _0x1ede(_0x5814c5,_0x176c70){const _0x112f4f=_0x112f();return _0x1ede=function(_0x1ede5a,_0x10442e){_0x1ede5a=_0x1ede5a-0x11e;let _0x498f85=_0x112f4f[_0x1ede5a];return _0x498f85;},_0x1ede(_0x5814c5,_0x176c70);}describe(_0x1e94ad(0x125),function(){const _0x170939=_0x1e94ad,_0x3e1274={'QiJby':function(_0x43d74b){return _0x43d74b();},'DdDmZ':_0x170939(0x120),'LKzUt':function(_0x1116d2){return _0x1116d2();},'IgixE':'full_message_body','wTnLM':_0x170939(0x131),'SVrhm':_0x170939(0x151),'ZcsnL':function(_0x18b373){return _0x18b373();},'bondD':function(_0x28cad8,_0x43a232,_0x395bd4,_0x511d75){return _0x28cad8(_0x43a232,_0x395bd4,_0x511d75);},'XHtOg':function(_0x55edb4,_0x4210f8){return _0x55edb4+_0x4210f8;},'qspah':_0x170939(0x145),'MnzOo':'bad_object_id_error','yyPFy':function(_0x507882,_0x50e92a,_0xdcf7dd,_0x4da6f0,_0x4f8e6c){return _0x507882(_0x50e92a,_0xdcf7dd,_0x4da6f0,_0x4f8e6c);},'nQGzo':_0x170939(0x12e),'UkGLT':function(_0x19e9e0,_0x52855d){return _0x19e9e0(_0x52855d);},'mmyrD':function(_0x394e5f,_0x3e3717){return _0x394e5f(_0x3e3717);},'NKQyz':function(_0x488866){return _0x488866();},'hsxSB':_0x170939(0x11f),'qpTHV':_0x170939(0x14c),'XBMDK':function(_0x323381,_0x1a9f33){return _0x323381(_0x1a9f33);},'hQnZF':_0x170939(0x15c),'EepvL':_0x170939(0x12d),'AKIjQ':function(_0x7db0b2,_0x1ebede,_0x59cf61){return _0x7db0b2(_0x1ebede,_0x59cf61);},'BQfcC':_0x170939(0x140),'BNvVt':_0x170939(0x13e),'sLboj':function(_0x17611d,_0x2730bd,_0x39617c){return _0x17611d(_0x2730bd,_0x39617c);},'jGJXv':'should\x20raise\x20an\x20invalid_message\x20if\x20the\x20embedded\x20object\x20failed\x20to\x20be\x20decoded','GmoKV':_0x170939(0x158)};_0x3e1274[_0x170939(0x14d)](it,_0x3e1274[_0x170939(0x146)],function(_0x50d164){const _0x2a6c9e=_0x170939,_0x383d02={'gglfv':function(_0x3714f7,_0x1e24cc){return _0x3714f7!==_0x1e24cc;},'YIKTQ':_0x2a6c9e(0x126),'MkbmI':function(_0x88496b){const _0x506f54=_0x2a6c9e;return _0x3e1274[_0x506f54(0x138)](_0x88496b);},'aixSQ':_0x2a6c9e(0x130)};if(_0x2a6c9e(0x15e)===_0x2a6c9e(0x15e)){const _0x297194=new MessageBuilder();let _0x814363=![],_0x35b141=![];_0x297194['on'](_0x2a6c9e(0x12d),_0x2ac4ce=>{const _0x30397a=_0x2a6c9e;_0x383d02[_0x30397a(0x15b)](_0x383d02[_0x30397a(0x123)],_0x383d02['YIKTQ'])?(_0x26e39c[_0x30397a(0x15d)](_0x55d53d),_0x564b05()):_0x35b141=!![];})['on'](_0x2a6c9e(0x12b),_0x3966bb=>{const _0x1e8a63=_0x2a6c9e,_0x5d3519={'xLaTw':function(_0x5b9f1d){return _0x383d02['MkbmI'](_0x5b9f1d);}};_0x1e8a63(0x130)===_0x383d02['aixSQ']?_0x814363=!![]:(_0x3e21b2['should']['be'][_0x1e8a63(0x12f)](_0x535c4c),_0x36de4e[_0x1e8a63(0x129)][_0x1e8a63(0x13a)](!![]),_0x5d3519[_0x1e8a63(0x14f)](_0x5bd6ae));})['on'](_0x2a6c9e(0x131),_0x5cbc60=>{const _0x213a13=_0x2a6c9e;_0x5cbc60['should']['be'][_0x213a13(0x12f)](Error),_0x35b141[_0x213a13(0x129)][_0x213a13(0x121)](![]),_0x814363[_0x213a13(0x129)][_0x213a13(0x121)](!![]),_0x50d164();}),_0x297194['feed'](packets[_0x2a6c9e(0x153)]);}else{const _0x2e4a60={'qbMdU':function(_0x2bc62c){const _0x266b92=_0x2a6c9e;return _0x3e1274[_0x266b92(0x150)](_0x2bc62c);}},_0x4fdc51=new _0x3f0c17({});_0x4fdc51[_0x2a6c9e(0x154)](_0x4d65de[_0x2a6c9e(0x13d)],_0x18a152[_0x2a6c9e(0x134)]),_0x4fdc51['on'](_0x2a6c9e(0x12d),_0x39f21d=>{})['on'](_0x2a6c9e(0x131),_0xd4250c=>{const _0x41282e=_0x2a6c9e;_0x3ef595[_0x41282e(0x15d)](_0xd4250c),_0x2e4a60[_0x41282e(0x156)](_0x5a73bb);})['on'](_0x3e1274[_0x2a6c9e(0x155)],function(_0x4d029b,_0x595a62){const _0x2392ba=_0x2a6c9e;_0x3928a1(new _0x45773d(_0x2392ba(0x15c)));}),_0x4fdc51[_0x2a6c9e(0x142)](_0xef270f['random_packet']);}});function _0x2f30f9(_0x20ad0a,_0x437042,_0x2380f8,_0xdb1440){const _0x1d4e9b=_0x170939,_0x1561ab={'wFxcZ':function(_0x4c0f0a,_0x2dedfa){return _0x4c0f0a!==_0x2dedfa;},'mBhgl':_0x3e1274['SVrhm'],'XZdLg':function(_0xfba435){const _0x14b647=_0x1ede;return _0x3e1274[_0x14b647(0x138)](_0xfba435);},'RHImb':function(_0x2b8359){const _0x2f9a3d=_0x1ede;return _0x3e1274[_0x2f9a3d(0x152)](_0x2b8359);}};_0x3e1274[_0x1d4e9b(0x124)](redirectToFile,_0x3e1274['XHtOg'](_0x3e1274['qspah'],_0x20ad0a)+_0x1d4e9b(0x13f),()=>{const _0x35227b=_0x1d4e9b,_0x2d557b=new MessageBuilder();let _0x348841=![],_0x2b78d7=![];_0x2d557b['on']('message',_0x1c2a29=>{_0x2b78d7=!![];})['on'](_0x3e1274['IgixE'],_0x3b3da8=>{_0x348841=!![];})['on'](_0x35227b(0x15a),_0x54ada1=>{const _0x37f49c=_0x35227b;_0x1561ab[_0x37f49c(0x162)]('NQtyI',_0x1561ab[_0x37f49c(0x143)])?(_0x420ca6[_0x37f49c(0x129)][_0x37f49c(0x13a)](![]),_0xf251f2[_0x37f49c(0x129)][_0x37f49c(0x121)](![]),_0x35e763[_0x37f49c(0x129)]['equal'](!![]),_0x5942f0()):(_0x2380f8['should'][_0x37f49c(0x13a)](![]),_0x2b78d7['should']['equal'](![]),_0x348841[_0x37f49c(0x129)][_0x37f49c(0x121)](!![]),_0x1561ab['XZdLg'](_0xdb1440));})['on'](_0x3e1274['wTnLM'],_0x1e7a3c=>{const _0x28a0f5=_0x35227b;_0x1e7a3c[_0x28a0f5(0x129)]['be'][_0x28a0f5(0x12f)](Error),_0x2380f8[_0x28a0f5(0x129)]['eql'](!![]),_0x1561ab[_0x28a0f5(0x148)](_0xdb1440);}),_0x2d557b['feed'](_0x437042);},function(){});}it(_0x3e1274[_0x170939(0x137)],function(_0x10fc56){const _0x102609=_0x170939,_0x26d9fd=Buffer[_0x102609(0x149)](packets[_0x102609(0x139)]);_0x26d9fd['writeUInt8'](0xff,0x50),_0x26d9fd[_0x102609(0x141)](0xff,0x51),_0x26d9fd[_0x102609(0x141)](0xff,0x52),_0x2f30f9(_0x3e1274[_0x102609(0x14a)],_0x26d9fd,!![],_0x10fc56);}),_0x3e1274['sLboj'](it,_0x3e1274[_0x170939(0x147)],function(_0xf0a0cc){const _0x368f20=_0x170939,_0x21b99c=Buffer[_0x368f20(0x149)](packets['openChannelRequest1']);_0x21b99c[_0x368f20(0x141)](0xa,0x65),_0x21b99c[_0x368f20(0x141)](0xb,0x66),_0x21b99c[_0x368f20(0x141)](0xff,0x67),_0x3e1274[_0x368f20(0x161)](_0x2f30f9,_0x3e1274['nQGzo'],_0x21b99c,![],_0xf0a0cc);}),it(_0x170939(0x15f),function(_0x5a92c4){const _0x17358b=_0x170939,_0x35e9b6={'KUgbL':function(_0x3bce4a){return _0x3e1274['NKQyz'](_0x3bce4a);}},_0x3782cd=new MessageBuilder();_0x3782cd['on'](_0x17358b(0x12d),_0x32b634=>{})['on']('error',_0x2c89d7=>{const _0xa79274=_0x17358b;console['log'](_0x2c89d7),_0x3e1274[_0xa79274(0x12a)](_0x5a92c4,_0x3e1274[_0xa79274(0x14e)](Error,_0xa79274(0x15c)));})['on'](_0x3e1274[_0x17358b(0x155)],function(_0x5e014e,_0x2e51ae){_0x35e9b6['KUgbL'](_0x5a92c4);}),_0x3782cd[_0x17358b(0x142)](packets[_0x17358b(0x139)]),_0x3782cd[_0x17358b(0x142)](packets[_0x17358b(0x139)]);}),_0x3e1274[_0x170939(0x14d)](it,_0x3e1274[_0x170939(0x122)],_0x534d4=>{const _0x1fa7d1=_0x170939,_0x33b4b5=new MessageBuilder({});_0x33b4b5[_0x1fa7d1(0x154)](MessageSecurityMode[_0x1fa7d1(0x13d)],SecurityPolicy[_0x1fa7d1(0x134)]),_0x33b4b5['on'](_0x3e1274['EepvL'],_0x22209a=>{})['on'](_0x1fa7d1(0x131),_0x30c0d0=>{const _0xcf5ef=_0x1fa7d1;console[_0xcf5ef(0x15d)](_0x30c0d0),_0x534d4();})['on'](_0x1fa7d1(0x120),function(_0x5022b9,_0x2c9a14){const _0x136109=_0x1fa7d1;_0x3e1274['hsxSB']===_0x3e1274[_0x136109(0x14b)]?_0x383db7=!![]:_0x3e1274[_0x136109(0x127)](_0x534d4,new Error(_0x3e1274['hQnZF']));}),_0x33b4b5['feed'](packets['random_packet']);});});