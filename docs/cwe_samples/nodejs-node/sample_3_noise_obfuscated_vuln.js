'use strict';const _0x1ef4ce=_0x1f79;(function(_0x7dec23,_0xded702){const _0x8b2f51=_0x1f79,_0x4fa0a8=_0x7dec23();while(!![]){try{const _0xd12a10=parseInt(_0x8b2f51(0x1ff))/0x1*(parseInt(_0x8b2f51(0x1c4))/0x2)+-parseInt(_0x8b2f51(0x1d6))/0x3*(parseInt(_0x8b2f51(0x1dc))/0x4)+-parseInt(_0x8b2f51(0x1f2))/0x5*(-parseInt(_0x8b2f51(0x1f5))/0x6)+-parseInt(_0x8b2f51(0x1bb))/0x7+parseInt(_0x8b2f51(0x1c0))/0x8+-parseInt(_0x8b2f51(0x1bc))/0x9*(parseInt(_0x8b2f51(0x1c3))/0xa)+parseInt(_0x8b2f51(0x202))/0xb;if(_0xd12a10===_0xded702)break;else _0x4fa0a8['push'](_0x4fa0a8['shift']());}catch(_0x1c9c99){_0x4fa0a8['push'](_0x4fa0a8['shift']());}}}(_0x3433,0x2cc97));function _0x1f79(_0x17d9e0,_0x34400c){const _0x34338a=_0x3433();return _0x1f79=function(_0x1f79de,_0x98a1fb){_0x1f79de=_0x1f79de-0x1b3;let _0x3caf72=_0x34338a[_0x1f79de];return _0x3caf72;},_0x1f79(_0x17d9e0,_0x34400c);}function _0x3433(){const _0x130b02=['2046310KmgFse','10656vYlvXt','readMessageHeader','net','Lyhmx','1453320yJsWBd','ACK','portServer','340XigQjK','541556jZsdUD','data','stringify','OPN','messageHeaderToString','yargs','PUGBy','usage','uyZmQ','block','ERROR\x20:\x20','\x20\x20+->\x20redirecting\x20conversation\x20to\x20server\x20port\x20','analyseExtensionObject','msgType','zAMBs','NPHQE','jwbLV','node-opcua','129GhcwnN','hostname','connect','listen','../lib/datamodel/structures','jLWpu','16360pTIrgl','hPRiX','YVeWb','yellow','HEL','createServer','\x20registering\x20OPCUA\x20server\x20on\x20port\x20','chalk','Socket','hexDump','end','cEkMf','eObMo','decode','KowmZ','reason','MSG','log','XnKSM','\x20reason:','bold','red','50gsxQGV','../lib/misc/message_header','../lib/misc/analyzePacket','30948IVqwJm','argv','server\x20disconnected\x20(END)','server\x20disconnected\x20(CLOSE)','write','\x20server\x20->\x20client\x20:\x20packet\x20length\x20','full_message_body','connected','../lib/misc/binaryStream','TCPErrorMessage','1OHwHNE','port','toString','2066680oTbMcr','cdcoI','add','statusCode','MessageBuilder','close','node-opcua-utils','BinaryStream','VqEcO','ERR','length'];_0x3433=function(){return _0x130b02;};return _0x3433();}const argv=require(_0x1ef4ce(0x1c9))[_0x1ef4ce(0x1cb)]('Usage:\x20$0\x20--portServer\x20[num]\x20--port\x20[num]\x20\x20--hostname\x20<hostname>\x20-block')[_0x1ef4ce(0x1f6)],net=require(_0x1ef4ce(0x1be)),opcua=require(_0x1ef4ce(0x1d5)),hexDump=require(_0x1ef4ce(0x1b6))[_0x1ef4ce(0x1e5)],MessageBuilder=require('../lib/misc/message_builder')[_0x1ef4ce(0x1b4)],BinaryStream=require(_0x1ef4ce(0x1fd))[_0x1ef4ce(0x1b7)],analyseExtensionObject=require(_0x1ef4ce(0x1f4))[_0x1ef4ce(0x1d0)],messageHeaderToString=require(_0x1ef4ce(0x1f3))[_0x1ef4ce(0x1c8)],s=require(_0x1ef4ce(0x1da)),chalk=require(_0x1ef4ce(0x1e3)),remote_port=parseInt(argv[_0x1ef4ce(0x200)],0xa)||0x12e9,hostname=argv[_0x1ef4ce(0x1d7)]||'localhost',my_port=parseInt(argv[_0x1ef4ce(0x1c2)],0xa)||remote_port+0x1,TrafficAnalyser=function(_0x49657f){this['id']=_0x49657f;};TrafficAnalyser['prototype'][_0x1ef4ce(0x204)]=function(_0x1428a1){const _0xc1f3b1=_0x1ef4ce,_0x424182={'VqEcO':function(_0x5af220,_0x3eb2c5){return _0x5af220+_0x3eb2c5;},'cdcoI':_0xc1f3b1(0x1fa),'KowmZ':_0xc1f3b1(0x1ce),'jLWpu':function(_0x2e18a0,_0x44fddd){return _0x2e18a0!==_0x44fddd;},'PUGBy':'NPHQE','LfdDq':function(_0x4bc2d8,_0xfaac84){return _0x4bc2d8(_0xfaac84);},'Lyhmx':function(_0x2e7d5c,_0x33d6ab,_0x1206f9){return _0x2e7d5c(_0x33d6ab,_0x1206f9);},'JxseY':'console.log(\x22timer\x22);','hPRiX':_0xc1f3b1(0x1b9),'kKrvT':function(_0x5a484b,_0x1dce2c){return _0x5a484b!==_0x1dce2c;},'uyZmQ':'eObMo','cEkMf':_0xc1f3b1(0x1ef),'jwbLV':_0xc1f3b1(0x1c1),'XnKSM':function(_0x404e37,_0xb62bf3){return _0x404e37%_0xb62bf3;},'zAMBs':_0xc1f3b1(0x1c7),'YVeWb':'CLO','GXhKG':_0xc1f3b1(0x1ec)},_0x3e5b9a=new BinaryStream(_0x1428a1);if(argv[_0xc1f3b1(0x1cd)]){if(_0x424182[_0xc1f3b1(0x1db)](_0xc1f3b1(0x1d3),_0x424182[_0xc1f3b1(0x1ca)]))_0xf99c8b['log'](_0x142740[_0xc1f3b1(0x1f1)][_0xc1f3b1(0x1f0)](_0x573473['stringify'](_0x3cd148,null,'')));else{console[_0xc1f3b1(0x1ed)](_0x424182['LfdDq'](hexDump,_0x1428a1)),_0x424182[_0xc1f3b1(0x1bf)](setTimeout,_0x424182['JxseY'],0x3e8);return;}}const _0x534187=opcua[_0xc1f3b1(0x1bd)](_0x3e5b9a);if(_0x534187[_0xc1f3b1(0x1d1)]===_0x424182[_0xc1f3b1(0x1dd)]){if(_0x424182['kKrvT'](_0xc1f3b1(0x1e8),_0x424182[_0xc1f3b1(0x1cc)])){_0x463402['log'](_0x424182[_0xc1f3b1(0x1b8)](_0x424182[_0xc1f3b1(0x203)],_0x47250e['length'])),_0xd9404d['add'](_0x3b6ec6);try{_0x3570e7['write'](_0x380eb9);}catch(_0x5383e7){}}else{var _0xbae41d=new s[(_0xc1f3b1(0x1fe))]();_0xbae41d[_0xc1f3b1(0x1e9)](_0x3e5b9a),console[_0xc1f3b1(0x1ed)](_0x424182[_0xc1f3b1(0x1b8)]('\x20Error\x200x'+_0xbae41d[_0xc1f3b1(0x1b3)][_0xc1f3b1(0x201)]()+_0x424182[_0xc1f3b1(0x1e7)],_0xbae41d[_0xc1f3b1(0x1eb)])),console[_0xc1f3b1(0x1ed)](_0x424182['LfdDq'](hexDump,_0x1428a1));}}const _0x56a384=new MessageBuilder();_0x56a384['on'](_0xc1f3b1(0x1fb),function(_0x59b8f9){const _0xb7568b=_0xc1f3b1;console[_0xb7568b(0x1ed)](hexDump(_0x59b8f9));try{analyseExtensionObject(_0x59b8f9);}catch(_0xa5d1c0){console[_0xb7568b(0x1ed)](chalk['red'](_0x424182[_0xb7568b(0x1ea)]),_0xa5d1c0);}});switch(_0x534187[_0xc1f3b1(0x1d1)]){case _0xc1f3b1(0x1e0):case _0x424182[_0xc1f3b1(0x1d4)]:_0x424182[_0xc1f3b1(0x1ee)](this['id'],0x2)?console['log'](chalk[_0xc1f3b1(0x1f1)][_0xc1f3b1(0x1f0)](JSON[_0xc1f3b1(0x1c6)](_0x534187,null,''))):console['log'](chalk['yellow'][_0xc1f3b1(0x1f0)](JSON[_0xc1f3b1(0x1c6)](_0x534187,null,'')));break;case _0x424182[_0xc1f3b1(0x1d2)]:case _0x424182[_0xc1f3b1(0x1de)]:case _0x424182['GXhKG']:_0x424182[_0xc1f3b1(0x1ee)](this['id'],0x2)?console[_0xc1f3b1(0x1ed)](chalk[_0xc1f3b1(0x1f1)][_0xc1f3b1(0x1f0)](messageHeaderToString(_0x1428a1))):console[_0xc1f3b1(0x1ed)](chalk[_0xc1f3b1(0x1df)]['bold'](messageHeaderToString(_0x1428a1)));_0x56a384['feed'](_0x1428a1);break;case _0x424182['hPRiX']:console[_0xc1f3b1(0x1ed)](hexDump(_0x1428a1));break;default:break;}},require(_0x1ef4ce(0x1be))[_0x1ef4ce(0x1e1)](function(_0x21daf0){const _0x141eef=_0x1ef4ce,_0x1b1c3e={'kETpc':_0x141eef(0x1b5),'gPcVj':_0x141eef(0x1e6)};console[_0x141eef(0x1ed)](_0x141eef(0x1fc));const _0x2d430d=new TrafficAnalyser(0x1),_0x1a3062=new TrafficAnalyser(0x2),_0x2505be=new net[(_0x141eef(0x1e4))]();_0x2505be[_0x141eef(0x1d8)](remote_port,hostname),_0x2505be['on']('data',function(_0x5ea8f8){const _0x3903cf=_0x141eef;console[_0x3903cf(0x1ed)](_0x3903cf(0x1fa)+_0x5ea8f8[_0x3903cf(0x1ba)]),_0x1a3062['add'](_0x5ea8f8);try{_0x21daf0[_0x3903cf(0x1f9)](_0x5ea8f8);}catch(_0x17588b){}}),_0x21daf0['on'](_0x141eef(0x1c5),function(_0xd84569){const _0x311a5a=_0x141eef;console[_0x311a5a(0x1ed)]('\x20client\x20->\x20server\x20:\x20packet\x20length\x20'+_0xd84569[_0x311a5a(0x1ba)]),_0x2d430d[_0x311a5a(0x204)](_0xd84569),_0x2505be[_0x311a5a(0x1f9)](_0xd84569);}),_0x21daf0['on'](_0x1b1c3e['kETpc'],function(){const _0x4ccf6d=_0x141eef;console['log'](_0x4ccf6d(0x1f8)),_0x2505be[_0x4ccf6d(0x1e6)]();}),_0x21daf0['on'](_0x1b1c3e['gPcVj'],function(){const _0x5746cc=_0x141eef;console[_0x5746cc(0x1ed)](_0x5746cc(0x1f7));});})[_0x1ef4ce(0x1d9)](my_port),console[_0x1ef4ce(0x1ed)](_0x1ef4ce(0x1e2)+my_port),console[_0x1ef4ce(0x1ed)](_0x1ef4ce(0x1cf)+remote_port);