function _0x49a2(){const _0x391723=['admin','isMultiUserMode','multiUserMode','3071272sMJuHn','default','59898ctxYzf','../http','7913995koYCPg','6AUuKBE','status','json','6560300YHAVlg','Invalid\x20request','all','hOfqs','locals','role','hcgqj','21xRexzj','sendStatus','66210ojrzTF','10527039KjWAKO','includes','1318959goyIYN','../../models/systemSettings','end','4169fFLnqY','TknOQ','bkeQw','manager','116OqvCgX','<all>'];_0x49a2=function(){return _0x391723;};return _0x49a2();}const _0x1fe6c5=_0x4841;function _0x4841(_0x1c45a4,_0x55c3c9){const _0x49a22b=_0x49a2();return _0x4841=function(_0x4841fd,_0x19fb3e){_0x4841fd=_0x4841fd-0xfa;let _0x62ec82=_0x49a22b[_0x4841fd];return _0x62ec82;},_0x4841(_0x1c45a4,_0x55c3c9);}(function(_0xe347d1,_0x21b789){const _0x1a72b5=_0x4841,_0x1698a1=_0xe347d1();while(!![]){try{const _0x227274=parseInt(_0x1a72b5(0x102))/0x1+parseInt(_0x1a72b5(0x109))/0x2*(parseInt(_0x1a72b5(0x110))/0x3)+parseInt(_0x1a72b5(0x116))/0x4+parseInt(_0x1a72b5(0x112))/0x5*(parseInt(_0x1a72b5(0x113))/0x6)+-parseInt(_0x1a72b5(0xfd))/0x7*(parseInt(_0x1a72b5(0x10e))/0x8)+-parseInt(_0x1a72b5(0x100))/0x9+parseInt(_0x1a72b5(0xff))/0xa*(-parseInt(_0x1a72b5(0x105))/0xb);if(_0x227274===_0x21b789)break;else _0x1698a1['push'](_0x1698a1['shift']());}catch(_0x1ab348){_0x1698a1['push'](_0x1698a1['shift']());}}}(_0x49a2,0xd42f0));const {SystemSettings}=require(_0x1fe6c5(0x103)),{userFromSession}=require(_0x1fe6c5(0x111)),ROLES={'all':_0x1fe6c5(0x10a),'admin':'admin','manager':_0x1fe6c5(0x108),'default':_0x1fe6c5(0x10f)},DEFAULT_ROLES=[ROLES[_0x1fe6c5(0x10b)],ROLES[_0x1fe6c5(0x10b)]];function strictMultiUserRoleValid(_0x2414ef=DEFAULT_ROLES){const _0x29deba={'TknOQ':function(_0x5f3711){return _0x5f3711();}};return async(_0x5f36d0,_0x30edc6,_0x589df4)=>{const _0x9d082a=_0x4841;if(_0x2414ef[_0x9d082a(0x101)](ROLES[_0x9d082a(0x118)])){_0x589df4();return;}const _0x111d8a=_0x30edc6[_0x9d082a(0xfa)]?.[_0x9d082a(0x10d)]??await SystemSettings[_0x9d082a(0x10c)]();if(!_0x111d8a)return _0x30edc6[_0x9d082a(0xfe)](0x191)[_0x9d082a(0x104)]();const _0x2d380d=_0x30edc6[_0x9d082a(0xfa)]?.['user']??await userFromSession(_0x5f36d0,_0x30edc6);if(_0x2414ef[_0x9d082a(0x101)](_0x2d380d?.[_0x9d082a(0xfb)])){_0x29deba[_0x9d082a(0x106)](_0x589df4);return;}return _0x30edc6[_0x9d082a(0xfe)](0x191)[_0x9d082a(0x104)]();};}function flexUserRoleValid(_0x5ee569=DEFAULT_ROLES){const _0x335b92=_0x1fe6c5,_0x1e8845={'IprrK':'Invalid\x20request','cgiTq':function(_0x25300f){return _0x25300f();},'hcgqj':_0x335b92(0x119),'bkeQw':function(_0x1c6533){return _0x1c6533();}};return async(_0x1de1a2,_0x1ab4b4,_0x44a2e3)=>{const _0x3198df=_0x335b92;if(_0x5ee569[_0x3198df(0x101)](ROLES[_0x3198df(0x118)])){_0x1e8845['cgiTq'](_0x44a2e3);return;}const _0x1f6172=_0x1ab4b4['locals']?.[_0x3198df(0x10d)]??await SystemSettings['isMultiUserMode']();if(!_0x1f6172){if(_0x1e8845[_0x3198df(0xfc)]!==_0x1e8845[_0x3198df(0xfc)]){_0x31de1c['status'](0x193)[_0x3198df(0x115)]({'error':_0x1e8845['IprrK']});return;}else{_0x44a2e3();return;}}const _0xb21e56=_0x1ab4b4[_0x3198df(0xfa)]?.['user']??await userFromSession(_0x1de1a2,_0x1ab4b4);if(_0x5ee569['includes'](_0xb21e56?.[_0x3198df(0xfb)])){_0x1e8845[_0x3198df(0x107)](_0x44a2e3);return;}return _0x1ab4b4[_0x3198df(0xfe)](0x191)[_0x3198df(0x104)]();};}async function isMultiUserSetup(_0x4e72cd,_0x176535,_0x3dd604){const _0x450506=_0x1fe6c5,_0x4eb63b={'aJgHH':_0x450506(0x117)},_0x1375fd=await SystemSettings[_0x450506(0x10c)]();if(!_0x1375fd){_0x176535[_0x450506(0x114)](0x193)[_0x450506(0x115)]({'error':_0x4eb63b['aJgHH']});return;}_0x3dd604();return;}module['exports']={'ROLES':ROLES,'strictMultiUserRoleValid':strictMultiUserRoleValid,'flexUserRoleValid':flexUserRoleValid,'isMultiUserSetup':isMultiUserSetup};