const _0x2632b6=_0x7483;(function(_0x3d62f4,_0x406813){const _0x50d361=_0x7483,_0x292a53=_0x3d62f4();while(!![]){try{const _0x3b404d=parseInt(_0x50d361(0xfc))/0x1*(-parseInt(_0x50d361(0x107))/0x2)+-parseInt(_0x50d361(0x118))/0x3*(-parseInt(_0x50d361(0xff))/0x4)+parseInt(_0x50d361(0x114))/0x5*(-parseInt(_0x50d361(0x128))/0x6)+-parseInt(_0x50d361(0x105))/0x7+parseInt(_0x50d361(0x125))/0x8+-parseInt(_0x50d361(0x10d))/0x9+parseInt(_0x50d361(0x116))/0xa*(parseInt(_0x50d361(0x126))/0xb);if(_0x3b404d===_0x406813)break;else _0x292a53['push'](_0x292a53['shift']());}catch(_0x2d612e){_0x292a53['push'](_0x292a53['shift']());}}}(_0x2565,0x4a5ce));const {Document}=require(_0x2632b6(0xfd)),{normalizePath,documentsPath,isWithin}=require(_0x2632b6(0x11c)),{reqBody}=require(_0x2632b6(0x127)),{flexUserRoleValid,ROLES}=require(_0x2632b6(0x10a)),{validatedRequest}=require('../utils/middleware/validatedRequest'),fs=require('fs'),path=require(_0x2632b6(0x11b));function _0x2565(){const _0x37f350=['mkdirSync','2552940NTdNIW','map','where','Failed\x20to\x20create\x20folder:\x20','error','/document/move-files','exports','92315UojmpD','hweCw','728720uNOtAI','admin','88647FAYmUC','post','IHfJp','path','../utils/files','existsSync','Error\x20moving\x20file\x20','\x20to\x20','resolve','status','UgDcW','Invalid\x20folder\x20name.','message','2757104PPFJsd','22tMyLPe','../utils/http','12nLlHLD','catch','WcpoS','rename','Failed\x20to\x20move\x20some\x20files.','EuLUL','join','\x20files\x20not\x20moved.\x20Unembed\x20them\x20from\x20all\x20workspaces.','VRMyP','BlmpM','1BWUHam','../models/documents','filter','60REdEVd','jDYqm','yXawS','length','Failed\x20to\x20move\x20files.','json','1771210tencHS','Folder\x20by\x20that\x20name\x20already\x20exists','110822ftAEPs','/document/create-folder','kqjCt','../utils/middleware/multiUserProtected','manager'];_0x2565=function(){return _0x37f350;};return _0x2565();}function _0x7483(_0x5dd873,_0x2589d5){const _0x25650f=_0x2565();return _0x7483=function(_0x74835b,_0x578af4){_0x74835b=_0x74835b-0xf6;let _0x3f9a30=_0x25650f[_0x74835b];return _0x3f9a30;},_0x7483(_0x5dd873,_0x2589d5);}function documentEndpoints(_0x18306e){const _0x212c24=_0x2632b6,_0x3c55c6={'WcpoS':function(_0xeeaeaf,_0x2cf4bb){return _0xeeaeaf(_0x2cf4bb);},'jDYqm':_0x212c24(0x123),'jLHLZ':_0x212c24(0x106),'BlmpM':function(_0x178084,_0x51e457){return _0x178084(_0x51e457);},'IHfJp':_0x212c24(0x122),'EuLUL':function(_0x40c2c4,_0x29d33b){return _0x40c2c4-_0x29d33b;},'kqjCt':'VoMJE','tAbfn':'Error\x20moving\x20files:','VRMyP':_0x212c24(0x112)};if(!_0x18306e)return;_0x18306e['post'](_0x212c24(0x108),[validatedRequest,flexUserRoleValid([ROLES['admin'],ROLES['manager']])],async(_0x4f887f,_0x452f88)=>{const _0x37b0d1=_0x212c24;try{const {name:_0x5f4c42}=reqBody(_0x4f887f),_0x4926d2=path[_0x37b0d1(0xf8)](documentsPath,_0x3c55c6[_0x37b0d1(0x12a)](normalizePath,_0x5f4c42));if(!isWithin(path['resolve'](documentsPath),path[_0x37b0d1(0x120)](_0x4926d2)))throw new Error(_0x3c55c6[_0x37b0d1(0x100)]);if(fs[_0x37b0d1(0x11d)](_0x4926d2)){_0x452f88[_0x37b0d1(0x121)](0x1f4)[_0x37b0d1(0x104)]({'success':![],'message':_0x3c55c6['jLHLZ']});return;}fs['mkdirSync'](_0x4926d2,{'recursive':!![]}),_0x452f88[_0x37b0d1(0x121)](0xc8)['json']({'success':!![],'message':null});}catch(_0x1f2f9c){console[_0x37b0d1(0x111)](_0x1f2f9c),_0x452f88[_0x37b0d1(0x121)](0x1f4)['json']({'success':![],'message':_0x37b0d1(0x110)+_0x1f2f9c[_0x37b0d1(0x124)]+'\x20'});}}),_0x18306e[_0x212c24(0x119)](_0x3c55c6[_0x212c24(0xfa)],[validatedRequest,_0x3c55c6[_0x212c24(0xfb)](flexUserRoleValid,[ROLES[_0x212c24(0x117)],ROLES[_0x212c24(0x10b)]])],async(_0x1a5290,_0x1daa93)=>{const _0xa1dc46=_0x212c24,_0x1330af={'arNoC':_0x3c55c6[_0xa1dc46(0x109)],'yXawS':'YPnKQ','hweCw':_0x3c55c6[_0xa1dc46(0x100)],'AsNSh':_0x3c55c6['tAbfn']};try{const {files:_0x54977f}=reqBody(_0x1a5290),_0x2264e1=_0x54977f[_0xa1dc46(0x10e)](({from:_0x2441ea})=>_0x2441ea),_0xf27500=await Document[_0xa1dc46(0x10f)]({'docpath':{'in':_0x2264e1}}),_0xd18c26=_0xf27500[_0xa1dc46(0x10e)](_0x24a3d0=>_0x24a3d0['docpath']),_0x594109=_0x54977f[_0xa1dc46(0xfe)](({from:_0x1b7d13})=>!_0xd18c26['includes'](_0x1b7d13)),_0x46117a=_0x594109['map'](({from:_0x2e8603,to:_0x249194})=>{const _0x2e92cf=_0xa1dc46,_0x4640b9=path['join'](documentsPath,_0x3c55c6['BlmpM'](normalizePath,_0x2e8603)),_0x46b05c=path[_0x2e92cf(0xf8)](documentsPath,normalizePath(_0x249194));return new Promise((_0xe0bb19,_0x263cbc)=>{const _0x57f2f4=_0x2e92cf;_0x1330af['arNoC']===_0x1330af[_0x57f2f4(0x101)]?_0x475118[_0x57f2f4(0x121)](0xc8)[_0x57f2f4(0x104)]({'success':!![],'message':_0x3ca33c+'/'+_0x3bb3ff['length']+_0x57f2f4(0xf9)}):fs[_0x57f2f4(0x12b)](_0x4640b9,_0x46b05c,_0x34168d=>{const _0x4f95d9=_0x57f2f4;_0x34168d?(console[_0x4f95d9(0x111)](_0x4f95d9(0x11e)+_0x2e8603+_0x4f95d9(0x11f)+_0x249194+':',_0x34168d),_0x263cbc(_0x34168d)):_0xe0bb19();});});});Promise['all'](_0x46117a)['then'](()=>{const _0xac0bf6=_0xa1dc46;if(_0x3c55c6['IHfJp']!==_0x3c55c6[_0xac0bf6(0x11a)]){const {name:_0x4da261}=_0x9d9d4b(_0x3ced33),_0x3ba933=_0x33dd9b[_0xac0bf6(0xf8)](_0x37706e,_0x570f77(_0x4da261));if(!_0x39e80f(_0x1b7ae7[_0xac0bf6(0x120)](_0x5f588b),_0x4d8e22['resolve'](_0x3ba933)))throw new _0x5e4a45(_0x1330af[_0xac0bf6(0x115)]);if(_0x5a6f00['existsSync'](_0x3ba933)){_0x4b37de[_0xac0bf6(0x121)](0x1f4)[_0xac0bf6(0x104)]({'success':![],'message':_0xac0bf6(0x106)});return;}_0x22eeb5[_0xac0bf6(0x10c)](_0x3ba933,{'recursive':!![]}),_0x4d89eb[_0xac0bf6(0x121)](0xc8)[_0xac0bf6(0x104)]({'success':!![],'message':null});}else{const _0x54c464=_0x3c55c6[_0xac0bf6(0xf7)](_0x54977f[_0xac0bf6(0x102)],_0x594109['length']);_0x54c464>0x0?_0x1daa93[_0xac0bf6(0x121)](0xc8)[_0xac0bf6(0x104)]({'success':!![],'message':_0x54c464+'/'+_0x54977f[_0xac0bf6(0x102)]+'\x20files\x20not\x20moved.\x20Unembed\x20them\x20from\x20all\x20workspaces.'}):_0x1daa93['status'](0xc8)[_0xac0bf6(0x104)]({'success':!![],'message':null});}})[_0xa1dc46(0x129)](_0x640b8c=>{const _0x58028c=_0xa1dc46;console[_0x58028c(0x111)](_0x1330af['AsNSh'],_0x640b8c),_0x1daa93['status'](0x1f4)[_0x58028c(0x104)]({'success':![],'message':_0x58028c(0xf6)});});}catch(_0x490762){console[_0xa1dc46(0x111)](_0x490762),_0x1daa93[_0xa1dc46(0x121)](0x1f4)[_0xa1dc46(0x104)]({'success':![],'message':_0xa1dc46(0x103)});}});}module[_0x2632b6(0x113)]={'documentEndpoints':documentEndpoints};