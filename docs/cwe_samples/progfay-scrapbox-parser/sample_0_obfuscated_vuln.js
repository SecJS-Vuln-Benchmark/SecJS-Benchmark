const _0x2dc94c=_0x1503;(function(_0x464208,_0x492778){const _0x1edf9a=_0x1503,_0x3bf802=_0x464208();while(!![]){try{const _0x333188=-parseInt(_0x1edf9a(0x152))/0x1+-parseInt(_0x1edf9a(0x14e))/0x2+parseInt(_0x1edf9a(0x13b))/0x3+parseInt(_0x1edf9a(0x145))/0x4+-parseInt(_0x1edf9a(0x108))/0x5+-parseInt(_0x1edf9a(0x137))/0x6*(parseInt(_0x1edf9a(0x131))/0x7)+parseInt(_0x1edf9a(0x156))/0x8*(parseInt(_0x1edf9a(0x11a))/0x9);if(_0x333188===_0x492778)break;else _0x3bf802['push'](_0x3bf802['shift']());}catch(_0x5c46a1){_0x3bf802['push'](_0x3bf802['shift']());}}}(_0x4b42,0xbe752));import{TOTP,Secret}from'otpauth';import{randomString}from'../../cryptoUtils';function _0x1503(_0x20cbf8,_0x2fe3dc){const _0x4b425b=_0x4b42();return _0x1503=function(_0x150368,_0x5543bb){_0x150368=_0x150368-0xf3;let _0x41418f=_0x4b425b[_0x150368];return _0x41418f;},_0x1503(_0x20cbf8,_0x2fe3dc);}function _0x4b42(){const _0x31dfe6=['3110652SKOVYC','mTMwu','wGgQc','smsCallback','afterFind','wrlKP','totp','SMS','get','924878IqMAix','TTINz','substring','additional','871875zsGGzg','string','policy','mfa','88360yeCdJa','pESHn','yeWYb','default','aTrEi','nSULd','token','ZYosL','mfa.period\x20must\x20be\x20greater\x20than\x2010','master','amrCI','Invalid\x20MFA\x20token','validate','LUiCC','lUitG','mfa.options\x20must\x20be\x20an\x20array','TOTP','validateOptions','resolve','enabled','vfTXa','pending','hVNMT','test','cboKc','294110iXgjmM','mfa.options\x20must\x20include\x20SMS\x20or\x20TOTP','old','object','pdUmO','fromBase32','baXzC','expiry','qbiRG','GpXJR','VycWQ','KbIlJ','rCaNK','length','rohBu','algorithm','mBwgn','validateSetUp','1557vLqYHq','includes','mfa.digits\x20must\x20be\x20a\x20number','nYzDR','XNTQr','mfa.sendSMS\x20callback\x20must\x20be\x20defined\x20when\x20using\x20SMS\x20OTPs','setupMobileOTP','This\x20number\x20is\x20not\x20pending','AfUQm','authData','mobile','confirmSMSOTP','SHA1','digits','original','Invalid\x20MFA\x20data','set','YhUBh','ExvvC','YiwTG','EckPR','ouTPz','setupTOTP','18725RWXZyM','Invalid\x20MFA\x20token\x201','MFA\x20is\x20already\x20set\x20up\x20on\x20this\x20account','Invalid\x20MFA\x20token\x202','sms','gBBYl','1194MnIxLG','function','yaEBp','IVNBB','51381gaQtXN','AsrRl','ZWbck','period','mfa.period\x20must\x20be\x20a\x20number','DhscH','number','QsRco','HsFWC','sendSMS'];_0x4b42=function(){return _0x31dfe6;};return _0x4b42();}import _0x5e0e9a from'./AuthAdapter';class MFAAdapter extends _0x5e0e9a{[_0x2dc94c(0x100)](_0x1edf63){const _0x3ec4ca=_0x2dc94c,_0x55e2f2={'LUiCC':_0x3ec4ca(0xfa),'qbiRG':_0x3ec4ca(0xfe),'mBwgn':_0x3ec4ca(0x12f),'rCaNK':_0x3ec4ca(0x14c),'GKjCX':_0x3ec4ca(0xff),'GpXJR':function(_0x4da9a6,_0x3df413){return _0x4da9a6!==_0x3df413;},'AfUQm':'mfa.options\x20must\x20include\x20SMS\x20or\x20TOTP','wrlKP':_0x3ec4ca(0x11c),'IVNBB':'number','vfTXa':function(_0x471614,_0xe5c2ef){return _0x471614!==_0xe5c2ef;},'EckPR':_0x3ec4ca(0x13d),'pdUmO':_0x3ec4ca(0x13f),'amrCI':function(_0x5dba31,_0x508fdf){return _0x5dba31<_0x508fdf;},'YiwTG':function(_0x39f421,_0x30d99e){return _0x39f421>_0x30d99e;},'TTINz':function(_0x5d8cb0,_0x1e7ddb){return _0x5d8cb0<_0x1e7ddb;},'KbIlJ':_0x3ec4ca(0x12c),'VycWQ':_0x3ec4ca(0x126)},_0x213816=_0x1edf63['options'];if(!Array['isArray'](_0x213816)){if(_0x55e2f2[_0x3ec4ca(0x118)]===_0x55e2f2['mBwgn'])throw _0x3ec4ca(0xfe);else throw _0x55e2f2[_0x3ec4ca(0xfc)];}this[_0x3ec4ca(0x135)]=_0x213816['includes'](_0x55e2f2[_0x3ec4ca(0x114)]),this[_0x3ec4ca(0x14b)]=_0x213816[_0x3ec4ca(0x11b)](_0x55e2f2['GKjCX']);if(!this[_0x3ec4ca(0x135)]&&!this['totp']){if(_0x55e2f2[_0x3ec4ca(0x111)](_0x3ec4ca(0x116),'rohBu'))throw _0x55e2f2[_0x3ec4ca(0x110)];else throw _0x55e2f2[_0x3ec4ca(0x122)];}const _0x53bfe8=_0x1edf63[_0x3ec4ca(0x127)]||0x6,_0x4fbb6e=_0x1edf63[_0x3ec4ca(0x13e)]||0x1e;if(typeof _0x53bfe8!==_0x3ec4ca(0x141))throw _0x55e2f2[_0x3ec4ca(0x14a)];if(typeof _0x4fbb6e!==_0x55e2f2[_0x3ec4ca(0x13a)]){if(_0x55e2f2[_0x3ec4ca(0x103)](_0x55e2f2['EckPR'],_0x55e2f2[_0x3ec4ca(0x12e)]))throw _0x3ec4ca(0x11f);else throw _0x55e2f2[_0x3ec4ca(0x10c)];}if(_0x55e2f2[_0x3ec4ca(0xf9)](_0x53bfe8,0x4)||_0x55e2f2[_0x3ec4ca(0x12d)](_0x53bfe8,0xa))throw'mfa.digits\x20must\x20be\x20between\x204\x20and\x2010';if(_0x55e2f2[_0x3ec4ca(0x14f)](_0x4fbb6e,0xa)){if(_0x55e2f2[_0x3ec4ca(0x111)](_0x55e2f2['KbIlJ'],_0x55e2f2[_0x3ec4ca(0x113)]))throw _0x3ec4ca(0x109);else throw _0x3ec4ca(0xf7);}const _0x36a902=_0x1edf63[_0x3ec4ca(0x144)];if(this['sms']&&typeof _0x36a902!==_0x3ec4ca(0x138))throw _0x3ec4ca(0x11f);this[_0x3ec4ca(0x148)]=_0x36a902,this[_0x3ec4ca(0x127)]=_0x53bfe8,this[_0x3ec4ca(0x13e)]=_0x4fbb6e,this[_0x3ec4ca(0x117)]=_0x1edf63[_0x3ec4ca(0x117)]||_0x55e2f2[_0x3ec4ca(0x112)];}[_0x2dc94c(0x119)](_0xf5bd7b){const _0x573725=_0x2dc94c,_0x43896a={'ZYosL':'Invalid\x20MFA\x20data'};if(_0xf5bd7b[_0x573725(0x124)]&&this[_0x573725(0x135)])return this[_0x573725(0x120)](_0xf5bd7b[_0x573725(0x124)]);if(this[_0x573725(0x14b)])return this[_0x573725(0x130)](_0xf5bd7b);throw _0x43896a[_0x573725(0xf6)];}async['validateLogin'](_0x463862,_0x186710,_0xbfa8b8){const _0x13e897=_0x2dc94c,_0x496055={'XNTQr':_0x13e897(0x123),'fzqxQ':'request','gBBYl':function(_0x2758c9,_0x6f608c){return _0x2758c9!==_0x6f608c;},'baXzC':_0x13e897(0x132),'GQSoy':function(_0x138171,_0x357097){return _0x138171!==_0x357097;},'lUitG':_0x13e897(0x153),'yaEBp':function(_0x3d2526,_0x5f42e8){return _0x3d2526===_0x5f42e8;},'yWOrc':function(_0x1f7960,_0x15b765){return _0x1f7960===_0x15b765;},'YhUBh':'Invalid\x20MFA\x20token'},_0xb8494e={'doNotSave':!![]},_0x26e621=_0x463862['token'],_0x437785=_0xbfa8b8[_0x13e897(0x128)][_0x13e897(0x14d)](_0x496055[_0x13e897(0x11e)])||{},{secret:_0xd98cbf,recovery:_0x51b80c,mobile:_0xef18b9,token:_0x37da4d,expiry:_0x3d0b84}=_0x437785[_0x13e897(0x155)]||{};if(this[_0x13e897(0x135)]&&_0xef18b9){if(_0x26e621===_0x496055['fzqxQ']){const {token:_0x13ca3a,expiry:_0x161b97}=await this[_0x13e897(0x144)](_0xef18b9);_0x437785['mfa']['token']=_0x13ca3a,_0x437785[_0x13e897(0x155)][_0x13e897(0x10f)]=_0x161b97,_0xbfa8b8[_0x13e897(0x10b)][_0x13e897(0x12a)](_0x496055[_0x13e897(0x11e)],_0x437785),await _0xbfa8b8[_0x13e897(0x10b)]['save'](null,{'useMasterKey':!![]});throw'Please\x20enter\x20the\x20token';}if(!_0x37da4d||_0x496055['gBBYl'](_0x26e621,_0x37da4d)){if(_0x496055[_0x13e897(0x136)](_0x13e897(0x140),_0x13e897(0x143)))throw _0x496055[_0x13e897(0x10e)];else throw'mfa.period\x20must\x20be\x20a\x20number';}if(new Date()>_0x3d0b84)throw _0x13e897(0x134);return delete _0x437785[_0x13e897(0x155)][_0x13e897(0xf5)],delete _0x437785[_0x13e897(0x155)][_0x13e897(0x10f)],{'save':_0x437785[_0x13e897(0x155)]};}if(this[_0x13e897(0x14b)]){if(_0x496055['GQSoy'](typeof _0x26e621,_0x496055[_0x13e897(0xfd)]))throw _0x13e897(0xfa);if(!_0xd98cbf)return _0xb8494e;if(_0x496055[_0x13e897(0x139)](_0x51b80c[0x0],_0x26e621)||_0x496055['yaEBp'](_0x51b80c[0x1],_0x26e621))return _0xb8494e;const _0x2e309a=new TOTP({'algorithm':this[_0x13e897(0x117)],'digits':this['digits'],'period':this[_0x13e897(0x13e)],'secret':Secret[_0x13e897(0x10d)](_0xd98cbf)}),_0xfd26b0=_0x2e309a[_0x13e897(0xfb)]({'token':_0x26e621});if(_0x496055['yWOrc'](_0xfd26b0,null))throw _0x496055[_0x13e897(0x12b)];}return _0xb8494e;}async['validateUpdate'](_0x551226,_0x3ae530,_0x3df55b){const _0x420109=_0x2dc94c,_0x25ade5={'pESHn':_0x420109(0x123),'oAayh':_0x420109(0x129)};if(_0x3df55b[_0x420109(0xf8)])return;if(_0x551226[_0x420109(0x124)]&&this['sms']){if(!_0x551226[_0x420109(0xf5)])throw _0x420109(0x133);return this[_0x420109(0x125)](_0x551226,_0x3df55b[_0x420109(0x128)][_0x420109(0x14d)](_0x25ade5[_0x420109(0x157)])?.['mfa']||{});}if(this[_0x420109(0x14b)])return await this['validateLogin']({'token':_0x551226[_0x420109(0x10a)]},null,_0x3df55b),this[_0x420109(0x119)](_0x551226);throw _0x25ade5['oAayh'];}[_0x2dc94c(0x149)](_0x4c4271,_0x2114c3,_0x583401){const _0x31a1f5=_0x2dc94c,_0xd37c2e={'nSULd':'disabled'};if(_0x583401[_0x31a1f5(0xf8)])return;if(this[_0x31a1f5(0x14b)]&&_0x4c4271['secret'])return{'status':_0x31a1f5(0x102)};if(this[_0x31a1f5(0x135)]&&_0x4c4271[_0x31a1f5(0x124)])return{'status':_0x31a1f5(0x102)};return{'status':_0xd37c2e[_0x31a1f5(0xf4)]};}[_0x2dc94c(0x154)](_0x81c576,_0x592397){const _0x54bb67=_0x2dc94c,_0x55ed55={'hVNMT':function(_0x3930e4,_0x2aaa4e){return _0x3930e4===_0x2aaa4e;},'aTrEi':_0x54bb67(0x159)};if(this[_0x54bb67(0x135)]&&_0x592397?.[_0x54bb67(0x104)]&&_0x55ed55[_0x54bb67(0x105)](Object['keys'](_0x592397)[_0x54bb67(0x115)],0x1))return _0x55ed55[_0x54bb67(0xf3)];return _0x54bb67(0x151);}async[_0x2dc94c(0x120)](_0xea2223){const _0x209bd6=_0x2dc94c,{token:_0x338ad2,expiry:_0x1ca46f}=await this[_0x209bd6(0x144)](_0xea2223);return{'save':{'pending':{[_0xea2223]:{'token':_0x338ad2,'expiry':_0x1ca46f}}}};}async[_0x2dc94c(0x144)](_0x20ec5e){const _0x21df80=_0x2dc94c,_0x1d3da5={'cboKc':function(_0x4cc799,_0xe75b82){return _0x4cc799<_0xe75b82;},'nYzDR':function(_0x4f3004,_0x1465fa){return _0x4f3004(_0x1465fa);}};if(!/^[+]*[(]{0,1}[0-9]{1,3}[)]{0,1}[-\s\./0-9]*$/g[_0x21df80(0x106)](_0x20ec5e))throw'Invalid\x20mobile\x20number.';let _0x225b50='';while(_0x1d3da5[_0x21df80(0x107)](_0x225b50[_0x21df80(0x115)],this[_0x21df80(0x127)])){_0x225b50+=_0x1d3da5[_0x21df80(0x11d)](randomString,0xa)['replace'](/\D/g,'');}_0x225b50=_0x225b50[_0x21df80(0x150)](0x0,this[_0x21df80(0x127)]),await Promise[_0x21df80(0x101)](this[_0x21df80(0x148)](_0x225b50,_0x20ec5e));const _0x364721=new Date(new Date()['getTime']()+this[_0x21df80(0x13e)]*0x3e8);return{'token':_0x225b50,'expiry':_0x364721};}async['confirmSMSOTP'](_0x2758ad,_0x17964b){const _0x44a9d5=_0x2dc94c,_0x20ad50={'mTMwu':_0x44a9d5(0x121),'yeWYb':function(_0x91341d,_0x8fd28b){return _0x91341d!==_0x8fd28b;}},{mobile:_0xfa711c,token:_0x12c17e}=_0x2758ad;if(!_0x17964b[_0x44a9d5(0x104)]?.[_0xfa711c])throw _0x20ad50[_0x44a9d5(0x146)];const _0x3aef2c=_0x17964b[_0x44a9d5(0x104)][_0xfa711c];if(_0x20ad50[_0x44a9d5(0x158)](_0x12c17e,_0x3aef2c[_0x44a9d5(0xf5)]))throw _0x44a9d5(0xfa);if(new Date()>_0x3aef2c['expiry'])throw _0x44a9d5(0xfa);return delete _0x17964b['pending'][_0xfa711c],_0x17964b[_0x44a9d5(0x124)]=_0xfa711c,{'save':_0x17964b};}[_0x2dc94c(0x130)](_0x25fc17){const _0x3d5870=_0x2dc94c,_0x2dd7a4={'wGgQc':function(_0xe85cad,_0x3611c4){return _0xe85cad||_0x3611c4;},'RSEpJ':function(_0x526676,_0x1c78bb){return _0x526676<_0x1c78bb;},'QsRco':'Invalid\x20MFA\x20data','plUvn':function(_0x3a0434,_0x2dcc2a){return _0x3a0434===_0x2dcc2a;},'fxZkD':_0x3d5870(0xfa),'AsrRl':function(_0x29c6d0,_0x429ea7){return _0x29c6d0(_0x429ea7);}},{secret:_0x28ba86,token:_0x1a9121}=_0x25fc17;if(_0x2dd7a4[_0x3d5870(0x147)](!_0x28ba86,!_0x1a9121)||_0x2dd7a4['RSEpJ'](_0x28ba86[_0x3d5870(0x115)],0x14))throw _0x2dd7a4[_0x3d5870(0x142)];const _0x7614ff=new TOTP({'algorithm':this[_0x3d5870(0x117)],'digits':this['digits'],'period':this[_0x3d5870(0x13e)],'secret':Secret['fromBase32'](_0x28ba86)}),_0x4b3680=_0x7614ff['validate']({'token':_0x1a9121});if(_0x2dd7a4['plUvn'](_0x4b3680,null))throw _0x2dd7a4['fxZkD'];const _0x19bd54=[_0x2dd7a4[_0x3d5870(0x13c)](randomString,0x1e),_0x2dd7a4[_0x3d5870(0x13c)](randomString,0x1e)];return{'response':{'recovery':_0x19bd54['join'](',\x20')},'save':{'secret':_0x28ba86,'recovery':_0x19bd54}};}}export default new MFAAdapter();