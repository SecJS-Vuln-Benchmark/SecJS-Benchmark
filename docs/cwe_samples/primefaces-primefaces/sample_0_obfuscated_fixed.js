const _0x24bd22=_0x7372;(function(_0xbdd7e1,_0x53ea86){const _0x4fa509=_0x7372,_0x5e8bd5=_0xbdd7e1();while(!![]){try{const _0x14200d=parseInt(_0x4fa509(0x16a))/0x1+parseInt(_0x4fa509(0x118))/0x2+parseInt(_0x4fa509(0xd9))/0x3+parseInt(_0x4fa509(0x15b))/0x4*(parseInt(_0x4fa509(0xf6))/0x5)+parseInt(_0x4fa509(0x11e))/0x6*(parseInt(_0x4fa509(0x153))/0x7)+parseInt(_0x4fa509(0xf0))/0x8+-parseInt(_0x4fa509(0xd5))/0x9;if(_0x14200d===_0x53ea86)break;else _0x5e8bd5['push'](_0x5e8bd5['shift']());}catch(_0x2c931c){_0x5e8bd5['push'](_0x5e8bd5['shift']());}}}(_0x1bc0,0xa8af8));const Parse=require(_0x24bd22(0x103));import{isDeepStrictEqual}from'util';import{getRequestObject,resolveError}from'./triggers';import{logger}from'./logger';import{LRUCache as _0x9d8112}from'lru-cache';import _0x292075 from'./RestQuery';import _0x5712af from'./RestWrite';function Auth({config:_0x493076,cacheController:cacheController=undefined,isMaster:isMaster=![],isMaintenance:isMaintenance=![],isReadOnly:isReadOnly=![],user:_0x36f69e,installationId:_0x300bab}){const _0x101318=_0x24bd22;this[_0x101318(0xda)]=_0x493076,this['cacheController']=cacheController||_0x493076&&_0x493076[_0x101318(0x131)],this['installationId']=_0x300bab,this[_0x101318(0x165)]=isMaster,this[_0x101318(0x127)]=isMaintenance,this[_0x101318(0x15c)]=_0x36f69e,this['isReadOnly']=isReadOnly,this[_0x101318(0x160)]=[],this[_0x101318(0xf4)]=![],this['rolePromise']=null;}Auth[_0x24bd22(0x15a)][_0x24bd22(0xf1)]=function(){const _0x23fa68=_0x24bd22,_0x1424c9={'cGTue':function(_0x42cdc7,..._0x230767){return _0x42cdc7(..._0x230767);},'uMDsw':_0x23fa68(0x14d),'deewb':function(_0x2d259d,_0x38530f){return _0x2d259d===_0x38530f;},'AEktX':_0x23fa68(0x16e),'dOxmz':function(_0xbdf4f,_0x1e2036){return _0xbdf4f!==_0x1e2036;},'MysQI':_0x23fa68(0xf5)};if(this['isMaster'])return![];if(this[_0x23fa68(0x127)]){if(_0x1424c9['deewb'](_0x1424c9[_0x23fa68(0x126)],_0x23fa68(0x16d))){if(!this[_0x23fa68(0x131)])return![];return this[_0x23fa68(0x131)][_0x23fa68(0x152)]['put'](this['user']['id'],_0x1424c9[_0x23fa68(0x149)](_0x5013f4,...this[_0x23fa68(0x160)])),!![];}else return![];}if(this[_0x23fa68(0x15c)])return _0x1424c9[_0x23fa68(0x100)](_0x23fa68(0xf5),_0x1424c9[_0x23fa68(0xea)])?{'__type':_0x23fa68(0x136),'className':_0x1424c9['uMDsw'],'objectId':_0x9d873c}:![];return!![];};function master(_0x1a434c){return new Auth({'config':_0x1a434c,'isMaster':!![]});}function maintenance(_0x2752e6){return new Auth({'config':_0x2752e6,'isMaintenance':!![]});}function readOnly(_0x540d14){return new Auth({'config':_0x540d14,'isMaster':!![],'isReadOnly':!![]});}function nobody(_0x2fdf0f){return new Auth({'config':_0x2fdf0f,'isMaster':![]});}const throttle=new _0x9d8112({'max':0x2710,'ttl':0x1f4});function shouldUpdateSessionExpiry(_0x5674a4,_0x363978){const _0x5d748b=_0x24bd22,_0x463862={'jLEJE':function(_0x40a076,_0x507da6){return _0x40a076/_0x507da6;},'RedEO':function(_0x17f25f,_0x1ef9bb){return _0x17f25f-_0x1ef9bb;},'uNMJo':function(_0x4cdd12,_0x5d4440){return _0x4cdd12*_0x5d4440;},'mbGYp':function(_0x329af3,_0x104632){return _0x329af3<=_0x104632;}},_0x4e9348=_0x463862[_0x5d748b(0xd8)](_0x5674a4[_0x5d748b(0x105)],0x2),_0x17f1b0=new Date(_0x363978?.['updatedAt']),_0x2db672=new Date();return _0x2db672['setTime'](_0x463862['RedEO'](_0x2db672['getTime'](),_0x463862[_0x5d748b(0x12b)](_0x4e9348,0x3e8))),_0x463862[_0x5d748b(0x16b)](_0x17f1b0,_0x2db672);}const renewSessionIfNeeded=async({config:_0x549044,session:_0x536734,sessionToken:_0x19176d})=>{const _0x3ce66a=_0x24bd22,_0x27cf9b={'bPNvW':'yLOGO','JnMCH':function(_0x5a5144,_0x20c9e1){return _0x5a5144(_0x20c9e1);},'spoVC':function(_0x1912a6,_0x4596f5,_0x37b1a3){return _0x1912a6(_0x4596f5,_0x37b1a3);},'ACPyQ':_0x3ce66a(0x132)};if(!_0x549044?.[_0x3ce66a(0x138)])return;if(throttle[_0x3ce66a(0x109)](_0x19176d))return;throttle[_0x3ce66a(0x14c)](_0x19176d,!![]);try{if(_0x27cf9b[_0x3ce66a(0x14b)]===_0x27cf9b['bPNvW']){if(!_0x536734){const _0x942ebe=await _0x292075({'method':_0x292075['Method'][_0x3ce66a(0x109)],'config':_0x549044,'auth':_0x27cf9b['JnMCH'](master,_0x549044),'runBeforeFind':![],'className':_0x3ce66a(0x158),'restWhere':{'sessionToken':_0x19176d},'restOptions':{'limit':0x1}}),{results:_0x41ea3d}=await _0x942ebe['execute']();_0x536734=_0x41ea3d[0x0];}if(!_0x27cf9b[_0x3ce66a(0xfc)](shouldUpdateSessionExpiry,_0x549044,_0x536734)||!_0x536734)return;const _0x375fae=_0x549044['generateSessionExpiresAt']();await new _0x5712af(_0x549044,master(_0x549044),'_Session',{'objectId':_0x536734[_0x3ce66a(0x159)]},{'expiresAt':Parse[_0x3ce66a(0x11a)](_0x375fae)})[_0x3ce66a(0x111)]();}else _0x2ef60e[_0x3771aa]=_0x1d7c0b;}catch(_0x53a227){_0x53a227?.[_0x3ce66a(0x13e)]!==Parse['Error'][_0x3ce66a(0x15d)]&&logger[_0x3ce66a(0x112)](_0x27cf9b[_0x3ce66a(0x10a)],_0x53a227);}},getAuthForSessionToken=async function({config:_0x96c469,cacheController:_0x4d06ed,sessionToken:_0x5d11a8,installationId:_0x24fc1a}){const _0x214554=_0x24bd22,_0x4d7caa={'hPkRe':_0x214554(0x132),'swyHj':function(_0x560fe9,_0x342fc2){return _0x560fe9!==_0x342fc2;},'NatWu':_0x214554(0xd0),'zwCER':function(_0x471cf9,_0x37b765){return _0x471cf9(_0x37b765);},'rqQLh':_0x214554(0x15c),'fhpom':function(_0x4ed7e7,_0x27bfe9){return _0x4ed7e7(_0x27bfe9);},'DGChM':_0x214554(0x158),'lVScV':function(_0xc593cd,_0x528f85){return _0xc593cd===_0x528f85;},'QAIjc':_0x214554(0xe1),'yhaBt':function(_0x5619b1,_0x391d30){return _0x5619b1!==_0x391d30;},'ySbUM':_0x214554(0x175),'bzlku':_0x214554(0xfd),'FbOFb':'Session\x20token\x20is\x20expired.','QMpXQ':function(_0x495799,_0x398e44){return _0x495799===_0x398e44;},'tbmzb':_0x214554(0x159),'ySDDT':_0x214554(0x16f),'ZRgee':_0x214554(0x177),'zgYym':_0x214554(0x130)};_0x4d06ed=_0x4d06ed||_0x96c469&&_0x96c469[_0x214554(0x131)];if(_0x4d06ed){if(_0x4d7caa[_0x214554(0x143)](_0x214554(0x122),_0x4d7caa[_0x214554(0x146)])){const _0x256929=await _0x4d06ed[_0x214554(0x15c)]['get'](_0x5d11a8);if(_0x256929){const _0x1c1c9c=Parse[_0x214554(0x16c)][_0x214554(0x176)](_0x256929);return _0x4d7caa[_0x214554(0x128)](renewSessionIfNeeded,{'config':_0x96c469,'sessionToken':_0x5d11a8}),Promise[_0x214554(0x124)](new Auth({'config':_0x96c469,'cacheController':_0x4d06ed,'isMaster':![],'installationId':_0x24fc1a,'user':_0x1c1c9c}));}}else _0xf7ce4c[_0x214554(0x112)](_0x4d7caa['hPkRe'],_0x1196c4);}let _0x4bfb51;if(_0x96c469){const _0x15d140={'limit':0x1,'include':_0x4d7caa[_0x214554(0xfe)]},_0x1defa1=require('./RestQuery'),_0x1970e8=await _0x4d7caa[_0x214554(0x125)](_0x1defa1,{'method':_0x1defa1[_0x214554(0x139)]['get'],'config':_0x96c469,'runBeforeFind':![],'auth':_0x4d7caa[_0x214554(0x128)](master,_0x96c469),'className':_0x4d7caa['DGChM'],'restWhere':{'sessionToken':_0x5d11a8},'restOptions':_0x15d140});_0x4bfb51=(await _0x1970e8[_0x214554(0x111)]())[_0x214554(0xe0)];}else{if(_0x4d7caa[_0x214554(0x11c)](_0x4d7caa['QAIjc'],_0x4d7caa['QAIjc']))_0x4bfb51=(await new Parse['Query'](Parse[_0x214554(0xf7)])[_0x214554(0xf8)](0x1)[_0x214554(0x11d)](_0x214554(0x15c))['equalTo'](_0x214554(0xd6),_0x5d11a8)[_0x214554(0x134)]({'useMasterKey':!![]}))[_0x214554(0x174)](_0x2e53cc=>_0x2e53cc[_0x214554(0x150)]());else return new _0x5490e2({'config':_0x318e8e,'isMaster':!![]});}if(_0x4d7caa[_0x214554(0x143)](_0x4bfb51[_0x214554(0x13b)],0x1)||!_0x4bfb51[0x0]['user'])throw new Parse['Error'](Parse[_0x214554(0x167)][_0x214554(0x10d)],_0x214554(0xff));const _0xe0e5c3=_0x4bfb51[0x0],_0x578b8a=new Date(),_0x557f93=_0xe0e5c3[_0x214554(0xdc)]?new Date(_0xe0e5c3['expiresAt'][_0x214554(0x166)]):undefined;if(_0x557f93<_0x578b8a){if(_0x4d7caa[_0x214554(0xd1)](_0x4d7caa[_0x214554(0x116)],_0x4d7caa[_0x214554(0x114)]))throw new Parse[(_0x214554(0x167))](Parse[_0x214554(0x167)][_0x214554(0x10d)],_0x4d7caa[_0x214554(0x133)]);else return null;}const _0x246ee2=_0xe0e5c3[_0x214554(0x15c)];if(_0x4d7caa[_0x214554(0xf9)](typeof _0x246ee2[_0x214554(0x159)],_0x214554(0x141))&&_0x246ee2[_0x4d7caa[_0x214554(0x147)]][_0x214554(0x164)](_0x4d7caa[_0x214554(0x10c)]))throw new Parse[(_0x214554(0x167))](Parse[_0x214554(0x167)]['INTERNAL_SERVER_ERROR'],_0x4d7caa['ZRgee']);delete _0x246ee2[_0x214554(0x148)],_0x246ee2[_0x214554(0xef)]=_0x4d7caa[_0x214554(0xeb)],_0x246ee2['sessionToken']=_0x5d11a8;_0x4d06ed&&_0x4d06ed[_0x214554(0x15c)][_0x214554(0x11f)](_0x5d11a8,_0x246ee2);renewSessionIfNeeded({'config':_0x96c469,'session':_0xe0e5c3,'sessionToken':_0x5d11a8});const _0x65ab44=Parse[_0x214554(0x16c)][_0x214554(0x176)](_0x246ee2);return new Auth({'config':_0x96c469,'cacheController':_0x4d06ed,'isMaster':![],'installationId':_0x24fc1a,'user':_0x65ab44});};var getAuthForLegacySessionToken=async function({config:_0x4fd0b1,sessionToken:_0xd760e3,installationId:_0x5e98f9}){const _0x2e9505=_0x24bd22,_0x211471={'FdnVJ':'invalid\x20legacy\x20session\x20token','OWeRU':_0x2e9505(0x130),'HURKE':function(_0x3752ca,_0x74329a){return _0x3752ca(_0x74329a);}};var _0x43e139={'limit':0x1};const _0x5dfe6b=require(_0x2e9505(0x171));var _0x1c78b1=await _0x5dfe6b({'method':_0x5dfe6b[_0x2e9505(0x139)][_0x2e9505(0x109)],'config':_0x4fd0b1,'runBeforeFind':![],'auth':_0x211471[_0x2e9505(0xd7)](master,_0x4fd0b1),'className':_0x211471[_0x2e9505(0xc9)],'restWhere':{'_session_token':_0xd760e3},'restOptions':_0x43e139});return _0x1c78b1['execute']()[_0x2e9505(0xfa)](_0xcc7e0e=>{const _0x17fd54=_0x2e9505;var _0x8245ba=_0xcc7e0e['results'];if(_0x8245ba[_0x17fd54(0x13b)]!==0x1)throw new Parse[(_0x17fd54(0x167))](Parse['Error'][_0x17fd54(0x10d)],_0x211471[_0x17fd54(0x12a)]);const _0x1ce08b=_0x8245ba[0x0];_0x1ce08b[_0x17fd54(0xef)]=_0x211471[_0x17fd54(0xc9)];const _0x4185de=Parse[_0x17fd54(0x16c)][_0x17fd54(0x176)](_0x1ce08b);return new Auth({'config':_0x4fd0b1,'isMaster':![],'installationId':_0x5e98f9,'user':_0x4185de});});};Auth[_0x24bd22(0x15a)]['getUserRoles']=function(){const _0x227f54=_0x24bd22,_0x160a00={'aWfnh':_0x227f54(0x117),'sRpyx':function(_0x2e1bbd,_0x3fb2f7){return _0x2e1bbd===_0x3fb2f7;}};if(this[_0x227f54(0x165)]||this['isMaintenance']||!this['user'])return Promise[_0x227f54(0x124)]([]);if(this[_0x227f54(0xf4)])return _0x227f54(0x156)===_0x160a00['aWfnh']?_0xf20a91[_0x227f54(0x124)](this[_0x227f54(0x160)]):Promise['resolve'](this[_0x227f54(0x160)]);if(this['rolePromise']){if(_0x160a00[_0x227f54(0x119)](_0x227f54(0xca),_0x227f54(0xca)))return this[_0x227f54(0x12e)];else{const _0x132117=new _0x5f1b29['Object'](_0x198c8e[_0x227f54(0x121)]);return _0x132117['id']=_0x3b4cd1,_0x132117;}}return this['rolePromise']=this[_0x227f54(0x120)](),this[_0x227f54(0x12e)];},Auth[_0x24bd22(0x15a)][_0x24bd22(0xe2)]=async function(){const _0x35b7fe=_0x24bd22,_0x16206c={'tlBEq':_0x35b7fe(0x130),'HvVaP':function(_0x33ae9e,_0x8eab86){return _0x33ae9e(_0x8eab86);},'myAvz':function(_0xe7f870,_0x14ac99){return _0xe7f870(_0x14ac99);},'GQCrh':_0x35b7fe(0xe9)},_0xfa477f=[];if(this['config']){const _0x453329={'users':{'__type':_0x35b7fe(0x136),'className':_0x16206c['tlBEq'],'objectId':this[_0x35b7fe(0x15c)]['id']}},_0x4d7e2f=require(_0x35b7fe(0x171)),_0x346cc3=await _0x16206c['HvVaP'](_0x4d7e2f,{'method':_0x4d7e2f[_0x35b7fe(0x139)][_0x35b7fe(0x134)],'runBeforeFind':![],'config':this[_0x35b7fe(0xda)],'auth':_0x16206c['myAvz'](master,this['config']),'className':_0x35b7fe(0x14d),'restWhere':_0x453329});await _0x346cc3[_0x35b7fe(0x15f)](_0x57b71b=>_0xfa477f[_0x35b7fe(0x108)](_0x57b71b));}else await new Parse[(_0x35b7fe(0x173))](Parse[_0x35b7fe(0x121)])[_0x35b7fe(0xf2)](_0x16206c[_0x35b7fe(0xcd)],this[_0x35b7fe(0x15c)])[_0x35b7fe(0x15f)](_0x3c6004=>_0xfa477f[_0x35b7fe(0x108)](_0x3c6004['toJSON']()),{'useMasterKey':!![]});return _0xfa477f;},Auth[_0x24bd22(0x15a)][_0x24bd22(0x120)]=async function(){const _0x3da827=_0x24bd22,_0xc54d92={'OnCRC':function(_0x510fed,_0x479c6e){return _0x510fed+_0x479c6e;},'EiHkA':'role:','GZQNd':function(_0x43dd5a,_0x32cc0b){return _0x43dd5a===_0x32cc0b;},'qQvIQ':_0x3da827(0xdd)};if(this[_0x3da827(0x131)]){const _0x17c815=await this['cacheController']['role'][_0x3da827(0x109)](this[_0x3da827(0x15c)]['id']);if(_0x17c815!=null)return _0xc54d92[_0x3da827(0x102)](_0xc54d92['qQvIQ'],_0x3da827(0xdd))?(this[_0x3da827(0xf4)]=!![],this[_0x3da827(0x160)]=_0x17c815,_0x17c815):![];}const _0x2eb522=await this[_0x3da827(0xe2)]();if(!_0x2eb522['length'])return this[_0x3da827(0x160)]=[],this[_0x3da827(0xf4)]=!![],this[_0x3da827(0x12e)]=null,this[_0x3da827(0x12c)](),this[_0x3da827(0x160)];const _0xc4b4b7=_0x2eb522['reduce']((_0x1cb47f,_0x4015c7)=>{const _0x431e7e=_0x3da827;return _0x1cb47f[_0x431e7e(0x107)][_0x431e7e(0x108)](_0x4015c7[_0x431e7e(0x163)]),_0x1cb47f[_0x431e7e(0x113)][_0x431e7e(0x108)](_0x4015c7['objectId']),_0x1cb47f;},{'ids':[],'names':[]}),_0xfd92e5=await this[_0x3da827(0xdb)](_0xc4b4b7[_0x3da827(0x113)],_0xc4b4b7['names']);return this['userRoles']=_0xfd92e5[_0x3da827(0x174)](_0x4b0faf=>{const _0x39623e=_0x3da827;return _0xc54d92['OnCRC'](_0xc54d92[_0x39623e(0x104)],_0x4b0faf);}),this[_0x3da827(0xf4)]=!![],this[_0x3da827(0x12e)]=null,this[_0x3da827(0x12c)](),this[_0x3da827(0x160)];},Auth[_0x24bd22(0x15a)][_0x24bd22(0x12c)]=function(){const _0x1108ae=_0x24bd22;if(!this[_0x1108ae(0x131)])return![];return this[_0x1108ae(0x131)][_0x1108ae(0x152)]['put'](this[_0x1108ae(0x15c)]['id'],Array(...this[_0x1108ae(0x160)])),!![];},Auth[_0x24bd22(0x15a)]['clearRoleCache']=function(_0xb159c3){const _0x3f8ef4=_0x24bd22;if(!this[_0x3f8ef4(0x131)])return![];return this[_0x3f8ef4(0x131)][_0x3f8ef4(0x152)][_0x3f8ef4(0x14f)](this[_0x3f8ef4(0x15c)]['id']),this[_0x3f8ef4(0x131)][_0x3f8ef4(0x15c)][_0x3f8ef4(0x14f)](_0xb159c3),!![];},Auth[_0x24bd22(0x15a)][_0x24bd22(0x172)]=async function(_0x280b32){const _0x21c2ae=_0x24bd22,_0x7bb30c={'URPQJ':'_Role','YvHSS':function(_0x37b430,_0x312c57){return _0x37b430(_0x312c57);},'BlETI':function(_0x357889,_0x235417){return _0x357889(_0x235417);}},_0x2fc7fe=[];if(!this[_0x21c2ae(0xda)])await new Parse['Query'](Parse['Role'])[_0x21c2ae(0xd2)](_0x21c2ae(0x142),_0x280b32[_0x21c2ae(0x174)](_0x4613d4=>{const _0x597f1c=_0x21c2ae,_0x2034a2=new Parse[(_0x597f1c(0x16c))](Parse[_0x597f1c(0x121)]);return _0x2034a2['id']=_0x4613d4,_0x2034a2;}))[_0x21c2ae(0x15f)](_0x301e92=>_0x2fc7fe[_0x21c2ae(0x108)](_0x301e92[_0x21c2ae(0x150)]()),{'useMasterKey':!![]});else{const _0x1dd7e2=_0x280b32[_0x21c2ae(0x174)](_0x521cc3=>{const _0x6503e7=_0x21c2ae;return{'__type':_0x6503e7(0x136),'className':_0x7bb30c[_0x6503e7(0x154)],'objectId':_0x521cc3};}),_0x210482={'roles':{'$in':_0x1dd7e2}},_0x21e31a=_0x7bb30c[_0x21c2ae(0xee)](require,_0x21c2ae(0x171)),_0xab3a9f=await _0x7bb30c['BlETI'](_0x21e31a,{'method':_0x21e31a[_0x21c2ae(0x139)][_0x21c2ae(0x134)],'config':this[_0x21c2ae(0xda)],'runBeforeFind':![],'auth':master(this['config']),'className':_0x21c2ae(0x14d),'restWhere':_0x210482});await _0xab3a9f['each'](_0x3994cf=>_0x2fc7fe[_0x21c2ae(0x108)](_0x3994cf));}return _0x2fc7fe;},Auth['prototype'][_0x24bd22(0xdb)]=function(_0x445a19,_0x5f2975=[],_0x25e97e={}){const _0x16e2c2=_0x24bd22,_0x4e2786={'rdNWd':function(_0x10bbe9,_0x1a7368){return _0x10bbe9!==_0x1a7368;},'yXKAs':function(_0xb07942,_0xdde124){return _0xb07942==_0xdde124;}},_0x52a871=_0x445a19['filter'](_0xc080c7=>{const _0x28da66=_0x4e2786['rdNWd'](_0x25e97e[_0xc080c7],!![]);return _0x25e97e[_0xc080c7]=!![],_0x28da66;});if(_0x4e2786['yXKAs'](_0x52a871[_0x16e2c2(0x13b)],0x0))return Promise['resolve']([...new Set(_0x5f2975)]);return this['getRolesByIds'](_0x52a871)['then'](_0x1627bc=>{const _0x60da0b=_0x16e2c2;if(!_0x1627bc[_0x60da0b(0x13b)])return Promise[_0x60da0b(0x124)](_0x5f2975);const _0x35b2e2=_0x1627bc[_0x60da0b(0x106)]((_0x4c07b2,_0x3ec7ba)=>{const _0x1cd117=_0x60da0b;return _0x4c07b2[_0x1cd117(0x107)][_0x1cd117(0x108)](_0x3ec7ba['name']),_0x4c07b2[_0x1cd117(0x113)]['push'](_0x3ec7ba[_0x1cd117(0x159)]),_0x4c07b2;},{'ids':[],'names':[]});return _0x5f2975=_0x5f2975[_0x60da0b(0x123)](_0x35b2e2[_0x60da0b(0x107)]),this[_0x60da0b(0xdb)](_0x35b2e2['ids'],_0x5f2975,_0x25e97e);})[_0x16e2c2(0xfa)](_0xb41146=>{return Promise['resolve']([...new Set(_0xb41146)]);});};function _0x7372(_0x13cafe,_0x4c7581){const _0x1bc01b=_0x1bc0();return _0x7372=function(_0x737226,_0x3daa46){_0x737226=_0x737226-0xc9;let _0x32d636=_0x1bc01b[_0x737226];return _0x32d636;},_0x7372(_0x13cafe,_0x4c7581);}function _0x1bc0(){const _0x29e251=['mONSM','execute','error','ids','bzlku','SCRIPT_FAILED','ySbUM','hcHTx','1691712zyigvh','sRpyx','_encode','fetch','lVScV','include','165762CpYZCf','put','_loadRoles','Role','VOOpc','concat','resolve','fhpom','AEktX','isMaintenance','zwCER','authData','FdnVJ','uNMJo','cacheRoles','hhsWj','rolePromise','HjRCE','_User','cacheController','Could\x20not\x20update\x20session\x20expiry:\x20','FbOFb','find','additional','Pointer','adapter','extendSessionOnUse','Method','cLIjO','length','gGgdO','call','code','User','FLwLv','string','roles','swyHj','kybYz','filter','NatWu','tbmzb','password','cGTue','PRlZQ','bPNvW','set','_Role','auth','del','toJSON','YvMkw','role','343zXcdZP','URPQJ','VTQEb','zvwcI','Vvbxd','_Session','objectId','prototype','8psoKVQ','user','OBJECT_NOT_FOUND','kZKjz','each','userRoles','oAdec','\x20for\x20user\x20','name','startsWith','isMaster','iso','Error','anonymous','policy','33122RFFybI','mbGYp','Object','DuvkW','HVWSo','role:','doNotSave','./RestQuery','getRolesByIds','Query','map','Cqtfb','fromJSON','Invalid\x20object\x20ID.','OWeRU','jWzlk','exports','UGJqi','GQCrh','tJepP','yXiio','xOIET','yhaBt','containedIn','This\x20authentication\x20method\x20is\x20unsupported.','getUserId','36999396YDdhMK','sessionToken','HURKE','jLEJE','3246231xlDRFD','config','_getAllRolesNamesForRoleIds','expiresAt','FTFZK','authDataManager','data','results','bDzIg','getRolesForUser','validator','authDataResponse','some','function','Ovikn','OTHER_CAUSE','users','MysQI','zgYym','buildParseObjects','all','YvHSS','className','8428144MJWAfw','isUnauthenticated','equalTo','sort','fetchedRoles','VUiNR','1084210tmPfAX','Session','limit','QMpXQ','then','response','spoVC','YVzTe','rqQLh','Invalid\x20session\x20token','dOxmz','OpMoF','GZQNd','parse/node','EiHkA','sessionLength','reduce','names','push','get','ACPyQ','keys','ySDDT','INVALID_SESSION_TOKEN','.id','getValidatorForProvider'];_0x1bc0=function(){return _0x29e251;};return _0x1bc0();}const findUsersWithAuthData=async(_0x4f99f7,_0x238866,_0x4ca528)=>{const _0xa87d9d=_0x24bd22,_0x29217e={'qOktb':_0xa87d9d(0xe6),'kZKjz':'_User'},_0x32c7a9=Object[_0xa87d9d(0x10b)](_0x238866),_0x4a38dc=await Promise[_0xa87d9d(0xed)](_0x32c7a9[_0xa87d9d(0x174)](async _0x327478=>{const _0x374d8f=_0xa87d9d,_0x320cb2=_0x238866[_0x327478],_0xeceb5e=_0x4f99f7[_0x374d8f(0xde)][_0x374d8f(0x10f)](_0x327478)?.[_0x374d8f(0x137)];_0x4ca528&&typeof _0xeceb5e?.['beforeFind']===_0x29217e['qOktb']&&await _0xeceb5e['beforeFind'](_0x320cb2);if(!_0x320cb2?.['id'])return null;return{['authData.'+_0x327478+_0x374d8f(0x10e)]:_0x320cb2['id']};})),_0x4c1ac0=_0x4a38dc[_0xa87d9d(0x145)](_0x968ee8=>_0x968ee8!==null);if(!_0x4c1ac0['length'])return[];return _0x4f99f7['database'][_0xa87d9d(0x134)](_0x29217e[_0xa87d9d(0x15e)],{'$or':_0x4c1ac0},{'limit':0x2});},hasMutatedAuthData=(_0x35dec3,_0x3445ea)=>{const _0x3dcf49=_0x24bd22,_0xfa49b5={'gGgdO':function(_0x333202,_0x3a2f0f){return _0x333202+_0x3a2f0f;},'VfdkA':_0x3dcf49(0x16f),'mONSM':_0x3dcf49(0xcc),'hhsWj':function(_0x263edd,_0x324e39){return _0x263edd!==_0x324e39;}};if(!_0x3445ea)return{'hasMutatedAuthData':!![],'mutatedAuthData':_0x35dec3};const _0x483b29={};Object[_0x3dcf49(0x10b)](_0x35dec3)['forEach'](_0x36af98=>{const _0x110573=_0x3dcf49,_0xdc3a51={'kybYz':function(_0x10c8ff,_0x23ddba){const _0x40e4f3=_0x7372;return _0xfa49b5[_0x40e4f3(0x13c)](_0x10c8ff,_0x23ddba);},'FLwLv':_0xfa49b5['VfdkA']};if(_0xfa49b5[_0x110573(0x110)]!==_0x110573(0xcc))return;else{if(_0x36af98===_0x110573(0x168)){if(_0xfa49b5[_0x110573(0x12d)](_0x110573(0x155),_0x110573(0x12f)))return;else return _0xdc3a51[_0x110573(0x144)](_0xdc3a51[_0x110573(0x140)],_0x27a242);}const _0x5810ca=_0x35dec3[_0x36af98],_0xa0cd92=_0x3445ea[_0x36af98];!isDeepStrictEqual(_0x5810ca,_0xa0cd92)&&(_0x483b29[_0x36af98]=_0x5810ca);}});const _0x264b76=_0xfa49b5['hhsWj'](Object[_0x3dcf49(0x10b)](_0x483b29)[_0x3dcf49(0x13b)],0x0);return{'hasMutatedAuthData':_0x264b76,'mutatedAuthData':_0x483b29};},checkIfUserHasProvidedConfiguredProvidersForLogin=(_0x14a577={},_0x1a6fe1={},_0x28f872={},_0x1deaf7)=>{const _0x5a9df7=_0x24bd22,_0x222b74={'YvMkw':_0x5a9df7(0xe6),'Vvbxd':function(_0x4194ec,_0x49b42e){return _0x4194ec===_0x49b42e;},'cLIjO':_0x5a9df7(0xe7)},_0x8f7d4=Object['keys'](_0x28f872)[_0x5a9df7(0x174)](_0x2f2432=>({'name':_0x2f2432,'adapter':_0x1deaf7[_0x5a9df7(0xde)][_0x5a9df7(0x10f)](_0x2f2432)[_0x5a9df7(0x137)]})),_0x1ba917=_0x8f7d4['some'](_0x42bc69=>_0x42bc69&&_0x42bc69[_0x5a9df7(0x137)]&&_0x42bc69[_0x5a9df7(0x137)][_0x5a9df7(0x169)]==='solo'&&_0x1a6fe1[_0x42bc69['name']]);if(_0x1ba917)return;const _0x432b35=[],_0x142d90=_0x8f7d4[_0x5a9df7(0xe5)](_0x2adb60=>{const _0x114bca=_0x5a9df7;let _0x1cfe59=_0x2adb60['adapter'][_0x114bca(0x169)];if(typeof _0x1cfe59===_0x222b74[_0x114bca(0x151)]){const _0x30bf7b={'ip':_0x14a577[_0x114bca(0xda)]['ip'],'user':_0x14a577[_0x114bca(0x14e)][_0x114bca(0x15c)],'master':_0x14a577[_0x114bca(0x14e)][_0x114bca(0x165)]};_0x1cfe59=_0x1cfe59[_0x114bca(0x13d)](_0x2adb60[_0x114bca(0x137)],_0x30bf7b,_0x28f872[_0x2adb60[_0x114bca(0x163)]]);}if(_0x222b74[_0x114bca(0x157)](_0x1cfe59,_0x114bca(0x135))){if(_0x1a6fe1[_0x2adb60[_0x114bca(0x163)]])return _0x222b74[_0x114bca(0x13a)]===_0x114bca(0x161)?new _0x5d2b8a({'config':_0xe882a1,'isMaintenance':!![]}):!![];else _0x432b35[_0x114bca(0x108)](_0x2adb60[_0x114bca(0x163)]);}});if(_0x142d90||!_0x432b35[_0x5a9df7(0x13b)])return;throw new Parse[(_0x5a9df7(0x167))](Parse['Error'][_0x5a9df7(0xe8)],'Missing\x20additional\x20authData\x20'+_0x432b35['join'](','));},handleAuthDataValidation=async(_0x4f26a,_0x5e3045,_0x3a1fad)=>{const _0x461739=_0x24bd22,_0x5e8d01={'OpMoF':function(_0x3f876e,_0x9de4ea){return _0x3f876e===_0x9de4ea;},'EBFug':_0x461739(0x130),'WiZLD':_0x461739(0xe6),'PRlZQ':_0x461739(0xcf),'VDhcx':_0x461739(0xce)};let _0x42ad4e;if(_0x3a1fad)_0x42ad4e=Parse[_0x461739(0x13f)][_0x461739(0x176)]({'className':_0x5e8d01['EBFug'],..._0x3a1fad});else{if(_0x5e3045['auth']&&_0x5e3045['auth'][_0x461739(0x15c)]&&_0x5e8d01[_0x461739(0x101)](typeof _0x5e3045[_0x461739(0xd4)],_0x461739(0xe6))&&_0x5e3045['getUserId']()===_0x5e3045[_0x461739(0x14e)]['user']['id']||_0x5e3045['auth']&&_0x5e3045[_0x461739(0x14e)][_0x461739(0x165)]&&typeof _0x5e3045['getUserId']===_0x5e8d01['WiZLD']&&_0x5e3045[_0x461739(0xd4)]()){if(_0x5e8d01[_0x461739(0x14a)]!==_0x461739(0xcf)){if(_0x5e8d01[_0x461739(0x101)](_0x33e49f,_0x461739(0x168)))return;const _0x3d84ae=_0x41e08a[_0x45c090],_0x5252c7=_0x2e9223[_0x37565d];!_0x2d0795(_0x3d84ae,_0x5252c7)&&(_0x5f5468[_0x18f8c4]=_0x3d84ae);}else _0x42ad4e=new Parse[(_0x461739(0x13f))](),_0x42ad4e['id']=_0x5e3045[_0x461739(0x14e)]['isMaster']?_0x5e3045[_0x461739(0xd4)]():_0x5e3045['auth']['user']['id'],await _0x42ad4e[_0x461739(0x11b)]({'useMasterKey':!![]});}}const {updatedObject:_0x25c951}=_0x5e3045[_0x461739(0xec)](),_0x3bce22=getRequestObject(undefined,_0x5e3045[_0x461739(0x14e)],_0x25c951,_0x42ad4e,_0x5e3045[_0x461739(0xda)]),_0x5d48c2={'authData':{},'authDataResponse':{}},_0x4295f4=Object[_0x461739(0x10b)](_0x4f26a)[_0x461739(0xf3)]();for(const _0x436d84 of _0x4295f4){let _0x227085='';try{if(_0x4f26a[_0x436d84]===null){_0x5d48c2[_0x461739(0x129)][_0x436d84]=null;continue;}const {validator:_0x192fba}=_0x5e3045['config']['authDataManager']['getValidatorForProvider'](_0x436d84)||{},_0x1897e6=(_0x5e3045[_0x461739(0xda)]['auth']||{})[_0x436d84]||{};if(!_0x192fba||_0x1897e6['enabled']===![])throw new Parse['Error'](Parse[_0x461739(0x167)]['UNSUPPORTED_SERVICE'],_0x461739(0xd3));let _0x14408a=await _0x192fba(_0x4f26a[_0x436d84],_0x5e3045,_0x42ad4e,_0x3bce22);_0x227085=_0x14408a&&_0x14408a['method'],_0x3bce22['triggerName']=_0x227085;if(_0x14408a&&_0x14408a['validator']){if(_0x5e8d01['VDhcx']===_0x5e8d01['VDhcx'])_0x14408a=await _0x14408a[_0x461739(0xe3)]();else return _0x3cc7a6[_0x461739(0x107)][_0x461739(0x108)](_0x3e7797['name']),_0x1c0ca1['ids'][_0x461739(0x108)](_0x5330fa[_0x461739(0x159)]),_0x1dc53d;}if(!_0x14408a){_0x5d48c2[_0x461739(0x129)][_0x436d84]=_0x4f26a[_0x436d84];continue;}if(!Object[_0x461739(0x10b)](_0x14408a)[_0x461739(0x13b)]){_0x5d48c2[_0x461739(0x129)][_0x436d84]=_0x4f26a[_0x436d84];continue;}_0x14408a[_0x461739(0xfb)]&&(_0x5d48c2[_0x461739(0xe4)][_0x436d84]=_0x14408a[_0x461739(0xfb)]),!_0x14408a[_0x461739(0x170)]&&(_0x5d48c2['authData'][_0x436d84]=_0x14408a['save']||_0x4f26a[_0x436d84]);}catch(_0x43c465){const _0x287cda=resolveError(_0x43c465,{'code':Parse[_0x461739(0x167)][_0x461739(0x115)],'message':'Auth\x20failed.\x20Unknown\x20error.'}),_0x4347d0=_0x5e3045[_0x461739(0x14e)]&&_0x5e3045[_0x461739(0x14e)][_0x461739(0x15c)]?_0x5e3045[_0x461739(0x14e)][_0x461739(0x15c)]['id']:_0x5e3045[_0x461739(0xdf)][_0x461739(0x159)]||undefined;logger[_0x461739(0x112)]('Failed\x20running\x20auth\x20step\x20'+_0x227085+'\x20for\x20'+_0x436d84+_0x461739(0x162)+_0x4347d0+'\x20with\x20Error:\x20'+JSON['stringify'](_0x287cda),{'authenticationStep':_0x227085,'error':_0x287cda,'user':_0x4347d0,'provider':_0x436d84});throw _0x287cda;}}return _0x5d48c2;};module[_0x24bd22(0xcb)]={'Auth':Auth,'master':master,'maintenance':maintenance,'nobody':nobody,'readOnly':readOnly,'shouldUpdateSessionExpiry':shouldUpdateSessionExpiry,'getAuthForSessionToken':getAuthForSessionToken,'getAuthForLegacySessionToken':getAuthForLegacySessionToken,'findUsersWithAuthData':findUsersWithAuthData,'hasMutatedAuthData':hasMutatedAuthData,'checkIfUserHasProvidedConfiguredProvidersForLogin':checkIfUserHasProvidedConfiguredProvidersForLogin,'handleAuthDataValidation':handleAuthDataValidation};