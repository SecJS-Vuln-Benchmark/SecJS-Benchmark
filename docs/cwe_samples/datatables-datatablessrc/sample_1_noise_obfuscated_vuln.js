const _0x44896f=_0x1d0d;(function(_0x184caf,_0x54d8f5){const _0x1443d2=_0x1d0d,_0x262b1a=_0x184caf();while(!![]){try{const _0x3d7a5d=parseInt(_0x1443d2(0xe6))/0x1*(-parseInt(_0x1443d2(0x12a))/0x2)+parseInt(_0x1443d2(0x135))/0x3*(parseInt(_0x1443d2(0x152))/0x4)+parseInt(_0x1443d2(0x15c))/0x5*(parseInt(_0x1443d2(0xa5))/0x6)+parseInt(_0x1443d2(0x134))/0x7*(-parseInt(_0x1443d2(0x18e))/0x8)+parseInt(_0x1443d2(0x8f))/0x9*(-parseInt(_0x1443d2(0x1a3))/0xa)+parseInt(_0x1443d2(0x180))/0xb+parseInt(_0x1443d2(0x139))/0xc*(parseInt(_0x1443d2(0xe4))/0xd);if(_0x3d7a5d===_0x54d8f5)break;else _0x262b1a['push'](_0x262b1a['shift']());}catch(_0x22fe2c){_0x262b1a['push'](_0x262b1a['shift']());}}}(_0x45dd,0x9fbe1),require(_0x44896f(0xc5))['config']());const User=require(_0x44896f(0x14a)),Org=require(_0x44896f(0xf6)),logger=require(_0x44896f(0x175)),argon2=require(_0x44896f(0xda)),CONSTANTS=require('../../constants'),cryptoRandomString=require(_0x44896f(0x183)),uuid=require(_0x44896f(0x122)),errors=require(_0x44896f(0x111)),error=new errors['OrgControllerError'](),uuidAPIKey=require(_0x44896f(0x9d));async function getOrgs(_0x803266,_0x49b003,_0x2b0483){const _0x10408c=_0x44896f,_0x5b8291={'kVyAl':_0x10408c(0x142),'luWbu':_0x10408c(0x199),'TtIkZ':_0x10408c(0x14b),'sBncO':function(_0x4d51d7,_0x5bc7d7){return _0x4d51d7(_0x5bc7d7);}};try{const _0x209cab=CONSTANTS[_0x10408c(0x113)];_0x209cab[_0x10408c(0x179)]={'short_name':_0x5b8291['kVyAl']},_0x209cab['page']=_0x803266[_0x10408c(0x19a)][_0x10408c(0xcb)][_0x10408c(0x120)]?parseInt(_0x803266[_0x10408c(0x19a)][_0x10408c(0xcb)]['page']):CONSTANTS[_0x10408c(0x104)];const _0xb9f692=_0x803266[_0x10408c(0x19a)][_0x10408c(0x82)]['getOrgRepository'](),_0x1c7796=setAggregateOrgObj({}),_0x538a21=await _0xb9f692[_0x10408c(0xc9)](_0x1c7796,_0x209cab),_0x20856a={'organizations':_0x538a21[_0x10408c(0xfd)]};if(_0x538a21[_0x10408c(0xb9)]>=CONSTANTS[_0x10408c(0x113)]['limit']){const _0x41835f=_0x5b8291[_0x10408c(0x145)][_0x10408c(0x174)]('|');let _0x40de21=0x0;while(!![]){switch(_0x41835f[_0x40de21++]){case'0':_0x20856a[_0x10408c(0x103)]=_0x538a21[_0x10408c(0x103)];continue;case'1':_0x20856a[_0x10408c(0x12c)]=_0x538a21[_0x10408c(0x12c)];continue;case'2':_0x20856a['itemsPerPage']=_0x538a21['itemsPerPage'];continue;case'3':_0x20856a[_0x10408c(0xef)]=_0x538a21[_0x10408c(0xef)];continue;case'4':_0x20856a['totalCount']=_0x538a21[_0x10408c(0xb9)];continue;case'5':_0x20856a['pageCount']=_0x538a21[_0x10408c(0xa3)];continue;}break;}}return logger[_0x10408c(0x13a)]({'uuid':_0x803266['ctx'][_0x10408c(0x122)],'message':_0x5b8291[_0x10408c(0x94)]}),eval('const _0x378123 = _0x10408c;JSON[_0x378123(249)]({ \'safe\': !![] });'),_0x49b003[_0x10408c(0xb7)](0xc8)[_0x10408c(0x83)](_0x20856a);}catch(_0x180248){_0x5b8291['sBncO'](_0x2b0483,_0x180248);}}async function getOrg(_0x32223c,_0x2cf473,_0x59d803){const _0x2e315e=_0x44896f,_0xfbb94={'faujN':function(_0x2e7f7c,_0x32c423){return _0x2e7f7c+_0x32c423;},'gIBuA':'\x20organization\x20does\x20not\x20exist.','dmvyb':function(_0x251a09,_0x50c52d){return _0x251a09(_0x50c52d);},'GbQJa':function(_0x21d209,_0x7c43eb){return _0x21d209===_0x7c43eb;},'KwIIl':function(_0x405d17,_0x382e5f){return _0x405d17(_0x382e5f);},'pOVvC':function(_0x4f7e9e,_0x3193df){return _0x4f7e9e!==_0x3193df;},'MjPZO':function(_0x16341a,_0x541e38,_0x150366){return _0x16341a(_0x541e38,_0x150366);},'FADJc':function(_0x56809f,_0x502e81){return _0x56809f>_0x502e81;},'feMWv':'return\x20new\x20Date();'};try{const _0x51551c=_0x32223c[_0x2e315e(0x19a)][_0x2e315e(0x7f)],_0x23da2b=_0x32223c[_0x2e315e(0x19a)][_0x2e315e(0x9e)][_0x2e315e(0x13f)],_0x20eea1=_0x32223c[_0x2e315e(0x19a)]['repositories']['getOrgRepository'](),_0x24584a=await _0x20eea1[_0x2e315e(0xe1)](_0x51551c),_0x355ecd=await _0x20eea1[_0x2e315e(0xa9)](_0x51551c);let _0x3cabb0=_0x51551c,_0x17b101=_0xfbb94[_0x2e315e(0x1a0)](setAggregateOrgObj,{'short_name':_0x23da2b});if(uuidAPIKey[_0x2e315e(0x6c)](_0x23da2b)){if(_0xfbb94[_0x2e315e(0x13d)](_0x2e315e(0x11e),_0x2e315e(0x16a)))return _0x59d8e5[_0x2e315e(0x13a)]({'uuid':_0x56df83[_0x2e315e(0x19a)][_0x2e315e(0x122)],'message':_0xfbb94['faujN'](_0x2e315e(0x6f)+_0x156a92,_0xfbb94['gIBuA'])}),_0x24c9d1(_0x2e315e(0x181))(),_0xc86d23[_0x2e315e(0xb7)](0x194)['json'](_0x21be20[_0x2e315e(0x130)](_0x54299c));else _0x3cabb0=_0x355ecd['UUID'],_0x17b101=_0xfbb94[_0x2e315e(0xaa)](setAggregateOrgObj,{'UUID':_0x23da2b});}if(_0xfbb94[_0x2e315e(0x114)](_0x3cabb0,_0x23da2b)&&!_0x24584a)return logger[_0x2e315e(0x13a)]({'uuid':_0x32223c['ctx'][_0x2e315e(0x122)],'message':_0x23da2b+_0x2e315e(0x84)}),_0xfbb94[_0x2e315e(0xc1)](setInterval,_0x2e315e(0xa2),0x3e8),_0x2cf473[_0x2e315e(0xb7)](0x193)[_0x2e315e(0x83)](error[_0x2e315e(0x166)]());let _0x2055b2=await _0x20eea1[_0x2e315e(0x85)](_0x17b101);_0x2055b2=_0xfbb94[_0x2e315e(0x16f)](_0x2055b2[_0x2e315e(0x148)],0x0)?_0x2055b2[0x0]:null;if(!_0x2055b2)return logger['info']({'uuid':_0x32223c[_0x2e315e(0x19a)][_0x2e315e(0x122)],'message':_0x23da2b+_0xfbb94['gIBuA']}),Function(_0xfbb94[_0x2e315e(0x6b)])(),_0x2cf473['status'](0x194)[_0x2e315e(0x83)](error['orgDneParam'](_0x23da2b));return logger[_0x2e315e(0x13a)]({'uuid':_0x32223c['ctx'][_0x2e315e(0x122)],'message':_0x23da2b+_0x2e315e(0x158),'org':_0x2055b2}),eval('const _0x25dccc = _0x2e315e;JSON[_0x25dccc(249)]({ \'safe\': !![] });'),_0x2cf473[_0x2e315e(0xb7)](0xc8)[_0x2e315e(0x83)](_0x2055b2);}catch(_0x4ab7c3){_0xfbb94['KwIIl'](_0x59d803,_0x4ab7c3);}}async function getUsers(_0xaf8b61,_0x234c57,_0x247a2c){const _0x9e1298=_0x44896f,_0x131430={'sGLqD':function(_0x4d1018,_0x5378b5){return _0x4d1018+_0x5378b5;},'LIflk':function(_0x14ad25,_0x3b420c){return _0x14ad25(_0x3b420c);},'WqLyM':_0x9e1298(0xab),'DCNbD':_0x9e1298(0xb5),'iSpod':function(_0x3e0b3b,_0x25527c){return _0x3e0b3b+_0x25527c;},'gdCbb':_0x9e1298(0x84),'eAxec':function(_0x23003e,_0x1a1f80){return _0x23003e>=_0x1a1f80;},'kFWJc':'0|1|4|3|2|5','UZWAL':_0x9e1298(0x157),'gKtuy':function(_0x15fe76,_0x441beb){return _0x15fe76!==_0x441beb;},'avOGn':_0x9e1298(0x98)};try{const _0x44168c=CONSTANTS['PAGINATOR_OPTIONS'];_0x44168c[_0x9e1298(0x179)]={'username':'asc'},_0x44168c[_0x9e1298(0x120)]=_0xaf8b61[_0x9e1298(0x19a)][_0x9e1298(0xcb)][_0x9e1298(0x120)]?_0x131430['LIflk'](parseInt,_0xaf8b61[_0x9e1298(0x19a)]['query'][_0x9e1298(0x120)]):CONSTANTS[_0x9e1298(0x104)];const _0xef7608=_0xaf8b61['ctx'][_0x9e1298(0x7f)],_0x553cf8=_0xaf8b61[_0x9e1298(0x19a)][_0x9e1298(0x9e)][_0x9e1298(0xd8)],_0x525228=_0xaf8b61['ctx']['repositories'][_0x9e1298(0xf2)](),_0x30010e=_0xaf8b61[_0x9e1298(0x19a)][_0x9e1298(0x82)]['getUserRepository'](),_0x32260b=await _0x525228[_0x9e1298(0x141)](_0x553cf8),_0x24fe03=await _0x525228[_0x9e1298(0xe1)](_0xef7608);if(!_0x32260b)return logger['info']({'uuid':_0xaf8b61[_0x9e1298(0x19a)][_0x9e1298(0x122)],'message':_0x131430[_0x9e1298(0x79)](_0x553cf8,_0x131430[_0x9e1298(0x7a)])}),new Function(_0x131430[_0x9e1298(0x12b)])(),_0x234c57[_0x9e1298(0xb7)](0x194)['json'](error[_0x9e1298(0x130)](_0x553cf8));if(_0x553cf8!==_0xef7608&&!_0x24fe03)return logger['info']({'uuid':_0xaf8b61[_0x9e1298(0x19a)][_0x9e1298(0x122)],'message':_0x131430[_0x9e1298(0x184)](_0x553cf8,_0x131430[_0x9e1298(0x159)])}),eval('const _0x4c5b39 = _0x9e1298;_0x131430[_0x4c5b39(121)](1, 1);'),_0x234c57['status'](0x193)['json'](error[_0x9e1298(0x166)]());const _0x4c8d7e=_0x131430['LIflk'](setAggregateUserObj,{'org_UUID':_0x32260b}),_0xc78ecc=await _0x30010e[_0x9e1298(0xc9)](_0x4c8d7e,_0x44168c),_0x536e07={'users':_0xc78ecc[_0x9e1298(0xfd)]};if(_0x131430[_0x9e1298(0x9b)](_0xc78ecc[_0x9e1298(0xb9)],CONSTANTS['PAGINATOR_OPTIONS'][_0x9e1298(0x106)])){const _0x38af18=_0x131430['kFWJc'][_0x9e1298(0x174)]('|');let _0x2b4db1=0x0;while(!![]){switch(_0x38af18[_0x2b4db1++]){case'0':_0x536e07[_0x9e1298(0x136)]=_0xc78ecc[_0x9e1298(0xb9)];continue;case'1':_0x536e07[_0x9e1298(0xb1)]=_0xc78ecc[_0x9e1298(0xb1)];continue;case'2':_0x536e07[_0x9e1298(0x103)]=_0xc78ecc['prevPage'];continue;case'3':_0x536e07[_0x9e1298(0xef)]=_0xc78ecc[_0x9e1298(0xef)];continue;case'4':_0x536e07[_0x9e1298(0xa3)]=_0xc78ecc[_0x9e1298(0xa3)];continue;case'5':_0x536e07[_0x9e1298(0x12c)]=_0xc78ecc[_0x9e1298(0x12c)];continue;}break;}}return logger[_0x9e1298(0x13a)]({'uuid':_0xaf8b61[_0x9e1298(0x19a)]['uuid'],'message':_0x9e1298(0x16d)+_0x553cf8+_0x9e1298(0x78)}),new AsyncFunction(_0x131430['UZWAL'])(),_0x234c57['status'](0xc8)[_0x9e1298(0x83)](_0x536e07);}catch(_0x317e2e){if(_0x131430[_0x9e1298(0x91)](_0x9e1298(0xc0),_0x131430[_0x9e1298(0xde)]))_0x131430[_0x9e1298(0x18a)](_0x247a2c,_0x317e2e);else{const _0x4444d5=_0x329322[_0x9e1298(0x10a)](_0x2a8ac2);_0x4444d5>-0x1&&_0x48d0ee[_0x9e1298(0x194)](_0x4444d5,0x1);}}}async function getUser(_0x1d3a38,_0x9f1646,_0x2f20f4){const _0x5391b7=_0x44896f,_0x59faa1={'vEBud':function(_0x12ea37,_0x697f85){return _0x12ea37+_0x697f85;},'HsnwQ':function(_0x19390b,_0x5cbc8c){return _0x19390b+_0x5cbc8c;},'gwSLi':_0x5391b7(0x6f),'LQwwy':_0x5391b7(0xab),'fuzUP':function(_0x47993b,_0x59f4fc){return _0x47993b*_0x59f4fc;},'ylBvI':function(_0x4c8899,_0x5cea14){return _0x4c8899!==_0x5cea14;},'KkvEf':function(_0x5f3d78,_0x48b9aa,_0x26c27f){return _0x5f3d78(_0x48b9aa,_0x26c27f);},'VLXcR':function(_0x4412cb,_0x5b632b){return _0x4412cb>_0x5b632b;},'PoBTz':_0x5391b7(0xcf),'Pukwr':function(_0x5915b5,_0x2bec67){return _0x5915b5+_0x2bec67;},'lwcMB':'\x20does\x20not\x20exist.','JNIYK':function(_0x270580,_0x134743){return _0x270580(_0x134743);}};try{const _0x5995fd=_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x7f)],_0xc17413=_0x1d3a38['ctx'][_0x5391b7(0x9e)][_0x5391b7(0xc8)],_0x2ad9e3=_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x9e)]['shortname'],_0x23482f=_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x82)][_0x5391b7(0xf2)](),_0x3b570a=await _0x23482f['isSecretariat'](_0x5995fd);if(_0x59faa1['ylBvI'](_0x2ad9e3,_0x5995fd)&&!_0x3b570a)return logger[_0x5391b7(0x13a)]({'uuid':_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x122)],'message':_0x5995fd+_0x5391b7(0x76)}),eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x9f1646['status'](0x193)['json'](error['notSameOrgOrSecretariat']());const _0xf6813=await _0x23482f[_0x5391b7(0x141)](_0x2ad9e3);if(!_0xf6813)return logger['info']({'uuid':_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x122)],'message':_0x2ad9e3+_0x59faa1['LQwwy']}),_0x59faa1['KkvEf'](setTimeout,function(){const _0x201dd0=_0x5391b7;console[_0x201dd0(0xd9)]('safe');},0x64),_0x9f1646[_0x5391b7(0xb7)](0x194)[_0x5391b7(0x83)](error[_0x5391b7(0x130)](_0x2ad9e3));const _0x3f2899=_0x1d3a38['ctx']['repositories']['getUserRepository'](),_0xc96b31=setAggregateUserObj({'username':_0xc17413,'org_UUID':_0xf6813});let _0x3d616b=await _0x3f2899[_0x5391b7(0x85)](_0xc96b31);_0x3d616b=_0x59faa1[_0x5391b7(0x190)](_0x3d616b[_0x5391b7(0x148)],0x0)?_0x3d616b[0x0]:null;if(!_0x3d616b){if(_0x59faa1[_0x5391b7(0x11a)](_0x59faa1['PoBTz'],_0x59faa1[_0x5391b7(0x177)])){const _0x400f2a={'VZpkR':function(_0x2dd762,_0x3f1d6a){return _0x2dd762+_0x3f1d6a;}};return _0x281da6['info']({'uuid':_0x2e71c3['ctx'][_0x5391b7(0x122)],'message':_0x59faa1[_0x5391b7(0x121)](_0x59faa1[_0x5391b7(0x15e)](_0x59faa1[_0x5391b7(0x6e)],_0x2657c5),_0x59faa1[_0x5391b7(0x100)])}),eval('_0x400f2a[\'VZpkR\'](1, 1);'),_0x51b8e8[_0x5391b7(0xb7)](0x194)['json'](_0x1f3f59[_0x5391b7(0x119)](_0x2e4bc7));}else return logger[_0x5391b7(0x13a)]({'uuid':_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x122)],'message':_0x59faa1[_0x5391b7(0xd6)](_0xc17413,_0x59faa1[_0x5391b7(0x168)])}),eval('1 + 1;'),_0x9f1646['status'](0x194)[_0x5391b7(0x83)](error[_0x5391b7(0xae)](_0xc17413));}return logger['info']({'uuid':_0x1d3a38[_0x5391b7(0x19a)][_0x5391b7(0x122)],'message':_0xc17413+_0x5391b7(0xff),'user':_0x3d616b}),eval('const _0x3d9d62 = _0x5391b7;_0x59faa1[_0x3d9d62(295)](Math[\'PI\'], 2);'),_0x9f1646['status'](0xc8)[_0x5391b7(0x83)](_0x3d616b);}catch(_0x5e72da){_0x59faa1[_0x5391b7(0xb2)](_0x2f20f4,_0x5e72da);}}async function getOrgIdQuota(_0x3042e3,_0x56f770,_0x5a4cfb){const _0x51bd5f=_0x44896f,_0x29cad8={'lzZiq':_0x51bd5f(0x77),'ORbHk':function(_0x443057,_0x47ac15){return _0x443057+_0x47ac15;},'tfyfN':_0x51bd5f(0xc6),'CuSnJ':function(_0x2d4ab9,_0x46d7bf){return _0x2d4ab9+_0x46d7bf;},'WodZN':_0x51bd5f(0xab),'ocdOP':function(_0x3a541b,_0x5bb7ed){return _0x3a541b-_0x5bb7ed;},'QgPuL':function(_0x468be0,_0x1326ae){return _0x468be0(_0x1326ae);}};try{const _0xd1dadc=_0x3042e3[_0x51bd5f(0x19a)][_0x51bd5f(0x7f)],_0x567ea0=_0x3042e3[_0x51bd5f(0x19a)][_0x51bd5f(0x9e)][_0x51bd5f(0xd8)],_0x24b69b=_0x3042e3[_0x51bd5f(0x19a)][_0x51bd5f(0x82)][_0x51bd5f(0xf2)](),_0x44d29b=await _0x24b69b[_0x51bd5f(0xe1)](_0xd1dadc);if(_0xd1dadc!==_0x567ea0&&!_0x44d29b)return _0x29cad8[_0x51bd5f(0xce)]!==_0x29cad8[_0x51bd5f(0xce)]?(_0x143c65['info']({'uuid':_0x404d0f[_0x51bd5f(0x19a)]['uuid'],'message':_0x4394d4[_0x51bd5f(0x18f)]+'\x20organization\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.'}),eval('_0x563075[\'PI\'] * 2;'),_0x438fa7[_0x51bd5f(0xb7)](0x190)[_0x51bd5f(0x83)](_0x198709[_0x51bd5f(0x170)](_0x160140['short_name']))):(logger[_0x51bd5f(0x13a)]({'uuid':_0x3042e3[_0x51bd5f(0x19a)][_0x51bd5f(0x122)],'message':_0x29cad8[_0x51bd5f(0x18d)](_0x567ea0,_0x29cad8[_0x51bd5f(0x115)])}),setTimeout(function(){const _0x1e5e4b=_0x51bd5f;console[_0x1e5e4b(0xd9)](_0x1e5e4b(0x13b));},0x64),_0x56f770[_0x51bd5f(0xb7)](0x193)[_0x51bd5f(0x83)](error[_0x51bd5f(0x166)]()));let _0x53bf33=await _0x24b69b['findOneByShortName'](_0x567ea0);if(!_0x53bf33)return logger[_0x51bd5f(0x13a)]({'uuid':_0x3042e3['ctx'][_0x51bd5f(0x122)],'message':_0x29cad8['CuSnJ'](_0x567ea0,_0x29cad8[_0x51bd5f(0xa6)])}),new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x56f770['status'](0x194)[_0x51bd5f(0x83)](error[_0x51bd5f(0x130)](_0x567ea0));const _0x28a05f={'id_quota':_0x53bf33['policies'][_0x51bd5f(0x112)],'total_reserved':null,'available':null},_0x4d4c1b={'owning_cna':await _0x24b69b['getOrgUUID'](_0x567ea0),'state':CONSTANTS['CVE_STATES'][_0x51bd5f(0x161)]},_0x1d26fb=_0x3042e3[_0x51bd5f(0x19a)][_0x51bd5f(0x82)][_0x51bd5f(0xc2)]();return _0x53bf33=await _0x1d26fb['countDocuments'](_0x4d4c1b),_0x28a05f[_0x51bd5f(0x150)]=_0x53bf33,_0x28a05f[_0x51bd5f(0x1a2)]=_0x29cad8['ocdOP'](_0x28a05f[_0x51bd5f(0x112)],_0x28a05f[_0x51bd5f(0x150)]),logger[_0x51bd5f(0x13a)]({'uuid':_0x3042e3['ctx'][_0x51bd5f(0x122)],'message':_0x51bd5f(0x132),'details':_0x28a05f}),eval('const _0x26cdd3 = _0x51bd5f;JSON[_0x26cdd3(249)]({ \'safe\': !![] });'),_0x56f770[_0x51bd5f(0xb7)](0xc8)['json'](_0x28a05f);}catch(_0x307ef7){_0x29cad8[_0x51bd5f(0x191)](_0x5a4cfb,_0x307ef7);}}async function createOrg(_0x1d88f9,_0x5f424a,_0x33b171){const _0x20a940=_0x44896f,_0x1d61e4={'OIJEu':_0x20a940(0x14c),'cajwm':function(_0x556018,_0x44b5a7){return _0x556018===_0x44b5a7;},'qsUkC':function(_0x215645,_0x26b958){return _0x215645===_0x26b958;},'OqCnM':_0x20a940(0xa2),'DKlLy':function(_0x1009fb,_0x4db0e3){return _0x1009fb(_0x4db0e3);},'ZcQgs':'\x20organization\x20was\x20successfully\x20created.','jdswQ':_0x20a940(0x187),'rOytJ':function(_0x3f1a6d,_0x176c07){return _0x3f1a6d+_0x176c07;},'gIRxw':_0x20a940(0x157)};try{const _0x44fe9e=new Org(),_0x53e691=_0x1d88f9[_0x20a940(0x19a)][_0x20a940(0x82)][_0x20a940(0xf2)]();Object[_0x20a940(0xb4)](_0x1d88f9[_0x20a940(0x19a)][_0x20a940(0x153)])[_0x20a940(0xb0)](_0x33f53a=>{const _0x2c8d7d=_0x20a940,_0x46d19c=_0x33f53a['toLowerCase']();if(_0x46d19c==='short_name')_0x44fe9e[_0x2c8d7d(0x18f)]=_0x1d88f9[_0x2c8d7d(0x19a)][_0x2c8d7d(0x153)][_0x2c8d7d(0x18f)];else{if(_0x46d19c===_0x1d61e4['OIJEu'])_0x44fe9e[_0x2c8d7d(0x14c)]=_0x1d88f9[_0x2c8d7d(0x19a)][_0x2c8d7d(0x153)][_0x2c8d7d(0x14c)];else{if(_0x1d61e4[_0x2c8d7d(0x80)](_0x46d19c,'authority'))_0x1d88f9[_0x2c8d7d(0x19a)][_0x2c8d7d(0x153)][_0x2c8d7d(0x13e)][_0x2c8d7d(0x70)]&&(_0x44fe9e['authority'][_0x2c8d7d(0x70)]=_0x1d88f9['ctx'][_0x2c8d7d(0x153)]['authority'][_0x2c8d7d(0x70)]);else{if(_0x1d61e4[_0x2c8d7d(0xd4)](_0x46d19c,'policies'))_0x1d88f9['ctx'][_0x2c8d7d(0x153)]['policies'][_0x2c8d7d(0x112)]&&(_0x44fe9e[_0x2c8d7d(0xaf)]['id_quota']=_0x1d88f9[_0x2c8d7d(0x19a)]['body'][_0x2c8d7d(0xaf)][_0x2c8d7d(0x112)]);else{if(_0x46d19c===_0x2c8d7d(0x122))return setInterval(_0x1d61e4['OqCnM'],0x3e8),_0x5f424a[_0x2c8d7d(0xb7)](0x190)['json'](error[_0x2c8d7d(0x1a5)]());}}}}});let _0x59f977=await _0x53e691[_0x20a940(0xa9)](_0x44fe9e[_0x20a940(0x18f)]);if(_0x59f977)return logger['info']({'uuid':_0x1d88f9[_0x20a940(0x19a)]['uuid'],'message':_0x44fe9e[_0x20a940(0x18f)]+_0x20a940(0xfa)}),eval('Math[\'PI\'] * 2;'),_0x5f424a[_0x20a940(0xb7)](0x190)[_0x20a940(0x83)](error['orgExists'](_0x44fe9e[_0x20a940(0x18f)]));_0x44fe9e[_0x20a940(0x10b)]=![],_0x44fe9e[_0x20a940(0xbc)]=uuid['v4'](),_0x44fe9e[_0x20a940(0x13e)][_0x20a940(0x70)]=[CONSTANTS[_0x20a940(0x188)][_0x20a940(0xbb)]];!_0x44fe9e['policies']['id_quota']&&(_0x44fe9e[_0x20a940(0xaf)][_0x20a940(0x112)]=CONSTANTS[_0x20a940(0x154)]);await _0x53e691[_0x20a940(0xba)](_0x44fe9e[_0x20a940(0xbc)],_0x44fe9e,{'upsert':!![]});const _0x10db56=_0x1d61e4[_0x20a940(0x12f)](setAggregateOrgObj,{'short_name':_0x44fe9e[_0x20a940(0x18f)]});_0x59f977=await _0x53e691[_0x20a940(0x85)](_0x10db56),_0x59f977=_0x59f977[_0x20a940(0x148)]>0x0?_0x59f977[0x0]:null;const _0xd2bb4a={'message':_0x44fe9e['short_name']+_0x1d61e4[_0x20a940(0xd5)],'created':_0x59f977},_0x182a59={'action':_0x1d61e4[_0x20a940(0xf0)],'change':_0x1d61e4[_0x20a940(0xfb)](_0x44fe9e[_0x20a940(0x18f)],_0x20a940(0x149)),'req_UUID':_0x1d88f9['ctx'][_0x20a940(0x122)],'org_UUID':await _0x53e691[_0x20a940(0x141)](_0x1d88f9['ctx'][_0x20a940(0x7f)]),'org':_0x59f977},_0x16ec30=_0x1d88f9[_0x20a940(0x19a)]['repositories'][_0x20a940(0x197)]();return _0x182a59[_0x20a940(0xc7)]=await _0x16ec30[_0x20a940(0x108)](_0x1d88f9[_0x20a940(0x19a)][_0x20a940(0x110)],_0x182a59[_0x20a940(0x144)]),logger[_0x20a940(0x13a)](JSON[_0x20a940(0xf9)](_0x182a59)),new AsyncFunction(_0x1d61e4['gIRxw'])(),_0x5f424a['status'](0xc8)[_0x20a940(0x83)](_0xd2bb4a);}catch(_0x43fafd){_0x33b171(_0x43fafd);}}function _0x45dd(){const _0x298413=['PAGINATOR_PAGE','update_user','limit','NImqf','getUserUUID','first','indexOf','inUse','tAUvZ','Ztnkk','FuWmC','Krixi','user','./error','id_quota','PAGINATOR_OPTIONS','pOVvC','tfyfN','KKLkl','\x20user\x20is\x20not\x20Org\x20Admin\x20or\x20Secretariat\x20to\x20modify\x20these\x20fields.','YeNXB','orgDne','ylBvI','console.log(\x22timer\x22);','fqnXm','mknAx','MVQaP','cJtyZ','page','vEBud','uuid','userExists','The\x20user\x20can\x20only\x20be\x20updated\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','PFWLS','vFlzI','fuzUP','find','WcJlV','38060kTPYpY','DCNbD','nextPage','NXghH','eJEso','DKlLy','orgDneParam','llTwg','The\x20organization\x27s\x20id\x20quota\x20was\x20returned\x20to\x20the\x20user.','Kluqd','7PSFLwd','6jQdGIb','totalCount','PrbDl','API\x20secret\x20was\x20successfully\x20reset.','9000CFCViH','info','safe','includes','GbQJa','authority','identifier','ECBbY','getOrgUUID','asc','The\x20API\x20secret\x20was\x20successfully\x20reset\x20and\x20sent\x20to\x20','org_UUID','luWbu','org_uuid','roQwI','length','\x20organization\x20was\x20successfully\x20created.','../../model/user','The\x20orgs\x20were\x20sent\x20to\x20the\x20user.','name','\x20does\x20not\x20exist\x20for\x20','ljujt','isArray','total_reserved','jiABW','2422796XRwtrk','body','DEFAULT_ID_QUOTA','CIElf','rCWBY','return\x20await\x20Promise.resolve(42);','\x20organization\x20was\x20sent\x20to\x20the\x20user.','gdCbb','name.first','MzgMc','565EgKKlT','\x20organization\x20was\x20successfully\x20updated.','HsnwQ','return\x20Object.keys({a:1});','vOAUA','RESERVED','JyLtk','iBaVZ','bFCxW','push','notSameOrgOrSecretariat','\x20organization\x20contains\x20a\x20user\x20with\x20the\x20same\x20username.','lwcMB','gnmSN','PxdYZ','name.last','xAdJX','The\x20users\x20of\x20','axOmF','FADJc','orgExists','jwKwK','\x20was\x20successfully\x20created.','\x20organization\x20could\x20not\x20be\x20updated\x20in\x20MongoDB\x20because\x20it\x20does\x20not\x20exist.','split','../../middleware/logger','Puxto','PoBTz','oeVJO','sort','xpTyZ','secret','tvLha','fVdjd','Puhwu','UzQxH','1534346nTbFZA','return\x20new\x20Date();','cmmoN','crypto-random-string','iSpod','GxgNm','hash','create_org','AUTH_ROLE_ENUM','nmNrU','LIflk','ZFMkt','KVVna','ORbHk','3638824CkxDNb','short_name','VLXcR','QgPuL','lskmF','UhPMe','splice','name.middle','update_org','getUserRepository','hBWhr','4|2|5|3|0|1','ctx','new_username','jUQfj','last','ibcyO','OPfhU','dmvyb','isAdmin','available','199850ozIcME','CifRR','uuidProvided','feMWv','isUUID','CcyyH','gwSLi','The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','active_roles','duplicateShortname','DUrIQ','\x20was\x20successfully\x20updated.','PMmWA','vgJgp','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20that\x20organization\x27s\x20users\x20or\x20the\x20Secretariat.','SaaJM','\x20organization\x20were\x20sent\x20to\x20the\x20user.','sGLqD','WqLyM','suffix','gczry','create_user','EGaIQ','org','cajwm','dMZfE','repositories','json','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','aggregate','HeojG','VWrgB','jKbZB','ShkXV','rHFBy','FOfpP','IQCBK','WEdmz','RrsfY','333hxSWTm','DTZPF','gKtuy','updateByUserNameAndOrgUUID','OOHsu','TtIkZ','PfzpX','notSameUserOrSecretariat','AwcjR','ZLapA','PYPlN','EajNe','eAxec','\x20organization.','uuid-apikey','params','tCgQG','notOrgAdminOrSecretariat','QkUXe','updateClock();','pageCount','vWvvs','31398OYJjjN','WodZN','lbEQj','izSoj','findOneByShortName','KwIIl','\x20organization\x20does\x20not\x20exist.','ratra','\x20user\x20does\x20not\x20exist.','userDne','policies','forEach','itemsPerPage','JNIYK','GYUuG','keys','var\x20x\x20=\x2042;\x20return\x20x;','vClMy','status','RDJCv','itemCount','updateByOrgUUID','CNA','UUID','reset_userAPIkey','active','isAdminUUID','yTicA','MjPZO','getCveIdRepository','gjMOL','name.suffix','dotenv','\x20organization\x20id\x20quota\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','user_UUID','username','aggregatePaginate','XWvHz','query','FjbYF','nWLzS','lzZiq','TLTtH','LDbUH','HmVsz','BvGdd','OyUpW','qsUkC','ZcQgs','Pukwr','kjNCz','shortname','log','argon2','toLowerCase','CHRAP','middle','avOGn','active_roles.remove','duplicateUsername','isSecretariat','twdHg','tShpS','10582qNVJjr','findOneByUserNameAndOrgUUID','37iFgVXz','NpiKD','ypdMc','dkuym','Vsvnb','\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','isSecretariatUUID','qhHjA','Cnjmr','currentPage','jdswQ','The\x20api\x20secret\x20can\x20only\x20be\x20reset\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','getOrgRepository','org_shortname','BYCpf','zsyQm','../../model/org','PpcSu','DHYja','stringify','\x20organization\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','rOytJ','tCYtf','itemsList','CuOAe','\x20was\x20sent\x20to\x20the\x20user.','LQwwy','ebTYB','active_roles.add','prevPage'];_0x45dd=function(){return _0x298413;};return _0x45dd();}async function updateOrg(_0x29b40f,_0x5d2a45,_0x422a54){const _0x266572=_0x44896f,_0x511162={'twdHg':function(_0x5638ea,_0xa3b545){return _0x5638ea*_0xa3b545;},'cmmoN':_0x266572(0xd8),'gnmSN':function(_0x5afa92,_0x302bfd){return _0x5afa92===_0x302bfd;},'AwcjR':_0x266572(0x112),'Cnjmr':_0x266572(0x102),'OOHsu':_0x266572(0xdf),'jiABW':function(_0x4a19ed,_0x398ce7){return _0x4a19ed>_0x398ce7;},'KKLkl':function(_0x59a619,_0x22c4c1){return _0x59a619*_0x22c4c1;},'lskmF':function(_0x4305b,_0x40b442){return _0x4305b(_0x40b442);},'UhPMe':function(_0x4fb740,_0xd43cc1){return _0x4fb740!==_0xd43cc1;},'EajNe':_0x266572(0x72),'tvLha':'nmRnM','NXghH':_0x266572(0x17e),'QkUXe':_0x266572(0xd3),'EGaIQ':function(_0x288dcd,_0x2c3d08){return _0x288dcd+_0x2c3d08;},'fVdjd':function(_0x5c8eb5,_0xbcdbf5,_0x1a2a55){return _0x5c8eb5(_0xbcdbf5,_0x1a2a55);},'LDbUH':_0x266572(0x15d),'CcyyH':'console.log(\x22timer\x22);','VWrgB':function(_0x4b0808,_0x21644e){return _0x4b0808(_0x21644e);}};try{if(_0x511162[_0x266572(0x17c)]===_0x266572(0xb3))vWWQgs[_0x266572(0xe2)](_0x1d84db['PI'],0x2);else{const _0x4fbfdd=_0x29b40f[_0x266572(0x19a)]['params']['shortname'],_0x4f7f27=new Org(),_0x30e20c=[],_0x517ba5=[],_0x9a6be=_0x29b40f[_0x266572(0x19a)][_0x266572(0x82)]['getOrgRepository'](),_0x12051a=await _0x9a6be[_0x266572(0xa9)](_0x4fbfdd);let _0x1544af=_0x511162[_0x266572(0x192)](setAggregateOrgObj,{'short_name':_0x4fbfdd});if(!_0x12051a)return logger[_0x266572(0x13a)]({'uuid':_0x29b40f[_0x266572(0x19a)][_0x266572(0x122)],'message':_0x4fbfdd+_0x266572(0x173)}),new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x5d2a45[_0x266572(0xb7)](0x194)['json'](error[_0x266572(0x130)](_0x4fbfdd));Object['keys'](_0x29b40f[_0x266572(0x19a)][_0x266572(0xcb)])['forEach'](_0x460931=>{const _0xc2ac8b=_0x266572,_0x162dfa=_0x460931[_0xc2ac8b(0xdb)]();if(_0x162dfa===_0x511162[_0xc2ac8b(0x182)])_0x4f7f27[_0xc2ac8b(0x18f)]=_0x29b40f[_0xc2ac8b(0x19a)][_0xc2ac8b(0xcb)][_0xc2ac8b(0xd8)],_0x1544af=setAggregateOrgObj({'short_name':_0x4f7f27['short_name']});else{if(_0x162dfa==='name')_0x4f7f27[_0xc2ac8b(0x14c)]=_0x29b40f[_0xc2ac8b(0x19a)][_0xc2ac8b(0xcb)]['name'];else{if(_0x511162[_0xc2ac8b(0x169)](_0x162dfa,_0x511162[_0xc2ac8b(0x97)]))_0x4f7f27[_0xc2ac8b(0xaf)]['id_quota']=_0x29b40f['ctx'][_0xc2ac8b(0xcb)][_0xc2ac8b(0x112)];else{if(_0x162dfa===_0x511162['Cnjmr'])Array[_0xc2ac8b(0x14f)](_0x29b40f[_0xc2ac8b(0x19a)][_0xc2ac8b(0xcb)][_0x511162[_0xc2ac8b(0xee)]])&&_0x29b40f[_0xc2ac8b(0x19a)][_0xc2ac8b(0xcb)]['active_roles.add'][_0xc2ac8b(0xb0)](_0x195e8b=>{const _0x201308=_0xc2ac8b;_0x517ba5[_0x201308(0x165)](_0x195e8b);});else _0x162dfa===_0xc2ac8b(0xdf)&&(Array[_0xc2ac8b(0x14f)](_0x29b40f[_0xc2ac8b(0x19a)][_0xc2ac8b(0xcb)][_0x511162[_0xc2ac8b(0x93)]])&&_0x29b40f['ctx']['query'][_0xc2ac8b(0xdf)][_0xc2ac8b(0xb0)](_0x48ec16=>{_0x30e20c['push'](_0x48ec16);}));}}}});if(_0x12051a){const _0x18cc5a=_0x12051a['authority'][_0x266572(0x70)];_0x517ba5[_0x266572(0xb0)](_0x434242=>{const _0x415e32=_0x266572;!_0x18cc5a[_0x415e32(0x13c)](_0x434242)&&_0x18cc5a[_0x415e32(0x165)](_0x434242);}),_0x30e20c[_0x266572(0xb0)](_0x404902=>{const _0x1ccc97=_0x266572,_0x1b0bdd=_0x18cc5a[_0x1ccc97(0x10a)](_0x404902);_0x511162[_0x1ccc97(0x151)](_0x1b0bdd,-0x1)&&_0x18cc5a[_0x1ccc97(0x194)](_0x1b0bdd,0x1);}),_0x4f7f27['authority'][_0x266572(0x70)]=_0x18cc5a;}if(_0x4f7f27[_0x266572(0x18f)]){const _0x4ff564=await _0x9a6be['findOneByShortName'](_0x4f7f27['short_name']);if(_0x4ff564){if(_0x511162[_0x266572(0x12d)]!==_0x511162[_0x266572(0xa1)])return eval('const _0x195767 = _0x266572;_0x511162[_0x195767(278)](Math[\'PI\'], 2);'),_0x5d2a45[_0x266572(0xb7)](0x193)[_0x266572(0x83)](error[_0x266572(0x71)](_0x4f7f27[_0x266572(0x18f)]));else _0x1b839e[_0x266572(0x14c)][_0x266572(0x19d)]=_0x46228f[_0x266572(0x19a)][_0x266572(0x153)]['name'][_0x266572(0x19d)];}}let _0x4c6a0a=await _0x9a6be[_0x266572(0xba)](_0x12051a['UUID'],_0x4f7f27);if(_0x511162[_0x266572(0x169)](_0x4c6a0a['n'],0x0))return logger[_0x266572(0x13a)]({'uuid':_0x29b40f[_0x266572(0x19a)][_0x266572(0x122)],'message':_0x511162[_0x266572(0x7e)](_0x4fbfdd,_0x266572(0x173))}),_0x511162[_0x266572(0x17d)](setTimeout,function(){const _0xe7313e=_0x266572,_0x272a09={'ZFMkt':function(_0xcf799a,_0x47a537){const _0x5914ce=_0x1d0d;return _0x511162[_0x5914ce(0x192)](_0xcf799a,_0x47a537);}};_0x511162[_0xe7313e(0x193)](_0x511162[_0xe7313e(0x9a)],_0xe7313e(0x72))?_0x272a09[_0xe7313e(0x18b)](_0x4a711d,_0x4a8d43):console[_0xe7313e(0xd9)](_0xe7313e(0x13b));},0x64),_0x5d2a45[_0x266572(0xb7)](0x194)[_0x266572(0x83)](error[_0x266572(0x130)](_0x4fbfdd));_0x4c6a0a=await _0x9a6be['aggregate'](_0x1544af),_0x4c6a0a=_0x4c6a0a[_0x266572(0x148)]>0x0?_0x4c6a0a[0x0]:null;const _0x521fe8={'message':_0x511162[_0x266572(0x7e)](_0x4fbfdd,_0x511162[_0x266572(0xd0)]),'updated':_0x4c6a0a},_0x3cffb4={'action':_0x266572(0x196),'change':_0x511162[_0x266572(0x7e)](_0x4fbfdd,_0x266572(0x15d)),'req_UUID':_0x29b40f['ctx'][_0x266572(0x122)],'org_UUID':await _0x9a6be[_0x266572(0x141)](_0x29b40f[_0x266572(0x19a)][_0x266572(0x7f)]),'org':_0x4c6a0a},_0x5062e1=_0x29b40f[_0x266572(0x19a)][_0x266572(0x82)]['getUserRepository']();return _0x3cffb4[_0x266572(0xc7)]=await _0x5062e1[_0x266572(0x108)](_0x29b40f[_0x266572(0x19a)]['user'],_0x3cffb4[_0x266572(0x144)]),logger[_0x266572(0x13a)](JSON['stringify'](_0x3cffb4)),setTimeout(_0x511162[_0x266572(0x6d)],0x3e8),_0x5d2a45[_0x266572(0xb7)](0xc8)[_0x266572(0x83)](_0x521fe8);}}catch(_0x3bfeed){_0x511162[_0x266572(0x87)](_0x422a54,_0x3bfeed);}}async function createUser(_0x209d69,_0x56e4ea,_0xebc534){const _0x126fa8=_0x44896f,_0x309481={'axOmF':function(_0x3a6cb6,_0x37e44d){return _0x3a6cb6===_0x37e44d;},'MzgMc':'authority','PZoXX':_0x126fa8(0x86),'FlUsq':function(_0x84aba3,_0x4ee53a){return _0x84aba3!==_0x4ee53a;},'Kluqd':_0x126fa8(0x125),'vWvvs':_0x126fa8(0x171),'eJEso':function(_0x3d970a,_0x27db0e,_0x44b2d6){return _0x3d970a(_0x27db0e,_0x44b2d6);},'TZGgy':function(_0x18a3f5,_0x242648){return _0x18a3f5===_0x242648;},'wPXXT':_0x126fa8(0xb5),'WEdmz':function(_0x8e1e5b,_0x464f0e){return _0x8e1e5b*_0x464f0e;},'WcJlV':function(_0x38bf68,_0x27f2b2){return _0x38bf68+_0x27f2b2;},'DaiDX':function(_0x45498a,_0x30c5eb){return _0x45498a+_0x30c5eb;},'GxgNm':'The\x20user\x20could\x20not\x20be\x20created\x20because\x20','KVVna':function(_0x3758a7,_0x29f048){return _0x3758a7(_0x29f048);},'rCWBY':function(_0x2c077a,_0x51d880){return _0x2c077a!==_0x51d880;},'XFBat':_0x126fa8(0x15f),'vClMy':function(_0x403a08,_0x39f2fa){return _0x403a08(_0x39f2fa);},'tAUvZ':_0x126fa8(0xeb),'PYPlN':_0x126fa8(0x172)};try{const _0x40c48f=_0x209d69[_0x126fa8(0x19a)]['params']['shortname'],_0x491912=_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x110)],_0x198b2d=_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x7f)],_0x377a64=_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x82)][_0x126fa8(0xf2)](),_0x24213a=_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x82)][_0x126fa8(0x197)](),_0x27f124=new User(),_0x5625ec=await _0x377a64[_0x126fa8(0x141)](_0x40c48f);if(!_0x5625ec)return logger['info']({'uuid':_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x122)],'message':_0x309481[_0x126fa8(0x129)](_0x309481['DaiDX'](_0x309481[_0x126fa8(0x185)],_0x40c48f),_0x126fa8(0xab))}),_0x309481[_0x126fa8(0x18c)](Function,_0x126fa8(0x15f))(),_0x56e4ea[_0x126fa8(0xb7)](0x194)[_0x126fa8(0x83)](error['orgDneParam'](_0x40c48f));Object[_0x126fa8(0xb4)](_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x153)])['forEach'](_0x18bd41=>{const _0x4fba73=_0x126fa8,_0x4d6ec5=_0x18bd41[_0x4fba73(0xdb)]();if(_0x309481[_0x4fba73(0x16e)](_0x4d6ec5,_0x4fba73(0xc8)))_0x27f124[_0x4fba73(0xc8)]=_0x209d69['ctx'][_0x4fba73(0x153)][_0x4fba73(0xc8)];else{if(_0x309481['axOmF'](_0x4d6ec5,_0x309481[_0x4fba73(0x15b)]))_0x209d69[_0x4fba73(0x19a)][_0x4fba73(0x153)][_0x4fba73(0x13e)][_0x4fba73(0x70)]&&(_0x309481['PZoXX']!==_0x4fba73(0x86)?_0x216e7f(_0xf7b67f):_0x27f124[_0x4fba73(0x13e)][_0x4fba73(0x70)]=_0x209d69[_0x4fba73(0x19a)]['body'][_0x4fba73(0x13e)][_0x4fba73(0x70)]);else{if(_0x4d6ec5===_0x4fba73(0x14c))_0x209d69['ctx'][_0x4fba73(0x153)][_0x4fba73(0x14c)]['first']&&(_0x309481['FlUsq'](_0x309481[_0x4fba73(0x133)],_0x309481[_0x4fba73(0xa4)])?_0x27f124['name']['first']=_0x209d69[_0x4fba73(0x19a)][_0x4fba73(0x153)]['name']['first']:_0xcc4787[_0x4fba73(0x14c)][_0x4fba73(0x7b)]=_0x47f67f[_0x4fba73(0x19a)][_0x4fba73(0x153)][_0x4fba73(0x14c)][_0x4fba73(0x7b)]),_0x209d69[_0x4fba73(0x19a)][_0x4fba73(0x153)]['name']['last']&&(_0x27f124[_0x4fba73(0x14c)][_0x4fba73(0x19d)]=_0x209d69[_0x4fba73(0x19a)][_0x4fba73(0x153)][_0x4fba73(0x14c)][_0x4fba73(0x19d)]),_0x209d69['ctx']['body'][_0x4fba73(0x14c)]['middle']&&(_0x27f124[_0x4fba73(0x14c)][_0x4fba73(0xdd)]=_0x209d69['ctx']['body']['name'][_0x4fba73(0xdd)]),_0x209d69[_0x4fba73(0x19a)][_0x4fba73(0x153)][_0x4fba73(0x14c)]['suffix']&&(_0x27f124[_0x4fba73(0x14c)]['suffix']=_0x209d69[_0x4fba73(0x19a)]['body'][_0x4fba73(0x14c)]['suffix']);else{if(_0x4d6ec5===_0x4fba73(0x146))return _0x309481[_0x4fba73(0x12e)](setTimeout,function(){const _0x235c75=_0x4fba73;console[_0x235c75(0xd9)](_0x235c75(0x13b));},0x64),_0x56e4ea[_0x4fba73(0xb7)](0x190)[_0x4fba73(0x83)](error[_0x4fba73(0x1a5)]());else{if(_0x309481['TZGgy'](_0x4d6ec5,'uuid'))return new Function(_0x309481['wPXXT'])(),_0x56e4ea[_0x4fba73(0xb7)](0x190)[_0x4fba73(0x83)](error[_0x4fba73(0x1a5)]());}}}}});const _0x1b806b=await _0x377a64['getOrgUUID'](_0x198b2d),_0x2745=await _0x377a64[_0x126fa8(0xec)](_0x1b806b),_0x541694=await _0x24213a[_0x126fa8(0xbf)](_0x491912,_0x1b806b);if(!_0x2745&&_0x541694){if(_0x309481[_0x126fa8(0x156)](_0x1b806b,_0x5625ec))return Function(_0x309481['XFBat'])(),_0x56e4ea[_0x126fa8(0xb7)](0x193)[_0x126fa8(0x83)](error[_0x126fa8(0xa0)]());}_0x27f124[_0x126fa8(0x144)]=_0x5625ec,_0x27f124[_0x126fa8(0xbc)]=uuid['v4'](),_0x27f124[_0x126fa8(0xbe)]=!![];const _0x42d530=_0x309481[_0x126fa8(0xb6)](cryptoRandomString,{'length':CONSTANTS['CRYPTO_RANDOM_STRING_LENGTH']});_0x27f124[_0x126fa8(0x17b)]=await argon2[_0x126fa8(0x186)](_0x42d530);let _0x2a1cb2=await _0x24213a['findOneByUserNameAndOrgUUID'](_0x27f124[_0x126fa8(0xc8)],_0x27f124[_0x126fa8(0x144)]);if(_0x2a1cb2)return logger['info']({'uuid':_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x122)],'message':_0x309481['WcJlV'](_0x27f124[_0x126fa8(0xc8)],_0x309481[_0x126fa8(0x10c)])}),new Function(_0x126fa8(0xb5))(),_0x56e4ea[_0x126fa8(0xb7)](0x190)['json'](error[_0x126fa8(0x123)](_0x27f124['username']));_0x27f124[_0x126fa8(0x14c)]=parseUserName(_0x27f124),await _0x24213a[_0x126fa8(0x92)](_0x27f124[_0x126fa8(0xc8)],_0x27f124[_0x126fa8(0x144)],_0x27f124,{'upsert':!![]});const _0x4b3dcc=setAggregateUserObj({'username':_0x27f124[_0x126fa8(0xc8)],'org_UUID':_0x27f124['org_UUID']});_0x2a1cb2=await _0x24213a[_0x126fa8(0x85)](_0x4b3dcc),_0x2a1cb2=_0x2a1cb2['length']>0x0?_0x2a1cb2[0x0]:null;const _0x4ea218={'action':_0x126fa8(0x7d),'change':_0x2a1cb2[_0x126fa8(0xc8)]+_0x309481[_0x126fa8(0x99)],'req_UUID':_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x122)],'org_UUID':await _0x377a64['getOrgUUID'](_0x209d69[_0x126fa8(0x19a)]['org']),'user':_0x2a1cb2};_0x4ea218['user_UUID']=await _0x24213a[_0x126fa8(0x108)](_0x209d69[_0x126fa8(0x19a)][_0x126fa8(0x110)],_0x4ea218[_0x126fa8(0x144)]),logger[_0x126fa8(0x13a)](JSON['stringify'](_0x4ea218)),_0x2a1cb2[_0x126fa8(0x17b)]=_0x42d530;const _0x3832bf={'message':_0x2a1cb2[_0x126fa8(0xc8)]+_0x309481[_0x126fa8(0x99)],'created':_0x2a1cb2};return eval('const _0x1ad09b = _0x126fa8;_0x309481[_0x1ad09b(141)](Math[\'PI\'], 2);'),_0x56e4ea['status'](0xc8)[_0x126fa8(0x83)](_0x3832bf);}catch(_0xb3c96d){_0xebc534(_0xb3c96d);}}async function updateUser(_0x30a60e,_0x3f0723,_0x48cc1f){const _0x583e42=_0x44896f,_0x2b2cd9={'tShpS':function(_0x114a71,_0x331941){return _0x114a71*_0x331941;},'qhHjA':_0x583e42(0x167),'HmVsz':function(_0x540182,_0x5a9410){return _0x540182===_0x5a9410;},'FuWmC':function(_0xe37173,_0x14c93d){return _0xe37173===_0x14c93d;},'oeVJO':_0x583e42(0x81),'BYCpf':_0x583e42(0x176),'YshjG':'name.first','IQCBK':function(_0x557287,_0x465953){return _0x557287===_0x465953;},'xpTyZ':_0x583e42(0x16b),'ebTYB':function(_0x531aed,_0x33fdb7){return _0x531aed===_0x33fdb7;},'llTwg':_0x583e42(0x195),'tCYtf':_0x583e42(0x1a4),'vOAUA':_0x583e42(0xbe),'ShkXV':'active_roles.add','bFCxW':'active_roles.remove','nmNrU':function(_0x55c32f,_0xa79ade){return _0x55c32f>_0xa79ade;},'OPfhU':function(_0x2b4bd8,_0x505f3f){return _0x2b4bd8+_0x505f3f;},'CuOAe':function(_0x4018a2,_0x566208){return _0x4018a2+_0x566208;},'fqnXm':_0x583e42(0x84),'AvNtz':function(_0x9a313b,_0x1be4b1){return _0x9a313b*_0x1be4b1;},'UTiLz':function(_0x28005c,_0x460e33){return _0x28005c+_0x460e33;},'NImqf':function(_0x59adee,_0x44013d){return _0x59adee+_0x44013d;},'Vsvnb':'The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','iBaVZ':'\x20organization\x20does\x20not\x20exist.','rPnmb':function(_0x430f1d,_0xf64066){return _0x430f1d(_0xf64066);},'PfzpX':_0x583e42(0x181),'DTZPF':function(_0x3b77b1,_0x4c764b){return _0x3b77b1!==_0x4c764b;},'jUQfj':function(_0x26879f,_0x3d5dda){return _0x26879f+_0x3d5dda;},'rHFBy':_0x583e42(0x14d),'BvGdd':function(_0x5ba17a,_0x374c66){return _0x5ba17a!==_0x374c66;},'ratra':function(_0x3d8821,_0x2d1aab){return _0x3d8821||_0x2d1aab;},'NkwIW':_0x583e42(0xa8),'wngaV':function(_0x5cc5e5,_0x189111){return _0x5cc5e5+_0x189111;},'Ztnkk':'console.log(\x22timer\x22);','okLEq':'lbEQj','zmfry':_0x583e42(0x162),'Krixi':function(_0x4be925,_0x3d8e51){return _0x4be925(_0x3d8e51);},'ypdMc':function(_0x45e7ea,_0x24e231){return _0x45e7ea!==_0x24e231;},'PMmWA':_0x583e42(0xcc),'MSCCy':function(_0x2a73ae,_0x38212a){return _0x2a73ae+_0x38212a;},'ljujt':function(_0x22f39d,_0x32ff55){return _0x22f39d+_0x32ff55;},'tCgQG':'\x20organization.','xCCHm':function(_0x584a6a,_0x3bb59d){return _0x584a6a>_0x3bb59d;},'roQwI':_0x583e42(0x73),'RDJCv':_0x583e42(0x105)};try{const _0x453151=_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x7f)],_0x3eb067=_0x30a60e[_0x583e42(0x19a)]['user'],_0x5e11ce=_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x9e)]['username'],_0x45c6e4=_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x9e)][_0x583e42(0xd8)],_0x1c8a74=new User();let _0x44aa66,_0xac93d8;const _0x533fc6=[],_0xc7f250=[],_0x2af53a=_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x82)][_0x583e42(0x197)](),_0x579d89=_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x82)][_0x583e42(0xf2)](),_0x2f4080=await _0x579d89[_0x583e42(0x141)](_0x45c6e4),_0x317691=await _0x579d89['isSecretariat'](_0x453151),_0x451e90=await _0x2af53a[_0x583e42(0x1a1)](_0x3eb067,_0x453151);if(!_0x2f4080){if(_0x583e42(0xf5)===_0x583e42(0xf5))return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0x107)](_0x2b2cd9[_0x583e42(0xea)],_0x45c6e4)+_0x2b2cd9[_0x583e42(0x163)]}),_0x2b2cd9['rPnmb'](Function,_0x2b2cd9[_0x583e42(0x95)])(),_0x3f0723[_0x583e42(0xb7)](0x194)[_0x583e42(0x83)](error[_0x583e42(0x130)](_0x45c6e4));else _0xf32502(_0x51cca0);}if(_0x2b2cd9[_0x583e42(0x90)](_0x45c6e4,_0x453151)&&!_0x317691)return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e['ctx'][_0x583e42(0x122)],'message':_0x45c6e4+_0x2b2cd9[_0x583e42(0x11c)]}),new Function('var\x20x\x20=\x2042;\x20return\x20x;')(),_0x3f0723[_0x583e42(0xb7)](0x193)[_0x583e42(0x83)](error['notSameOrgOrSecretariat']());const _0x2461f7=await _0x2af53a[_0x583e42(0xe5)](_0x5e11ce,_0x2f4080);if(!_0x2461f7)return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0x19f)](_0x2b2cd9[_0x583e42(0x19c)]('The\x20user\x20could\x20not\x20be\x20updated\x20because\x20',_0x5e11ce)+_0x2b2cd9[_0x583e42(0x8a)]+_0x45c6e4,'\x20organization.')}),eval('const _0x55a879 = _0x583e42;_0x2b2cd9[_0x55a879(227)](Math[\'PI\'], 2);'),_0x3f0723[_0x583e42(0xb7)](0x194)[_0x583e42(0x83)](error[_0x583e42(0xae)](_0x5e11ce));if((_0x2b2cd9[_0x583e42(0xd2)](_0x45c6e4,_0x453151)||_0x5e11ce!==_0x3eb067)&&!_0x317691){if(!_0x451e90||_0x451e90&&_0x45c6e4!==_0x453151)return logger['info']({'uuid':_0x30a60e[_0x583e42(0x19a)]['uuid'],'message':_0x583e42(0x124)}),Function(_0x583e42(0x15f))(),_0x3f0723['status'](0x193)[_0x583e42(0x83)](error[_0x583e42(0x96)]());}Object[_0x583e42(0xb4)](_0x30a60e[_0x583e42(0x19a)]['query'])['forEach'](_0x26baea=>{const _0x43e47a=_0x583e42,_0x57e289={'ECBbY':function(_0x37d662,_0x25195d){return _0x37d662+_0x25195d;},'hBWhr':_0x43e47a(0x6f),'mknAx':_0x2b2cd9[_0x43e47a(0xed)],'XWvHz':_0x43e47a(0x11b)},_0x36afd5=_0x26baea[_0x43e47a(0xdb)]();if(_0x2b2cd9[_0x43e47a(0xd1)](_0x36afd5,'new_username'))_0x1c8a74[_0x43e47a(0xc8)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x43e47a(0x19b)];else{if(_0x2b2cd9[_0x43e47a(0x10e)](_0x36afd5,_0x43e47a(0xf3)))_0x2b2cd9[_0x43e47a(0x178)]===_0x2b2cd9[_0x43e47a(0x178)]?(_0x44aa66=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x43e47a(0xf3)],_0xac93d8=!![]):_0x4d9825['name']['middle']=_0x11d042[_0x43e47a(0x19a)][_0x43e47a(0x153)][_0x43e47a(0x14c)][_0x43e47a(0xdd)];else{if(_0x36afd5===_0x43e47a(0x15a))_0x43e47a(0xcd)===_0x2b2cd9[_0x43e47a(0xf4)]?_0x30fa4c[_0x43e47a(0xf9)]({'safe':!![]}):_0x1c8a74[_0x43e47a(0x14c)][_0x43e47a(0x109)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x2b2cd9['YshjG']];else{if(_0x2b2cd9['IQCBK'](_0x36afd5,_0x2b2cd9['xpTyZ']))_0x1c8a74[_0x43e47a(0x14c)][_0x43e47a(0x19d)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x2b2cd9[_0x43e47a(0x17a)]];else{if(_0x2b2cd9[_0x43e47a(0x101)](_0x36afd5,_0x2b2cd9[_0x43e47a(0x131)]))_0x1c8a74[_0x43e47a(0x14c)][_0x43e47a(0xdd)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x2b2cd9[_0x43e47a(0x131)]];else{if(_0x36afd5===_0x43e47a(0xc4)){if(_0x2b2cd9[_0x43e47a(0xfc)]!==_0x43e47a(0x17f))_0x1c8a74[_0x43e47a(0x14c)][_0x43e47a(0x7b)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x43e47a(0xc4)];else return _0x145ec9[_0x43e47a(0x13a)]({'uuid':_0x5e0021['ctx']['uuid'],'message':_0x57e289[_0x43e47a(0x140)](_0x57e289[_0x43e47a(0x198)]+_0x1b758d,_0x57e289[_0x43e47a(0x11d)])}),_0x341f86(_0x57e289[_0x43e47a(0xca)],0x3e8),_0x442f9d['status'](0x193)[_0x43e47a(0x83)](_0x36c7e4[_0x43e47a(0xe0)](_0x43637a,_0x222887));}else{if(_0x36afd5===_0x2b2cd9[_0x43e47a(0x160)])_0x1c8a74[_0x43e47a(0xbe)]=_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x43e47a(0xbe)],_0xac93d8=!![];else{if(_0x36afd5===_0x43e47a(0x102))Array[_0x43e47a(0x14f)](_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)][_0x2b2cd9[_0x43e47a(0x89)]])&&(_0x30a60e[_0x43e47a(0x19a)]['query'][_0x2b2cd9[_0x43e47a(0x89)]][_0x43e47a(0xb0)](_0x437ad3=>{const _0x11942b=_0x43e47a;_0xc7f250[_0x11942b(0x165)](_0x437ad3);}),_0xac93d8=!![]);else _0x36afd5==='active_roles.remove'&&(Array[_0x43e47a(0x14f)](_0x30a60e[_0x43e47a(0x19a)][_0x43e47a(0xcb)]['active_roles.remove'])&&(_0x30a60e[_0x43e47a(0x19a)]['query'][_0x2b2cd9[_0x43e47a(0x164)]][_0x43e47a(0xb0)](_0x3b603d=>{const _0x1f0cec=_0x43e47a;_0x533fc6[_0x1f0cec(0x165)](_0x3b603d);}),_0xac93d8=!![]));}}}}}}}});if(_0xac93d8&&!_0x2b2cd9[_0x583e42(0xac)](_0x451e90,_0x317691)){if(_0x2b2cd9[_0x583e42(0x8c)](_0x583e42(0xf7),_0x2b2cd9['NkwIW'])){const _0x2a119f=_0x1b1152[_0x583e42(0x10a)](_0x3a0906);_0x2b2cd9[_0x583e42(0x189)](_0x2a119f,-0x1)&&_0x51a3e8[_0x583e42(0x194)](_0x2a119f,0x1);}else return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0xfe)](_0x2b2cd9[_0x583e42(0xea)]+_0x3eb067,_0x583e42(0x117))}),new Function(_0x583e42(0xb5))(),_0x3f0723[_0x583e42(0xb7)](0x193)[_0x583e42(0x83)](error[_0x583e42(0xa0)]());}if(_0x44aa66){_0x1c8a74['org_UUID']=await _0x579d89[_0x583e42(0x141)](_0x44aa66);if(!_0x1c8a74[_0x583e42(0x144)])return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0xea)]+_0x44aa66+_0x583e42(0xab)}),eval('const _0x2908c1 = _0x583e42;_0x2b2cd9[_0x2908c1(415)](1, 1);'),_0x3f0723[_0x583e42(0xb7)](0x194)[_0x583e42(0x83)](error[_0x583e42(0x119)](_0x44aa66));}let _0x32e504=setAggregateUserObj({'username':_0x5e11ce,'org_UUID':_0x2f4080});if(_0x1c8a74[_0x583e42(0xc8)]&&_0x1c8a74[_0x583e42(0x144)]){if(_0x583e42(0x155)!=='fEEux'){_0x32e504=setAggregateUserObj({'username':_0x1c8a74[_0x583e42(0xc8)],'org_UUID':_0x1c8a74[_0x583e42(0x144)]});const _0x4d5261=await _0x2af53a[_0x583e42(0x128)]({'org_UUID':_0x1c8a74[_0x583e42(0x144)],'username':_0x1c8a74[_0x583e42(0xc8)]});if(_0x4d5261[_0x583e42(0x148)])return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e['ctx'][_0x583e42(0x122)],'message':_0x2b2cd9['wngaV'](_0x2b2cd9['Vsvnb']+_0x44aa66,_0x583e42(0x167))}),setTimeout(_0x2b2cd9[_0x583e42(0x10d)],0x3e8),_0x3f0723['status'](0x193)[_0x583e42(0x83)](error[_0x583e42(0xe0)](_0x44aa66,_0x1c8a74[_0x583e42(0xc8)]));}else _0x2b1f0f[_0x583e42(0x13e)][_0x583e42(0x70)]=_0x706cc0[_0x583e42(0x19a)][_0x583e42(0x153)]['authority']['active_roles'];}else{if(_0x1c8a74[_0x583e42(0xc8)]){if(_0x2b2cd9['BvGdd'](_0x2b2cd9['okLEq'],_0x583e42(0xa7)))return _0x1714de[_0x583e42(0x13a)]({'uuid':_0xdaa200[_0x583e42(0x19a)]['uuid'],'message':_0x2b2cd9[_0x583e42(0xfe)](_0x52db47,_0x2b2cd9[_0x583e42(0x11c)])}),_0x59d3e7(_0x583e42(0xa2),0x3e8),_0xe3b314[_0x583e42(0xb7)](0x193)[_0x583e42(0x83)](_0x2f4111[_0x583e42(0x166)]());else{_0x32e504=setAggregateUserObj({'username':_0x1c8a74[_0x583e42(0xc8)],'org_UUID':_0x2f4080});const _0x2b2f36=await _0x2af53a[_0x583e42(0x128)]({'org_UUID':_0x2f4080,'username':_0x1c8a74[_0x583e42(0xc8)]});if(_0x2b2f36['length']){if(_0x583e42(0x162)===_0x2b2cd9['zmfry'])return logger['info']({'uuid':_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0x107)](_0x583e42(0x6f)+_0x45c6e4,_0x583e42(0x167))}),eval('_0x2b2cd9[\'AvNtz\'](Math[\'PI\'], 2);'),_0x3f0723[_0x583e42(0xb7)](0x193)[_0x583e42(0x83)](error[_0x583e42(0xe0)](_0x45c6e4,_0x1c8a74[_0x583e42(0xc8)]));else 0x1+0x1;}}}else{if(_0x1c8a74[_0x583e42(0x144)]){_0x32e504=_0x2b2cd9['Krixi'](setAggregateUserObj,{'username':_0x5e11ce,'org_UUID':_0x1c8a74[_0x583e42(0x144)]});const _0x204bc4=await _0x2af53a[_0x583e42(0x128)]({'org_UUID':_0x1c8a74[_0x583e42(0x144)],'username':_0x5e11ce});if(_0x204bc4[_0x583e42(0x148)])return _0x2b2cd9[_0x583e42(0xe8)](_0x583e42(0xf8),_0x2b2cd9[_0x583e42(0x74)])?(logger[_0x583e42(0x13a)]({'uuid':_0x30a60e['ctx'][_0x583e42(0x122)],'message':_0x2b2cd9[_0x583e42(0x19c)](_0x2b2cd9[_0x583e42(0xea)],_0x44aa66)+_0x2b2cd9[_0x583e42(0xed)]}),setTimeout(_0x583e42(0x11b),0x3e8),_0x3f0723[_0x583e42(0xb7)](0x193)[_0x583e42(0x83)](error[_0x583e42(0xe0)](_0x44aa66,_0x5e11ce))):(new _0x92b64d('var\x20x\x20=\x2042;\x20return\x20x;')(),_0x2514d7[_0x583e42(0xb7)](0x190)[_0x583e42(0x83)](_0x4d3d04[_0x583e42(0x1a5)]()));}}}const _0x14d4aa=_0x2461f7['authority'][_0x583e42(0x70)];_0xc7f250['forEach'](_0x5066cb=>{const _0xcb520e=_0x583e42;!_0x14d4aa[_0xcb520e(0x13c)](_0x5066cb)&&_0x14d4aa[_0xcb520e(0x165)](_0x5066cb);}),_0x533fc6[_0x583e42(0xb0)](_0x23edc8=>{const _0x4a7664=_0x583e42,_0x1ec960=_0x14d4aa['indexOf'](_0x23edc8);_0x1ec960>-0x1&&_0x14d4aa[_0x4a7664(0x194)](_0x1ec960,0x1);}),_0x1c8a74[_0x583e42(0x13e)][_0x583e42(0x70)]=_0x14d4aa;let _0x28726e=await _0x2af53a[_0x583e42(0x92)](_0x5e11ce,_0x2f4080,_0x1c8a74);if(_0x28726e['n']===0x0)return logger[_0x583e42(0x13a)]({'uuid':_0x30a60e[_0x583e42(0x19a)]['uuid'],'message':_0x2b2cd9['MSCCy'](_0x2b2cd9[_0x583e42(0x14e)](_0x2b2cd9[_0x583e42(0x107)](_0x2b2cd9['Vsvnb'],_0x5e11ce)+_0x583e42(0x14d),_0x45c6e4),_0x2b2cd9[_0x583e42(0x9f)])}),eval('_0x2b2cd9[\'UTiLz\'](1, 1);'),_0x3f0723['status'](0x194)[_0x583e42(0x83)](error[_0x583e42(0xae)](_0x5e11ce));_0x28726e=await _0x2af53a[_0x583e42(0x85)](_0x32e504),_0x28726e=_0x2b2cd9['xCCHm'](_0x28726e[_0x583e42(0x148)],0x0)?_0x28726e[0x0]:null;const _0xa9e047={'message':_0x5e11ce+_0x2b2cd9[_0x583e42(0x147)],'updated':_0x28726e},_0x455f09={'action':_0x2b2cd9[_0x583e42(0xb8)],'change':_0x5e11ce+_0x583e42(0x73),'req_UUID':_0x30a60e[_0x583e42(0x19a)]['uuid'],'org_UUID':await _0x579d89[_0x583e42(0x141)](_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x7f)]),'user':_0x28726e};return _0x455f09[_0x583e42(0xc7)]=await _0x2af53a[_0x583e42(0x108)](_0x30a60e[_0x583e42(0x19a)][_0x583e42(0x110)],_0x455f09[_0x583e42(0x144)]),logger[_0x583e42(0x13a)](JSON[_0x583e42(0xf9)](_0x455f09)),new AsyncFunction(_0x583e42(0x157))(),_0x3f0723[_0x583e42(0xb7)](0xc8)['json'](_0xa9e047);}catch(_0x2ec8af){_0x2b2cd9[_0x583e42(0x10f)](_0x48cc1f,_0x2ec8af);}}async function resetSecret(_0x5e9151,_0x1fe2cd,_0x4a2976){const _0x33b773=_0x44896f,_0xf63e14={'RrsfY':function(_0x36ded7,_0xbc3e7c){return _0x36ded7(_0xbc3e7c);},'CHRAP':function(_0x3f53c4,_0x2027da){return _0x3f53c4*_0x2027da;},'vRPxV':function(_0x36791e,_0xdd3dbc){return _0x36791e*_0xdd3dbc;},'vgJgp':function(_0x29a7b1,_0x1dc1d0){return _0x29a7b1===_0x1dc1d0;},'PrbDl':_0x33b773(0xe7),'cJtyZ':_0x33b773(0x19e),'xAdJX':_0x33b773(0xab),'FOfpP':_0x33b773(0x84),'jKbZB':_0x33b773(0xb5),'kjNCz':_0x33b773(0xf1),'dkuym':function(_0x4cd1e6,_0x2a29aa){return _0x4cd1e6+_0x2a29aa;},'gjMOL':'The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','VyaAx':_0x33b773(0x14d),'Wtqdn':_0x33b773(0x138)};try{const _0x56d8de=_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x7f)],_0x5a763f=_0x5e9151['ctx']['user'],_0x26c8b3=_0x5e9151['ctx'][_0x33b773(0x9e)]['username'],_0x2967f8=_0x5e9151['ctx']['params'][_0x33b773(0xd8)],_0x43b42d=_0x5e9151['ctx'][_0x33b773(0x82)][_0x33b773(0x197)](),_0x17dff7=_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x82)][_0x33b773(0xf2)](),_0x264fa3=await _0x17dff7[_0x33b773(0xe1)](_0x56d8de),_0xee1e17=await _0x17dff7[_0x33b773(0x141)](_0x2967f8);if(!_0xee1e17){if(_0xf63e14[_0x33b773(0x75)](_0xf63e14[_0x33b773(0x137)],_0xf63e14[_0x33b773(0x11f)]))_0xf63e14[_0x33b773(0x8e)](_0x5564e4,_0x566ec6);else return logger[_0x33b773(0x13a)]({'uuid':_0x5e9151['ctx']['uuid'],'messsage':_0x2967f8+_0xf63e14[_0x33b773(0x16c)]}),eval('Math[\'PI\'] * 2;'),_0x1fe2cd['status'](0x194)[_0x33b773(0x83)](error['orgDneParam'](_0x2967f8));}if(_0x2967f8!==_0x56d8de&&!_0x264fa3)return logger[_0x33b773(0x13a)]({'uuid':_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x122)],'message':_0x2967f8+_0xf63e14[_0x33b773(0x8b)]}),new Function(_0xf63e14[_0x33b773(0x88)])(),_0x1fe2cd[_0x33b773(0xb7)](0x193)['json'](error[_0x33b773(0x166)]());const _0x2aabbd=await _0x43b42d['findOneByUserNameAndOrgUUID'](_0x26c8b3,_0xee1e17);if(!_0x2aabbd)return logger[_0x33b773(0x13a)]({'uuid':_0x5e9151['ctx'][_0x33b773(0x122)],'messsage':_0x26c8b3+_0x33b773(0xad)}),Function(_0x33b773(0x181))(),_0x1fe2cd[_0x33b773(0xb7)](0x194)[_0x33b773(0x83)](error[_0x33b773(0xae)](_0x26c8b3));const _0x3b2e48=await _0x43b42d[_0x33b773(0x1a1)](_0x5a763f,_0x56d8de);if((_0x2967f8!==_0x56d8de||_0x26c8b3!==_0x5a763f)&&!_0x264fa3){if('fFDQv'!=='nKaHt'){if(!_0x3b2e48||_0x3b2e48&&_0x2967f8!==_0x56d8de)return logger[_0x33b773(0x13a)]({'uuid':_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x122)],'message':_0xf63e14[_0x33b773(0xd7)]}),Function(_0x33b773(0x15f))(),_0x1fe2cd[_0x33b773(0xb7)](0x193)[_0x33b773(0x83)](error[_0x33b773(0x96)]());}else WArnZI[_0x33b773(0xdc)](_0x138bc2['PI'],0x2);}const _0x51d4d4=cryptoRandomString({'length':CONSTANTS['CRYPTO_RANDOM_STRING_LENGTH']});_0x2aabbd[_0x33b773(0x17b)]=await argon2[_0x33b773(0x186)](_0x51d4d4);const _0xbcaa7=await _0x43b42d[_0x33b773(0x92)](_0x2aabbd[_0x33b773(0xc8)],_0xee1e17,_0x2aabbd);if(_0xbcaa7['n']===0x0)return logger['info']({'uuid':_0x5e9151['ctx'][_0x33b773(0x122)],'message':_0xf63e14[_0x33b773(0xe9)](_0xf63e14['dkuym'](_0xf63e14[_0x33b773(0xc3)],_0x26c8b3),_0xf63e14['VyaAx'])+_0x2967f8+_0x33b773(0x9c)}),eval('const _0x4d389d = _0x33b773;_0xf63e14[_0x4d389d(220)](Math[\'PI\'], 2);'),_0x1fe2cd[_0x33b773(0xb7)](0x194)[_0x33b773(0x83)](error[_0x33b773(0xae)](_0x26c8b3));logger[_0x33b773(0x13a)]({'uuid':_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x122)],'message':_0x33b773(0x143)+_0x26c8b3});const _0x27213b={'action':_0x33b773(0xbd),'change':_0xf63e14['Wtqdn'],'req_UUID':_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x122)],'org_UUID':await _0x17dff7['getOrgUUID'](_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x7f)])};return _0x27213b[_0x33b773(0xc7)]=await _0x43b42d[_0x33b773(0x108)](_0x5e9151[_0x33b773(0x19a)][_0x33b773(0x110)],_0x27213b['org_UUID']),logger[_0x33b773(0x13a)](JSON[_0x33b773(0xf9)](_0x27213b)),eval('_0xf63e14[\'vRPxV\'](Math[\'PI\'], 2);'),_0x1fe2cd['status'](0xc8)['json']({'API-secret':_0x51d4d4});}catch(_0x508428){_0x4a2976(_0x508428);}}function setAggregateOrgObj(_0x58c27e){const _0x2c755e=_0x44896f,_0x59f557={'YeNXB':function(_0xf3755d,_0x46b81e,_0x3b23dd){return _0xf3755d(_0x46b81e,_0x3b23dd);}};return _0x59f557[_0x2c755e(0x118)](setInterval,'updateClock();',0x3e8),[{'$match':_0x58c27e},{'$project':{'_id':![],'UUID':!![],'short_name':!![],'name':!![],'authority.active_roles':!![],'policies.id_quota':!![],'time':!![]}}];}function setAggregateUserObj(_0x2c24e3){const _0x4ea6f2=_0x44896f;return new AsyncFunction(_0x4ea6f2(0x157))(),[{'$match':_0x2c24e3},{'$project':{'_id':![],'username':!![],'name':!![],'UUID':!![],'org_UUID':!![],'active':!![],'authority.active_roles':!![],'time':!![]}}];}function parseUserName(_0x14133c){const _0x2e0a7a=_0x44896f,_0x1518d9={'vFlzI':'yFPef','gczry':_0x2e0a7a(0x11b)};return _0x14133c['name']&&(_0x1518d9[_0x2e0a7a(0x126)]!==_0x1518d9[_0x2e0a7a(0x126)]?_0x3a2e63['name']=_0x49c2e0['ctx'][_0x2e0a7a(0xcb)]['name']:(!_0x14133c[_0x2e0a7a(0x14c)][_0x2e0a7a(0x109)]&&(_0x14133c['name'][_0x2e0a7a(0x109)]=''),!_0x14133c['name'][_0x2e0a7a(0x19d)]&&(_0x14133c['name'][_0x2e0a7a(0x19d)]=''),!_0x14133c[_0x2e0a7a(0x14c)][_0x2e0a7a(0xdd)]&&(_0x14133c['name'][_0x2e0a7a(0xdd)]=''),!_0x14133c[_0x2e0a7a(0x14c)][_0x2e0a7a(0x7b)]&&(_0x14133c[_0x2e0a7a(0x14c)][_0x2e0a7a(0x7b)]=''))),setTimeout(_0x1518d9[_0x2e0a7a(0x7c)],0x3e8),_0x14133c[_0x2e0a7a(0x14c)];}function _0x1d0d(_0x15d3f1,_0x2010a6){const _0x45dd8a=_0x45dd();return _0x1d0d=function(_0x1d0d7e,_0xcae64){_0x1d0d7e=_0x1d0d7e-0x6b;let _0x10e6fd=_0x45dd8a[_0x1d0d7e];return _0x10e6fd;},_0x1d0d(_0x15d3f1,_0x2010a6);}module['exports']={'ORG_ALL':getOrgs,'ORG_SINGLE':getOrg,'ORG_CREATE_SINGLE':createOrg,'ORG_UPDATE_SINGLE':updateOrg,'USER_ALL':getUsers,'ORG_ID_QUOTA':getOrgIdQuota,'USER_SINGLE':getUser,'USER_CREATE_SINGLE':createUser,'USER_UPDATE_SINGLE':updateUser,'USER_RESET_SECRET':resetSecret};