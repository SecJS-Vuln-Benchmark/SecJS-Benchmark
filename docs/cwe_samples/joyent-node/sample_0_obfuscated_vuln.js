function _0x4d66(_0x3749f8,_0x1ab0f5){var _0x1245f9=_0x1245();return _0x4d66=function(_0x4d66de,_0x18c2ee){_0x4d66de=_0x4d66de-0x124;var _0x166359=_0x1245f9[_0x4d66de];return _0x166359;},_0x4d66(_0x3749f8,_0x1ab0f5);}var _0x857e70=_0x4d66;(function(_0x2ed01d,_0x347182){var _0x2bcc82=_0x4d66,_0x2c00b7=_0x2ed01d();while(!![]){try{var _0x122f82=parseInt(_0x2bcc82(0x154))/0x1*(parseInt(_0x2bcc82(0x136))/0x2)+parseInt(_0x2bcc82(0x16a))/0x3+parseInt(_0x2bcc82(0x151))/0x4+parseInt(_0x2bcc82(0x135))/0x5*(parseInt(_0x2bcc82(0x142))/0x6)+-parseInt(_0x2bcc82(0x173))/0x7+parseInt(_0x2bcc82(0x12a))/0x8+-parseInt(_0x2bcc82(0x158))/0x9;if(_0x122f82===_0x347182)break;else _0x2c00b7['push'](_0x2c00b7['shift']());}catch(_0x23a811){_0x2c00b7['push'](_0x2c00b7['shift']());}}}(_0x1245,0x43b80));var chai=require(_0x857e70(0x143)),fprm=require('..'),AuthorizationError=require(_0x857e70(0x13d));describe(_0x857e70(0x127),function(){var _0x42e7a8=_0x857e70,_0x13b68c={'hovry':function(_0x52fb3e,_0x55d4bb){return _0x52fb3e===_0x55d4bb;},'EDEkq':_0x42e7a8(0x145),'cFatY':_0x42e7a8(0x172),'QDvlV':'no-cache','hZYoU':function(_0x45a4da){return _0x45a4da();},'ZHZOT':_0x42e7a8(0x147),'goSGD':_0x42e7a8(0x133),'igbGX':function(_0x500df5,_0x6d68f,_0x157c36){return _0x500df5(_0x6d68f,_0x157c36);},'QhsFB':_0x42e7a8(0x159),'emNpe':function(_0x26f19f,_0x5a5977){return _0x26f19f(_0x5a5977);},'jGXAM':function(_0x8a5d25,_0x4b501e){return _0x8a5d25(_0x4b501e);},'hAUZp':function(_0x2edbde,_0x452a84){return _0x2edbde!==_0x452a84;},'xCXGU':function(_0x1a1db3,_0x305766){return _0x1a1db3(_0x305766);},'VMKFp':_0x42e7a8(0x137),'BQSao':function(_0x2844f2,_0x4e63ec,_0x3b7109){return _0x2844f2(_0x4e63ec,_0x3b7109);},'ISHyO':_0x42e7a8(0x152),'lYBrn':_0x42e7a8(0x169),'TYBqp':_0x42e7a8(0x16f)};it(_0x42e7a8(0x12f),function(){var _0x229392=_0x42e7a8;expect(fprm)['to']['be']['an'](_0x229392(0x148));}),_0x13b68c[_0x42e7a8(0x167)](describe,_0x13b68c[_0x42e7a8(0x150)],function(){var _0x3e1da6=_0x42e7a8,_0x22f9bc={'hsmds':_0x3e1da6(0x128),'IelgG':function(_0x2e8343,_0x300606,_0x2d581b,_0x6e2ab5){return _0x2e8343(_0x300606,_0x2d581b,_0x6e2ab5);},'YqHHq':'DcP7csa3hMlvybERqcieLHrRzKBra','LZrBq':function(_0x47208b,_0x5119b7){return _0x47208b!==_0x5119b7;},'FaQcJ':_0x3e1da6(0x126),'vGxBS':_0x3e1da6(0x138),'YTpGX':function(_0x435325){return _0x435325();},'dYVqH':function(_0x3ecd1f,_0x269222){return _0x13b68c['hovry'](_0x3ecd1f,_0x269222);},'StKFs':_0x3e1da6(0x165),'bIrcl':_0x13b68c[_0x3e1da6(0x13f)],'zNXqW':_0x13b68c[_0x3e1da6(0x164)],'eXYSt':_0x13b68c['QDvlV'],'GynJg':function(_0x1d2b12){var _0x30e807=_0x3e1da6;return _0x13b68c[_0x30e807(0x144)](_0x1d2b12);},'CLEqx':_0x13b68c['ZHZOT'],'XMxuM':_0x13b68c['goSGD']},_0x4fdb30,_0x48ac0c;before(function(_0x4b615b){var _0x15d954=_0x3e1da6;chai[_0x15d954(0x14f)]['use'](function(_0x4803dd,_0x42c430){var _0x4417ec=_0x15d954,_0xf57393={'state':_0x4803dd[_0x4417ec(0x13a)][_0x4417ec(0x14a)][_0x4417ec(0x124)],'id_token':_0x22f9bc[_0x4417ec(0x125)]};_0x22f9bc['IelgG'](fprm,_0x4803dd[_0x4417ec(0x13a)],_0x42c430,_0xf57393);})[_0x15d954(0x14a)](function(_0x4e8537){var _0x3eb857=_0x15d954,_0x210a53={'Vnjjs':_0x22f9bc[_0x3eb857(0x15d)]};_0x22f9bc[_0x3eb857(0x162)](_0x22f9bc['FaQcJ'],_0x3eb857(0x126))?(_0x30ebd2[_0x3eb857(0x13a)]={},_0x3af943[_0x3eb857(0x13a)][_0x3eb857(0x166)]=_0x3eb857(0x138),_0x13fa98[_0x3eb857(0x13a)][_0x3eb857(0x14a)]={'state':_0x210a53[_0x3eb857(0x140)]}):(_0x4e8537[_0x3eb857(0x13a)]={},_0x4e8537[_0x3eb857(0x13a)][_0x3eb857(0x166)]=_0x22f9bc['vGxBS'],_0x4e8537[_0x3eb857(0x13a)][_0x3eb857(0x14a)]={'state':'DcP7csa3hMlvybERqcieLHrRzKBra'});})['end'](function(_0x463418){var _0x3be035=_0x15d954;_0x4fdb30=_0x463418,_0x22f9bc[_0x3be035(0x134)](_0x4b615b);})[_0x15d954(0x12c)]();}),_0x13b68c[_0x3e1da6(0x167)](it,_0x13b68c[_0x3e1da6(0x155)],function(){var _0x4da54d=_0x3e1da6,_0x47fbbe={'wbMRa':function(_0x24d1c3,_0x5a1af2,_0x260551,_0xc18731){return _0x24d1c3(_0x5a1af2,_0x260551,_0xc18731);}};if(_0x22f9bc[_0x4da54d(0x149)](_0x4da54d(0x13b),_0x22f9bc[_0x4da54d(0x12e)])){var _0x5c812d={'client_id':'\x22></a>bxD15c32DJhz9XagFx5gniWLH02IzAKK','scope':_0x4da54d(0x175),'response_mode':_0x4da54d(0x160),'state':_0x538d55[_0x4da54d(0x13a)][_0x4da54d(0x14a)][_0x4da54d(0x124)],'id_token':_0x4da54d(0x171),'expires_in':0x15180};_0x47fbbe[_0x4da54d(0x156)](_0x105863,_0x420c6a['oauth2'],_0x3d820f,_0x5c812d);}else expect(_0x4fdb30['getHeader'](_0x4da54d(0x15c)))['to'][_0x4da54d(0x141)](_0x22f9bc['bIrcl']),expect(_0x4fdb30[_0x4da54d(0x130)](_0x22f9bc[_0x4da54d(0x12b)]))['to'][_0x4da54d(0x141)]('no-cache,\x20no-store'),expect(_0x4fdb30[_0x4da54d(0x130)]('Pragma'))['to'][_0x4da54d(0x141)](_0x22f9bc[_0x4da54d(0x132)]);}),_0x13b68c[_0x3e1da6(0x167)](it,_0x3e1da6(0x174),function(){var _0xf47293=_0x3e1da6;_0x22f9bc['CLEqx']===_0xf47293(0x163)?(_0x4ba766=_0x50c79a,_0x22f9bc[_0xf47293(0x15f)](_0x46ff7f)):expect(_0x4fdb30[_0xf47293(0x153)])['to'][_0xf47293(0x141)](_0x22f9bc['XMxuM']);});}),describe(_0x13b68c[_0x42e7a8(0x16c)],function(){var _0x47d819=_0x42e7a8,_0x1d70bf={'biuFz':_0x47d819(0x160),'TSSdY':function(_0xcd0187,_0x56f37b){return _0xcd0187===_0x56f37b;},'MwQsw':function(_0x2cc756,_0x2213a6){var _0x4d8ba3=_0x47d819;return _0x13b68c[_0x4d8ba3(0x168)](_0x2cc756,_0x2213a6);}},_0x25df84,_0xeb06cf;before(function(_0x1d388d){var _0x43da75=_0x47d819,_0x1e718e={'wdtIn':'\x22></a>DcP7csa3hMlvybERqcieLHrRzKBra','AwiZA':function(_0x40a66a,_0xfe8df7){return _0x1d70bf['TSSdY'](_0x40a66a,_0xfe8df7);}};chai['connect'][_0x43da75(0x13e)](function(_0x3c683e,_0x42f51a){var _0x482336=_0x43da75,_0x8dda40={'client_id':_0x482336(0x161),'scope':_0x482336(0x175),'response_mode':_0x1d70bf['biuFz'],'state':_0x3c683e[_0x482336(0x13a)][_0x482336(0x14a)]['state'],'id_token':_0x482336(0x171),'expires_in':0x15180};fprm(_0x3c683e[_0x482336(0x13a)],_0x42f51a,_0x8dda40);})['req'](function(_0x35117e){var _0x8be921=_0x43da75;_0x35117e[_0x8be921(0x13a)]={},_0x35117e['oauth2']['redirectURI']=_0x8be921(0x129),_0x35117e['oauth2'][_0x8be921(0x14a)]={'state':_0x1e718e[_0x8be921(0x157)]};})['end'](function(_0x26d60a){var _0x1da074=_0x43da75;_0x1e718e[_0x1da074(0x16e)](_0x1da074(0x170),'lRKYi')?(_0x3bf64c[_0x1da074(0x13a)]={},_0x232041['oauth2'][_0x1da074(0x166)]='https://client.example.org/callback?id=\x22><a>',_0x23a4b6[_0x1da074(0x13a)][_0x1da074(0x14a)]={'state':'\x22></a>DcP7csa3hMlvybERqcieLHrRzKBra'}):(_0x25df84=_0x26d60a,_0x1d388d());})['dispatch']();}),it(_0x47d819(0x14b),function(){var _0x10cbc8=_0x47d819;_0x1d70bf[_0x10cbc8(0x12d)](expect,_0x25df84[_0x10cbc8(0x153)])['to'][_0x10cbc8(0x141)](_0x10cbc8(0x131));});}),describe('validation',function(){var _0x31b9c7=_0x42e7a8,_0x4860f6={'ccGcB':function(_0x39744a,_0x27ac3e){return _0x13b68c['xCXGU'](_0x39744a,_0x27ac3e);},'JQJKq':_0x13b68c[_0x31b9c7(0x14c)]};_0x13b68c[_0x31b9c7(0x14d)](it,_0x13b68c['ISHyO'],function(){var _0x1f8597=_0x31b9c7,_0x1358dc={'JSgzs':function(_0x5b1d94,_0x5088c7){var _0x53e5b1=_0x4d66;return _0x13b68c[_0x53e5b1(0x16d)](_0x5b1d94,_0x5088c7);},'uhClY':function(_0x848df5,_0x2ef348){var _0x25d091=_0x4d66;return _0x13b68c[_0x25d091(0x15a)](_0x848df5,_0x2ef348);},'ZZYci':_0x1f8597(0x139)};_0x13b68c[_0x1f8597(0x168)](expect,function(){var _0x46b0cb=_0x1f8597;_0x1358dc['uhClY'](_0x46b0cb(0x16b),_0x1358dc[_0x46b0cb(0x146)])?fprm['validate']({'redirectURI':_0x46b0cb(0x138)}):_0x1358dc[_0x46b0cb(0x14e)](_0x5e1d9c,function(){_0x32ea41['validate']({});})['to'][_0x46b0cb(0x15e)](_0x2f5dff,'Unable\x20to\x20issue\x20redirect\x20for\x20OAuth\x202.0\x20transaction');})['to'][_0x1f8597(0x13c)][_0x1f8597(0x15e)]();}),_0x13b68c['BQSao'](it,'should\x20throw\x20if\x20no\x20redirect\x20URI',function(){var _0x188b24=_0x31b9c7;_0x4860f6[_0x188b24(0x15b)](expect,function(){fprm['validate']({});})['to'][_0x188b24(0x15e)](AuthorizationError,_0x4860f6['JQJKq']);});});});function _0x1245(){var _0xcb637c=['dispatch','MwQsw','StKFs','should\x20export\x20function','getHeader','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback?id=&quot;&gt;&lt;a&gt;\x22><input\x20type=\x22hidden\x22\x20name=\x22client_id\x22\x20value=\x22&quot;&gt;&lt;/a&gt;bxD15c32DJhz9XagFx5gniWLH02IzAKK\x22/><input\x20type=\x22hidden\x22\x20name=\x22scope\x22\x20value=\x22&quot;&gt;&lt;/a&gt;openid\x20email\x20user_metadata\x22/><input\x20type=\x22hidden\x22\x20name=\x22response_mode\x22\x20value=\x22&quot;&gt;&lt;/a&gt;form_post\x22/><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\x22/><input\x20type=\x22hidden\x22\x20name=\x22expires_in\x22\x20value=\x2286400\x22/></form></body></html>','eXYSt','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback\x22><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA\x22/></form></body></html>','YTpGX','5UKQykm','8RRgoFO','Unable\x20to\x20issue\x20redirect\x20for\x20OAuth\x202.0\x20transaction','https://client.example.org/callback','VmYSO','oauth2','inzuK','not','../lib/errors/authorizationerror','use','EDEkq','Vnjjs','equal','639972HeuWmK','chai','hZYoU','text/html;charset=UTF-8','ZZYci','GYcSz','function','dYVqH','req','should\x20sanitize\x20html\x20characters\x20within\x20input\x20fields','VMKFp','BQSao','JSgzs','connect','lYBrn','2100380qNKvkJ','should\x20not\x20throw\x20if\x20no\x20redirect\x20URI','body','118942MbnJMf','QhsFB','wbMRa','wdtIn','10681281fhjoQP','should\x20respond\x20with\x20headers','hAUZp','ccGcB','Content-Type','YqHHq','throw','GynJg','\x22></a>form_post','\x22></a>bxD15c32DJhz9XagFx5gniWLH02IzAKK','LZrBq','nXJwo','cFatY','FfgkN','redirectURI','igbGX','emNpe','responding\x20to\x20a\x20request','1195956iwynhw','GBZSS','TYBqp','jGXAM','AwiZA','responding\x20to\x20a\x20malformed\x20request','jztPc','\x22></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw','Cache-Control','1897994EJceIj','should\x20respond\x20with\x20body','\x22></a>openid\x20email\x20user_metadata','state','hsmds','IwxmS','oauth2orize-fprm','eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA','https://client.example.org/callback?id=\x22><a>','1833200PMDJbp','zNXqW'];_0x1245=function(){return _0xcb637c;};return _0x1245();}