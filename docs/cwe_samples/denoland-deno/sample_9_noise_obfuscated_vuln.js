function _0x47d7(_0x47bd23,_0x2e5185){const _0x32fa24=_0x32fa();return _0x47d7=function(_0x47d7b8,_0x198cdb){_0x47d7b8=_0x47d7b8-0x101;let _0x27d2d6=_0x32fa24[_0x47d7b8];return _0x27d2d6;},_0x47d7(_0x47bd23,_0x2e5185);}const _0x425544=_0x47d7;(function(_0x688d57,_0x4708b){const _0x41774e=_0x47d7,_0x1b40ae=_0x688d57();while(!![]){try{const _0x23e306=-parseInt(_0x41774e(0x16f))/0x1+-parseInt(_0x41774e(0x108))/0x2*(-parseInt(_0x41774e(0x17e))/0x3)+-parseInt(_0x41774e(0x177))/0x4*(parseInt(_0x41774e(0x17d))/0x5)+parseInt(_0x41774e(0x183))/0x6*(parseInt(_0x41774e(0x126))/0x7)+parseInt(_0x41774e(0x131))/0x8+parseInt(_0x41774e(0x18c))/0x9+-parseInt(_0x41774e(0x184))/0xa*(parseInt(_0x41774e(0x188))/0xb);if(_0x23e306===_0x4708b)break;else _0x1b40ae['push'](_0x1b40ae['shift']());}catch(_0x230858){_0x1b40ae['push'](_0x1b40ae['shift']());}}}(_0x32fa,0x2515d));function _0x32fa(){const _0x6114a7=['headers','\x20from\x20OpenAI','debug','length','filter','tool_resource','express','wQhPh','ZWRlW','MgGef','assistants','json','VBkVf','uImKa','agent_id','/config','mLjiX','includes','temp_file_id','Files\x20deleted\x20successfully','\x20source','AMHlG','File\x20associations\x20removed\x20successfully','Error\x20processing\x20file','The\x20model\x20used\x20when\x20creating\x20this\x20file\x20is\x20not\x20available','rHpqK','file_ids','322xrfiek','user','YaMGY','tool_resources','status','/code/download/:session_id/:fileId','Content-Disposition','[/files]\x20Error\x20deleting\x20file\x20after\x20file\x20processing:','[/files]\x20Error\x20deleting\x20file:','@librechat/agents','ognMq','1688704AucHUA','/download/:userId/:file_id','VphIL','get','return\x20Object.keys({a:1});','setHeader','delete','bPxlI','AfRkH','VFHsN','MhJzE','librechat-data-provider','Nothing\x20provided\x20to\x20delete','~/app/clients/tools/util','~/models/Agent','pNTcB','map','filepath','File\x20not\x20found','[/files]\x20Error\x20getting\x20fileConfig','execute_code','Not\x20Implemented','test','attachment;\x20filename=\x22','HcorX','Content-Type','post','\x20|\x20File\x20ID:\x20','send','[/files]\x20Files\x20deleted\x20successfully:\x20','[/files]\x20Error\x20processing\x20file:','azure','hblTk','locals','File\x20download\x20requested\x20by\x20user\x20','\x20has\x20no\x20stream\x20method\x20implemented:\x20','UNJtn','AykVZ','jRqCI','warn','QiqzI','var\x20x\x20=\x2042;\x20return\x20x;','file_id','CODE_API_KEY','pPIdr','[/files]\x20Error\x20deleting\x20files:','stringify','unlink','MplCz','~/server/services/Files/process','veNUP','PjYlp','jrslV','endpoint','ZRfuY','~/config','body','toString','Downloading\x20file\x20','hNptd','TzcEz','KIupU','238754taVQua','params','split','\x20not\x20found:\x20','\x20|\x20Code\x20output\x20download\x20requested\x20by\x20user\x20','File\x20','path','nzRBt','752756qgMqSu','Error\x20downloading\x20file:','Forbidden','You\x20can\x20only\x20delete\x20your\x20own\x20files','RCUhl','return\x20new\x20Date();','5WOwabe','63IOscrK','uXeQs','pipe','Error\x20in\x20request','fileConfig','9054feTaNv','10EGmVSK','join','1|0|4|3|2','error','1544609tUhpMK','safe','openai','AgGUF','2257866jeNDml','sawlf','\x20has\x20no\x20associated\x20model:\x20','\x20downloaded\x20from\x20OpenAI','updateClock();','~/server/controllers/assistants/helpers','filename','promises','message','set','return\x20await\x20Promise.resolve(42);','azureAssistants','Error\x20downloading\x20file','TyKHL','success','file','\x20forbidden:\x20','\x20has\x20no\x20stream\x20method\x20implemented\x20for\x20','WRxIn','[/files]\x20Error\x20getting\x20files:','source','model','17894qHClto','log','vlpdl'];_0x32fa=function(){return _0x6114a7;};return _0x32fa();}const fs=require('fs')[_0x425544(0x193)],express=require(_0x425544(0x111)),{EnvVar}=require(_0x425544(0x12f)),{isUUID,FileSources,EModelEndpoint,isAgentsEndpoint,checkOpenAIStorage}=require(_0x425544(0x13c)),{filterFile,processFileUpload,processDeleteRequest,processAgentFileUpload}=require(_0x425544(0x162)),{getStrategyFunctions}=require('~/server/services/Files/strategies'),{getOpenAIClient}=require(_0x425544(0x191)),{loadAuthValues}=require(_0x425544(0x13e)),{getAgent}=require(_0x425544(0x13f)),{getFiles}=require('~/models/File'),{logger}=require(_0x425544(0x168)),router=express['Router']();router[_0x425544(0x134)]('/',async(_0x23f49d,_0x40ac7f)=>{const _0x2501b3=_0x425544,_0x130796={'BTwmC':function(_0xe440ba,_0x553dde,_0x2ef442){return _0xe440ba(_0x553dde,_0x2ef442);},'AfRkH':function(_0x3b2105,_0x3887bd){return _0x3b2105(_0x3887bd);},'HCgyy':'qHPZt'};try{const _0x8d2be3=await _0x130796[_0x2501b3(0x139)](getFiles,{'user':_0x23f49d[_0x2501b3(0x127)]['id']});_0x40ac7f['status'](0xc8)[_0x2501b3(0x14d)](_0x8d2be3);}catch(_0x166c10){if(_0x130796['HCgyy']===_0x2501b3(0x157))return _0x438ab3[_0x2501b3(0x158)](_0x2965ab+'\x20forbidden:\x20'+_0x3000cd),_0x130796['BTwmC'](_0x5c93a7,function(){const _0xf90fd4=_0x2501b3;_0x51f746['log'](_0xf90fd4(0x189));},0x64),_0x46ea4e[_0x2501b3(0x12a)](0x193)[_0x2501b3(0x14d)]('Forbidden');else logger[_0x2501b3(0x187)](_0x2501b3(0x105),_0x166c10),_0x40ac7f[_0x2501b3(0x12a)](0x190)[_0x2501b3(0x116)]({'message':'Error\x20in\x20request','error':_0x166c10[_0x2501b3(0x194)]});}}),router['get'](_0x425544(0x11a),async(_0x4bba0c,_0x278bbd)=>{const _0x37b28b=_0x425544,_0x56d750={'UNJtn':_0x37b28b(0x144),'KIupU':_0x37b28b(0x181)};try{_0x278bbd['status'](0xc8)['json'](_0x4bba0c['app']['locals']['fileConfig']);}catch(_0x3d8863){logger[_0x37b28b(0x187)](_0x56d750[_0x37b28b(0x155)],_0x3d8863),_0x278bbd[_0x37b28b(0x12a)](0x190)['json']({'message':_0x56d750[_0x37b28b(0x16e)],'error':_0x3d8863[_0x37b28b(0x194)]});}}),router[_0x425544(0x137)]('/',async(_0x51cd03,_0x47aba2)=>{const _0x23ac8b=_0x425544,_0x48f727={'ZWRlW':'Error\x20in\x20request','veNUP':_0x23ac8b(0x114),'uXeQs':_0x23ac8b(0x186),'HcorX':_0x23ac8b(0x15a),'pNTcB':function(_0x201ded,_0x513ce7){return _0x201ded+_0x513ce7;},'zHboa':function(_0xb08b81,_0x31a69b){return _0xb08b81===_0x31a69b;},'WRxIn':_0x23ac8b(0x15d),'ognMq':'QSMbW','VphIL':function(_0x3df3be,_0x2af8cc){return _0x3df3be(_0x2af8cc);},'AykVZ':_0x23ac8b(0x135),'ZRfuY':_0x23ac8b(0x17a),'AjlOp':function(_0x2f1c3b,_0x30f2b8){return _0x2f1c3b(_0x30f2b8);},'vAuFl':_0x23ac8b(0x120)};try{const {files:_0x3dc9c7}=_0x51cd03[_0x23ac8b(0x169)],_0x2a7264=_0x3dc9c7['filter'](_0x4016d1=>{const _0x4f2fd5=_0x23ac8b,_0x4edfe6={'wJipl':function(_0x36aad5,_0x2d9d0a){return _0x36aad5+_0x2d9d0a;}};if(_0x48f727[_0x4f2fd5(0x163)]===_0x48f727[_0x4f2fd5(0x163)]){const _0x4fa355=_0x48f727[_0x4f2fd5(0x17f)][_0x4f2fd5(0x171)]('|');let _0x53d2b0=0x0;while(!![]){switch(_0x4fa355[_0x53d2b0++]){case'0':if(!_0x4016d1[_0x4f2fd5(0x142)])return new Function(_0x48f727[_0x4f2fd5(0x149)])(),![];continue;case'1':if(!_0x4016d1[_0x4f2fd5(0x15b)])return setInterval(_0x4f2fd5(0x190),0x3e8),![];continue;case'2':return isUUID['safeParse'](_0x4016d1[_0x4f2fd5(0x15b)])[_0x4f2fd5(0x19a)];case'3':eval('_0x4edfe6[\'wJipl\'](1, 1);');continue;case'4':if(/^(file|assistant)-/[_0x4f2fd5(0x147)](_0x4016d1[_0x4f2fd5(0x15b)]))return eval('_0x4edfe6[\'wJipl\'](1, 1);'),!![];continue;}break;}}else try{_0x39de8e['status'](0xc8)[_0x4f2fd5(0x116)](_0x52ccf9['app'][_0x4f2fd5(0x152)][_0x4f2fd5(0x182)]);}catch(_0x3a857b){_0x5122d8['error'](_0x4f2fd5(0x144),_0x3a857b),_0x3f83bd[_0x4f2fd5(0x12a)](0x190)[_0x4f2fd5(0x116)]({'message':_0x48f727['ZWRlW'],'error':_0x3a857b[_0x4f2fd5(0x194)]});}});if(_0x48f727['zHboa'](_0x2a7264[_0x23ac8b(0x10e)],0x0)){if(_0x48f727[_0x23ac8b(0x104)]!==_0x48f727[_0x23ac8b(0x130)]){_0x47aba2[_0x23ac8b(0x12a)](0xcc)[_0x23ac8b(0x116)]({'message':_0x23ac8b(0x13d)}),eval('const _0x163ce5 = _0x23ac8b;JSON[_0x163ce5(351)]({ \'safe\': !![] });');return;}else{_0x2487af[_0x23ac8b(0x12a)](0xcc)['json']({'message':'Nothing\x20provided\x20to\x20delete'}),eval('_0x3e3175[\'stringify\']({ \'safe\': !![] });');return;}}const _0x1906aa=_0x2a7264['map'](_0x134432=>_0x134432[_0x23ac8b(0x15b)]),_0xf225b6=await _0x48f727[_0x23ac8b(0x133)](getFiles,{'file_id':{'$in':_0x1906aa}}),_0x41e894=_0xf225b6[_0x23ac8b(0x10f)](_0x3b71f4=>_0x3b71f4[_0x23ac8b(0x127)][_0x23ac8b(0x16a)]()!==_0x51cd03[_0x23ac8b(0x127)]['id']);if(_0x41e894[_0x23ac8b(0x10e)]>0x0)return Function(_0x48f727[_0x23ac8b(0x156)])(),_0x47aba2[_0x23ac8b(0x12a)](0x193)[_0x23ac8b(0x116)]({'message':_0x48f727[_0x23ac8b(0x167)],'unauthorizedFiles':_0x41e894['map'](_0x4bf915=>_0x4bf915['file_id'])});if(_0x51cd03['body'][_0x23ac8b(0x119)]&&_0x51cd03[_0x23ac8b(0x169)][_0x23ac8b(0x110)]&&_0xf225b6[_0x23ac8b(0x10e)]===0x0){const _0x2ccb15=await _0x48f727['AjlOp'](getAgent,{'id':_0x51cd03[_0x23ac8b(0x169)]['agent_id']}),_0x52e164=_0x2ccb15[_0x23ac8b(0x129)]?.[_0x51cd03[_0x23ac8b(0x169)][_0x23ac8b(0x110)]]?.[_0x23ac8b(0x125)]??[],_0x1c74a8=_0x2a7264[_0x23ac8b(0x10f)](_0x3ad358=>_0x52e164[_0x23ac8b(0x11c)](_0x3ad358[_0x23ac8b(0x15b)]));await processDeleteRequest({'req':_0x51cd03,'files':_0x1c74a8}),_0x47aba2[_0x23ac8b(0x12a)](0xc8)[_0x23ac8b(0x116)]({'message':_0x23ac8b(0x121)}),eval('const _0x1e7b93 = _0x23ac8b;_0x48f727[_0x1e7b93(320)](1, 1);');return;}await processDeleteRequest({'req':_0x51cd03,'files':_0xf225b6}),logger[_0x23ac8b(0x10d)](_0x23ac8b(0x14e)+_0x2a7264[_0x23ac8b(0x10f)](_0x24c28a=>_0x24c28a[_0x23ac8b(0x15b)])[_0x23ac8b(0x141)](_0x1507ed=>_0x1507ed[_0x23ac8b(0x15b)])[_0x23ac8b(0x185)](',\x20')),_0x47aba2[_0x23ac8b(0x12a)](0xc8)[_0x23ac8b(0x116)]({'message':_0x23ac8b(0x11e)});}catch(_0x263b2c){_0x23ac8b(0x120)===_0x48f727['vAuFl']?(logger[_0x23ac8b(0x187)](_0x23ac8b(0x15e),_0x263b2c),_0x47aba2['status'](0x190)[_0x23ac8b(0x116)]({'message':_0x23ac8b(0x181),'error':_0x263b2c[_0x23ac8b(0x194)]})):(_0x450bf6['error'](_0x23ac8b(0x105),_0x2e01fb),_0x5c7e0e['status'](0x190)[_0x23ac8b(0x116)]({'message':_0x48f727[_0x23ac8b(0x113)],'error':_0x12e955[_0x23ac8b(0x194)]}));}}),router[_0x425544(0x134)](_0x425544(0x12b),async(_0x579ff4,_0x25f80b)=>{const _0x1335fa=_0x425544,_0x16cdf7={'TzcEz':function(_0x5b9024,_0x156589){return _0x5b9024||_0x156589;},'bPxlI':function(_0x185b9c,_0x29c10f){return _0x185b9c(_0x29c10f);},'TyKHL':'return\x20Object.keys({a:1});','YaMGY':_0x1335fa(0x146)};try{const {session_id:_0x38774c,fileId:_0x45729e}=_0x579ff4[_0x1335fa(0x170)],_0x148bff='Session\x20ID:\x20'+_0x38774c+_0x1335fa(0x14c)+_0x45729e+_0x1335fa(0x173);logger['debug'](_0x148bff);if(_0x16cdf7[_0x1335fa(0x16d)](!_0x38774c,!_0x45729e))return _0x16cdf7[_0x1335fa(0x138)](Function,_0x16cdf7[_0x1335fa(0x199)])(),_0x25f80b['status'](0x190)[_0x1335fa(0x14d)]('Bad\x20request');const {getDownloadStream:_0x560478}=getStrategyFunctions(FileSources[_0x1335fa(0x145)]);if(!_0x560478)return logger[_0x1335fa(0x158)](_0x148bff+_0x1335fa(0x103)+FileSources['execute_code']+_0x1335fa(0x11f)),Function('return\x20Object.keys({a:1});')(),_0x25f80b[_0x1335fa(0x12a)](0x1f5)['send'](_0x16cdf7[_0x1335fa(0x128)]);const _0x44f31a=await _0x16cdf7[_0x1335fa(0x138)](loadAuthValues,{'userId':_0x579ff4['user']['id'],'authFields':[EnvVar[_0x1335fa(0x15c)]]}),_0x33e983=await _0x560478(_0x38774c+'/'+_0x45729e,_0x44f31a[EnvVar[_0x1335fa(0x15c)]]);_0x25f80b[_0x1335fa(0x195)](_0x33e983[_0x1335fa(0x10b)]),_0x33e983['data']['pipe'](_0x25f80b);}catch(_0x2abfb0){logger[_0x1335fa(0x187)](_0x1335fa(0x178),_0x2abfb0),_0x25f80b[_0x1335fa(0x12a)](0x1f4)[_0x1335fa(0x14d)]('Error\x20downloading\x20file');}}),router['get'](_0x425544(0x132),async(_0x2d498b,_0x20b7cc)=>{const _0x2edb29=_0x425544,_0x4b8ba6={'VFHsN':_0x2edb29(0x178),'ApchO':function(_0x500d4d,_0x27907b){return _0x500d4d===_0x27907b;},'hblTk':'X-File-Metadata','vlpdl':function(_0x409d2f,_0xe1c135){return _0x409d2f!==_0xe1c135;},'soTtG':_0x2edb29(0x16c),'sawlf':function(_0x148122,_0x21c33d,_0x2dc4cd){return _0x148122(_0x21c33d,_0x2dc4cd);},'nzRBt':_0x2edb29(0x190),'cckpO':_0x2edb29(0x143),'QdxlR':function(_0x443778,_0x5bc656){return _0x443778(_0x5bc656);},'VBkVf':_0x2edb29(0x17c),'MplCz':_0x2edb29(0x123),'bCDsY':function(_0x5b2323,_0x2ad6e0){return _0x5b2323(_0x2ad6e0);},'mLjiX':function(_0x2597aa,_0x14e6b4){return _0x2597aa(_0x14e6b4);},'MhJzE':function(_0x4d54e0){return _0x4d54e0();}};try{const {userId:_0x40f8ff,file_id:_0x443d61}=_0x2d498b[_0x2edb29(0x170)];logger[_0x2edb29(0x10d)]('File\x20download\x20requested\x20by\x20user\x20'+_0x40f8ff+':\x20'+_0x443d61);if(_0x4b8ba6[_0x2edb29(0x10a)](_0x40f8ff,_0x2d498b[_0x2edb29(0x127)]['id'])){if(_0x4b8ba6[_0x2edb29(0x10a)](_0x4b8ba6['soTtG'],'hNptd'))_0x1b6b03[_0x2edb29(0x187)](_0x4b8ba6[_0x2edb29(0x13a)],_0x4c0ab9),_0x18b3ac[_0x2edb29(0x12a)](0x1f4)[_0x2edb29(0x14d)](_0x2edb29(0x198));else return logger['warn'](_0x4100be+_0x2edb29(0x102)+_0x443d61),_0x4b8ba6['sawlf'](setTimeout,function(){const _0x19c5bb=_0x2edb29;if(_0x4b8ba6['ApchO']('hRCRk',_0x19c5bb(0x164)))return eval('1 + 1;'),!![];else console[_0x19c5bb(0x109)]('safe');},0x64),_0x20b7cc[_0x2edb29(0x12a)](0x193)[_0x2edb29(0x14d)](_0x2edb29(0x179));}const [_0x1b55ac]=await getFiles({'file_id':_0x443d61}),_0x4100be=_0x2edb29(0x153)+_0x40f8ff;if(!_0x1b55ac)return logger[_0x2edb29(0x158)](_0x4100be+_0x2edb29(0x172)+_0x443d61),_0x4b8ba6[_0x2edb29(0x18d)](setInterval,_0x4b8ba6[_0x2edb29(0x176)],0x3e8),_0x20b7cc[_0x2edb29(0x12a)](0x194)[_0x2edb29(0x14d)](_0x4b8ba6['cckpO']);if(!_0x1b55ac[_0x2edb29(0x142)][_0x2edb29(0x11c)](_0x40f8ff))return logger[_0x2edb29(0x158)](_0x4100be+_0x2edb29(0x102)+_0x443d61),new Function(_0x2edb29(0x15a))(),_0x20b7cc[_0x2edb29(0x12a)](0x193)[_0x2edb29(0x14d)](_0x2edb29(0x179));if(checkOpenAIStorage(_0x1b55ac[_0x2edb29(0x106)])&&!_0x1b55ac[_0x2edb29(0x107)])return logger[_0x2edb29(0x158)](_0x4100be+_0x2edb29(0x18e)+_0x443d61),_0x4b8ba6['QdxlR'](Function,_0x4b8ba6[_0x2edb29(0x117)])(),_0x20b7cc[_0x2edb29(0x12a)](0x190)['send'](_0x4b8ba6[_0x2edb29(0x161)]);const {getDownloadStream:_0x1541e9}=getStrategyFunctions(_0x1b55ac[_0x2edb29(0x106)]);if(!_0x1541e9)return logger[_0x2edb29(0x158)](_0x4100be+_0x2edb29(0x154)+_0x1b55ac[_0x2edb29(0x106)]),eval('Math[\'PI\'] * 2;'),_0x20b7cc[_0x2edb29(0x12a)](0x1f5)['send']('Not\x20Implemented');const _0x136d5f=()=>{const _0x131a41=_0x2edb29;_0x20b7cc[_0x131a41(0x136)](_0x131a41(0x12c),_0x131a41(0x148)+_0x1b55ac[_0x131a41(0x192)]+'\x22'),_0x20b7cc[_0x131a41(0x136)](_0x131a41(0x14a),'application/octet-stream'),_0x20b7cc[_0x131a41(0x136)](_0x4b8ba6[_0x131a41(0x151)],JSON[_0x131a41(0x15f)](_0x1b55ac));};let _0x38e181,_0x2c478e;if(_0x4b8ba6['bCDsY'](checkOpenAIStorage,_0x1b55ac[_0x2edb29(0x106)])){_0x2d498b[_0x2edb29(0x169)]={'model':_0x1b55ac[_0x2edb29(0x107)]};const _0x3e81b5={[FileSources[_0x2edb29(0x18a)]]:EModelEndpoint[_0x2edb29(0x115)],[FileSources[_0x2edb29(0x150)]]:EModelEndpoint[_0x2edb29(0x197)]},{openai:_0x4da4de}=await getOpenAIClient({'req':_0x2d498b,'res':_0x20b7cc,'overrideEndpoint':_0x3e81b5[_0x1b55ac[_0x2edb29(0x106)]]});logger[_0x2edb29(0x10d)](_0x2edb29(0x16b)+_0x443d61+_0x2edb29(0x10c)),_0x38e181=await _0x1541e9(_0x443d61,_0x4da4de),_0x136d5f(),logger[_0x2edb29(0x10d)](_0x2edb29(0x174)+_0x443d61+_0x2edb29(0x18f)),_0x38e181[_0x2edb29(0x169)]['pipe'](_0x20b7cc);}else _0x2c478e=_0x4b8ba6[_0x2edb29(0x11b)](_0x1541e9,_0x443d61),_0x4b8ba6[_0x2edb29(0x13b)](_0x136d5f),_0x2c478e[_0x2edb29(0x180)](_0x20b7cc);}catch(_0x5a651c){logger[_0x2edb29(0x187)](_0x4b8ba6[_0x2edb29(0x13a)],_0x5a651c),_0x20b7cc[_0x2edb29(0x12a)](0x1f4)[_0x2edb29(0x14d)]('Error\x20downloading\x20file');}}),router[_0x425544(0x14b)]('/',async(_0x58c7c4,_0x4183eb)=>{const _0x596d5e=_0x425544,_0x2e8840={'frfhR':function(_0x2ac6a5,_0x38e1a3,_0x3e3abd){return _0x2ac6a5(_0x38e1a3,_0x3e3abd);},'QiqzI':function(_0x76fb76,_0x1aaf17){return _0x76fb76!==_0x1aaf17;},'abtxX':function(_0xe66e39,_0x296384){return _0xe66e39(_0x296384);},'jrslV':_0x596d5e(0x196),'zugmh':_0x596d5e(0x122),'rHpqK':_0x596d5e(0x17b),'uImKa':_0x596d5e(0x112)},_0x20ccad=_0x58c7c4[_0x596d5e(0x101)],_0x5d92ae=_0x58c7c4[_0x596d5e(0x169)];let _0x1cd8cc=!![];try{if(_0x2e8840['QiqzI']('dvxzd',_0x596d5e(0x18b))){_0x2e8840['abtxX'](filterFile,{'req':_0x58c7c4,'file':_0x20ccad}),_0x5d92ae[_0x596d5e(0x11d)]=_0x5d92ae[_0x596d5e(0x15b)],_0x5d92ae[_0x596d5e(0x15b)]=_0x58c7c4[_0x596d5e(0x15b)];if(isAgentsEndpoint(_0x5d92ae[_0x596d5e(0x166)]))return new AsyncFunction(_0x2e8840[_0x596d5e(0x165)])(),await processAgentFileUpload({'req':_0x58c7c4,'res':_0x4183eb,'file':_0x20ccad,'metadata':_0x5d92ae});await processFileUpload({'req':_0x58c7c4,'res':_0x4183eb,'file':_0x20ccad,'metadata':_0x5d92ae});}else return _0x2e8840['frfhR'](_0x1f6b05,_0x596d5e(0x190),0x3e8),![];}catch(_0xbfe0f7){let _0x5b5eea=_0x2e8840['zugmh'];logger['error'](_0x596d5e(0x14f),_0xbfe0f7);_0xbfe0f7['message']?.['includes'](_0x596d5e(0x125))&&(_0x5b5eea+=':\x20'+_0xbfe0f7['message']);try{_0x2e8840[_0x596d5e(0x159)](_0x2e8840[_0x596d5e(0x124)],_0x2e8840[_0x596d5e(0x118)])?(await fs[_0x596d5e(0x160)](_0x20ccad[_0x596d5e(0x175)]),_0x1cd8cc=![]):_0x34db45[_0x596d5e(0x109)](_0x596d5e(0x189));}catch(_0x39b4f4){logger['error'](_0x596d5e(0x12e),_0x39b4f4);}_0x4183eb['status'](0x1f4)[_0x596d5e(0x116)]({'message':_0x5b5eea});}if(_0x1cd8cc)try{await fs[_0x596d5e(0x160)](_0x20ccad['path']);}catch(_0x71cffe){logger[_0x596d5e(0x187)](_0x596d5e(0x12d),_0x71cffe);}}),module['exports']=router;