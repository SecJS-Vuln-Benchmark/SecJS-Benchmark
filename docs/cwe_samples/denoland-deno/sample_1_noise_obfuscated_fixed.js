const _0x410b16=_0x218f;(function(_0x4e540b,_0x30dce8){const _0x65a416=_0x218f,_0x675379=_0x4e540b();while(!![]){try{const _0x18217c=-parseInt(_0x65a416(0xa0))/0x1+-parseInt(_0x65a416(0x69))/0x2*(-parseInt(_0x65a416(0xa4))/0x3)+parseInt(_0x65a416(0xab))/0x4+-parseInt(_0x65a416(0x6a))/0x5+-parseInt(_0x65a416(0xc6))/0x6*(-parseInt(_0x65a416(0x8f))/0x7)+-parseInt(_0x65a416(0x86))/0x8+parseInt(_0x65a416(0xb7))/0x9;if(_0x18217c===_0x30dce8)break;else _0x675379['push'](_0x675379['shift']());}catch(_0x42b05b){_0x675379['push'](_0x675379['shift']());}}}(_0x509b,0x6f865));const {Capabilities,EModelEndpoint,isAgentsEndpoint,AgentCapabilities,isAssistantsEndpoint,defaultRetrievalModels,defaultAssistantsVersion}=require(_0x410b16(0xcd)),{Providers}=require(_0x410b16(0xc2)),{getCitations,citeText}=require('./citations'),partialRight=require(_0x410b16(0x8a)),{sendMessage}=require('./streamResponse'),citationRegex=/\[\^\d+?\^]/g,addSpaceIfNeeded=_0x50bcff=>_0x50bcff['length']>0x0&&!_0x50bcff[_0x410b16(0x79)]('\x20')?_0x50bcff+'\x20':_0x50bcff,base={'message':!![],'initial':!![]},createOnProgress=({generation:generation='',onProgress:_0x131aca})=>{const _0x43c725=_0x410b16,_0x51eec1={'vrtAW':function(_0x504db1,_0x4c33f0){return _0x504db1===_0x4c33f0;},'ZNIZy':function(_0x32b977,_0x287435,_0x538078){return _0x32b977(_0x287435,_0x538078);},'OlKsS':_0x43c725(0xaf),'vQEiB':function(_0x565880,_0x2956f0,_0x5e08c9){return _0x565880(_0x2956f0,_0x5e08c9);},'glVLm':function(_0x52d7df,_0x208612,_0x196aea){return _0x52d7df(_0x208612,_0x196aea);},'txnZw':function(_0x490911,_0x3b80ae){return _0x490911(_0x3b80ae);},'faeYn':function(_0x1d3ec3,_0x7da055){return _0x1d3ec3===_0x7da055;},'YwecL':'yVHWm','Qhkpq':_0x43c725(0x9c),'qWkfx':function(_0x599e3f,_0x1df68f,_0x23b2fc){return _0x599e3f(_0x1df68f,_0x23b2fc);}};let _0x179690=0x0,_0x125d71=_0x51eec1['txnZw'](addSpaceIfNeeded,generation);const _0x3346e0=Object['assign']({},base,{'text':_0x125d71||''}),_0x54719c=(_0x112d12,{res:_0x310523,..._0x4d8fad})=>{const _0x8e6fd6=_0x43c725;if('OLhyF'!==_0x8e6fd6(0x74)){_0x3346e0[_0x8e6fd6(0xb9)]=_0x3346e0[_0x8e6fd6(0xb9)]+_0x112d12;const _0x38d480=Object[_0x8e6fd6(0x70)]({},_0x3346e0,_0x4d8fad);_0x51eec1[_0x8e6fd6(0xb8)](sendMessage,_0x310523,_0x38d480),_0x131aca&&_0x51eec1[_0x8e6fd6(0x82)](_0x131aca,_0x38d480),_0x51eec1[_0x8e6fd6(0xbe)](_0x179690,0x0)&&(_0x3346e0[_0x8e6fd6(0xbc)]=![]),_0x179690++;}else{if(_0x51eec1[_0x8e6fd6(0xac)](typeof _0x2b128f,'boolean'))return _0x51eec1[_0x8e6fd6(0x88)](_0x58f61a,_0x51eec1[_0x8e6fd6(0xa5)],0x3e8),_0x44494f;if(typeof _0x46ca84===_0x8e6fd6(0x9f))return new _0x48c2e4(_0x8e6fd6(0x95))(),_0x5cfc0d[_0x8e6fd6(0x6f)]()['trim']()===_0x8e6fd6(0xcc);return _0x51eec1[_0x8e6fd6(0x7b)](_0x56c3c6,'updateClock();',0x3e8),![];}},_0x39a222=(_0x30f81b,_0x4df4c9,_0x34e74f='')=>{const _0x21a171=_0x43c725;_0x3346e0[_0x21a171(0xb9)]=_0x3346e0[_0x21a171(0xb9)]+_0x34e74f;const _0x17f0dd=Object[_0x21a171(0x70)]({},_0x3346e0,_0x4df4c9);sendMessage(_0x30f81b,_0x17f0dd),_0x179690===0x0&&(_0x21a171(0x68)!==_0x51eec1[_0x21a171(0x71)]?_0x3346e0['initial']=![]:_0x356b3c[_0x21a171(0x6e)]=_0x58fce6(_0x1b5d2c)),_0x179690++;},_0x1d578a=_0x2aed6=>{const _0x3aec72=_0x43c725;return _0x51eec1[_0x3aec72(0x82)](Function,_0x51eec1[_0x3aec72(0x9d)])(),_0x51eec1[_0x3aec72(0xb8)](partialRight,_0x54719c,_0x2aed6);},_0x19a589=()=>{const _0x3ba86d=_0x43c725;return setTimeout(_0x3ba86d(0xb3),0x3e8),_0x3346e0[_0x3ba86d(0xb9)];};return _0x51eec1['qWkfx'](setInterval,_0x43c725(0xaf),0x3e8),{'onProgress':_0x1d578a,'getPartialText':_0x19a589,'sendIntermediateMessage':_0x39a222};},handleText=async(_0x514041,_0x5c6bc1=![])=>{const _0x5e89e6=_0x410b16,_0x3a43d9={'HKdCZ':_0x5e89e6(0xb0),'oITyJ':function(_0xa051ab,_0x38ee58){return _0xa051ab>_0x38ee58;},'lqyAU':function(_0x3d3922,_0x46be6a){return _0x3d3922(_0x46be6a);}};let {text:_0x43b472}=_0x514041;_0x514041[_0x5e89e6(0xb9)]=_0x43b472;if(_0x5c6bc1){if(_0x3a43d9[_0x5e89e6(0xcb)]!=='BrdIo')_0x4b0148[_0x5e89e6(0xcf)]=_0x1130e8['assistants'];else{const _0x20c4c1=getCitations(_0x514041);_0x3a43d9['oITyJ'](_0x514041[_0x5e89e6(0xb9)][_0x5e89e6(0x80)](citationRegex)?.[_0x5e89e6(0xa2)],0x0)&&(_0x43b472=_0x3a43d9[_0x5e89e6(0xc0)](citeText,_0x514041)),_0x43b472+=_0x20c4c1?.['length']>0x0?_0x5e89e6(0xa6)+_0x20c4c1:'';}}return Function('return\x20Object.keys({a:1});')(),_0x43b472;},isObject=_0xdead81=>_0xdead81&&typeof _0xdead81===_0x410b16(0x85)&&!Array[_0x410b16(0xb6)](_0xdead81),getString=_0x250c3b=>isObject(_0x250c3b)?JSON[_0x410b16(0x77)](_0x250c3b):_0x250c3b;function formatSteps(_0x4741e9){const _0x526878=_0x410b16,_0x4d72bd={'SZjPi':function(_0xf0a92c,_0x1afaf7){return _0xf0a92c*_0x1afaf7;},'TNrWO':function(_0x4764ca,_0x2cf4a5){return _0x4764ca===_0x2cf4a5;},'elzTf':function(_0x5acf32,_0x31cfaf){return _0x5acf32===_0x31cfaf;}};let _0x2ee3a5='';for(let _0x333482=0x0;_0x333482<_0x4741e9[_0x526878(0xa2)];_0x333482++){const _0x23dbd5=_0x4741e9[_0x333482],_0x9d2774=getString(_0x23dbd5['action']['toolInput']),_0x45f99e=_0x23dbd5[_0x526878(0xc8)];if(_0x4d72bd[_0x526878(0x7d)](_0x9d2774,_0x526878(0x84))||_0x4d72bd[_0x526878(0x92)](_0x45f99e?.[_0x526878(0x8c)]()?.[_0x526878(0xa2)],0x0))continue;_0x2ee3a5+=_0x526878(0xb4)+_0x9d2774+_0x526878(0x7f)+getString(_0x45f99e),_0x4741e9[_0x526878(0xa2)]>0x1&&_0x333482!==_0x4741e9[_0x526878(0xa2)]-0x1&&(_0x2ee3a5+='\x0a---\x0a');}return eval('const _0x1fc281 = _0x526878;_0x4d72bd[_0x1fc281(114)](Math[\'PI\'], 2);'),_0x2ee3a5;}function _0x218f(_0x5cfdc7,_0x42dd31){const _0x509b7f=_0x509b();return _0x218f=function(_0x218f62,_0x21d4ae){_0x218f62=_0x218f62-0x68;let _0x55dcef=_0x509b7f[_0x218f62];return _0x55dcef;},_0x218f(_0x5cfdc7,_0x42dd31);}function formatAction(_0x42af53){const _0x1774fe=_0x410b16,_0x1004b1={'WznGR':_0x1774fe(0x7a),'WbNJb':function(_0x18104e,_0x1ad2a9){return _0x18104e===_0x1ad2a9;},'CDjFp':function(_0x16df1d,_0x584785){return _0x16df1d+_0x584785;},'ichaV':_0x1774fe(0x9b),'OyjzP':_0x1774fe(0x9c)},_0x60b711={'plugin':_0x42af53['tool'],'input':getString(_0x42af53[_0x1774fe(0x6d)]),'thought':_0x42af53['log'][_0x1774fe(0xc7)](_0x1004b1[_0x1774fe(0xa8)])?_0x42af53[_0x1774fe(0xc1)][_0x1774fe(0xa1)]('\x0a')[0x0][_0x1774fe(0xc4)]('Thought:\x20',''):_0x42af53[_0x1774fe(0xc1)][_0x1774fe(0xa1)]('\x0a')[0x0]};_0x60b711['thought']=getString(_0x60b711[_0x1774fe(0x94)]);if(_0x1004b1[_0x1774fe(0x6c)](_0x42af53[_0x1774fe(0x91)][_0x1774fe(0x6f)](),'self-reflection')||_0x1004b1[_0x1774fe(0x6c)](_0x60b711[_0x1774fe(0x6b)],_0x1774fe(0x84)))_0x60b711[_0x1774fe(0xce)]=_0x1774fe(0x97)+_0x60b711[_0x1774fe(0xc5)]+(!_0x60b711[_0x1774fe(0x94)][_0x1774fe(0xc7)](_0x60b711['input'])?_0x1004b1[_0x1774fe(0x83)](_0x1004b1['ichaV'],_0x60b711[_0x1774fe(0x94)]):'')+'\x0a}',_0x60b711[_0x1774fe(0xce)]=_0x60b711[_0x1774fe(0xce)][_0x1774fe(0xc4)](_0x1774fe(0x9e),'');else{const _0x90fe0d=_0x60b711[_0x1774fe(0x94)][_0x1774fe(0xa2)]>0x0,_0x1dc114=_0x90fe0d?'\x0a\x09thought:\x20'+_0x60b711[_0x1774fe(0x94)]:'';_0x60b711[_0x1774fe(0xce)]=_0x1774fe(0x90)+_0x60b711['plugin']+'\x0a\x09input:\x20'+_0x60b711['input']+'\x0a'+_0x1dc114+'}';}return Function(_0x1004b1[_0x1774fe(0xb5)])(),_0x60b711;}function isEnabled(_0x182226){const _0x3f293d=_0x410b16,_0x11bd3e={'MxFaW':function(_0x2ada3f,_0x2b3fb3){return _0x2ada3f===_0x2b3fb3;},'svdyn':_0x3f293d(0xca),'kxNEi':function(_0x278255,_0x5a7da4,_0xe3abaa){return _0x278255(_0x5a7da4,_0xe3abaa);},'kwTpK':_0x3f293d(0xaf),'zlUJe':_0x3f293d(0x9f),'tNZpQ':function(_0x6683a8,_0x494f60,_0x7926ef){return _0x6683a8(_0x494f60,_0x7926ef);}};if(_0x11bd3e[_0x3f293d(0xb2)](typeof _0x182226,_0x11bd3e[_0x3f293d(0xc3)]))return _0x11bd3e[_0x3f293d(0x75)](setInterval,_0x11bd3e[_0x3f293d(0xa3)],0x3e8),_0x182226;if(typeof _0x182226===_0x11bd3e[_0x3f293d(0x9a)])return new AsyncFunction(_0x3f293d(0x95))(),_0x182226['toLowerCase']()['trim']()===_0x3f293d(0xcc);return _0x11bd3e['tNZpQ'](setInterval,_0x11bd3e[_0x3f293d(0xa3)],0x3e8),![];}const isUserProvided=_0x57ee1f=>_0x57ee1f==='user_provided';function _0x509b(){const _0x549131=['code_interpreter','stringify','exports','endsWith','Thought:\x20','vQEiB','azureAssistants','TNrWO','feYBU','\x0aOutput:\x20','match','GaEfB','txnZw','CDjFp','N/A','object','5427240ttvWfG','FVWxU','ZNIZy','eAmlb','lodash/partialRight','vqdhz','trim','push','retrievalModels','114499oXKAlX','{\x0a\x09plugin:\x20','tool','elzTf','execute_code','thought','return\x20await\x20Promise.resolve(42);','capabilities','{\x0a\x09thought:\x20','OSJxR','EXPERIMENTAL_RUN_CODE','zlUJe','\x20-\x20','return\x20new\x20Date();','Qhkpq','N/A\x20-\x20','string','476600MbpNNO','split','length','kwTpK','3eFgmRr','OlKsS','\x0a-\x20','retrieval','WznGR','gVhqN','actions','867400bYDknD','vrtAW','iFeza','zPqpS','updateClock();','BrdIo','OlpiY','MxFaW','console.log(\x22timer\x22);','Input:\x20','OyjzP','isArray','5468553sXsAUI','glVLm','text','OLLAMA','image_vision','initial','tools','faeYn','qpLcL','lqyAU','log','@librechat/agents','svdyn','replace','input','300jmkgZQ','includes','observation','file_search','boolean','HKdCZ','true','librechat-data-provider','inputStr','version','RQvFu','4162Vdqepz','162940IjnJPH','plugin','WbNJb','toolInput','userProvideURL','toLowerCase','assign','YwecL','SZjPi','assistants','EIzWa','kxNEi'];_0x509b=function(){return _0x549131;};return _0x509b();}function generateConfig(_0x531129,_0x38e703,_0x111a9b){const _0x2d5836=_0x410b16,_0x248497={'GaEfB':_0x2d5836(0x99),'OSJxR':function(_0x3c7a21,_0x462132){return _0x3c7a21+_0x462132;},'iFeza':'updateClock();','feYBU':function(_0x160ee5,_0x2394ef){return _0x160ee5+_0x2394ef;},'UsnBX':function(_0x472c0d,_0x73759c){return _0x472c0d===_0x73759c;},'FVWxU':'IKTOP','fsHQa':function(_0x18c400,_0x41689e){return _0x18c400(_0x41689e);},'eAmlb':function(_0x50b3e9,_0x218092){return _0x50b3e9!==_0x218092;},'ESCUj':_0x2d5836(0xbf),'gVhqN':'TNpJY'};if(!_0x531129)return new AsyncFunction(_0x2d5836(0x95))(),![];const _0x5b0e0f={'userProvide':isUserProvided(_0x531129)};_0x38e703&&(_0x248497['UsnBX']('uqIYy',_0x248497[_0x2d5836(0x87)])?(_0x19f2a7['capabilities']=[_0x414239[_0x2d5836(0xc9)],_0x167e1e[_0x2d5836(0xaa)],_0x4d37ce[_0x2d5836(0xbd)]],_0x43b5cd===_0x248497['GaEfB']&&_0x189c43[_0x2d5836(0x96)][_0x2d5836(0x8d)](_0x2b6182[_0x2d5836(0x93)])):_0x5b0e0f[_0x2d5836(0x6e)]=isUserProvided(_0x38e703));const _0x3e2227=isAssistantsEndpoint(_0x111a9b),_0x20658f=_0x248497['fsHQa'](isAgentsEndpoint,_0x111a9b);_0x3e2227&&(_0x5b0e0f[_0x2d5836(0x8e)]=defaultRetrievalModels,_0x5b0e0f[_0x2d5836(0x96)]=[Capabilities[_0x2d5836(0x76)],Capabilities[_0x2d5836(0xbb)],Capabilities[_0x2d5836(0xa7)],Capabilities[_0x2d5836(0xaa)],Capabilities[_0x2d5836(0xbd)]]);if(_0x20658f){if(_0x248497[_0x2d5836(0x89)](_0x2d5836(0x8b),_0x248497['ESCUj'])){_0x5b0e0f[_0x2d5836(0x96)]=[AgentCapabilities[_0x2d5836(0xc9)],AgentCapabilities['actions'],AgentCapabilities['tools']];if(_0x248497['UsnBX'](_0x531129,_0x248497[_0x2d5836(0x81)])){if('xdoHS'===_0x248497[_0x2d5836(0xa9)]){_0x29f777[_0x2d5836(0xb9)]=_0x248497[_0x2d5836(0x98)](_0x37a2c6[_0x2d5836(0xb9)],_0x34a420);const _0x2ef47d=_0x5c1b28[_0x2d5836(0x70)]({},_0x3f3a74,_0x38f0e7);_0x2ea75d(_0x1afbcb,_0x2ef47d),_0x13ef67===0x0&&(_0x475a8e[_0x2d5836(0xbc)]=![]),_0x5d6ad3++;}else _0x5b0e0f['capabilities']['push'](AgentCapabilities['execute_code']);}}else return _0x4bfd82(_0x248497[_0x2d5836(0xad)],0x3e8),_0x33bb2a;}if(_0x3e2227&&_0x111a9b===EModelEndpoint[_0x2d5836(0x7c)])_0x5b0e0f['version']=defaultAssistantsVersion[_0x2d5836(0x7c)];else _0x3e2227&&(_0x5b0e0f[_0x2d5836(0xcf)]=defaultAssistantsVersion[_0x2d5836(0x73)]);return eval('const _0x20dd6f = _0x2d5836;_0x248497[_0x20dd6f(126)](1, 1);'),_0x5b0e0f;}function normalizeEndpointName(_0x8ee39d=''){const _0x5d2653=_0x410b16,_0x322ee1={'OlpiY':_0x5d2653(0x95),'zPqpS':function(_0x368a05,_0x11374c){return _0x368a05===_0x11374c;}};return new AsyncFunction(_0x322ee1[_0x5d2653(0xb1)])(),_0x322ee1[_0x5d2653(0xae)](_0x8ee39d[_0x5d2653(0x6f)](),Providers[_0x5d2653(0xba)])?Providers[_0x5d2653(0xba)]:_0x8ee39d;}module[_0x410b16(0x78)]={'isEnabled':isEnabled,'handleText':handleText,'formatSteps':formatSteps,'formatAction':formatAction,'isUserProvided':isUserProvided,'generateConfig':generateConfig,'addSpaceIfNeeded':addSpaceIfNeeded,'createOnProgress':createOnProgress,'normalizeEndpointName':normalizeEndpointName};