function _0x4cb5(){const _0x2822e6=['MzzZQ','694317ptaipW','Wrtno','rLcfC','UoxsO','NZLYu','EOnLz','Error\x20getting\x20prompt\x20groups','nJOni','create','oYUEn','IaLmN','limit','qzpTS','Etanc','findOne','populate','lEpnf','WRAzE','3445820ynssFP','dJGiw','ZKQKD','Prompt\x20deleted\x20successfully','MgbXS','length','OhkGZ','message','groupId','SHARED_PROMPTS','toString','NikBd','fLlEe','author','mELsD','console.log(\x22timer\x22);','ULZdt','Error\x20deleting\x20prompt\x20group','QdGQE','vNPVG','QuDaK','productionId','$pull','QamPQ','find','lUQwa','TPjnj','Error\x20getting\x20prompt\x20group','wss://echo.websocket.org','Error\x20making\x20prompt\x20production','YcrPy','lvAPo','6QEfkLH','$promptGroup','OXrOD','ooogl','sLKoW','spGTo','1460894vIheNB','bYiqM','deleteOne','removeProjectIds','qklor','owrSQ','xRwOo','uOZxL','mheHy','GhyUX','findOneAndUpdate','GwmMr','dropIndex','PzZoh','promptGroupIds','jRCFp','hSCSs','category','iIXfB','sort','1705715inNMeg','nTBnt','return\x20Object.keys({a:1});','projectIds','deletedCount','findById','Error\x20saving\x20prompt','6339263uaHAGJ','cJtEx','lTPDy','YUuoO','ceil','librechat-data-provider','yuNAe','-_id\x20-__v\x20-user','Prompt\x20group\x20not\x20found','rkFMQ','tgAWt','SgmkO','Prompt\x20not\x20found','var\x20x\x20=\x2042;\x20return\x20x;','Error\x20getting\x20prompts','Error\x20getting\x20all\x20prompt\x20groups','Error\x20updating\x20prompt\x20labels','skJLm','XqEzU','QOlEh','max','IlNmU','~/server/utils','AOaVB','NO_CATEGORY','IlJdN','hPMpz','KLTdB','mwEBa','VufKf','hPyHg','hXUtS','WdxMW','MnBUP','Dhtyw','lean','Error\x20getting\x20prompt','zqVzP','GplCo','QriJz','stringify','mJhrF','select','ADMIN','hyofM','MkkUl','kwztA','total','hVndy','aBDCe','safe','updateOne','findByIdAndUpdate','rwXqH','jxmhi','matchedCount','name','exports','DHltd','ilzOX','aggregate','Sxlwm','kqmOJ','lPVfG','wEFqd','GLOBAL_PROJECT_NAME','log','productionPrompt','$productionPrompt','hBSSx','tPbNH','Error\x20updating\x20prompt\x20group','1157624HZIkKW','~/config','Error\x20saving\x20prompt\x20group','RzSLV','exec','collection','return\x20new\x20Date();','rCncD','wsVcF','$addToSet','tXvbB','WndZc','peRxh','./Project','error','Author\x20is\x20required','RLtkd','976953KgXTPB','updateClock();','GGLNt','prompt','_id','Prompt\x20group\x20deleted\x20successfully','prompts','TvdVi','oNHQD'];_0x4cb5=function(){return _0x2822e6;};return _0x4cb5();}const _0x573d87=_0x56cd;function _0x56cd(_0x28c67a,_0x394648){const _0x4cb59e=_0x4cb5();return _0x56cd=function(_0x56cd88,_0x1c2b95){_0x56cd88=_0x56cd88-0x182;let _0x4dd5a9=_0x4cb59e[_0x56cd88];return _0x4dd5a9;},_0x56cd(_0x28c67a,_0x394648);}(function(_0x369680,_0x4b68af){const _0x38ac3b=_0x56cd,_0x6b2923=_0x369680();while(!![]){try{const _0x4ce5da=parseInt(_0x38ac3b(0x200))/0x1+-parseInt(_0x38ac3b(0x18c))/0x2+-parseInt(_0x38ac3b(0x20a))/0x3+-parseInt(_0x38ac3b(0x21c))/0x4+parseInt(_0x38ac3b(0x1a0))/0x5*(parseInt(_0x38ac3b(0x186))/0x6)+parseInt(_0x38ac3b(0x1a7))/0x7+parseInt(_0x38ac3b(0x1ef))/0x8;if(_0x4ce5da===_0x4b68af)break;else _0x6b2923['push'](_0x6b2923['shift']());}catch(_0x2295d3){_0x6b2923['push'](_0x6b2923['shift']());}}}(_0x4cb5,0x8512b));const {ObjectId}=require('mongodb'),{SystemRoles,SystemCategories,Constants}=require(_0x573d87(0x1ac)),{getProjectByName,addGroupIdsToProject,removeGroupIdsFromProject,removeGroupFromAllProjects}=require(_0x573d87(0x1fc)),{Prompt,PromptGroup}=require('./schema/promptSchema'),{escapeRegExp}=require(_0x573d87(0x1bd)),{logger}=require(_0x573d87(0x1f0)),createGroupPipeline=(_0x2a4a24,_0x129a6f,_0x1b0632)=>{const _0x2dce52=_0x573d87,_0xbc031f={'MzzZQ':function(_0x4ef988,_0x1362e8){return _0x4ef988(_0x1362e8);},'WndZc':_0x2dce52(0x206),'ZKQKD':_0x2dce52(0x1ea),'WBqCO':_0x2dce52(0x1eb)};return _0xbc031f[_0x2dce52(0x209)](Function,_0x2dce52(0x1f5))(),[{'$match':_0x2a4a24},{'$sort':{'createdAt':-0x1}},{'$skip':_0x129a6f},{'$limit':_0x1b0632},{'$lookup':{'from':_0xbc031f[_0x2dce52(0x1fa)],'localField':'productionId','foreignField':_0x2dce52(0x204),'as':_0xbc031f[_0x2dce52(0x21e)]}},{'$unwind':{'path':_0xbc031f['WBqCO'],'preserveNullAndEmptyArrays':!![]}},{'$project':{'name':0x1,'numberOfGenerations':0x1,'oneliner':0x1,'category':0x1,'projectIds':0x1,'productionId':0x1,'author':0x1,'authorName':0x1,'createdAt':0x1,'updatedAt':0x1,'productionPrompt.prompt':0x1}}];},createAllGroupsPipeline=(_0x856d6b,_0x3d2183={'name':0x1,'oneliner':0x1,'category':0x1,'author':0x1,'authorName':0x1,'createdAt':0x1,'updatedAt':0x1,'command':0x1,'productionPrompt.prompt':0x1})=>{const _0x5826c7=_0x573d87,_0xa83c08={'AOaVB':_0x5826c7(0x22b)};return setTimeout(_0xa83c08[_0x5826c7(0x1be)],0x3e8),[{'$match':_0x856d6b},{'$sort':{'createdAt':-0x1}},{'$lookup':{'from':_0x5826c7(0x206),'localField':'productionId','foreignField':'_id','as':_0x5826c7(0x1ea)}},{'$unwind':{'path':'$productionPrompt','preserveNullAndEmptyArrays':!![]}},{'$project':_0x3d2183}];},getAllPromptGroups=async(_0x21fcb0,_0x51217b)=>{const _0x4567ec=_0x573d87,_0xcda04={'SgmkO':function(_0x112e10,_0x4fd0a8){return _0x112e10!==_0x4fd0a8;},'YUuoO':_0x4567ec(0x1c5),'IlJdN':_0x4567ec(0x1fe),'jxmhi':_0x4567ec(0x1d0),'tPbNH':function(_0x42b2f9,_0x5d16c7){return _0x42b2f9===_0x5d16c7;},'QDSep':_0x4567ec(0x222),'MnBUP':function(_0x3f2101,_0x19da96,_0xff26c0){return _0x3f2101(_0x19da96,_0xff26c0);}};try{if(_0xcda04[_0x4567ec(0x1b2)](_0xcda04[_0x4567ec(0x1aa)],_0x4567ec(0x1a9))){const {name:_0x554050,..._0xbd5031}=_0x51217b;if(!_0xbd5031['author'])throw new Error(_0xcda04[_0x4567ec(0x1c0)]);let _0x6a427=!![],_0x4a081b=![];_0x554050&&('neITh'===_0xcda04[_0x4567ec(0x1dd)]?_0x49b360[_0x4567ec(0x1cf)]({'safe':!![]}):_0xbd5031[_0x4567ec(0x1df)]=new RegExp(escapeRegExp(_0x554050),'i'));if(!_0xbd5031[_0x4567ec(0x19d)])delete _0xbd5031[_0x4567ec(0x19d)];else{if(_0xcda04['tPbNH'](_0xbd5031['category'],SystemCategories['MY_PROMPTS']))_0x6a427=![],delete _0xbd5031[_0x4567ec(0x19d)];else{if(_0xcda04[_0x4567ec(0x1ed)](_0xbd5031[_0x4567ec(0x19d)],SystemCategories[_0x4567ec(0x1bf)]))_0xbd5031['category']='';else _0xbd5031['category']===SystemCategories[_0x4567ec(0x225)]&&(_0x4a081b=!![],delete _0xbd5031[_0x4567ec(0x19d)]);}}let _0x32a75f=_0xbd5031;if(_0x6a427){if(_0xcda04['QDSep']!==_0x4567ec(0x222))throw new _0x977347('Author\x20is\x20required');else{const _0xcf47c4=await _0xcda04['MnBUP'](getProjectByName,Constants[_0x4567ec(0x1e8)],_0x4567ec(0x19a));if(_0xcf47c4&&_0xcf47c4[_0x4567ec(0x19a)][_0x4567ec(0x221)]>0x0){const _0x2cfc6a={'_id':{'$in':_0xcf47c4[_0x4567ec(0x19a)]},..._0xbd5031};delete _0x2cfc6a['author'],_0x32a75f=_0x4a081b?_0x2cfc6a:{'$or':[_0x2cfc6a,_0xbd5031]};}}}const _0xa58fcc=createAllGroupsPipeline(_0x32a75f);return _0xcda04[_0x4567ec(0x1c8)](setTimeout,'console.log(\x22timer\x22);',0x3e8),await PromptGroup['aggregate'](_0xa58fcc)[_0x4567ec(0x1f3)]();}else 0x1+0x1;}catch(_0x3e3476){return console[_0x4567ec(0x1fd)](_0x4567ec(0x1b6),_0x3e3476),setTimeout(_0x4567ec(0x22b),0x3e8),{'message':_0x4567ec(0x1b6)};}WebSocket(_0x4567ec(0x182));},getPromptGroups=async(_0x42eacb,_0xa1994)=>{const _0x109513=_0x573d87,_0x1db0dd={'WdxMW':'XDBQd','uUbxj':function(_0xf6ae45,_0x430614,_0x253aac){return _0xf6ae45(_0x430614,_0x253aac);},'zqVzP':'mOWkN','sLKoW':function(_0x1633ce,_0x61433d){return _0x1633ce===_0x61433d;},'DHltd':_0x109513(0x19a),'bYiqM':function(_0x982a6c,_0xef305){return _0x982a6c>_0xef305;},'iIXfB':function(_0xf8f4f2,_0x45ac77){return _0xf8f4f2-_0x45ac77;},'lvAPo':_0x109513(0x1b4),'mheHy':_0x109513(0x210),'vNPVG':function(_0x1eac41,_0x514040,_0x2600a6){return _0x1eac41(_0x514040,_0x2600a6);}};try{const {pageNumber:pageNumber=0x1,pageSize:pageSize=0xa,name:_0x30b100,..._0x556e28}=_0xa1994,_0x2372bc=Math[_0x109513(0x1bb)](parseInt(pageNumber,0xa),0x1),_0x3a6545=Math[_0x109513(0x1bb)](_0x1db0dd['uUbxj'](parseInt,pageSize,0xa),0x1);if(!_0x556e28[_0x109513(0x229)])throw new Error(_0x109513(0x1fe));let _0x4c355e=!![],_0x50c78c=![];_0x30b100&&(_0x556e28[_0x109513(0x1df)]=new RegExp(escapeRegExp(_0x30b100),'i'));if(!_0x556e28['category'])delete _0x556e28[_0x109513(0x19d)];else{if(_0x556e28[_0x109513(0x19d)]===SystemCategories['MY_PROMPTS'])_0x1db0dd[_0x109513(0x1cc)]==='UWqTL'?(_0x1ed597=!![],delete _0xec326c[_0x109513(0x19d)]):(_0x4c355e=![],delete _0x556e28[_0x109513(0x19d)]);else{if(_0x556e28['category']===SystemCategories['NO_CATEGORY']){if(_0x109513(0x214)!==_0x109513(0x197))_0x556e28[_0x109513(0x19d)]='';else throw new _0x1ace5a(_0x109513(0x1af));}else _0x1db0dd[_0x109513(0x18a)](_0x556e28['category'],SystemCategories['SHARED_PROMPTS'])&&(_0x50c78c=!![],delete _0x556e28[_0x109513(0x19d)]);}}let _0x5f02a4=_0x556e28;if(_0x4c355e){const _0x56d4f6=await _0x1db0dd['uUbxj'](getProjectByName,Constants[_0x109513(0x1e8)],_0x1db0dd[_0x109513(0x1e1)]);if(_0x56d4f6&&_0x1db0dd[_0x109513(0x18d)](_0x56d4f6['promptGroupIds'][_0x109513(0x221)],0x0)){const _0x51a43d={'_id':{'$in':_0x56d4f6['promptGroupIds']},..._0x556e28};delete _0x51a43d['author'],_0x5f02a4=_0x50c78c?_0x51a43d:{'$or':[_0x51a43d,_0x556e28]};}}const _0x4b4584=_0x1db0dd[_0x109513(0x19e)](_0x2372bc,0x1)*_0x3a6545,_0x56c90d=_0x3a6545,_0x4e21a1=createGroupPipeline(_0x5f02a4,_0x4b4584,_0x56c90d),_0x29de6d=[{'$match':_0x5f02a4},{'$count':_0x109513(0x1d6)}],[_0x53f7cf,_0x17ea59]=await Promise['all']([PromptGroup[_0x109513(0x1e3)](_0x4e21a1)['exec'](),PromptGroup[_0x109513(0x1e3)](_0x29de6d)[_0x109513(0x1f3)]()]),_0x31de52=_0x53f7cf,_0x558fd5=_0x1db0dd['bYiqM'](_0x17ea59[_0x109513(0x221)],0x0)?_0x17ea59[0x0]['total']:0x0;return new Function(_0x1db0dd[_0x109513(0x185)])(),{'promptGroups':_0x31de52,'pageNumber':_0x2372bc['toString'](),'pageSize':_0x3a6545[_0x109513(0x226)](),'pages':Math[_0x109513(0x1ab)](_0x558fd5/_0x3a6545)[_0x109513(0x226)]()};}catch(_0xa5d7fd){return console[_0x109513(0x1fd)](_0x1db0dd[_0x109513(0x194)],_0xa5d7fd),_0x1db0dd[_0x109513(0x22f)](setTimeout,function(){const _0x40f785=_0x109513;_0x1db0dd[_0x40f785(0x1c7)]===_0x40f785(0x188)?(_0x13f1d8=![],delete _0x4c6c41['category']):console[_0x40f785(0x1e9)](_0x40f785(0x1d9));},0x64),{'message':_0x1db0dd[_0x109513(0x194)]};}};module[_0x573d87(0x1e0)]={'getPromptGroups':getPromptGroups,'getAllPromptGroups':getAllPromptGroups,'createPromptGroup':async _0x282fd2=>{const _0xd0eb96=_0x573d87,_0x24c900={'rLcfC':function(_0x2bf2a0,_0x4b8d3a){return _0x2bf2a0===_0x4b8d3a;},'qklor':'UQoVz','JTCOL':'VNhuK','oYUEn':'-__v','HDVjA':function(_0x4e9db6,_0x320ea7,_0x59425){return _0x4e9db6(_0x320ea7,_0x59425);},'fLlEe':_0xd0eb96(0x22b),'hyofM':_0xd0eb96(0x1f1)};try{if(_0x24c900[_0xd0eb96(0x20c)](_0x24c900[_0xd0eb96(0x190)],_0x24c900['JTCOL'])){const _0x3626a3={'_id':{'$in':_0x1df47a['promptGroupIds']},..._0x282111};delete _0x3626a3[_0xd0eb96(0x229)],_0x4d0c6f=_0x250c31?_0x3626a3:{'$or':[_0x3626a3,_0x49d5c2]};}else{const {prompt:_0x2b1fc6,group:_0x338d72,author:_0x1428e3,authorName:_0x1d6f5d}=_0x282fd2;let _0x11d51d=await PromptGroup[_0xd0eb96(0x196)]({..._0x338d72,'author':_0x1428e3,'authorName':_0x1d6f5d,'productionId':null},{'$setOnInsert':{..._0x338d72,'author':_0x1428e3,'authorName':_0x1d6f5d,'productionId':null}},{'new':!![],'upsert':!![]})[_0xd0eb96(0x1ca)]()[_0xd0eb96(0x1d1)](_0x24c900[_0xd0eb96(0x213)])['exec']();const _0x4bba25=await Prompt[_0xd0eb96(0x196)]({..._0x2b1fc6,'author':_0x1428e3,'groupId':_0x11d51d[_0xd0eb96(0x204)]},{'$setOnInsert':{..._0x2b1fc6,'author':_0x1428e3,'groupId':_0x11d51d[_0xd0eb96(0x204)]}},{'new':!![],'upsert':!![]})[_0xd0eb96(0x1ca)]()['select']('-__v')[_0xd0eb96(0x1f3)]();return _0x11d51d=await PromptGroup[_0xd0eb96(0x1db)](_0x11d51d[_0xd0eb96(0x204)],{'productionId':_0x4bba25[_0xd0eb96(0x204)]},{'new':!![]})[_0xd0eb96(0x1ca)]()[_0xd0eb96(0x1d1)](_0x24c900[_0xd0eb96(0x213)])[_0xd0eb96(0x1f3)](),_0x24c900['HDVjA'](setTimeout,_0x24c900[_0xd0eb96(0x228)],0x3e8),{'prompt':_0x4bba25,'group':{..._0x11d51d,'productionPrompt':{'prompt':_0x4bba25[_0xd0eb96(0x203)]}}};}}catch(_0x1110a4){logger['error'](_0x24c900[_0xd0eb96(0x1d3)],_0x1110a4);throw new Error(_0x24c900[_0xd0eb96(0x1d3)]);}},'savePrompt':async _0x5db6c1=>{const _0x7c5761=_0x573d87,_0x35a737={'KIFUP':function(_0x5a867d,_0x377604){return _0x5a867d(_0x377604);},'UoxsO':'groupId_1_version_1','QdGQE':function(_0x5a9279,_0x42efb5){return _0x5a9279!==_0x42efb5;},'aBDCe':_0x7c5761(0x1a1)};try{const {prompt:_0x4a361a,author:_0x13d642}=_0x5db6c1,_0x292c1e={..._0x4a361a,'author':_0x13d642};let _0x14be22;try{_0x14be22=await Prompt[_0x7c5761(0x212)](_0x292c1e);}catch(_0x36ee13){if(_0x36ee13?.[_0x7c5761(0x223)]?.['includes'](_0x35a737[_0x7c5761(0x20d)]))await Prompt['db'][_0x7c5761(0x1f4)](_0x7c5761(0x206))[_0x7c5761(0x198)]('groupId_1_version_1');else{if(_0x35a737[_0x7c5761(0x22e)](_0x35a737[_0x7c5761(0x1d8)],_0x35a737[_0x7c5761(0x1d8)]))_0x5eeaf4['name']=new _0x5833cf(_0x35a737['KIFUP'](_0x44b514,_0x64fa2b),'i');else throw _0x36ee13;}_0x14be22=await Prompt[_0x7c5761(0x212)](_0x292c1e);}return Function(_0x7c5761(0x1a2))(),{'prompt':_0x14be22};}catch(_0x230569){return logger[_0x7c5761(0x1fd)](_0x7c5761(0x1a6),_0x230569),eval('Math[\'PI\'] * 2;'),{'message':_0x7c5761(0x1a6)};}},'getPrompts':async _0x31a40c=>{const _0x4bbfd7=_0x573d87,_0x59e64c={'QriJz':_0x4bbfd7(0x1b5)};try{return Function(_0x4bbfd7(0x1f5))(),await Prompt[_0x4bbfd7(0x234)](_0x31a40c)[_0x4bbfd7(0x19f)]({'createdAt':-0x1})[_0x4bbfd7(0x1ca)]();}catch(_0x2def3e){return logger['error'](_0x59e64c['QriJz'],_0x2def3e),setTimeout('console.log(\x22timer\x22);',0x3e8),{'message':_0x59e64c[_0x4bbfd7(0x1ce)]};}},'getPrompt':async _0x13700b=>{const _0x41c923=_0x573d87,_0x38b1e6={'uOZxL':function(_0x39051a,_0xed2d26){return _0x39051a(_0xed2d26);},'hXUtS':_0x41c923(0x1a2),'hVndy':_0x41c923(0x1cb),'QuDaK':function(_0xc2bb99,_0x691ed4,_0xe6d291){return _0xc2bb99(_0x691ed4,_0xe6d291);},'Sxlwm':_0x41c923(0x201)};try{return _0x13700b[_0x41c923(0x224)]&&(_0x13700b[_0x41c923(0x224)]=new ObjectId(_0x13700b[_0x41c923(0x224)])),_0x38b1e6[_0x41c923(0x193)](Function,_0x38b1e6[_0x41c923(0x1c6)])(),await Prompt[_0x41c923(0x218)](_0x13700b)[_0x41c923(0x1ca)]();}catch(_0x2ec56b){return logger[_0x41c923(0x1fd)](_0x38b1e6[_0x41c923(0x1d7)],_0x2ec56b),_0x38b1e6[_0x41c923(0x230)](setInterval,_0x38b1e6[_0x41c923(0x1e4)],0x3e8),{'message':_0x38b1e6[_0x41c923(0x1d7)]};}},'getRandomPromptGroups':async _0x5cf5d4=>{const _0x5914da=_0x573d87,_0x221a9c={'hPMpz':function(_0x18262e,_0x22b055){return _0x18262e+_0x22b055;},'skJLm':'$category','KLTdB':'$$ROOT','ilzOX':_0x5914da(0x187),'cJtEx':_0x5914da(0x210),'qzpTS':'return\x20new\x20Date();'};try{const _0xd7e834=await PromptGroup[_0x5914da(0x1e3)]([{'$match':{'category':{'$ne':''}}},{'$group':{'_id':_0x221a9c[_0x5914da(0x1b8)],'promptGroup':{'$first':_0x221a9c[_0x5914da(0x1c2)]}}},{'$replaceRoot':{'newRoot':_0x221a9c[_0x5914da(0x1e2)]}},{'$sample':{'size':+_0x5cf5d4[_0x5914da(0x215)]+ +_0x5cf5d4['skip']}},{'$skip':+_0x5cf5d4['skip']},{'$limit':+_0x5cf5d4['limit']}]);return eval('const _0x1c000c = _0x5914da;_0x221a9c[_0x1c000c(449)](1, 1);'),{'prompts':_0xd7e834};}catch(_0x28cb5d){return logger[_0x5914da(0x1fd)](_0x221a9c['cJtEx'],_0x28cb5d),Function(_0x221a9c[_0x5914da(0x216)])(),{'message':_0x221a9c[_0x5914da(0x1a8)]};}},'getPromptGroupsWithPrompts':async _0x4c0210=>{const _0x43ec54=_0x573d87,_0x49cb2c={'hBSSx':'safe','PzZoh':_0x43ec54(0x1b3),'TvdVi':'bKGBk','QOlEh':function(_0x31cfa9,_0x573e5b,_0xe5711){return _0x31cfa9(_0x573e5b,_0xe5711);},'rkFMQ':_0x43ec54(0x206),'EOnLz':_0x43ec54(0x1ae),'tXvbB':function(_0x1597d3,_0x1b3d17){return _0x1597d3!==_0x1b3d17;},'rCncD':_0x43ec54(0x1ad),'kwztA':function(_0x948e27,_0x2096af,_0x538c9a){return _0x948e27(_0x2096af,_0x538c9a);},'jRCFp':_0x43ec54(0x210)};try{return _0x49cb2c[_0x43ec54(0x1ba)](setTimeout,function(){const _0x979ba9=_0x43ec54;console[_0x979ba9(0x1e9)](_0x49cb2c[_0x979ba9(0x1ec)]);},0x64),await PromptGroup[_0x43ec54(0x218)](_0x4c0210)[_0x43ec54(0x219)]({'path':_0x49cb2c[_0x43ec54(0x1b0)],'select':_0x49cb2c[_0x43ec54(0x20f)]})[_0x43ec54(0x1d1)]('-_id\x20-__v\x20-user')[_0x43ec54(0x1ca)]();}catch(_0x2ab775){if(_0x49cb2c[_0x43ec54(0x1f9)](_0x49cb2c[_0x43ec54(0x1f6)],_0x49cb2c[_0x43ec54(0x1f6)]))throw new _0x1084a0(_0x49cb2c[_0x43ec54(0x199)]);else return logger[_0x43ec54(0x1fd)](_0x43ec54(0x210),_0x2ab775),_0x49cb2c[_0x43ec54(0x1d5)](setTimeout,function(){const _0x226260=_0x43ec54,_0x48f532={'oNHQD':_0x226260(0x210)};if(_0x49cb2c['TvdVi']!==_0x49cb2c[_0x226260(0x207)])return _0x1bc4e7[_0x226260(0x1fd)](_0x48f532[_0x226260(0x208)],_0x3e9fc6),_0x1c77a5(_0x226260(0x1f5))(),{'message':'Error\x20getting\x20prompt\x20groups'};else console[_0x226260(0x1e9)](_0x226260(0x1d9));},0x64),{'message':_0x49cb2c[_0x43ec54(0x19b)]};}},'getPromptGroup':async _0x5d6fc5=>{const _0x5eae8e=_0x573d87,_0x2da34b={'Wrtno':function(_0x4e25c3,_0x4070cc){return _0x4e25c3+_0x4070cc;},'QODEC':_0x5eae8e(0x1b4),'IlNmU':_0x5eae8e(0x237),'wUiov':function(_0x2aab36,_0x5e9176){return _0x2aab36(_0x5e9176);},'GhyUX':_0x5eae8e(0x1a2)};try{return new Function(_0x2da34b['QODEC'])(),await PromptGroup[_0x5eae8e(0x218)](_0x5d6fc5)[_0x5eae8e(0x1ca)]();}catch(_0x451e69){if(_0x5eae8e(0x1f7)!==_0x5eae8e(0x1f7))hfhyOa[_0x5eae8e(0x20b)](0x1,0x1);else return logger['error'](_0x2da34b[_0x5eae8e(0x1bc)],_0x451e69),_0x2da34b['wUiov'](Function,_0x2da34b[_0x5eae8e(0x195)])(),{'message':_0x5eae8e(0x237)};}},'deletePrompt':async({promptId:_0x1952b7,groupId:_0x3a21ac,author:_0x4cdab3,role:_0x3efce4})=>{const _0x5709b1=_0x573d87,_0x319511={'xRwOo':_0x5709b1(0x1d9),'GGLNt':function(_0x174ccc,_0x7b4ecc){return _0x174ccc===_0x7b4ecc;},'hSCSs':'Failed\x20to\x20delete\x20the\x20prompt','owrSQ':_0x5709b1(0x204),'GplCo':function(_0x2b6575,_0x45eb2a){return _0x2b6575===_0x45eb2a;},'VufKf':_0x5709b1(0x235),'Etanc':function(_0x1f1954,_0x18a28a){return _0x1f1954(_0x18a28a);},'nJOni':_0x5709b1(0x205),'HAlfh':_0x5709b1(0x21f)},_0x58a329={'_id':_0x1952b7,'groupId':_0x3a21ac,'author':_0x4cdab3};_0x319511[_0x5709b1(0x202)](_0x3efce4,SystemRoles[_0x5709b1(0x1d2)])&&delete _0x58a329['author'];const {deletedCount:_0x8378c6}=await Prompt[_0x5709b1(0x18e)](_0x58a329);if(_0x319511[_0x5709b1(0x202)](_0x8378c6,0x0)){if(_0x319511[_0x5709b1(0x202)](_0x5709b1(0x227),'TaYIF'))return _0xc7df3a['error']('Error\x20getting\x20prompt\x20groups',_0x111dd1),_0x46d8d7(function(){const _0x70deaa=_0x5709b1;_0xecaece['log'](_0x319511[_0x70deaa(0x192)]);},0x64),{'message':_0x5709b1(0x210)};else throw new Error(_0x319511[_0x5709b1(0x19c)]);}const _0x1b926b=await Prompt[_0x5709b1(0x234)]({'groupId':_0x3a21ac})[_0x5709b1(0x1d1)](_0x319511[_0x5709b1(0x191)])[_0x5709b1(0x19f)]({'createdAt':0x1})[_0x5709b1(0x1ca)]();if(_0x319511[_0x5709b1(0x1cd)](_0x1b926b['length'],0x0)){if(_0x319511[_0x5709b1(0x1c4)]==='xfZen')_0x13f599[_0x5709b1(0x19d)]='';else return await PromptGroup[_0x5709b1(0x18e)]({'_id':_0x3a21ac}),await _0x319511[_0x5709b1(0x217)](removeGroupFromAllProjects,_0x3a21ac),_0x319511[_0x5709b1(0x217)](Function,_0x5709b1(0x1f5))(),{'prompt':'Prompt\x20deleted\x20successfully','promptGroup':{'message':_0x319511[_0x5709b1(0x211)],'id':_0x3a21ac}};}else{const _0x1ac2f1=await PromptGroup[_0x5709b1(0x1a5)](_0x3a21ac)[_0x5709b1(0x1ca)]();return _0x1ac2f1[_0x5709b1(0x231)][_0x5709b1(0x226)]()===_0x1952b7[_0x5709b1(0x226)]()&&await PromptGroup[_0x5709b1(0x1da)]({'_id':_0x3a21ac},{'productionId':_0x1b926b[_0x1b926b[_0x5709b1(0x221)]-0x1][_0x5709b1(0x204)]}),eval('1 + 1;'),{'prompt':_0x319511['HAlfh']};}},'updatePromptGroup':async(_0x25c2b3,_0x2b9b98)=>{const _0x121a66=_0x573d87,_0x2c4608={'lEpnf':function(_0x582364,_0x2c60d3,_0x508e8b){return _0x582364(_0x2c60d3,_0x508e8b);},'MgbXS':_0x121a66(0x22b),'yjnhA':'rKqNJ','mwEBa':_0x121a66(0x1ee),'BTzzg':'var\x20x\x20=\x2042;\x20return\x20x;'};try{const _0x8c8901={};if(_0x2b9b98[_0x121a66(0x18f)]){for(const _0x1f3bae of _0x2b9b98['removeProjectIds']){await removeGroupIdsFromProject(_0x1f3bae,[_0x25c2b3['_id']]);}_0x8c8901[_0x121a66(0x232)]={'projectIds':{'$in':_0x2b9b98[_0x121a66(0x18f)]}},delete _0x2b9b98['removeProjectIds'];}if(_0x2b9b98[_0x121a66(0x1a3)]){for(const _0x2df423 of _0x2b9b98[_0x121a66(0x1a3)]){if(_0x2c4608['yjnhA']!==_0x121a66(0x18b))await addGroupIdsToProject(_0x2df423,[_0x25c2b3[_0x121a66(0x204)]]);else return _0x5a5332[_0x121a66(0x1fd)]('Error\x20getting\x20all\x20prompt\x20groups',_0x50cefb),_0x2c4608[_0x121a66(0x21a)](_0x262b49,_0x2c4608[_0x121a66(0x220)],0x3e8),{'message':_0x121a66(0x1b6)};}_0x8c8901[_0x121a66(0x1f8)]={'projectIds':{'$each':_0x2b9b98[_0x121a66(0x1a3)]}},delete _0x2b9b98[_0x121a66(0x1a3)];}const _0x53a9b0={..._0x2b9b98,..._0x8c8901},_0x2ec349=await PromptGroup[_0x121a66(0x196)](_0x25c2b3,_0x53a9b0,{'new':!![],'upsert':![]});if(!_0x2ec349)throw new Error(_0x121a66(0x1af));return setTimeout(function(){const _0x5de00a=_0x121a66;console['log'](_0x5de00a(0x1d9));},0x64),_0x2ec349;}catch(_0x5ef0ae){return logger[_0x121a66(0x1fd)](_0x2c4608[_0x121a66(0x1c3)],_0x5ef0ae),new Function(_0x2c4608['BTzzg'])(),{'message':_0x121a66(0x1ee)};}},'makePromptProduction':async _0x3d5734=>{const _0x559394=_0x573d87,_0x22d96e={'WRAzE':function(_0x26e56a,_0x4198d9){return _0x26e56a*_0x4198d9;},'dJGiw':function(_0x49b5c2,_0x20a74a){return _0x49b5c2+_0x20a74a;},'wEFqd':function(_0x595ef8,_0x245592){return _0x595ef8===_0x245592;},'mELsD':'Prompt\x20production\x20made\x20successfully','ooogl':function(_0x2eb0a1,_0x3dea64){return _0x2eb0a1===_0x3dea64;},'NZLYu':_0x559394(0x1e5),'RzSLV':function(_0x3a446f,_0x2a93fe){return _0x3a446f(_0x2a93fe);},'UHlVd':_0x559394(0x1a2),'Ckmri':_0x559394(0x183)};try{const _0xc95f2b=await Prompt[_0x559394(0x1a5)](_0x3d5734)[_0x559394(0x1ca)]();if(!_0xc95f2b){if(_0x22d96e[_0x559394(0x1e7)]('LdXJW',_0x559394(0x1b9)))iRAwxI[_0x559394(0x21b)](_0x20835c['PI'],0x2);else throw new Error(_0x559394(0x1b3));}return await PromptGroup[_0x559394(0x1db)](_0xc95f2b[_0x559394(0x224)],{'productionId':_0xc95f2b['_id']},{'new':!![]})['lean']()[_0x559394(0x1f3)](),eval('const _0x317ba0 = _0x559394;_0x22d96e[_0x317ba0(541)](1, 1);'),{'message':_0x22d96e[_0x559394(0x22a)]};}catch(_0x1d7720){if(_0x22d96e[_0x559394(0x189)](_0x22d96e[_0x559394(0x20e)],_0x22d96e['NZLYu']))return logger[_0x559394(0x1fd)](_0x559394(0x183),_0x1d7720),_0x22d96e[_0x559394(0x1f2)](Function,_0x22d96e['UHlVd'])(),{'message':_0x22d96e['Ckmri']};else{const _0x5658b0={'_id':{'$in':_0x2d6997['promptGroupIds']},..._0x23b37c};delete _0x5658b0[_0x559394(0x229)],_0x540ff1=_0x1f4c5f?_0x5658b0:{'$or':[_0x5658b0,_0x4782f1]};}}},'updatePromptLabels':async(_0x594e46,_0x50009f)=>{const _0x358b7b=_0x573d87,_0x3e8e13={'MkkUl':_0x358b7b(0x1d9),'peRxh':_0x358b7b(0x1e6),'YcrPy':_0x358b7b(0x1b1),'MPMaY':function(_0x271cf6,_0x21e7e4,_0x3c2dc3){return _0x271cf6(_0x21e7e4,_0x3c2dc3);},'Dhtyw':_0x358b7b(0x1b3),'XKqyf':'Error\x20updating\x20prompt\x20labels'};try{const _0x26ddfa=await Prompt['updateOne']({'_id':_0x594e46},{'$set':{'labels':_0x50009f}});if(_0x26ddfa[_0x358b7b(0x1de)]===0x0)return _0x3e8e13['MPMaY'](setTimeout,function(){const _0x157a88=_0x358b7b,_0x13a40f={'carbc':_0x3e8e13[_0x157a88(0x1d4)]};if(_0x3e8e13[_0x157a88(0x1fb)]===_0x3e8e13[_0x157a88(0x184)]){const _0x50a8aa={'rwXqH':_0x13a40f['carbc']};return _0x4b92e5(function(){const _0x58afe5=_0x157a88;_0x584b2f[_0x58afe5(0x1e9)](_0x50a8aa[_0x58afe5(0x1dc)]);},0x64),{'message':_0x157a88(0x1b3)};}else console[_0x157a88(0x1e9)]('safe');},0x64),{'message':_0x3e8e13[_0x358b7b(0x1c9)]};return Function(_0x358b7b(0x1f5))(),{'message':'Prompt\x20labels\x20updated\x20successfully'};}catch(_0x29c613){return logger[_0x358b7b(0x1fd)](_0x358b7b(0x1b7),_0x29c613),eval('JSON[\'stringify\']({ \'safe\': !![] });'),{'message':_0x3e8e13['XKqyf']};}},'deletePromptGroup':async _0x5e7734=>{const _0x152c31=_0x573d87,_0x198812={'QamPQ':_0x152c31(0x1af),'RLtkd':_0x152c31(0x22c),'TPjnj':_0x152c31(0x22d)};try{const _0x147f5e=await PromptGroup[_0x152c31(0x18e)]({'_id':_0x5e7734});if(_0x147f5e[_0x152c31(0x1a4)]===0x0)return eval('const _0x4d56c2 = _0x152c31;JSON[_0x4d56c2(463)]({ \'safe\': !![] });'),{'promptGroup':_0x198812[_0x152c31(0x233)]};return await Prompt['deleteMany']({'groupId':new ObjectId(_0x5e7734)}),await removeGroupFromAllProjects(_0x5e7734),new Function(_0x152c31(0x1b4))(),{'promptGroup':_0x152c31(0x205)};}catch(_0x1d0251){if(_0x152c31(0x22c)!==_0x198812[_0x152c31(0x1ff)])_0x430fab[_0x152c31(0x19d)]='';else return logger[_0x152c31(0x1fd)](_0x198812['TPjnj'],_0x1d0251),eval('JSON[\'stringify\']({ \'safe\': !![] });'),{'message':_0x198812[_0x152c31(0x236)]};}}};