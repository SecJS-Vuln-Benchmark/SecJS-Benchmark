function _0x4f20(_0x4e1734,_0x35dbfa){const _0x4631bd=_0x4631();return _0x4f20=function(_0x4f20b4,_0x5a2d3d){_0x4f20b4=_0x4f20b4-0x159;let _0x2cff8e=_0x4631bd[_0x4f20b4];return _0x2cff8e;},_0x4f20(_0x4e1734,_0x35dbfa);}const _0x37f03e=_0x4f20;function _0x4631(){const _0x1c2289=['AUTH_ROLE_ENUM','itemCount','OrgControllerError','ooxSE','czGgR','hyzDA','usGGG','9603vIlCSe','active','toLowerCase','rCwfw','findOneByUserNameAndOrgUUID','find','RRqRW','\x20organization\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','UZWRs','xOtHn','CMtEe','nBuUf','duplicateShortname','UPGJB','ZHbSJ','isSecretariatUUID','\x20organization.','SBxtI','getCveIdRepository','create_org','eqCNk','maIft','10ZqFjOa','short_name','active_roles','keys','vqkDB','\x20organization\x20was\x20sent\x20to\x20the\x20user.','hxlvP','CQVrU','ecvfY','userDne','itemsPerPage','\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','IKPgJ','Gcbyc','sort','GrNYv','notSameUserOrSecretariat','name.last','SncRL','8350720rpSbQk','GUzuN','\x20organization\x20does\x20not\x20exist.','zzQIQ','mTSAy','rziBJ','VLGWf','eXgWo','TANNi','suffix','RJmXp','CySQK','splice','authority','getUserRepository','length','split','ZcHEw','MDtnX','json','aggregatePaginate','\x20was\x20successfully\x20updated.','eIgFh','name','page','updateByUserNameAndOrgUUID','query','uuid','DSALw','name.suffix','6162219wJuMES','2968HHeLQr','last','bAfTn','foKVX','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','\x20does\x20not\x20exist\x20for\x20','The\x20API\x20secret\x20was\x20successfully\x20reset\x20and\x20sent\x20to\x20','\x20organization\x20were\x20sent\x20to\x20the\x20user.','CNA','ifcEv','cxrJd','aJNto','active_roles.remove','hash','WLiiK','AyipK','user','DEFAULT_ID_QUOTA','PAGINATOR_OPTIONS','rguRd','MJAhL','notSameOrgOrSecretariat','tvZKl','currentPage','GlpOf','ReudU','user_UUID','uuid-apikey','\x20was\x20sent\x20to\x20the\x20user.','pageCount','KDpOt','aCYKd','DAtwO','4425308AkBrxb','eEMkc','zmrUy','orgDne','\x20does\x20not\x20exist.','btUxh','fYZSl','PAGINATOR_PAGE','NVirF','getOrgUUID','2308458aeMGgm','mbIBZ','DBsOj','active_roles.add','countDocuments','cERVN','orgExists','QGSwb','lAhgr','middle','OjVNo','UUID','repositories','IuFsp','limit','PmHiF','WGoVu','CVE_STATES','totalCount','yHAol','asc','first','uZlZk','uyjMb','JbYuJ','OmJBw','inUse','secret','yhgcT','nextPage','update_user','KVjNo','\x20user\x20does\x20not\x20exist.','XuiFU','NpXiX','org','create_user','992727PPabLN','TtsIl','id_quota','gnaGr','ShTxK','JIiTk','ujPLA','Yndkg','identifier','\x20organization\x20was\x20successfully\x20updated.','../../model/org','\x20organization\x20could\x20not\x20be\x20updated\x20in\x20MongoDB\x20because\x20it\x20does\x20not\x20exist.','../../model/user','duplicateUsername','isArray','push','updateByOrgUUID','notOrgAdminOrSecretariat','QoJli','policies','TrfEo','BpnRX','username','shortname','jsjOz','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20that\x20organization\x27s\x20users\x20or\x20the\x20Secretariat.','\x20user\x20is\x20not\x20Org\x20Admin\x20or\x20Secretariat\x20to\x20modify\x20these\x20fields.','reset_userAPIkey','QRWYf','hIgEu','isUUID','org_UUID','WLEJO','API\x20secret\x20was\x20successfully\x20reset.','The\x20api\x20secret\x20can\x20only\x20be\x20reset\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','JdYPn','hQzbS','uTzgo','OVbES','rVnpC','PLCpa','isAdminUUID','forEach','VCNEk','sFORH','status','fgGKp','XmvmJ','org_shortname','CRYPTO_RANDOM_STRING_LENGTH','findOneByShortName','prevPage','iNwuo','update_org','ctx','xjxpj','uJYfT','info','sbSYc','SUhvW','BxkBX','vojXv','ubDPk','\x20organization\x20was\x20successfully\x20created.','\x20was\x20successfully\x20created.','orgDneParam','aggregate','dotenv','cZCnO','wdBwZ','RRoGY','LhcIZ','NaBpC','The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','116223lKCerx','mJGoW','DiGQQ','1|3|2|0|4|5','FsvtX','The\x20orgs\x20were\x20sent\x20to\x20the\x20user.','new_username','total_reserved','Dwaos','indexOf','includes','\x20organization\x20contains\x20a\x20user\x20with\x20the\x20same\x20username.','AhMVv','isSecretariat','body','eGbtH','uuidProvided','AZpoS','lUmFV','The\x20user\x20can\x20only\x20be\x20updated\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','gTbKE','Iwfnt','stringify','getOrgRepository','\x20organization\x20id\x20quota\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','params'];_0x4631=function(){return _0x1c2289;};return _0x4631();}(function(_0x1d80a3,_0x3afe18){const _0x17e882=_0x4f20,_0xda68c4=_0x1d80a3();while(!![]){try{const _0x4730b7=parseInt(_0x17e882(0x248))/0x1*(-parseInt(_0x17e882(0x17c))/0x2)+-parseInt(_0x17e882(0x1fe))/0x3+parseInt(_0x17e882(0x1cf))/0x4+parseInt(_0x17e882(0x18f))/0x5+-parseInt(_0x17e882(0x1d9))/0x6+-parseInt(_0x17e882(0x1ad))/0x7+parseInt(_0x17e882(0x1ae))/0x8*(parseInt(_0x17e882(0x166))/0x9);if(_0x4730b7===_0x3afe18)break;else _0xda68c4['push'](_0xda68c4['shift']());}catch(_0x37ee57){_0xda68c4['push'](_0xda68c4['shift']());}}}(_0x4631,0xf2fac),require(_0x37f03e(0x241))['config']());const User=require(_0x37f03e(0x20a)),Org=require(_0x37f03e(0x208)),logger=require('../../middleware/logger'),argon2=require('argon2'),CONSTANTS=require('../../constants'),cryptoRandomString=require('crypto-random-string'),uuid=require(_0x37f03e(0x1aa)),errors=require('./error'),error=new errors[(_0x37f03e(0x161))](),uuidAPIKey=require(_0x37f03e(0x1c9));async function getOrgs(_0x7336e8,_0x4017a2,_0x1d6dfa){const _0x530e3e=_0x37f03e,_0x213b72={'iNwuo':function(_0x1f9416,_0x585a53){return _0x1f9416!==_0x585a53;},'eGbtH':'vpvHY','cZCnO':'asc','atlUR':function(_0x12ef77,_0x1d00dc){return _0x12ef77(_0x1d00dc);},'xipUE':function(_0x14a3c3,_0x243748){return _0x14a3c3>=_0x243748;},'cxrJd':_0x530e3e(0x24b),'XmvmJ':function(_0x5df7a5,_0x5ad48e){return _0x5df7a5===_0x5ad48e;},'GrNYv':_0x530e3e(0x229)};try{if(_0x213b72[_0x530e3e(0x232)](_0x213b72[_0x530e3e(0x257)],_0x530e3e(0x189))){const _0x4293b7=CONSTANTS['PAGINATOR_OPTIONS'];_0x4293b7[_0x530e3e(0x18a)]={'short_name':_0x213b72[_0x530e3e(0x242)]},_0x4293b7['page']=_0x7336e8[_0x530e3e(0x234)]['query']['page']?_0x213b72['atlUR'](parseInt,_0x7336e8[_0x530e3e(0x234)][_0x530e3e(0x1a9)]['page']):CONSTANTS[_0x530e3e(0x1d6)];const _0xe2e4df=_0x7336e8['ctx'][_0x530e3e(0x1e5)][_0x530e3e(0x15c)](),_0xb5009d=setAggregateOrgObj({}),_0xa7645e=await _0xe2e4df[_0x530e3e(0x1a3)](_0xb5009d,_0x4293b7),_0x5cd98a={'organizations':_0xa7645e['itemsList']};if(_0x213b72['xipUE'](_0xa7645e['itemCount'],CONSTANTS[_0x530e3e(0x1c0)][_0x530e3e(0x1e7)])){const _0x43bccb=_0x213b72[_0x530e3e(0x1b8)][_0x530e3e(0x19f)]('|');let _0x187dcd=0x0;while(!![]){switch(_0x43bccb[_0x187dcd++]){case'0':_0x5cd98a[_0x530e3e(0x1c5)]=_0xa7645e[_0x530e3e(0x1c5)];continue;case'1':_0x5cd98a['totalCount']=_0xa7645e[_0x530e3e(0x160)];continue;case'2':_0x5cd98a[_0x530e3e(0x1cb)]=_0xa7645e['pageCount'];continue;case'3':_0x5cd98a['itemsPerPage']=_0xa7645e[_0x530e3e(0x186)];continue;case'4':_0x5cd98a[_0x530e3e(0x231)]=_0xa7645e['prevPage'];continue;case'5':_0x5cd98a['nextPage']=_0xa7645e['nextPage'];continue;}break;}}return logger[_0x530e3e(0x237)]({'uuid':_0x7336e8['ctx'][_0x530e3e(0x1aa)],'message':_0x530e3e(0x24d)}),_0x4017a2[_0x530e3e(0x22b)](0xc8)[_0x530e3e(0x1a2)](_0x5cd98a);}else _0x2d428c[_0x530e3e(0x214)]=_0x5584c5[_0x530e3e(0x234)][_0x530e3e(0x256)]['username'];}catch(_0x2e26f1){_0x213b72[_0x530e3e(0x22d)](_0x530e3e(0x1e3),_0x213b72[_0x530e3e(0x18b)])?_0x6cfa94['push'](_0x182fbe):_0x213b72['atlUR'](_0x1d6dfa,_0x2e26f1);}}async function getOrg(_0x4542e2,_0x3d7750,_0x36fa57){const _0x2c7e6c=_0x37f03e,_0x48226b={'QRWYf':function(_0x54d3bc,_0x58007d){return _0x54d3bc+_0x58007d;},'WGoVu':_0x2c7e6c(0x176),'CQVrU':'uWzoQ','xOtHn':function(_0x47dbcf,_0x4fe532){return _0x47dbcf(_0x4fe532);},'usGGG':function(_0x32cdb4,_0x3c4fc9){return _0x32cdb4+_0x3c4fc9;},'RRqRW':_0x2c7e6c(0x17b),'eqCNk':_0x2c7e6c(0x191),'AKgZT':function(_0x19367a,_0x13da10){return _0x19367a+_0x13da10;},'xlWIb':_0x2c7e6c(0x181),'zmrUy':function(_0x2061a4,_0x4cbdb4){return _0x2061a4(_0x4cbdb4);}};try{if(_0x2c7e6c(0x203)===_0x48226b[_0x2c7e6c(0x183)])return _0x42e5f6[_0x2c7e6c(0x237)]({'uuid':_0x25bcb3[_0x2c7e6c(0x234)][_0x2c7e6c(0x1aa)],'message':_0x48226b[_0x2c7e6c(0x21a)](_0x2c7e6c(0x247)+_0x288060+_0x2c7e6c(0x1b3)+_0x2b68cf,_0x48226b[_0x2c7e6c(0x1e9)])}),_0x4e135b[_0x2c7e6c(0x22b)](0x194)[_0x2c7e6c(0x1a2)](_0x31c8d8['userDne'](_0x46b114));else{const _0x431ac0=_0x4542e2[_0x2c7e6c(0x234)][_0x2c7e6c(0x1fc)],_0x5a9825=_0x4542e2['ctx']['params'][_0x2c7e6c(0x206)],_0x45b616=_0x4542e2['ctx'][_0x2c7e6c(0x1e5)][_0x2c7e6c(0x15c)](),_0x18b547=await _0x45b616[_0x2c7e6c(0x255)](_0x431ac0),_0x5da639=await _0x45b616[_0x2c7e6c(0x230)](_0x431ac0);let _0x17b75f=_0x431ac0,_0x12291f=_0x48226b[_0x2c7e6c(0x16f)](setAggregateOrgObj,{'short_name':_0x5a9825});uuidAPIKey[_0x2c7e6c(0x21c)](_0x5a9825)&&(_0x17b75f=_0x5da639[_0x2c7e6c(0x1e4)],_0x12291f=setAggregateOrgObj({'UUID':_0x5a9825}));if(_0x17b75f!==_0x5a9825&&!_0x18b547)return logger[_0x2c7e6c(0x237)]({'uuid':_0x4542e2[_0x2c7e6c(0x234)][_0x2c7e6c(0x1aa)],'message':_0x48226b[_0x2c7e6c(0x165)](_0x5a9825,_0x2c7e6c(0x1b2))}),_0x3d7750[_0x2c7e6c(0x22b)](0x193)[_0x2c7e6c(0x1a2)](error['notSameOrgOrSecretariat']());let _0x20b402=await _0x45b616[_0x2c7e6c(0x240)](_0x12291f);_0x20b402=_0x20b402[_0x2c7e6c(0x19e)]>0x0?_0x20b402[0x0]:null;if(!_0x20b402)return _0x48226b[_0x2c7e6c(0x16c)]===_0x2c7e6c(0x17b)?(logger[_0x2c7e6c(0x237)]({'uuid':_0x4542e2[_0x2c7e6c(0x234)][_0x2c7e6c(0x1aa)],'message':_0x48226b[_0x2c7e6c(0x21a)](_0x5a9825,_0x48226b[_0x2c7e6c(0x17a)])}),_0x3d7750[_0x2c7e6c(0x22b)](0x194)[_0x2c7e6c(0x1a2)](error['orgDneParam'](_0x5a9825))):(_0x1511e2[_0x2c7e6c(0x237)]({'uuid':_0x37a3f8[_0x2c7e6c(0x234)][_0x2c7e6c(0x1aa)],'message':_0x2c7e6c(0x25b)}),_0x37c8b8[_0x2c7e6c(0x22b)](0x193)[_0x2c7e6c(0x1a2)](_0x58b069[_0x2c7e6c(0x18c)]()));return logger[_0x2c7e6c(0x237)]({'uuid':_0x4542e2[_0x2c7e6c(0x234)][_0x2c7e6c(0x1aa)],'message':_0x48226b['AKgZT'](_0x5a9825,_0x48226b['xlWIb']),'org':_0x20b402}),_0x3d7750[_0x2c7e6c(0x22b)](0xc8)[_0x2c7e6c(0x1a2)](_0x20b402);}}catch(_0x2e86c5){_0x2c7e6c(0x246)==='NaBpC'?_0x48226b[_0x2c7e6c(0x1d1)](_0x36fa57,_0x2e86c5):_0x4767f9[_0x2c7e6c(0x211)]['id_quota']=_0x2f59b7[_0x2c7e6c(0x234)]['query'][_0x2c7e6c(0x200)];}}async function getUsers(_0x3375aa,_0xb13fa5,_0x35547b){const _0x527360=_0x37f03e,_0x1e9ebe={'IKPgJ':_0x527360(0x1ed),'VLGWf':function(_0x205772,_0x22a9a7){return _0x205772(_0x22a9a7);},'OmJBw':function(_0x163abf,_0x280e8c){return _0x163abf+_0x280e8c;},'NpXiX':'\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','Vplwr':function(_0x426ad5,_0x3e26f2){return _0x426ad5>=_0x3e26f2;},'riafz':'OVbES'};try{const _0x428e33=CONSTANTS[_0x527360(0x1c0)];_0x428e33['sort']={'username':_0x1e9ebe[_0x527360(0x188)]},_0x428e33['page']=_0x3375aa[_0x527360(0x234)][_0x527360(0x1a9)][_0x527360(0x1a7)]?_0x1e9ebe[_0x527360(0x195)](parseInt,_0x3375aa['ctx'][_0x527360(0x1a9)][_0x527360(0x1a7)]):CONSTANTS[_0x527360(0x1d6)];const _0x53b71e=_0x3375aa[_0x527360(0x234)][_0x527360(0x1fc)],_0x1ec5fc=_0x3375aa[_0x527360(0x234)][_0x527360(0x15e)]['shortname'],_0x359295=_0x3375aa['ctx']['repositories'][_0x527360(0x15c)](),_0x4e6515=_0x3375aa[_0x527360(0x234)][_0x527360(0x1e5)]['getUserRepository'](),_0x382d85=await _0x359295[_0x527360(0x1d8)](_0x1ec5fc),_0x1404de=await _0x359295['isSecretariat'](_0x53b71e);if(!_0x382d85)return logger['info']({'uuid':_0x3375aa[_0x527360(0x234)][_0x527360(0x1aa)],'message':_0x1e9ebe[_0x527360(0x1f2)](_0x1ec5fc,_0x527360(0x191))}),_0xb13fa5[_0x527360(0x22b)](0x194)['json'](error[_0x527360(0x23f)](_0x1ec5fc));if(_0x1ec5fc!==_0x53b71e&&!_0x1404de)return logger[_0x527360(0x237)]({'uuid':_0x3375aa['ctx']['uuid'],'message':_0x1e9ebe[_0x527360(0x1f2)](_0x1ec5fc,_0x1e9ebe[_0x527360(0x1fb)])}),_0xb13fa5[_0x527360(0x22b)](0x193)[_0x527360(0x1a2)](error[_0x527360(0x1c3)]());const _0x4be0c4=setAggregateUserObj({'org_UUID':_0x382d85}),_0x3d124b=await _0x4e6515['aggregatePaginate'](_0x4be0c4,_0x428e33),_0x2eb9a5={'users':_0x3d124b['itemsList']};return _0x1e9ebe['Vplwr'](_0x3d124b[_0x527360(0x160)],CONSTANTS[_0x527360(0x1c0)][_0x527360(0x1e7)])&&(_0x1e9ebe['riafz']!==_0x527360(0x224)?_0x3535eb[_0x527360(0x19c)][_0x527360(0x17e)]=_0x2ce463[_0x527360(0x234)][_0x527360(0x256)]['authority'][_0x527360(0x17e)]:(_0x2eb9a5[_0x527360(0x1eb)]=_0x3d124b[_0x527360(0x160)],_0x2eb9a5[_0x527360(0x186)]=_0x3d124b['itemsPerPage'],_0x2eb9a5[_0x527360(0x1cb)]=_0x3d124b[_0x527360(0x1cb)],_0x2eb9a5[_0x527360(0x1c5)]=_0x3d124b[_0x527360(0x1c5)],_0x2eb9a5[_0x527360(0x231)]=_0x3d124b[_0x527360(0x231)],_0x2eb9a5[_0x527360(0x1f6)]=_0x3d124b[_0x527360(0x1f6)])),logger['info']({'uuid':_0x3375aa['ctx']['uuid'],'message':'The\x20users\x20of\x20'+_0x1ec5fc+_0x527360(0x1b5)}),_0xb13fa5[_0x527360(0x22b)](0xc8)[_0x527360(0x1a2)](_0x2eb9a5);}catch(_0x43919a){_0x35547b(_0x43919a);}}async function getUser(_0x30a180,_0x449ed8,_0xd6eb58){const _0x5872e4=_0x37f03e,_0x2786e1={'ubDPk':function(_0x2a3c9c,_0x133900){return _0x2a3c9c!==_0x133900;},'TrfEo':function(_0x4a262a,_0x1a6f39){return _0x4a262a+_0x1a6f39;},'ttLXx':_0x5872e4(0x217),'fYZSl':function(_0x2ab87f,_0x5e1a0b){return _0x2ab87f+_0x5e1a0b;},'RRoGY':'\x20organization\x20does\x20not\x20exist.','vqkDB':function(_0x96b4c,_0x16b297){return _0x96b4c+_0x16b297;},'BFuTW':function(_0xf20fe7,_0x5d9fd0){return _0xf20fe7(_0x5d9fd0);}};try{const _0x1368d8=_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1fc)],_0x16972e=_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x15e)]['username'],_0x37c6b5=_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x15e)][_0x5872e4(0x215)],_0xbf9f03=_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1e5)][_0x5872e4(0x15c)](),_0x376e3c=await _0xbf9f03[_0x5872e4(0x255)](_0x1368d8);if(_0x2786e1[_0x5872e4(0x23c)](_0x37c6b5,_0x1368d8)&&!_0x376e3c)return logger[_0x5872e4(0x237)]({'uuid':_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1aa)],'message':_0x2786e1[_0x5872e4(0x212)](_0x1368d8,_0x2786e1['ttLXx'])}),_0x449ed8['status'](0x193)[_0x5872e4(0x1a2)](error[_0x5872e4(0x1c3)]());const _0x585ca4=await _0xbf9f03[_0x5872e4(0x1d8)](_0x37c6b5);if(!_0x585ca4)return logger['info']({'uuid':_0x30a180[_0x5872e4(0x234)]['uuid'],'message':_0x2786e1[_0x5872e4(0x1d5)](_0x37c6b5,_0x2786e1[_0x5872e4(0x244)])}),_0x449ed8[_0x5872e4(0x22b)](0x194)[_0x5872e4(0x1a2)](error[_0x5872e4(0x23f)](_0x37c6b5));const _0x2e5c3a=_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1e5)][_0x5872e4(0x19d)](),_0x53b380=setAggregateUserObj({'username':_0x16972e,'org_UUID':_0x585ca4});let _0x56b019=await _0x2e5c3a[_0x5872e4(0x240)](_0x53b380);_0x56b019=_0x56b019[_0x5872e4(0x19e)]>0x0?_0x56b019[0x0]:null;if(!_0x56b019)return logger[_0x5872e4(0x237)]({'uuid':_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1aa)],'message':_0x2786e1[_0x5872e4(0x180)](_0x16972e,_0x5872e4(0x1d3))}),_0x449ed8[_0x5872e4(0x22b)](0x194)[_0x5872e4(0x1a2)](error[_0x5872e4(0x185)](_0x16972e));return logger[_0x5872e4(0x237)]({'uuid':_0x30a180[_0x5872e4(0x234)][_0x5872e4(0x1aa)],'message':_0x16972e+_0x5872e4(0x1ca),'user':_0x56b019}),_0x449ed8['status'](0xc8)[_0x5872e4(0x1a2)](_0x56b019);}catch(_0x3d7ed0){_0x2786e1['BFuTW'](_0xd6eb58,_0x3d7ed0);}}async function getOrgIdQuota(_0x55c5b9,_0x33e05b,_0x36f06e){const _0x11988b=_0x37f03e,_0x11f94c={'Aitjg':function(_0x2a49a7,_0x3b73bc){return _0x2a49a7!==_0x3b73bc;},'TANNi':_0x11988b(0x1b0),'DAtwO':function(_0x3e7f88,_0x40e77b){return _0x3e7f88!==_0x40e77b;},'AhMVv':function(_0x317238,_0x48c0af){return _0x317238+_0x48c0af;},'zZfoU':_0x11988b(0x15d)};try{if(_0x11f94c['Aitjg'](_0x11f94c[_0x11988b(0x197)],_0x11f94c[_0x11988b(0x197)]))_0x34c90f['active']=_0x1b26f3[_0x11988b(0x234)]['query'][_0x11988b(0x167)],_0x22154e=!![];else{const _0x3ec9c2=_0x55c5b9[_0x11988b(0x234)][_0x11988b(0x1fc)],_0x2083a2=_0x55c5b9['ctx'][_0x11988b(0x15e)][_0x11988b(0x215)],_0x4e3c90=_0x55c5b9[_0x11988b(0x234)][_0x11988b(0x1e5)][_0x11988b(0x15c)](),_0x5493ed=await _0x4e3c90[_0x11988b(0x255)](_0x3ec9c2);if(_0x11f94c[_0x11988b(0x1ce)](_0x3ec9c2,_0x2083a2)&&!_0x5493ed)return logger[_0x11988b(0x237)]({'uuid':_0x55c5b9['ctx'][_0x11988b(0x1aa)],'message':_0x11f94c[_0x11988b(0x254)](_0x2083a2,_0x11f94c['zZfoU'])}),_0x33e05b['status'](0x193)[_0x11988b(0x1a2)](error[_0x11988b(0x1c3)]());let _0x1c8486=await _0x4e3c90[_0x11988b(0x230)](_0x2083a2);if(!_0x1c8486)return logger['info']({'uuid':_0x55c5b9['ctx']['uuid'],'message':_0x11f94c['AhMVv'](_0x2083a2,'\x20organization\x20does\x20not\x20exist.')}),_0x33e05b[_0x11988b(0x22b)](0x194)[_0x11988b(0x1a2)](error[_0x11988b(0x23f)](_0x2083a2));const _0x4eea86={'id_quota':_0x1c8486[_0x11988b(0x211)]['id_quota'],'total_reserved':null,'available':null},_0x5d9156={'owning_cna':await _0x4e3c90[_0x11988b(0x1d8)](_0x2083a2),'state':CONSTANTS[_0x11988b(0x1ea)]['RESERVED']},_0x16c269=_0x55c5b9['ctx'][_0x11988b(0x1e5)][_0x11988b(0x178)]();return _0x1c8486=await _0x16c269[_0x11988b(0x1dd)](_0x5d9156),_0x4eea86[_0x11988b(0x24f)]=_0x1c8486,_0x4eea86['available']=_0x4eea86[_0x11988b(0x200)]-_0x4eea86[_0x11988b(0x24f)],logger[_0x11988b(0x237)]({'uuid':_0x55c5b9[_0x11988b(0x234)][_0x11988b(0x1aa)],'message':'The\x20organization\x27s\x20id\x20quota\x20was\x20returned\x20to\x20the\x20user.','details':_0x4eea86}),_0x33e05b[_0x11988b(0x22b)](0xc8)[_0x11988b(0x1a2)](_0x4eea86);}}catch(_0x58392d){_0x36f06e(_0x58392d);}}async function createOrg(_0x3bba07,_0x2d0f17,_0x2a9368){const _0x552c9f=_0x37f03e,_0x259285={'MrSiU':'3|0|1|5|2|4','lUmFV':function(_0x1ed5fa,_0xa23557){return _0x1ed5fa===_0xa23557;},'penjU':_0x552c9f(0x17d),'hQzbS':_0x552c9f(0x1a6),'UPGJB':_0x552c9f(0x19c),'QoJli':_0x552c9f(0x1b1),'UZWRs':_0x552c9f(0x1bd),'GkJUi':'uuid','fRJTp':function(_0x3c5152,_0x16f000){return _0x3c5152+_0x16f000;},'SBxtI':function(_0x1f021a,_0x4777de){return _0x1f021a!==_0x4777de;},'nBuUf':function(_0x5085cd,_0x27eeea){return _0x5085cd+_0x27eeea;},'DiGQQ':'\x20organization\x20was\x20successfully\x20created.','GlpOf':_0x552c9f(0x179),'GUzuN':function(_0x4520cb,_0x1057b3){return _0x4520cb+_0x1057b3;}};try{const _0x9358fd=new Org(),_0x1a1b12=_0x3bba07[_0x552c9f(0x234)][_0x552c9f(0x1e5)]['getOrgRepository']();Object[_0x552c9f(0x17f)](_0x3bba07['ctx'][_0x552c9f(0x256)])[_0x552c9f(0x228)](_0xf4221d=>{const _0x594a52=_0x552c9f,_0x2de24b=_0xf4221d['toLowerCase']();if(_0x259285[_0x594a52(0x25a)](_0x2de24b,_0x259285['penjU']))_0x9358fd[_0x594a52(0x17d)]=_0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x17d)];else{if(_0x2de24b===_0x259285[_0x594a52(0x222)])_0x9358fd[_0x594a52(0x1a6)]=_0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x1a6)];else{if(_0x2de24b===_0x259285[_0x594a52(0x173)]){if(_0x259285[_0x594a52(0x25a)](_0x259285[_0x594a52(0x210)],_0x259285[_0x594a52(0x16e)])){const _0x1c0433=_0x259285['MrSiU']['split']('|');let _0x10e221=0x0;while(!![]){switch(_0x1c0433[_0x10e221++]){case'0':_0x449350[_0x594a52(0x186)]=_0x5a7e6c[_0x594a52(0x186)];continue;case'1':_0x3df76f[_0x594a52(0x1cb)]=_0x1312d8[_0x594a52(0x1cb)];continue;case'2':_0x4395ab[_0x594a52(0x231)]=_0x211ee6['prevPage'];continue;case'3':_0x36fa02[_0x594a52(0x1eb)]=_0x2a6471[_0x594a52(0x160)];continue;case'4':_0xa70437[_0x594a52(0x1f6)]=_0xea2565[_0x594a52(0x1f6)];continue;case'5':_0x43804e[_0x594a52(0x1c5)]=_0x47b472[_0x594a52(0x1c5)];continue;}break;}}else _0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x19c)]['active_roles']&&(_0x9358fd[_0x594a52(0x19c)][_0x594a52(0x17e)]=_0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x19c)][_0x594a52(0x17e)]);}else{if(_0x2de24b==='policies')_0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x211)]['id_quota']&&(_0x9358fd[_0x594a52(0x211)][_0x594a52(0x200)]=_0x3bba07[_0x594a52(0x234)][_0x594a52(0x256)][_0x594a52(0x211)][_0x594a52(0x200)]);else{if(_0x259285[_0x594a52(0x25a)](_0x2de24b,_0x259285['GkJUi']))return _0x2d0f17[_0x594a52(0x22b)](0x190)[_0x594a52(0x1a2)](error[_0x594a52(0x258)]());}}}}});let _0x252ee1=await _0x1a1b12['findOneByShortName'](_0x9358fd[_0x552c9f(0x17d)]);if(_0x252ee1)return _0x552c9f(0x163)===_0x552c9f(0x163)?(logger[_0x552c9f(0x237)]({'uuid':_0x3bba07[_0x552c9f(0x234)]['uuid'],'message':_0x259285['fRJTp'](_0x9358fd[_0x552c9f(0x17d)],_0x552c9f(0x16d))}),_0x2d0f17['status'](0x190)[_0x552c9f(0x1a2)](error[_0x552c9f(0x1df)](_0x9358fd['short_name']))):(_0x175df9['info']({'uuid':_0x224e8b[_0x552c9f(0x234)][_0x552c9f(0x1aa)],'message':_0x35087a+_0x552c9f(0x217)}),_0xebeb02[_0x552c9f(0x22b)](0x193)[_0x552c9f(0x1a2)](_0x2219ed[_0x552c9f(0x1c3)]()));_0x9358fd[_0x552c9f(0x1f3)]=![],_0x9358fd['UUID']=uuid['v4'](),_0x9358fd[_0x552c9f(0x19c)][_0x552c9f(0x17e)]=[CONSTANTS[_0x552c9f(0x15f)][_0x552c9f(0x1b6)]];if(!_0x9358fd[_0x552c9f(0x211)][_0x552c9f(0x200)]){if(_0x259285[_0x552c9f(0x177)](_0x552c9f(0x1ff),_0x552c9f(0x1ff)))return _0x352699[_0x552c9f(0x237)]({'uuid':_0x2a73fb[_0x552c9f(0x234)][_0x552c9f(0x1aa)],'message':_0x552c9f(0x247)+_0x3556bf+_0x552c9f(0x253)}),_0x3d7209['status'](0x193)[_0x552c9f(0x1a2)](_0x306498[_0x552c9f(0x20b)](_0x5ce1e5,_0x2bb677[_0x552c9f(0x214)]));else _0x9358fd[_0x552c9f(0x211)][_0x552c9f(0x200)]=CONSTANTS[_0x552c9f(0x1bf)];}await _0x1a1b12[_0x552c9f(0x20e)](_0x9358fd[_0x552c9f(0x1e4)],_0x9358fd,{'upsert':!![]});const _0x5a05d5=setAggregateOrgObj({'short_name':_0x9358fd[_0x552c9f(0x17d)]});_0x252ee1=await _0x1a1b12[_0x552c9f(0x240)](_0x5a05d5),_0x252ee1=_0x252ee1[_0x552c9f(0x19e)]>0x0?_0x252ee1[0x0]:null;const _0x34932f={'message':_0x259285[_0x552c9f(0x171)](_0x9358fd[_0x552c9f(0x17d)],_0x259285[_0x552c9f(0x24a)]),'created':_0x252ee1},_0x3063fa={'action':_0x259285[_0x552c9f(0x1c6)],'change':_0x259285[_0x552c9f(0x190)](_0x9358fd[_0x552c9f(0x17d)],_0x552c9f(0x23d)),'req_UUID':_0x3bba07[_0x552c9f(0x234)][_0x552c9f(0x1aa)],'org_UUID':await _0x1a1b12[_0x552c9f(0x1d8)](_0x3bba07[_0x552c9f(0x234)][_0x552c9f(0x1fc)]),'org':_0x252ee1},_0x2964ba=_0x3bba07['ctx'][_0x552c9f(0x1e5)][_0x552c9f(0x19d)]();return _0x3063fa['user_UUID']=await _0x2964ba['getUserUUID'](_0x3bba07['ctx']['user'],_0x3063fa['org_UUID']),logger['info'](JSON['stringify'](_0x3063fa)),_0x2d0f17[_0x552c9f(0x22b)](0xc8)[_0x552c9f(0x1a2)](_0x34932f);}catch(_0x542935){_0x2a9368(_0x542935);}}async function updateOrg(_0x41b8cf,_0x381bd3,_0xf1de99){const _0x2dd4ce=_0x37f03e,_0x2bddf4={'DSALw':function(_0x29af66,_0x81a7be){return _0x29af66+_0x81a7be;},'WLEJO':_0x2dd4ce(0x215),'mbIBZ':_0x2dd4ce(0x1de),'jCEvo':_0x2dd4ce(0x1dc),'CMtEe':_0x2dd4ce(0x1ba),'xjxpj':function(_0x250fe9,_0x399f51){return _0x250fe9>_0x399f51;},'lAhgr':function(_0x2d347a,_0x161e00){return _0x2d347a(_0x161e00);},'yhgcT':_0x2dd4ce(0x193),'Yndkg':_0x2dd4ce(0x207),'uTzgo':function(_0x189f1f,_0x49c304){return _0x189f1f(_0x49c304);}};try{const _0x4c4033=_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x15e)][_0x2dd4ce(0x215)],_0x1423bd=new Org(),_0x18a26b=[],_0x4a365b=[],_0x2ae1a6=_0x41b8cf['ctx'][_0x2dd4ce(0x1e5)]['getOrgRepository'](),_0x34029f=await _0x2ae1a6[_0x2dd4ce(0x230)](_0x4c4033);let _0x6c3386=_0x2bddf4[_0x2dd4ce(0x1e1)](setAggregateOrgObj,{'short_name':_0x4c4033});if(!_0x34029f)return logger[_0x2dd4ce(0x237)]({'uuid':_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x1aa)],'message':_0x2bddf4[_0x2dd4ce(0x1ab)](_0x4c4033,_0x2dd4ce(0x209))}),_0x381bd3['status'](0x194)['json'](error[_0x2dd4ce(0x23f)](_0x4c4033));Object[_0x2dd4ce(0x17f)](_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x1a9)])[_0x2dd4ce(0x228)](_0x414a1=>{const _0x3d4c85=_0x2dd4ce,_0x32a408={'MDtnX':function(_0x45137c,_0x3d21cc){const _0x47af2b=_0x4f20;return _0x2bddf4[_0x47af2b(0x1ab)](_0x45137c,_0x3d21cc);},'jsjOz':'\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.'},_0x196dcd=_0x414a1[_0x3d4c85(0x168)]();if(_0x196dcd===_0x2bddf4[_0x3d4c85(0x21e)])_0x1423bd['short_name']=_0x41b8cf[_0x3d4c85(0x234)][_0x3d4c85(0x1a9)][_0x3d4c85(0x215)],_0x6c3386=setAggregateOrgObj({'short_name':_0x1423bd[_0x3d4c85(0x17d)]});else{if(_0x196dcd===_0x3d4c85(0x1a6))_0x1423bd['name']=_0x41b8cf['ctx'][_0x3d4c85(0x1a9)][_0x3d4c85(0x1a6)];else{if(_0x196dcd===_0x3d4c85(0x200)){if('cERVN'!==_0x2bddf4[_0x3d4c85(0x1da)])return _0x512bfa[_0x3d4c85(0x237)]({'uuid':_0x45141b[_0x3d4c85(0x234)][_0x3d4c85(0x1aa)],'message':_0x32a408[_0x3d4c85(0x1a1)](_0x3f60c1,_0x32a408[_0x3d4c85(0x216)])}),_0xf75dd6[_0x3d4c85(0x22b)](0x193)[_0x3d4c85(0x1a2)](_0x212d8f[_0x3d4c85(0x1c3)]());else _0x1423bd['policies'][_0x3d4c85(0x200)]=_0x41b8cf[_0x3d4c85(0x234)][_0x3d4c85(0x1a9)]['id_quota'];}else{if(_0x196dcd==='active_roles.add')Array[_0x3d4c85(0x20c)](_0x41b8cf[_0x3d4c85(0x234)]['query'][_0x2bddf4['jCEvo']])&&_0x41b8cf['ctx'][_0x3d4c85(0x1a9)][_0x2bddf4['jCEvo']][_0x3d4c85(0x228)](_0xe6d4b=>{const _0xc1a580=_0x3d4c85;_0x4a365b[_0xc1a580(0x20d)](_0xe6d4b);});else _0x196dcd===_0x3d4c85(0x1ba)&&(Array['isArray'](_0x41b8cf[_0x3d4c85(0x234)][_0x3d4c85(0x1a9)][_0x3d4c85(0x1ba)])&&('RBfip'!=='RBfip'?_0x5aaa99[_0x3d4c85(0x19b)](_0x44ff40,0x1):_0x41b8cf[_0x3d4c85(0x234)][_0x3d4c85(0x1a9)][_0x2bddf4[_0x3d4c85(0x170)]]['forEach'](_0x215a56=>{const _0x10408d=_0x3d4c85;_0x18a26b[_0x10408d(0x20d)](_0x215a56);})));}}}});if(_0x34029f){const _0x4119a8=_0x34029f[_0x2dd4ce(0x19c)][_0x2dd4ce(0x17e)];_0x4a365b[_0x2dd4ce(0x228)](_0x47f837=>{const _0x5621e1=_0x2dd4ce;!_0x4119a8['includes'](_0x47f837)&&_0x4119a8[_0x5621e1(0x20d)](_0x47f837);}),_0x18a26b[_0x2dd4ce(0x228)](_0x359cfd=>{const _0x173be5=_0x2dd4ce,_0x4c4043=_0x4119a8['indexOf'](_0x359cfd);_0x2bddf4[_0x173be5(0x235)](_0x4c4043,-0x1)&&_0x4119a8[_0x173be5(0x19b)](_0x4c4043,0x1);}),_0x1423bd[_0x2dd4ce(0x19c)][_0x2dd4ce(0x17e)]=_0x4119a8;}if(_0x1423bd[_0x2dd4ce(0x17d)]){const _0x151441=await _0x2ae1a6[_0x2dd4ce(0x230)](_0x1423bd[_0x2dd4ce(0x17d)]);if(_0x151441){if(_0x2bddf4[_0x2dd4ce(0x1f5)]===_0x2dd4ce(0x193))return _0x381bd3[_0x2dd4ce(0x22b)](0x193)['json'](error[_0x2dd4ce(0x172)](_0x1423bd[_0x2dd4ce(0x17d)]));else _0x5b22d8[_0x2dd4ce(0x1a6)][_0x2dd4ce(0x1ee)]='';}}let _0xb37a=await _0x2ae1a6[_0x2dd4ce(0x20e)](_0x34029f[_0x2dd4ce(0x1e4)],_0x1423bd);if(_0xb37a['n']===0x0)return logger[_0x2dd4ce(0x237)]({'uuid':_0x41b8cf['ctx']['uuid'],'message':_0x4c4033+_0x2dd4ce(0x209)}),_0x381bd3['status'](0x194)[_0x2dd4ce(0x1a2)](error[_0x2dd4ce(0x23f)](_0x4c4033));_0xb37a=await _0x2ae1a6[_0x2dd4ce(0x240)](_0x6c3386),_0xb37a=_0xb37a['length']>0x0?_0xb37a[0x0]:null;const _0x5e76da={'message':_0x4c4033+'\x20organization\x20was\x20successfully\x20updated.','updated':_0xb37a},_0x5a1af1={'action':_0x2dd4ce(0x233),'change':_0x4c4033+_0x2bddf4[_0x2dd4ce(0x205)],'req_UUID':_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x1aa)],'org_UUID':await _0x2ae1a6[_0x2dd4ce(0x1d8)](_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x1fc)]),'org':_0xb37a},_0x1a68fe=_0x41b8cf[_0x2dd4ce(0x234)][_0x2dd4ce(0x1e5)][_0x2dd4ce(0x19d)]();return _0x5a1af1[_0x2dd4ce(0x1c8)]=await _0x1a68fe['getUserUUID'](_0x41b8cf[_0x2dd4ce(0x234)]['user'],_0x5a1af1[_0x2dd4ce(0x21d)]),logger[_0x2dd4ce(0x237)](JSON[_0x2dd4ce(0x15b)](_0x5a1af1)),_0x381bd3[_0x2dd4ce(0x22b)](0xc8)[_0x2dd4ce(0x1a2)](_0x5e76da);}catch(_0x5ba305){_0x2bddf4[_0x2dd4ce(0x223)](_0xf1de99,_0x5ba305);}}async function createUser(_0x2a8c87,_0x3f73b0,_0x4348b7){const _0x2edfb7=_0x37f03e,_0xbf429a={'hxlvP':_0x2edfb7(0x247),'UEZZM':_0x2edfb7(0x253),'ifcEv':function(_0xa9c114,_0x261ed2){return _0xa9c114===_0x261ed2;},'rguRd':'sFORH','ReudU':function(_0x4094df,_0x30fa3d){return _0x4094df===_0x30fa3d;},'PLCpa':function(_0x4c1bc2,_0x1352f7){return _0x4c1bc2===_0x1352f7;},'eEMkc':'uuid','DBsOj':_0x2edfb7(0x191),'JdYPn':_0x2edfb7(0x1f0),'rVnpC':'The\x20user\x20could\x20not\x20be\x20created\x20because\x20','ZHbSJ':function(_0x5851f5,_0x208ace){return _0x5851f5&&_0x208ace;},'uZlZk':function(_0x184cc2,_0x480f31){return _0x184cc2!==_0x480f31;},'WLiiK':_0x2edfb7(0x238),'BKlHa':function(_0x2bc225,_0x583ae2){return _0x2bc225(_0x583ae2);},'KVjNo':function(_0x232ed4,_0x1abd55){return _0x232ed4(_0x1abd55);},'KDpOt':function(_0x3733cb,_0x29f8e2){return _0x3733cb(_0x29f8e2);},'mJGoW':function(_0x5e4c96,_0x2e8eb0){return _0x5e4c96+_0x2e8eb0;},'eXgWo':_0x2edfb7(0x23e),'xFOUr':function(_0x2a1f70,_0x91d85e){return _0x2a1f70(_0x91d85e);}};try{const _0x1475a5=_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x15e)]['shortname'],_0x5372b9=_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x1be)],_0x333315=_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x1fc)],_0x3aadcb=_0x2a8c87[_0x2edfb7(0x234)]['repositories']['getOrgRepository'](),_0x482a67=_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x1e5)][_0x2edfb7(0x19d)](),_0x44879b=new User(),_0x44de08=await _0x3aadcb[_0x2edfb7(0x1d8)](_0x1475a5);if(!_0x44de08)return _0xbf429a[_0x2edfb7(0x221)]!==_0x2edfb7(0x1f0)?(_0x16ec63[_0x2edfb7(0x237)]({'uuid':_0x408c48[_0x2edfb7(0x234)][_0x2edfb7(0x1aa)],'message':_0xbf429a[_0x2edfb7(0x182)]+_0x183820+_0xbf429a['UEZZM']}),_0x3eba38[_0x2edfb7(0x22b)](0x193)[_0x2edfb7(0x1a2)](_0x1dd1c1[_0x2edfb7(0x20b)](_0x4ec87a,_0x27d279[_0x2edfb7(0x214)]))):(logger['info']({'uuid':_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x1aa)],'message':_0xbf429a[_0x2edfb7(0x225)]+_0x1475a5+_0x2edfb7(0x191)}),_0x3f73b0[_0x2edfb7(0x22b)](0x194)[_0x2edfb7(0x1a2)](error[_0x2edfb7(0x23f)](_0x1475a5)));Object['keys'](_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x256)])[_0x2edfb7(0x228)](_0x5d2774=>{const _0x57430b=_0x2edfb7,_0x146e50=_0x5d2774[_0x57430b(0x168)]();if(_0xbf429a[_0x57430b(0x1b7)](_0x146e50,'username'))_0x57430b(0x22a)!==_0xbf429a[_0x57430b(0x1c1)]?_0x150df3[_0x57430b(0x20c)](_0x1977ef[_0x57430b(0x234)][_0x57430b(0x1a9)][_0x57430b(0x1ba)])&&(_0x58d2df['ctx'][_0x57430b(0x1a9)][_0x57430b(0x1ba)][_0x57430b(0x228)](_0x402bfb=>{const _0x531d46=_0x57430b;_0x3a46c0[_0x531d46(0x20d)](_0x402bfb);}),_0x23088e=!![]):_0x44879b[_0x57430b(0x214)]=_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)]['username'];else{if(_0xbf429a[_0x57430b(0x1c7)](_0x146e50,_0x57430b(0x19c)))_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)]['authority']['active_roles']&&(_0x44879b[_0x57430b(0x19c)][_0x57430b(0x17e)]=_0x2a8c87['ctx'][_0x57430b(0x256)]['authority'][_0x57430b(0x17e)]);else{if(_0x146e50===_0x57430b(0x1a6))_0x2a8c87[_0x57430b(0x234)]['body'][_0x57430b(0x1a6)]['first']&&(_0x44879b[_0x57430b(0x1a6)][_0x57430b(0x1ee)]=_0x2a8c87['ctx'][_0x57430b(0x256)][_0x57430b(0x1a6)][_0x57430b(0x1ee)]),_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)]['name']['last']&&(_0x44879b[_0x57430b(0x1a6)]['last']=_0x2a8c87[_0x57430b(0x234)]['body'][_0x57430b(0x1a6)][_0x57430b(0x1af)]),_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)]['name']['middle']&&(_0x44879b[_0x57430b(0x1a6)][_0x57430b(0x1e2)]=_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)][_0x57430b(0x1a6)]['middle']),_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)][_0x57430b(0x1a6)][_0x57430b(0x198)]&&(_0x44879b['name'][_0x57430b(0x198)]=_0x2a8c87[_0x57430b(0x234)][_0x57430b(0x256)]['name'][_0x57430b(0x198)]);else{if(_0x146e50==='org_uuid')return _0x3f73b0['status'](0x190)[_0x57430b(0x1a2)](error[_0x57430b(0x258)]());else{if(_0xbf429a[_0x57430b(0x226)](_0x146e50,_0xbf429a[_0x57430b(0x1d0)]))return _0x3f73b0[_0x57430b(0x22b)](0x190)[_0x57430b(0x1a2)](error[_0x57430b(0x258)]());}}}}});const _0xb4fcaa=await _0x3aadcb[_0x2edfb7(0x1d8)](_0x333315),_0x29edf9=await _0x3aadcb[_0x2edfb7(0x175)](_0xb4fcaa),_0xf44fb6=await _0x482a67[_0x2edfb7(0x227)](_0x5372b9,_0xb4fcaa);if(_0xbf429a[_0x2edfb7(0x174)](!_0x29edf9,_0xf44fb6)){if(_0xbf429a[_0x2edfb7(0x1ef)](_0xb4fcaa,_0x44de08)){if('sbSYc'!==_0xbf429a[_0x2edfb7(0x1bc)])_0x422393[_0x2edfb7(0x1a6)][_0x2edfb7(0x1e2)]='';else return _0x3f73b0[_0x2edfb7(0x22b)](0x193)['json'](error['notOrgAdminOrSecretariat']());}}_0x44879b[_0x2edfb7(0x21d)]=_0x44de08,_0x44879b['UUID']=uuid['v4'](),_0x44879b[_0x2edfb7(0x167)]=!![];const _0x1d5f61=_0xbf429a['BKlHa'](cryptoRandomString,{'length':CONSTANTS[_0x2edfb7(0x22f)]});_0x44879b[_0x2edfb7(0x1f4)]=await argon2[_0x2edfb7(0x1bb)](_0x1d5f61);let _0xf246aa=await _0x482a67[_0x2edfb7(0x16a)](_0x44879b['username'],_0x44879b['org_UUID']);if(_0xf246aa)return logger[_0x2edfb7(0x237)]({'uuid':_0x2a8c87[_0x2edfb7(0x234)]['uuid'],'message':_0x44879b[_0x2edfb7(0x214)]+_0x2edfb7(0x187)}),_0x3f73b0[_0x2edfb7(0x22b)](0x190)['json'](error['userExists'](_0x44879b[_0x2edfb7(0x214)]));_0x44879b[_0x2edfb7(0x1a6)]=_0xbf429a[_0x2edfb7(0x1f8)](parseUserName,_0x44879b),await _0x482a67['updateByUserNameAndOrgUUID'](_0x44879b[_0x2edfb7(0x214)],_0x44879b[_0x2edfb7(0x21d)],_0x44879b,{'upsert':!![]});const _0x4a948d=_0xbf429a[_0x2edfb7(0x1cc)](setAggregateUserObj,{'username':_0x44879b['username'],'org_UUID':_0x44879b[_0x2edfb7(0x21d)]});_0xf246aa=await _0x482a67[_0x2edfb7(0x240)](_0x4a948d),_0xf246aa=_0xf246aa[_0x2edfb7(0x19e)]>0x0?_0xf246aa[0x0]:null;const _0x17f352={'action':_0x2edfb7(0x1fd),'change':_0xbf429a[_0x2edfb7(0x249)](_0xf246aa[_0x2edfb7(0x214)],_0x2edfb7(0x23e)),'req_UUID':_0x2a8c87[_0x2edfb7(0x234)]['uuid'],'org_UUID':await _0x3aadcb[_0x2edfb7(0x1d8)](_0x2a8c87[_0x2edfb7(0x234)][_0x2edfb7(0x1fc)]),'user':_0xf246aa};_0x17f352[_0x2edfb7(0x1c8)]=await _0x482a67['getUserUUID'](_0x2a8c87[_0x2edfb7(0x234)]['user'],_0x17f352[_0x2edfb7(0x21d)]),logger['info'](JSON[_0x2edfb7(0x15b)](_0x17f352)),_0xf246aa[_0x2edfb7(0x1f4)]=_0x1d5f61;const _0xc81425={'message':_0xf246aa[_0x2edfb7(0x214)]+_0xbf429a[_0x2edfb7(0x196)],'created':_0xf246aa};return _0x3f73b0[_0x2edfb7(0x22b)](0xc8)[_0x2edfb7(0x1a2)](_0xc81425);}catch(_0x3287b8){if(_0x2edfb7(0x169)!=='rCwfw')return _0x1cdd4b['info']({'uuid':_0x3a3bd2[_0x2edfb7(0x234)][_0x2edfb7(0x1aa)],'message':_0x36cadc+_0xbf429a[_0x2edfb7(0x1db)]}),_0x4113ed[_0x2edfb7(0x22b)](0x194)[_0x2edfb7(0x1a2)](_0x138e9d[_0x2edfb7(0x23f)](_0x17eeae));else _0xbf429a['xFOUr'](_0x4348b7,_0x3287b8);}}async function updateUser(_0x5bb6d0,_0x572243,_0x235a54){const _0x1a0bb0=_0x37f03e,_0x43dbb6={'yHAol':function(_0x209543,_0x1c366e){return _0x209543===_0x1c366e;},'Dwaos':'new_username','ujPLA':function(_0xecd91c,_0x4d136c){return _0xecd91c===_0x4d136c;},'ecvfY':_0x1a0bb0(0x162),'PHSYk':_0x1a0bb0(0x1e8),'BpnRX':function(_0x30586e,_0x3d7e60){return _0x30586e===_0x3d7e60;},'BxkBX':_0x1a0bb0(0x18d),'XofEL':function(_0x1aea62,_0x360e26){return _0x1aea62===_0x360e26;},'wdBwZ':'name.middle','gTbKE':_0x1a0bb0(0x1dc),'SncRL':function(_0x43a834,_0x4d00b5){return _0x43a834===_0x4d00b5;},'btUxh':'active_roles.remove','zzQIQ':_0x1a0bb0(0x1a5),'MJAhL':function(_0x39471b,_0x3433c7){return _0x39471b+_0x3433c7;},'vojXv':_0x1a0bb0(0x1cd),'rziBJ':_0x1a0bb0(0x247),'QGSwb':_0x1a0bb0(0x176),'SUhvW':function(_0x39780a,_0x338106){return _0x39780a!==_0x338106;},'tvZKl':_0x1a0bb0(0x25b),'ShTxK':function(_0x470440,_0x2e2c21){return _0x470440||_0x2e2c21;},'CVeSY':function(_0xed9d5d,_0x17c9c3){return _0xed9d5d(_0x17c9c3);},'AZpoS':function(_0x272847,_0x4db811){return _0x272847+_0x4db811;},'gnaGr':'\x20organization\x20contains\x20a\x20user\x20with\x20the\x20same\x20username.','jdhgR':_0x1a0bb0(0x1b9),'Iwfnt':_0x1a0bb0(0x245),'ZcHEw':function(_0x1b3538,_0x5ea393){return _0x1b3538+_0x5ea393;},'qOjhB':function(_0x1e73d1,_0x3b9cb9){return _0x1e73d1+_0x3b9cb9;},'UxmYp':_0x1a0bb0(0x1b3),'uJYfT':function(_0x296a53,_0x3e9c5a){return _0x296a53>_0x3e9c5a;},'FsvtX':function(_0xb9d440,_0x436ff8){return _0xb9d440+_0x436ff8;},'RJmXp':_0x1a0bb0(0x1a4),'IuFsp':function(_0x362a2f,_0x54d556){return _0x362a2f(_0x54d556);}};try{const _0x43bc8c=_0x5bb6d0['ctx'][_0x1a0bb0(0x1fc)],_0x19b101=_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1be)],_0x5246d6=_0x5bb6d0['ctx']['params'][_0x1a0bb0(0x214)],_0x7a9d15=_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x15e)][_0x1a0bb0(0x215)],_0x11ed00=new User();let _0x398da7,_0x2be3ee;const _0x5e2a37=[],_0x233a21=[],_0x354bc9=_0x5bb6d0[_0x1a0bb0(0x234)]['repositories']['getUserRepository'](),_0x107b7c=_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1e5)][_0x1a0bb0(0x15c)](),_0x23e790=await _0x107b7c[_0x1a0bb0(0x1d8)](_0x7a9d15),_0x1d4de5=await _0x107b7c['isSecretariat'](_0x43bc8c),_0x29390d=await _0x354bc9['isAdmin'](_0x19b101,_0x43bc8c);if(!_0x23e790)return logger['info']({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x43dbb6[_0x1a0bb0(0x1c2)](_0x43dbb6['MJAhL'](_0x1a0bb0(0x247),_0x7a9d15),_0x1a0bb0(0x191))}),_0x572243['status'](0x194)[_0x1a0bb0(0x1a2)](error['orgDneParam'](_0x7a9d15));if(_0x7a9d15!==_0x43bc8c&&!_0x1d4de5)return _0x43dbb6['SncRL'](_0x43dbb6['vojXv'],_0x43dbb6[_0x1a0bb0(0x23b)])?(logger[_0x1a0bb0(0x237)]({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x7a9d15+_0x1a0bb0(0x1b2)}),_0x572243[_0x1a0bb0(0x22b)](0x193)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x1c3)]())):[{'$match':_0x19686e},{'$project':{'_id':![],'username':!![],'name':!![],'UUID':!![],'org_UUID':!![],'active':!![],'authority.active_roles':!![],'time':!![]}}];const _0x3b0c8a=await _0x354bc9['findOneByUserNameAndOrgUUID'](_0x5246d6,_0x23e790);if(!_0x3b0c8a)return logger[_0x1a0bb0(0x237)]({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)]['uuid'],'message':_0x43dbb6[_0x1a0bb0(0x1c2)](_0x43dbb6[_0x1a0bb0(0x1c2)](_0x43dbb6[_0x1a0bb0(0x194)]+_0x5246d6,'\x20does\x20not\x20exist\x20for\x20'),_0x7a9d15)+_0x43dbb6[_0x1a0bb0(0x1e0)]}),_0x572243[_0x1a0bb0(0x22b)](0x194)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x185)](_0x5246d6));if((_0x7a9d15!==_0x43bc8c||_0x5246d6!==_0x19b101)&&!_0x1d4de5){if(!_0x29390d||_0x29390d&&_0x43dbb6[_0x1a0bb0(0x239)](_0x7a9d15,_0x43bc8c))return logger['info']({'uuid':_0x5bb6d0['ctx'][_0x1a0bb0(0x1aa)],'message':_0x43dbb6[_0x1a0bb0(0x1c4)]}),_0x572243[_0x1a0bb0(0x22b)](0x193)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x18c)]());}Object['keys'](_0x5bb6d0['ctx'][_0x1a0bb0(0x1a9)])[_0x1a0bb0(0x228)](_0x2482ff=>{const _0x572359=_0x1a0bb0,_0x285928=_0x2482ff[_0x572359(0x168)]();if(_0x43dbb6[_0x572359(0x1ec)](_0x285928,_0x43dbb6[_0x572359(0x250)]))_0x11ed00[_0x572359(0x214)]=_0x5bb6d0['ctx'][_0x572359(0x1a9)][_0x572359(0x24e)];else{if(_0x43dbb6['ujPLA'](_0x285928,_0x572359(0x22e)))_0x43dbb6[_0x572359(0x184)]!==_0x43dbb6['PHSYk']?(_0x398da7=_0x5bb6d0['ctx'][_0x572359(0x1a9)][_0x572359(0x22e)],_0x2be3ee=!![]):_0x2f02bf['name'][_0x572359(0x198)]=_0x442536['ctx'][_0x572359(0x1a9)]['name.suffix'];else{if(_0x43dbb6[_0x572359(0x213)](_0x285928,'name.first'))_0x11ed00[_0x572359(0x1a6)][_0x572359(0x1ee)]=_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)]['name.first'];else{if(_0x285928===_0x43dbb6[_0x572359(0x23a)])_0x11ed00[_0x572359(0x1a6)][_0x572359(0x1af)]=_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)][_0x572359(0x18d)];else{if(_0x43dbb6['XofEL'](_0x285928,_0x43dbb6[_0x572359(0x243)]))_0x11ed00[_0x572359(0x1a6)][_0x572359(0x1e2)]=_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)][_0x43dbb6[_0x572359(0x243)]];else{if(_0x43dbb6[_0x572359(0x204)](_0x285928,_0x572359(0x1ac)))_0x11ed00[_0x572359(0x1a6)][_0x572359(0x198)]=_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)][_0x572359(0x1ac)];else{if(_0x285928===_0x572359(0x167))_0x11ed00[_0x572359(0x167)]=_0x5bb6d0['ctx'][_0x572359(0x1a9)][_0x572359(0x167)],_0x2be3ee=!![];else{if(_0x285928===_0x43dbb6[_0x572359(0x159)])Array[_0x572359(0x20c)](_0x5bb6d0[_0x572359(0x234)]['query'][_0x43dbb6[_0x572359(0x159)]])&&(_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)]['active_roles.add'][_0x572359(0x228)](_0x1cf4cd=>{const _0x4ad357=_0x572359;_0x233a21[_0x4ad357(0x20d)](_0x1cf4cd);}),_0x2be3ee=!![]);else _0x43dbb6['SncRL'](_0x285928,_0x43dbb6[_0x572359(0x1d4)])&&(Array[_0x572359(0x20c)](_0x5bb6d0[_0x572359(0x234)][_0x572359(0x1a9)][_0x572359(0x1ba)])&&(_0x5bb6d0['ctx'][_0x572359(0x1a9)]['active_roles.remove'][_0x572359(0x228)](_0x391dde=>{const _0x6077b=_0x572359;_0x5e2a37[_0x6077b(0x20d)](_0x391dde);}),_0x2be3ee=!![]));}}}}}}}});if(_0x2be3ee&&!_0x43dbb6[_0x1a0bb0(0x202)](_0x29390d,_0x1d4de5))return logger['info']({'uuid':_0x5bb6d0['ctx'][_0x1a0bb0(0x1aa)],'message':'The\x20user\x20could\x20not\x20be\x20updated\x20because\x20'+_0x19b101+_0x1a0bb0(0x218)}),_0x572243[_0x1a0bb0(0x22b)](0x193)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x20f)]());if(_0x398da7){_0x11ed00[_0x1a0bb0(0x21d)]=await _0x107b7c[_0x1a0bb0(0x1d8)](_0x398da7);if(!_0x11ed00[_0x1a0bb0(0x21d)])return logger['info']({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x43dbb6['rziBJ']+_0x398da7+_0x1a0bb0(0x191)}),_0x572243['status'](0x194)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x1d2)](_0x398da7));}let _0x364917=setAggregateUserObj({'username':_0x5246d6,'org_UUID':_0x23e790});if(_0x11ed00[_0x1a0bb0(0x214)]&&_0x11ed00[_0x1a0bb0(0x21d)]){_0x364917=_0x43dbb6['CVeSY'](setAggregateUserObj,{'username':_0x11ed00[_0x1a0bb0(0x214)],'org_UUID':_0x11ed00[_0x1a0bb0(0x21d)]});const _0xd0cd13=await _0x354bc9[_0x1a0bb0(0x16b)]({'org_UUID':_0x11ed00[_0x1a0bb0(0x21d)],'username':_0x11ed00['username']});if(_0xd0cd13[_0x1a0bb0(0x19e)])return logger['info']({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x43dbb6[_0x1a0bb0(0x1c2)](_0x43dbb6['AZpoS']('The\x20user\x20could\x20not\x20be\x20updated\x20because\x20',_0x398da7),_0x43dbb6[_0x1a0bb0(0x201)])}),_0x572243[_0x1a0bb0(0x22b)](0x193)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x20b)](_0x398da7,_0x11ed00[_0x1a0bb0(0x214)]));}else{if(_0x11ed00[_0x1a0bb0(0x214)]){_0x364917=setAggregateUserObj({'username':_0x11ed00['username'],'org_UUID':_0x23e790});const _0x52230c=await _0x354bc9['find']({'org_UUID':_0x23e790,'username':_0x11ed00[_0x1a0bb0(0x214)]});if(_0x52230c[_0x1a0bb0(0x19e)])return logger['info']({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x1a0bb0(0x247)+_0x7a9d15+'\x20organization\x20contains\x20a\x20user\x20with\x20the\x20same\x20username.'}),_0x572243[_0x1a0bb0(0x22b)](0x193)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x20b)](_0x7a9d15,_0x11ed00['username']));}else{if(_0x11ed00['org_UUID']){if(_0x43dbb6['jdhgR']===_0x1a0bb0(0x1b9)){_0x364917=setAggregateUserObj({'username':_0x5246d6,'org_UUID':_0x11ed00[_0x1a0bb0(0x21d)]});const _0x1916f6=await _0x354bc9[_0x1a0bb0(0x16b)]({'org_UUID':_0x11ed00[_0x1a0bb0(0x21d)],'username':_0x5246d6});if(_0x1916f6[_0x1a0bb0(0x19e)])return logger[_0x1a0bb0(0x237)]({'uuid':_0x5bb6d0['ctx'][_0x1a0bb0(0x1aa)],'message':_0x43dbb6[_0x1a0bb0(0x259)](_0x43dbb6['rziBJ']+_0x398da7,_0x43dbb6['gnaGr'])}),_0x572243[_0x1a0bb0(0x22b)](0x193)['json'](error[_0x1a0bb0(0x20b)](_0x398da7,_0x5246d6));}else!_0x592d1d[_0x1a0bb0(0x252)](_0x3a88a4)&&_0x477006[_0x1a0bb0(0x20d)](_0x95bb08);}}}const _0x5a5343=_0x3b0c8a[_0x1a0bb0(0x19c)][_0x1a0bb0(0x17e)];_0x233a21[_0x1a0bb0(0x228)](_0x2203ae=>{const _0xcd462b=_0x1a0bb0;!_0x5a5343[_0xcd462b(0x252)](_0x2203ae)&&('iDIqX'===_0x43dbb6[_0xcd462b(0x192)]?_0x3f722a[_0xcd462b(0x20c)](_0x107fab[_0xcd462b(0x234)][_0xcd462b(0x1a9)][_0x43dbb6[_0xcd462b(0x1d4)]])&&_0x4ac595['ctx'][_0xcd462b(0x1a9)][_0xcd462b(0x1ba)]['forEach'](_0x548c41=>{const _0x2e2f93=_0xcd462b;_0x42a8dd[_0x2e2f93(0x20d)](_0x548c41);}):_0x5a5343[_0xcd462b(0x20d)](_0x2203ae));}),_0x5e2a37[_0x1a0bb0(0x228)](_0x42cd4a=>{const _0x5cf5c5=_0x1a0bb0,_0x185bd7=_0x5a5343[_0x5cf5c5(0x251)](_0x42cd4a);_0x185bd7>-0x1&&_0x5a5343[_0x5cf5c5(0x19b)](_0x185bd7,0x1);}),_0x11ed00[_0x1a0bb0(0x19c)]['active_roles']=_0x5a5343;let _0x43978a=await _0x354bc9[_0x1a0bb0(0x1a8)](_0x5246d6,_0x23e790,_0x11ed00);if(_0x43dbb6[_0x1a0bb0(0x18e)](_0x43978a['n'],0x0)){if('LhcIZ'===_0x43dbb6[_0x1a0bb0(0x15a)])return logger[_0x1a0bb0(0x237)]({'uuid':_0x5bb6d0[_0x1a0bb0(0x234)][_0x1a0bb0(0x1aa)],'message':_0x43dbb6[_0x1a0bb0(0x1a0)](_0x43dbb6['qOjhB'](_0x1a0bb0(0x247)+_0x5246d6,_0x43dbb6['UxmYp'])+_0x7a9d15,_0x1a0bb0(0x176))}),_0x572243['status'](0x194)[_0x1a0bb0(0x1a2)](error[_0x1a0bb0(0x185)](_0x5246d6));else _0x57f9c4[_0x1a0bb0(0x19c)][_0x1a0bb0(0x17e)]=_0x300d9a['ctx'][_0x1a0bb0(0x256)][_0x1a0bb0(0x19c)][_0x1a0bb0(0x17e)];}_0x43978a=await _0x354bc9[_0x1a0bb0(0x240)](_0x364917),_0x43978a=_0x43dbb6[_0x1a0bb0(0x236)](_0x43978a['length'],0x0)?_0x43978a[0x0]:null;const _0x52fe8f={'message':_0x43dbb6[_0x1a0bb0(0x24c)](_0x5246d6,_0x1a0bb0(0x1a4)),'updated':_0x43978a},_0x2ccfd4={'action':_0x1a0bb0(0x1f7),'change':_0x5246d6+_0x43dbb6[_0x1a0bb0(0x199)],'req_UUID':_0x5bb6d0[_0x1a0bb0(0x234)]['uuid'],'org_UUID':await _0x107b7c[_0x1a0bb0(0x1d8)](_0x5bb6d0['ctx'][_0x1a0bb0(0x1fc)]),'user':_0x43978a};return _0x2ccfd4[_0x1a0bb0(0x1c8)]=await _0x354bc9['getUserUUID'](_0x5bb6d0['ctx'][_0x1a0bb0(0x1be)],_0x2ccfd4[_0x1a0bb0(0x21d)]),logger[_0x1a0bb0(0x237)](JSON[_0x1a0bb0(0x15b)](_0x2ccfd4)),_0x572243[_0x1a0bb0(0x22b)](0xc8)[_0x1a0bb0(0x1a2)](_0x52fe8f);}catch(_0x181431){_0x43dbb6[_0x1a0bb0(0x1e6)](_0x235a54,_0x181431);}}async function resetSecret(_0x2ac65c,_0x6b578a,_0x42404f){const _0x1ae2e2=_0x37f03e,_0x5eae51={'fgGKp':function(_0xa61da2,_0x83ee3c){return _0xa61da2+_0x83ee3c;},'hyzDA':_0x1ae2e2(0x191),'JbYuJ':_0x1ae2e2(0x1b2),'CySQK':function(_0x13565a,_0x541939){return _0x13565a!==_0x541939;},'hIgEu':_0x1ae2e2(0x220),'NKyEr':function(_0xa193a6,_0x304dbc){return _0xa193a6===_0x304dbc;},'XuiFU':_0x1ae2e2(0x1b3),'ZuxkD':_0x1ae2e2(0x21f),'NVirF':function(_0x423790,_0x8ae5de){return _0x423790(_0x8ae5de);}};try{const _0x4085a7=_0x2ac65c['ctx'][_0x1ae2e2(0x1fc)],_0x4a1b07=_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1be)],_0x1b75c9=_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x15e)][_0x1ae2e2(0x214)],_0x3af120=_0x2ac65c[_0x1ae2e2(0x234)]['params'][_0x1ae2e2(0x215)],_0x5119cf=_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1e5)]['getUserRepository'](),_0x30ee95=_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1e5)]['getOrgRepository'](),_0x11a3ea=await _0x30ee95[_0x1ae2e2(0x255)](_0x4085a7),_0x11a1f3=await _0x30ee95[_0x1ae2e2(0x1d8)](_0x3af120);if(!_0x11a1f3)return logger['info']({'uuid':_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1aa)],'messsage':_0x5eae51[_0x1ae2e2(0x22c)](_0x3af120,_0x5eae51[_0x1ae2e2(0x164)])}),_0x6b578a[_0x1ae2e2(0x22b)](0x194)[_0x1ae2e2(0x1a2)](error[_0x1ae2e2(0x23f)](_0x3af120));if(_0x3af120!==_0x4085a7&&!_0x11a3ea)return logger[_0x1ae2e2(0x237)]({'uuid':_0x2ac65c['ctx'][_0x1ae2e2(0x1aa)],'message':_0x3af120+_0x5eae51[_0x1ae2e2(0x1f1)]}),_0x6b578a['status'](0x193)[_0x1ae2e2(0x1a2)](error[_0x1ae2e2(0x1c3)]());const _0xdcb8fe=await _0x5119cf['findOneByUserNameAndOrgUUID'](_0x1b75c9,_0x11a1f3);if(!_0xdcb8fe)return logger[_0x1ae2e2(0x237)]({'uuid':_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1aa)],'messsage':_0x5eae51['fgGKp'](_0x1b75c9,_0x1ae2e2(0x1f9))}),_0x6b578a[_0x1ae2e2(0x22b)](0x194)[_0x1ae2e2(0x1a2)](error['userDne'](_0x1b75c9));const _0x56e88d=await _0x5119cf['isAdmin'](_0x4a1b07,_0x4085a7);if((_0x5eae51[_0x1ae2e2(0x19a)](_0x3af120,_0x4085a7)||_0x5eae51[_0x1ae2e2(0x19a)](_0x1b75c9,_0x4a1b07))&&!_0x11a3ea){if(!_0x56e88d||_0x56e88d&&_0x3af120!==_0x4085a7)return logger['info']({'uuid':_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1aa)],'message':_0x5eae51[_0x1ae2e2(0x21b)]}),_0x6b578a['status'](0x193)['json'](error[_0x1ae2e2(0x18c)]());}const _0x50fdc7=cryptoRandomString({'length':CONSTANTS[_0x1ae2e2(0x22f)]});_0xdcb8fe[_0x1ae2e2(0x1f4)]=await argon2[_0x1ae2e2(0x1bb)](_0x50fdc7);const _0x3ea706=await _0x5119cf[_0x1ae2e2(0x1a8)](_0xdcb8fe[_0x1ae2e2(0x214)],_0x11a1f3,_0xdcb8fe);if(_0x5eae51['NKyEr'](_0x3ea706['n'],0x0))return logger[_0x1ae2e2(0x237)]({'uuid':_0x2ac65c[_0x1ae2e2(0x234)]['uuid'],'message':_0x5eae51[_0x1ae2e2(0x22c)](_0x1ae2e2(0x247)+_0x1b75c9+_0x5eae51[_0x1ae2e2(0x1fa)]+_0x3af120,_0x1ae2e2(0x176))}),_0x6b578a[_0x1ae2e2(0x22b)](0x194)[_0x1ae2e2(0x1a2)](error['userDne'](_0x1b75c9));logger[_0x1ae2e2(0x237)]({'uuid':_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1aa)],'message':_0x1ae2e2(0x1b4)+_0x1b75c9});const _0x11e39e={'action':_0x1ae2e2(0x219),'change':_0x5eae51['ZuxkD'],'req_UUID':_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1aa)],'org_UUID':await _0x30ee95[_0x1ae2e2(0x1d8)](_0x2ac65c[_0x1ae2e2(0x234)][_0x1ae2e2(0x1fc)])};return _0x11e39e[_0x1ae2e2(0x1c8)]=await _0x5119cf['getUserUUID'](_0x2ac65c['ctx'][_0x1ae2e2(0x1be)],_0x11e39e[_0x1ae2e2(0x21d)]),logger[_0x1ae2e2(0x237)](JSON[_0x1ae2e2(0x15b)](_0x11e39e)),_0x6b578a[_0x1ae2e2(0x22b)](0xc8)[_0x1ae2e2(0x1a2)]({'API-secret':_0x50fdc7});}catch(_0x3f6bad){_0x5eae51[_0x1ae2e2(0x1d7)](_0x42404f,_0x3f6bad);}}function setAggregateOrgObj(_0x4830ff){return[{'$match':_0x4830ff},{'$project':{'_id':![],'UUID':!![],'short_name':!![],'name':!![],'authority.active_roles':!![],'policies.id_quota':!![],'time':!![]}}];}function setAggregateUserObj(_0x3f7592){return[{'$match':_0x3f7592},{'$project':{'_id':![],'username':!![],'name':!![],'UUID':!![],'org_UUID':!![],'active':!![],'authority.active_roles':!![],'time':!![]}}];}function parseUserName(_0x44beff){const _0x26d97c=_0x37f03e;return _0x44beff[_0x26d97c(0x1a6)]&&(!_0x44beff['name']['first']&&(_0x44beff[_0x26d97c(0x1a6)]['first']=''),!_0x44beff[_0x26d97c(0x1a6)]['last']&&(_0x44beff['name'][_0x26d97c(0x1af)]=''),!_0x44beff[_0x26d97c(0x1a6)]['middle']&&(_0x44beff[_0x26d97c(0x1a6)][_0x26d97c(0x1e2)]=''),!_0x44beff[_0x26d97c(0x1a6)]['suffix']&&(_0x44beff[_0x26d97c(0x1a6)]['suffix']='')),_0x44beff[_0x26d97c(0x1a6)];}module['exports']={'ORG_ALL':getOrgs,'ORG_SINGLE':getOrg,'ORG_CREATE_SINGLE':createOrg,'ORG_UPDATE_SINGLE':updateOrg,'USER_ALL':getUsers,'ORG_ID_QUOTA':getOrgIdQuota,'USER_SINGLE':getUser,'USER_CREATE_SINGLE':createUser,'USER_UPDATE_SINGLE':updateUser,'USER_RESET_SECRET':resetSecret};