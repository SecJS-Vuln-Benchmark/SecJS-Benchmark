const _0xe49822=_0x51e5;(function(_0x5dadb8,_0xd462d9){const _0xa03caf=_0x51e5,_0x36bb1d=_0x5dadb8();while(!![]){try{const _0x37018a=-parseInt(_0xa03caf(0x114))/0x1+-parseInt(_0xa03caf(0x11c))/0x2+-parseInt(_0xa03caf(0x110))/0x3*(-parseInt(_0xa03caf(0x104))/0x4)+-parseInt(_0xa03caf(0x119))/0x5*(-parseInt(_0xa03caf(0x11a))/0x6)+-parseInt(_0xa03caf(0x108))/0x7*(parseInt(_0xa03caf(0x10a))/0x8)+-parseInt(_0xa03caf(0x107))/0x9*(parseInt(_0xa03caf(0x102))/0xa)+parseInt(_0xa03caf(0x10f))/0xb;if(_0x37018a===_0xd462d9)break;else _0x36bb1d['push'](_0x36bb1d['shift']());}catch(_0x428c6b){_0x36bb1d['push'](_0x36bb1d['shift']());}}}(_0xd0bb,0x3903b));import{WAZUH_DATA_ABSOLUTE_PATH,WAZUH_DATA_CONFIG_DIRECTORY_PATH,WAZUH_DATA_CONFIG_APP_PATH}from'../../common/constants';import{createDataDirectoryIfNotExists,createDirectoryIfNotExists}from'./filesystem';import{getConfiguration}from'./get-configuration';function _0x51e5(_0x395308,_0x3a1f25){const _0xd0bb96=_0xd0bb();return _0x51e5=function(_0x51e5b5,_0x407f2e){_0x51e5b5=_0x51e5b5-0x100;let _0x23139a=_0xd0bb96[_0x51e5b5];return _0x23139a;},_0x51e5(_0x395308,_0x3a1f25);}import{execSync}from'child_process';import{unlinkSync,writeFileSync}from'fs';beforeAll(()=>{const _0x40b904={'xzbSn':function(_0xa105cf,_0x1584ae){return _0xa105cf(_0x1584ae);}};createDataDirectoryIfNotExists(),_0x40b904['xzbSn'](createDirectoryIfNotExists,WAZUH_DATA_CONFIG_DIRECTORY_PATH);}),afterAll(()=>{const _0x59408b=_0x51e5,_0x2f7182={'ZKaGY':function(_0x14876b,_0x270819){return _0x14876b(_0x270819);}};_0x2f7182[_0x59408b(0x109)](unlinkSync,WAZUH_DATA_ABSOLUTE_PATH);}),describe(_0xe49822(0x103),()=>{const _0x67220e=_0xe49822,_0x167af2={'ELVJl':function(_0x18df92,_0x5ea55d){return _0x18df92(_0x5ea55d);},'VVbaC':function(_0x434bc3,_0x34fba8){return _0x434bc3!==_0x34fba8;},'vrIXr':'GVUZP','qeACO':_0x67220e(0x10c)};_0x167af2[_0x67220e(0x118)](afterEach,()=>{const _0x57d3d8=_0x67220e;execSync(_0x57d3d8(0x113)+WAZUH_DATA_ABSOLUTE_PATH+_0x57d3d8(0x115));});const _0x4f868e=[_0x67220e(0x101),_0x67220e(0x10d),_0x67220e(0x111)];it['each']`
	pluginConfiguration    
	${_0x4f868e[0x0]}
	${_0x4f868e[0x1]}
  ${_0x4f868e[0x2]}
	`(_0x167af2[_0x67220e(0x112)],({pluginConfiguration:_0x4a600c})=>{const _0x207e81=_0x67220e,_0x533273={'nThsp':function(_0x42ac6d,_0x464186){return _0x167af2['ELVJl'](_0x42ac6d,_0x464186);},'ZtXhz':'*****'};if(_0x167af2[_0x207e81(0x11b)](_0x207e81(0x100),_0x167af2[_0x207e81(0x10b)])){writeFileSync(WAZUH_DATA_CONFIG_APP_PATH,_0x4a600c,{'encoding':_0x207e81(0x10e)});const _0x1427af=getConfiguration();_0x1427af['hosts']['forEach'](_0x53d32e=>{const _0x35a10d=_0x207e81,_0x37f835=Object[_0x35a10d(0x117)](_0x53d32e)[0x0];expect(Object[_0x35a10d(0x117)](_0x53d32e)['length'])[_0x35a10d(0x106)](0x1),_0x533273[_0x35a10d(0x105)](expect,_0x53d32e[_0x37f835][_0x35a10d(0x116)])[_0x35a10d(0x106)](_0x533273['ZtXhz']);});}else _0x37e56a(),_0x167af2[_0x207e81(0x118)](_0x4e2e2d,_0x2b2b0d);});});function _0xd0bb(){const _0x1001bc=['password','keys','ELVJl','170foipbu','55182ozoelB','VVbaC','200386oKTeAd','UAhHi','hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','2410cfBDnv','[service]\x20get-configuration','251756yGJDKS','nThsp','toEqual','13914ZJqovt','1728902LWOWRM','ZKaGY','8bhzYGv','vrIXr','Obfuscate\x20the\x20hosts\x20password','hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','utf8','6750436uOEjGF','18TvhOhV','pattern:\x20wazuh-alerts-*\x0ahosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom2:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom2.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom2\x0a\x20\x20\x20\x20-\x20password:\x20custompassword2\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','qeACO','rm\x20','350712orviGp','/config/wazuh.yml\x20||\x20echo\x20\x22\x22'];_0xd0bb=function(){return _0x1001bc;};return _0xd0bb();}