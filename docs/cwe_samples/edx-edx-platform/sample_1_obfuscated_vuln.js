const _0x3bdc0f=_0x59eb;(function(_0x5b041b,_0x34dd47){const _0x287086=_0x59eb,_0x395a1b=_0x5b041b();while(!![]){try{const _0xf1d5c0=parseInt(_0x287086(0x2fc))/0x1+-parseInt(_0x287086(0x433))/0x2+parseInt(_0x287086(0x414))/0x3*(-parseInt(_0x287086(0x3fa))/0x4)+parseInt(_0x287086(0x38f))/0x5*(parseInt(_0x287086(0x271))/0x6)+parseInt(_0x287086(0x1cf))/0x7+-parseInt(_0x287086(0x3a4))/0x8+parseInt(_0x287086(0x177))/0x9;if(_0xf1d5c0===_0x34dd47)break;else _0x395a1b['push'](_0x395a1b['shift']());}catch(_0xa32aea){_0x395a1b['push'](_0x395a1b['shift']());}}}(_0x41df,0x93526));import _0x1964b2 from'chai';import{Ed25519Signature2020}from'@digitalbazaar/ed25519-signature-2020';import{Ed25519VerificationKey2020}from'@digitalbazaar/ed25519-verification-key-2020';function _0x59eb(_0x88f8a5,_0x289f4d){const _0x41df85=_0x41df();return _0x59eb=function(_0x59eb58,_0x34536b){_0x59eb58=_0x59eb58-0x111;let _0x19eccd=_0x41df85[_0x59eb58];return _0x19eccd;},_0x59eb(_0x88f8a5,_0x289f4d);}const should=_0x1964b2[_0x3bdc0f(0x278)]();export default async function (options){const _0x59dca6=_0x3bdc0f,nYRzSt={'OnQtp':_0x59dca6(0x1c5),'eSdMq':function(callee,param1){return callee(param1);},'mEQiz':_0x59dca6(0x164),'neQGs':_0x59dca6(0x3e4),'SYpxE':function(callee,param1,param2){return callee(param1,param2);},'akckn':function(callee,param1,param2){return callee(param1,param2);},'vfsta':function(callee,param1,param2){return callee(param1,param2);},'WKtYq':_0x59dca6(0x1a1),'MBEoJ':function(x,y){return x+y;},'VGMPR':function(callee,param1,param2){return callee(param1,param2);},'GxCEF':_0x59dca6(0x21f),'tLixL':'urn:some:root:id','XKVAi':function(callee,param1){return callee(param1);},'WWclR':function(callee,param1){return callee(param1);},'aoKdd':function(callee){return callee();},'sMYcQ':function(callee,param1){return callee(param1);},'oZMGw':function(callee,param1){return callee(param1);},'tenmc':_0x59dca6(0x432),'eZDZa':_0x59dca6(0x1db),'wlanX':'qOsWW','HXKsi':function(callee,param1){return callee(param1);},'ViccB':_0x59dca6(0x43a),'BKCnQ':function(callee,param1){return callee(param1);},'dxFdc':_0x59dca6(0x437),'WQvqy':_0x59dca6(0x112),'dpJgg':function(callee){return callee();},'UedLe':function(callee,param1){return callee(param1);},'nAOZc':function(callee,param1){return callee(param1);},'BHlYH':'time\x20to\x20live\x20that\x20is\x20too\x20long','NCTeu':function(callee,param1){return callee(param1);},'lZQPk':function(callee,param1){return callee(param1);},'ksswH':function(callee,param1){return callee(param1);},'aVssw':function(x,y){return x*y;},'PTNIW':function(callee,param1){return callee(param1);},'VPXTJ':_0x59dca6(0x1a7),'lwOZd':_0x59dca6(0x2f0),'UQPLR':function(callee){return callee();},'dqZMP':'invalid\x20date','TtIXe':_0x59dca6(0x26a),'UJeaO':function(x,y){return x/y;},'GhVlD':_0x59dca6(0x129),'XljEl':function(x,y){return x!==y;},'sNhVO':function(callee){return callee();},'kADhx':function(callee,param1){return callee(param1);},'mhuDE':_0x59dca6(0x1ca),'WuPdz':_0x59dca6(0x326),'WubIQ':_0x59dca6(0x393),'yfCqH':_0x59dca6(0x227),'HrPQW':'should\x20fail\x20to\x20verify\x20chain\x20w/invalid\x20allowedAction\x20string\x20','QqwNW':_0x59dca6(0x1c9),'YukwF':_0x59dca6(0x1c6),'mQUtz':_0x59dca6(0x2b6),'Sgbcq':_0x59dca6(0x377),'ZcGMo':'w/revoked\x20capability','qTVvr':_0x59dca6(0x38d),'ZnDsm':_0x59dca6(0x39b),'tiaQC':'future','ELfLB':_0x59dca6(0x348),'LlIiP':_0x59dca6(0x161),'mRFFV':_0x59dca6(0x3f3),'mnKBn':function(callee,param1){return callee(param1);},'yyodH':function(callee,param1){return callee(param1);},'geCoC':_0x59dca6(0x132),'WWVkk':function(callee,param1){return callee(param1);},'QiNXv':_0x59dca6(0x136),'dlTfr':function(callee){return callee();},'OFmYS':function(callee,param1){return callee(param1);},'ogwKQ':function(x,y){return x===y;},'GrnMo':function(x,y){return x-y;},'Llofm':function(callee,param1){return callee(param1);},'VkTii':function(callee,param1){return callee(param1);},'irKGB':function(callee,param1){return callee(param1);},'SstMJ':function(callee,param1){return callee(param1);},'cOKuj':'date\x20in\x20its\x20delegation\x20proof.','RSzln':function(x,y){return x-y;},'vTYIM':_0x59dca6(0x413),'JtNcM':function(x,y){return x-y;},'eUONZ':_0x59dca6(0x2a1),'fvebl':_0x59dca6(0x3a0),'trMdr':function(callee,param1){return callee(param1);},'dAgRv':'pRxmh','Gdonk':_0x59dca6(0x354),'tCXoZ':_0x59dca6(0x288),'QUBtw':function(callee){return callee();},'RKJnD':_0x59dca6(0x2d3),'pflga':function(callee,param1){return callee(param1);},'itnvJ':_0x59dca6(0x3f4),'UWhCE':_0x59dca6(0x116),'tbWPj':'fXARR','fevYs':_0x59dca6(0x3dc),'nQEfV':function(callee,param1,param2){return callee(param1,param2);},'qyvnE':'should\x20fail\x20delegating\x20an\x20expired\x20capability','bBZdY':function(x,y){return x+y;},'esPCV':_0x59dca6(0x308),'jVuMv':'should\x20verify\x20invoking\x20a\x20capability\x20with\x20only\x20expires\x20on\x20','WLgGF':_0x59dca6(0x1ac),'kwGVB':function(callee,param1){return callee(param1);},'wCgzK':function(callee,param1){return callee(param1);},'Txxhy':function(x,y){return x+y;},'zHQwH':function(x,y){return x===y;},'DauFC':'phUus','UkmyK':function(callee,param1){return callee(param1);},'YIjmK':function(callee,param1){return callee(param1);},'jESXa':function(callee,param1){return callee(param1);},'aoVVv':'https://example.com/edvs/cc8b09fd-76e2-4fae-9bdd-2522b83a2971','qnOkX':_0x59dca6(0x159),'Tdkav':'should\x20verify\x20chain\x20w/path\x20and\x20query\x20attenuation','MMemI':_0x59dca6(0x234),'TBsmd':_0x59dca6(0x3df),'hdaOw':function(callee,param1,param2){return callee(param1,param2);},'QRvYS':function(callee,param1,param2){return callee(param1,param2);},'djmqg':_0x59dca6(0x381),'ZcNmC':function(callee,param1,param2){return callee(param1,param2);},'ctkqr':function(x,y){return x+y;},'aIGvD':_0x59dca6(0x113),'UBSFY':_0x59dca6(0x191),'dWGjZ':function(callee,param1,param2){return callee(param1,param2);},'tAqjM':_0x59dca6(0x396),'Gteqq':function(x,y){return x+y;},'VMyTM':'should\x20fail\x20to\x20verify\x20a\x20root\x20capability\x20w/\x20separate\x20target\x20when\x20','WoWbN':function(callee,param1,param2){return callee(param1,param2);},'ReFpM':function(callee,param1,param2){return callee(param1,param2);},'ziIsI':'should\x20verify\x20invoking\x20a\x20capability\x20chain\x20of\x20depth\x202\x20and\x20a\x20','psojk':_0x59dca6(0x1d3),'QXYnD':function(callee,param1,param2){return callee(param1,param2);},'nImXC':function(x,y){return x+y;},'jscOy':function(x,y){return x+y;},'JaCOT':_0x59dca6(0x379),'LOjzd':_0x59dca6(0x1e1),'umWLs':_0x59dca6(0x3fd),'TguLO':function(x,y){return x+y;},'vENLp':_0x59dca6(0x199),'smcVn':_0x59dca6(0x39d),'vievK':function(callee,param1,param2){return callee(param1,param2);},'SaOgy':function(callee,param1,param2){return callee(param1,param2);},'Httyr':'invocationTarget\x20attenuation','avPji':_0x59dca6(0x422),'qqoEL':function(callee,param1){return callee(param1);},'LSEJP':_0x59dca6(0x255),'BdBZJ':'should\x20succeed\x20w/controller\x20invoker','qvITX':function(x,y){return x!==y;},'xFlxE':_0x59dca6(0x397),'qgqGf':'should\x20fail\x20when\x20missing\x20\x22parentCapability\x22','ztYHU':function(callee){return callee();},'aFOLx':function(callee,param1){return callee(param1);},'diYfI':function(callee,param1){return callee(param1);},'NFcNW':_0x59dca6(0x342),'yVlFb':function(callee,param1){return callee(param1);},'WjyAb':_0x59dca6(0x138),'XlzGr':function(callee,param1){return callee(param1);},'PGAmn':_0x59dca6(0x42e),'iDzpY':_0x59dca6(0x3e9),'OTOxB':function(callee){return callee();},'oUBgJ':'array','GSYLj':'should\x20verify\x20chain','ovdvw':_0x59dca6(0x341),'jpnFt':function(callee,param1,param2){return callee(param1,param2);},'GmYJE':'Sign\x20with\x20capabilityInvocation\x20proof\x20purpose','zmdUl':_0x59dca6(0x2d1),'lCVZw':function(callee,param1,param2){return callee(param1,param2);},'hqmVP':_0x59dca6(0x117),'tlENh':function(callee,param1,param2){return callee(param1,param2);},'oxsSW':'Capability\x20controller\x20uses\x20verification\x20method','pznHv':_0x59dca6(0x2c5),'rtLML':_0x59dca6(0x412),'daHJk':_0x59dca6(0x2b7),'ZlNLe':'purposeResult','RjJOj':_0x59dca6(0x366),'CXMhe':_0x59dca6(0x34f),'ManKx':_0x59dca6(0x150),'rhpCX':'RIQgU','rVvGN':_0x59dca6(0x14a)},{expect,helpers,jsigs,mock,zcap}=options,{CapabilityInvocation,CapabilityDelegation,createRootCapability,constants:{ZCAP_CONTEXT_URL}}=zcap,{controllers,privateDidDocs,capabilities,addToLoader,testLoader}=mock,{Controller,uuid}=helpers;function clone(obj){const _0xed246a=_0x59dca6;return JSON[_0xed246a(0x241)](JSON[_0xed246a(0x1de)](obj));}const alice=new Controller(controllers[_0x59dca6(0x238)]),bob=new Controller(controllers[_0x59dca6(0x111)]),carol=new Controller(controllers[_0x59dca6(0x20c)]),diana=new Controller(controllers['diana']),alpha=new Controller(privateDidDocs[_0x59dca6(0x302)]),CONSTANT_DATE=_0x59dca6(0x1f3),EXPIRES_3000_DATE=_0x59dca6(0x352);describe(_0x59dca6(0x35a),()=>{const _0x134138=_0x59dca6,bthJAb={'hUIuk':function(callee,param1){return callee(param1);},'yvMwL':function(callee,param1){const _0x26cbaa=_0x59eb;return nYRzSt[_0x26cbaa(0x1f9)](callee,param1);},'xEztm':nYRzSt['OnQtp'],'Oxsbz':function(callee,param1){return callee(param1);},'NztmK':function(callee,param1){return callee(param1);},'FNgRy':nYRzSt[_0x134138(0x20a)],'kvfVK':_0x134138(0x3b7),'DMjgI':_0x134138(0x292),'HDbKa':function(callee,param1){const _0xe719ff=_0x134138;return nYRzSt[_0xe719ff(0x29a)](callee,param1);},'MNfRo':function(callee,param1,param2){return callee(param1,param2);},'KBBQz':nYRzSt[_0x134138(0x359)],'USPvB':nYRzSt[_0x134138(0x3a7)],'AdzuV':function(callee,param1,param2){return callee(param1,param2);},'LvPxU':_0x134138(0x370),'ZvvrI':nYRzSt[_0x134138(0x2fb)],'rAvhC':function(x,y){const _0xc60a71=_0x134138;return nYRzSt[_0xc60a71(0x311)](x,y);},'NCVNu':_0x134138(0x383),'YONgB':function(callee,param1){return callee(param1);},'pjTgU':_0x134138(0x43e),'YMZWQ':function(x,y){return x+y;},'FBTEE':nYRzSt['xFlxE'],'uuPUr':_0x134138(0x30b),'qeQlK':function(callee,param1,param2){return callee(param1,param2);},'teVob':nYRzSt[_0x134138(0x213)],'ydzUI':_0x134138(0x230),'ubGRp':function(callee){const _0x4db491=_0x134138;return nYRzSt[_0x4db491(0x39f)](callee);},'Vjyje':function(callee,param1){return callee(param1);},'GZwzz':function(callee,param1){return nYRzSt['aFOLx'](callee,param1);},'nSHuk':function(callee,param1){return callee(param1);},'cvYLu':function(callee){return callee();},'PpThH':function(callee,param1){const _0x51524a=_0x134138;return nYRzSt[_0x51524a(0x16b)](callee,param1);},'HkxbB':function(callee,param1){return callee(param1);},'nfPYN':function(callee,param1){return callee(param1);},'JCrmI':function(callee,param1){return nYRzSt['WWVkk'](callee,param1);},'LdNUj':nYRzSt[_0x134138(0x3b2)],'luLpa':nYRzSt['neQGs'],'BwltG':function(callee,param1){const _0x13e076=_0x134138;return nYRzSt[_0x13e076(0x3b1)](callee,param1);},'dyUKg':function(callee,param1){return nYRzSt['yVlFb'](callee,param1);},'JQWeo':function(callee,param1){return callee(param1);},'izEZE':function(callee,param1){return callee(param1);},'xOvSV':function(x,y){return x!==y;},'XGxCy':nYRzSt[_0x134138(0x2f2)],'pvoLF':function(callee,param1){return nYRzSt['XlzGr'](callee,param1);},'fWYOg':nYRzSt['PGAmn'],'NUijL':function(callee,param1){return callee(param1);},'xjGFh':nYRzSt[_0x134138(0x2a7)],'lBtsj':function(callee){const _0x1301aa=_0x134138;return nYRzSt[_0x1301aa(0x3ec)](callee);},'kSvQk':function(callee,param1){const _0x1b5896=_0x134138;return nYRzSt[_0x1b5896(0x16b)](callee,param1);},'IbagU':function(callee,param1){const _0x318bbf=_0x134138;return nYRzSt[_0x318bbf(0x17d)](callee,param1);},'ltFbS':function(callee){return callee();},'Qlvpt':'invalid','SiqBv':nYRzSt[_0x134138(0x2fd)],'nZYaX':function(callee,param1){return callee(param1);},'SUepg':nYRzSt['GSYLj'],'sKgHl':nYRzSt[_0x134138(0x40e)],'UaPiW':function(callee,param1,param2){return callee(param1,param2);},'JslCk':function(callee,param1,param2){return callee(param1,param2);},'CIzXj':'should\x20fail\x20to\x20verify\x20chain\x20exceeding\x20maxChainLength'};nYRzSt['zHQwH'](_0x134138(0x262),_0x134138(0x171))?_0x296a41=_0x2820e2:(nYRzSt['jpnFt'](describe,nYRzSt['GmYJE'],()=>{const _0x32a53f=_0x134138,mcgBjn={'vOxhE':bthJAb['DMjgI'],'dqhqG':function(callee,param1){const _0xafba85=_0x59eb;return bthJAb[_0xafba85(0x37e)](callee,param1);},'CcAXb':function(callee,param1){const _0x517cc1=_0x59eb;return bthJAb[_0x517cc1(0x3a9)](callee,param1);},'CUwMZ':function(callee,param1){return callee(param1);},'akQXo':bthJAb[_0x32a53f(0x400)],'Kdqba':function(callee,param1){return callee(param1);},'nArKw':function(callee,param1){return callee(param1);},'CpIJQ':_0x32a53f(0x32e)};bthJAb['MNfRo'](it,bthJAb['KBBQz'],async()=>{const _0x4894be=_0x32a53f;if(mcgBjn['vOxhE']!==_0x4894be(0x3a2)){const doc=clone(mock[_0x4894be(0x2f8)]),signed=await mcgBjn['dqhqG'](_invoke,{'doc':doc,'invoker':alice,'date':CONSTANT_DATE,'capability':capabilities[_0x4894be(0x36d)][_0x4894be(0x302)],'capabilityAction':_0x4894be(0x1c5)});mcgBjn[_0x4894be(0x325)](expect,signed)['to'][_0x4894be(0x388)][_0x4894be(0x357)](mock[_0x4894be(0x3d4)]['alpha']);}else _0x5c90d3=_0x1188c4;}),it(bthJAb[_0x32a53f(0x162)],async()=>{const _0x312946=_0x32a53f,doc=bthJAb['hUIuk'](clone,mock[_0x312946(0x2f8)]),signed=await bthJAb[_0x312946(0x1fd)](_invoke,{'doc':doc,'invoker':alice,'date':CONSTANT_DATE,'capability':capabilities[_0x312946(0x36d)][_0x312946(0x2cb)],'capabilityAction':bthJAb['xEztm']});expect(signed)['to']['deep'][_0x312946(0x357)](mock[_0x312946(0x3d4)][_0x312946(0x2cb)]);}),bthJAb[_0x32a53f(0x1bf)](it,'should\x20fail\x20when\x20missing\x20\x22capability\x22',async()=>{const _0x236a68=_0x32a53f;let err;try{if(_0x236a68(0x12d)!=='StUfq'){const doc=bthJAb[_0x236a68(0x293)](clone,mock[_0x236a68(0x2f8)]);await bthJAb[_0x236a68(0x3a9)](_invoke,{'doc':doc,'invoker':alice,'purposeOptions':{}});}else _0x7e5a18=_0x1f7353;}catch(e){_0x236a68(0x422)===bthJAb[_0x236a68(0x294)]?err=e:_0x17ce8e=_0x3f470f;}bthJAb['Oxsbz'](expect,err)['to']['exist'],expect(err['message'])['to']['equal']('\x22capability\x22\x20must\x20be\x20a\x20string\x20or\x20object.');}),it(_0x32a53f(0x3d8),async()=>{const _0x3c15ab=_0x32a53f;let err;try{const doc=mcgBjn[_0x3c15ab(0x31a)](clone,mock[_0x3c15ab(0x2f8)]);await _invoke({'doc':doc,'invoker':alice,'purposeOptions':{'capability':mcgBjn[_0x3c15ab(0x22e)]}});}catch(e){err=e;}mcgBjn[_0x3c15ab(0x32a)](expect,err)['to'][_0x3c15ab(0x34d)],mcgBjn[_0x3c15ab(0x3aa)](expect,err[_0x3c15ab(0x418)])['to'][_0x3c15ab(0x357)](mcgBjn[_0x3c15ab(0x3eb)]);}),bthJAb[_0x32a53f(0x1cd)](it,bthJAb[_0x32a53f(0x3e3)],async()=>{const _0x3206ff=_0x32a53f;let err;try{const doc=bthJAb[_0x3206ff(0x293)](clone,mock[_0x3206ff(0x2f8)]);await _invoke({'doc':doc,'invoker':alice,'purposeOptions':{'capability':bthJAb[_0x3206ff(0x400)],'capabilityAction':_0x3206ff(0x1c5)}});}catch(e){err=e;}expect(err)['to']['exist'],bthJAb[_0x3206ff(0x204)](expect,err['message'])['to']['equal'](_0x3206ff(0x33d));});}),nYRzSt[_0x134138(0x41d)](describe,nYRzSt[_0x134138(0x182)],()=>{const _0x2c6e07=_0x134138,usRjws={'YZapi':_0x2c6e07(0x412),'RUrKp':bthJAb[_0x2c6e07(0x380)]};bthJAb[_0x2c6e07(0x1cd)](it,'should\x20succeed\x20w/verification\x20method\x20as\x20controller',async()=>{const _0x5d81e5=_0x2c6e07,newCapability={'@context':ZCAP_CONTEXT_URL,'id':_0x5d81e5(0x167),'controller':bob[_0x5d81e5(0x253)](bthJAb[_0x5d81e5(0x430)],0x0)['id'],'parentCapability':capabilities[_0x5d81e5(0x36d)][_0x5d81e5(0x302)]['id'],'invocationTarget':capabilities['root']['alpha'][_0x5d81e5(0x412)],'expires':EXPIRES_3000_DATE},delegatedCapability=await _delegate({'newCapability':newCapability,'parentCapability':capabilities[_0x5d81e5(0x36d)][_0x5d81e5(0x302)],'delegator':alice,'date':CONSTANT_DATE});expect(delegatedCapability)['to'][_0x5d81e5(0x388)][_0x5d81e5(0x357)](capabilities[_0x5d81e5(0x24f)]['alpha']);}),bthJAb[_0x2c6e07(0x3d5)](it,_0x2c6e07(0x27b),async()=>{const _0x5a9111=_0x2c6e07;if(bthJAb[_0x5a9111(0x220)](bthJAb[_0x5a9111(0x32c)],_0x5a9111(0x373))){const newCapability={'@context':ZCAP_CONTEXT_URL,'id':'urn:uuid:710910c8-61e4-11ec-8739-10bf48838a41','controller':bob['id'](),'parentCapability':capabilities[_0x5a9111(0x36d)][_0x5a9111(0x2cb)]['id'],'invocationTarget':capabilities[_0x5a9111(0x36d)][_0x5a9111(0x2cb)][_0x5a9111(0x412)],'expires':EXPIRES_3000_DATE},delegatedCapability=await _delegate({'newCapability':newCapability,'parentCapability':capabilities['root'][_0x5a9111(0x2cb)],'delegator':alice,'date':CONSTANT_DATE});expect(delegatedCapability)['to'][_0x5a9111(0x388)][_0x5a9111(0x357)](capabilities[_0x5a9111(0x24f)][_0x5a9111(0x2cb)]);}else for(const _0x42076c of _0x165fe1){_0x42076c[_0x5a9111(0x278)]['be']['an']('object'),_0x42076c['should']['have'][_0x5a9111(0x3ca)]('id'),_0x42076c[_0x5a9111(0x278)][_0x5a9111(0x26d)][_0x5a9111(0x3ca)]('controller'),_0x42076c[_0x5a9111(0x278)][_0x5a9111(0x26d)]['property'](usRjws[_0x5a9111(0x365)]);}}),it(bthJAb[_0x2c6e07(0x274)],async()=>{const _0x270554=_0x2c6e07;let err;try{const doc=bthJAb['YONgB'](clone,mock[_0x270554(0x2f8)]);await bthJAb['yvMwL'](_delegate,{'newCapability':doc,'delegator':alice,'purposeOptions':{}});}catch(e){'cDPeY'!==bthJAb[_0x270554(0x425)]?err=e:_0xcce9d8=_0x4424f4;}expect(err)['to'][_0x270554(0x34d)],bthJAb['Oxsbz'](expect,err[_0x270554(0x418)])['to'][_0x270554(0x357)](bthJAb[_0x270554(0x174)]('\x22parentCapability\x22\x20must\x20be\x20a\x20string\x20expressing\x20the\x20ID\x20of\x20a\x20root\x20',bthJAb[_0x270554(0x3cb)]));}),bthJAb['AdzuV'](it,bthJAb['ydzUI'],async()=>{const _0x662530=_0x2c6e07,newCapability={'@context':ZCAP_CONTEXT_URL,'id':usRjws[_0x662530(0x3ee)],'controller':bob['id'](),'parentCapability':capabilities['root'][_0x662530(0x2cb)]['id'],'invocationTarget':capabilities[_0x662530(0x36d)][_0x662530(0x2cb)][_0x662530(0x412)],'expires':EXPIRES_3000_DATE},delegatedCapability=await _delegate({'newCapability':newCapability,'delegator':alice,'date':CONSTANT_DATE,'purposeOptions':{'parentCapability':capabilities[_0x662530(0x36d)]['beta']}});expect(delegatedCapability)['to']['deep'][_0x662530(0x357)](capabilities[_0x662530(0x24f)][_0x662530(0x2cb)]);});}),nYRzSt[_0x134138(0x15c)](context,nYRzSt['hqmVP'],()=>{const _0x533010=_0x134138,rtYVLZ={'jfFOq':nYRzSt[_0x533010(0x2e7)],'zXjek':function(callee,param1){return nYRzSt['eSdMq'](callee,param1);},'znbGd':nYRzSt['mEQiz'],'xVZwA':function(callee,param1){const _0x1527e8=_0x533010;return nYRzSt[_0x1527e8(0x34b)](callee,param1);},'syjFX':nYRzSt[_0x533010(0x34e)]};nYRzSt[_0x533010(0x41d)](it,_0x533010(0x3fb),async()=>{const _0x50ea64=_0x533010,result=await _verifyInvocation({'invocation':mock['exampleDocWithInvocation'][_0x50ea64(0x302)],'rootCapability':capabilities[_0x50ea64(0x36d)][_0x50ea64(0x302)],'expectedAction':rtYVLZ[_0x50ea64(0x189)]});expect(result)['to'][_0x50ea64(0x34d)],expect(result[_0x50ea64(0x1dd)])['to']['be'][_0x50ea64(0x3f6)];}),nYRzSt[_0x533010(0x2f4)](it,_0x533010(0x410),async()=>{const _0x30a3f6=_0x533010,result=await _verifyInvocation({'invocation':mock[_0x30a3f6(0x3d4)][_0x30a3f6(0x302)],'purposeOptions':{'expectedAction':bthJAb[_0x30a3f6(0x2be)],'expectedRootCapability':capabilities[_0x30a3f6(0x36d)][_0x30a3f6(0x302)]['id'],'expectedTarget':[capabilities[_0x30a3f6(0x36d)][_0x30a3f6(0x302)]['invocationTarget']]}});expect(result)['to'][_0x30a3f6(0x34d)],bthJAb[_0x30a3f6(0x37e)](expect,result[_0x30a3f6(0x1dd)])['to']['be'][_0x30a3f6(0x3f6)];}),nYRzSt[_0x533010(0x2c3)](it,nYRzSt[_0x533010(0x416)],async()=>{const _0x25288c=_0x533010,delegatedCapability=await bthJAb[_0x25288c(0x293)](_delegate,{'parentCapability':capabilities[_0x25288c(0x36d)][_0x25288c(0x302)],'controller':bob[_0x25288c(0x253)](_0x25288c(0x1a7),0x0)['id'],'delegator':alice}),result=await _verifyDelegation({'delegation':delegatedCapability,'expectedRootCapability':capabilities[_0x25288c(0x36d)]['alpha']['id']});expect(result)['to']['exist'],expect(result[_0x25288c(0x1dd)])['to']['be'][_0x25288c(0x3f6)];}),nYRzSt[_0x533010(0x2f4)](it,nYRzSt[_0x533010(0x20f)]('should\x20fail\x20to\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20','when\x20the\x20expectedRootCapability\x20does\x20not\x20match'),async()=>{const _0x1f50b0=_0x533010,delegatedCapability=await rtYVLZ[_0x1f50b0(0x1d2)](_delegate,{'parentCapability':capabilities['root'][_0x1f50b0(0x302)],'controller':bob['get'](_0x1f50b0(0x1a7),0x0)['id'],'delegator':alice}),result=await rtYVLZ['zXjek'](_verifyDelegation,{'delegation':delegatedCapability,'expectedRootCapability':rtYVLZ[_0x1f50b0(0x33c)]});expect(result)['to'][_0x1f50b0(0x34d)],rtYVLZ['xVZwA'](expect,result[_0x1f50b0(0x1dd)])['to']['be'][_0x1f50b0(0x224)],result[_0x1f50b0(0x13d)][_0x1f50b0(0x2ce)][_0x1f50b0(0x278)][_0x1f50b0(0x357)](_0x1f50b0(0x342));const [error]=result[_0x1f50b0(0x13d)]['errors'];error[_0x1f50b0(0x418)][_0x1f50b0(0x278)]['contain'](rtYVLZ[_0x1f50b0(0x1af)]);}),nYRzSt[_0x533010(0x3f9)](it,nYRzSt[_0x533010(0x41e)],async()=>{const _0x13b2f5=_0x533010,delegatedCapability=await _delegate({'parentCapability':capabilities[_0x13b2f5(0x36d)][_0x13b2f5(0x302)],'controller':bob[_0x13b2f5(0x253)](_0x13b2f5(0x1a7),0x0)['id'],'delegator':alice}),doc=rtYVLZ['zXjek'](clone,mock[_0x13b2f5(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':_0x13b2f5(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':capabilities['root'][_0x13b2f5(0x302)],'expectedAction':_0x13b2f5(0x1c5)});expect(result)['to'][_0x13b2f5(0x34d)],expect(result[_0x13b2f5(0x1dd)])['to']['be'][_0x13b2f5(0x3f6)];});}),nYRzSt[_0x134138(0x28c)](context,nYRzSt[_0x134138(0x2b2)],()=>{const _0x527338=_0x134138,SGyTfX={'wgBli':nYRzSt[_0x527338(0x31e)],'kNTXL':_0x527338(0x186),'maxFp':function(callee,param1){return callee(param1);},'FwaxX':function(callee){return callee();},'JlBjW':nYRzSt[_0x527338(0x2e7)],'zenEM':function(callee,param1){const _0x2e7eb5=_0x527338;return nYRzSt[_0x2e7eb5(0x435)](callee,param1);},'bsWHf':_0x527338(0x342),'PWvgL':function(callee,param1){return callee(param1);},'YtSsa':_0x527338(0x1bc),'mWumI':function(x,y){return x!==y;},'AVErk':function(callee,param1){const _0x2fb745=_0x527338;return nYRzSt[_0x2fb745(0x391)](callee,param1);},'GCWqi':function(callee,param1){const _0x138a26=_0x527338;return nYRzSt[_0x138a26(0x435)](callee,param1);},'Dcfnh':_0x527338(0x1a5),'qULJL':function(callee){const _0x2fc2d5=_0x527338;return nYRzSt[_0x2fc2d5(0x41b)](callee);},'hKroC':function(callee){return callee();},'ZwJtC':function(callee,param1){return callee(param1);},'IMIdB':function(callee,param1){const _0x57047d=_0x527338;return nYRzSt[_0x57047d(0x3f7)](callee,param1);},'eDPkt':function(callee,param1){return callee(param1);},'KtsSm':function(callee,param1){const _0x26e88d=_0x527338;return nYRzSt[_0x26e88d(0x149)](callee,param1);},'iJQBA':nYRzSt[_0x527338(0x217)],'rCVBO':function(callee,param1){return callee(param1);},'FPYUE':function(callee,param1){return callee(param1);},'IxzTe':function(callee,param1){return callee(param1);},'IGtFW':_0x527338(0x360),'aeGUn':_0x527338(0x42e),'sgiuZ':function(callee,param1){return callee(param1);},'kFpYM':function(callee,param1){return callee(param1);},'tiQnQ':function(callee,param1){const _0x1415b8=_0x527338;return nYRzSt[_0x1415b8(0x34b)](callee,param1);},'ybITq':nYRzSt[_0x527338(0x36a)],'PWdoF':function(callee,param1){return callee(param1);},'Lotur':_0x527338(0x2a6),'tzEvq':function(callee,param1){return nYRzSt['eSdMq'](callee,param1);},'GFxEk':nYRzSt[_0x527338(0x3c9)],'IsUnb':function(callee,param1){const _0x39f265=_0x527338;return nYRzSt[_0x39f265(0x26e)](callee,param1);},'aPZbP':function(callee,param1){return callee(param1);},'GUrFR':_0x527338(0x328),'cfZab':function(callee,param1){return nYRzSt['sMYcQ'](callee,param1);},'vEckh':_0x527338(0x3f5),'NxRyz':function(callee,param1){return callee(param1);},'LuGfw':function(callee,param1){return callee(param1);},'DtgHP':function(callee,param1){return nYRzSt['HXKsi'](callee,param1);},'RzaxJ':_0x527338(0x2a5),'qyAUk':function(callee,param1){return callee(param1);},'bPapo':_0x527338(0x39c),'jyWqk':_0x527338(0x2a3),'JJzBR':function(callee,param1){return callee(param1);},'WdUOg':_0x527338(0x1ba),'MaoDr':nYRzSt['ViccB'],'qDFlA':function(callee,param1){const _0x246d5d=_0x527338;return nYRzSt[_0x246d5d(0x135)](callee,param1);},'iLBKu':function(x,y){return x+y;},'eAxQD':nYRzSt[_0x527338(0x336)],'UqApa':nYRzSt['WQvqy'],'SZWqa':function(callee,param1){const _0x209250=_0x527338;return nYRzSt[_0x209250(0x34b)](callee,param1);},'mrptQ':function(callee){const _0x22b31e=_0x527338;return nYRzSt[_0x22b31e(0x41b)](callee);},'PbmRh':function(callee,param1){return callee(param1);},'xZhqN':function(callee,param1){return callee(param1);},'FGXNU':function(callee){const _0x12acb4=_0x527338;return nYRzSt[_0x12acb4(0x2e9)](callee);},'WQAnG':function(callee,param1){const _0x342480=_0x527338;return nYRzSt[_0x342480(0x280)](callee,param1);},'kKxKO':function(x,y){return x*y;},'uRitz':function(callee,param1){return nYRzSt['nAOZc'](callee,param1);},'NgCcS':function(callee,param1){return callee(param1);},'uqVzG':function(callee,param1){return callee(param1);},'SaVQE':nYRzSt[_0x527338(0x351)],'IcDAR':function(callee,param1){const _0x1a77ec=_0x527338;return nYRzSt[_0x1a77ec(0x2b8)](callee,param1);},'OluBb':function(callee,param1){const _0xb91c29=_0x527338;return nYRzSt[_0xb91c29(0x257)](callee,param1);},'soSPL':function(callee,param1){return callee(param1);},'BvVwv':function(callee,param1){const _0xbcdd74=_0x527338;return nYRzSt[_0xbcdd74(0x439)](callee,param1);},'fZeUn':function(x,y){const _0x2c5486=_0x527338;return nYRzSt[_0x2c5486(0x289)](x,y);},'VEWKF':function(callee,param1){return nYRzSt['PTNIW'](callee,param1);},'yVhCK':function(callee,param1){return callee(param1);},'hwAHS':function(callee,param1){return callee(param1);},'FKqzN':nYRzSt[_0x527338(0x2fb)],'RPbmm':nYRzSt[_0x527338(0x36c)],'HArXX':_0x527338(0x412),'ATvjA':'EEncb','aWMxJ':_0x527338(0x297),'bHevd':function(callee){return nYRzSt['UQPLR'](callee);},'UiXvM':nYRzSt[_0x527338(0x2b4)],'wrcIT':_0x527338(0x403),'eqmLL':function(callee,param1){return callee(param1);},'Xhrwx':_0x527338(0x20b),'RjuUk':nYRzSt[_0x527338(0x345)],'atWTe':function(callee,param1){return callee(param1);},'kGTaH':function(callee,param1){return callee(param1);},'vERCl':function(x,y){const _0x1e16ed=_0x527338;return nYRzSt[_0x1e16ed(0x43b)](x,y);},'BAYxB':nYRzSt[_0x527338(0x29e)],'uUicC':function(x,y){return nYRzSt['XljEl'](x,y);},'TEMQs':function(callee){const _0x226669=_0x527338;return nYRzSt[_0x226669(0x339)](callee);},'fTgHV':function(callee,param1){return callee(param1);},'ENmxw':function(callee,param1){const _0x92a594=_0x527338;return nYRzSt[_0x92a594(0x188)](callee,param1);},'TJDcx':function(x,y){return x===y;},'xkCWd':_0x527338(0x2cc),'mJYvS':function(callee,param1,param2){return callee(param1,param2);},'SxAPw':nYRzSt[_0x527338(0x3d9)],'lRTeb':nYRzSt[_0x527338(0x319)],'Pqmrv':function(x,y){return x+y;},'vQXgu':nYRzSt['WubIQ'],'VkIld':nYRzSt[_0x527338(0x2f3)],'thFWE':nYRzSt[_0x527338(0x14b)],'ZqwTw':'vs\x20array','QKcBn':function(callee,param1,param2){const _0x159628=_0x527338;return nYRzSt[_0x159628(0x3f9)](callee,param1,param2);},'UbeuR':nYRzSt[_0x527338(0x283)],'QksDZ':nYRzSt[_0x527338(0x2d7)],'KhQOm':function(x,y){const _0x24e124=_0x527338;return nYRzSt[_0x24e124(0x20f)](x,y);},'ykPRF':nYRzSt[_0x527338(0x127)],'RvbTo':nYRzSt[_0x527338(0x374)],'poVJt':nYRzSt[_0x527338(0x36f)],'PUKLs':function(callee,param1,param2){const _0x31c892=_0x527338;return nYRzSt[_0x31c892(0x2c3)](callee,param1,param2);},'rQymB':nYRzSt[_0x527338(0x258)],'PRSPn':function(x,y){const _0x10d2ff=_0x527338;return nYRzSt[_0x10d2ff(0x20f)](x,y);},'prjhr':_0x527338(0x1c1),'mVuLt':nYRzSt[_0x527338(0x404)],'pIGpJ':nYRzSt['tiaQC'],'QdEVF':function(x,y){return x+y;},'ZRdfJ':_0x527338(0x143),'bexET':nYRzSt['ELfLB'],'DWqtq':_0x527338(0x2fe),'npeUJ':nYRzSt['LlIiP'],'RWgOK':function(callee,param1,param2){return nYRzSt['SYpxE'](callee,param1,param2);},'XOAJV':nYRzSt[_0x527338(0x320)],'IDHiv':_0x527338(0x1a8),'WIyFo':function(callee){return nYRzSt['sNhVO'](callee);},'CwlPU':_0x527338(0x24e),'wQOUT':function(callee,param1){return callee(param1);},'BZKgK':function(callee,param1){const _0x404257=_0x527338;return nYRzSt[_0x404257(0x1f9)](callee,param1);},'Lkase':function(callee,param1){const _0x200f9c=_0x527338;return nYRzSt[_0x200f9c(0x435)](callee,param1);},'DuAwX':'urn:zcap:e843f3c4-6b2b-11ec-b87f-10bf48838a41','VGCfx':function(callee,param1){return nYRzSt['nAOZc'](callee,param1);},'UzQSw':function(callee,param1){return callee(param1);},'JQgPu':function(callee){return callee();},'UPPbY':_0x527338(0x40d),'IJXqq':function(callee,param1){const _0x42bf61=_0x527338;return nYRzSt[_0x42bf61(0x202)](callee,param1);},'fdSvm':nYRzSt[_0x527338(0x3c0)],'BSTJT':function(callee,param1){const _0x5d34c1=_0x527338;return nYRzSt[_0x5d34c1(0x27a)](callee,param1);},'TwoqI':function(callee,param1){return nYRzSt['sMYcQ'](callee,param1);},'ltbXb':nYRzSt['QiNXv'],'LxrKj':function(x,y){return x-y;},'cfjSV':function(callee,param1){return callee(param1);},'QQGPk':function(callee){const _0x5010d5=_0x527338;return nYRzSt[_0x5010d5(0x339)](callee);},'IOWml':function(callee,param1){return callee(param1);},'ySLLl':function(callee){const _0x218518=_0x527338;return nYRzSt[_0x218518(0x2d2)](callee);},'boiHP':function(callee,param1){const _0x3dd28c=_0x527338;return nYRzSt[_0x3dd28c(0x3b1)](callee,param1);},'BMBvF':function(x,y){return nYRzSt['ogwKQ'](x,y);},'kyOEI':_0x527338(0x24c),'YmxaP':function(x,y){return nYRzSt['GrnMo'](x,y);},'SJMCw':function(callee,param1){return callee(param1);},'Ppsjj':function(callee,param1){return callee(param1);},'rWfYy':function(callee,param1){return callee(param1);},'oYdSZ':function(callee,param1){const _0x582dc0=_0x527338;return nYRzSt[_0x582dc0(0x284)](callee,param1);},'kvmVy':function(callee,param1){return callee(param1);},'IuPST':function(callee,param1){return nYRzSt['mnKBn'](callee,param1);},'XtHgE':'FYTPc','vtQwP':function(callee,param1){const _0x3ca174=_0x527338;return nYRzSt[_0x3ca174(0x3b9)](callee,param1);},'NxGjV':function(callee,param1){return nYRzSt['VkTii'](callee,param1);},'Onblz':function(callee,param1){return nYRzSt['irKGB'](callee,param1);},'pOKRu':function(callee,param1){const _0x3f6cc0=_0x527338;return nYRzSt[_0x3f6cc0(0x389)](callee,param1);},'CDbXA':function(callee,param1){return callee(param1);},'VCwVH':nYRzSt[_0x527338(0x3c7)],'OahAU':'urn:zcap:3c034da3-8b5e-4fdc-b75d-8c37d73cd21e','lECUa':function(x,y){return nYRzSt['RSzln'](x,y);},'aSMzQ':function(callee,param1){return callee(param1);},'rdbzG':function(callee,param1){return callee(param1);},'LPXxr':nYRzSt['vTYIM'],'GFkvh':function(x,y){return nYRzSt['JtNcM'](x,y);},'GrcIv':function(callee,param1){return callee(param1);},'oUjyt':function(callee,param1){return callee(param1);},'YbKVt':nYRzSt['eUONZ'],'Ctdhm':'2|6|3|5|4|7|0|1','HYTSU':nYRzSt['fvebl'],'XoTAm':'mBvpL','HAbAh':function(callee,param1){const _0x36f94d=_0x527338;return nYRzSt[_0x36f94d(0x2a2)](callee,param1);},'RCmvX':nYRzSt['dAgRv'],'TEoLf':function(callee,param1){const _0x481823=_0x527338;return nYRzSt[_0x481823(0x202)](callee,param1);},'ASkmU':nYRzSt['Gdonk'],'BrfIz':_0x527338(0x231),'KQuoP':nYRzSt[_0x527338(0x275)],'zwRcf':function(callee){const _0x175a0e=_0x527338;return nYRzSt[_0x175a0e(0x223)](callee);},'PeqWk':nYRzSt['RKJnD'],'GwlhW':function(callee,param1){const _0xb22d9e=_0x527338;return nYRzSt[_0xb22d9e(0x243)](callee,param1);},'hSMtO':nYRzSt['itnvJ'],'DSXep':nYRzSt[_0x527338(0x3cf)],'NpndC':nYRzSt['tbWPj'],'qLnIq':_0x527338(0x12a),'gyPLk':_0x527338(0x1d4),'vOPkJ':nYRzSt[_0x527338(0x1e6)],'byVZk':function(callee,param1,param2){return callee(param1,param2);},'qCPvG':_0x527338(0x3b4),'ypOCi':_0x527338(0x247),'xFDHW':function(callee,param1,param2){return callee(param1,param2);},'yzOdN':function(x,y){return x+y;},'IebBW':function(callee,param1,param2){const _0x35ecf8=_0x527338;return nYRzSt[_0x35ecf8(0x32d)](callee,param1,param2);},'mHpjT':_0x527338(0x1ef),'rOtNl':_0x527338(0x27f),'ajWcV':nYRzSt['qyvnE'],'MhYsu':function(x,y){return x+y;},'eyXRO':_0x527338(0x20d),'qtmCS':function(x,y){const _0x1a3d3a=_0x527338;return nYRzSt[_0x1a3d3a(0x201)](x,y);},'AMIdy':_0x527338(0x399),'HYJEK':nYRzSt[_0x527338(0x17e)],'Fpfpx':function(x,y){const _0x5104fd=_0x527338;return nYRzSt[_0x5104fd(0x201)](x,y);},'tUifR':function(x,y){return x+y;},'sPYNz':function(x,y){const _0xda3cf7=_0x527338;return nYRzSt[_0xda3cf7(0x201)](x,y);},'cKjrH':nYRzSt[_0x527338(0x153)],'AGLOt':nYRzSt[_0x527338(0x384)],'MBHzu':_0x527338(0x120),'pWiXc':function(callee,param1){return callee(param1);},'tmHaq':function(callee,param1){return callee(param1);},'KIpor':function(callee,param1){const _0x45d276=_0x527338;return nYRzSt[_0x45d276(0x18e)](callee,param1);},'ESYua':_0x527338(0x232),'ccMHf':_0x527338(0x2ed),'QjNqU':_0x527338(0x14f),'kPfEC':_0x527338(0x409),'Mafze':function(callee,param1){return nYRzSt['kwGVB'](callee,param1);},'hcXkv':function(callee,param1){return callee(param1);},'TZpZw':function(callee,param1){const _0x304fdc=_0x527338;return nYRzSt[_0x304fdc(0x282)](callee,param1);},'XzUGs':function(callee,param1){return callee(param1);},'cGbkA':function(callee,param1){const _0x188bf1=_0x527338;return nYRzSt[_0x188bf1(0x38c)](callee,param1);},'kEcQy':function(callee){return callee();},'Jepmv':function(callee,param1){const _0x2e085b=_0x527338;return nYRzSt[_0x2e085b(0x439)](callee,param1);},'nfOrq':function(x,y){const _0x5bf918=_0x527338;return nYRzSt[_0x5bf918(0x3f0)](x,y);},'mupeY':function(callee,param1){return callee(param1);},'Utims':function(callee,param1){return nYRzSt['VkTii'](callee,param1);},'oVkAV':function(callee,param1){return callee(param1);},'xdRxR':function(callee){return callee();},'nrTcS':function(callee,param1){return nYRzSt['NCTeu'](callee,param1);},'YWUoh':function(x,y){const _0x1aef75=_0x527338;return nYRzSt[_0x1aef75(0x2db)](x,y);},'WkPMs':_0x527338(0x181),'kpjvX':nYRzSt[_0x527338(0x321)],'AiybL':'https://example.com/edvs/2c2fe4ab-ff54-4a82-b103-f806f50d364e','QUZzv':function(callee,param1){return callee(param1);},'jQNCc':function(callee,param1){const _0x3555b2=_0x527338;return nYRzSt[_0x3555b2(0x33e)](callee,param1);},'VMBBP':function(callee){return callee();},'ICemF':_0x527338(0x313),'pDVpe':function(callee,param1){const _0x4284f1=_0x527338;return nYRzSt[_0x4284f1(0x17c)](callee,param1);},'zyWNB':function(callee,param1){const _0x3cd831=_0x527338;return nYRzSt[_0x3cd831(0x3f8)](callee,param1);},'GLFQI':nYRzSt['aoVVv'],'qmpdG':function(callee,param1){return callee(param1);},'UVKVa':function(callee,param1){return callee(param1);},'YmxjX':nYRzSt['qnOkX'],'WVCBW':'should\x20verify\x20chain\x20w/query\x20attenuation','zxOid':nYRzSt[_0x527338(0x151)],'dgNhM':function(callee,param1,param2){return callee(param1,param2);},'yOgOS':_0x527338(0x134),'EySnI':nYRzSt[_0x527338(0x2a8)],'iUHpc':_0x527338(0x350),'NHifE':'should\x20fail\x20to\x20verify\x20when\x20invoking\x20at\x20an\x20unexpected\x20','raisE':nYRzSt[_0x527338(0x26f)],'ZwTWH':_0x527338(0x21d),'CPuHZ':function(callee,param1,param2){return callee(param1,param2);},'MmDmH':function(callee,param1,param2){const _0x593a9f=_0x527338;return nYRzSt[_0x593a9f(0x36b)](callee,param1,param2);},'QQlmX':'should\x20fail\x20to\x20verify\x20when\x20allowTargetAttenuation\x20is\x20not\x20','UOpyi':'explicitly\x20allowed','kcpeh':function(callee,param1,param2){const _0x5c7854=_0x527338;return nYRzSt[_0x5c7854(0x28e)](callee,param1,param2);},'TyukZ':_0x527338(0x341),'epdaf':function(x,y){return nYRzSt['Txxhy'](x,y);},'QLUep':'should\x20fail\x20to\x20verify\x20an\x20increasingly\x20permissive\x20chain\x20','xshTk':nYRzSt[_0x527338(0x3d6)]};it(_0x527338(0x3fb),async()=>{const _0x2bce72=_0x527338,result=await _verifyInvocation({'invocation':mock['exampleDocWithInvocation'][_0x2bce72(0x2cb)],'rootCapability':capabilities[_0x2bce72(0x36d)][_0x2bce72(0x2cb)],'expectedAction':_0x2bce72(0x1c5)});expect(result)['to'][_0x2bce72(0x34d)],bthJAb[_0x2bce72(0x37e)](expect,result['verified'])['to']['be'][_0x2bce72(0x3f6)];}),nYRzSt[_0x527338(0x28e)](it,_0x527338(0x190),async()=>{const _0x47b2d0=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':SGyTfX['wgBli'],'invocationTarget':SGyTfX[_0x47b2d0(0x265)]};addToLoader({'doc':root});const result=await _verifyDelegation({'delegation':root,'expectedRootCapability':root['id']});SGyTfX[_0x47b2d0(0x1ab)](expect,result)['to'][_0x47b2d0(0x34d)],expect(result[_0x47b2d0(0x1dd)])['to']['be']['false'];}),nYRzSt[_0x527338(0x41d)](it,'should\x20fail\x20to\x20invoke\x20a\x20root\x20zcap\x20with\x20no\x20controller',async()=>{const _0x536e10=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':uuid(),'invocationTarget':SGyTfX['FwaxX'](uuid)};addToLoader({'doc':root});const doc={'@context':ZCAP_CONTEXT_URL,'example:foo':uuid()},invocation=await _invoke({'doc':doc,'invoker':alpha,'capability':root,'capabilityAction':SGyTfX[_0x536e10(0x43c)]}),result=await SGyTfX[_0x536e10(0x1ab)](_verifyInvocation,{'invocation':invocation,'rootCapability':root,'expectedAction':SGyTfX[_0x536e10(0x43c)]});SGyTfX[_0x536e10(0x246)](expect,result)['to'][_0x536e10(0x34d)],expect(result[_0x536e10(0x1dd)])['to']['be'][_0x536e10(0x224)],result['error']['name'][_0x536e10(0x278)][_0x536e10(0x357)](SGyTfX[_0x536e10(0x2cd)]);const [error]=result['error']['errors'];error['message']['should'][_0x536e10(0x225)]('Capability\x20controller\x20not\x20found');}),it(_0x527338(0x25a)+_0x527338(0x310),async()=>{const _0x1b0171=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'invocationTarget':uuid()};SGyTfX[_0x1b0171(0x1ab)](addToLoader,{'doc':root});const doc=clone(mock[_0x1b0171(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':root,'capabilityAction':SGyTfX['JlBjW']}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':root,'expectedAction':SGyTfX[_0x1b0171(0x43c)]});SGyTfX[_0x1b0171(0x246)](expect,result)['to'][_0x1b0171(0x34d)],SGyTfX[_0x1b0171(0x38e)](expect,result[_0x1b0171(0x1dd)])['to']['be'][_0x1b0171(0x3f6)];}),nYRzSt[_0x527338(0x25f)](it,nYRzSt[_0x527338(0x22b)](nYRzSt['aIGvD'],nYRzSt[_0x527338(0x306)]),async()=>{const _0x181516=_0x527338;if(SGyTfX[_0x181516(0x19c)](_0x181516(0x210),_0x181516(0x210)))return _0x3a6d56++,_0x5cbfe4[_0x181516(0x278)]['be']['an'](SGyTfX[_0x181516(0x2d0)]),_0x3edbc0[_0x181516(0x278)][_0x181516(0x26d)][_0x181516(0x148)](0x4),_0x203bb0[_0x181516(0x278)]['be']['an'](SGyTfX[_0x181516(0x2d0)]),_0xdec39d['should'][_0x181516(0x26d)][_0x181516(0x148)](0x4),_0x20dec8({'capabilityChain':_0x5be565}),_0x1d9578({'capabilityChainMeta':_0x160cde}),{'valid':!![]};else{const root={'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x181516(0x43f)](uuid),'invocationTarget':SGyTfX[_0x181516(0x43f)](uuid),'controller':bob['id']()};addToLoader({'doc':root});const doc=SGyTfX[_0x181516(0x287)](clone,mock[_0x181516(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':root,'capabilityAction':'read'}),result=await SGyTfX[_0x181516(0x1ab)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':SGyTfX[_0x181516(0x43c)],'expectedRootCapability':[root['id']],'expectedTarget':root[_0x181516(0x412)]}});expect(result)['to'][_0x181516(0x34d)],expect(result['verified'])['to']['be'][_0x181516(0x3f6)];}}),nYRzSt[_0x527338(0x23e)](it,_0x527338(0x11b)+nYRzSt[_0x527338(0x2ac)],async()=>{const _0x3db2d5=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':bthJAb['ubGRp'](uuid),'controller':bob['id'](),'invocationTarget':bthJAb[_0x3db2d5(0x3d1)](uuid)};bthJAb['Vjyje'](addToLoader,{'doc':root});const doc=clone(mock[_0x3db2d5(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':root,'capabilityAction':bthJAb[_0x3db2d5(0x2be)]}),expectedRootCapability=[root['id']['replace'](_0x3db2d5(0x34a),'')];let result,error;try{result=await bthJAb[_0x3db2d5(0x3ef)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':_0x3db2d5(0x1c5),'expectedRootCapability':expectedRootCapability,'expectedTarget':root['invocationTarget']}});}catch(e){error=e;}expect(result)['to'][_0x3db2d5(0x382)][_0x3db2d5(0x34d)],bthJAb[_0x3db2d5(0x3f2)](expect,error)['to'][_0x3db2d5(0x34d)],error[_0x3db2d5(0x418)][_0x3db2d5(0x278)][_0x3db2d5(0x225)]('\x22expectedRootCapability\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.');}),nYRzSt[_0x527338(0x25f)](it,nYRzSt[_0x527338(0x157)](nYRzSt[_0x527338(0x2eb)],_0x527338(0x364)),async()=>{const _0x4c41c9=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x4c41c9(0x43f)](uuid),'controller':bob['id'](),'invocationTarget':SGyTfX['FwaxX'](uuid)};SGyTfX[_0x4c41c9(0x287)](addToLoader,{'doc':root});const doc=SGyTfX['PWvgL'](clone,mock[_0x4c41c9(0x2f8)]),invocation=await SGyTfX[_0x4c41c9(0x1fb)](_invoke,{'doc':doc,'invoker':bob,'capability':root,'capabilityAction':SGyTfX[_0x4c41c9(0x43c)]});let error,result;try{result=await SGyTfX[_0x4c41c9(0x1ab)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':'read','expectedTarget':root[_0x4c41c9(0x412)]}});}catch(e){error=e;}expect(result)['to'][_0x4c41c9(0x382)][_0x4c41c9(0x34d)],expect(error)['to'][_0x4c41c9(0x34d)],error['name']['should']['equal'](SGyTfX[_0x4c41c9(0x16d)]),error[_0x4c41c9(0x418)]['should'][_0x4c41c9(0x225)]('\x22expectedRootCapability\x22\x20must\x20be\x20a\x20string\x20or\x20array.');}),nYRzSt[_0x527338(0x185)](it,_0x527338(0x1e4),async()=>{const _0x37ecaa=_0x527338,doc={'@context':ZCAP_CONTEXT_URL,'example:foo':bthJAb[_0x37ecaa(0x176)](uuid)},target1='https://zcap.example/target1',target2=_0x37ecaa(0x3ea),invocation1=await bthJAb[_0x37ecaa(0x37e)](_invoke,{'doc':doc,'invoker':alice,'purposeOptions':{'capability':capabilities[_0x37ecaa(0x36d)][_0x37ecaa(0x13e)]['id'],'capabilityAction':_0x37ecaa(0x1c5),'invocationTarget':target1}}),invocation2=await bthJAb['PpThH'](_invoke,{'doc':invocation1,'invoker':alice,'purposeOptions':{'capability':capabilities[_0x37ecaa(0x36d)][_0x37ecaa(0x13e)]['id'],'capabilityAction':'read','invocationTarget':target2}}),result=await jsigs['verify'](invocation2,{'suite':new Ed25519Signature2020(),'purpose':[new CapabilityInvocation({'allowTargetAttenuation':!![],'expectedAction':_0x37ecaa(0x1c5),'expectedRootCapability':capabilities[_0x37ecaa(0x36d)][_0x37ecaa(0x13e)]['id'],'expectedTarget':[capabilities[_0x37ecaa(0x36d)]['restful'][_0x37ecaa(0x412)],target1]}),new CapabilityInvocation({'allowTargetAttenuation':!![],'expectedAction':bthJAb['xEztm'],'expectedRootCapability':capabilities[_0x37ecaa(0x36d)][_0x37ecaa(0x13e)]['id'],'expectedTarget':[capabilities['root']['restful'][_0x37ecaa(0x412)],target2]})],'documentLoader':testLoader});bthJAb['HkxbB'](expect,result)['to'][_0x37ecaa(0x34d)],bthJAb[_0x37ecaa(0x1d1)](expect,result[_0x37ecaa(0x1dd)])['to']['be']['true'];}),it(_0x527338(0x401),async()=>{const _0x53e334=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['qULJL'](uuid),'controller':[_0x53e334(0x432),bob['id']()],'invocationTarget':SGyTfX[_0x53e334(0x29c)](uuid)};SGyTfX[_0x53e334(0x180)](addToLoader,{'doc':root});const doc=clone(mock['exampleDoc']),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':root,'capabilityAction':SGyTfX[_0x53e334(0x43c)]}),result=await SGyTfX[_0x53e334(0x17f)](_verifyInvocation,{'invocation':invocation,'rootCapability':root,'expectedAction':SGyTfX[_0x53e334(0x43c)]});SGyTfX[_0x53e334(0x268)](expect,result)['to'][_0x53e334(0x34d)],SGyTfX[_0x53e334(0x178)](expect,result['verified'])['to']['be'][_0x53e334(0x3f6)];}),nYRzSt['ReFpM'](it,_0x527338(0x1fa),async()=>{const _0x281105=_0x527338,root={'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':[SGyTfX['iJQBA'],bob['id']()],'invocationTarget':uuid()};SGyTfX[_0x281105(0x268)](addToLoader,{'doc':root});const doc=clone(mock[_0x281105(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':root,'capabilityAction':SGyTfX[_0x281105(0x43c)]}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':root,'expectedAction':_0x281105(0x1c5)});SGyTfX[_0x281105(0x178)](expect,result)['to'][_0x281105(0x34d)],SGyTfX[_0x281105(0x2aa)](expect,result['verified'])['to']['be'][_0x281105(0x3f6)];}),it(_0x527338(0x2c4),async()=>{const _0x6a8873=_0x527338,delegatedCapability=await bthJAb[_0x6a8873(0x3ef)](_delegate,{'parentCapability':capabilities['root'][_0x6a8873(0x2cb)],'controller':bob,'delegator':alice}),doc=bthJAb['JCrmI'](clone,mock['exampleDoc']),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':_0x6a8873(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'purposeOptions':{'expectedAction':'read','expectedRootCapability':_0x6a8873(0x3ac),'expectedTarget':capabilities[_0x6a8873(0x36d)]['beta']['invocationTarget']}});expect(result)['to'][_0x6a8873(0x34d)],expect(result[_0x6a8873(0x1dd)])['to']['be'][_0x6a8873(0x224)],result[_0x6a8873(0x13d)]['name'][_0x6a8873(0x278)][_0x6a8873(0x357)](bthJAb[_0x6a8873(0x222)]);const [error]=result[_0x6a8873(0x13d)]['errors'];error[_0x6a8873(0x418)][_0x6a8873(0x278)]['contain'](bthJAb[_0x6a8873(0x269)]);}),nYRzSt['VGMPR'](it,nYRzSt['WKtYq'],async()=>{const _0x581caf=_0x527338,delegatedCapability=await _delegate({'parentCapability':capabilities[_0x581caf(0x36d)][_0x581caf(0x2cb)],'controller':bob,'delegator':alice}),result=await bthJAb[_0x581caf(0x3a9)](_verifyDelegation,{'delegation':delegatedCapability,'expectedRootCapability':capabilities[_0x581caf(0x36d)][_0x581caf(0x2cb)]['id']});expect(result)['to'][_0x581caf(0x34d)],expect(result['verified'])['to']['be'][_0x581caf(0x3f6)];}),it(_0x527338(0x1bd)+_0x527338(0x298),async()=>{const _0x4e07a6=_0x527338,delegatedCapability=await bthJAb[_0x4e07a6(0x1f4)](_delegate,{'parentCapability':capabilities['root'][_0x4e07a6(0x2cb)],'controller':bob,'delegator':alice}),doc=bthJAb[_0x4e07a6(0x152)](clone,mock['exampleDoc']),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':bthJAb['xEztm']}),result=await bthJAb[_0x4e07a6(0x1c0)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x4e07a6(0x36d)]['beta'],'expectedAction':bthJAb[_0x4e07a6(0x2be)]});expect(result)['to'][_0x4e07a6(0x34d)],bthJAb['izEZE'](expect,result[_0x4e07a6(0x1dd)])['to']['be'][_0x4e07a6(0x3f6)];}),it(nYRzSt[_0x527338(0x307)]+nYRzSt[_0x527338(0x12f)],async()=>{const _0x1db3e9=_0x527338;if(bthJAb['xOvSV'](bthJAb[_0x1db3e9(0x1c4)],'hKBhl')){const delegatedCapability=await bthJAb[_0x1db3e9(0x240)](_delegate,{'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice}),doc=bthJAb['Vjyje'](clone,mock[_0x1db3e9(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':bthJAb[_0x1db3e9(0x3d2)]}),result=await bthJAb[_0x1db3e9(0x376)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x1db3e9(0x36d)][_0x1db3e9(0x2cb)],'expectedAction':'write'});expect(result)['to']['exist'],expect(result[_0x1db3e9(0x1dd)])['to']['be']['true'];}else return _0x31cd0e[_0x1db3e9(0x241)](_0x401ee1[_0x1db3e9(0x1de)](_0x43c82f));}),nYRzSt['QXYnD'](it,nYRzSt[_0x527338(0x2b1)](_0x527338(0x139),_0x527338(0x304)),async()=>{const _0x4dc041=_0x527338;if(bthJAb[_0x4dc041(0x419)]!==_0x4dc041(0x330)){const delegatedCapability=await bthJAb[_0x4dc041(0x266)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':bthJAb[_0x4dc041(0x42d)](uuid),'controller':bob['id'](),'parentCapability':capabilities[_0x4dc041(0x36d)][_0x4dc041(0x2cb)]['id'],'invocationTarget':capabilities[_0x4dc041(0x36d)][_0x4dc041(0x2cb)][_0x4dc041(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':_0x4dc041(0x42e)},'parentCapability':capabilities[_0x4dc041(0x36d)][_0x4dc041(0x2cb)],'delegator':alice}),doc=clone(mock[_0x4dc041(0x2f8)]),invocation=await bthJAb[_0x4dc041(0x1a6)](_invoke,{'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':bthJAb[_0x4dc041(0x3d2)]}),result=await bthJAb['Oxsbz'](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x4dc041(0x36d)][_0x4dc041(0x2cb)],'expectedAction':bthJAb[_0x4dc041(0x3d2)]});bthJAb[_0x4dc041(0x347)](expect,result)['to'][_0x4dc041(0x34d)],bthJAb[_0x4dc041(0x2bf)](expect,result[_0x4dc041(0x1dd)])['to']['be'][_0x4dc041(0x3f6)];}else return _0x946ea9++,_0x53e84f[_0x4dc041(0x34d)](_0x5d09f9),_0x3c3a20[_0x4dc041(0x278)]['be']['an'](SGyTfX[_0x4dc041(0x2d0)]),_0x196e5b['should'][_0x4dc041(0x26d)][_0x4dc041(0x148)](0x3),SGyTfX[_0x4dc041(0x1a3)](_0x361794,{'capabilityChain':_0x3ba9df}),SGyTfX['IxzTe'](_0xb936ef,{'capabilityChainMeta':_0x3d7e95}),{'error':new _0x3637c0('The\x20capability\x20\x22'+_0x34118f[0x0]['id']+_0x4dc041(0x16a)),'valid':![]};}),it(nYRzSt['jscOy']('should\x20fail\x20to\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20when\x20',_0x527338(0x2ea)),async()=>{const _0x2aacd8=_0x527338;if(SGyTfX[_0x2aacd8(0x236)]!==SGyTfX[_0x2aacd8(0x236)])_0x24a325=_0x5aedfa;else{const delegatedCapability=await SGyTfX[_0x2aacd8(0x246)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['hKroC'](uuid),'controller':bob['id'](),'parentCapability':capabilities['root']['beta']['id'],'invocationTarget':capabilities[_0x2aacd8(0x36d)][_0x2aacd8(0x2cb)][_0x2aacd8(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':SGyTfX[_0x2aacd8(0x1eb)]},'parentCapability':capabilities[_0x2aacd8(0x36d)][_0x2aacd8(0x2cb)],'delegator':alice}),doc=clone(mock[_0x2aacd8(0x2f8)]),invocation=await SGyTfX[_0x2aacd8(0x39e)](_invoke,{'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':''});delete invocation[_0x2aacd8(0x197)]['capabilityAction'];const result=await SGyTfX[_0x2aacd8(0x180)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':_0x2aacd8(0x42e),'expectedRootCapability':capabilities[_0x2aacd8(0x36d)][_0x2aacd8(0x2cb)]['id'],'expectedTarget':capabilities[_0x2aacd8(0x36d)][_0x2aacd8(0x2cb)][_0x2aacd8(0x412)]}});SGyTfX[_0x2aacd8(0x332)](expect,result)['to'][_0x2aacd8(0x34d)],SGyTfX[_0x2aacd8(0x2a9)](expect,result[_0x2aacd8(0x1dd)])['to']['be'][_0x2aacd8(0x224)],result[_0x2aacd8(0x13d)][_0x2aacd8(0x2ce)][_0x2aacd8(0x278)][_0x2aacd8(0x357)](SGyTfX[_0x2aacd8(0x2cd)]);const [error]=result[_0x2aacd8(0x13d)][_0x2aacd8(0x221)];error['name'][_0x2aacd8(0x278)][_0x2aacd8(0x357)](SGyTfX[_0x2aacd8(0x35d)]);}}),it(nYRzSt[_0x527338(0x118)]+nYRzSt[_0x527338(0x1d6)],async()=>{const _0x4d403c=_0x527338,delegatedCapability=await bthJAb['nSHuk'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':bthJAb['ltFbS'](uuid),'controller':bob['id'](),'parentCapability':capabilities['root'][_0x4d403c(0x2cb)]['id'],'invocationTarget':capabilities[_0x4d403c(0x36d)]['beta'][_0x4d403c(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':bthJAb[_0x4d403c(0x3d2)]},'parentCapability':capabilities[_0x4d403c(0x36d)][_0x4d403c(0x2cb)],'delegator':alice}),doc=bthJAb[_0x4d403c(0x1fd)](clone,mock[_0x4d403c(0x2f8)]),invocation=await bthJAb['izEZE'](_invoke,{'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':bthJAb[_0x4d403c(0x31f)]}),result=await bthJAb[_0x4d403c(0x152)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x4d403c(0x36d)]['beta'],'expectedAction':'write'});bthJAb['yvMwL'](expect,result)['to'][_0x4d403c(0x34d)],expect(result[_0x4d403c(0x1dd)])['to']['be'][_0x4d403c(0x224)],result[_0x4d403c(0x13d)][_0x4d403c(0x2ce)][_0x4d403c(0x278)]['equal'](bthJAb[_0x4d403c(0x222)]);const [error]=result['error'][_0x4d403c(0x221)];error['name'][_0x4d403c(0x278)][_0x4d403c(0x357)]('NotFoundError');}),it(_0x527338(0x18d)+nYRzSt[_0x527338(0x338)],async()=>{const _0x469417=_0x527338,delegatedCapability=await _delegate({'parentCapability':capabilities['root'][_0x469417(0x2cb)],'controller':bob,'delegator':alice}),doc=clone(mock[_0x469417(0x2f8)]),invocation=await SGyTfX[_0x469417(0x1b7)](_invoke,{'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':''});delete invocation[_0x469417(0x197)][_0x469417(0x368)];const result=await _verifyInvocation({'invocation':invocation,'rootCapability':capabilities[_0x469417(0x36d)]['beta'],'expectedAction':_0x469417(0x42e)});SGyTfX[_0x469417(0x17f)](expect,result)['to']['exist'],expect(result[_0x469417(0x1dd)])['to']['be']['false'],result[_0x469417(0x13d)][_0x469417(0x2ce)][_0x469417(0x278)][_0x469417(0x357)](_0x469417(0x342));const [error]=result[_0x469417(0x13d)][_0x469417(0x221)];error[_0x469417(0x2ce)][_0x469417(0x278)][_0x469417(0x357)](_0x469417(0x1db));}),nYRzSt[_0x527338(0x1b8)](it,nYRzSt[_0x527338(0x2f7)](nYRzSt[_0x527338(0x1e7)],nYRzSt[_0x527338(0x158)]),async()=>{const _0x237aa2=_0x527338;if('oIvRT'===SGyTfX[_0x237aa2(0x1b2)]){const delegatedCapability=await _delegate({'parentCapability':capabilities[_0x237aa2(0x36d)][_0x237aa2(0x2cb)],'controller':bob,'delegator':alice}),doc=clone(mock[_0x237aa2(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':delegatedCapability,'capabilityAction':_0x237aa2(0x42e)}),result=await SGyTfX[_0x237aa2(0x38e)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x237aa2(0x36d)][_0x237aa2(0x2cb)],'expectedAction':SGyTfX[_0x237aa2(0x43c)]});SGyTfX[_0x237aa2(0x27e)](expect,result)['to'][_0x237aa2(0x34d)],expect(result[_0x237aa2(0x1dd)])['to']['be'][_0x237aa2(0x224)],result[_0x237aa2(0x13d)][_0x237aa2(0x2ce)][_0x237aa2(0x278)]['equal'](SGyTfX[_0x237aa2(0x2cd)]);const [error]=result[_0x237aa2(0x13d)]['errors'];error[_0x237aa2(0x2ce)][_0x237aa2(0x278)][_0x237aa2(0x357)](_0x237aa2(0x1db));}else _0x17c4a2=new _0xe7e004({'suite':new _0x1aacae(),..._0xbc302e});}),nYRzSt[_0x527338(0x37c)](describe,'Chain\x20depth\x20of\x203',()=>{const _0xf09f22=_0x527338,vfbElx={'lfPdK':function(callee,param1){return SGyTfX['SZWqa'](callee,param1);},'rgJou':function(callee,param1){const _0x2d7ee6=_0x59eb;return SGyTfX[_0x2d7ee6(0x268)](callee,param1);},'SeBzb':function(callee,param1){return callee(param1);},'abJHY':SGyTfX[_0xf09f22(0x2ef)],'gHFIH':_0xf09f22(0x342),'Rhhku':_0xf09f22(0x328),'BQTto':SGyTfX[_0xf09f22(0x1da)],'aNVmO':SGyTfX[_0xf09f22(0x30a)],'NujBO':_0xf09f22(0x3b7),'MqRkl':SGyTfX[_0xf09f22(0x179)],'flrPJ':function(x,y){return x!==y;},'zJHbV':SGyTfX['JlBjW'],'vUjun':_0xf09f22(0x42e),'CZUQU':function(x,y){const _0x1c723d=_0xf09f22;return SGyTfX[_0x1c723d(0x19c)](x,y);},'tuZNC':SGyTfX[_0xf09f22(0x375)],'IlbEe':function(callee,param1){return callee(param1);},'ahyXe':'Error','eQknc':function(x,y){return x+y;},'zxJxc':SGyTfX[_0xf09f22(0x26b)],'itKAu':function(callee){const _0xa77ec6=_0xf09f22;return SGyTfX[_0xa77ec6(0x291)](callee);},'goiGA':SGyTfX[_0xf09f22(0x226)],'lXLHw':_0xf09f22(0x2ca),'GXxYf':SGyTfX[_0xf09f22(0x140)],'YckOF':SGyTfX['YtSsa'],'nTHtp':function(callee,param1){return callee(param1);},'yonXU':function(x,y){return x+y;},'UfPOL':function(callee,param1){return callee(param1);},'oYmyZ':function(callee,param1){return SGyTfX['eqmLL'](callee,param1);},'rNnBU':SGyTfX[_0xf09f22(0x31c)],'FZJyr':function(x,y){return x!==y;},'Ebdcd':SGyTfX['RjuUk'],'WBHVl':function(x,y){return x*y;},'eldsV':function(x,y){return SGyTfX['iLBKu'](x,y);},'WRVsX':function(callee,param1){return SGyTfX['atWTe'](callee,param1);},'gsOpz':function(callee){return callee();},'OLbvG':function(callee,param1){const _0x441aa7=_0xf09f22;return SGyTfX[_0x441aa7(0x1b7)](callee,param1);},'DupKO':function(callee,param1){const _0x451d53=_0xf09f22;return SGyTfX[_0x451d53(0x1c7)](callee,param1);},'LWhtc':_0xf09f22(0x442),'QkpzR':function(x,y){const _0x49310f=_0xf09f22;return SGyTfX[_0x49310f(0x3b6)](x,y);},'VPpxO':SGyTfX['BAYxB'],'vaWEh':function(callee,param1){return callee(param1);},'CPYAW':function(x,y){const _0xec8075=_0xf09f22;return SGyTfX[_0xec8075(0x390)](x,y);},'ZGlcx':function(callee,param1){return callee(param1);},'gLCBa':function(callee){const _0x3763e9=_0xf09f22;return SGyTfX[_0x3763e9(0x2ff)](callee);},'GutFL':function(callee,param1){return callee(param1);},'ZiUji':function(callee,param1){const _0xd43d6a=_0xf09f22;return SGyTfX[_0xd43d6a(0x372)](callee,param1);},'hKjxT':function(callee,param1){const _0xf444cb=_0xf09f22;return SGyTfX[_0xf444cb(0x194)](callee,param1);},'vaZME':function(callee,param1){return callee(param1);},'qWkeL':function(callee,param1){return callee(param1);},'GymXL':function(x,y){const _0x5b8c6e=_0xf09f22;return SGyTfX[_0x5b8c6e(0x30e)](x,y);},'EVKdH':_0xf09f22(0x3d0)};it(_0xf09f22(0x260),async()=>{const _0x581ce1=_0xf09f22,bobZcap=await vfbElx[_0x581ce1(0x16e)](_delegate,{'parentCapability':capabilities[_0x581ce1(0x36d)][_0x581ce1(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x581ce1(0x36d)][_0x581ce1(0x2cb)]['id']});vfbElx[_0x581ce1(0x195)](expect,result)['to']['exist'],vfbElx['SeBzb'](expect,result[_0x581ce1(0x1dd)])['to']['be'][_0x581ce1(0x3f6)];}),it(SGyTfX[_0xf09f22(0x405)]+_0xf09f22(0x124),async()=>{const _0x5bfcab=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice,'_capabilityChain':[capabilities[_0x5bfcab(0x36d)][_0x5bfcab(0x2cb)]]});let carolZcap,localError;try{'qOsWW'===SGyTfX[_0x5bfcab(0x155)]?carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}):_0x19c7aa=_0x5795de[_0x5bfcab(0x253)](vfbElx[_0x5bfcab(0x2c0)],0x0);}catch(e){localError=e;}expect(localError)['to'][_0x5bfcab(0x34d)],localError[_0x5bfcab(0x2ce)][_0x5bfcab(0x278)][_0x5bfcab(0x357)](SGyTfX[_0x5bfcab(0x16d)]),localError[_0x5bfcab(0x418)][_0x5bfcab(0x278)][_0x5bfcab(0x225)](_0x5bfcab(0x15d)),carolZcap=await SGyTfX[_0x5bfcab(0x13f)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob,'purposeOptions':{'_skipLocalValidationForTesting':!![]}});const result=await SGyTfX[_0x5bfcab(0x3f1)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x5bfcab(0x36d)][_0x5bfcab(0x2cb)]['id']});should[_0x5bfcab(0x34d)](result),result[_0x5bfcab(0x1dd)][_0x5bfcab(0x278)]['be'][_0x5bfcab(0x224)],should[_0x5bfcab(0x34d)](result['error']),result['error'][_0x5bfcab(0x2ce)]['should']['equal'](_0x5bfcab(0x342));const [error]=result['error'][_0x5bfcab(0x221)];error[_0x5bfcab(0x418)][_0x5bfcab(0x278)][_0x5bfcab(0x225)](SGyTfX[_0x5bfcab(0x187)]);}),SGyTfX[_0xf09f22(0x27d)](it,_0xf09f22(0x2de)+SGyTfX[_0xf09f22(0x2ba)],async()=>{const _0x9e78d7=_0xf09f22,bobZcap=await vfbElx[_0x9e78d7(0x195)](_delegate,{'parentCapability':capabilities['root'][_0x9e78d7(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob,'purposeOptions':{'_skipLocalValidationForTesting':!![],'_capabilityChain':[capabilities[_0x9e78d7(0x36d)][_0x9e78d7(0x2cb)]['id'],bobZcap['id']]}}),result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x9e78d7(0x36d)][_0x9e78d7(0x2cb)]['id']});should[_0x9e78d7(0x34d)](result),result[_0x9e78d7(0x1dd)][_0x9e78d7(0x278)]['be']['false'],should[_0x9e78d7(0x34d)](result[_0x9e78d7(0x13d)]),result[_0x9e78d7(0x13d)][_0x9e78d7(0x2ce)][_0x9e78d7(0x278)][_0x9e78d7(0x357)](vfbElx[_0x9e78d7(0x3b8)]);const [error]=result[_0x9e78d7(0x13d)][_0x9e78d7(0x221)];error[_0x9e78d7(0x418)]['should'][_0x9e78d7(0x225)](vfbElx[_0x9e78d7(0x1b6)]);}),it(_0xf09f22(0x407)+_0xf09f22(0x2ae),async()=>{const _0xab86ae=_0xf09f22,bobZcap=await SGyTfX[_0xab86ae(0x2a9)](_delegate,{'parentCapability':capabilities[_0xab86ae(0x36d)][_0xab86ae(0x2cb)],'controller':bob,'delegator':alice,'_capabilityChain':[capabilities[_0xab86ae(0x36d)]['alpha']['id']]}),carolZcap=await SGyTfX[_0xab86ae(0x295)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob,'_capabilityChain':[capabilities[_0xab86ae(0x36d)][_0xab86ae(0x2cb)]['id'],bobZcap]}),result=await SGyTfX[_0xab86ae(0x1a3)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0xab86ae(0x36d)]['beta']['id']});should[_0xab86ae(0x34d)](result),result[_0xab86ae(0x1dd)][_0xab86ae(0x278)]['be']['false'],should['exist'](result[_0xab86ae(0x13d)]),result[_0xab86ae(0x13d)][_0xab86ae(0x2ce)][_0xab86ae(0x278)][_0xab86ae(0x357)](SGyTfX[_0xab86ae(0x2cd)]);const [error]=result['error']['errors'];error['message'][_0xab86ae(0x278)][_0xab86ae(0x225)](_0xab86ae(0x2a5));}),it('should\x20fail\x20to\x20verify\x20chain\x20with\x20misreferenced\x20parent\x20'+SGyTfX['lRTeb'],async()=>{const _0xefd869=_0xf09f22;if(SGyTfX['vEckh']!==_0xefd869(0x205)){const bobZcap=await SGyTfX[_0xefd869(0x212)](_delegate,{'parentCapability':capabilities[_0xefd869(0x36d)][_0xefd869(0x2cb)],'controller':bob,'delegator':alice}),dianaZcap=await _delegate({'parentCapability':capabilities[_0xefd869(0x36d)][_0xefd869(0x2cb)],'controller':diana,'delegator':alice}),carolZcap=await SGyTfX[_0xefd869(0x3e8)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob,'_capabilityChain':[capabilities[_0xefd869(0x36d)][_0xefd869(0x302)]['id'],dianaZcap]}),result=await SGyTfX[_0xefd869(0x35e)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0xefd869(0x36d)][_0xefd869(0x2cb)]['id']});should[_0xefd869(0x34d)](result),result[_0xefd869(0x1dd)][_0xefd869(0x278)]['be'][_0xefd869(0x224)],should['exist'](result[_0xefd869(0x13d)]),result[_0xefd869(0x13d)][_0xefd869(0x2ce)][_0xefd869(0x278)][_0xefd869(0x357)](_0xefd869(0x342));const [error]=result[_0xefd869(0x13d)][_0xefd869(0x221)];error['message'][_0xefd869(0x278)]['contain'](SGyTfX[_0xefd869(0x333)]);}else _0x4cbbc4=new _0x530276({'capability':_0x3d86ac[_0xefd869(0x415)]?_0x78d11e:_0x5c4f8e['id'],'capabilityAction':_0x10620a,'invocationTarget':_0x3b596a['invocationTarget']});}),it(SGyTfX[_0xf09f22(0x13a)](SGyTfX['vQXgu'],SGyTfX['VkIld']),async()=>{const _0x187c52=_0xf09f22,bobZcap=await SGyTfX[_0x187c52(0x408)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities[_0x187c52(0x36d)][_0x187c52(0x2cb)]['id'],'invocationTarget':capabilities[_0x187c52(0x36d)][_0x187c52(0x2cb)][_0x187c52(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':SGyTfX[_0x187c52(0x43c)]},'parentCapability':capabilities[_0x187c52(0x36d)][_0x187c52(0x2cb)],'delegator':alice});let carolZcap,localError;try{carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x187c52(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':_0x187c52(0x42e)},'parentCapability':bobZcap,'delegator':bob});}catch(e){localError=e;}SGyTfX[_0x187c52(0x1fb)](expect,localError)['to']['exist'],localError[_0x187c52(0x2ce)][_0x187c52(0x278)][_0x187c52(0x357)](_0x187c52(0x231)),localError[_0x187c52(0x418)][_0x187c52(0x278)]['equal'](SGyTfX[_0x187c52(0x26b)]+SGyTfX['jyWqk']),carolZcap=await SGyTfX[_0x187c52(0x249)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x187c52(0x3ff)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x187c52(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':_0x187c52(0x42e)},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const result=await SGyTfX[_0x187c52(0x1b7)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities['root']['beta']['id']});should[_0x187c52(0x34d)](result),result[_0x187c52(0x1dd)][_0x187c52(0x278)]['be']['false'],should[_0x187c52(0x34d)](result['error']),result['error'][_0x187c52(0x2ce)]['should']['equal'](SGyTfX['bsWHf']);const [error]=result[_0x187c52(0x13d)][_0x187c52(0x221)];error['message']['should']['contain'](SGyTfX[_0x187c52(0x14c)]);}),SGyTfX[_0xf09f22(0x27d)](it,SGyTfX[_0xf09f22(0x323)]+SGyTfX['ZqwTw'],async()=>{const _0x1da8b7=_0xf09f22,DiBAQX={'czPqW':vfbElx['NujBO']};if(_0x1da8b7(0x2da)!==vfbElx[_0x1da8b7(0x27c)])_0x33684b=_0x1eaac7;else{const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities[_0x1da8b7(0x36d)][_0x1da8b7(0x2cb)]['id'],'invocationTarget':capabilities[_0x1da8b7(0x36d)][_0x1da8b7(0x2cb)]['invocationTarget'],'expires':EXPIRES_3000_DATE,'allowedAction':_0x1da8b7(0x1c5)},'parentCapability':capabilities[_0x1da8b7(0x36d)][_0x1da8b7(0x2cb)],'delegator':alice});let carolZcap,localError;try{vfbElx[_0x1da8b7(0x1ed)](_0x1da8b7(0x228),_0x1da8b7(0x1f2))?carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x1da8b7(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':[vfbElx[_0x1da8b7(0x1b4)],vfbElx[_0x1da8b7(0x1b9)]]},'parentCapability':bobZcap,'delegator':bob}):_0x42fc37=new _0x41799b({'expectedRootCapability':DiBAQX[_0x1da8b7(0x219)],'date':_0x1da8b7(0x147)});}catch(e){vfbElx['CZUQU'](vfbElx[_0x1da8b7(0x1d5)],'Gunaq')?(_0x3e7582['should']['be']['an'](_0x1da8b7(0x2c5)),_0xc94163[_0x1da8b7(0x278)][_0x1da8b7(0x26d)][_0x1da8b7(0x3ca)]('id'),_0x446076['should']['have']['property'](vfbElx[_0x1da8b7(0x299)]),_0x4b3e71[_0x1da8b7(0x278)][_0x1da8b7(0x26d)][_0x1da8b7(0x3ca)](vfbElx['aNVmO'])):localError=e;}vfbElx[_0x1da8b7(0x38b)](expect,localError)['to'][_0x1da8b7(0x34d)],localError['name'][_0x1da8b7(0x278)][_0x1da8b7(0x357)](vfbElx[_0x1da8b7(0x301)]),localError[_0x1da8b7(0x418)][_0x1da8b7(0x278)]['equal'](vfbElx[_0x1da8b7(0x327)](vfbElx[_0x1da8b7(0x1a9)],_0x1da8b7(0x2a3))),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':vfbElx[_0x1da8b7(0x37b)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':EXPIRES_3000_DATE,'allowedAction':[vfbElx[_0x1da8b7(0x1b4)],_0x1da8b7(0x42e)]},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x1da8b7(0x36d)][_0x1da8b7(0x2cb)]['id']});should[_0x1da8b7(0x34d)](result),result[_0x1da8b7(0x1dd)]['should']['be']['false'],should[_0x1da8b7(0x34d)](result[_0x1da8b7(0x13d)]),result['error'][_0x1da8b7(0x2ce)][_0x1da8b7(0x278)][_0x1da8b7(0x357)](_0x1da8b7(0x342));const [error]=result[_0x1da8b7(0x13d)][_0x1da8b7(0x221)];error['message'][_0x1da8b7(0x278)][_0x1da8b7(0x225)](_0x1da8b7(0x1ba));}}),it(SGyTfX['Pqmrv']('should\x20fail\x20to\x20verify\x20chain\x20',_0xf09f22(0x18c)),async()=>{const _0x3a754f=_0xf09f22,bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['FwaxX'](uuid),'controller':bob['id'](),'parentCapability':capabilities[_0x3a754f(0x36d)]['beta']['id'],'invocationTarget':capabilities[_0x3a754f(0x36d)][_0x3a754f(0x2cb)]['invocationTarget'],'expires':EXPIRES_3000_DATE,'allowedAction':[SGyTfX[_0x3a754f(0x43c)],_0x3a754f(0x42e)]},'parentCapability':capabilities[_0x3a754f(0x36d)][_0x3a754f(0x2cb)],'delegator':alice});let carolZcap,localError;try{SGyTfX[_0x3a754f(0x2ab)]===_0x3a754f(0x315)?_0x379fd5=new _0x687dd0({'expectedTarget':_0x3a754f(0x20b),'suite':new _0x3b5517(),'date':vfbElx['goiGA']}):carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x3a754f(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':['foo',_0x3a754f(0x112)]},'parentCapability':bobZcap,'delegator':bob});}catch(e){localError=e;}SGyTfX['qDFlA'](expect,localError)['to']['exist'],localError[_0x3a754f(0x2ce)][_0x3a754f(0x278)][_0x3a754f(0x357)](_0x3a754f(0x231)),localError['message']['should'][_0x3a754f(0x357)](SGyTfX[_0x3a754f(0x125)]('The\x20\x22allowedAction\x22\x20in\x20a\x20delegated\x20capability\x20',SGyTfX[_0x3a754f(0x2b3)])),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x3a754f(0x43f)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x3a754f(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':[SGyTfX[_0x3a754f(0x371)],SGyTfX['UqApa']]},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities['root'][_0x3a754f(0x2cb)]['id']});should[_0x3a754f(0x34d)](result),result[_0x3a754f(0x1dd)][_0x3a754f(0x278)]['be'][_0x3a754f(0x224)],should['exist'](result[_0x3a754f(0x13d)]),result['error'][_0x3a754f(0x2ce)][_0x3a754f(0x278)][_0x3a754f(0x357)]('VerificationError');const [error]=result['error'][_0x3a754f(0x221)];error[_0x3a754f(0x418)][_0x3a754f(0x278)][_0x3a754f(0x225)](SGyTfX['WdUOg']);}),SGyTfX[_0xf09f22(0x3d7)](it,SGyTfX[_0xf09f22(0x3fc)]+SGyTfX[_0xf09f22(0x208)],async()=>{const _0x2f14c4=_0xf09f22,bobZcap=await SGyTfX[_0x2f14c4(0x212)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities['root'][_0x2f14c4(0x2cb)]['id'],'invocationTarget':capabilities[_0x2f14c4(0x36d)][_0x2f14c4(0x2cb)][_0x2f14c4(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':[_0x2f14c4(0x1c5),'write']},'parentCapability':capabilities[_0x2f14c4(0x36d)][_0x2f14c4(0x2cb)],'delegator':alice}),carolZcap=await SGyTfX[_0x2f14c4(0x2c9)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x2f14c4(0x2ee)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x2f14c4(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':[SGyTfX[_0x2f14c4(0x43c)]]},'delegator':bob,'parentCapability':bobZcap}),result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x2f14c4(0x36d)]['beta']['id']});should[_0x2f14c4(0x34d)](result),result[_0x2f14c4(0x1dd)][_0x2f14c4(0x278)]['be'][_0x2f14c4(0x3f6)];}),it(SGyTfX[_0xf09f22(0x1f5)](_0xf09f22(0x1c9),_0xf09f22(0x337)),async()=>{const _0x3d3004=_0xf09f22;if(vfbElx[_0x3d3004(0x17a)]!==vfbElx[_0x3d3004(0x1f8)]){const bobZcap=await _delegate({'parentCapability':capabilities[_0x3d3004(0x36d)][_0x3d3004(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':vfbElx[_0x3d3004(0x37b)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x3d3004(0x412)],'expires':EXPIRES_3000_DATE,'allowedAction':_0x3d3004(0x1c5)},'parentCapability':bobZcap,'delegator':bob}),result=await vfbElx['lfPdK'](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x3d3004(0x36d)][_0x3d3004(0x2cb)]['id']});should['exist'](result),result[_0x3d3004(0x1dd)][_0x3d3004(0x278)]['be'][_0x3d3004(0x3f6)];}else _0x105ffe=_0x4bd62d;}),it(SGyTfX['ykPRF'],async()=>{const _0x2e11f7=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities['root'][_0x2e11f7(0x2cb)],'controller':bob,'delegator':alice});bobZcap['id']=SGyTfX[_0x2e11f7(0x43f)](uuid);const carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),result=await SGyTfX[_0x2e11f7(0x23d)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x2e11f7(0x36d)][_0x2e11f7(0x2cb)]['id']});SGyTfX[_0x2e11f7(0x14e)](expect,result)['to'][_0x2e11f7(0x34d)],SGyTfX[_0x2e11f7(0x13f)](expect,result[_0x2e11f7(0x1dd)])['to']['be'][_0x2e11f7(0x224)],result[_0x2e11f7(0x13d)][_0x2e11f7(0x2ce)][_0x2e11f7(0x278)][_0x2e11f7(0x357)](_0x2e11f7(0x342));}),it(_0xf09f22(0x42b),async()=>{const _0x234280=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice}),carolZcap=await SGyTfX['zenEM'](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob});carolZcap['id']=SGyTfX[_0x234280(0x346)](uuid);const result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x234280(0x36d)][_0x234280(0x2cb)]['id']});SGyTfX[_0x234280(0x362)](expect,result)['to']['exist'],expect(result[_0x234280(0x1dd)])['to']['be'][_0x234280(0x224)],result['error']['name'][_0x234280(0x278)][_0x234280(0x357)](_0x234280(0x342));const [error]=result['error']['errors'];error[_0x234280(0x418)][_0x234280(0x278)][_0x234280(0x357)]('Invalid\x20signature.');}),it(_0xf09f22(0x341),async()=>{const _0x217013=_0xf09f22,bobZcap=await SGyTfX['AVErk'](_delegate,{'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x549a61=_0x59eb,UijTOZ=_0x549a61(0x25d)[_0x549a61(0x2d9)]('|');let kuBozd=0x0;while(!![]){switch(UijTOZ[kuBozd++]){case'0':capabilityChainMeta['should']['be']['an'](vfbElx[_0x549a61(0x21e)]);continue;case'1':return{'valid':!![]};case'2':capabilityChainMeta[_0x549a61(0x278)][_0x549a61(0x26d)][_0x549a61(0x148)](0x3);continue;case'3':capabilityChain[_0x549a61(0x278)]['be']['an'](vfbElx['YckOF']);continue;case'4':checkedChain++;continue;case'5':vfbElx[_0x549a61(0x386)](_checkCapabilityChain,{'capabilityChain':capabilityChain});continue;case'6':vfbElx[_0x549a61(0x3da)](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta});continue;case'7':capabilityChain['should']['have'][_0x549a61(0x148)](0x3);continue;}break;}},result=await SGyTfX[_0x217013(0x1a3)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x217013(0x36d)][_0x217013(0x2cb)]['id'],'inspectCapabilityChain':inspectCapabilityChain});SGyTfX[_0x217013(0x249)](expect,result)['to'][_0x217013(0x34d)],expect(result[_0x217013(0x1dd)])['to']['be']['true'],checkedChain[_0x217013(0x278)][_0x217013(0x357)](0x1);}),SGyTfX[_0xf09f22(0x3d7)](it,SGyTfX[_0xf09f22(0x21b)]+SGyTfX[_0xf09f22(0x31b)],async()=>{const _0x27b4cd=_0xf09f22,lyiwBP={'xwqBA':vfbElx[_0x27b4cd(0x21e)],'iMmjG':function(x,y){const _0x3178dc=_0x27b4cd;return vfbElx[_0x3178dc(0x3c3)](x,y);}},bobZcap=await vfbElx[_0x27b4cd(0x38b)](_delegate,{'parentCapability':capabilities[_0x27b4cd(0x36d)][_0x27b4cd(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x2be016=_0x27b4cd;return checkedChain++,capabilityChain[_0x2be016(0x278)]['be']['an'](lyiwBP[_0x2be016(0x1ff)]),capabilityChain['should'][_0x2be016(0x26d)][_0x2be016(0x148)](0x3),_checkCapabilityChain({'capabilityChain':capabilityChain}),_checkCapabilityChainMeta({'capabilityChainMeta':capabilityChainMeta}),{'error':new Error(lyiwBP['iMmjG'](_0x2be016(0x2d5)+capabilityChain[0x0]['id']+'\x22\x20',_0x2be016(0x3ba))),'valid':![]};},result=await _verifyDelegation({'delegation':carolZcap,'expectedRootCapability':capabilities[_0x27b4cd(0x36d)][_0x27b4cd(0x2cb)]['id'],'inspectCapabilityChain':inspectCapabilityChain});expect(result)['to']['exist'],vfbElx[_0x27b4cd(0x144)](expect,result[_0x27b4cd(0x1dd)])['to']['be'][_0x27b4cd(0x224)],expect(result[_0x27b4cd(0x13d)][_0x27b4cd(0x221)][0x0])['to'][_0x27b4cd(0x34d)],result['error'][_0x27b4cd(0x221)][0x0]['message'][_0x27b4cd(0x278)][_0x27b4cd(0x225)](_0x27b4cd(0x206)),checkedChain[_0x27b4cd(0x278)]['equal'](0x1);}),SGyTfX[_0xf09f22(0x3cc)](it,SGyTfX[_0xf09f22(0x239)]+_0xf09f22(0x3b5),async()=>{const _0x1f452e=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice}),carolZcap=await vfbElx[_0x1f452e(0x3da)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob,'date':new Date(0x0),'purposeOptions':{'_skipLocalValidationForTesting':!![]}}),result=await vfbElx[_0x1f452e(0x16e)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x1f452e(0x36d)][_0x1f452e(0x2cb)]['id']});expect(result)['to'][_0x1f452e(0x34d)],expect(result[_0x1f452e(0x1dd)])['to']['be']['false'],vfbElx[_0x1f452e(0x279)](expect,result[_0x1f452e(0x13d)][_0x1f452e(0x221)][0x0])['to'][_0x1f452e(0x34d)],result['error']['errors'][0x0][_0x1f452e(0x418)][_0x1f452e(0x278)][_0x1f452e(0x225)](_0x1f452e(0x309));}),it(SGyTfX[_0xf09f22(0x237)](SGyTfX[_0xf09f22(0x2f1)],SGyTfX[_0xf09f22(0x209)]),async()=>{const _0x31c5a8=_0xf09f22,EvFYzZ={'esAeO':vfbElx['rNnBU'],'OVCOy':_0x31c5a8(0x3a0)};if(vfbElx['FZJyr'](vfbElx[_0x31c5a8(0x233)],vfbElx[_0x31c5a8(0x233)])){let _0x2bc0b3,_0x36dc57;try{_0x2bc0b3=new _0x598c87({'expectedTarget':EvFYzZ[_0x31c5a8(0x3bf)],'suite':new _0x53cd92(),'date':'invalid\x20date'});}catch(_0x1e7713){_0x36dc57=_0x1e7713;}_0x3ef40f[_0x31c5a8(0x34d)](_0x36dc57),_0x201b7f[_0x31c5a8(0x382)][_0x31c5a8(0x34d)](_0x2bc0b3),_0x36dc57[_0x31c5a8(0x278)]['be']['instanceof'](_0x2c240e),_0x36dc57[_0x31c5a8(0x418)][_0x31c5a8(0x278)][_0x31c5a8(0x225)](EvFYzZ[_0x31c5a8(0x438)]);}else{const ttl=vfbElx[_0x31c5a8(0x398)](vfbElx['WBHVl'](0x3e8,0x3c),0x3c)*0x18,expires=new Date(vfbElx[_0x31c5a8(0x3ad)](Date[_0x31c5a8(0x22d)](),ttl)),bobZcap=await vfbElx[_0x31c5a8(0x2bb)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':vfbElx[_0x31c5a8(0x318)](uuid),'controller':bob['id'](),'parentCapability':capabilities[_0x31c5a8(0x36d)][_0x31c5a8(0x2cb)]['id'],'invocationTarget':capabilities['root'][_0x31c5a8(0x2cb)]['invocationTarget'],'expires':expires[_0x31c5a8(0x317)]()},'parentCapability':capabilities[_0x31c5a8(0x36d)]['beta'],'delegator':alice}),carolZcap=await vfbElx[_0x31c5a8(0x144)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x31c5a8(0x412)]},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),result=await vfbElx['OLbvG'](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x31c5a8(0x36d)]['beta']['id'],'purposeOptions':{'maxDelegationTtl':ttl}});vfbElx[_0x31c5a8(0x355)](expect,result)['to'][_0x31c5a8(0x34d)],expect(result[_0x31c5a8(0x1dd)])['to']['be'][_0x31c5a8(0x224)],vfbElx[_0x31c5a8(0x38b)](expect,result[_0x31c5a8(0x13d)]['errors'][0x0])['to'][_0x31c5a8(0x34d)],result['error'][_0x31c5a8(0x221)][0x0][_0x31c5a8(0x418)][_0x31c5a8(0x278)][_0x31c5a8(0x225)](vfbElx[_0x31c5a8(0x39a)]);}}),it(_0xf09f22(0x183)+SGyTfX[_0xf09f22(0x42a)],async()=>{const _0x21b32a=_0xf09f22,ttl=vfbElx[_0x21b32a(0x398)](vfbElx['WBHVl'](0x3e8,0x3c),0x3c)*0x18,delegated=new Date(Date[_0x21b32a(0x22d)]()+ttl),bobZcap=await vfbElx[_0x21b32a(0x2bb)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities['root'][_0x21b32a(0x2cb)]['id'],'invocationTarget':capabilities[_0x21b32a(0x36d)]['beta']['invocationTarget'],'expires':new Date(delegated['getTime']()+vfbElx[_0x21b32a(0x142)](ttl,0x2))[_0x21b32a(0x317)]()},'parentCapability':capabilities[_0x21b32a(0x36d)][_0x21b32a(0x2cb)],'delegator':alice,'date':delegated}),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x21b32a(0x412)],'expires':bobZcap[_0x21b32a(0x427)]},'parentCapability':bobZcap,'delegator':bob,'purposeOptions':{'_skipLocalValidationForTesting':!![]}}),result=await vfbElx[_0x21b32a(0x144)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x21b32a(0x36d)][_0x21b32a(0x2cb)]['id'],'purposeOptions':{'maxDelegationTtl':ttl}});vfbElx[_0x21b32a(0x16e)](expect,result)['to'][_0x21b32a(0x34d)],vfbElx[_0x21b32a(0x144)](expect,result['verified'])['to']['be']['false'],vfbElx[_0x21b32a(0x2bb)](expect,result[_0x21b32a(0x13d)]['errors'][0x0])['to'][_0x21b32a(0x34d)],result[_0x21b32a(0x13d)][_0x21b32a(0x221)][0x0][_0x21b32a(0x418)][_0x21b32a(0x278)]['contain'](vfbElx['VPpxO']);}),it(SGyTfX[_0xf09f22(0x121)](SGyTfX['ZRdfJ'],_0xf09f22(0x1e9)),async()=>{const _0x385f43=_0xf09f22,ttl=SGyTfX[_0x385f43(0x1d0)](SGyTfX[_0x385f43(0x1d0)](0x3e8,0x3c),0x3c)*0x18,now=new Date(),bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities[_0x385f43(0x36d)]['beta']['id'],'invocationTarget':capabilities['root'][_0x385f43(0x2cb)][_0x385f43(0x412)],'expires':new Date(now[_0x385f43(0x248)]()+ttl+0x1)[_0x385f43(0x317)]()},'parentCapability':capabilities[_0x385f43(0x36d)][_0x385f43(0x2cb)],'delegator':alice,'date':now}),carolZcap=await SGyTfX[_0x385f43(0x331)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x385f43(0x3ff)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x385f43(0x412)],'expires':bobZcap[_0x385f43(0x427)]},'parentCapability':bobZcap,'delegator':bob}),result=await SGyTfX[_0x385f43(0x12c)](_verifyDelegation,{'delegation':carolZcap,'expectedRootCapability':capabilities[_0x385f43(0x36d)][_0x385f43(0x2cb)]['id'],'purposeOptions':{'maxDelegationTtl':ttl}});expect(result)['to'][_0x385f43(0x34d)],SGyTfX[_0x385f43(0x331)](expect,result[_0x385f43(0x1dd)])['to']['be']['false'],SGyTfX[_0x385f43(0x119)](expect,result[_0x385f43(0x13d)]['errors'][0x0])['to'][_0x385f43(0x34d)],result[_0x385f43(0x13d)]['errors'][0x0][_0x385f43(0x418)][_0x385f43(0x278)][_0x385f43(0x225)](SGyTfX[_0x385f43(0x1aa)]);}),it(SGyTfX[_0xf09f22(0x369)],async()=>{const _0xdc4b21=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities[_0xdc4b21(0x36d)][_0xdc4b21(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await vfbElx[_0xdc4b21(0x16e)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),doc=clone(mock[_0xdc4b21(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':vfbElx['zJHbV']}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':capabilities['root'][_0xdc4b21(0x2cb)],'expectedAction':_0xdc4b21(0x1c5)});expect(result)['to'][_0xdc4b21(0x34d)],expect(result['verified'])['to']['be'][_0xdc4b21(0x3f6)];}),SGyTfX[_0xf09f22(0x3d7)](it,SGyTfX[_0xf09f22(0x428)],async()=>{const _0xd5f720=_0xf09f22,ShoYzs={'vxlEU':vfbElx[_0xd5f720(0x21e)],'GyqNk':function(callee,param1){return vfbElx['vaWEh'](callee,param1);},'lkJYJ':function(callee,param1){const _0x37393d=_0xd5f720;return vfbElx[_0x37393d(0x38b)](callee,param1);}};if(vfbElx[_0xd5f720(0x2af)](_0xd5f720(0x198),'HLBYS')){const bobZcap=await vfbElx[_0xd5f720(0x2ad)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':vfbElx['gLCBa'](uuid),'parentCapability':capabilities[_0xd5f720(0x36d)]['beta']['id'],'invocationTarget':capabilities[_0xd5f720(0x36d)][_0xd5f720(0x2cb)]['invocationTarget'],'expires':EXPIRES_3000_DATE,'controller':['urn:other',bob['id']()]},'parentCapability':capabilities[_0xd5f720(0x36d)]['beta'],'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),doc=vfbElx[_0xd5f720(0x1dc)](clone,mock[_0xd5f720(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0xd5f720(0x1c5)}),result=await vfbElx[_0xd5f720(0x3da)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0xd5f720(0x36d)][_0xd5f720(0x2cb)],'expectedAction':vfbElx[_0xd5f720(0x1b4)]});vfbElx[_0xd5f720(0x2bb)](expect,result)['to'][_0xd5f720(0x34d)],vfbElx[_0xd5f720(0x23f)](expect,result[_0xd5f720(0x1dd)])['to']['be'][_0xd5f720(0x3f6)];}else return _0x5f0041++,_0x41d0ff[_0xd5f720(0x278)]['be']['an'](ShoYzs['vxlEU']),_0x542d25[_0xd5f720(0x278)][_0xd5f720(0x26d)][_0xd5f720(0x148)](0x4),_0x595e00[_0xd5f720(0x278)]['be']['an']('array'),_0x2ffcaf[_0xd5f720(0x278)]['have'][_0xd5f720(0x148)](0x4),ShoYzs[_0xd5f720(0x387)](_0x395402,{'capabilityChain':_0x37b2e2}),ShoYzs[_0xd5f720(0x41c)](_0x4dcf18,{'capabilityChainMeta':_0x231afe}),{'valid':!![]};}),it(SGyTfX[_0xf09f22(0x3a1)],async()=>{const _0x34e20f=_0xf09f22,bobZcap=await _delegate({'parentCapability':capabilities[_0x34e20f(0x36d)][_0x34e20f(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await SGyTfX[_0x34e20f(0x2c8)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),doc=SGyTfX[_0x34e20f(0x1c8)](clone,mock[_0x34e20f(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX[_0x34e20f(0x43c)]});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x249f92=_0x34e20f,cgPWeF=_0x249f92(0x2ec)[_0x249f92(0x2d9)]('|');let owWGpf=0x0;while(!![]){switch(cgPWeF[owWGpf++]){case'0':capabilityChain[_0x249f92(0x278)][_0x249f92(0x26d)][_0x249f92(0x148)](0x3);continue;case'1':checkedChain++;continue;case'2':vfbElx[_0x249f92(0x386)](_checkCapabilityChain,{'capabilityChain':capabilityChain});continue;case'3':return{'valid':!![]};case'4':vfbElx['ZiUji'](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta});continue;case'5':capabilityChain['should']['be']['an'](vfbElx[_0x249f92(0x21e)]);continue;}break;}},result=await SGyTfX[_0x34e20f(0x3ce)](_verifyInvocation,{'invocation':invocation,'rootCapability':capabilities[_0x34e20f(0x36d)][_0x34e20f(0x2cb)],'expectedAction':SGyTfX[_0x34e20f(0x43c)],'inspectCapabilityChain':inspectCapabilityChain});expect(result)['to'][_0x34e20f(0x34d)],SGyTfX[_0x34e20f(0x43d)](expect,result['verified'])['to']['be']['true'],checkedChain[_0x34e20f(0x278)][_0x34e20f(0x357)](0x1);}),SGyTfX[_0xf09f22(0x3de)](it,_0xf09f22(0x41a)+SGyTfX[_0xf09f22(0x19a)],async()=>{const _0x46fc30=_0xf09f22,JRkwdj={'TbhCl':_0x46fc30(0x1bc)},ttl=SGyTfX[_0x46fc30(0x264)](0x3e8,0x3c)*0x3c*0x18,bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':capabilities[_0x46fc30(0x36d)][_0x46fc30(0x2cb)]['id'],'invocationTarget':capabilities[_0x46fc30(0x36d)][_0x46fc30(0x2cb)][_0x46fc30(0x412)],'expires':new Date(Date[_0x46fc30(0x22d)]()+ttl/0x2)[_0x46fc30(0x317)]()},'parentCapability':capabilities[_0x46fc30(0x36d)][_0x46fc30(0x2cb)],'delegator':alice}),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x46fc30(0x29c)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x46fc30(0x412)],'expires':bobZcap[_0x46fc30(0x427)]},'parentCapability':bobZcap,'delegator':bob}),doc=SGyTfX[_0x46fc30(0x20e)](clone,mock['exampleDoc']),invocation=await SGyTfX[_0x46fc30(0x3f1)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX[_0x46fc30(0x43c)]});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x5ec542=_0x46fc30,kAcQFj='0|3|1|4|5|2'[_0x5ec542(0x2d9)]('|');let IwhcHl=0x0;while(!![]){switch(kAcQFj[IwhcHl++]){case'0':checkedChain++;continue;case'1':capabilityChain[_0x5ec542(0x278)][_0x5ec542(0x26d)]['length'](0x3);continue;case'2':return{'valid':!![]};case'3':capabilityChain['should']['be']['an'](JRkwdj[_0x5ec542(0x25e)]);continue;case'4':_checkCapabilityChain({'capabilityChain':capabilityChain});continue;case'5':_checkCapabilityChainMeta({'capabilityChainMeta':capabilityChainMeta});continue;}break;}},result=await SGyTfX[_0x46fc30(0x211)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':SGyTfX[_0x46fc30(0x43c)],'expectedRootCapability':capabilities[_0x46fc30(0x36d)][_0x46fc30(0x2cb)]['id'],'expectedTarget':capabilities[_0x46fc30(0x36d)]['beta']['invocationTarget'],'inspectCapabilityChain':inspectCapabilityChain,'maxDelegationTtl':ttl}});SGyTfX[_0x46fc30(0x3a3)](expect,result)['to']['exist'],expect(result[_0x46fc30(0x1dd)])['to']['be'][_0x46fc30(0x3f6)],checkedChain['should'][_0x46fc30(0x357)](0x1);}),SGyTfX[_0xf09f22(0x27d)](it,SGyTfX[_0xf09f22(0x15e)]+_0xf09f22(0x156),async()=>{const _0x5ba8bf=_0xf09f22;if(vfbElx['GymXL'](_0x5ba8bf(0x37d),vfbElx[_0x5ba8bf(0x2d4)]))return _0x25b538++,_0x44563d[_0x5ba8bf(0x278)]['be']['an'](vfbElx[_0x5ba8bf(0x21e)]),_0x186fbe[_0x5ba8bf(0x278)][_0x5ba8bf(0x26d)][_0x5ba8bf(0x148)](0x4),_0x43f3ec[_0x5ba8bf(0x278)]['be']['an'](vfbElx[_0x5ba8bf(0x21e)]),_0x18cf31[_0x5ba8bf(0x278)][_0x5ba8bf(0x26d)][_0x5ba8bf(0x148)](0x4),vfbElx[_0x5ba8bf(0x160)](_0x5dcc9b,{'capabilityChain':_0x17a9e8}),vfbElx[_0x5ba8bf(0x29d)](_0x1c1a93,{'capabilityChainMeta':_0x5ce607}),{'valid':!![]};else{const bobZcap=await vfbElx[_0x5ba8bf(0x195)](_delegate,{'parentCapability':capabilities[_0x5ba8bf(0x36d)][_0x5ba8bf(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),doc=clone(mock[_0x5ba8bf(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':vfbElx['zJHbV']});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x24cba0=_0x5ba8bf,IfAQHo=_0x24cba0(0x15f)[_0x24cba0(0x2d9)]('|');let mfaDpu=0x0;while(!![]){switch(IfAQHo[mfaDpu++]){case'0':capabilityChain[_0x24cba0(0x278)]['be']['an'](vfbElx[_0x24cba0(0x21e)]);continue;case'1':vfbElx[_0x24cba0(0x1b3)](_checkCapabilityChain,{'capabilityChain':capabilityChain});continue;case'2':should[_0x24cba0(0x34d)](capabilityChain);continue;case'3':capabilityChain[_0x24cba0(0x278)][_0x24cba0(0x26d)][_0x24cba0(0x148)](0x3);continue;case'4':checkedChain++;continue;case'5':vfbElx[_0x24cba0(0x3a8)](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta});continue;case'6':return{'error':new Error(_0x24cba0(0x2d5)+capabilityChain[0x0]['id']+_0x24cba0(0x16a)),'valid':![]};}break;}},result=await _verifyInvocation({'invocation':invocation,'rootCapability':capabilities['root']['beta'],'expectedAction':_0x5ba8bf(0x1c5),'inspectCapabilityChain':inspectCapabilityChain});vfbElx[_0x5ba8bf(0x279)](expect,result)['to']['exist'],expect(result['verified'])['to']['be']['false'],expect(result['error'][_0x5ba8bf(0x221)][0x0])['to'][_0x5ba8bf(0x34d)],result[_0x5ba8bf(0x13d)]['errors'][0x0]['message'][_0x5ba8bf(0x278)][_0x5ba8bf(0x225)]('has\x20been\x20revoked'),checkedChain[_0x5ba8bf(0x278)][_0x5ba8bf(0x357)](0x1);}});}),nYRzSt[_0x527338(0x37a)](describe,_0x527338(0x172),()=>{const _0x4f26b8=_0x527338,oiGLkA={'tmZTY':SGyTfX[_0x4f26b8(0x329)],'nNwIn':_0x4f26b8(0x23a),'xrbCu':_0x4f26b8(0x173),'XyKFI':SGyTfX[_0x4f26b8(0x1b5)],'voJey':SGyTfX['XoTAm'],'HVQwr':SGyTfX[_0x4f26b8(0x226)],'hdqlb':function(callee){return callee();},'YDCyI':function(callee,param1){return SGyTfX['IxzTe'](callee,param1);},'CgQOR':function(callee,param1){const _0xf64c3f=_0x4f26b8;return SGyTfX[_0xf64c3f(0x285)](callee,param1);},'elaVd':SGyTfX[_0x4f26b8(0x43c)],'HwUhx':function(callee,param1){return callee(param1);},'SLsWo':_0x4f26b8(0x18b),'kzbGH':function(callee,param1){return callee(param1);},'xixpx':function(callee,param1){return SGyTfX['OluBb'](callee,param1);},'aWFQr':_0x4f26b8(0x342),'ADVaz':_0x4f26b8(0x2a1),'lJClq':'array','eHhuU':function(x,y){return x+y;},'RYzAu':function(callee){return SGyTfX['TEMQs'](callee);},'ZhQRm':_0x4f26b8(0x442),'vImkM':SGyTfX[_0x4f26b8(0x324)],'ryOmN':_0x4f26b8(0x1ae),'NjXcD':'urn:zcap:ef98a880-6b36-11ec-940f-10bf48838a41','fXNVs':function(callee,param1){const _0x4bbe88=_0x4f26b8;return SGyTfX[_0x4bbe88(0x21c)](callee,param1);},'EskOX':function(x,y){return x*y;},'Uclfk':SGyTfX['ASkmU'],'MLFAQ':function(x,y){return x===y;},'zXxEp':SGyTfX[_0x4f26b8(0x3dd)],'ExAIw':function(callee,param1){return callee(param1);},'ihDzF':function(callee,param1){const _0x1d2e81=_0x4f26b8;return SGyTfX[_0x1d2e81(0x2c8)](callee,param1);},'ZelzV':function(callee,param1){const _0xeb0521=_0x4f26b8;return SGyTfX[_0xeb0521(0x218)](callee,param1);},'bqkbK':function(callee,param1){return callee(param1);},'coXYN':SGyTfX['KQuoP'],'iKmiV':function(callee,param1){return callee(param1);},'XkqPj':function(callee){const _0x296da2=_0x4f26b8;return SGyTfX[_0x296da2(0x41f)](callee);},'IXfcF':function(callee,param1){return callee(param1);},'biGWp':function(callee,param1){return SGyTfX['ZwJtC'](callee,param1);},'OLoFU':'capability\x20in\x20the\x20delegation\x20chain\x20has\x20expired','xQNqA':SGyTfX[_0x4f26b8(0x267)],'SKWrv':function(callee,param1){const _0x57d328=_0x4f26b8;return SGyTfX[_0x57d328(0x272)](callee,param1);},'IaQig':_0x4f26b8(0x35b),'hxJVX':SGyTfX[_0x4f26b8(0x334)]};SGyTfX[_0x4f26b8(0x1ee)](SGyTfX[_0x4f26b8(0x11e)],SGyTfX['NpndC'])?_0x5532d2={'@context':_0x53672b,'id':SGyTfX[_0x4f26b8(0x2a0)](_0x5556f7),'controller':typeof _0x4e7d95===_0x4f26b8(0x14a)?_0x3c1ca0:_0x652c70['id'](),'parentCapability':_0x120c72['id'],'invocationTarget':_0x3e747c[_0x4f26b8(0x412)],'expires':_0x4b4b77}:(it(SGyTfX['qLnIq'],async()=>{const _0x582f10=_0x4f26b8,dbHolS={'vllAk':oiGLkA[_0x582f10(0x2e6)]};if(oiGLkA[_0x582f10(0x30c)]!==_0x582f10(0x23a))_0x4bdc8e=_0x6484bb;else{let result,err;try{if(oiGLkA[_0x582f10(0x2f9)]===_0x582f10(0x173))result=new CapabilityInvocation({'expectedTarget':_0x582f10(0x20b),'suite':new Ed25519Signature2020(),'date':_0x582f10(0x147)});else{const fTnFxU=dbHolS[_0x582f10(0x40c)]['split']('|');let PGLCmI=0x0;while(!![]){switch(fTnFxU[PGLCmI++]){case'0':_0x55e085({'capabilityChainMeta':_0x3601f8});continue;case'1':return{'valid':!![]};case'2':_0x5c5c8b++;continue;case'3':_0x4d1c16['should'][_0x582f10(0x26d)][_0x582f10(0x148)](0x4);continue;case'4':_0x3f6636['should']['have']['length'](0x4);continue;case'5':_0x4dc395[_0x582f10(0x278)]['be']['an'](_0x582f10(0x1bc));continue;case'6':_0x336a82['should']['be']['an']('array');continue;case'7':_0x1f6d06({'capabilityChain':_0x20e825});continue;}break;}}}catch(e){err=e;}should[_0x582f10(0x34d)](err),should[_0x582f10(0x382)][_0x582f10(0x34d)](result),err[_0x582f10(0x278)]['be'][_0x582f10(0x3b0)](TypeError),err['message'][_0x582f10(0x278)][_0x582f10(0x225)](oiGLkA[_0x582f10(0x3b3)]);}}),it(SGyTfX[_0x4f26b8(0x24b)],async()=>{const _0x4810f3=_0x4f26b8;if('kQZHP'!==oiGLkA[_0x4810f3(0x312)]){let result,err;try{result=new CapabilityDelegation({'expectedRootCapability':_0x4810f3(0x3b7),'date':oiGLkA[_0x4810f3(0x244)]});}catch(e){err=e;}should[_0x4810f3(0x34d)](err),should['not'][_0x4810f3(0x34d)](result),err['should']['be'][_0x4810f3(0x3b0)](TypeError),err[_0x4810f3(0x418)]['should']['contain'](oiGLkA[_0x4810f3(0x3b3)]);}else _0x555355=_0x1b050c;}),SGyTfX['QKcBn'](it,SGyTfX[_0x4f26b8(0x17b)],async()=>{const _0x4d20ff=_0x4f26b8,rootCapability={...capabilities[_0x4d20ff(0x36d)][_0x4d20ff(0x2cb)]};rootCapability['id']=SGyTfX['CwlPU'],rootCapability[_0x4d20ff(0x427)]=new Date()['toISOString'](),SGyTfX[_0x4d20ff(0x14e)](addToLoader,{'doc':rootCapability});const doc=SGyTfX[_0x4d20ff(0x356)](clone,mock[_0x4d20ff(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':alice,'capability':rootCapability,'capabilityAction':_0x4d20ff(0x1c5)}),result=await SGyTfX['BZKgK'](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x4d20ff(0x1c5)});SGyTfX[_0x4d20ff(0x242)](expect,result)['to'][_0x4d20ff(0x34d)],SGyTfX[_0x4d20ff(0x178)](expect,result[_0x4d20ff(0x1dd)])['to']['be'][_0x4d20ff(0x224)],should[_0x4d20ff(0x34d)](result[_0x4d20ff(0x13d)]),result[_0x4d20ff(0x13d)][_0x4d20ff(0x2ce)]['should'][_0x4d20ff(0x357)](SGyTfX[_0x4d20ff(0x2cd)]);const [error]=result['error']['errors'];error['message']['should']['contain'](_0x4d20ff(0x12b));}),it(_0x4f26b8(0x3af),async()=>{const _0x19f82a=_0x4f26b8,rootCapability={...capabilities['root'][_0x19f82a(0x2cb)]};rootCapability['id']=_0x19f82a(0x175),addToLoader({'doc':rootCapability});let expires=new Date();expires[_0x19f82a(0x33a)](expires[_0x19f82a(0x3e5)]()+0x1),expires=expires[_0x19f82a(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x19f82a(0x2b9)](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability['invocationTarget'],'expires':expires},'parentCapability':rootCapability,'delegator':alice}),carolZcap=await oiGLkA[_0x19f82a(0x344)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x19f82a(0x2b9)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x19f82a(0x412)],'expires':expires},'parentCapability':bobZcap,'delegator':bob}),doc=oiGLkA[_0x19f82a(0x2e3)](clone,mock[_0x19f82a(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':oiGLkA[_0x19f82a(0x392)]}),result=await oiGLkA[_0x19f82a(0x344)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x19f82a(0x1c5)});expect(result)['to']['exist'],oiGLkA[_0x19f82a(0x1c3)](expect,result['verified'])['to']['be'][_0x19f82a(0x3f6)];}),SGyTfX[_0x4f26b8(0x421)](it,'should\x20fail\x20to\x20delegate\x20a\x20capability\x20with\x20bad\x20`expires`\x20field',async()=>{const _0x572b5e=_0x4f26b8,rootCapability={...capabilities[_0x572b5e(0x36d)][_0x572b5e(0x2cb)]};rootCapability['id']=SGyTfX[_0x572b5e(0x2b0)],SGyTfX[_0x572b5e(0x3c2)](addToLoader,{'doc':rootCapability});let bobZcap,localError;try{bobZcap=await SGyTfX[_0x572b5e(0x2d8)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['JQgPu'](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x572b5e(0x412)],'expires':SGyTfX[_0x572b5e(0x216)]},'parentCapability':rootCapability,'delegator':alice});}catch(e){localError=e;}expect(bobZcap)['to']['not'][_0x572b5e(0x34d)],SGyTfX[_0x572b5e(0x1fc)](expect,localError)['to'][_0x572b5e(0x34d)],localError[_0x572b5e(0x418)]['should'][_0x572b5e(0x225)](_0x572b5e(0x136));}),it(SGyTfX[_0x4f26b8(0x18f)],async()=>{const _0x53f979=_0x4f26b8;if(_0x53f979(0x1cc)!=='ToWcW')_0x4ca8c4=_0x525b61;else{const rootCapability={...capabilities[_0x53f979(0x36d)][_0x53f979(0x2cb)]};rootCapability['id']=SGyTfX[_0x53f979(0x420)],addToLoader({'doc':rootCapability});const bobZcap=await SGyTfX[_0x53f979(0x2e8)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x53f979(0x412)],'expires':SGyTfX[_0x53f979(0x216)]},'purposeOptions':{'parentCapability':rootCapability,'_skipLocalValidationForTesting':!![]},'delegator':alice}),doc=SGyTfX['maxFp'](clone,mock[_0x53f979(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':bob,'capability':bobZcap,'capabilityAction':SGyTfX[_0x53f979(0x43c)]}),result=await SGyTfX[_0x53f979(0x349)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x53f979(0x1c5)});expect(result)['to'][_0x53f979(0x34d)],expect(result[_0x53f979(0x1dd)])['to']['be'][_0x53f979(0x224)],should['exist'](result[_0x53f979(0x13d)]),result[_0x53f979(0x13d)][_0x53f979(0x2ce)][_0x53f979(0x278)]['equal'](_0x53f979(0x342));const [error]=result[_0x53f979(0x13d)][_0x53f979(0x221)];error['message'][_0x53f979(0x278)][_0x53f979(0x357)](SGyTfX[_0x53f979(0x235)]);}}),it('should\x20verify\x20invoking\x20a\x20capability\x20with\x20`expires`\x20'+SGyTfX[_0x4f26b8(0x2a4)],async()=>{const _0x95e7ed=_0x4f26b8,rootCapability={...capabilities[_0x95e7ed(0x36d)][_0x95e7ed(0x2cb)]};rootCapability['id']=_0x95e7ed(0x184),addToLoader({'doc':rootCapability});const date=new Date();date[_0x95e7ed(0x33a)](SGyTfX[_0x95e7ed(0x15b)](date[_0x95e7ed(0x3e5)](),0x14));let expires=new Date();expires[_0x95e7ed(0x33a)](expires[_0x95e7ed(0x3e5)]()-0xa),expires=expires[_0x95e7ed(0x317)]();const bobZcap=await SGyTfX['cfjSV'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x95e7ed(0x2fa)](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x95e7ed(0x412)],'expires':expires},'date':date,'parentCapability':rootCapability,'delegator':alice}),carolZcap=await SGyTfX[_0x95e7ed(0x28d)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x95e7ed(0x28b)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'date':date,'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x95e7ed(0x2f8)]),invocation=await SGyTfX['boiHP'](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x95e7ed(0x1c5)}),result=await SGyTfX['NxRyz'](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':'read','expectedRootCapability':rootCapability['id'],'expectedTarget':rootCapability[_0x95e7ed(0x412)],'date':date}});expect(result)['to'][_0x95e7ed(0x34d)],SGyTfX[_0x95e7ed(0x39e)](expect,result[_0x95e7ed(0x1dd)])['to']['be'][_0x95e7ed(0x3f6)];}),SGyTfX[_0x4f26b8(0x40a)](it,SGyTfX['yzOdN'](_0x4f26b8(0x1f6),_0x4f26b8(0x247)),async()=>{const _0x548679=_0x4f26b8;if(SGyTfX[_0x548679(0x1ee)]('rtANB',_0x548679(0x16f)))_0x336bab=new _0x19bb30({'parentCapability':_0x39b2a2,'_capabilityChain':_0x37fd43,..._0x18b5fb});else{const rootCapability={...capabilities[_0x548679(0x36d)]['beta']};rootCapability['id']=SGyTfX[_0x548679(0x1bb)],addToLoader({'doc':rootCapability});let expires=new Date();expires['setHours'](SGyTfX[_0x548679(0x3db)](expires[_0x548679(0x3e5)](),0x32)),expires=expires[_0x548679(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x548679(0x43f)](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x548679(0x412)],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':rootCapability,'delegator':alice}),carolZcap=await SGyTfX[_0x548679(0x1b0)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['bHevd'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x548679(0x412)],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),doc=SGyTfX['Ppsjj'](clone,mock[_0x548679(0x2f8)]),invocation=await SGyTfX[_0x548679(0x128)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX[_0x548679(0x43c)]}),date=new Date();date[_0x548679(0x33a)](SGyTfX[_0x548679(0x3db)](date[_0x548679(0x3e5)](),0x14));const result=await _verifyInvocation({'invocation':invocation,'purposeOptions':{'expectedAction':SGyTfX[_0x548679(0x43c)],'expectedRootCapability':rootCapability['id'],'expectedTarget':rootCapability[_0x548679(0x412)],'date':date}});SGyTfX['oYdSZ'](expect,result)['to'][_0x548679(0x34d)],SGyTfX['kvmVy'](expect,result[_0x548679(0x1dd)])['to']['be']['false'],should[_0x548679(0x34d)](result['error']),result[_0x548679(0x13d)][_0x548679(0x2ce)]['should'][_0x548679(0x357)](SGyTfX[_0x548679(0x2cd)]);const [error]=result[_0x548679(0x13d)]['errors'];error[_0x548679(0x418)][_0x548679(0x278)]['equal'](_0x548679(0x2a1));}}),SGyTfX[_0x4f26b8(0x1e3)](it,_0x4f26b8(0x1f6)+SGyTfX[_0x4f26b8(0x28a)],async()=>{const _0x8b6edd=_0x4f26b8,rootCapability={...capabilities[_0x8b6edd(0x36d)][_0x8b6edd(0x2cb)]};rootCapability['id']=oiGLkA[_0x8b6edd(0x286)],addToLoader({'doc':rootCapability});let expires=new Date();expires['setHours'](expires[_0x8b6edd(0x3e5)]()+0x32),expires=expires[_0x8b6edd(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x8b6edd(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice}),carolZcap=await oiGLkA['kzbGH'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x8b6edd(0x412)],'expires':expires},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x8b6edd(0x2f8)]),invocation=await oiGLkA[_0x8b6edd(0x3ab)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':oiGLkA[_0x8b6edd(0x392)]}),date=new Date();date['setHours'](date[_0x8b6edd(0x3e5)]()+0x64);const result=await oiGLkA[_0x8b6edd(0x2e3)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'expectedAction':oiGLkA[_0x8b6edd(0x392)],'expectedRootCapability':rootCapability['id'],'expectedTarget':rootCapability[_0x8b6edd(0x412)],'suite':new Ed25519Signature2020(),'date':date}});expect(result)['to'][_0x8b6edd(0x34d)],oiGLkA[_0x8b6edd(0x344)](expect,result['verified'])['to']['be'][_0x8b6edd(0x224)],should['exist'](result[_0x8b6edd(0x13d)]),result[_0x8b6edd(0x13d)][_0x8b6edd(0x2ce)]['should'][_0x8b6edd(0x357)](oiGLkA[_0x8b6edd(0x270)]);const [error]=result[_0x8b6edd(0x13d)][_0x8b6edd(0x221)];error[_0x8b6edd(0x418)]['should'][_0x8b6edd(0x357)](oiGLkA[_0x8b6edd(0x429)]);}),it('should\x20fail\x20invoking\x20a\x20capability\x20with\x20missing\x20`expires`\x20in\x20'+_0x4f26b8(0x123),async()=>{const _0x475061=_0x4f26b8,jGWaaU={'MfyZP':_0x475061(0x316),'cSBLa':oiGLkA[_0x475061(0x12e)]};if('pCxnf'===_0x475061(0x42c)){const agURfO=jGWaaU[_0x475061(0x19e)]['split']('|');let hxawuq=0x0;while(!![]){switch(agURfO[hxawuq++]){case'0':_0x2a95d6['should'][_0x475061(0x26d)][_0x475061(0x148)](0x3);continue;case'1':_0x559318({'capabilityChainMeta':_0x1f0c1a});continue;case'2':return{'valid':!![]};case'3':_0x304b45({'capabilityChain':_0x1f9b27});continue;case'4':_0x12437b[_0x475061(0x278)]['be']['an'](jGWaaU[_0x475061(0x1ec)]);continue;case'5':_0x23bea4++;continue;}break;}}else{const rootCapability={...capabilities[_0x475061(0x36d)][_0x475061(0x2cb)]};rootCapability['id']=_0x475061(0x3ed),addToLoader({'doc':rootCapability});let expires=new Date();expires[_0x475061(0x33a)](oiGLkA[_0x475061(0x1df)](expires[_0x475061(0x3e5)](),0x1)),expires=expires[_0x475061(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x475061(0x215)](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x475061(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice});let carolZcap,localError;try{carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x475061(0x412)]},'parentCapability':bobZcap,'delegator':bob});}catch(e){localError=e;}expect(localError)['to']['exist'],localError[_0x475061(0x2ce)]['should'][_0x475061(0x357)](_0x475061(0x231)),localError[_0x475061(0x418)]['should']['contain'](oiGLkA[_0x475061(0x423)]),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x475061(0x412)]},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const doc=clone(mock[_0x475061(0x2f8)]),invocation=await oiGLkA['YDCyI'](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x475061(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':'read'});expect(result)['to']['exist'],expect(result[_0x475061(0x1dd)])['to']['be'][_0x475061(0x224)],should[_0x475061(0x34d)](result[_0x475061(0x13d)]),result[_0x475061(0x13d)][_0x475061(0x2ce)]['should'][_0x475061(0x357)](oiGLkA[_0x475061(0x270)]);const [error]=result[_0x475061(0x13d)]['errors'];error[_0x475061(0x418)][_0x475061(0x278)]['include'](oiGLkA[_0x475061(0x423)]);}}),it(_0x4f26b8(0x300)+SGyTfX[_0x4f26b8(0x19b)],async()=>{const _0x9ada8f=_0x4f26b8,rootCapability={...capabilities[_0x9ada8f(0x36d)][_0x9ada8f(0x2cb)]};rootCapability['id']=_0x9ada8f(0x443),SGyTfX[_0x9ada8f(0x218)](addToLoader,{'doc':rootCapability});const date=new Date();let expires=new Date();expires['setHours'](expires[_0x9ada8f(0x3e5)]()+0x1),expires=expires[_0x9ada8f(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x9ada8f(0x412)],'expires':expires},'date':date,'parentCapability':rootCapability,'delegator':alice}),carolZcap=await SGyTfX[_0x9ada8f(0x27e)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'date':date,'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});{if(SGyTfX[_0x9ada8f(0x30e)](SGyTfX[_0x9ada8f(0x385)],'marKU')){let _0x5c3613;return _0x75eb9?_0x5c3613=new _0x10f4a7({'expectedTarget':_0x4870df['invocationTarget'],'expectedRootCapability':_0x4f32e9['id'],'expectedAction':_0x3dc678,'inspectCapabilityChain':_0x158b32,'suite':new _0x5cbe50(),..._0x1e7fdf}):_0x5c3613=new _0x3ef4d6({'suite':new _0x277986(),..._0x5babf3}),_0x1b00d6[_0x9ada8f(0x2d6)](_0x8aec9c,{'documentLoader':_0x1f6206,'suite':new _0x123373(),'purpose':_0x5c3613});}else{const beforeDelegation=new Date(SGyTfX['YmxaP'](date[_0x9ada8f(0x248)](),0x3e8)),doc=SGyTfX[_0x9ada8f(0x40f)](clone,mock[_0x9ada8f(0x2f8)]),invocation=await SGyTfX[_0x9ada8f(0x408)](_invoke,{'doc':doc,'date':beforeDelegation,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x9ada8f(0x1c5)}),result=await SGyTfX[_0x9ada8f(0x35c)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x9ada8f(0x1c5)});expect(result)['to'][_0x9ada8f(0x34d)],SGyTfX['wQOUT'](expect,result[_0x9ada8f(0x1dd)])['to']['be'][_0x9ada8f(0x3f6)];}}const beforeDelegation=new Date(date['getTime']()-0x12d*0x3e8),doc=SGyTfX['IMIdB'](clone,mock['exampleDoc']),invocation=await SGyTfX[_0x9ada8f(0x36e)](_invoke,{'doc':doc,'date':beforeDelegation,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX['JlBjW']}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x9ada8f(0x1c5)});SGyTfX[_0x9ada8f(0x2c2)](expect,result)['to'][_0x9ada8f(0x34d)],SGyTfX[_0x9ada8f(0x3e7)](expect,result[_0x9ada8f(0x1dd)])['to']['be'][_0x9ada8f(0x224)],should[_0x9ada8f(0x34d)](result[_0x9ada8f(0x13d)]),result[_0x9ada8f(0x13d)][_0x9ada8f(0x2ce)][_0x9ada8f(0x278)][_0x9ada8f(0x357)](_0x9ada8f(0x342));const [error]=result[_0x9ada8f(0x13d)][_0x9ada8f(0x221)];error[_0x9ada8f(0x418)][_0x9ada8f(0x278)]['equal'](_0x9ada8f(0x2e0)+SGyTfX[_0x9ada8f(0x192)]);}),SGyTfX['RWgOK'](it,SGyTfX['ajWcV'],async()=>{const _0x2addf9=_0x4f26b8;if(oiGLkA['vImkM']!==oiGLkA[_0x2addf9(0x394)]){const rootCapability={...capabilities[_0x2addf9(0x36d)][_0x2addf9(0x2cb)]};rootCapability['id']=oiGLkA['NjXcD'],addToLoader({'doc':rootCapability});let expires=new Date();expires[_0x2addf9(0x33a)](expires[_0x2addf9(0x3e5)]()+0x1),expires=expires[_0x2addf9(0x317)]();const bobZcap=await oiGLkA[_0x2addf9(0x441)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x2addf9(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice}),afterExpired=new Date(Date['parse'](expires)+oiGLkA[_0x2addf9(0x261)](0x12d,0x3e8));let carolZcap,localError;try{oiGLkA[_0x2addf9(0x3e1)]!==_0x2addf9(0x354)?_0x40f843=new _0x4855a2(_0x5b2833):carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x2addf9(0x2b9)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x2addf9(0x412)],'expires':expires},'date':afterExpired,'parentCapability':bobZcap,'delegator':bob});}catch(e){oiGLkA[_0x2addf9(0x130)](_0x2addf9(0x14d),_0x2addf9(0x14d))?localError=e:_0x2d9505=_0xc9c89a;}oiGLkA[_0x2addf9(0x441)](expect,localError)['to'][_0x2addf9(0x34d)],localError['name'][_0x2addf9(0x278)][_0x2addf9(0x357)](oiGLkA[_0x2addf9(0x3a5)]),localError[_0x2addf9(0x418)]['should'][_0x2addf9(0x225)](_0x2addf9(0x2c6)),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'date':afterExpired,'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const doc=clone(mock['exampleDoc']),invocation=await _invoke({'doc':doc,'date':afterExpired,'invoker':carol,'capability':carolZcap,'capabilityAction':oiGLkA[_0x2addf9(0x392)]}),result=await oiGLkA[_0x2addf9(0x141)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x2addf9(0x1c5),'purposeOptions':{'date':afterExpired}});oiGLkA['ihDzF'](expect,result)['to']['exist'],oiGLkA['kzbGH'](expect,result[_0x2addf9(0x1dd)])['to']['be'][_0x2addf9(0x224)],should['exist'](result[_0x2addf9(0x13d)]),result[_0x2addf9(0x13d)]['name']['should']['equal'](oiGLkA[_0x2addf9(0x270)]);const [error]=result['error'][_0x2addf9(0x221)];error['message'][_0x2addf9(0x278)][_0x2addf9(0x357)](_0x2addf9(0x2a1));}else _0x141d7e=_0x4e8c32[_0x2addf9(0x253)](_0x2addf9(0x168),0x0);}),it(SGyTfX[_0x4f26b8(0x3bb)](SGyTfX[_0x4f26b8(0x3bc)],_0x4f26b8(0x250)),async()=>{const _0x15545a=_0x4f26b8,rootCapability={...capabilities[_0x15545a(0x36d)]['beta']};rootCapability['id']=_0x15545a(0x1d9),oiGLkA[_0x15545a(0x141)](addToLoader,{'doc':rootCapability});let expires=new Date(0x0);expires=expires['toISOString']();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x15545a(0x412)],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':rootCapability,'delegator':alice}),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x15545a(0x215)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x15545a(0x412)],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),doc=oiGLkA[_0x15545a(0x11f)](clone,mock[_0x15545a(0x2f8)]),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':'read'}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':oiGLkA[_0x15545a(0x392)]});oiGLkA[_0x15545a(0x431)](expect,result)['to'][_0x15545a(0x34d)],expect(result[_0x15545a(0x1dd)])['to']['be'][_0x15545a(0x224)],should[_0x15545a(0x34d)](result[_0x15545a(0x13d)]),result['error'][_0x15545a(0x221)]['should'][_0x15545a(0x26d)][_0x15545a(0x148)](0x1);const [error]=result[_0x15545a(0x13d)]['errors'];error[_0x15545a(0x418)][_0x15545a(0x278)][_0x15545a(0x357)](oiGLkA['ADVaz']);}),SGyTfX[_0x4f26b8(0x3cc)](it,SGyTfX[_0x4f26b8(0x256)](SGyTfX['AMIdy'],SGyTfX[_0x4f26b8(0x1a2)]),async()=>{const _0x546d58=_0x4f26b8,rootCapability={...capabilities['root']['beta']};rootCapability['id']=SGyTfX[_0x546d58(0x2c7)],addToLoader({'doc':rootCapability});let expires=new Date();expires['setHours'](SGyTfX[_0x546d58(0x237)](expires[_0x546d58(0x3e5)](),0xa)),expires=expires[_0x546d58(0x317)]();const bobZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x546d58(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice});expires=new Date(),expires[_0x546d58(0x33a)](SGyTfX['lECUa'](expires['getHours'](),0xa)),expires=expires[_0x546d58(0x317)]();const carolZcap=await SGyTfX['oYdSZ'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),doc=SGyTfX[_0x546d58(0x1fc)](clone,mock[_0x546d58(0x2f8)]),invocation=await SGyTfX[_0x546d58(0x20e)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX['JlBjW']}),result=await SGyTfX[_0x546d58(0x36e)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x546d58(0x1c5)});SGyTfX['aSMzQ'](expect,result)['to'][_0x546d58(0x34d)],expect(result[_0x546d58(0x1dd)])['to']['be'][_0x546d58(0x224)],should[_0x546d58(0x34d)](result['error']),result['error'][_0x546d58(0x2ce)]['should'][_0x546d58(0x357)](_0x546d58(0x342));const [error]=result[_0x546d58(0x13d)][_0x546d58(0x221)];error[_0x546d58(0x418)]['should'][_0x546d58(0x357)](_0x546d58(0x2a1));}),it(SGyTfX[_0x4f26b8(0x3c1)]('should\x20fail\x20invoking\x20a\x20capability\x20with\x20second\x20delegated\x20','capability\x20that\x20expires\x20on\x20the\x20Unix\x20epoch'),async()=>{const _0x16aec4=_0x4f26b8,rootCapability={...capabilities[_0x16aec4(0x36d)][_0x16aec4(0x2cb)]};rootCapability['id']=oiGLkA[_0x16aec4(0x3e2)],oiGLkA[_0x16aec4(0x1f7)](addToLoader,{'doc':rootCapability});let expires=new Date();expires[_0x16aec4(0x33a)](expires['getHours']()+0xa),expires=expires['toISOString']();const bobZcap=await oiGLkA[_0x16aec4(0x431)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x16aec4(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice});expires=new Date(0x0),expires=expires[_0x16aec4(0x317)]();const carolZcap=await oiGLkA[_0x16aec4(0x344)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x16aec4(0x24a)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x16aec4(0x2f8)]),invocation=await oiGLkA[_0x16aec4(0x31d)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x16aec4(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':oiGLkA['elaVd']});expect(result)['to'][_0x16aec4(0x34d)],oiGLkA[_0x16aec4(0x18a)](expect,result[_0x16aec4(0x1dd)])['to']['be'][_0x16aec4(0x224)],should['exist'](result[_0x16aec4(0x13d)]),result[_0x16aec4(0x13d)][_0x16aec4(0x221)][_0x16aec4(0x278)][_0x16aec4(0x26d)][_0x16aec4(0x148)](0x1);const [error]=result[_0x16aec4(0x13d)][_0x16aec4(0x221)];error['message'][_0x16aec4(0x278)]['contain'](oiGLkA[_0x16aec4(0x166)]);}),it(SGyTfX['tUifR'](_0x4f26b8(0x20d),'second\x20delegated\x20capability\x20that\x20expires\x20after\x20first'),async()=>{const _0x23ea45=_0x4f26b8;if(oiGLkA[_0x23ea45(0x130)](_0x23ea45(0x169),_0x23ea45(0x169))){const rootCapability={...capabilities[_0x23ea45(0x36d)][_0x23ea45(0x2cb)]};rootCapability['id']=oiGLkA[_0x23ea45(0x38a)],oiGLkA['SKWrv'](addToLoader,{'doc':rootCapability});let expires=new Date();expires[_0x23ea45(0x33a)](expires[_0x23ea45(0x3e5)]()+0xa),expires=expires[_0x23ea45(0x317)]();const bobZcap=await oiGLkA[_0x23ea45(0x18a)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA['RYzAu'](uuid),'controller':bob['id'](),'parentCapability':rootCapability['id'],'invocationTarget':rootCapability[_0x23ea45(0x412)],'expires':expires},'parentCapability':rootCapability,'delegator':alice});expires=new Date(),expires[_0x23ea45(0x33a)](oiGLkA['eHhuU'](expires[_0x23ea45(0x3e5)](),0x64)),expires=expires[_0x23ea45(0x317)]();let carolZcap,localError;try{carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA['hdqlb'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap[_0x23ea45(0x412)],'expires':expires},'parentCapability':bobZcap,'delegator':bob});}catch(e){localError=e;}expect(localError)['to'][_0x23ea45(0x34d)],localError[_0x23ea45(0x2ce)][_0x23ea45(0x278)][_0x23ea45(0x357)](oiGLkA[_0x23ea45(0x3a5)]),localError[_0x23ea45(0x418)][_0x23ea45(0x278)]['equal'](_0x23ea45(0x133)+oiGLkA['IaQig']+oiGLkA[_0x23ea45(0x358)]),carolZcap=await oiGLkA[_0x23ea45(0x33b)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':oiGLkA[_0x23ea45(0x2b9)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob});const doc=clone(mock['exampleDoc']),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x23ea45(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':oiGLkA[_0x23ea45(0x392)]});expect(result)['to'][_0x23ea45(0x34d)],oiGLkA[_0x23ea45(0x441)](expect,result['verified'])['to']['be'][_0x23ea45(0x224)],should[_0x23ea45(0x34d)](result[_0x23ea45(0x13d)]),result[_0x23ea45(0x13d)][_0x23ea45(0x2ce)]['should'][_0x23ea45(0x357)](_0x23ea45(0x342));const [error]=result[_0x23ea45(0x13d)]['errors'];error[_0x23ea45(0x418)][_0x23ea45(0x278)][_0x23ea45(0x225)]('delegated\x20capability\x20must\x20not\x20be\x20less\x20restrictive');}else _0x1e5b19=_0x440fb7;}),it(SGyTfX[_0x4f26b8(0x131)](SGyTfX['cKjrH'],'second\x20delegated\x20capability'),async()=>{const _0x2323a9=_0x4f26b8,rootCapability={...capabilities['root'][_0x2323a9(0x2cb)]};rootCapability['id']=_0x2323a9(0x40b),SGyTfX[_0x2323a9(0x1e5)](addToLoader,{'doc':rootCapability});const bobZcap=await SGyTfX[_0x2323a9(0x36e)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice});let expires=new Date();expires[_0x2323a9(0x33a)](expires['getHours']()+0xa),expires=expires[_0x2323a9(0x317)]();const carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock['exampleDoc']),invocation=await _invoke({'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':'read'}),result=await SGyTfX[_0x2323a9(0x23d)](_verifyInvocation,{'invocation':invocation,'rootCapability':rootCapability,'expectedAction':SGyTfX['JlBjW']});expect(result)['to']['exist'],expect(result['verified'])['to']['be'][_0x2323a9(0x3f6)];}),it(_0x4f26b8(0x2dc)+SGyTfX[_0x4f26b8(0x1a2)],async()=>{const _0x2658dd=_0x4f26b8,rootCapability={...capabilities['root'][_0x2658dd(0x2cb)]};rootCapability['id']=SGyTfX[_0x2658dd(0x2dd)],SGyTfX[_0x2658dd(0x408)](addToLoader,{'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice});let expires=new Date();expires[_0x2658dd(0x33a)](SGyTfX[_0x2658dd(0x1ce)](expires['getHours'](),0xa)),expires=expires[_0x2658dd(0x317)]();const carolZcap=await SGyTfX[_0x2658dd(0x276)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':bobZcap['invocationTarget'],'expires':expires},'purposeOptions':{'_skipLocalValidationForTesting':!![]},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x2658dd(0x2f8)]),invocation=await SGyTfX[_0x2658dd(0x305)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':_0x2658dd(0x1c5)}),result=await _verifyInvocation({'invocation':invocation,'rootCapability':rootCapability,'expectedAction':_0x2658dd(0x1c5)});expect(result)['to'][_0x2658dd(0x34d)],expect(result['verified'])['to']['be'][_0x2658dd(0x224)],should['exist'](result[_0x2658dd(0x13d)]),result['error']['name'][_0x2658dd(0x278)][_0x2658dd(0x357)](SGyTfX[_0x2658dd(0x2cd)]);const [error]=result[_0x2658dd(0x13d)][_0x2658dd(0x221)];error[_0x2658dd(0x418)][_0x2658dd(0x278)]['equal'](SGyTfX['YbKVt']);}));}),describe(_0x527338(0x3c8),()=>{const _0x10be02=_0x527338,tZrrxB={'mAsII':function(callee,param1){return bthJAb['IbagU'](callee,param1);},'bQCnI':function(callee,param1){return callee(param1);},'YaHrH':function(callee,param1){return callee(param1);},'POJnF':bthJAb['SiqBv'],'MOKzH':function(callee,param1){return callee(param1);},'MjvRN':function(callee,param1){return bthJAb['nfPYN'](callee,param1);},'MZHjq':function(callee,param1){return callee(param1);},'TfWuY':function(callee,param1){return callee(param1);},'rIagd':function(callee,param1){const _0x4ce8ac=_0x59eb;return bthJAb[_0x4ce8ac(0x126)](callee,param1);},'UJEgn':bthJAb[_0x10be02(0x222)]};it(bthJAb[_0x10be02(0x1f0)],async()=>{const _0x17d9b7=_0x10be02,bobZcap=await _delegate({'parentCapability':capabilities['root'][_0x17d9b7(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await tZrrxB['mAsII'](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),dianaZcap=await tZrrxB['bQCnI'](_delegate,{'parentCapability':carolZcap,'controller':diana,'delegator':carol}),result=await tZrrxB['YaHrH'](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':capabilities[_0x17d9b7(0x36d)][_0x17d9b7(0x2cb)]['id']});expect(result)['to']['exist'],expect(result['verified'])['to']['be'][_0x17d9b7(0x3f6)];}),bthJAb[_0x10be02(0x1bf)](it,bthJAb[_0x10be02(0x3ae)],async()=>{const _0x1711b1=_0x10be02;if(_0x1711b1(0x343)===_0x1711b1(0x343)){const bobZcap=await _delegate({'parentCapability':capabilities['root']['beta'],'controller':bob,'delegator':alice}),carolZcap=await tZrrxB['MjvRN'](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),dianaZcap=await tZrrxB[_0x1711b1(0x145)](_delegate,{'parentCapability':carolZcap,'controller':diana,'delegator':carol});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x4fa462=_0x1711b1;return checkedChain++,capabilityChain[_0x4fa462(0x278)]['be']['an']('array'),capabilityChain['should'][_0x4fa462(0x26d)][_0x4fa462(0x148)](0x4),capabilityChainMeta[_0x4fa462(0x278)]['be']['an'](tZrrxB[_0x4fa462(0x122)]),capabilityChainMeta['should'][_0x4fa462(0x26d)][_0x4fa462(0x148)](0x4),tZrrxB['mAsII'](_checkCapabilityChain,{'capabilityChain':capabilityChain}),tZrrxB[_0x4fa462(0x322)](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta}),{'valid':!![]};},result=await tZrrxB['TfWuY'](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':capabilities[_0x1711b1(0x36d)][_0x1711b1(0x2cb)]['id'],'inspectCapabilityChain':inspectCapabilityChain});expect(result)['to'][_0x1711b1(0x34d)],expect(result[_0x1711b1(0x1dd)])['to']['be'][_0x1711b1(0x3f6)],checkedChain[_0x1711b1(0x278)]['equal'](0x1);}else _0x18c1c2=new _0x4f1a2d({'expectedTarget':_0xe9cdc7[_0x1711b1(0x412)],'expectedRootCapability':_0x147086['id'],'expectedAction':_0x54b104,'inspectCapabilityChain':_0x164fc1,'suite':new _0x15d8d7(),..._0x150b58});}),bthJAb[_0x10be02(0x11d)](it,'should\x20fail\x20to\x20verify\x20w/embedded\x20middle\x20zcap',async()=>{const _0x17e5b3=_0x10be02,bobZcap=await _delegate({'parentCapability':capabilities['root'][_0x17e5b3(0x2cb)],'controller':bob,'delegator':alice}),carolZcap=await tZrrxB[_0x17e5b3(0x35f)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),dianaZcap=await tZrrxB[_0x17e5b3(0x361)](_delegate,{'parentCapability':carolZcap,'controller':diana,'delegator':carol,'purposeOptions':{'_skipLocalValidationForTesting':!![],'_capabilityChain':[capabilities[_0x17e5b3(0x36d)]['beta']['id'],bobZcap,carolZcap]}}),result=await tZrrxB['MOKzH'](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':capabilities[_0x17e5b3(0x36d)][_0x17e5b3(0x2cb)]['id']});tZrrxB[_0x17e5b3(0x145)](expect,result)['to']['exist'],expect(result['verified'])['to']['be']['false'],should['exist'](result[_0x17e5b3(0x13d)]),result[_0x17e5b3(0x13d)][_0x17e5b3(0x2ce)]['should']['equal'](tZrrxB['UJEgn']),should[_0x17e5b3(0x34d)](result['error'][_0x17e5b3(0x221)]);const [error]=result[_0x17e5b3(0x13d)][_0x17e5b3(0x221)];error[_0x17e5b3(0x418)]['should'][_0x17e5b3(0x225)]('consist\x20of\x20strings\x20of\x20capability\x20IDs');}),bthJAb[_0x10be02(0x2f5)](it,bthJAb[_0x10be02(0x29b)],async()=>{const _0x1e97c6=_0x10be02,aHszBw={'Yjyya':SGyTfX[_0x1e97c6(0x32b)],'kEKpH':function(callee,param1){return callee(param1);},'XECFT':'array'};if(SGyTfX[_0x1e97c6(0x114)]!==_0x1e97c6(0x207)){const bobZcap=await SGyTfX[_0x1e97c6(0x39e)](_delegate,{'parentCapability':capabilities[_0x1e97c6(0x36d)]['beta'],'controller':bob,'delegator':alice}),carolZcap=await SGyTfX['pWiXc'](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),dianaZcap=await SGyTfX[_0x1e97c6(0x3fe)](_delegate,{'parentCapability':carolZcap,'controller':diana,'delegator':carol});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x4a76e6=_0x1e97c6,ZNiHdj=aHszBw[_0x4a76e6(0x25b)][_0x4a76e6(0x2d9)]('|');let Ieiskf=0x0;while(!![]){switch(ZNiHdj[Ieiskf++]){case'0':capabilityChain['should']['be']['an'](_0x4a76e6(0x1bc));continue;case'1':aHszBw[_0x4a76e6(0x3bd)](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta});continue;case'2':capabilityChain[_0x4a76e6(0x278)][_0x4a76e6(0x26d)][_0x4a76e6(0x148)](0x4);continue;case'3':aHszBw[_0x4a76e6(0x3bd)](_checkCapabilityChain,{'capabilityChain':capabilityChain});continue;case'4':return{'valid':!![]};case'5':capabilityChainMeta['should']['be']['an']('array');continue;case'6':checkedChain++;continue;case'7':capabilityChainMeta[_0x4a76e6(0x278)][_0x4a76e6(0x26d)][_0x4a76e6(0x148)](0x4);continue;}break;}},result=await SGyTfX[_0x1e97c6(0x1fe)](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':capabilities[_0x1e97c6(0x36d)][_0x1e97c6(0x2cb)]['id'],'purposeOptions':{'inspectCapabilityChain':inspectCapabilityChain,'maxChainLength':0x2}});expect(result)['to'][_0x1e97c6(0x34d)],SGyTfX[_0x1e97c6(0x305)](expect,result[_0x1e97c6(0x1dd)])['to']['be']['false'],should[_0x1e97c6(0x34d)](result[_0x1e97c6(0x13d)]),should['exist'](result[_0x1e97c6(0x13d)][_0x1e97c6(0x221)]),result[_0x1e97c6(0x13d)][_0x1e97c6(0x221)][_0x1e97c6(0x278)]['have'][_0x1e97c6(0x148)](0x1),result[_0x1e97c6(0x13d)]['errors'][0x0][_0x1e97c6(0x418)]['should']['equal'](SGyTfX['ESYua']),checkedChain[_0x1e97c6(0x278)][_0x1e97c6(0x357)](0x0);}else return _0x5269f6++,_0x230d81[_0x1e97c6(0x278)]['be']['an'](_0x1e97c6(0x1bc)),_0x417c54[_0x1e97c6(0x278)][_0x1e97c6(0x26d)][_0x1e97c6(0x148)](0x3),_0x4b7979[_0x1e97c6(0x278)]['be']['an'](aHszBw['XECFT']),_0x4889b3['should'][_0x1e97c6(0x26d)]['length'](0x3),_0x50298f({'capabilityChain':_0x2b77f5}),aHszBw[_0x1e97c6(0x3bd)](_0x3c1f51,{'capabilityChainMeta':_0x38427a}),{'valid':!![]};});}),nYRzSt[_0x527338(0x1e8)](describe,nYRzSt[_0x527338(0x13c)],()=>{const _0x290176=_0x527338,nuDUmE={'PBnhv':SGyTfX[_0x290176(0x424)],'vtOvW':function(callee,param1){const _0x368a40=_0x290176;return SGyTfX[_0x368a40(0x11a)](callee,param1);},'QETZa':_0x290176(0x406),'YrVhj':function(callee){return callee();},'YQtsO':function(callee,param1){return SGyTfX['qmpdG'](callee,param1);},'nEjAf':function(callee,param1){return callee(param1);},'lHSVl':_0x290176(0x1ba),'oMLUN':function(callee,param1){return callee(param1);},'uNgpP':function(callee,param1){return callee(param1);},'xQHwk':function(callee,param1){return callee(param1);},'VvCRs':SGyTfX[_0x290176(0x43c)],'gOaQz':function(callee,param1){const _0x35d858=_0x290176;return SGyTfX[_0x35d858(0x272)](callee,param1);},'KPwWl':function(callee,param1){const _0xde0319=_0x290176;return SGyTfX[_0xde0319(0x1be)](callee,param1);},'BmbgG':function(x,y){return x+y;},'RforH':function(callee){return SGyTfX['zwRcf'](callee);},'eKLmD':function(callee,param1){return callee(param1);},'sBOGU':function(callee,param1){return SGyTfX['KtsSm'](callee,param1);},'LeUBg':function(callee,param1){const _0x327b5d=_0x290176;return SGyTfX[_0x327b5d(0x212)](callee,param1);},'PflGU':function(callee){return callee();},'OkDhG':function(callee,param1){return callee(param1);},'BNgIk':'1|2|7|4|0|5|3|6','Fopgy':SGyTfX['YtSsa'],'zitsq':SGyTfX[_0x290176(0x263)],'wQwdq':function(callee,param1){const _0x45e9cc=_0x290176;return SGyTfX[_0x45e9cc(0x1b0)](callee,param1);}};it(_0x290176(0x16c),async()=>{const _0x200e0e=_0x290176,rootTarget=nuDUmE[_0x200e0e(0x29f)],rootCapability=nuDUmE[_0x200e0e(0x254)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),invocationTarget=carolZcap['invocationTarget']+_0x200e0e(0x2e4),dianaZcap=await nuDUmE[_0x200e0e(0x254)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await _verifyDelegation({'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'purposeOptions':{'allowTargetAttenuation':!![]}});expect(result)['to'][_0x200e0e(0x34d)],nuDUmE[_0x200e0e(0x254)](expect,result['verified'])['to']['be'][_0x200e0e(0x3f6)];}),SGyTfX[_0x290176(0x1e3)](it,SGyTfX['WVCBW'],async()=>{const _0x21e641=_0x290176,rootTarget=SGyTfX[_0x21e641(0x2f6)],rootCapability=SGyTfX['TEoLf'](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x21e641(0x43d)](addToLoader,{'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),carolZcap=await SGyTfX[_0x21e641(0x17f)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),invocationTarget=carolZcap[_0x21e641(0x412)]+_0x21e641(0x252),dianaZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await _verifyDelegation({'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'purposeOptions':{'allowTargetAttenuation':!![]}});expect(result)['to'][_0x21e641(0x34d)],SGyTfX['VGCfx'](expect,result[_0x21e641(0x1dd)])['to']['be'][_0x21e641(0x3f6)];}),it(SGyTfX[_0x290176(0x1c2)],async()=>{const _0x66f6ac=_0x290176,rootTarget=SGyTfX['QjNqU'],rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x66f6ac(0x1c7)](addToLoader,{'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),invocationTarget=carolZcap[_0x66f6ac(0x412)]+_0x66f6ac(0x273),dianaZcap=await SGyTfX['IJXqq'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await SGyTfX[_0x66f6ac(0x1c8)](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'purposeOptions':{'allowTargetAttenuation':!![]}});SGyTfX[_0x66f6ac(0x3f1)](expect,result)['to'][_0x66f6ac(0x34d)],SGyTfX[_0x66f6ac(0x272)](expect,result[_0x66f6ac(0x1dd)])['to']['be'][_0x66f6ac(0x3f6)];}),SGyTfX['dgNhM'](it,SGyTfX[_0x290176(0x281)]+'permissive\x20than\x20the\x20parent\x20capability\x20w/path',async()=>{const _0x2a795a=_0x290176,rootTarget=nuDUmE[_0x2a795a(0x214)],rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});nuDUmE['vtOvW'](addToLoader,{'doc':rootCapability});const bobZcap=await nuDUmE[_0x2a795a(0x254)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x2a795a(0x412)]+_0x2a795a(0x2e4),carolZcap=await nuDUmE[_0x2a795a(0x254)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':nuDUmE['YrVhj'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),dianaZcap=await nuDUmE[_0x2a795a(0x3d3)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':nuDUmE[_0x2a795a(0x24d)](uuid),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':bobZcap[_0x2a795a(0x412)],'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await nuDUmE['nEjAf'](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'purposeOptions':{'allowTargetAttenuation':!![]}});expect(result)['to'][_0x2a795a(0x34d)],expect(result[_0x2a795a(0x1dd)])['to']['be'][_0x2a795a(0x224)],result[_0x2a795a(0x13d)][_0x2a795a(0x221)][_0x2a795a(0x278)][_0x2a795a(0x26d)][_0x2a795a(0x148)](0x1);const [error]=result[_0x2a795a(0x13d)][_0x2a795a(0x221)];error[_0x2a795a(0x418)]['should'][_0x2a795a(0x251)](nuDUmE[_0x2a795a(0x3e6)]);}),it(_0x290176(0x134)+SGyTfX[_0x290176(0x1d7)],async()=>{const _0x1e2ce9=_0x290176,rootTarget=SGyTfX[_0x1e2ce9(0x32f)],rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap['invocationTarget']+_0x1e2ce9(0x252),carolZcap=await SGyTfX['ZwJtC'](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['JQgPu'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),dianaZcap=await SGyTfX[_0x1e2ce9(0x180)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['WIyFo'](uuid),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':bobZcap[_0x1e2ce9(0x412)],'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await SGyTfX[_0x1e2ce9(0x203)](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'purposeOptions':{'allowTargetAttenuation':!![]}});SGyTfX['hcXkv'](expect,result)['to'][_0x1e2ce9(0x34d)],expect(result[_0x1e2ce9(0x1dd)])['to']['be'][_0x1e2ce9(0x224)],result[_0x1e2ce9(0x13d)][_0x1e2ce9(0x221)][_0x1e2ce9(0x278)][_0x1e2ce9(0x26d)][_0x1e2ce9(0x148)](0x1);const [error]=result[_0x1e2ce9(0x13d)][_0x1e2ce9(0x221)];error['message'][_0x1e2ce9(0x278)]['include'](SGyTfX['WdUOg']);}),it(SGyTfX[_0x290176(0x3c1)]('should\x20verify\x20when\x20invoking\x20at\x20an\x20exact-match\x20target\x20',_0x290176(0x402)),async()=>{const _0x3e1bc8=_0x290176,rootTarget=_0x3e1bc8(0x2b5)+uuid(),rootCapability=SGyTfX[_0x3e1bc8(0x17f)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await SGyTfX[_0x3e1bc8(0x1b1)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x3e1bc8(0x412)]+_0x3e1bc8(0x2e4),carolZcap=await SGyTfX[_0x3e1bc8(0x2c8)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=SGyTfX[_0x3e1bc8(0x1b1)](clone,mock[_0x3e1bc8(0x2f8)]),invocation=await SGyTfX['maxFp'](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX['JlBjW']}),result=await _verifyInvocation({'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':SGyTfX['JlBjW'],'expectedTarget':[rootTarget,invocationTarget],'expectedRootCapability':rootCapability['id']}});expect(result)['to']['exist'],expect(result[_0x3e1bc8(0x1dd)])['to']['be'][_0x3e1bc8(0x3f6)];}),SGyTfX[_0x290176(0x3cc)](it,'should\x20verify\x20when\x20invoking\x20at\x20an\x20exact-match\x20target\x20'+'w/query',async()=>{const _0x527253=_0x290176,rootTarget=_0x527253(0x2b5)+uuid(),rootCapability=SGyTfX['IxzTe'](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x527253(0x3ce)](addToLoader,{'doc':rootCapability});const bobZcap=await SGyTfX[_0x527253(0x21a)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x527253(0x412)]+_0x527253(0x252),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock['exampleDoc']),invocation=await SGyTfX[_0x527253(0x196)](_invoke,{'doc':doc,'invoker':carol,'capability':carolZcap,'capabilityAction':SGyTfX[_0x527253(0x43c)]}),result=await SGyTfX[_0x527253(0x426)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':'read','expectedTarget':[rootTarget,invocationTarget],'expectedRootCapability':rootCapability['id']}});expect(result)['to']['exist'],SGyTfX[_0x527253(0x417)](expect,result[_0x527253(0x1dd)])['to']['be'][_0x527253(0x3f6)];}),it(_0x290176(0x19f)+SGyTfX['iUHpc'],async()=>{const _0x63a44c=_0x290176,rootTarget=_0x63a44c(0x2b5)+uuid(),rootCapability=nuDUmE[_0x63a44c(0x440)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap['invocationTarget']+_0x63a44c(0x2e4),carolZcap=await nuDUmE[_0x63a44c(0x436)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=nuDUmE[_0x63a44c(0x165)](clone,mock[_0x63a44c(0x2f8)]),invalidTarget=rootTarget+_0x63a44c(0x30f),invocation=await _invoke({'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':_0x63a44c(0x1c5),'invocationTarget':invalidTarget}}),expectedTarget=[rootTarget,invocationTarget],purpose=new CapabilityInvocation({'allowTargetAttenuation':!![],'expectedAction':nuDUmE[_0x63a44c(0x2df)],'expectedTarget':expectedTarget,'expectedRootCapability':rootCapability['id'],'suite':new Ed25519Signature2020()});purpose[_0x63a44c(0x11c)]=()=>!![];const result=await jsigs['verify'](invocation,{'suite':new Ed25519Signature2020(),'purpose':purpose,'documentLoader':testLoader});nuDUmE['gOaQz'](expect,result)['to'][_0x63a44c(0x34d)],nuDUmE[_0x63a44c(0x34c)](expect,result[_0x63a44c(0x1dd)])['to']['be'][_0x63a44c(0x224)],result[_0x63a44c(0x13d)][_0x63a44c(0x221)][_0x63a44c(0x278)][_0x63a44c(0x26d)][_0x63a44c(0x148)](0x1);const [error]=result[_0x63a44c(0x13d)]['errors'];error[_0x63a44c(0x418)][_0x63a44c(0x278)][_0x63a44c(0x251)](nuDUmE['BmbgG'](_0x63a44c(0x335)+invalidTarget+_0x63a44c(0x1e0),_0x63a44c(0x23c)+carolZcap[_0x63a44c(0x412)]+').'));}),it(SGyTfX['NHifE']+SGyTfX[_0x290176(0x3c4)],async()=>{const _0x419939=_0x290176,rootTarget=_0x419939(0x2b5)+SGyTfX[_0x419939(0x291)](uuid),rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x419939(0x3ce)](addToLoader,{'doc':rootCapability});const bobZcap=await SGyTfX['tiQnQ'](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x419939(0x412)]+'?foo=bar',carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['kEcQy'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=SGyTfX['boiHP'](clone,mock[_0x419939(0x2f8)]),invalidTarget=rootTarget+'/a-different-specific-document?foo=bar',invocation=await SGyTfX[_0x419939(0x1ab)](_invoke,{'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':'read','invocationTarget':invalidTarget}}),expectedTarget=[rootTarget,invocationTarget],purpose=new CapabilityInvocation({'allowTargetAttenuation':!![],'expectedAction':SGyTfX['JlBjW'],'expectedTarget':expectedTarget,'expectedRootCapability':rootCapability['id'],'suite':new Ed25519Signature2020()});purpose[_0x419939(0x11c)]=()=>!![];const result=await jsigs[_0x419939(0x2d6)](invocation,{'suite':new Ed25519Signature2020(),'purpose':purpose,'documentLoader':testLoader});SGyTfX[_0x419939(0x296)](expect,result)['to'][_0x419939(0x34d)],expect(result['verified'])['to']['be'][_0x419939(0x224)],result[_0x419939(0x13d)][_0x419939(0x221)][_0x419939(0x278)][_0x419939(0x26d)][_0x419939(0x148)](0x1);const [error]=result['error'][_0x419939(0x221)];error[_0x419939(0x418)]['should']['include'](SGyTfX[_0x419939(0x2c1)](_0x419939(0x335)+invalidTarget+_0x419939(0x1e0),_0x419939(0x23c)+carolZcap['invocationTarget']+').'));}),it(SGyTfX[_0x290176(0x22f)]+'w/path',async()=>{const _0x32169e=_0x290176,rootTarget=_0x32169e(0x2b5)+nuDUmE[_0x32169e(0x2e5)](uuid),rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});nuDUmE[_0x32169e(0x440)](addToLoader,{'doc':rootCapability});const bobZcap=await nuDUmE[_0x32169e(0x2bd)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap['invocationTarget']+_0x32169e(0x2e4),carolZcap=await nuDUmE[_0x32169e(0x34c)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':nuDUmE['RforH'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=nuDUmE[_0x32169e(0x1a4)](clone,mock[_0x32169e(0x2f8)]),validSubTarget=carolZcap['invocationTarget']+_0x32169e(0x3c5),invocation=await _invoke({'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':nuDUmE[_0x32169e(0x2df)],'invocationTarget':validSubTarget}}),result=await nuDUmE[_0x32169e(0x434)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':_0x32169e(0x1c5),'expectedTarget':[rootTarget,validSubTarget],'expectedRootCapability':rootCapability['id']}});nuDUmE[_0x32169e(0x434)](expect,result)['to'][_0x32169e(0x34d)],expect(result['verified'])['to']['be'][_0x32169e(0x3f6)];}),it('should\x20verify\x20when\x20invoking\x20at\x20a\x20valid\x20sub\x20target\x20'+_0x290176(0x3a6),async()=>{const _0x5d3648=_0x290176,rootTarget='https://example.com/edvs/'+uuid(),rootCapability=SGyTfX[_0x5d3648(0x115)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x5d3648(0x412)]+_0x5d3648(0x252),carolZcap=await SGyTfX[_0x5d3648(0x1ea)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x5d3648(0x2f8)]),validSubTarget=carolZcap[_0x5d3648(0x412)]+_0x5d3648(0x245),invocation=await _invoke({'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':SGyTfX['JlBjW'],'invocationTarget':validSubTarget}}),result=await _verifyInvocation({'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':SGyTfX[_0x5d3648(0x43c)],'expectedTarget':[rootTarget,validSubTarget],'expectedRootCapability':rootCapability['id']}});expect(result)['to'][_0x5d3648(0x34d)],SGyTfX['Ppsjj'](expect,result[_0x5d3648(0x1dd)])['to']['be']['true'];}),SGyTfX['CPuHZ'](it,_0x290176(0x3e0)+_0x290176(0x350),async()=>{const _0x3f5de6=_0x290176,rootTarget=_0x3f5de6(0x2b5)+nuDUmE[_0x3f5de6(0x411)](uuid),rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});nuDUmE['vtOvW'](addToLoader,{'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap['invocationTarget']+'/a-specific-document',carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=nuDUmE['vtOvW'](clone,mock[_0x3f5de6(0x2f8)]),invalidTarget=rootTarget+_0x3f5de6(0x30f),invocation=await _invoke({'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':nuDUmE['VvCRs'],'invocationTarget':invalidTarget}}),result=await nuDUmE[_0x3f5de6(0x303)](_verifyInvocation,{'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':_0x3f5de6(0x1c5),'expectedTarget':[rootTarget,invalidTarget],'expectedRootCapability':rootCapability['id']}});expect(result)['to'][_0x3f5de6(0x34d)],expect(result[_0x3f5de6(0x1dd)])['to']['be'][_0x3f5de6(0x224)],result['error'][_0x3f5de6(0x221)]['should'][_0x3f5de6(0x26d)][_0x3f5de6(0x148)](0x1);const [error]=result[_0x3f5de6(0x13d)][_0x3f5de6(0x221)];error[_0x3f5de6(0x418)][_0x3f5de6(0x278)][_0x3f5de6(0x251)](_0x3f5de6(0x335)+invalidTarget+')\x20does\x20not\x20match\x20capability\x20'+('target\x20('+carolZcap['invocationTarget']+')'));}),SGyTfX[_0x290176(0x28f)](it,'should\x20fail\x20to\x20verify\x20when\x20invoking\x20at\x20an\x20invalid\x20'+SGyTfX[_0x290176(0x3c4)],async()=>{const _0x45bade=_0x290176,rootTarget='https://example.com/edvs/'+uuid(),rootCapability=createRootCapability({'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x45bade(0x2e2)](addToLoader,{'doc':rootCapability});const bobZcap=await _delegate({'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x45bade(0x412)]+_0x45bade(0x252),carolZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x45bade(0x22a)](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),doc=clone(mock[_0x45bade(0x2f8)]),invalidTarget=rootTarget+_0x45bade(0x170),invocation=await _invoke({'doc':doc,'invoker':carol,'purposeOptions':{'capability':carolZcap,'capabilityAction':_0x45bade(0x1c5),'invocationTarget':invalidTarget}}),result=await _verifyInvocation({'invocation':invocation,'purposeOptions':{'allowTargetAttenuation':!![],'expectedAction':_0x45bade(0x1c5),'expectedTarget':[rootTarget,invalidTarget],'expectedRootCapability':rootCapability['id']}});SGyTfX[_0x45bade(0x15a)](expect,result)['to'][_0x45bade(0x34d)],expect(result[_0x45bade(0x1dd)])['to']['be'][_0x45bade(0x224)],result[_0x45bade(0x13d)]['errors'][_0x45bade(0x278)][_0x45bade(0x26d)][_0x45bade(0x148)](0x1);const [error]=result[_0x45bade(0x13d)][_0x45bade(0x221)];error[_0x45bade(0x418)][_0x45bade(0x278)][_0x45bade(0x251)](_0x45bade(0x335)+invalidTarget+')\x20does\x20not\x20match\x20capability\x20'+('target\x20('+carolZcap[_0x45bade(0x412)]+')'));}),SGyTfX[_0x290176(0x27d)](it,SGyTfX[_0x290176(0x1f5)](SGyTfX['QQlmX'],SGyTfX['UOpyi']),async()=>{const _0x1ab267=_0x290176;if(SGyTfX[_0x1ab267(0x1ad)](SGyTfX[_0x1ab267(0x33f)],SGyTfX['kpjvX']))_0x130dd2=_0x126127;else{const rootTarget=SGyTfX[_0x1ab267(0x353)],rootCapability=SGyTfX[_0x1ab267(0x3f1)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await SGyTfX[_0x1ab267(0x154)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),carolZcap=await SGyTfX[_0x1ab267(0x19d)](_delegate,{'parentCapability':bobZcap,'controller':carol,'delegator':bob}),invocationTarget=carolZcap[_0x1ab267(0x412)]+_0x1ab267(0x2e4),dianaZcap=await SGyTfX[_0x1ab267(0x229)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX[_0x1ab267(0x277)](uuid),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol}),result=await SGyTfX[_0x1ab267(0x1c7)](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':rootCapability['id']});SGyTfX[_0x1ab267(0x1b0)](expect,result)['to'][_0x1ab267(0x34d)],expect(result[_0x1ab267(0x1dd)])['to']['be'][_0x1ab267(0x224)],result[_0x1ab267(0x13d)][_0x1ab267(0x221)][_0x1ab267(0x278)]['have']['length'](0x1);const [error]=result[_0x1ab267(0x13d)][_0x1ab267(0x221)];error[_0x1ab267(0x418)][_0x1ab267(0x278)]['contain'](_0x1ab267(0x290));}}),SGyTfX['kcpeh'](it,SGyTfX['TyukZ'],async()=>{const _0x33e03e=_0x290176,NmwbQo={'thfsJ':nuDUmE[_0x33e03e(0x1d8)],'Tpxtd':nuDUmE['Fopgy']},rootTarget=nuDUmE[_0x33e03e(0x26c)],rootCapability=nuDUmE[_0x33e03e(0x37f)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});addToLoader({'doc':rootCapability});const bobZcap=await nuDUmE[_0x33e03e(0x165)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),carolZcap=await _delegate({'parentCapability':bobZcap,'controller':carol,'delegator':bob}),invocationTarget=carolZcap[_0x33e03e(0x412)]+_0x33e03e(0x2e4),dianaZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':nuDUmE[_0x33e03e(0x411)](uuid),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x241032=_0x33e03e,oqnpRa=NmwbQo[_0x241032(0x395)][_0x241032(0x2d9)]('|');let tMNqZb=0x0;while(!![]){switch(oqnpRa[tMNqZb++]){case'0':capabilityChainMeta[_0x241032(0x278)][_0x241032(0x26d)][_0x241032(0x148)](0x4);continue;case'1':checkedChain++;continue;case'2':capabilityChain[_0x241032(0x278)]['be']['an'](NmwbQo[_0x241032(0x193)]);continue;case'3':_checkCapabilityChainMeta({'capabilityChainMeta':capabilityChainMeta});continue;case'4':capabilityChainMeta[_0x241032(0x278)]['be']['an'](NmwbQo[_0x241032(0x193)]);continue;case'5':_checkCapabilityChain({'capabilityChain':capabilityChain});continue;case'6':return{'valid':!![]};case'7':capabilityChain[_0x241032(0x278)]['have'][_0x241032(0x148)](0x4);continue;}break;}},result=await nuDUmE['wQwdq'](_verifyDelegation,{'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'inspectCapabilityChain':inspectCapabilityChain,'purposeOptions':{'allowTargetAttenuation':!![]}});expect(result)['to'][_0x33e03e(0x34d)],expect(result['verified'])['to']['be'][_0x33e03e(0x3f6)],checkedChain[_0x33e03e(0x278)][_0x33e03e(0x357)](0x1);}),it(SGyTfX[_0x290176(0x25c)](SGyTfX['QLUep'],SGyTfX[_0x290176(0x42f)]),async()=>{const _0x301fb0=_0x290176,yHJnPz={'eDgLl':_0x301fb0(0x1bc),'CPEGa':function(callee,param1){return callee(param1);},'HNrXr':function(callee,param1){return callee(param1);}};if(SGyTfX[_0x301fb0(0x137)]!==_0x301fb0(0x313)){_0x48f1f2&&(_0x22ba14=_0x339d29[_0x301fb0(0x253)](_0x301fb0(0x1a7),0x0));let _0x59650c;return _0x40e776?_0x59650c=new _0x10d723({'capability':_0x213f54['parentCapability']?_0x58c527:_0xf9b6a0['id'],'capabilityAction':_0x2b55b7,'invocationTarget':_0x5f1ec4['invocationTarget']}):_0x59650c=new _0x3d30bc(_0x542249),_0x4fa6b2[_0x301fb0(0x1cb)](_0x55a295,{'documentLoader':_0x519949,'suite':new _0x40252b({'key':new _0x467f69(_0xc83ec6),'date':_0x2300a7}),'purpose':_0x59650c});}else{const rootTarget='https://example.com/edvs/d9dd2093-0908-47ba-8db7-954ff1cd81ee',rootCapability=SGyTfX[_0x301fb0(0x3c6)](createRootCapability,{'controller':alice['id'](),'invocationTarget':rootTarget});SGyTfX[_0x301fb0(0x17f)](addToLoader,{'doc':rootCapability});const bobZcap=await SGyTfX[_0x301fb0(0x276)](_delegate,{'parentCapability':rootCapability,'controller':bob,'delegator':alice}),invocationTarget=bobZcap[_0x301fb0(0x412)]+_0x301fb0(0x2e4),carolZcap=await SGyTfX[_0x301fb0(0x23b)](_delegate,{'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':SGyTfX['mrptQ'](uuid),'controller':carol['id'](),'parentCapability':bobZcap['id'],'invocationTarget':invocationTarget,'expires':EXPIRES_3000_DATE},'parentCapability':bobZcap,'delegator':bob}),dianaZcap=await _delegate({'newCapability':{'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':diana['id'](),'parentCapability':carolZcap['id'],'invocationTarget':bobZcap[_0x301fb0(0x412)],'expires':EXPIRES_3000_DATE},'parentCapability':carolZcap,'delegator':carol});let checkedChain=0x0;const inspectCapabilityChain=async({capabilityChain:capabilityChain,capabilityChainMeta:capabilityChainMeta})=>{const _0x196e3d=_0x301fb0;return checkedChain++,capabilityChain['should']['be']['an'](_0x196e3d(0x1bc)),capabilityChain[_0x196e3d(0x278)][_0x196e3d(0x26d)]['length'](0x4),capabilityChainMeta[_0x196e3d(0x278)]['be']['an'](yHJnPz[_0x196e3d(0x163)]),capabilityChainMeta[_0x196e3d(0x278)]['have'][_0x196e3d(0x148)](0x4),yHJnPz[_0x196e3d(0x146)](_checkCapabilityChain,{'capabilityChain':capabilityChain}),yHJnPz[_0x196e3d(0x367)](_checkCapabilityChainMeta,{'capabilityChainMeta':capabilityChainMeta}),{'valid':!![]};},result=await _verifyDelegation({'delegation':dianaZcap,'expectedRootCapability':rootCapability['id'],'inspectCapabilityChain':inspectCapabilityChain,'purposeOptions':{'allowTargetAttenuation':!![]}});SGyTfX[_0x301fb0(0x200)](expect,result)['to'][_0x301fb0(0x34d)],SGyTfX[_0x301fb0(0x211)](expect,result['verified'])['to']['be'][_0x301fb0(0x224)],result[_0x301fb0(0x13d)]['errors'][_0x301fb0(0x278)]['have']['length'](0x1);const [error]=result[_0x301fb0(0x13d)][_0x301fb0(0x221)];error[_0x301fb0(0x418)][_0x301fb0(0x278)]['include'](SGyTfX[_0x301fb0(0x14c)]),checkedChain['should']['equal'](0x0);}});});}));});function _checkCapabilityChain({capabilityChain:capabilityChain}){const _0x3940d0=_0x59dca6;for(const c of capabilityChain){c[_0x3940d0(0x278)]['be']['an'](nYRzSt[_0x3940d0(0x1f1)]),c['should'][_0x3940d0(0x26d)][_0x3940d0(0x3ca)]('id'),c[_0x3940d0(0x278)][_0x3940d0(0x26d)][_0x3940d0(0x3ca)]('controller'),c[_0x3940d0(0x278)][_0x3940d0(0x26d)][_0x3940d0(0x3ca)](nYRzSt[_0x3940d0(0x314)]);}}function _checkCapabilityChainMeta({capabilityChainMeta:capabilityChainMeta}){const _0x8f5c0f=_0x59dca6;for(const [i,m]of capabilityChainMeta[_0x8f5c0f(0x259)]()){m[_0x8f5c0f(0x278)]['be']['an'](nYRzSt[_0x8f5c0f(0x1f1)]),m[_0x8f5c0f(0x278)][_0x8f5c0f(0x26d)][_0x8f5c0f(0x3ca)](_0x8f5c0f(0x340));if(nYRzSt[_0x8f5c0f(0x2db)](i,0x0)){expect(m[_0x8f5c0f(0x340)])['to']['be'][_0x8f5c0f(0x1e2)];continue;}m[_0x8f5c0f(0x340)][_0x8f5c0f(0x278)][_0x8f5c0f(0x26d)]['property']('verified'),m[_0x8f5c0f(0x340)][_0x8f5c0f(0x1dd)][_0x8f5c0f(0x278)]['be'][_0x8f5c0f(0x3f6)],m[_0x8f5c0f(0x340)][_0x8f5c0f(0x278)]['have'][_0x8f5c0f(0x3ca)](nYRzSt[_0x8f5c0f(0x2cf)]),m[_0x8f5c0f(0x340)][_0x8f5c0f(0x2b7)]['length'][_0x8f5c0f(0x278)]['equal'](0x1),m[_0x8f5c0f(0x340)][_0x8f5c0f(0x2b7)][0x0][_0x8f5c0f(0x278)]['be']['an'](nYRzSt[_0x8f5c0f(0x1f1)]),m[_0x8f5c0f(0x340)]['results'][0x0][_0x8f5c0f(0x278)][_0x8f5c0f(0x26d)][_0x8f5c0f(0x3ca)](nYRzSt[_0x8f5c0f(0x378)]),m['verifyResult']['results'][0x0]['purposeResult']['should']['be']['an'](nYRzSt[_0x8f5c0f(0x1f1)]),m[_0x8f5c0f(0x340)][_0x8f5c0f(0x2b7)][0x0][_0x8f5c0f(0x2e1)]['should'][_0x8f5c0f(0x26d)]['property'](nYRzSt['RjJOj']);}}async function _invoke({doc:doc,key:key,invoker:invoker,date:date,capability:capability,capabilityAction:capabilityAction,purposeOptions:purposeOptions}){const _0x4e9112=_0x59dca6;if(nYRzSt[_0x4e9112(0x30d)]===nYRzSt[_0x4e9112(0x3cd)]){let _0x5d3ae7,_0x43a65c;try{_0x5d3ae7=new _0x2cc621({'expectedRootCapability':_0x4e9112(0x3b7),'date':_0x4e9112(0x147)});}catch(_0x51f9b5){_0x43a65c=_0x51f9b5;}_0x310a86[_0x4e9112(0x34d)](_0x43a65c),_0xdbb18d[_0x4e9112(0x382)]['exist'](_0x5d3ae7),_0x43a65c[_0x4e9112(0x278)]['be'][_0x4e9112(0x3b0)](_0x4e6cf2),_0x43a65c[_0x4e9112(0x418)][_0x4e9112(0x278)][_0x4e9112(0x225)](_0x4e9112(0x3a0));}else{invoker&&(key=invoker[_0x4e9112(0x253)](nYRzSt[_0x4e9112(0x2fb)],0x0));let purpose;return capability?purpose=new CapabilityInvocation({'capability':capability[_0x4e9112(0x415)]?capability:capability['id'],'capabilityAction':capabilityAction,'invocationTarget':capability[_0x4e9112(0x412)]}):purpose=new CapabilityInvocation(purposeOptions),jsigs['sign'](doc,{'documentLoader':testLoader,'suite':new Ed25519Signature2020({'key':new Ed25519VerificationKey2020(key),'date':date}),'purpose':purpose});}}async function _verifyInvocation({invocation:invocation,rootCapability:rootCapability,expectedAction:expectedAction,inspectCapabilityChain:inspectCapabilityChain,purposeOptions:purposeOptions}){const _0x33eae7=_0x59dca6,YdjxKo={'NXrDD':function(x,y){return x+y;},'FTHqK':'has\x20been\x20revoked.'};let purpose;if(rootCapability){if(nYRzSt[_0x33eae7(0x3be)](nYRzSt[_0x33eae7(0x363)],_0x33eae7(0x1a0)))purpose=new CapabilityInvocation({'expectedTarget':rootCapability[_0x33eae7(0x412)],'expectedRootCapability':rootCapability['id'],'expectedAction':expectedAction,'inspectCapabilityChain':inspectCapabilityChain,'suite':new Ed25519Signature2020(),...purposeOptions});else return _0x515e69++,_0x5721db[_0x33eae7(0x278)]['be']['an'](_0x33eae7(0x1bc)),_0xa56bf9[_0x33eae7(0x278)][_0x33eae7(0x26d)]['length'](0x3),_0x22c892({'capabilityChain':_0x4de302}),_0x2a0ba2({'capabilityChainMeta':_0x2232cc}),{'error':new _0x36a23e(YdjxKo['NXrDD']('The\x20capability\x20\x22'+_0x111437[0x0]['id']+'\x22\x20',YdjxKo[_0x33eae7(0x22c)])),'valid':![]};}else _0x33eae7(0x2bc)==='hBbxu'?_0x3f00d7=_0x2fe174:purpose=new CapabilityInvocation({'suite':new Ed25519Signature2020(),...purposeOptions});return jsigs[_0x33eae7(0x2d6)](invocation,{'documentLoader':testLoader,'suite':new Ed25519Signature2020(),'purpose':purpose});}async function _delegate({newCapability:newCapability,parentCapability:parentCapability,controller:controller,key:key,delegator:delegator,date:date,_capabilityChain:_capabilityChain,purposeOptions:purposeOptions}){const _0x3379b3=_0x59dca6;delegator&&(key=delegator[_0x3379b3(0x253)](_0x3379b3(0x168),0x0));let purpose;return purposeOptions?purpose=new CapabilityDelegation({'parentCapability':parentCapability,'_capabilityChain':_capabilityChain,...purposeOptions}):purpose=new CapabilityDelegation({'parentCapability':parentCapability,'_capabilityChain':_capabilityChain}),!newCapability&&(newCapability={'@context':ZCAP_CONTEXT_URL,'id':uuid(),'controller':typeof controller===nYRzSt[_0x3379b3(0x13b)]?controller:controller['id'](),'parentCapability':parentCapability['id'],'invocationTarget':parentCapability[_0x3379b3(0x412)],'expires':EXPIRES_3000_DATE}),jsigs[_0x3379b3(0x1cb)](newCapability,{'documentLoader':testLoader,'suite':new Ed25519Signature2020({'key':new Ed25519VerificationKey2020(key),'date':date}),'purpose':purpose});}async function _verifyDelegation({delegation:delegation,expectedRootCapability:expectedRootCapability,inspectCapabilityChain:inspectCapabilityChain,purposeOptions:purposeOptions={}}){const _0x6503b0=_0x59dca6;return jsigs[_0x6503b0(0x2d6)](delegation,{'documentLoader':testLoader,'suite':new Ed25519Signature2020(),'purpose':new CapabilityDelegation({'suite':new Ed25519Signature2020(),'expectedRootCapability':expectedRootCapability,'inspectCapabilityChain':inspectCapabilityChain,...purposeOptions})});}}function _0x41df(){const _0x3d9971=['Gunaq','\x22read\x22\x20expected\x20action','BQTto','qqoEL','CIzXj','hKroC','vaZME','GhVlD','PBnhv','WIyFo','A\x20capability\x20in\x20the\x20delegation\x20chain\x20has\x20expired.','trMdr','must\x20not\x20be\x20less\x20restrictive\x20than\x20its\x20parent.','ypOCi','does\x20not\x20match\x20the\x20parent','oIvRT','iDzpY','MMemI','tiQnQ','rCVBO','MaoDr','tAqjM','ZGlcx','zcap\x20in\x20middle\x20of\x20chain','CPYAW','DuAwX','nImXC','oxsSW','jyWqk','dqZMP','https://example.com/edvs/','should\x20fail\x20to\x20verify\x20chain\x20w/bad\x20middle\x20capability','results','NCTeu','hdqlb','SxAPw','WRVsX','UBTnD','eKLmD','xEztm','IbagU','abJHY','nfOrq','pOKRu','vfsta','should\x20fail\x20if\x20expectedRootCapability\x20does\x20not\x20match','object','Cannot\x20delegate\x20an\x20expired\x20capability.','OahAU','IcDAR','SZWqa','Rhvgx','beta','should\x20fail\x20to\x20verify\x20chain\x20with\x20embedded\x20root\x20','bsWHf','name','daHJk','YtSsa','Sign\x20with\x20capabilityDelegation\x20proof\x20purpose','dlTfr','urn:zcap:1e7dfae9-85a3-40d7-97ea-20105f0b9d99','EVKdH','The\x20capability\x20\x22','verify','YukwF','UzQSw','split','EEncb','zHQwH','should\x20fail\x20invoking\x20a\x20capability\x20with\x20only\x20an\x20expired\x20','LPXxr','should\x20fail\x20to\x20verify\x20chain\x20with\x20non-embedded\x20last\x20','VvCRs','A\x20delegated\x20capability\x20must\x20not\x20be\x20invoked\x20before\x20the\x20\x22created\x22\x20','purposeResult','oVkAV','CgQOR','/a-specific-document','RforH','tmZTY','OnQtp','BSTJT','dpJgg','matching\x20\x22capabilityAction\x22\x20not\x20found','VMyTM','1|5|0|2|4|3','https://example.com/edvs/0d3bd43c-719c-11ec-acdd-10bf48838a41','mrptQ','FKqzN','controller','prjhr','WjyAb','yfCqH','akckn','JslCk','ccMHf','TguLO','exampleDoc','xrbCu','QQGPk','VPXTJ','354218ReZifi','oUBgJ','should\x20verify\x20chain\x20w/\x20multiple\x20controllers','TEMQs','should\x20fail\x20invoking\x20a\x20delegated\x20capability\x20before\x20its\x20','ahyXe','alpha','OkDhG','allowed\x20action\x20on\x20one\x20capability','oUjyt','UBSFY','ziIsI','second\x20delegated\x20capability','delegated\x20before\x20its\x20parent','HArXX','urn:uuid:710910c8-61e4-11ec-8739-10bf48838a41','nNwIn','CXMhe','TJDcx','/a-different-specific-document','a\x20matching\x20`expectedRootCapability`\x20is\x20given','qvITX','voJey','dsOmB','rtLML','DqkhL','5|4|0|3|1|2','toISOString','gsOpz','WuPdz','CUwMZ','poVJt','Xhrwx','IXfcF','tLixL','Qlvpt','mRFFV','DauFC','MOKzH','thFWE','RCmvX','CcAXb','zcap\x20at\x20end\x20of\x20chain','eQknc','it\x20must\x20consist\x20of\x20strings','Ctdhm','Kdqba','AGLOt','NCVNu','nQEfV','\x22capabilityAction\x22\x20must\x20be\x20a\x20string.','kPfEC','veLUz','uRitz','kFpYM','RzaxJ','hSMtO','Invocation\x20target\x20(','dxFdc','a\x20valid\x20subset\x20of\x20the\x20undefined\x20parent\x20allowedAction','umWLs','sNhVO','setHours','SKWrv','znbGd','\x22invocationTarget\x22\x20must\x20be\x20a\x20string\x20that\x20expresses\x20an\x20absolute\x20URI.','UkmyK','WkPMs','verifyResult','should\x20verify\x20chain\x20w/inspectCapabilityChain','VerificationError','tHfVm','YDCyI','TtIXe','FGXNU','kSvQk','should\x20verify\x20invocation','TwoqI','urn:uuid:','eSdMq','KPwWl','exist','neQGs','EjzQp','target\x20w/path','BHlYH','3000-01-01T00:01Z','AiybL','OMDGL','DupKO','wQOUT','equal','hxJVX','LSEJP','zcap','capability\x20must\x20not\x20be\x20less\x20restrictive\x20than\x20its\x20','NxGjV','ybITq','DtgHP','rIagd','AugSp','TfWuY','WQAnG','rhpCX','no\x20`expectedRootCapability`\x20is\x20given','YZapi','delegator','HNrXr','capabilityAction','bexET','eZDZa','hdaOw','lwOZd','root','Onblz','ZcGMo','should\x20fail\x20when\x20missing\x20\x22invocationTarget\x22','eAxQD','fTgHV','XxJLs','Sgbcq','aWMxJ','NUijL','should\x20fail\x20to\x20verify\x20w/inspectCapabilityChain\x20','ZlNLe','should\x20fail\x20to\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20when\x20a\x20','SaOgy','itKAu','vievK','MvVLx','HDbKa','gOaQz','uuPUr','w/inspectCapabilityChain','not','RtaUW','WLgGF','XtHgE','nTHtp','GyqNk','deep','SstMJ','xQNqA','IlbEe','wCgzK','should\x20fail\x20to\x20verify\x20w/delegated\x20zcap\x20created\x20before\x20','PWvgL','54845JlJeyy','uUicC','WWclR','elaVd','should\x20fail\x20to\x20verify\x20a\x20chain\x20','ryOmN','thfsJ','`expectedRootCapability`\x20is\x20not\x20a\x20URI','capability\x20or\x20an\x20object\x20expressing\x20the\x20full\x20parent\x20capability.','WBHVl','should\x20fail\x20invoking\x20a\x20capability\x20with\x20expired\x20','LWhtc','date','The\x20\x22allowedAction\x22\x20in\x20a\x20delegated\x20capability\x20','expected\x20\x22capabilityAction\x22\x20does\x20not\x20match','sgiuZ','ztYHU','is\x20not\x20a\x20valid\x20date.','npeUJ','TADtA','hwAHS','8282152BvlJwp','zXxEp','w/query','BdBZJ','OLbvG','NztmK','nArKw','xixpx','urn:this-should-matter','eldsV','sKgHl','should\x20verify\x20invoking\x20a\x20capability\x20with\x20`expires`','instanceof','OFmYS','NFcNW','XyKFI','should\x20fail\x20to\x20verify\x20a\x20capability\x20with\x20bad\x20`expires`\x20field','parent','vERCl','urn:foo','gHFIH','Llofm','has\x20been\x20revoked.','MhYsu','eyXRO','kEKpH','ogwKQ','esAeO','geCoC','Fpfpx','VGCfx','yonXU','raisE','/sub-path','pDVpe','cOKuj','Chain\x20depth\x20of\x204','wlanX','property','FBTEE','PUKLs','ManKx','soSPL','UWhCE','zwIuH','ubGRp','fWYOg','YQtsO','exampleDocWithInvocation','qeQlK','djmqg','QKcBn','should\x20fail\x20when\x20missing\x20\x22capabilityAction\x22','mhuDE','SeBzb','YmxaP','should\x20fail\x20to\x20verify\x20root\x20capability\x20with\x20`expires`','BrfIz','RWgOK','target\x20w/query','should\x20fail\x20to\x20verify\x20when\x20invoking\x20at\x20an\x20invalid\x20','Uclfk','coXYN','LvPxU','does\x20not\x20match\x20expected\x20root\x20capability','getHours','lHSVl','CDbXA','LuGfw','mOPqz','https://zcap.example/target2','CpIJQ','OTOxB','urn:zcap:ae96f88e-6b8a-4445-9b4f-03f45c3d1685','RUrKp','GZwzz','Txxhy','aPZbP','nSHuk','w/TTL\x20and\x20delegation\x20date\x20monotonicity\x20checks','parent.','EjCdU','true','sMYcQ','jESXa','VGMPR','528DNiAAB','should\x20verify\x20an\x20invoked\x20root\x20capability','UbeuR','required\x20\x22capabilityAction\x22\x20is\x20missing','tmHaq','qULJL','kvfVK','should\x20verify\x20an\x20invoked\x20root\x20capability\x20w/\x20multiple\x20controllers','w/path','GxgME','ZnDsm','xkCWd','https://example.com/edvs/357570f6-8df2-4e78-97dc-42260d64e78e','should\x20fail\x20to\x20verify\x20chain\x20with\x20misreferenced\x20parent\x20','qyAUk','https://example.com/edvs/3e209556-719c-11ec-9a7b-10bf48838a41','xFDHW','urn:zcap:a0d0360b-7e93-4c9c-8804-69ca426c60c3','vllAk','not\x20a\x20valid\x20date','ovdvw','vtQwP','should\x20verify\x20w/array\x20expected\x20target','PflGU','invocationTarget','urn:zcap:2c41869c-95bb-4e23-9bcd-2fbb320bb440','24501IfgiRg','parentCapability','WKtYq','cGbkA','message','xjGFh','should\x20verify\x20invoking\x20','aoKdd','lkJYJ','SYpxE','GxCEF','zwRcf','fdSvm','byVZk','CgdPj','ZhQRm','GLFQI','pjTgU','XzUGs','expires','DWqtq','ADVaz','pIGpJ','should\x20fail\x20to\x20verify\x20chain\x20w/bad\x20last\x20capability','yIJOM','lBtsj','write','xshTk','ZvvrI','bqkbK','urn:other','1432894fGacvq','LeUBg','XKVAi','uNgpP','foo','OVCOy','ksswH','MSloC','UJeaO','JlBjW','BvVwv','PTyfC','FwaxX','oMLUN','fXNVs','Delegated\x20capability\x20must\x20have\x20a\x20valid\x20expires\x20date','urn:zcap:b4840a74-6cc0-11ec-819f-10bf48838a41','bob','bar','should\x20verify\x20a\x20root\x20capability\x20w/\x20separate\x20target\x20when\x20','MBHzu','mupeY','emzXG','Capability\x20controller\x20is\x20itself\x20a\x20verification\x20method','JaCOT','uqVzG','IxzTe','should\x20fail\x20to\x20verify\x20a\x20root\x20capability\x20w/\x20separate\x20target\x20when\x20','match','UaPiW','DSXep','ZelzV','PFPsK','QdEVF','POJnF','the\x20second\x20capability\x20delegation','zcap\x20in\x20chain','iLBKu','nZYaX','mQUtz','rWfYy','delegated\x20in\x20the\x20future','CapabilityInvocation\x20throws\x20TypeError\x20on\x20invalid\x20date','Root\x20capability\x20must\x20not\x20have\x20an\x20\x22expires\x22\x20field.','NgCcS','QJuvx','lJClq','psojk','MLFAQ','sPYNz','urn:zcap:0aee1dd6-646b-11ec-b975-10bf48838a41','The\x20`expires`\x20property\x20in\x20a\x20delegated\x20','should\x20fail\x20to\x20verify\x20chain\x20with\x20attenuation\x20that\x20is\x20more\x20','BKCnQ','Delegated\x20capability\x20must\x20have\x20a\x20valid\x20expires\x20date.','ICemF','cBzLp','should\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20and\x20an\x20','Pqmrv','rVvGN','Httyr','error','restful','IsUnb','wrcIT','ExAIw','QkpzR','should\x20fail\x20to\x20verify\x20chain\x20','UfPOL','MZHjq','CPEGa','invalid\x20date','length','oZMGw','string','HrPQW','WdUOg','FWnlr','xZhqN','https://example.com/edvs/1d7ab048-719c-11ec-b07a-10bf48838a41','damiP','Tdkav','dyUKg','jVuMv','QUZzv','GFxEk','w/inspectCapabilityChain\x20and\x20a\x20revoked\x20capability','Gteqq','smcVn','https://example.com/edvs/83d7e997-d742-4b1a-9033-968f222b9144','nrTcS','LxrKj','lCVZw','consist\x20of\x20strings\x20of\x20capability\x20IDs','IDHiv','4|2|0|3|1|5|6','hKjxT','should\x20verify\x20invoking\x20w/inspectCapabilityChain','USPvB','eDgLl','urn:uuid:fake','xQHwk','OLoFU','urn:uuid:055f47a4-61d3-11ec-9144-10bf48838a41','capabilityDelegation','sJRjW','\x22\x20has\x20been\x20revoked.','diYfI','should\x20verify\x20chain\x20w/path\x20attenuation','Dcfnh','lfPdK','gXdEH','/a-different-specific-document?foo=bar','gPZoQ','Expiration\x20date','ucWvg','YMZWQ','urn:zcap:9ff561b8-0b3f-4bbc-af00-03ba785a7fc6','cvYLu','24266538NIKUmi','KtsSm','ATvjA','lXLHw','vOPkJ','YIjmK','aFOLx','esPCV','IMIdB','ZwJtC','YdGXj','zmdUl','should\x20fail\x20to\x20verify\x20chain\x20w/delegated\x20zcap\x20in\x20the\x20','urn:zcap:1c919b19-baab-45ee-b0ef-24309dfb355d','WoWbN','urn:some:invocation:target','GUrFR','kADhx','jfFOq','biGWp','urn:zcap:bcbcde5e-d64a-4f46-a76e-daf52f63f702','w/invalid\x20allowedAction\x20arrays','should\x20fail\x20to\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20when\x20','kwGVB','qCPvG','should\x20fail\x20to\x20verify\x20a\x20root\x20capability\x20as\x20delegated','a\x20matching\x20`expectedRootCapability`\x20array\x20is\x20given','VCwVH','Tpxtd','ENmxw','rgJou','TZpZw','proof','tlIaj','should\x20fail\x20to\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202\x20when\x20an\x20','XOAJV','rOtNl','mWumI','jQNCc','MfyZP','should\x20fail\x20to\x20verify\x20when\x20invoking\x20at\x20an\x20unexpected\x20','RIQgU','should\x20verify\x20a\x20capability\x20chain\x20of\x20depth\x202','HYJEK','FPYUE','sBOGU','TypeError','PpThH','capabilityInvocation','should\x20fail\x20invoking\x20','zxJxc','SaVQE','maxFp','6|0|2|5|7|3|1|4','YWUoh','VRZcR','syjFX','SJMCw','boiHP','Lotur','qWkeL','zJHbV','HYTSU','Rhhku','PWdoF','QXYnD','vUjun','delegated\x20capability\x20must\x20not\x20be\x20less\x20restrictive','kyOEI','array','should\x20verify\x20invoking\x20a\x20capability\x20chain\x20of\x20depth\x202\x20and\x20a\x20','UVKVa','AdzuV','JQWeo','should\x20fail\x20to\x20verify\x20w/delegated\x20zcap\x20with\x20no\x20expiration\x20','zxOid','HwUhx','XGxCy','read','a\x20valid\x20subset\x20of\x20the\x20parent\x20allowedAction\x20array','kGTaH','OluBb','should\x20verify\x20chain\x20when\x20child\x20allowedAction\x20is\x20','delegated\x20zcap','sign','ToWcW','MNfRo','GFkvh','221774vHgBFI','kKxKO','nfPYN','zXjek','\x22write\x22\x20expected\x20action','CapabilityDelegation\x20throws\x20TypeError\x20on\x20invalid\x20date','tuZNC','LOjzd','EySnI','BNgIk','urn:zcap:cbddee5a-09fb-44db-a921-70c36436c253','RPbmm','NotFoundError','vaWEh','verified','stringify','eHhuU',')\x20does\x20not\x20match\x20capability\x20','\x22capabilityAction\x22\x20is\x20not\x20in\x20\x22allowedAction\x22','null','IebBW','should\x20verify\x20two\x20invocation\x20proofs\x20on\x20the\x20same\x20doc','rdbzG','fevYs','vENLp','ReFpM','w/delegated\x20zcap\x20with\x20a\x20TTL\x20that\x20is\x20too\x20long','Utims','aeGUn','cSBLa','flrPJ','BMBvF','and\x20`date`\x20parameter\x20in\x20the\x20future','SUepg','pznHv','kaqnR','2018-02-13T21:26:08Z','BwltG','KhQOm','should\x20fail\x20invoking\x20a\x20capability\x20with\x20`expires`\x20','iKmiV','GXxYf','mnKBn','should\x20verify\x20a\x20root\x20zcap\x20w/\x20multiple\x20controllers','GCWqi','IJXqq','yvMwL','KIpor','xwqBA','zyWNB','bBZdY','yyodH','Mafze','hUIuk','mMrcD','revoked','kKxuT','QksDZ','mVuLt','avPji','urn:uuid:1aaec12f-bcf2-40d8-8192-cc4dde9bca96','carol','should\x20fail\x20invoking\x20a\x20capability\x20with\x20','VEWKF','MBEoJ','wHAqR','yVhCK','NxRyz','qgqGf','QETZa','RYzAu','UPPbY','tenmc','IuPST','czPqW','qDFlA','RvbTo','TEoLf','should\x20verify\x20when\x20invoking\x20at\x20a\x20valid\x20sub\x20target\x20','YckOF','should\x20verify\x20invoking\x20a\x20capability\x20chain\x20of\x20depth\x202','rAvhC','errors','LdNUj','QUBtw','false','contain','UiXvM','w/invalid\x20allowedAction\x20strings','NLHGi','BZKgK','xdRxR','ctkqr','FTHqK','now','akQXo','ZwTWH','should\x20succeed\x20when\x20passing\x20only\x20\x22parentCapability\x22','Error','The\x20capability\x20chain\x20exceeds\x20the\x20maximum\x20allowed\x20length\x20of\x202.','Ebdcd','permissive\x20than\x20the\x20parent\x20capability\x20w/query','ltbXb','IGtFW','PRSPn','alice','rQymB','KFXUQ','cfjSV','target\x20(','PbmRh','dWGjZ','GutFL','pvoLF','parse','Lkase','pflga','HVQwr','&baz=fuzz','zenEM','and\x20`date`\x20parameter\x20in\x20the\x20past','getTime','JJzBR','XkqPj','gyPLk','urn:zcap:142b0b4a-c664-4288-84e6-be0a59b6efa4','YrVhj','urn:zcap:d3e905ba-6430-11ec-beae-10bf48838a41','delegated','capability\x20that\x20expires\x20on\x20the\x20Unix\x20epoch','include','?foo=bar','get','vtOvW','should\x20succeed\x20w/key\x20invoker','qtmCS','lZQPk','qTVvr','entries','should\x20verify\x20a\x20invoking\x20root\x20capability\x20w/\x20separate\x20target\x20when\x20','Yjyya','epdaf','4|3|7|0|2|5|6|1','TbhCl','ZcNmC','should\x20verify\x20chain','EskOX','pbnfh','YmxjX','fZeUn','kNTXL','HkxbB','PeqWk','eDPkt','luLpa','YVoCc','bPapo','zitsq','have','HXKsi','TBsmd','aWFQr','192DwufEu','GwlhW','/a-specific-document?foo=bar','teVob','tCXoZ','GrcIv','VMBBP','should','oYmyZ','WWVkk','should\x20succeed','MqRkl','mJYvS','tzEvq','delegation\x20proof\x20\x22created\x22\x20date','UedLe','yOgOS','VkTii','QqwNW','nAOZc','HAbAh','SLsWo','AVErk','urn:zcap:6286a906-619b-4f5b-a8ae-af9fb774b070','aVssw','mHpjT','ySLLl','tlENh','IOWml','QRvYS','MmDmH','must\x20be\x20equivalent\x20to\x20its\x20parent','bHevd','jUXLw','Oxsbz','FNgRy','cfZab','Jepmv'];_0x41df=function(){return _0x3d9971;};return _0x41df();}