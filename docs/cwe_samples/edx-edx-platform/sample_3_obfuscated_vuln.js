const _0x276bc3=_0x4150;(function(_0x2cee99,_0x1a9126){const _0x687690=_0x4150,_0x1a1f70=_0x2cee99();while(!![]){try{const _0x16e169=-parseInt(_0x687690(0x18b))/0x1*(parseInt(_0x687690(0x172))/0x2)+-parseInt(_0x687690(0x149))/0x3+parseInt(_0x687690(0x160))/0x4*(-parseInt(_0x687690(0x16f))/0x5)+-parseInt(_0x687690(0x183))/0x6*(parseInt(_0x687690(0x14f))/0x7)+-parseInt(_0x687690(0x17d))/0x8*(-parseInt(_0x687690(0x166))/0x9)+parseInt(_0x687690(0x180))/0xa+parseInt(_0x687690(0x195))/0xb;if(_0x16e169===_0x1a9126)break;else _0x1a1f70['push'](_0x1a1f70['shift']());}catch(_0x23721a){_0x1a1f70['push'](_0x1a1f70['shift']());}}}(_0x1f33,0x91fef));import{CapabilityDelegation}from'./CapabilityDelegation.js';function _0x4150(_0x1eaddb,_0x3342e6){const _0x1f33d8=_0x1f33();return _0x4150=function(_0x41506f,_0x1c4a11){_0x41506f=_0x41506f-0x142;let _0x23644d=_0x1f33d8[_0x41506f];return _0x23644d;},_0x4150(_0x1eaddb,_0x3342e6);}import{CapabilityProofPurpose}from'./CapabilityProofPurpose.js';import*as _0x13b247 from'./utils.js';function _0x1f33(){const _0x3baedb=['12DjcvEz','map','getTime','LfkVO','ogbqF','getTarget','72xegGbD','isArray','nOSQr','getDelegationProofs','parentCapability','split','date\x20in\x20its\x20delegation\x20proof.','created','\x22expectedTargets\x22\x20values\x20must\x20be\x20absolute\x20URI\x20strings.','1751975YdPMRC',')\x20does\x20not\x20match\x20','invocation\x20target\x20(','2iwZAFa','controller','getAllowedActions','wYWUz','_runChecksAfterChainVerification','isController','waDUd','DfTHj','WBJUX','\x22capability\x22\x20must\x20be\x20a\x20string\x20if\x20it\x20is\x20a\x20root\x20capability.','URI.','927464yIymUP','SbHkK','PcOcG','8485300pvcbfr','tVowP','XZIZR','14088PqraTU','capability;\x20allowed\x20actions\x20are:\x20','5|2|0|1|3|4','capabilityInvocation','DKALP','mgsJp','includes',')\x20must\x20be\x20a\x20string\x20that\x20','24541dBanAp','string','proofPurpose','Capability\x20action\x20\x22','invocationTarget','_runBaseProofValidation','expectedTarget','wIvjN','\x22expectedTarget\x22\x20must\x20be\x20a\x20string\x20or\x20array.','juBZV','7909781mjiGFF','The\x20capability\x20controller\x20does\x20not\x20match\x20the\x20verification\x20method\x20','length','Parameters\x20for\x20both\x20creating\x20and\x20verifying\x20a\x20proof\x20must\x20not\x20be\x20','expresses\x20an\x20absolute\x20URI.','capability\x20target\x20(','Invocation\x20target\x20(','join','capabilityAction','LCeuj','TzFwO','VMKbN','773460NAznQc','OBric','parse','capability','details','quxvP','1680vusckA','invoker','update','isValidTarget','(or\x20its\x20controller)\x20used\x20to\x20invoke.','\x22capabilityAction\x22\x20must\x20be\x20a\x20string.','_getCapabilityDelegationClass','\x22\x20does\x20not\x20match\x20the\x20','expected\x20action\x20of\x20\x22','valid','acxlv','Expected\x20target\x20(','azmpy','kTdWt','\x22expectedAction\x22\x20must\x20be\x20a\x20string.','match','expires'];_0x1f33=function(){return _0x3baedb;};return _0x1f33();}export class CapabilityInvocation extends CapabilityProofPurpose{constructor({capability:_0x175a57,capabilityAction:_0x4136d1,invocationTarget:_0x4c6cb2,allowTargetAttenuation:_0x3b9989,controller:_0x27fb19,date:_0x287e56,expectedAction:_0x24ae92,expectedRootCapability:_0x1d41e0,expectedTarget:_0x3d969a,inspectCapabilityChain:_0x3b3115,maxChainLength:_0x209729,maxClockSkew:_0x4826bd,maxDelegationTtl:_0x1df142,maxTimestampDelta:_0x5c2a41,suite:_0x2c1400}={}){const _0x4b8ebc=_0x4150,_0x3524aa={'gwyRr':function(_0x1bd62b,_0x34ff02){return _0x1bd62b||_0x34ff02;},'quxvP':function(_0x3d08bf,_0x450250){return _0x3d08bf&&_0x450250;},'mgsJp':_0x4b8ebc(0x198),'SRHbl':_0x4b8ebc(0x185),'WBJUX':_0x4b8ebc(0x18c),'juBZV':_0x4b8ebc(0x17c),'bOyZb':function(_0xed4e26,_0x4a79fd){return _0xed4e26!==_0x4a79fd;},'OBric':'\x22capability\x22\x20must\x20be\x20a\x20string\x20or\x20object.','acxlv':function(_0x21f037,_0x24d68a){return _0x21f037!==_0x24d68a;},'waDUd':function(_0x5cac27,_0x2aa310){return _0x5cac27===_0x2aa310;},'SbHkK':_0x4b8ebc(0x15c),'LCeuj':'\x22expectedTarget\x22\x20must\x20be\x20a\x20string\x20or\x20array.','DKALP':_0x4b8ebc(0x16e)},_0x462275=_0x3524aa['gwyRr'](_0x175a57,_0x4136d1)||_0x4c6cb2,_0x1cc787=_0x27fb19||_0x287e56||_0x24ae92||_0x1d41e0||_0x3d969a||_0x3b3115||_0x2c1400;if(_0x3524aa[_0x4b8ebc(0x14e)](_0x462275,_0x1cc787))throw new Error(_0x3524aa[_0x4b8ebc(0x188)]+'provided\x20together.');super({'allowTargetAttenuation':_0x3b9989,'controller':_0x27fb19,'date':_0x287e56,'expectedRootCapability':_0x1d41e0,'inspectCapabilityChain':_0x3b3115,'maxChainLength':_0x209729,'maxClockSkew':_0x4826bd,'maxDelegationTtl':_0x1df142,'maxTimestampDelta':_0x5c2a41,'suite':_0x2c1400,'term':_0x4b8ebc(0x186)});if(!_0x1cc787){const _0x512715=_0x3524aa['SRHbl'][_0x4b8ebc(0x16b)]('|');let _0x3c415d=0x0;while(!![]){switch(_0x512715[_0x3c415d++]){case'0':if(!(typeof _0x4c6cb2===_0x3524aa[_0x4b8ebc(0x17a)]&&_0x4c6cb2['includes'](':')))throw new TypeError('\x22invocationTarget\x22\x20must\x20be\x20a\x20string\x20that\x20expresses\x20an\x20absolute\x20'+_0x3524aa[_0x4b8ebc(0x194)]);continue;case'1':this[_0x4b8ebc(0x14c)]=_0x175a57;continue;case'2':if(_0x3524aa['bOyZb'](typeof _0x4136d1,_0x3524aa[_0x4b8ebc(0x17a)]))throw new TypeError(_0x4b8ebc(0x154));continue;case'3':this[_0x4b8ebc(0x145)]=_0x4136d1;continue;case'4':this[_0x4b8ebc(0x18f)]=_0x4c6cb2;continue;case'5':if(typeof _0x175a57==='object'){if(!(_0x175a57&&_0x175a57[_0x4b8ebc(0x16a)]))throw new Error(_0x4b8ebc(0x17b));}else{if(typeof _0x175a57!==_0x3524aa[_0x4b8ebc(0x17a)])throw new TypeError(_0x3524aa[_0x4b8ebc(0x14a)]);}continue;}break;}}else{if(_0x3524aa[_0x4b8ebc(0x159)](typeof _0x24ae92,_0x3524aa['WBJUX']))throw new TypeError(_0x4b8ebc(0x15d));if(!(_0x3524aa[_0x4b8ebc(0x178)](typeof _0x3d969a,_0x3524aa[_0x4b8ebc(0x17a)])||Array['isArray'](_0x3d969a))){if(_0x4b8ebc(0x15c)!==_0x3524aa[_0x4b8ebc(0x17e)]){const {capability:_0x33c38c,capabilityAction:_0x345b6e,invocationTarget:_0xb9417b}=this;return _0x44e7a2[_0x4b8ebc(0x18d)]=this['term'],_0x25550e[_0x4b8ebc(0x14c)]=_0x33c38c,_0x35a647[_0x4b8ebc(0x18f)]=_0xb9417b,_0x58e150[_0x4b8ebc(0x145)]=_0x345b6e,_0xdc502a;}else throw new TypeError(_0x3524aa[_0x4b8ebc(0x146)]);}const _0x175481=Array[_0x4b8ebc(0x167)](_0x3d969a)?_0x3d969a:[_0x3d969a];for(const _0x595205 of _0x175481){if(!(typeof _0x595205===_0x3524aa[_0x4b8ebc(0x17a)]&&_0x595205[_0x4b8ebc(0x189)](':')))throw new Error(_0x3524aa[_0x4b8ebc(0x187)]);}this[_0x4b8ebc(0x191)]=_0x3d969a,this['expectedAction']=_0x24ae92;}}async[_0x276bc3(0x151)](_0x3f6dd6){const _0x8d5327=_0x276bc3,{capability:_0x47ac39,capabilityAction:_0x1c52ef,invocationTarget:_0x549006}=this;return _0x3f6dd6[_0x8d5327(0x18d)]=this['term'],_0x3f6dd6[_0x8d5327(0x14c)]=_0x47ac39,_0x3f6dd6[_0x8d5327(0x18f)]=_0x549006,_0x3f6dd6[_0x8d5327(0x145)]=_0x1c52ef,_0x3f6dd6;}async[_0x276bc3(0x15e)](_0x150225,{document:_0x4fdfd7,documentLoader:_0x555cbf}){const _0x1c608d=_0x276bc3,_0xf98ecf={'azmpy':_0x1c608d(0x193),'cBHxj':'tFjSq','wIvjN':_0x1c608d(0x182)},{expectedAction:_0x42ff11,expectedTarget:_0x734ea3}=this;try{_0x13b247['checkProofContext']({'proof':_0x150225});}catch(_0x289184){return![];}if(!_0x150225[_0x1c608d(0x14c)])return![];if(!(await super[_0x1c608d(0x15e)](_0x150225,{'document':_0x4fdfd7,'documentLoader':_0x555cbf})&&_0x42ff11===_0x150225[_0x1c608d(0x145)])){if(_0xf98ecf['cBHxj']!==_0xf98ecf[_0x1c608d(0x192)])return![];else throw new _0x203276(_0xf98ecf[_0x1c608d(0x15b)]);}if(Array['isArray'](_0x734ea3))return _0x734ea3['includes'](_0x150225[_0x1c608d(0x18f)]);return _0x734ea3===_0x150225[_0x1c608d(0x18f)];}[_0x276bc3(0x155)](){return CapabilityDelegation;}['_getTailCapability']({proof:_0x35f2da}){const _0x2e5a03=_0x276bc3;return{'capability':_0x35f2da[_0x2e5a03(0x14c)]};}async['_runChecksBeforeChainVerification']({dereferencedChain:_0x288698,proof:_0x5c40e8}){const _0xcd28f3=_0x276bc3,_0x465475={'nOSQr':function(_0x2d9389,_0x4f1522){return _0x2d9389+_0x4f1522;},'LfkVO':function(_0x9b6385,_0x597ba4){return _0x9b6385+_0x597ba4;},'fYAtd':function(_0xb4b652,_0x5a8917){return _0xb4b652!==_0x5a8917;},'wYWUz':function(_0x146b6c,_0x58c8c0){return _0x146b6c+_0x58c8c0;},'tVowP':function(_0x230a6b,_0x7a9810){return _0x230a6b+_0x7a9810;},'ginWp':'A\x20delegated\x20capability\x20must\x20not\x20be\x20invoked\x20before\x20the\x20\x22created\x22\x20'},{allowTargetAttenuation:_0x1d3c02,expectedAction:_0x27e755,expectedTarget:_0x5cd449}=this,_0x191f27=_0x288698[_0x288698[_0xcd28f3(0x197)]-0x1],{capabilityAction:_0x571d9d}=_0x5c40e8,_0x8a75eb=_0x13b247[_0xcd28f3(0x174)]({'capability':_0x191f27});if(_0x8a75eb['length']>0x0&&!_0x8a75eb[_0xcd28f3(0x189)](_0x571d9d))throw new Error(_0x465475[_0xcd28f3(0x168)](_0x465475[_0xcd28f3(0x163)](_0xcd28f3(0x18e)+_0x571d9d+'\x22\x20is\x20not\x20allowed\x20by\x20the\x20',_0xcd28f3(0x184)),_0x8a75eb[_0xcd28f3(0x161)](_0x2b86bd=>'\x22'+_0x2b86bd+'\x22')[_0xcd28f3(0x144)](',\x20')));if(_0x465475['fYAtd'](_0x571d9d,_0x27e755))throw new Error(_0x465475[_0xcd28f3(0x175)](_0xcd28f3(0x18e)+_0x571d9d+_0xcd28f3(0x156),_0xcd28f3(0x157)+_0x27e755+'\x22.'));const _0xed3ce2=_0x13b247[_0xcd28f3(0x165)]({'capability':_0x191f27}),{invocationTarget:_0x5679d3}=_0x5c40e8;if(!(typeof _0x5679d3===_0xcd28f3(0x18c)&&_0x5679d3[_0xcd28f3(0x189)](':')))throw new TypeError(_0xcd28f3(0x143)+_0x5679d3+_0xcd28f3(0x18a)+_0xcd28f3(0x199));if(!_0x13b247[_0xcd28f3(0x152)]({'invocationTarget':_0x5679d3,'baseInvocationTarget':_0xed3ce2,'allowTargetAttenuation':_0x1d3c02}))throw new Error(_0x465475[_0xcd28f3(0x181)](_0xcd28f3(0x143)+_0x5679d3+_0xcd28f3(0x170),_0xcd28f3(0x142)+_0xed3ce2+').'));if(!(Array[_0xcd28f3(0x167)](_0x5cd449)&&_0x5cd449[_0xcd28f3(0x189)](_0x5679d3)||typeof _0x5cd449===_0xcd28f3(0x18c)&&_0x5679d3===_0x5cd449))throw new Error(_0xcd28f3(0x15a)+_0x5cd449+_0xcd28f3(0x170)+(_0xcd28f3(0x171)+_0x5679d3+').'));if(_0x191f27[_0xcd28f3(0x16a)]){const _0xd9a629=Date[_0xcd28f3(0x14b)](_0x5c40e8['created']),[_0x2519cd]=_0x13b247[_0xcd28f3(0x169)]({'capability':_0x191f27}),_0x4efb29=Date['parse'](_0x2519cd[_0xcd28f3(0x16d)]),{maxClockSkew:_0x427327}=this;if(_0x13b247['compareTime']({'t1':_0xd9a629,'t2':_0x4efb29,'maxClockSkew':_0x427327})<0x0)throw new Error(_0x465475['ginWp']+_0xcd28f3(0x16c));}return{'capabilityChainMeta':[]};}async[_0x276bc3(0x176)]({dereferencedChain:_0x2d3626,proof:_0x4bd53e,validateOptions:_0x59c8b5}){const _0x3f55d5=_0x276bc3,_0x4846da={'PcOcG':function(_0x575903,_0x4220d8){return _0x575903-_0x4220d8;},'VMKbN':function(_0x261ab3,_0x44b510){return _0x261ab3+_0x44b510;},'ogbqF':function(_0xb1615,_0x52777a){return _0xb1615!==_0x52777a;},'TzFwO':_0x3f55d5(0x179)},_0x4b058f=_0x2d3626[_0x4846da[_0x3f55d5(0x17f)](_0x2d3626[_0x3f55d5(0x197)],0x1)],{verificationMethod:_0x224ef4}=_0x59c8b5;if(!_0x13b247[_0x3f55d5(0x177)]({'capability':_0x4b058f,'verificationMethod':_0x224ef4})){const _0x302475=new Error(_0x4846da[_0x3f55d5(0x148)](_0x3f55d5(0x196),_0x3f55d5(0x153)));_0x302475[_0x3f55d5(0x14d)]={'capability':_0x4b058f,'verificationMethod':_0x224ef4};throw _0x302475;}if(_0x4b058f[_0x3f55d5(0x16a)]){const _0x4be6d9=Date[_0x3f55d5(0x14b)](_0x4b058f[_0x3f55d5(0x15f)]),{date:_0x14bd9a,maxClockSkew:_0x2e16cf}=this,_0x6b87cb=_0x14bd9a&&new Date(_0x14bd9a)||new Date();if(_0x13b247['compareTime']({'t1':_0x6b87cb[_0x3f55d5(0x162)](),'t2':_0x4be6d9,'maxClockSkew':_0x2e16cf})>0x0)throw new Error('The\x20invoked\x20capability\x20has\x20expired.');}const _0xf60ed3=await this[_0x3f55d5(0x190)]({'proof':_0x4bd53e,'validateOptions':_0x59c8b5});if(!_0xf60ed3[_0x3f55d5(0x158)]){if(_0x4846da[_0x3f55d5(0x164)](_0x3f55d5(0x179),_0x4846da[_0x3f55d5(0x147)]))throw new _0x1379ab(_0x3f55d5(0x143)+_0xff3f16+')\x20must\x20be\x20a\x20string\x20that\x20'+_0x3f55d5(0x199));else throw _0xf60ed3['error'];}return _0xf60ed3[_0x3f55d5(0x150)]=_0xf60ed3[_0x3f55d5(0x173)],_0xf60ed3;}}