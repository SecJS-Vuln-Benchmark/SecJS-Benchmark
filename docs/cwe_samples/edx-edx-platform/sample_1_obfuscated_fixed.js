(function(_0x65eaaf,_0x318af7){const _0xf456f4=_0x3d33,_0x1d03e7=_0x65eaaf();while(!![]){try{const _0x135604=parseInt(_0xf456f4(0x225))/0x1*(parseInt(_0xf456f4(0x209))/0x2)+-parseInt(_0xf456f4(0x1e4))/0x3*(-parseInt(_0xf456f4(0x1f4))/0x4)+parseInt(_0xf456f4(0x1c1))/0x5+-parseInt(_0xf456f4(0x221))/0x6*(-parseInt(_0xf456f4(0x1e6))/0x7)+parseInt(_0xf456f4(0x1b2))/0x8*(parseInt(_0xf456f4(0x1a9))/0x9)+-parseInt(_0xf456f4(0x1ae))/0xa+-parseInt(_0xf456f4(0x19e))/0xb*(parseInt(_0xf456f4(0x1fc))/0xc);if(_0x135604===_0x318af7)break;else _0x1d03e7['push'](_0x1d03e7['shift']());}catch(_0x2d288c){_0x1d03e7['push'](_0x1d03e7['shift']());}}}(_0x4aff,0xd623c));import{MAX_CHAIN_LENGTH,ZCAP_CONTEXT_URL,ZCAP_ROOT_PREFIX}from'./constants.js';export function createRootCapability({controller:_0x20fe40,invocationTarget:_0x1236f5}){return{'@context':ZCAP_CONTEXT_URL,'id':''+ZCAP_ROOT_PREFIX+encodeURIComponent(_0x1236f5),'controller':_0x20fe40,'invocationTarget':_0x1236f5};}export function getControllers({capability:_0xa690b8}){const _0x4a98bc=_0x3d33,{controller:_0x54fc4e}=_0xa690b8;if(!_0x54fc4e)throw new Error(_0x4a98bc(0x217));return Array['isArray'](_0x54fc4e)?_0x54fc4e:[_0x54fc4e];}export function isController({capability:_0x1201f0,verificationMethod:_0x5d768b}){const _0x4df3b9=_0x3d33,_0x418ad6={'krXRv':function(_0x38b811,_0x48b077){return _0x38b811(_0x48b077);}},_0x5e09a1=_0x418ad6[_0x4df3b9(0x1dd)](getControllers,{'capability':_0x1201f0});return _0x5e09a1[_0x4df3b9(0x1f0)](_0x5d768b[_0x4df3b9(0x1d9)])||_0x5e09a1[_0x4df3b9(0x1f0)](_0x5d768b['id']);}function _0x4aff(){const _0x33fb94=['ozrfI','Delegated\x20capability\x20must\x20have\x20a\x20\x22parentCapability\x22\x20with\x20a\x20string\x20','tlHKc','Cannot\x20compute\x20capability\x20chain;\x20parent\x20capability\x20is\x20invalid;\x20it\x20is\x20','push','Cannot\x20compute\x20capability\x20chain;\x20parent\x20capability\x20is\x20invalid;\x20it\x20','of\x20','every','edaFh','set','WICmg','delegated,\x20in\x20which\x20case\x20it\x20must\x20be\x20an\x20object\x20with\x20an\x20\x22id\x22\x20','PqCpw','vQEbG','controller','jmUKe','OJFaC','QcNmV','krXRv','vBcas','Capability\x20must\x20have\x20an\x20\x22id\x22\x20with\x20a\x20string\x20value\x20that\x20expresses\x20an\x20','bmTUu','ZSvro','lZfFI','ajTOo','5787QwHXBT','has','846349AzPtdD','cMNhv','SxrLA','QTUqV','Cannot\x20get\x20capability\x20chain;\x20capability\x20is\x20invalid;\x20it\x20does\x20not\x20have\x20','get','urfPH','GwFNr','ATHSj','cCjON','includes','chSRq','BLLFL','match\x20reference\x20ID\x20\x22','164wIuCKA','kjiwF','be\x20an\x20object\x20with\x20an\x20\x22id\x22\x20property\x20that\x20is\x20a\x20string.','non-empty\x20array.','XnqTD','Cannot\x20compute\x20capability\x20chain;\x20parent\x20capability\x20chain\x20is\x20','Delegated\x20capability\x20must\x20have\x20a\x20\x22proof\x22.','Missing\x20required\x20capability\x20proof\x20context\x20(\x22','228qyWomI','RofRJ','qvZQJ','length','NETZR','nLrDg','The\x20capability\x20chain\x20is\x20inconsistent.','values','Delegated\x20capability\x20must\x20have\x20a\x20valid\x20expires\x20date.','Capability\x20must\x20have\x20an\x20\x22invocationTarget\x22\x20with\x20a\x20string\x20value\x20that\x20','JiPzt','created','OUeBB','272uSKAjT','the\x20last\x20capability\x20if\x20it\x20is\x20delegated,\x20in\x20which\x20case\x20it\x20must\x20','KgdZL','VtCRY','CvBzF','isArray','parse','xgjjI','root\x20capability\x20yet\x20it\x20does\x20not\x20have\x20exactly\x20one\x20delegation\x20proof.','lpdiN','vanNN','proof','rpqqO','cHgDP','Capability\x20controller\x20not\x20found.','\x22\x20to\x20be\x20delegated\x20but\x20it\x20is\x20root.','expresses\x20an\x20absolute\x20URI.','hqTQT','kMAFr','Root\x20capability\x20must\x20not\x20have\x20an\x20\x22expires\x22\x20field.','Cannot\x20get\x20capability\x20chain;\x20capability\x20is\x20invalid;\x20it\x20is\x20not\x20the\x20','RSNCM','object','GhEMB','6eUPOQC','a\x20\x22capabilityChain\x22\x20array\x20in\x20its\x20delegation\x20proof.','If\x20present\x20on\x20a\x20capability,\x20\x22allowedAction\x22\x20must\x20be\x20a\x20string\x20or\x20a\x20','vfVFu','7034VhcfNN','slice','uhAuK','ecjDz','ONiqE','hCKUe','IwteZ','zVXGe','SJjwM','property\x20that\x20is\x20a\x20string.','uHPBv','match\x20the\x20parent\x20capability.','startsWith','zpgrx','hfCcd','NxwRo','proofPurpose','Capability\x20chain\x20is\x20invalid;\x20it\x20contains\x20a\x20capability\x20ID\x20','1315974VSpoas','DvPzF','nXFjA','parentCapability','vybvB','does\x20not\x20have\x20a\x20\x22capabilityChain\x22\x20array\x20in\x20its\x20delegation\x20proof.','OOUaX','expires','ojpbZ','LHtwK','\x22\x20to\x20be\x20root\x20','9wsnPZZ','filter','string','entries','Bgnoi','10403370lkwwUa','absolute\x20URI.','rcsNE','uGvuE','13424144fpdaSQ','Capability\x20chain\x20is\x20invalid;\x20the\x20last\x20entry\x20does\x20not\x20','but\x20it\x20is\x20delegated.','rqjjK','EFfwR','SetzX','Delegated\x20capability\x20must\x20have\x20a\x20valid\x20proof\x20\x22created\x22\x20date.','The\x20capability\x20chain\x20contains\x20a\x20cycle.','yimnC','nzjrA','TpjPN','Dereferenced\x20root\x20capability\x20ID\x20\x22','Root\x20capability\x20must\x20have\x20an\x20\x22@context\x22\x20value\x20of\x20','with\x20\x22','\x22\x20in\x20its\x20first\x20position.','6779305UskHWk','\x22\x20does\x20not\x20','of\x20capability\x20IDs\x20except\x20the\x20last\x20capability\x20if\x20it\x20is\x20','NUsFa','abs','GdVsq','Wmsks','MQnZb','Hcshu','Expected\x20capability\x20\x22'];_0x4aff=function(){return _0x33fb94;};return _0x4aff();}export function getAllowedActions({capability:_0x3ee760}){const _0x1ddd61=_0x3d33,_0x4ee219={'BLLFL':function(_0x416f11,_0x130e3e){return _0x416f11+_0x130e3e;},'zpgrx':_0x1ddd61(0x1a3),'OUeBB':function(_0x230fed,_0x1fa4c5){return _0x230fed!==_0x1fa4c5;}},{allowedAction:_0x2cd36d}=_0x3ee760;if(!_0x2cd36d)return[];if(Array[_0x1ddd61(0x20e)](_0x2cd36d)){if(_0x4ee219[_0x1ddd61(0x208)](_0x1ddd61(0x22d),_0x1ddd61(0x1a2)))return _0x2cd36d;else throw new _0x41db98(_0x4ee219[_0x1ddd61(0x1f2)](_0x1ddd61(0x1d0),_0x4ee219[_0x1ddd61(0x232)]));}return[_0x2cd36d];}export function getTarget({capability:_0x26e21e}){return _0x26e21e['invocationTarget'];}export function getDelegationProofs({capability:_0x4ef2fe}){const _0x413f7c=_0x3d33,_0x524cac={'WICmg':_0x413f7c(0x233)};if(!_0x4ef2fe[_0x413f7c(0x1a1)]||!_0x4ef2fe[_0x413f7c(0x214)])return[];let {proof:_0x171674}=_0x4ef2fe;if(!Array[_0x413f7c(0x20e)](_0x171674)){if(_0x524cac[_0x413f7c(0x1d5)]!==_0x413f7c(0x20b))_0x171674=[_0x171674];else return!![];}return _0x171674[_0x413f7c(0x1aa)](_0x1b4b4e=>_0x1b4b4e&&_0x1b4b4e[_0x413f7c(0x19c)]==='capabilityDelegation');}export function getCapabilityChain({capability:_0x12e44a}){const _0x101ec2=_0x3d33,_0x27ca1d={'XnqTD':function(_0x1cb80f,_0x3d2f7b){return _0x1cb80f(_0x3d2f7b);},'kMAFr':function(_0x4b69bc,_0xce43e1){return _0x4b69bc+_0xce43e1;},'KfjRi':_0x101ec2(0x21d),'RofRJ':_0x101ec2(0x211),'DvPzF':_0x101ec2(0x1ea),'aXDfH':_0x101ec2(0x222)};if(!_0x12e44a[_0x101ec2(0x1a1)])return[];const _0x24ec7f=_0x27ca1d[_0x101ec2(0x1f8)](getDelegationProofs,{'capability':_0x12e44a});if(_0x24ec7f['length']!==0x1)throw new Error(_0x27ca1d[_0x101ec2(0x21b)](_0x27ca1d['KfjRi'],_0x27ca1d[_0x101ec2(0x1fd)]));const {capabilityChain:_0x209762}=_0x24ec7f[0x0];if(!(_0x209762&&Array['isArray'](_0x209762)))throw new Error(_0x27ca1d[_0x101ec2(0x19f)]+_0x27ca1d['aXDfH']);return _0x209762[_0x101ec2(0x226)]();}export function isValidTarget({invocationTarget:_0x28920b,baseInvocationTarget:_0x113915,allowTargetAttenuation:_0x1bb280}){const _0x9cd4ad=_0x3d33,_0x225768={'QcNmV':function(_0x49052d,_0x1c7f6f){return _0x49052d===_0x1c7f6f;}};if(_0x225768[_0x9cd4ad(0x1dc)](_0x113915,_0x28920b))return!![];if(_0x1bb280){const _0x2e8900=[];_0x113915['includes']('?')?_0x2e8900[_0x9cd4ad(0x1cf)](_0x113915+'&'):(_0x2e8900[_0x9cd4ad(0x1cf)](_0x113915+'/'),_0x2e8900['push'](_0x113915+'?'));if(_0x2e8900['some'](_0x43c42b=>_0x28920b[_0x9cd4ad(0x231)](_0x43c42b)))return!![];}return![];}export function computeCapabilityChain({parentCapability:_0x12303c,_skipLocalValidationForTesting:_0x973ec2}){const _0x2ca6fb=_0x3d33,_0x519bbd={'uhAuK':function(_0x1b09d2,_0x114b54){return _0x1b09d2(_0x114b54);},'KQWcr':function(_0x236284,_0x59b565){return _0x236284!==_0x59b565;},'ojpbZ':function(_0x295f47,_0x3d94b5){return _0x295f47+_0x3d94b5;},'PqCpw':'proof.','vQEbG':_0x2ca6fb(0x1d0),'YiMfr':'does\x20not\x20have\x20a\x20\x22capabilityChain\x22\x20array\x20in\x20its\x20delegation\x20proof.','vanNN':function(_0x5b2227,_0x8dfaf2){return _0x5b2227>_0x8dfaf2;},'OOUaX':_0x2ca6fb(0x21f),'cCjON':_0x2ca6fb(0x1ab),'SetzX':function(_0x2cb6d4,_0x330348){return _0x2cb6d4-_0x330348;},'ZSvro':function(_0x297571,_0x116441){return _0x297571===_0x116441;},'byfpI':function(_0xdca3a2,_0xc7ec0b){return _0xdca3a2+_0xc7ec0b;},'lpdiN':_0x2ca6fb(0x1f9),'BrivN':_0x2ca6fb(0x20a),'rcsNE':function(_0x1131c7,_0x2e0e1b){return _0x1131c7!==_0x2e0e1b;},'IwteZ':_0x2ca6fb(0x210),'ScPQz':'nrsPw'},_0x479ec0=typeof _0x12303c;if(_0x479ec0===_0x2ca6fb(0x1ab))return[_0x12303c];if(!_0x12303c[_0x2ca6fb(0x1a1)])return checkCapability({'capability':_0x12303c,'expectRoot':!![]}),[_0x12303c['id']];_0x519bbd[_0x2ca6fb(0x227)](checkCapability,{'capability':_0x12303c,'expectRoot':![]});const _0x4fea36=getDelegationProofs({'capability':_0x12303c});if(_0x519bbd['KQWcr'](_0x4fea36[_0x2ca6fb(0x1ff)],0x1))throw new Error(_0x519bbd[_0x2ca6fb(0x1a6)](_0x2ca6fb(0x1ce),'not\x20the\x20root\x20capability\x20yet\x20it\x20does\x20not\x20have\x20exactly\x20one\x20delegation\x20')+_0x519bbd[_0x2ca6fb(0x1d7)]);const {capabilityChain:_0x40d998}=_0x4fea36[0x0];if(!(_0x40d998&&Array[_0x2ca6fb(0x20e)](_0x40d998)))throw new Error(_0x519bbd[_0x2ca6fb(0x1a6)](_0x519bbd[_0x2ca6fb(0x1d8)],_0x519bbd['YiMfr']));if(!_0x973ec2){const _0x23bda4=_0x519bbd[_0x2ca6fb(0x213)](_0x40d998[_0x2ca6fb(0x1ff)],0x1)?_0x519bbd[_0x2ca6fb(0x1a4)]:_0x519bbd[_0x2ca6fb(0x1ef)],_0x75c184=_0x519bbd[_0x2ca6fb(0x1b7)](_0x40d998[_0x2ca6fb(0x1ff)],0x1);for(const [_0x3f7202,_0x14ea02]of _0x40d998['entries']()){const _0x239aaa=typeof _0x14ea02;if(!(_0x3f7202===_0x75c184&&_0x519bbd[_0x2ca6fb(0x1e1)](_0x239aaa,_0x23bda4)||_0x3f7202!==_0x75c184&&_0x239aaa===_0x2ca6fb(0x1ab)))throw new TypeError(_0x519bbd['byfpI'](_0x519bbd[_0x2ca6fb(0x212)],'invalid;\x20it\x20must\x20consist\x20of\x20strings\x20of\x20capability\x20IDs\x20except\x20')+_0x519bbd['BrivN']+_0x2ca6fb(0x1f6));}}const _0x51e23=_0x40d998[_0x2ca6fb(0x226)](0x0,_0x40d998[_0x2ca6fb(0x1ff)]-0x1),_0x4d71be=_0x40d998[_0x40d998[_0x2ca6fb(0x1ff)]-0x1];if(typeof _0x4d71be===_0x519bbd['cCjON'])_0x51e23['push'](_0x4d71be);else{if(_0x519bbd[_0x2ca6fb(0x1b0)](_0x519bbd[_0x2ca6fb(0x22b)],_0x519bbd['ScPQz']))_0x51e23['push'](_0x4d71be['id']);else return _0x15f2e4;}_0x51e23[_0x2ca6fb(0x1cf)](_0x12303c);for(const _0x4b99e5 of _0x51e23){if(_0x519bbd[_0x2ca6fb(0x1e1)](typeof _0x4b99e5,_0x519bbd[_0x2ca6fb(0x1ef)])&&!_0x4b99e5[_0x2ca6fb(0x1f0)](':')||typeof _0x4b99e5===_0x519bbd[_0x2ca6fb(0x1a4)]&&!_0x4b99e5['id'][_0x2ca6fb(0x1f0)](':'))throw new Error(_0x519bbd['lpdiN']+'invalid\x20because\x20uses\x20relative\x20URL(s)\x20in\x20its\x20capability\x20chain.');}return _0x51e23;}export async function dereferenceCapabilityChain({capability:_0x4cba5b,getRootCapability:_0x2ee109,maxChainLength:maxChainLength=MAX_CHAIN_LENGTH}){const _0x9856=_0x3d33,_0x4e0b85={'lZfFI':function(_0x184286,_0x1a764d){return _0x184286+_0x1a764d;},'TpjPN':_0x9856(0x1be),'JiPzt':_0x9856(0x21c),'rpqqO':_0x9856(0x1af),'pZwYN':function(_0x326326,_0x5f4163){return _0x326326===_0x5f4163;},'vfVFu':function(_0x306ad9,_0x377b2f){return _0x306ad9!==_0x377b2f;},'bsBVT':function(_0x59a19f,_0x4aca0a){return _0x59a19f+_0x4aca0a;},'nXFjA':function(_0x4b1ba0,_0x548ccd){return _0x4b1ba0===_0x548ccd;},'vBcas':'CvKVs','ZZizu':function(_0x1bfa33,_0x2e9a87){return _0x1bfa33+_0x2e9a87;},'GhEMB':'The\x20capability\x20chain\x20exceeds\x20the\x20maximum\x20allowed\x20length\x20','kjiwF':function(_0xf802a8,_0x35f156){return _0xf802a8>_0x35f156;},'CvBzF':'The\x20capability\x20chain\x20length\x20is\x20incongruent.','jmUKe':_0x9856(0x21f),'chSRq':'string','cHgDP':'bikhE','ecjDz':function(_0x3f4933,_0x2d8b56){return _0x3f4933===_0x2d8b56;},'ONiqE':function(_0x212b27,_0x42230a){return _0x212b27+_0x42230a;},'edaFh':function(_0xe720d9,_0x210825){return _0xe720d9+_0x210825;},'wZRjK':'Capability\x20chain\x20is\x20invalid;\x20it\x20must\x20consist\x20of\x20strings\x20','FrSwz':function(_0x33d79e,_0x1fe1f1){return _0x33d79e+_0x1fe1f1;},'hFFgx':_0x9856(0x19d),'Wmsks':_0x9856(0x1b3),'nLrDg':_0x9856(0x230),'Hcshu':function(_0x45e6e9,_0x5e0f73){return _0x45e6e9(_0x5e0f73);},'OJFaC':_0x9856(0x1b9),'NUsFa':'The\x20capability\x20chain\x20is\x20inconsistent.','RSNCM':function(_0x397309,_0x59a068){return _0x397309>_0x59a068;},'GdVsq':function(_0x43b6f0,_0xfcc18b){return _0x43b6f0-_0xfcc18b;},'ehTYI':function(_0x161873,_0x5621a3){return _0x161873>_0x5621a3;},'HbYAK':function(_0x1f9eac,_0x787d92){return _0x1f9eac!==_0x787d92;}};if(_0x4e0b85['pZwYN'](typeof _0x4cba5b,_0x9856(0x1ab))){const _0x3aaadf=_0x4cba5b,{rootCapability:_0x343e24}=await _0x2ee109({'id':_0x3aaadf});checkCapability({'capability':_0x343e24,'expectRoot':!![]});if(_0x4e0b85[_0x9856(0x224)](_0x343e24['id'],_0x3aaadf))throw new Error(_0x4e0b85['bsBVT'](_0x9856(0x1bd)+_0x343e24['id']+'\x22\x20does\x20not\x20',_0x9856(0x1f3)+_0x3aaadf+'\x22.'));_0x4cba5b=_0x343e24;}else checkCapability({'capability':_0x4cba5b,'expectRoot':![]});const _0x49bbc9=new Map(),_0x4dc368=getCapabilityChain({'capability':_0x4cba5b});if(_0x4dc368[_0x9856(0x1ff)]+0x1>maxChainLength){if(_0x4e0b85[_0x9856(0x1a0)](_0x4e0b85[_0x9856(0x1de)],_0x4e0b85[_0x9856(0x1de)]))throw new Error(_0x4e0b85['ZZizu'](_0x4e0b85[_0x9856(0x220)],_0x9856(0x1d1)+maxChainLength+'.'));else{if(_0x39823d!==_0x24a17e)throw new _0xf8271a(_0x4e0b85[_0x9856(0x1e2)](_0x4e0b85[_0x9856(0x1bc)],'\x22'+_0x505190+'\x22.'));if(_0x5c8285[_0x9856(0x1a5)]!==_0x509d1f)throw new _0x4ccd7d(_0x4e0b85[_0x9856(0x206)]);}}let _0x582014=!![],_0x49cf17=_0x4dc368[_0x9856(0x1ff)],_0x2473c7=_0x4cba5b,_0xa76ae3=_0x4dc368;while(_0x4e0b85[_0x9856(0x1f5)](_0xa76ae3[_0x9856(0x1ff)],0x0)){if(_0xa76ae3['length']!==_0x49cf17)throw new Error(_0x4e0b85[_0x9856(0x20d)]);const _0x5601a4=_0xa76ae3[_0x9856(0x1ff)]>0x1?_0x4e0b85[_0x9856(0x1da)]:_0x4e0b85['chSRq'],_0x438ceb=_0xa76ae3[_0x9856(0x1ff)]-0x1;for(const [_0x1c95fc,_0x14cb39]of _0xa76ae3[_0x9856(0x1ac)]()){if(_0x9856(0x22f)===_0x4e0b85[_0x9856(0x216)])throw new _0xb8d818(_0x9856(0x1df)+_0x4e0b85[_0x9856(0x215)]);else{const _0x25fa7b=typeof _0x14cb39,_0x15503c=_0x25fa7b===_0x9856(0x1ab),_0x3a2591=_0x1c95fc===_0x438ceb?_0x5601a4:_0x4e0b85[_0x9856(0x1f1)];if(!(_0x25fa7b===_0x3a2591&&(_0x15503c||_0x4e0b85[_0x9856(0x228)](typeof _0x14cb39['id'],_0x9856(0x1ab)))))throw new TypeError(_0x4e0b85[_0x9856(0x229)](_0x4e0b85[_0x9856(0x1e2)](_0x4e0b85[_0x9856(0x1d3)](_0x4e0b85['wZRjK'],_0x9856(0x1c3)),_0x9856(0x1d6)),_0x9856(0x22e)));const _0x15dc36=_0x15503c?_0x14cb39:_0x14cb39['id'];if(!_0x15dc36[_0x9856(0x1f0)](':')){if(_0x9856(0x1b1)===_0x9856(0x1ed))throw new _0x2647ad(_0x4e0b85[_0x9856(0x1e2)](_0x9856(0x1bd)+_0x20ad7e['id']+_0x9856(0x1c2),_0x9856(0x1f3)+_0x14de41+'\x22.'));else throw new Error(_0x4e0b85['FrSwz'](_0x4e0b85['hFFgx'],'that\x20is\x20not\x20an\x20absolute\x20URI.'));}if(_0x1c95fc===_0x438ceb&&_0x2473c7['parentCapability']&&_0x2473c7['parentCapability']!==_0x15dc36)throw new Error(_0x4e0b85[_0x9856(0x1c7)]+_0x4e0b85[_0x9856(0x201)]);!_0x15503c&&_0x4e0b85[_0x9856(0x1c9)](checkCapability,{'capability':_0x14cb39,'expectRoot':_0x1c95fc===0x0});if(_0x582014){if(_0x15dc36===_0x4cba5b['id']||_0x49bbc9[_0x9856(0x1e5)](_0x15dc36))throw new Error(_0x4e0b85[_0x9856(0x1db)]);_0x49bbc9[_0x9856(0x1d4)](_0x15dc36,_0x14cb39);}else{const _0x59eaea=_0x49bbc9[_0x9856(0x1eb)](_0x15dc36);if(!_0x59eaea)throw new Error(_0x4e0b85[_0x9856(0x1c4)]);if(_0x15dc36===_0x4cba5b['id']||typeof _0x59eaea===_0x9856(0x21f))throw new Error(_0x4e0b85['OJFaC']);!_0x15503c&&_0x49bbc9[_0x9856(0x1d4)](_0x15dc36,_0x14cb39);}}}if(_0x4e0b85[_0x9856(0x21e)](_0xa76ae3[_0x9856(0x1ff)],0x1))_0x49cf17--,_0x2473c7=_0xa76ae3[_0x4e0b85[_0x9856(0x1c6)](_0xa76ae3['length'],0x1)],_0xa76ae3=_0x4e0b85[_0x9856(0x1c9)](getCapabilityChain,{'capability':_0x2473c7});else break;_0x582014=![];}if(_0x4e0b85['ehTYI'](_0x4dc368[_0x9856(0x1ff)],0x0)){const [_0x396b34]=_0x4dc368,{rootCapability:_0xb70cee}=await _0x4e0b85[_0x9856(0x1c9)](_0x2ee109,{'id':_0x396b34});_0x4e0b85['Hcshu'](checkCapability,{'capability':_0xb70cee,'expectRoot':!![]});if(_0x4e0b85['HbYAK'](_0xb70cee['id'],_0x396b34))throw new Error(_0x4e0b85[_0x9856(0x1e2)](_0x9856(0x1bd)+_0xb70cee['id']+_0x9856(0x1c2),_0x9856(0x1f3)+_0x396b34+'\x22\x20from\x20capability\x20chain.'));_0x49bbc9[_0x9856(0x1d4)](_0x396b34,_0xb70cee);}_0x49bbc9[_0x9856(0x1d4)](_0x4cba5b['id'],_0x4cba5b);const _0x5ddc76=[..._0x49bbc9[_0x9856(0x203)]()];return{'dereferencedChain':_0x5ddc76};}export function checkProofContext({proof:_0x258783}){const _0x219082=_0x3d33,_0x2f6685={'hCKUe':function(_0x1f1e1d,_0x37a9f1){return _0x1f1e1d===_0x37a9f1;}},{'@context':_0x59f388}=_0x258783;if(!(Array[_0x219082(0x20e)](_0x59f388)&&_0x59f388[_0x219082(0x1f0)](ZCAP_CONTEXT_URL)||_0x2f6685[_0x219082(0x22a)](_0x59f388,ZCAP_CONTEXT_URL)))throw new Error(_0x219082(0x1fb)+ZCAP_CONTEXT_URL+'\x22).');}export function hasValidAllowedAction({allowedAction:_0x2b3c16,parentAllowedAction:_0x15d372}){const _0x1dff0a=_0x3d33;if(!_0x15d372)return!![];if(Array[_0x1dff0a(0x20e)](_0x15d372)){if(Array[_0x1dff0a(0x20e)](_0x2b3c16))return _0x2b3c16[_0x1dff0a(0x1d2)](_0x33d134=>_0x15d372[_0x1dff0a(0x1f0)](_0x33d134));return _0x15d372['includes'](_0x2b3c16);}return _0x15d372===_0x2b3c16;}function _0x3d33(_0x16ba17,_0x542e99){const _0x4affc4=_0x4aff();return _0x3d33=function(_0x3d3373,_0x2e222f){_0x3d3373=_0x3d3373-0x19c;let _0x45624d=_0x4affc4[_0x3d3373];return _0x45624d;},_0x3d33(_0x16ba17,_0x542e99);}export function checkCapability({capability:_0x12eb5d,expectRoot:_0x465ea3}){const _0x41380e=_0x3d33,_0x3f24be={'nzjrA':_0x41380e(0x202),'EFfwR':function(_0x549ad5,_0x5e9796){return _0x549ad5===_0x5e9796;},'hqTQT':_0x41380e(0x1b9),'NETZR':_0x41380e(0x205),'uCqjC':_0x41380e(0x219),'zOvZI':'but\x20it\x20is\x20delegated.','yimnC':function(_0xaad36e,_0x54598a){return _0xaad36e!==_0x54598a;},'tlHKc':function(_0x340bdc,_0x414180){return _0x340bdc+_0x414180;},'VtCRY':_0x41380e(0x1ab),'ozrfI':_0x41380e(0x1cc),'ATHSj':'value\x20that\x20expresses\x20an\x20absolute\x20URI.','rqjjK':_0x41380e(0x234),'ajTOo':function(_0x4eb623,_0x45f011){return _0x4eb623(_0x45f011);},'urfPH':function(_0xaa02bb,_0x4519ae){return _0xaa02bb===_0x4519ae;},'cMNhv':'Jjxap','PumLU':_0x41380e(0x1a7),'MQnZb':_0x41380e(0x204),'SxrLA':function(_0x35f8b9,_0x13574c){return _0x35f8b9===_0x13574c;},'QTUqV':_0x41380e(0x1df),'KnzHc':_0x41380e(0x1af),'qvZQJ':_0x41380e(0x1f7)},{'@context':_0x4c609f,id:_0x45bd75,parentCapability:_0x1df84a,invocationTarget:_0x508e1f,allowedAction:_0x55d63e,expires:_0x32b041}=_0x12eb5d,_0x5cd778=_0x1df84a===undefined;if(_0x5cd778){if(_0x4c609f!==ZCAP_CONTEXT_URL){if(_0x3f24be[_0x41380e(0x1ba)](_0x41380e(0x1e0),'LIVrR'))throw new Error(_0x41380e(0x1be)+('\x22'+ZCAP_CONTEXT_URL+'\x22.'));else{const _0x1d1aaa=_0x77a678[_0x41380e(0x1eb)](_0x2e51ad);if(!_0x1d1aaa)throw new _0x497210(_0x3f24be[_0x41380e(0x1bb)]);if(_0x3f24be[_0x41380e(0x1b6)](_0x5d34d8,_0x455c32['id'])||_0x3f24be[_0x41380e(0x1b6)](typeof _0x1d1aaa,_0x41380e(0x21f)))throw new _0x5012f0(_0x3f24be[_0x41380e(0x21a)]);!_0x2bb292&&_0x2ff6e4[_0x41380e(0x1d4)](_0x9354cf,_0x49ac1a);}}if(_0x3f24be[_0x41380e(0x1ba)](_0x12eb5d['expires'],undefined))throw new Error('Root\x20capability\x20must\x20not\x20have\x20an\x20\x22expires\x22\x20field.');}else{if(!(Array['isArray'](_0x4c609f)&&_0x3f24be[_0x41380e(0x1b6)](_0x4c609f[0x0],ZCAP_CONTEXT_URL)))throw new Error(_0x3f24be[_0x41380e(0x1cd)]('Delegated\x20capability\x20must\x20have\x20an\x20\x22@context\x22\x20array\x20',_0x41380e(0x1bf)+ZCAP_CONTEXT_URL+_0x41380e(0x1c0)));if(!(typeof _0x1df84a===_0x3f24be[_0x41380e(0x20c)]&&_0x1df84a['includes'](':')))throw new Error(_0x3f24be[_0x41380e(0x1cb)]+_0x3f24be[_0x41380e(0x1ee)]);const [_0x5ec190]=getDelegationProofs({'capability':_0x12eb5d});if(!_0x5ec190){if(_0x3f24be[_0x41380e(0x1b5)]!==_0x3f24be[_0x41380e(0x1b5)])throw new _0x3ae551(_0x3f24be[_0x41380e(0x200)]+_0x3f24be['uCqjC']);else throw new Error(_0x41380e(0x1fa));}if(_0x3f24be[_0x41380e(0x1e3)](isNaN,Date[_0x41380e(0x20f)](_0x5ec190[_0x41380e(0x207)]))){if(_0x3f24be[_0x41380e(0x1ec)](_0x3f24be[_0x41380e(0x1e7)],'Jjxap'))throw new Error(_0x41380e(0x1b8));else _0x3155c5['push'](_0x433c2a['id']);}if(isNaN(Date[_0x41380e(0x20f)](_0x32b041))){if(_0x3f24be['PumLU']==='UfUkh')_0x3aaacf({'capability':_0x44170e,'expectRoot':![]});else throw new Error(_0x3f24be[_0x41380e(0x1c8)]);}}if(!(_0x3f24be[_0x41380e(0x1e8)](typeof _0x45bd75,_0x3f24be[_0x41380e(0x20c)])&&_0x45bd75['includes'](':'))){if(_0x41380e(0x22c)!=='zVXGe')throw new _0x59b276(_0x41380e(0x1ca)+_0x2a5818['id']+_0x41380e(0x1a8)+_0x3f24be['zOvZI']);else throw new Error(_0x3f24be[_0x41380e(0x1e9)]+_0x3f24be['KnzHc']);}if(!(typeof _0x508e1f===_0x41380e(0x1ab)&&_0x508e1f[_0x41380e(0x1f0)](':')))throw new Error(_0x3f24be[_0x41380e(0x1cd)]('Capability\x20must\x20have\x20an\x20\x22invocationTarget\x22\x20with\x20a\x20string\x20value\x20that\x20','expresses\x20an\x20absolute\x20URI.'));if(_0x55d63e!==undefined&&!(_0x3f24be[_0x41380e(0x1b6)](typeof _0x55d63e,_0x3f24be[_0x41380e(0x20c)])||Array[_0x41380e(0x20e)](_0x55d63e)&&_0x55d63e[_0x41380e(0x1ff)]>0x0))throw new Error(_0x41380e(0x223)+_0x3f24be[_0x41380e(0x1fe)]);if(_0x5cd778!==_0x465ea3){if(_0x465ea3)throw new Error(_0x3f24be[_0x41380e(0x1cd)](_0x41380e(0x1ca)+_0x12eb5d['id']+'\x22\x20to\x20be\x20root\x20',_0x41380e(0x1b4)));throw new Error(_0x41380e(0x1ca)+_0x12eb5d['id']+_0x41380e(0x218));}}export function compareTime({t1:_0x120e2f,t2:_0x23022f,maxClockSkew:_0x569b2e}){const _0x519595=_0x3d33,_0xa8d45={'NUFBd':function(_0x182a23,_0x21129d){return _0x182a23<_0x21129d;},'Bgnoi':function(_0x4c62e9,_0x5c31fd){return _0x4c62e9-_0x5c31fd;}};if(_0xa8d45['NUFBd'](Math[_0x519595(0x1c5)](_0xa8d45[_0x519595(0x1ad)](_0x120e2f,_0x23022f)),_0x569b2e*0x3e8))return 0x0;return _0x120e2f<_0x23022f?-0x1:0x1;}