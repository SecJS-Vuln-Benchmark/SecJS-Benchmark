'use strict';const _0x402e11=_0x48ed;(function(_0x6f75da,_0x36c2ba){const _0xbc46bc=_0x48ed,_0x36e785=_0x6f75da();while(!![]){try{const _0x5bc90d=parseInt(_0xbc46bc(0x183))/0x1*(parseInt(_0xbc46bc(0x12d))/0x2)+parseInt(_0xbc46bc(0x1e4))/0x3*(parseInt(_0xbc46bc(0x1be))/0x4)+parseInt(_0xbc46bc(0x11a))/0x5*(-parseInt(_0xbc46bc(0x174))/0x6)+-parseInt(_0xbc46bc(0x1e0))/0x7*(parseInt(_0xbc46bc(0x16a))/0x8)+-parseInt(_0xbc46bc(0x1a5))/0x9*(-parseInt(_0xbc46bc(0x14a))/0xa)+-parseInt(_0xbc46bc(0x17e))/0xb*(-parseInt(_0xbc46bc(0x18f))/0xc)+-parseInt(_0xbc46bc(0x145))/0xd;if(_0x5bc90d===_0x36c2ba)break;else _0x36e785['push'](_0x36e785['shift']());}catch(_0x37e488){_0x36e785['push'](_0x36e785['shift']());}}}(_0x353c,0x487a0));const stream=require(_0x402e11(0x18c)),Writable=stream[_0x402e11(0x1bb)],memStore={},util=require('util'),path=require(_0x402e11(0x185)),regUser=/^system\.user\./,regGroup=/^system\.group\./,regCheckId=/[*?\[\]]|\$%\$/,SYSTEM_ADMIN_USER=_0x402e11(0x147),SYSTEM_ADMIN_GROUP=_0x402e11(0x119),ERROR_PERMISSION='permissionError',ERROR_NOT_FOUND=_0x402e11(0x137),ERROR_DB_CLOSED=_0x402e11(0x13a),ACCESS_EVERY_EXEC=0x1,ACCESS_EVERY_WRITE=0x2,ACCESS_EVERY_READ=0x4,ACCESS_EVERY_RW=ACCESS_EVERY_WRITE|ACCESS_EVERY_READ,ACCESS_EVERY_ALL=ACCESS_EVERY_WRITE|ACCESS_EVERY_READ|ACCESS_EVERY_EXEC,ACCESS_GROUP_EXEC=0x10,ACCESS_GROUP_WRITE=0x20,ACCESS_GROUP_READ=0x40,ACCESS_GROUP_RW=ACCESS_GROUP_WRITE|ACCESS_GROUP_READ,ACCESS_GROUP_ALL=ACCESS_GROUP_WRITE|ACCESS_GROUP_READ|ACCESS_GROUP_EXEC,ACCESS_USER_EXEC=0x100,ACCESS_USER_WRITE=0x200,ACCESS_USER_READ=0x400,ACCESS_USER_RW=ACCESS_USER_WRITE|ACCESS_USER_READ,ACCESS_USER_ALL=ACCESS_USER_WRITE|ACCESS_USER_READ|ACCESS_USER_EXEC,ACCESS_WRITE=0x2,ACCESS_READ=0x4,ACCESS_LIST='list',ACCESS_DELETE=_0x402e11(0x148),ACCESS_CREATE=_0x402e11(0x117),mimeTypes={'.css':{'type':'text/css','binary':![]},'.bmp':{'type':'image/bmp','binary':!![]},'.png':{'type':_0x402e11(0x1a1),'binary':!![]},'.jpg':{'type':'image/jpeg','binary':!![]},'.jpeg':{'type':_0x402e11(0x149),'binary':!![]},'.gif':{'type':'image/gif','binary':!![]},'.ico':{'type':_0x402e11(0x1bd),'binary':!![]},'.webp':{'type':_0x402e11(0x16e),'binary':!![]},'.wbmp':{'type':_0x402e11(0x1d7),'binary':!![]},'.tif':{'type':_0x402e11(0x13f),'binary':!![]},'.js':{'type':_0x402e11(0x111),'binary':![]},'.html':{'type':_0x402e11(0x162),'binary':![]},'.htm':{'type':_0x402e11(0x162),'binary':![]},'.json':{'type':_0x402e11(0x163),'binary':![]},'.md':{'type':_0x402e11(0x184),'binary':![]},'.xml':{'type':_0x402e11(0x1ea),'binary':![]},'.svg':{'type':_0x402e11(0x1c0),'binary':![]},'.eot':{'type':'application/vnd.ms-fontobject','binary':!![]},'.ttf':{'type':'application/font-sfnt','binary':!![]},'.cur':{'type':_0x402e11(0x15e),'binary':!![]},'.woff':{'type':_0x402e11(0x1af),'binary':!![]},'.wav':{'type':'audio/wav','binary':!![]},'.mp3':{'type':'audio/mpeg3','binary':!![]},'.avi':{'type':_0x402e11(0x186),'binary':!![]},'.qt':{'type':_0x402e11(0x18a),'binary':!![]},'.ppt':{'type':'application/vnd.ms-powerpoint','binary':!![]},'.pptx':{'type':_0x402e11(0x1b3),'binary':!![]},'.doc':{'type':_0x402e11(0x13b),'binary':!![]},'.docx':{'type':_0x402e11(0x13b),'binary':!![]},'.xls':{'type':_0x402e11(0x1eb),'binary':!![]},'.xlsx':{'type':_0x402e11(0x1eb),'binary':!![]},'.mp4':{'type':_0x402e11(0x17a),'binary':!![]},'.mkv':{'type':'video/mkv','binary':!![]},'.zip':{'type':_0x402e11(0x16c),'binary':!![]},'.ogg':{'type':_0x402e11(0x154),'binary':!![]},'.manifest':{'type':_0x402e11(0x1e3),'binary':![]},'.pdf':{'type':_0x402e11(0x141),'binary':!![]},'.gz':{'type':_0x402e11(0x1e5),'binary':!![]},'.gzip':{'type':_0x402e11(0x1e5),'binary':!![]}};let users={},groups={};function _0x353c(){const _0x24abc5=['groups','2456831WlTETO','_id','system.user.admin','delete','image/jpeg','217590GyGCbS','stringify','substring','4|2|0|1|3','isBuffer','fibsO','QkZll','Unknown\x20user\x20in\x20group\x20\x22','nFbHq','rows','audio/ogg','silly','writeFile','File\x20','lFIUe','fOZrp','0|4|3|2|1','list','test','ObqOr','application/x-win-bitmap','system.user.香','OGCRZ','dWnEH','text/html','application/json','qcxln','\x20is\x20null','exports','yxNkB','pHuKh','write','709088AnztNn','function','application/zip','hSGQd','image/webp','htDkR','type','tKSjF','alloc','inherits','174wGynOi','sAhAP','eBZsj','xchji','memstore\x20for\x20','state','video/mp4','system.group.','WUvUv','user','22NFREpt','WERTE','uaaSR','YczXS','from','4RuvMSG','text/markdown','path','video/avi','qIxsR','kXaTl','MfXhS','video/quicktime','eQNPT','stream','tKwhm','XZHwZ','82032ZOPkyT','uEsVt','JENfH','cuSTr','\x20/\x20','eKjGp','includes','finish','1|4|2|3|0','VgHiO','Yzoxq','zLbFv','ownerGroup','CdmQO','qIFkJ','6|2|4|1|0|5|3','tqCnw','users','image/png','kzMSz','RNAFo','CAQQx','225tpMdBG','parse','concat','log','DttbW','indexOf','fvblV','ETsef','GjeQg','xyKss','application/font-woff','yeWJc','common','UsIzh','application/vnd.ms-powerpoint','zhYdJ','_write','LVmhB','string','hdSKB','read','wTMxK','Writable','pkguY','image/x-icon','244SVlyMr','yQbXR','image/svg+xml','oyJzr','getObjectList','key','fXJMt','dixdl','EkJZm','DjUJW','UhtRe','text/javascript','owner','nLRZV','ptpwT','value','yOPEP','dONpk','zqlWR','checkFile','rcULP','ezCxu','replace','qOPJC','checked','image/vnd.wap.wbmp','PDSRA','blpnK','group','DOlEx','aGZrT','\x20is\x20empty','QsgHt','HTqGw','14LMVFab','debug','match','text/cache-manifest','10722yNKvDc','application/gzip','nNYMH','AClbx','xUrxh','push','text/xml','application/vnd.ms-excel','ehKwI','xuycK','acl','mimeType','xaRtr','permissions','dSJTp','application/javascript','Callback\x20is\x20empty','toLowerCase','members','system.user.','KSrsx','create','njZJE','system.group.administrator','29990xsygxM','vcXHO','OOfZk','MhFyk','3|0|1|4|2','GMuPI','YoPGx','file','XmepS','object','JMFFo','ZcDYc','nDJON','WIWxf','PLoMn','LIrXi','length','AcYFY','Tpnhe','30702hcvcuY','split','odBRO','invalid\x20user\x20name:\x20','rTJvg','system.group.香','XkpKF','Empty\x20ID','rZLRg','rboHF','Not\x20exists','IahnQ','mrEdF','DB\x20closed','application/msword','LVUBZ','call','jkJuH','image/tiff','ypBqg','application/pdf','IhpTG','QlKkE'];_0x353c=function(){return _0x24abc5;};return _0x353c();}function getMimeType(_0x36ae8e){const _0x417b4d=_0x402e11,_0x18f64b={'zLbFv':function(_0x53806d,_0x69c054){return _0x53806d instanceof _0x69c054;}};if(!_0x36ae8e)return{'mimeType':_0x417b4d(0x162),'isBinary':![]};if(_0x18f64b[_0x417b4d(0x19a)](_0x36ae8e,Array))_0x36ae8e=_0x36ae8e[0x0];_0x36ae8e=_0x36ae8e[_0x417b4d(0x113)]();let _0x1b28c7=_0x417b4d(0x1c9),_0x2dc298=![];return mimeTypes[_0x36ae8e]&&(_0x1b28c7=mimeTypes[_0x36ae8e][_0x417b4d(0x170)],_0x2dc298=mimeTypes[_0x36ae8e]['binary']),{'mimeType':_0x1b28c7,'isBinary':_0x2dc298};}function WMStrm(_0x4b78bc,_0x111d7b){const _0x1ae3f0=_0x402e11,_0x45efd9={'fOZrp':function(_0x49d6ae,_0x140086){return _0x49d6ae instanceof _0x140086;}};if(!_0x45efd9[_0x1ae3f0(0x159)](this,WMStrm))return new WMStrm(_0x4b78bc,_0x111d7b);Writable[_0x1ae3f0(0x13d)](this,_0x111d7b),this[_0x1ae3f0(0x1c3)]=_0x4b78bc,memStore[_0x4b78bc]=Buffer[_0x1ae3f0(0x172)](0x0);}util[_0x402e11(0x173)](WMStrm,Writable),WMStrm['prototype'][_0x402e11(0x1b5)]=function(_0x51a992,_0x383ad9,_0x65ee0e){const _0x53e47d=_0x402e11,_0x31a1b7={'WvCpm':_0x53e47d(0x13e),'qIFkJ':function(_0x1681d4,_0x4d8832){return _0x1681d4+_0x4d8832;},'Tpnhe':'memstore\x20for\x20','hdSKB':_0x53e47d(0x165),'QpCqF':_0x53e47d(0x112)};if(_0x51a992){if(_0x31a1b7['WvCpm']===_0x53e47d(0x1cc))_0x554b0b={'user':_0x21b7fc,'params':_0x4f5f4e,'group':_0x42519e,'groups':[_0x21ec23],'acl':_0x4699d8()};else{const _0x184c9a=Buffer[_0x53e47d(0x14e)](_0x51a992)?_0x51a992:Buffer[_0x53e47d(0x182)](_0x51a992,_0x383ad9);!memStore[this[_0x53e47d(0x1c3)]]&&(memStore[this[_0x53e47d(0x1c3)]]=Buffer[_0x53e47d(0x172)](0x0),console[_0x53e47d(0x1a8)](_0x31a1b7[_0x53e47d(0x19d)](_0x31a1b7[_0x53e47d(0x12c)]+this[_0x53e47d(0x1c3)],_0x31a1b7[_0x53e47d(0x1b8)]))),memStore[this[_0x53e47d(0x1c3)]]=Buffer[_0x53e47d(0x1a7)]([memStore[this[_0x53e47d(0x1c3)]],_0x184c9a]);}}if(!_0x65ee0e)throw _0x31a1b7['QpCqF'];_0x65ee0e();};function _0x48ed(_0x4c4cb6,_0x311754){const _0x353cb4=_0x353c();return _0x48ed=function(_0x48ed77,_0x4bd7f6){_0x48ed77=_0x48ed77-0x10a;let _0x1eeda6=_0x353cb4[_0x48ed77];return _0x1eeda6;},_0x48ed(_0x4c4cb6,_0x311754);}function insert(_0x365c58,_0x18d48b,_0x1d3d06,_0x389fdc,_0x15ada7,_0x26baf8,_0x45fd6d){const _0x4b42a9=_0x402e11,_0x4c67d9={'lFIUe':function(_0x216e98,_0x9b30c6){return _0x216e98+_0x9b30c6;},'IhpTG':function(_0x1dffb8,_0x3fbe1f){return _0x1dffb8+_0x3fbe1f;},'HTqGw':function(_0x33708c,_0x4a4833){return _0x33708c+_0x4a4833;},'xaRtr':_0x4b42a9(0x193),'ETsef':function(_0x1b3ea1,_0x23bbbb){return _0x1b3ea1+_0x23bbbb;},'BzNTY':function(_0x3bb965,_0x68937b){return _0x3bb965+_0x68937b;},'dONpk':function(_0x17a43d,_0x41a159){return _0x17a43d===_0x41a159;},'mrEdF':function(_0x5b00a0,_0x2431eb){return _0x5b00a0+_0x2431eb;},'DOlEx':_0x4b42a9(0x196)};if(_0x4c67d9[_0x4b42a9(0x1cf)](typeof _0x15ada7,_0x4b42a9(0x1b7))){if('sjVyd'==='sjVyd')_0x15ada7={'mimeType':_0x15ada7};else return![];}const _0x1cdf1e=new WMStrm(_0x4c67d9[_0x4b42a9(0x139)](_0x18d48b+'/',_0x1d3d06));return _0x1cdf1e['on'](_0x4c67d9[_0x4b42a9(0x1db)],()=>{const _0x1ebdf8=_0x4b42a9;let _0x5adc3b=null;!memStore[_0x4c67d9[_0x1ebdf8(0x142)](_0x18d48b+'/',_0x1d3d06)]&&(_0x5adc3b=_0x4c67d9['lFIUe'](_0x4c67d9['IhpTG'](_0x4c67d9[_0x1ebdf8(0x142)](_0x4c67d9[_0x1ebdf8(0x1df)](_0x1ebdf8(0x157),_0x18d48b),_0x4c67d9[_0x1ebdf8(0x10e)]),_0x1d3d06),_0x1ebdf8(0x1dd))),_0x365c58[_0x1ebdf8(0x156)](_0x18d48b,_0x1d3d06,memStore[_0x4c67d9[_0x1ebdf8(0x1ac)](_0x4c67d9['BzNTY'](_0x18d48b,'/'),_0x1d3d06)]||'',_0x15ada7,()=>{const _0xc1ceb1=_0x1ebdf8;memStore[_0x4c67d9[_0xc1ceb1(0x158)](_0x18d48b+'/',_0x1d3d06)]!==undefined&&delete memStore[_0x4c67d9['lFIUe'](_0x18d48b+'/',_0x1d3d06)],_0x45fd6d&&setImmediate(_0x45fd6d,_0x5adc3b,null);});}),_0x1cdf1e;}function checkFile(_0x54fdfd,_0x36487e,_0x12eb0a,_0x563919){const _0x5d2057=_0x402e11,_0x28c68e={'KSrsx':_0x5d2057(0x130),'ObqOr':function(_0x31fd51,_0x4cc522){return _0x31fd51+_0x4cc522;},'zuYbE':function(_0x1046b8,_0x14fd57){return _0x1046b8+_0x14fd57;},'bqEnU':function(_0x1a7532,_0x70bddd){return _0x1a7532+_0x70bddd;},'QsgHt':_0x5d2057(0x193),'UhtRe':_0x5d2057(0x1dd),'tKSjF':'object','fvblV':function(_0x1c7eb7,_0x5bb2ee){return _0x1c7eb7|_0x5bb2ee;},'Yzoxq':function(_0x2169d2,_0x421665){return _0x2169d2!==_0x421665;},'yQbXR':_0x5d2057(0x191),'VgHiO':function(_0x240756,_0x49b3a4){return _0x240756<<_0x49b3a4;},'kzMSz':function(_0x2e61ac,_0x27f749){return _0x2e61ac===_0x27f749;},'GjeQg':_0x5d2057(0x1e8),'rboHF':_0x5d2057(0x1c4),'GMuPI':_0x5d2057(0x160),'nDJON':function(_0x35e5a5,_0x221637){return _0x35e5a5&_0x221637;}};typeof _0x54fdfd[_0x5d2057(0x10c)]!==_0x28c68e[_0x5d2057(0x171)]&&(_0x54fdfd[_0x5d2057(0x10d)]=JSON[_0x5d2057(0x1a6)](JSON[_0x5d2057(0x14b)](_0x54fdfd)),_0x54fdfd[_0x5d2057(0x10c)]={'owner':_0x563919&&_0x563919[_0x5d2057(0x1ca)]||SYSTEM_ADMIN_USER,'ownerGroup':_0x563919&&_0x563919[_0x5d2057(0x19b)]||SYSTEM_ADMIN_GROUP,'permissions':_0x563919&&_0x563919[_0x5d2057(0x121)]||_0x28c68e[_0x5d2057(0x1ab)](ACCESS_USER_RW|ACCESS_GROUP_READ,ACCESS_EVERY_READ)});_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x19b)]=_0x54fdfd['acl'][_0x5d2057(0x19b)]||_0x563919&&_0x563919[_0x5d2057(0x19b)]||SYSTEM_ADMIN_GROUP,_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x1ca)]=_0x54fdfd[_0x5d2057(0x10c)]['owner']||_0x563919&&_0x563919['owner']||SYSTEM_ADMIN_USER,_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x10f)]=_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x10f)]||_0x563919&&_0x563919[_0x5d2057(0x121)]||_0x28c68e[_0x5d2057(0x1ab)](_0x28c68e[_0x5d2057(0x1ab)](ACCESS_USER_RW,ACCESS_GROUP_READ),ACCESS_EVERY_READ);if(_0x28c68e[_0x5d2057(0x199)](_0x36487e[_0x5d2057(0x17d)],SYSTEM_ADMIN_USER)&&_0x36487e[_0x5d2057(0x144)][_0x5d2057(0x1aa)](SYSTEM_ADMIN_GROUP)===-0x1&&_0x54fdfd[_0x5d2057(0x10c)]){if(_0x54fdfd['acl']['owner']!==_0x36487e[_0x5d2057(0x17d)]){if(_0x28c68e[_0x5d2057(0x1bf)]===_0x5d2057(0x110))return _0x4d24d1[_0x5d2057(0x1a8)](_0x28c68e[_0x5d2057(0x116)]+_0x35d636),_0x1cf88a=_0x45105d['stringify'](_0x4331d8),_0x5456b0[_0x5d2057(0x13d)](_0x5e9eef,_0x28c68e[_0x5d2057(0x15d)](_0x28c68e[_0x5d2057(0x116)],_0x1daf19),_0x4c7f23,[],_0x254fe7[_0x5d2057(0x1a6)](_0x4e6153[_0x5d2057(0x14b)](_0xef99b6[_0x5d2057(0x10c)])));else{if(_0x28c68e[_0x5d2057(0x199)](_0x36487e['groups'][_0x5d2057(0x1aa)](_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x19b)]),-0x1)){if(!(_0x54fdfd[_0x5d2057(0x10c)]['permissions']&_0x28c68e[_0x5d2057(0x198)](_0x12eb0a,0x4))){if(_0x28c68e[_0x5d2057(0x1a2)](_0x28c68e['GjeQg'],_0x28c68e[_0x5d2057(0x1ad)]))return![];else _0x2e26cf=_0x84ab59[_0x5d2057(0x1d4)](/\.\./g,''),_0x544d17=_0x36c09e['normalize'](_0x28c68e[_0x5d2057(0x15d)]('/',_0x2f706c)),_0x15de89=_0x2daad1[_0x5d2057(0x1d4)](/\\/g,'/');}}else{if(_0x28c68e[_0x5d2057(0x136)]!==_0x28c68e[_0x5d2057(0x11f)]){if(!_0x28c68e['nDJON'](_0x54fdfd[_0x5d2057(0x10c)][_0x5d2057(0x10f)],_0x12eb0a))return![];}else{const _0x2f856d={'wTMxK':function(_0x34b41e,_0xba8793){return _0x34b41e!==_0xba8793;},'YoPGx':function(_0x306200,_0xdb7ae4){const _0xa9fc9c=_0x5d2057;return _0x28c68e[_0xa9fc9c(0x15d)](_0x306200,_0xdb7ae4);},'nFbHq':function(_0x2e1f24,_0x1c3e1f){const _0xdc9b99=_0x5d2057;return _0x28c68e[_0xdc9b99(0x15d)](_0x2e1f24,_0x1c3e1f);}};let _0x7cb5c0=null;!_0x6632e1[_0x28c68e['zuYbE'](_0x11d48f+'/',_0x5ee159)]&&(_0x7cb5c0=_0x28c68e['bqEnU'](_0x28c68e['bqEnU'](_0x5d2057(0x157)+_0x2e6ce0,_0x28c68e[_0x5d2057(0x1de)]),_0x435905)+_0x28c68e[_0x5d2057(0x1c8)]),_0x3cdeaa[_0x5d2057(0x156)](_0x1666e6,_0x247d5b,_0x1fb13b[_0x118a64+'/'+_0x23c3a3]||'',_0xe0f14f,()=>{const _0x456c46=_0x5d2057;_0x2f856d[_0x456c46(0x1ba)](_0x99430d[_0x2f856d[_0x456c46(0x120)](_0x2f856d[_0x456c46(0x152)](_0x480b44,'/'),_0x524664)],_0x4aacdb)&&delete _0x2a3b04[_0x42d870+'/'+_0x595d51],_0x4311aa&&_0x444a94(_0x241985,_0x7cb5c0,null);});}}}}else{if(!_0x28c68e[_0x5d2057(0x126)](_0x54fdfd['acl'][_0x5d2057(0x10f)],_0x12eb0a<<0x8))return![];}}return!![];}function checkFileRights(_0x205940,_0x5c0745,_0x4ca59d,_0x5c2297,_0x5d94af,_0x4e99b2){const _0x224cb6=_0x402e11,_0x5bd905={'rTJvg':function(_0x53b023,_0x47fd76){return _0x53b023||_0x47fd76;},'ZcDYc':function(_0x24244d,_0x2384f2,_0x45af83,_0xa81065,_0x2cfc3e,_0x501601,_0x63096a){return _0x24244d(_0x2384f2,_0x45af83,_0xa81065,_0x2cfc3e,_0x501601,_0x63096a);},'njZJE':_0x224cb6(0x134),'Frjav':'2|0|3|4|1','CdmQO':_0x224cb6(0x148),'uWziI':function(_0x36ff86,_0x338e97,_0x2d1194,_0x2472c4){return _0x36ff86(_0x338e97,_0x2d1194,_0x2472c4);},'Ruwws':function(_0x2bdf6,_0x624770){return _0x2bdf6===_0x624770;},'IahnQ':function(_0x18e4db,_0x2a9a92){return _0x18e4db!==_0x2a9a92;},'MfXhS':_0x224cb6(0x150),'tKwhm':'system.user.admin','EkJZm':_0x224cb6(0x119),'pkguY':function(_0x2fc3a4,_0x59586f){return _0x2fc3a4===_0x59586f;},'KeyeU':_0x224cb6(0x1d3),'UsIzh':'HgcFo','yxNkB':function(_0x51ffc7,_0x2e6dcd,_0x13dd2b){return _0x51ffc7(_0x2e6dcd,_0x13dd2b);}};_0x5c2297=_0x5c2297||{};!_0x5c2297[_0x224cb6(0x17d)]&&(_0x5c2297={'user':_0x5bd905[_0x224cb6(0x18d)],'params':_0x5c2297,'group':_0x5bd905[_0x224cb6(0x1c6)]});if(!_0x5c2297[_0x224cb6(0x10c)]){_0x205940['getUserGroup'](_0x5c2297[_0x224cb6(0x17d)],(_0x5d8708,_0xeee4aa,_0x22d9c8)=>{const _0x3b1f2e=_0x224cb6;_0x5c2297[_0x3b1f2e(0x10c)]=_0x5bd905[_0x3b1f2e(0x131)](_0x22d9c8,{}),_0x5c2297['groups']=_0xeee4aa,_0x5c2297[_0x3b1f2e(0x1da)]=_0xeee4aa?_0xeee4aa[0x0]:null,_0x5bd905[_0x3b1f2e(0x125)](checkFileRights,_0x205940,_0x5c0745,_0x4ca59d,_0x5c2297,_0x5d94af,_0x4e99b2);});return;}if(_0x5bd905[_0x224cb6(0x1bc)](_0x5d94af,0x2)&&!_0x5c2297[_0x224cb6(0x10c)][_0x224cb6(0x121)][_0x224cb6(0x169)]){if(_0x5bd905['KeyeU']===_0x5bd905[_0x224cb6(0x1b2)])_0x27b16a(_0x5bd905[_0x224cb6(0x118)]);else return _0x5bd905[_0x224cb6(0x167)](_0x4e99b2,ERROR_PERMISSION,_0x5c2297);}if(_0x5d94af===0x4&&!_0x5c2297[_0x224cb6(0x10c)][_0x224cb6(0x121)][_0x224cb6(0x1b9)])return _0x5bd905[_0x224cb6(0x167)](_0x4e99b2,ERROR_PERMISSION,_0x5c2297);_0x5c2297[_0x224cb6(0x1d6)]=!![],_0x205940[_0x224cb6(0x1d1)](_0x5c0745,_0x4ca59d,_0x5c2297,_0x5d94af,(_0x3e5423,_0x339ec3,_0x9c0cbb)=>{const _0x21c417=_0x224cb6,_0x4ee741={'XkpKF':function(_0x4195fa,_0x55a3b6,_0x59b7c5,_0xbc4deb){return _0x5bd905['uWziI'](_0x4195fa,_0x55a3b6,_0x59b7c5,_0xbc4deb);}};if(_0x5bd905['Ruwws'](_0x21c417(0x1b0),_0x21c417(0x135)))_0x3d9f64[_0x409533+'/'+_0x163085]!==_0x33dc2d&&delete _0x3254f4[_0x5d1822+'/'+_0x564e07],_0x13b4a4&&_0x4ee741[_0x21c417(0x133)](_0x363f7c,_0xc1aeaa,_0x2501c0,null);else{if(_0x3e5423)return _0x4e99b2(ERROR_PERMISSION,_0x339ec3);else{if(_0x5bd905[_0x21c417(0x138)](_0x5bd905[_0x21c417(0x189)],_0x21c417(0x122)))return _0x4e99b2(null,_0x339ec3,_0x9c0cbb);else{const _0x56fd85=_0x5bd905['Frjav'][_0x21c417(0x12e)]('|');let _0x4fcc4a=0x0;while(!![]){switch(_0x56fd85[_0x4fcc4a++]){case'0':_0x548979[_0x338338]['acl']['users']['read']=_0x2df813[_0x38a9ba]['acl'][_0x21c417(0x1a0)][_0x21c417(0x1b9)]||_0x1d56ed[_0x405ccc][_0x21c417(0x1b1)][_0x21c417(0x10c)]['users'][_0x21c417(0x1b9)];continue;case'1':_0x23bc6f[_0x247adf][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x15b)]=_0x2ed32f[_0x41a862][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x15b)]||_0x11cf83[_0x167616][_0x21c417(0x1b1)][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x15b)];continue;case'2':_0x79eac4[_0x297f59][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x117)]=_0x7320ea[_0x471cc7][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x117)]||_0x10172c[_0x5d6d06][_0x21c417(0x1b1)][_0x21c417(0x10c)][_0x21c417(0x1a0)]['create'];continue;case'3':_0x3f4e5d[_0x372710][_0x21c417(0x10c)][_0x21c417(0x1a0)]['write']=_0x3417a5[_0x2973a1][_0x21c417(0x10c)][_0x21c417(0x1a0)][_0x21c417(0x169)]||_0x330ec8[_0x2ffbc0]['common']['acl'][_0x21c417(0x1a0)]['write'];continue;case'4':_0x2c92c2[_0x4addec][_0x21c417(0x10c)][_0x21c417(0x1a0)]['delete']=_0x11b3f8[_0x121a3e]['acl'][_0x21c417(0x1a0)][_0x5bd905[_0x21c417(0x19c)]]||_0x1d02e1[_0x2032da]['common'][_0x21c417(0x10c)]['users'][_0x5bd905[_0x21c417(0x19c)]];continue;}break;}}}}});}function getDefaultAdminRights(_0x16652e,_0x259a13){const _0x366eb9=_0x402e11,_0x4ee388={'LIrXi':function(_0x43e322,_0x2c0bd0){return _0x43e322||_0x2c0bd0;}};return _0x16652e=_0x4ee388[_0x366eb9(0x129)](_0x16652e,{}),_0x16652e[_0x366eb9(0x121)]={'list':!![],'read':!![],'write':!![],'create':!![],'delete':!![]},_0x16652e['object']={'create':!![],'list':!![],'read':!![],'write':!![],'delete':!![]},_0x16652e[_0x366eb9(0x1a0)]={'create':!![],'list':!![],'read':!![],'write':!![],'delete':!![]},_0x16652e[_0x366eb9(0x179)]={'read':!![],'write':!![],'delete':!![],'create':!![],'list':!![]},_0x16652e;}function getUserGroup(_0x22e80d,_0x450344,_0x2f04bd){const _0x38984e=_0x402e11,_0x179056={'OOfZk':function(_0x9c47c6,_0x566695){return _0x9c47c6+_0x566695;},'QlKkE':'Callback\x20is\x20empty','LMGna':function(_0x5c4d4f,_0x1cb66a){return _0x5c4d4f<_0x1cb66a;},'PLoMn':function(_0x6758d5,_0x4a4882){return _0x6758d5+_0x4a4882;},'vcXHO':_0x38984e(0x19e),'eKjGp':_0x38984e(0x12f),'nNYMH':'WIWxf','aGZrT':_0x38984e(0x15a),'LVUBZ':_0x38984e(0x197),'DjUJW':_0x38984e(0x115),'YczXS':function(_0x20c72a,_0x561982){return _0x20c72a+_0x561982;},'nLRZV':'invalid\x20user\x20name:\x20','ehKwI':_0x38984e(0x132)};if(!_0x450344||typeof _0x450344!==_0x38984e(0x1b7)||!_0x450344[_0x38984e(0x1e2)](regUser))return console[_0x38984e(0x1a8)](_0x179056[_0x38984e(0x181)](_0x179056[_0x38984e(0x1cb)],_0x450344)),_0x450344=JSON[_0x38984e(0x14b)](_0x450344),_0x2f04bd['call'](_0x22e80d,_0x38984e(0x130)+_0x450344,_0x450344,[],JSON[_0x38984e(0x1a6)](JSON[_0x38984e(0x14b)](defaultAcl[_0x38984e(0x10c)])));if(users[_0x450344])return _0x2f04bd[_0x38984e(0x13d)](_0x22e80d,null,_0x450344,users[_0x450344][_0x38984e(0x144)],users[_0x450344][_0x38984e(0x10c)]);let _0x33db21;_0x22e80d[_0x38984e(0x1c2)]({'startkey':_0x38984e(0x17b),'endkey':_0x179056[_0x38984e(0x10a)]},{'checked':!![]},(_0x19c75a,_0x333c1f)=>{const _0x13531b=_0x38984e,_0x2c7023={'dWnEH':function(_0x3882cb,_0x1976fb){const _0x2a5fb3=_0x48ed;return _0x179056[_0x2a5fb3(0x11c)](_0x3882cb,_0x1976fb);},'RNAFo':_0x13531b(0x178),'ypBqg':_0x179056[_0x13531b(0x143)],'rcULP':function(_0x14ea24){return _0x14ea24();},'STdnW':function(_0x26f81d,_0x3eea64){return _0x179056['LMGna'](_0x26f81d,_0x3eea64);},'oyJzr':function(_0x979ab7,_0x480912){const _0x32a77e=_0x13531b;return _0x179056[_0x32a77e(0x128)](_0x979ab7,_0x480912);},'MhFyk':_0x179056[_0x13531b(0x11b)],'DttbW':_0x13531b(0x148),'WERTE':'suEbT','yOPEP':_0x179056[_0x13531b(0x194)],'cuSTr':_0x13531b(0x11e),'TVZod':_0x179056[_0x13531b(0x1e6)],'zqlWR':_0x179056[_0x13531b(0x1dc)],'xyKss':_0x179056[_0x13531b(0x13c)]};if(_0x19c75a)_0x33db21=_0x19c75a;groups=[];if(_0x333c1f)for(let _0x419fed=0x0;_0x419fed<_0x333c1f['rows'][_0x13531b(0x12a)];_0x419fed++){groups[_0x419fed]=_0x333c1f[_0x13531b(0x153)][_0x419fed][_0x13531b(0x1cd)],groups[_0x419fed][_0x13531b(0x146)]===SYSTEM_ADMIN_GROUP&&(groups[_0x419fed][_0x13531b(0x1b1)][_0x13531b(0x10c)]=getDefaultAdminRights(groups[_0x419fed][_0x13531b(0x1b1)][_0x13531b(0x10c)]));}_0x22e80d[_0x13531b(0x1c2)]({'startkey':_0x179056[_0x13531b(0x1c7)],'endkey':_0x13531b(0x15f)},{'checked':!![]},(_0x1c0346,_0x55c67a)=>{const _0x483e41=_0x13531b,_0x3758c1={'tRhgV':function(_0x371c32,_0x4feb87){return _0x371c32(_0x4feb87);}};if(_0x1c0346)_0x33db21=_0x1c0346;users={};if(_0x55c67a)for(let _0x39bbb3=0x0;_0x39bbb3<_0x55c67a[_0x483e41(0x153)][_0x483e41(0x12a)];_0x39bbb3++){users[_0x55c67a[_0x483e41(0x153)][_0x39bbb3][_0x483e41(0x1cd)][_0x483e41(0x146)]]=JSON[_0x483e41(0x1a6)](JSON[_0x483e41(0x14b)](defaultAcl));}users[SYSTEM_ADMIN_USER]=users[SYSTEM_ADMIN_USER]||JSON['parse'](JSON['stringify'](defaultAcl)),users[SYSTEM_ADMIN_USER][_0x483e41(0x10c)]=getDefaultAdminRights(users[SYSTEM_ADMIN_USER]['acl']);for(let _0x68b42a=0x0;_0x68b42a<groups[_0x483e41(0x12a)];_0x68b42a++){if(!groups[_0x68b42a]||!groups[_0x68b42a][_0x483e41(0x1b1)]||!groups[_0x68b42a][_0x483e41(0x1b1)]['members'])continue;for(let _0x15eaa8=0x0;_0x2c7023['STdnW'](_0x15eaa8,groups[_0x68b42a][_0x483e41(0x1b1)]['members'][_0x483e41(0x12a)]);_0x15eaa8++){const _0x43dc6b=groups[_0x68b42a]['common'][_0x483e41(0x114)][_0x15eaa8];if(!users[_0x43dc6b]){_0x33db21=_0x33db21||_0x2c7023[_0x483e41(0x161)](_0x2c7023[_0x483e41(0x1c1)](_0x483e41(0x151),_0x68b42a)+'\x22:\x20',_0x43dc6b);continue;}users[_0x43dc6b][_0x483e41(0x144)][_0x483e41(0x1e9)](groups[_0x68b42a][_0x483e41(0x146)]);if(groups[_0x68b42a]['common']['acl']&&groups[_0x68b42a]['common'][_0x483e41(0x10c)]['file']){if(!users[_0x43dc6b][_0x483e41(0x10c)]||!users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)]){const _0x4e77b6=_0x2c7023[_0x483e41(0x11d)][_0x483e41(0x12e)]('|');let _0xc452ad=0x0;while(!![]){switch(_0x4e77b6[_0xc452ad++]){case'0':users[_0x43dc6b][_0x483e41(0x10c)]['file'][_0x483e41(0x169)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x121)]['write'];continue;case'1':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)]['read']=groups[_0x68b42a]['common']['acl']['file'][_0x483e41(0x1b9)];continue;case'2':users[_0x43dc6b][_0x483e41(0x10c)]['file']=users[_0x43dc6b]['acl']['file']||{};continue;case'3':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x15b)]=groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x121)][_0x483e41(0x15b)];continue;case'4':users[_0x43dc6b]['acl'][_0x483e41(0x121)]['create']=groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x121)]['create'];continue;case'5':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x148)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]['file'][_0x2c7023[_0x483e41(0x1a9)]];continue;case'6':users[_0x43dc6b][_0x483e41(0x10c)]=users[_0x43dc6b][_0x483e41(0x10c)]||{};continue;}break;}}else{const _0x113c41=_0x483e41(0x14d)[_0x483e41(0x12e)]('|');let _0x1da152=0x0;while(!![]){switch(_0x113c41[_0x1da152++]){case'0':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x169)]=users[_0x43dc6b]['acl'][_0x483e41(0x121)][_0x483e41(0x169)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x121)]['write'];continue;case'1':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)][_0x2c7023['DttbW']]=users[_0x43dc6b]['acl']['file'][_0x483e41(0x148)]||groups[_0x68b42a]['common'][_0x483e41(0x10c)]['file'][_0x2c7023[_0x483e41(0x1a9)]];continue;case'2':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x1b9)]=users[_0x43dc6b][_0x483e41(0x10c)]['file'][_0x483e41(0x1b9)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x1b9)];continue;case'3':users[_0x43dc6b]['acl'][_0x483e41(0x121)][_0x483e41(0x15b)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)]['list']||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x121)][_0x483e41(0x15b)];continue;case'4':users[_0x43dc6b][_0x483e41(0x10c)]['file'][_0x483e41(0x117)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x121)]['create']||groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x121)][_0x483e41(0x117)];continue;}break;}}}if(groups[_0x68b42a][_0x483e41(0x1b1)]['acl']&&groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x123)]){if(!users[_0x43dc6b][_0x483e41(0x10c)]||!users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)]){if(_0x2c7023[_0x483e41(0x17f)]!==_0x2c7023[_0x483e41(0x1ce)]){const _0xef4937='2|0|5|1|6|3|4'[_0x483e41(0x12e)]('|');let _0x135a11=0x0;while(!![]){switch(_0xef4937[_0x135a11++]){case'0':users[_0x43dc6b]['acl'][_0x483e41(0x123)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)]||{};continue;case'1':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x1b9)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]['object']['read'];continue;case'2':users[_0x43dc6b][_0x483e41(0x10c)]=users[_0x43dc6b][_0x483e41(0x10c)]||{};continue;case'3':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x2c7023[_0x483e41(0x1a9)]]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x123)][_0x2c7023[_0x483e41(0x1a9)]];continue;case'4':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x15b)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x15b)];continue;case'5':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x117)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]['object'][_0x483e41(0x117)];continue;case'6':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x169)]=groups[_0x68b42a]['common'][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x169)];continue;}break;}}else _0x1ca25a[_0x2683a1]=_0x5f2bab[_0x483e41(0x153)][_0x43cb35][_0x483e41(0x1cd)],_0x472334[_0x28b216][_0x483e41(0x146)]===_0xc6ef04&&(_0x53061c[_0x37c6b3][_0x483e41(0x1b1)][_0x483e41(0x10c)]=_0x3758c1['tRhgV'](_0xf34dab,_0x375d25[_0x50e0a9]['common'][_0x483e41(0x10c)]));}else{const _0x54cd2e=_0x2c7023[_0x483e41(0x192)][_0x483e41(0x12e)]('|');let _0x263767=0x0;while(!![]){switch(_0x54cd2e[_0x263767++]){case'0':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x1b9)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x1b9)]||groups[_0x68b42a]['common']['acl'][_0x483e41(0x123)][_0x483e41(0x1b9)];continue;case'1':users[_0x43dc6b]['acl'][_0x483e41(0x123)][_0x483e41(0x169)]=users[_0x43dc6b][_0x483e41(0x10c)]['object']['write']||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x169)];continue;case'2':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x15b)]=users[_0x43dc6b]['acl'][_0x483e41(0x123)]['list']||groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x123)][_0x483e41(0x15b)];continue;case'3':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x117)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x117)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]['object'][_0x483e41(0x117)];continue;case'4':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x123)][_0x483e41(0x148)]=users[_0x43dc6b][_0x483e41(0x10c)]['object'][_0x483e41(0x148)]||groups[_0x68b42a]['common'][_0x483e41(0x10c)][_0x483e41(0x123)][_0x2c7023[_0x483e41(0x1a9)]];continue;}break;}}}if(groups[_0x68b42a][_0x483e41(0x1b1)]['acl']&&groups[_0x68b42a]['common']['acl'][_0x483e41(0x1a0)]){if(!users[_0x43dc6b][_0x483e41(0x10c)]||!users[_0x43dc6b][_0x483e41(0x10c)]['users'])users[_0x43dc6b][_0x483e41(0x10c)]=users[_0x43dc6b][_0x483e41(0x10c)]||{},users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)]||{},users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x117)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x117)],users[_0x43dc6b]['acl'][_0x483e41(0x1a0)][_0x483e41(0x1b9)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x1b9)],users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x169)]=groups[_0x68b42a]['common']['acl'][_0x483e41(0x1a0)][_0x483e41(0x169)],users[_0x43dc6b][_0x483e41(0x10c)]['users']['delete']=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x2c7023[_0x483e41(0x1a9)]],users[_0x43dc6b][_0x483e41(0x10c)]['users'][_0x483e41(0x15b)]=groups[_0x68b42a]['common'][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x15b)];else{if(_0x483e41(0x127)!==_0x2c7023['TVZod']){if(_0x36dbf2){const _0x4877a1=_0x12abf8['isBuffer'](_0xbb8871)?_0x240019:_0x17e002['from'](_0xbcf760,_0x513646);!_0x4adaf8[this[_0x483e41(0x1c3)]]&&(_0x1ce016[this['key']]=_0x5edb21[_0x483e41(0x172)](0x0),_0x5d5534[_0x483e41(0x1a8)](_0x2c7023[_0x483e41(0x161)](_0x2c7023[_0x483e41(0x1a3)],this['key'])+_0x483e41(0x165))),_0x1a82d2[this[_0x483e41(0x1c3)]]=_0x3c43de['concat']([_0x375fca[this[_0x483e41(0x1c3)]],_0x4877a1]);}if(!_0x12296b)throw _0x2c7023[_0x483e41(0x140)];_0x2c7023[_0x483e41(0x1d2)](_0x5d67e2);}else{const _0x48b146=_0x2c7023[_0x483e41(0x1d0)][_0x483e41(0x12e)]('|');let _0x5923c9=0x0;while(!![]){switch(_0x48b146[_0x5923c9++]){case'0':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)]['create']=users[_0x43dc6b][_0x483e41(0x10c)]['users'][_0x483e41(0x117)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x117)];continue;case'1':users[_0x43dc6b]['acl'][_0x483e41(0x1a0)][_0x483e41(0x15b)]=users[_0x43dc6b]['acl']['users'][_0x483e41(0x15b)]||groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x1a0)]['list'];continue;case'2':users[_0x43dc6b]['acl'][_0x483e41(0x1a0)][_0x2c7023[_0x483e41(0x1a9)]]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x2c7023[_0x483e41(0x1a9)]]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x2c7023['DttbW']];continue;case'3':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x169)]=users[_0x43dc6b]['acl'][_0x483e41(0x1a0)][_0x483e41(0x169)]||groups[_0x68b42a]['common']['acl'][_0x483e41(0x1a0)][_0x483e41(0x169)];continue;case'4':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x1b9)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x1b9)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x1a0)][_0x483e41(0x1b9)];continue;}break;}}}}if(groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]&&groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x179)]){if(!users[_0x43dc6b]['acl']||!users[_0x43dc6b]['acl'][_0x483e41(0x179)])users[_0x43dc6b][_0x483e41(0x10c)]=users[_0x43dc6b]['acl']||{},users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x179)]=users[_0x43dc6b][_0x483e41(0x10c)]['state']||{},users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x117)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)]['state'][_0x483e41(0x117)],users[_0x43dc6b][_0x483e41(0x10c)]['state'][_0x483e41(0x1b9)]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x179)]['read'],users[_0x43dc6b][_0x483e41(0x10c)]['state'][_0x483e41(0x169)]=groups[_0x68b42a][_0x483e41(0x1b1)]['acl'][_0x483e41(0x179)][_0x483e41(0x169)],users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x179)][_0x2c7023['DttbW']]=groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x179)][_0x2c7023[_0x483e41(0x1a9)]],users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x15b)]=groups[_0x68b42a][_0x483e41(0x1b1)]['acl']['state'][_0x483e41(0x15b)];else{const _0x436620=_0x2c7023[_0x483e41(0x1ae)][_0x483e41(0x12e)]('|');let _0x308415=0x0;while(!![]){switch(_0x436620[_0x308415++]){case'0':users[_0x43dc6b][_0x483e41(0x10c)]['state'][_0x483e41(0x15b)]=users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x15b)]||groups[_0x68b42a]['common'][_0x483e41(0x10c)]['state'][_0x483e41(0x15b)];continue;case'1':users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x117)]=users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x117)]||groups[_0x68b42a]['common']['acl'][_0x483e41(0x179)][_0x483e41(0x117)];continue;case'2':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x179)][_0x483e41(0x169)]=users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x179)][_0x483e41(0x169)]||groups[_0x68b42a]['common']['acl'][_0x483e41(0x179)][_0x483e41(0x169)];continue;case'3':users[_0x43dc6b][_0x483e41(0x10c)][_0x483e41(0x179)][_0x2c7023[_0x483e41(0x1a9)]]=users[_0x43dc6b]['acl'][_0x483e41(0x179)][_0x483e41(0x148)]||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x179)][_0x2c7023['DttbW']];continue;case'4':users[_0x43dc6b][_0x483e41(0x10c)]['state'][_0x483e41(0x1b9)]=users[_0x43dc6b][_0x483e41(0x10c)]['state']['read']||groups[_0x68b42a][_0x483e41(0x1b1)][_0x483e41(0x10c)][_0x483e41(0x179)][_0x483e41(0x1b9)];continue;}break;}}}}}_0x2f04bd(_0x33db21,_0x450344,users[_0x450344]?users[_0x450344][_0x483e41(0x144)]:[],users[_0x450344]?users[_0x450344][_0x483e41(0x10c)]:JSON[_0x483e41(0x1a6)](JSON[_0x483e41(0x14b)](defaultAcl[_0x483e41(0x10c)])));});});}function sanitizePath(_0xb68a48,_0x1780f8,_0x2f8cdb){const _0x44dc15=_0x402e11,_0x2b5262={'PDSRA':function(_0x3e2661,_0xc97dc0){return _0x3e2661===_0xc97dc0;},'zhYdJ':function(_0x2aed7d,_0x3f8dc0){return _0x2aed7d(_0x3f8dc0);},'eBZsj':_0x44dc15(0x134),'eQNPT':_0x44dc15(0x1e7),'gdSnX':function(_0x2efcc9,_0x56ca1d){return _0x2efcc9+_0x56ca1d;}};if(_0x2b5262[_0x44dc15(0x1d8)](_0x1780f8[0x0],'/'))_0x1780f8=_0x1780f8[_0x44dc15(0x14c)](0x1);if(!_0xb68a48){typeof _0x2f8cdb===_0x44dc15(0x16b)&&_0x2b5262[_0x44dc15(0x1b4)](_0x2f8cdb,_0x2b5262[_0x44dc15(0x176)]);return;}_0xb68a48&&(_0xb68a48=_0xb68a48[_0x44dc15(0x1d4)](/[\]\[*,;'"`<>\\?\/]/g,''));if(_0x1780f8[_0x44dc15(0x195)]('..')){if(_0x2b5262[_0x44dc15(0x18b)]!=='WrFWL')_0x1780f8=path['normalize']('/'+_0x1780f8),_0x1780f8=_0x1780f8['replace'](/\\/g,'/');else return _0x5d233c['call'](_0x4649de,null,_0x226755,_0x38318e[_0x1b3a5e]['groups'],_0x3bc046[_0x53230b][_0x44dc15(0x10c)]);}_0x1780f8[_0x44dc15(0x195)]('..')&&(_0x1780f8=_0x1780f8[_0x44dc15(0x1d4)](/\.\./g,''),_0x1780f8=path['normalize'](_0x2b5262['gdSnX']('/',_0x1780f8)),_0x1780f8=_0x1780f8[_0x44dc15(0x1d4)](/\\/g,'/'));if(_0x2b5262['PDSRA'](_0x1780f8[0x0],'/'))_0x1780f8=_0x1780f8[_0x44dc15(0x14c)](0x1);return{'id':_0xb68a48,'name':_0x1780f8};}function checkObject(_0x3c981a,_0x5d0ff0,_0x378347){const _0x1b2b60=_0x402e11,_0x12ea75={'jIkBz':function(_0x1f737f,_0x521e6a,_0x29a67f){return _0x1f737f(_0x521e6a,_0x29a67f);},'CAQQx':function(_0x23c21f,_0xa0c4f8){return _0x23c21f===_0xa0c4f8;},'decQG':_0x1b2b60(0x1b6),'sAhAP':function(_0x56d65e,_0x3b3887){return _0x56d65e<<_0x3b3887;},'fibsO':'yNuEj','VeEyC':function(_0x2ee88e,_0x43f90d){return _0x2ee88e&_0x43f90d;}};if(!_0x3c981a||!_0x3c981a['common']||!_0x3c981a[_0x1b2b60(0x10c)]||_0x12ea75[_0x1b2b60(0x1a4)](_0x378347,ACCESS_LIST))return!![];if(_0x12ea75['CAQQx'](_0x5d0ff0[_0x1b2b60(0x17d)],SYSTEM_ADMIN_USER))return _0x12ea75['decQG']!=='sYKva'?!![]:_0x12ea75['jIkBz'](_0x38ade8,_0x233fa0,_0x52cdaf);if(_0x3c981a[_0x1b2b60(0x10c)][_0x1b2b60(0x1ca)]!==_0x5d0ff0[_0x1b2b60(0x17d)]){if(_0x5d0ff0[_0x1b2b60(0x144)][_0x1b2b60(0x195)](_0x3c981a['acl']['ownerGroup'])||_0x5d0ff0[_0x1b2b60(0x144)][_0x1b2b60(0x195)](SYSTEM_ADMIN_GROUP)){if(!(_0x3c981a[_0x1b2b60(0x10c)][_0x1b2b60(0x123)]&_0x12ea75[_0x1b2b60(0x175)](_0x378347,0x4)))return![];}else{if(_0x12ea75[_0x1b2b60(0x1a4)](_0x12ea75[_0x1b2b60(0x14f)],'yNuEj')){if(!_0x12ea75['VeEyC'](_0x3c981a['acl'][_0x1b2b60(0x123)],_0x378347))return![];}else _0x2f6bce={'mimeType':_0x121a2a};}}else{if(!(_0x3c981a['acl'][_0x1b2b60(0x123)]&_0x378347<<0x8))return![];}return!![];}function checkObjectRights(_0x35eff9,_0x3b05d8,_0x366d66,_0x177252,_0x324cbb,_0x2eabf3){const _0x4e4f7d=_0x402e11,_0x17c8e6={'qIxsR':function(_0x4b1fac,_0x24c512,_0x598f8c,_0x7fcc91,_0x5265e4,_0x51ab3b,_0x3e1c9b){return _0x4b1fac(_0x24c512,_0x598f8c,_0x7fcc91,_0x5265e4,_0x51ab3b,_0x3e1c9b);},'htDkR':function(_0x1c2cc5,_0x35127a,_0x42fe06){return _0x1c2cc5(_0x35127a,_0x42fe06);},'uEsVt':function(_0xfc0fc3,_0x2201a1){return _0xfc0fc3&_0x2201a1;},'dixdl':function(_0x4b05d1,_0x55cdd1){return _0x4b05d1||_0x55cdd1;},'JMFFo':function(_0x112568){return _0x112568();},'xchji':function(_0x4c3ecc,_0x1c0893){return _0x4c3ecc===_0x1c0893;},'qcxln':_0x4e4f7d(0x10b),'blpnK':function(_0x22aa29,_0x302867,_0x2023dd){return _0x22aa29(_0x302867,_0x2023dd);},'TnhYR':function(_0x395b78,_0x24243c){return _0x395b78===_0x24243c;},'pHuKh':_0x4e4f7d(0x12b),'XZHwZ':function(_0x162ae8,_0x4998c5){return _0x162ae8!==_0x4998c5;},'DDMTQ':_0x4e4f7d(0x1d5),'wPByK':function(_0x520bbc,_0x455c6e,_0x73e3c){return _0x520bbc(_0x455c6e,_0x73e3c);},'uaaSR':function(_0x39be67,_0x43ce53,_0x520d21){return _0x39be67(_0x43ce53,_0x520d21);},'hSGQd':function(_0x4d140c,_0x4f50e0,_0x5a8add){return _0x4d140c(_0x4f50e0,_0x5a8add);},'kXaTl':function(_0x2bdbf0,_0x39b02b){return _0x2bdbf0===_0x39b02b;},'tqCnw':function(_0x35b09e,_0x192a66,_0x1b3963){return _0x35b09e(_0x192a66,_0x1b3963);},'vlJVf':function(_0x1de207,_0x3697ee){return _0x1de207===_0x3697ee;},'WUvUv':function(_0x574451,_0x50969a,_0x968031,_0x3da4d3){return _0x574451(_0x50969a,_0x968031,_0x3da4d3);}};_0x177252=_0x17c8e6[_0x4e4f7d(0x1c5)](_0x177252,{});!_0x177252[_0x4e4f7d(0x17d)]&&(_0x177252={'user':SYSTEM_ADMIN_USER,'params':_0x177252,'group':SYSTEM_ADMIN_GROUP,'groups':[SYSTEM_ADMIN_GROUP],'acl':_0x17c8e6[_0x4e4f7d(0x124)](getDefaultAdminRights)});if(!_0x177252[_0x4e4f7d(0x10c)])return _0x17c8e6[_0x4e4f7d(0x177)](_0x17c8e6[_0x4e4f7d(0x164)],_0x17c8e6[_0x4e4f7d(0x164)])?_0x35eff9['getUserGroup'](_0x177252[_0x4e4f7d(0x17d)],(_0x710b63,_0x266f8f,_0x2f991d)=>{const _0x495982=_0x4e4f7d;_0x177252[_0x495982(0x10c)]=_0x2f991d||{},_0x177252[_0x495982(0x144)]=_0x266f8f,_0x177252[_0x495982(0x1da)]=_0x266f8f?_0x266f8f[0x0]:null,_0x17c8e6[_0x495982(0x187)](checkObjectRights,_0x35eff9,_0x3b05d8,_0x366d66,_0x177252,_0x324cbb,_0x2eabf3);}):_0x17c8e6[_0x4e4f7d(0x16f)](_0x5f0bff,_0x1ae254,_0x121a75);if(_0x177252[_0x4e4f7d(0x17d)]===SYSTEM_ADMIN_USER||_0x17c8e6[_0x4e4f7d(0x177)](_0x177252[_0x4e4f7d(0x1da)],SYSTEM_ADMIN_GROUP)||_0x177252[_0x4e4f7d(0x144)]&&_0x177252[_0x4e4f7d(0x144)][_0x4e4f7d(0x195)](SYSTEM_ADMIN_GROUP))return _0x17c8e6[_0x4e4f7d(0x1d9)](_0x2eabf3,null,_0x177252);if(regUser[_0x4e4f7d(0x15c)](_0x3b05d8)||regGroup[_0x4e4f7d(0x15c)](_0x3b05d8)){if(_0x324cbb===ACCESS_WRITE&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x1a0)][_0x4e4f7d(0x169)]){if(_0x17c8e6['TnhYR']('AcYFY',_0x17c8e6[_0x4e4f7d(0x168)]))return _0x2eabf3(ERROR_PERMISSION,_0x177252);else{if(!_0x17c8e6[_0x4e4f7d(0x190)](_0x4022e1[_0x4e4f7d(0x10c)]['object'],_0x3b507e<<0x8))return![];}}if(_0x324cbb===ACCESS_READ&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x1a0)][_0x4e4f7d(0x1b9)]){if(_0x17c8e6[_0x4e4f7d(0x18e)](_0x17c8e6['DDMTQ'],_0x4e4f7d(0x1d5)))_0x4dd708={'user':'system.user.admin','params':_0x2bcc88,'group':_0x4e4f7d(0x119)};else return _0x17c8e6['wPByK'](_0x2eabf3,ERROR_PERMISSION,_0x177252);}if(_0x17c8e6[_0x4e4f7d(0x177)](_0x324cbb,ACCESS_DELETE)&&!_0x177252[_0x4e4f7d(0x10c)]['users'][_0x4e4f7d(0x148)])return _0x17c8e6[_0x4e4f7d(0x180)](_0x2eabf3,ERROR_PERMISSION,_0x177252);if(_0x17c8e6['TnhYR'](_0x324cbb,ACCESS_LIST)&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x1a0)]['list'])return _0x17c8e6[_0x4e4f7d(0x16d)](_0x2eabf3,ERROR_PERMISSION,_0x177252);if(_0x324cbb===ACCESS_CREATE&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x1a0)][_0x4e4f7d(0x117)])return _0x2eabf3(ERROR_PERMISSION,_0x177252);if(_0x17c8e6[_0x4e4f7d(0x188)](_0x324cbb,ACCESS_DELETE))_0x324cbb=ACCESS_WRITE;}if(_0x17c8e6['TnhYR'](_0x324cbb,ACCESS_WRITE)&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x123)][_0x4e4f7d(0x169)])return _0x17c8e6[_0x4e4f7d(0x19f)](_0x2eabf3,ERROR_PERMISSION,_0x177252);if(_0x324cbb===ACCESS_READ&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x123)][_0x4e4f7d(0x1b9)])return _0x2eabf3(ERROR_PERMISSION,_0x177252);if(_0x17c8e6['xchji'](_0x324cbb,ACCESS_DELETE)&&!_0x177252[_0x4e4f7d(0x10c)][_0x4e4f7d(0x123)][_0x4e4f7d(0x148)])return _0x2eabf3(ERROR_PERMISSION,_0x177252);if(_0x17c8e6['vlJVf'](_0x324cbb,ACCESS_LIST)&&!_0x177252['acl'][_0x4e4f7d(0x123)][_0x4e4f7d(0x15b)])return _0x2eabf3(ERROR_PERMISSION,_0x177252);if(_0x324cbb===ACCESS_DELETE)_0x324cbb=ACCESS_WRITE;_0x3b05d8&&!_0x17c8e6[_0x4e4f7d(0x17c)](checkObject,_0x366d66,_0x177252,_0x324cbb)?_0x2eabf3(ERROR_PERMISSION,_0x177252):_0x17c8e6['wPByK'](_0x2eabf3,null,_0x177252);}function getLogger(_0x172d97){const _0x40e8f4=_0x402e11;if(!_0x172d97)_0x172d97={'silly':function(_0x216076){},'debug':function(_0x126877){},'info':function(_0x5088bd){},'warn':function(_0x4a81cb){console['log'](_0x4a81cb);},'error':function(_0x2576db){const _0x41dd4e=_0x48ed;console[_0x41dd4e(0x1a8)](_0x2576db);}};else!_0x172d97[_0x40e8f4(0x155)]&&(_0x172d97[_0x40e8f4(0x155)]=_0x172d97[_0x40e8f4(0x1e1)]);return _0x172d97;}const defaultAcl={'groups':[],'acl':{'file':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'object':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'state':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'users':{'list':![],'read':![],'write':![],'create':![],'delete':![]}}};module[_0x402e11(0x166)]={'getMimeType':getMimeType,'insert':insert,'checkFileRights':checkFileRights,'checkFile':checkFile,'getUserGroup':getUserGroup,'sanitizePath':sanitizePath,'checkObject':checkObject,'checkObjectRights':checkObjectRights,'getLogger':getLogger,'regCheckId':regCheckId,'ERRORS':{'ERROR_PERMISSION':ERROR_PERMISSION,'ERROR_NOT_FOUND':ERROR_NOT_FOUND,'ERROR_DB_CLOSED':ERROR_DB_CLOSED},'CONSTS':{'SYSTEM_ADMIN_USER':SYSTEM_ADMIN_USER,'SYSTEM_ADMIN_GROUP':SYSTEM_ADMIN_GROUP,'ACCESS_EVERY_EXEC':ACCESS_EVERY_EXEC,'ACCESS_EVERY_WRITE':ACCESS_EVERY_WRITE,'ACCESS_EVERY_READ':ACCESS_EVERY_READ,'ACCESS_EVERY_RW':ACCESS_EVERY_RW,'ACCESS_EVERY_ALL':ACCESS_EVERY_ALL,'ACCESS_GROUP_EXEC':ACCESS_GROUP_EXEC,'ACCESS_GROUP_WRITE':ACCESS_GROUP_WRITE,'ACCESS_GROUP_READ':ACCESS_GROUP_READ,'ACCESS_GROUP_RW':ACCESS_GROUP_RW,'ACCESS_GROUP_ALL':ACCESS_GROUP_ALL,'ACCESS_USER_EXEC':ACCESS_USER_EXEC,'ACCESS_USER_WRITE':ACCESS_USER_WRITE,'ACCESS_USER_READ':ACCESS_USER_READ,'ACCESS_USER_RW':ACCESS_USER_RW,'ACCESS_USER_ALL':ACCESS_USER_ALL,'ACCESS_WRITE':ACCESS_WRITE,'ACCESS_READ':ACCESS_READ,'ACCESS_LIST':ACCESS_LIST,'ACCESS_DELETE':ACCESS_DELETE,'ACCESS_CREATE':ACCESS_CREATE}};