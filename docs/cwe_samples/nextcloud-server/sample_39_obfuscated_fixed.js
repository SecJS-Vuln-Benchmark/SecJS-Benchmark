'use strict';const _0x4733a6=_0x3046;function _0x380b(){const _0x239a78=['Hawk','OtJkQ','lFEDq','Uallk','Unknown\x20attribute:\x20x','DgBAH','hEMqJ','NLYvi','isMissing','errors\x20on\x20an\x20bad\x20host\x20header\x20(missing\x20host)','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(mac)','cNMxN','zztRX','PnFxP','errors\x20on\x20an\x20unknown\x20authorization\x20attribute','server','nonce','UxDow','overrides\x20timestampSkewSec','BShap','kUwWH','Invalid\x20header\x20syntax','1203XCuDnP','Unknown\x20user','Hawk\x20mac=\x22q+fdjQv3kF56JGKLYeLzAS9dYGcvDqAXRG7MTVHAFKE=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22','nYdsJ','fhiWa','DqmDF','authenticatePayloadHash','OUehN','Bad\x20mac','text/plain','GgSjn','Mwwtc','should\x20fail\x20on\x20missing\x20host','cwGzs','aPxyh','USRgp','mac','lhffe','xGmrF','lynaw','iOuwy','sha1','should\x20fail\x20authorization\x20on\x20missing\x20credentials','PiOpS','NIDbr','now','sCzws','JhCmw','ljCaB','7231945gkeBgD','cOdap','DMEEV','An\x20internal\x20server\x20error\x20occurred','should\x20fail\x20authorization\x20on\x20stale\x20timestamp','VlXuC','DYwcA','dRLMM','CkzAa','MAdwu','authenticateMessage','aQmlp','xrunpaw3489ruxnpa98w4rxnwerxhqb98rpaxn39848','errors\x20on\x20credentialsFunc\x20error','oJUay','456','wJFET','jElfB','aRQDa','eIoYZ','GUdcT','Hawk\x20id=\x22\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','wZpQy','hash','Hawk\x20mac=\x226PrybJTJs20jsgBw5eilXpcytD8kUbaIKNYXL+6g0ns=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22','iqldX','Oatgy','TJbsI','iRVQs','errors\x20on\x20invalid\x20credentials\x20(id)','YpNgn','message','LfusF','XQVyy','errors\x20on\x20invalid\x20options','user','does\x20not\x20error\x20on\x20nonce\x20collision\x20if\x20keys\x20differ','dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','XOqBj','YkQYO','Gvdue','headers','kZUOz','authenticateBewit','errors\x20on\x20invalid\x20authorization\x20(nonce)','fxIFZ','uOtQR','jUiux','Missing\x20attributes','ZjadF','errors\x20on\x20an\x20empty\x20authorization\x20attribute\x20value','Pjjdx','parses\x20a\x20valid\x20authentication\x20header\x20(sha1)','RVqHH','parses\x20a\x20valid\x20authentication\x20header\x20(host\x20port\x20override)','UJbgK','osseS','racni','872hyjLwq','aCFDp','Unknown\x20algorithm','bQdIi','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(ts)','errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20wrong\x20scheme','cngeS','iiQun','SXqwO','crypto','LTzaF','GerfH','HsuGv','AMRYT','qVkOT','grXii','errors\x20on\x20unknown\x20bad\x20mac','vrIzv','example.com','OVeUV','vDOmA','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22bXx7a7p1h9QYQNZ8x7QhvDQym8ACgab4m3lVSFn4DBw=\x22,\x20ext=\x22hello\x22','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(id)','throw','parses\x20a\x20valid\x20authentication\x20header\x20(POST\x20with\x20payload)','qJzYO','MNdDz','Hawk\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','ENsBT','PCQUy','expect','Bad\x20header\x20format','credentials','example1.com','VsnFV','Invalid\x20inputs','abc','WjgRn','OAScn','hzKVT','errors\x20with\x20credentials','header()','sLNJS','peape','POST','1398546787','VWKlo','nZaIr','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','hmac-sha-0','CRQNd','LFcJD','VXGZn','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(nonce)','kTmJZ','abcdefg','exist','should\x20fail\x20authorization\x20on\x20credentials\x20error','Bad\x20message\x20hash','equal','errors\x20on\x20nonce\x20collision','errors\x20on\x20an\x20missing\x20authorization\x20header','YSfmD','bob','some-app-data','GNfok','CFACk','DGYpm','example1.com:8080','uzUsp','calculatePayloadHash','JQBwc','/resource/1?b=1&a=2','nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','steve','1639865hwsADC','cqcFM','Duplicate\x20attribute:\x20id','nyYLZ','oPXKv','OfDHP','momQf','xVqoF','YkBRG','Ghorr','CuJsA','CzyNE','otLNb','1234567','DJLkn','script','cZLMs','authenticatePayloadHash()','8080','something','1896452vAgEfT','EBDxO','algorithm','qXfnq','mDAzR','value','TYbKZ','checks\x20payload\x20hash','should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20algorithm','zXreF','LHEZl','some','hCjTj','XIwAu','WLydq','MUOfS','DsZCw','gAbXB','QILxS','generates\x20header','AlARr','Fnxgb','body','@hapi/lab','Basic\x20asdasdasdasd','errors\x20on\x20duplicated\x20authorization\x20attribute\x20key','should\x20fail\x20on\x20missing\x20credentials','Bad\x20attribute\x20value:\x20id','RZfCo','eGSCZ','utils','123456','errors\x20on\x20an\x20missing\x20host\x20header','UoWlG','RjiNP','28EQfcsT','generates\x20header\x20(empty\x20payload)','IBWxX','jouQV','response-specific','GmGsY','some\x20message1','kYVXD','pojfs','nBdll','Unknown\x20credentials','TTjjC','Qyhmn','ehZQk','xIBKy','aaLiz','generates\x20header\x20(null\x20ext)','/resource/4?filter=a','XtKiF','Hawk\x20id=\x22123\x5c\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','zEnVd','kablooey','example.com:something','ndJmj','VBauh','elMDB','should\x20fail\x20on\x20invalid\x20algorithm','should\x20fail\x20authorization\x20on\x20invalid\x20authorization','zGBfG','hqDWb','vvAfV','gWzCg','errors\x20on\x20a\x20stale\x20timestamp','gqXgV','qsala','ZgkSQ','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20x=\x223\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','authenticateMessage()','Invalid\x20nonce','ntUya','BxXTr','XbpkX','Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22','zpWyN','clone','wZhVg','authenticate','mDMke','JHSGr','errors\x20on\x20a\x20replay','errors\x20on\x20missing\x20hash\x20(empty\x20payload)','Yxhqv','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','Hawk\x20id=\x22dh37fgj492je\x22,\x20ts=\x221353832234\x22,\x20nonce=\x22j4h3g2\x22,\x20mac=\x22m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\x22,\x20ext=\x22some-app-data\x22','errors\x20on\x20missing\x20credentials','uDsIs','xUwusx','VOhfN','NpYPM','ZosTC','should\x20fail\x20authorization\x20on\x20mismatching\x20host','JYxlU','output','Invalid\x20authorization','ubgYw','should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20(algorithm)','zGuCl','hvaaZ','DogOQ','QRKXZ','Invalid\x20Host\x20header','errors\x20on\x20an\x20bad\x20authorization\x20header\x20format','juIBe','ShLJe','some\x20message','oYjBI','ypgBa','lNQBP','JRCVe','NvXVV','errors\x20on\x20invalid\x20algorithm','8348838sVVVcz','AYqco','lIjPJ','heZZt','DsLAO','errors\x20on\x20invalid\x20authorization\x20(ts)','FDuwA','krweK','kaboom','mcSpj','xVahk','errors\x20on\x20missing\x20hash','GET','payload','SOntb','MDuvA','should\x20fail\x20authorization\x20on\x20nonce\x20error','189153qmfRUy','mMRAs','CbwBj','fqaGs','YdmSB','XEoTE','ArhnE','reject','LRcFL','sLJIj','QoWnL','gxBpD','Essby','64632cBwdAH','Hawk\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22LXfmTnRzrLd9TD7yfH+4se46Bx6AHyhpM94hLCiNia4=\x22,\x20ext=\x22hello\x22','txGrI','jHFlH','errors\x20on\x20invalid\x20artifacts','123','Hawk\x20id=\x22123456\x22,\x20ts=\x221362337299\x22,\x20nonce=\x22UzmxSs\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22wnNUxchvvryMH2RxckTdZ/gY3ijzvccx4keVvELC61w=\x22','sNDFP','TiGiQ','werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','errors\x20on\x20invalid\x20credentials\x20(key)','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20ext=\x22hello\x22','coexr','pIykl','errors\x20on\x20invalid\x20credentials\x20(algorithm)','lwCPa','client','PxoYx','header','fCPKs','Invalid\x20credentials','errors\x20on\x20credentialsFunc\x20error\x20(with\x20credentials)','EYjGM','MLrCh','uLOkq','AcZhz','FkHPE','Resource\x20path\x20exceeds\x20max\x20length','Missing\x20required\x20payload\x20hash','loIdf','authenticateBewit()','OdVow','Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22','Hawk\x20mac=\x22i8/kUBDx0QF+PpCtW860kkV/fa9dbwEoe/FpGUXowf0=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22,\x20ext=\x22response-specific\x22','SzykY','Unauthorized','ORpAY','wXvWj','ettaK','some\x20reply','not','iNVle','uLPOq','@hapi/code','cCxfY','hkFcB','sha256','errors\x20on\x20unknown\x20credentials\x20algorithm','CFaFb','statusCode','lBpUV','pIYbM','cBNpE'];_0x380b=function(){return _0x239a78;};return _0x380b();}(function(_0x43155c,_0x115f29){const _0x4264bf=_0x3046,_0x10f635=_0x43155c();while(!![]){try{const _0x53b01e=parseInt(_0x4264bf(0x1f5))/0x1+-parseInt(_0x4264bf(0x163))/0x2+-parseInt(_0x4264bf(0xad))/0x3*(-parseInt(_0x4264bf(0x186))/0x4)+-parseInt(_0x4264bf(0x14f))/0x5+-parseInt(_0x4264bf(0x1d7))/0x6+parseInt(_0x4264bf(0xca))/0x7+-parseInt(_0x4264bf(0x104))/0x8*(-parseInt(_0x4264bf(0x1e8))/0x9);if(_0x53b01e===_0x115f29)break;else _0x10f635['push'](_0x10f635['shift']());}catch(_0x3ae268){_0x10f635['push'](_0x10f635['shift']());}}}(_0x380b,0xb0b2b));function _0x3046(_0x48de1e,_0x1aebc3){const _0x380bc7=_0x380b();return _0x3046=function(_0x304618,_0x2efad0){_0x304618=_0x304618-0x9f;let _0x38cbeb=_0x380bc7[_0x304618];return _0x38cbeb;},_0x3046(_0x48de1e,_0x1aebc3);}const Code=require(_0x4733a6(0x220)),Hawk=require('..'),Hoek=require('@hapi/hoek'),Lab=require(_0x4733a6(0x17a)),internals={},{describe,it}=exports['lab']=Lab[_0x4733a6(0x15e)](),expect=Code[_0x4733a6(0x122)];describe('Server',()=>{const _0x54b113=_0x4733a6,_0x474a11={'pojfs':_0x54b113(0x223),'TYbKZ':_0x54b113(0x14e),'jElfB':_0x54b113(0x1e3),'mWqJo':_0x54b113(0x14c),'ljCaB':_0x54b113(0x116),'VsnFV':function(_0x5e46a0,_0x6d2243){return _0x5e46a0-_0x6d2243;},'xIBKy':function(_0x45d622,_0x2173b5){return _0x45d622(_0x2173b5);},'juIBe':_0x54b113(0x197),'AYqco':_0x54b113(0x148),'sNDFP':'Hawk\x20id=\x22123456\x22,\x20ts=\x221357926341\x22,\x20nonce=\x221AwuJD\x22,\x20hash=\x22qAiXIVv+yjDATneWxZP2YCTa9aHRgQdnH9b3Wc+o3dg=\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22UeYcj5UoTVaAWXNvJfLVia7kU3VabxCqrccXP8sUGC4=\x22','QILxS':_0x54b113(0x218),'CFaFb':function(_0x417ce1,_0x15036f){return _0x417ce1(_0x15036f);},'heZZt':function(_0x5b4a36,_0x147a84){return _0x5b4a36-_0x147a84;},'FDuwA':_0x54b113(0xfa),'NzQMM':function(_0x34ca71,_0x1167cd){return _0x34ca71-_0x1167cd;},'NLYvi':function(_0x364e62,_0x1b2feb){return _0x364e62-_0x1b2feb;},'AMRYT':_0x54b113(0x1ba),'otLNb':function(_0x3e6d1a,_0x57e5ee){return _0x3e6d1a-_0x57e5ee;},'ntUya':function(_0x4b7e6b,_0x415dc3){return _0x4b7e6b-_0x415dc3;},'LFcJD':_0x54b113(0xae),'DYwcA':function(_0x5350b3,_0x3600db){return _0x5350b3(_0x3600db);},'XrBDB':'value','DsLAO':'Unknown\x20algorithm','PxoYx':function(_0x4d9fca,_0x11fb4d){return _0x4d9fca(_0x11fb4d);},'iRVQs':_0x54b113(0xcd),'kCwCu':function(_0x376a31,_0x3c2888){return _0x376a31!==_0x3c2888;},'lmbdt':function(_0x12c1b1,_0x42e00e){return _0x12c1b1-_0x42e00e;},'mcSpj':_0x54b113(0xb5),'peape':function(_0x37b080,_0x4d0adc){return _0x37b080!==_0x4d0adc;},'aRQDa':function(_0x11e5ba,_0x1fd030){return _0x11e5ba(_0x1fd030);},'lFEDq':function(_0x56f95b,_0x261a9b){return _0x56f95b+_0x261a9b;},'atbPn':'Missing\x20required\x20payload\x20hash','VBauh':'Stale\x20timestamp','PCQUy':_0x54b113(0x119),'QRKXZ':_0x54b113(0x1fe),'wZhVg':function(_0x32bcb0,_0x247e9a){return _0x32bcb0===_0x247e9a;},'DsZCw':_0x54b113(0xd6),'cOdap':_0x54b113(0x143),'OfDHP':_0x54b113(0xd3),'cCxfY':_0x54b113(0x11f),'LHEZl':function(_0x5c69a3,_0x1f8ef9){return _0x5c69a3-_0x1f8ef9;},'pIykl':_0x54b113(0x22a),'YSfmD':function(_0x20e688,_0x4004e7){return _0x20e688(_0x4004e7);},'xsQvY':function(_0x353522,_0x344153,_0xfa1e26){return _0x353522(_0x344153,_0xfa1e26);},'NvXVV':_0x54b113(0x209),'zztRX':function(_0x4600c9,_0x47f74d,_0x4beea3){return _0x4600c9(_0x47f74d,_0x4beea3);},'JhCmw':_0x54b113(0xfe),'qsala':function(_0x1b8413,_0x172745,_0x312a49){return _0x1b8413(_0x172745,_0x312a49);},'JHSGr':'parses\x20a\x20valid\x20authentication\x20header\x20(host\x20override)','GmGsY':function(_0x2dfdc0,_0x4e910f,_0x31a71e){return _0x2dfdc0(_0x4e910f,_0x31a71e);},'cBNpE':function(_0x558356,_0x3e3494,_0x14d746){return _0x558356(_0x3e3494,_0x14d746);},'xVahk':_0x54b113(0x1a6),'MNdDz':function(_0x41aeba,_0x36d175,_0x594917){return _0x41aeba(_0x36d175,_0x594917);},'OUehN':function(_0x404b82,_0x171834,_0x48be90){return _0x404b82(_0x171834,_0x48be90);},'XtKiF':_0x54b113(0x109),'XIwAu':function(_0xe70725,_0x241a54,_0x1757ef){return _0xe70725(_0x241a54,_0x1757ef);},'NIDbr':'errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20no\x20scheme','ubgYw':_0x54b113(0x141),'coexr':_0x54b113(0x11a),'qRLvC':_0x54b113(0x108),'oPXKv':function(_0x308fe5,_0x255a41,_0x5e1fb8){return _0x308fe5(_0x255a41,_0x5e1fb8);},'Qyhmn':_0x54b113(0x139),'SzykY':_0x54b113(0x1cd),'fxIFZ':'errors\x20on\x20an\x20bad\x20authorization\x20attribute\x20value','JYxlU':_0x54b113(0xfc),'IBWxX':function(_0x3b0782,_0x21e4ff,_0x2598dc){return _0x3b0782(_0x21e4ff,_0x2598dc);},'SOntb':_0x54b113(0xd7),'hqDWb':_0x54b113(0x20a),'QoWnL':_0x54b113(0x1bc),'lynaw':_0x54b113(0xe7),'XbpkX':_0x54b113(0x1ff),'hCjTj':function(_0x4914c5,_0x20e6e5,_0x380642){return _0x4914c5(_0x20e6e5,_0x380642);},'nyYLZ':_0x54b113(0x161),'cNMxN':_0x54b113(0x131),'USRgp':_0x54b113(0x14d),'iqldX':_0x54b113(0x21c),'krweK':_0x54b113(0xb6),'viOvM':'response-specific','Ghorr':_0x54b113(0x215),'mDAzR':_0x54b113(0x182),'RVqHH':_0x54b113(0x130),'sLJIj':_0x54b113(0x1be),'uLOkq':_0x54b113(0xef),'DMEEV':function(_0x522a00,_0x5db78e){return _0x522a00(_0x5db78e);},'WjgRn':_0x54b113(0xe2),'GNfok':_0x54b113(0x127),'TJbsI':function(_0x1df8fe,_0x3174af){return _0x1df8fe===_0x3174af;},'clUnm':_0x54b113(0x1ea),'VlXuC':_0x54b113(0x176),'zoicQ':_0x54b113(0x187),'gqXgV':function(_0x409132,_0x2f442e,_0x1f5ab5){return _0x409132(_0x2f442e,_0x1f5ab5);},'ShLJe':function(_0x1a8ed7,_0xbb77d2,_0x1daf4f){return _0x1a8ed7(_0xbb77d2,_0x1daf4f);},'oJUay':'generates\x20header\x20(pre\x20calculated\x20hash)','wXvWj':_0x54b113(0x196),'iALCd':'errors\x20on\x20missing\x20artifacts','momQf':function(_0x41a71f,_0x6acafd,_0x2f0a7f){return _0x41a71f(_0x6acafd,_0x2f0a7f);},'iNVle':_0x54b113(0x1f9),'kYVXD':function(_0x35a508,_0x5ebdfd,_0x30978c){return _0x35a508(_0x5ebdfd,_0x30978c);},'VOhfN':_0x54b113(0x203),'tCFmR':_0x54b113(0x1d6),'kTmJZ':_0x54b113(0xec),'zGBfG':_0x54b113(0x210),'FkHPE':_0x54b113(0x1d0),'ZgkSQ':'Invalid\x20authorization','Shacq':_0x54b113(0x125),'eIoYZ':function(_0x46367f,_0x123cae){return _0x46367f!==_0x123cae;},'racni':_0x54b113(0x150),'LTzaF':function(_0xf91b63,_0xd56da2){return _0xf91b63(_0xd56da2);},'DqmDF':function(_0xef7ac0,_0x2d63a6){return _0xef7ac0(_0x2d63a6);},'ARBAh':_0x54b113(0x15f),'lBpUV':'rINHP','iOuwy':_0x54b113(0x18c),'uzUsp':'Invalid\x20nonce','dRLMM':_0x54b113(0x19b),'BShap':function(_0x584842,_0x3eb5a8){return _0x584842(_0x3eb5a8);},'osseS':function(_0x850fd9,_0x1ef67c){return _0x850fd9(_0x1ef67c);},'Fnxgb':_0x54b113(0x212),'DgBAH':_0x54b113(0x191),'loMST':_0x54b113(0x162),'ArhnE':function(_0x48ff8f,_0x5c9e2d){return _0x48ff8f(_0x5c9e2d);},'gAbXB':function(_0x5bb750,_0x5883dd){return _0x5bb750(_0x5883dd);},'NpYPM':'asdasd','izhnv':_0x54b113(0xd9),'YTPXA':'blah','Gvdue':_0x54b113(0x1dc),'lhffe':'errors\x20on\x20invalid\x20authorization\x20(mac)','QLWXf':function(_0x487701,_0x435a8e,_0x83cdf1){return _0x487701(_0x435a8e,_0x83cdf1);},'YtnhV':function(_0x17e27a,_0x1009d5,_0x24bdea){return _0x17e27a(_0x1009d5,_0x24bdea);},'hEMqJ':'errors\x20on\x20invalid\x20authorization\x20(hash)','nYYkG':function(_0x58127b,_0x1a5af4,_0x67af0b){return _0x58127b(_0x1a5af4,_0x67af0b);},'LRcFL':_0x54b113(0x140),'nZaIr':_0x54b113(0x1e7),'CPuom':_0x54b113(0x16b),'jHFlH':function(_0x2a5386,_0xb1d17e,_0x589844){return _0x2a5386(_0xb1d17e,_0x589844);},'Yxhqv':_0x54b113(0x12d),'RZfCo':_0x54b113(0x1ab),'jUiux':_0x54b113(0x160)},_0xb5aee9=function(_0xceea00){const _0x4fa4f1=_0x54b113;return{'id':_0xceea00,'key':_0x4fa4f1(0x1fe),'algorithm':_0xceea00==='1'?_0x4fa4f1(0xc2):_0x474a11[_0x4fa4f1(0x18e)],'user':_0x474a11[_0x4fa4f1(0x169)]};};describe('authenticate()',()=>{const _0x30a50e=_0x54b113,_0x3d70ff={'Pjjdx':_0x474a11['TYbKZ'],'AlARr':function(_0x45fc50,_0x3c5878){const _0xcf5844=_0x3046;return _0x474a11[_0xcf5844(0x12f)](_0x45fc50,_0x3c5878);},'fqaGs':_0x30a50e(0x19d),'nYdsJ':_0x30a50e(0x1e3),'mDMke':_0x30a50e(0x197),'JRCVe':function(_0x27d5c4,_0x21be5a){return _0x27d5c4-_0x21be5a;},'PiOpS':'example.com','hkFcB':function(_0x3fdd54,_0x34fd29){return _0x474a11['aRQDa'](_0x3fdd54,_0x34fd29);},'OVeUV':function(_0x32e726,_0x2efe5){const _0x4eb679=_0x30a50e;return _0x474a11[_0x4eb679(0x22c)](_0x32e726,_0x2efe5);},'KDyci':_0x30a50e(0x12e),'jouQV':_0x474a11['mWqJo'],'XQVyy':_0x30a50e(0x1bb),'YpNgn':function(_0x1e6747,_0x168e5e){return _0x1e6747(_0x168e5e);},'iiQun':_0x474a11['atbPn'],'DJLkn':_0x474a11[_0x30a50e(0x19e)],'Essby':'WWW-Authenticate','GgSjn':function(_0x5a9c04,_0x169cbf){return _0x5a9c04(_0x169cbf);},'VWKlo':function(_0x1967d9,_0x536f6c){return _0x1967d9(_0x536f6c);},'KGELQ':_0x474a11[_0x30a50e(0x121)],'ksREY':function(_0x518330,_0x553287){return _0x474a11['ntUya'](_0x518330,_0x553287);},'CuJsA':_0x474a11[_0x30a50e(0x1cb)],'EmuyM':function(_0x368b1f,_0x2677c3){const _0x3770e6=_0x30a50e;return _0x474a11[_0x3770e6(0x1b3)](_0x368b1f,_0x2677c3);},'HsuGv':_0x474a11[_0x30a50e(0x173)],'grXii':_0x474a11[_0x30a50e(0x18e)],'ettaK':_0x474a11[_0x30a50e(0xcb)],'cgomL':_0x30a50e(0x1f6),'uLPOq':function(_0x4a0718,_0x4516b4){return _0x4a0718(_0x4516b4);},'nBdll':_0x474a11[_0x30a50e(0x154)],'ZosTC':_0x474a11[_0x30a50e(0x221)],'YdmSB':function(_0x383296,_0x672d6){const _0x865ec2=_0x30a50e;return _0x474a11[_0x865ec2(0x15b)](_0x383296,_0x672d6);},'kZUOz':_0x30a50e(0xfa),'Oatgy':function(_0x404102,_0x5346fa){return _0x404102(_0x5346fa);},'rdNtj':function(_0x5d991b,_0x24074d){const _0x2cdfe9=_0x30a50e;return _0x474a11[_0x2cdfe9(0x16d)](_0x5d991b,_0x24074d);},'IbObD':'Hawk\x20id=\x22\x09\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','DGYpm':_0x30a50e(0xdf),'UoWlG':'Bad\x20attribute\x20value:\x20id','vDOmA':'Hawk\x20id=\x22123\x22,\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','CkzAa':_0x474a11[_0x30a50e(0x202)],'OdVow':'Invalid\x20header\x20syntax','pIYbM':function(_0x2a8905,_0x417b26){return _0x2a8905===_0x417b26;},'gxBpD':_0x30a50e(0xc2),'ANEkm':function(_0x3a00db,_0x2e213e){return _0x474a11['NLYvi'](_0x3a00db,_0x2e213e);},'wZpQy':function(_0x2d4a6a,_0x3c4e44){const _0x920a1a=_0x30a50e;return _0x474a11[_0x920a1a(0x142)](_0x2d4a6a,_0x3c4e44);},'qfPTb':function(_0xcf370d,_0x235b20,_0x4584fe){return _0x474a11['xsQvY'](_0xcf370d,_0x235b20,_0x4584fe);},'LfusF':'JQBwc','aaLiz':_0x474a11['AMRYT'],'BxXTr':_0x474a11[_0x30a50e(0x1d5)],'zpWyN':_0x30a50e(0xcd),'aCFDp':function(_0xccbb88,_0x4b3700){const _0x93152f=_0x30a50e;return _0x474a11[_0x93152f(0x206)](_0xccbb88,_0x4b3700);},'hCkvW':function(_0x4bce07,_0x30dc0b){return _0x4bce07===_0x30dc0b;}};_0x474a11[_0x30a50e(0xa3)](it,_0x474a11[_0x30a50e(0xc8)],async()=>{const _0x355847=_0x30a50e;if(_0x3d70ff[_0x355847(0x177)](_0x355847(0x1ed),_0x3d70ff[_0x355847(0x1eb)])){const _0x49a261={'method':_0x3d70ff[_0x355847(0xb0)],'url':_0x3d70ff['mDMke'],'host':_0x355847(0x116),'port':0x1f90,'authorization':_0x355847(0x1b0)},{credentials:_0x2abc34}=await Hawk['server'][_0x355847(0x1b4)](_0x49a261,_0xb5aee9,{'localtimeOffsetMsec':_0x3d70ff['JRCVe'](0x13b34143208,Hawk['utils'][_0x355847(0xc6)]())});expect(_0x2abc34['user'])['to'][_0x355847(0x13f)](_0x3d70ff[_0x355847(0xfd)]);}else return{'key':_0x355847(0x1fe),'algorithm':_0x355847(0x223),'user':_0x3d70ff[_0x355847(0xfd)]};}),it('parses\x20a\x20valid\x20authentication\x20header\x20(sha256)',async()=>{const _0x571c86=_0x30a50e,_0x3e0603={'method':_0x474a11[_0x571c86(0xdb)],'url':_0x474a11['mWqJo'],'host':_0x474a11[_0x571c86(0xc9)],'port':0x1f40,'authorization':_0x571c86(0x1bb)},{credentials:_0x30d576}=await Hawk[_0x571c86(0xa6)][_0x571c86(0x1b4)](_0x3e0603,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x571c86(0x126)](0x13b36b07c10,Hawk['utils'][_0x571c86(0xc6)]())});_0x474a11[_0x571c86(0x194)](expect,_0x30d576['user'])['to'][_0x571c86(0x13f)](_0x474a11[_0x571c86(0x169)]);}),_0x474a11[_0x30a50e(0x1a8)](it,_0x474a11[_0x30a50e(0x1b6)],async()=>{const _0x1347e5=_0x30a50e,_0x304b38={'method':'GET','url':_0x474a11['juIBe'],'headers':{'host':_0x474a11[_0x1347e5(0x1d8)],'authorization':'Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22'}},{credentials:_0x5c8533}=await Hawk['server'][_0x1347e5(0x1b4)](_0x304b38,_0xb5aee9,{'host':'example.com','localtimeOffsetMsec':0x13b34143208-Hawk[_0x1347e5(0x181)]['now']()});expect(_0x5c8533['user'])['to'][_0x1347e5(0x13f)](_0x1347e5(0x14e));}),_0x474a11[_0x30a50e(0x18b)](it,_0x30a50e(0x100),async()=>{const _0x19d411=_0x30a50e,_0x126cc5={'method':_0x3d70ff[_0x19d411(0xb0)],'url':'/resource/4?filter=a','headers':{'host':'example1.com:80','authorization':_0x19d411(0x1b0)}},{credentials:_0xac5689}=await Hawk[_0x19d411(0xa6)][_0x19d411(0x1b4)](_0x126cc5,_0xb5aee9,{'host':_0x3d70ff[_0x19d411(0xc4)],'port':0x1f90,'localtimeOffsetMsec':0x13b34143208-Hawk[_0x19d411(0x181)][_0x19d411(0xc6)]()});_0x3d70ff['hkFcB'](expect,_0xac5689[_0x19d411(0xed)])['to']['equal'](_0x3d70ff['Pjjdx']);}),it(_0x30a50e(0x11c),async()=>{const _0x49d3d4=_0x30a50e,_0x36b160={'method':_0x49d3d4(0x130),'url':_0x474a11['juIBe'],'host':'example.com','port':0x1f90,'authorization':_0x474a11[_0x49d3d4(0x1fc)]},{credentials:_0x4d47a7}=await Hawk[_0x49d3d4(0xa6)][_0x49d3d4(0x1b4)](_0x36b160,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x49d3d4(0x126)](0x13c2ab79988,Hawk[_0x49d3d4(0x181)]['now']())});expect(_0x4d47a7[_0x49d3d4(0xed)])['to'][_0x49d3d4(0x13f)](_0x474a11[_0x49d3d4(0x169)]);}),it(_0x30a50e(0x1e2),async()=>{const _0x16960f=_0x30a50e,_0x25743a={'eGSCZ':function(_0x399685,_0x386514){return _0x3d70ff['OVeUV'](_0x399685,_0x386514);}};if(_0x3d70ff[_0x16960f(0x177)](_0x16960f(0x12e),_0x3d70ff['KDyci'])){if(_0x48e867[_0x25743a[_0x16960f(0x180)](_0x18abcb,_0x1ea8e8)])throw new _0x320a61();_0x6cabef[_0x25743a[_0x16960f(0x180)](_0x47f3db,_0x1fb0d8)]=!![];}else{const _0x3c5946={'method':_0x16960f(0x1e3),'url':_0x3d70ff[_0x16960f(0x189)],'host':_0x16960f(0x116),'port':0x1f40,'authorization':_0x3d70ff['XQVyy']};await _0x3d70ff[_0x16960f(0xe8)](expect,Hawk[_0x16960f(0xa6)]['authenticate'](_0x3c5946,_0xb5aee9,{'payload':_0x16960f(0x179),'localtimeOffsetMsec':_0x3d70ff[_0x16960f(0x1d4)](0x13b36b07c10,Hawk[_0x16960f(0x181)][_0x16960f(0xc6)]())}))['to'][_0x16960f(0x1ef)](_0x16960f(0x211));}}),_0x474a11[_0x30a50e(0x1a8)](it,_0x30a50e(0x1b8),async()=>{const _0xe70c93=_0x30a50e,_0x29188b={'method':_0xe70c93(0x1e3),'url':_0x3d70ff['jouQV'],'host':_0x3d70ff['PiOpS'],'port':0x1f40,'authorization':_0x3d70ff[_0xe70c93(0xeb)]};await expect(Hawk['server'][_0xe70c93(0x1b4)](_0x29188b,_0xb5aee9,{'payload':'','localtimeOffsetMsec':_0x3d70ff['JRCVe'](0x13b36b07c10,Hawk[_0xe70c93(0x181)][_0xe70c93(0xc6)]())}))['to'][_0xe70c93(0x1ef)](_0x3d70ff[_0xe70c93(0x10b)]);}),_0x474a11[_0x30a50e(0x229)](it,_0x474a11[_0x30a50e(0x1e1)],async()=>{const _0xed8f62=_0x30a50e,_0x4231ce={'method':'GET','url':'/resource/4?filter=a','host':_0x3d70ff[_0xed8f62(0xc4)],'port':0x1f90,'authorization':_0xed8f62(0x1fb)},_0x40c73c=await expect(Hawk[_0xed8f62(0xa6)]['authenticate'](_0x4231ce,_0xb5aee9))['to']['reject'](_0x3d70ff[_0xed8f62(0x15d)]),_0xf36dd3=_0x40c73c[_0xed8f62(0x1c4)][_0xed8f62(0xf3)][_0x3d70ff[_0xed8f62(0x1f4)]],_0x1dc5ab=_0xf36dd3['match'](/^Hawk ts\=\"(\d+)\"\, tsm\=\"([^\"]+)\"\, error=\"Stale timestamp\"$/),_0x27d876=Hawk['utils']['now']();_0x3d70ff[_0xed8f62(0xb7)](expect,parseInt(_0x1dc5ab[0x1],0xa)*0x3e8)['to']['be']['within'](_0x27d876-0x3e8,_0x3d70ff[_0xed8f62(0x117)](_0x27d876,0x3e8));const _0x48a497={'headers':{'www-authenticate':_0xf36dd3}};_0x3d70ff[_0xed8f62(0x132)](expect,()=>Hawk['client'][_0xed8f62(0x1b4)](_0x48a497,_0x40c73c[_0xed8f62(0x124)],_0x40c73c['artifacts']))['to']['not'][_0xed8f62(0x11b)]();}),_0x474a11[_0x30a50e(0x11e)](it,_0x30a50e(0x1b7),async()=>{const _0x35d27a=_0x30a50e,_0x588b74={'method':_0x35d27a(0x1e3),'url':_0x3d70ff[_0x35d27a(0x1b5)],'host':_0x35d27a(0x116),'port':0x1f90,'authorization':_0x3d70ff['KGELQ']},_0x54f23b={},_0x532dc3={'localtimeOffsetMsec':_0x3d70ff['ksREY'](0x13b34143208,Hawk['utils']['now']()),'nonceFunc':function(_0x1f7802,_0x4eff73,_0x5a934d){if(_0x54f23b[_0x1f7802+_0x4eff73])throw new Error();_0x54f23b[_0x3d70ff['OVeUV'](_0x1f7802,_0x4eff73)]=!![];}},{credentials:_0xee7e81}=await Hawk[_0x35d27a(0xa6)][_0x35d27a(0x1b4)](_0x588b74,_0xb5aee9,_0x532dc3);expect(_0xee7e81[_0x35d27a(0xed)])['to']['equal'](_0x35d27a(0x14e)),await expect(Hawk['server'][_0x35d27a(0x1b4)](_0x588b74,_0xb5aee9,_0x532dc3))['to'][_0x35d27a(0x1ef)]('Invalid\x20nonce');}),_0x474a11[_0x30a50e(0xb4)](it,_0x30a50e(0xee),async()=>{const _0x1c24e9=_0x30a50e,_0x25acc9={'elMDB':function(_0x128868,_0x2d9970){const _0x4ff3f7=_0x3046;return _0x3d70ff[_0x4ff3f7(0x117)](_0x128868,_0x2d9970);}},_0x51fd94={'method':_0x3d70ff[_0x1c24e9(0xb0)],'url':_0x3d70ff[_0x1c24e9(0x1b5)],'host':_0x1c24e9(0x116),'port':0x1f90,'authorization':_0x1c24e9(0x119)},_0x348d1b={'method':_0x3d70ff['nYdsJ'],'url':_0x1c24e9(0x197),'host':_0x3d70ff[_0x1c24e9(0xc4)],'port':0x1f90,'authorization':_0x3d70ff['cgomL']},_0x51f7aa=function(_0x2a0c6a){const _0x18268b=_0x1c24e9,_0x43b83e={'123':{'id':_0x2a0c6a,'key':_0x3d70ff[_0x18268b(0x159)],'algorithm':_0x3d70ff['EmuyM'](_0x2a0c6a,'1')?_0x18268b(0xc2):_0x18268b(0x223),'user':_0x3d70ff[_0x18268b(0xfd)]},'456':{'id':_0x2a0c6a,'key':_0x3d70ff['HsuGv'],'algorithm':_0x2a0c6a==='1'?_0x18268b(0xc2):_0x3d70ff[_0x18268b(0x113)],'user':_0x3d70ff[_0x18268b(0x21b)]}};return _0x43b83e[_0x2a0c6a];},_0x357f93={},_0x947d={'localtimeOffsetMsec':0x13b34143208-Hawk['utils'][_0x1c24e9(0xc6)](),'nonceFunc':function(_0x248897,_0x2ae9d4,_0x3aea17){const _0x218753=_0x1c24e9;if(_0x357f93[_0x25acc9['elMDB'](_0x248897,_0x2ae9d4)])throw new Error();_0x357f93[_0x25acc9[_0x218753(0x19f)](_0x248897,_0x2ae9d4)]=!![];}},{credentials:_0xb4e0e6}=await Hawk[_0x1c24e9(0xa6)][_0x1c24e9(0x1b4)](_0x51fd94,_0x51f7aa,_0x947d);expect(_0xb4e0e6[_0x1c24e9(0xed)])['to'][_0x1c24e9(0x13f)](_0x1c24e9(0x14e));const {credentials:_0x2dd6d}=await Hawk[_0x1c24e9(0xa6)][_0x1c24e9(0x1b4)](_0x348d1b,_0x51f7aa,_0x947d);_0x3d70ff[_0x1c24e9(0x21f)](expect,_0x2dd6d[_0x1c24e9(0xed)])['to'][_0x1c24e9(0x13f)](_0x3d70ff['ettaK']);}),it(_0x474a11[_0x30a50e(0x198)],async()=>{const _0x10643a=_0x30a50e,_0x1a8b3c={'method':_0x474a11[_0x10643a(0xdb)],'url':_0x10643a(0x197),'host':'example.com','port':0x1f90,'authorization':_0x10643a(0x17b)};await expect(Hawk['server'][_0x10643a(0x1b4)](_0x1a8b3c,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x10643a(0x181)]['now']()}))['to'][_0x10643a(0x1ef)](_0x474a11[_0x10643a(0x175)]);}),_0x474a11[_0x30a50e(0x170)](it,_0x474a11[_0x30a50e(0xc5)],async()=>{const _0x206c64=_0x30a50e,_0x27b922={'method':_0x206c64(0x1e3),'url':'/resource/4?filter=a','host':_0x474a11[_0x206c64(0xc9)],'port':0x1f90,'authorization':'!@#'};await expect(Hawk[_0x206c64(0xa6)][_0x206c64(0x1b4)](_0x27b922,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x206c64(0x126)](0x13b34143208,Hawk[_0x206c64(0x181)][_0x206c64(0xc6)]())}))['to'][_0x206c64(0x1ef)](_0x206c64(0xac));}),_0x474a11[_0x30a50e(0x170)](it,_0x474a11[_0x30a50e(0x1c6)],async()=>{const _0x356f57=_0x30a50e;if(_0x3d70ff[_0x356f57(0x18f)]==='MAdwu'){const _0x326a38={'method':_0x356f57(0x1e3),'url':_0x3d70ff[_0x356f57(0x1b5)],'host':_0x3d70ff[_0x356f57(0xc4)],'port':0x1f90},_0x2ae723=await expect(Hawk[_0x356f57(0xa6)]['authenticate'](_0x326a38,_0xb5aee9))['to']['reject']();_0x3d70ff[_0x356f57(0x132)](expect,_0x2ae723[_0x356f57(0x9f)])['to']['equal'](!![]);}else throw new _0xd7e033();}),it(_0x30a50e(0x183),async()=>{const _0x4181d7=_0x30a50e,_0x2153e0={'method':_0x4181d7(0x1e3),'url':_0x4181d7(0x197),'headers':{'authorization':_0x4181d7(0x1ba)}};await expect(Hawk[_0x4181d7(0xa6)][_0x4181d7(0x1b4)](_0x2153e0,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x4181d7(0x181)][_0x4181d7(0xc6)]()}))['to'][_0x4181d7(0x1ef)](_0x4181d7(0x1cc));}),it(_0x474a11[_0x30a50e(0x201)],async()=>{const _0x5d7a4f=_0x30a50e,_0x4f598d={'method':_0x3d70ff[_0x5d7a4f(0xb0)],'url':_0x3d70ff[_0x5d7a4f(0x1b5)],'host':_0x5d7a4f(0x116),'port':0x1f90,'authorization':_0x3d70ff[_0x5d7a4f(0x1c1)]};await expect(Hawk[_0x5d7a4f(0xa6)][_0x5d7a4f(0x1b4)](_0x4f598d,_0xb5aee9,{'localtimeOffsetMsec':_0x3d70ff[_0x5d7a4f(0x1ec)](0x13b34143208,Hawk[_0x5d7a4f(0x181)][_0x5d7a4f(0xc6)]())}))['to'][_0x5d7a4f(0x1ef)](_0x3d70ff[_0x5d7a4f(0xf4)]);}),_0x474a11[_0x30a50e(0x1a8)](it,_0x474a11['qRLvC'],async()=>{const _0x37345d=_0x30a50e,_0xb38655={'method':_0x474a11[_0x37345d(0xdb)],'url':_0x474a11[_0x37345d(0x1ce)],'host':_0x474a11[_0x37345d(0xc9)],'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'};await _0x474a11[_0x37345d(0x225)](expect,Hawk[_0x37345d(0xa6)][_0x37345d(0x1b4)](_0xb38655,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x37345d(0x1da)](0x13b34143208,Hawk['utils'][_0x37345d(0xc6)]())}))['to'][_0x37345d(0x1ef)](_0x474a11[_0x37345d(0x1dd)]);}),_0x474a11[_0x30a50e(0x153)](it,_0x474a11[_0x30a50e(0x192)],async()=>{const _0x771008=_0x30a50e,_0x351865={'method':_0x771008(0x1e3),'url':_0x771008(0x197),'host':'example.com','port':0x1f90,'authorization':_0x771008(0x134)};await expect(Hawk['server']['authenticate'](_0x351865,_0xb5aee9,{'localtimeOffsetMsec':_0x3d70ff[_0x771008(0x1d4)](0x13b34143208,Hawk[_0x771008(0x181)][_0x771008(0xc6)]())}))['to'][_0x771008(0x1ef)](_0x3d70ff[_0x771008(0xf4)]);}),it(_0x30a50e(0xa1),async()=>{const _0xbbb2e5=_0x30a50e,_0x4edd58={'method':_0x474a11[_0xbbb2e5(0xdb)],'url':_0xbbb2e5(0x197),'host':_0xbbb2e5(0x116),'port':0x1f90,'authorization':_0xbbb2e5(0x200)};await expect(Hawk['server'][_0xbbb2e5(0x1b4)](_0x4edd58,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11['NzQMM'](0x13b34143208,Hawk['utils'][_0xbbb2e5(0xc6)]())}))['to']['reject']('Missing\x20attributes');}),it(_0x30a50e(0xa5),async()=>{const _0x5a01e3=_0x30a50e,_0x5003c1={'method':_0x3d70ff[_0x5a01e3(0xb0)],'url':_0x5a01e3(0x197),'host':_0x5a01e3(0x116),'port':0x1f90,'authorization':_0x5a01e3(0x1aa)};await expect(Hawk['server'][_0x5a01e3(0x1b4)](_0x5003c1,_0xb5aee9,{'localtimeOffsetMsec':_0x3d70ff['JRCVe'](0x13b34143208,Hawk[_0x5a01e3(0x181)][_0x5a01e3(0xc6)]())}))['to'][_0x5a01e3(0x1ef)](_0x5a01e3(0x22e));}),it(_0x474a11[_0x30a50e(0x217)],async()=>{const _0x5e261a=_0x30a50e,_0x1c3877={'method':_0x3d70ff[_0x5e261a(0xb0)],'url':_0x5e261a(0x197),'host':_0x3d70ff[_0x5e261a(0xc4)],'port':0x1f90,'authorization':_0x5e261a(0x199)};await _0x3d70ff[_0x5e261a(0xe4)](expect,Hawk['server']['authenticate'](_0x1c3877,_0xb5aee9,{'localtimeOffsetMsec':_0x3d70ff['rdNtj'](0x13b34143208,Hawk[_0x5e261a(0x181)][_0x5e261a(0xc6)]())}))['to'][_0x5e261a(0x1ef)](_0x5e261a(0x123));}),_0x474a11[_0x30a50e(0x153)](it,_0x474a11[_0x30a50e(0xf7)],async()=>{const _0x422d07=_0x30a50e,_0x2fe61a={'method':_0x422d07(0x1e3),'url':_0x422d07(0x197),'host':_0x3d70ff[_0x422d07(0xc4)],'port':0x1f90,'authorization':_0x3d70ff['IbObD']};await _0x3d70ff[_0x422d07(0x132)](expect,Hawk[_0x422d07(0xa6)][_0x422d07(0x1b4)](_0x2fe61a,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x422d07(0x181)][_0x422d07(0xc6)]()}))['to'][_0x422d07(0x1ef)](_0x422d07(0x17e));}),it(_0x474a11[_0x30a50e(0x1c3)],async()=>{const _0x2abd3f=_0x30a50e,_0xefaca1={'method':'GET','url':'/resource/4?filter=a','host':'example.com','port':0x1f90,'authorization':_0x3d70ff[_0x2abd3f(0x147)]};await expect(Hawk[_0x2abd3f(0xa6)]['authenticate'](_0xefaca1,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x2abd3f(0x181)][_0x2abd3f(0xc6)]()}))['to'][_0x2abd3f(0x1ef)](_0x3d70ff[_0x2abd3f(0x184)]);}),_0x474a11[_0x30a50e(0x188)](it,_0x30a50e(0x17c),async()=>{const _0x3e150f=_0x30a50e,_0x358eb9={'method':_0x3d70ff[_0x3e150f(0xb0)],'url':_0x3e150f(0x197),'host':'example.com','port':0x1f90,'authorization':_0x3d70ff[_0x3e150f(0x118)]};await expect(Hawk['server'][_0x3e150f(0x1b4)](_0x358eb9,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x3e150f(0x181)][_0x3e150f(0xc6)]()}))['to'][_0x3e150f(0x1ef)](_0x3e150f(0x151));}),_0x474a11[_0x30a50e(0x153)](it,'errors\x20on\x20an\x20invalid\x20authorization\x20header\x20format',async()=>{const _0x578e20=_0x30a50e,_0x30b115={'method':_0x3d70ff[_0x578e20(0xb0)],'url':_0x578e20(0x197),'host':_0x3d70ff['PiOpS'],'port':0x1f90,'authorization':_0x3d70ff[_0x578e20(0xd2)]};await _0x3d70ff[_0x578e20(0xe8)](expect,Hawk[_0x578e20(0xa6)][_0x578e20(0x1b4)](_0x30b115,_0xb5aee9,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x578e20(0x181)][_0x578e20(0xc6)]()}))['to'][_0x578e20(0x1ef)](_0x3d70ff[_0x578e20(0x214)]);}),it(_0x30a50e(0xa0),async()=>{const _0x12bed7=_0x30a50e,_0x211236={'method':_0x474a11['jElfB'],'url':_0x474a11[_0x12bed7(0x1ce)],'headers':{'host':':8080','authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'}};await expect(Hawk[_0x12bed7(0xa6)]['authenticate'](_0x211236,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x12bed7(0x231)](0x13b34143208,Hawk[_0x12bed7(0x181)][_0x12bed7(0xc6)]())}))['to'][_0x12bed7(0x1ef)](_0x12bed7(0x1cc));}),_0x474a11[_0x30a50e(0xa3)](it,'errors\x20on\x20an\x20bad\x20host\x20header\x20(pad\x20port)',async()=>{const _0x548f29=_0x30a50e,_0x47fe16={'method':_0x474a11[_0x548f29(0xdb)],'url':'/resource/4?filter=a','headers':{'host':_0x548f29(0x19c),'authorization':_0x474a11[_0x548f29(0x111)]}};await expect(Hawk[_0x548f29(0xa6)][_0x548f29(0x1b4)](_0x47fe16,_0xb5aee9,{'localtimeOffsetMsec':_0x474a11[_0x548f29(0x15b)](0x13b34143208,Hawk['utils'][_0x548f29(0xc6)]())}))['to']['reject'](_0x548f29(0x1cc));}),it(_0x474a11[_0x30a50e(0x1e5)],async()=>{const _0x5352b2=_0x30a50e,_0x4e3b2f={'method':'GET','url':_0x474a11[_0x5352b2(0x1ce)],'host':_0x5352b2(0x116),'port':0x1f90,'authorization':_0x474a11[_0x5352b2(0x111)]},_0x40fb0d=function(_0x348d96){throw new Error('Unknown\x20user');};await expect(Hawk[_0x5352b2(0xa6)][_0x5352b2(0x1b4)](_0x4e3b2f,_0x40fb0d,{'localtimeOffsetMsec':_0x474a11[_0x5352b2(0x1ad)](0x13b34143208,Hawk[_0x5352b2(0x181)]['now']())}))['to'][_0x5352b2(0x1ef)](_0x474a11[_0x5352b2(0x137)]);}),_0x474a11[_0x30a50e(0xb4)](it,_0x474a11[_0x30a50e(0x1a3)],async()=>{const _0x56f844=_0x30a50e,_0x9b6e0a={'PNxQI':_0x56f844(0xae)},_0x355de3={'method':_0x474a11['jElfB'],'url':_0x474a11[_0x56f844(0x1ce)],'host':_0x474a11[_0x56f844(0xc9)],'port':0x1f90,'authorization':_0x474a11[_0x56f844(0x111)]},_0x2c2a32=function(_0x4105fb){const _0x3eae4e=_0x56f844,_0x26279c=new Error(_0x9b6e0a['PNxQI']);_0x26279c['credentials']={'some':_0x3eae4e(0x168)};throw _0x26279c;},_0x225b4f=await expect(Hawk['server'][_0x56f844(0x1b4)](_0x355de3,_0x2c2a32,{'localtimeOffsetMsec':_0x474a11[_0x56f844(0x15b)](0x13b34143208,Hawk[_0x56f844(0x181)]['now']())}))['to'][_0x56f844(0x1ef)](_0x474a11[_0x56f844(0x137)]);_0x474a11[_0x56f844(0xd0)](expect,_0x225b4f[_0x56f844(0x124)][_0x56f844(0x16e)])['to']['equal'](_0x474a11['XrBDB']);}),_0x474a11[_0x30a50e(0x18b)](it,_0x474a11[_0x30a50e(0x1f2)],async()=>{const _0x2c35e8=_0x30a50e,_0x2c19a9={'zEnVd':function(_0x2f084e,_0x173d66){const _0x2c6161=_0x3046;return _0x3d70ff[_0x2c6161(0x228)](_0x2f084e,_0x173d66);},'zXreF':_0x3d70ff[_0x2c35e8(0x1f3)],'uFJPW':_0x2c35e8(0x14e),'xVqoF':function(_0x26ffca,_0x12db4c){const _0x3d9aa6=_0x2c35e8;return _0x3d70ff[_0x3d9aa6(0x177)](_0x26ffca,_0x12db4c);}},_0x35c61e={'method':_0x3d70ff['nYdsJ'],'url':_0x2c35e8(0x197),'host':_0x3d70ff[_0x2c35e8(0xc4)],'port':0x1f90,'authorization':_0x2c35e8(0x1ba)},_0x5ea7d7=function(_0x9a0690){const _0x322149=_0x2c35e8;return _0x2c19a9[_0x322149(0x156)](_0x322149(0x12b),_0x322149(0x12b))?{'id':_0x5ccc10,'key':_0x322149(0x1fe),'algorithm':_0x2c19a9[_0x322149(0x19a)](_0x31aa6f,'1')?_0x2c19a9[_0x322149(0x16c)]:_0x322149(0x223),'user':_0x2c19a9['uFJPW']}:null;};await expect(Hawk[_0x2c35e8(0xa6)][_0x2c35e8(0x1b4)](_0x35c61e,_0x5ea7d7,{'localtimeOffsetMsec':_0x3d70ff['ANEkm'](0x13b34143208,Hawk[_0x2c35e8(0x181)][_0x2c35e8(0xc6)]())}))['to']['reject'](_0x2c35e8(0x190));}),_0x474a11['zztRX'](it,_0x474a11[_0x30a50e(0xc0)],async()=>{const _0x545b99=_0x30a50e;if(_0x545b99(0x14b)!==_0x3d70ff[_0x545b99(0xea)]){const _0x18accd={'lNQBP':function(_0x109422,_0x4831ee){const _0x62a657=_0x545b99;return _0x3d70ff[_0x62a657(0xe0)](_0x109422,_0x4831ee);}};_0x3d70ff['qfPTb'](_0x466db7,_0x545b99(0x16a),()=>{const _0xc4c80=_0x545b99;_0x18accd[_0xc4c80(0x1d3)](_0x5387d8,()=>_0x218134['server'][_0xc4c80(0xb3)](_0xc4c80(0x13b),{'hash':_0xc4c80(0x13b)}))['to'][_0xc4c80(0x21d)][_0xc4c80(0x11b)](),_0x323717(()=>_0x3f5a9b['server'][_0xc4c80(0xb3)](_0xc4c80(0x15c),{'hash':_0xc4c80(0x13b)}))['to'][_0xc4c80(0x11b)]('Bad\x20payload\x20hash');});}else{const _0x59060a={'method':_0x3d70ff[_0x545b99(0xb0)],'url':_0x545b99(0x197),'host':_0x545b99(0x116),'port':0x1f90,'authorization':_0x3d70ff[_0x545b99(0x195)]},_0x1d2d1f=function(_0x294150){return{'key':_0x3d70ff['CuJsA'],'user':_0x3d70ff['Pjjdx']};},_0x2b047e=await _0x3d70ff['GgSjn'](expect,Hawk['server'][_0x545b99(0x1b4)](_0x59060a,_0x1d2d1f,{'localtimeOffsetMsec':0x13b34143208-Hawk['utils'][_0x545b99(0xc6)]()}))['to'][_0x545b99(0x1ef)](_0x3d70ff[_0x545b99(0x1ae)]);_0x3d70ff[_0x545b99(0x222)](expect,_0x2b047e[_0x545b99(0x1c4)]['payload']['message'])['to'][_0x545b99(0x13f)](_0x3d70ff[_0x545b99(0x1b1)]);}}),_0x474a11[_0x30a50e(0x229)](it,_0x474a11[_0x30a50e(0x1af)],async()=>{const _0x540a17=_0x30a50e,_0x16e898={'method':_0x3d70ff[_0x540a17(0xb0)],'url':'/resource/4?filter=a','host':'example.com','port':0x1f90,'authorization':_0x3d70ff[_0x540a17(0x195)]},_0x380778=function(_0x287302){const _0x41129f=_0x540a17;return{'id':'23434d3q4d5345d','user':_0x41129f(0x14e)};},_0xf22e52=await _0x3d70ff[_0x540a17(0x105)](expect,Hawk[_0x540a17(0xa6)][_0x540a17(0x1b4)](_0x16e898,_0x380778,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x540a17(0x181)][_0x540a17(0xc6)]()}))['to'][_0x540a17(0x1ef)](_0x3d70ff[_0x540a17(0x1ae)]);_0x3d70ff['uLPOq'](expect,_0xf22e52['output'][_0x540a17(0x1e4)]['message'])['to'][_0x540a17(0x13f)](_0x540a17(0xcd));}),it(_0x30a50e(0x224),async()=>{const _0x481358=_0x30a50e,_0x1359a={'method':_0x474a11[_0x481358(0xdb)],'url':_0x474a11[_0x481358(0x1ce)],'host':_0x481358(0x116),'port':0x1f90,'authorization':_0x481358(0x1ba)},_0x98877d=function(_0x634389){const _0x4f644f=_0x481358;return{'key':_0x4f644f(0x1fe),'algorithm':_0x4f644f(0x135),'user':_0x3d70ff[_0x4f644f(0xfd)]};},_0x1d50e1=await _0x474a11[_0x481358(0xd0)](expect,Hawk[_0x481358(0xa6)][_0x481358(0x1b4)](_0x1359a,_0x98877d,{'localtimeOffsetMsec':_0x474a11['NzQMM'](0x13b34143208,Hawk[_0x481358(0x181)][_0x481358(0xc6)]())}))['to'][_0x481358(0x1ef)](_0x474a11[_0x481358(0x1db)]);_0x474a11[_0x481358(0x206)](expect,_0x1d50e1[_0x481358(0x1c4)][_0x481358(0x1e4)][_0x481358(0xe9)])['to']['equal'](_0x474a11[_0x481358(0xe6)]);}),_0x474a11['hCjTj'](it,_0x30a50e(0x114),async()=>{const _0x9b42df=_0x30a50e;if(_0x474a11['kCwCu']('wUbaM',_0x9b42df(0x120))){const _0x1be105={'method':_0x9b42df(0x1e3),'url':_0x9b42df(0x197),'host':_0x9b42df(0x116),'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcU4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'},_0xf85639=function(_0x18ca72){const _0x49654e=_0x9b42df;return{'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x49654e(0x223),'user':_0x49654e(0x14e)};};await expect(Hawk[_0x9b42df(0xa6)]['authenticate'](_0x1be105,_0xf85639,{'localtimeOffsetMsec':_0x474a11['lmbdt'](0x13b34143208,Hawk[_0x9b42df(0x181)][_0x9b42df(0xc6)]())}))['to'][_0x9b42df(0x1ef)](_0x474a11[_0x9b42df(0x1e0)]);}else{const _0x5ec1dc={'123':{'id':_0x38e6b0,'key':_0x9b42df(0x1fe),'algorithm':_0x304161==='1'?_0x9b42df(0xc2):_0x9b42df(0x223),'user':_0x3d70ff[_0x9b42df(0xfd)]},'456':{'id':_0x403bdf,'key':_0x3d70ff[_0x9b42df(0x110)],'algorithm':_0x3d70ff['hCkvW'](_0x49738e,'1')?_0x9b42df(0xc2):_0x9b42df(0x223),'user':_0x9b42df(0x143)}};return _0x5ec1dc[_0x5864e1];}});}),_0x474a11[_0x54b113(0x1f8)](describe,_0x474a11[_0x54b113(0x1b9)],()=>{const _0x191c40=_0x54b113,_0x3e7188={'PnFxP':_0x474a11[_0x191c40(0x169)],'OAScn':_0x191c40(0x161),'txGrI':_0x191c40(0x131),'AcZhz':_0x474a11[_0x191c40(0x1f1)],'CzyNE':'some-app-data','CFACk':_0x474a11[_0x191c40(0x20d)],'YkBRG':_0x474a11['mDAzR'],'UJbgK':function(_0x443a8e,_0x2d6f9b){return _0x443a8e(_0x2d6f9b);},'ORpAY':_0x474a11[_0x191c40(0x1d5)],'OtJkQ':_0x191c40(0xfb),'vrIzv':_0x191c40(0x116),'pCxBB':_0x191c40(0x18a),'ehZQk':_0x191c40(0x216),'uOtQR':_0x474a11['pojfs'],'xGmrF':_0x474a11[_0x191c40(0x145)],'TiGiQ':_0x191c40(0x197),'uDsIs':_0x474a11[_0x191c40(0xbc)],'GerfH':_0x191c40(0x130),'vvAfV':function(_0x5423dd,_0x1036fe){return _0x5423dd(_0x1036fe);},'MUOfS':function(_0x58e385,_0x2f0b57){const _0xe268ce=_0x191c40;return _0x474a11[_0xe268ce(0xe5)](_0x58e385,_0x2f0b57);},'SXqwO':_0x474a11['clUnm'],'YkQYO':_0x191c40(0x164)};it(_0x474a11[_0x191c40(0xcf)],()=>{const _0xf5a6ea=_0x191c40,_0x10063d={'id':_0xf5a6ea(0x182),'key':_0xf5a6ea(0x1fe),'algorithm':_0x474a11['pojfs'],'user':_0xf5a6ea(0x14e)},_0x347c40={'method':_0xf5a6ea(0x130),'host':_0x474a11[_0xf5a6ea(0xc9)],'port':_0x474a11[_0xf5a6ea(0x152)],'resource':_0xf5a6ea(0x197),'ts':_0x474a11['cNMxN'],'nonce':'xUwusx','hash':_0x474a11['USRgp'],'ext':'some-app-data','mac':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','id':'123456'},_0xb7bac7=Hawk[_0xf5a6ea(0xa6)][_0xf5a6ea(0x207)](_0x10063d,_0x347c40,{'payload':_0x474a11[_0xf5a6ea(0xe3)],'contentType':_0x474a11[_0xf5a6ea(0x1de)],'ext':_0x474a11['viOvM']});_0x474a11[_0xf5a6ea(0x206)](expect,_0xb7bac7)['to'][_0xf5a6ea(0x13f)](_0x474a11[_0xf5a6ea(0x158)]);}),_0x474a11['MNdDz'](it,_0x474a11['zoicQ'],()=>{const _0x58e9d7=_0x191c40;if(_0x58e9d7(0x10a)!==_0x3e7188[_0x58e9d7(0x22b)]){const _0x3f36fc={'id':_0x58e9d7(0x182),'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x58e9d7(0x223),'user':_0x58e9d7(0x14e)},_0x38a415={'method':_0x58e9d7(0x130),'host':_0x3e7188[_0x58e9d7(0x115)],'port':_0x58e9d7(0x161),'resource':_0x58e9d7(0x197),'ts':_0x58e9d7(0x131),'nonce':_0x58e9d7(0x1be),'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':'some-app-data','mac':_0x58e9d7(0xef),'id':'123456'},_0x532ed8=Hawk[_0x58e9d7(0xa6)][_0x58e9d7(0x207)](_0x3f36fc,_0x38a415,{'payload':'','contentType':_0x58e9d7(0xb6),'ext':_0x3e7188['pCxBB']});expect(_0x532ed8)['to'][_0x58e9d7(0x13f)](_0x3e7188[_0x58e9d7(0x193)]);}else{const _0x1ba0b0={'id':_0x58e9d7(0x182),'algorithm':_0x58e9d7(0x223),'user':_0x3e7188['PnFxP']},_0x40f65f={'method':_0x58e9d7(0x130),'host':'example.com','port':_0x3e7188[_0x58e9d7(0x12a)],'resource':_0x58e9d7(0x197),'ts':_0x3e7188[_0x58e9d7(0x1f7)],'nonce':_0x3e7188[_0x58e9d7(0x20e)],'hash':_0x58e9d7(0x14d),'ext':_0x3e7188['CzyNE'],'mac':_0x3e7188[_0x58e9d7(0x146)],'id':_0x3e7188[_0x58e9d7(0x157)]};_0x3e7188[_0x58e9d7(0x101)](_0x48d021,()=>_0x4b80d4['server'][_0x58e9d7(0x207)](_0x1ba0b0,_0x40f65f,{'payload':_0x58e9d7(0x21c),'contentType':_0x58e9d7(0xb6),'ext':_0x58e9d7(0x18a)}))['to'][_0x58e9d7(0x11b)](_0x3e7188[_0x58e9d7(0x219)]);}}),_0x474a11[_0x191c40(0x1a7)](it,'generates\x20header\x20(empty\x20ext)',()=>{const _0x4b668a=_0x191c40,_0x4e0ac2={'id':_0x474a11['mDAzR'],'key':_0x474a11[_0x4b668a(0x1cb)],'algorithm':_0x474a11[_0x4b668a(0x18e)],'user':_0x474a11[_0x4b668a(0x169)]},_0x18a2bf={'method':_0x474a11[_0x4b668a(0xff)],'host':_0x4b668a(0x116),'port':_0x4b668a(0x161),'resource':_0x474a11['juIBe'],'ts':_0x4b668a(0x131),'nonce':_0x4b668a(0x1be),'hash':_0x4b668a(0x14d),'ext':'','mac':_0x4b668a(0xef),'id':_0x474a11[_0x4b668a(0x167)]},_0x1fdaee=Hawk[_0x4b668a(0xa6)][_0x4b668a(0x207)](_0x4e0ac2,_0x18a2bf,{'payload':'','contentType':_0x474a11[_0x4b668a(0x1de)],'ext':''});expect(_0x1fdaee)['to']['equal'](_0x4b668a(0xaf));}),_0x474a11[_0x191c40(0x1cf)](it,_0x474a11[_0x191c40(0xd8)],()=>{const _0x48c3ee=_0x191c40,_0x2abed9={'id':_0x474a11[_0x48c3ee(0x167)],'key':_0x474a11[_0x48c3ee(0x1cb)],'algorithm':_0x474a11['pojfs'],'user':_0x474a11[_0x48c3ee(0x169)]},_0x2758b6={'method':_0x48c3ee(0x130),'host':'example.com','port':_0x48c3ee(0x161),'resource':_0x474a11[_0x48c3ee(0x1ce)],'ts':_0x48c3ee(0x131),'nonce':_0x474a11['sLJIj'],'hash':_0x474a11[_0x48c3ee(0xbc)],'ext':_0x48c3ee(0x144),'mac':_0x48c3ee(0xef),'id':_0x474a11[_0x48c3ee(0x167)]},_0xd352fd={'payload':'some\x20reply','contentType':_0x48c3ee(0xb6),'ext':'response-specific'};_0xd352fd[_0x48c3ee(0xe1)]=Hawk[_0x48c3ee(0x10d)][_0x48c3ee(0x14a)](_0xd352fd[_0x48c3ee(0x1e4)],_0x2abed9[_0x48c3ee(0x165)],_0xd352fd['contentType']);const _0x3b0771=Hawk['server'][_0x48c3ee(0x207)](_0x2abed9,_0x2758b6,_0xd352fd);expect(_0x3b0771)['to'][_0x48c3ee(0x13f)](_0x474a11[_0x48c3ee(0x158)]);}),_0x474a11['qsala'](it,_0x474a11[_0x191c40(0x21a)],()=>{const _0xa2b6db=_0x191c40,_0x371f18={'id':_0x474a11['mDAzR'],'key':_0x474a11[_0xa2b6db(0x1cb)],'algorithm':_0x474a11[_0xa2b6db(0x18e)],'user':_0x474a11['TYbKZ']},_0x193692={'method':_0x474a11[_0xa2b6db(0xff)],'host':_0x474a11[_0xa2b6db(0xc9)],'port':_0x474a11[_0xa2b6db(0x152)],'resource':_0x474a11[_0xa2b6db(0x1ce)],'ts':_0x474a11[_0xa2b6db(0xa2)],'nonce':_0x474a11['sLJIj'],'hash':_0xa2b6db(0x14d),'mac':_0x474a11['uLOkq'],'id':_0xa2b6db(0x182)},_0x150fe6=Hawk[_0xa2b6db(0xa6)][_0xa2b6db(0x207)](_0x371f18,_0x193692,{'payload':_0xa2b6db(0x21c),'contentType':_0xa2b6db(0xb6),'ext':null});_0x474a11[_0xa2b6db(0xcc)](expect,_0x150fe6)['to'][_0xa2b6db(0x13f)](_0x474a11[_0xa2b6db(0x129)]);}),it(_0x474a11['iALCd'],()=>{const _0x2e2ba5=_0x191c40,_0x4e7e11={'id':_0x474a11[_0x2e2ba5(0x167)],'key':_0x474a11['QRKXZ'],'algorithm':_0x2e2ba5(0x223),'user':_0x2e2ba5(0x14e)};expect(()=>Hawk[_0x2e2ba5(0xa6)][_0x2e2ba5(0x207)](_0x4e7e11,null,{'payload':'some\x20reply','contentType':'text/plain','ext':'response-specific'}))['to'][_0x2e2ba5(0x11b)]('Invalid\x20inputs');}),_0x474a11[_0x191c40(0x155)](it,_0x474a11[_0x191c40(0x21e)],()=>{const _0x542b01=_0x191c40,_0x17f4bf={'id':_0x542b01(0x182),'key':_0x542b01(0x1fe),'algorithm':_0x3e7188[_0x542b01(0xf8)],'user':_0x3e7188[_0x542b01(0xa4)]};expect(()=>Hawk[_0x542b01(0xa6)][_0x542b01(0x207)](_0x17f4bf,0x5,{'payload':_0x542b01(0x21c),'contentType':_0x542b01(0xb6),'ext':_0x542b01(0x18a)}))['to']['throw'](_0x3e7188['xGmrF']);}),it(_0x474a11[_0x191c40(0x1f2)],()=>{const _0x399edd=_0x191c40,_0x232d90={'method':_0x399edd(0x130),'host':'example.com','port':_0x3e7188['OAScn'],'resource':_0x3e7188[_0x399edd(0x1fd)],'ts':_0x399edd(0x131),'nonce':_0x3e7188[_0x399edd(0x20e)],'hash':_0x3e7188['uDsIs'],'ext':_0x3e7188[_0x399edd(0x15a)],'mac':_0x3e7188[_0x399edd(0x146)],'id':_0x3e7188[_0x399edd(0x157)]};_0x3e7188[_0x399edd(0x101)](expect,()=>Hawk[_0x399edd(0xa6)]['header'](null,_0x232d90,{'payload':_0x399edd(0x21c),'contentType':_0x399edd(0xb6),'ext':_0x399edd(0x18a)}))['to'][_0x399edd(0x11b)](_0x3e7188['ORpAY']);}),it(_0x191c40(0x1ff),()=>{const _0x2955ae=_0x191c40,_0x25c132={'id':_0x2955ae(0x182),'algorithm':_0x2955ae(0x223),'user':_0x3e7188['PnFxP']},_0x4308fc={'method':_0x3e7188[_0x2955ae(0x10f)],'host':_0x3e7188['vrIzv'],'port':_0x3e7188[_0x2955ae(0x12a)],'resource':_0x3e7188[_0x2955ae(0x1fd)],'ts':_0x3e7188[_0x2955ae(0x1f7)],'nonce':'xUwusx','hash':_0x3e7188[_0x2955ae(0x1bd)],'ext':_0x2955ae(0x144),'mac':_0x2955ae(0xef),'id':_0x2955ae(0x182)};_0x3e7188[_0x2955ae(0x1a4)](expect,()=>Hawk[_0x2955ae(0xa6)][_0x2955ae(0x207)](_0x25c132,_0x4308fc,{'payload':_0x2955ae(0x21c),'contentType':_0x2955ae(0xb6),'ext':_0x2955ae(0x18a)}))['to'][_0x2955ae(0x11b)](_0x2955ae(0x209));}),_0x474a11[_0x191c40(0x18d)](it,_0x474a11[_0x191c40(0x1bf)],()=>{const _0x489d61=_0x191c40;if(_0x3e7188[_0x489d61(0x172)](_0x3e7188[_0x489d61(0x10c)],_0x3e7188[_0x489d61(0xf1)])){const _0x2efc59={'id':_0x489d61(0x182),'algorithm':_0x489d61(0x223),'user':'steve'},_0x4a3a1f={'method':_0x489d61(0x130),'host':_0x489d61(0x116),'port':_0x489d61(0x161),'resource':_0x3e7188[_0x489d61(0x1fd)],'ts':_0x3e7188[_0x489d61(0x1f7)],'nonce':_0x489d61(0x1be),'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':_0x3e7188[_0x489d61(0x15a)],'mac':_0x3e7188[_0x489d61(0x146)],'id':_0x3e7188['YkBRG']};_0x5c2dba(()=>_0x16cb5b[_0x489d61(0xa6)][_0x489d61(0x207)](_0x2efc59,_0x4a3a1f,'abc'))['to'][_0x489d61(0x11b)](_0x3e7188[_0x489d61(0xbf)]);}else{const _0x324ee4={'id':_0x3e7188[_0x489d61(0x157)],'key':'asdasd','user':_0x3e7188[_0x489d61(0xa4)]},_0x60827b={'method':_0x3e7188[_0x489d61(0x10f)],'host':'example.com','port':_0x489d61(0x161),'resource':'/resource/4?filter=a','ts':_0x3e7188[_0x489d61(0x1f7)],'nonce':_0x3e7188[_0x489d61(0x20e)],'hash':_0x3e7188[_0x489d61(0x1bd)],'ext':_0x489d61(0x144),'mac':_0x3e7188[_0x489d61(0x146)],'id':_0x489d61(0x182)};expect(()=>Hawk['server'][_0x489d61(0x207)](_0x324ee4,_0x60827b,{'payload':_0x489d61(0x21c),'contentType':'text/plain','ext':_0x489d61(0x18a)}))['to'][_0x489d61(0x11b)](_0x489d61(0x209));}}),it(_0x474a11['tCFmR'],()=>{const _0x2c8dab=_0x191c40,_0x1bb73a={'id':_0x2c8dab(0x182),'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':'x','user':_0x2c8dab(0x14e)},_0x570a62={'method':'POST','host':_0x474a11[_0x2c8dab(0xc9)],'port':_0x474a11[_0x2c8dab(0x152)],'resource':_0x2c8dab(0x197),'ts':_0x2c8dab(0x131),'nonce':_0x2c8dab(0x1be),'hash':_0x2c8dab(0x14d),'ext':'some-app-data','mac':_0x474a11['uLOkq'],'id':_0x2c8dab(0x182)};expect(()=>Hawk[_0x2c8dab(0xa6)][_0x2c8dab(0x207)](_0x1bb73a,_0x570a62,{'payload':_0x2c8dab(0x21c),'contentType':_0x2c8dab(0xb6),'ext':'response-specific'}))['to']['throw'](_0x2c8dab(0x106));}),_0x474a11[_0x191c40(0x1a8)](it,_0x474a11[_0x191c40(0x13a)],()=>{const _0x22a6e5=_0x191c40,_0x3f4ed3={'id':_0x3e7188[_0x22a6e5(0x157)],'algorithm':_0x3e7188[_0x22a6e5(0xf8)],'user':_0x3e7188[_0x22a6e5(0xa4)]},_0x3e68ac={'method':_0x22a6e5(0x130),'host':_0x3e7188[_0x22a6e5(0x115)],'port':_0x3e7188[_0x22a6e5(0x12a)],'resource':_0x22a6e5(0x197),'ts':_0x22a6e5(0x131),'nonce':_0x3e7188[_0x22a6e5(0x20e)],'hash':_0x22a6e5(0x14d),'ext':_0x22a6e5(0x144),'mac':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','id':_0x22a6e5(0x182)};expect(()=>Hawk[_0x22a6e5(0xa6)]['header'](_0x3f4ed3,_0x3e68ac,_0x22a6e5(0x128)))['to']['throw'](_0x22a6e5(0x127));});}),describe(_0x54b113(0x213),()=>{const _0x21f9a2=_0x54b113;_0x474a11[_0x21f9a2(0x16f)](it,'errors\x20on\x20uri\x20too\x20long',async()=>{const _0x1370af=_0x21f9a2;let _0xbc6255='/';for(let _0x1f3b3c=0x0;_0x1f3b3c<0x1388;++_0x1f3b3c){_0xbc6255+='x';}const _0x1ef639={'method':_0x474a11[_0x1370af(0xdb)],'url':_0xbc6255,'host':_0x1370af(0x116),'port':0x1f90,'authorization':_0x1370af(0x1b0)},_0x5a935e=await _0x474a11['DYwcA'](expect,Hawk[_0x1370af(0xa6)][_0x1370af(0xf5)](_0x1ef639,_0xb5aee9,{}))['to'][_0x1370af(0x1ef)](_0x474a11[_0x1370af(0x1a2)]);_0x474a11[_0x1370af(0xd0)](expect,_0x5a935e['output'][_0x1370af(0x226)])['to'][_0x1370af(0x13f)](0x190);});}),describe(_0x474a11[_0x54b113(0x17f)],()=>{const _0x1863d1=_0x54b113,_0x31c420={'RjiNP':function(_0x5092e2,_0x2312da){return _0x5092e2(_0x2312da);},'XOqBj':_0x474a11['mDAzR'],'CRQNd':_0x1863d1(0x1d0),'fCPKs':_0x474a11['ljCaB'],'oYjBI':_0x1863d1(0x1c8),'mVfVp':_0x1863d1(0xc7),'fhiWa':_0x474a11['loMST'],'qXfnq':function(_0x5bf182,_0x5c9eee){return _0x5bf182(_0x5c9eee);},'VXGZn':_0x1863d1(0x1ac),'mMRAs':_0x474a11['LFcJD'],'wJFET':function(_0x2029e9,_0x21e46b){const _0x2a240b=_0x1863d1;return _0x474a11[_0x2a240b(0x1ee)](_0x2029e9,_0x21e46b);},'WLydq':function(_0x2cc5c4,_0xa7e1df){return _0x2cc5c4(_0xa7e1df);},'MLrCh':function(_0x4980f7,_0x23841e){return _0x474a11['gAbXB'](_0x4980f7,_0x23841e);},'EYjGM':function(_0x37f2d0,_0x4062a5){return _0x37f2d0(_0x4062a5);},'gWzCg':_0x474a11['ZgkSQ'],'qVkOT':_0x474a11[_0x1863d1(0x18e)],'UxDow':_0x474a11[_0x1863d1(0x169)],'aQmlp':_0x474a11[_0x1863d1(0xd1)],'Uallk':function(_0xf4b1d8,_0x37a992){const _0x38f10b=_0x1863d1;return _0x474a11[_0x38f10b(0x174)](_0xf4b1d8,_0x37a992);},'qJzYO':_0x474a11[_0x1863d1(0x1c0)],'syXOc':function(_0x404886,_0x129da8){const _0xffe5c=_0x1863d1;return _0x474a11[_0xffe5c(0x142)](_0x404886,_0x129da8);},'lwCPa':_0x1863d1(0x209),'cwGzs':_0x1863d1(0x1fa),'DogOQ':_0x474a11['izhnv'],'ypgBa':function(_0x42f149,_0x386c12){return _0x474a11['CFaFb'](_0x42f149,_0x386c12);},'xrTzo':_0x474a11['YTPXA']};it(_0x474a11[_0x1863d1(0xf2)],async()=>{const _0x4fdc43=_0x1863d1,_0x5ad11b=_0x31c420[_0x4fdc43(0x185)](_0xb5aee9,_0x31c420[_0x4fdc43(0xf0)]),_0x393b1b=Hawk[_0x4fdc43(0x205)][_0x4fdc43(0xe9)](_0x4fdc43(0x116),0x1f90,_0x31c420['CRQNd'],{'credentials':_0x5ad11b});delete _0x393b1b['ts'],await _0x31c420[_0x4fdc43(0x185)](expect,Hawk[_0x4fdc43(0xa6)][_0x4fdc43(0xd4)](_0x31c420[_0x4fdc43(0x208)],0x1f90,'some\x20message',_0x393b1b,_0xb5aee9))['to'][_0x4fdc43(0x1ef)](_0x4fdc43(0x1c5));}),it(_0x474a11[_0x1863d1(0xbe)],async()=>{const _0x566d4d=_0x1863d1,_0x448df6=_0x474a11[_0x566d4d(0xd0)](_0xb5aee9,_0x566d4d(0x182)),_0x4f5084=Hawk[_0x566d4d(0x205)][_0x566d4d(0xe9)]('example.com',0x1f90,_0x474a11[_0x566d4d(0x20f)],{'credentials':_0x448df6});delete _0x4f5084[_0x566d4d(0xbd)],await expect(Hawk[_0x566d4d(0xa6)][_0x566d4d(0xd4)](_0x474a11[_0x566d4d(0xc9)],0x1f90,_0x566d4d(0x1d0),_0x4f5084,_0xb5aee9))['to'][_0x566d4d(0x1ef)](_0x566d4d(0x1c5));}),_0x474a11['QLWXf'](it,_0x1863d1(0xf6),async()=>{const _0x3c2edf=_0x1863d1,_0x149182=_0x474a11[_0x3c2edf(0xcc)](_0xb5aee9,_0x474a11['mDAzR']),_0x58291f=Hawk[_0x3c2edf(0x205)][_0x3c2edf(0xe9)](_0x474a11['ljCaB'],0x1f90,_0x474a11[_0x3c2edf(0x20f)],{'credentials':_0x149182});delete _0x58291f[_0x3c2edf(0xa7)],await expect(Hawk['server'][_0x3c2edf(0xd4)](_0x474a11[_0x3c2edf(0xc9)],0x1f90,_0x3c2edf(0x1d0),_0x58291f,_0xb5aee9))['to'][_0x3c2edf(0x1ef)](_0x474a11[_0x3c2edf(0x1a9)]);}),_0x474a11['YtnhV'](it,_0x474a11[_0x1863d1(0x230)],async()=>{const _0x41afca=_0x1863d1,_0x18eeb3=_0xb5aee9(_0x474a11[_0x41afca(0x167)]),_0x15878f=Hawk[_0x41afca(0x205)]['message'](_0x41afca(0x116),0x1f90,_0x474a11['FkHPE'],{'credentials':_0x18eeb3});delete _0x15878f['hash'],await expect(Hawk['server'][_0x41afca(0xd4)](_0x474a11[_0x41afca(0xc9)],0x1f90,_0x474a11['FkHPE'],_0x15878f,_0xb5aee9))['to']['reject'](_0x41afca(0x1c5));}),_0x474a11['nYYkG'](it,_0x1863d1(0x12c),async()=>{const _0x1936cf=_0x1863d1,_0x28458e={'vgTVi':_0x1936cf(0x168)};if(_0x31c420[_0x1936cf(0x1d1)]!==_0x31c420['mVfVp']){const _0x230e70=_0x31c420[_0x1936cf(0x185)](_0xb5aee9,_0x1936cf(0x182)),_0x4c4f19=Hawk[_0x1936cf(0x205)]['message'](_0x31c420[_0x1936cf(0x208)],0x1f90,_0x31c420[_0x1936cf(0x136)],{'credentials':_0x230e70}),_0x200511=await _0x31c420[_0x1936cf(0x185)](expect,Hawk[_0x1936cf(0xa6)][_0x1936cf(0xd4)]('example.com',0x1f90,_0x31c420[_0x1936cf(0x136)],_0x4c4f19,_0x32a63d=>{const _0x141838=_0x1936cf,_0x59e0b9=new Error(_0x141838(0x162));_0x59e0b9['credentials']={'some':_0x28458e['vgTVi']};throw _0x59e0b9;}))['to']['reject'](_0x31c420[_0x1936cf(0xb1)]);_0x31c420[_0x1936cf(0x185)](expect,_0x200511['credentials']['some'])['to'][_0x1936cf(0x13f)]('value');}else throw new _0x20de08();}),it(_0x474a11[_0x1863d1(0x1f0)],async()=>{const _0x382a03=_0x1863d1,_0x253431=_0xb5aee9(_0x31c420[_0x382a03(0xf0)]),_0x4e62b4=Hawk[_0x382a03(0x205)]['message']('example.com',0x1f90,_0x31c420[_0x382a03(0x136)],{'credentials':_0x253431}),_0x56851e=function(_0x236b19,_0x581dc0,_0x42424c){throw new Error();};await _0x31c420[_0x382a03(0x166)](expect,Hawk['server'][_0x382a03(0xd4)](_0x31c420['fCPKs'],0x1f90,_0x31c420[_0x382a03(0x136)],_0x4e62b4,_0xb5aee9,{'nonceFunc':_0x56851e}))['to'][_0x382a03(0x1ef)](_0x31c420[_0x382a03(0x138)]);}),it('should\x20generate\x20an\x20authorization\x20then\x20successfully\x20parse\x20it',async()=>{const _0x426c90=_0x1863d1,_0x175deb=_0x474a11[_0x426c90(0xdc)](_0xb5aee9,_0x426c90(0x182)),_0xcc91a0=Hawk['client'][_0x426c90(0xe9)](_0x426c90(0x116),0x1f90,_0x426c90(0x1d0),{'credentials':_0x175deb});expect(_0xcc91a0)['to'][_0x426c90(0x13c)]();const {credentials:_0x27f21b}=await Hawk[_0x426c90(0xa6)][_0x426c90(0xd4)](_0x474a11['ljCaB'],0x1f90,_0x474a11[_0x426c90(0x20f)],_0xcc91a0,_0xb5aee9);_0x474a11[_0x426c90(0x225)](expect,_0x27f21b[_0x426c90(0xed)])['to'][_0x426c90(0x13f)](_0x474a11[_0x426c90(0x169)]);}),it(_0x1863d1(0x1c2),async()=>{const _0x9741f=_0x1863d1,_0x3f73a0=_0xb5aee9(_0x474a11[_0x9741f(0x167)]),_0x1c9fb5=Hawk['client'][_0x9741f(0xe9)](_0x474a11[_0x9741f(0xc9)],0x1f90,_0x9741f(0x1d0),{'credentials':_0x3f73a0});expect(_0x1c9fb5)['to']['exist'](),await expect(Hawk[_0x9741f(0xa6)]['authenticateMessage'](_0x474a11['Shacq'],0x1f90,_0x9741f(0x1d0),_0x1c9fb5,_0xb5aee9))['to'][_0x9741f(0x1ef)](_0x9741f(0xb5));}),_0x474a11[_0x1863d1(0x11e)](it,_0x1863d1(0xce),async()=>{const _0x1a47e1=_0x1863d1;if(_0x474a11[_0x1a47e1(0xdd)](_0x474a11[_0x1a47e1(0x103)],_0x1a47e1(0xde))){const _0x1668e1=_0xb5aee9(_0x474a11['mDAzR']),_0x3505a0=Hawk[_0x1a47e1(0x205)]['message'](_0x474a11[_0x1a47e1(0xc9)],0x1f90,_0x1a47e1(0x1d0),{'credentials':_0x1668e1});_0x474a11[_0x1a47e1(0x10e)](expect,_0x3505a0)['to'][_0x1a47e1(0x13c)](),await _0x474a11['DqmDF'](expect,Hawk[_0x1a47e1(0xa6)][_0x1a47e1(0xd4)](_0x474a11[_0x1a47e1(0xc9)],0x1f90,_0x1a47e1(0x1d0),_0x3505a0,_0xb5aee9,{'localtimeOffsetMsec':0x186a0}))['to']['reject']('Stale\x20timestamp');}else throw new _0x1ea9b1(_0x31c420[_0x1a47e1(0x1e9)]);}),_0x474a11[_0x1863d1(0x1cf)](it,_0x1863d1(0xa9),async()=>{const _0x332ffe=_0x1863d1,_0x3c12d9=_0xb5aee9(_0x31c420['XOqBj']),_0x4ba85b=Hawk[_0x332ffe(0x205)]['message'](_0x332ffe(0x116),0x1f90,_0x31c420[_0x332ffe(0x136)],{'credentials':_0x3c12d9,'localtimeOffsetMsec':0x186a0});_0x31c420[_0x332ffe(0xda)](expect,_0x4ba85b)['to']['exist'](),await _0x31c420[_0x332ffe(0x171)](expect,Hawk[_0x332ffe(0xa6)][_0x332ffe(0xd4)](_0x31c420['fCPKs'],0x1f90,_0x332ffe(0x1d0),_0x4ba85b,_0xb5aee9,{'timestampSkewSec':0x1f4}))['to'][_0x332ffe(0x21d)][_0x332ffe(0x1ef)]();}),it(_0x1863d1(0x1a1),async()=>{const _0x3d2912=_0x1863d1,_0x16d3a3=_0x31c420[_0x3d2912(0x20c)](_0xb5aee9,_0x31c420[_0x3d2912(0xf0)]),_0xf03d51=Hawk[_0x3d2912(0x205)][_0x3d2912(0xe9)]('example.com',0x1f90,_0x3d2912(0x1d0),{'credentials':_0x16d3a3});expect(_0xf03d51)['to'][_0x3d2912(0x13c)](),delete _0xf03d51['id'],await _0x31c420[_0x3d2912(0x20b)](expect,Hawk[_0x3d2912(0xa6)][_0x3d2912(0xd4)](_0x31c420['fCPKs'],0x1f90,_0x3d2912(0x1d0),_0xf03d51,_0xb5aee9))['to'][_0x3d2912(0x1ef)](_0x31c420[_0x3d2912(0x1a5)]);}),it('should\x20fail\x20authorization\x20on\x20bad\x20hash',async()=>{const _0x4758aa=_0x1863d1;if(_0x474a11['ARBAh']!==_0x474a11[_0x4758aa(0x227)]){const _0x5969e1=_0xb5aee9(_0x474a11[_0x4758aa(0x167)]),_0x422511=Hawk['client'][_0x4758aa(0xe9)](_0x474a11['ljCaB'],0x1f90,_0x4758aa(0x1d0),{'credentials':_0x5969e1});_0x474a11['PxoYx'](expect,_0x422511)['to'][_0x4758aa(0x13c)](),await expect(Hawk[_0x4758aa(0xa6)]['authenticateMessage'](_0x474a11[_0x4758aa(0xc9)],0x1f90,_0x474a11[_0x4758aa(0xc1)],_0x422511,_0xb5aee9))['to']['reject'](_0x4758aa(0x13e));}else{const _0x42eead={'id':_0x4758aa(0x182),'key':_0x4758aa(0x1fe),'algorithm':_0x31c420[_0x4758aa(0x112)],'user':_0x31c420[_0x4758aa(0xa8)]};_0x5c38f9(()=>_0x5c5e83['server'][_0x4758aa(0x207)](_0x42eead,null,{'payload':_0x4758aa(0x21c),'contentType':_0x4758aa(0xb6),'ext':'response-specific'}))['to'][_0x4758aa(0x11b)]('Invalid\x20inputs');}}),_0x474a11[_0x1863d1(0x170)](it,_0x474a11[_0x1863d1(0x133)],async()=>{const _0x5089dc=_0x1863d1,_0x1c280a={'hvaaZ':_0x5089dc(0x19b)},_0x348712=_0x474a11[_0x5089dc(0xb2)](_0xb5aee9,_0x5089dc(0x182)),_0x3d565e=Hawk[_0x5089dc(0x205)][_0x5089dc(0xe9)](_0x5089dc(0x116),0x1f90,_0x474a11[_0x5089dc(0x20f)],{'credentials':_0x348712});_0x474a11[_0x5089dc(0xcc)](expect,_0x3d565e)['to'][_0x5089dc(0x13c)](),await expect(Hawk[_0x5089dc(0xa6)][_0x5089dc(0xd4)]('example.com',0x1f90,_0x5089dc(0x1d0),_0x3d565e,_0xb5aee9,{'nonceFunc':function(_0x23f473,_0x569e05,_0x17dd53){const _0x2f0a5e=_0x5089dc;if(_0x2f0a5e(0x107)==='bQdIi')throw new Error(_0x2f0a5e(0x1df));else throw new _0x30974b(_0x1c280a[_0x2f0a5e(0x1c9)]);}}))['to'][_0x5089dc(0x1ef)](_0x474a11[_0x5089dc(0x149)]);}),it(_0x1863d1(0x13d),async()=>{const _0x4b826d=_0x1863d1,_0x450604=_0xb5aee9(_0x4b826d(0x182)),_0x32af8a=Hawk[_0x4b826d(0x205)]['message'](_0x4b826d(0x116),0x1f90,_0x474a11[_0x4b826d(0x20f)],{'credentials':_0x450604});expect(_0x32af8a)['to'][_0x4b826d(0x13c)]();const _0x4cbe68=function(_0xae16b3){const _0x2a109e=_0x4b826d;throw new Error(_0x31c420[_0x2a109e(0xd5)]);};await expect(Hawk[_0x4b826d(0xa6)]['authenticateMessage'](_0x4b826d(0x116),0x1f90,_0x474a11[_0x4b826d(0x20f)],_0x32af8a,_0x4cbe68))['to']['reject'](_0x474a11[_0x4b826d(0xd1)]);}),_0x474a11[_0x1863d1(0x11e)](it,_0x1863d1(0xc3),async()=>{const _0x24d66f=_0x1863d1,_0x175d72=_0xb5aee9('123456'),_0x37ceab=Hawk[_0x24d66f(0x205)][_0x24d66f(0xe9)](_0x24d66f(0x116),0x1f90,_0x31c420['CRQNd'],{'credentials':_0x175d72});expect(_0x37ceab)['to']['exist']();const _0x568ac1=function(_0xaa7ce3){};await _0x31c420[_0x24d66f(0x22d)](expect,Hawk[_0x24d66f(0xa6)][_0x24d66f(0xd4)](_0x31c420[_0x24d66f(0x208)],0x1f90,_0x24d66f(0x1d0),_0x37ceab,_0x568ac1))['to']['reject'](_0x24d66f(0x190));}),it('should\x20fail\x20authorization\x20on\x20invalid\x20credentials',async()=>{const _0x2e9b27=_0x1863d1,_0x40e1de=_0x474a11[_0x2e9b27(0xaa)](_0xb5aee9,_0x2e9b27(0x182)),_0x546b91=Hawk['client'][_0x2e9b27(0xe9)](_0x2e9b27(0x116),0x1f90,_0x474a11[_0x2e9b27(0x20f)],{'credentials':_0x40e1de});_0x474a11['DMEEV'](expect,_0x546b91)['to']['exist']();const _0x48d67c=function(_0x3dc28b){return{};};await _0x474a11[_0x2e9b27(0xdc)](expect,Hawk[_0x2e9b27(0xa6)][_0x2e9b27(0xd4)](_0x474a11[_0x2e9b27(0xc9)],0x1f90,_0x474a11[_0x2e9b27(0x20f)],_0x546b91,_0x48d67c))['to'][_0x2e9b27(0x1ef)](_0x474a11[_0x2e9b27(0x1d5)]);}),_0x474a11[_0x1863d1(0x1a8)](it,_0x1863d1(0x1c7),async()=>{const _0x5ab7c8=_0x1863d1,_0x495ff5={'kUwWH':_0x31c420[_0x5ab7c8(0x11d)]},_0x2b572e=_0xb5aee9(_0x31c420['XOqBj']),_0x18e95c=Hawk[_0x5ab7c8(0x205)][_0x5ab7c8(0xe9)]('example.com',0x1f90,_0x31c420[_0x5ab7c8(0x136)],{'credentials':_0x2b572e});_0x31c420['syXOc'](expect,_0x18e95c)['to']['exist']();const _0x185caa=function(_0x282b1c){const _0x16b40f=_0x5ab7c8;return{'key':_0x495ff5[_0x16b40f(0xab)]};};await expect(Hawk[_0x5ab7c8(0xa6)][_0x5ab7c8(0xd4)](_0x5ab7c8(0x116),0x1f90,_0x5ab7c8(0x1d0),_0x18e95c,_0x185caa))['to'][_0x5ab7c8(0x1ef)](_0x31c420[_0x5ab7c8(0x204)]);}),it(_0x474a11['CPuom'],async()=>{const _0x458df6=_0x1863d1,_0xe8ced2=_0xb5aee9(_0x458df6(0x182)),_0x4b751a=Hawk[_0x458df6(0x205)][_0x458df6(0xe9)](_0x458df6(0x116),0x1f90,_0x458df6(0x1d0),{'credentials':_0xe8ced2});expect(_0x4b751a)['to'][_0x458df6(0x13c)]();const _0x514b0a=function(_0x30d414){const _0xf46232=_0x458df6;return{'key':_0x31c420[_0xf46232(0xba)],'algorithm':_0x31c420[_0xf46232(0x1ca)]};};await _0x31c420[_0x458df6(0x1d2)](expect,Hawk['server'][_0x458df6(0xd4)](_0x31c420[_0x458df6(0x208)],0x1f90,_0x458df6(0x1d0),_0x4b751a,_0x514b0a))['to']['reject'](_0x458df6(0x106));}),it(_0x1863d1(0xb9),()=>{const _0xb6ac35=_0x1863d1,_0x5c7c04=_0xb5aee9(_0xb6ac35(0x182));_0x474a11[_0xb6ac35(0x102)](expect,()=>Hawk[_0xb6ac35(0x205)]['message'](null,0x1f90,_0xb6ac35(0x1d0),{'credentials':_0x5c7c04}))['to'][_0xb6ac35(0x11b)](_0x474a11['GNfok']);}),_0x474a11['ShLJe'](it,_0x1863d1(0x17d),()=>{const _0x360c50=_0x1863d1,_0xdce83d={'MDuvA':_0x474a11['QRKXZ'],'aPxyh':_0x360c50(0x14e)};if(_0x474a11[_0x360c50(0x1b3)](_0x474a11[_0x360c50(0x178)],_0x474a11[_0x360c50(0x22f)]))return{'key':_0xdce83d[_0x360c50(0x1e6)],'user':_0xdce83d[_0x360c50(0xbb)]};else _0x474a11[_0x360c50(0xd0)](expect,()=>Hawk[_0x360c50(0x205)][_0x360c50(0xe9)]('example.com',0x1f90,_0x360c50(0x1d0)))['to']['throw']('Invalid\x20credentials');}),_0x474a11['YtnhV'](it,_0x1863d1(0x1a0),()=>{const _0xf60efe=_0x1863d1,_0x53eced=_0xb5aee9(_0x31c420[_0xf60efe(0xf0)]),_0x5240e0=Hoek[_0xf60efe(0x1b2)](_0x53eced);_0x5240e0[_0xf60efe(0x165)]=_0x31c420['xrTzo'],expect(()=>Hawk[_0xf60efe(0x205)][_0xf60efe(0xe9)](_0xf60efe(0x116),0x1f90,_0xf60efe(0x1d0),{'credentials':_0x5240e0}))['to']['throw'](_0xf60efe(0x106));});}),_0x474a11['nYYkG'](describe,_0x474a11[_0x54b113(0xf9)],()=>{const _0x44cc4e=_0x54b113,_0x84ec8d={'Mwwtc':function(_0x53b83e,_0x55c6dc){return _0x53b83e(_0x55c6dc);},'lIjPJ':function(_0x241866,_0xc7b9c3){return _0x241866(_0xc7b9c3);}};_0x474a11[_0x44cc4e(0x229)](it,'checks\x20payload\x20hash',()=>{const _0x1237af=_0x44cc4e;_0x84ec8d[_0x1237af(0xb8)](expect,()=>Hawk[_0x1237af(0xa6)][_0x1237af(0xb3)](_0x1237af(0x13b),{'hash':_0x1237af(0x13b)}))['to'][_0x1237af(0x21d)]['throw'](),_0x84ec8d[_0x1237af(0x1d9)](expect,()=>Hawk[_0x1237af(0xa6)][_0x1237af(0xb3)](_0x1237af(0x15c),{'hash':_0x1237af(0x13b)}))['to'][_0x1237af(0x11b)]('Bad\x20payload\x20hash');});});});