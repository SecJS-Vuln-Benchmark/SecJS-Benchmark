'use strict';function _0x1d80(){const _0x3d053e=['throw','errors\x20on\x20an\x20unknown\x20authorization\x20attribute','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(id)','Stale\x20timestamp','phhau','should\x20fail\x20on\x20missing\x20host','sWXAX','RlYIV','lab','23434d3q4d5345d','OidTk','authenticateBewit()','Bcosd','GpxWW','bEspg','oEWNg','QhdVk','HdHVi','errors\x20on\x20an\x20bad\x20host\x20header\x20(pad\x20port)','IJdbx','Suhoe','iYrai','aYlME','WWW-Authenticate','shoRh','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(mac)','iuMqF','abc','QyxLN','bOXYQ','eipAr','evhQX','PKgUT','DiezQ','vMyVv','XUXWk','AtLQW','GCgZA','yQZSY','value','/resource/4?filter=a','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20x=\x223\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','xEuKW','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22bXx7a7p1h9QYQNZ8x7QhvDQym8ACgab4m3lVSFn4DBw=\x22,\x20ext=\x22hello\x22','fmfHZ','VClGl','PggZy','xvIxr','blOFW','TTUhh','GcpQZ','sha256','expect','8080','anJPv','GMBGW','NxdZv','ACibV','gxkba','oTFAG','NcIcK','URpRj','Invalid\x20inputs','SqYaq','KdClT','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcU4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','elVFi','Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22','4JgnqAx','rSNAx','LiytY','2199530qtHAlM','uoqVE','CStab','@hapi/hoek','steve','GPplr','ZgCDQ','mDIpx',':8080','SZnkf','user','client','WIEpy','96036nMjaDN','IchHc','YLEgU','asdasd','Hawk\x20id=\x22123456\x22,\x20ts=\x221357926341\x22,\x20nonce=\x221AwuJD\x22,\x20hash=\x22qAiXIVv+yjDATneWxZP2YCTa9aHRgQdnH9b3Wc+o3dg=\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22UeYcj5UoTVaAWXNvJfLVia7kU3VabxCqrccXP8sUGC4=\x22','clone','NLKlW','hIbOL','statusCode','Hawk\x20id=\x22123\x22,\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','DkOmH','Ifztu','pKPOA','DWqeU','errors\x20on\x20an\x20invalid\x20authorization\x20header\x20format','ZSjcX','wExkv','sEXuk','CeION','GZjzf','errors\x20on\x20a\x20replay','@hapi/lab','lDOde','KMQvt','hmac-sha-0','luXFE','Invalid\x20Host\x20header','mDTpS','sJIUQ','Invalid\x20authorization','yMcDE','lsPcF','YCyGP','something','Hawk\x20id=\x22\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','generates\x20header\x20(null\x20ext)','mLBgT','parses\x20a\x20valid\x20authentication\x20header\x20(sha256)','script','DPkkH','should\x20fail\x20authorization\x20on\x20stale\x20timestamp','credentials','HVCEr','dqOKp','456','YOhXy','Kjysh','Unknown\x20credentials','not','calculatePayloadHash','104162WtuCim','algorithm','uCSvk','FwlBg','ChCBF','BZvpi','UNLDB','XgAEG','Missing\x20attributes','parses\x20a\x20valid\x20authentication\x20header\x20(sha1)','AuciK','example1.com:8080','errors\x20on\x20invalid\x20credentials\x20(algorithm)','wsiqc','Invalid\x20header\x20syntax','123','7ScjVLi','VYRTK','VoCQp','authenticatePayloadHash()','output','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','1234567','errors\x20on\x20missing\x20artifacts','some','xFUPr','checks\x20payload\x20hash','exgcK','HOanF','errors\x20on\x20credentialsFunc\x20error','authenticateMessage','awwYR','Hawk\x20id=\x22dh37fgj492je\x22,\x20ts=\x221353832234\x22,\x20nonce=\x22j4h3g2\x22,\x20mac=\x22m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\x22,\x20ext=\x22some-app-data\x22','AUlWK','contentType','kbBrQ','overrides\x20timestampSkewSec','errors\x20on\x20a\x20stale\x20timestamp','woMCk','XSSWj','uXHNX','should\x20fail\x20on\x20missing\x20credentials','eKrBl','Bad\x20mac','NGySa','tvMYp','should\x20fail\x20authorization\x20on\x20missing\x20credentials','rUXfK','YBvCO','tEYCQ','ExzID','Zckbn','4670hEUjRJ','Hawk\x20mac=\x22q+fdjQv3kF56JGKLYeLzAS9dYGcvDqAXRG7MTVHAFKE=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22','errors\x20on\x20invalid\x20authorization\x20(nonce)','KPTbI','errors\x20on\x20an\x20bad\x20host\x20header\x20(includes\x20path\x20and\x20query)','iVCTP','@hapi/code','errors\x20with\x20credentials','VVoKc','payload','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','rPLfd','some\x20reply','fFwaB','IvHZs','lwhWj','FhDaC','oRCvn','UOPoF','RCBxX','Jttzz','rymVz','Unknown\x20algorithm','vUyOp','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(ts)','lnlSr','example1.com:80','qHKKz','JlNWX','should\x20fail\x20authorization\x20on\x20invalid\x20authorization','now','sQsYy','should\x20fail\x20on\x20invalid\x20algorithm','Duplicate\x20attribute:\x20id','XKUlJ','Hawk\x20mac=\x226PrybJTJs20jsgBw5eilXpcytD8kUbaIKNYXL+6g0ns=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22','Btvrm','csuxq','hwpWc','abcdefg','wBCWv','XWKBe','MQLHD','errors\x20on\x20an\x20bad\x20authorization\x20attribute\x20value','7596ksOyJe','authenticate','blah','BvXnI','QGHeK','errors\x20on\x20invalid\x20authorization\x20(mac)','1398546787','VLfPP','JzUss','Invalid\x20credentials','DasRC','generates\x20header\x20(pre\x20calculated\x20hash)','xUwusx','vaJjG','zZSzd','nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','within','SxSsG','WLXPr','vIYBL','errors\x20on\x20duplicated\x20authorization\x20attribute\x20key','XpMAZ','WefUh','errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20wrong\x20scheme','UXxHE','message','wjOHg','eDHZI','reject','dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','hYtDm','qPBTv','DOWUO','Server','22iDZaQi','response-specific','example1.com','tKooH','POST','FZcTa','cEJuw','Invalid\x20nonce','/resource/1?b=1&a=2','werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','FLnoM','DXsCW','authenticatePayloadHash','errors\x20on\x20an\x20bad\x20authorization\x20header\x20format','uYeMR','errors\x20on\x20missing\x20credentials','fnQnQ','errors\x20on\x20nonce\x20collision','OEcoi','49tLOipP','authenticate()','dlfCd','rvXyt','Missing\x20required\x20payload\x20hash','sha1','SKrxv','header()','hXaGa','authenticateMessage()','should\x20generate\x20an\x20authorization\x20then\x20successfully\x20parse\x20it','Hawk\x20id=\x22123\x5c\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','equal','example.com','LApDq','some\x20message','cuIaY','FsHqW','abDyW','ygupI','QngEF','eeFFo','example.com:something','QYxKl','GET','PsHDB','ovktf','duNAy','2158936FtQuBJ','MfPjt','jhlwv','Bad\x20attribute\x20value:\x20id','WcnyF','MfUWM','Hawk\x20mac=\x22i8/kUBDx0QF+PpCtW860kkV/fa9dbwEoe/FpGUXowf0=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22,\x20ext=\x22response-specific\x22','lFcPX','fxJUF','uaoOZ','rMoLq','errors\x20on\x20an\x20missing\x20host\x20header','bCTjJ','GebBD','CEOOp','evlQV','wUcwh','IxJeP','vYOLO','BmxBo','DIBoI','vFKDz','crypto','KXSBq','vAidN','oRypx','Unknown\x20user','errors\x20on\x20missing\x20hash\x20(empty\x20payload)','Hawk\x20id=\x22123456\x22,\x20ts=\x221362337299\x22,\x20nonce=\x22UzmxSs\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22wnNUxchvvryMH2RxckTdZ/gY3ijzvccx4keVvELC61w=\x22','errors\x20on\x20uri\x20too\x20long','mac','generates\x20header','xfTFM','ZzOuM','text/plain','123456','pjWcX','UiOzT','GDkPX','exist','149967QkbTVN','ymmMp','fmeZe','uKwPK','kaboom','Vacwd','muTPL','Bad\x20message\x20hash','JYcJa','fSvIq','utils','186168olCWSD','iXQwv','dOqWT','eQywN','FrJjY','An\x20internal\x20server\x20error\x20occurred','headers','vzMSu','Unknown\x20attribute:\x20x','should\x20fail\x20authorization\x20on\x20nonce\x20error','eJMmC','jhLcO','artifacts','Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22','Bad\x20header\x20format','AeWnG','IUGQk','cNEvI','fIKfC','kablooey','hash','bqhcx','example.com:8080/path?x=z','jxXVN','btnDb','server','HGwNm','Hawk\x20id=\x22\x09\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','errors\x20on\x20invalid\x20credentials\x20(key)','uSBvO','hyfWy','NHofZ','!@#','XkjZr','BrYGs','CbPcB','rMHup','Hawk','ZieLB','some-app-data','XMVJl','mYCqf','rDuQn','errors\x20on\x20invalid\x20authorization\x20(hash)','errors\x20on\x20invalid\x20algorithm','CiGWA','Resource\x20path\x20exceeds\x20max\x20length','header','eQQHz','QXZLu','xHiOe','EfsyI','IBqUF','SosFt','aQbBn','VJQre','TDKjU'];_0x1d80=function(){return _0x3d053e;};return _0x1d80();}const _0x237cab=_0x295c;(function(_0xd49820,_0x4450fd){const _0x550714=_0x295c,_0x46f9bf=_0xd49820();while(!![]){try{const _0x531d23=parseInt(_0x550714(0x235))/0x1*(-parseInt(_0x550714(0x225))/0x2)+parseInt(_0x550714(0x2fe))/0x3+-parseInt(_0x550714(0x1e3))/0x4*(-parseInt(_0x550714(0x1e6))/0x5)+parseInt(_0x550714(0x166))/0x6*(parseInt(_0x550714(0x2ba))/0x7)+parseInt(_0x550714(0x2d6))/0x8+parseInt(_0x550714(0x285))/0x9*(-parseInt(_0x550714(0x259))/0xa)+parseInt(_0x550714(0x2a7))/0xb*(parseInt(_0x550714(0x1f3))/0xc);if(_0x531d23===_0x4450fd)break;else _0x46f9bf['push'](_0x46f9bf['shift']());}catch(_0x3309da){_0x46f9bf['push'](_0x46f9bf['shift']());}}}(_0x1d80,0x39309));function _0x295c(_0x5e6347,_0x19521b){const _0x1d80c4=_0x1d80();return _0x295c=function(_0x295c62,_0x14c3c3){_0x295c62=_0x295c62-0x15e;let _0x22b2e0=_0x1d80c4[_0x295c62];return _0x22b2e0;},_0x295c(_0x5e6347,_0x19521b);}const Code=require(_0x237cab(0x25f)),Hawk=require('..'),Hoek=require(_0x237cab(0x1e9)),Lab=require(_0x237cab(0x208)),internals={},{describe,it}=exports[_0x237cab(0x1a7)]=Lab[_0x237cab(0x219)](),expect=Code[_0x237cab(0x1d3)];describe(_0x237cab(0x2a6),()=>{const _0x2fb131=_0x237cab,_0xd5c3ff={'abDyW':_0x2fb131(0x2b0),'RlYIV':_0x2fb131(0x1d2),'GcpQZ':'steve','iXQwv':_0x2fb131(0x2d2),'anJPv':_0x2fb131(0x173),'OEcoi':function(_0x1e2fe8,_0x2dada5){return _0x1e2fe8-_0x2dada5;},'SosFt':_0x2fb131(0x1c7),'MQLHD':_0x2fb131(0x230),'GPplr':'example.com','GebBD':_0x2fb131(0x185),'XWKBe':function(_0x4d5c0f,_0x4fd370){return _0x4d5c0f(_0x4fd370);},'xFUPr':_0x2fb131(0x2be),'exgcK':function(_0x3025d4,_0x4d9247){return _0x3025d4-_0x4d9247;},'Jttzz':_0x2fb131(0x1d4),'YOhXy':function(_0x5e81ae,_0x4120bc){return _0x5e81ae!==_0x4120bc;},'wBCWv':function(_0x12f75a,_0x4050c9){return _0x12f75a(_0x4050c9);},'vzMSu':'Hawk\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','btnDb':_0x2fb131(0x22d),'BLwXQ':function(_0x345f3f,_0x1b0d2b){return _0x345f3f-_0x1b0d2b;},'ZieLB':_0x2fb131(0x18b),'oRCvn':_0x2fb131(0x20d),'mDTpS':_0x2fb131(0x263),'VLfPP':function(_0x28569c,_0x360914){return _0x28569c-_0x360914;},'pKPOA':_0x2fb131(0x2f0),'ZzOuM':function(_0x58c758,_0x5be25d){return _0x58c758===_0x5be25d;},'WcnyF':_0x2fb131(0x2ed),'BmxBo':_0x2fb131(0x1cb),'FZcTa':function(_0x12c384,_0x1a2ad0){return _0x12c384-_0x1a2ad0;},'phByo':_0x2fb131(0x21a),'NFZBz':_0x2fb131(0x2cf),'XkjZr':function(_0x503eed,_0x40389a){return _0x503eed-_0x40389a;},'eKrBl':'Invalid\x20credentials','KdClT':function(_0x55b078,_0x2d3bf3){return _0x55b078(_0x2d3bf3);},'fnQnQ':'Unknown\x20algorithm','xEuKW':_0x2fb131(0x16b),'LiytY':function(_0x1e7752,_0x1c43c9){return _0x1e7752!==_0x1c43c9;},'QngEF':_0x2fb131(0x1a2),'xFwkr':function(_0x3f6372,_0x432dc0){return _0x3f6372*_0x432dc0;},'ACibV':function(_0x306775,_0x5ef0f1,_0xcdbfd5){return _0x306775(_0x5ef0f1,_0xcdbfd5);},'SqYaq':function(_0x127aea,_0x2bf758){return _0x127aea+_0x2bf758;},'WLXPr':function(_0x17d65c,_0x19c38c){return _0x17d65c+_0x19c38c;},'DOWUO':function(_0x9b73ff,_0x264d4d){return _0x9b73ff(_0x264d4d);},'XKUlJ':_0x2fb131(0x186),'rUXfK':function(_0x123f24,_0x44547c){return _0x123f24-_0x44547c;},'cavrT':_0x2fb131(0x233),'eQQHz':_0x2fb131(0x1c8),'MfUWM':function(_0x31d42f,_0x31502a){return _0x31d42f(_0x31502a);},'NGySa':_0x2fb131(0x2f9),'GCgZA':_0x2fb131(0x27a),'lFcPX':function(_0xfb0f2b,_0x1650cc){return _0xfb0f2b(_0x1650cc);},'eJMmC':_0x2fb131(0x294),'vFKDz':_0x2fb131(0x2f8),'mthJB':_0x2fb131(0x29d),'ExzID':function(_0x5f339c,_0xa28908,_0x4dce56){return _0x5f339c(_0xa28908,_0x4dce56);},'IBqUF':function(_0x14e582,_0x27170e,_0x260ff9){return _0x14e582(_0x27170e,_0x260ff9);},'vIYBL':function(_0x15bb5b,_0x21d4b2,_0x2e046a){return _0x15bb5b(_0x21d4b2,_0x2e046a);},'fFwaB':'parses\x20a\x20valid\x20authentication\x20header\x20(host\x20port\x20override)','uoqVE':'parses\x20a\x20valid\x20authentication\x20header\x20(POST\x20with\x20payload)','dlfCd':'errors\x20on\x20missing\x20hash','BvXnI':_0x2fb131(0x2f1),'NxdZv':'errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20no\x20scheme','JPauL':function(_0xd06974,_0x423fec,_0x4db526){return _0xd06974(_0x423fec,_0x4db526);},'DWqeU':'errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(nonce)','uYeMR':function(_0x5f398e,_0x3ceee6,_0x33e5df){return _0x5f398e(_0x3ceee6,_0x33e5df);},'FwlBg':function(_0x1c3205,_0x10c161,_0x2be867){return _0x1c3205(_0x10c161,_0x2be867);},'KPTbI':function(_0x3e17e5,_0x1973eb,_0x5f426c){return _0x3e17e5(_0x1973eb,_0x5f426c);},'PsHDB':function(_0x5af6e7,_0xbb0ee5,_0x4bb2e0){return _0x5af6e7(_0xbb0ee5,_0x4bb2e0);},'hXVCH':_0x2fb131(0x299),'HOanF':_0x2fb131(0x201),'nimJT':_0x2fb131(0x25d),'vAidN':function(_0x3f2a30,_0x4e6509,_0x22d775){return _0x3f2a30(_0x4e6509,_0x22d775);},'hIbOL':function(_0x71ba63,_0x2e3906,_0x1b92a7){return _0x71ba63(_0x2e3906,_0x1b92a7);},'fIKfC':_0x2fb131(0x2b6),'bEspg':'errors\x20on\x20invalid\x20credentials\x20(id)','IUGQk':_0x2fb131(0x182),'IchHc':'errors\x20on\x20unknown\x20bad\x20mac','ZSjcX':function(_0x47f3c0,_0x2b8c58){return _0x47f3c0+_0x2b8c58;},'evlQV':_0x2fb131(0x248),'sJIUQ':_0x2fb131(0x2ab),'HdHVi':_0x2fb131(0x18d),'vUyOp':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','NcIcK':_0x2fb131(0x265),'VoCQp':_0x2fb131(0x2a8),'wExkv':_0x2fb131(0x28b),'CiGWA':_0x2fb131(0x291),'FhDaC':'Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22','LApDq':'Invalid\x20inputs','ymmMp':function(_0x5af3e7,_0x331cc4){return _0x5af3e7(_0x331cc4);},'xHiOe':'asdasd','BQXDy':function(_0x43da7c,_0x355701){return _0x43da7c(_0x355701);},'ihgQS':'generates\x20header\x20(empty\x20payload)','uSBvO':function(_0x403b4e,_0x1dbe50,_0x3eab0d){return _0x403b4e(_0x1dbe50,_0x3eab0d);},'luXFE':'generates\x20header\x20(empty\x20ext)','Kjysh':_0x2fb131(0x216),'Fwzmk':_0x2fb131(0x23c),'eDHZI':'errors\x20on\x20invalid\x20artifacts','muTPL':function(_0x54cca2,_0x3efe15,_0x68d9c9){return _0x54cca2(_0x3efe15,_0x68d9c9);},'lDUUU':_0x2fb131(0x192),'WUHeE':'errors\x20on\x20invalid\x20options','bqhcx':_0x2fb131(0x194),'BZvpi':_0x2fb131(0x2c9),'kMFqD':function(_0xa736d5,_0x5a91b1){return _0xa736d5(_0x5a91b1);},'jhlwv':function(_0xb2826a,_0x302820){return _0xb2826a(_0x302820);},'lNLLL':_0x2fb131(0x210),'Ifztu':function(_0xae0eea,_0x43e23f){return _0xae0eea(_0x43e23f);},'lwhWj':function(_0x5c7d16,_0x233f66){return _0x5c7d16(_0x233f66);},'dOqWT':function(_0x5a1281,_0x5becaa){return _0x5a1281(_0x5becaa);},'rDuQn':function(_0x5a8128,_0x113d40){return _0x5a8128(_0x113d40);},'xfTFM':_0x2fb131(0x214),'uKwPK':function(_0x37e6e2,_0x2c2971){return _0x37e6e2(_0x2c2971);},'xvIxr':function(_0x57e05b,_0x497d65){return _0x57e05b(_0x497d65);},'sWXAX':'Invalid\x20nonce','eipAr':function(_0xa91579,_0x28e6d0){return _0xa91579(_0x28e6d0);},'OEYzT':function(_0x2ddf4f,_0x3b2fa4){return _0x2ddf4f(_0x3b2fa4);},'qHKKz':_0x2fb131(0x179),'sQsYy':_0x2fb131(0x222),'tvMYp':function(_0x11ea9c,_0x2f1a7e){return _0x11ea9c(_0x2f1a7e);},'DasRC':'eAWpg','CEOOp':_0x2fb131(0x250),'FsHqW':function(_0x229906,_0x384a5d,_0x319812){return _0x229906(_0x384a5d,_0x319812);},'bCTjJ':function(_0x3d8ec3,_0x3c9f1d,_0x3ea13c){return _0x3d8ec3(_0x3c9f1d,_0x3ea13c);},'aQbBn':_0x2fb131(0x25b),'Hkdpx':function(_0x113b28,_0x33a9b2,_0x3c0c9d){return _0x113b28(_0x33a9b2,_0x3c0c9d);},'IvHZs':_0x2fb131(0x191),'GZjzf':function(_0x20fd64,_0x3c8c97,_0x51512f){return _0x20fd64(_0x3c8c97,_0x51512f);},'XpMAZ':_0x2fb131(0x260),'QYxKl':function(_0x2378b7,_0x2ce756,_0x6d1ac0){return _0x2378b7(_0x2ce756,_0x6d1ac0);},'oJict':'should\x20fail\x20authorization\x20on\x20mismatching\x20host','lsPcF':_0x2fb131(0x249),'rSNAx':function(_0x50e43b,_0x28ae18,_0x5dc674){return _0x50e43b(_0x28ae18,_0x5dc674);},'YBvCO':'should\x20fail\x20authorization\x20on\x20bad\x20hash','UOPoF':function(_0x1bd120,_0x3fe237,_0x4bab98){return _0x1bd120(_0x3fe237,_0x4bab98);},'cEJuw':function(_0x1aaa6f,_0x5f2a24,_0x1da347){return _0x1aaa6f(_0x5f2a24,_0x1da347);},'sQOFo':'should\x20fail\x20authorization\x20on\x20invalid\x20credentials','lDOde':_0x2fb131(0x1a4),'FLnoM':_0x2fb131(0x24e),'GMBGW':function(_0x39705d,_0x5c969a,_0x4a998b){return _0x39705d(_0x5c969a,_0x4a998b);},'UNLDB':_0x2fb131(0x279),'wsiqc':function(_0x277f7e,_0x532c89,_0x4bd761){return _0x277f7e(_0x532c89,_0x4bd761);},'Btvrm':_0x2fb131(0x2bb),'yQZSY':_0x2fb131(0x1aa)},_0x562c6f=function(_0x2594a9){const _0x53b666=_0x2fb131;return{'id':_0x2594a9,'key':_0xd5c3ff[_0x53b666(0x2cc)],'algorithm':_0x2594a9==='1'?'sha1':_0xd5c3ff[_0x53b666(0x1a6)],'user':_0xd5c3ff[_0x53b666(0x1d1)]};};describe(_0xd5c3ff[_0x2fb131(0x27d)],()=>{const _0x1338b6=_0x2fb131,_0x4d5c85={'evhQX':_0x1338b6(0x2d2),'CbPcB':_0x1338b6(0x2af),'iYrai':_0xd5c3ff[_0x1338b6(0x1eb)],'VClGl':_0x1338b6(0x245),'rPLfd':_0x1338b6(0x1c7),'iVCTP':function(_0x2eb485,_0x48c20c){return _0x2eb485-_0x48c20c;},'awwYR':function(_0xbeeb48,_0x21c4cf){const _0x5c6ae0=_0x1338b6;return _0xd5c3ff[_0x5c6ae0(0x1e5)](_0xbeeb48,_0x21c4cf);},'YLEgU':'GDkPX','AuciK':function(_0x383b82,_0x3ce1cb){const _0x3d3acf=_0x1338b6;return _0xd5c3ff[_0x3d3acf(0x1df)](_0x383b82,_0x3ce1cb);},'csuxq':_0x1338b6(0x2be),'gxkba':_0x1338b6(0x2f2),'QXZLu':function(_0x386154,_0x4f720d){const _0x463ede=_0x1338b6;return _0xd5c3ff[_0x463ede(0x1df)](_0x386154,_0x4f720d);},'VJQre':_0xd5c3ff[_0x1338b6(0x2ce)],'IxJeP':function(_0x530911,_0x3f4bcd){return _0xd5c3ff['xFwkr'](_0x530911,_0x3f4bcd);},'ygupI':function(_0x2c4549,_0x5470d2,_0x2dd884){const _0x471708=_0x1338b6;return _0xd5c3ff[_0x471708(0x1d8)](_0x2c4549,_0x5470d2,_0x2dd884);},'ChCBF':function(_0x2af926,_0x303b06){const _0x24ef0d=_0x1338b6;return _0xd5c3ff[_0x24ef0d(0x1de)](_0x2af926,_0x303b06);},'OidTk':function(_0x2557a6,_0x2a8eba){return _0x2557a6===_0x2a8eba;},'uCSvk':function(_0x3d6710,_0x290f78){const _0x4f6243=_0x1338b6;return _0xd5c3ff[_0x4f6243(0x297)](_0x3d6710,_0x290f78);},'blOFW':'Hawk\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22LXfmTnRzrLd9TD7yfH+4se46Bx6AHyhpM94hLCiNia4=\x22,\x20ext=\x22hello\x22','Bcosd':function(_0x4dd273,_0x4a15c9){return _0xd5c3ff['DOWUO'](_0x4dd273,_0x4a15c9);},'hwpWc':'Basic\x20asdasdasdasd','PDwam':_0xd5c3ff[_0x1338b6(0x27b)],'UiOzT':function(_0x873c61,_0x32a804){const _0x5595fb=_0x1338b6;return _0xd5c3ff[_0x5595fb(0x254)](_0x873c61,_0x32a804);},'VYRTK':_0xd5c3ff['cavrT'],'TDKjU':_0xd5c3ff[_0x1338b6(0x26a)],'hIbLn':_0x1338b6(0x22d),'RQlPO':function(_0x33a869,_0x1b606e){return _0x33a869-_0x1b606e;},'cSeuP':_0xd5c3ff[_0x1338b6(0x196)],'RCBxX':_0x1338b6(0x2c5),'hyfWy':function(_0x460057,_0x18b4a4){return _0xd5c3ff['MfUWM'](_0x460057,_0x18b4a4);},'bOXYQ':function(_0x22910e,_0x2a38db){const _0x144dc6=_0x1338b6;return _0xd5c3ff[_0x144dc6(0x187)](_0x22910e,_0x2a38db);},'cNEvI':_0x1338b6(0x2d9),'dHHvo':_0x1338b6(0x215),'BrYGs':_0xd5c3ff['NGySa'],'Zjmzq':_0x1338b6(0x1d2),'phhau':_0x1338b6(0x1dd),'vMyVv':function(_0x96228f,_0x440b7c){return _0x96228f(_0x440b7c);},'AeWnG':_0xd5c3ff[_0x1338b6(0x1c4)],'WIEpy':function(_0x3f5850,_0x113486){const _0x5b6a13=_0x1338b6;return _0xd5c3ff[_0x5b6a13(0x2dd)](_0x3f5850,_0x113486);},'mYCqf':function(_0x58c313,_0x35b7b6){return _0x58c313(_0x35b7b6);},'DkOmH':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','Vacwd':function(_0x2262e0,_0x430846){return _0x2262e0(_0x430846);},'mDIpx':_0xd5c3ff[_0x1338b6(0x24f)],'JzUss':_0x1338b6(0x2b0),'rymVz':_0x1338b6(0x1ea),'SxSsG':_0xd5c3ff[_0x1338b6(0x26d)],'nTCqh':_0xd5c3ff[_0x1338b6(0x170)],'wUcwh':_0xd5c3ff[_0x1338b6(0x2eb)],'XUXWk':_0xd5c3ff['mthJB'],'XIhml':_0x1338b6(0x1e0),'fxJUF':function(_0x2c8608,_0x13492b){return _0x2c8608(_0x13492b);}};_0xd5c3ff[_0x1338b6(0x257)](it,_0x1338b6(0x22e),async()=>{const _0x43c25d=_0x1338b6,_0x36a8dc={'method':_0xd5c3ff[_0x43c25d(0x167)],'url':_0x43c25d(0x1c7),'host':_0x43c25d(0x2c7),'port':0x1f90,'authorization':_0xd5c3ff[_0x43c25d(0x1d5)]},{credentials:_0x3a737b}=await Hawk[_0x43c25d(0x17f)][_0x43c25d(0x286)](_0x36a8dc,_0x562c6f,{'localtimeOffsetMsec':_0xd5c3ff['OEcoi'](0x13b34143208,Hawk[_0x43c25d(0x165)]['now']())});expect(_0x3a737b['user'])['to'][_0x43c25d(0x2c6)]('steve');}),_0xd5c3ff[_0x1338b6(0x19a)](it,_0x1338b6(0x218),async()=>{const _0x4017ef=_0x1338b6,_0x487b5f={'method':_0x4d5c85[_0x4017ef(0x1be)],'url':_0x4d5c85[_0x4017ef(0x189)],'host':_0x4d5c85[_0x4017ef(0x1b4)],'port':0x1f40,'authorization':_0x4d5c85[_0x4017ef(0x1cc)]},{credentials:_0x1d8c70}=await Hawk[_0x4017ef(0x17f)]['authenticate'](_0x487b5f,_0x562c6f,{'localtimeOffsetMsec':0x13b36b07c10-Hawk[_0x4017ef(0x165)]['now']()});expect(_0x1d8c70['user'])['to'][_0x4017ef(0x2c6)](_0x4017ef(0x1ea));}),it('parses\x20a\x20valid\x20authentication\x20header\x20(host\x20override)',async()=>{const _0x4f1218=_0x1338b6,_0x48835e={'XgAEG':_0xd5c3ff['GcpQZ']};if(_0x4f1218(0x18a)===_0x4f1218(0x2e8))return{'id':'23434d3q4d5345d','user':_0x48835e[_0x4f1218(0x22c)]};else{const _0x289b38={'method':_0xd5c3ff['iXQwv'],'url':_0xd5c3ff['SosFt'],'headers':{'host':_0xd5c3ff[_0x4f1218(0x283)],'authorization':_0xd5c3ff[_0x4f1218(0x1d5)]}},{credentials:_0x271947}=await Hawk['server']['authenticate'](_0x289b38,_0x562c6f,{'host':_0xd5c3ff[_0x4f1218(0x1eb)],'localtimeOffsetMsec':0x13b34143208-Hawk[_0x4f1218(0x165)]['now']()});expect(_0x271947[_0x4f1218(0x1f0)])['to'][_0x4f1218(0x2c6)](_0xd5c3ff[_0x4f1218(0x1d1)]);}}),_0xd5c3ff[_0x1338b6(0x298)](it,_0xd5c3ff[_0x1338b6(0x266)],async()=>{const _0x25d72b=_0x1338b6,_0x3b3def={'method':_0x25d72b(0x2d2),'url':_0xd5c3ff[_0x25d72b(0x19b)],'headers':{'host':_0x25d72b(0x273),'authorization':_0xd5c3ff['anJPv']}},{credentials:_0x3e7667}=await Hawk[_0x25d72b(0x17f)][_0x25d72b(0x286)](_0x3b3def,_0x562c6f,{'host':_0xd5c3ff['GPplr'],'port':0x1f90,'localtimeOffsetMsec':_0xd5c3ff[_0x25d72b(0x2b9)](0x13b34143208,Hawk[_0x25d72b(0x165)][_0x25d72b(0x277)]())});expect(_0x3e7667[_0x25d72b(0x1f0)])['to'][_0x25d72b(0x2c6)](_0xd5c3ff[_0x25d72b(0x1d1)]);}),it(_0xd5c3ff[_0x1338b6(0x1e7)],async()=>{const _0x4111f4=_0x1338b6,_0x5ae26c={'method':_0x4111f4(0x2ab),'url':_0x4d5c85[_0x4111f4(0x264)],'host':_0x4d5c85[_0x4111f4(0x1b4)],'port':0x1f90,'authorization':_0x4111f4(0x1f7)},{credentials:_0x5b22e5}=await Hawk['server'][_0x4111f4(0x286)](_0x5ae26c,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x4111f4(0x25e)](0x13c2ab79988,Hawk[_0x4111f4(0x165)]['now']())});expect(_0x5b22e5[_0x4111f4(0x1f0)])['to'][_0x4111f4(0x2c6)]('steve');}),it(_0xd5c3ff[_0x1338b6(0x2bc)],async()=>{const _0x3f842d=_0x1338b6,_0x3fe020={'Suhoe':_0x3f842d(0x179)};if(_0x4d5c85[_0x3f842d(0x244)](_0x4d5c85[_0x3f842d(0x1f5)],_0x3f842d(0x2fc)))throw new _0x212cbd(_0x3fe020[_0x3f842d(0x1b3)]);else{const _0x24e8e7={'method':_0x3f842d(0x2d2),'url':_0x3f842d(0x2af),'host':_0x4d5c85[_0x3f842d(0x1b4)],'port':0x1f40,'authorization':_0x4d5c85[_0x3f842d(0x1cc)]};await _0x4d5c85[_0x3f842d(0x22f)](expect,Hawk[_0x3f842d(0x17f)][_0x3f842d(0x286)](_0x24e8e7,_0x562c6f,{'payload':'body','localtimeOffsetMsec':0x13b36b07c10-Hawk[_0x3f842d(0x165)][_0x3f842d(0x277)]()}))['to'][_0x3f842d(0x2a1)](_0x4d5c85[_0x3f842d(0x27e)]);}}),it(_0xd5c3ff[_0x1338b6(0x288)],async()=>{const _0x38780d=_0x1338b6;if(_0xd5c3ff[_0x38780d(0x2e3)]!==_0xd5c3ff[_0x38780d(0x2e3)]){const _0x4c409a=new _0x5d4520(_0x38780d(0x2f0));_0x4c409a[_0x38780d(0x21c)]={'some':_0x38780d(0x1c6)};throw _0x4c409a;}else{const _0x1c25ca={'method':_0x38780d(0x2d2),'url':'/resource/1?b=1&a=2','host':_0xd5c3ff[_0x38780d(0x1eb)],'port':0x1f40,'authorization':_0x38780d(0x245)};await _0xd5c3ff['XWKBe'](expect,Hawk[_0x38780d(0x17f)]['authenticate'](_0x1c25ca,_0x562c6f,{'payload':'','localtimeOffsetMsec':_0xd5c3ff['OEcoi'](0x13b36b07c10,Hawk[_0x38780d(0x165)][_0x38780d(0x277)]())}))['to'][_0x38780d(0x2a1)](_0xd5c3ff[_0x38780d(0x23e)]);}}),_0xd5c3ff['ExzID'](it,_0x1338b6(0x24a),async()=>{const _0x15a93e=_0x1338b6,_0x37bd6b={'method':_0x4d5c85[_0x15a93e(0x1be)],'url':_0x15a93e(0x1c7),'host':_0x4d5c85[_0x15a93e(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85[_0x15a93e(0x1d9)]},_0x22b9cc=await _0x4d5c85[_0x15a93e(0x197)](expect,Hawk[_0x15a93e(0x17f)][_0x15a93e(0x286)](_0x37bd6b,_0x562c6f))['to'][_0x15a93e(0x2a1)](_0x4d5c85[_0x15a93e(0x19d)]),_0x20eebb=_0x22b9cc['output'][_0x15a93e(0x16c)][_0x15a93e(0x1b6)],_0x1ded49=_0x20eebb['match'](/^Hawk ts\=\"(\d+)\"\, tsm\=\"([^\"]+)\"\, error=\"Stale timestamp\"$/),_0x2fe747=Hawk['utils'][_0x15a93e(0x277)]();expect(_0x4d5c85[_0x15a93e(0x2e7)](_0x4d5c85[_0x15a93e(0x2cd)](parseInt,_0x1ded49[0x1],0xa),0x3e8))['to']['be'][_0x15a93e(0x295)](_0x2fe747-0x3e8,_0x2fe747+0x3e8);const _0x9533d4={'headers':{'www-authenticate':_0x20eebb}};_0x4d5c85[_0x15a93e(0x197)](expect,()=>Hawk[_0x15a93e(0x1f1)][_0x15a93e(0x286)](_0x9533d4,_0x22b9cc[_0x15a93e(0x21c)],_0x22b9cc[_0x15a93e(0x172)]))['to'][_0x15a93e(0x223)][_0x15a93e(0x19f)]();}),it(_0x1338b6(0x207),async()=>{const _0x3aaa70=_0x1338b6,_0x2670e5={'method':_0xd5c3ff[_0x3aaa70(0x167)],'url':'/resource/4?filter=a','host':_0x3aaa70(0x2c7),'port':0x1f90,'authorization':_0x3aaa70(0x1ca)},_0x1f4bec={},_0x5e77a0={'localtimeOffsetMsec':_0xd5c3ff[_0x3aaa70(0x240)](0x13b34143208,Hawk[_0x3aaa70(0x165)][_0x3aaa70(0x277)]()),'nonceFunc':function(_0x5a5c42,_0x53b49b,_0x316091){const _0x49e7b4=_0x3aaa70;if(_0x1f4bec[_0x5a5c42+_0x53b49b])throw new Error();_0x1f4bec[_0x4d5c85[_0x49e7b4(0x229)](_0x5a5c42,_0x53b49b)]=!![];}},{credentials:_0x38d1df}=await Hawk['server'][_0x3aaa70(0x286)](_0x2670e5,_0x562c6f,_0x5e77a0);expect(_0x38d1df[_0x3aaa70(0x1f0)])['to'][_0x3aaa70(0x2c6)](_0xd5c3ff[_0x3aaa70(0x1d1)]),await expect(Hawk[_0x3aaa70(0x17f)][_0x3aaa70(0x286)](_0x2670e5,_0x562c6f,_0x5e77a0))['to'][_0x3aaa70(0x2a1)](_0x3aaa70(0x2ae));}),_0xd5c3ff['ExzID'](it,'does\x20not\x20error\x20on\x20nonce\x20collision\x20if\x20keys\x20differ',async()=>{const _0x90522e=_0x1338b6,_0x11a4f8={'mLBgT':function(_0x28b15c,_0x31713e){const _0x4b2e97=_0x295c;return _0x4d5c85[_0x4b2e97(0x1a9)](_0x28b15c,_0x31713e);},'IQzne':_0x90522e(0x2bf),'hYtDm':function(_0x1a8365,_0x2ba076){return _0x1a8365+_0x2ba076;},'CStab':function(_0xbeb460,_0x3dd4ea){const _0x40cb12=_0x90522e;return _0x4d5c85[_0x40cb12(0x227)](_0xbeb460,_0x3dd4ea);}},_0x1f3377={'method':_0x90522e(0x2d2),'url':_0x4d5c85[_0x90522e(0x264)],'host':_0x4d5c85['iYrai'],'port':0x1f90,'authorization':_0x90522e(0x1ca)},_0x3dbd3a={'method':_0x4d5c85[_0x90522e(0x1be)],'url':_0x90522e(0x1c7),'host':_0x4d5c85[_0x90522e(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85[_0x90522e(0x1cf)]},_0x31a2cb=function(_0x68bb63){const _0x5e0443=_0x90522e,_0x42a6f2={'123':{'id':_0x68bb63,'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x68bb63==='1'?_0x5e0443(0x2bf):_0x5e0443(0x1d2),'user':_0x5e0443(0x1ea)},'456':{'id':_0x68bb63,'key':'xrunpaw3489ruxnpa98w4rxnwerxhqb98rpaxn39848','algorithm':_0x11a4f8[_0x5e0443(0x217)](_0x68bb63,'1')?_0x11a4f8['IQzne']:_0x5e0443(0x1d2),'user':'bob'}};return _0x42a6f2[_0x68bb63];},_0x409041={},_0x1968ee={'localtimeOffsetMsec':0x13b34143208-Hawk[_0x90522e(0x165)][_0x90522e(0x277)](),'nonceFunc':function(_0x4f02ee,_0x41d379,_0x488a70){const _0x496588=_0x90522e;if(_0x409041[_0x11a4f8[_0x496588(0x2a3)](_0x4f02ee,_0x41d379)])throw new Error();_0x409041[_0x11a4f8[_0x496588(0x1e8)](_0x4f02ee,_0x41d379)]=!![];}},{credentials:_0x567105}=await Hawk['server'][_0x90522e(0x286)](_0x1f3377,_0x31a2cb,_0x1968ee);expect(_0x567105[_0x90522e(0x1f0)])['to']['equal'](_0x90522e(0x1ea));const {credentials:_0x254265}=await Hawk[_0x90522e(0x17f)][_0x90522e(0x286)](_0x3dbd3a,_0x31a2cb,_0x1968ee);_0x4d5c85[_0x90522e(0x1ab)](expect,_0x254265['user'])['to'][_0x90522e(0x2c6)]('bob');}),it(_0x1338b6(0x29c),async()=>{const _0x304f19=_0x1338b6,_0x1d4314={'method':_0x304f19(0x2d2),'url':_0x4d5c85[_0x304f19(0x264)],'host':_0x4d5c85[_0x304f19(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85[_0x304f19(0x27f)]};await expect(Hawk[_0x304f19(0x17f)][_0x304f19(0x286)](_0x1d4314,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x304f19(0x165)][_0x304f19(0x277)]()}))['to']['reject']('Unauthorized');}),it(_0xd5c3ff[_0x1338b6(0x1d7)],async()=>{const _0x9f1ad1=_0x1338b6,_0x2119b2={'method':'GET','url':_0x9f1ad1(0x1c7),'host':_0x4d5c85[_0x9f1ad1(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85['PDwam']};await expect(Hawk['server'][_0x9f1ad1(0x286)](_0x2119b2,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85['UiOzT'](0x13b34143208,Hawk[_0x9f1ad1(0x165)][_0x9f1ad1(0x277)]())}))['to'][_0x9f1ad1(0x2a1)](_0x4d5c85[_0x9f1ad1(0x236)]);}),it('errors\x20on\x20an\x20missing\x20authorization\x20header',async()=>{const _0x2b783a=_0x1338b6,_0x2b6544={'vpwgR':_0x2b783a(0x2ab),'vaJjG':_0x2b783a(0x2c7),'AUlWK':_0xd5c3ff[_0x2b783a(0x26d)],'yMcDE':_0xd5c3ff[_0x2b783a(0x19b)],'SKrxv':_0x2b783a(0x2a2)};if(_0xd5c3ff[_0x2b783a(0x220)](_0x2b783a(0x272),_0x2b783a(0x272))){const _0x33818a={'id':'123456','key':_0x2b783a(0x2b0),'algorithm':_0x2b783a(0x1d2),'user':_0x2b783a(0x1ea)},_0x2f8654={'method':_0x2b6544['vpwgR'],'host':_0x2b6544[_0x2b783a(0x292)],'port':_0x2b6544[_0x2b783a(0x246)],'resource':_0x2b6544[_0x2b783a(0x211)],'ts':'1398546787','nonce':_0x2b783a(0x291),'hash':_0x2b783a(0x294),'mac':_0x2b6544[_0x2b783a(0x2c0)],'id':_0x2b783a(0x2f9)},_0x417299=_0x5983d5[_0x2b783a(0x17f)][_0x2b783a(0x195)](_0x33818a,_0x2f8654,{'payload':_0x2b783a(0x265),'contentType':'text/plain','ext':null});_0x31ce84(_0x417299)['to']['equal'](_0x2b783a(0x27c));}else{const _0x586cc0={'method':_0xd5c3ff['iXQwv'],'url':'/resource/4?filter=a','host':_0xd5c3ff['GPplr'],'port':0x1f90},_0x18a027=await expect(Hawk[_0x2b783a(0x17f)]['authenticate'](_0x586cc0,_0x562c6f))['to']['reject']();_0xd5c3ff[_0x2b783a(0x281)](expect,_0x18a027['isMissing'])['to'][_0x2b783a(0x2c6)](!![]);}}),_0xd5c3ff[_0x1338b6(0x257)](it,_0x1338b6(0x2e1),async()=>{const _0x2345bd=_0x1338b6,_0x8a723d={'method':_0x4d5c85[_0x2345bd(0x1be)],'url':_0x2345bd(0x1c7),'headers':{'authorization':_0x2345bd(0x263)}};await expect(Hawk[_0x2345bd(0x17f)][_0x2345bd(0x286)](_0x8a723d,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x2345bd(0x2fb)](0x13b34143208,Hawk[_0x2345bd(0x165)][_0x2345bd(0x277)]())}))['to'][_0x2345bd(0x2a1)](_0x4d5c85['TDKjU']);}),it(_0x1338b6(0x1a1),async()=>{const _0x799844=_0x1338b6,_0x26b560={'method':_0xd5c3ff[_0x799844(0x167)],'url':'/resource/4?filter=a','host':_0x799844(0x2c7),'port':0x1f90,'authorization':_0xd5c3ff[_0x799844(0x16d)]};await expect(Hawk[_0x799844(0x17f)][_0x799844(0x286)](_0x26b560,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x799844(0x165)][_0x799844(0x277)]()}))['to']['reject'](_0xd5c3ff[_0x799844(0x17e)]);}),_0xd5c3ff['JPauL'](it,_0x1338b6(0x271),async()=>{const _0x243720=_0x1338b6,_0x27eac8={'method':'GET','url':_0x243720(0x1c7),'host':_0xd5c3ff[_0x243720(0x1eb)],'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'};await expect(Hawk[_0x243720(0x17f)][_0x243720(0x286)](_0x27eac8,_0x562c6f,{'localtimeOffsetMsec':_0xd5c3ff['BLwXQ'](0x13b34143208,Hawk[_0x243720(0x165)][_0x243720(0x277)]())}))['to']['reject'](_0xd5c3ff['btnDb']);}),_0xd5c3ff[_0x1338b6(0x19a)](it,_0xd5c3ff[_0x1338b6(0x200)],async()=>{const _0x3d3856=_0x1338b6,_0x3308cd={'method':_0x3d3856(0x2d2),'url':_0x3d3856(0x1c7),'host':'example.com','port':0x1f90,'authorization':_0x3d3856(0x23a)};await expect(Hawk[_0x3d3856(0x17f)][_0x3d3856(0x286)](_0x3308cd,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk['utils'][_0x3d3856(0x277)]()}))['to'][_0x3d3856(0x2a1)](_0x4d5c85['hIbLn']);}),_0xd5c3ff['uYeMR'](it,_0x1338b6(0x1b8),async()=>{const _0x2025f2=_0x1338b6,_0x188b16={'method':_0x2025f2(0x2d2),'url':_0x2025f2(0x1c7),'host':_0x4d5c85[_0x2025f2(0x1b4)],'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20ext=\x22hello\x22'};await _0x4d5c85[_0x2025f2(0x22f)](expect,Hawk['server']['authenticate'](_0x188b16,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85['RQlPO'](0x13b34143208,Hawk['utils'][_0x2025f2(0x277)]())}))['to']['reject']('Missing\x20attributes');}),_0xd5c3ff[_0x1338b6(0x228)](it,_0x1338b6(0x1a0),async()=>{const _0xc022a5=_0x1338b6,_0x356b9c={'method':'GET','url':'/resource/4?filter=a','host':_0x4d5c85[_0xc022a5(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85['cSeuP']};await _0x4d5c85['AuciK'](expect,Hawk['server'][_0xc022a5(0x286)](_0x356b9c,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0xc022a5(0x165)][_0xc022a5(0x277)]()}))['to'][_0xc022a5(0x2a1)](_0xc022a5(0x16e));}),it(_0x1338b6(0x2b4),async()=>{const _0x55fc7b=_0x1338b6,_0x23e64c={'method':_0x4d5c85[_0x55fc7b(0x1be)],'url':_0x4d5c85[_0x55fc7b(0x264)],'host':_0x4d5c85[_0x55fc7b(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85[_0x55fc7b(0x26c)]};await _0x4d5c85[_0x55fc7b(0x184)](expect,Hawk['server'][_0x55fc7b(0x286)](_0x23e64c,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk['utils'][_0x55fc7b(0x277)]()}))['to'][_0x55fc7b(0x2a1)](_0x55fc7b(0x174));}),_0xd5c3ff[_0x1338b6(0x25c)](it,_0x1338b6(0x284),async()=>{const _0x2622c0=_0x1338b6,_0x5aa25d={'method':_0x4d5c85[_0x2622c0(0x1be)],'url':_0x2622c0(0x1c7),'host':_0x2622c0(0x2c7),'port':0x1f90,'authorization':_0x2622c0(0x181)};await expect(Hawk[_0x2622c0(0x17f)]['authenticate'](_0x5aa25d,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x2622c0(0x1bc)](0x13b34143208,Hawk[_0x2622c0(0x165)][_0x2622c0(0x277)]())}))['to']['reject'](_0x4d5c85[_0x2622c0(0x177)]);}),it('errors\x20on\x20an\x20empty\x20authorization\x20attribute\x20value',async()=>{const _0x10e492=_0x1338b6,_0x34da40={'method':_0x4d5c85[_0x10e492(0x1be)],'url':_0x4d5c85['rPLfd'],'host':_0x10e492(0x2c7),'port':0x1f90,'authorization':_0x4d5c85['dHHvo']};await expect(Hawk['server']['authenticate'](_0x34da40,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x10e492(0x2fb)](0x13b34143208,Hawk[_0x10e492(0x165)]['now']())}))['to'][_0x10e492(0x2a1)]('Bad\x20attribute\x20value:\x20id');}),_0xd5c3ff[_0x1338b6(0x2d3)](it,_0xd5c3ff['hXVCH'],async()=>{const _0x31bbe0=_0x1338b6;if(_0x31bbe0(0x2df)!==_0x31bbe0(0x171)){const _0x148f97={'method':_0x4d5c85[_0x31bbe0(0x1be)],'url':_0x4d5c85['rPLfd'],'host':_0x4d5c85[_0x31bbe0(0x1b4)],'port':0x1f90,'authorization':_0x31bbe0(0x1fc)};await _0x4d5c85[_0x31bbe0(0x1c1)](expect,Hawk[_0x31bbe0(0x17f)][_0x31bbe0(0x286)](_0x148f97,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x31bbe0(0x165)][_0x31bbe0(0x277)]()}))['to'][_0x31bbe0(0x2a1)](_0x4d5c85[_0x31bbe0(0x175)]);}else{const _0x572e94={'id':_0x4d5c85[_0x31bbe0(0x188)],'key':_0x31bbe0(0x2b0),'algorithm':_0x4d5c85['Zjmzq'],'user':_0x31bbe0(0x1ea)};_0x4d5c85[_0x31bbe0(0x1ab)](_0x2dfd59,()=>_0x145fd5[_0x31bbe0(0x17f)][_0x31bbe0(0x195)](_0x572e94,null,{'payload':_0x31bbe0(0x265),'contentType':'text/plain','ext':_0x31bbe0(0x2a8)}))['to']['throw'](_0x4d5c85[_0x31bbe0(0x1a3)]);}}),it(_0xd5c3ff[_0x1338b6(0x241)],async()=>{const _0x43a1eb=_0x1338b6,_0x37707f={'method':_0x43a1eb(0x2d2),'url':_0x4d5c85[_0x43a1eb(0x264)],'host':'example.com','port':0x1f90,'authorization':_0x43a1eb(0x18b)};await _0x4d5c85[_0x43a1eb(0x1f2)](expect,Hawk['server'][_0x43a1eb(0x286)](_0x37707f,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x43a1eb(0x165)][_0x43a1eb(0x277)]()}))['to']['reject']('Invalid\x20header\x20syntax');}),_0xd5c3ff[_0x1338b6(0x2b5)](it,'errors\x20on\x20an\x20bad\x20host\x20header\x20(missing\x20host)',async()=>{const _0x345bcd=_0x1338b6,_0x50c883={'method':_0x4d5c85[_0x345bcd(0x1be)],'url':_0x345bcd(0x1c7),'headers':{'host':_0x345bcd(0x1ee),'authorization':_0x345bcd(0x263)}};await _0x4d5c85[_0x345bcd(0x18f)](expect,Hawk['server']['authenticate'](_0x50c883,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x345bcd(0x1bc)](0x13b34143208,Hawk[_0x345bcd(0x165)][_0x345bcd(0x277)]())}))['to'][_0x345bcd(0x2a1)](_0x4d5c85[_0x345bcd(0x19e)]);}),it(_0xd5c3ff['nimJT'],async()=>{const _0x3ae574=_0x1338b6,_0x3cfab7={'method':_0x3ae574(0x2d2),'url':_0xd5c3ff[_0x3ae574(0x19b)],'headers':{'host':_0x3ae574(0x17c),'authorization':_0xd5c3ff[_0x3ae574(0x18c)]}};await expect(Hawk['server'][_0x3ae574(0x286)](_0x3cfab7,_0x562c6f,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x3ae574(0x165)]['now']()}))['to'][_0x3ae574(0x2a1)](_0xd5c3ff[_0x3ae574(0x26a)]);}),_0xd5c3ff[_0x1338b6(0x2ee)](it,_0x1338b6(0x1b1),async()=>{const _0x5832a0=_0x1338b6,_0x562493={'method':_0x4d5c85[_0x5832a0(0x1be)],'url':'/resource/4?filter=a','headers':{'host':_0x5832a0(0x2d0),'authorization':_0x5832a0(0x263)}};await _0x4d5c85[_0x5832a0(0x22f)](expect,Hawk[_0x5832a0(0x17f)][_0x5832a0(0x286)](_0x562493,_0x562c6f,{'localtimeOffsetMsec':_0x4d5c85[_0x5832a0(0x25e)](0x13b34143208,Hawk[_0x5832a0(0x165)][_0x5832a0(0x277)]())}))['to'][_0x5832a0(0x2a1)](_0x4d5c85[_0x5832a0(0x19e)]);}),it(_0x1338b6(0x242),async()=>{const _0x1a1e9c=_0x1338b6,_0x379601={'method':_0xd5c3ff[_0x1a1e9c(0x167)],'url':_0xd5c3ff[_0x1a1e9c(0x19b)],'host':_0xd5c3ff['GPplr'],'port':0x1f90,'authorization':_0xd5c3ff[_0x1a1e9c(0x20e)]},_0x349588=function(_0x4159c6){const _0x20599b=_0x1a1e9c;throw new Error(_0x20599b(0x2f0));};await _0xd5c3ff['wBCWv'](expect,Hawk[_0x1a1e9c(0x17f)]['authenticate'](_0x379601,_0x349588,{'localtimeOffsetMsec':_0xd5c3ff[_0x1a1e9c(0x28c)](0x13b34143208,Hawk[_0x1a1e9c(0x165)][_0x1a1e9c(0x277)]())}))['to'][_0x1a1e9c(0x2a1)](_0xd5c3ff[_0x1a1e9c(0x1ff)]);}),it('errors\x20on\x20credentialsFunc\x20error\x20(with\x20credentials)',async()=>{const _0x338d47=_0x1338b6,_0x1e3fb5={'NcSVT':_0x338d47(0x2b0),'pjWcX':_0x338d47(0x20b),'ECnlf':_0xd5c3ff[_0x338d47(0x1d1)],'wjOHg':function(_0x4106c4,_0xaec1d2){return _0x4106c4(_0xaec1d2);},'MfPjt':function(_0x327839,_0x1de463){const _0x103d88=_0x338d47;return _0xd5c3ff[_0x103d88(0x2f7)](_0x327839,_0x1de463);},'Zckbn':_0xd5c3ff[_0x338d47(0x2da)]};if(_0xd5c3ff['YOhXy']('fmfHZ',_0xd5c3ff[_0x338d47(0x2e9)]))return{'key':_0x1e3fb5['NcSVT'],'algorithm':_0x1e3fb5[_0x338d47(0x2fa)],'user':_0x1e3fb5['ECnlf']};else{const _0x5051c9={'method':_0xd5c3ff[_0x338d47(0x167)],'url':_0x338d47(0x1c7),'host':_0xd5c3ff[_0x338d47(0x1eb)],'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'},_0x460292=function(_0x2fa6d3){const _0x1cf3f8=_0x338d47;if(_0x1e3fb5[_0x1cf3f8(0x2d7)](_0x1e3fb5[_0x1cf3f8(0x258)],_0x1e3fb5['Zckbn'])){const _0x27a0ad=new Error(_0x1cf3f8(0x2f0));_0x27a0ad[_0x1cf3f8(0x21c)]={'some':'value'};throw _0x27a0ad;}else{const _0x13aec3=_0x2bb80c('123456');_0x1e3fb5[_0x1cf3f8(0x29f)](_0x30cda7,()=>_0x5929ab[_0x1cf3f8(0x1f1)]['message'](null,0x1f90,_0x1cf3f8(0x2c9),{'credentials':_0x13aec3}))['to'][_0x1cf3f8(0x19f)]('Invalid\x20inputs');}},_0x170c6d=await expect(Hawk[_0x338d47(0x17f)][_0x338d47(0x286)](_0x5051c9,_0x460292,{'localtimeOffsetMsec':_0xd5c3ff[_0x338d47(0x2ac)](0x13b34143208,Hawk['utils'][_0x338d47(0x277)]())}))['to'][_0x338d47(0x2a1)]('Unknown\x20user');expect(_0x170c6d[_0x338d47(0x21c)][_0x338d47(0x23d)])['to'][_0x338d47(0x2c6)](_0x338d47(0x1c6));}}),_0xd5c3ff[_0x1338b6(0x1fa)](it,_0xd5c3ff[_0x1338b6(0x178)],async()=>{const _0x3e80f3=_0x1338b6,_0x58a635={'method':_0x4d5c85['evhQX'],'url':_0x4d5c85[_0x3e80f3(0x264)],'host':_0x3e80f3(0x2c7),'port':0x1f90,'authorization':_0x4d5c85[_0x3e80f3(0x1fd)]},_0x1ce50b=function(_0x3c5020){return null;};await expect(Hawk[_0x3e80f3(0x17f)]['authenticate'](_0x58a635,_0x1ce50b,{'localtimeOffsetMsec':0x13b34143208-Hawk['utils'][_0x3e80f3(0x277)]()}))['to'][_0x3e80f3(0x2a1)](_0x3e80f3(0x222));}),_0xd5c3ff['KPTbI'](it,_0xd5c3ff[_0x1338b6(0x1ad)],async()=>{const _0x5911aa=_0x1338b6,_0x2a8e72={'tKooH':_0xd5c3ff[_0x5911aa(0x1d1)]};if(_0xd5c3ff['phByo']===_0xd5c3ff['NFZBz'])return null;else{const _0x58b230={'method':_0xd5c3ff['iXQwv'],'url':_0xd5c3ff['SosFt'],'host':_0x5911aa(0x2c7),'port':0x1f90,'authorization':_0x5911aa(0x263)},_0x468a52=function(_0x2741ab){const _0x5ab876=_0x5911aa;return{'key':_0x5ab876(0x2b0),'user':_0x2a8e72[_0x5ab876(0x2aa)]};},_0x18ae76=await _0xd5c3ff[_0x5911aa(0x282)](expect,Hawk[_0x5911aa(0x17f)][_0x5911aa(0x286)](_0x58b230,_0x468a52,{'localtimeOffsetMsec':_0xd5c3ff[_0x5911aa(0x187)](0x13b34143208,Hawk[_0x5911aa(0x165)][_0x5911aa(0x277)]())}))['to'][_0x5911aa(0x2a1)](_0xd5c3ff[_0x5911aa(0x24f)]);_0xd5c3ff[_0x5911aa(0x1df)](expect,_0x18ae76['output'][_0x5911aa(0x262)][_0x5911aa(0x29e)])['to'][_0x5911aa(0x2c6)](_0x5911aa(0x16b));}}),it(_0xd5c3ff[_0x1338b6(0x176)],async()=>{const _0x437350=_0x1338b6,_0x3ff99f={'method':'GET','url':'/resource/4?filter=a','host':'example.com','port':0x1f90,'authorization':_0x4d5c85[_0x437350(0x1fd)]},_0x5df306=function(_0xeff7ae){const _0x545bbb=_0x437350;return{'id':_0x545bbb(0x1a8),'user':_0x545bbb(0x1ea)};},_0x47f02a=await _0x4d5c85[_0x437350(0x160)](expect,Hawk[_0x437350(0x17f)][_0x437350(0x286)](_0x3ff99f,_0x5df306,{'localtimeOffsetMsec':_0x4d5c85[_0x437350(0x25e)](0x13b34143208,Hawk['utils'][_0x437350(0x277)]())}))['to'][_0x437350(0x2a1)](_0x4d5c85[_0x437350(0x1ed)]);_0x4d5c85[_0x437350(0x1f2)](expect,_0x47f02a['output']['payload'][_0x437350(0x29e)])['to'][_0x437350(0x2c6)]('An\x20internal\x20server\x20error\x20occurred');}),_0xd5c3ff['uYeMR'](it,'errors\x20on\x20unknown\x20credentials\x20algorithm',async()=>{const _0x23a24f=_0x1338b6,_0x26a33b={'method':_0xd5c3ff[_0x23a24f(0x167)],'url':'/resource/4?filter=a','host':'example.com','port':0x1f90,'authorization':_0xd5c3ff['mDTpS']},_0x31e16b=function(_0x49e439){const _0x277c14=_0x23a24f,_0x33019a={'rMoLq':_0x4d5c85[_0x277c14(0x28d)],'woMCk':_0x4d5c85[_0x277c14(0x26e)],'JYcJa':_0x4d5c85[_0x277c14(0x296)],'clSEz':_0x4d5c85[_0x277c14(0x264)],'HGwNm':_0x277c14(0x28b),'DXsCW':_0x277c14(0x291),'DiezQ':_0x4d5c85['nTCqh'],'PKgUT':_0x277c14(0x2f9),'oEWNg':_0x277c14(0x265),'rvXyt':_0x4d5c85[_0x277c14(0x2e6)],'DIBoI':_0x277c14(0x2a8)};if(_0x4d5c85[_0x277c14(0x244)](_0x4d5c85[_0x277c14(0x1c2)],'UXxHE')){const _0x106d39={'id':_0x277c14(0x2f9),'key':_0x33019a[_0x277c14(0x2e0)],'algorithm':_0x277c14(0x1d2),'user':_0x33019a[_0x277c14(0x24b)]},_0x5116c8={'method':_0x277c14(0x2ab),'host':_0x277c14(0x2c7),'port':_0x33019a[_0x277c14(0x163)],'resource':_0x33019a['clSEz'],'ts':_0x33019a[_0x277c14(0x180)],'nonce':_0x33019a[_0x277c14(0x2b2)],'hash':_0x33019a[_0x277c14(0x1c0)],'ext':_0x277c14(0x18d),'mac':_0x277c14(0x2a2),'id':_0x33019a[_0x277c14(0x1bf)]},_0xd7a9f5=_0xcef4f6['server'][_0x277c14(0x195)](_0x106d39,_0x5116c8,{'payload':_0x33019a[_0x277c14(0x1ae)],'contentType':_0x33019a[_0x277c14(0x2bd)],'ext':_0x33019a[_0x277c14(0x2ea)]});_0x476087(_0xd7a9f5)['to']['equal']('Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22');}else return{'key':_0x4d5c85[_0x277c14(0x28d)],'algorithm':'hmac-sha-0','user':_0x4d5c85['rymVz']};},_0x16fd6b=await expect(Hawk[_0x23a24f(0x17f)][_0x23a24f(0x286)](_0x26a33b,_0x31e16b,{'localtimeOffsetMsec':_0xd5c3ff[_0x23a24f(0x240)](0x13b34143208,Hawk[_0x23a24f(0x165)]['now']())}))['to'][_0x23a24f(0x2a1)](_0xd5c3ff[_0x23a24f(0x2b7)]);expect(_0x16fd6b['output']['payload'][_0x23a24f(0x29e)])['to'][_0x23a24f(0x2c6)](_0xd5c3ff[_0x23a24f(0x1c9)]);}),it(_0xd5c3ff[_0x1338b6(0x1f4)],async()=>{const _0xf8c306=_0x1338b6,_0x21c844={'method':'GET','url':_0xf8c306(0x1c7),'host':_0x4d5c85[_0xf8c306(0x1b4)],'port':0x1f90,'authorization':_0x4d5c85['XIhml']},_0x1dd63b=function(_0x14e136){const _0x2081e2=_0xf8c306;return{'key':_0x2081e2(0x2b0),'algorithm':_0x2081e2(0x1d2),'user':'steve'};};await _0x4d5c85[_0xf8c306(0x2de)](expect,Hawk['server'][_0xf8c306(0x286)](_0x21c844,_0x1dd63b,{'localtimeOffsetMsec':_0x4d5c85[_0xf8c306(0x1bc)](0x13b34143208,Hawk[_0xf8c306(0x165)][_0xf8c306(0x277)]())}))['to'][_0xf8c306(0x2a1)]('Bad\x20mac');});}),_0xd5c3ff[_0x2fb131(0x2ad)](describe,_0x2fb131(0x2c1),()=>{const _0x1721f7=_0x2fb131,_0xa60910={'AtLQW':_0x1721f7(0x1ea),'zZSzd':_0xd5c3ff[_0x1721f7(0x1eb)],'PggZy':_0xd5c3ff[_0x1721f7(0x26d)],'oRypx':_0xd5c3ff[_0x1721f7(0x19b)],'FrJjY':_0x1721f7(0x28b),'VVoKc':_0xd5c3ff[_0x1721f7(0x170)],'PePqS':_0x1721f7(0x18d),'oTFAG':_0x1721f7(0x2f9),'QyxLN':_0x1721f7(0x2a8),'sEXuk':_0x1721f7(0x2dc),'tIoGz':_0xd5c3ff[_0x1721f7(0x193)],'shoRh':_0xd5c3ff['vUyOp'],'hXaGa':_0xd5c3ff[_0x1721f7(0x1db)],'elVFi':_0xd5c3ff[_0x1721f7(0x2eb)],'sVnOl':function(_0x43f8ee,_0x5823e6){return _0xd5c3ff['BQXDy'](_0x43f8ee,_0x5823e6);},'qPBTv':_0xd5c3ff[_0x1721f7(0x2cc)],'YXGZR':_0x1721f7(0x1dd)};it(_0x1721f7(0x2f5),()=>{const _0x2d66fa=_0x1721f7,_0x10bb9a={'uXHNX':function(_0x291c92,_0x41ba02){const _0x3e1ae8=_0x295c;return _0xd5c3ff[_0x3e1ae8(0x202)](_0x291c92,_0x41ba02);}};if(_0xd5c3ff[_0x2d66fa(0x220)](_0xd5c3ff[_0x2d66fa(0x2e5)],'kbBrQ')){if(_0x4eaba3[_0x10bb9a[_0x2d66fa(0x24d)](_0x5b694c,_0x491254)])throw new _0x43dacd();_0x331b80[_0x10bb9a[_0x2d66fa(0x24d)](_0x1984c5,_0x3428b1)]=!![];}else{const _0x2004d9={'id':_0xd5c3ff[_0x2d66fa(0x251)],'key':_0x2d66fa(0x2b0),'algorithm':_0xd5c3ff['RlYIV'],'user':_0x2d66fa(0x1ea)},_0x581918={'method':_0xd5c3ff[_0x2d66fa(0x20f)],'host':_0xd5c3ff[_0x2d66fa(0x1eb)],'port':_0x2d66fa(0x1d4),'resource':_0x2d66fa(0x1c7),'ts':_0x2d66fa(0x28b),'nonce':_0x2d66fa(0x291),'hash':_0x2d66fa(0x294),'ext':_0xd5c3ff[_0x2d66fa(0x1b0)],'mac':_0xd5c3ff['vUyOp'],'id':_0x2d66fa(0x2f9)},_0x522854=Hawk[_0x2d66fa(0x17f)][_0x2d66fa(0x195)](_0x2004d9,_0x581918,{'payload':_0xd5c3ff[_0x2d66fa(0x1db)],'contentType':_0xd5c3ff['vFKDz'],'ext':_0xd5c3ff[_0x2d66fa(0x237)]});_0xd5c3ff['XWKBe'](expect,_0x522854)['to'][_0x2d66fa(0x2c6)](_0x2d66fa(0x1e2));}}),it(_0xd5c3ff['ihgQS'],()=>{const _0x379bc8=_0x1721f7,_0x39f0f8={'id':_0x379bc8(0x2f9),'key':_0x379bc8(0x2b0),'algorithm':_0x379bc8(0x1d2),'user':_0xa60910[_0x379bc8(0x1c3)]},_0x890048={'method':'POST','host':_0xa60910[_0x379bc8(0x293)],'port':_0xa60910[_0x379bc8(0x1cd)],'resource':_0xa60910[_0x379bc8(0x2ef)],'ts':_0xa60910[_0x379bc8(0x16a)],'nonce':_0x379bc8(0x291),'hash':_0xa60910[_0x379bc8(0x261)],'ext':_0xa60910['PePqS'],'mac':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','id':_0xa60910['oTFAG']},_0x2aa110=Hawk[_0x379bc8(0x17f)][_0x379bc8(0x195)](_0x39f0f8,_0x890048,{'payload':'','contentType':_0x379bc8(0x2f8),'ext':_0xa60910[_0x379bc8(0x1bb)]});expect(_0x2aa110)['to'][_0x379bc8(0x2c6)](_0xa60910[_0x379bc8(0x204)]);}),_0xd5c3ff[_0x1721f7(0x183)](it,_0xd5c3ff[_0x1721f7(0x20c)],()=>{const _0x2d5cc9=_0x1721f7,_0x332eb1={'id':_0xd5c3ff[_0x2d5cc9(0x251)],'key':_0xd5c3ff[_0x2d5cc9(0x2cc)],'algorithm':'sha256','user':_0xd5c3ff[_0x2d5cc9(0x1d1)]},_0x217cb8={'method':'POST','host':_0x2d5cc9(0x2c7),'port':_0xd5c3ff['Jttzz'],'resource':_0x2d5cc9(0x1c7),'ts':_0xd5c3ff[_0x2d5cc9(0x203)],'nonce':'xUwusx','hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':'','mac':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','id':_0x2d5cc9(0x2f9)},_0x3d5742=Hawk['server'][_0x2d5cc9(0x195)](_0x332eb1,_0x217cb8,{'payload':'','contentType':_0xd5c3ff[_0x2d5cc9(0x2eb)],'ext':''});_0xd5c3ff[_0x2d5cc9(0x1df)](expect,_0x3d5742)['to'][_0x2d5cc9(0x2c6)](_0x2d5cc9(0x25a));}),it(_0x1721f7(0x290),()=>{const _0x4f26fa=_0x1721f7,_0x1145d8={'id':_0xd5c3ff[_0x4f26fa(0x251)],'key':_0xd5c3ff['abDyW'],'algorithm':_0xd5c3ff[_0x4f26fa(0x1a6)],'user':_0xd5c3ff['GcpQZ']},_0x1c6d1f={'method':_0xd5c3ff[_0x4f26fa(0x20f)],'host':_0x4f26fa(0x2c7),'port':_0x4f26fa(0x1d4),'resource':'/resource/4?filter=a','ts':_0x4f26fa(0x28b),'nonce':_0xd5c3ff[_0x4f26fa(0x193)],'hash':_0xd5c3ff[_0x4f26fa(0x170)],'ext':_0xd5c3ff[_0x4f26fa(0x1b0)],'mac':_0xd5c3ff[_0x4f26fa(0x270)],'id':'123456'},_0xa45914={'payload':_0xd5c3ff[_0x4f26fa(0x1db)],'contentType':_0xd5c3ff[_0x4f26fa(0x2eb)],'ext':_0x4f26fa(0x2a8)};_0xa45914['hash']=Hawk[_0x4f26fa(0x2ec)][_0x4f26fa(0x224)](_0xa45914['payload'],_0x1145d8['algorithm'],_0xa45914[_0x4f26fa(0x247)]);const _0x3d7de1=Hawk[_0x4f26fa(0x17f)]['header'](_0x1145d8,_0x1c6d1f,_0xa45914);expect(_0x3d7de1)['to'][_0x4f26fa(0x2c6)](_0xd5c3ff[_0x4f26fa(0x269)]);}),it(_0xd5c3ff[_0x1721f7(0x221)],()=>{const _0x297c90=_0x1721f7,_0x45ece6={'id':_0xa60910[_0x297c90(0x1da)],'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x297c90(0x1d2),'user':_0x297c90(0x1ea)},_0x297c16={'method':_0x297c90(0x2ab),'host':_0xa60910[_0x297c90(0x293)],'port':'8080','resource':_0xa60910[_0x297c90(0x2ef)],'ts':_0xa60910['FrJjY'],'nonce':_0xa60910['tIoGz'],'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','mac':_0xa60910[_0x297c90(0x1b7)],'id':_0xa60910[_0x297c90(0x1da)]},_0x489569=Hawk[_0x297c90(0x17f)][_0x297c90(0x195)](_0x45ece6,_0x297c16,{'payload':_0xa60910[_0x297c90(0x2c2)],'contentType':_0xa60910[_0x297c90(0x1e1)],'ext':null});_0xa60910['sVnOl'](expect,_0x489569)['to'][_0x297c90(0x2c6)](_0x297c90(0x27c));}),it(_0xd5c3ff['Fwzmk'],()=>{const _0x185b89=_0x1721f7,_0x541634={'id':_0xd5c3ff[_0x185b89(0x251)],'key':_0xd5c3ff[_0x185b89(0x2cc)],'algorithm':_0xd5c3ff['RlYIV'],'user':_0x185b89(0x1ea)};expect(()=>Hawk[_0x185b89(0x17f)]['header'](_0x541634,null,{'payload':'some\x20reply','contentType':_0x185b89(0x2f8),'ext':_0x185b89(0x2a8)}))['to'][_0x185b89(0x19f)](_0xd5c3ff[_0x185b89(0x2c8)]);}),it(_0xd5c3ff[_0x1721f7(0x2a0)],()=>{const _0x5e5545=_0x1721f7,_0x594ef3={'id':'123456','key':_0xa60910[_0x5e5545(0x2a4)],'algorithm':'sha256','user':_0xa60910['AtLQW']};expect(()=>Hawk[_0x5e5545(0x17f)][_0x5e5545(0x195)](_0x594ef3,0x5,{'payload':_0x5e5545(0x265),'contentType':_0x5e5545(0x2f8),'ext':_0x5e5545(0x2a8)}))['to']['throw'](_0xa60910['YXGZR']);}),_0xd5c3ff[_0x1721f7(0x1fa)](it,_0x1721f7(0x2b6),()=>{const _0x58cfa3=_0x1721f7,_0x3f8c94={'method':'POST','host':_0x58cfa3(0x2c7),'port':_0x58cfa3(0x1d4),'resource':_0xa60910[_0x58cfa3(0x2ef)],'ts':'1398546787','nonce':_0x58cfa3(0x291),'hash':_0xa60910[_0x58cfa3(0x261)],'ext':_0x58cfa3(0x18d),'mac':_0x58cfa3(0x2a2),'id':_0xa60910['oTFAG']};expect(()=>Hawk[_0x58cfa3(0x17f)]['header'](null,_0x3f8c94,{'payload':_0x58cfa3(0x265),'contentType':'text/plain','ext':'response-specific'}))['to']['throw']('Invalid\x20credentials');}),it(_0x1721f7(0x182),()=>{const _0x32497a=_0x1721f7,_0x25423b={'id':_0x32497a(0x2f9),'algorithm':_0xd5c3ff[_0x32497a(0x1a6)],'user':_0xd5c3ff[_0x32497a(0x1d1)]},_0x2f5420={'method':_0xd5c3ff[_0x32497a(0x20f)],'host':'example.com','port':_0xd5c3ff[_0x32497a(0x26d)],'resource':_0xd5c3ff['SosFt'],'ts':'1398546787','nonce':_0x32497a(0x291),'hash':_0xd5c3ff[_0x32497a(0x170)],'ext':_0x32497a(0x18d),'mac':_0xd5c3ff[_0x32497a(0x270)],'id':_0x32497a(0x2f9)};_0xd5c3ff[_0x32497a(0x2ff)](expect,()=>Hawk[_0x32497a(0x17f)]['header'](_0x25423b,_0x2f5420,{'payload':_0x32497a(0x265),'contentType':'text/plain','ext':'response-specific'}))['to'][_0x32497a(0x19f)]('Invalid\x20credentials');}),_0xd5c3ff[_0x1721f7(0x228)](it,_0x1721f7(0x231),()=>{const _0x1d5385=_0x1721f7,_0x3d6eb4={'id':_0xd5c3ff[_0x1d5385(0x251)],'key':_0xd5c3ff[_0x1d5385(0x198)],'user':_0xd5c3ff['GcpQZ']},_0x3c3dbe={'method':_0x1d5385(0x2ab),'host':_0xd5c3ff['GPplr'],'port':_0xd5c3ff[_0x1d5385(0x26d)],'resource':_0x1d5385(0x1c7),'ts':_0x1d5385(0x28b),'nonce':_0xd5c3ff[_0x1d5385(0x193)],'hash':_0xd5c3ff['eJMmC'],'ext':'some-app-data','mac':_0xd5c3ff['vUyOp'],'id':'123456'};_0xd5c3ff[_0x1d5385(0x1df)](expect,()=>Hawk[_0x1d5385(0x17f)][_0x1d5385(0x195)](_0x3d6eb4,_0x3c3dbe,{'payload':_0x1d5385(0x265),'contentType':_0x1d5385(0x2f8),'ext':_0x1d5385(0x2a8)}))['to'][_0x1d5385(0x19f)]('Invalid\x20credentials');}),_0xd5c3ff[_0x1721f7(0x161)](it,_0xd5c3ff['lDUUU'],()=>{const _0x5af7bc=_0x1721f7,_0x21a88a={'id':_0x5af7bc(0x2f9),'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':'x','user':_0xd5c3ff['GcpQZ']},_0x2d420a={'method':_0x5af7bc(0x2ab),'host':_0x5af7bc(0x2c7),'port':_0x5af7bc(0x1d4),'resource':_0x5af7bc(0x1c7),'ts':_0x5af7bc(0x28b),'nonce':_0x5af7bc(0x291),'hash':_0xd5c3ff[_0x5af7bc(0x170)],'ext':_0x5af7bc(0x18d),'mac':_0xd5c3ff['vUyOp'],'id':'123456'};expect(()=>Hawk[_0x5af7bc(0x17f)]['header'](_0x21a88a,_0x2d420a,{'payload':_0x5af7bc(0x265),'contentType':_0x5af7bc(0x2f8),'ext':_0x5af7bc(0x2a8)}))['to']['throw'](_0x5af7bc(0x26f));}),_0xd5c3ff[_0x1721f7(0x183)](it,_0xd5c3ff['WUHeE'],()=>{const _0x11b15d=_0x1721f7,_0x4ac92a={'id':_0x11b15d(0x2f9),'algorithm':_0x11b15d(0x1d2),'user':'steve'},_0x4109ad={'method':_0x11b15d(0x2ab),'host':_0xd5c3ff['GPplr'],'port':_0xd5c3ff[_0x11b15d(0x26d)],'resource':_0xd5c3ff[_0x11b15d(0x19b)],'ts':_0x11b15d(0x28b),'nonce':_0x11b15d(0x291),'hash':_0x11b15d(0x294),'ext':_0x11b15d(0x18d),'mac':_0x11b15d(0x2a2),'id':_0x11b15d(0x2f9)};expect(()=>Hawk[_0x11b15d(0x17f)][_0x11b15d(0x195)](_0x4ac92a,_0x4109ad,_0x11b15d(0x1ba)))['to'][_0x11b15d(0x19f)]('Invalid\x20inputs');});}),describe(_0xd5c3ff[_0x2fb131(0x1c5)],()=>{const _0x8ced12=_0x2fb131,_0x348f1f={'zmEHJ':_0xd5c3ff[_0x8ced12(0x17b)],'iuMqF':function(_0x41da42,_0x27eadf){return _0x41da42(_0x27eadf);}};it(_0x8ced12(0x2f3),async()=>{const _0x545ef4=_0x8ced12;let _0x122f5e='/';for(let _0x198221=0x0;_0x198221<0x1388;++_0x198221){_0x122f5e+='x';}const _0x47e9bb={'method':_0x545ef4(0x2d2),'url':_0x122f5e,'host':_0x545ef4(0x2c7),'port':0x1f90,'authorization':'Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22'},_0x481ff8=await expect(Hawk[_0x545ef4(0x17f)]['authenticateBewit'](_0x47e9bb,_0x562c6f,{}))['to']['reject'](_0x348f1f['zmEHJ']);_0x348f1f[_0x545ef4(0x1b9)](expect,_0x481ff8[_0x545ef4(0x239)][_0x545ef4(0x1fb)])['to'][_0x545ef4(0x2c6)](0x190);});}),describe(_0x2fb131(0x2c3),()=>{const _0xe8c002=_0x2fb131,_0x5cd2a1={'XMVJl':_0xd5c3ff['RlYIV'],'dqOKp':_0xd5c3ff[_0xe8c002(0x1d1)],'IJdbx':function(_0x43fc49,_0x2dd232){return _0x43fc49===_0x2dd232;},'NLKlW':_0xd5c3ff[_0xe8c002(0x28f)],'ZgCDQ':_0xd5c3ff[_0xe8c002(0x251)],'CeION':_0xd5c3ff[_0xe8c002(0x22a)],'YCyGP':function(_0x2edb7e,_0x56c3e6){return _0x2edb7e(_0x56c3e6);},'ozGWl':_0xd5c3ff[_0xe8c002(0x2e4)],'QhdVk':function(_0x2a8b9e,_0x2c854b){return _0x2a8b9e(_0x2c854b);},'QGHeK':_0xd5c3ff['GPplr'],'HVCEr':function(_0x2bb333,_0x1dc135){return _0x2bb333(_0x1dc135);},'ovktf':_0xe8c002(0x210),'jxXVN':'some\x20message1','WefUh':_0xd5c3ff['qHKKz'],'TTUhh':_0xe8c002(0x1f6),'cuIaY':_0xe8c002(0x21f),'aYlME':function(_0x573405,_0xd536b6){const _0x37ce1c=_0xe8c002;return _0xd5c3ff[_0x37ce1c(0x252)](_0x573405,_0xd536b6);},'GpxWW':function(_0xcaf497,_0x2ba11c){return _0xcaf497(_0x2ba11c);},'XSSWj':_0xd5c3ff[_0xe8c002(0x2b7)],'JlNWX':function(_0x52c8c3,_0x19d76c){return _0x52c8c3!==_0x19d76c;},'KMQvt':function(_0x16c9d4,_0x27e64c){return _0x16c9d4(_0x27e64c);},'tEYCQ':'Invalid\x20inputs','EfsyI':_0xe8c002(0x169),'URpRj':'WOZJq','gqWqK':function(_0x2119c9,_0x5d9f74){const _0x4e6353=_0xe8c002;return _0xd5c3ff[_0x4e6353(0x1df)](_0x2119c9,_0x5d9f74);}};it('errors\x20on\x20invalid\x20authorization\x20(ts)',async()=>{const _0x2b0caf=_0xe8c002,_0x578d5a=_0xd5c3ff[_0x2b0caf(0x2dd)](_0x562c6f,_0xd5c3ff[_0x2b0caf(0x251)]),_0x50b7bd=Hawk['client']['message'](_0xd5c3ff[_0x2b0caf(0x1eb)],0x1f90,_0x2b0caf(0x2c9),{'credentials':_0x578d5a});delete _0x50b7bd['ts'],await _0xd5c3ff[_0x2b0caf(0x282)](expect,Hawk[_0x2b0caf(0x17f)][_0x2b0caf(0x243)]('example.com',0x1f90,_0xd5c3ff['BZvpi'],_0x50b7bd,_0x562c6f))['to']['reject'](_0x2b0caf(0x210));}),_0xd5c3ff[_0xe8c002(0x2cb)](it,_0xe8c002(0x28a),async()=>{const _0x4b84b6=_0xe8c002,_0x296e9d=_0xd5c3ff['kMFqD'](_0x562c6f,_0xd5c3ff[_0x4b84b6(0x251)]),_0x467e27=Hawk[_0x4b84b6(0x1f1)][_0x4b84b6(0x29e)](_0xd5c3ff['GPplr'],0x1f90,_0xd5c3ff['BZvpi'],{'credentials':_0x296e9d});delete _0x467e27[_0x4b84b6(0x2f4)],await _0xd5c3ff[_0x4b84b6(0x2d8)](expect,Hawk[_0x4b84b6(0x17f)][_0x4b84b6(0x243)](_0x4b84b6(0x2c7),0x1f90,_0x4b84b6(0x2c9),_0x467e27,_0x562c6f))['to'][_0x4b84b6(0x2a1)](_0xd5c3ff['lNLLL']);}),_0xd5c3ff[_0xe8c002(0x2e2)](it,_0xd5c3ff[_0xe8c002(0x19c)],async()=>{const _0x19a73f=_0xe8c002;if('DuwWx'==='MSJgz')return{};else{const _0x4598c9=_0xd5c3ff[_0x19a73f(0x1fe)](_0x562c6f,_0x19a73f(0x2f9)),_0x4610c3=Hawk[_0x19a73f(0x1f1)][_0x19a73f(0x29e)](_0x19a73f(0x2c7),0x1f90,_0xd5c3ff[_0x19a73f(0x22a)],{'credentials':_0x4598c9});delete _0x4610c3['nonce'],await _0xd5c3ff[_0x19a73f(0x268)](expect,Hawk[_0x19a73f(0x17f)][_0x19a73f(0x243)](_0xd5c3ff[_0x19a73f(0x1eb)],0x1f90,_0x19a73f(0x2c9),_0x4610c3,_0x562c6f))['to'][_0x19a73f(0x2a1)]('Invalid\x20authorization');}}),_0xd5c3ff['Hkdpx'](it,_0xd5c3ff[_0xe8c002(0x267)],async()=>{const _0x2f7bb8=_0xe8c002,_0x2a7df0=_0xd5c3ff[_0x2f7bb8(0x168)](_0x562c6f,'123456'),_0x40c6ba=Hawk[_0x2f7bb8(0x1f1)][_0x2f7bb8(0x29e)](_0x2f7bb8(0x2c7),0x1f90,_0xd5c3ff[_0x2f7bb8(0x22a)],{'credentials':_0x2a7df0});delete _0x40c6ba[_0x2f7bb8(0x17a)],await _0xd5c3ff[_0x2f7bb8(0x190)](expect,Hawk[_0x2f7bb8(0x17f)][_0x2f7bb8(0x243)](_0x2f7bb8(0x2c7),0x1f90,_0xd5c3ff[_0x2f7bb8(0x22a)],_0x40c6ba,_0x562c6f))['to'][_0x2f7bb8(0x2a1)]('Invalid\x20authorization');}),_0xd5c3ff['GZjzf'](it,_0xd5c3ff[_0xe8c002(0x29a)],async()=>{const _0x35d391=_0xe8c002,_0xf462ca=_0x562c6f(_0x35d391(0x2f9)),_0x914eb1=Hawk[_0x35d391(0x1f1)]['message'](_0xd5c3ff[_0x35d391(0x1eb)],0x1f90,_0xd5c3ff[_0x35d391(0x22a)],{'credentials':_0xf462ca}),_0x3879fe=await expect(Hawk[_0x35d391(0x17f)][_0x35d391(0x243)](_0xd5c3ff[_0x35d391(0x1eb)],0x1f90,_0xd5c3ff['BZvpi'],_0x914eb1,_0x3b3f1d=>{const _0x2f6ba7=_0x35d391,_0x57f5a3={'SZnkf':_0x5cd2a1[_0x2f6ba7(0x18e)],'zAair':_0x5cd2a1[_0x2f6ba7(0x21e)]};if(_0x5cd2a1[_0x2f6ba7(0x1b2)](_0x5cd2a1[_0x2f6ba7(0x1f9)],'eAWpg')){const _0x3fb084=new Error(_0x2f6ba7(0x214));_0x3fb084[_0x2f6ba7(0x21c)]={'some':_0x2f6ba7(0x1c6)};throw _0x3fb084;}else return{'key':_0x2f6ba7(0x2b0),'algorithm':_0x57f5a3[_0x2f6ba7(0x1ef)],'user':_0x57f5a3['zAair']};}))['to'][_0x35d391(0x2a1)](_0xd5c3ff[_0x35d391(0x2f6)]);expect(_0x3879fe[_0x35d391(0x21c)]['some'])['to'][_0x35d391(0x2c6)](_0x35d391(0x1c6));}),_0xd5c3ff[_0xe8c002(0x2d1)](it,_0xe8c002(0x2b8),async()=>{const _0x445f91=_0xe8c002,_0x5d4fcc=_0xd5c3ff[_0x445f91(0x15e)](_0x562c6f,_0xd5c3ff['NGySa']),_0xf84b49=Hawk[_0x445f91(0x1f1)][_0x445f91(0x29e)](_0xd5c3ff[_0x445f91(0x1eb)],0x1f90,_0x445f91(0x2c9),{'credentials':_0x5d4fcc}),_0x607235=function(_0x39dafe,_0x5e9e0e,_0xa72ff5){throw new Error();};await _0xd5c3ff[_0x445f91(0x1ce)](expect,Hawk['server'][_0x445f91(0x243)](_0xd5c3ff['GPplr'],0x1f90,_0xd5c3ff['BZvpi'],_0xf84b49,_0x562c6f,{'nonceFunc':_0x607235}))['to'][_0x445f91(0x2a1)](_0xd5c3ff[_0x445f91(0x1a5)]);}),it(_0xe8c002(0x2c4),async()=>{const _0x509771=_0xe8c002,_0x191f63=_0x562c6f(_0x509771(0x2f9)),_0x3d260d=Hawk[_0x509771(0x1f1)][_0x509771(0x29e)](_0x509771(0x2c7),0x1f90,_0xd5c3ff[_0x509771(0x22a)],{'credentials':_0x191f63});expect(_0x3d260d)['to'][_0x509771(0x2fd)]();const {credentials:_0x4a4ee7}=await Hawk['server'][_0x509771(0x243)](_0xd5c3ff[_0x509771(0x1eb)],0x1f90,_0xd5c3ff[_0x509771(0x22a)],_0x3d260d,_0x562c6f);expect(_0x4a4ee7[_0x509771(0x1f0)])['to']['equal'](_0xd5c3ff[_0x509771(0x1d1)]);}),_0xd5c3ff['muTPL'](it,_0xd5c3ff['oJict'],async()=>{const _0x3d2a54=_0xe8c002,_0x5d41c9=_0x562c6f(_0x5cd2a1[_0x3d2a54(0x1ec)]),_0x7c503=Hawk[_0x3d2a54(0x1f1)][_0x3d2a54(0x29e)](_0x3d2a54(0x2c7),0x1f90,_0x5cd2a1['CeION'],{'credentials':_0x5d41c9});_0x5cd2a1[_0x3d2a54(0x213)](expect,_0x7c503)['to'][_0x3d2a54(0x2fd)](),await expect(Hawk[_0x3d2a54(0x17f)][_0x3d2a54(0x243)](_0x3d2a54(0x2a9),0x1f90,'some\x20message',_0x7c503,_0x562c6f))['to'][_0x3d2a54(0x2a1)](_0x5cd2a1['ozGWl']);}),it(_0xe8c002(0x21b),async()=>{const _0x22e4e6=_0xe8c002,_0x1be333=_0x562c6f(_0x22e4e6(0x2f9)),_0x27fd8c=Hawk['client'][_0x22e4e6(0x29e)](_0x22e4e6(0x2c7),0x1f90,_0x5cd2a1[_0x22e4e6(0x205)],{'credentials':_0x1be333});expect(_0x27fd8c)['to'][_0x22e4e6(0x2fd)](),await _0x5cd2a1[_0x22e4e6(0x1af)](expect,Hawk['server'][_0x22e4e6(0x243)](_0x22e4e6(0x2c7),0x1f90,_0x22e4e6(0x2c9),_0x27fd8c,_0x562c6f,{'localtimeOffsetMsec':0x186a0}))['to']['reject']('Stale\x20timestamp');}),it(_0xd5c3ff[_0xe8c002(0x212)],async()=>{const _0x226aed=_0xe8c002,_0x42ff96=_0x562c6f(_0x226aed(0x2f9)),_0x1c4a0c=Hawk[_0x226aed(0x1f1)][_0x226aed(0x29e)](_0x226aed(0x2c7),0x1f90,_0xd5c3ff['BZvpi'],{'credentials':_0x42ff96,'localtimeOffsetMsec':0x186a0});_0xd5c3ff[_0x226aed(0x1bd)](expect,_0x1c4a0c)['to'][_0x226aed(0x2fd)](),await _0xd5c3ff['OEYzT'](expect,Hawk[_0x226aed(0x17f)][_0x226aed(0x243)](_0x226aed(0x2c7),0x1f90,_0x226aed(0x2c9),_0x1c4a0c,_0x562c6f,{'timestampSkewSec':0x1f4}))['to'][_0x226aed(0x223)][_0x226aed(0x2a1)]();}),_0xd5c3ff[_0xe8c002(0x206)](it,_0xe8c002(0x276),async()=>{const _0x2be7a9=_0xe8c002,_0x461090=_0x562c6f(_0x5cd2a1['ZgCDQ']),_0x3e6714=Hawk['client'][_0x2be7a9(0x29e)](_0x5cd2a1['QGHeK'],0x1f90,_0x5cd2a1[_0x2be7a9(0x205)],{'credentials':_0x461090});_0x5cd2a1[_0x2be7a9(0x21d)](expect,_0x3e6714)['to'][_0x2be7a9(0x2fd)](),delete _0x3e6714['id'],await expect(Hawk['server'][_0x2be7a9(0x243)](_0x5cd2a1[_0x2be7a9(0x289)],0x1f90,_0x5cd2a1[_0x2be7a9(0x205)],_0x3e6714,_0x562c6f))['to'][_0x2be7a9(0x2a1)](_0x5cd2a1[_0x2be7a9(0x2d4)]);}),_0xd5c3ff[_0xe8c002(0x1e4)](it,_0xd5c3ff[_0xe8c002(0x255)],async()=>{const _0x288bc0=_0xe8c002,_0x38cc73=_0x562c6f(_0x5cd2a1[_0x288bc0(0x1ec)]),_0x452d70=Hawk[_0x288bc0(0x1f1)][_0x288bc0(0x29e)](_0x288bc0(0x2c7),0x1f90,_0x288bc0(0x2c9),{'credentials':_0x38cc73});expect(_0x452d70)['to']['exist'](),await expect(Hawk['server'][_0x288bc0(0x243)](_0x288bc0(0x2c7),0x1f90,_0x5cd2a1[_0x288bc0(0x17d)],_0x452d70,_0x562c6f))['to']['reject'](_0x288bc0(0x162));}),it(_0xe8c002(0x16f),async()=>{const _0x303ca3=_0xe8c002,_0x265483=_0xd5c3ff['DOWUO'](_0x562c6f,'123456'),_0x623bfd=Hawk[_0x303ca3(0x1f1)][_0x303ca3(0x29e)]('example.com',0x1f90,_0xd5c3ff[_0x303ca3(0x22a)],{'credentials':_0x265483});expect(_0x623bfd)['to'][_0x303ca3(0x2fd)](),await expect(Hawk[_0x303ca3(0x17f)]['authenticateMessage'](_0xd5c3ff['GPplr'],0x1f90,_0xd5c3ff[_0x303ca3(0x22a)],_0x623bfd,_0x562c6f,{'nonceFunc':function(_0x1dad9a,_0x20c70f,_0x3943b9){const _0x5004d9=_0x303ca3;throw new Error(_0x5004d9(0x15f));}}))['to']['reject'](_0x303ca3(0x2ae));}),_0xd5c3ff[_0xe8c002(0x26b)](it,'should\x20fail\x20authorization\x20on\x20credentials\x20error',async()=>{const _0x3d73b9=_0xe8c002,_0x1eb506=_0xd5c3ff[_0x3d73b9(0x2a5)](_0x562c6f,_0xd5c3ff[_0x3d73b9(0x251)]),_0x32d198=Hawk[_0x3d73b9(0x1f1)][_0x3d73b9(0x29e)](_0xd5c3ff[_0x3d73b9(0x1eb)],0x1f90,'some\x20message',{'credentials':_0x1eb506});expect(_0x32d198)['to'][_0x3d73b9(0x2fd)]();const _0x47a205=function(_0x48f993){const _0x781b87=_0x3d73b9;throw new Error(_0x5cd2a1[_0x781b87(0x29b)]);};await expect(Hawk[_0x3d73b9(0x17f)][_0x3d73b9(0x243)](_0xd5c3ff[_0x3d73b9(0x1eb)],0x1f90,_0xd5c3ff['BZvpi'],_0x32d198,_0x47a205))['to'][_0x3d73b9(0x2a1)](_0xd5c3ff[_0x3d73b9(0x274)]);}),_0xd5c3ff[_0xe8c002(0x2ad)](it,_0xe8c002(0x253),async()=>{const _0x11e55c=_0xe8c002,_0xcb26b4=_0xd5c3ff[_0x11e55c(0x2db)](_0x562c6f,_0x11e55c(0x2f9)),_0x49dbff=Hawk[_0x11e55c(0x1f1)][_0x11e55c(0x29e)](_0xd5c3ff[_0x11e55c(0x1eb)],0x1f90,_0x11e55c(0x2c9),{'credentials':_0xcb26b4});expect(_0x49dbff)['to'][_0x11e55c(0x2fd)]();const _0x4b444b=function(_0xcff5f6){};await expect(Hawk[_0x11e55c(0x17f)][_0x11e55c(0x243)](_0x11e55c(0x2c7),0x1f90,_0x11e55c(0x2c9),_0x49dbff,_0x4b444b))['to']['reject'](_0xd5c3ff[_0x11e55c(0x278)]);}),_0xd5c3ff[_0xe8c002(0x1e4)](it,_0xd5c3ff['sQOFo'],async()=>{const _0x1adb86=_0xe8c002,_0xfd7e6c=_0xd5c3ff[_0x1adb86(0x252)](_0x562c6f,_0x1adb86(0x2f9)),_0x29ff9d=Hawk[_0x1adb86(0x1f1)][_0x1adb86(0x29e)](_0xd5c3ff[_0x1adb86(0x1eb)],0x1f90,'some\x20message',{'credentials':_0xfd7e6c});expect(_0x29ff9d)['to']['exist']();const _0x5cad93=function(_0x48568b){return{};};await expect(Hawk[_0x1adb86(0x17f)][_0x1adb86(0x243)](_0xd5c3ff[_0x1adb86(0x1eb)],0x1f90,_0x1adb86(0x2c9),_0x29ff9d,_0x5cad93))['to']['reject'](_0x1adb86(0x28e));}),it('should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20(algorithm)',async()=>{const _0x122966=_0xe8c002,_0x3d4dde=_0xd5c3ff[_0x122966(0x1bd)](_0x562c6f,_0x122966(0x2f9)),_0xa82f59=Hawk[_0x122966(0x1f1)][_0x122966(0x29e)](_0xd5c3ff[_0x122966(0x1eb)],0x1f90,_0xd5c3ff[_0x122966(0x22a)],{'credentials':_0x3d4dde});expect(_0xa82f59)['to'][_0x122966(0x2fd)]();const _0x30405e=function(_0x426cf6){const _0x5ba6b5=_0x122966;return{'key':_0x5cd2a1[_0x5ba6b5(0x1d0)]};};await _0xd5c3ff[_0x122966(0x281)](expect,Hawk[_0x122966(0x17f)][_0x122966(0x243)](_0x122966(0x2c7),0x1f90,_0x122966(0x2c9),_0xa82f59,_0x30405e))['to'][_0x122966(0x2a1)](_0x122966(0x28e));}),it('should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20algorithm',async()=>{const _0x1c9acd=_0xe8c002,_0x3284a1={'duNAy':_0x5cd2a1[_0x1c9acd(0x2ca)]},_0x3e8a33=_0x5cd2a1[_0x1c9acd(0x1b5)](_0x562c6f,_0x1c9acd(0x2f9)),_0x476fd6=Hawk[_0x1c9acd(0x1f1)]['message'](_0x1c9acd(0x2c7),0x1f90,_0x1c9acd(0x2c9),{'credentials':_0x3e8a33});expect(_0x476fd6)['to']['exist']();const _0x1de22c=function(_0x55593b){const _0x563981=_0x1c9acd;return{'key':_0x563981(0x234),'algorithm':_0x3284a1[_0x563981(0x2d5)]};};await _0x5cd2a1[_0x1c9acd(0x1ac)](expect,Hawk[_0x1c9acd(0x17f)][_0x1c9acd(0x243)]('example.com',0x1f90,_0x1c9acd(0x2c9),_0x476fd6,_0x1de22c))['to'][_0x1c9acd(0x2a1)](_0x5cd2a1[_0x1c9acd(0x24c)]);}),it(_0xd5c3ff[_0xe8c002(0x209)],()=>{const _0x57a303=_0xe8c002;if(_0x5cd2a1[_0x57a303(0x275)](_0x57a303(0x300),_0x57a303(0x300)))throw new _0x1972d5();else{const _0x347dfc=_0x562c6f(_0x5cd2a1[_0x57a303(0x1ec)]);_0x5cd2a1[_0x57a303(0x20a)](expect,()=>Hawk['client']['message'](null,0x1f90,_0x57a303(0x2c9),{'credentials':_0x347dfc}))['to'][_0x57a303(0x19f)](_0x5cd2a1[_0x57a303(0x256)]);}}),_0xd5c3ff['JPauL'](it,_0xd5c3ff[_0xe8c002(0x2b1)],()=>{const _0x276b72=_0xe8c002;expect(()=>Hawk[_0x276b72(0x1f1)][_0x276b72(0x29e)]('example.com',0x1f90,_0x276b72(0x2c9)))['to'][_0x276b72(0x19f)]('Invalid\x20credentials');}),_0xd5c3ff[_0xe8c002(0x1d6)](it,_0xd5c3ff[_0xe8c002(0x22b)],()=>{const _0x5c263d=_0xe8c002;if(_0x5cd2a1[_0x5c263d(0x199)]===_0x5cd2a1[_0x5c263d(0x1dc)])_0x20f3ed(()=>_0x42eb31[_0x5c263d(0x1f1)][_0x5c263d(0x29e)](_0x5c263d(0x2c7),0x1f90,_0x5c263d(0x2c9)))['to'][_0x5c263d(0x19f)](_0x5c263d(0x28e));else{const _0x1c9742=_0x5cd2a1['gqWqK'](_0x562c6f,_0x5c263d(0x2f9)),_0x5b8629=Hoek[_0x5c263d(0x1f8)](_0x1c9742);_0x5b8629[_0x5c263d(0x226)]=_0x5c263d(0x287),_0x5cd2a1[_0x5c263d(0x20a)](expect,()=>Hawk[_0x5c263d(0x1f1)]['message'](_0x5c263d(0x2c7),0x1f90,_0x5c263d(0x2c9),{'credentials':_0x5b8629}))['to'][_0x5c263d(0x19f)](_0x5cd2a1['XSSWj']);}});}),describe(_0x2fb131(0x238),()=>{const _0x19987c=_0x2fb131,_0x16a076={'fSvIq':function(_0x3b26e7,_0x176d94){return _0x3b26e7(_0x176d94);}};_0xd5c3ff[_0x19987c(0x232)](it,_0x19987c(0x23f),()=>{const _0x225b0d=_0x19987c;expect(()=>Hawk[_0x225b0d(0x17f)][_0x225b0d(0x2b3)](_0x225b0d(0x280),{'hash':_0x225b0d(0x280)}))['to'][_0x225b0d(0x223)][_0x225b0d(0x19f)](),_0x16a076[_0x225b0d(0x164)](expect,()=>Hawk[_0x225b0d(0x17f)][_0x225b0d(0x2b3)](_0x225b0d(0x23b),{'hash':'abcdefg'}))['to'][_0x225b0d(0x19f)]('Bad\x20payload\x20hash');});});});