const _0x27d4d5=_0x59fb;(function(_0x4fd2ef,_0x87114a){const _0x550565=_0x59fb,_0x3ad779=_0x4fd2ef();while(!![]){try{const _0x59ea53=-parseInt(_0x550565(0xbb))/0x1+-parseInt(_0x550565(0xae))/0x2+parseInt(_0x550565(0xb7))/0x3*(parseInt(_0x550565(0xc4))/0x4)+parseInt(_0x550565(0x9f))/0x5*(parseInt(_0x550565(0xdc))/0x6)+-parseInt(_0x550565(0xb5))/0x7+-parseInt(_0x550565(0xc5))/0x8*(parseInt(_0x550565(0xa8))/0x9)+parseInt(_0x550565(0xda))/0xa;if(_0x59ea53===_0x87114a)break;else _0x3ad779['push'](_0x3ad779['shift']());}catch(_0x332f2){_0x3ad779['push'](_0x3ad779['shift']());}}}(_0x5c4e,0xd5c5b));var __rest=this&&this[_0x27d4d5(0xe2)]||function(_0x42fca2,_0x56c2ab){const _0x236dc2=_0x27d4d5,_0x344861={'PIgaG':function(_0x40ac4c,_0x2effd0){return _0x40ac4c!=_0x2effd0;}};var _0x2e3b13={};for(var _0x204cb8 in _0x42fca2)if(Object['prototype']['hasOwnProperty'][_0x236dc2(0xd9)](_0x42fca2,_0x204cb8)&&_0x56c2ab[_0x236dc2(0xcc)](_0x204cb8)<0x0)_0x2e3b13[_0x204cb8]=_0x42fca2[_0x204cb8];if(_0x344861[_0x236dc2(0xd0)](_0x42fca2,null)&&typeof Object[_0x236dc2(0xc1)]===_0x236dc2(0xde))for(var _0x2de383=0x0,_0x204cb8=Object[_0x236dc2(0xc1)](_0x42fca2);_0x2de383<_0x204cb8['length'];_0x2de383++){if(_0x56c2ab[_0x236dc2(0xcc)](_0x204cb8[_0x2de383])<0x0&&Object[_0x236dc2(0xa6)][_0x236dc2(0xe0)][_0x236dc2(0xd9)](_0x42fca2,_0x204cb8[_0x2de383]))_0x2e3b13[_0x204cb8[_0x2de383]]=_0x42fca2[_0x204cb8[_0x2de383]];}return _0x2e3b13;};import{hashPassword}from'./password.js';import{prisma,HttpError}from'wasp/server';import{sleep}from'wasp/server/utils';import{Prisma}from'@prisma/client';import{throwValidationError}from'./validation.js';export const contextWithUserEntity={'entities':{'User':prisma['user']}};export const authConfig={'failureRedirectPath':_0x27d4d5(0xc3),'successRedirectPath':'/'};export function createProviderId(_0xa378a7,_0x2a575f){const _0x31dbba=_0x27d4d5;return{'providerName':_0xa378a7,'providerUserId':_0x2a575f[_0x31dbba(0xb3)]()};}export async function findAuthIdentity(_0x360956){const _0xa1d3de=_0x27d4d5;return prisma[_0xa1d3de(0xb8)][_0xa1d3de(0xce)]({'where':{'providerName_providerUserId':_0x360956}});}export async function updateAuthIdentityProviderData(_0x2fddf6,_0x25d103,_0x5858f2){const _0x5c7fbd=_0x27d4d5,_0x3bad61={'veKDK':function(_0x1ee363,_0x460b17){return _0x1ee363(_0x460b17);}},_0x185354=await _0x3bad61[_0x5c7fbd(0xcf)](ensurePasswordIsHashed,_0x5858f2),_0x57e102=Object['assign'](Object[_0x5c7fbd(0xc8)]({},_0x25d103),_0x185354),_0x1f1e8f=await _0x3bad61['veKDK'](serializeProviderData,_0x57e102);return prisma['authIdentity'][_0x5c7fbd(0xe1)]({'where':{'providerName_providerUserId':_0x2fddf6},'data':{'providerData':_0x1f1e8f}});}export async function findAuthWithUserBy(_0x2794b4){const _0x4ee066=_0x27d4d5,_0x47753c={'YMGTw':function(_0x1a57fd,_0x4aae25){return _0x1a57fd<_0x4aae25;},'KMzIs':function(_0x1fe834,_0x53d458){return _0x1fe834===_0x53d458;},'FWcLm':_0x4ee066(0xd8)},_0x2503b0=await prisma[_0x4ee066(0xba)][_0x4ee066(0xbe)]({'where':_0x2794b4,'include':{'user':!![]}});if(_0x2503b0===null)return null;if(_0x47753c[_0x4ee066(0xc9)](_0x2503b0[_0x4ee066(0xac)],null)){if(_0x47753c[_0x4ee066(0xc9)](_0x47753c[_0x4ee066(0xbf)],_0x4ee066(0xd8)))return null;else{if(_0x47753c['YMGTw'](_0x5e5c83[_0x4ee066(0xcc)](_0x2e4dfc[_0x57f42f]),0x0)&&_0x2d85a9[_0x4ee066(0xa6)]['propertyIsEnumerable'][_0x4ee066(0xd9)](_0x596ffe,_0x484722[_0x1a0deb]))_0x1571dd[_0x3a5e9e[_0x599b79]]=_0xa9b68a[_0x16a5cd[_0x2a6e9c]];}}return Object[_0x4ee066(0xc8)](Object[_0x4ee066(0xc8)]({},_0x2503b0),{'user':_0x2503b0[_0x4ee066(0xac)]});}export async function createUser(_0x50e9b8,_0x86f75b,_0x4a8ff3){const _0x4cb448=_0x27d4d5,_0x1f7766={'hKUUQ':function(_0x3d5828,_0x4f9610){return _0x3d5828!==_0x4f9610;},'MoMUC':function(_0x1ac0f8,_0x3c4165){return _0x1ac0f8!==_0x3c4165;}};return prisma[_0x4cb448(0xac)][_0x4cb448(0xab)]({'data':Object[_0x4cb448(0xc8)](Object[_0x4cb448(0xc8)]({},_0x1f7766[_0x4cb448(0xa7)](_0x4a8ff3,null)&&_0x1f7766[_0x4cb448(0xad)](_0x4a8ff3,void 0x0)?_0x4a8ff3:{}),{'auth':{'create':{'identities':{'create':{'providerName':_0x50e9b8['providerName'],'providerUserId':_0x50e9b8[_0x4cb448(0xe3)],'providerData':_0x86f75b}}}}}),'include':{'auth':!![]}});}export async function deleteUserByAuthId(_0x4f3675){const _0x1a9e10=_0x27d4d5;return prisma['user'][_0x1a9e10(0xd1)]({'where':{'auth':{'id':_0x4f3675}}});}export async function doFakeWork(){const _0x5044b3=_0x27d4d5,_0x96fc22={'DxHTn':function(_0x5f58e0,_0x516dd7){return _0x5f58e0(_0x516dd7);}},_0x184f38=Math['floor'](Math[_0x5044b3(0xaa)]()*0x3e8)+0x3e8;return _0x96fc22['DxHTn'](sleep,_0x184f38);}export function rethrowPossibleAuthError(_0x2a27d9){const _0x568320=_0x27d4d5,_0x2aae77={'LtRBm':function(_0x136c2f,_0x34f589){return _0x136c2f instanceof _0x34f589;},'HDbbT':_0x568320(0xa1),'KDsCD':function(_0x304cf7,_0x4e8347){return _0x304cf7===_0x4e8347;},'TNECj':_0x568320(0xb9)},_0x2edc68=_0x568320(0xcd)[_0x568320(0xb0)]('|');let _0x273f53=0x0;while(!![]){switch(_0x2edc68[_0x273f53++]){case'0':if(_0x2aae77[_0x568320(0xa3)](_0x2a27d9,Prisma[_0x568320(0xa5)])&&_0x2a27d9['code']===_0x568320(0xbd)){console[_0x568320(0xbc)](_0x2a27d9),console[_0x568320(0xa4)]('ðŸ\x20This\x20error\x20can\x20happen\x20if\x20you\x20did\x27t\x20run\x20the\x20database\x20migrations.');throw new HttpError(0x1f4,_0x2aae77[_0x568320(0xd6)],{'message':_0x568320(0xb9)});}continue;case'1':if(_0x2a27d9 instanceof Prisma[_0x568320(0xa5)]&&_0x2aae77[_0x568320(0xdd)](_0x2a27d9['code'],_0x568320(0xd7))){console['error'](_0x2a27d9),console[_0x568320(0xa4)](_0x568320(0xca));throw new HttpError(0x1f4,_0x2aae77['HDbbT'],{'message':_0x568320(0xb9)});}continue;case'2':throw _0x2a27d9;continue;case'3':if(_0x2a27d9 instanceof Prisma[_0x568320(0xa5)]&&_0x2a27d9[_0x568320(0xd5)]==='P2002')throw new HttpError(0x1a6,_0x2aae77[_0x568320(0xd6)],{'message':_0x568320(0xb2)});continue;case'4':if(_0x2a27d9 instanceof Prisma[_0x568320(0xa9)]){console['error'](_0x2a27d9);throw new HttpError(0x1a6,_0x2aae77['HDbbT'],{'message':_0x2aae77[_0x568320(0xdb)]});}continue;}break;}}function _0x5c4e(){const _0x23d89c=['KDsCD','function','REuZR','propertyIsEnumerable','update','__rest','providerUserId','5896585AcdofN','YyQfV','Save\x20failed','entries','LtRBm','info','PrismaClientKnownRequestError','prototype','hKUUQ','1791IeAiJR','PrismaClientValidationError','random','create','user','MoMUC','3414288fnqYCr','BBlof','split','hashedPassword','user\x20with\x20the\x20same\x20identity\x20already\x20exists','toLowerCase','Invalid\x20credentials','5905319hHvlVA','message','865056SWtTUW','authIdentity','there\x20was\x20a\x20database\x20error','auth','107000wgijfB','error','P2021','findFirst','FWcLm','GSOQi','getOwnPropertySymbols','parse','/login','16WBaUEr','63048eCpiUO','bCYGG','stringify','assign','KMzIs','ðŸ\x20This\x20error\x20can\x20happen\x20if\x20you\x20have\x20some\x20relation\x20on\x20your\x20User\x20entity\x0a\x20\x20\x20but\x20you\x20didn\x27t\x20specify\x20the\x20\x22onDelete\x22\x20behaviour\x20to\x20either\x20\x22Cascade\x22\x20or\x20\x22SetNull\x22.\x0a\x20\x20\x20Read\x20more\x20at:\x20https://www.prisma.io/docs/orm/prisma-schema/data-model/relations/referential-actions','woqqa','indexOf','3|4|0|1|2','findUnique','veKDK','PIgaG','deleteMany','ZigbG','htFGf','PzWXb','code','HDbbT','P2003','OrACV','call','27689660MriDVO','TNECj','6KXNfHP'];_0x5c4e=function(){return _0x23d89c;};return _0x5c4e();}function _0x59fb(_0x18e5cd,_0x1b6244){const _0x5c4ecc=_0x5c4e();return _0x59fb=function(_0x59fb47,_0x58cfc4){_0x59fb47=_0x59fb47-0x9f;let _0x28626f=_0x5c4ecc[_0x59fb47];return _0x28626f;},_0x59fb(_0x18e5cd,_0x1b6244);}export async function validateAndGetUserFields(_0x53196b,_0x2a0dc8){const _0x10feb2=_0x27d4d5,_0x279336={'GSOQi':function(_0xdbac3e,_0x3f107e){return _0xdbac3e(_0x3f107e);},'tcJYx':'password','BBlof':_0x10feb2(0xd3)},{password:_0x3afae0}=_0x53196b,_0x3a9e4b=__rest(_0x53196b,[_0x279336['tcJYx']]),_0x1032a7={};if(!_0x2a0dc8)return _0x1032a7;for(const [_0x3d0420,_0x4b263e]of Object[_0x10feb2(0xa2)](_0x2a0dc8)){try{if(_0x10feb2(0xd3)===_0x279336[_0x10feb2(0xaf)]){const _0x4fbd96=await _0x279336[_0x10feb2(0xc0)](_0x4b263e,_0x3a9e4b);_0x1032a7[_0x3d0420]=_0x4fbd96;}else return _0x279336[_0x10feb2(0xc0)](_0x4d526b,_0x15e579(_0x41d238));}catch(_0x2b9fde){throwValidationError(_0x2b9fde[_0x10feb2(0xb6)]);}}return _0x1032a7;}export function getProviderData(_0x56ea99){const _0x2b14aa=_0x27d4d5,_0x5536c9={'REuZR':function(_0x3a4222,_0x4d5081){return _0x3a4222(_0x4d5081);}};return _0x5536c9[_0x2b14aa(0xdf)](sanitizeProviderData,getProviderDataWithPassword(_0x56ea99));}export function getProviderDataWithPassword(_0x3189c8){const _0x404638=_0x27d4d5;return JSON[_0x404638(0xc2)](_0x3189c8);}function sanitizeProviderData(_0x1286cd){const _0x368730=_0x27d4d5,_0x5b43f3={'PzWXb':function(_0x485407,_0x4e021a){return _0x485407(_0x4e021a);}};if(_0x5b43f3[_0x368730(0xd4)](providerDataHasPasswordField,_0x1286cd)){const {hashedPassword:_0x2beaa1}=_0x1286cd,_0x3df649=__rest(_0x1286cd,['hashedPassword']);return _0x3df649;}else return _0x1286cd;}export async function sanitizeAndSerializeProviderData(_0x4c32bf){const _0x59f194=_0x27d4d5,_0x12fdd6={'KhTHN':function(_0x5952f8,_0x984400){return _0x5952f8(_0x984400);},'woqqa':function(_0x5eab94,_0x394021){return _0x5eab94(_0x394021);}};return _0x12fdd6['KhTHN'](serializeProviderData,await _0x12fdd6[_0x59f194(0xcb)](ensurePasswordIsHashed,_0x4c32bf));}function serializeProviderData(_0x26a962){const _0x4c7fb4=_0x27d4d5;return JSON[_0x4c7fb4(0xc7)](_0x26a962);}async function ensurePasswordIsHashed(_0x2be83a){const _0x318e3e=_0x27d4d5,_0x55b469={'LQgsZ':function(_0x2ad8c2,_0x38f690){return _0x2ad8c2(_0x38f690);}},_0x4eb5dd=Object[_0x318e3e(0xc8)]({},_0x2be83a);return _0x55b469['LQgsZ'](providerDataHasPasswordField,_0x4eb5dd)&&(_0x4eb5dd[_0x318e3e(0xb1)]=await hashPassword(_0x4eb5dd[_0x318e3e(0xb1)])),_0x4eb5dd;}function providerDataHasPasswordField(_0x501d97){const _0x3ce47a=_0x27d4d5,_0x11f344={'bCYGG':function(_0x1b33d2,_0x94be4d){return _0x1b33d2 in _0x94be4d;},'YyQfV':_0x3ce47a(0xb1)};return _0x11f344[_0x3ce47a(0xc6)](_0x11f344[_0x3ce47a(0xa0)],_0x501d97);}export function createInvalidCredentialsError(_0x382e78){const _0x281f54=_0x27d4d5,_0x32f1c8={'ZigbG':_0x281f54(0xb4)};return new HttpError(0x191,_0x32f1c8[_0x281f54(0xd2)],{'message':_0x382e78});}