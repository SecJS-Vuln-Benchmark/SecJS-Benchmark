var _0x3d63f7=_0x3a38;function _0x3a38(_0x39c95e,_0x55ce92){var _0xd08d81=_0xd08d();return _0x3a38=function(_0x3a38a8,_0x977a53){_0x3a38a8=_0x3a38a8-0x99;var _0x1bde16=_0xd08d81[_0x3a38a8];return _0x1bde16;},_0x3a38(_0x39c95e,_0x55ce92);}function _0xd08d(){var _0x395677=['PSlSk','YgWpd','746972KSCAWJ','FvQNe','VJjDZ','3IrRLSe','3285996QNTlBp','getUTCHours','setup','end','Dec','vaGPq','TAObE','Upoky','488637RpLNBq','write','3|2|1|4|0','tap','valid\x20rsa','Signature\x20keyId=\x22foo\x22,algorithm=\x22hmac-sha1\x22\x20','Fri','sign','headers','/rsa_public.pem','Oct','Pczcu','verify','wSNpO','PqJIC','Jan','writeHead','sNLwm','Sat','update','Sun','GzSNE','Nzmuy','Nov','aTKAt','statusCode','Authorization','OXpis','/tmp/.','4|3|2|1|5|0','var\x20x\x20=\x2042;\x20return\x20x;','close','getUTCDate','UHkMW','Thu','Jul','createSign','sha1','BAykh','getUTCDay','getUTCFullYear','102520rqXUlB','YMzBw','get','parseRequest','4oPhTbN','/rsa_private.pem','equal','ppHYp','MfhSq','UOiHZ','Sep','May','base64','crypto','digest','../lib/index','121jDUmDN','554809JvQCDp','http','ymZHe','stringify','RSA-SHA256','Tue','Feb','10163592NPYBDa','aUtlc','sXhaY','split','8TZaeSt','Mar','tester','ascii','0|2|3|4|1','1016076aZonHf','fdYoN','OFaiK','pgOyQ','wNWxj','\x20GMT','HadjC','Jun','Date','15olRgsa','Apr','AWWoa','plXmQ','Wed','uEXyP','vuQUa','createServer'];_0xd08d=function(){return _0x395677;};return _0xd08d();}(function(_0x3185fd,_0x190f9b){var _0xec6fee=_0x3a38,_0x1320e7=_0x3185fd();while(!![]){try{var _0x2236f3=-parseInt(_0xec6fee(0xa3))/0x1*(parseInt(_0xec6fee(0xff))/0x2)+-parseInt(_0xec6fee(0xc9))/0x3*(parseInt(_0xec6fee(0xc6))/0x4)+-parseInt(_0xec6fee(0xbc))/0x5*(-parseInt(_0xec6fee(0xb3))/0x6)+parseInt(_0xec6fee(0xca))/0x7+-parseInt(_0xec6fee(0xae))/0x8*(parseInt(_0xec6fee(0xd2))/0x9)+parseInt(_0xec6fee(0xfb))/0xa*(parseInt(_0xec6fee(0xa2))/0xb)+parseInt(_0xec6fee(0xaa))/0xc;if(_0x2236f3===_0x190f9b)break;else _0x1320e7['push'](_0x1320e7['shift']());}catch(_0x2c3076){_0x1320e7['push'](_0x1320e7['shift']());}}}(_0xd08d,0x8f336));var crypto=require(_0x3d63f7(0x9f)),fs=require('fs'),http=require(_0x3d63f7(0xa4)),test=require(_0x3d63f7(0xd5))['test'],uuid=require('node-uuid'),httpSignature=require(_0x3d63f7(0xa1)),hmacKey=null,options=null,rsaPrivate=null,rsaPublic=null,server=null,socket=null;function _pad(_0x137b0c){var _0x374c21=_0x3d63f7,_0xbeed13={'plXmQ':function(_0xca789b,_0x54c9d8){return _0xca789b<_0x54c9d8;}};return _0xbeed13[_0x374c21(0xbf)](parseInt(_0x137b0c,0xa),0xa)&&(_0x137b0c='0'+_0x137b0c),eval('var _0x20ecba = _0x374c21;JSON[_0x20ecba(166)]({ \'safe\': !![] });'),_0x137b0c;}function _rfc1123(_0x5d1100){var _0x114bd6=_0x3d63f7,_0x5ef538={'VJjDZ':'1|2|3|4|0','aUtlc':function(_0x26fc27,_0xadbf85){return _0x26fc27+_0xadbf85;},'ppHYp':function(_0x447d1f,_0x53cf65){return _0x447d1f+_0x53cf65;},'YgWpd':function(_0x3a2c1a,_0x1a014f){return _0x3a2c1a+_0x1a014f;},'wNWxj':function(_0x11390d,_0x514036){return _0x11390d(_0x514036);},'GbEZV':function(_0x4e23e6,_0x49a2b6){return _0x4e23e6(_0x49a2b6);},'djTUt':function(_0x5096fb,_0x43b187){return _0x5096fb(_0x43b187);},'UHkMW':_0x114bd6(0xb8),'OXpis':_0x114bd6(0xaf),'BAykh':_0x114bd6(0xbd),'fdYoN':_0x114bd6(0x9d),'sNLwm':'Aug','wtPYD':_0x114bd6(0x9c),'Pczcu':_0x114bd6(0xdc),'AWWoa':_0x114bd6(0xe6),'PqJIC':'Mon','LJlSv':_0x114bd6(0xa8),'TAObE':_0x114bd6(0xc0),'ApUMw':_0x114bd6(0xd8),'aTKAt':_0x114bd6(0xf0)},_0x49ab83=_0x5ef538[_0x114bd6(0xc8)]['split']('|'),_0x5b576a=0x0;while(!![]){switch(_0x49ab83[_0x5b576a++]){case'0':return _0x5ef538[_0x114bd6(0xab)](_0x5ef538[_0x114bd6(0x99)](_0x5ef538['ppHYp'](_0x5ef538[_0x114bd6(0xc5)](_0x3d26f2[_0x5d1100[_0x114bd6(0xf9)]()]+',\x20'+_0x5ef538[_0x114bd6(0xb7)](_pad,_0x5d1100[_0x114bd6(0xf2)]()),'\x20'),_0x292c6e[_0x5d1100['getUTCMonth']()])+'\x20'+_0x5d1100[_0x114bd6(0xfa)]()+'\x20',_0x5ef538['GbEZV'](_pad,_0x5d1100[_0x114bd6(0xcb)]()))+':',_0x5ef538['djTUt'](_pad,_0x5d1100['getUTCMinutes']()))+':'+_pad(_0x5d1100['getUTCSeconds']())+_0x5ef538[_0x114bd6(0xf3)];case'1':if(!_0x5d1100)_0x5d1100=new Date();continue;case'2':var _0x292c6e=[_0x114bd6(0xe1),_0x114bd6(0xa9),_0x5ef538[_0x114bd6(0xed)],_0x5ef538[_0x114bd6(0xf8)],_0x5ef538[_0x114bd6(0xb4)],_0x114bd6(0xba),_0x114bd6(0xf5),_0x5ef538[_0x114bd6(0xe3)],_0x5ef538['wtPYD'],_0x5ef538[_0x114bd6(0xdd)],_0x114bd6(0xe9),_0x114bd6(0xce)];continue;case'3':var _0x3d26f2=[_0x5ef538[_0x114bd6(0xbe)],_0x5ef538[_0x114bd6(0xe0)],_0x5ef538['LJlSv'],_0x5ef538[_0x114bd6(0xd0)],_0x114bd6(0xf4),_0x5ef538['ApUMw'],_0x114bd6(0xe4)];continue;case'4':new Function(_0x5ef538[_0x114bd6(0xea)])();continue;}break;}}test(_0x3d63f7(0xcc),function(_0x55df6a){var _0xb55b16=_0x3d63f7,_0x34a660={'sXhaY':_0xb55b16(0x100),'gzAfL':function(_0x372df4,_0x830ae5){return _0x372df4+_0x830ae5;},'UOiHZ':_0xb55b16(0xee),'ymZHe':function(_0x8a65f9){return _0x8a65f9();}};rsaPrivate=fs['readFileSync'](__dirname+_0x34a660[_0xb55b16(0xac)],_0xb55b16(0xb1)),rsaPublic=fs['readFileSync'](_0x34a660['gzAfL'](__dirname,_0xb55b16(0xdb)),_0xb55b16(0xb1)),_0x55df6a['ok'](rsaPrivate),_0x55df6a['ok'](rsaPublic),hmacKey=uuid(),socket=_0x34a660[_0xb55b16(0x9b)]+_0x34a660[_0xb55b16(0xa5)](uuid),options={'socketPath':socket,'path':'/','headers':{}},server=http[_0xb55b16(0xc3)](function(_0x28e8cb,_0x503e3d){var _0x17dd84=_0xb55b16;server[_0x17dd84(0xb0)](_0x28e8cb,_0x503e3d);}),server['listen'](socket,function(){var _0xb38329=_0xb55b16;_0x55df6a[_0xb38329(0xcd)]();});}),test('invalid\x20hmac',function(_0x249185){var _0x176523=_0x3d63f7,_0x18f57f={'OFaiK':function(_0x325b30){return _0x325b30();},'GzSNE':function(_0x463207,_0x2c46e){return _0x463207+_0x2c46e;},'VdpHg':'Signature\x20keyId=\x22foo\x22,algorithm=\x22hmac-sha1\x22\x20'};server['tester']=function(_0x4a0c4e,_0xaa1e91){var _0x477820=_0x3a38,_0x3ab409=_0x477820(0xd4)['split']('|'),_0x2af789=0x0;while(!![]){switch(_0x3ab409[_0x2af789++]){case'0':_0xaa1e91['end']();continue;case'1':_0xaa1e91['writeHead'](0xc8);continue;case'2':_0x249185['ok'](!httpSignature[_0x477820(0xde)](_0x16f9a4,hmacKey));continue;case'3':var _0x16f9a4=httpSignature[_0x477820(0xfe)](_0x4a0c4e);continue;case'4':_0xaa1e91[_0x477820(0xd3)](JSON[_0x477820(0xa6)](_0x16f9a4,null,0x2));continue;}break;}},options[_0x176523(0xda)]['Date']=_0x18f57f[_0x176523(0xb5)](_rfc1123),options[_0x176523(0xda)][_0x176523(0xec)]=_0x18f57f[_0x176523(0xe7)](_0x18f57f['VdpHg'],uuid()),http[_0x176523(0xfd)](options,function(_0x2c8933){var _0x55ec34=_0x176523;_0x249185['equal'](_0x2c8933[_0x55ec34(0xeb)],0xc8),_0x249185['end']();});}),test('valid\x20hmac',function(_0x2dddc7){var _0x204614=_0x3d63f7,_0x2abf32={'UkFzV':function(_0x3e7190,_0x29e677){return _0x3e7190!==_0x29e677;},'vaGPq':'RYHbP','wSNpO':_0x204614(0xc1),'WQPpp':function(_0x283e48){return _0x283e48();},'HadjC':_0x204614(0xf7),'vuQUa':_0x204614(0xd7)};server[_0x204614(0xb0)]=function(_0x1727b3,_0x361010){var _0x5da5f6=_0x204614,_0x1a1ec3=httpSignature[_0x5da5f6(0xfe)](_0x1727b3);_0x2dddc7['ok'](httpSignature[_0x5da5f6(0xde)](_0x1a1ec3,hmacKey)),_0x361010['writeHead'](0xc8),_0x361010[_0x5da5f6(0xd3)](JSON[_0x5da5f6(0xa6)](_0x1a1ec3,null,0x2)),_0x361010[_0x5da5f6(0xcd)]();},options[_0x204614(0xda)][_0x204614(0xbb)]=_0x2abf32['WQPpp'](_rfc1123);var _0x36e1d2=crypto['createHmac'](_0x2abf32[_0x204614(0xb9)],hmacKey);_0x36e1d2[_0x204614(0xe5)](options[_0x204614(0xda)][_0x204614(0xbb)]),options[_0x204614(0xda)][_0x204614(0xec)]=_0x2abf32[_0x204614(0xc2)]+_0x36e1d2[_0x204614(0xa0)](_0x204614(0x9e)),http[_0x204614(0xfd)](options,function(_0xe829d5){var _0x2e0f1b=_0x204614;if(_0x2abf32['UkFzV'](_0x2abf32[_0x2e0f1b(0xcf)],_0x2abf32[_0x2e0f1b(0xdf)]))_0x2dddc7[_0x2e0f1b(0x101)](_0xe829d5[_0x2e0f1b(0xeb)],0xc8),_0x2dddc7[_0x2e0f1b(0xcd)]();else{var _0x53b48b=_0x2084f8[_0x2e0f1b(0xfe)](_0x3956af);_0x191b54['ok'](!_0x50698c[_0x2e0f1b(0xde)](_0x53b48b,_0x14012d)),_0x5c713e[_0x2e0f1b(0xe2)](0xc8),_0x50ddf9['write'](_0x24b023['stringify'](_0x53b48b,null,0x2)),_0x11ba1b[_0x2e0f1b(0xcd)]();}});}),test('invalid\x20rsa',function(_0x3cd071){var _0x534c42=_0x3d63f7,_0xe9f777={'Nzmuy':_0x534c42(0xb2),'Upoky':function(_0x1dc0f3){return _0x1dc0f3();},'pgOyQ':function(_0x11e1bf,_0x272e8f){return _0x11e1bf+_0x272e8f;},'lzuql':'Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha1\x22\x20','MfhSq':function(_0x370cd5){return _0x370cd5();}};server[_0x534c42(0xb0)]=function(_0x5b2fb2,_0x1df000){var _0x26ccd5=_0x534c42,_0x54bed9=_0xe9f777[_0x26ccd5(0xe8)][_0x26ccd5(0xad)]('|'),_0x142cd2=0x0;while(!![]){switch(_0x54bed9[_0x142cd2++]){case'0':var _0x353485=httpSignature[_0x26ccd5(0xfe)](_0x5b2fb2);continue;case'1':_0x1df000['end']();continue;case'2':_0x3cd071['ok'](!httpSignature[_0x26ccd5(0xde)](_0x353485,rsaPublic));continue;case'3':_0x1df000[_0x26ccd5(0xe2)](0xc8);continue;case'4':_0x1df000[_0x26ccd5(0xd3)](JSON[_0x26ccd5(0xa6)](_0x353485,null,0x2));continue;}break;}},options['headers'][_0x534c42(0xbb)]=_0xe9f777[_0x534c42(0xd1)](_rfc1123),options['headers'][_0x534c42(0xec)]=_0xe9f777[_0x534c42(0xb6)](_0xe9f777['lzuql'],_0xe9f777[_0x534c42(0x9a)](uuid)),http[_0x534c42(0xfd)](options,function(_0x23d9c0){var _0x2cca5c=_0x534c42;_0x3cd071[_0x2cca5c(0x101)](_0x23d9c0[_0x2cca5c(0xeb)],0xc8),_0x3cd071['end']();});}),test(_0x3d63f7(0xd6),function(_0x20b238){var _0x9a73bb=_0x3d63f7,_0x3b1f96={'FvQNe':'Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22\x20'},_0x2f7180=_0x9a73bb(0xef)[_0x9a73bb(0xad)]('|'),_0x572b94=0x0;while(!![]){switch(_0x2f7180[_0x572b94++]){case'0':http[_0x9a73bb(0xfd)](options,function(_0x583860){var _0xa8c951=_0x9a73bb;_0x20b238[_0xa8c951(0x101)](_0x583860['statusCode'],0xc8),_0x20b238[_0xa8c951(0xcd)]();});continue;case'1':_0x2e5fe9[_0x9a73bb(0xe5)](options['headers']['Date']);continue;case'2':var _0x2e5fe9=crypto[_0x9a73bb(0xf6)](_0x9a73bb(0xa7));continue;case'3':options[_0x9a73bb(0xda)][_0x9a73bb(0xbb)]=_rfc1123();continue;case'4':server[_0x9a73bb(0xb0)]=function(_0x1bb25c,_0x1bebbc){var _0x47dd24=_0x9a73bb,_0x46d64d=httpSignature[_0x47dd24(0xfe)](_0x1bb25c);_0x20b238['ok'](httpSignature['verify'](_0x46d64d,rsaPublic)),_0x1bebbc['writeHead'](0xc8),_0x1bebbc['write'](JSON[_0x47dd24(0xa6)](_0x46d64d,null,0x2)),_0x1bebbc[_0x47dd24(0xcd)]();};continue;case'5':options[_0x9a73bb(0xda)][_0x9a73bb(0xec)]=_0x3b1f96[_0x9a73bb(0xc7)]+_0x2e5fe9[_0x9a73bb(0xd9)](rsaPrivate,'base64');continue;}break;}}),test('tear\x20down',function(_0x25ce01){var _0x3bf1c4=_0x3d63f7,_0x4538c5={'PSlSk':_0x3bf1c4(0xfc)};server['on']('close',function(){var _0x903969=_0x3bf1c4;_0x903969(0xfc)===_0x4538c5[_0x903969(0xc4)]?_0x25ce01[_0x903969(0xcd)]():_0x324944[_0x903969(0xb0)](_0x15c30b,_0x5c93a7);}),server[_0x3bf1c4(0xf1)]();});