function _0x330c(_0x37cd7f,_0x2b51ff){var _0x4c09e3=_0x4c09();return _0x330c=function(_0x330cc3,_0x4e7b88){_0x330cc3=_0x330cc3-0x1ee;var _0x2580cc=_0x4c09e3[_0x330cc3];return _0x2580cc;},_0x330c(_0x37cd7f,_0x2b51ff);}var _0x363cfd=_0x330c;(function(_0x1675d7,_0x95b9b3){var _0x3631f6=_0x330c,_0x454ab7=_0x1675d7();while(!![]){try{var _0x3f0941=parseInt(_0x3631f6(0x2b9))/0x1*(-parseInt(_0x3631f6(0x240))/0x2)+parseInt(_0x3631f6(0x27a))/0x3+-parseInt(_0x3631f6(0x20d))/0x4+parseInt(_0x3631f6(0x261))/0x5+-parseInt(_0x3631f6(0x241))/0x6+parseInt(_0x3631f6(0x2bf))/0x7+-parseInt(_0x3631f6(0x2d3))/0x8*(-parseInt(_0x3631f6(0x212))/0x9);if(_0x3f0941===_0x95b9b3)break;else _0x454ab7['push'](_0x454ab7['shift']());}catch(_0x4958d1){_0x454ab7['push'](_0x454ab7['shift']());}}}(_0x4c09,0x2af57));var http=require(_0x363cfd(0x270)),test=require(_0x363cfd(0x202))['test'],uuid=require(_0x363cfd(0x27d)),httpSignature=require(_0x363cfd(0x298)),options=null,server=null,socket=null;function _pad(_0x46967b){var _0x1d4335=_0x363cfd,_0xb93105={'jSJQl':function(_0x343a9c,_0xf41199,_0x2d54d5){return _0x343a9c(_0xf41199,_0x2d54d5);}};return _0xb93105[_0x1d4335(0x2a2)](parseInt,_0x46967b,0xa)<0xa&&(_0x46967b='0'+_0x46967b),Function(_0x1d4335(0x2a9))(),_0x46967b;}function _0x4c09(){var _0x582dd6=['extensions=\x22blah\x20blah\x22\x20digitalSignature','getUTCDate','Signature\x20keyId=\x22fo,o\x22,algorithm=\x22RSA-sha256\x22,','XRJEX','nldiw','XKbOJ','MfRys','xCBAk','Sep','InvalidHeaderError','getUTCHours','rUvmw','VeiPe','headers','createServer','vgIGY','content-md5','EOEFO','Xwpbu','ZQuJk','rSBVz','Fri','qcrPW','CAOBx','kwMZU','name','mMFgz','Date','GoQzo','Nov','rsa-sha256','50948qJpEVI','120114EUDOBe','AfukN','NCdAu','eGttC','date','key\x20id\x20no\x20value','no\x20date\x20header','stack','DpGND','x-unit-test\x20was\x20not\x20a\x20signed\x20header','oRNqF','Sat','KvqnA','ALvlW','no\x20authorization','signingString','Apr','algorithm\x20no\x20value','txXjy','KQgzr','ofRmK','Signature\x20keyId=\x22foo\x22','PsUUr','xptCX','getUTCMinutes','\x20GMT','bjWeH','request-line','AZFMA','RvQda','SfUkf','Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22,','1527535POLbeU','ogHvf','tPrah','DUKkz','Mar','DeGPf','keyId\x20was\x20not\x20specified','scheme','FzoMG','Mon','Authorization','AExOv','statusCode','bad\x20scheme','Thu','http','tester','RHDtl','VTbEj','data','xPunL','nhQxq','Dec','expired','UmbTc','332271smtjYS','Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22\x20aaabbbbcccc','fo,o','node-uuid','PemjR','KhfMa','sBBMK','Wed','SQmBU','jMxBv','parse','tyHEc','blah\x20blah','setEncoding','sEGUa','Aug','Signature\x20keyId=\x22foo\x22,algorithm=','equal','Fumig','dKGOO','rJPkO','Feb','MGtQM','no\x20algorithm','WTUQR','WnlSw','jADHS','PGbUB','algorithm\x20was\x20not\x20specified','vkQDC','../lib/index','OnIVP','getUTCSeconds','foo\x20is\x20not\x20supported','console.log(\x22timer\x22);','May','EursS','Basic\x20blahBlahBlah','pmZId','keyId','jSJQl','tnSYa','content-md5\x20was\x20not\x20in\x20the\x20request','ruLfG','digitalSignature','algorithm','Signature\x20keyId=\x22foo\x22,algorithm=\x22foo\x22','return\x20new\x20Date();','MissingHeaderError','scxNm','SuApX','Signature','Tue','getUTCDay','VltWQ','aQSrx','KuYGL','0|2|4|1|3','Signature\x20keyId=\x22f,oo\x22,algorithm=\x22RSA-sha256\x22,','get','getUTCMonth','KmVBw','GEtmG','13QUBqgr','iHFnH','vQvvh','WOUBP','sHQyl','write','923216TZNAlU','qEaYZ','iDHCE','aKnzJ','hwteE','vLwWo','getUTCFullYear','signature','WOhTm','close','Oct','rsa-sha256\x20is\x20not\x20a\x20supported\x20algorithm','x-unit-test','MjNZR','EPGwX','writeHead','OXPkh','QrWQH','invalid\x20algorithm','GET\x20/\x20HTTP/1.1','56VNHsWR','Signature\x20foo','OAhpU','zhBeH','MGRYV','utf8','headers=\x22date\x20content-md5\x22\x20aaabbbbcccc','Signature\x20keyId=foo,algorithm=hmac-sha1\x20aabbcc','EjWAu','HYfLD','toUpperCase','message','no\x20key\x20id','InvalidParamsError','JkrMR','Signature\x20keyId=\x22foo\x22,algorithm=\x22foo\x22\x20aaabbbbcccc','mBHAA','ExpiredRequestError','missing\x20required\x20header','eshbN','plYZR','grseF','Nwajz','tap','GBHNh','end','BANGz','TgOPx','yEHMq','split','idhGw','Tstli','date\x20was\x20not\x20in\x20the\x20request','3|4|1|2|0','359624VYdnrP','VBDYh','FTRcY','rJPqW','GIFeu','88578Jlrwhh','params','YsRqV','parseRequest','listen','nwMTw','fail','yDYZr','OmsEp','scheme\x20was\x20not\x20\x22Signature\x22','vneSj','QzlbR','Jan','Jun','headers=\x22dAtE\x20cOntEnt-MD5\x22\x20digitalSignature'];_0x4c09=function(){return _0x582dd6;};return _0x4c09();}function _rfc1123(_0x56331b){var _0x364b0c=_0x363cfd,_0x43e1dc={'DUKkz':_0x364b0c(0x20c),'KhfMa':function(_0x2b77c1,_0x5d0be2){return _0x2b77c1+_0x5d0be2;},'txXjy':function(_0x3b1c50,_0x2f7b33){return _0x3b1c50+_0x2f7b33;},'tPrah':function(_0x1d2775,_0x362795){return _0x1d2775+_0x362795;},'DeGPf':function(_0xe5081a,_0x4e66b9){return _0xe5081a+_0x4e66b9;},'TPKak':function(_0x3155ef,_0x34553e){return _0x3155ef+_0x34553e;},'OnIVP':function(_0xa33604,_0x3cdc3a){return _0xa33604+_0x3cdc3a;},'HYfLD':function(_0xa51611,_0x39d893){return _0xa51611+_0x39d893;},'PemjR':function(_0x185826,_0x5df319){return _0x185826(_0x5df319);},'PJfVH':function(_0x1e1bcf,_0x402d0b){return _0x1e1bcf(_0x402d0b);},'scxNm':_0x364b0c(0x26f),'ZQuJk':function(_0x4c08e8,_0x3b87c3,_0x3dd0b8){return _0x4c08e8(_0x3b87c3,_0x3dd0b8);},'EOEFO':_0x364b0c(0x21e),'NCdAu':_0x364b0c(0x251),'vQvvh':_0x364b0c(0x29d),'OmsEp':_0x364b0c(0x21f),'MjNZR':_0x364b0c(0x229),'KQgzr':'Nov'},_0x143f47=_0x43e1dc[_0x364b0c(0x264)][_0x364b0c(0x208)]('|'),_0x28589f=0x0;while(!![]){switch(_0x143f47[_0x28589f++]){case'0':return _0x43e1dc[_0x364b0c(0x27f)](_0x43e1dc[_0x364b0c(0x27f)](_0x43e1dc[_0x364b0c(0x253)](_0x43e1dc[_0x364b0c(0x27f)](_0x43e1dc[_0x364b0c(0x263)](_0x43e1dc[_0x364b0c(0x266)](_0x43e1dc['DeGPf'](_0x43e1dc[_0x364b0c(0x27f)](_0x43e1dc['TPKak'](_0x43e1dc[_0x364b0c(0x299)](_0x43e1dc[_0x364b0c(0x1f4)](_0x15afe4[_0x56331b[_0x364b0c(0x2af)]()],',\x20'),_0x43e1dc[_0x364b0c(0x27e)](_pad,_0x56331b[_0x364b0c(0x222)]())),'\x20'),_0xc3a320[_0x56331b[_0x364b0c(0x2b6)]()])+'\x20',_0x56331b[_0x364b0c(0x2c5)]()),'\x20'),_0x43e1dc[_0x364b0c(0x27e)](_pad,_0x56331b[_0x364b0c(0x22b)]())),':'),_pad(_0x56331b[_0x364b0c(0x259)]())),':'),_0x43e1dc['PJfVH'](_pad,_0x56331b[_0x364b0c(0x29a)]()))+_0x364b0c(0x25a);case'1':var _0x15afe4=['Sun',_0x364b0c(0x26a),_0x364b0c(0x2ae),_0x364b0c(0x281),_0x43e1dc[_0x364b0c(0x2ab)],_0x364b0c(0x236),_0x364b0c(0x24c)];continue;case'2':_0x43e1dc[_0x364b0c(0x234)](setTimeout,_0x364b0c(0x29c),0x3e8);continue;case'3':if(!_0x56331b)_0x56331b=new Date();continue;case'4':var _0xc3a320=[_0x43e1dc[_0x364b0c(0x232)],_0x364b0c(0x28f),_0x364b0c(0x265),_0x43e1dc[_0x364b0c(0x243)],_0x43e1dc[_0x364b0c(0x2bb)],_0x43e1dc[_0x364b0c(0x21a)],'Jul',_0x364b0c(0x289),_0x43e1dc[_0x364b0c(0x2cc)],'Oct',_0x43e1dc[_0x364b0c(0x254)],_0x364b0c(0x277)];continue;}break;}}test('setup',function(_0x1db424){var _0x82442c=_0x363cfd,_0x5ba3be={'MGRYV':_0x82442c(0x28d),'ruLfG':function(_0x35eb8c,_0x5b5fc8){return _0x35eb8c+_0x5b5fc8;},'sTQMI':'/tmp/.'};socket=_0x5ba3be[_0x82442c(0x2a5)](_0x5ba3be['sTQMI'],uuid()),options={'socketPath':socket,'path':'/','headers':{}},server=http[_0x82442c(0x22f)](function(_0x55cccc,_0x23cb56){var _0x20c540=_0x82442c;server[_0x20c540(0x271)](_0x55cccc,_0x23cb56);}),server[_0x82442c(0x216)](socket,function(){var _0x285c8a=_0x82442c;_0x5ba3be[_0x285c8a(0x1ef)]===_0x5ba3be[_0x285c8a(0x1ef)]?_0x1db424[_0x285c8a(0x204)]():_0x1ef768[_0x285c8a(0x215)](_0x12a8d2);});}),test(_0x363cfd(0x24f),function(_0x5a68a5){var _0x2dc766=_0x363cfd,_0x13eea2={'aKnzJ':_0x2dc766(0x2aa),'XRJEX':function(_0x123c1a,_0xd83cdf){return _0x123c1a!==_0xd83cdf;},'tyHEc':_0x2dc766(0x28c)};server[_0x2dc766(0x271)]=function(_0x4e8cc4,_0x4fc3ab){var _0x3a1266=_0x2dc766,_0x4fae35={'bDJNC':_0x13eea2['aKnzJ']};if(_0x13eea2[_0x3a1266(0x224)](_0x13eea2[_0x3a1266(0x285)],_0x3a1266(0x28c)))_0x310116[_0x3a1266(0x28b)](_0x3de780[_0x3a1266(0x23a)],_0x4fae35['bDJNC']),_0x37064a['equal'](_0x69b634['message'],_0x3a1266(0x20b));else{try{httpSignature[_0x3a1266(0x215)](_0x4e8cc4);}catch(_0x19b59a){_0x5a68a5[_0x3a1266(0x28b)](_0x19b59a[_0x3a1266(0x23a)],_0x13eea2[_0x3a1266(0x2c2)]);}_0x4fc3ab['writeHead'](0xc8),_0x4fc3ab[_0x3a1266(0x204)]();}},http['get'](options,function(_0x2e9ef8){var _0x1193fd=_0x2dc766;_0x5a68a5[_0x1193fd(0x28b)](_0x2e9ef8[_0x1193fd(0x26d)],0xc8),_0x5a68a5[_0x1193fd(0x204)]();});}),test(_0x363cfd(0x26e),function(_0x4f1ce1){var _0x4c9b21=_0x363cfd;server[_0x4c9b21(0x271)]=function(_0x2f87e2,_0x46731e){var _0x1da73d=_0x4c9b21;try{httpSignature[_0x1da73d(0x215)](_0x2f87e2);}catch(_0x28f329){_0x4f1ce1[_0x1da73d(0x28b)](_0x28f329[_0x1da73d(0x23a)],_0x1da73d(0x22a)),_0x4f1ce1[_0x1da73d(0x28b)](_0x28f329[_0x1da73d(0x1f6)],_0x1da73d(0x21b));}_0x46731e[_0x1da73d(0x2ce)](0xc8),_0x46731e['end']();},options[_0x4c9b21(0x22e)][_0x4c9b21(0x26b)]=_0x4c9b21(0x29f),http[_0x4c9b21(0x2b5)](options,function(_0x11620e){var _0x1e6167=_0x4c9b21;_0x4f1ce1[_0x1e6167(0x28b)](_0x11620e[_0x1e6167(0x26d)],0xc8),_0x4f1ce1[_0x1e6167(0x204)]();});}),test(_0x363cfd(0x1f7),function(_0x40a890){var _0x18adb4=_0x363cfd,_0x5bfa2d={'rQRyS':function(_0xba0de4,_0x509d91){return _0xba0de4===_0x509d91;},'plYZR':'HMwtp','kwMZU':_0x18adb4(0x1f9),'SuApX':function(_0x1c63d5,_0x274c03){return _0x1c63d5!==_0x274c03;},'oRNqF':_0x18adb4(0x290),'GIFeu':_0x18adb4(0x2d4)};server[_0x18adb4(0x271)]=function(_0x5c6c04,_0x2670c3){var _0x4c722e=_0x18adb4,_0x29bc77={'TjopN':_0x4c722e(0x1f8),'yDYZr':_0x4c722e(0x1fc)};if(_0x5bfa2d['rQRyS'](_0x5bfa2d[_0x4c722e(0x1ff)],_0x5bfa2d[_0x4c722e(0x239)]))_0x5c2e81[_0x4c722e(0x28b)](_0x29bc77['TjopN'],_0xc9a676['name']),_0x1548f9[_0x4c722e(0x28b)]('rsa-sha256\x20is\x20not\x20a\x20supported\x20algorithm',_0x4e73c9[_0x4c722e(0x1f6)]);else{try{httpSignature[_0x4c722e(0x215)](_0x5c6c04);}catch(_0x41c72a){if(_0x5bfa2d[_0x4c722e(0x2ac)](_0x5bfa2d[_0x4c722e(0x24b)],_0x5bfa2d[_0x4c722e(0x24b)])){var _0x45560f={'rJPqW':_0x29bc77[_0x4c722e(0x219)]},_0x427894={'clockSkew':0x1,'headers':[_0x4c722e(0x245)]};_0x291e98(function(){var _0x19de33=_0x4c722e;try{_0x557c15['parseRequest'](_0xed0a5);}catch(_0x26d832){_0x2be075[_0x19de33(0x28b)](_0x26d832[_0x19de33(0x23a)],_0x45560f[_0x19de33(0x210)]),_0x6b5dc5['ok'](/clock skew of \d\.\d+s was greater than 1s/['test'](_0x26d832[_0x19de33(0x1f6)]));}_0x3886d4['writeHead'](0xc8),_0x5cdf68[_0x19de33(0x204)]();},0x4b0);}else _0x40a890['equal'](_0x41c72a[_0x4c722e(0x23a)],_0x4c722e(0x22a)),_0x40a890['equal'](_0x41c72a[_0x4c722e(0x1f6)],_0x4c722e(0x267));}_0x2670c3['writeHead'](0xc8),_0x2670c3['end']();}},options['headers'][_0x18adb4(0x26b)]=_0x5bfa2d[_0x18adb4(0x211)],http['get'](options,function(_0x1c9f1a){var _0xa7335d=_0x18adb4;_0x40a890[_0xa7335d(0x28b)](_0x1c9f1a[_0xa7335d(0x26d)],0xc8),_0x40a890[_0xa7335d(0x204)]();});}),test(_0x363cfd(0x246),function(_0x5bbe11){var _0x6377a3=_0x363cfd,_0x3e4478={'PsUUr':_0x6377a3(0x21c),'sHwuW':_0x6377a3(0x227),'RHDtl':_0x6377a3(0x22a),'GEtmG':_0x6377a3(0x267),'mBHAA':'Signature\x20keyId='};server[_0x6377a3(0x271)]=function(_0xda2142,_0x152bd8){var _0x28ec0c=_0x6377a3;try{httpSignature[_0x28ec0c(0x215)](_0xda2142);}catch(_0x32a491){_0x3e4478[_0x28ec0c(0x257)]!==_0x3e4478['sHwuW']?(_0x5bbe11[_0x28ec0c(0x28b)](_0x32a491[_0x28ec0c(0x23a)],_0x3e4478[_0x28ec0c(0x272)]),_0x5bbe11[_0x28ec0c(0x28b)](_0x32a491[_0x28ec0c(0x1f6)],_0x3e4478[_0x28ec0c(0x2b8)])):_0x49d1c4[_0x28ec0c(0x215)](_0x378b35);}_0x152bd8[_0x28ec0c(0x2ce)](0xc8),_0x152bd8['end']();},options['headers']['Authorization']=_0x3e4478[_0x6377a3(0x1fb)],http[_0x6377a3(0x2b5)](options,function(_0x5a2eeb){var _0x442655=_0x6377a3;_0x5bbe11['equal'](_0x5a2eeb[_0x442655(0x26d)],0xc8),_0x5bbe11[_0x442655(0x204)]();});}),test('key\x20id\x20no\x20quotes',function(_0x35a4e4){var _0x5cd681=_0x363cfd,_0x21c8da={'GoQzo':_0x5cd681(0x217),'xCBAk':_0x5cd681(0x2c7),'OXPkh':'InvalidHeaderError'};server['tester']=function(_0x196959,_0x5ef25a){var _0x133db5=_0x5cd681;if('nwMTw'!==_0x21c8da[_0x133db5(0x23d)])_0x5ba2b3['equal'](_0x4a358e[_0x133db5(0x26d)],0xc8),_0x4419b0[_0x133db5(0x204)]();else{try{_0x21c8da[_0x133db5(0x228)]===_0x133db5(0x2c7)?httpSignature[_0x133db5(0x215)](_0x196959):(_0x43eda2['equal'](_0x2d29a5[_0x133db5(0x26d)],0xc8),_0x54dcd6[_0x133db5(0x204)]());}catch(_0x6631e9){_0x35a4e4['equal'](_0x6631e9['name'],_0x21c8da[_0x133db5(0x2cf)]),_0x35a4e4[_0x133db5(0x28b)](_0x6631e9[_0x133db5(0x1f6)],_0x133db5(0x267));}_0x5ef25a[_0x133db5(0x2ce)](0xc8),_0x5ef25a[_0x133db5(0x204)]();}},options[_0x5cd681(0x22e)]['Authorization']=_0x5cd681(0x1f2),http[_0x5cd681(0x2b5)](options,function(_0xeb2b13){var _0xa78b45=_0x5cd681;_0x35a4e4[_0xa78b45(0x28b)](_0xeb2b13[_0xa78b45(0x26d)],0xc8),_0x35a4e4[_0xa78b45(0x204)]();});}),test(_0x363cfd(0x291),function(_0x4e931a){var _0x2cb26a=_0x363cfd,_0x42b520={'hwteE':_0x2cb26a(0x2cd),'fdKhr':'nKKZn','sBBMK':_0x2cb26a(0x256)};server['tester']=function(_0x21bf10,_0x433f23){var _0x577580=_0x2cb26a;if(_0x42b520[_0x577580(0x2c3)]===_0x42b520['fdKhr'])_0x57776a['parseRequest'](_0x5f5c9e);else{try{httpSignature[_0x577580(0x215)](_0x21bf10);}catch(_0x2d18c9){_0x4e931a[_0x577580(0x28b)](_0x2d18c9[_0x577580(0x23a)],_0x577580(0x22a)),_0x4e931a[_0x577580(0x28b)](_0x2d18c9[_0x577580(0x1f6)],_0x577580(0x296));}_0x433f23[_0x577580(0x2ce)](0xc8),_0x433f23['end']();}},options[_0x2cb26a(0x22e)][_0x2cb26a(0x26b)]=_0x42b520[_0x2cb26a(0x280)],http[_0x2cb26a(0x2b5)](options,function(_0x19f87c){var _0x31aadc=_0x2cb26a;_0x4e931a['equal'](_0x19f87c[_0x31aadc(0x26d)],0xc8),_0x4e931a[_0x31aadc(0x204)]();});}),test(_0x363cfd(0x252),function(_0x562eb9){var _0x139e5c=_0x363cfd;server['tester']=function(_0x42fd03,_0x4bba04){var _0x1bd567=_0x330c;try{httpSignature[_0x1bd567(0x215)](_0x42fd03);}catch(_0x4c728c){_0x562eb9['equal'](_0x4c728c[_0x1bd567(0x23a)],_0x1bd567(0x22a)),_0x562eb9[_0x1bd567(0x28b)](_0x4c728c[_0x1bd567(0x1f6)],_0x1bd567(0x296));}_0x4bba04['writeHead'](0xc8),_0x4bba04['end']();},options[_0x139e5c(0x22e)][_0x139e5c(0x26b)]=_0x139e5c(0x28a),http[_0x139e5c(0x2b5)](options,function(_0x249327){var _0x5b3a01=_0x139e5c;_0x562eb9[_0x5b3a01(0x28b)](_0x249327[_0x5b3a01(0x26d)],0xc8),_0x562eb9[_0x5b3a01(0x204)]();});}),test('no\x20signature',function(_0x4d5f8a){var _0x1da63a=_0x363cfd,_0x246d95={'XzxuW':'signature\x20was\x20empty','EjWAu':_0x1da63a(0x25f)};server['tester']=function(_0x9ca9e8,_0x6dad0e){var _0x544812=_0x1da63a;try{httpSignature[_0x544812(0x215)](_0x9ca9e8);}catch(_0x439ef7){_0x4d5f8a['equal'](_0x439ef7[_0x544812(0x23a)],'InvalidHeaderError'),_0x4d5f8a[_0x544812(0x28b)](_0x439ef7[_0x544812(0x1f6)],_0x246d95['XzxuW']);}_0x6dad0e['writeHead'](0xc8),_0x6dad0e[_0x544812(0x204)]();},options[_0x1da63a(0x22e)][_0x1da63a(0x26b)]=_0x1da63a(0x2a8),http['get'](options,function(_0x38ce92){var _0x89bd79=_0x1da63a;_0x246d95[_0x89bd79(0x1f3)]==='GGsRB'?_0x51944b+=_0x39eba2:(_0x4d5f8a[_0x89bd79(0x28b)](_0x38ce92['statusCode'],0xc8),_0x4d5f8a['end']());});}),test(_0x363cfd(0x2d1),function(_0x1a2ea3){var _0x1d9fac=_0x363cfd,_0x200ef6={'KmVBw':_0x1d9fac(0x1f8)};server[_0x1d9fac(0x271)]=function(_0x3e34f8,_0x241998){var _0x12f0b7=_0x1d9fac;try{httpSignature[_0x12f0b7(0x215)](_0x3e34f8);}catch(_0x25ff0f){_0x1a2ea3[_0x12f0b7(0x28b)](_0x25ff0f[_0x12f0b7(0x23a)],_0x200ef6[_0x12f0b7(0x2b7)]),_0x1a2ea3[_0x12f0b7(0x28b)](_0x25ff0f[_0x12f0b7(0x1f6)],'foo\x20is\x20not\x20supported');}_0x241998[_0x12f0b7(0x2ce)](0xc8),_0x241998[_0x12f0b7(0x204)]();},options['headers'][_0x1d9fac(0x26b)]=_0x1d9fac(0x1fa),http[_0x1d9fac(0x2b5)](options,function(_0x44d8e1){var _0x221c22=_0x1d9fac;_0x1a2ea3['equal'](_0x44d8e1[_0x221c22(0x26d)],0xc8),_0x1a2ea3[_0x221c22(0x204)]();});}),test(_0x363cfd(0x247),function(_0x51c42c){var _0x282c90=_0x363cfd,_0x5efdbf={'AExOv':'MissingHeaderError','sEGUa':_0x282c90(0x27b)};server[_0x282c90(0x271)]=function(_0x554eef,_0x42dab7){var _0x5782b2=_0x282c90;try{httpSignature[_0x5782b2(0x215)](_0x554eef);}catch(_0x45d62c){_0x51c42c[_0x5782b2(0x28b)](_0x45d62c[_0x5782b2(0x23a)],_0x5efdbf[_0x5782b2(0x26c)]),_0x51c42c['equal'](_0x45d62c[_0x5782b2(0x1f6)],'date\x20was\x20not\x20in\x20the\x20request');}_0x42dab7[_0x5782b2(0x2ce)](0xc8),_0x42dab7[_0x5782b2(0x204)]();},options[_0x282c90(0x22e)][_0x282c90(0x26b)]=_0x5efdbf[_0x282c90(0x288)],http[_0x282c90(0x2b5)](options,function(_0x52f696){var _0x365964=_0x282c90;_0x51c42c[_0x365964(0x28b)](_0x52f696['statusCode'],0xc8),_0x51c42c[_0x365964(0x204)]();});}),test('valid\x20default\x20headers',function(_0xcb8842){var _0x2df7eb=_0x363cfd,_0x49c237={'eGttC':'Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22\x20aaabbbbcccc','sFYSz':function(_0x162b62){return _0x162b62();}};server[_0x2df7eb(0x271)]=function(_0x4d3de9,_0x27cb3c){var _0x3a505e=_0x2df7eb;try{httpSignature[_0x3a505e(0x215)](_0x4d3de9);}catch(_0x5568a1){_0xcb8842[_0x3a505e(0x218)](_0x5568a1[_0x3a505e(0x248)]);}_0x27cb3c[_0x3a505e(0x2ce)](0xc8),_0x27cb3c[_0x3a505e(0x204)]();},options[_0x2df7eb(0x22e)][_0x2df7eb(0x26b)]=_0x49c237[_0x2df7eb(0x244)],options[_0x2df7eb(0x22e)][_0x2df7eb(0x23c)]=_0x49c237['sFYSz'](_rfc1123),http[_0x2df7eb(0x2b5)](options,function(_0x152a9e){var _0x4e990f=_0x2df7eb;_0xcb8842[_0x4e990f(0x28b)](_0x152a9e[_0x4e990f(0x26d)],0xc8),_0xcb8842[_0x4e990f(0x204)]();});}),test('explicit\x20headers\x20missing',function(_0x396f8d){var _0x295777=_0x363cfd,_0x2d9fee={'WTUQR':function(_0x9aecf9,_0x20f632){return _0x9aecf9!==_0x20f632;},'xPunL':'IrbnL','qEaYZ':'vNtCU','yEHMq':_0x295777(0x2a4),'aQSrx':_0x295777(0x235),'jADHS':_0x295777(0x25b),'YsRqV':_0x295777(0x1f1)};server[_0x295777(0x271)]=function(_0x30e314,_0x446e9d){var _0x2b20b9=_0x295777,_0x37afdb={'tnSYa':'InvalidHeaderError','wITZi':_0x2b20b9(0x267)};try{if(_0x2d9fee[_0x2b20b9(0x292)]('uDcON',_0x2d9fee[_0x2b20b9(0x275)]))httpSignature[_0x2b20b9(0x215)](_0x30e314);else{try{_0x49bd5d['parseRequest'](_0x503ef9);}catch(_0x42974a){_0x764dcc[_0x2b20b9(0x28b)](_0x42974a['name'],_0x2b20b9(0x22a)),_0x1264fe['equal'](_0x42974a[_0x2b20b9(0x1f6)],_0x2b20b9(0x267));}_0x393173['writeHead'](0xc8),_0x2628ed[_0x2b20b9(0x204)]();}}catch(_0x4f58a0){_0x2d9fee[_0x2b20b9(0x2c0)]!==_0x2d9fee[_0x2b20b9(0x2c0)]?(_0x43b487[_0x2b20b9(0x28b)](_0x1cbacc[_0x2b20b9(0x23a)],_0x37afdb[_0x2b20b9(0x2a3)]),_0x167906[_0x2b20b9(0x28b)](_0x5bd299['message'],_0x37afdb['wITZi'])):(_0x396f8d[_0x2b20b9(0x28b)](_0x4f58a0['name'],'MissingHeaderError'),_0x396f8d[_0x2b20b9(0x28b)](_0x4f58a0['message'],_0x2d9fee[_0x2b20b9(0x207)]));}_0x446e9d[_0x2b20b9(0x2ce)](0xc8),_0x446e9d[_0x2b20b9(0x204)]();},options['headers'][_0x295777(0x26b)]=_0x295777(0x260)+_0x2d9fee[_0x295777(0x214)],options[_0x295777(0x22e)]['Date']=_rfc1123(),http[_0x295777(0x2b5)](options,function(_0x128224){var _0x4b1bd5=_0x295777;_0x2d9fee[_0x4b1bd5(0x2b1)]!==_0x2d9fee[_0x4b1bd5(0x294)]?(_0x396f8d[_0x4b1bd5(0x28b)](_0x128224[_0x4b1bd5(0x26d)],0xc8),_0x396f8d[_0x4b1bd5(0x204)]()):_0xcbafdf[_0x4b1bd5(0x215)](_0x4f70f5);});}),test('valid\x20explicit\x20headers',function(_0x571797){var _0x5ad22a=_0x363cfd,_0x597ed3={'zhBeH':_0x5ad22a(0x23f),'BKQQP':_0x5ad22a(0x286),'PGbUB':_0x5ad22a(0x245),'FzoMG':_0x5ad22a(0x231),'StNfx':_0x5ad22a(0x2a6),'SGAMx':_0x5ad22a(0x2d2),'QzlbR':_0x5ad22a(0x204),'RVhAf':_0x5ad22a(0x1f0),'AfukN':function(_0x17b611,_0x5b0912){return _0x17b611+_0x5b0912;},'WOUBP':'headers=\x22dAtE\x20cOntEnt-MD5\x20request-line\x22,','qcrPW':_0x5ad22a(0x221),'Xwpbu':function(_0x330064){return _0x330064();}};server[_0x5ad22a(0x271)]=function(_0x2f9723,_0x5cfa08){var _0x342186=_0x5ad22a,_0x2226f3=httpSignature[_0x342186(0x215)](_0x2f9723);_0x5cfa08['writeHead'](0xc8),_0x5cfa08[_0x342186(0x2be)](JSON['stringify'](_0x2226f3,null,0x2)),_0x5cfa08['end']();},options['headers'][_0x5ad22a(0x26b)]=_0x597ed3[_0x5ad22a(0x242)](_0x5ad22a(0x223),_0x597ed3[_0x5ad22a(0x2bc)])+_0x597ed3[_0x5ad22a(0x237)],options[_0x5ad22a(0x22e)][_0x5ad22a(0x23c)]=_0x597ed3[_0x5ad22a(0x233)](_rfc1123),options['headers'][_0x5ad22a(0x231)]=uuid(),http['get'](options,function(_0x5f4642){var _0x1abac8=_0x5ad22a,_0x1968aa='0|2|5|4|1|3'[_0x1abac8(0x208)]('|'),_0x59142c=0x0;while(!![]){switch(_0x1968aa[_0x59142c++]){case'0':var _0x3e342c={'Nwajz':_0x597ed3[_0x1abac8(0x1ee)],'DgOQU':_0x597ed3['BKQQP'],'PzoYe':_0x597ed3[_0x1abac8(0x295)],'sHQyl':_0x597ed3[_0x1abac8(0x269)],'BANGz':_0x597ed3['StNfx'],'GBHNh':function(_0x2e1be3,_0x5e7a2c){return _0x2e1be3+_0x5e7a2c;},'mMFgz':_0x597ed3['SGAMx']};continue;case'1':_0x5f4642['on'](_0x1abac8(0x274),function(_0x1cbba7){_0x5e9b02+=_0x1cbba7;});continue;case'2':_0x571797['equal'](_0x5f4642['statusCode'],0xc8);continue;case'3':_0x5f4642['on'](_0x597ed3[_0x1abac8(0x21d)],function(){var _0x15a796=_0x1abac8;console['log'](_0x5e9b02);var _0x90b934=JSON[_0x15a796(0x284)](_0x5e9b02);_0x571797['ok'](_0x90b934),_0x571797['equal'](_0x90b934[_0x15a796(0x268)],_0x15a796(0x2ad)),_0x571797['ok'](_0x90b934[_0x15a796(0x213)]),_0x571797['equal'](_0x90b934[_0x15a796(0x213)]['keyId'],_0x15a796(0x27c)),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)]['algorithm'],_0x3e342c[_0x15a796(0x201)]),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)]['extensions'],_0x3e342c['DgOQU']),_0x571797['ok'](_0x90b934[_0x15a796(0x213)]['headers']),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)]['headers']['length'],0x3),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)][_0x15a796(0x22e)][0x0],_0x3e342c['PzoYe']),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)][_0x15a796(0x22e)][0x1],_0x3e342c[_0x15a796(0x2bd)]),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)]['headers'][0x2],_0x15a796(0x25c)),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x2c6)],_0x3e342c[_0x15a796(0x205)]),_0x571797['ok'](_0x90b934[_0x15a796(0x250)]),_0x571797['equal'](_0x90b934[_0x15a796(0x250)],_0x3e342c[_0x15a796(0x203)](_0x3e342c[_0x15a796(0x203)](options[_0x15a796(0x22e)][_0x15a796(0x23c)]+'\x0a',options['headers'][_0x3e342c['sHQyl']])+'\x0a',_0x3e342c[_0x15a796(0x23b)])),_0x571797[_0x15a796(0x28b)](_0x90b934[_0x15a796(0x213)]['keyId'],_0x90b934[_0x15a796(0x2a1)]),_0x571797['equal'](_0x90b934[_0x15a796(0x213)][_0x15a796(0x2a7)][_0x15a796(0x1f5)](),_0x90b934[_0x15a796(0x2a7)]),_0x571797[_0x15a796(0x204)]();});continue;case'4':_0x5f4642[_0x1abac8(0x287)](_0x597ed3['RVhAf']);continue;case'5':var _0x5e9b02='';continue;}break;}});}),test(_0x363cfd(0x278),function(_0xe67854){var _0x36bc1f=_0x363cfd,_0xb3897b={'KvqnA':'date','jMxBv':'bnfxp','VTbEj':function(_0x5c1453,_0x3f387e){return _0x5c1453+_0x3f387e;},'VltWQ':_0x36bc1f(0x220),'rJPkO':function(_0x11980d){return _0x11980d();}};server[_0x36bc1f(0x271)]=function(_0xb0f01b,_0x2828d9){var _0x518f9f=_0x36bc1f,_0x23ff61={'clockSkew':0x1,'headers':[_0xb3897b[_0x518f9f(0x24d)]]};setTimeout(function(){var _0x306d6e=_0x518f9f;try{httpSignature[_0x306d6e(0x215)](_0xb0f01b);}catch(_0x2c3309){_0xe67854[_0x306d6e(0x28b)](_0x2c3309[_0x306d6e(0x23a)],_0x306d6e(0x1fc)),_0xe67854['ok'](/clock skew of \d\.\d+s was greater than 1s/['test'](_0x2c3309[_0x306d6e(0x1f6)]));}_0x2828d9[_0x306d6e(0x2ce)](0xc8),_0x2828d9['end']();},0x4b0);},options[_0x36bc1f(0x22e)][_0x36bc1f(0x26b)]=_0xb3897b[_0x36bc1f(0x273)]('Signature\x20keyId=\x22f,oo\x22,algorithm=\x22RSA-sha256\x22,',_0xb3897b[_0x36bc1f(0x2b0)]),options['headers'][_0x36bc1f(0x23c)]=_0xb3897b[_0x36bc1f(0x28e)](_rfc1123),options[_0x36bc1f(0x22e)]['content-md5']=_0xb3897b[_0x36bc1f(0x28e)](uuid),http[_0x36bc1f(0x2b5)](options,function(_0x2277d2){var _0x5a9a48=_0x36bc1f;_0xb3897b[_0x5a9a48(0x283)]!==_0x5a9a48(0x276)?(_0xe67854[_0x5a9a48(0x28b)](_0x2277d2[_0x5a9a48(0x26d)],0xc8),_0xe67854[_0x5a9a48(0x204)]()):(_0x218e8a[_0x5a9a48(0x28b)](_0xc7702a['name'],_0x5a9a48(0x1f8)),_0x44b296[_0x5a9a48(0x28b)](_0x53686b[_0x5a9a48(0x1f6)],_0x5a9a48(0x29b)));});}),test(_0x363cfd(0x1fd),function(_0x252b3e){var _0x1bafb7=_0x363cfd,_0x450b74={'vgIGY':_0x1bafb7(0x2b3),'nfXNf':_0x1bafb7(0x29c),'VBDYh':_0x1bafb7(0x265),'Tstli':_0x1bafb7(0x29d),'fkkNa':_0x1bafb7(0x21f),'eshbN':_0x1bafb7(0x2c9),'iHFnH':function(_0x5794ed,_0x38b850){return _0x5794ed+_0x38b850;},'pmZId':function(_0x157667,_0x1e45cd){return _0x157667+_0x1e45cd;},'idhGw':function(_0x4d58d7,_0x2e0136){return _0x4d58d7+_0x2e0136;},'OAhpU':function(_0x327dc8,_0x54c84a){return _0x327dc8(_0x54c84a);},'nldiw':function(_0x898eb1,_0x511ded){return _0x898eb1(_0x511ded);},'sIyEP':'Sun','KuYGL':_0x1bafb7(0x26a),'ogHvf':'Tue','grseF':'Wed','gferA':_0x1bafb7(0x236),'AZFMA':function(_0x423652,_0x75329f){return _0x423652!==_0x75329f;},'VeiPe':_0x1bafb7(0x226),'vkQDC':_0x1bafb7(0x2aa),'MBCVh':_0x1bafb7(0x2b4),'CAOBx':function(_0xac9bac){return _0xac9bac();}};server[_0x1bafb7(0x271)]=function(_0x25b130,_0x2d1287){var _0x222a4e=_0x1bafb7;if(_0x450b74[_0x222a4e(0x25d)](_0x450b74['VeiPe'],_0x450b74[_0x222a4e(0x22d)])){var _0xe720e9=_0x450b74[_0x222a4e(0x230)]['split']('|'),_0x12902b=0x0;while(!![]){switch(_0xe720e9[_0x12902b++]){case'0':if(!_0x2548b4)_0x4ff964=new _0x2aaada();continue;case'1':_0x2b6871(_0x450b74['nfXNf'],0x3e8);continue;case'2':var _0xf880c1=[_0x222a4e(0x21e),'Feb',_0x450b74[_0x222a4e(0x20e)],'Apr',_0x450b74[_0x222a4e(0x20a)],_0x450b74['fkkNa'],'Jul','Aug',_0x222a4e(0x229),_0x450b74[_0x222a4e(0x1fe)],_0x222a4e(0x23e),_0x222a4e(0x277)];continue;case'3':return _0x450b74[_0x222a4e(0x2ba)](_0x450b74['pmZId'](_0x450b74[_0x222a4e(0x209)](_0x450b74[_0x222a4e(0x2a0)](_0x450b74[_0x222a4e(0x209)](_0x450b74[_0x222a4e(0x209)](_0x18a67c[_0x2e1814['getUTCDay']()]+',\x20',_0x450b74[_0x222a4e(0x2d5)](_0x54184e,_0x19b46d[_0x222a4e(0x222)]())),'\x20')+_0xf880c1[_0x3866d5[_0x222a4e(0x2b6)]()],'\x20'),_0x2e12d2[_0x222a4e(0x2c5)]())+'\x20'+_0x3c0013(_0x108a61[_0x222a4e(0x22b)]()),':')+_0xf6182c(_0x41d3ad['getUTCMinutes']()),':')+_0x450b74[_0x222a4e(0x225)](_0x3143bd,_0x4516bf[_0x222a4e(0x29a)]())+_0x222a4e(0x25a);case'4':var _0x18a67c=[_0x450b74['sIyEP'],_0x450b74[_0x222a4e(0x2b2)],_0x450b74[_0x222a4e(0x262)],_0x450b74[_0x222a4e(0x200)],_0x222a4e(0x26f),_0x450b74['gferA'],_0x222a4e(0x24c)];continue;}break;}}else{var _0x24c22d={'clockSkew':0x1,'headers':[_0x222a4e(0x245),_0x222a4e(0x2cb)]};try{httpSignature[_0x222a4e(0x215)](_0x25b130,_0x24c22d);}catch(_0x2385b4){_0x252b3e[_0x222a4e(0x28b)](_0x2385b4['name'],_0x450b74[_0x222a4e(0x297)]),_0x252b3e[_0x222a4e(0x28b)](_0x2385b4['message'],_0x222a4e(0x24a));}_0x2d1287[_0x222a4e(0x2ce)](0xc8),_0x2d1287[_0x222a4e(0x204)]();}},options[_0x1bafb7(0x22e)][_0x1bafb7(0x26b)]=_0x450b74['MBCVh']+_0x1bafb7(0x220),options[_0x1bafb7(0x22e)][_0x1bafb7(0x23c)]=_rfc1123(),options[_0x1bafb7(0x22e)][_0x1bafb7(0x231)]=_0x450b74[_0x1bafb7(0x238)](uuid),http[_0x1bafb7(0x2b5)](options,function(_0x429eff){var _0x2d6cfc=_0x1bafb7;_0x252b3e[_0x2d6cfc(0x28b)](_0x429eff[_0x2d6cfc(0x26d)],0xc8),_0x252b3e[_0x2d6cfc(0x204)]();});}),test('not\x20whitelisted\x20algorithm',function(_0x1a14a6){var _0x510a33=_0x363cfd,_0x2aca7d={'UmbTc':function(_0x3025bb,_0x1d4d94){return _0x3025bb!==_0x1d4d94;},'DpGND':function(_0x4ef604,_0x1576e1){return _0x4ef604===_0x1576e1;},'FTRcY':_0x510a33(0x206),'vLwWo':_0x510a33(0x1f8),'ofRmK':_0x510a33(0x2ca),'SQmBU':'InvalidHeaderError','rUvmw':_0x510a33(0x24e),'WnlSw':_0x510a33(0x258),'IlHNm':function(_0x10fca4){return _0x10fca4();}};server['tester']=function(_0x148b03,_0x34579c){var _0x5eaa17=_0x510a33,_0x3be8e8={'QrWQH':'InvalidHeaderError','rHhPv':_0x5eaa17(0x267)};if(_0x2aca7d[_0x5eaa17(0x279)](_0x5eaa17(0x29e),_0x5eaa17(0x2c1))){var _0xb3ad11={'clockSkew':0x1,'algorithms':['rsa-sha1']};try{httpSignature[_0x5eaa17(0x215)](_0x148b03,_0xb3ad11);}catch(_0x2c6d13){if(_0x2aca7d[_0x5eaa17(0x249)](_0x5eaa17(0x25e),_0x2aca7d[_0x5eaa17(0x20f)])){try{_0x78237d[_0x5eaa17(0x215)](_0x342e6f);}catch(_0x4b0f0b){_0x4a751f[_0x5eaa17(0x28b)](_0x4b0f0b[_0x5eaa17(0x23a)],_0x3be8e8[_0x5eaa17(0x2d0)]),_0x507346[_0x5eaa17(0x28b)](_0x4b0f0b[_0x5eaa17(0x1f6)],_0x3be8e8['rHhPv']);}_0x36581d[_0x5eaa17(0x2ce)](0xc8),_0x8f9ec5[_0x5eaa17(0x204)]();}else _0x1a14a6[_0x5eaa17(0x28b)](_0x2aca7d[_0x5eaa17(0x2c4)],_0x2c6d13[_0x5eaa17(0x23a)]),_0x1a14a6[_0x5eaa17(0x28b)](_0x2aca7d[_0x5eaa17(0x255)],_0x2c6d13['message']);}_0x34579c['writeHead'](0xc8),_0x34579c[_0x5eaa17(0x204)]();}else{var _0x1d991f=_0x1242e5[_0x5eaa17(0x215)](_0x2760bd);_0x9de6d1['writeHead'](0xc8),_0x4cd07d[_0x5eaa17(0x2be)](_0x495e08['stringify'](_0x1d991f,null,0x2)),_0x3e5617[_0x5eaa17(0x204)]();}},options[_0x510a33(0x22e)][_0x510a33(0x26b)]=_0x510a33(0x2b4)+'headers=\x22dAtE\x20cOntEnt-MD5\x22\x20digitalSignature',options[_0x510a33(0x22e)][_0x510a33(0x23c)]=_0x2aca7d['IlHNm'](_rfc1123),options[_0x510a33(0x22e)][_0x510a33(0x231)]=uuid(),http[_0x510a33(0x2b5)](options,function(_0x11a0e0){var _0x17f5bd=_0x510a33;_0x2aca7d[_0x17f5bd(0x22c)]!==_0x2aca7d[_0x17f5bd(0x293)]?(_0x1a14a6['equal'](_0x11a0e0['statusCode'],0xc8),_0x1a14a6['end']()):(_0xdac4b4[_0x17f5bd(0x28b)](_0x5ab387['name'],_0x2aca7d[_0x17f5bd(0x282)]),_0x4dddf1[_0x17f5bd(0x28b)](_0x127d94[_0x17f5bd(0x1f6)],_0x17f5bd(0x267)));});}),test('tearDown',function(_0x5351e6){var _0x1593ed=_0x363cfd;server['on'](_0x1593ed(0x2c8),function(){var _0x107094=_0x1593ed;_0x5351e6[_0x107094(0x204)]();}),server[_0x1593ed(0x2c8)]();});