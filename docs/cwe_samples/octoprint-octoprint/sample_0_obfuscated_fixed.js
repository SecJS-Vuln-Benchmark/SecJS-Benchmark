const _0x52acbd=_0x1a65;(function(_0x1b2bd4,_0x2b7409){const _0x21c74c=_0x1a65,_0x1e16cf=_0x1b2bd4();while(!![]){try{const _0x5545e3=-parseInt(_0x21c74c(0xa1))/0x1*(parseInt(_0x21c74c(0x91))/0x2)+parseInt(_0x21c74c(0xf3))/0x3+-parseInt(_0x21c74c(0x8b))/0x4*(parseInt(_0x21c74c(0x8d))/0x5)+-parseInt(_0x21c74c(0xd6))/0x6*(-parseInt(_0x21c74c(0xf5))/0x7)+parseInt(_0x21c74c(0xe2))/0x8*(-parseInt(_0x21c74c(0x90))/0x9)+parseInt(_0x21c74c(0xbf))/0xa+parseInt(_0x21c74c(0xdc))/0xb;if(_0x5545e3===_0x2b7409)break;else _0x1e16cf['push'](_0x1e16cf['shift']());}catch(_0x945eb0){_0x1e16cf['push'](_0x1e16cf['shift']());}}}(_0x19ee,0x74488));const xpath=require(_0x52acbd(0xeb)),Dom=require(_0x52acbd(0xdf))['DOMParser'],SignedXml=require(_0x52acbd(0xe4))[_0x52acbd(0xcf)],fs=require('fs'),crypto=require('../index'),expect=require('chai')[_0x52acbd(0xdd)];function _0x1a65(_0x3ae464,_0x594cb4){const _0x19eeb4=_0x19ee();return _0x1a65=function(_0x1a655b,_0x1520b1){_0x1a655b=_0x1a655b-0x81;let _0x29c809=_0x19eeb4[_0x1a655b];return _0x29c809;},_0x1a65(_0x3ae464,_0x594cb4);}function _0x19ee(){const _0x16f371=['readFileSync','kOSfz','xpath','VHQLq','//*[local-name(.)=\x27w\x27]','fyCxp','loadSignature','./test/static/integration/expectedVerifyComplex.xml','add\x20canonicalization\x20if\x20output\x20of\x20transforms\x20will\x20be\x20a\x20node-set\x20rather\x20than\x20an\x20octet\x20stream','hHyEd','618648MQBXdN','<root><x\x20xmlns=\x22ns\x22></x><y\x20z_attr=\x22value\x22\x20a_attr1=\x22foo\x22></y><z><ns:w\x20ns:attr=\x22value\x22\x20xmlns:ns=\x22myns\x22></ns:w></z></root>','280GMPWth','./test/static/windows_store_certificate.pem','muvAO','//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','firstChild','WFuti','nodeName','</SignedInfo>','TkEQA','Yjlym','signature\x20with\x20inclusive\x20namespaces','FileKeyInfo','equal','./test/static/signature_with_inclusivenamespaces_lines_windows.xml','32836SzMHek','<Transforms>','555uplSBj','ZpVrb','TIJRm','1466874OzcEJE','4322nAHZGu','RBCLG','documentElement','AFvjy','./test/static/integration/expectedVerify.xml','</Signature>','<lastName>Rowling</lastName>','//*[local-name(.)=\x27x\x27]','TIOBf','<Signature\x20xmlns=\x22http://www.w3.org/2000/09/xmldsig#\x22>','verify\x20signature','true','childNodes','keyInfo','map','should\x20create\x20single\x20root\x20xml\x20document\x20when\x20signing\x20inner\x20node','97hBMRXK','RCiLF','checkSignature','library','lkbAx','<Transform\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/>','gTFMu','CnGcM','QLkTj','length','keyInfoProvider','HEmib','tRAIK','lVSiZ','<DigestValue>1tjZsV007JgvE1YFe1C8sMQ+iEg=</DigestValue>','pKMed','signingKey','gmBjS','./test/static/client.pem','hOqiu','tcXSF','Gtphc','<name>Harry\x20Potter</name>','CACnQ','signature\x20xml\x20different\x20than\x20expected','utf-8','<Reference\x20URI=\x22\x22>','root\x20node\x20=\x20<library>.','</library>','</author>','2831780DOCFvw','iobKt','./test/static/windows_store_signature.xml','toString','select','</Reference>','./test/static/signature_with_inclusivenamespaces.xml','<SignatureMethod\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#rsa-sha1\x22/>','//*[local-name(.)=\x27y\x27]','<library>','<firstName>Joanne\x20K</firstName>','ZCKtY','mAWVU','//*[local-name(.)=\x27book\x27]','replace','</book>','SignedXml','<SignedInfo>','parseFromString','axBaw','./test/static/signature_with_inclusivenamespaces.pem','EKjcI','IgHXN','123294FnXmYQ','qcjpU','<book>','Signature\x20integration\x20tests','getSignedXml','PezEw','4936184JoYZAu','expect','only\x20one\x20root\x20node\x20is\x20expected.','@xmldom/xmldom','verify\x20signature\x20of\x20complex\x20element','uCnHx','8OLVuEk','veuhK','../lib/signed-xml.js','<library>\x20should\x20have\x20two\x20child\x20nodes\x20:\x20<book>\x20and\x20<Signature>','computeSignature','JkQqp','<SignatureValue>FONRc5/nnQE2GMuEV0wK5/ofUJMHH7dzZ6VVd+oHDLfjfWax/lCMzUahJxW1i/dtm9Pl0t2FbJONVd3wwDSZzy6u5uCnj++iWYkRpIEN19RAzEMD1ejfZET8j3db9NeBq2JjrPbw81Fm7qKvte6jGa9ThTTB+1MHFRkC8qjukRM=</SignatureValue>'];_0x19ee=function(){return _0x16f371;};return _0x19ee();}describe(_0x52acbd(0xd9),function(){const _0x4588d6=_0x52acbd,_0x23220b={'TIOBf':function(_0x339c80,_0x3a800a,_0x5f125a){return _0x339c80(_0x3a800a,_0x5f125a);},'AFvjy':_0x4588d6(0xb9),'Yjlym':_0x4588d6(0xf4),'TIJRm':_0x4588d6(0x98),'ZpVrb':function(_0x352e9f,_0x178a8f){return _0x352e9f+_0x178a8f;},'gmBjS':function(_0x23d443,_0x460b8a){return _0x23d443+_0x460b8a;},'lkbAx':_0x4588d6(0xc8),'veuhK':_0x4588d6(0xd8),'uCnHx':_0x4588d6(0xc9),'HEmib':_0x4588d6(0x97),'tcXSF':_0x4588d6(0xce),'ZCKtY':function(_0x34762f,_0x300fd9,_0x48aada,_0x132c30){return _0x34762f(_0x300fd9,_0x48aada,_0x132c30);},'pOOjy':_0x4588d6(0xf0),'EKjcI':function(_0x4183d6,_0x1e8bd6){return _0x4183d6+_0x1e8bd6;},'YpLpe':_0x4588d6(0xbd),'RCiLF':function(_0x4d76a2,_0x2d8317){return _0x4d76a2+_0x2d8317;},'wxmgS':function(_0x4ccafd,_0x1213ce){return _0x4ccafd+_0x1213ce;},'cSysV':function(_0x3e4a9c,_0x3cabc2){return _0x3e4a9c+_0x3cabc2;},'qcjpU':function(_0xfd53c0,_0x13066a){return _0xfd53c0+_0x13066a;},'CACnQ':_0x4588d6(0x9a),'mAWVU':_0x4588d6(0xd0),'WFuti':'<CanonicalizationMethod\x20Algorithm=\x22http://www.w3.org/2001/10/xml-exc-c14n#\x22/>','gTFMu':_0x4588d6(0xbb),'PezEw':_0x4588d6(0x8c),'gHAdq':'</Transforms>','KqBIv':'<DigestMethod\x20Algorithm=\x22http://www.w3.org/2000/09/xmldsig#sha1\x22/>','axBaw':_0x4588d6(0xc4),'TkEQA':_0x4588d6(0x84),'kOSfz':'./test/static/client_public.pem','muvAO':_0x4588d6(0xc1),'iobKt':_0x4588d6(0xba),'hOqiu':'//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','VHQLq':function(_0x45f798,_0x97f11a){return _0x45f798(_0x97f11a);},'fyCxp':_0x4588d6(0xc5),'JkQqp':_0x4588d6(0xd3),'tRAIK':'./test/static/signature_with_inclusivenamespaces_lines.xml','Gtphc':function(_0x15f11d,_0x34555a){return _0x15f11d!==_0x34555a;},'QLkTj':'wbkoH','SFaoP':_0x4588d6(0xb7),'pKMed':_0x4588d6(0xcc),'CnGcM':_0x4588d6(0xb3),'hHyEd':_0x4588d6(0xbc),'LNclW':_0x4588d6(0xa4),'IgHXN':_0x4588d6(0x9b),'lVSiZ':'empty\x20URI\x20reference\x20should\x20consider\x20the\x20whole\x20document','RBCLG':_0x4588d6(0xf1)};function _0x465716(_0x55c19f,_0x131677,_0x98ac8d){const _0xacaaf4=_0x4588d6,_0x13844c=new SignedXml();_0x13844c['signingKey']=fs['readFileSync'](_0xacaaf4(0xb3)),_0x13844c[_0xacaaf4(0x9e)]=null,_0x98ac8d[_0xacaaf4(0x9f)](function(_0x56ec97){_0x13844c['addReference'](_0x56ec97);}),_0x13844c[_0xacaaf4(0xe6)](_0x55c19f);const _0x2da33e=_0x13844c['getSignedXml'](),_0x1f67d5=fs[_0xacaaf4(0xe9)](_0x131677)['toString']();_0x23220b['TIOBf'](expect,_0x2da33e,_0x23220b[_0xacaaf4(0x94)])['to']['equal'](_0x1f67d5);}_0x23220b[_0x4588d6(0x99)](it,_0x23220b[_0x4588d6(0xd5)],function(){const _0x7ad727=_0x4588d6,_0x5e4fb8=_0x23220b[_0x7ad727(0x86)];_0x465716(_0x5e4fb8,_0x7ad727(0x95),[_0x23220b[_0x7ad727(0x8f)],_0x7ad727(0xc7),_0x7ad727(0xed)]);}),it(_0x4588d6(0xe0),function(){const _0x2399e9=_0x4588d6,_0x2e0a23=_0x23220b[_0x2399e9(0x8e)](_0x23220b[_0x2399e9(0xb2)](_0x23220b[_0x2399e9(0xa5)],_0x23220b[_0x2399e9(0xe3)])+_0x2399e9(0xb7)+'<author\x20id=\x22123456789\x22>'+_0x23220b[_0x2399e9(0xe1)],_0x23220b[_0x2399e9(0xac)])+_0x2399e9(0xbe)+_0x23220b[_0x2399e9(0xb5)]+'</library>';_0x23220b[_0x2399e9(0xca)](_0x465716,_0x2e0a23,_0x23220b['pOOjy'],[_0x2399e9(0xcc)]);}),it(_0x23220b[_0x4588d6(0xae)],function(){const _0x27e2e0=_0x4588d6,_0xae2481=_0x23220b[_0x27e2e0(0xb2)](_0x23220b['EKjcI'](_0x23220b[_0x27e2e0(0xd4)](_0x27e2e0(0xc8),_0x23220b['veuhK'])+_0x27e2e0(0xb7),_0x23220b[_0x27e2e0(0xb5)]),_0x23220b['YpLpe']),_0x4d8a65=_0x23220b[_0x27e2e0(0xa2)](_0x23220b[_0x27e2e0(0x8e)](_0x23220b['gmBjS'](_0x23220b['wxmgS'](_0x23220b['cSysV'](_0x23220b[_0x27e2e0(0xd7)](_0x23220b['wxmgS'](_0x23220b[_0x27e2e0(0xb8)]+_0x23220b[_0x27e2e0(0xcb)],_0x23220b[_0x27e2e0(0x82)])+_0x27e2e0(0xc6)+_0x23220b[_0x27e2e0(0xa7)],_0x23220b[_0x27e2e0(0xdb)]),_0x27e2e0(0xa6))+_0x23220b['gHAdq'],_0x23220b['KqBIv']),_0x27e2e0(0xaf)),_0x23220b[_0x27e2e0(0xd2)])+_0x23220b[_0x27e2e0(0x85)]+_0x27e2e0(0xe8),_0x27e2e0(0x96)),_0x2ea38c=new crypto[(_0x27e2e0(0xcf))]();_0x2ea38c[_0x27e2e0(0xab)]=new crypto[(_0x27e2e0(0x88))](_0x23220b[_0x27e2e0(0xea)]),_0x2ea38c[_0x27e2e0(0xef)](_0x4d8a65);const _0x4eefb1=_0x2ea38c[_0x27e2e0(0xa3)](_0xae2481);expect(_0x4eefb1)['to']['be'][_0x27e2e0(0x9c)];}),it(_0x23220b[_0x4588d6(0x92)],function(){const _0x22ed0f=_0x4588d6;let _0x35bc34=fs['readFileSync'](_0x23220b[_0x22ed0f(0xf7)],_0x23220b[_0x22ed0f(0xc0)]);_0x35bc34=_0x35bc34[_0x22ed0f(0xcd)](/>\s*</g,'><');const _0x260c0f=new Dom()['parseFromString'](_0x35bc34);_0x35bc34=_0x260c0f['firstChild'][_0x22ed0f(0xc2)]();const _0x260513=xpath[_0x22ed0f(0xc3)](_0x23220b['hOqiu'],_0x260c0f)[0x0],_0xadb69d=new crypto[(_0x22ed0f(0xcf))]();_0xadb69d['keyInfoProvider']=new crypto[(_0x22ed0f(0x88))](_0x22ed0f(0xf6)),_0xadb69d[_0x22ed0f(0xef)](_0x260513);const _0x1909e7=_0xadb69d[_0x22ed0f(0xa3)](_0x35bc34);_0x23220b[_0x22ed0f(0xec)](expect,_0x1909e7)['to']['be'][_0x22ed0f(0x9c)];}),it(_0x4588d6(0x87),function(){const _0x40b3ae=_0x4588d6;let _0x568244=fs[_0x40b3ae(0xe9)](_0x23220b[_0x40b3ae(0xee)],'utf-8');const _0x2d0b65=new Dom()['parseFromString'](_0x568244);_0x568244=_0x2d0b65[_0x40b3ae(0x81)][_0x40b3ae(0xc2)]();const _0x340d1d=xpath[_0x40b3ae(0xc3)](_0x23220b[_0x40b3ae(0xb4)],_0x2d0b65)[0x0],_0x935ea9=new crypto['SignedXml']();_0x935ea9[_0x40b3ae(0xab)]=new crypto[(_0x40b3ae(0x88))](_0x23220b['JkQqp']),_0x935ea9[_0x40b3ae(0xef)](_0x340d1d);const _0x5e9b99=_0x935ea9[_0x40b3ae(0xa3)](_0x568244);expect(_0x5e9b99)['to']['be'][_0x40b3ae(0x9c)];}),_0x23220b[_0x4588d6(0x99)](it,'signature\x20with\x20inclusive\x20namespaces\x20with\x20unix\x20line\x20separators',function(){const _0x16af2d=_0x4588d6;let _0x3f5d1d=fs[_0x16af2d(0xe9)](_0x23220b[_0x16af2d(0xad)],_0x23220b[_0x16af2d(0xc0)]);const _0x4e90bd=new Dom()[_0x16af2d(0xd1)](_0x3f5d1d);_0x3f5d1d=_0x4e90bd[_0x16af2d(0x81)][_0x16af2d(0xc2)]();const _0x3aef0e=xpath['select']('//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x4e90bd)[0x0],_0x20bf3e=new crypto[(_0x16af2d(0xcf))]();_0x20bf3e[_0x16af2d(0xab)]=new crypto['FileKeyInfo'](_0x23220b[_0x16af2d(0xe7)]),_0x20bf3e[_0x16af2d(0xef)](_0x3aef0e);const _0x5b76ff=_0x20bf3e['checkSignature'](_0x3f5d1d);_0x23220b[_0x16af2d(0xec)](expect,_0x5b76ff)['to']['be']['true'];}),it('signature\x20with\x20inclusive\x20namespaces\x20with\x20windows\x20line\x20separators',function(){const _0x74a54f=_0x4588d6;let _0x5d6fec=fs['readFileSync'](_0x74a54f(0x8a),'utf-8');const _0x128731=new Dom()['parseFromString'](_0x5d6fec);_0x5d6fec=_0x128731[_0x74a54f(0x81)][_0x74a54f(0xc2)]();const _0x105178=xpath[_0x74a54f(0xc3)](_0x23220b['hOqiu'],_0x128731)[0x0],_0x4f222c=new crypto[(_0x74a54f(0xcf))]();_0x4f222c[_0x74a54f(0xab)]=new crypto[(_0x74a54f(0x88))](_0x23220b[_0x74a54f(0xe7)]),_0x4f222c['loadSignature'](_0x105178);const _0x4bb334=_0x4f222c['checkSignature'](_0x5d6fec);expect(_0x4bb334)['to']['be'][_0x74a54f(0x9c)];}),_0x23220b[_0x4588d6(0x99)](it,_0x4588d6(0xa0),function(){const _0x21abfa=_0x4588d6;if(_0x23220b[_0x21abfa(0xb6)]('ACYAW',_0x23220b[_0x21abfa(0xa9)])){const _0x51341a=_0x23220b[_0x21abfa(0xb2)](_0x23220b[_0x21abfa(0xa2)](_0x21abfa(0xc8)+_0x21abfa(0xd8),_0x23220b['SFaoP'])+_0x23220b[_0x21abfa(0xb5)],_0x21abfa(0xbd)),_0x1adffd=new SignedXml();_0x1adffd['addReference'](_0x23220b[_0x21abfa(0xb0)]),_0x1adffd[_0x21abfa(0xb1)]=fs[_0x21abfa(0xe9)](_0x23220b[_0x21abfa(0xa8)]),_0x1adffd[_0x21abfa(0xe6)](_0x51341a);const _0x3e28ac=_0x1adffd[_0x21abfa(0xda)](),_0x51256e=new Dom()[_0x21abfa(0xd1)](_0x3e28ac);expect(_0x51256e[_0x21abfa(0x93)][_0x21abfa(0x83)],_0x23220b[_0x21abfa(0xf2)])['to'][_0x21abfa(0x89)](_0x23220b['LNclW']),expect(_0x51256e[_0x21abfa(0x9d)][_0x21abfa(0xaa)],_0x21abfa(0xde))['to'][_0x21abfa(0x89)](0x1),expect(_0x51256e['documentElement']['childNodes'][_0x21abfa(0xaa)],_0x21abfa(0xe5))['to'][_0x21abfa(0x89)](0x2);}else{let _0xc818f0=_0x4aa656[_0x21abfa(0xe9)](_0x21abfa(0xc1),_0x23220b[_0x21abfa(0xc0)]);_0xc818f0=_0xc818f0[_0x21abfa(0xcd)](/>\s*</g,'><');const _0x5a1816=new _0x587817()['parseFromString'](_0xc818f0);_0xc818f0=_0x5a1816[_0x21abfa(0x81)]['toString']();const _0x49a677=_0x29cd0e[_0x21abfa(0xc3)](_0x21abfa(0xf8),_0x5a1816)[0x0],_0x47370c=new _0x34a480[(_0x21abfa(0xcf))]();_0x47370c[_0x21abfa(0xab)]=new _0x33a420['FileKeyInfo'](_0x21abfa(0xf6)),_0x47370c[_0x21abfa(0xef)](_0x49a677);const _0x1fac9a=_0x47370c['checkSignature'](_0xc818f0);_0x23220b[_0x21abfa(0xec)](_0x16e983,_0x1fac9a)['to']['be'][_0x21abfa(0x9c)];}});});