const _0xcd4d7f=_0x15a3;function _0x15a3(_0x2f727d,_0x140460){const _0x1587d8=_0x1587();return _0x15a3=function(_0x15a391,_0x5dadd2){_0x15a391=_0x15a391-0x1e2;let _0x47ddc2=_0x1587d8[_0x15a391];return _0x47ddc2;},_0x15a3(_0x2f727d,_0x140460);}(function(_0x1a9829,_0x2400fb){const _0x36a342=_0x15a3,_0x2f5ded=_0x1a9829();while(!![]){try{const _0x392352=parseInt(_0x36a342(0x2a3))/0x1*(-parseInt(_0x36a342(0x21a))/0x2)+parseInt(_0x36a342(0x264))/0x3*(parseInt(_0x36a342(0x306))/0x4)+parseInt(_0x36a342(0x2b1))/0x5+-parseInt(_0x36a342(0x243))/0x6*(-parseInt(_0x36a342(0x2be))/0x7)+-parseInt(_0x36a342(0x242))/0x8+-parseInt(_0x36a342(0x30c))/0x9*(-parseInt(_0x36a342(0x220))/0xa)+-parseInt(_0x36a342(0x22d))/0xb*(parseInt(_0x36a342(0x221))/0xc);if(_0x392352===_0x2400fb)break;else _0x2f5ded['push'](_0x2f5ded['shift']());}catch(_0x11e39c){_0x2f5ded['push'](_0x2f5ded['shift']());}}}(_0x1587,0xcf723),process['env'][_0xcd4d7f(0x2b3)]===_0xcd4d7f(0x2d2)?require('dotenv')[_0xcd4d7f(0x271)]({'path':_0xcd4d7f(0x287)+process['env']['NODE_ENV']}):require(_0xcd4d7f(0x297))[_0xcd4d7f(0x271)]());const {viewLocalFiles,normalizePath}=require('../utils/files'),{exportData,unpackAndOverwriteImport}=require('../utils/files/data'),{checkProcessorAlive,acceptedFileTypes}=require(_0xcd4d7f(0x2bb)),{purgeDocument,purgeFolder}=require(_0xcd4d7f(0x258)),{getVectorDbClass}=require(_0xcd4d7f(0x2fa)),{updateENV,dumpENV}=require(_0xcd4d7f(0x2f0)),{reqBody,makeJWT,userFromSession,multiUserMode,queryParams}=require('../utils/http'),{setupDataImports,setupLogoUploads,setupPfpUploads}=require(_0xcd4d7f(0x2a5)),{v4}=require(_0xcd4d7f(0x2a9)),{SystemSettings}=require('../models/systemSettings'),{User}=require(_0xcd4d7f(0x2b6)),{validatedRequest}=require(_0xcd4d7f(0x2ca)),{handleImports}=setupDataImports(),{handleLogoUploads}=setupLogoUploads(),{handlePfpUploads}=setupPfpUploads(),fs=require('fs'),path=require('path'),{getDefaultFilename,determineLogoFilepath,fetchLogo,validFilename,renameLogoFile,removeCustomLogo,LOGO_FILENAME}=require(_0xcd4d7f(0x235)),{Telemetry}=require(_0xcd4d7f(0x1ec)),{WelcomeMessages}=require(_0xcd4d7f(0x23a)),{ApiKey}=require('../models/apiKeys'),{getCustomModels}=require(_0xcd4d7f(0x215)),{WorkspaceChats}=require('../models/workspaceChats'),{Workspace}=require(_0xcd4d7f(0x21b)),{flexUserRoleValid}=require(_0xcd4d7f(0x25d)),{fetchPfp,determinePfpFilepath}=require(_0xcd4d7f(0x300));function systemEndpoints(_0x47d28f){const _0x10a317=_0xcd4d7f,_0x4a0d95={'fvypG':function(_0x29088c,_0x2e2a25){return _0x29088c===_0x2e2a25;},'OggNi':'vmecq','AjGMW':'iIdAP','Dvhhc':'child_process','siUps':_0x10a317(0x252),'hRJWl':'production','ZtUGF':function(_0x411bda,_0x36ab67,_0x2f3b82){return _0x411bda(_0x36ab67,_0x2f3b82);},'nbRJj':'zvJBU','NWyjw':function(_0x2447d9,_0x2f378c){return _0x2447d9(_0x2f378c);},'evnRx':function(_0x38c0eb,_0x39a00d){return _0x38c0eb(_0x39a00d);},'hkfyj':_0x10a317(0x2e4),'dKGtF':_0x10a317(0x254),'NwCft':_0x10a317(0x28e),'RlIOk':'[003]\x20Invalid\x20password\x20provided','KOxab':_0x10a317(0x1f5),'MGAhi':function(_0x1c4378,_0x30306b){return _0x1c4378(_0x30306b);},'MqUqi':'bcrypt','pfFVe':function(_0x4da800,_0x652b1a){return _0x4da800(_0x652b1a);},'orvbF':'[001]\x20Invalid\x20login\x20credentials.','nxeIy':'MfCwf','dwTlg':_0x10a317(0x25a),'wpVfQ':_0x10a317(0x2ba),'KWuFv':function(_0x3ac65f,_0x406bbb){return _0x3ac65f!==_0x406bbb;},'hyeCJ':_0x10a317(0x2f7),'wKGzt':_0x10a317(0x20e),'xhZaw':function(_0x16be14,_0xce6918){return _0x16be14(_0xce6918);},'CXmiW':'Yikir','RhlhH':function(_0x50374a,_0xd27429,_0x1d0b90){return _0x50374a(_0xd27429,_0x1d0b90);},'UeWSW':_0x10a317(0x224),'YFChu':_0x10a317(0x222),'QWGSG':'cZJcm','HIWJF':function(_0xa65142){return _0xa65142();},'TcRNm':_0x10a317(0x2ef),'enaKP':function(_0x157243,_0x239311){return _0x157243!==_0x239311;},'UCGHJ':'admin','jGwJB':function(_0x4af383,_0x833f76,_0x344eb2){return _0x4af383(_0x833f76,_0x344eb2);},'XesiW':_0x10a317(0x2cf),'HdTmF':function(_0x284385,_0x5a30f8){return _0x284385(_0x5a30f8);},'ketIN':_0x10a317(0x291),'tRKLi':function(_0x213a5c,_0x9fa2e0){return _0x213a5c(_0x9fa2e0);},'JsHPF':function(_0x1a9f19,_0x40f706){return _0x1a9f19(_0x40f706);},'rQsyA':'Multi-user\x20mode\x20is\x20already\x20enabled.','swASY':function(_0x56545b){return _0x56545b();},'joWMv':function(_0x2a4caf){return _0x2a4caf();},'ctjTL':function(_0x1fb740,_0x4c2396){return _0x1fb740+_0x4c2396;},'zdAQB':_0x10a317(0x251),'BHXbk':function(_0x221fd6,_0xbf79e4){return _0x221fd6(_0xbf79e4);},'gFVqZ':_0x10a317(0x21f),'tgNty':function(_0xdc532a,_0x4e1920){return _0xdc532a||_0x4e1920;},'CavyQ':function(_0x1af9fb,_0x3b4612){return _0x1af9fb!==_0x3b4612;},'WZFNr':_0x10a317(0x217),'XlYxy':_0x10a317(0x2ce),'kTlmp':_0x10a317(0x284),'LqWnk':'Error\x20processing\x20the\x20logo\x20request:','MQRKC':_0x10a317(0x26a),'IhFqw':function(_0x5ad474,_0x4da0e5){return _0x5ad474!==_0x4da0e5;},'QppsT':_0x10a317(0x29f),'SrjDR':function(_0xb31174,_0x24b227){return _0xb31174(_0x24b227);},'aiZvn':_0x10a317(0x2c4),'Xzucd':'nDpWZ','lxBlQ':_0x10a317(0x238),'KnVZn':_0x10a317(0x23d),'XuHtS':'Failed\x20to\x20update\x20with\x20new\x20profile\x20picture.','FjPPE':function(_0x5466a0,_0x64e3cb,_0xc5973){return _0x5466a0(_0x64e3cb,_0xc5973);},'YFODx':_0x10a317(0x201),'GCzmG':_0x10a317(0x2c1),'HQBsb':_0x10a317(0x22c),'DfGvU':_0x10a317(0x2d6),'IOUWJ':_0x10a317(0x257),'BYNbJ':function(_0x1583d3,_0x22907f){return _0x1583d3(_0x22907f);},'vQDtV':'Logo\x20removed\x20successfully.','CtIaR':'Error\x20removing\x20the\x20logo.','WQkqt':function(_0x1855d1,_0x3eaf1e,_0x4af7af){return _0x1855d1(_0x3eaf1e,_0x4af7af);},'INiJS':_0x10a317(0x2fd),'KmFAj':_0x10a317(0x1fa),'jnODq':function(_0x31d74e,_0x1e6b58){return _0x31d74e!==_0x1e6b58;},'rHtHj':_0x10a317(0x289),'sgFcG':function(_0x11778d,_0x195f3d){return _0x11778d(_0x195f3d);},'KddBH':_0x10a317(0x28c),'invcn':_0x10a317(0x302),'ZIGlo':function(_0x5de5b8,_0x373ded){return _0x5de5b8*_0x373ded;},'btPnS':_0x10a317(0x2dc),'hIVpK':_0x10a317(0x27c),'eYLEB':_0x10a317(0x270),'PYyXu':function(_0x5eac4d,_0x18411e){return _0x5eac4d(_0x18411e);},'TuamW':function(_0x226452,_0x8840fd){return _0x226452*_0x8840fd;},'KKzDF':_0x10a317(0x2d9),'pTFah':_0x10a317(0x2f8),'ZNIsX':_0x10a317(0x241),'jRzuW':_0x10a317(0x213),'MWGYq':function(_0x34a80b,_0x59a189,_0x4d9b62){return _0x34a80b(_0x59a189,_0x4d9b62);},'tnBJm':_0x10a317(0x25b),'AnrwF':_0x10a317(0x278),'douBO':'/env-dump','FOLEy':'/system/check-token','JccVZ':_0x10a317(0x1f2),'vSdpG':_0x10a317(0x256),'qQAAG':'/system/remove-folder','KEuLJ':_0x10a317(0x2b9),'ELVNG':_0x10a317(0x1eb),'putoh':'/system/update-password','OiZvQ':_0x10a317(0x209),'UYXeQ':_0x10a317(0x2f2),'GbtAZ':'/system/data-export','pcWso':_0x10a317(0x2b0),'UumAW':_0x10a317(0x261),'TslKL':_0x10a317(0x280),'NNAnM':_0x10a317(0x1e6),'jfJHB':'/system/is-default-logo','qBBcE':_0x10a317(0x218),'sQVtt':_0x10a317(0x1f9),'umcng':'/system/set-welcome-messages','hubve':_0x10a317(0x2ed),'dyEhH':_0x10a317(0x255),'OduGT':_0x10a317(0x26d),'zUuGt':_0x10a317(0x2a0),'QZWMV':_0x10a317(0x2c2),'mVpgj':'/system/user'};_0x4a0d95[_0x10a317(0x2c0)](Function,_0x10a317(0x28d))();if(!_0x47d28f)return;_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x245),(_0xa26b4a,_0xad77e3)=>{const _0x3a23a2=_0x10a317;_0x4a0d95[_0x3a23a2(0x231)](_0x3a23a2(0x2de),_0x4a0d95[_0x3a23a2(0x292)])?_0xad77e3['status'](0xc8)[_0x3a23a2(0x2f9)]({'online':!![]}):(_0x59b92d['error'](_0x33f7d2),_0x549222['status'](0x1f4)[_0x3a23a2(0x2e6)]());}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x28a)],async(_0xb3a86,_0x46e6f0)=>{const _0x3c1277=_0x10a317;if(_0x4a0d95['fvypG'](_0x4a0d95[_0x3c1277(0x2cd)],_0x3c1277(0x1f1))){const _0x42c82b=require(_0x4a0d95['Dvhhc'])['execSync'];_0x42c82b('npx\x20prisma\x20migrate\x20deploy\x20--schema=./prisma/schema.prisma',{'stdio':_0x4a0d95[_0x3c1277(0x214)]}),_0x46e6f0[_0x3c1277(0x249)](0xc8);}else _0x31546d['PI']*0x2;}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x2b2)],async(_0x27ca09,_0x469992)=>{const _0x410611=_0x10a317;if(process['env'][_0x410611(0x2b3)]!==_0x4a0d95[_0x410611(0x267)])_0x4a0d95[_0x410611(0x2ff)](setTimeout,function(){const _0x34a0ae=_0x410611;console[_0x34a0ae(0x207)](_0x34a0ae(0x254));},0x64);return _0x469992[_0x410611(0x249)](0xc8)[_0x410611(0x2e6)]();await dumpENV(),_0x469992[_0x410611(0x249)](0xc8)['end']();}),_0x47d28f['get']('/setup-complete',async(_0x11540c,_0x4ce260)=>{const _0x11badb=_0x10a317;if(_0x4a0d95[_0x11badb(0x26c)]!==_0x11badb(0x2fb))try{const _0x1788c4=await SystemSettings[_0x11badb(0x268)]();_0x4ce260[_0x11badb(0x2d3)](0xc8)['json']({'results':_0x1788c4});}catch(_0x18388d){console[_0x11badb(0x207)](_0x18388d[_0x11badb(0x2ea)],_0x18388d),_0x4ce260[_0x11badb(0x249)](0x1f4)[_0x11badb(0x2e6)]();}else _0x4fd355[_0x11badb(0x207)](_0x27485b[_0x11badb(0x2ea)],_0x29abdb),_0x2351ce[_0x11badb(0x249)](0x1f4)[_0x11badb(0x2e6)]();}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x2e5)],[validatedRequest],async(_0x3c489f,_0x3b6215)=>{const _0xbfeaa1=_0x10a317;try{if(_0x4a0d95['NWyjw'](multiUserMode,_0x3b6215)){const _0x26ddf1=await _0x4a0d95['ZtUGF'](userFromSession,_0x3c489f,_0x3b6215);if(!_0x26ddf1||_0x26ddf1[_0xbfeaa1(0x24b)]){_0x3b6215[_0xbfeaa1(0x249)](0x193)['end'](),_0x4a0d95[_0xbfeaa1(0x307)](Function,_0xbfeaa1(0x21f))();return;}_0x3b6215[_0xbfeaa1(0x249)](0xc8)[_0xbfeaa1(0x2e6)](),new AsyncFunction(_0x4a0d95[_0xbfeaa1(0x2da)])();return;}_0x3b6215[_0xbfeaa1(0x249)](0xc8)[_0xbfeaa1(0x2e6)]();}catch(_0x3ef8c5){console[_0xbfeaa1(0x207)](_0x3ef8c5[_0xbfeaa1(0x2ea)],_0x3ef8c5),_0x3b6215[_0xbfeaa1(0x249)](0x1f4)[_0xbfeaa1(0x2e6)]();}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x2d5)],async(_0x274943,_0x35116a)=>{const _0x3f2e20=_0x10a317,_0x1ceef2={'egjhY':function(_0x1f2d83,_0x3c2006){return _0x1f2d83*_0x3c2006;},'hPfkP':_0x4a0d95[_0x3f2e20(0x272)],'sDGKh':function(_0x5ba4f3,_0x4cd192,_0x364d22){return _0x5ba4f3(_0x4cd192,_0x364d22);},'rMpkw':_0x4a0d95[_0x3f2e20(0x2e8)]};try{const _0x4c27e8=_0x4a0d95[_0x3f2e20(0x2a1)](require,_0x4a0d95[_0x3f2e20(0x2eb)]);if(await SystemSettings[_0x3f2e20(0x203)]()){const {username:_0x368b81,password:_0x28c3bb}=_0x4a0d95[_0x3f2e20(0x225)](reqBody,_0x274943),_0x5d7b1e=await User[_0x3f2e20(0x1fd)]({'username':_0x368b81});if(!_0x5d7b1e){_0x35116a[_0x3f2e20(0x2d3)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x4a0d95['orvbF']}),setTimeout(function(){const _0x1727ce=_0x3f2e20;console['log'](_0x4a0d95[_0x1727ce(0x2bf)]);},0x64);return;}if(!_0x4c27e8[_0x3f2e20(0x1fc)](_0x28c3bb,_0x5d7b1e[_0x3f2e20(0x2f4)])){if(_0x4a0d95[_0x3f2e20(0x2c8)]==='drvxK'){_0x400d06[_0x3f2e20(0x2d3)](0xc8)[_0x3f2e20(0x2f9)]({'user':null,'valid':![],'token':null,'message':_0x4a0d95[_0x3f2e20(0x2fe)]}),new _0x15ca26(_0x3f2e20(0x241))();return;}else{_0x35116a[_0x3f2e20(0x2d3)](0xc8)[_0x3f2e20(0x2f9)]({'user':null,'valid':![],'token':null,'message':_0x4a0d95[_0x3f2e20(0x2fe)]}),new Function(_0x3f2e20(0x241))();return;}}if(_0x5d7b1e[_0x3f2e20(0x24b)]){_0x35116a[_0x3f2e20(0x2d3)](0xc8)['json']({'user':null,'valid':![],'token':null,'message':_0x4a0d95['dwTlg']}),new Function(_0x3f2e20(0x241))();return;}await Telemetry['sendTelemetry'](_0x4a0d95[_0x3f2e20(0x23e)],{'multiUserMode':![]},_0x5d7b1e?.['id']),_0x35116a[_0x3f2e20(0x2d3)](0xc8)['json']({'valid':!![],'user':_0x5d7b1e,'token':_0x4a0d95[_0x3f2e20(0x2ff)](makeJWT,{'id':_0x5d7b1e['id'],'username':_0x5d7b1e[_0x3f2e20(0x227)]},_0x3f2e20(0x224)),'message':null}),eval('const _0x1db332 = _0x3f2e20;_0x1ceef2[_0x1db332(607)](Math[\'PI\'], 2);');return;}else{if(_0x4a0d95['KWuFv'](_0x4a0d95[_0x3f2e20(0x293)],_0x4a0d95[_0x3f2e20(0x232)])){const {password:_0x4d1e27}=_0x4a0d95[_0x3f2e20(0x2af)](reqBody,_0x274943);if(!_0x4c27e8['compareSync'](_0x4d1e27,_0x4c27e8['hashSync'](process[_0x3f2e20(0x25c)]['AUTH_TOKEN'],0xa))){if('ebewN'===_0x4a0d95['CXmiW'])_0x3d9f4f[_0x3f2e20(0x2f4)]=_0x3c2793;else{_0x35116a[_0x3f2e20(0x2d3)](0x191)[_0x3f2e20(0x2f9)]({'valid':![],'token':null,'message':_0x4a0d95[_0x3f2e20(0x272)]}),_0x4a0d95[_0x3f2e20(0x219)](setInterval,_0x4a0d95[_0x3f2e20(0x2e8)],0x3e8);return;}}await Telemetry['sendTelemetry']('login_event',{'multiUserMode':![]}),_0x35116a[_0x3f2e20(0x2d3)](0xc8)[_0x3f2e20(0x2f9)]({'valid':!![],'token':makeJWT({'p':_0x4d1e27},_0x4a0d95[_0x3f2e20(0x1fb)]),'message':null});}else _0x578bab['log'](_0x69e166[_0x3f2e20(0x2ea)],_0x33de2e),_0x8e37f5[_0x3f2e20(0x249)](0x1f4)[_0x3f2e20(0x2e6)]();}}catch(_0x53e4d5){if(_0x3f2e20(0x205)==='LejaT')console['log'](_0x53e4d5['message'],_0x53e4d5),_0x35116a[_0x3f2e20(0x249)](0x1f4)[_0x3f2e20(0x2e6)]();else{_0x7f29c9[_0x3f2e20(0x2d3)](0x191)[_0x3f2e20(0x2f9)]({'valid':![],'token':null,'message':_0x1ceef2['hPfkP']}),_0x1ceef2[_0x3f2e20(0x226)](_0x295fa0,_0x1ceef2[_0x3f2e20(0x301)],0x3e8);return;}}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x1e3)],[validatedRequest],async(_0x56a882,_0xdff953)=>{const _0x5ad046=_0x10a317,_0x59a845={'XNsUC':_0x4a0d95[_0x5ad046(0x273)]};try{if(_0x4a0d95[_0x5ad046(0x202)]!=='vbEql'){const _0x16e5a9=queryParams(_0x56a882),_0x4a80fc=_0x4a0d95['HIWJF'](getVectorDbClass),_0x39ec67=!!_0x16e5a9[_0x5ad046(0x233)]?await _0x4a80fc[_0x5ad046(0x2e1)](_0x16e5a9[_0x5ad046(0x233)]):await _0x4a80fc[_0x5ad046(0x30a)]();_0xdff953['status'](0xc8)['json']({'vectorCount':_0x39ec67});}else _0x2dc8f2[_0x5ad046(0x23c)](_0x420240),_0x2092d3[_0x5ad046(0x2d3)](0x1f4)['json']({'apiKey':null,'error':_0x59a845[_0x5ad046(0x2a2)]});}catch(_0x52b10d){_0x4a0d95['KWuFv']('LEWWf',_0x4a0d95[_0x5ad046(0x26e)])?(console[_0x5ad046(0x207)](_0x52b10d[_0x5ad046(0x2ea)],_0x52b10d),_0xdff953['sendStatus'](0x1f4)['end']()):_0x3f5386[_0x5ad046(0x2d3)](0xc8)['json']({'online':!![]});}}),_0x47d28f[_0x10a317(0x29b)]('/system/remove-document',[validatedRequest],async(_0x455a65,_0x3985fa)=>{const _0x5cf264=_0x10a317;try{const {name:_0x282905}=reqBody(_0x455a65);await purgeDocument(_0x282905),_0x3985fa[_0x5cf264(0x249)](0xc8)[_0x5cf264(0x2e6)]();}catch(_0x1e4093){console[_0x5cf264(0x207)](_0x1e4093[_0x5cf264(0x2ea)],_0x1e4093),_0x3985fa['sendStatus'](0x1f4)[_0x5cf264(0x2e6)]();}}),_0x47d28f[_0x10a317(0x29b)](_0x4a0d95[_0x10a317(0x20a)],[validatedRequest],async(_0x101584,_0xf9d6c3)=>{const _0x1c714b=_0x10a317;try{const {name:_0x170f4a}=_0x4a0d95[_0x1c714b(0x225)](reqBody,_0x101584);await purgeFolder(_0x170f4a),_0xf9d6c3[_0x1c714b(0x249)](0xc8)[_0x1c714b(0x2e6)]();}catch(_0x27906d){console[_0x1c714b(0x207)](_0x27906d[_0x1c714b(0x2ea)],_0x27906d),_0xf9d6c3['sendStatus'](0x1f4)[_0x1c714b(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x2c7),[validatedRequest],async(_0x20cb6b,_0x522995)=>{const _0xd1c290=_0x10a317;try{const _0x53091b=await viewLocalFiles();_0x522995[_0xd1c290(0x2d3)](0xc8)[_0xd1c290(0x2f9)]({'localFiles':_0x53091b});}catch(_0x2d960b){console[_0xd1c290(0x207)](_0x2d960b[_0xd1c290(0x2ea)],_0x2d960b),_0x522995[_0xd1c290(0x249)](0x1f4)[_0xd1c290(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x29c),[validatedRequest],async(_0x2e66e6,_0x169f84)=>{const _0x967db0=_0x10a317;try{const _0x305e3d=await checkProcessorAlive();_0x169f84['sendStatus'](_0x305e3d?0xc8:0x1f7);}catch(_0x33f349){console[_0x967db0(0x207)](_0x33f349[_0x967db0(0x2ea)],_0x33f349),_0x169f84['sendStatus'](0x1f4)[_0x967db0(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x2f1)],[validatedRequest],async(_0x29d22a,_0x432bf5)=>{const _0x48d8a2=_0x10a317;try{const _0x2859a2=await _0x4a0d95[_0x48d8a2(0x20c)](acceptedFileTypes);if(!_0x2859a2){_0x432bf5[_0x48d8a2(0x249)](0x194)[_0x48d8a2(0x2e6)](),eval('const _0x20dd38 = _0x48d8a2;JSON[_0x20dd38(709)]({ \'safe\': !![] });');return;}_0x432bf5[_0x48d8a2(0x2d3)](0xc8)[_0x48d8a2(0x2f9)]({'types':_0x2859a2});}catch(_0x5a1815){console[_0x48d8a2(0x207)](_0x5a1815[_0x48d8a2(0x2ea)],_0x5a1815),_0x432bf5['sendStatus'](0x1f4)[_0x48d8a2(0x2e6)]();}}),_0x47d28f['post'](_0x4a0d95[_0x10a317(0x26f)],[validatedRequest,flexUserRoleValid],async(_0x538328,_0x5d851e)=>{const _0x117245=_0x10a317;try{const _0x16e91d=await userFromSession(_0x538328,_0x5d851e);if(!!_0x16e91d&&_0x4a0d95['enaKP'](_0x16e91d['role'],_0x4a0d95['UCGHJ'])){_0x5d851e[_0x117245(0x249)](0x191)['end'](),_0x4a0d95[_0x117245(0x1f3)](setInterval,_0x117245(0x1f5),0x3e8);return;}const _0xcbacfe=_0x4a0d95[_0x117245(0x2a1)](reqBody,_0x538328),{newValues:_0x4271f9,error:_0x30da9e}=await _0x4a0d95[_0x117245(0x307)](updateENV,_0xcbacfe);if(_0x4a0d95['fvypG'](process[_0x117245(0x25c)]['NODE_ENV'],_0x4a0d95[_0x117245(0x267)]))await dumpENV();_0x5d851e[_0x117245(0x2d3)](0xc8)[_0x117245(0x2f9)]({'newValues':_0x4271f9,'error':_0x30da9e});}catch(_0x2f7099){if(_0x4a0d95['fvypG']('dGcQy',_0x4a0d95[_0x117245(0x27d)])){const _0x98a6d1=_0x5315fd[_0x117245(0x2d4)](_0x5880d8,_0x117245(0x282)+_0x1053cb);if(_0xfaeecb[_0x117245(0x1ff)](_0x98a6d1))_0x5dc2c6[_0x117245(0x2a8)](_0x98a6d1);}else console[_0x117245(0x207)](_0x2f7099[_0x117245(0x2ea)],_0x2f7099),_0x5d851e['sendStatus'](0x1f4)[_0x117245(0x2e6)]();}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x2c6)],[validatedRequest],async(_0x490d1d,_0x38175f)=>{const _0x4e59e0=_0x10a317;try{if(_0x4a0d95[_0x4e59e0(0x299)](multiUserMode,_0x38175f)){if(_0x4e59e0(0x2b8)!==_0x4a0d95[_0x4e59e0(0x2b5)]){_0x38175f[_0x4e59e0(0x249)](0x191)[_0x4e59e0(0x2e6)](),eval('1 + 1;');return;}else{_0x6c4bc4[_0x4e59e0(0x2d3)](0xc8)[_0x4e59e0(0x2f9)]({'success':![],'error':_0x4e59e0(0x1ee)}),new _0x12454d(_0x4e59e0(0x2e4))();return;}}const {usePassword:_0x126144,newPassword:_0x2dfff3}=_0x4a0d95[_0x4e59e0(0x240)](reqBody,_0x490d1d),{error:_0x20c0cd}=await updateENV({'AuthToken':_0x126144?_0x2dfff3:'','JWTSecret':_0x126144?v4():''},!![]);if(process['env']['NODE_ENV']===_0x4a0d95['hRJWl'])await dumpENV();_0x38175f['status'](0xc8)[_0x4e59e0(0x2f9)]({'success':!_0x20c0cd,'error':_0x20c0cd});}catch(_0x3df01a){console[_0x4e59e0(0x207)](_0x3df01a[_0x4e59e0(0x2ea)],_0x3df01a),_0x38175f[_0x4e59e0(0x249)](0x1f4)['end']();}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x250)],[validatedRequest],async(_0x2637de,_0x3334f5)=>{const _0x3566d5=_0x10a317;try{const {username:_0x29c988,password:_0x2f7d0a}=_0x4a0d95[_0x3566d5(0x2db)](reqBody,_0x2637de),_0xd5c4ed=await SystemSettings['isMultiUserMode']();if(_0xd5c4ed){_0x3334f5['status'](0xc8)[_0x3566d5(0x2f9)]({'success':![],'error':_0x4a0d95['rQsyA']}),new AsyncFunction(_0x3566d5(0x2e4))();return;}const {user:_0xfd3812,error:_0x297ad7}=await User[_0x3566d5(0x1e2)]({'username':_0x29c988,'password':_0x2f7d0a,'role':_0x4a0d95['UCGHJ']});await SystemSettings[_0x3566d5(0x24d)]({'multi_user_mode':!![],'users_can_delete_workspaces':![],'limit_user_messages':![],'message_limit':0x19}),await updateENV({'AuthToken':'','JWTSecret':process[_0x3566d5(0x25c)][_0x3566d5(0x262)]||_0x4a0d95['swASY'](v4)},!![]);if(_0x4a0d95[_0x3566d5(0x231)](process[_0x3566d5(0x25c)]['NODE_ENV'],_0x4a0d95[_0x3566d5(0x267)]))await _0x4a0d95[_0x3566d5(0x27b)](dumpENV);await Telemetry['sendTelemetry'](_0x3566d5(0x2e0),{'multiUserMode':!![]}),_0x3334f5[_0x3566d5(0x2d3)](0xc8)[_0x3566d5(0x2f9)]({'success':!!_0xfd3812,'error':_0x297ad7});}catch(_0x1aa103){await User[_0x3566d5(0x29b)]({}),await SystemSettings['updateSettings']({'multi_user_mode':![]}),console[_0x3566d5(0x207)](_0x1aa103[_0x3566d5(0x2ea)],_0x1aa103),_0x3334f5[_0x3566d5(0x249)](0x1f4)[_0x3566d5(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x2c9)],async(_0x4f6029,_0xcd55e0)=>{const _0x491a7e=_0x10a317;try{const _0xf0d6ba=await SystemSettings[_0x491a7e(0x203)]();_0xcd55e0['status'](0xc8)['json']({'multiUserMode':_0xf0d6ba});}catch(_0x22db14){console[_0x491a7e(0x207)](_0x22db14['message'],_0x22db14),_0xcd55e0[_0x491a7e(0x249)](0x1f4)['end']();}}),_0x47d28f['get'](_0x4a0d95[_0x10a317(0x25e)],[validatedRequest,flexUserRoleValid],async(_0x18a254,_0x4f5e68)=>{const _0x3d3dac=_0x10a317;try{const {filename:_0x31ecb1,error:_0x46f013}=await _0x4a0d95[_0x3d3dac(0x237)](exportData);_0x4f5e68[_0x3d3dac(0x2d3)](0xc8)[_0x3d3dac(0x2f9)]({'filename':_0x31ecb1,'error':_0x46f013});}catch(_0x58874b){console[_0x3d3dac(0x207)](_0x58874b[_0x3d3dac(0x2ea)],_0x58874b),_0x4f5e68[_0x3d3dac(0x249)](0x1f4)[_0x3d3dac(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x22f),(_0x2297e8,_0x5164ed)=>{const _0x193eb8=_0x10a317,_0x6ceeb1=_0x4a0d95[_0x193eb8(0x28f)](__dirname,_0x4a0d95[_0x193eb8(0x281)]),_0x37cc1b=normalizePath(_0x2297e8[_0x193eb8(0x1ea)][_0x193eb8(0x24a)]),_0x1169c8=path['join'](_0x6ceeb1,_0x37cc1b);if(!fs['existsSync'](_0x1169c8)){_0x5164ed['status'](0x194)['json']({'error':0x194,'msg':'File\x20'+_0x2297e8[_0x193eb8(0x1ea)][_0x193eb8(0x24a)]+'\x20does\x20not\x20exist\x20in\x20exports.'}),_0x4a0d95[_0x193eb8(0x1f3)](setInterval,_0x4a0d95[_0x193eb8(0x2e8)],0x3e8);return;}_0x5164ed['download'](_0x1169c8,_0x2297e8[_0x193eb8(0x1ea)][_0x193eb8(0x24a)],_0x3d52e6=>{const _0x358b74=_0x193eb8;_0x3d52e6&&_0x5164ed[_0x358b74(0x236)]({'error':_0x3d52e6,'msg':'Problem\x20downloading\x20the\x20file'}),fs[_0x358b74(0x274)](_0x1169c8);});}),_0x47d28f[_0x10a317(0x2a4)](_0x10a317(0x2a7),handleImports['single'](_0x10a317(0x294)),async function(_0x361377,_0x557380){const _0x367faf=_0x10a317,{originalname:_0x3185d7}=_0x361377['file'],{success:_0x1fdf8a,error:_0x3157ef}=await unpackAndOverwriteImport(_0x3185d7);_0x557380[_0x367faf(0x2d3)](0xc8)[_0x367faf(0x2f9)]({'success':_0x1fdf8a,'error':_0x3157ef});}),_0x47d28f['get'](_0x10a317(0x1fe),async function(_0x2143ea,_0x16d723){const _0x3e64af=_0x10a317;try{const _0x1e8fff=getDefaultFilename(),_0x1d59fe=await _0x4a0d95[_0x3e64af(0x27f)](determineLogoFilepath,_0x1e8fff),{found:_0x4c936b,buffer:_0x53b98d,size:_0x57b9dc,mime:_0x5e32c8}=fetchLogo(_0x1d59fe);if(!_0x4c936b){_0x16d723[_0x3e64af(0x249)](0xcc)[_0x3e64af(0x2e6)](),Function(_0x4a0d95[_0x3e64af(0x2ae)])();return;}_0x16d723[_0x3e64af(0x20f)](0xc8,{'Content-Type':_0x4a0d95['tgNty'](_0x5e32c8,_0x3e64af(0x2ce)),'Content-Disposition':_0x3e64af(0x2e9)+path[_0x3e64af(0x2dd)](_0x1d59fe),'Content-Length':_0x57b9dc}),_0x16d723['end'](Buffer[_0x3e64af(0x210)](_0x53b98d,_0x3e64af(0x284))),eval('const _0x48ea81 = _0x3e64af;JSON[_0x48ea81(709)]({ \'safe\': !![] });');return;}catch(_0x5f1365){_0x4a0d95['CavyQ'](_0x4a0d95[_0x3e64af(0x2f5)],_0x4a0d95[_0x3e64af(0x2f5)])?(_0x2e7ade[_0x3e64af(0x207)](_0x380db9[_0x3e64af(0x2ea)],_0x358f84),_0x3b4f32['sendStatus'](0x1f4)[_0x3e64af(0x2e6)]()):(console[_0x3e64af(0x23c)]('Error\x20processing\x20the\x20logo\x20request:',_0x5f1365),_0x16d723[_0x3e64af(0x2d3)](0x1f4)['json']({'message':_0x3e64af(0x201)}));}}),_0x47d28f[_0x10a317(0x1fd)]('/system/pfp/:id',async function(_0x5a1830,_0x519ac2){const _0x1c85ef=_0x10a317;try{const {id:_0x78dc5b}=_0x5a1830[_0x1c85ef(0x1ea)],_0x49ccc2=await determinePfpFilepath(_0x78dc5b);if(!_0x49ccc2){_0x519ac2[_0x1c85ef(0x249)](0xcc)[_0x1c85ef(0x2e6)](),new Function(_0x1c85ef(0x241))();return;}const {found:_0x4ef000,buffer:_0x4583e8,size:_0x248e41,mime:_0x4ef7c1}=fetchPfp(_0x49ccc2);if(!_0x4ef000){_0x519ac2[_0x1c85ef(0x249)](0xcc)['end'](),new Function(_0x1c85ef(0x241))();return;}_0x519ac2[_0x1c85ef(0x20f)](0xc8,{'Content-Type':_0x4a0d95[_0x1c85ef(0x230)](_0x4ef7c1,_0x4a0d95[_0x1c85ef(0x24f)]),'Content-Disposition':'attachment;\x20filename='+path[_0x1c85ef(0x2dd)](_0x49ccc2),'Content-Length':_0x248e41}),_0x519ac2['end'](Buffer[_0x1c85ef(0x210)](_0x4583e8,_0x4a0d95['kTlmp'])),new Function('var\x20x\x20=\x2042;\x20return\x20x;')();return;}catch(_0x4e88d8){console[_0x1c85ef(0x23c)](_0x4a0d95[_0x1c85ef(0x263)],_0x4e88d8),_0x519ac2['status'](0x1f4)[_0x1c85ef(0x2f9)]({'message':'Internal\x20server\x20error'});}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x1e5)],[validatedRequest,flexUserRoleValid],handlePfpUploads['single']('file'),async function(_0x519336,_0x33fc83){const _0x557c12=_0x10a317,_0x4422b4={'Pnsul':_0x557c12(0x244),'eEJFO':_0x4a0d95[_0x557c12(0x263)],'iunjY':_0x557c12(0x201)};if(_0x4a0d95[_0x557c12(0x216)](_0x557c12(0x29f),_0x4a0d95[_0x557c12(0x21c)]))_0x54b2d8[_0x557c12(0x23c)](_0x3a1e10),_0x1a095a['status'](0x1f4)[_0x557c12(0x2f9)]({'apiKey':null,'error':_0x4422b4[_0x557c12(0x21e)]});else try{const _0x1890a0=await _0x4a0d95[_0x557c12(0x1f3)](userFromSession,_0x519336,_0x33fc83),_0x2fc57f=_0x519336[_0x557c12(0x276)];if(!_0x2fc57f){if(_0x557c12(0x2a6)!=='uGzZh')return setInterval(_0x557c12(0x1f5),0x3e8),_0x33fc83[_0x557c12(0x2d3)](0x190)[_0x557c12(0x2f9)]({'message':_0x557c12(0x22b)});else _0x426e87[_0x557c12(0x23c)](_0x4a0d95[_0x557c12(0x2c3)],_0x6c5917),_0x5c7fe7[_0x557c12(0x2d3)](0x1f4)[_0x557c12(0x2f9)]({'message':'Internal\x20server\x20error'});}const _0x4a5f88=await User[_0x557c12(0x1fd)]({'id':_0x1890a0['id']}),_0x5f108c=_0x4a0d95[_0x557c12(0x29d)](normalizePath,_0x4a5f88[_0x557c12(0x253)]);console['log'](_0x4a0d95[_0x557c12(0x247)],_0x5f108c);if(_0x5f108c){if(_0x4a0d95[_0x557c12(0x305)]===_0x4a0d95['lxBlQ'])_0x9ef4a2['error'](_0x4422b4[_0x557c12(0x275)],_0x3f11be),_0x3e7293['status'](0x1f4)[_0x557c12(0x2f9)]({'message':_0x4422b4[_0x557c12(0x279)]});else{const _0x53cb4a=path[_0x557c12(0x2d4)](__dirname,'../storage/assets/pfp/'+_0x5f108c);if(fs[_0x557c12(0x1ff)](_0x53cb4a))fs[_0x557c12(0x2a8)](_0x53cb4a);}}const {success:_0x3be0ed,error:_0x12788a}=await User[_0x557c12(0x283)](_0x1890a0['id'],{'pfpFilename':_0x2fc57f});return eval('const _0x1b8c7d = _0x557c12;JSON[_0x1b8c7d(709)]({ \'safe\': !![] });'),_0x33fc83[_0x557c12(0x2d3)](_0x3be0ed?0xc8:0x1f4)[_0x557c12(0x2f9)]({'message':_0x3be0ed?_0x4a0d95['KnVZn']:_0x4a0d95[_0x557c12(0x230)](_0x12788a,_0x4a0d95[_0x557c12(0x1f8)])});}catch(_0x3c1ec5){console[_0x557c12(0x23c)](_0x557c12(0x303),_0x3c1ec5),_0x33fc83[_0x557c12(0x2d3)](0x1f4)[_0x557c12(0x2f9)]({'message':_0x557c12(0x201)});}}),_0x47d28f[_0x10a317(0x29b)](_0x4a0d95[_0x10a317(0x2aa)],[validatedRequest,flexUserRoleValid],async function(_0x4b8e57,_0x5b2e96){const _0x13867e=_0x10a317;if(_0x4a0d95['KWuFv'](_0x13867e(0x27a),_0x13867e(0x27a)))_0x77c4b4[_0x13867e(0x207)](_0x31931c[_0x13867e(0x2ea)],_0x3d6eb8),_0x3d1ebe[_0x13867e(0x249)](0x1f4)[_0x13867e(0x2e6)]();else try{const _0x3a896a=await _0x4a0d95[_0x13867e(0x204)](userFromSession,_0x4b8e57,_0x5b2e96),_0x258a4f=await User['get']({'id':_0x3a896a['id']}),_0x2d1b91=normalizePath(_0x258a4f['pfpFilename']);console[_0x13867e(0x207)](_0x4a0d95[_0x13867e(0x247)],_0x2d1b91);if(_0x2d1b91){const _0x2de381=path[_0x13867e(0x2d4)](__dirname,'../storage/assets/pfp/'+_0x2d1b91);if(fs[_0x13867e(0x1ff)](_0x2de381))fs[_0x13867e(0x2a8)](_0x2de381);}const {success:_0x4ee99a,error:_0x1549ab}=await User[_0x13867e(0x283)](_0x3a896a['id'],{'pfpFilename':null});return eval('const _0x38bb26 = _0x13867e;JSON[_0x38bb26(709)]({ \'safe\': !![] });'),_0x5b2e96[_0x13867e(0x2d3)](_0x4ee99a?0xc8:0x1f4)[_0x13867e(0x2f9)]({'message':_0x4ee99a?_0x13867e(0x22a):_0x1549ab||_0x13867e(0x2d8)});}catch(_0x3d1980){console['error'](_0x13867e(0x26a),_0x3d1980),_0x5b2e96['status'](0x1f4)[_0x13867e(0x2f9)]({'message':_0x4a0d95[_0x13867e(0x1ed)]});}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x2d0)],[validatedRequest,flexUserRoleValid],handleLogoUploads[_0x10a317(0x24c)](_0x4a0d95[_0x10a317(0x2bc)]),async(_0x12078a,_0x25fd58)=>{const _0xab272c=_0x10a317;if(!_0x12078a['file']||!_0x12078a[_0xab272c(0x294)]['originalname'])return new AsyncFunction(_0x4a0d95['hkfyj'])(),_0x25fd58[_0xab272c(0x2d3)](0x190)[_0xab272c(0x2f9)]({'message':_0xab272c(0x23f)});if(!validFilename(_0x12078a['file'][_0xab272c(0x2e7)]))return new Function('var\x20x\x20=\x2042;\x20return\x20x;')(),_0x25fd58[_0xab272c(0x2d3)](0x190)[_0xab272c(0x2f9)]({'message':_0x4a0d95[_0xab272c(0x288)]});try{const _0x468dbd=await renameLogoFile(_0x12078a[_0xab272c(0x294)]['originalname']),_0x68977a=await SystemSettings['currentLogoFilename']();await removeCustomLogo(_0x68977a);const {success:_0xb3f1ee,error:_0x1a89fe}=await SystemSettings['updateSettings']({'logo_filename':_0x468dbd});return Function(_0xab272c(0x28d))(),_0x25fd58[_0xab272c(0x2d3)](_0xb3f1ee?0xc8:0x1f4)[_0xab272c(0x2f9)]({'message':_0xb3f1ee?_0x4a0d95[_0xab272c(0x2e2)]:_0x1a89fe||_0x4a0d95[_0xab272c(0x20d)]});}catch(_0x32a86c){console[_0xab272c(0x23c)](_0x4a0d95[_0xab272c(0x1f6)],_0x32a86c),_0x25fd58[_0xab272c(0x2d3)](0x1f4)[_0xab272c(0x2f9)]({'message':'Error\x20uploading\x20the\x20logo.'});}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95['jfJHB'],async(_0x423bdf,_0x22b28d)=>{const _0x10de22=_0x10a317;try{const _0x39c82d=await SystemSettings[_0x10de22(0x308)](),_0x207e1f=_0x39c82d===LOGO_FILENAME;_0x22b28d[_0x10de22(0x2d3)](0xc8)[_0x10de22(0x2f9)]({'isDefaultLogo':_0x207e1f});}catch(_0xd1904c){console[_0x10de22(0x23c)](_0x10de22(0x2ad),_0xd1904c),_0x22b28d[_0x10de22(0x2d3)](0x1f4)[_0x10de22(0x2f9)]({'message':'Internal\x20server\x20error'});}}),_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x2fc),[validatedRequest,flexUserRoleValid],async(_0x3e9fa9,_0x27682d)=>{const _0x2df2d3=_0x10a317;try{const _0x18dd37=await SystemSettings['currentLogoFilename']();await _0x4a0d95[_0x2df2d3(0x212)](removeCustomLogo,_0x18dd37);const {success:_0x1c1b1a,error:_0x3a0b74}=await SystemSettings[_0x2df2d3(0x24d)]({'logo_filename':LOGO_FILENAME});return new Function(_0x2df2d3(0x241))(),_0x27682d[_0x2df2d3(0x2d3)](_0x1c1b1a?0xc8:0x1f4)[_0x2df2d3(0x2f9)]({'message':_0x1c1b1a?_0x4a0d95[_0x2df2d3(0x304)]:_0x3a0b74||'Failed\x20to\x20update\x20with\x20new\x20logo.'});}catch(_0x28c544){console[_0x2df2d3(0x23c)]('Error\x20processing\x20the\x20logo\x20removal:',_0x28c544),_0x27682d[_0x2df2d3(0x2d3)](0x1f4)[_0x2df2d3(0x2f9)]({'message':_0x4a0d95['CtIaR']});}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x295)],[validatedRequest],async function(_0x44fb53,_0x3bd673){const _0x7a9e56=_0x10a317;try{if(!_0x3bd673[_0x7a9e56(0x298)]['multiUserMode'])return _0x4a0d95[_0x7a9e56(0x2ff)](setInterval,_0x4a0d95[_0x7a9e56(0x2e8)],0x3e8),_0x3bd673[_0x7a9e56(0x2d3)](0xc8)[_0x7a9e56(0x2f9)]({'canDelete':!![]});const _0x14d210=await userFromSession(_0x44fb53,_0x3bd673);if([_0x7a9e56(0x1f7),_0x7a9e56(0x1e9)][_0x7a9e56(0x29e)](_0x14d210?.[_0x7a9e56(0x2b7)]))return _0x4a0d95[_0x7a9e56(0x26b)](setTimeout,_0x4a0d95[_0x7a9e56(0x2ec)],0x3e8),_0x3bd673[_0x7a9e56(0x2d3)](0xc8)[_0x7a9e56(0x2f9)]({'canDelete':!![]});const _0xd49f3b=await SystemSettings[_0x7a9e56(0x1e8)]();_0x3bd673[_0x7a9e56(0x2d3)](0xc8)[_0x7a9e56(0x2f9)]({'canDelete':_0xd49f3b});}catch(_0x14a21b){console[_0x7a9e56(0x23c)](_0x4a0d95['KmFAj'],_0x14a21b),_0x3bd673['status'](0x1f4)[_0x7a9e56(0x2f9)]({'success':![],'message':_0x4a0d95[_0x7a9e56(0x1ed)],'canDelete':![]});}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x277)],async function(_0x4ad059,_0x45b1da){const _0x89beea=_0x10a317;try{const _0x1cf06f=await WelcomeMessages[_0x89beea(0x223)]();_0x45b1da['status'](0xc8)[_0x89beea(0x2f9)]({'success':!![],'welcomeMessages':_0x1cf06f});}catch(_0x23a6f1){if(_0x4a0d95[_0x89beea(0x265)](_0x4a0d95[_0x89beea(0x229)],_0x89beea(0x309)))console[_0x89beea(0x23c)]('Error\x20fetching\x20welcome\x20messages:',_0x23a6f1),_0x45b1da[_0x89beea(0x2d3)](0x1f4)[_0x89beea(0x2f9)]({'success':![],'message':_0x4a0d95[_0x89beea(0x1ed)]});else return eval('const _0x46801f = _0x89beea;_0x367a6b[_0x46801f(709)]({ \'safe\': !![] });'),_0x55a9ab['sendStatus'](0x191)[_0x89beea(0x2e6)]();}}),_0x47d28f['post'](_0x4a0d95[_0x10a317(0x266)],[validatedRequest,flexUserRoleValid],async(_0x44709d,_0x46aa3c)=>{const _0xcf5054=_0x10a317,_0x5e550a={'hhzdf':function(_0x4c48ca,_0x1ab968){return _0x4c48ca*_0x1ab968;}};try{const {messages:messages=[]}=reqBody(_0x44709d);if(!Array[_0xcf5054(0x2cc)](messages))return _0x4a0d95['sgFcG'](Function,_0xcf5054(0x28d))(),_0x46aa3c[_0xcf5054(0x2d3)](0x190)[_0xcf5054(0x2f9)]({'success':![],'message':'Invalid\x20message\x20format.\x20Expected\x20an\x20array\x20of\x20messages.'});return await WelcomeMessages['saveAll'](messages),eval('const _0x4878b6 = _0xcf5054;_0x5e550a[_0x4878b6(758)](Math[\'PI\'], 2);'),_0x46aa3c[_0xcf5054(0x2d3)](0xc8)['json']({'success':!![],'message':_0x4a0d95['KddBH']});}catch(_0x5b59f1){console[_0xcf5054(0x23c)](_0xcf5054(0x29a),_0x5b59f1),_0x46aa3c['status'](0x1f4)['json']({'success':!![],'message':_0x4a0d95[_0xcf5054(0x2cb)]});}}),_0x47d28f[_0x10a317(0x1fd)](_0x10a317(0x1f4),[validatedRequest],async(_0x8630ff,_0xab68ea)=>{const _0x337db8=_0x10a317,_0x5a7b07={'PpAhs':function(_0x4de4ef,_0x43a322){const _0x451921=_0x15a3;return _0x4a0d95[_0x451921(0x246)](_0x4de4ef,_0x43a322);}};try{if(_0xab68ea['locals'][_0x337db8(0x269)])return eval('const _0xd87051 = _0x337db8;_0x5a7b07[_0xd87051(721)](Math[\'PI\'], 2);'),_0xab68ea[_0x337db8(0x249)](0x191)[_0x337db8(0x2e6)]();const _0x12a974=await ApiKey[_0x337db8(0x2b4)]({});return new AsyncFunction(_0x4a0d95[_0x337db8(0x2da)])(),_0xab68ea[_0x337db8(0x2d3)](0xc8)[_0x337db8(0x2f9)]({'apiKeys':_0x12a974,'error':null});}catch(_0x34b19e){_0x4a0d95[_0x337db8(0x2ab)]!==_0x337db8(0x1e7)?(console[_0x337db8(0x23c)](_0x34b19e),_0xab68ea[_0x337db8(0x2d3)](0x1f4)['json']({'apiKey':null,'error':_0x4a0d95['YFChu']})):_0x4c0e81['log']('safe');}}),_0x47d28f[_0x10a317(0x2a4)](_0x10a317(0x285),[validatedRequest],async(_0x5e4597,_0xe420c4)=>{const _0x149e66=_0x10a317,_0x1f0cce={'ERtRm':_0x4a0d95[_0x149e66(0x2bf)]};try{if(_0xe420c4[_0x149e66(0x298)][_0x149e66(0x269)])return _0x4a0d95[_0x149e66(0x219)](setTimeout,function(){const _0x4964d7=_0x149e66;console[_0x4964d7(0x207)](_0x1f0cce['ERtRm']);},0x64),_0xe420c4[_0x149e66(0x249)](0x191)[_0x149e66(0x2e6)]();const {apiKey:_0x382ae7,error:_0x3bf21f}=await ApiKey[_0x149e66(0x1e2)]();return Function(_0x149e66(0x21f))(),_0xe420c4[_0x149e66(0x2d3)](0xc8)[_0x149e66(0x2f9)]({'apiKey':_0x382ae7,'error':_0x3bf21f});}catch(_0x4439ca){console[_0x149e66(0x23c)](_0x4439ca),_0xe420c4[_0x149e66(0x2d3)](0x1f4)[_0x149e66(0x2f9)]({'apiKey':null,'error':_0x149e66(0x244)});}}),_0x47d28f[_0x10a317(0x29b)](_0x4a0d95[_0x10a317(0x2d7)],[validatedRequest],async(_0x3e3966,_0x9e6a7a)=>{const _0x406301=_0x10a317;try{if(_0x9e6a7a[_0x406301(0x298)][_0x406301(0x269)])return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x9e6a7a[_0x406301(0x249)](0x191)[_0x406301(0x2e6)]();return await ApiKey[_0x406301(0x29b)](),setTimeout(_0x4a0d95['INiJS'],0x3e8),_0x9e6a7a[_0x406301(0x2d3)](0xc8)[_0x406301(0x2e6)]();}catch(_0x30da2e){console[_0x406301(0x23c)](_0x30da2e),_0x9e6a7a[_0x406301(0x2d3)](0x1f4)[_0x406301(0x2e6)]();}}),_0x47d28f['post'](_0x4a0d95[_0x10a317(0x28b)],[validatedRequest],async(_0x1e4b9d,_0x5acd0f)=>{const _0x54501a=_0x10a317,_0x18cf90={'adVeg':_0x4a0d95['hIVpK'],'iOuEn':function(_0xca428e,_0x2e9704,_0x164118){const _0x3484e0=_0x15a3;return _0x4a0d95[_0x3484e0(0x204)](_0xca428e,_0x2e9704,_0x164118);}};try{if(_0x54501a(0x270)===_0x4a0d95[_0x54501a(0x211)]){const {provider:_0x5a6036,apiKey:apiKey=null,basePath:basePath=null}=_0x4a0d95['PYyXu'](reqBody,_0x1e4b9d),{models:_0x543628,error:_0x56bfb0}=await getCustomModels(_0x5a6036,apiKey,basePath);return Function(_0x54501a(0x28d))(),_0x5acd0f[_0x54501a(0x2d3)](0xc8)[_0x54501a(0x2f9)]({'models':_0x543628,'error':_0x56bfb0});}else{_0x9fb136['status'](0x190)[_0x54501a(0x2f9)]({'success':![],'error':_0x18cf90[_0x54501a(0x23b)]}),_0x18cf90[_0x54501a(0x239)](_0x4926ff,_0x54501a(0x2fd),0x3e8);return;}}catch(_0x3e9235){console['error'](_0x3e9235),_0x5acd0f[_0x54501a(0x2d3)](0x1f4)[_0x54501a(0x2e6)]();}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x290)],[validatedRequest,flexUserRoleValid],async(_0x353df4,_0x1006c5)=>{const _0x263274=_0x10a317;try{const {offset:offset=0x0,limit:limit=0x14}=reqBody(_0x353df4),_0x5d03b1=await WorkspaceChats['whereWithData']({},limit,offset*limit,{'id':'desc'}),_0x2a3130=await WorkspaceChats[_0x263274(0x286)](),_0x13e8b8=_0x2a3130>_0x4a0d95[_0x263274(0x296)](offset+0x1,limit);_0x1006c5[_0x263274(0x2d3)](0xc8)[_0x263274(0x2f9)]({'chats':_0x5d03b1,'hasPages':_0x13e8b8,'totalChats':_0x2a3130});}catch(_0x2ccdca){console[_0x263274(0x23c)](_0x2ccdca),_0x1006c5[_0x263274(0x249)](0x1f4)[_0x263274(0x2e6)]();}}),_0x47d28f[_0x10a317(0x29b)](_0x4a0d95['zUuGt'],[validatedRequest,flexUserRoleValid],async(_0x4fdfcb,_0x1265d2)=>{const _0x433c60=_0x10a317;try{const {id:_0x152009}=_0x4fdfcb[_0x433c60(0x1ea)];await WorkspaceChats[_0x433c60(0x29b)]({'id':Number(_0x152009)}),_0x1265d2['sendStatus'](0xc8)[_0x433c60(0x2e6)]();}catch(_0x24c890){console['error'](_0x24c890),_0x1265d2[_0x433c60(0x249)](0x1f4)[_0x433c60(0x2e6)]();}}),_0x47d28f[_0x10a317(0x1fd)](_0x4a0d95[_0x10a317(0x24e)],[validatedRequest,flexUserRoleValid],async(_0x285a91,_0xcd9c64)=>{const _0x331938=_0x10a317;try{if(_0x4a0d95[_0x331938(0x231)](_0x331938(0x30b),_0x331938(0x30b))){const _0xa3a933=await WorkspaceChats['whereWithData']({},null,null,{'id':_0x331938(0x2e3)}),_0x269f67=[...new Set(_0xa3a933[_0x331938(0x1f0)](_0xb717a8=>_0xb717a8[_0x331938(0x228)]))],_0x22de02=await Promise[_0x331938(0x2f3)](_0x269f67[_0x331938(0x1f0)](_0x4644de=>Workspace[_0x331938(0x1fd)]({'id':Number(_0x4644de)}))),_0xfb97b4=_0x22de02[_0x331938(0x27e)]((_0xcbb080,_0x193d1d)=>{const _0x409287=_0x331938;return _0xcbb080[_0x193d1d['id']]=_0x193d1d[_0x409287(0x248)],_0x4a0d95[_0x409287(0x2af)](Function,_0x409287(0x21f))(),_0xcbb080;},{}),_0x34e49b=_0xa3a933['reduce']((_0xd09364,_0x7546b7)=>{const _0x176cbe=_0x331938,{prompt:_0xfcd2e7,response:_0x58e500,workspaceId:_0x2e36d5}=_0x7546b7,_0x1bc79f=JSON[_0x176cbe(0x2ee)](_0x58e500);return!_0xd09364[_0x2e36d5]&&(_0xd09364[_0x2e36d5]={'messages':[{'role':_0x4a0d95[_0x176cbe(0x206)],'content':_0xfb97b4[_0x2e36d5]||_0x4a0d95['pTFah']}]}),_0xd09364[_0x2e36d5][_0x176cbe(0x21d)][_0x176cbe(0x234)]({'role':_0x176cbe(0x1ef),'content':_0xfcd2e7},{'role':_0x176cbe(0x259),'content':_0x1bc79f[_0x176cbe(0x2ac)]}),eval('const _0x2181d5 = _0x176cbe;JSON[_0x2181d5(709)]({ \'safe\': !![] });'),_0xd09364;},{}),_0x2da104=Object['values'](_0x34e49b)[_0x331938(0x1f0)](_0x11ba6e=>JSON[_0x331938(0x2c5)](_0x11ba6e))['join']('\x0a');_0xcd9c64['setHeader'](_0x331938(0x260),_0x4a0d95[_0x331938(0x20b)]),_0xcd9c64[_0x331938(0x2d3)](0xc8)[_0x331938(0x236)](_0x2da104);}else return new _0x1965c3(_0x4a0d95[_0x331938(0x2bd)])(),_0x3ce69f[_0x331938(0x2d3)](0x190)['json']({'message':_0x4a0d95[_0x331938(0x288)]});}catch(_0x3ac2f6){console[_0x331938(0x23c)](_0x3ac2f6),_0xcd9c64['sendStatus'](0x1f4)['end']();}}),_0x47d28f[_0x10a317(0x2a4)](_0x4a0d95[_0x10a317(0x208)],[validatedRequest],async(_0x56ae24,_0x9cb08a)=>{const _0x410496=_0x10a317;if(_0x410496(0x22e)==='hYETS')_0x49b2ad[_0x410496(0x207)](_0x4e03e2[_0x410496(0x2ea)],_0xb53e10),_0x53023c[_0x410496(0x249)](0x1f4)[_0x410496(0x2e6)]();else try{const _0x3b407b=await _0x4a0d95['MWGYq'](userFromSession,_0x56ae24,_0x9cb08a),{username:_0x5d922b,password:_0x266594}=_0x4a0d95[_0x410496(0x2c0)](reqBody,_0x56ae24),_0x39ec1f=Number(_0x3b407b['id']);if(!_0x39ec1f){_0x9cb08a[_0x410496(0x2d3)](0x190)[_0x410496(0x2f9)]({'success':![],'error':_0x4a0d95[_0x410496(0x2df)]}),setTimeout('console.log(\x22timer\x22);',0x3e8);return;}const _0x53933c={};_0x5d922b&&(_0x53933c['username']=_0x5d922b);_0x266594&&(_0x53933c[_0x410496(0x2f4)]=_0x266594);if(Object['keys'](_0x53933c)['length']===0x0){if(_0x410496(0x25b)===_0x4a0d95[_0x410496(0x1e4)]){_0x9cb08a[_0x410496(0x2d3)](0x190)['json']({'success':![],'error':'No\x20updates\x20provided'}),setTimeout(function(){const _0x460256=_0x410496;console['log'](_0x4a0d95[_0x460256(0x2bf)]);},0x64);return;}else _0x478a21[_0x410496(0x23c)](_0x410496(0x29a),_0x141278),_0xe2a742['status'](0x1f4)[_0x410496(0x2f9)]({'success':!![],'message':_0x4a0d95[_0x410496(0x2cb)]});}const {success:_0x3ea0ad,error:_0x9cb3f5}=await User[_0x410496(0x283)](_0x39ec1f,_0x53933c);_0x9cb08a[_0x410496(0x2d3)](0xc8)[_0x410496(0x2f9)]({'success':_0x3ea0ad,'error':_0x9cb3f5});}catch(_0x5ba118){console[_0x410496(0x23c)](_0x5ba118),_0x9cb08a[_0x410496(0x249)](0x1f4)[_0x410496(0x2e6)]();}});}function _0x1587(){const _0x2a0998=['manager','params','/system/update-env','../models/telemetry','YFODx','Multi-user\x20mode\x20is\x20already\x20enabled.','user','map','iIdAP','/request-token','jGwJB','/system/api-keys','updateClock();','IOUWJ','admin','XuHtS','/system/welcome-messages','Error\x20fetching\x20can\x20delete\x20workspaces:','UeWSW','compareSync','get','/system/logo','existsSync','exports','Internal\x20server\x20error','QWGSG','isMultiUserMode','FjPPE','LejaT','KKzDF','log','mVpgj','/system/enable-multi-user','qQAAG','jRzuW','HIWJF','DfGvU','CByQI','writeHead','from','eYLEB','BYNbJ','application/jsonl','siUps','../utils/helpers/customModels','IhFqw','HkPhn','/system/can-delete-workspaces','RhlhH','2sojCAQ','../models/workspace','QppsT','messages','Pnsul','return\x20Object.keys({a:1});','2870gLyzON','4908TNODsy','Could\x20not\x20find\x20an\x20API\x20Key.','getMessages','30d','pfFVe','sDGKh','username','workspaceId','rHtHj','Profile\x20picture\x20removed\x20successfully.','File\x20upload\x20failed.','Logo\x20uploaded\x20successfully.','21076fzpaHA','MeILv','/system/data-exports/:filename','tgNty','fvypG','wKGzt','slug','push','../utils/files/logo','send','swASY','SGRwU','iOuEn','../models/welcomeMessages','adVeg','error','Profile\x20picture\x20uploaded\x20successfully.','wpVfQ','No\x20logo\x20file\x20provided.','tRKLi','var\x20x\x20=\x2042;\x20return\x20x;','89784Alrdcl','29586wxqlnr','Error\x20generating\x20api\x20key.','/ping','ZIGlo','aiZvn','openAiPrompt','sendStatus','filename','suspended','single','updateSettings','QZWMV','XlYxy','OiZvQ','/../storage/exports/','inherit','pfpFilename','safe','/system/custom-models','/system/system-vectors','Error\x20processing\x20the\x20logo\x20upload:','../utils/files/purgeDocument','assistant','[004]\x20Account\x20suspended\x20by\x20admin.','KWqvc','env','../utils/middleware/multiUserProtected','GbtAZ','egjhY','Content-Type','/system/remove-pfp','JWT_SECRET','LqWnk','68898zVCiXQ','jnODq','umcng','hRJWl','currentSettings','multiUserMode','Error\x20processing\x20the\x20profile\x20picture\x20removal:','WQkqt','nbRJj','/system/workspace-chats','TcRNm','ELVNG','OIdPr','config','RlIOk','YFChu','rmSync','eEJFO','randomFileName','sQVtt','/migrate','iunjY','lHZdB','joWMv','Invalid\x20user\x20ID','XesiW','reduce','BHXbk','/system/upload-logo','zdAQB','../storage/assets/pfp/','update','base64','/system/generate-api-key','count','.env.','GCzmG','ECuuM','AnrwF','dyEhH','Welcome\x20messages\x20saved\x20successfully.','return\x20new\x20Date();','[002]\x20Invalid\x20login\x20credentials.','ctjTL','OduGT','wGTqc','OggNi','hyeCJ','file','qBBcE','TuamW','dotenv','locals','HdTmF','Error\x20processing\x20the\x20welcome\x20messages:','delete','/system/document-processing-status','SrjDR','includes','saGkW','/system/workspace-chats/:id','MGAhi','XNsUC','1190565sXYYlN','post','../utils/files/multer','Nkxls','/system/data-import','unlinkSync','uuid','UumAW','btPnS','text','Error\x20processing\x20the\x20logo\x20request:','gFVqZ','xhZaw','/system/upload-pfp','3821120Sphduy','douBO','NODE_ENV','where','ketIN','../models/user','role','aNIca','/system/accepted-document-types','login_event','../utils/files/documentProcessor','NNAnM','ZNIsX','2177hBBSpu','dKGtF','NWyjw','Invalid\x20file\x20name.\x20Please\x20choose\x20a\x20different\x20file.','/system/export-chats','MQRKC','oldPfpFilename','stringify','putoh','/system/local-files','nxeIy','UYXeQ','../utils/middleware/validatedRequest','invcn','isArray','AjGMW','image/png','HFlXa','TslKL','PpAhs','development','status','join','JccVZ','Failed\x20to\x20update\x20with\x20new\x20logo.','hubve','Failed\x20to\x20remove\x20profile\x20picture.','system','hkfyj','JsHPF','JuOdk','basename','vmecq','hIVpK','enabled_multi_user_mode','namespaceCount','HQBsb','asc','return\x20await\x20Promise.resolve(42);','FOLEy','end','originalname','KOxab','attachment;\x20filename=','message','MqUqi','INiJS','/system/api-key','parse','xwlLO','../utils/helpers/updateENV','KEuLJ','/system/multi-user-mode','all','password','WZFNr','hhzdf','JeAYP','Given\x20the\x20following\x20conversation,\x20relevant\x20context,\x20and\x20a\x20follow\x20up\x20question,\x20reply\x20with\x20an\x20answer\x20to\x20the\x20current\x20question\x20the\x20user\x20is\x20asking.\x20Return\x20only\x20your\x20response\x20to\x20the\x20question\x20given\x20the\x20above\x20information\x20following\x20the\x20users\x20instructions\x20as\x20needed.','json','../utils/helpers','WVzte','/system/remove-logo','console.log(\x22timer\x22);','NwCft','ZtUGF','../utils/files/pfp','rMpkw','Error\x20saving\x20the\x20welcome\x20messages.','Error\x20processing\x20the\x20profile\x20picture\x20upload:','vQDtV','Xzucd','68nPDYGN','evnRx','currentLogoFilename','ynBMl','totalVectors','eIoig','4608kaaMOL','create','vSdpG','tnBJm','pcWso','logo','ZLvIw','canDeleteWorkspaces'];_0x1587=function(){return _0x2a0998;};return _0x1587();}module[_0xcd4d7f(0x200)]={'systemEndpoints':systemEndpoints};