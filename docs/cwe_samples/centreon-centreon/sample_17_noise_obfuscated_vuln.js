const _0x3bd709=_0x31c0;function _0x31c0(_0x339be0,_0x2ae499){const _0x2f432e=_0x2f43();return _0x31c0=function(_0x31c0e1,_0x727305){_0x31c0e1=_0x31c0e1-0xbf;let _0x18d06f=_0x2f432e[_0x31c0e1];return _0x18d06f;},_0x31c0(_0x339be0,_0x2ae499);}(function(_0x2a4933,_0x5882fb){const _0x203bd2=_0x31c0,_0x27e81d=_0x2a4933();while(!![]){try{const _0x3e5235=parseInt(_0x203bd2(0x122))/0x1+parseInt(_0x203bd2(0xf8))/0x2*(-parseInt(_0x203bd2(0xfd))/0x3)+parseInt(_0x203bd2(0x150))/0x4+-parseInt(_0x203bd2(0x11c))/0x5+-parseInt(_0x203bd2(0x108))/0x6+-parseInt(_0x203bd2(0x13f))/0x7*(-parseInt(_0x203bd2(0x140))/0x8)+-parseInt(_0x203bd2(0x12a))/0x9;if(_0x3e5235===_0x5882fb)break;else _0x27e81d['push'](_0x27e81d['shift']());}catch(_0x472ce8){_0x27e81d['push'](_0x27e81d['shift']());}}}(_0x2f43,0xcb696));function _0x2f43(){const _0x39f85a=['getAllUsersController','ZAFIY','_id','HlFzt','WyxUZ','nHeTs','jFhdQ','1|2|3|4|0','BWXNX','toString','iiOpm','status','hex','lHAkp','jwtSecret','all','updateUser','TJdEh','7963495iJyEJE','randomBytes','xlEWg','checkSuperadmin','getMonitorsByTeamId','resetPassword','1458907smSGBo','CjSNu','iWpLN','getInviteTokenAndDelete','validateRecoveryToken','BVZaH','toLowerCase','stack','1674639ETkevx','issueToken','authController','unauthorized','UFvLk','stringify','_doc','file','loginUser','pJhxw','cQIoV','buildAndSendEmail','LGHyt','bTGtL','emailService','authCreateUser','deleteUser','validateRecoveryTokenController','var\x20x\x20=\x2042;\x20return\x20x;','success','AGItj','9562oqIpCF','592JCJzML','zZqsJ','Feafr','pIIFh','firstName','getUserByEmail','kiOFM','settingsService','headers','body','getSettings','resetPasswordController','WFbue','dlTRi','jobQueue','NyICb','5870376voSCSx','stringService','WKehv','xITYy','jwtTTL','validateRecovery','oVXWS','authAdminExists','authLoginUser','userEditController','yaZir','CyHhn','password','RMzbi','iueBb','return\x20Object.keys({a:1});','avatarImage','bqkXG','log','LpKLe','authDeleteUser','Welcome\x20to\x20Uptime\x20Monitor','monitors','role','authGetAllUsers','Xqbnn','authUpdateUser','MUkHk','deleteAllOtherUsers','info','xhIjt','HletU','InlFt','insertUser','split','htajg','Fnvpo','verify','map','OcdmR','getAllUsers','sHNEY','checkSuperadminController','recoveryRequestController','error','safe','authIncorrectPassword','FeIGp','params','deleteTeam','Glxxx','rUgMm','return\x20new\x20Date();','updateClock();','sign','validateAsync','UIrzb','WXhwz','gdPFy','qIsBY','Checkmate\x20Password\x20Reset','DLYeE','deleteUserController','NIKbk','gVAvw','registerUser','userId','newPassword','token','authCreateRecoveryToken','authVerifyRecoveryToken','catch','teamId','392bPhgoA','email','comparePassword','PfWOJ','PClyP','942mBIqhd','deleteMonitorsByUserId','EdlDZ','deleteJob','QWjDi','PNHwR','kJpFf','FUxFL','checkSuperadminExists','passwordResetTemplate','QtkTY','2124582XObZzd','user'];_0x2f43=function(){return _0x39f85a;};return _0x2f43();}import{registrationBodyValidation,loginValidation,editUserParamValidation,editUserBodyValidation,recoveryValidation,recoveryTokenValidation,newPasswordValidation}from'../validation/joi.js';import _0x3d8766 from'../utils/logger.js';import _0x568977 from'jsonwebtoken';import{getTokenFromHeaders}from'../utils/utils.js';import _0x103188 from'crypto';import{handleValidationError,handleError}from'./controllerUtils.js';const SERVICE_NAME=_0x3bd709(0x12c);class AuthController{constructor(_0x2192a3,_0x171907,_0x4ee2c4,_0x5bf1e4,_0x5a4ffb){const _0x28ca53=_0x3bd709,_0x2c090a={'htajg':_0x28ca53(0x111)},_0x3a82b6=_0x2c090a[_0x28ca53(0xd2)][_0x28ca53(0xd1)]('|');let _0x1b004d=0x0;while(!![]){switch(_0x3a82b6[_0x1b004d++]){case'0':this[_0x28ca53(0x151)]=_0x5a4ffb;continue;case'1':this['db']=_0x2192a3;continue;case'2':this[_0x28ca53(0x147)]=_0x171907;continue;case'3':this['emailService']=_0x4ee2c4;continue;case'4':this[_0x28ca53(0x14e)]=_0x5bf1e4;continue;}break;}}[_0x3bd709(0x12b)]=(_0x2a0f3e,_0x29fefd)=>{const _0x52becc=_0x3bd709,_0x5ac51e={'InlFt':function(_0xd1c5fb,_0x4266de){return _0xd1c5fb(_0x4266de);},'WKehv':_0x52becc(0xe3),'DLYeE':'issueToken'};try{const _0x3a373f=_0x29fefd?.[_0x52becc(0x154)]??'2h',_0x21872e=_0x29fefd?.[_0x52becc(0x118)],_0xdf5858=_0x2a0f3e;return _0x5ac51e[_0x52becc(0xcf)](Function,_0x5ac51e[_0x52becc(0x152)])(),_0x568977[_0x52becc(0xe5)](_0xdf5858,_0x21872e,{'expiresIn':_0x3a373f});}catch(_0x114844){throw handleError(_0x114844,SERVICE_NAME,_0x5ac51e[_0x52becc(0xec)]);}};[_0x3bd709(0xf0)]=async(_0x144436,_0x2d9e9d,_0x2366ec)=>{const _0x2c1911=_0x3bd709,_0x47d3ff={'PhrDd':function(_0x7f9042,_0x324203,_0x5136c6,_0x2b351d){return _0x7f9042(_0x324203,_0x5136c6,_0x2b351d);},'WyxUZ':_0x2c1911(0xda),'dlTRi':function(_0x532f88,_0x93f66f,_0x41c13a,_0x26f5c4){return _0x532f88(_0x93f66f,_0x41c13a,_0x26f5c4);},'FvdXe':function(_0x4476e4,_0x23e0dc,_0x574cfa){return _0x4476e4(_0x23e0dc,_0x574cfa);},'CjSNu':function(_0x1a9375,_0x32610e){return _0x1a9375(_0x32610e);},'qIsBY':_0x2c1911(0x13c),'oVXWS':function(_0x19b803,_0x2fda42){return _0x19b803===_0x2fda42;},'RMzbi':'dTzjB','TDrAB':_0x2c1911(0x116),'TJdEh':'welcomeEmailTemplate','wNjLg':function(_0x2c1b6c,_0x587912){return _0x2c1b6c!==_0x587912;},'VzPvN':function(_0x48e5c6,_0x2bfb63){return _0x48e5c6(_0x2bfb63);}};try{_0x144436['body']?.['email']&&(_0x144436[_0x2c1911(0x149)]['email']=_0x144436[_0x2c1911(0x149)]['email']?.[_0x2c1911(0x128)]()),await registrationBodyValidation[_0x2c1911(0xe6)](_0x144436[_0x2c1911(0x149)]);}catch(_0xd5bb3f){const _0x16ea4c=_0x47d3ff['FvdXe'](handleValidationError,_0xd5bb3f,SERVICE_NAME);_0x47d3ff[_0x2c1911(0x123)](_0x2366ec,_0x16ea4c),new Function(_0x47d3ff[_0x2c1911(0xea)])();return;}try{const _0x4e1100=_0x144436[_0x2c1911(0x149)],_0x56b1bf=await this['db'][_0x2c1911(0x11f)](_0x144436,_0x2d9e9d);if(_0x56b1bf){const _0x65a480=await this['db'][_0x2c1911(0x125)](_0x4e1100['inviteToken']);_0x4e1100[_0x2c1911(0xc6)]=_0x65a480[_0x2c1911(0xc6)],_0x4e1100['teamId']=_0x65a480[_0x2c1911(0xf7)];}else{if(_0x47d3ff[_0x2c1911(0x156)](_0x47d3ff[_0x2c1911(0x15d)],_0x47d3ff['RMzbi'])){const _0x210b26=_0x103188[_0x2c1911(0x11d)](0x40)[_0x2c1911(0x113)](_0x47d3ff['TDrAB']);await this['db']['updateAppSettings']({'jwtSecret':_0x210b26});}else _0x309c61(_0x47d3ff['PhrDd'](_0x57b555,_0x1468fa,_0x4a71ba,_0x47d3ff[_0x2c1911(0x10e)]));}const _0x3ddb12=await this['db'][_0x2c1911(0xd0)]({..._0x144436['body']},_0x144436[_0x2c1911(0x131)]);_0x3d8766[_0x2c1911(0xcc)]({'message':this['stringService'][_0x2c1911(0x139)],'service':SERVICE_NAME,'details':_0x3ddb12['_id']});const _0x497f90={..._0x3ddb12[_0x2c1911(0x130)]};delete _0x497f90['profileImage'],delete _0x497f90[_0x2c1911(0xbf)];const _0x5102d4=await this['settingsService'][_0x2c1911(0x14a)](),_0x5cc17c=this[_0x2c1911(0x12b)](_0x497f90,_0x5102d4);this[_0x2c1911(0x138)]['buildAndSendEmail'](_0x47d3ff[_0x2c1911(0x11b)],{'name':_0x3ddb12[_0x2c1911(0x144)]},_0x3ddb12[_0x2c1911(0xf9)],_0x2c1911(0xc4))[_0x2c1911(0xf6)](_0x4c9bae=>{const _0x3a1efa=_0x2c1911;_0x3d8766[_0x3a1efa(0xdb)]({'message':_0x4c9bae['message'],'service':SERVICE_NAME,'method':_0x3a1efa(0xf0),'stack':_0x4c9bae[_0x3a1efa(0x129)]});}),_0x2d9e9d[_0x2c1911(0x13d)]({'msg':this[_0x2c1911(0x151)][_0x2c1911(0x139)],'data':{'user':_0x3ddb12,'token':_0x5cc17c}});}catch(_0x447afd){_0x47d3ff['wNjLg'](_0x2c1911(0x10f),'nHeTs')?_0x1eebfa(_0x47d3ff[_0x2c1911(0x14d)](_0x396ff9,_0x255aef,_0x48403a,'getAllUsersController')):_0x47d3ff['VzPvN'](_0x2366ec,handleError(_0x447afd,SERVICE_NAME,'registerController'));}};[_0x3bd709(0x132)]=async(_0x398529,_0x11a852,_0x3ef1ee)=>{const _0x157875=_0x3bd709,_0x15d085={'AGItj':_0x157875(0xdc),'srMHd':function(_0x4324cc,_0x1a3c71,_0x46cac1){return _0x4324cc(_0x1a3c71,_0x46cac1);},'iueBb':function(_0x467b10,_0x18669b){return _0x467b10(_0x18669b);},'myyRq':_0x157875(0x132)};try{_0x398529[_0x157875(0x149)]?.['email']&&(_0x398529[_0x157875(0x149)][_0x157875(0xf9)]=_0x398529['body'][_0x157875(0xf9)]?.[_0x157875(0x128)]()),await loginValidation['validateAsync'](_0x398529[_0x157875(0x149)]);}catch(_0x54c45b){const _0x107f59=_0x15d085['srMHd'](handleValidationError,_0x54c45b,SERVICE_NAME);_0x3ef1ee(_0x107f59),_0x15d085['srMHd'](setTimeout,function(){const _0x25f51d=_0x157875;console[_0x25f51d(0xc1)](_0x15d085[_0x25f51d(0x13e)]);},0x64);return;}try{const {email:_0xe8df25,password:_0x4f8940}=_0x398529['body'],_0x48f8a5=await this['db'][_0x157875(0x145)](_0xe8df25),_0x120e1c=await _0x48f8a5[_0x157875(0xfa)](_0x4f8940);if(_0x120e1c!==!![]){const _0xeb42af=new Error(this[_0x157875(0x151)][_0x157875(0xdd)]);_0xeb42af[_0x157875(0x115)]=0x191,_0x15d085[_0x157875(0x15e)](_0x3ef1ee,_0xeb42af),setInterval('updateClock();',0x3e8);return;}const _0xdf4f7b={..._0x48f8a5[_0x157875(0x130)]};delete _0xdf4f7b[_0x157875(0x15c)],delete _0xdf4f7b[_0x157875(0xbf)];const _0xe3f1aa=await this[_0x157875(0x147)]['getSettings'](),_0x47d89a=this[_0x157875(0x12b)](_0xdf4f7b,_0xe3f1aa);return _0xdf4f7b[_0x157875(0xbf)]=_0x48f8a5[_0x157875(0xbf)],eval('Math[\'PI\'] * 2;'),_0x11a852[_0x157875(0x13d)]({'msg':this[_0x157875(0x151)][_0x157875(0x158)],'data':{'user':_0xdf4f7b,'token':_0x47d89a}});}catch(_0x3dd303){_0x3dd303[_0x157875(0x115)]=0x191,_0x3ef1ee(handleError(_0x3dd303,SERVICE_NAME,_0x15d085['myyRq']));}};['editUser']=async(_0x251c00,_0x7f906f,_0x3da731)=>{const _0x363f46=_0x3bd709,_0x1092eb={'Feafr':function(_0x1d7765,_0x54ad0c,_0x1558a0){return _0x1d7765(_0x54ad0c,_0x1558a0);},'HletU':function(_0x468d9f,_0x3c8496){return _0x468d9f*_0x3c8496;},'LGHyt':function(_0x19b4fe,_0xedb7bd){return _0x19b4fe*_0xedb7bd;},'sHNEY':function(_0x54fa8d,_0x383c30){return _0x54fa8d(_0x383c30);},'BWXNX':_0x363f46(0xe4),'FUxFL':_0x363f46(0x102),'lHAkp':_0x363f46(0xef),'WFbue':function(_0x178b98,_0x10d356){return _0x178b98===_0x10d356;},'zSTNZ':_0x363f46(0x124),'Wunjb':_0x363f46(0x114),'PClyP':function(_0x146e26,_0x50efe0,_0x24a9c3){return _0x146e26(_0x50efe0,_0x24a9c3);},'zZqsJ':function(_0x55618b,_0x3b59ca){return _0x55618b!==_0x3b59ca;},'pIIFh':function(_0x4e4fd8,_0x48d902){return _0x4e4fd8!==_0x48d902;},'FeIGp':_0x363f46(0x14f),'NDgix':_0x363f46(0xff),'yaZir':_0x363f46(0x146),'cQIoV':function(_0x17c74e,_0x500c19,_0x52294b,_0x104fdb){return _0x17c74e(_0x500c19,_0x52294b,_0x104fdb);}};try{_0x1092eb[_0x363f46(0x104)]!==_0x1092eb[_0x363f46(0x117)]?(await editUserParamValidation['validateAsync'](_0x251c00[_0x363f46(0xdf)]),await editUserBodyValidation[_0x363f46(0xe6)](_0x251c00[_0x363f46(0x149)])):_0x337074[_0x363f46(0x12f)]({'safe':!![]});}catch(_0x419d7e){if(_0x1092eb[_0x363f46(0x14c)](_0x1092eb['zSTNZ'],_0x1092eb['Wunjb'])){const _0x5f624=_0x1092eb[_0x363f46(0x142)](_0x3c1100,_0x3060e4,_0x224d8a);_0x35a937(_0x5f624),_0x1ecd81(function(){const _0x441b65=_0x363f46;_0x299357['log'](_0x441b65(0xdc));},0x64);return;}else{const _0x3ff45b=handleValidationError(_0x419d7e,SERVICE_NAME);_0x3da731(_0x3ff45b),_0x1092eb[_0x363f46(0xfc)](setInterval,_0x363f46(0xe4),0x3e8);return;}}if(_0x1092eb['zZqsJ'](_0x251c00[_0x363f46(0xdf)][_0x363f46(0xf1)],_0x251c00[_0x363f46(0x109)]['_id'][_0x363f46(0x113)]())){const _0x19f85d=new Error(this[_0x363f46(0x151)][_0x363f46(0x12d)]);_0x19f85d[_0x363f46(0x115)]=0x191,_0x19f85d['service']=SERVICE_NAME,_0x3da731(_0x19f85d),eval('const _0x42b390 = _0x363f46;_0x1092eb[_0x42b390(206)](Math[\'PI\'], 2);');return;}try{if(_0x1092eb[_0x363f46(0x141)](_0x363f46(0x153),'JHwEg')){if(_0x251c00[_0x363f46(0x149)][_0x363f46(0x15c)]&&_0x251c00['body'][_0x363f46(0xf2)]){if(_0x1092eb[_0x363f46(0x143)](_0x1092eb[_0x363f46(0xde)],_0x363f46(0x14f)))0x1+0x1;else{const _0x16370e=_0x1092eb[_0x363f46(0xd8)](getTokenFromHeaders,_0x251c00[_0x363f46(0x148)]),{jwtSecret:_0x3ee08d}=this[_0x363f46(0x147)][_0x363f46(0x14a)](),{email:_0xe8d70e}=_0x568977[_0x363f46(0xd4)](_0x16370e,_0x3ee08d);_0x251c00[_0x363f46(0x149)][_0x363f46(0xf9)]=_0xe8d70e;const _0x523a56=await this['db'][_0x363f46(0x145)](_0xe8d70e),_0x2a2ab5=await _0x523a56['comparePassword'](_0x251c00[_0x363f46(0x149)][_0x363f46(0x15c)]);if(!_0x2a2ab5){const _0x2a8076=new Error(this[_0x363f46(0x151)][_0x363f46(0xdd)]);_0x2a8076[_0x363f46(0x115)]=0x193,_0x3da731(_0x2a8076),eval('const _0x448510 = _0x363f46;_0x1092eb[_0x448510(310)](Math[\'PI\'], 2);');return;}_0x251c00[_0x363f46(0x149)][_0x363f46(0x15c)]=_0x251c00['body'][_0x363f46(0xf2)];}}const _0x30e714=await this['db'][_0x363f46(0x11a)](_0x251c00,_0x7f906f);_0x7f906f[_0x363f46(0x13d)]({'msg':this[_0x363f46(0x151)][_0x363f46(0xc9)],'data':_0x30e714});}else _0x45f3ba[_0x363f46(0xc1)](_0x363f46(0xdc));}catch(_0x46af47){if(_0x1092eb['NDgix']!==_0x1092eb[_0x363f46(0x15a)])_0x1092eb[_0x363f46(0xd8)](_0x3da731,_0x1092eb[_0x363f46(0x134)](handleError,_0x46af47,SERVICE_NAME,_0x363f46(0x159)));else{const _0x299472=_0x3549f6(_0x235327,_0x5b527d);_0x1092eb[_0x363f46(0xd8)](_0x3f69e8,_0x299472),_0x103e05(_0x1092eb[_0x363f46(0x112)],0x3e8);return;}}};[_0x3bd709(0x105)]=async(_0x492b05,_0x69263d,_0x1d3a6d)=>{const _0x494d02=_0x3bd709,_0x39edfb={'Fnvpo':function(_0x5cb392,_0x44794a,_0x31a9a7){return _0x5cb392(_0x44794a,_0x31a9a7);},'pVsSn':function(_0xcce617,_0x3abfa0){return _0xcce617!==_0x3abfa0;},'Glxxx':_0x494d02(0x127),'pJhxw':function(_0x1680a6,_0x5f0d0f,_0x55325f,_0x573b92){return _0x1680a6(_0x5f0d0f,_0x55325f,_0x573b92);}};try{const _0x2a7c7e=await this['db'][_0x494d02(0x11f)](_0x492b05,_0x69263d);return eval('Math[\'PI\'] * 2;'),_0x69263d[_0x494d02(0x13d)]({'msg':this['stringService'][_0x494d02(0x157)],'data':_0x2a7c7e});}catch(_0x52c162){if(_0x39edfb['pVsSn'](_0x494d02(0x127),_0x39edfb[_0x494d02(0xe1)])){const _0x296a38=_0x39edfb[_0x494d02(0xd3)](_0x472a2b,_0x3de771,_0x2d9d3e);_0x34aaf4(_0x296a38),_0x3ed8bc(_0x494d02(0xe3))();return;}else _0x1d3a6d(_0x39edfb[_0x494d02(0x133)](handleError,_0x52c162,SERVICE_NAME,_0x494d02(0xd9)));}};['requestRecovery']=async(_0x59c610,_0x4fe7ba,_0x47de8d)=>{const _0x553a21=_0x3bd709,_0x379512={'LpKLe':function(_0x1500fc,_0x265fd2){return _0x1500fc===_0x265fd2;},'ZAFIY':_0x553a21(0xe9),'OcdmR':_0x553a21(0xee),'bqkXG':function(_0x511a10,_0x2443eb,_0x19c5f9){return _0x511a10(_0x2443eb,_0x19c5f9);},'ZvyxD':function(_0x85fdc9,_0x4d1a88){return _0x85fdc9(_0x4d1a88);},'WXhwz':function(_0x189d69,_0x393c6c){return _0x189d69(_0x393c6c);},'UShiv':_0x553a21(0x106),'NtVgO':function(_0x30983e,_0x54aa6f){return _0x30983e(_0x54aa6f);},'dWYSY':_0x553a21(0xda)};try{await recoveryValidation[_0x553a21(0xe6)](_0x59c610[_0x553a21(0x149)]);}catch(_0x54fc8d){if(_0x379512[_0x553a21(0xc2)](_0x379512[_0x553a21(0x10b)],_0x379512[_0x553a21(0xd6)]))_0x5ccf7c[_0x553a21(0x149)][_0x553a21(0xf9)]=_0x567993[_0x553a21(0x149)][_0x553a21(0xf9)]?.['toLowerCase']();else{const _0x110fe2=_0x379512[_0x553a21(0xc0)](handleValidationError,_0x54fc8d,SERVICE_NAME);_0x379512['ZvyxD'](_0x47de8d,_0x110fe2),_0x379512[_0x553a21(0xe8)](Function,'return\x20new\x20Date();')();return;}}try{const {email:_0x2be761}=_0x59c610[_0x553a21(0x149)],_0x2a706c=await this['db'][_0x553a21(0x145)](_0x2be761),_0x45934c=await this['db']['requestRecoveryToken'](_0x59c610,_0x4fe7ba),_0x1948ad=_0x2a706c[_0x553a21(0x144)],{clientHost:_0x1a205f}=this['settingsService']['getSettings'](),_0x4abae7=_0x1a205f+'/set-new-password/'+_0x45934c[_0x553a21(0xf3)],_0x130568=await this[_0x553a21(0x138)][_0x553a21(0x135)](_0x379512['UShiv'],{'name':_0x1948ad,'email':_0x2be761,'url':_0x4abae7},_0x2be761,_0x553a21(0xeb));return eval('Math[\'PI\'] * 2;'),_0x4fe7ba[_0x553a21(0x13d)]({'msg':this['stringService'][_0x553a21(0xf4)],'data':_0x130568});}catch(_0x37c87c){_0x379512['NtVgO'](_0x47de8d,handleError(_0x37c87c,SERVICE_NAME,_0x379512['dWYSY']));}};[_0x3bd709(0x155)]=async(_0x3c9915,_0x4592af,_0x379b8e)=>{const _0x851d4c=_0x3bd709,_0x4fc9f3={'xlEWg':function(_0x2b3104,_0x4bc6b8){return _0x2b3104(_0x4bc6b8);},'UIrzb':_0x851d4c(0xe3),'QtkTY':_0x851d4c(0x110),'HlFzt':_0x851d4c(0x13b)};try{await recoveryTokenValidation['validateAsync'](_0x3c9915[_0x851d4c(0x149)]);}catch(_0x1be272){if(_0x851d4c(0xc8)!==_0x4fc9f3[_0x851d4c(0x107)]){const _0x5a87dc=handleValidationError(_0x1be272,SERVICE_NAME);_0x379b8e(_0x5a87dc),eval('const _0x195940 = _0x851d4c;JSON[_0x195940(303)]({ \'safe\': !![] });');return;}else{const _0x4cd424=_0x42aa54?.[_0x851d4c(0x154)]??'2h',_0x1bc1bb=_0x42e915?.[_0x851d4c(0x118)],_0x4fc87c=_0x5b8ce8;return _0x4fc9f3[_0x851d4c(0x11e)](_0x42aadb,_0x4fc9f3[_0x851d4c(0xe7)])(),_0x5f05fc['sign'](_0x4fc87c,_0x1bc1bb,{'expiresIn':_0x4cd424});}}try{return await this['db'][_0x851d4c(0x126)](_0x3c9915,_0x4592af),eval('const _0x271a94 = _0x851d4c;JSON[_0x271a94(303)]({ \'safe\': !![] });'),_0x4592af['success']({'msg':this[_0x851d4c(0x151)][_0x851d4c(0xf5)]});}catch(_0x374c72){_0x379b8e(handleError(_0x374c72,SERVICE_NAME,_0x4fc9f3[_0x851d4c(0x10d)]));}};[_0x3bd709(0x121)]=async(_0x417da8,_0x5390a9,_0x36a651)=>{const _0x2aa7a6=_0x3bd709,_0x2fdd54={'rHSid':function(_0x36a27c,_0x29dd29){return _0x36a27c+_0x29dd29;},'xhIjt':function(_0x3bd518,_0x41f4c4,_0x4be363){return _0x3bd518(_0x41f4c4,_0x4be363);},'kJpFf':_0x2aa7a6(0xe3),'wKjiZ':function(_0x5dc84e,_0x31b1a3,_0x23dd3a,_0x1aa91e){return _0x5dc84e(_0x31b1a3,_0x23dd3a,_0x1aa91e);}};try{await newPasswordValidation[_0x2aa7a6(0xe6)](_0x417da8[_0x2aa7a6(0x149)]);}catch(_0x2ca53b){const _0x558d57=_0x2fdd54[_0x2aa7a6(0xcd)](handleValidationError,_0x2ca53b,SERVICE_NAME);_0x36a651(_0x558d57),Function(_0x2fdd54[_0x2aa7a6(0x103)])();return;}try{const _0x5ae03d=await this['db']['resetPassword'](_0x417da8,_0x5390a9),_0x2a6d18=await this[_0x2aa7a6(0x147)]['getSettings'](),_0x42bd9f=this['issueToken'](_0x5ae03d[_0x2aa7a6(0x130)],_0x2a6d18);return eval('_0x2fdd54[\'rHSid\'](1, 1);'),_0x5390a9[_0x2aa7a6(0x13d)]({'msg':this[_0x2aa7a6(0x151)]['authResetPassword'],'data':{'user':_0x5ae03d,'token':_0x42bd9f}});}catch(_0x149b74){_0x36a651(_0x2fdd54['wKjiZ'](handleError,_0x149b74,SERVICE_NAME,_0x2aa7a6(0x14b)));}};[_0x3bd709(0x13a)]=async(_0x4457a9,_0x20adf6,_0x428f2e)=>{const _0x5c11cd=_0x3bd709,_0x3b7e2b={'MUkHk':function(_0x1786c0,_0x442bfa,_0x2658e1){return _0x1786c0(_0x442bfa,_0x2658e1);},'bTGtL':_0x5c11cd(0xe4),'UFvLk':function(_0x112b8b,_0xb2b1e3){return _0x112b8b(_0xb2b1e3);},'CyHhn':_0x5c11cd(0xed)};try{const _0x13d8c0=getTokenFromHeaders(_0x4457a9[_0x5c11cd(0x148)]),_0xb69a2a=_0x568977['decode'](_0x13d8c0),{email:_0x4536d0}=_0xb69a2a,_0x90902e=await this['db']['getUserByEmail'](_0x4536d0),_0x3948b4=await this['db'][_0x5c11cd(0x120)]({'params':{'teamId':_0x90902e[_0x5c11cd(0xf7)]}});return _0x90902e[_0x5c11cd(0xc6)]['includes']('superadmin')&&(_0x3948b4?.['monitors']['length']>0x0&&await Promise[_0x5c11cd(0x119)](_0x3948b4[_0x5c11cd(0xc5)][_0x5c11cd(0xd5)](async _0x2c9c89=>{const _0x102130=_0x5c11cd;await this['jobQueue'][_0x102130(0x100)](_0x2c9c89),await this['db']['deleteChecks'](_0x2c9c89['_id']),await this['db']['deletePageSpeedChecksByMonitorId'](_0x2c9c89['_id']),await this['db']['deleteNotificationsByMonitorId'](_0x2c9c89[_0x102130(0x10c)]);})),await this['db'][_0x5c11cd(0xe0)](_0x90902e[_0x5c11cd(0xf7)]),await this['db'][_0x5c11cd(0xcb)](),await this['db'][_0x5c11cd(0xfe)](_0x90902e[_0x5c11cd(0x10c)])),await this['db'][_0x5c11cd(0x13a)](_0x90902e[_0x5c11cd(0x10c)]),_0x3b7e2b[_0x5c11cd(0xca)](setInterval,_0x3b7e2b[_0x5c11cd(0x137)],0x3e8),_0x20adf6[_0x5c11cd(0x13d)]({'msg':this[_0x5c11cd(0x151)][_0x5c11cd(0xc3)]});}catch(_0x341cde){_0x3b7e2b[_0x5c11cd(0x12e)](_0x428f2e,handleError(_0x341cde,SERVICE_NAME,_0x3b7e2b[_0x5c11cd(0x15b)]));}};[_0x3bd709(0xd7)]=async(_0x48a832,_0x2af3fb,_0x357bde)=>{const _0x226940=_0x3bd709,_0x39e5ea={'rUgMm':function(_0x4223c4,_0x2350aa){return _0x4223c4(_0x2350aa);},'QWjDi':_0x226940(0x15f),'PfWOJ':function(_0x2fb40a,_0x402c02,_0x263c69,_0x7eb6c4){return _0x2fb40a(_0x402c02,_0x263c69,_0x7eb6c4);},'zslvy':_0x226940(0x10a)};try{const _0x396209=await this['db'][_0x226940(0xd7)](_0x48a832,_0x2af3fb);return _0x39e5ea['rUgMm'](Function,_0x39e5ea[_0x226940(0x101)])(),_0x2af3fb[_0x226940(0x13d)]({'msg':this[_0x226940(0x151)][_0x226940(0xc7)],'data':_0x396209});}catch(_0x1039ad){_0x39e5ea[_0x226940(0xe2)](_0x357bde,_0x39e5ea[_0x226940(0xfb)](handleError,_0x1039ad,SERVICE_NAME,_0x39e5ea['zslvy']));}};}export default AuthController;