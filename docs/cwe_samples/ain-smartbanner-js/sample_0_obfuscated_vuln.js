const _0x492b60=_0x3c7e;function _0x3c7e(_0x2c8cf4,_0x1639ce){const _0x11e3b4=_0x11e3();return _0x3c7e=function(_0x3c7ef1,_0x223a1c){_0x3c7ef1=_0x3c7ef1-0x185;let _0x12c734=_0x11e3b4[_0x3c7ef1];return _0x12c734;},_0x3c7e(_0x2c8cf4,_0x1639ce);}(function(_0x2afb7e,_0x57d741){const _0x58f62d=_0x3c7e,_0x8e40b0=_0x2afb7e();while(!![]){try{const _0x231e2d=parseInt(_0x58f62d(0x19c))/0x1+parseInt(_0x58f62d(0x202))/0x2+-parseInt(_0x58f62d(0x1b8))/0x3+-parseInt(_0x58f62d(0x209))/0x4*(parseInt(_0x58f62d(0x1d8))/0x5)+-parseInt(_0x58f62d(0x192))/0x6+parseInt(_0x58f62d(0x186))/0x7+parseInt(_0x58f62d(0x1c2))/0x8*(parseInt(_0x58f62d(0x197))/0x9);if(_0x231e2d===_0x57d741)break;else _0x8e40b0['push'](_0x8e40b0['shift']());}catch(_0x2653d3){_0x8e40b0['push'](_0x8e40b0['shift']());}}}(_0x11e3,0x7502b));function _0x11e3(){const _0x1745a8=['InVWo','288fdvxWF','sGFUN','findOne','EhVmD','GymnJ','113890UTELkC','hywZs','WOqPL','getSubdir','redirects\x20member\x20to\x20referrer\x20param\x20path\x20on\x20signin\x20if\x20it\x20is\x20on\x20the\x20site','test@email.com','https://external.com/whatever/','wQmhe','QepUH','api','/members?token=test&action=signin&r=https%3A%2F%2Fsite.com%2Fblah%2Fmy-post%2F','returns\x20400\x20if\x20no\x20member\x20uuid\x20is\x20part\x20of\x20the\x20request','HSGmq','KUWiL','test','stub','/members','Array','https://custom.com/paid','redirects\x20correctly\x20on\x20success','EdHeG','https://custom.com/redirect/','JvNoO','writeHead','firstCall','tJLGq','split','/blah/?action=signup&success=false','1185774bttbJZ','BhCdt','/blah/?action=signin&success=true','0|4|3|1|5|2','https://site.com/blah','hUbQp','end','false','PZCCI','createSessionFromMagicLink','271984kJdgql','EoOFn','resolves','eql','kvnuI','calledOnce','redirects\x20free\x20member\x20to\x20custom\x20redirect\x20on\x20signup','rNNHF','should','restore','KbOUw','OfkgH','signup','Mchin','active','updateMemberNewsletters','stringify','pNorI','VhjvK','https://custom.com/paid/','EkvkL','url','20nNJnNT','ZtSBI','../../../../../core/server/services/members','/blah/?action=signup&success=true','bqmXL','sinon','returns','YodZx','rejects','kcJyo','uLKnd','ToZrB','does\x20not\x20redirect\x20to\x20referrer\x20param\x20if\x20it\x20is\x20external','BDIYE','Invalid\x20member\x20uuid','true','https://site.com/blah/my-post/?action=signin&success=true#comment-123','zVEje','aTnpa','bTFYw','Email\x20address\x20not\x20found.','shcNm','../../../../../core/server/services/members/middleware','ciweW','get','redirect','json','redirects\x20correctly\x20on\x20failure','CuNYj','ZmUUp','signin','YlMXT','jepcS','ZTTUz','returns\x20404\x20if\x20member\x20uuid\x20is\x20not\x20found','/members?token=test&action=signup','XAvDq','gDUbt','/blah','init','JDkZK','args','1614036EumhbX','KyXCp','lQhLP','https://site.com/blah/my-post/#comment-123','1|3|0|4|2','gKpkW','redirects\x20member\x20to\x20referrer\x20param\x20path\x20on\x20signup\x20if\x20it\x20is\x20on\x20the\x20site','571576XFwXuG','getSiteUrl','ZIFpR','oUaxu','Test\x20Name','2753142pmFheQ','Product','2|0|5|6|3|1|4','exchangeTokenForSession','sEtfM','PkxZK','QFHbS','lengthOf','pOhMu','SNIVJ','query','ssr','5736246MbXYuT','4|5|3|1|0|2|6','TQQkb','vOigF'];_0x11e3=function(){return _0x1745a8;};return _0x11e3();}const should=require(_0x492b60(0x1ca)),sinon=require(_0x492b60(0x1dd)),urlUtils=require('../../../../../core/shared/url-utils'),membersService=require(_0x492b60(0x1da)),membersMiddleware=require(_0x492b60(0x1ee)),models=require('../../../../../core/server/models');describe('Members\x20Service\x20Middleware',function(){const _0xa4ed8e=_0x492b60,_0x26e255={'PkxZK':function(_0x9bf52,_0x4a4883){return _0x9bf52!==_0x4a4883;},'zVEje':_0xa4ed8e(0x196),'ZIFpR':_0xa4ed8e(0x1fe),'GymnJ':_0xa4ed8e(0x1bc),'KyXCp':_0xa4ed8e(0x1f9),'WOqPL':_0xa4ed8e(0x1fb),'PZCCI':'signup','wQmhe':_0xa4ed8e(0x1b7),'mwrWm':_0xa4ed8e(0x18f),'kcJyo':_0xa4ed8e(0x193),'lMqNL':_0xa4ed8e(0x1d0),'QepUH':_0xa4ed8e(0x1ae),'pNorI':'test','vOigF':_0xa4ed8e(0x1e8),'YlMXT':'https://site.com/blah/my-post/#comment-123','ZmUUp':'https://site.com/blah/my-post/?action=signup&success=true#comment-123','EoOFn':_0xa4ed8e(0x1ba),'vDSra':_0xa4ed8e(0x19f),'jepcS':_0xa4ed8e(0x206),'JDkZK':_0xa4ed8e(0x1db),'EhVmD':function(_0x2abc5c,_0x1fbd45){return _0x2abc5c===_0x1fbd45;},'CuNYj':_0xa4ed8e(0x1b9),'XAvDq':function(_0x24280f,_0x1d2046){return _0x24280f(_0x1d2046);},'Mchin':function(_0x1ce2b2,_0x3abdeb,_0x4a6108){return _0x1ce2b2(_0x3abdeb,_0x4a6108);},'sGFUN':function(_0x2e5205,_0x476d3f,_0x2eb62e){return _0x2e5205(_0x476d3f,_0x2eb62e);},'tJLGq':function(_0x1c3b3f,_0xf92779,_0x3989bf){return _0x1c3b3f(_0xf92779,_0x3989bf);},'uLKnd':_0xa4ed8e(0x1c8),'gOwlY':function(_0x53dae0,_0x34aa86,_0x436e70){return _0x53dae0(_0x34aa86,_0x436e70);},'shcNm':_0xa4ed8e(0x1a0),'KbOUw':_0xa4ed8e(0x1e4),'ToZrB':'bMrCZ','YodZx':function(_0x57cb20,_0x1343ee){return _0x57cb20(_0x1343ee);},'iWDsH':_0xa4ed8e(0x1a7),'VhjvK':function(_0x5ba9de,_0x59e502,_0x334c6d){return _0x5ba9de(_0x59e502,_0x334c6d);},'bqmXL':function(_0x475c47,_0x3f1d76,_0x5f5aa2){return _0x475c47(_0x3f1d76,_0x5f5aa2);},'hywZs':'returns\x20400\x20on\x20error','xMYAk':function(_0x5d7ee8,_0x5b257f,_0x296fe3){return _0x5d7ee8(_0x5b257f,_0x296fe3);},'QFHbS':_0xa4ed8e(0x1d1)};_0x26e255[_0xa4ed8e(0x1b5)](describe,_0xa4ed8e(0x1c1),function(){const _0x133ec5=_0xa4ed8e,_0xacde21={'ZtSBI':_0x26e255['vDSra'],'KUWiL':_0x133ec5(0x1fe),'aTnpa':_0x26e255[_0x133ec5(0x1f8)],'ciweW':_0x26e255[_0x133ec5(0x19e)],'gDUbt':'test','OfkgH':_0x133ec5(0x1ce),'HSGmq':_0x26e255[_0x133ec5(0x200)],'TQQkb':function(_0x4a2cdc,_0x524b5b){const _0x41554b=_0x133ec5;return _0x26e255[_0x41554b(0x19a)](_0x4a2cdc,_0x524b5b);},'pOhMu':_0x133ec5(0x18a)};if(_0x133ec5(0x1b9)===_0x26e255[_0x133ec5(0x1f4)]){let _0x330168,_0x2dc833,_0x3187f9,_0x2fd938,_0x461f86;_0x26e255[_0x133ec5(0x1fc)](before,function(){const _0x356611=_0x133ec5;_0x26e255[_0x356611(0x18b)](_0x26e255[_0x356611(0x1e9)],_0x356611(0x1e5))?models[_0x356611(0x1ff)]():(_0x58b2a8={},_0x161e58={},_0x291a80=_0xbc7fb9[_0x356611(0x1ab)](),_0x427e5f[_0x356611(0x1f1)]=_0x267296[_0x356611(0x1ab)]()[_0x356611(0x1de)](''),_0xd4b69b=_0xb0ed5f[_0x356611(0x191)],_0x5aab2b[_0x356611(0x191)]={'exchangeTokenForSession':_0x5cbecc[_0x356611(0x1ab)]()},_0x6440a6=_0x5cf833[_0x356611(0x187)],_0x373fa3[_0x356611(0x187)]={'findOne':_0x1e2e32[_0x356611(0x1ab)]()},_0x2124af[_0x356611(0x1ab)](_0x42d6d2,_0xacde21[_0x356611(0x1d9)])['returns'](_0xacde21[_0x356611(0x1a9)]),_0x4a4546[_0x356611(0x1ab)](_0x3504f7,_0x356611(0x20a))[_0x356611(0x1de)](_0x356611(0x1bc)));}),beforeEach(function(){const _0x75ca10=_0x133ec5;_0x3187f9={},_0x2fd938={},_0x461f86=sinon[_0x75ca10(0x1ab)](),_0x2fd938['redirect']=sinon['stub']()[_0x75ca10(0x1de)](''),_0x330168=membersService[_0x75ca10(0x191)],membersService['ssr']={'exchangeTokenForSession':sinon[_0x75ca10(0x1ab)]()},_0x2dc833=models[_0x75ca10(0x187)],models['Product']={'findOne':sinon[_0x75ca10(0x1ab)]()},sinon[_0x75ca10(0x1ab)](urlUtils,'getSubdir')[_0x75ca10(0x1de)](_0x26e255[_0x75ca10(0x20b)]),sinon[_0x75ca10(0x1ab)](urlUtils,_0x75ca10(0x20a))[_0x75ca10(0x1de)](_0x26e255[_0x75ca10(0x19b)]);}),_0x26e255[_0x133ec5(0x1fc)](afterEach,function(){const _0x2b8448=_0x133ec5;membersService[_0x2b8448(0x191)]=_0x330168,models['Product']=_0x2dc833,sinon[_0x2b8448(0x1cb)]();}),it('calls\x20next\x20if\x20url\x20does\x20not\x20include\x20a\x20token',async function(){const _0x13cda9=_0x133ec5,_0x952ce0=_0xacde21[_0x13cda9(0x1ea)][_0x13cda9(0x1b6)]('|');let _0x24939f=0x0;while(!![]){switch(_0x952ce0[_0x24939f++]){case'0':await membersMiddleware[_0x13cda9(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86);continue;case'1':_0x3187f9[_0x13cda9(0x1d7)]=_0x13cda9(0x1ac);continue;case'2':_0x461f86[_0x13cda9(0x1b4)][_0x13cda9(0x201)][_0x13cda9(0x1ca)]['be']['an'][_0x13cda9(0x1ad)]()['with'][_0x13cda9(0x18d)](0x0);continue;case'3':_0x3187f9[_0x13cda9(0x190)]={};continue;case'4':_0x461f86[_0x13cda9(0x1c7)][_0x13cda9(0x1ca)]['be']['true']();continue;}break;}}),_0x26e255[_0x133ec5(0x1cf)](it,_0x133ec5(0x1af),async function(){const _0x9f6a75=_0x133ec5;_0x3187f9[_0x9f6a75(0x1d7)]=_0xacde21[_0x9f6a75(0x1ef)],_0x3187f9[_0x9f6a75(0x190)]={'token':_0xacde21[_0x9f6a75(0x1fd)],'action':_0xacde21[_0x9f6a75(0x1cd)]},membersService[_0x9f6a75(0x191)]['exchangeTokenForSession'][_0x9f6a75(0x1c4)]({'subscriptions':[{'status':_0x9f6a75(0x1d0),'tier':{'welcome_page_url':''}}]}),await membersMiddleware['createSessionFromMagicLink'](_0x3187f9,_0x2fd938,_0x461f86),_0x461f86[_0x9f6a75(0x1c7)][_0x9f6a75(0x1ca)]['be']['false'](),_0x2fd938[_0x9f6a75(0x1f1)][_0x9f6a75(0x1c7)][_0x9f6a75(0x1ca)]['be'][_0x9f6a75(0x1e7)](),_0x2fd938[_0x9f6a75(0x1f1)][_0x9f6a75(0x1b4)][_0x9f6a75(0x201)][0x0]['should'][_0x9f6a75(0x1c5)](_0xacde21[_0x9f6a75(0x1a8)]);}),_0x26e255[_0x133ec5(0x198)](it,_0x133ec5(0x1f3),async function(){const _0x5bd0fe=_0x133ec5;if(_0x5bd0fe(0x1f9)===_0x26e255[_0x5bd0fe(0x203)])_0x3187f9[_0x5bd0fe(0x1d7)]=_0x26e255[_0x5bd0fe(0x19e)],_0x3187f9[_0x5bd0fe(0x190)]={'token':_0x5bd0fe(0x1aa),'action':_0x26e255[_0x5bd0fe(0x1c0)]},membersService[_0x5bd0fe(0x191)][_0x5bd0fe(0x189)][_0x5bd0fe(0x1e0)](),await membersMiddleware[_0x5bd0fe(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86),_0x461f86[_0x5bd0fe(0x1c7)][_0x5bd0fe(0x1ca)]['be'][_0x5bd0fe(0x1bf)](),_0x2fd938[_0x5bd0fe(0x1f1)]['calledOnce'][_0x5bd0fe(0x1ca)]['be']['true'](),_0x2fd938[_0x5bd0fe(0x1f1)][_0x5bd0fe(0x1b4)]['args'][0x0][_0x5bd0fe(0x1ca)][_0x5bd0fe(0x1c5)](_0x26e255[_0x5bd0fe(0x1a3)]);else return'https://custom.com/redirect/';}),_0x26e255[_0x133ec5(0x1b5)](it,_0x26e255[_0x133ec5(0x1e2)],async function(){const _0x3c8ebf=_0x133ec5,_0x3be558={'JvNoO':_0x3c8ebf(0x1b1)};if(_0xacde21[_0x3c8ebf(0x194)](_0x3c8ebf(0x1eb),_0xacde21[_0x3c8ebf(0x18e)]))return{'members':{'get':_0x31d6ee[_0x3c8ebf(0x1ab)]()[_0x3c8ebf(0x1c4)]()}};else _0x3187f9['url']=_0x3c8ebf(0x1fb),_0x3187f9[_0x3c8ebf(0x190)]={'token':_0xacde21[_0x3c8ebf(0x1fd)],'action':_0x3c8ebf(0x1ce)},membersService[_0x3c8ebf(0x191)][_0x3c8ebf(0x189)][_0x3c8ebf(0x1c4)]({}),models[_0x3c8ebf(0x187)][_0x3c8ebf(0x199)][_0x3c8ebf(0x1c4)]({'get':()=>{const _0x4ee4a2=_0x3c8ebf;return _0x3be558[_0x4ee4a2(0x1b2)];}}),await membersMiddleware[_0x3c8ebf(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86),_0x461f86[_0x3c8ebf(0x1c7)][_0x3c8ebf(0x1ca)]['be'][_0x3c8ebf(0x1bf)](),_0x2fd938[_0x3c8ebf(0x1f1)][_0x3c8ebf(0x1c7)][_0x3c8ebf(0x1ca)]['be'][_0x3c8ebf(0x1e7)](),_0x2fd938[_0x3c8ebf(0x1f1)][_0x3c8ebf(0x1b4)]['args'][0x0]['should']['eql'](_0x3c8ebf(0x1b1));}),_0x26e255['gOwlY'](it,'redirects\x20paid\x20member\x20to\x20custom\x20redirect\x20on\x20signup',async function(){const _0x5e8f6b=_0x133ec5;if(_0x5e8f6b(0x1d6)!==_0x26e255['mwrWm']){const _0x2dc5c6=_0x26e255[_0x5e8f6b(0x1e1)][_0x5e8f6b(0x1b6)]('|');let _0x21bfbb=0x0;while(!![]){switch(_0x2dc5c6[_0x21bfbb++]){case'0':_0x461f86['calledOnce'][_0x5e8f6b(0x1ca)]['be'][_0x5e8f6b(0x1bf)]();continue;case'1':await membersMiddleware[_0x5e8f6b(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86);continue;case'2':_0x2fd938[_0x5e8f6b(0x1f1)][_0x5e8f6b(0x1c7)]['should']['be'][_0x5e8f6b(0x1e7)]();continue;case'3':membersService[_0x5e8f6b(0x191)][_0x5e8f6b(0x189)][_0x5e8f6b(0x1c4)]({'subscriptions':[{'status':_0x26e255['lMqNL'],'tier':{'welcome_page_url':_0x26e255[_0x5e8f6b(0x1a4)]}}]});continue;case'4':_0x3187f9['url']=_0x5e8f6b(0x1fb);continue;case'5':_0x3187f9[_0x5e8f6b(0x190)]={'token':_0x26e255['pNorI'],'action':_0x26e255[_0x5e8f6b(0x1c0)]};continue;case'6':_0x2fd938[_0x5e8f6b(0x1f1)][_0x5e8f6b(0x1b4)][_0x5e8f6b(0x201)][0x0][_0x5e8f6b(0x1ca)]['eql'](_0x5e8f6b(0x1d5));continue;}break;}}else _0x346d84={'body':{'newsletters':[],'enable_comment_notifications':null}},_0x364a82={'writeHead':_0x3effe1[_0x5e8f6b(0x1ab)](),'end':_0x48df95[_0x5e8f6b(0x1ab)]()};}),it(_0x26e255[_0x133ec5(0x1ed)],async function(){const _0x22f0ce=_0x133ec5,_0x2d7c9a='1|6|5|4|0|3|2'['split']('|');let _0x2719d3=0x0;while(!![]){switch(_0x2d7c9a[_0x2719d3++]){case'0':_0x461f86[_0x22f0ce(0x1c7)]['should']['be'][_0x22f0ce(0x1bf)]();continue;case'1':_0x3187f9[_0x22f0ce(0x1d7)]=_0x22f0ce(0x1a6);continue;case'2':_0x2fd938['redirect'][_0x22f0ce(0x1b4)][_0x22f0ce(0x201)][0x0][_0x22f0ce(0x1ca)][_0x22f0ce(0x1c5)](_0x26e255[_0x22f0ce(0x195)]);continue;case'3':_0x2fd938[_0x22f0ce(0x1f1)]['calledOnce']['should']['be'][_0x22f0ce(0x1e7)]();continue;case'4':await membersMiddleware['createSessionFromMagicLink'](_0x3187f9,_0x2fd938,_0x461f86);continue;case'5':membersService['ssr'][_0x22f0ce(0x189)][_0x22f0ce(0x1c4)]({});continue;case'6':_0x3187f9[_0x22f0ce(0x190)]={'token':_0x22f0ce(0x1aa),'action':'signin','r':_0x22f0ce(0x205)};continue;}break;}}),it(_0x133ec5(0x208),async function(){const _0x3474d7=_0x133ec5,_0x51f71f='5|0|4|6|1|3|2'['split']('|');let _0x2ce92e=0x0;while(!![]){switch(_0x51f71f[_0x2ce92e++]){case'0':_0x3187f9['query']={'token':_0x26e255[_0x3474d7(0x1d3)],'action':_0x3474d7(0x1ce),'r':_0x26e255[_0x3474d7(0x1f7)]};continue;case'1':_0x461f86[_0x3474d7(0x1c7)][_0x3474d7(0x1ca)]['be'][_0x3474d7(0x1bf)]();continue;case'2':_0x2fd938['redirect'][_0x3474d7(0x1b4)][_0x3474d7(0x201)][0x0][_0x3474d7(0x1ca)][_0x3474d7(0x1c5)](_0x26e255[_0x3474d7(0x1f5)]);continue;case'3':_0x2fd938[_0x3474d7(0x1f1)]['calledOnce']['should']['be'][_0x3474d7(0x1e7)]();continue;case'4':membersService[_0x3474d7(0x191)]['exchangeTokenForSession']['resolves']({});continue;case'5':_0x3187f9[_0x3474d7(0x1d7)]='/members?token=test&action=signup&r=https%3A%2F%2Fsite.com%2Fblah%2Fmy-post%2F';continue;case'6':await membersMiddleware[_0x3474d7(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86);continue;}break;}}),it(_0x26e255[_0x133ec5(0x1cc)],async function(){const _0xc9a191=_0x133ec5;_0x3187f9[_0xc9a191(0x1d7)]='/members?token=test&action=signin&r=https%3A%2F%2Fexternal.com%2Fwhatever%2F',_0x3187f9[_0xc9a191(0x190)]={'token':'test','action':_0xc9a191(0x1f6),'r':_0xc9a191(0x1a2)},membersService[_0xc9a191(0x191)]['exchangeTokenForSession'][_0xc9a191(0x1c4)]({}),await membersMiddleware[_0xc9a191(0x1c1)](_0x3187f9,_0x2fd938,_0x461f86),_0x461f86['calledOnce'][_0xc9a191(0x1ca)]['be'][_0xc9a191(0x1bf)](),_0x2fd938[_0xc9a191(0x1f1)][_0xc9a191(0x1c7)][_0xc9a191(0x1ca)]['be'][_0xc9a191(0x1e7)](),_0x2fd938['redirect'][_0xc9a191(0x1b4)][_0xc9a191(0x201)][0x0][_0xc9a191(0x1ca)][_0xc9a191(0x1c5)](_0x26e255[_0xc9a191(0x1c3)]);});}else _0x7f08dd[_0x133ec5(0x1cb)]();}),_0x26e255['xMYAk'](describe,_0x26e255[_0xa4ed8e(0x18c)],function(){const _0x12e5e0=_0xa4ed8e,_0x3dddac={'gKpkW':_0x12e5e0(0x1bb),'KbuQx':function(_0x13f0cf,_0x5af461){return _0x26e255['EhVmD'](_0x13f0cf,_0x5af461);},'BVuxr':_0x12e5e0(0x188),'kvnuI':_0x26e255[_0x12e5e0(0x1d3)],'hUbQp':_0x12e5e0(0x1ec),'lQhLP':_0x12e5e0(0x185),'oUaxu':_0x12e5e0(0x1a5)};if(_0x26e255[_0x12e5e0(0x1e3)]!==_0x26e255['ToZrB'])_0x1593ea[_0x12e5e0(0x1ff)]();else{let _0x42bf1d,_0x4a690d;_0x26e255['XAvDq'](before,function(){const _0x3eaed3=_0x12e5e0;models[_0x3eaed3(0x1ff)]();}),beforeEach(function(){const _0x23d303=_0x12e5e0;_0x42bf1d={'body':{'newsletters':[],'enable_comment_notifications':null}},_0x4a690d={'writeHead':sinon[_0x23d303(0x1ab)](),'end':sinon[_0x23d303(0x1ab)]()};}),_0x26e255[_0x12e5e0(0x1df)](afterEach,function(){const _0x4345ae=_0x12e5e0;sinon[_0x4345ae(0x1cb)]();}),it(_0x26e255['iWDsH'],async function(){const _0x2edc14=_0x12e5e0,_0x59fc4c=_0x3dddac[_0x2edc14(0x207)]['split']('|');let _0x38f74a=0x0;while(!![]){switch(_0x59fc4c[_0x38f74a++]){case'0':_0x42bf1d[_0x2edc14(0x190)]={};continue;case'1':_0x4a690d[_0x2edc14(0x1b3)][_0x2edc14(0x1b4)][_0x2edc14(0x201)][0x0][_0x2edc14(0x1ca)][_0x2edc14(0x1c5)](0x190);continue;case'2':_0x4a690d[_0x2edc14(0x1be)]['firstCall'][_0x2edc14(0x201)][0x0][_0x2edc14(0x1ca)]['eql'](_0x2edc14(0x1e6));continue;case'3':_0x4a690d[_0x2edc14(0x1b3)][_0x2edc14(0x1c7)][_0x2edc14(0x1ca)]['be']['true']();continue;case'4':await membersMiddleware[_0x2edc14(0x1d1)](_0x42bf1d,_0x4a690d);continue;case'5':_0x4a690d[_0x2edc14(0x1be)][_0x2edc14(0x1c7)][_0x2edc14(0x1ca)]['be'][_0x2edc14(0x1e7)]();continue;}break;}}),it(_0x12e5e0(0x1fa),async function(){const _0x3a02f7=_0x12e5e0;if(_0x3dddac['KbuQx']('YqWpe','MHjdJ'))_0x3767e3[_0x3a02f7(0x191)]=_0x53d557,_0x5d3657[_0x3a02f7(0x187)]=_0x2b032f,_0x4e8052[_0x3a02f7(0x1cb)]();else{const _0x5ed871=_0x3dddac['BVuxr'][_0x3a02f7(0x1b6)]('|');let _0x2fdd5e=0x0;while(!![]){switch(_0x5ed871[_0x2fdd5e++]){case'0':sinon['stub'](membersService,_0x3a02f7(0x1a5))[_0x3a02f7(0x1f0)](()=>{const _0x2f371a=_0x3a02f7;return{'members':{'get':sinon['stub']()[_0x2f371a(0x1c4)]()}};});continue;case'1':_0x4a690d['end'][_0x3a02f7(0x1c7)]['should']['be'][_0x3a02f7(0x1e7)]();continue;case'2':_0x42bf1d[_0x3a02f7(0x190)]={'uuid':_0x3dddac[_0x3a02f7(0x1c6)]};continue;case'3':_0x4a690d[_0x3a02f7(0x1b3)][_0x3a02f7(0x1b4)][_0x3a02f7(0x201)][0x0]['should']['eql'](0x194);continue;case'4':_0x4a690d[_0x3a02f7(0x1be)]['firstCall'][_0x3a02f7(0x201)][0x0][_0x3a02f7(0x1ca)][_0x3a02f7(0x1c5)](_0x3dddac[_0x3a02f7(0x1bd)]);continue;case'5':await membersMiddleware[_0x3a02f7(0x1d1)](_0x42bf1d,_0x4a690d);continue;case'6':_0x4a690d['writeHead']['calledOnce'][_0x3a02f7(0x1ca)]['be'][_0x3a02f7(0x1e7)]();continue;}break;}}}),_0x26e255[_0x12e5e0(0x1d4)](it,'attempts\x20to\x20update\x20newsletters',async function(){const _0x5480dd=_0x12e5e0,_0x49391f={'EdHeG':_0x5480dd(0x1a1)};if('PtzCg'!==_0x5480dd(0x1c9)){_0x4a690d[_0x5480dd(0x1f2)]=sinon[_0x5480dd(0x1ab)](),_0x42bf1d[_0x5480dd(0x190)]={'uuid':_0x3dddac[_0x5480dd(0x1c6)]};const _0x1703f2={'id':_0x5480dd(0x1aa),'email':_0x5480dd(0x1a1),'name':_0x3dddac[_0x5480dd(0x204)],'newsletters':[],'enable_comment_notifications':![],'status':'free'};sinon['stub'](membersService,_0x3dddac[_0x5480dd(0x20c)])[_0x5480dd(0x1f0)](()=>{const _0x27edae=_0x5480dd;return{'members':{'get':sinon[_0x27edae(0x1ab)]()[_0x27edae(0x1c4)]({'id':_0x27edae(0x1aa),'email':_0x49391f[_0x27edae(0x1b0)],'get':()=>_0x27edae(0x1aa)}),'update':sinon[_0x27edae(0x1ab)]()[_0x27edae(0x1c4)]({..._0x1703f2,'toJSON':()=>JSON[_0x27edae(0x1d2)](_0x1703f2)})}};}),await membersMiddleware[_0x5480dd(0x1d1)](_0x42bf1d,_0x4a690d),_0x4a690d[_0x5480dd(0x1f2)]['calledOnce'][_0x5480dd(0x1ca)]['be'][_0x5480dd(0x1e7)]();}else _0xcd3bb['init']();}),_0x26e255[_0x12e5e0(0x1dc)](it,_0x26e255[_0x12e5e0(0x19d)],async function(){const _0x1c1214=_0x12e5e0;_0x42bf1d={},await membersMiddleware[_0x1c1214(0x1d1)](_0x42bf1d,_0x4a690d),_0x4a690d['writeHead'][_0x1c1214(0x1c7)][_0x1c1214(0x1ca)]['be'][_0x1c1214(0x1e7)](),_0x4a690d['writeHead'][_0x1c1214(0x1b4)][_0x1c1214(0x201)][0x0]['should'][_0x1c1214(0x1c5)](0x190),_0x4a690d[_0x1c1214(0x1be)][_0x1c1214(0x1c7)]['should']['be'][_0x1c1214(0x1e7)](),_0x4a690d[_0x1c1214(0x1be)]['firstCall'][_0x1c1214(0x201)][0x0]['should'][_0x1c1214(0x1c5)]('Failed\x20to\x20update\x20newsletters');});}});});