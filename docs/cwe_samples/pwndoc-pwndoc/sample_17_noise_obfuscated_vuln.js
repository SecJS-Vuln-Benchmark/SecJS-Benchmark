'use strict';function _0x3b8d(){const _0x3add4d=['tpmda','QEcUD','ztFXF','@podium/test-utils','BwtLa','qiZzi','/some/where/else','podlet','fazJI','MKjrv','/layout/proxy/bar/a','GAChv','HwLKr','45KtIAZe','arwUt','3|2|0|1|4','466982nbhqlW','ywkRH','http://','process','Siabq','dKsWF','564COXSgk','EpvRO','listen','end','oRzbm','localhost','GET','trailer','165ewQMTG','egGTv','headers','bar','242008VbZORU','amZsR','YWVQo','forEach','/layout/proxy/bar/a?foo=bar','SPfsU','GFaat','Trailer\x20header\x20should\x20not\x20be\x20set','DdDPd','/some/path?foo=bar','address','stringify','payload','gOsZH','locals','pipe','cQNLg','aLePr','error','type','gzMUi','SWcVh','meta','60402qRcLIZ','cDjXk','ELZBm','5|1|8|0|7|4|2|3|6','length','equal','application/json','setHeader','xLKQU','YICRJ','DrlkH','sMQQZ','/layout/','server','AUEnv','method','828303BcWvRQ','OgzTs','/layout/proxy/foo/b','Proxying()\x20-\x20proxy\x20to\x20a\x20non\x20existing\x20server\x20-\x20GET\x20request\x20will\x20error\x20-\x20should\x20collect\x20error\x20metric','4782AMkOsA','POST','Proxying()\x20-\x20mount\x20proxy\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/path\x22','toDSa','Mgzxm','statusCode','podium','Proxying()\x20-\x20GET\x20request\x20with\x20query\x20params\x20-\x20should\x20proxy\x20query\x20params\x20to\x20\x22{destination}/some/path\x22','sccir','jWuLS','foo','Proxying()\x20-\x20GET\x20request\x20with\x20additional\x20path\x20values\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/path/extra?foo=bar\x22','@podium/utils','UGGkt','Proxying()\x20-\x20mount\x20proxy\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/where/else\x22','Proxying()\x20-\x20POST\x20request\x20-\x20should\x20proxy\x20query\x20params\x20to\x20\x22{destination}/some/path\x22','/foo','HrBGL','AWmuT','createServer','mylayout','close','OPIUH','port','return\x20Object.keys({a:1});','KIFlG','JSkZz','body','http://localhost:9854','xzDXp','RsyzD','qVcFS','metrics','match','/some/path/extra?foo=bar','proxy','210020xdwtqP','mAMkM','/layout/proxy/bar/a/extra?foo=bar','sqeEw','catch','rlMJM','then','podium_proxy_process','PhyOR','console.log(\x22timer\x22);','push','curl\x20-i\x20-H\x20\x27Trailer:\x20Krynos\x27\x20-H\x20\x27User-Agent:\x20Mozilla\x27\x20\x27','/some/path','JzLRa','labels','WRWnO','register','Content-Type','TwnLK','kJTbi','url','fTVks','BOivl','app','request','1.0.0','Xrlos','GffOg','name','destination','xweNd','qwfPo','amBmy','806690OMshDS','BkueN','aobnd','UjWpP','host'];_0x3b8d=function(){return _0x3add4d;};return _0x3b8d();}const _0x271de8=_0x3563;(function(_0x1ab0e7,_0x1db329){const _0x582a73=_0x3563,_0x10baa7=_0x1ab0e7();while(!![]){try{const _0x586e1c=parseInt(_0x582a73(0x100))/0x1+parseInt(_0x582a73(0x9f))/0x2+parseInt(_0x582a73(0xdc))/0x3*(-parseInt(_0x582a73(0xa5))/0x4)+-parseInt(_0x582a73(0xad))/0x5*(parseInt(_0x582a73(0xc8))/0x6)+-parseInt(_0x582a73(0xd8))/0x7+parseInt(_0x582a73(0xb1))/0x8+-parseInt(_0x582a73(0x9c))/0x9*(-parseInt(_0x582a73(0x8a))/0xa);if(_0x586e1c===_0x1db329)break;else _0x10baa7['push'](_0x10baa7['shift']());}catch(_0x114639){_0x10baa7['push'](_0x10baa7['shift']());}}}(_0x3b8d,0x31455));const {test}=require('tap'),{exec}=require('child_process'),{destinationObjectStream,HttpServer,request}=require(_0x271de8(0x92)),{HttpIncoming}=require(_0x271de8(0xe8)),http=require('http'),Proxy=require('..'),reqFn=(_0x2585bd,_0x24b762)=>{const _0x307c9e=_0x271de8,_0x224562={'AUEnv':'Content-Type','xweNd':_0x307c9e(0x86)};_0x24b762['statusCode']=0xc8,_0x24b762[_0x307c9e(0xcf)](_0x224562[_0x307c9e(0xd6)],_0x307c9e(0xce)),_0x24b762[_0x307c9e(0xa8)](JSON[_0x307c9e(0xbc)]({'method':_0x2585bd[_0x307c9e(0xd7)],'type':_0x224562[_0x307c9e(0x87)],'url':_0x307c9e(0xa1)+_0x2585bd[_0x307c9e(0xaf)][_0x307c9e(0x8e)]+_0x2585bd['url']}));};function _0x3563(_0x5638a4,_0x45799f){const _0x3b8df2=_0x3b8d();return _0x3563=function(_0x3563c5,_0x35bb65){_0x3563c5=_0x3563c5-0x77;let _0xf6ae45=_0x3b8df2[_0x3563c5];return _0xf6ae45;},_0x3563(_0x5638a4,_0x45799f);}class ProxyServer{constructor(_0x1d8709=[],_0x2cdf2a={}){const _0x3d250a=_0x271de8,_0x591fe7={'LGhwR':function(_0x4fdc5b,_0x7fe577){return _0x4fdc5b!==_0x7fe577;},'cQNLg':_0x3d250a(0x91),'BwtLa':_0x3d250a(0xb8),'JzLRa':'Content-Type','egGTv':'updateClock();','rlMJM':'proxy','DdDPd':function(_0x2930fa,_0xc0d8f0){return _0x2930fa===_0xc0d8f0;},'BkueN':'hRwEM','fazJI':_0x3d250a(0xd4)};this[_0x3d250a(0xd5)]=undefined,this[_0x3d250a(0xbb)]='',this[_0x3d250a(0xff)]=new Proxy({'pathname':_0x591fe7[_0x3d250a(0x97)],'prefix':_0x3d250a(0xff)}),_0x1d8709[_0x3d250a(0xb4)](_0x35fc0d=>{const _0x1ce44a=_0x3d250a,_0x36c38a={'OPIUH':function(_0x243ecc,_0x352522){return _0x243ecc(_0x352522);}};_0x591fe7['LGhwR'](_0x591fe7[_0x1ce44a(0xc1)],'lcOch')?this[_0x1ce44a(0xff)][_0x1ce44a(0x79)](_0x35fc0d):_0x205494?_0x36c38a[_0x1ce44a(0xf2)](_0x1aa8bd,_0x591c4e):_0x3ddb1e();}),this['app']=http[_0x3d250a(0xef)]((_0x592903,_0x19ba79)=>{const _0x52ee0e=_0x3d250a,_0xad8a18={'RsyzD':_0x52ee0e(0x7a),'BOivl':_0x52ee0e(0xce),'oRzbm':_0x591fe7[_0x52ee0e(0xae)],'MKjrv':_0x591fe7[_0x52ee0e(0x105)]};if(_0x591fe7[_0x52ee0e(0xb9)](_0x52ee0e(0xe9),_0x591fe7[_0x52ee0e(0x8b)]))_0x440a1b['ok'](!_0x110760[_0x52ee0e(0xaf)][_0x52ee0e(0xac)],_0x591fe7[_0x52ee0e(0x93)]),_0x4847bf[_0x52ee0e(0xe1)]=0xc8,_0x2a5ced[_0x52ee0e(0xcf)](_0x591fe7[_0x52ee0e(0x10d)],_0x52ee0e(0xce)),_0x570e27['end'](_0xe15802[_0x52ee0e(0xbc)]({'method':_0x34c766['method'],'type':_0x52ee0e(0x86),'url':_0x52ee0e(0xa1)+_0x4ce2a6['headers'][_0x52ee0e(0x8e)]+_0x3fb64a[_0x52ee0e(0x7d)]}));else{_0x19ba79[_0x52ee0e(0xbf)]={},_0x19ba79[_0x52ee0e(0xbf)][_0x52ee0e(0xe2)]={},_0x19ba79[_0x52ee0e(0xbf)][_0x52ee0e(0xe2)]['context']={'podium-foo':'bar'};const _0x58c184=new HttpIncoming(_0x592903,_0x19ba79,_0x19ba79[_0x52ee0e(0xbf)]);if(_0x2cdf2a['name'])_0x58c184['name']=_0x2cdf2a[_0x52ee0e(0x85)];this[_0x52ee0e(0xff)][_0x52ee0e(0xa2)](_0x58c184)[_0x52ee0e(0x106)](_0x4d9a7c=>{const _0xe10aae=_0x52ee0e,_0xbc2a00=_0xe10aae(0x9e)['split']('|');let _0x30e9e1=0x0;while(!![]){switch(_0xbc2a00[_0x30e9e1++]){case'0':_0x19ba79['statusCode']=0xc8;continue;case'1':_0x19ba79[_0xe10aae(0xcf)](_0xad8a18[_0xe10aae(0xfa)],_0xad8a18[_0xe10aae(0x7f)]);continue;case'2':if(_0x4d9a7c[_0xe10aae(0xff)])return;continue;case'3':setInterval(_0xad8a18[_0xe10aae(0xa9)],0x3e8);continue;case'4':_0x19ba79[_0xe10aae(0xa8)](JSON['stringify']({'message':'ok','status':0xc8,'type':_0xad8a18['MKjrv']}));continue;}break;}})[_0x52ee0e(0x104)](()=>{const _0x300bf3=_0x52ee0e;_0x19ba79[_0x300bf3(0xe1)]=0x194,_0x19ba79[_0x300bf3(0xcf)](_0x300bf3(0x7a),_0x300bf3(0xce)),_0x19ba79[_0x300bf3(0xa8)](JSON[_0x300bf3(0xbc)]({'message':'not\x20found','status':0x194,'type':_0xad8a18[_0x300bf3(0x98)]}));});}});}[_0x271de8(0xa7)](){const _0x451b68=_0x271de8,_0x5c97bd={'DrlkH':function(_0x56eb94,_0x46e023){return _0x56eb94(_0x46e023);},'aLePr':_0x451b68(0xaa),'mAMkM':_0x451b68(0xf4)};return _0x5c97bd[_0x451b68(0xd2)](Function,_0x5c97bd[_0x451b68(0x101)])(),new Promise(_0x352d02=>{const _0x2b8881=_0x451b68;this[_0x2b8881(0xd5)]=this[_0x2b8881(0x80)][_0x2b8881(0xa7)](0x0,_0x5c97bd[_0x2b8881(0xc2)],()=>{const _0x2eb13b=_0x2b8881;this[_0x2eb13b(0xbb)]='http://'+this['server'][_0x2eb13b(0xbb)]()[_0x2eb13b(0xbb)]+':'+this['server'][_0x2eb13b(0xbb)]()[_0x2eb13b(0xf3)],_0x5c97bd[_0x2eb13b(0xd2)](_0x352d02,this[_0x2eb13b(0xbb)]);});});}[_0x271de8(0xf1)](){const _0x24a8fb=_0x271de8,_0x35fbdf={'gzMUi':function(_0x4f9d2e,_0x1ccc37){return _0x4f9d2e===_0x1ccc37;},'QEcUD':'Szume','EpvRO':_0x24a8fb(0x89),'kJTbi':function(_0x2161ce,_0x30d44a){return _0x2161ce(_0x30d44a);},'dKsWF':function(_0x48137d){return _0x48137d();}};return _0x35fbdf[_0x24a8fb(0x7c)](Function,_0x24a8fb(0xf4))(),new Promise((_0x52817a,_0x44d116)=>{const _0x145b8d=_0x24a8fb,_0x13f080={'sqeEw':_0x145b8d(0xaa),'Mgzxm':function(_0x2e1c29,_0x2d1548){return _0x2e1c29(_0x2d1548);}};this[_0x145b8d(0xd5)][_0x145b8d(0xf1)](_0xe0d5a8=>{const _0x4865d1=_0x145b8d;if(_0x35fbdf[_0x4865d1(0xc5)](_0x35fbdf[_0x4865d1(0x90)],_0x4865d1(0x9a))){const _0x115723={'TwnLK':_0x13f080[_0x4865d1(0x103)]};return _0x13f080[_0x4865d1(0xe0)](_0x549938,_0x4865d1(0xf4))(),new _0x5de045(_0x37a9e8=>{const _0x442650=_0x4865d1;this[_0x442650(0xd5)]=this[_0x442650(0x80)][_0x442650(0xa7)](0x0,_0x115723[_0x442650(0x7b)],()=>{const _0x3c38b2=_0x442650;this[_0x3c38b2(0xbb)]=_0x3c38b2(0xa1)+this['server'][_0x3c38b2(0xbb)]()[_0x3c38b2(0xbb)]+':'+this[_0x3c38b2(0xd5)][_0x3c38b2(0xbb)]()['port'],_0x37a9e8(this[_0x3c38b2(0xbb)]);});});}else _0xe0d5a8?_0x35fbdf[_0x4865d1(0xa6)]===_0x35fbdf['EpvRO']?_0x35fbdf[_0x4865d1(0x7c)](_0x44d116,_0xe0d5a8):this[_0x4865d1(0xff)]['register'](_0xa783f1):_0x35fbdf[_0x4865d1(0xa4)](_0x52817a);});});}}test(_0x271de8(0xde),async _0x1afcdb=>{const _0x878c51=_0x271de8,_0x318b8c={'JNLcn':_0x878c51(0x82),'qVcFS':_0x878c51(0x99)},_0x5f5438=new HttpServer();_0x5f5438[_0x878c51(0x81)]=reqFn;const _0x1c6c00=await _0x5f5438['listen'](),_0x433ed3=new ProxyServer([{'name':_0x878c51(0xb0),'proxy':{'a':_0x1c6c00+_0x878c51(0x10c)},'version':_0x318b8c['JNLcn'],'content':'/'}]),_0x64d5bc=await _0x433ed3['listen'](),{body:_0x1e190b}=await request({'address':_0x64d5bc,'pathname':_0x318b8c[_0x878c51(0xfb)],'json':!![]});_0x1afcdb[_0x878c51(0xcd)](_0x1e190b['type'],'destination'),_0x1afcdb['equal'](_0x1e190b['method'],_0x878c51(0xab)),_0x1afcdb[_0x878c51(0xcd)](_0x1e190b[_0x878c51(0x7d)],_0x1c6c00+_0x878c51(0x10c)),await _0x433ed3[_0x878c51(0xf1)](),await _0x5f5438[_0x878c51(0xf1)](),_0x1afcdb[_0x878c51(0xa8)]();}),test(_0x271de8(0xea),async _0x36fce8=>{const _0x581c91=_0x271de8,_0x2c9ee2={'UjWpP':_0x581c91(0xe6),'OgzTs':function(_0x4d1713,_0x539b48){return _0x4d1713(_0x539b48);}},_0x148cdb=new HttpServer();_0x148cdb[_0x581c91(0x81)]=reqFn;const _0x182b3c=await _0x148cdb[_0x581c91(0xa7)](),_0x5df1b2=new ProxyServer([{'name':_0x2c9ee2[_0x581c91(0x8d)],'proxy':{'b':_0x182b3c+'/some/where/else'},'version':_0x581c91(0x82),'content':'/'}]),_0x322841=await _0x5df1b2[_0x581c91(0xa7)](),{body:_0xfaf962}=await _0x2c9ee2[_0x581c91(0xd9)](request,{'address':_0x322841,'pathname':_0x581c91(0xda),'json':!![]});_0x36fce8[_0x581c91(0xcd)](_0xfaf962['type'],'destination'),_0x36fce8['equal'](_0xfaf962[_0x581c91(0xd7)],_0x581c91(0xab)),_0x36fce8['equal'](_0xfaf962[_0x581c91(0x7d)],_0x182b3c+_0x581c91(0x95)),await _0x5df1b2[_0x581c91(0xf1)](),await _0x148cdb['close'](),_0x36fce8[_0x581c91(0xa8)]();}),test('Proxying()\x20-\x20mount\x20multiple\x20proxies\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20destinations',async _0x5baea0=>{const _0x4e1fac=_0x271de8,_0x1c0b5a={'sccir':_0x4e1fac(0x82),'lpJqH':_0x4e1fac(0xe6),'YWVQo':'destination','HwLKr':_0x4e1fac(0xda),'PhyOR':'GET'},_0x604cfb=new HttpServer();_0x604cfb[_0x4e1fac(0x81)]=reqFn;const _0x1b8c2b=await _0x604cfb[_0x4e1fac(0xa7)](),_0x392513=new ProxyServer([{'name':'bar','proxy':{'a':_0x1b8c2b+_0x4e1fac(0x10c)},'version':_0x1c0b5a[_0x4e1fac(0xe4)],'content':'/'},{'name':_0x1c0b5a['lpJqH'],'proxy':{'b':_0x1b8c2b+_0x4e1fac(0x95)},'version':_0x1c0b5a['sccir'],'content':'/'}]),_0x4cb165=await _0x392513[_0x4e1fac(0xa7)](),_0x5edfaa=await request({'address':_0x4cb165,'pathname':_0x4e1fac(0x99),'json':!![]});_0x5baea0[_0x4e1fac(0xcd)](_0x5edfaa[_0x4e1fac(0xf7)]['type'],_0x1c0b5a[_0x4e1fac(0xb3)]),_0x5baea0['equal'](_0x5edfaa['body'][_0x4e1fac(0xd7)],_0x4e1fac(0xab)),_0x5baea0[_0x4e1fac(0xcd)](_0x5edfaa[_0x4e1fac(0xf7)][_0x4e1fac(0x7d)],_0x1b8c2b+_0x4e1fac(0x10c));const _0x33aa61=await request({'address':_0x4cb165,'pathname':_0x1c0b5a[_0x4e1fac(0x9b)],'json':!![]});_0x5baea0['equal'](_0x33aa61[_0x4e1fac(0xf7)][_0x4e1fac(0xc4)],_0x4e1fac(0x86)),_0x5baea0[_0x4e1fac(0xcd)](_0x33aa61[_0x4e1fac(0xf7)][_0x4e1fac(0xd7)],_0x1c0b5a[_0x4e1fac(0x108)]),_0x5baea0[_0x4e1fac(0xcd)](_0x33aa61[_0x4e1fac(0xf7)][_0x4e1fac(0x7d)],_0x1b8c2b+_0x4e1fac(0x95)),await _0x392513[_0x4e1fac(0xf1)](),await _0x604cfb[_0x4e1fac(0xf1)](),_0x5baea0[_0x4e1fac(0xa8)]();}),test(_0x271de8(0xe7),async _0x28c49c=>{const _0x3b9d28=_0x271de8,_0x2b3852=new HttpServer();_0x2b3852['request']=reqFn;const _0x2932bc=await _0x2b3852[_0x3b9d28(0xa7)](),_0x1517a1=new ProxyServer([{'name':_0x3b9d28(0xb0),'proxy':{'a':_0x2932bc+_0x3b9d28(0x10c)},'version':_0x3b9d28(0x82),'content':'/'}]),_0x555d3a=await _0x1517a1[_0x3b9d28(0xa7)](),{body:_0x4a2543}=await request({'address':_0x555d3a,'pathname':_0x3b9d28(0x102),'json':!![]});_0x28c49c[_0x3b9d28(0xcd)](_0x4a2543[_0x3b9d28(0xc4)],_0x3b9d28(0x86)),_0x28c49c['equal'](_0x4a2543[_0x3b9d28(0xd7)],_0x3b9d28(0xab)),_0x28c49c['equal'](_0x4a2543[_0x3b9d28(0x7d)],_0x2932bc+_0x3b9d28(0xfe)),await _0x1517a1['close'](),await _0x2b3852['close'](),_0x28c49c[_0x3b9d28(0xa8)]();}),test(_0x271de8(0xe3),async _0x262d98=>{const _0x373e73=_0x271de8,_0xe1b6f={'xLKQU':_0x373e73(0x82),'HhZpZ':function(_0x539012,_0x441e92){return _0x539012(_0x441e92);},'AWmuT':_0x373e73(0x86),'tygtU':_0x373e73(0xab)},_0x2c33db=new HttpServer();_0x2c33db[_0x373e73(0x81)]=reqFn;const _0x295e46=await _0x2c33db[_0x373e73(0xa7)](),_0x2639c5=new ProxyServer([{'name':_0x373e73(0xb0),'proxy':{'a':_0x295e46+_0x373e73(0x10c)},'version':_0xe1b6f[_0x373e73(0xd0)],'content':'/'}]),_0x2f20a1=await _0x2639c5[_0x373e73(0xa7)](),{body:_0x209e05}=await _0xe1b6f['HhZpZ'](request,{'address':_0x2f20a1,'pathname':_0x373e73(0xb5),'json':!![]});_0x262d98[_0x373e73(0xcd)](_0x209e05[_0x373e73(0xc4)],_0xe1b6f[_0x373e73(0xee)]),_0x262d98[_0x373e73(0xcd)](_0x209e05[_0x373e73(0xd7)],_0xe1b6f['tygtU']),_0x262d98[_0x373e73(0xcd)](_0x209e05[_0x373e73(0x7d)],_0x295e46+_0x373e73(0xba)),await _0x2639c5[_0x373e73(0xf1)](),await _0x2c33db[_0x373e73(0xf1)](),_0x262d98['end']();}),test(_0x271de8(0xeb),async _0x1a9497=>{const _0x107432=_0x271de8,_0x11bd3f={'qiZzi':_0x107432(0xb0),'ywkRH':function(_0x203df5,_0x1c6a91,_0x593955){return _0x203df5(_0x1c6a91,_0x593955);},'ELZBm':_0x107432(0xbd)},_0x19875e=new HttpServer();_0x19875e[_0x107432(0x81)]=reqFn;const _0x2cf415=await _0x19875e[_0x107432(0xa7)](),_0x2ad071=new ProxyServer([{'name':_0x11bd3f[_0x107432(0x94)],'proxy':{'a':_0x2cf415+_0x107432(0x10c)},'version':_0x107432(0x82),'content':'/'}]),_0x25a85a=await _0x2ad071[_0x107432(0xa7)](),{body:_0x4acb10}=await _0x11bd3f[_0x107432(0xa0)](request,{'address':_0x25a85a,'pathname':_0x107432(0x99),'method':'POST','json':!![]},_0x11bd3f[_0x107432(0xca)]);_0x1a9497[_0x107432(0xcd)](_0x4acb10['type'],_0x107432(0x86)),_0x1a9497[_0x107432(0xcd)](_0x4acb10[_0x107432(0xd7)],_0x107432(0xdd)),_0x1a9497[_0x107432(0xcd)](_0x4acb10[_0x107432(0x7d)],_0x2cf415+_0x107432(0x10c)),await _0x2ad071[_0x107432(0xf1)](),await _0x19875e[_0x107432(0xf1)](),_0x1a9497[_0x107432(0xa8)]();}),test('Proxying()\x20-\x20metrics\x20collection',async _0x47632e=>{const _0x4d2df4=_0x271de8,_0xa9d97d={'aobnd':_0x4d2df4(0x85),'HrBGL':_0x4d2df4(0xf0),'fTVks':_0x4d2df4(0xff),'amZsR':_0x4d2df4(0xc3),'gOsZH':_0x4d2df4(0x96),'YICRJ':_0x4d2df4(0xb0),'tpmda':_0x4d2df4(0x82),'sMQQZ':function(_0x4a715e,_0x52f8de){return _0x4a715e(_0x52f8de);},'DOpbU':'/layout/proxy/foo/a'},_0x19d80a=new HttpServer();_0x19d80a['request']=reqFn;const _0x3840b9=await _0x19d80a[_0x4d2df4(0xa7)](),_0x5584de=new ProxyServer([{'name':'foo','proxy':{'a':_0x4d2df4(0xec)},'version':_0xa9d97d[_0x4d2df4(0x8f)],'content':'/'},{'name':_0xa9d97d[_0x4d2df4(0xd1)],'proxy':{'a':_0x3840b9+_0x4d2df4(0x10c)},'version':_0x4d2df4(0x82),'content':'/'}],{'name':_0x4d2df4(0xf0)});_0x5584de[_0x4d2df4(0xff)][_0x4d2df4(0xfc)]['pipe'](_0xa9d97d[_0x4d2df4(0xd3)](destinationObjectStream,_0x536264=>{const _0x14aeb6=_0x4d2df4,_0x4427c7=_0x14aeb6(0xcb)['split']('|');let _0x370c15=0x0;while(!![]){switch(_0x4427c7[_0x370c15++]){case'0':_0x47632e['match'](_0x536264[0x0][_0x14aeb6(0x77)],[{'name':_0xa9d97d[_0x14aeb6(0x8c)],'value':_0xa9d97d['HrBGL']},{'name':_0x14aeb6(0x96),'value':null},{'name':_0xa9d97d['fTVks'],'value':![]},{'name':_0xa9d97d[_0x14aeb6(0xb2)],'value':![]}]);continue;case'1':_0x47632e['equal'](_0x536264[0x0][_0x14aeb6(0x85)],_0x14aeb6(0x107));continue;case'2':_0x47632e[_0x14aeb6(0xfd)](_0x536264[0x1][_0x14aeb6(0xc7)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});continue;case'3':_0x47632e[_0x14aeb6(0xfd)](_0x536264[0x2][_0x14aeb6(0x77)],[{'name':_0x14aeb6(0x85),'value':_0xa9d97d[_0x14aeb6(0xed)]},{'name':_0xa9d97d[_0x14aeb6(0xbe)],'value':_0xa9d97d[_0x14aeb6(0xd1)]},{'name':_0xa9d97d['fTVks'],'value':!![]},{'name':_0xa9d97d[_0x14aeb6(0xb2)],'value':![]}]);continue;case'4':_0x47632e[_0x14aeb6(0xfd)](_0x536264[0x1]['labels'],[{'name':'name','value':_0x14aeb6(0xf0)},{'name':'podlet','value':'foo'},{'name':_0xa9d97d[_0x14aeb6(0x7e)],'value':!![]},{'name':_0x14aeb6(0xc3),'value':![]}]);continue;case'5':_0x47632e[_0x14aeb6(0xcd)](_0x536264[_0x14aeb6(0xcc)],0x3);continue;case'6':_0x47632e['match'](_0x536264[0x2][_0x14aeb6(0xc7)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});continue;case'7':_0x47632e['match'](_0x536264[0x0][_0x14aeb6(0xc7)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});continue;case'8':_0x47632e[_0x14aeb6(0xcd)](_0x536264[0x0]['type'],0x5);continue;}break;}}));const _0x167234=await _0x5584de['listen']();await request({'address':_0x167234,'pathname':_0xa9d97d['DOpbU']}),await request({'address':_0x167234,'pathname':_0x4d2df4(0x99)}),_0x5584de[_0x4d2df4(0xff)][_0x4d2df4(0xfc)][_0x4d2df4(0x10a)](null),await _0x5584de[_0x4d2df4(0xf1)](),await _0x19d80a['close'](),_0x47632e[_0x4d2df4(0xa8)]();}),test(_0x271de8(0xdb),async _0x449d6e=>{const _0xbdc9f5=_0x271de8,_0x1852ee={'LJajG':_0xbdc9f5(0x107),'ifhpr':'name','toDSa':_0xbdc9f5(0x96),'GFaat':'proxy','JSkZz':_0xbdc9f5(0xf8),'mUCHc':_0xbdc9f5(0x82),'cDjXk':'/layout/proxy/bar/a'},_0x7a850e=_0x1852ee[_0xbdc9f5(0xf6)],_0x58f189=new ProxyServer([{'name':'bar','proxy':{'a':_0x7a850e+_0xbdc9f5(0x10c)},'version':_0x1852ee['mUCHc'],'content':'/'}]),_0x395b09=await _0x58f189[_0xbdc9f5(0xa7)]();_0x58f189[_0xbdc9f5(0xff)][_0xbdc9f5(0xfc)][_0xbdc9f5(0xc0)](destinationObjectStream(_0x59e236=>{const _0x52a58a=_0xbdc9f5;_0x449d6e[_0x52a58a(0xcd)](_0x59e236[_0x52a58a(0xcc)],0x1),_0x449d6e[_0x52a58a(0xcd)](_0x59e236[0x0]['name'],_0x1852ee['LJajG']),_0x449d6e[_0x52a58a(0xcd)](_0x59e236[0x0][_0x52a58a(0xc4)],0x5),_0x449d6e['match'](_0x59e236[0x0][_0x52a58a(0x77)],[{'name':_0x1852ee['ifhpr'],'value':''},{'name':_0x1852ee[_0x52a58a(0xdf)],'value':_0x52a58a(0xb0)},{'name':_0x1852ee[_0x52a58a(0xb7)],'value':!![]},{'name':_0x52a58a(0xc3),'value':!![]}]);})),await request({'address':_0x395b09,'pathname':_0x1852ee[_0xbdc9f5(0xc9)]}),_0x58f189[_0xbdc9f5(0xff)][_0xbdc9f5(0xfc)][_0xbdc9f5(0x10a)](null),await _0x58f189[_0xbdc9f5(0xf1)](),_0x449d6e[_0xbdc9f5(0xa8)]();}),test('Proxying()\x20-\x20trailer\x20header\x20-\x20is\x20not\x20forwarded\x20according\x20to\x20spec',async _0x2a451e=>{const _0x2ba0f7=_0x271de8,_0x1f7ccd={'WRWnO':_0x2ba0f7(0xb8),'Siabq':_0x2ba0f7(0x7a),'xDPmI':_0x2ba0f7(0xce),'qwfPo':_0x2ba0f7(0x86),'KIFlG':_0x2ba0f7(0x109),'Xrlos':function(_0x27b3dc,_0x4d2e62,_0x2dd6f7){return _0x27b3dc(_0x4d2e62,_0x2dd6f7);},'jWuLS':'1.0.0','GffOg':_0x2ba0f7(0xf0)},_0x163ad8=new HttpServer();_0x163ad8[_0x2ba0f7(0x81)]=(_0x170462,_0x5ab821)=>{const _0x1cf50e=_0x2ba0f7;_0x2a451e['ok'](!_0x170462[_0x1cf50e(0xaf)]['trailer'],_0x1f7ccd[_0x1cf50e(0x78)]),_0x5ab821[_0x1cf50e(0xe1)]=0xc8,_0x5ab821['setHeader'](_0x1f7ccd[_0x1cf50e(0xa3)],_0x1f7ccd['xDPmI']),_0x5ab821[_0x1cf50e(0xa8)](JSON[_0x1cf50e(0xbc)]({'method':_0x170462['method'],'type':_0x1f7ccd[_0x1cf50e(0x88)],'url':'http://'+_0x170462['headers']['host']+_0x170462[_0x1cf50e(0x7d)]}));};const _0x27b9bf=await _0x163ad8['listen'](),_0x409da9=new ProxyServer([{'name':_0x2ba0f7(0xe6),'proxy':{'a':_0x27b9bf+_0x2ba0f7(0x10c)},'version':_0x1f7ccd[_0x2ba0f7(0xe5)],'content':'/'}],{'name':_0x1f7ccd[_0x2ba0f7(0x84)]}),_0x127a4d=await _0x409da9[_0x2ba0f7(0xa7)]();await new Promise((_0xa25ed3,_0x3fa9bf)=>{const _0xf64819=_0x2ba0f7;_0x1f7ccd[_0xf64819(0x83)](exec,_0xf64819(0x10b)+_0x127a4d+'/layout/proxy/foo/a\x27',(_0xa0f21e,_0x2bd7da,_0x286254)=>{const _0x5c0b11=_0xf64819,_0x13c8e4={'SWcVh':function(_0x2ed179,_0x3b9113,_0xdaa3a6){return _0x2ed179(_0x3b9113,_0xdaa3a6);},'SPfsU':_0x1f7ccd[_0x5c0b11(0xf5)]};if(_0xa0f21e){if(_0x5c0b11(0xf9)!==_0x5c0b11(0x9d)){_0x3fa9bf(_0xa0f21e),setTimeout(_0x1f7ccd[_0x5c0b11(0xf5)],0x3e8);return;}else{_0x51bd74(_0x276941),_0x13c8e4[_0x5c0b11(0xc6)](_0x167c70,_0x13c8e4[_0x5c0b11(0xb6)],0x3e8);return;}}_0xa25ed3({'stdout':_0x2bd7da,'stderr':_0x286254});});}),_0x2a451e['ok'](!![]),await _0x409da9['close'](),await _0x163ad8[_0x2ba0f7(0xf1)](),_0x2a451e[_0x2ba0f7(0xa8)]();});