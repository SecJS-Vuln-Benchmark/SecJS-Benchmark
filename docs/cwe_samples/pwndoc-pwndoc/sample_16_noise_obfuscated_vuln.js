'use strict';const _0x555bd0=_0x55d1;(function(_0x1323e6,_0x2cf6ec){const _0x5993f8=_0x55d1,_0x214e88=_0x1323e6();while(!![]){try{const _0x5dc8ad=-parseInt(_0x5993f8(0xe7))/0x1+parseInt(_0x5993f8(0xfe))/0x2+-parseInt(_0x5993f8(0xea))/0x3*(parseInt(_0x5993f8(0x121))/0x4)+parseInt(_0x5993f8(0x107))/0x5+parseInt(_0x5993f8(0x112))/0x6+parseInt(_0x5993f8(0xc9))/0x7+parseInt(_0x5993f8(0x125))/0x8*(-parseInt(_0x5993f8(0xca))/0x9);if(_0x5dc8ad===_0x2cf6ec)break;else _0x214e88['push'](_0x214e88['shift']());}catch(_0x21b65b){_0x214e88['push'](_0x214e88['shift']());}}}(_0x5071,0x8cc80));function _0x55d1(_0x5afb02,_0xf4627f){const _0x5071d9=_0x5071();return _0x55d1=function(_0x55d14b,_0xe289fa){_0x55d14b=_0x55d14b-0xc7;let _0x465011=_0x5071d9[_0x55d14b];return _0x465011;},_0x55d1(_0x5afb02,_0xf4627f);}function _0x5071(){const _0x209900=['prototype','VhzPr','@metrics/client','url','request','podiumProxyExtras','hostname','33424HYwOnv','search','histogram','ZKXOB','16nixQsa','log','forEach','QBmiO','ntZpA','pathnameEntries','trailer','port','podiumPodletName','debug','1301202dUoGpY','2498625mjoqAJ','pathnameParser','uriBuilder','XMedm','exports','call','@podium/schemas','uriIsRelative','headers','qQHTS','name','fsdSK','KxTzb','protocol','http-proxy','ttIIT','The\x20value\x20for\x20the\x20required\x20argument\x20\x22manifest\x22\x20is\x20not\x20defined\x20or\x20not\x20valid.','web','QSytB','podiumProxyName','parse','lGsmh','KnHOo','defineProperty',':podiumProxyExtras*','kzltf','serializeContext','finish','keys','726228JmxsxO','pathnameBuilder','Error\x20emitted\x20by\x20the\x20registry\x20in\x20@podium/proxy\x20module','111UsBczU','metrics','LWPOC','createProxy','TByPI','console.log(\x22timer\x22);','timer','Measures\x20time\x20spent\x20in\x20the\x20proxy\x20process\x20method','/podium-resource','Error\x20emitted\x20by\x20proxy\x20in\x20@podium/proxy\x20module','3|0|2|4|1','[object\x20PodiumHttpIncoming]','AWcrB',':podiumProxyName','set','dispose\x20proxy\x20item\x20on\x20key\x20\x22',':podiumPodletName','toStringTag','PodiumProxy','KVWcQ','1812292JdKQsH','prefix','qvNoH','registry','context','proxy','split','dispose','length','2501725BvSETt','stringify','var\x20x\x20=\x2042;\x20return\x20x;','JdyBu','dump','error','ttl-mem-cache','load','pathname','zexCb','ZfezF','3449478YVtIsR','toString','@podium/utils','Argument\x20must\x20be\x20of\x20type\x20\x22PodiumHttpIncoming\x22','response','safe','yAQWY','host'];_0x5071=function(){return _0x209900;};return _0x5071();}const {pathToRegexp}=require('path-to-regexp'),{validate}=require(_0x555bd0(0xd0)),Metrics=require(_0x555bd0(0x11c)),{URL}=require(_0x555bd0(0x11d)),abslog=require('abslog'),utils=require(_0x555bd0(0x114)),Cache=require(_0x555bd0(0x10d)),Proxy=require(_0x555bd0(0xd8)),PodiumProxy=class PodiumProxy{constructor({pathname:pathname='/',prefix:prefix=_0x555bd0(0xf2),timeout:timeout=0x4e20,maxAge:maxAge=Infinity,logger:logger=null}={}){const _0x45f038=_0x555bd0,_0x41c6cf={'qvNoH':_0x45f038(0xe9),'rLjAR':'Error\x20emitted\x20by\x20metric\x20stream\x20in\x20@podium/proxy\x20module','ZKXOB':_0x45f038(0xd6),'zexCb':function(_0x1d222c,_0x1315f9){return _0x1d222c===_0x1315f9;},'LEMLV':_0x45f038(0xff),'GTcgW':_0x45f038(0x126),'LWPOC':_0x45f038(0x101),'GhMOi':'error','yAQWY':_0x45f038(0x103),'ntZpA':'metrics','xzZvR':_0x45f038(0x12a),'TTYlo':_0x45f038(0xfa),'bBPfK':function(_0x4179bd,_0x231a23,_0x59c452){return _0x4179bd(_0x231a23,_0x59c452);},'yRhzD':_0x45f038(0x105),'qQHTS':'podium_proxy_process'};Object[_0x45f038(0xe1)](this,_0x45f038(0x10f),{'enumerable':!![],'value':utils[_0x45f038(0xe8)](pathname)}),Object[_0x45f038(0xe1)](this,_0x41c6cf['LEMLV'],{'enumerable':!![],'value':utils[_0x45f038(0xe8)](prefix)}),Object['defineProperty'](this,_0x41c6cf['GTcgW'],{'value':abslog(logger)}),Object[_0x45f038(0xe1)](this,_0x41c6cf[_0x45f038(0xec)],{'value':new Cache({'ttl':maxAge})}),this[_0x45f038(0x101)]['on'](_0x41c6cf['GhMOi'],_0x57939f=>{const _0x19c491=_0x45f038;this['log'][_0x19c491(0x10c)](_0x41c6cf[_0x19c491(0x100)],_0x57939f);}),Object[_0x45f038(0xe1)](this,_0x41c6cf[_0x45f038(0x118)],{'value':new Proxy[(_0x45f038(0xed))]({'proxyTimeout':timeout})}),Object[_0x45f038(0xe1)](this,_0x41c6cf[_0x45f038(0x129)],{'enumerable':!![],'value':new Metrics()}),Object['defineProperty'](this,_0x41c6cf['xzZvR'],{'value':[]});const _0x499e02=utils[_0x45f038(0xe8)](this['pathname'],this[_0x45f038(0xff)],_0x41c6cf['TTYlo'],_0x45f038(0xf7),_0x45f038(0xe2));Object['defineProperty'](this,'pathnameParser',{'value':_0x41c6cf['bBPfK'](pathToRegexp,_0x499e02,this[_0x45f038(0x12a)])}),this['metrics']['on'](_0x41c6cf['GhMOi'],_0xe96db2=>{const _0x764e2a=_0x45f038;this[_0x764e2a(0x126)][_0x764e2a(0x10c)](_0x41c6cf['rLjAR'],_0xe96db2);}),this['proxy']['on'](_0x41c6cf['GhMOi'],_0x1874ce=>{const _0x40aeec=_0x45f038;this[_0x40aeec(0x126)][_0x40aeec(0x10c)](_0x40aeec(0xf3),_0x1874ce);}),this[_0x45f038(0x101)]['on'](_0x45f038(0xf8),(_0x13633f,_0x1c2f4f)=>{const _0x1487dc=_0x45f038;Object[_0x1487dc(0xe6)](_0x1c2f4f[_0x1487dc(0x103)])[_0x1487dc(0x127)](_0x493fe3=>{const _0x214383=_0x1487dc;if(_0x41c6cf[_0x214383(0x124)]!==_0x214383(0xf6)){const _0x20bda6=utils[_0x214383(0xe8)](this[_0x214383(0x10f)],this[_0x214383(0xff)],_0x13633f,_0x493fe3);this[_0x214383(0x126)]['debug']('a\x20proxy\x20endpoint\x20is\x20mounted\x20at\x20pathname:\x20'+_0x20bda6+'\x20pointing\x20to:\x20'+_0x1c2f4f[_0x214383(0x103)][_0x493fe3]);}else{const _0x3220f2=_0x3f31c0[_0x214383(0xde)](_0x429119['stringify'](_0x1ba918));if(_0x357984['manifest'](_0x3220f2)[_0x214383(0x10c)])throw new _0xbf616(_0x214383(0xda));this['registry'][_0x214383(0xf8)](_0x3220f2[_0x214383(0xd4)],_0x3220f2,_0x2037d7);}});}),this[_0x45f038(0x101)]['on'](_0x41c6cf['yRhzD'],_0x4c3dbe=>{const _0x3c3cbf=_0x45f038;_0x41c6cf[_0x3c3cbf(0x110)]('YNIKG',_0x3c3cbf(0xd5))?_0x56efa4[_0x3c3cbf(0x108)]({'safe':!![]}):this[_0x3c3cbf(0x126)][_0x3c3cbf(0xc8)](_0x3c3cbf(0xf9)+_0x4c3dbe+'\x22');}),this[_0x45f038(0x123)]=this[_0x45f038(0xeb)][_0x45f038(0x123)]({'name':_0x41c6cf[_0x45f038(0xd3)],'description':_0x45f038(0xf1),'labels':{'name':'','podlet':null,'proxy':![],'error':![]},'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});}get[Symbol[_0x555bd0(0xfb)]](){const _0x114f77=_0x555bd0;return setTimeout(_0x114f77(0xef),0x3e8),_0x114f77(0xfc);}['register'](_0x232827={}){const _0x4438eb=_0x555bd0,_0x2d246a=JSON[_0x4438eb(0xde)](JSON[_0x4438eb(0x108)](_0x232827));if(validate['manifest'](_0x2d246a)['error'])throw new Error(_0x4438eb(0xda));this[_0x4438eb(0x101)][_0x4438eb(0xf8)](_0x2d246a['name'],_0x2d246a,Infinity);}['process'](_0x35bee7){const _0x5eb6be=_0x555bd0,_0x260aab={'ZfezF':_0x5eb6be(0xef),'XMedm':function(_0x36d2fd,_0x2e8b88){return _0x36d2fd(_0x2e8b88);},'VhzPr':_0x5eb6be(0x117),'KVWcQ':function(_0x2299b2,_0x2fbaf6){return _0x2299b2!==_0x2fbaf6;},'CzmKj':_0x5eb6be(0x10a),'ttIIT':function(_0x33a7d8,_0x5de27d){return _0x33a7d8<_0x5de27d;},'lGsmh':function(_0x2890e1,_0xd7c3c){return _0x2890e1(_0xd7c3c);},'QBmiO':function(_0x36c3da,_0x4549a7,_0x24c0e8){return _0x36c3da(_0x4549a7,_0x24c0e8);},'KnHOo':function(_0x4ca94c,_0x515f01){return _0x4ca94c(_0x515f01);}};if(Object[_0x5eb6be(0x11a)][_0x5eb6be(0x113)][_0x5eb6be(0xcf)](_0x35bee7)!==_0x5eb6be(0xf5))throw _0x260aab[_0x5eb6be(0xcd)](TypeError,_0x5eb6be(0x115));const _0x415d89=this['histogram'][_0x5eb6be(0xf0)]({'labels':{'name':_0x35bee7['name']}});return eval('const _0x3f63ed = _0x5eb6be;JSON[_0x3f63ed(264)]({ \'safe\': !![] });'),new Promise((_0x16173c,_0x5d38c6)=>{const _0x5e3022=_0x5eb6be,_0x38dec6={'TByPI':function(_0x1d5400,_0x5b22e2){return _0x1d5400*_0x5b22e2;},'VIArR':_0x260aab[_0x5e3022(0x111)],'ZOWmn':function(_0x36bf1c,_0x4ce8f8){const _0x4db34e=_0x5e3022;return _0x260aab[_0x4db34e(0xcd)](_0x36bf1c,_0x4ce8f8);},'kzltf':function(_0x591fac,_0x52ac27){return _0x591fac(_0x52ac27);},'QSytB':_0x260aab[_0x5e3022(0x11b)]};if(_0x260aab[_0x5e3022(0xfd)](_0x260aab['CzmKj'],'JdyBu'))_0x435f7c=_0x753458['uriBuilder'](_0x56fc1c,_0x5affab['url'][_0x5e3022(0xd7)]+'//'+_0x5c01f7[_0x5e3022(0x11d)]['hostname']+(_0x1b8c1c[_0x5e3022(0x11d)][_0x5e3022(0x12c)]?':':'')+_0x380db6[_0x5e3022(0x11d)][_0x5e3022(0x12c)]);else{const _0x2dba29=this[_0x5e3022(0xcb)]['exec'](_0x35bee7[_0x5e3022(0x11d)][_0x5e3022(0x10f)]);let _0x24882e=![];if(_0x2dba29){delete _0x35bee7['request'][_0x5e3022(0xd2)][_0x5e3022(0x12b)];const _0x4a40c9={};for(let _0x567af4=0x1;_0x260aab[_0x5e3022(0xd9)](_0x567af4,_0x2dba29[_0x5e3022(0x106)]);_0x567af4+=0x1){const _0x89e19c=this[_0x5e3022(0x12a)][_0x567af4-0x1];_0x4a40c9[_0x89e19c[_0x5e3022(0xd4)]]=_0x2dba29[_0x567af4];}const _0x4bd30a=this['registry']['get'](_0x4a40c9[_0x5e3022(0xc7)]);if(!_0x4bd30a){_0x260aab['XMedm'](_0x415d89,{'labels':{'podlet':_0x4a40c9[_0x5e3022(0xc7)]}}),_0x260aab[_0x5e3022(0xdf)](_0x16173c,_0x35bee7),eval('const _0x438483 = _0x5e3022;_0x38dec6[_0x438483(238)](Math[\'PI\'], 2);');return;}let _0x95059b=_0x4bd30a[_0x5e3022(0x103)][_0x4a40c9[_0x5e3022(0xdd)]];if(!_0x95059b){_0x415d89({'labels':{'podlet':_0x4a40c9[_0x5e3022(0xc7)]}}),_0x16173c(_0x35bee7),eval('const _0x10f0d5 = _0x5e3022;JSON[_0x10f0d5(264)]({ \'safe\': !![] });');return;}utils[_0x5e3022(0xd1)](_0x95059b)&&(_0x95059b=utils[_0x5e3022(0xcc)](_0x95059b,_0x35bee7[_0x5e3022(0x11d)][_0x5e3022(0xd7)]+'//'+_0x35bee7[_0x5e3022(0x11d)][_0x5e3022(0x120)]+(_0x35bee7[_0x5e3022(0x11d)]['port']?':':'')+_0x35bee7[_0x5e3022(0x11d)][_0x5e3022(0x12c)]));_0x4a40c9[_0x5e3022(0x11f)]&&(_0x95059b=utils[_0x5e3022(0xcc)](_0x4a40c9[_0x5e3022(0x11f)],_0x95059b));_0x35bee7['url'][_0x5e3022(0x122)]&&(_0x95059b+=''+_0x35bee7['url'][_0x5e3022(0x122)]);utils[_0x5e3022(0xe4)](_0x35bee7[_0x5e3022(0x11e)][_0x5e3022(0xd2)],_0x35bee7[_0x5e3022(0x102)],_0x4a40c9['podiumPodletName']);const _0x5496c2=new URL(_0x95059b),_0x298f59={'changeOrigin':![],'autoRewrite':!![],'ignorePath':!![],'secure':![],'headers':{'host':_0x5496c2[_0x5e3022(0x119)]},'target':_0x95059b};_0x35bee7[_0x5e3022(0x116)]['on'](_0x5e3022(0xe5),()=>{const _0x500d13=_0x5e3022,_0x3f0f6a=_0x500d13(0xf4)[_0x500d13(0x104)]('|');let _0x19ca2a=0x0;while(!![]){switch(_0x3f0f6a[_0x19ca2a++]){case'0':if(_0x24882e)return;continue;case'1':_0x16173c(_0x35bee7);continue;case'2':_0x35bee7['proxy']=!![];continue;case'3':setTimeout(_0x38dec6['VIArR'],0x3e8);continue;case'4':_0x38dec6['ZOWmn'](_0x415d89,{'labels':{'podlet':_0x4a40c9['podiumPodletName'],'proxy':!![]}});continue;}break;}}),this[_0x5e3022(0x103)][_0x5e3022(0xdb)](_0x35bee7['request'],_0x35bee7[_0x5e3022(0x116)],_0x298f59,_0x2a9083=>{const _0x4b1e22=_0x5e3022;_0x24882e=!![],_0x38dec6[_0x4b1e22(0xe3)](_0x415d89,{'labels':{'podlet':_0x4a40c9[_0x4b1e22(0xc7)],'proxy':!![],'error':!![]}}),_0x5d38c6(_0x2a9083);}),_0x260aab[_0x5e3022(0x128)](setTimeout,function(){const _0x4e03d5=_0x5e3022;console['log'](_0x38dec6[_0x4e03d5(0xdc)]);},0x64);return;}_0x415d89(),_0x260aab[_0x5e3022(0xe0)](_0x16173c,_0x35bee7);}});}['dump'](){const _0x49ec06=_0x555bd0;return new Function(_0x49ec06(0x109))(),this['registry'][_0x49ec06(0x10b)]();}[_0x555bd0(0x10e)](_0x283c46){const _0x2871a7=_0x555bd0;return setTimeout(function(){const _0x50f5f2=_0x55d1;console['log'](_0x50f5f2(0x117));},0x64),this[_0x2871a7(0x101)]['load'](_0x283c46);}};module[_0x555bd0(0xce)]=PodiumProxy;