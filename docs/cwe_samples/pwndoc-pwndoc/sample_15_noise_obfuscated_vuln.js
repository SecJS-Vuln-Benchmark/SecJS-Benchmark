'use strict';const _0x185262=_0x17ea;function _0x17ea(_0x1f03be,_0x28f2b4){const _0x5b4a9e=_0x5b4a();return _0x17ea=function(_0x17eaf4,_0x47427d){_0x17eaf4=_0x17eaf4-0x139;let _0x418dc2=_0x5b4a9e[_0x17eaf4];return _0x418dc2;},_0x17ea(_0x1f03be,_0x28f2b4);}(function(_0x1cdc38,_0x3edbd0){const _0x4cbdd9=_0x17ea,_0x24acd4=_0x1cdc38();while(!![]){try{const _0x352842=-parseInt(_0x4cbdd9(0x169))/0x1+-parseInt(_0x4cbdd9(0x147))/0x2*(-parseInt(_0x4cbdd9(0x186))/0x3)+-parseInt(_0x4cbdd9(0x17c))/0x4+parseInt(_0x4cbdd9(0x184))/0x5*(-parseInt(_0x4cbdd9(0x19e))/0x6)+-parseInt(_0x4cbdd9(0x197))/0x7+-parseInt(_0x4cbdd9(0x195))/0x8+parseInt(_0x4cbdd9(0x1a5))/0x9;if(_0x352842===_0x3edbd0)break;else _0x24acd4['push'](_0x24acd4['shift']());}catch(_0x2fd443){_0x24acd4['push'](_0x24acd4['shift']());}}}(_0x5b4a,0xb6230));function _0x5b4a(){const _0x3e82be=['Proxying()\x20-\x20GET\x20request\x20with\x20query\x20params\x20-\x20should\x20proxy\x20query\x20params\x20to\x20\x22{destination}/some/path\x22','VNrHB','return\x20Object.keys({a:1});','GET','kvyxJ','labels','/some/where/else','QhcOJ','yfxRk','foo','/layout/proxy/bar/a?foo=bar','push','LiSmS','bpwyj','ejuFx','TjaMp','pipe','ripvb','Proxying()\x20-\x20POST\x20request\x20-\x20should\x20proxy\x20query\x20params\x20to\x20\x22{destination}/some/path\x22','Proxying()\x20-\x20metrics\x20collection','UvpPO','process','/some/path','dOanJ','locals','CPHtU','address','OfCLh','forEach','QEqkK','type','oTPHs','equal','name','31582RKHjWm','ADymu','proxy','fqMkT','BjNmt','host','/foo','app','log','match','tHLSW','not\x20found','tGcwJ','method','1.0.0','USpnX','bar','statusCode','Proxying()\x20-\x20mount\x20proxy\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/path\x22','AQcCM','WyotG','end','Iacrh','qvpMm','@podium/utils','wdEHo','destination','/layout/proxy/bar/a/extra?foo=bar','then','podlet','Content-Type','/layout/proxy/foo/b','nCMUe','UOeXu','1488079ohXKMj','TMxka','OFgRP','/layout/proxy/bar/a','tap','meta','application/json','CdBjn','zgBZy','localhost','register','nPGoB','/layout/','wckXy','safe','stringify','port','podium_proxy_process','setHeader','2001932BTFqeX','NerLI','listen','mylayout','podium','SmyBP','context','YfVAP','20POQQYu','urIIG','132xVVQwn','metrics','sHXYL','length','body','url','VuPSm','jvmUC','/layout/proxy/foo/a','pEAyN','qCSBQ','mBaWw','WSXVI','@podium/test-utils','gOtIF','6049032iXZUig','MiWgH','3476277hQoKyH','RyCsT','bLVhy','POST','tLOCI','request','http://','1922070azlwxI','error','jKzbV','ccQuU','server','headers','http://localhost:9854','41165190kfTAWm','GAYcC','ZvkUA','http','close'];_0x5b4a=function(){return _0x3e82be;};return _0x5b4a();}const {test}=require(_0x185262(0x16d)),{destinationObjectStream,HttpServer,request}=require(_0x185262(0x193)),{HttpIncoming}=require(_0x185262(0x15f)),http=require(_0x185262(0x1a8)),Proxy=require('..'),reqFn=(_0x1cedd3,_0x32aca5)=>{const _0x4f34b8=_0x185262,_0x57ddfb={'MiWgH':_0x4f34b8(0x161)};_0x32aca5[_0x4f34b8(0x158)]=0xc8,_0x32aca5[_0x4f34b8(0x17b)]('Content-Type',_0x4f34b8(0x16f)),_0x32aca5[_0x4f34b8(0x15c)](JSON[_0x4f34b8(0x178)]({'method':_0x1cedd3['method'],'type':_0x57ddfb[_0x4f34b8(0x196)],'url':_0x4f34b8(0x19d)+_0x1cedd3[_0x4f34b8(0x1a3)][_0x4f34b8(0x14c)]+_0x1cedd3['url']}));};class ProxyServer{constructor(_0x2fa115=[],_0x23c470={}){const _0x2f5f5c=_0x185262,_0x1cb87d={'jKzbV':function(_0x25dbe2,_0xbcb463){return _0x25dbe2(_0xbcb463);},'QEqkK':_0x2f5f5c(0x149),'YfVAP':'name','ADymu':_0x2f5f5c(0x17f),'CdBjn':_0x2f5f5c(0x164),'NerLI':_0x2f5f5c(0x1b3),'pEAyN':_0x2f5f5c(0x19f),'USpnX':_0x2f5f5c(0x192)};this[_0x2f5f5c(0x1a2)]=undefined,this[_0x2f5f5c(0x13f)]='',this[_0x2f5f5c(0x149)]=new Proxy({'pathname':_0x2f5f5c(0x175),'prefix':_0x1cb87d[_0x2f5f5c(0x142)]}),_0x2fa115[_0x2f5f5c(0x141)](_0x29fd37=>{const _0x54a792=_0x2f5f5c;this['proxy'][_0x54a792(0x173)](_0x29fd37);}),this[_0x2f5f5c(0x14e)]=http['createServer']((_0x353996,_0x4fb34e)=>{const _0x1c4730=_0x2f5f5c,_0x32888a={'sdppR':_0x1cb87d['QEqkK']};if(_0x1cb87d[_0x1c4730(0x156)]===_0x1cb87d[_0x1c4730(0x156)]){_0x4fb34e[_0x1c4730(0x13d)]={},_0x4fb34e[_0x1c4730(0x13d)][_0x1c4730(0x180)]={},_0x4fb34e[_0x1c4730(0x13d)][_0x1c4730(0x180)][_0x1c4730(0x182)]={'podium-foo':_0x1c4730(0x157)};const _0x3ace1f=new HttpIncoming(_0x353996,_0x4fb34e,_0x4fb34e['locals']);if(_0x23c470['name'])_0x3ace1f[_0x1c4730(0x146)]=_0x23c470[_0x1c4730(0x146)];this[_0x1c4730(0x149)][_0x1c4730(0x13a)](_0x3ace1f)[_0x1c4730(0x163)](_0xadb460=>{const _0x47a442=_0x1c4730;_0x1cb87d[_0x47a442(0x1a0)](Function,_0x47a442(0x1ac))();if(_0xadb460[_0x47a442(0x149)])return;_0x4fb34e[_0x47a442(0x158)]=0xc8,_0x4fb34e[_0x47a442(0x17b)]('Content-Type','application/json'),_0x4fb34e[_0x47a442(0x15c)](JSON['stringify']({'message':'ok','status':0xc8,'type':_0x1cb87d[_0x47a442(0x142)]}));})['catch'](()=>{const _0x3c1372=_0x1c4730;_0x4fb34e[_0x3c1372(0x158)]=0x194,_0x4fb34e['setHeader']('Content-Type',_0x3c1372(0x16f)),_0x4fb34e[_0x3c1372(0x15c)](JSON[_0x3c1372(0x178)]({'message':_0x3c1372(0x152),'status':0x194,'type':_0x32888a['sdppR']}));});}else _0x471af7[_0x1c4730(0x145)](_0x3909e6[_0x1c4730(0x189)],0x3),_0x30b730[_0x1c4730(0x145)](_0x171be5[0x0][_0x1c4730(0x146)],_0x1c4730(0x17a)),_0x33781e['equal'](_0x1ce6ac[0x0][_0x1c4730(0x143)],0x5),_0x24b69f[_0x1c4730(0x150)](_0x1aac26[0x0][_0x1c4730(0x1af)],[{'name':_0x1cb87d[_0x1c4730(0x183)],'value':_0x1cb87d[_0x1c4730(0x148)]},{'name':_0x1c4730(0x164),'value':null},{'name':_0x1cb87d[_0x1c4730(0x142)],'value':![]},{'name':_0x1c4730(0x19f),'value':![]}]),_0x3fda6b[_0x1c4730(0x150)](_0x39def4[0x0][_0x1c4730(0x16e)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]}),_0x370525['match'](_0x1d78a8[0x1][_0x1c4730(0x1af)],[{'name':_0x1c4730(0x146),'value':_0x1c4730(0x17f)},{'name':_0x1cb87d[_0x1c4730(0x170)],'value':_0x1cb87d[_0x1c4730(0x17d)]},{'name':_0x1c4730(0x149),'value':!![]},{'name':_0x1cb87d[_0x1c4730(0x18f)],'value':![]}]),_0x454275[_0x1c4730(0x150)](_0x5c7106[0x1][_0x1c4730(0x16e)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]}),_0x2681d6[_0x1c4730(0x150)](_0xdbd008[0x2]['labels'],[{'name':_0x1c4730(0x146),'value':_0x1c4730(0x17f)},{'name':_0x1cb87d[_0x1c4730(0x170)],'value':_0x1c4730(0x157)},{'name':_0x1cb87d[_0x1c4730(0x142)],'value':!![]},{'name':_0x1c4730(0x19f),'value':![]}]),_0x489b54[_0x1c4730(0x150)](_0x14a80d[0x2][_0x1c4730(0x16e)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});});}[_0x185262(0x17e)](){const _0x5c2e49=_0x185262,_0x3d9042={'mBaWw':function(_0x2aafb2,_0x1aa1eb,_0x4cce89){return _0x2aafb2(_0x1aa1eb,_0x4cce89);},'bpwyj':function(_0x164211,_0x221d36){return _0x164211!==_0x221d36;},'nPGoB':_0x5c2e49(0x1a1),'DHixz':_0x5c2e49(0x177),'ZvkUA':_0x5c2e49(0x172)};return _0x3d9042[_0x5c2e49(0x191)](setTimeout,function(){const _0x837db6=_0x5c2e49,_0x19ba11={'sWgcF':function(_0x397955,_0x37186f,_0x468b4c){const _0x76009c=_0x17ea;return _0x3d9042[_0x76009c(0x191)](_0x397955,_0x37186f,_0x468b4c);}};if(_0x3d9042[_0x837db6(0x1b7)](_0x3d9042[_0x837db6(0x174)],_0x3d9042['nPGoB']))return _0x19ba11['sWgcF'](_0x2c96f5,function(){const _0x79117f=_0x837db6;_0x2b9cd7[_0x79117f(0x14f)]('safe');},0x64),new _0x2a44ce(_0x15db5e=>{const _0x26368b=_0x837db6;this[_0x26368b(0x1a2)]=this[_0x26368b(0x14e)][_0x26368b(0x17e)](0x0,_0x26368b(0x172),()=>{const _0x1faec5=_0x26368b;this[_0x1faec5(0x13f)]='http://'+this[_0x1faec5(0x1a2)][_0x1faec5(0x13f)]()[_0x1faec5(0x13f)]+':'+this['server'][_0x1faec5(0x13f)]()[_0x1faec5(0x179)],_0x15db5e(this[_0x1faec5(0x13f)]);});});else console[_0x837db6(0x14f)](_0x3d9042['DHixz']);},0x64),new Promise(_0x51c4eb=>{const _0x4bd749=_0x5c2e49;this[_0x4bd749(0x1a2)]=this[_0x4bd749(0x14e)][_0x4bd749(0x17e)](0x0,_0x3d9042[_0x4bd749(0x1a7)],()=>{const _0x459d61=_0x4bd749;this[_0x459d61(0x13f)]='http://'+this[_0x459d61(0x1a2)][_0x459d61(0x13f)]()[_0x459d61(0x13f)]+':'+this['server'][_0x459d61(0x13f)]()['port'],_0x51c4eb(this[_0x459d61(0x13f)]);});});}[_0x185262(0x1a9)](){const _0x374d2f={'yfxRk':'name','SmyBP':'bar','fqMkT':'proxy'};return eval('1 + 1;'),new Promise((_0x4d4d63,_0x44ef25)=>{const _0x61d6fc=_0x17ea,_0x13ec70={'tHLSW':_0x374d2f[_0x61d6fc(0x1b2)],'WyotG':_0x374d2f[_0x61d6fc(0x181)],'RdoHb':_0x374d2f[_0x61d6fc(0x14a)],'wdEHo':_0x61d6fc(0x165),'GAYcC':_0x61d6fc(0x1b8)};this[_0x61d6fc(0x1a2)]['close'](_0x190f07=>{const _0x57c0e5=_0x61d6fc,_0x2efda4={'Iacrh':_0x13ec70[_0x57c0e5(0x160)]};_0x57c0e5(0x15e)===_0x57c0e5(0x139)?(_0x17bc05[_0x57c0e5(0x145)](_0x34500d[_0x57c0e5(0x189)],0x1),_0x9529f3['equal'](_0x14a3c2[0x0][_0x57c0e5(0x146)],_0x57c0e5(0x17a)),_0x27fd04[_0x57c0e5(0x145)](_0x483413[0x0][_0x57c0e5(0x143)],0x5),_0x400665['match'](_0x193c1b[0x0]['labels'],[{'name':_0x13ec70[_0x57c0e5(0x151)],'value':''},{'name':_0x57c0e5(0x164),'value':_0x13ec70[_0x57c0e5(0x15b)]},{'name':_0x13ec70['RdoHb'],'value':!![]},{'name':'error','value':!![]}])):_0x190f07?_0x44ef25(_0x190f07):_0x13ec70[_0x57c0e5(0x1a6)]==='ejuFx'?_0x4d4d63():(_0x4b0c79[_0x57c0e5(0x158)]=0x194,_0xed7780[_0x57c0e5(0x17b)](_0x2efda4[_0x57c0e5(0x15d)],_0x57c0e5(0x16f)),_0x45393b[_0x57c0e5(0x15c)](_0x545607[_0x57c0e5(0x178)]({'message':_0x57c0e5(0x152),'status':0x194,'type':_0x57c0e5(0x149)})));});});}}test(_0x185262(0x159),async _0x4949f6=>{const _0x2ce476=_0x185262,_0x32540d={'dOanJ':_0x2ce476(0x155),'gOtIF':_0x2ce476(0x16c),'QhcOJ':'destination','OAhgc':'GET'},_0x480c5a=new HttpServer();_0x480c5a[_0x2ce476(0x19c)]=reqFn;const _0x4c7cd3=await _0x480c5a['listen'](),_0x1e0bd4=new ProxyServer([{'name':_0x2ce476(0x157),'proxy':{'a':_0x4c7cd3+_0x2ce476(0x13b)},'version':_0x32540d[_0x2ce476(0x13c)],'content':'/'}]),_0x52624a=await _0x1e0bd4['listen'](),{body:_0x2766fd}=await request({'address':_0x52624a,'pathname':_0x32540d[_0x2ce476(0x194)],'json':!![]});_0x4949f6[_0x2ce476(0x145)](_0x2766fd['type'],_0x32540d[_0x2ce476(0x1b1)]),_0x4949f6[_0x2ce476(0x145)](_0x2766fd['method'],_0x32540d['OAhgc']),_0x4949f6[_0x2ce476(0x145)](_0x2766fd[_0x2ce476(0x18b)],_0x4c7cd3+_0x2ce476(0x13b)),await _0x1e0bd4[_0x2ce476(0x1a9)](),await _0x480c5a[_0x2ce476(0x1a9)](),_0x4949f6[_0x2ce476(0x15c)]();}),test('Proxying()\x20-\x20mount\x20proxy\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/where/else\x22',async _0x3573fe=>{const _0x3e26b8=_0x185262,_0x5be851={'bLVhy':_0x3e26b8(0x1b3),'VNrHB':function(_0x438c70,_0x537b16){return _0x438c70(_0x537b16);},'RyCsT':'GET'},_0x41bb67=new HttpServer();_0x41bb67[_0x3e26b8(0x19c)]=reqFn;const _0x1afabe=await _0x41bb67['listen'](),_0x5bde4e=new ProxyServer([{'name':_0x5be851[_0x3e26b8(0x199)],'proxy':{'b':_0x1afabe+'/some/where/else'},'version':_0x3e26b8(0x155),'content':'/'}]),_0x2b5a7f=await _0x5bde4e['listen'](),{body:_0x16e84c}=await _0x5be851[_0x3e26b8(0x1ab)](request,{'address':_0x2b5a7f,'pathname':_0x3e26b8(0x166),'json':!![]});_0x3573fe['equal'](_0x16e84c[_0x3e26b8(0x143)],_0x3e26b8(0x161)),_0x3573fe[_0x3e26b8(0x145)](_0x16e84c[_0x3e26b8(0x154)],_0x5be851[_0x3e26b8(0x198)]),_0x3573fe[_0x3e26b8(0x145)](_0x16e84c['url'],_0x1afabe+_0x3e26b8(0x1b0)),await _0x5bde4e[_0x3e26b8(0x1a9)](),await _0x41bb67['close'](),_0x3573fe['end']();}),test('Proxying()\x20-\x20mount\x20multiple\x20proxies\x20on\x20\x22/{pathname}/{prefix}/{manifestName}/{proxyName}\x22\x20-\x20GET\x20request\x20-\x20should\x20proxy\x20to\x20destinations',async _0x284437=>{const _0x18e126=_0x185262,_0x59f02e={'TMxka':_0x18e126(0x157),'urIIG':_0x18e126(0x1b3),'AqYyY':_0x18e126(0x16c),'zgBZy':function(_0x19306f,_0x5deddf){return _0x19306f(_0x5deddf);},'lKLOO':_0x18e126(0x161),'kSDYa':_0x18e126(0x1ad)},_0x1b4307=new HttpServer();_0x1b4307[_0x18e126(0x19c)]=reqFn;const _0x5e84e3=await _0x1b4307[_0x18e126(0x17e)](),_0x21f8cd=new ProxyServer([{'name':_0x59f02e[_0x18e126(0x16a)],'proxy':{'a':_0x5e84e3+_0x18e126(0x13b)},'version':_0x18e126(0x155),'content':'/'},{'name':_0x59f02e[_0x18e126(0x185)],'proxy':{'b':_0x5e84e3+'/some/where/else'},'version':_0x18e126(0x155),'content':'/'}]),_0x26b99b=await _0x21f8cd[_0x18e126(0x17e)](),_0x29c0f1=await request({'address':_0x26b99b,'pathname':_0x59f02e['AqYyY'],'json':!![]});_0x284437[_0x18e126(0x145)](_0x29c0f1['body'][_0x18e126(0x143)],_0x18e126(0x161)),_0x284437[_0x18e126(0x145)](_0x29c0f1[_0x18e126(0x18a)][_0x18e126(0x154)],_0x18e126(0x1ad)),_0x284437[_0x18e126(0x145)](_0x29c0f1[_0x18e126(0x18a)][_0x18e126(0x18b)],_0x5e84e3+_0x18e126(0x13b));const _0x184d1f=await _0x59f02e[_0x18e126(0x171)](request,{'address':_0x26b99b,'pathname':_0x18e126(0x166),'json':!![]});_0x284437['equal'](_0x184d1f[_0x18e126(0x18a)][_0x18e126(0x143)],_0x59f02e['lKLOO']),_0x284437[_0x18e126(0x145)](_0x184d1f[_0x18e126(0x18a)][_0x18e126(0x154)],_0x59f02e['kSDYa']),_0x284437[_0x18e126(0x145)](_0x184d1f[_0x18e126(0x18a)][_0x18e126(0x18b)],_0x5e84e3+_0x18e126(0x1b0)),await _0x21f8cd[_0x18e126(0x1a9)](),await _0x1b4307[_0x18e126(0x1a9)](),_0x284437[_0x18e126(0x15c)]();}),test('Proxying()\x20-\x20GET\x20request\x20with\x20additional\x20path\x20values\x20-\x20should\x20proxy\x20to\x20\x22{destination}/some/path/extra?foo=bar\x22',async _0x52de23=>{const _0x399527=_0x185262,_0x156982={'ripvb':_0x399527(0x162)},_0xea9a21=new HttpServer();_0xea9a21['request']=reqFn;const _0x3bb45b=await _0xea9a21[_0x399527(0x17e)](),_0x468a45=new ProxyServer([{'name':'bar','proxy':{'a':_0x3bb45b+_0x399527(0x13b)},'version':'1.0.0','content':'/'}]),_0x4f60d0=await _0x468a45[_0x399527(0x17e)](),{body:_0x11045d}=await request({'address':_0x4f60d0,'pathname':_0x156982[_0x399527(0x1bb)],'json':!![]});_0x52de23[_0x399527(0x145)](_0x11045d[_0x399527(0x143)],'destination'),_0x52de23['equal'](_0x11045d[_0x399527(0x154)],_0x399527(0x1ad)),_0x52de23[_0x399527(0x145)](_0x11045d['url'],_0x3bb45b+'/some/path/extra?foo=bar'),await _0x468a45[_0x399527(0x1a9)](),await _0xea9a21[_0x399527(0x1a9)](),_0x52de23['end']();}),test(_0x185262(0x1aa),async _0x21faf1=>{const _0x5d6b4c=_0x185262,_0x133608=new HttpServer();_0x133608[_0x5d6b4c(0x19c)]=reqFn;const _0x3815bc=await _0x133608['listen'](),_0x23feb9=new ProxyServer([{'name':_0x5d6b4c(0x157),'proxy':{'a':_0x3815bc+_0x5d6b4c(0x13b)},'version':_0x5d6b4c(0x155),'content':'/'}]),_0x55e960=await _0x23feb9[_0x5d6b4c(0x17e)](),{body:_0x499880}=await request({'address':_0x55e960,'pathname':_0x5d6b4c(0x1b4),'json':!![]});_0x21faf1[_0x5d6b4c(0x145)](_0x499880[_0x5d6b4c(0x143)],_0x5d6b4c(0x161)),_0x21faf1['equal'](_0x499880['method'],_0x5d6b4c(0x1ad)),_0x21faf1['equal'](_0x499880[_0x5d6b4c(0x18b)],_0x3815bc+'/some/path?foo=bar'),await _0x23feb9[_0x5d6b4c(0x1a9)](),await _0x133608[_0x5d6b4c(0x1a9)](),_0x21faf1[_0x5d6b4c(0x15c)]();}),test(_0x185262(0x1bc),async _0x305632=>{const _0x1a368a=_0x185262,_0x548061={'sHXYL':'bar','tGcwJ':_0x1a368a(0x155),'LiSmS':_0x1a368a(0x16c),'VuPSm':_0x1a368a(0x19a)},_0x2480eb=new HttpServer();_0x2480eb['request']=reqFn;const _0x1a4c72=await _0x2480eb[_0x1a368a(0x17e)](),_0x54d8c3=new ProxyServer([{'name':_0x548061[_0x1a368a(0x188)],'proxy':{'a':_0x1a4c72+_0x1a368a(0x13b)},'version':_0x548061[_0x1a368a(0x153)],'content':'/'}]),_0x3f1c1=await _0x54d8c3[_0x1a368a(0x17e)](),{body:_0x1d34fb}=await request({'address':_0x3f1c1,'pathname':_0x548061[_0x1a368a(0x1b6)],'method':_0x1a368a(0x19a),'json':!![]},'payload');_0x305632[_0x1a368a(0x145)](_0x1d34fb[_0x1a368a(0x143)],_0x1a368a(0x161)),_0x305632[_0x1a368a(0x145)](_0x1d34fb[_0x1a368a(0x154)],_0x548061[_0x1a368a(0x18c)]),_0x305632[_0x1a368a(0x145)](_0x1d34fb[_0x1a368a(0x18b)],_0x1a4c72+_0x1a368a(0x13b)),await _0x54d8c3[_0x1a368a(0x1a9)](),await _0x2480eb[_0x1a368a(0x1a9)](),_0x305632[_0x1a368a(0x15c)]();}),test(_0x185262(0x1bd),async _0x36f1ee=>{const _0x4706ad=_0x185262,_0x111929={'wckXy':'mylayout','BjNmt':'podlet','UOeXu':_0x4706ad(0x19f),'jvmUC':'name','oTPHs':'proxy','kvyxJ':_0x4706ad(0x157),'tLOCI':'foo','RNuDM':_0x4706ad(0x14d),'CPHtU':function(_0x410ab8,_0xfaac1b){return _0x410ab8(_0xfaac1b);},'TjaMp':function(_0x39773f,_0x338bf2){return _0x39773f(_0x338bf2);},'AQcCM':_0x4706ad(0x18e),'QSXsB':_0x4706ad(0x16c)},_0x2061ec=new HttpServer();_0x2061ec[_0x4706ad(0x19c)]=reqFn;const _0x328d31=await _0x2061ec[_0x4706ad(0x17e)](),_0xe2444=new ProxyServer([{'name':_0x111929[_0x4706ad(0x19b)],'proxy':{'a':_0x111929['RNuDM']},'version':_0x4706ad(0x155),'content':'/'},{'name':'bar','proxy':{'a':_0x328d31+_0x4706ad(0x13b)},'version':'1.0.0','content':'/'}],{'name':_0x4706ad(0x17f)});_0xe2444[_0x4706ad(0x149)]['metrics']['pipe'](_0x111929[_0x4706ad(0x13e)](destinationObjectStream,_0x4c9066=>{const _0x29b0df=_0x4706ad;_0x36f1ee[_0x29b0df(0x145)](_0x4c9066[_0x29b0df(0x189)],0x3),_0x36f1ee[_0x29b0df(0x145)](_0x4c9066[0x0][_0x29b0df(0x146)],_0x29b0df(0x17a)),_0x36f1ee[_0x29b0df(0x145)](_0x4c9066[0x0]['type'],0x5),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x0][_0x29b0df(0x1af)],[{'name':_0x29b0df(0x146),'value':_0x111929[_0x29b0df(0x176)]},{'name':_0x111929[_0x29b0df(0x14b)],'value':null},{'name':'proxy','value':![]},{'name':_0x111929[_0x29b0df(0x168)],'value':![]}]),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x0]['meta'],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]}),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x1][_0x29b0df(0x1af)],[{'name':_0x111929[_0x29b0df(0x18d)],'value':_0x111929[_0x29b0df(0x176)]},{'name':_0x111929[_0x29b0df(0x14b)],'value':_0x29b0df(0x1b3)},{'name':_0x111929[_0x29b0df(0x144)],'value':!![]},{'name':'error','value':![]}]),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x1][_0x29b0df(0x16e)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]}),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x2][_0x29b0df(0x1af)],[{'name':_0x111929[_0x29b0df(0x18d)],'value':_0x111929['wckXy']},{'name':_0x111929[_0x29b0df(0x14b)],'value':_0x111929[_0x29b0df(0x1ae)]},{'name':_0x111929[_0x29b0df(0x144)],'value':!![]},{'name':'error','value':![]}]),_0x36f1ee[_0x29b0df(0x150)](_0x4c9066[0x2][_0x29b0df(0x16e)],{'buckets':[0.001,0.01,0.1,0.5,0x1,0x2,0xa]});}));const _0x3874b1=await _0xe2444['listen']();await _0x111929[_0x4706ad(0x1b9)](request,{'address':_0x3874b1,'pathname':_0x111929[_0x4706ad(0x15a)]}),await request({'address':_0x3874b1,'pathname':_0x111929['QSXsB']}),_0xe2444[_0x4706ad(0x149)][_0x4706ad(0x187)][_0x4706ad(0x1b5)](null),await _0xe2444['close'](),await _0x2061ec[_0x4706ad(0x1a9)](),_0x36f1ee['end']();}),test('Proxying()\x20-\x20proxy\x20to\x20a\x20non\x20existing\x20server\x20-\x20GET\x20request\x20will\x20error\x20-\x20should\x20collect\x20error\x20metric',async _0x477c19=>{const _0x2bc55a=_0x185262,_0x248c3c={'OFgRP':_0x2bc55a(0x164),'nCMUe':_0x2bc55a(0x149),'qCSBQ':_0x2bc55a(0x1a4),'OfCLh':function(_0x5201da,_0x82ec64){return _0x5201da(_0x82ec64);},'jXNfU':_0x2bc55a(0x16c)},_0x4a8f15=_0x248c3c[_0x2bc55a(0x190)],_0x666dd5=new ProxyServer([{'name':_0x2bc55a(0x157),'proxy':{'a':_0x4a8f15+_0x2bc55a(0x13b)},'version':_0x2bc55a(0x155),'content':'/'}]),_0x192c2d=await _0x666dd5[_0x2bc55a(0x17e)]();_0x666dd5['proxy'][_0x2bc55a(0x187)][_0x2bc55a(0x1ba)](_0x248c3c[_0x2bc55a(0x140)](destinationObjectStream,_0x196eb5=>{const _0x180d14=_0x2bc55a;_0x477c19['equal'](_0x196eb5[_0x180d14(0x189)],0x1),_0x477c19[_0x180d14(0x145)](_0x196eb5[0x0][_0x180d14(0x146)],_0x180d14(0x17a)),_0x477c19[_0x180d14(0x145)](_0x196eb5[0x0][_0x180d14(0x143)],0x5),_0x477c19[_0x180d14(0x150)](_0x196eb5[0x0][_0x180d14(0x1af)],[{'name':_0x180d14(0x146),'value':''},{'name':_0x248c3c[_0x180d14(0x16b)],'value':_0x180d14(0x157)},{'name':_0x248c3c[_0x180d14(0x167)],'value':!![]},{'name':_0x180d14(0x19f),'value':!![]}]);})),await _0x248c3c[_0x2bc55a(0x140)](request,{'address':_0x192c2d,'pathname':_0x248c3c['jXNfU']}),_0x666dd5[_0x2bc55a(0x149)][_0x2bc55a(0x187)][_0x2bc55a(0x1b5)](null),await _0x666dd5[_0x2bc55a(0x1a9)](),_0x477c19[_0x2bc55a(0x15c)]();});