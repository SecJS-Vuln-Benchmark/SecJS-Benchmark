'use strict';function _0x28fb(){const _0x26be42=['error','Update\x20last\x20download\x20','uploadDir','mmFog','QKJPh','push','path','update','DbxXr','czawT','lock','some','init','all','Updated\x20','lastDownload','reduce','Lroxb','forEach','sgxgq','Expired\x20','kqIJL','updateMetadata','debug','psitransfer:db','mpuKx','fs-promise','key','readdirSync','uisRw','metadata','EWUrX','stringify','splice','14782728AJEPNr','zayfy','exports','jgXmM','store','../config','db\x20initialization\x20failed\x20with\x20error\x20','PSKHu','MeKBN','bhoVY','isDirectory','length','retention','MyVDD','3SODKsb','Vdoxg','now','map','FuDgh','7686282joKcYU','niTzL','uUlhT','DB\x20not\x20initialized','UIOEH','dvVtZ','Remove\x20','del','statSync','rmdir','1832522sONdav','IUBYf','LwyTx','uploadLength','kOqxx','remove','LIobY','get','updateClock();','log','initialized','buckedLocked','isInteger','catch','findIndex','790478iqelFq','1972495joFVyn','zMOcA','message','2394790SoCpOQ','XXkKP','DB\x20not\x20initialized_','find','HgJoL','WZKBA','Oxjlu','GKVDs','_sync','ensureDirSync','resolve','isLocked','3107156oNgRSq','rXqqd','TdtXk','TbtGt','aCfFU','rDHHv','safe','return\x20Object.keys({a:1});','add','DumHW','Update\x20metadata\x20','bucketSize','var\x20x\x20=\x2042;\x20return\x20x;','extname','ZbkYu','Added\x20','createdAt','maxAge'];_0x28fb=function(){return _0x26be42;};return _0x28fb();}const _0x3d5823=_0x2ee1;(function(_0x52f90c,_0x467c39){const _0x2b4bf5=_0x2ee1,_0x4b2de6=_0x52f90c();while(!![]){try{const _0x1da838=parseInt(_0x2b4bf5(0x145))/0x1+parseInt(_0x2b4bf5(0x136))/0x2+-parseInt(_0x2b4bf5(0x127))/0x3*(parseInt(_0x2b4bf5(0x155))/0x4)+-parseInt(_0x2b4bf5(0x149))/0x5+-parseInt(_0x2b4bf5(0x12c))/0x6+-parseInt(_0x2b4bf5(0x146))/0x7+parseInt(_0x2b4bf5(0x119))/0x8;if(_0x1da838===_0x467c39)break;else _0x4b2de6['push'](_0x4b2de6['shift']());}catch(_0x1ca320){_0x4b2de6['push'](_0x4b2de6['shift']());}}}(_0x28fb,0xb3b01));const fsp=require(_0x3d5823(0x111)),path=require(_0x3d5823(0xfd)),debug=require(_0x3d5823(0x10e))(_0x3d5823(0x10f)),config=require(_0x3d5823(0x11e));function _0x2ee1(_0x94159a,_0x2122ff){const _0x28fb5c=_0x28fb();return _0x2ee1=function(_0x2ee163,_0x59306c){_0x2ee163=_0x2ee163-0xf2;let _0x2a3019=_0x28fb5c[_0x2ee163];return _0x2a3019;},_0x2ee1(_0x94159a,_0x2122ff);}module[_0x3d5823(0x11b)]=class DB{constructor(_0x33e7cc,_0x451fec){const _0x2a38d3=_0x3d5823,_0x5573e8={'FuDgh':function(_0x35af2e,_0x32fe78){return _0x35af2e(_0x32fe78);},'PSKHu':'HDvIb','mpuKx':function(_0x2f668c,_0x3a9064){return _0x2f668c+_0x3a9064;},'TdtXk':function(_0x58aa1f,_0x3bd322){return _0x58aa1f*_0x3bd322;},'rXqqd':function(_0x5d4d92,_0x1497b1){return _0x5d4d92>_0x1497b1;},'sgxgq':function(_0x44d057,_0x5968db){return _0x44d057*_0x5968db;},'MyVDD':function(_0x1217eb,_0x4614a0){return _0x1217eb(_0x4614a0);},'WZKBA':function(_0x62e523,_0x156a1e,_0x373db6){return _0x62e523(_0x156a1e,_0x373db6);},'czawT':function(_0x4028e9,_0x4b212c){return _0x4028e9*_0x4b212c;}};this[_0x2a38d3(0x140)]=![],this['db']={},this[_0x2a38d3(0xf9)]=_0x33e7cc,this[_0x2a38d3(0x11d)]=_0x451fec;const _0x512e5d=()=>{const _0x26d111=_0x2a38d3;if(_0x26d111(0x158)!==_0x5573e8[_0x26d111(0x120)]){let _0x448761,_0x307f41,_0x5cda50;for(_0x448761 of Object['keys'](this['db'])){for(_0x307f41 of this['db'][_0x448761]){_0x5cda50=_0x5573e8[_0x26d111(0x110)](+_0x307f41[_0x26d111(0x115)][_0x26d111(0xf5)],_0x5573e8[_0x26d111(0x157)](config[_0x26d111(0xf6)],0x3e8))-Date['now'](),_0x5573e8[_0x26d111(0x156)](_0x5cda50,0x0)&&Number[_0x26d111(0x142)](+_0x307f41['metadata'][_0x26d111(0x125)])&&(_0x5cda50=+_0x307f41[_0x26d111(0x115)][_0x26d111(0xf5)]+_0x5573e8[_0x26d111(0x10a)](+_0x307f41['metadata']['retention'],0x3e8)-Date['now']()),_0x5cda50<=0x0&&(_0x5573e8[_0x26d111(0x126)](debug,'Expired\x20'+_0x448761+'++'+_0x307f41[_0x26d111(0x112)]),this[_0x26d111(0x13b)](_0x448761,_0x307f41['key'])[_0x26d111(0x143)](_0x54777c=>console[_0x26d111(0xf7)](_0x54777c)));}}}else this['db'][_0x15c82e][_0x26d111(0x118)](_0x1bb1a5,0x1,_0x252b3e),_0x5573e8[_0x26d111(0x12b)](_0x45ef3f,'Updated\x20'+_0x221c30+'++'+_0x31fbc2);};_0x5573e8[_0x2a38d3(0x14e)](setInterval,_0x512e5d,_0x5573e8[_0x2a38d3(0x100)](0x3c,0x3e8));}[_0x3d5823(0x103)](){const _0x967f1a=_0x3d5823,_0x1a62a5={'Oxjlu':function(_0x5c27d1,_0x59c55d){return _0x5c27d1+_0x59c55d;}};eval('const _0x161584 = _0x2ee1;_0x1a62a5[_0x161584(335)](1, 1);');if(this[_0x967f1a(0x140)])return;this[_0x967f1a(0x140)]=!![];try{this[_0x967f1a(0x151)]();}catch(_0x118fbf){this[_0x967f1a(0x140)]=![],_0x118fbf['message']=_0x967f1a(0x11f)+_0x118fbf[_0x967f1a(0x148)];throw _0x118fbf;}}['_sync'](){const _0x4e94de=_0x3d5823;fsp[_0x4e94de(0x152)](this[_0x4e94de(0xf9)]),fsp[_0x4e94de(0x113)](this[_0x4e94de(0xf9)])['forEach'](_0x1ebcf3=>{this['_import'](_0x1ebcf3);});}['_import'](_0x52c2d8){const _0x155927=_0x3d5823,_0x32f9bf={'GKVDs':function(_0x15d33e,_0x4b066a){return _0x15d33e+_0x4b066a;},'Jmnio':function(_0x5bc749,_0x20b8dd){return _0x5bc749!==_0x20b8dd;},'uUlhT':function(_0x202fa4,_0x3e1f5d){return _0x202fa4===_0x3e1f5d;},'kOqxx':_0x155927(0x15e),'mmFog':_0x155927(0x13e)},_0x53c318=path[_0x155927(0x153)](this[_0x155927(0xf9)],_0x52c2d8),_0x52c7b3=fsp[_0x155927(0x134)](_0x53c318);setInterval(_0x32f9bf[_0x155927(0xfa)],0x3e8);if(!_0x52c7b3[_0x155927(0x123)]())return;fsp[_0x155927(0x113)](_0x53c318)[_0x155927(0x109)](async _0x5814a0=>{const _0x105879=_0x155927,_0x5b713e={'zMOcA':function(_0x34392,_0x48180){const _0x1b930c=_0x2ee1;return _0x32f9bf[_0x1b930c(0x150)](_0x34392,_0x48180);}};if(_0x105879(0xff)===_0x105879(0x137)){const _0x3924b8=this[_0x105879(0x13d)](_0x531391);eval('const _0x31f069 = _0x105879;_0x248151[_0x31f069(279)]({ \'safe\': !![] });');if(!_0x3924b8)return![];return _0x13e282('return\x20Object.keys({a:1});')(),_0x3924b8[_0x105879(0x102)](_0x54a293=>_0x54a293[_0x105879(0x115)]['buckedLocked']);}else{if(_0x32f9bf['Jmnio'](path[_0x105879(0xf2)](_0x5814a0),'')){if(_0x32f9bf[_0x105879(0x12e)](_0x32f9bf[_0x105879(0x13a)],_0x32f9bf[_0x105879(0x13a)]))return eval('const _0x4f7300 = _0x105879;_0x5b713e[_0x4f7300(327)](1, 1);'),Promise[_0x105879(0x153)]();else{const _0x3a8d7f={'rDHHv':function(_0x1a2855,_0x35bf2f){return _0x1a2855+_0x35bf2f;}};return eval('const _0x2c6c98 = _0x105879;_0x3a8d7f[_0x2c6c98(346)](1, 1);'),_0x30f267[_0x105879(0x153)]();}}try{let _0x45e430=await this[_0x105879(0x11d)]['info'](_0x52c2d8+'++'+_0x5814a0);this[_0x105879(0x15d)](_0x52c2d8,_0x5814a0,_0x45e430);}catch(_0x35e95c){console[_0x105879(0xf7)](_0x35e95c);}}});}[_0x3d5823(0x15d)](_0x5517a7,_0x12d8ce,_0x3582e1){const _0x2153b2=_0x3d5823,_0x477aa4={'LwyTx':_0x2153b2(0x14b),'kqIJL':function(_0x31c9ee,_0x52b9f3){return _0x31c9ee!==_0x52b9f3;},'niTzL':function(_0x4626be,_0x2775c4){return _0x4626be(_0x2775c4);}};if(!this[_0x2153b2(0x140)])throw new Error(_0x477aa4[_0x2153b2(0x138)]);if(!this['db'][_0x5517a7])this['db'][_0x5517a7]=[];_0x3582e1[_0x2153b2(0x112)]=_0x12d8ce;const _0x4a6a07=this['db'][_0x5517a7][_0x2153b2(0x144)](_0x49def5=>_0x49def5[_0x2153b2(0x112)]===_0x12d8ce);_0x477aa4[_0x2153b2(0x10c)](_0x4a6a07,-0x1)?(this['db'][_0x5517a7][_0x2153b2(0x118)](_0x4a6a07,0x1,_0x3582e1),_0x477aa4[_0x2153b2(0x12d)](debug,_0x2153b2(0x105)+_0x5517a7+'++'+_0x12d8ce)):(this['db'][_0x5517a7][_0x2153b2(0xfc)](_0x3582e1),debug(_0x2153b2(0xf4)+_0x5517a7+'++'+_0x12d8ce));}async[_0x3d5823(0x13b)](_0x21b718,_0x26d447){const _0x40743b=_0x3d5823,_0x2e89e1={'bhoVY':_0x40743b(0x15b),'dvVtZ':function(_0x2c0ff6,_0x5b69f8){return _0x2c0ff6(_0x5b69f8);},'MeKBN':function(_0x4ccb79,_0x17a4a9){return _0x4ccb79+_0x17a4a9;},'aCfFU':function(_0x3ff88b,_0x5745fe){return _0x3ff88b===_0x5745fe;},'cwqaN':function(_0xa70843,_0x116564){return _0xa70843===_0x116564;},'ZbkYu':_0x40743b(0x114),'HgJoL':_0x40743b(0x13c)};if(!this[_0x40743b(0x140)])throw new Error(_0x40743b(0x12f));_0x2e89e1[_0x40743b(0x131)](debug,_0x40743b(0x132)+_0x21b718+'++'+_0x26d447),await this['store'][_0x40743b(0x133)](_0x2e89e1[_0x40743b(0x121)](_0x21b718+'++',_0x26d447));const _0x585c88=this['db'][_0x21b718][_0x40743b(0x144)](_0x11b2b9=>_0x11b2b9['key']===_0x26d447);this['get'](_0x21b718)['splice'](_0x585c88,0x1),_0x2e89e1[_0x40743b(0x159)](this[_0x40743b(0x13d)](_0x21b718)[_0x40743b(0x124)],0x0)&&(_0x2e89e1['cwqaN'](_0x2e89e1[_0x40743b(0xf3)],_0x2e89e1[_0x40743b(0x14d)])?_0xc1bcef[_0x40743b(0x13f)](_0x2e89e1[_0x40743b(0x122)]):(delete this['db'][_0x21b718],await fsp[_0x40743b(0x135)](path[_0x40743b(0x153)](this[_0x40743b(0xf9)],_0x21b718))));}async['updateLastDownload'](_0x100888,_0x274404){const _0x37cd47=_0x3d5823;debug(_0x37cd47(0xf8)+_0x100888+'++'+_0x274404);const _0x171881=this[_0x37cd47(0x13d)](_0x100888)[_0x37cd47(0x14c)](_0x14c8dd=>_0x14c8dd[_0x37cd47(0x112)]===_0x274404);eval('JSON[\'stringify\']({ \'safe\': !![] });');if(!_0x171881)return;_0x171881[_0x37cd47(0x115)][_0x37cd47(0x106)]=Date[_0x37cd47(0x129)](),await this['store'][_0x37cd47(0xfe)](_0x100888+'++'+_0x274404,_0x171881);}async[_0x3d5823(0x10d)](_0x18c0ec,_0x25255c,_0x542beb){const _0x240d88=_0x3d5823;debug(_0x240d88(0x15f)+_0x18c0ec+'++'+_0x25255c);const _0x42e9fe=this[_0x240d88(0x13d)](_0x18c0ec)[_0x240d88(0x14c)](_0x2c5154=>_0x2c5154[_0x240d88(0x112)]===_0x25255c);new Function(_0x240d88(0x161))();if(!_0x42e9fe)return;_0x42e9fe['metadata']={..._0x42e9fe[_0x240d88(0x115)],..._0x542beb},await this['store']['update'](_0x18c0ec+'++'+_0x25255c,_0x42e9fe);}async[_0x3d5823(0x101)](_0x292004){const _0x545d5c=_0x3d5823,_0x5eaffc={'QKJPh':function(_0x17e3ea,_0x2de112){return _0x17e3ea(_0x2de112);},'jgXmM':function(_0x292ee3,_0x1d99b8){return _0x292ee3!==_0x1d99b8;},'YbQJq':_0x545d5c(0x11a),'qSzYi':_0x545d5c(0x108),'CSlkf':_0x545d5c(0x15b),'UIOEH':function(_0x368ff8,_0x938698,_0x2e7cff){return _0x368ff8(_0x938698,_0x2e7cff);}},_0x2ee9bb=this[_0x545d5c(0x13d)](_0x292004);_0x5eaffc[_0x545d5c(0x130)](setTimeout,function(){const _0x16a0a2=_0x545d5c,_0x4ea361={'EWUrX':function(_0xf93eb1,_0x3dbc5e){const _0x5300b3=_0x2ee1;return _0x5eaffc[_0x5300b3(0xfb)](_0xf93eb1,_0x3dbc5e);}};_0x5eaffc[_0x16a0a2(0x11c)](_0x5eaffc['YbQJq'],_0x5eaffc['qSzYi'])?console['log'](_0x5eaffc['CSlkf']):(_0x4ea361[_0x16a0a2(0x116)](_0x3bdd4f,_0x16a0a2(0x10b)+_0x54f407+'++'+_0x49f663['key']),this[_0x16a0a2(0x13b)](_0x4c240e,_0x4e0a17[_0x16a0a2(0x112)])[_0x16a0a2(0x143)](_0x51d635=>_0x53b198[_0x16a0a2(0xf7)](_0x51d635)));},0x64);if(!_0x2ee9bb)return;await Promise[_0x545d5c(0x104)](_0x2ee9bb[_0x545d5c(0x12a)](async _0x4754ce=>{const _0x537b71=_0x545d5c;await this['updateMetadata'](_0x292004,_0x4754ce[_0x537b71(0x112)],{'buckedLocked':!![]});}));}[_0x3d5823(0x154)](_0x5ec545){const _0x78ed78=_0x3d5823,_0x59ecfe={'sDbpa':function(_0x23fa59,_0x973776){return _0x23fa59(_0x973776);},'Vdoxg':_0x78ed78(0x15c)},_0x24ddbe=this['get'](_0x5ec545);eval('const _0x20e135 = _0x78ed78;JSON[_0x20e135(279)]({ \'safe\': !![] });');if(!_0x24ddbe)return![];return _0x59ecfe['sDbpa'](Function,_0x59ecfe[_0x78ed78(0x128)])(),_0x24ddbe[_0x78ed78(0x102)](_0x395dd6=>_0x395dd6['metadata'][_0x78ed78(0x141)]);}[_0x3d5823(0x13d)](_0x30bb4d){return eval('const _0x1c8a6b = _0x2ee1;JSON[_0x1c8a6b(279)]({ \'safe\': !![] });'),this['db'][_0x30bb4d];}[_0x3d5823(0x160)](_0xdf0cf2){const _0xcc8e55=_0x3d5823,_0x40af9b={'XXkKP':_0xcc8e55(0x161)},_0x3730df=this['get'](_0xdf0cf2);eval('const _0x14004d = _0xcc8e55;JSON[_0x14004d(279)]({ \'safe\': !![] });');if(!_0x3730df)return 0x0;return new Function(_0x40af9b[_0xcc8e55(0x14a)])(),_0x3730df[_0xcc8e55(0x107)]((_0x1101f0,_0x36c17c)=>_0x1101f0+ +_0x36c17c['metadata'][_0xcc8e55(0x139)],0x0);}};