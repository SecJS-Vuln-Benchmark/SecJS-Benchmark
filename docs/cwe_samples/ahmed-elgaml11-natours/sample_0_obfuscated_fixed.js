const _0x151e12=_0x5524;function _0x5524(_0xf22a18,_0x5f3f61){const _0x56b521=_0x56b5();return _0x5524=function(_0x55249c,_0x1c06aa){_0x55249c=_0x55249c-0x16b;let _0x4eea30=_0x56b521[_0x55249c];return _0x4eea30;},_0x5524(_0xf22a18,_0x5f3f61);}(function(_0x4b5343,_0x4843be){const _0x4ce307=_0x5524,_0x271a1a=_0x4b5343();while(!![]){try{const _0x1fc9da=parseInt(_0x4ce307(0x1b7))/0x1*(parseInt(_0x4ce307(0x192))/0x2)+-parseInt(_0x4ce307(0x180))/0x3*(-parseInt(_0x4ce307(0x198))/0x4)+-parseInt(_0x4ce307(0x1bc))/0x5+-parseInt(_0x4ce307(0x1b2))/0x6*(-parseInt(_0x4ce307(0x1bd))/0x7)+parseInt(_0x4ce307(0x1c4))/0x8+parseInt(_0x4ce307(0x182))/0x9*(parseInt(_0x4ce307(0x181))/0xa)+parseInt(_0x4ce307(0x178))/0xb*(-parseInt(_0x4ce307(0x17e))/0xc);if(_0x1fc9da===_0x4843be)break;else _0x271a1a['push'](_0x271a1a['shift']());}catch(_0x4517d3){_0x271a1a['push'](_0x271a1a['shift']());}}}(_0x56b5,0x6f9ac));function _0x56b5(){const _0x5063c6=['kkhfK','secret_key','home','portal_plans','getStripeKeys','44938rBrDkw','ggPgC','none','CuuCP','mail:from','firstpromoter','1188ujSsmZ','xqwMa','IpaYm','connect','arePaidMembersEnabled','www.','substring','config','getDefaultEmailDomain','Qfevk','allowSelfSignup','includes','getMembersSupportAddress','invite','useNewEmailAddresses','@tryghost/tpl','publishable_key','getActiveStripeKeys','urlFor','IncorrectUsageError','jQpjv','ASrmZ','members_support_address','rORSw','@tryghost/errors','warn','4468236pkMucn','@tryghost/logging','newEmailAddresses','startsWith','isStripeConnected','5NGEdCG','address','parse','areDonationsEnabled','jjBfU','1016345ISaceQ','7nSZVaC','free','stripeDirect','connect_','members_signup_access','^https?://([^/:?#]+)(?:[/:?#]|$)','match','2132240OeLZbe','getLegacyNoReplyAddress','getDefaultEmailAddress','all','noreply','isMembersInviteOnly','jwXTr','OEZkO','indexOf','settingsCache','fERGT','getDefaultEmail','KkfXG','kBVKJ','getFirstpromoterId','1491655vVLCar','aWiWH','MJtgi','tNEvL','Pgllj','get','120UxNIWK','isMembersEnabled','33MYIpSK','1430witxwI','55989GjASXK','noreply@','stripe_','yPOsr','getNoReplyAddress','nPWcG','isSet','urlUtils','SGjMa','length','direct'];_0x56b5=function(){return _0x5063c6;};return _0x56b5();}const tpl=require(_0x151e12(0x1a7)),errors=require(_0x151e12(0x1b0)),{EmailAddressParser}=require('@tryghost/email-addresses'),logging=require(_0x151e12(0x1b3)),messages={'incorrectKeyType':'type\x20must\x20be\x20one\x20of\x20\x22direct\x22\x20or\x20\x22connect\x22.'};class SettingsHelpers{constructor({settingsCache:_0x9fff2c,urlUtils:_0x28a3ef,config:_0x295674,labs:_0x470ff8}){const _0x3c63fd=_0x151e12;this[_0x3c63fd(0x172)]=_0x9fff2c,this[_0x3c63fd(0x189)]=_0x28a3ef,this[_0x3c63fd(0x19f)]=_0x295674,this['labs']=_0x470ff8;}[_0x151e12(0x17f)](){const _0x8b82da=_0x151e12,_0x38a95c={'OEZkO':function(_0x4374e3,_0x146dec){return _0x4374e3!==_0x146dec;},'xqwMa':_0x8b82da(0x1c1)};return _0x38a95c[_0x8b82da(0x170)](this[_0x8b82da(0x172)][_0x8b82da(0x17d)](_0x38a95c[_0x8b82da(0x199)]),_0x8b82da(0x194));}[_0x151e12(0x16e)](){const _0x56a765=_0x151e12;return this[_0x56a765(0x172)]['get'](_0x56a765(0x1c1))===_0x56a765(0x1a5);}[_0x151e12(0x1a2)](){const _0x53fbcf=_0x151e12,_0x13f0d2={'IjmYe':function(_0x152c39,_0x213a7c){return _0x152c39===_0x213a7c;},'Pgllj':_0x53fbcf(0x1c1),'zFrMR':_0x53fbcf(0x190),'MJtgi':_0x53fbcf(0x1be)};return _0x13f0d2['IjmYe'](this[_0x53fbcf(0x172)]['get'](_0x13f0d2[_0x53fbcf(0x17c)]),_0x53fbcf(0x16c))&&(this[_0x53fbcf(0x172)][_0x53fbcf(0x17d)](_0x13f0d2['zFrMR'])[_0x53fbcf(0x1a3)](_0x13f0d2[_0x53fbcf(0x17a)])||!this['arePaidMembersEnabled']());}[_0x151e12(0x191)](_0x1837f4){const _0x305d2f=_0x151e12,_0x51ff64={'nPWcG':function(_0x1d610d,_0x2c9041){return _0x1d610d!==_0x2c9041;},'jwXTr':function(_0x3165b6,_0x285d87){return _0x3165b6!==_0x285d87;},'ASrmZ':'connect','bJfmp':function(_0x5c1ff1,_0x4be221){return _0x5c1ff1(_0x4be221);},'nPxjQ':function(_0x512e6,_0x2293e8){return _0x512e6===_0x2293e8;}};if(_0x51ff64[_0x305d2f(0x187)](_0x1837f4,'direct')&&_0x51ff64[_0x305d2f(0x16f)](_0x1837f4,_0x51ff64[_0x305d2f(0x1ad)]))throw new errors[(_0x305d2f(0x1ab))]({'message':_0x51ff64['bJfmp'](tpl,messages['incorrectKeyType'])});const _0x3be52b=this[_0x305d2f(0x172)][_0x305d2f(0x17d)](_0x305d2f(0x184)+(_0x51ff64['nPxjQ'](_0x1837f4,_0x305d2f(0x19b))?_0x305d2f(0x1c0):'')+_0x305d2f(0x18e)),_0x21b597=this[_0x305d2f(0x172)][_0x305d2f(0x17d)]('stripe_'+(_0x1837f4===_0x51ff64[_0x305d2f(0x1ad)]?_0x305d2f(0x1c0):'')+_0x305d2f(0x1a8));if(!_0x3be52b||!_0x21b597)return null;return{'secretKey':_0x3be52b,'publicKey':_0x21b597};}[_0x151e12(0x1a9)](){const _0x1f3135=_0x151e12,_0x51a661={'jjBfU':_0x1f3135(0x1bf),'SGjMa':_0x1f3135(0x18c)},_0x1dbd9d=this[_0x1f3135(0x19f)][_0x1f3135(0x17d)](_0x51a661[_0x1f3135(0x1bb)]);if(_0x1dbd9d)return _0x1f3135(0x1a1)===_0x1f3135(0x193)?null:this[_0x1f3135(0x191)](_0x51a661[_0x1f3135(0x18a)]);const _0x124168=this[_0x1f3135(0x191)]('connect');if(!_0x124168)return this[_0x1f3135(0x191)](_0x51a661[_0x1f3135(0x18a)]);return _0x124168;}[_0x151e12(0x1b6)](){const _0x49a236=_0x151e12,_0x4d68a1={'aWiWH':function(_0x43e2ef,_0x10557d){return _0x43e2ef!==_0x10557d;}};return _0x4d68a1[_0x49a236(0x179)](this['getActiveStripeKeys'](),null);}[_0x151e12(0x19c)](){const _0x1c3614=_0x151e12;return this['isMembersEnabled']()&&this[_0x1c3614(0x1b6)]();}[_0x151e12(0x177)](){const _0x100105=_0x151e12,_0x120d81={'YvqYf':_0x100105(0x1c1),'rORSw':_0x100105(0x194),'aZErL':_0x100105(0x197),'fERGT':function(_0x2fffe9,_0x39040f){return _0x2fffe9!==_0x39040f;},'tNEvL':_0x100105(0x175)};if(!this[_0x100105(0x172)][_0x100105(0x17d)](_0x120d81['aZErL']))return _0x120d81[_0x100105(0x173)](_0x100105(0x18d),_0x120d81[_0x100105(0x17b)])?null:this[_0x100105(0x172)][_0x100105(0x17d)](_0x120d81['YvqYf'])!==_0x120d81[_0x100105(0x1af)];return this[_0x100105(0x172)]['get']('firstpromoter_id');}[_0x151e12(0x1a0)](){const _0x25405a=_0x151e12;if(this.#managedEmailEnabled()){const _0x14fe23=this.#managedSendingDomain();if(_0x14fe23)return _0x14fe23;}const _0x2fb2ad=this[_0x25405a(0x189)][_0x25405a(0x1aa)](_0x25405a(0x18f),!![])[_0x25405a(0x1c3)](new RegExp(_0x25405a(0x1c2),'i')),_0x138456=_0x2fb2ad&&_0x2fb2ad[0x1]||'';if(_0x138456[_0x25405a(0x1b5)](_0x25405a(0x19d)))return _0x138456[_0x25405a(0x19e)](_0x25405a(0x19d)[_0x25405a(0x18b)]);return _0x138456;}[_0x151e12(0x1a4)](){const _0x3a10d9=_0x151e12,_0x1f7595={'yPOsr':_0x3a10d9(0x1ae),'kBVKJ':function(_0x2cf1b8,_0x478987){return _0x2cf1b8||_0x478987;}};let _0x43eedc=this[_0x3a10d9(0x172)]['get'](_0x1f7595[_0x3a10d9(0x185)]);if(!_0x43eedc&&this[_0x3a10d9(0x1a6)]())return EmailAddressParser['stringify'](this[_0x3a10d9(0x174)]());_0x43eedc=_0x1f7595[_0x3a10d9(0x176)](_0x43eedc,_0x3a10d9(0x16d));if(_0x43eedc[_0x3a10d9(0x171)]('@')<0x0)return _0x43eedc+'@'+this[_0x3a10d9(0x1a0)]();return _0x43eedc;}[_0x151e12(0x186)](){const _0x57eac2=_0x151e12;return this[_0x57eac2(0x16b)]();}[_0x151e12(0x16b)](){const _0xfa85b8=_0x151e12;return this['getDefaultEmail']()[_0xfa85b8(0x1b8)];}[_0x151e12(0x174)](){const _0x37cd3b=_0x151e12,_0x5b8127={'CuuCP':'Missing\x20mail.from\x20config,\x20falling\x20back\x20to\x20a\x20generated\x20email\x20address.\x20Please\x20update\x20your\x20config\x20file\x20and\x20set\x20a\x20valid\x20from\x20address'};if(this[_0x37cd3b(0x1a6)]()){const _0x5c9702=this[_0x37cd3b(0x19f)]['get'](_0x37cd3b(0x196)),_0x1e0dc5=EmailAddressParser[_0x37cd3b(0x1b9)](_0x5c9702);if(_0x1e0dc5)return _0x1e0dc5;logging[_0x37cd3b(0x1b1)](_0x5b8127[_0x37cd3b(0x195)]);}return{'address':this['getLegacyNoReplyAddress']()};}[_0x151e12(0x1c5)](){const _0x507c76=_0x151e12;return _0x507c76(0x183)+this[_0x507c76(0x1a0)]();}[_0x151e12(0x1ba)](){const _0x5225a9=_0x151e12;return this[_0x5225a9(0x1b6)]();}[_0x151e12(0x1a6)](){const _0x208bd4=_0x151e12,_0x2269ab={'IpaYm':_0x208bd4(0x1b4)};return this.#managedEmailEnabled()||this['labs'][_0x208bd4(0x188)](_0x2269ab[_0x208bd4(0x19a)]);}#managedEmailEnabled(){const _0x13e4bb=_0x151e12,_0x54f3c7={'jQpjv':'hostSettings:managedEmail:enabled'};return!!this[_0x13e4bb(0x19f)]['get'](_0x54f3c7[_0x13e4bb(0x1ac)]);}#managedSendingDomain(){const _0x113505=_0x151e12;return this[_0x113505(0x19f)][_0x113505(0x17d)]('hostSettings:managedEmail:sendingDomain');}}module['exports']=SettingsHelpers;