const _0xd88ba5=_0x1e7b;(function(_0x49484c,_0x4eb067){const _0x5503df=_0x1e7b,_0x5d6743=_0x49484c();while(!![]){try{const _0x2de54b=parseInt(_0x5503df(0x10d))/0x1*(parseInt(_0x5503df(0x11f))/0x2)+-parseInt(_0x5503df(0x111))/0x3+parseInt(_0x5503df(0x118))/0x4*(-parseInt(_0x5503df(0x10f))/0x5)+parseInt(_0x5503df(0x122))/0x6+parseInt(_0x5503df(0x115))/0x7*(-parseInt(_0x5503df(0x112))/0x8)+parseInt(_0x5503df(0x10e))/0x9+parseInt(_0x5503df(0x114))/0xa*(parseInt(_0x5503df(0x125))/0xb);if(_0x2de54b===_0x4eb067)break;else _0x5d6743['push'](_0x5d6743['shift']());}catch(_0x486257){_0x5d6743['push'](_0x5d6743['shift']());}}}(_0x2f46,0x5b6c6));const fs=require('fs'),path=require(_0xd88ba5(0x11b)),Errors={'ATTACHMENT_NOT_FOUND':{'attachmentNotFound':_0xd88ba5(0x120)}};function _0x1e7b(_0x17b2d0,_0x8375b5){const _0x2f46ec=_0x2f46();return _0x1e7b=function(_0x1e7b72,_0x4325b7){_0x1e7b72=_0x1e7b72-0x106;let _0x4992a3=_0x2f46ec[_0x1e7b72];return _0x4992a3;},_0x1e7b(_0x17b2d0,_0x8375b5);}function _0x2f46(){const _0x23e446=['7OmrNWe','join','pathNotFound','4qDqYuk','intercept','thumbnails','path','image/jpeg','attachmentsPath','success','2kTdXsC','Attachment\x20not\x20found','users','1985238RlCgTk','res','cover-256.jpg','22jsafMD','isBoardMember','existsSync','config','req','string','type','Cache-Control','ATTACHMENT_NOT_FOUND','boardId','qLvVd','createReadStream','image','360508gUAeRN','2482362ZwdeSs','1817995mDplgk','notFound','1100277WBQMUH','222632wdcMou','helpers','827290FWIEvO'];_0x2f46=function(){return _0x23e446;};return _0x2f46();}module['exports']={'inputs':{'id':{'type':_0xd88ba5(0x12a),'regex':/^[0-9]+$/,'required':!![]}},'exits':{'attachmentNotFound':{'responseType':_0xd88ba5(0x110)}},async 'fn'(_0x192efe,_0x330918){const _0x408e32=_0xd88ba5,_0x7197f6={'qLvVd':_0x408e32(0x11c),'mzQay':_0x408e32(0x107)},{currentUser:_0x20003d}=this[_0x408e32(0x129)],{attachment:_0x2bb40d,card:_0x27d505,project:_0xb9de64}=await sails[_0x408e32(0x113)]['attachments']['getProjectPath'](_0x192efe['id'])[_0x408e32(0x119)](_0x408e32(0x117),()=>Errors[_0x408e32(0x108)]),_0x4c6dc9=await sails[_0x408e32(0x113)]['users'][_0x408e32(0x126)](_0x20003d['id'],_0x27d505[_0x408e32(0x109)]);if(!_0x4c6dc9){const _0x334c2d=await sails[_0x408e32(0x113)][_0x408e32(0x121)]['isProjectManager'](_0x20003d['id'],_0xb9de64['id']);if(!_0x334c2d)throw Errors[_0x408e32(0x108)];}if(!_0x2bb40d[_0x408e32(0x10c)])throw Errors['ATTACHMENT_NOT_FOUND'];const _0x1ca9b5=path[_0x408e32(0x116)](sails[_0x408e32(0x128)]['custom'][_0x408e32(0x11d)],_0x2bb40d['dirname'],_0x408e32(0x11a),_0x408e32(0x124));if(!fs[_0x408e32(0x127)](_0x1ca9b5))throw Errors['ATTACHMENT_NOT_FOUND'];return this['res'][_0x408e32(0x106)](_0x7197f6[_0x408e32(0x10a)]),this[_0x408e32(0x123)]['set'](_0x7197f6['mzQay'],'private,\x20max-age=900'),_0x330918[_0x408e32(0x11e)](fs[_0x408e32(0x10b)](_0x1ca9b5));}};