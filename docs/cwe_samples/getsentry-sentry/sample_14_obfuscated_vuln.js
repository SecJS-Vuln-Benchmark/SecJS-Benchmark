const _0x15d804=_0x2e17;(function(_0x5b67c7,_0x5a35cb){const _0x31c8c7=_0x2e17,_0x40dd15=_0x5b67c7();while(!![]){try{const _0xdb9aa=-parseInt(_0x31c8c7(0x12d))/0x1+parseInt(_0x31c8c7(0x15f))/0x2*(parseInt(_0x31c8c7(0x11e))/0x3)+-parseInt(_0x31c8c7(0x131))/0x4*(-parseInt(_0x31c8c7(0x145))/0x5)+-parseInt(_0x31c8c7(0x151))/0x6+parseInt(_0x31c8c7(0x171))/0x7*(parseInt(_0x31c8c7(0x163))/0x8)+parseInt(_0x31c8c7(0x12b))/0x9*(parseInt(_0x31c8c7(0x11c))/0xa)+parseInt(_0x31c8c7(0x14a))/0xb*(-parseInt(_0x31c8c7(0x155))/0xc);if(_0xdb9aa===_0x5a35cb)break;else _0x40dd15['push'](_0x40dd15['shift']());}catch(_0xb03770){_0x40dd15['push'](_0x40dd15['shift']());}}}(_0x48e2,0xd6013));function _0x2e17(_0x2d6a33,_0x558dbd){const _0x48e25c=_0x48e2();return _0x2e17=function(_0x2e175b,_0x3688cc){_0x2e175b=_0x2e175b-0x101;let _0x29235b=_0x48e25c[_0x2e175b];return _0x29235b;},_0x2e17(_0x2d6a33,_0x558dbd);}const chai=require(_0x15d804(0x180)),sinon=require(_0x15d804(0x102)),{PluginLoader}=require('../src/plugin'),db=require(_0x15d804(0x128));chai[_0x15d804(0x176)]();function _0x48e2(){const _0x97ab26=['rejects','newCommitHash','continue','executeChain\x20should\x20run\x20no\x20actions\x20if\x20not\x20a\x20push\x20or\x20pull','ICPQp','PvEjk','BIAPX','deep','cache','eQgmN','should\x20approve\x20push\x20automatically\x20and\x20record\x20in\x20the\x20database','felnz','gitleaks','authorise','YUoAj','pluginsInserted','stub','10rRHRSK','qyYuH','6XLNmxm','eTBaf','QKPtn','getChain','UlHZy','preReceive','nInIp','mzZyJ','Push\x20automatically\x20rejected\x20by\x20pre-receive\x20hook.','writePack','../src/db','equal','checkIfWaitingAuth','5329971qPksUF','RJaeK','685910AWJqlr','fhzZZ','assign','test-repo','63416NJRpeZ','bar.exec','expect','gfdvo','getChain\x20should\x20load\x20plugins\x20from\x20an\x20initialized\x20PluginLoader','length','../src/proxy/processors','SjTVJ','istyj','foo.exec','UEFTA','calledOnce','rQzbq','value','checkRepoInAuthorisedList','clearBareClone','function','sINfJ','TCqvo','foo','335FUFAmn','false','blockForAuth','bcoov','restore','513238NUJkuS','checkUserPushPermission','resolves','zoukd','getMissingData','displayName','CdXZr','8015010IPAVPB','proxy\x20chain','executeChain','../src/proxy/chain','48Cyrjwj','DHbIA','AEyLN','Audit\x20error','MEKyC','executeChain\x20should\x20stop\x20executing\x20if\x20action\x20has\x20continue\x20returns\x20false','greaterThan','parseAction','pNPgw','wlVfL','1287502hvcICp','type','Database\x20error','vndTq','72euiwSh','VVtdm','reset','Error\x20during\x20auto-approval:','FyeNh','true','parsePush','Bewjo','error','message','resolve','pullActionChain','checkCommitMessages','checkHiddenCommits','111223ozDkYX','undefined','getDiff','pullRemote','CbyBp','should','log','called','chainPluginLoader','getChain\x20should\x20load\x20pull\x20plugins\x20from\x20an\x20initialized\x20PluginLoader','avmOM','bwMqW','calledOnceWith','JndKZ','vUuxo','chai','push','scanDiff','getChain\x20should\x20set\x20pluginLoaded\x20if\x20loader\x20is\x20undefined','allowPush','pre','Push\x20automatically\x20approved\x20by\x20pre-receive\x20hook.','sinon','pushActionChain','audit','RpSkz','checkAuthorEmails','aSqGY','pull','CQIDL','Aydtf'];_0x48e2=function(){return _0x97ab26;};return _0x48e2();}const expect=chai[_0x15d804(0x133)],mockLoader={'pushPlugins':[{'exec':Object[_0x15d804(0x12f)](async()=>console[_0x15d804(0x177)](_0x15d804(0x144)),{'displayName':_0x15d804(0x13a)})}],'pullPlugins':[{'exec':Object[_0x15d804(0x12f)](async()=>console[_0x15d804(0x177)](_0x15d804(0x144)),{'displayName':_0x15d804(0x132)})}]},initMockPushProcessors=_0x106e93=>{const _0x30ddce=_0x15d804,_0x3b25bc={'BqYVx':_0x30ddce(0x169),'clSIh':_0x30ddce(0x106),'wlVfL':_0x30ddce(0x170),'RdzvW':'getDiff','mzZyJ':_0x30ddce(0x117),'ICPQp':_0x30ddce(0x147)},_0x283238={'parsePush':_0x106e93[_0x30ddce(0x11b)](),'audit':_0x106e93[_0x30ddce(0x11b)](),'checkRepoInAuthorisedList':_0x106e93[_0x30ddce(0x11b)](),'checkCommitMessages':_0x106e93[_0x30ddce(0x11b)](),'checkAuthorEmails':_0x106e93[_0x30ddce(0x11b)](),'checkUserPushPermission':_0x106e93[_0x30ddce(0x11b)](),'checkIfWaitingAuth':_0x106e93[_0x30ddce(0x11b)](),'checkHiddenCommits':_0x106e93[_0x30ddce(0x11b)](),'pullRemote':_0x106e93[_0x30ddce(0x11b)](),'writePack':_0x106e93['stub'](),'preReceive':_0x106e93[_0x30ddce(0x11b)](),'getDiff':_0x106e93[_0x30ddce(0x11b)](),'gitleaks':_0x106e93[_0x30ddce(0x11b)](),'clearBareClone':_0x106e93['stub'](),'scanDiff':_0x106e93[_0x30ddce(0x11b)](),'blockForAuth':_0x106e93[_0x30ddce(0x11b)](),'getMissingData':_0x106e93[_0x30ddce(0x11b)]()};return _0x283238['parsePush']['displayName']=_0x3b25bc['BqYVx'],_0x283238[_0x30ddce(0x104)][_0x30ddce(0x14f)]=_0x30ddce(0x104),_0x283238['checkRepoInAuthorisedList'][_0x30ddce(0x14f)]=_0x30ddce(0x13f),_0x283238['checkCommitMessages']['displayName']=_0x30ddce(0x16f),_0x283238[_0x30ddce(0x106)][_0x30ddce(0x14f)]=_0x3b25bc['clSIh'],_0x283238[_0x30ddce(0x14b)][_0x30ddce(0x14f)]=_0x30ddce(0x14b),_0x283238['checkIfWaitingAuth'][_0x30ddce(0x14f)]='checkIfWaitingAuth',_0x283238['checkHiddenCommits'][_0x30ddce(0x14f)]=_0x3b25bc[_0x30ddce(0x15e)],_0x283238[_0x30ddce(0x174)][_0x30ddce(0x14f)]='pullRemote',_0x283238[_0x30ddce(0x127)][_0x30ddce(0x14f)]=_0x30ddce(0x127),_0x283238[_0x30ddce(0x123)][_0x30ddce(0x14f)]='preReceive',_0x283238[_0x30ddce(0x173)][_0x30ddce(0x14f)]=_0x3b25bc['RdzvW'],_0x283238[_0x30ddce(0x117)]['displayName']=_0x3b25bc[_0x30ddce(0x125)],_0x283238[_0x30ddce(0x140)]['displayName']=_0x30ddce(0x140),_0x283238[_0x30ddce(0x182)][_0x30ddce(0x14f)]=_0x30ddce(0x182),_0x283238[_0x30ddce(0x147)][_0x30ddce(0x14f)]=_0x3b25bc[_0x30ddce(0x10f)],_0x283238[_0x30ddce(0x14e)]['displayName']=_0x30ddce(0x14e),_0x283238;},mockPreProcessors={'parseAction':sinon[_0x15d804(0x11b)]()};let mockPushProcessors;const clearCache=_0x271155=>{const _0x2a04cf=_0x15d804,_0x301ed0={'vndTq':_0x2a04cf(0x137)};delete require[_0x2a04cf(0x113)][require[_0x2a04cf(0x16d)](_0x301ed0[_0x2a04cf(0x162)])],delete require[_0x2a04cf(0x113)][require['resolve']('../src/proxy/chain')],_0x271155[_0x2a04cf(0x165)]();};describe(_0x15d804(0x152),function(){const _0x1a8090=_0x15d804,_0x20dd1d={'Aydtf':function(_0x16f1ad,_0x3dca84){return _0x16f1ad(_0x3dca84);},'RpSkz':_0x1a8090(0x185),'UEFTA':function(_0x10507e,_0x18c57c){return _0x10507e(_0x18c57c);},'DhbVj':_0x1a8090(0x154),'YUoAj':_0x1a8090(0x181),'zoukd':function(_0x3a967d,_0x2e7c8b){return _0x3a967d(_0x2e7c8b);},'CbyBp':_0x1a8090(0x108),'CQIDL':function(_0x303262,_0x52b7d9){return _0x303262(_0x52b7d9);},'BIAPX':function(_0x4fd8ad,_0x5a9259){return _0x4fd8ad(_0x5a9259);},'pNPgw':function(_0x2de511,_0x347d1d){return _0x2de511(_0x347d1d);},'PvEjk':_0x1a8090(0x141),'UlHZy':function(_0x36dabe,_0x9aad8c){return _0x36dabe(_0x9aad8c);},'bwMqW':function(_0x71b112,_0x21104f){return _0x71b112(_0x21104f);},'CdXZr':function(_0x5e3a4a,_0x37bae6){return _0x5e3a4a(_0x37bae6);},'qyYuH':function(_0x91f8f9,_0x576f4f){return _0x91f8f9(_0x576f4f);},'eTBaf':function(_0x506948,_0x53ae25){return _0x506948(_0x53ae25);},'istyj':function(_0x3b8cc0,_0x4b811a){return _0x3b8cc0(_0x4b811a);},'dfbJt':function(_0x1d8ce4,_0x5bf2ea){return _0x1d8ce4(_0x5bf2ea);},'sINfJ':function(_0x347f93,_0x30ccbe){return _0x347f93(_0x30ccbe);},'vESpg':function(_0x222996,_0x20b06e){return _0x222996(_0x20b06e);},'nInIp':function(_0x5b7187,_0x3326fa){return _0x5b7187(_0x3326fa);},'KzeQn':_0x1a8090(0x144),'eQgmN':function(_0x5c72c3,_0x1c13be){return _0x5c72c3(_0x1c13be);},'fDvzC':function(_0x505e88,_0x16f1d9){return _0x505e88(_0x16f1d9);},'TCqvo':_0x1a8090(0x10c),'LhXPS':'Push\x20automatically\x20rejected\x20by\x20pre-receive\x20hook.','VVtdm':'reject','aSqGY':function(_0x117c32,_0x22a587){return _0x117c32(_0x22a587);},'CxxLe':function(_0x5b6e8b,_0x57b649){return _0x5b6e8b(_0x57b649);},'avmOM':_0x1a8090(0x161),'vUuxo':_0x1a8090(0x16b),'JndKZ':'authorise','Bewjo':function(_0x2eebc5,_0x1f33b3){return _0x2eebc5(_0x1f33b3);},'gfdvo':'Error\x20during\x20auto-rejection:','bcoov':function(_0x47dce6,_0x2d722e){return _0x47dce6(_0x2d722e);},'fhzZZ':function(_0x3eaea2,_0x420b7c,_0x402627){return _0x3eaea2(_0x420b7c,_0x402627);},'HBdzP':_0x1a8090(0x135),'QKPtn':_0x1a8090(0x17a),'DHbIA':function(_0x66df83,_0x1cd7b6,_0x1005b4){return _0x66df83(_0x1cd7b6,_0x1005b4);},'uWmjR':_0x1a8090(0x15a),'felnz':function(_0x454ba3,_0x1496ae,_0x29f3b5){return _0x454ba3(_0x1496ae,_0x29f3b5);},'rQzbq':function(_0x1cff72,_0x16c465,_0xcaaad9){return _0x1cff72(_0x16c465,_0xcaaad9);},'AEyLN':_0x1a8090(0x115),'FyeNh':function(_0x40b7cf,_0x55cd10,_0x24012d){return _0x40b7cf(_0x55cd10,_0x24012d);},'RJaeK':'should\x20reject\x20push\x20automatically\x20and\x20record\x20in\x20the\x20database','MEKyC':function(_0x14e825,_0x2db97d,_0x5e8703){return _0x14e825(_0x2db97d,_0x5e8703);},'rZzbo':'executeChain\x20should\x20handle\x20exceptions\x20in\x20attemptAutoApproval','SjTVJ':'executeChain\x20should\x20handle\x20exceptions\x20in\x20attemptAutoRejection'};let _0x4a720d,_0xbc053b,_0x2d1ceb,_0x5558f7;_0x20dd1d[_0x1a8090(0x148)](beforeEach,async()=>{const _0x48dbbf=_0x1a8090;_0x5558f7=sinon['createSandbox'](),_0x2d1ceb=_0x20dd1d[_0x48dbbf(0x10a)](initMockPushProcessors,_0x5558f7),_0x4a720d=await import('../src/proxy/processors'),_0x5558f7[_0x48dbbf(0x11b)](_0x4a720d,_0x20dd1d[_0x48dbbf(0x105)])[_0x48dbbf(0x13e)](mockPreProcessors),_0x5558f7[_0x48dbbf(0x11b)](_0x4a720d,'push')['value'](_0x2d1ceb),_0xbc053b=_0x20dd1d[_0x48dbbf(0x13b)](require,_0x20dd1d['DhbVj'])['default'],_0xbc053b[_0x48dbbf(0x179)]=new PluginLoader([]);}),_0x20dd1d['fDvzC'](afterEach,()=>{clearCache(_0x5558f7);}),it(_0x1a8090(0x183),async function(){const _0x17266c=_0x1a8090;_0xbc053b[_0x17266c(0x179)]=undefined;const _0x48b3a7=await _0xbc053b['getChain']({'type':_0x17266c(0x181)});expect(_0x48b3a7)['to']['deep'][_0x17266c(0x129)](_0xbc053b[_0x17266c(0x103)]),expect(_0xbc053b[_0x17266c(0x179)])['to']['be'][_0x17266c(0x172)],_0x20dd1d[_0x17266c(0x13b)](expect,_0xbc053b[_0x17266c(0x11a)])['to']['be'][_0x17266c(0x168)];}),_0x20dd1d[_0x1a8090(0x12e)](it,_0x20dd1d['HBdzP'],async function(){const _0x51fce9=_0x1a8090;_0xbc053b[_0x51fce9(0x179)]=mockLoader;const _0x1035a7=[..._0xbc053b[_0x51fce9(0x103)]],_0x52a9ac=await _0xbc053b[_0x51fce9(0x121)]({'type':_0x20dd1d['YUoAj']});_0x20dd1d[_0x51fce9(0x14d)](expect,_0x52a9ac[_0x51fce9(0x136)])['to']['be']['greaterThan'](_0x1035a7[_0x51fce9(0x136)]),expect(_0xbc053b[_0x51fce9(0x11a)])['to']['be'][_0x51fce9(0x168)];}),it(_0x20dd1d[_0x1a8090(0x120)],async function(){const _0x475df9=_0x1a8090;_0xbc053b['chainPluginLoader']=mockLoader;const _0xd89882=[..._0xbc053b[_0x475df9(0x16e)]],_0x4d5570=await _0xbc053b['getChain']({'type':_0x20dd1d[_0x475df9(0x175)]});expect(_0x4d5570[_0x475df9(0x136)])['to']['be'][_0x475df9(0x15b)](_0xd89882[_0x475df9(0x136)]),_0x20dd1d[_0x475df9(0x109)](expect,_0xbc053b[_0x475df9(0x11a)])['to']['be']['true'];}),_0x20dd1d[_0x1a8090(0x156)](it,_0x20dd1d['uWmjR'],async function(){const _0x1212e2=_0x1a8090,_0xafad6d={},_0x382838={'type':_0x1212e2(0x181),'continue':()=>!![],'allowPush':![]};mockPreProcessors[_0x1212e2(0x15c)][_0x1212e2(0x14c)]({'type':_0x20dd1d[_0x1212e2(0x119)]}),_0x2d1ceb[_0x1212e2(0x169)][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb['checkRepoInAuthorisedList'][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb['checkCommitMessages']['resolves'](_0x382838),_0x2d1ceb[_0x1212e2(0x106)][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb[_0x1212e2(0x14b)]['resolves'](_0x382838),_0x2d1ceb[_0x1212e2(0x170)][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb[_0x1212e2(0x174)][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb[_0x1212e2(0x127)][_0x1212e2(0x14c)](_0x382838),_0x2d1ceb[_0x1212e2(0x12a)][_0x1212e2(0x14c)]({'type':_0x20dd1d[_0x1212e2(0x119)],'continue':()=>![],'allowPush':![]});const _0x4837e3=await _0xbc053b[_0x1212e2(0x153)](_0xafad6d);expect(mockPreProcessors[_0x1212e2(0x15c)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],_0x20dd1d[_0x1212e2(0x14d)](expect,_0x2d1ceb[_0x1212e2(0x169)]['called'])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x13f)][_0x1212e2(0x178)])['to']['be']['true'],expect(_0x2d1ceb[_0x1212e2(0x16f)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x106)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x14b)]['called'])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb['checkIfWaitingAuth'][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x174)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],_0x20dd1d[_0x1212e2(0x13b)](expect,_0x2d1ceb['checkHiddenCommits'][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x127)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x168)],expect(_0x2d1ceb[_0x1212e2(0x14e)][_0x1212e2(0x178)])['to']['be'][_0x1212e2(0x146)],_0x20dd1d[_0x1212e2(0x111)](expect,_0x2d1ceb[_0x1212e2(0x104)]['called'])['to']['be'][_0x1212e2(0x168)],_0x20dd1d[_0x1212e2(0x109)](expect,_0x4837e3['type'])['to'][_0x1212e2(0x129)](_0x20dd1d[_0x1212e2(0x119)]),_0x20dd1d[_0x1212e2(0x15d)](expect,_0x4837e3[_0x1212e2(0x184)])['to']['be'][_0x1212e2(0x146)],expect(_0x4837e3[_0x1212e2(0x10d)])['to']['be']['a'](_0x20dd1d[_0x1212e2(0x110)]);}),_0x20dd1d[_0x1a8090(0x156)](it,'executeChain\x20should\x20stop\x20executing\x20if\x20action\x20has\x20allowPush\x20is\x20set\x20to\x20true',async function(){const _0x1fa68a=_0x1a8090,_0x1a49b2={},_0x3de2a2={'type':_0x1fa68a(0x181),'continue':()=>!![],'allowPush':![]};mockPreProcessors[_0x1fa68a(0x15c)][_0x1fa68a(0x14c)]({'type':_0x20dd1d[_0x1fa68a(0x119)]}),_0x2d1ceb['parsePush'][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x13f)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x16f)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x106)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x14b)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x170)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x174)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x127)][_0x1fa68a(0x14c)](_0x3de2a2),_0x2d1ceb[_0x1fa68a(0x12a)][_0x1fa68a(0x14c)]({'type':_0x1fa68a(0x181),'continue':()=>!![],'allowPush':!![]});const _0x54224f=await _0xbc053b[_0x1fa68a(0x153)](_0x1a49b2);_0x20dd1d[_0x1fa68a(0x14d)](expect,mockPreProcessors['parseAction']['called'])['to']['be'][_0x1fa68a(0x168)],expect(_0x2d1ceb[_0x1fa68a(0x169)][_0x1fa68a(0x178)])['to']['be'][_0x1fa68a(0x168)],expect(_0x2d1ceb[_0x1fa68a(0x13f)]['called'])['to']['be'][_0x1fa68a(0x168)],_0x20dd1d[_0x1fa68a(0x13b)](expect,_0x2d1ceb[_0x1fa68a(0x16f)][_0x1fa68a(0x178)])['to']['be']['true'],expect(_0x2d1ceb[_0x1fa68a(0x106)][_0x1fa68a(0x178)])['to']['be']['true'],_0x20dd1d[_0x1fa68a(0x111)](expect,_0x2d1ceb[_0x1fa68a(0x14b)]['called'])['to']['be'][_0x1fa68a(0x168)],_0x20dd1d['pNPgw'](expect,_0x2d1ceb[_0x1fa68a(0x12a)]['called'])['to']['be'][_0x1fa68a(0x168)],expect(_0x2d1ceb[_0x1fa68a(0x174)]['called'])['to']['be'][_0x1fa68a(0x168)],expect(_0x2d1ceb['checkHiddenCommits'][_0x1fa68a(0x178)])['to']['be'][_0x1fa68a(0x168)],expect(_0x2d1ceb[_0x1fa68a(0x127)][_0x1fa68a(0x178)])['to']['be'][_0x1fa68a(0x168)],_0x20dd1d[_0x1fa68a(0x13b)](expect,_0x2d1ceb[_0x1fa68a(0x14e)]['called'])['to']['be']['false'],_0x20dd1d[_0x1fa68a(0x122)](expect,_0x2d1ceb['audit'][_0x1fa68a(0x178)])['to']['be']['true'],_0x20dd1d[_0x1fa68a(0x17c)](expect,_0x54224f[_0x1fa68a(0x160)])['to'][_0x1fa68a(0x129)]('push'),_0x20dd1d[_0x1fa68a(0x150)](expect,_0x54224f[_0x1fa68a(0x184)])['to']['be'][_0x1fa68a(0x168)],_0x20dd1d['pNPgw'](expect,_0x54224f['continue'])['to']['be']['a'](_0x1fa68a(0x141));}),_0x20dd1d[_0x1a8090(0x116)](it,'executeChain\x20should\x20execute\x20all\x20steps\x20if\x20all\x20actions\x20succeed',async function(){const _0x32bd6a=_0x1a8090,_0x270a59={},_0x5f411d={'type':_0x32bd6a(0x181),'continue':()=>!![],'allowPush':![]};mockPreProcessors[_0x32bd6a(0x15c)][_0x32bd6a(0x14c)]({'type':_0x20dd1d[_0x32bd6a(0x119)]}),_0x2d1ceb[_0x32bd6a(0x169)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x13f)]['resolves'](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x16f)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x106)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x14b)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x12a)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb['pullRemote'][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x127)]['resolves'](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x170)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x123)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb['getDiff'][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb['gitleaks'][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x140)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb['scanDiff'][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x147)][_0x32bd6a(0x14c)](_0x5f411d),_0x2d1ceb[_0x32bd6a(0x14e)][_0x32bd6a(0x14c)](_0x5f411d);const _0x28f9c2=await _0xbc053b[_0x32bd6a(0x153)](_0x270a59);_0x20dd1d[_0x32bd6a(0x11d)](expect,mockPreProcessors[_0x32bd6a(0x15c)][_0x32bd6a(0x178)])['to']['be']['true'],_0x20dd1d[_0x32bd6a(0x13b)](expect,_0x2d1ceb[_0x32bd6a(0x169)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],_0x20dd1d[_0x32bd6a(0x11f)](expect,_0x2d1ceb[_0x32bd6a(0x13f)][_0x32bd6a(0x178)])['to']['be']['true'],expect(_0x2d1ceb['checkCommitMessages']['called'])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb[_0x32bd6a(0x106)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb[_0x32bd6a(0x14b)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb[_0x32bd6a(0x12a)][_0x32bd6a(0x178)])['to']['be']['true'],expect(_0x2d1ceb[_0x32bd6a(0x174)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb[_0x32bd6a(0x170)][_0x32bd6a(0x178)])['to']['be']['true'],_0x20dd1d['CdXZr'](expect,_0x2d1ceb[_0x32bd6a(0x127)][_0x32bd6a(0x178)])['to']['be']['true'],_0x20dd1d[_0x32bd6a(0x139)](expect,_0x2d1ceb[_0x32bd6a(0x123)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],_0x20dd1d['dfbJt'](expect,_0x2d1ceb[_0x32bd6a(0x173)][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb['gitleaks'][_0x32bd6a(0x178)])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb['clearBareClone']['called'])['to']['be'][_0x32bd6a(0x168)],expect(_0x2d1ceb[_0x32bd6a(0x182)]['called'])['to']['be']['true'],expect(_0x2d1ceb['blockForAuth'][_0x32bd6a(0x178)])['to']['be']['true'],expect(_0x2d1ceb[_0x32bd6a(0x104)][_0x32bd6a(0x178)])['to']['be']['true'],_0x20dd1d[_0x32bd6a(0x11d)](expect,_0x2d1ceb[_0x32bd6a(0x14e)]['called'])['to']['be']['true'],_0x20dd1d[_0x32bd6a(0x142)](expect,_0x28f9c2[_0x32bd6a(0x160)])['to'][_0x32bd6a(0x129)](_0x32bd6a(0x181)),_0x20dd1d['vESpg'](expect,_0x28f9c2[_0x32bd6a(0x184)])['to']['be'][_0x32bd6a(0x146)],expect(_0x28f9c2[_0x32bd6a(0x10d)])['to']['be']['a'](_0x20dd1d[_0x32bd6a(0x110)]);}),_0x20dd1d[_0x1a8090(0x156)](it,'executeChain\x20should\x20run\x20the\x20expected\x20steps\x20for\x20pulls',async function(){const _0x4a0ab9=_0x1a8090,_0x5d22e2={},_0x185eb9={'type':_0x4a0ab9(0x108),'continue':()=>!![],'allowPush':![]};mockPreProcessors[_0x4a0ab9(0x15c)][_0x4a0ab9(0x14c)]({'type':_0x20dd1d[_0x4a0ab9(0x175)]}),_0x2d1ceb[_0x4a0ab9(0x13f)]['resolves'](_0x185eb9);const _0x319864=await _0xbc053b[_0x4a0ab9(0x153)](_0x5d22e2);expect(_0x2d1ceb['checkRepoInAuthorisedList']['called'])['to']['be'][_0x4a0ab9(0x168)],expect(_0x2d1ceb[_0x4a0ab9(0x169)][_0x4a0ab9(0x178)])['to']['be']['false'],_0x20dd1d[_0x4a0ab9(0x124)](expect,_0x319864[_0x4a0ab9(0x160)])['to']['equal'](_0x20dd1d['CbyBp']);}),it('executeChain\x20should\x20handle\x20errors\x20and\x20still\x20call\x20audit',async function(){const _0x251af8=_0x1a8090,_0x289d00={},_0x3a4a1b={'type':_0x251af8(0x181),'continue':()=>!![],'allowPush':!![]};_0x4a720d['pre'][_0x251af8(0x15c)][_0x251af8(0x14c)](_0x3a4a1b),_0x2d1ceb[_0x251af8(0x169)][_0x251af8(0x10b)](new Error(_0x251af8(0x158)));try{await _0xbc053b[_0x251af8(0x153)](_0x289d00);}catch{}expect(_0x2d1ceb[_0x251af8(0x104)][_0x251af8(0x178)])['to']['be'][_0x251af8(0x168)];}),_0x20dd1d[_0x1a8090(0x12e)](it,_0x1a8090(0x10e),async function(){const _0x2b1b56=_0x1a8090,_0x14c6be={},_0x49c075={'type':_0x20dd1d['KzeQn'],'continue':()=>!![],'allowPush':!![]};_0x4a720d[_0x2b1b56(0x185)][_0x2b1b56(0x15c)]['resolves'](_0x49c075);const _0x1bf15a=await _0xbc053b['executeChain'](_0x14c6be);expect(_0x2d1ceb[_0x2b1b56(0x13f)][_0x2b1b56(0x178)])['to']['be'][_0x2b1b56(0x146)],_0x20dd1d[_0x2b1b56(0x114)](expect,_0x2d1ceb['parsePush'][_0x2b1b56(0x178)])['to']['be']['false'],expect(_0x1bf15a)['to'][_0x2b1b56(0x112)]['equal'](_0x49c075);}),_0x20dd1d[_0x1a8090(0x13d)](it,_0x20dd1d[_0x1a8090(0x157)],async function(){const _0x14a453=_0x1a8090,_0x3eaf9d={},_0x5db374={'type':_0x20dd1d[_0x14a453(0x119)],'continue':()=>!![],'allowPush':![],'setAutoApproval':sinon[_0x14a453(0x11b)](),'repoName':_0x14a453(0x130),'commitTo':_0x14a453(0x10c)};mockPreProcessors[_0x14a453(0x15c)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb['parsePush'][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x13f)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x16f)]['resolves'](_0x5db374),_0x2d1ceb[_0x14a453(0x106)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x14b)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb['checkIfWaitingAuth'][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x174)]['resolves'](_0x5db374),_0x2d1ceb[_0x14a453(0x127)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x170)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x123)]['resolves']({..._0x5db374,'steps':[{'error':![],'logs':[_0x14a453(0x101)]}],'allowPush':!![],'autoApproved':!![]}),_0x2d1ceb[_0x14a453(0x173)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb['gitleaks'][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x140)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x182)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb[_0x14a453(0x147)][_0x14a453(0x14c)](_0x5db374),_0x2d1ceb['getMissingData'][_0x14a453(0x14c)](_0x5db374);const _0x50ba3a=sinon[_0x14a453(0x11b)](db,_0x14a453(0x118))[_0x14a453(0x14c)](!![]),_0x558bf8=await _0xbc053b[_0x14a453(0x153)](_0x3eaf9d);expect(_0x558bf8['type'])['to'][_0x14a453(0x129)](_0x20dd1d[_0x14a453(0x119)]),_0x20dd1d[_0x14a453(0x150)](expect,_0x558bf8['allowPush'])['to']['be'][_0x14a453(0x168)],expect(_0x558bf8[_0x14a453(0x10d)])['to']['be']['a'](_0x20dd1d['PvEjk']),_0x20dd1d['fDvzC'](expect,_0x50ba3a['calledOnce'])['to']['be'][_0x14a453(0x168)],_0x50ba3a[_0x14a453(0x149)]();}),_0x20dd1d[_0x1a8090(0x167)](it,_0x20dd1d[_0x1a8090(0x12c)],async function(){const _0x51cd2e=_0x1a8090,_0x27caa1={},_0x43a7dc={'type':_0x20dd1d[_0x51cd2e(0x119)],'continue':()=>!![],'allowPush':![],'setAutoRejection':sinon['stub'](),'repoName':'test-repo','commitTo':_0x20dd1d[_0x51cd2e(0x143)]};mockPreProcessors[_0x51cd2e(0x15c)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x169)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x13f)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x16f)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x106)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb['checkUserPushPermission'][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb['checkIfWaitingAuth'][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb['pullRemote'][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x127)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb['checkHiddenCommits'][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x123)]['resolves']({..._0x43a7dc,'steps':[{'error':![],'logs':[_0x20dd1d['LhXPS']]}],'allowPush':!![],'autoRejected':!![]}),_0x2d1ceb['getDiff']['resolves'](_0x43a7dc),_0x2d1ceb['gitleaks'][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x140)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x182)]['resolves'](_0x43a7dc),_0x2d1ceb[_0x51cd2e(0x147)][_0x51cd2e(0x14c)](_0x43a7dc),_0x2d1ceb['getMissingData'][_0x51cd2e(0x14c)](_0x43a7dc);const _0x56b9e8=sinon['stub'](db,_0x20dd1d[_0x51cd2e(0x164)])['resolves'](!![]),_0x2d1131=await _0xbc053b['executeChain'](_0x27caa1);expect(_0x2d1131[_0x51cd2e(0x160)])['to']['equal'](_0x51cd2e(0x181)),_0x20dd1d[_0x51cd2e(0x107)](expect,_0x2d1131[_0x51cd2e(0x184)])['to']['be'][_0x51cd2e(0x168)],expect(_0x2d1131[_0x51cd2e(0x10d)])['to']['be']['a']('function'),_0x20dd1d['CxxLe'](expect,_0x56b9e8[_0x51cd2e(0x13c)])['to']['be'][_0x51cd2e(0x168)],_0x56b9e8['restore']();}),_0x20dd1d[_0x1a8090(0x159)](it,_0x20dd1d['rZzbo'],async function(){const _0x8e4db5=_0x1a8090,_0x23ba7b={},_0x2bfe61={'type':_0x8e4db5(0x181),'continue':()=>!![],'allowPush':![],'setAutoApproval':sinon['stub'](),'repoName':_0x8e4db5(0x130),'commitTo':_0x20dd1d[_0x8e4db5(0x143)]};mockPreProcessors[_0x8e4db5(0x15c)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x169)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x13f)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x16f)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x106)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb['checkUserPushPermission'][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb['checkIfWaitingAuth'][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb['pullRemote'][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb['writePack'][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x170)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x123)][_0x8e4db5(0x14c)]({..._0x2bfe61,'steps':[{'error':![],'logs':[_0x8e4db5(0x101)]}],'allowPush':!![],'autoApproved':!![]}),_0x2d1ceb[_0x8e4db5(0x173)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x117)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb['clearBareClone'][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x182)][_0x8e4db5(0x14c)](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x147)]['resolves'](_0x2bfe61),_0x2d1ceb[_0x8e4db5(0x14e)][_0x8e4db5(0x14c)](_0x2bfe61);const _0x1e76b9=new Error(_0x20dd1d['avmOM']),_0x2124ec=sinon[_0x8e4db5(0x11b)](console,_0x20dd1d[_0x8e4db5(0x17f)]);sinon[_0x8e4db5(0x11b)](db,_0x20dd1d[_0x8e4db5(0x17e)])[_0x8e4db5(0x10b)](_0x1e76b9),await _0xbc053b[_0x8e4db5(0x153)](_0x23ba7b),_0x20dd1d[_0x8e4db5(0x16a)](expect,_0x2124ec[_0x8e4db5(0x17d)](_0x8e4db5(0x166),_0x1e76b9[_0x8e4db5(0x16c)]))['to']['be'][_0x8e4db5(0x168)],db['authorise'][_0x8e4db5(0x149)](),_0x2124ec[_0x8e4db5(0x149)]();}),_0x20dd1d[_0x1a8090(0x159)](it,_0x20dd1d[_0x1a8090(0x138)],async function(){const _0x4e7053=_0x1a8090,_0x31d3f2={},_0x2a6743={'type':_0x4e7053(0x181),'continue':()=>!![],'allowPush':![],'setAutoRejection':sinon[_0x4e7053(0x11b)](),'repoName':_0x4e7053(0x130),'commitTo':_0x4e7053(0x10c),'autoRejected':!![]};mockPreProcessors[_0x4e7053(0x15c)]['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x169)]['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x13f)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb['checkCommitMessages'][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x106)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x14b)]['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x12a)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb['pullRemote'][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb['writePack']['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x170)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x123)][_0x4e7053(0x14c)]({..._0x2a6743,'steps':[{'error':![],'logs':[_0x4e7053(0x126)]}],'allowPush':![],'autoRejected':!![]}),_0x2d1ceb[_0x4e7053(0x173)]['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x117)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x140)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x182)][_0x4e7053(0x14c)](_0x2a6743),_0x2d1ceb[_0x4e7053(0x147)]['resolves'](_0x2a6743),_0x2d1ceb[_0x4e7053(0x14e)][_0x4e7053(0x14c)](_0x2a6743);const _0x548f00=new Error(_0x20dd1d[_0x4e7053(0x17b)]),_0x8f7cae=sinon['stub'](console,_0x4e7053(0x16b));sinon[_0x4e7053(0x11b)](db,_0x20dd1d[_0x4e7053(0x164)])[_0x4e7053(0x10b)](_0x548f00),await _0xbc053b['executeChain'](_0x31d3f2),expect(_0x8f7cae[_0x4e7053(0x17d)](_0x20dd1d[_0x4e7053(0x134)],_0x548f00[_0x4e7053(0x16c)]))['to']['be']['true'],db['reject'][_0x4e7053(0x149)](),_0x8f7cae[_0x4e7053(0x149)]();});});