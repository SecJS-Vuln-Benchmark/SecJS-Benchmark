const _0x2bafca=_0x175c;(function(_0xf45809,_0x3b6ed9){const _0xe51098=_0x175c,_0x139b3c=_0xf45809();while(!![]){try{const _0xef8199=parseInt(_0xe51098(0x169))/0x1*(-parseInt(_0xe51098(0x1a6))/0x2)+parseInt(_0xe51098(0x1d1))/0x3*(-parseInt(_0xe51098(0x1d0))/0x4)+parseInt(_0xe51098(0x19a))/0x5+-parseInt(_0xe51098(0x19d))/0x6+parseInt(_0xe51098(0x1e8))/0x7*(-parseInt(_0xe51098(0x16d))/0x8)+parseInt(_0xe51098(0x168))/0x9+parseInt(_0xe51098(0x196))/0xa;if(_0xef8199===_0x3b6ed9)break;else _0x139b3c['push'](_0x139b3c['shift']());}catch(_0x24ab81){_0x139b3c['push'](_0x139b3c['shift']());}}}(_0x480d,0xea44e));const debug=require(_0x2bafca(0x17b))(_0x2bafca(0x1d9)),fs=require('fs-extra'),path=require(_0x2bafca(0x1bf)),newNow=require(_0x2bafca(0x17d)),format=require(_0x2bafca(0x180)),{Writable}=require(_0x2bafca(0x199)),fileNameFormatter=require('./fileNameFormatter'),fileNameParser=require(_0x2bafca(0x17c)),moveAndMaybeCompressFile=require('./moveAndMaybeCompressFile');class RollingFileWriteStream extends Writable{constructor(_0xc8e119,_0x21fbc9){const _0x5b2370=_0x2bafca,_0x475904={'Mxcuu':_0x5b2370(0x1d6),'MBHUE':_0x5b2370(0x1ca),'aBpfm':function(_0x426298,_0x3743e4){return _0x426298(_0x3743e4);},'jpISy':function(_0x210dc7){return _0x210dc7();},'Jfpwx':function(_0x1dddce,_0x4cb80d){return _0x1dddce===_0x4cb80d;},'CuVUP':function(_0x13fa91,_0x42e841){return _0x13fa91(_0x42e841);}},_0xf80373=_0x475904[_0x5b2370(0x1a0)]['split']('|');let _0x1250ac=0x0;while(!![]){switch(_0xf80373[_0x1250ac++]){case'0':['a','a+','as',_0x475904[_0x5b2370(0x174)]][_0x5b2370(0x1da)](this[_0x5b2370(0x185)][_0x5b2370(0x1cc)])&&this[_0x5b2370(0x19b)]();continue;case'1':this[_0x5b2370(0x17a)]=_0x475904['aBpfm'](fileNameFormatter,{'file':this[_0x5b2370(0x1e0)],'alwaysIncludeDate':this[_0x5b2370(0x185)][_0x5b2370(0x190)],'needsIndex':this['options'][_0x5b2370(0x1ec)]<Number[_0x5b2370(0x1ce)],'compress':this[_0x5b2370(0x185)][_0x5b2370(0x18c)],'keepFileExt':this[_0x5b2370(0x185)][_0x5b2370(0x18a)],'fileNameSep':this[_0x5b2370(0x185)]['fileNameSep']});continue;case'2':this[_0x5b2370(0x185)][_0x5b2370(0x1c1)]&&(this[_0x5b2370(0x175)]['currentDate']=format(this[_0x5b2370(0x185)][_0x5b2370(0x1c1)],_0x475904[_0x5b2370(0x170)](newNow)));continue;case'3':_0x475904['Jfpwx'](this[_0x5b2370(0x1e0)][_0x5b2370(0x167)],'')&&(this[_0x5b2370(0x1e0)]=path[_0x5b2370(0x1db)](path[_0x5b2370(0x1d4)](process[_0x5b2370(0x1b9)](),_0xc8e119)));continue;case'4':this[_0x5b2370(0x16c)]();continue;case'5':debug(_0x5b2370(0x1a9)+_0xc8e119);continue;case'6':this[_0x5b2370(0x1b8)]=this[_0x5b2370(0x17a)]({'index':0x0,'date':this[_0x5b2370(0x175)]['currentDate']});continue;case'7':this[_0x5b2370(0x175)]={'currentSize':0x0};continue;case'8':super(_0x21fbc9);continue;case'9':_0x475904[_0x5b2370(0x1c5)](debug,'constructor:\x20create\x20new\x20file\x20'+this[_0x5b2370(0x1b8)]+_0x5b2370(0x1b7)+JSON['stringify'](this[_0x5b2370(0x175)]));continue;case'10':this[_0x5b2370(0x1d8)]=fileNameParser({'file':this[_0x5b2370(0x1e0)],'keepFileExt':this[_0x5b2370(0x185)][_0x5b2370(0x18a)],'pattern':this[_0x5b2370(0x185)]['pattern'],'fileNameSep':this['options'][_0x5b2370(0x171)]});continue;case'11':this['options']=this[_0x5b2370(0x1cb)](_0x21fbc9);continue;case'12':this[_0x5b2370(0x1e0)]=path['parse'](_0xc8e119);continue;}break;}}[_0x2bafca(0x19b)](){const _0x1bf497=_0x2bafca;try{const _0x4c2a8c=fs[_0x1bf497(0x1e5)](this['filename']);this[_0x1bf497(0x175)]['currentSize']=_0x4c2a8c[_0x1bf497(0x183)],this[_0x1bf497(0x185)]['pattern']&&(this[_0x1bf497(0x175)]['currentDate']=format(this[_0x1bf497(0x185)][_0x1bf497(0x1c1)],_0x4c2a8c[_0x1bf497(0x1e1)]));}catch(_0x95d28a){return;}}[_0x2bafca(0x1cb)](_0x1d8b3f){const _0x12e144=_0x2bafca,_0x38908d={'mUoaf':'error','MjWpW':_0x12e144(0x1b1),'yvZZo':function(_0x1793f6,_0x3cc574){return _0x1793f6<=_0x3cc574;},'jZPcy':function(_0x3f681e,_0x3b39b4){return _0x3f681e===_0x3b39b4;},'HgopZ':function(_0x4b144e,_0x35b39b){return _0x4b144e<_0x35b39b;},'JQgqs':_0x12e144(0x198),'JdAAO':function(_0x5092b6,_0x4731ad){return _0x5092b6>=_0x4731ad;},'JCIjV':function(_0x452a2a,_0x592c6a){return _0x452a2a(_0x592c6a);}},_0x2882f1={'maxSize':Number[_0x12e144(0x1ce)],'numToKeep':Number['MAX_SAFE_INTEGER'],'encoding':'utf8','mode':parseInt(_0x38908d[_0x12e144(0x1b5)],0x8),'flags':'a','compress':![],'keepFileExt':![],'alwaysIncludePattern':![]},_0x39c9a8=Object[_0x12e144(0x1dd)]({},_0x2882f1,_0x1d8b3f);if(_0x38908d['yvZZo'](_0x39c9a8[_0x12e144(0x1ec)],0x0))throw new Error(_0x12e144(0x1c2)+_0x39c9a8[_0x12e144(0x1ec)]+_0x12e144(0x1b4));if(_0x39c9a8[_0x12e144(0x16a)]||_0x38908d[_0x12e144(0x1b0)](_0x39c9a8[_0x12e144(0x16a)],0x0)){if(_0x38908d[_0x12e144(0x173)](_0x39c9a8[_0x12e144(0x16a)],0x0)){if(_0x38908d[_0x12e144(0x1b0)](_0x12e144(0x198),_0x38908d['JQgqs']))throw new Error(_0x12e144(0x1a1)+_0x39c9a8[_0x12e144(0x16a)]+')\x20should\x20be\x20>=\x200');else this['emit'](_0x38908d[_0x12e144(0x192)],_0x48ecc0);}else{if(_0x38908d[_0x12e144(0x1cd)](_0x39c9a8[_0x12e144(0x16a)],Number[_0x12e144(0x1ce)]))throw new Error('options.numBackups\x20('+_0x39c9a8[_0x12e144(0x16a)]+_0x12e144(0x1e6));else{if(_0x38908d[_0x12e144(0x1b0)](_0x12e144(0x1df),_0x12e144(0x1c8)))return this[_0x12e144(0x175)]['currentDate']&&this[_0x12e144(0x175)][_0x12e144(0x1b3)]!==_0xb5cfbe(this[_0x12e144(0x185)]['pattern'],_0x5baefe());else _0x39c9a8[_0x12e144(0x184)]=_0x39c9a8[_0x12e144(0x16a)]+0x1;}}}else{if(_0x39c9a8['numToKeep']<=0x0)throw new Error(_0x12e144(0x17e)+_0x39c9a8['numToKeep']+')\x20should\x20be\x20>\x200');}return _0x38908d[_0x12e144(0x1d2)](debug,_0x12e144(0x195)+JSON[_0x12e144(0x1dc)](_0x39c9a8)),_0x39c9a8;}[_0x2bafca(0x1c4)](_0x138420){const _0x8065d6=_0x2bafca;this[_0x8065d6(0x1ad)][_0x8065d6(0x186)]('',this[_0x8065d6(0x185)]['encoding'],_0x138420);}[_0x2bafca(0x16b)](_0x27a7b5,_0x59a2af,_0x828a6d){const _0x2d6c40=_0x2bafca,_0x315e2f={'UYvjE':function(_0x4f6294,_0x2c4e26){return _0x4f6294(_0x2c4e26);},'siNlP':function(_0x40d28e,_0x177c29){return _0x40d28e+_0x177c29;}};this[_0x2d6c40(0x1be)]()['then'](()=>{const _0x5a0e81=_0x2d6c40,_0x208bd7={'xAMAE':function(_0x5be430,_0x2dde3e){return _0x5be430(_0x2dde3e);}};_0x315e2f['UYvjE'](debug,_0x315e2f[_0x5a0e81(0x18b)](_0x315e2f['siNlP'](_0x5a0e81(0x1bb)+(_0x5a0e81(0x1ba)+this['currentFileStream'][_0x5a0e81(0x1bf)]+'\x20'),_0x5a0e81(0x1eb)+JSON['stringify'](this[_0x5a0e81(0x175)])+'\x20'),_0x5a0e81(0x1a3)+_0x27a7b5)),this['currentFileStream'][_0x5a0e81(0x1c9)](_0x27a7b5,_0x59a2af,_0x11feb8=>{const _0x3cc97e=_0x5a0e81;this[_0x3cc97e(0x175)][_0x3cc97e(0x18e)]+=_0x27a7b5[_0x3cc97e(0x1ac)],_0x208bd7[_0x3cc97e(0x1bc)](_0x828a6d,_0x11feb8);});});}async[_0x2bafca(0x1be)](){const _0x553e1b=_0x2bafca,_0x1566d4={'KRFKK':_0x553e1b(0x1e7),'DpsmZ':function(_0x199b6c,_0x4940d6){return _0x199b6c(_0x4940d6);}};(this['_dateChanged']()||this[_0x553e1b(0x17f)]())&&('lTsRA'!==_0x1566d4[_0x553e1b(0x16e)]?this[_0x553e1b(0x1ad)][_0x553e1b(0x186)]('',this[_0x553e1b(0x185)][_0x553e1b(0x1e3)],()=>{const _0x19ceb3=_0x553e1b;this['_moveOldFiles']()[_0x19ceb3(0x1aa)](_0x49e7f0)['catch'](_0x18b223);}):(_0x1566d4[_0x553e1b(0x19f)](debug,_0x553e1b(0x19e)+this['_dateChanged']()+_0x553e1b(0x1a4)+this[_0x553e1b(0x17f)]()),await this[_0x553e1b(0x1af)]()));}[_0x2bafca(0x172)](){const _0x826d2f=_0x2bafca,_0x557935={'mSpCR':function(_0x5f266f,_0x53eb75){return _0x5f266f!==_0x53eb75;},'bqKkl':function(_0x417c3a,_0xeba75e,_0x1e298f){return _0x417c3a(_0xeba75e,_0x1e298f);}};return this[_0x826d2f(0x175)][_0x826d2f(0x1b3)]&&_0x557935[_0x826d2f(0x1d7)](this[_0x826d2f(0x175)][_0x826d2f(0x1b3)],_0x557935['bqKkl'](format,this['options'][_0x826d2f(0x1c1)],newNow()));}[_0x2bafca(0x17f)](){const _0x42a3c0=_0x2bafca;return this[_0x42a3c0(0x175)][_0x42a3c0(0x18e)]>=this[_0x42a3c0(0x185)][_0x42a3c0(0x1ec)];}[_0x2bafca(0x1af)](){const _0x5104bb=_0x2bafca,_0x3996ae={'qEypc':function(_0x48276f,_0x40aa58){return _0x48276f!==_0x40aa58;},'kwFWJ':function(_0x3c995e,_0x2c64ca){return _0x3c995e(_0x2c64ca);}};return _0x3996ae[_0x5104bb(0x1c3)](debug,_0x5104bb(0x194)),new Promise((_0x5f26ae,_0x409b84)=>{const _0x2489e9=_0x5104bb,_0x2b2d29={'okyIE':function(_0x302082,_0x1f7e3c){return _0x3996ae['qEypc'](_0x302082,_0x1f7e3c);}};this[_0x2489e9(0x1ad)][_0x2489e9(0x186)]('',this['options']['encoding'],()=>{const _0x15f602=_0x2489e9,_0x40580d={'AuJtH':function(_0x39e077,_0x56e29d){return _0x39e077(_0x56e29d);}};if(_0x2b2d29[_0x15f602(0x178)](_0x15f602(0x19c),_0x15f602(0x18f)))this[_0x15f602(0x181)]()[_0x15f602(0x1aa)](_0x5f26ae)[_0x15f602(0x1a2)](_0x409b84);else return _0x40580d[_0x15f602(0x18d)](_0x17a579,'_roll:\x20closing\x20the\x20current\x20stream'),new _0x4b397c((_0x17e807,_0x2064e0)=>{const _0x541f21=_0x15f602;this['currentFileStream'][_0x541f21(0x186)]('',this[_0x541f21(0x185)][_0x541f21(0x1e3)],()=>{const _0x49a841=_0x541f21;this[_0x49a841(0x181)]()['then'](_0x17e807)[_0x49a841(0x1a2)](_0x2064e0);});});});});}async[_0x2bafca(0x181)](){const _0x5512ba=_0x2bafca,_0x2ef547={'FipcX':function(_0x3e6d9f,_0x293c07){return _0x3e6d9f>=_0x293c07;},'yKGfA':function(_0x4d08dd,_0x511c69){return _0x4d08dd+_0x511c69;},'BYCza':function(_0x3fb5a3,_0x22c5a4,_0x30a8e9){return _0x3fb5a3(_0x22c5a4,_0x30a8e9);},'MJIqK':function(_0x111cd0,_0x2d1235){return _0x111cd0(_0x2d1235);}},_0x16a825=await this[_0x5512ba(0x16f)](),_0x2e0388=this[_0x5512ba(0x175)][_0x5512ba(0x1b3)]?_0x16a825[_0x5512ba(0x1e2)](_0x55f0a0=>_0x55f0a0[_0x5512ba(0x1de)]===this[_0x5512ba(0x175)]['currentDate']):_0x16a825;for(let _0x498d63=_0x2e0388[_0x5512ba(0x1ac)];_0x2ef547[_0x5512ba(0x182)](_0x498d63,0x0);_0x498d63--){debug(_0x5512ba(0x166)+_0x498d63);const _0x56dd69=this['fileFormatter']({'date':this[_0x5512ba(0x175)][_0x5512ba(0x1b3)],'index':_0x498d63}),_0x47b7bd=this['fileFormatter']({'date':this[_0x5512ba(0x175)][_0x5512ba(0x1b3)],'index':_0x2ef547[_0x5512ba(0x1a5)](_0x498d63,0x1)}),_0x2010b8={'compress':this[_0x5512ba(0x185)][_0x5512ba(0x18c)]&&_0x498d63===0x0,'mode':this['options'][_0x5512ba(0x187)]};await moveAndMaybeCompressFile(_0x56dd69,_0x47b7bd,_0x2010b8);}this[_0x5512ba(0x175)][_0x5512ba(0x18e)]=0x0,this[_0x5512ba(0x175)]['currentDate']=this[_0x5512ba(0x175)][_0x5512ba(0x1b3)]?_0x2ef547[_0x5512ba(0x1d5)](format,this['options'][_0x5512ba(0x1c1)],newNow()):null,_0x2ef547[_0x5512ba(0x188)](debug,_0x5512ba(0x1e9)+JSON[_0x5512ba(0x1dc)](this[_0x5512ba(0x175)])),this[_0x5512ba(0x16c)](),await new Promise((_0xd66d08,_0x34617a)=>{const _0x2fc5a9=_0x5512ba;this[_0x2fc5a9(0x1ad)][_0x2fc5a9(0x1c9)]('',_0x2fc5a9(0x193),()=>{const _0x2a83fb=_0x2fc5a9;this[_0x2a83fb(0x176)]()[_0x2a83fb(0x1aa)](_0xd66d08)['catch'](_0x34617a);});});}async[_0x2bafca(0x16f)](){const _0x2b68a6=_0x2bafca,_0x3fee3a={'cjnlw':function(_0x28d441,_0x14ea31){return _0x28d441(_0x14ea31);}},_0x3f7eb5=await fs[_0x2b68a6(0x1ea)](this['fileObject'][_0x2b68a6(0x167)])[_0x2b68a6(0x1a2)](()=>[]);_0x3fee3a[_0x2b68a6(0x189)](debug,'_getExistingFiles:\x20files='+_0x3f7eb5);const _0x542dc9=_0x3f7eb5[_0x2b68a6(0x1b6)](_0x74eae7=>this[_0x2b68a6(0x1d8)](_0x74eae7))[_0x2b68a6(0x1e2)](_0x3185bb=>_0x3185bb),_0x40f7c9=_0x551c8d=>(_0x551c8d[_0x2b68a6(0x1c0)]?_0x551c8d[_0x2b68a6(0x1c0)]:newNow()[_0x2b68a6(0x1d3)]())-_0x551c8d[_0x2b68a6(0x177)];return _0x542dc9['sort']((_0x15d533,_0x22234d)=>_0x40f7c9(_0x15d533)-_0x40f7c9(_0x22234d)),_0x542dc9;}[_0x2bafca(0x16c)](){const _0x5fe6ad=_0x2bafca,_0x2ad04c={'XSbjP':_0x5fe6ad(0x1bd),'MldoM':_0x5fe6ad(0x1e4)};fs[_0x5fe6ad(0x179)](this['fileObject'][_0x5fe6ad(0x167)]);const _0x24cb2c=this[_0x5fe6ad(0x17a)]({'date':this[_0x5fe6ad(0x175)][_0x5fe6ad(0x1b3)],'index':0x0}),_0x5ae481={'flags':this[_0x5fe6ad(0x185)][_0x5fe6ad(0x1cc)],'encoding':this['options'][_0x5fe6ad(0x1e3)],'mode':this['options'][_0x5fe6ad(0x187)]};this[_0x5fe6ad(0x1ad)]=fs[_0x5fe6ad(0x1c6)](_0x24cb2c,_0x5ae481),this['currentFileStream']['on'](_0x2ad04c[_0x5fe6ad(0x191)],_0x5f803=>{const _0x3d3965=_0x5fe6ad;if(_0x3d3965(0x1bd)===_0x2ad04c['XSbjP'])this['emit'](_0x2ad04c['MldoM'],_0x5f803);else return;});}async[_0x2bafca(0x176)](){const _0x437615=_0x2bafca,_0x2b3639=await this['_getExistingFiles']();debug(_0x437615(0x1ab)+this[_0x437615(0x185)]['numToKeep']+',\x20existingFiles\x20=\x20'+_0x2b3639[_0x437615(0x1ac)]),debug(_0x437615(0x197),_0x2b3639);if(this['_tooManyFiles'](_0x2b3639[_0x437615(0x1ac)])){const _0x4d46d3=_0x2b3639[_0x437615(0x1cf)](0x0,_0x2b3639['length']-this[_0x437615(0x185)]['numToKeep'])[_0x437615(0x1b6)](_0x536ba2=>path[_0x437615(0x1ed)]({'dir':this[_0x437615(0x1e0)][_0x437615(0x167)],'base':_0x536ba2['filename']}));await deleteFiles(_0x4d46d3);}}[_0x2bafca(0x1b2)](_0x19e3b4){const _0x2a0563=_0x2bafca;return this['options']['numToKeep']>0x0&&_0x19e3b4>this[_0x2a0563(0x185)][_0x2a0563(0x184)];}}const deleteFiles=_0x2a8a7b=>{const _0x3a495f=_0x2bafca,_0x228d97={'jYhYU':function(_0x11f3f0,_0x287554){return _0x11f3f0(_0x287554);}};return _0x228d97[_0x3a495f(0x1c7)](debug,_0x3a495f(0x1ae)+_0x2a8a7b),Promise['all'](_0x2a8a7b[_0x3a495f(0x1b6)](_0x51d1c8=>fs[_0x3a495f(0x1a8)](_0x51d1c8)['catch'](_0x5b7c09=>{const _0x63c0d1=_0x3a495f;debug('deleteFiles:\x20error\x20when\x20unlinking\x20'+_0x51d1c8+_0x63c0d1(0x1a7)+_0x5b7c09);})));};function _0x480d(){const _0x1495af=['tAxiy','alwaysIncludePattern','MldoM','mUoaf','utf8','_roll:\x20closing\x20the\x20current\x20stream','_parseOption:\x20creating\x20stream\x20with\x20option=','25588630nXgIWg','_clean:\x20existing\x20files\x20are:\x20','REwjF','stream','4875435fMSiFV','_setExistingSizeAndDate','NfCgq','4211682ANNvip','_shouldRoll:\x20rolling\x20because\x20dateChanged?\x20','DpsmZ','Mxcuu','options.numBackups\x20(','catch','chunk=','\x20or\x20tooBig?\x20','yKGfA','1302086DVPpfv',',\x20ignoring.\x20Error\x20was\x20','unlink','constructor:\x20creating\x20RollingFileWriteStream.\x20path=','then','_clean:\x20numToKeep\x20=\x20','length','currentFileStream','deleteFiles:\x20files\x20to\x20delete:\x20','_roll','jZPcy','0644','_tooManyFiles','currentDate',')\x20should\x20be\x20>\x200','MjWpW','map',',\x20state=','filename','cwd','file=','_write:\x20writing\x20chunk.\x20','xAMAE','cBtzG','_shouldRoll','path','timestamp','pattern','options.maxSize\x20(','kwFWJ','_final','CuVUP','createWriteStream','jYhYU','fADRr','write','as+','_parseOption','flags','JdAAO','MAX_SAFE_INTEGER','slice','5524zFQelK','2571CsEajR','JCIjV','getTime','join','BYCza','5|8|11|12|3|1|10|7|2|6|0|9|4','mSpCR','fileNameParser','streamroller:RollingFileWriteStream','includes','parse','stringify','assign','date','XPPCI','fileObject','mtime','filter','encoding','error','statSync',')\x20should\x20be\x20<\x20Number.MAX_SAFE_INTEGER','lTsRA','7mnwZuR','_moveOldFiles:\x20finished\x20rolling\x20files.\x20state=','readdir','state=','maxSize','format','_moveOldFiles:\x20i\x20=\x20','dir','5449194oJYZez','1vExZFD','numBackups','_write','_renewWriteStream','5146744oipMTK','KRFKK','_getExistingFiles','jpISy','fileNameSep','_dateChanged','HgopZ','MBHUE','state','_clean','index','okyIE','ensureDirSync','fileFormatter','debug','./fileNameParser','./now','options.numToKeep\x20(','_tooBig','date-format','_moveOldFiles','FipcX','size','numToKeep','options','end','mode','MJIqK','cjnlw','keepFileExt','siNlP','compress','AuJtH','currentSize'];_0x480d=function(){return _0x1495af;};return _0x480d();}function _0x175c(_0x183cc2,_0x1c44ba){const _0x480d46=_0x480d();return _0x175c=function(_0x175ce4,_0x38592c){_0x175ce4=_0x175ce4-0x166;let _0x714a20=_0x480d46[_0x175ce4];return _0x714a20;},_0x175c(_0x183cc2,_0x1c44ba);}module['exports']=RollingFileWriteStream;