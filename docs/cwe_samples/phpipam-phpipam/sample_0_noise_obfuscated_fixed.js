const _0x4e408b=_0x4c58;(function(_0x13da2c,_0x2ed7c0){const _0x3090c6=_0x4c58,_0x1676f7=_0x13da2c();while(!![]){try{const _0x1d5f88=-parseInt(_0x3090c6(0x17b))/0x1+parseInt(_0x3090c6(0x186))/0x2+-parseInt(_0x3090c6(0x14f))/0x3+parseInt(_0x3090c6(0x136))/0x4*(parseInt(_0x3090c6(0x145))/0x5)+parseInt(_0x3090c6(0x193))/0x6+-parseInt(_0x3090c6(0x163))/0x7+-parseInt(_0x3090c6(0x17c))/0x8*(-parseInt(_0x3090c6(0x16f))/0x9);if(_0x1d5f88===_0x2ed7c0)break;else _0x1676f7['push'](_0x1676f7['shift']());}catch(_0x206aea){_0x1676f7['push'](_0x1676f7['shift']());}}}(_0x3269,0x630f8));const ldap=require('../lib/Adapters/Auth/ldap'),mockLdapServer=require('./MockLdapServer'),fs=require('fs'),port=0x3039,sslport=0x303a;function _0x4c58(_0x5220f2,_0x21f011){const _0x3269bd=_0x3269();return _0x4c58=function(_0x4c5834,_0x4b0a5){_0x4c5834=_0x4c5834-0x110;let _0x3a089e=_0x3269bd[_0x4c5834];return _0x3a089e;},_0x4c58(_0x5220f2,_0x21f011);}function _0x3269(){const _0x8a23d8=['zGSQS','GWMgy','uid={{id}},\x20o=example','qowtL','rSHiC','LDAPS:\x20Certificate\x20mismatch','joOTY','catch','LDAP:\x20Wrong\x20username\x20or\x20password','ldap','CWoxo','wyaZY','testpw','o=invalid','ioMrd','Should\x20fail\x20with\x20missing\x20options','nwWwm','Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20certifcate\x20matches\x20but\x20credentials\x20are\x20wrong','LQxDY','(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','jttZY','hyIbv','Should\x20succeed\x20if\x20user\x20is\x20in\x20given\x20group','Artwo','TjRMP','TUDzo','secret','adfOk','4iLabqx','CDKpk','Should\x20delete\x20the\x20password\x20from\x20authData\x20after\x20validation','LDAP\x20group\x20search\x20failed','QnIpD','Should\x20return\x20a\x20resolved\x20promise\x20when\x20validating\x20the\x20app\x20id','Should\x20fail\x20with\x20wrong\x20credentials','caogf','ASiLz','Ttcge','BPdsN','TtFwJ','nDGqX','uid=testuser,\x20o=example','JkHOo','2431305zoJRAZ','o=example','authData','Should\x20succeed\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20the\x20expected\x20certificate','ywdcc','oqfsk','bxcHa','IZrkY','Query','toBeUndefined','1881963YhThEs','hTXWg','IosCO','Should\x20succeed\x20with\x20right\x20credentials\x20when\x20LDAPS\x20is\x20used\x20and\x20certifcate\x20is\x20not\x20checked','get','AGlZj','YRoCw','toEqual','fail','pQDmg','djSag','qQjqT','qjLZj','UEbMm','password','rubtb','NKxca','LaHJb','ldap://localhost:','fVOzv','2419886hapSCY','DxOml','Should\x20succeed\x20with\x20right\x20credentials','kiPRE','Should\x20fail\x20if\x20the\x20LDAP\x20server\x20encounters\x20an\x20error\x20while\x20searching','fExWV','QCzet','validateAuthData','mwEFK','close','ZqwdJ','dArnS','665505VTTaao','oGpll','bIpHf','LDAP:\x20User\x20not\x20in\x20group','message','wIOkq','bpzlx','SFMnK','cPkwO','then','readFileSync','aWBXc','419959DQbVyL','80QnBAhp','ltsyx','dulLv','Should\x20not\x20save\x20the\x20password\x20in\x20the\x20user\x20record\x20after\x20authentication','jrWUA','CLgzl','ERydf','VCDTW','LDAP\x20auth\x20configuration\x20missing','NAXOh','250922bKcKno','KtlPM','ygQKL','ApSwr','/support/cert/cert.pem','PnUTt','YTAEc','ILIXy','powerusers','RYOde','tQFBD','xhoPh','NwWRA','2685348jSgYWy','ldaps://localhost:','Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20not\x20the\x20expected\x20certificate','iIhcE','QrSPl','JiESy','stSaF','emEeK','guQlh','tqCCs','yfxIZ','bfGmt','mAwuU','testuser','Should\x20fail\x20if\x20the\x20LDAP\x20server\x20does\x20not\x20allow\x20searching\x20inside\x20the\x20provided\x20suffix','GOkxr','logInWith','/support/cert/anothercert.pem','JKAul','VBOPq','wrong!','finally','User','BEUce'];_0x3269=function(){return _0x8a23d8;};return _0x3269();}it(_0x4e408b(0x129),_0x116ba6=>{const _0x2d77fb=_0x4e408b,_0x212e3c={'nwWwm':_0x2d77fb(0x184),'lljKm':function(_0x160002){return _0x160002();},'ioMrd':_0x2d77fb(0x1a0)};ldap[_0x2d77fb(0x16a)]({'id':_0x212e3c[_0x2d77fb(0x128)],'password':_0x2d77fb(0x126)})[_0x2d77fb(0x178)](_0x116ba6[_0x2d77fb(0x157)])['catch'](_0x529063=>{const _0xf7314f=_0x2d77fb;jequal(_0x529063[_0xf7314f(0x173)],_0x212e3c[_0xf7314f(0x12a)]),_0x212e3c['lljKm'](_0x116ba6);});}),Function('return\x20Object.keys({a:1});')(),it(_0x4e408b(0x13b),_0x148f7e=>{const _0x26fc62=_0x4e408b;ldap['validateAppId']()[_0x26fc62(0x178)](_0x148f7e)[_0x26fc62(0x121)](_0x148f7e[_0x26fc62(0x157)]);}),it(_0x4e408b(0x165),_0x5832b5=>{const _0x380582=_0x4e408b,_0x37d28b={'JiESy':_0x380582(0x11c),'stSaF':_0x380582(0x134),'SbjxG':_0x380582(0x143)};mockLdapServer(port,_0x37d28b['SbjxG'])[_0x380582(0x178)](_0x3bcf93=>{const _0x392932=_0x380582,_0x1fb8c7={'suffix':_0x392932(0x146),'url':_0x392932(0x161)+port,'dn':_0x37d28b[_0x392932(0x198)]};ldap[_0x392932(0x16a)]({'id':'testuser','password':_0x37d28b[_0x392932(0x199)]},_0x1fb8c7)['then'](_0x5832b5)[_0x392932(0x121)](_0x5832b5['fail'])[_0x392932(0x117)](()=>_0x3bcf93['close']());});}),it(_0x4e408b(0x152),_0x20100d=>{const _0x7cd408=_0x4e408b,_0x18de30={'HeYXf':'o=example','Artwo':'uid={{id}},\x20o=example','pQDmg':function(_0x230be1,_0x40e242,_0x138d52,_0x485a91,_0x23c02b){return _0x230be1(_0x40e242,_0x138d52,_0x485a91,_0x23c02b);},'aWBXc':_0x7cd408(0x143)};_0x18de30[_0x7cd408(0x158)](mockLdapServer,sslport,_0x18de30[_0x7cd408(0x17a)],![],!![])['then'](_0x4c174e=>{const _0x513589=_0x7cd408,_0x421ff6={'suffix':_0x18de30['HeYXf'],'url':_0x513589(0x194)+sslport,'dn':_0x18de30[_0x513589(0x131)],'tlsOptions':{'rejectUnauthorized':![]}};ldap[_0x513589(0x16a)]({'id':_0x513589(0x1a0),'password':_0x513589(0x134)},_0x421ff6)[_0x513589(0x178)](_0x20100d)['catch'](_0x20100d[_0x513589(0x157)])['finally'](()=>_0x4c174e['close']());});}),it(_0x4e408b(0x148),_0x4820ba=>{const _0x204d07=_0x4e408b,_0x529a5f={'guQlh':_0x204d07(0x146),'iIhcE':'uid={{id}},\x20o=example','rubtb':_0x204d07(0x1a0),'jttZY':function(_0x2e8895,_0x3f528d,_0x1c0587,_0x4838b6,_0x36388f){return _0x2e8895(_0x3f528d,_0x1c0587,_0x4838b6,_0x36388f);},'RYOde':_0x204d07(0x143)};_0x529a5f[_0x204d07(0x12e)](mockLdapServer,sslport,_0x529a5f[_0x204d07(0x18f)],![],!![])['then'](_0x5973c5=>{const _0x3bc09d=_0x204d07,_0x2ca84d={'suffix':_0x529a5f[_0x3bc09d(0x19b)],'url':_0x3bc09d(0x194)+sslport,'dn':_0x529a5f[_0x3bc09d(0x196)],'tlsOptions':{'ca':fs[_0x3bc09d(0x179)](__dirname+_0x3bc09d(0x18a)),'rejectUnauthorized':!![]}};ldap['validateAuthData']({'id':_0x529a5f[_0x3bc09d(0x15e)],'password':_0x3bc09d(0x134)},_0x2ca84d)[_0x3bc09d(0x178)](_0x4820ba)[_0x3bc09d(0x121)](_0x4820ba['fail'])[_0x3bc09d(0x117)](()=>_0x5973c5[_0x3bc09d(0x16c)]());});}),it(_0x4e408b(0x195),_0xa629bf=>{const _0x523b57=_0x4e408b,_0x138577={'QrSPl':_0x523b57(0x11f),'TjRMP':function(_0x2e9215,_0x517647){return _0x2e9215+_0x517647;},'QnIpD':_0x523b57(0x134),'JpNKz':function(_0x271d70,_0xa0c501,_0x394232,_0x245453,_0x41b788){return _0x271d70(_0xa0c501,_0x394232,_0x245453,_0x41b788);},'IosCO':function(_0x52237d,_0x33b8cc){return _0x52237d===_0x33b8cc;},'ZqwdJ':_0x523b57(0x111),'tqCCs':'o=example','uhwrV':_0x523b57(0x113),'YRoCw':'testuser','bxcHa':_0x523b57(0x143)};mockLdapServer(sslport,_0x138577[_0x523b57(0x14b)],![],!![])['then'](_0x2b6a65=>{const _0x37ed5e=_0x523b57,_0x2bd66c={'wyaZY':function(_0x2b2ddc,_0x6baf43){const _0x571d4f=_0x4c58;return _0x138577[_0x571d4f(0x132)](_0x2b2ddc,_0x6baf43);},'Ttcge':_0x138577['QnIpD'],'Zoohq':function(_0x5cac53,_0x558bed,_0x445f75,_0x18c313,_0x5b7102){return _0x138577['JpNKz'](_0x5cac53,_0x558bed,_0x445f75,_0x18c313,_0x5b7102);}};if(_0x138577[_0x37ed5e(0x151)]('GOkxr',_0x138577[_0x37ed5e(0x16d)])){const _0x58b43a={'suffix':_0x138577[_0x37ed5e(0x19c)],'url':_0x37ed5e(0x194)+sslport,'dn':_0x37ed5e(0x11c),'tlsOptions':{'ca':fs['readFileSync'](_0x138577[_0x37ed5e(0x132)](__dirname,_0x138577['uhwrV'])),'rejectUnauthorized':!![]}};ldap[_0x37ed5e(0x16a)]({'id':_0x138577[_0x37ed5e(0x155)],'password':_0x138577[_0x37ed5e(0x13a)]},_0x58b43a)[_0x37ed5e(0x178)](_0xa629bf['fail'])[_0x37ed5e(0x121)](_0x3ce6be=>{const _0x1d2685=_0x37ed5e;jequal(_0x3ce6be[_0x1d2685(0x173)],_0x138577[_0x1d2685(0x197)]),_0xa629bf();})[_0x37ed5e(0x117)](()=>_0x2b6a65[_0x37ed5e(0x16c)]());}else _0x2bd66c['Zoohq'](_0xd2c46e,_0x1bc3a3,_0x37ed5e(0x143),![],!![])[_0x37ed5e(0x178)](_0x1099d5=>{const _0x282e1e=_0x37ed5e,_0x9db012={'suffix':_0x282e1e(0x146),'url':_0x282e1e(0x194)+_0x426f5a,'dn':'uid={{id}},\x20o=example','tlsOptions':{'ca':_0xde0fbd[_0x282e1e(0x179)](_0x2bd66c[_0x282e1e(0x125)](_0x5edddc,'/support/cert/cert.pem')),'rejectUnauthorized':!![]}};_0x26c000[_0x282e1e(0x16a)]({'id':_0x282e1e(0x1a0),'password':_0x2bd66c[_0x282e1e(0x13f)]},_0x9db012)[_0x282e1e(0x178)](_0x24488a)[_0x282e1e(0x121)](_0x30996f[_0x282e1e(0x157)])['finally'](()=>_0x1099d5[_0x282e1e(0x16c)]());});});}),it(_0x4e408b(0x12b),_0x533fb7=>{const _0x17f43b=_0x4e408b,_0x235ebc={'ygQKL':_0x17f43b(0x122),'oqfsk':_0x17f43b(0x146),'LQxDY':'testuser','wIOkq':'uid=testuser,\x20o=example'};mockLdapServer(sslport,_0x235ebc[_0x17f43b(0x174)],![],!![])[_0x17f43b(0x178)](_0x5eb643=>{const _0x4b5165=_0x17f43b,_0x5c521b={'zxixe':_0x235ebc[_0x4b5165(0x188)]},_0x15d6f2={'suffix':_0x235ebc[_0x4b5165(0x14a)],'url':_0x4b5165(0x194)+sslport,'dn':_0x4b5165(0x11c),'tlsOptions':{'ca':fs[_0x4b5165(0x179)](__dirname+_0x4b5165(0x18a)),'rejectUnauthorized':!![]}};ldap['validateAuthData']({'id':_0x235ebc[_0x4b5165(0x12c)],'password':_0x4b5165(0x116)},_0x15d6f2)[_0x4b5165(0x178)](_0x533fb7[_0x4b5165(0x157)])[_0x4b5165(0x121)](_0x210a87=>{const _0x5139e1=_0x4b5165;jequal(_0x210a87[_0x5139e1(0x173)],_0x5c521b['zxixe']),_0x533fb7();})[_0x4b5165(0x117)](()=>_0x5eb643[_0x4b5165(0x16c)]());});}),it(_0x4e408b(0x13c),_0x5833fe=>{const _0x159e92=_0x4e408b,_0x4c6990={'TtFwJ':_0x159e92(0x143)};mockLdapServer(port,_0x4c6990[_0x159e92(0x141)])[_0x159e92(0x178)](_0x569dd8=>{const _0x21a77e=_0x159e92,_0x273323={'cPkwO':_0x21a77e(0x116),'ywdcc':_0x21a77e(0x122),'CLgzl':function(_0x1035cd){return _0x1035cd();}},_0x168b05={'suffix':_0x21a77e(0x146),'url':_0x21a77e(0x161)+port,'dn':_0x21a77e(0x11c)};ldap[_0x21a77e(0x16a)]({'id':'testuser','password':_0x21a77e(0x116)},_0x168b05)[_0x21a77e(0x178)](_0x5833fe['fail'])['catch'](_0x1dcb2a=>{const _0x5bfa25=_0x21a77e,_0x60352e={'xJFqe':_0x273323[_0x5bfa25(0x177)],'djSag':function(_0x4f23d5,_0x2fbc23,_0x12fc6f){return _0x4f23d5(_0x2fbc23,_0x12fc6f);},'emEeK':_0x273323['ywdcc'],'bIpHf':function(_0x138a23,_0x425cfc,_0x306a0e){return _0x138a23(_0x425cfc,_0x306a0e);}};if(_0x5bfa25(0x169)===_0x5bfa25(0x11d)){const _0x266c40={'iOFCW':function(_0x54e955,_0xe7322e,_0x228ff0){const _0x58d76e=_0x5bfa25;return _0x60352e[_0x58d76e(0x159)](_0x54e955,_0xe7322e,_0x228ff0);},'wycUw':_0x60352e[_0x5bfa25(0x19a)]};_0x60352e[_0x5bfa25(0x171)](_0x17e208,_0x2f581b,'uid=testuser,\x20o=example')['then'](_0x1aa91c=>{const _0x3c80b6=_0x5bfa25,_0x2d789c={'suffix':_0x3c80b6(0x146),'url':_0x3c80b6(0x161)+_0x50a878,'dn':_0x3c80b6(0x11c)};_0xa096b3[_0x3c80b6(0x16a)]({'id':'testuser','password':_0x60352e['xJFqe']},_0x2d789c)['then'](_0x473aa5[_0x3c80b6(0x157)])['catch'](_0x28be13=>{const _0x5f38f0=_0x3c80b6;_0x266c40['iOFCW'](_0x37dcf8,_0x28be13[_0x5f38f0(0x173)],_0x266c40['wycUw']),_0x4c2ee5();})['finally'](()=>_0x1aa91c[_0x3c80b6(0x16c)]());});}else jequal(_0x1dcb2a[_0x5bfa25(0x173)],_0x273323[_0x5bfa25(0x149)]),_0x273323[_0x5bfa25(0x181)](_0x5833fe);})[_0x21a77e(0x117)](()=>_0x569dd8['close']());});}),it(_0x4e408b(0x130),_0x3a07c0=>{const _0x433188=_0x4e408b,_0x496f04={'bfGmt':'o=example','adfOk':_0x433188(0x11c),'LaHJb':_0x433188(0x18e),'BEUce':_0x433188(0x1a0),'rOTNa':'secret','kiPRE':function(_0x1cd44e,_0x26b879,_0x1562a1){return _0x1cd44e(_0x26b879,_0x1562a1);},'mwEFK':_0x433188(0x143)};_0x496f04[_0x433188(0x166)](mockLdapServer,port,_0x496f04[_0x433188(0x16b)])[_0x433188(0x178)](_0xe32b45=>{const _0x37c6e3=_0x433188,_0xb82894={'suffix':_0x496f04[_0x37c6e3(0x19e)],'url':_0x37c6e3(0x161)+port,'dn':_0x496f04[_0x37c6e3(0x135)],'groupCn':_0x496f04[_0x37c6e3(0x160)],'groupFilter':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))'};ldap[_0x37c6e3(0x16a)]({'id':_0x496f04[_0x37c6e3(0x119)],'password':_0x496f04['rOTNa']},_0xb82894)[_0x37c6e3(0x178)](_0x3a07c0)[_0x37c6e3(0x121)](_0x3a07c0['fail'])['finally'](()=>_0xe32b45[_0x37c6e3(0x16c)]());});}),it('Should\x20fail\x20if\x20user\x20is\x20not\x20in\x20given\x20group',_0x19451c=>{const _0x10d4e7=_0x4e408b,_0x4c3e6b={'ApSwr':'testuser','NKxca':_0x10d4e7(0x11f),'pZvdp':function(_0x3ac458,_0xbb9db5){return _0x3ac458+_0xbb9db5;},'yfxIZ':function(_0x20fdca,_0x2e6f27){return _0x20fdca!==_0x2e6f27;},'tQFBD':_0x10d4e7(0x172),'CWoxo':function(_0x46b370,_0x10b269){return _0x46b370===_0x10b269;},'dArnS':_0x10d4e7(0x150),'fExWV':_0x10d4e7(0x134),'veyuY':function(_0x5f27c8,_0x18b21a,_0x2419ec){return _0x5f27c8(_0x18b21a,_0x2419ec);}};_0x4c3e6b['veyuY'](mockLdapServer,port,_0x10d4e7(0x143))[_0x10d4e7(0x178)](_0x14dbd8=>{const _0xc826d6=_0x10d4e7,_0x31e55c={'KtlPM':_0xc826d6(0x146),'KEfIW':_0x4c3e6b[_0xc826d6(0x189)],'PnUTt':_0x4c3e6b[_0xc826d6(0x15f)],'joOTY':function(_0x589f68,_0x216a8b){return _0x4c3e6b['pZvdp'](_0x589f68,_0x216a8b);},'BPdsN':function(_0x1ac621,_0x371fac){const _0x4f45e8=_0xc826d6;return _0x4c3e6b[_0x4f45e8(0x19d)](_0x1ac621,_0x371fac);},'GWMgy':_0x4c3e6b[_0xc826d6(0x190)]};if(_0x4c3e6b[_0xc826d6(0x124)]('YjYlJ',_0x4c3e6b[_0xc826d6(0x16e)])){const _0x216ca3={'suffix':_0x31e55c[_0xc826d6(0x187)],'url':_0xc826d6(0x194)+_0x42c89e,'dn':_0xc826d6(0x11c),'tlsOptions':{'rejectUnauthorized':![]}};_0x2644af[_0xc826d6(0x16a)]({'id':_0x31e55c['KEfIW'],'password':'secret'},_0x216ca3)['then'](_0x5067a2)[_0xc826d6(0x121)](_0x589f94[_0xc826d6(0x157)])[_0xc826d6(0x117)](()=>_0x445875[_0xc826d6(0x16c)]());}else{const _0xdbb318={'suffix':'o=example','url':_0xc826d6(0x161)+port,'dn':_0xc826d6(0x11c),'groupCn':'groupTheUserIsNotIn','groupFilter':_0xc826d6(0x12d)};ldap[_0xc826d6(0x16a)]({'id':_0x4c3e6b[_0xc826d6(0x189)],'password':_0x4c3e6b[_0xc826d6(0x168)]},_0xdbb318)[_0xc826d6(0x178)](_0x19451c['fail'])[_0xc826d6(0x121)](_0x26ba4f=>{const _0x2bac3c=_0xc826d6,_0xaa4e8f={'NWghh':_0x31e55c[_0x2bac3c(0x18b)],'SFMnK':function(_0x55c749,_0x96180d){const _0x3acf24=_0x2bac3c;return _0x31e55c[_0x3acf24(0x120)](_0x55c749,_0x96180d);},'IZrkY':_0x2bac3c(0x1a0)};if(_0x31e55c[_0x2bac3c(0x140)](_0x2bac3c(0x185),_0x2bac3c(0x185))){const _0x149520={'qQjqT':_0xaa4e8f['NWghh'],'gPfQs':function(_0x43626d){return _0x43626d();}},_0x5f518d={'suffix':'o=example','url':_0x2bac3c(0x194)+_0x5b9f3b,'dn':'uid={{id}},\x20o=example','tlsOptions':{'ca':_0x3e8b9a[_0x2bac3c(0x179)](_0xaa4e8f[_0x2bac3c(0x176)](_0x11b1a2,'/support/cert/anothercert.pem')),'rejectUnauthorized':!![]}};_0x57952b['validateAuthData']({'id':_0xaa4e8f[_0x2bac3c(0x14c)],'password':_0x2bac3c(0x134)},_0x5f518d)[_0x2bac3c(0x178)](_0x4a0553[_0x2bac3c(0x157)])[_0x2bac3c(0x121)](_0x3a6877=>{const _0x3d4705=_0x2bac3c;_0x65409a(_0x3a6877[_0x3d4705(0x173)],_0x149520[_0x3d4705(0x15a)]),_0x149520['gPfQs'](_0x1a00c6);})[_0x2bac3c(0x117)](()=>_0x1f7b21[_0x2bac3c(0x16c)]());}else jequal(_0x26ba4f[_0x2bac3c(0x173)],_0x31e55c[_0x2bac3c(0x11b)]),_0x19451c();})['finally'](()=>_0x14dbd8['close']());}});}),it(_0x4e408b(0x110),_0x2c295b=>{const _0xe1817=_0x4e408b,_0x3595a9={'hJKWN':'LDAP:\x20User\x20not\x20in\x20group','qjLZj':function(_0x5d81d6){return _0x5d81d6();},'TUDzo':function(_0x562545,_0x203013){return _0x562545!==_0x203013;},'JKAul':_0xe1817(0x164),'JaYFf':_0xe1817(0x137),'mAwuU':_0xe1817(0x127),'ASiLz':_0xe1817(0x18e),'xuQNH':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','zGSQS':_0xe1817(0x1a0)};mockLdapServer(port,'uid=testuser,\x20o=example')[_0xe1817(0x178)](_0x1b07ee=>{const _0x5c7bd2=_0xe1817;if(_0x3595a9[_0x5c7bd2(0x133)](_0x3595a9[_0x5c7bd2(0x114)],_0x3595a9['JaYFf'])){const _0x16ef42={'suffix':_0x3595a9[_0x5c7bd2(0x19f)],'url':'ldap://localhost:'+port,'dn':'uid={{id}},\x20o=example','groupCn':_0x3595a9[_0x5c7bd2(0x13e)],'groupFilter':_0x3595a9['xuQNH']};ldap['validateAuthData']({'id':_0x3595a9[_0x5c7bd2(0x11a)],'password':_0x5c7bd2(0x134)},_0x16ef42)[_0x5c7bd2(0x178)](_0x2c295b[_0x5c7bd2(0x157)])[_0x5c7bd2(0x121)](_0x446cba=>{const _0x4703ed=_0x5c7bd2;jequal(_0x446cba[_0x4703ed(0x173)],_0x4703ed(0x139)),_0x2c295b();})[_0x5c7bd2(0x117)](()=>_0x1b07ee[_0x5c7bd2(0x16c)]());}else _0x938a1b(_0x2c8ad8['message'],_0x3595a9['hJKWN']),_0x3595a9[_0x5c7bd2(0x15b)](_0x246dbe);});}),it(_0x4e408b(0x167),_0x214a66=>{const _0x578b25=_0x4e408b,_0xb181aa={'VBOPq':function(_0x25617e,_0x4c12ce,_0x190099){return _0x25617e(_0x4c12ce,_0x190099);},'ERydf':_0x578b25(0x146),'xhoPh':_0x578b25(0x11c),'rSHiC':_0x578b25(0x18e),'AGlZj':'secret'};mockLdapServer(port,'uid=testuser,\x20o=example',!![])[_0x578b25(0x178)](_0x53fa3e=>{const _0x5472bd=_0x578b25,_0x4d0334={'GiWKX':function(_0x31d12e,_0x3c3315,_0x1f4696){const _0x68d864=_0x4c58;return _0xb181aa[_0x68d864(0x115)](_0x31d12e,_0x3c3315,_0x1f4696);},'jAioB':_0x5472bd(0x139),'caogf':function(_0x4ee642){return _0x4ee642();}},_0x3ddeb5={'suffix':_0xb181aa[_0x5472bd(0x182)],'url':_0x5472bd(0x161)+port,'dn':_0xb181aa[_0x5472bd(0x191)],'groupCn':_0xb181aa[_0x5472bd(0x11e)],'groupFilter':_0x5472bd(0x12d)};ldap[_0x5472bd(0x16a)]({'id':_0x5472bd(0x1a0),'password':_0xb181aa[_0x5472bd(0x154)]},_0x3ddeb5)[_0x5472bd(0x178)](_0x214a66[_0x5472bd(0x157)])[_0x5472bd(0x121)](_0xe5612e=>{const _0x59dbba=_0x5472bd;_0x4d0334['GiWKX'](jequal,_0xe5612e[_0x59dbba(0x173)],_0x4d0334['jAioB']),_0x4d0334[_0x59dbba(0x13d)](_0x214a66);})[_0x5472bd(0x117)](()=>_0x53fa3e[_0x5472bd(0x16c)]());});}),it(_0x4e408b(0x138),_0x489f12=>{const _0x29f887=_0x4e408b;mockLdapServer(port,_0x29f887(0x143),!![])[_0x29f887(0x178)](_0x9a9010=>{const _0x5a268e=_0x29f887,_0x35cd7f={'suffix':_0x5a268e(0x146),'url':_0x5a268e(0x161)+port,'dn':_0x5a268e(0x11c)},_0x43bd86={'id':_0x5a268e(0x1a0),'password':_0x5a268e(0x134)};ldap['validateAuthData'](_0x43bd86,_0x35cd7f)[_0x5a268e(0x178)](()=>{const _0x5d88a9=_0x5a268e;expect(_0x43bd86)[_0x5d88a9(0x156)]({'id':_0x5d88a9(0x1a0)}),_0x489f12();})[_0x5a268e(0x121)](_0x489f12[_0x5a268e(0x157)])['finally'](()=>_0x9a9010[_0x5a268e(0x16c)]());});}),it(_0x4e408b(0x17f),_0x3e792a=>{const _0x1f5da0=_0x4e408b,_0x1ea15c={'fVOzv':function(_0x2adf39,_0x29d7bc){return _0x2adf39===_0x29d7bc;},'YTAEc':_0x1f5da0(0x180),'NwWRA':'testuser','hOzWS':_0x1f5da0(0x134),'hyIbv':_0x1f5da0(0x123),'UEbMm':function(_0x3daa6f,_0x3d763a){return _0x3daa6f(_0x3d763a);},'VCDTW':_0x1f5da0(0x11c),'dulLv':function(_0x182df2,_0x2fa1fc,_0x4f4907,_0x30198){return _0x182df2(_0x2fa1fc,_0x4f4907,_0x30198);}};_0x1ea15c[_0x1f5da0(0x17e)](mockLdapServer,port,'uid=testuser,\x20o=example',!![])[_0x1f5da0(0x178)](_0x5af6de=>{const _0x4aa6cf=_0x1f5da0,_0x57c261={'ltsyx':function(_0x2253b1,_0x3b3071){return _0x2253b1(_0x3b3071);},'JkHOo':function(_0x5520e2,_0x3ba436){const _0x311f5f=_0x4c58;return _0x1ea15c[_0x311f5f(0x15c)](_0x5520e2,_0x3ba436);}},_0xbcef98={'suffix':_0x4aa6cf(0x146),'url':_0x4aa6cf(0x161)+port,'dn':_0x1ea15c[_0x4aa6cf(0x183)]};reconfigureServer({'auth':{'ldap':_0xbcef98}})['then'](()=>{const _0x5e3576=_0x4aa6cf;if(_0x1ea15c[_0x5e3576(0x162)](_0x5e3576(0x18d),_0x1ea15c[_0x5e3576(0x18c)]))_0x57c261[_0x5e3576(0x17d)](_0x4e7e81,_0x2a3ec4[_0x5e3576(0x153)](_0x5e3576(0x147)))[_0x5e3576(0x156)]({'ldap':{'id':_0x5e3576(0x1a0)}}),_0x57c261[_0x5e3576(0x144)](_0x46537e,_0x572fc1[_0x5e3576(0x153)](_0x5e3576(0x147))[_0x5e3576(0x123)][_0x5e3576(0x15d)])[_0x5e3576(0x14e)](),_0x4d8596();else{const _0xd1d55f={'authData':{'id':_0x1ea15c[_0x5e3576(0x192)],'password':_0x1ea15c['hOzWS']}};Parse[_0x5e3576(0x118)][_0x5e3576(0x112)](_0x1ea15c[_0x5e3576(0x12f)],_0xd1d55f)['then'](_0x59ad95=>{const _0x27937a=_0x5e3576,_0x2cd7bd={'nDGqX':function(_0x432376,_0x222b08){return _0x432376(_0x222b08);},'oGpll':_0x27937a(0x147),'bpzlx':_0x27937a(0x1a0)},_0x3f3fab=new Parse[(_0x27937a(0x14d))](_0x27937a(0x118));_0x3f3fab['equalTo']('objectId',_0x59ad95['id'])['first']({'useMasterKey':!![]})[_0x27937a(0x178)](_0x552a1c=>{const _0x2c37f2=_0x27937a;_0x2cd7bd[_0x2c37f2(0x142)](expect,_0x552a1c['get'](_0x2cd7bd[_0x2c37f2(0x170)]))['toEqual']({'ldap':{'id':_0x2cd7bd[_0x2c37f2(0x175)]}}),expect(_0x552a1c['get'](_0x2cd7bd[_0x2c37f2(0x170)])[_0x2c37f2(0x123)][_0x2c37f2(0x15d)])[_0x2c37f2(0x14e)](),_0x3e792a();})[_0x27937a(0x121)](_0x3e792a[_0x27937a(0x157)])[_0x27937a(0x117)](()=>_0x5af6de['close']());});}});});});