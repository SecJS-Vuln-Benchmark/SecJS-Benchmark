const _0x234beb=_0x3a5d;(function(_0x1cfd85,_0x47896c){const _0x428312=_0x3a5d,_0x5e7c33=_0x1cfd85();while(!![]){try{const _0x199c6f=parseInt(_0x428312(0x1a5))/0x1+parseInt(_0x428312(0x187))/0x2*(parseInt(_0x428312(0x196))/0x3)+parseInt(_0x428312(0x190))/0x4*(-parseInt(_0x428312(0x189))/0x5)+-parseInt(_0x428312(0x192))/0x6+-parseInt(_0x428312(0x18a))/0x7+parseInt(_0x428312(0x1a4))/0x8*(parseInt(_0x428312(0x1b0))/0x9)+parseInt(_0x428312(0x19e))/0xa;if(_0x199c6f===_0x47896c)break;else _0x5e7c33['push'](_0x5e7c33['shift']());}catch(_0x217d1c){_0x5e7c33['push'](_0x5e7c33['shift']());}}}(_0x1d13,0xe5b7f));const {ErrorTypes,EModelEndpoint,resolveHeaders,mapModelToAzureConfig}=require(_0x234beb(0x19a)),{getUserKeyValues,checkUserKeyExpiry}=require(_0x234beb(0x1a3)),{getLLMConfig}=require('~/server/services/Endpoints/openAI/llm'),{isEnabled,isUserProvided}=require(_0x234beb(0x197)),{getAzureCredentials}=require(_0x234beb(0x18d)),{OpenAIClient}=require(_0x234beb(0x1a6)),initializeClient=async({req:_0x4930bd,res:_0x6eae01,endpointOption:_0x17f514,optionsOnly:_0xa09f58,overrideEndpoint:_0x54749f,overrideModel:_0x5b1453})=>{const _0x1b84d6=_0x234beb,_0x4c3c08={'LDFUj':function(_0x3a332a,_0x56e2d0){return _0x3a332a||_0x56e2d0;},'hZAkw':function(_0x15b332,_0x2cef86){return _0x15b332(_0x2cef86);},'gNKpU':function(_0x42a762,_0x29cb2b){return _0x42a762??_0x29cb2b;},'ornQk':function(_0x4f5c7c,_0x17d318){return _0x4f5c7c===_0x17d318;},'WbdoV':function(_0x394184,_0x20a68e){return _0x394184(_0x20a68e);},'yKPaz':_0x1b84d6(0x1a1),'zmabA':_0x1b84d6(0x1a7),'uxMoY':function(_0x1aee4d){return _0x1aee4d();},'ItHjx':function(_0x1d61bd,_0x5b8b4b){return _0x1d61bd&&_0x5b8b4b;},'ZwZgA':function(_0x3e6aef,_0x4e6cac,_0x1bf725){return _0x3e6aef(_0x4e6cac,_0x1bf725);}},{PROXY:_0x5ac8c7,OPENAI_API_KEY:_0x3a804d,AZURE_API_KEY:_0x1b6265,OPENAI_REVERSE_PROXY:_0x25769a,AZURE_OPENAI_BASEURL:_0x181d8b,OPENAI_SUMMARIZE:_0x5e9903,DEBUG_OPENAI:_0xf999ba}=process[_0x1b84d6(0x1aa)],{key:_0xca29b5}=_0x4930bd[_0x1b84d6(0x19d)],_0x5aa629=_0x5b1453??_0x4930bd[_0x1b84d6(0x19d)][_0x1b84d6(0x1ae)],_0x86f28=_0x54749f??_0x4930bd[_0x1b84d6(0x19d)][_0x1b84d6(0x1bb)],_0x1c1d99=isEnabled(_0x5e9903)?_0x1b84d6(0x1ab):null,_0x1d7de8={[EModelEndpoint[_0x1b84d6(0x1bc)]]:_0x3a804d,[EModelEndpoint['azureOpenAI']]:_0x1b6265},_0x5facdf={[EModelEndpoint[_0x1b84d6(0x1bc)]]:_0x25769a,[EModelEndpoint[_0x1b84d6(0x199)]]:_0x181d8b},_0x496ebc=isUserProvided(_0x1d7de8[_0x86f28]),_0x57ca9a=isUserProvided(_0x5facdf[_0x86f28]);let _0x34ccb2=null;if(_0xca29b5&&_0x4c3c08[_0x1b84d6(0x198)](_0x496ebc,_0x57ca9a)){if('mYnXe'!=='mYnXe')throw new _0x272455(_0x432685+_0x1b84d6(0x1ba));else checkUserKeyExpiry(_0xca29b5,_0x86f28),_0x34ccb2=await _0x4c3c08[_0x1b84d6(0x18b)](getUserKeyValues,{'userId':_0x4930bd['user']['id'],'name':_0x86f28});}let _0x1463c9=_0x496ebc?_0x34ccb2?.['apiKey']:_0x1d7de8[_0x86f28],_0x28bcfc=_0x57ca9a?_0x34ccb2?.[_0x1b84d6(0x18f)]:_0x5facdf[_0x86f28];const _0x28f1d4={'contextStrategy':_0x1c1d99,'proxy':_0x4c3c08[_0x1b84d6(0x1a2)](_0x5ac8c7,null),'debug':_0x4c3c08[_0x1b84d6(0x18b)](isEnabled,_0xf999ba),'reverseProxyUrl':_0x28bcfc?_0x28bcfc:null,..._0x17f514},_0x10e536=_0x4c3c08['ornQk'](_0x86f28,EModelEndpoint[_0x1b84d6(0x199)]),_0x5d2d32=_0x10e536&&_0x4930bd[_0x1b84d6(0x1a8)]['locals'][EModelEndpoint[_0x1b84d6(0x199)]];if(_0x10e536&&_0x5d2d32){const {modelGroupMap:_0x3858cb,groupMap:_0x3265e1}=_0x5d2d32,{azureOptions:_0x2ca693,baseURL:_0x5da076,headers:headers={},serverless:_0xd18b86}=mapModelToAzureConfig({'modelName':_0x5aa629,'modelGroupMap':_0x3858cb,'groupMap':_0x3265e1});_0x28f1d4[_0x1b84d6(0x1b9)]=_0x5da076??_0x28f1d4[_0x1b84d6(0x1b9)],_0x28f1d4[_0x1b84d6(0x195)]=_0x4c3c08[_0x1b84d6(0x194)](resolveHeaders,{...headers,..._0x28f1d4[_0x1b84d6(0x195)]??{}}),_0x28f1d4[_0x1b84d6(0x1b7)]=_0x5d2d32[_0x1b84d6(0x1b7)],_0x28f1d4[_0x1b84d6(0x1b4)]=_0x5d2d32[_0x1b84d6(0x1b4)];const _0x5a67eb=_0x5aa629[_0x1b84d6(0x1b2)](_0x1b84d6(0x1b8))?0x1e:0x11;_0x28f1d4[_0x1b84d6(0x19c)]=_0x5d2d32['streamRate']??_0x5a67eb,_0x28f1d4['titleMethod']=_0x5d2d32[_0x1b84d6(0x19b)]??_0x4c3c08[_0x1b84d6(0x1ad)];const _0x1ddd3b=_0x3858cb[_0x5aa629][_0x1b84d6(0x1b3)];_0x28f1d4[_0x1b84d6(0x1a0)]=_0x5d2d32[_0x1b84d6(0x18c)][_0x1ddd3b]['addParams'],_0x28f1d4['dropParams']=_0x5d2d32[_0x1b84d6(0x18c)][_0x1ddd3b]['dropParams'],_0x28f1d4[_0x1b84d6(0x1be)]=_0x5d2d32[_0x1b84d6(0x18c)][_0x1ddd3b]['forcePrompt'],_0x1463c9=_0x2ca693[_0x1b84d6(0x1b6)],_0x28f1d4[_0x1b84d6(0x1af)]=!_0xd18b86&&_0x2ca693,_0xd18b86===!![]&&(_0x28f1d4['defaultQuery']=_0x2ca693[_0x1b84d6(0x1a9)]?{'api-version':_0x2ca693['azureOpenAIApiVersion']}:undefined,_0x28f1d4['headers'][_0x4c3c08[_0x1b84d6(0x1b5)]]=_0x1463c9);}else _0x10e536&&(_0x28f1d4[_0x1b84d6(0x1af)]=_0x496ebc?JSON[_0x1b84d6(0x1b1)](_0x34ccb2[_0x1b84d6(0x191)]):_0x4c3c08[_0x1b84d6(0x18e)](getAzureCredentials),_0x1463c9=_0x28f1d4[_0x1b84d6(0x1af)][_0x1b84d6(0x1b6)]);const _0x1de6f8=_0x4930bd[_0x1b84d6(0x1a8)]['locals'][EModelEndpoint['openAI']];_0x4c3c08['ItHjx'](!_0x10e536,_0x1de6f8)&&(_0x28f1d4['streamRate']=_0x1de6f8[_0x1b84d6(0x19c)]);const _0x56ba23=_0x4930bd[_0x1b84d6(0x1a8)][_0x1b84d6(0x1bd)]['all'];_0x56ba23&&(_0x28f1d4[_0x1b84d6(0x19c)]=_0x56ba23[_0x1b84d6(0x19c)]);if(_0x496ebc&!_0x1463c9){if(_0x1b84d6(0x188)!==_0x1b84d6(0x188))_0x11b900['defaultQuery']=_0xd7ac32[_0x1b84d6(0x1a9)]?{'api-version':_0x162bf5[_0x1b84d6(0x1a9)]}:_0xe8f9ca,_0x50ba1e['headers'][_0x1b84d6(0x1a7)]=_0x4a3519;else throw new Error(JSON['stringify']({'type':ErrorTypes[_0x1b84d6(0x1ac)]}));}if(!_0x1463c9)throw new Error(_0x86f28+_0x1b84d6(0x1ba));if(_0xa09f58){const _0x271207=Object[_0x1b84d6(0x193)]({'modelOptions':_0x17f514[_0x1b84d6(0x19f)]},_0x28f1d4);return _0x4c3c08['ZwZgA'](getLLMConfig,_0x1463c9,_0x271207);}const _0x2bbb52=new OpenAIClient(_0x1463c9,Object[_0x1b84d6(0x193)]({'req':_0x4930bd,'res':_0x6eae01},_0x28f1d4));return{'client':_0x2bbb52,'openAIApiKey':_0x1463c9};};module['exports']=initializeClient;function _0x3a5d(_0x30b60b,_0xc4311c){const _0x1d13ae=_0x1d13();return _0x3a5d=function(_0x3a5d30,_0x555446){_0x3a5d30=_0x3a5d30-0x187;let _0x1324e9=_0x1d13ae[_0x3a5d30];return _0x1324e9;},_0x3a5d(_0x30b60b,_0xc4311c);}function _0x1d13(){const _0x26bb73=['hZAkw','groupMap','~/utils','uxMoY','baseURL','79412iJPWuR','apiKey','4819776mzHRHr','assign','WbdoV','headers','22074GECUtA','~/server/utils','LDFUj','azureOpenAI','librechat-data-provider','titleMethod','streamRate','body','16289220eDRcAP','model_parameters','addParams','completion','gNKpU','~/server/services/UserService','2416056dZTcXh','526941bRNljR','~/app','api-key','app','azureOpenAIApiVersion','env','summarize','NO_USER_KEY','yKPaz','model','azure','27hHFaQK','parse','includes','group','titleModel','zmabA','azureOpenAIApiKey','titleConvo','gpt-4','reverseProxyUrl','\x20API\x20Key\x20not\x20provided.','endpoint','openAI','locals','forcePrompt','278GKrTtT','Mqqzh','305Vkzhkm','7905730nIeevO'];_0x1d13=function(){return _0x26bb73;};return _0x1d13();}