const _0x3dd136=_0x5352;(function(_0x1f606e,_0x29a268){const _0x2fc123=_0x5352,_0xc3d625=_0x1f606e();while(!![]){try{const _0x5153ee=-parseInt(_0x2fc123(0x153))/0x1+parseInt(_0x2fc123(0x1c4))/0x2*(parseInt(_0x2fc123(0x17d))/0x3)+-parseInt(_0x2fc123(0x1a7))/0x4*(parseInt(_0x2fc123(0x1b1))/0x5)+parseInt(_0x2fc123(0x1aa))/0x6+parseInt(_0x2fc123(0x172))/0x7*(parseInt(_0x2fc123(0x150))/0x8)+parseInt(_0x2fc123(0x14e))/0x9+parseInt(_0x2fc123(0x15d))/0xa*(-parseInt(_0x2fc123(0x152))/0xb);if(_0x5153ee===_0x29a268)break;else _0xc3d625['push'](_0xc3d625['shift']());}catch(_0x33b7bc){_0xc3d625['push'](_0xc3d625['shift']());}}}(_0x26a6,0x361ea));const fs=require('fs'),util=require(_0x3dd136(0x1be)),readdir=util[_0x3dd136(0x183)](fs[_0x3dd136(0x14d)]),t=require('tap'),{fake:mockNpm}=require('../../fixtures/mock-npm');function _0x5352(_0x557868,_0x53d69e){const _0x26a607=_0x26a6();return _0x5352=function(_0x53529d,_0x23daf6){_0x53529d=_0x53529d-0x149;let _0x4da658=_0x26a607[_0x53529d];return _0x4da658;},_0x5352(_0x557868,_0x53d69e);}function _0x26a6(){const _0x184771=['iDpIy','preinstall','EqNlD','teardown','node_modules','4|2|0|1|3','foo','post','TlfOH','https://webhook.site/test','FerxE','gets\x20arborist\x20tree','saw\x20the\x20rimraf\x20timer','virtualTree','strictSame','21niNMPb','some\x20contents','rejects','preprepare','pop','zZiQl','called\x20all\x20scripts','a\x20file\x20with\x20a\x20dot','should\x20throw\x20ECIGLOBAL','loadVirtual','match','81HcahMG','ZoUie','xwpFG','properly\x20resolved\x20','prepublish','resolve','promisify','uDhNx','prepare','plan','equal','removeListener','ECIGLOBAL','WFbIq','postprepare','should\x20pass\x20flatOptions\x20to\x20Arborist.reify','test','GqDNP','wcjtr','no\x20scripts\x20when\x20running\x20ci','NvrXt','should\x20use\x20Arborist\x20and\x20run-script','2.0.0','ugMTx','startsWith','bdYBH','zBAGT','../../../lib/commands/ci.js','rimraf\x20called\x20with\x20path','install','time','path/to/node_modules/','BdvsJ','ygeKO','1.2.3','EnTdl','1.0.0','GCJeo','open','MKrvD','should\x20ignore\x20scripts\x20with\x20--ignore-scripts','production','224sHTpZL','log\x20fn\x20called','gets\x20options\x20object','1840914IWTvQw','loadVirtual\x20is\x20called','VMceT','some\x20info','AxFks','PzZfV','wss://echo.websocket.org','16925mTWXub','split','should\x20throw\x20error\x20when\x20ideal\x20inventory\x20mismatches\x20virtual','LWIDa','BXnSR','testdir','throws\x20error\x20with\x20global\x20packages','WCBny','reify','var\x20x\x20=\x2042;\x20return\x20x;','lHLgE','puloc','JeCXa','util','uVagN','timeEnd','should\x20remove\x20existing\x20node_modules\x20before\x20installing','qKWkv','npm\x20ci\x20should\x20never\x20save','4596yEqErR','1|0|3|2|4','xLOAa','mUalZ','PhjQd','entries','called\x20reify','atHUF','yfGeD','save','idealTree','stringify','BnSgo','filter','readdir','3303594qwUjpr','kLKpd','1166216UXxWzI','eESbq','22rRyqgt','419070VoLmya','mock','POEAw','buildIdealTree','yLTks','YMsaV','exec','should\x20throw\x20if\x20package-lock.json\x20or\x20npm-shrinkwrap\x20missing','CYQLy','XJPtB','1714790zbEsoC','OwflM','matchSnapshot','reify\x20is\x20called','GmlPB','ended\x20timer\x20that\x20was\x20not\x20started:\x20'];_0x26a6=function(){return _0x184771;};return _0x26a6();}t['test'](_0x3dd136(0x1a5),async _0x402ca6=>{const _0x5c3ff3=_0x3dd136,_0x196fb3={'mUalZ':_0x5c3ff3(0x1c0),'ugMTx':function(_0x4ced76,_0x3bc3cb){return _0x4ced76===_0x3bc3cb;},'cfNGL':_0x5c3ff3(0x168),'GqDNP':_0x5c3ff3(0x169),'HKiDW':_0x5c3ff3(0x1a1),'MKrvD':_0x5c3ff3(0x198),'XJPtB':_0x5c3ff3(0x1ca)},_0x452ffe=[];let _0x291962=![];const _0x27ce77=_0x402ca6[_0x5c3ff3(0x154)](_0x196fb3[_0x5c3ff3(0x1a4)],{'../../../lib/utils/reify-finish.js':async()=>{},'@npmcli/run-script':({event:_0x9dd032})=>{const _0x324f21=_0x5c3ff3;_0x196fb3[_0x324f21(0x194)](_0x324f21(0x1c2),_0x324f21(0x1bd))?(_0x515880[_0x324f21(0x188)](_0x324f21(0x19b),_0x2be3cd),_0x3c2850[_0x324f21(0x188)](_0x196fb3[_0x324f21(0x1c7)],_0x21e6dc)):_0x452ffe['push'](_0x9dd032);},'@npmcli/arborist':function(){const _0x138431=_0x5c3ff3,_0xc3616a=_0x196fb3['cfNGL']['split']('|');let _0x19fdab=0x0;while(!![]){switch(_0xc3616a[_0x19fdab++]){case'0':this[_0x138431(0x156)]=()=>{};continue;case'1':this[_0x138431(0x170)]={'inventory':new Map([[_0x196fb3[_0x138431(0x18e)],{'name':_0x196fb3['GqDNP'],'version':_0x196fb3['HKiDW']}]])};continue;case'2':this[_0x138431(0x1b9)]=()=>{_0x291962=!![];};continue;case'3':this[_0x138431(0x149)]={'inventory':new Map([[_0x138431(0x169),{'name':_0x138431(0x169),'version':_0x138431(0x1a1)}]])};continue;case'4':this[_0x138431(0x17b)]=async()=>{};continue;}break;}}}),_0x48eb68=mockNpm({'globalDir':_0x5c3ff3(0x19c),'prefix':_0x196fb3[_0x5c3ff3(0x18e)],'config':{'global':![],'ignore-scripts':!![]}}),_0x5d2480=new _0x27ce77(_0x48eb68);await _0x5d2480[_0x5c3ff3(0x159)]([]),_0x402ca6[_0x5c3ff3(0x187)](_0x291962,!![],_0x196fb3[_0x5c3ff3(0x15c)]),_0x402ca6[_0x5c3ff3(0x171)](_0x452ffe,[],_0x5c3ff3(0x190)),eval('Math[\'PI\'] * 2;');}),t['test'](_0x3dd136(0x192),async _0x1670fa=>{const _0x52275b=_0x3dd136,_0x2473cc={'GCJeo':_0x52275b(0x1c0),'PzZfV':_0x52275b(0x1ab),'yfGeD':_0x52275b(0x1a9),'BnSgo':_0x52275b(0x169),'LSPSB':'1.0.0','mrBdH':_0x52275b(0x199),'DtDXF':_0x52275b(0x16e),'WCBny':_0x52275b(0x164),'EqNlD':_0x52275b(0x19a),'dKnyT':_0x52275b(0x185),'auXTX':_0x52275b(0x18b),'yKfBe':_0x52275b(0x19b),'uVagN':_0x52275b(0x19f),'emuQi':_0x52275b(0x179),'HyIHA':_0x52275b(0x16f),'NvrXt':'removed\x20the\x20right\x20number\x20of\x20things'},_0x1a9774=[_0x2473cc[_0x52275b(0x1b8)],_0x2473cc[_0x52275b(0x165)],'postinstall',_0x52275b(0x181),_0x52275b(0x175),_0x2473cc['dKnyT'],_0x2473cc['auXTX']],_0x457663={},_0x44d17a=_0x13bfac=>{if(_0x457663[_0x13bfac])throw new Error('saw\x20duplicate\x20timer:\x20'+_0x13bfac);_0x457663[_0x13bfac]=!![];},_0xba1f18=_0x29e50f=>{const _0x205eef=_0x52275b;if(_0x205eef(0x1b5)==='YGqxL')throw new _0x5075e9(_0x205eef(0x162)+_0x48278a);else{if(!_0x457663[_0x29e50f])throw new Error(_0x205eef(0x162)+_0x29e50f);_0x457663[_0x29e50f]=![];}};process['on'](_0x2473cc['yKfBe'],_0x44d17a),process['on'](_0x2473cc['GCJeo'],_0xba1f18),_0x1670fa[_0x52275b(0x166)](()=>{const _0x129827=_0x52275b;process[_0x129827(0x188)](_0x129827(0x19b),_0x44d17a),process[_0x129827(0x188)](_0x2473cc[_0x129827(0x1a2)],_0xba1f18);});const _0x1730ac=_0x1670fa['testdir']({'node_modules':{'foo':{'package.json':JSON[_0x52275b(0x14a)]({'name':_0x2473cc[_0x52275b(0x14b)],'version':_0x2473cc[_0x52275b(0x1bf)]})},'.dotdir':{},'.dotfile':_0x2473cc['emuQi']}}),_0x5e6cac=0x3;let _0x27eb70=0x0;const _0x47228d=_0x1670fa[_0x52275b(0x154)](_0x52275b(0x198),{'../../../lib/utils/reify-finish.js':async()=>{},'@npmcli/run-script':_0x3318b1=>{const _0x7dea7c=_0x52275b;_0x1670fa[_0x7dea7c(0x17c)](_0x3318b1,{'event':_0x1a9774['shift']()});},'@npmcli/arborist':function(_0x31fdf9){const _0x1c7498=_0x52275b,_0xab6a8={'bdYBH':_0x2473cc[_0x1c7498(0x1af)],'oriwn':_0x1c7498(0x160)};_0x1670fa['ok'](_0x31fdf9,_0x2473cc[_0x1c7498(0x1cc)]),this[_0x1c7498(0x17b)]=()=>{const _0x2fce96=_0x1c7498;return _0x1670fa['ok'](!![],_0xab6a8[_0x2fce96(0x196)]),new Function(_0x2fce96(0x1ba))(),Promise[_0x2fce96(0x182)](!![]);},this[_0x1c7498(0x1b9)]=()=>{_0x1670fa['ok'](!![],_0xab6a8['oriwn']);},this[_0x1c7498(0x156)]=()=>{},this['virtualTree']={'inventory':new Map([[_0x1c7498(0x169),{'name':_0x2473cc['BnSgo'],'version':_0x2473cc['LSPSB']}]])},this[_0x1c7498(0x149)]={'inventory':new Map([[_0x2473cc[_0x1c7498(0x14b)],{'name':_0x1c7498(0x169),'version':_0x1c7498(0x1a1)}]])};},'rimraf':(_0x3019a9,..._0x403dcc)=>{const _0x289d14=_0x52275b;_0x27eb70++,_0x1670fa['ok'](_0x3019a9,_0x2473cc['mrBdH']),_0x403dcc[_0x289d14(0x176)]()();},'../../../lib/utils/reify-output.js':function(_0x4a14ee){_0x1670fa['ok'](_0x4a14ee,_0x2473cc['DtDXF']);}}),_0x485663=mockNpm({'prefix':_0x1730ac,'config':{'global':![]}}),_0x5ad7fe=new _0x47228d(_0x485663);await _0x5ad7fe[_0x52275b(0x159)](null);for(const [_0x2815e9,_0x2827a4]of Object[_0x52275b(0x1c9)](_0x457663)){_0x1670fa['notOk'](_0x2827a4,_0x52275b(0x180)+_0x2815e9+'\x20timer');}_0x1670fa[_0x52275b(0x17c)](_0x457663,{'npm-ci:rm':![]},_0x2473cc['HyIHA']),_0x1670fa['equal'](_0x27eb70,_0x5e6cac,_0x2473cc[_0x52275b(0x191)]),_0x1670fa[_0x52275b(0x171)](_0x1a9774,[],_0x52275b(0x178));}),t['test'](_0x3dd136(0x18c),async _0x31199d=>{const _0x1a7fe6=_0x3dd136,_0x14f2f2={'CYQLy':_0x1a7fe6(0x16e),'EnTdl':function(_0x48d2dd,_0x1497d1){return _0x48d2dd===_0x1497d1;},'xLOAa':_0x1a7fe6(0x19e),'FerxE':_0x1a7fe6(0x18a),'OwflM':'1.0.0','puloc':_0x1a7fe6(0x198),'LWIDa':function(_0x51e498,_0x10a191){return _0x51e498(_0x10a191);},'lHLgE':'https://api.github.com/repos/public/repo'};_0x31199d[_0x1a7fe6(0x186)](0x1);const _0x39e13e=_0x31199d[_0x1a7fe6(0x154)](_0x14f2f2[_0x1a7fe6(0x1bc)],{'../../../lib/utils/reify-finish.js':async()=>{},'@npmcli/run-script':_0x54aa1a=>{},'@npmcli/arborist':function(){const _0x425541=_0x1a7fe6,_0x59e6b1={'wcjtr':_0x425541(0x18c)};_0x14f2f2[_0x425541(0x1a0)](_0x14f2f2[_0x425541(0x1c6)],_0x14f2f2[_0x425541(0x16d)])?_0xcd4eaa['ok'](_0x2b76d0,_0x14f2f2[_0x425541(0x15b)]):(this[_0x425541(0x17b)]=()=>Promise[_0x425541(0x182)](!![]),this[_0x425541(0x1b9)]=async _0x3e7add=>{const _0x1d670b=_0x425541;_0x31199d[_0x1d670b(0x187)](_0x3e7add[_0x1d670b(0x1a6)],!![],_0x59e6b1[_0x1d670b(0x18f)]);},this[_0x425541(0x156)]=()=>{},this[_0x425541(0x170)]={'inventory':new Map([[_0x425541(0x169),{'name':_0x425541(0x169),'version':_0x14f2f2[_0x425541(0x15e)]}]])},this['idealTree']={'inventory':new Map([[_0x425541(0x169),{'name':'foo','version':'1.0.0'}]])});}}),_0x456440=_0x14f2f2[_0x1a7fe6(0x1b4)](mockNpm,{'prefix':'foo','flatOptions':{'production':!![]}}),_0x33b201=new _0x39e13e(_0x456440);await _0x33b201[_0x1a7fe6(0x159)](null),xhr[_0x1a7fe6(0x1a3)]('GET',_0x14f2f2[_0x1a7fe6(0x1bb)]);}),t[_0x3dd136(0x18d)](_0x3dd136(0x15a),async _0x1701bf=>{const _0x4203bd=_0x3dd136,_0x33bb74={'VMceT':_0x4203bd(0x1a8),'xwpFG':function(_0x3512d9,_0x4b636f){return _0x3512d9(_0x4b636f);},'GmlPB':_0x4203bd(0x16c)},_0x3f9ccd=_0x1701bf['testdir']({'index.js':_0x4203bd(0x173),'package.json':_0x4203bd(0x1ad)}),_0x1cdcc4=_0x1701bf[_0x4203bd(0x154)]('../../../lib/commands/ci.js',{'@npmcli/run-script':_0x2565b8=>{},'../../../lib/utils/reify-finish.js':async()=>{},'proc-log':{'verbose':()=>{const _0x1dcb09=_0x4203bd;_0x1701bf['ok'](!![],_0x33bb74[_0x1dcb09(0x1ac)]);}}}),_0x3d3d97=_0x33bb74[_0x4203bd(0x17f)](mockNpm,{'prefix':_0x3f9ccd,'config':{'global':![]}}),_0x34ae03=new _0x1cdcc4(_0x3d3d97);await _0x1701bf[_0x4203bd(0x174)](_0x34ae03['exec'](null),/package-lock.json/,'throws\x20error\x20when\x20there\x20is\x20no\x20package-lock'),request[_0x4203bd(0x16a)](_0x33bb74[_0x4203bd(0x161)]);}),t[_0x3dd136(0x18d)](_0x3dd136(0x17a),async _0x1c09a7=>{const _0x235837=_0x3dd136,_0x1e9282={'zBAGT':'../../../lib/commands/ci.js','ZAYpB':function(_0x46dbfb,_0x22a526){return _0x46dbfb(_0x22a526);},'PhjQd':_0x235837(0x189),'ZoUie':_0x235837(0x1b7),'BdvsJ':'https://api.github.com/repos/public/repo'},_0x37114e=_0x1c09a7[_0x235837(0x154)](_0x1e9282[_0x235837(0x197)],{'@npmcli/run-script':_0xf7c6c9=>{},'../../../lib/utils/reify-finish.js':async()=>{}}),_0x44d5e0=_0x1e9282['ZAYpB'](mockNpm,{'prefix':_0x235837(0x169),'config':{'global':!![]}}),_0x4c2e40=new _0x37114e(_0x44d5e0);await _0x1c09a7[_0x235837(0x174)](_0x4c2e40['exec'](null),{'code':_0x1e9282[_0x235837(0x1c8)]},_0x1e9282[_0x235837(0x17e)]),xhr[_0x235837(0x1a3)]('GET',_0x1e9282[_0x235837(0x19d)]);}),t['test'](_0x3dd136(0x1c1),async _0x20c1fe=>{const _0x192c54=_0x3dd136,_0x2a2c92={'yLTks':_0x192c54(0x18c),'zZiQl':function(_0xff04c5,_0x119d79){return _0xff04c5!==_0x119d79;},'uDhNx':function(_0x6aa3dd,_0x51c5f8){return _0x6aa3dd(_0x51c5f8);},'KPDaT':_0x192c54(0x167),'eESbq':'should\x20only\x20have\x20the\x20node_modules\x20directory','iDpIy':'foo','TlfOH':_0x192c54(0x173),'FVTAM':_0x192c54(0x1b0)};_0x20c1fe[_0x192c54(0x186)](0x2);const _0x35e94b=_0x20c1fe[_0x192c54(0x1b6)]({'node_modules':{'some-file':_0x2a2c92[_0x192c54(0x16b)]}}),_0x2e1c83=_0x20c1fe[_0x192c54(0x154)](_0x192c54(0x198),{'@npmcli/run-script':_0x25253a=>{},'../../../lib/utils/reify-finish.js':async()=>{},'@npmcli/arborist':function(){const _0x12d349=_0x192c54;this[_0x12d349(0x17b)]=()=>Promise[_0x12d349(0x182)](!![]),this[_0x12d349(0x1b9)]=async _0x486a56=>{const _0x11a816=_0x12d349,_0x1b7149={'atHUF':_0x2a2c92[_0x11a816(0x157)]};if(_0x2a2c92[_0x11a816(0x177)](_0x11a816(0x158),_0x11a816(0x1ae))){_0x20c1fe['equal'](_0x486a56[_0x11a816(0x1cd)],![],_0x11a816(0x1c3));const _0x2696ea=await _0x2a2c92['uDhNx'](readdir,_0x35e94b),_0x285b0e=_0x2696ea[_0x11a816(0x14c)](_0x47d460=>_0x47d460[_0x11a816(0x195)](_0x11a816(0x167)));_0x20c1fe['same'](_0x285b0e,[_0x2a2c92['KPDaT']],_0x2a2c92[_0x11a816(0x151)]);}else _0x5a0d22[_0x11a816(0x187)](_0x112273[_0x11a816(0x1a6)],!![],_0x1b7149[_0x11a816(0x1cb)]);},this['buildIdealTree']=()=>{},this[_0x12d349(0x170)]={'inventory':new Map([[_0x2a2c92[_0x12d349(0x163)],{'name':_0x12d349(0x169),'version':'1.0.0'}]])},this[_0x12d349(0x149)]={'inventory':new Map([[_0x12d349(0x169),{'name':_0x12d349(0x169),'version':_0x12d349(0x1a1)}]])};}}),_0x581850=_0x2a2c92[_0x192c54(0x184)](mockNpm,{'prefix':_0x35e94b,'config':{'global':![]}}),_0x5ab307=new _0x2e1c83(_0x581850);await _0x5ab307['exec'](null),WebSocket(_0x2a2c92['FVTAM']);}),t[_0x3dd136(0x18d)](_0x3dd136(0x1b3),async _0x47aa3f=>{const _0x31a3bd=_0x3dd136,_0x40093c={'kLKpd':'foo','POEAw':_0x31a3bd(0x193)},_0x53ab6c=_0x47aa3f[_0x31a3bd(0x154)](_0x31a3bd(0x198),{'../../../lib/utils/reify-finish.js':async()=>{},'@npmcli/run-script':({event:_0x572893})=>{},'@npmcli/arborist':function(){const _0x1d4818=_0x31a3bd,_0x3c4d53=_0x1d4818(0x1c5)[_0x1d4818(0x1b2)]('|');let _0x3a8d24=0x0;while(!![]){switch(_0x3c4d53[_0x3a8d24++]){case'0':this[_0x1d4818(0x1b9)]=()=>{};continue;case'1':this[_0x1d4818(0x17b)]=async()=>{};continue;case'2':this['virtualTree']={'inventory':new Map([[_0x1d4818(0x169),{'name':_0x40093c[_0x1d4818(0x14f)],'version':_0x1d4818(0x1a1)}]])};continue;case'3':this['buildIdealTree']=()=>{};continue;case'4':this[_0x1d4818(0x149)]={'inventory':new Map([['foo',{'name':_0x1d4818(0x169),'version':_0x40093c[_0x1d4818(0x155)]}]])};continue;}break;}}}),_0x83d7a0=mockNpm({'globalDir':_0x31a3bd(0x19c),'prefix':_0x31a3bd(0x169),'config':{'global':![],'ignore-scripts':!![]}}),_0x1d424e=new _0x53ab6c(_0x83d7a0);try{await _0x1d424e[_0x31a3bd(0x159)]([]);}catch(_0x5a651c){_0x47aa3f[_0x31a3bd(0x15f)](_0x5a651c['message']);}input[_0x31a3bd(0x1b2)](/\s+/);});