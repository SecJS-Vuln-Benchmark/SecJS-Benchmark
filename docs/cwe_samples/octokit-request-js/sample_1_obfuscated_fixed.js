const _0x35825b=_0xbb28;(function(_0x125fdf,_0x47cecd){const _0x1e886f=_0xbb28,_0x43fe01=_0x125fdf();while(!![]){try{const _0x1a1987=parseInt(_0x1e886f(0x102))/0x1*(parseInt(_0x1e886f(0x127))/0x2)+parseInt(_0x1e886f(0x11d))/0x3+parseInt(_0x1e886f(0x11f))/0x4+-parseInt(_0x1e886f(0x109))/0x5*(parseInt(_0x1e886f(0x113))/0x6)+parseInt(_0x1e886f(0x118))/0x7+parseInt(_0x1e886f(0x120))/0x8+-parseInt(_0x1e886f(0x12d))/0x9;if(_0x1a1987===_0x47cecd)break;else _0x43fe01['push'](_0x43fe01['shift']());}catch(_0x5c4752){_0x43fe01['push'](_0x43fe01['shift']());}}}(_0x2389,0x82823));function _0x2389(){const _0x53f1b6=['FileKeyInfo','1205cwdiSm','parseFromString','WTSvy','addReference','keyInfoProvider','<name>Harry\x20Potter</name>','signatureAlgorithm','utf-8','jvRoQ','checkSignature','834BRyMHj','loadSignature','SignedXml','./test/static/hmac-foobar.key','aBGjU','2047724YbtMyp','./test/static/hmac_signature.xml','DOMParser','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','../index','2565195Mllvgz','true','640632RVQOtR','260184wGfSDA','@xmldom/xmldom','getSignedXml','mVJbZ','test\x20validating\x20HMAC\x20signature','test\x20create\x20and\x20validate\x20HMAC\x20signature','xpath','26vGqymo','readFileSync','http://www.w3.org/2000/09/xmldsig#hmac-sha1','select','./test/static/hmac.key','false','10701081VdiWyM','RiZhg','Acedp','SignatureAlgorithms','<book>','signingKey','32061JVQwLZ','sTUgk','//*[local-name(.)=\x27book\x27]','HMAC\x20tests','kuSRq','jNYOu'];_0x2389=function(){return _0x53f1b6;};return _0x2389();}const crypto=require(_0x35825b(0x11c)),xpath=require(_0x35825b(0x126)),xmldom=require(_0x35825b(0x121)),fs=require('fs'),expect=require('chai')['expect'];function _0xbb28(_0x5cf66d,_0x545225){const _0x2389f4=_0x2389();return _0xbb28=function(_0xbb2844,_0x9dcae1){_0xbb2844=_0xbb2844-0x100;let _0x54dbf4=_0x2389f4[_0xbb2844];return _0x54dbf4;},_0xbb28(_0x5cf66d,_0x545225);}let sigAlgs;describe(_0x35825b(0x105),function(){const _0x365b1f=_0x35825b,_0x486951={'Acedp':'./test/static/hmac_signature.xml','jNYOu':_0x365b1f(0x11b),'jvRoQ':function(_0x1ec460,_0x147d0c){return _0x1ec460(_0x147d0c);},'kuSRq':'utf-8','YbqbM':_0x365b1f(0x116),'BhdKT':function(_0x4036bc,_0x41efe8){return _0x4036bc+_0x41efe8;},'Jtibw':_0x365b1f(0x100),'sTUgk':_0x365b1f(0x12b),'RiZhg':_0x365b1f(0x129),'mYbHE':function(_0x3f4622,_0x28e207){return _0x3f4622(_0x28e207);},'WTSvy':function(_0x1f75c4,_0x416444){return _0x1f75c4(_0x416444);},'aBGjU':function(_0xfea5e6,_0x3c43b0,_0x39cb36){return _0xfea5e6(_0x3c43b0,_0x39cb36);},'cmzpz':function(_0x120afe,_0x24eaae,_0x5b1a35){return _0x120afe(_0x24eaae,_0x5b1a35);},'mVJbZ':_0x365b1f(0x125)};_0x486951['mYbHE'](beforeEach,function(){const _0x5ae889=_0x365b1f;sigAlgs=crypto['SignedXml'][_0x5ae889(0x130)],crypto[_0x5ae889(0x115)]['enableHMAC']();}),_0x486951[_0x365b1f(0x10b)](afterEach,function(){const _0x3da435=_0x365b1f;crypto[_0x3da435(0x115)][_0x3da435(0x130)]=sigAlgs;}),_0x486951[_0x365b1f(0x117)](it,_0x365b1f(0x124),function(){const _0x1e67d2=_0x365b1f,_0x57123e=fs['readFileSync'](_0x486951[_0x1e67d2(0x12f)],_0x1e67d2(0x110)),_0x26559f=new xmldom[(_0x1e67d2(0x11a))]()[_0x1e67d2(0x10a)](_0x57123e),_0x4c03de=xpath[_0x1e67d2(0x12a)](_0x486951[_0x1e67d2(0x107)],_0x26559f)[0x0],_0xafd651=new crypto[(_0x1e67d2(0x115))]();_0xafd651[_0x1e67d2(0x10d)]=new crypto[(_0x1e67d2(0x108))](_0x1e67d2(0x12b)),_0xafd651[_0x1e67d2(0x114)](_0x4c03de);const _0x1c14b4=_0xafd651[_0x1e67d2(0x112)](_0x57123e);_0x486951[_0x1e67d2(0x111)](expect,_0x1c14b4)['to']['be'][_0x1e67d2(0x11e)];}),it('test\x20HMAC\x20signature\x20with\x20incorrect\x20key',function(){const _0x10d941=_0x365b1f,_0x1cded9=fs[_0x10d941(0x128)](_0x10d941(0x119),_0x486951[_0x10d941(0x106)]),_0x2efd5e=new xmldom[(_0x10d941(0x11a))]()[_0x10d941(0x10a)](_0x1cded9),_0x1385ac=xpath['select']('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x2efd5e)[0x0],_0x775f1e=new crypto[(_0x10d941(0x115))]();_0x775f1e[_0x10d941(0x10d)]=new crypto[(_0x10d941(0x108))](_0x486951['YbqbM']),_0x775f1e[_0x10d941(0x114)](_0x1385ac);const _0x265e99=_0x775f1e[_0x10d941(0x112)](_0x1cded9);expect(_0x265e99)['to']['be'][_0x10d941(0x12c)];}),_0x486951['cmzpz'](it,_0x486951[_0x365b1f(0x123)],function(){const _0x3d1c6d=_0x365b1f,_0x5126ce=_0x486951['BhdKT']('<library>'+_0x486951['Jtibw']+_0x3d1c6d(0x10e)+'</book>','</library>'),_0x82d6ec=new crypto['SignedXml']();_0x82d6ec[_0x3d1c6d(0x101)]=fs[_0x3d1c6d(0x128)](_0x486951[_0x3d1c6d(0x103)]),_0x82d6ec[_0x3d1c6d(0x10f)]=_0x486951[_0x3d1c6d(0x12e)],_0x82d6ec[_0x3d1c6d(0x10c)](_0x3d1c6d(0x104)),_0x82d6ec['computeSignature'](_0x5126ce);const _0x3bcf75=new xmldom['DOMParser']()[_0x3d1c6d(0x10a)](_0x82d6ec[_0x3d1c6d(0x122)]()),_0x460fb8=xpath[_0x3d1c6d(0x12a)](_0x486951['jNYOu'],_0x3bcf75)[0x0],_0x29a481=new crypto['SignedXml']();_0x29a481[_0x3d1c6d(0x10d)]=new crypto['FileKeyInfo'](_0x3d1c6d(0x12b)),_0x29a481['loadSignature'](_0x460fb8);const _0x5d57be=_0x29a481['checkSignature'](_0x82d6ec[_0x3d1c6d(0x122)]());expect(_0x5d57be)['to']['be'][_0x3d1c6d(0x11e)];});});