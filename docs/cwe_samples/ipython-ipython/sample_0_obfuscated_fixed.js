const _0x4534aa=_0x2d69;(function(_0x49ddb2,_0x5303ca){const _0x59636c=_0x2d69,_0x53dcee=_0x49ddb2();while(!![]){try{const _0x1cf9ba=-parseInt(_0x59636c(0x137))/0x1*(parseInt(_0x59636c(0x13c))/0x2)+-parseInt(_0x59636c(0x138))/0x3+parseInt(_0x59636c(0x12d))/0x4*(-parseInt(_0x59636c(0x12c))/0x5)+-parseInt(_0x59636c(0x116))/0x6+-parseInt(_0x59636c(0x155))/0x7*(parseInt(_0x59636c(0x15f))/0x8)+parseInt(_0x59636c(0x177))/0x9*(-parseInt(_0x59636c(0x164))/0xa)+parseInt(_0x59636c(0x14e))/0xb;if(_0x1cf9ba===_0x5303ca)break;else _0x53dcee['push'](_0x53dcee['shift']());}catch(_0x47c55c){_0x53dcee['push'](_0x53dcee['shift']());}}}(_0x3dc5,0xdf318));const models=require(_0x4534aa(0x11b)),logger=require('../../logger'),config=require(_0x4534aa(0x176)),errors=require(_0x4534aa(0x16f)),fs=require('fs'),path=require('path');exports[_0x4534aa(0x166)]=function(_0x438fdb,_0x1568d6,_0x54b076,_0x587ab1=null,_0x35f965=![]){const _0x1ca5bf=_0x4534aa,_0x3fb072={'xfbhv':'Error\x20while\x20checking\x20for\x20possible\x20duplicate:\x20','nPwHQ':function(_0x4b7e5b,_0x54ba71){return _0x4b7e5b||_0x54ba71;}},_0x274dd8=_0x438fdb[_0x1ca5bf(0x126)][_0x1ca5bf(0x146)]||_0x438fdb['params'][_0x1ca5bf(0x152)];models[_0x1ca5bf(0x133)]['parseNoteId'](_0x274dd8,function(_0x32ce88,_0x1dcc13){const _0x35241e=_0x1ca5bf,_0x3abdc9={'LGkGE':_0x3fb072[_0x35241e(0x181)],'lvtXS':function(_0xa80f33,_0x597a4f){return _0xa80f33&&_0x597a4f;},'MqVDN':function(_0x32062a,_0x68bcc1){return _0x32062a(_0x68bcc1);}};if(_0x32ce88)return logger[_0x35241e(0x139)](_0x32ce88),errors[_0x35241e(0x17f)](_0x1568d6);models[_0x35241e(0x133)][_0x35241e(0x13f)]({'where':{'id':_0x1dcc13},'include':_0x3fb072[_0x35241e(0x14a)](_0x587ab1,null)})[_0x35241e(0x163)](function(_0x3ff464){const _0x13dcb2=_0x35241e;if(!_0x3ff464&&_0x35f965)return _0x13dcb2(0x15b)!=='zrsUq'?(_0x2d9525[_0x13dcb2(0x139)](_0x3abdc9[_0x13dcb2(0x16a)]+_0x1b5e03),_0x3bc75c[_0x13dcb2(0x17f)](_0x2fd031)):exports['newNote'](_0x438fdb,_0x1568d6,'');if(_0x3abdc9[_0x13dcb2(0x124)](!_0x3ff464,!_0x35f965))return errors[_0x13dcb2(0x169)](_0x1568d6);return!exports['checkViewPermission'](_0x438fdb,_0x3ff464)?errors[_0x13dcb2(0x11a)](_0x1568d6):_0x3abdc9[_0x13dcb2(0x165)](_0x54b076,_0x3ff464);})[_0x35241e(0x122)](function(_0x210c17){const _0xc7c2e6=_0x35241e;return logger[_0xc7c2e6(0x139)](_0x210c17),errors['errorInternalError'](_0x1568d6);});});},exports['checkViewPermission']=function(_0x3f71d2,_0x356a3f){const _0x54ac66=_0x4534aa,_0xfe7cdf={'cDDJh':function(_0x4f3d31,_0x2517d3){return _0x4f3d31===_0x2517d3;},'sVoit':_0x54ac66(0x17e),'AVOqW':_0x54ac66(0x151),'zTEMp':_0x54ac66(0x143),'Psglv':function(_0x276372,_0x25207e){return _0x276372!==_0x25207e;},'VWlXm':function(_0x248540,_0x58a858){return _0x248540===_0x58a858;},'CZQMi':function(_0x3484b3,_0x26cd93){return _0x3484b3===_0x26cd93;},'qFWlV':function(_0x18c772,_0x3944f5){return _0x18c772===_0x3944f5;}};if(_0xfe7cdf[_0x54ac66(0x140)](_0x356a3f[_0x54ac66(0x129)],_0xfe7cdf[_0x54ac66(0x150)]))return _0xfe7cdf[_0x54ac66(0x175)]===_0xfe7cdf['zTEMp']?_0x4d980b[_0x54ac66(0x13b)]():!(!_0x3f71d2[_0x54ac66(0x13b)]()||_0xfe7cdf[_0x54ac66(0x136)](_0x356a3f[_0x54ac66(0x125)],_0x3f71d2[_0x54ac66(0x134)]['id']));else return _0xfe7cdf[_0x54ac66(0x14f)](_0x356a3f[_0x54ac66(0x129)],_0x54ac66(0x178))||_0xfe7cdf['CZQMi'](_0x356a3f['permission'],_0x54ac66(0x118))?_0xfe7cdf[_0x54ac66(0x131)]('sZjfL',_0x54ac66(0x153))?_0x3f71d2[_0x54ac66(0x13b)]():_0x1b9793[_0x54ac66(0x169)](_0x3faa51):!![];},exports['newNote']=async function(_0x3afb6e,_0x4abad7,_0x4414dc){const _0x491ad6=_0x4534aa,_0x3cb590={'cQTvH':function(_0x698598,_0x5af15d){return _0x698598===_0x5af15d;},'TpEPx':'sVYBe','QqYXn':function(_0x4ed8c7,_0x35792c){return _0x4ed8c7+_0x35792c;},'BbqFX':_0x491ad6(0x156),'JUDVy':function(_0x411af7,_0x2da4af){return _0x411af7!==_0x2da4af;},'YQAZg':_0x491ad6(0x17b),'YecPb':_0x491ad6(0x127),'POtLD':function(_0x414dd3,_0x394eca){return _0x414dd3>_0x394eca;}};let _0x3b91d0=null;const _0x536226=_0x3afb6e[_0x491ad6(0x126)][_0x491ad6(0x146)]?_0x3afb6e[_0x491ad6(0x126)][_0x491ad6(0x146)]:null;if(_0x3afb6e[_0x491ad6(0x13b)]())_0x3b91d0=_0x3afb6e[_0x491ad6(0x134)]['id'];else{if(!config[_0x491ad6(0x16c)])return _0x3cb590[_0x491ad6(0x17d)](_0x491ad6(0x17b),_0x3cb590[_0x491ad6(0x11e)])?(_0x20f477[_0x491ad6(0x139)](_0x1dac8d),_0x201568[_0x491ad6(0x17f)](_0x114e0f)):errors[_0x491ad6(0x11a)](_0x4abad7);}if(_0x536226){if(config[_0x491ad6(0x11c)]&&!config[_0x491ad6(0x168)]['includes'](_0x536226)&&(!config[_0x491ad6(0x115)]||_0x3afb6e['isAuthenticated']()))_0x3afb6e[_0x491ad6(0x147)]=_0x536226;else return _0x3cb590[_0x491ad6(0x12b)](_0x3afb6e['method'],_0x3cb590[_0x491ad6(0x145)])?errors[_0x491ad6(0x11a)](_0x4abad7):errors[_0x491ad6(0x169)](_0x4abad7);try{const _0x44a88b=await models['Note'][_0x491ad6(0x179)]({'where':{'alias':_0x3afb6e['alias']}});if(_0x3cb590[_0x491ad6(0x14d)](_0x44a88b,0x0))return errors[_0x491ad6(0x135)](_0x4abad7);}catch(_0x308d57){return logger[_0x491ad6(0x139)](_0x3cb590[_0x491ad6(0x171)](_0x491ad6(0x149),_0x308d57)),errors[_0x491ad6(0x17f)](_0x4abad7);}}models[_0x491ad6(0x133)]['create']({'ownerId':_0x3b91d0,'alias':_0x3afb6e[_0x491ad6(0x147)]?_0x3afb6e[_0x491ad6(0x147)]:null,'content':_0x4414dc,'title':models[_0x491ad6(0x133)]['parseNoteTitle'](_0x4414dc)})['then'](function(_0x391029){const _0x237d16=_0x491ad6;return _0x3cb590['cQTvH'](_0x237d16(0x16e),_0x3cb590[_0x237d16(0x13e)])?_0x27c001[_0x237d16(0x135)](_0xc50ccd):_0x4abad7['redirect'](_0x3cb590[_0x237d16(0x171)](config[_0x237d16(0x15e)]+'/',_0x391029[_0x237d16(0x147)]?_0x391029[_0x237d16(0x147)]:models[_0x237d16(0x133)][_0x237d16(0x15d)](_0x391029['id'])));})[_0x491ad6(0x122)](function(_0x420cc9){const _0x2a329f=_0x491ad6;return logger[_0x2a329f(0x139)](_0x3cb590[_0x2a329f(0x171)](_0x3cb590['BbqFX'],_0x420cc9)),errors[_0x2a329f(0x17f)](_0x4abad7);});},exports['getPublishData']=function(_0x3de241,_0x4f08a1,_0x5e8e93,_0x3f0b94){const _0x339c7c=_0x4534aa,_0x4748c6={'QBICc':function(_0x3d8ddc,_0x2345e2){return _0x3d8ddc===_0x2345e2;},'IHInv':function(_0xcf743d,_0x572237){return _0xcf743d+_0x572237;},'dYeKp':function(_0x8cec5e,_0x21f12d){return _0x8cec5e+_0x21f12d;},'NDhcL':_0x339c7c(0x128),'fouMd':_0x339c7c(0x11d)},_0x361c91=_0x5e8e93[_0x339c7c(0x172)],_0x1d0cd9=models[_0x339c7c(0x133)][_0x339c7c(0x120)](_0x361c91);let _0x3b9892=_0x1d0cd9[_0x339c7c(0x174)];const _0xace86c=models[_0x339c7c(0x133)][_0x339c7c(0x182)](_0x1d0cd9[_0x339c7c(0x141)]);_0x4748c6['QBICc'](typeof _0x1d0cd9[_0x339c7c(0x141)]['breaks'],_0x339c7c(0x15a))&&(_0x3b9892=_0x4748c6[_0x339c7c(0x180)](_0x4748c6[_0x339c7c(0x144)](_0x4748c6[_0x339c7c(0x114)]+_0x1d0cd9[_0x339c7c(0x141)][_0x339c7c(0x167)],_0x4748c6[_0x339c7c(0x12a)]),_0x3b9892));const _0x35c86b=_0x5e8e93[_0x339c7c(0x12f)],_0x287ee0=_0x5e8e93['lastchangeAt'];let _0x31dd31=models[_0x339c7c(0x133)]['decodeTitle'](_0x5e8e93[_0x339c7c(0x158)]);_0x31dd31=models['Note']['generateWebTitle'](_0xace86c[_0x339c7c(0x158)]||_0x31dd31);const _0x2df31c=models[_0x339c7c(0x133)][_0x339c7c(0x161)](_0xace86c,_0x31dd31),_0x3e9447={'title':_0x31dd31,'description':_0xace86c[_0x339c7c(0x17c)]||(_0x3b9892?models[_0x339c7c(0x133)]['generateDescription'](_0x3b9892):null),'lang':_0xace86c['lang']||null,'viewcount':_0x5e8e93[_0x339c7c(0x13a)],'createtime':_0x35c86b,'updatetime':_0x287ee0,'body':_0x3b9892,'theme':_0xace86c[_0x339c7c(0x12e)]&&isRevealTheme(_0xace86c[_0x339c7c(0x12e)][_0x339c7c(0x123)]),'meta':JSON[_0x339c7c(0x170)](_0x1d0cd9[_0x339c7c(0x141)]),'owner':_0x5e8e93['owner']?_0x5e8e93[_0x339c7c(0x14c)]['id']:null,'ownerprofile':_0x5e8e93[_0x339c7c(0x14c)]?models[_0x339c7c(0x14b)]['getProfile'](_0x5e8e93[_0x339c7c(0x14c)]):null,'lastchangeuser':_0x5e8e93[_0x339c7c(0x16b)]?_0x5e8e93[_0x339c7c(0x16b)]['id']:null,'lastchangeuserprofile':_0x5e8e93['lastchangeuser']?models[_0x339c7c(0x14b)][_0x339c7c(0x132)](_0x5e8e93[_0x339c7c(0x16b)]):null,'robots':_0xace86c[_0x339c7c(0x160)]||![],'GA':_0xace86c['GA'],'disqus':_0xace86c[_0x339c7c(0x13d)],'cspNonce':_0x4f08a1[_0x339c7c(0x148)][_0x339c7c(0x173)],'dnt':_0x3de241['headers'][_0x339c7c(0x119)],'opengraph':_0x2df31c};_0x3f0b94(_0x3e9447);};function _0x2d69(_0x5101f8,_0x402997){const _0x3dc56c=_0x3dc5();return _0x2d69=function(_0x2d694a,_0x242c37){_0x2d694a=_0x2d694a-0x114;let _0x4e8be9=_0x3dc56c[_0x2d694a];return _0x4e8be9;},_0x2d69(_0x5101f8,_0x402997);}function _0x3dc5(){const _0x18b3f8=['private','errorInternalError','IHInv','xfbhv','parseMeta','NDhcL','requireFreeURLAuthentication','3002544hgpqGK','Qwlbm','protected','dnt','errorForbidden','../../models','allowFreeURL','\x0a---\x0a','YQAZg','Wynde','extractMeta','.css','catch','theme','lvtXS','ownerId','params','POST','---\x0abreaks:\x20','permission','fouMd','cQTvH','1098105ITVuzZ','20hOPktJ','slideOptions','createdAt','reveal.js','qFWlV','getProfile','Note','user','errorConflict','Psglv','649GxaDsa','5287587cJnHPC','error','viewcount','isAuthenticated','842EUAqGs','disqus','TpEPx','findOne','cDDJh','meta','public','FXjOX','dYeKp','YecPb','noteId','alias','locals','Error\x20while\x20checking\x20for\x20possible\x20duplicate:\x20','nPwHQ','User','owner','POtLD','64036522lrqUMx','VWlXm','sVoit','qCjgI','shortid','sZjfL','zGerM','34769utffcg','Note\x20could\x20not\x20be\x20created:\x20','tIlQY','title','ZpYIv','boolean','zrsUq','css','encodeNoteId','serverURL','8bEmSCL','robots','parseOpengraph','join','then','20MQbHKM','MqVDN','findNote','breaks','forbiddenNoteIDs','errorNotFound','LGkGE','lastchangeuser','allowAnonymous','RVWKc','WQone','../../errors','stringify','QqYXn','content','nonce','markdown','AVOqW','../../config','5706216dLxqcy','limited','count','existsSync','cATMS','description','JUDVy'];_0x3dc5=function(){return _0x18b3f8;};return _0x3dc5();}function isRevealTheme(_0x2ebcd6){const _0x3d3547=_0x4534aa,_0x102cbf={'Qwlbm':_0x3d3547(0x142),'Wynde':'build','zGerM':_0x3d3547(0x130),'RVWKc':_0x3d3547(0x15c),'ZpYIv':_0x3d3547(0x123),'tIlQY':_0x3d3547(0x121)};if(fs[_0x3d3547(0x17a)](path[_0x3d3547(0x162)](__dirname,'..','..','..',_0x102cbf[_0x3d3547(0x117)],_0x102cbf[_0x3d3547(0x11f)],_0x102cbf[_0x3d3547(0x154)],_0x102cbf[_0x3d3547(0x16d)],_0x102cbf[_0x3d3547(0x159)],_0x2ebcd6+_0x102cbf[_0x3d3547(0x157)])))return _0x2ebcd6;return undefined;}