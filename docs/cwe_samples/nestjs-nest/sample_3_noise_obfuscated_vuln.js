'use strict';const _0x3711f7=_0x5dbf;function _0x5dbf(_0xffb1bf,_0x3e1772){const _0x10b225=_0x10b2();return _0x5dbf=function(_0x5dbf90,_0x3a0b4c){_0x5dbf90=_0x5dbf90-0x99;let _0x17c883=_0x10b225[_0x5dbf90];return _0x17c883;},_0x5dbf(_0xffb1bf,_0x3e1772);}function _0x10b2(){const _0x567332=['IYloy','FiHZQ','udIMP','xQLFQ','DYmgb','should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20algorithm','jUAiN','Invalid\x20header\x20syntax','WpxQk','zVMAM','nbAQJ','some\x20message','XAGsI','not','23434d3q4d5345d','user','bob','nYofy','Bad\x20attribute\x20value:\x20id','algorithm','checks\x20payload\x20hash','steve','ScYgo','Invalid\x20authorization','Bad\x20payload\x20hash','Cstmg','gigVA','errors\x20on\x20an\x20invalid\x20authorization\x20header\x20format','Invalid\x20credentials','Hawk','Invalid\x20Host\x20header','WUDgt','tQDhI','generates\x20header\x20(pre\x20calculated\x20hash)','WvurQ','OTLEl','UwiLD','KRtua','rTNlj','ONYPx','xaMaf','statusCode','KQrNy','Hawk\x20mac=\x22q+fdjQv3kF56JGKLYeLzAS9dYGcvDqAXRG7MTVHAFKE=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22','OgvMm','cnGwJ','utils','errors\x20on\x20invalid\x20authorization\x20(hash)','cxDcp','Basic\x20asdasdasdasd','authenticateMessage','YPyhV','equal','PQkuw','ZdXdP','oaXGN','SrsNK','IvQEZ','GqiXy','errors\x20on\x20a\x20replay','@hapi/code','Hawk\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22LXfmTnRzrLd9TD7yfH+4se46Bx6AHyhpM94hLCiNia4=\x22,\x20ext=\x22hello\x22','hlSfa','SuOIl','1229144bIrVKl','jmzsi','IrTBc','brqBX','dkKCY','zfFkz','iadao','should\x20fail\x20on\x20missing\x20credentials','crypto','SqxZV','opPio','errors\x20on\x20a\x20stale\x20timestamp','pUhXi','Hawk\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','JakEu','should\x20fail\x20authorization\x20on\x20invalid\x20credentials\x20(algorithm)','safe','gcwyl','hlioj','YAvwx','UjVpj','mrioL','ymqoT','Odhhr','parses\x20a\x20valid\x20authentication\x20header\x20(sha256)','DjqCV','now','/resource/4?filter=a','blah','GwuOs','mpTtP','KpCtw','RnLYF','lJJNp','Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22','reject','hkGCF','IlWHx','ElTxf','server','wckMy','should\x20fail\x20authorization\x20on\x20invalid\x20credentials','authenticate','errors\x20on\x20invalid\x20authorization\x20(mac)','Unknown\x20algorithm','nuzSx','TiWwk','sIOoj','should\x20fail\x20authorization\x20on\x20invalid\x20authorization','return\x20new\x20Date();','NNlSB','some','Hawk\x20id=\x22\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','wQrJF','YgnSg','should\x20fail\x20authorization\x20on\x20credentials\x20error','ZqXKu','FojUz','bpJlU','errors\x20on\x20an\x20missing\x20authorization\x20header','hash','@hapi/lab','10rtIFpO','EHVYJ','YwFVU','oCwQJ','cgLms','Hawk\x20id=\x22dh37fgj492je\x22,\x20ts=\x221353832234\x22,\x20nonce=\x22j4h3g2\x22,\x20mac=\x22m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\x22,\x20ext=\x22some-app-data\x22','lKBwI','VArCb','eCgaA','QAXgq','iJvWE','Unknown\x20attribute:\x20x','UqJqd','cbVhf','GrEBH','exist','errors\x20on\x20missing\x20artifacts','bjmPq','lJUDp','kGUHF','XAhVi','ubcYI','xriLV','ZpSFF','ckvgb','JFWJR','1GgquCv','Ejwjo','hQNoO','XXvRj','Bad\x20message\x20hash','updateClock();','1511952PBSPvo','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22bXx7a7p1h9QYQNZ8x7QhvDQym8ACgab4m3lVSFn4DBw=\x22,\x20ext=\x22hello\x22','IvAIj','contentType','AxQbq','tfcYH','adUNl','NIKfW','QOUzt','Duplicate\x20attribute:\x20id','Wywso','ubpDh','12595131DqRrLg','should\x20fail\x20on\x20invalid\x20algorithm','isMissing','qSynt','GET','eCGFS','Hawk\x20id=\x22123456\x22,\x20ts=\x221357926341\x22,\x20nonce=\x221AwuJD\x22,\x20hash=\x22qAiXIVv+yjDATneWxZP2YCTa9aHRgQdnH9b3Wc+o3dg=\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22UeYcj5UoTVaAWXNvJfLVia7kU3VabxCqrccXP8sUGC4=\x22','cvPxC','mac','EYBqG','CPIPz','LadxI','btWmy','VSlJO','Stale\x20timestamp','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(id)','fchQy','XpLjW','oTSBT','emmZH','dUMek','xmqzX','VSQBi','abc','JdPep','KtBoe','pKXho','OFecB','should\x20fail\x20authorization\x20on\x20bad\x20hash','sha256','uvLvT','EzdfY','6265392ddItNn','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(ts)','errors\x20on\x20invalid\x20authorization\x20(nonce)','Missing\x20attributes','7595qhmWok','HqRfo','HJTML','Server','calculatePayloadHash','qShpE','WHFmW','Sszuo','VldNv','nILpn','FMYyq','qxkRZ','TVyvE','8080','qDgZK','errors\x20on\x20invalid\x20credentials\x20(algorithm)','errors\x20on\x20an\x20bad\x20authorization\x20header\x20format','FAPOU','rvxIR','payload','AApMG','should\x20fail\x20authorization\x20on\x20mismatching\x20host','body','csSck','mggDo','QLpbh','QbhhI','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(nonce)','123456','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','GItvQ','output','Nhtdy','AbScC','authenticate()','uetDk','some\x20message1','errors\x20on\x20an\x20bad\x20host\x20header\x20(missing\x20host)','FIwCt','dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','1234567','generates\x20header','hetrB','Crudz','throw','response-specific','should\x20fail\x20authorization\x20on\x20stale\x20timestamp','1338410MUxdvO','Invalid\x20nonce','IPnNJ','dmlRe','WWW-Authenticate','YNDTk','OEGhT','kKWrB','header()','GTaxL','EUiwn','UBRti','iMyyO','OJrbU','Hawk\x20id=\x22123456\x22,\x20ts=\x221362337299\x22,\x20nonce=\x22UzmxSs\x22,\x20ext=\x22some-app-data\x22,\x20mac=\x22wnNUxchvvryMH2RxckTdZ/gY3ijzvccx4keVvELC61w=\x22','errors\x20on\x20missing\x20hash','YOYNm','expect','wJujK','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcU4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','GAkkC','errors\x20on\x20invalid\x20artifacts','errors\x20on\x20credentialsFunc\x20error','CTRAH','RPRBP','SzzyM','cbDhw','authenticateMessage()','example1.com','GbQUZ','cUJgG','client','An\x20internal\x20server\x20error\x20occurred','Hawk\x20mac=\x22i8/kUBDx0QF+PpCtW860kkV/fa9dbwEoe/FpGUXowf0=\x22,\x20hash=\x22q/t+NNAkQZNlq/aAD6PlexImwQTxwgT2MahfTa9XRLA=\x22,\x20ext=\x22response-specific\x22','cyxbw','RXGLP','mXNdo','example.com:something','vBMgq','LkVQr','WhEex','ECZkN','ronvZ','Zmwrs','MsIxj','Unknown\x20credentials','Hawk\x20mac=\x226PrybJTJs20jsgBw5eilXpcytD8kUbaIKNYXL+6g0ns=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22','1398546787','message','DLNoa','xUwusx','should\x20fail\x20authorization\x20on\x20missing\x20credentials','456','Hawk\x20id=\x22123\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','YhUYv','errors\x20on\x20an\x20empty\x20authorization\x20attribute\x20value','Unknown\x20user','errors\x20on\x20an\x20missing\x20authorization\x20attribute\x20(mac)','errors\x20on\x20an\x20bad\x20authorization\x20attribute\x20value','NSctC','sha1','HoMGs','log','AqTdj','RjhhI','parses\x20a\x20valid\x20authentication\x20header\x20(sha1)','ERPSs','POST','Missing\x20required\x20payload\x20hash','zDadI','UwFmY','Bad\x20mac','oXVpb','MVxvW','example.com','mWQnd','OiBLK','QHZbx','authenticatePayloadHash','header','gRIXb','Hawk\x20id=\x22\x09\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','pChqg','inmCi','generates\x20header\x20(null\x20ext)','xAZEC','JdOyb','/resource/1?b=1&a=2','XsACK','xfFLV','errors\x20on\x20missing\x20hash\x20(empty\x20payload)','CGiVh','YDhJt','Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','errors\x20on\x20invalid\x20credentials\x20(key)','vRmgm','frycf','hmac-sha-0','123','errors\x20on\x20missing\x20credentials','WRgcP','qbNgh','value','ayQhI','overrides\x20timestampSkewSec','DOUOZ','generates\x20header\x20(empty\x20ext)','myXcc','should\x20fail\x20authorization\x20on\x20nonce\x20error','generates\x20header\x20(empty\x20payload)','pgKBv','credentials','some\x20reply','text/plain','match','mALTz','errors\x20on\x20duplicated\x20authorization\x20attribute\x20key','xrunpaw3489ruxnpa98w4rxnwerxhqb98rpaxn39848','waviT','parses\x20a\x20valid\x20authentication\x20header\x20(host\x20override)','ZIpKl','werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','1854FIKfbM','UEtBi','FILtQ','UcApF','errors\x20on\x20uri\x20too\x20long','wnXfd','DJBnH','OGnBE','errors\x20on\x20an\x20bad\x20host\x20header\x20(pad\x20port)','nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','vLCTk','yhcUp','within','VdeHl','example1.com:80','xsXdW','sGPeI','AdIyP','qzrpE','Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22','errors\x20on\x20credentialsFunc\x20error\x20(with\x20credentials)','!@#','asLeF','@hapi/hoek','gmNoX','jKuII','rEhEC','parses\x20a\x20valid\x20authentication\x20header\x20(host\x20port\x20override)','wZvYe','MrVjR','VcwAq','gYZxP','qOsaK','HPuhb','abcdefg','AhEoA','nkeHX','yaooN','Invalid\x20inputs','NKlmu','XIHFv','console.log(\x22timer\x22);','iAUWu','KnMqW','qHsCz','asdasd','errors\x20on\x20unknown\x20credentials\x20algorithm','ATPXR','XJLVd','sEBDV','ZmXFz','pgbSV','some-app-data','612199SfGfOt','ZDswH','kszAJ'];_0x10b2=function(){return _0x567332;};return _0x10b2();}(function(_0x23df78,_0x38bd82){const _0x28ac7f=_0x5dbf,_0x4a2563=_0x23df78();while(!![]){try{const _0x3248e8=parseInt(_0x28ac7f(0x174))/0x1*(-parseInt(_0x28ac7f(0x1d9))/0x2)+parseInt(_0x28ac7f(0x17a))/0x3+-parseInt(_0x28ac7f(0x11c))/0x4+-parseInt(_0x28ac7f(0x1aa))/0x5*(-parseInt(_0x28ac7f(0xa4))/0x6)+-parseInt(_0x28ac7f(0xd9))/0x7+-parseInt(_0x28ac7f(0x1a6))/0x8+-parseInt(_0x28ac7f(0x186))/0x9*(-parseInt(_0x28ac7f(0x15a))/0xa);if(_0x3248e8===_0x38bd82)break;else _0x4a2563['push'](_0x4a2563['shift']());}catch(_0x5b9540){_0x4a2563['push'](_0x4a2563['shift']());}}}(_0x10b2,0x8057c));const Code=require(_0x3711f7(0x118)),Hawk=require('..'),Hoek=require(_0x3711f7(0xbb)),Lab=require(_0x3711f7(0x159)),internals={},{describe,it}=exports['lab']=Lab['script'](),expect=Code[_0x3711f7(0x1ea)];describe(_0x3711f7(0x1ad),()=>{const _0xb513f0=_0x3711f7,_0x3eb386={'JdOyb':function(_0xec0661,_0xf4ba6d,_0x185b4c){return _0xec0661(_0xf4ba6d,_0x185b4c);},'nkeHX':_0xb513f0(0xa3),'QAXgq':function(_0x457da8,_0x195f61){return _0x457da8===_0x195f61;},'NKlmu':_0xb513f0(0x215),'HoMGs':'steve','cyxbw':_0xb513f0(0x223),'OgvMm':_0xb513f0(0x230),'jKuII':function(_0x20e0e4,_0xf83810){return _0x20e0e4-_0xf83810;},'HPuhb':function(_0xc05980,_0xe48b24){return _0xc05980(_0xe48b24);},'mpTtP':_0xb513f0(0x18a),'wJujK':_0xb513f0(0x137),'mALTz':function(_0x109ce4,_0x12af36){return _0x109ce4(_0x12af36);},'JakEu':function(_0xe20c8b,_0x2c24cc){return _0xe20c8b(_0x2c24cc);},'dUMek':function(_0x39d574,_0x46b561){return _0x39d574*_0x46b561;},'RnLYF':function(_0x13b41b,_0x5e8a5b,_0x2898a2){return _0x13b41b(_0x5e8a5b,_0x2898a2);},'gigVA':_0xb513f0(0x119),'Ejwjo':_0xb513f0(0xec),'sGPeI':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22','qbNgh':_0xb513f0(0xfa),'Zmwrs':_0xb513f0(0x236),'SuOIl':function(_0x526ead,_0x57d427){return _0x526ead-_0x57d427;},'DFGQF':_0xb513f0(0x1a9),'Sszuo':_0xb513f0(0xe3),'frycf':_0xb513f0(0x1fe),'gcwyl':_0xb513f0(0x1e3),'ubcYI':_0xb513f0(0x1f1),'hetrB':function(_0x25e311,_0x331892){return _0x25e311(_0x331892);},'xaMaf':_0xb513f0(0x148),'hlioj':'An\x20internal\x20server\x20error\x20occurred','yhcUp':_0xb513f0(0x13e),'xfFLV':_0xb513f0(0x18c),'VSQBi':function(_0x151378,_0x2794b2){return _0x151378(_0x2794b2);},'FIwCt':_0xb513f0(0x1c0),'FojUz':function(_0x50ba48,_0x3e6aa8){return _0x50ba48+_0x3e6aa8;},'pfTwQ':_0xb513f0(0x1da),'waviT':'sha256','GrEBH':_0xb513f0(0x131),'cUJgG':function(_0x5ee1cd,_0x5d503b,_0x46f4a0){return _0x5ee1cd(_0x5d503b,_0x46f4a0);},'bpJlU':_0xb513f0(0x22a),'fdyVT':_0xb513f0(0xee),'XAGsI':_0xb513f0(0x1c6),'WvurQ':_0xb513f0(0x1b7),'cnGwJ':function(_0xc1d96e,_0x59a7e0){return _0xc1d96e(_0x59a7e0);},'ATPXR':_0xb513f0(0xad),'DjqCV':_0xb513f0(0xd8),'iadao':function(_0xd0dc24,_0x4d92a7){return _0xd0dc24!==_0x4d92a7;},'fMVCq':'wZvYe','iJvWE':function(_0x4ddae5,_0x1597ed){return _0x4ddae5*_0x1597ed;},'dkKCY':'Bad\x20mac','GbQUZ':_0xb513f0(0x21a),'sFHTF':'parses\x20a\x20valid\x20authentication\x20header\x20(POST\x20with\x20payload)','jUAiN':_0xb513f0(0x1e8),'YDhJt':_0xb513f0(0x117),'BLzcD':'errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20no\x20scheme','OJrbU':_0xb513f0(0x195),'Wywso':_0xb513f0(0x1c5),'inmCi':function(_0x5cee43,_0x326879,_0x856d7e){return _0x5cee43(_0x326879,_0x856d7e);},'YPyhV':_0xb513f0(0x212),'kszAJ':function(_0x162353,_0x5e92fb,_0x808095){return _0x162353(_0x5e92fb,_0x808095);},'wStEk':_0xb513f0(0x1ba),'AqTdj':_0xb513f0(0xf7),'WUDgt':function(_0xcacc24,_0x1daa75,_0x4a1933){return _0xcacc24(_0x1daa75,_0x4a1933);},'brqBX':_0xb513f0(0x1cf),'dCVbw':_0xb513f0(0x1ef),'jwPQN':_0xb513f0(0xb8),'OEGhT':'POST','bJyTu':_0xb513f0(0xae),'VdeHl':'hEJGF','TiWwk':_0xb513f0(0x208),'KnMqW':_0xb513f0(0x20b),'rTNlj':'text/plain','qHsCz':_0xb513f0(0x1d7),'aveox':_0xb513f0(0x1fa),'cbDhw':_0xb513f0(0x107),'AhEoA':_0xb513f0(0xf8),'OGnBE':function(_0x1650cd,_0x2f7ce6){return _0x1650cd(_0x2f7ce6);},'zfFkz':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','wQrJF':_0xb513f0(0xca),'oNXSI':_0xb513f0(0x9a),'OTLEl':_0xb513f0(0xb7),'QbhhI':_0xb513f0(0x207),'ElTxf':_0xb513f0(0x18f),'ovSaV':_0xb513f0(0x246),'asLeF':_0xb513f0(0x243),'WhEex':_0xb513f0(0xfd),'XAhVi':function(_0x5bd351,_0x3874a1,_0x3e0f06){return _0x5bd351(_0x3874a1,_0x3e0f06);},'WRgcP':_0xb513f0(0x22d),'mWQnd':function(_0xb0b630,_0x2ea786,_0x5c3939){return _0xb0b630(_0x2ea786,_0x5c3939);},'soNiR':'errors\x20on\x20invalid\x20algorithm','CGiVh':'errors\x20on\x20invalid\x20options','hlSfa':function(_0x5122dc,_0x15a4c0){return _0x5122dc(_0x15a4c0);},'gmNoX':function(_0x5aa19a,_0x4ac77a){return _0x5aa19a<_0x4ac77a;},'UEtBi':_0xb513f0(0x11e),'OFecB':_0xb513f0(0xe7),'nGihI':function(_0x45ac4,_0x4f1ffa){return _0x45ac4(_0x4f1ffa);},'ERPSs':_0xb513f0(0xf3),'coVOF':_0xb513f0(0x1fd),'nYofy':function(_0x4e2f85,_0x5f3c9b){return _0x4e2f85(_0x5f3c9b);},'xriLV':function(_0x37b880,_0x8152e6){return _0x37b880(_0x8152e6);},'yLDEB':_0xb513f0(0x194),'syRbi':'hMjZf','QHZbx':function(_0x2d0214,_0x198efa){return _0x2d0214(_0x198efa);},'adUNl':'kablooey','LkVQr':'456','oCwQJ':function(_0x217657,_0x95517b){return _0x217657(_0x95517b);},'csSck':_0xb513f0(0x171),'OajhL':function(_0x5f5201,_0x16f140){return _0x5f5201===_0x16f140;},'iXgAK':_0xb513f0(0x9f),'vRmgm':function(_0x386b44,_0x4ccad2){return _0x386b44(_0x4ccad2);},'FiHZQ':'something','ZqXKu':function(_0x30f1d5,_0x53afbc){return _0x30f1d5(_0x53afbc);},'cTrLZ':_0xb513f0(0x23f),'myXcc':function(_0x5eaefd,_0x4c5f2e,_0x4a6c58){return _0x5eaefd(_0x4c5f2e,_0x4a6c58);},'hQNoO':_0xb513f0(0x139),'Odhhr':function(_0x2bdb6f,_0x4756e6){return _0x2bdb6f(_0x4756e6);},'cvPxC':_0xb513f0(0x1c2),'IlWHx':function(_0x243f51,_0x404b22){return _0x243f51(_0x404b22);},'hcEph':_0xb513f0(0x14b),'opPio':_0xb513f0(0x173),'zDadI':'errors\x20on\x20invalid\x20authorization\x20(ts)','gRIXb':function(_0x1955fd,_0x12f249,_0x13662e){return _0x1955fd(_0x12f249,_0x13662e);},'GqiXy':_0xb513f0(0x1a8),'lJJNp':_0xb513f0(0x10b),'pgbSV':'errors\x20with\x20credentials','RXGLP':function(_0x15d233,_0x28cd19,_0x8b5798){return _0x15d233(_0x28cd19,_0x8b5798);},'QLpbh':'should\x20generate\x20an\x20authorization\x20then\x20successfully\x20parse\x20it','pgKBv':_0xb513f0(0x1bf),'BQCPB':_0xb513f0(0x1d8),'hkGCF':_0xb513f0(0x241),'MsIxj':_0xb513f0(0x14c),'fchQy':_0xb513f0(0x245),'NIKfW':function(_0x4bd539,_0x24a871,_0x25cd00){return _0x4bd539(_0x24a871,_0x25cd00);},'uZpWw':function(_0x3ce187,_0x14d76b,_0x470109){return _0x3ce187(_0x14d76b,_0x470109);},'lKBwI':_0xb513f0(0xe1),'rvxIR':function(_0x379a50,_0x1d08cf,_0x185503){return _0x379a50(_0x1d08cf,_0x185503);},'UwiLD':function(_0x5c47fe,_0x569ba8,_0x599d2d){return _0x5c47fe(_0x569ba8,_0x599d2d);},'kKWrB':_0xb513f0(0x1cc),'KpCtw':function(_0x584c5d,_0x1842b9,_0x285810){return _0x584c5d(_0x1842b9,_0x285810);},'AYbsy':_0xb513f0(0x1f4),'hHXlb':'authenticatePayloadHash()'},_0x14a561=function(_0x20041d){const _0x226c8f=_0xb513f0;return _0x3eb386[_0x226c8f(0x22f)](setTimeout,'console.log(\x22timer\x22);',0x3e8),{'id':_0x20041d,'key':_0x3eb386[_0x226c8f(0xc8)],'algorithm':_0x3eb386[_0x226c8f(0x163)](_0x20041d,'1')?_0x3eb386[_0x226c8f(0xcb)]:_0x226c8f(0x1a3),'user':_0x3eb386[_0x226c8f(0x216)]};};describe(_0x3eb386[_0xb513f0(0x1e0)],()=>{const _0x408b51=_0xb513f0,_0x306daf={'VArCb':_0x3eb386[_0x408b51(0xaf)],'IYloy':_0x3eb386['cyxbw'],'eCgaA':function(_0x228dc8,_0x54b4a4){return _0x228dc8-_0x54b4a4;},'YwFVU':function(_0x26fd25,_0x4c54d5){const _0xf131bd=_0x408b51;return _0x3eb386[_0xf131bd(0x12a)](_0x26fd25,_0x4c54d5);},'lJUDp':_0x3eb386['wJujK'],'UwFmY':_0x3eb386[_0x408b51(0x232)],'WHFmW':_0x408b51(0xf1),'YhUYv':_0x3eb386[_0x408b51(0x108)],'LadxI':function(_0xa54a7a,_0x1e804e){const _0x2a384c=_0x408b51;return _0x3eb386[_0x2a384c(0x19c)](_0xa54a7a,_0x1e804e);},'HqRfo':_0x3eb386[_0x408b51(0x1d0)],'KVbhO':_0x408b51(0x21d),'UqJqd':_0x3eb386[_0x408b51(0x13a)],'oAetb':function(_0x3b21b7,_0x3e72b5){const _0x4138cf=_0x408b51;return _0x3eb386[_0x4138cf(0x155)](_0x3b21b7,_0x3e72b5);},'ZdXdP':_0x408b51(0x17b),'dmlRe':function(_0x4d6c04,_0x22db30){return _0x4d6c04(_0x22db30);},'jmzsi':_0x3eb386['pfTwQ'],'UcApF':_0x3eb386['nkeHX'],'SqxZV':function(_0x499a12,_0x431504){const _0x52e7a6=_0x408b51;return _0x3eb386[_0x52e7a6(0x163)](_0x499a12,_0x431504);},'IPnNJ':_0x3eb386[_0x408b51(0xa0)],'VQlKj':function(_0x25214c,_0x68d802){const _0x1c50c3=_0x408b51;return _0x3eb386[_0x1c50c3(0x163)](_0x25214c,_0x68d802);},'qzrpE':'sha1','VldNv':function(_0x516bb0,_0x499e06){const _0x309708=_0x408b51;return _0x3eb386[_0x309708(0x155)](_0x516bb0,_0x499e06);},'kGUHF':function(_0x1b72fb,_0x21e997){return _0x1b72fb-_0x21e997;},'SzzyM':_0x3eb386[_0x408b51(0x1b1)],'cgLms':_0x3eb386[_0x408b51(0x168)],'pKXho':function(_0x5890a5,_0x556833){return _0x5890a5-_0x556833;},'tfcYH':_0x408b51(0x1a9),'MxWIe':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20ext=\x22hello\x22','ZDswH':_0x408b51(0x12c),'AxQbq':function(_0x476545,_0x3868b2,_0x428f33){const _0x5b4509=_0x408b51;return _0x3eb386[_0x5b4509(0x1f7)](_0x476545,_0x3868b2,_0x428f33);},'zoHvG':'Bad\x20header\x20format','FAPOU':_0x3eb386[_0x408b51(0x156)],'qSynt':_0x3eb386['fdyVT'],'CPIPz':_0x3eb386[_0x408b51(0xe8)],'DLNoa':_0x3eb386[_0x408b51(0xfe)],'uvLvT':_0x408b51(0x1d1),'UBRti':_0x408b51(0xf8),'CTRAH':'EDHdU','ONYPx':function(_0x177b58,_0x1ea9ce){const _0x898133=_0x408b51;return _0x3eb386[_0x898133(0x109)](_0x177b58,_0x1ea9ce);},'FMYyq':_0x408b51(0x183),'uetDk':_0x408b51(0x211),'rEhEC':_0x408b51(0x208),'ymqoT':_0x3eb386[_0x408b51(0xd3)],'YgnSg':_0x3eb386[_0x408b51(0x135)],'XIHFv':function(_0x302e73,_0x395641){const _0x56f824=_0x408b51;return _0x3eb386[_0x56f824(0x122)](_0x302e73,_0x395641);},'FILtQ':_0x3eb386['fMVCq'],'ckvgb':_0x408b51(0x1f9),'DmqLq':_0x408b51(0x1c7),'ypVJY':function(_0x1f0388,_0x2d9f59){const _0x2f6c64=_0x408b51;return _0x3eb386[_0x2f6c64(0x164)](_0x1f0388,_0x2d9f59);},'DJBnH':_0x408b51(0x1ec),'nbAQJ':_0x3eb386[_0x408b51(0x120)]};_0x3eb386[_0x408b51(0x22f)](it,_0x3eb386[_0x408b51(0x1f6)],async()=>{const _0x3708da=_0x408b51,_0x4c6a9b={'method':'GET','url':_0x3708da(0x137),'host':_0x3eb386[_0x3708da(0x1fb)],'port':0x1f90,'authorization':_0x3708da(0x13e)},{credentials:_0xfa0ada}=await Hawk['server'][_0x3708da(0x146)](_0x4c6a9b,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x3708da(0x10a)]['now']()});expect(_0xfa0ada[_0x3708da(0xeb)])['to'][_0x3708da(0x110)](_0x3eb386[_0x3708da(0x216)]);}),it(_0x408b51(0x134),async()=>{const _0x485cd7=_0x408b51,_0x315379={'method':_0x485cd7(0x18a),'url':_0x3eb386['OgvMm'],'host':_0x485cd7(0x223),'port':0x1f40,'authorization':_0x485cd7(0x15f)},{credentials:_0x5cbe8d}=await Hawk[_0x485cd7(0x143)][_0x485cd7(0x146)](_0x315379,_0x14a561,{'localtimeOffsetMsec':_0x3eb386[_0x485cd7(0xbd)](0x13b36b07c10,Hawk[_0x485cd7(0x10a)][_0x485cd7(0x136)]())});expect(_0x5cbe8d['user'])['to']['equal'](_0x485cd7(0xf1));}),it(_0x408b51(0xa1),async()=>{const _0x39e1ef=_0x408b51,_0x676e5b={'method':_0x39e1ef(0x18a),'url':'/resource/4?filter=a','headers':{'host':'example1.com:8080','authorization':_0x306daf[_0x39e1ef(0x161)]}},{credentials:_0x1dd685}=await Hawk[_0x39e1ef(0x143)][_0x39e1ef(0x146)](_0x676e5b,_0x14a561,{'host':_0x306daf[_0x39e1ef(0xdc)],'localtimeOffsetMsec':_0x306daf[_0x39e1ef(0x162)](0x13b34143208,Hawk[_0x39e1ef(0x10a)][_0x39e1ef(0x136)]())});_0x306daf[_0x39e1ef(0x15c)](expect,_0x1dd685[_0x39e1ef(0xeb)])['to'][_0x39e1ef(0x110)]('steve');}),it(_0x408b51(0xbf),async()=>{const _0x1809b0=_0x408b51,_0x164d6e={'method':_0x1809b0(0x18a),'url':_0x1809b0(0x137),'headers':{'host':_0x1809b0(0xb2),'authorization':'Hawk\x20id=\x221\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22zy79QQ5/EYFmQqutVnYb73gAc/U=\x22,\x20ext=\x22hello\x22'}},{credentials:_0x44a3f0}=await Hawk[_0x1809b0(0x143)][_0x1809b0(0x146)](_0x164d6e,_0x14a561,{'host':_0x3eb386[_0x1809b0(0x1fb)],'port':0x1f90,'localtimeOffsetMsec':0x13b34143208-Hawk[_0x1809b0(0x10a)][_0x1809b0(0x136)]()});_0x3eb386[_0x1809b0(0xc5)](expect,_0x44a3f0[_0x1809b0(0xeb)])['to'][_0x1809b0(0x110)](_0x3eb386[_0x1809b0(0x216)]);}),it(_0x3eb386['sFHTF'],async()=>{const _0x2697dd=_0x408b51,_0x52ffca={'method':_0x2697dd(0x21c),'url':_0x306daf['lJUDp'],'host':_0x2697dd(0x223),'port':0x1f90,'authorization':_0x306daf[_0x2697dd(0x21f)]},{credentials:_0x377aec}=await Hawk[_0x2697dd(0x143)][_0x2697dd(0x146)](_0x52ffca,_0x14a561,{'localtimeOffsetMsec':0x13c2ab79988-Hawk[_0x2697dd(0x10a)]['now']()});expect(_0x377aec[_0x2697dd(0xeb)])['to'][_0x2697dd(0x110)](_0x306daf['WHFmW']);}),it(_0x3eb386[_0x408b51(0xe2)],async()=>{const _0xf287c1=_0x408b51,_0x11172d={'method':'GET','url':_0x306daf[_0xf287c1(0x20f)],'host':_0x306daf['IYloy'],'port':0x1f40,'authorization':'Hawk\x20id=\x22dh37fgj492je\x22,\x20ts=\x221353832234\x22,\x20nonce=\x22j4h3g2\x22,\x20mac=\x22m8r1rHbXN6NgO+KIIhjO7sFRyd78RNGVUwehe8Cp2dU=\x22,\x20ext=\x22some-app-data\x22'};await _0x306daf[_0xf287c1(0x191)](expect,Hawk[_0xf287c1(0x143)][_0xf287c1(0x146)](_0x11172d,_0x14a561,{'payload':_0x306daf[_0xf287c1(0x1ab)],'localtimeOffsetMsec':0x13b36b07c10-Hawk[_0xf287c1(0x10a)]['now']()}))['to'][_0xf287c1(0x13f)](_0x306daf['KVbhO']);}),_0x3eb386[_0x408b51(0x22f)](it,_0x408b51(0x233),async()=>{const _0x23c17b=_0x408b51,_0x5ed250={'method':_0x306daf[_0x23c17b(0x166)],'url':_0x306daf['YhUYv'],'host':_0x306daf[_0x23c17b(0xdc)],'port':0x1f40,'authorization':_0x23c17b(0x15f)};await expect(Hawk[_0x23c17b(0x143)]['authenticate'](_0x5ed250,_0x14a561,{'payload':'','localtimeOffsetMsec':_0x306daf[_0x23c17b(0x162)](0x13b36b07c10,Hawk['utils'][_0x23c17b(0x136)]())}))['to'][_0x23c17b(0x13f)](_0x23c17b(0x21d));}),it(_0x408b51(0x127),async()=>{const _0x35ebcd=_0x408b51,_0x1ad105={'method':_0x3eb386[_0x35ebcd(0x13a)],'url':_0x3eb386['wJujK'],'host':_0x35ebcd(0x223),'port':0x1f90,'authorization':_0x35ebcd(0x1e7)},_0x27b333=await _0x3eb386[_0x35ebcd(0x9d)](expect,Hawk[_0x35ebcd(0x143)][_0x35ebcd(0x146)](_0x1ad105,_0x14a561))['to']['reject'](_0x35ebcd(0x194)),_0x5cd4bb=_0x27b333[_0x35ebcd(0x1c9)]['headers'][_0x35ebcd(0x1dd)],_0xa544c=_0x5cd4bb[_0x35ebcd(0x9c)](/^Hawk ts\=\"(\d+)\"\, tsm\=\"([^\"]+)\"\, error=\"Stale timestamp\"$/),_0x2345a9=Hawk[_0x35ebcd(0x10a)][_0x35ebcd(0x136)]();_0x3eb386[_0x35ebcd(0x12a)](expect,_0x3eb386[_0x35ebcd(0x19a)](_0x3eb386[_0x35ebcd(0x13c)](parseInt,_0xa544c[0x1],0xa),0x3e8))['to']['be'][_0x35ebcd(0xb0)](_0x2345a9-0x3e8,_0x2345a9+0x3e8);const _0x1f4cb0={'headers':{'www-authenticate':_0x5cd4bb}};expect(()=>Hawk['client'][_0x35ebcd(0x146)](_0x1f4cb0,_0x27b333[_0x35ebcd(0x99)],_0x27b333['artifacts']))['to'][_0x35ebcd(0xe9)][_0x35ebcd(0x1d6)]();}),_0x3eb386[_0x408b51(0x1f7)](it,_0x3eb386[_0x408b51(0x235)],async()=>{const _0x2a7779=_0x408b51,_0x596267={'method':_0x306daf[_0x2a7779(0x166)],'url':_0x306daf[_0x2a7779(0x16c)],'host':_0x306daf[_0x2a7779(0xdc)],'port':0x1f90,'authorization':_0x306daf[_0x2a7779(0x112)]},_0x1e25e0={},_0x37df76={'localtimeOffsetMsec':0x13b34143208-Hawk[_0x2a7779(0x10a)]['now'](),'nonceFunc':function(_0x17a082,_0x496d21,_0x54babd){if(_0x1e25e0[_0x17a082+_0x496d21])throw new Error();_0x1e25e0[_0x306daf['oAetb'](_0x17a082,_0x496d21)]=!![];}},{credentials:_0x1731e7}=await Hawk[_0x2a7779(0x143)][_0x2a7779(0x146)](_0x596267,_0x14a561,_0x37df76);expect(_0x1731e7[_0x2a7779(0xeb)])['to'][_0x2a7779(0x110)](_0x306daf['WHFmW']),await _0x306daf[_0x2a7779(0x1dc)](expect,Hawk[_0x2a7779(0x143)]['authenticate'](_0x596267,_0x14a561,_0x37df76))['to'][_0x2a7779(0x13f)](_0x306daf[_0x2a7779(0x11d)]);}),_0x3eb386[_0x408b51(0x22f)](it,'does\x20not\x20error\x20on\x20nonce\x20collision\x20if\x20keys\x20differ',async()=>{const _0x42d143=_0x408b51,_0x2b7146={'method':_0x42d143(0x18a),'url':'/resource/4?filter=a','host':_0x42d143(0x223),'port':0x1f90,'authorization':_0x42d143(0x17b)},_0xd17e14={'method':_0x3eb386[_0x42d143(0x13a)],'url':'/resource/4?filter=a','host':_0x3eb386['cyxbw'],'port':0x1f90,'authorization':_0x3eb386[_0x42d143(0xf6)]},_0x221a81=function(_0x44ae97){const _0x506144=_0x42d143,_0x1d37ec={'123':{'id':_0x44ae97,'key':_0x306daf[_0x506144(0xa7)],'algorithm':_0x306daf[_0x506144(0x125)](_0x44ae97,'1')?'sha1':_0x306daf[_0x506144(0x1db)],'user':_0x506144(0xf1)},'456':{'id':_0x44ae97,'key':_0x506144(0x9f),'algorithm':_0x306daf['VQlKj'](_0x44ae97,'1')?_0x306daf[_0x506144(0xb6)]:_0x506144(0x1a3),'user':'bob'}};return setInterval(_0x506144(0x179),0x3e8),_0x1d37ec[_0x44ae97];},_0x388776={},_0x24be57={'localtimeOffsetMsec':0x13b34143208-Hawk[_0x42d143(0x10a)][_0x42d143(0x136)](),'nonceFunc':function(_0x5f13dc,_0x137a80,_0xb65516){const _0x2a401f=_0x42d143;if(_0x388776[_0x5f13dc+_0x137a80])throw new Error();_0x388776[_0x306daf[_0x2a401f(0x1b2)](_0x5f13dc,_0x137a80)]=!![];}},{credentials:_0x173970}=await Hawk['server']['authenticate'](_0x2b7146,_0x221a81,_0x24be57);_0x3eb386[_0x42d143(0x12a)](expect,_0x173970['user'])['to']['equal']('steve');const {credentials:_0x5cbd31}=await Hawk[_0x42d143(0x143)][_0x42d143(0x146)](_0xd17e14,_0x221a81,_0x24be57);_0x3eb386['mALTz'](expect,_0x5cbd31[_0x42d143(0xeb)])['to'][_0x42d143(0x110)](_0x3eb386['Ejwjo']);}),it('errors\x20on\x20an\x20invalid\x20authentication\x20header:\x20wrong\x20scheme',async()=>{const _0x48e843=_0x408b51,_0x4b5dec={'method':_0x48e843(0x18a),'url':_0x48e843(0x137),'host':_0x306daf[_0x48e843(0xdc)],'port':0x1f90,'authorization':_0x48e843(0x10d)};await _0x306daf[_0x48e843(0x1dc)](expect,Hawk['server']['authenticate'](_0x4b5dec,_0x14a561,{'localtimeOffsetMsec':_0x306daf[_0x48e843(0x16d)](0x13b34143208,Hawk[_0x48e843(0x10a)][_0x48e843(0x136)]())}))['to'][_0x48e843(0x13f)]('Unauthorized');}),it(_0x3eb386['BLzcD'],async()=>{const _0x5c63f4=_0x408b51,_0x38106f={'method':'GET','url':_0x5c63f4(0x137),'host':_0x5c63f4(0x223),'port':0x1f90,'authorization':_0x5c63f4(0xb9)};await expect(Hawk['server'][_0x5c63f4(0x146)](_0x38106f,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x5c63f4(0x10a)][_0x5c63f4(0x136)]()}))['to'][_0x5c63f4(0x13f)](_0x306daf[_0x5c63f4(0x1f2)]);}),_0x3eb386[_0x408b51(0x13c)](it,_0x408b51(0x157),async()=>{const _0x137355=_0x408b51,_0xbca786={'method':_0x3eb386[_0x137355(0x13a)],'url':_0x137355(0x137),'host':_0x3eb386[_0x137355(0x1fb)],'port':0x1f90},_0x53f2da=await expect(Hawk[_0x137355(0x143)][_0x137355(0x146)](_0xbca786,_0x14a561))['to'][_0x137355(0x13f)]();expect(_0x53f2da[_0x137355(0x188)])['to'][_0x137355(0x110)](!![]);}),it('errors\x20on\x20an\x20missing\x20host\x20header',async()=>{const _0x41e11d=_0x408b51,_0x4c7f5b={'method':_0x41e11d(0x18a),'url':_0x3eb386[_0x41e11d(0x1eb)],'headers':{'authorization':_0x3eb386[_0x41e11d(0xb4)]}};await _0x3eb386[_0x41e11d(0x9d)](expect,Hawk[_0x41e11d(0x143)][_0x41e11d(0x146)](_0x4c7f5b,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x41e11d(0x10a)][_0x41e11d(0x136)]()}))['to']['reject'](_0x3eb386['qbNgh']);}),it(_0x3eb386[_0x408b51(0x1e6)],async()=>{const _0xe27ebd=_0x408b51,_0x355493={'method':_0xe27ebd(0x18a),'url':_0xe27ebd(0x137),'host':_0xe27ebd(0x223),'port':0x1f90,'authorization':_0xe27ebd(0x129)};await expect(Hawk['server'][_0xe27ebd(0x146)](_0x355493,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0xe27ebd(0x10a)][_0xe27ebd(0x136)]()}))['to']['reject'](_0xe27ebd(0x1a9));}),_0x3eb386[_0x408b51(0x1f7)](it,_0x408b51(0x1a7),async()=>{const _0x2bae24=_0x408b51;if(_0x306daf[_0x2bae24(0x15e)]!==_0x306daf[_0x2bae24(0x15e)])_0x664083['PI']*0x2;else{const _0x299352={'method':_0x306daf[_0x2bae24(0x166)],'url':_0x2bae24(0x137),'host':_0x306daf[_0x2bae24(0xdc)],'port':0x1f90,'authorization':_0x2bae24(0x20e)};await expect(Hawk['server']['authenticate'](_0x299352,_0x14a561,{'localtimeOffsetMsec':_0x306daf[_0x2bae24(0x1a0)](0x13b34143208,Hawk[_0x2bae24(0x10a)][_0x2bae24(0x136)]())}))['to'][_0x2bae24(0x13f)](_0x306daf[_0x2bae24(0x17f)]);}}),it(_0x3eb386[_0x408b51(0x184)],async()=>{const _0x54fc89=_0x408b51,_0x54b16f={'method':_0x3eb386[_0x54fc89(0x13a)],'url':_0x3eb386['wJujK'],'host':_0x54fc89(0x223),'port':0x1f90,'authorization':_0x3eb386[_0x54fc89(0x204)]};await expect(Hawk[_0x54fc89(0x143)][_0x54fc89(0x146)](_0x54b16f,_0x14a561,{'localtimeOffsetMsec':_0x3eb386[_0x54fc89(0x11b)](0x13b34143208,Hawk['utils'][_0x54fc89(0x136)]())}))['to'][_0x54fc89(0x13f)](_0x3eb386['DFGQF']);}),_0x3eb386[_0x408b51(0x22c)](it,_0x3eb386[_0x408b51(0x10f)],async()=>{const _0x50eb7d=_0x408b51,_0x5c4ed4={'method':_0x306daf['UqJqd'],'url':_0x306daf[_0x50eb7d(0x16c)],'host':'example.com','port':0x1f90,'authorization':_0x306daf['MxWIe']};await _0x306daf[_0x50eb7d(0x1dc)](expect,Hawk[_0x50eb7d(0x143)][_0x50eb7d(0x146)](_0x5c4ed4,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x50eb7d(0x10a)][_0x50eb7d(0x136)]()}))['to'][_0x50eb7d(0x13f)]('Missing\x20attributes');}),_0x3eb386[_0x408b51(0xdb)](it,'errors\x20on\x20an\x20unknown\x20authorization\x20attribute',async()=>{const _0x58d853=_0x408b51;if(_0x58d853(0x225)===_0x58d853(0x225)){const _0x1cf3d1={'method':_0x3eb386[_0x58d853(0x13a)],'url':_0x3eb386[_0x58d853(0x1eb)],'host':_0x3eb386[_0x58d853(0x1fb)],'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20x=\x223\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'};await expect(Hawk[_0x58d853(0x143)][_0x58d853(0x146)](_0x1cf3d1,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x58d853(0x10a)]['now']()}))['to'][_0x58d853(0x13f)](_0x58d853(0x165));}else{const _0x19e5d9={'JdPep':_0x306daf[_0x58d853(0xda)]};return _0x306daf[_0x58d853(0x17e)](_0x5d30ef,function(){const _0x5672e4=_0x58d853;_0x29c40b[_0x5672e4(0x217)](_0x19e5d9[_0x5672e4(0x19e)]);},0x64),{'id':_0x58d853(0xea),'user':_0x306daf[_0x58d853(0x1b0)]};}}),it(_0x3eb386['wStEk'],async()=>{const _0xcb6291=_0x408b51,_0x397587={'method':_0x306daf[_0xcb6291(0x166)],'url':_0xcb6291(0x137),'host':_0xcb6291(0x223),'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x5c\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'};await expect(Hawk[_0xcb6291(0x143)][_0xcb6291(0x146)](_0x397587,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0xcb6291(0x10a)]['now']()}))['to'][_0xcb6291(0x13f)](_0x306daf['zoHvG']);}),it(_0x408b51(0x213),async()=>{const _0x7ab763=_0x408b51,_0x244aba={'method':_0x306daf[_0x7ab763(0x166)],'url':_0x306daf['lJUDp'],'host':_0x7ab763(0x223),'port':0x1f90,'authorization':_0x306daf[_0x7ab763(0x1bb)]};await expect(Hawk[_0x7ab763(0x143)][_0x7ab763(0x146)](_0x244aba,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x7ab763(0x10a)][_0x7ab763(0x136)]()}))['to'][_0x7ab763(0x13f)](_0x306daf['qSynt']);}),_0x3eb386[_0x408b51(0x22f)](it,_0x408b51(0x210),async()=>{const _0x5e4a8f=_0x408b51;if(_0x306daf[_0x5e4a8f(0x1f0)]!==_0x5e4a8f(0x1ca)){const _0x32d18d={'method':_0x306daf['UqJqd'],'url':_0x306daf[_0x5e4a8f(0x16c)],'host':_0x306daf['IYloy'],'port':0x1f90,'authorization':_0x5e4a8f(0x150)};await _0x306daf[_0x5e4a8f(0x103)](expect,Hawk['server'][_0x5e4a8f(0x146)](_0x32d18d,_0x14a561,{'localtimeOffsetMsec':_0x306daf[_0x5e4a8f(0x1a0)](0x13b34143208,Hawk[_0x5e4a8f(0x10a)][_0x5e4a8f(0x136)]())}))['to'][_0x5e4a8f(0x13f)](_0x306daf[_0x5e4a8f(0x189)]);}else{const _0x580ecb={'id':_0x306daf[_0x5e4a8f(0x190)],'algorithm':_0x306daf[_0x5e4a8f(0x1db)],'user':_0x306daf[_0x5e4a8f(0x1b0)]},_0x20ea1f={'method':_0x5e4a8f(0x21c),'host':_0x306daf[_0x5e4a8f(0xdc)],'port':_0x306daf[_0x5e4a8f(0x20a)],'resource':_0x5e4a8f(0x137),'ts':'1398546787','nonce':_0x5e4a8f(0x20b),'hash':_0x5e4a8f(0xad),'ext':_0x5e4a8f(0xd8),'mac':_0x306daf[_0x5e4a8f(0x1a4)],'id':_0x5e4a8f(0x1c6)};_0x5f2cca(()=>_0xd2f392[_0x5e4a8f(0x143)][_0x5e4a8f(0x228)](_0x580ecb,_0x20ea1f,{'payload':'some\x20reply','contentType':_0x5e4a8f(0x9b),'ext':_0x5e4a8f(0x1d7)}))['to'][_0x5e4a8f(0x1d6)](_0x306daf[_0x5e4a8f(0x1e4)]);}}),_0x3eb386[_0x408b51(0x22f)](it,_0x408b51(0x9e),async()=>{const _0x2aea93=_0x408b51,_0x4ebf0e={'method':_0x2aea93(0x18a),'url':_0x306daf['lJUDp'],'host':_0x2aea93(0x223),'port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20id=\x22456\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'};await expect(Hawk[_0x2aea93(0x143)][_0x2aea93(0x146)](_0x4ebf0e,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x2aea93(0x10a)][_0x2aea93(0x136)]()}))['to'][_0x2aea93(0x13f)](_0x306daf[_0x2aea93(0x1b4)]);}),it(_0x3eb386[_0x408b51(0x218)],async()=>{const _0x406756=_0x408b51,_0x5a6886={'method':_0x3eb386[_0x406756(0x13a)],'url':_0x406756(0x137),'host':_0x3eb386['cyxbw'],'port':0x1f90,'authorization':_0x406756(0xf9)};await expect(Hawk[_0x406756(0x143)][_0x406756(0x146)](_0x5a6886,_0x14a561,{'localtimeOffsetMsec':_0x3eb386[_0x406756(0xbd)](0x13b34143208,Hawk[_0x406756(0x10a)][_0x406756(0x136)]())}))['to']['reject'](_0x3eb386['Sszuo']);}),_0x3eb386[_0x408b51(0xfb)](it,_0x3eb386[_0x408b51(0x11f)],async()=>{const _0x5d8078=_0x408b51,_0x377328={'method':_0x3eb386['mpTtP'],'url':_0x3eb386[_0x5d8078(0x1eb)],'headers':{'host':':8080','authorization':_0x5d8078(0x1c7)}};await _0x3eb386[_0x5d8078(0x12a)](expect,Hawk[_0x5d8078(0x143)][_0x5d8078(0x146)](_0x377328,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk['utils']['now']()}))['to'][_0x5d8078(0x13f)](_0x3eb386[_0x5d8078(0x23e)]);}),_0x3eb386['RnLYF'](it,_0x408b51(0xac),async()=>{const _0x4c60c4=_0x408b51,_0x3efc13={'method':_0x3eb386[_0x4c60c4(0x13a)],'url':_0x4c60c4(0x137),'headers':{'host':_0x3eb386[_0x4c60c4(0x239)],'authorization':_0x3eb386[_0x4c60c4(0xb4)]}};await _0x3eb386[_0x4c60c4(0x12a)](expect,Hawk[_0x4c60c4(0x143)][_0x4c60c4(0x146)](_0x3efc13,_0x14a561,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x4c60c4(0x10a)][_0x4c60c4(0x136)]()}))['to'][_0x4c60c4(0x13f)](_0x3eb386[_0x4c60c4(0x23e)]);}),it(_0x3eb386['dCVbw'],async()=>{const _0x7d6d54=_0x408b51,_0x2c5270={'yaooN':'value'};if(_0x3eb386[_0x7d6d54(0x12d)]===_0x3eb386[_0x7d6d54(0x12d)]){const _0x17a2f8={'method':'GET','url':_0x3eb386[_0x7d6d54(0x1eb)],'host':'example.com','port':0x1f90,'authorization':_0x3eb386[_0x7d6d54(0xb4)]},_0x521c3a=function(_0x49cb58){const _0x2d29d6=_0x7d6d54;throw new Error(_0x306daf[_0x2d29d6(0x1cd)]);};await _0x3eb386['JakEu'](expect,Hawk[_0x7d6d54(0x143)][_0x7d6d54(0x146)](_0x17a2f8,_0x521c3a,{'localtimeOffsetMsec':_0x3eb386[_0x7d6d54(0xbd)](0x13b34143208,Hawk[_0x7d6d54(0x10a)]['now']())}))['to'][_0x7d6d54(0x13f)](_0x7d6d54(0x211));}else{const _0x263025=new _0x39164e(_0x7d6d54(0x211));_0x263025[_0x7d6d54(0x99)]={'some':_0x2c5270[_0x7d6d54(0xc9)]};throw _0x263025;}}),it(_0x3eb386['jwPQN'],async()=>{const _0x100b7e=_0x408b51,_0x4a2e67={'method':_0x306daf[_0x100b7e(0x166)],'url':'/resource/4?filter=a','host':'example.com','port':0x1f90,'authorization':'Hawk\x20id=\x22123\x22,\x20ts=\x221353788437\x22,\x20nonce=\x22k3j4h2\x22,\x20mac=\x22/qwS4UjfVWMcUyW6EEgUH4jlr7T/wuKe3dKijvTvSos=\x22,\x20ext=\x22hello\x22'},_0x4a8483=function(_0x5d128b){const _0xcab3a9=_0x100b7e,_0x10d6ee=new Error('Unknown\x20user');_0x10d6ee['credentials']={'some':_0xcab3a9(0x23f)};throw _0x10d6ee;},_0x57ea19=await _0x306daf[_0x100b7e(0x15c)](expect,Hawk[_0x100b7e(0x143)][_0x100b7e(0x146)](_0x4a2e67,_0x4a8483,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x100b7e(0x10a)][_0x100b7e(0x136)]()}))['to'][_0x100b7e(0x13f)](_0x306daf[_0x100b7e(0x1cd)]);expect(_0x57ea19['credentials'][_0x100b7e(0x14f)])['to'][_0x100b7e(0x110)](_0x100b7e(0x23f));}),it('errors\x20on\x20missing\x20credentials',async()=>{const _0x223dfe=_0x408b51,_0x292c97={'method':'GET','url':_0x223dfe(0x137),'host':_0x223dfe(0x223),'port':0x1f90,'authorization':_0x3eb386[_0x223dfe(0xb4)]},_0x194713=function(_0x122e66){return setTimeout('console.log(\x22timer\x22);',0x3e8),null;};await expect(Hawk[_0x223dfe(0x143)][_0x223dfe(0x146)](_0x292c97,_0x194713,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x223dfe(0x10a)]['now']()}))['to'][_0x223dfe(0x13f)](_0x223dfe(0x206));}),it('errors\x20on\x20invalid\x20credentials\x20(id)',async()=>{const _0x2e519f=_0x408b51,_0x55994e={'SrsNK':_0x306daf['UcApF'],'ScYgo':_0x306daf['WHFmW']};if(_0x306daf[_0x2e519f(0xcc)](_0x306daf[_0x2e519f(0xa6)],_0x2e519f(0xc0))){const _0x484031={'method':'POST','host':'example.com','port':_0x306daf[_0x2e519f(0x20a)],'resource':_0x306daf['lJUDp'],'ts':_0x306daf[_0x2e519f(0xbe)],'nonce':_0x2e519f(0x20b),'hash':_0x306daf[_0x2e519f(0x132)],'ext':_0x306daf[_0x2e519f(0x152)],'mac':_0x2e519f(0x1d1),'id':'123456'};_0x442d31(()=>_0x1c95a6[_0x2e519f(0x143)]['header'](null,_0x484031,{'payload':_0x2e519f(0x9a),'contentType':'text/plain','ext':_0x2e519f(0x1d7)}))['to'][_0x2e519f(0x1d6)](_0x306daf['UBRti']);}else{const _0x2e8632={'method':_0x306daf[_0x2e519f(0x166)],'url':_0x2e519f(0x137),'host':_0x306daf[_0x2e519f(0xdc)],'port':0x1f90,'authorization':_0x2e519f(0x1c7)},_0x1f0c12=function(_0x5dd1ac){const _0x358d1b=_0x2e519f;return eval('Math[\'PI\'] * 2;'),{'key':_0x55994e[_0x358d1b(0x114)],'user':_0x55994e[_0x358d1b(0xf2)]};},_0x491bac=await expect(Hawk[_0x2e519f(0x143)]['authenticate'](_0x2e8632,_0x1f0c12,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x2e519f(0x10a)][_0x2e519f(0x136)]()}))['to']['reject'](_0x306daf['UBRti']);expect(_0x491bac['output'][_0x2e519f(0x1bd)][_0x2e519f(0x209)])['to'][_0x2e519f(0x110)](_0x306daf[_0x2e519f(0x172)]);}}),it(_0x408b51(0x237),async()=>{const _0x5d36cb=_0x408b51,_0x1ff647={'emmZH':function(_0x4f2157,_0x1c25ae,_0xbbeafe){const _0x18c9f3=_0x5dbf;return _0x306daf[_0x18c9f3(0x17e)](_0x4f2157,_0x1c25ae,_0xbbeafe);}},_0xdccf91={'method':'GET','url':_0x306daf[_0x5d36cb(0x16c)],'host':_0x5d36cb(0x223),'port':0x1f90,'authorization':_0x306daf['DmqLq']},_0x541691=function(_0x4bc730){const _0x5efa97=_0x5d36cb;return _0x1ff647[_0x5efa97(0x199)](setTimeout,function(){const _0x42a154=_0x5efa97;console[_0x42a154(0x217)](_0x42a154(0x12c));},0x64),{'id':_0x5efa97(0xea),'user':'steve'};},_0x446061=await expect(Hawk['server'][_0x5d36cb(0x146)](_0xdccf91,_0x541691,{'localtimeOffsetMsec':_0x306daf[_0x5d36cb(0x162)](0x13b34143208,Hawk[_0x5d36cb(0x10a)]['now']())}))['to'][_0x5d36cb(0x13f)](_0x5d36cb(0xf8));expect(_0x446061[_0x5d36cb(0x1c9)][_0x5d36cb(0x1bd)][_0x5d36cb(0x209)])['to'][_0x5d36cb(0x110)](_0x5d36cb(0x1f9));}),it(_0x408b51(0xd2),async()=>{const _0x5a62aa=_0x408b51,_0x378862={'oTSBT':_0x3eb386[_0x5a62aa(0x216)],'GAkkC':_0x5a62aa(0xf8)};if(_0x3eb386[_0x5a62aa(0x16f)]==='RPRBP'){const _0xf5435f={'method':_0x5a62aa(0x18a),'url':_0x3eb386[_0x5a62aa(0x1eb)],'host':_0x3eb386[_0x5a62aa(0x1fb)],'port':0x1f90,'authorization':_0x5a62aa(0x1c7)},_0x417d6d=function(_0x5bb16a){const _0x1da588=_0x5a62aa;return setTimeout(_0x1da588(0xcd),0x3e8),{'key':_0x1da588(0xa3),'algorithm':_0x1da588(0x23a),'user':_0x378862[_0x1da588(0x198)]};},_0x33faf6=await _0x3eb386[_0x5a62aa(0x1d4)](expect,Hawk[_0x5a62aa(0x143)][_0x5a62aa(0x146)](_0xf5435f,_0x417d6d,{'localtimeOffsetMsec':0x13b34143208-Hawk[_0x5a62aa(0x10a)]['now']()}))['to'][_0x5a62aa(0x13f)](_0x3eb386[_0x5a62aa(0x104)]);expect(_0x33faf6[_0x5a62aa(0x1c9)][_0x5a62aa(0x1bd)][_0x5a62aa(0x209)])['to'][_0x5a62aa(0x110)](_0x3eb386[_0x5a62aa(0x12e)]);}else _0x552ed4(()=>_0xd495e2['client'][_0x5a62aa(0x209)](_0x5a62aa(0x223),0x1f90,'some\x20message'))['to'][_0x5a62aa(0x1d6)](_0x378862[_0x5a62aa(0x1ed)]);}),it('errors\x20on\x20unknown\x20bad\x20mac',async()=>{const _0x42bb55=_0x408b51,_0x54c0c5={'MrVjR':function(_0x5beb8c,_0x211607){return _0x306daf['ypVJY'](_0x5beb8c,_0x211607);},'xsXdW':_0x42bb55(0x1cb),'GItvQ':function(_0x82a561,_0x47a3c8,_0x1e0aa2){return _0x82a561(_0x47a3c8,_0x1e0aa2);},'YAvwx':_0x306daf[_0x42bb55(0xa7)],'XJLVd':'sha256'},_0x229153={'method':_0x306daf[_0x42bb55(0x166)],'url':_0x42bb55(0x137),'host':_0x306daf[_0x42bb55(0xdc)],'port':0x1f90,'authorization':_0x306daf[_0x42bb55(0xaa)]},_0x1fd7de=function(_0x3649f4){const _0x2b2746=_0x42bb55,_0x1aa841={'MVxvW':function(_0xfe1880,_0x3b3fde){const _0x2fd120=_0x5dbf;return _0x54c0c5[_0x2fd120(0xc1)](_0xfe1880,_0x3b3fde);},'WpxQk':_0x2b2746(0xd1)};if(_0x2b2746(0x1d5)===_0x54c0c5[_0x2b2746(0xb3)]){const _0x5456e7={'QOUzt':function(_0x1484d5,_0x5981f1){const _0x2fb8a4=_0x2b2746;return _0x1aa841[_0x2fb8a4(0x222)](_0x1484d5,_0x5981f1);}};return eval('const _0x5b699a = _0x2b2746;_0x5456e7[_0x5b699a(386)](_0x5b8da9[\'PI\'], 2);'),{'key':_0x1aa841[_0x2b2746(0xe4)]};}else return _0x54c0c5[_0x2b2746(0x1c8)](setTimeout,function(){const _0x1c02d1=_0x2b2746;console[_0x1c02d1(0x217)](_0x1c02d1(0x12c));},0x64),{'key':_0x54c0c5[_0x2b2746(0x12f)],'algorithm':_0x54c0c5[_0x2b2746(0xd4)],'user':'steve'};};await _0x306daf[_0x42bb55(0x103)](expect,Hawk[_0x42bb55(0x143)][_0x42bb55(0x146)](_0x229153,_0x1fd7de,{'localtimeOffsetMsec':_0x306daf[_0x42bb55(0x16d)](0x13b34143208,Hawk[_0x42bb55(0x10a)][_0x42bb55(0x136)]())}))['to']['reject'](_0x306daf[_0x42bb55(0xe6)]);});}),_0x3eb386['mWQnd'](describe,_0xb513f0(0x1e1),()=>{const _0x2256a0=_0xb513f0,_0x132f30={'XXvRj':_0x2256a0(0x1c6),'XsACK':_0x3eb386[_0x2256a0(0xa0)],'IvQEZ':_0x3eb386[_0x2256a0(0x1df)],'YNDTk':'/resource/4?filter=a','NSctC':_0x2256a0(0x208),'oUwqW':_0x3eb386[_0x2256a0(0xcf)],'wckMy':_0x3eb386[_0x2256a0(0x135)],'wnXfd':_0x3eb386[_0x2256a0(0x151)],'AdIyP':_0x2256a0(0xf1),'XpLjW':_0x3eb386[_0x2256a0(0x1fb)],'oXVpb':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','KQrNy':_0x3eb386['oNXSI'],'EHVYJ':_0x3eb386[_0x2256a0(0xff)],'lamIP':_0x3eb386[_0x2256a0(0x1c4)],'qShpE':function(_0x45dffe,_0x17e3a1){const _0x237858=_0x2256a0;return _0x3eb386[_0x237858(0x109)](_0x45dffe,_0x17e3a1);},'EStgD':_0x3eb386[_0x2256a0(0x142)],'PQkuw':_0x2256a0(0xf8)};it(_0x2256a0(0x1d3),()=>{const _0x399593=_0x2256a0,_0x51b48b={'id':_0x399593(0x1c6),'key':_0x3eb386[_0x399593(0xc8)],'algorithm':_0x3eb386[_0x399593(0xa0)],'user':_0x399593(0xf1)},_0x47f43d={'method':_0x3eb386[_0x399593(0x1df)],'host':_0x399593(0x223),'port':_0x3eb386[_0x399593(0xfe)],'resource':_0x399593(0x137),'ts':'1398546787','nonce':_0x399593(0x20b),'hash':_0x399593(0xad),'ext':_0x3eb386[_0x399593(0x135)],'mac':_0x399593(0x1d1),'id':_0x399593(0x1c6)},_0x229246=Hawk[_0x399593(0x143)][_0x399593(0x228)](_0x51b48b,_0x47f43d,{'payload':_0x399593(0x9a),'contentType':_0x399593(0x9b),'ext':'response-specific'});expect(_0x229246)['to'][_0x399593(0x110)]('Hawk\x20mac=\x22n14wVJK4cOxAytPUMc5bPezQzuJGl5n7MYXhFQgEKsE=\x22,\x20hash=\x22f9cDF/TDm7TkYRLnGwRMfeDzT6LixQVLvrIKhh0vgmM=\x22,\x20ext=\x22response-specific\x22');}),it(_0x3eb386['ovSaV'],()=>{const _0x34c03f=_0x2256a0;if(_0x3eb386[_0x34c03f(0x122)](_0x3eb386['bJyTu'],_0x3eb386[_0x34c03f(0xb1)])){const _0x43bb7d={'id':_0x34c03f(0x1c6),'key':_0x34c03f(0xa3),'algorithm':_0x34c03f(0x1a3),'user':_0x3eb386[_0x34c03f(0x216)]},_0x352ea0={'method':_0x34c03f(0x21c),'host':_0x3eb386[_0x34c03f(0x1fb)],'port':_0x3eb386['WvurQ'],'resource':_0x3eb386['wJujK'],'ts':_0x3eb386['TiWwk'],'nonce':_0x3eb386[_0x34c03f(0xcf)],'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':_0x3eb386[_0x34c03f(0x135)],'mac':_0x34c03f(0x1d1),'id':_0x34c03f(0x1c6)},_0x3c4577=Hawk[_0x34c03f(0x143)][_0x34c03f(0x228)](_0x43bb7d,_0x352ea0,{'payload':'','contentType':_0x3eb386[_0x34c03f(0x102)],'ext':_0x3eb386[_0x34c03f(0xd0)]});expect(_0x3c4577)['to'][_0x34c03f(0x110)](_0x3eb386['aveox']);}else{const _0x17b292={'id':_0x132f30[_0x34c03f(0x177)],'algorithm':_0x132f30[_0x34c03f(0x231)],'user':_0x34c03f(0xf1)},_0x3dfbef={'method':_0x132f30['IvQEZ'],'host':_0x34c03f(0x223),'port':_0x34c03f(0x1b7),'resource':_0x132f30[_0x34c03f(0x1de)],'ts':_0x132f30[_0x34c03f(0x214)],'nonce':_0x132f30['oUwqW'],'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':_0x132f30[_0x34c03f(0x144)],'mac':_0x34c03f(0x1d1),'id':_0x132f30[_0x34c03f(0x177)]};_0x5c8061(()=>_0x19cf25['server'][_0x34c03f(0x228)](_0x17b292,_0x3dfbef,_0x34c03f(0x19d)))['to'][_0x34c03f(0x1d6)](_0x132f30[_0x34c03f(0xa9)]);}}),it(_0x3eb386[_0x2256a0(0xba)],()=>{const _0x452151=_0x2256a0,_0x5ab2a5={'id':_0x3eb386[_0x452151(0xe8)],'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':'sha256','user':_0x452151(0xf1)},_0x3a0901={'method':_0x3eb386[_0x452151(0x1df)],'host':_0x452151(0x223),'port':_0x3eb386[_0x452151(0xfe)],'resource':_0x3eb386[_0x452151(0x1eb)],'ts':_0x3eb386[_0x452151(0x14a)],'nonce':_0x452151(0x20b),'hash':_0x3eb386['ATPXR'],'ext':'','mac':_0x452151(0x1d1),'id':_0x3eb386[_0x452151(0xe8)]},_0x2b4032=Hawk['server']['header'](_0x5ab2a5,_0x3a0901,{'payload':'','contentType':_0x3eb386[_0x452151(0x102)],'ext':''});expect(_0x2b4032)['to'][_0x452151(0x110)](_0x3eb386[_0x452151(0x1f3)]);}),it(_0x3eb386[_0x2256a0(0x201)],()=>{const _0x371890=_0x2256a0,_0x569091={'id':_0x132f30[_0x371890(0x177)],'key':_0x371890(0xa3),'algorithm':_0x371890(0x1a3),'user':_0x132f30['AdIyP']},_0x216b8b={'method':_0x132f30[_0x371890(0x115)],'host':_0x132f30[_0x371890(0x197)],'port':'8080','resource':'/resource/4?filter=a','ts':_0x371890(0x208),'nonce':_0x371890(0x20b),'hash':_0x132f30['oXVpb'],'ext':'some-app-data','mac':_0x371890(0x1d1),'id':'123456'},_0x43674e={'payload':_0x132f30[_0x371890(0x106)],'contentType':_0x371890(0x9b),'ext':_0x371890(0x1d7)};_0x43674e[_0x371890(0x158)]=Hawk[_0x371890(0x124)][_0x371890(0x1ae)](_0x43674e['payload'],_0x569091['algorithm'],_0x43674e[_0x371890(0x17d)]);const _0x1534a5=Hawk[_0x371890(0x143)][_0x371890(0x228)](_0x569091,_0x216b8b,_0x43674e);expect(_0x1534a5)['to']['equal'](_0x132f30[_0x371890(0x15b)]);}),_0x3eb386[_0x2256a0(0x16e)](it,_0x3eb386[_0x2256a0(0x23d)],()=>{const _0x5dba60=_0x2256a0,_0x3ee05d={'id':_0x5dba60(0x1c6),'key':_0x5dba60(0xa3),'algorithm':_0x132f30[_0x5dba60(0x231)],'user':_0x5dba60(0xf1)},_0x15451c={'method':_0x132f30[_0x5dba60(0x115)],'host':_0x5dba60(0x223),'port':_0x5dba60(0x1b7),'resource':_0x5dba60(0x137),'ts':_0x5dba60(0x208),'nonce':_0x5dba60(0x20b),'hash':_0x132f30[_0x5dba60(0x221)],'mac':_0x5dba60(0x1d1),'id':'123456'},_0x11916e=Hawk[_0x5dba60(0x143)][_0x5dba60(0x228)](_0x3ee05d,_0x15451c,{'payload':_0x132f30[_0x5dba60(0x106)],'contentType':_0x5dba60(0x9b),'ext':null});expect(_0x11916e)['to']['equal'](_0x132f30['lamIP']);}),it(_0x2256a0(0x16a),()=>{const _0x1b7d30=_0x2256a0,_0x4f59a4={'id':_0x132f30[_0x1b7d30(0x177)],'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x132f30[_0x1b7d30(0x231)],'user':_0x132f30[_0x1b7d30(0xb5)]};_0x132f30[_0x1b7d30(0x1af)](expect,()=>Hawk[_0x1b7d30(0x143)][_0x1b7d30(0x228)](_0x4f59a4,null,{'payload':_0x1b7d30(0x9a),'contentType':'text/plain','ext':'response-specific'}))['to'][_0x1b7d30(0x1d6)](_0x1b7d30(0xca));}),it(_0x2256a0(0x1ee),()=>{const _0x3a3b2b=_0x2256a0,_0x19249f={'id':'123456','key':_0x3eb386[_0x3a3b2b(0xc8)],'algorithm':_0x3eb386[_0x3a3b2b(0xa0)],'user':_0x3eb386[_0x3a3b2b(0x216)]};expect(()=>Hawk[_0x3a3b2b(0x143)][_0x3a3b2b(0x228)](_0x19249f,0x5,{'payload':_0x3a3b2b(0x9a),'contentType':_0x3a3b2b(0x9b),'ext':_0x3a3b2b(0x1d7)}))['to'][_0x3a3b2b(0x1d6)](_0x3a3b2b(0xca));}),it(_0x2256a0(0x23c),()=>{const _0x305622=_0x2256a0,_0xe7d9cd={'method':'POST','host':_0x3eb386[_0x305622(0x1fb)],'port':_0x3eb386[_0x305622(0xfe)],'resource':'/resource/4?filter=a','ts':_0x3eb386[_0x305622(0x14a)],'nonce':_0x305622(0x20b),'hash':_0x305622(0xad),'ext':_0x3eb386['DjqCV'],'mac':_0x305622(0x1d1),'id':_0x305622(0x1c6)};expect(()=>Hawk[_0x305622(0x143)]['header'](null,_0xe7d9cd,{'payload':_0x305622(0x9a),'contentType':_0x305622(0x9b),'ext':_0x305622(0x1d7)}))['to']['throw'](_0x3eb386[_0x305622(0xc7)]);}),it(_0x2256a0(0x237),()=>{const _0x167b51=_0x2256a0,_0x2f40d4={'id':_0x3eb386[_0x167b51(0xe8)],'algorithm':_0x3eb386[_0x167b51(0xa0)],'user':_0x167b51(0xf1)},_0x409af0={'method':_0x3eb386[_0x167b51(0x1df)],'host':'example.com','port':_0x3eb386[_0x167b51(0xfe)],'resource':_0x167b51(0x137),'ts':_0x3eb386[_0x167b51(0x14a)],'nonce':'xUwusx','hash':_0x3eb386['ATPXR'],'ext':_0x3eb386[_0x167b51(0x135)],'mac':'dvIvMThwi28J61Jc3P0ryAhuKpanU63GXdx6hkmQkJA=','id':_0x167b51(0x1c6)};_0x3eb386[_0x167b51(0xab)](expect,()=>Hawk['server'][_0x167b51(0x228)](_0x2f40d4,_0x409af0,{'payload':_0x167b51(0x9a),'contentType':'text/plain','ext':_0x167b51(0x1d7)}))['to']['throw'](_0x167b51(0xf8));}),it(_0x2256a0(0x1b9),()=>{const _0x283cb5=_0x2256a0;if(_0x132f30['EStgD']===_0x283cb5(0x18f)){const _0x38509e={'id':_0x283cb5(0x1c6),'key':_0x283cb5(0xd1),'user':_0x283cb5(0xf1)},_0x3f5acd={'method':_0x132f30[_0x283cb5(0x115)],'host':_0x132f30[_0x283cb5(0x197)],'port':'8080','resource':'/resource/4?filter=a','ts':_0x132f30['NSctC'],'nonce':_0x283cb5(0x20b),'hash':'nJjkVtBE5Y/Bk38Aiokwn0jiJxt/0S2WRSUwWLCf5xk=','ext':_0x283cb5(0xd8),'mac':_0x283cb5(0x1d1),'id':_0x132f30[_0x283cb5(0x177)]};expect(()=>Hawk['server'][_0x283cb5(0x228)](_0x38509e,_0x3f5acd,{'payload':_0x283cb5(0x9a),'contentType':_0x283cb5(0x9b),'ext':_0x283cb5(0x1d7)}))['to']['throw'](_0x132f30[_0x283cb5(0x111)]);}else _0x13d5c9[_0x283cb5(0x217)](_0x283cb5(0x12c));}),_0x3eb386['mWQnd'](it,_0x3eb386['soNiR'],()=>{const _0x46a0b7=_0x2256a0,_0x98a886={'sEBDV':function(_0x86fe5,_0x2856b3,_0x356f8c){return _0x3eb386['inmCi'](_0x86fe5,_0x2856b3,_0x356f8c);},'cxDcp':_0x46a0b7(0xcd),'AApMG':_0x46a0b7(0xa3),'lFXOg':function(_0x2d97ea,_0x486cd7){return _0x2d97ea===_0x486cd7;},'kRqqa':_0x3eb386['HoMGs']};if(_0x3eb386[_0x46a0b7(0x122)]('fHiJy',_0x46a0b7(0xc3))){const _0x50adcc={'id':_0x3eb386[_0x46a0b7(0xe8)],'key':_0x46a0b7(0xa3),'algorithm':'x','user':_0x3eb386[_0x46a0b7(0x216)]},_0x4f8b20={'method':_0x46a0b7(0x21c),'host':'example.com','port':_0x46a0b7(0x1b7),'resource':_0x46a0b7(0x137),'ts':'1398546787','nonce':'xUwusx','hash':_0x46a0b7(0xad),'ext':_0x46a0b7(0xd8),'mac':_0x3eb386[_0x46a0b7(0x121)],'id':_0x46a0b7(0x1c6)};_0x3eb386[_0x46a0b7(0x109)](expect,()=>Hawk['server'][_0x46a0b7(0x228)](_0x50adcc,_0x4f8b20,{'payload':'some\x20reply','contentType':_0x46a0b7(0x9b),'ext':_0x46a0b7(0x1d7)}))['to'][_0x46a0b7(0x1d6)](_0x3eb386[_0x46a0b7(0x104)]);}else return _0x98a886[_0x46a0b7(0xd5)](_0x10888f,_0x98a886[_0x46a0b7(0x10c)],0x3e8),{'id':_0x54a750,'key':_0x98a886[_0x46a0b7(0x1be)],'algorithm':_0x98a886['lFXOg'](_0x414725,'1')?_0x46a0b7(0x215):_0x46a0b7(0x1a3),'user':_0x98a886['kRqqa']};}),_0x3eb386[_0x2256a0(0x22c)](it,_0x3eb386[_0x2256a0(0x234)],()=>{const _0x18aeca=_0x2256a0,_0x4aae8a={'id':_0x18aeca(0x1c6),'algorithm':_0x18aeca(0x1a3),'user':_0x3eb386[_0x18aeca(0x216)]},_0x1ada89={'method':_0x3eb386['OEGhT'],'host':_0x3eb386[_0x18aeca(0x1fb)],'port':_0x18aeca(0x1b7),'resource':_0x18aeca(0x137),'ts':'1398546787','nonce':_0x18aeca(0x20b),'hash':_0x3eb386[_0x18aeca(0xd3)],'ext':_0x18aeca(0xd8),'mac':_0x18aeca(0x1d1),'id':_0x18aeca(0x1c6)};expect(()=>Hawk[_0x18aeca(0x143)]['header'](_0x4aae8a,_0x1ada89,_0x18aeca(0x19d)))['to']['throw'](_0x18aeca(0xca));});}),_0x3eb386[_0xb513f0(0x229)](describe,'authenticateBewit()',()=>{const _0x5cbe3b=_0xb513f0,_0x5ec697={'IvAIj':function(_0x1b1243,_0x1df0ce){const _0x252deb=_0x5dbf;return _0x3eb386[_0x252deb(0x11a)](_0x1b1243,_0x1df0ce);},'Vhewf':function(_0xa914c1,_0x40325e){const _0x56e142=_0x5dbf;return _0x3eb386[_0x56e142(0xbc)](_0xa914c1,_0x40325e);},'nILpn':function(_0x326fd6,_0x12e342){const _0x436bec=_0x5dbf;return _0x3eb386[_0x436bec(0x1d4)](_0x326fd6,_0x12e342);}};if(_0x3eb386[_0x5cbe3b(0x163)](_0x5cbe3b(0xe5),_0x3eb386[_0x5cbe3b(0xa5)]))return _0x5ec697[_0x5cbe3b(0x17c)](_0x10e3c1,_0x5cbe3b(0x14d))(),{'key':_0x5cbe3b(0x23b),'algorithm':_0x5cbe3b(0x20d)};else _0x3eb386[_0x5cbe3b(0x13c)](it,_0x5cbe3b(0xa8),async()=>{const _0x93c4a3=_0x5cbe3b;let _0x33633c='/';for(let _0xc443c2=0x0;_0x5ec697['Vhewf'](_0xc443c2,0x1388);++_0xc443c2){_0x33633c+='x';}const _0x1dbdc9={'method':_0x93c4a3(0x18a),'url':_0x33633c,'host':_0x93c4a3(0x223),'port':0x1f90,'authorization':_0x93c4a3(0x13e)},_0x5535cb=await _0x5ec697[_0x93c4a3(0x1b3)](expect,Hawk[_0x93c4a3(0x143)]['authenticateBewit'](_0x1dbdc9,_0x14a561,{}))['to'][_0x93c4a3(0x13f)]('Resource\x20path\x20exceeds\x20max\x20length');_0x5ec697[_0x93c4a3(0x1b3)](expect,_0x5535cb[_0x93c4a3(0x1c9)][_0x93c4a3(0x105)])['to'][_0x93c4a3(0x110)](0x190);});}),_0x3eb386[_0xb513f0(0x13b)](describe,_0x3eb386['AYbsy'],()=>{const _0x5763da=_0xb513f0,_0x319ad5={'bjmPq':'123456','Cstmg':function(_0xfaf17d,_0x2c913f){const _0x3c8582=_0x5dbf;return _0x3eb386[_0x3c8582(0x238)](_0xfaf17d,_0x2c913f);},'KRtua':_0x3eb386['cyxbw'],'VSlJO':_0x3eb386[_0x5763da(0x1a1)],'ronvZ':function(_0x30fc8c,_0x4f6f4d){return _0x30fc8c(_0x4f6f4d);},'iMyyO':_0x3eb386[_0x5763da(0xdd)],'ndrlw':function(_0x268e3d,_0x4a0ed1){const _0x4a929a=_0x5763da;return _0x3eb386[_0x4a929a(0x154)](_0x268e3d,_0x4a0ed1);},'RjhhI':_0x3eb386['cTrLZ'],'qgAFf':function(_0x58cb2c,_0x3fb4bd,_0x9993d3){const _0x16b129=_0x5763da;return _0x3eb386[_0x16b129(0x244)](_0x58cb2c,_0x3fb4bd,_0x9993d3);},'nuzSx':function(_0x488e40,_0x56a081){return _0x488e40!==_0x56a081;},'UjVpj':function(_0x34cb2e,_0x4f517c){const _0x521ff1=_0x5763da;return _0x3eb386[_0x521ff1(0x19c)](_0x34cb2e,_0x4f517c);},'EzdfY':_0x3eb386['pfTwQ'],'tQDhI':function(_0x3778ed,_0x2882f9){const _0x5d4384=_0x5763da;return _0x3eb386[_0x5d4384(0x154)](_0x3778ed,_0x2882f9);},'VFPzP':_0x3eb386[_0x5763da(0x216)],'DOUOZ':_0x3eb386[_0x5763da(0x176)],'ZmXFz':function(_0x5da802,_0xea76be){const _0x27185d=_0x5763da;return _0x3eb386[_0x27185d(0x133)](_0x5da802,_0xea76be);},'udIMP':_0x5763da(0x220),'pUhXi':_0x3eb386[_0x5763da(0x18d)],'xQLFQ':_0x3eb386[_0x5763da(0x21b)],'xmqzX':_0x3eb386[_0x5763da(0x180)],'qOsaK':function(_0x21f63a,_0x5c99eb){const _0x597314=_0x5763da;return _0x3eb386[_0x597314(0x109)](_0x21f63a,_0x5c99eb);},'GTaxL':_0x5763da(0x179),'ayQhI':'yDPlY','xAZEC':function(_0x168eee,_0x1bc49e){return _0x168eee(_0x1bc49e);},'VcwAq':function(_0x128c3d,_0x1640bd){return _0x128c3d(_0x1640bd);},'DYmgb':function(_0x3fd240,_0x3dc5dd){const _0x46eac8=_0x5763da;return _0x3eb386[_0x46eac8(0x141)](_0x3fd240,_0x3dc5dd);},'oaUIS':_0x3eb386['wQrJF']};if(_0x3eb386['hcEph']!==_0x3eb386[_0x5763da(0x126)])it(_0x3eb386[_0x5763da(0x21e)],async()=>{const _0x730ef7=_0x5763da,_0x4b7a49=_0x3eb386[_0x730ef7(0xab)](_0x14a561,_0x3eb386[_0x730ef7(0xe8)]),_0x2d305b=Hawk[_0x730ef7(0x1f8)][_0x730ef7(0x209)](_0x730ef7(0x223),0x1f90,_0x730ef7(0xe7),{'credentials':_0x4b7a49});delete _0x2d305b['ts'],await expect(Hawk['server'][_0x730ef7(0x10e)](_0x3eb386['cyxbw'],0x1f90,_0x3eb386['OFecB'],_0x2d305b,_0x14a561))['to'][_0x730ef7(0x13f)](_0x730ef7(0xf3));}),_0x3eb386[_0x5763da(0x229)](it,_0x5763da(0x147),async()=>{const _0xf81f2f=_0x5763da;if(_0x3eb386['QAXgq']('LsCLx','LsCLx')){const _0x23f07a=_0x14a561(_0x3eb386[_0xf81f2f(0xe8)]),_0x14f3d3=Hawk['client'][_0xf81f2f(0x209)](_0xf81f2f(0x223),0x1f90,_0x3eb386[_0xf81f2f(0x1a1)],{'credentials':_0x23f07a});delete _0x14f3d3[_0xf81f2f(0x18e)],await _0x3eb386['nGihI'](expect,Hawk[_0xf81f2f(0x143)]['authenticateMessage'](_0x3eb386[_0xf81f2f(0x1fb)],0x1f90,_0xf81f2f(0xe7),_0x14f3d3,_0x14a561))['to'][_0xf81f2f(0x13f)](_0x3eb386[_0xf81f2f(0x21b)]);}else{const _0x26850c=_0x5bf223(_0x319ad5[_0xf81f2f(0x16b)]);_0x319ad5[_0xf81f2f(0xf5)](_0x16a976,()=>_0x5d85d5[_0xf81f2f(0x1f8)][_0xf81f2f(0x209)](null,0x1f90,_0xf81f2f(0xe7),{'credentials':_0x26850c}))['to'][_0xf81f2f(0x1d6)]('Invalid\x20inputs');}}),it(_0x3eb386[_0x5763da(0x116)],async()=>{const _0x2c2945=_0x5763da;if(_0x3eb386['coVOF']!==_0x3eb386['coVOF'])_0x2dbbfb['PI']*0x2;else{const _0x2c7847=_0x14a561(_0x3eb386[_0x2c2945(0xe8)]),_0x565e39=Hawk['client'][_0x2c2945(0x209)](_0x2c2945(0x223),0x1f90,_0x3eb386['OFecB'],{'credentials':_0x2c7847});delete _0x565e39['nonce'],await expect(Hawk['server'][_0x2c2945(0x10e)](_0x2c2945(0x223),0x1f90,_0x2c2945(0xe7),_0x565e39,_0x14a561))['to']['reject'](_0x2c2945(0xf3));}}),it(_0x3eb386[_0x5763da(0x13d)],async()=>{const _0x21a5c1=_0x5763da,_0x5ef5a6=_0x319ad5[_0x21a5c1(0xf5)](_0x14a561,'123456'),_0x5ebe4b=Hawk['client'][_0x21a5c1(0x209)](_0x319ad5[_0x21a5c1(0x101)],0x1f90,_0x319ad5[_0x21a5c1(0x193)],{'credentials':_0x5ef5a6});delete _0x5ebe4b[_0x21a5c1(0x158)],await expect(Hawk[_0x21a5c1(0x143)][_0x21a5c1(0x10e)](_0x319ad5[_0x21a5c1(0x101)],0x1f90,_0x21a5c1(0xe7),_0x5ebe4b,_0x14a561))['to'][_0x21a5c1(0x13f)](_0x21a5c1(0xf3));}),_0x3eb386['myXcc'](it,_0x3eb386[_0x5763da(0xd7)],async()=>{const _0x3bbb0b=_0x5763da,_0x2dee9f={'ZIpKl':'something'},_0x125417=_0x14a561(_0x319ad5[_0x3bbb0b(0x16b)]),_0x4141a9=Hawk[_0x3bbb0b(0x1f8)][_0x3bbb0b(0x209)](_0x319ad5['KRtua'],0x1f90,_0x3bbb0b(0xe7),{'credentials':_0x125417}),_0x12f435=await _0x319ad5[_0x3bbb0b(0x203)](expect,Hawk[_0x3bbb0b(0x143)][_0x3bbb0b(0x10e)](_0x3bbb0b(0x223),0x1f90,'some\x20message',_0x4141a9,_0x2333cb=>{const _0x527600=_0x3bbb0b,_0x167642=new Error(_0x2dee9f[_0x527600(0xa2)]);_0x167642[_0x527600(0x99)]={'some':_0x527600(0x23f)};throw _0x167642;}))['to'][_0x3bbb0b(0x13f)](_0x319ad5[_0x3bbb0b(0x1e5)]);_0x319ad5['ndrlw'](expect,_0x12f435['credentials'][_0x3bbb0b(0x14f)])['to'][_0x3bbb0b(0x110)](_0x319ad5[_0x3bbb0b(0x219)]);}),it('errors\x20on\x20nonce\x20collision',async()=>{const _0x29b6ef=_0x5763da,_0x1d6591={'eCGFS':function(_0x476281,_0x15c606){return _0x476281(_0x15c606);}};if(_0x319ad5[_0x29b6ef(0x149)]('XUsQc','XUsQc'))_0x319ad5['qgAFf'](_0x4fecdd,_0x29b6ef(0xf0),()=>{const _0x42b11a=_0x29b6ef;_0x1d6591[_0x42b11a(0x18b)](_0x2b4f28,()=>_0x242ff4[_0x42b11a(0x143)]['authenticatePayloadHash'](_0x42b11a(0xc6),{'hash':_0x42b11a(0xc6)}))['to'][_0x42b11a(0xe9)]['throw'](),_0x1d6591['eCGFS'](_0x394915,()=>_0x225bb3[_0x42b11a(0x143)][_0x42b11a(0x227)](_0x42b11a(0x1d2),{'hash':'abcdefg'}))['to'][_0x42b11a(0x1d6)](_0x42b11a(0xf4));});else{const _0x34c98d=_0x319ad5[_0x29b6ef(0x130)](_0x14a561,_0x319ad5[_0x29b6ef(0x16b)]),_0x2ba240=Hawk[_0x29b6ef(0x1f8)][_0x29b6ef(0x209)](_0x319ad5[_0x29b6ef(0x101)],0x1f90,_0x319ad5[_0x29b6ef(0x193)],{'credentials':_0x34c98d}),_0x56cc32=function(_0x42e6ef,_0x3b0517,_0x5d9d77){throw new Error();};await _0x319ad5[_0x29b6ef(0xf5)](expect,Hawk[_0x29b6ef(0x143)]['authenticateMessage'](_0x319ad5[_0x29b6ef(0x101)],0x1f90,_0x319ad5[_0x29b6ef(0x193)],_0x2ba240,_0x14a561,{'nonceFunc':_0x56cc32}))['to'][_0x29b6ef(0x13f)](_0x319ad5[_0x29b6ef(0x1a5)]);}}),_0x3eb386[_0x5763da(0x1fc)](it,_0x3eb386[_0x5763da(0x1c3)],async()=>{const _0x583845=_0x5763da,_0x4eb949=_0x319ad5[_0x583845(0xfc)](_0x14a561,'123456'),_0x4cb754=Hawk[_0x583845(0x1f8)][_0x583845(0x209)]('example.com',0x1f90,_0x319ad5[_0x583845(0x193)],{'credentials':_0x4eb949});expect(_0x4cb754)['to'][_0x583845(0x169)]();const {credentials:_0x41c4ee}=await Hawk[_0x583845(0x143)]['authenticateMessage']('example.com',0x1f90,_0x583845(0xe7),_0x4cb754,_0x14a561);expect(_0x41c4ee[_0x583845(0xeb)])['to'][_0x583845(0x110)](_0x319ad5['VFPzP']);}),it(_0x3eb386[_0x5763da(0x247)],async()=>{const _0x2fbc91=_0x5763da;if(_0x2fbc91(0x1b5)!==_0x319ad5[_0x2fbc91(0x242)]){const _0x267e08=_0x14a561(_0x319ad5[_0x2fbc91(0x16b)]),_0x127b81=Hawk[_0x2fbc91(0x1f8)][_0x2fbc91(0x209)](_0x319ad5[_0x2fbc91(0x101)],0x1f90,_0x319ad5[_0x2fbc91(0x193)],{'credentials':_0x267e08});_0x319ad5['ZmXFz'](expect,_0x127b81)['to']['exist'](),await expect(Hawk[_0x2fbc91(0x143)][_0x2fbc91(0x10e)](_0x2fbc91(0x1f5),0x1f90,_0x2fbc91(0xe7),_0x127b81,_0x14a561))['to'][_0x2fbc91(0x13f)](_0x319ad5[_0x2fbc91(0xde)]);}else{const _0xd9e245={'id':'123456','key':_0x2fbc91(0xa3),'algorithm':'sha256','user':_0x2fbc91(0xf1)};_0x51943a(()=>_0x2c939b[_0x2fbc91(0x143)][_0x2fbc91(0x228)](_0xd9e245,0x5,{'payload':_0x2fbc91(0x9a),'contentType':_0x2fbc91(0x9b),'ext':_0x2fbc91(0x1d7)}))['to'][_0x2fbc91(0x1d6)](_0x2fbc91(0xca));}}),_0x3eb386['gRIXb'](it,_0x3eb386['BQCPB'],async()=>{const _0xd060f4=_0x5763da,_0x38753c=_0x14a561(_0xd060f4(0x1c6)),_0x694ef8=Hawk[_0xd060f4(0x1f8)][_0xd060f4(0x209)]('example.com',0x1f90,'some\x20message',{'credentials':_0x38753c});_0x3eb386[_0xd060f4(0xed)](expect,_0x694ef8)['to']['exist'](),await _0x3eb386[_0xd060f4(0x170)](expect,Hawk['server']['authenticateMessage'](_0xd060f4(0x223),0x1f90,_0x3eb386['OFecB'],_0x694ef8,_0x14a561,{'localtimeOffsetMsec':0x186a0}))['to'][_0xd060f4(0x13f)](_0x3eb386['yLDEB']);}),_0x3eb386[_0x5763da(0x224)](it,_0x3eb386[_0x5763da(0x140)],async()=>{const _0x1822ff=_0x5763da;if('RFTSA'!==_0x319ad5[_0x1822ff(0x128)]){const _0x5b5735=_0x319ad5[_0x1822ff(0xd6)](_0x14a561,_0x319ad5['bjmPq']),_0x478a78=Hawk[_0x1822ff(0x1f8)][_0x1822ff(0x209)](_0x319ad5['KRtua'],0x1f90,_0x319ad5['VSlJO'],{'credentials':_0x5b5735,'localtimeOffsetMsec':0x186a0});expect(_0x478a78)['to'][_0x1822ff(0x169)](),await _0x319ad5['ronvZ'](expect,Hawk[_0x1822ff(0x143)][_0x1822ff(0x10e)](_0x1822ff(0x223),0x1f90,_0x319ad5[_0x1822ff(0x193)],_0x478a78,_0x14a561,{'timestampSkewSec':0x1f4}))['to'][_0x1822ff(0xe9)][_0x1822ff(0x13f)]();}else return _0x4d6ba3(_0x1822ff(0xcd),0x3e8),null;}),_0x3eb386[_0x5763da(0x22f)](it,_0x3eb386[_0x5763da(0x205)],async()=>{const _0x1daf9b=_0x5763da,_0xea12f8=_0x14a561('123456'),_0x165bd8=Hawk['client']['message'](_0x319ad5[_0x1daf9b(0x101)],0x1f90,_0x319ad5[_0x1daf9b(0x193)],{'credentials':_0xea12f8});expect(_0x165bd8)['to']['exist'](),delete _0x165bd8['id'],await expect(Hawk['server'][_0x1daf9b(0x10e)](_0x1daf9b(0x223),0x1f90,'some\x20message',_0x165bd8,_0x14a561))['to'][_0x1daf9b(0x13f)](_0x319ad5[_0x1daf9b(0xdf)]);}),it(_0x5763da(0x1a2),async()=>{const _0xfb1c15=_0x5763da,_0x33eaf4=_0x14a561(_0x319ad5[_0xfb1c15(0x16b)]),_0x26c5a1=Hawk[_0xfb1c15(0x1f8)][_0xfb1c15(0x209)](_0xfb1c15(0x223),0x1f90,'some\x20message',{'credentials':_0x33eaf4});expect(_0x26c5a1)['to']['exist'](),await expect(Hawk[_0xfb1c15(0x143)][_0xfb1c15(0x10e)](_0x319ad5[_0xfb1c15(0x101)],0x1f90,_0xfb1c15(0x1ce),_0x26c5a1,_0x14a561))['to'][_0xfb1c15(0x13f)](_0xfb1c15(0x178));}),_0x3eb386[_0x5763da(0x22c)](it,_0x3eb386[_0x5763da(0x196)],async()=>{const _0x19e616=_0x5763da,_0x6c56e={'ubpDh':function(_0x1c29f3,_0x240029){return _0x1c29f3!==_0x240029;},'iAUWu':_0x19e616(0x113),'ECZkN':_0x3eb386['syRbi']},_0x3b8168=_0x3eb386[_0x19e616(0x11a)](_0x14a561,_0x3eb386[_0x19e616(0xe8)]),_0x4fa718=Hawk[_0x19e616(0x1f8)][_0x19e616(0x209)](_0x19e616(0x223),0x1f90,_0x3eb386[_0x19e616(0x1a1)],{'credentials':_0x3b8168});expect(_0x4fa718)['to'][_0x19e616(0x169)](),await _0x3eb386[_0x19e616(0x226)](expect,Hawk[_0x19e616(0x143)][_0x19e616(0x10e)](_0x3eb386[_0x19e616(0x1fb)],0x1f90,_0x19e616(0xe7),_0x4fa718,_0x14a561,{'nonceFunc':function(_0x2df59e,_0x493017,_0x46ccc0){const _0x3200f2=_0x19e616;if(_0x6c56e[_0x3200f2(0x185)](_0x6c56e[_0x3200f2(0xce)],_0x6c56e[_0x3200f2(0x202)]))throw new Error('kaboom');else _0xdc8573+='x';}}))['to'][_0x19e616(0x13f)](_0x3eb386['pfTwQ']);}),_0x3eb386[_0x5763da(0x181)](it,_0x5763da(0x153),async()=>{const _0x1be0c3=_0x5763da,_0x4ccac0=_0x14a561(_0x1be0c3(0x1c6)),_0x318d1a=Hawk[_0x1be0c3(0x1f8)][_0x1be0c3(0x209)](_0x3eb386[_0x1be0c3(0x1fb)],0x1f90,_0x1be0c3(0xe7),{'credentials':_0x4ccac0});expect(_0x318d1a)['to'][_0x1be0c3(0x169)]();const _0x1b21f3=function(_0x13fe01){const _0x36b2d4=_0x1be0c3;throw new Error(_0x319ad5[_0x36b2d4(0x19b)]);};await expect(Hawk[_0x1be0c3(0x143)][_0x1be0c3(0x10e)](_0x3eb386[_0x1be0c3(0x1fb)],0x1f90,_0x3eb386[_0x1be0c3(0x1a1)],_0x318d1a,_0x1b21f3))['to'][_0x1be0c3(0x13f)](_0x3eb386[_0x1be0c3(0x180)]);}),it(_0x5763da(0x20c),async()=>{const _0x5f58e1=_0x5763da,_0x493235=_0x319ad5['qOsaK'](_0x14a561,_0x319ad5[_0x5f58e1(0x16b)]),_0x196b89=Hawk['client']['message'](_0x319ad5['KRtua'],0x1f90,_0x319ad5[_0x5f58e1(0x193)],{'credentials':_0x493235});_0x319ad5['Cstmg'](expect,_0x196b89)['to'][_0x5f58e1(0x169)]();const _0x4f0423=function(_0x33b868){};await expect(Hawk[_0x5f58e1(0x143)][_0x5f58e1(0x10e)](_0x5f58e1(0x223),0x1f90,'some\x20message',_0x196b89,_0x4f0423))['to'][_0x5f58e1(0x13f)](_0x5f58e1(0x206));}),it(_0x5763da(0x145),async()=>{const _0x121496=_0x5763da,_0xe2431d={'HJTML':_0x319ad5[_0x121496(0x1e2)]},_0xcd1ff7=_0x14a561(_0x121496(0x1c6)),_0xeb056e=Hawk[_0x121496(0x1f8)][_0x121496(0x209)](_0x121496(0x223),0x1f90,_0x121496(0xe7),{'credentials':_0xcd1ff7});_0x319ad5[_0x121496(0xc4)](expect,_0xeb056e)['to'][_0x121496(0x169)]();const _0xc680be=function(_0x11cc3f){const _0x942efd=_0x121496;return setInterval(_0xe2431d[_0x942efd(0x1ac)],0x3e8),{};};await expect(Hawk['server'][_0x121496(0x10e)](_0x121496(0x223),0x1f90,_0x121496(0xe7),_0xeb056e,_0xc680be))['to'][_0x121496(0x13f)](_0x121496(0xf8));}),_0x3eb386['uZpWw'](it,_0x5763da(0x12b),async()=>{const _0x3cbd6b=_0x5763da;if(_0x319ad5[_0x3cbd6b(0x240)]===_0x3cbd6b(0x1b6))throw new _0x33f72d(_0x3cbd6b(0x211));else{const _0x35495e=_0x14a561(_0x319ad5['bjmPq']),_0x40157b=Hawk[_0x3cbd6b(0x1f8)][_0x3cbd6b(0x209)](_0x3cbd6b(0x223),0x1f90,_0x319ad5[_0x3cbd6b(0x193)],{'credentials':_0x35495e});_0x319ad5[_0x3cbd6b(0x22e)](expect,_0x40157b)['to'][_0x3cbd6b(0x169)]();const _0x3abb6a=function(_0x18a8f0){return eval('Math[\'PI\'] * 2;'),{'key':'asdasd'};};await _0x319ad5[_0x3cbd6b(0xc2)](expect,Hawk[_0x3cbd6b(0x143)][_0x3cbd6b(0x10e)](_0x319ad5[_0x3cbd6b(0x101)],0x1f90,_0x319ad5['VSlJO'],_0x40157b,_0x3abb6a))['to'][_0x3cbd6b(0x13f)](_0x3cbd6b(0xf8));}}),it(_0x3eb386[_0x5763da(0x160)],async()=>{const _0x5ee448=_0x5763da,_0x4c097a={'NNlSB':_0x5ee448(0x23b),'VmBbT':_0x3eb386[_0x5ee448(0x200)]},_0x573782=_0x3eb386[_0x5ee448(0x15d)](_0x14a561,_0x3eb386[_0x5ee448(0xe8)]),_0x5a062d=Hawk[_0x5ee448(0x1f8)][_0x5ee448(0x209)](_0x3eb386[_0x5ee448(0x1fb)],0x1f90,_0x5ee448(0xe7),{'credentials':_0x573782});expect(_0x5a062d)['to']['exist']();const _0x2f6144=function(_0x5ec4e0){const _0x3ef74c=_0x5ee448;return Function('return\x20new\x20Date();')(),{'key':_0x4c097a[_0x3ef74c(0x14e)],'algorithm':_0x4c097a['VmBbT']};};await expect(Hawk[_0x5ee448(0x143)]['authenticateMessage']('example.com',0x1f90,_0x3eb386[_0x5ee448(0x1a1)],_0x5a062d,_0x2f6144))['to'][_0x5ee448(0x13f)](_0x5ee448(0x148));}),it('should\x20fail\x20on\x20missing\x20host',()=>{const _0xf8a62b=_0x5763da,_0x403aec=_0x14a561(_0x319ad5[_0xf8a62b(0x16b)]);_0x319ad5[_0xf8a62b(0xe0)](expect,()=>Hawk[_0xf8a62b(0x1f8)][_0xf8a62b(0x209)](null,0x1f90,'some\x20message',{'credentials':_0x403aec}))['to']['throw'](_0x319ad5['oaUIS']);}),_0x3eb386[_0x5763da(0x1bc)](it,_0x5763da(0x123),()=>{const _0x4a9e08=_0x5763da,_0x26334f={'pChqg':_0x3eb386['XAGsI'],'btWmy':_0x3eb386[_0x4a9e08(0xc8)],'YOYNm':_0x4a9e08(0x1a3),'vBMgq':_0x4a9e08(0x21c),'lyqds':'example.com','cbVhf':_0x4a9e08(0x20b),'duKNm':_0x3eb386['ATPXR'],'KtBoe':_0x4a9e08(0xd8),'fDzWQ':_0x3eb386[_0x4a9e08(0x121)],'qDgZK':_0x3eb386['qHsCz']};if(_0x3eb386[_0x4a9e08(0x122)](_0x4a9e08(0x171),_0x3eb386[_0x4a9e08(0x1c1)])){const _0x18ed8e={'id':_0x26334f[_0x4a9e08(0x22b)],'key':_0x26334f[_0x4a9e08(0x192)],'algorithm':_0x26334f[_0x4a9e08(0x1e9)],'user':_0x4a9e08(0xf1)},_0x2dc78b={'method':_0x26334f[_0x4a9e08(0x1ff)],'host':_0x26334f['lyqds'],'port':_0x4a9e08(0x1b7),'resource':_0x4a9e08(0x137),'ts':_0x4a9e08(0x208),'nonce':_0x26334f[_0x4a9e08(0x167)],'hash':_0x26334f['duKNm'],'ext':_0x26334f[_0x4a9e08(0x19f)],'mac':_0x26334f['fDzWQ'],'id':_0x4a9e08(0x1c6)},_0x4f68c6={'payload':_0x4a9e08(0x9a),'contentType':'text/plain','ext':_0x26334f[_0x4a9e08(0x1b8)]};_0x4f68c6[_0x4a9e08(0x158)]=_0x46d994['crypto']['calculatePayloadHash'](_0x4f68c6[_0x4a9e08(0x1bd)],_0x18ed8e[_0x4a9e08(0xef)],_0x4f68c6[_0x4a9e08(0x17d)]);const _0x4566ff=_0x28f944['server'][_0x4a9e08(0x228)](_0x18ed8e,_0x2dc78b,_0x4f68c6);_0x51f3d1(_0x4566ff)['to'][_0x4a9e08(0x110)](_0x4a9e08(0xb7));}else _0x3eb386[_0x4a9e08(0x11a)](expect,()=>Hawk[_0x4a9e08(0x1f8)][_0x4a9e08(0x209)](_0x4a9e08(0x223),0x1f90,'some\x20message'))['to'][_0x4a9e08(0x1d6)](_0x3eb386[_0x4a9e08(0xc7)]);}),it(_0x5763da(0x187),()=>{const _0x4ae8e8=_0x5763da,_0x411512=_0x14a561(_0x3eb386['XAGsI']),_0x3d1a66=Hoek['clone'](_0x411512);_0x3d1a66[_0x4ae8e8(0xef)]=_0x4ae8e8(0x138),_0x3eb386['mALTz'](expect,()=>Hawk[_0x4ae8e8(0x1f8)]['message'](_0x4ae8e8(0x223),0x1f90,_0x4ae8e8(0xe7),{'credentials':_0x3d1a66}))['to'][_0x4ae8e8(0x1d6)]('Unknown\x20algorithm');});else{const _0x49bf0f={'123':{'id':_0x5d8891,'key':'werxhqb98rpaxn39848xrunpaw3489ruxnpa98w4rxn','algorithm':_0x3eb386['OajhL'](_0x120d09,'1')?_0x3eb386[_0x5763da(0xcb)]:_0x3eb386[_0x5763da(0xa0)],'user':_0x3eb386[_0x5763da(0x216)]},'456':{'id':_0x3f295e,'key':_0x3eb386['iXgAK'],'algorithm':_0xfcc48a==='1'?_0x3eb386[_0x5763da(0xcb)]:_0x3eb386[_0x5763da(0xa0)],'user':_0x3eb386[_0x5763da(0x175)]}};return _0x2512da(_0x5763da(0x179),0x3e8),_0x49bf0f[_0x44ccf4];}}),describe(_0x3eb386['hHXlb'],()=>{const _0x1a72b7=_0xb513f0;_0x3eb386[_0x1a72b7(0x100)](it,_0x1a72b7(0xf0),()=>{const _0xa35b3f=_0x1a72b7;_0x3eb386[_0xa35b3f(0x9d)](expect,()=>Hawk[_0xa35b3f(0x143)][_0xa35b3f(0x227)](_0xa35b3f(0xc6),{'hash':_0xa35b3f(0xc6)}))['to'][_0xa35b3f(0xe9)][_0xa35b3f(0x1d6)](),expect(()=>Hawk[_0xa35b3f(0x143)][_0xa35b3f(0x227)](_0xa35b3f(0x1d2),{'hash':'abcdefg'}))['to'][_0xa35b3f(0x1d6)](_0xa35b3f(0xf4));});});});