const _0xd14bbe=_0x26e5;function _0x26e5(_0x3b0462,_0x398efa){const _0x4f9e00=_0x4f9e();return _0x26e5=function(_0x26e5f0,_0x245026){_0x26e5f0=_0x26e5f0-0x109;let _0x3dcf63=_0x4f9e00[_0x26e5f0];return _0x3dcf63;},_0x26e5(_0x3b0462,_0x398efa);}(function(_0x498e3a,_0x2e0705){const _0x346c71=_0x26e5,_0xc12a18=_0x498e3a();while(!![]){try{const _0x1abc39=-parseInt(_0x346c71(0x114))/0x1+-parseInt(_0x346c71(0x139))/0x2+-parseInt(_0x346c71(0x136))/0x3*(-parseInt(_0x346c71(0x11b))/0x4)+parseInt(_0x346c71(0x117))/0x5+parseInt(_0x346c71(0x121))/0x6+parseInt(_0x346c71(0x129))/0x7+parseInt(_0x346c71(0x112))/0x8;if(_0x1abc39===_0x2e0705)break;else _0xc12a18['push'](_0xc12a18['shift']());}catch(_0x1e0bc0){_0xc12a18['push'](_0xc12a18['shift']());}}}(_0x4f9e,0xdf4cb));import _0x3a28c1 from'../../src/utils/url-helpers';import _0x1bdb07 from'../fixtures/open-redirect-payloads.json';describe(_0xd14bbe(0x132),()=>{const _0x2481e8=_0xd14bbe,_0x17c6e7={'RIeOU':_0x2481e8(0x12d),'TxRPn':function(_0xcd2419,_0x13649f){return _0xcd2419(_0x13649f);},'yikKF':function(_0x5943df,_0x28d597,_0x4c8cdb){return _0x5943df(_0x28d597,_0x4c8cdb);},'mEVyw':'/foo?some=value','Frbkl':'/foo?someUrl=https://www.google.com','URzJE':_0x2481e8(0x10c),'jMKwM':function(_0x95491c,_0x247116){return _0x95491c(_0x247116);},'jXjeW':function(_0x1d5da2,_0x31dd3c){return _0x1d5da2(_0x31dd3c);},'ClpQG':function(_0x3d8139,_0x23dd54,_0x5d9ebe){return _0x3d8139(_0x23dd54,_0x5d9ebe);},'HEjsX':_0x2481e8(0x135),'wepJr':function(_0x26cd01,_0x6381e2,_0x244c7d){return _0x26cd01(_0x6381e2,_0x244c7d);},'ADFHf':_0x2481e8(0x128),'EpZAZ':function(_0x21f54a,_0x4c0a2d,_0x31ddb9){return _0x21f54a(_0x4c0a2d,_0x31ddb9);},'UwDhD':'should\x20not\x20throw\x20for\x20empty\x20redirect','lhhwZ':_0x2481e8(0x12e)},_0x27efe4=new URL(_0x17c6e7[_0x2481e8(0x133)]);_0x17c6e7[_0x2481e8(0x11c)](describe,'isSafeRedirect',()=>{const _0x26d75b=_0x2481e8,_0x1b4a36={'Tkfvk':function(_0x4b4144,_0x2e4dc3){return _0x4b4144(_0x2e4dc3);},'sKsAi':function(_0xd6b6ee,_0x498a74,_0x1ea007){const _0x562927=_0x26e5;return _0x17c6e7[_0x562927(0x11c)](_0xd6b6ee,_0x498a74,_0x1ea007);},'GzZfi':_0x26d75b(0x124)};_0x17c6e7[_0x26d75b(0x119)]===_0x26d75b(0x122)?_0x1be1cc(_0xa35cba[_0x26d75b(0x10e)](null,'',_0x35effe))['not']['toThrow']():(_0x17c6e7[_0x26d75b(0x10f)](test,_0x26d75b(0x10a),()=>{const _0x5ea299=_0x26d75b;expect(_0x3a28c1(_0x5ea299(0x116),_0x27efe4))[_0x5ea299(0x10b)](undefined),_0x1b4a36['Tkfvk'](expect,_0x3a28c1('https://foo',_0x27efe4))[_0x5ea299(0x10b)](undefined),expect(_0x1b4a36[_0x5ea299(0x11e)](_0x3a28c1,_0x1b4a36['GzZfi'],_0x27efe4))[_0x5ea299(0x10b)](undefined);}),test(_0x17c6e7[_0x26d75b(0x127)],()=>{const _0x392c93=_0x26d75b,_0x10e14d=_0x17c6e7[_0x392c93(0x126)][_0x392c93(0x113)]('|');let _0x3a9d2e=0x0;while(!![]){switch(_0x10e14d[_0x3a9d2e++]){case'0':_0x17c6e7[_0x392c93(0x115)](expect,_0x17c6e7['yikKF'](_0x3a28c1,_0x17c6e7[_0x392c93(0x11a)],_0x27efe4))['toEqual'](_0x392c93(0x118));continue;case'1':expect(_0x3a28c1(_0x17c6e7[_0x392c93(0x11f)],_0x27efe4))['toEqual']('http://www.example.com/foo?someUrl=https://www.google.com');continue;case'2':_0x17c6e7['TxRPn'](expect,_0x3a28c1('/foo',_0x27efe4))[_0x392c93(0x10b)](_0x392c93(0x12a));continue;case'3':expect(_0x3a28c1('/foo',new URL(_0x392c93(0x131))))[_0x392c93(0x10b)](_0x17c6e7[_0x392c93(0x123)]);continue;case'4':expect(_0x3a28c1(_0x392c93(0x12c),_0x27efe4))['toEqual'](_0x392c93(0x12a));continue;}break;}}),_0x17c6e7[_0x26d75b(0x12b)](test,_0x26d75b(0x125),()=>{const _0x31ff3d=_0x26d75b,_0x1de5e3={'TeMfC':function(_0x582fcc,_0x10281a){const _0x2a56b7=_0x26e5;return _0x17c6e7[_0x2a56b7(0x115)](_0x582fcc,_0x10281a);},'fQobV':function(_0x4e6994,_0xa9323e,_0x462695){const _0x4ac852=_0x26e5;return _0x17c6e7[_0x4ac852(0x12b)](_0x4e6994,_0xa9323e,_0x462695);},'eThaK':function(_0x58ab3a,_0x3ed16b){return _0x17c6e7['jMKwM'](_0x58ab3a,_0x3ed16b);}};if(_0x31ff3d(0x109)!==_0x31ff3d(0x137))for(const _0x5ca67c of _0x1bdb07){_0x17c6e7['jXjeW'](expect,_0x3a28c1(_0x5ca67c,_0x27efe4)||_0x27efe4['toString']())[_0x31ff3d(0x111)](/^http:\/\/www.example.com\//);}else _0x1de5e3[_0x31ff3d(0x11d)](_0x3d6e83,_0x1de5e3[_0x31ff3d(0x110)](_0x293e14,_0x31ff3d(0x116),_0x174a27))['toEqual'](_0x29b6bd),_0x1de5e3[_0x31ff3d(0x120)](_0x36f5b0,_0x1de5e3['fQobV'](_0x22d96f,_0x31ff3d(0x134),_0x553711))[_0x31ff3d(0x10b)](_0x42bfa1),_0x4c2c7a(_0x1de5e3['fQobV'](_0x2064d7,_0x31ff3d(0x124),_0x21c5f2))[_0x31ff3d(0x10b)](_0x540f9a);}),_0x17c6e7[_0x26d75b(0x130)](test,_0x17c6e7[_0x26d75b(0x10d)],()=>{const _0x53ef1a=_0x26d75b;expect(_0x3a28c1[_0x53ef1a(0x10e)](null,'',_0x27efe4))[_0x53ef1a(0x12f)][_0x53ef1a(0x138)]();}));});});function _0x4f9e(){const _0x42c53a=['yikKF','foo','2|4|0|1|3','http://www.example.com','not','EpZAZ','http://www.example.com:8888','url-helpers','lhhwZ','https://foo','OMsMV','8139flOYAn','uqsSn','toThrow','2430902tgSqbx','iknCt','should\x20not\x20allow\x20absolute\x20urls','toEqual','http://www.example.com:8888/foo','UwDhD','bind','wepJr','fQobV','toMatch','3189496HZKftN','split','842539YXvIqn','TxRPn','file://foo','787705mZixqG','http://www.example.com/foo?some=value','HEjsX','mEVyw','268UfwTQY','ClpQG','TeMfC','sKsAi','Frbkl','eThaK','10107216zivceV','WnBXT','URzJE','http://foo','should\x20prevent\x20open\x20redirects','RIeOU','ADFHf','should\x20allow\x20relative\x20urls','3850630kwdGHj','http://www.example.com/foo'];_0x4f9e=function(){return _0x42c53a;};return _0x4f9e();}