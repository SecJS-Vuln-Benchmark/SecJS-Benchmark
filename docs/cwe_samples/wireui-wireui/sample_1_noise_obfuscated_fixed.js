const _0x3f8c72=_0x2f48;(function(_0x16f21f,_0x1d6132){const _0xef16c1=_0x2f48,_0x2eea21=_0x16f21f();while(!![]){try{const _0x144467=-parseInt(_0xef16c1(0x7b))/0x1+-parseInt(_0xef16c1(0x77))/0x2*(-parseInt(_0xef16c1(0x73))/0x3)+-parseInt(_0xef16c1(0x6b))/0x4*(parseInt(_0xef16c1(0x6a))/0x5)+-parseInt(_0xef16c1(0x7d))/0x6*(-parseInt(_0xef16c1(0x71))/0x7)+parseInt(_0xef16c1(0x6f))/0x8*(parseInt(_0xef16c1(0x72))/0x9)+-parseInt(_0xef16c1(0x67))/0xa+-parseInt(_0xef16c1(0x6e))/0xb*(parseInt(_0xef16c1(0x68))/0xc);if(_0x144467===_0x1d6132)break;else _0x2eea21['push'](_0x2eea21['shift']());}catch(_0x5ec810){_0x2eea21['push'](_0x2eea21['shift']());}}}(_0xaefb,0x32005));import{WAZUH_DATA_ABSOLUTE_PATH,WAZUH_DATA_CONFIG_DIRECTORY_PATH,WAZUH_DATA_CONFIG_APP_PATH}from'../../common/constants';import{createDataDirectoryIfNotExists,createDirectoryIfNotExists}from'./filesystem';import{getConfiguration}from'./get-configuration';import{execSync}from'child_process';import{unlinkSync,writeFileSync}from'fs';beforeAll(()=>{const _0x319aab=_0x2f48,_0x459ae2={'SpeHw':function(_0x9bbc18){return _0x9bbc18();},'dknJn':function(_0x1e90d4,_0x587f86){return _0x1e90d4(_0x587f86);}};_0x459ae2['SpeHw'](createDataDirectoryIfNotExists),_0x459ae2[_0x319aab(0x69)](createDirectoryIfNotExists,WAZUH_DATA_CONFIG_DIRECTORY_PATH);}),afterAll(()=>{unlinkSync(WAZUH_DATA_ABSOLUTE_PATH);}),describe(_0x3f8c72(0x7e),()=>{const _0x25296f=_0x3f8c72,_0x262584={'UnhdN':function(_0x247b31,_0x2b631a){return _0x247b31(_0x2b631a);},'CaTFJ':_0x25296f(0x76)};afterEach(()=>{const _0x34ff45=_0x25296f;execSync(_0x34ff45(0x74)+WAZUH_DATA_ABSOLUTE_PATH+'/config/wazuh.yml\x20||\x20echo\x20\x22\x22');});const _0x2a3ab2=[_0x25296f(0x79),'hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a',_0x25296f(0x6c)];it[_0x25296f(0x80)]`
	pluginConfiguration    
	${_0x2a3ab2[0x0]}
	${_0x2a3ab2[0x1]}
  ${_0x2a3ab2[0x2]}
	`('Obfuscate\x20the\x20hosts\x20password',({pluginConfiguration:_0xc2bc33})=>{const _0x448c30=_0x25296f,_0x4f1069={'NKDpL':function(_0x3461ca,_0x2392a9){const _0x7babeb=_0x2f48;return _0x262584[_0x7babeb(0x7f)](_0x3461ca,_0x2392a9);}};if(_0x262584['CaTFJ']===_0x448c30(0x78))_0x262584[_0x448c30(0x7f)](_0x290154,'rm\x20'+_0x515c32+'/config/wazuh.yml\x20||\x20echo\x20\x22\x22');else{writeFileSync(WAZUH_DATA_CONFIG_APP_PATH,_0xc2bc33,{'encoding':'utf8'});const _0x4b4d7d=getConfiguration();_0x4b4d7d['hosts'][_0x448c30(0x70)](_0x5369f2=>{const _0x1483a0=_0x448c30,_0x1a41dd=Object['keys'](_0x5369f2)[0x0];expect(Object[_0x1483a0(0x7a)](_0x5369f2)[_0x1483a0(0x7c)])[_0x1483a0(0x6d)](0x1),_0x4f1069['NKDpL'](expect,_0x5369f2[_0x1a41dd][_0x1483a0(0x75)])[_0x1483a0(0x6d)](_0x1483a0(0x81));});}});});function _0x2f48(_0x379273,_0x55dcd8){const _0xaefbbf=_0xaefb();return _0x2f48=function(_0x2f48e9,_0x2ac703){_0x2f48e9=_0x2f48e9-0x67;let _0xda71a6=_0xaefbbf[_0x2f48e9];return _0xda71a6;},_0x2f48(_0x379273,_0x55dcd8);}function _0xaefb(){const _0x562336=['forEach','116305PZPLLW','2205081RBljMP','128787tCfbsA','rm\x20','password','CDizd','14BpeqwF','TzovO','hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','keys','131342OhwaXJ','length','102LspOBj','[service]\x20get-configuration','UnhdN','each','*****','1332400MZIuhl','264fwnLQl','dknJn','1490UvDhtW','3704geQgFl','pattern:\x20wazuh-alerts-*\x0ahosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom2:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom2.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom2\x0a\x20\x20\x20\x20-\x20password:\x20custompassword2\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','toEqual','41316LrJCvT','8KqJvuk'];_0xaefb=function(){return _0x562336;};return _0xaefb();}