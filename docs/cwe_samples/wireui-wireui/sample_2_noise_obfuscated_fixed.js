const _0x3ad92d=_0x28af;(function(_0x227fe4,_0x5b0deb){const _0xd177eb=_0x28af,_0x4e2180=_0x227fe4();while(!![]){try{const _0x451b58=parseInt(_0xd177eb(0x13d))/0x1+-parseInt(_0xd177eb(0x142))/0x2*(parseInt(_0xd177eb(0x14b))/0x3)+parseInt(_0xd177eb(0x130))/0x4*(parseInt(_0xd177eb(0x136))/0x5)+-parseInt(_0xd177eb(0x139))/0x6+parseInt(_0xd177eb(0x135))/0x7*(parseInt(_0xd177eb(0x138))/0x8)+-parseInt(_0xd177eb(0x137))/0x9*(-parseInt(_0xd177eb(0x131))/0xa)+-parseInt(_0xd177eb(0x146))/0xb;if(_0x451b58===_0x5b0deb)break;else _0x4e2180['push'](_0x4e2180['shift']());}catch(_0x2b6668){_0x4e2180['push'](_0x4e2180['shift']());}}}(_0x430f,0x8b122));import{WAZUH_DATA_ABSOLUTE_PATH,WAZUH_DATA_CONFIG_DIRECTORY_PATH,WAZUH_DATA_CONFIG_APP_PATH}from'../../common/constants';function _0x28af(_0x859d82,_0x4c6b95){const _0x430f9b=_0x430f();return _0x28af=function(_0x28af50,_0x487dcc){_0x28af50=_0x28af50-0x12f;let _0x2cfef7=_0x430f9b[_0x28af50];return _0x2cfef7;},_0x28af(_0x859d82,_0x4c6b95);}import{createDataDirectoryIfNotExists,createDirectoryIfNotExists}from'./filesystem';import{getConfiguration}from'./get-configuration';function _0x430f(){const _0x10c128=['4207096WxLLxE','3272958FxKaIG','rm\x20-rf\x20','rm\x20','/config/wazuh.yml\x20||\x20echo\x20\x22\x22','862049FwwxtB','hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','utf8','forEach','wYOur','36sqTEgs','jAGod','*****','pattern:\x20wazuh-alerts-*\x0ahosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom\x0a\x20\x20\x20\x20-\x20password:\x20custompassword\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a\x20\x20-\x20custom2:\x0a\x20\x20\x20\x20-\x20url:\x20http://custom2.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20custom2\x0a\x20\x20\x20\x20-\x20password:\x20custompassword2\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','26224099sCdiJj','hosts','each','hosts:\x0a\x20\x20-\x20default:\x0a\x20\x20\x20\x20-\x20url:\x20http://wazuh.manager\x0a\x20\x20\x20\x20-\x20port:\x2055000\x0a\x20\x20\x20\x20-\x20username:\x20user\x0a\x20\x20\x20\x20-\x20password:\x20password\x0a\x20\x20\x20\x20-\x20run_as:\x20false\x0a','toEqual','10194odnulZ','Obfuscate\x20the\x20hosts\x20password','[service]\x20get-configuration','7692Gghzns','5811350AbXctA','keys','length','password','14OVrSKn','2770jktVhM','9jKNUAn'];_0x430f=function(){return _0x10c128;};return _0x430f();}import{execSync}from'child_process';import{unlinkSync,writeFileSync}from'fs';beforeAll(()=>{createDataDirectoryIfNotExists(),createDirectoryIfNotExists(WAZUH_DATA_CONFIG_DIRECTORY_PATH);}),afterAll(()=>{const _0x1857c2=_0x28af;execSync(_0x1857c2(0x13a)+WAZUH_DATA_ABSOLUTE_PATH);}),describe(_0x3ad92d(0x12f),()=>{const _0x38d979=_0x3ad92d,_0x5ae6e5={'mfPlu':_0x38d979(0x13f),'jAGod':function(_0xbb66bc){return _0xbb66bc();},'wYOur':_0x38d979(0x14c)};afterEach(()=>{const _0x3be67d=_0x38d979;execSync(_0x3be67d(0x13b)+WAZUH_DATA_ABSOLUTE_PATH+_0x3be67d(0x13c));});const _0x3bd8dc=[_0x38d979(0x149),_0x38d979(0x13e),_0x38d979(0x145)];it[_0x38d979(0x148)]`
	pluginConfiguration    
	${_0x3bd8dc[0x0]}
	${_0x3bd8dc[0x1]}
  ${_0x3bd8dc[0x2]}
	`(_0x5ae6e5[_0x38d979(0x141)],({pluginConfiguration:_0x308cae})=>{const _0x4623b8=_0x38d979;writeFileSync(WAZUH_DATA_CONFIG_APP_PATH,_0x308cae,{'encoding':_0x5ae6e5['mfPlu']});const _0x136d90=_0x5ae6e5[_0x4623b8(0x143)](getConfiguration);_0x136d90[_0x4623b8(0x147)][_0x4623b8(0x140)](_0xd1e66e=>{const _0x209c37=_0x4623b8,_0xcd7e07=Object[_0x209c37(0x132)](_0xd1e66e)[0x0];expect(Object[_0x209c37(0x132)](_0xd1e66e)[_0x209c37(0x133)])[_0x209c37(0x14a)](0x1),expect(_0xd1e66e[_0xcd7e07][_0x209c37(0x134)])[_0x209c37(0x14a)](_0x209c37(0x144));});});});