const _0xe20f96=_0x2ee7;(function(_0x2bf364,_0x340e14){const _0x3bdbad=_0x2ee7,_0x519711=_0x2bf364();while(!![]){try{const _0x17eda7=parseInt(_0x3bdbad(0x11e))/0x1+parseInt(_0x3bdbad(0x11a))/0x2*(parseInt(_0x3bdbad(0x101))/0x3)+parseInt(_0x3bdbad(0xfd))/0x4*(parseInt(_0x3bdbad(0x12f))/0x5)+parseInt(_0x3bdbad(0x13b))/0x6*(-parseInt(_0x3bdbad(0x14e))/0x7)+parseInt(_0x3bdbad(0x155))/0x8+parseInt(_0x3bdbad(0x136))/0x9+-parseInt(_0x3bdbad(0x150))/0xa;if(_0x17eda7===_0x340e14)break;else _0x519711['push'](_0x519711['shift']());}catch(_0x7e23ac){_0x519711['push'](_0x519711['shift']());}}}(_0x1c16,0xc486c));const {assert,expect}=require(_0xe20f96(0x11f)),{describe,before,beforeEach,after,afterEach,it}=require(_0xe20f96(0x139)),sinon=require(_0xe20f96(0x116)),{mockRequest,mockResponse}=require(_0xe20f96(0x12a)),csurf=require(_0xe20f96(0x14c));describe(_0xe20f96(0x14b),()=>{const _0x1f38b7=_0xe20f96,_0x2a331f={'LrxGZ':function(_0xa82b4d,_0xfcd06f,_0x83e368){return _0xa82b4d(_0xfcd06f,_0x83e368);},'isbqr':function(_0x56eade,_0x214f3f){return _0x56eade(_0x214f3f);},'wnNWr':_0x1f38b7(0x154),'gXDmH':_0x1f38b7(0x137),'Rfvri':function(_0x5ba4ad,_0x2ccbbe){return _0x5ba4ad(_0x2ccbbe);},'oHkGp':_0x1f38b7(0x108),'WPTXy':'aaaabbb','mtQAP':_0x1f38b7(0x13f),'GkEOT':'aaaabc','SmRwx':function(_0x1bfd01,_0x383290,_0x56e289){return _0x1bfd01(_0x383290,_0x56e289);},'gsAbQ':_0x1f38b7(0x10c),'unWFc':_0x1f38b7(0x151),'OfFtA':_0x1f38b7(0x148),'OuhwX':_0x1f38b7(0x12d)};before(()=>{const _0x123d16=_0x1f38b7;this[_0x123d16(0x147)]=_0x2a331f[_0x123d16(0x100)](csurf,null,[]);}),it(_0x1f38b7(0x14f),()=>{const _0x4467e7=_0x1f38b7,_0x369cb2=mockRequest({'cookies':null}),_0x472501=mockResponse({'cookie':null}),_0x2989c9=sinon[_0x4467e7(0xfb)]();try{this[_0x4467e7(0x147)](_0x369cb2,_0x472501,_0x2989c9);}catch(_0x4756b7){assert[_0x4467e7(0xf6)](_0x4756b7['name'],'Error',_0x4756b7),assert[_0x4467e7(0xf6)](_0x4756b7[_0x4467e7(0x10f)],_0x4467e7(0x11d));}}),_0x2a331f['SmRwx'](it,_0x2a331f[_0x1f38b7(0x102)],()=>{const _0x37b1c4=_0x1f38b7,_0x183a5c=_0x2a331f[_0x37b1c4(0x132)](mockRequest,{'method':_0x37b1c4(0xf8),'cookies':{},'body':{}}),_0x4b766d=mockResponse({'cookie':sinon[_0x37b1c4(0xfb)]()}),_0x105e92=sinon[_0x37b1c4(0xfb)]();assert[_0x37b1c4(0x109)](_0x183a5c[_0x37b1c4(0x12b)]),this[_0x37b1c4(0x147)](_0x183a5c,_0x4b766d,_0x105e92),assert[_0x37b1c4(0x124)](_0x183a5c[_0x37b1c4(0x12b)]),_0x183a5c[_0x37b1c4(0x12b)](),assert['isTrue'](_0x4b766d[_0x37b1c4(0x117)][_0x37b1c4(0x122)]),assert[_0x37b1c4(0xf6)](_0x4b766d[_0x37b1c4(0x117)][_0x37b1c4(0xf3)](0x0)['args'][0x0],_0x37b1c4(0x12b)),assert[_0x37b1c4(0xf4)](_0x4b766d[_0x37b1c4(0x117)][_0x37b1c4(0xf3)](0x0)[_0x37b1c4(0x125)][0x1]);}),it(_0x1f38b7(0x133),()=>{const _0x11d67a=_0x1f38b7;if(_0x11d67a(0x13a)!==_0x11d67a(0x13a))_0x2a3703[_0x11d67a(0xf6)](_0x384e89[_0x11d67a(0x118)],_0x2a331f[_0x11d67a(0x143)]),_0x3a33a1[_0x11d67a(0x112)](_0x73201b[_0x11d67a(0x10f)],'Did\x20not\x20get\x20a\x20CSRF\x20token');else{const _0x3d695c=mockRequest({'method':_0x11d67a(0x108),'cookies':{'csrfToken':_0x11d67a(0x137)},'body':{'_csrf':_0x2a331f[_0x11d67a(0x11c)]}}),_0x27e9ce=_0x2a331f[_0x11d67a(0x110)](mockResponse,{'cookie':sinon[_0x11d67a(0xfb)]()}),_0x3885d8=sinon[_0x11d67a(0xfb)]();assert['isNotFunction'](_0x3d695c['csrfToken']),this[_0x11d67a(0x147)](_0x3d695c,_0x27e9ce,_0x3885d8),assert[_0x11d67a(0x113)](_0x3885d8['calledOnce']);}}),it(_0x1f38b7(0x121),()=>{const _0x45843e=_0x1f38b7,_0x142347=_0x2a331f['Rfvri'](mockRequest,{'method':_0x2a331f[_0x45843e(0xf5)],'cookies':{'csrfToken':_0x2a331f[_0x45843e(0x127)]},'body':{'_csrf':_0x45843e(0x137)}}),_0x1b94a8=mockResponse({'cookie':sinon[_0x45843e(0xfb)]()}),_0x2fc85f=sinon['stub']();assert[_0x45843e(0x109)](_0x142347['csrfToken']);try{this[_0x45843e(0x147)](_0x142347,_0x1b94a8,_0x2fc85f);}catch(_0x1b856a){assert[_0x45843e(0xf6)](_0x1b856a[_0x45843e(0x118)],'Error'),assert[_0x45843e(0x112)](_0x1b856a[_0x45843e(0x10f)],_0x2a331f['mtQAP']);}assert[_0x45843e(0x10e)](_0x2fc85f[_0x45843e(0x122)]);}),it(_0x2a331f['unWFc'],()=>{const _0x30e00c=_0x1f38b7,_0x31a3f4=mockRequest({'method':_0x30e00c(0x108),'cookies':{'csrfToken':_0x2a331f[_0x30e00c(0x127)]},'body':{}}),_0x235995=mockResponse({'cookie':sinon[_0x30e00c(0xfb)]()}),_0x1ff3d2=sinon[_0x30e00c(0xfb)]();assert[_0x30e00c(0x109)](_0x31a3f4['csrfToken']);try{this['csrf'](_0x31a3f4,_0x235995,_0x1ff3d2);}catch(_0x5086ab){assert['equal'](_0x5086ab[_0x30e00c(0x118)],_0x30e00c(0x154)),assert[_0x30e00c(0x112)](_0x5086ab[_0x30e00c(0x10f)],_0x30e00c(0x13f));}assert[_0x30e00c(0x10e)](_0x1ff3d2[_0x30e00c(0x122)]);}),_0x2a331f[_0x1f38b7(0x111)](it,_0x2a331f[_0x1f38b7(0x126)],()=>{const _0x3fa055=_0x1f38b7;if('xQXHq'!==_0x3fa055(0x12e)){const _0x39903b=_0x2a331f['Rfvri'](mockRequest,{'method':_0x3fa055(0x108),'cookies':{},'body':{}}),_0x51ba9e=_0x2a331f[_0x3fa055(0x132)](mockResponse,{'cookie':sinon[_0x3fa055(0xfb)]()}),_0x1907ae=sinon[_0x3fa055(0xfb)]();assert[_0x3fa055(0x109)](_0x39903b[_0x3fa055(0x12b)]);try{this[_0x3fa055(0x147)](_0x39903b,_0x51ba9e,_0x1907ae);}catch(_0x82521){assert[_0x3fa055(0xf6)](_0x82521['name'],_0x3fa055(0x154)),assert['include'](_0x82521['message'],'Did\x20not\x20get\x20a\x20CSRF\x20token');}assert['isFalse'](_0x1907ae[_0x3fa055(0x122)]);}else this[_0x3fa055(0x147)](_0x5ef738,_0x4a3f9d,_0x41a05e);}),_0x2a331f[_0x1f38b7(0x111)](it,_0x2a331f[_0x1f38b7(0x128)],()=>{const _0x52025e=_0x1f38b7,_0x1ee5f2=mockRequest({'method':_0x52025e(0xf8),'cookies':{'csrfToken':_0x2a331f['GkEOT']},'body':{}}),_0xec58fa=mockResponse({'cookie':sinon['stub']()}),_0x1d86cd=sinon[_0x52025e(0xfb)]();assert[_0x52025e(0x109)](_0x1ee5f2[_0x52025e(0x12b)]),this[_0x52025e(0x147)](_0x1ee5f2,_0xec58fa,_0x1d86cd),assert[_0x52025e(0x113)](_0x1d86cd[_0x52025e(0x122)]),assert[_0x52025e(0x124)](_0x1ee5f2[_0x52025e(0x12b)],_0x52025e(0x129));const _0x2251f0=_0x1ee5f2[_0x52025e(0x12b)]();assert['equal'](_0x2251f0,_0x2a331f[_0x52025e(0x103)]);});}),describe(_0xe20f96(0x10b),()=>{const _0x5b2240=_0xe20f96,_0x1af774={'nhgdT':'POST','FhFdz':'aaaa','UDGIR':function(_0x509518,_0x22c9bc){return _0x509518(_0x22c9bc);},'TZDuv':_0x5b2240(0x135),'pUVjs':_0x5b2240(0x130),'sykeu':_0x5b2240(0x13f),'bBCxc':_0x5b2240(0xf8),'rnPRw':function(_0x16a892,_0x3a547c){return _0x16a892(_0x3a547c);},'NITOw':function(_0x468702,_0x373fdc,_0x7b4dfc){return _0x468702(_0x373fdc,_0x7b4dfc);}};_0x1af774['rnPRw'](before,()=>{const _0x493447=_0x5b2240;this['csrf']=csurf([_0x1af774[_0x493447(0x134)],_0x493447(0x10d)],[]);}),_0x1af774['NITOw'](it,_0x5b2240(0x133),()=>{const _0x16b870=_0x5b2240,_0x55752a=mockRequest({'method':_0x16b870(0x10d),'cookies':{'csrfToken':_0x16b870(0x137)},'body':{'_csrf':_0x1af774[_0x16b870(0x144)]}}),_0x54518e=_0x1af774[_0x16b870(0x140)](mockResponse,{'cookie':sinon[_0x16b870(0xfb)]()}),_0x987791=sinon[_0x16b870(0xfb)]();assert[_0x16b870(0x109)](_0x55752a[_0x16b870(0x12b)]),this[_0x16b870(0x147)](_0x55752a,_0x54518e,_0x987791),assert[_0x16b870(0x113)](_0x987791[_0x16b870(0x122)]);}),_0x1af774[_0x5b2240(0x105)](it,_0x5b2240(0x121),()=>{const _0x8dad9b=_0x5b2240,_0x416c7e=mockRequest({'method':_0x8dad9b(0x10d),'cookies':{'csrfToken':_0x1af774[_0x8dad9b(0xf9)]},'body':{'_csrf':'aaaa'}}),_0x5450a8=mockResponse({'cookie':sinon[_0x8dad9b(0xfb)]()}),_0x418467=sinon[_0x8dad9b(0xfb)]();assert[_0x8dad9b(0x109)](_0x416c7e[_0x8dad9b(0x12b)]);try{this[_0x8dad9b(0x147)](_0x416c7e,_0x5450a8,_0x418467);}catch(_0x370544){_0x8dad9b(0x130)!==_0x1af774[_0x8dad9b(0x138)]?this[_0x8dad9b(0x147)](_0xe2050e,_0xc5a7ca,_0x144e6c):(assert[_0x8dad9b(0xf6)](_0x370544['name'],_0x8dad9b(0x154)),assert['include'](_0x370544[_0x8dad9b(0x10f)],_0x1af774[_0x8dad9b(0x120)]));}assert['isFalse'](_0x418467['calledOnce']);}),_0x1af774['NITOw'](it,_0x5b2240(0xf7),()=>{const _0x5ec1c8=_0x5b2240;if(_0x5ec1c8(0x14d)===_0x5ec1c8(0x14d)){const _0x4ba8de=_0x1af774[_0x5ec1c8(0x140)](mockRequest,{'method':_0x1af774['bBCxc'],'cookies':{'csrfToken':_0x5ec1c8(0x137)},'body':{'_csrf':''}}),_0x2d9fe1=mockResponse({'cookie':sinon[_0x5ec1c8(0xfb)]()}),_0xba81d0=sinon[_0x5ec1c8(0xfb)]();assert[_0x5ec1c8(0x109)](_0x4ba8de[_0x5ec1c8(0x12b)]),this[_0x5ec1c8(0x147)](_0x4ba8de,_0x2d9fe1,_0xba81d0),assert[_0x5ec1c8(0x113)](_0xba81d0[_0x5ec1c8(0x122)]);}else this[_0x5ec1c8(0x147)](_0x1f9639,_0x2b2a5a,_0x2ab5d3);});}),describe('Tests\x20w/Specified\x20Excluded\x20URLs',()=>{const _0x2f9466=_0xe20f96,_0x3f8820={'ygVcQ':function(_0x170eb6,_0x318495){return _0x170eb6===_0x318495;},'nAqIq':_0x2f9466(0x13c),'oGSrX':function(_0x5e39c4,_0x42a3ec){return _0x5e39c4(_0x42a3ec);},'BibBQ':_0x2f9466(0x108),'HMMbN':_0x2f9466(0x12c),'iPXgG':_0x2f9466(0x10a),'TEBot':_0x2f9466(0x145),'GRCxv':_0x2f9466(0x153),'KDtoV':function(_0x40ab70,_0x548998){return _0x40ab70(_0x548998);},'zStyn':_0x2f9466(0x13e),'GSaLu':_0x2f9466(0x135),'IztCM':'aaaa','TtRsf':'Did\x20not\x20get\x20a\x20CSRF\x20token','KHKnG':function(_0x517619,_0x212331,_0x3c9be0){return _0x517619(_0x212331,_0x3c9be0);},'JAbgR':function(_0x9dd1a4,_0x222675,_0x2a7224){return _0x9dd1a4(_0x222675,_0x2a7224);}};before(()=>{const _0x237826=_0x2f9466;_0x3f8820['ygVcQ'](_0x3f8820[_0x237826(0x114)],_0x237826(0xff))?this['csrf']=_0x3e499e([_0x237826(0x108),_0x237826(0x10d)],[]):this[_0x237826(0x147)]=csurf(null,[_0x237826(0x13e),/\/detail\.*/i]);}),_0x3f8820[_0x2f9466(0x131)](it,_0x2f9466(0xfa),()=>{const _0x392786=_0x2f9466,_0x3e4e38=_0x3f8820[_0x392786(0x149)](mockRequest,{'method':_0x3f8820[_0x392786(0x142)],'cookies':{'csrfToken':_0x3f8820[_0x392786(0xfe)]},'body':{'_csrf':''},'originalUrl':_0x392786(0x13e)}),_0x5e2214=mockResponse({'cookie':sinon[_0x392786(0xfb)]()}),_0x3e3b61=sinon[_0x392786(0xfb)]();assert[_0x392786(0x109)](_0x3e4e38[_0x392786(0x12b)]),this[_0x392786(0x147)](_0x3e4e38,_0x5e2214,_0x3e3b61),assert[_0x392786(0x113)](_0x3e3b61[_0x392786(0x122)]),assert[_0x392786(0x124)](_0x3e4e38['csrfToken'],_0x3f8820[_0x392786(0x115)]);const _0x43a6d2=_0x3e4e38[_0x392786(0x12b)]();assert[_0x392786(0xf6)](_0x43a6d2,_0x392786(0x12c),'Not\x20reusing\x20csrf\x20tokens');}),_0x3f8820[_0x2f9466(0x131)](it,_0x2f9466(0x123),()=>{const _0x467dee=_0x2f9466;if(_0x3f8820[_0x467dee(0x152)](_0x467dee(0x119),_0x467dee(0x106)))this['csrf']=_0x53aa3f(null,[]);else{const _0x5366c1=_0x3f8820[_0x467dee(0x149)](mockRequest,{'method':_0x3f8820[_0x467dee(0x142)],'cookies':{'csrfToken':_0x467dee(0x12c)},'body':{'_csrf':''},'originalUrl':_0x3f8820['TEBot']}),_0x5c8656=mockResponse({'cookie':sinon['stub']()}),_0x3e8c01=sinon[_0x467dee(0xfb)]();assert[_0x467dee(0x109)](_0x5366c1[_0x467dee(0x12b)]),this[_0x467dee(0x147)](_0x5366c1,_0x5c8656,_0x3e8c01),assert[_0x467dee(0x113)](_0x3e8c01[_0x467dee(0x122)]),assert[_0x467dee(0x124)](_0x5366c1[_0x467dee(0x12b)],_0x467dee(0x10a));const _0x8e450b=_0x5366c1[_0x467dee(0x12b)]();assert[_0x467dee(0xf6)](_0x8e450b,'aaaaa',_0x3f8820[_0x467dee(0x107)]);}}),_0x3f8820[_0x2f9466(0x146)](it,_0x2f9466(0x11b),()=>{const _0x2920e8=_0x2f9466,_0x249198=_0x3f8820[_0x2920e8(0x104)](mockRequest,{'method':_0x3f8820[_0x2920e8(0x142)],'cookies':{},'body':{'_csrf':''},'originalUrl':_0x3f8820[_0x2920e8(0xfc)]}),_0xcfd8e7=_0x3f8820['KDtoV'](mockResponse,{'cookie':sinon[_0x2920e8(0xfb)]()}),_0x571534=sinon['stub']();assert[_0x2920e8(0x109)](_0x249198[_0x2920e8(0x12b)]),this['csrf'](_0x249198,_0xcfd8e7,_0x571534),assert[_0x2920e8(0x113)](_0x571534['calledOnce']),assert[_0x2920e8(0x124)](_0x249198[_0x2920e8(0x12b)],'Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request');const _0x5e1fa5=_0x249198[_0x2920e8(0x12b)]();assert['isString'](_0x5e1fa5);}),_0x3f8820[_0x2f9466(0x131)](it,'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect\x20and\x20the\x20URL\x20is\x20not\x20marked\x20as\x20excluded',()=>{const _0x59bd49=_0x2f9466,_0xb8c708=mockRequest({'method':_0x59bd49(0x108),'cookies':{'csrfToken':_0x3f8820[_0x59bd49(0x14a)]},'body':{'_csrf':_0x3f8820['IztCM']},'orignalUrl':_0x59bd49(0x141)}),_0xb68edf=_0x3f8820['KDtoV'](mockResponse,{'cookie':sinon[_0x59bd49(0xfb)]()}),_0x327430=sinon[_0x59bd49(0xfb)]();assert['isNotFunction'](_0xb8c708[_0x59bd49(0x12b)]);try{this['csrf'](_0xb8c708,_0xb68edf,_0x327430);}catch(_0x57a8a2){assert[_0x59bd49(0xf6)](_0x57a8a2[_0x59bd49(0x118)],'Error'),assert['include'](_0x57a8a2[_0x59bd49(0x10f)],_0x3f8820[_0x59bd49(0x13d)]);}assert[_0x59bd49(0x10e)](_0x327430[_0x59bd49(0x122)]);});});function _0x2ee7(_0x32fff7,_0x5c721d){const _0x1c1609=_0x1c16();return _0x2ee7=function(_0x2ee731,_0x184845){_0x2ee731=_0x2ee731-0xf3;let _0x484c00=_0x1c1609[_0x2ee731];return _0x484c00;},_0x2ee7(_0x32fff7,_0x5c721d);}function _0x1c16(){const _0x4a2531=['GET','TZDuv','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded','stub','zStyn','668lBGELK','HMMbN','KVZVD','LrxGZ','3fPLXvP','gsAbQ','GkEOT','KDtoV','NITOw','yaTYz','GRCxv','POST','isNotFunction','Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request','Tests\x20w/Specified\x20Included\x20Request\x20Methods','generates\x20token\x20for\x20non-POST\x20request','PUT','isFalse','message','Rfvri','SmRwx','include','isTrue','nAqIq','iPXgG','sinon','cookie','name','FCsre','1925182jWoFmi','generates\x20a\x20new\x20token\x20if\x20no\x20token\x20is\x20supplied','gXDmH','No\x20Cookie\x20middleware\x20is\x20installed','1552996DhhGFe','chai','sykeu','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect','calledOnce','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded\x20as\x20a\x20regexp','isFunction','args','OfFtA','WPTXy','OuhwX','Did\x20not\x20attach\x20a\x20csrfToken\x20function\x20to\x20req','mock-req-res','csrfToken','aaaaa','will\x20reuse\x20if\x20the\x20CSRF\x20token\x20already\x20exists\x20in\x20a\x20non-POST','rGfaW','7575KpwmYW','WsnpX','KHKnG','isbqr','allows\x20if\x20the\x20CSRF\x20token\x20is\x20correct','nhgdT','aaaabbb','6262236zQvBOr','aaaa','pUVjs','mocha','gAzrh','6BEiyCh','XEVcy','TtRsf','/detail','Did\x20not\x20get\x20a\x20CSRF\x20token','UDGIR','/somethingElse','BibBQ','wnNWr','FhFdz','/detail/603f31d8-9615-40a4-a609-f7bd9059ee6c','JAbgR','csrf','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20was\x20never\x20generated','oGSrX','GSaLu','Default\x20Options\x20Tests','./index','SGIbK','71834CASiUM','throws\x20internal\x20error\x20if\x20we\x20have\x20no\x20cookies','31962120lqNiFs','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20missing\x20in\x20body','ygVcQ','Not\x20reusing\x20csrf\x20tokens','Error','4376400MGaBlw','getCall','isString','oHkGp','equal','allows\x20if\x20the\x20method\x20is\x20specified\x20as\x20not\x20included'];_0x1c16=function(){return _0x4a2531;};return _0x1c16();}