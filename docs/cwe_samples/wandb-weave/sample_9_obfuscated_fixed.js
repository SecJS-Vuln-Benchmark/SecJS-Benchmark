const _0x1e4914=_0x12f6;(function(_0xb5c37f,_0x5a6e0d){const _0x6b4c9a=_0x12f6,_0x12c1dd=_0xb5c37f();while(!![]){try{const _0x16a83a=parseInt(_0x6b4c9a(0x117))/0x1*(-parseInt(_0x6b4c9a(0x17e))/0x2)+parseInt(_0x6b4c9a(0x132))/0x3*(parseInt(_0x6b4c9a(0x128))/0x4)+-parseInt(_0x6b4c9a(0x126))/0x5*(-parseInt(_0x6b4c9a(0x16e))/0x6)+parseInt(_0x6b4c9a(0x14e))/0x7*(parseInt(_0x6b4c9a(0x174))/0x8)+-parseInt(_0x6b4c9a(0x13e))/0x9+parseInt(_0x6b4c9a(0x179))/0xa+-parseInt(_0x6b4c9a(0x183))/0xb;if(_0x16a83a===_0x5a6e0d)break;else _0x12c1dd['push'](_0x12c1dd['shift']());}catch(_0x4db86b){_0x12c1dd['push'](_0x12c1dd['shift']());}}}(_0x1e5c,0xcf8c9));const {assert,expect}=require('chai'),{describe,before,beforeEach,after,afterEach,it}=require(_0x1e4914(0x10f)),sinon=require(_0x1e4914(0x158)),{mockRequest,mockResponse}=require(_0x1e4914(0x156)),{randomUUID,randomBytes}=require('crypto'),csurf=require(_0x1e4914(0x168)),{encryptCookie,decryptCookie,verifyCsrf}=require(_0x1e4914(0x124));function _0x12f6(_0x1b490f,_0x2e9b78){const _0x1e5c30=_0x1e5c();return _0x12f6=function(_0x12f6d7,_0x28239c){_0x12f6d7=_0x12f6d7-0x103;let _0x433106=_0x1e5c30[_0x12f6d7];return _0x433106;},_0x12f6(_0x1b490f,_0x2e9b78);}describe(_0x1e4914(0x112),()=>{const _0x1ecd9f=_0x1e4914,_0x27630a={'yKtdS':function(_0x35e54f,_0xf58ef2,_0x373fb4){return _0x35e54f(_0xf58ef2,_0x373fb4);},'gOWcM':_0x1ecd9f(0x185),'YwjFv':function(_0x5c9613,_0x197d46,_0x227db7,_0xd56901){return _0x5c9613(_0x197d46,_0x227db7,_0xd56901);},'yOomE':function(_0x115ea8,_0x4976a9,_0x1ecded,_0x8813f3){return _0x115ea8(_0x4976a9,_0x1ecded,_0x8813f3);},'NCoXI':function(_0x2c98cf,_0x166024){return _0x2c98cf(_0x166024);},'zPiLD':_0x1ecd9f(0x176),'xXFec':function(_0x42a6a6){return _0x42a6a6();},'JUkYf':function(_0x355752,_0x3be532,_0x1c3e0c,_0x396380){return _0x355752(_0x3be532,_0x1c3e0c,_0x396380);},'PSAfP':_0x1ecd9f(0x136),'nIeJV':function(_0x46f120,_0x2572a9){return _0x46f120(_0x2572a9);},'cigPW':function(_0x41306c,_0x47ec04,_0x4e86c2){return _0x41306c(_0x47ec04,_0x4e86c2);}};_0x27630a['nIeJV'](before,()=>{}),_0x27630a[_0x1ecd9f(0x170)](after,()=>{}),_0x27630a[_0x1ecd9f(0x11a)](it,_0x1ecd9f(0x17d),()=>{const _0x1919f5=_0x1ecd9f,_0x990729=_0x1919f5(0x149),_0x5dfde2=randomUUID(),_0x4ae6d2=_0x27630a[_0x1919f5(0x111)](encryptCookie,_0x5dfde2,_0x990729);assert[_0x1919f5(0x15e)](_0x5dfde2,_0x4ae6d2,_0x27630a[_0x1919f5(0x160)]),assert[_0x1919f5(0x115)](_0x27630a[_0x1919f5(0x187)](verifyCsrf,_0x5dfde2,_0x4ae6d2,_0x990729)),assert[_0x1919f5(0x109)](_0x27630a[_0x1919f5(0x13a)](verifyCsrf,_0x5dfde2,_0x4ae6d2,_0x27630a[_0x1919f5(0x170)](randomBytes,0x10)[_0x1919f5(0x147)]('hex')),_0x27630a[_0x1919f5(0x181)]),assert['isFalse'](_0x27630a[_0x1919f5(0x187)](verifyCsrf,_0x27630a[_0x1919f5(0x15c)](randomUUID),_0x4ae6d2,_0x990729),_0x1919f5(0x130)),assert[_0x1919f5(0x109)](verifyCsrf('',_0x4ae6d2,_0x990729),'Should\x20not\x20verify\x20random\x20blank\x20tokens'),assert[_0x1919f5(0x109)](_0x27630a['JUkYf'](verifyCsrf,null,_0x4ae6d2,_0x990729),_0x27630a[_0x1919f5(0x169)]);});}),describe('Default\x20Options\x20Tests',()=>{const _0xe003e3=_0x1e4914,_0x3c4d9a={'txvHO':_0xe003e3(0x113),'EfjVk':function(_0x44c6de,_0x30326a){return _0x44c6de===_0x30326a;},'xyGwB':'EXqOG','mnhtp':'gbSRF','ULpZg':_0xe003e3(0x149),'bdbkp':function(_0x3b4315,_0x3069e1){return _0x3b4315(_0x3069e1);},'kqyDu':function(_0x3a6990){return _0x3a6990();},'QwjFf':function(_0x193972,_0x5c5768,_0x4004ca){return _0x193972(_0x5c5768,_0x4004ca);},'VGLRK':_0xe003e3(0x185),'CadHp':_0xe003e3(0x176),'UvKbq':function(_0x4e5563,_0x3d36e7,_0x25d5db,_0x22718e){return _0x4e5563(_0x3d36e7,_0x25d5db,_0x22718e);},'GYGzb':_0xe003e3(0x130),'SaUuj':'Should\x20not\x20verify\x20random\x20null\x20tokens','oZQwj':function(_0x223478,_0x5cf322){return _0x223478===_0x5cf322;},'JBYbp':_0xe003e3(0x18a),'KtdDY':'POST','bLOAF':function(_0x47efd2,_0x232029,_0x1eabc0){return _0x47efd2(_0x232029,_0x1eabc0);},'zwavC':'aaaa','deiLh':'pjmlt','yOiFL':function(_0x43a946,_0x34bfe7,_0x5644f8){return _0x43a946(_0x34bfe7,_0x5644f8);},'yMMcI':_0xe003e3(0x14f),'fSOGb':function(_0x9652f2,_0x5bfc3b){return _0x9652f2(_0x5bfc3b);},'ELkJl':function(_0x28aeec,_0x7414df){return _0x28aeec!==_0x7414df;},'VVMlq':'BGguL','RUVeB':'Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token','STelz':_0xe003e3(0x11f),'wTdON':function(_0x9c01e,_0x597c02,_0x2e39a1){return _0x9c01e(_0x597c02,_0x2e39a1);},'JeTUi':function(_0x4fa7c5,_0x185e7e,_0x459718){return _0x4fa7c5(_0x185e7e,_0x459718);},'tYnBh':'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20missing\x20in\x20body','hDIIS':'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20was\x20never\x20generated'};_0x3c4d9a['fSOGb'](before,()=>{const _0x20139c=_0xe003e3,_0x3cde71={'VKKkA':_0x3c4d9a[_0x20139c(0x125)]};_0x3c4d9a[_0x20139c(0x154)](_0x3c4d9a[_0x20139c(0x133)],_0x3c4d9a['mnhtp'])?(_0x195bf1[_0x20139c(0x12e)](_0x488bae['name'],_0x3cde71['VKKkA'],_0x4aca5d),_0x37d582[_0x20139c(0x12e)](_0x54e93f['message'],_0x20139c(0x103))):(this[_0x20139c(0x155)]=_0x3c4d9a['ULpZg'],this[_0x20139c(0x14d)]=_0x3c4d9a[_0x20139c(0x104)](csurf,this[_0x20139c(0x155)]));}),it(_0xe003e3(0x180),()=>{const _0x25ae3d=_0xe003e3;assert[_0x25ae3d(0x15b)](()=>csurf(_0x25ae3d(0x13b)));}),it(_0x3c4d9a['STelz'],()=>{const _0x4d2a8e=_0xe003e3,_0x105312=mockRequest({'cookies':null}),_0xd10047=mockResponse({'cookie':null}),_0x3a7e4b=sinon[_0x4d2a8e(0x145)]();try{this[_0x4d2a8e(0x14d)](_0x105312,_0xd10047,_0x3a7e4b);}catch(_0x10068d){if(_0x3c4d9a['oZQwj']('gfqxC',_0x3c4d9a['JBYbp']))assert[_0x4d2a8e(0x12e)](_0x10068d[_0x4d2a8e(0x148)],'Error',_0x10068d),assert['equal'](_0x10068d[_0x4d2a8e(0x17b)],_0x4d2a8e(0x103));else{const _0x9a4d6f=_0x4d2a8e(0x149),_0x295908=_0x3c4d9a[_0x4d2a8e(0x12a)](_0x1920a1),_0x3f8135=_0x3c4d9a['QwjFf'](_0x13d2bb,_0x295908,_0x9a4d6f);_0xabe9ae['notEqual'](_0x295908,_0x3f8135,_0x3c4d9a[_0x4d2a8e(0x164)]),_0x4f59fc[_0x4d2a8e(0x115)](_0x1c9785(_0x295908,_0x3f8135,_0x9a4d6f)),_0x4c2133['isFalse'](_0x4377f9(_0x295908,_0x3f8135,_0x130869(0x10)['toString'](_0x4d2a8e(0x10d))),_0x3c4d9a[_0x4d2a8e(0x152)]),_0x152879[_0x4d2a8e(0x109)](_0x3c4d9a[_0x4d2a8e(0x135)](_0x271ef5,_0x39d93c(),_0x3f8135,_0x9a4d6f),_0x3c4d9a[_0x4d2a8e(0x134)]),_0x5b3a7f['isFalse'](_0x7d23ae('',_0x3f8135,_0x9a4d6f),_0x4d2a8e(0x16a)),_0x287812[_0x4d2a8e(0x109)](_0x1a695a(null,_0x3f8135,_0x9a4d6f),_0x3c4d9a[_0x4d2a8e(0x16b)]);}}}),_0x3c4d9a[_0xe003e3(0x16d)](it,_0xe003e3(0x17a),()=>{const _0x423d2a=_0xe003e3,_0x449ac6=_0x3c4d9a['bdbkp'](mockRequest,{'method':_0x423d2a(0x13d),'signedCookies':{},'body':{}}),_0x376adf=mockResponse({'cookie':sinon[_0x423d2a(0x145)]()}),_0x2ffe70=sinon[_0x423d2a(0x145)]();assert[_0x423d2a(0x162)](_0x449ac6[_0x423d2a(0x141)]),this[_0x423d2a(0x14d)](_0x449ac6,_0x376adf,_0x2ffe70),assert[_0x423d2a(0x121)](_0x449ac6[_0x423d2a(0x141)]),_0x449ac6['csrfToken'](),assert[_0x423d2a(0x115)](_0x376adf[_0x423d2a(0x182)][_0x423d2a(0x143)]),assert[_0x423d2a(0x12e)](_0x376adf[_0x423d2a(0x182)][_0x423d2a(0x12c)](0x0)[_0x423d2a(0x122)][0x0],_0x423d2a(0x141)),assert['isString'](_0x376adf[_0x423d2a(0x182)]['getCall'](0x0)[_0x423d2a(0x122)][0x1]);}),_0x3c4d9a[_0xe003e3(0x10c)](it,_0xe003e3(0x114),()=>{const _0x117a5c=_0xe003e3,_0xe4551f=mockRequest({'method':_0x3c4d9a[_0x117a5c(0x12f)],'signedCookies':{'csrfToken':_0x3c4d9a[_0x117a5c(0x150)](encryptCookie,_0x3c4d9a[_0x117a5c(0x14a)],this[_0x117a5c(0x155)])},'body':{'_csrf':_0x3c4d9a[_0x117a5c(0x14a)]}}),_0x3919c4=mockResponse({'cookie':sinon[_0x117a5c(0x145)]()}),_0x25858f=sinon[_0x117a5c(0x145)]();assert['isNotFunction'](_0xe4551f[_0x117a5c(0x141)]),this[_0x117a5c(0x14d)](_0xe4551f,_0x3919c4,_0x25858f),assert[_0x117a5c(0x115)](_0x25858f[_0x117a5c(0x143)]);}),it('does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect',()=>{const _0x16177f=_0xe003e3;if('USdUZ'===_0x3c4d9a[_0x16177f(0x139)])_0x2b7d48[_0x16177f(0x15b)](()=>_0x3d6ade(_0x16177f(0x13b)));else{const _0x6973da=_0x3c4d9a['bdbkp'](mockRequest,{'method':_0x3c4d9a[_0x16177f(0x12f)],'signedCookies':{'csrfToken':_0x3c4d9a['yOiFL'](encryptCookie,_0x3c4d9a['yMMcI'],this['secret'])},'body':{'_csrf':_0x3c4d9a[_0x16177f(0x14a)]}}),_0x2d00db=_0x3c4d9a[_0x16177f(0x104)](mockResponse,{'cookie':sinon[_0x16177f(0x145)]()}),_0x55c0fd=sinon[_0x16177f(0x145)]();assert[_0x16177f(0x162)](_0x6973da[_0x16177f(0x141)]);try{this['csrf'](_0x6973da,_0x2d00db,_0x55c0fd);}catch(_0x53899c){assert[_0x16177f(0x12e)](_0x53899c[_0x16177f(0x148)],_0x16177f(0x113)),assert['include'](_0x53899c[_0x16177f(0x17b)],_0x16177f(0x11e));}assert[_0x16177f(0x109)](_0x55c0fd[_0x16177f(0x143)]);}}),_0x3c4d9a[_0xe003e3(0x16d)](it,_0x3c4d9a[_0xe003e3(0x138)],()=>{const _0x598af8=_0xe003e3,_0x3c1701=_0x3c4d9a[_0x598af8(0x119)](mockRequest,{'method':_0x3c4d9a['KtdDY'],'signedCookies':{'csrfToken':encryptCookie(_0x598af8(0x14f),this['secret'])},'body':{}}),_0x47af40=mockResponse({'cookie':sinon[_0x598af8(0x145)]()}),_0x17aaf3=sinon[_0x598af8(0x145)]();assert[_0x598af8(0x162)](_0x3c1701['csrfToken']);try{this['csrf'](_0x3c1701,_0x47af40,_0x17aaf3);}catch(_0x27a115){assert[_0x598af8(0x12e)](_0x27a115[_0x598af8(0x148)],_0x598af8(0x113)),assert[_0x598af8(0x184)](_0x27a115[_0x598af8(0x17b)],_0x598af8(0x11e));}assert[_0x598af8(0x109)](_0x17aaf3[_0x598af8(0x143)]);}),it(_0x3c4d9a['hDIIS'],()=>{const _0x5307e8=_0xe003e3,_0x2d200b=mockRequest({'method':_0x3c4d9a['KtdDY'],'signedCookies':{},'body':{}}),_0x3fe146=mockResponse({'cookie':sinon[_0x5307e8(0x145)]()}),_0x3632a1=sinon[_0x5307e8(0x145)]();assert[_0x5307e8(0x162)](_0x2d200b['csrfToken']);try{this['csrf'](_0x2d200b,_0x3fe146,_0x3632a1);}catch(_0x392793){_0x3c4d9a[_0x5307e8(0x118)](_0x5307e8(0x178),_0x3c4d9a['VVMlq'])?this[_0x5307e8(0x14d)](_0x339fb2,_0x130276,_0x482f33):(assert[_0x5307e8(0x12e)](_0x392793['name'],_0x3c4d9a[_0x5307e8(0x125)]),assert[_0x5307e8(0x184)](_0x392793[_0x5307e8(0x17b)],_0x3c4d9a[_0x5307e8(0x172)]));}assert[_0x5307e8(0x109)](_0x3632a1[_0x5307e8(0x143)]);});}),describe(_0x1e4914(0x151),()=>{const _0x4fbed2=_0x1e4914,_0x272dc8={'ByXxO':function(_0x584e37,_0xb37add,_0x5cfa7d,_0x111c86){return _0x584e37(_0xb37add,_0x5cfa7d,_0x111c86);},'Ykcyl':'POST','YRahY':_0x4fbed2(0x107),'luzKm':function(_0x1636b9,_0x31f33d){return _0x1636b9(_0x31f33d);},'FSbVE':function(_0x32d2f9,_0x590698,_0xea3725){return _0x32d2f9(_0x590698,_0xea3725);},'jJqAj':_0x4fbed2(0x157),'ODgSL':_0x4fbed2(0x11e),'VuKGa':function(_0x598f83,_0x5dbc72){return _0x598f83(_0x5dbc72);},'VYlNe':'jBQSP','HfPfM':function(_0x112460,_0x361e43){return _0x112460(_0x361e43);},'fLQJj':'GET','ikOTo':'does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect','YxySD':'allows\x20if\x20the\x20method\x20is\x20specified\x20as\x20not\x20included'};_0x272dc8['luzKm'](before,()=>{const _0x4fb0ef=_0x4fbed2;this[_0x4fb0ef(0x155)]=_0x4fb0ef(0x149),this['csrf']=_0x272dc8[_0x4fb0ef(0x15a)](csurf,this[_0x4fb0ef(0x155)],[_0x272dc8[_0x4fb0ef(0x140)],_0x272dc8['YRahY']],[]);}),_0x272dc8[_0x4fbed2(0x11c)](it,_0x4fbed2(0x114),()=>{const _0x415575=_0x4fbed2,_0x249261=_0x272dc8[_0x415575(0x171)](mockRequest,{'method':_0x415575(0x107),'signedCookies':{'csrfToken':_0x272dc8[_0x415575(0x11c)](encryptCookie,'aaaa',this[_0x415575(0x155)])},'body':{'_csrf':_0x415575(0x157)}}),_0x5b4f60=mockResponse({'cookie':sinon[_0x415575(0x145)]()}),_0x434eb0=sinon['stub']();assert[_0x415575(0x162)](_0x249261[_0x415575(0x141)]),this[_0x415575(0x14d)](_0x249261,_0x5b4f60,_0x434eb0),assert['isTrue'](_0x434eb0[_0x415575(0x143)]);}),it(_0x272dc8[_0x4fbed2(0x12b)],()=>{const _0x2db797=_0x4fbed2,_0x4cc343=mockRequest({'method':_0x2db797(0x107),'signedCookies':{'csrfToken':encryptCookie(_0x2db797(0x14f),this[_0x2db797(0x155)])},'body':{'_csrf':_0x272dc8[_0x2db797(0x131)]}}),_0x29ae35=_0x272dc8['luzKm'](mockResponse,{'cookie':sinon['stub']()}),_0x1d7ebf=sinon['stub']();assert[_0x2db797(0x162)](_0x4cc343[_0x2db797(0x141)]);try{this[_0x2db797(0x14d)](_0x4cc343,_0x29ae35,_0x1d7ebf);}catch(_0x523a22){assert['equal'](_0x523a22[_0x2db797(0x148)],_0x2db797(0x113)),assert[_0x2db797(0x184)](_0x523a22['message'],_0x272dc8[_0x2db797(0x188)]);}assert[_0x2db797(0x109)](_0x1d7ebf[_0x2db797(0x143)]);}),_0x272dc8[_0x4fbed2(0x11c)](it,_0x272dc8[_0x4fbed2(0x13c)],()=>{const _0x234939=_0x4fbed2,_0x17b8ba={'GAIoU':_0x234939(0x107),'HlFVL':function(_0x29d458,_0x346abf,_0x17f8a2){return _0x29d458(_0x346abf,_0x17f8a2);},'itWiL':function(_0x239263,_0x4c3924){const _0xc79c19=_0x234939;return _0x272dc8[_0xc79c19(0x16f)](_0x239263,_0x4c3924);}};if(_0x272dc8[_0x234939(0x11b)]===_0x272dc8[_0x234939(0x11b)]){const _0x372a5e=_0x272dc8[_0x234939(0x10a)](mockRequest,{'method':_0x272dc8[_0x234939(0x186)],'signedCookies':{'csrfToken':encryptCookie(_0x272dc8[_0x234939(0x131)],this[_0x234939(0x155)])},'body':{'_csrf':''}}),_0x2cd3d6=mockResponse({'cookie':sinon[_0x234939(0x145)]()}),_0x18311b=sinon['stub']();assert[_0x234939(0x162)](_0x372a5e[_0x234939(0x141)]),this[_0x234939(0x14d)](_0x372a5e,_0x2cd3d6,_0x18311b),assert['isTrue'](_0x18311b['calledOnce']);}else{const _0x18e717=_0xafc2f7({'method':_0x17b8ba['GAIoU'],'signedCookies':{'csrfToken':_0x17b8ba['HlFVL'](_0x4b7275,_0x234939(0x157),this['secret'])},'body':{'_csrf':'aaaa'}}),_0x4911b1=_0x17b8ba[_0x234939(0x144)](_0xfc6ff,{'cookie':_0x54ffdc[_0x234939(0x145)]()}),_0x292a9c=_0x559205[_0x234939(0x145)]();_0x56c5bb[_0x234939(0x162)](_0x18e717[_0x234939(0x141)]),this[_0x234939(0x14d)](_0x18e717,_0x4911b1,_0x292a9c),_0x7683ed['isTrue'](_0x292a9c['calledOnce']);}});}),describe(_0x1e4914(0x11d),()=>{const _0x2e9151=_0x1e4914,_0x1c759a={'Bvaab':function(_0x2d2f14,_0x26f079,_0x1a8eed){return _0x2d2f14(_0x26f079,_0x1a8eed);},'MNoUc':_0x2e9151(0x129),'gDryy':_0x2e9151(0x146),'nzVKz':function(_0x539e78,_0x97d338){return _0x539e78(_0x97d338);},'zBBfn':_0x2e9151(0x175),'aJhkJ':function(_0x27cb7b,_0x4daa94){return _0x27cb7b(_0x4daa94);},'hDUph':_0x2e9151(0x113),'FlSbg':'No\x20Cookie\x20middleware\x20is\x20installed','JxiFY':function(_0x1093bf,_0x47db0d){return _0x1093bf===_0x47db0d;},'sUVit':_0x2e9151(0x108),'TZtgX':function(_0x4d97b8,_0x2100bb){return _0x4d97b8(_0x2100bb);},'pERzi':_0x2e9151(0x159),'oIEQY':_0x2e9151(0x14f),'vOKSM':_0x2e9151(0x157),'oUuTD':_0x2e9151(0x137),'KgEhO':function(_0x307675,_0x372e4d){return _0x307675(_0x372e4d);},'bidFF':_0x2e9151(0x123),'vXzCc':function(_0x307f81,_0x43233f,_0x418b62){return _0x307f81(_0x43233f,_0x418b62);},'atMzc':_0x2e9151(0x127),'mtXFh':_0x2e9151(0x10b),'CHOTC':_0x2e9151(0x189)};before(()=>{const _0x3348a1=_0x2e9151;this[_0x3348a1(0x155)]=_0x3348a1(0x149),this['csrf']=csurf(this[_0x3348a1(0x155)],null,['/detail',/\/detail\.*/i]);}),it(_0x2e9151(0x161),()=>{const _0xda2da=_0x2e9151,_0x112edf=mockRequest({'method':_0xda2da(0x159),'signedCookies':{'csrfToken':_0x1c759a['Bvaab'](encryptCookie,_0x1c759a['MNoUc'],this[_0xda2da(0x155)])},'body':{'_csrf':''},'originalUrl':_0x1c759a['gDryy']}),_0x2959de=_0x1c759a[_0xda2da(0x16c)](mockResponse,{'cookie':sinon[_0xda2da(0x145)]()}),_0x473cfc=sinon[_0xda2da(0x145)]();assert[_0xda2da(0x162)](_0x112edf[_0xda2da(0x141)]),this[_0xda2da(0x14d)](_0x112edf,_0x2959de,_0x473cfc),assert[_0xda2da(0x115)](_0x473cfc[_0xda2da(0x143)]),assert[_0xda2da(0x121)](_0x112edf['csrfToken'],_0x1c759a[_0xda2da(0x153)]);}),_0x1c759a['vXzCc'](it,_0x1c759a[_0x2e9151(0x15d)],()=>{const _0x15e157=_0x2e9151,_0x509cda=_0x1c759a[_0x15e157(0x16c)](mockRequest,{'method':'POST','signedCookies':{'csrfToken':encryptCookie(_0x1c759a[_0x15e157(0x167)],this[_0x15e157(0x155)])},'body':{'_csrf':''},'originalUrl':_0x15e157(0x106)}),_0x3e46c3=mockResponse({'cookie':sinon[_0x15e157(0x145)]()}),_0x328174=sinon[_0x15e157(0x145)]();assert[_0x15e157(0x162)](_0x509cda[_0x15e157(0x141)]),this[_0x15e157(0x14d)](_0x509cda,_0x3e46c3,_0x328174),assert[_0x15e157(0x115)](_0x328174[_0x15e157(0x143)]),assert[_0x15e157(0x121)](_0x509cda[_0x15e157(0x141)],_0x15e157(0x175));}),it(_0x1c759a[_0x2e9151(0x165)],()=>{const _0x1cfbfa=_0x2e9151,_0x4a9dbe=_0x1c759a[_0x1cfbfa(0x105)](mockRequest,{'method':'POST','signedCookies':{},'body':{'_csrf':''},'originalUrl':_0x1c759a[_0x1cfbfa(0x110)]}),_0x2fe8f5=mockResponse({'cookie':sinon[_0x1cfbfa(0x145)]()}),_0x17e861=sinon[_0x1cfbfa(0x145)]();assert[_0x1cfbfa(0x162)](_0x4a9dbe['csrfToken']),this[_0x1cfbfa(0x14d)](_0x4a9dbe,_0x2fe8f5,_0x17e861),assert[_0x1cfbfa(0x115)](_0x17e861[_0x1cfbfa(0x143)]),assert[_0x1cfbfa(0x121)](_0x4a9dbe['csrfToken'],_0x1c759a[_0x1cfbfa(0x153)]);const _0x132f25=_0x4a9dbe[_0x1cfbfa(0x141)]();assert[_0x1cfbfa(0x163)](_0x132f25);}),it(_0x1c759a['CHOTC'],()=>{const _0xd17745=_0x2e9151,_0x1c0e96={'GTDWq':_0xd17745(0x113),'iYndT':function(_0x22dc05,_0x15b2f9){return _0x22dc05(_0x15b2f9);},'devRf':_0x1c759a[_0xd17745(0x120)]};if(_0x1c759a[_0xd17745(0x173)]('FlwrF',_0x1c759a[_0xd17745(0x177)])){const _0x4c6b48=_0x1c759a[_0xd17745(0x116)](mockRequest,{'method':_0x1c759a[_0xd17745(0x17f)],'signedCookies':{'csrfToken':_0x1c759a['oIEQY']},'body':{'_csrf':_0x1c759a[_0xd17745(0x13f)]},'orignalUrl':_0x1c759a[_0xd17745(0x15f)]}),_0xf06736=_0x1c759a[_0xd17745(0x14c)](mockResponse,{'cookie':sinon[_0xd17745(0x145)]()}),_0x11c800=sinon[_0xd17745(0x145)]();assert[_0xd17745(0x162)](_0x4c6b48[_0xd17745(0x141)]);try{_0x1c759a[_0xd17745(0x173)](_0xd17745(0x166),'nkDsK')?(_0x586598[_0xd17745(0x12e)](_0xf31366['name'],_0x1c759a['hDUph']),_0x1876d6[_0xd17745(0x184)](_0x4ce0b1[_0xd17745(0x17b)],'Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token')):this[_0xd17745(0x14d)](_0x4c6b48,_0xf06736,_0x11c800);}catch(_0x83b221){_0x1c759a[_0xd17745(0x14b)]!=='JDdpe'?(assert[_0xd17745(0x12e)](_0x83b221[_0xd17745(0x148)],_0x1c759a[_0xd17745(0x142)]),assert[_0xd17745(0x184)](_0x83b221[_0xd17745(0x17b)],_0xd17745(0x11e))):(_0xc3926b[_0xd17745(0x12e)](_0x562e75[_0xd17745(0x148)],_0x1c0e96['GTDWq']),_0x41c94c[_0xd17745(0x184)](_0x2d9f1e[_0xd17745(0x17b)],_0xd17745(0x11e)));}assert[_0xd17745(0x109)](_0x11c800[_0xd17745(0x143)]);}else{const _0x1d6030=_0x1c0e96['iYndT'](_0x1e32af,{'cookies':null}),_0x5c4f5b=_0x1c0e96[_0xd17745(0x17c)](_0x50e8a5,{'cookie':null}),_0x1c261a=_0xe70ad5[_0xd17745(0x145)]();try{this[_0xd17745(0x14d)](_0x1d6030,_0x5c4f5b,_0x1c261a);}catch(_0x5538db){_0x1cdfdc[_0xd17745(0x12e)](_0x5538db[_0xd17745(0x148)],_0x1c0e96[_0xd17745(0x10e)],_0x5538db),_0x5ef303[_0xd17745(0x12e)](_0x5538db['message'],_0x1c0e96[_0xd17745(0x12d)]);}}});});function _0x1e5c(){const _0x135c56=['159196CLXuqk','ELkJl','fSOGb','cigPW','VYlNe','FSbVE','Tests\x20w/Specified\x20Excluded\x20URLs','Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token','throws\x20internal\x20error\x20if\x20we\x20have\x20no\x20cookies','FlSbg','isFunction','args','sbaLJ','./encryption','txvHO','10esIzNB','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded\x20as\x20a\x20regexp','4IYCsWk','aaaaa','kqyDu','ikOTo','getCall','devRf','equal','KtdDY','Should\x20not\x20verify\x20random\x20UUID\x20tokens','jJqAj','4314162rzkkBD','xyGwB','GYGzb','UvKbq','Should\x20not\x20verify\x20random\x20null\x20tokens','/somethingElse','tYnBh','deiLh','yOomE','imnotlongenough','YxySD','GET','6416415kaalRL','vOKSM','Ykcyl','csrfToken','hDUph','calledOnce','itWiL','stub','/detail','toString','name','123456789iamasecret987654321look','zwavC','bidFF','KgEhO','csrf','70HiuduL','aaaabbb','bLOAF','Tests\x20w/Specified\x20Included\x20Request\x20Methods','CadHp','zBBfn','EfjVk','secret','mock-req-res','aaaa','sinon','POST','ByXxO','throws','xXFec','atMzc','notEqual','oUuTD','gOWcM','allows\x20if\x20the\x20URL\x20is\x20marked\x20as\x20excluded','isNotFunction','isString','VGLRK','mtXFh','zAYnP','MNoUc','./index','PSAfP','Should\x20not\x20verify\x20random\x20blank\x20tokens','SaUuj','nzVKz','wTdON','4118382Ifewxu','VuKGa','NCoXI','luzKm','RUVeB','JxiFY','1356200pEufWX','Did\x20not\x20add\x20the\x20csrfToken\x20to\x20this\x20request','Should\x20not\x20be\x20able\x20to\x20verify\x20without\x20the\x20secret','sUVit','BGguL','13214380jlVXdT','generates\x20token\x20for\x20non-POST\x20request','message','iYndT','will\x20encrypt\x20and\x20decrypt\x20a\x20cookie','14RzDRsL','pERzi','throw\x20internal\x20error\x20if\x20our\x20secret\x20is\x20not\x20long\x20enough','zPiLD','cookie','34651188GxaOqQ','include','Both\x20are\x20equal\x20as\x20plain\x20string\x20and\x20shouldn\x27t\x20be','fLQJj','YwjFv','ODgSL','does\x20not\x20allow\x20if\x20the\x20CSRF\x20token\x20is\x20incorrect\x20and\x20the\x20URL\x20is\x20not\x20marked\x20as\x20excluded','gfqxC','No\x20Cookie\x20middleware\x20is\x20installed','bdbkp','aJhkJ','/detail/603f31d8-9615-40a4-a609-f7bd9059ee6c','PUT','FlwrF','isFalse','HfPfM','generates\x20a\x20new\x20token\x20if\x20no\x20token\x20is\x20supplied','JeTUi','hex','GTDWq','mocha','gDryy','yKtdS','Cookie\x20Encryption\x20Tests','Error','allows\x20if\x20the\x20CSRF\x20token\x20is\x20correct','isTrue','TZtgX'];_0x1e5c=function(){return _0x135c56;};return _0x1e5c();}