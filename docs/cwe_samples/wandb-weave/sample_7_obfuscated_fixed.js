const _0x543c9d=_0x2e49;(function(_0x105a3c,_0xcce6a0){const _0xc59878=_0x2e49,_0x3fe87d=_0x105a3c();while(!![]){try{const _0x7fcf4f=parseInt(_0xc59878(0xe9))/0x1+-parseInt(_0xc59878(0xf1))/0x2+parseInt(_0xc59878(0xe8))/0x3*(-parseInt(_0xc59878(0xec))/0x4)+parseInt(_0xc59878(0xf2))/0x5*(parseInt(_0xc59878(0xe0))/0x6)+-parseInt(_0xc59878(0xf4))/0x7*(parseInt(_0xc59878(0xdd))/0x8)+-parseInt(_0xc59878(0xeb))/0x9*(-parseInt(_0xc59878(0xf7))/0xa)+-parseInt(_0xc59878(0xda))/0xb;if(_0x7fcf4f===_0xcce6a0)break;else _0x3fe87d['push'](_0x3fe87d['shift']());}catch(_0x3c6444){_0x3fe87d['push'](_0x3fe87d['shift']());}}}(_0x4024,0x42912));const {randomUUID}=require(_0x543c9d(0xe7)),{encryptCookie,verifyCsrf}=require('./encryption'),cookieParams={'httpOnly':!![],'sameSite':_0x543c9d(0xe3),'signed':!![],'maxAge':0x493e0},csurf=(_0x658f16,_0x4a997a,_0x529b7f)=>{const _0x474cd7=_0x543c9d,_0x356e99={'lWQaC':function(_0x278f4a){return _0x278f4a();},'Tfscg':'csrfToken','phruc':function(_0xeb580c){return _0xeb580c();},'MJZZw':function(_0x168b26,_0x35716b){return _0x168b26>_0x35716b;},'tXvdw':_0x474cd7(0xd7),'muJzy':_0x474cd7(0xd2),'zXmki':_0x474cd7(0xd8)};if(!_0x4a997a)_0x4a997a=[_0x356e99[_0x474cd7(0xd9)],_0x356e99[_0x474cd7(0xea)],_0x474cd7(0xe1)];if(_0x658f16[_0x474cd7(0xd1)]!=0x20)throw new Error(_0x356e99[_0x474cd7(0xd4)]);return(_0x58c84d,_0x36d484,_0x25c1cf)=>{const _0x209fb2=_0x474cd7,_0x52f5e2={'zxvJY':function(_0x305f0a){const _0x3fd4b7=_0x2e49;return _0x356e99[_0x3fd4b7(0xf5)](_0x305f0a);},'mbSCT':_0x356e99[_0x209fb2(0xe6)]};if(!_0x58c84d[_0x209fb2(0xdb)]||!_0x36d484[_0x209fb2(0xf6)]||!_0x58c84d[_0x209fb2(0xf3)])throw new Error('No\x20Cookie\x20middleware\x20is\x20installed');if(_0x356e99['MJZZw'](_0x529b7f?.[_0x209fb2(0xd0)](_0x166ce2=>_0x166ce2==_0x58c84d[_0x209fb2(0xde)]||_0x166ce2[_0x209fb2(0xe2)]&&_0x166ce2[_0x209fb2(0xe2)](_0x58c84d[_0x209fb2(0xde)]))[_0x209fb2(0xd1)],0x0))return _0x58c84d[_0x209fb2(0xef)]=()=>{const _0x5aecc0=_0x209fb2,_0x2392a7=_0x356e99[_0x5aecc0(0xf0)](randomUUID);return _0x36d484['cookie'](_0x356e99['Tfscg'],encryptCookie(_0x2392a7,_0x658f16),cookieParams),_0x2392a7;},_0x356e99[_0x209fb2(0xf5)](_0x25c1cf);else{if(_0x4a997a[_0x209fb2(0xe4)](_0x58c84d[_0x209fb2(0xdf)])){const {csrfToken:_0x561818}=_0x58c84d[_0x209fb2(0xf3)];if(_0x561818!=undefined&&verifyCsrf(_0x58c84d['body']?.['_csrf'],_0x561818,_0x658f16))return _0x36d484[_0x209fb2(0xf6)](_0x209fb2(0xef),null,cookieParams),_0x356e99[_0x209fb2(0xf5)](_0x25c1cf);else throw new Error(_0x209fb2(0xee)+_0x58c84d[_0x209fb2(0xdf)]+'\x20'+_0x58c84d[_0x209fb2(0xde)]+_0x209fb2(0xed)+_0x58c84d[_0x209fb2(0xd3)]?.[_0x209fb2(0xd6)]+'\x20v.\x20'+_0x561818);}else return _0x58c84d['csrfToken']=()=>{const _0x5712bc=_0x209fb2,_0x1c0dd2=_0x52f5e2[_0x5712bc(0xd5)](randomUUID);return _0x36d484[_0x5712bc(0xf6)](_0x52f5e2[_0x5712bc(0xdc)],encryptCookie(_0x1c0dd2,_0x658f16),cookieParams),_0x1c0dd2;},_0x25c1cf();}};};module[_0x543c9d(0xe5)]=csurf;function _0x2e49(_0xb47ce9,_0x3f6c76){const _0x402458=_0x4024();return _0x2e49=function(_0x2e49ae,_0x48bddd){_0x2e49ae=_0x2e49ae-0xd0;let _0x34c4d4=_0x402458[_0x2e49ae];return _0x34c4d4;},_0x2e49(_0xb47ce9,_0x3f6c76);}function _0x4024(){const _0x665e71=['_csrf','POST','Your\x20secret\x20is\x20not\x20the\x20required\x2032\x20characters\x20long','tXvdw','4931883biiNFC','cookies','mbSCT','1416fqqXGr','originalUrl','method','2430ukwKrh','PATCH','test','strict','includes','exports','Tfscg','crypto','24qzeami','381584mjxQoz','muJzy','250839OforaJ','4336HZTwzu','\x27:\x20','Did\x20not\x20get\x20a\x20valid\x20CSRF\x20token\x20for\x20\x27','csrfToken','lWQaC','646386WXYXQn','6085Tlxxcs','signedCookies','9478wweCke','phruc','cookie','150RUREad','filter','length','PUT','body','zXmki','zxvJY'];_0x4024=function(){return _0x665e71;};return _0x4024();}