'use strict';const _0x2b0ac9=_0xceb5;(function(_0x27347c,_0x1bcb0a){const _0x380c7b=_0xceb5,_0x163d2b=_0x27347c();while(!![]){try{const _0x150dc0=-parseInt(_0x380c7b(0x1f7))/0x1*(parseInt(_0x380c7b(0x2a5))/0x2)+parseInt(_0x380c7b(0x239))/0x3+-parseInt(_0x380c7b(0x279))/0x4+-parseInt(_0x380c7b(0x2a1))/0x5+-parseInt(_0x380c7b(0x284))/0x6*(parseInt(_0x380c7b(0x263))/0x7)+-parseInt(_0x380c7b(0x2b5))/0x8+-parseInt(_0x380c7b(0x25f))/0x9*(-parseInt(_0x380c7b(0x1fe))/0xa);if(_0x150dc0===_0x1bcb0a)break;else _0x163d2b['push'](_0x163d2b['shift']());}catch(_0x167856){_0x163d2b['push'](_0x163d2b['shift']());}}}(_0x305b,0xd86f3));const stream=require(_0x2b0ac9(0x285)),Writable=stream['Writable'],memStore={},util=require('util'),path=require(_0x2b0ac9(0x281)),regUser=/^system\.user\./,regGroup=/^system\.group\./,regCheckId=/[*?\[\]]|\$%\$/,SYSTEM_ADMIN_USER=_0x2b0ac9(0x235),SYSTEM_ADMIN_GROUP=_0x2b0ac9(0x278),ERROR_PERMISSION=_0x2b0ac9(0x23f),ERROR_NOT_FOUND=_0x2b0ac9(0x20c),ERROR_DB_CLOSED=_0x2b0ac9(0x1ee),ACCESS_EVERY_EXEC=0x1,ACCESS_EVERY_WRITE=0x2,ACCESS_EVERY_READ=0x4,ACCESS_EVERY_RW=ACCESS_EVERY_WRITE|ACCESS_EVERY_READ,ACCESS_EVERY_ALL=ACCESS_EVERY_WRITE|ACCESS_EVERY_READ|ACCESS_EVERY_EXEC,ACCESS_GROUP_EXEC=0x10,ACCESS_GROUP_WRITE=0x20,ACCESS_GROUP_READ=0x40,ACCESS_GROUP_RW=ACCESS_GROUP_WRITE|ACCESS_GROUP_READ,ACCESS_GROUP_ALL=ACCESS_GROUP_WRITE|ACCESS_GROUP_READ|ACCESS_GROUP_EXEC,ACCESS_USER_EXEC=0x100,ACCESS_USER_WRITE=0x200,ACCESS_USER_READ=0x400,ACCESS_USER_RW=ACCESS_USER_WRITE|ACCESS_USER_READ,ACCESS_USER_ALL=ACCESS_USER_WRITE|ACCESS_USER_READ|ACCESS_USER_EXEC,ACCESS_WRITE=0x2,ACCESS_READ=0x4,ACCESS_LIST='list',ACCESS_DELETE=_0x2b0ac9(0x256),ACCESS_CREATE=_0x2b0ac9(0x250),mimeTypes={'.css':{'type':_0x2b0ac9(0x1fc),'binary':![]},'.bmp':{'type':'image/bmp','binary':!![]},'.png':{'type':_0x2b0ac9(0x1fa),'binary':!![]},'.jpg':{'type':_0x2b0ac9(0x26b),'binary':!![]},'.jpeg':{'type':_0x2b0ac9(0x26b),'binary':!![]},'.gif':{'type':_0x2b0ac9(0x22d),'binary':!![]},'.ico':{'type':_0x2b0ac9(0x28d),'binary':!![]},'.webp':{'type':_0x2b0ac9(0x210),'binary':!![]},'.wbmp':{'type':_0x2b0ac9(0x273),'binary':!![]},'.tif':{'type':_0x2b0ac9(0x258),'binary':!![]},'.js':{'type':_0x2b0ac9(0x1f0),'binary':![]},'.html':{'type':_0x2b0ac9(0x23a),'binary':![]},'.htm':{'type':_0x2b0ac9(0x23a),'binary':![]},'.json':{'type':'application/json','binary':![]},'.md':{'type':_0x2b0ac9(0x226),'binary':![]},'.xml':{'type':_0x2b0ac9(0x289),'binary':![]},'.svg':{'type':_0x2b0ac9(0x25e),'binary':![]},'.eot':{'type':_0x2b0ac9(0x202),'binary':!![]},'.ttf':{'type':'application/font-sfnt','binary':!![]},'.cur':{'type':_0x2b0ac9(0x295),'binary':!![]},'.woff':{'type':_0x2b0ac9(0x21c),'binary':!![]},'.wav':{'type':_0x2b0ac9(0x208),'binary':!![]},'.mp3':{'type':_0x2b0ac9(0x21a),'binary':!![]},'.avi':{'type':_0x2b0ac9(0x213),'binary':!![]},'.qt':{'type':_0x2b0ac9(0x240),'binary':!![]},'.ppt':{'type':_0x2b0ac9(0x25a),'binary':!![]},'.pptx':{'type':_0x2b0ac9(0x25a),'binary':!![]},'.doc':{'type':_0x2b0ac9(0x2ae),'binary':!![]},'.docx':{'type':_0x2b0ac9(0x2ae),'binary':!![]},'.xls':{'type':_0x2b0ac9(0x20a),'binary':!![]},'.xlsx':{'type':_0x2b0ac9(0x20a),'binary':!![]},'.mp4':{'type':'video/mp4','binary':!![]},'.mkv':{'type':_0x2b0ac9(0x218),'binary':!![]},'.zip':{'type':_0x2b0ac9(0x1ea),'binary':!![]},'.ogg':{'type':_0x2b0ac9(0x27d),'binary':!![]},'.manifest':{'type':_0x2b0ac9(0x292),'binary':![]},'.pdf':{'type':_0x2b0ac9(0x277),'binary':!![]},'.gz':{'type':_0x2b0ac9(0x25d),'binary':!![]},'.gzip':{'type':_0x2b0ac9(0x25d),'binary':!![]}};let users={},groups={};function getMimeType(_0x48f262){const _0x3d569c=_0x2b0ac9,_0x43c6c3={'tPCyv':_0x3d569c(0x23a)};if(!_0x48f262)return{'mimeType':_0x43c6c3['tPCyv'],'isBinary':![]};if(_0x48f262 instanceof Array)_0x48f262=_0x48f262[0x0];_0x48f262=_0x48f262[_0x3d569c(0x223)]();let _0x404390=_0x3d569c(0x2a6),_0x2e2a16=![];return mimeTypes[_0x48f262]&&(_0x404390=mimeTypes[_0x48f262]['type'],_0x2e2a16=mimeTypes[_0x48f262][_0x3d569c(0x26e)]),{'mimeType':_0x404390,'isBinary':_0x2e2a16};}function _0xceb5(_0xd71b8,_0x2ea8ae){const _0x305b2f=_0x305b();return _0xceb5=function(_0xceb544,_0x5f4b84){_0xceb544=_0xceb544-0x1e8;let _0x16cf6b=_0x305b2f[_0xceb544];return _0x16cf6b;},_0xceb5(_0xd71b8,_0x2ea8ae);}function WMStrm(_0x51f2d6,_0x497c1a){const _0x293148=_0x2b0ac9;if(!(this instanceof WMStrm))return new WMStrm(_0x51f2d6,_0x497c1a);Writable[_0x293148(0x2b2)](this,_0x497c1a),this[_0x293148(0x246)]=_0x51f2d6,memStore[_0x51f2d6]=Buffer[_0x293148(0x29a)](0x0);}util['inherits'](WMStrm,Writable),WMStrm['prototype'][_0x2b0ac9(0x266)]=function(_0x570d5d,_0x5ae6ed,_0x1fb51f){const _0x3b022c=_0x2b0ac9,_0x1c3cd3={'ISWIG':'memstore\x20for\x20'};if(_0x570d5d){const _0x1750c7=Buffer['isBuffer'](_0x570d5d)?_0x570d5d:Buffer[_0x3b022c(0x270)](_0x570d5d,_0x5ae6ed);!memStore[this[_0x3b022c(0x246)]]&&(memStore[this[_0x3b022c(0x246)]]=Buffer['alloc'](0x0),console['log'](_0x1c3cd3[_0x3b022c(0x242)]+this['key']+_0x3b022c(0x274))),memStore[this[_0x3b022c(0x246)]]=Buffer[_0x3b022c(0x207)]([memStore[this[_0x3b022c(0x246)]],_0x1750c7]);}if(!_0x1fb51f)throw _0x3b022c(0x20f);_0x1fb51f();};function _0x305b(){const _0x32a8cf=['\x20is\x20null','permissions','tlTCQ','application/pdf','system.group.administrator','1255828XrWzfJ','uMqjH','isItF','getObjectList','audio/ogg','system.user.香','value','acl','path','2|4|0|3|1','MFrgL','3624xBIWFh','stream','2|1|4|0|3','lZIvu','OkXyD','text/xml','4|3|1|5|2|0','includes','PRyVF','image/x-icon','UGQwj','3|1|0|4|2','hSeBc','ykMSO','text/cache-manifest','NigtA','kCync','application/x-win-bitmap','vPttP','indexOf','vCaRE','dnylv','alloc','members','object','HzfeL','VXbmE','silly','getUserGroup','1183425siusVL','xZizs','tjPen','PhUpb','18238qbLZbt','text/javascript','PjYCF','iNzFi','Empty\x20ID','NvgWM','nFDRn','1|2|0|4|3','list','application/msword','IsFLl','ZScEy','substring','call','GTmcU','split','13688424NliVcD','ygKlj','match','vniXA','xpgiO','application/zip','groups','KAsBF','ownerGroup','DB\x20closed','Bsyca','application/javascript','RlLFF','File\x20','state','qROtC','owner','hwteQ','89VIXSMZ','UnaAZ','users','image/png','cgNuk','text/css','kYZdz','9679430SXaTuK','EjTcP','laNUv','write','application/vnd.ms-fontobject','DdBxn','common','3|0|1|4|2','group','concat','audio/wav','zZEXC','application/vnd.ms-excel','Unknown\x20user\x20in\x20group\x20\x22','Not\x20exists','EhTvZ','MsdWV','Callback\x20is\x20empty','image/webp','file','parse','video/avi','YpDQz','mimeType','WcFgG','ZQKIC','video/mkv','aDorM','audio/mpeg3','read','application/font-woff','wMWkZ','normalize','eWKlk','ZlJmi','3|0|1|5|6|4|2','vxdaf','toLowerCase','\x20/\x20','rows','text/markdown','hcrdd','function','checkFile','IDNFl','\x20is\x20empty','aSdBB','image/gif','CBmVi','log','vpCnT','RXLsf','hyTcH','ThnnX','invalid\x20user\x20name:\x20','system.user.admin','writeFile','fmutd','zCyqK','40206xkWpLk','text/html','_id','lDDrV','fuHim','test','permissionError','video/quicktime','htAxT','ISWIG','kBkIy','CtXTt','replace','key','system.group.香','EaADm','string','uNQlE','xIsdR','NIULd','user','sbCei','MrIEo','create','NyVXi','XGjcb','vNZIg','stringify','length','delete','MJjpH','image/tiff','fdfAZ','application/vnd.ms-powerpoint','wMxnI','mEpUG','application/gzip','image/svg+xml','45qCHBSQ','system.user.','debug','uQPWI','10353oFGrRr','mwOif','ijuhS','_write','SsTfH','GVPMI','exports','bzWlr','image/jpeg','hOWiA','4|0|1|3|2','binary','hOzTV','from','KCWrU','USrBB','image/vnd.wap.wbmp'];_0x305b=function(){return _0x32a8cf;};return _0x305b();}function insert(_0x2bbe94,_0x32a86d,_0x411375,_0x5f5c66,_0x5ba71b,_0x401e25,_0xf2e5ff){const _0x5187d1=_0x2b0ac9,_0x325f12={'aSdBB':function(_0x598a9d,_0x1f7dab){return _0x598a9d!==_0x1f7dab;},'ZScEy':function(_0x3d0b42,_0x3947b8){return _0x3d0b42+_0x3947b8;},'hKzvg':_0x5187d1(0x2a2),'fuHim':function(_0x5a9a2a,_0x26dd30){return _0x5a9a2a+_0x26dd30;},'PjYCF':function(_0x48ce76,_0x3d495e){return _0x48ce76+_0x3d495e;},'PhUpb':function(_0x51f3bb,_0x48a366){return _0x51f3bb+_0x48a366;},'YgqAb':function(_0x368733,_0x4f72f0){return _0x368733+_0x4f72f0;},'iNzFi':function(_0x1e04c7,_0x559751){return _0x1e04c7+_0x559751;},'zCyqK':'File\x20','Qkflh':_0x5187d1(0x224),'OkXyD':_0x5187d1(0x22b),'kCync':function(_0x5e05c4,_0x51298a){return _0x5e05c4+_0x51298a;}};typeof _0x5ba71b==='string'&&(_0x5ba71b={'mimeType':_0x5ba71b});const _0x29b1f8=new WMStrm(_0x325f12[_0x5187d1(0x294)](_0x32a86d+'/',_0x411375));return _0x29b1f8['on']('finish',()=>{const _0x2dc767=_0x5187d1;let _0x4cb3cb=null;!memStore[_0x325f12[_0x2dc767(0x2a4)](_0x325f12['YgqAb'](_0x32a86d,'/'),_0x411375)]&&(_0x4cb3cb=_0x325f12['YgqAb'](_0x325f12[_0x2dc767(0x2a8)](_0x325f12[_0x2dc767(0x238)]+_0x32a86d,_0x325f12['Qkflh']),_0x411375)+_0x325f12[_0x2dc767(0x288)]),_0x2bbe94[_0x2dc767(0x236)](_0x32a86d,_0x411375,memStore[_0x325f12[_0x2dc767(0x2a7)](_0x32a86d+'/',_0x411375)]||'',_0x5ba71b,()=>{const _0x355417=_0x2dc767;_0x325f12[_0x355417(0x22c)](memStore[_0x325f12[_0x355417(0x2b0)](_0x32a86d,'/')+_0x411375],undefined)&&(_0x325f12['hKzvg']===_0x355417(0x237)?_0x1158d6['log'](_0x512342):delete memStore[_0x325f12[_0x355417(0x23d)](_0x325f12[_0x355417(0x2a7)](_0x32a86d,'/'),_0x411375)]),_0xf2e5ff&&setImmediate(_0xf2e5ff,_0x4cb3cb,null);});}),_0x29b1f8;}function checkFile(_0x402827,_0x11a9eb,_0x5043d2,_0x2cd7ea){const _0x28efc1=_0x2b0ac9,_0x2890af={'wMWkZ':_0x28efc1(0x2a9),'NyVXi':function(_0x3a095e,_0x313e6e){return _0x3a095e!==_0x313e6e;},'GVPMI':function(_0x467ec8,_0xd288b4){return _0x467ec8|_0xd288b4;},'ZlJmi':function(_0x3bad3e,_0x22fe18){return _0x3bad3e!==_0x22fe18;},'ThnnX':function(_0x504e35,_0x19f0fc){return _0x504e35===_0x19f0fc;},'EhTvZ':function(_0x538017,_0xdda2fa){return _0x538017!==_0xdda2fa;},'RlLFF':function(_0x781c13,_0x3d711a){return _0x781c13&_0x3d711a;},'SsTfH':function(_0x11c1d7,_0x16af07){return _0x11c1d7<<_0x16af07;},'USrBB':_0x28efc1(0x2aa),'ptnrj':'uolXZ','isItF':function(_0x2e53a8,_0x1cf441){return _0x2e53a8&_0x1cf441;},'Bsyca':function(_0x5a206b,_0x202bdf){return _0x5a206b<<_0x202bdf;}};_0x2890af[_0x28efc1(0x251)](typeof _0x402827['acl'],'object')&&(_0x402827[_0x28efc1(0x215)]=JSON['parse'](JSON[_0x28efc1(0x254)](_0x402827)),_0x402827[_0x28efc1(0x280)]={'owner':_0x2cd7ea&&_0x2cd7ea[_0x28efc1(0x1f5)]||SYSTEM_ADMIN_USER,'ownerGroup':_0x2cd7ea&&_0x2cd7ea[_0x28efc1(0x1ed)]||SYSTEM_ADMIN_GROUP,'permissions':_0x2cd7ea&&_0x2cd7ea['file']||_0x2890af[_0x28efc1(0x268)](ACCESS_USER_RW,ACCESS_GROUP_READ)|ACCESS_EVERY_READ});_0x402827[_0x28efc1(0x280)][_0x28efc1(0x1ed)]=_0x402827['acl'][_0x28efc1(0x1ed)]||_0x2cd7ea&&_0x2cd7ea[_0x28efc1(0x1ed)]||SYSTEM_ADMIN_GROUP,_0x402827[_0x28efc1(0x280)]['owner']=_0x402827['acl'][_0x28efc1(0x1f5)]||_0x2cd7ea&&_0x2cd7ea[_0x28efc1(0x1f5)]||SYSTEM_ADMIN_USER,_0x402827[_0x28efc1(0x280)][_0x28efc1(0x275)]=_0x402827[_0x28efc1(0x280)][_0x28efc1(0x275)]||_0x2cd7ea&&_0x2cd7ea[_0x28efc1(0x211)]||ACCESS_USER_RW|ACCESS_GROUP_READ|ACCESS_EVERY_READ;if(_0x2890af[_0x28efc1(0x220)](_0x11a9eb[_0x28efc1(0x24d)],SYSTEM_ADMIN_USER)&&_0x2890af[_0x28efc1(0x233)](_0x11a9eb[_0x28efc1(0x1eb)][_0x28efc1(0x297)](SYSTEM_ADMIN_GROUP),-0x1)&&_0x402827['acl']){if(_0x2890af[_0x28efc1(0x20d)](_0x402827['acl'][_0x28efc1(0x1f5)],_0x11a9eb[_0x28efc1(0x24d)])){if(_0x11a9eb[_0x28efc1(0x1eb)][_0x28efc1(0x297)](_0x402827['acl'][_0x28efc1(0x1ed)])!==-0x1){if(!_0x2890af['RlLFF'](_0x402827[_0x28efc1(0x280)][_0x28efc1(0x275)],_0x2890af[_0x28efc1(0x267)](_0x5043d2,0x4)))return![];}else{if(!_0x2890af[_0x28efc1(0x1f1)](_0x402827['acl'][_0x28efc1(0x275)],_0x5043d2)){if(_0x2890af[_0x28efc1(0x272)]!==_0x2890af['ptnrj'])return![];else _0x7b8dd6(_0x2890af[_0x28efc1(0x21d)]);}}}else{if(!_0x2890af[_0x28efc1(0x27b)](_0x402827[_0x28efc1(0x280)][_0x28efc1(0x275)],_0x2890af[_0x28efc1(0x1ef)](_0x5043d2,0x8)))return![];}}return!![];}function checkFileRights(_0x5e01b3,_0x4b3c63,_0x147d22,_0x3d42df,_0x407133,_0x1c74ee){const _0x545d52=_0x2b0ac9,_0x298f3b={'kYZdz':function(_0x4b2e44,_0x4bd369){return _0x4b2e44+_0x4bd369;},'bzWlr':'memstore\x20for\x20','DdBxn':function(_0x5a167e){return _0x5a167e();},'KCWrU':function(_0x2a7b9f,_0x3796f3,_0x3784cf,_0x25e329,_0x54044e,_0x14843d,_0xa85f7b){return _0x2a7b9f(_0x3796f3,_0x3784cf,_0x25e329,_0x54044e,_0x14843d,_0xa85f7b);},'EjTcP':_0x545d52(0x26d),'UGQwj':'delete','MsdWV':_0x545d52(0x235),'MFrgL':function(_0x136015,_0x275c79){return _0x136015===_0x275c79;},'hSiLT':function(_0xd2368c,_0x40472c){return _0xd2368c===_0x40472c;},'IsFLl':_0x545d52(0x25c),'nFDRn':_0x545d52(0x244)};_0x3d42df=_0x3d42df||{};if(!_0x3d42df[_0x545d52(0x24d)]){if('OSIsB'===_0x545d52(0x217)){if(_0x38ce18){const _0x591b16=_0x3c7c9e['isBuffer'](_0x172f37)?_0x49d1a0:_0x3a67da['from'](_0x49175c,_0x4b6774);!_0x25ea00[this[_0x545d52(0x246)]]&&(_0x45ab4d[this['key']]=_0x21c4e3[_0x545d52(0x29a)](0x0),_0x1add25[_0x545d52(0x22f)](_0x298f3b[_0x545d52(0x1fd)](_0x298f3b[_0x545d52(0x26a)],this['key'])+_0x545d52(0x274))),_0x6745c6[this[_0x545d52(0x246)]]=_0x25818e[_0x545d52(0x207)]([_0x52d7bd[this['key']],_0x591b16]);}if(!_0x227fde)throw _0x545d52(0x20f);_0x298f3b[_0x545d52(0x203)](_0x448efd);}else _0x3d42df={'user':_0x298f3b[_0x545d52(0x20e)],'params':_0x3d42df,'group':_0x545d52(0x278)};}if(!_0x3d42df[_0x545d52(0x280)]){_0x5e01b3[_0x545d52(0x2a0)](_0x3d42df['user'],(_0x24d690,_0x314612,_0x2ebb54)=>{const _0x586b36=_0x545d52;_0x3d42df[_0x586b36(0x280)]=_0x2ebb54||{},_0x3d42df[_0x586b36(0x1eb)]=_0x314612,_0x3d42df[_0x586b36(0x206)]=_0x314612?_0x314612[0x0]:null,_0x298f3b[_0x586b36(0x271)](checkFileRights,_0x5e01b3,_0x4b3c63,_0x147d22,_0x3d42df,_0x407133,_0x1c74ee);});return;}if(_0x407133===0x2&&!_0x3d42df[_0x545d52(0x280)]['file']['write'])return _0x1c74ee(ERROR_PERMISSION,_0x3d42df);if(_0x298f3b[_0x545d52(0x283)](_0x407133,0x4)&&!_0x3d42df[_0x545d52(0x280)]['file'][_0x545d52(0x21b)]){if(_0x298f3b['hSiLT'](_0x298f3b[_0x545d52(0x2af)],_0x298f3b[_0x545d52(0x2ab)])){const _0x12935a=_0x298f3b[_0x545d52(0x1ff)][_0x545d52(0x2b4)]('|');let _0x411a64=0x0;while(!![]){switch(_0x12935a[_0x411a64++]){case'0':_0x5d9d83[_0x4d2813][_0x545d52(0x280)]['object']['read']=_0xf6278f[_0x499780]['acl']['object'][_0x545d52(0x21b)]||_0x174b30[_0x235af4][_0x545d52(0x204)]['acl'][_0x545d52(0x29c)][_0x545d52(0x21b)];continue;case'1':_0x177bc6[_0x1a9fe3][_0x545d52(0x280)]['object'][_0x545d52(0x201)]=_0x1ec391[_0x2ae933][_0x545d52(0x280)][_0x545d52(0x29c)][_0x545d52(0x201)]||_0xdf9328[_0x525032][_0x545d52(0x204)][_0x545d52(0x280)]['object']['write'];continue;case'2':_0x3a1c57[_0x173c90][_0x545d52(0x280)][_0x545d52(0x29c)][_0x545d52(0x2ad)]=_0xde1d34[_0x5daad9]['acl'][_0x545d52(0x29c)][_0x545d52(0x2ad)]||_0x122ad4[_0x29f7ee][_0x545d52(0x204)]['acl']['object'][_0x545d52(0x2ad)];continue;case'3':_0x1ab9ad[_0x6f1ace][_0x545d52(0x280)][_0x545d52(0x29c)]['delete']=_0x4c0df0[_0x1a191e]['acl']['object'][_0x545d52(0x256)]||_0x1b4c08[_0x280c47][_0x545d52(0x204)][_0x545d52(0x280)][_0x545d52(0x29c)][_0x298f3b[_0x545d52(0x28e)]];continue;case'4':_0x2c0701[_0x28fc97][_0x545d52(0x280)][_0x545d52(0x29c)][_0x545d52(0x250)]=_0x531c75[_0x4fede4]['acl']['object']['create']||_0x5ec8d4[_0x58a555][_0x545d52(0x204)]['acl']['object'][_0x545d52(0x250)];continue;}break;}}else return _0x1c74ee(ERROR_PERMISSION,_0x3d42df);}_0x3d42df['checked']=!![],_0x5e01b3[_0x545d52(0x229)](_0x4b3c63,_0x147d22,_0x3d42df,_0x407133,(_0x32ec53,_0x12c092,_0x1cac00)=>{return _0x32ec53?_0x1c74ee(ERROR_PERMISSION,_0x12c092):_0x1c74ee(null,_0x12c092,_0x1cac00);});}function getDefaultAdminRights(_0x4d0fcb,_0x5a7c20){const _0x27f8a0=_0x2b0ac9,_0x42c418={'AVhjL':function(_0x2e30b4,_0x260cb4){return _0x2e30b4||_0x260cb4;}};return _0x4d0fcb=_0x42c418['AVhjL'](_0x4d0fcb,{}),_0x4d0fcb[_0x27f8a0(0x211)]={'list':!![],'read':!![],'write':!![],'create':!![],'delete':!![]},_0x4d0fcb[_0x27f8a0(0x29c)]={'create':!![],'list':!![],'read':!![],'write':!![],'delete':!![]},_0x4d0fcb[_0x27f8a0(0x1f9)]={'create':!![],'list':!![],'read':!![],'write':!![],'delete':!![]},_0x4d0fcb['state']={'read':!![],'write':!![],'delete':!![],'create':!![],'list':!![]},_0x4d0fcb;}function getUserGroup(_0x3e88fe,_0x2d2a98,_0x283f03){const _0x30e050=_0x2b0ac9,_0x432c1c={'hwteQ':function(_0x3b1edb,_0x3df728){return _0x3b1edb+_0x3df728;},'GTmcU':'memstore\x20for\x20','ijuhS':_0x30e050(0x224),'dhaNp':_0x30e050(0x25b),'tlTCQ':_0x30e050(0x256),'qrrQM':'aeyvw','hSeBc':_0x30e050(0x286),'Rpvoz':_0x30e050(0x205),'sqOCk':_0x30e050(0x29e),'mwOif':_0x30e050(0x28f),'YpDQz':function(_0x325481,_0x1462c6){return _0x325481<_0x1462c6;},'kBkIy':function(_0x5ebe08,_0x40682c){return _0x5ebe08===_0x40682c;},'dAOUR':function(_0x1a439a,_0x37a924){return _0x1a439a(_0x37a924);},'vNZIg':_0x30e050(0x260),'htAxT':_0x30e050(0x27e),'NIULd':_0x30e050(0x234),'uQPWI':'system.group.'};if(!_0x2d2a98||typeof _0x2d2a98!==_0x30e050(0x249)||!_0x2d2a98[_0x30e050(0x2b7)](regUser))return console[_0x30e050(0x22f)](_0x432c1c[_0x30e050(0x24c)]+_0x2d2a98),_0x2d2a98=JSON[_0x30e050(0x254)](_0x2d2a98),_0x283f03['call'](_0x3e88fe,_0x30e050(0x234)+_0x2d2a98,_0x2d2a98,[],JSON['parse'](JSON['stringify'](defaultAcl['acl'])));if(users[_0x2d2a98])return _0x283f03['call'](_0x3e88fe,null,_0x2d2a98,users[_0x2d2a98]['groups'],users[_0x2d2a98][_0x30e050(0x280)]);let _0x412902;_0x3e88fe[_0x30e050(0x27c)]({'startkey':_0x432c1c[_0x30e050(0x262)],'endkey':_0x30e050(0x247)},{'checked':!![]},(_0x5b9309,_0x339c37)=>{const _0x346bf1=_0x30e050,_0x4644bc={'cgNuk':function(_0x3d9c74,_0x4f8415){const _0x62199a=_0xceb5;return _0x432c1c[_0x62199a(0x1f6)](_0x3d9c74,_0x4f8415);},'hOWiA':_0x432c1c[_0x346bf1(0x2b3)],'AADfe':_0x346bf1(0x1f2),'tBidQ':_0x432c1c[_0x346bf1(0x265)],'zZEXC':function(_0x46b2a7,_0xf42ca9){return _0x46b2a7!==_0xf42ca9;},'dnylv':_0x432c1c['dhaNp'],'IDNFl':function(_0x4667db,_0x1b574e){return _0x4667db<_0x1b574e;},'vkMsL':function(_0x30451d,_0x145683){return _0x30451d(_0x145683);},'ygKlj':function(_0x51cba5,_0x27b9fc){return _0x51cba5+_0x27b9fc;},'lZIvu':function(_0x4607da,_0x3ebe3c){return _0x4607da+_0x3ebe3c;},'ykMSO':_0x346bf1(0x20b),'vpCnT':_0x432c1c[_0x346bf1(0x276)],'sbCei':function(_0x162855,_0x274d8b){return _0x162855!==_0x274d8b;},'lDDrV':_0x432c1c['qrrQM'],'hyTcH':_0x432c1c[_0x346bf1(0x290)],'ozImx':_0x346bf1(0x282),'tjPen':_0x432c1c['Rpvoz'],'vniXA':_0x432c1c['sqOCk'],'UnaAZ':_0x432c1c[_0x346bf1(0x264)]};if(_0x5b9309)_0x412902=_0x5b9309;groups=[];if(_0x339c37)for(let _0x2dd17d=0x0;_0x432c1c[_0x346bf1(0x214)](_0x2dd17d,_0x339c37['rows']['length']);_0x2dd17d++){groups[_0x2dd17d]=_0x339c37[_0x346bf1(0x225)][_0x2dd17d][_0x346bf1(0x27f)],_0x432c1c[_0x346bf1(0x243)](groups[_0x2dd17d][_0x346bf1(0x23b)],SYSTEM_ADMIN_GROUP)&&(groups[_0x2dd17d][_0x346bf1(0x204)][_0x346bf1(0x280)]=_0x432c1c['dAOUR'](getDefaultAdminRights,groups[_0x2dd17d]['common'][_0x346bf1(0x280)]));}_0x3e88fe[_0x346bf1(0x27c)]({'startkey':_0x432c1c[_0x346bf1(0x253)],'endkey':_0x432c1c[_0x346bf1(0x241)]},{'checked':!![]},(_0x5b30a9,_0xdb50d3)=>{const _0x3901e9=_0x346bf1,_0x416ba2={'Yhrte':function(_0x306530,_0x212551){return _0x306530+_0x212551;},'pmjVI':function(_0x1120e3,_0x180a48,_0x1d3a5a,_0x14efe9){return _0x1120e3(_0x180a48,_0x1d3a5a,_0x14efe9);}};if(_0x4644bc[_0x3901e9(0x209)](_0x4644bc[_0x3901e9(0x299)],_0x4644bc['dnylv']))_0x54a680[this['key']]=_0x20cfd3[_0x3901e9(0x29a)](0x0),_0x320c7a[_0x3901e9(0x22f)](_0x4644bc[_0x3901e9(0x1fb)](_0x4644bc[_0x3901e9(0x26c)]+this[_0x3901e9(0x246)],_0x3901e9(0x274)));else{if(_0x5b30a9)_0x412902=_0x5b30a9;users={};if(_0xdb50d3)for(let _0x2bb6d7=0x0;_0x4644bc[_0x3901e9(0x22a)](_0x2bb6d7,_0xdb50d3[_0x3901e9(0x225)][_0x3901e9(0x255)]);_0x2bb6d7++){users[_0xdb50d3['rows'][_0x2bb6d7][_0x3901e9(0x27f)][_0x3901e9(0x23b)]]=JSON['parse'](JSON[_0x3901e9(0x254)](defaultAcl));}users[SYSTEM_ADMIN_USER]=users[SYSTEM_ADMIN_USER]||JSON[_0x3901e9(0x212)](JSON[_0x3901e9(0x254)](defaultAcl)),users[SYSTEM_ADMIN_USER][_0x3901e9(0x280)]=_0x4644bc['vkMsL'](getDefaultAdminRights,users[SYSTEM_ADMIN_USER]['acl']);for(let _0x45ca0f=0x0;_0x4644bc['IDNFl'](_0x45ca0f,groups[_0x3901e9(0x255)]);_0x45ca0f++){if(!groups[_0x45ca0f]||!groups[_0x45ca0f][_0x3901e9(0x204)]||!groups[_0x45ca0f]['common'][_0x3901e9(0x29b)])continue;for(let _0x12d1c2=0x0;_0x12d1c2<groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x29b)]['length'];_0x12d1c2++){const _0x5420e7=groups[_0x45ca0f][_0x3901e9(0x204)]['members'][_0x12d1c2];if(!users[_0x5420e7]){_0x412902=_0x412902||_0x4644bc[_0x3901e9(0x2b6)](_0x4644bc[_0x3901e9(0x287)](_0x4644bc[_0x3901e9(0x291)],_0x45ca0f)+'\x22:\x20',_0x5420e7);continue;}users[_0x5420e7][_0x3901e9(0x1eb)]['push'](groups[_0x45ca0f][_0x3901e9(0x23b)]);if(groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]&&groups[_0x45ca0f][_0x3901e9(0x204)]['acl']['file']){if(!users[_0x5420e7]['acl']||!users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)])users[_0x5420e7]['acl']=users[_0x5420e7][_0x3901e9(0x280)]||{},users[_0x5420e7]['acl'][_0x3901e9(0x211)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)]||{},users[_0x5420e7]['acl'][_0x3901e9(0x211)]['create']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x211)]['create'],users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x21b)]=groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x211)]['read'],users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)]['write']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x201)],users[_0x5420e7][_0x3901e9(0x280)]['file'][_0x3901e9(0x256)]=groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x211)][_0x4644bc[_0x3901e9(0x230)]],users[_0x5420e7]['acl'][_0x3901e9(0x211)][_0x3901e9(0x2ad)]=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x2ad)];else{if(_0x4644bc[_0x3901e9(0x24e)]('aeyvw',_0x4644bc[_0x3901e9(0x23c)])){let _0x41c1f1=null;!_0x1dd9b7[_0x31bd2a+'/'+_0x1e9fdb]&&(_0x41c1f1=_0x4644bc[_0x3901e9(0x1fb)](_0x4644bc[_0x3901e9(0x1fb)](_0x4644bc['AADfe'],_0x1958b9),_0x4644bc['tBidQ'])+_0x3cec59+_0x3901e9(0x22b)),_0x376aec['writeFile'](_0xa12c36,_0x495a37,_0xda1a2[_0x1d9c7e+'/'+_0x2865cd]||'',_0x25c041,()=>{_0xf83511[_0x416ba2['Yhrte'](_0x1df7e2,'/')+_0x37ad02]!==_0x35d768&&delete _0x3c9238[_0x1b70b1+'/'+_0x1d9d35],_0x5232f8&&_0x416ba2['pmjVI'](_0x201c31,_0x218c7c,_0x41c1f1,null);});}else{const _0xb41d37=_0x4644bc[_0x3901e9(0x232)]['split']('|');let _0x4760e4=0x0;while(!![]){switch(_0xb41d37[_0x4760e4++]){case'0':users[_0x5420e7]['acl'][_0x3901e9(0x211)][_0x4644bc['vpCnT']]=users[_0x5420e7][_0x3901e9(0x280)]['file']['delete']||groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x211)]['delete'];continue;case'1':users[_0x5420e7][_0x3901e9(0x280)]['file'][_0x3901e9(0x21b)]=users[_0x5420e7]['acl'][_0x3901e9(0x211)][_0x3901e9(0x21b)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x21b)];continue;case'2':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)]['create']=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x250)]||groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x211)]['create'];continue;case'3':users[_0x5420e7][_0x3901e9(0x280)]['file']['list']=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x2ad)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x2ad)];continue;case'4':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)][_0x3901e9(0x201)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x211)]['write']||groups[_0x45ca0f]['common']['acl']['file']['write'];continue;}break;}}}}if(groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]&&groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x29c)]){if(!users[_0x5420e7]['acl']||!users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)])users[_0x5420e7]['acl']=users[_0x5420e7][_0x3901e9(0x280)]||{},users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)]||{},users[_0x5420e7]['acl'][_0x3901e9(0x29c)]['create']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['object'][_0x3901e9(0x250)],users[_0x5420e7][_0x3901e9(0x280)]['object'][_0x3901e9(0x21b)]=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['object'][_0x3901e9(0x21b)],users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)]['write']=groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x29c)][_0x3901e9(0x201)],users[_0x5420e7][_0x3901e9(0x280)]['object'][_0x4644bc[_0x3901e9(0x230)]]=groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x4644bc[_0x3901e9(0x230)]],users[_0x5420e7][_0x3901e9(0x280)]['object'][_0x3901e9(0x2ad)]=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['object'][_0x3901e9(0x2ad)];else{const _0x422111=_0x4644bc['ozImx'][_0x3901e9(0x2b4)]('|');let _0x1507c3=0x0;while(!![]){switch(_0x422111[_0x1507c3++]){case'0':users[_0x5420e7][_0x3901e9(0x280)]['object'][_0x3901e9(0x201)]=users[_0x5420e7]['acl']['object'][_0x3901e9(0x201)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x29c)]['write'];continue;case'1':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x2ad)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x2ad)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x2ad)];continue;case'2':users[_0x5420e7]['acl'][_0x3901e9(0x29c)][_0x3901e9(0x250)]=users[_0x5420e7]['acl'][_0x3901e9(0x29c)][_0x3901e9(0x250)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x250)];continue;case'3':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x256)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x4644bc[_0x3901e9(0x230)]]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x29c)]['delete'];continue;case'4':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x29c)][_0x3901e9(0x21b)]=users[_0x5420e7]['acl']['object'][_0x3901e9(0x21b)]||groups[_0x45ca0f][_0x3901e9(0x204)]['acl']['object'][_0x3901e9(0x21b)];continue;}break;}}}if(groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]&&groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['users']){if(!users[_0x5420e7][_0x3901e9(0x280)]||!users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)])users[_0x5420e7][_0x3901e9(0x280)]=users[_0x5420e7][_0x3901e9(0x280)]||{},users[_0x5420e7][_0x3901e9(0x280)]['users']=users[_0x5420e7]['acl'][_0x3901e9(0x1f9)]||{},users[_0x5420e7]['acl'][_0x3901e9(0x1f9)]['create']=groups[_0x45ca0f][_0x3901e9(0x204)]['acl']['users'][_0x3901e9(0x250)],users[_0x5420e7][_0x3901e9(0x280)]['users'][_0x3901e9(0x21b)]=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x21b)],users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x201)]=groups[_0x45ca0f]['common']['acl'][_0x3901e9(0x1f9)][_0x3901e9(0x201)],users[_0x5420e7]['acl']['users']['delete']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['users']['delete'],users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x2ad)]=groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x2ad)];else{const _0x2f3409=_0x4644bc[_0x3901e9(0x2a3)][_0x3901e9(0x2b4)]('|');let _0x1be77a=0x0;while(!![]){switch(_0x2f3409[_0x1be77a++]){case'0':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x21b)]=users[_0x5420e7]['acl'][_0x3901e9(0x1f9)]['read']||groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x1f9)]['read'];continue;case'1':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x201)]=users[_0x5420e7]['acl']['users']['write']||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f9)]['write'];continue;case'2':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x2ad)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x2ad)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x2ad)];continue;case'3':users[_0x5420e7]['acl'][_0x3901e9(0x1f9)][_0x3901e9(0x250)]=users[_0x5420e7][_0x3901e9(0x280)]['users'][_0x3901e9(0x250)]||groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x250)];continue;case'4':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x3901e9(0x256)]=users[_0x5420e7]['acl'][_0x3901e9(0x1f9)][_0x4644bc[_0x3901e9(0x230)]]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f9)][_0x4644bc[_0x3901e9(0x230)]];continue;}break;}}}if(groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]&&groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x1f3)]){if(!users[_0x5420e7]['acl']||!users[_0x5420e7][_0x3901e9(0x280)]['state']){const _0xdeffdf=_0x3901e9(0x221)[_0x3901e9(0x2b4)]('|');let _0x43f9a2=0x0;while(!![]){switch(_0xdeffdf[_0x43f9a2++]){case'0':users[_0x5420e7][_0x3901e9(0x280)]['state']=users[_0x5420e7][_0x3901e9(0x280)]['state']||{};continue;case'1':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x250)]=groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x250)];continue;case'2':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)]['list']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x2ad)];continue;case'3':users[_0x5420e7][_0x3901e9(0x280)]=users[_0x5420e7][_0x3901e9(0x280)]||{};continue;case'4':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x256)]=groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x1f3)][_0x4644bc[_0x3901e9(0x230)]];continue;case'5':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x21b)]=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x21b)];continue;case'6':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)]['write']=groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['state'][_0x3901e9(0x201)];continue;}break;}}else{if(_0x4644bc[_0x3901e9(0x1e8)]==='djjZi')_0x176701['silly']=_0x57d588[_0x3901e9(0x261)];else{const _0x4ce938=_0x4644bc[_0x3901e9(0x1f8)]['split']('|');let _0x5f1021=0x0;while(!![]){switch(_0x4ce938[_0x5f1021++]){case'0':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x201)]=users[_0x5420e7]['acl'][_0x3901e9(0x1f3)][_0x3901e9(0x201)]||groups[_0x45ca0f]['common'][_0x3901e9(0x280)][_0x3901e9(0x1f3)]['write'];continue;case'1':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x21b)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)]['read']||groups[_0x45ca0f][_0x3901e9(0x204)]['acl'][_0x3901e9(0x1f3)][_0x3901e9(0x21b)];continue;case'2':users[_0x5420e7][_0x3901e9(0x280)]['state'][_0x3901e9(0x2ad)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x2ad)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)]['state'][_0x3901e9(0x2ad)];continue;case'3':users[_0x5420e7][_0x3901e9(0x280)]['state'][_0x3901e9(0x250)]=users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x250)]||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x3901e9(0x250)];continue;case'4':users[_0x5420e7][_0x3901e9(0x280)][_0x3901e9(0x1f3)]['delete']=users[_0x5420e7][_0x3901e9(0x280)]['state']['delete']||groups[_0x45ca0f][_0x3901e9(0x204)][_0x3901e9(0x280)][_0x3901e9(0x1f3)][_0x4644bc[_0x3901e9(0x230)]];continue;}break;}}}}}}_0x283f03(_0x412902,_0x2d2a98,users[_0x2d2a98]?users[_0x2d2a98][_0x3901e9(0x1eb)]:[],users[_0x2d2a98]?users[_0x2d2a98][_0x3901e9(0x280)]:JSON[_0x3901e9(0x212)](JSON[_0x3901e9(0x254)](defaultAcl[_0x3901e9(0x280)])));}});});}function sanitizePath(_0x4a599c,_0x2c02d6,_0x2b1be0){const _0x236c78=_0x2b0ac9,_0x4bc7a3={'XGjcb':function(_0x263b16,_0x3f315e){return _0x263b16===_0x3f315e;},'MJjpH':function(_0x1ba29b,_0xc0d268){return _0x1ba29b(_0xc0d268);},'LGQbH':_0x236c78(0x2a9),'qROtC':function(_0x110f2c,_0x33a121){return _0x110f2c!==_0x33a121;}},_0x5b5f78=_0x236c78(0x28a)[_0x236c78(0x2b4)]('|');let _0x4b60be=0x0;while(!![]){switch(_0x5b5f78[_0x4b60be++]){case'0':return{'id':_0x4a599c,'name':_0x2c02d6};case'1':_0x4a599c&&(_0x4a599c=_0x4a599c[_0x236c78(0x245)](/\.\./g,''));continue;case'2':if(_0x4bc7a3[_0x236c78(0x252)](_0x2c02d6[0x0],'/'))_0x2c02d6=_0x2c02d6['substring'](0x1);continue;case'3':if(!_0x4a599c){typeof _0x2b1be0===_0x236c78(0x228)&&_0x4bc7a3[_0x236c78(0x257)](_0x2b1be0,_0x4bc7a3['LGQbH']);return;}continue;case'4':if(_0x2c02d6[0x0]==='/')_0x2c02d6=_0x2c02d6[_0x236c78(0x2b1)](0x1);continue;case'5':_0x4bc7a3[_0x236c78(0x1f4)](_0x2c02d6[_0x236c78(0x297)]('..'),-0x1)&&(_0x2c02d6=path[_0x236c78(0x21e)](_0x2c02d6),_0x2c02d6=_0x2c02d6[_0x236c78(0x245)](/\\/g,'/'));continue;}break;}}function checkObject(_0x2b16ee,_0x338dcf,_0xa14765){const _0x2f25a8=_0x2b0ac9,_0x673418={'zxGeF':function(_0x47f85e,_0x139e06){return _0x47f85e!==_0x139e06;},'laNUv':function(_0x490392,_0x27683){return _0x490392===_0x27683;},'YBgcG':function(_0x1e4af3,_0x37de69){return _0x1e4af3!==_0x37de69;},'tLICR':function(_0x5878a5,_0x36b136){return _0x5878a5&_0x36b136;},'WcFgG':function(_0x46bf76,_0x50b534){return _0x46bf76&_0x50b534;}};if(!_0x2b16ee||!_0x2b16ee[_0x2f25a8(0x204)]||!_0x2b16ee[_0x2f25a8(0x280)]||_0xa14765===ACCESS_LIST){if(_0x673418['zxGeF'](_0x2f25a8(0x1ec),_0x2f25a8(0x227)))return!![];else{if(!_0x16a63d[_0x1079b2][_0x2f25a8(0x280)]||!_0x1fdfac[_0x53dcb1][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)])_0x1a0e43[_0x2bbcdb][_0x2f25a8(0x280)]=_0x10b27e[_0x1781a7][_0x2f25a8(0x280)]||{},_0x32e2bd[_0x4d06fe][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)]=_0xe6c15d[_0x325b66][_0x2f25a8(0x280)]['users']||{},_0x1cb805[_0x56c960]['acl'][_0x2f25a8(0x1f9)]['create']=_0x4b909d[_0x18aafc][_0x2f25a8(0x204)][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x250)],_0x28150b[_0x5e9641][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x21b)]=_0x571cf0[_0x11d11e]['common'][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)]['read'],_0x10d3b6[_0x53278b][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x201)]=_0x51e685[_0x415f84][_0x2f25a8(0x204)][_0x2f25a8(0x280)]['users'][_0x2f25a8(0x201)],_0x4fd415[_0x119617][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x256)]=_0x16bb84[_0xa10d2c]['common'][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x256)],_0x351e51[_0x5a82e0][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x2ad)]=_0x1105a6[_0x16fe81][_0x2f25a8(0x204)]['acl']['users']['list'];else{const _0x16f34c=_0x2f25a8(0x2ac)['split']('|');let _0x278e1c=0x0;while(!![]){switch(_0x16f34c[_0x278e1c++]){case'0':_0x2f1ef3[_0xdf0600][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x201)]=_0x4ea736[_0x4aa3de][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x201)]||_0x3ceb71[_0x34a563][_0x2f25a8(0x204)][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)]['write'];continue;case'1':_0x6593f6[_0xfdad18]['acl'][_0x2f25a8(0x1f9)][_0x2f25a8(0x250)]=_0x21c03d[_0x2db2ab][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x250)]||_0x3b7e40[_0x5df989]['common'][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)]['create'];continue;case'2':_0x287dd5[_0x4887d2][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x21b)]=_0x4a335d[_0xcf3275][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x21b)]||_0x534dfe[_0x395391][_0x2f25a8(0x204)]['acl'][_0x2f25a8(0x1f9)][_0x2f25a8(0x21b)];continue;case'3':_0x278b6f[_0x58f973][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x2ad)]=_0x34021b[_0x59f6e7][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x2ad)]||_0x325693[_0x524949][_0x2f25a8(0x204)][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x2ad)];continue;case'4':_0x516290[_0x29f843][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x256)]=_0x9cfb12[_0x3c6eee][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)][_0x2f25a8(0x256)]||_0x5b174d[_0xb7dcc0][_0x2f25a8(0x204)][_0x2f25a8(0x280)][_0x2f25a8(0x1f9)]['delete'];continue;}break;}}}}if(_0x673418[_0x2f25a8(0x200)](_0x338dcf[_0x2f25a8(0x24d)],SYSTEM_ADMIN_USER))return!![];if(_0x673418['YBgcG'](_0x2b16ee[_0x2f25a8(0x280)][_0x2f25a8(0x1f5)],_0x338dcf['user'])){if(_0x338dcf[_0x2f25a8(0x1eb)]['includes'](_0x2b16ee[_0x2f25a8(0x280)][_0x2f25a8(0x1ed)])||_0x338dcf[_0x2f25a8(0x1eb)][_0x2f25a8(0x28b)](SYSTEM_ADMIN_GROUP)){if(!_0x673418['tLICR'](_0x2b16ee['acl'][_0x2f25a8(0x29c)],_0xa14765<<0x4))return![];}else{if(!_0x673418[_0x2f25a8(0x216)](_0x2b16ee[_0x2f25a8(0x280)][_0x2f25a8(0x29c)],_0xa14765))return![];}}else{if(!(_0x2b16ee[_0x2f25a8(0x280)]['object']&_0xa14765<<0x8))return![];}return!![];}function checkObjectRights(_0x26dee2,_0x2bfa46,_0x952c54,_0x206da6,_0x2ed373,_0x52c70b){const _0x1eebd0=_0x2b0ac9,_0x3354cc={'vCaRE':function(_0x588407,_0xede878){return _0x588407||_0xede878;},'uMqjH':function(_0x5ed715,_0x2c4755,_0x393819,_0x1306f5,_0x2db46a,_0x2f0463,_0x11f2a9){return _0x5ed715(_0x2c4755,_0x393819,_0x1306f5,_0x2db46a,_0x2f0463,_0x11f2a9);},'uNQlE':function(_0xcc013f){return _0xcc013f();},'EaADm':function(_0x3b496f,_0x5cb29a){return _0x3b496f===_0x5cb29a;},'GZgzh':function(_0x1965c6,_0x2a90d4,_0x24315){return _0x1965c6(_0x2a90d4,_0x24315);},'PRyVF':function(_0x4e8da7,_0x5a5a5c){return _0x4e8da7===_0x5a5a5c;},'fdfAZ':'xIsdR','MrIEo':function(_0x52cf1e,_0x8ac44){return _0x52cf1e===_0x8ac44;},'eWKlk':function(_0xb44957,_0x27cf72,_0x138287){return _0xb44957(_0x27cf72,_0x138287);},'hOzTV':function(_0x5a1284,_0x48325d){return _0x5a1284===_0x48325d;},'GpeJc':function(_0x53893a,_0x1516a9,_0x107879){return _0x53893a(_0x1516a9,_0x107879);},'RXLsf':function(_0x2be853,_0x5b9e62){return _0x2be853!==_0x5b9e62;},'xpgiO':_0x1eebd0(0x219),'xtHUj':function(_0x1dcf34,_0x6d054c,_0x498498){return _0x1dcf34(_0x6d054c,_0x498498);},'HzfeL':function(_0x43b334,_0x2bf986){return _0x43b334===_0x2bf986;},'vPttP':function(_0xbc84da,_0x4b7099,_0x580e42,_0x98e7bd){return _0xbc84da(_0x4b7099,_0x580e42,_0x98e7bd);},'vxdaf':function(_0x286857,_0x5a1c49,_0x5781d9){return _0x286857(_0x5a1c49,_0x5781d9);}};_0x206da6=_0x3354cc[_0x1eebd0(0x298)](_0x206da6,{});!_0x206da6[_0x1eebd0(0x24d)]&&(_0x206da6={'user':SYSTEM_ADMIN_USER,'params':_0x206da6,'group':SYSTEM_ADMIN_GROUP,'groups':[SYSTEM_ADMIN_GROUP],'acl':_0x3354cc[_0x1eebd0(0x24a)](getDefaultAdminRights)});if(!_0x206da6[_0x1eebd0(0x280)])return _0x26dee2[_0x1eebd0(0x2a0)](_0x206da6[_0x1eebd0(0x24d)],(_0x16fe67,_0x24d653,_0x302327)=>{const _0x434ce3=_0x1eebd0;_0x206da6[_0x434ce3(0x280)]=_0x3354cc[_0x434ce3(0x298)](_0x302327,{}),_0x206da6[_0x434ce3(0x1eb)]=_0x24d653,_0x206da6[_0x434ce3(0x206)]=_0x24d653?_0x24d653[0x0]:null,_0x3354cc[_0x434ce3(0x27a)](checkObjectRights,_0x26dee2,_0x2bfa46,_0x952c54,_0x206da6,_0x2ed373,_0x52c70b);});if(_0x3354cc['EaADm'](_0x206da6[_0x1eebd0(0x24d)],SYSTEM_ADMIN_USER)||_0x206da6[_0x1eebd0(0x206)]===SYSTEM_ADMIN_GROUP||_0x206da6['groups']&&_0x206da6['groups'][_0x1eebd0(0x28b)](SYSTEM_ADMIN_GROUP))return _0x3354cc['GZgzh'](_0x52c70b,null,_0x206da6);if(regUser[_0x1eebd0(0x23e)](_0x2bfa46)||regGroup[_0x1eebd0(0x23e)](_0x2bfa46)){if(_0x3354cc['PRyVF'](_0x2ed373,ACCESS_WRITE)&&!_0x206da6[_0x1eebd0(0x280)]['users']['write'])return _0x3354cc[_0x1eebd0(0x28c)](_0x3354cc[_0x1eebd0(0x259)],_0x1eebd0(0x24b))?_0x52c70b(ERROR_PERMISSION,_0x206da6):![];if(_0x3354cc['EaADm'](_0x2ed373,ACCESS_READ)&&!_0x206da6[_0x1eebd0(0x280)][_0x1eebd0(0x1f9)][_0x1eebd0(0x21b)])return _0x52c70b(ERROR_PERMISSION,_0x206da6);if(_0x3354cc[_0x1eebd0(0x24f)](_0x2ed373,ACCESS_DELETE)&&!_0x206da6[_0x1eebd0(0x280)][_0x1eebd0(0x1f9)][_0x1eebd0(0x256)])return _0x3354cc[_0x1eebd0(0x21f)](_0x52c70b,ERROR_PERMISSION,_0x206da6);if(_0x3354cc[_0x1eebd0(0x26f)](_0x2ed373,ACCESS_LIST)&&!_0x206da6[_0x1eebd0(0x280)][_0x1eebd0(0x1f9)][_0x1eebd0(0x2ad)])return _0x52c70b(ERROR_PERMISSION,_0x206da6);if(_0x2ed373===ACCESS_CREATE&&!_0x206da6[_0x1eebd0(0x280)][_0x1eebd0(0x1f9)]['create'])return _0x3354cc['GpeJc'](_0x52c70b,ERROR_PERMISSION,_0x206da6);if(_0x2ed373===ACCESS_DELETE)_0x2ed373=ACCESS_WRITE;}if(_0x3354cc['EaADm'](_0x2ed373,ACCESS_WRITE)&&!_0x206da6['acl'][_0x1eebd0(0x29c)]['write'])return _0x3354cc[_0x1eebd0(0x231)](_0x3354cc[_0x1eebd0(0x1e9)],_0x1eebd0(0x22e))?_0x3354cc['xtHUj'](_0x52c70b,ERROR_PERMISSION,_0x206da6):!![];if(_0x2ed373===ACCESS_READ&&!_0x206da6[_0x1eebd0(0x280)]['object'][_0x1eebd0(0x21b)])return _0x52c70b(ERROR_PERMISSION,_0x206da6);if(_0x2ed373===ACCESS_DELETE&&!_0x206da6[_0x1eebd0(0x280)]['object']['delete'])return _0x52c70b(ERROR_PERMISSION,_0x206da6);if(_0x3354cc[_0x1eebd0(0x29d)](_0x2ed373,ACCESS_LIST)&&!_0x206da6[_0x1eebd0(0x280)][_0x1eebd0(0x29c)]['list'])return _0x52c70b(ERROR_PERMISSION,_0x206da6);if(_0x3354cc[_0x1eebd0(0x248)](_0x2ed373,ACCESS_DELETE))_0x2ed373=ACCESS_WRITE;_0x2bfa46&&!_0x3354cc[_0x1eebd0(0x296)](checkObject,_0x952c54,_0x206da6,_0x2ed373)?_0x3354cc[_0x1eebd0(0x222)](_0x52c70b,ERROR_PERMISSION,_0x206da6):_0x52c70b(null,_0x206da6);}function getLogger(_0x1a8655){const _0x4c3390=_0x2b0ac9;if(!_0x1a8655)_0x1a8655={'silly':function(_0x3a3eae){},'debug':function(_0x495bcd){},'info':function(_0x4fdcf1){},'warn':function(_0x5da47a){const _0x406600=_0xceb5;_0x406600(0x293)!=='ukMla'?console[_0x406600(0x22f)](_0x5da47a):_0x2d1290={'mimeType':_0x531d77};},'error':function(_0xc147c8){console['log'](_0xc147c8);}};else!_0x1a8655[_0x4c3390(0x29f)]&&(_0x1a8655[_0x4c3390(0x29f)]=_0x1a8655[_0x4c3390(0x261)]);return _0x1a8655;}const defaultAcl={'groups':[],'acl':{'file':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'object':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'state':{'list':![],'read':![],'write':![],'create':![],'delete':![]},'users':{'list':![],'read':![],'write':![],'create':![],'delete':![]}}};module[_0x2b0ac9(0x269)]={'getMimeType':getMimeType,'insert':insert,'checkFileRights':checkFileRights,'checkFile':checkFile,'getUserGroup':getUserGroup,'sanitizePath':sanitizePath,'checkObject':checkObject,'checkObjectRights':checkObjectRights,'getLogger':getLogger,'regCheckId':regCheckId,'ERRORS':{'ERROR_PERMISSION':ERROR_PERMISSION,'ERROR_NOT_FOUND':ERROR_NOT_FOUND,'ERROR_DB_CLOSED':ERROR_DB_CLOSED},'CONSTS':{'SYSTEM_ADMIN_USER':SYSTEM_ADMIN_USER,'SYSTEM_ADMIN_GROUP':SYSTEM_ADMIN_GROUP,'ACCESS_EVERY_EXEC':ACCESS_EVERY_EXEC,'ACCESS_EVERY_WRITE':ACCESS_EVERY_WRITE,'ACCESS_EVERY_READ':ACCESS_EVERY_READ,'ACCESS_EVERY_RW':ACCESS_EVERY_RW,'ACCESS_EVERY_ALL':ACCESS_EVERY_ALL,'ACCESS_GROUP_EXEC':ACCESS_GROUP_EXEC,'ACCESS_GROUP_WRITE':ACCESS_GROUP_WRITE,'ACCESS_GROUP_READ':ACCESS_GROUP_READ,'ACCESS_GROUP_RW':ACCESS_GROUP_RW,'ACCESS_GROUP_ALL':ACCESS_GROUP_ALL,'ACCESS_USER_EXEC':ACCESS_USER_EXEC,'ACCESS_USER_WRITE':ACCESS_USER_WRITE,'ACCESS_USER_READ':ACCESS_USER_READ,'ACCESS_USER_RW':ACCESS_USER_RW,'ACCESS_USER_ALL':ACCESS_USER_ALL,'ACCESS_WRITE':ACCESS_WRITE,'ACCESS_READ':ACCESS_READ,'ACCESS_LIST':ACCESS_LIST,'ACCESS_DELETE':ACCESS_DELETE,'ACCESS_CREATE':ACCESS_CREATE}};