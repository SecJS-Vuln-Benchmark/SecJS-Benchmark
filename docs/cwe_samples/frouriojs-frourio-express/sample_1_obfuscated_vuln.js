'use strict';const _0x46d912=_0x5861;(function(_0x54ec34,_0xb949fd){const _0x23890c=_0x5861,_0x2defc7=_0x54ec34();while(!![]){try{const _0x1f42da=-parseInt(_0x23890c(0x140))/0x1*(-parseInt(_0x23890c(0x117))/0x2)+parseInt(_0x23890c(0x11f))/0x3+parseInt(_0x23890c(0x163))/0x4+parseInt(_0x23890c(0x159))/0x5*(-parseInt(_0x23890c(0x15d))/0x6)+parseInt(_0x23890c(0x11e))/0x7+-parseInt(_0x23890c(0x14f))/0x8*(parseInt(_0x23890c(0x164))/0x9)+parseInt(_0x23890c(0x144))/0xa*(-parseInt(_0x23890c(0x162))/0xb);if(_0x1f42da===_0xb949fd)break;else _0x2defc7['push'](_0x2defc7['shift']());}catch(_0x3fb1e2){_0x2defc7['push'](_0x2defc7['shift']());}}}(_0x570e,0x39c70));const assert=require('assert'),fp=require(_0x46d912(0x13a)),CSRF=require(_0x46d912(0x15c)),createError=require(_0x46d912(0x130)),MissingCSRFSecretError=createError(_0x46d912(0x11b),_0x46d912(0x155),0x193),InvalidCSRFTokenError=createError('FST_CSRF_INVALID_TOKEN',_0x46d912(0x16e),0x193),defaultOptions={'cookieKey':'_csrf','cookieOpts':{'path':'/','sameSite':!![],'httpOnly':!![]},'sessionKey':'_csrf','getToken':getTokenDefault,'getUserInfo':getUserInfoDefault,'sessionPlugin':_0x46d912(0x14d)};async function fastifyCsrfProtection(_0x487513,_0x29e82b){const _0x45d829=_0x46d912,_0x37eaa0={'FbKse':_0x45d829(0x123),'WaNXP':function(_0x139469,_0x21b9b5){return _0x139469===_0x21b9b5;},'XQABt':_0x45d829(0x12c),'ABCuD':function(_0x58557c,_0xb792b8){return _0x58557c!==_0xb792b8;},'IGhKi':_0x45d829(0x165),'hDdbm':function(_0x462ffd,_0x2e996c){return _0x462ffd(_0x2e996c);},'KmSGU':function(_0x116adc,_0x4899f8){return _0x116adc(_0x4899f8);},'CfyUW':_0x45d829(0x152),'voTiN':function(_0x4e6183){return _0x4e6183();},'llglV':'string','rpbZv':function(_0x2b30dc,_0x46ec18){return _0x2b30dc===_0x46ec18;},'hOHdC':_0x45d829(0x11d),'orHvV':function(_0x158f5c,_0x244775,_0x56c3be){return _0x158f5c(_0x244775,_0x56c3be);},'CnKiD':'getToken\x20should\x20be\x20a\x20function','EWYKk':'getUserInfo\x20should\x20be\x20a\x20function','zSiTs':function(_0x1b48b9,_0x16791a,_0x50819e){return _0x1b48b9(_0x16791a,_0x50819e);},'JAjCp':_0x45d829(0x147),'IATpl':'@fastify/cookie','Iiiku':'@fastify/session','kYdxZ':_0x45d829(0x12d),'KriDc':function(_0xd4fe1c,_0x2eeee3){return _0xd4fe1c===_0x2eeee3;},'logTH':_0x45d829(0x142),'KZqTQ':function(_0x25f9fc,_0x37cc4f){return _0x25f9fc===_0x37cc4f;},'kZNqa':_0x45d829(0x12a),'VoaWX':function(_0x379a3c,_0x13decf){return _0x379a3c!==_0x13decf;},'BPmRn':_0x45d829(0x16c)},{cookieKey:_0x391807,cookieOpts:_0x5b236f,sessionKey:_0x2cec6b,getToken:_0x384ea3,getUserInfo:_0x191533,sessionPlugin:_0x360f10}=Object['assign']({},defaultOptions,_0x29e82b),_0xb51a34=_0x29e82b&&_0x29e82b[_0x45d829(0x134)]?_0x29e82b[_0x45d829(0x134)]:{};assert(typeof _0x391807===_0x37eaa0[_0x45d829(0x153)],_0x45d829(0x122)),assert(_0x37eaa0[_0x45d829(0x13f)](typeof _0x2cec6b,'string'),_0x37eaa0['hOHdC']),_0x37eaa0[_0x45d829(0x139)](assert,typeof _0x384ea3===_0x45d829(0x150),_0x37eaa0[_0x45d829(0x15a)]),_0x37eaa0[_0x45d829(0x139)](assert,_0x37eaa0[_0x45d829(0x151)](typeof _0x191533,_0x45d829(0x150)),_0x37eaa0['EWYKk']),_0x37eaa0['zSiTs'](assert,_0x37eaa0['rpbZv'](typeof _0x5b236f,_0x37eaa0[_0x45d829(0x135)]),'cookieOpts\x20should\x20be\x20a\x20object'),assert([_0x37eaa0['IATpl'],_0x37eaa0[_0x45d829(0x13d)],_0x45d829(0x12a)][_0x45d829(0x124)](_0x360f10),_0x37eaa0['kYdxZ']);_0x29e82b[_0x45d829(0x148)]&&(_0xb51a34['userInfo']=!![]);const _0x3ff7f3=new CSRF(_0xb51a34),_0x20dc74=_0x5b236f&&_0x5b236f['signed'];if(_0x360f10===_0x45d829(0x12a))_0x487513[_0x45d829(0x168)](_0x37eaa0[_0x45d829(0x146)],_0x2c19cc);else _0x37eaa0[_0x45d829(0x128)](_0x360f10,_0x37eaa0['Iiiku'])?_0x487513['decorateReply'](_0x37eaa0[_0x45d829(0x146)],_0x23de10):_0x37eaa0[_0x45d829(0x126)]!==_0x45d829(0x142)?_0x1cf186[_0x45d829(0x168)](_0x37eaa0[_0x45d829(0x146)],_0x524600):_0x487513[_0x45d829(0x168)](_0x45d829(0x123),_0x53c892);_0x487513[_0x45d829(0x141)](_0x45d829(0x116),_0x23ed49);let _0x51e18f;if(_0x37eaa0[_0x45d829(0x138)](_0x360f10,_0x37eaa0[_0x45d829(0x121)]))_0x51e18f=function _0x1b9dcf(_0x4c71c7,_0x3d4b5f){const _0xa7cb0e=_0x45d829;return _0x4c71c7[_0xa7cb0e(0x166)][_0xa7cb0e(0x11c)](_0x2cec6b);};else{if(_0x37eaa0[_0x45d829(0x13f)](_0x360f10,_0x45d829(0x158)))_0x51e18f=function _0x48d1d2(_0x44b3ce,_0x12ac7c){const _0x4aded6=_0x45d829;return _0x44b3ce[_0x4aded6(0x166)][_0x2cec6b];};else{if(_0x37eaa0['VoaWX'](_0x45d829(0x16c),_0x37eaa0[_0x45d829(0x15b)])){let _0x47005c=this['request'][_0x45d829(0x166)][_0x1395a7];const _0x59c409=_0x68b8ca?_0x152f52['userInfo']:_0x57bde5;return!_0x47005c&&(_0x47005c=_0x3962a7[_0x45d829(0x12f)](),this[_0x45d829(0x16a)][_0x45d829(0x166)][_0x49bc74]=_0x47005c),_0x5ea2e0[_0x45d829(0x169)](_0x47005c,_0x59c409);}else _0x51e18f=function _0x309218(_0x234b27,_0x147d98){const _0x2e3668=_0x45d829;return _0x20dc74?_0x147d98[_0x2e3668(0x157)](_0x234b27[_0x2e3668(0x154)][_0x391807]||'')[_0x2e3668(0x11a)]:_0x234b27['cookies'][_0x391807];};}}function _0x53c892(_0x5ef064){const _0x1a2b02=_0x45d829;if(_0x37eaa0['WaNXP'](_0x37eaa0[_0x1a2b02(0x14b)],_0x1a2b02(0x119)))return _0x222a27?_0x4b2aaa[_0x1a2b02(0x157)](_0x1bda0d[_0x1a2b02(0x154)][_0x31fe44]||'')[_0x1a2b02(0x11a)]:_0x5e35a3[_0x1a2b02(0x154)][_0x50a025];else{let _0x5e3790=_0x20dc74?this[_0x1a2b02(0x157)](this[_0x1a2b02(0x16a)][_0x1a2b02(0x154)][_0x391807]||'')[_0x1a2b02(0x11a)]:this[_0x1a2b02(0x16a)][_0x1a2b02(0x154)][_0x391807];const _0x4edb02=_0x5ef064?_0x5ef064[_0x1a2b02(0x143)]:undefined;return!_0x5e3790&&(_0x5e3790=_0x3ff7f3[_0x1a2b02(0x12f)](),this[_0x1a2b02(0x16b)](_0x391807,_0x5e3790,Object['assign']({},_0x5b236f,_0x5ef064))),_0x3ff7f3['create'](_0x5e3790,_0x4edb02);}}function _0x2c19cc(_0x4c238f){const _0x38b5b6=_0x45d829;let _0x3850d9=this[_0x38b5b6(0x16a)]['session'][_0x38b5b6(0x11c)](_0x2cec6b);!_0x3850d9&&(_0x37eaa0[_0x38b5b6(0x120)](_0x37eaa0[_0x38b5b6(0x15e)],_0x38b5b6(0x160))?(_0x3850d9=_0x3ff7f3[_0x38b5b6(0x12f)](),this[_0x38b5b6(0x16a)][_0x38b5b6(0x166)][_0x38b5b6(0x129)](_0x2cec6b,_0x3850d9)):_0x576a14=function _0x5bd19c(_0x354c87,_0x436313){const _0xd3358=_0x38b5b6;return _0x485ccf?_0x436313[_0xd3358(0x157)](_0x354c87[_0xd3358(0x154)][_0x3d3e0c]||'')[_0xd3358(0x11a)]:_0x354c87[_0xd3358(0x154)][_0x58ca88];});const _0x2c35ed=_0x4c238f?_0x4c238f[_0x38b5b6(0x143)]:undefined;return _0x4c238f&&this[_0x38b5b6(0x16a)][_0x38b5b6(0x166)][_0x38b5b6(0x14c)](_0x4c238f),_0x3ff7f3[_0x38b5b6(0x169)](_0x3850d9,_0x2c35ed);}function _0x23de10(_0x1e6106){const _0x1f432a=_0x45d829;let _0x406f2a=this[_0x1f432a(0x16a)][_0x1f432a(0x166)][_0x2cec6b];const _0x5839aa=_0x1e6106?_0x1e6106[_0x1f432a(0x143)]:undefined;return!_0x406f2a&&(_0x406f2a=_0x3ff7f3['secretSync'](),this['request'][_0x1f432a(0x166)][_0x2cec6b]=_0x406f2a),_0x3ff7f3[_0x1f432a(0x169)](_0x406f2a,_0x5839aa);}function _0x23ed49(_0x31ea6b,_0x23017d,_0x28a79b){const _0x51c168=_0x45d829;if(_0x37eaa0['ABCuD'](_0x51c168(0x13c),_0x51c168(0x145))){const _0xd47127=_0x51e18f(_0x31ea6b,_0x23017d);if(!_0xd47127)return _0x31ea6b[_0x51c168(0x127)][_0x51c168(0x118)](_0x51c168(0x155)),_0x23017d[_0x51c168(0x167)](new MissingCSRFSecretError());if(!_0x3ff7f3[_0x51c168(0x149)](_0xd47127,_0x37eaa0[_0x51c168(0x13e)](_0x384ea3,_0x31ea6b),_0x37eaa0['KmSGU'](_0x191533,_0x31ea6b))){if(_0x37eaa0['CfyUW']!==_0x51c168(0x12e))return _0x31ea6b[_0x51c168(0x127)][_0x51c168(0x118)](_0x51c168(0x16e)),_0x23017d[_0x51c168(0x167)](new InvalidCSRFTokenError());else _0x454029['userInfo']=!![];}_0x37eaa0[_0x51c168(0x133)](_0x28a79b);}else return _0x225924[_0x51c168(0x127)]['warn']('Missing\x20csrf\x20secret'),_0x4dc440[_0x51c168(0x167)](new _0x8ee442());}}function _0x570e(){const _0x6ac08b=['FST_CSRF_MISSING_SECRET','get','sessionKey\x20should\x20be\x20a\x20string','3141411uHEcDA','408027unPDOZ','ABCuD','kZNqa','cookieKey\x20should\x20be\x20a\x20string','generateCsrf','includes','fastifyCsrfProtection','logTH','log','KriDc','set','@fastify/secure-session','4.x','htUTN','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27@fastify/cookie\x27,\x20\x27@fastify/session\x27,\x20\x27@fastify/secure-session\x27','ZDrEc','secretSync','@fastify/error','x-xsrf-token','@fastify/csrf-protection','voTiN','csrfOpts','JAjCp','headers','default','KZqTQ','orHvV','fastify-plugin','RAEQC','ZYMHp','Iiiku','hDdbm','rpbZv','3DvICMw','decorate','BEnbu','userInfo','34660byDoeq','SFuxE','FbKse','object','getUserInfo','verify','xsrf-token','XQABt','options','@fastify/cookie','_csrf','40OgjEWD','function','WaNXP','jEgtj','llglV','cookies','Missing\x20csrf\x20secret','exports','unsignCookie','@fastify/session','10NDdHeT','CnKiD','BPmRn','@fastify/csrf','1307028gPPmhs','IGhKi','x-csrf-token','vFCiv','csrf-token','726UbadLh','531572SZkaCx','160371KAmcWX','SLEQJ','session','send','decorateReply','create','request','setCookie','nGzev','body','Invalid\x20csrf\x20token','csrfProtection','181672RJOfVi','warn','aTwJX','value'];_0x570e=function(){return _0x6ac08b;};return _0x570e();}function getTokenDefault(_0x5058c1){const _0x4782f7=_0x46d912,_0x9845a2={'swzPm':_0x4782f7(0x161),'RAEQC':_0x4782f7(0x14a)};return _0x5058c1[_0x4782f7(0x16d)]&&_0x5058c1[_0x4782f7(0x16d)][_0x4782f7(0x14e)]||_0x5058c1[_0x4782f7(0x136)][_0x9845a2['swzPm']]||_0x5058c1[_0x4782f7(0x136)][_0x9845a2[_0x4782f7(0x13b)]]||_0x5058c1[_0x4782f7(0x136)][_0x4782f7(0x15f)]||_0x5058c1[_0x4782f7(0x136)][_0x4782f7(0x131)];}function getUserInfoDefault(_0x7b62e5){return undefined;}function _0x5861(_0x34f314,_0x1eb842){const _0x570ec9=_0x570e();return _0x5861=function(_0x586140,_0x3b52da){_0x586140=_0x586140-0x116;let _0x50643d=_0x570ec9[_0x586140];return _0x50643d;},_0x5861(_0x34f314,_0x1eb842);}module['exports']=fp(fastifyCsrfProtection,{'fastify':_0x46d912(0x12b),'name':_0x46d912(0x132)}),module[_0x46d912(0x156)][_0x46d912(0x137)]=fastifyCsrfProtection,module[_0x46d912(0x156)][_0x46d912(0x125)]=fastifyCsrfProtection;