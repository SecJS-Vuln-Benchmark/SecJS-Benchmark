'use strict';const _0x4c6505=_0x570c;(function(_0x238cfd,_0x37c553){const _0x50b4c7=_0x570c,_0xfec775=_0x238cfd();while(!![]){try{const _0x1483aa=parseInt(_0x50b4c7(0xe6))/0x1+-parseInt(_0x50b4c7(0xe5))/0x2+-parseInt(_0x50b4c7(0xe8))/0x3*(parseInt(_0x50b4c7(0xfb))/0x4)+-parseInt(_0x50b4c7(0xfd))/0x5+-parseInt(_0x50b4c7(0x104))/0x6*(parseInt(_0x50b4c7(0xea))/0x7)+parseInt(_0x50b4c7(0xdd))/0x8+parseInt(_0x50b4c7(0xf0))/0x9;if(_0x1483aa===_0x37c553)break;else _0xfec775['push'](_0xfec775['shift']());}catch(_0x569607){_0xfec775['push'](_0xfec775['shift']());}}}(_0x28a7,0xa51d2));const {test}=require(_0x4c6505(0xf7)),Fastify=require(_0x4c6505(0x10b)),fastifyCookie=require(_0x4c6505(0xe1)),fastifySession=require('@fastify/session'),fastifySecureSession=require(_0x4c6505(0xf4)),fastifyCsrf=require(_0x4c6505(0x10a)),sodium=require(_0x4c6505(0x10c)),key=Buffer['alloc'](sodium[_0x4c6505(0xeb)]);sodium[_0x4c6505(0x103)](key),test(_0x4c6505(0xe2),async _0x48124c=>{const _0x34b3cb=_0x4c6505,_0x5afd1c={'oEivW':'/login','FfayF':_0x34b3cb(0xef),'SvYvb':_0x34b3cb(0x108)},_0xa4dfad=Fastify();await _0xa4dfad[_0x34b3cb(0x102)](fastifyCookie),await _0xa4dfad[_0x34b3cb(0x102)](fastifyCsrf,{'getUserInfo'(_0x5e89f6){const _0x4b9383=_0x34b3cb;return _0x8cb1f8[_0x5e89f6[_0x4b9383(0xfc)][_0x4b9383(0xfe)]];}});const _0x8cb1f8={'foo':_0x34b3cb(0x106)};_0xa4dfad['post'](_0x5afd1c[_0x34b3cb(0xf9)],async(_0x432a42,_0x3bd332)=>{const _0x4c8b33=_0x34b3cb,_0xd64a88=await _0x3bd332[_0x4c8b33(0xe4)]({'userInfo':_0x8cb1f8[_0x432a42[_0x4c8b33(0xfc)]['username']]});return{'token':_0xd64a88};}),_0xa4dfad['post']('/',{'preHandler':_0xa4dfad['csrfProtection']},async(_0x2f0079,_0x80d0a9)=>{return _0x2f0079['body'];});const _0x4ad2ef=await _0xa4dfad['inject']({'method':_0x5afd1c['FfayF'],'path':_0x34b3cb(0xf3),'body':{'username':_0x5afd1c[_0x34b3cb(0xee)]}});_0x48124c[_0x34b3cb(0x105)](_0x4ad2ef[_0x34b3cb(0xe9)],0xc8);const _0x349c25=_0x4ad2ef[_0x34b3cb(0x107)][0x0],{token:_0x11a9b1}=_0x4ad2ef[_0x34b3cb(0x10d)](),_0x418d1c=await _0xa4dfad['inject']({'method':'POST','path':'/','cookies':{'_csrf':_0x349c25[_0x34b3cb(0xf1)]},'body':{'_csrf':_0x11a9b1,'username':'foo'}});_0x48124c[_0x34b3cb(0x105)](_0x418d1c[_0x34b3cb(0xe9)],0xc8);}),test(_0x4c6505(0xfa),async _0x1a20d8=>{const _0x5b316e=_0x4c6505,_0x2b3c41={'cxpcv':function(_0x409354){return _0x409354();},'czZsU':_0x5b316e(0xf8),'xxKTb':'/login','kXLjF':'POST'},_0x3fd0f8=_0x2b3c41['cxpcv'](Fastify);await _0x3fd0f8[_0x5b316e(0x102)](fastifyCookie),await _0x3fd0f8[_0x5b316e(0x102)](fastifySession,{'secret':'a'[_0x5b316e(0xe3)](0x20),'cookie':{'path':'/','secure':![]}}),await _0x3fd0f8['register'](fastifyCsrf,{'sessionPlugin':_0x2b3c41[_0x5b316e(0x100)],'getUserInfo'(_0x5a2eb0){const _0x3f245f=_0x5b316e;return _0x5a2eb0[_0x3f245f(0xdf)][_0x3f245f(0xfe)];}}),_0x3fd0f8['post'](_0x2b3c41[_0x5b316e(0x109)],async(_0x294fbf,_0x2f3caf)=>{const _0x153f7c=_0x5b316e;_0x294fbf[_0x153f7c(0xdf)][_0x153f7c(0xfe)]=_0x294fbf['body'][_0x153f7c(0xfe)];const _0x4736c5=await _0x2f3caf[_0x153f7c(0xe4)]({'userInfo':_0x294fbf[_0x153f7c(0xfc)]['username']});return{'token':_0x4736c5};}),_0x3fd0f8[_0x5b316e(0xec)]('/',{'preHandler':_0x3fd0f8[_0x5b316e(0xe0)]},async(_0x16b2a1,_0x7d125a)=>{const _0x25c37a=_0x5b316e;return _0x16b2a1[_0x25c37a(0xfc)];});const _0x2e1d38=await _0x3fd0f8[_0x5b316e(0xe7)]({'method':_0x2b3c41[_0x5b316e(0xf6)],'path':_0x2b3c41[_0x5b316e(0x109)],'body':{'username':_0x5b316e(0x108)}});_0x1a20d8[_0x5b316e(0x105)](_0x2e1d38[_0x5b316e(0xe9)],0xc8);const _0x3b88d6=_0x2e1d38['cookies'][0x0],{token:_0x297345}=_0x2e1d38[_0x5b316e(0x10d)](),_0x35e0c2=await _0x3fd0f8['inject']({'method':_0x2b3c41['kXLjF'],'path':'/','cookies':{'sessionId':_0x3b88d6[_0x5b316e(0xf1)]},'body':{'_csrf':_0x297345,'username':'foo'}});_0x1a20d8['equal'](_0x35e0c2[_0x5b316e(0xe9)],0xc8);}),test(_0x4c6505(0xf2),async _0x165e64=>{const _0x33f5a3=_0x4c6505,_0x1f7b1a={'VGGSz':_0x33f5a3(0xfe),'pNdkY':function(_0x3245cc){return _0x3245cc();},'SQmIw':_0x33f5a3(0xf4),'imSMe':_0x33f5a3(0xf3),'mBOtG':_0x33f5a3(0x108)},_0x2a3b60=_0x1f7b1a['pNdkY'](Fastify);await _0x2a3b60[_0x33f5a3(0x102)](fastifySecureSession,{'key':key,'cookie':{'path':'/','secure':![]}}),await _0x2a3b60['register'](fastifyCsrf,{'sessionPlugin':_0x1f7b1a[_0x33f5a3(0xed)],'getUserInfo'(_0x40093e){const _0x153826=_0x33f5a3;return _0x40093e[_0x153826(0xdf)][_0x153826(0xde)]('username');}}),_0x2a3b60['post'](_0x1f7b1a[_0x33f5a3(0xf5)],async(_0x468c09,_0xa8783d)=>{const _0x132ce6=_0x33f5a3;_0x468c09[_0x132ce6(0xdf)][_0x132ce6(0xff)](_0x1f7b1a[_0x132ce6(0x101)],_0x468c09['body'][_0x132ce6(0xfe)]);const _0x2b5c15=await _0xa8783d['generateCsrf']({'userInfo':_0x468c09[_0x132ce6(0xfc)][_0x132ce6(0xfe)]});return{'token':_0x2b5c15};}),_0x2a3b60[_0x33f5a3(0xec)]('/',{'preHandler':_0x2a3b60[_0x33f5a3(0xe0)]},async(_0x46b4eb,_0x9446b5)=>{return _0x46b4eb['body'];});const _0x5e7106=await _0x2a3b60[_0x33f5a3(0xe7)]({'method':_0x33f5a3(0xef),'path':_0x1f7b1a['imSMe'],'body':{'username':_0x1f7b1a['mBOtG']}});_0x165e64[_0x33f5a3(0x105)](_0x5e7106[_0x33f5a3(0xe9)],0xc8);const _0x1bd258=_0x5e7106[_0x33f5a3(0x107)][0x0],{token:_0x532906}=_0x5e7106['json'](),_0x3d1613=await _0x2a3b60['inject']({'method':'POST','path':'/','cookies':{'session':_0x1bd258['value']},'body':{'_csrf':_0x532906,'username':_0x33f5a3(0x108)}});_0x165e64[_0x33f5a3(0x105)](_0x3d1613[_0x33f5a3(0xe9)],0xc8);});function _0x570c(_0xb2bbdf,_0x49a703){const _0x28a796=_0x28a7();return _0x570c=function(_0x570cb0,_0x8f3d3c){_0x570cb0=_0x570cb0-0xdd;let _0x1cd63e=_0x28a796[_0x570cb0];return _0x1cd63e;},_0x570c(_0xb2bbdf,_0x49a703);}function _0x28a7(){const _0x189372=['cookies','foo','xxKTb','../','fastify','sodium-native','json','3892824rqpBlb','get','session','csrfProtection','@fastify/cookie','Cookies\x20with\x20User-Info','repeat','generateCsrf','1801268zpdfeZ','621740hhYTyB','inject','145389ZVUMYb','statusCode','4065719EiHbzq','crypto_secretbox_KEYBYTES','post','SQmIw','SvYvb','POST','21551157DgGWit','value','SecureSession\x20with\x20User-Info','/login','@fastify/secure-session','imSMe','kXLjF','tap','@fastify/session','oEivW','Session\x20with\x20User-Info','76tQHlOo','body','2121810ablRAf','username','set','czZsU','VGGSz','register','randombytes_buf','6nKTAIV','equal','a42'];_0x28a7=function(){return _0x189372;};return _0x28a7();}