var _0x2b8960=_0x1cef;(function(_0x5cc563,_0x52741b){var _0x1856ef=_0x1cef,_0x50ed32=_0x5cc563();while(!![]){try{var _0x257476=-parseInt(_0x1856ef(0x1d3))/0x1+parseInt(_0x1856ef(0x184))/0x2+parseInt(_0x1856ef(0x16f))/0x3*(-parseInt(_0x1856ef(0x1f8))/0x4)+-parseInt(_0x1856ef(0x216))/0x5*(-parseInt(_0x1856ef(0x1e0))/0x6)+parseInt(_0x1856ef(0x17a))/0x7+parseInt(_0x1856ef(0x1fb))/0x8*(-parseInt(_0x1856ef(0x173))/0x9)+parseInt(_0x1856ef(0x1cf))/0xa;if(_0x257476===_0x52741b)break;else _0x50ed32['push'](_0x50ed32['shift']());}catch(_0x5e42ca){_0x50ed32['push'](_0x50ed32['shift']());}}}(_0x2944,0x3754f));function _0x2944(){var _0x3f9db5=['Authorization','YbxlP','close','1451191eiSvyF','Ovfpl','Dec','message','foo\x20is\x20not\x20supported','Nov','keyId','MissingHeaderError','headers=\x22dAtE\x20cOntEnt-MD5\x20request-line\x22,','Signature\x20keyId=','150566wDbldg','hauGP','key\x20id\x20no\x20value','gOzLj','key\x20id\x20no\x20quotes','ijaOF','oKiTN','Signature','UdlsO','Jun','Fri','test','tcLMn','no\x20date\x20header','JpBEs','not\x20whitelisted\x20algorithm','EPqbT','valid\x20explicit\x20headers','rkpZC','headers=\x22date\x20content-md5\x22\x20aaabbbbcccc','nACrr','prKEe','zPkpk','mIFzz','Signature\x20keyId=\x22f,oo\x22,algorithm=\x22RSA-sha256\x22,','statusCode','\x20GMT','Signature\x20foo','missing\x20required\x20header','getUTCDay','fo,o','equal','explicit\x20headers\x20missing','ghPUn','hGsHo','date','GET\x20/\x20HTTP/1.1','invalid\x20algorithm','getUTCFullYear','yBuuc','Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22\x20aaabbbbcccc','Sat','/tmp/.','Signature\x20keyId=\x22foo\x22,algorithm=','algorithm\x20no\x20value','headers=\x22dAtE\x20cOntEnt-MD5\x22\x20digitalSignature','end','vOQZa','eVPat','zEERc','VNyah','RXgBj','CoLRS','16|5|7|14|18|9|3|6|15|4|13|11|8|12|17|1|0|10|2','bNGwx','zSfWD','x-unit-test','XolrJ','WMfCk','ioeMd','Sep','headers','getUTCMonth','ejJTz','WdDSP','TVLqN','zPXcN','no\x20key\x20id','vNVJl','zjfAZ','parseRequest','HLWiK','algorithm','data','getUTCSeconds','5731570AxgkSP','rMqyk','Mon','InvalidParamsError','217488IPYNpe','signature','Wed','content-md5','zlIBB','CROlw','Aug','get','eYkxx','nglzp','XddrN','no\x20authorization','qNSDq','6wzfZyg','Signature\x20keyId=\x22foo\x22,algorithm=\x22foo\x22\x20aaabbbbcccc','gzepe','ZOXce','Signature\x20keyId=\x22foo\x22','RHDLx','Bpscl','adujH','name','createServer','Signature\x20keyId=\x22fo,o\x22,algorithm=\x22RSA-sha256\x22,','zqbAl','Oct','lRgeS','valid\x20default\x20headers','vlNyK','params','May','Sun','rsa-sha256\x20is\x20not\x20a\x20supported\x20algorithm','Apr','aUeXP','MEHPL','PAQWZ','185864hxRLtZ','signingString','node-uuid','4088TJgDsn','parse','rsa-sha1','blah\x20blah','write','tearDown','Thu','uUyAP','content-md5\x20was\x20not\x20in\x20the\x20request','dcmbU','log','Jan','joWrI','SJavK','zmLeK','NMRzF','oGvoZ','iiLef','keyId\x20was\x20not\x20specified','Signature\x20keyId=foo,algorithm=hmac-sha1\x20aabbcc','OVuEx','Date','toUpperCase','fail','tmIvI','sJlVi','mblJP','950785xmUlhJ','algorithm\x20was\x20not\x20specified','zXYOr','no\x20algorithm','zDaVF','length','Basic\x20blahBlahBlah','AGEYJ','date\x20was\x20not\x20in\x20the\x20request','oLbpI','COQoh','VXHGF','Feb','listen','jQYFk','FOhSt','fHkdm','tap','setup','bNonm','Rkqwh','Mar','bGbKz','Tue','scheme','stringify','split','Jul','ZaKau','hmCCe','FDpqN','YKAMY','FOzQJ','stack','Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22,','TSSpS','tester','IJQSf','pJVNY','BtJRf','HAacP','getUTCHours','extensions=\x22blah\x20blah\x22\x20digitalSignature','Zzrcp','QMMIS','writeHead','HtPPt','date:\x20','kmxte','InvalidHeaderError','request-line','bad\x20scheme','signature\x20was\x20empty','HzbDL','15FWpThS','hzFoT','DHXCr','VgdnR','6507oNmwui','jAWsF','WyjjL','JQTWW'];_0x2944=function(){return _0x3f9db5;};return _0x2944();}function _0x1cef(_0x306d88,_0x3e48d4){var _0x2944fa=_0x2944();return _0x1cef=function(_0x1cefae,_0x3d38cb){_0x1cefae=_0x1cefae-0x160;var _0x1ceae4=_0x2944fa[_0x1cefae];return _0x1ceae4;},_0x1cef(_0x306d88,_0x3e48d4);}var http=require('http'),test=require(_0x2b8960(0x227))[_0x2b8960(0x18f)],uuid=require(_0x2b8960(0x1fa)),httpSignature=require('../lib/index'),options=null,server=null,socket=null;function _pad(_0x414984){var _0xa35bd=_0x2b8960,_0x225a64={'UdlsO':function(_0x178aab,_0x2e9d87){return _0x178aab<_0x2e9d87;}};return _0x225a64[_0xa35bd(0x18c)](parseInt(_0x414984,0xa),0xa)&&(_0x414984='0'+_0x414984),_0x414984;}function _rfc1123(_0x202539){var _0x6b0b31=_0x2b8960,_0x1fa9dc={'lQQey':_0x6b0b31(0x1f4),'zmLeK':_0x6b0b31(0x1f1),'jAWsF':_0x6b0b31(0x231),'sXQNl':_0x6b0b31(0x1d9),'amHEq':_0x6b0b31(0x1ec),'hGsHo':_0x6b0b31(0x22d),'HLWiK':_0x6b0b31(0x201),'MERPi':_0x6b0b31(0x1ad),'kmxte':function(_0x538af3,_0x32c87a){return _0x538af3+_0x32c87a;},'mblJP':function(_0xa95024,_0x28ba19){return _0xa95024+_0x28ba19;},'RXgBj':function(_0x4ae3f8,_0x14c1b6){return _0x4ae3f8+_0x14c1b6;},'DHXCr':function(_0x544493,_0x12d182){return _0x544493+_0x12d182;},'ghPUn':function(_0x1633b1,_0x4deffb){return _0x1633b1+_0x4deffb;},'dcmbU':function(_0x418aa2,_0x1718c0){return _0x418aa2+_0x1718c0;},'CROlw':function(_0x52d766,_0x5a2be1){return _0x52d766(_0x5a2be1);}};if(!_0x202539)_0x202539=new Date();var _0x20c48c=[_0x6b0b31(0x206),_0x6b0b31(0x222),_0x6b0b31(0x22b),_0x1fa9dc['lQQey'],_0x1fa9dc[_0x6b0b31(0x209)],_0x6b0b31(0x18d),_0x1fa9dc[_0x6b0b31(0x174)],_0x1fa9dc['sXQNl'],_0x6b0b31(0x1c0),_0x1fa9dc['amHEq'],_0x6b0b31(0x17f),_0x6b0b31(0x17c)],_0x3f5113=[_0x6b0b31(0x1f2),_0x6b0b31(0x1d1),_0x1fa9dc[_0x6b0b31(0x1a6)],_0x6b0b31(0x1d5),_0x1fa9dc[_0x6b0b31(0x1cb)],_0x6b0b31(0x18e),_0x1fa9dc['MERPi']];return _0x1fa9dc[_0x6b0b31(0x169)](_0x1fa9dc[_0x6b0b31(0x215)](_0x1fa9dc[_0x6b0b31(0x1b7)](_0x1fa9dc[_0x6b0b31(0x169)](_0x1fa9dc[_0x6b0b31(0x215)](_0x1fa9dc[_0x6b0b31(0x171)](_0x1fa9dc[_0x6b0b31(0x215)](_0x1fa9dc[_0x6b0b31(0x1a5)](_0x1fa9dc[_0x6b0b31(0x204)](_0x1fa9dc[_0x6b0b31(0x1b7)](_0x1fa9dc['mblJP'](_0x3f5113[_0x202539[_0x6b0b31(0x1a1)]()],',\x20'),_pad(_0x202539['getUTCDate']())),'\x20')+_0x20c48c[_0x202539[_0x6b0b31(0x1c2)]()],'\x20'),_0x202539[_0x6b0b31(0x1aa)]()),'\x20'),_pad(_0x202539[_0x6b0b31(0x162)]())),':'),_pad(_0x202539['getUTCMinutes']()))+':',_0x1fa9dc[_0x6b0b31(0x1d8)](_pad,_0x202539[_0x6b0b31(0x1ce)]())),_0x6b0b31(0x19e));}test(_0x2b8960(0x228),function(_0x5511d5){var _0x357e7f=_0x2b8960,_0x485f03={'TVLqN':_0x357e7f(0x213),'zjfAZ':function(_0x1d4b94,_0x5530da){return _0x1d4b94+_0x5530da;},'LDuNR':_0x357e7f(0x1ae),'oNTeN':function(_0xc037f5){return _0xc037f5();}};socket=_0x485f03[_0x357e7f(0x1c9)](_0x485f03['LDuNR'],_0x485f03['oNTeN'](uuid)),options={'socketPath':socket,'path':'/','headers':{}},server=http[_0x357e7f(0x1e9)](function(_0x47544e,_0x951876){var _0x2cdaa9=_0x357e7f;server[_0x2cdaa9(0x23a)](_0x47544e,_0x951876);}),server[_0x357e7f(0x223)](socket,function(){var _0x40a4f0=_0x357e7f;_0x40a4f0(0x161)!==_0x485f03[_0x40a4f0(0x1c5)]?_0x5511d5['end']():(_0x4afb6f['equal'](_0x4c06cb['statusCode'],0xc8),_0x2fb296['end']());});}),test(_0x2b8960(0x1de),function(_0x3b4371){var _0x1f7d11=_0x2b8960,_0x48a0a9={'CoLRS':_0x1f7d11(0x1ed)};server[_0x1f7d11(0x23a)]=function(_0x4f4b65,_0x5d721d){var _0x417010=_0x1f7d11,_0x14f881={'KTpeC':'InvalidHeaderError','Bpscl':_0x417010(0x20d)};if(_0x417010(0x1ed)===_0x48a0a9[_0x417010(0x1b8)]){try{httpSignature[_0x417010(0x1ca)](_0x4f4b65);}catch(_0xac8a6b){_0x3b4371[_0x417010(0x1a3)](_0xac8a6b['name'],_0x417010(0x181));}_0x5d721d['writeHead'](0xc8),_0x5d721d['end']();}else _0x2a077d['equal'](_0x45fb4c['name'],_0x14f881['KTpeC']),_0x344482[_0x417010(0x1a3)](_0xc3619c['message'],_0x14f881[_0x417010(0x1e6)]);},http['get'](options,function(_0x2b99d9){var _0x1e4a7b=_0x1f7d11;_0x3b4371['equal'](_0x2b99d9['statusCode'],0xc8),_0x3b4371[_0x1e4a7b(0x1b2)]();});}),test(_0x2b8960(0x16c),function(_0x4ca5cb){var _0x49161c=_0x2b8960,_0x55d77f={'pJVNY':_0x49161c(0x20c),'sJlVi':_0x49161c(0x199)};server[_0x49161c(0x23a)]=function(_0x15cfb4,_0x41ea74){var _0x13cbaf=_0x49161c;try{httpSignature[_0x13cbaf(0x1ca)](_0x15cfb4);}catch(_0x12726f){_0x55d77f[_0x13cbaf(0x23c)]===_0x55d77f[_0x13cbaf(0x214)]?(_0x16dcf3[_0x13cbaf(0x1a3)]('InvalidParamsError',_0x33c4ea[_0x13cbaf(0x1e8)]),_0x1bf7a4[_0x13cbaf(0x1a3)](_0x13cbaf(0x1f3),_0x32ac86[_0x13cbaf(0x17d)])):(_0x4ca5cb[_0x13cbaf(0x1a3)](_0x12726f[_0x13cbaf(0x1e8)],'InvalidHeaderError'),_0x4ca5cb[_0x13cbaf(0x1a3)](_0x12726f[_0x13cbaf(0x17d)],'scheme\x20was\x20not\x20\x22Signature\x22'));}_0x41ea74[_0x13cbaf(0x166)](0xc8),_0x41ea74[_0x13cbaf(0x1b2)]();},options[_0x49161c(0x1c1)][_0x49161c(0x177)]=_0x49161c(0x21c),http['get'](options,function(_0x50b667){var _0x56f181=_0x49161c;_0x4ca5cb[_0x56f181(0x1a3)](_0x50b667[_0x56f181(0x19d)],0xc8),_0x4ca5cb[_0x56f181(0x1b2)]();});}),test(_0x2b8960(0x1c7),function(_0x1ab2f0){var _0x29f7c0=_0x2b8960,_0x48e7bc={'zlIBB':_0x29f7c0(0x20d),'vNVJl':function(_0x2ac40d,_0x3edfee){return _0x2ac40d===_0x3edfee;},'tcLMn':_0x29f7c0(0x208)};server[_0x29f7c0(0x23a)]=function(_0xc0ebc8,_0x1892b3){var _0x23912e=_0x29f7c0;try{httpSignature[_0x23912e(0x1ca)](_0xc0ebc8);}catch(_0x38cb3b){_0x1ab2f0[_0x23912e(0x1a3)](_0x38cb3b[_0x23912e(0x1e8)],'InvalidHeaderError'),_0x1ab2f0[_0x23912e(0x1a3)](_0x38cb3b[_0x23912e(0x17d)],_0x48e7bc[_0x23912e(0x1d7)]);}_0x1892b3['writeHead'](0xc8),_0x1892b3[_0x23912e(0x1b2)]();},options[_0x29f7c0(0x1c1)]['Authorization']=_0x29f7c0(0x19f),http['get'](options,function(_0x208d5e){var _0x35ae95=_0x29f7c0;_0x48e7bc[_0x35ae95(0x1c8)](_0x35ae95(0x185),_0x48e7bc[_0x35ae95(0x190)])?(_0x151e27['equal'](_0x29b4dd[_0x35ae95(0x1e8)],_0x35ae95(0x1d2)),_0x47c46b[_0x35ae95(0x1a3)](_0x2015c5[_0x35ae95(0x17d)],_0x35ae95(0x17e))):(_0x1ab2f0['equal'](_0x208d5e[_0x35ae95(0x19d)],0xc8),_0x1ab2f0[_0x35ae95(0x1b2)]());});}),test(_0x2b8960(0x186),function(_0x5d2895){var _0x17f160=_0x2b8960,_0xe1854d={'XddrN':'pEiyt','vlNyK':_0x17f160(0x16a),'WdDSP':_0x17f160(0x20d),'fHkdm':_0x17f160(0x183)};server[_0x17f160(0x23a)]=function(_0x5a5a7b,_0x1e3645){var _0x4da4e3=_0x17f160;try{httpSignature[_0x4da4e3(0x1ca)](_0x5a5a7b);}catch(_0x458db2){_0xe1854d[_0x4da4e3(0x1dd)]===_0xe1854d[_0x4da4e3(0x1dd)]?(_0x5d2895[_0x4da4e3(0x1a3)](_0x458db2[_0x4da4e3(0x1e8)],_0xe1854d[_0x4da4e3(0x1ef)]),_0x5d2895[_0x4da4e3(0x1a3)](_0x458db2[_0x4da4e3(0x17d)],_0xe1854d[_0x4da4e3(0x1c4)])):_0x4365ee+=_0x1a6225;}_0x1e3645[_0x4da4e3(0x166)](0xc8),_0x1e3645[_0x4da4e3(0x1b2)]();},options[_0x17f160(0x1c1)][_0x17f160(0x177)]=_0xe1854d[_0x17f160(0x226)],http[_0x17f160(0x1da)](options,function(_0x250aeb){var _0xc6cdbe=_0x17f160;_0x5d2895[_0xc6cdbe(0x1a3)](_0x250aeb[_0xc6cdbe(0x19d)],0xc8),_0x5d2895['end']();});}),test(_0x2b8960(0x188),function(_0x36c54b){var _0x49c930=_0x2b8960,_0x5e6cc9={'aUeXP':_0x49c930(0x203),'FDpqN':function(_0x23fa7e,_0x230e5f){return _0x23fa7e===_0x230e5f;},'MEHPL':function(_0x4359a4,_0x3924d6){return _0x4359a4!==_0x3924d6;},'FOhSt':'RsiyI','bNGwx':'keyId\x20was\x20not\x20specified'};server[_0x49c930(0x23a)]=function(_0x15c99b,_0x19d95a){var _0x3b7cb8=_0x49c930;if(_0x5e6cc9[_0x3b7cb8(0x234)](_0x3b7cb8(0x22a),'Rkqwh')){try{httpSignature[_0x3b7cb8(0x1ca)](_0x15c99b);}catch(_0x1890a3){_0x5e6cc9[_0x3b7cb8(0x1f6)]('RsiyI',_0x5e6cc9[_0x3b7cb8(0x225)])?(_0x42c869[_0x3b7cb8(0x1a3)](_0x49d135['name'],_0x3b7cb8(0x181)),_0x3c7382[_0x3b7cb8(0x1a3)](_0x281049['message'],_0x5e6cc9[_0x3b7cb8(0x1f5)])):(_0x36c54b[_0x3b7cb8(0x1a3)](_0x1890a3['name'],'InvalidHeaderError'),_0x36c54b[_0x3b7cb8(0x1a3)](_0x1890a3['message'],_0x5e6cc9[_0x3b7cb8(0x1ba)]));}_0x19d95a[_0x3b7cb8(0x166)](0xc8),_0x19d95a[_0x3b7cb8(0x1b2)]();}else{try{_0x316a30['parseRequest'](_0x4fbc24);}catch(_0x1703ea){_0x42d3d3[_0x3b7cb8(0x212)](_0x1703ea[_0x3b7cb8(0x237)]);}_0x418104['writeHead'](0xc8),_0x1def51[_0x3b7cb8(0x1b2)]();}},options[_0x49c930(0x1c1)][_0x49c930(0x177)]=_0x49c930(0x20e),http[_0x49c930(0x1da)](options,function(_0x138950){var _0x2fb997=_0x49c930;_0x36c54b[_0x2fb997(0x1a3)](_0x138950[_0x2fb997(0x19d)],0xc8),_0x36c54b[_0x2fb997(0x1b2)]();});}),test(_0x2b8960(0x219),function(_0x56fe21){var _0xac3bdd=_0x2b8960;server[_0xac3bdd(0x23a)]=function(_0x29ee96,_0x19da60){var _0x57a9ee=_0xac3bdd;try{httpSignature[_0x57a9ee(0x1ca)](_0x29ee96);}catch(_0x2aefcf){_0x56fe21[_0x57a9ee(0x1a3)](_0x2aefcf[_0x57a9ee(0x1e8)],_0x57a9ee(0x16a)),_0x56fe21[_0x57a9ee(0x1a3)](_0x2aefcf[_0x57a9ee(0x17d)],_0x57a9ee(0x217));}_0x19da60[_0x57a9ee(0x166)](0xc8),_0x19da60[_0x57a9ee(0x1b2)]();},options[_0xac3bdd(0x1c1)][_0xac3bdd(0x177)]=_0xac3bdd(0x1e4),http[_0xac3bdd(0x1da)](options,function(_0x5879e4){var _0x28d1dd=_0xac3bdd;_0x56fe21[_0x28d1dd(0x1a3)](_0x5879e4['statusCode'],0xc8),_0x56fe21[_0x28d1dd(0x1b2)]();});}),test(_0x2b8960(0x1b0),function(_0x329e49){var _0x5c5cfa=_0x2b8960,_0x5a9422={'zSfWD':'ExpiredRequestError','OVuEx':_0x5c5cfa(0x22c),'zXYOr':_0x5c5cfa(0x165),'IJQSf':_0x5c5cfa(0x198)};server[_0x5c5cfa(0x23a)]=function(_0x198c1f,_0x498ee5){var _0x3ff40b=_0x5c5cfa;try{httpSignature[_0x3ff40b(0x1ca)](_0x198c1f);}catch(_0x7650f0){_0x5a9422[_0x3ff40b(0x20f)]!==_0x5a9422[_0x3ff40b(0x218)]?(_0x329e49[_0x3ff40b(0x1a3)](_0x7650f0[_0x3ff40b(0x1e8)],_0x3ff40b(0x16a)),_0x329e49[_0x3ff40b(0x1a3)](_0x7650f0[_0x3ff40b(0x17d)],_0x3ff40b(0x217))):(_0xb0e1fb[_0x3ff40b(0x1a3)](_0x36bfad[_0x3ff40b(0x1e8)],_0x5a9422[_0x3ff40b(0x1bb)]),_0x3a1897['ok'](/clock skew of \d\.\d+s was greater than 1s/['test'](_0xcdd9bc['message'])));}_0x498ee5[_0x3ff40b(0x166)](0xc8),_0x498ee5[_0x3ff40b(0x1b2)]();},options[_0x5c5cfa(0x1c1)][_0x5c5cfa(0x177)]=_0x5c5cfa(0x1af),http[_0x5c5cfa(0x1da)](options,function(_0x328478){var _0x55b4db=_0x5c5cfa;_0x55b4db(0x198)!==_0x5a9422[_0x55b4db(0x23b)]?_0x2475d2[_0x55b4db(0x1ca)](_0xe476b6):(_0x329e49[_0x55b4db(0x1a3)](_0x328478['statusCode'],0xc8),_0x329e49[_0x55b4db(0x1b2)]());});}),test('no\x20signature',function(_0x3465c7){var _0x14bb09=_0x2b8960,_0x4a3efe={'qsunP':function(_0x981aa,_0x4e82f1){return _0x981aa===_0x4e82f1;},'eYkxx':'joWrI','YbxlP':function(_0x1816ab,_0x37fd5b){return _0x1816ab!==_0x37fd5b;},'XolrJ':_0x14bb09(0x21d),'jQYFk':'InvalidHeaderError','VNyah':_0x14bb09(0x16d),'oKiTN':'Signature\x20keyId=\x22foo\x22,algorithm=\x22foo\x22'};server['tester']=function(_0x3ad54e,_0x355469){var _0x55f26a=_0x14bb09,_0x4cbb1f={'DNNZJ':_0x55f26a(0x16a),'BxQHC':_0x55f26a(0x20d)};try{_0x4a3efe['qsunP'](_0x55f26a(0x207),_0x4a3efe[_0x55f26a(0x1db)])?httpSignature[_0x55f26a(0x1ca)](_0x3ad54e):(_0x11602b[_0x55f26a(0x1a3)](_0x22ba44[_0x55f26a(0x1e8)],_0x4cbb1f['DNNZJ']),_0x4bbbf3[_0x55f26a(0x1a3)](_0x4cf429[_0x55f26a(0x17d)],_0x4cbb1f['BxQHC']));}catch(_0x175674){_0x4a3efe[_0x55f26a(0x178)](_0x4a3efe['XolrJ'],_0x4a3efe[_0x55f26a(0x1bd)])?(_0x359897[_0x55f26a(0x1a3)](_0x2498d7[_0x55f26a(0x1e8)],_0x55f26a(0x181)),_0x23b13c[_0x55f26a(0x1a3)](_0x2011f3['message'],'date\x20was\x20not\x20in\x20the\x20request')):(_0x3465c7[_0x55f26a(0x1a3)](_0x175674['name'],_0x4a3efe[_0x55f26a(0x224)]),_0x3465c7[_0x55f26a(0x1a3)](_0x175674[_0x55f26a(0x17d)],_0x4a3efe[_0x55f26a(0x1b6)]));}_0x355469['writeHead'](0xc8),_0x355469[_0x55f26a(0x1b2)]();},options[_0x14bb09(0x1c1)][_0x14bb09(0x177)]=_0x4a3efe[_0x14bb09(0x18a)],http[_0x14bb09(0x1da)](options,function(_0x324244){var _0x4ac5e4=_0x14bb09;_0x3465c7['equal'](_0x324244[_0x4ac5e4(0x19d)],0xc8),_0x3465c7['end']();});}),test(_0x2b8960(0x1a9),function(_0x590fe2){var _0x45c8c9=_0x2b8960,_0x4e42e7={'ZOXce':_0x45c8c9(0x1e1)};server[_0x45c8c9(0x23a)]=function(_0x5b4755,_0x449487){var _0x484567=_0x45c8c9;try{httpSignature[_0x484567(0x1ca)](_0x5b4755);}catch(_0x202941){_0x590fe2[_0x484567(0x1a3)](_0x202941[_0x484567(0x1e8)],'InvalidParamsError'),_0x590fe2[_0x484567(0x1a3)](_0x202941[_0x484567(0x17d)],_0x484567(0x17e));}_0x449487['writeHead'](0xc8),_0x449487['end']();},options[_0x45c8c9(0x1c1)]['Authorization']=_0x4e42e7[_0x45c8c9(0x1e3)],http['get'](options,function(_0x2ada1a){var _0x7c3cc0=_0x45c8c9;_0x590fe2[_0x7c3cc0(0x1a3)](_0x2ada1a[_0x7c3cc0(0x19d)],0xc8),_0x590fe2['end']();});}),test(_0x2b8960(0x191),function(_0x1668a6){var _0x665d71=_0x2b8960,_0x2461d3={'WyjjL':'MissingHeaderError','hmCCe':_0x665d71(0x21e)};server[_0x665d71(0x23a)]=function(_0x513996,_0xa20c9a){var _0x447707=_0x665d71;try{httpSignature[_0x447707(0x1ca)](_0x513996);}catch(_0x327270){_0x1668a6['equal'](_0x327270[_0x447707(0x1e8)],_0x2461d3[_0x447707(0x175)]),_0x1668a6[_0x447707(0x1a3)](_0x327270[_0x447707(0x17d)],_0x2461d3[_0x447707(0x233)]);}_0xa20c9a[_0x447707(0x166)](0xc8),_0xa20c9a[_0x447707(0x1b2)]();},options[_0x665d71(0x1c1)][_0x665d71(0x177)]=_0x665d71(0x1ac),http[_0x665d71(0x1da)](options,function(_0x479b87){var _0x25e8eb=_0x665d71;_0x1668a6[_0x25e8eb(0x1a3)](_0x479b87[_0x25e8eb(0x19d)],0xc8),_0x1668a6[_0x25e8eb(0x1b2)]();});}),test(_0x2b8960(0x1ee),function(_0x1da1cb){var _0x878cb5=_0x2b8960,_0x49e2e6={'joVud':'Signature\x20keyId=\x22foo\x22,algorithm=\x22rsa-sha256\x22\x20aaabbbbcccc','eVPat':function(_0x19fb2a){return _0x19fb2a();}};server[_0x878cb5(0x23a)]=function(_0x4f8752,_0x24f362){var _0x5ca563=_0x878cb5;try{httpSignature['parseRequest'](_0x4f8752);}catch(_0x323988){_0x1da1cb[_0x5ca563(0x212)](_0x323988[_0x5ca563(0x237)]);}_0x24f362[_0x5ca563(0x166)](0xc8),_0x24f362['end']();},options['headers'][_0x878cb5(0x177)]=_0x49e2e6['joVud'],options[_0x878cb5(0x1c1)][_0x878cb5(0x210)]=_0x49e2e6[_0x878cb5(0x1b4)](_rfc1123),http[_0x878cb5(0x1da)](options,function(_0x5a99cc){var _0x27b28e=_0x878cb5;_0x1da1cb[_0x27b28e(0x1a3)](_0x5a99cc[_0x27b28e(0x19d)],0xc8),_0x1da1cb['end']();});}),test(_0x2b8960(0x1a4),function(_0x3f57af){var _0x59e5d1=_0x2b8960,_0x34280a={'yBuuc':_0x59e5d1(0x172),'PmRgu':_0x59e5d1(0x170),'COQoh':function(_0x4a0094,_0x1b9d6b){return _0x4a0094+_0x1b9d6b;},'JpBEs':_0x59e5d1(0x238)};server['tester']=function(_0xdb2146,_0x3e77ad){var _0x52514a=_0x59e5d1;try{httpSignature['parseRequest'](_0xdb2146);}catch(_0xb4f4f8){_0x3f57af['equal'](_0xb4f4f8['name'],_0x52514a(0x181)),_0x3f57af[_0x52514a(0x1a3)](_0xb4f4f8[_0x52514a(0x17d)],_0x52514a(0x203));}_0x3e77ad[_0x52514a(0x166)](0xc8),_0x3e77ad[_0x52514a(0x1b2)]();},options[_0x59e5d1(0x1c1)][_0x59e5d1(0x177)]=_0x34280a[_0x59e5d1(0x220)](_0x34280a[_0x59e5d1(0x192)],_0x59e5d1(0x197)),options[_0x59e5d1(0x1c1)]['Date']=_rfc1123(),http[_0x59e5d1(0x1da)](options,function(_0x7087af){var _0x450489=_0x59e5d1;_0x34280a[_0x450489(0x1ab)]!==_0x34280a['PmRgu']?(_0x3f57af['equal'](_0x7087af[_0x450489(0x19d)],0xc8),_0x3f57af[_0x450489(0x1b2)]()):(_0x1704ab[_0x450489(0x1a3)](_0x1992ae[_0x450489(0x19d)],0xc8),_0x40c23e['end']());});}),test(_0x2b8960(0x195),function(_0x493be6){var _0x493251=_0x2b8960,_0x4d65dc={'aPsmI':function(_0x68bbb4,_0xd00e63){return _0x68bbb4+_0xd00e63;},'vOQZa':_0x493251(0x1d6),'Ovfpl':_0x493251(0x16b),'JgXGd':'digitalSignature','qYRwX':_0x493251(0x18b),'bNonm':_0x493251(0x1cd),'NMRzF':_0x493251(0x1b2),'PAQWZ':_0x493251(0x1ea),'FOzQJ':_0x493251(0x182),'ZaKau':_0x493251(0x163)};server[_0x493251(0x23a)]=function(_0x2221fb,_0x46dbd7){var _0x31018f=_0x493251,_0x3d05da=httpSignature[_0x31018f(0x1ca)](_0x2221fb);_0x46dbd7[_0x31018f(0x166)](0xc8),_0x46dbd7[_0x31018f(0x1ff)](JSON[_0x31018f(0x22f)](_0x3d05da,null,0x2)),_0x46dbd7[_0x31018f(0x1b2)]();},options['headers'][_0x493251(0x177)]=_0x4d65dc[_0x493251(0x1f7)]+_0x4d65dc[_0x493251(0x236)]+_0x4d65dc[_0x493251(0x232)],options[_0x493251(0x1c1)][_0x493251(0x210)]=_rfc1123(),options[_0x493251(0x1c1)][_0x4d65dc[_0x493251(0x1b3)]]=uuid(),http[_0x493251(0x1da)](options,function(_0x187f2c){var _0x129ebd=_0x493251,_0x346dfd={'ioeMd':_0x129ebd(0x1b9),'zPkpk':function(_0x569707,_0x42678b){return _0x4d65dc['aPsmI'](_0x569707,_0x42678b);},'MFNLr':function(_0x1e2d1a,_0x1af6f8){return _0x1e2d1a+_0x1af6f8;},'HzbDL':function(_0x53f89c,_0x6152c5){return _0x53f89c+_0x6152c5;},'zqbAl':'content-md5:\x20','nglzp':_0x4d65dc[_0x129ebd(0x1b3)],'EPqbT':_0x129ebd(0x1a8),'oGvoZ':'rsa-sha256','zDaVF':_0x4d65dc[_0x129ebd(0x17b)],'RHDLx':_0x4d65dc['JgXGd'],'VXHGF':_0x129ebd(0x1a7),'BtJRf':_0x4d65dc['qYRwX']};_0x493be6[_0x129ebd(0x1a3)](_0x187f2c[_0x129ebd(0x19d)],0xc8);var _0x4e4045='';_0x187f2c['setEncoding']('utf8'),_0x187f2c['on'](_0x4d65dc[_0x129ebd(0x229)],function(_0x464403){_0x4e4045+=_0x464403;}),_0x187f2c['on'](_0x4d65dc[_0x129ebd(0x20a)],function(){var _0x2e984e=_0x129ebd,_0x3b43ba=_0x346dfd[_0x2e984e(0x1bf)]['split']('|'),_0x3deb4c=0x0;while(!![]){switch(_0x3b43ba[_0x3deb4c++]){case'0':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x180)],_0x1abc24[_0x2e984e(0x180)]);continue;case'1':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f9)],_0x346dfd[_0x2e984e(0x19a)](_0x346dfd['MFNLr'](_0x346dfd[_0x2e984e(0x16e)](_0x2e984e(0x168),options['headers']['Date']),'\x0a')+_0x346dfd[_0x2e984e(0x1eb)]+options[_0x2e984e(0x1c1)][_0x346dfd[_0x2e984e(0x1dc)]]+'\x0a',_0x346dfd[_0x2e984e(0x194)]));continue;case'2':_0x493be6['end']();continue;case'3':_0x493be6['equal'](_0x1abc24['params'][_0x2e984e(0x1cc)],_0x346dfd[_0x2e984e(0x20b)]);continue;case'4':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x1c1)][_0x2e984e(0x21b)],0x3);continue;case'5':var _0x1abc24=JSON[_0x2e984e(0x1fc)](_0x4e4045);continue;case'6':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)]['extensions'],_0x2e984e(0x1fe));continue;case'7':_0x493be6['ok'](_0x1abc24);continue;case'8':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x1c1)][0x2],_0x346dfd[_0x2e984e(0x21a)]);continue;case'9':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)]['keyId'],_0x2e984e(0x1a2));continue;case'10':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x1cc)][_0x2e984e(0x211)](),_0x1abc24[_0x2e984e(0x1cc)]);continue;case'11':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x1c1)][0x1],_0x346dfd[_0x2e984e(0x1dc)]);continue;case'12':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x1d4)],_0x346dfd[_0x2e984e(0x1e5)]);continue;case'13':_0x493be6['equal'](_0x1abc24[_0x2e984e(0x1f0)][_0x2e984e(0x1c1)][0x0],_0x346dfd[_0x2e984e(0x221)]);continue;case'14':_0x493be6[_0x2e984e(0x1a3)](_0x1abc24[_0x2e984e(0x22e)],_0x346dfd[_0x2e984e(0x160)]);continue;case'15':_0x493be6['ok'](_0x1abc24['params'][_0x2e984e(0x1c1)]);continue;case'16':console[_0x2e984e(0x205)](_0x4e4045);continue;case'17':_0x493be6['ok'](_0x1abc24[_0x2e984e(0x1f9)]);continue;case'18':_0x493be6['ok'](_0x1abc24[_0x2e984e(0x1f0)]);continue;}break;}});});}),test('expired',function(_0x5bdb29){var _0x2d92e1=_0x2b8960,_0x2491df={'iuphw':function(_0x24a670,_0x5e0711){return _0x24a670===_0x5e0711;},'uUyAP':_0x2d92e1(0x1a7),'qNSDq':function(_0x25ae10,_0x1f1317,_0x2c7549){return _0x25ae10(_0x1f1317,_0x2c7549);},'HzXmJ':_0x2d92e1(0x19c),'gzepe':_0x2d92e1(0x1b1)};server['tester']=function(_0x668726,_0x5dde4c){var _0x23bbfa=_0x2d92e1,_0x2d4eb5={'adujH':_0x23bbfa(0x196)};if(_0x2491df['iuphw'](_0x23bbfa(0x164),_0x23bbfa(0x19b)))_0x3f7335['equal'](_0x171c75[_0x23bbfa(0x19d)],0xc8),_0x684d7e[_0x23bbfa(0x1b2)]();else{var _0x420ecf={'clockSkew':0x1,'headers':[_0x2491df[_0x23bbfa(0x202)]]};_0x2491df[_0x23bbfa(0x1df)](setTimeout,function(){var _0x53edfa=_0x23bbfa;try{_0x2d4eb5[_0x53edfa(0x1e7)]==='rkpZC'?httpSignature[_0x53edfa(0x1ca)](_0x668726):(_0x5c973d[_0x53edfa(0x1a3)](_0x2f5b1f[_0x53edfa(0x19d)],0xc8),_0x2399f4[_0x53edfa(0x1b2)]());}catch(_0x18a7ba){_0x5bdb29['equal'](_0x18a7ba[_0x53edfa(0x1e8)],'ExpiredRequestError'),_0x5bdb29['ok'](/clock skew of \d\.\d+s was greater than 1s/[_0x53edfa(0x18f)](_0x18a7ba['message']));}_0x5dde4c[_0x53edfa(0x166)](0xc8),_0x5dde4c[_0x53edfa(0x1b2)]();},0x4b0);}},options[_0x2d92e1(0x1c1)]['Authorization']=_0x2491df['HzXmJ']+_0x2491df[_0x2d92e1(0x1e2)],options[_0x2d92e1(0x1c1)][_0x2d92e1(0x210)]=_rfc1123(),options['headers'][_0x2d92e1(0x1d6)]=uuid(),http[_0x2d92e1(0x1da)](options,function(_0x34a373){var _0x53e952=_0x2d92e1;_0x5bdb29[_0x53e952(0x1a3)](_0x34a373[_0x53e952(0x19d)],0xc8),_0x5bdb29['end']();});}),test(_0x2b8960(0x1a0),function(_0xffad6){var _0x53d44e=_0x2b8960,_0x55f937={'Kdeqy':'date','HtPPt':_0x53d44e(0x181),'YKAMY':function(_0x56eb51,_0x5256ce){return _0x56eb51+_0x5256ce;},'ejJTz':_0x53d44e(0x1b1),'JQTWW':function(_0x2907d1){return _0x2907d1();},'oLbpI':'content-md5','WMfCk':function(_0x177fe5){return _0x177fe5();}};server[_0x53d44e(0x23a)]=function(_0x5130d6,_0x4ffcde){var _0x5d7fc0=_0x53d44e,_0x34f8ba={'clockSkew':0x1,'headers':[_0x55f937['Kdeqy'],_0x5d7fc0(0x1bc)]};try{httpSignature['parseRequest'](_0x5130d6,_0x34f8ba);}catch(_0x2d0f18){_0xffad6[_0x5d7fc0(0x1a3)](_0x2d0f18[_0x5d7fc0(0x1e8)],_0x55f937[_0x5d7fc0(0x167)]),_0xffad6['equal'](_0x2d0f18[_0x5d7fc0(0x17d)],'x-unit-test\x20was\x20not\x20a\x20signed\x20header');}_0x4ffcde['writeHead'](0xc8),_0x4ffcde[_0x5d7fc0(0x1b2)]();},options['headers'][_0x53d44e(0x177)]=_0x55f937[_0x53d44e(0x235)](_0x53d44e(0x19c),_0x55f937[_0x53d44e(0x1c3)]),options[_0x53d44e(0x1c1)][_0x53d44e(0x210)]=_0x55f937[_0x53d44e(0x176)](_rfc1123),options['headers'][_0x55f937[_0x53d44e(0x21f)]]=_0x55f937[_0x53d44e(0x1be)](uuid),http[_0x53d44e(0x1da)](options,function(_0x10960e){var _0x2d31b7=_0x53d44e;'zEERc'===_0x2d31b7(0x1b5)?(_0xffad6[_0x2d31b7(0x1a3)](_0x10960e[_0x2d31b7(0x19d)],0xc8),_0xffad6['end']()):_0x12dd9a[_0x2d31b7(0x1a3)](_0x49135d[_0x2d31b7(0x1e8)],_0x2d31b7(0x181));});}),test(_0x2b8960(0x193),function(_0x4ca91c){var _0x5bb7a1=_0x2b8960,_0x376c78={'ijaOF':'0|3|4|2|1','xYjQm':'content-md5','rMqyk':function(_0x3b2b88,_0x17cbb2){return _0x3b2b88+_0x17cbb2;},'TSSpS':_0x5bb7a1(0x19c),'zPXcN':'headers=\x22dAtE\x20cOntEnt-MD5\x22\x20digitalSignature','gOzLj':function(_0x34aa9d){return _0x34aa9d();}},_0xfc03d7=_0x376c78[_0x5bb7a1(0x189)][_0x5bb7a1(0x230)]('|'),_0x591c76=0x0;while(!![]){switch(_0xfc03d7[_0x591c76++]){case'0':server['tester']=function(_0x3fa538,_0x1ddebd){var _0x1abbff=_0x5bb7a1,_0x41631f={'clockSkew':0x1,'algorithms':[_0x1abbff(0x1fd)]};try{httpSignature[_0x1abbff(0x1ca)](_0x3fa538,_0x41631f);}catch(_0x463903){_0x4ca91c[_0x1abbff(0x1a3)](_0x1abbff(0x1d2),_0x463903[_0x1abbff(0x1e8)]),_0x4ca91c[_0x1abbff(0x1a3)](_0x1abbff(0x1f3),_0x463903[_0x1abbff(0x17d)]);}_0x1ddebd[_0x1abbff(0x166)](0xc8),_0x1ddebd[_0x1abbff(0x1b2)]();};continue;case'1':http[_0x5bb7a1(0x1da)](options,function(_0x3af010){var _0x3ab86d=_0x5bb7a1;_0x4ca91c[_0x3ab86d(0x1a3)](_0x3af010[_0x3ab86d(0x19d)],0xc8),_0x4ca91c[_0x3ab86d(0x1b2)]();});continue;case'2':options[_0x5bb7a1(0x1c1)][_0x376c78['xYjQm']]=uuid();continue;case'3':options[_0x5bb7a1(0x1c1)]['Authorization']=_0x376c78[_0x5bb7a1(0x1d0)](_0x376c78[_0x5bb7a1(0x239)],_0x376c78[_0x5bb7a1(0x1c6)]);continue;case'4':options[_0x5bb7a1(0x1c1)][_0x5bb7a1(0x210)]=_0x376c78[_0x5bb7a1(0x187)](_rfc1123);continue;}break;}}),test(_0x2b8960(0x200),function(_0x296b25){var _0xf9c2b=_0x2b8960;server['on'](_0xf9c2b(0x179),function(){_0x296b25['end']();}),server[_0xf9c2b(0x179)]();});