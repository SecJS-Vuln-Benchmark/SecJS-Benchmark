const _0x25ac1f=_0x4740;(function(_0x56abee,_0x4ec629){const _0x37f9d4=_0x4740,_0xe6b7f2=_0x56abee();while(!![]){try{const _0x37eac2=-parseInt(_0x37f9d4(0x25b))/0x1+parseInt(_0x37f9d4(0x22c))/0x2+parseInt(_0x37f9d4(0x214))/0x3+-parseInt(_0x37f9d4(0x19c))/0x4+-parseInt(_0x37f9d4(0x246))/0x5*(-parseInt(_0x37f9d4(0x1ea))/0x6)+parseInt(_0x37f9d4(0x11b))/0x7*(parseInt(_0x37f9d4(0x18b))/0x8)+parseInt(_0x37f9d4(0x189))/0x9*(parseInt(_0x37f9d4(0x236))/0xa);if(_0x37eac2===_0x4ec629)break;else _0xe6b7f2['push'](_0xe6b7f2['shift']());}catch(_0x3692cd){_0xe6b7f2['push'](_0xe6b7f2['shift']());}}}(_0x2266,0xcb33e),require(_0x25ac1f(0x1b2))[_0x25ac1f(0x25d)]());const User=require('../../model/user'),Org=require(_0x25ac1f(0x16c)),logger=require('../../middleware/logger'),argon2=require(_0x25ac1f(0x1aa)),CONSTANTS=require(_0x25ac1f(0x1c2)),cryptoRandomString=require(_0x25ac1f(0x1dc)),uuid=require(_0x25ac1f(0x1ad)),errors=require(_0x25ac1f(0x166)),error=new errors['OrgControllerError'](),uuidAPIKey=require(_0x25ac1f(0x1dd));async function getOrgs(_0x460858,_0x2ade9f,_0x2064c9){const _0x30f122=_0x25ac1f,_0x447809={'NDuvG':function(_0x343140,_0x3636ff){return _0x343140(_0x3636ff);},'VOhMJ':function(_0x58b71a,_0x1b9609){return _0x58b71a!==_0x1b9609;},'bEDOq':_0x30f122(0x16f),'lZoCh':function(_0x57c57e,_0x3d915d){return _0x57c57e>=_0x3d915d;},'Uzxdg':'XjExT','kvEtO':_0x30f122(0x1c9),'pgAPG':_0x30f122(0x18d),'pAyzw':function(_0x3a0a69,_0x1664ff,_0x823e5c){return _0x3a0a69(_0x1664ff,_0x823e5c);}};try{const _0x57fcd3=CONSTANTS[_0x30f122(0x143)];_0x57fcd3[_0x30f122(0x133)]={'short_name':_0x30f122(0x130)},_0x57fcd3[_0x30f122(0x12a)]=_0x460858[_0x30f122(0x226)]['query']['page']?parseInt(_0x460858[_0x30f122(0x226)][_0x30f122(0x259)][_0x30f122(0x12a)]):CONSTANTS[_0x30f122(0x13d)];const _0x171e6a=_0x460858[_0x30f122(0x226)]['repositories'][_0x30f122(0x24a)](),_0x3a0f2e=setAggregateOrgObj({}),_0x15e29f=await _0x171e6a[_0x30f122(0x174)](_0x3a0f2e,_0x57fcd3),_0x18c17c={'organizations':_0x15e29f[_0x30f122(0x131)]};if(_0x447809[_0x30f122(0x21a)](_0x15e29f[_0x30f122(0x1e1)],CONSTANTS[_0x30f122(0x143)][_0x30f122(0x228)])){if('XjExT'!==_0x447809[_0x30f122(0x164)])_0x447809[_0x30f122(0x1ac)](_0x1ffcec,_0x108293);else{const _0x44b985=_0x447809[_0x30f122(0x231)][_0x30f122(0x241)]('|');let _0x15bd30=0x0;while(!![]){switch(_0x44b985[_0x15bd30++]){case'0':_0x18c17c[_0x30f122(0x233)]=_0x15e29f[_0x30f122(0x233)];continue;case'1':_0x18c17c[_0x30f122(0x114)]=_0x15e29f[_0x30f122(0x114)];continue;case'2':_0x18c17c['totalCount']=_0x15e29f[_0x30f122(0x1e1)];continue;case'3':_0x18c17c['nextPage']=_0x15e29f[_0x30f122(0x1b8)];continue;case'4':_0x18c17c[_0x30f122(0x205)]=_0x15e29f['itemsPerPage'];continue;case'5':_0x18c17c[_0x30f122(0x15f)]=_0x15e29f['pageCount'];continue;}break;}}}return logger[_0x30f122(0x1d7)]({'uuid':_0x460858['ctx'][_0x30f122(0x1ad)],'message':_0x447809[_0x30f122(0x19a)]}),_0x447809[_0x30f122(0x20a)](setTimeout,function(){const _0x3d70b4=_0x30f122;_0x447809[_0x3d70b4(0x249)](_0x447809[_0x3d70b4(0x11e)],'Xswzm')?(_0x2d0e9a=_0x3d1f30[_0x3d70b4(0x226)][_0x3d70b4(0x259)]['org_shortname'],_0x207dfb=!![]):console[_0x3d70b4(0x142)](_0x3d70b4(0x195));},0x64),_0x2ade9f['status'](0xc8)[_0x30f122(0x14c)](_0x18c17c);}catch(_0x86e571){_0x2064c9(_0x86e571);}}function _0x4740(_0x496765,_0x3a9e2a){const _0x2266ab=_0x2266();return _0x4740=function(_0x4740ae,_0x5e222e){_0x4740ae=_0x4740ae-0x113;let _0x13cab1=_0x2266ab[_0x4740ae];return _0x13cab1;},_0x4740(_0x496765,_0x3a9e2a);}async function getOrg(_0x598498,_0x371431,_0x719a7e){const _0x11fa40=_0x25ac1f,_0x1562ca={'BSgxM':_0x11fa40(0x195),'WlAzu':function(_0x32bb59,_0x41e3e3){return _0x32bb59(_0x41e3e3);},'ArFVB':function(_0x2151e9,_0x3960a1){return _0x2151e9+_0x3960a1;},'RmIiF':_0x11fa40(0x116),'BgYTY':function(_0x728159,_0x8eeab7,_0x3627e3){return _0x728159(_0x8eeab7,_0x3627e3);},'MvCAL':function(_0x154878,_0x4df70){return _0x154878>_0x4df70;},'GGWbW':function(_0x6a0136,_0x53cd0b){return _0x6a0136+_0x53cd0b;},'LvYrD':_0x11fa40(0x165),'SoAOy':'var\x20x\x20=\x2042;\x20return\x20x;','IGCmh':function(_0x1b62cd,_0x583466){return _0x1b62cd(_0x583466);}};try{const _0x450222=_0x598498[_0x11fa40(0x226)][_0x11fa40(0x1e5)],_0x31e64f=_0x598498['ctx'][_0x11fa40(0x20b)]['identifier'],_0x2562b4=_0x598498[_0x11fa40(0x226)][_0x11fa40(0x1b6)][_0x11fa40(0x24a)](),_0x4bf73a=await _0x2562b4['isSecretariat'](_0x450222),_0x4be19a=await _0x2562b4[_0x11fa40(0x180)](_0x450222);let _0x40be9d=_0x450222,_0x39dfff=_0x1562ca[_0x11fa40(0x244)](setAggregateOrgObj,{'short_name':_0x31e64f});uuidAPIKey[_0x11fa40(0x198)](_0x31e64f)&&(_0x40be9d=_0x4be19a[_0x11fa40(0x1f0)],_0x39dfff=_0x1562ca['WlAzu'](setAggregateOrgObj,{'UUID':_0x31e64f}));if(_0x40be9d!==_0x31e64f&&!_0x4bf73a)return logger[_0x11fa40(0x1d7)]({'uuid':_0x598498[_0x11fa40(0x226)][_0x11fa40(0x1ad)],'message':_0x1562ca[_0x11fa40(0x22e)](_0x31e64f,_0x1562ca[_0x11fa40(0x21d)])}),_0x1562ca[_0x11fa40(0x239)](setTimeout,function(){const _0x2fddac=_0x11fa40;console[_0x2fddac(0x142)](_0x1562ca[_0x2fddac(0x148)]);},0x64),_0x371431['status'](0x193)['json'](error['notSameOrgOrSecretariat']());let _0x409b82=await _0x2562b4[_0x11fa40(0x1ed)](_0x39dfff);_0x409b82=_0x1562ca['MvCAL'](_0x409b82[_0x11fa40(0x134)],0x0)?_0x409b82[0x0]:null;if(!_0x409b82)return logger['info']({'uuid':_0x598498[_0x11fa40(0x226)]['uuid'],'message':_0x1562ca[_0x11fa40(0x14e)](_0x31e64f,_0x1562ca['LvYrD'])}),_0x1562ca['BgYTY'](setTimeout,_0x11fa40(0x21e),0x3e8),_0x371431[_0x11fa40(0x18a)](0x194)[_0x11fa40(0x14c)](error['orgDneParam'](_0x31e64f));return logger[_0x11fa40(0x1d7)]({'uuid':_0x598498[_0x11fa40(0x226)]['uuid'],'message':_0x1562ca[_0x11fa40(0x22e)](_0x31e64f,_0x11fa40(0x146)),'org':_0x409b82}),new Function(_0x1562ca[_0x11fa40(0x25c)])(),_0x371431[_0x11fa40(0x18a)](0xc8)[_0x11fa40(0x14c)](_0x409b82);}catch(_0x1fc6bc){_0x1562ca[_0x11fa40(0x125)](_0x719a7e,_0x1fc6bc);}}async function getUsers(_0xfdaf5d,_0x147577,_0x2ceec3){const _0x34878f=_0x25ac1f,_0x524a35={'XMHXh':function(_0x25e14d,_0x2f18c8){return _0x25e14d+_0x2f18c8;},'MvSgG':function(_0x22ec41,_0x5d6547){return _0x22ec41(_0x5d6547);},'xziAX':function(_0x1f9f6c,_0x452a1d){return _0x1f9f6c!==_0x452a1d;},'GfXKv':_0x34878f(0x165),'vSfnj':_0x34878f(0x144),'myJZJ':function(_0x5563f0,_0x425f42){return _0x5563f0+_0x425f42;},'NeBNh':_0x34878f(0x116),'ShgMY':'var\x20x\x20=\x2042;\x20return\x20x;','NoQUD':function(_0x8cba3e,_0x5d4ae1){return _0x8cba3e(_0x5d4ae1);},'texDi':function(_0x54ed7c,_0x42e6fb){return _0x54ed7c===_0x42e6fb;}};try{const _0x5e2331=CONSTANTS[_0x34878f(0x143)];_0x5e2331['sort']={'username':_0x34878f(0x130)},_0x5e2331[_0x34878f(0x12a)]=_0xfdaf5d[_0x34878f(0x226)]['query']['page']?_0x524a35[_0x34878f(0x24f)](parseInt,_0xfdaf5d['ctx'][_0x34878f(0x259)]['page']):CONSTANTS[_0x34878f(0x13d)];const _0x3fe25a=_0xfdaf5d[_0x34878f(0x226)][_0x34878f(0x1e5)],_0x57dfbd=_0xfdaf5d[_0x34878f(0x226)][_0x34878f(0x20b)][_0x34878f(0x22f)],_0x46fa78=_0xfdaf5d['ctx']['repositories'][_0x34878f(0x24a)](),_0x2f4490=_0xfdaf5d[_0x34878f(0x226)]['repositories'][_0x34878f(0x150)](),_0x452d4a=await _0x46fa78[_0x34878f(0x24c)](_0x57dfbd),_0x45d945=await _0x46fa78[_0x34878f(0x210)](_0x3fe25a);if(!_0x452d4a)return _0x524a35[_0x34878f(0x1c4)](_0x34878f(0x229),_0x34878f(0x229))?(_0x3c51a0[_0x34878f(0x1d7)]({'uuid':_0xec6c71[_0x34878f(0x226)][_0x34878f(0x1ad)],'message':_0x524a35[_0x34878f(0x234)](_0x2eb111[_0x34878f(0x1a4)],'\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.')}),_0x5b452f(_0x34878f(0x15c),0x3e8),_0xc186ef[_0x34878f(0x18a)](0x190)[_0x34878f(0x14c)](_0xa36e58[_0x34878f(0x22d)](_0x5a96dc[_0x34878f(0x1a4)]))):(logger[_0x34878f(0x1d7)]({'uuid':_0xfdaf5d['ctx'][_0x34878f(0x1ad)],'message':_0x524a35['XMHXh'](_0x57dfbd,_0x524a35['GfXKv'])}),new AsyncFunction(_0x524a35[_0x34878f(0x23c)])(),_0x147577[_0x34878f(0x18a)](0x194)['json'](error[_0x34878f(0x221)](_0x57dfbd)));if(_0x57dfbd!==_0x3fe25a&&!_0x45d945)return logger['info']({'uuid':_0xfdaf5d[_0x34878f(0x226)]['uuid'],'message':_0x524a35['myJZJ'](_0x57dfbd,_0x524a35['NeBNh'])}),new Function(_0x524a35[_0x34878f(0x193)])(),_0x147577[_0x34878f(0x18a)](0x193)[_0x34878f(0x14c)](error[_0x34878f(0x118)]());const _0x1e6c3f=_0x524a35['NoQUD'](setAggregateUserObj,{'org_UUID':_0x452d4a}),_0x43b366=await _0x2f4490[_0x34878f(0x174)](_0x1e6c3f,_0x5e2331),_0x3b0814={'users':_0x43b366['itemsList']};return _0x43b366[_0x34878f(0x1e1)]>=CONSTANTS['PAGINATOR_OPTIONS']['limit']&&(_0x3b0814['totalCount']=_0x43b366[_0x34878f(0x1e1)],_0x3b0814['itemsPerPage']=_0x43b366[_0x34878f(0x205)],_0x3b0814[_0x34878f(0x15f)]=_0x43b366[_0x34878f(0x15f)],_0x3b0814[_0x34878f(0x114)]=_0x43b366[_0x34878f(0x114)],_0x3b0814[_0x34878f(0x233)]=_0x43b366[_0x34878f(0x233)],_0x3b0814[_0x34878f(0x1b8)]=_0x43b366[_0x34878f(0x1b8)]),logger['info']({'uuid':_0xfdaf5d[_0x34878f(0x226)][_0x34878f(0x1ad)],'message':_0x34878f(0x1f3)+_0x57dfbd+_0x34878f(0x160)}),Function('return\x20new\x20Date();')(),_0x147577[_0x34878f(0x18a)](0xc8)[_0x34878f(0x14c)](_0x3b0814);}catch(_0x5ae505){_0x524a35[_0x34878f(0x20d)]('lxesI',_0x34878f(0x258))?_0x2ceec3(_0x5ae505):rqWEpN[_0x34878f(0x234)](0x1,0x1);}}async function getUser(_0x254c1f,_0x54e75e,_0x3b1b78){const _0x3e2a5a=_0x25ac1f,_0x26b4c6={'xJFJJ':function(_0x5c4167,_0x66477b){return _0x5c4167!==_0x66477b;},'kEnWp':function(_0x331ff9,_0xeb4586){return _0x331ff9+_0xeb4586;},'PmRKV':_0x3e2a5a(0x165),'rVtrf':_0x3e2a5a(0x115),'ZIhwf':function(_0x5df9a5,_0x537700){return _0x5df9a5+_0x537700;},'weKpp':_0x3e2a5a(0x1d9),'LYxkL':'console.log(\x22timer\x22);','NLToo':function(_0x44254b,_0x154a97){return _0x44254b(_0x154a97);}};try{const _0x3035c3=_0x254c1f[_0x3e2a5a(0x226)][_0x3e2a5a(0x1e5)],_0x2f0e7d=_0x254c1f['ctx'][_0x3e2a5a(0x20b)]['username'],_0xb166d1=_0x254c1f[_0x3e2a5a(0x226)]['params']['shortname'],_0x39476b=_0x254c1f[_0x3e2a5a(0x226)][_0x3e2a5a(0x1b6)]['getOrgRepository'](),_0x5bacc9=await _0x39476b[_0x3e2a5a(0x210)](_0x3035c3);if(_0x26b4c6[_0x3e2a5a(0x23b)](_0xb166d1,_0x3035c3)&&!_0x5bacc9)return logger[_0x3e2a5a(0x1d7)]({'uuid':_0x254c1f['ctx'][_0x3e2a5a(0x1ad)],'message':_0x3035c3+_0x3e2a5a(0x1c8)}),Function(_0x3e2a5a(0x17f))(),_0x54e75e[_0x3e2a5a(0x18a)](0x193)[_0x3e2a5a(0x14c)](error[_0x3e2a5a(0x118)]());const _0x3b640b=await _0x39476b[_0x3e2a5a(0x24c)](_0xb166d1);if(!_0x3b640b)return logger[_0x3e2a5a(0x1d7)]({'uuid':_0x254c1f[_0x3e2a5a(0x226)]['uuid'],'message':_0x26b4c6[_0x3e2a5a(0x253)](_0xb166d1,_0x26b4c6[_0x3e2a5a(0x240)])}),Function('return\x20new\x20Date();')(),_0x54e75e[_0x3e2a5a(0x18a)](0x194)['json'](error[_0x3e2a5a(0x221)](_0xb166d1));const _0x290809=_0x254c1f[_0x3e2a5a(0x226)]['repositories'][_0x3e2a5a(0x150)](),_0x279f96=setAggregateUserObj({'username':_0x2f0e7d,'org_UUID':_0x3b640b});let _0x51c22c=await _0x290809[_0x3e2a5a(0x1ed)](_0x279f96);_0x51c22c=_0x51c22c[_0x3e2a5a(0x134)]>0x0?_0x51c22c[0x0]:null;if(!_0x51c22c)return logger[_0x3e2a5a(0x1d7)]({'uuid':_0x254c1f[_0x3e2a5a(0x226)]['uuid'],'message':_0x2f0e7d+_0x26b4c6['rVtrf']}),Function(_0x3e2a5a(0x17f))(),_0x54e75e['status'](0x194)[_0x3e2a5a(0x14c)](error[_0x3e2a5a(0x1a0)](_0x2f0e7d));return logger['info']({'uuid':_0x254c1f[_0x3e2a5a(0x226)]['uuid'],'message':_0x26b4c6[_0x3e2a5a(0x1d1)](_0x2f0e7d,_0x26b4c6['weKpp']),'user':_0x51c22c}),setTimeout(_0x26b4c6[_0x3e2a5a(0x212)],0x3e8),_0x54e75e[_0x3e2a5a(0x18a)](0xc8)['json'](_0x51c22c);}catch(_0x39e14f){_0x26b4c6[_0x3e2a5a(0x1f4)](_0x3b1b78,_0x39e14f);}}async function getOrgIdQuota(_0x3548bd,_0x3ddd16,_0x1ede9a){const _0x95c6f5=_0x25ac1f,_0x519b1b={'vdYyE':_0x95c6f5(0x165),'YMUwW':function(_0x457258,_0x3ff448){return _0x457258(_0x3ff448);},'oySbk':_0x95c6f5(0x1bf),'JAirf':'\x20organization\x20id\x20quota\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','CUKVk':_0x95c6f5(0x17f)};try{const _0x387bf8=_0x3548bd[_0x95c6f5(0x226)][_0x95c6f5(0x1e5)],_0x7f44d2=_0x3548bd[_0x95c6f5(0x226)]['params'][_0x95c6f5(0x22f)],_0x42c20f=_0x3548bd[_0x95c6f5(0x226)][_0x95c6f5(0x1b6)][_0x95c6f5(0x24a)](),_0x198624=await _0x42c20f[_0x95c6f5(0x210)](_0x387bf8);if(_0x387bf8!==_0x7f44d2&&!_0x198624)return _0x519b1b[_0x95c6f5(0x1c3)]==='jcRXe'?(logger[_0x95c6f5(0x1d7)]({'uuid':_0x3548bd[_0x95c6f5(0x226)]['uuid'],'message':_0x7f44d2+_0x519b1b[_0x95c6f5(0x18c)]}),_0x519b1b[_0x95c6f5(0x1a7)](Function,_0x519b1b[_0x95c6f5(0x14a)])(),_0x3ddd16[_0x95c6f5(0x18a)](0x193)[_0x95c6f5(0x14c)](error[_0x95c6f5(0x118)]())):(_0x3e4d3a['info']({'uuid':_0x30f1ae['ctx'][_0x95c6f5(0x1ad)],'message':_0x3330fa+_0x519b1b['vdYyE']}),_0x519b1b['YMUwW'](_0x2ccd8a,'return\x20new\x20Date();')(),_0x2640c2[_0x95c6f5(0x18a)](0x194)[_0x95c6f5(0x14c)](_0x2999fb[_0x95c6f5(0x221)](_0x3195d2)));let _0x202c09=await _0x42c20f[_0x95c6f5(0x180)](_0x7f44d2);if(!_0x202c09)return logger[_0x95c6f5(0x1d7)]({'uuid':_0x3548bd[_0x95c6f5(0x226)][_0x95c6f5(0x1ad)],'message':_0x7f44d2+_0x95c6f5(0x165)}),new Function(_0x95c6f5(0x121))(),_0x3ddd16['status'](0x194)[_0x95c6f5(0x14c)](error[_0x95c6f5(0x221)](_0x7f44d2));const _0x3ac2dc={'id_quota':_0x202c09[_0x95c6f5(0x127)][_0x95c6f5(0x1d3)],'total_reserved':null,'available':null},_0x284528={'owning_cna':await _0x42c20f['getOrgUUID'](_0x7f44d2),'state':CONSTANTS[_0x95c6f5(0x257)][_0x95c6f5(0x1cc)]},_0x35e0ae=_0x3548bd[_0x95c6f5(0x226)][_0x95c6f5(0x1b6)]['getCveIdRepository']();return _0x202c09=await _0x35e0ae[_0x95c6f5(0x21b)](_0x284528),_0x3ac2dc['total_reserved']=_0x202c09,_0x3ac2dc[_0x95c6f5(0x139)]=_0x3ac2dc[_0x95c6f5(0x1d3)]-_0x3ac2dc['total_reserved'],logger[_0x95c6f5(0x1d7)]({'uuid':_0x3548bd[_0x95c6f5(0x226)][_0x95c6f5(0x1ad)],'message':_0x95c6f5(0x16e),'details':_0x3ac2dc}),eval('const _0x55a0b0 = _0x95c6f5;JSON[_0x55a0b0(337)]({ \'safe\': !![] });'),_0x3ddd16[_0x95c6f5(0x18a)](0xc8)[_0x95c6f5(0x14c)](_0x3ac2dc);}catch(_0x5d6c9b){_0x1ede9a(_0x5d6c9b);}}async function createOrg(_0x4a57d2,_0x30051b,_0x16d3a5){const _0x1dd12f=_0x25ac1f,_0x1e6210={'lIDni':function(_0x150738,_0xd96846){return _0x150738===_0xd96846;},'RwyBu':function(_0x5556c6,_0x50ff03){return _0x5556c6===_0x50ff03;},'FLBRL':function(_0x32537b,_0x523b0e){return _0x32537b===_0x523b0e;},'TPFhf':_0x1dd12f(0x184),'SPQuE':'BuRqP','RvZjO':function(_0x2a059b,_0x58c8eb){return _0x2a059b===_0x58c8eb;},'XDAFq':_0x1dd12f(0x225),'UtMQy':'kldqJ','BdXNX':_0x1dd12f(0x17f),'GHEDK':function(_0x363efe,_0x16b881){return _0x363efe*_0x16b881;},'ESkjj':_0x1dd12f(0x121),'SVUwq':function(_0x16529d,_0x3e9a6e){return _0x16529d+_0x3e9a6e;},'BpqcB':_0x1dd12f(0x1e7),'qzYSH':function(_0xe03cb0,_0x63b834){return _0xe03cb0===_0x63b834;},'fBvFI':_0x1dd12f(0x13a),'LmQCH':function(_0x38fd78,_0x23f809){return _0x38fd78(_0x23f809);},'UbHbS':function(_0x287808,_0x4ef96b){return _0x287808>_0x4ef96b;},'bfNGr':_0x1dd12f(0x1fd)};try{const _0x508172=new Org(),_0x26a083=_0x4a57d2[_0x1dd12f(0x226)][_0x1dd12f(0x1b6)][_0x1dd12f(0x24a)]();Object[_0x1dd12f(0x122)](_0x4a57d2[_0x1dd12f(0x226)][_0x1dd12f(0x155)])[_0x1dd12f(0x255)](_0x3f4187=>{const _0x50c6c0=_0x1dd12f,_0x462980=_0x3f4187[_0x50c6c0(0x136)]();if(_0x1e6210[_0x50c6c0(0x128)](_0x462980,_0x50c6c0(0x22b)))_0x508172[_0x50c6c0(0x22b)]=_0x4a57d2['ctx'][_0x50c6c0(0x155)][_0x50c6c0(0x22b)];else{if(_0x1e6210[_0x50c6c0(0x159)](_0x462980,_0x50c6c0(0x18e)))_0x508172[_0x50c6c0(0x18e)]=_0x4a57d2[_0x50c6c0(0x226)][_0x50c6c0(0x155)]['name'];else{if(_0x1e6210[_0x50c6c0(0x1e2)](_0x462980,_0x1e6210[_0x50c6c0(0x1a9)])){if(_0x50c6c0(0x140)!==_0x1e6210[_0x50c6c0(0x1a6)])return eval('1 + 1;'),_0x667ebb[_0x50c6c0(0x18a)](0x193)[_0x50c6c0(0x14c)](_0x358ea8[_0x50c6c0(0x14f)](_0x31b37e[_0x50c6c0(0x22b)]));else _0x4a57d2[_0x50c6c0(0x226)][_0x50c6c0(0x155)][_0x50c6c0(0x184)]['active_roles']&&(_0x1e6210[_0x50c6c0(0x1f5)](_0x1e6210['XDAFq'],_0x50c6c0(0x20f))?_0x20875f[_0x50c6c0(0x1a3)](_0x3652c3):_0x508172[_0x50c6c0(0x184)][_0x50c6c0(0x1d6)]=_0x4a57d2[_0x50c6c0(0x226)][_0x50c6c0(0x155)][_0x50c6c0(0x184)]['active_roles']);}else{if(_0x462980===_0x50c6c0(0x127)){if(_0x1e6210[_0x50c6c0(0x175)]!==_0x50c6c0(0x12c))return eval('_0x3c379d[\'PI\'] * 2;'),_0x32a1c3['status'](0x190)[_0x50c6c0(0x14c)](_0x489b14[_0x50c6c0(0x1cb)]());else _0x4a57d2[_0x50c6c0(0x226)][_0x50c6c0(0x155)][_0x50c6c0(0x127)][_0x50c6c0(0x1d3)]&&(_0x508172[_0x50c6c0(0x127)][_0x50c6c0(0x1d3)]=_0x4a57d2[_0x50c6c0(0x226)][_0x50c6c0(0x155)]['policies'][_0x50c6c0(0x1d3)]);}else{if(_0x462980===_0x50c6c0(0x1ad))return Function(_0x1e6210[_0x50c6c0(0x199)])(),_0x30051b[_0x50c6c0(0x18a)](0x190)[_0x50c6c0(0x14c)](error[_0x50c6c0(0x1cb)]());}}}}});let _0x4d64fb=await _0x26a083[_0x1dd12f(0x180)](_0x508172[_0x1dd12f(0x22b)]);if(_0x4d64fb)return logger['info']({'uuid':_0x4a57d2['ctx']['uuid'],'message':_0x1e6210[_0x1dd12f(0x15e)](_0x508172[_0x1dd12f(0x22b)],_0x1e6210[_0x1dd12f(0x181)])}),eval('_0x1e6210[\'GHEDK\'](Math[\'PI\'], 2);'),_0x30051b['status'](0x190)[_0x1dd12f(0x14c)](error[_0x1dd12f(0x24b)](_0x508172['short_name']));_0x508172[_0x1dd12f(0x117)]=![],_0x508172[_0x1dd12f(0x1f0)]=uuid['v4'](),_0x508172[_0x1dd12f(0x184)][_0x1dd12f(0x1d6)]=[CONSTANTS['AUTH_ROLE_ENUM'][_0x1dd12f(0x215)]];if(!_0x508172[_0x1dd12f(0x127)][_0x1dd12f(0x1d3)]){if(_0x1e6210['qzYSH']('PavwQ',_0x1e6210[_0x1dd12f(0x251)]))_0x508172['policies'][_0x1dd12f(0x1d3)]=CONSTANTS[_0x1dd12f(0x242)];else return new _0x2e09ef(_0x1e6210[_0x1dd12f(0x1f9)])(),[{'$match':_0x7fc4f7},{'$project':{'_id':![],'username':!![],'name':!![],'UUID':!![],'org_UUID':!![],'active':!![],'authority.active_roles':!![],'time':!![]}}];}await _0x26a083[_0x1dd12f(0x19b)](_0x508172[_0x1dd12f(0x1f0)],_0x508172,{'upsert':!![]});const _0x47d895=_0x1e6210[_0x1dd12f(0x200)](setAggregateOrgObj,{'short_name':_0x508172[_0x1dd12f(0x22b)]});_0x4d64fb=await _0x26a083[_0x1dd12f(0x1ed)](_0x47d895),_0x4d64fb=_0x1e6210[_0x1dd12f(0x14b)](_0x4d64fb[_0x1dd12f(0x134)],0x0)?_0x4d64fb[0x0]:null;const _0x18f1ca={'message':_0x508172[_0x1dd12f(0x22b)]+_0x1dd12f(0x1ab),'created':_0x4d64fb},_0x5a2322={'action':_0x1e6210[_0x1dd12f(0x196)],'change':_0x1e6210[_0x1dd12f(0x15e)](_0x508172[_0x1dd12f(0x22b)],_0x1dd12f(0x1ab)),'req_UUID':_0x4a57d2[_0x1dd12f(0x226)][_0x1dd12f(0x1ad)],'org_UUID':await _0x26a083[_0x1dd12f(0x24c)](_0x4a57d2[_0x1dd12f(0x226)]['org']),'org':_0x4d64fb},_0x9c3dd=_0x4a57d2[_0x1dd12f(0x226)][_0x1dd12f(0x1b6)][_0x1dd12f(0x150)]();return _0x5a2322[_0x1dd12f(0x1cd)]=await _0x9c3dd[_0x1dd12f(0x156)](_0x4a57d2[_0x1dd12f(0x226)][_0x1dd12f(0x1de)],_0x5a2322[_0x1dd12f(0x1d0)]),logger[_0x1dd12f(0x1d7)](JSON[_0x1dd12f(0x151)](_0x5a2322)),setTimeout(function(){const _0x534695=_0x1dd12f;console[_0x534695(0x142)](_0x534695(0x195));},0x64),_0x30051b[_0x1dd12f(0x18a)](0xc8)[_0x1dd12f(0x14c)](_0x18f1ca);}catch(_0x10076d){_0x16d3a5(_0x10076d);}}function _0x2266(){const _0x53943d=['2327626PjZQzc','userExists','ArFVB','shortname','MlRGZ','kvEtO','tHXnG','prevPage','XMHXh','BDiyT','1657780mwuxGU','cWZmh','nkNRC','BgYTY','notOrgAdminOrSecretariat','xJFJJ','vSfnj','GFNJU','eBeEw','wMiqf','PmRKV','split','DEFAULT_ID_QUOTA','isSecretariatUUID','WlAzu','org_shortname','2135aPDsMC','indexOf','bzqTF','VOhMJ','getOrgRepository','orgExists','getOrgUUID','wIeCq','EZRUW','MvSgG','TbUmY','fBvFI','rREtS','kEnWp','cDHEF','forEach','oeGWx','CVE_STATES','lxesI','query','Ntnhe','993841DmqKeA','SoAOy','config','\x20was\x20successfully\x20updated.','currentPage','\x20does\x20not\x20exist.','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','inUse','notSameOrgOrSecretariat','\x20organization\x20id\x20quota\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.','ztBZv','207158QWpzGH','\x20was\x20successfully\x20created.','MEnVj','bEDOq','GFdpR','ZIgJU','var\x20x\x20=\x2042;\x20return\x20x;','keys','RgDkl','\x20user\x20does\x20not\x20exist.','IGCmh','secret','policies','lIDni','active_roles.remove','page','IDUbR','kldqJ','EqNpv','gOaYk','jOCYx','asc','itemsList','orgDne','sort','length','gsIFp','toLowerCase','YARMW','izFyR','available','PavwQ','IyuoY','sCCfi','PAGINATOR_PAGE','MYBNz','QrqNU','BuRqP','YcWpO','log','PAGINATOR_OPTIONS','return\x20await\x20Promise.resolve(42);','JJYcr','\x20organization\x20was\x20sent\x20to\x20the\x20user.','YiMLP','BSgxM','akZXS','CUKVk','UbHbS','json','sSwRf','GGWbW','duplicateShortname','getUserRepository','stringify','suffix','WneJl','yOBhj','body','getUserUUID','name.last','zfTGa','RwyBu','BOwis','vtPHD','updateClock();','\x20user\x20is\x20not\x20Org\x20Admin\x20or\x20Secretariat\x20to\x20modify\x20these\x20fields.','SVUwq','pageCount','\x20organization\x20were\x20sent\x20to\x20the\x20user.','WIjMI','PAKIL','first','Uzxdg','\x20organization\x20does\x20not\x20exist.','./error','gCPQZ','yAMwn','updateByUserNameAndOrgUUID','BeXgg','active','../../model/org','utCBl','The\x20organization\x27s\x20id\x20quota\x20was\x20returned\x20to\x20the\x20user.','Xswzm','jMPHr','isAdminUUID','active_roles.add','vZoFY','aggregatePaginate','UtMQy','cjvyw','fySJN','wZwvg','YhcVH','XzXMu','ZLkUP','dWDPc','FJPey','AAdoa','return\x20new\x20Date();','findOneByShortName','BpqcB','DqOCu','OBsvY','authority','HFGNZ','HuDCf','name.middle','ZNmlk','9RkfNiA','status','152jfunbj','JAirf','The\x20orgs\x20were\x20sent\x20to\x20the\x20user.','name','JsrOn','BRGze','mNGhk','hxCdO','ShgMY','DyZqi','safe','bfNGr','SAUXU','isUUID','BdXNX','pgAPG','updateByOrgUUID','4181020rDzVvH','dlSwC','last','API\x20secret\x20was\x20successfully\x20reset.','userDne','LXlLy','tUvwo','push','username','FLzsL','SPQuE','YMUwW','IixRg','TPFhf','argon2','\x20organization\x20was\x20successfully\x20created.','NDuvG','uuid','name.first','zHRwp','NjmbK','gFOfG','dotenv','\x20organization\x20contains\x20a\x20user\x20with\x20the\x20same\x20username.','mDYYJ','create_user','repositories','kVJNo','nextPage','splice','hash','GAOaR','name.suffix','BKPxv','Jtzlh','jcRXe','notSameUserOrSecretariat','update_user','../../constants','oySbk','xziAX','The\x20user\x20could\x20not\x20be\x20created\x20because\x20','middle','xwmXG','\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20that\x20organization\x27s\x20users\x20or\x20the\x20Secretariat.','2|4|5|1|0|3','QNSxA','uuidProvided','RESERVED','user_UUID','find','zegfk','org_UUID','ZIhwf','FcZIN','id_quota','NQrEK','JaAAc','active_roles','info','dFNoP','\x20was\x20sent\x20to\x20the\x20user.','duplicateUsername','JmGWF','crypto-random-string','uuid-apikey','user','RccpP','new_username','itemCount','FLBRL','ihdUs','\x20does\x20not\x20exist\x20for\x20','org','fMLqs','\x20organization\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','NYYsH','SfUks','468rJhlUw','findOneByUserNameAndOrgUUID','mmtUE','aggregate','meXmI','Rpwoy','UUID','pjqFa','The\x20API\x20secret\x20was\x20successfully\x20reset\x20and\x20sent\x20to\x20','The\x20users\x20of\x20','NLToo','RvZjO','YQfWd','The\x20user\x20can\x20only\x20be\x20updated\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','eIEqa','ESkjj','htheq','XeOMb','voiKa','create_org','lfnCn','The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','LmQCH','\x20organization.','return\x20Object.keys({a:1});','mAmQD','vEoSE','itemsPerPage','isAdmin','qbkzg','\x20organization\x20was\x20successfully\x20updated.','jlFok','pAyzw','params','sqrGZ','texDi','cVwmp','eiLnD','isSecretariat','isArray','LYxkL','HUKOq','2838693VQVaXs','CNA','yuSYU','CVnbE','NetaG','includes','lZoCh','countDocuments','update_org','RmIiF','console.log(\x22timer\x22);','LPjyv','KFExY','orgDneParam','kIuMh','Hjnsk','YVMBJ','fHzYf','ctx','TXZZW','limit','sebkK','dPUeY','short_name'];_0x2266=function(){return _0x53943d;};return _0x2266();}async function updateOrg(_0x2c486a,_0x4e0f68,_0xb24cea){const _0x348991=_0x25ac1f,_0x5c4f40={'TXZZW':'return\x20new\x20Date();','eIEqa':function(_0x23aff7,_0xbf9b40){return _0x23aff7+_0xbf9b40;},'pjqFa':function(_0x6f372a,_0x5e079f){return _0x6f372a===_0x5e079f;},'fySJN':'shortname','tHXnG':function(_0x57a8fc,_0x5c7633){return _0x57a8fc(_0x5c7633);},'QNSxA':function(_0xda07a5,_0x2d7b1f){return _0xda07a5===_0x2d7b1f;},'EZRUW':function(_0x32c0bc,_0x36fa79){return _0x32c0bc===_0x36fa79;},'OBsvY':_0x348991(0x14d),'Jtzlh':_0x348991(0x129),'gsIFp':'\x20organization\x20could\x20not\x20be\x20updated\x20in\x20MongoDB\x20because\x20it\x20does\x20not\x20exist.','jlFok':_0x348991(0x121),'NjmbK':_0x348991(0x1e8),'dFNoP':_0x348991(0x13c),'LXlLy':function(_0x17f912,_0x3bf5ec){return _0x17f912+_0x3bf5ec;},'DqOCu':function(_0x21059d,_0x3197fa){return _0x21059d>_0x3197fa;},'AAdoa':'\x20organization\x20was\x20successfully\x20updated.'};try{const _0x339c28=_0x2c486a['ctx']['params']['shortname'],_0x183c4e=new Org(),_0x4438bc=[],_0x4203cb=[],_0x42f7cb=_0x2c486a[_0x348991(0x226)][_0x348991(0x1b6)][_0x348991(0x24a)](),_0x9299f1=await _0x42f7cb[_0x348991(0x180)](_0x339c28);let _0x22dc86=setAggregateOrgObj({'short_name':_0x339c28});if(!_0x9299f1)return logger[_0x348991(0x1d7)]({'uuid':_0x2c486a['ctx']['uuid'],'message':_0x5c4f40[_0x348991(0x1f8)](_0x339c28,_0x5c4f40['gsIFp'])}),new Function(_0x5c4f40[_0x348991(0x209)])(),_0x4e0f68['status'](0x194)[_0x348991(0x14c)](error[_0x348991(0x221)](_0x339c28));Object[_0x348991(0x122)](_0x2c486a[_0x348991(0x226)][_0x348991(0x259)])[_0x348991(0x255)](_0xa7f305=>{const _0x190876=_0x348991,_0x179f4d={'rREtS':function(_0x22b4c0,_0x2ae9b){const _0x2a233c=_0x4740;return _0x5c4f40[_0x2a233c(0x1f8)](_0x22b4c0,_0x2ae9b);}},_0x3d5995=_0xa7f305[_0x190876(0x136)]();if(_0x5c4f40[_0x190876(0x1f1)](_0x3d5995,_0x5c4f40[_0x190876(0x177)]))_0x183c4e[_0x190876(0x22b)]=_0x2c486a['ctx'][_0x190876(0x259)][_0x190876(0x22f)],_0x22dc86=_0x5c4f40[_0x190876(0x232)](setAggregateOrgObj,{'short_name':_0x183c4e['short_name']});else{if(_0x5c4f40[_0x190876(0x1ca)](_0x3d5995,_0x190876(0x18e)))_0x183c4e[_0x190876(0x18e)]=_0x2c486a['ctx'][_0x190876(0x259)][_0x190876(0x18e)];else{if(_0x5c4f40[_0x190876(0x24e)](_0x3d5995,_0x190876(0x1d3))){if(_0x5c4f40['OBsvY']!==_0x5c4f40[_0x190876(0x183)]){const _0x2a12c0={'wZwvg':function(_0x36c66f,_0x53c0dd){return _0x36c66f*_0x53c0dd;}};return _0x3c2c74[_0x190876(0x1d7)]({'uuid':_0x312b36[_0x190876(0x226)][_0x190876(0x1ad)],'message':_0x179f4d[_0x190876(0x252)](_0x33d09d,'\x20organization\x20can\x20only\x20be\x20viewed\x20by\x20the\x20users\x20of\x20the\x20same\x20organization\x20or\x20the\x20Secretariat.')}),eval('const _0xf44d23 = _0x190876;_0x2a12c0[_0xf44d23(376)](_0x4c11cd[\'PI\'], 2);'),_0x3b2258[_0x190876(0x18a)](0x193)[_0x190876(0x14c)](_0x5365ba[_0x190876(0x118)]());}else _0x183c4e[_0x190876(0x127)]['id_quota']=_0x2c486a[_0x190876(0x226)][_0x190876(0x259)][_0x190876(0x1d3)];}else{if(_0x5c4f40[_0x190876(0x1ca)](_0x3d5995,_0x190876(0x172))){if(_0x190876(0x1ef)!==_0x190876(0x1ef))return _0x59c209['info']({'uuid':_0x483a2b['ctx']['uuid'],'message':'The\x20api\x20secret\x20can\x20only\x20be\x20reset\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.'}),_0x334595(_0x5c4f40[_0x190876(0x227)])(),_0x11eca0[_0x190876(0x18a)](0x193)[_0x190876(0x14c)](_0x189d22[_0x190876(0x1c0)]());else Array[_0x190876(0x211)](_0x2c486a[_0x190876(0x226)][_0x190876(0x259)][_0x190876(0x172)])&&_0x2c486a[_0x190876(0x226)][_0x190876(0x259)][_0x190876(0x172)][_0x190876(0x255)](_0x319a1e=>{const _0x253df7=_0x190876;_0x4203cb[_0x253df7(0x1a3)](_0x319a1e);});}else _0x3d5995===_0x5c4f40[_0x190876(0x1be)]&&(Array[_0x190876(0x211)](_0x2c486a[_0x190876(0x226)][_0x190876(0x259)][_0x5c4f40['Jtzlh']])&&_0x2c486a[_0x190876(0x226)][_0x190876(0x259)][_0x190876(0x129)][_0x190876(0x255)](_0x2b4cad=>{const _0x25dda2=_0x190876;_0x4438bc[_0x25dda2(0x1a3)](_0x2b4cad);}));}}}});if(_0x9299f1){if('NFVan'!==_0x5c4f40[_0x348991(0x1b0)]){const _0x1f431a=_0x9299f1[_0x348991(0x184)][_0x348991(0x1d6)];_0x4203cb[_0x348991(0x255)](_0x4cfb4b=>{const _0xc88acb=_0x348991;!_0x1f431a[_0xc88acb(0x219)](_0x4cfb4b)&&_0x1f431a[_0xc88acb(0x1a3)](_0x4cfb4b);}),_0x4438bc[_0x348991(0x255)](_0x2bb1f0=>{const _0x527339=_0x348991,_0x394d1d=_0x1f431a[_0x527339(0x247)](_0x2bb1f0);_0x394d1d>-0x1&&_0x1f431a['splice'](_0x394d1d,0x1);}),_0x183c4e['authority'][_0x348991(0x1d6)]=_0x1f431a;}else _0x6982ef[_0x348991(0x226)][_0x348991(0x259)][_0x348991(0x172)][_0x348991(0x255)](_0x111135=>{_0x44762c['push'](_0x111135);});}if(_0x183c4e[_0x348991(0x22b)]){if('sCCfi'===_0x5c4f40[_0x348991(0x1d8)]){const _0x304024=await _0x42f7cb[_0x348991(0x180)](_0x183c4e[_0x348991(0x22b)]);if(_0x304024)return eval('_0x5c4f40[\'eIEqa\'](1, 1);'),_0x4e0f68[_0x348991(0x18a)](0x193)[_0x348991(0x14c)](error['duplicateShortname'](_0x183c4e[_0x348991(0x22b)]));}else return _0x3b8dfd['info']({'uuid':_0x3afb8b[_0x348991(0x226)]['uuid'],'message':_0x27a8a0+_0x348991(0x119)}),_0x5c4f40['tHXnG'](_0x3b1b79,'return\x20new\x20Date();')(),_0x6f5da4[_0x348991(0x18a)](0x193)[_0x348991(0x14c)](_0x53ed17['notSameOrgOrSecretariat']());}let _0x3129d6=await _0x42f7cb['updateByOrgUUID'](_0x9299f1[_0x348991(0x1f0)],_0x183c4e);if(_0x5c4f40[_0x348991(0x1ca)](_0x3129d6['n'],0x0))return logger[_0x348991(0x1d7)]({'uuid':_0x2c486a[_0x348991(0x226)][_0x348991(0x1ad)],'message':_0x5c4f40[_0x348991(0x1a1)](_0x339c28,_0x5c4f40[_0x348991(0x135)])}),eval('_0x5c4f40[\'eIEqa\'](1, 1);'),_0x4e0f68[_0x348991(0x18a)](0x194)['json'](error['orgDneParam'](_0x339c28));_0x3129d6=await _0x42f7cb[_0x348991(0x1ed)](_0x22dc86),_0x3129d6=_0x5c4f40[_0x348991(0x182)](_0x3129d6['length'],0x0)?_0x3129d6[0x0]:null;const _0x2964c5={'message':_0x5c4f40[_0x348991(0x1a1)](_0x339c28,_0x5c4f40[_0x348991(0x17e)]),'updated':_0x3129d6},_0x40bc6c={'action':_0x348991(0x21c),'change':_0x339c28+_0x348991(0x208),'req_UUID':_0x2c486a[_0x348991(0x226)][_0x348991(0x1ad)],'org_UUID':await _0x42f7cb[_0x348991(0x24c)](_0x2c486a[_0x348991(0x226)][_0x348991(0x1e5)]),'org':_0x3129d6},_0x5e81d3=_0x2c486a[_0x348991(0x226)]['repositories'][_0x348991(0x150)]();return _0x40bc6c[_0x348991(0x1cd)]=await _0x5e81d3[_0x348991(0x156)](_0x2c486a[_0x348991(0x226)]['user'],_0x40bc6c[_0x348991(0x1d0)]),logger[_0x348991(0x1d7)](JSON[_0x348991(0x151)](_0x40bc6c)),Function(_0x5c4f40[_0x348991(0x227)])(),_0x4e0f68[_0x348991(0x18a)](0xc8)['json'](_0x2964c5);}catch(_0x447d36){_0xb24cea(_0x447d36);}}async function createUser(_0x4b2f2b,_0x1287d0,_0x579376){const _0x21278f=_0x25ac1f,_0x48ad80={'htheq':function(_0x4e0e6f,_0x287bf4){return _0x4e0e6f+_0x287bf4;},'nkNRC':function(_0x496695,_0x22237b){return _0x496695*_0x22237b;},'RgDkl':'PzVed','wmBix':_0x21278f(0x18e),'ZNmlk':function(_0x415ef2,_0x468563){return _0x415ef2===_0x468563;},'wMiqf':_0x21278f(0x25a),'JmGWF':function(_0xc02023,_0x1f032){return _0xc02023+_0x1f032;},'XCjmL':_0x21278f(0x1c5),'RccpP':_0x21278f(0x1c7),'LWaHJ':function(_0x144a42,_0x29d2d3){return _0x144a42(_0x29d2d3);},'YiMLP':_0x21278f(0x170),'BeXgg':_0x21278f(0x186),'NQrEK':function(_0x1fad73,_0x14bd7e){return _0x1fad73+_0x14bd7e;},'gCPQZ':'\x20was\x20not\x20created\x20because\x20it\x20already\x20exists.','cVwmp':function(_0xe6312a,_0x1ba455,_0x245c45){return _0xe6312a(_0x1ba455,_0x245c45);},'MlRGZ':_0x21278f(0x15c),'tUvwo':function(_0x3038f5,_0x302fbf){return _0x3038f5(_0x302fbf);},'jOCYx':function(_0x2b7116,_0x142be5){return _0x2b7116+_0x142be5;},'qbkzg':_0x21278f(0x11c),'utCBl':_0x21278f(0x1b5),'XeOMb':function(_0x2e1d47,_0x43bd36){return _0x2e1d47(_0x43bd36);}};try{const _0x381a70=_0x4b2f2b['ctx']['params']['shortname'],_0x3fc3f3=_0x4b2f2b[_0x21278f(0x226)][_0x21278f(0x1de)],_0x2703ba=_0x4b2f2b[_0x21278f(0x226)][_0x21278f(0x1e5)],_0x34cf3c=_0x4b2f2b[_0x21278f(0x226)][_0x21278f(0x1b6)][_0x21278f(0x24a)](),_0x3816f4=_0x4b2f2b['ctx'][_0x21278f(0x1b6)]['getUserRepository'](),_0xc7bcde=new User(),_0x50524c=await _0x34cf3c[_0x21278f(0x24c)](_0x381a70);if(!_0x50524c){if(_0x21278f(0x1ec)!==_0x21278f(0x1ec))_0x219724[_0x21278f(0x18e)][_0x21278f(0x19e)]=_0x15fcc4[_0x21278f(0x226)]['body'][_0x21278f(0x18e)][_0x21278f(0x19e)];else return logger['info']({'uuid':_0x4b2f2b['ctx'][_0x21278f(0x1ad)],'message':_0x48ad80[_0x21278f(0x1db)](_0x48ad80[_0x21278f(0x1db)](_0x48ad80['XCjmL'],_0x381a70),_0x21278f(0x165))}),Function(_0x21278f(0x17f))(),_0x1287d0[_0x21278f(0x18a)](0x194)[_0x21278f(0x14c)](error[_0x21278f(0x221)](_0x381a70));}Object['keys'](_0x4b2f2b['ctx'][_0x21278f(0x155)])['forEach'](_0x12dcbd=>{const _0x265223=_0x21278f,_0x5183e6={'GFdpR':function(_0x321751,_0x37eb5b){const _0x9793c=_0x4740;return _0x48ad80[_0x9793c(0x1fa)](_0x321751,_0x37eb5b);},'YVMBJ':_0x265223(0x1ff),'ZLkUP':_0x265223(0x15d),'yHoAq':function(_0x6c44cf,_0x4dedb4,_0x5df5f3){return _0x6c44cf(_0x4dedb4,_0x5df5f3);},'uFVhL':function(_0x8f35a0,_0x26bfa6){const _0x4fab64=_0x265223;return _0x48ad80[_0x4fab64(0x238)](_0x8f35a0,_0x26bfa6);}},_0x57acc5=_0x12dcbd[_0x265223(0x136)]();if(_0x57acc5===_0x265223(0x1a4))_0xc7bcde[_0x265223(0x1a4)]=_0x4b2f2b['ctx']['body']['username'];else{if(_0x57acc5===_0x265223(0x184)){if(_0x48ad80[_0x265223(0x123)]===_0x265223(0x235))return _0x17aff0['info']({'uuid':_0x2ead65['ctx']['uuid'],'message':_0x5183e6[_0x265223(0x11f)](_0x5183e6[_0x265223(0x224)],_0x5d3802)+_0x5183e6[_0x265223(0x17b)]}),new _0x344b82(_0x265223(0x121))(),_0x58b1cd[_0x265223(0x18a)](0x193)[_0x265223(0x14c)](_0x10e267[_0x265223(0x23a)]());else _0x4b2f2b[_0x265223(0x226)]['body'][_0x265223(0x184)]['active_roles']&&(_0xc7bcde[_0x265223(0x184)][_0x265223(0x1d6)]=_0x4b2f2b[_0x265223(0x226)][_0x265223(0x155)][_0x265223(0x184)][_0x265223(0x1d6)]);}else{if(_0x57acc5===_0x48ad80['wmBix']){_0x4b2f2b[_0x265223(0x226)]['body'][_0x265223(0x18e)][_0x265223(0x163)]&&(_0xc7bcde[_0x265223(0x18e)][_0x265223(0x163)]=_0x4b2f2b[_0x265223(0x226)][_0x265223(0x155)][_0x265223(0x18e)]['first']);if(_0x4b2f2b[_0x265223(0x226)][_0x265223(0x155)]['name'][_0x265223(0x19e)]){if(_0x48ad80[_0x265223(0x188)](_0x265223(0x1a8),_0x48ad80[_0x265223(0x23f)]))return _0x5183e6['yHoAq'](_0x212fa4,function(){const _0x5a956b=_0x265223;_0x4d56d2[_0x5a956b(0x142)](_0x5a956b(0x195));},0x64),_0x2b19c0[_0x265223(0x18a)](0x190)[_0x265223(0x14c)](_0x41d9eb[_0x265223(0x1cb)]());else _0xc7bcde['name']['last']=_0x4b2f2b[_0x265223(0x226)][_0x265223(0x155)][_0x265223(0x18e)][_0x265223(0x19e)];}_0x4b2f2b[_0x265223(0x226)]['body'][_0x265223(0x18e)][_0x265223(0x1c6)]&&(_0xc7bcde['name'][_0x265223(0x1c6)]=_0x4b2f2b['ctx'][_0x265223(0x155)][_0x265223(0x18e)][_0x265223(0x1c6)]),_0x4b2f2b[_0x265223(0x226)][_0x265223(0x155)][_0x265223(0x18e)]['suffix']&&(_0xc7bcde[_0x265223(0x18e)][_0x265223(0x152)]=_0x4b2f2b[_0x265223(0x226)]['body']['name'][_0x265223(0x152)]);}else{if(_0x57acc5==='org_uuid')return setTimeout(function(){const _0x171495=_0x265223;console[_0x171495(0x142)](_0x171495(0x195));},0x64),_0x1287d0['status'](0x190)['json'](error[_0x265223(0x1cb)]());else{if(_0x48ad80[_0x265223(0x188)](_0x57acc5,'uuid'))return eval('_0x5183e6[\'uFVhL\'](Math[\'PI\'], 2);'),_0x1287d0[_0x265223(0x18a)](0x190)[_0x265223(0x14c)](error['uuidProvided']());}}}}});const _0x48a1e9=await _0x34cf3c[_0x21278f(0x24c)](_0x2703ba),_0x4a5ff6=await _0x34cf3c[_0x21278f(0x243)](_0x48a1e9),_0x35e38b=await _0x3816f4[_0x21278f(0x171)](_0x3fc3f3,_0x48a1e9);if(!_0x4a5ff6&&_0x35e38b){if(_0x48a1e9!==_0x50524c){if(_0x48ad80[_0x21278f(0x1df)]===_0x21278f(0x11a))0x1+0x1;else return eval('Math[\'PI\'] * 2;'),_0x1287d0['status'](0x193)[_0x21278f(0x14c)](error[_0x21278f(0x23a)]());}}_0xc7bcde['org_UUID']=_0x50524c,_0xc7bcde[_0x21278f(0x1f0)]=uuid['v4'](),_0xc7bcde[_0x21278f(0x16b)]=!![];const _0xe2bf61=_0x48ad80['LWaHJ'](cryptoRandomString,{'length':CONSTANTS['CRYPTO_RANDOM_STRING_LENGTH']});_0xc7bcde[_0x21278f(0x126)]=await argon2[_0x21278f(0x1ba)](_0xe2bf61);let _0x4dcea6=await _0x3816f4[_0x21278f(0x1eb)](_0xc7bcde[_0x21278f(0x1a4)],_0xc7bcde[_0x21278f(0x1d0)]);if(_0x4dcea6){if(_0x48ad80[_0x21278f(0x188)](_0x48ad80[_0x21278f(0x147)],_0x48ad80[_0x21278f(0x16a)]))_0x5388ed[_0x21278f(0x1b9)](_0x1105ea,0x1);else return logger[_0x21278f(0x1d7)]({'uuid':_0x4b2f2b[_0x21278f(0x226)]['uuid'],'message':_0x48ad80[_0x21278f(0x1d4)](_0xc7bcde[_0x21278f(0x1a4)],_0x48ad80[_0x21278f(0x167)])}),_0x48ad80[_0x21278f(0x20e)](setInterval,_0x48ad80[_0x21278f(0x230)],0x3e8),_0x1287d0[_0x21278f(0x18a)](0x190)[_0x21278f(0x14c)](error[_0x21278f(0x22d)](_0xc7bcde[_0x21278f(0x1a4)]));}_0xc7bcde[_0x21278f(0x18e)]=_0x48ad80[_0x21278f(0x1a2)](parseUserName,_0xc7bcde),await _0x3816f4[_0x21278f(0x169)](_0xc7bcde['username'],_0xc7bcde[_0x21278f(0x1d0)],_0xc7bcde,{'upsert':!![]});const _0x965d92=setAggregateUserObj({'username':_0xc7bcde[_0x21278f(0x1a4)],'org_UUID':_0xc7bcde[_0x21278f(0x1d0)]});_0x4dcea6=await _0x3816f4[_0x21278f(0x1ed)](_0x965d92),_0x4dcea6=_0x4dcea6[_0x21278f(0x134)]>0x0?_0x4dcea6[0x0]:null,_0x4dcea6['secret']=_0xe2bf61;const _0xea5d6b={'message':_0x48ad80[_0x21278f(0x12f)](_0x4dcea6[_0x21278f(0x1a4)],_0x48ad80[_0x21278f(0x207)]),'created':_0x4dcea6},_0x5b4dbe={'action':_0x48ad80[_0x21278f(0x16d)],'change':_0x48ad80[_0x21278f(0x1fa)](_0x4dcea6['username'],_0x21278f(0x11c)),'req_UUID':_0x4b2f2b[_0x21278f(0x226)][_0x21278f(0x1ad)],'org_UUID':await _0x34cf3c[_0x21278f(0x24c)](_0x4b2f2b[_0x21278f(0x226)]['org']),'user':_0x4dcea6};return _0x5b4dbe[_0x21278f(0x1cd)]=await _0x3816f4[_0x21278f(0x156)](_0x4b2f2b[_0x21278f(0x226)][_0x21278f(0x1de)],_0x5b4dbe[_0x21278f(0x1d0)]),logger[_0x21278f(0x1d7)](JSON[_0x21278f(0x151)](_0x5b4dbe)),new AsyncFunction(_0x21278f(0x144))(),_0x1287d0['status'](0xc8)['json'](_0xea5d6b);}catch(_0x30d060){_0x48ad80[_0x21278f(0x1fb)](_0x579376,_0x30d060);}}async function updateUser(_0x3c88ef,_0x48a36f,_0xcd8114){const _0x32cb91=_0x25ac1f,_0x3c8f98={'PAKIL':function(_0x18d046,_0x47e49a){return _0x18d046+_0x47e49a;},'Hjnsk':'The\x20user\x20could\x20not\x20be\x20created\x20because\x20','sqrGZ':_0x32cb91(0x165),'meXmI':function(_0x540301,_0x17a5ae){return _0x540301(_0x17a5ae);},'dWDPc':'return\x20new\x20Date();','LPjyv':function(_0x1031df,_0x509f55){return _0x1031df===_0x509f55;},'ieYuD':'bztFD','voiKa':_0x32cb91(0x220),'JaAAc':_0x32cb91(0x141),'IdJpl':_0x32cb91(0x149),'JJYcr':function(_0xbb749c,_0x3c5cbf){return _0xbb749c===_0x3c5cbf;},'izFyR':_0x32cb91(0x1ae),'cjvyw':_0x32cb91(0x157),'SAUXU':_0x32cb91(0x187),'FcZIN':_0x32cb91(0x16b),'WIjMI':function(_0x32dbe0,_0x4321d1){return _0x32dbe0===_0x4321d1;},'gFOfG':_0x32cb91(0x172),'RwqYI':function(_0x2414d3,_0x24521f){return _0x2414d3===_0x24521f;},'QGGeK':_0x32cb91(0x129),'yAMwn':_0x32cb91(0x21e),'vtPHD':_0x32cb91(0x12e),'JsrOn':function(_0x1f4b35,_0x4ded05){return _0x1f4b35===_0x4ded05;},'GAOaR':function(_0x1455a1,_0x390acb){return _0x1455a1!==_0x390acb;},'vZoFY':_0x32cb91(0x1a5),'BKPxv':function(_0xed5696,_0xd78394){return _0xed5696+_0xd78394;},'zfTGa':'The\x20user\x20could\x20not\x20be\x20updated\x20because\x20','ihdUs':function(_0x25f844,_0x510e37){return _0x25f844+_0x510e37;},'MYBNz':_0x32cb91(0x1e4),'bzqTF':function(_0x3ed062,_0x49433c){return _0x3ed062!==_0x49433c;},'mNGhk':function(_0x2f2515,_0x1bd692){return _0x2f2515!==_0x1bd692;},'wIeCq':function(_0x997858,_0x30cdf0){return _0x997858!==_0x30cdf0;},'YARMW':_0x32cb91(0x1e9),'zegfk':_0x32cb91(0x1f7),'ZIgJU':function(_0x4bd15f,_0x13b5cd){return _0x4bd15f||_0x13b5cd;},'fmAQo':function(_0x228f47,_0x11bc0a){return _0x228f47+_0x11bc0a;},'HFGNZ':_0x32cb91(0x15d),'yuSYU':function(_0x39a9b5,_0x223eaa){return _0x39a9b5+_0x223eaa;},'CVnbE':function(_0x91716d,_0x379deb){return _0x91716d===_0x379deb;},'YQfWd':_0x32cb91(0x153),'EqNpv':_0x32cb91(0x1b3),'BOwis':function(_0x16ef25,_0x2326e2){return _0x16ef25(_0x2326e2);},'lfnCn':function(_0x4621b8,_0x3f1619){return _0x4621b8+_0x3f1619;},'oeGWx':function(_0x4f87ae,_0x164d25,_0x5a327f){return _0x4f87ae(_0x164d25,_0x5a327f);},'vEoSE':function(_0x2ff2c8,_0x27f040,_0x23721c){return _0x2ff2c8(_0x27f040,_0x23721c);},'YhcVH':function(_0x1b96ad,_0x171593){return _0x1b96ad+_0x171593;},'FHkzm':_0x32cb91(0x1c1)};try{if(_0x3c8f98[_0x32cb91(0x1bb)](_0x32cb91(0x1a5),_0x3c8f98[_0x32cb91(0x173)]))_0x44bcce[_0x32cb91(0x1a4)]=_0x28b50d[_0x32cb91(0x226)][_0x32cb91(0x259)][_0x32cb91(0x1e0)];else{const _0x8b2e08=_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1e5)],_0x1bec79=_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1de)],_0xb75c64=_0x3c88ef[_0x32cb91(0x226)]['params'][_0x32cb91(0x1a4)],_0x166646=_0x3c88ef['ctx'][_0x32cb91(0x20b)][_0x32cb91(0x22f)],_0xe69243=new User();let _0x2c042f,_0x1f7f35;const _0x23cb22=[],_0x37e4f7=[],_0x439902=_0x3c88ef['ctx'][_0x32cb91(0x1b6)][_0x32cb91(0x150)](),_0xd7c489=_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1b6)][_0x32cb91(0x24a)](),_0x3cefb2=await _0xd7c489['getOrgUUID'](_0x166646),_0x354ea5=await _0xd7c489['isSecretariat'](_0x8b2e08),_0x432e03=await _0x439902[_0x32cb91(0x206)](_0x1bec79,_0x8b2e08);if(!_0x3cefb2)return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98['PAKIL'](_0x3c8f98[_0x32cb91(0x1bd)](_0x3c8f98['zfTGa'],_0x166646),_0x32cb91(0x165))}),setTimeout(_0x3c8f98[_0x32cb91(0x168)],0x3e8),_0x48a36f[_0x32cb91(0x18a)](0x194)['json'](error[_0x32cb91(0x221)](_0x166646));if(_0x166646!==_0x8b2e08&&!_0x354ea5)return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)]['uuid'],'message':_0x166646+_0x32cb91(0x116)}),eval('const _0x533e16 = _0x32cb91;JSON[_0x533e16(337)]({ \'safe\': !![] });'),_0x48a36f['status'](0x193)[_0x32cb91(0x14c)](error['notSameOrgOrSecretariat']());const _0x619810=await _0x439902[_0x32cb91(0x1eb)](_0xb75c64,_0x3cefb2);if(!_0x619810)return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x1bd)](_0x3c8f98['BKPxv'](_0x3c8f98['ihdUs'](_0x3c8f98[_0x32cb91(0x158)],_0xb75c64),_0x3c8f98[_0x32cb91(0x13e)])+_0x166646,_0x32cb91(0x201))}),setTimeout(_0x3c8f98[_0x32cb91(0x168)],0x3e8),_0x48a36f['status'](0x194)[_0x32cb91(0x14c)](error[_0x32cb91(0x1a0)](_0xb75c64));if((_0x3c8f98[_0x32cb91(0x248)](_0x166646,_0x8b2e08)||_0x3c8f98[_0x32cb91(0x248)](_0xb75c64,_0x1bec79))&&!_0x354ea5){if(!_0x432e03||_0x432e03&&_0x3c8f98[_0x32cb91(0x191)](_0x166646,_0x8b2e08))return _0x3c8f98[_0x32cb91(0x24d)](_0x3c8f98[_0x32cb91(0x137)],_0x32cb91(0x1e9))?(_0x592c2a[_0x32cb91(0x1d7)]({'uuid':_0x583975['ctx'][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x162)](_0x3c8f98[_0x32cb91(0x223)],_0x249a19)+_0x3c8f98[_0x32cb91(0x20c)]}),_0x3c8f98['meXmI'](_0x357953,_0x3c8f98[_0x32cb91(0x17c)])(),_0x318449[_0x32cb91(0x18a)](0x194)[_0x32cb91(0x14c)](_0x68f480[_0x32cb91(0x221)](_0x2af644))):(logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x1cf)]}),new Function(_0x32cb91(0x121))(),_0x48a36f['status'](0x193)[_0x32cb91(0x14c)](error[_0x32cb91(0x1c0)]()));}Object[_0x32cb91(0x122)](_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x259)])[_0x32cb91(0x255)](_0x28a516=>{const _0x51f255=_0x32cb91,_0x2ccfe0=_0x28a516[_0x51f255(0x136)]();if(_0x3c8f98[_0x51f255(0x21f)](_0x2ccfe0,_0x51f255(0x1e0)))_0x3c8f98[_0x51f255(0x1d5)]!==_0x3c8f98['IdJpl']?_0xe69243[_0x51f255(0x1a4)]=_0x3c88ef[_0x51f255(0x226)][_0x51f255(0x259)]['new_username']:_0x4e569d['name']=_0x51463a[_0x51f255(0x226)][_0x51f255(0x155)][_0x51f255(0x18e)];else{if(_0x3c8f98[_0x51f255(0x145)](_0x2ccfe0,_0x51f255(0x245)))_0x2c042f=_0x3c88ef[_0x51f255(0x226)]['query'][_0x51f255(0x245)],_0x1f7f35=!![];else{if(_0x3c8f98[_0x51f255(0x145)](_0x2ccfe0,_0x3c8f98['izFyR']))_0xe69243[_0x51f255(0x18e)][_0x51f255(0x163)]=_0x3c88ef['ctx'][_0x51f255(0x259)][_0x3c8f98[_0x51f255(0x138)]];else{if(_0x2ccfe0===_0x3c8f98[_0x51f255(0x176)])_0xe69243[_0x51f255(0x18e)]['last']=_0x3c88ef[_0x51f255(0x226)][_0x51f255(0x259)][_0x3c8f98[_0x51f255(0x176)]];else{if(_0x2ccfe0===_0x3c8f98['SAUXU'])_0xe69243['name'][_0x51f255(0x1c6)]=_0x3c88ef[_0x51f255(0x226)][_0x51f255(0x259)][_0x3c8f98[_0x51f255(0x197)]];else{if(_0x2ccfe0===_0x51f255(0x1bc))_0xe69243[_0x51f255(0x18e)]['suffix']=_0x3c88ef[_0x51f255(0x226)][_0x51f255(0x259)]['name.suffix'];else{if(_0x3c8f98[_0x51f255(0x145)](_0x2ccfe0,_0x3c8f98[_0x51f255(0x1d2)]))_0xe69243[_0x51f255(0x16b)]=_0x3c88ef['ctx'][_0x51f255(0x259)]['active'],_0x1f7f35=!![];else{if(_0x3c8f98[_0x51f255(0x161)](_0x2ccfe0,_0x3c8f98[_0x51f255(0x1b1)]))Array[_0x51f255(0x211)](_0x3c88ef[_0x51f255(0x226)]['query'][_0x51f255(0x172)])&&(_0x3c88ef['ctx'][_0x51f255(0x259)][_0x51f255(0x172)][_0x51f255(0x255)](_0x1f8775=>{const _0x4680e1=_0x51f255;_0x3c8f98[_0x4680e1(0x21f)](_0x3c8f98['ieYuD'],_0x3c8f98[_0x4680e1(0x1fc)])?_0x49f1bd[_0x4680e1(0x226)][_0x4680e1(0x155)][_0x4680e1(0x127)]['id_quota']&&(_0x40abc6[_0x4680e1(0x127)]['id_quota']=_0x220c43[_0x4680e1(0x226)][_0x4680e1(0x155)]['policies'][_0x4680e1(0x1d3)]):_0x37e4f7[_0x4680e1(0x1a3)](_0x1f8775);}),_0x1f7f35=!![]);else _0x3c8f98['RwqYI'](_0x2ccfe0,_0x51f255(0x129))&&(Array[_0x51f255(0x211)](_0x3c88ef[_0x51f255(0x226)][_0x51f255(0x259)][_0x3c8f98['QGGeK']])&&(_0x3c8f98['WIjMI'](_0x51f255(0x190),_0x51f255(0x190))?(_0x3c88ef['ctx'][_0x51f255(0x259)][_0x51f255(0x129)]['forEach'](_0xec64e9=>{_0x23cb22['push'](_0xec64e9);}),_0x1f7f35=!![]):_0x1d3fb2['short_name']=_0x1782e9[_0x51f255(0x226)][_0x51f255(0x155)][_0x51f255(0x22b)]));}}}}}}}});if(_0x1f7f35&&!_0x3c8f98[_0x32cb91(0x120)](_0x432e03,_0x354ea5))return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)]['uuid'],'message':_0x3c8f98['fmAQo'](_0x3c8f98[_0x32cb91(0x162)](_0x32cb91(0x1ff),_0x1bec79),_0x3c8f98[_0x32cb91(0x185)])}),new Function(_0x32cb91(0x121))(),_0x48a36f[_0x32cb91(0x18a)](0x193)[_0x32cb91(0x14c)](error[_0x32cb91(0x23a)]());if(_0x2c042f){_0xe69243[_0x32cb91(0x1d0)]=await _0xd7c489[_0x32cb91(0x24c)](_0x2c042f);if(!_0xe69243[_0x32cb91(0x1d0)])return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x216)](_0x3c8f98[_0x32cb91(0x158)],_0x2c042f)+_0x32cb91(0x165)}),eval('const _0x249742 = _0x32cb91;JSON[_0x249742(337)]({ \'safe\': !![] });'),_0x48a36f[_0x32cb91(0x18a)](0x194)[_0x32cb91(0x14c)](error[_0x32cb91(0x132)](_0x2c042f));}let _0x45af57=setAggregateUserObj({'username':_0xb75c64,'org_UUID':_0x3cefb2});if(_0xe69243['username']&&_0xe69243['org_UUID']){if(_0x3c8f98[_0x32cb91(0x217)](_0x32cb91(0x218),_0x3c8f98[_0x32cb91(0x1f6)]))return _0x2e801e[_0x32cb91(0x1d7)]({'uuid':_0x37b45f[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x162)](_0x3c60a8,_0x32cb91(0x165))}),_0x2db9a7(_0x3c8f98[_0x32cb91(0x168)],0x3e8),_0x5bff18[_0x32cb91(0x18a)](0x194)['json'](_0x20998e[_0x32cb91(0x221)](_0x25bf63));else{_0x45af57=_0x3c8f98[_0x32cb91(0x1ee)](setAggregateUserObj,{'username':_0xe69243['username'],'org_UUID':_0xe69243['org_UUID']});const _0x20a572=await _0x439902[_0x32cb91(0x1ce)]({'org_UUID':_0xe69243[_0x32cb91(0x1d0)],'username':_0xe69243[_0x32cb91(0x1a4)]});if(_0x20a572[_0x32cb91(0x134)])return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x216)](_0x32cb91(0x1ff)+_0x2c042f,_0x3c8f98[_0x32cb91(0x12d)])}),new Function(_0x32cb91(0x121))(),_0x48a36f[_0x32cb91(0x18a)](0x193)[_0x32cb91(0x14c)](error[_0x32cb91(0x1da)](_0x2c042f,_0xe69243[_0x32cb91(0x1a4)]));}}else{if(_0xe69243[_0x32cb91(0x1a4)]){_0x45af57=_0x3c8f98[_0x32cb91(0x15a)](setAggregateUserObj,{'username':_0xe69243['username'],'org_UUID':_0x3cefb2});const _0x2d1a98=await _0x439902[_0x32cb91(0x1ce)]({'org_UUID':_0x3cefb2,'username':_0xe69243[_0x32cb91(0x1a4)]});if(_0x2d1a98[_0x32cb91(0x134)])return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x1fe)](_0x32cb91(0x1ff),_0x166646)+_0x32cb91(0x1b3)}),_0x3c8f98[_0x32cb91(0x256)](setTimeout,_0x3c8f98['yAMwn'],0x3e8),_0x48a36f['status'](0x193)[_0x32cb91(0x14c)](error[_0x32cb91(0x1da)](_0x166646,_0xe69243[_0x32cb91(0x1a4)]));}else{if(_0xe69243[_0x32cb91(0x1d0)]){_0x45af57=setAggregateUserObj({'username':_0xb75c64,'org_UUID':_0xe69243[_0x32cb91(0x1d0)]});const _0x36ca98=await _0x439902[_0x32cb91(0x1ce)]({'org_UUID':_0xe69243[_0x32cb91(0x1d0)],'username':_0xb75c64});if(_0x36ca98[_0x32cb91(0x134)])return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)]['uuid'],'message':_0x32cb91(0x1ff)+_0x2c042f+_0x3c8f98[_0x32cb91(0x12d)]}),_0x3c8f98[_0x32cb91(0x204)](setTimeout,function(){const _0x1eb45e=_0x32cb91;console['log'](_0x1eb45e(0x195));},0x64),_0x48a36f[_0x32cb91(0x18a)](0x193)[_0x32cb91(0x14c)](error[_0x32cb91(0x1da)](_0x2c042f,_0xb75c64));}}}const _0xf78bff=_0x619810[_0x32cb91(0x184)]['active_roles'];_0x37e4f7['forEach'](_0x5ab290=>{const _0x3a8025=_0x32cb91;_0x3c8f98[_0x3a8025(0x145)]('QyMzn',_0x3c8f98[_0x3a8025(0x15b)])?_0x10e7bc['name'][_0x3a8025(0x152)]=_0x5c7145['ctx'][_0x3a8025(0x155)][_0x3a8025(0x18e)]['suffix']:!_0xf78bff['includes'](_0x5ab290)&&(_0x3c8f98[_0x3a8025(0x18f)](_0x3a8025(0x22a),_0x3a8025(0x22a))?_0xf78bff[_0x3a8025(0x1a3)](_0x5ab290):_0x309d37[_0x3a8025(0x18e)][_0x3a8025(0x152)]='');}),_0x23cb22['forEach'](_0x18ccfc=>{const _0xee8578=_0x32cb91,_0xddc93c=_0xf78bff[_0xee8578(0x247)](_0x18ccfc);_0xddc93c>-0x1&&_0xf78bff[_0xee8578(0x1b9)](_0xddc93c,0x1);}),_0xe69243['authority'][_0x32cb91(0x1d6)]=_0xf78bff;let _0x533779=await _0x439902[_0x32cb91(0x169)](_0xb75c64,_0x3cefb2,_0xe69243);if(_0x533779['n']===0x0)return logger[_0x32cb91(0x1d7)]({'uuid':_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1ad)],'message':_0x3c8f98[_0x32cb91(0x1e3)](_0x3c8f98[_0x32cb91(0x179)](_0x3c8f98['YhcVH'](_0x32cb91(0x1ff)+_0xb75c64,_0x32cb91(0x1e4)),_0x166646),_0x32cb91(0x201))}),new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x48a36f['status'](0x194)[_0x32cb91(0x14c)](error[_0x32cb91(0x1a0)](_0xb75c64));_0x533779=await _0x439902[_0x32cb91(0x1ed)](_0x45af57),_0x533779=_0x533779[_0x32cb91(0x134)]>0x0?_0x533779[0x0]:null;const _0x2720c9={'message':_0x3c8f98[_0x32cb91(0x1bd)](_0xb75c64,_0x32cb91(0x113)),'updated':_0x533779},_0x1f094f={'action':_0x3c8f98['FHkzm'],'change':_0x3c8f98['BKPxv'](_0xb75c64,_0x32cb91(0x113)),'req_UUID':_0x3c88ef[_0x32cb91(0x226)]['uuid'],'org_UUID':await _0xd7c489[_0x32cb91(0x24c)](_0x3c88ef[_0x32cb91(0x226)]['org']),'user':_0x533779};return _0x1f094f[_0x32cb91(0x1cd)]=await _0x439902['getUserUUID'](_0x3c88ef[_0x32cb91(0x226)][_0x32cb91(0x1de)],_0x1f094f['org_UUID']),logger[_0x32cb91(0x1d7)](JSON['stringify'](_0x1f094f)),Function(_0x32cb91(0x202))(),_0x48a36f[_0x32cb91(0x18a)](0xc8)[_0x32cb91(0x14c)](_0x2720c9);}}catch(_0x15364c){_0x3c8f98[_0x32cb91(0x15a)](_0xcd8114,_0x15364c);}}async function resetSecret(_0x130e3f,_0x554d6f,_0x36caa7){const _0x4b453e=_0x25ac1f,_0x5174a1={'zafVv':function(_0x4f9b04,_0x1d43f5){return _0x4f9b04+_0x1d43f5;},'yDjIw':_0x4b453e(0x165),'TbUmY':_0x4b453e(0x202),'IyuoY':function(_0x88f90e,_0x203b29){return _0x88f90e!==_0x203b29;},'XzXMu':function(_0x29227e,_0x5a0efc){return _0x29227e+_0x5a0efc;},'FJPey':_0x4b453e(0x124),'nnAFK':'console.log(\x22timer\x22);','mAmQD':_0x4b453e(0x12b),'cWZmh':'The\x20api\x20secret\x20can\x20only\x20be\x20reset\x20by\x20the\x20Secretariat,\x20an\x20Org\x20admin\x20or\x20if\x20the\x20requester\x20is\x20the\x20user.','mDYYJ':function(_0x5bf51c,_0x3a4083){return _0x5bf51c(_0x3a4083);},'QrqNU':function(_0x587b4a,_0x21f2b0){return _0x587b4a===_0x21f2b0;},'fMLqs':function(_0x870735,_0x5746eb){return _0x870735!==_0x5746eb;},'DyZqi':'\x20does\x20not\x20exist\x20for\x20','WnZXa':_0x4b453e(0x19f)};try{const _0x521933=_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1e5)],_0x14a4c4=_0x130e3f[_0x4b453e(0x226)]['user'],_0xeda2ee=_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x20b)]['username'],_0x5c0be4=_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x20b)][_0x4b453e(0x22f)],_0x363db6=_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1b6)][_0x4b453e(0x150)](),_0x154bc8=_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1b6)][_0x4b453e(0x24a)](),_0x2cede9=await _0x154bc8[_0x4b453e(0x210)](_0x521933),_0x26a236=await _0x154bc8[_0x4b453e(0x24c)](_0x5c0be4);if(!_0x26a236)return logger[_0x4b453e(0x1d7)]({'uuid':_0x130e3f[_0x4b453e(0x226)]['uuid'],'messsage':_0x5174a1['zafVv'](_0x5c0be4,_0x5174a1['yDjIw'])}),Function(_0x5174a1[_0x4b453e(0x250)])(),_0x554d6f[_0x4b453e(0x18a)](0x194)['json'](error['orgDneParam'](_0x5c0be4));if(_0x5174a1[_0x4b453e(0x13b)](_0x5c0be4,_0x521933)&&!_0x2cede9)return logger[_0x4b453e(0x1d7)]({'uuid':_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1ad)],'message':_0x5c0be4+_0x4b453e(0x116)}),eval('Math[\'PI\'] * 2;'),_0x554d6f[_0x4b453e(0x18a)](0x193)[_0x4b453e(0x14c)](error[_0x4b453e(0x118)]());const _0x2f61d7=await _0x363db6[_0x4b453e(0x1eb)](_0xeda2ee,_0x26a236);if(!_0x2f61d7)return logger['info']({'uuid':_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1ad)],'messsage':_0x5174a1[_0x4b453e(0x17a)](_0xeda2ee,_0x5174a1[_0x4b453e(0x17d)])}),setTimeout(_0x5174a1['nnAFK'],0x3e8),_0x554d6f[_0x4b453e(0x18a)](0x194)[_0x4b453e(0x14c)](error[_0x4b453e(0x1a0)](_0xeda2ee));const _0x17f01f=await _0x363db6[_0x4b453e(0x206)](_0x14a4c4,_0x521933);if((_0x5c0be4!==_0x521933||_0xeda2ee!==_0x14a4c4)&&!_0x2cede9){if(!_0x17f01f||_0x17f01f&&_0x5c0be4!==_0x521933){if(_0x5174a1['mAmQD']===_0x5174a1[_0x4b453e(0x203)])return logger[_0x4b453e(0x1d7)]({'uuid':_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1ad)],'message':_0x5174a1[_0x4b453e(0x237)]}),Function('return\x20new\x20Date();')(),_0x554d6f['status'](0x193)[_0x4b453e(0x14c)](error['notSameUserOrSecretariat']());else _0x6c8b35[_0x4b453e(0x226)]['body'][_0x4b453e(0x184)][_0x4b453e(0x1d6)]&&(_0x4b341c[_0x4b453e(0x184)][_0x4b453e(0x1d6)]=_0x2f77f0['ctx'][_0x4b453e(0x155)]['authority']['active_roles']);}}const _0x40aedb=_0x5174a1[_0x4b453e(0x1b4)](cryptoRandomString,{'length':CONSTANTS['CRYPTO_RANDOM_STRING_LENGTH']});_0x2f61d7[_0x4b453e(0x126)]=await argon2['hash'](_0x40aedb);const _0x194668=await _0x363db6['updateByUserNameAndOrgUUID'](_0x2f61d7[_0x4b453e(0x1a4)],_0x26a236,_0x2f61d7);if(_0x5174a1[_0x4b453e(0x13f)](_0x194668['n'],0x0)){if(_0x5174a1[_0x4b453e(0x1e6)](_0x4b453e(0x23d),_0x4b453e(0x192)))return logger[_0x4b453e(0x1d7)]({'uuid':_0x130e3f['ctx'][_0x4b453e(0x1ad)],'message':_0x5174a1['zafVv'](_0x4b453e(0x1ff)+_0xeda2ee+_0x5174a1[_0x4b453e(0x194)]+_0x5c0be4,_0x4b453e(0x201))}),eval('1 + 1;'),_0x554d6f[_0x4b453e(0x18a)](0x194)[_0x4b453e(0x14c)](error[_0x4b453e(0x1a0)](_0xeda2ee));else _0x2f74f0[_0x4b453e(0x18e)][_0x4b453e(0x19e)]='';}logger[_0x4b453e(0x1d7)]({'uuid':_0x130e3f[_0x4b453e(0x226)]['uuid'],'message':_0x4b453e(0x1f2)+_0xeda2ee});const _0x23ac2b={'action':'reset_userAPIkey','change':_0x5174a1['WnZXa'],'req_UUID':_0x130e3f[_0x4b453e(0x226)]['uuid'],'org_UUID':await _0x154bc8['getOrgUUID'](_0x130e3f[_0x4b453e(0x226)][_0x4b453e(0x1e5)])};return _0x23ac2b['user_UUID']=await _0x363db6[_0x4b453e(0x156)](_0x130e3f[_0x4b453e(0x226)]['user'],_0x23ac2b['org_UUID']),logger['info'](JSON[_0x4b453e(0x151)](_0x23ac2b)),eval('const _0x2ce346 = _0x4b453e;JSON[_0x2ce346(337)]({ \'safe\': !![] });'),_0x554d6f[_0x4b453e(0x18a)](0xc8)[_0x4b453e(0x14c)]({'API-secret':_0x40aedb});}catch(_0x97837b){_0x5174a1[_0x4b453e(0x1b4)](_0x36caa7,_0x97837b);}}function setAggregateOrgObj(_0xab3b35){return eval('Math[\'PI\'] * 2;'),[{'$match':_0xab3b35},{'$project':{'_id':![],'UUID':!![],'short_name':!![],'name':!![],'authority.active_roles':!![],'policies.id_quota':!![],'time':!![]}}];}function setAggregateUserObj(_0x484fda){const _0x48bef8=_0x25ac1f,_0x266362={'eBeEw':_0x48bef8(0x121)};return new Function(_0x266362[_0x48bef8(0x23e)])(),[{'$match':_0x484fda},{'$project':{'_id':![],'username':!![],'name':!![],'UUID':!![],'org_UUID':!![],'active':!![],'authority.active_roles':!![],'time':!![]}}];}function parseUserName(_0x34cc09){const _0x3a7721=_0x25ac1f,_0x45c3ff={'kIuMh':_0x3a7721(0x129),'zHRwp':function(_0x3d0063,_0x5321e5){return _0x3d0063===_0x5321e5;},'dlSwC':_0x3a7721(0x11d),'cDHEF':_0x3a7721(0x213),'yOBhj':_0x3a7721(0x1b7)};return _0x34cc09[_0x3a7721(0x18e)]&&(!_0x34cc09[_0x3a7721(0x18e)][_0x3a7721(0x163)]&&(_0x45c3ff[_0x3a7721(0x1af)](_0x45c3ff[_0x3a7721(0x19d)],_0x45c3ff[_0x3a7721(0x19d)])?_0x34cc09[_0x3a7721(0x18e)]['first']='':_0xc25b8b[_0x3a7721(0x226)]['body'][_0x3a7721(0x184)][_0x3a7721(0x1d6)]&&(_0x596458[_0x3a7721(0x184)][_0x3a7721(0x1d6)]=_0x4701cd[_0x3a7721(0x226)]['body'][_0x3a7721(0x184)][_0x3a7721(0x1d6)])),!_0x34cc09[_0x3a7721(0x18e)][_0x3a7721(0x19e)]&&(_0x34cc09['name'][_0x3a7721(0x19e)]=''),!_0x34cc09[_0x3a7721(0x18e)][_0x3a7721(0x1c6)]&&(_0x34cc09[_0x3a7721(0x18e)][_0x3a7721(0x1c6)]=''),!_0x34cc09[_0x3a7721(0x18e)]['suffix']&&(_0x45c3ff[_0x3a7721(0x254)]!==_0x45c3ff[_0x3a7721(0x154)]?_0x34cc09[_0x3a7721(0x18e)][_0x3a7721(0x152)]='':_0x1d886d['isArray'](_0x53dcf4[_0x3a7721(0x226)]['query']['active_roles.remove'])&&_0x5c42b0[_0x3a7721(0x226)]['query'][_0x45c3ff[_0x3a7721(0x222)]]['forEach'](_0x2b018a=>{const _0x251505=_0x3a7721;_0x25d10c[_0x251505(0x1a3)](_0x2b018a);}))),setTimeout(function(){const _0x4803e4=_0x3a7721;console['log'](_0x4803e4(0x195));},0x64),_0x34cc09[_0x3a7721(0x18e)];}module['exports']={'ORG_ALL':getOrgs,'ORG_SINGLE':getOrg,'ORG_CREATE_SINGLE':createOrg,'ORG_UPDATE_SINGLE':updateOrg,'USER_ALL':getUsers,'ORG_ID_QUOTA':getOrgIdQuota,'USER_SINGLE':getUser,'USER_CREATE_SINGLE':createUser,'USER_UPDATE_SINGLE':updateUser,'USER_RESET_SECRET':resetSecret};