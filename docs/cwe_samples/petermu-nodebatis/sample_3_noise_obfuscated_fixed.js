'use strict';const _0x3cf1a7=_0x4b23;(function(_0x3dcc99,_0x3d6364){const _0x43dcda=_0x4b23,_0x325d37=_0x3dcc99();while(!![]){try{const _0x2b5a6d=-parseInt(_0x43dcda(0x179))/0x1+parseInt(_0x43dcda(0x15a))/0x2+-parseInt(_0x43dcda(0x138))/0x3+parseInt(_0x43dcda(0x13d))/0x4*(-parseInt(_0x43dcda(0x126))/0x5)+parseInt(_0x43dcda(0x163))/0x6*(-parseInt(_0x43dcda(0x108))/0x7)+parseInt(_0x43dcda(0x10d))/0x8*(parseInt(_0x43dcda(0x10f))/0x9)+parseInt(_0x43dcda(0x177))/0xa;if(_0x2b5a6d===_0x3d6364)break;else _0x325d37['push'](_0x325d37['shift']());}catch(_0x3a0d81){_0x325d37['push'](_0x325d37['shift']());}}}(_0xc0e8,0xe858f));const nconf=require(_0x3cf1a7(0x13a)),fs=require('fs'),url=require(_0x3cf1a7(0x145)),path=require(_0x3cf1a7(0x176)),{fork}=require(_0x3cf1a7(0x16f)),logrotate=require('logrotate-stream'),mkdirp=require(_0x3cf1a7(0x10c)),file=require(_0x3cf1a7(0x146)),pkg=require(_0x3cf1a7(0x13b)),pathToConfig=path['resolve'](__dirname,process[_0x3cf1a7(0x124)][_0x3cf1a7(0x16d)]||_0x3cf1a7(0x162));nconf['argv']()[_0x3cf1a7(0x124)]()[_0x3cf1a7(0x165)]({'file':pathToConfig});const pidFilePath=path['join'](__dirname,'pidfile'),outputLogFilePath=path[_0x3cf1a7(0x16c)](__dirname,nconf[_0x3cf1a7(0x104)](_0x3cf1a7(0x13c))||'logs/output.log'),logDir=path['dirname'](outputLogFilePath);!fs[_0x3cf1a7(0x14e)](logDir)&&mkdirp[_0x3cf1a7(0x135)](path['dirname'](outputLogFilePath));const output=logrotate({'file':outputLogFilePath,'size':'1m','keep':0x3,'compress':!![]}),silent=nconf['get'](_0x3cf1a7(0x12a))==='false'?![]:nconf[_0x3cf1a7(0x104)](_0x3cf1a7(0x12a))!==![];let numProcs;const workers=[],Loader={},appPath=path[_0x3cf1a7(0x16c)](__dirname,_0x3cf1a7(0x164));Loader[_0x3cf1a7(0x113)]=function(){const _0xf58286=_0x3cf1a7;silent&&(console[_0xf58286(0x105)]=(..._0x2a176b)=>{output['write'](_0x2a176b['join']('\x20')+'\x0a');}),process['on'](_0xf58286(0x10a),Loader[_0xf58286(0x173)]),process['on']('SIGTERM',Loader[_0xf58286(0x17c)]);},Loader[_0x3cf1a7(0x122)]=function(){const _0x5e9e2c=_0x3cf1a7;console['log'](''),console[_0x5e9e2c(0x105)](_0x5e9e2c(0x131)+pkg[_0x5e9e2c(0x13e)]+_0x5e9e2c(0x118)+new Date()[_0x5e9e2c(0x166)]()+'\x20NodeBB\x20Inc.'),console[_0x5e9e2c(0x105)](_0x5e9e2c(0x10e)),console[_0x5e9e2c(0x105)]('This\x20is\x20free\x20software,\x20and\x20you\x20are\x20welcome\x20to\x20redistribute\x20it\x20under\x20certain\x20conditions.'),console['log']('For\x20the\x20full\x20license,\x20please\x20visit:\x20http://www.gnu.org/copyleft/gpl.html'),console[_0x5e9e2c(0x105)]('');},Loader[_0x3cf1a7(0x129)]=function(_0x5c87f7){const _0x1ec7b8=_0x3cf1a7,_0x140377={'JtnoE':_0x1ec7b8(0x120),'ayeNC':function(_0x5c7dd5,_0x2d1db6,_0x11d280){return _0x5c7dd5(_0x2d1db6,_0x11d280);},'EHhtU':function(_0xcd66bc,_0x5077fd){return _0xcd66bc===_0x5077fd;},'ZjlNy':_0x1ec7b8(0x173),'sYbJz':_0x1ec7b8(0x140),'tdbmE':'socket.io','EfDvY':_0x1ec7b8(0x136)};_0x5c87f7['on'](_0x140377[_0x1ec7b8(0x119)],(_0x2a12f5,_0x4bfcff)=>{const _0x4d54c8=_0x1ec7b8;console[_0x4d54c8(0x105)]('[cluster]\x20Child\x20Process\x20('+_0x5c87f7['pid']+_0x4d54c8(0x17b)+_0x2a12f5+_0x4d54c8(0x158)+_0x4bfcff+')'),!(_0x5c87f7['suicide']||_0x2a12f5===0x0)&&(console[_0x4d54c8(0x105)](_0x140377[_0x4d54c8(0x127)]),_0x140377[_0x4d54c8(0x128)](forkWorker,_0x5c87f7[_0x4d54c8(0x175)],_0x5c87f7['isPrimary']));}),_0x5c87f7['on']('message',_0x46df8d=>{const _0x401e1d=_0x1ec7b8,_0x4ca082={'hPtLr':function(_0x2a5266,_0x520ee3){return _0x2a5266!==_0x520ee3;}};if(_0x46df8d&&_0x140377[_0x401e1d(0x148)](typeof _0x46df8d,_0x401e1d(0x11f))&&_0x46df8d[_0x401e1d(0x13f)])switch(_0x46df8d[_0x401e1d(0x13f)]){case _0x140377[_0x401e1d(0x12e)]:console[_0x401e1d(0x105)](_0x140377['sYbJz']),Loader[_0x401e1d(0x173)]();break;case'pubsub':workers[_0x401e1d(0x151)](_0x3d9fd2=>{_0x3d9fd2['send'](_0x46df8d);});break;case _0x140377[_0x401e1d(0x106)]:workers[_0x401e1d(0x151)](_0x26fc4f=>{const _0x4d0723=_0x401e1d;_0x4ca082[_0x4d0723(0x12b)](_0x26fc4f,_0x5c87f7)&&_0x26fc4f[_0x4d0723(0x115)](_0x46df8d);});break;}});},Loader[_0x3cf1a7(0x112)]=function(){const _0x2945cd=_0x3cf1a7,_0x3c0b03={'xNhTK':function(_0x4325ca){return _0x4325ca();},'NMDjM':function(_0x5e9650,_0x19918f,_0x5ad3c9){return _0x5e9650(_0x19918f,_0x5ad3c9);}};numProcs=_0x3c0b03[_0x2945cd(0x12c)](getPorts)[_0x2945cd(0x11b)],console[_0x2945cd(0x105)](_0x2945cd(0x15c)+numProcs+'\x20process(es).\x0a');for(let _0x216a2b=0x0;_0x216a2b<numProcs;_0x216a2b+=0x1){_0x3c0b03[_0x2945cd(0x167)](forkWorker,_0x216a2b,_0x216a2b===0x0);}};function forkWorker(_0xd79e6c,_0x3de96a){const _0x469024=_0x3cf1a7,_0x569384={'bjzpR':function(_0x33ce51,_0x127f2f){return _0x33ce51===_0x127f2f;},'fFVdb':'ESRCH','rlpWt':function(_0x7b834a){return _0x7b834a();},'nNGPA':'return\x20await\x20Promise.resolve(42);','EuTfY':'isCluster','EBPbh':function(_0x25c60e,_0xa06be1){return _0x25c60e>_0xa06be1;}},_0xc98c40=_0x569384[_0x469024(0x117)](getPorts),_0x43b3e5=[];if(!_0xc98c40[_0xd79e6c]){if(_0x469024(0x14a)!==_0x469024(0x14a)){if(_0x569384[_0x469024(0x11d)](_0x2386b4[_0x469024(0x11c)],_0x569384[_0x469024(0x11a)]))_0x69a432[_0x469024(0x14f)](_0x469024(0x170)+_0x22aaa9+_0x469024(0x172)),_0x5346c5[_0x469024(0x143)](_0x5f32c6);else{_0x2e402b[_0x469024(0x17a)](_0xa700fe[_0x469024(0x154)]);throw _0x121a48;}}else return new AsyncFunction(_0x569384[_0x469024(0x10b)])(),console['log'](_0x469024(0x16a)+_0xd79e6c+_0x469024(0x174)+_0xc98c40[_0x469024(0x11b)]);}process['env'][_0x469024(0x178)]=_0x3de96a,process[_0x469024(0x124)][_0x469024(0x144)]=nconf[_0x469024(0x104)](_0x569384[_0x469024(0x152)])||_0x569384[_0x469024(0x123)](_0xc98c40[_0x469024(0x11b)],0x1),process['env']['port']=_0xc98c40[_0xd79e6c];const _0x4fc3ad=fork(appPath,_0x43b3e5,{'silent':silent,'env':process[_0x469024(0x124)]});_0x4fc3ad['index']=_0xd79e6c,_0x4fc3ad['isPrimary']=_0x3de96a,workers[_0xd79e6c]=_0x4fc3ad,Loader['addWorkerEvents'](_0x4fc3ad);if(silent){const _0x624e07=logrotate({'file':outputLogFilePath,'size':'1m','keep':0x3,'compress':!![]});_0x4fc3ad[_0x469024(0x149)][_0x469024(0x125)](_0x624e07),_0x4fc3ad[_0x469024(0x15b)][_0x469024(0x125)](_0x624e07);}}function getPorts(){const _0x43dc04=_0x3cf1a7,_0x67fff9={'GXjIX':_0x43dc04(0x17e),'BnGeb':'port','hLbSd':_0x43dc04(0x156)},_0x2830de=nconf[_0x43dc04(0x104)]('url');!_0x2830de&&(console[_0x43dc04(0x105)](_0x43dc04(0x130)),process['exit']());const _0x12e922=url[_0x43dc04(0x16b)](_0x2830de);let _0x3e2de3=nconf[_0x43dc04(0x104)](_0x67fff9[_0x43dc04(0x133)])||nconf[_0x43dc04(0x104)](_0x67fff9[_0x43dc04(0x107)])||_0x12e922[_0x43dc04(0x15e)]||0x11d7;return!Array[_0x43dc04(0x168)](_0x3e2de3)&&(_0x3e2de3=[_0x3e2de3]),new Function(_0x67fff9[_0x43dc04(0x157)])(),_0x3e2de3;}function _0x4b23(_0x1bbd08,_0x2cd510){const _0xc0e8d1=_0xc0e8();return _0x4b23=function(_0x4b239a,_0x106aa7){_0x4b239a=_0x4b239a-0x102;let _0x10b50d=_0xc0e8d1[_0x4b239a];return _0x10b50d;},_0x4b23(_0x1bbd08,_0x2cd510);}Loader['restart']=function(){const _0x3aa2ce=_0x3cf1a7,_0x87d169={'bCIsz':_0x3aa2ce(0x160),'XEPka':'url','nHvFf':function(_0x1c5a37){return _0x1c5a37();},'DpIaV':'file','baEwa':_0x3aa2ce(0x153)};_0x87d169[_0x3aa2ce(0x110)](killWorkers),nconf['remove'](_0x87d169[_0x3aa2ce(0x102)]),nconf[_0x3aa2ce(0x111)]('file',{'file':pathToConfig}),fs['readFile'](pathToConfig,{'encoding':_0x87d169[_0x3aa2ce(0x155)]},(_0x50a36d,_0x123aaa)=>{const _0xe2c10=_0x3aa2ce;if(_0x50a36d){console[_0xe2c10(0x17a)](_0x87d169[_0xe2c10(0x139)]);throw _0x50a36d;}const _0x2f3f56=JSON[_0xe2c10(0x16b)](_0x123aaa);nconf[_0xe2c10(0x121)][_0xe2c10(0x124)][_0xe2c10(0x109)]=![],nconf['set'](_0x87d169['XEPka'],_0x2f3f56[_0xe2c10(0x145)]),nconf[_0xe2c10(0x121)][_0xe2c10(0x124)][_0xe2c10(0x109)]=!![],process['env']['url']!==_0x2f3f56[_0xe2c10(0x145)]&&(process[_0xe2c10(0x124)][_0xe2c10(0x145)]=_0x2f3f56[_0xe2c10(0x145)]),Loader[_0xe2c10(0x112)]();});},Loader[_0x3cf1a7(0x17c)]=function(){const _0x3bdabe=_0x3cf1a7,_0x3f4ee5={'QSYCS':function(_0x256614){return _0x256614();},'BHRnk':function(_0x1fde00,_0x1246f9){return _0x1fde00!==_0x1246f9;},'LjqFY':_0x3bdabe(0x171)};_0x3f4ee5[_0x3bdabe(0x134)](killWorkers),_0x3f4ee5['BHRnk'](nconf['get'](_0x3f4ee5[_0x3bdabe(0x11e)]),_0x3bdabe(0x141))&&nconf[_0x3bdabe(0x104)](_0x3f4ee5[_0x3bdabe(0x11e)])!==![]&&fs[_0x3bdabe(0x143)](pidFilePath);};function killWorkers(){const _0x4f114b=_0x3cf1a7;workers[_0x4f114b(0x151)](_0x5366a9=>{const _0x4e970b=_0x4f114b;_0x5366a9[_0x4e970b(0x16e)]=!![],_0x5366a9[_0x4e970b(0x14d)]();});}function _0xc0e8(){const _0x7bd009=['app.js','file','getFullYear','NMDjM','isArray','AuVIQ','[cluster]\x20invalid\x20port\x20for\x20worker\x20:\x20','parse','join','CONFIG','suicide','child_process','Process\x20\x22','daemon','\x22\x20from\x20pidfile\x20not\x20found,\x20deleting\x20pidfile','restart','\x20ports:\x20','index','path','32716440jRRHfz','isPrimary','1786142AsNGQB','error',')\x20has\x20exited\x20(code:\x20','stop','HVGYf','PORT','DpIaV','vHRJE','get','log','tdbmE','BnGeb','3979773GzCCsf','readOnly','SIGHUP','nNGPA','mkdirp','8BohaqH','This\x20program\x20comes\x20with\x20ABSOLUTELY\x20NO\x20WARRANTY.','12631041cwDoDu','nHvFf','use','start','init','TRcYI','send','\x22\x20from\x20pidfile,\x20deleting\x20pidfile','rlpWt','\x20Copyright\x20(C)\x202013-','EfDvY','fFVdb','length','code','bjzpR','LjqFY','object','[cluster]\x20Spinning\x20up\x20another\x20process...','stores','displayStartupMessages','EBPbh','env','pipe','49610ihnmps','JtnoE','ayeNC','addWorkerEvents','silent','hPtLr','xNhTK','GLvqM','ZjlNy','app','[cluster]\x20url\x20is\x20undefined,\x20please\x20check\x20your\x20config.json','NodeBB\x20v','readFile','GXjIX','QSYCS','sync','exit','ICZxY','1549806rBFYab','bCIsz','nconf','./package.json','logFile','132VpLrYJ','version','action','[cluster]\x20Restarting...','false','DgNfa','unlinkSync','isCluster','url','./src/file','readFileSync','EHhtU','stdout','hmnEf','cwd','wRNkS','kill','existsSync','info','ESRCH','forEach','EuTfY','utf-8','stack','baEwa','var\x20x\x20=\x2042;\x20return\x20x;','hLbSd',',\x20signal:\x20','frehd','1224778IKXdON','stderr','Clustering\x20enabled:\x20Spinning\x20up\x20','pid','port','set','Error\x20reading\x20config','writeFileSync','config.json','18mOUTOa'];_0xc0e8=function(){return _0x7bd009;};return _0xc0e8();}fs['open'](pathToConfig,'r',_0x5b1251=>{const _0x3dd63f=_0x3cf1a7,_0x554420={'ICZxY':_0x3dd63f(0x165),'ZdxDB':'utf-8','frehd':_0x3dd63f(0x12f),'AuVIQ':function(_0x2fc540,_0x3e307a){return _0x2fc540!==_0x3e307a;},'FMGmD':_0x3dd63f(0x171),'TRcYI':function(_0x645f75,_0x18f639){return _0x645f75===_0x18f639;},'cvyMi':_0x3dd63f(0x14c),'HVGYf':function(_0x253069,_0xfa757e){return _0x253069===_0xfa757e;},'GLvqM':function(_0x5b8305,_0x4cfbfb){return _0x5b8305(_0x4cfbfb);},'PAQga':function(_0x38318b,_0xe584f1){return _0x38318b(_0xe584f1);},'MPiVS':_0x3dd63f(0x103)};if(_0x5b1251){fork(_0x554420[_0x3dd63f(0x159)]),eval('Math[\'PI\'] * 2;');return;}if(_0x554420[_0x3dd63f(0x169)](nconf[_0x3dd63f(0x104)](_0x554420['FMGmD']),'false')&&_0x554420[_0x3dd63f(0x169)](nconf[_0x3dd63f(0x104)](_0x554420['FMGmD']),![])){if(file[_0x3dd63f(0x14e)](pidFilePath)){let _0x5ddff6=0x0;try{_0x5ddff6=fs[_0x3dd63f(0x147)](pidFilePath,{'encoding':_0x3dd63f(0x153)});if(_0x5ddff6)process['kill'](_0x5ddff6,0x0),console[_0x3dd63f(0x14f)](_0x3dd63f(0x170)+_0x5ddff6+'\x22\x20from\x20pidfile\x20already\x20running,\x20exiting'),process[_0x3dd63f(0x136)]();else{if(_0x554420[_0x3dd63f(0x114)](_0x3dd63f(0x14c),_0x554420['cvyMi']))console[_0x3dd63f(0x14f)]('Invalid\x20pid\x20\x22'+_0x5ddff6+_0x3dd63f(0x116)),fs[_0x3dd63f(0x143)](pidFilePath);else{const _0x405977={'hdlaa':function(_0x56358a,_0x27d07e){return _0x56358a!==_0x27d07e;}};_0x422453(),_0x13925a['remove'](_0x554420[_0x3dd63f(0x137)]),_0x32bdcb[_0x3dd63f(0x111)]('file',{'file':_0x21562d}),_0x49f91d[_0x3dd63f(0x132)](_0x12d2fd,{'encoding':_0x554420['ZdxDB']},(_0x3ad1c3,_0x15b532)=>{const _0x3bc34d=_0x3dd63f;if(_0x3ad1c3){_0x500439[_0x3bc34d(0x17a)](_0x3bc34d(0x160));throw _0x3ad1c3;}const _0x3acd80=_0x58ab5e[_0x3bc34d(0x16b)](_0x15b532);_0x57118f[_0x3bc34d(0x121)][_0x3bc34d(0x124)][_0x3bc34d(0x109)]=![],_0x5bc4e0[_0x3bc34d(0x15f)]('url',_0x3acd80[_0x3bc34d(0x145)]),_0x3e739e['stores']['env']['readOnly']=!![],_0x405977['hdlaa'](_0x4946ac[_0x3bc34d(0x124)][_0x3bc34d(0x145)],_0x3acd80[_0x3bc34d(0x145)])&&(_0x40ca1e[_0x3bc34d(0x124)][_0x3bc34d(0x145)]=_0x3acd80[_0x3bc34d(0x145)]),_0xe1876a[_0x3bc34d(0x112)]();});}}}catch(_0x391d65){if(_0x554420[_0x3dd63f(0x17d)](_0x391d65[_0x3dd63f(0x11c)],_0x3dd63f(0x150)))console[_0x3dd63f(0x14f)](_0x3dd63f(0x170)+_0x5ddff6+'\x22\x20from\x20pidfile\x20not\x20found,\x20deleting\x20pidfile'),fs[_0x3dd63f(0x143)](pidFilePath);else{console['error'](_0x391d65[_0x3dd63f(0x154)]);throw _0x391d65;}}}_0x554420[_0x3dd63f(0x12d)](require,_0x554420['FMGmD'])({'stdout':process[_0x3dd63f(0x149)],'stderr':process[_0x3dd63f(0x15b)],'cwd':process[_0x3dd63f(0x14b)]()}),fs[_0x3dd63f(0x161)](pidFilePath,_0x554420['PAQga'](String,process[_0x3dd63f(0x15d)]));}try{_0x3dd63f(0x142)===_0x554420['MPiVS']?_0x4bad1c[_0x3dd63f(0x143)](_0x4b4246):(Loader[_0x3dd63f(0x113)](),Loader[_0x3dd63f(0x122)](),Loader['start']());}catch(_0xbbc6ee){console['error']('[loader]\x20Error\x20during\x20startup');throw _0xbbc6ee;}});