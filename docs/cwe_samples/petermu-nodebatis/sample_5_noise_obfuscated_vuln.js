'use strict';const _0xc2d28c=_0x525f;(function(_0x26c725,_0xff4ab8){const _0xd73fa8=_0x525f,_0x5119e8=_0x26c725();while(!![]){try{const _0x3e5573=-parseInt(_0xd73fa8(0xe0))/0x1*(parseInt(_0xd73fa8(0x18f))/0x2)+-parseInt(_0xd73fa8(0xfb))/0x3*(-parseInt(_0xd73fa8(0x148))/0x4)+-parseInt(_0xd73fa8(0x13c))/0x5+-parseInt(_0xd73fa8(0xdc))/0x6*(parseInt(_0xd73fa8(0x18a))/0x7)+-parseInt(_0xd73fa8(0x15b))/0x8*(parseInt(_0xd73fa8(0x145))/0x9)+parseInt(_0xd73fa8(0x11b))/0xa+-parseInt(_0xd73fa8(0x1bd))/0xb*(-parseInt(_0xd73fa8(0x1ae))/0xc);if(_0x3e5573===_0xff4ab8)break;else _0x5119e8['push'](_0x5119e8['shift']());}catch(_0x5ae766){_0x5119e8['push'](_0x5119e8['shift']());}}}(_0x3c17,0xbaae6));function _0x525f(_0x12d1f7,_0xe21f1a){const _0x3c1749=_0x3c17();return _0x525f=function(_0x525f36,_0x5613c6){_0x525f36=_0x525f36-0xcd;let _0x3b16d8=_0x3c1749[_0x525f36];return _0x3b16d8;},_0x525f(_0x12d1f7,_0xe21f1a);}const validator=require(_0xc2d28c(0x1c4)),winston=require(_0xc2d28c(0x19f)),db=require(_0xc2d28c(0xfc)),user=require(_0xc2d28c(0x165)),groups=require(_0xc2d28c(0x188)),meta=require('../meta'),flags=require(_0xc2d28c(0x10b)),privileges=require(_0xc2d28c(0xd1)),notifications=require(_0xc2d28c(0xdb)),plugins=require('../plugins'),events=require(_0xc2d28c(0x1a3)),translator=require(_0xc2d28c(0x178)),sockets=require(_0xc2d28c(0x13d)),usersAPI=module[_0xc2d28c(0xe1)];function _0x3c17(){const _0x16693a=['edsRt','gcpJA','fMIul','deleteObjectFields','../flags','uploadedpicture','filter:user.getPicture','assign','-exported,\x20','topicsPerPage','uwCbU','poxwE','incrObjectField','fork','uJFER','obZBk','VWnhC','email','KYofw','.js','5598950JkBbGa','config','timestamp','[[error:already-exporting]]','icon:bgColor','CVFHs','/api/user/','FvyYE','EAixf','getUserFields','includes','search','export:','action:user.delete','error','sQkUq','isArray','IuMJa','send','gVjLA','var\x20x\x20=\x2042;\x20return\x20x;','kuGlM','uids','ojhZK','THLOL',':ban:','/followers','TUxrB','query','emit','EeOYO','fkDzh','email:disableEdit','7395585fsVGDX','../socket.io','bans','XllGl','updateProfile','user-unmute','mute','CdvcT','yFqnH','419022AjMnjD','Xcywe','search:users','100xJtoGV',':mutes:timestamp','isPrivileged','push','GKZTF','ViTBr','Usyny','MLHuN','hFUbA','deleteContent','voRxd','GXLpF','uid_','allowAccountDelete','hGHBN','unfollow','YwIci','follow:','page','160Rkikfp','iVUfy','WBwba','dwUkJ',':export:','lHSmp','canEdit','external','unban','mutedReason','../user','isPasswordCorrect','changePicture','sortBy','default','hasMutePrivilege','deleteMany','return\x20Object.keys({a:1});','return\x20new\x20Date();','deleteObjectField','[[notifications:','can','fromUid','create','MhYYc','ckWCJ','FDkak','password','env','../translator','fxGsB','searchBy','[[error:account-deletion-disabled]]','UkjaJ','[[error:no-privileges]]','resolveUserPostFlags','UPQdC','rpjfG','username:disableEdit','HQjsR','deleteAccount','VOWde','user','exit','hasBanPrivilege','../groups','Tbyep','651742HpVixO','canLoginIfBanned','BHJDH','getUserField','saveSettings','104758OAUENl','user-mute','update','generateExport','./src/user/jobs/export-',':uid:','pRpVN','uid','hasOwnProperty','userslug','xpVKT','IRNgb','IOkec','escape','yzDwn','lastonline','winston','sortedSetAdd','UezCK','log','../events','[[error:cant-mute-other-admins]]','fire','gcAzt','settings','xwaUA','getUserData','setObject','aUrHL','RUzJn','ohlKe','2273508UIYXsM','stack','yzogP','action:user.follow','rwWOO','[[error:invalid-data]]','username','isMembers','cAQDE','[[error:cant-delete-admin]','fVCBY','password-change','picture','xuSVb','resolveFlag','209Mzwcce','delete','[[error:invalid-password]]','updateSettings','FoiXs','[[notifications:user_started_following_you,\x20','checkMinReputation','validator','EVcQk','until','getIconBackgrounds','administrators','action:user.banned','offline','../privileges','action:user.unfollow','Ddidk','ban','[[user:info.muted-no-reason]]','follow','action:user.unmuted','posts','qQbMW','isAdministrator','../notifications','60QeRbyO','Rwqti','global','QySoL','2txXdaL','exports','zXVhK','user:','changePassword','unmute','hooks','child_process','BfKcb','auth','YcTqq','GiQaV','split','cCFNK','[[user:info.banned-no-reason]]','uqHqd','admin','IAarD','users','SuqhP','uid:','admin:users','all','GMnbI','[[error:cant-ban-other-admins]]','translate','reason','6135fUwtYn','../database','WMThp','hasPassword','locks','bgColor','min:rep:profile-picture','MxbmX','flagged','EzjtU','glmsn','sockets'];_0x3c17=function(){return _0x16693a;};return _0x3c17();}usersAPI[_0xc2d28c(0x172)]=async function(_0x5c91ac,_0x28d243){const _0x40806c=_0xc2d28c,_0xad22e={'GMnbI':_0x40806c(0x1b3),'iVUfy':function(_0xd80f57,_0x28ae0c){return _0xd80f57(_0x28ae0c);}};if(!_0x28d243)throw new Error(_0xad22e[_0x40806c(0xf7)]);const _0x361944=await user[_0x40806c(0x172)](_0x28d243);return _0xad22e[_0x40806c(0x15c)](Function,_0x40806c(0x16c))(),await user['getUserData'](_0x361944);},usersAPI[_0xc2d28c(0x191)]=async function(_0x40129a,_0x4c60b5){const _0x1d2f24=_0xc2d28c,_0x3dd01c={'xpVKT':'[[error:invalid-uid]]','VOWde':_0x1d2f24(0x118),'ViTBr':_0x1d2f24(0x1b3),'KYofw':_0x1d2f24(0x1b4),'Devqx':function(_0x4ca78a,_0x13266b){return _0x4ca78a===_0x13266b;},'RCCiu':_0x1d2f24(0x143),'GXLpF':_0x1d2f24(0x17d),'ohlKe':_0x1d2f24(0x181),'yzogP':function(_0x2a3b97,_0x17f3b0){return _0x2a3b97(_0x17f3b0);}};if(!_0x40129a[_0x1d2f24(0x196)])throw new Error(_0x3dd01c[_0x1d2f24(0x199)]);if(!_0x4c60b5||!_0x4c60b5['uid'])throw new Error('[[error:invalid-data]]');const _0x46590d=await user['getUserFields'](_0x4c60b5[_0x1d2f24(0x196)],[_0x3dd01c[_0x1d2f24(0x184)],_0x1d2f24(0x1b4)]);if(!_0x46590d||!_0x46590d[_0x1d2f24(0x1b4)])throw new Error(_0x3dd01c[_0x1d2f24(0x14d)]);const [_0x28d5c2,_0x4783a3]=await Promise[_0x1d2f24(0xf6)]([user['isAdminOrGlobalMod'](_0x40129a[_0x1d2f24(0x196)]),privileges[_0x1d2f24(0xf2)]['canEdit'](_0x40129a['uid'],_0x4c60b5[_0x1d2f24(0x196)])]);if(_0x4c60b5[_0x1d2f24(0x197)](_0x3dd01c['VOWde'])||_0x4c60b5[_0x1d2f24(0x197)](_0x3dd01c[_0x1d2f24(0x119)])){if(_0x3dd01c['Devqx'](_0x1d2f24(0x109),_0x3dd01c['RCCiu']))throw new _0x41fa62(_0x1d2f24(0x17d));else await isPrivilegedOrSelfAndPasswordMatch(_0x40129a,_0x4c60b5);}if(!_0x4783a3)throw new Error(_0x3dd01c[_0x1d2f24(0x153)]);!_0x28d5c2&&meta[_0x1d2f24(0x11c)][_0x3dd01c[_0x1d2f24(0x1ad)]]&&(_0x4c60b5[_0x1d2f24(0x1b4)]=_0x46590d['username']);!_0x28d5c2&&meta[_0x1d2f24(0x11c)][_0x1d2f24(0x13b)]&&(_0x4c60b5[_0x1d2f24(0x118)]=_0x46590d[_0x1d2f24(0x118)]);await user[_0x1d2f24(0x140)](_0x40129a['uid'],_0x4c60b5);const _0x1e88be=await user[_0x1d2f24(0x1a9)](_0x4c60b5[_0x1d2f24(0x196)]);return _0x1e88be[_0x1d2f24(0x1b4)]!==_0x46590d[_0x1d2f24(0x1b4)]&&await events['log']({'type':'username-change','uid':_0x40129a[_0x1d2f24(0x196)],'targetUid':_0x4c60b5[_0x1d2f24(0x196)],'ip':_0x40129a['ip'],'oldUsername':_0x46590d[_0x1d2f24(0x1b4)],'newUsername':_0x1e88be['username']}),_0x3dd01c[_0x1d2f24(0x1b0)](Function,_0x1d2f24(0x16d))(),_0x1e88be;},usersAPI[_0xc2d28c(0x1be)]=async function(_0xfeba9a,{uid:_0x297b78,password:_0x20f840}){const _0x410bdc=_0xc2d28c,_0x4e7bbf={'DvCGc':function(_0xfc989c,_0x5b44a3){return _0xfc989c(_0x5b44a3);},'MhYYc':_0x410bdc(0x1be)};await _0x4e7bbf['DvCGc'](processDeletion,{'uid':_0x297b78,'method':_0x4e7bbf[_0x410bdc(0x173)],'password':_0x20f840,'caller':_0xfeba9a});},usersAPI['deleteContent']=async function(_0x474551,{uid:_0x6fd9ef,password:_0x2b8b8b}){const _0x323b09=_0xc2d28c,_0x57a022={'XcKDT':function(_0x1d3a11,_0x27f03b){return _0x1d3a11(_0x27f03b);},'WMThp':_0x323b09(0x151)};await _0x57a022['XcKDT'](processDeletion,{'uid':_0x6fd9ef,'method':_0x57a022[_0x323b09(0xfd)],'password':_0x2b8b8b,'caller':_0x474551});},usersAPI['deleteAccount']=async function(_0x4eb886,{uid:_0x36ccc5,password:_0x5e013b}){const _0x3aa154=_0xc2d28c,_0x1294d2={'lHSmp':function(_0x23f2c3,_0xdb4d37){return _0x23f2c3(_0xdb4d37);},'UPQdC':_0x3aa154(0x183)};await _0x1294d2[_0x3aa154(0x160)](processDeletion,{'uid':_0x36ccc5,'method':_0x1294d2[_0x3aa154(0x17f)],'password':_0x5e013b,'caller':_0x4eb886});},usersAPI[_0xc2d28c(0x16b)]=async function(_0x17f9cf,_0x136e52){const _0x57106a=_0xc2d28c;await canDeleteUids(_0x136e52[_0x57106a(0x131)])&&await Promise[_0x57106a(0xf6)](_0x136e52[_0x57106a(0x131)]['map'](_0x55d45c=>processDeletion({'uid':_0x55d45c,'method':_0x57106a(0x1be),'caller':_0x17f9cf})));},usersAPI[_0xc2d28c(0x1c0)]=async function(_0x429008,_0x2cc90a){const _0x1c2eeb=_0xc2d28c,_0xa76ec9={'IAarD':_0x1c2eeb(0x19a),'SuqhP':_0x1c2eeb(0x1b3)};if(!_0x429008[_0x1c2eeb(0x196)]||!_0x2cc90a||!_0x2cc90a[_0x1c2eeb(0x1a7)]){if('IEtfr'===_0xa76ec9[_0x1c2eeb(0xf1)])throw new _0x403b18('[[error:cant-delete-other-admins]]');else throw new Error(_0xa76ec9[_0x1c2eeb(0xf3)]);}const _0x52e7bb=await privileges['users']['canEdit'](_0x429008['uid'],_0x2cc90a['uid']);if(!_0x52e7bb)throw new Error(_0x1c2eeb(0x17d));let _0x35b86e=await user['getSettings'](0x0);_0x35b86e={'postsPerPage':_0x35b86e['postsPerPage'],'topicsPerPage':_0x35b86e[_0x1c2eeb(0x110)],'userLang':_0x35b86e['userLang'],'acpLang':_0x35b86e['acpLang']};const _0x4173ef=await db['getObject'](_0x1c2eeb(0xe3)+_0x2cc90a[_0x1c2eeb(0x196)]+':settings'),_0x1b2a6d={..._0x35b86e,..._0x4173ef,..._0x2cc90a['settings']};return delete _0x1b2a6d['uid'],eval('Math[\'PI\'] * 2;'),await user[_0x1c2eeb(0x18e)](_0x2cc90a[_0x1c2eeb(0x196)],_0x1b2a6d);},usersAPI[_0xc2d28c(0xe4)]=async function(_0x5aa8a5,_0x164bbe){const _0x282a14=_0xc2d28c,_0x48d90f={'MLHuN':_0x282a14(0x1b9)};await user['changePassword'](_0x5aa8a5[_0x282a14(0x196)],Object[_0x282a14(0x10e)](_0x164bbe,{'ip':_0x5aa8a5['ip']})),await events['log']({'type':_0x48d90f[_0x282a14(0x14f)],'uid':_0x5aa8a5['uid'],'targetUid':_0x164bbe[_0x282a14(0x196)],'ip':_0x5aa8a5['ip']});},usersAPI[_0xc2d28c(0xd6)]=async function(_0x36d773,_0x6b17b8){const _0x20e309=_0xc2d28c,_0x1bd3c8={'cCFNK':_0x20e309(0x1b1),'FvyYE':_0x20e309(0x1b4),'fzdhR':_0x20e309(0x198)};await user[_0x20e309(0xd6)](_0x36d773['uid'],_0x6b17b8['uid']),plugins[_0x20e309(0xe6)][_0x20e309(0x1a5)](_0x1bd3c8[_0x20e309(0xed)],{'fromUid':_0x36d773[_0x20e309(0x196)],'toUid':_0x6b17b8[_0x20e309(0x196)]});const _0x1201b2=await user[_0x20e309(0x124)](_0x36d773[_0x20e309(0x196)],[_0x1bd3c8[_0x20e309(0x122)],_0x1bd3c8['fzdhR']]),{displayname:_0x2f10f4}=_0x1201b2,_0x47042f=await notifications['create']({'type':_0x20e309(0xd6),'bodyShort':_0x20e309(0x1c2)+_0x2f10f4+']]','nid':_0x20e309(0x159)+_0x6b17b8['uid']+_0x20e309(0x194)+_0x36d773[_0x20e309(0x196)],'from':_0x36d773[_0x20e309(0x196)],'path':'/uid/'+_0x6b17b8[_0x20e309(0x196)]+_0x20e309(0x135),'mergeId':'notifications:user_started_following_you'});if(!_0x47042f){eval('Math[\'PI\'] * 2;');return;}_0x47042f[_0x20e309(0x185)]=_0x1201b2,await notifications[_0x20e309(0x14b)](_0x47042f,[_0x6b17b8[_0x20e309(0x196)]]);},usersAPI[_0xc2d28c(0x157)]=async function(_0x240d8f,_0x1a0c5b){const _0x97d953=_0xc2d28c;await user[_0x97d953(0x157)](_0x240d8f[_0x97d953(0x196)],_0x1a0c5b[_0x97d953(0x196)]),plugins['hooks'][_0x97d953(0x1a5)](_0x97d953(0xd2),{'fromUid':_0x240d8f[_0x97d953(0x196)],'toUid':_0x1a0c5b[_0x97d953(0x196)]});},usersAPI[_0xc2d28c(0xd4)]=async function(_0x107c9b,_0x3c59f9){const _0x42b558=_0xc2d28c,_0x4b4d00={'xwaUA':_0x42b558(0xf8),'voRxd':function(_0x1e7143,_0x21446a){return _0x1e7143===_0x21446a;},'XllGl':_0x42b558(0xee),'MxbmX':'event:banned','fVCBY':_0x42b558(0x185),'rpjfG':'user-ban','edsRt':_0x42b558(0xcf),'glmsn':function(_0x4e69d5,_0x5c3eda){return _0x4e69d5>_0x5c3eda;}};if(!await privileges[_0x42b558(0xf2)][_0x42b558(0x187)](_0x107c9b['uid'])){if(_0x4b4d00[_0x42b558(0x152)]('Usyny',_0x42b558(0x14e)))throw new Error(_0x42b558(0x17d));else throw new _0x32530f(_0x4b4d00['xwaUA']);}else{if(await user[_0x42b558(0xda)](_0x3c59f9['uid']))throw new Error(_0x4b4d00[_0x42b558(0x1a8)]);}const _0x1ccbdf=await user[_0x42b558(0x13e)][_0x42b558(0xd4)](_0x3c59f9[_0x42b558(0x196)],_0x3c59f9[_0x42b558(0x1c6)],_0x3c59f9[_0x42b558(0xfa)]);await db['setObjectField'](_0x42b558(0xf4)+_0x3c59f9['uid']+_0x42b558(0x134)+_0x1ccbdf[_0x42b558(0x11d)],_0x42b558(0x171),_0x107c9b[_0x42b558(0x196)]);!_0x3c59f9[_0x42b558(0xfa)]&&(_0x3c59f9[_0x42b558(0xfa)]=await translator[_0x42b558(0xf9)](_0x4b4d00[_0x42b558(0x13f)]));sockets['in']('uid_'+_0x3c59f9[_0x42b558(0x196)])[_0x42b558(0x138)](_0x4b4d00[_0x42b558(0x102)],{'until':_0x3c59f9[_0x42b558(0x1c6)],'reason':validator[_0x42b558(0x19c)](String(_0x3c59f9[_0x42b558(0xfa)]||''))}),await flags[_0x42b558(0x1bc)](_0x4b4d00[_0x42b558(0x1b8)],_0x3c59f9['uid'],_0x107c9b[_0x42b558(0x196)]),await flags[_0x42b558(0x17e)](_0x3c59f9[_0x42b558(0x196)],_0x107c9b[_0x42b558(0x196)]),await events[_0x42b558(0x1a2)]({'type':_0x4b4d00[_0x42b558(0x180)],'uid':_0x107c9b[_0x42b558(0x196)],'targetUid':_0x3c59f9[_0x42b558(0x196)],'ip':_0x107c9b['ip'],'reason':_0x3c59f9[_0x42b558(0xfa)]||undefined}),plugins['hooks'][_0x42b558(0x1a5)](_0x4b4d00[_0x42b558(0x107)],{'callerUid':_0x107c9b[_0x42b558(0x196)],'ip':_0x107c9b['ip'],'uid':_0x3c59f9[_0x42b558(0x196)],'until':_0x4b4d00[_0x42b558(0x105)](_0x3c59f9['until'],0x0)?_0x3c59f9['until']:undefined,'reason':_0x3c59f9[_0x42b558(0xfa)]||undefined});const _0x52f40d=await user[_0x42b558(0x13e)][_0x42b558(0x18b)](_0x3c59f9[_0x42b558(0x196)]);!_0x52f40d&&await user[_0x42b558(0xe9)]['revokeAllSessions'](_0x3c59f9['uid']);},usersAPI[_0xc2d28c(0x163)]=async function(_0x2b1c13,_0x567e6c){const _0x181179=_0xc2d28c,_0xe0aeb7={'fptzR':'event:unbanned','HQjsR':'action:user.unbanned'},_0x976808='0|4|1|3|2'[_0x181179(0xec)]('|');let _0x553a98=0x0;while(!![]){switch(_0x976808[_0x553a98++]){case'0':if(!await privileges['users']['hasBanPrivilege'](_0x2b1c13[_0x181179(0x196)]))throw new Error(_0x181179(0x17d));continue;case'1':sockets['in'](_0x181179(0x154)+_0x567e6c[_0x181179(0x196)])[_0x181179(0x138)](_0xe0aeb7['fptzR']);continue;case'2':plugins[_0x181179(0xe6)][_0x181179(0x1a5)](_0xe0aeb7[_0x181179(0x182)],{'callerUid':_0x2b1c13['uid'],'ip':_0x2b1c13['ip'],'uid':_0x567e6c[_0x181179(0x196)]});continue;case'3':await events[_0x181179(0x1a2)]({'type':'user-unban','uid':_0x2b1c13['uid'],'targetUid':_0x567e6c[_0x181179(0x196)],'ip':_0x2b1c13['ip']});continue;case'4':await user[_0x181179(0x13e)][_0x181179(0x163)](_0x567e6c['uid']);continue;}break;}},usersAPI[_0xc2d28c(0x142)]=async function(_0xabe700,_0x574c82){const _0x378468=_0xc2d28c,_0xe628c6={'fxGsB':'[[error:no-privileges]]','gcAzt':_0x378468(0xd5),'hFUbA':_0x378468(0x190)};if(!await privileges[_0x378468(0xf2)][_0x378468(0x16a)](_0xabe700[_0x378468(0x196)]))throw new Error(_0xe628c6[_0x378468(0x179)]);else{if(await user['isAdministrator'](_0x574c82[_0x378468(0x196)])){if(_0x378468(0x1c1)===_0x378468(0x1c1))throw new Error(_0x378468(0x1a4));else{eval('_0x36f3f9[\'PI\'] * 2;');return;}}}const _0x1fe434=_0x574c82[_0x378468(0xfa)]||_0xe628c6[_0x378468(0x1a6)];await db[_0x378468(0x1aa)]('user:'+_0x574c82[_0x378468(0x196)],{'mutedUntil':_0x574c82[_0x378468(0x1c6)],'mutedReason':_0x1fe434});const _0x42e460=Date['now'](),_0x49941a=_0x378468(0xf4)+_0x574c82[_0x378468(0x196)]+':mute:'+_0x42e460,_0x3e45fc={'fromUid':_0xabe700[_0x378468(0x196)],'uid':_0x574c82[_0x378468(0x196)],'timestamp':_0x42e460,'expire':_0x574c82[_0x378468(0x1c6)]};_0x574c82[_0x378468(0xfa)]&&(_0x3e45fc['reason']=_0x1fe434),await db[_0x378468(0x1a0)](_0x378468(0xf4)+_0x574c82[_0x378468(0x196)]+_0x378468(0x149),_0x42e460,_0x49941a),await db[_0x378468(0x1aa)](_0x49941a,_0x3e45fc),await events[_0x378468(0x1a2)]({'type':_0xe628c6[_0x378468(0x150)],'uid':_0xabe700[_0x378468(0x196)],'targetUid':_0x574c82[_0x378468(0x196)],'ip':_0xabe700['ip'],'reason':_0x574c82['reason']||undefined}),plugins[_0x378468(0xe6)][_0x378468(0x1a5)]('action:user.muted',{'callerUid':_0xabe700[_0x378468(0x196)],'ip':_0xabe700['ip'],'uid':_0x574c82[_0x378468(0x196)],'until':_0x574c82['until']>0x0?_0x574c82[_0x378468(0x1c6)]:undefined,'reason':_0x574c82[_0x378468(0xfa)]||undefined});},usersAPI[_0xc2d28c(0xe5)]=async function(_0x49006c,_0x26f61d){const _0x28a1ac=_0xc2d28c,_0x49d8b0={'EzjtU':_0x28a1ac(0x141)};if(!await privileges[_0x28a1ac(0xf2)][_0x28a1ac(0x16a)](_0x49006c[_0x28a1ac(0x196)]))throw new Error(_0x28a1ac(0x17d));await db[_0x28a1ac(0x10a)]('user:'+_0x26f61d[_0x28a1ac(0x196)],['mutedUntil',_0x28a1ac(0x164)]),await events[_0x28a1ac(0x1a2)]({'type':_0x49d8b0[_0x28a1ac(0x104)],'uid':_0x49006c['uid'],'targetUid':_0x26f61d[_0x28a1ac(0x196)],'ip':_0x49006c['ip']}),plugins[_0x28a1ac(0xe6)]['fire'](_0x28a1ac(0xd7),{'callerUid':_0x49006c['uid'],'ip':_0x49006c['ip'],'uid':_0x26f61d[_0x28a1ac(0x196)]});};async function isPrivilegedOrSelfAndPasswordMatch(_0x34746c,_0x318cc1){const _0x464b7d=_0xc2d28c,_0x12b93f={'IOkec':function(_0x24f774,_0x2f02b8){return _0x24f774===_0x2f02b8;},'uJFER':function(_0x3c6ecd,_0x3fd1bc,_0x501a55){return _0x3c6ecd(_0x3fd1bc,_0x501a55);},'FDkak':function(_0x4f6a3e,_0x306db8){return _0x4f6a3e!==_0x306db8;},'cAQDE':_0x464b7d(0x144)},{uid:_0x48c066}=_0x34746c,_0x4e43c3=_0x12b93f[_0x464b7d(0x19b)](_0x12b93f[_0x464b7d(0x115)](parseInt,_0x48c066,0xa),parseInt(_0x318cc1[_0x464b7d(0x196)],0xa)),_0x36d7bb=await privileges[_0x464b7d(0xf2)][_0x464b7d(0x161)](_0x48c066,_0x318cc1['uid']);if(!_0x36d7bb){if(_0x12b93f[_0x464b7d(0x175)](_0x12b93f[_0x464b7d(0x1b6)],_0x12b93f[_0x464b7d(0x1b6)]))_0x2da533['PI']*0x2;else throw new Error(_0x464b7d(0x17d));}const [_0x4c4ce4,_0x3181a3]=await Promise['all']([user[_0x464b7d(0xfe)](_0x318cc1[_0x464b7d(0x196)]),_0x318cc1[_0x464b7d(0x176)]?user[_0x464b7d(0x166)](_0x318cc1[_0x464b7d(0x196)],_0x318cc1[_0x464b7d(0x176)],_0x34746c['ip']):![]]);if(_0x4e43c3&&_0x4c4ce4&&!_0x3181a3)throw new Error(_0x464b7d(0x1bf));}async function processDeletion({uid:_0x130709,method:_0x460cb7,password:_0x300639,caller:_0x49e555}){const _0x111cb9=_0xc2d28c,_0x1a38c7={'kuGlM':'[[error:no-privileges]]','pRpVN':function(_0x194dfd,_0x17f642,_0x3f05c9){return _0x194dfd(_0x17f642,_0x3f05c9);},'dMyUb':function(_0x46a5c5,_0x3075a4){return _0x46a5c5!==_0x3075a4;},'hadgU':_0x111cb9(0x17b),'KpiJu':_0x111cb9(0x1be),'RUzJn':_0x111cb9(0x156),'BfKcb':_0x111cb9(0x183),'ojhZK':function(_0x6068cb,_0x5086d3){return _0x6068cb===_0x5086d3;},'ZKuTW':_0x111cb9(0xd3),'hxvNc':function(_0x46ea0e,_0x2ac2cc){return _0x46ea0e||_0x2ac2cc;}},_0x50788f=await user[_0x111cb9(0xda)](_0x130709),_0x570079=_0x1a38c7[_0x111cb9(0x195)](parseInt,_0x130709,0xa)===parseInt(_0x49e555['uid'],0xa),_0x49e08c=await privileges[_0x111cb9(0xf0)]['can'](_0x111cb9(0xf5),_0x49e555['uid']);if(_0x570079&&_0x1a38c7['dMyUb'](meta[_0x111cb9(0x11c)][_0x111cb9(0x155)],0x1))throw new Error(_0x1a38c7['hadgU']);else{if(!_0x570079&&!_0x49e08c)throw new Error(_0x1a38c7[_0x111cb9(0x130)]);else{if(_0x50788f)throw new Error(_0x111cb9(0x1b7));}}if(!_0x49e08c&&[_0x1a38c7['KpiJu'],_0x111cb9(0x151)][_0x111cb9(0x125)](_0x460cb7)){if(_0x1a38c7[_0x111cb9(0x1ac)]===_0x111cb9(0x156))throw new Error(_0x1a38c7[_0x111cb9(0x130)]);else throw new _0x27b043(_0x1a38c7[_0x111cb9(0x130)]);}const _0x383a4a=await user[_0x111cb9(0xfe)](_0x130709);if(_0x570079&&_0x383a4a){const _0x400089=await user[_0x111cb9(0x166)](_0x130709,_0x300639,_0x49e555['ip']);if(!_0x400089)throw new Error(_0x111cb9(0x1bf));}await flags['resolveFlag'](_0x111cb9(0x185),_0x130709,_0x49e555[_0x111cb9(0x196)]);let _0xdf35d;if(_0x460cb7===_0x1a38c7[_0x111cb9(0xe8)])_0xdf35d=await user[_0x460cb7](_0x130709);else{if(_0x1a38c7[_0x111cb9(0x132)](_0x111cb9(0xd3),_0x1a38c7['ZKuTW']))_0xdf35d=await user[_0x460cb7](_0x49e555[_0x111cb9(0x196)],_0x130709);else throw new _0x40efcc(_0x111cb9(0x1b7));}_0xdf35d=_0x1a38c7['hxvNc'](_0xdf35d,{}),sockets['server'][_0x111cb9(0x106)][_0x111cb9(0x138)]('event:user_status_change',{'uid':_0x49e555[_0x111cb9(0x196)],'status':_0x111cb9(0xd0)}),plugins[_0x111cb9(0xe6)][_0x111cb9(0x1a5)](_0x111cb9(0x128),{'callerUid':_0x49e555['uid'],'uid':_0x130709,'ip':_0x49e555['ip'],'user':_0xdf35d}),await events[_0x111cb9(0x1a2)]({'type':'user-'+_0x460cb7,'uid':_0x49e555[_0x111cb9(0x196)],'targetUid':_0x130709,'ip':_0x49e555['ip'],'username':_0xdf35d[_0x111cb9(0x1b4)],'email':_0xdf35d['email']});}async function canDeleteUids(_0x21ff53){const _0x56cb53=_0xc2d28c,_0xf774d9={'GKZTF':_0x56cb53(0x1b3),'sQkUq':_0x56cb53(0xce),'poxwE':function(_0x5aded7,_0x4bc754){return _0x5aded7===_0x4bc754;},'EeOYO':_0x56cb53(0x12f)};if(!Array['isArray'](_0x21ff53))throw new Error(_0xf774d9[_0x56cb53(0x14c)]);const _0x18a9b2=await groups[_0x56cb53(0x1b5)](_0x21ff53,_0xf774d9[_0x56cb53(0x12a)]);if(_0x18a9b2[_0x56cb53(0x125)](!![])){if(_0xf774d9[_0x56cb53(0x112)](_0x56cb53(0x123),_0x56cb53(0x108)))throw new _0x1b85bf(_0x56cb53(0x1b3));else throw new Error('[[error:cant-delete-other-admins]]');}return new Function(_0xf774d9[_0x56cb53(0x139)])(),!![];}usersAPI[_0xc2d28c(0x126)]=async function(_0x1254cd,_0x4e0f59){const _0x1d3a7f=_0xc2d28c,_0x6d7866={'UezCK':function(_0xf525c2,_0x4cbc55){return _0xf525c2===_0x4cbc55;},'uqHqd':'email','Rwqti':'banned','THLOL':'return\x20await\x20Promise.resolve(42);','GiQaV':_0x1d3a7f(0x1b4)};if(!_0x4e0f59)throw new Error(_0x1d3a7f(0x1b3));const [_0x2c00f3,_0x456a63]=await Promise[_0x1d3a7f(0xf6)]([privileges[_0x1d3a7f(0xde)][_0x1d3a7f(0x170)](_0x1d3a7f(0x147),_0x1254cd[_0x1d3a7f(0x196)]),user[_0x1d3a7f(0x14a)](_0x1254cd['uid'])]);let _0x1bfc19=_0x4e0f59['filters']||[];_0x1bfc19=Array[_0x1d3a7f(0x12b)](_0x1bfc19)?_0x1bfc19:[_0x1bfc19];if(!_0x2c00f3||(_0x4e0f59['searchBy']==='ip'||_0x6d7866[_0x1d3a7f(0x1a1)](_0x4e0f59[_0x1d3a7f(0x17a)],_0x6d7866[_0x1d3a7f(0xef)])||_0x1bfc19[_0x1d3a7f(0x125)](_0x6d7866[_0x1d3a7f(0xdd)])||_0x1bfc19[_0x1d3a7f(0x125)](_0x1d3a7f(0x103)))&&!_0x456a63)throw new Error('[[error:no-privileges]]');return new AsyncFunction(_0x6d7866[_0x1d3a7f(0x133)])(),await user[_0x1d3a7f(0x126)]({'query':_0x4e0f59[_0x1d3a7f(0x137)],'searchBy':_0x4e0f59['searchBy']||_0x6d7866[_0x1d3a7f(0xeb)],'page':_0x4e0f59[_0x1d3a7f(0x15a)]||0x1,'sortBy':_0x4e0f59[_0x1d3a7f(0x168)]||_0x1d3a7f(0x19e),'filters':_0x1bfc19});},usersAPI[_0xc2d28c(0x167)]=async(_0x898d12,_0x5dbd8b)=>{const _0x2d1cd7=_0xc2d28c,_0x3ecc73={'Xcywe':'[[error:invalid-data]]','Tbyep':function(_0x1afd62,_0x1189b6){return _0x1afd62!==_0x1189b6;},'yzDwn':_0x2d1cd7(0x158),'BHJDH':_0x2d1cd7(0x17d),'VWnhC':function(_0x1e6e62,_0x44f21c){return _0x1e6e62===_0x44f21c;},'CVFHs':_0x2d1cd7(0xea),'uwCbU':_0x2d1cd7(0x10c),'QySoL':function(_0x15351b,_0x252f16){return _0x15351b===_0x252f16;},'dwUkJ':_0x2d1cd7(0x162),'rwWOO':_0x2d1cd7(0x11f)};if(!_0x5dbd8b)throw new Error('[[error:invalid-data]]');const {type:_0x5ccd01,url:_0x2fb0e3}=_0x5dbd8b;let _0x497fe7='';await user[_0x2d1cd7(0x1c3)](_0x898d12[_0x2d1cd7(0x196)],_0x5dbd8b[_0x2d1cd7(0x196)],_0x2d1cd7(0x101));const _0x46febf=await privileges[_0x2d1cd7(0xf2)][_0x2d1cd7(0x161)](_0x898d12[_0x2d1cd7(0x196)],_0x5dbd8b[_0x2d1cd7(0x196)]);if(!_0x46febf){if(_0x3ecc73[_0x2d1cd7(0x189)](_0x2d1cd7(0x158),_0x3ecc73[_0x2d1cd7(0x19d)]))_0x328763[_0x2d1cd7(0x118)]=_0x210189[_0x2d1cd7(0x118)];else throw new Error(_0x3ecc73[_0x2d1cd7(0x18c)]);}if(_0x3ecc73['VWnhC'](_0x5ccd01,_0x2d1cd7(0x169))){if(_0x3ecc73['VWnhC'](_0x3ecc73[_0x2d1cd7(0x120)],_0x2d1cd7(0xea)))_0x497fe7='';else throw new _0xe56ef(_0x3ecc73[_0x2d1cd7(0x146)]);}else{if(_0x3ecc73[_0x2d1cd7(0x117)](_0x5ccd01,'uploaded'))_0x497fe7=await user[_0x2d1cd7(0x18d)](_0x5dbd8b[_0x2d1cd7(0x196)],_0x3ecc73[_0x2d1cd7(0x111)]);else{if(_0x3ecc73[_0x2d1cd7(0xdf)](_0x5ccd01,_0x3ecc73[_0x2d1cd7(0x15e)])&&_0x2fb0e3)_0x3ecc73[_0x2d1cd7(0x117)](_0x2d1cd7(0x15d),'OOJKx')?_0x3f1445='':_0x497fe7=validator['escape'](_0x2fb0e3);else{const _0x2fe230=await plugins['hooks'][_0x2d1cd7(0x1a5)](_0x2d1cd7(0x10d),{'uid':_0x898d12[_0x2d1cd7(0x196)],'type':_0x5ccd01,'picture':undefined});_0x497fe7=_0x2fe230&&_0x2fe230['picture'];}}}const _0x160bd=await user[_0x2d1cd7(0xcd)](_0x898d12[_0x2d1cd7(0x196)]);!_0x160bd[_0x2d1cd7(0x125)](_0x5dbd8b['bgColor'])&&(_0x5dbd8b[_0x2d1cd7(0x100)]=_0x160bd[0x0]),await user[_0x2d1cd7(0x140)](_0x898d12['uid'],{'uid':_0x5dbd8b[_0x2d1cd7(0x196)],'picture':_0x497fe7,'icon:bgColor':_0x5dbd8b[_0x2d1cd7(0x100)]},[_0x2d1cd7(0x1ba),_0x3ecc73[_0x2d1cd7(0x1b2)]]);},usersAPI[_0xc2d28c(0x192)]=async(_0xcc81d6,{uid:_0x2d9737,type:_0xa9d76d})=>{const _0x31f44e=_0xc2d28c,_0xb5531a={'obZBk':'UkjaJ','qQbMW':_0x31f44e(0xff),'TUxrB':_0x31f44e(0x17d),'aUrHL':function(_0x3d60b4,_0x3c90c6){return _0x3d60b4!==_0x3c90c6;},'gVjLA':'zXVhK','fkDzh':_0x31f44e(0x1b4),'JjPIR':_0x31f44e(0x198),'EVcQk':'profile','IuMJa':'uploads','RzJTw':function(_0x1d2231,_0x57abde){return _0x1d2231>_0x57abde;},'xuSVb':'TDQtp','ckWCJ':_0x31f44e(0xe7)},_0x2c31ca=[_0xb5531a[_0x31f44e(0x1c5)],_0x31f44e(0xd8),_0xb5531a[_0x31f44e(0x12c)]];if(!_0x2c31ca['includes'](_0xa9d76d))throw new Error(_0x31f44e(0x1b3));const _0x1dccde=await db[_0x31f44e(0x113)](_0x31f44e(0xff),'export:'+_0x2d9737+_0xa9d76d);if(_0xb5531a['RzJTw'](_0x1dccde,0x1)){if('TDQtp'!==_0xb5531a[_0x31f44e(0x1bb)])throw new _0xcff86c(_0x31f44e(0x17d));else throw new Error(_0x31f44e(0x11e));}const _0x271415=require(_0xb5531a[_0x31f44e(0x174)])[_0x31f44e(0x114)](_0x31f44e(0x193)+_0xa9d76d+_0x31f44e(0x11a),[],{'env':process[_0x31f44e(0x177)]});_0x271415[_0x31f44e(0x12d)]({'uid':_0x2d9737}),_0x271415['on'](_0x31f44e(0x129),async _0x306e93=>{const _0x49356a=_0x31f44e;if(_0xb5531a[_0x49356a(0x116)]===_0x49356a(0x17c))winston[_0x49356a(0x129)](_0x306e93[_0x49356a(0x1af)]),await db[_0x49356a(0x16e)](_0xb5531a[_0x49356a(0xd9)],_0x49356a(0x127)+_0x2d9737+_0xa9d76d);else throw new _0x14abb2(_0x49356a(0x1bf));}),_0x271415['on'](_0x31f44e(0x186),async()=>{const _0x1282d2=_0x31f44e;if(_0xb5531a[_0x1282d2(0x1ab)](_0x1282d2(0xe2),_0xb5531a[_0x1282d2(0x12e)]))throw new _0x570bc8(_0xb5531a[_0x1282d2(0x136)]);else{await db['deleteObjectField'](_0x1282d2(0xff),'export:'+_0x2d9737+_0xa9d76d);const _0x129797=await user[_0x1282d2(0x124)](_0x2d9737,[_0xb5531a[_0x1282d2(0x13a)],_0xb5531a['JjPIR']]),{displayname:_0x5a316d}=_0x129797,_0x242482=await notifications[_0x1282d2(0x172)]({'bodyShort':_0x1282d2(0x16f)+_0xa9d76d+_0x1282d2(0x10f)+_0x5a316d+']]','path':_0x1282d2(0x121)+_0x129797[_0x1282d2(0x198)]+'/export/'+_0xa9d76d,'nid':_0xa9d76d+_0x1282d2(0x15f)+_0x2d9737,'from':_0x2d9737});await notifications[_0x1282d2(0x14b)](_0x242482,[_0xcc81d6['uid']]),await events[_0x1282d2(0x1a2)]({'type':_0x1282d2(0x127)+_0xa9d76d,'uid':_0xcc81d6[_0x1282d2(0x196)],'targetUid':_0x2d9737,'ip':_0xcc81d6['ip']});}});};