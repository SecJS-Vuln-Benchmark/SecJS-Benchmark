(function(_0x4c37ed,_0x545140){const _0x2e3b89=_0x2e8d,_0x3fe570=_0x4c37ed();while(!![]){try{const _0x3d7adf=-parseInt(_0x2e3b89(0x1d0))/0x1+-parseInt(_0x2e3b89(0x1de))/0x2*(-parseInt(_0x2e3b89(0x1cf))/0x3)+parseInt(_0x2e3b89(0x1f5))/0x4+-parseInt(_0x2e3b89(0x212))/0x5*(parseInt(_0x2e3b89(0x1e0))/0x6)+-parseInt(_0x2e3b89(0x20a))/0x7*(-parseInt(_0x2e3b89(0x1db))/0x8)+-parseInt(_0x2e3b89(0x20d))/0x9*(parseInt(_0x2e3b89(0x1f6))/0xa)+parseInt(_0x2e3b89(0x1d7))/0xb;if(_0x3d7adf===_0x545140)break;else _0x3fe570['push'](_0x3fe570['shift']());}catch(_0x1bc852){_0x3fe570['push'](_0x3fe570['shift']());}}}(_0xd16d,0xc3b1b));import _0x473bb4 from'puppeteer-core';import _0x1681ed from'chrome-aws-lambda';import _0x37fd74 from'./_common/middleware.js';function _0x2e8d(_0x6a72f8,_0x14155f){const _0xd16db7=_0xd16d();return _0x2e8d=function(_0x2e8dbe,_0x5f3177){_0x2e8dbe=_0x2e8dbe-0x1ca;let _0x5b0273=_0xd16db7[_0x2e8dbe];return _0x5b0273;},_0x2e8d(_0x6a72f8,_0x14155f);}import{execFile}from'child_process';import{promises as _0x1c3c9b}from'fs';function _0xd16d(){const _0x7e6010=['utUPj','message','[DIRECT-SCREENSHOT]\x20Failed\x20reading\x20screenshot:\x20','99435OhZQBs','--disable-gpu','join','2182086vnCndN','URL\x20is\x20missing\x20from\x20queryStringParameters','qALiX','GjQYH','[SCREENSHOT]\x20Puppeteer\x20screenshot\x20failed:\x20','43535ECDGwq','[SCREENSHOT]\x20Creating\x20new\x20page','[SCREENSHOT]\x20Screenshot\x20complete,\x20returning\x20image','[SCREENSHOT]\x20Setting\x20page\x20preferences','launch','TYgJV','wMswg','[SCREENSHOT]\x20URL\x20is\x20missing\x20from\x20queryStringParameters','[SCREENSHOT]\x20Launching\x20puppeteer\x20browser','[DIRECT-SCREENSHOT]\x20Screenshot\x20read\x20successfully','[SCREENSHOT]\x20URL\x20provided\x20is\x20invalid:\x20','URL\x20provided\x20is\x20invalid','3uaVqrP','71451YhAcdH','[SCREENSHOT]\x20Request\x20received\x20for\x20URL:\x20','dark','http://','screenshot','CUmIv','toString','15913117fxciUK','[SCREENSHOT]\x20Taking\x20screenshot','domcontentloaded','[SCREENSHOT]\x20Converting\x20screenshot\x20to\x20base64','240dBwpgB','prefers-color-scheme','newPage','72382MswdeY','--disable-extensions','822EKDkZz','[DIRECT-SCREENSHOT]\x20Will\x20save\x20screenshot\x20to:\x20','[DIRECT-SCREENSHOT]\x20Chromium\x20error:\x20','HNOyq','iQFlW','goto','unlink','[SCREENSHOT]\x20Closing\x20browser','base64','--no-sandbox','ZfgxH','[SCREENSHOT]\x20Falling\x20back\x20to\x20puppeteer\x20method...','KqDPL','warn','env','[SCREENSHOT]\x20Direct\x20screenshot\x20method\x20failed:\x20','readFile','[DIRECT-SCREENSHOT]\x20Executing:\x20','/usr/bin/chromium','cHsqD','startsWith','1597356GIXesS','10NEDMpy','error','hHEnm','.png','args','screenshot-','TJCmI','[SCREENSHOT]\x20Direct\x20screenshot\x20successful','yfWys','log','https://','gxjPE','setDefaultNavigationTimeout','lLCbt','CHROME_PATH','mGfPi','evaluate'];_0xd16d=function(){return _0x7e6010;};return _0xd16d();}import _0x5d91a5 from'path';import _0x394c66 from'uuid';const {v4:uuidv4}=_0x394c66,directChromiumScreenshot=async _0x2c9bed=>{const _0x5f5a13=_0x2e8d,_0x24a403={'HNOyq':function(_0x212903,_0x4156ab){return _0x212903(_0x4156ab);},'utUPj':_0x5f5a13(0x1f2),'lLCbt':'--headless','gxjPE':_0x5f5a13(0x20b),'Shflv':_0x5f5a13(0x1e9)};console[_0x5f5a13(0x1ff)]('[DIRECT-SCREENSHOT]\x20Starting\x20direct\x20screenshot\x20process\x20for\x20URL:\x20'+_0x2c9bed);const _0x4e2567='/tmp',_0x5bae6a=uuidv4(),_0x5aaddd=_0x5d91a5[_0x5f5a13(0x20c)](_0x4e2567,_0x5f5a13(0x1fb)+_0x5bae6a+_0x5f5a13(0x1f9));return console[_0x5f5a13(0x1ff)](_0x5f5a13(0x1e1)+_0x5aaddd),new Promise((_0x43c735,_0x2d41d9)=>{const _0x3e227e=_0x5f5a13,_0x2bb0ec=process['env'][_0x3e227e(0x204)]||_0x24a403[_0x3e227e(0x207)],_0x37dc16=[_0x24a403[_0x3e227e(0x203)],_0x24a403[_0x3e227e(0x201)],_0x24a403['Shflv'],'--screenshot='+_0x5aaddd,_0x2c9bed];console[_0x3e227e(0x1ff)](_0x3e227e(0x1f1)+_0x2bb0ec+'\x20'+_0x37dc16['join']('\x20')),execFile(_0x2bb0ec,_0x37dc16,async(_0x4cd114,_0x2160ff,_0x51f783)=>{const _0x3d78ee=_0x3e227e;if(_0x4cd114)return console[_0x3d78ee(0x1f7)](_0x3d78ee(0x1e2)+_0x4cd114[_0x3d78ee(0x208)]),_0x2d41d9(_0x4cd114);try{const _0x1fe329=await _0x1c3c9b[_0x3d78ee(0x1f0)](_0x5aaddd);console[_0x3d78ee(0x1ff)](_0x3d78ee(0x1cc));const _0x43a78d=_0x1fe329[_0x3d78ee(0x1d6)](_0x3d78ee(0x1e8));await _0x1c3c9b[_0x3d78ee(0x1e6)](_0x5aaddd)['catch'](_0x1a87a5=>console[_0x3d78ee(0x1ed)]('[DIRECT-SCREENSHOT]\x20Failed\x20to\x20delete\x20temp\x20file:\x20'+_0x1a87a5['message'])),_0x24a403[_0x3d78ee(0x1e3)](_0x43c735,_0x43a78d);}catch(_0xa5ccd2){console[_0x3d78ee(0x1f7)](_0x3d78ee(0x209)+_0xa5ccd2[_0x3d78ee(0x208)]),_0x2d41d9(_0xa5ccd2);}});});},screenshotHandler=async _0x30685a=>{const _0x4141f2=_0x2e8d,_0x44f55b={'CUmIv':_0x4141f2(0x20e),'qALiX':'[SCREENSHOT]\x20URL\x20is\x20missing\x20from\x20queryStringParameters','iQFlW':_0x4141f2(0x1d3),'TJCmI':_0x4141f2(0x200),'yfWys':function(_0x14fe66,_0x5367e2){return _0x14fe66+_0x5367e2;},'KqDPL':function(_0x223bba,_0x4b71c4){return _0x223bba(_0x4b71c4);},'TYgJV':function(_0x59eb7f,_0x2b8038){return _0x59eb7f!==_0x2b8038;},'ZfgxH':_0x4141f2(0x210),'hHEnm':_0x4141f2(0x1e9),'IaFnL':_0x4141f2(0x1df),'cHsqD':_0x4141f2(0x1d9),'wMswg':function(_0x465762,_0x53b945){return _0x465762!==_0x53b945;},'nDOZe':function(_0x4c57c5,_0x51b019){return _0x4c57c5!==_0x51b019;}};console[_0x4141f2(0x1ff)](_0x4141f2(0x1d1)+_0x30685a);if(!_0x30685a){console[_0x4141f2(0x1f7)](_0x44f55b[_0x4141f2(0x20f)]);throw new Error('URL\x20is\x20missing\x20from\x20queryStringParameters');}!_0x30685a[_0x4141f2(0x1f4)](_0x44f55b[_0x4141f2(0x1e4)])&&!_0x30685a[_0x4141f2(0x1f4)](_0x44f55b[_0x4141f2(0x1fc)])&&(_0x30685a=_0x44f55b[_0x4141f2(0x1fe)](_0x4141f2(0x1d3),_0x30685a));try{new URL(_0x30685a);}catch(_0x1fec3e){console[_0x4141f2(0x1f7)](_0x4141f2(0x1cd)+_0x30685a);throw new Error(_0x4141f2(0x1ce));}try{console[_0x4141f2(0x1ff)]('[SCREENSHOT]\x20Using\x20direct\x20Chromium\x20method\x20for\x20URL:\x20'+_0x30685a);const _0x410152=await _0x44f55b[_0x4141f2(0x1ec)](directChromiumScreenshot,_0x30685a);return console[_0x4141f2(0x1ff)](_0x4141f2(0x1fd)),{'image':_0x410152};}catch(_0x10eedb){_0x44f55b[_0x4141f2(0x217)](_0x44f55b[_0x4141f2(0x1ea)],_0x44f55b[_0x4141f2(0x1ea)])?(_0x586254[_0x4141f2(0x1f7)](_0x4141f2(0x1ef)+_0x5de41e[_0x4141f2(0x208)]),_0x515549[_0x4141f2(0x1ff)](_0x4141f2(0x1eb))):(console[_0x4141f2(0x1f7)](_0x4141f2(0x1ef)+_0x10eedb[_0x4141f2(0x208)]),console[_0x4141f2(0x1ff)](_0x4141f2(0x1eb)));}let _0xf0e1d4=null;try{console[_0x4141f2(0x1ff)](_0x4141f2(0x1cb)),_0xf0e1d4=await _0x473bb4[_0x4141f2(0x216)]({'args':[..._0x1681ed[_0x4141f2(0x1fa)],_0x44f55b[_0x4141f2(0x1f8)]],'defaultViewport':{'width':0x320,'height':0x258},'executablePath':process[_0x4141f2(0x1ee)][_0x4141f2(0x204)]||'/usr/bin/chromium','headless':!![],'ignoreHTTPSErrors':!![],'ignoreDefaultArgs':[_0x44f55b['IaFnL']]}),console['log'](_0x4141f2(0x213));let _0x2279f8=await _0xf0e1d4[_0x4141f2(0x1dd)]();console[_0x4141f2(0x1ff)](_0x4141f2(0x215)),await _0x2279f8['emulateMediaFeatures']([{'name':_0x4141f2(0x1dc),'value':_0x4141f2(0x1d2)}]),_0x2279f8[_0x4141f2(0x202)](0x1f40),console['log']('[SCREENSHOT]\x20Navigating\x20to\x20URL:\x20'+_0x30685a),await _0x2279f8[_0x4141f2(0x1e5)](_0x30685a,{'waitUntil':_0x44f55b[_0x4141f2(0x1f3)]}),console[_0x4141f2(0x1ff)]('[SCREENSHOT]\x20Checking\x20if\x20body\x20element\x20exists'),await _0x2279f8[_0x4141f2(0x206)](()=>{const _0xc14730='body';return new Promise((_0xb0de70,_0x2b4981)=>{const _0x3d484a=document['querySelector'](_0xc14730);!_0x3d484a&&_0x2b4981(new Error('Error:\x20No\x20element\x20found\x20with\x20selector:\x20'+_0xc14730)),_0xb0de70();});}),console[_0x4141f2(0x1ff)](_0x4141f2(0x1d8));const _0x3fdfe0=await _0x2279f8[_0x4141f2(0x1d4)]();console[_0x4141f2(0x1ff)](_0x4141f2(0x1da));const _0x473f81=_0x3fdfe0['toString'](_0x4141f2(0x1e8));return console['log'](_0x4141f2(0x214)),{'image':_0x473f81};}catch(_0x16de37){console[_0x4141f2(0x1f7)](_0x4141f2(0x211)+_0x16de37[_0x4141f2(0x208)]);throw _0x16de37;}finally{if(_0x44f55b[_0x4141f2(0x218)](_0x4141f2(0x205),_0x4141f2(0x205))){_0xd81183[_0x4141f2(0x1f7)](_0x4141f2(0x1ca));throw new _0x29dc4a(_0x44f55b[_0x4141f2(0x1d5)]);}else _0x44f55b['nDOZe'](_0xf0e1d4,null)&&(console[_0x4141f2(0x1ff)](_0x4141f2(0x1e7)),await _0xf0e1d4['close']());}};export const handler=_0x37fd74(screenshotHandler);export default handler;