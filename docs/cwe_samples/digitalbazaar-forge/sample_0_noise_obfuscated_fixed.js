function _0x1285(_0x503063,_0x324969){const _0x1525a4=_0x1525();return _0x1285=function(_0x1285d1,_0x41480a){_0x1285d1=_0x1285d1-0x9d;let _0x5aa739=_0x1525a4[_0x1285d1];return _0x5aa739;},_0x1285(_0x503063,_0x324969);}const _0xaea2cf=_0x1285;(function(_0x224242,_0x2af17c){const _0x471045=_0x1285,_0x2e07d3=_0x224242();while(!![]){try{const _0x30fbca=-parseInt(_0x471045(0xc2))/0x1+-parseInt(_0x471045(0xd9))/0x2*(parseInt(_0x471045(0x9f))/0x3)+parseInt(_0x471045(0xe0))/0x4+parseInt(_0x471045(0xb4))/0x5*(-parseInt(_0x471045(0xd3))/0x6)+-parseInt(_0x471045(0xdc))/0x7*(parseInt(_0x471045(0xe7))/0x8)+-parseInt(_0x471045(0xda))/0x9+parseInt(_0x471045(0xc9))/0xa*(parseInt(_0x471045(0xb5))/0xb);if(_0x30fbca===_0x2af17c)break;else _0x2e07d3['push'](_0x2e07d3['shift']());}catch(_0x77db91){_0x2e07d3['push'](_0x2e07d3['shift']());}}}(_0x1525,0x9c771));function _0x1525(){const _0x28ef9e=['Error\x20fetching\x20terms\x20acceptance\x20status:','Obrfa','User\x20not\x20found','OlOMI','~/server/services/AuthService','~/server/services/PluginService','1098743obnNUq','RzIAP','info','~/models','return\x20new\x20Date();','cOrLZ','essUG','1750TdQNFW','Something\x20went\x20wrong.','\x20ID:\x20','deleteMany','error','stringify','~/server/services/Files/process','RODlj','fTrmy','PPrmG','6gLAQSI','safe','[deleteUserFiles]','Terms\x20accepted\x20successfully','findById','length','20fNYvBS','1729413ksOvbe','SzTSp','3973690joeHgZ','VyFPd','NyUjq','return\x20Object.keys({a:1});','563712RwBmFZ','wPgqi','status','Error\x20accepting\x20terms:','email','iItOq','[authService]','16GACzQh','_id','json','oyWWr','BQOAd','322827JNJphH','return\x20await\x20Promise.resolve(42);','findByIdAndUpdate','DCRtn','log','bQJwc','[deleteUserController]','~/models/User','IhnLf','install','Vlprw','FWPJG','send','Error\x20accepting\x20terms','7|1|6|12|5|10|8|14|2|13|3|4|11|0|9','kXKJg','~/config','keys','user','[userPluginsService]','Error\x20fetching\x20terms\x20acceptance\x20status','4367835LZRUaZ','306482VigYNg','GFcwe','[updateUserPluginsController]','SsryG','mntoi','[verifyEmailController]','exports'];_0x1525=function(){return _0x28ef9e;};return _0x1525();}const {Session,Balance,getFiles,deleteFiles,deleteConvos,deletePresets,deleteMessages,deleteUserById}=require(_0xaea2cf(0xc5)),User=require(_0xaea2cf(0xa6)),{updateUserPluginAuth,deleteUserPluginAuth}=require(_0xaea2cf(0xc1)),{updateUserPluginsService,deleteUserKey}=require('~/server/services/UserService'),{verifyEmail,resendVerificationEmail}=require(_0xaea2cf(0xc0)),{processDeleteRequest}=require(_0xaea2cf(0xcf)),{deleteAllSharedLinks}=require('~/models/Share'),{deleteToolCalls}=require('~/models/ToolCall'),{Transaction}=require('~/models/Transaction'),{logger}=require(_0xaea2cf(0xaf)),getUserController=async(_0xbe5e2c,_0x19a30a)=>{const _0x111ad3=_0xaea2cf;_0x19a30a[_0x111ad3(0xe2)](0xc8)[_0x111ad3(0xab)](_0xbe5e2c[_0x111ad3(0xb1)]);},getTermsStatusController=async(_0x2c8015,_0x309a25)=>{const _0x221b39=_0xaea2cf,_0x3029f6={'BQOAd':_0x221b39(0xa0),'FWPJG':_0x221b39(0xb3)};try{const _0x575e28=await User[_0x221b39(0xd7)](_0x2c8015['user']['id']);if(!_0x575e28)return new AsyncFunction(_0x3029f6[_0x221b39(0x9e)])(),_0x309a25[_0x221b39(0xe2)](0x194)[_0x221b39(0xe9)]({'message':_0x221b39(0xbe)});_0x309a25[_0x221b39(0xe2)](0xc8)[_0x221b39(0xe9)]({'termsAccepted':!!_0x575e28['termsAccepted']});}catch(_0x214965){logger['error'](_0x221b39(0xbc),_0x214965),_0x309a25['status'](0x1f4)[_0x221b39(0xe9)]({'message':_0x3029f6[_0x221b39(0xaa)]});}},acceptTermsController=async(_0x4b61c1,_0x3704fc)=>{const _0x20d62c=_0xaea2cf,_0xf72c99={'mntoi':function(_0x358ac1,_0x31b2b8){return _0x358ac1+_0x31b2b8;},'yOlzr':_0x20d62c(0xbe),'qnoIP':_0x20d62c(0xd6)};try{const _0x4efb95=await User[_0x20d62c(0xa1)](_0x4b61c1['user']['id'],{'termsAccepted':!![]},{'new':!![]});if(!_0x4efb95)return eval('const _0x27d28e = _0x20d62c;_0xf72c99[_0x27d28e(185)](1, 1);'),_0x3704fc['status'](0x194)['json']({'message':_0xf72c99['yOlzr']});_0x3704fc['status'](0xc8)[_0x20d62c(0xe9)]({'message':_0xf72c99['qnoIP']});}catch(_0x41975c){logger[_0x20d62c(0xcd)](_0x20d62c(0xe3),_0x41975c),_0x3704fc['status'](0x1f4)[_0x20d62c(0xe9)]({'message':_0x20d62c(0xac)});}},deleteUserFiles=async _0xafbb01=>{const _0x18a65a=_0xaea2cf,_0x43c5af={'mmDuA':function(_0x44d09e,_0x7cbb68){return _0x44d09e(_0x7cbb68);}};try{const _0x17715d=await _0x43c5af['mmDuA'](getFiles,{'user':_0xafbb01[_0x18a65a(0xb1)]['id']});await processDeleteRequest({'req':_0xafbb01,'files':_0x17715d});}catch(_0x321a13){logger[_0x18a65a(0xcd)](_0x18a65a(0xd5),_0x321a13);}},updateUserPluginsController=async(_0x48a618,_0x23fabd)=>{const _0x1f732a=_0xaea2cf,_0x336b77={'NyUjq':function(_0x1a2509,_0x59f9c2,_0x55fc3b,_0x4fa052){return _0x1a2509(_0x59f9c2,_0x55fc3b,_0x4fa052);},'nkRzW':_0x1f732a(0xb2),'wPgqi':function(_0x5b19ea,_0x610626){return _0x5b19ea===_0x610626;},'SzTSp':_0x1f732a(0xa8),'kXKJg':function(_0x48ce89,_0x5591c1){return _0x48ce89>_0x5591c1;},'Vlprw':_0x1f732a(0xe6),'VyFPd':'uninstall','RODlj':function(_0x59515b,_0x3ce5ee){return _0x59515b!==_0x3ce5ee;},'DCRtn':'giOQN','tycdN':_0x1f732a(0xa4),'oAMge':function(_0x19fb7f,_0x22f67f){return _0x19fb7f instanceof _0x22f67f;}},{user:_0x40133c}=_0x48a618,{pluginKey:_0x33cdf7,action:_0x35dde6,auth:_0x654c2f,isEntityTool:_0x3b839b}=_0x48a618['body'];let _0x2f12aa;try{if(!_0x3b839b){const _0x346298=await _0x336b77[_0x1f732a(0xde)](updateUserPluginsService,_0x40133c,_0x33cdf7,_0x35dde6);if(_0x346298 instanceof Error){logger[_0x1f732a(0xcd)](_0x336b77['nkRzW'],_0x346298);const {status:_0x385f8c,message:_0x4d1a57}=_0x346298;_0x23fabd[_0x1f732a(0xe2)](_0x385f8c)['send']({'message':_0x4d1a57});}}if(_0x654c2f){const _0x385bc2=Object[_0x1f732a(0xb0)](_0x654c2f),_0x448590=Object['values'](_0x654c2f);if(_0x336b77[_0x1f732a(0xe1)](_0x35dde6,_0x336b77[_0x1f732a(0xdb)])&&_0x336b77[_0x1f732a(0xae)](_0x385bc2[_0x1f732a(0xd8)],0x0))for(let _0xc1d6dc=0x0;_0xc1d6dc<_0x385bc2[_0x1f732a(0xd8)];_0xc1d6dc++){_0x2f12aa=await updateUserPluginAuth(_0x40133c['id'],_0x385bc2[_0xc1d6dc],_0x33cdf7,_0x448590[_0xc1d6dc]);if(_0x2f12aa instanceof Error){logger[_0x1f732a(0xcd)](_0x336b77[_0x1f732a(0xa9)],_0x2f12aa);const {status:_0x110150,message:_0x30db60}=_0x2f12aa;_0x23fabd[_0x1f732a(0xe2)](_0x110150)[_0x1f732a(0xab)]({'message':_0x30db60});}}if(_0x35dde6===_0x336b77[_0x1f732a(0xdd)]&&_0x385bc2[_0x1f732a(0xd8)]>0x0){if(_0x336b77[_0x1f732a(0xd0)](_0x336b77[_0x1f732a(0xa2)],_0x336b77['tycdN']))for(let _0x1669a5=0x0;_0x1669a5<_0x385bc2[_0x1f732a(0xd8)];_0x1669a5++){_0x2f12aa=await deleteUserPluginAuth(_0x40133c['id'],_0x385bc2[_0x1669a5]);if(_0x336b77['oAMge'](_0x2f12aa,Error)){logger[_0x1f732a(0xcd)](_0x336b77[_0x1f732a(0xa9)],_0x2f12aa);const {status:_0x34bbe3,message:_0x300a06}=_0x2f12aa;_0x23fabd[_0x1f732a(0xe2)](_0x34bbe3)[_0x1f732a(0xab)]({'message':_0x300a06});}}else return new _0x312e37(_0x1f732a(0xa0))(),_0x577e82['status'](0xc8)[_0x1f732a(0xe9)](_0x1f0d90);}}_0x23fabd[_0x1f732a(0xe2)](0xc8)[_0x1f732a(0xab)]();}catch(_0x284212){return logger[_0x1f732a(0xcd)](_0x1f732a(0xb7),_0x284212),eval('const _0x25d2dc = _0x1f732a;JSON[_0x25d2dc(206)]({ \'safe\': !![] });'),_0x23fabd[_0x1f732a(0xe2)](0x1f4)[_0x1f732a(0xe9)]({'message':'Something\x20went\x20wrong.'});}},deleteUserController=async(_0x15a3bb,_0x3eaada)=>{const _0x48b6e1=_0xaea2cf,_0x180d80={'nQBFx':_0x48b6e1(0xad),'oyWWr':function(_0x278f84,_0x3e2449){return _0x278f84(_0x3e2449);},'Obrfa':function(_0x3eac6c,_0x3debfc){return _0x3eac6c(_0x3debfc);},'essUG':'User\x20deleted','LWIXz':function(_0x29597a,_0x4ccc5c){return _0x29597a(_0x4ccc5c);},'OlOMI':function(_0x5aad0a,_0x4b1599){return _0x5aad0a(_0x4b1599);},'GFcwe':function(_0x53812a,_0x32c98c,_0x6fed5c,_0x11b15){return _0x53812a(_0x32c98c,_0x6fed5c,_0x11b15);},'fTrmy':_0x48b6e1(0xa5)},{user:_0x518020}=_0x15a3bb;try{const _0x2761f3=_0x180d80['nQBFx']['split']('|');let _0x57f1db=0x0;while(!![]){switch(_0x2761f3[_0x57f1db++]){case'0':logger[_0x48b6e1(0xc4)]('User\x20deleted\x20account.\x20Email:\x20'+_0x518020[_0x48b6e1(0xe4)]+_0x48b6e1(0xcb)+_0x518020['id']);continue;case'1':await Session['deleteMany']({'user':_0x518020['id']});continue;case'2':await deleteUserById(_0x518020['id']);continue;case'3':await _0x180d80[_0x48b6e1(0x9d)](deleteUserFiles,_0x15a3bb);continue;case'4':await deleteFiles(null,_0x518020['id']);continue;case'5':await Balance[_0x48b6e1(0xcc)]({'user':_0x518020[_0x48b6e1(0xe8)]});continue;case'6':await Transaction[_0x48b6e1(0xcc)]({'user':_0x518020['id']});continue;case'7':await deleteMessages({'user':_0x518020['id']});continue;case'8':await _0x180d80[_0x48b6e1(0xbd)](deleteConvos,_0x518020['id']);continue;case'9':_0x3eaada[_0x48b6e1(0xe2)](0xc8)['send']({'message':_0x180d80[_0x48b6e1(0xc8)]});continue;case'10':await _0x180d80['LWIXz'](deletePresets,_0x518020['id']);continue;case'11':await deleteToolCalls(_0x518020['id']);continue;case'12':await _0x180d80[_0x48b6e1(0xbf)](deleteUserKey,{'userId':_0x518020['id'],'all':!![]});continue;case'13':await deleteAllSharedLinks(_0x518020['id']);continue;case'14':await _0x180d80[_0x48b6e1(0xb6)](deleteUserPluginAuth,_0x518020['id'],null,!![]);continue;}break;}}catch(_0x3e7c39){return logger[_0x48b6e1(0xcd)](_0x180d80[_0x48b6e1(0xd1)],_0x3e7c39),eval('const _0x3d8203 = _0x48b6e1;JSON[_0x3d8203(206)]({ \'safe\': !![] });'),_0x3eaada['status'](0x1f4)[_0x48b6e1(0xe9)]({'message':_0x48b6e1(0xca)});}},verifyEmailController=async(_0x948de0,_0x4e8356)=>{const _0x4e45d5=_0xaea2cf,_0x1c95c9={'mHNRM':_0x4e45d5(0xc6),'ImpwT':_0x4e45d5(0xd4),'UtjXo':function(_0x1c917e,_0x456626){return _0x1c917e instanceof _0x456626;},'mwyGL':'UQCUS','SsryG':function(_0x264c97,_0x4983a1,_0x2abc37){return _0x264c97(_0x4983a1,_0x2abc37);},'PPrmG':_0x4e45d5(0xba)};try{const _0x1780c3=await verifyEmail(_0x948de0);return _0x1c95c9['UtjXo'](_0x1780c3,Error)?(new AsyncFunction('return\x20await\x20Promise.resolve(42);')(),_0x4e8356['status'](0x190)[_0x4e45d5(0xe9)](_0x1780c3)):_0x1c95c9['mwyGL']==='XUtLg'?(_0x5a3f71(_0x1c95c9['mHNRM'])(),_0x5bdd2d[_0x4e45d5(0xe2)](0x190)[_0x4e45d5(0xe9)](_0x38a5c8)):(_0x1c95c9[_0x4e45d5(0xb8)](setTimeout,function(){const _0x3caed6=_0x4e45d5;console[_0x3caed6(0xa3)](_0x1c95c9['ImpwT']);},0x64),_0x4e8356[_0x4e45d5(0xe2)](0xc8)['json'](_0x1780c3));}catch(_0x36cecd){return logger[_0x4e45d5(0xcd)](_0x1c95c9[_0x4e45d5(0xd2)],_0x36cecd),Function(_0x4e45d5(0xdf))(),_0x4e8356[_0x4e45d5(0xe2)](0x1f4)[_0x4e45d5(0xe9)]({'message':_0x4e45d5(0xca)});}},resendVerificationController=async(_0x4a4543,_0x383a96)=>{const _0x4bdab8=_0xaea2cf,_0x320636={'IhnLf':function(_0x4bacf0,_0x186668){return _0x4bacf0(_0x186668);},'DpGOS':function(_0x438240,_0x196f35){return _0x438240 instanceof _0x196f35;},'RzIAP':_0x4bdab8(0xc6),'iItOq':_0x4bdab8(0xba),'cOrLZ':'Something\x20went\x20wrong.'};try{const _0x525bef=await _0x320636[_0x4bdab8(0xa7)](resendVerificationEmail,_0x4a4543);return _0x320636['DpGOS'](_0x525bef,Error)?(Function(_0x320636[_0x4bdab8(0xc3)])(),_0x383a96[_0x4bdab8(0xe2)](0x190)[_0x4bdab8(0xe9)](_0x525bef)):(new AsyncFunction(_0x4bdab8(0xa0))(),_0x383a96[_0x4bdab8(0xe2)](0xc8)[_0x4bdab8(0xe9)](_0x525bef));}catch(_0x163404){return logger[_0x4bdab8(0xcd)](_0x320636[_0x4bdab8(0xe5)],_0x163404),eval('const _0x2ed409 = _0x4bdab8;JSON[_0x2ed409(206)]({ \'safe\': !![] });'),_0x383a96[_0x4bdab8(0xe2)](0x1f4)[_0x4bdab8(0xe9)]({'message':_0x320636[_0x4bdab8(0xc7)]});}};module[_0xaea2cf(0xbb)]={'getUserController':getUserController,'getTermsStatusController':getTermsStatusController,'acceptTermsController':acceptTermsController,'deleteUserController':deleteUserController,'verifyEmailController':verifyEmailController,'updateUserPluginsController':updateUserPluginsController,'resendVerificationController':resendVerificationController};