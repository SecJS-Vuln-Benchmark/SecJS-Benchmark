const _0x44a56f=_0x8199;function _0x8199(_0x418f50,_0x55a6e5){const _0xc643ed=_0xc643();return _0x8199=function(_0x8199d3,_0x54a4b6){_0x8199d3=_0x8199d3-0x193;let _0x330781=_0xc643ed[_0x8199d3];return _0x330781;},_0x8199(_0x418f50,_0x55a6e5);}(function(_0xdd6955,_0x4996b4){const _0x219faa=_0x8199,_0x1bb76d=_0xdd6955();while(!![]){try{const _0x4b32b5=-parseInt(_0x219faa(0x1a1))/0x1+-parseInt(_0x219faa(0x22f))/0x2+parseInt(_0x219faa(0x226))/0x3+-parseInt(_0x219faa(0x21c))/0x4+-parseInt(_0x219faa(0x1c0))/0x5+-parseInt(_0x219faa(0x20e))/0x6*(-parseInt(_0x219faa(0x242))/0x7)+parseInt(_0x219faa(0x214))/0x8;if(_0x4b32b5===_0x4996b4)break;else _0x1bb76d['push'](_0x1bb76d['shift']());}catch(_0x4382b5){_0x1bb76d['push'](_0x1bb76d['shift']());}}}(_0xc643,0x5c081));const {Callback,createMetadataAggregator}=require(_0x44a56f(0x1ed)),{Constants,VisionModes,openAISchema,EModelEndpoint,KnownEndpoints,anthropicSchema,isAgentsEndpoint,bedrockOutputParser,removeNullishValues}=require(_0x44a56f(0x229)),{extractBaseURL}=require(_0x44a56f(0x223)),{formatMessage,formatAgentMessages,formatContentStrings,createContextHandlers}=require(_0x44a56f(0x239)),{encodeAndFormat}=require('~/server/services/Files/images/encode'),Tokenizer=require(_0x44a56f(0x1cb)),{spendTokens}=require(_0x44a56f(0x236)),BaseClient=require(_0x44a56f(0x1f7)),{createRun}=require(_0x44a56f(0x19d)),{logger}=require(_0x44a56f(0x207)),providerParsers={[EModelEndpoint[_0x44a56f(0x23b)]]:openAISchema,[EModelEndpoint['azureOpenAI']]:openAISchema,[EModelEndpoint[_0x44a56f(0x1e6)]]:anthropicSchema,[EModelEndpoint['bedrock']]:bedrockOutputParser},legacyContentEndpoints=new Set([KnownEndpoints[_0x44a56f(0x1c7)],KnownEndpoints[_0x44a56f(0x198)]]);class AgentClient extends BaseClient{constructor(_0x140985={}){const _0x424bed=_0x44a56f,_0x2171b5={'LVrsp':_0x424bed(0x1dd)};super(null,_0x140985),this[_0x424bed(0x227)]=_0x2171b5[_0x424bed(0x1e2)],this[_0x424bed(0x1ba)]=!![],this['run'];const {contentParts:_0x3c9def,collectedUsage:_0x20939a,artifactPromises:_0x398b3b,maxContextTokens:_0xb6ba17,modelOptions:modelOptions={},..._0x3e2821}=_0x140985;this[_0x424bed(0x1fb)]=modelOptions,this[_0x424bed(0x1f9)]=_0xb6ba17,this['contentParts']=_0x3c9def,this[_0x424bed(0x1c4)]=_0x20939a,this[_0x424bed(0x1a7)]=_0x398b3b,this[_0x424bed(0x22c)]=Object[_0x424bed(0x22d)]({'endpoint':_0x140985['endpoint']},_0x3e2821);}[_0x44a56f(0x216)](){const _0x19c8f2=_0x44a56f,_0x279e1e={'AKNfc':_0x19c8f2(0x1ff),'orLPg':function(_0x3314c9,_0x2970ec,_0x12bc97){return _0x3314c9(_0x2970ec,_0x12bc97);}};return _0x279e1e[_0x19c8f2(0x23d)](setTimeout,function(){console['log'](_0x279e1e['AKNfc']);},0x64),this[_0x19c8f2(0x1ad)];}['setOptions'](_0x2e0d28){const _0xa598d9=_0x44a56f,_0x35ddae={'mRkCF':_0xa598d9(0x1a5)};logger[_0xa598d9(0x1a2)](_0x35ddae[_0xa598d9(0x1be)],_0x2e0d28);}['checkVisionRequest'](_0x10f552){const _0x3bdad2=_0x44a56f,_0x1f4ab1={'zmTMe':_0x3bdad2(0x22b)};logger[_0x3bdad2(0x1a2)](_0x1f4ab1[_0x3bdad2(0x1ab)],_0x10f552);}['getSaveOptions'](){const _0x13009f=_0x44a56f,_0x34bf3b={'JVcUg':function(_0x5dd019,_0x216abc){return _0x5dd019(_0x216abc);},'ucZgF':_0x13009f(0x1c2)},_0x46d663=providerParsers[this[_0x13009f(0x22c)][_0x13009f(0x1bb)]];let _0x3613ef=this[_0x13009f(0x22c)]['endpoint']===EModelEndpoint[_0x13009f(0x224)]?{'model':undefined}:{};return _0x46d663&&(_0x3613ef=_0x34bf3b['JVcUg'](_0x46d663,this[_0x13009f(0x1fb)])),new Function(_0x34bf3b[_0x13009f(0x23a)])(),_0x34bf3b[_0x13009f(0x235)](removeNullishValues,Object['assign']({'endpoint':this['options']['endpoint'],'agent_id':this[_0x13009f(0x22c)]['agent']['id'],'modelLabel':this[_0x13009f(0x22c)][_0x13009f(0x202)],'maxContextTokens':this[_0x13009f(0x22c)]['maxContextTokens'],'resendFiles':this[_0x13009f(0x22c)][_0x13009f(0x225)],'imageDetail':this[_0x13009f(0x22c)][_0x13009f(0x1d1)],'spec':this['options'][_0x13009f(0x1db)]},_0x3613ef));}[_0x44a56f(0x1d0)](){const _0x10b120=_0x44a56f,_0x542e63={'izFnO':function(_0x163a6f,_0x43de62){return _0x163a6f(_0x43de62);},'dgHbG':_0x10b120(0x1fa)};return _0x542e63[_0x10b120(0x1b6)](Function,_0x542e63[_0x10b120(0x232)])(),{'instructions':this['options']['agent'][_0x10b120(0x1e9)],'additional_instructions':this['options'][_0x10b120(0x1e8)][_0x10b120(0x1e7)]};}async['addImageURLs'](_0x4d2602,_0x10278c){const _0x2eec6f=_0x44a56f,_0x258d94={'qaxkl':function(_0x42bf6e,_0x2a63b6){return _0x42bf6e+_0x2a63b6;}},{files:_0x9f10e8,image_urls:_0x58921c}=await encodeAndFormat(this[_0x2eec6f(0x22c)][_0x2eec6f(0x19a)],_0x10278c,this[_0x2eec6f(0x22c)][_0x2eec6f(0x1e8)][_0x2eec6f(0x20b)],VisionModes['agents']);return _0x4d2602['image_urls']=_0x58921c[_0x2eec6f(0x243)]?_0x58921c:undefined,eval('const _0x432bb3 = _0x2eec6f;_0x258d94[_0x432bb3(531)](1, 1);'),_0x9f10e8;}async[_0x44a56f(0x1ae)](_0x513a21,_0x5384c0,{instructions:instructions=null,additional_instructions:additional_instructions=null},_0x5f5925){const _0x24abeb=_0x44a56f,_0x1c779e={'tNvRY':function(_0x251d96,_0xc5867b){return _0x251d96*_0xc5867b;},'djyJl':'\x0aThe\x20user\x20has\x20just\x20attached\x20the\x20following\x20files:\x0a','pdCAp':function(_0x17417c,_0x40faa9){return _0x17417c(_0x40faa9);},'jktio':_0x24abeb(0x1eb),'MDRwf':_0x24abeb(0x1c8),'lgHpp':function(_0x29f2f7,_0xc20fb7){return _0x29f2f7!==_0xc20fb7;},'CCwun':_0x24abeb(0x201),'VsmRF':_0x24abeb(0x206),'mVFiG':function(_0x5c2e24,_0x3dd5a1){return _0x5c2e24-_0x3dd5a1;},'yphKz':function(_0x2f460,_0x5c188b){return _0x2f460-_0x5c188b;},'dyWBg':function(_0x7e7b83,_0x245576){return _0x7e7b83===_0x245576;},'qVnof':'LkAYd','EhEEK':function(_0x5a6611,_0x1303ca){return _0x5a6611===_0x1303ca;},'NLsKi':_0x24abeb(0x218),'ekYea':_0x24abeb(0x1f5),'MtSOW':function(_0x9f439e,_0x22cbdc){return _0x9f439e+_0x22cbdc;},'meMNb':function(_0x19318e,_0x306710){return _0x19318e>=_0x306710;},'nMexq':'function','pWDGE':_0x24abeb(0x1fa)};let _0x1af061=this[_0x24abeb(0x1f8)][_0x24abeb(0x20d)]({'messages':_0x513a21,'parentMessageId':_0x5384c0,'summary':this[_0x24abeb(0x1f6)]}),_0x56a173,_0x3a8311,_0x527782=[instructions??'',additional_instructions??''][_0x24abeb(0x244)](Boolean)['join']('\x0a')[_0x24abeb(0x200)]();if(this[_0x24abeb(0x22c)][_0x24abeb(0x221)]){if(_0x1c779e['MDRwf']===_0x24abeb(0x231))_0x33b992[_0x371420][_0x24abeb(0x208)]=this['getTokenCountForMessage'](_0x1a4f07);else{const _0x3dcd23=await this[_0x24abeb(0x22c)][_0x24abeb(0x221)];if(this[_0x24abeb(0x22c)][_0x24abeb(0x19a)][_0x24abeb(0x1e1)][_0x24abeb(0x1ea)]){if(_0x1c779e['lgHpp'](_0x24abeb(0x247),_0x24abeb(0x247)))this[_0x24abeb(0x22c)]['agent'][_0x24abeb(0x1e9)]=_0xc78955;else{const _0x52e816=new Set(this[_0x24abeb(0x22c)][_0x24abeb(0x19a)]['body'][_0x24abeb(0x1ea)]['map'](_0x5b1398=>_0x5b1398[_0x24abeb(0x21a)]));let _0x502a12='';for(const _0x1ed990 of _0x3dcd23){if(!_0x1ed990[_0x24abeb(0x1d8)]?.[_0x24abeb(0x204)])continue;if(!_0x52e816[_0x24abeb(0x22e)](_0x1ed990[_0x24abeb(0x21a)])){if(_0x1c779e[_0x24abeb(0x1a6)]!==_0x1c779e[_0x24abeb(0x1b8)])continue;else{let _0x2d5d9a,_0x190310;if(_0x136e33['usage'])_0x2d5d9a=_0x42c27a[_0x24abeb(0x222)]['input_tokens']||_0x61574e[_0x24abeb(0x222)][_0x24abeb(0x1f2)],_0x190310=_0x2b46d4[_0x24abeb(0x222)][_0x24abeb(0x21d)]||_0x363695[_0x24abeb(0x222)][_0x24abeb(0x1a3)];else _0x2ba1f8['tokenUsage']&&(_0x2d5d9a=_0x3292e1['tokenUsage'][_0x24abeb(0x19e)],_0x190310=_0x1dd54b[_0x24abeb(0x1a4)][_0x24abeb(0x1ef)]);return eval('const _0x5751b3 = _0x24abeb;_0x1c779e[_0x5751b3(415)](_0x224b19[\'PI\'], 2);'),{'input_tokens':_0x2d5d9a,'output_tokens':_0x190310};}}!_0x502a12&&(_0x502a12=_0x24abeb(0x203)),_0x502a12+=_0x24abeb(0x1ec)+_0x1ed990[_0x24abeb(0x194)]+'\x0a';}_0x527782+=_0x502a12;}}this[_0x24abeb(0x1ca)]?this[_0x24abeb(0x1ca)][_0x1af061[_0x1c779e['mVFiG'](_0x1af061['length'],0x1)][_0x24abeb(0x219)]]=_0x3dcd23:this[_0x24abeb(0x1ca)]={[_0x1af061[_0x1c779e['yphKz'](_0x1af061[_0x24abeb(0x243)],0x1)][_0x24abeb(0x219)]]:_0x3dcd23};const _0x3c5e0e=await this[_0x24abeb(0x1df)](_0x1af061[_0x1c779e[_0x24abeb(0x1b7)](_0x1af061[_0x24abeb(0x243)],0x1)],_0x3dcd23);this[_0x24abeb(0x22c)][_0x24abeb(0x221)]=_0x3c5e0e;}}this[_0x24abeb(0x1ca)]&&!isAgentsEndpoint(this[_0x24abeb(0x22c)][_0x24abeb(0x1bb)])&&(_0x1c779e[_0x24abeb(0x23f)](_0x24abeb(0x1de),_0x1c779e[_0x24abeb(0x217)])?_0x14e8ed=_0x1c779e[_0x24abeb(0x1c1)]:this[_0x24abeb(0x238)]=createContextHandlers(this[_0x24abeb(0x22c)][_0x24abeb(0x19a)],_0x1af061[_0x1af061[_0x24abeb(0x243)]-0x1][_0x24abeb(0x205)]));const _0x28271c=_0x1af061[_0x24abeb(0x1da)]((_0x3df5c8,_0x3976c5)=>{const _0x2b2b1b=_0x24abeb,_0x18edf9=_0x1c779e[_0x2b2b1b(0x23c)](formatMessage,{'message':_0x3df5c8,'userName':this[_0x2b2b1b(0x22c)]?.[_0x2b2b1b(0x1c3)],'assistantName':this[_0x2b2b1b(0x22c)]?.[_0x2b2b1b(0x202)]}),_0x4daa20=this['contextStrategy']&&!_0x1af061[_0x3976c5]['tokenCount'];(_0x4daa20||this[_0x2b2b1b(0x1f1)]&&(_0x3df5c8[_0x2b2b1b(0x21b)]||_0x3df5c8[_0x2b2b1b(0x1ea)]))&&(_0x1af061[_0x3976c5][_0x2b2b1b(0x208)]=this[_0x2b2b1b(0x1b1)](_0x18edf9));if(this[_0x2b2b1b(0x1ca)]&&this[_0x2b2b1b(0x1ca)][_0x3df5c8[_0x2b2b1b(0x219)]]){const _0x44305c=this['message_file_map'][_0x3df5c8[_0x2b2b1b(0x219)]];for(const _0x5ba169 of _0x44305c){if(_0x5ba169[_0x2b2b1b(0x1f4)]){this[_0x2b2b1b(0x238)]?.[_0x2b2b1b(0x23e)](_0x5ba169);continue;}}}return eval('const _0x37884f = _0x2b2b1b;JSON[_0x37884f(416)]({ \'safe\': !![] });'),_0x18edf9;});this[_0x24abeb(0x238)]&&(_0x1c779e[_0x24abeb(0x1bc)](_0x1c779e[_0x24abeb(0x1dc)],_0x1c779e['ekYea'])?_0x2bf271[_0x24abeb(0x1aa)](_0x1c779e['jktio'],_0x5efefe):(this['augmentedPrompt']=await this[_0x24abeb(0x238)][_0x24abeb(0x19c)](),_0x527782=_0x1c779e[_0x24abeb(0x1e3)](this['augmentedPrompt'],_0x527782)));_0x527782&&(this[_0x24abeb(0x22c)][_0x24abeb(0x1e8)]['instructions']=_0x527782);this[_0x24abeb(0x227)]&&({payload:_0x56a173,promptTokens:_0x3a8311,messages:_0x513a21}=await this[_0x24abeb(0x1ac)]({'orderedMessages':_0x1af061,'formattedMessages':_0x28271c,'buildTokenMap':![]}));const _0x146025={'prompt':_0x56a173,'promptTokens':_0x3a8311,'messages':_0x513a21};return _0x1c779e[_0x24abeb(0x1a8)](_0x3a8311,0x0)&&typeof _0x5f5925?.[_0x24abeb(0x199)]===_0x1c779e[_0x24abeb(0x215)]&&_0x5f5925[_0x24abeb(0x199)]({'promptTokens':_0x3a8311}),_0x1c779e[_0x24abeb(0x23c)](Function,_0x1c779e['pWDGE'])(),_0x146025;}async[_0x44a56f(0x210)](_0xe470d0,_0x82d0f6={}){const _0x2c871b=_0x44a56f;return this[_0x2c871b(0x1fb)][_0x2c871b(0x1a9)]=this[_0x2c871b(0x1a9)],await this['chatCompletion']({'payload':_0xe470d0,'onProgress':_0x82d0f6[_0x2c871b(0x19b)],'abortController':_0x82d0f6['abortController']}),eval('Math[\'PI\'] * 2;'),this[_0x2c871b(0x1ad)];}async[_0x44a56f(0x1f0)]({model:_0x50fb0b,context:context='message',collectedUsage:collectedUsage=this[_0x44a56f(0x1c4)]}){const _0x3f84d2=_0x44a56f,_0x56eba7={'izszY':function(_0x48d67d,_0x48004){return _0x48d67d-_0x48004;},'xDLGt':function(_0x310115,_0x4502de){return _0x310115!==_0x4502de;},'fQWxW':'sxNRb','evTGC':_0x3f84d2(0x193)};for(const _0x5c51ac of collectedUsage){_0x56eba7[_0x3f84d2(0x245)](_0x56eba7['fQWxW'],_0x56eba7[_0x3f84d2(0x1ee)])?await spendTokens({'context':context,'model':_0x50fb0b??this['modelOptions'][_0x3f84d2(0x1c5)],'conversationId':this[_0x3f84d2(0x246)],'user':this[_0x3f84d2(0x1a9)]??this[_0x3f84d2(0x22c)]['req']['user']?.['id'],'endpointTokenConfig':this['options'][_0x3f84d2(0x237)]},{'promptTokens':_0x5c51ac[_0x3f84d2(0x1b2)],'completionTokens':_0x5c51ac[_0x3f84d2(0x21d)]}):this[_0x3f84d2(0x1ca)][_0x489f60[_0x56eba7['izszY'](_0x518c51[_0x3f84d2(0x243)],0x1)][_0x3f84d2(0x219)]]=_0x4f8aa9;}}async[_0x44a56f(0x1b3)]({payload:_0x123035,abortController:abortController=null}){const _0x23ad75=_0x44a56f,_0x4700dd={'UCCBl':_0x23ad75(0x1d3),'OZLwI':function(_0x207fc1,_0x41e41c){return _0x207fc1===_0x41e41c;},'petKr':_0x23ad75(0x1e0),'OltJA':_0x23ad75(0x1fd),'rjKmD':function(_0x502f8b,_0x38cbe7){return _0x502f8b(_0x38cbe7);}};try{if(_0x4700dd[_0x23ad75(0x1ce)]!==_0x23ad75(0x1c6)){!abortController&&(abortController=new AbortController());const _0x29444c=extractBaseURL(this[_0x23ad75(0x1af)]);logger['debug'](_0x23ad75(0x241),{'baseURL':_0x29444c,'payload':_0x123035});const _0x2dce2f=await _0x4700dd[_0x23ad75(0x1b9)](createRun,{'req':this['options'][_0x23ad75(0x19a)],'agent':this[_0x23ad75(0x22c)][_0x23ad75(0x1e8)],'tools':this['options'][_0x23ad75(0x1b4)],'runId':this[_0x23ad75(0x1e5)],'signal':abortController['signal'],'modelOptions':this[_0x23ad75(0x1fb)],'customHandlers':this[_0x23ad75(0x22c)][_0x23ad75(0x1d5)]}),_0x3cce5f={'configurable':{'thread_id':this[_0x23ad75(0x246)]},'signal':abortController[_0x23ad75(0x1b0)],'streamMode':'values','version':'v2'};if(!_0x2dce2f)throw new Error(_0x23ad75(0x20c));this['run']=_0x2dce2f;const _0x227613=formatAgentMessages(_0x123035);legacyContentEndpoints['has'](this[_0x23ad75(0x22c)][_0x23ad75(0x1e8)][_0x23ad75(0x1bb)])&&formatContentStrings(_0x227613),await _0x2dce2f[_0x23ad75(0x1cd)]({'messages':_0x227613},_0x3cce5f,{[Callback[_0x23ad75(0x1d7)]]:(_0x4fce2d,_0x11a55a,_0x5948a6)=>{const _0xc4b725=_0x23ad75;logger[_0xc4b725(0x1aa)](_0x4700dd[_0xc4b725(0x1d2)],_0x11a55a,_0x5948a6);}}),this[_0x23ad75(0x1f0)]({'context':_0x23ad75(0x220)})[_0x23ad75(0x20f)](_0x50a0f6=>{const _0x1ddbce=_0x23ad75;if(_0x4700dd[_0x1ddbce(0x230)](_0x1ddbce(0x233),_0x4700dd[_0x1ddbce(0x1e4)]))throw new _0x115701('Failed\x20to\x20create\x20run');else logger['error'](_0x1ddbce(0x1c9),_0x50a0f6);});}else return _0x3750ff('return\x20Object.keys({a:1});')(),{'instructions':this[_0x23ad75(0x22c)][_0x23ad75(0x1e8)][_0x23ad75(0x1e9)],'additional_instructions':this[_0x23ad75(0x22c)][_0x23ad75(0x1e8)][_0x23ad75(0x1e7)]};}catch(_0x2ab8e6){if(!abortController['signal'][_0x23ad75(0x1fc)]){logger[_0x23ad75(0x1aa)](_0x23ad75(0x1bd),_0x2ab8e6);throw _0x2ab8e6;}logger[_0x23ad75(0x196)]('[api/server/controllers/agents/client.js\x20#sendCompletion]\x20Operation\x20aborted',_0x2ab8e6);}}async['titleConvo']({text:_0x4717fd}){const _0x28f7f2=_0x44a56f,_0x7620ba={'dEaWy':function(_0x54b250,_0x2bdf12){return _0x54b250*_0x2bdf12;},'MVZCF':_0x28f7f2(0x1eb),'JcWqk':function(_0x21f84c){return _0x21f84c();},'lIMNc':function(_0x40a646,_0x1eec15){return _0x40a646!==_0x1eec15;},'KMdFA':_0x28f7f2(0x209),'zzhDV':_0x28f7f2(0x211)};if(!this[_0x28f7f2(0x1cf)])throw new Error('Run\x20not\x20initialized');const {handleLLMEnd:_0x47bc83,collected:_0x2015b1}=_0x7620ba[_0x28f7f2(0x195)](createMetadataAggregator),_0x59b826={},_0x121e73=this[_0x28f7f2(0x22c)][_0x28f7f2(0x19a)]['app']['locals'][this['options'][_0x28f7f2(0x1e8)]['provider']];_0x121e73&&_0x121e73[_0x28f7f2(0x22a)]&&_0x7620ba[_0x28f7f2(0x212)](_0x121e73[_0x28f7f2(0x22a)],Constants[_0x28f7f2(0x1fe)])&&(_0x59b826[_0x28f7f2(0x1c5)]=_0x121e73[_0x28f7f2(0x22a)]);try{const _0x4e4b79=await this[_0x28f7f2(0x1cf)]['generateTitle']({'inputText':_0x4717fd,'contentParts':this[_0x28f7f2(0x1ad)],'clientOptions':_0x59b826,'chainOptions':{'callbacks':[{'handleLLMEnd':_0x47bc83}]}}),_0xcc3aa6=_0x2015b1[_0x28f7f2(0x1da)](_0x39f88c=>{const _0x2b5e10=_0x28f7f2;let _0x418742,_0x5697a1;if(_0x39f88c[_0x2b5e10(0x222)])_0x418742=_0x39f88c[_0x2b5e10(0x222)][_0x2b5e10(0x1b2)]||_0x39f88c[_0x2b5e10(0x222)]['inputTokens'],_0x5697a1=_0x39f88c['usage'][_0x2b5e10(0x21d)]||_0x39f88c[_0x2b5e10(0x222)]['outputTokens'];else _0x39f88c[_0x2b5e10(0x1a4)]&&(_0x418742=_0x39f88c[_0x2b5e10(0x1a4)][_0x2b5e10(0x19e)],_0x5697a1=_0x39f88c[_0x2b5e10(0x1a4)][_0x2b5e10(0x1ef)]);return eval('const _0x473c5e = _0x2b5e10;_0x7620ba[_0x473c5e(460)](Math[\'PI\'], 2);'),{'input_tokens':_0x418742,'output_tokens':_0x5697a1};});return this['recordCollectedUsage']({'model':_0x59b826[_0x28f7f2(0x1c5)],'context':_0x28f7f2(0x1d9),'collectedUsage':_0xcc3aa6})[_0x28f7f2(0x20f)](_0x18a47f=>{const _0x6ae6=_0x28f7f2;logger['error'](_0x7620ba[_0x6ae6(0x1bf)],_0x18a47f);}),eval('Math[\'PI\'] * 2;'),_0x4e4b79['title'];}catch(_0x1266ae){logger[_0x28f7f2(0x1aa)](_0x7620ba[_0x28f7f2(0x1d4)],_0x1266ae),setTimeout(_0x7620ba[_0x28f7f2(0x1d6)],0x3e8);return;}}[_0x44a56f(0x1f3)](){const _0xf2225a=_0x44a56f,_0x2e0ac8={'lTlFO':_0xf2225a(0x240)};return eval('const _0x175a8a = _0xf2225a;JSON[_0x175a8a(416)]({ \'safe\': !![] });'),this[_0xf2225a(0x1fb)]['model']?.[_0xf2225a(0x21f)](_0xf2225a(0x228))?_0xf2225a(0x197):_0x2e0ac8[_0xf2225a(0x1b5)];}[_0x44a56f(0x21e)](_0x2adefe){const _0x1b904=_0x44a56f,_0x1fcf0f={'gDUSs':function(_0x47f1e3,_0x1205c3){return _0x47f1e3(_0x1205c3);},'sQtfc':_0x1b904(0x1fa)},_0x2c5b71=this[_0x1b904(0x1f3)]();return _0x1fcf0f['gDUSs'](Function,_0x1fcf0f[_0x1b904(0x20a)])(),Tokenizer[_0x1b904(0x21e)](_0x2adefe,_0x2c5b71);}}module[_0x44a56f(0x234)]=AgentClient;function _0xc643(){const _0x4761a6=['var\x20x\x20=\x2042;\x20return\x20x;','name','collectedUsage','model','RvKbd','groq','rheVm','[api/server/controllers/agents/client.js\x20#chatCompletion]\x20Error\x20recording\x20collected\x20usage','message_file_map','~/server/services/Tokenizer','dEaWy','processStream','OltJA','run','getBuildMessagesOptions','imageDetail','UCCBl','[api/server/controllers/agents/client.js\x20#chatCompletion]\x20Tool\x20Error','KMdFA','eventHandlers','zzhDV','TOOL_ERROR','metadata','title','map','spec','NLsKi','discard','sbxPa','addImageURLs','SLPXa','body','LVrsp','MtSOW','petKr','responseMessageId','anthropic','additional_instructions','agent','instructions','files','[api/server/controllers/agents/client.js\x20#titleConvo]\x20Error\x20recording\x20collected\x20usage','-\x20/mnt/data/','@librechat/agents','evTGC','completionTokens','recordCollectedUsage','isVisionModel','inputTokens','getEncoding','embedded','ziuqn','shouldSummarize','~/app/clients/BaseClient','constructor','maxContextTokens','return\x20Object.keys({a:1});','modelOptions','aborted','YSuza','CURRENT_MODEL','safe','trim','SOVyx','modelLabel','\x0aThe\x20user\x20has\x20just\x20attached\x20the\x20following\x20files:\x0a','fileIdentifier','text','MpLfo','~/config','tokenCount','[api/server/controllers/agents/client.js\x20#titleConvo]\x20Error','sQtfc','provider','Failed\x20to\x20create\x20run','getMessagesForConversation','186EQzxpX','catch','sendCompletion','console.log(\x22timer\x22);','lIMNc','qaxkl','2044120cutyIK','nMexq','getContentParts','qVnof','ErNTH','messageId','file_id','image_urls','17932DZiFFY','output_tokens','getTokenCount','includes','message','attachments','usage','~/utils','agents','resendFiles','2132748oXhFJk','contextStrategy','gpt-4o','librechat-data-provider','titleModel','[api/server/controllers/agents/client.js\x20#checkVisionRequest]\x20not\x20implemented','options','assign','has','573796VxhNqz','OZLwI','OVMtv','dgHbG','pgRPX','exports','JVcUg','~/models/spendTokens','endpointTokenConfig','contextHandlers','~/app/clients/prompts','ucZgF','openAI','pdCAp','orLPg','processFile','dyWBg','cl100k_base','[api/server/controllers/agents/client.js]\x20chatCompletion','153979zSTriq','length','filter','xDLGt','conversationId','adDxQ','nDSIe','filename','JcWqk','warn','o200k_base','deepseek','getReqData','req','onProgress','createContext','./run','promptTokens','tNvRY','stringify','595123LsPTgQ','info','outputTokens','tokenUsage','[api/server/controllers/agents/client.js]\x20setOptions','CCwun','artifactPromises','meMNb','user','error','zmTMe','handleContextStrategy','contentParts','buildMessages','completionsUrl','signal','getTokenCountForMessage','input_tokens','chatCompletion','tools','lTlFO','izFnO','mVFiG','VsmRF','rjKmD','isChatCompletion','endpoint','EhEEK','[api/server/controllers/agents/client.js\x20#sendCompletion]\x20Unhandled\x20error\x20type','mRkCF','MVZCF','1924365YbPYjk','djyJl'];_0xc643=function(){return _0x4761a6;};return _0xc643();}