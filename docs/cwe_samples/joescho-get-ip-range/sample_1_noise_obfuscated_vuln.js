function _0x1f49(_0x14c083,_0x5d6d66){const _0x555891=_0x5558();return _0x1f49=function(_0x1f49c8,_0x4c1888){_0x1f49c8=_0x1f49c8-0x13f;let _0x34ea2a=_0x555891[_0x1f49c8];return _0x34ea2a;},_0x1f49(_0x14c083,_0x5d6d66);}const _0x3aa1e4=_0x1f49;(function(_0x3d410f,_0x1704fc){const _0x1f06af=_0x1f49,_0x36498e=_0x3d410f();while(!![]){try{const _0x913a48=-parseInt(_0x1f06af(0x160))/0x1+-parseInt(_0x1f06af(0x15f))/0x2+-parseInt(_0x1f06af(0x159))/0x3+parseInt(_0x1f06af(0x13f))/0x4*(-parseInt(_0x1f06af(0x14e))/0x5)+-parseInt(_0x1f06af(0x156))/0x6+-parseInt(_0x1f06af(0x153))/0x7*(parseInt(_0x1f06af(0x167))/0x8)+parseInt(_0x1f06af(0x14c))/0x9;if(_0x913a48===_0x1704fc)break;else _0x36498e['push'](_0x36498e['shift']());}catch(_0x508296){_0x36498e['push'](_0x36498e['shift']());}}}(_0x5558,0x8a591));const fs=require('fs'),path=require(_0x3aa1e4(0x150)),logger=require('../../../utils/logger'),{Error404,Error400}=require(_0x3aa1e4(0x15d)),{validateFilename,validateSessionId}=require('../utils/validateStreamParams'),asyncMiddleware=require(_0x3aa1e4(0x151));module[_0x3aa1e4(0x149)]=function RtspCameraController(_0xd6a513,_0x3e6e4b){const _0xfef0af=_0x3aa1e4,_0x443dc4={'oIbCb':'error','qBqll':function(_0x4b3870,_0x3d056a){return _0x4b3870===_0x3d056a;},'TPvKb':'pXzrs','zfVzs':function(_0x2863dc,_0x5500c8){return _0x2863dc instanceof _0x5500c8;},'umgsB':function(_0x5efcbe,_0x52e5e5){return _0x5efcbe===_0x52e5e5;},'xZyIc':function(_0x4a990b,_0x55b758){return _0x4a990b(_0x55b758);},'TIfzp':function(_0x29f004,_0x5a71e9){return _0x29f004(_0x5a71e9);}};async function _0x5e9309(_0x508f47,_0x3f5799){const _0x419295=_0x1f49,_0x4fbea0=await _0x3e6e4b[_0x419295(0x14a)](_0x508f47['body']);_0x3f5799[_0x419295(0x154)](_0x4fbea0);}async function _0x895295(_0x45060d,_0x20f309){const _0x1bba92=_0x1f49,_0x445fee=await _0x3e6e4b[_0x1bba92(0x15c)](_0x45060d['params']['camera_selector'],_0x45060d[_0x1bba92(0x14b)][_0x1bba92(0x145)],_0x45060d[_0x1bba92(0x14b)]['segment_duration']);_0x20f309[_0x1bba92(0x154)](_0x445fee);}async function _0x49c128(_0x286f72,_0xbfdaee){const _0x554aca=_0x1f49;if(_0x443dc4[_0x554aca(0x14f)](_0x443dc4['TPvKb'],_0x443dc4[_0x554aca(0x144)]))await _0x3e6e4b[_0x554aca(0x162)](_0x286f72[_0x554aca(0x147)][_0x554aca(0x15a)]),_0xbfdaee[_0x554aca(0x154)]({'success':!![]});else{_0x34176c(_0x3488b9[_0x554aca(0x147)][_0x554aca(0x165)]),_0x46b981(_0x1bce97[_0x554aca(0x147)][_0x554aca(0x152)]);const _0x3fa309=_0x51cee3[_0x554aca(0x161)](_0x2676a1[_0x554aca(0x164)]['tempFolder'],_0x468b2d['params'][_0x554aca(0x165)],_0x2d25dd['params'][_0x554aca(0x152)]),_0x165376=_0x443ed5[_0x554aca(0x140)](_0x3fa309);_0x165376['on'](_0x443dc4['oIbCb'],_0x5a7309=>{const _0x2d57a8=_0x554aca;_0x3e82e2[_0x2d57a8(0x15e)](0x194)['end']();}),_0x165376[_0x554aca(0x142)](_0x161d0a);}}async function _0x5a76be(_0xe8a509,_0x43745b){const _0x11be51=_0x1f49;if(_0x443dc4[_0x11be51(0x146)](_0x11be51(0x157),_0x11be51(0x157)))await _0x3e6e4b[_0x11be51(0x15b)](_0xe8a509[_0x11be51(0x147)][_0x11be51(0x15a)]),_0x43745b[_0x11be51(0x154)]({'success':!![]});else{if(_0x443dc4[_0x11be51(0x155)](_0x49d699,_0x18d850))throw _0x61ad2a;_0x41da05[_0x11be51(0x166)](_0x5326a8);throw new _0x54a7ce('FILE_NOT_FOUND');}}async function _0x46934a(_0x5d7a64,_0x1408b7){const _0x460647=_0x1f49;try{_0x443dc4[_0x460647(0x158)](validateSessionId,_0x5d7a64[_0x460647(0x147)][_0x460647(0x165)]),validateFilename(_0x5d7a64['params'][_0x460647(0x152)]);const _0x43860b=path[_0x460647(0x161)](_0xd6a513[_0x460647(0x164)][_0x460647(0x141)],_0x5d7a64['params']['folder'],_0x5d7a64[_0x460647(0x147)][_0x460647(0x152)]),_0x464a75=fs[_0x460647(0x140)](_0x43860b);_0x464a75['on'](_0x460647(0x148),_0x4d9d09=>{const _0xe740b9=_0x460647;_0x1408b7[_0xe740b9(0x15e)](0x194)['end']();}),_0x464a75[_0x460647(0x142)](_0x1408b7);}catch(_0x449a11){if(_0x449a11 instanceof Error400)throw _0x449a11;logger[_0x460647(0x166)](_0x449a11);throw new Error404(_0x460647(0x163));}}return eval('const _0x197714 = _0x1f49;JSON[_0x197714(323)]({ \'safe\': !![] });'),{'post\x20/api/v1/service/rtsp-camera/camera/test':{'authenticated':!![],'admin':!![],'controller':asyncMiddleware(_0x5e9309)},'post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/start':{'authenticated':!![],'admin':![],'controller':asyncMiddleware(_0x895295)},'post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/stop':{'authenticated':!![],'admin':![],'controller':asyncMiddleware(_0x49c128)},'post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/ping':{'authenticated':!![],'admin':![],'controller':_0x443dc4[_0xfef0af(0x14d)](asyncMiddleware,_0x5a76be)},'get\x20/api/v1/service/rtsp-camera/camera/streaming/:folder/:file':{'authenticated':!![],'admin':![],'controller':_0x443dc4[_0xfef0af(0x158)](asyncMiddleware,_0x46934a)}};};function _0x5558(){const _0x5b1585=['getImage','body','21314988VYRNcF','TIfzp','305qMQDnr','qBqll','path','../../../api/middlewares/asyncMiddleware','file','14ufmzcL','send','zfVzs','2449662nWGxrW','wtnhN','xZyIc','760653VFSBix','camera_selector','liveActivePing','startStreamingIfNotStarted','../../../utils/httpErrors','status','370328TEuCMJ','92514gNwGKq','join','stopStreaming','FILE_NOT_FOUND','config','folder','warn','1036184pRRLMl','39548BGQfTc','createReadStream','tempFolder','pipe','stringify','TPvKb','is_gladys_gateway','umgsB','params','error','exports'];_0x5558=function(){return _0x5b1585;};return _0x5558();}