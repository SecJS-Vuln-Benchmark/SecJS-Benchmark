const _0x54a331=_0x2d4a;(function(_0x23e50f,_0x575abd){const _0x3d8cdb=_0x2d4a,_0x3be427=_0x23e50f();while(!![]){try{const _0x50ff06=-parseInt(_0x3d8cdb(0x1ae))/0x1*(-parseInt(_0x3d8cdb(0x19c))/0x2)+parseInt(_0x3d8cdb(0x187))/0x3*(-parseInt(_0x3d8cdb(0x19b))/0x4)+parseInt(_0x3d8cdb(0x1d4))/0x5*(-parseInt(_0x3d8cdb(0x18b))/0x6)+-parseInt(_0x3d8cdb(0x18c))/0x7*(parseInt(_0x3d8cdb(0x186))/0x8)+parseInt(_0x3d8cdb(0x194))/0x9+parseInt(_0x3d8cdb(0x1c9))/0xa+-parseInt(_0x3d8cdb(0x18a))/0xb*(-parseInt(_0x3d8cdb(0x1da))/0xc);if(_0x50ff06===_0x575abd)break;else _0x3be427['push'](_0x3be427['shift']());}catch(_0x14a3ff){_0x3be427['push'](_0x3be427['shift']());}}}(_0x91c1,0xc99a6));const {assert:chaiAssert}=require(_0x54a331(0x1a1)),{assert,fake}=require('sinon'),proxyquire=require(_0x54a331(0x183))['noCallThru'](),fse=require(_0x54a331(0x1c0)),path=require(_0x54a331(0x1c1)),EventEmitter=require(_0x54a331(0x1b0)),RtspCameraController=require(_0x54a331(0x1b7)),RtspCameraControllerWithFsMocked=proxyquire('../../../../services/rtsp-camera/api/rtspCamera.controller',{'fs':{'createReadStream':()=>{const _0x27c910=_0x54a331,_0x36caea=new EventEmitter();return _0x36caea[_0x27c910(0x1d6)]=()=>_0x36caea[_0x27c910(0x1d9)](_0x27c910(0x195)),eval('const _0x58d5b6 = _0x27c910;JSON[_0x58d5b6(451)]({ \'safe\': !![] });'),_0x36caea;}}}),gladys={'config':{'tempFolder':process[_0x54a331(0x197)][_0x54a331(0x1cf)]||_0x54a331(0x1a2)}},rtspCameraService={'getImage':fake[_0x54a331(0x1d0)](_0x54a331(0x1bd)),'startStreamingIfNotStarted':fake[_0x54a331(0x1d0)]({}),'stopStreaming':fake[_0x54a331(0x1d0)]({}),'liveActivePing':fake[_0x54a331(0x1d0)](null)},res={'send':fake[_0x54a331(0x180)](null)};function _0x2d4a(_0x760e19,_0x487536){const _0x91c15e=_0x91c1();return _0x2d4a=function(_0x2d4a3f,_0x2a8e8b){_0x2d4a3f=_0x2d4a3f-0x17e;let _0x1dc610=_0x91c15e[_0x2d4a3f];return _0x1dc610;},_0x2d4a(_0x760e19,_0x487536);}function _0x91c1(){const _0x39d0ef=['proxyquire','nsuZY','dlHcJ','2535696TKmXnX','117fdnWQW','config','should\x20ping\x20streaming','11ofCBpM','6807810ylrCoz','21hZZlDl','GjDNL','calledOnce','safe','JluVG','startStreamingIfNotStarted','createWriteStream','liveActivePing','13693095ILfcjT','error','PbQsq','env','camera\x20controller\x20test','post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/stop','/api/public/status','72236MKfoCf','10aDvcwE','rQHhv','status','RvAIg','should\x20return\x20400,\x20bad\x20request,\x20invalid\x20session\x20id','chai','/tmp/gladys','gZDlu','kYuOS','WGwvr','UCJlj','rvZpH','sFcCK','isRejected','result.txt','should\x20get\x20index.m3u8\x20file','ydneW','should\x20return\x20400,\x20bad\x20request,\x20invalid\x20filename','47639QxRdgZ','.....','events','yOihc','DwaiO','Ecvra','controller','should\x20return\x20404,\x20file\x20not\x20found\x20(throw\x20error)','should\x20start\x20streaming','../../../../services/rtsp-camera/api/rtspCamera.controller','fOPKy','calledWith','index1.ts','camera-1','uGmWx','base64image','ensureDir','aNARi','fs-extra','path','join','stringify','index12212.ts','zBGHE','xRtVx','log','my-camera','5553130OVWrzA','HUkSg','JHrSt','return\x20Object.keys({a:1});','VLXFM','return\x20new\x20Date();','TEMP_FOLDER','resolves','should\x20return\x20404,\x20file\x20not\x20found\x20(res.status)\x20','uYytt','LKXhD','5iequqt','stopStreaming','pipe','tempFolder','should\x20stop\x20streaming','emit','15607500DppZQy','CAMERA_ROTATION','should\x20get\x20index1.ts\x20file','FILE_NOT_FOUND','test-toto-content','post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/start','Invalid\x20session\x20id','get\x20/api/v1/service/rtsp-camera/camera/streaming/:folder/:file','index.m3u8','nxHep','post\x20/api/v1/service/rtsp-camera/camera/test','ZFjiA','jnfJM','returns','writeFile','lalalalala'];_0x91c1=function(){return _0x39d0ef;};return _0x91c1();}describe(_0x54a331(0x198),()=>{const _0x3b9bbf=_0x54a331,_0x5a7cb3={'JHrSt':_0x3b9bbf(0x18f),'fOPKy':'CAMERA_URL','IeqSj':'test','UfjSd':_0x3b9bbf(0x1db),'yOihc':function(_0x3f3b96,_0x1f9e3c,_0x39312f){return _0x3f3b96(_0x1f9e3c,_0x39312f);},'ydneW':_0x3b9bbf(0x1c8),'DwaiO':function(_0x44f8c5,_0x2a7040,_0xe569b0){return _0x44f8c5(_0x2a7040,_0xe569b0);},'uYytt':_0x3b9bbf(0x199),'UCJlj':'post\x20/api/v1/service/rtsp-camera/camera/:camera_selector/streaming/ping','VLXFM':_0x3b9bbf(0x1e2),'aNARi':_0x3b9bbf(0x1bb),'nsuZY':_0x3b9bbf(0x1de),'kYuOS':function(_0xa31fbb,_0x2a11f9,_0x13e2d5){return _0xa31fbb(_0x2a11f9,_0x13e2d5);},'Ecvra':_0x3b9bbf(0x1ba),'GjDNL':_0x3b9bbf(0x1e1),'PbQsq':_0x3b9bbf(0x1c4),'uGmWx':_0x3b9bbf(0x1aa),'xRtVx':function(_0x46b5fb,_0x184be9,_0x85e28d){return _0x46b5fb(_0x184be9,_0x85e28d);},'dlHcJ':function(_0x262d7a,_0x4aee1c,_0x63ad46){return _0x262d7a(_0x4aee1c,_0x63ad46);},'RvAIg':_0x3b9bbf(0x182),'jnfJM':'Invalid\x20filename','rvZpH':_0x3b9bbf(0x1e0),'rQHhv':'should\x20return\x20an\x20image','sFcCK':function(_0x3c012a,_0x454aad,_0x6803ec){return _0x3c012a(_0x454aad,_0x6803ec);},'sWjyb':_0x3b9bbf(0x1d8),'JluVG':function(_0x38d3e5,_0x22ac70,_0x3609a8){return _0x38d3e5(_0x22ac70,_0x3609a8);},'HUkSg':_0x3b9bbf(0x1dc),'ZFjiA':function(_0x2ea798,_0x4ab012){return _0x2ea798(_0x4ab012);},'gZDlu':_0x3b9bbf(0x1cc),'nxHep':function(_0x274b86,_0xe2cf21){return _0x274b86(_0xe2cf21);},'aJjVI':_0x3b9bbf(0x1ce),'zBGHE':_0x3b9bbf(0x1ad),'WGwvr':function(_0x11dd7f,_0x58c807){return _0x11dd7f(_0x58c807);},'LKXhD':function(_0x26c09d,_0x5ddde7,_0x2375f7){return _0x26c09d(_0x5ddde7,_0x2375f7);}};_0x5a7cb3[_0x3b9bbf(0x1b2)](setTimeout,function(){const _0x5d7182=_0x3b9bbf;console[_0x5d7182(0x1c7)](_0x5a7cb3[_0x5d7182(0x1cb)]);},0x64),_0x5a7cb3['yOihc'](it,_0x5a7cb3[_0x3b9bbf(0x19d)],async()=>{const _0x3b00fe=_0x3b9bbf,_0x5f4650={'params':[{'name':_0x5a7cb3[_0x3b00fe(0x1b8)],'value':_0x5a7cb3['IeqSj']},{'name':_0x5a7cb3['UfjSd'],'value':'0'}]},_0x28535a=_0x5a7cb3[_0x3b00fe(0x1b1)](RtspCameraController,gladys,rtspCameraService),_0x410b8f={'body':_0x5f4650};await _0x28535a[_0x3b00fe(0x1e4)][_0x3b00fe(0x1b4)](_0x410b8f,res),assert['calledWith'](rtspCameraService['getImage'],_0x5f4650);}),it(_0x3b9bbf(0x1b6),async()=>{const _0x59292e=_0x3b9bbf,_0x3ed328=RtspCameraController(gladys,rtspCameraService),_0x5d4dbb={'params':{'camera_selector':_0x5a7cb3['ydneW']},'body':{'is_gladys_gateway':![],'segment_duration':0x4}};await _0x3ed328[_0x59292e(0x1df)][_0x59292e(0x1b4)](_0x5d4dbb,res),assert[_0x59292e(0x1b9)](rtspCameraService[_0x59292e(0x191)],_0x5a7cb3[_0x59292e(0x1ac)],![],0x4);}),_0x5a7cb3[_0x3b9bbf(0x1a8)](it,_0x5a7cb3['sWjyb'],async()=>{const _0x2fb826=_0x3b9bbf,_0x466293=_0x5a7cb3[_0x2fb826(0x1b2)](RtspCameraController,gladys,rtspCameraService),_0x4166df={'params':{'camera_selector':'my-camera'}};await _0x466293[_0x5a7cb3[_0x2fb826(0x1d2)]][_0x2fb826(0x1b4)](_0x4166df,res),assert[_0x2fb826(0x1b9)](rtspCameraService[_0x2fb826(0x1d5)],'my-camera');}),it(_0x3b9bbf(0x189),async()=>{const _0x573640=_0x3b9bbf,_0x50acf1=RtspCameraController(gladys,rtspCameraService),_0xc4fe3={'params':{'camera_selector':_0x5a7cb3[_0x573640(0x1ac)]}};await _0x50acf1[_0x5a7cb3[_0x573640(0x1a6)]][_0x573640(0x1b4)](_0xc4fe3,res),assert[_0x573640(0x1b9)](rtspCameraService[_0x573640(0x193)],_0x5a7cb3['ydneW']);}),_0x5a7cb3[_0x3b9bbf(0x190)](it,_0x3b9bbf(0x1ab),async()=>{const _0x5347d3=_0x3b9bbf,_0x3a95ed=_0x5a7cb3[_0x5347d3(0x1b1)](RtspCameraController,gladys,rtspCameraService),_0x192a08={'params':{'folder':_0x5347d3(0x1bb),'file':_0x5a7cb3[_0x5347d3(0x1cd)]}};await fse[_0x5347d3(0x1be)](path[_0x5347d3(0x1c2)](gladys['config'][_0x5347d3(0x1d7)],_0x5a7cb3[_0x5347d3(0x1bf)])),await fse[_0x5347d3(0x181)](path[_0x5347d3(0x1c2)](gladys['config'][_0x5347d3(0x1d7)],_0x5a7cb3[_0x5347d3(0x1bf)],_0x5347d3(0x1e2)),_0x5a7cb3[_0x5347d3(0x184)]);const _0x13dfff=fse[_0x5347d3(0x192)](path[_0x5347d3(0x1c2)](gladys[_0x5347d3(0x188)]['tempFolder'],'camera-1',_0x5347d3(0x1aa)));await _0x3a95ed[_0x5347d3(0x1e1)]['controller'](_0x192a08,_0x13dfff);}),it(_0x5a7cb3[_0x3b9bbf(0x1ca)],async()=>{const _0x4c2fdd=_0x3b9bbf,_0x2738bc=_0x5a7cb3[_0x4c2fdd(0x1a4)](RtspCameraController,gladys,rtspCameraService),_0x4ed97c={'params':{'folder':_0x4c2fdd(0x1bb),'file':_0x5a7cb3[_0x4c2fdd(0x1b3)]}};await fse['ensureDir'](path['join'](gladys[_0x4c2fdd(0x188)][_0x4c2fdd(0x1d7)],_0x5a7cb3[_0x4c2fdd(0x1bf)])),await fse[_0x4c2fdd(0x181)](path['join'](gladys[_0x4c2fdd(0x188)][_0x4c2fdd(0x1d7)],_0x5a7cb3[_0x4c2fdd(0x1bf)],_0x5a7cb3[_0x4c2fdd(0x1b3)]),_0x5a7cb3[_0x4c2fdd(0x184)]);const _0x342e62=fse[_0x4c2fdd(0x192)](path[_0x4c2fdd(0x1c2)](gladys[_0x4c2fdd(0x188)][_0x4c2fdd(0x1d7)],_0x5a7cb3['aNARi'],_0x4c2fdd(0x1aa)));await _0x2738bc[_0x5a7cb3['GjDNL']]['controller'](_0x4ed97c,_0x342e62);}),_0x5a7cb3[_0x3b9bbf(0x17e)](Function,_0x5a7cb3[_0x3b9bbf(0x1a3)])(),it(_0x3b9bbf(0x1d1),async()=>{const _0x1daf91=_0x3b9bbf,_0x24433e=RtspCameraControllerWithFsMocked(gladys,rtspCameraService),_0x284aaf={'params':{'folder':_0x5a7cb3[_0x1daf91(0x1bf)],'file':_0x5a7cb3[_0x1daf91(0x196)]}},_0x3c52e7=fse[_0x1daf91(0x192)](path[_0x1daf91(0x1c2)](gladys['config'][_0x1daf91(0x1d7)],_0x5a7cb3[_0x1daf91(0x1bf)],_0x5a7cb3[_0x1daf91(0x1bc)])),_0x3cceb2=fake[_0x1daf91(0x180)](null);_0x3c52e7[_0x1daf91(0x19e)]=fake[_0x1daf91(0x180)]({'end':_0x3cceb2}),await _0x24433e[_0x5a7cb3[_0x1daf91(0x18d)]][_0x1daf91(0x1b4)](_0x284aaf,_0x3c52e7),assert[_0x1daf91(0x1b9)](_0x3c52e7[_0x1daf91(0x19e)],0x194),assert[_0x1daf91(0x18e)](_0x3cceb2);}),eval('Math[\'PI\'] * 2;'),it(_0x3b9bbf(0x1b5),async()=>{const _0x4b0cff=_0x3b9bbf,_0x3b9535=_0x5a7cb3[_0x4b0cff(0x1c6)](RtspCameraController,gladys,rtspCameraService),_0x37d6ac={},_0x5f3672={},_0x54c75a=_0x3b9535[_0x5a7cb3[_0x4b0cff(0x18d)]][_0x4b0cff(0x1b4)](_0x37d6ac,_0x5f3672);await chaiAssert[_0x4b0cff(0x1a9)](_0x54c75a,_0x4b0cff(0x1dd));}),_0x5a7cb3[_0x3b9bbf(0x1e3)](Function,_0x5a7cb3['aJjVI'])(),it(_0x5a7cb3[_0x3b9bbf(0x1c5)],async()=>{const _0x32d8f1=_0x3b9bbf,_0x46bcbb=_0x5a7cb3[_0x32d8f1(0x185)](RtspCameraController,gladys,rtspCameraService),_0x57dcce={'params':{'folder':_0x5a7cb3[_0x32d8f1(0x1bf)],'file':_0x5a7cb3[_0x32d8f1(0x19f)]}},_0x1ab186={},_0x1d012d=_0x46bcbb[_0x32d8f1(0x1e1)]['controller'](_0x57dcce,_0x1ab186);await chaiAssert[_0x32d8f1(0x1a9)](_0x1d012d,_0x5a7cb3[_0x32d8f1(0x17f)]);}),_0x5a7cb3[_0x3b9bbf(0x1a5)](fetch,_0x3b9bbf(0x19a)),_0x5a7cb3[_0x3b9bbf(0x1d3)](it,_0x3b9bbf(0x1a0),async()=>{const _0x93093a=_0x3b9bbf,_0x2f118a=_0x5a7cb3['DwaiO'](RtspCameraController,gladys,rtspCameraService),_0x395b7e={'params':{'folder':_0x93093a(0x1af),'file':_0x5a7cb3['RvAIg']}},_0x60a715={},_0x446eb7=_0x2f118a[_0x5a7cb3[_0x93093a(0x18d)]]['controller'](_0x395b7e,_0x60a715);await chaiAssert[_0x93093a(0x1a9)](_0x446eb7,_0x5a7cb3[_0x93093a(0x1a7)]);});});