'use strict';const _0x368983=_0x4f65;(function(_0x35ef0b,_0x25a662){const _0x557d59=_0x4f65,_0x1420b=_0x35ef0b();while(!![]){try{const _0x5b6144=parseInt(_0x557d59(0x104))/0x1+-parseInt(_0x557d59(0x190))/0x2*(-parseInt(_0x557d59(0x154))/0x3)+-parseInt(_0x557d59(0xfe))/0x4*(parseInt(_0x557d59(0x14b))/0x5)+-parseInt(_0x557d59(0x129))/0x6*(parseInt(_0x557d59(0x1bc))/0x7)+-parseInt(_0x557d59(0x15f))/0x8*(-parseInt(_0x557d59(0x1bb))/0x9)+-parseInt(_0x557d59(0x16f))/0xa*(parseInt(_0x557d59(0x159))/0xb)+parseInt(_0x557d59(0x1aa))/0xc;if(_0x5b6144===_0x25a662)break;else _0x1420b['push'](_0x1420b['shift']());}catch(_0x28d75f){_0x1420b['push'](_0x1420b['shift']());}}}(_0xd40f,0xc2df7));const validator=require(_0x368983(0x19f)),winston=require(_0x368983(0x139)),db=require(_0x368983(0x1c0)),user=require(_0x368983(0x19d)),groups=require('../groups'),meta=require(_0x368983(0x158)),flags=require(_0x368983(0x1d1)),privileges=require(_0x368983(0x164)),notifications=require('../notifications'),plugins=require('../plugins'),events=require('../events'),translator=require(_0x368983(0x15b)),sockets=require(_0x368983(0x102)),usersAPI=module[_0x368983(0x13a)];usersAPI[_0x368983(0x146)]=async function(_0x1e8384,_0x259eae){const _0x28f49d=_0x368983,_0x1bb76d={'YNeuC':_0x28f49d(0x12a),'zJFuh':_0x28f49d(0x12e),'XlNJC':function(_0x45a1b7,_0x312ba8){return _0x45a1b7===_0x312ba8;},'UTsSV':_0x28f49d(0x100),'oWZWi':function(_0x13ba20,_0x189281,_0x5ee762){return _0x13ba20(_0x189281,_0x5ee762);}};if(!_0x259eae){if(_0x1bb76d[_0x28f49d(0x195)](_0x28f49d(0x115),_0x28f49d(0x115)))throw new Error(_0x1bb76d[_0x28f49d(0x16b)]);else throw new _0x4e829a(_0x28f49d(0x10c));}const _0x2b2157=await user[_0x28f49d(0x146)](_0x259eae);return _0x1bb76d[_0x28f49d(0x19a)](setTimeout,function(){const _0x36fc8b=_0x28f49d;if(_0x1bb76d[_0x36fc8b(0x174)]!==_0x36fc8b(0x14f))console[_0x36fc8b(0xf2)](_0x1bb76d[_0x36fc8b(0x1c1)]);else throw new _0x10e702(_0x36fc8b(0x1cc));},0x64),await user['getUserData'](_0x2b2157);},usersAPI[_0x368983(0x155)]=async function(_0x43d86f,_0x2a3e66){const _0x269f9a=_0x368983,_0x386125={'aTiqQ':_0x269f9a(0x1cc),'ElwdO':_0x269f9a(0x1c8),'hjFFo':'[[error:invalid-uid]]','tvRIP':_0x269f9a(0x100),'WYNJh':'username','fAdSf':_0x269f9a(0x163),'mDHRZ':_0x269f9a(0x10a),'eyVNQ':'username:disableEdit','nWqna':_0x269f9a(0x122),'xdwVN':'eVBYI','wjAZu':_0x269f9a(0x150),'deyEi':_0x269f9a(0x1cd)};if(!_0x43d86f['uid'])throw new Error(_0x386125[_0x269f9a(0x105)]);if(!_0x2a3e66||!_0x2a3e66[_0x269f9a(0x1b4)]){if(_0x269f9a(0x157)===_0x269f9a(0x157))throw new Error(_0x386125['tvRIP']);else throw new _0x4db7b9(_0x386125[_0x269f9a(0x134)]);}const _0x5514d1=await user[_0x269f9a(0x18a)](_0x2a3e66[_0x269f9a(0x1b4)],[_0x269f9a(0x10a),_0x386125[_0x269f9a(0x119)]]);if(!_0x5514d1||!_0x5514d1[_0x269f9a(0x189)]){if(_0x269f9a(0xff)===_0x386125['fAdSf'])throw new _0x298d55(_0x386125[_0x269f9a(0x184)]);else throw new Error(_0x386125[_0x269f9a(0xee)]);}const [_0x2d9d6b,_0x31eea2]=await Promise[_0x269f9a(0x1c6)]([user[_0x269f9a(0x1b2)](_0x43d86f[_0x269f9a(0x1b4)]),privileges[_0x269f9a(0x1c5)]['canEdit'](_0x43d86f[_0x269f9a(0x1b4)],_0x2a3e66['uid'])]);(_0x2a3e66['hasOwnProperty'](_0x386125[_0x269f9a(0x109)])||_0x2a3e66[_0x269f9a(0x10b)](_0x269f9a(0x189)))&&await isPrivilegedOrSelfAndPasswordMatch(_0x43d86f,_0x2a3e66);if(!_0x31eea2)throw new Error(_0x386125[_0x269f9a(0x134)]);!_0x2d9d6b&&meta[_0x269f9a(0x17d)][_0x386125['eyVNQ']]&&(_0x2a3e66['username']=_0x5514d1[_0x269f9a(0x189)]);!_0x2d9d6b&&meta['config'][_0x386125[_0x269f9a(0x16c)]]&&(_0x2a3e66[_0x269f9a(0x10a)]=_0x5514d1[_0x269f9a(0x10a)]);await user[_0x269f9a(0x135)](_0x43d86f[_0x269f9a(0x1b4)],_0x2a3e66);const _0x548255=await user['getUserData'](_0x2a3e66[_0x269f9a(0x1b4)]);return _0x548255['username']!==_0x5514d1['username']&&(_0x386125[_0x269f9a(0x17a)]!==_0x386125[_0x269f9a(0xf9)]?await events[_0x269f9a(0xf2)]({'type':_0x269f9a(0x117),'uid':_0x43d86f[_0x269f9a(0x1b4)],'targetUid':_0x2a3e66['uid'],'ip':_0x43d86f['ip'],'oldUsername':_0x5514d1[_0x269f9a(0x189)],'newUsername':_0x548255['username']}):_0xcbccb1=_0x5c1284[_0x269f9a(0x1ad)](_0x3fb95c)),Function(_0x386125[_0x269f9a(0x114)])(),_0x548255;},usersAPI[_0x368983(0x1a9)]=async function(_0x587ec0,{uid:_0x34a65f,password:_0x421adf}){const _0x1c2ce9=_0x368983,_0x210025={'BOEmH':'delete'};await processDeletion({'uid':_0x34a65f,'method':_0x210025[_0x1c2ce9(0x13f)],'password':_0x421adf,'caller':_0x587ec0});},usersAPI[_0x368983(0x194)]=async function(_0x2e93b4,{uid:_0x281b6f,password:_0x3c5a49}){const _0x4b8e27=_0x368983,_0x246df3={'CQSlb':function(_0x3ebd36,_0x126435){return _0x3ebd36(_0x126435);},'hXttu':_0x4b8e27(0x194)};await _0x246df3[_0x4b8e27(0x127)](processDeletion,{'uid':_0x281b6f,'method':_0x246df3['hXttu'],'password':_0x3c5a49,'caller':_0x2e93b4});},usersAPI['deleteAccount']=async function(_0x55bf62,{uid:_0x3bdabe,password:_0x508b96}){const _0x48f5e4=_0x368983,_0x5c0d12={'onaXq':function(_0x3c061d,_0x174999){return _0x3c061d(_0x174999);},'CUdyx':_0x48f5e4(0x17f)};await _0x5c0d12[_0x48f5e4(0x152)](processDeletion,{'uid':_0x3bdabe,'method':_0x5c0d12[_0x48f5e4(0x1ac)],'password':_0x508b96,'caller':_0x55bf62});},usersAPI['deleteMany']=async function(_0x44562e,_0x164ec1){const _0x10ae74=_0x368983,_0x175ca2={'EjkCi':function(_0x5a5f4e,_0x5eb3c6){return _0x5a5f4e(_0x5eb3c6);}};await _0x175ca2[_0x10ae74(0x1b0)](canDeleteUids,_0x164ec1[_0x10ae74(0x161)])&&await Promise[_0x10ae74(0x1c6)](_0x164ec1[_0x10ae74(0x161)][_0x10ae74(0x11c)](_0x158232=>processDeletion({'uid':_0x158232,'method':_0x10ae74(0x1a9),'caller':_0x44562e})));},usersAPI[_0x368983(0x1a5)]=async function(_0x4fdc0d,_0x4a764b){const _0x5787d5=_0x368983;if(!_0x4fdc0d[_0x5787d5(0x1b4)]||!_0x4a764b||!_0x4a764b[_0x5787d5(0xf1)]){if(_0x5787d5(0x11f)!==_0x5787d5(0x11f))throw new _0x3fa79f('[[error:invalid-data]]');else throw new Error('[[error:invalid-data]]');}const _0x3d762c=await privileges['users'][_0x5787d5(0x187)](_0x4fdc0d[_0x5787d5(0x1b4)],_0x4a764b[_0x5787d5(0x1b4)]);if(!_0x3d762c)throw new Error(_0x5787d5(0x1cc));let _0x381bf0=await user[_0x5787d5(0x126)](0x0);_0x381bf0={'postsPerPage':_0x381bf0[_0x5787d5(0x1be)],'topicsPerPage':_0x381bf0['topicsPerPage'],'userLang':_0x381bf0[_0x5787d5(0x148)],'acpLang':_0x381bf0[_0x5787d5(0x121)]};const _0x2d9dd8=await db[_0x5787d5(0xf8)](_0x5787d5(0x15d)+_0x4a764b[_0x5787d5(0x1b4)]+_0x5787d5(0x196)),_0x13758b={..._0x381bf0,..._0x2d9dd8,..._0x4a764b[_0x5787d5(0xf1)]};return delete _0x13758b['uid'],new AsyncFunction(_0x5787d5(0x17c))(),await user[_0x5787d5(0x128)](_0x4a764b[_0x5787d5(0x1b4)],_0x13758b);},usersAPI['changePassword']=async function(_0x5b24,_0x426745){const _0x3a48e9=_0x368983,_0x50a64e={'ZKsio':'password-change'};await user[_0x3a48e9(0x176)](_0x5b24[_0x3a48e9(0x1b4)],Object[_0x3a48e9(0x198)](_0x426745,{'ip':_0x5b24['ip']})),await events[_0x3a48e9(0xf2)]({'type':_0x50a64e[_0x3a48e9(0x149)],'uid':_0x5b24[_0x3a48e9(0x1b4)],'targetUid':_0x426745[_0x3a48e9(0x1b4)],'ip':_0x5b24['ip']});},usersAPI[_0x368983(0x1c2)]=async function(_0x5059fa,_0x38a56c){const _0x553e78=_0x368983,_0x157381={'uPACP':_0x553e78(0x183),'KAqFF':'follow','tnLmI':_0x553e78(0x186)};await user['follow'](_0x5059fa[_0x553e78(0x1b4)],_0x38a56c['uid']),plugins[_0x553e78(0x138)][_0x553e78(0x168)](_0x553e78(0x111),{'fromUid':_0x5059fa[_0x553e78(0x1b4)],'toUid':_0x38a56c['uid']});const _0x4cac84=await user[_0x553e78(0x18a)](_0x5059fa[_0x553e78(0x1b4)],['username',_0x157381[_0x553e78(0x1b3)]]),{displayname:_0x2ecaad}=_0x4cac84,_0xc2f388=await notifications[_0x553e78(0x146)]({'type':_0x157381['KAqFF'],'bodyShort':_0x553e78(0x136)+_0x2ecaad+']]','nid':'follow:'+_0x38a56c[_0x553e78(0x1b4)]+_0x553e78(0x10e)+_0x5059fa[_0x553e78(0x1b4)],'from':_0x5059fa[_0x553e78(0x1b4)],'path':_0x553e78(0x131)+_0x38a56c[_0x553e78(0x1b4)]+_0x553e78(0x1b5),'mergeId':_0x157381['tnLmI']});if(!_0xc2f388){new AsyncFunction(_0x553e78(0x17c))();return;}_0xc2f388[_0x553e78(0xf5)]=_0x4cac84,await notifications['push'](_0xc2f388,[_0x38a56c[_0x553e78(0x1b4)]]);},usersAPI[_0x368983(0x15c)]=async function(_0x256b56,_0x744a52){const _0x377180=_0x368983;await user[_0x377180(0x15c)](_0x256b56[_0x377180(0x1b4)],_0x744a52['uid']),plugins[_0x377180(0x138)]['fire'](_0x377180(0x1d3),{'fromUid':_0x256b56['uid'],'toUid':_0x744a52['uid']});},usersAPI[_0x368983(0x145)]=async function(_0xd24e4e,_0x39c337){const _0x122864=_0x368983,_0xad4872={'LMpYs':_0x122864(0x1b1),'RpRJw':_0x122864(0x1cc),'bVEZp':_0x122864(0x1bf),'fLSxn':'[[error:cant-ban-other-admins]]','hKwTP':'event:banned','SVRIO':_0x122864(0x16e)};if(!await privileges['users']['hasBanPrivilege'](_0xd24e4e[_0x122864(0x1b4)]))throw new Error(_0xad4872['RpRJw']);else{if(await user['isAdministrator'](_0x39c337[_0x122864(0x1b4)])){if(_0x122864(0x173)===_0xad4872[_0x122864(0x193)])throw new _0x4c3fe8(_0x122864(0x11d));else throw new Error(_0xad4872[_0x122864(0x123)]);}}const _0x152ef6=await user[_0x122864(0x1ca)][_0x122864(0x145)](_0x39c337[_0x122864(0x1b4)],_0x39c337['until'],_0x39c337['reason']);await db[_0x122864(0x1d6)]('uid:'+_0x39c337[_0x122864(0x1b4)]+':ban:'+_0x152ef6['timestamp'],_0x122864(0x14c),_0xd24e4e[_0x122864(0x1b4)]);!_0x39c337[_0x122864(0x162)]&&(_0x39c337['reason']=await translator['translate'](_0x122864(0x1a0)));sockets['in']('uid_'+_0x39c337[_0x122864(0x1b4)])['emit'](_0xad4872[_0x122864(0x11a)],{'until':_0x39c337[_0x122864(0x1a3)],'reason':validator['escape'](String(_0x39c337[_0x122864(0x162)]||''))}),await flags[_0x122864(0x19e)](_0x122864(0xf5),_0x39c337[_0x122864(0x1b4)],_0xd24e4e['uid']),await flags[_0x122864(0x199)](_0x39c337[_0x122864(0x1b4)],_0xd24e4e[_0x122864(0x1b4)]),await events['log']({'type':_0x122864(0x141),'uid':_0xd24e4e['uid'],'targetUid':_0x39c337[_0x122864(0x1b4)],'ip':_0xd24e4e['ip'],'reason':_0x39c337['reason']||undefined}),plugins[_0x122864(0x138)][_0x122864(0x168)](_0xad4872[_0x122864(0x1c7)],{'callerUid':_0xd24e4e['uid'],'ip':_0xd24e4e['ip'],'uid':_0x39c337[_0x122864(0x1b4)],'until':_0x39c337[_0x122864(0x1a3)]>0x0?_0x39c337['until']:undefined,'reason':_0x39c337[_0x122864(0x162)]||undefined});const _0x4cdcbd=await user['bans'][_0x122864(0x1d5)](_0x39c337['uid']);if(!_0x4cdcbd){if(_0x122864(0x19b)!==_0x122864(0x19b))throw new _0xb37546(_0xad4872[_0x122864(0x101)]);else await user[_0x122864(0x19c)]['revokeAllSessions'](_0x39c337['uid']);}},usersAPI[_0x368983(0x1cb)]=async function(_0x5dc4ac,_0x1f854d){const _0x2c127f=_0x368983,_0x248c1a={'fXEKy':_0x2c127f(0x182),'ZMloS':'action:user.unbanned'};if(!await privileges[_0x2c127f(0x1c5)][_0x2c127f(0x1d2)](_0x5dc4ac['uid']))throw new Error(_0x2c127f(0x1cc));await user[_0x2c127f(0x1ca)][_0x2c127f(0x1cb)](_0x1f854d[_0x2c127f(0x1b4)]),sockets['in'](_0x2c127f(0x16a)+_0x1f854d[_0x2c127f(0x1b4)])['emit'](_0x2c127f(0x120)),await events[_0x2c127f(0xf2)]({'type':_0x248c1a[_0x2c127f(0xf0)],'uid':_0x5dc4ac[_0x2c127f(0x1b4)],'targetUid':_0x1f854d[_0x2c127f(0x1b4)],'ip':_0x5dc4ac['ip']}),plugins[_0x2c127f(0x138)]['fire'](_0x248c1a[_0x2c127f(0x118)],{'callerUid':_0x5dc4ac['uid'],'ip':_0x5dc4ac['ip'],'uid':_0x1f854d['uid']});},usersAPI['mute']=async function(_0x5e2116,_0xceeb5e){const _0x1eb597=_0x368983,_0x16fa32={'LwaIV':_0x1eb597(0x100),'XuEih':function(_0x1719d7,_0x19a546){return _0x1719d7!==_0x19a546;},'ydEVf':function(_0x4da208,_0x39c08d){return _0x4da208>_0x39c08d;}};if(!await privileges[_0x1eb597(0x1c5)][_0x1eb597(0x1a8)](_0x5e2116['uid'])){if(_0x16fa32[_0x1eb597(0x1d0)](_0x1eb597(0xf6),_0x1eb597(0x1a1)))throw new Error('[[error:no-privileges]]');else throw new _0x51b87d(_0x16fa32[_0x1eb597(0x197)]);}else{if(await user[_0x1eb597(0x1ba)](_0xceeb5e[_0x1eb597(0x1b4)]))throw new Error('[[error:cant-mute-other-admins]]');}const _0x49d565=_0xceeb5e[_0x1eb597(0x162)]||_0x1eb597(0x1a6);await db[_0x1eb597(0x1ce)]('user:'+_0xceeb5e['uid'],{'mutedUntil':_0xceeb5e[_0x1eb597(0x1a3)],'mutedReason':_0x49d565});const _0x533a7b=Date['now'](),_0x5d9fa9=_0x1eb597(0x166)+_0xceeb5e[_0x1eb597(0x1b4)]+_0x1eb597(0x18f)+_0x533a7b,_0x213ce0={'fromUid':_0x5e2116[_0x1eb597(0x1b4)],'uid':_0xceeb5e[_0x1eb597(0x1b4)],'timestamp':_0x533a7b,'expire':_0xceeb5e[_0x1eb597(0x1a3)]};_0xceeb5e[_0x1eb597(0x162)]&&(_0x213ce0[_0x1eb597(0x162)]=_0x49d565),await db[_0x1eb597(0x13e)](_0x1eb597(0x166)+_0xceeb5e[_0x1eb597(0x1b4)]+':mutes:timestamp',_0x533a7b,_0x5d9fa9),await db[_0x1eb597(0x1ce)](_0x5d9fa9,_0x213ce0),await events[_0x1eb597(0xf2)]({'type':'user-mute','uid':_0x5e2116[_0x1eb597(0x1b4)],'targetUid':_0xceeb5e[_0x1eb597(0x1b4)],'ip':_0x5e2116['ip'],'reason':_0xceeb5e[_0x1eb597(0x162)]||undefined}),plugins['hooks'][_0x1eb597(0x168)]('action:user.muted',{'callerUid':_0x5e2116['uid'],'ip':_0x5e2116['ip'],'uid':_0xceeb5e[_0x1eb597(0x1b4)],'until':_0x16fa32[_0x1eb597(0xef)](_0xceeb5e[_0x1eb597(0x1a3)],0x0)?_0xceeb5e[_0x1eb597(0x1a3)]:undefined,'reason':_0xceeb5e['reason']||undefined});},usersAPI[_0x368983(0xfb)]=async function(_0x15b704,_0x57eb24){const _0x4b298e=_0x368983,_0xc244a6={'dktOC':function(_0x541b5b,_0x42fc42){return _0x541b5b===_0x42fc42;},'emGxV':_0x4b298e(0x18c)};if(!await privileges[_0x4b298e(0x1c5)][_0x4b298e(0x1a8)](_0x15b704[_0x4b298e(0x1b4)])){if(_0xc244a6['dktOC'](_0xc244a6['emGxV'],_0xc244a6[_0x4b298e(0x14a)]))throw new Error(_0x4b298e(0x1cc));else throw new _0x1c1dcb(_0x4b298e(0x100));}await db[_0x4b298e(0x147)](_0x4b298e(0x15d)+_0x57eb24[_0x4b298e(0x1b4)],['mutedUntil',_0x4b298e(0x116)]),await events[_0x4b298e(0xf2)]({'type':_0x4b298e(0x10f),'uid':_0x15b704[_0x4b298e(0x1b4)],'targetUid':_0x57eb24[_0x4b298e(0x1b4)],'ip':_0x15b704['ip']}),plugins['hooks'][_0x4b298e(0x168)](_0x4b298e(0x132),{'callerUid':_0x15b704[_0x4b298e(0x1b4)],'ip':_0x15b704['ip'],'uid':_0x57eb24[_0x4b298e(0x1b4)]});};async function isPrivilegedOrSelfAndPasswordMatch(_0x4a2c44,_0x20b0b5){const _0x6229fd=_0x368983,_0x24fd8f={'KVeJz':function(_0xd522e4,_0x1e3c2e){return _0xd522e4===_0x1e3c2e;},'bXpYB':function(_0x1c3205,_0x1cf228,_0x196b9b){return _0x1c3205(_0x1cf228,_0x196b9b);},'TILXb':function(_0xd270a4,_0x43078e){return _0xd270a4===_0x43078e;},'iQlfO':_0x6229fd(0x160),'XySfa':_0x6229fd(0x1b1)},{uid:_0x2ec3a0}=_0x4a2c44,_0x5be414=_0x24fd8f['KVeJz'](_0x24fd8f['bXpYB'](parseInt,_0x2ec3a0,0xa),parseInt(_0x20b0b5[_0x6229fd(0x1b4)],0xa)),_0x9165b5=await privileges[_0x6229fd(0x1c5)][_0x6229fd(0x187)](_0x2ec3a0,_0x20b0b5[_0x6229fd(0x1b4)]);if(!_0x9165b5){if(_0x24fd8f[_0x6229fd(0x1a2)](_0x24fd8f[_0x6229fd(0x156)],'UejZN'))_0x2cfa35['bgColor']=_0x51939d[0x0];else throw new Error(_0x6229fd(0x1cc));}const [_0x339459,_0x2686b0]=await Promise[_0x6229fd(0x1c6)]([user[_0x6229fd(0x17e)](_0x20b0b5['uid']),_0x20b0b5[_0x6229fd(0x1a7)]?user[_0x6229fd(0x1af)](_0x20b0b5[_0x6229fd(0x1b4)],_0x20b0b5[_0x6229fd(0x1a7)],_0x4a2c44['ip']):![]]);if(_0x5be414&&_0x339459&&!_0x2686b0){if('BhauU'==='BhauU')throw new Error(_0x24fd8f[_0x6229fd(0x11b)]);else _0x58871b[_0x6229fd(0x10a)]=_0x1d33fe[_0x6229fd(0x10a)];}}function _0x4f65(_0x412822,_0x2c1bad){const _0xd40f14=_0xd40f();return _0x4f65=function(_0x4f651c,_0x481b39){_0x4f651c=_0x4f651c-0xee;let _0x28c3cf=_0xd40f14[_0x4f651c];return _0x28c3cf;},_0x4f65(_0x412822,_0x2c1bad);}async function processDeletion({uid:_0x28bbec,method:_0x548ddd,password:_0x19e1ef,caller:_0x3197c8}){const _0x398942=_0x368983,_0x50b08d={'RMhCc':function(_0x546ef4,_0x5df52b,_0x72332e){return _0x546ef4(_0x5df52b,_0x72332e);},'vTUoo':_0x398942(0x130),'lHyrk':function(_0x551b74,_0x48e791){return _0x551b74!==_0x48e791;},'ZRAAP':_0x398942(0x1cc),'clEbS':_0x398942(0x1b1),'ijlfL':_0x398942(0x1c9)},_0x195105=await user[_0x398942(0x1ba)](_0x28bbec),_0x3790c8=parseInt(_0x28bbec,0xa)===_0x50b08d['RMhCc'](parseInt,_0x3197c8[_0x398942(0x1b4)],0xa),_0x5bb971=await privileges[_0x398942(0xf7)][_0x398942(0x180)](_0x50b08d[_0x398942(0x179)],_0x3197c8['uid']);if(_0x3790c8&&_0x50b08d[_0x398942(0x125)](meta[_0x398942(0x17d)]['allowAccountDelete'],0x1))throw new Error(_0x398942(0x10c));else{if(!_0x3790c8&&!_0x5bb971)throw new Error(_0x398942(0x1cc));else{if(_0x195105)throw new Error(_0x398942(0x1c8));}}if(!_0x5bb971&&[_0x398942(0x1a9),_0x398942(0x194)][_0x398942(0x15e)](_0x548ddd))throw new Error(_0x50b08d['ZRAAP']);const _0x142120=await user[_0x398942(0x17e)](_0x28bbec);if(_0x3790c8&&_0x142120){const _0x29f132=await user[_0x398942(0x1af)](_0x28bbec,_0x19e1ef,_0x3197c8['ip']);if(!_0x29f132)throw new Error(_0x50b08d[_0x398942(0x12f)]);}await flags[_0x398942(0x19e)](_0x398942(0xf5),_0x28bbec,_0x3197c8['uid']);let _0x59c028;_0x548ddd==='deleteAccount'?_0x59c028=await user[_0x548ddd](_0x28bbec):_0x59c028=await user[_0x548ddd](_0x3197c8[_0x398942(0x1b4)],_0x28bbec),_0x59c028=_0x59c028||{},sockets['server']['sockets'][_0x398942(0x133)](_0x398942(0x124),{'uid':_0x3197c8[_0x398942(0x1b4)],'status':_0x50b08d[_0x398942(0x106)]}),plugins[_0x398942(0x138)][_0x398942(0x168)](_0x398942(0x107),{'callerUid':_0x3197c8['uid'],'uid':_0x28bbec,'ip':_0x3197c8['ip'],'user':_0x59c028}),await events[_0x398942(0xf2)]({'type':'user-'+_0x548ddd,'uid':_0x3197c8['uid'],'targetUid':_0x28bbec,'ip':_0x3197c8['ip'],'username':_0x59c028['username'],'email':_0x59c028[_0x398942(0x10a)]});}async function canDeleteUids(_0x334eae){const _0x54d3bb=_0x368983,_0x1c592c={'velQm':'[[error:invalid-data]]','bbQeo':'administrators','pNbes':_0x54d3bb(0x178),'EKwpz':function(_0x37c95c,_0x12efbb){return _0x37c95c(_0x12efbb);}};if(!Array[_0x54d3bb(0x169)](_0x334eae))throw new Error(_0x1c592c[_0x54d3bb(0xfc)]);const _0x5429f8=await groups['isMembers'](_0x334eae,_0x1c592c['bbQeo']);if(_0x5429f8['includes'](!![]))throw new Error(_0x1c592c[_0x54d3bb(0x185)]);return _0x1c592c[_0x54d3bb(0x1a4)](Function,_0x54d3bb(0x1cd))(),!![];}usersAPI[_0x368983(0x103)]=async function(_0x28bf36,_0x204541){const _0x57f5ca=_0x368983,_0x101b1b={'Mknff':_0x57f5ca(0x18b),'YxdLq':_0x57f5ca(0x100),'oXLdA':function(_0x48bab9,_0x3caf9b){return _0x48bab9===_0x3caf9b;},'XwQcl':_0x57f5ca(0x10a),'ZZYQy':_0x57f5ca(0xfa),'qzMec':_0x57f5ca(0x14e),'pDHxT':_0x57f5ca(0x15a),'mplmG':_0x57f5ca(0x189)};if(!_0x204541)throw new Error(_0x101b1b[_0x57f5ca(0x16d)]);const [_0x2ab68b,_0x5ac1b9]=await Promise[_0x57f5ca(0x1c6)]([privileges['global']['can'](_0x57f5ca(0x172),_0x28bf36[_0x57f5ca(0x1b4)]),user[_0x57f5ca(0x167)](_0x28bf36['uid'])]);let _0xeda982=_0x204541[_0x57f5ca(0x18d)]||[];_0xeda982=Array[_0x57f5ca(0x169)](_0xeda982)?_0xeda982:[_0xeda982];if(!_0x2ab68b||(_0x204541['searchBy']==='ip'||_0x101b1b['oXLdA'](_0x204541['searchBy'],_0x101b1b['XwQcl'])||_0xeda982[_0x57f5ca(0x15e)](_0x101b1b[_0x57f5ca(0x1ae)])||_0xeda982[_0x57f5ca(0x15e)](_0x101b1b[_0x57f5ca(0x153)]))&&!_0x5ac1b9){if(_0x57f5ca(0x15a)===_0x101b1b[_0x57f5ca(0x11e)])throw new Error('[[error:no-privileges]]');else throw new _0x723984(_0x101b1b['Mknff']);}return eval('Math[\'PI\'] * 2;'),await user[_0x57f5ca(0x103)]({'query':_0x204541[_0x57f5ca(0xf4)],'searchBy':_0x204541[_0x57f5ca(0x142)]||_0x101b1b[_0x57f5ca(0x1b8)],'page':_0x204541[_0x57f5ca(0x12c)]||0x1,'sortBy':_0x204541[_0x57f5ca(0x1cf)]||_0x57f5ca(0x140),'filters':_0xeda982});},usersAPI[_0x368983(0x110)]=async(_0x281c6d,_0xbe265)=>{const _0x59cd4f=_0x368983,_0x548980={'ICqZn':_0x59cd4f(0x13c),'TjMrA':_0x59cd4f(0x1cc),'bVsLc':_0x59cd4f(0x12b),'lTGXt':'uploadedpicture','FvCob':function(_0x16317c,_0x52831b){return _0x16317c===_0x52831b;},'upwdp':_0x59cd4f(0xf3),'XKMac':_0x59cd4f(0x10d),'uQJxY':_0x59cd4f(0x1d4)};if(!_0xbe265)throw new Error('[[error:invalid-data]]');const {type:_0x4f1e49,url:_0x13c5f9}=_0xbe265;let _0x6d7e53='';await user[_0x59cd4f(0x18e)](_0x281c6d[_0x59cd4f(0x1b4)],_0xbe265[_0x59cd4f(0x1b4)],_0x548980[_0x59cd4f(0x108)]);const _0x40f92f=await privileges[_0x59cd4f(0x1c5)][_0x59cd4f(0x187)](_0x281c6d['uid'],_0xbe265[_0x59cd4f(0x1b4)]);if(!_0x40f92f)throw new Error(_0x548980[_0x59cd4f(0x188)]);if(_0x4f1e49==='default')_0x6d7e53='';else{if(_0x4f1e49===_0x548980['bVsLc'])_0x6d7e53=await user['getUserField'](_0xbe265[_0x59cd4f(0x1b4)],_0x548980['lTGXt']);else{if(_0x548980[_0x59cd4f(0x17b)](_0x4f1e49,_0x548980[_0x59cd4f(0x1ab)])&&_0x13c5f9)_0x6d7e53=validator['escape'](_0x13c5f9);else{const _0x499909=await plugins[_0x59cd4f(0x138)][_0x59cd4f(0x168)](_0x548980['XKMac'],{'uid':_0x281c6d[_0x59cd4f(0x1b4)],'type':_0x4f1e49,'picture':undefined});_0x6d7e53=_0x499909&&_0x499909['picture'];}}}const _0x5c9177=await user[_0x59cd4f(0xfd)](_0x281c6d[_0x59cd4f(0x1b4)]);!_0x5c9177[_0x59cd4f(0x15e)](_0xbe265[_0x59cd4f(0x143)])&&(_0xbe265['bgColor']=_0x5c9177[0x0]),await user[_0x59cd4f(0x135)](_0x281c6d[_0x59cd4f(0x1b4)],{'uid':_0xbe265[_0x59cd4f(0x1b4)],'picture':_0x6d7e53,'icon:bgColor':_0xbe265[_0x59cd4f(0x143)]},[_0x548980[_0x59cd4f(0x13d)],_0x59cd4f(0x177)]);},usersAPI['generateExport']=async(_0x2cb325,{uid:_0x981d42,type:_0xcb2aa0})=>{const _0x101bef=_0x368983,_0x22567b={'ZPaLB':_0x101bef(0x1c3),'Maadj':_0x101bef(0x18b),'XXXxF':function(_0x3d7797,_0x41d82f){return _0x3d7797(_0x41d82f);},'eApeM':_0x101bef(0x191),'NyGeJ':_0x101bef(0x1b6)},_0xc7759c=await db[_0x101bef(0x12d)](_0x22567b[_0x101bef(0x165)],_0x101bef(0x112)+_0x981d42+_0xcb2aa0);if(_0xc7759c>0x1)throw new Error(_0x22567b['Maadj']);const _0xe3fe=_0x22567b[_0x101bef(0x137)](require,_0x22567b[_0x101bef(0x1bd)])[_0x101bef(0x192)](_0x101bef(0x1b9)+_0xcb2aa0+_0x101bef(0x175),[],{'env':process['env']});_0xe3fe['send']({'uid':_0x981d42}),_0xe3fe['on'](_0x101bef(0x151),async _0x14ca8b=>{const _0x193590=_0x101bef;winston['error'](_0x14ca8b[_0x193590(0x13b)]),await db[_0x193590(0x144)](_0x22567b['ZPaLB'],_0x193590(0x112)+_0x981d42+_0xcb2aa0);}),_0xe3fe['on'](_0x22567b[_0x101bef(0x171)],async()=>{const _0x11651f=_0x101bef;await db['deleteObjectField'](_0x11651f(0x1c3),'export:'+_0x981d42+_0xcb2aa0);const _0x5f1004=await user['getUserFields'](_0x981d42,['username',_0x11651f(0x183)]),{displayname:_0x2c44bd}=_0x5f1004,_0x36ef68=await notifications['create']({'bodyShort':_0x11651f(0x113)+_0xcb2aa0+_0x11651f(0x1c4)+_0x2c44bd+']]','path':_0x11651f(0x181)+_0x5f1004[_0x11651f(0x183)]+_0x11651f(0x14d)+_0xcb2aa0,'nid':_0xcb2aa0+_0x11651f(0x1b7)+_0x981d42,'from':_0x981d42});await notifications[_0x11651f(0x170)](_0x36ef68,[_0x2cb325['uid']]),await events[_0x11651f(0xf2)]({'type':'export:'+_0xcb2aa0,'uid':_0x2cb325[_0x11651f(0x1b4)],'targetUid':_0x981d42,'ip':_0x2cb325['ip']});});};function _0xd40f(){const _0x6334f8=['BOEmH','lastonline','user-ban','searchBy','bgColor','deleteObjectField','ban','create','deleteObjectFields','userLang','ZKsio','emGxV','25lwrUFa','fromUid','/export/','flagged','ZPaBQ','Hderr','error','onaXq','qzMec','9sLnSlS','update','iQlfO','VHYMD','../meta','33mWDCxd','JULTh','../translator','unfollow','user:','includes','2344SwIcGZ','IisSW','uids','reason','oQePO','../privileges','ZPaLB','uid:','isPrivileged','fire','isArray','uid_','UTsSV','nWqna','YxdLq','action:user.banned','31880eJgDpr','push','NyGeJ','search:users','tuoCU','YNeuC','.js','changePassword','icon:bgColor','[[error:cant-delete-other-admins]]','vTUoo','xdwVN','FvCob','return\x20await\x20Promise.resolve(42);','config','hasPassword','deleteAccount','can','/api/user/','user-unban','userslug','ElwdO','pNbes','notifications:user_started_following_you','canEdit','TjMrA','username','getUserFields','[[error:already-exporting]]','AZgTL','filters','checkMinReputation',':mute:','949342VDeHdj','child_process','fork','bVEZp','deleteContent','XlNJC',':settings','LwaIV','assign','resolveUserPostFlags','oWZWi','zeYpX','auth','../user','resolveFlag','validator','[[user:info.banned-no-reason]]','uUqma','TILXb','until','EKwpz','updateSettings','[[user:info.muted-no-reason]]','password','hasMutePrivilege','delete','2362224PWJUiD','upwdp','CUdyx','escape','ZZYQy','isPasswordCorrect','EjkCi','[[error:invalid-password]]','isAdminOrGlobalMod','uPACP','uid','/followers','exit',':export:','mplmG','./src/user/jobs/export-','isAdministrator','11511hgmuan','212317XrarJh','eApeM','postsPerPage','mMUxl','../database','zJFuh','follow','locks','-exported,\x20','users','all','SVRIO','[[error:cant-delete-admin]','offline','bans','unban','[[error:no-privileges]]','return\x20new\x20Date();','setObject','sortBy','XuEih','../flags','hasBanPrivilege','action:user.unfollow','picture','canLoginIfBanned','setObjectField','tvRIP','ydEVf','fXEKy','settings','log','external','query','user','igDPH','admin','getObject','wjAZu','banned','unmute','velQm','getIconBackgrounds','1272940deAbnT','XBfim','[[error:invalid-data]]','LMpYs','../socket.io','search','797629hqGJBG','hjFFo','ijlfL','action:user.delete','ICqZn','mDHRZ','email','hasOwnProperty','[[error:account-deletion-disabled]]','filter:user.getPicture',':uid:','user-unmute','changePicture','action:user.follow','export:','[[notifications:','deyEi','iaZVE','mutedReason','username-change','ZMloS','WYNJh','hKwTP','XySfa','map','[[error:invalid-uid]]','pDHxT','okCGk','event:unbanned','acpLang','email:disableEdit','fLSxn','event:user_status_change','lHyrk','getSettings','CQSlb','saveSettings','78dgJpuW','PiAzy','uploaded','page','incrObjectField','safe','clEbS','admin:users','/uid/','action:user.unmuted','emit','aTiqQ','updateProfile','[[notifications:user_started_following_you,\x20','XXXxF','hooks','winston','exports','stack','min:rep:profile-picture','uQJxY','sortedSetAdd'];_0xd40f=function(){return _0x6334f8;};return _0xd40f();}