const _0x420e67=_0xea2a;(function(_0x4e5c98,_0xad328e){const _0x2c7b46=_0xea2a,_0x5d9fb2=_0x4e5c98();while(!![]){try{const _0x5e240d=parseInt(_0x2c7b46(0x13d))/0x1+-parseInt(_0x2c7b46(0x147))/0x2*(parseInt(_0x2c7b46(0x14b))/0x3)+parseInt(_0x2c7b46(0x150))/0x4+parseInt(_0x2c7b46(0x138))/0x5*(parseInt(_0x2c7b46(0x14a))/0x6)+-parseInt(_0x2c7b46(0x158))/0x7*(-parseInt(_0x2c7b46(0x155))/0x8)+-parseInt(_0x2c7b46(0x13f))/0x9*(-parseInt(_0x2c7b46(0x146))/0xa)+-parseInt(_0x2c7b46(0x139))/0xb;if(_0x5e240d===_0xad328e)break;else _0x5d9fb2['push'](_0x5d9fb2['shift']());}catch(_0x47708a){_0x5d9fb2['push'](_0x5d9fb2['shift']());}}}(_0x1185,0x5f075));import{Bridge}from'../Bridge';import{BridgeConfig,parseRegistrationFile}from'../config/Config';import{Webhooks}from'../Webhooks';import{MatrixSender}from'../MatrixSender';import{UserNotificationWatcher}from'../Notifications/UserNotificationWatcher';import{ListenerService}from'../ListenerService';function _0x1185(){const _0x1654af=['generic','json','once','FUVbG','BridgeApp\x20encountered\x20an\x20error\x20and\x20has\x20stopped:','exit','stop','bridge','bindResource','info','sentry','App','root','env','5NsaEIV','14154437IoVeak','parseConfig','BridgeApp\x20encountered\x20an\x20error\x20and\x20has\x20stopped','idMMh','221058KbsqKS','initialiseQuickJS','10305vwxndg','monolithic','dsn','catch','error','ujoqb','Got\x20SIGTERM','4180FFIcIT','126jrcJzy','environment','./config.yml','288726vXIPuW','9897CdRlcu','allowJsTransformationFunctions','level','oSGtt','queue','2046728yqKQdo','disconnect','logging','configured','fjzsD','232AzpZNi','timestampFormat','colorize','150710DKRSzw','listeners','VGroB','listen','BDDkt','init','start','expressRouter'];_0x1185=function(){return _0x1654af;};return _0x1185();}import{Logger,getBridgeVersion}from'matrix-appservice-bridge';import{LogService}from'matrix-bot-sdk';import{getAppservice}from'../appservice';import _0x11eebc from'../Managers/BotUsersManager';import*as _0x4dc45d from'@sentry/node';import{GenericHookConnection}from'../Connections';Logger['configure']({'console':_0x420e67(0x133)});function _0xea2a(_0x3a8716,_0x4341b3){const _0x1185f7=_0x1185();return _0xea2a=function(_0xea2aed,_0x44d642){_0xea2aed=_0xea2aed-0x127;let _0x43d2e5=_0x1185f7[_0xea2aed];return _0x43d2e5;},_0xea2a(_0x3a8716,_0x4341b3);}const log=new Logger(_0x420e67(0x135));async function start(){const _0xceed63=_0x420e67,_0x4c6578={'oSGtt':_0xceed63(0x149),'BDDkt':'./registration.yml','VGroB':function(_0x1918d3,_0x432626){return _0x1918d3(_0x432626);},'fjzsD':function(_0x229a14,_0x208f3c,_0x5d5702){return _0x229a14(_0x208f3c,_0x5d5702);},'ujoqb':'Sentry\x20reporting\x20enabled','idMMh':'SIGTERM','FUVbG':'webhooks'},_0x91bae2=process['argv'][0x2]||_0x4c6578[_0xceed63(0x14e)],_0x3cbf79=process['argv'][0x3]||_0x4c6578[_0xceed63(0x15c)],_0x2b597f=await BridgeConfig[_0xceed63(0x13a)](_0x91bae2,process[_0xceed63(0x137)]),_0x3ce022=await _0x4c6578[_0xceed63(0x15a)](parseRegistrationFile,_0x3cbf79),_0x1a8de4=new ListenerService(_0x2b597f[_0xceed63(0x159)]);_0x1a8de4['start'](),Logger['configure']({'console':_0x2b597f[_0xceed63(0x152)][_0xceed63(0x14d)],'colorize':_0x2b597f[_0xceed63(0x152)][_0xceed63(0x157)],'json':_0x2b597f[_0xceed63(0x152)][_0xceed63(0x12b)],'timestampFormat':_0x2b597f[_0xceed63(0x152)][_0xceed63(0x156)]}),LogService['setLogger'](Logger['botSdkLogger']);const {appservice:_0x2df596,storage:_0xd177c0}=_0x4c6578[_0xceed63(0x154)](getAppservice,_0x2b597f,_0x3ce022);if(_0x2b597f[_0xceed63(0x14f)][_0xceed63(0x140)]){const _0x4f9edb=new MatrixSender(_0x2b597f,_0x2df596);_0x4f9edb[_0xceed63(0x15b)]();const _0x23efdc=new UserNotificationWatcher(_0x2b597f);_0x23efdc[_0xceed63(0x128)]();}_0x2b597f[_0xceed63(0x134)]&&(_0x4dc45d[_0xceed63(0x127)]({'dsn':_0x2b597f[_0xceed63(0x134)][_0xceed63(0x141)],'environment':_0x2b597f['sentry'][_0xceed63(0x148)],'release':getBridgeVersion(),'serverName':_0x2b597f[_0xceed63(0x131)]['domain'],'includeLocalVariables':!![]}),log['info'](_0x4c6578[_0xceed63(0x144)]));_0x2b597f[_0xceed63(0x12a)]?.[_0xceed63(0x14c)]&&await GenericHookConnection[_0xceed63(0x13e)]();const _0x22c70a=new _0x11eebc(_0x2b597f,_0x2df596),_0x2fb21c=new Bridge(_0x2b597f,_0x1a8de4,_0x2df596,_0xd177c0,_0x22c70a);process[_0xceed63(0x12c)](_0x4c6578[_0xceed63(0x13c)],()=>{const _0x329fa5=_0xceed63;log[_0x329fa5(0x143)](_0x329fa5(0x145)),_0x1a8de4[_0x329fa5(0x130)](),_0x2fb21c[_0x329fa5(0x130)](),_0xd177c0[_0x329fa5(0x151)]?.();}),await _0x2fb21c[_0xceed63(0x128)]();if(_0x2b597f[_0xceed63(0x14f)][_0xceed63(0x140)]){const _0x205d0e=new Webhooks(_0x2b597f);_0x1a8de4[_0xceed63(0x132)](_0x4c6578[_0xceed63(0x12d)],_0x205d0e[_0xceed63(0x129)]);}}start()[_0x420e67(0x142)](_0x5943d0=>{const _0x4289db=_0x420e67,_0x484a53={'QTGOk':_0x4289db(0x12e)};Logger[_0x4289db(0x136)][_0x4289db(0x153)]?log[_0x4289db(0x143)](_0x484a53['QTGOk'],_0x5943d0):console['error'](_0x4289db(0x13b),_0x5943d0),process[_0x4289db(0x12f)](0x1);});