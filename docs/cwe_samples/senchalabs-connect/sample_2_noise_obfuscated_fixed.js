const _0x538d59=_0x3a41;(function(_0x4302ee,_0x365b4d){const _0x21c995=_0x3a41,_0x23305f=_0x4302ee();while(!![]){try{const _0x4f888b=-parseInt(_0x21c995(0x273))/0x1+parseInt(_0x21c995(0x252))/0x2*(-parseInt(_0x21c995(0x201))/0x3)+-parseInt(_0x21c995(0x245))/0x4+parseInt(_0x21c995(0x26b))/0x5*(parseInt(_0x21c995(0x24d))/0x6)+-parseInt(_0x21c995(0x1f2))/0x7*(-parseInt(_0x21c995(0x1f3))/0x8)+-parseInt(_0x21c995(0x281))/0x9*(-parseInt(_0x21c995(0x232))/0xa)+-parseInt(_0x21c995(0x293))/0xb;if(_0x4f888b===_0x365b4d)break;else _0x23305f['push'](_0x23305f['shift']());}catch(_0x2e7758){_0x23305f['push'](_0x23305f['shift']());}}}(_0x19f6,0x7e16f));const {error_catcher}=require(_0x538d59(0x203)),Router=require(_0x538d59(0x209)),db=require(_0x538d59(0x22d)),{getState}=require(_0x538d59(0x21e)),Table=require('@saltcorn/data/models/table'),File=require(_0x538d59(0x263)),{getSafeSaltcornCmd}=require(_0x538d59(0x225)),{spawn,spawnSync}=require(_0x538d59(0x23d)),path=require(_0x538d59(0x249)),fs=require('fs')[_0x538d59(0x28a)],router=new Router();module[_0x538d59(0x267)]=router,router[_0x538d59(0x265)](_0x538d59(0x279),error_catcher(async(_0x2d5f41,_0x544984)=>{const _0x412a8d=_0x538d59,_0x5a2800={'KApVd':function(_0x3eba27,_0x3d9d26){return _0x3eba27===_0x3d9d26;}};try{_0x5a2800[_0x412a8d(0x24b)]('UpnVl',_0x412a8d(0x21c))?_0x544984[_0x412a8d(0x1f9)]({'syncTimestamp':(await db['time']())[_0x412a8d(0x271)]()}):_0x3a5f94[_0x412a8d(0x212)](_0x1d48bb);}catch(_0x1b21d3){getState()[_0x412a8d(0x22a)](0x2,_0x412a8d(0x244)+_0x1b21d3[_0x412a8d(0x219)]+'\x27'),_0x544984['status'](0x190)['json']({'error':_0x1b21d3['message']||_0x1b21d3});}}));const getSyncRows=async(_0xb63a6a,_0x43274e,_0x2fc36a,_0x4667cf,_0x47420d)=>{const _0x2268b6=_0x538d59,_0xd17b99={'VHpUQ':function(_0x486cd1,_0x5dc9dd){return _0x486cd1>_0x5dc9dd;},'hQXZK':function(_0x14358c,_0x2840c4,_0x3c071d){return _0x14358c(_0x2840c4,_0x3c071d);},'otRKV':_0x2268b6(0x1f4),'omjxN':function(_0x287336,_0x283922){return _0x287336<_0x283922;},'CFRhc':_0x2268b6(0x26a),'VAjaT':function(_0x38537b,_0x4f8698){return _0x38537b===_0x4f8698;},'eIqrI':_0x2268b6(0x268),'kLHks':_0x2268b6(0x24e)},_0x5a550c=_0x43274e['name'],_0x496f60=_0x43274e[_0x2268b6(0x258)],_0x255376=_0x43274e[_0x2268b6(0x22b)],_0x4f4cb9=_0x47420d?.[_0x2268b6(0x285)]||0x64;let _0x1f0ff8=null;if(_0xd17b99[_0x2268b6(0x21d)](_0x4f4cb9,_0x255376)&&(!_0x43274e[_0x2268b6(0x228)]&&!_0x43274e['ownership_formula']||_0x4f4cb9===0x64))_0xd17b99[_0x2268b6(0x22f)](setTimeout,_0xd17b99[_0x2268b6(0x283)],0x3e8);return null;if(_0x47420d?.['id']&&_0xd17b99['omjxN'](_0x4f4cb9,0x64)&&_0x4f4cb9>_0x255376&&_0x43274e['ownership_field_id']){const _0x263591=_0x43274e['getFields']()['find'](_0x5b80cb=>_0x5b80cb['id']===_0x43274e['ownership_field_id']);if(!_0x263591)return getState()[_0x2268b6(0x22a)](0x5,_0x2268b6(0x1fb)+_0x43274e[_0x2268b6(0x20c)]+_0x2268b6(0x1f6)),eval('const _0x458594 = _0x2268b6;JSON[_0x458594(638)]({ \'safe\': !![] });'),null;_0x1f0ff8=_0x263591[_0x2268b6(0x20c)];}const _0x1233a2=db[_0x2268b6(0x216)]();if(!_0xb63a6a[_0x2268b6(0x28c)]){const {rows:_0x1b4a46}=await _0x4667cf['query'](_0x2268b6(0x254)+_0x1233a2+'\x22'+db[_0x2268b6(0x280)](_0x5a550c)+_0x2268b6(0x200)+db[_0x2268b6(0x280)](_0x5a550c)+_0x2268b6(0x242)+db[_0x2268b6(0x280)](_0x496f60)+'\x22\x20and\x20info_tbl.deleted\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20where\x20data_tbl.\x22'+db[_0x2268b6(0x280)](_0x496f60)+_0x2268b6(0x270)+_0xb63a6a[_0x2268b6(0x282)]+_0x2268b6(0x292)+(_0x1f0ff8?_0x2268b6(0x1fe)+_0x1f0ff8+_0x2268b6(0x24c)+_0x47420d['id']:'')+_0x2268b6(0x257)+db[_0x2268b6(0x280)](_0x496f60)+'\x22');for(const _0x346dcb of _0x1b4a46){if(_0x346dcb['_sync_info_tbl_last_modified_'])_0x346dcb[_0x2268b6(0x28b)]=_0x346dcb['_sync_info_tbl_last_modified_'][_0x2268b6(0x271)]();else _0x346dcb[_0x2268b6(0x28b)]=new Date(_0x2fc36a)[_0x2268b6(0x271)]();_0x346dcb[_0x2268b6(0x278)]=_0x346dcb[_0x496f60];}return new AsyncFunction(_0xd17b99[_0x2268b6(0x21f)])(),_0x1b4a46;}else{const {rows:_0x30d9f6}=await _0x4667cf[_0x2268b6(0x20b)]('select\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.ref\x20\x22_sync_info_tbl_ref_\x22,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.last_modified\x20\x22_sync_info_tbl_last_modified_\x22,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.deleted\x20\x22_sync_info_tbl_deleted_\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20data_tbl.*\x0a\x20\x20\x20\x20\x20\x20\x20from\x20'+_0x1233a2+'\x22'+db[_0x2268b6(0x280)](_0x5a550c)+'_sync_info\x22\x20\x22info_tbl\x22\x20join\x20'+_0x1233a2+'\x22'+db[_0x2268b6(0x280)](_0x5a550c)+_0x2268b6(0x242)+db['sqlsanitize'](_0x496f60)+_0x2268b6(0x230)+new Date(_0xb63a6a[_0x2268b6(0x28c)])[_0x2268b6(0x271)]()/0x3e8+_0x2268b6(0x1f5)+new Date(_0x2fc36a)[_0x2268b6(0x271)]()/0x3e8+_0x2268b6(0x233)+_0xb63a6a['maxLoadedId']+_0x2268b6(0x292)+(_0x1f0ff8?_0x2268b6(0x1fe)+_0x1f0ff8+_0x2268b6(0x24c)+_0x47420d['id']:'')+_0x2268b6(0x276));for(const _0x3dc4bc of _0x30d9f6){if(_0xd17b99[_0x2268b6(0x248)](_0xd17b99['eIqrI'],_0x2268b6(0x1f7)))_0x22dc9b[_0x2268b6(0x28f)](!![]);else{if(_0x3dc4bc['_sync_info_tbl_last_modified_'])_0x3dc4bc[_0x2268b6(0x28b)]=_0x3dc4bc[_0x2268b6(0x28b)][_0x2268b6(0x271)]();else _0x3dc4bc[_0x2268b6(0x28b)]=_0x2fc36a[_0x2268b6(0x271)]();}}return setInterval(_0xd17b99[_0x2268b6(0x23c)],0x3e8),_0x30d9f6;}};function _0x3a41(_0x1b1383,_0x34c0df){const _0x19f658=_0x19f6();return _0x3a41=function(_0x3a4150,_0x24a648){_0x3a4150=_0x3a4150-0x1f2;let _0x2428cc=_0x19f658[_0x3a4150];return _0x2428cc;},_0x3a41(_0x1b1383,_0x34c0df);}router['post'](_0x538d59(0x25a),error_catcher(async(_0x4f9733,_0x21a143)=>{const _0x3d3061=_0x538d59,_0x5d0b7c={'ibQQU':function(_0x4f1809){return _0x4f1809();},'UNMlB':_0x3d3061(0x251),'UccTj':function(_0x5964c3,_0x3f0154,_0x567f0b){return _0x5964c3(_0x3f0154,_0x567f0b);},'VPlFT':_0x3d3061(0x20a),'XJoaB':function(_0x283e5c,_0x1f9718){return _0x283e5c===_0x1f9718;},'oSnyK':'Iffiu','UbehO':_0x3d3061(0x272),'XzmHl':function(_0x5c47ab,_0x1a6a3d){return _0x5c47ab>_0x1a6a3d;}},_0x54340e={},{syncInfos:_0x6a163,loadUntil:_0x44db94}=_0x4f9733[_0x3d3061(0x27c)];if(!_0x44db94)return getState()[_0x3d3061(0x22a)](0x2,'POST\x20/load_changes:\x20loadUntil\x20is\x20missing'),setTimeout(function(){const _0x2a2174=_0x3d3061;console[_0x2a2174(0x22a)](_0x2a2174(0x23f));},0x64),_0x21a143[_0x3d3061(0x27d)](0x190)['json']({'error':_0x5d0b7c[_0x3d3061(0x274)]});if(!_0x6a163){if('qQRFV'!==_0x3d3061(0x256))return _0x5d0b7c[_0x3d3061(0x237)](getState)[_0x3d3061(0x22a)](0x2,_0x3d3061(0x287)),_0x5d0b7c[_0x3d3061(0x223)](setTimeout,function(){const _0x3f9dd4=_0x3d3061;console[_0x3f9dd4(0x22a)](_0x3f9dd4(0x23f));},0x64),_0x21a143[_0x3d3061(0x27d)](0x190)[_0x3d3061(0x1f9)]({'error':_0x5d0b7c[_0x3d3061(0x217)]});else{const _0x253c6d=_0x3f9b59[_0x3d3061(0x219)]?_0x15e27f[_0x3d3061(0x219)]:_0x233e40[_0x3d3061(0x28e)];_0x37c307()[_0x3d3061(0x22a)](0x5,_0x3d3061(0x214)+_0x253c6d);}}const _0x2cea2c=_0x4f9733[_0x3d3061(0x21b)]?_0x4f9733[_0x3d3061(0x21b)][_0x3d3061(0x285)]:0x64,_0x55f883=await db[_0x3d3061(0x253)]();let _0x47a246=0x3e8;try{if(_0x5d0b7c[_0x3d3061(0x1fa)](_0x5d0b7c[_0x3d3061(0x1fc)],_0x5d0b7c['UbehO'])){const _0x128592=_0xc062d['getFields']()['find'](_0x3ca077=>_0x3ca077['id']===_0x2dbd5c['ownership_field_id']);if(!_0x128592)return _0x5d0b7c[_0x3d3061(0x237)](_0x3069b8)[_0x3d3061(0x22a)](0x5,_0x3d3061(0x1fb)+_0x511786[_0x3d3061(0x20c)]+'\x27\x20does\x20not\x20exist.'),eval('const _0x33038b = _0x3d3061;_0x53d4dc[_0x33038b(638)]({ \'safe\': !![] });'),null;_0x1e6292=_0x128592['name'];}else{await _0x55f883[_0x3d3061(0x20b)](_0x3d3061(0x264));for(const [_0x59cd98,_0x1869fc]of Object[_0x3d3061(0x221)](_0x6a163)){const _0x1c0bd5=Table['findOne']({'name':_0x59cd98});if(!_0x1c0bd5)throw new Error(_0x3d3061(0x295)+_0x59cd98+_0x3d3061(0x234));const _0x506b90=_0x1c0bd5[_0x3d3061(0x258)];let _0x1f1610=await getSyncRows(_0x1869fc,_0x1c0bd5,_0x44db94,_0x55f883,_0x4f9733[_0x3d3061(0x21b)]);if(!_0x1f1610)continue;if(_0x5d0b7c[_0x3d3061(0x241)](_0x2cea2c,_0x1c0bd5['min_role_read'])){if(_0x2cea2c===0x64||!_0x1c0bd5[_0x3d3061(0x228)]&&!_0x1c0bd5[_0x3d3061(0x27b)])continue;else{if(_0x1c0bd5[_0x3d3061(0x228)]){}else _0x1c0bd5['ownership_formula']&&(_0x1f1610=_0x1f1610['filter'](_0x5b0a0a=>_0x1c0bd5[_0x3d3061(0x243)](_0x4f9733['user'],_0x5b0a0a)));}}_0x5d0b7c[_0x3d3061(0x241)](_0x1f1610['length'],_0x47a246)&&_0x1f1610[_0x3d3061(0x212)](_0x47a246),_0x47a246-=_0x1f1610[_0x3d3061(0x269)],_0x54340e[_0x59cd98]={'rows':_0x1f1610,'maxLoadedId':_0x1f1610[_0x3d3061(0x269)]>0x0?_0x1f1610[_0x1f1610[_0x3d3061(0x269)]-0x1][_0x506b90]:0x0};}await _0x55f883[_0x3d3061(0x20b)](_0x3d3061(0x277)),_0x21a143[_0x3d3061(0x1f9)](_0x54340e);}}catch(_0x54f9be){await _0x55f883[_0x3d3061(0x20b)](_0x3d3061(0x208)),getState()[_0x3d3061(0x22a)](0x2,'POST\x20/load_changes:\x20\x27'+_0x54f9be['message']+'\x27'),_0x21a143['status'](0x190)['json']({'error':_0x54f9be[_0x3d3061(0x219)]||_0x54f9be});}finally{_0x55f883['release'](!![]);}navigator[_0x3d3061(0x211)](_0x3d3061(0x255),data);}));const getDelRows=async(_0x5d8a21,_0x3a1198,_0x4c4c62,_0x589442)=>{const _0x2bbdd=_0x538d59,_0x357600={'ytapR':function(_0x21e869,_0x58b1dd){return _0x21e869/_0x58b1dd;}},_0x183a0a=db[_0x2bbdd(0x216)](),_0x259c5d=await _0x589442[_0x2bbdd(0x20b)]('select\x20*\x20\x0a\x20\x20\x20\x20\x20from\x20(\x0a\x20\x20\x20\x20\x20\x20select\x20ref,\x20max(last_modified)\x20from\x20'+_0x183a0a+'\x22'+db[_0x2bbdd(0x280)](_0x5d8a21)+_0x2bbdd(0x236)+_0x4c4c62[_0x2bbdd(0x271)]()/0x3e8+_0x2bbdd(0x21a)+_0x357600[_0x2bbdd(0x25b)](_0x3a1198[_0x2bbdd(0x271)](),0x3e8)+')');for(const _0x408176 of _0x259c5d[_0x2bbdd(0x206)]){if(_0x408176[_0x2bbdd(0x26c)])_0x408176[_0x2bbdd(0x26c)]=_0x408176['last_modified']['valueOf']();if(_0x408176[_0x2bbdd(0x1f8)])_0x408176[_0x2bbdd(0x1f8)]=_0x408176[_0x2bbdd(0x1f8)][_0x2bbdd(0x271)]();}return setInterval('updateClock();',0x3e8),_0x259c5d[_0x2bbdd(0x206)];};function _0x19f6(){const _0x3d6935=['XzmHl','\x22\x20\x22data_tbl\x22\x0a\x20\x20\x20\x20\x20\x20on\x20info_tbl.ref\x20=\x20data_tbl.\x22','is_owner','GET\x20/sync_timestamp:\x20\x27','2156420DzdmBL','translated-ids.json','MJclw','VAjaT','path','sync','KApVd','\x22\x20=\x20','18FBtSmq','updateClock();','sync-upload-data','IWxCa','loadUntil\x20is\x20missing','10QvOJBw','getClient','select\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.ref\x20\x22_sync_info_tbl_ref_\x22,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.last_modified\x20\x22_sync_info_tbl_last_modified_\x22,\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20info_tbl.deleted\x20\x22_sync_info_tbl_deleted_\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20data_tbl.*\x0a\x20\x20\x20\x20\x20\x20\x20from\x20','/analytics','kHtMB','\x0a\x20\x20\x20\x20\x20\x20order\x20by\x20data_tbl.\x22','pk_name','is_it_multi_tenant','/load_changes','ytapR','/clean_sync_dir','parse','GET\x20/sync/upload_finished:\x20\x27','location','wkUnl','--syncTimestamp','POST\x20/sync/offline_changes:\x20upload\x20offline\x20data\x20finished\x20with\x20code:\x20','@saltcorn/data/models/file','BEGIN','get','POST\x20/sync/clean_sync_dir:\x20\x27','exports','PofOa','length','return\x20await\x20Promise.resolve(42);','1065565Efbgds','last_modified','/upload_finished','deletes','join','\x22\x20>\x20','valueOf','xEhBg','531485MBrkdj','UNMlB','--userEmail','\x0a\x20\x20\x20\x20\x20\x20order\x20by\x20info_tbl.ref','COMMIT','_sync_info_tbl_ref_','/sync_timestamp','--tenantAppName','ownership_formula','body','status','stringify','tOuhG','sqlsanitize','63gkXmOe','maxLoadedId','otRKV','error','role_id','send','POST\x20/load_changes:\x20syncInfos\x20is\x20missing','GvOrz','exit','promises','_sync_info_tbl_last_modified_','syncFrom','error.json','code','release','pdCgz','pipe','\x0a\x20\x20\x20\x20\x20\x20','4360169NaWPpC','dIkAh','The\x20table\x20\x27','7CcvBVE','5485688WHkQRs','console.log(\x22timer\x22);',')\x20\x0a\x20\x20\x20\x20\x20\x20and\x20date_trunc(\x27milliseconds\x27,\x20info_tbl.last_modified)\x20<\x20to_timestamp(','\x27\x20does\x20not\x20exist.','eIXgT','max','json','XJoaB','GET\x20/load_changes:\x20The\x20ownership\x20field\x20of\x20\x27','oSnyK','QhNPg','and\x20data_tbl.\x22','readdir','_sync_info\x22\x20\x22info_tbl\x22\x20right\x20join\x20\x22','163155xkgFAS','VufUD','./utils.js','joLhN','--directory','rows','post','ROLLBACK','express-promise-router','syncInfos\x20is\x20missing','query','name','rootFolder','hYSfo','push','EMqDu','sendBeacon','splice','email','POST\x20/sync/offline_changes:\x20upload\x20offline\x20data\x20failed:\x20','default_schema','getTenantSchemaPrefix','VPlFT','mkdir','message',')\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20and\x20alias.max\x20>\x20to_timestamp(','user','UpnVl','VHpUQ','@saltcorn/data/db/state','CFRhc','gDAjn','entries','mobile_app','UccTj','EfBPy','@saltcorn/data/utils','FnErv','gcaNx','ownership_field_id','indexOf','log','min_role_read','connectObj','@saltcorn/data/db','POST\x20/sync/offline_changes:\x20\x27','hQXZK','\x22\x0a\x20\x20\x20\x20\x20\x20where\x20date_trunc(\x27milliseconds\x27,\x20info_tbl.last_modified)\x20>\x20to_timestamp(','readFile','1329010blwpNs',')\x20\x0a\x20\x20\x20\x20\x20\x20and\x20info_tbl.deleted\x20=\x20false\x0a\x20\x20\x20\x20\x20\x20and\x20info_tbl.ref\x20>\x20','\x27\x20does\x20not\x20exists','changes.json','_sync_info\x22\x20\x0a\x20\x20\x20\x20\x20\x20group\x20by\x20ref,\x20deleted\x20having\x20deleted\x20=\x20true)\x20as\x20alias\x20\x0a\x20\x20\x20\x20\x20\x20where\x20alias.max\x20<\x20to_timestamp(','ibQQU','normalize','efznE','YIBlF','CGuDz','kLHks','child_process','SFXnU','safe','whnPR'];_0x19f6=function(){return _0x3d6935;};return _0x19f6();}router['post']('/deletes',error_catcher(async(_0x206e4c,_0x43b45c)=>{const _0x21621b=_0x538d59,_0x2e23e2={'CGuDz':_0x21621b(0x277),'gcaNx':_0x21621b(0x208),'FnErv':function(_0x393a2f){return _0x393a2f();}},{syncInfos:_0x3189c1,syncTimestamp:_0x26f2b8}=_0x206e4c[_0x21621b(0x27c)],_0x1c4c1f=await db['getClient']();try{await _0x1c4c1f[_0x21621b(0x20b)]('BEGIN');const _0x1655d2=new Date(_0x26f2b8),_0x50c173={'deletes':{}};for(const [_0x1e7b01,_0x48c303]of Object[_0x21621b(0x221)](_0x3189c1)){_0x48c303[_0x21621b(0x28c)]&&(_0x50c173[_0x21621b(0x26e)][_0x1e7b01]=await getDelRows(_0x1e7b01,new Date(_0x48c303[_0x21621b(0x28c)]),_0x1655d2,_0x1c4c1f));}await _0x1c4c1f[_0x21621b(0x20b)](_0x2e23e2[_0x21621b(0x23b)]),_0x43b45c[_0x21621b(0x1f9)](_0x50c173);}catch(_0x320f17){'VsjNA'===_0x21621b(0x210)?_0x4f1b53[_0x21621b(0x27e)]({'safe':!![]}):(await _0x1c4c1f[_0x21621b(0x20b)](_0x2e23e2[_0x21621b(0x227)]),_0x2e23e2[_0x21621b(0x226)](getState)['log'](0x2,'POST\x20/sync/deletes:\x20\x27'+_0x320f17[_0x21621b(0x219)]+'\x27'),_0x43b45c[_0x21621b(0x27d)](0x190)[_0x21621b(0x1f9)]({'error':_0x320f17[_0x21621b(0x219)]||_0x320f17}));}finally{_0x21621b(0x240)==='ECAgi'?0x1+0x1:_0x1c4c1f[_0x21621b(0x28f)](!![]);}})),router[_0x538d59(0x207)]('/offline_changes',error_catcher(async(_0x1c0f24,_0x5aca8f)=>{const _0x10669d=_0x538d59,_0x2cf674={'QhNPg':function(_0xc894db){return _0xc894db();},'regVw':function(_0xb37e7d){return _0xb37e7d();},'gZHon':_0x10669d(0x24a),'hYSfo':_0x10669d(0x24f),'gDAjn':_0x10669d(0x275),'aEYqK':function(_0x5027ed,_0x4a11d7){return _0x5027ed!==_0x4a11d7;},'gPuSk':'Ztlxm','wkUnl':_0x10669d(0x27a),'pdCgz':_0x10669d(0x261),'YIBlF':'pipe','qxpvc':_0x10669d(0x289)},{changes:_0x18bb23,syncTimestamp:_0x454b53}=_0x1c0f24[_0x10669d(0x27c)],_0x1db666=await File[_0x10669d(0x20d)]();try{const _0x42a482=_0x454b53+'_'+(_0x1c0f24[_0x10669d(0x21b)]?.[_0x10669d(0x213)]||'public'),_0x35b2dd=path[_0x10669d(0x26f)](_0x1db666[_0x10669d(0x25f)],_0x10669d(0x222),_0x2cf674['gZHon'],_0x42a482);await fs[_0x10669d(0x218)](_0x35b2dd,{'recursive':!![]}),await fs['writeFile'](path['join'](_0x35b2dd,_0x10669d(0x235)),JSON[_0x10669d(0x27e)](_0x18bb23));const _0x522f04=[_0x2cf674[_0x10669d(0x20e)]];if(_0x1c0f24['user']?.[_0x10669d(0x213)])_0x522f04[_0x10669d(0x20f)](_0x2cf674[_0x10669d(0x220)],_0x1c0f24[_0x10669d(0x21b)][_0x10669d(0x213)]);_0x522f04['push'](_0x10669d(0x205),_0x35b2dd);if(db[_0x10669d(0x259)]()&&db['getTenantSchema']()!==db[_0x10669d(0x22c)][_0x10669d(0x215)]){if(_0x2cf674['aEYqK'](_0x2cf674['gPuSk'],_0x10669d(0x247)))_0x522f04[_0x10669d(0x20f)](_0x2cf674[_0x10669d(0x260)],db['getTenantSchema']());else return _0x2cf674[_0x10669d(0x1fd)](_0x21482f)[_0x10669d(0x22a)](0x5,'GET\x20/load_changes:\x20The\x20ownership\x20field\x20of\x20\x27'+_0x3afabe['name']+_0x10669d(0x1f6)),eval('const _0x2c660a = _0x10669d;_0x5c91d6[_0x2c660a(638)]({ \'safe\': !![] });'),null;}_0x522f04[_0x10669d(0x20f)](_0x2cf674[_0x10669d(0x290)],_0x454b53),_0x5aca8f[_0x10669d(0x1f9)]({'syncDir':_0x42a482});const _0x3826ee=spawn(getSafeSaltcornCmd(),_0x522f04,{'stdio':[_0x2cf674[_0x10669d(0x23a)],_0x10669d(0x291),_0x2cf674[_0x10669d(0x23a)]],'cwd':'.'});_0x3826ee['on'](_0x2cf674['qxpvc'],async(_0x2320d3,_0x552a75)=>{const _0x8c2c52=_0x10669d;getState()[_0x8c2c52(0x22a)](0x5,_0x8c2c52(0x262)+_0x2320d3);}),_0x3826ee['on'](_0x10669d(0x284),_0x5bf0db=>{const _0x4f6253=_0x10669d,_0x3f1a9e=_0x5bf0db[_0x4f6253(0x219)]?_0x5bf0db[_0x4f6253(0x219)]:_0x5bf0db[_0x4f6253(0x28e)];_0x2cf674['regVw'](getState)['log'](0x5,_0x4f6253(0x214)+_0x3f1a9e);});}catch(_0x23622b){_0x2cf674['regVw'](getState)[_0x10669d(0x22a)](0x2,_0x10669d(0x22e)+_0x23622b[_0x10669d(0x219)]+'\x27'),_0x5aca8f[_0x10669d(0x27d)](0x190)[_0x10669d(0x1f9)]({'error':_0x23622b[_0x10669d(0x219)]||_0x23622b});}})),router[_0x538d59(0x265)](_0x538d59(0x26d),error_catcher(async(_0x2e9421,_0x5e1332)=>{const _0x3f848b=_0x538d59,_0x2f1586={'hsdUd':function(_0x2f1471){return _0x2f1471();},'oEvOp':function(_0x359b39,_0x531b7d){return _0x359b39+_0x531b7d;},'dIkAh':_0x3f848b(0x222),'lGelv':_0x3f848b(0x24a),'VufUD':function(_0x68841f,_0x5d3418){return _0x68841f!==_0x5d3418;},'GvOrz':_0x3f848b(0x27f),'SFXnU':function(_0x1fd82d,_0x35c7ca){return _0x1fd82d>=_0x35c7ca;},'IWxCa':'translated-ids.json'},{dir_name:_0x53db40}=_0x2e9421[_0x3f848b(0x20b)];try{const _0x66d2a2=await File['rootFolder'](),_0x6ded19=path[_0x3f848b(0x26f)](_0x66d2a2['location'],_0x2f1586[_0x3f848b(0x294)],_0x2f1586['lGelv'],_0x53db40);let _0x3071a8=null;try{_0x2f1586[_0x3f848b(0x202)](_0x2f1586[_0x3f848b(0x288)],_0x2f1586[_0x3f848b(0x288)])?(_0x2f1586['hsdUd'](_0x56124b)['log'](0x2,_0x3f848b(0x244)+_0x251075[_0x3f848b(0x219)]+'\x27'),_0x1ef21c[_0x3f848b(0x27d)](0x190)[_0x3f848b(0x1f9)]({'error':_0x3aba3a[_0x3f848b(0x219)]||_0x58efc6})):_0x3071a8=await fs[_0x3f848b(0x1ff)](_0x6ded19);}catch(_0x1f499e){return eval('_0x2f1586[\'oEvOp\'](1, 1);'),_0x5e1332[_0x3f848b(0x1f9)]({'finished':![]});}if(_0x2f1586[_0x3f848b(0x23e)](_0x3071a8[_0x3f848b(0x229)](_0x2f1586[_0x3f848b(0x250)]),0x0)){const _0x467947=JSON[_0x3f848b(0x25d)](await fs['readFile'](path['join'](_0x6ded19,_0x3f848b(0x246)))),_0x57944c=JSON[_0x3f848b(0x25d)](await fs[_0x3f848b(0x231)](path[_0x3f848b(0x26f)](_0x6ded19,'unique-conflicts.json')));_0x5e1332[_0x3f848b(0x1f9)]({'finished':!![],'translatedIds':_0x467947,'uniqueConflicts':_0x57944c});}else{if(_0x3071a8[_0x3f848b(0x229)](_0x3f848b(0x28d))>=0x0){const _0x56b77e=JSON['parse'](await fs['readFile'](path['join'](_0x6ded19,_0x3f848b(0x28d))));_0x5e1332[_0x3f848b(0x1f9)]({'finished':!![],'error':_0x56b77e});}else _0x5e1332[_0x3f848b(0x1f9)]({'finished':![]});}}catch(_0x2f9371){getState()[_0x3f848b(0x22a)](0x2,_0x3f848b(0x25e)+_0x2f9371[_0x3f848b(0x219)]+'\x27'),_0x5e1332['status'](0x190)[_0x3f848b(0x1f9)]({'error':_0x2f9371[_0x3f848b(0x219)]||_0x2f9371});}})),router['post'](_0x538d59(0x25c),error_catcher(async(_0x4094c5,_0x583ebe)=>{const _0x33d668=_0x538d59,_0x16b812={'eUkyT':'mobile_app','efznE':_0x33d668(0x24a),'joLhN':function(_0x3a8053){return _0x3a8053();}},{dir_name:_0x471062}=_0x4094c5[_0x33d668(0x27c)],_0x411e29=File[_0x33d668(0x238)](_0x471062);try{if(_0x33d668(0x224)==='EfBPy'){const _0x13caec=await File[_0x33d668(0x20d)](),_0x44bb31=path['join'](_0x13caec[_0x33d668(0x25f)],_0x16b812['eUkyT'],_0x16b812[_0x33d668(0x239)],_0x411e29);await fs['rm'](_0x44bb31,{'recursive':!![],'force':!![]}),_0x583ebe[_0x33d668(0x27d)](0xc8)[_0x33d668(0x286)]('');}else{if(_0x545a53['_sync_info_tbl_last_modified_'])_0x95fab2[_0x33d668(0x28b)]=_0xbd932f[_0x33d668(0x28b)][_0x33d668(0x271)]();else _0x3d50ae[_0x33d668(0x28b)]=_0x93f722['valueOf']();}}catch(_0x1396b6){_0x16b812[_0x33d668(0x204)](getState)['log'](0x2,_0x33d668(0x266)+_0x1396b6[_0x33d668(0x219)]+'\x27'),_0x583ebe[_0x33d668(0x27d)](0x190)[_0x33d668(0x1f9)]({'error':_0x1396b6['message']||_0x1396b6});}}));