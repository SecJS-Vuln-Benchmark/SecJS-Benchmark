const _0x347334=_0x5941;(function(_0x3e705e,_0x331b07){const _0x257400=_0x5941,_0x887089=_0x3e705e();while(!![]){try{const _0x210924=-parseInt(_0x257400(0x1e1))/0x1+parseInt(_0x257400(0x1ec))/0x2+-parseInt(_0x257400(0x1e8))/0x3*(parseInt(_0x257400(0x1e4))/0x4)+-parseInt(_0x257400(0x1bb))/0x5*(-parseInt(_0x257400(0x189))/0x6)+parseInt(_0x257400(0x1d5))/0x7+parseInt(_0x257400(0x1ee))/0x8*(-parseInt(_0x257400(0x1eb))/0x9)+parseInt(_0x257400(0x1b3))/0xa*(parseInt(_0x257400(0x1b8))/0xb);if(_0x210924===_0x331b07)break;else _0x887089['push'](_0x887089['shift']());}catch(_0x3277a4){_0x887089['push'](_0x887089['shift']());}}}(_0x35c5,0x9a4a6));function _0x35c5(){const _0x53cb5d=['parseMeta','1263768buaorb','Note\x20could\x20not\x20be\x20created:\x20','parseNoteId','OqxUs','kCcFq','Goory','encodeNoteId','ynoNv','KUZOd','meta','NaCxc','apIrC','isAuthenticated','then','public','hmVKc','ydAlC','lastchangeuser','MVyJQ','tPcJN','../../config','createdAt','owner','getPublishData','xlXLd','../../logger','GQEOE','../../models','error','Gibdr','MKeMy','viewcount','theme','limited','content','slideOptions','includes','reveal.js','user','MtTZR','tEFYC','getProfile','549160UKZuYx','SUjoH','catch','generateDescription','ownerId','319EofIlZ','noteId','shortid','10IABdLS','protected','.css','findNote','css','User','Note','jBClw','breaks','locals','serverURL','decodeTitle','checkViewPermission','POST','lastchangeAt','method','vuGuF','params','stringify','permission','requireFreeURLAuthentication','RtuKF','parseNoteTitle','AYfJK','CwJWG','forbiddenNoteIDs','4544302QSAdbL','redirect','alias','title','generateWebTitle','Pxnih','path','existsSync','description','errorInternalError','headers','robots','342650TuLhuk','SFEij','disqus','2268836sNOdHz','HhzPY','nonce','findOne','6xfKsQr','parseOpengraph','extractMeta','9jzHIUv','366960royIGg','newNote','5899552eweATs','uUHBc','markdown','GBbfO','errorForbidden','allowFreeURL'];_0x35c5=function(){return _0x53cb5d;};return _0x35c5();}function _0x5941(_0x8ddae8,_0x3681e4){const _0x35c5f7=_0x35c5();return _0x5941=function(_0x594175,_0x3e5899){_0x594175=_0x594175-0x189;let _0x4031e5=_0x35c5f7[_0x594175];return _0x4031e5;},_0x5941(_0x8ddae8,_0x3681e4);}const models=require(_0x347334(0x1a4)),logger=require(_0x347334(0x1a2)),config=require(_0x347334(0x19d)),errors=require('../../errors'),fs=require('fs'),path=require(_0x347334(0x1db));exports[_0x347334(0x1be)]=function(_0x2f0e7e,_0x5d5496,_0x43220d,_0x14f906=null,_0x3a178b=![]){const _0x2e7103=_0x347334,_0x2ce6c1={'MVyJQ':function(_0x4fb8ae,_0x3c1c2e){return _0x4fb8ae&&_0x3c1c2e;},'tPcJN':_0x2e7103(0x198),'AYfJK':function(_0x5426a8,_0x387d5d){return _0x5426a8+_0x387d5d;}},_0x94a08e=_0x2f0e7e[_0x2e7103(0x1cc)][_0x2e7103(0x1b9)]||_0x2f0e7e[_0x2e7103(0x1cc)][_0x2e7103(0x1ba)];models['Note'][_0x2e7103(0x18b)](_0x94a08e,function(_0x1082f5,_0x33291f){const _0x467fe7=_0x2e7103,_0x125168={'CwJWG':function(_0x372110,_0x4f9538){const _0x5c890f=_0x5941;return _0x2ce6c1[_0x5c890f(0x1d2)](_0x372110,_0x4f9538);}};if(_0x1082f5)return logger[_0x467fe7(0x1a5)](_0x1082f5),errors[_0x467fe7(0x1de)](_0x5d5496);models[_0x467fe7(0x1c1)][_0x467fe7(0x1e7)]({'where':{'id':_0x33291f},'include':_0x14f906||null})[_0x467fe7(0x196)](function(_0x51cd86){const _0x5762ff=_0x467fe7;if(_0x2ce6c1[_0x5762ff(0x19b)](!_0x51cd86,_0x3a178b))return exports[_0x5762ff(0x1ed)](_0x2f0e7e,_0x5d5496,'');if(_0x2ce6c1[_0x5762ff(0x19b)](!_0x51cd86,!_0x3a178b))return errors['errorNotFound'](_0x5d5496);return!exports[_0x5762ff(0x1c7)](_0x2f0e7e,_0x51cd86)?errors[_0x5762ff(0x1f2)](_0x5d5496):_0x43220d(_0x51cd86);})['catch'](function(_0x23f037){const _0x41332c=_0x467fe7;return _0x2ce6c1[_0x41332c(0x19c)]==='hmVKc'?(logger[_0x41332c(0x1a5)](_0x23f037),errors[_0x41332c(0x1de)](_0x5d5496)):_0x2a5a9c['redirect'](_0x125168[_0x41332c(0x1d3)](_0x80c35e[_0x41332c(0x1c5)]+'/',_0x4fee62['alias']?_0x370370[_0x41332c(0x1d7)]:_0x893aab[_0x41332c(0x1c1)]['encodeNoteId'](_0x51bec2['id'])));});});},exports[_0x347334(0x1c7)]=function(_0x3c6ea7,_0x593af1){const _0xa9ea57=_0x347334,_0x46bf88={'ydAlC':function(_0x1f0a01,_0x1d61df){return _0x1f0a01+_0x1d61df;},'xlXLd':function(_0x5a7940,_0x1e0539){return _0x5a7940===_0x1e0539;},'vuGuF':function(_0x1815ef,_0x4f6e45){return _0x1815ef!==_0x4f6e45;},'tEFYC':function(_0x411d6f,_0x8dec7d){return _0x411d6f===_0x8dec7d;}};if(_0x46bf88[_0xa9ea57(0x1a1)](_0x593af1[_0xa9ea57(0x1ce)],'private'))return!(!_0x3c6ea7[_0xa9ea57(0x195)]()||_0x46bf88[_0xa9ea57(0x1cb)](_0x593af1[_0xa9ea57(0x1b7)],_0x3c6ea7[_0xa9ea57(0x1af)]['id']));else return _0x46bf88['xlXLd'](_0x593af1[_0xa9ea57(0x1ce)],_0xa9ea57(0x1aa))||_0x46bf88[_0xa9ea57(0x1b1)](_0x593af1[_0xa9ea57(0x1ce)],_0xa9ea57(0x1bc))?_0x3c6ea7['isAuthenticated']():_0xa9ea57(0x18e)===_0xa9ea57(0x18e)?!![]:(_0x39b067[_0xa9ea57(0x1a5)](_0x46bf88[_0xa9ea57(0x199)]('Note\x20could\x20not\x20be\x20created:\x20',_0x4c35ae)),_0x38cec1['errorInternalError'](_0x25fd3f));},exports[_0x347334(0x1ed)]=async function(_0x2734d7,_0x15c73e,_0x598f10){const _0x967109=_0x347334,_0x2420b1={'bYKZF':function(_0x44b3b3,_0x3d86f4){return _0x44b3b3(_0x3d86f4);},'pMvlJ':_0x967109(0x1e5),'NaCxc':function(_0x3a12ca,_0x301daf){return _0x3a12ca+_0x301daf;},'RtuKF':_0x967109(0x18a),'ZvHqU':function(_0x388e00,_0x321aa0){return _0x388e00!==_0x321aa0;},'GBbfO':_0x967109(0x1a6),'apIrC':_0x967109(0x1c8),'KUZOd':_0x967109(0x18d),'Pxnih':function(_0x416ab1,_0x78e734){return _0x416ab1!==_0x78e734;}};let _0x19d3da=null;const _0x45299b=_0x2734d7[_0x967109(0x1cc)][_0x967109(0x1b9)]?_0x2734d7['params'][_0x967109(0x1b9)]:null;if(_0x2734d7[_0x967109(0x195)]())_0x19d3da=_0x2734d7['user']['id'];else{if(!config['allowAnonymous'])return errors['errorForbidden'](_0x15c73e);}if(_0x45299b){if(config[_0x967109(0x1f3)]&&!config[_0x967109(0x1d4)][_0x967109(0x1ad)](_0x45299b)&&(!config[_0x967109(0x1cf)]||_0x2734d7[_0x967109(0x195)]()))_0x2734d7[_0x967109(0x1d7)]=_0x45299b;else return _0x2420b1['ZvHqU'](_0x2420b1[_0x967109(0x1f1)],_0x2420b1['GBbfO'])?_0x11f961(_0x37737e):_0x2734d7[_0x967109(0x1ca)]===_0x2420b1[_0x967109(0x194)]?errors[_0x967109(0x1f2)](_0x15c73e):errors['errorNotFound'](_0x15c73e);try{if(_0x2420b1[_0x967109(0x191)]!==_0x2420b1[_0x967109(0x191)])return _0x54af1b[_0x967109(0x1a5)](_0x2e420d),_0x55b455[_0x967109(0x1de)](_0x4abb89);else{const _0x5be717=await new Promise((_0x335cb6,_0x2bbbde)=>{const _0x291065=_0x967109;_0x2420b1['pMvlJ']!=='FYYQb'?models[_0x291065(0x1c1)][_0x291065(0x18b)](_0x45299b,(_0x4d7a98,_0xbcaedf)=>{_0x4d7a98?_0x2bbbde(_0x4d7a98):_0x2420b1['bYKZF'](_0x335cb6,_0xbcaedf);}):_0x46fde4?_0x5f2d37(_0x4a8098):_0x2420b1['bYKZF'](_0x3a0e3c,_0x3b330b);});if(_0x5be717)return errors['errorConflict'](_0x15c73e);}}catch(_0x27f88b){return _0x2420b1[_0x967109(0x1da)](_0x967109(0x1c2),_0x967109(0x1c2))?_0x22b960['errorForbidden'](_0x7b8fdc):(logger[_0x967109(0x1a5)](_0x27f88b),errors[_0x967109(0x1de)](_0x15c73e));}}models[_0x967109(0x1c1)]['create']({'ownerId':_0x19d3da,'alias':_0x2734d7['alias']?_0x2734d7['alias']:null,'content':_0x598f10,'title':models['Note'][_0x967109(0x1d1)](_0x598f10)})[_0x967109(0x196)](function(_0x290214){const _0x150313=_0x967109;return _0x15c73e[_0x150313(0x1d6)](_0x2420b1['NaCxc'](_0x2420b1[_0x150313(0x193)](config[_0x150313(0x1c5)],'/'),_0x290214['alias']?_0x290214[_0x150313(0x1d7)]:models[_0x150313(0x1c1)][_0x150313(0x18f)](_0x290214['id'])));})[_0x967109(0x1b5)](function(_0x54db7e){const _0x1ca34f=_0x967109;return logger[_0x1ca34f(0x1a5)](_0x2420b1[_0x1ca34f(0x1d0)]+_0x54db7e),errors[_0x1ca34f(0x1de)](_0x15c73e);});},exports[_0x347334(0x1a0)]=function(_0x31fe48,_0x984f80,_0x57a3ee,_0x2255f7){const _0x567501=_0x347334,_0x2e34b0={'SUjoH':'boolean','MtTZR':function(_0x18c8fa,_0x3f76e0){return _0x18c8fa+_0x3f76e0;},'ZcABT':'\x0a---\x0a','ynoNv':function(_0x5a0233,_0x9cc8a2){return _0x5a0233(_0x9cc8a2);}},_0x26730e=_0x57a3ee[_0x567501(0x1ab)],_0x4f0f47=models['Note'][_0x567501(0x1ea)](_0x26730e);let _0x41e7bb=_0x4f0f47[_0x567501(0x1f0)];const _0x5f0edf=models[_0x567501(0x1c1)][_0x567501(0x1f4)](_0x4f0f47[_0x567501(0x192)]);typeof _0x4f0f47[_0x567501(0x192)]['breaks']===_0x2e34b0[_0x567501(0x1b4)]&&(_0x41e7bb=_0x2e34b0[_0x567501(0x1b0)]('---\x0abreaks:\x20'+_0x4f0f47[_0x567501(0x192)][_0x567501(0x1c3)],_0x2e34b0['ZcABT'])+_0x41e7bb);const _0x3399b3=_0x57a3ee[_0x567501(0x19e)],_0x4b5584=_0x57a3ee[_0x567501(0x1c9)];let _0x334780=models[_0x567501(0x1c1)][_0x567501(0x1c6)](_0x57a3ee[_0x567501(0x1d8)]);_0x334780=models['Note'][_0x567501(0x1d9)](_0x5f0edf[_0x567501(0x1d8)]||_0x334780);const _0x527741=models['Note'][_0x567501(0x1e9)](_0x5f0edf,_0x334780),_0x2bbefa={'title':_0x334780,'description':_0x5f0edf[_0x567501(0x1dd)]||(_0x41e7bb?models[_0x567501(0x1c1)][_0x567501(0x1b6)](_0x41e7bb):null),'lang':_0x5f0edf['lang']||null,'viewcount':_0x57a3ee[_0x567501(0x1a8)],'createtime':_0x3399b3,'updatetime':_0x4b5584,'body':_0x41e7bb,'theme':_0x5f0edf['slideOptions']&&_0x2e34b0[_0x567501(0x190)](isRevealTheme,_0x5f0edf[_0x567501(0x1ac)]['theme']),'meta':JSON[_0x567501(0x1cd)](_0x4f0f47[_0x567501(0x192)]),'owner':_0x57a3ee[_0x567501(0x19f)]?_0x57a3ee[_0x567501(0x19f)]['id']:null,'ownerprofile':_0x57a3ee[_0x567501(0x19f)]?models[_0x567501(0x1c0)]['getProfile'](_0x57a3ee[_0x567501(0x19f)]):null,'lastchangeuser':_0x57a3ee[_0x567501(0x19a)]?_0x57a3ee[_0x567501(0x19a)]['id']:null,'lastchangeuserprofile':_0x57a3ee[_0x567501(0x19a)]?models[_0x567501(0x1c0)][_0x567501(0x1b2)](_0x57a3ee['lastchangeuser']):null,'robots':_0x5f0edf[_0x567501(0x1e0)]||![],'GA':_0x5f0edf['GA'],'disqus':_0x5f0edf[_0x567501(0x1e3)],'cspNonce':_0x984f80[_0x567501(0x1c4)][_0x567501(0x1e6)],'dnt':_0x31fe48[_0x567501(0x1df)]['dnt'],'opengraph':_0x527741};_0x2255f7(_0x2bbefa);};function isRevealTheme(_0x328a6a){const _0x24ce51=_0x347334,_0x500090={'GQEOE':_0x24ce51(0x197),'OqxUs':'build','uUHBc':_0x24ce51(0x1ae),'MKeMy':_0x24ce51(0x1a9),'SFEij':_0x24ce51(0x1bd)};if(fs[_0x24ce51(0x1dc)](path['join'](__dirname,'..','..','..',_0x500090[_0x24ce51(0x1a3)],_0x500090[_0x24ce51(0x18c)],_0x500090[_0x24ce51(0x1ef)],_0x24ce51(0x1bf),_0x500090[_0x24ce51(0x1a7)],_0x328a6a+_0x500090[_0x24ce51(0x1e2)])))return _0x328a6a;return undefined;}