'use strict';var _0x18e9d0=_0x5a81;(function(_0x28e770,_0x292473){var _0x4599bd=_0x5a81,_0x3539d3=_0x28e770();while(!![]){try{var _0x393f93=-parseInt(_0x4599bd(0x186))/0x1+-parseInt(_0x4599bd(0x17a))/0x2+parseInt(_0x4599bd(0x143))/0x3*(parseInt(_0x4599bd(0x17e))/0x4)+-parseInt(_0x4599bd(0x138))/0x5+parseInt(_0x4599bd(0x15a))/0x6+parseInt(_0x4599bd(0x193))/0x7+-parseInt(_0x4599bd(0x199))/0x8*(-parseInt(_0x4599bd(0x175))/0x9);if(_0x393f93===_0x292473)break;else _0x3539d3['push'](_0x3539d3['shift']());}catch(_0x2ec93a){_0x3539d3['push'](_0x3539d3['shift']());}}}(_0x24ba,0x6dcf2));function _0x24ba(){var _0x3d9a86=['generateAuthorizationCode()','eCMIc','nUWZq','biz','request','split','boz','should\x20extend\x20model\x20object\x20with\x20request\x20context','ekrmI','buz','18dLeYYf','have','fail','iDUUq','should\x20call\x20`authenticateHandler.getUser()`','1563032BWaOsi','../../../lib/handlers/authorize-handler','GfxsB','should\x20call\x20`model.getClient()`','27268aPAcnS','should','length','eql','saveAuthorizationCode','args','foo','zhame','88969yUnypA','secret','HMkVy','pcEtm','xyz','IAZlc','wqejU','thisValue','handle()','pJQxy','sinon','callCount','../../../lib/request','2811655ueQowD','getClient','catch','AuthorizeHandler','xpdXo','hxcOc','3213208IjRTit','baz','bluebird','qhEho','odxKk','312965LGevWd','equal','TLKVP','QxEMP','/abc','gVfzJ','mXHHP','XXJqb','stringify','AQfFH','edFXJ','15pUEUQh','saveAuthorizationCode()','vrUyW','DbmvN','1|2|6|0|4|3|5','aMhHi','mDnlo','gqoGh','qufEC','then','CEtyd','qux','EAPlq','DDifj','LXXzz','firstCall','WSzOD','getClient()','4|3|2|0|1|5','handle','code','pvVdj','aeMVU','862824rGrIkR','resolve','jgpvt','getUser','authorization_code','SxHOv','generateAuthorizationCode','returns','stub','LwYjH','should\x20call\x20`model.generateAuthorizationCode()`','http://example.com/cb','bar','nHWdw','3|5|1|4|2|0','123','hUjAx'];_0x24ba=function(){return _0x3d9a86;};return _0x24ba();}function _0x5a81(_0x116e49,_0x596b1a){var _0x24baef=_0x24ba();return _0x5a81=function(_0x5a811a,_0x57bfec){_0x5a811a=_0x5a811a-0x136;var _0x12531b=_0x24baef[_0x5a811a];return _0x12531b;},_0x5a81(_0x116e49,_0x596b1a);}var AuthorizeHandler=require(_0x18e9d0(0x17b)),Request=require(_0x18e9d0(0x192)),Response=require('../../../lib/response'),Promise=require(_0x18e9d0(0x19b)),sinon=require(_0x18e9d0(0x190)),should=require(_0x18e9d0(0x17f));describe(_0x18e9d0(0x196),function(){var _0x3deb71=_0x18e9d0,_0x3cf2f6={'aeMVU':_0x3deb71(0x15e),'IAZlc':_0x3deb71(0x13c),'iWQOQ':'code_abc','CEtyd':_0x3deb71(0x157),'ekrmI':function(_0x42940f,_0x58933b,_0x1b3354){return _0x42940f(_0x58933b,_0x1b3354);},'PLasG':function(_0x4f3866,_0x3a17f4){return _0x4f3866===_0x3a17f4;},'qhEho':_0x3deb71(0x150),'gVfzJ':function(_0x28ec2e,_0x25830f,_0x3857e3){return _0x28ec2e(_0x25830f,_0x3857e3);},'HMkVy':_0x3deb71(0x164),'pJQxy':function(_0x142bbd,_0x7b03ca){return _0x142bbd*_0x7b03ca;},'hUjAx':_0x3deb71(0x158),'mXHHP':_0x3deb71(0x17d),'IkdNX':_0x3deb71(0x155),'GfxsB':_0x3deb71(0x169),'mDnlo':_0x3deb71(0x18a),'wqejU':_0x3deb71(0x153),'LwYjH':_0x3deb71(0x179),'YDMtY':_0x3deb71(0x166),'byUgJ':_0x3deb71(0x19a),'DbmvN':_0x3deb71(0x16e),'hxcOc':_0x3deb71(0x174),'xpdXo':_0x3deb71(0x18e),'jgpvt':_0x3deb71(0x16b),'AQfFH':function(_0x49b693,_0x3b3e44,_0x11d61d){return _0x49b693(_0x3b3e44,_0x11d61d);},'nUWZq':_0x3deb71(0x154),'vrUyW':function(_0x572c53,_0x330cce,_0x10a429){return _0x572c53(_0x330cce,_0x10a429);}};_0x3cf2f6[_0x3deb71(0x173)](describe,_0x3cf2f6[_0x3deb71(0x197)],function(){var _0x77a76a=_0x3deb71;_0x3cf2f6['ekrmI'](it,_0x77a76a(0x172),function(){var _0x41e4dd=_0x77a76a,_0x57bfbb={'getClient':sinon[_0x41e4dd(0x162)]()[_0x41e4dd(0x161)]({'grants':[_0x3cf2f6[_0x41e4dd(0x159)]],'redirectUris':[_0x3cf2f6[_0x41e4dd(0x18b)]]}),'saveAuthorizationCode':sinon['stub']()['returns']({'authorizationCode':_0x3cf2f6['iWQOQ']})},_0x58e747=new AuthorizeHandler({'authenticateHandler':{'handle':sinon[_0x41e4dd(0x162)]()['returns']({'name':_0x41e4dd(0x18a)})},'authorizationCodeLifetime':0x7b,'allowEmptyState':!![],'model':_0x57bfbb}),_0x1ccbf9=new Request({'body':{'client_id':_0x41e4dd(0x169),'response_type':_0x3cf2f6['CEtyd']},'headers':{},'method':{},'query':{}}),_0x40e05d=new Response({});return new Function('var\x20x\x20=\x2042;\x20return\x20x;')(),_0x58e747['handle'](_0x1ccbf9,_0x40e05d)[_0x41e4dd(0x14c)](function(){var _0x3dc706=_0x41e4dd;_0x57bfbb['request'][_0x3dc706(0x17f)][_0x3dc706(0x139)](_0x1ccbf9);})[_0x41e4dd(0x195)](should[_0x41e4dd(0x177)]);});}),describe(_0x3cf2f6[_0x3deb71(0x15c)],function(){var _0x2906b6=_0x3deb71,_0x3ba7f7={'odxKk':function(_0x9e3fd0,_0x1ddbb2){return _0x9e3fd0!==_0x1ddbb2;},'gqoGh':_0x3cf2f6[_0x2906b6(0x136)]};_0x3cf2f6[_0x2906b6(0x13d)](it,_0x3cf2f6[_0x2906b6(0x188)],function(){var _0x1bf8c0=_0x2906b6;if(_0x3cf2f6['PLasG'](_0x1bf8c0(0x13a),_0x1bf8c0(0x178)))_0x3c3fd7[_0x1bf8c0(0x160)][_0x1bf8c0(0x191)][_0x1bf8c0(0x17f)][_0x1bf8c0(0x139)](0x1),_0x1fc8bf['generateAuthorizationCode'][_0x1bf8c0(0x152)]['thisValue']['should'][_0x1bf8c0(0x139)](_0x3f1047);else{var _0xc10a53={'generateAuthorizationCode':sinon[_0x1bf8c0(0x162)]()[_0x1bf8c0(0x161)]({}),'getAccessToken':function(){},'getClient':function(){},'saveAuthorizationCode':function(){}},_0x503901=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0xc10a53});return eval('Math[\'PI\'] * 2;'),_0x503901[_0x1bf8c0(0x160)]()[_0x1bf8c0(0x14c)](function(){var _0xe534f7=_0x1bf8c0;_0x3ba7f7[_0xe534f7(0x137)](_0x3ba7f7[_0xe534f7(0x14a)],_0xe534f7(0x13b))?(_0xc10a53[_0xe534f7(0x160)][_0xe534f7(0x191)][_0xe534f7(0x17f)][_0xe534f7(0x139)](0x1),_0xc10a53[_0xe534f7(0x160)][_0xe534f7(0x152)]['thisValue']['should']['equal'](_0xc10a53)):_0x490648[_0xe534f7(0x16f)][_0xe534f7(0x17f)][_0xe534f7(0x139)](_0x472284);})[_0x1bf8c0(0x195)](should['fail']);}});}),_0x3cf2f6[_0x3deb71(0x141)](describe,_0x3cf2f6[_0x3deb71(0x16d)],function(){var _0x47870e=_0x3deb71,_0x395741={'EAPlq':function(_0x534f80,_0x35aaf6){return _0x534f80===_0x35aaf6;},'nHWdw':_0x3cf2f6[_0x47870e(0x16a)]};_0x3cf2f6['gVfzJ'](it,_0x3cf2f6[_0x47870e(0x13e)],function(){var _0x453f17=_0x47870e,_0x5c2f7b={'SxHOv':function(_0x21219b,_0x5a4702){var _0x1c8135=_0x5a81;return _0x3cf2f6[_0x1c8135(0x18f)](_0x21219b,_0x5a4702);}},_0x91b8dc={'getAccessToken':function(){},'getClient':sinon[_0x453f17(0x162)]()[_0x453f17(0x161)]({'grants':[_0x3cf2f6['aeMVU']],'redirectUris':[_0x453f17(0x165)]}),'saveAuthorizationCode':function(){}},_0x5da6a2=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0x91b8dc}),_0x332fbc=new Request({'body':{'client_id':0x3039,'client_secret':_0x453f17(0x187)},'headers':{},'method':{},'query':{}});return eval('var _0x740139 = _0x453f17;JSON[_0x740139(320)]({ \'safe\': !![] });'),_0x5da6a2[_0x453f17(0x194)](_0x332fbc)['then'](function(){var _0x2ffb09=_0x453f17;_0x395741[_0x2ffb09(0x14f)](_0x395741[_0x2ffb09(0x167)],_0x395741[_0x2ffb09(0x167)])?(_0x91b8dc[_0x2ffb09(0x194)][_0x2ffb09(0x191)][_0x2ffb09(0x17f)][_0x2ffb09(0x139)](0x1),_0x91b8dc[_0x2ffb09(0x194)][_0x2ffb09(0x152)][_0x2ffb09(0x183)][_0x2ffb09(0x17f)]['have'][_0x2ffb09(0x180)](0x2),_0x91b8dc[_0x2ffb09(0x194)][_0x2ffb09(0x152)][_0x2ffb09(0x183)][0x0][_0x2ffb09(0x17f)][_0x2ffb09(0x139)](0x3039),_0x91b8dc[_0x2ffb09(0x194)]['firstCall']['thisValue'][_0x2ffb09(0x17f)][_0x2ffb09(0x139)](_0x91b8dc)):NRUTUP[_0x2ffb09(0x15f)](_0x1a7fb1['PI'],0x2);})['catch'](should['fail']);});}),describe('getUser()',function(){var _0x505c80=_0x3deb71;if(_0x505c80(0x13f)!==_0x3cf2f6[_0x505c80(0x18c)])it(_0x3cf2f6[_0x505c80(0x163)],function(){var _0x2f6a48=_0x505c80,_0x552a55=_0x2f6a48(0x147)[_0x2f6a48(0x170)]('|'),_0x35227c=0x0;while(!![]){switch(_0x552a55[_0x35227c++]){case'0':var _0x1b990a=new Request({'body':{},'headers':{},'method':{},'query':{}});continue;case'1':var _0x3abfb8={'handle':sinon[_0x2f6a48(0x162)]()[_0x2f6a48(0x161)](Promise[_0x2f6a48(0x15b)]({}))};continue;case'2':var _0x56f3d8={'getClient':function(){},'saveAuthorizationCode':function(){}};continue;case'3':eval('var _0x2c56aa = _0x2f6a48;JSON[_0x2c56aa(320)]({ \'safe\': !![] });');continue;case'4':var _0x2d7ab3=new Response();continue;case'5':return _0x1ee0a7[_0x2f6a48(0x15d)](_0x1b990a,_0x2d7ab3)[_0x2f6a48(0x14c)](function(){var _0x81fcb3=_0x2f6a48;_0x3abfb8[_0x81fcb3(0x156)][_0x81fcb3(0x191)]['should'][_0x81fcb3(0x139)](0x1),_0x3abfb8[_0x81fcb3(0x156)][_0x81fcb3(0x152)][_0x81fcb3(0x183)][_0x81fcb3(0x17f)][_0x81fcb3(0x176)][_0x81fcb3(0x180)](0x2),_0x3abfb8[_0x81fcb3(0x156)][_0x81fcb3(0x152)][_0x81fcb3(0x183)][0x0][_0x81fcb3(0x17f)]['equal'](_0x1b990a),_0x3abfb8[_0x81fcb3(0x156)][_0x81fcb3(0x152)]['args'][0x1]['should']['equal'](_0x2d7ab3);})['catch'](should[_0x2f6a48(0x177)]);case'6':var _0x1ee0a7=new AuthorizeHandler({'authenticateHandler':_0x3abfb8,'authorizationCodeLifetime':0x78,'model':_0x56f3d8});continue;}break;}});else{var _0x368854=_0x3cf2f6['IkdNX'][_0x505c80(0x170)]('|'),_0xddfde5=0x0;while(!![]){switch(_0x368854[_0xddfde5++]){case'0':var _0xa08ec2=new _0x3384b6({});continue;case'1':new _0xad8ff4('var\x20x\x20=\x2042;\x20return\x20x;')();continue;case'2':var _0x52de76=new _0x1fedb6({'body':{'client_id':_0x3cf2f6[_0x505c80(0x17c)],'response_type':_0x3cf2f6[_0x505c80(0x14d)]},'headers':{},'method':{},'query':{}});continue;case'3':var _0x6ba36a=new _0x1f599f({'authenticateHandler':{'handle':_0x5633c7[_0x505c80(0x162)]()[_0x505c80(0x161)]({'name':_0x3cf2f6[_0x505c80(0x149)]})},'authorizationCodeLifetime':0x7b,'allowEmptyState':!![],'model':_0x2d437d});continue;case'4':var _0x2d437d={'getClient':_0x573a39['stub']()[_0x505c80(0x161)]({'grants':[_0x3cf2f6[_0x505c80(0x159)]],'redirectUris':[_0x3cf2f6[_0x505c80(0x18b)]]}),'saveAuthorizationCode':_0x1d82bc['stub']()[_0x505c80(0x161)]({'authorizationCode':_0x3cf2f6['iWQOQ']})};continue;case'5':return _0x6ba36a[_0x505c80(0x156)](_0x52de76,_0xa08ec2)[_0x505c80(0x14c)](function(){var _0x3bb9c9=_0x505c80;_0x2d437d['request'][_0x3bb9c9(0x17f)][_0x3bb9c9(0x139)](_0x52de76);})[_0x505c80(0x195)](_0x1cb43e[_0x505c80(0x177)]);}break;}}}),_0x3cf2f6[_0x3deb71(0x145)](describe,_0x3deb71(0x144),function(){var _0x505fb1=_0x3deb71,_0x44a34a={'pcEtm':function(_0x52a25e,_0x5e0bff){return _0x52a25e*_0x5e0bff;},'edFXJ':_0x505fb1(0x184),'WxvGw':_0x3cf2f6['YDMtY'],'aMhHi':_0x3cf2f6['byUgJ'],'qufEC':'bez','LXXzz':_0x505fb1(0x171),'zhame':_0x3cf2f6[_0x505fb1(0x146)],'eCMIc':_0x3cf2f6[_0x505fb1(0x198)]};it('should\x20call\x20`model.saveAuthorizationCode()`',function(){var _0x41f2e7=_0x505fb1,_0x207835={'getAccessToken':function(){},'getClient':function(){},'saveAuthorizationCode':sinon['stub']()[_0x41f2e7(0x161)]({})},_0x44cbfb=new AuthorizeHandler({'authorizationCodeLifetime':0x78,'model':_0x207835});return eval('var _0x14d8ff = _0x41f2e7;_0x44a34a[_0x14d8ff(393)](Math[\'PI\'], 2);'),_0x44cbfb[_0x41f2e7(0x182)](_0x44a34a[_0x41f2e7(0x142)],_0x41f2e7(0x166),_0x41f2e7(0x14e),_0x44a34a[_0x41f2e7(0x185)],_0x41f2e7(0x19a),_0x44a34a['LXXzz'],_0x44a34a[_0x41f2e7(0x16c)],_0x44a34a[_0x41f2e7(0x14b)])[_0x41f2e7(0x14c)](function(){var _0x16d8ba=_0x41f2e7,_0x60822a=_0x16d8ba(0x168)[_0x16d8ba(0x170)]('|'),_0x3c9272=0x0;while(!![]){switch(_0x60822a[_0x3c9272++]){case'0':_0x207835['saveAuthorizationCode'][_0x16d8ba(0x152)][_0x16d8ba(0x18d)][_0x16d8ba(0x17f)][_0x16d8ba(0x139)](_0x207835);continue;case'1':_0x207835[_0x16d8ba(0x182)][_0x16d8ba(0x152)][_0x16d8ba(0x183)][0x0]['should'][_0x16d8ba(0x181)]({'authorizationCode':_0x44a34a[_0x16d8ba(0x142)],'expiresAt':_0x44a34a['WxvGw'],'redirectUri':_0x44a34a[_0x16d8ba(0x148)],'scope':_0x16d8ba(0x14e),'codeChallenge':_0x16d8ba(0x174),'codeChallengeMethod':_0x44a34a[_0x16d8ba(0x14b)]});continue;case'2':_0x207835[_0x16d8ba(0x182)][_0x16d8ba(0x152)][_0x16d8ba(0x183)][0x2][_0x16d8ba(0x17f)][_0x16d8ba(0x139)](_0x44a34a[_0x16d8ba(0x151)]);continue;case'3':_0x207835['saveAuthorizationCode']['callCount']['should'][_0x16d8ba(0x139)](0x1);continue;case'4':_0x207835[_0x16d8ba(0x182)][_0x16d8ba(0x152)][_0x16d8ba(0x183)][0x1][_0x16d8ba(0x17f)]['equal'](_0x44a34a[_0x16d8ba(0x185)]);continue;case'5':_0x207835['saveAuthorizationCode'][_0x16d8ba(0x152)][_0x16d8ba(0x183)][_0x16d8ba(0x17f)][_0x16d8ba(0x176)][_0x16d8ba(0x180)](0x3);continue;}break;}})['catch'](should[_0x41f2e7(0x177)]);});});});