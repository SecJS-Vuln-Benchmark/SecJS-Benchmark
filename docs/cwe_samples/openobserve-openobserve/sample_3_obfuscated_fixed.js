'use strict';const _0x48391d=_0x230d;(function(_0x5ac5e8,_0x1a9ab9){const _0x1ef966=_0x230d,_0x3f9497=_0x5ac5e8();while(!![]){try{const _0x4c1f06=-parseInt(_0x1ef966(0x15b))/0x1+-parseInt(_0x1ef966(0x13e))/0x2+parseInt(_0x1ef966(0x15e))/0x3*(parseInt(_0x1ef966(0x152))/0x4)+-parseInt(_0x1ef966(0x12f))/0x5*(parseInt(_0x1ef966(0x15a))/0x6)+-parseInt(_0x1ef966(0x160))/0x7*(-parseInt(_0x1ef966(0x150))/0x8)+-parseInt(_0x1ef966(0x140))/0x9+-parseInt(_0x1ef966(0x161))/0xa*(-parseInt(_0x1ef966(0x131))/0xb);if(_0x4c1f06===_0x1a9ab9)break;else _0x3f9497['push'](_0x3f9497['shift']());}catch(_0x461c65){_0x3f9497['push'](_0x3f9497['shift']());}}}(_0x2b45,0x3d3b6));const http=require(_0x48391d(0x148)),crypto=require(_0x48391d(0x162)),querystring=require(_0x48391d(0x15d));function _0x2b45(){const _0xf67da4=['cbwkd','base64','length','writeHead','efWqp','options','expiresIn','randomBytes','listen','545498SVRvfa','error','4040343VmXpuf','push','generateAccessToken','port','stringify','concat','createServer','prototype','http','addUser','Yvjck','XvOQP','data','refreshToken','users','start','4008008iydhrZ','onUpdate','5632ObMUbi','accessToken','DVkdq','close','stop','Bearer','toString','end','54OiOgUb','352872EjhtNj','Invalid\x20refresh\x20token','querystring','933iYRuct','server','7EQRZxf','3490uvXIwz','crypto','validateAccessToken','eIldD','dejCu','application/json','once','BkCed','106765IdHXhR','refresh_token','18238TuoQZz','BJdvr','jPztJ','now'];_0x2b45=function(){return _0xf67da4;};return _0x2b45();}module['exports']=function(_0x365642){return new OAuthServer(_0x365642);};function OAuthServer(_0x3b03f7){const _0x328190=_0x48391d,_0x4ffdbd={'DVkdq':function(_0x28dc06,_0xdc602b){return _0x28dc06(_0xdc602b);}};this[_0x328190(0x13a)]=_0x3b03f7||{},this['users']={},this['tokens']={},this[_0x328190(0x13a)][_0x328190(0x143)]=_0x4ffdbd[_0x328190(0x154)](Number,this[_0x328190(0x13a)]['port'])||0xc08,this[_0x328190(0x13a)][_0x328190(0x13b)]=Number(this[_0x328190(0x13a)][_0x328190(0x13b)])||0xe10;}function _0x230d(_0x1e4475,_0x5df5b1){const _0x2b45c2=_0x2b45();return _0x230d=function(_0x230db3,_0x506df0){_0x230db3=_0x230db3-0x12a;let _0x489986=_0x2b45c2[_0x230db3];return _0x489986;},_0x230d(_0x1e4475,_0x5df5b1);}OAuthServer[_0x48391d(0x147)][_0x48391d(0x149)]=function(_0x4d135b,_0x527ef2){const _0x5c40ba=_0x48391d;let _0x289cf0={'username':_0x4d135b,'refreshToken':_0x527ef2||crypto[_0x5c40ba(0x13c)](0xa)[_0x5c40ba(0x158)](_0x5c40ba(0x136))};return this['users'][_0x4d135b]=_0x289cf0,this['tokens'][_0x289cf0[_0x5c40ba(0x14d)]]=_0x4d135b,this[_0x5c40ba(0x142)](_0x289cf0[_0x5c40ba(0x14d)]);},OAuthServer[_0x48391d(0x147)][_0x48391d(0x142)]=function(_0x588e6e){const _0x79338c=_0x48391d,_0x1cb716={'cbwkd':_0x79338c(0x15c),'XKcpr':function(_0x382341,_0x3ff1ea){return _0x382341+_0x3ff1ea;},'Yvjck':function(_0x341506,_0x45c366){return _0x341506*_0x45c366;}};let _0x429895=this['tokens'][_0x588e6e],_0x16b6c3=crypto['randomBytes'](0xa)[_0x79338c(0x158)]('base64');if(!_0x429895)return{'error':_0x1cb716[_0x79338c(0x135)]};return this[_0x79338c(0x14e)][_0x429895]['accessToken']=_0x16b6c3,this[_0x79338c(0x14e)][_0x429895][_0x79338c(0x13b)]=_0x1cb716['XKcpr'](Date[_0x79338c(0x134)],_0x1cb716[_0x79338c(0x14a)](this[_0x79338c(0x13a)][_0x79338c(0x13b)],0x3e8)),this[_0x79338c(0x13a)][_0x79338c(0x151)]&&this[_0x79338c(0x13a)][_0x79338c(0x151)](_0x429895,_0x16b6c3),{'access_token':_0x16b6c3,'expires_in':this[_0x79338c(0x13a)][_0x79338c(0x13b)],'token_type':_0x79338c(0x157)};},OAuthServer[_0x48391d(0x147)][_0x48391d(0x163)]=function(_0x5440ee,_0x2296e3){const _0x519922=_0x48391d;return!this['users'][_0x5440ee]||this[_0x519922(0x14e)][_0x5440ee][_0x519922(0x153)]!==_0x2296e3||this[_0x519922(0x14e)][_0x5440ee][_0x519922(0x13b)]<Date[_0x519922(0x134)]()?![]:!![];},OAuthServer[_0x48391d(0x147)][_0x48391d(0x14f)]=function(_0x1a8a3c){const _0xf9faad=_0x48391d,_0x4b1621={'BJdvr':_0xf9faad(0x139),'jPztJ':_0xf9faad(0x14c),'dejCu':'end'};this[_0xf9faad(0x15f)]=http[_0xf9faad(0x146)]((_0x4341c3,_0x405737)=>{const _0x3a79ea=_0xf9faad,_0x399168={'XvOQP':_0x4b1621[_0x3a79ea(0x132)]};let _0x442d88=[],_0x1b916a=0x0;_0x4341c3['on'](_0x4b1621[_0x3a79ea(0x133)],_0x319181=>{const _0x4b9839=_0x3a79ea;if(!_0x319181||!_0x319181[_0x4b9839(0x137)])return;_0x442d88[_0x4b9839(0x141)](_0x319181),_0x1b916a+=_0x319181['length'];}),_0x4341c3[_0x3a79ea(0x12d)](_0x4b1621[_0x3a79ea(0x12b)],()=>{const _0x2a56ca=_0x3a79ea,_0x49841a={'BkCed':_0x2a56ca(0x12c)};if(_0x2a56ca(0x12a)===_0x399168[_0x2a56ca(0x14b)]){let _0x3fd555=_0x453f84['parse'](_0x26acd6[_0x2a56ca(0x145)](_0x295877,_0x584a68)[_0x2a56ca(0x158)]()),_0x12ba28=this[_0x2a56ca(0x142)](_0x3fd555[_0x2a56ca(0x130)]);_0x3bdbce[_0x2a56ca(0x138)](!_0x12ba28[_0x2a56ca(0x13f)]?0xc8:0x191,{'Content-Type':_0x49841a[_0x2a56ca(0x12e)]}),_0x2ce26d[_0x2a56ca(0x159)](_0x546813[_0x2a56ca(0x144)](_0x12ba28));}else{let _0x32bdc5=querystring['parse'](Buffer[_0x2a56ca(0x145)](_0x442d88,_0x1b916a)[_0x2a56ca(0x158)]()),_0x15200d=this['generateAccessToken'](_0x32bdc5['refresh_token']);_0x405737[_0x2a56ca(0x138)](!_0x15200d[_0x2a56ca(0x13f)]?0xc8:0x191,{'Content-Type':'application/json'}),_0x405737[_0x2a56ca(0x159)](JSON[_0x2a56ca(0x144)](_0x15200d));}});}),this[_0xf9faad(0x15f)][_0xf9faad(0x13d)](this['options']['port'],_0x1a8a3c);},OAuthServer[_0x48391d(0x147)][_0x48391d(0x156)]=function(_0x13efb6){const _0x210d2e=_0x48391d;this['server'][_0x210d2e(0x155)](_0x13efb6);};