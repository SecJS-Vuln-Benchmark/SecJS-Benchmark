'use strict';const _0xdc03f5=_0x13b8;(function(_0x127d54,_0x4724ea){const _0x189730=_0x13b8,_0x3e69d1=_0x127d54();while(!![]){try{const _0x5a4ca1=-parseInt(_0x189730(0x93))/0x1*(-parseInt(_0x189730(0x76))/0x2)+-parseInt(_0x189730(0x91))/0x3+-parseInt(_0x189730(0x9a))/0x4+parseInt(_0x189730(0x75))/0x5+-parseInt(_0x189730(0x8e))/0x6*(parseInt(_0x189730(0x8f))/0x7)+-parseInt(_0x189730(0x7d))/0x8+-parseInt(_0x189730(0x94))/0x9*(-parseInt(_0x189730(0x86))/0xa);if(_0x5a4ca1===_0x4724ea)break;else _0x3e69d1['push'](_0x3e69d1['shift']());}catch(_0x51bb12){_0x3e69d1['push'](_0x3e69d1['shift']());}}}(_0x2cc6,0x1d66a));function _0x13b8(_0x2311a1,_0x4bfb5a){const _0x2cc684=_0x2cc6();return _0x13b8=function(_0x13b815,_0x384fc6){_0x13b815=_0x13b815-0x6f;let _0x2d3bad=_0x2cc684[_0x13b815];return _0x2d3bad;},_0x13b8(_0x2311a1,_0x4bfb5a);}function _0x2cc6(){const _0x4bbb4f=['concat','writeHead','onUpdate','close','end','parse','50ijsIbN','querystring','users','start','toString','stringify','exports','FSzRn','361206fWsfIU','14zPRLUA','http','424941hOSsuC','mbCVs','1gGdNrg','563373PSaGrd','Invalid\x20refresh\x20token','server','randomBytes','OPSUE','tokens','396448LNASAu','RSZmt','accessToken','pwLYv','error','port','length','refreshToken','now','566495WTiXay','476914urnDHu','Bearer','options','3|4|2|1|0','listen','expiresIn','rjtmE','1465232AlCsFx','generateAccessToken','prototype'];_0x2cc6=function(){return _0x4bbb4f;};return _0x2cc6();}const http=require(_0xdc03f5(0x90)),crypto=require('crypto'),querystring=require(_0xdc03f5(0x87));module[_0xdc03f5(0x8c)]=function(_0x3bcac3){return new OAuthServer(_0x3bcac3);};function OAuthServer(_0x3c424b){const _0x562427=_0xdc03f5,_0x92a993={'GahMV':function(_0x2ea940,_0x2aabd7){return _0x2ea940(_0x2aabd7);}},_0x40489e=_0x562427(0x79)['split']('|');let _0x548705=0x0;while(!![]){switch(_0x40489e[_0x548705++]){case'0':this['options'][_0x562427(0x7b)]=_0x92a993['GahMV'](Number,this['options'][_0x562427(0x7b)])||0xe10;continue;case'1':this[_0x562427(0x78)][_0x562427(0x71)]=Number(this['options']['port'])||0xc08;continue;case'2':this[_0x562427(0x99)]={};continue;case'3':this['options']=_0x3c424b||{};continue;case'4':this[_0x562427(0x88)]={};continue;}break;}}OAuthServer[_0xdc03f5(0x7f)]['addUser']=function(_0x2870b3,_0x5a1d34){const _0x493348=_0xdc03f5;let _0x340cc0={'username':_0x2870b3,'refreshToken':_0x5a1d34||crypto[_0x493348(0x97)](0xa)[_0x493348(0x8a)]('base64')};return this[_0x493348(0x88)][_0x2870b3]=_0x340cc0,this[_0x493348(0x99)][_0x340cc0[_0x493348(0x73)]]=_0x2870b3,this[_0x493348(0x7e)](_0x340cc0['refreshToken']);},OAuthServer[_0xdc03f5(0x7f)][_0xdc03f5(0x7e)]=function(_0x4a06e7){const _0x66f32b=_0xdc03f5,_0x36157f={'rjtmE':'tzuOs','pwLYv':function(_0x1f2a36,_0x1410ef){return _0x1f2a36+_0x1410ef;}};let _0xfa22d=this[_0x66f32b(0x99)][_0x4a06e7],_0x5716b0=crypto[_0x66f32b(0x97)](0xa)[_0x66f32b(0x8a)]('base64');if(!_0xfa22d)return _0x36157f[_0x66f32b(0x7c)]===_0x66f32b(0x9b)?{'error':_0x66f32b(0x95)}:{'error':_0x66f32b(0x95)};return this[_0x66f32b(0x88)][_0xfa22d][_0x66f32b(0x9c)]=_0x5716b0,this[_0x66f32b(0x88)][_0xfa22d][_0x66f32b(0x7b)]=_0x36157f[_0x66f32b(0x6f)](Date[_0x66f32b(0x74)],this[_0x66f32b(0x78)][_0x66f32b(0x7b)]*0x3e8),this[_0x66f32b(0x78)][_0x66f32b(0x82)]&&this['options'][_0x66f32b(0x82)](_0xfa22d,_0x5716b0),{'access_token':_0x5716b0,'expires_in':this[_0x66f32b(0x78)][_0x66f32b(0x7b)],'token_type':_0x66f32b(0x77)};},OAuthServer[_0xdc03f5(0x7f)]['validateAccessToken']=function(_0x3b7b1d,_0x22d0ca){const _0x560147=_0xdc03f5,_0x396da9={'FSzRn':function(_0x103da9,_0x1f274a){return _0x103da9!==_0x1f274a;}};return!this['users'][_0x3b7b1d]||_0x396da9[_0x560147(0x8d)](this['users'][_0x3b7b1d][_0x560147(0x9c)],_0x22d0ca)||this['users'][_0x3b7b1d]['expiresIn']<Date['now']()?![]:!![];},OAuthServer[_0xdc03f5(0x7f)][_0xdc03f5(0x89)]=function(_0x159141){const _0x3c6718=_0xdc03f5,_0x44d99d={'mbCVs':'application/json','OPSUE':'data'};this[_0x3c6718(0x96)]=http['createServer']((_0x2f44f2,_0x1ad164)=>{const _0x48930f=_0x3c6718;let _0x35895f=[],_0x42fe3c=0x0;_0x2f44f2['on'](_0x44d99d[_0x48930f(0x98)],_0x3fe203=>{const _0x1d20d0=_0x48930f;if(!_0x3fe203||!_0x3fe203[_0x1d20d0(0x72)])return;_0x35895f['push'](_0x3fe203),_0x42fe3c+=_0x3fe203[_0x1d20d0(0x72)];}),_0x2f44f2['on']('end',()=>{const _0x5272d8=_0x48930f;let _0x36c112=querystring[_0x5272d8(0x85)](Buffer[_0x5272d8(0x80)](_0x35895f,_0x42fe3c)[_0x5272d8(0x8a)]()),_0x28d627=this[_0x5272d8(0x7e)](_0x36c112['refresh_token']);_0x1ad164[_0x5272d8(0x81)](!_0x28d627[_0x5272d8(0x70)]?0xc8:0x191,{'Content-Type':_0x44d99d[_0x5272d8(0x92)]}),_0x1ad164[_0x5272d8(0x84)](JSON[_0x5272d8(0x8b)](_0x28d627));});}),this[_0x3c6718(0x96)][_0x3c6718(0x7a)](this[_0x3c6718(0x78)][_0x3c6718(0x71)],_0x159141);},OAuthServer[_0xdc03f5(0x7f)]['stop']=function(_0x1e2b1e){const _0x1c56ee=_0xdc03f5;this['server'][_0x1c56ee(0x83)](_0x1e2b1e);};