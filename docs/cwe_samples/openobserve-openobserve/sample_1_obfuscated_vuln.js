'use strict';const _0x2ca63f=_0xd644;(function(_0x380276,_0x52f1f5){const _0x5ad04e=_0xd644,_0x1308e6=_0x380276();while(!![]){try{const _0x57181a=parseInt(_0x5ad04e(0x8f))/0x1*(parseInt(_0x5ad04e(0x89))/0x2)+-parseInt(_0x5ad04e(0x9d))/0x3+-parseInt(_0x5ad04e(0xb4))/0x4*(parseInt(_0x5ad04e(0x87))/0x5)+-parseInt(_0x5ad04e(0x90))/0x6*(parseInt(_0x5ad04e(0xb6))/0x7)+parseInt(_0x5ad04e(0xaf))/0x8*(-parseInt(_0x5ad04e(0x97))/0x9)+parseInt(_0x5ad04e(0x91))/0xa+-parseInt(_0x5ad04e(0xb5))/0xb*(-parseInt(_0x5ad04e(0x9c))/0xc);if(_0x57181a===_0x52f1f5)break;else _0x1308e6['push'](_0x1308e6['shift']());}catch(_0xc2fc3b){_0x1308e6['push'](_0x1308e6['shift']());}}}(_0x5e44,0x9f454));function _0x5e44(){const _0x3f86f5=['MhiHn','not','UtSCb','join','shift','tGbwq','hCzbN','265945oUUJOb','nEEoJ','8ueSGdE','PZAAb','VKGMD','hash','klvdJ','expect','95471JSNnSu','228eWSxbb','11845610ehqRFd','write','IhlyC','length','utf-8','qLcpA','877833iHIJjJ','split','Should\x20calculate\x20body\x20hash\x20byte\x20by\x20byte','exist','eXobb','12RpPpMA','2223648plSlcY','bFrSf','jziNp','/fixtures/message1.eml','zKwAE','DKIM\x20RelaxedBody\x20Tests','D2H5TEwtUgM2u8Ew0gG6vnt/Na6L+Zep7apmSmfy8IQ=','equal','QYJpA','sha256','from','Gbohw','readFile','replace','\x0d\x0a\x0d\x0a','config','NbGqE','pkEgt','104WAPQHI','end','QBPKW','includeStack','YZEmB','40TdqSZp','27945874IwLbGY','168280nkXTbo'];_0x5e44=function(){return _0x3f86f5;};return _0x5e44();}const chai=require('chai'),expect=chai[_0x2ca63f(0x8e)];let fs=require('fs'),RelaxedBody=require('../../lib/dkim/relaxed-body');function _0xd644(_0x590638,_0x556c4b){const _0x5e44fc=_0x5e44();return _0xd644=function(_0xd64499,_0x4bddad){_0xd64499=_0xd64499-0x86;let _0x399903=_0x5e44fc[_0xd64499];return _0x399903;},_0xd644(_0x590638,_0x556c4b);}chai[_0x2ca63f(0xac)][_0x2ca63f(0xb2)]=!![],describe(_0x2ca63f(0xa2),function(){const _0x2ae582=_0x2ca63f,_0x8dc3bb={'hCzbN':function(_0x4e502f,_0x392287){return _0x4e502f(_0x392287);},'qLcpA':function(_0x38ff61,_0x4cb0c9){return _0x38ff61(_0x4cb0c9);},'NbGqE':_0x2ae582(0xb3),'IhlyC':_0x2ae582(0xa6),'QYJpA':_0x2ae582(0xa0),'ptrUw':_0x2ae582(0x95),'eXobb':_0x2ae582(0x99),'fKOpo':function(_0x501967,_0x120511,_0xf30283){return _0x501967(_0x120511,_0xf30283);}};it(_0x8dc3bb[_0x2ae582(0x9b)],function(_0x4c871d){const _0x2a1080=_0x2ae582,_0x597bcc={'zKwAE':_0x2a1080(0x8c),'UtSCb':function(_0x54af48,_0x2d2c26){const _0x311a51=_0x2a1080;return _0x8dc3bb[_0x311a51(0x96)](_0x54af48,_0x2d2c26);},'XvJod':_0x2a1080(0xa6)};if(_0x8dc3bb['NbGqE']!==_0x8dc3bb[_0x2a1080(0xad)]){if(_0x54aca1>=_0x499b57[_0x2a1080(0x94)])return _0x4a55f0['end']();let _0x4c405f=_0x4f2f64['from']([_0x2f85d4[_0x4f1075++]]);_0xcce1d4[_0x2a1080(0x92)](_0x4c405f),_0x8dc3bb[_0x2a1080(0x86)](_0x52994a,_0x884fbc);}else fs[_0x2a1080(0xa9)](__dirname+_0x2a1080(0xa0),_0x2a1080(0x95),(_0x12f232,_0x1d0909)=>{const _0x2138e5=_0x2a1080,_0x11e438={'MhiHn':_0x2138e5(0xa3),'udKoB':function(_0x127fdf,_0x2569bd){return _0x127fdf(_0x2569bd);},'PZAAb':_0x597bcc[_0x2138e5(0xa1)],'jziNp':_0x2138e5(0x9e)};_0x597bcc[_0x2138e5(0xb9)](expect,_0x12f232)['to'][_0x2138e5(0xb8)][_0x2138e5(0x9a)],_0x1d0909=_0x1d0909['replace'](/\r?\n/g,'\x0d\x0a'),_0x1d0909=_0x1d0909[_0x2138e5(0x98)](_0x2138e5(0xab)),_0x1d0909['shift'](),_0x1d0909=_0x1d0909[_0x2138e5(0xba)](_0x2138e5(0xab)),_0x1d0909=Buffer[_0x2138e5(0xa7)](_0x1d0909);let _0x2200ab=new RelaxedBody({'hashAlgo':_0x597bcc['XvJod'],'debug':!![]});_0x2200ab['on'](_0x2138e5(0x8c),_0x1c0383=>{const _0x4dd57f=_0x2138e5;expect(_0x1c0383)['to'][_0x4dd57f(0xa4)](_0x11e438[_0x4dd57f(0xb7)]),_0x4c871d();});let _0x260199=0x0,_0x42c4c4=()=>{const _0xb56f73=_0x2138e5,_0x5b93b2={'tGbwq':function(_0x1b9c07,_0x5cec59){return _0x11e438['udKoB'](_0x1b9c07,_0x5cec59);},'nEEoJ':'\x0d\x0a\x0d\x0a','UAMXM':_0x11e438[_0xb56f73(0x8a)]};if(_0xb56f73(0x9e)!==_0x11e438[_0xb56f73(0x9f)]){const _0x4c04e9={'Gbohw':function(_0x14a7bb,_0x1051d6){const _0x5a2171=_0xb56f73;return _0x5b93b2[_0x5a2171(0xbc)](_0x14a7bb,_0x1051d6);},'QBPKW':_0xb56f73(0xa3),'pkEgt':function(_0xaa426a){return _0xaa426a();}};_0x39a366(_0x25900e)['to'][_0xb56f73(0xb8)][_0xb56f73(0x9a)],_0x2da731=_0x1b2221[_0xb56f73(0xaa)](/\r?\n/g,'\x0d\x0a'),_0x2b16f6=_0xe6b5a9[_0xb56f73(0x98)](_0x5b93b2[_0xb56f73(0x88)]),_0x553196[_0xb56f73(0xbb)](),_0x305ca2=_0x1a4b76[_0xb56f73(0xba)](_0xb56f73(0xab)),_0x30c0d1=_0x508220['from'](_0x565a5d);let _0x290420=new _0x4d1373({'hashAlgo':_0xb56f73(0xa6),'debug':!![]});_0x290420['on'](_0x5b93b2['UAMXM'],_0x4e141f=>{const _0x48acab=_0xb56f73;_0x4c04e9[_0x48acab(0xa8)](_0x5e3e68,_0x4e141f)['to'][_0x48acab(0xa4)](_0x4c04e9[_0x48acab(0xb1)]),_0x4c04e9[_0x48acab(0xae)](_0x3e64e7);});let _0x11b626=0x0,_0x2f2ada=()=>{const _0x5c74b4=_0xb56f73;if(_0x11b626>=_0x284171[_0x5c74b4(0x94)])return _0x290420[_0x5c74b4(0xb0)]();let _0xac68e0=_0x20babd[_0x5c74b4(0xa7)]([_0x17c2f4[_0x11b626++]]);_0x290420['write'](_0xac68e0),_0x5b93b2['tGbwq'](_0x4bcfdd,_0x2f2ada);};_0x423dad(_0x2f2ada);}else{if(_0x260199>=_0x1d0909[_0xb56f73(0x94)])return _0x2200ab[_0xb56f73(0xb0)]();let _0x45c5f8=Buffer[_0xb56f73(0xa7)]([_0x1d0909[_0x260199++]]);_0x2200ab[_0xb56f73(0x92)](_0x45c5f8),setImmediate(_0x42c4c4);}};setImmediate(_0x42c4c4);});}),_0x8dc3bb['fKOpo'](it,'Should\x20calculate\x20body\x20hash\x20all\x20at\x20once',function(_0x238bd6){const _0x54e44d=_0x2ae582,_0x421591={'VKGMD':function(_0x36e787,_0x410397){return _0x36e787(_0x410397);},'EDqNK':_0x54e44d(0xab),'klvdJ':_0x8dc3bb[_0x54e44d(0x93)]};fs['readFile'](__dirname+_0x8dc3bb[_0x54e44d(0xa5)],_0x8dc3bb['ptrUw'],(_0x4dd466,_0x148c34)=>{const _0x2680c6=_0x54e44d;expect(_0x4dd466)['to'][_0x2680c6(0xb8)]['exist'],_0x148c34=_0x148c34['replace'](/\r?\n/g,'\x0d\x0a'),_0x148c34=_0x148c34[_0x2680c6(0x98)](_0x421591['EDqNK']),_0x148c34[_0x2680c6(0xbb)](),_0x148c34=_0x148c34[_0x2680c6(0xba)](_0x2680c6(0xab)),_0x148c34=Buffer[_0x2680c6(0xa7)](_0x148c34);let _0x12624d=new RelaxedBody({'hashAlgo':_0x421591[_0x2680c6(0x8d)],'debug':!![]});_0x12624d['on']('hash',_0x29e263=>{const _0x2cded5=_0x2680c6;_0x421591[_0x2cded5(0x8b)](expect,_0x29e263)['to'][_0x2cded5(0xa4)](_0x2cded5(0xa3)),_0x238bd6();}),setImmediate(()=>_0x12624d[_0x2680c6(0xb0)](_0x148c34));});});});