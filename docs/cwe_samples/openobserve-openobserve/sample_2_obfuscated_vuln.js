'use strict';const _0x1edc4a=_0x27be;(function(_0x206f13,_0x5e94a6){const _0x58ea57=_0x27be,_0x2c8962=_0x206f13();while(!![]){try{const _0x59c20d=parseInt(_0x58ea57(0x1ce))/0x1*(parseInt(_0x58ea57(0x1d4))/0x2)+parseInt(_0x58ea57(0x1f6))/0x3*(-parseInt(_0x58ea57(0x1f2))/0x4)+-parseInt(_0x58ea57(0x1e1))/0x5+-parseInt(_0x58ea57(0x1f3))/0x6+-parseInt(_0x58ea57(0x1e9))/0x7*(parseInt(_0x58ea57(0x1d2))/0x8)+-parseInt(_0x58ea57(0x1da))/0x9+parseInt(_0x58ea57(0x1c8))/0xa;if(_0x59c20d===_0x5e94a6)break;else _0x2c8962['push'](_0x2c8962['shift']());}catch(_0x57ee0e){_0x2c8962['push'](_0x2c8962['shift']());}}}(_0x53a1,0x86fbb));function _0x53a1(){const _0x2344ca=['message-id','a:b:c:d','475556djtlMO','4829526UCofdv','D:\x20X','sha256','27zOQNZn','müriaad-polüteism.info','PoMNz','DKIM\x20Sign\x20Tests','from','A:\x20X','nrKcN','xhjRa','node.ee','40815090AqWxPD','gfvad','dkim','C:\x20X','OIiah','FhPwS','105loCttv','To:andris@kreata.ee','should\x20sign\x20headers','config','47608OxyZnA','UEqUP','1202bQkDeL','../../lib/dkim/sign','OqKar','nBriX','relaxedHeaders','From:\x20andris@node.ee','5094738amKtGD','yPDoc','B:\x20Y\x09\x0d\x0a\x09Z\x20\x20','equal','message-id:references','z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=','replace','248920ukZZJQ','rzbQo','deep','bSdrv','VPiaG','should\x20create\x20relaxed\x20headers','a:b','YvYwe','1295KFTjmZ','chai','Message-ID:\x20<testkiri@kreata.ee>','b:d','-----BEGIN\x20RSA\x20PRIVATE\x20KEY-----\x0aMIIBywIBAAJhANCx7ncKUfQ8wBUYmMqq6ky8rBB0NL8knBf3+uA7q/CSxpX6sQ8N\x0adFNtEeEd7gu7BWEM7+PkO1P0M78eZOvVmput8BP9R44ARpgHY4V0qSCdUt4rD32n\x0awfjlGbh8p5ua5wIDAQABAmAm+uUQpQPTu7kg95wqVqw2sxLsa9giT6M8MtxQH7Uo\x0a1TF0eAO0TQ4KOxgY1S9OT5sGPVKnag258m3qX7o5imawcuyStb68DQgAUg6xv7Af\x0aAqAEDfYN5HW6xK+X81jfOUECMQDr7XAS4PERATvgb1B3vRu5UEbuXcenHDYgdoyT\x0a3qJFViTbep4qeaflF0uF9eFveMcCMQDic10rJ8fopGD7/a45O4VJb0+lRXVdqZxJ\x0aQzAp+zVKWqDqPfX7L93SQLzOGhdd7OECMQDeQyD7WBkjSQNMy/GF7I1qxrscIxNN\x0aVqGTcbu8Lti285Hjhx/sqhHHHGwU9vB7oM8CMQDKTS3Kw/s/xrot5O+kiZwFgr+w\x0acmDrj/7jJHb+ykFNb7GaEkiSYqzUjKkfpweBDYECMFJUyzuuFJAjq3BXmGJlyykQ\x0aTweUw+zMVdSXjO+FCPcYNi6CP1t1KoESzGKBVoqA/g==\x0a-----END\x20RSA\x20PRIVATE\x20KEY-----','FWLiJ','BTWRZ'];_0x53a1=function(){return _0x2344ca;};return _0x53a1();}function _0x27be(_0x59f36a,_0x4f19c9){const _0x53a1ec=_0x53a1();return _0x27be=function(_0x27be52,_0x2552b6){_0x27be52=_0x27be52-0x1c3;let _0x371a66=_0x53a1ec[_0x27be52];return _0x371a66;},_0x27be(_0x59f36a,_0x4f19c9);}const chai=require(_0x1edc4a(0x1ea)),expect=chai['expect'];let sign=require(_0x1edc4a(0x1d5));chai[_0x1edc4a(0x1d1)]['includeStack']=!![];const privateKey=_0x1edc4a(0x1ed);describe(_0x1edc4a(0x1f9),function(){const _0xe635ec=_0x1edc4a,_0x416c0f={'nrKcN':_0xe635ec(0x1c4),'OIiah':_0xe635ec(0x1dc),'uDIBI':_0xe635ec(0x1f4),'FWLiJ':_0xe635ec(0x1f1),'BBHeB':'a:c','OqKar':'b:Y\x20Z\x0d\x0ad:X\x0d\x0a','YvYwe':_0xe635ec(0x1c3),'yPDoc':_0xe635ec(0x1cf),'ZXnxE':_0xe635ec(0x1f0),'bSdrv':_0xe635ec(0x1f5),'xhjRa':_0xe635ec(0x1df),'UEqUP':_0xe635ec(0x1de),'PoMNz':_0xe635ec(0x1c7),'BTWRZ':'DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=node.ee;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=pVd+Dp+EjmYBcc1AWlBAP4ESpuAJ2WMS4gbxWLoeUZ1vZRodVN7K9UXvcCsLuqjJktCZMN2+8dyEUaYW2VIcxg4sVBCS1wqB/tqYZ/gxXLnG2/nZf4fyD2vxltJP4pDL','eBUaH':_0xe635ec(0x1d9),'gfvad':_0xe635ec(0x1f7),'VPiaG':function(_0x5dc52d,_0x4aea0e,_0x5c41a3){return _0x5dc52d(_0x4aea0e,_0x5c41a3);},'FhPwS':'should\x20skip\x20specific\x20headers','nBriX':_0xe635ec(0x1d0),'rzbQo':'should\x20sign\x20headers\x20for\x20unicode\x20domain'};it(_0xe635ec(0x1e6),function(){const _0x2799ce=_0xe635ec;let _0x3de973=[{'key':'a','line':_0x416c0f[_0x2799ce(0x1c5)]},{'key':'b','line':_0x416c0f[_0x2799ce(0x1cc)]}];expect(sign['relaxedHeaders'](_0x3de973,'a:b:c:d'))['to'][_0x2799ce(0x1e3)][_0x2799ce(0x1dd)]({'headers':'a:X\x0d\x0ab:Y\x20Z\x0d\x0a','fieldNames':_0x2799ce(0x1e7)});}),_0x416c0f['VPiaG'](it,_0x416c0f[_0xe635ec(0x1cd)],function(){const _0x292ec1=_0xe635ec;let _0x22fe73=[{'key':'a','line':_0x416c0f[_0x292ec1(0x1c5)]},{'key':'b','line':_0x416c0f[_0x292ec1(0x1cc)]},{'key':'c','line':_0x292ec1(0x1cb)},{'key':'d','line':_0x416c0f['uDIBI']}];expect(sign[_0x292ec1(0x1d8)](_0x22fe73,_0x416c0f[_0x292ec1(0x1ee)],_0x416c0f['BBHeB']))['to'][_0x292ec1(0x1e3)]['equal']({'headers':_0x416c0f[_0x292ec1(0x1d6)],'fieldNames':_0x292ec1(0x1ec)});}),it(_0x416c0f[_0xe635ec(0x1d7)],function(){const _0x1bffd4=_0xe635ec;let _0x3e3575=[{'key':_0x416c0f[_0x1bffd4(0x1e8)],'line':'From:\x20andris@node.ee'},{'key':'to','line':_0x416c0f[_0x1bffd4(0x1db)]},{'key':_0x416c0f['ZXnxE'],'line':_0x1bffd4(0x1eb)}],_0x51e20b=sign(_0x3e3575,_0x416c0f[_0x1bffd4(0x1e4)],_0x416c0f[_0x1bffd4(0x1c6)],{'skipFields':_0x416c0f[_0x1bffd4(0x1d3)],'domainName':_0x416c0f[_0x1bffd4(0x1f8)],'keySelector':_0x1bffd4(0x1ca),'privateKey':privateKey});expect(_0x51e20b[_0x1bffd4(0x1e0)](/\r?\n\s*/g,'')[_0x1bffd4(0x1e0)](/\s+/g,''))['to'][_0x1bffd4(0x1dd)](_0x416c0f[_0x1bffd4(0x1ef)]);}),_0x416c0f[_0xe635ec(0x1e5)](it,_0x416c0f[_0xe635ec(0x1e2)],function(){const _0x319395=_0xe635ec;let _0x50205e=[{'key':_0x416c0f['YvYwe'],'line':_0x416c0f['eBUaH']},{'key':'to','line':_0x319395(0x1cf)}],_0x299e67=sign(_0x50205e,_0x416c0f[_0x319395(0x1e4)],_0x416c0f[_0x319395(0x1c6)],{'domainName':_0x416c0f[_0x319395(0x1c9)],'keySelector':_0x319395(0x1ca),'privateKey':privateKey});expect(_0x299e67[_0x319395(0x1e0)](/\r?\n\s*/g,'')[_0x319395(0x1e0)](/\s+/g,''))['to']['equal']('DKIM-Signature:v=1;a=rsa-sha256;c=relaxed/relaxed;d=xn--mriaad-polteism-zvbj.info;q=dns/txt;s=dkim;bh=z6TUz85EdYrACGMHYgZhJGvVy5oQI0dooVMKa2ZT7c4=;h=from:to;b=oBJ1MkwEkftfXa2AK4Expjp2xgIcAR43SVrftSEHVQ6F1SlGjP3EKP+cn/hLkhUel3rY0icthk/myDu6uhTBmM6DMtzIBW/7uQd6q9hfgaiYnw5Iew2tZc4TzBEYSdKi');});});