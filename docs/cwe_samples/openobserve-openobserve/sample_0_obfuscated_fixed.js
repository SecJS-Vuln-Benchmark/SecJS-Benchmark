'use strict';const _0x36d462=_0x597f;(function(_0x358bc5,_0x6f80b6){const _0x5953d3=_0x597f,_0x1ebae3=_0x358bc5();while(!![]){try{const _0x38916a=parseInt(_0x5953d3(0x136))/0x1*(parseInt(_0x5953d3(0x127))/0x2)+-parseInt(_0x5953d3(0xb9))/0x3*(-parseInt(_0x5953d3(0x114))/0x4)+-parseInt(_0x5953d3(0xcc))/0x5*(-parseInt(_0x5953d3(0xdc))/0x6)+-parseInt(_0x5953d3(0x10e))/0x7*(-parseInt(_0x5953d3(0xdf))/0x8)+parseInt(_0x5953d3(0x178))/0x9+-parseInt(_0x5953d3(0xc2))/0xa+-parseInt(_0x5953d3(0x15e))/0xb;if(_0x38916a===_0x6f80b6)break;else _0x1ebae3['push'](_0x1ebae3['shift']());}catch(_0x18689d){_0x1ebae3['push'](_0x1ebae3['shift']());}}}(_0x4c87,0x1fcb6));function _0x4c87(){const _0x4f40d2=['dIueH','SrrFn','includeStack','port','aqQgT','hlPEx','aguwi','KIPfE','ZXftT','send','FSWQA','end','WTJhy','MITSd','TuxOx','EFvPv','UwtDU','GJxVJ','secure','password','BnvJK','smtp:testuser:testpass@localhost:','AUTH','HeoUy','kjiQy','1185MQaczf','HUjxR','dzGYT','mid','lpfJL','awUoS','connections','FMSjs','SgmKO','2148630gUcVMa','close','iippA','messageId','verify','teretere,\x20vana\x20kere\x0a','KTObX','destroy','equal','STXVf','192565gHMKjx','KKLQW','SbUDT','join','PassThrough','fUrxg','concat','replace','owlfR','timeout','wUeqP','accessToken','nihri','PqClL','HaAYo','_socket','30AZSaJa','UbTVo','TDWNP','46792UqqUQF','test','XOAUTH2','Oaxax','Only\x20user@valid.sender\x20is\x20allowed\x20to\x20send\x20mail','message','MHAaY','401','BLfdX','ipWTS','exist','kIMrc','cOmvn','forEach','trim','env','wudgO','SMTPServer','gVEFj','my_smtp_access_scope_name','testtoken','?logger=false','TKzaM','xSQtA','HBOea','Invalid\x20username\x20or\x20password','XTsZU','dVWfv','rawMessage','DttVr','data','getHeader','TxMRS','push','ThKlq','connect','address','smtp-server','IVMjj','true','YcTNA','test@invalid.sender','OayuO','uMEMq','PLAIN','CuyAn','expect','217uChBHy','vOzIl','ipviP','removeListener','rNxIM','QdwqS','1112rlPvaA','vzfbK','SEvPo','mKdnO','UeLlj','RfBAM','ccCQw','JsqFM','VOuQp','UJZSU','version','NBfev','test@valid.recipient','vUaHB','toString','smtp:localhost:','xqioi','uyeol','XElJj','12532AvaLWm','dxugr','Anonymous\x20sender\x20tests','CKVln','CNKYd','stream','../../lib/smtp-transport','envelope','PRYvh','jZdTT','qqXVz','HonMQ','smtp:testuser:testpass@localhost:999','oWfJj','localhost','10tlZVgZ','Gaowa','test@valid.sender','host','NCXaA','dataReady','hHEaV','error','nvjoY','config','pCcRy','unBYv','Rgnuo','zzz','RzFkF','LTaVG','Should\x20detect\x20wellknown\x20data','QyKWI','wtPef','ZyyJD','URozz','cheqH','NODE_TLS_REJECT_UNAUTHORIZED','zhYDO','AOePu','qssZb','iQTFA','testuser','eHUnl','crmTN','not','ttOGz','yOJTl','Should\x20fail\x20envelope','uBtxs','UVhvK','Elkhs','YDREd','EENVELOPE','rBgqj','2431429IVykpM','Authenticated\x20sender\x20tests','listen','DruNo','nboxO','oZbue','code','FtLeM','Should\x20not\x20verify\x20connection','zZCjU','nJmyJ','ySPAW','method','Should\x20login\x20and\x20send\x20mail','DfgRX','bearer\x20mac','ZJDOG','nXWcj','EAUTH','Rwdfn','ycoyt','iukRw','EglbN','RCNad','testpass','Only\x20user@valid.recipient\x20is\x20allowed\x20to\x20receive\x20mail','178002zJugFt','STARTTLS','options','HSrdp','username','QybUB','aAldj','Should\x20not\x20fail\x20auth'];_0x4c87=function(){return _0x4f40d2;};return _0x4c87();}process[_0x36d462(0xee)][_0x36d462(0x14c)]='0';const chai=require('chai'),net=require('net'),expect=chai[_0x36d462(0x10d)],PassThrough=require(_0x36d462(0x12c))[_0x36d462(0xd0)],SMTPTransport=require(_0x36d462(0x12d)),SMTPServer=require(_0x36d462(0x104))[_0x36d462(0xf0)];chai[_0x36d462(0x13f)][_0x36d462(0x182)]=!![];function _0x597f(_0xd55ace,_0x11c443){const _0x4c87ee=_0x4c87();return _0x597f=function(_0x597fb7,_0x2fdba1){_0x597fb7=_0x597fb7-0xaa;let _0x4a62f2=_0x4c87ee[_0x597fb7];return _0x4a62f2;},_0x597f(_0xd55ace,_0x11c443);}const PORT_NUMBER=0x20cd;class MockBuilder{constructor(_0x1f6013,_0x1c5519,_0x44c32a){const _0x61ff2c=_0x36d462,_0x3caaa2={'RmsPB':function(_0x30f1f9,_0x41e291){return _0x30f1f9||_0x41e291;},'EglbN':'<test>'};this[_0x61ff2c(0x12e)]=_0x1f6013,this['rawMessage']=_0x1c5519,this[_0x61ff2c(0xbc)]=_0x3caaa2['RmsPB'](_0x44c32a,_0x3caaa2[_0x61ff2c(0x174)]);}['getEnvelope'](){return this['envelope'];}[_0x36d462(0xc5)](){return this['mid'];}['createReadStream'](){const _0x45735e=_0x36d462,_0x124392={'DfgRX':function(_0x380df3,_0xa37826){return _0x380df3(_0xa37826);}};let _0x3da3f4=new PassThrough();return _0x124392[_0x45735e(0x16c)](setImmediate,()=>_0x3da3f4[_0x45735e(0xab)](this[_0x45735e(0xfb)])),_0x3da3f4;}[_0x36d462(0xfe)](){const _0xcc679=_0x36d462,_0x3d4ea1={'HUjxR':'teretere'};return _0x3d4ea1[_0xcc679(0xba)];}}describe('SMTP\x20Transport\x20Tests',function(){const _0xf2e95e=_0x36d462,_0x14d10b={'QoNXe':function(_0x20d959,_0x50a695){return _0x20d959===_0x50a695;},'nAmqC':'cowJt','bCCUp':_0xf2e95e(0x155),'AOePu':_0xf2e95e(0x120),'DttVr':function(_0x40e591){return _0x40e591();},'Elkhs':_0xf2e95e(0xe4),'NCXaA':_0xf2e95e(0xc8),'ccCQw':function(_0xaf4011,_0x409897){return _0xaf4011(_0x409897);},'UVhvK':_0xf2e95e(0x123),'unBYv':'teretere,\x20vana\x20kere\x0a','ipWTS':_0xf2e95e(0x13b),'KIPfE':_0xf2e95e(0x138),'hHEaV':_0xf2e95e(0x177),'yOJTl':'JJpPv','iukRw':'izBXm','TuxOx':_0xf2e95e(0x15c),'otNEK':_0xf2e95e(0x11f),'TnClN':'smtp.gmail.com','lpfJL':function(_0x2973cc,_0xd51452){return _0x2973cc(_0xd51452);},'zhYDO':function(_0x4c929b,_0x4ea2c0){return _0x4c929b+_0x4ea2c0;},'MGEJs':_0xf2e95e(0xf4),'cMEuM':function(_0x55c1a7,_0x167486){return _0x55c1a7(_0x167486);},'STXVf':function(_0x39ca7a,_0x1681ff){return _0x39ca7a(_0x1681ff);},'YDREd':function(_0x10bef5,_0x55e7c8,_0x3d20db){return _0x10bef5(_0x55e7c8,_0x3d20db);},'WTJhy':'Should\x20expose\x20version\x20number','zLWoa':_0xf2e95e(0x146),'ZXftT':'Should\x20send\x20mail','HonMQ':function(_0x3abd5e,_0x40a01b,_0xb8c206){return _0x3abd5e(_0x40a01b,_0xb8c206);},'TxMRS':function(_0x167af7,_0x28f52a){return _0x167af7(_0x28f52a);},'fBpsP':_0xf2e95e(0x176),'KusqK':_0xf2e95e(0xf3),'ttdvR':_0xf2e95e(0xe6),'FSWQA':function(_0x43794f,_0x532c77,_0x3a416b){return _0x43794f(_0x532c77,_0x3a416b);},'CKVln':'smtp:testuser:testpass@localhost:999','uMEMq':function(_0x56e957,_0x42db7f){return _0x56e957+_0x42db7f;},'DruNo':function(_0x8446f7,_0xb3f271){return _0x8446f7!==_0xb3f271;},'ZyyJD':function(_0x3013cc,_0x3da905){return _0x3013cc!==_0x3da905;},'QyWQT':_0xf2e95e(0x151),'MITSd':_0xf2e95e(0x16d),'RPUen':'my_smtp_access_scope_name','HQgDE':function(_0x4601d1){return _0x4601d1();},'FtLeM':function(_0x3a1607,_0x516901){return _0x3a1607(_0x516901);},'KYZMl':function(_0x3848af){return _0x3848af();},'cOmvn':'Should\x20login\x20and\x20send\x20mail\x20using\x20proxied\x20socket','KKLQW':_0xf2e95e(0x129),'BLfdX':function(_0x4deb6e,_0x1036ef,_0x50e1cc){return _0x4deb6e(_0x1036ef,_0x50e1cc);},'eBzvv':_0xf2e95e(0x15f)};this[_0xf2e95e(0xd5)](0x2710),describe(_0x14d10b[_0xf2e95e(0xcd)],function(){const _0x5a47a4=_0xf2e95e,_0xb95781={'dzGYT':_0x14d10b[_0x5a47a4(0x13c)],'LGKHM':_0x14d10b[_0x5a47a4(0x156)],'HaAYo':function(_0x3c3586){return _0x14d10b['DttVr'](_0x3c3586);},'LTaVG':function(_0x54487f,_0x15b7de){return _0x54487f(_0x15b7de);},'QyKWI':function(_0x35a7f6,_0x386959,_0x2b9700){return _0x35a7f6(_0x386959,_0x2b9700);},'IVMjj':function(_0x3e85a4,_0x333db0){return _0x14d10b['ccCQw'](_0x3e85a4,_0x333db0);},'uBtxs':_0x14d10b[_0x5a47a4(0x173)],'rNxIM':_0x5a47a4(0x179),'LwToS':_0x14d10b[_0x5a47a4(0xae)],'nboxO':_0x5a47a4(0x108),'BnvJK':_0x14d10b[_0x5a47a4(0x14e)],'wtPef':_0x5a47a4(0xe0),'SEvPo':function(_0x1ac2a8){return _0x1ac2a8();},'ulzLx':function(_0x292554,_0x59e703){return _0x292554===_0x59e703;},'CNKYd':_0x14d10b['otNEK'],'RCNad':function(_0x2e5401,_0x425e2b){return _0x2e5401(_0x425e2b);},'vUaHB':'google\x20mail','JsqFM':_0x14d10b['TnClN'],'jTRfO':function(_0x4d19cb,_0x1e1263){return _0x4d19cb(_0x1e1263);},'MHFgY':_0x14d10b[_0x5a47a4(0x15a)],'dIueH':function(_0xaffdb7,_0x3d3112){const _0x20be99=_0x5a47a4;return _0x14d10b[_0x20be99(0xbd)](_0xaffdb7,_0x3d3112);},'HSrdp':_0x5a47a4(0x118),'wUeqP':function(_0x13195d,_0x17f831){const _0x4ab898=_0x5a47a4;return _0x14d10b[_0x4ab898(0x14d)](_0x13195d,_0x17f831);},'dxugr':_0x14d10b['MGEJs'],'qssZb':_0x5a47a4(0xc7),'zZCjU':_0x5a47a4(0x138)};let _0x4a8163,_0x54783c;_0x14d10b['cMEuM'](beforeEach,function(_0x3bd049){const _0x264901=_0x5a47a4,_0xdf8cf3={'SbUDT':function(_0x3c228e,_0x144148){return _0x3c228e(_0x144148);},'ipviP':function(_0x4edbbc,_0x219062,_0x7c9de2){const _0x23688b=_0x597f;return _0xb95781[_0x23688b(0x147)](_0x4edbbc,_0x219062,_0x7c9de2);},'TXLTf':function(_0x5ccfb9,_0x32d77c){const _0x131579=_0x597f;return _0xb95781[_0x131579(0x105)](_0x5ccfb9,_0x32d77c);},'xSQtA':function(_0x1a0ede){return _0x1a0ede();},'awUoS':_0xb95781[_0x264901(0x158)],'QdwqS':function(_0x37b6d2,_0x3239af){return _0x37b6d2===_0x3239af;},'CuyAn':_0x264901(0x11c),'trWmT':_0xb95781[_0x264901(0xbb)],'nXWcj':function(_0x2b9f9d){return _0x2b9f9d();}};_0x4a8163=new SMTPServer({'disabledCommands':[_0xb95781[_0x264901(0x112)],_0x264901(0xb6)],'onData'(_0x239689,_0x4c03ff,_0x2a7d96){const _0x20362e=_0x264901;_0x239689['on'](_0x20362e(0xfd),function(){}),_0x239689['on']('end',_0x2a7d96);},'onMailFrom'(_0x181ed4,_0x1b177a,_0x34137c){const _0x184843=_0x264901;if(!/@valid.sender/[_0x184843(0xe0)](_0x181ed4[_0x184843(0x103)])){if('MHAaY'===_0x184843(0xe5))return _0xdf8cf3[_0x184843(0xce)](_0x34137c,new Error(_0x184843(0xe3)));else _0x3d1ae8(_0x65983f)['to'][_0x184843(0xe9)],_0x424b5e();}return _0x34137c();},'onRcptTo'(_0x4ae1a6,_0x3a34d8,_0x2fdd7d){const _0x4470d8=_0x264901;if(!/@valid.recipient/[_0x4470d8(0xe0)](_0x4ae1a6[_0x4470d8(0x103)]))return _0x2fdd7d(new Error(_0xb95781['dzGYT']));return _0x2fdd7d();},'logger':![]}),_0x54783c=new SMTPServer({'disabledCommands':['STARTTLS',_0x264901(0xb6)],'onData'(_0xa3b9a){const _0x37e74f=_0x264901,_0x54c419={'DWCKk':_0xb95781['LGKHM']};_0xa3b9a['on'](_0x37e74f(0xfd),()=>![]),_0xa3b9a['on'](_0x37e74f(0xab),()=>{const _0x2261ef={'kjiQy':_0x54c419['DWCKk']};setTimeout(()=>{const _0x42c756=_0x597f;_0x2261ef[_0x42c756(0xb8)]!==_0x2261ef[_0x42c756(0xb8)]?this[_0x42c756(0xbf)][_0x42c756(0xec)](_0x126a46=>_0x126a46[_0x42c756(0xdb)]['destroy']()):this[_0x42c756(0xbf)][_0x42c756(0xec)](_0x559d0a=>_0x559d0a['_socket'][_0x42c756(0xc9)]());},0x96);});},'onMailFrom'(_0x186235,_0x32c024,_0x6e0fef){const _0x3aa1b7=_0x264901;if(!/@valid.sender/[_0x3aa1b7(0xe0)](_0x186235[_0x3aa1b7(0x103)])){if(_0x3aa1b7(0x126)!==_0x3aa1b7(0x126)){let _0x55dbd6=_0x51859e[_0x3aa1b7(0xd2)](_0x37d8b9);_0x2940a3(_0x55dbd6['toString']())['to'][_0x3aa1b7(0xca)](_0x50e881[_0x3aa1b7(0xed)]()[_0x3aa1b7(0xd3)](/\n/g,'\x0d\x0a')),_0xdf8cf3[_0x3aa1b7(0x110)](_0x22fb4f,null,!![]);}else return _0x6e0fef(new Error('Only\x20user@valid.sender\x20is\x20allowed\x20to\x20send\x20mail'));}return _0xb95781[_0x3aa1b7(0xda)](_0x6e0fef);},'onRcptTo'(_0x15cc60,_0x2fa595,_0xf6ef6b){const _0x13e6dd=_0x264901;if(_0x13e6dd(0x168)===_0xdf8cf3[_0x13e6dd(0xbe)]){if(!/@valid.recipient/['test'](_0xc61ae['address']))return _0xdf8cf3['TXLTf'](_0x38898f,new _0x4c4d69(_0x13e6dd(0x177)));return _0xdf8cf3[_0x13e6dd(0xf6)](_0x48a0aa);}else{if(!/@valid.recipient/[_0x13e6dd(0xe0)](_0x15cc60[_0x13e6dd(0x103)]))return _0xdf8cf3[_0x13e6dd(0x113)](_0xdf8cf3[_0x13e6dd(0x10c)],_0x13e6dd(0x11c))?_0xf6ef6b(new Error(_0xdf8cf3['trWmT'])):this[_0x13e6dd(0xbc)];return _0xdf8cf3[_0x13e6dd(0x16f)](_0xf6ef6b);}},'logger':![]}),_0x4a8163[_0x264901(0x160)](PORT_NUMBER,_0x4716e0=>{const _0x29425c=_0x264901;if(_0x4716e0)return _0xb95781[_0x29425c(0x145)](_0x3bd049,_0x4716e0);_0x54783c[_0x29425c(0x160)](PORT_NUMBER+0x1,_0x3bd049);});}),_0x14d10b[_0x5a47a4(0xcb)](afterEach,function(_0x5352fb){const _0x12c566=_0x5a47a4;if(_0x14d10b['QoNXe'](_0x14d10b['nAmqC'],_0x14d10b['bCCUp'])){const _0x1e50d8={'gVEFj':function(_0x6af7b4,_0x51c13f){const _0xf45449=_0x597f;return _0xb95781[_0xf45449(0x105)](_0x6af7b4,_0x51c13f);},'PRYvh':_0xb95781['LwToS'],'mKdnO':function(_0x5b4302){return _0xb95781['HaAYo'](_0x5b4302);}};let _0x18b403=new _0x4bc4af({'port':_0x36cce4,'logger':![]});_0x18b403['send']({'data':{},'message':new _0xb7b38b({'from':_0xb95781[_0x12c566(0x162)],'to':_0xb95781[_0x12c566(0xb4)]},_0xb95781[_0x12c566(0x148)])},function(_0x37c387){const _0x1de53e=_0x12c566;_0x1e50d8[_0x1de53e(0xf1)](_0xa0ec9,_0x37c387[_0x1de53e(0x164)])['to']['equal'](_0x1e50d8[_0x1de53e(0x12f)]),_0x1e50d8[_0x1de53e(0x117)](_0x469cf8);});}else _0x4a8163['close'](()=>_0x54783c[_0x12c566(0xc3)](_0x5352fb));}),_0x14d10b['YDREd'](it,_0x14d10b[_0x5a47a4(0xac)],function(){const _0x51f07f=_0x5a47a4,_0x3131b2={'jZdTT':function(_0x43b5e6){const _0x2f917d=_0x597f;return _0xb95781[_0x2f917d(0x116)](_0x43b5e6);}};if(_0xb95781['ulzLx'](_0xb95781[_0x51f07f(0x12b)],_0x51f07f(0x11f))){let _0xab2129=new SMTPTransport();_0xb95781[_0x51f07f(0x175)](expect,_0xab2129['name'])['to'][_0x51f07f(0xe9)],expect(_0xab2129[_0x51f07f(0x11e)])['to']['exist'];}else{const _0x2f6b23={'QybUB':function(_0x342922,_0x5327ba){return _0x342922(_0x5327ba);},'URozz':function(_0x41468f){const _0x1106cf=_0x51f07f;return _0x3131b2[_0x1106cf(0x130)](_0x41468f);}};let _0x17eed9=new _0x4801c8({'url':_0x51f07f(0x133)+_0x530d32,'logger':![]});_0x17eed9[_0x51f07f(0xc6)](function(_0x487909){const _0x257427=_0x51f07f;_0x2f6b23[_0x257427(0x17d)](_0x58a6b2,_0x487909)['to'][_0x257427(0xe9)],_0x2f6b23[_0x257427(0x14a)](_0x513c73);});}}),_0x14d10b[_0x5a47a4(0x15b)](it,_0x14d10b['zLWoa'],function(){const _0x230152=_0x5a47a4;let _0x4d06fb=new SMTPTransport({'service':_0xb95781[_0x230152(0x121)],'logger':![]});expect(_0x4d06fb[_0x230152(0x17a)][_0x230152(0x139)])['to']['equal'](_0xb95781[_0x230152(0x11b)]),expect(_0x4d06fb['options'][_0x230152(0x183)])['to'][_0x230152(0xca)](0x1d1),_0xb95781['jTRfO'](expect,_0x4d06fb[_0x230152(0x17a)][_0x230152(0xb2)])['to']['be'][_0x230152(0x106)];}),it(_0x5a47a4(0x157),function(_0x3ee8d5){const _0x2cf082=_0x5a47a4;let _0xd49365=new SMTPTransport({'port':PORT_NUMBER,'logger':![]});_0xd49365[_0x2cf082(0x189)]({'data':{},'message':new MockBuilder({'from':_0x2cf082(0x108),'to':_0x14d10b['AOePu']},_0x2cf082(0xe0))},function(_0x3cf837){const _0x14e06a=_0x2cf082;expect(_0x3cf837[_0x14e06a(0x164)])['to'][_0x14e06a(0xca)](_0x14e06a(0x15c)),_0xb95781[_0x14e06a(0xda)](_0x3ee8d5);});}),_0x14d10b[_0x5a47a4(0x15b)](it,_0x5a47a4(0x17f),function(_0x20038a){const _0x64b5f1=_0x5a47a4;let _0x59a6f1=new SMTPTransport({'port':PORT_NUMBER,'auth':{'user':_0x64b5f1(0x143)},'logger':![]});_0x59a6f1[_0x64b5f1(0x189)]({'data':{},'message':new MockBuilder({'from':_0x64b5f1(0x138),'to':_0xb95781['BnvJK']},_0xb95781['MHFgY'])},function(_0x320a0c){const _0x488a11=_0x64b5f1;expect(_0x320a0c)['to'][_0x488a11(0x154)][_0x488a11(0xe9)],_0x20038a();});}),it('Should\x20fail\x20auth\x20if\x20forceAuth=true',function(_0x3bb6b5){const _0x4c40e7=_0x5a47a4,_0x587497={'xqioi':function(_0x1955c8){const _0x2b7343=_0x597f;return _0x14d10b[_0x2b7343(0xfc)](_0x1955c8);}};let _0x1e3f83=new SMTPTransport({'port':PORT_NUMBER,'auth':{'user':_0x4c40e7(0x143)},'forceAuth':!![],'logger':![]});_0x1e3f83[_0x4c40e7(0x189)]({'data':{},'message':new MockBuilder({'from':'test@valid.sender','to':_0x14d10b[_0x4c40e7(0x14e)]},_0x14d10b[_0x4c40e7(0x15a)])},function(_0x39470d){const _0x1c8502=_0x4c40e7;expect(_0x39470d['code'])['to']['equal'](_0x1c8502(0x170)),_0x587497[_0x1c8502(0x124)](_0x3bb6b5);});}),it(_0x14d10b[_0x5a47a4(0x188)],function(_0x286e4b){const _0x1c3294=_0x5a47a4,_0x4b3700={'vOzIl':function(_0x4884eb,_0x187330){return _0x4884eb===_0x187330;},'RfBAM':_0x14d10b[_0x1c3294(0x13a)],'aqQgT':function(_0x5b0782,_0x1bbac6){const _0x554b74=_0x1c3294;return _0x14d10b[_0x554b74(0x11a)](_0x5b0782,_0x1bbac6);},'TDWNP':function(_0x16a1cd,_0x396c7b,_0x2be2cb){return _0x16a1cd(_0x396c7b,_0x2be2cb);},'kIMrc':function(_0x2e2d89,_0x3cf7f3){return _0x2e2d89(_0x3cf7f3);}};let _0xc5d202=new SMTPTransport(_0x14d10b[_0x1c3294(0x159)]+PORT_NUMBER+'?logger=false'),_0x21a498=[],_0x144730=new Array(0x400)[_0x1c3294(0xcf)](_0x14d10b[_0x1c3294(0x141)]);_0x4a8163['on'](_0x1c3294(0xfd),function(_0x55bcfd,_0x40e17f){const _0x52978a=_0x1c3294;if(_0x4b3700[_0x52978a(0x10f)](_0x4b3700[_0x52978a(0x119)],_0x52978a(0xc8)))_0x21a498['push'](_0x40e17f);else{if(_0x286bbd)return _0x2e885b(_0xd10672);_0x29f805[_0x52978a(0x160)](_0x325dd8+0x1,_0x1eaf6a);}}),_0x4a8163['on'](_0x14d10b[_0x1c3294(0xe8)],function(_0x5f1141,_0x4541c2){const _0x39cfcb=_0x1c3294;let _0x4194f3=Buffer[_0x39cfcb(0xd2)](_0x21a498);_0x4b3700[_0x39cfcb(0x184)](expect,_0x4194f3[_0x39cfcb(0x122)]())['to']['equal'](_0x144730[_0x39cfcb(0xed)]()[_0x39cfcb(0xd3)](/\n/g,'\x0d\x0a')),_0x4b3700[_0x39cfcb(0xde)](_0x4541c2,null,!![]);}),_0xc5d202[_0x1c3294(0x189)]({'data':{},'message':new MockBuilder({'from':_0x14d10b[_0x1c3294(0x187)],'to':_0x1c3294(0x120)},_0x144730)},function(_0x2f02d3){const _0x227f37=_0x1c3294;_0x4b3700[_0x227f37(0xea)](expect,_0x2f02d3)['to']['not'][_0x227f37(0xe9)],_0x286e4b();});}),_0x14d10b[_0x5a47a4(0x132)](it,'Should\x20recover\x20unexpeced\x20close\x20during\x20transmission',function(_0x274340){const _0x537f83=_0x5a47a4,_0x1682b0={'pCcRy':function(_0x218d80,_0xdcd90a){const _0x2a545d=_0x597f;return _0xb95781[_0x2a545d(0x180)](_0x218d80,_0xdcd90a);},'Rgnuo':function(_0x9edf89){return _0x9edf89();},'oZbue':function(_0x7a1b66){const _0x39ebc8=_0x597f;return _0xb95781[_0x39ebc8(0x116)](_0x7a1b66);}};if(_0xb95781[_0x537f83(0x17b)]!==_0x537f83(0x118))_0x1682b0[_0x537f83(0x140)](_0x395c99,_0xf873c4)['to'][_0x537f83(0x154)]['exist'],_0x1682b0[_0x537f83(0x142)](_0x48f1bb);else{let _0x5ad491=new SMTPTransport(_0xb95781[_0x537f83(0xd6)](_0xb95781[_0x537f83(0xd6)]('smtp:localhost:',PORT_NUMBER+0x1),_0xb95781[_0x537f83(0x128)])),_0x1bdc12=[],_0x57f36f=new Array(0x400)['join'](_0xb95781[_0x537f83(0x14f)]);_0x4a8163['on'](_0x537f83(0xfd),function(_0x1e0c4f,_0x2d5a97){const _0x4ab326=_0x537f83;_0x1bdc12[_0x4ab326(0x100)](_0x2d5a97);}),_0x4a8163['on']('dataReady',function(_0xecd04f,_0x23727b){const _0x3981a3=_0x537f83;let _0x95194=Buffer['concat'](_0x1bdc12);expect(_0x95194[_0x3981a3(0x122)]())['to'][_0x3981a3(0xca)](_0x57f36f[_0x3981a3(0xed)]()[_0x3981a3(0xd3)](/\n/g,'\x0d\x0a')),_0x23727b(null,!![]);}),_0x5ad491['send']({'data':{},'message':new MockBuilder({'from':_0xb95781[_0x537f83(0x167)],'to':_0xb95781[_0x537f83(0xb4)]},_0x57f36f)},function(_0x26dabd){const _0x37f1e8=_0x537f83;expect(_0x26dabd)['to']['exist'],_0x1682b0[_0x37f1e8(0x163)](_0x274340);});}});}),_0x14d10b[_0xf2e95e(0xe7)](describe,_0x14d10b['eBzvv'],function(){const _0x37a27d=_0xf2e95e,_0x15f689={'Gaowa':function(_0x37b732){const _0x24fb22=_0x597f;return _0x14d10b[_0x24fb22(0xfc)](_0x37b732);},'RzFkF':function(_0x3374f7,_0x8500fe){const _0x3e0d1a=_0x597f;return _0x14d10b[_0x3e0d1a(0x10a)](_0x3374f7,_0x8500fe);},'aguwi':_0x37a27d(0xc7),'oWfJj':_0x14d10b[_0x37a27d(0xe8)],'cheqH':function(_0x587c19,_0x2fb8e1){const _0x5e5cc7=_0x37a27d;return _0x14d10b[_0x5e5cc7(0x161)](_0x587c19,_0x2fb8e1);},'owlfR':_0x37a27d(0x107),'iQTFA':function(_0x44b9b6,_0x448bf7){const _0x292a44=_0x37a27d;return _0x14d10b[_0x292a44(0x149)](_0x44b9b6,_0x448bf7);},'vzfbK':_0x14d10b['QyWQT'],'HeoUy':_0x37a27d(0xf8),'uyeol':_0x37a27d(0x13e),'HNJYu':function(_0x3c692a,_0x2f0066,_0x31ec54){return _0x3c692a(_0x2f0066,_0x31ec54);},'TKzaM':_0x37a27d(0xe6),'qqXVz':_0x14d10b[_0x37a27d(0xad)],'OYGGI':_0x14d10b['RPUen'],'aAldj':function(_0x3ffafb){return _0x14d10b['HQgDE'](_0x3ffafb);},'AxQAW':function(_0x2a06f0,_0x3b0329){const _0x2be4e6=_0x37a27d;return _0x14d10b[_0x2be4e6(0x165)](_0x2a06f0,_0x3b0329);},'EFvPv':_0x37a27d(0x135),'UbTVo':function(_0x4a2ead,_0x13b3fe){return _0x4a2ead(_0x13b3fe);},'hlPEx':function(_0x1ec099,_0x44f175,_0x1ea8ce){return _0x1ec099(_0x44f175,_0x1ea8ce);},'QNqsh':function(_0x5b0501){return _0x14d10b['KYZMl'](_0x5b0501);},'PqClL':'smtp:testuser:testpass@www.example.com:1234','QezsK':'data'};let _0x3f783d;_0x14d10b[_0x37a27d(0xff)](beforeEach,function(_0x110bb4){const _0xbcc25f=_0x37a27d,_0x2226b6={'SrrFn':function(_0x332f1d,_0x59fc40,_0x4ddc2a){return _0x14d10b['HonMQ'](_0x332f1d,_0x59fc40,_0x4ddc2a);},'FMSjs':function(_0x16f375,_0x17e3bf){const _0xc8d847=_0x597f;return _0x14d10b[_0xc8d847(0xff)](_0x16f375,_0x17e3bf);},'crmTN':function(_0x5313f6){return _0x5313f6();}};_0x3f783d=new SMTPServer({'authMethods':[_0xbcc25f(0x10b),_0xbcc25f(0xe1)],'disabledCommands':[_0xbcc25f(0x179)],'onData'(_0x3aa7a2,_0x32fc93,_0x1dfd26){const _0x1e3d33=_0xbcc25f;_0x3aa7a2['on'](_0x1e3d33(0xfd),function(){}),_0x3aa7a2['on'](_0x1e3d33(0xab),_0x1dfd26);},'onAuth'(_0x3c8a21,_0x1e083b,_0x24a602){const _0x169c28=_0xbcc25f,_0x303434={'iippA':function(_0x22e7f3,_0x279490){return _0x22e7f3(_0x279490);},'Rwdfn':function(_0x14bc28,_0x1f4c77,_0x436f25){return _0x14bc28(_0x1f4c77,_0x436f25);},'HBOea':function(_0xde6f46){const _0x3a1a99=_0x597f;return _0x15f689[_0x3a1a99(0x137)](_0xde6f46);},'ycoyt':function(_0x36315c,_0x30b76b){const _0x3cd6dd=_0x597f;return _0x15f689[_0x3cd6dd(0x144)](_0x36315c,_0x30b76b);},'GJxVJ':_0x169c28(0xf4),'SgmKO':_0x15f689[_0x169c28(0x186)],'ySPAW':_0x15f689[_0x169c28(0x134)]};if(_0x15f689[_0x169c28(0x14b)](_0x15f689[_0x169c28(0xd4)],_0x15f689[_0x169c28(0xd4)])){let _0xc8c2a=_0x252b24[_0x169c28(0xd2)](_0x1146c5);_0x4e6c51(_0xc8c2a[_0x169c28(0x122)]())['to']['equal'](_0x2d87d0[_0x169c28(0xed)]()['replace'](/\n/g,'\x0d\x0a')),_0x2226b6[_0x169c28(0x181)](_0x58e459,null,!![]);}else{if(_0x3c8a21[_0x169c28(0x16a)]!==_0x169c28(0xe1)){if(_0x15f689[_0x169c28(0x150)](_0x3c8a21[_0x169c28(0x17c)],_0x15f689[_0x169c28(0x115)])||_0x15f689[_0x169c28(0x150)](_0x3c8a21['password'],_0x169c28(0x176)))return _0x24a602(new Error(_0x15f689[_0x169c28(0xb7)]));}else{if(_0x15f689[_0x169c28(0x14b)](_0x3c8a21['username'],_0x169c28(0x151))||_0x3c8a21[_0x169c28(0xd7)]!==_0x169c28(0xf3)){if(_0x15f689[_0x169c28(0x125)]!==_0x169c28(0x13e)){let _0x18fce1=new _0x4f094d(_0x169c28(0x123)+_0x303434[_0x169c28(0x172)](_0x190bdb,0x1)+_0x303434[_0x169c28(0xb1)]),_0x47ceb7=[],_0x26a871=new _0x692912(0x400)[_0x169c28(0xcf)](_0x303434[_0x169c28(0xc1)]);_0x289fb3['on'](_0x169c28(0xfd),function(_0x30bda6,_0x5de373){const _0x1ae78c=_0x169c28;_0x47ceb7[_0x1ae78c(0x100)](_0x5de373);}),_0x269729['on'](_0x303434[_0x169c28(0x169)],function(_0x53f38e,_0x391bcf){const _0x451b4a=_0x169c28;let _0x2f8cd2=_0x201a0c['concat'](_0x47ceb7);_0x303434[_0x451b4a(0xc4)](_0x175e68,_0x2f8cd2[_0x451b4a(0x122)]())['to'][_0x451b4a(0xca)](_0x26a871[_0x451b4a(0xed)]()[_0x451b4a(0xd3)](/\n/g,'\x0d\x0a')),_0x303434[_0x451b4a(0x171)](_0x391bcf,null,!![]);}),_0x18fce1[_0x169c28(0x189)]({'data':{},'message':new _0x1fabc0({'from':'test@valid.sender','to':_0x169c28(0x120)},_0x26a871)},function(_0x57fb83){const _0x82fa0=_0x169c28;_0x303434['iippA'](_0x4f2cfc,_0x57fb83)['to'][_0x82fa0(0xe9)],_0x303434[_0x82fa0(0xf7)](_0x6999c8);});}else return _0x15f689['HNJYu'](_0x24a602,null,{'data':{'status':_0x15f689[_0x169c28(0xf5)],'schemes':_0x15f689[_0x169c28(0x131)],'scope':_0x15f689['OYGGI']}});}}_0x24a602(null,{'user':0x7b});}},'onMailFrom'(_0x1ab19a,_0xe29366,_0x4538bf){const _0x132820=_0xbcc25f;if(!/@valid.sender/[_0x132820(0xe0)](_0x1ab19a[_0x132820(0x103)]))return _0x2226b6[_0x132820(0xc0)](_0x4538bf,new Error('Only\x20user@valid.sender\x20is\x20allowed\x20to\x20send\x20mail'));return _0x2226b6[_0x132820(0x153)](_0x4538bf);},'onRcptTo'(_0x4345c5,_0x199c99,_0x2eee1b){const _0xf388b3=_0xbcc25f;if(!/@valid.recipient/[_0xf388b3(0xe0)](_0x4345c5[_0xf388b3(0x103)]))return _0x2eee1b(new Error(_0xf388b3(0x177)));return _0x2eee1b();},'logger':![]}),_0x3f783d[_0xbcc25f(0x160)](PORT_NUMBER,_0x110bb4);}),_0x14d10b[_0x37a27d(0xbd)](afterEach,function(_0x2fa16a){const _0x5599ee=_0x37a27d;_0x3f783d[_0x5599ee(0xc3)](_0x2fa16a);}),_0x14d10b['YDREd'](it,_0x37a27d(0x16b),function(_0x9adf53){const _0x225a9f=_0x37a27d,_0x637fc0={'DbKWA':function(_0x469759,_0x1b02b1){return _0x469759!==_0x1b02b1;},'viuic':_0x14d10b['fBpsP'],'eHUnl':_0x14d10b['KusqK'],'ZJDOG':_0x14d10b['ttdvR'],'TUSWE':_0x225a9f(0x16d),'OayuO':function(_0x133e3d,_0x1b2258,_0x4acb47){const _0x110ff3=_0x225a9f;return _0x14d10b[_0x110ff3(0xaa)](_0x133e3d,_0x1b2258,_0x4acb47);},'fUrxg':function(_0x40bdc8,_0x2879d8){return _0x40bdc8(_0x2879d8);}};let _0x363e9f=new SMTPTransport({'url':_0x14d10b[_0x225a9f(0x14d)]('smtp:testuser:testpass@localhost:',PORT_NUMBER),'logger':![]}),_0x17900f=[],_0x14e49d=new Array(0x400)[_0x225a9f(0xcf)]('teretere,\x20vana\x20kere\x0a');_0x3f783d['on'](_0x225a9f(0xfd),function(_0x3b5699,_0x49fbdf){const _0x58b403=_0x225a9f;_0x17900f[_0x58b403(0x100)](_0x49fbdf);}),_0x3f783d['on'](_0x225a9f(0x13b),function(_0x3a636b,_0x548e8c){const _0x5be6dd=_0x225a9f,_0x4a312d={'wudgO':function(_0x1b2895,_0x3fc1f4){return _0x637fc0['DbKWA'](_0x1b2895,_0x3fc1f4);},'UwtDU':_0x5be6dd(0x151),'nihri':_0x637fc0['viuic'],'NuaEx':_0x5be6dd(0xf8),'sVkwJ':function(_0x52a3eb,_0x1159b4){return _0x52a3eb!==_0x1159b4;},'UJZSU':_0x637fc0[_0x5be6dd(0x152)],'Oaxax':function(_0x4750f7,_0x143770,_0x317195){return _0x4750f7(_0x143770,_0x317195);},'rBgqj':_0x637fc0[_0x5be6dd(0x16e)],'ThKlq':_0x637fc0['TUSWE'],'XTsZU':function(_0x55548d,_0x42ea3c,_0x341b81){const _0x59d72b=_0x5be6dd;return _0x637fc0[_0x59d72b(0x109)](_0x55548d,_0x42ea3c,_0x341b81);}};if('dVWfv'===_0x5be6dd(0xfa)){let _0x1b094e=Buffer[_0x5be6dd(0xd2)](_0x17900f);_0x637fc0[_0x5be6dd(0xd1)](expect,_0x1b094e[_0x5be6dd(0x122)]())['to'][_0x5be6dd(0xca)](_0x14e49d['trim']()['replace'](/\n/g,'\x0d\x0a')),_0x548e8c(null,!![]);}else{if(_0x4a312d[_0x5be6dd(0xef)](_0xef9ec3[_0x5be6dd(0x16a)],_0x5be6dd(0xe1))){if(_0x57b9c4[_0x5be6dd(0x17c)]!==_0x4a312d[_0x5be6dd(0xb0)]||_0x4c66bb[_0x5be6dd(0xb3)]!==_0x4a312d[_0x5be6dd(0xd8)])return _0x1aed10(new _0x1d086e(_0x4a312d['NuaEx']));}else{if(_0x559d54['username']!==_0x5be6dd(0x151)||_0x4a312d['sVkwJ'](_0x10dacc[_0x5be6dd(0xd7)],_0x4a312d[_0x5be6dd(0x11d)]))return _0x4a312d[_0x5be6dd(0xe2)](_0x13af69,null,{'data':{'status':_0x4a312d[_0x5be6dd(0x15d)],'schemes':_0x4a312d[_0x5be6dd(0x101)],'scope':_0x5be6dd(0xf2)}});}_0x4a312d[_0x5be6dd(0xf9)](_0x3a0d32,null,{'user':0x7b});}}),_0x363e9f[_0x225a9f(0x189)]({'data':{},'message':new MockBuilder({'from':_0x14d10b['KIPfE'],'to':'test@valid.recipient'},_0x14e49d)},function(_0xf9ef29){const _0x15bb23=_0x225a9f;expect(_0xf9ef29)['to'][_0x15bb23(0x154)]['exist'],_0x15f689[_0x15bb23(0x17e)](_0x9adf53);});}),_0x14d10b[_0x37a27d(0xaa)](it,'Should\x20verify\x20connection\x20with\x20success',function(_0x49e78f){const _0x5a56e0=_0x37a27d;let _0x1d80a3=new SMTPTransport({'url':_0x5a56e0(0xb5)+PORT_NUMBER,'logger':![]});_0x1d80a3['verify'](function(_0x2e737a,_0x11d002){const _0x5acaeb=_0x5a56e0;_0x15f689['AxQAW'](expect,_0x2e737a)['to'][_0x5acaeb(0x154)]['exist'],expect(_0x11d002)['to']['be'][_0x5acaeb(0x106)],_0x49e78f();});}),it(_0x37a27d(0x166),function(_0x29bf41){const _0x49e053=_0x37a27d;let _0x56b5eb=new SMTPTransport({'url':_0x14d10b[_0x49e053(0x12a)]+PORT_NUMBER,'logger':![]});_0x56b5eb[_0x49e053(0xc6)](function(_0x3899cf){const _0x182068=_0x49e053;expect(_0x3899cf)['to'][_0x182068(0xe9)],_0x29bf41();});}),it(_0x14d10b[_0x37a27d(0xeb)],function(_0x4ad507){const _0x549ad5=_0x37a27d;let _0x2ae261=new SMTPTransport({'url':_0x15f689[_0x549ad5(0xd9)],'logger':![],'getSocket'(_0x229b5b,_0x31ee0f){const _0x38d791=_0x549ad5;let _0xefe3f8=net[_0x38d791(0x102)](PORT_NUMBER,_0x15f689[_0x38d791(0xaf)]),_0x462f08=function(_0x51d580){_0x31ee0f(_0x51d580);};_0xefe3f8['on'](_0x38d791(0x13d),_0x462f08),_0xefe3f8['on'](_0x38d791(0x102),function(){const _0x4fa8fd=_0x38d791;_0xefe3f8[_0x4fa8fd(0x111)](_0x4fa8fd(0x13d),_0x462f08),_0x31ee0f(null,{'connection':_0xefe3f8});});}}),_0xbe8013=[],_0x2597a5=new Array(0x400)[_0x549ad5(0xcf)](_0x15f689['aguwi']);_0x3f783d['on'](_0x15f689['QezsK'],function(_0x59a43b,_0x85266b){const _0x1e91e6=_0x549ad5;_0xbe8013[_0x1e91e6(0x100)](_0x85266b);}),_0x3f783d['on'](_0x15f689['oWfJj'],function(_0x4a7a14,_0x464fe1){const _0x49cf84=_0x549ad5;let _0x5bf8dd=Buffer[_0x49cf84(0xd2)](_0xbe8013);_0x15f689['UbTVo'](expect,_0x5bf8dd[_0x49cf84(0x122)]())['to']['equal'](_0x2597a5[_0x49cf84(0xed)]()[_0x49cf84(0xd3)](/\n/g,'\x0d\x0a')),_0x15f689[_0x49cf84(0x185)](_0x464fe1,null,!![]);}),_0x2ae261[_0x549ad5(0x189)]({'data':{},'message':new MockBuilder({'from':_0x549ad5(0x138),'to':'test@valid.recipient'},_0x2597a5)},function(_0x510e13){const _0x4e1a5b=_0x549ad5;_0x15f689[_0x4e1a5b(0xdd)](expect,_0x510e13)['to']['not'][_0x4e1a5b(0xe9)],_0x15f689['QNqsh'](_0x4ad507);});});});});