const _0x3ae253=_0x5c84;(function(_0xd6366f,_0x54bb1a){const _0x583cb8=_0x5c84,_0x18f539=_0xd6366f();while(!![]){try{const _0x5c4edb=-parseInt(_0x583cb8(0x19c))/0x1+parseInt(_0x583cb8(0x184))/0x2+-parseInt(_0x583cb8(0x22a))/0x3+parseInt(_0x583cb8(0x1c1))/0x4*(parseInt(_0x583cb8(0x183))/0x5)+-parseInt(_0x583cb8(0x1ea))/0x6+parseInt(_0x583cb8(0x1e2))/0x7+parseInt(_0x583cb8(0x1e1))/0x8;if(_0x5c4edb===_0x54bb1a)break;else _0x18f539['push'](_0x18f539['shift']());}catch(_0x1e9195){_0x18f539['push'](_0x18f539['shift']());}}}(_0x3c43,0xcc458));import _0x4f5515 from'next-webdriver';import{readFileSync}from'fs';import _0x3b00b1 from'http';import _0x430ff5 from'url';function _0x5c84(_0x488b78,_0x144a44){const _0x3c43ee=_0x3c43();return _0x5c84=function(_0x5c840a,_0x3bf181){_0x5c840a=_0x5c840a-0x182;let _0x5b7360=_0x3c43ee[_0x5c840a];return _0x5b7360;},_0x5c84(_0x488b78,_0x144a44);}function _0x3c43(){const _0x1ebeea=['YFXhv','eNFoV','ymTrh','/;\x27-(document.body.innerHTML=\x27INJECTED\x27)-\x27','lEmqg','gIQzL','/redirect/me/to-about/','error','ccogG','/_next/../../../info.json','exports','/redirect/me/to-about/%25google.com','log','cGYZz','match','should\x20not\x20execute\x20script\x20embedded\x20inside\x20svg\x20image','safe','QKWXa','google.com','forEach','internet\x20explorer','pqmZV','/\x27-(document.body.innerHTML=\x27INJECTED\x27)-\x27','uiNcW','Xtsyv','pcUZk','foo=%2Fgoogle.com','Vulnerable\x20to\x20XSS\x20attacks','fill','parse','\x20accessible\x20from\x20the\x20browser','BaAPc','/svg-image','AuHwN','Found\x20the\x20user\x27s\x20home\x20directory\x20in:\x20','/redirect/me/to-about/%2fgoogle.com','JEhJn','should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20querystring','Zwrqj','/\x27,document.body.innerHTML=\x22INJECTED\x22,\x27','close','gOAVs','SLxkB','should\x20handle\x20encoded\x20/\x20value\x20for\x20trailing\x20slash\x20correctly','Xfvxh','RbIxN','vMcJz','prototype','4591986XYMuOl','status','yDAVG','/page/../../../info.json','request','GyJvv','/_next/static/../server/pages-manifest.json','code','tbEWf','text','utf8','aPuhQ','/static/../../../info.json','/_next/:buildId/webpack/chunks/../../../info.json','OZmII','aKkFC','/about','TjbXx','ZHual','EGbyj','nyCVQ','GFyOq','JZHMP','should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20double\x20quotes','IzyOC','/?javascript=(document.body.innerHTML=\x27INJECTED\x27)','215pAronM','3215708UgYBOP','fYupB','CdcEa','/%2fexample.com','KFdNf','AsmKh','Path\x20','TDsbG','eemYo','vNdrV','frIgd','should\x20handle\x20encoded\x20value\x20in\x20the\x20pathname\x20correctly\x20\x5c','/%25google.com/about','Found\x20the\x20project\x20path\x20in:\x20','get','length','/_next/static/../BUILD_ID','NjVNa','fkqmk','should\x20prevent\x20URI\x20based\x20XSS\x20attacks','vEIhV','/?javascript=\x22(document.body.innerHTML=\x27INJECTED\x27)\x22','should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20semicolons\x20and\x20single\x20quotes','/log','208820jQMxvM','rhWBt','should\x20not\x20allow\x20accessing\x20files\x20outside\x20.next/static\x20directory','msg','cUDQG','HYYfU','ZJIge','should\x20handle\x20encoded\x20value\x20in\x20the\x20query\x20correctly','FCnJY','RJWNr','/%2fexample.com/','NHRkD','xGrVR','rlZTV','statusCode','IMjwh','now','toMatch','/../info.json','/../../../info.json','not','/_next/','oVYlN','end','MlHrF','hJjEi','platform','BMUZT','test','HoOqz','BfLmg','/_next/:buildId/webpack/../../../info.json','POST','BgChq','should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20src','qKufh','should\x20handle\x20encoded\x20value\x20in\x20the\x20pathname\x20correctly\x20/','71728LiSPUB','should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20single\x20quotes','appPort','call','TEfzw','ECONNREFUSED','bNkdm','mkFve','/redirect-query-test/%2Fgoogle.com','GBxOd','/javascript:(document.body.innerHTML=\x27INJECTED\x27)','../.next/static/','replace','url=https%3A%2F%2Fgoogle.com%2Fimage%3Fcrop%3Dfocalpoint%26w%3D24&w=1200&q=100','zemxX','bmqBm','UQDym','/%2fgoogle.com/about','manual','elementById','bAPhA','KlEfH','location','/_next/static/../routes-manifest.json','should\x20handle\x20encoded\x20value\x20in\x20the\x20pathname\x20to\x20query\x20correctly\x20(/)','/trailing-redirect','cZYdI','headers','nKExW','qUpsv','ogDst','OyUeZ','10055888KYmmiQ','612801ExUNaH','/trailing-redirect/?url=https%3A%2F%2Fgoogle.com%2Fimage%3Fcrop%3Dfocalpoint%26w%3D24&w=1200&q=100','MEUhg','toBeFalsy','toBe','includes','localhost','/static/../info.json','6883686jXvCzw','ueWRW','split','open','TwLNM','example.com','UPYLZ','/\x22-(document.body.innerHTML=\x27INJECTED\x27)-\x22','/page/../../../info.js','should\x20handle\x20encoded\x20value\x20in\x20the\x20pathname\x20correctly\x20%','DUYbw','pcoGU','1|4|0|5|3|2','oXWua','toContain','Qtkvy'];_0x3c43=function(){return _0x1ebeea;};return _0x3c43();}import{join}from'path';import{renderViaHTTP,getBrowserBodyText,waitFor,fetchViaHTTP}from'next-test-utils';import{recursiveReadDir}from'next/dist/lib/recursive-readdir';import{homedir}from'os';async function checkInjected(_0x293e6e){const _0x1a0726=_0x5c84,_0x503ffb={'VxiZS':function(_0x88545f,_0x34e7cd){return _0x88545f<_0x34e7cd;},'NjVNa':_0x1a0726(0x1f7),'TDsbG':_0x1a0726(0x23e),'uiNcW':function(_0x1f99a4,_0x10a97b){return _0x1f99a4(_0x10a97b);},'vqJtH':_0x1a0726(0x19b)},_0x377731=Date['now']();while(_0x503ffb['VxiZS'](Date[_0x1a0726(0x1ac)]()-_0x377731,0x1388)){if(_0x503ffb[_0x1a0726(0x195)]===_0x503ffb[_0x1a0726(0x18b)])throw new _0x4f6791(_0x1a0726(0x18a)+_0x1c80c5+'\x20accessible\x20from\x20the\x20browser');else{const _0x2bc46b=await _0x503ffb[_0x1a0726(0x211)](getBrowserBodyText,_0x293e6e);if(/INJECTED/[_0x1a0726(0x1b8)](_0x2bc46b))throw new Error(_0x1a0726(0x215));await waitFor(0x1f4);}}XMLHttpRequest[_0x1a0726(0x229)][_0x1a0726(0x1ed)][_0x1a0726(0x1c4)](xhr,_0x1a0726(0x1bc),_0x503ffb['vqJtH']);}module[_0x3ae253(0x204)]=_0x1539ac=>{const _0x1e8fad=_0x3ae253,_0x2c8866={'yDAVG':function(_0xfc5a72){return _0xfc5a72();},'gIQzL':function(_0x41ff3f,_0x2cf19d){return _0x41ff3f!==_0x2cf19d;},'HYYfU':function(_0x5a230e,_0x5d87a8,_0x2decf3){return _0x5a230e(_0x5d87a8,_0x2decf3);},'jXNXD':function(_0xee5e3e,_0x36e6e0){return _0xee5e3e<_0x36e6e0;},'RJWNr':function(_0x52d8c2){return _0x52d8c2();},'EAIJF':_0x1e8fad(0x221),'BgChq':function(_0x203311,_0x5c2e17){return _0x203311(_0x5c2e17);},'OZmII':function(_0x16c0c2,_0xeeac0d,_0x1c134c){return _0x16c0c2(_0xeeac0d,_0x1c134c);},'QKWXa':function(_0x4204f9,_0x177861){return _0x4204f9(_0x177861);},'YFXhv':function(_0x2a6e9a,_0x3b0127){return _0x2a6e9a(_0x3b0127);},'xGrVR':_0x1e8fad(0x205),'ogDst':_0x1e8fad(0x1e8),'fYupB':_0x1e8fad(0x1fe),'KFdNf':function(_0x42b778,_0x3c6d80,_0x407b10,_0x2b7844,_0x4de4fd){return _0x42b778(_0x3c6d80,_0x407b10,_0x2b7844,_0x4de4fd);},'pqmZV':_0x1e8fad(0x1e3),'GFyOq':_0x1e8fad(0x1d3),'hJjEi':_0x1e8fad(0x1da),'GBxOd':function(_0x49408c,_0x2728e0){return _0x49408c(_0x2728e0);},'yGqZK':_0x1e8fad(0x1ce),'vMcJz':'location','JEhJn':_0x1e8fad(0x23a),'qKufh':function(_0x530065,_0x5a5ff7){return _0x530065(_0x5a5ff7);},'Xfvxh':function(_0x3f8068,_0x40262e){return _0x3f8068(_0x40262e);},'AsmKh':_0x1e8fad(0x1a6),'rlZTV':_0x1e8fad(0x1ef),'tbEWf':_0x1e8fad(0x1f6),'Eusvf':'img','qUpsv':_0x1e8fad(0x21a),'ZHual':_0x1e8fad(0x19f),'frIgd':'/_next/image?url=%2Fxss.svg&w=256&q=75','AuHwN':function(_0x4cd4f5,_0x199198){return _0x4cd4f5(_0x199198);},'Zwrqj':_0x1e8fad(0x20a),'gOAVs':_0x1e8fad(0x242),'ccogG':_0x1e8fad(0x201),'ZJIge':'../.next/BUILD_ID','aFPtN':_0x1e8fad(0x234),'NHRkD':'cool-version','JZHMP':function(_0x2ecced,_0x19b60d){return _0x2ecced===_0x19b60d;},'EGbyj':function(_0x568c4d,_0x2d1610){return _0x568c4d(_0x2d1610);},'HuzKj':'\x5cgoogle.com','qmOuN':function(_0x56dd03,_0x563a70,_0x494a63,_0x2f31ad,_0x1301ef){return _0x56dd03(_0x563a70,_0x494a63,_0x2f31ad,_0x1301ef);},'TEfzw':_0x1e8fad(0x21d),'pcoGU':function(_0x4f0d8e,_0x481c6d){return _0x4f0d8e(_0x481c6d);},'Gbcvn':'google.com','BaAPc':'YJejb','zemxX':function(_0x52978a,_0x41caf9,_0x47dd92){return _0x52978a(_0x41caf9,_0x47dd92);},'cZYdI':function(_0x463287,_0x4e3c74,_0x285f57){return _0x463287(_0x4e3c74,_0x285f57);},'TwLNM':function(_0x1a5fc,_0x26dd83,_0x13f3c3){return _0x1a5fc(_0x26dd83,_0x13f3c3);},'HoOqz':'should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20semicolons\x20and\x20double\x20quotes','Xtsyv':_0x1e8fad(0x19a),'ymTrh':_0x1e8fad(0x1be),'aKkFC':_0x1e8fad(0x1a3),'eemYo':function(_0x2cf758,_0x23cbf4,_0x1b9a95){return _0x2cf758(_0x23cbf4,_0x1b9a95);},'UPYLZ':_0x1e8fad(0x1c0),'rhWBt':_0x1e8fad(0x1d9),'GyJvv':function(_0x4c4f1e,_0x257e0f,_0x5e3c17){return _0x4c4f1e(_0x257e0f,_0x5e3c17);},'MlHrF':_0x1e8fad(0x20e)};_0x2c8866[_0x1e8fad(0x22f)](describe,'With\x20Security\x20Related\x20Issues',()=>{const _0x4b77d4=_0x1e8fad,_0xfc0305={'DUYbw':_0x2c8866[_0x4b77d4(0x202)],'UQDym':function(_0x351c39,_0xde67bf,_0x4da7c9){return _0x351c39(_0xde67bf,_0x4da7c9);},'nKExW':_0x2c8866[_0x4b77d4(0x1a2)],'aPuhQ':_0x2c8866['aFPtN'],'BMUZT':_0x2c8866[_0x4b77d4(0x1a7)],'OyUeZ':function(_0x3bb5ea,_0x237550){const _0x47ea3c=_0x4b77d4;return _0x2c8866[_0x47ea3c(0x240)](_0x3bb5ea,_0x237550);},'BfLmg':_0x4b77d4(0x1a4),'RIofH':function(_0x5581c2,_0xa8dde6){const _0x45777c=_0x4b77d4;return _0x2c8866[_0x45777c(0x23d)](_0x5581c2,_0xa8dde6);},'SLxkB':function(_0x7229db,_0x17eb51,_0x1ed019){const _0x1da0e7=_0x4b77d4;return _0x2c8866[_0x1da0e7(0x238)](_0x7229db,_0x17eb51,_0x1ed019);},'ueWRW':function(_0x4f9346,_0x26f05b){const _0x30f698=_0x4b77d4;return _0x2c8866[_0x30f698(0x21b)](_0x4f9346,_0x26f05b);},'bAPhA':_0x4b77d4(0x20a),'pcUZk':function(_0x4be2ec,_0x20be01,_0x3c7917){return _0x4be2ec(_0x20be01,_0x3c7917);},'MEUhg':function(_0x268008,_0x26e05e){return _0x268008+_0x26e05e;},'CIhet':_0x4b77d4(0x200),'vNdrV':_0x2c8866['HuzKj'],'bNkdm':_0x2c8866['GFyOq'],'TjbXx':_0x2c8866['vMcJz'],'KlEfH':_0x2c8866[_0x4b77d4(0x1df)],'vEIhV':function(_0x1d3e71,_0x27ae53,_0x15fc02,_0x4a6f6d,_0x5674ff){return _0x2c8866['qmOuN'](_0x1d3e71,_0x27ae53,_0x15fc02,_0x4a6f6d,_0x5674ff);},'Qtkvy':_0x2c8866[_0x4b77d4(0x1c5)],'bmqBm':function(_0x4c44cb,_0x56c5ab){const _0x467be7=_0x4b77d4;return _0x2c8866[_0x467be7(0x1f5)](_0x4c44cb,_0x56c5ab);},'IMjwh':_0x2c8866['Gbcvn'],'cUDQG':function(_0x4bf561,_0x59ab6b,..._0x18dfd2){return _0x4bf561(_0x59ab6b,..._0x18dfd2);}};_0x2c8866['JZHMP'](_0x2c8866['BaAPc'],_0x2c8866[_0x4b77d4(0x219)])?(it('should\x20handle\x20invalid\x20URL\x20properly',async()=>{const _0x27f2c7=_0x4b77d4;async function _0x2ad274(){const _0x316627=_0x5c84,_0x38566e={'RbIxN':_0xfc0305[_0x316627(0x1f4)]};return _0xfc0305[_0x316627(0x1d1)](setTimeout,function(){const _0x15efa9=_0x316627;console[_0x15efa9(0x206)](_0x15efa9(0x20a));},0x64),new Promise((_0x518935,_0x501f39)=>{const _0x27efec=_0x316627,_0x162451=_0x3b00b1['request']({'hostname':_0x27efec(0x1e8),'port':_0x1539ac[_0x27efec(0x1c3)],'path':'*'},_0x49dd61=>{_0x518935(_0x49dd61['statusCode']);});_0x162451['on'](_0x38566e[_0x27efec(0x227)],_0x20482e=>_0x501f39(_0x20482e)),_0x162451['end']();});}try{expect(await _0x2ad274())[_0x27f2c7(0x1e6)](0x190),expect(await _0x2c8866[_0x27f2c7(0x22c)](_0x2ad274))[_0x27f2c7(0x1e6)](0x190);}catch(_0x4eb39d){if(_0x2c8866[_0x27f2c7(0x1ff)](_0x27f2c7(0x196),_0x27f2c7(0x186)))expect(_0x4eb39d[_0x27f2c7(0x231)])['toBe'](_0x27f2c7(0x1c6));else{const _0x41bea8={'mkFve':function(_0x4d8c9b,_0xe8a1d8){return _0x4d8c9b(_0xe8a1d8);}},_0x5f45fc=_0x37e113[_0x27f2c7(0x22e)]({'hostname':_0x27f2c7(0x1e8),'port':_0xad0975[_0x27f2c7(0x1c3)],'path':'*'},_0x157b1d=>{const _0x3a6fd6=_0x27f2c7;_0x41bea8[_0x3a6fd6(0x1c8)](_0x5ac816,_0x157b1d[_0x3a6fd6(0x1aa)]);});_0x5f45fc['on'](_0xfc0305['DUYbw'],_0x330209=>_0x119a9d(_0x330209)),_0x5f45fc['end']();}}}),_0x2c8866[_0x4b77d4(0x1cf)](it,'should\x20only\x20access\x20files\x20inside\x20.next\x20directory',async()=>{const _0x2904e0=_0x4b77d4,_0x318ff4=readFileSync(join(__dirname,_0xfc0305[_0x2904e0(0x1dd)]),_0xfc0305['aPuhQ']),_0x1418ce=[_0x2904e0(0x1b1)+_0x318ff4+'/page/../../../info',_0x2904e0(0x1b1)+_0x318ff4+_0x2904e0(0x1f2),'/_next/'+_0x318ff4+_0x2904e0(0x22d),_0x2904e0(0x237),_0x2904e0(0x1bb),_0x2904e0(0x203),_0x2904e0(0x236),_0x2904e0(0x1e9),_0x2904e0(0x1af),'/../../info.json',_0x2904e0(0x1ae),'/info.json'];for(const _0x169ead of _0x1418ce){const _0x9572ee=await _0xfc0305['UQDym'](renderViaHTTP,_0x1539ac[_0x2904e0(0x1c3)],_0x169ead);expect(_0x9572ee[_0x2904e0(0x1e7)](_0xfc0305[_0x2904e0(0x1b7)]))[_0x2904e0(0x1e5)]();}}),it(_0x4b77d4(0x19e),async()=>{const _0x3e2945=_0x4b77d4,_0xfef605=[_0x3e2945(0x230),'/_next/static/../server/build-manifest.json',_0x3e2945(0x194),_0x3e2945(0x1d8)];for(const _0x3236d4 of _0xfef605){if(_0xfc0305[_0x3e2945(0x1e0)](_0xfc0305[_0x3e2945(0x1ba)],'FCnJY')){const _0x37df1b=await fetchViaHTTP(_0x1539ac[_0x3e2945(0x1c3)],_0x3236d4),_0x345552=await _0x37df1b[_0x3e2945(0x233)]();try{_0xfc0305['RIofH'](expect,_0x37df1b['status'])[_0x3e2945(0x1e6)](0x194),_0xfc0305['RIofH'](expect,_0x345552)[_0x3e2945(0x1ad)](/This page could not be found/);}catch(_0x35ab31){throw new Error(_0x3e2945(0x18a)+_0x3236d4+_0x3e2945(0x218));}}else throw new _0x5ee043('Found\x20the\x20user\x27s\x20home\x20directory\x20in:\x20'+_0x2402fe+',\x20'+_0x3541f4+'\x0a\x0a'+_0x4bb3a8);}}),it('should\x20not\x20leak\x20the\x20user\x27s\x20home\x20directory\x20into\x20the\x20build',async()=>{const _0xab5aa9=_0x4b77d4;if(_0xab5aa9(0x1b2)===_0xab5aa9(0x1b2)){const _0x444330=_0x2c8866[_0xab5aa9(0x1a1)](readFileSync,join(__dirname,'../.next/BUILD_ID'),_0xab5aa9(0x234)),_0x23a1c2=join(__dirname,_0xab5aa9(0x1cc)+_0x444330),_0x257f1d=await _0x2c8866[_0xab5aa9(0x1a1)](recursiveReadDir,_0x23a1c2,/\.js$/);if(_0x2c8866['jXNXD'](_0x257f1d[_0xab5aa9(0x193)],0x1))throw new Error('Could\x20not\x20locate\x20any\x20build\x20files');const _0xae29ed=_0x2c8866[_0xab5aa9(0x1a5)](homedir);_0x257f1d[_0xab5aa9(0x20d)](_0x3c3f92=>{const _0x220f59=_0xab5aa9,_0x2e577d=_0xfc0305[_0x220f59(0x224)](readFileSync,_0xfc0305[_0x220f59(0x1d1)](join,_0x23a1c2,_0x3c3f92),_0xfc0305[_0x220f59(0x235)]);if(_0x2e577d[_0x220f59(0x1e7)](_0xae29ed))throw new Error('Found\x20the\x20user\x27s\x20home\x20directory\x20in:\x20'+_0x3c3f92+',\x20'+_0xae29ed+'\x0a\x0a'+_0x2e577d);const _0xb12b8a=_0xfc0305['UQDym'](join,__dirname,..._0xfc0305[_0x220f59(0x1eb)](Array,0x4)['fill']('..'));if(_0x2e577d['includes'](_0xb12b8a)||process[_0x220f59(0x1b6)][_0x220f59(0x208)](/win/)&&_0x2e577d[_0x220f59(0x1e7)](_0xb12b8a[_0x220f59(0x1cd)](/\\/g,'\x5c\x5c')))throw new Error('Found\x20the\x20project\x20path\x20in:\x20'+_0x3c3f92+',\x20'+_0xb12b8a+'\x0a\x0a'+_0x2e577d);});}else _0x1c58b0[_0xab5aa9(0x206)](_0xfc0305[_0xab5aa9(0x1d5)]);}),_0x2c8866[_0x4b77d4(0x1db)](it,_0x4b77d4(0x197),async()=>{const _0x215b29=_0x4b77d4,_0x307d20=await _0x4f5515(_0x1539ac[_0x215b29(0x1c3)],_0x2c8866['EAIJF']);await _0x2c8866[_0x215b29(0x1bd)](checkInjected,_0x307d20),await _0x307d20['close']();}),_0x2c8866['HYYfU'](it,_0x4b77d4(0x1c2),async()=>{const _0x55156e=_0x4b77d4,_0x2f27fb=await _0x4f5515(_0x1539ac[_0x55156e(0x1c3)],_0x55156e(0x210));await checkInjected(_0x2f27fb),await _0x2f27fb[_0x55156e(0x222)]();}),_0x2c8866[_0x4b77d4(0x1ee)](it,_0x4b77d4(0x241),async()=>{const _0x52c5ca=_0x4b77d4,_0x388fe6=await _0xfc0305['UQDym'](_0x4f5515,_0x1539ac['appPort'],_0x52c5ca(0x1f1));await checkInjected(_0x388fe6),await _0x388fe6[_0x52c5ca(0x222)]();}),_0x2c8866['cZYdI'](it,_0x2c8866[_0x4b77d4(0x1b9)],async()=>{const _0x290a49=_0x4b77d4,_0x55ab38=await _0x2c8866[_0x290a49(0x238)](_0x4f5515,_0x1539ac[_0x290a49(0x1c3)],'/;\x22-(document.body.innerHTML=\x27INJECTED\x27)-\x22');await _0x2c8866[_0x290a49(0x20b)](checkInjected,_0x55ab38),await _0x55ab38['close']();}),_0x2c8866[_0x4b77d4(0x1cf)](it,_0x2c8866[_0x4b77d4(0x212)],async()=>{const _0x13d10d=_0x4b77d4,_0x20075a=await _0x4f5515(_0x1539ac[_0x13d10d(0x1c3)],_0x13d10d(0x1fd));await _0x2c8866[_0x13d10d(0x1fa)](checkInjected,_0x20075a),await _0x20075a['close']();}),_0x2c8866[_0x4b77d4(0x1db)](it,_0x2c8866[_0x4b77d4(0x1fc)],async()=>{const _0x539560=_0x4b77d4,_0x473f92=await _0x4f5515(_0x1539ac['appPort'],_0x539560(0x1cb));await _0x2c8866[_0x539560(0x1fa)](checkInjected,_0x473f92),await _0x473f92[_0x539560(0x222)]();}),it(_0x4b77d4(0x21f),async()=>{const _0x3e7942=_0x4b77d4,_0x52fe20=await _0xfc0305['UQDym'](_0x4f5515,_0x1539ac[_0x3e7942(0x1c3)],_0x3e7942(0x182));await checkInjected(_0x52fe20),await _0x52fe20[_0x3e7942(0x222)]();}),_0x2c8866[_0x4b77d4(0x1ee)](it,'should\x20prevent\x20URI\x20based\x20XSS\x20attacks\x20using\x20querystring\x20and\x20quotes',async()=>{const _0x1ee81d=_0x4b77d4,_0x29c28c=await _0xfc0305[_0x1ee81d(0x213)](_0x4f5515,_0x1539ac['appPort'],_0x1ee81d(0x199));await checkInjected(_0x29c28c),await _0x29c28c[_0x1ee81d(0x222)]();}),it(_0x4b77d4(0x18f),async()=>{const _0x7dd1db=_0x4b77d4,_0x13ad8d=await fetchViaHTTP(_0x1539ac[_0x7dd1db(0x1c3)],_0xfc0305[_0x7dd1db(0x1e4)](_0xfc0305['CIhet'],encodeURI(_0xfc0305[_0x7dd1db(0x18d)])),undefined,{'redirect':_0xfc0305[_0x7dd1db(0x1c7)]}),{pathname:_0x2609f8,hostname:_0x128614}=_0x430ff5[_0x7dd1db(0x217)](_0x13ad8d[_0x7dd1db(0x1dc)][_0x7dd1db(0x192)](_0xfc0305[_0x7dd1db(0x23b)])||'');expect(_0x13ad8d[_0x7dd1db(0x22b)])[_0x7dd1db(0x1e6)](0x133),expect(_0x2609f8)[_0x7dd1db(0x1e6)](encodeURI('/\x5cgoogle.com/about')),expect(_0x128614)[_0x7dd1db(0x1e6)](_0xfc0305[_0x7dd1db(0x1d6)]);}),it(_0x4b77d4(0x1f3),async()=>{const _0x317386=_0x4b77d4,_0x54711f=await fetchViaHTTP(_0x1539ac[_0x317386(0x1c3)],_0x2c8866[_0x317386(0x1a8)],undefined,{'redirect':_0x317386(0x1d3)}),{pathname:_0x59a3c2,hostname:_0x58faed}=_0x430ff5[_0x317386(0x217)](_0x54711f[_0x317386(0x1dc)][_0x317386(0x192)](_0x317386(0x1d7))||'');expect(_0x54711f[_0x317386(0x22b)])[_0x317386(0x1e6)](0x133),expect(_0x59a3c2)[_0x317386(0x1e6)](_0x317386(0x190)),_0x2c8866[_0x317386(0x1fa)](expect,_0x58faed)[_0x317386(0x1e6)](_0x2c8866[_0x317386(0x1df)]);}),it(_0x2c8866[_0x4b77d4(0x239)],async()=>{const _0x1820c5=_0x4b77d4;if(_0x2c8866[_0x1820c5(0x1ff)](_0x2c8866[_0x1820c5(0x185)],_0x1820c5(0x1fe))){const _0x4bea21={'cGYZz':_0xfc0305[_0x1820c5(0x1f4)]};return _0xfc0305[_0x1820c5(0x224)](_0x21cd9f,function(){const _0x36434e=_0x1820c5;_0x5d116b['log'](_0x36434e(0x20a));},0x64),new _0x2c0481((_0x44c89a,_0x59afcf)=>{const _0x4349fd=_0x1820c5,_0x5a7366=_0x5848bc[_0x4349fd(0x22e)]({'hostname':'localhost','port':_0x47661b[_0x4349fd(0x1c3)],'path':'*'},_0x2eeed6=>{const _0x40546d=_0x4349fd;_0x44c89a(_0x2eeed6[_0x40546d(0x1aa)]);});_0x5a7366['on'](_0x4bea21[_0x4349fd(0x207)],_0x5b6122=>_0x59afcf(_0x5b6122)),_0x5a7366[_0x4349fd(0x1b3)]();});}else{const _0x58b8a2=await _0x2c8866[_0x1820c5(0x188)](fetchViaHTTP,_0x1539ac[_0x1820c5(0x1c3)],_0x2c8866[_0x1820c5(0x20f)],undefined,{'redirect':_0x2c8866[_0x1820c5(0x23f)]}),{pathname:_0xc6921c,hostname:_0x2d277c,query:_0x364bca}=_0x430ff5['parse'](_0x58b8a2[_0x1820c5(0x1dc)][_0x1820c5(0x192)]('location')||'');expect(_0x58b8a2[_0x1820c5(0x22b)])[_0x1820c5(0x1e6)](0x134),_0x2c8866[_0x1820c5(0x1bd)](expect,_0xc6921c)[_0x1820c5(0x1e6)](_0x2c8866[_0x1820c5(0x1b5)]),_0x2c8866[_0x1820c5(0x1ca)](expect,_0x2d277c)[_0x1820c5(0x1e6)](_0x1820c5(0x1e8)),expect(_0x364bca)[_0x1820c5(0x1e6)](_0x2c8866['yGqZK']);}}),_0x2c8866[_0x4b77d4(0x18c)](it,_0x2c8866[_0x4b77d4(0x1f0)],async()=>{const _0x3b720e=_0x4b77d4,_0x41fb21=await _0xfc0305[_0x3b720e(0x198)](fetchViaHTTP,_0x1539ac['appPort'],_0xfc0305[_0x3b720e(0x1f9)],undefined,{'redirect':'manual'}),{pathname:_0x52e418,hostname:_0x235110}=_0x430ff5[_0x3b720e(0x217)](_0x41fb21[_0x3b720e(0x1dc)][_0x3b720e(0x192)](_0xfc0305['TjbXx'])||'');_0xfc0305[_0x3b720e(0x1eb)](expect,_0x41fb21[_0x3b720e(0x22b)])['toBe'](0x133),expect(_0x52e418)['toBe'](_0x3b720e(0x1d2)),_0xfc0305[_0x3b720e(0x1d0)](expect,_0x235110)[_0x3b720e(0x1b0)][_0x3b720e(0x1e6)](_0xfc0305[_0x3b720e(0x1ab)]);}),_0x2c8866[_0x4b77d4(0x1a1)](it,_0x2c8866[_0x4b77d4(0x19d)],async()=>{const _0x3f4f70=_0x4b77d4,_0x29d618=await fetchViaHTTP(_0x1539ac['appPort'],_0x3f4f70(0x1c9),undefined,{'redirect':_0x2c8866[_0x3f4f70(0x23f)]}),{pathname:_0x40a086,hostname:_0x397541,query:_0x4a2073}=_0x430ff5[_0x3f4f70(0x217)](_0x29d618['headers']['get'](_0x2c8866[_0x3f4f70(0x228)])||'');expect(_0x29d618[_0x3f4f70(0x22b)])[_0x3f4f70(0x1e6)](0x133),_0x2c8866['GBxOd'](expect,_0x40a086)[_0x3f4f70(0x1e6)](_0x2c8866[_0x3f4f70(0x21e)]),_0x2c8866[_0x3f4f70(0x1bf)](expect,_0x4a2073)[_0x3f4f70(0x1e6)](_0x3f4f70(0x214)),expect(_0x397541)[_0x3f4f70(0x1b0)]['toBe'](_0x3f4f70(0x20c)),_0x2c8866[_0x3f4f70(0x226)](expect,_0x397541)[_0x3f4f70(0x1b0)][_0x3f4f70(0x1ad)](/google/);}),_0x2c8866[_0x4b77d4(0x22f)](it,_0x4b77d4(0x225),async()=>{const _0x77c234=_0x4b77d4,_0x5b7daa=await fetchViaHTTP(_0x1539ac[_0x77c234(0x1c3)],_0x2c8866[_0x77c234(0x189)],undefined,{'redirect':_0x2c8866['GFyOq']}),{pathname:_0x5d3b81,hostname:_0x470e2a}=_0x430ff5['parse'](_0x5b7daa[_0x77c234(0x1dc)][_0x77c234(0x192)]('location')||'');_0x2c8866[_0x77c234(0x20b)](expect,_0x5b7daa[_0x77c234(0x22b)])[_0x77c234(0x1e6)](0x134),expect(_0x5d3b81)[_0x77c234(0x1e6)](_0x77c234(0x187)),expect(_0x470e2a)[_0x77c234(0x1b0)]['toBe'](_0x2c8866[_0x77c234(0x1a9)]);}),browserName!==_0x2c8866[_0x4b77d4(0x1b4)]&&it(_0x4b77d4(0x209),async()=>{const _0x5a5b44=_0x4b77d4;let _0x4d8ed7;try{const _0x51eb92=_0x2c8866[_0x5a5b44(0x232)][_0x5a5b44(0x1ec)]('|');let _0xe9f814=0x0;while(!![]){switch(_0x51eb92[_0xe9f814++]){case'0':_0x2c8866[_0x5a5b44(0x20b)](expect,await _0x4d8ed7[_0x5a5b44(0x1d4)](_0x2c8866['Eusvf'])['getAttribute']('src'))[_0x5a5b44(0x1f8)]('xss.svg');continue;case'1':_0x4d8ed7=await _0x4f5515(_0x1539ac[_0x5a5b44(0x1c3)],_0x2c8866[_0x5a5b44(0x1de)]);continue;case'2':expect(await _0x4d8ed7[_0x5a5b44(0x1d4)](_0x2c8866[_0x5a5b44(0x23c)])[_0x5a5b44(0x233)]())[_0x5a5b44(0x1e6)](_0x5a5b44(0x20a));continue;case'3':_0x4d8ed7=await _0x4f5515(_0x1539ac[_0x5a5b44(0x1c3)],_0x2c8866[_0x5a5b44(0x18e)]);continue;case'4':await _0x4d8ed7['eval']('document.getElementById(\x22img\x22).scrollIntoView()');continue;case'5':_0x2c8866[_0x5a5b44(0x21b)](expect,await _0x4d8ed7[_0x5a5b44(0x1d4)]('msg')[_0x5a5b44(0x233)]())[_0x5a5b44(0x1e6)](_0x2c8866[_0x5a5b44(0x220)]);continue;}break;}}finally{if(_0x2c8866[_0x5a5b44(0x223)]!==_0x5a5b44(0x1fb)){if(_0x4d8ed7)await _0x4d8ed7[_0x5a5b44(0x222)]();}else{const _0xe7c81f=_0x2f9c97(_0x2417c1(_0x48eadc,_0x453859),_0xfc0305[_0x5a5b44(0x235)]);if(_0xe7c81f['includes'](_0x507754))throw new _0x4dd976(_0x5a5b44(0x21c)+_0x5e97ad+',\x20'+_0x415ebf+'\x0a\x0a'+_0xe7c81f);const _0x58d4ed=_0xfc0305[_0x5a5b44(0x1a0)](_0x2c9fdb,_0x4f4d4a,..._0x2a0a48(0x4)[_0x5a5b44(0x216)]('..'));if(_0xe7c81f[_0x5a5b44(0x1e7)](_0x58d4ed)||_0x31c98a[_0x5a5b44(0x1b6)][_0x5a5b44(0x208)](/win/)&&_0xe7c81f[_0x5a5b44(0x1e7)](_0x58d4ed[_0x5a5b44(0x1cd)](/\\/g,'\x5c\x5c')))throw new _0x594eda(_0x5a5b44(0x191)+_0xa4872d+',\x20'+_0x58d4ed+'\x0a\x0a'+_0xe7c81f);}}})):(_0xfc0305['RIofH'](_0x5a6e90,_0xeeeef7[_0x4b77d4(0x22b)])[_0x4b77d4(0x1e6)](0x194),_0xfc0305['bmqBm'](_0x43763d,_0x255942)[_0x4b77d4(0x1ad)](/This page could not be found/));});};