function _0x5b1e(){var _0x1a8406=['WTmld','function','kmzEy','225586JuuVbp','DcP7csa3hMlvybERqcieLHrRzKBra','vnbVH','eiavS','ruXeq','HZFJr','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback?id=&quot;&gt;&lt;a&gt;\x22><input\x20type=\x22hidden\x22\x20name=\x22client_id\x22\x20value=\x22&quot;&gt;&lt;/a&gt;bxD15c32DJhz9XagFx5gniWLH02IzAKK\x22/><input\x20type=\x22hidden\x22\x20name=\x22scope\x22\x20value=\x22&quot;&gt;&lt;/a&gt;openid\x20email\x20user_metadata\x22/><input\x20type=\x22hidden\x22\x20name=\x22response_mode\x22\x20value=\x22&quot;&gt;&lt;/a&gt;form_post\x22/><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\x22/></form></body></html>','\x22></a>form_post','equal','vNmbf','OfZVi','wtttg','nBWyb','vJZfn','FXPHq','ONRlf','303583gLDpqA','https://client.example.org/callback?id=\x22><a>','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback\x22><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA\x22/></form></body></html>','4032702jTbHgj','AQzkv','text/html;charset=UTF-8','asOLo','WqdaY','YtdIK','JLMva','oQJox','lSLTD','should\x20respond\x20with\x20body','\x22></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw','dtvMy','xEejf','connect','NAMZp','pyhNC','req','use','20EzzUoM','ShXYu','1375hGCVga','441272FSQeWM','state','10EgOaji','MikjL','YpDUa','body','pmeRb','RXKpy','FjhDR','jJGRI','1536216sKlARr','GCmUs','UhQXT','eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA','YubOf','daPQQ','QBdWf','Cache-Control','yjHuw','https://client.example.org/callback','eQRnf','throw','LgYNv','uWXpE','\x22></a>openid\x20email\x20user_metadata','vGAmu','ejQfE','validation','4393120yblTWG','end','FREUw','3aKzFmV','jGrXg','redirectURI','xIJlJ','no-cache,\x20no-store','tVYBC','\x22></a>DcP7csa3hMlvybERqcieLHrRzKBra','Kdrfo','should\x20sanitize\x20html\x20characters\x20within\x20input\x20fields','\x22></a>bxD15c32DJhz9XagFx5gniWLH02IzAKK','131244ZDUDPF','dispatch','OfUbC','oauth2','no-cache','getHeader','xAnAc','48QVUMlX','WUEiX','should\x20throw\x20if\x20no\x20redirect\x20URI','QZDPq','Content-Type','responding\x20to\x20a\x20request','BaLVZ'];_0x5b1e=function(){return _0x1a8406;};return _0x5b1e();}(function(_0x478b77,_0x5a032c){var _0x2a5a53=_0x1786,_0x3a3da4=_0x478b77();while(!![]){try{var _0x29a747=-parseInt(_0x2a5a53(0x1ae))/0x1*(-parseInt(_0x2a5a53(0x1c9))/0x2)+parseInt(_0x2a5a53(0x199))/0x3+-parseInt(_0x2a5a53(0x1f1))/0x4*(-parseInt(_0x2a5a53(0x1f3))/0x5)+-parseInt(_0x2a5a53(0x1bf))/0x6*(parseInt(_0x2a5a53(0x1d9))/0x7)+-parseInt(_0x2a5a53(0x1ab))/0x8+parseInt(_0x2a5a53(0x1dc))/0x9*(-parseInt(_0x2a5a53(0x1ee))/0xa)+-parseInt(_0x2a5a53(0x1f0))/0xb*(-parseInt(_0x2a5a53(0x1b8))/0xc);if(_0x29a747===_0x5a032c)break;else _0x3a3da4['push'](_0x3a3da4['shift']());}catch(_0x31f108){_0x3a3da4['push'](_0x3a3da4['shift']());}}}(_0x5b1e,0x9db4c));function _0x1786(_0x376882,_0x83fcae){var _0x5b1e02=_0x5b1e();return _0x1786=function(_0x178688,_0xcbab9b){_0x178688=_0x178688-0x199;var _0x350ca7=_0x5b1e02[_0x178688];return _0x350ca7;},_0x1786(_0x376882,_0x83fcae);}var chai=require('chai'),fprm=require('..'),AuthorizationError=require('../lib/errors/authorizationerror');describe('oauth2orize-fprm',function(){var _0x2a64b9=_0x1786,_0x23111b={'xAnAc':function(_0x1ce3e7,_0x5d09c5){return _0x1ce3e7(_0x5d09c5);},'GCmUs':_0x2a64b9(0x1c7),'pyhNC':function(_0x4b9e1f,_0xa7d156){return _0x4b9e1f!==_0xa7d156;},'jJGRI':_0x2a64b9(0x1dd),'oQJox':_0x2a64b9(0x19c),'vGAmu':_0x2a64b9(0x1a0),'ruXeq':'Pragma','ejQfE':_0x2a64b9(0x1a2),'kqeDw':_0x2a64b9(0x1ca),'UhQXT':_0x2a64b9(0x1d2),'ShXYu':'PCvxx','tVYBC':function(_0x5d3b3a,_0x5e5e1a,_0x25f9d2){return _0x5d3b3a(_0x5e5e1a,_0x25f9d2);},'vDUWA':'should\x20respond\x20with\x20headers','dtvMy':function(_0x179fae,_0x38a53d,_0x28e09c){return _0x179fae(_0x38a53d,_0x28e09c);},'uWXpE':_0x2a64b9(0x1b2),'tBche':function(_0x377c46,_0x321d13){return _0x377c46===_0x321d13;},'YGkOu':function(_0x45774f){return _0x45774f();},'yjHuw':_0x2a64b9(0x1b6),'HEWVK':_0x2a64b9(0x1db),'FjhDR':_0x2a64b9(0x1c6),'FREUw':_0x2a64b9(0x1c1),'WqdaY':function(_0x1a6ec7,_0x36b5dd,_0x16ec6f){return _0x1a6ec7(_0x36b5dd,_0x16ec6f);},'YtdIK':_0x2a64b9(0x1c4),'LgYNv':_0x2a64b9(0x1aa)};_0x23111b[_0x2a64b9(0x1e0)](it,'should\x20export\x20function',function(){var _0x42beee=_0x2a64b9;_0x23111b[_0x42beee(0x1be)](expect,fprm)['to']['be']['an'](_0x23111b[_0x42beee(0x19a)]);}),describe(_0x23111b[_0x2a64b9(0x1e1)],function(){var _0x53a3e8=_0x2a64b9,_0x2b8dc5={'YubOf':_0x23111b[_0x53a3e8(0x19a)],'MGiPK':_0x23111b[_0x53a3e8(0x1e3)],'vnbVH':function(_0x43a032,_0x119800,_0x2c58c8,_0x39c129){return _0x43a032(_0x119800,_0x2c58c8,_0x39c129);},'RXKpy':_0x53a3e8(0x1d5),'wtttg':function(_0xdf0ed4,_0x3076aa){return _0xdf0ed4(_0x3076aa);},'vUwQc':_0x53a3e8(0x1de),'QtIRt':_0x23111b[_0x53a3e8(0x1a8)],'xIJlJ':function(_0x4ad002,_0x473492){return _0x23111b['xAnAc'](_0x4ad002,_0x473492);},'FXPHq':_0x23111b['ruXeq'],'FrdUF':_0x23111b[_0x53a3e8(0x1a9)],'hzFzc':_0x23111b['kqeDw'],'YpDUa':'\x22></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw'};if(_0x23111b[_0x53a3e8(0x1eb)](_0x23111b[_0x53a3e8(0x19b)],_0x23111b[_0x53a3e8(0x1ef)])){var _0x198d20,_0x26d539;before(function(_0x11ad22){var _0x3cbd18=_0x53a3e8,_0x2a9ae={'Kdrfo':'https://client.example.org/callback'};_0x3cbd18(0x1d5)!==_0x2b8dc5[_0x3cbd18(0x1f8)]?_0x4ca02f(_0x43254e)['to']['be']['an'](_0x2b8dc5[_0x3cbd18(0x19d)]):chai[_0x3cbd18(0x1e9)][_0x3cbd18(0x1ed)](function(_0x4060de,_0x2e27df){var _0x24099d=_0x3cbd18,_0x5ac7ec={'state':_0x4060de[_0x24099d(0x1bb)][_0x24099d(0x1ec)][_0x24099d(0x1f2)],'id_token':_0x2b8dc5['MGiPK']};_0x2b8dc5[_0x24099d(0x1cb)](fprm,_0x4060de[_0x24099d(0x1bb)],_0x2e27df,_0x5ac7ec);})[_0x3cbd18(0x1ec)](function(_0x5d2fb2){var _0x322673=_0x3cbd18;_0x5d2fb2['oauth2']={},_0x5d2fb2[_0x322673(0x1bb)][_0x322673(0x1b0)]=_0x2a9ae[_0x322673(0x1b5)],_0x5d2fb2[_0x322673(0x1bb)][_0x322673(0x1ec)]={'state':_0x322673(0x1ca)};})['end'](function(_0x1cf4bb){_0x198d20=_0x1cf4bb,_0x11ad22();})[_0x3cbd18(0x1b9)]();}),_0x23111b[_0x53a3e8(0x1b3)](it,_0x23111b['vDUWA'],function(){var _0xbc40fd=_0x53a3e8;_0x2b8dc5[_0xbc40fd(0x1d4)](expect,_0x198d20[_0xbc40fd(0x1bd)](_0xbc40fd(0x1c3)))['to']['equal'](_0x2b8dc5['vUwQc']),expect(_0x198d20[_0xbc40fd(0x1bd)](_0x2b8dc5['QtIRt']))['to'][_0xbc40fd(0x1d1)](_0xbc40fd(0x1b2)),_0x2b8dc5[_0xbc40fd(0x1b1)](expect,_0x198d20[_0xbc40fd(0x1bd)](_0x2b8dc5[_0xbc40fd(0x1d7)]))['to'][_0xbc40fd(0x1d1)](_0xbc40fd(0x1bc));}),_0x23111b['dtvMy'](it,_0x53a3e8(0x1e5),function(){var _0x169468=_0x53a3e8;_0x23111b[_0x169468(0x1eb)](_0x23111b[_0x169468(0x1fa)],_0x169468(0x1ce))?expect(_0x198d20[_0x169468(0x1f6)])['to'][_0x169468(0x1d1)]('<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback\x22><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA\x22/></form></body></html>'):(_0x2a0289[_0x169468(0x1bb)]={},_0xd69efc[_0x169468(0x1bb)][_0x169468(0x1b0)]=_0x2b8dc5['FrdUF'],_0x78a405[_0x169468(0x1bb)][_0x169468(0x1ec)]={'state':_0x2b8dc5['hzFzc']});});}else{var _0x538a15={'QZDPq':_0x53a3e8(0x1b7),'eiavS':_0x2b8dc5[_0x53a3e8(0x1f5)],'MikjL':function(_0x8af427,_0x443ad6,_0x5362f3,_0x1eaa4f){return _0x8af427(_0x443ad6,_0x5362f3,_0x1eaa4f);}};_0x17a9f0[_0x53a3e8(0x1e9)][_0x53a3e8(0x1ed)](function(_0x5ccc38,_0x5ae80d){var _0x5546b4=_0x53a3e8,_0x584a67={'client_id':_0x538a15[_0x5546b4(0x1c2)],'scope':_0x5546b4(0x1a7),'response_mode':_0x5546b4(0x1d0),'state':_0x5ccc38[_0x5546b4(0x1bb)][_0x5546b4(0x1ec)][_0x5546b4(0x1f2)],'id_token':_0x538a15[_0x5546b4(0x1cc)]};_0x538a15[_0x5546b4(0x1f4)](_0x25e854,_0x5ccc38['oauth2'],_0x5ae80d,_0x584a67);})[_0x53a3e8(0x1ec)](function(_0x1fa0df){var _0x135bbf=_0x53a3e8;_0x1fa0df[_0x135bbf(0x1bb)]={},_0x1fa0df[_0x135bbf(0x1bb)]['redirectURI']=_0x135bbf(0x1da),_0x1fa0df['oauth2'][_0x135bbf(0x1ec)]={'state':_0x135bbf(0x1b4)};})['end'](function(_0x42fdf4){_0x2d61ea=_0x42fdf4,_0x454f51();})[_0x53a3e8(0x1b9)]();}}),describe('responding\x20to\x20a\x20malformed\x20request',function(){var _0x5bc1d5=_0x2a64b9,_0x3747cc={'UAgbv':_0x5bc1d5(0x1da),'JLMva':_0x23111b[_0x5bc1d5(0x1a6)],'kmzEy':_0x23111b[_0x5bc1d5(0x1cd)],'asOLo':_0x5bc1d5(0x1bc),'MdnQI':function(_0x1a3b7,_0x180b2a){return _0x23111b['tBche'](_0x1a3b7,_0x180b2a);},'wiEju':'YdSJY','vJZfn':function(_0x217bde){return _0x23111b['YGkOu'](_0x217bde);}},_0x3b5986,_0x4a5e5c;before(function(_0xa29b26){var _0x4a3c7c=_0x5bc1d5,_0x199754={'daPQQ':'\x22></a>form_post','BaLVZ':function(_0x2afe20,_0x944a84,_0x2b0908,_0x1b889d){return _0x2afe20(_0x944a84,_0x2b0908,_0x1b889d);},'ONRlf':_0x4a3c7c(0x1c3),'WUEiX':_0x4a3c7c(0x1de),'njldf':_0x3747cc[_0x4a3c7c(0x1e2)],'OfZVi':function(_0x421a06,_0x3b9c5c){return _0x421a06(_0x3b9c5c);},'xEejf':_0x3747cc[_0x4a3c7c(0x1c8)],'izpaS':_0x3747cc[_0x4a3c7c(0x1df)],'OfUbC':function(_0x2689ff,_0x553307){return _0x3747cc['MdnQI'](_0x2689ff,_0x553307);},'jGrXg':_0x3747cc['wiEju'],'eQRnf':function(_0x49d84e){var _0x491256=_0x4a3c7c;return _0x3747cc[_0x491256(0x1d6)](_0x49d84e);}};chai['connect'][_0x4a3c7c(0x1ed)](function(_0x614244,_0x2893f3){var _0x5ab438=_0x4a3c7c,_0x1d6e06={'client_id':_0x5ab438(0x1b7),'scope':_0x5ab438(0x1a7),'response_mode':_0x199754[_0x5ab438(0x19e)],'state':_0x614244['oauth2'][_0x5ab438(0x1ec)][_0x5ab438(0x1f2)],'id_token':_0x5ab438(0x1e6)};_0x199754[_0x5ab438(0x1c5)](fprm,_0x614244['oauth2'],_0x2893f3,_0x1d6e06);})[_0x4a3c7c(0x1ec)](function(_0x48de0b){var _0x4fb175=_0x4a3c7c;_0x48de0b[_0x4fb175(0x1bb)]={},_0x48de0b[_0x4fb175(0x1bb)][_0x4fb175(0x1b0)]=_0x3747cc['UAgbv'],_0x48de0b[_0x4fb175(0x1bb)][_0x4fb175(0x1ec)]={'state':_0x4fb175(0x1b4)};})[_0x4a3c7c(0x1ac)](function(_0x2929e8){var _0x4ffb54=_0x4a3c7c;_0x199754[_0x4ffb54(0x1ba)](_0x199754[_0x4ffb54(0x1af)],'owAMR')?(_0x1d5b88(_0x2b3ba1[_0x4ffb54(0x1bd)](_0x199754[_0x4ffb54(0x1d8)]))['to'][_0x4ffb54(0x1d1)](_0x199754[_0x4ffb54(0x1c0)]),_0x104282(_0x314b6f[_0x4ffb54(0x1bd)](_0x4ffb54(0x1a0)))['to'][_0x4ffb54(0x1d1)](_0x199754['njldf']),_0x199754[_0x4ffb54(0x1d3)](_0x291615,_0x43ef9b[_0x4ffb54(0x1bd)](_0x199754[_0x4ffb54(0x1e8)]))['to']['equal'](_0x199754['izpaS'])):(_0x3b5986=_0x2929e8,_0x199754[_0x4ffb54(0x1a3)](_0xa29b26));})[_0x4a3c7c(0x1b9)]();}),it(_0x23111b[_0x5bc1d5(0x1a1)],function(){var _0x2e6b19=_0x5bc1d5;expect(_0x3b5986[_0x2e6b19(0x1f6)])['to'][_0x2e6b19(0x1d1)](_0x2e6b19(0x1cf));});}),describe(_0x23111b[_0x2a64b9(0x1a5)],function(){var _0x34ff85=_0x2a64b9,_0x4c8e51={'QBdWf':_0x23111b['HEWVK'],'pmeRb':_0x23111b['ejQfE'],'SBOWZ':function(_0x4f164b){return _0x4f164b();},'lSLTD':function(_0x7f4d4d,_0x238ca4){var _0x4b1395=_0x1786;return _0x23111b[_0x4b1395(0x1be)](_0x7f4d4d,_0x238ca4);}};_0x23111b[_0x34ff85(0x1f9)]===_0x34ff85(0x1ea)?_0x201d8b(_0x888747[_0x34ff85(0x1f6)])['to'][_0x34ff85(0x1d1)](_0x4c8e51[_0x34ff85(0x19f)]):(it('should\x20not\x20throw\x20if\x20no\x20redirect\x20URI',function(){expect(function(){var _0x41a5b7=_0x1786;fprm['validate']({'redirectURI':_0x4c8e51[_0x41a5b7(0x1f7)]});})['to']['not']['throw']();}),_0x23111b[_0x34ff85(0x1e7)](it,_0x23111b[_0x34ff85(0x1ad)],function(){var _0x3e06d7=_0x34ff85;'uXQzn'!=='uXQzn'?(_0x5ec1cb=_0x31b1f0,_0x4c8e51['SBOWZ'](_0x5ef6a9)):_0x4c8e51[_0x3e06d7(0x1e4)](expect,function(){fprm['validate']({});})['to'][_0x3e06d7(0x1a4)](AuthorizationError,'Unable\x20to\x20issue\x20redirect\x20for\x20OAuth\x202.0\x20transaction');}));});});