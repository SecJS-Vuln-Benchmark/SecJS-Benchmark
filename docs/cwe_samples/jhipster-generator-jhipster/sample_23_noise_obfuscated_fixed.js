function _0x1eef(_0x4ff0a2,_0x351012){var _0xc84df6=_0xc84d();return _0x1eef=function(_0x1eef10,_0x35b546){_0x1eef10=_0x1eef10-0x17f;var _0x3e775e=_0xc84df6[_0x1eef10];return _0x3e775e;},_0x1eef(_0x4ff0a2,_0x351012);}var _0x4bb564=_0x1eef;function _0xc84d(){var _0x5a38fd=['push','yVwiV','PUMit','http://localhost:1666/nofile.md','weaHl','start','test','klwYm','ZqdaF','join','howdy!','zeacA','GZUqT','doesNotThrow','Socket','/file.txt','WRjtY','754175doDFzg','PUT','LdWHT','connect','headers','IWFej','hideindex','mPMRR','kIpZi','cjztE','equals','ktoqo','text/html','data','SvIaX','bsoMC','http://localhost:1666/.test/whatever.txt','HTTP/1.1\x20403\x20Forbidden','DELETE','serves\x20index\x20page','fails\x20if\x20path\x20traversal\x20with\x20conveniently-named\x20directory\x20is\x20attempted','pUCBS','WkeDS','doesnt\x20explode\x20immediately','bind','http://localhost:1666/','faPUV','strictEqual','OkWsC','tape','HtFQE','gceYB','get','toString','http://localhost:1666/file%20with%20space.html','hey,\x20now!','OSmnn','raw\x20image\x20tag\x20is\x20not\x20on\x20page','statusCode','XctxB','end','1127472UxgTwl','CwDtZ','zTlQk','trim','http://localhost:1666/file.txt','split','content-type','MrBVI','plan','405s\x20on\x20everything\x20but\x20GET','PXKuC','ItfpW','CvsNG','XlPwB','shuts\x20down\x20without\x20exploding','gxqgw','wee\x0a','457672qjmaPj','455656OcCtBj','WqyAJ','GET\x20/../glance-test-exploit/secret.txt\x20HTTP/1.1\x0aHost:\x20localhost\x0auser-agent:\x20test/1.2.3\x0aaccept:\x20*/*\x0a\x0a','GET\x20/../index.js\x20HTTP/1.1\x0aHost:\x20localhost\x0auser-agent:\x20test/1.2.3\x0aaccept:\x20*/*\x0a\x0a','net','rnFrQ','zmpTC','1443726LSVNju','stop','notOk','49914XWLEhB','forEach','sqqeb','localhost','RlVAx','request','serves\x20files\x20from\x20within\x20dot\x20dirs\x20by\x20default','BnBQx','http://localhost:1666/test1/','SwkqQ','name\x20is\x20replaced\x20with\x20html\x20escape','HlrpZ','serves\x20plaintext\x20with\x20headers','10073140pznwKZ','http://localhost:1666/test1/.test2/lol.txt','text/plain','cjcfM','write','../','./test/glance-test','deals\x20with\x20uri\x20encoding','fzNpw','link\x20is\x20replaced\x20with\x20uriEncode'];_0xc84d=function(){return _0x5a38fd;};return _0xc84d();}(function(_0x2db638,_0x1a0954){var _0x26a4a1=_0x1eef,_0x327c58=_0x2db638();while(!![]){try{var _0xf1a82f=-parseInt(_0x26a4a1(0x19f))/0x1+-parseInt(_0x26a4a1(0x1a9))/0x2+-parseInt(_0x26a4a1(0x1a6))/0x3+parseInt(_0x26a4a1(0x19e))/0x4+-parseInt(_0x26a4a1(0x1d1))/0x5+-parseInt(_0x26a4a1(0x18d))/0x6+parseInt(_0x26a4a1(0x1b6))/0x7;if(_0xf1a82f===_0x1a0954)break;else _0x327c58['push'](_0x327c58['shift']());}catch(_0x530db5){_0x327c58['push'](_0x327c58['shift']());}}}(_0xc84d,0x3dba4));var http=require('http'),net=require(_0x4bb564(0x1a3)),test=require(_0x4bb564(0x181)),glance=require(_0x4bb564(0x1bb)),glanceServer=glance({'port':0x682,'dir':_0x4bb564(0x1bc)});test(_0x4bb564(0x1e8),function(_0xf868a1){var _0x2e4566=_0x4bb564;_0xf868a1[_0x2e4566(0x195)](0x1),_0xf868a1['doesNotThrow'](function(){var _0x4d0f76=_0x2e4566;glanceServer[_0x4d0f76(0x1c5)]();});}),test(_0x4bb564(0x1b5),function(_0x47d135){var _0x42637e=_0x4bb564,_0x31acf8={'zmpTC':'hey,\x20now!','SwkqQ':_0x42637e(0x193),'klwYm':_0x42637e(0x1dd),'XlPwB':_0x42637e(0x1d6),'mPMRR':'BAfza','MrBVI':_0x42637e(0x1ca),'RlVAx':_0x42637e(0x1b4),'kIpZi':_0x42637e(0x1b8),'SvIaX':'data','DKAhq':_0x42637e(0x18c),'pUCBS':_0x42637e(0x191)};http[_0x42637e(0x184)](_0x31acf8[_0x42637e(0x1e6)],function(_0x43e9da){var _0x4e2afb=_0x42637e,_0x278e44={'RTvro':_0x4e2afb(0x19d)};if(_0x31acf8[_0x4e2afb(0x1ad)]===_0x31acf8[_0x4e2afb(0x1ad)]){_0x47d135[_0x4e2afb(0x195)](0x3);var _0x1c4178='';_0x47d135['strictEqual'](_0x43e9da['statusCode'],0xc8),_0x47d135[_0x4e2afb(0x17f)](_0x43e9da[_0x4e2afb(0x1d5)][_0x31acf8[_0x4e2afb(0x1b2)]],_0x31acf8[_0x4e2afb(0x1d9)]),_0x43e9da['on'](_0x31acf8[_0x4e2afb(0x1df)],function(_0x55f5bd){_0x1c4178+=_0x55f5bd;}),_0x43e9da['on'](_0x31acf8['DKAhq'],function(){var _0x318a1e=_0x4e2afb,_0x48af95={'ItfpW':_0x31acf8[_0x318a1e(0x1a5)],'DswqJ':_0x31acf8[_0x318a1e(0x1b2)],'SolcG':_0x31acf8[_0x318a1e(0x1c7)],'CvsNG':'end'};_0x31acf8[_0x318a1e(0x19a)]!==_0x31acf8[_0x318a1e(0x1d8)]?_0x47d135[_0x318a1e(0x17f)](_0x1c4178,_0x31acf8[_0x318a1e(0x194)]):_0x56aa6a[_0x318a1e(0x184)](_0x318a1e(0x186),function(_0x446563){var _0x152da4=_0x318a1e,_0x43ee13={'gxqgw':_0x48af95[_0x152da4(0x198)]};_0xcfd2b3[_0x152da4(0x195)](0x3);var _0x5dd91e='';_0x2d08de[_0x152da4(0x17f)](_0x446563[_0x152da4(0x18a)],0xc8),_0x1c0d1f[_0x152da4(0x17f)](_0x446563[_0x152da4(0x1d5)][_0x48af95['DswqJ']],_0x48af95['SolcG']),_0x446563['on'](_0x152da4(0x1de),function(_0x177079){_0x5dd91e+=_0x177079;}),_0x446563['on'](_0x48af95[_0x152da4(0x199)],function(){var _0xd23848=_0x152da4;_0xbcfa6b[_0xd23848(0x17f)](_0x5dd91e,_0x43ee13[_0xd23848(0x19c)]);});});});}else _0x30260c[_0x4e2afb(0x17f)](_0x2cb4ee[_0x4e2afb(0x1c9)](''),_0x278e44['RTvro']);});}),test(_0x4bb564(0x1bd),function(_0x45203c){var _0x54280f=_0x4bb564,_0xcde553={'WkeDS':_0x54280f(0x186)};http['get'](_0xcde553[_0x54280f(0x1e7)],function(_0x42d911){var _0x14413a=_0x54280f,_0x203072='2|0|5|3|4|1'[_0x14413a(0x192)]('|'),_0x1013c9=0x0;while(!![]){switch(_0x203072[_0x1013c9++]){case'0':var _0x3c805a='';continue;case'1':_0x42d911['on'](_0x14413a(0x18c),function(){var _0x2bda85=_0x14413a;_0x45203c[_0x2bda85(0x17f)](_0x3c805a,_0x2bda85(0x187));});continue;case'2':_0x45203c['plan'](0x3);continue;case'3':_0x45203c[_0x14413a(0x17f)](_0x42d911[_0x14413a(0x1d5)][_0x14413a(0x193)],'text/html');continue;case'4':_0x42d911['on'](_0x14413a(0x1de),function(_0x2e6777){_0x3c805a+=_0x2e6777;});continue;case'5':_0x45203c[_0x14413a(0x17f)](_0x42d911[_0x14413a(0x18a)],0xc8);continue;}break;}});}),test('404s\x20on\x20file\x20not\x20found',function(_0x25609b){var _0x41674f=_0x4bb564;_0x25609b[_0x41674f(0x195)](0x1),http['get'](_0x41674f(0x1c3),function(_0x34eab9){_0x25609b['strictEqual'](_0x34eab9['statusCode'],0x194);});}),test('403s\x20on\x20dir\x20list\x20if\x20configured',function(_0x2aca89){var _0x3ff4de=_0x4bb564;_0x2aca89[_0x3ff4de(0x195)](0x1),glanceServer['hideindex']=!![],http[_0x3ff4de(0x184)]('http://localhost:1666/',function(_0x3b3571){var _0x279f19=_0x3ff4de;glanceServer[_0x279f19(0x1d7)]=![],_0x2aca89[_0x279f19(0x17f)](_0x3b3571[_0x279f19(0x18a)],0x193);});}),test('fails\x20if\x20path\x20traversal\x20is\x20attempted',function(_0xcdd7dc){var _0x3992a0=_0x4bb564,_0x685f9a={'HtFQE':_0x3992a0(0x1e2)};_0xcdd7dc[_0x3992a0(0x195)](0x1);var _0x41edcd=new net[(_0x3992a0(0x1ce))]();_0x41edcd['connect'](0x682,_0x3992a0(0x1ac),function(){var _0x3b333a=_0x3992a0;_0x41edcd['on'](_0x3b333a(0x1de),function(_0x1c8426){var _0x5f1ef4=_0x3b333a,_0xeed25c=_0x1c8426['toString']()[_0x5f1ef4(0x192)]('\x0a')[0x0];_0xcdd7dc[_0x5f1ef4(0x1db)](_0xeed25c[_0x5f1ef4(0x190)](),_0x685f9a[_0x5f1ef4(0x182)]),_0x41edcd['end']();}),_0x41edcd['write'](_0x3b333a(0x1a2));});}),test(_0x4bb564(0x1e5),function(_0x53245e){var _0x65e12f=_0x4bb564,_0x24eb5d={'bsoMC':function(_0x4fd240,_0x5d1e5f){return _0x4fd240!==_0x5d1e5f;},'weaHl':_0x65e12f(0x197),'OSmnn':_0x65e12f(0x1de)};_0x53245e[_0x65e12f(0x195)](0x1);var _0x4721e8=new net[(_0x65e12f(0x1ce))]();_0x4721e8[_0x65e12f(0x1d4)](0x682,_0x65e12f(0x1ac),function(){var _0x1268fa=_0x65e12f;_0x4721e8['on'](_0x24eb5d[_0x1268fa(0x188)],function(_0x6cd72){var _0x2d6975=_0x1268fa;if(_0x24eb5d[_0x2d6975(0x1e0)](_0x2d6975(0x1dc),_0x24eb5d[_0x2d6975(0x1c4)])){var _0x788980=_0x6cd72[_0x2d6975(0x185)]()[_0x2d6975(0x192)]('\x0a')[0x0];_0x53245e[_0x2d6975(0x1db)](_0x788980[_0x2d6975(0x190)](),'HTTP/1.1\x20403\x20Forbidden'),_0x4721e8[_0x2d6975(0x18c)]();}else _0x4d9f91[_0x2d6975(0x195)](0x1),_0x3c3cf4[_0x2d6975(0x1d7)]=!![],_0x1e8460[_0x2d6975(0x184)](_0x2d6975(0x1ea),function(_0x3864b8){var _0x3607f7=_0x2d6975;_0x45497b[_0x3607f7(0x1d7)]=![],_0x14942a[_0x3607f7(0x17f)](_0x3864b8['statusCode'],0x193);});}),_0x4721e8[_0x1268fa(0x1ba)]('GET\x20/../glance-test-exploit/secret.txt\x20HTTP/1.1\x0aHost:\x20localhost\x0auser-agent:\x20test/1.2.3\x0aaccept:\x20*/*\x0a\x0a');});}),test(_0x4bb564(0x1e4),function(_0x2a7b58){var _0x354bee=_0x4bb564,_0x52537b={'zeacA':function(_0x481ad0,_0x4f7490){return _0x481ad0===_0x4f7490;},'xbBCd':_0x354bee(0x19d),'zTlQk':_0x354bee(0x1a0),'vwnRE':'XnePr','XctxB':_0x354bee(0x1de)};_0x2a7b58[_0x354bee(0x195)](0x2);var _0x3630bf=[];http[_0x354bee(0x184)](_0x354bee(0x1ea),function(_0x4efedb){var _0x1d3b86=_0x354bee,_0x27625d={'WRjtY':_0x1d3b86(0x1b3)};if(_0x52537b[_0x1d3b86(0x18f)]!==_0x52537b['vwnRE'])_0x2a7b58[_0x1d3b86(0x17f)](_0x4efedb[_0x1d3b86(0x18a)],0xc8),_0x4efedb['on'](_0x52537b[_0x1d3b86(0x18b)],_0x3630bf[_0x1d3b86(0x1c0)][_0x1d3b86(0x1e9)](_0x3630bf)),_0x4efedb['on'](_0x1d3b86(0x18c),function(){var _0x25d1d1=_0x1d3b86;_0x52537b[_0x25d1d1(0x1cb)](_0x25d1d1(0x1ab),'sqqeb')?_0x2a7b58[_0x25d1d1(0x17f)](_0x3630bf[_0x25d1d1(0x1c9)](''),_0x52537b['xbBCd']):_0x130053+=_0x2eafa5;});else{var _0x52221e=_0x138012[_0x1d3b86(0x1c9)]('');_0xfe0f4d['notOk'](/\<img/[_0x1d3b86(0x1c6)](_0x52221e),_0x1d3b86(0x189)),_0x2b23cd['ok'](/\&lt;img/[_0x1d3b86(0x1c6)](_0x52221e),_0x27625d[_0x1d3b86(0x1d0)]),_0x52282b['ok'](/\%3Cimg/[_0x1d3b86(0x1c6)](_0x52221e),_0x1d3b86(0x1bf));}});}),test(_0x4bb564(0x196),function(_0x32e299){var _0x2da303=_0x4bb564,_0xc71ca1={'ZqdaF':_0x2da303(0x1ac),'OkWsC':_0x2da303(0x1e3),'faPUV':_0x2da303(0x1d2)};_0x32e299[_0x2da303(0x195)](0x3);var _0x249e88=['POST',_0xc71ca1[_0x2da303(0x180)],_0xc71ca1[_0x2da303(0x1eb)]];_0x249e88[_0x2da303(0x1aa)](function(_0x161244){var _0x369ab8=_0x2da303,_0x5c0955={'host':_0xc71ca1[_0x369ab8(0x1c8)],'port':0x682,'path':_0x369ab8(0x1cf),'method':_0x161244},_0x1c0f57=http[_0x369ab8(0x1ae)](_0x5c0955,_0x4ed952);_0x1c0f57[_0x369ab8(0x18c)]();});function _0x4ed952(_0x169389){var _0xc5b8ce=_0x2da303;_0x32e299[_0xc5b8ce(0x17f)](_0x169389['statusCode'],0x195);}}),test(_0x4bb564(0x1af),function(_0x513a81){var _0x4b2fe2=_0x4bb564,_0x18dbf5={'eNTee':_0x4b2fe2(0x18c),'iVugB':function(_0x58bd63,_0x4a2905){return _0x58bd63!==_0x4a2905;},'gceYB':_0x4b2fe2(0x1cc)};_0x513a81['plan'](0x2),http[_0x4b2fe2(0x184)](_0x4b2fe2(0x1e1),function(_0xd16584){_0x513a81['strictEqual'](_0xd16584['statusCode'],0xc8);}),http[_0x4b2fe2(0x184)](_0x4b2fe2(0x1b7),function(_0x4e8622){var _0x554b57=_0x4b2fe2,_0x345343={'PUMit':_0x18dbf5['eNTee']};_0x18dbf5['iVugB'](_0x18dbf5[_0x554b57(0x183)],_0x554b57(0x1cc))?_0x45fb76['get']('http://localhost:1666/file.txt',function(_0x1fcc8d){var _0x44e624=_0x554b57,_0x2d77b2={'cjcfM':_0x44e624(0x1ca)};_0x276b09[_0x44e624(0x195)](0x3);var _0x449ba1='';_0x4f5368[_0x44e624(0x17f)](_0x1fcc8d['statusCode'],0xc8),_0x4d1063[_0x44e624(0x17f)](_0x1fcc8d[_0x44e624(0x1d5)][_0x44e624(0x193)],_0x44e624(0x1b8)),_0x1fcc8d['on']('data',function(_0x3d9086){_0x449ba1+=_0x3d9086;}),_0x1fcc8d['on'](_0x345343[_0x44e624(0x1c2)],function(){var _0x4cac9a=_0x44e624;_0x566372['strictEqual'](_0x449ba1,_0x2d77b2[_0x4cac9a(0x1b9)]);});}):_0x513a81[_0x554b57(0x17f)](_0x4e8622[_0x554b57(0x18a)],0xc8);});}),test('sanitizes\x20filenames',function(_0x234687){var _0x57f291=_0x4bb564,_0x5420b8={'xTEdU':_0x57f291(0x18c)};_0x234687[_0x57f291(0x195)](0x3);var _0x1b111f=[];http['get'](_0x57f291(0x1b1),function(_0x1fb139){var _0x380f3b=_0x57f291,_0xcce95c={'yEhSw':_0x380f3b(0x1b3),'cjztE':_0x380f3b(0x1bf)};_0x380f3b(0x18e)===_0x380f3b(0x1c1)?(_0x4f5a54['on'](_0x380f3b(0x1de),function(_0x171bf4){var _0x201705=_0x380f3b;_0x14c387[_0x201705(0x1c0)](_0x171bf4);}),_0x100e8e['on'](_0x5420b8['xTEdU'],function(){var _0x269d4f=_0x380f3b,_0x3b6946=_0x39ba02[_0x269d4f(0x1c9)]('');_0x204503[_0x269d4f(0x1a8)](/\<img/[_0x269d4f(0x1c6)](_0x3b6946),_0x269d4f(0x189)),_0x138290['ok'](/\&lt;img/[_0x269d4f(0x1c6)](_0x3b6946),_0x269d4f(0x1b3)),_0x454d1f['ok'](/\%3Cimg/[_0x269d4f(0x1c6)](_0x3b6946),_0x269d4f(0x1bf));})):(_0x1fb139['on']('data',function(_0x328069){var _0x17a5ab=_0x380f3b;_0x1b111f[_0x17a5ab(0x1c0)](_0x328069);}),_0x1fb139['on'](_0x380f3b(0x18c),function(){var _0x5d0ff0=_0x380f3b,_0x2a9573=_0x1b111f[_0x5d0ff0(0x1c9)]('');_0x234687[_0x5d0ff0(0x1a8)](/\<img/['test'](_0x2a9573),_0x5d0ff0(0x189)),_0x234687['ok'](/\&lt;img/['test'](_0x2a9573),_0xcce95c['yEhSw']),_0x234687['ok'](/\%3Cimg/[_0x5d0ff0(0x1c6)](_0x2a9573),_0xcce95c[_0x5d0ff0(0x1da)]);}));});}),test(_0x4bb564(0x19b),function(_0x192ef0){var _0x1c89b4=_0x4bb564,_0x5330cb={'LdWHT':function(_0x52374e,_0x442a53){return _0x52374e===_0x442a53;},'fzNpw':_0x1c89b4(0x1a4)};_0x192ef0[_0x1c89b4(0x195)](0x1),_0x192ef0[_0x1c89b4(0x1cd)](function(){var _0x3b09b=_0x1c89b4;if(_0x5330cb[_0x3b09b(0x1d3)](_0x3b09b(0x1b0),_0x5330cb[_0x3b09b(0x1be)])){_0xfb67c2[_0x3b09b(0x195)](0x1);var _0x4b89a1=new _0x355253[(_0x3b09b(0x1ce))]();_0x4b89a1[_0x3b09b(0x1d4)](0x682,_0x3b09b(0x1ac),function(){var _0x205e4f=_0x3b09b;_0x4b89a1['on']('data',function(_0x1b6791){var _0x440c40=_0x1eef,_0x28af1f=_0x1b6791[_0x440c40(0x185)]()[_0x440c40(0x192)]('\x0a')[0x0];_0x4eb5b7[_0x440c40(0x1db)](_0x28af1f['trim'](),_0x440c40(0x1e2)),_0x4b89a1[_0x440c40(0x18c)]();}),_0x4b89a1[_0x205e4f(0x1ba)](_0x205e4f(0x1a1));});}else glanceServer[_0x3b09b(0x1a7)]();});});