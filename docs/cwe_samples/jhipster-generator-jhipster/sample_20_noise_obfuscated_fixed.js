var _0xdb6325=_0x52ae;(function(_0x40f5c3,_0x526200){var _0x45ef13=_0x52ae,_0x3c197a=_0x40f5c3();while(!![]){try{var _0x5c3fb2=-parseInt(_0x45ef13(0x153))/0x1*(-parseInt(_0x45ef13(0x152))/0x2)+parseInt(_0x45ef13(0x10e))/0x3*(-parseInt(_0x45ef13(0x15b))/0x4)+parseInt(_0x45ef13(0x15a))/0x5*(-parseInt(_0x45ef13(0x11b))/0x6)+-parseInt(_0x45ef13(0x12e))/0x7+-parseInt(_0x45ef13(0x11f))/0x8+parseInt(_0x45ef13(0x108))/0x9*(-parseInt(_0x45ef13(0x13c))/0xa)+parseInt(_0x45ef13(0x116))/0xb;if(_0x5c3fb2===_0x526200)break;else _0x3c197a['push'](_0x3c197a['shift']());}catch(_0x3ba4a1){_0x3c197a['push'](_0x3c197a['shift']());}}}(_0x52e4,0xd4640));function _0x52e4(){var _0x511144=['679419hvFeuO','Content-Type','validate','equal','ArSat','should\x20not\x20throw\x20if\x20no\x20redirect\x20URI','3HXUzpt','klFOZ','LjriY','\x22></a>DcP7csa3hMlvybERqcieLHrRzKBra','\x22></a>eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw','fownM','dzndN','KtnUH','40219366WZwBvW','use','dispatch','chai','no-cache,\x20no-store','7582506HADsUs','end','VwMWl','vjXSp','9994632qJQgHf','HJqpX','Cache-Control','cdrMV','iwgtl','\x22></a>bxD15c32DJhz9XagFx5gniWLH02IzAKK','CJFKm','ACXyn','connect','body','responding\x20to\x20a\x20malformed\x20request','../lib/errors/authorizationerror','Pragma','LVbJj','kPsZo','3355079rDczGc','bNDfl','mvvJG','https://client.example.org/callback','lAbuf','text/html;charset=UTF-8','should\x20export\x20function','Unable\x20to\x20issue\x20redirect\x20for\x20OAuth\x202.0\x20transaction','JUcrU','should\x20respond\x20with\x20headers','should\x20respond\x20with\x20body','req','AsKRl','sYoqf','140WzNuFN','Nagjz','\x22></a>form_post','throw','redirectURI','eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA','\x22></a>openid\x20email\x20user_metadata','https://client.example.org/callback?id=\x22><a>','CXAir','xxcor','TSWuM','XYMfh','oauth2','responding\x20to\x20a\x20request','YdhdB','WAXRO','yAVAR','RoetO','should\x20throw\x20if\x20no\x20redirect\x20URI','<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback\x22><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiwiYXVkIjoiZmZzMiIsImp0aSI6ImhwQUI3RDBNbEo0c2YzVFR2cllxUkIiLCJpc3MiOiJodHRwczpcL1wvbG9jYWxob3N0OjkwMzEiLCJpYXQiOjEzNjM5MDMxMTMsImV4cCI6MTM2MzkwMzcxMywibm9uY2UiOiIyVDFBZ2FlUlRHVE1BSnllRE1OOUlKYmdpVUciLCJhY3IiOiJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZCIsImF1dGhfdGltZSI6MTM2MzkwMDg5NH0.c9emvFayy-YJnO0kxUNQqeAoYu7sjlyulRSNrru1ySZs2qwqqwwq-Qk7LFd3iGYeUWrfjZkmyXeKKs_OtZ2tI2QQqJpcfrpAuiNuEHII-_fkIufbGNT_rfHUcY3tGGKxcvZO9uvgKgX9Vs1v04UaCOUfxRjSVlumE6fWGcqXVEKhtPadj1elk3r4zkoNt9vjUQt9NGdm1OvaZ2ONprCErBbXf1eJb4NW_hnrQ5IKXuNsQ1g9ccT5DMtZSwgDFwsHMDWMPFGax5Lw6ogjwJ4AQDrhzNCFc0uVAwBBb772-86HpAkGWAKOK-wTC6ErRTcESRdNRe0iKb47XRXaoz5acA\x22/></form></body></html>','DcP7csa3hMlvybERqcieLHrRzKBra','getHeader','10CpObOK','324980xkZdtj','kgAnc','no-cache','GVvNk','validation','UcZko','yMGSd','5RCHWiS','1448012wFLDCv'];_0x52e4=function(){return _0x511144;};return _0x52e4();}var chai=require(_0xdb6325(0x119)),fprm=require('..'),AuthorizationError=require(_0xdb6325(0x12a));function _0x52ae(_0x5a1fbb,_0x157105){var _0x52e476=_0x52e4();return _0x52ae=function(_0x52aedf,_0x73e066){_0x52aedf=_0x52aedf-0x108;var _0x21ffa1=_0x52e476[_0x52aedf];return _0x21ffa1;},_0x52ae(_0x5a1fbb,_0x157105);}describe('oauth2orize-fprm',function(){var _0x1771cd=_0xdb6325,_0x29187b={'fownM':function(_0x578acd,_0x4345bc){return _0x578acd(_0x4345bc);},'CXAir':_0x1771cd(0x131),'UcZko':function(_0x172fb5,_0x400484){return _0x172fb5!==_0x400484;},'RoetO':'kPsZo','cdrMV':function(_0x502e24){return _0x502e24();},'fUQpN':_0x1771cd(0x141),'Nagjz':_0x1771cd(0x109),'gShNF':_0x1771cd(0x133),'ACXyn':function(_0x5e9f80,_0x504bf8){return _0x5e9f80(_0x504bf8);},'RyzAb':_0x1771cd(0x121),'TSWuM':_0x1771cd(0x11a),'XYMfh':_0x1771cd(0x13e),'LVbJj':'<html><head><title>Submit\x20This\x20Form</title></head><body\x20onload=\x22javascript:document.forms[0].submit()\x22><form\x20method=\x22post\x22\x20action=\x22https://client.example.org/callback?id=&quot;&gt;&lt;a&gt;\x22><input\x20type=\x22hidden\x22\x20name=\x22client_id\x22\x20value=\x22&quot;&gt;&lt;/a&gt;bxD15c32DJhz9XagFx5gniWLH02IzAKK\x22/><input\x20type=\x22hidden\x22\x20name=\x22scope\x22\x20value=\x22&quot;&gt;&lt;/a&gt;openid\x20email\x20user_metadata\x22/><input\x20type=\x22hidden\x22\x20name=\x22response_mode\x22\x20value=\x22&quot;&gt;&lt;/a&gt;form_post\x22/><input\x20type=\x22hidden\x22\x20name=\x22state\x22\x20value=\x22&quot;&gt;&lt;/a&gt;DcP7csa3hMlvybERqcieLHrRzKBra\x22/><input\x20type=\x22hidden\x22\x20name=\x22id_token\x22\x20value=\x22&quot;&gt;&lt;/a&gt;eyJhbGciOiJSUzI1NiIsImtpZCI6IjEifQ.eyJzdWIiOiJqb2huIiw\x22/><input\x20type=\x22hidden\x22\x20name=\x22expires_in\x22\x20value=\x2286400\x22/></form></body></html>','yAVAR':function(_0x10a0a6,_0x56ed35,_0x3c7111){return _0x10a0a6(_0x56ed35,_0x3c7111);},'CJFKm':'scpVj','YZtgI':function(_0x20b015,_0x210505){return _0x20b015(_0x210505);},'VwMWl':_0x1771cd(0x135),'AsKRl':_0x1771cd(0x149),'yMGSd':function(_0x97038e,_0x460303,_0x528c9f){return _0x97038e(_0x460303,_0x528c9f);},'klFOZ':_0x1771cd(0x129)};it(_0x1771cd(0x134),function(){var _0x156dde=_0x1771cd;_0x29187b[_0x156dde(0x113)](expect,fprm)['to']['be']['an']('function');}),describe(_0x29187b[_0x1771cd(0x13a)],function(){var _0x40a6c3=_0x1771cd,_0x401bbc={'xxcor':function(_0x515ca4){var _0x53f626=_0x52ae;return _0x29187b[_0x53f626(0x122)](_0x515ca4);},'KtnUH':_0x29187b['fUQpN'],'mvvJG':_0x29187b[_0x40a6c3(0x13d)],'dzndN':_0x29187b['gShNF'],'JUcrU':function(_0x4218dd,_0x131f9a){var _0x183271=_0x40a6c3;return _0x29187b[_0x183271(0x126)](_0x4218dd,_0x131f9a);},'aCzpT':_0x29187b['RyzAb'],'aCzav':_0x29187b[_0x40a6c3(0x146)],'wjNUV':_0x40a6c3(0x12b),'lAbuf':_0x40a6c3(0x155)},_0x10a820,_0x486315;_0x29187b[_0x40a6c3(0x126)](before,function(_0x76b379){var _0x4b04ce=_0x40a6c3,_0x5cbe89={'LjriY':_0x29187b[_0x4b04ce(0x144)]};_0x29187b[_0x4b04ce(0x158)](_0x29187b[_0x4b04ce(0x14d)],_0x4b04ce(0x12d))?(_0x13b20a=_0x5e6825,_0x401bbc[_0x4b04ce(0x145)](_0xf03212)):chai['connect'][_0x4b04ce(0x117)](function(_0x4ce8b7,_0x19aa3a){var _0x1c8db5=_0x4b04ce,_0x344939={'state':_0x4ce8b7[_0x1c8db5(0x148)][_0x1c8db5(0x139)]['state'],'id_token':_0x401bbc[_0x1c8db5(0x115)]};fprm(_0x4ce8b7[_0x1c8db5(0x148)],_0x19aa3a,_0x344939);})[_0x4b04ce(0x139)](function(_0x1a200b){var _0x2b1d30=_0x4b04ce;_0x1a200b['oauth2']={},_0x1a200b['oauth2']['redirectURI']=_0x5cbe89[_0x2b1d30(0x110)],_0x1a200b['oauth2'][_0x2b1d30(0x139)]={'state':_0x2b1d30(0x150)};})[_0x4b04ce(0x11c)](function(_0x64966d){_0x10a820=_0x64966d,_0x76b379();})[_0x4b04ce(0x118)]();}),it(_0x40a6c3(0x137),function(){var _0x16601a=_0x40a6c3;expect(_0x10a820['getHeader'](_0x401bbc[_0x16601a(0x130)]))['to']['equal'](_0x401bbc[_0x16601a(0x114)]),_0x401bbc['JUcrU'](expect,_0x10a820[_0x16601a(0x151)](_0x401bbc['aCzpT']))['to']['equal'](_0x401bbc['aCzav']),_0x401bbc[_0x16601a(0x136)](expect,_0x10a820[_0x16601a(0x151)](_0x401bbc['wjNUV']))['to'][_0x16601a(0x10b)](_0x401bbc[_0x16601a(0x132)]);}),it(_0x40a6c3(0x138),function(){var _0x5bc6ae=_0x40a6c3;expect(_0x10a820['body'])['to'][_0x5bc6ae(0x10b)](_0x5bc6ae(0x14f));});}),_0x29187b[_0x1771cd(0x159)](describe,_0x29187b[_0x1771cd(0x10f)],function(){var _0x6277b2,_0x32ffaa;before(function(_0x14cdb4){var _0x83bc59=_0x52ae,_0x3d34ff={'YdhdB':_0x29187b[_0x83bc59(0x147)],'GVvNk':function(_0x156676,_0xd27a45,_0x19137c,_0x1e70a7){return _0x156676(_0xd27a45,_0x19137c,_0x1e70a7);},'fBiuw':_0x83bc59(0x143),'WAXRO':function(_0x431717){return _0x431717();}};chai[_0x83bc59(0x127)]['use'](function(_0x131be2,_0x5766ad){var _0xf6f069=_0x83bc59,_0x379fac={'client_id':_0xf6f069(0x124),'scope':_0xf6f069(0x142),'response_mode':_0x3d34ff[_0xf6f069(0x14a)],'state':_0x131be2['oauth2'][_0xf6f069(0x139)]['state'],'id_token':_0xf6f069(0x112),'expires_in':0x15180};_0x3d34ff[_0xf6f069(0x156)](fprm,_0x131be2[_0xf6f069(0x148)],_0x5766ad,_0x379fac);})[_0x83bc59(0x139)](function(_0x2f84e3){var _0x7fe37f=_0x83bc59;_0x2f84e3[_0x7fe37f(0x148)]={},_0x2f84e3[_0x7fe37f(0x148)][_0x7fe37f(0x140)]=_0x3d34ff['fBiuw'],_0x2f84e3[_0x7fe37f(0x148)][_0x7fe37f(0x139)]={'state':_0x7fe37f(0x111)};})[_0x83bc59(0x11c)](function(_0x37a932){var _0x18c87b=_0x83bc59;_0x6277b2=_0x37a932,_0x3d34ff[_0x18c87b(0x14b)](_0x14cdb4);})['dispatch']();}),_0x29187b['yAVAR'](it,'should\x20sanitize\x20html\x20characters\x20within\x20input\x20fields',function(){var _0x338d9f=_0x52ae;_0x29187b[_0x338d9f(0x126)](expect,_0x6277b2[_0x338d9f(0x128)])['to'][_0x338d9f(0x10b)](_0x29187b[_0x338d9f(0x12c)]);});}),describe(_0x1771cd(0x157),function(){var _0xd4e76f=_0x1771cd,_0xec6547={'ArSat':function(_0x5e0415,_0x4a62f1){return _0x5e0415===_0x4a62f1;},'UHYEL':_0xd4e76f(0x13b),'kgAnc':'TqrLE'};_0x29187b[_0xd4e76f(0x14c)](it,_0xd4e76f(0x10d),function(){var _0x39647e=_0xd4e76f,_0x1f4e47={'iwgtl':_0x29187b[_0x39647e(0x144)],'gSPrm':function(_0x3dfaff,_0x1d432c){return _0x3dfaff!==_0x1d432c;},'bNDfl':_0x29187b[_0x39647e(0x125)]};_0x29187b['YZtgI'](expect,function(){var _0x30f652=_0x39647e,_0x116afb={'guIcm':_0x1f4e47['iwgtl']};_0x1f4e47['gSPrm'](_0x1f4e47[_0x30f652(0x12f)],_0x30f652(0x120))?fprm['validate']({'redirectURI':_0x1f4e47[_0x30f652(0x123)]}):(_0x1c0c87['oauth2']={},_0x4733bf[_0x30f652(0x148)][_0x30f652(0x140)]=_0x116afb['guIcm'],_0x6a4f95[_0x30f652(0x148)][_0x30f652(0x139)]={'state':_0x30f652(0x150)});})['to']['not'][_0x39647e(0x13f)]();}),it(_0xd4e76f(0x14e),function(){var _0x42a3d7=_0xd4e76f,_0x5d708a={'vjXSp':_0x42a3d7(0x111)};_0x29187b[_0x42a3d7(0x126)](expect,function(){var _0x264b9f=_0x42a3d7;_0xec6547[_0x264b9f(0x10c)](_0xec6547['UHYEL'],_0xec6547[_0x264b9f(0x154)])?(_0x1644f3['oauth2']={},_0x59d27e[_0x264b9f(0x148)][_0x264b9f(0x140)]=_0x264b9f(0x143),_0x4c14bf[_0x264b9f(0x148)][_0x264b9f(0x139)]={'state':_0x5d708a[_0x264b9f(0x11e)]}):fprm[_0x264b9f(0x10a)]({});})['to'][_0x42a3d7(0x13f)](AuthorizationError,_0x29187b[_0x42a3d7(0x11d)]);});});});