function _0x4bc2(){const _0x590564=['MxQBt','14125ayzbFO','wppdI','44NmsGoH','nXsAv','SzgkB','Detected\x20reference\x20to\x20not-allow-listed\x20external\x20resource\x20\x22','264355XsNFMk','dqiek','JdNTx','lZYvA','all','styles','lwLEi','necoD','klGNb','wLvxS','LLWfX','/@vite/','scriptsAllowListUrls','scripts','\x0a\x09\x09\x09\x09\x27','.css','attrs','/@fs/','perResourceSriHashes','Tzjss','],\x0a\x09\x09}','1311192yzgrpJ','XfGhW','iORpj','pFGPP','\x09\x09\x27','integrity2','Style','inline','gctKH','set','?astro&type=','cjpZj','YQglq','jToOr','http','warn','UqbWe','mKQiS','from','\x20integrity=\x22','</style>','Hashes','export\x20const\x20extStyleHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','rQBuE','UVxdl','length','src2','\x22\x20did\x20not\x20exist\x20at\x20build\x20time.\x20You\x20may\x20have\x20to\x20run\x20the\x20build\x20step\x20again','export\x20const\x20inlineScriptHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','NqimD','7QPSPbE','headers','//\x20Do\x20not\x20edit\x20this\x20file\x20manually\x0a\x0a','NTYsR','getCSPMiddlewareHandler','\x0a\x09\x27','sVdqR','indexOf','toLowerCase','stringify','WvDHo','exec','replace','9yEJNCQ','dZnSz','MPZMZ','YjVgW','UWmdN','ePZkR','edVXl','\x20are\x20disabled)','add','sort','rWuWw','SRI\x20hash\x20mismatch\x20for\x20\x22','\x0atry\x20{\x0a\x09if\x20(perResourceSriHashes)\x20{\x0a\x09\x09for\x20(const\x20[key,\x20value]\x20of\x20Object.entries(\x0a\x09\x09\x09perResourceSriHashes.scripts\x20??\x20{},\x0a\x09\x09))\x20{\x0a\x09\x09\x09globalHashes.scripts.set(key,\x20value)\x0a\x09\x09}\x0a\x09\x09for\x20(const\x20[key,\x20value]\x20of\x20Object.entries(\x0a\x09\x09\x09perResourceSriHashes.styles\x20??\x20{},\x0a\x09\x09))\x20{\x0a\x09\x09\x09globalHashes.styles.set(key,\x20value)\x0a\x09\x09}\x0a\x09}\x0a}\x20catch\x20(err)\x20{\x0a\x09console.error(\x27Failed\x20to\x20load\x20static\x20hashes\x20module:\x27,\x20err)\x0a}\x0a','test','post','extStyleHashes','vclDD','\x20crossorigin=\x22anonymous\x22','BKiHg','jbSbr','FKBoZ','\x09}),\x0a\x09styles:\x20/**\x20@type\x20{Record<string,string>}\x20*/\x20({\x0a','map','\x22\x20but\x20got\x20\x22','10syyJHA','EpGru','SRI\x20hashes\x20have\x20changed\x20for\x20static\x20resources\x20that\x20may\x20be\x20used\x20in\x20dynamic\x20pages.\x20You\x20should\x20run\x20the\x20build\x20step\x20again','has','QanbK','\x0a\x0aexport\x20const\x20onRequest\x20=\x20await\x20(async\x20()\x20=>\x20{\x0a\x09const\x20globalHashes\x20=\x20await\x20getGlobalHashes()\x0a\x0a\x09','1770789zPPpQK','virtual:@kindspells/astro-shield/middleware','MTlwX','UNWMk','VRjVS','CMKiD','perPageSriHashes','1056pqMklN','cdooO','trHBJ','TcdJm','pEXmq','sTTSg','\x0a\x09\x09\x09','7167897ynbOZm','ext','entries','integrity1','ULkdm','getCSPMiddlewareHandler(console,\x20globalHashes,\x20','GET','hYOYD','\x22\x20(inline\x20','enableMiddleware','iVYFn','getMiddlewareHandler(console,\x20globalHashes,\x20','DuFKy','2dhRwXl','wvzfc','SEmWS','text','IWGWr','zguJH','status','\x09}),\x0a}\x0a','}\x0a)\x0a\x0a','Skipping\x20SRI\x20hash\x20generation\x20for\x20inline\x20','stylesAllowListUrls','pytxZ','Found\x20empty\x20integrity\x20attribute,\x20skipping...','Unable\x20to\x20process\x20external\x20resource:\x20\x22','ZoBzZ','inlineStyleHashes','</script>','\x27:\x20{\x0a\x09\x09\x09scripts:\x20[','yEbIx','ucHAI','])\x0a\x0a','GDdAO','gFaqM','keys','1406680LyVXCi','\x20(inline\x20','uXLQR','inlineScriptHashes','get','hashesModule','includes','allowInlineStyles','zEgHS','PQwQq','arrayBuffer','src1','ozNsp','export\x20const\x20inlineStyleHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','WhtAC','jdQhO','MnvAi','enableStatic','The\x20SRI\x20hashes\x20module\x20\x22','kXYoS','\x22,\x20expected\x20\x22','startsWith','groups','BHwag','kgBUW','262149vqSZte','\x0a\x09\x09\x27','eZaTv','dobeM','VKZuG','oHIBQ','import\x20{\x20perResourceSriHashes\x20}\x20from\x20\x27','gysbm','yEhwa','join','allowInlineScripts','yFOIs','WoFMw','mKlak','\x27:\x20\x27',')\x0a})()\x0a','content','\x0a\x0a\x09return\x20defineMiddleware(','cNcDI','.js','export\x20const\x20extScriptHashes\x20=\x20/**\x20@type\x20{string[]}\x20*/\x20([','CDJsn','mRTDw','Script','.mjs','jstOv','extScriptHashes','<script','update','statusText'];_0x4bc2=function(){return _0x590564;};return _0x4bc2();}function _0x26aa(_0x329d41,_0x4398b9){const _0x4bc20f=_0x4bc2();return _0x26aa=function(_0x26aacc,_0x2cfb9b){_0x26aacc=_0x26aacc-0xbb;let _0x48e185=_0x4bc20f[_0x26aacc];return _0x48e185;},_0x26aa(_0x329d41,_0x4398b9);}const _0x4936a4=_0x26aa;(function(_0x3963ce,_0x28ca0e){const _0x1f6572=_0x26aa,_0xf50a03=_0x3963ce();while(!![]){try{const _0x3259b5=-parseInt(_0x1f6572(0xf1))/0x1+parseInt(_0x1f6572(0xc0))/0x2*(-parseInt(_0x1f6572(0x174))/0x3)+-parseInt(_0x1f6572(0x112))/0x4*(-parseInt(_0x1f6572(0x110))/0x5)+parseInt(_0x1f6572(0x12b))/0x6*(parseInt(_0x1f6572(0x149))/0x7)+parseInt(_0x1f6572(0xd8))/0x8*(parseInt(_0x1f6572(0x156))/0x9)+-parseInt(_0x1f6572(0x16e))/0xa*(parseInt(_0x1f6572(0x182))/0xb)+-parseInt(_0x1f6572(0x17b))/0xc*(-parseInt(_0x1f6572(0x116))/0xd);if(_0x3259b5===_0x28ca0e)break;else _0xf50a03['push'](_0xf50a03['shift']());}catch(_0x68ef38){_0xf50a03['push'](_0xf50a03['shift']());}}}(_0x4bc2,0xad8e3));import{createHash}from'node:crypto';import{mkdir,readFile,writeFile}from'node:fs/promises';import{dirname,extname,resolve,relative}from'node:path';import{fileURLToPath}from'node:url';import{doesFileExist,scanDirectory}from'./fs.mjs';import{patchHeaders}from'./headers.mjs';export const generateSRIHash=_0x10dfca=>{const _0x12b1da=_0x26aa,_0x3edc60={'ucHAI':function(_0x1d9927,_0x2c913b){return _0x1d9927(_0x2c913b);},'lwLEi':function(_0x160325,_0x375552){return _0x160325 instanceof _0x375552;},'wLvxS':function(_0x454cb3,_0x2ea597){return _0x454cb3 instanceof _0x2ea597;},'VgIoK':'utf8','UVxdl':'base64'},_0x1e44d9=_0x3edc60[_0x12b1da(0xd3)](createHash,'sha256');if(_0x3edc60[_0x12b1da(0x11c)](_0x10dfca,ArrayBuffer))_0x1e44d9['update'](Buffer[_0x12b1da(0x13d)](_0x10dfca));else _0x3edc60[_0x12b1da(0x11f)](_0x10dfca,Buffer)?_0x1e44d9[_0x12b1da(0x10d)](_0x10dfca):_0x1e44d9['update'](_0x10dfca,_0x3edc60['VgIoK']);return'sha256-'+_0x1e44d9['digest'](_0x3edc60[_0x12b1da(0x143)]);};const scriptReplacer=(_0x379fd8,_0x27dff1,_0x2796a6,_0x2978f7)=>_0x4936a4(0x10c)+_0x27dff1+(_0x379fd8!==null?'\x20integrity=\x22'+_0x379fd8+'\x22':'')+(_0x2796a6?_0x4936a4(0x167):'')+'>'+(_0x2978f7??'')+_0x4936a4(0xd0),styleReplacer=(_0x3156e8,_0x3aa79a,_0x4dc195,_0x179c9c)=>'<style'+_0x3aa79a+(_0x3156e8!==null?_0x4936a4(0x13e)+_0x3156e8+'\x22':'')+(_0x4dc195?_0x4936a4(0x167):'')+'>'+(_0x179c9c??'')+_0x4936a4(0x13f),linkStyleReplacer=(_0x44ff1f,_0x31c3ea,_0x45f9ed)=>'<link'+_0x31c3ea+(_0x44ff1f!==null?_0x4936a4(0x13e)+_0x44ff1f+'\x22':'')+(_0x45f9ed?'\x20crossorigin=\x22anonymous\x22':'')+'/>',srcRegex=/\s+(src|href)\s*=\s*("(?<src1>.*?)"|'(?<src2>.*?)')/i,integrityRegex=/\s+integrity\s*=\s*("(?<integrity1>.*?)"|'(?<integrity2>.*?)')/i,relStylesheetRegex=/\s+rel\s*=\s*('stylesheet'|"stylesheet")/i,getRegexProcessors=()=>{const _0xfe8f7a=_0x4936a4,_0x142f15={'VKZuG':'Script','dobeM':'scripts','WhtAC':_0xfe8f7a(0x131)};return[{'t':_0x142f15[_0xfe8f7a(0xf5)],'t2':_0x142f15[_0xfe8f7a(0xf4)],'regex':/<script(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*script\s*>/gi,'replacer':scriptReplacer,'hasContent':!![],'attrsRegex':undefined},{'t':_0x142f15[_0xfe8f7a(0xe6)],'t2':_0xfe8f7a(0x11b),'regex':/<style(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*style\s*>/gi,'replacer':styleReplacer,'hasContent':!![],'attrsRegex':undefined},{'t':_0x142f15['WhtAC'],'t2':_0xfe8f7a(0x11b),'regex':/<link(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*\/?>/gi,'replacer':linkStyleReplacer,'hasContent':![],'attrsRegex':relStylesheetRegex}];};export const updateStaticPageSriHashes=async(_0x1ee84d,_0xb69cc4,_0x5bd997,_0x317e03,_0x3d0323,_0x4630e3='all',_0x4e959d='all')=>{const _0x2f6f8b=_0x4936a4,_0x2142c8={'zEgHS':'Found\x20empty\x20integrity\x20attribute,\x20skipping...','NTYsR':function(_0x37c995,_0x2fb2ad){return _0x37c995(_0x2fb2ad);},'trHBJ':function(_0xd8bfb0){return _0xd8bfb0();},'necoD':_0x2f6f8b(0xd5),'YyIPU':_0x2f6f8b(0xfd),'CDJsn':function(_0xf6e994,_0x75f4a9){return _0xf6e994===_0x75f4a9;},'yEhwa':_0x2f6f8b(0x131),'uXLQR':_0x2f6f8b(0x142),'UNWMk':function(_0x180c28,_0x3aaf05,_0x131db2,_0x242ddb,_0x33826f){return _0x180c28(_0x3aaf05,_0x131db2,_0x242ddb,_0x33826f);}},_0x42a407=_0x2142c8[_0x2f6f8b(0x17d)](getRegexProcessors),_0x4ae203=_0x3d0323[_0x2f6f8b(0x17a)][_0x2f6f8b(0xdc)](_0x5bd997)??{'scripts':new Set(),'styles':new Set()};_0x3d0323[_0x2f6f8b(0x17a)][_0x2f6f8b(0x134)](_0x5bd997,_0x4ae203);let _0x536fca=_0x317e03,_0x3357c9;for(const {attrsRegex:_0x3bc3ba,hasContent:_0x2540be,regex:_0x4e7f39,replacer:_0x846db1,t:_0x2c4724,t2:_0x38f053}of _0x42a407){while((_0x3357c9=_0x4e7f39[_0x2f6f8b(0x154)](_0x317e03))!==null){const _0xff58fd=_0x3357c9['groups']?.['attrs']??'',_0x3e46f5=_0x3357c9['groups']?.[_0x2f6f8b(0x101)]??'';let _0x2be84b=undefined,_0xd42360=![];if(_0xff58fd){if(_0x3bc3ba&&!_0x3bc3ba[_0x2f6f8b(0x163)](_0xff58fd))continue;const _0x10b398=srcRegex[_0x2f6f8b(0x154)](_0xff58fd),_0x20d06c=integrityRegex[_0x2f6f8b(0x154)](_0xff58fd),_0x16e899=_0x10b398?.['groups']?.['src1']??_0x10b398?.['groups']?.['src2']??'';if(_0x20d06c){_0x2be84b=_0x20d06c[_0x2f6f8b(0xee)]?.[_0x2f6f8b(0x185)]??_0x20d06c['groups']?.['integrity2'];if(_0x2be84b){if(_0x2142c8['necoD']===_0x2142c8[_0x2f6f8b(0x11d)]){;(_0x10b398?_0x3d0323[_0x2f6f8b(0x183)+_0x2c4724+_0x2f6f8b(0x140)]:_0x3d0323[_0x2f6f8b(0x132)+_0x2c4724+_0x2f6f8b(0x140)])[_0x2f6f8b(0x15e)](_0x2be84b),_0x4ae203[_0x38f053]['add'](_0x2be84b);_0x16e899&&_0x3d0323[_0x2f6f8b(0x128)][_0x38f053][_0x2f6f8b(0x134)](_0x16e899,_0x2be84b);continue;}else _0x20a20b[_0x2f6f8b(0x13a)](_0x2142c8[_0x2f6f8b(0xe0)]);}}if(_0x16e899){const _0x330489=_0x3d0323[_0x2f6f8b(0x128)][_0x38f053][_0x2f6f8b(0xdc)](_0x16e899);if(_0x330489)_0x2be84b=_0x330489,_0x3d0323['ext'+_0x2c4724+_0x2f6f8b(0x140)][_0x2f6f8b(0x15e)](_0x2be84b),_0x4ae203[_0x38f053][_0x2f6f8b(0x15e)](_0x2be84b);else{if(_0x2f6f8b(0xfc)===_0x2f6f8b(0xfc)){let _0x3a80f4;if(_0x16e899['startsWith']('/')){const _0x3fd36b=resolve(_0xb69cc4,'.'+_0x16e899);_0x3a80f4=await readFile(_0x3fd36b);}else{if(_0x16e899[_0x2f6f8b(0xed)](_0x2f6f8b(0x139))){_0xd42360=!![];const _0x364b45=await fetch(_0x16e899,{'method':_0x2f6f8b(0x188)});_0x3a80f4=await _0x364b45[_0x2f6f8b(0xe2)]();}else{if(_0x2142c8['YyIPU']!==_0x2142c8['YyIPU']){const _0x13d4d1=_0x49cd41[_0x11d00d];if(!_0x13d4d1)return![];if(!_0x52f2a3(_0x5b830c[_0x2f6f8b(0x123)],_0x13d4d1[_0x2f6f8b(0x123)])||!_0x10eb15(_0x19b94f[_0x2f6f8b(0x11b)],_0x13d4d1[_0x2f6f8b(0x11b)]))return![];}else{_0x1ee84d[_0x2f6f8b(0x13a)]('Unable\x20to\x20process\x20external\x20resource:\x20\x22'+_0x16e899+'\x22');continue;}}}_0x2be84b=generateSRIHash(_0x3a80f4),_0x3d0323[_0x2f6f8b(0x183)+_0x2c4724+_0x2f6f8b(0x140)][_0x2f6f8b(0x15e)](_0x2be84b),_0x4ae203[_0x38f053][_0x2f6f8b(0x15e)](_0x2be84b),_0x3d0323['perResourceSriHashes'][_0x38f053][_0x2f6f8b(0x134)](_0x16e899,_0x2be84b);}else _0x5d551a=_0x2142c8[_0x2f6f8b(0x14c)](_0x1288a8,_0x2ad113),_0x2755e2[_0x1cfa78][_0x2f6f8b(0x15e)](_0xf3eb40);}}}if(_0x2540be&&!_0x2be84b){if(!(_0x2142c8[_0x2f6f8b(0x106)](_0x4630e3,![])&&_0x2c4724===_0x2f6f8b(0x108))&&!(_0x4e959d===![]&&_0x2c4724===_0x2142c8[_0x2f6f8b(0xf9)]))_0x2be84b=_0x2142c8[_0x2f6f8b(0x14c)](generateSRIHash,_0x3e46f5),_0x3d0323[_0x2f6f8b(0x132)+_0x2c4724+_0x2f6f8b(0x140)][_0x2f6f8b(0x15e)](_0x2be84b),_0x4ae203[_0x38f053][_0x2f6f8b(0x15e)](_0x2be84b);else{if(_0x2142c8[_0x2f6f8b(0xda)]!=='WtAay')_0x1ee84d[_0x2f6f8b(0x13a)]('Skipping\x20SRI\x20hash\x20generation\x20for\x20inline\x20'+_0x2c4724[_0x2f6f8b(0x151)]()+'\x20\x22'+_0x5bd997+_0x2f6f8b(0xbb)+_0x38f053+_0x2f6f8b(0x15d));else return _0x1deebd;}}_0x2be84b&&(_0x536fca=_0x536fca[_0x2f6f8b(0x155)](_0x3357c9[0x0],_0x2142c8[_0x2f6f8b(0x177)](_0x846db1,_0x2be84b,_0xff58fd,_0xd42360,_0x3e46f5)));}}return _0x536fca;};export const updateDynamicPageSriHashes=async(_0x485d6f,_0x214a26,_0x2cf7a5,_0x2fa531)=>{const _0x226b5a=_0x4936a4,_0x232086={'WvDHo':function(_0x3cd15f,_0x48644b){return _0x3cd15f!==_0x48644b;},'aZjlC':_0x226b5a(0x108),'YjVgW':_0x226b5a(0x131),'MxQBt':'styles','MdvDY':_0x226b5a(0x170),'vclDD':_0x226b5a(0x114),'klGNb':function(_0x27ff40,_0x3afd16){return _0x27ff40&&_0x3afd16;},'cNcDI':_0x226b5a(0xef),'jstOv':_0x226b5a(0xbd),'dZnSz':function(_0x541d62,_0x2a9494){return _0x541d62===_0x2a9494;},'rWuWw':function(_0x333609,_0x32a57f){return _0x333609===_0x32a57f;},'EWqnb':function(_0x55f9f5,_0x800101){return _0x55f9f5===_0x800101;},'QanbK':_0x226b5a(0x11a),'pEXmq':_0x226b5a(0xf8),'oHIBQ':_0x226b5a(0x12d),'UqbWe':function(_0x1f1828,_0x28afa3){return _0x1f1828(_0x28afa3);},'jdQhO':_0x226b5a(0x189)},_0x53b502=getRegexProcessors();let _0x2845d5=_0x214a26,_0x1c33aa;const _0x21963d={'scripts':new Set(),'styles':new Set()};for(const {attrsRegex:_0x503aed,hasContent:_0x35175e,regex:_0x27baea,replacer:_0x175c9b,t:_0x2f0c84,t2:_0x13eebf}of _0x53b502){while((_0x1c33aa=_0x27baea['exec'](_0x214a26))!==null){const _0x6d7243=_0x1c33aa[_0x226b5a(0xee)]?.[_0x226b5a(0x126)]??'',_0x49230a=_0x1c33aa[_0x226b5a(0xee)]?.['content']??'';let _0x234451=undefined,_0x3e1678=![];if(_0x6d7243){if(_0x503aed&&!_0x503aed[_0x226b5a(0x163)](_0x6d7243)){if(_0x232086[_0x226b5a(0x166)]!==_0x226b5a(0x114)){if(_0x232086[_0x226b5a(0x153)](_0x3539f0,_0x54e22d))throw new _0x233af6(_0x226b5a(0x161)+_0xf62873+_0x226b5a(0xec)+_0x54b5f6+_0x226b5a(0x16d)+_0x36e700+'\x22');}else continue;}const _0x19b5b1=srcRegex[_0x226b5a(0x154)](_0x6d7243),_0x5d9b95=integrityRegex[_0x226b5a(0x154)](_0x6d7243),_0x4f3ad8=_0x19b5b1?.[_0x226b5a(0xee)]?.[_0x226b5a(0xe3)]??_0x19b5b1?.[_0x226b5a(0xee)]?.[_0x226b5a(0x145)];if(_0x232086[_0x226b5a(0x11e)](_0x49230a,_0x4f3ad8)){if(_0x232086[_0x226b5a(0x153)](_0x226b5a(0xef),_0x232086[_0x226b5a(0x103)]))_0x3c8a47=_0x226b5a(0xf7)+_0x423291[_0x226b5a(0xdd)]+'\x27',_0x329f61=_0x226b5a(0x162);else{_0x485d6f[_0x226b5a(0x13a)]('scripts\x20must\x20have\x20either\x20a\x20src\x20attribute\x20or\x20content,\x20but\x20not\x20both\x20\x22'+_0x4f3ad8+'\x22');continue;}}if(_0x5d9b95){_0x234451=_0x5d9b95[_0x226b5a(0xee)]?.[_0x226b5a(0x185)]??_0x5d9b95[_0x226b5a(0xee)]?.[_0x226b5a(0x130)];if(_0x234451){if(_0x232086[_0x226b5a(0x10a)]!=='iVYFn')return;else{if(_0x4f3ad8){const _0x4ab03a=_0x2cf7a5[_0x13eebf]['get'](_0x4f3ad8);if(_0x4ab03a){if(_0x4ab03a!==_0x234451)throw new Error('SRI\x20hash\x20mismatch\x20for\x20\x22'+_0x4f3ad8+_0x226b5a(0xec)+_0x4ab03a+_0x226b5a(0x16d)+_0x234451+'\x22');}else{if('PQwQq'!==_0x226b5a(0xe1))return[{'t':_0x232086['aZjlC'],'t2':_0x226b5a(0x123),'regex':/<script(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*script\s*>/gi,'replacer':_0x478622,'hasContent':!![],'attrsRegex':_0x16a9ff},{'t':_0x232086[_0x226b5a(0x159)],'t2':_0x226b5a(0x11b),'regex':/<style(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*>(?<content>[\s\S]*?)<\/\s*style\s*>/gi,'replacer':_0x49640a,'hasContent':!![],'attrsRegex':_0x3fe669},{'t':_0x226b5a(0x131),'t2':_0x232086[_0x226b5a(0x10f)],'regex':/<link(?<attrs>(\s+[a-z][a-z0-9\-_]*(=('[^']*?'|"[^"]*?"))?)*?)\s*\/?>/gi,'replacer':_0x52ea70,'hasContent':![],'attrsRegex':_0x594db1}];else _0x2cf7a5[_0x13eebf][_0x226b5a(0x134)](_0x4f3ad8,_0x234451);}}_0x21963d[_0x13eebf][_0x226b5a(0x15e)](_0x234451);}}else _0x485d6f[_0x226b5a(0x13a)](_0x226b5a(0xcc));continue;}if(_0x4f3ad8){if(_0x4f3ad8['startsWith']('/')){_0x234451=_0x2cf7a5[_0x13eebf][_0x226b5a(0xdc)](_0x4f3ad8);if(_0x234451)_0x21963d[_0x13eebf]['add'](_0x234451);else{!(_0x4f3ad8[_0x226b5a(0xed)](_0x226b5a(0x121))||_0x4f3ad8[_0x226b5a(0xed)](_0x226b5a(0x127))||_0x4f3ad8[_0x226b5a(0x150)](_0x226b5a(0x135))>=0x0)&&_0x485d6f[_0x226b5a(0x13a)]('Unable\x20to\x20obtain\x20SRI\x20hash\x20for\x20local\x20resource:\x20\x22'+_0x4f3ad8+'\x22');continue;}}else{if(_0x4f3ad8[_0x226b5a(0xed)](_0x226b5a(0x139))){_0x3e1678=!![],_0x234451=_0x2cf7a5[_0x13eebf]['get'](_0x4f3ad8);if(_0x234451)_0x21963d[_0x13eebf][_0x226b5a(0x15e)](_0x234451);else{_0x485d6f['warn'](_0x226b5a(0x115)+_0x4f3ad8+'\x22');_0x3e1678&&(_0x226b5a(0x15a)!==_0x226b5a(0x129)?_0x2845d5=_0x2845d5[_0x226b5a(0x155)](_0x1c33aa[0x0],_0x175c9b(null,_0x6d7243,!![],'')):_0x1619ba[_0x226b5a(0x13a)](_0x232086['MdvDY']));continue;}}else{if(_0x232086[_0x226b5a(0x157)](_0x226b5a(0x15b),_0x226b5a(0x119)))_0x56c14f[_0x226b5a(0x10d)](_0x29042e);else{_0x485d6f[_0x226b5a(0x13a)](_0x226b5a(0xcd)+_0x4f3ad8+'\x22');continue;}}}}}_0x232086[_0x226b5a(0x11e)](_0x35175e,!_0x234451)&&(_0x232086['rWuWw'](_0x2fa531?.[_0x226b5a(0xfb)]??_0x226b5a(0x11a),_0x226b5a(0x11a))&&_0x232086['EWqnb'](_0x2f0c84,'Script')||(_0x2fa531?.[_0x226b5a(0xdf)]??_0x232086[_0x226b5a(0x172)])===_0x226b5a(0x11a)&&_0x232086[_0x226b5a(0x160)](_0x2f0c84,_0x232086['YjVgW'])?_0x232086[_0x226b5a(0x157)](_0x232086[_0x226b5a(0x17f)],_0x232086[_0x226b5a(0xf6)])?(_0x5ef17c=_0x465a98,_0x21261b['ext'+_0x37d93f+_0x226b5a(0x140)][_0x226b5a(0x15e)](_0x13a9bf),_0xdd6007[_0x59d00b][_0x226b5a(0x15e)](_0x499d83)):(_0x234451=_0x232086[_0x226b5a(0x13b)](generateSRIHash,_0x49230a),_0x21963d[_0x13eebf]['add'](_0x234451)):_0x485d6f['warn']('Skipping\x20SRI\x20hash\x20generation\x20for\x20inline\x20'+_0x2f0c84[_0x226b5a(0x151)]()+_0x226b5a(0xd9)+_0x13eebf+_0x226b5a(0x15d)));if(_0x234451){if(_0x232086[_0x226b5a(0x157)](_0x232086[_0x226b5a(0xe7)],'UQZvL'))return![];else _0x2845d5=_0x2845d5['replace'](_0x1c33aa[0x0],_0x175c9b(_0x234451,_0x6d7243,_0x3e1678,_0x49230a));}}}return{'pageHashes':_0x21963d,'updatedContent':_0x2845d5};};const processHTMLFile=async(_0x27dd30,_0x1856c5,_0x1464cf,_0x4e47c0,_0x20c2f1)=>{const _0x378bc5=_0x4936a4,_0x354fdb={'XizTu':function(_0x16ebe5,_0x20085c,_0x4dd6ab){return _0x16ebe5(_0x20085c,_0x4dd6ab);},'SEmWS':function(_0x1e7c8b,_0x52f0ed,_0x5cf64a){return _0x1e7c8b(_0x52f0ed,_0x5cf64a);},'CMKiD':_0x378bc5(0x11a),'ULkdm':function(_0x2d1a24,_0x3d400a){return _0x2d1a24!==_0x3d400a;}},_0x52f533=await _0x354fdb['XizTu'](readFile,_0x1856c5,'utf8'),_0x2f75d0=await updateStaticPageSriHashes(_0x27dd30,_0x1464cf,_0x354fdb[_0x378bc5(0xc2)](relative,_0x1464cf,_0x1856c5),_0x52f533,_0x4e47c0,_0x20c2f1?.[_0x378bc5(0xfb)]??_0x354fdb[_0x378bc5(0x179)],_0x20c2f1?.['allowInlineStyles']??_0x354fdb[_0x378bc5(0x179)]);_0x354fdb[_0x378bc5(0x186)](_0x2f75d0,_0x52f533)&&await writeFile(_0x1856c5,_0x2f75d0);};export const arraysEqual=(_0x5e894b,_0x3aaa80)=>{const _0x467fdb=_0x4936a4,_0x53c4e8={'jbSbr':function(_0x409e87,_0x567e20){return _0x409e87!==_0x567e20;},'nXsAv':function(_0x1fcd11,_0x34eff3){return _0x1fcd11<_0x34eff3;},'wppdI':'UXYNH'};if(_0x53c4e8[_0x467fdb(0x169)](_0x5e894b[_0x467fdb(0x144)],_0x3aaa80[_0x467fdb(0x144)]))return![];for(let _0x45c8e8=0x0;_0x53c4e8[_0x467fdb(0x113)](_0x45c8e8,_0x5e894b[_0x467fdb(0x144)]);_0x45c8e8++){if(_0x53c4e8[_0x467fdb(0x111)]===_0x53c4e8['wppdI']){if(_0x5e894b[_0x45c8e8]!==_0x3aaa80[_0x45c8e8])return![];}else _0x25ba72[_0x467fdb(0x13a)](_0x467fdb(0xc9)+_0x19d8db[_0x467fdb(0x151)]()+'\x20\x22'+_0x2e509b+_0x467fdb(0xbb)+_0x59720b+_0x467fdb(0x15d));}return!![];};export const pageHashesEqual=(_0x34ea1f,_0x4d9324)=>{const _0x5d5daf=_0x4936a4,_0x599002={'YQglq':function(_0xf11511,_0x448d45,_0xead154){return _0xf11511(_0x448d45,_0xead154);}},_0x515d2b=Object[_0x5d5daf(0xd7)](_0x34ea1f)[_0x5d5daf(0x15f)](),_0x589fce=Object[_0x5d5daf(0xd7)](_0x4d9324)[_0x5d5daf(0x15f)]();if(!arraysEqual(_0x515d2b,_0x589fce))return![];for(const [_0x940f5c,_0x3a9aae]of Object[_0x5d5daf(0x184)](_0x34ea1f)){const _0x3589cb=_0x4d9324[_0x940f5c];if(!_0x3589cb)return![];if(!_0x599002[_0x5d5daf(0x137)](arraysEqual,_0x3a9aae[_0x5d5daf(0x123)],_0x3589cb[_0x5d5daf(0x123)])||!_0x599002[_0x5d5daf(0x137)](arraysEqual,_0x3a9aae['styles'],_0x3589cb[_0x5d5daf(0x11b)]))return![];}return!![];};export const sriHashesEqual=(_0x2b118f,_0x2805c9)=>{const _0x3ac5c9=_0x4936a4,_0x5b3d53={'edVXl':function(_0xeefaa9,_0x4a6507,_0x48069f){return _0xeefaa9(_0x4a6507,_0x48069f);},'yEbIx':function(_0x14cde5,_0x1ac81d){return _0x14cde5===_0x1ac81d;},'DuFKy':function(_0x47ec30,_0x10be2a){return _0x47ec30!==_0x10be2a;}},_0x202070=Object[_0x3ac5c9(0xd7)](_0x2b118f['scripts'])[_0x3ac5c9(0x15f)](),_0x8a3b57=Object[_0x3ac5c9(0xd7)](_0x2805c9[_0x3ac5c9(0x123)])[_0x3ac5c9(0x15f)](),_0x213ff3=Object[_0x3ac5c9(0xd7)](_0x2b118f['styles'])['sort'](),_0x5dae33=Object[_0x3ac5c9(0xd7)](_0x2805c9[_0x3ac5c9(0x11b)])[_0x3ac5c9(0x15f)]();if(!arraysEqual(_0x202070,_0x8a3b57)||!_0x5b3d53[_0x3ac5c9(0x15c)](arraysEqual,_0x213ff3,_0x5dae33))return![];for(const [_0x2a592e,_0x47525d]of Object['entries'](_0x2b118f[_0x3ac5c9(0x123)])){if(_0x5b3d53[_0x3ac5c9(0xd2)](_0x3ac5c9(0xeb),_0x3ac5c9(0xce)))return![];else{if(_0x2805c9[_0x3ac5c9(0x123)][_0x2a592e]!==_0x47525d)return![];}}for(const [_0x28343a,_0x373464]of Object[_0x3ac5c9(0x184)](_0x2b118f['styles'])){if(_0x5b3d53[_0x3ac5c9(0xbf)](_0x2805c9['styles'][_0x28343a],_0x373464))return![];}return!![];};export const scanForNestedResources=async(_0x179ae0,_0x18f2cd,_0x27326e)=>{const _0x49849a=_0x4936a4,_0x5018a2={'LLWfX':function(_0x5a9ec1,_0x429e8a,_0x522dd4){return _0x5a9ec1(_0x429e8a,_0x522dd4);},'sTTSg':function(_0x1d748e,_0x40a51d){return _0x1d748e(_0x40a51d);},'sVdqR':_0x49849a(0x109),'mKQiS':function(_0x7874ef,_0x21955f){return _0x7874ef(_0x21955f);}};await scanDirectory(_0x179ae0,_0x18f2cd,_0x18f2cd,_0x27326e,async(_0x445e5d,_0x45b816,_0x277de4,_0x1388bd)=>{const _0x501fb6=_0x49849a,_0x38b3e6='/'+_0x5018a2[_0x501fb6(0x120)](relative,_0x277de4,_0x45b816),_0x52cd91=_0x5018a2[_0x501fb6(0x180)](extname,_0x45b816);if([_0x501fb6(0x104),_0x5018a2[_0x501fb6(0x14f)]][_0x501fb6(0xde)](_0x52cd91)){if(!_0x1388bd[_0x501fb6(0x128)][_0x501fb6(0x123)][_0x501fb6(0x171)](_0x38b3e6)){if(_0x501fb6(0x12e)!==_0x501fb6(0x16f)){const _0x23464f=_0x5018a2[_0x501fb6(0x180)](generateSRIHash,await readFile(_0x45b816));_0x1388bd['extScriptHashes'][_0x501fb6(0x15e)](_0x23464f),_0x1388bd[_0x501fb6(0x128)][_0x501fb6(0x123)]['set'](_0x38b3e6,_0x23464f);}else _0x3f3fd8[_0x501fb6(0x13a)](_0x501fb6(0xea)+_0x18857b['hashesModule']+_0x501fb6(0x146));}}else{if(_0x52cd91===_0x501fb6(0x125)){if(!_0x1388bd['perResourceSriHashes'][_0x501fb6(0x11b)][_0x501fb6(0x171)](_0x38b3e6)){const _0x2edf9d=generateSRIHash(await _0x5018a2[_0x501fb6(0x13c)](readFile,_0x45b816));_0x1388bd[_0x501fb6(0x165)][_0x501fb6(0x15e)](_0x2edf9d),_0x1388bd[_0x501fb6(0x128)][_0x501fb6(0x11b)][_0x501fb6(0x134)](_0x38b3e6,_0x2edf9d);}}}},_0x4867e3=>[_0x49849a(0x104),_0x49849a(0x109),_0x49849a(0x125)][_0x49849a(0xde)](extname(_0x4867e3)));};export const scanAllowLists=async(_0x3a42ba,_0x207a98)=>{const _0x49d2de=_0x4936a4,_0x582683={'ZltWr':function(_0x26db3a,_0x4f7a30,_0x5e5caa){return _0x26db3a(_0x4f7a30,_0x5e5caa);},'mRTDw':function(_0x366faf,_0x5dae48,_0x5186cb){return _0x366faf(_0x5dae48,_0x5186cb);}};for(const _0x5ded90 of _0x3a42ba[_0x49d2de(0x122)]){const _0x4f82d3=await _0x582683['ZltWr'](fetch,_0x5ded90,{'method':'GET'}),_0x3c2d2f=await _0x4f82d3['arrayBuffer'](),_0x20662b=generateSRIHash(_0x3c2d2f);_0x207a98[_0x49d2de(0x10b)][_0x49d2de(0x15e)](_0x20662b),_0x207a98[_0x49d2de(0x128)]['scripts'][_0x49d2de(0x134)](_0x5ded90,_0x20662b);}for(const _0x5529ea of _0x3a42ba[_0x49d2de(0xca)]){const _0x4e6e25=await _0x582683[_0x49d2de(0x107)](fetch,_0x5529ea,{'method':_0x49d2de(0x188)}),_0x5b76ff=await _0x4e6e25['arrayBuffer'](),_0x225bfd=generateSRIHash(_0x5b76ff);_0x207a98['extStyleHashes'][_0x49d2de(0x15e)](_0x225bfd),_0x207a98[_0x49d2de(0x128)][_0x49d2de(0x11b)]['set'](_0x5529ea,_0x225bfd);}};export async function generateSRIHashesModule(_0x25d03e,_0x1513bf,_0x4523a5,_0x4cd8bf){const _0x2cfe4c=_0x4936a4,_0x367b6c={'uSAdi':function(_0x5b573a,_0x578335){return _0x5b573a===_0x578335;},'JdNTx':function(_0x4f20d3,_0x463611){return _0x4f20d3===_0x463611;},'YLchk':'jqHQu','cCtbM':_0x2cfe4c(0x16a),'MnvAi':function(_0x2486e0,_0x33bbe5,_0x2cb1f9){return _0x2486e0(_0x33bbe5,_0x2cb1f9);},'IWGWr':function(_0x1d3f8c,_0x3e99c7,_0xa72e56){return _0x1d3f8c(_0x3e99c7,_0xa72e56);},'nTLBN':function(_0x3a8f91,_0x5ae581){return _0x3a8f91&&_0x5ae581;},'MTlwX':function(_0x1050d5,_0x52ee32){return _0x1050d5>_0x52ee32;},'DslvQ':function(_0x14f6f2,_0x1cec2d){return _0x14f6f2(_0x1cec2d);}};let _0xbfefcc=![],_0x25172e=![];const _0x35e221=Array[_0x2cfe4c(0x13d)](_0x1513bf[_0x2cfe4c(0xdb)])[_0x2cfe4c(0x15f)](),_0x2bf0c0=Array['from'](_0x1513bf[_0x2cfe4c(0xcf)])['sort'](),_0x1bd277=Array['from'](_0x1513bf[_0x2cfe4c(0x10b)])[_0x2cfe4c(0x15f)](),_0x407585=Array[_0x2cfe4c(0x13d)](_0x1513bf[_0x2cfe4c(0x165)])[_0x2cfe4c(0x15f)](),_0x136831={};for(const [_0x4cc3df,_0x54a223]of _0x1513bf[_0x2cfe4c(0x17a)]['entries']()){_0x136831[_0x4cc3df]={'scripts':Array[_0x2cfe4c(0x13d)](_0x54a223[_0x2cfe4c(0x123)])[_0x2cfe4c(0x15f)](),'styles':Array[_0x2cfe4c(0x13d)](_0x54a223[_0x2cfe4c(0x11b)])[_0x2cfe4c(0x15f)]()};}const _0x4840f8={'scripts':{},'styles':{}};for(const [_0x39c263,_0x346548]of _0x1513bf[_0x2cfe4c(0x128)]['scripts'][_0x2cfe4c(0x184)]()){_0x4840f8[_0x2cfe4c(0x123)][_0x39c263]=_0x346548;}for(const [_0x4e41f9,_0x44492f]of _0x1513bf[_0x2cfe4c(0x128)]['styles'][_0x2cfe4c(0x184)]()){if(_0x367b6c[_0x2cfe4c(0x118)](_0x367b6c['YLchk'],_0x367b6c['cCtbM'])){if(_0x367b6c['uSAdi'](_0x113ea2,_0x42b9e4))return _0xf4e389;return;}else _0x4840f8[_0x2cfe4c(0x11b)][_0x4e41f9]=_0x44492f;}if(await doesFileExist(_0x4523a5)){const _0x557fbc=await import(_0x4523a5);_0xbfefcc=!_0x367b6c['MnvAi'](sriHashesEqual,_0x4840f8,_0x557fbc[_0x2cfe4c(0x128)]??{'scripts':{},'styles':{}}),_0x25172e=_0xbfefcc||!arraysEqual(_0x35e221,_0x557fbc['inlineScriptHashes']??[])||!_0x367b6c[_0x2cfe4c(0xe8)](arraysEqual,_0x2bf0c0,_0x557fbc['inlineStyleHashes']??[])||!arraysEqual(_0x1bd277,_0x557fbc[_0x2cfe4c(0x10b)]??[])||!_0x367b6c[_0x2cfe4c(0xc4)](arraysEqual,_0x407585,_0x557fbc[_0x2cfe4c(0x165)]??[])||!_0x367b6c['MnvAi'](pageHashesEqual,_0x136831,_0x557fbc[_0x2cfe4c(0x17a)]??{});}else _0x25172e=!![];if(_0x25172e){_0x367b6c['nTLBN'](_0xbfefcc,_0x4cd8bf)&&_0x25d03e[_0x2cfe4c(0x13a)]('SRI\x20hashes\x20have\x20changed\x20for\x20static\x20resources\x20that\x20may\x20be\x20used\x20in\x20dynamic\x20pages.\x20You\x20should\x20run\x20the\x20build\x20step\x20again');let _0xd13183=_0x2cfe4c(0x14b);_0xd13183+=_0x2cfe4c(0x147)+_0x35e221[_0x2cfe4c(0x16c)](_0x4f74b9=>_0x2cfe4c(0x14e)+_0x4f74b9+'\x27,')['join']('')+(_0x367b6c[_0x2cfe4c(0x176)](_0x35e221[_0x2cfe4c(0x144)],0x0)?'\x0a':'')+_0x2cfe4c(0xd4),_0xd13183+=_0x2cfe4c(0xe5)+_0x2bf0c0['map'](_0x1194a1=>_0x2cfe4c(0x14e)+_0x1194a1+'\x27,')[_0x2cfe4c(0xfa)]('')+(_0x2bf0c0[_0x2cfe4c(0x144)]>0x0?'\x0a':'')+_0x2cfe4c(0xd4),_0xd13183+=_0x2cfe4c(0x105)+_0x1bd277['map'](_0xbb1165=>_0x2cfe4c(0x14e)+_0xbb1165+'\x27,')['join']('')+(_0x1bd277[_0x2cfe4c(0x144)]>0x0?'\x0a':'')+_0x2cfe4c(0xd4),_0xd13183+=_0x2cfe4c(0x141)+_0x407585['map'](_0xd2e642=>_0x2cfe4c(0x14e)+_0xd2e642+'\x27,')['join']('')+(_0x367b6c[_0x2cfe4c(0x176)](_0x407585[_0x2cfe4c(0x144)],0x0)?'\x0a':'')+_0x2cfe4c(0xd4),_0xd13183+='export\x20const\x20perPageSriHashes\x20=\x0a\x09/**\x20@type\x20{Record<string,\x20{\x20scripts:\x20string[];\x20styles:\x20string\x20[]\x20}>}\x20*/\x20({'+Object[_0x2cfe4c(0x184)](_0x136831)[_0x2cfe4c(0x15f)]()[_0x2cfe4c(0x16c)](([_0x51236c,_0x12253e])=>_0x2cfe4c(0xf2)+_0x51236c+_0x2cfe4c(0xd1)+_0x12253e[_0x2cfe4c(0x123)][_0x2cfe4c(0x16c)](_0x7fb820=>_0x2cfe4c(0x124)+_0x7fb820+'\x27,')[_0x2cfe4c(0xfa)]('')+(_0x12253e[_0x2cfe4c(0x123)]['length']>0x0?_0x2cfe4c(0x181):'')+'],\x0a\x09\x09\x09styles:\x20['+_0x12253e[_0x2cfe4c(0x11b)][_0x2cfe4c(0x16c)](_0x3f9df7=>_0x2cfe4c(0x124)+_0x3f9df7+'\x27,')[_0x2cfe4c(0xfa)]('')+(_0x12253e[_0x2cfe4c(0x11b)]['length']>0x0?_0x2cfe4c(0x181):'')+_0x2cfe4c(0x12a))['join'](',')+_0x2cfe4c(0xc8),_0xd13183+='export\x20const\x20perResourceSriHashes\x20=\x20{\x0a\x09scripts:\x20/**\x20@type\x20{Record<string,string>}\x20*/\x20({\x0a'+Object[_0x2cfe4c(0x184)](_0x4840f8[_0x2cfe4c(0x123)])[_0x2cfe4c(0x16c)](([_0x933a17,_0x1004c6])=>_0x2cfe4c(0x12f)+_0x933a17+_0x2cfe4c(0xff)+_0x1004c6+'\x27,\x0a')[_0x2cfe4c(0xfa)]('')+_0x2cfe4c(0x16b)+Object[_0x2cfe4c(0x184)](_0x4840f8[_0x2cfe4c(0x11b)])[_0x2cfe4c(0x16c)](([_0x2a1db0,_0x46ce67])=>_0x2cfe4c(0x12f)+_0x2a1db0+_0x2cfe4c(0xff)+_0x46ce67+'\x27,\x0a')['join']('')+_0x2cfe4c(0xc7),await mkdir(_0x367b6c['DslvQ'](dirname,_0x4523a5),{'recursive':!![]}),await writeFile(_0x4523a5,_0xd13183);}}export const processStaticFiles=async(_0x20a4da,{distDir:_0x2d52ac,sri:_0x1fa167})=>{const _0x1a54bd=_0x4936a4,_0x14a565={'mKlak':function(_0x14f10a,_0x53f340,_0x391023,_0x598403,_0x32ffed,_0x1e1e89,_0x134e54,_0xd7d95c){return _0x14f10a(_0x53f340,_0x391023,_0x598403,_0x32ffed,_0x1e1e89,_0x134e54,_0xd7d95c);},'ozNsp':function(_0x381f6b,_0x1ece21,_0x6ea558,_0x5318ff){return _0x381f6b(_0x1ece21,_0x6ea558,_0x5318ff);}},_0x4dca9c={'inlineScriptHashes':new Set(),'inlineStyleHashes':new Set(),'extScriptHashes':new Set(),'extStyleHashes':new Set(),'perPageSriHashes':new Map(),'perResourceSriHashes':{'scripts':new Map(),'styles':new Map()}};await _0x14a565[_0x1a54bd(0xfe)](scanDirectory,_0x20a4da,_0x2d52ac,_0x2d52ac,_0x4dca9c,processHTMLFile,_0x39d836=>extname(_0x39d836)==='.html',_0x1fa167),await _0x14a565[_0x1a54bd(0xe4)](scanForNestedResources,_0x20a4da,_0x2d52ac,_0x4dca9c);if(!_0x1fa167['hashesModule'])return;await generateSRIHashesModule(_0x20a4da,_0x4dca9c,_0x1fa167[_0x1a54bd(0xdd)],_0x1fa167[_0x1a54bd(0xbc)]);};export const getMiddlewareHandler=(_0x386c36,_0x473a1f,_0x3d22cb)=>{const _0x5b2d69={'BKiHg':function(_0x20b0f6){return _0x20b0f6();},'cjpZj':function(_0x5b4028,_0x33306f,_0x335ff2,_0x1ef25f,_0x4509e8){return _0x5b4028(_0x33306f,_0x335ff2,_0x1ef25f,_0x4509e8);}};return async(_0x228d56,_0x454fec)=>{const _0x3994ad=_0x26aa,_0x4bc361=await _0x5b2d69[_0x3994ad(0x168)](_0x454fec),_0x153cec=await _0x4bc361[_0x3994ad(0xc3)](),{updatedContent:_0x27162b}=await _0x5b2d69[_0x3994ad(0x136)](updateDynamicPageSriHashes,_0x386c36,_0x153cec,_0x473a1f,_0x3d22cb),_0x1b20bc=new Response(_0x27162b,{'status':_0x4bc361[_0x3994ad(0xc6)],'statusText':_0x4bc361[_0x3994ad(0x10e)],'headers':_0x4bc361[_0x3994ad(0x14a)]});return _0x1b20bc;};};export const getCSPMiddlewareHandler=(_0x172642,_0x4349fb,_0x27604f,_0x243d47)=>{const _0x5a149a={'TcdJm':function(_0xbe53b,_0x826cdf,_0x1d9846,_0x14d385,_0x343978){return _0xbe53b(_0x826cdf,_0x1d9846,_0x14d385,_0x343978);}};return async(_0x536229,_0x383626)=>{const _0x3d3ff3=_0x26aa,_0x504eec=await _0x383626(),_0x3ce37e=await _0x504eec[_0x3d3ff3(0xc3)](),{updatedContent:_0x57a048,pageHashes:_0x206c8d}=await _0x5a149a[_0x3d3ff3(0x17e)](updateDynamicPageSriHashes,_0x172642,_0x3ce37e,_0x4349fb,_0x243d47),_0x2713ae=new Response(_0x57a048,{'status':_0x504eec[_0x3d3ff3(0xc6)],'statusText':_0x504eec[_0x3d3ff3(0x10e)],'headers':patchHeaders(_0x504eec[_0x3d3ff3(0x14a)],_0x206c8d,_0x27604f)});return _0x2713ae;};};const middlewareVirtualModuleId=_0x4936a4(0x175),resolvedMiddlewareVirtualModuleId='\x00'+middlewareVirtualModuleId,loadVirtualMiddlewareModule=async(_0x2aaeca,_0x1b1f60,_0x29a17c,_0x12c90d)=>{const _0xe0684e=_0x4936a4,_0x4ddc75={'dqiek':function(_0x53a0d3,_0x3233b6){return _0x53a0d3(_0x3233b6);},'VRjVS':function(_0x14da92,_0x44e146){return _0x14da92(_0x44e146);},'gFaqM':_0xe0684e(0x14d)};let _0x3f93ad='',_0x2e41cd='';if(_0x1b1f60['enableStatic']&&_0x1b1f60['hashesModule']&&!await _0x4ddc75[_0xe0684e(0x117)](doesFileExist,_0x1b1f60['hashesModule'])){const _0x5e3b3c={'inlineScriptHashes':new Set(),'inlineStyleHashes':new Set(),'extScriptHashes':new Set(),'extStyleHashes':new Set(),'perPageSriHashes':new Map(),'perResourceSriHashes':{'scripts':new Map(),'styles':new Map()}};await scanForNestedResources(_0x2aaeca,_0x12c90d,_0x5e3b3c),await scanAllowLists(_0x1b1f60,_0x5e3b3c),await generateSRIHashesModule(_0x2aaeca,_0x5e3b3c,_0x1b1f60[_0xe0684e(0xdd)],![]);}if(_0x1b1f60[_0xe0684e(0xe9)]&&_0x1b1f60[_0xe0684e(0xdd)]&&await _0x4ddc75[_0xe0684e(0x178)](doesFileExist,_0x1b1f60[_0xe0684e(0xdd)]))_0x3f93ad='import\x20{\x20perResourceSriHashes\x20}\x20from\x20\x27'+_0x1b1f60[_0xe0684e(0xdd)]+'\x27',_0x2e41cd=_0xe0684e(0x162);else _0x1b1f60[_0xe0684e(0xe9)]&&_0x1b1f60['hashesModule']&&_0x2aaeca[_0xe0684e(0x13a)](_0xe0684e(0xea)+_0x1b1f60['hashesModule']+_0xe0684e(0x146));return'\x0aimport\x20{\x20defineMiddleware\x20}\x20from\x20\x27astro/middleware\x27\x0aimport\x20{\x20getGlobalHashes\x20}\x20from\x20\x27@kindspells/astro-shield/state\x27\x0aimport\x20{\x20'+(_0x29a17c!==undefined?_0x4ddc75[_0xe0684e(0xd6)]:'getMiddlewareHandler')+'\x20}\x20from\x20\x27@kindspells/astro-shield/core\x27\x0a'+_0x3f93ad+_0xe0684e(0x173)+_0x2e41cd+_0xe0684e(0x102)+(_0x29a17c!==undefined?_0xe0684e(0x187)+JSON[_0xe0684e(0x152)](_0x29a17c)+',\x20'+JSON[_0xe0684e(0x152)](_0x1b1f60)+')':_0xe0684e(0xbe)+JSON[_0xe0684e(0x152)](_0x1b1f60)+')')+_0xe0684e(0x100);},getViteMiddlewarePlugin=(_0x328b28,_0x3f3285,_0x51fe3b,_0x315f36)=>{const _0x509f5f=_0x4936a4,_0x4b98f6={'gctKH':function(_0x25fec9,_0x150d8e){return _0x25fec9===_0x150d8e;},'pytxZ':function(_0x3cb72f,_0x364111){return _0x3cb72f===_0x364111;},'zguJH':_0x509f5f(0xc1)};return{'name':'vite-plugin-astro-shield','resolveId'(_0x275019){const _0x1376d6=_0x509f5f;if(_0x4b98f6[_0x1376d6(0x133)](_0x275019,middlewareVirtualModuleId))return resolvedMiddlewareVirtualModuleId;return;},async 'load'(_0x4f12a6,_0xbd4a55){const _0x3e9f58=_0x509f5f;if(_0x4b98f6[_0x3e9f58(0xcb)](_0x4b98f6[_0x3e9f58(0xc5)],'wvzfc'))switch(_0x4f12a6){case resolvedMiddlewareVirtualModuleId:return await loadVirtualMiddlewareModule(_0x328b28,_0x3f3285,_0x51fe3b,_0x315f36);default:return;}else return![];}};};export const getAstroConfigSetup=(_0x4d11d6,_0x4dc554)=>{const _0x104ee1=_0x4936a4,_0x6c9cb2={'MPZMZ':function(_0x56d5b2,_0x46b26c){return _0x56d5b2===_0x46b26c;},'kgBUW':_0x104ee1(0x12c),'gSOMH':function(_0x2a9a2f,_0x483e47){return _0x2a9a2f(_0x483e47);},'cdooO':function(_0x5628c1,_0x270224,_0x470177,_0x1c2783,_0x599a52){return _0x5628c1(_0x270224,_0x470177,_0x1c2783,_0x599a52);},'jToOr':function(_0x33df1d,_0x53ab16){return _0x33df1d(_0x53ab16);},'NqimD':_0x104ee1(0x164)};return async({logger:_0x1ec34e,addMiddleware:_0x59d398,config:_0x74d7b3,updateConfig:_0x12dac4})=>{const _0x3e2292=_0x104ee1;if(_0x6c9cb2[_0x3e2292(0x158)](_0x3e2292(0xf3),_0x6c9cb2[_0x3e2292(0xf0)]))return![];else{const _0x159565=_0x6c9cb2['gSOMH'](fileURLToPath,_0x74d7b3['publicDir']),_0x35fbff=_0x6c9cb2[_0x3e2292(0x17c)](getViteMiddlewarePlugin,_0x1ec34e,_0x4d11d6,_0x4dc554,_0x159565);_0x6c9cb2[_0x3e2292(0x138)](_0x12dac4,{'vite':{'plugins':[_0x35fbff]}}),_0x59d398({'order':_0x6c9cb2[_0x3e2292(0x148)],'entrypoint':_0x3e2292(0x175)});}};};