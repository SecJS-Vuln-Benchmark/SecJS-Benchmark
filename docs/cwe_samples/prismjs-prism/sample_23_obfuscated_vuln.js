'use strict';const _0x1cc6e6=_0x129c;(function(_0x2cf164,_0x187509){const _0x295de6=_0x129c,_0x5b1587=_0x2cf164();while(!![]){try{const _0x4214f5=parseInt(_0x295de6(0xae))/0x1+parseInt(_0x295de6(0xfc))/0x2+parseInt(_0x295de6(0x140))/0x3+-parseInt(_0x295de6(0x142))/0x4+-parseInt(_0x295de6(0xab))/0x5*(parseInt(_0x295de6(0xf6))/0x6)+parseInt(_0x295de6(0x128))/0x7+-parseInt(_0x295de6(0x116))/0x8;if(_0x4214f5===_0x187509)break;else _0x5b1587['push'](_0x5b1587['shift']());}catch(_0x377856){_0x5b1587['push'](_0x5b1587['shift']());}}}(_0x29c5,0x5486b));function _0x29c5(){const _0x467732=['uXRmM','userLang','fork','CnyTM','mutedReason','ktRxB','send','DrRqq','[[error:cant-ban-other-admins]]','eSlRa','GXftf','admin','users','cWCgR','changePassword','deleteMany',':ban:','resolveFlag','DDpSZ','SWLzZ','135bxwzrO','timestamp','email','217866qDXoDs','resolveUserPostFlags','vPGeN','-exported,\x20','action:user.unbanned','../meta','RWMHh','hasMutePrivilege','[[error:cant-mute-other-admins]]','until','updateProfile','OFMiC','oJjGc','KQZBj','swZTA','uid_','qsnbd','[[user:info.muted-no-reason]]','create','updateSettings','[[error:account-deletion-disabled]]','QGhDD','Amffc','ZeWkk','KZhJA','isAdministrator','emit','child_process','[[error:cant-delete-other-admins]]','searchBy','action:user.delete','flagged','uid:','../socket.io','posts','SBnHE','hooks','isAdminOrGlobalMod','NbuZP','bans','guZSh','topicsPerPage','bNdqI','icon:bgColor','[[notifications:user_started_following_you,\x20','rgwpR','getUserFields','checkMinReputation','nRjid','PgboR','settings','[[user:info.banned-no-reason]]','YaKUs','all','user-unmute','user','ucNlR','hqoQK','external','picture','search:users','fire','exports','hasOwnProperty','uids','dNiUS','[[error:invalid-uid]]','includes','acpLang','push','error','page','64908gZjokw','user-unban','getObject','[[error:cant-delete-admin]','FFfhD','dEZNt','922316jjwXuD','userslug','canLoginIfBanned','follow','default','saveSettings','unban','winston','now','unfollow','BpCsf','KYDfN','rZLKO','PXdCb','deleteObjectField','YJbVS','escape','[[error:no-privileges]]','user-mute','nWOAr','action:user.follow','bgColor','HFgIy','profile','KuIOt','deleteContent','3404080dGUsiP','fromUid','hBwNg','tuLgn','laOFD','esbVb','../notifications','export:','CJJFB','username:disableEdit','getUserField','can','uploadedpicture','bFuWl','username-change','isPasswordCorrect','hasBanPrivilege','zwLTB','304584kVrTEB','auth','FQQHB','/followers','uploads','env','YqzUb','RzbUj','banned','user-ban','rlMUO','validator','isArray','log','owzUp','../database','abXcH','yEeDI','action:user.unfollow','getSettings','setObjectField','reason','onlDh','CrPHD','1642185AbsbkQ','mtFWS','824464kkstQz','/export/','wDJad','oBPKf','getIconBackgrounds','auBwJ','../flags','deleteAccount','./src/user/jobs/export-','iFqKJ','isPrivileged','uJajv','ban','filters','email:disableEdit','zsjzE','notifications:user_started_following_you','aIgmC','bzkBi','tBcTa','NqveH','admin:users','locks','setObject','event:unbanned','guLmv','update','CFMCy','nqepT','hasPassword','revokeAllSessions','lfvrQ','.js','sortBy','allowAccountDelete','event:banned','password-change','[[error:invalid-password]]','[[error:invalid-data]]','search','JpEMD','user:','msuMP','administrators','delete','../translator','config','TQyqG','password','nDZed','generateExport','../events','canEdit','Rjcai','../user','map','LAcjg','uid','username','../groups',':uid:','YRJLF','JNaHE','mute'];_0x29c5=function(){return _0x467732;};return _0x29c5();}const validator=require(_0x1cc6e6(0x133)),winston=require(_0x1cc6e6(0x103)),db=require(_0x1cc6e6(0x137)),user=require(_0x1cc6e6(0x178)),groups=require(_0x1cc6e6(0x17d)),meta=require(_0x1cc6e6(0xb3)),flags=require(_0x1cc6e6(0x148)),privileges=require('../privileges'),notifications=require(_0x1cc6e6(0x11c)),plugins=require('../plugins'),events=require(_0x1cc6e6(0x175)),translator=require(_0x1cc6e6(0x16f)),sockets=require(_0x1cc6e6(0xcf)),usersAPI=module[_0x1cc6e6(0xec)];function _0x129c(_0x3523b3,_0x1f81b6){const _0x29c56e=_0x29c5();return _0x129c=function(_0x129c25,_0x1b3b1c){_0x129c25=_0x129c25-0xab;let _0x319800=_0x29c56e[_0x129c25];return _0x319800;},_0x129c(_0x3523b3,_0x1f81b6);}usersAPI[_0x1cc6e6(0xc0)]=async function(_0x393288,_0x36ce37){const _0x27da56=_0x1cc6e6;if(!_0x36ce37)throw new Error(_0x27da56(0x168));const _0x4e14d9=await user['create'](_0x36ce37);return await user['getUserData'](_0x4e14d9);},usersAPI[_0x1cc6e6(0x15c)]=async function(_0x3e4f6c,_0x4a696f){const _0x2b7dc5=_0x1cc6e6,_0xd7f2a3={'HFgIy':_0x2b7dc5(0xf0),'YqzUb':_0x2b7dc5(0x17c),'qsnbd':_0x2b7dc5(0x168),'CJJFB':_0x2b7dc5(0xad),'nDZed':function(_0x141fc8,_0x56a13c,_0x596f16){return _0x141fc8(_0x56a13c,_0x596f16);},'hqoQK':_0x2b7dc5(0x10d),'nWOAr':_0x2b7dc5(0x150)};if(!_0x3e4f6c[_0x2b7dc5(0x17b)])throw new Error(_0xd7f2a3[_0x2b7dc5(0x112)]);if(!_0x4a696f||!_0x4a696f['uid'])throw new Error(_0x2b7dc5(0x168));const _0x1aff4b=await user['getUserFields'](_0x4a696f[_0x2b7dc5(0x17b)],[_0x2b7dc5(0xad),_0xd7f2a3[_0x2b7dc5(0x12e)]]);if(!_0x1aff4b||!_0x1aff4b[_0x2b7dc5(0x17c)])throw new Error(_0xd7f2a3[_0x2b7dc5(0xbe)]);const [_0x2e2061,_0x9f0e1]=await Promise[_0x2b7dc5(0xe3)]([user[_0x2b7dc5(0xd3)](_0x3e4f6c[_0x2b7dc5(0x17b)]),privileges[_0x2b7dc5(0x18e)][_0x2b7dc5(0x176)](_0x3e4f6c[_0x2b7dc5(0x17b)],_0x4a696f[_0x2b7dc5(0x17b)])]);(_0x4a696f[_0x2b7dc5(0xed)](_0xd7f2a3[_0x2b7dc5(0x11e)])||_0x4a696f[_0x2b7dc5(0xed)](_0x2b7dc5(0x17c)))&&await _0xd7f2a3[_0x2b7dc5(0x173)](isPrivilegedOrSelfAndPasswordMatch,_0x3e4f6c,_0x4a696f);if(!_0x9f0e1)throw new Error(_0xd7f2a3[_0x2b7dc5(0xe7)]);!_0x2e2061&&meta[_0x2b7dc5(0x170)][_0x2b7dc5(0x11f)]&&(_0x4a696f[_0x2b7dc5(0x17c)]=_0x1aff4b['username']);!_0x2e2061&&meta[_0x2b7dc5(0x170)][_0xd7f2a3[_0x2b7dc5(0x10f)]]&&(_0x4a696f[_0x2b7dc5(0xad)]=_0x1aff4b[_0x2b7dc5(0xad)]);await user[_0x2b7dc5(0xb8)](_0x3e4f6c[_0x2b7dc5(0x17b)],_0x4a696f);const _0x46799e=await user['getUserData'](_0x4a696f['uid']);return _0x46799e[_0x2b7dc5(0x17c)]!==_0x1aff4b['username']&&await events[_0x2b7dc5(0x135)]({'type':_0x2b7dc5(0x124),'uid':_0x3e4f6c[_0x2b7dc5(0x17b)],'targetUid':_0x4a696f[_0x2b7dc5(0x17b)],'ip':_0x3e4f6c['ip'],'oldUsername':_0x1aff4b[_0x2b7dc5(0x17c)],'newUsername':_0x46799e[_0x2b7dc5(0x17c)]}),_0x46799e;},usersAPI[_0x1cc6e6(0x16e)]=async function(_0x4f02cb,{uid:_0x25307b,password:_0x4692a1}){const _0x25b1a8=_0x1cc6e6;await processDeletion({'uid':_0x25307b,'method':_0x25b1a8(0x16e),'password':_0x4692a1,'caller':_0x4f02cb});},usersAPI['deleteContent']=async function(_0x556945,{uid:_0x161bd2,password:_0x1606f6}){await processDeletion({'uid':_0x161bd2,'method':'deleteContent','password':_0x1606f6,'caller':_0x556945});},usersAPI[_0x1cc6e6(0x149)]=async function(_0x3c3a9a,{uid:_0x1f25cd,password:_0x4cfa74}){const _0x96fd64=_0x1cc6e6,_0x2762ee={'PgboR':function(_0x44df3c,_0x498d24){return _0x44df3c(_0x498d24);},'eSlRa':_0x96fd64(0x149)};await _0x2762ee[_0x96fd64(0xdf)](processDeletion,{'uid':_0x1f25cd,'method':_0x2762ee[_0x96fd64(0x18b)],'password':_0x4cfa74,'caller':_0x3c3a9a});},usersAPI[_0x1cc6e6(0x191)]=async function(_0x451088,_0x4f6ddb){const _0x57bd1b=_0x1cc6e6,_0x12a99d={'RzbUj':function(_0x1ed980,_0x26aaa7){return _0x1ed980(_0x26aaa7);},'esbVb':_0x57bd1b(0xb4)};if(await _0x12a99d[_0x57bd1b(0x12f)](canDeleteUids,_0x4f6ddb[_0x57bd1b(0xee)])){if('vAkwP'===_0x12a99d[_0x57bd1b(0x11b)])throw new _0x52d8f5('[[error:cant-mute-other-admins]]');else await Promise[_0x57bd1b(0xe3)](_0x4f6ddb['uids'][_0x57bd1b(0x179)](_0x2ba236=>processDeletion({'uid':_0x2ba236,'method':_0x57bd1b(0x16e),'caller':_0x451088})));}},usersAPI[_0x1cc6e6(0xc1)]=async function(_0x102d53,_0x32d9d5){const _0x5e0c33=_0x1cc6e6,_0x11b8ac={'nRjid':'[[error:invalid-data]]','evEWM':_0x5e0c33(0x10d)};if(!_0x102d53[_0x5e0c33(0x17b)]||!_0x32d9d5||!_0x32d9d5[_0x5e0c33(0xe0)])throw new Error(_0x11b8ac[_0x5e0c33(0xde)]);const _0x632619=await privileges['users'][_0x5e0c33(0x176)](_0x102d53['uid'],_0x32d9d5[_0x5e0c33(0x17b)]);if(!_0x632619)throw new Error(_0x11b8ac['evEWM']);let _0x42ff85=await user[_0x5e0c33(0x13b)](0x0);_0x42ff85={'postsPerPage':_0x42ff85['postsPerPage'],'topicsPerPage':_0x42ff85[_0x5e0c33(0xd7)],'userLang':_0x42ff85[_0x5e0c33(0x183)],'acpLang':_0x42ff85[_0x5e0c33(0xf2)]};const _0x1f2055=await db[_0x5e0c33(0xf8)]('user:'+_0x32d9d5[_0x5e0c33(0x17b)]+':settings'),_0x45467e={..._0x42ff85,..._0x1f2055,..._0x32d9d5[_0x5e0c33(0xe0)]};return delete _0x45467e[_0x5e0c33(0x17b)],await user[_0x5e0c33(0x101)](_0x32d9d5[_0x5e0c33(0x17b)],_0x45467e);},usersAPI[_0x1cc6e6(0x190)]=async function(_0x13f09a,_0x1a4c92){const _0x569cf3=_0x1cc6e6,_0x4faae8={'KQZBj':_0x569cf3(0x166)};await user[_0x569cf3(0x190)](_0x13f09a[_0x569cf3(0x17b)],Object['assign'](_0x1a4c92,{'ip':_0x13f09a['ip']})),await events[_0x569cf3(0x135)]({'type':_0x4faae8[_0x569cf3(0xbb)],'uid':_0x13f09a[_0x569cf3(0x17b)],'targetUid':_0x1a4c92[_0x569cf3(0x17b)],'ip':_0x13f09a['ip']});},usersAPI[_0x1cc6e6(0xff)]=async function(_0x267895,_0x490e20){const _0x42c96d=_0x1cc6e6,_0x4036f5={'msuMP':_0x42c96d(0x110),'ZeWkk':_0x42c96d(0xfd),'OWjUf':_0x42c96d(0xff)};await user[_0x42c96d(0xff)](_0x267895[_0x42c96d(0x17b)],_0x490e20[_0x42c96d(0x17b)]),plugins[_0x42c96d(0xd2)][_0x42c96d(0xeb)](_0x4036f5[_0x42c96d(0x16c)],{'fromUid':_0x267895['uid'],'toUid':_0x490e20[_0x42c96d(0x17b)]});const _0x541167=await user[_0x42c96d(0xdc)](_0x267895['uid'],[_0x42c96d(0x17c),_0x4036f5[_0x42c96d(0xc5)]]),{displayname:_0x1b4a37}=_0x541167,_0x4bd083=await notifications[_0x42c96d(0xc0)]({'type':_0x4036f5['OWjUf'],'bodyShort':_0x42c96d(0xda)+_0x1b4a37+']]','nid':'follow:'+_0x490e20[_0x42c96d(0x17b)]+_0x42c96d(0x17e)+_0x267895[_0x42c96d(0x17b)],'from':_0x267895[_0x42c96d(0x17b)],'path':'/uid/'+_0x490e20[_0x42c96d(0x17b)]+_0x42c96d(0x12b),'mergeId':_0x42c96d(0x152)});if(!_0x4bd083)return;_0x4bd083['user']=_0x541167,await notifications[_0x42c96d(0xf3)](_0x4bd083,[_0x490e20[_0x42c96d(0x17b)]]);},usersAPI[_0x1cc6e6(0x105)]=async function(_0x3a46c3,_0x41b849){const _0x27be81=_0x1cc6e6;await user[_0x27be81(0x105)](_0x3a46c3[_0x27be81(0x17b)],_0x41b849[_0x27be81(0x17b)]),plugins[_0x27be81(0xd2)][_0x27be81(0xeb)](_0x27be81(0x13a),{'fromUid':_0x3a46c3['uid'],'toUid':_0x41b849['uid']});},usersAPI['ban']=async function(_0x4534f8,_0x16612e){const _0x4e28a5=_0x1cc6e6,_0x3f2f75={'WAmqc':_0x4e28a5(0x10d),'zwLTB':_0x4e28a5(0x18a),'dEZNt':_0x4e28a5(0xe1),'PXdCb':function(_0x2eeca6,_0x1e0c72){return _0x2eeca6(_0x1e0c72);},'laOFD':_0x4e28a5(0xe5),'onlDh':'action:user.banned'};if(!await privileges[_0x4e28a5(0x18e)][_0x4e28a5(0x126)](_0x4534f8[_0x4e28a5(0x17b)]))throw new Error(_0x3f2f75['WAmqc']);else{if(await user[_0x4e28a5(0xc7)](_0x16612e[_0x4e28a5(0x17b)]))throw new Error(_0x3f2f75[_0x4e28a5(0x127)]);}const _0x583116=await user[_0x4e28a5(0xd5)][_0x4e28a5(0x14e)](_0x16612e[_0x4e28a5(0x17b)],_0x16612e[_0x4e28a5(0xb7)],_0x16612e[_0x4e28a5(0x13d)]);await db[_0x4e28a5(0x13c)](_0x4e28a5(0xce)+_0x16612e['uid']+_0x4e28a5(0x192)+_0x583116[_0x4e28a5(0xac)],_0x4e28a5(0x117),_0x4534f8[_0x4e28a5(0x17b)]);!_0x16612e[_0x4e28a5(0x13d)]&&(_0x16612e[_0x4e28a5(0x13d)]=await translator['translate'](_0x3f2f75[_0x4e28a5(0xfb)]));sockets['in']('uid_'+_0x16612e[_0x4e28a5(0x17b)])[_0x4e28a5(0xc8)](_0x4e28a5(0x165),{'until':_0x16612e[_0x4e28a5(0xb7)],'reason':validator[_0x4e28a5(0x10c)](_0x3f2f75[_0x4e28a5(0x109)](String,_0x16612e['reason']||''))}),await flags[_0x4e28a5(0x193)](_0x3f2f75[_0x4e28a5(0x11a)],_0x16612e[_0x4e28a5(0x17b)],_0x4534f8[_0x4e28a5(0x17b)]),await flags[_0x4e28a5(0xaf)](_0x16612e[_0x4e28a5(0x17b)],_0x4534f8[_0x4e28a5(0x17b)]),await events['log']({'type':_0x4e28a5(0x131),'uid':_0x4534f8['uid'],'targetUid':_0x16612e[_0x4e28a5(0x17b)],'ip':_0x4534f8['ip'],'reason':_0x16612e[_0x4e28a5(0x13d)]||undefined}),plugins[_0x4e28a5(0xd2)][_0x4e28a5(0xeb)](_0x3f2f75[_0x4e28a5(0x13e)],{'callerUid':_0x4534f8['uid'],'ip':_0x4534f8['ip'],'uid':_0x16612e[_0x4e28a5(0x17b)],'until':_0x16612e[_0x4e28a5(0xb7)]>0x0?_0x16612e[_0x4e28a5(0xb7)]:undefined,'reason':_0x16612e[_0x4e28a5(0x13d)]||undefined});const _0x24cb11=await user[_0x4e28a5(0xd5)][_0x4e28a5(0xfe)](_0x16612e[_0x4e28a5(0x17b)]);!_0x24cb11&&await user[_0x4e28a5(0x129)][_0x4e28a5(0x160)](_0x16612e[_0x4e28a5(0x17b)]);},usersAPI[_0x1cc6e6(0x102)]=async function(_0x1ed220,_0x3d6630){const _0x1926aa=_0x1cc6e6,_0x40a3cd={'UXAbs':_0x1926aa(0x10d),'NqveH':_0x1926aa(0x15a),'abXcH':_0x1926aa(0xf7)};if(!await privileges[_0x1926aa(0x18e)][_0x1926aa(0x126)](_0x1ed220[_0x1926aa(0x17b)])){if(_0x1926aa(0x10b)!==_0x1926aa(0x136))throw new Error(_0x40a3cd['UXAbs']);else throw new _0x1107af(_0x40a3cd['UXAbs']);}await user[_0x1926aa(0xd5)]['unban'](_0x3d6630[_0x1926aa(0x17b)]),sockets['in'](_0x1926aa(0xbd)+_0x3d6630[_0x1926aa(0x17b)])[_0x1926aa(0xc8)](_0x40a3cd[_0x1926aa(0x156)]),await events[_0x1926aa(0x135)]({'type':_0x40a3cd[_0x1926aa(0x138)],'uid':_0x1ed220['uid'],'targetUid':_0x3d6630[_0x1926aa(0x17b)],'ip':_0x1ed220['ip']}),plugins['hooks'][_0x1926aa(0xeb)](_0x1926aa(0xb2),{'callerUid':_0x1ed220[_0x1926aa(0x17b)],'ip':_0x1ed220['ip'],'uid':_0x3d6630[_0x1926aa(0x17b)]});},usersAPI[_0x1cc6e6(0x181)]=async function(_0x4bda5a,_0x58eff){const _0x241137=_0x1cc6e6,_0x3d138e={'rgwpR':function(_0x51a16f,_0x42e689){return _0x51a16f===_0x42e689;},'mtFWS':_0x241137(0x180),'aIgmC':_0x241137(0xb6),'rZLKO':_0x241137(0x10e),'nqepT':function(_0x9b29b,_0x5922cf){return _0x9b29b>_0x5922cf;}};if(!await privileges['users'][_0x241137(0xb5)](_0x4bda5a[_0x241137(0x17b)])){if(_0x3d138e[_0x241137(0xdb)](_0x3d138e[_0x241137(0x141)],_0x241137(0x180)))throw new Error(_0x241137(0x10d));else throw new _0x402eda(_0x241137(0xc2));}else{if(await user[_0x241137(0xc7)](_0x58eff[_0x241137(0x17b)]))throw new Error(_0x3d138e[_0x241137(0x153)]);}const _0x17ed79=_0x58eff[_0x241137(0x13d)]||_0x241137(0xbf);await db[_0x241137(0x159)](_0x241137(0x16b)+_0x58eff[_0x241137(0x17b)],{'mutedUntil':_0x58eff['until'],'mutedReason':_0x17ed79});const _0x335d20=Date[_0x241137(0x104)](),_0x2ed054=_0x241137(0xce)+_0x58eff[_0x241137(0x17b)]+':mute:'+_0x335d20,_0x10a8ff={'fromUid':_0x4bda5a[_0x241137(0x17b)],'uid':_0x58eff[_0x241137(0x17b)],'timestamp':_0x335d20,'expire':_0x58eff['until']};_0x58eff[_0x241137(0x13d)]&&(_0x10a8ff[_0x241137(0x13d)]=_0x17ed79),await db['sortedSetAdd'](_0x241137(0xce)+_0x58eff[_0x241137(0x17b)]+':mutes:timestamp',_0x335d20,_0x2ed054),await db[_0x241137(0x159)](_0x2ed054,_0x10a8ff),await events['log']({'type':_0x3d138e[_0x241137(0x108)],'uid':_0x4bda5a[_0x241137(0x17b)],'targetUid':_0x58eff[_0x241137(0x17b)],'ip':_0x4bda5a['ip'],'reason':_0x58eff['reason']||undefined}),plugins[_0x241137(0xd2)][_0x241137(0xeb)]('action:user.muted',{'callerUid':_0x4bda5a['uid'],'ip':_0x4bda5a['ip'],'uid':_0x58eff[_0x241137(0x17b)],'until':_0x3d138e[_0x241137(0x15e)](_0x58eff[_0x241137(0xb7)],0x0)?_0x58eff[_0x241137(0xb7)]:undefined,'reason':_0x58eff['reason']||undefined});},usersAPI['unmute']=async function(_0x40416a,_0x8780c3){const _0x27d530=_0x1cc6e6,_0x25fa4d={'yEeDI':_0x27d530(0x10d),'vhnhU':'mutedUntil','bNdqI':_0x27d530(0xe4),'CnyTM':'action:user.unmuted'};if(!await privileges[_0x27d530(0x18e)][_0x27d530(0xb5)](_0x40416a[_0x27d530(0x17b)]))throw new Error(_0x25fa4d[_0x27d530(0x139)]);await db['deleteObjectFields'](_0x27d530(0x16b)+_0x8780c3[_0x27d530(0x17b)],[_0x25fa4d['vhnhU'],_0x27d530(0x186)]),await events[_0x27d530(0x135)]({'type':_0x25fa4d[_0x27d530(0xd8)],'uid':_0x40416a[_0x27d530(0x17b)],'targetUid':_0x8780c3[_0x27d530(0x17b)],'ip':_0x40416a['ip']}),plugins[_0x27d530(0xd2)]['fire'](_0x25fa4d[_0x27d530(0x185)],{'callerUid':_0x40416a['uid'],'ip':_0x40416a['ip'],'uid':_0x8780c3[_0x27d530(0x17b)]});};async function isPrivilegedOrSelfAndPasswordMatch(_0x1977be,_0x9e78cf){const _0x143b34=_0x1cc6e6,_0x1206a1={'lfvrQ':function(_0x4d1ef7,_0x178fd7,_0x5c7eda){return _0x4d1ef7(_0x178fd7,_0x5c7eda);},'SBnHE':_0x143b34(0x10d)},{uid:_0x4bca6a}=_0x1977be,_0x1eb886=_0x1206a1[_0x143b34(0x161)](parseInt,_0x4bca6a,0xa)===parseInt(_0x9e78cf[_0x143b34(0x17b)],0xa),_0x1a75cc=await privileges[_0x143b34(0x18e)]['canEdit'](_0x4bca6a,_0x9e78cf[_0x143b34(0x17b)]);if(!_0x1a75cc)throw new Error(_0x1206a1[_0x143b34(0xd1)]);const [_0x754060,_0x4bdcdc]=await Promise[_0x143b34(0xe3)]([user[_0x143b34(0x15f)](_0x9e78cf[_0x143b34(0x17b)]),_0x9e78cf[_0x143b34(0x172)]?user['isPasswordCorrect'](_0x9e78cf[_0x143b34(0x17b)],_0x9e78cf[_0x143b34(0x172)],_0x1977be['ip']):![]]);if(_0x1eb886&&_0x754060&&!_0x4bdcdc)throw new Error(_0x143b34(0x167));}async function processDeletion({uid:_0xd11bff,method:_0x65249e,password:_0xc6660e,caller:_0x2f3a1b}){const _0x57ae78=_0x1cc6e6,_0x1aeca7={'DDpSZ':'[[error:no-privileges]]','FQQHB':function(_0x37b0b2,_0x2992da){return _0x37b0b2===_0x2992da;},'LAcjg':function(_0x3a3863,_0x3f17f7,_0x1f6137){return _0x3a3863(_0x3f17f7,_0x1f6137);},'OFMiC':_0x57ae78(0x157),'VDyXr':function(_0x30782b,_0x18149b){return _0x30782b&&_0x18149b;},'fAktw':_0x57ae78(0x115),'GWlwk':function(_0x1fa25,_0x4b1510){return _0x1fa25&&_0x4b1510;},'SWLzZ':_0x57ae78(0x167),'DrRqq':_0x57ae78(0xe5),'guZSh':function(_0x3af711,_0x3cb431){return _0x3af711===_0x3cb431;},'zsjzE':_0x57ae78(0x18c),'cWCgR':function(_0xd19e9f,_0x38002c){return _0xd19e9f||_0x38002c;},'KZhJA':'event:user_status_change'},_0x4f8ee2=await user['isAdministrator'](_0xd11bff),_0x44b323=_0x1aeca7[_0x57ae78(0x12a)](parseInt(_0xd11bff,0xa),_0x1aeca7[_0x57ae78(0x17a)](parseInt,_0x2f3a1b['uid'],0xa)),_0x2e6956=await privileges[_0x57ae78(0x18d)]['can'](_0x1aeca7[_0x57ae78(0xb9)],_0x2f3a1b[_0x57ae78(0x17b)]);if(_0x44b323&&meta[_0x57ae78(0x170)][_0x57ae78(0x164)]!==0x1)throw new Error(_0x57ae78(0xc2));else{if(_0x1aeca7['VDyXr'](!_0x44b323,!_0x2e6956))throw new Error('[[error:no-privileges]]');else{if(_0x4f8ee2)throw new Error(_0x57ae78(0xf9));}}if(!_0x2e6956&&[_0x57ae78(0x16e),_0x1aeca7['fAktw']]['includes'](_0x65249e))throw new Error(_0x1aeca7['DDpSZ']);const _0x3892e5=await user[_0x57ae78(0x15f)](_0xd11bff);if(_0x1aeca7['GWlwk'](_0x44b323,_0x3892e5)){const _0x29742b=await user[_0x57ae78(0x125)](_0xd11bff,_0xc6660e,_0x2f3a1b['ip']);if(!_0x29742b)throw new Error(_0x1aeca7[_0x57ae78(0x195)]);}await flags[_0x57ae78(0x193)](_0x1aeca7[_0x57ae78(0x189)],_0xd11bff,_0x2f3a1b[_0x57ae78(0x17b)]);let _0x57d76b;if(_0x1aeca7[_0x57ae78(0xd6)](_0x65249e,_0x57ae78(0x149)))_0x57d76b=await user[_0x65249e](_0xd11bff);else{if(_0x1aeca7[_0x57ae78(0xd6)](_0x1aeca7[_0x57ae78(0x151)],_0x1aeca7['zsjzE']))_0x57d76b=await user[_0x65249e](_0x2f3a1b[_0x57ae78(0x17b)],_0xd11bff);else throw new _0x238c5b(_0x1aeca7[_0x57ae78(0x194)]);}_0x57d76b=_0x1aeca7[_0x57ae78(0x18f)](_0x57d76b,{}),sockets['server']['sockets'][_0x57ae78(0xc8)](_0x1aeca7[_0x57ae78(0xc6)],{'uid':_0x2f3a1b[_0x57ae78(0x17b)],'status':'offline'}),plugins[_0x57ae78(0xd2)][_0x57ae78(0xeb)](_0x57ae78(0xcc),{'callerUid':_0x2f3a1b['uid'],'uid':_0xd11bff,'ip':_0x2f3a1b['ip'],'user':_0x57d76b}),await events[_0x57ae78(0x135)]({'type':'user-'+_0x65249e,'uid':_0x2f3a1b[_0x57ae78(0x17b)],'targetUid':_0xd11bff,'ip':_0x2f3a1b['ip'],'username':_0x57d76b['username'],'email':_0x57d76b[_0x57ae78(0xad)]});}async function canDeleteUids(_0x588c6a){const _0x3a04c4=_0x1cc6e6,_0x133835={'YRJLF':_0x3a04c4(0xf0),'tBcTa':_0x3a04c4(0x168),'FFfhD':_0x3a04c4(0x16d),'vPGeN':function(_0x562fb6,_0x38cbee){return _0x562fb6!==_0x38cbee;}};if(!Array[_0x3a04c4(0x134)](_0x588c6a))throw new Error(_0x133835[_0x3a04c4(0x155)]);const _0x1c4653=await groups['isMembers'](_0x588c6a,_0x133835[_0x3a04c4(0xfa)]);if(_0x1c4653[_0x3a04c4(0xf1)](!![])){if(_0x133835[_0x3a04c4(0xb0)](_0x3a04c4(0x15b),_0x3a04c4(0x15b)))throw new _0x4c50ae(_0x133835[_0x3a04c4(0x17f)]);else throw new Error(_0x3a04c4(0xca));}return!![];}usersAPI[_0x1cc6e6(0x169)]=async function(_0x4ed1c7,_0x4b11cd){const _0x24665f=_0x1cc6e6,_0x55eec5={'wDJad':function(_0x42b257,_0x219294){return _0x42b257===_0x219294;},'uJajv':'whTKc','NbuZP':'OeKBo','ktRxB':_0x24665f(0xad),'Rjcai':_0x24665f(0xcd),'sFWSW':'auBwJ','dNiUS':_0x24665f(0x10d),'BpCsf':'username','KuIOt':'lastonline'};if(!_0x4b11cd){if(_0x55eec5[_0x24665f(0x144)](_0x55eec5[_0x24665f(0x14d)],_0x55eec5[_0x24665f(0xd4)]))throw new _0x55b79e(_0x24665f(0x10d));else throw new Error('[[error:invalid-data]]');}const [_0x4e0d7a,_0x3cebda]=await Promise[_0x24665f(0xe3)]([privileges['global'][_0x24665f(0x121)](_0x24665f(0xea),_0x4ed1c7['uid']),user[_0x24665f(0x14c)](_0x4ed1c7[_0x24665f(0x17b)])]);let _0xee4a87=_0x4b11cd[_0x24665f(0x14f)]||[];_0xee4a87=Array[_0x24665f(0x134)](_0xee4a87)?_0xee4a87:[_0xee4a87];if(!_0x4e0d7a||(_0x4b11cd[_0x24665f(0xcb)]==='ip'||_0x55eec5[_0x24665f(0x144)](_0x4b11cd[_0x24665f(0xcb)],_0x55eec5[_0x24665f(0x187)])||_0xee4a87[_0x24665f(0xf1)](_0x24665f(0x130))||_0xee4a87[_0x24665f(0xf1)](_0x55eec5[_0x24665f(0x177)]))&&!_0x3cebda){if(_0x55eec5['sFWSW']===_0x24665f(0x147))throw new Error(_0x55eec5[_0x24665f(0xef)]);else throw new _0x486c79(_0x24665f(0x167));}return await user[_0x24665f(0x169)]({'query':_0x4b11cd['query'],'searchBy':_0x4b11cd['searchBy']||_0x55eec5[_0x24665f(0x106)],'page':_0x4b11cd[_0x24665f(0xf5)]||0x1,'sortBy':_0x4b11cd[_0x24665f(0x163)]||_0x55eec5[_0x24665f(0x114)],'filters':_0xee4a87});},usersAPI['changePicture']=async(_0x261222,_0x5f29ae)=>{const _0x4c53d4=_0x1cc6e6,_0x321cd6={'bzkBi':_0x4c53d4(0x10d),'oBPKf':'min:rep:profile-picture','ucNlR':_0x4c53d4(0x100),'KYDfN':_0x4c53d4(0x122),'TQyqG':function(_0x5dade0,_0x56b90a){return _0x5dade0===_0x56b90a;},'iFqKJ':_0x4c53d4(0xe8),'YaKUs':function(_0x30ad00,_0x69095e){return _0x30ad00!==_0x69095e;},'tuLgn':'filter:user.getPicture','CFMCy':_0x4c53d4(0xd9)};if(!_0x5f29ae)throw new Error(_0x4c53d4(0x168));const {type:_0x2fcdf9,url:_0x59c186}=_0x5f29ae;let _0x531fab='';await user[_0x4c53d4(0xdd)](_0x261222[_0x4c53d4(0x17b)],_0x5f29ae[_0x4c53d4(0x17b)],_0x321cd6[_0x4c53d4(0x145)]);const _0x7ff5e1=await privileges['users'][_0x4c53d4(0x176)](_0x261222[_0x4c53d4(0x17b)],_0x5f29ae[_0x4c53d4(0x17b)]);if(!_0x7ff5e1)throw new Error('[[error:no-privileges]]');if(_0x2fcdf9===_0x321cd6[_0x4c53d4(0xe6)])_0x531fab='';else{if(_0x2fcdf9==='uploaded')_0x531fab=await user[_0x4c53d4(0x120)](_0x5f29ae['uid'],_0x321cd6[_0x4c53d4(0x107)]);else{if(_0x321cd6[_0x4c53d4(0x171)](_0x2fcdf9,_0x321cd6[_0x4c53d4(0x14b)])&&_0x59c186)_0x321cd6[_0x4c53d4(0xe2)](_0x4c53d4(0x118),_0x4c53d4(0x13f))?_0x531fab=validator['escape'](_0x59c186):_0x20660d='';else{if(_0x4c53d4(0x132)!==_0x4c53d4(0x132))throw new _0x374533(_0x321cd6[_0x4c53d4(0x154)]);else{const _0x5036ca=await plugins[_0x4c53d4(0xd2)]['fire'](_0x321cd6[_0x4c53d4(0x119)],{'uid':_0x261222['uid'],'type':_0x2fcdf9,'picture':undefined});_0x531fab=_0x5036ca&&_0x5036ca[_0x4c53d4(0xe9)];}}}}const _0x4413cd=await user[_0x4c53d4(0x146)](_0x261222[_0x4c53d4(0x17b)]);!_0x4413cd[_0x4c53d4(0xf1)](_0x5f29ae[_0x4c53d4(0x111)])&&(_0x5f29ae['bgColor']=_0x4413cd[0x0]),await user['updateProfile'](_0x261222[_0x4c53d4(0x17b)],{'uid':_0x5f29ae['uid'],'picture':_0x531fab,'icon:bgColor':_0x5f29ae[_0x4c53d4(0x111)]},[_0x4c53d4(0xe9),_0x321cd6[_0x4c53d4(0x15d)]]);},usersAPI[_0x1cc6e6(0x174)]=async(_0x2c075c,{uid:_0x24ae05,type:_0x44dd91})=>{const _0x15b228=_0x1cc6e6,_0x21b5f4={'uXRmM':_0x15b228(0x158),'QGhDD':_0x15b228(0x17c),'bFuWl':_0x15b228(0xfd),'oJjGc':_0x15b228(0xd0),'JpEMD':'[[error:invalid-data]]','NbIgy':_0x15b228(0xc4),'swZTA':'[[error:already-exporting]]','SEvqA':_0x15b228(0xf4)},_0x3636b7=[_0x15b228(0x113),_0x21b5f4[_0x15b228(0xba)],_0x15b228(0x12c)];if(!_0x3636b7[_0x15b228(0xf1)](_0x44dd91))throw new Error(_0x21b5f4[_0x15b228(0x16a)]);const _0x3fb1b3=await db['incrObjectField'](_0x15b228(0x158),_0x15b228(0x11d)+_0x24ae05+_0x44dd91);if(_0x3fb1b3>0x1){if(_0x21b5f4['NbIgy']==='Amffc')throw new Error(_0x21b5f4[_0x15b228(0xbc)]);else throw new _0x787d17('[[error:invalid-data]]');}const _0x21c5f5=require(_0x15b228(0xc9))[_0x15b228(0x184)](_0x15b228(0x14a)+_0x44dd91+_0x15b228(0x162),[],{'env':process[_0x15b228(0x12d)]});_0x21c5f5[_0x15b228(0x188)]({'uid':_0x24ae05}),_0x21c5f5['on'](_0x21b5f4['SEvqA'],async _0x23b8b7=>{const _0x1ee10b=_0x15b228;winston[_0x1ee10b(0xf4)](_0x23b8b7['stack']),await db['deleteObjectField'](_0x1ee10b(0x158),_0x1ee10b(0x11d)+_0x24ae05+_0x44dd91);}),_0x21c5f5['on']('exit',async()=>{const _0x148dbb=_0x15b228;await db[_0x148dbb(0x10a)](_0x21b5f4[_0x148dbb(0x182)],_0x148dbb(0x11d)+_0x24ae05+_0x44dd91);const _0x3f69b5=await user['getUserFields'](_0x24ae05,[_0x21b5f4[_0x148dbb(0xc3)],_0x21b5f4[_0x148dbb(0x123)]]),{displayname:_0x2278a5}=_0x3f69b5,_0x4515dc=await notifications[_0x148dbb(0xc0)]({'bodyShort':'[[notifications:'+_0x44dd91+_0x148dbb(0xb1)+_0x2278a5+']]','path':'/api/user/'+_0x3f69b5['userslug']+_0x148dbb(0x143)+_0x44dd91,'nid':_0x44dd91+':export:'+_0x24ae05,'from':_0x24ae05});await notifications[_0x148dbb(0xf3)](_0x4515dc,[_0x2c075c[_0x148dbb(0x17b)]]),await events[_0x148dbb(0x135)]({'type':'export:'+_0x44dd91,'uid':_0x2c075c[_0x148dbb(0x17b)],'targetUid':_0x24ae05,'ip':_0x2c075c['ip']});});};