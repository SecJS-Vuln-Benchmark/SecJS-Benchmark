const _0x2987cc=_0x3a0e;(function(_0x1a5770,_0x260a9f){const _0x3aff99=_0x3a0e,_0x508371=_0x1a5770();while(!![]){try{const _0x7dc384=-parseInt(_0x3aff99(0xfa))/0x1+-parseInt(_0x3aff99(0x131))/0x2+parseInt(_0x3aff99(0x11f))/0x3+parseInt(_0x3aff99(0x138))/0x4*(parseInt(_0x3aff99(0x10b))/0x5)+-parseInt(_0x3aff99(0x12e))/0x6*(-parseInt(_0x3aff99(0xf9))/0x7)+parseInt(_0x3aff99(0x154))/0x8+-parseInt(_0x3aff99(0xec))/0x9;if(_0x7dc384===_0x260a9f)break;else _0x508371['push'](_0x508371['shift']());}catch(_0x461a01){_0x508371['push'](_0x508371['shift']());}}}(_0x392d,0x82315));const fs=require('fs'),http=require(_0x2987cc(0x119)),path=require(_0x2987cc(0x14e)),WebSocket=require('ws'),express=require(_0x2987cc(0xe9)),pty=require(_0x2987cc(0x15f)),hbs=require('hbs'),dotenv=require(_0x2987cc(0x15e)),Tokens=require(_0x2987cc(0xdc)),url=require(_0x2987cc(0xd8)),yaml=require('js-yaml'),glob=require(_0x2987cc(0xff)),port=0xbb8,host_path_rx=_0x2987cc(0xd3),helpers=require(_0x2987cc(0xc4));dotenv[_0x2987cc(0x12a)]({'path':_0x2987cc(0x160)});process[_0x2987cc(0x100)]['NODE_ENV']===_0x2987cc(0x13a)&&dotenv['config']({'path':_0x2987cc(0xeb)});fs[_0x2987cc(0x126)](_0x2987cc(0x12d))&&(console[_0x2987cc(0xce)](_0x2987cc(0x10c)),dotenv[_0x2987cc(0x12a)]({'path':_0x2987cc(0x12d)}));var color_themes={'dark':[],'light':[]};glob[_0x2987cc(0xfe)]('./color_themes/light/*')[_0x2987cc(0xe8)](_0x370650=>color_themes[_0x2987cc(0xf8)][_0x2987cc(0xd4)](require(path[_0x2987cc(0x133)](_0x370650)))),glob[_0x2987cc(0xfe)]('./color_themes/dark/*')[_0x2987cc(0xe8)](_0x2160e5=>color_themes[_0x2987cc(0xe3)]['push'](require(path['resolve'](_0x2160e5)))),color_themes[_0x2987cc(0x104)]=JSON[_0x2987cc(0x11e)]([...color_themes[_0x2987cc(0xf8)],...color_themes[_0x2987cc(0xe3)]]);const tokens=new Tokens({}),secret=tokens[_0x2987cc(0xf7)]();var router=express[_0x2987cc(0x110)]();router[_0x2987cc(0x116)](['/',_0x2987cc(0x120)],function(_0x2d8ce7,_0x2a8c3a){const _0xdc78da=_0x2987cc,_0x5c7d6b={'GIiQf':function(_0x8c700c,_0x13aff4){return _0x8c700c+_0x13aff4;}};_0x2a8c3a[_0xdc78da(0x137)](_0x5c7d6b[_0xdc78da(0x12c)](_0x2d8ce7[_0xdc78da(0x140)],_0xdc78da(0x121)));}),router['get'](_0x2987cc(0xe5),function(_0x4a457f,_0x1e3c31){const _0x53ec8e=_0x2987cc,_0x3f6cb6={'NbWFe':_0x53ec8e(0x130),'VWXaP':_0x53ec8e(0x11c)};var _0x333609,_0x23c907;[_0x333609,_0x23c907]=host_and_dir_from_url(_0x4a457f['url']),_0x1e3c31['render'](_0x3f6cb6[_0x53ec8e(0x108)],{'baseURI':_0x4a457f[_0x53ec8e(0x140)],'csrfToken':tokens[_0x53ec8e(0xed)](secret),'host':_0x333609,'dir':_0x23c907,'colorThemes':color_themes,'siteTitle':process[_0x53ec8e(0x100)][_0x53ec8e(0x107)]||_0x3f6cb6[_0x53ec8e(0x128)]});}),router[_0x2987cc(0x125)](express[_0x2987cc(0xcb)](path[_0x2987cc(0x129)](__dirname,_0x2987cc(0xe1))));var app=express();function _0x392d(){const _0x3aed56=['NCEKl','from','cfBJR','input','startedAt','ping','teqPy','connection','x-forwarded-proto','isAlive','UORwn','WqYrv','path','The\x20websocket\x20will\x20not\x20receive\x20any\x20more\x20messages.\x20Killing\x20the\x20terminal\x20connection','gwCjC','definedHosts','end','split','648576iWzZme','appEx','verify','startsWith','Opened\x20terminal:\x20','kTrwi','bSrFQ','logger','QkrrD','default','dotenv','node-pty','.env.local','replace','xterm-16color','en_US.UTF-8','PsYro','empKG','./utils/helpers','IfOoY','handleUpgrade','cols','VWREZ','Invalid\x20Origin.','OOD_SHELL_ORIGIN_CHECK','static','HsnDx','mlAkG','warn','OOD_SSHHOST_ALLOWLIST','hosts','fFuQA','cgpjY','/ssh/([^\x5c/\x5c?]+)([^\x5c?]+)?(\x5c?.*)?$','push','OOD_SHELL_MAX_DURATION_MS','flush','lastActivity','url','\x20previous\x20duplicated\x20messages','set','BhvbQ','csrf','close','XEOfI','resize','Send\x20error:\x20','public','WnMEb','dark','No\x20clusters\x20defined.','/ssh*','terminate','QsoYG','forEach','express','length','/etc/ood/config/apps/shell/env','3459411BLJgpJ','create','GlnwY','TcJvm','VvWNg','CLOSING','kill','://','x-forwarded-host','views','XlwLb','secretSync','light','546wvQmAP','558426hUbtWv','Closed\x20terminal:\x20','pid','write','sync','glob','env','rlIHU','Listening\x20on\x20','YgkYE','json_array','qOVOB','ewOEe','OOD_DASHBOARD_TITLE','NbWFe','message','count','50290vmYdZi','[DEPRECATION]\x20The\x20file\x20\x27.env\x27\x20is\x20being\x20deprecated.\x20Please\x20move\x20this\x20file\x20to\x20\x27/etc/ood/config/apps/shell/env\x27.','view\x20engine','emit','ssh','Router','VbZfo','send','\x27\x20;\x20exec\x20${SHELL}\x20-l','parse','match','get','pfCAh','Kcegs','http','PPaXX','OOD_SHELL_PING_PONG','Open\x20OnDemand','readyState','stringify','3148008VTKdTs','/ssh','/ssh/default','mekeF','wkpFE','now','use','existsSync','upgrade','VWXaP','join','config','log','GIiQf','.env','12966dhCzbG','createServer','index','1074020foksoa','OOD_SHELL_INACTIVE_TIMEOUT_MS','resolve','OOD_SSH_WRAPPER','Bad\x20CSRF\x20Token.','dgGSf','redirect','284STLjDv','hbs','production','onExit','iofwB','\x22\x20not\x20specified\x20in\x20allowlist\x20or\x20cluster\x20configs.','bqehi','FViXV','baseUrl','Host\x20\x22'];_0x392d=function(){return _0x3aed56;};return _0x392d();}app[_0x2987cc(0xda)](_0x2987cc(0x10d),_0x2987cc(0x139)),app[_0x2987cc(0xda)](_0x2987cc(0xf5),path[_0x2987cc(0x129)](__dirname,_0x2987cc(0xf5))),app[_0x2987cc(0x125)](process[_0x2987cc(0x100)]['PASSENGER_BASE_URI']||'/',router);const server=new http[(_0x2987cc(0x12f))](app),wss=new WebSocket['Server']({'noServer':!![]});function _0x3a0e(_0x5099bb,_0x4247d2){const _0x392d04=_0x392d();return _0x3a0e=function(_0x3a0e6,_0xb27134){_0x3a0e6=_0x3a0e6-0xbf;let _0x3b7dc3=_0x392d04[_0x3a0e6];return _0x3b7dc3;},_0x3a0e(_0x5099bb,_0x4247d2);}let host_allowlist=[];process[_0x2987cc(0x100)][_0x2987cc(0xcf)]&&(host_allowlist=Array[_0x2987cc(0x143)](new Set(process[_0x2987cc(0x100)][_0x2987cc(0xcf)][_0x2987cc(0x153)](':'))));const inactiveTimeout=process[_0x2987cc(0x100)][_0x2987cc(0x132)]||0x493e0,maxShellTime=process['env'][_0x2987cc(0xd5)]||0x36ee80,pingPongEnabled=process[_0x2987cc(0x100)][_0x2987cc(0x11b)]?!![]:![];let hosts=helpers[_0x2987cc(0x151)](),default_sshhost=hosts['default'];hosts[_0x2987cc(0xd0)][_0x2987cc(0xe8)](_0x3928cf=>{const _0x1c826b=_0x2987cc;host_allowlist[_0x1c826b(0xd4)](_0x3928cf);});function host_and_dir_from_url(_0x12cdf5){const _0x296855=_0x2987cc,_0x153029={'GeBdh':function(_0x1a4f79,_0x38c1e0){return _0x1a4f79-_0x38c1e0;},'UORwn':'default'};let _0x7647f9=_0x12cdf5[_0x296855(0x115)](host_path_rx),_0x14fde2=null,_0x273b49=null;if(_0x7647f9){if(_0x296855(0xcc)===_0x296855(0xcc))_0x14fde2=_0x7647f9[0x1]===_0x153029[_0x296855(0x14c)]?default_sshhost:_0x7647f9[0x1],_0x273b49=_0x7647f9[0x2]?decodeURIComponent(_0x7647f9[0x2]):null;else{const _0x328563=_0x88ff79[_0x296855(0x124)]()-_0x3b1066['startedAt'],_0x2c6042=_0x153029['GeBdh'](_0x522bc3[_0x296855(0x124)](),_0x1ab0e6[_0x296855(0xd7)]);if(_0x4b9a3d[_0x296855(0x14b)]===![]||_0x2c6042>_0x6cbd22||_0x328563>_0x34c988)return _0x368432[_0x296855(0xe6)]();_0x43b62a&&(_0x286008[_0x296855(0x14b)]=![],_0x27f5ba[_0x296855(0x147)]());}}return[_0x14fde2,_0x273b49];}function custom_server_origin(_0x28c1bf=null){const _0x55482f=_0x2987cc,_0x17489e={'TcJvm':_0x55482f(0x102),'VTkxu':'http','LyLcJ':'DlFyZ'};var _0x3f7322=null;return process['env'][_0x55482f(0xca)]?process[_0x55482f(0x100)]['OOD_SHELL_ORIGIN_CHECK'][_0x55482f(0x157)](_0x17489e['VTkxu'])&&('DlFyZ'!==_0x17489e['LyLcJ']?_0x166eb5[_0x55482f(0x12b)](_0x17489e[_0x55482f(0xef)]+_0x527920):_0x3f7322=process['env'][_0x55482f(0xca)]):_0x3f7322=_0x28c1bf,_0x3f7322;}function default_server_origin(_0x1ccfcc){const _0xb9d8ef=_0x2987cc,_0xddacef={'VbZfo':function(_0x1d8556,_0x42c1da){return _0x1d8556+_0x42c1da;}};var _0x253eb2=null;return _0x1ccfcc[_0xb9d8ef(0x14a)]&&_0x1ccfcc[_0xb9d8ef(0xf4)]&&(_0x253eb2=_0xddacef[_0xb9d8ef(0x111)](_0x1ccfcc[_0xb9d8ef(0x14a)],_0xb9d8ef(0xf3))+_0x1ccfcc[_0xb9d8ef(0xf4)]),_0x253eb2;}function detect_auth_error(_0x1973b1,_0x59c7d6,_0x30ed3e,_0x5059c2){const _0x366cb8=_0x2987cc,_0x28c207={'PPaXX':_0x366cb8(0xe4),'kTrwi':_0x366cb8(0x119),'VWREZ':function(_0x1dd44c,_0x1f6baa){return _0x1dd44c!==_0x1f6baa;},'bFoTo':_0x366cb8(0xc9)};if(host_allowlist[_0x366cb8(0xea)]==0x0)return _0x28c207[_0x366cb8(0x11a)];else{if(_0x59c7d6&&_0x59c7d6[_0x366cb8(0x157)](_0x28c207[_0x366cb8(0x159)])&&_0x30ed3e&&_0x28c207[_0x366cb8(0xc8)](_0x59c7d6,_0x30ed3e))return _0x28c207['bFoTo'];else{if(!tokens[_0x366cb8(0x156)](secret,_0x1973b1))return _0x366cb8(0x135);else return!helpers['hostInAllowList'](host_allowlist,_0x5059c2)?_0x366cb8(0x141)+_0x5059c2+_0x366cb8(0x13d):null;}}}function createLogger(){const _0xb379b4=_0x2987cc,_0x19555f={'NCEKl':function(_0xe31cb5,_0x49deb0){return _0xe31cb5-_0x49deb0;},'gwCjC':_0xb379b4(0xf6),'Kcegs':function(_0x253635){return _0x253635();}},_0x518cf3=0x1388,_0xb92100=[];let _0x51ce67=0x0,_0x25d0f6;const _0x6bc87b=(_0x17eadd=![])=>{const _0x367a54=_0xb379b4,_0x35d835=Date['now']();clearTimeout(_0x25d0f6);if(_0x19555f[_0x367a54(0x142)](_0x35d835,_0x51ce67)>_0x518cf3||_0x17eadd){for(const {message:_0x1c0fae,count:_0x1c7e7a}of _0xb92100){console[_0x367a54(0x12b)](_0x1c0fae),_0x1c7e7a>0x1&&console['log']('Skipped\x20'+(_0x1c7e7a-0x1)+_0x367a54(0xd9));}_0xb92100['length']=0x0,_0x51ce67=_0x35d835;}else _0xb92100[_0x367a54(0xea)]>0x0&&(_0x25d0f6=setTimeout(_0x6bc87b,_0x51ce67+_0x518cf3-_0x35d835));};return{'log':_0x57aafa=>{const _0x463f5e=_0xb379b4;if(_0x19555f[_0x463f5e(0x150)]!==_0x19555f[_0x463f5e(0x150)])_0x580309[_0x463f5e(0xfd)](_0x29f818[_0x463f5e(0x145)]),this[_0x463f5e(0xd7)]=_0x45b05d[_0x463f5e(0x124)]();else{const _0x1f7fd6=_0xb92100['at'](-0x1);_0x1f7fd6&&_0x1f7fd6[_0x463f5e(0x109)]==_0x57aafa?_0x1f7fd6[_0x463f5e(0x10a)]++:_0xb92100[_0x463f5e(0xd4)]({'message':_0x57aafa,'count':0x1}),_0x19555f[_0x463f5e(0x118)](_0x6bc87b);}},'flush':()=>_0x6bc87b(!![])};};wss['on']('connection',function connection(_0x36c028,_0x4f37ec){const _0x53b412=_0x2987cc,_0x2ffc39={'wkpFE':function(_0x4b21a3,_0xb62363){return _0x4b21a3+_0xb62363;},'FViXV':_0x53b412(0xfb),'bqehi':function(_0x4278b4,_0x2af45e){return _0x4278b4===_0x2af45e;},'rlIHU':function(_0x3761d7,_0x5ef45e){return _0x3761d7(_0x5ef45e);},'mekeF':function(_0x25cbe9,_0x19ea9d){return _0x25cbe9===_0x19ea9d;},'empKG':_0x53b412(0x15d),'dgGSf':_0x53b412(0x10f),'YgkYE':function(_0x4856c1){return _0x4856c1();},'zEPaP':function(_0x970cd8,_0x314546,_0x4d32fa,_0x547374,_0x18f70a){return _0x970cd8(_0x314546,_0x4d32fa,_0x547374,_0x18f70a);},'iofwB':function(_0x2e9b5d,_0x23c4bf){return _0x2e9b5d!==_0x23c4bf;},'bSrFQ':_0x53b412(0xd2),'qOVOB':_0x53b412(0xdb),'XEOfI':_0x53b412(0x113),'bwdqs':_0x53b412(0xc1),'WqYrv':_0x53b412(0xc0),'QkrrD':_0x53b412(0x158),'WnMEb':_0x53b412(0x109)};var _0x5f3b83,_0xc8e399,_0x429ded,_0x22331b,_0x3f3be5=process[_0x53b412(0x100)][_0x53b412(0x134)]||_0x2ffc39[_0x53b412(0x136)];_0x36c028['isAlive']=!![],_0x36c028[_0x53b412(0x146)]=Date[_0x53b412(0x124)](),_0x36c028['lastActivity']=Date['now'](),_0x36c028[_0x53b412(0x15b)]=_0x2ffc39[_0x53b412(0x103)](createLogger),console['log']('Connection\x20established'),[_0x22331b,_0x5f3b83]=_0x2ffc39['rlIHU'](host_and_dir_from_url,_0x4f37ec[_0x53b412(0xd8)]),token=_0x4f37ec[_0x53b412(0xd8)][_0x53b412(0x115)](/csrf=([^&]*)/)[0x1],authError=_0x2ffc39['zEPaP'](detect_auth_error,token,_0x4f37ec['origin'],_0x2ffc39['rlIHU'](custom_server_origin,default_server_origin(_0x4f37ec)),_0x22331b);if(authError)_0x2ffc39['iofwB'](_0x2ffc39[_0x53b412(0x15a)],'qWrgK')?_0x36c028[_0x53b412(0xdd)](0xc4a,authError):(_0x3ee0d9[_0x53b412(0x152)](),this[_0x53b412(0x14b)]=![],_0x27fcec[_0x53b412(0x12b)](_0x2ffc39[_0x53b412(0x123)](_0x2ffc39['FViXV'],_0x72cbff[_0x53b412(0xfc)])),_0x33e96e[_0x53b412(0x15b)]['flush']());else{if(_0x2ffc39[_0x53b412(0x13c)](_0x53b412(0xcd),_0x2ffc39[_0x53b412(0x105)]))_0x429ded=_0x5f3b83?[_0x22331b,'-t','cd\x20\x27'+_0x5f3b83[_0x53b412(0xbf)](/\'/g,'\x27\x5c\x27\x27')+_0x2ffc39[_0x53b412(0xde)]]:[_0x22331b],process[_0x53b412(0x100)]['LANG']=_0x2ffc39['bwdqs'],_0xc8e399=pty['spawn'](_0x3f3be5,_0x429ded,{'name':_0x2ffc39[_0x53b412(0x14d)],'cols':0x50,'rows':0x1e}),console[_0x53b412(0x12b)](_0x2ffc39[_0x53b412(0x15c)]+_0xc8e399[_0x53b412(0xfc)]),_0xc8e399['onData'](function(_0x3304dc){const _0x11ecd1=_0x53b412,_0x368d10={'fFuQA':function(_0x21dced,_0x4f919c){const _0x7c4a4d=_0x3a0e;return _0x2ffc39[_0x7c4a4d(0x13e)](_0x21dced,_0x4f919c);},'teqPy':function(_0x5ca0d4,_0x154b01){return _0x5ca0d4+_0x154b01;}};_0x36c028[_0x11ecd1(0x112)](_0x3304dc,function(_0x48da70){const _0xb3ae88=_0x11ecd1;if(_0x36c028[_0xb3ae88(0x11d)]===WebSocket['CLOSED']||_0x368d10[_0xb3ae88(0xd1)](_0x36c028[_0xb3ae88(0x11d)],WebSocket[_0xb3ae88(0xf1)]))_0x36c028['logger'][_0xb3ae88(0x12b)](_0xb3ae88(0x14f)),_0xc8e399[_0xb3ae88(0xf2)]();else _0x48da70&&_0x36c028['logger'][_0xb3ae88(0x12b)](_0x368d10[_0xb3ae88(0x148)](_0xb3ae88(0xe0),_0x48da70[_0xb3ae88(0x109)]));}),_0x36c028[_0x11ecd1(0xd7)]=Date[_0x11ecd1(0x124)]();}),_0xc8e399[_0x53b412(0x13b)](function(_0x4fc1bd){const _0x2ef02f=_0x53b412;_0x36c028[_0x2ef02f(0xdd)]();}),_0x36c028['on'](_0x2ffc39[_0x53b412(0xe2)],function(_0x373cf8){const _0xa72fe7=_0x53b412;_0x373cf8=JSON[_0xa72fe7(0x114)](_0x373cf8);_0x373cf8[_0xa72fe7(0x145)]&&(_0xc8e399['write'](_0x373cf8[_0xa72fe7(0x145)]),this['lastActivity']=Date[_0xa72fe7(0x124)]());if(_0x373cf8[_0xa72fe7(0xdf)])_0xc8e399['resize'](parseInt(_0x373cf8[_0xa72fe7(0xdf)][_0xa72fe7(0xc7)]),_0x2ffc39[_0xa72fe7(0x101)](parseInt,_0x373cf8['resize']['rows']));}),_0x36c028['on'](_0x53b412(0xdd),function(){const _0x10f75b=_0x53b412;_0xc8e399[_0x10f75b(0x152)](),this[_0x10f75b(0x14b)]=![],console[_0x10f75b(0x12b)](_0x2ffc39[_0x10f75b(0x123)](_0x2ffc39[_0x10f75b(0x13f)],_0xc8e399[_0x10f75b(0xfc)])),_0x36c028['logger'][_0x10f75b(0xd6)]();}),_0x36c028['on']('pong',function(){this['isAlive']=!![];});else{let _0x1003a8=_0x59ae36[_0x53b412(0x115)](_0x14ff26),_0x1e6900=null,_0x50909e=null;return _0x1003a8&&(_0x1e6900=_0x2ffc39[_0x53b412(0x122)](_0x1003a8[0x1],_0x2ffc39[_0x53b412(0xc3)])?_0x207aa1:_0x1003a8[0x1],_0x50909e=_0x1003a8[0x2]?_0x2b0f63(_0x1003a8[0x2]):null),[_0x1e6900,_0x50909e];}}});const interval=setInterval(function ping(){const _0x3da67a=_0x2987cc,_0x7afc07={'ewOEe':_0x3da67a(0xe4),'VvWNg':function(_0x121e75,_0x5a4b27){return _0x121e75-_0x5a4b27;},'pfCAh':function(_0x1a9c81,_0x3b93ef){return _0x1a9c81-_0x3b93ef;},'PsYro':function(_0x508897,_0xc0e4c1){return _0x508897>_0xc0e4c1;},'appEx':function(_0x43009a,_0x3b2150){return _0x43009a===_0x3b2150;},'cfBJR':_0x3da67a(0xe7)};wss['clients'][_0x3da67a(0xe8)](function _0x275421(_0x7f99cd){const _0x13b73a=_0x3da67a,_0x51d111=_0x7afc07[_0x13b73a(0xf0)](Date['now'](),_0x7f99cd[_0x13b73a(0x146)]),_0x1b155b=_0x7afc07[_0x13b73a(0x117)](Date[_0x13b73a(0x124)](),_0x7f99cd[_0x13b73a(0xd7)]);if(_0x7f99cd[_0x13b73a(0x14b)]===![]||_0x7afc07[_0x13b73a(0xc2)](_0x1b155b,inactiveTimeout)||_0x51d111>maxShellTime)return _0x7f99cd[_0x13b73a(0xe6)]();if(pingPongEnabled){if(_0x7afc07[_0x13b73a(0x155)](_0x7afc07[_0x13b73a(0x144)],_0x13b73a(0xc5)))return _0x7afc07[_0x13b73a(0x106)];else _0x7f99cd['isAlive']=![],_0x7f99cd[_0x13b73a(0x147)]();}});},0x7530);wss['on'](_0x2987cc(0xdd),function close(){const _0x40a740={'oQKvh':function(_0x391744,_0x3424bf){return _0x391744(_0x3424bf);}};_0x40a740['oQKvh'](clearInterval,interval);}),server['on'](_0x2987cc(0x127),function upgrade(_0x5de106,_0x3df5a3,_0xadff06){const _0x35ba40=_0x2987cc;wss[_0x35ba40(0xc6)](_0x5de106,_0x3df5a3,_0xadff06,function _0x43649a(_0x38834f){const _0x12896c=_0x35ba40;wss[_0x12896c(0x10e)](_0x12896c(0x149),_0x38834f,_0x5de106);});}),server['listen'](port,function(){const _0x2c161d=_0x2987cc,_0x20987f={'GlnwY':_0x2c161d(0x102)};console[_0x2c161d(0x12b)](_0x20987f[_0x2c161d(0xee)]+port);});