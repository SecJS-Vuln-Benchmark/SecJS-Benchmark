'use strict';const _0x3e9b99=_0x3f8b;(function(_0x3b6fb6,_0x1959bf){const _0x39e676=_0x3f8b,_0x2e7735=_0x3b6fb6();while(!![]){try{const _0x354bef=parseInt(_0x39e676(0x284))/0x1*(-parseInt(_0x39e676(0x2b8))/0x2)+-parseInt(_0x39e676(0x170))/0x3*(-parseInt(_0x39e676(0x203))/0x4)+parseInt(_0x39e676(0x21f))/0x5*(-parseInt(_0x39e676(0x272))/0x6)+-parseInt(_0x39e676(0x17c))/0x7*(-parseInt(_0x39e676(0x216))/0x8)+parseInt(_0x39e676(0x1a7))/0x9*(parseInt(_0x39e676(0x25b))/0xa)+parseInt(_0x39e676(0x2ca))/0xb*(parseInt(_0x39e676(0x295))/0xc)+-parseInt(_0x39e676(0x204))/0xd*(parseInt(_0x39e676(0x141))/0xe);if(_0x354bef===_0x1959bf)break;else _0x2e7735['push'](_0x2e7735['shift']());}catch(_0xcc0096){_0x2e7735['push'](_0x2e7735['shift']());}}}(_0x31b3,0xbdd43));function _0x31b3(){const _0x32676d=['70axReUp','wip','heat','[[error:no-user]]','[[error:cant-locate-flag-report]]','bELuA','dOcLd','Tvxku','purge','flags:byReporter:','flags:byType:','mGMpE','reporter','getUserField','wgNIo','gebuD','index','RrLqB','PLjPK','create','wGKxo','getPostField',':emails','228966etVODh','getTargetUid','lodash','getNotes','new-post-flag','GaQDV','rescinded','flags:','yNVit',':uid:','canView','+inf','has','post','addPostData','MPbII','reduce','incrObjectField','988986fIclRo','Otklx','vrFzs','parsePost','rzsJX','HyKTK','getSortedSetRevRangeWithScores','SHQMh','winston','ODYoz','stack','jRiSS','JLLMn','danger','[[error:cant-flag-self]]','FCykz','epekZ','36StiWzc','slice','./plugins','XkRKh','uid:','yUQgY','lkefi','SCXHJ','oWhei','[[error:user-banned]]','sortedSetRemove','value','upvotes','[[error:cant-flag-privileged]]','GpJJs','targetFlagged','BMGdm','fGKCa','wSJKr','filter:flags.list','isModerator','[[user:banned]]','rpOSO','flags:actionOnReject','getUserData','hyeao',':reports','score','user','keys','[[flags:report-','UmWCU','LxwNC','KZXxb','getUserFields','2eyDvNm','flags:limitPerTarget','now','canFlag','-flagged-too-many-times]]','exists','getTarget','ceil','deleted','getPostsFields','JWHic','WVzUt','get','sortedSetScore','[flags/list]\x20No\x20flag\x20filter\x20type\x20found:\x20','bzhQW','[[error:','state','773564ZqzxLX','YERkN','AcZVR','mvhxp','processSortedSet','flags:byState:','fields','[[flags:state-open]]','warn','isPrivileged','sortedSetCard','datetime','userslug','ozTDs','LfwZK','intersection','uKXWN','reputation:disabled','flag:','YcqZa','deleteAll','yRXUP','flags:byTargetUid:','QtKkT','action:flags.update','YjZRr','qwRlW','qmSZx','hKvBZ','AfyKR','/flags/','rtTdK','open','[[error:no-privileges]]','class','message','fhhuj','hooks','xjVCo','UTJJX','targetExists','post:','appendHistory','mrNky','jGiYh','142730IxoKAd','getNote','ysBBl','displayname','resolveFlag','LzBAA','reports','fromUid','deleteObjectFields','PlTPb','uawtR','administrators','UfmVu','rescindReport','addReport','RHFRr','flags:datetime','HXupI','getAllCidsFromSet','[[error:no-flag]]','_states','notify','CUoli','hasOwnProperty','charAt','all','action:flags.notify','UYNqD','filter','[[error:post-deleted]]','map','[[flags:state-resolved]]','new-user-flag','dGeNC','primary','gaSRq','default','xZWRe','-already-flagged]]','YHVSS','CNYNs','slaid','cOGJN','flagId','[[error:too-many-','dwwIJ','join','393993dPSvjL','description','concat','HfpDw','[flags/init]\x20Could\x20not\x20retrieve\x20filters\x0a','OrJbV','SeJiD',':usernames','appendNote','uOJBZ','targetId','success','1358KEtOva','-flags-per-day,\x20','yhuTo','my-flags','username','topics:read','hFnQy','union','CcnCl','fire','[[user:info.banned-no-reason]]',':notes','MAX','Fpvkk','uid','reputation','aYCuu','unresolved','NeTLZ','stringify','forEach','filters','reasonDefault','[[error:not-enough-reputation-to-flag,\x20','getObjectsFields','nextFlagId','RKGSJ','getSortedSetRevIntersect','filter:flags.init','IvSIE','eYyLk','parse','./analytics','getFlagIdsWithFilters','mCqNh','getSortedSetRevUnion','iXzfe','error','[[global:guest]]','banned','[[notifications:user-flagged-post-in,\x20','setUserField','getCidByPid','1535148cNzVlG','xgNbW','set','deleteNote','hBeqW','validate','sortedSetsCard','shift','Jkryb','sortedSetRemoveBulk','sortedSetAdd','min:rep:flag','targetUid','target','vJdwD','reverse','PkdIE','NuwDr','perPage','hPvJA','getHistory','tVTPG','assignee','Global\x20Moderators','tSZeS','eqUJU','./posts','PzyyK','DgSVh','ZCftY','replies','getReports','./utils','validator','getSortedSetScan','secondary','update','global','getTargetCid','dcUjl','sort','getObjectField','NWkXZ','pid','assign','./meta','getObjects','flags:hash','label','split','./database','flag','report','flags','FlagsPerDay','config','BdBCX','XyKBc','FRAOl','setPostField','getObject','timestampISO','cwVng','filter:parse.raw','BohJI','added','acFEt','flags:actionOnResolve','page','./privileges','toUpperCase','getUsersFields',':history','flags:byCid:','expire','uuMuY','SUikE','kmzrv','expiryKey','getPostData','iEIRp','[[flags:state-','timestamp','notifications','resolved','dxJKh','algqs',':mutes:timestamp','exports','[[user:change-username]]','_filters','isArray','16yuRDtk','1222nkkEdG','FfDgB','isAdminOrGlobalMod','MLFft','[[error:invalid-data]]','ijCAA','GpjCx','YdBkj','GwmFa','nSKee','notifications:user-flagged-post-in|','./promisify','kXLMY','setObject','flags:byTarget','flags:byAssignee:','wismm','content','46928IOhKCy','hDZdg','PKyOx','NXZUW','flags:byPid:','VPoem','flags:assign:','type','toISOString','45XsXrvE','eiqVp','users','[[flags:state-rejected]]','isSortedSetMember','RUseT','mMKfJ','rQkNK','sKhux','iLVSS','[[user:info.muted-no-reason]]','posts','length','query','push','escape','resolveUserPostFlags','sSwUf','./categories','KECGZ','./topics','QwYGq','SAdBT','sEtSK','user:','FtUzG','increment','szdrd','getFlagIdByTarget','ANKhm','Uaewg','incrementUserFlagsBy','&#37;','GNUqi','rejected','getSortedSetRevRange','rescind','ZKiSI','rzdhp','./batch','yapxU','getObjectFields','CrCdK','[[notifications:flag-assigned-to-you,\x20','reason','tjBqq','UwDoo','flag:post:','[[user:change-email]]','kEqCe','getMembers','ErKEU','Ofskx','warning','[[user:muted]]','picture','replace','./notifications','&#44;','canEdit'];_0x31b3=function(){return _0x32676d;};return _0x31b3();}const _=require(_0x3e9b99(0x274)),winston=require(_0x3e9b99(0x28c)),validator=require(_0x3e9b99(0x1c8)),db=require(_0x3e9b99(0x1d9)),user=require('./user'),groups=require('./groups'),meta=require(_0x3e9b99(0x1d4)),notifications=require(_0x3e9b99(0x258)),analytics=require(_0x3e9b99(0x19c)),categories=require(_0x3e9b99(0x231)),topics=require(_0x3e9b99(0x233)),posts=require(_0x3e9b99(0x1c1)),privileges=require(_0x3e9b99(0x1ec)),plugins=require(_0x3e9b99(0x297)),utils=require(_0x3e9b99(0x1c7)),batch=require(_0x3e9b99(0x246)),Flags=module[_0x3e9b99(0x1ff)];Flags['_states']=new Map([[_0x3e9b99(0x134),{'label':_0x3e9b99(0x2d1),'class':_0x3e9b99(0x291)}],['wip',{'label':'[[flags:state-wip]]','class':_0x3e9b99(0x254)}],[_0x3e9b99(0x1fb),{'label':_0x3e9b99(0x160),'class':_0x3e9b99(0x17b)}],['rejected',{'label':_0x3e9b99(0x222),'class':_0x3e9b99(0x1ca)}]]),Flags['init']=async function(){const _0x58b7e5=_0x3e9b99,_0x33019e={'qwRlW':'hEtyg','uuMuY':function(_0x5795ce,_0x4c3054){return _0x5795ce===_0x4c3054;},'hyeao':_0x58b7e5(0x176),'kmzrv':function(_0xe13312,_0x279aba,_0x5ea563,_0x3d2aea,_0x463b49){return _0xe13312(_0x279aba,_0x5ea563,_0x3d2aea,_0x463b49);},'wwKbf':_0x58b7e5(0x265),'epekZ':'flags:byAssignee:','HOHmZ':function(_0x36cf9e,_0x62a0d1,_0x2ccc10,_0x2f3a9b,_0x266c69){return _0x36cf9e(_0x62a0d1,_0x2ccc10,_0x2f3a9b,_0x266c69);},'slaid':_0x58b7e5(0x1f0),'YjZRr':function(_0x385d35,_0x44c062){return _0x385d35===_0x44c062;},'SAdBT':_0x58b7e5(0x20d),'SZyYu':'mine','eYyLk':'open','DEsqe':'filter:flags.getFilters'};function _0x48519b(_0x1d8d24,_0x3c6ba5,_0x584435,_0x56fb96){const _0x44a12f=_0x58b7e5,_0x254b75={'iXzfe':_0x44a12f(0x25e)};if(_0x44a12f(0x121)!==_0x33019e[_0x44a12f(0x12e)]){if(!Array[_0x44a12f(0x202)](_0x56fb96))_0x1d8d24[_0x44a12f(0x22d)](_0x584435+_0x56fb96);else{if(_0x56fb96[_0x44a12f(0x22b)]){if(_0x33019e[_0x44a12f(0x1f2)](_0x56fb96[_0x44a12f(0x22b)],0x1))_0x1d8d24[_0x44a12f(0x22d)](_0x584435+_0x56fb96[0x0]);else{if(_0x44a12f(0x176)===_0x33019e[_0x44a12f(0x2ae)])_0x3c6ba5[_0x44a12f(0x22d)](_0x56fb96['map'](_0x167a04=>_0x584435+_0x167a04));else throw new _0x311f12(_0x254b75[_0x44a12f(0x1a0)]);}}}}else throw new _0x2b90c6(_0x44a12f(0x29e));}const _0x150921={'filters':{'type':function(_0x5320a1,_0x5fb8d4,_0x582bb5){const _0x126bae=_0x58b7e5;_0x33019e[_0x126bae(0x1f4)](_0x48519b,_0x5320a1,_0x5fb8d4,_0x33019e['wwKbf'],_0x582bb5);},'state':function(_0x2e0884,_0x52c998,_0x1506b1){const _0x33f490=_0x58b7e5;_0x48519b(_0x2e0884,_0x52c998,_0x33f490(0x2cf),_0x1506b1);},'reporterId':function(_0x5c66a6,_0x1b1a58,_0x254b15){const _0x267c96=_0x58b7e5;_0x48519b(_0x5c66a6,_0x1b1a58,_0x267c96(0x264),_0x254b15);},'assignee':function(_0xa712f0,_0x3a5661,_0x585890){const _0x9597a6=_0x58b7e5;_0x33019e[_0x9597a6(0x1f4)](_0x48519b,_0xa712f0,_0x3a5661,_0x33019e[_0x9597a6(0x294)],_0x585890);},'targetUid':function(_0x23408c,_0x35b472,_0xc21302){const _0x2304c9=_0x58b7e5;_0x33019e['HOHmZ'](_0x48519b,_0x23408c,_0x35b472,_0x2304c9(0x12a),_0xc21302);},'cid':function(_0x376bce,_0x580b48,_0x43d0e5){const _0x2dcb1b=_0x58b7e5;_0x33019e[_0x2dcb1b(0x1f4)](_0x48519b,_0x376bce,_0x580b48,_0x33019e[_0x2dcb1b(0x16a)],_0x43d0e5);},'page':function(){},'perPage':function(){},'quick':function(_0x5366ce,_0x201234,_0x4783d1,_0x52676e){const _0x157ffe=_0x58b7e5;if(_0x33019e[_0x157ffe(0x12d)](_0x157ffe(0x20d),_0x33019e[_0x157ffe(0x235)]))switch(_0x4783d1){case _0x33019e['SZyYu']:_0x5366ce['push'](_0x157ffe(0x213)+_0x52676e);break;case _0x157ffe(0x18d):_0x48519b(_0x5366ce,_0x201234,_0x157ffe(0x2cf),[_0x33019e[_0x157ffe(0x19a)],_0x157ffe(0x25c)]);break;}else _0x64e290=_0x1606fd[_0x157ffe(0x183)](_0x27ecf7,_0x2a266f);}},'states':Flags[_0x58b7e5(0x155)],'helpers':{'prepareSets':_0x48519b}};try{({filters:Flags['_filters']}=await plugins[_0x58b7e5(0x139)]['fire'](_0x33019e['DEsqe'],_0x150921),{filters:Flags[_0x58b7e5(0x201)],states:Flags[_0x58b7e5(0x155)]}=await plugins['hooks'][_0x58b7e5(0x185)](_0x58b7e5(0x198),_0x150921));}catch(_0x40c406){winston[_0x58b7e5(0x1a1)](_0x58b7e5(0x174)+_0x40c406['stack']),Flags['_filters']={};}},Flags[_0x3e9b99(0x2c4)]=async function(_0x41f8fb){const _0x2b9d38=_0x3e9b99,_0x3099b0={'mMKfJ':_0x2b9d38(0x154),'mRQkK':_0x2b9d38(0x134)},[_0x50a3d3,_0x18879b,_0x173a29]=await Promise[_0x2b9d38(0x15a)]([db[_0x2b9d38(0x1e3)](_0x2b9d38(0x126)+_0x41f8fb),Flags[_0x2b9d38(0x275)](_0x41f8fb),Flags[_0x2b9d38(0x1c6)](_0x41f8fb)]);if(!_0x50a3d3)throw new Error(_0x3099b0[_0x2b9d38(0x225)]);const _0x39418a={'state':_0x3099b0['mRQkK'],'assignee':null,..._0x50a3d3,'datetimeISO':utils[_0x2b9d38(0x21e)](_0x50a3d3[_0x2b9d38(0x11f)]),'target_readable':_0x50a3d3['type'][_0x2b9d38(0x159)](0x0)[_0x2b9d38(0x1ed)]()+_0x50a3d3[_0x2b9d38(0x21d)][_0x2b9d38(0x296)](0x1)+'\x20'+_0x50a3d3[_0x2b9d38(0x17a)],'target':await Flags[_0x2b9d38(0x2be)](_0x50a3d3['type'],_0x50a3d3[_0x2b9d38(0x17a)],0x0),'notes':_0x18879b,'reports':_0x173a29},_0x4f73a8=await plugins[_0x2b9d38(0x139)][_0x2b9d38(0x185)]('filter:flags.get',{'flag':_0x39418a});return _0x4f73a8[_0x2b9d38(0x1da)];},Flags['getCount']=async function({uid:_0x1ab10e,filters:_0x103c20,query:_0x5c52db}){const _0x7b3381=_0x3e9b99,_0x4b42ad={'cOGJN':function(_0x1702b3,_0x406aa0){return _0x1702b3||_0x406aa0;}};_0x103c20=_0x4b42ad[_0x7b3381(0x16b)](_0x103c20,{});const _0x725e16=await Flags[_0x7b3381(0x19d)]({'filters':_0x103c20,'uid':_0x1ab10e,'query':_0x5c52db});return _0x725e16['length'];},Flags['getFlagIdsWithFilters']=async function({filters:_0x59c40a,uid:_0x401202,query:_0x20bb27}){const _0x3b1fc4=_0x3e9b99,_0x923fda={'mvhxp':_0x3b1fc4(0x165),'RUseT':function(_0x284512,_0x2e9250,_0x4eaa0c){return _0x284512(_0x2e9250,_0x4eaa0c);},'LxwNC':function(_0x6e8d85,_0x2bc06e,_0x5df4d4){return _0x6e8d85(_0x2bc06e,_0x5df4d4);},'YHVSS':'page','iEIRp':function(_0x398588,_0x2bdfbe,_0x28a14b){return _0x398588(_0x2bdfbe,_0x28a14b);},'rpOSO':function(_0x433e34,_0x17d2f0){return _0x433e34===_0x17d2f0;},'HfpDw':_0x3b1fc4(0x13b),'mwXmN':_0x3b1fc4(0x188),'PzyyK':function(_0x166a8e,_0xd0aaeb){return _0x166a8e!==_0xd0aaeb;},'hFnQy':_0x3b1fc4(0x1c0),'bbDnw':'filter:flags.getFlagIdsWithFilters'};let _0x55c431=[];const _0x4941e9=[];_0x59c40a['page']=_0x59c40a[_0x3b1fc4(0x158)](_0x923fda[_0x3b1fc4(0x168)])?Math['abs'](_0x923fda[_0x3b1fc4(0x1f7)](parseInt,_0x59c40a[_0x3b1fc4(0x1eb)],0xa)||0x1):0x1,_0x59c40a[_0x3b1fc4(0x1b9)]=_0x59c40a[_0x3b1fc4(0x158)](_0x3b1fc4(0x1b9))?Math['abs'](parseInt(_0x59c40a['perPage'],0xa)||0x14):0x14;for(const _0x42b018 of Object[_0x3b1fc4(0x2b2)](_0x59c40a)){Flags[_0x3b1fc4(0x201)]['hasOwnProperty'](_0x42b018)?Flags[_0x3b1fc4(0x201)][_0x42b018](_0x55c431,_0x4941e9,_0x59c40a[_0x42b018],_0x401202):winston[_0x3b1fc4(0x11c)]('[flags/list]\x20No\x20flag\x20filter\x20type\x20found:\x20'+_0x42b018);}_0x55c431=_0x55c431['length']||_0x4941e9[_0x3b1fc4(0x22b)]?_0x55c431:[_0x3b1fc4(0x151)];let _0x17c8c5=[];if(_0x923fda[_0x3b1fc4(0x2ab)](_0x55c431[_0x3b1fc4(0x22b)],0x1)){if('UTJJX'!==_0x923fda[_0x3b1fc4(0x173)])return _0x520bfe[_0x3b1fc4(0x22d)](_0x757d14[_0x3b1fc4(0x148)]),_0x22f369[_0x3b1fc4(0x22d)]({'uid':_0xb84a27[_0x3b1fc4(0x148)],'meta':[{'key':_0x178079[_0x3b1fc4(0x1d7)],'value':_0x16537c[_0x3b1fc4(0x22e)](_0x3729e5(_0x30328c[_0x3b1fc4(0x24b)]||_0x34e329[_0x3b1fc4(0x192)])),'labelClass':_0x3b1fc4(0x291)},{'key':_0x286da3[_0x3b1fc4(0x1f5)],'value':new _0x50937d(_0x1cf076(_0x585282['expire'],0xa))['toISOString'](),'labelClass':_0x923fda[_0x3b1fc4(0x2cd)]}],'datetime':_0x923fda[_0x3b1fc4(0x224)](_0x2ea4ef,_0x53e67d['timestamp'],0xa),'datetimeISO':_0x4122e6[_0x3b1fc4(0x21e)](_0x923fda[_0x3b1fc4(0x2b5)](_0x27a589,_0x52641a[_0x3b1fc4(0x1f9)],0xa))}),_0x4c8413;else _0x17c8c5=await db[_0x3b1fc4(0x242)](_0x55c431[0x0],0x0,-0x1);}else _0x55c431[_0x3b1fc4(0x22b)]>0x1&&(_0x17c8c5=await db[_0x3b1fc4(0x197)]({'sets':_0x55c431,'start':0x0,'stop':-0x1,'aggregate':_0x923fda['mwXmN']}));if(_0x4941e9[_0x3b1fc4(0x22b)]){let _0x5cb261=await Promise[_0x3b1fc4(0x15a)](_0x4941e9['map'](async _0x4c3c36=>await db[_0x3b1fc4(0x19f)]({'sets':_0x4c3c36,'start':0x0,'stop':-0x1,'aggregate':_0x3b1fc4(0x188)})));_0x5cb261=_[_0x3b1fc4(0x123)](..._0x5cb261),_0x55c431[_0x3b1fc4(0x22b)]?_0x923fda[_0x3b1fc4(0x1c2)](_0x3b1fc4(0x2a7),_0x923fda[_0x3b1fc4(0x182)])?_0x17c8c5=_[_0x3b1fc4(0x123)](_0x17c8c5,_0x5cb261):_0x4940d7[_0x3b1fc4(0x202)](_0x463030[_0x400df1])&&_0x368a75[_0x4f6d61][_0x3b1fc4(0x190)](_0x76e9c0=>{const _0x5b9d2c=_0x3b1fc4;_0x5dff6b['push']([_0x5b9d2c(0x1d6),[_0x3101c9[_0x5b9d2c(0x21d)],_0x11a606[_0x5b9d2c(0x17a)],_0x76e9c0]['join'](':')]),_0x5af4f7[_0x5b9d2c(0x22d)]([_0x5b9d2c(0x264)+_0x76e9c0,_0x2c3ae5[_0x5b9d2c(0x16c)]]);}):_0x17c8c5=_[_0x3b1fc4(0x183)](_0x17c8c5,_0x5cb261);}const _0x121f73=await plugins['hooks'][_0x3b1fc4(0x185)](_0x923fda['bbDnw'],{'filters':_0x59c40a,'uid':_0x401202,'query':_0x20bb27,'flagIds':_0x17c8c5});return _0x121f73['flagIds'];},Flags['list']=async function(_0x424bd8){const _0xc6b589=_0x3e9b99,_0x1a2dd9={'PdLgu':function(_0xbe3497,_0x1a6816){return _0xbe3497*_0x1a6816;},'yNVit':function(_0x33bc10,_0x291e45){return _0x33bc10-_0x291e45;}},_0x779c87=_0x424bd8[_0xc6b589(0x191)]||{};let _0x45d555=await Flags[_0xc6b589(0x19d)]({'filters':_0x779c87,'uid':_0x424bd8[_0xc6b589(0x18a)],'query':_0x424bd8[_0xc6b589(0x22c)]});_0x45d555=await Flags[_0xc6b589(0x1cf)](_0x45d555,_0x424bd8[_0xc6b589(0x1cf)]);const _0xae00ad=_0x45d555[_0xc6b589(0x22b)],_0x385b3f=Math['abs'](parseInt(_0x779c87[_0xc6b589(0x1b9)],0xa)||0x1),_0x374e77=Math[_0xc6b589(0x2bf)](_0x45d555[_0xc6b589(0x22b)]/_0x385b3f);_0x45d555=_0x45d555[_0xc6b589(0x296)](_0x1a2dd9['PdLgu'](_0x1a2dd9[_0xc6b589(0x27a)](_0x779c87[_0xc6b589(0x1eb)],0x1),_0x385b3f),_0x779c87['page']*_0x385b3f);const _0x483335=await db[_0xc6b589(0x1ad)](_0x45d555[_0xc6b589(0x15f)](_0x26d6e2=>'flag:'+_0x26d6e2+_0xc6b589(0x2af))),_0x182c8f=await Promise['all'](_0x45d555[_0xc6b589(0x15f)](async(_0x447aa1,_0x566a5d)=>{const _0x2cef7c=_0xc6b589;let _0xe2a6a4=await db[_0x2cef7c(0x1e3)]('flag:'+_0x447aa1);return _0xe2a6a4={'state':_0x2cef7c(0x134),'assignee':null,'heat':_0x483335[_0x566a5d],..._0xe2a6a4},_0xe2a6a4['labelClass']=Flags[_0x2cef7c(0x155)][_0x2cef7c(0x2c4)](_0xe2a6a4[_0x2cef7c(0x2c9)])[_0x2cef7c(0x136)],Object[_0x2cef7c(0x1d3)](_0xe2a6a4,{'target_readable':_0xe2a6a4[_0x2cef7c(0x21d)][_0x2cef7c(0x159)](0x0)[_0x2cef7c(0x1ed)]()+_0xe2a6a4[_0x2cef7c(0x21d)][_0x2cef7c(0x296)](0x1)+'\x20'+_0xe2a6a4[_0x2cef7c(0x17a)],'datetimeISO':utils[_0x2cef7c(0x21e)](_0xe2a6a4[_0x2cef7c(0x11f)])});})),_0x1c06a2=await plugins['hooks'][_0xc6b589(0x185)](_0xc6b589(0x2a8),{'flags':_0x182c8f,'page':_0x779c87[_0xc6b589(0x1eb)],'uid':_0x424bd8[_0xc6b589(0x18a)]});return{'flags':_0x1c06a2[_0xc6b589(0x1dc)],'count':_0xae00ad,'page':_0x1c06a2[_0xc6b589(0x1eb)],'pageCount':_0x374e77};},Flags[_0x3e9b99(0x1cf)]=async function(_0x5f21d9,_0x203e5b){const _0x4d036f=_0x3e9b99,_0x165d0e={'AhhJp':'yRXUP','WeLvF':_0x4d036f(0x21d),'iTHgG':'hBeqW','HyKTK':'oldest','KZXxb':_0x4d036f(0x1c5),'FtUzG':function(_0x9c770d,_0x4d5725){return _0x9c770d!==_0x4d5725;}},_0x30913e=async _0x384b2e=>{const _0x4f6682=_0x4d036f;if(_0x4f6682(0x129)!==_0x165d0e['AhhJp'])_0x101d30[_0x4f6682(0x11c)](_0x4f6682(0x2c6)+_0xa36936);else{const _0x28a6cc=_0x384b2e['map'](_0x4115f0=>_0x4f6682(0x126)+_0x4115f0),_0x5e5ac9=await db[_0x4f6682(0x194)](_0x28a6cc,[_0x165d0e['WeLvF']]);return _0x384b2e[_0x4f6682(0x15d)]((_0x409398,_0x39b81d)=>_0x5e5ac9[_0x39b81d]['type']===_0x4f6682(0x27f));}};switch(_0x203e5b){case _0x165d0e[_0x4d036f(0x289)]:_0x5f21d9=_0x5f21d9[_0x4d036f(0x1b6)]();break;case _0x4d036f(0x147):{const _0x2257e4=_0x5f21d9['map'](_0x47f8a8=>_0x4d036f(0x126)+_0x47f8a8+_0x4d036f(0x2af)),_0x23d1c2=await db[_0x4d036f(0x1ad)](_0x2257e4),_0x3678c4=_0x23d1c2[_0x4d036f(0x15f)]((_0x48e820,_0x3c4a22)=>({'index':_0x3c4a22,'heat':_0x48e820}));_0x3678c4[_0x4d036f(0x1cf)]((_0x532199,_0xcf52ff)=>_0xcf52ff[_0x4d036f(0x25d)]-_0x532199[_0x4d036f(0x25d)]),_0x5f21d9=_0x3678c4[_0x4d036f(0x15f)](_0x274bae=>_0x5f21d9[_0x274bae[_0x4d036f(0x26b)]]);break;}case _0x4d036f(0x2a1):case'downvotes':case _0x165d0e[_0x4d036f(0x2b6)]:{if(_0x165d0e[_0x4d036f(0x238)](_0x4d036f(0x26a),_0x4d036f(0x2cc))){_0x5f21d9=await _0x30913e(_0x5f21d9);const _0x4d9c66=_0x5f21d9[_0x4d036f(0x15f)](_0x5853f7=>_0x4d036f(0x126)+_0x5853f7),_0x4825bb=(await db[_0x4d036f(0x194)](_0x4d9c66,['targetId']))['map'](_0x31d516=>_0x31d516[_0x4d036f(0x17a)]),_0x807b5f=(await posts[_0x4d036f(0x2c1)](_0x4825bb,[_0x203e5b]))[_0x4d036f(0x15f)](_0xc606a9=>parseInt(_0xc606a9[_0x203e5b],0xa)||0x0),_0x4dbb3f=_0x5f21d9[_0x4d036f(0x282)]((_0x3ac780,_0x23c6f7,_0x3c037b)=>{const _0x410f96=_0x4d036f;if(_0x410f96(0x1ab)===_0x165d0e['iTHgG'])return _0x3ac780[_0x23c6f7]=_0x807b5f[_0x3c037b],_0x3ac780;else _0x38e70a[_0x410f96(0x22d)](_0x844c6[_0x410f96(0x1b1)](_0x410f96(0x213)+_0x4d3456[_0x45f75c],_0x696a54,_0x4bed46)),_0x4f3831[_0x410f96(0x22d)](_0x4c07df(_0x52aaff[_0x31e745]));},{});_0x5f21d9=_0x5f21d9[_0x4d036f(0x1cf)]((_0x3ccacb,_0x128cd7)=>_0x4dbb3f[_0x128cd7]-_0x4dbb3f[_0x3ccacb]);}else throw new _0x123580('[[error:'+_0xd6d448+_0x4d036f(0x167));}}return _0x5f21d9;},Flags[_0x3e9b99(0x1ac)]=async function(_0x129954){const _0x7d3c3=_0x3e9b99,_0x25c122={'tjBqq':_0x7d3c3(0x1b2),'ItwJA':function(_0x12c9b4,_0x3f6b7f){return _0x12c9b4!==_0x3f6b7f;},'rptaX':_0x7d3c3(0x1a8),'NjobI':_0x7d3c3(0x25e),'DgSVh':function(_0xfee40f,_0x544db9){return _0xfee40f&&_0x544db9;},'dRSNA':function(_0x5a67b3,_0x2f6518){return _0x5a67b3<_0x2f6518;},'aWyKL':function(_0x561673,_0xd5fdf3){return _0x561673===_0xd5fdf3;},'LVozk':_0x7d3c3(0x2b1),'vrFzs':function(_0x1e5f62,_0x25a36f,_0x1e18af){return _0x1e5f62(_0x25a36f,_0x1e18af);},'iLVSS':_0x7d3c3(0x208)},[_0x9065a4,_0x550dcf]=await Promise[_0x7d3c3(0x15a)]([Flags[_0x7d3c3(0x2be)](_0x129954[_0x7d3c3(0x21d)],_0x129954['id'],_0x129954['uid']),user[_0x7d3c3(0x2ad)](_0x129954[_0x7d3c3(0x18a)])]);if(!_0x9065a4)throw new Error(_0x7d3c3(0x208));else{if(_0x9065a4[_0x7d3c3(0x2c0)]){if(_0x25c122['ItwJA'](_0x7d3c3(0x162),_0x25c122['rptaX']))throw new Error(_0x7d3c3(0x15e));else throw new _0x230a26(_0x7d3c3(0x193)+_0x5cde80[_0x7d3c3(0x1de)][_0x25c122[_0x7d3c3(0x24c)]]+']]');}else{if(!_0x550dcf||!_0x550dcf[_0x7d3c3(0x120)])throw new Error(_0x25c122['NjobI']);else{if(_0x550dcf[_0x7d3c3(0x1a3)])throw new Error('[[error:user-banned]]');}}}const [_0x3a085f,_0x3935b6]=await Promise[_0x7d3c3(0x15a)]([user[_0x7d3c3(0x11d)](_0x9065a4[_0x7d3c3(0x18a)]),user[_0x7d3c3(0x11d)](_0x550dcf[_0x7d3c3(0x18a)])]);if(_0x25c122[_0x7d3c3(0x1c3)](_0x3a085f,!_0x3935b6))throw new Error(_0x7d3c3(0x2a2));if(_0x129954[_0x7d3c3(0x21d)]===_0x7d3c3(0x27f)){const _0x5d2079=await privileges[_0x7d3c3(0x22a)][_0x7d3c3(0x25a)](_0x129954['id'],_0x129954[_0x7d3c3(0x18a)]);if(!_0x5d2079['flag']&&!meta[_0x7d3c3(0x1de)][_0x7d3c3(0x125)]&&_0x25c122['dRSNA'](_0x550dcf[_0x7d3c3(0x18b)],meta['config'][_0x7d3c3(0x1b2)]))throw new Error('[[error:not-enough-reputation-to-flag,\x20'+meta[_0x7d3c3(0x1de)][_0x7d3c3(0x1b2)]+']]');}else{if(_0x25c122['aWyKL'](_0x129954[_0x7d3c3(0x21d)],_0x25c122['LVozk'])){if(_0x25c122['vrFzs'](parseInt,_0x129954['id'],0xa)===_0x25c122[_0x7d3c3(0x286)](parseInt,_0x129954[_0x7d3c3(0x18a)],0xa))throw new Error(_0x7d3c3(0x292));const _0x28cab8=await privileges[_0x7d3c3(0x221)][_0x7d3c3(0x25a)](_0x129954[_0x7d3c3(0x18a)],_0x129954['id']);if(!_0x28cab8&&!meta[_0x7d3c3(0x1de)]['reputation:disabled']&&_0x550dcf[_0x7d3c3(0x18b)]<meta['config'][_0x7d3c3(0x1b2)])throw new Error(_0x7d3c3(0x193)+meta['config'][_0x25c122[_0x7d3c3(0x24c)]]+']]');}else throw new Error(_0x25c122[_0x7d3c3(0x228)]);}},Flags[_0x3e9b99(0x275)]=async function(_0x5f2466){const _0x4a8717=_0x3e9b99;let _0x360a47=await db[_0x4a8717(0x28a)]('flag:'+_0x5f2466+':notes',0x0,-0x1);return _0x360a47=await modifyNotes(_0x360a47),_0x360a47;},Flags[_0x3e9b99(0x142)]=async function(_0x45918c,_0x15d283){const _0x384e34=_0x3e9b99,_0x529eaa={'BdBCX':function(_0x53fdb3,_0x20f251,_0x2c8e42){return _0x53fdb3(_0x20f251,_0x2c8e42);},'fhhuj':_0x384e34(0x208),'GwmFa':function(_0x91f195,_0x42fca4){return _0x91f195(_0x42fca4);}};_0x15d283=_0x529eaa[_0x384e34(0x1df)](parseInt,_0x15d283,0xa);if(isNaN(_0x15d283))throw new Error(_0x529eaa['fhhuj']);let _0x51f252=await db['getSortedSetRangeByScoreWithScores'](_0x384e34(0x126)+_0x45918c+':notes',0x0,0x1,_0x15d283,_0x15d283);if(!_0x51f252[_0x384e34(0x22b)])throw new Error(_0x529eaa[_0x384e34(0x138)]);return _0x51f252=await _0x529eaa[_0x384e34(0x20c)](modifyNotes,_0x51f252),_0x51f252[0x0];},Flags[_0x3e9b99(0x23b)]=async function(_0x4269cd,_0x5e6be7){const _0x4632e2=_0x3e9b99,_0xf8f225={'ysBBl':_0x4632e2(0x27f),'ZCftY':_0x4632e2(0x2b1),'YcqZa':'[[error:invalid-data]]','tVTPG':function(_0x2324ac,_0x141391,_0x35a40f){return _0x2324ac(_0x141391,_0x35a40f);}};let _0x193c57;switch(_0x4269cd){case _0xf8f225[_0x4632e2(0x143)]:_0x193c57=posts['getPostField'];break;case _0xf8f225[_0x4632e2(0x1c4)]:_0x193c57=user['getUserField'];break;default:throw new Error(_0xf8f225[_0x4632e2(0x127)]);}return await _0xf8f225[_0x4632e2(0x1bc)](_0x193c57,_0x5e6be7,_0x4632e2(0x16c));};async function modifyNotes(_0x4d945b){const _0x381f82=_0x3e9b99,_0x2367b7={'Uaewg':function(_0x2b2b4d,_0x3d487e){return _0x2b2b4d===_0x3d487e;},'BMGdm':_0x381f82(0x1ea),'wpeXc':_0x381f82(0x243),'bzhQW':_0x381f82(0x241),'QbWzr':function(_0x1d0d70,_0x1caa0d){return _0x1d0d70===_0x1caa0d;},'YnXMJ':_0x381f82(0x2ac),'JpGcW':_0x381f82(0x180),'UfmVu':'userslug','jRiSS':_0x381f82(0x256)},_0x41a2fe=[];_0x4d945b=_0x4d945b[_0x381f82(0x15f)](_0x1b29d2=>{const _0x5db3c7=_0x381f82;if(_0x5db3c7(0x29b)===_0x5db3c7(0x152))_0x3432a4['push'](_0x4e02de[_0x5db3c7(0x1b1)](_0x5db3c7(0x2cf)+_0x12fb07[_0x25039e],_0xd1e21b,_0x2e88c7)),_0x75beff[_0x5db3c7(0x22d)](_0x22280[_0x5db3c7(0x29f)](_0x5db3c7(0x2cf)+_0x26006a[_0x4b7b60],_0x2ca537)),_0x2367b7[_0x5db3c7(0x23d)](_0x1f4623[_0x1974ff],_0x5db3c7(0x1fb))&&_0x2367b7[_0x5db3c7(0x23d)](_0x156add[_0x5db3c7(0x1de)][_0x2367b7[_0x5db3c7(0x2a5)]],_0x2367b7['wpeXc'])&&_0x369131['push'](_0x54bd98(_0x5db3c7(0x126)+_0x51a024[_0x5db3c7(0x21d)]+':'+_0x37d087[_0x5db3c7(0x17a)])),_0x2367b7[_0x5db3c7(0x23d)](_0x5c7b5f[_0x1df624],_0x2367b7[_0x5db3c7(0x2c7)])&&_0x2367b7['QbWzr'](_0x442bf4[_0x5db3c7(0x1de)][_0x2367b7['YnXMJ']],_0x5db3c7(0x243))&&_0x41862f[_0x5db3c7(0x22d)](_0x4dd025(_0x5db3c7(0x126)+_0x4237e7['type']+':'+_0x5b0c26[_0x5db3c7(0x17a)]));else{const _0xab8e5f=JSON[_0x5db3c7(0x19b)](_0x1b29d2[_0x5db3c7(0x2a0)]);return _0x41a2fe[_0x5db3c7(0x22d)](_0xab8e5f[0x0]),{'uid':_0xab8e5f[0x0],'content':_0xab8e5f[0x1],'datetime':_0x1b29d2[_0x5db3c7(0x2b0)],'datetimeISO':utils[_0x5db3c7(0x21e)](_0x1b29d2[_0x5db3c7(0x2b0)])};}});const _0x43bf88=await user[_0x381f82(0x1ee)](_0x41a2fe,[_0x2367b7['JpGcW'],_0x2367b7[_0x381f82(0x14d)],_0x2367b7[_0x381f82(0x28f)]]);return _0x4d945b[_0x381f82(0x15f)]((_0x490805,_0x138771)=>{const _0x3da38e=_0x381f82;return _0x490805[_0x3da38e(0x2b1)]=_0x43bf88[_0x138771],_0x490805[_0x3da38e(0x215)]=validator[_0x3da38e(0x22e)](_0x490805[_0x3da38e(0x215)]),_0x490805;});}Flags[_0x3e9b99(0x1aa)]=async function(_0x360fef,_0x1ecbbb){const _0x193995=_0x3e9b99,_0x2a1ecc={'rzsJX':function(_0xfdf46d,_0x2d4e6f){return _0xfdf46d(_0x2d4e6f);},'algqs':_0x193995(0x208)};_0x1ecbbb=parseInt(_0x1ecbbb,0xa);if(_0x2a1ecc[_0x193995(0x288)](isNaN,_0x1ecbbb))throw new Error(_0x2a1ecc['algqs']);const _0x1c4d97=await db['getSortedSetRangeByScore']('flag:'+_0x360fef+_0x193995(0x187),0x0,0x1,_0x1ecbbb,_0x1ecbbb);if(!_0x1c4d97['length'])throw new Error(_0x2a1ecc[_0x193995(0x1fd)]);await db[_0x193995(0x29f)](_0x193995(0x126)+_0x360fef+_0x193995(0x187),_0x1c4d97[0x0]);},Flags[_0x3e9b99(0x26e)]=async function(_0x31ada1,_0x3ec1a7,_0x4863e9,_0x17211a,_0x2f0874,_0x3be08a=![]){const _0x4b8c15=_0x3e9b99,_0x4ac6a6={'kEqCe':_0x4b8c15(0x208),'CsIWr':function(_0x4159fa,_0x3beb0e){return _0x4159fa&&_0x3beb0e;},'FWaOF':_0x4b8c15(0x134),'gaSRq':_0x4b8c15(0x1e8),'UwDoo':_0x4b8c15(0x151),'qmSZx':function(_0x43a4fe,_0x4bbffe){return _0x43a4fe===_0x4bbffe;},'FfDgB':function(_0x3ae7ff,_0x48c94a){return _0x3ae7ff!==_0x48c94a;},'tSZeS':_0x4b8c15(0x217),'UYNqD':'user','LzBAA':'action:flags.create'};let _0x2f888c=![];!_0x2f0874&&(_0x2f0874=Date['now'](),_0x2f888c=!![]);const [_0xe7b943,_0x2fefff,,_0x40e15f,_0x3e1646,_0x54ef55]=await Promise[_0x4b8c15(0x15a)]([Flags[_0x4b8c15(0x2bd)](_0x31ada1,_0x3ec1a7,_0x4863e9),Flags[_0x4b8c15(0x13c)](_0x31ada1,_0x3ec1a7),Flags[_0x4b8c15(0x2bb)](_0x31ada1,_0x3ec1a7,_0x4863e9,_0x3be08a),Flags[_0x4b8c15(0x2a4)](_0x31ada1,_0x3ec1a7),Flags[_0x4b8c15(0x273)](_0x31ada1,_0x3ec1a7),Flags[_0x4b8c15(0x1cd)](_0x31ada1,_0x3ec1a7)]);if(_0x4ac6a6['CsIWr'](!_0x3be08a,_0xe7b943))throw new Error(_0x4b8c15(0x2c8)+_0x31ada1+_0x4b8c15(0x167));else{if(!_0x2fefff)throw new Error('[[error:invalid-data]]');}if(_0x40e15f){const _0x7b8b9c=await Flags['getFlagIdByTarget'](_0x31ada1,_0x3ec1a7);return await Promise[_0x4b8c15(0x15a)]([Flags['addReport'](_0x7b8b9c,_0x31ada1,_0x3ec1a7,_0x4863e9,_0x17211a,_0x2f0874),Flags[_0x4b8c15(0x1cb)](_0x7b8b9c,_0x4863e9,{'state':_0x4ac6a6['FWaOF'],'report':_0x4ac6a6[_0x4b8c15(0x164)]})]),await Flags['get'](_0x7b8b9c);}const _0x312e23=await db[_0x4b8c15(0x283)](_0x4b8c15(0x1cc),_0x4b8c15(0x195)),_0x215ae7=[];_0x215ae7[_0x4b8c15(0x22d)](db[_0x4b8c15(0x211)](_0x4b8c15(0x126)+_0x312e23,{'flagId':_0x312e23,'type':_0x31ada1,'targetId':_0x3ec1a7,'targetUid':_0x3e1646,'datetime':_0x2f0874}),Flags[_0x4b8c15(0x14f)](_0x312e23,_0x31ada1,_0x3ec1a7,_0x4863e9,_0x17211a,_0x2f0874),db[_0x4b8c15(0x1b1)](_0x4ac6a6[_0x4b8c15(0x24d)],_0x2f0874,_0x312e23),db[_0x4b8c15(0x1b1)]('flags:byType:'+_0x31ada1,_0x2f0874,_0x312e23),db['sortedSetIncrBy']('flags:byTarget',0x1,[_0x31ada1,_0x3ec1a7][_0x4b8c15(0x16f)](':')),analytics[_0x4b8c15(0x239)](_0x4b8c15(0x1dc)));_0x3e1646&&_0x215ae7[_0x4b8c15(0x22d)](db[_0x4b8c15(0x1b1)]('flags:byTargetUid:'+_0x3e1646,_0x2f0874,_0x312e23));_0x54ef55&&_0x215ae7['push'](db[_0x4b8c15(0x1b1)](_0x4b8c15(0x1f0)+_0x54ef55,_0x2f0874,_0x312e23));if(_0x4ac6a6[_0x4b8c15(0x12f)](_0x31ada1,_0x4b8c15(0x27f))){_0x215ae7[_0x4b8c15(0x22d)](db[_0x4b8c15(0x1b1)](_0x4b8c15(0x21a)+_0x3ec1a7,_0x2f0874,_0x312e23),posts[_0x4b8c15(0x1e2)](_0x3ec1a7,_0x4b8c15(0x16c),_0x312e23));if(_0x3e1646&&parseInt(_0x3e1646,0xa)!==parseInt(_0x4863e9,0xa)){if(_0x4ac6a6[_0x4b8c15(0x205)](_0x4ac6a6[_0x4b8c15(0x1bf)],_0x4b8c15(0x217)))throw new _0x53710e(_0x4ac6a6[_0x4b8c15(0x250)]);else _0x215ae7[_0x4b8c15(0x22d)](user[_0x4b8c15(0x23e)](_0x3e1646,0x1));}}else _0x31ada1===_0x4ac6a6[_0x4b8c15(0x15c)]&&_0x215ae7[_0x4b8c15(0x22d)](user[_0x4b8c15(0x1a5)](_0x3ec1a7,_0x4b8c15(0x16c),_0x312e23));await Promise[_0x4b8c15(0x15a)](_0x215ae7);_0x2f888c&&await Flags[_0x4b8c15(0x1cb)](_0x312e23,_0x4863e9,{'state':_0x4b8c15(0x134)});const _0x2ce452=await Flags[_0x4b8c15(0x2c4)](_0x312e23);return plugins[_0x4b8c15(0x139)][_0x4b8c15(0x185)](_0x4ac6a6[_0x4b8c15(0x146)],{'flag':_0x2ce452}),_0x2ce452;},Flags[_0x3e9b99(0x263)]=async function(_0xf3a618){const _0x46d19a=_0x3e9b99,_0x4f7cf6={'xjVCo':'categories:cid','sKhux':'flagId','UmWCU':_0x46d19a(0x151)},_0x3b1306=(await db[_0x46d19a(0x1d5)](_0xf3a618[_0x46d19a(0x15f)](_0x157fa9=>_0x46d19a(0x126)+_0x157fa9)))['filter'](Boolean),_0x38d234=_0x3b1306[_0x46d19a(0x15d)](_0x103324=>_0x103324['type']===_0x46d19a(0x27f)),_0x511b00=_0x3b1306['filter'](_0xe6fe4=>_0xe6fe4[_0x46d19a(0x21d)]===_0x46d19a(0x2b1)),_0x345256=_0x3b1306[_0x46d19a(0x15d)](_0x85d389=>!!_0x85d389[_0x46d19a(0x1bd)]),[_0x1f4b50,_0x352482]=await Promise['all']([db['getSortedSetsMembers'](_0x3b1306['map'](_0x4f551a=>_0x46d19a(0x126)+_0x4f551a['flagId']+_0x46d19a(0x2af))),categories[_0x46d19a(0x153)](_0x4f7cf6[_0x46d19a(0x13a)])]),_0xf9721=_0x1f4b50[_0x46d19a(0x15f)](_0x1daf30=>_0x1daf30[_0x46d19a(0x15f)](_0x2a7885=>_0x2a7885&&_0x2a7885[_0x46d19a(0x1d8)](';')[0x0])),_0x222a8e=[];_0x3b1306[_0x46d19a(0x190)]((_0x2913ad,_0x19bb4b)=>{const _0x124fb9=_0x46d19a;Array[_0x124fb9(0x202)](_0xf9721[_0x19bb4b])&&(_0x124fb9(0x2cb)===_0x124fb9(0x1b8)?(_0x2f60a7[_0x124fb9(0x1a1)](_0x124fb9(0x174)+_0x531702[_0x124fb9(0x28e)]),_0x35b69[_0x124fb9(0x201)]={}):_0xf9721[_0x19bb4b][_0x124fb9(0x190)](_0x4aea04=>{const _0x3df9d5=_0x124fb9;_0x222a8e[_0x3df9d5(0x22d)]([_0x3df9d5(0x1d6),[_0x2913ad[_0x3df9d5(0x21d)],_0x2913ad['targetId'],_0x4aea04]['join'](':')]),_0x222a8e[_0x3df9d5(0x22d)](['flags:byReporter:'+_0x4aea04,_0x2913ad[_0x3df9d5(0x16c)]]);}));}),await Promise[_0x46d19a(0x15a)]([db[_0x46d19a(0x1b0)]([..._0x3b1306[_0x46d19a(0x15f)](_0x502de2=>[_0x46d19a(0x265)+_0x502de2['type'],_0x502de2[_0x46d19a(0x16c)]]),..._0x3b1306[_0x46d19a(0x15f)](_0x2c557d=>[_0x46d19a(0x2cf)+_0x2c557d[_0x46d19a(0x2c9)],_0x2c557d[_0x46d19a(0x16c)]]),..._0x222a8e,..._0x38d234[_0x46d19a(0x15f)](_0x40a62e=>[_0x46d19a(0x21a)+_0x40a62e['targetId'],_0x40a62e[_0x46d19a(0x16c)]]),..._0x345256[_0x46d19a(0x15f)](_0x536d60=>[_0x46d19a(0x213)+_0x536d60[_0x46d19a(0x1bd)],_0x536d60[_0x46d19a(0x16c)]]),..._0x511b00[_0x46d19a(0x15f)](_0x20852d=>[_0x46d19a(0x12a)+_0x20852d['targetUid'],_0x20852d[_0x46d19a(0x16c)]])]),db[_0x46d19a(0x149)](_0x38d234[_0x46d19a(0x15f)](_0x4dc8da=>_0x46d19a(0x13d)+_0x4dc8da[_0x46d19a(0x17a)],[_0x4f7cf6[_0x46d19a(0x227)]])),db[_0x46d19a(0x149)](_0x511b00[_0x46d19a(0x15f)](_0x134bc9=>_0x46d19a(0x237)+_0x134bc9[_0x46d19a(0x17a)],[_0x4f7cf6[_0x46d19a(0x227)]])),db[_0x46d19a(0x128)]([..._0xf3a618[_0x46d19a(0x15f)](_0x243cf0=>_0x46d19a(0x126)+_0x243cf0),..._0xf3a618['map'](_0x563abd=>'flag:'+_0x563abd+_0x46d19a(0x187)),..._0xf3a618[_0x46d19a(0x15f)](_0x1832d5=>_0x46d19a(0x126)+_0x1832d5+_0x46d19a(0x2af)),..._0xf3a618['map'](_0x4f77b6=>_0x46d19a(0x126)+_0x4f77b6+_0x46d19a(0x1ef))]),db[_0x46d19a(0x29f)](_0x352482[_0x46d19a(0x15f)](_0x571a09=>_0x46d19a(0x1f0)+_0x571a09),_0xf3a618),db[_0x46d19a(0x29f)](_0x4f7cf6[_0x46d19a(0x2b4)],_0xf3a618),db[_0x46d19a(0x29f)](_0x46d19a(0x212),_0x3b1306[_0x46d19a(0x15f)](_0x465560=>[_0x465560[_0x46d19a(0x21d)],_0x465560['targetId']][_0x46d19a(0x16f)](':')))]);},Flags[_0x3e9b99(0x1c6)]=async function(_0xee8c53){const _0x46cfae=_0x3e9b99,_0x2e27dd={'LuPHB':function(_0x8e839,_0x1fa9c4){return _0x8e839(_0x1fa9c4);},'JWHic':_0x46cfae(0x120),'IhLgq':_0x46cfae(0x18b)},_0x3edd84=await db[_0x46cfae(0x28a)](_0x46cfae(0x126)+_0xee8c53+':reports',0x0,-0x1),[_0x5c5872,_0x52842c]=_0x3edd84[_0x46cfae(0x282)]((_0x2a818b,_0x1cc883)=>{const _0x5e1bc4=_0x46cfae,_0x12ae69=_0x1cc883[_0x5e1bc4(0x2a0)][_0x5e1bc4(0x1d8)](';');return _0x2a818b[0x1][_0x5e1bc4(0x22d)](_0x12ae69[_0x5e1bc4(0x1ae)]()),_0x1cc883['value']=validator[_0x5e1bc4(0x22e)](_0x2e27dd['LuPHB'](String,_0x12ae69[_0x5e1bc4(0x16f)](';'))),_0x2a818b[0x0]['push'](_0x1cc883),_0x2a818b;},[[],[]]);return await Promise['all'](_0x5c5872[_0x46cfae(0x15f)](async(_0x57bbf6,_0x4eb06c)=>{const _0x1296ce=_0x46cfae;_0x57bbf6[_0x1296ce(0x1f9)]=_0x57bbf6[_0x1296ce(0x2b0)],_0x57bbf6['timestampISO']=new Date(_0x57bbf6[_0x1296ce(0x2b0)])['toISOString'](),delete _0x57bbf6[_0x1296ce(0x2b0)],_0x57bbf6[_0x1296ce(0x267)]=await user[_0x1296ce(0x2b7)](_0x52842c[_0x4eb06c],['username',_0x2e27dd[_0x1296ce(0x2c2)],_0x1296ce(0x256),_0x2e27dd['IhLgq']]);})),_0x5c5872;},Flags[_0x3e9b99(0x14f)]=async function(_0x28c963,_0x43b490,_0x1b38c9,_0x531990,_0x155534,_0x5ab927){const _0x56dd10=_0x3e9b99,_0x5ac239={'Jkryb':'action:flags.addReport'};await db['sortedSetAddBulk']([['flags:byReporter:'+_0x531990,_0x5ab927,_0x28c963],[_0x56dd10(0x126)+_0x28c963+':reports',_0x5ab927,[_0x531990,_0x155534][_0x56dd10(0x16f)](';')],['flags:hash',_0x28c963,[_0x43b490,_0x1b38c9,_0x531990]['join'](':')]]),plugins[_0x56dd10(0x139)][_0x56dd10(0x185)](_0x5ac239[_0x56dd10(0x1af)],{'flagId':_0x28c963,'type':_0x43b490,'id':_0x1b38c9,'uid':_0x531990,'reason':_0x155534,'timestamp':_0x5ab927});},Flags[_0x3e9b99(0x14e)]=async(_0x4d130d,_0xbf2131,_0x4bef5e)=>{const _0x182f90=_0x3e9b99,_0x571991={'IvSIE':function(_0x2d47bb,_0x12b43c){return _0x2d47bb===_0x12b43c;},'JLLMn':_0x182f90(0x18e),'acFEt':function(_0x35da7d,_0x1fdd31,_0x186b1a){return _0x35da7d(_0x1fdd31,_0x186b1a);},'SUikE':_0x182f90(0x1d6),'DrRWt':'SNxxe','dwwIJ':_0x182f90(0x25f),'NXZUW':function(_0xfc656e,_0x4e3249){return _0xfc656e<_0x4e3249;},'GNUqi':_0x182f90(0x278)},_0xbacbfd=await Flags[_0x182f90(0x2bd)](_0x4d130d,_0xbf2131,_0x4bef5e);if(!_0xbacbfd)return!![];const _0x1bc3b1=await db['sortedSetScore'](_0x571991[_0x182f90(0x1f3)],[_0x4d130d,_0xbf2131,_0x4bef5e][_0x182f90(0x16f)](':')),_0x23eaf5=await db['getSortedSetMembers'](_0x182f90(0x126)+_0x1bc3b1+':reports');let _0x350628;_0x23eaf5['forEach'](_0xde3be2=>{const _0x7a93a=_0x182f90;if(_0x571991[_0x7a93a(0x199)](_0x571991[_0x7a93a(0x290)],_0x7a93a(0x166)))throw new _0x4376c7(_0x7a93a(0x2c8)+_0x4ee64f+'-flagged-too-many-times]]');else{if(!_0x350628){const [_0x6d789,_0x477850]=_0xde3be2[_0x7a93a(0x1d8)](';');_0x571991[_0x7a93a(0x1e9)](parseInt,_0x6d789,0xa)===parseInt(_0x4bef5e,0xa)&&(_0x350628=_0x477850);}}});if(!_0x350628){if(_0x571991['DrRWt']===_0x571991['DrRWt'])throw new Error(_0x571991[_0x182f90(0x16e)]);else _0x57c4ae[_0x182f90(0x22b)]===0x1?_0x1facb4[_0x182f90(0x22d)](_0x1819cb+_0x179ad6[0x0]):_0x21d683['push'](_0xe056a1[_0x182f90(0x15f)](_0x1b0c5c=>_0x40e4e1+_0x1b0c5c));}await db[_0x182f90(0x1b0)]([[_0x182f90(0x264)+_0x4bef5e,_0x1bc3b1],[_0x182f90(0x126)+_0x1bc3b1+_0x182f90(0x2af),[_0x4bef5e,_0x350628][_0x182f90(0x16f)](';')],[_0x571991[_0x182f90(0x1f3)],[_0x4d130d,_0xbf2131,_0x4bef5e][_0x182f90(0x16f)](':')]]);const _0x5b6165=await db[_0x182f90(0x11e)](_0x182f90(0x126)+_0x1bc3b1+_0x182f90(0x2af));_0x571991[_0x182f90(0x219)](_0x5b6165,0x1)&&(_0x182f90(0x226)===_0x182f90(0x2c3)?_0x2522d0[_0x182f90(0x22d)](_0x3fac33[_0x182f90(0x23e)](_0x30e351,0x1)):await Flags[_0x182f90(0x1cb)](_0x1bc3b1,_0x4bef5e,{'state':_0x182f90(0x1fb),'report':_0x571991[_0x182f90(0x240)]}));},Flags[_0x3e9b99(0x2bd)]=async function(_0x50b25d,_0x390ff2,_0x41ba41){const _0xcc9ea=_0x3e9b99,_0x581ad8={'hPvJA':_0xcc9ea(0x1d6)};return await db[_0xcc9ea(0x223)](_0x581ad8[_0xcc9ea(0x1ba)],[_0x50b25d,_0x390ff2,_0x41ba41]['join'](':'));},Flags[_0x3e9b99(0x27c)]=async(_0x44ee42,_0x5ae6d8)=>{const _0x574afe=_0x3e9b99,_0x47b5b4={'oWhei':function(_0x510617,_0x291500){return _0x510617===_0x291500;},'OrJbV':_0x574afe(0x27f),'eXEHX':function(_0x368ff3,_0x2c4636){return _0x368ff3===_0x2c4636;},'LfwZK':'KUvqx'},_0x53a181=await db['isSortedSetMember'](_0x574afe(0x151),_0x44ee42);if(!_0x53a181)return![];const [{type:_0x3f4ba1,targetId:_0x32483a},_0x5aec0e]=await Promise[_0x574afe(0x15a)]([db[_0x574afe(0x1e3)](_0x574afe(0x126)+_0x44ee42),user[_0x574afe(0x206)](_0x5ae6d8)]);if(_0x47b5b4[_0x574afe(0x29d)](_0x3f4ba1,_0x47b5b4[_0x574afe(0x175)])){if(_0x47b5b4['eXEHX'](_0x574afe(0x12b),_0x47b5b4[_0x574afe(0x122)]))_0x49431e=_0x56efd8;else{const _0x52203e=await Flags[_0x574afe(0x1cd)](_0x3f4ba1,_0x32483a),_0x352bee=await user[_0x574afe(0x2a9)](_0x5ae6d8,_0x52203e);return _0x5aec0e||_0x352bee;}}return _0x5aec0e;},Flags[_0x3e9b99(0x2bb)]=async function(_0x3268af,_0x216811,_0x5d5bb9,_0x5f1799=![]){const _0x477bd3=_0x3e9b99,_0x39d16a={'XkRKh':function(_0x363365,_0x21fe92){return _0x363365*_0x21fe92;},'dcUjl':function(_0x533d38,_0x5214bb){return _0x533d38-_0x5214bb;},'cvsrb':_0x477bd3(0x27d),'GpJJs':_0x477bd3(0x181),'aYCuu':function(_0x214fd1,_0x5b224c){return _0x214fd1>_0x5b224c;},'CNYNs':_0x477bd3(0x2b1),'bELuA':_0x477bd3(0x27f),'CpsdJ':_0x477bd3(0x135),'dOcLd':_0x477bd3(0x208)},_0x55e983=meta[_0x477bd3(0x1de)][_0x477bd3(0x2b9)];if(!_0x5f1799&&_0x55e983>0x0){const _0x14622a=await db[_0x477bd3(0x2c5)](_0x477bd3(0x212),_0x3268af+':'+_0x216811);if(_0x14622a>=_0x55e983)throw new Error('[[error:'+_0x3268af+_0x477bd3(0x2bc));}const _0x2205ff=_0x39d16a[_0x477bd3(0x298)](0x18*0x3c*0x3c,0x3e8),_0x2e7258=Date[_0x477bd3(0x2ba)](),[_0x3d22e3,_0x493fd3,_0x335eed]=await Promise[_0x477bd3(0x15a)]([db['getSortedSetRangeByScore'](_0x477bd3(0x264)+_0x5d5bb9,0x0,-0x1,_0x39d16a[_0x477bd3(0x1ce)](_0x2e7258,_0x2205ff),_0x39d16a['cvsrb']),privileges[_0x477bd3(0x22a)]['can'](_0x39d16a[_0x477bd3(0x2a3)],_0x216811,_0x5d5bb9),user['isPrivileged'](_0x5d5bb9)]),_0x52718a=meta[_0x477bd3(0x1de)][_0x477bd3(0x279)+_0x3268af+_0x477bd3(0x1dd)];if(!_0x335eed&&_0x39d16a[_0x477bd3(0x18c)](_0x52718a,0x0)){const _0x2abffd=await db['getObjects'](_0x3d22e3['map'](_0x407fe1=>'flag:'+_0x407fe1)),_0x354ef1=_0x2abffd['filter'](_0x514d4f=>_0x514d4f&&_0x514d4f[_0x477bd3(0x21d)]===_0x3268af);if(_0x39d16a[_0x477bd3(0x18c)](_0x52718a,0x0)&&_0x354ef1['length']>_0x52718a)throw new Error(_0x477bd3(0x16d)+_0x3268af+_0x477bd3(0x17d)+_0x52718a+']]');}switch(_0x3268af){case _0x39d16a[_0x477bd3(0x169)]:return!![];case _0x39d16a[_0x477bd3(0x260)]:if(!_0x493fd3)throw new Error(_0x39d16a['CpsdJ']);break;default:throw new Error(_0x39d16a[_0x477bd3(0x261)]);}},Flags[_0x3e9b99(0x2be)]=async function(_0x35713d,_0x6ff9b6,_0xed3fcf){const _0x5c30b8=_0x3e9b99,_0x34daf9={'cwVng':function(_0x4ae911,_0x563373){return _0x4ae911===_0x563373;},'HLaCj':_0x5c30b8(0x2b1),'Tvxku':'[[error:invalid-data]]'};if(_0x34daf9[_0x5c30b8(0x1e5)](_0x35713d,_0x34daf9['HLaCj'])){const _0x122e51=await user[_0x5c30b8(0x2ad)](_0x6ff9b6);return _0x122e51&&_0x122e51['uid']?_0x122e51:{};}if(_0x34daf9[_0x5c30b8(0x1e5)](_0x35713d,_0x5c30b8(0x27f))){let _0x1328c1=await posts[_0x5c30b8(0x1f6)](_0x6ff9b6);if(!_0x1328c1)return{};return _0x1328c1=await posts[_0x5c30b8(0x287)](_0x1328c1),_0x1328c1=await topics[_0x5c30b8(0x280)]([_0x1328c1],_0xed3fcf),_0x1328c1[0x0];}throw new Error(_0x34daf9[_0x5c30b8(0x262)]);},Flags['targetExists']=async function(_0x37e90d,_0x1ab07e){const _0x4350dc=_0x3e9b99,_0x5710f1={'Fpvkk':function(_0x2d1e97,_0x566199){return _0x2d1e97===_0x566199;},'RrLqB':_0x4350dc(0x27f),'mCqNh':function(_0x1cb7f2,_0x257680){return _0x1cb7f2===_0x257680;}};if(_0x5710f1[_0x4350dc(0x189)](_0x37e90d,_0x5710f1[_0x4350dc(0x26c)]))return await posts[_0x4350dc(0x2bd)](_0x1ab07e);else{if(_0x5710f1[_0x4350dc(0x19e)](_0x37e90d,'user'))return await user[_0x4350dc(0x2bd)](_0x1ab07e);}throw new Error('[[error:invalid-data]]');},Flags[_0x3e9b99(0x2a4)]=async function(_0x20d705,_0x1bf682){const _0x3bfa61=_0x3e9b99,_0x283854={'UHlkk':function(_0x3eed04,_0x10c641){return _0x3eed04>=_0x10c641;},'QwYGq':'flags:byTarget'};return _0x283854['UHlkk'](await db[_0x3bfa61(0x2c5)](_0x283854[_0x3bfa61(0x234)],[_0x20d705,_0x1bf682][_0x3bfa61(0x16f)](':')),0x1);},Flags[_0x3e9b99(0x273)]=async function(_0x9107c,_0x3380b0){const _0x510e7d=_0x3e9b99,_0x5db635={'wGKxo':function(_0x4421bb,_0x49dccd){return _0x4421bb===_0x49dccd;},'dxJKh':_0x510e7d(0x18a)};if(_0x5db635[_0x510e7d(0x26f)](_0x9107c,_0x510e7d(0x27f)))return await posts[_0x510e7d(0x270)](_0x3380b0,_0x5db635[_0x510e7d(0x1fc)]);return _0x3380b0;},Flags['getTargetCid']=async function(_0x4375d9,_0x176772){const _0x33aaa5=_0x3e9b99,_0x11f5fe={'PKyOx':function(_0x46c986,_0x5cffc5){return _0x46c986===_0x5cffc5;}};if(_0x11f5fe[_0x33aaa5(0x218)](_0x4375d9,_0x33aaa5(0x27f)))return await posts[_0x33aaa5(0x1a6)](_0x176772);return null;},Flags[_0x3e9b99(0x1cb)]=async function(_0x2ac5dc,_0x449b52,_0x5b3788){const _0x2f7f79=_0x3e9b99,_0x36bd14={'Otklx':function(_0xecb9bd,_0x4a26d1,_0x3b4952){return _0xecb9bd(_0x4a26d1,_0x3b4952);},'ZxPQm':function(_0x3567f6,_0x1bb146){return _0x3567f6===_0x1bb146;},'LsLVW':_0x2f7f79(0x27f),'XfLhG':_0x2f7f79(0x1fa),'FCykz':_0x2f7f79(0x208),'jGiYh':'flags:byTargetUid:','NWkXZ':_0x2f7f79(0x18a),'BohJI':_0x2f7f79(0x2c9),'mrNky':_0x2f7f79(0x1bd),'Ofskx':'type','GpjCx':'targetId','SCXHJ':function(_0x4593e1,_0x586747){return _0x4593e1===_0x586747;},'GqNmZ':function(_0x33a7b7,_0x2cf281){return _0x33a7b7===_0x2cf281;},'wismm':'HzADy','KECGZ':function(_0x8ce23e,_0x95021f){return _0x8ce23e===_0x95021f;},'ErKEU':_0x2f7f79(0x1ea),'yapxU':'rescind','ijCAA':function(_0x1ffddd,_0x4eaeaa){return _0x1ffddd!==_0x4eaeaa;},'sSwUf':_0x2f7f79(0x28d),'hKvBZ':function(_0x48af92,_0x63a1c6){return _0x48af92(_0x63a1c6);},'mGMpE':_0x2f7f79(0x241),'CrCdK':_0x2f7f79(0x236),'uKXWN':function(_0x3b66a9,_0x2d94e2){return _0x3b66a9(_0x2d94e2);}},_0x11cdf1=await db[_0x2f7f79(0x248)](_0x2f7f79(0x126)+_0x2ac5dc,[_0x36bd14[_0x2f7f79(0x1d1)],_0x36bd14[_0x2f7f79(0x1e7)],_0x36bd14['mrNky'],_0x36bd14[_0x2f7f79(0x253)],_0x36bd14[_0x2f7f79(0x20a)]]);if(!_0x11cdf1[_0x2f7f79(0x21d)])return;const _0x2c91d1=_0x5b3788['datetime']||Date['now'](),_0x5201b6=async function(_0x388a40){const _0x404933=_0x2f7f79;if(_0x388a40===''||parseInt(_0x449b52,0xa)===_0x36bd14[_0x404933(0x285)](parseInt,_0x388a40,0xa))return;const _0xe021e8=await notifications['create']({'type':_0x404933(0x17f),'bodyShort':_0x404933(0x24a)+_0x2ac5dc+']]','bodyLong':'','path':_0x404933(0x132)+_0x2ac5dc,'nid':_0x404933(0x21c)+_0x2ac5dc+_0x404933(0x27b)+_0x388a40,'from':_0x449b52});await notifications[_0x404933(0x22d)](_0xe021e8,[_0x388a40]);},_0x2e9a35=async function(_0xf53fa2){const _0x102c8e=_0x2f7f79;let _0x4ec164=![];_0x4ec164=await user['isAdminOrGlobalMod'](_0xf53fa2);if(!_0x4ec164&&_0x36bd14['ZxPQm'](_0x11cdf1['type'],_0x36bd14['LsLVW'])){const _0x230af5=await posts[_0x102c8e(0x1a6)](_0x11cdf1[_0x102c8e(0x17a)]);_0x4ec164=await user[_0x102c8e(0x2a9)](_0xf53fa2,_0x230af5);}return _0x4ec164;};async function _0x54f77b(_0xe8aff7){const _0xcd775e=_0x2f7f79,_0x1c0152=await db[_0xcd775e(0x1c9)]({'key':_0x36bd14['XfLhG'],'match':_0xe8aff7+'*'});return notifications[_0xcd775e(0x243)](_0x1c0152);}const _0x20bae9=[];for(const _0x416dfa of Object[_0x2f7f79(0x2b2)](_0x5b3788)){if(_0x36bd14[_0x2f7f79(0x29c)](_0x11cdf1[_0x416dfa],_0x5b3788[_0x416dfa]))delete _0x5b3788[_0x416dfa];else{if(_0x36bd14[_0x2f7f79(0x29c)](_0x416dfa,_0x2f7f79(0x2c9))){if(!Flags[_0x2f7f79(0x155)][_0x2f7f79(0x27e)](_0x5b3788[_0x416dfa]))delete _0x5b3788[_0x416dfa];else{if(_0x36bd14['GqNmZ'](_0x2f7f79(0x269),_0x36bd14[_0x2f7f79(0x214)]))throw new _0xaacc96(_0x36bd14[_0x2f7f79(0x293)]);else{_0x20bae9[_0x2f7f79(0x22d)](db[_0x2f7f79(0x1b1)](_0x2f7f79(0x2cf)+_0x5b3788[_0x416dfa],_0x2c91d1,_0x2ac5dc)),_0x20bae9[_0x2f7f79(0x22d)](db[_0x2f7f79(0x29f)](_0x2f7f79(0x2cf)+_0x11cdf1[_0x416dfa],_0x2ac5dc));_0x36bd14[_0x2f7f79(0x29c)](_0x5b3788[_0x416dfa],_0x2f7f79(0x1fb))&&_0x36bd14['KECGZ'](meta[_0x2f7f79(0x1de)][_0x36bd14[_0x2f7f79(0x252)]],_0x36bd14[_0x2f7f79(0x247)])&&(_0x36bd14[_0x2f7f79(0x209)](_0x36bd14[_0x2f7f79(0x230)],_0x2f7f79(0x28d))?_0x54446a(_0x4e9a49,_0x2a840c,_0x36bd14[_0x2f7f79(0x140)],_0x9135d6):_0x20bae9[_0x2f7f79(0x22d)](_0x36bd14[_0x2f7f79(0x130)](_0x54f77b,_0x2f7f79(0x126)+_0x11cdf1[_0x2f7f79(0x21d)]+':'+_0x11cdf1[_0x2f7f79(0x17a)])));if(_0x36bd14['KECGZ'](_0x5b3788[_0x416dfa],_0x36bd14[_0x2f7f79(0x266)])&&_0x36bd14[_0x2f7f79(0x232)](meta[_0x2f7f79(0x1de)]['flags:actionOnReject'],_0x36bd14[_0x2f7f79(0x247)])){if(_0x36bd14[_0x2f7f79(0x249)]!=='JbsPn')_0x20bae9['push'](_0x36bd14[_0x2f7f79(0x124)](_0x54f77b,'flag:'+_0x11cdf1['type']+':'+_0x11cdf1[_0x2f7f79(0x17a)]));else throw new _0x488dcc(_0x2f7f79(0x193)+_0x4b9fe0[_0x2f7f79(0x1de)][_0x2f7f79(0x1b2)]+']]');}}}}else{if(_0x416dfa===_0x36bd14[_0x2f7f79(0x13f)]){if(_0x5b3788[_0x416dfa]==='')_0x20bae9[_0x2f7f79(0x22d)](db['sortedSetRemove'](_0x2f7f79(0x213)+_0x5b3788[_0x416dfa],_0x2ac5dc));else!await _0x2e9a35(_0x36bd14[_0x2f7f79(0x285)](parseInt,_0x5b3788[_0x416dfa],0xa))?delete _0x5b3788[_0x416dfa]:(_0x20bae9[_0x2f7f79(0x22d)](db[_0x2f7f79(0x1b1)](_0x2f7f79(0x213)+_0x5b3788[_0x416dfa],_0x2c91d1,_0x2ac5dc)),_0x20bae9[_0x2f7f79(0x22d)](_0x5201b6(_0x5b3788[_0x416dfa])));}}}}if(!Object[_0x2f7f79(0x2b2)](_0x5b3788)[_0x2f7f79(0x22b)])return;_0x20bae9[_0x2f7f79(0x22d)](db['setObject']('flag:'+_0x2ac5dc,_0x5b3788)),_0x20bae9[_0x2f7f79(0x22d)](Flags['appendHistory'](_0x2ac5dc,_0x449b52,_0x5b3788)),await Promise[_0x2f7f79(0x15a)](_0x20bae9),plugins['hooks']['fire'](_0x2f7f79(0x12c),{'flagId':_0x2ac5dc,'changeset':_0x5b3788,'uid':_0x449b52});},Flags[_0x3e9b99(0x145)]=async function(_0x8ccb96,_0x31c353,_0x40dc62){const _0x424b4c=_0x3e9b99,_0x4e0d6f={'PkdIE':_0x424b4c(0x1fb)},_0xc11783=await Flags['getFlagIdByTarget'](_0x8ccb96,_0x31c353);parseInt(_0xc11783,0xa)&&await Flags['update'](_0xc11783,_0x40dc62,{'state':_0x4e0d6f[_0x424b4c(0x1b7)]});},Flags[_0x3e9b99(0x22f)]=async function(_0xc28b1f,_0x356a61){const _0x493433=_0x3e9b99,_0x226d2e={'yhuTo':function(_0x4c4fca,_0x3c965e){return _0x4c4fca!==_0x3c965e;},'uOJBZ':'PbOwb','CcnCl':_0x493433(0x1d2),'pxvSb':_0x493433(0x1fb),'MLFft':'flags:autoResolveOnBan'};meta[_0x493433(0x1de)][_0x226d2e[_0x493433(0x207)]]&&await batch[_0x493433(0x2ce)]('uid:'+_0xc28b1f+':posts',async _0x547d69=>{const _0xc162ea=_0x493433;if(_0x226d2e[_0xc162ea(0x17e)](_0x226d2e[_0xc162ea(0x179)],_0x226d2e['uOJBZ']))throw new _0xa62825(_0xc162ea(0x208));else{let _0x4764a1=await posts[_0xc162ea(0x2c1)](_0x547d69,[_0x226d2e[_0xc162ea(0x184)],_0xc162ea(0x16c)]);_0x4764a1=_0x4764a1[_0xc162ea(0x15d)](_0x4b3a13=>_0x4b3a13&&_0x4b3a13[_0xc162ea(0x16c)]&&parseInt(_0x4b3a13[_0xc162ea(0x16c)],0xa));for(const _0x568ae3 of _0x4764a1){await Flags[_0xc162ea(0x1cb)](_0x568ae3['flagId'],_0x356a61,{'state':_0x226d2e['pxvSb']});}}},{'batch':0x1f4});},Flags[_0x3e9b99(0x1bb)]=async function(_0x41e258){const _0x130268=_0x3e9b99,_0x22b86a={'MPbII':_0x130268(0x133),'uawtR':function(_0x535f56,_0x53f84d){return _0x535f56===_0x53f84d;},'FRAOl':_0x130268(0x1bd),'ANKhm':function(_0x5cb9f4,_0x149a1e,_0x47283a,_0x579c9d){return _0x5cb9f4(_0x149a1e,_0x47283a,_0x579c9d);},'XyKBc':_0x130268(0x256)},_0x29ab2e=[];let _0x34bd61=await db['getSortedSetRevRangeWithScores']('flag:'+_0x41e258+':history',0x0,-0x1);const _0x215abc=await db[_0x130268(0x1d0)](_0x130268(0x126)+_0x41e258,_0x130268(0x1b3));_0x34bd61=_0x34bd61[_0x130268(0x15f)](_0x427eef=>{const _0x170dab=_0x130268;if(_0x22b86a[_0x170dab(0x281)]===_0x170dab(0x133)){_0x427eef[_0x170dab(0x2a0)]=JSON[_0x170dab(0x19b)](_0x427eef[_0x170dab(0x2a0)]),_0x29ab2e[_0x170dab(0x22d)](_0x427eef[_0x170dab(0x2a0)][0x0]);const _0x40489b=_0x427eef['value'][0x1];return _0x40489b[_0x170dab(0x158)](_0x170dab(0x2c9))&&(_0x40489b[_0x170dab(0x2c9)]=_0x22b86a[_0x170dab(0x14b)](_0x40489b[_0x170dab(0x2c9)],undefined)?'':_0x170dab(0x1f8)+_0x40489b[_0x170dab(0x2c9)]+']]'),_0x40489b[_0x170dab(0x158)](_0x170dab(0x1db))&&(_0x40489b['report']=_0x170dab(0x2b3)+_0x40489b[_0x170dab(0x1db)]+']]'),{'uid':_0x427eef['value'][0x0],'fields':_0x40489b,'datetime':_0x427eef[_0x170dab(0x2b0)],'datetimeISO':utils['toISOString'](_0x427eef[_0x170dab(0x2b0)])};}else delete _0x4d3ae8[_0x454953];}),await Promise['all'](_0x34bd61[_0x130268(0x15f)](async _0x1bdf77=>{const _0x50fa65=_0x130268;_0x1bdf77['fields'][_0x50fa65(0x158)](_0x22b86a[_0x50fa65(0x1e1)])&&(_0x1bdf77[_0x50fa65(0x2d0)][_0x50fa65(0x1bd)]=await user[_0x50fa65(0x268)](_0x1bdf77[_0x50fa65(0x2d0)][_0x50fa65(0x1bd)],_0x50fa65(0x180)));})),_0x34bd61=await mergeBanHistory(_0x34bd61,_0x215abc,_0x29ab2e),_0x34bd61=await _0x22b86a[_0x130268(0x23c)](mergeMuteHistory,_0x34bd61,_0x215abc,_0x29ab2e),_0x34bd61=await mergeUsernameEmailChanges(_0x34bd61,_0x215abc,_0x29ab2e);const _0x3c5bc5=await user[_0x130268(0x1ee)](_0x29ab2e,[_0x130268(0x180),_0x130268(0x120),_0x22b86a[_0x130268(0x1e0)]]);return _0x34bd61[_0x130268(0x190)]((_0x26954a,_0x32ba65)=>{const _0x33a7db=_0x130268;_0x26954a[_0x33a7db(0x2b1)]=_0x3c5bc5[_0x32ba65];}),_0x34bd61=_0x34bd61[_0x130268(0x1cf)]((_0x593b69,_0x276616)=>_0x276616[_0x130268(0x11f)]-_0x593b69['datetime']),_0x34bd61;},Flags[_0x3e9b99(0x13e)]=async function(_0x188828,_0x10392e,_0x303c63){const _0x22b961=_0x3e9b99,_0x12b835=_0x303c63['datetime']||Date[_0x22b961(0x2ba)]();delete _0x303c63['datetime'];const _0xc172df=JSON[_0x22b961(0x18f)]([_0x10392e,_0x303c63,_0x12b835]);await db['sortedSetAdd'](_0x22b961(0x126)+_0x188828+_0x22b961(0x1ef),_0x12b835,_0xc172df);},Flags[_0x3e9b99(0x178)]=async function(_0x145aff,_0x5e99b3,_0x29fb8b,_0x12a682){const _0x71f945=_0x3e9b99,_0x28fba2={'eiqVp':function(_0x19515a,_0x2f1435){return _0x19515a!==_0x2f1435;},'AfyKR':_0x71f945(0x1b5),'rzdhp':function(_0x570346,_0x3b5fae){return _0x570346===_0x3b5fae;}};if(_0x12a682)try{_0x28fba2[_0x71f945(0x220)](_0x28fba2[_0x71f945(0x131)],_0x28fba2['AfyKR'])?_0x9208ad[_0x71f945(0x22d)](_0x54578b(_0x71f945(0x126)+_0x242004[_0x71f945(0x21d)]+':'+_0x2adce6['targetId'])):await Flags[_0x71f945(0x1aa)](_0x145aff,_0x12a682);}catch(_0x203ba7){if(_0x28fba2[_0x71f945(0x245)](!_0x203ba7[_0x71f945(0x137)],_0x71f945(0x208)))throw _0x203ba7;}_0x12a682=_0x12a682||Date['now']();const _0x4ca5c9=JSON['stringify']([_0x5e99b3,_0x29fb8b]);await db[_0x71f945(0x1b1)](_0x71f945(0x126)+_0x145aff+':notes',_0x12a682,_0x4ca5c9),await Flags[_0x71f945(0x13e)](_0x145aff,_0x5e99b3,{'notes':null,'datetime':_0x12a682});},Flags[_0x3e9b99(0x156)]=async function(_0xd6b827,_0x31192a,_0x51bf00=![]){const _0x6a50e1=_0x3e9b99,_0x3f8a23={'GaQDV':_0x6a50e1(0x1be),'ZKiSI':function(_0x3289ae,_0x5e1264){return _0x3289ae-_0x5e1264;},'PlTPb':_0x6a50e1(0x1e6),'YdBkj':function(_0x3274dc,_0x169c82){return _0x3274dc===_0x169c82;},'szdrd':_0x6a50e1(0x1a2),'RKGSJ':function(_0x19acab,_0x181a1e){return _0x19acab(_0x181a1e);},'VPoem':_0x6a50e1(0x15b)},[_0x12c3a2,_0x2fb3ea]=await Promise[_0x6a50e1(0x15a)]([groups['getMembers'](_0x6a50e1(0x14c),0x0,-0x1),groups[_0x6a50e1(0x251)](_0x3f8a23[_0x6a50e1(0x277)],0x0,-0x1)]);let _0x1e7d97=_0x12c3a2[_0x6a50e1(0x172)](_0x2fb3ea),_0x104cfb=null;const {displayname:_0x5e2bf2}=_0xd6b827[_0x6a50e1(0x147)][_0x3f8a23[_0x6a50e1(0x244)](_0xd6b827[_0x6a50e1(0x147)][_0x6a50e1(0x22b)],0x1)][_0x6a50e1(0x267)];if(_0xd6b827['type']===_0x6a50e1(0x27f)){const [_0x4b43e2,_0x1a7360]=await Promise[_0x6a50e1(0x15a)]([topics['getTitleByPid'](_0xd6b827[_0x6a50e1(0x17a)]),posts['getCidByPid'](_0xd6b827[_0x6a50e1(0x17a)])]),_0x2b30bb=await categories['getModeratorUids']([_0x1a7360]),_0x4409b8=utils['decodeHTMLEntities'](_0x4b43e2)[_0x6a50e1(0x257)](/%/g,_0x6a50e1(0x23f))[_0x6a50e1(0x257)](/,/g,_0x6a50e1(0x259));_0x104cfb=await notifications[_0x6a50e1(0x26e)]({'type':_0x6a50e1(0x276),'bodyShort':_0x6a50e1(0x1a4)+_0x5e2bf2+',\x20'+_0x4409b8+']]','bodyLong':await plugins[_0x6a50e1(0x139)][_0x6a50e1(0x185)](_0x3f8a23[_0x6a50e1(0x14a)],String(_0xd6b827[_0x6a50e1(0x171)]||'')),'pid':_0xd6b827[_0x6a50e1(0x17a)],'path':'/flags/'+_0xd6b827[_0x6a50e1(0x16c)],'nid':_0x6a50e1(0x24e)+_0xd6b827[_0x6a50e1(0x17a)]+':'+_0x31192a,'from':_0x31192a,'mergeId':_0x6a50e1(0x20e)+_0xd6b827[_0x6a50e1(0x17a)],'topicTitle':_0x4b43e2}),_0x1e7d97=_0x1e7d97[_0x6a50e1(0x172)](_0x2b30bb[0x0]);}else{if(_0x3f8a23[_0x6a50e1(0x20b)](_0xd6b827['type'],'user')){const _0x219f2f=_0xd6b827['target']&&_0xd6b827[_0x6a50e1(0x1b4)][_0x6a50e1(0x144)]?_0xd6b827[_0x6a50e1(0x1b4)][_0x6a50e1(0x144)]:_0x3f8a23[_0x6a50e1(0x23a)];_0x104cfb=await notifications[_0x6a50e1(0x26e)]({'type':_0x6a50e1(0x161),'bodyShort':'[[notifications:user-flagged-user,\x20'+_0x5e2bf2+',\x20'+_0x219f2f+']]','bodyLong':await plugins[_0x6a50e1(0x139)]['fire'](_0x3f8a23[_0x6a50e1(0x14a)],_0x3f8a23[_0x6a50e1(0x196)](String,_0xd6b827['description']||'')),'path':_0x6a50e1(0x132)+_0xd6b827[_0x6a50e1(0x16c)],'nid':'flag:user:'+_0xd6b827[_0x6a50e1(0x17a)]+':'+_0x31192a,'from':_0x31192a,'mergeId':'notifications:user-flagged-user|'+_0xd6b827['targetId']});}else throw new Error(_0x6a50e1(0x208));}plugins[_0x6a50e1(0x139)][_0x6a50e1(0x185)](_0x3f8a23[_0x6a50e1(0x21b)],{'flag':_0xd6b827,'notification':_0x104cfb,'from':_0x31192a,'to':_0x1e7d97}),!_0x51bf00&&(_0x1e7d97=_0x1e7d97[_0x6a50e1(0x15d)](_0x36303f=>parseInt(_0x36303f,0xa)!==parseInt(_0x31192a,0xa))),await notifications[_0x6a50e1(0x22d)](_0x104cfb,_0x1e7d97);};async function mergeBanHistory(_0xd65b35,_0x5c4496,_0x3d98b9){const _0x5093b0=_0x3e9b99,_0x3c1876={'CUoli':function(_0x42750e,_0x2d3be9,_0x11ab7c,_0x15acdb){return _0x42750e(_0x2d3be9,_0x11ab7c,_0x15acdb);},'bUwcI':_0x5093b0(0x2aa),'kXLMY':_0x5093b0(0x186),'SHQMh':'[[user:info.banned-expiry]]'};return await _0x3c1876[_0x5093b0(0x157)](mergeBanMuteHistory,_0xd65b35,_0x3d98b9,{'set':_0x5093b0(0x299)+_0x5c4496+':bans:timestamp','label':_0x3c1876['bUwcI'],'reasonDefault':_0x3c1876[_0x5093b0(0x210)],'expiryKey':_0x3c1876[_0x5093b0(0x28b)]});}async function mergeMuteHistory(_0x1faffe,_0x5baa1f,_0x2b790f){const _0x1fb17f=_0x3e9b99,_0x2497e0={'QPSOg':function(_0x2d1981,_0x3389b2,_0x4ac82a,_0x14780b){return _0x2d1981(_0x3389b2,_0x4ac82a,_0x14780b);},'yUQgY':_0x1fb17f(0x229)};return await _0x2497e0['QPSOg'](mergeBanMuteHistory,_0x1faffe,_0x2b790f,{'set':_0x1fb17f(0x299)+_0x5baa1f+_0x1fb17f(0x1fe),'label':_0x1fb17f(0x255),'reasonDefault':_0x2497e0[_0x1fb17f(0x29a)],'expiryKey':'[[user:info.muted-expiry]]'});}async function mergeBanMuteHistory(_0xacd081,_0x3b0241,_0x5ae6be){const _0x103d4d=_0x3e9b99,_0x35b328={'CsVFc':_0x103d4d(0x291),'PLjPK':function(_0x2a5504,_0x28ad8d,_0x7a6b4c){return _0x2a5504(_0x28ad8d,_0x7a6b4c);},'fGKCa':function(_0x54fa89,_0x9e700d,_0x42e0f2){return _0x54fa89(_0x9e700d,_0x42e0f2);}};let _0x1d0995=await db[_0x103d4d(0x242)](_0x5ae6be[_0x103d4d(0x1a9)],0x0,0x13);return _0x1d0995=await db[_0x103d4d(0x1d5)](_0x1d0995),_0xacd081[_0x103d4d(0x172)](_0x1d0995['reduce']((_0xc060b9,_0x22d55e)=>{const _0x3231e3=_0x103d4d;return _0x3b0241[_0x3231e3(0x22d)](_0x22d55e['fromUid']),_0xc060b9[_0x3231e3(0x22d)]({'uid':_0x22d55e[_0x3231e3(0x148)],'meta':[{'key':_0x5ae6be[_0x3231e3(0x1d7)],'value':validator['escape'](String(_0x22d55e['reason']||_0x5ae6be[_0x3231e3(0x192)])),'labelClass':_0x35b328['CsVFc']},{'key':_0x5ae6be[_0x3231e3(0x1f5)],'value':new Date(_0x35b328[_0x3231e3(0x26d)](parseInt,_0x22d55e[_0x3231e3(0x1f1)],0xa))[_0x3231e3(0x21e)](),'labelClass':_0x3231e3(0x165)}],'datetime':_0x35b328[_0x3231e3(0x2a6)](parseInt,_0x22d55e[_0x3231e3(0x1f9)],0xa),'datetimeISO':utils[_0x3231e3(0x21e)](parseInt(_0x22d55e[_0x3231e3(0x1f9)],0xa))}),_0xc060b9;},[]));}async function mergeUsernameEmailChanges(_0x434441,_0x29d613,_0x169b0f){const _0x17ee0c=_0x3e9b99,_0x5d2fd2={'RHFRr':_0x17ee0c(0x163)},_0x5d93e6=await user[_0x17ee0c(0x1bb)](_0x17ee0c(0x237)+_0x29d613+_0x17ee0c(0x177)),_0x1543d9=await user[_0x17ee0c(0x1bb)]('user:'+_0x29d613+_0x17ee0c(0x271));return _0x434441['concat'](_0x5d93e6[_0x17ee0c(0x282)]((_0x1e7bab,_0x1826b2)=>{const _0xab1040=_0x17ee0c;return _0x169b0f[_0xab1040(0x22d)](_0x29d613),_0x1e7bab[_0xab1040(0x22d)]({'uid':_0x29d613,'meta':[{'key':_0xab1040(0x200),'value':_0x1826b2[_0xab1040(0x2a0)],'labelClass':_0x5d2fd2[_0xab1040(0x150)]}],'datetime':_0x1826b2[_0xab1040(0x1f9)],'datetimeISO':_0x1826b2[_0xab1040(0x1e4)]}),_0x1e7bab;},[]))[_0x17ee0c(0x172)](_0x1543d9['reduce']((_0x153dec,_0x479fbd)=>{const _0x23945a=_0x17ee0c;return _0x169b0f[_0x23945a(0x22d)](_0x29d613),_0x153dec[_0x23945a(0x22d)]({'uid':_0x29d613,'meta':[{'key':_0x23945a(0x24f),'value':_0x479fbd[_0x23945a(0x2a0)],'labelClass':_0x23945a(0x163)}],'datetime':_0x479fbd['timestamp'],'datetimeISO':_0x479fbd[_0x23945a(0x1e4)]}),_0x153dec;},[]));}function _0x3f8b(_0x54d7a7,_0x99df55){const _0x31b34d=_0x31b3();return _0x3f8b=function(_0x3f8bfe,_0x3ac1bc){_0x3f8bfe=_0x3f8bfe-0x11c;let _0x256460=_0x31b34d[_0x3f8bfe];return _0x256460;},_0x3f8b(_0x54d7a7,_0x99df55);}require(_0x3e9b99(0x20f))(Flags);