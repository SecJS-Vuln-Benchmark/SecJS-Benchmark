'use strict';const _0x6b832b=_0x4e8b;(function(_0x1d04fe,_0x50d147){const _0x2ef4ba=_0x4e8b,_0x205b66=_0x1d04fe();while(!![]){try{const _0x4ee7e0=parseInt(_0x2ef4ba(0x31e))/0x1+parseInt(_0x2ef4ba(0x263))/0x2+parseInt(_0x2ef4ba(0x21e))/0x3+-parseInt(_0x2ef4ba(0x2f0))/0x4*(-parseInt(_0x2ef4ba(0x24f))/0x5)+parseInt(_0x2ef4ba(0x29a))/0x6*(-parseInt(_0x2ef4ba(0x341))/0x7)+parseInt(_0x2ef4ba(0x1ee))/0x8+parseInt(_0x2ef4ba(0x255))/0x9*(-parseInt(_0x2ef4ba(0x227))/0xa);if(_0x4ee7e0===_0x50d147)break;else _0x205b66['push'](_0x205b66['shift']());}catch(_0x25fae3){_0x205b66['push'](_0x205b66['shift']());}}}(_0x3ecb,0x9c33a));const _=require(_0x6b832b(0x22e)),winston=require(_0x6b832b(0x303)),validator=require('validator'),db=require(_0x6b832b(0x2f3)),user=require(_0x6b832b(0x2d8)),groups=require(_0x6b832b(0x2cb)),meta=require(_0x6b832b(0x201)),notifications=require(_0x6b832b(0x2a5)),analytics=require(_0x6b832b(0x1e5)),categories=require(_0x6b832b(0x2ef)),topics=require(_0x6b832b(0x233)),posts=require('./posts'),privileges=require(_0x6b832b(0x2f6)),plugins=require(_0x6b832b(0x321)),utils=require(_0x6b832b(0x2eb)),batch=require(_0x6b832b(0x1de)),Flags=module[_0x6b832b(0x250)];function _0x3ecb(){const _0x1d7bd9=['secondary','qsOkE','reason','sGOes','[[error:too-many-','sortedSetIncrBy','HRlyT','GELIV','GsuqU','[[error:cant-flag-privileged]]','default','Cvesz','tvYKV','displayname','user:','exists','reputation','open','mKApt','3368904mZHtTA','uRTaU','flags','ibUJp','rplFx','VzWsu','replace','canFlag','[[error:no-privileges]]','10BbuANg','fields','flags:actionOnResolve','increment','LBBET','aFleq','lYKTF','lodash','HQNQy','timestampISO','getHistory','flags:datetime','./topics','getSortedSetRangeByScoreWithScores','Mrigi','flag:user:',':emails','isAdminOrGlobalMod','class','KxZUV','[[user:change-email]]','global','mINez','bmQra','NTNJT','ctNcB','lnVvO','tFojk','flags:autoResolveOnBan','KooeV','[[notifications:flag-assigned-to-you,\x20','type','validate','hwTUU','picture','PjiUn','create','getSortedSetRangeByScore','has','Dstlp','415FuxyCR','exports','error','&#37;','UzjKn','sortedSetRemoveBulk','25923321lidwfK','getObjectField',':history','JfBKm','dmMCr','MAX','PFzOv','sort','PgdsE','ZlDBY','bctHg','kjkTy','addReport','state','1266626AJJgul','bKoJo','QJRYc','value','QqVVZ','abs','map','MOKiR','WRLKH','union','isSortedSetMember','uhdqt','flags:byTarget','targetId','forEach','get','oorNE','[[error:no-user]]','gPTqC','flags:','flags:byAssignee:','length','reduce','HzpOm','[[error:invalid-data]]','[[user:info.banned-no-reason]]',':reports','action:flags.notify','fire','deleteAll','[[flags:state-rejected]]','IUvyw','getObjectsFields','tbGAq','_filters','rejected','reverse','reporter','Ewsdm','decodeHTMLEntities','cHIxZ','getMembers','zCmfk','getModeratorUids','QhYwU','iMrlR','incrementUserFlagsBy','filter:flags.init','sortedSetAdd','unHjU','ggayI','JCMdR','aOcJQ','filter:flags.list','eKAkn','42996ruabij','report','uskZJ','all','iJtIn','liqYQ','getPostsFields','filter:flags.get','[[error:cant-locate-flag-report]]','&#44;','filter:flags.getFlagIdsWithFilters','./notifications','username','getFlagIdsWithFilters','warning','getTargetCid','[[global:guest]]','+inf','MMxdP','[[error:no-flag]]','vJYqK','shift','getCidByPid','userslug','appendNote','fViHa','getSortedSetMembers','RHaZW','escape','filters','CJvdD','uid','ZVydd','canView','toISOString','new-user-flag',':mutes:timestamp','getSortedSetRevRange','filter:parse.raw','UGTNU','targetExists','TjWMJ','join','QyJbt','wcjhg','concat','URrzR','uid:','hooks','./groups','targetUid','flags:byPid:','nvSvk','isModerator','oqNEZ','flags:limitPerTarget','JiQXb','intersection','AIlQc','flagId','kncda','YjCXb','./user','Lhqkp','ilwcS','LuPAb','addPostData','FlagsPerDay','[flags/list]\x20No\x20flag\x20filter\x20type\x20found:\x20','flags:byCid:','fGGRM',':posts','sJMND','VlhRE','NEFvt','RDzUx','min:rep:flag','/flags/','push','vHtfv','isPrivileged','./utils','[[error:post-deleted]]','kvTXZ','timestamp','./categories','39028mdFZGM','getUserField','isArray','./database','rescinded','heat','./privileges','toUpperCase','unresolved','[[error:cant-flag-self]]','sortedSetScore','content','[[error:not-enough-reputation-to-flag,\x20','wCsLR','rescind','wip','hasOwnProperty','[[error:user-banned]]','eONLE','winston','kSgfR','perPage','mOPhP','wrwNH','getPostField','upZKf','getFlagIdByTarget','query','YTGtT','slice','Hbdtl','reasonDefault','APLWG','[[user:banned]]','label','setObject','ORHaw','setUserField','XavsQ','pKHDy','target','danger','getAllCidsFromSet','sonpI','expire','resolved','834294SSRfEd','iFOqf','SXDyv','./plugins','[[flags:state-','stack','flags:assign:','[[user:info.muted-no-reason]]','flags:actionOnReject','replies','GBSAm','my-flags','vRgpy','resolveUserPostFlags',':uid:','init','GOLsI','charAt','wcNcy','MlLAx','upvotes','[[user:info.banned-expiry]]','assignee','description','users','Global\x20Moderators','message','qvDiW','[[user:info.muted-expiry]]','pid','eyhuW','getUserData','expiryKey','[flags/init]\x20Could\x20not\x20retrieve\x20filters\x0a','flags:byTargetUid:','371JgGAfv','getTargetUid','fIBBs','primary','getTarget','config','getSortedSetRevRangeWithScores','oldest','reports','kwuzw','warn','deleteNote','flag:','jkhAo','datetime','getSortedSetRevUnion','getSortedSetRevIntersect','stringify','sortedSetsCard','score','Heyuq','action:flags.addReport','smDMq','notifications:user-flagged-user|','nextFlagId','fItRr','aboutme','flags:byReporter:','page','sreWW','amlno','deleted','targetFlagged','[[error:','flag:post:','getNotes','pkuYt','categories:cid','keys','getObjectFields','nMzDK','getSortedSetScan','user','appendHistory','WmHui','FVHuq','setPostField','QlijY','bQNLm','WqIBY','flag','filter','QVDGy','deleteObjectFields','[[notifications:user-flagged-user,\x20','WCSAd','zRwLC','added','ztjxv','QnkFO','./batch','assign','NGsOJ',':usernames','tVfzE','rescindReport','wUBUN','./analytics','vuYFa','split','GgLko','[[flags:report-','ENBLY','LaqDk','getObject','-already-flagged]]','3996504IiSMgm','canEdit','flags:hash','flags:byType:','now','list','topics:read','sortedSetAddBulk','QRMCw','update','flags:byState:','rttKQ','-flagged-too-many-times]]','posts','ceil','VBlhk',':notes','getSortedSetsMembers','getReports','./meta','filter:flags.getFilters','post','getUsersFields','fromUid','IKitk','sortedSetRemove','parsePost','hCfyn','_states'];_0x3ecb=function(){return _0x1d7bd9;};return _0x3ecb();}Flags[_0x6b832b(0x20a)]=new Map([[_0x6b832b(0x21c),{'label':'[[flags:state-open]]','class':_0x6b832b(0x319)}],[_0x6b832b(0x2ff),{'label':'[[flags:state-wip]]','class':_0x6b832b(0x2a8)}],[_0x6b832b(0x31d),{'label':'[[flags:state-resolved]]','class':'success'}],[_0x6b832b(0x286),{'label':_0x6b832b(0x281),'class':_0x6b832b(0x20b)}]]),Flags[_0x6b832b(0x32d)]=async function(){const _0x4576fb=_0x6b832b,_0x39a248={'slIVv':function(_0x12f606,_0x1bebd5){return _0x12f606===_0x1bebd5;},'bctHg':function(_0x5ac04f,_0x3ee506,_0x978a11,_0xe6c5eb,_0x591ca3){return _0x5ac04f(_0x3ee506,_0x978a11,_0xe6c5eb,_0x591ca3);},'IKitk':_0x4576fb(0x277),'tvYKV':'flags:byCid:','zCmfk':function(_0x54d0d4,_0x170b33,_0x1150cb,_0x223a9b,_0x8a82ed){return _0x54d0d4(_0x170b33,_0x1150cb,_0x223a9b,_0x8a82ed);},'sreWW':_0x4576fb(0x1f8),'QJRYc':_0x4576fb(0x21c),'yAaYB':'wip','QVDGy':_0x4576fb(0x292)};function _0x54f187(_0x303c5c,_0x2d9eaf,_0x50fa06,_0x52c981){const _0x55fa89=_0x4576fb;if(!Array[_0x55fa89(0x2f2)](_0x52c981))_0x303c5c[_0x55fa89(0x2e8)](_0x50fa06+_0x52c981);else _0x52c981[_0x55fa89(0x278)]&&(_0x39a248['slIVv'](_0x52c981['length'],0x1)?_0x303c5c[_0x55fa89(0x2e8)](_0x50fa06+_0x52c981[0x0]):_0x2d9eaf[_0x55fa89(0x2e8)](_0x52c981['map'](_0x44f746=>_0x50fa06+_0x44f746)));}const _0xb64be0={'filters':{'type':function(_0x35ba3b,_0x2cf6ac,_0x48c96f){const _0x5c2cb9=_0x4576fb;_0x39a248[_0x5c2cb9(0x25f)](_0x54f187,_0x35ba3b,_0x2cf6ac,_0x5c2cb9(0x1f1),_0x48c96f);},'state':function(_0xdc5014,_0xbd0b8d,_0x163d9c){const _0xe715e5=_0x4576fb;_0x39a248[_0xe715e5(0x25f)](_0x54f187,_0xdc5014,_0xbd0b8d,_0xe715e5(0x1f8),_0x163d9c);},'reporterId':function(_0x57c86c,_0x31d85b,_0x3cd246){_0x54f187(_0x57c86c,_0x31d85b,'flags:byReporter:',_0x3cd246);},'assignee':function(_0x3ab6a0,_0x38cd64,_0x4287ae){const _0x2d6ef7=_0x4576fb;_0x39a248[_0x2d6ef7(0x25f)](_0x54f187,_0x3ab6a0,_0x38cd64,_0x39a248[_0x2d6ef7(0x206)],_0x4287ae);},'targetUid':function(_0x566d69,_0x2263de,_0xcfdbc8){_0x54f187(_0x566d69,_0x2263de,'flags:byTargetUid:',_0xcfdbc8);},'cid':function(_0x9e1185,_0x333560,_0x5f4679){const _0x29bc77=_0x4576fb;_0x54f187(_0x9e1185,_0x333560,_0x39a248[_0x29bc77(0x217)],_0x5f4679);},'page':function(){},'perPage':function(){},'quick':function(_0x52a870,_0x2bb5fd,_0x423009,_0x52c38d){const _0x4476d9=_0x4576fb;switch(_0x423009){case'mine':_0x52a870[_0x4476d9(0x2e8)](_0x4476d9(0x277)+_0x52c38d);break;case _0x4476d9(0x2f8):_0x39a248[_0x4476d9(0x28d)](_0x54f187,_0x52a870,_0x2bb5fd,_0x39a248[_0x4476d9(0x35e)],[_0x39a248[_0x4476d9(0x265)],_0x39a248['yAaYB']]);break;}}},'states':Flags['_states'],'helpers':{'prepareSets':_0x54f187}};try{({filters:Flags[_0x4576fb(0x285)]}=await plugins[_0x4576fb(0x2ca)][_0x4576fb(0x27f)](_0x4576fb(0x202),_0xb64be0),{filters:Flags[_0x4576fb(0x285)],states:Flags[_0x4576fb(0x20a)]}=await plugins['hooks'][_0x4576fb(0x27f)](_0x39a248[_0x4576fb(0x1d6)],_0xb64be0));}catch(_0x483aa3){winston[_0x4576fb(0x251)](_0x4576fb(0x33f)+_0x483aa3['stack']),Flags[_0x4576fb(0x285)]={};}},Flags['get']=async function(_0x207e68){const _0x5bc320=_0x6b832b,_0x115e03={'oorNE':function(_0x5c812c,_0x50abc4){return _0x5c812c+_0x50abc4;}},[_0x2c2c6e,_0x513198,_0x464169]=await Promise[_0x5bc320(0x29d)]([db[_0x5bc320(0x1ec)](_0x5bc320(0x34d)+_0x207e68),Flags['getNotes'](_0x207e68),Flags[_0x5bc320(0x200)](_0x207e68)]);if(!_0x2c2c6e)throw new Error(_0x5bc320(0x2ad));const _0x15cd9a={'state':'open','assignee':null,..._0x2c2c6e,'datetimeISO':utils[_0x5bc320(0x2bc)](_0x2c2c6e[_0x5bc320(0x34f)]),'target_readable':_0x115e03[_0x5bc320(0x273)](_0x2c2c6e[_0x5bc320(0x246)][_0x5bc320(0x32f)](0x0)[_0x5bc320(0x2f7)](),_0x2c2c6e[_0x5bc320(0x246)][_0x5bc320(0x30d)](0x1))+'\x20'+_0x2c2c6e['targetId'],'target':await Flags[_0x5bc320(0x345)](_0x2c2c6e[_0x5bc320(0x246)],_0x2c2c6e[_0x5bc320(0x270)],0x0),'notes':_0x513198,'reports':_0x464169},_0x13a025=await plugins[_0x5bc320(0x2ca)]['fire'](_0x5bc320(0x2a1),{'flag':_0x15cd9a});return _0x13a025[_0x5bc320(0x1d4)];},Flags['getCount']=async function({uid:_0x13f301,filters:_0x40bd7b,query:_0x37c1a1}){const _0x20797a=_0x6b832b,_0x2d779e={'WRLKH':function(_0x5e836d,_0xd4546e){return _0x5e836d||_0xd4546e;}};_0x40bd7b=_0x2d779e[_0x20797a(0x26b)](_0x40bd7b,{});const _0x3d956e=await Flags[_0x20797a(0x2a7)]({'filters':_0x40bd7b,'uid':_0x13f301,'query':_0x37c1a1});return _0x3d956e['length'];},Flags[_0x6b832b(0x2a7)]=async function({filters:_0x2f1044,uid:_0xe6d778,query:_0x527ff1}){const _0x2fefd4=_0x6b832b,_0x54eca7={'MMxdP':function(_0x535258,_0x3a22d9,_0x5e88b5){return _0x535258(_0x3a22d9,_0x5e88b5);},'qqHUB':_0x2fefd4(0x35d),'vRgpy':'perPage','JCMdR':_0x2fefd4(0x26a),'tbGAq':_0x2fefd4(0x24a),'UGTNU':'flags:datetime','smDMq':'wVcJO'};let _0x39df67=[];const _0x210ee0=[];_0x2f1044[_0x2fefd4(0x35d)]=_0x2f1044['hasOwnProperty'](_0x54eca7['qqHUB'])?Math[_0x2fefd4(0x268)](_0x54eca7[_0x2fefd4(0x2ac)](parseInt,_0x2f1044[_0x2fefd4(0x35d)],0xa)||0x1):0x1,_0x2f1044[_0x2fefd4(0x305)]=_0x2f1044[_0x2fefd4(0x300)](_0x54eca7[_0x2fefd4(0x32a)])?Math[_0x2fefd4(0x268)](parseInt(_0x2f1044['perPage'],0xa)||0x14):0x14;for(const _0x1e917b of Object[_0x2fefd4(0x1c8)](_0x2f1044)){if(_0x54eca7[_0x2fefd4(0x296)]===_0x54eca7[_0x2fefd4(0x284)])return _0x2dfa60[_0x2fefd4(0x2e8)](_0x2c4076[_0x2fefd4(0x205)]),_0x1f20e4[_0x2fefd4(0x2e8)]({'uid':_0x2ea3dc[_0x2fefd4(0x205)],'meta':[{'key':_0x5baf13[_0x2fefd4(0x312)],'value':_0x2dc38a[_0x2fefd4(0x2b6)](_0x153196(_0x1cbab4['reason']||_0x1971dd[_0x2fefd4(0x30f)])),'labelClass':'danger'},{'key':_0x1c0e25[_0x2fefd4(0x33e)],'value':new _0x5b3a44(_0x52c20b(_0x4f3801[_0x2fefd4(0x31c)],0xa))[_0x2fefd4(0x2bc)](),'labelClass':'default'}],'datetime':_0x26ec44(_0x28f6ce[_0x2fefd4(0x2ee)],0xa),'datetimeISO':_0x286b67[_0x2fefd4(0x2bc)](_0x54eca7[_0x2fefd4(0x2ac)](_0x36349a,_0x17a525[_0x2fefd4(0x2ee)],0xa))}),_0x4853fc;else Flags['_filters'][_0x2fefd4(0x300)](_0x1e917b)?Flags[_0x2fefd4(0x285)][_0x1e917b](_0x39df67,_0x210ee0,_0x2f1044[_0x1e917b],_0xe6d778):winston[_0x2fefd4(0x34b)](_0x2fefd4(0x2de)+_0x1e917b);}_0x39df67=_0x39df67['length']||_0x210ee0['length']?_0x39df67:[_0x54eca7[_0x2fefd4(0x2c1)]];let _0x42b940=[];if(_0x39df67[_0x2fefd4(0x278)]===0x1)_0x42b940=await db[_0x2fefd4(0x2bf)](_0x39df67[0x0],0x0,-0x1);else _0x39df67[_0x2fefd4(0x278)]>0x1&&(_0x42b940=await db[_0x2fefd4(0x351)]({'sets':_0x39df67,'start':0x0,'stop':-0x1,'aggregate':_0x2fefd4(0x25a)}));if(_0x210ee0[_0x2fefd4(0x278)]){let _0x513fb6=await Promise[_0x2fefd4(0x29d)](_0x210ee0[_0x2fefd4(0x269)](async _0x4fe3d5=>await db[_0x2fefd4(0x350)]({'sets':_0x4fe3d5,'start':0x0,'stop':-0x1,'aggregate':_0x2fefd4(0x25a)})));_0x513fb6=_[_0x2fefd4(0x2d3)](..._0x513fb6),_0x39df67[_0x2fefd4(0x278)]?_0x42b940=_[_0x2fefd4(0x2d3)](_0x42b940,_0x513fb6):_0x54eca7[_0x2fefd4(0x357)]==='wVcJO'?_0x42b940=_[_0x2fefd4(0x26c)](_0x42b940,_0x513fb6):(_0x1a5274[_0x2fefd4(0x251)](_0x2fefd4(0x33f)+_0x259bc5[_0x2fefd4(0x323)]),_0x38ddd3['_filters']={});}const _0x5dd91d=await plugins[_0x2fefd4(0x2ca)][_0x2fefd4(0x27f)](_0x2fefd4(0x2a4),{'filters':_0x2f1044,'uid':_0xe6d778,'query':_0x527ff1,'flagIds':_0x42b940});return _0x5dd91d['flagIds'];},Flags[_0x6b832b(0x1f3)]=async function(_0x565dcc){const _0x5f0871=_0x6b832b,_0x36c857={'QhYwU':_0x5f0871(0x21c),'HRlyT':function(_0xac3d08,_0x34ba5e){return _0xac3d08+_0x34ba5e;},'gPTqC':function(_0x2a1d4c,_0x57e1f4,_0x20c35f){return _0x2a1d4c(_0x57e1f4,_0x20c35f);},'njtug':function(_0x48c6bf,_0xef1119){return _0x48c6bf*_0xef1119;},'kjkTy':function(_0x30c910,_0x674f2c){return _0x30c910*_0x674f2c;}},_0x7fc855=_0x565dcc[_0x5f0871(0x2b7)]||{};let _0x586e69=await Flags['getFlagIdsWithFilters']({'filters':_0x7fc855,'uid':_0x565dcc['uid'],'query':_0x565dcc[_0x5f0871(0x30b)]});_0x586e69=await Flags[_0x5f0871(0x25c)](_0x586e69,_0x565dcc['sort']);const _0x563060=_0x586e69['length'],_0x129541=Math[_0x5f0871(0x268)](_0x36c857[_0x5f0871(0x275)](parseInt,_0x7fc855[_0x5f0871(0x305)],0xa)||0x1),_0x18b397=Math[_0x5f0871(0x1fc)](_0x586e69['length']/_0x129541);_0x586e69=_0x586e69[_0x5f0871(0x30d)](_0x36c857['njtug'](_0x7fc855[_0x5f0871(0x35d)]-0x1,_0x129541),_0x36c857[_0x5f0871(0x260)](_0x7fc855[_0x5f0871(0x35d)],_0x129541));const _0x12dc37=await db[_0x5f0871(0x353)](_0x586e69[_0x5f0871(0x269)](_0x4f22d7=>'flag:'+_0x4f22d7+':reports')),_0x10dc6e=await Promise[_0x5f0871(0x29d)](_0x586e69[_0x5f0871(0x269)](async(_0xc950d9,_0x4d54ed)=>{const _0x21ac76=_0x5f0871;let _0x168ec7=await db[_0x21ac76(0x1ec)](_0x21ac76(0x34d)+_0xc950d9);return _0x168ec7={'state':_0x36c857[_0x21ac76(0x28f)],'assignee':null,'heat':_0x12dc37[_0x4d54ed],..._0x168ec7},_0x168ec7['labelClass']=Flags[_0x21ac76(0x20a)][_0x21ac76(0x272)](_0x168ec7[_0x21ac76(0x262)])[_0x21ac76(0x239)],Object[_0x21ac76(0x1df)](_0x168ec7,{'target_readable':_0x36c857[_0x21ac76(0x211)](_0x168ec7[_0x21ac76(0x246)][_0x21ac76(0x32f)](0x0)[_0x21ac76(0x2f7)](),_0x168ec7[_0x21ac76(0x246)][_0x21ac76(0x30d)](0x1))+'\x20'+_0x168ec7[_0x21ac76(0x270)],'datetimeISO':utils[_0x21ac76(0x2bc)](_0x168ec7['datetime'])});})),_0x3458da=await plugins[_0x5f0871(0x2ca)][_0x5f0871(0x27f)](_0x5f0871(0x298),{'flags':_0x10dc6e,'page':_0x7fc855[_0x5f0871(0x35d)],'uid':_0x565dcc[_0x5f0871(0x2b9)]});return{'flags':_0x3458da['flags'],'count':_0x563060,'page':_0x3458da[_0x5f0871(0x35d)],'pageCount':_0x18b397};},Flags['sort']=async function(_0x100d48,_0x479b5d){const _0x5ea4fb=_0x6b832b,_0x18ff5a={'aFleq':_0x5ea4fb(0x246),'qsOkE':'reports','ibUJp':_0x5ea4fb(0x332),'RHaZW':'downvotes','ctNcB':_0x5ea4fb(0x327),'Cvesz':_0x5ea4fb(0x270)},_0xfb4a99=async _0x50da6e=>{const _0x3a23f2=_0x5ea4fb,_0x1b7061=_0x50da6e[_0x3a23f2(0x269)](_0x1be1a7=>_0x3a23f2(0x34d)+_0x1be1a7),_0x4ce229=await db[_0x3a23f2(0x283)](_0x1b7061,[_0x18ff5a[_0x3a23f2(0x22c)]]);return _0x50da6e[_0x3a23f2(0x1d5)]((_0x3f0a21,_0xc340c5)=>_0x4ce229[_0xc340c5][_0x3a23f2(0x246)]===_0x3a23f2(0x203));};switch(_0x479b5d){case _0x5ea4fb(0x348):_0x100d48=_0x100d48[_0x5ea4fb(0x287)]();break;case _0x18ff5a[_0x5ea4fb(0x20c)]:{const _0x4496ee=_0x100d48[_0x5ea4fb(0x269)](_0x1dd99c=>_0x5ea4fb(0x34d)+_0x1dd99c+_0x5ea4fb(0x27d)),_0x2cbd58=await db['sortedSetsCard'](_0x4496ee),_0x43aa2e=_0x2cbd58[_0x5ea4fb(0x269)]((_0xdebac5,_0x418595)=>({'index':_0x418595,'heat':_0xdebac5}));_0x43aa2e[_0x5ea4fb(0x25c)]((_0x319ce0,_0x3b0863)=>_0x3b0863['heat']-_0x319ce0[_0x5ea4fb(0x2f5)]),_0x100d48=_0x43aa2e[_0x5ea4fb(0x269)](_0x53ad5b=>_0x100d48[_0x53ad5b['index']]);break;}case _0x18ff5a[_0x5ea4fb(0x221)]:case _0x18ff5a[_0x5ea4fb(0x2b5)]:case _0x18ff5a[_0x5ea4fb(0x240)]:{_0x100d48=await _0xfb4a99(_0x100d48);const _0x2150a2=_0x100d48[_0x5ea4fb(0x269)](_0x3ac892=>_0x5ea4fb(0x34d)+_0x3ac892),_0x5b03e5=(await db[_0x5ea4fb(0x283)](_0x2150a2,[_0x18ff5a[_0x5ea4fb(0x216)]]))['map'](_0x16bb05=>_0x16bb05['targetId']),_0x41ac42=(await posts[_0x5ea4fb(0x2a0)](_0x5b03e5,[_0x479b5d]))[_0x5ea4fb(0x269)](_0x35d848=>parseInt(_0x35d848[_0x479b5d],0xa)||0x0),_0x18ed88=_0x100d48[_0x5ea4fb(0x279)]((_0x5609d5,_0x35cc40,_0xf5f49a)=>{return _0x5609d5[_0x35cc40]=_0x41ac42[_0xf5f49a],_0x5609d5;},{});_0x100d48=_0x100d48[_0x5ea4fb(0x25c)]((_0x5a7057,_0x589d7f)=>_0x18ed88[_0x589d7f]-_0x18ed88[_0x5a7057]);}}return _0x100d48;},Flags[_0x6b832b(0x247)]=async function(_0x56ab11){const _0x529e5c=_0x6b832b,_0xe76d3={'TjWMJ':_0x529e5c(0x214),'iMrlR':function(_0x31ad65,_0x3a7318){return _0x31ad65===_0x3a7318;},'LuPAb':_0x529e5c(0x203),'GELIV':'reputation:disabled','nMzDK':_0x529e5c(0x2e6),'PnaEo':_0x529e5c(0x2f9),'tkSwh':_0x529e5c(0x27b)},[_0x1ca65e,_0x4a2d2a]=await Promise[_0x529e5c(0x29d)]([Flags[_0x529e5c(0x345)](_0x56ab11[_0x529e5c(0x246)],_0x56ab11['id'],_0x56ab11[_0x529e5c(0x2b9)]),user[_0x529e5c(0x33d)](_0x56ab11['uid'])]);if(!_0x1ca65e)throw new Error(_0x529e5c(0x27b));else{if(_0x1ca65e[_0x529e5c(0x360)])throw new Error(_0x529e5c(0x2ec));else{if(!_0x4a2d2a||!_0x4a2d2a[_0x529e5c(0x2b1)])throw new Error(_0x529e5c(0x274));else{if(_0x4a2d2a['banned'])throw new Error(_0x529e5c(0x301));}}}const [_0x2f2e1b,_0x3ad6a4]=await Promise['all']([user[_0x529e5c(0x2ea)](_0x1ca65e['uid']),user[_0x529e5c(0x2ea)](_0x4a2d2a['uid'])]);if(_0x2f2e1b&&!_0x3ad6a4)throw new Error(_0xe76d3[_0x529e5c(0x2c3)]);if(_0xe76d3[_0x529e5c(0x290)](_0x56ab11['type'],_0xe76d3[_0x529e5c(0x2db)])){const _0x5ce39e=await privileges['posts'][_0x529e5c(0x1ef)](_0x56ab11['id'],_0x56ab11[_0x529e5c(0x2b9)]);if(!_0x5ce39e['flag']&&!meta[_0x529e5c(0x346)][_0xe76d3['GELIV']]&&_0x4a2d2a['reputation']<meta['config'][_0xe76d3['nMzDK']])throw new Error('[[error:not-enough-reputation-to-flag,\x20'+meta[_0x529e5c(0x346)][_0xe76d3['nMzDK']]+']]');}else{if(_0x56ab11['type']===_0x529e5c(0x1cc)){if(_0xe76d3[_0x529e5c(0x290)](parseInt(_0x56ab11['id'],0xa),parseInt(_0x56ab11[_0x529e5c(0x2b9)],0xa)))throw new Error(_0xe76d3['PnaEo']);const _0x140ca0=await privileges[_0x529e5c(0x336)][_0x529e5c(0x1ef)](_0x56ab11[_0x529e5c(0x2b9)],_0x56ab11['id']);if(!_0x140ca0&&!meta['config'][_0xe76d3[_0x529e5c(0x212)]]&&_0x4a2d2a[_0x529e5c(0x21b)]<meta['config'][_0x529e5c(0x2e6)])throw new Error(_0x529e5c(0x2fc)+meta['config'][_0xe76d3[_0x529e5c(0x1ca)]]+']]');}else throw new Error(_0xe76d3['tkSwh']);}},Flags[_0x6b832b(0x1c5)]=async function(_0x38031c){let _0x408ebf=await db['getSortedSetRevRangeWithScores']('flag:'+_0x38031c+':notes',0x0,-0x1);return _0x408ebf=await modifyNotes(_0x408ebf),_0x408ebf;},Flags['getNote']=async function(_0x47f39e,_0x204b41){const _0x3e513f=_0x6b832b,_0xefe00={'fViHa':function(_0x28a502,_0x44da3b,_0x296f73){return _0x28a502(_0x44da3b,_0x296f73);},'MlLAx':function(_0x2f9826,_0x6b5005){return _0x2f9826!==_0x6b5005;},'TCWYC':'yoQhN','fItRr':_0x3e513f(0x24e),'hCfyn':_0x3e513f(0x27b)};_0x204b41=_0xefe00[_0x3e513f(0x2b3)](parseInt,_0x204b41,0xa);if(isNaN(_0x204b41)){if(_0xefe00[_0x3e513f(0x331)](_0xefe00['TCWYC'],_0x3e513f(0x2d6)))throw new Error('[[error:invalid-data]]');else return _0x170cc0[_0x453163]=_0x267e2f[_0x561f9c],_0x1f36d3;}let _0x38e55e=await db[_0x3e513f(0x234)](_0x3e513f(0x34d)+_0x47f39e+_0x3e513f(0x1fe),0x0,0x1,_0x204b41,_0x204b41);if(!_0x38e55e[_0x3e513f(0x278)]){if(_0xefe00[_0x3e513f(0x35a)]==='JJCuo')throw new _0x4efcbb(_0x3e513f(0x214));else throw new Error(_0xefe00[_0x3e513f(0x209)]);}return _0x38e55e=await modifyNotes(_0x38e55e),_0x38e55e[0x0];},Flags[_0x6b832b(0x30a)]=async function(_0x183afa,_0x59fd7b){const _0x2a7f9e=_0x6b832b,_0x148c8b={'AIlQc':_0x2a7f9e(0x1cc),'XavsQ':_0x2a7f9e(0x27b),'ZgZva':function(_0x4eeca0,_0x43b940,_0x46ccca){return _0x4eeca0(_0x43b940,_0x46ccca);},'zRwLC':'flagId'};let _0xeb9aa1;switch(_0x183afa){case _0x2a7f9e(0x203):_0xeb9aa1=posts[_0x2a7f9e(0x308)];break;case _0x148c8b[_0x2a7f9e(0x2d4)]:_0xeb9aa1=user[_0x2a7f9e(0x2f1)];break;default:throw new Error(_0x148c8b[_0x2a7f9e(0x316)]);}return await _0x148c8b['ZgZva'](_0xeb9aa1,_0x59fd7b,_0x148c8b[_0x2a7f9e(0x1da)]);};async function modifyNotes(_0x3d4b20){const _0x4e83fc=_0x6b832b,_0x35cc1b={'QqVVZ':_0x4e83fc(0x2a6),'wrwNH':_0x4e83fc(0x2b1),'PFzOv':'picture'},_0x43c50c=[];_0x3d4b20=_0x3d4b20['map'](_0x54089f=>{const _0x307210=_0x4e83fc,_0x56d56a=JSON['parse'](_0x54089f[_0x307210(0x266)]);return _0x43c50c['push'](_0x56d56a[0x0]),{'uid':_0x56d56a[0x0],'content':_0x56d56a[0x1],'datetime':_0x54089f[_0x307210(0x354)],'datetimeISO':utils[_0x307210(0x2bc)](_0x54089f[_0x307210(0x354)])};});const _0x330928=await user[_0x4e83fc(0x204)](_0x43c50c,[_0x35cc1b[_0x4e83fc(0x267)],_0x35cc1b[_0x4e83fc(0x307)],_0x35cc1b[_0x4e83fc(0x25b)]]);return _0x3d4b20['map']((_0x3fac16,_0x453221)=>{const _0x4b489a=_0x4e83fc;return _0x3fac16['user']=_0x330928[_0x453221],_0x3fac16['content']=validator[_0x4b489a(0x2b6)](_0x3fac16[_0x4b489a(0x2fb)]),_0x3fac16;});}function _0x4e8b(_0x4d9197,_0x576083){const _0x3ecb82=_0x3ecb();return _0x4e8b=function(_0x4e8b71,_0x502b06){_0x4e8b71=_0x4e8b71-0x1c5;let _0x5abe50=_0x3ecb82[_0x4e8b71];return _0x5abe50;},_0x4e8b(_0x4d9197,_0x576083);}Flags[_0x6b832b(0x34c)]=async function(_0x3e5c34,_0x4da8f3){const _0xed3c73=_0x6b832b,_0x4556dc={'Mrigi':_0xed3c73(0x1c6),'MjGxK':_0xed3c73(0x27b)};_0x4da8f3=parseInt(_0x4da8f3,0xa);if(isNaN(_0x4da8f3)){if(_0xed3c73(0x1c6)===_0x4556dc[_0xed3c73(0x235)])throw new Error('[[error:invalid-data]]');else return;}const _0x4290de=await db[_0xed3c73(0x24c)](_0xed3c73(0x34d)+_0x3e5c34+':notes',0x0,0x1,_0x4da8f3,_0x4da8f3);if(!_0x4290de['length'])throw new Error(_0x4556dc['MjGxK']);await db[_0xed3c73(0x207)](_0xed3c73(0x34d)+_0x3e5c34+_0xed3c73(0x1fe),_0x4290de[0x0]);},Flags['create']=async function(_0x2c6c58,_0x2a4112,_0x1227e0,_0x1eda87,_0x9b6c6a,_0xc1caa1=![]){const _0x40a5c7=_0x6b832b,_0x3fbc91={'QRMCw':function(_0x55df6f,_0x49314b,_0xe83aa6,_0x32d0c5,_0x300c72){return _0x55df6f(_0x49314b,_0xe83aa6,_0x32d0c5,_0x300c72);},'qvDiW':_0x40a5c7(0x1f8),'VBlhk':_0x40a5c7(0x344),'iJtIn':function(_0x33442e,_0xfd8f75){return _0x33442e===_0xfd8f75;},'ORHaw':_0x40a5c7(0x31f),'oqNEZ':function(_0x1b811a,_0x4088e7){return _0x1b811a&&_0x4088e7;},'Heyuq':'maIhB','LBBET':_0x40a5c7(0x21c),'eONLE':_0x40a5c7(0x1db),'fGGRM':_0x40a5c7(0x220),'SXDyv':function(_0x12dc77,_0x1fb0b0,_0x19051f){return _0x12dc77(_0x1fb0b0,_0x19051f);},'QlijY':function(_0x4e81e3,_0x388153){return _0x4e81e3!==_0x388153;},'bmQra':_0x40a5c7(0x22f)};let _0x45b17b=![];!_0x9b6c6a&&(_0x3fbc91[_0x40a5c7(0x29e)](_0x40a5c7(0x31f),_0x3fbc91[_0x40a5c7(0x314)])?(_0x9b6c6a=Date[_0x40a5c7(0x1f2)](),_0x45b17b=!![]):_0x3fbc91[_0x40a5c7(0x1f6)](_0x593c22,_0x44dfc7,_0x17dd70,_0x40a5c7(0x277),_0x37031a));const [_0xa771f,_0x59a311,,_0x107465,_0x51e3ba,_0x50bde0]=await Promise[_0x40a5c7(0x29d)]([Flags[_0x40a5c7(0x21a)](_0x2c6c58,_0x2a4112,_0x1227e0),Flags[_0x40a5c7(0x2c2)](_0x2c6c58,_0x2a4112),Flags[_0x40a5c7(0x225)](_0x2c6c58,_0x2a4112,_0x1227e0,_0xc1caa1),Flags[_0x40a5c7(0x361)](_0x2c6c58,_0x2a4112),Flags[_0x40a5c7(0x342)](_0x2c6c58,_0x2a4112),Flags['getTargetCid'](_0x2c6c58,_0x2a4112)]);if(_0x3fbc91[_0x40a5c7(0x2d0)](!_0xc1caa1,_0xa771f))throw new Error(_0x40a5c7(0x362)+_0x2c6c58+_0x40a5c7(0x1ed));else{if(!_0x59a311){if(_0x3fbc91[_0x40a5c7(0x29e)](_0x40a5c7(0x20e),_0x3fbc91[_0x40a5c7(0x355)]))_0x3fbc91[_0x40a5c7(0x1f6)](_0x3a273b,_0x25339c,_0x19c359,_0x3fbc91[_0x40a5c7(0x339)],_0x1940ec);else throw new Error(_0x40a5c7(0x27b));}}if(_0x107465){const _0x430673=await Flags['getFlagIdByTarget'](_0x2c6c58,_0x2a4112);return await Promise[_0x40a5c7(0x29d)]([Flags[_0x40a5c7(0x261)](_0x430673,_0x2c6c58,_0x2a4112,_0x1227e0,_0x1eda87,_0x9b6c6a),Flags[_0x40a5c7(0x1f7)](_0x430673,_0x1227e0,{'state':_0x3fbc91[_0x40a5c7(0x22b)],'report':_0x3fbc91[_0x40a5c7(0x302)]})]),await Flags['get'](_0x430673);}const _0x18629d=await db['incrObjectField'](_0x40a5c7(0x23c),_0x40a5c7(0x359)),_0x1c1968=[];_0x1c1968[_0x40a5c7(0x2e8)](db[_0x40a5c7(0x313)]('flag:'+_0x18629d,{'flagId':_0x18629d,'type':_0x2c6c58,'targetId':_0x2a4112,'targetUid':_0x51e3ba,'datetime':_0x9b6c6a}),Flags['addReport'](_0x18629d,_0x2c6c58,_0x2a4112,_0x1227e0,_0x1eda87,_0x9b6c6a),db['sortedSetAdd'](_0x40a5c7(0x232),_0x9b6c6a,_0x18629d),db['sortedSetAdd'](_0x40a5c7(0x1f1)+_0x2c6c58,_0x9b6c6a,_0x18629d),db[_0x40a5c7(0x210)](_0x40a5c7(0x26f),0x1,[_0x2c6c58,_0x2a4112][_0x40a5c7(0x2c4)](':')),analytics[_0x40a5c7(0x22a)](_0x3fbc91[_0x40a5c7(0x2e0)]));_0x51e3ba&&_0x1c1968['push'](db[_0x40a5c7(0x293)](_0x40a5c7(0x340)+_0x51e3ba,_0x9b6c6a,_0x18629d));_0x50bde0&&_0x1c1968[_0x40a5c7(0x2e8)](db[_0x40a5c7(0x293)]('flags:byCid:'+_0x50bde0,_0x9b6c6a,_0x18629d));if(_0x2c6c58===_0x40a5c7(0x203)){_0x1c1968[_0x40a5c7(0x2e8)](db[_0x40a5c7(0x293)]('flags:byPid:'+_0x2a4112,_0x9b6c6a,_0x18629d),posts[_0x40a5c7(0x1d0)](_0x2a4112,_0x40a5c7(0x2d5),_0x18629d));if(_0x51e3ba&&parseInt(_0x51e3ba,0xa)!==_0x3fbc91[_0x40a5c7(0x320)](parseInt,_0x1227e0,0xa)){if(_0x3fbc91[_0x40a5c7(0x1d1)](_0x40a5c7(0x1dd),_0x3fbc91[_0x40a5c7(0x23e)]))_0x1c1968['push'](user[_0x40a5c7(0x291)](_0x51e3ba,0x1));else return _0x242907[_0x40a5c7(0x2e8)](_0x198a6e),_0x510e62['push']({'uid':_0x168a06,'meta':[{'key':_0x40a5c7(0x23b),'value':_0x23ecae[_0x40a5c7(0x266)],'labelClass':_0x3fbc91[_0x40a5c7(0x1fd)]}],'datetime':_0x48e269[_0x40a5c7(0x2ee)],'datetimeISO':_0x4e80fc[_0x40a5c7(0x230)]}),_0x481acf;}}else _0x2c6c58===_0x40a5c7(0x1cc)&&_0x1c1968[_0x40a5c7(0x2e8)](user[_0x40a5c7(0x315)](_0x2a4112,_0x40a5c7(0x2d5),_0x18629d));await Promise[_0x40a5c7(0x29d)](_0x1c1968);_0x45b17b&&await Flags['update'](_0x18629d,_0x1227e0,{'state':_0x40a5c7(0x21c)});const _0x2d41da=await Flags['get'](_0x18629d);return plugins['hooks'][_0x40a5c7(0x27f)]('action:flags.create',{'flag':_0x2d41da}),_0x2d41da;},Flags['purge']=async function(_0x4cf359){const _0x12f3c3=_0x6b832b,_0x46bfbe={'GOLsI':_0x12f3c3(0x1c7),'wcjhg':_0x12f3c3(0x2d5)},_0x5e6cbd=(await db['getObjects'](_0x4cf359[_0x12f3c3(0x269)](_0x7cb634=>_0x12f3c3(0x34d)+_0x7cb634)))[_0x12f3c3(0x1d5)](Boolean),_0x5bc2b8=_0x5e6cbd[_0x12f3c3(0x1d5)](_0x164039=>_0x164039[_0x12f3c3(0x246)]===_0x12f3c3(0x203)),_0x18efd9=_0x5e6cbd[_0x12f3c3(0x1d5)](_0x37d1ea=>_0x37d1ea[_0x12f3c3(0x246)]==='user'),_0x2d0585=_0x5e6cbd[_0x12f3c3(0x1d5)](_0x4e86ba=>!!_0x4e86ba['assignee']),[_0x86209d,_0x55bd55]=await Promise[_0x12f3c3(0x29d)]([db[_0x12f3c3(0x1ff)](_0x5e6cbd[_0x12f3c3(0x269)](_0x34994=>'flag:'+_0x34994[_0x12f3c3(0x2d5)]+_0x12f3c3(0x27d))),categories[_0x12f3c3(0x31a)](_0x46bfbe[_0x12f3c3(0x32e)])]),_0x4722fe=_0x86209d['map'](_0x1cddc3=>_0x1cddc3[_0x12f3c3(0x269)](_0x5c9d24=>_0x5c9d24&&_0x5c9d24[_0x12f3c3(0x1e7)](';')[0x0])),_0xaeeb4f=[];_0x5e6cbd[_0x12f3c3(0x271)]((_0x4aabbb,_0x58c602)=>{const _0x1be2b1=_0x12f3c3;Array[_0x1be2b1(0x2f2)](_0x4722fe[_0x58c602])&&_0x4722fe[_0x58c602][_0x1be2b1(0x271)](_0x53166b=>{const _0x12c222=_0x1be2b1;_0xaeeb4f[_0x12c222(0x2e8)]([_0x12c222(0x1f0),[_0x4aabbb[_0x12c222(0x246)],_0x4aabbb[_0x12c222(0x270)],_0x53166b][_0x12c222(0x2c4)](':')]),_0xaeeb4f[_0x12c222(0x2e8)]([_0x12c222(0x35c)+_0x53166b,_0x4aabbb[_0x12c222(0x2d5)]]);});}),await Promise['all']([db[_0x12f3c3(0x254)]([..._0x5e6cbd['map'](_0xdd5184=>['flags:byType:'+_0xdd5184[_0x12f3c3(0x246)],_0xdd5184['flagId']]),..._0x5e6cbd['map'](_0x3b7060=>[_0x12f3c3(0x1f8)+_0x3b7060['state'],_0x3b7060[_0x12f3c3(0x2d5)]]),..._0xaeeb4f,..._0x5bc2b8['map'](_0x5055c3=>[_0x12f3c3(0x2cd)+_0x5055c3[_0x12f3c3(0x270)],_0x5055c3[_0x12f3c3(0x2d5)]]),..._0x2d0585['map'](_0x589088=>[_0x12f3c3(0x277)+_0x589088[_0x12f3c3(0x334)],_0x589088[_0x12f3c3(0x2d5)]]),..._0x18efd9['map'](_0x3aaf43=>[_0x12f3c3(0x340)+_0x3aaf43[_0x12f3c3(0x2cc)],_0x3aaf43['flagId']])]),db[_0x12f3c3(0x1d7)](_0x5bc2b8[_0x12f3c3(0x269)](_0x31b2c5=>'post:'+_0x31b2c5[_0x12f3c3(0x270)],[_0x12f3c3(0x2d5)])),db['deleteObjectFields'](_0x18efd9['map'](_0x56252a=>_0x12f3c3(0x219)+_0x56252a['targetId'],[_0x46bfbe[_0x12f3c3(0x2c6)]])),db[_0x12f3c3(0x280)]([..._0x4cf359['map'](_0x42acc0=>_0x12f3c3(0x34d)+_0x42acc0),..._0x4cf359[_0x12f3c3(0x269)](_0x291d9b=>'flag:'+_0x291d9b+_0x12f3c3(0x1fe)),..._0x4cf359[_0x12f3c3(0x269)](_0x153c11=>_0x12f3c3(0x34d)+_0x153c11+_0x12f3c3(0x27d)),..._0x4cf359['map'](_0x1c47a2=>_0x12f3c3(0x34d)+_0x1c47a2+_0x12f3c3(0x257))]),db[_0x12f3c3(0x207)](_0x55bd55['map'](_0x317630=>'flags:byCid:'+_0x317630),_0x4cf359),db[_0x12f3c3(0x207)](_0x12f3c3(0x232),_0x4cf359),db[_0x12f3c3(0x207)](_0x12f3c3(0x26f),_0x5e6cbd[_0x12f3c3(0x269)](_0x44e5e1=>[_0x44e5e1['type'],_0x44e5e1[_0x12f3c3(0x270)]][_0x12f3c3(0x2c4)](':')))]);},Flags[_0x6b832b(0x200)]=async function(_0x16836b){const _0x4e2328=_0x6b832b,_0x2b3561={'NGsOJ':_0x4e2328(0x2a6),'kOqeh':'userslug','kypWC':_0x4e2328(0x249)},_0x3c01f5=await db[_0x4e2328(0x347)](_0x4e2328(0x34d)+_0x16836b+':reports',0x0,-0x1),[_0x5d1db0,_0x402129]=_0x3c01f5[_0x4e2328(0x279)]((_0x51de53,_0x38e206)=>{const _0x5c7b66=_0x4e2328,_0x40e184=_0x38e206['value'][_0x5c7b66(0x1e7)](';');return _0x51de53[0x1]['push'](_0x40e184[_0x5c7b66(0x2af)]()),_0x38e206['value']=validator[_0x5c7b66(0x2b6)](String(_0x40e184['join'](';'))),_0x51de53[0x0][_0x5c7b66(0x2e8)](_0x38e206),_0x51de53;},[[],[]]);return await Promise[_0x4e2328(0x29d)](_0x5d1db0['map'](async(_0x5a3e1e,_0x5aad81)=>{const _0x5327b3=_0x4e2328;_0x5a3e1e[_0x5327b3(0x2ee)]=_0x5a3e1e[_0x5327b3(0x354)],_0x5a3e1e[_0x5327b3(0x230)]=new Date(_0x5a3e1e['score'])[_0x5327b3(0x2bc)](),delete _0x5a3e1e[_0x5327b3(0x354)],_0x5a3e1e[_0x5327b3(0x288)]=await user['getUserFields'](_0x402129[_0x5aad81],[_0x2b3561[_0x5327b3(0x1e0)],_0x2b3561['kOqeh'],_0x2b3561['kypWC'],_0x5327b3(0x21b)]);})),_0x5d1db0;},Flags[_0x6b832b(0x261)]=async function(_0x559880,_0xeb26d6,_0xe6741,_0x20c049,_0x1e75eb,_0x4fe4a8){const _0x1e1f71=_0x6b832b,_0x46fd9a={'bQNLm':_0x1e1f71(0x1f0),'kvTXZ':_0x1e1f71(0x356)};await db[_0x1e1f71(0x1f5)]([['flags:byReporter:'+_0x20c049,_0x4fe4a8,_0x559880],[_0x1e1f71(0x34d)+_0x559880+':reports',_0x4fe4a8,[_0x20c049,_0x1e75eb]['join'](';')],[_0x46fd9a[_0x1e1f71(0x1d2)],_0x559880,[_0xeb26d6,_0xe6741,_0x20c049][_0x1e1f71(0x2c4)](':')]]),plugins[_0x1e1f71(0x2ca)][_0x1e1f71(0x27f)](_0x46fd9a[_0x1e1f71(0x2ed)],{'flagId':_0x559880,'type':_0xeb26d6,'id':_0xe6741,'uid':_0x20c049,'reason':_0x1e75eb,'timestamp':_0x4fe4a8});},Flags[_0x6b832b(0x1e3)]=async(_0x25cf1a,_0x3c5b9e,_0x3615c2)=>{const _0x1da262=_0x6b832b,_0x11f42d={'IUvyw':function(_0x4058ed,_0x4c68c6,_0x5df932){return _0x4058ed(_0x4c68c6,_0x5df932);},'PgdsE':_0x1da262(0x1f0),'APLWG':function(_0x39da0b,_0x2a07ce){return _0x39da0b<_0x2a07ce;},'fIBBs':'HimPh','ciUOQ':_0x1da262(0x31d)},_0x746e00=await Flags['exists'](_0x25cf1a,_0x3c5b9e,_0x3615c2);if(!_0x746e00)return!![];const _0x733aaf=await db[_0x1da262(0x2fa)](_0x11f42d[_0x1da262(0x25d)],[_0x25cf1a,_0x3c5b9e,_0x3615c2]['join'](':')),_0x2de4dc=await db[_0x1da262(0x2b4)]('flag:'+_0x733aaf+_0x1da262(0x27d));let _0x5b0cab;_0x2de4dc[_0x1da262(0x271)](_0x11ac46=>{const _0x2e15a8=_0x1da262;if(!_0x5b0cab){const [_0x52a360,_0x4563c2]=_0x11ac46[_0x2e15a8(0x1e7)](';');_0x11f42d[_0x2e15a8(0x282)](parseInt,_0x52a360,0xa)===parseInt(_0x3615c2,0xa)&&(_0x5b0cab=_0x4563c2);}});if(!_0x5b0cab)throw new Error(_0x1da262(0x2a2));await db[_0x1da262(0x254)]([['flags:byReporter:'+_0x3615c2,_0x733aaf],[_0x1da262(0x34d)+_0x733aaf+_0x1da262(0x27d),[_0x3615c2,_0x5b0cab][_0x1da262(0x2c4)](';')],[_0x11f42d[_0x1da262(0x25d)],[_0x25cf1a,_0x3c5b9e,_0x3615c2]['join'](':')]]);const _0x3bbd4b=await db['sortedSetCard'](_0x1da262(0x34d)+_0x733aaf+':reports');_0x11f42d[_0x1da262(0x310)](_0x3bbd4b,0x1)&&('HimPh'!==_0x11f42d[_0x1da262(0x343)]?_0x5e4851['push'](_0x3918ec[_0x1da262(0x269)](_0x500789=>_0x9096cf+_0x500789)):await Flags[_0x1da262(0x1f7)](_0x733aaf,_0x3615c2,{'state':_0x11f42d['ciUOQ'],'report':_0x1da262(0x2f4)}));},Flags[_0x6b832b(0x21a)]=async function(_0x5564a3,_0x5e6527,_0x556eec){const _0x117ce7=_0x6b832b;return await db[_0x117ce7(0x26d)]('flags:hash',[_0x5564a3,_0x5e6527,_0x556eec][_0x117ce7(0x2c4)](':'));},Flags[_0x6b832b(0x2bb)]=async(_0x43c8ab,_0x5946d5)=>{const _0x1bccbd=_0x6b832b,_0x5673d5={'QyJbt':_0x1bccbd(0x232),'NEFvt':_0x1bccbd(0x203)},_0x5650f5=await db['isSortedSetMember'](_0x5673d5[_0x1bccbd(0x2c5)],_0x43c8ab);if(!_0x5650f5)return![];const [{type:_0x137005,targetId:_0x4b66de},_0x116fe6]=await Promise[_0x1bccbd(0x29d)]([db[_0x1bccbd(0x1ec)](_0x1bccbd(0x34d)+_0x43c8ab),user[_0x1bccbd(0x238)](_0x5946d5)]);if(_0x137005===_0x5673d5[_0x1bccbd(0x2e4)]){const _0x5463f6=await Flags[_0x1bccbd(0x2a9)](_0x137005,_0x4b66de),_0xce95b2=await user[_0x1bccbd(0x2cf)](_0x5946d5,_0x5463f6);return _0x116fe6||_0xce95b2;}return _0x116fe6;},Flags[_0x6b832b(0x225)]=async function(_0x40d7fc,_0x24a2d3,_0x4cb778,_0x5eb725=![]){const _0x2e3037=_0x6b832b,_0x4349ac={'mOPhP':function(_0xd3c7b,_0x7f56b0){return _0xd3c7b(_0x7f56b0);},'ggayI':_0x2e3037(0x2d1),'mwszP':function(_0x252ffd,_0x581d19){return _0x252ffd===_0x581d19;},'KooeV':function(_0x3e885b,_0x64ef71){return _0x3e885b*_0x64ef71;},'Hbdtl':function(_0x57b862,_0x38722e){return _0x57b862-_0x38722e;},'cUGYW':_0x2e3037(0x2ab),'adaWH':_0x2e3037(0x1f4),'nvSvk':function(_0x12be16,_0x7b201){return _0x12be16>_0x7b201;},'UzjKn':function(_0x5d0475,_0x1338f4){return _0x5d0475>_0x1338f4;},'RDzUx':_0x2e3037(0x226)},_0x22bf16=meta['config'][_0x4349ac[_0x2e3037(0x295)]];if(!_0x5eb725&&_0x22bf16>0x0){const _0x90031d=await db[_0x2e3037(0x2fa)]('flags:byTarget',_0x40d7fc+':'+_0x24a2d3);if(_0x90031d>=_0x22bf16){if(_0x4349ac['mwszP'](_0x2e3037(0x223),_0x2e3037(0x223)))throw new Error(_0x2e3037(0x362)+_0x40d7fc+_0x2e3037(0x1fa));else _0x43ecb9[_0x2e3037(0x2e8)](_0x4349ac[_0x2e3037(0x306)](_0x45d7a8,'flag:'+_0x37a115[_0x2e3037(0x246)]+':'+_0x21c568[_0x2e3037(0x270)]));}}const _0xeec1bf=_0x4349ac[_0x2e3037(0x244)](0x18*0x3c,0x3c)*0x3e8,_0x136412=Date[_0x2e3037(0x1f2)](),[_0x4135a6,_0x3f1275,_0x18570d]=await Promise['all']([db[_0x2e3037(0x24c)]('flags:byReporter:'+_0x4cb778,0x0,-0x1,_0x4349ac[_0x2e3037(0x30e)](_0x136412,_0xeec1bf),_0x4349ac['cUGYW']),privileges[_0x2e3037(0x1fb)]['can'](_0x4349ac['adaWH'],_0x24a2d3,_0x4cb778),user[_0x2e3037(0x2ea)](_0x4cb778)]),_0x4cd57a=meta['config'][_0x2e3037(0x276)+_0x40d7fc+_0x2e3037(0x2dd)];if(!_0x18570d&&_0x4349ac[_0x2e3037(0x2ce)](_0x4cd57a,0x0)){const _0x433569=await db['getObjects'](_0x4135a6[_0x2e3037(0x269)](_0x374bab=>_0x2e3037(0x34d)+_0x374bab)),_0x2011a4=_0x433569[_0x2e3037(0x1d5)](_0x21433f=>_0x21433f&&_0x21433f[_0x2e3037(0x246)]===_0x40d7fc);if(_0x4cd57a>0x0&&_0x4349ac[_0x2e3037(0x253)](_0x2011a4[_0x2e3037(0x278)],_0x4cd57a))throw new Error(_0x2e3037(0x20f)+_0x40d7fc+'-flags-per-day,\x20'+_0x4cd57a+']]');}switch(_0x40d7fc){case _0x2e3037(0x1cc):return!![];case _0x2e3037(0x203):if(!_0x3f1275)throw new Error(_0x4349ac[_0x2e3037(0x2e5)]);break;default:throw new Error(_0x2e3037(0x27b));}},Flags['getTarget']=async function(_0xd2e991,_0x2c81fd,_0xc8ce81){const _0x58139f=_0x6b832b,_0x49b1e2={'ENBLY':'user','jkhAo':function(_0x5ec3be,_0x1900fb){return _0x5ec3be(_0x1900fb);},'Lhqkp':function(_0x82938f,_0x1ee8e6){return _0x82938f===_0x1ee8e6;},'mKApt':_0x58139f(0x2e9)};if(_0xd2e991===_0x49b1e2[_0x58139f(0x1ea)]){const _0x1f720=await user['getUserData'](_0x2c81fd);return _0x1f720[_0x58139f(0x35b)]=validator['escape'](_0x49b1e2[_0x58139f(0x34e)](String,_0x1f720[_0x58139f(0x35b)])),_0x1f720&&_0x1f720['uid']?_0x1f720:{};}if(_0x49b1e2[_0x58139f(0x2d9)](_0xd2e991,'post')){if(_0x58139f(0x2e9)===_0x49b1e2[_0x58139f(0x21d)]){let _0x3f6d6f=await posts['getPostData'](_0x2c81fd);if(!_0x3f6d6f)return{};return _0x3f6d6f=await posts[_0x58139f(0x208)](_0x3f6d6f),_0x3f6d6f=await topics[_0x58139f(0x2dc)]([_0x3f6d6f],_0xc8ce81),_0x3f6d6f[0x0];}else _0x51df45=_0x232db8[_0x58139f(0x26c)](_0x32243c,_0x32dc0a);}throw new Error(_0x58139f(0x27b));},Flags[_0x6b832b(0x2c2)]=async function(_0x5edb78,_0x43a4d6){const _0x5134bb=_0x6b832b,_0x6ef534={'lnVvO':_0x5134bb(0x203),'dmMCr':function(_0x5a1a9b,_0x1fadf4){return _0x5a1a9b===_0x1fadf4;},'uRTaU':_0x5134bb(0x1cc),'WCSAd':'[[error:invalid-data]]'};if(_0x5edb78===_0x6ef534[_0x5134bb(0x241)])return await posts[_0x5134bb(0x21a)](_0x43a4d6);else{if(_0x6ef534[_0x5134bb(0x259)](_0x5edb78,_0x6ef534[_0x5134bb(0x21f)]))return await user[_0x5134bb(0x21a)](_0x43a4d6);}throw new Error(_0x6ef534[_0x5134bb(0x1d9)]);},Flags[_0x6b832b(0x361)]=async function(_0x269779,_0x1bbc19){const _0x5418e4=_0x6b832b,_0x580fd3={'LaqDk':function(_0x598ffc,_0x2bd91f){return _0x598ffc>=_0x2bd91f;}};return _0x580fd3[_0x5418e4(0x1eb)](await db['sortedSetScore'](_0x5418e4(0x26f),[_0x269779,_0x1bbc19][_0x5418e4(0x2c4)](':')),0x1);},Flags[_0x6b832b(0x342)]=async function(_0x21cc14,_0x517394){const _0x552ba8=_0x6b832b,_0x18705={'qccYx':function(_0x2f04ad,_0x18d507){return _0x2f04ad===_0x18d507;},'rttKQ':function(_0x1c7f18,_0x14e48a){return _0x1c7f18===_0x14e48a;},'YjCXb':_0x552ba8(0x34a)};if(_0x18705['qccYx'](_0x21cc14,_0x552ba8(0x203))){if(_0x18705[_0x552ba8(0x1f9)](_0x18705[_0x552ba8(0x2d7)],_0x18705[_0x552ba8(0x2d7)]))return await posts[_0x552ba8(0x308)](_0x517394,_0x552ba8(0x2b9));else _0x518f14['push'](_0x2a549c[_0x552ba8(0x293)](_0x552ba8(0x2df)+_0x352e03,_0x5b1e90,_0x44e8d3));}return _0x517394;},Flags[_0x6b832b(0x2a9)]=async function(_0xf0da7b,_0x29d44b){const _0x52d352=_0x6b832b,_0x54db67={'HzpOm':function(_0x4ddc0b,_0x5b732c){return _0x4ddc0b===_0x5b732c;},'mINez':_0x52d352(0x203)};if(_0x54db67[_0x52d352(0x27a)](_0xf0da7b,_0x54db67[_0x52d352(0x23d)]))return await posts['getCidByPid'](_0x29d44b);return null;},Flags[_0x6b832b(0x1f7)]=async function(_0x3319f8,_0x24de53,_0x333ee3){const _0x2a00af=_0x6b832b,_0x45e571={'GBSAm':function(_0x2d4402,_0x491746){return _0x2d4402===_0x491746;},'KxZUV':_0x2a00af(0x329),'tFojk':function(_0x469d2b,_0x4d7e10){return _0x469d2b===_0x4d7e10;},'pKHDy':_0x2a00af(0x203),'wUBUN':'notifications','KYBkd':_0x2a00af(0x262),'qhozX':'targetId','unHjU':function(_0x2b6f13,_0x1d67c8){return _0x2b6f13!==_0x1d67c8;},'rplFx':_0x2a00af(0x289),'sonpI':_0x2a00af(0x29c),'gcKqi':_0x2a00af(0x31d),'OMeme':_0x2a00af(0x229),'wcNcy':_0x2a00af(0x2fe),'FVHuq':function(_0x46848d,_0x296428){return _0x46848d(_0x296428);},'WmHui':function(_0x5ca003,_0x591ad5){return _0x5ca003===_0x591ad5;},'tVfzE':_0x2a00af(0x286),'upZKf':function(_0x2bf2e4,_0x282b66){return _0x2bf2e4===_0x282b66;},'zLaiZ':_0x2a00af(0x334),'WqIBY':function(_0x24910b,_0x50a212){return _0x24910b===_0x50a212;}},_0x410327=await db[_0x2a00af(0x1c9)](_0x2a00af(0x34d)+_0x3319f8,['uid',_0x45e571['KYBkd'],_0x2a00af(0x334),_0x2a00af(0x246),_0x45e571['qhozX']]);if(!_0x410327[_0x2a00af(0x246)])return;const _0x222abd=_0x333ee3[_0x2a00af(0x34f)]||Date[_0x2a00af(0x1f2)](),_0x54dc53=async function(_0x52781b){const _0x48f84d=_0x2a00af;if(_0x45e571[_0x48f84d(0x328)](_0x52781b,'')||parseInt(_0x24de53,0xa)===parseInt(_0x52781b,0xa))return;const _0x5801d6=await notifications['create']({'type':_0x45e571[_0x48f84d(0x23a)],'bodyShort':_0x48f84d(0x245)+_0x3319f8+']]','bodyLong':'','path':_0x48f84d(0x2e7)+_0x3319f8,'nid':_0x48f84d(0x324)+_0x3319f8+_0x48f84d(0x32c)+_0x52781b,'from':_0x24de53});await notifications['push'](_0x5801d6,[_0x52781b]);},_0x16802c=async function(_0x132e63){const _0x4ec334=_0x2a00af;let _0xa5808b=![];_0xa5808b=await user[_0x4ec334(0x238)](_0x132e63);if(!_0xa5808b&&_0x45e571[_0x4ec334(0x242)](_0x410327[_0x4ec334(0x246)],_0x45e571[_0x4ec334(0x317)])){const _0x494469=await posts[_0x4ec334(0x2b0)](_0x410327['targetId']);_0xa5808b=await user[_0x4ec334(0x2cf)](_0x132e63,_0x494469);}return _0xa5808b;};async function _0xf678c5(_0x150749){const _0x2c15f2=_0x2a00af,_0x428e06=await db[_0x2c15f2(0x1cb)]({'key':_0x45e571[_0x2c15f2(0x1e4)],'match':_0x150749+'*'});return notifications[_0x2c15f2(0x2fe)](_0x428e06);}const _0x4c789e=[];for(const _0x332193 of Object[_0x2a00af(0x1c8)](_0x333ee3)){if(_0x45e571[_0x2a00af(0x294)](_0x45e571[_0x2a00af(0x222)],'QdJfS')){if(_0x410327[_0x332193]===_0x333ee3[_0x332193])delete _0x333ee3[_0x332193];else{if(_0x45e571[_0x2a00af(0x242)](_0x332193,_0x2a00af(0x262)))_0x2a00af(0x2b8)!==_0x45e571[_0x2a00af(0x31b)]?!Flags[_0x2a00af(0x20a)][_0x2a00af(0x24d)](_0x333ee3[_0x332193])?delete _0x333ee3[_0x332193]:(_0x4c789e[_0x2a00af(0x2e8)](db[_0x2a00af(0x293)](_0x2a00af(0x1f8)+_0x333ee3[_0x332193],_0x222abd,_0x3319f8)),_0x4c789e[_0x2a00af(0x2e8)](db[_0x2a00af(0x207)](_0x2a00af(0x1f8)+_0x410327[_0x332193],_0x3319f8)),_0x333ee3[_0x332193]===_0x45e571['gcKqi']&&meta['config'][_0x45e571['OMeme']]===_0x45e571[_0x2a00af(0x330)]&&_0x4c789e[_0x2a00af(0x2e8)](_0x45e571[_0x2a00af(0x1cf)](_0xf678c5,'flag:'+_0x410327[_0x2a00af(0x246)]+':'+_0x410327['targetId'])),_0x45e571[_0x2a00af(0x1ce)](_0x333ee3[_0x332193],_0x45e571[_0x2a00af(0x1e2)])&&meta[_0x2a00af(0x346)][_0x2a00af(0x326)]==='rescind'&&_0x4c789e[_0x2a00af(0x2e8)](_0xf678c5(_0x2a00af(0x34d)+_0x410327[_0x2a00af(0x246)]+':'+_0x410327[_0x2a00af(0x270)]))):_0x7ecb61['_filters'][_0x14a3ca](_0x1ad8de,_0x23f971,_0x4babaa[_0x4bdcd0],_0x1ac5a0);else{if(_0x45e571[_0x2a00af(0x309)](_0x332193,_0x45e571['zLaiZ'])){if(_0x45e571[_0x2a00af(0x1d3)](_0x333ee3[_0x332193],''))_0x4c789e[_0x2a00af(0x2e8)](db[_0x2a00af(0x207)]('flags:byAssignee:'+_0x333ee3[_0x332193],_0x3319f8));else!await _0x45e571['FVHuq'](_0x16802c,parseInt(_0x333ee3[_0x332193],0xa))?delete _0x333ee3[_0x332193]:(_0x4c789e['push'](db['sortedSetAdd'](_0x2a00af(0x277)+_0x333ee3[_0x332193],_0x222abd,_0x3319f8)),_0x4c789e['push'](_0x54dc53(_0x333ee3[_0x332193])));}}}}else return;}if(!Object['keys'](_0x333ee3)[_0x2a00af(0x278)])return;_0x4c789e[_0x2a00af(0x2e8)](db[_0x2a00af(0x313)](_0x2a00af(0x34d)+_0x3319f8,_0x333ee3)),_0x4c789e[_0x2a00af(0x2e8)](Flags['appendHistory'](_0x3319f8,_0x24de53,_0x333ee3)),await Promise[_0x2a00af(0x29d)](_0x4c789e),plugins[_0x2a00af(0x2ca)][_0x2a00af(0x27f)]('action:flags.update',{'flagId':_0x3319f8,'changeset':_0x333ee3,'uid':_0x24de53});},Flags['resolveFlag']=async function(_0x34a68b,_0x27d82e,_0x5eb4e3){const _0x3f3287=_0x6b832b,_0x264cdf=await Flags[_0x3f3287(0x30a)](_0x34a68b,_0x27d82e);parseInt(_0x264cdf,0xa)&&await Flags[_0x3f3287(0x1f7)](_0x264cdf,_0x5eb4e3,{'state':_0x3f3287(0x31d)});},Flags[_0x6b832b(0x32b)]=async function(_0x2398c3,_0x57c331){const _0x397d0a=_0x6b832b,_0x45805d={'GgLko':'flagId','ZiYpv':'resolved'};meta[_0x397d0a(0x346)][_0x397d0a(0x243)]&&await batch['processSortedSet'](_0x397d0a(0x2c9)+_0x2398c3+_0x397d0a(0x2e1),async _0x468bb3=>{const _0x525789=_0x397d0a;let _0x122761=await posts[_0x525789(0x2a0)](_0x468bb3,[_0x525789(0x33b),_0x45805d[_0x525789(0x1e8)]]);_0x122761=_0x122761[_0x525789(0x1d5)](_0x59717d=>_0x59717d&&_0x59717d[_0x525789(0x2d5)]&&parseInt(_0x59717d[_0x525789(0x2d5)],0xa));for(const _0x3beede of _0x122761){await Flags['update'](_0x3beede[_0x525789(0x2d5)],_0x57c331,{'state':_0x45805d['ZiYpv']});}},{'batch':0x1f4});},Flags[_0x6b832b(0x231)]=async function(_0x41b929){const _0x9f4b25=_0x6b832b,_0xb9e1d3={'bKoJo':'[[error:user-banned]]','sJMND':'state','lYKTF':function(_0x548963,_0x378683){return _0x548963===_0x378683;},'YTGtT':_0x9f4b25(0x334),'VlhRE':function(_0x355550,_0x1509f4){return _0x355550!==_0x1509f4;},'ZVydd':'HgqXw','ilwcS':'username','mBkfg':_0x9f4b25(0x2cc),'tjDsy':function(_0x56b1b7,_0x3d554f,_0x252a27,_0x1ad7d7){return _0x56b1b7(_0x3d554f,_0x252a27,_0x1ad7d7);},'ztjxv':function(_0x26a4b8,_0x62c70f,_0x44d23a,_0x5cba5f){return _0x26a4b8(_0x62c70f,_0x44d23a,_0x5cba5f);},'cHIxZ':_0x9f4b25(0x2b1)},_0x2401fb=[];let _0x3b3682=await db[_0x9f4b25(0x347)]('flag:'+_0x41b929+':history',0x0,-0x1);const _0x23f490=await db[_0x9f4b25(0x256)](_0x9f4b25(0x34d)+_0x41b929,_0xb9e1d3['mBkfg']);_0x3b3682=_0x3b3682['map'](_0x303f54=>{const _0x3278b=_0x9f4b25;_0x303f54[_0x3278b(0x266)]=JSON['parse'](_0x303f54[_0x3278b(0x266)]),_0x2401fb[_0x3278b(0x2e8)](_0x303f54[_0x3278b(0x266)][0x0]);const _0x278c42=_0x303f54['value'][0x1];_0x278c42[_0x3278b(0x300)](_0xb9e1d3[_0x3278b(0x2e2)])&&(_0x278c42[_0x3278b(0x262)]=_0xb9e1d3[_0x3278b(0x22d)](_0x278c42[_0x3278b(0x262)],undefined)?'':_0x3278b(0x322)+_0x278c42[_0x3278b(0x262)]+']]');if(_0x278c42[_0x3278b(0x300)]('report')){if(_0xb9e1d3[_0x3278b(0x22d)](_0x3278b(0x299),'eKAkn'))_0x278c42['report']=_0x3278b(0x1e9)+_0x278c42[_0x3278b(0x29b)]+']]';else throw new _0x1bdd5a(_0xb9e1d3[_0x3278b(0x264)]);}return{'uid':_0x303f54['value'][0x0],'fields':_0x278c42,'datetime':_0x303f54[_0x3278b(0x354)],'datetimeISO':utils['toISOString'](_0x303f54[_0x3278b(0x354)])};}),await Promise[_0x9f4b25(0x29d)](_0x3b3682[_0x9f4b25(0x269)](async _0x184ad6=>{const _0x59d37b=_0x9f4b25;if(_0x184ad6[_0x59d37b(0x228)][_0x59d37b(0x300)](_0xb9e1d3[_0x59d37b(0x30c)])){if(_0xb9e1d3[_0x59d37b(0x2e3)](_0xb9e1d3[_0x59d37b(0x2ba)],'nmTdJ'))_0x184ad6[_0x59d37b(0x228)][_0x59d37b(0x334)]=await user[_0x59d37b(0x2f1)](_0x184ad6[_0x59d37b(0x228)]['assignee'],_0xb9e1d3[_0x59d37b(0x2da)]);else throw new _0x2770ad(_0x59d37b(0x274));}})),_0x3b3682=await _0xb9e1d3['tjDsy'](mergeBanHistory,_0x3b3682,_0x23f490,_0x2401fb),_0x3b3682=await _0xb9e1d3[_0x9f4b25(0x1dc)](mergeMuteHistory,_0x3b3682,_0x23f490,_0x2401fb),_0x3b3682=await _0xb9e1d3['ztjxv'](mergeUsernameEmailChanges,_0x3b3682,_0x23f490,_0x2401fb);const _0x54cf19=await user[_0x9f4b25(0x204)](_0x2401fb,[_0x9f4b25(0x2a6),_0xb9e1d3[_0x9f4b25(0x28b)],_0x9f4b25(0x249)]);return _0x3b3682['forEach']((_0x3cb2ba,_0x96904b)=>{const _0x43bd61=_0x9f4b25;_0x3cb2ba[_0x43bd61(0x1cc)]=_0x54cf19[_0x96904b];}),_0x3b3682=_0x3b3682[_0x9f4b25(0x25c)]((_0x4ad5c9,_0xc50150)=>_0xc50150['datetime']-_0x4ad5c9[_0x9f4b25(0x34f)]),_0x3b3682;},Flags[_0x6b832b(0x1cd)]=async function(_0x51c3d8,_0x430432,_0x13483f){const _0x299735=_0x6b832b,_0x2185cc=_0x13483f[_0x299735(0x34f)]||Date['now']();delete _0x13483f[_0x299735(0x34f)];const _0x3ee800=JSON[_0x299735(0x352)]([_0x430432,_0x13483f,_0x2185cc]);await db[_0x299735(0x293)](_0x299735(0x34d)+_0x51c3d8+':history',_0x2185cc,_0x3ee800);},Flags[_0x6b832b(0x2b2)]=async function(_0x160cc7,_0x3f6397,_0x3f47fc,_0x7c6cce){const _0x33b532=_0x6b832b,_0x1fd1d8={'NTNJT':function(_0x9987fe,_0x515582){return _0x9987fe===_0x515582;}};if(_0x7c6cce)try{await Flags['deleteNote'](_0x160cc7,_0x7c6cce);}catch(_0x489e3b){if(_0x1fd1d8[_0x33b532(0x23f)](!_0x489e3b[_0x33b532(0x338)],'[[error:invalid-data]]'))throw _0x489e3b;}_0x7c6cce=_0x7c6cce||Date['now']();const _0x2e6d82=JSON['stringify']([_0x3f6397,_0x3f47fc]);await db[_0x33b532(0x293)](_0x33b532(0x34d)+_0x160cc7+_0x33b532(0x1fe),_0x7c6cce,_0x2e6d82),await Flags[_0x33b532(0x1cd)](_0x160cc7,_0x3f6397,{'notes':null,'datetime':_0x7c6cce});},Flags['notify']=async function(_0x4479dd,_0x4db0c8,_0x1a5fe1=![]){const _0x3cc891=_0x6b832b,_0x337535={'JhAgj':'administrators','JfBKm':_0x3cc891(0x337),'bVSPF':function(_0xa1ffb1,_0x334029){return _0xa1ffb1===_0x334029;},'amlno':_0x3cc891(0x252),'aOcJQ':_0x3cc891(0x2a3),'URrzR':'new-post-flag','vJYqK':_0x3cc891(0x1cc),'liqYQ':_0x3cc891(0x2bd),'hwTUU':_0x3cc891(0x27b),'YUOXr':function(_0x42a1d5,_0x12e4b2){return _0x42a1d5===_0x12e4b2;},'kTxFl':_0x3cc891(0x304)},[_0x20fb99,_0x314418]=await Promise[_0x3cc891(0x29d)]([groups[_0x3cc891(0x28c)](_0x337535['JhAgj'],0x0,-0x1),groups[_0x3cc891(0x28c)](_0x337535[_0x3cc891(0x258)],0x0,-0x1)]);let _0x97d6a2=_0x20fb99[_0x3cc891(0x2c7)](_0x314418),_0x39fc2f=null;const {displayname:_0x5abb6f}=_0x4479dd[_0x3cc891(0x349)][_0x4479dd[_0x3cc891(0x349)][_0x3cc891(0x278)]-0x1][_0x3cc891(0x288)];if(_0x337535['bVSPF'](_0x4479dd['type'],_0x3cc891(0x203))){const [_0x3f36c8,_0x4c4ee4]=await Promise[_0x3cc891(0x29d)]([topics['getTitleByPid'](_0x4479dd['targetId']),posts[_0x3cc891(0x2b0)](_0x4479dd[_0x3cc891(0x270)])]),_0x37ec29=await categories[_0x3cc891(0x28e)]([_0x4c4ee4]),_0x3e4d26=utils[_0x3cc891(0x28a)](_0x3f36c8)[_0x3cc891(0x224)](/%/g,_0x337535[_0x3cc891(0x35f)])[_0x3cc891(0x224)](/,/g,_0x337535[_0x3cc891(0x297)]);_0x39fc2f=await notifications['create']({'type':_0x337535[_0x3cc891(0x2c8)],'bodyShort':'[[notifications:user-flagged-post-in,\x20'+_0x5abb6f+',\x20'+_0x3e4d26+']]','bodyLong':await plugins[_0x3cc891(0x2ca)][_0x3cc891(0x27f)](_0x3cc891(0x2c0),String(_0x4479dd[_0x3cc891(0x335)]||'')),'pid':_0x4479dd['targetId'],'path':_0x3cc891(0x2e7)+_0x4479dd[_0x3cc891(0x2d5)],'nid':_0x3cc891(0x363)+_0x4479dd[_0x3cc891(0x270)]+':'+_0x4db0c8,'from':_0x4db0c8,'mergeId':'notifications:user-flagged-post-in|'+_0x4479dd[_0x3cc891(0x270)],'topicTitle':_0x3f36c8}),_0x97d6a2=_0x97d6a2['concat'](_0x37ec29[0x0]);}else{if(_0x4479dd['type']===_0x337535[_0x3cc891(0x2ae)]){const _0x3b6f60=_0x4479dd['target']&&_0x4479dd[_0x3cc891(0x318)][_0x3cc891(0x218)]?_0x4479dd['target'][_0x3cc891(0x218)]:_0x3cc891(0x2aa);_0x39fc2f=await notifications[_0x3cc891(0x24b)]({'type':_0x337535[_0x3cc891(0x29f)],'bodyShort':_0x3cc891(0x1d8)+_0x5abb6f+',\x20'+_0x3b6f60+']]','bodyLong':await plugins[_0x3cc891(0x2ca)][_0x3cc891(0x27f)](_0x3cc891(0x2c0),String(_0x4479dd[_0x3cc891(0x335)]||'')),'path':_0x3cc891(0x2e7)+_0x4479dd[_0x3cc891(0x2d5)],'nid':_0x3cc891(0x236)+_0x4479dd[_0x3cc891(0x270)]+':'+_0x4db0c8,'from':_0x4db0c8,'mergeId':_0x3cc891(0x358)+_0x4479dd['targetId']});}else throw new Error(_0x337535[_0x3cc891(0x248)]);}plugins['hooks'][_0x3cc891(0x27f)](_0x3cc891(0x27e),{'flag':_0x4479dd,'notification':_0x39fc2f,'from':_0x4db0c8,'to':_0x97d6a2}),!_0x1a5fe1&&(_0x337535['YUOXr'](_0x337535['kTxFl'],_0x3cc891(0x304))?_0x97d6a2=_0x97d6a2['filter'](_0x192122=>parseInt(_0x192122,0xa)!==parseInt(_0x4db0c8,0xa)):_0x895e56[_0x3cc891(0x285)]['hasOwnProperty'](_0x2bac75)?_0x36f7a9['_filters'][_0x4a87cd](_0x50576f,_0x2d2a5d,_0x2c4cbe[_0x1e8fc3],_0x2f1b14):_0x29e422[_0x3cc891(0x34b)](_0x3cc891(0x2de)+_0x196c58)),await notifications[_0x3cc891(0x2e8)](_0x39fc2f,_0x97d6a2);};async function mergeBanHistory(_0x49509d,_0x14de6e,_0x5ca98d){const _0xca3d62=_0x6b832b;return await mergeBanMuteHistory(_0x49509d,_0x5ca98d,{'set':_0xca3d62(0x2c9)+_0x14de6e+':bans:timestamp','label':_0xca3d62(0x311),'reasonDefault':_0xca3d62(0x27c),'expiryKey':_0xca3d62(0x333)});}async function mergeMuteHistory(_0x497f69,_0x4039b5,_0x25e4f4){const _0x68cf84=_0x6b832b,_0xbbf89c={'eyhuW':'[[user:muted]]','NYEko':_0x68cf84(0x325)};return await mergeBanMuteHistory(_0x497f69,_0x25e4f4,{'set':'uid:'+_0x4039b5+_0x68cf84(0x2be),'label':_0xbbf89c[_0x68cf84(0x33c)],'reasonDefault':_0xbbf89c['NYEko'],'expiryKey':_0x68cf84(0x33a)});}async function mergeBanMuteHistory(_0x4063a2,_0x383e28,_0x4349fb){const _0x41a5ec=_0x6b832b,_0x36629b={'wCsLR':function(_0x3075a7,_0x4762c8){return _0x3075a7(_0x4762c8);},'ZlDBY':_0x41a5ec(0x319),'GsuqU':function(_0x4eade7,_0x27c87d,_0x5dd28b){return _0x4eade7(_0x27c87d,_0x5dd28b);},'uhdqt':_0x41a5ec(0x215),'vuYFa':function(_0x53ac1f,_0x4c7951,_0x4c39a6){return _0x53ac1f(_0x4c7951,_0x4c39a6);}};let _0x32aea0=await db[_0x41a5ec(0x2bf)](_0x4349fb['set'],0x0,0x13);return _0x32aea0=await db['getObjects'](_0x32aea0),_0x4063a2[_0x41a5ec(0x2c7)](_0x32aea0[_0x41a5ec(0x279)]((_0x11e240,_0x2c4659)=>{const _0x46a465=_0x41a5ec;return _0x383e28[_0x46a465(0x2e8)](_0x2c4659[_0x46a465(0x205)]),_0x11e240[_0x46a465(0x2e8)]({'uid':_0x2c4659[_0x46a465(0x205)],'meta':[{'key':_0x4349fb['label'],'value':validator[_0x46a465(0x2b6)](_0x36629b[_0x46a465(0x2fd)](String,_0x2c4659[_0x46a465(0x20d)]||_0x4349fb[_0x46a465(0x30f)])),'labelClass':_0x36629b[_0x46a465(0x25e)]},{'key':_0x4349fb[_0x46a465(0x33e)],'value':new Date(_0x36629b[_0x46a465(0x213)](parseInt,_0x2c4659[_0x46a465(0x31c)],0xa))[_0x46a465(0x2bc)](),'labelClass':_0x36629b[_0x46a465(0x26e)]}],'datetime':_0x36629b[_0x46a465(0x1e6)](parseInt,_0x2c4659[_0x46a465(0x2ee)],0xa),'datetimeISO':utils[_0x46a465(0x2bc)](_0x36629b[_0x46a465(0x1e6)](parseInt,_0x2c4659[_0x46a465(0x2ee)],0xa))}),_0x11e240;},[]));}async function mergeUsernameEmailChanges(_0x6b80c0,_0x57d64e,_0x3594b2){const _0x397591=_0x6b832b,_0x5bd809={'JiQXb':_0x397591(0x344)},_0x477dc4=await user[_0x397591(0x231)](_0x397591(0x219)+_0x57d64e+_0x397591(0x1e1)),_0x295dab=await user[_0x397591(0x231)](_0x397591(0x219)+_0x57d64e+_0x397591(0x237));return _0x6b80c0['concat'](_0x477dc4['reduce']((_0xf9fa05,_0x58bca3)=>{const _0x393507=_0x397591;return _0x3594b2[_0x393507(0x2e8)](_0x57d64e),_0xf9fa05[_0x393507(0x2e8)]({'uid':_0x57d64e,'meta':[{'key':'[[user:change-username]]','value':_0x58bca3[_0x393507(0x266)],'labelClass':_0x5bd809[_0x393507(0x2d2)]}],'datetime':_0x58bca3['timestamp'],'datetimeISO':_0x58bca3['timestampISO']}),_0xf9fa05;},[]))[_0x397591(0x2c7)](_0x295dab[_0x397591(0x279)]((_0x3910ff,_0x3f8b78)=>{const _0x5ce88c=_0x397591;return _0x3594b2[_0x5ce88c(0x2e8)](_0x57d64e),_0x3910ff['push']({'uid':_0x57d64e,'meta':[{'key':'[[user:change-email]]','value':_0x3f8b78[_0x5ce88c(0x266)],'labelClass':_0x5bd809['JiQXb']}],'datetime':_0x3f8b78[_0x5ce88c(0x2ee)],'datetimeISO':_0x3f8b78[_0x5ce88c(0x230)]}),_0x3910ff;},[]));}require('./promisify')(Flags);