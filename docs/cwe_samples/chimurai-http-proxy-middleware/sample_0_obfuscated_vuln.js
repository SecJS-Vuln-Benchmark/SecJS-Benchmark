const _0x507c07=_0xb400;(function(_0x1d7015,_0x44299f){const _0x141444=_0xb400,_0x2c9cb9=_0x1d7015();while(!![]){try{const _0x59d751=-parseInt(_0x141444(0x148))/0x1+parseInt(_0x141444(0x141))/0x2+parseInt(_0x141444(0x11a))/0x3*(-parseInt(_0x141444(0x133))/0x4)+parseInt(_0x141444(0x110))/0x5+-parseInt(_0x141444(0x10e))/0x6*(-parseInt(_0x141444(0x14f))/0x7)+parseInt(_0x141444(0x104))/0x8*(parseInt(_0x141444(0x135))/0x9)+-parseInt(_0x141444(0x13c))/0xa;if(_0x59d751===_0x44299f)break;else _0x2c9cb9['push'](_0x2c9cb9['shift']());}catch(_0x24a7cb){_0x2c9cb9['push'](_0x2c9cb9['shift']());}}}(_0x4cac,0xb9c73));import{describe,expect}from'vitest';function _0xb400(_0x1b28f2,_0x366972){const _0x4caca0=_0x4cac();return _0xb400=function(_0xb40001,_0x32a59d){_0xb40001=_0xb40001-0x101;let _0x5bf826=_0x4caca0[_0xb40001];return _0x5bf826;},_0xb400(_0x1b28f2,_0x366972);}import{getTestInstance}from'../../test-utils/test-instance';import{createAuthClient}from'../../client';import{createAuthEndpoint}from'../call';function _0x4cac(){const _0x4598ed=['should\x20not\x20allow\x20untrusted\x20origins','error','email','origin\x20check\x20middleware','ZaXoj','https://trusted-site.com','NQMiE','dUnjX','HKXfj','toBeTruthy','sRVHx','Wrlfo','KzbHN','query','message','toBeDefined','Invalid\x20redirectURL','https://localhost:3000','8322128LchvAm','mrvTE','/test?callbackURL=https://malicious-site.com','https://google.com','http://localhost:3000','toBe','XVOiC','/verify-email?callbackURL=https://malicious-site.com&token=xyz','forgetPassword','https://trusted.com','6OYkmav','shouldn\x27t\x20allow\x20untrusted\x20redirectTo','4483490BFbtxl','should\x20allow\x20trusted\x20origins','status','$fetch','should\x20work\x20with\x20list\x20of\x20trusted\x20origins','https://trusted.com.malicious.com','http://localhost:5000/reset-password','MhAiC','user','https://sub-domain.my-site.com','129507fGCXSR','should\x20return\x20invalid\x20origin','crULT','http://sub-domain.trusted.com','*.my-site.com','PPNcl','Invalid\x20callbackURL','signIn','password','shouldn\x27t\x20allow\x20untrusted\x20origin\x20subdomains','Yxbuc','KCHCQ','YNsbS','should\x20work\x20with\x20wildcard\x20trusted\x20origins','object','http://localhost:5000','should\x20allow\x20untrusted\x20origin\x20if\x20they\x20don\x27t\x20contain\x20cookies','/dashboard','session=123','aeBwr','RkdBc','FHuPu','string','//evil.com','MdCaa','36UKVumB','data','9xzMnRI','WIdAQ','value','malicious.com','test','VuiJf','/test?callbackURL=https://trusted-site.com/path','23732770iSHMbg','/test','shouldn\x27t\x20work\x20with\x20callback\x20url\x20with\x20double\x20slash','callbackURL','test@test.com','2290722KrrdFN','QzLan','https://sub-domain.my-site.com/callback','WXCbH','ydqeq','XaPpv','OjBQD','117743dMbumR','WSpuD','https://trusted-site.com/path','zyNto','jWJHJ','RntHX','VpGeQ','3907141PKgpKz','http://malicious.com','atNGX','Origin\x20Check'];_0x4cac=function(){return _0x4598ed;};return _0x4cac();}import{originCheck}from'./origin-check';import{z}from'zod';describe(_0x507c07(0x152),async _0x1f88b6=>{const _0x36bd15=_0x507c07,_0x52b8b6={'aeBwr':_0x36bd15(0x108),'WXCbH':_0x36bd15(0x140),'XVOiC':_0x36bd15(0x150),'QzLan':function(_0x5e978a,_0x5d322f){return _0x5e978a(_0x5d322f);},'OjBQD':_0x36bd15(0x120),'atNGX':'http://localhost:3000/callback','IUgWf':_0x36bd15(0x138),'MkvLZ':_0x36bd15(0x12c),'ZaXoj':_0x36bd15(0x115),'Wrlfo':function(_0x2aa60a,_0x60ce1f){return _0x2aa60a(_0x60ce1f);},'VuiJf':_0x36bd15(0x11d),'KzbHN':function(_0x34722e,_0x3c8018){return _0x34722e(_0x3c8018);},'RntHX':function(_0x2c8b3c,_0x2319db){return _0x2c8b3c(_0x2319db);},'crULT':_0x36bd15(0x102),'zyNto':_0x36bd15(0x10d),'RkdBc':_0x36bd15(0x116),'vYkVM':function(_0x5db076,_0x508838){return _0x5db076(_0x508838);},'dUnjX':_0x36bd15(0x119),'MhAiC':function(_0x55d612,_0x1de1f1){return _0x55d612(_0x1de1f1);},'Yxbuc':_0x36bd15(0x131),'PPNcl':function(_0x5ed568,_0x11e98e){return _0x5ed568(_0x11e98e);},'QCRXE':_0x36bd15(0x129),'rIKcA':_0x36bd15(0x11e),'MdCaa':function(_0xa0869e,_0x415bdb,_0x3837b3){return _0xa0869e(_0x415bdb,_0x3837b3);},'XaPpv':_0x36bd15(0x153),'KCHCQ':_0x36bd15(0x111),'PXSVy':'shouldn\x27t\x20allow\x20untrusted\x20origin\x20headers','WSpuD':function(_0x199ca4,_0x56d302,_0x58ded8){return _0x199ca4(_0x56d302,_0x58ded8);},'jWJHJ':_0x36bd15(0x12a),'WbhQI':_0x36bd15(0x10f),'Unjqq':_0x36bd15(0x114),'ngZPy':function(_0x472781,_0x45311c,_0x332d05){return _0x472781(_0x45311c,_0x332d05);},'WIdAQ':_0x36bd15(0x13e),'sRVHx':'should\x20work\x20with\x20GET\x20requests'},{customFetchImpl:_0x5a895b,testUser:_0x382950}=await _0x52b8b6[_0x36bd15(0x11f)](getTestInstance,{'trustedOrigins':[_0x52b8b6['QCRXE'],_0x52b8b6[_0x36bd15(0x14b)],_0x52b8b6['rIKcA']],'emailAndPassword':{'enabled':!![],async 'sendResetPassword'(_0x57e222,_0xdd3537){}},'advanced':{'disableCSRFCheck':![]}});_0x52b8b6[_0x36bd15(0x132)](_0x1f88b6,_0x52b8b6[_0x36bd15(0x146)],async _0x59af92=>{const _0x28ec1d=_0x36bd15,_0x3b6944=createAuthClient({'baseURL':_0x52b8b6[_0x28ec1d(0x12d)],'fetchOptions':{'customFetchImpl':_0x5a895b}}),_0x2187ab=await _0x3b6944[_0x28ec1d(0x121)][_0x28ec1d(0x155)]({'email':_0x52b8b6[_0x28ec1d(0x144)],'password':'password','callbackURL':_0x52b8b6['XVOiC']});expect(_0x2187ab[_0x28ec1d(0x154)]?.[_0x28ec1d(0x112)])[_0x28ec1d(0x109)](0x193),_0x52b8b6[_0x28ec1d(0x142)](expect,_0x2187ab['error']?.[_0x28ec1d(0x161)])[_0x28ec1d(0x109)](_0x52b8b6[_0x28ec1d(0x147)]);}),_0x52b8b6[_0x36bd15(0x132)](_0x1f88b6,_0x52b8b6[_0x36bd15(0x125)],async _0x58b8f5=>{const _0x8364e8=_0x36bd15,_0x50a12b=createAuthClient({'baseURL':_0x8364e8(0x108),'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6['aeBwr']}}}),_0x18b852=await _0x50a12b[_0x8364e8(0x121)]['email']({'email':_0x382950[_0x8364e8(0x155)],'password':_0x382950[_0x8364e8(0x122)],'callbackURL':_0x52b8b6[_0x8364e8(0x151)]});expect(_0x18b852[_0x8364e8(0x134)]?.[_0x8364e8(0x118)])[_0x8364e8(0x101)]();}),_0x52b8b6[_0x36bd15(0x132)](_0x1f88b6,_0x52b8b6['PXSVy'],async _0x4b8b29=>{const _0x2a5bd2=_0x36bd15,_0x2a6a9d=_0x52b8b6[_0x2a5bd2(0x142)](createAuthClient,{'baseURL':'http://localhost:3000','fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6['IUgWf'],'cookie':_0x52b8b6['MkvLZ']}}}),_0xcce4b6=await _0x2a6a9d[_0x2a5bd2(0x121)]['email']({'email':_0x382950['email'],'password':_0x382950[_0x2a5bd2(0x122)]});expect(_0xcce4b6[_0x2a5bd2(0x154)]?.[_0x2a5bd2(0x112)])['toBe'](0x193);}),_0x52b8b6[_0x36bd15(0x132)](_0x1f88b6,'shouldn\x27t\x20allow\x20untrusted\x20origin\x20headers\x20which\x20start\x20with\x20trusted\x20origin',async _0x42c9f0=>{const _0x2031e6=_0x36bd15,_0x1a0575=createAuthClient({'baseURL':'http://localhost:3000','fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6[_0x2031e6(0x157)],'cookie':_0x52b8b6['MkvLZ']}}}),_0x25c406=await _0x1a0575['signIn'][_0x2031e6(0x155)]({'email':_0x382950[_0x2031e6(0x155)],'password':_0x382950[_0x2031e6(0x122)]});expect(_0x25c406[_0x2031e6(0x154)]?.[_0x2031e6(0x112)])['toBe'](0x193);}),_0x1f88b6(_0x36bd15(0x123),async _0x2fe6dc=>{const _0x231762=_0x36bd15,_0xda0bf5=_0x52b8b6[_0x231762(0x15e)](createAuthClient,{'baseURL':_0x52b8b6[_0x231762(0x12d)],'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6['VuiJf'],'cookie':'session=123'}}}),_0x3eca77=await _0xda0bf5[_0x231762(0x121)][_0x231762(0x155)]({'email':_0x382950['email'],'password':_0x382950[_0x231762(0x122)]});expect(_0x3eca77[_0x231762(0x154)]?.[_0x231762(0x112)])['toBe'](0x193);}),_0x52b8b6[_0x36bd15(0x149)](_0x1f88b6,_0x52b8b6[_0x36bd15(0x14c)],async _0x8d6c33=>{const _0x2a9948=_0x36bd15,_0x1f1fc1=_0x52b8b6[_0x2a9948(0x142)](createAuthClient,{'baseURL':_0x52b8b6['aeBwr'],'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6[_0x2a9948(0x13a)]}}}),_0x596f05=await _0x1f1fc1['signIn'][_0x2a9948(0x155)]({'email':_0x382950[_0x2a9948(0x155)],'password':_0x382950['password']});_0x52b8b6[_0x2a9948(0x142)](expect,_0x596f05[_0x2a9948(0x134)]?.['user'])[_0x2a9948(0x101)]();}),_0x1f88b6(_0x52b8b6['WbhQI'],async _0x1b293e=>{const _0x3d6a4b=_0x36bd15,_0x40f1ed=_0x52b8b6[_0x3d6a4b(0x15f)](createAuthClient,{'baseURL':_0x52b8b6[_0x3d6a4b(0x12d)],'fetchOptions':{'customFetchImpl':_0x5a895b}}),_0x3f433a=await _0x40f1ed[_0x3d6a4b(0x10c)]({'email':_0x382950[_0x3d6a4b(0x155)],'redirectTo':_0x52b8b6[_0x3d6a4b(0x10a)]});_0x52b8b6[_0x3d6a4b(0x14d)](expect,_0x3f433a[_0x3d6a4b(0x154)]?.[_0x3d6a4b(0x112)])['toBe'](0x193),expect(_0x3f433a[_0x3d6a4b(0x154)]?.[_0x3d6a4b(0x161)])[_0x3d6a4b(0x109)](_0x52b8b6[_0x3d6a4b(0x11c)]);}),_0x1f88b6(_0x52b8b6['Unjqq'],async _0xab3215=>{const _0x66f14b=_0x36bd15,_0x42e584=createAuthClient({'baseURL':_0x66f14b(0x108),'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6[_0x66f14b(0x14b)]}}}),_0x435291=await _0x42e584[_0x66f14b(0x10c)]({'email':_0x382950[_0x66f14b(0x155)],'redirectTo':_0x52b8b6[_0x66f14b(0x12e)]});_0x52b8b6[_0x66f14b(0x15e)](expect,_0x435291[_0x66f14b(0x134)]?.[_0x66f14b(0x112)])[_0x66f14b(0x15c)]();const _0x5379b0=await _0x42e584[_0x66f14b(0x121)]['email']({'email':_0x382950[_0x66f14b(0x155)],'password':_0x382950[_0x66f14b(0x122)],'fetchOptions':{'query':{'currentURL':_0x66f14b(0x129)}}});_0x52b8b6[_0x66f14b(0x14d)](expect,_0x5379b0[_0x66f14b(0x134)]?.[_0x66f14b(0x118)])['toBeDefined']();}),_0x52b8b6['ngZPy'](_0x1f88b6,_0x36bd15(0x127),async _0x26c3d5=>{const _0x3ba0be=_0x36bd15,_0x2d317d=_0x52b8b6['vYkVM'](createAuthClient,{'baseURL':_0x52b8b6[_0x3ba0be(0x15a)],'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x52b8b6['dUnjX']}}}),_0x68ff9f=await _0x2d317d['signIn']['email']({'email':_0x382950['email'],'password':_0x382950[_0x3ba0be(0x122)],'callbackURL':_0x3ba0be(0x143)});_0x52b8b6[_0x3ba0be(0x117)](expect,_0x68ff9f[_0x3ba0be(0x134)]?.[_0x3ba0be(0x118)])[_0x3ba0be(0x101)]();}),_0x1f88b6(_0x52b8b6[_0x36bd15(0x136)],async _0x8c44ee=>{const _0x267675=_0x36bd15,_0x48f78c=_0x52b8b6[_0x267675(0x15e)](createAuthClient,{'baseURL':_0x52b8b6[_0x267675(0x12d)],'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x267675(0x103)}}}),_0x16e70b=await _0x48f78c['signIn'][_0x267675(0x155)]({'email':_0x382950[_0x267675(0x155)],'password':_0x382950[_0x267675(0x122)],'callbackURL':_0x52b8b6[_0x267675(0x124)]});expect(_0x16e70b[_0x267675(0x154)]?.[_0x267675(0x112)])[_0x267675(0x109)](0x193);}),_0x1f88b6(_0x52b8b6[_0x36bd15(0x15d)],async _0x13952f=>{const _0x2e6c10=_0x36bd15,_0x292091=_0x52b8b6['QzLan'](createAuthClient,{'baseURL':_0x2e6c10(0x119),'fetchOptions':{'customFetchImpl':_0x5a895b,'headers':{'origin':_0x2e6c10(0x107),'cookie':_0x2e6c10(0x137)}}}),_0x19529d=await _0x292091['$fetch']('/ok');_0x52b8b6['KzbHN'](expect,_0x19529d[_0x2e6c10(0x134)])['toMatchObject']({'ok':!![]});});}),describe(_0x507c07(0x156),async _0x21b49a=>{const _0x5391e9=_0x507c07,_0x5cb5c2={'NQMiE':_0x5391e9(0x139),'VpGeQ':_0x5391e9(0x13d),'HKXfj':function(_0x3df346,_0x8023b1){return _0x3df346(_0x8023b1);},'FHuPu':_0x5391e9(0x12b),'mrvTE':_0x5391e9(0x13b),'mBxdY':_0x5391e9(0x14a),'ydqeq':function(_0x9194b6,_0x107636,_0x350d5f){return _0x9194b6(_0x107636,_0x350d5f);},'YNsbS':_0x5391e9(0x11b)};_0x5cb5c2[_0x5391e9(0x145)](_0x21b49a,_0x5cb5c2[_0x5391e9(0x126)],async()=>{const _0x1f6c26=_0x5391e9,{client:_0x578f69}=await getTestInstance({'trustedOrigins':[_0x1f6c26(0x158)],'plugins':[{'id':_0x5cb5c2[_0x1f6c26(0x159)],'endpoints':{'test':createAuthEndpoint(_0x5cb5c2[_0x1f6c26(0x14e)],{'method':'GET','query':z[_0x1f6c26(0x128)]({'callbackURL':z[_0x1f6c26(0x130)]()}),'use':[originCheck(_0xb89fb7=>_0xb89fb7[_0x1f6c26(0x160)][_0x1f6c26(0x13f)])]},async _0x2ea9aa=>{const _0x4ff3fb=_0x1f6c26;return _0x2ea9aa[_0x4ff3fb(0x160)][_0x4ff3fb(0x13f)];})}}]}),_0x4b3a02=await _0x578f69['$fetch'](_0x1f6c26(0x106));_0x5cb5c2[_0x1f6c26(0x15b)](expect,_0x4b3a02[_0x1f6c26(0x154)]?.[_0x1f6c26(0x112)])[_0x1f6c26(0x109)](0x193);const _0x256f62=await _0x578f69[_0x1f6c26(0x113)]('/test?callbackURL=/dashboard');expect(_0x256f62['data'])[_0x1f6c26(0x109)](_0x5cb5c2[_0x1f6c26(0x12f)]);const _0x3f7831=await _0x578f69[_0x1f6c26(0x113)](_0x5cb5c2[_0x1f6c26(0x105)]);expect(_0x3f7831['data'])[_0x1f6c26(0x109)](_0x5cb5c2['mBxdY']);const _0x288680=await _0x578f69['$fetch'](_0x1f6c26(0x10b));expect(_0x288680['error']?.[_0x1f6c26(0x112)])['toBe'](0x193);});});