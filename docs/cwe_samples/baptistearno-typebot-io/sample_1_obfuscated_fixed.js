(function(_0x2a96ff,_0xde38b7){const _0x59f977=_0x5bb2,_0xb4f91a=_0x2a96ff();while(!![]){try{const _0x57ae00=-parseInt(_0x59f977(0x184))/0x1*(-parseInt(_0x59f977(0x191))/0x2)+parseInt(_0x59f977(0x190))/0x3*(-parseInt(_0x59f977(0x181))/0x4)+parseInt(_0x59f977(0x187))/0x5*(-parseInt(_0x59f977(0x186))/0x6)+-parseInt(_0x59f977(0x192))/0x7+parseInt(_0x59f977(0x17f))/0x8*(-parseInt(_0x59f977(0x183))/0x9)+-parseInt(_0x59f977(0x18c))/0xa*(-parseInt(_0x59f977(0x18f))/0xb)+-parseInt(_0x59f977(0x188))/0xc*(-parseInt(_0x59f977(0x18a))/0xd);if(_0x57ae00===_0xde38b7)break;else _0xb4f91a['push'](_0xb4f91a['shift']());}catch(_0x52eb38){_0xb4f91a['push'](_0xb4f91a['shift']());}}}(_0x195c,0x709cc));import{describe,expect,it}from'vitest';function _0x195c(){const _0x56164f=['52540WOiAfZ','toThrowError','68391nLlIOl','275957sKogPO','should\x20encrypt/decrypt\x20a\x20payload\x20with\x20the\x20correct\x20secret','12joRIsq','2232895gdWMPP','780UNRzpA','should\x20fail\x20to\x20decrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','458497UCgKBP','should\x20fail\x20to\x20decrypt\x20a\x20payload\x20with\x20the\x20incorrect\x20secret','220vpsgMt','JXtYt','should\x20fail\x20to\x20encrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','167882fSrOft','159PWKcJL','2LiHJrl','3262588ELsSej','value','TOBoB','MkgiW','QZHpr','408LHQdMi','rejects'];_0x195c=function(){return _0x56164f;};return _0x195c();}import{generateSecret}from'../test/utils';import{decrypt,encrypt}from'./cookies';function _0x5bb2(_0x33fc1f,_0xa19383){const _0x195c1b=_0x195c();return _0x5bb2=function(_0x5bb20d,_0x5126ba){_0x5bb20d=_0x5bb20d-0x17d;let _0x404353=_0x195c1b[_0x5bb20d];return _0x404353;},_0x5bb2(_0x33fc1f,_0xa19383);}describe('encrypt/decrypt',async()=>{const _0x561321=_0x5bb2,_0x48d614={'TOBoB':_0x561321(0x193),'MkgiW':function(_0x10a7ea,_0x38858a){return _0x10a7ea(_0x38858a);},'QZHpr':function(_0x336df,_0x21772e){return _0x336df(_0x21772e);},'JXtYt':function(_0x16de9c,_0x269e1e,_0x197577){return _0x16de9c(_0x269e1e,_0x197577);},'QDQxk':_0x561321(0x18b)},_0x3b6a4e=await generateSecret(0x20),_0x43871f=await _0x48d614[_0x561321(0x17e)](generateSecret,0x20);_0x48d614[_0x561321(0x18d)](it,_0x561321(0x185),async()=>{const _0x36aae9=_0x561321,_0x2c094e={'key':_0x36aae9(0x193)},_0x15115a=await encrypt(_0x2c094e,_0x3b6a4e),_0xbc757f=await decrypt(_0x15115a,_0x3b6a4e);expect(_0xbc757f['payload'])['toEqual'](_0x2c094e);}),it(_0x48d614['QDQxk'],async()=>{const _0x2ab0c7=_0x561321,_0x4ec4c0={'key':_0x48d614[_0x2ab0c7(0x194)]},_0x9d9167=await encrypt(_0x4ec4c0,_0x3b6a4e);await _0x48d614['MkgiW'](expect,()=>decrypt(_0x9d9167,_0x43871f))[_0x2ab0c7(0x180)][_0x2ab0c7(0x182)]();}),it(_0x561321(0x18e),async()=>{const _0x3bc77c=_0x561321,_0x44087f={'key':'value'};await expect(()=>encrypt(_0x44087f,''))[_0x3bc77c(0x180)][_0x3bc77c(0x182)]();}),it(_0x561321(0x189),async()=>{const _0x3f37e4=_0x561321,_0x4ab846={'key':_0x3f37e4(0x193)},_0x45a386=await encrypt(_0x4ab846,_0x3b6a4e);await _0x48d614[_0x3f37e4(0x17d)](expect,()=>decrypt(_0x45a386,''))[_0x3f37e4(0x180)]['toThrowError']();});});