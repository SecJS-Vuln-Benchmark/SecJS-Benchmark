function _0x4e70(){const _0x5e28be=['Content-Security-Policy','compare','get_hashed_password','Invalid\x20authentication\x20provided.\x20Please\x20provide\x20a\x20proper\x20correlation\x20API\x20key.','ids','PjnEW','WDjQL','PeZxc','pBuls','vyzUj','unlink','object','save','KynAD','findOne','path','3141951XUKfgY','name','boolean','startsWith','HKWSo','ajwnR','put','Dkgar','default','session','NO_SESSION_SECRET_SET','toString','onRdU','ADMIN_PASSWORD_SETTINGS_KEY','destroy','dKhXN','express','sequelize','formatter','query','CollectedPages','CHAINLOAD_URI_SETTINGS_KEY','RcxLd','uuid','all','6084745izzqyz','EXISTING_INJECTION_KEY','settings','send_alert_emails','bujjF','XHXLU','Settings','alBqQ','findAndCountAll','count','PuXac','revoke_all_sessions','toLowerCase','./constants.js','fzsfj','string','value','xDhKu','CORRELATION_API_SECRET_SETTINGS_KEY','limit','4148120ewJBPP','GvrBP','aZbLt','parse','No\x20session\x20secret\x20is\x20set,\x20can\x27t\x20start\x20API\x20server\x20(this\x20really\x20shouldn\x27t\x20happen...)!','pages_to_collect','payloadfires','hXVrg','aLqvp','./front-end/dist/','DZXPR','mgCNw','authenticated','chainload_uri','YEauj','esIbq','yzKFi','8zSJxnF','CwaPv','@nvanexan/node-client-sessions','Injection\x20request\x20successfully\x20recorded!','PAGES_TO_COLLECT_SETTINGS_KEY','ZJOUa','status','CtEEO','You\x20must\x20be\x20authenticated\x20to\x20use\x20this\x20endpoint.','update_settings_value','sLGEs','static','yDIZL','env','create','get','fFAkm','TlHqq','ItvDc','safe-compare','header','resolve','login','key','fIXPq','azDAd','bcrypt','wGrqM','post','body','No\x20CSRF\x20header\x20specified,\x20request\x20rejected.','./front-end/dist/favicon.ico','wTncp','2147336VUjrtA','xkxjA','oeGRe','findAll','bwrBM','map','unavD','AQPgL','session_secret_key','XJYuz','2907582tIuagM','owner_correlation_key','MHiHR','.png.gz','default-src\x20\x27none\x27;\x20script-src\x20\x27self\x27;\x20style-src\x20\x27self\x27\x20\x27unsafe-inline\x27;\x20img-src\x20\x27self\x27;\x20font-src\x20\x27self\x27;\x20connect-src\x20\x27self\x27;\x20prefetch-src\x20\x27self\x27;\x20manifest-src\x20\x27self\x27','Incorrect\x20password,\x20please\x20try\x20again.','screenshot_id','collected_pages','page','rows','use','INVALID_CREDENTIALS','nrYhp','RFRVa','json','./utils.js','SequelizeUniqueConstraintError','password','promises','correlation_api_key','SEND_ALERT_EMAILS_KEY','end','IOnyu','array','6561562LXxRVs','[0-9]+','API_BASE_PATH','FyTxi','386730yAXXEP','exports','DESC','InjectionRequests','That\x20injection\x20key\x20has\x20already\x20been\x20used\x20previously.','error','injection_key','yLNEc'];_0x4e70=function(){return _0x5e28be;};return _0x4e70();}function _0x1d4b(_0x1020a,_0x5d9f57){const _0x4e703d=_0x4e70();return _0x1d4b=function(_0x1d4bf9,_0x34c3b1){_0x1d4bf9=_0x1d4bf9-0x1a7;let _0x2c8fef=_0x4e703d[_0x1d4bf9];return _0x2c8fef;},_0x1d4b(_0x1020a,_0x5d9f57);}const _0x2af5bf=_0x1d4b;(function(_0x12783,_0x778be5){const _0x596d7b=_0x1d4b,_0xf92a3e=_0x12783();while(!![]){try{const _0x3ca98a=parseInt(_0x596d7b(0x1c6))/0x1+parseInt(_0x596d7b(0x23d))/0x2+parseInt(_0x596d7b(0x1de))/0x3+-parseInt(_0x596d7b(0x20b))/0x4+-parseInt(_0x596d7b(0x1f7))/0x5+-parseInt(_0x596d7b(0x1aa))/0x6+-parseInt(_0x596d7b(0x1c2))/0x7*(-parseInt(_0x596d7b(0x21c))/0x8);if(_0x3ca98a===_0x778be5)break;else _0xf92a3e['push'](_0xf92a3e['shift']());}catch(_0xa3cae1){_0xf92a3e['push'](_0xf92a3e['shift']());}}}(_0x4e70,0xac7c9));const bcrypt=require(_0x2af5bf(0x236)),express=require(_0x2af5bf(0x1ee)),cors=require('cors'),path=require(_0x2af5bf(0x1dd)),uuid=require(_0x2af5bf(0x1f5)),asyncfs=require('fs')[_0x2af5bf(0x1bc)],sessions=require(_0x2af5bf(0x21e)),favicon=require('serve-favicon'),database=require('./database.js'),safeCompare=require(_0x2af5bf(0x22f)),{Op}=require('sequelize'),sequelize=database[_0x2af5bf(0x1ef)],Settings=database[_0x2af5bf(0x1fd)],PayloadFireResults=database['PayloadFireResults'],CollectedPages=database[_0x2af5bf(0x1f2)],InjectionRequests=database[_0x2af5bf(0x1c9)],update_settings_value=database[_0x2af5bf(0x225)],constants=require(_0x2af5bf(0x204)),validate=require('express-jsonschema')['validate'],get_hashed_password=require('./utils.js')[_0x2af5bf(0x1d0)],get_secure_random_string=require(_0x2af5bf(0x1b9))['get_secure_random_string'],SCREENSHOTS_DIR=path[_0x2af5bf(0x231)](process[_0x2af5bf(0x229)]['SCREENSHOTS_DIR']);var sessions_middleware=![],sessions_settings_object={'cookieName':_0x2af5bf(0x1e7),'duration':0x7*0x18*0x3c*0x3c*0x3e8,'activeDuration':0x3e8*0x3c*0x5,'cookie':{'httpOnly':!![],'secure':!![]}};function session_wrapper_function(_0x326bef,_0x103430,_0x4faaaf){const _0x3d4307=_0x2af5bf,_0x1cfbac={'yLNEc':function(_0x4fb317,_0x4c51eb,_0x5b6a37,_0xa22ee1){return _0x4fb317(_0x4c51eb,_0x5b6a37,_0xa22ee1);}};return _0x1cfbac[_0x3d4307(0x1cd)](sessions_middleware,_0x326bef,_0x103430,_0x4faaaf);}async function set_up_api_server(_0x4fafae){const _0x294c4f=_0x2af5bf,_0x3b8952={'GvrBP':function(_0x14ecde){return _0x14ecde();},'fFAkm':function(_0x1e72d9,_0xd989d4){return _0x1e72d9===_0xd989d4;},'zNnWz':_0x294c4f(0x1d7),'fIXPq':_0x294c4f(0x1ae),'DZXPR':_0x294c4f(0x211),'hXVrg':_0x294c4f(0x1b1),'HKWSo':function(_0x4b790f,_0x39184a){return _0x4b790f===_0x39184a;},'zNQVu':function(_0x512225){return _0x512225();},'mADRh':_0x294c4f(0x224),'XHXLU':'NOT_AUTHENTICATED','fzsfj':_0x294c4f(0x1ce),'RcxLd':function(_0x27073a,_0x574a15){return _0x27073a==_0x574a15;},'KynAD':_0x294c4f(0x1af),'XJYuz':_0x294c4f(0x1b0),'yDIZL':function(_0x14822f,_0x445d97){return _0x14822f(_0x445d97);},'esIbq':'createdAt','wGrqM':function(_0x4e42d5,_0x152547,_0x1ef57a,_0x4cabf5){return _0x4e42d5(_0x152547,_0x1ef57a,_0x4cabf5);},'azDAd':function(_0x1ac173,_0x5be4c7){return _0x1ac173*_0x5be4c7;},'unavD':function(_0xf63d39,_0x5f2b70){return _0xf63d39*_0x5f2b70;},'oeGRe':_0x294c4f(0x1c8),'bwrBM':_0x294c4f(0x1d1),'xkxjA':_0x294c4f(0x1b5),'yRFMD':_0x294c4f(0x1ca),'yzKFi':'An\x20unexpected\x20error\x20occurred.','onRdU':_0x294c4f(0x1bd),'nrYhp':_0x294c4f(0x210),'bujjF':function(_0x35f587,_0x161b3b){return _0x35f587(_0x161b3b);},'MHiHR':_0x294c4f(0x1d3),'CwaPv':_0x294c4f(0x1c0),'PeZxc':function(_0x2cab6e,_0x4aa0e6){return _0x2cab6e(_0x4aa0e6);},'WDjQL':function(_0x16ab50,_0x41d451,_0x49c3ec){return _0x16ab50(_0x41d451,_0x49c3ec);},'aLqvp':_0x294c4f(0x1e5),'RFRVa':_0x294c4f(0x1a7),'dKhXN':function(_0x591767,_0x594a84,_0x7d1a0){return _0x591767(_0x594a84,_0x7d1a0);},'CtEEO':function(_0x5d7ca3,_0x1dfd98,_0x159967){return _0x5d7ca3(_0x1dfd98,_0x159967);},'ItvDc':_0x294c4f(0x1e8),'sLGEs':_0x294c4f(0x1d9),'alBqQ':'string','FyTxi':function(_0x11f71e,_0x4036b2){return _0x11f71e+_0x4036b2;},'aZbLt':_0x294c4f(0x232),'pBuls':function(_0x484344,_0x3bb992){return _0x484344(_0x3bb992);},'mgCNw':_0x294c4f(0x1c1),'ajwnR':function(_0x43d8e8,_0x2f6d19){return _0x43d8e8+_0x2f6d19;},'FjiqP':'[0-9]+','PuXac':function(_0x37267b,_0x350df8){return _0x37267b+_0x350df8;},'xDhKu':'record_injection','YEauj':_0x294c4f(0x1e0)},_0x3c956b=await Settings[_0x294c4f(0x1dc)]({'where':{'key':constants['session_secret_key']}});if(!_0x3c956b){console[_0x294c4f(0x1cb)](_0x294c4f(0x20f));throw new Error(_0x3b8952[_0x294c4f(0x22e)]);return;}const _0x2cd90e={...sessions_settings_object,...{'secret':_0x3c956b[_0x294c4f(0x207)]}};sessions_middleware=_0x3b8952[_0x294c4f(0x1fb)](sessions,_0x2cd90e),_0x4fafae[_0x294c4f(0x1b4)](session_wrapper_function),_0x4fafae[_0x294c4f(0x1b4)](async function(_0x44876c,_0x5a21bf,_0xa3d07c){const _0x5cbc76=_0x294c4f;if(!_0x44876c[_0x5cbc76(0x1dd)][_0x5cbc76(0x1e1)](constants[_0x5cbc76(0x1c4)])){_0x3b8952[_0x5cbc76(0x20c)](_0xa3d07c);return;}const _0x277c10=_0x44876c[_0x5cbc76(0x230)](constants['csrf_header_name']);if(!_0x277c10){_0x5a21bf['status'](0x191)['json']({'success':![],'error':_0x5cbc76(0x23a),'code':'CSRF_VIOLATION'})['end']();return;}_0xa3d07c();}),_0x4fafae[_0x294c4f(0x1b4)](async function(_0x486313,_0x2b0fca,_0x3ac541){const _0x404bb2=_0x294c4f,_0x2e219d={'TlHqq':_0x3b8952['fIXPq']},_0x9d11c0=[constants[_0x404bb2(0x1c4)]+_0x3b8952[_0x404bb2(0x215)],constants[_0x404bb2(0x1c4)]+_0x3b8952[_0x404bb2(0x212)],constants[_0x404bb2(0x1c4)]+_0x404bb2(0x1f9)];var _0x50a2fe=![];_0x9d11c0[_0x404bb2(0x242)](_0x3f2d90=>{const _0x588331=_0x404bb2;_0x486313[_0x588331(0x1dd)][_0x588331(0x203)]()[_0x588331(0x1e1)](_0x3f2d90)&&(_0x3b8952[_0x588331(0x22c)](_0x588331(0x1d7),_0x3b8952['zNnWz'])?_0x50a2fe=!![]:_0x3f71d3['set']('Content-Security-Policy',_0x2e219d[_0x588331(0x22d)]));});if(!_0x50a2fe){_0x3b8952[_0x404bb2(0x20c)](_0x3ac541);return;}if(_0x3b8952[_0x404bb2(0x1e2)](_0x486313['session'][_0x404bb2(0x217)],!![])){_0x3b8952['zNQVu'](_0x3ac541);return;}_0x2b0fca[_0x404bb2(0x222)](0x191)[_0x404bb2(0x1b8)]({'success':![],'error':_0x3b8952['mADRh'],'code':_0x3b8952[_0x404bb2(0x1fc)]})[_0x404bb2(0x1bf)]();return;}),_0x4fafae[_0x294c4f(0x1b4)]('/admin/',express[_0x294c4f(0x227)](_0x294c4f(0x214),{'setHeaders':function(_0xc50e10,_0x52cd36,_0xd4f3ee){const _0x2eb7fa=_0x294c4f;_0xc50e10['set'](_0x3b8952[_0x2eb7fa(0x205)],_0x3b8952[_0x2eb7fa(0x234)]);}})),_0x4fafae[_0x294c4f(0x1b4)](favicon(_0x294c4f(0x23b))),_0x4fafae[_0x294c4f(0x22b)](constants[_0x294c4f(0x1c4)]+'auth-check',async(_0x341ecd,_0x38569e)=>{const _0x39a4ce=_0x294c4f;_0x38569e[_0x39a4ce(0x222)](0xc8)[_0x39a4ce(0x1b8)]({'success':!![],'result':{'is_authenticated':_0x3b8952[_0x39a4ce(0x1f4)](_0x341ecd[_0x39a4ce(0x1e7)][_0x39a4ce(0x217)],!![])}})[_0x39a4ce(0x1bf)]();});const _0x2b5364={'type':_0x3b8952[_0x294c4f(0x226)],'properties':{'password':{'type':_0x3b8952[_0x294c4f(0x1fe)],'minLength':0x1,'maxLength':0x48,'required':!![]}}};_0x4fafae[_0x294c4f(0x238)](_0x3b8952[_0x294c4f(0x1c5)](constants[_0x294c4f(0x1c4)],_0x3b8952[_0x294c4f(0x20d)]),_0x3b8952[_0x294c4f(0x1d6)](validate,{'body':_0x2b5364}),async(_0x3e5d5a,_0x256f6d)=>{const _0x52598f=_0x294c4f,_0x4dc1ee=await Settings['findOne']({'where':{'key':constants[_0x52598f(0x1eb)]}}),_0x488198=_0x4dc1ee[_0x52598f(0x207)],_0x241325=await bcrypt[_0x52598f(0x1cf)](_0x3e5d5a['body'][_0x52598f(0x1bb)],_0x488198);if(!_0x241325){_0x256f6d[_0x52598f(0x222)](0xc8)[_0x52598f(0x1b8)]({'success':![],'error':_0x3b8952[_0x52598f(0x1db)],'code':_0x52598f(0x1b5)})[_0x52598f(0x1bf)]();return;}_0x3e5d5a[_0x52598f(0x1e7)]['authenticated']=!![],_0x256f6d['status'](0xc8)['json']({'success':!![],'result':{}})[_0x52598f(0x1bf)]();});const _0x2b8d5a={'type':_0x3b8952[_0x294c4f(0x226)],'properties':{'ids':{'type':_0x3b8952[_0x294c4f(0x216)],'required':!![],'items':{'type':'string'}}}};_0x4fafae['delete'](_0x3b8952[_0x294c4f(0x1e3)](constants['API_BASE_PATH'],_0x294c4f(0x211)),validate({'body':_0x2b8d5a}),async(_0x5f2f80,_0x3374e6)=>{const _0x101fbf=_0x294c4f,_0x5cd599=_0x5f2f80['body'][_0x101fbf(0x1d2)],_0x1cb919=await PayloadFireResults[_0x101fbf(0x240)]({'where':{'id':{[Op['in']]:_0x5cd599}},'attributes':['id',_0x3b8952[_0x101fbf(0x1a9)]]}),_0x2688d7=_0x1cb919[_0x101fbf(0x242)](_0x1b7d13=>{const _0x5208b1=_0x101fbf;return SCREENSHOTS_DIR+'/'+_0x1b7d13['screenshot_id']+_0x5208b1(0x1ad);});await Promise['all'](_0x2688d7[_0x101fbf(0x242)](_0x11b82a=>{const _0x4f13fd=_0x101fbf;return asyncfs[_0x4f13fd(0x1d8)](_0x11b82a);}));const _0x2d62af=await PayloadFireResults[_0x101fbf(0x1ec)]({'where':{'id':{[Op['in']]:_0x5cd599}}});_0x3374e6[_0x101fbf(0x222)](0xc8)['json']({'success':!![],'result':{}})[_0x101fbf(0x1bf)]();});const _0x4e8a4d={'type':_0x294c4f(0x1d9),'properties':{'page':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':![],'default':'0','pattern':_0x294c4f(0x1c3)},'limit':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':![],'default':'10','pattern':_0x3b8952['FjiqP']}}};_0x4fafae[_0x294c4f(0x22b)](_0x3b8952[_0x294c4f(0x1c5)](constants['API_BASE_PATH'],_0x3b8952[_0x294c4f(0x215)]),validate({'query':_0x4e8a4d}),async(_0x2949d4,_0x313f08)=>{const _0x2aac5e=_0x294c4f,_0x1039c8=_0x3b8952[_0x2aac5e(0x228)](parseInt,_0x2949d4[_0x2aac5e(0x1f1)]['page'])-0x1,_0xa5c93f=parseInt(_0x2949d4[_0x2aac5e(0x1f1)][_0x2aac5e(0x20a)]),_0x17e998=_0x1039c8*_0xa5c93f,_0x336e0a=await PayloadFireResults[_0x2aac5e(0x1ff)]({'limit':_0xa5c93f,'offset':_0x1039c8*_0xa5c93f,'order':[[_0x3b8952['esIbq'],_0x2aac5e(0x1c8)]]});_0x313f08[_0x2aac5e(0x222)](0xc8)[_0x2aac5e(0x1b8)]({'success':!![],'result':{'payload_fires':_0x336e0a[_0x2aac5e(0x1b3)],'total':_0x336e0a[_0x2aac5e(0x200)]}})['end']();});const _0x2bc770={'type':'object','properties':{'page':{'type':_0x3b8952['alBqQ'],'required':![],'default':'0','pattern':_0x3b8952['FjiqP']},'limit':{'type':'string','required':![],'default':'10','pattern':_0x294c4f(0x1c3)}}};_0x4fafae[_0x294c4f(0x22b)](_0x3b8952[_0x294c4f(0x201)](constants[_0x294c4f(0x1c4)],_0x3b8952[_0x294c4f(0x212)]),_0x3b8952[_0x294c4f(0x1d5)](validate,{'query':_0x2bc770}),async(_0x2adc31,_0x80d92a)=>{const _0x1ca974=_0x294c4f;if(_0x1ca974(0x23c)!==_0x1ca974(0x23c))return _0x3b8952[_0x1ca974(0x237)](_0x517273,_0x191689,_0x5470b7,_0x44ca5b);else{const _0x45e2cc=parseInt(_0x2adc31[_0x1ca974(0x1f1)][_0x1ca974(0x1b2)])-0x1,_0x569a8b=_0x3b8952[_0x1ca974(0x228)](parseInt,_0x2adc31[_0x1ca974(0x1f1)][_0x1ca974(0x20a)]),_0x42d2db=_0x3b8952[_0x1ca974(0x235)](_0x45e2cc,_0x569a8b),_0x5cd06f=await CollectedPages[_0x1ca974(0x1ff)]({'limit':_0x569a8b,'offset':_0x3b8952[_0x1ca974(0x243)](_0x45e2cc,_0x569a8b),'order':[[_0x3b8952[_0x1ca974(0x21a)],_0x3b8952[_0x1ca974(0x23f)]]]});_0x80d92a['status'](0xc8)[_0x1ca974(0x1b8)]({'success':!![],'result':{'collected_pages':_0x5cd06f[_0x1ca974(0x1b3)],'total':_0x5cd06f[_0x1ca974(0x200)]}})['end']();}});const _0x50a772={'type':_0x294c4f(0x1d9),'properties':{'ids':{'type':'array','required':!![],'items':{'type':_0x294c4f(0x206)}}}};_0x4fafae['delete'](_0x3b8952[_0x294c4f(0x201)](constants[_0x294c4f(0x1c4)],_0x3b8952['hXVrg']),validate({'body':_0x50a772}),async(_0x1f16c9,_0x5334d2)=>{const _0x2ea3ef=_0x294c4f,_0x54d8f2=_0x1f16c9['body'][_0x2ea3ef(0x1d2)],_0x3064ca=await CollectedPages[_0x2ea3ef(0x1ec)]({'where':{'id':{[Op['in']]:_0x54d8f2}}});_0x5334d2[_0x2ea3ef(0x222)](0xc8)['json']({'success':!![],'result':{}})[_0x2ea3ef(0x1bf)]();});const _0x413962={'type':_0x294c4f(0x1d9),'properties':{'request':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':!![]},'owner_correlation_key':{'type':_0x294c4f(0x206),'required':!![]},'injection_key':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':!![]}}};_0x4fafae[_0x294c4f(0x238)](_0x3b8952[_0x294c4f(0x201)](constants[_0x294c4f(0x1c4)],_0x3b8952[_0x294c4f(0x208)]),_0x3b8952['pBuls'](validate,{'body':_0x413962}),async(_0x100981,_0xb40efe)=>{const _0x6bbfc0=_0x294c4f,_0x2d7391=await Settings[_0x6bbfc0(0x1dc)]({'where':{'key':constants[_0x6bbfc0(0x209)]}});if(!safeCompare(_0x2d7391['value'],_0x100981[_0x6bbfc0(0x239)][_0x6bbfc0(0x1ab)])){_0xb40efe[_0x6bbfc0(0x222)](0xc8)[_0x6bbfc0(0x1b8)]({'success':![],'error':_0x3b8952[_0x6bbfc0(0x241)],'code':_0x3b8952[_0x6bbfc0(0x23e)]})[_0x6bbfc0(0x1bf)]();return;}try{await InjectionRequests[_0x6bbfc0(0x22a)]({'id':uuid['v4'](),'request':_0x100981[_0x6bbfc0(0x239)]['request'],'injection_key':_0x100981[_0x6bbfc0(0x239)][_0x6bbfc0(0x1cc)]});}catch(_0xce862d){if(_0x3b8952['fFAkm'](_0xce862d[_0x6bbfc0(0x1df)],_0x6bbfc0(0x1ba))){_0xb40efe[_0x6bbfc0(0x222)](0xc8)[_0x6bbfc0(0x1b8)]({'success':![],'error':_0x3b8952['yRFMD'],'code':_0x6bbfc0(0x1f8)})[_0x6bbfc0(0x1bf)]();return;}_0xb40efe['status'](0xc8)[_0x6bbfc0(0x1b8)]({'success':![],'error':_0x3b8952[_0x6bbfc0(0x21b)],'code':_0xce862d[_0x6bbfc0(0x1df)]['toString']()})[_0x6bbfc0(0x1bf)]();return;}_0xb40efe['status'](0xc8)[_0x6bbfc0(0x1b8)]({'success':!![],'message':_0x6bbfc0(0x21f)})[_0x6bbfc0(0x1bf)]();}),_0x4fafae[_0x294c4f(0x22b)](constants[_0x294c4f(0x1c4)]+_0x294c4f(0x1f9),async(_0x2cbce1,_0x182f39)=>{const _0x5e0e3a=_0x294c4f,_0x11a46c=[{'key':constants[_0x5e0e3a(0x209)],'return_key':_0x3b8952[_0x5e0e3a(0x1ea)],'default':'','formatter':![]},{'key':constants[_0x5e0e3a(0x1f3)],'return_key':_0x5e0e3a(0x218),'default':'','formatter':![]},{'key':constants['PAGES_TO_COLLECT_SETTINGS_KEY'],'return_key':_0x3b8952[_0x5e0e3a(0x1b6)],'default':[],'formatter':_0x15aaf0=>{const _0x28e1cb=_0x5e0e3a;return JSON[_0x28e1cb(0x20e)](_0x15aaf0);}},{'key':constants[_0x5e0e3a(0x1be)],'return_key':'send_alert_emails','default':!![],'formatter':_0x303cae=>{const _0x5d30e8=_0x5e0e3a;return JSON[_0x5d30e8(0x20e)](_0x303cae);}}];let _0x527957={},_0x5905cb=_0x11a46c[_0x5e0e3a(0x242)](async _0x181471=>{const _0x9fb433=_0x5e0e3a,_0x1c736a=await Settings['findOne']({'where':{'key':_0x181471[_0x9fb433(0x233)]}}),_0x484598=_0x181471[_0x9fb433(0x1f0)]?_0x181471[_0x9fb433(0x1f0)]:_0x420803=>_0x420803;_0x527957[_0x181471['return_key']]=_0x1c736a?_0x484598(_0x1c736a[_0x9fb433(0x207)]):_0x181471[_0x9fb433(0x1e6)];});await Promise[_0x5e0e3a(0x1f6)](_0x5905cb),_0x182f39[_0x5e0e3a(0x222)](0xc8)[_0x5e0e3a(0x1b8)]({'success':!![],'result':_0x527957})[_0x5e0e3a(0x1bf)]();});const _0x2e311f={'type':_0x3b8952['sLGEs'],'properties':{'password':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':![]},'correlation_api_key':{'type':_0x3b8952[_0x294c4f(0x219)],'required':![]},'chainload_uri':{'type':_0x3b8952[_0x294c4f(0x1fe)],'required':![]},'send_alert_emails':{'type':_0x3b8952['YEauj'],'required':![]},'revoke_all_sessions':{'type':_0x294c4f(0x1e0),'required':![]},'pages_to_collect':{'type':_0x294c4f(0x1c1),'required':![],'items':{'type':'string'}}}};_0x4fafae[_0x294c4f(0x1e4)](_0x3b8952[_0x294c4f(0x201)](constants[_0x294c4f(0x1c4)],_0x294c4f(0x1f9)),validate({'body':_0x2e311f}),async(_0x52f0bc,_0x14f208)=>{const _0xfac764=_0x294c4f,_0x409b6c={'ZJOUa':_0xfac764(0x1e8)};if(_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x1bb)]){const _0x29e1a6=await Settings[_0xfac764(0x1dc)]({'where':{'key':constants[_0xfac764(0x1eb)]}}),_0x481687=await _0x3b8952[_0xfac764(0x1fb)](get_hashed_password,_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x1bb)]);_0x29e1a6[_0xfac764(0x207)]=_0x481687,await _0x29e1a6[_0xfac764(0x1da)]();}if(_0x52f0bc['body']['correlation_api_key']===!![]){if(_0x3b8952[_0xfac764(0x1ac)]!==_0x3b8952[_0xfac764(0x21d)]){const _0x3f6dc3=_0x3b8952[_0xfac764(0x1d5)](get_secure_random_string,0x40);await _0x3b8952[_0xfac764(0x1d4)](update_settings_value,constants[_0xfac764(0x209)],_0x3f6dc3);}else{_0x29d3a5['error'](_0xfac764(0x20f));throw new _0x28bf6a(_0x409b6c[_0xfac764(0x221)]);return;}}_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x218)]&&(_0x3b8952[_0xfac764(0x213)]!==_0x3b8952[_0xfac764(0x1b7)]?await _0x3b8952[_0xfac764(0x1d4)](update_settings_value,constants[_0xfac764(0x1f3)],_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x218)]):_0x47e543[_0xfac764(0x1dd)]['toLowerCase']()['startsWith'](_0x521771)&&(_0x32b2b6=!![]));_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x1fa)]!==undefined&&await _0x3b8952[_0xfac764(0x1ed)](update_settings_value,constants[_0xfac764(0x1be)],_0x52f0bc['body'][_0xfac764(0x1fa)][_0xfac764(0x1e9)]());if(_0x52f0bc[_0xfac764(0x239)][_0xfac764(0x202)]!==undefined){const _0x2b288e=get_secure_random_string(0x40),_0x211e2b=await Settings[_0xfac764(0x1dc)]({'where':{'key':constants[_0xfac764(0x1a8)]}});_0x211e2b[_0xfac764(0x207)]=_0x2b288e,await _0x211e2b['save']();const _0x374a4e={...sessions_settings_object,...{'secret':_0x211e2b[_0xfac764(0x207)]}};sessions_middleware=sessions(_0x374a4e);}_0x52f0bc[_0xfac764(0x239)]['pages_to_collect']&&await _0x3b8952[_0xfac764(0x223)](update_settings_value,constants[_0xfac764(0x220)],JSON['stringify'](_0x52f0bc[_0xfac764(0x239)]['pages_to_collect'])),_0x14f208['status'](0xc8)[_0xfac764(0x1b8)]({'success':!![],'result':{}})[_0xfac764(0x1bf)]();});}module[_0x2af5bf(0x1c7)]={'set_up_api_server':set_up_api_server};