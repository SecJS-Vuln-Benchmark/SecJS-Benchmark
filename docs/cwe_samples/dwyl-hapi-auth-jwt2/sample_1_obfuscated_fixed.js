const _0x179d15=_0x18f2;(function(_0x2a3c58,_0x19e7a1){const _0x2a95c8=_0x18f2,_0x200ab7=_0x2a3c58();while(!![]){try{const _0x3006f5=-parseInt(_0x2a95c8(0x153))/0x1*(-parseInt(_0x2a95c8(0x15b))/0x2)+parseInt(_0x2a95c8(0x14e))/0x3+-parseInt(_0x2a95c8(0x160))/0x4+parseInt(_0x2a95c8(0x150))/0x5+parseInt(_0x2a95c8(0x16a))/0x6*(-parseInt(_0x2a95c8(0x14b))/0x7)+-parseInt(_0x2a95c8(0x131))/0x8*(parseInt(_0x2a95c8(0x163))/0x9)+parseInt(_0x2a95c8(0x156))/0xa;if(_0x3006f5===_0x19e7a1)break;else _0x200ab7['push'](_0x200ab7['shift']());}catch(_0x5e6947){_0x200ab7['push'](_0x200ab7['shift']());}}}(_0x2991,0x93745));import{tmpdir}from'os';import{dirname,join,resolve,sep}from'path';function _0x18f2(_0x3e8fd9,_0x44870c){const _0x2991a9=_0x2991();return _0x18f2=function(_0x18f2ac,_0x324edf){_0x18f2ac=_0x18f2ac-0x12a;let _0x4288ae=_0x2991a9[_0x18f2ac];return _0x4288ae;},_0x18f2(_0x3e8fd9,_0x44870c);}import{realpathSync}from'fs';function _0x2991(){const _0xfd13bc=['isDockerRunner','resolve','2746290eouRJy','environment','1096640TvCKoh','LWgPx','_startIdleTimer','929226HSOiDb','IDLE','oOjcA','5888490XPLIzU','map','_stopExecutionTimer','files','/var/task','2hTiwwF','setEvent','memorySize','now','status','2501468dNXEAP','endsWith','loadAsync','520479kpuWLg','region','en_US.UTF-8','zoWso','_initialize','\x20ms','\x20ms\x20\x20Billed\x20Duration:\x20','179106KMFSeT','IaVmo','iODDL','/usr/local/lib64/node-v4.3.x/lib:/lib64:/usr/lib64:/var/runtime:/var/runtime/lib:/var/task:/var/task/lib','timeout','2016/12/02/[$LATEST]f77ff5e4026c45bda9a9ebcec6bc9cad','cleanup','LEbWo','_getEnv','/aws/lambda/','_verifySupportedRuntime','SXzhm','all','Warning:\x20found\x20unsupported\x20runtime\x20\x27','VuqOU','runtime','LsFdy','/var/runtime','40zVaQId','location','runHandler','setRequestId','ldDzs','$LATEST','run','create','_startExecutionTimer','/var/runtime:/var/task:/var/runtime/node_modules','async','artifact','\x27\x20for\x20function\x20\x27','NNTld','DjvuA','_getAwsEnvVars',')\x20RequestId:\x20','VpJop','package','log','code','BmMMJ','idleTimeInMinutes','_extractArtifact','SIgzV','_billedExecutionTimeInMillis','266HVtPZs'];_0x2991=function(){return _0xfd13bc;};return _0x2991();}import{emptyDir,ensureDir,readFile,remove,writeFile}from'fs-extra';import{performance}from'perf_hooks';import _0x23c673 from'jszip';import _0x31f2ee from'./handler-runner/index.js';import _0xa6c762 from'./LambdaContext.js';import _0xfa629f from'../serverlessLog.js';import _0x29be4d from'../utils/resolveJoins.js';import{DEFAULT_LAMBDA_MEMORY_SIZE,DEFAULT_LAMBDA_RUNTIME,DEFAULT_LAMBDA_TIMEOUT,supportedRuntimes}from'../config/index.js';import{createUniqueId,splitHandlerPathAndName}from'../utils/index.js';const {keys}=Object,{ceil}=Math;export default class LambdaFunction{#artifact=null;#clientContext=null;#codeDir=null;#event=null;#executionTimeEnded=null;#executionTimeStarted=null;#functionKey=null;#functionName=null;#handlerRunner=null;#idleTimeStarted=null;#initialized=![];#lambdaContext=null;#lambdaDir=null;#memorySize=null;#region=null;#runtime=null;#timeout=null;[_0x179d15(0x15f)]=_0x179d15(0x154);constructor(_0x1a8b62,_0x4d6e44,_0x610780,_0x2d0b9e){const _0xcfcd0b=_0x179d15,_0x2a5462={'NNTld':function(_0x225535,_0xe11cb5,_0x1151a5,_0x1c57cc,_0xccd373,_0x465219,_0x1c0e86){return _0x225535(_0xe11cb5,_0x1151a5,_0x1c57cc,_0xccd373,_0x465219,_0x1c0e86);},'VuqOU':'services','RBJvI':function(_0x205f4e){return _0x205f4e();},'ldDzs':_0xcfcd0b(0x145),'VpJop':function(_0x50f699,_0x47e2d0,_0x5a28ad){return _0x50f699(_0x47e2d0,_0x5a28ad);}},{service:_0x168dc1,config:{serverlessPath:_0x228566,servicePath:_0x3e1e04},service:{provider:_0x7a1494,package:_0x582d7a={}}}=_0x610780,_0x449c29=resolve(_0x3e1e04,_0x2d0b9e[_0xcfcd0b(0x132)]||''),{handler:_0xbc74a7,name:_0x4498eb,package:_0x3cb040={}}=_0x4d6e44,[_0x3554a8,_0x39656a]=splitHandlerPathAndName(_0xbc74a7),_0x35d7e7=_0x4d6e44[_0xcfcd0b(0x15d)]||_0x7a1494['memorySize']||DEFAULT_LAMBDA_MEMORY_SIZE,_0x125f39=_0x4d6e44[_0xcfcd0b(0x12e)]||_0x7a1494[_0xcfcd0b(0x12e)]||DEFAULT_LAMBDA_RUNTIME,_0x58f42c=(_0x4d6e44[_0xcfcd0b(0x16e)]||_0x7a1494[_0xcfcd0b(0x16e)]||DEFAULT_LAMBDA_TIMEOUT)*0x3e8;this.#functionKey=_0x1a8b62,this.#functionName=_0x4498eb,this.#memorySize=_0x35d7e7,this.#region=_0x7a1494[_0xcfcd0b(0x164)],this.#runtime=_0x125f39,this.#timeout=_0x58f42c,this['_verifySupportedRuntime']();const _0x75b291=this[_0xcfcd0b(0x172)](_0x29be4d(_0x7a1494[_0xcfcd0b(0x14f)]),_0x4d6e44[_0xcfcd0b(0x14f)],_0xbc74a7);this.#artifact=_0x4d6e44['package']?.[_0xcfcd0b(0x13c)];!this.#artifact&&(this.#artifact=_0x168dc1[_0xcfcd0b(0x143)]?.[_0xcfcd0b(0x13c)]);this.#artifact&&(this.#lambdaDir=_0x2a5462[_0xcfcd0b(0x13e)](join,realpathSync(tmpdir()),'serverless-offline',_0x2a5462[_0xcfcd0b(0x12d)],_0x168dc1['service'],_0x1a8b62,_0x2a5462['RBJvI'](createUniqueId)));this.#codeDir=this.#lambdaDir?resolve(this.#lambdaDir,_0x2a5462[_0xcfcd0b(0x135)]):_0x449c29;const _0x4398c9={'functionKey':_0x1a8b62,'handler':_0xbc74a7,'handlerName':_0x39656a,'codeDir':this.#codeDir,'handlerPath':_0x2a5462[_0xcfcd0b(0x142)](resolve,this.#codeDir,_0x3554a8),'runtime':_0x125f39,'serverlessPath':_0x228566,'servicePath':_0x449c29,'timeout':_0x58f42c,'layers':_0x4d6e44['layers']||[],'provider':_0x7a1494,'functionName':_0x4498eb,'servicePackage':_0x582d7a[_0xcfcd0b(0x13c)]?_0x2a5462[_0xcfcd0b(0x142)](resolve,_0x449c29,_0x582d7a['artifact']):undefined,'functionPackage':_0x3cb040[_0xcfcd0b(0x13c)]?resolve(_0x449c29,_0x3cb040['artifact']):undefined};this.#handlerRunner=new _0x31f2ee(_0x4398c9,_0x2d0b9e,_0x75b291),this.#lambdaContext=new _0xa6c762(_0x4498eb,_0x35d7e7);}[_0x179d15(0x139)](){this.#executionTimeStarted=performance['now']();}[_0x179d15(0x158)](){const _0x12178e=_0x179d15;this.#executionTimeEnded=performance[_0x12178e(0x15e)]();}[_0x179d15(0x152)](){this.#idleTimeStarted=performance['now']();}[_0x179d15(0x174)](){const _0x219ef1=_0x179d15;!supportedRuntimes['has'](this.#runtime)&&(console[_0x219ef1(0x144)](''),_0xfa629f(_0x219ef1(0x12c)+this.#runtime+_0x219ef1(0x13d)+this.#functionKey+'\x27'));}[_0x179d15(0x140)](){const _0x5082f5=_0x179d15,_0x4299aa={'LsFdy':_0x5082f5(0x130),'iODDL':_0x5082f5(0x16d),'LEbWo':_0x5082f5(0x13a)};return{'AWS_DEFAULT_REGION':this.#region,'AWS_LAMBDA_FUNCTION_MEMORY_SIZE':this.#memorySize,'AWS_LAMBDA_FUNCTION_NAME':this.#functionName,'AWS_LAMBDA_FUNCTION_VERSION':_0x5082f5(0x136),'AWS_LAMBDA_LOG_GROUP_NAME':_0x5082f5(0x173)+this.#functionName,'AWS_LAMBDA_LOG_STREAM_NAME':_0x5082f5(0x16f),'AWS_REGION':this.#region,'LAMBDA_RUNTIME_DIR':_0x4299aa[_0x5082f5(0x12f)],'LAMBDA_TASK_ROOT':_0x5082f5(0x15a),'LANG':_0x5082f5(0x165),'LD_LIBRARY_PATH':_0x4299aa[_0x5082f5(0x16c)],'NODE_PATH':_0x4299aa[_0x5082f5(0x171)]};}[_0x179d15(0x172)](_0xcf0e2b,_0x1d98f9,_0x229ee1){const _0x3fc13b=_0x179d15;return{...this[_0x3fc13b(0x140)](),..._0xcf0e2b,..._0x1d98f9,'_HANDLER':_0x229ee1,'IS_OFFLINE':!![]};}['setClientContext'](_0x30b8e4){this.#clientContext=_0x30b8e4;}[_0x179d15(0x15c)](_0x3c4d20){this.#event=_0x3c4d20;}async[_0x179d15(0x170)](){const _0x2423bc=_0x179d15,_0x18f435={'IaVmo':function(_0x3ccf1c,_0x2c501f){return _0x3ccf1c(_0x2c501f);}};await this.#handlerRunner['cleanup'](),this.#lambdaDir&&await _0x18f435[_0x2423bc(0x16b)](remove,this.#lambdaDir);}['_executionTimeInMillis'](){return this.#executionTimeEnded-this.#executionTimeStarted;}['_billedExecutionTimeInMillis'](){const _0x5c66eb=_0x179d15,_0xbb7eef={'DjvuA':function(_0x4f44ba,_0x5172d0){return _0x4f44ba*_0x5172d0;}};return _0xbb7eef[_0x5c66eb(0x13f)](ceil((this.#executionTimeEnded-this.#executionTimeStarted)/0x64),0x64);}async['_extractArtifact'](){const _0x4cc2a7=_0x179d15,_0x527e1b={'LWgPx':'nodebuffer','BmMMJ':function(_0x5f2eea,_0x5d6ae4){return _0x5f2eea(_0x5d6ae4);},'SIgzV':function(_0x39798b,_0x1e2ad0,_0x39ac0e){return _0x39798b(_0x1e2ad0,_0x39ac0e);},'oOjcA':function(_0x256035,_0x1164e5,_0x5936d5,_0x308f53){return _0x256035(_0x1164e5,_0x5936d5,_0x308f53);},'GcvXF':function(_0x7c2912,_0x56a97f){return _0x7c2912(_0x56a97f);}};if(!this.#artifact)return null;_0x527e1b['BmMMJ'](emptyDir,this.#codeDir);const _0x42a3d9=await _0x527e1b['GcvXF'](readFile,this.#artifact),_0x54f0b7=await _0x23c673[_0x4cc2a7(0x162)](_0x42a3d9);return Promise[_0x4cc2a7(0x12b)](_0x527e1b['GcvXF'](keys,_0x54f0b7[_0x4cc2a7(0x159)])[_0x4cc2a7(0x157)](async _0x46738c=>{const _0x2fa5b8=_0x4cc2a7,_0x3feeee=await _0x54f0b7[_0x2fa5b8(0x159)][_0x46738c][_0x2fa5b8(0x13b)](_0x527e1b[_0x2fa5b8(0x151)]);if(_0x46738c[_0x2fa5b8(0x161)](sep))return Promise[_0x2fa5b8(0x14d)]();return await _0x527e1b[_0x2fa5b8(0x146)](ensureDir,_0x527e1b[_0x2fa5b8(0x149)](join,this.#codeDir,_0x527e1b[_0x2fa5b8(0x146)](dirname,_0x46738c))),_0x527e1b[_0x2fa5b8(0x155)](writeFile,join(this.#codeDir,_0x46738c),_0x3feeee,{'mode':_0x54f0b7['files'][_0x46738c]['unixPermissions']});}));}async[_0x179d15(0x167)](){const _0x3d8265=_0x179d15;await this[_0x3d8265(0x148)](),this.#initialized=!![];}get[_0x179d15(0x147)](){const _0x3e1169=_0x179d15,_0x45d4d7={'zoWso':function(_0x5ed89e,_0x2e4e9f){return _0x5ed89e/_0x2e4e9f;}};return _0x45d4d7[_0x3e1169(0x166)]((performance[_0x3e1169(0x15e)]()-this.#idleTimeStarted)/0x3e8,0x3c);}get['functionName'](){return this.#functionName;}async[_0x179d15(0x133)](){const _0xc05d37=_0x179d15,_0x36e4ba={'ejMaT':'BUSY','aYPMH':function(_0x33ff5d){return _0x33ff5d();},'SXzhm':function(_0x255b98,_0x463cee){return _0x255b98(_0x463cee);}};this[_0xc05d37(0x15f)]=_0x36e4ba['ejMaT'];!this.#initialized&&await this[_0xc05d37(0x167)]();const _0x25971a=_0x36e4ba['aYPMH'](createUniqueId);this.#lambdaContext[_0xc05d37(0x134)](_0x25971a),this.#lambdaContext['setClientContext'](this.#clientContext);const _0x24bed8=this.#lambdaContext[_0xc05d37(0x138)]();this[_0xc05d37(0x139)]();const _0x1c0022=await this.#handlerRunner[_0xc05d37(0x137)](this.#event,_0x24bed8);return this['_stopExecutionTimer'](),!this.#handlerRunner[_0xc05d37(0x14c)]()&&_0x36e4ba[_0xc05d37(0x12a)](_0xfa629f,'(Î»:\x20'+this.#functionKey+_0xc05d37(0x141)+_0x25971a+'\x20\x20Duration:\x20'+this['_executionTimeInMillis']()['toFixed'](0x2)+_0xc05d37(0x169)+this[_0xc05d37(0x14a)]()+_0xc05d37(0x168)),this[_0xc05d37(0x15f)]=_0xc05d37(0x154),this[_0xc05d37(0x152)](),_0x1c0022;}}