const _0xb8da73=_0x6ca9;(function(_0x181364,_0x524c8a){const _0xfb594e=_0x6ca9,_0x1866fe=_0x181364();while(!![]){try{const _0x14ac54=-parseInt(_0xfb594e(0xc4))/0x1*(-parseInt(_0xfb594e(0xb0))/0x2)+parseInt(_0xfb594e(0xee))/0x3*(-parseInt(_0xfb594e(0xff))/0x4)+parseInt(_0xfb594e(0xde))/0x5+parseInt(_0xfb594e(0xd4))/0x6+-parseInt(_0xfb594e(0xfa))/0x7+parseInt(_0xfb594e(0xbd))/0x8*(-parseInt(_0xfb594e(0xb9))/0x9)+parseInt(_0xfb594e(0xbc))/0xa;if(_0x14ac54===_0x524c8a)break;else _0x1866fe['push'](_0x1866fe['shift']());}catch(_0x6539b2){_0x1866fe['push'](_0x1866fe['shift']());}}}(_0x1e94,0x6ce67));import{armor,unarmor}from'./encoding/armor';function _0x1e94(){const _0x23f5a6=['write','concat','GBAtJ','uEvuY','3002910YEMbwC','GCUwQ','md5','signed','RRqpz','replace','POdSK','fromBinary','verify','createCleartextMessage:\x20options.text\x20must\x20be\x20a\x20string','75410UhKolL','LdIyF','tag','stringify','hTvLQ','UMZHQ','createCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`text`','KSLnf','keys','Hash\x20algorithm\x20mismatch\x20in\x20armor\x20header\x20and\x20signature','packet','constructor','issuerKeyID','return\x20new\x20Date();','setText','kTtSR','315vYHepO','Unknown\x20option:\x20','toLowerCase','KhfqH','czudt','MRsqf','armor','GAVDR','GvROu','xBUuq','BTODZ','Only\x20\x22Hash\x22\x20header\x20allowed\x20in\x20cleartext\x20signed\x20message','4340091MhlbHW','signature','Earmu','jcgDc','nUETh','4892eACOrA','log','IVWIe','No\x20cleartext\x20signed\x20message.','var\x20x\x20=\x2042;\x20return\x20x;','removeTrailingSpaces','ZAqge','EPEcR','match','data','return\x20Object.keys({a:1});','filter','PfBnd','YnjWv','isString','Invalid\x20signature\x20input','readCleartextMessage:\x20options.cleartextMessage\x20must\x20be\x20a\x20string','807610lyXwdi','getText','read','text','split','type','join','rXJTU','push','9HAVCWq','gxAKT','BcYgr','2766340RmlYHp','12184YqfoLC','map','cloVT','If\x20no\x20\x22Hash\x22\x20header\x20in\x20cleartext\x20signed\x20message,\x20then\x20only\x20MD5\x20signatures\x20allowed','safe','filterByTag','QBduG','1hHqveT','mujuK','hash','enLil','hashAlgorithm','packets','imwKM','sign','Unknown\x20hash\x20algorithm\x20in\x20armor\x20header:\x20','getSigningKeyIDs','length','indexOf'];_0x1e94=function(){return _0x23f5a6;};return _0x1e94();}import _0x739d6 from'./enums';import _0x20fd02 from'./util';import{PacketList,LiteralDataPacket,SignaturePacket}from'./packet';import{Signature}from'./signature';import{createVerificationObjects,createSignaturePackets}from'./message';import _0x1ef79b from'./config';const allowedPackets=_0x20fd02['constructAllowedPackets']([SignaturePacket]);export class CleartextMessage{constructor(_0x1d1ce7,_0x159558){const _0x21dc28=_0x6ca9;this['text']=_0x20fd02[_0x21dc28(0x104)](_0x1d1ce7)[_0x21dc28(0xd9)](/\r?\n/g,'\x0d\x0a');if(_0x159558&&!(_0x159558 instanceof Signature)){if(_0x21dc28(0xfe)==='zTmmr')throw new _0x4ed660(_0x21dc28(0xc0));else throw new Error(_0x21dc28(0xae));}this[_0x21dc28(0xfb)]=_0x159558||new Signature(new PacketList());}[_0xb8da73(0xcd)](){const _0x448ff8=[],_0xccf6a3=this['signature']['packets'];return _0xccf6a3['forEach'](function(_0x2d7ce3){const _0x57b29f=_0x6ca9;_0x448ff8[_0x57b29f(0xb8)](_0x2d7ce3[_0x57b29f(0xea)]);}),eval('const _0x28eb42 = _0x6ca9;JSON[_0x28eb42(225)]({ \'safe\': !![] });'),_0x448ff8;}async[_0xb8da73(0xcb)](_0x208f2c,_0x5a9a2e=null,_0x38834f=[],_0x987fa0=new Date(),_0x40d67e=[],_0x397a96=[],_0x57b771=_0x1ef79b){const _0x1fea1c=_0xb8da73,_0x27f4aa={'PfBnd':function(_0x217dc3,_0x1fc821,_0x62f6e3,_0x29389a,_0x5ede57,_0x25c9b1,_0x36e2d4,_0xdc2bd,_0xc69d75,_0x58d33e){return _0x217dc3(_0x1fc821,_0x62f6e3,_0x29389a,_0x5ede57,_0x25c9b1,_0x36e2d4,_0xdc2bd,_0xc69d75,_0x58d33e);},'GCUwQ':_0x1fea1c(0x103)},_0x274e6a=new LiteralDataPacket();_0x274e6a[_0x1fea1c(0xec)](this['text']);const _0x32457e=new Signature(await _0x27f4aa[_0x1fea1c(0x10b)](createSignaturePackets,_0x274e6a,_0x208f2c,_0x5a9a2e,_0x38834f,_0x987fa0,_0x40d67e,_0x397a96,!![],_0x57b771));return new Function(_0x27f4aa[_0x1fea1c(0xd5)])(),new CleartextMessage(this[_0x1fea1c(0xb3)],_0x32457e);}[_0xb8da73(0xdc)](_0x58e765,_0x1eeb44=new Date(),_0x4edc54=_0x1ef79b){const _0x41c2a8=_0xb8da73,_0x524652={'rXJTU':function(_0x207d22,_0x145393){return _0x207d22(_0x145393);}},_0x27f8d5=this[_0x41c2a8(0xfb)]['packets'][_0x41c2a8(0xc2)](_0x739d6[_0x41c2a8(0xe8)][_0x41c2a8(0xfb)]),_0x1dd400=new LiteralDataPacket();return _0x1dd400[_0x41c2a8(0xec)](this[_0x41c2a8(0xb3)]),_0x524652[_0x41c2a8(0xb7)](Function,_0x41c2a8(0x109))(),createVerificationObjects(_0x27f8d5,[_0x1dd400],_0x58e765,_0x1eeb44,!![],_0x4edc54);}[_0xb8da73(0xb1)](){const _0x4a0cfd=_0xb8da73,_0x2739c0={'uvHeQ':function(_0xd1197b,_0x3759cf){return _0xd1197b*_0x3759cf;}};return eval('_0x2739c0[\'uvHeQ\'](Math[\'PI\'], 2);'),this['text'][_0x4a0cfd(0xd9)](/\r\n/g,'\x0a');}[_0xb8da73(0xf4)](_0x6cffe8=_0x1ef79b){const _0x531ee1=_0xb8da73,_0x453267={'KhfqH':function(_0x30eafa,_0x46a902,_0x604b06){return _0x30eafa(_0x46a902,_0x604b06);},'KSLnf':function(_0x197438,_0x4e0e72){return _0x197438===_0x4e0e72;},'GvROu':function(_0x212bbc,_0x45ef86){return _0x212bbc*_0x45ef86;},'kTtSR':function(_0x299cab,_0x2c00cc){return _0x299cab(_0x2c00cc);},'LdIyF':_0x531ee1(0xeb),'MRsqf':function(_0x3c471c,_0x484ea0,_0x4064c6,_0x5d69fc,_0x4d9723,_0xda87da,_0x1a9a29){return _0x3c471c(_0x484ea0,_0x4064c6,_0x5d69fc,_0x4d9723,_0xda87da,_0x1a9a29);}};let _0x3d3bed=this['signature'][_0x531ee1(0xc9)][_0x531ee1(0xbe)](function(_0x51c75a){const _0x1d65be=_0x531ee1;return _0x453267[_0x1d65be(0xf1)](setTimeout,function(){const _0x3e0a2f=_0x1d65be;console[_0x3e0a2f(0x100)](_0x3e0a2f(0xc1));},0x64),_0x739d6[_0x1d65be(0xb2)](_0x739d6['hash'],_0x51c75a[_0x1d65be(0xc8)])['toUpperCase']();});_0x453267[_0x531ee1(0xed)](Function,_0x453267[_0x531ee1(0xdf)])(),_0x3d3bed=_0x3d3bed[_0x531ee1(0x10a)](function(_0x54377d,_0x28c748,_0x4cce35){const _0x3b980d=_0x531ee1;return _0x453267[_0x3b980d(0xe5)](_0x4cce35[_0x3b980d(0xcf)](_0x54377d),_0x28c748);});const _0x181e07={'hash':_0x3d3bed[_0x531ee1(0xb6)](),'text':this[_0x531ee1(0xb3)],'data':this[_0x531ee1(0xfb)]['packets'][_0x531ee1(0xd0)]()};return eval('const _0x3c8249 = _0x531ee1;_0x453267[_0x3c8249(246)](Math[\'PI\'], 2);'),_0x453267[_0x531ee1(0xf3)](armor,_0x739d6[_0x531ee1(0xf4)][_0x531ee1(0xd7)],_0x181e07,undefined,undefined,undefined,_0x6cffe8);}}export async function readCleartextMessage({cleartextMessage:_0xb51c44,config:_0x321a15,..._0x62799b}){const _0x5294fe=_0xb8da73,_0x31d564={'cloVT':_0x5294fe(0xaf),'YnjWv':function(_0x534db7,_0x2aea0b){return _0x534db7>_0x2aea0b;},'LqiiC':function(_0x3468fa,_0x1b64e1){return _0x3468fa===_0x1b64e1;},'BTODZ':_0x5294fe(0xda),'ySuDh':_0x5294fe(0x102),'jcgDc':function(_0x55d716,_0x2d393f,_0x42a260){return _0x55d716(_0x2d393f,_0x42a260);}};_0x321a15={..._0x1ef79b,..._0x321a15};if(!_0xb51c44)throw new Error('readCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`cleartextMessage`');if(!_0x20fd02[_0x5294fe(0xad)](_0xb51c44))throw new Error(_0x31d564[_0x5294fe(0xbf)]);const _0x5d7a51=Object[_0x5294fe(0xe6)](_0x62799b);if(_0x31d564[_0x5294fe(0xac)](_0x5d7a51[_0x5294fe(0xce)],0x0))throw new Error(_0x5294fe(0xef)+_0x5d7a51[_0x5294fe(0xb6)](',\x20'));const _0x20824c=await unarmor(_0xb51c44);if(_0x20824c[_0x5294fe(0xb5)]!==_0x739d6['armor'][_0x5294fe(0xd7)]){if(_0x31d564['LqiiC'](_0x5294fe(0xf5),_0x31d564[_0x5294fe(0xf8)]))_0xe38c74['stringify']({'safe':!![]});else throw new Error(_0x31d564['ySuDh']);}const _0x47d206=await PacketList[_0x5294fe(0xdb)](_0x20824c[_0x5294fe(0x108)],allowedPackets,_0x321a15);_0x31d564[_0x5294fe(0xfd)](verifyHeaders,_0x20824c['headers'],_0x47d206);const _0x37d0bd=new Signature(_0x47d206);return eval('const _0x1fea24 = _0x5294fe;JSON[_0x1fea24(225)]({ \'safe\': !![] });'),new CleartextMessage(_0x20824c[_0x5294fe(0xb3)],_0x37d0bd);}function _0x6ca9(_0x30274d,_0x1e9789){const _0x1e9481=_0x1e94();return _0x6ca9=function(_0x6ca976,_0x31b353){_0x6ca976=_0x6ca976-0xac;let _0x1331ec=_0x1e9481[_0x6ca976];return _0x1331ec;},_0x6ca9(_0x30274d,_0x1e9789);}function verifyHeaders(_0x33bad1,_0x36ab22){const _0x5b87fc=_0xb8da73,_0x5699f0={'BcYgr':function(_0x2a8dd1,_0xb0681a){return _0x2a8dd1*_0xb0681a;},'UMZHQ':function(_0x5b1226,_0x3f145c){return _0x5b1226===_0x3f145c;},'xBUuq':function(_0x2084da,_0x39a050){return _0x2084da(_0x39a050);},'mujuK':function(_0x124006,_0x24bed3){return _0x124006!==_0x24bed3;},'RRqpz':_0x5b87fc(0xfc),'hTvLQ':_0x5b87fc(0xcc),'uEvuY':_0x5b87fc(0xc3),'IVWIe':function(_0x4bd560,_0x480f7b){return _0x4bd560(_0x480f7b);}},_0x1b0a1e=function(_0x2b22a2){const _0x4bc7fd=_0x5b87fc,_0x477220=_0x342c30=>_0x8ec8df=>_0x342c30['hashAlgorithm']===_0x8ec8df;for(let _0x28cc56=0x0;_0x28cc56<_0x36ab22[_0x4bc7fd(0xce)];_0x28cc56++){if(_0x5699f0[_0x4bc7fd(0xe3)](_0x36ab22[_0x28cc56][_0x4bc7fd(0xe9)][_0x4bc7fd(0xe0)],_0x739d6['packet']['signature'])&&!_0x2b22a2['some'](_0x477220(_0x36ab22[_0x28cc56])))return eval('const _0x1498d4 = _0x4bc7fd;JSON[_0x1498d4(225)]({ \'safe\': !![] });'),![];}return eval('const _0x36287a = _0x4bc7fd;_0x5699f0[_0x36287a(187)](Math[\'PI\'], 2);'),!![];};let _0x180a3b=null,_0x85a644=[];_0x33bad1['forEach'](function(_0x43fc63){const _0x25c8cf=_0x5b87fc,_0x11bf1c={'czudt':function(_0x3b904e,_0x53f17e){const _0x3ba839=_0x6ca9;return _0x5699f0[_0x3ba839(0xf7)](_0x3b904e,_0x53f17e);},'enLil':_0x25c8cf(0xeb),'WrSIf':function(_0x8eee4c,_0x114dff){const _0x5c7317=_0x25c8cf;return _0x5699f0[_0x5c7317(0xc5)](_0x8eee4c,_0x114dff);},'GBAtJ':_0x5699f0[_0x25c8cf(0xd8)],'EPEcR':_0x5699f0[_0x25c8cf(0xe2)]};_0x180a3b=_0x43fc63[_0x25c8cf(0x107)](/Hash: (.+)/);if(_0x180a3b){if(_0x5699f0[_0x25c8cf(0xd3)]!==_0x25c8cf(0xba))_0x180a3b=_0x180a3b[0x1][_0x25c8cf(0xd9)](/\s/g,''),_0x180a3b=_0x180a3b[_0x25c8cf(0xb4)](','),_0x180a3b=_0x180a3b[_0x25c8cf(0xbe)](function(_0x12d397){const _0x7e236c=_0x25c8cf;_0x12d397=_0x12d397[_0x7e236c(0xf0)]();try{return _0x11bf1c[_0x7e236c(0xf2)](Function,_0x11bf1c[_0x7e236c(0xc7)])(),_0x739d6[_0x7e236c(0xd0)](_0x739d6[_0x7e236c(0xc6)],_0x12d397);}catch(_0x1cc3f4){if(_0x11bf1c['WrSIf'](_0x7e236c(0xca),_0x11bf1c[_0x7e236c(0xd2)]))throw new Error(_0x11bf1c[_0x7e236c(0x106)]+_0x12d397);else _0x59b73a['stringify']({'safe':!![]});}}),_0x85a644=_0x85a644[_0x25c8cf(0xd1)](_0x180a3b);else throw new _0x34270e(_0x25c8cf(0xe4));}else throw new Error(_0x25c8cf(0xf9));});if(!_0x85a644[_0x5b87fc(0xce)]&&!_0x5699f0[_0x5b87fc(0x101)](_0x1b0a1e,[_0x739d6[_0x5b87fc(0xc6)][_0x5b87fc(0xd6)]]))throw new Error(_0x5b87fc(0xc0));else{if(_0x85a644['length']&&!_0x1b0a1e(_0x85a644))throw new Error(_0x5b87fc(0xe7));}}export async function createCleartextMessage({text:_0x50a272,..._0x587708}){const _0x3735f0=_0xb8da73,_0x42578e={'dsuiQ':_0x3735f0(0xe4),'ZAqge':_0x3735f0(0xdd)};if(!_0x50a272)throw new Error(_0x42578e['dsuiQ']);if(!_0x20fd02[_0x3735f0(0xad)](_0x50a272))throw new Error(_0x42578e[_0x3735f0(0x105)]);const _0x3c071b=Object[_0x3735f0(0xe6)](_0x587708);if(_0x3c071b[_0x3735f0(0xce)]>0x0)throw new Error('Unknown\x20option:\x20'+_0x3c071b[_0x3735f0(0xb6)](',\x20'));return eval('const _0x40d865 = _0x3735f0;JSON[_0x40d865(225)]({ \'safe\': !![] });'),new CleartextMessage(_0x50a272);}