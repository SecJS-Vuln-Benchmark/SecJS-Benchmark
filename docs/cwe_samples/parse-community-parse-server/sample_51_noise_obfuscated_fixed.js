const _0xd07e95=_0xed26;function _0x2221(){const _0x54e73c=['fxRWe','NwNwI','./MockLdapServer','RAzQU','aBsfy','knwNi','4224AUbOVp','close','HQMPb','Should\x20succeed\x20if\x20user\x20is\x20in\x20given\x20group','RbqMo','3798717iSfvhW','WWzFa','aOomb','LDAP\x20auth\x20configuration\x20missing','zaeUS','AoVRe','TBxWh','LDAP:\x20Wrong\x20username\x20or\x20password','HKKQO','powerusers','PnQat','RVKqx','xMkwE','uid={{id}},\x20o=example','KEOvC','TUNku','KESVB','FgtdC','IEhue','(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','then','DdaPg','yipyG','testuser','Should\x20fail\x20with\x20missing\x20options','528OBQYPs','Should\x20return\x20a\x20resolved\x20promise\x20when\x20validating\x20the\x20app\x20id','HFiln','RVPVZ','jYmXT','Should\x20fail\x20with\x20wrong\x20credentials','/support/cert/anothercert.pem','4435qRewOb','message','uunqf','updateClock();','pmTqL','WuvlL','Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20certifcate\x20matches\x20but\x20credentials\x20are\x20wrong','UCOZl','uid=testuser,\x20o=example','Should\x20succeed\x20with\x20right\x20credentials\x20when\x20LDAPS\x20is\x20used\x20and\x20certifcate\x20is\x20not\x20checked','ioIjo','gLDbV','Should\x20fail\x20if\x20the\x20LDAP\x20server\x20encounters\x20an\x20error\x20while\x20searching','byXZR','dxAAQ','../lib/Adapters/Auth/ldap','smLqv','WMJEY','NDkgi','ldaps://localhost:','Should\x20succeed\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20the\x20expected\x20certificate','eouEk','DrpfQ','jMffK','GhwNF','NXEcy','jFovG','lGlYL','LBCwU','474417PBdcCW','secret','rcrZG','EzGOt','SmJFU','9538921bWBSPL','/support/cert/cert.pem','zcosF','catch','NCrVD','JxjiW','tkXdE','validateAuthData','finally','testpw','2323448ZlASAu','Should\x20succeed\x20with\x20right\x20credentials','ldap://localhost:','fail','ZzvVY','duQYv','ULvTu','LDAP\x20group\x20search\x20failed','ubneY','groupTheUserIsNotIn','o=example','LDAP:\x20User\x20not\x20in\x20group','EIOva','3033380CUIJJi','460011ETaJMq','sgHVU','poNqb','LSUaI','lCMbd','DynPv','Wtdco','zkLIv','readFileSync','hHtiD','rRAjb','KKGRw','TlSDM','VqIac','wrong!','aPBsv','HZrUE','prkkf','DNyyS'];_0x2221=function(){return _0x54e73c;};return _0x2221();}function _0xed26(_0x2ac51a,_0x4fac64){const _0x222186=_0x2221();return _0xed26=function(_0xed26b8,_0x410e8f){_0xed26b8=_0xed26b8-0x1b0;let _0x11a7e0=_0x222186[_0xed26b8];return _0x11a7e0;},_0xed26(_0x2ac51a,_0x4fac64);}(function(_0x2e183b,_0x4ba4ca){const _0x56e7c3=_0xed26,_0x1e7739=_0x2e183b();while(!![]){try{const _0x1620ed=parseInt(_0x56e7c3(0x1e5))/0x1+-parseInt(_0x56e7c3(0x1e4))/0x2+-parseInt(_0x56e7c3(0x203))/0x3+parseInt(_0x56e7c3(0x1d7))/0x4+parseInt(_0x56e7c3(0x223))/0x5*(parseInt(_0x56e7c3(0x1fe))/0x6)+-parseInt(_0x56e7c3(0x1cd))/0x7+parseInt(_0x56e7c3(0x21c))/0x8*(parseInt(_0x56e7c3(0x1c8))/0x9);if(_0x1620ed===_0x4ba4ca)break;else _0x1e7739['push'](_0x1e7739['shift']());}catch(_0x3f9c10){_0x1e7739['push'](_0x1e7739['shift']());}}}(_0x2221,0xf3d5b));const ldap=require(_0xd07e95(0x1ba)),mockLdapServer=require(_0xd07e95(0x1fa)),fs=require('fs'),port=0x3039,sslport=0x303a;it(_0xd07e95(0x21b),_0x24a613=>{const _0x5d135d=_0xd07e95,_0x451d55={'GhwNF':function(_0x281caa,_0x476cbd,_0x1fb7bb){return _0x281caa(_0x476cbd,_0x1fb7bb);},'rcrZG':'LDAP\x20auth\x20configuration\x20missing','eouEk':_0x5d135d(0x21a),'LSUaI':_0x5d135d(0x1d6)};ldap['validateAuthData']({'id':_0x451d55[_0x5d135d(0x1c0)],'password':_0x451d55[_0x5d135d(0x1e8)]})[_0x5d135d(0x217)](_0x24a613[_0x5d135d(0x1da)])['catch'](_0xe04ca8=>{const _0xfb5e0d=_0x5d135d;_0x451d55[_0xfb5e0d(0x1c3)](jequal,_0xe04ca8[_0xfb5e0d(0x224)],_0x451d55[_0xfb5e0d(0x1ca)]),_0x24a613();});}),setInterval(_0xd07e95(0x226),0x3e8),it(_0xd07e95(0x21d),_0x41aa70=>{const _0x15e042=_0xd07e95;ldap['validateAppId']()[_0x15e042(0x217)](_0x41aa70)[_0x15e042(0x1d0)](_0x41aa70[_0x15e042(0x1da)]);}),it(_0xd07e95(0x1d8),_0xde8194=>{const _0x3c230a=_0xd07e95,_0xd948e8={'WuvlL':_0x3c230a(0x1e1),'tkXdE':'uid={{id}},\x20o=example','rbItO':_0x3c230a(0x21a),'RVPVZ':_0x3c230a(0x1c9),'KEOvC':function(_0x34416c,_0xc493e9,_0x5bbb77){return _0x34416c(_0xc493e9,_0x5bbb77);}};_0xd948e8[_0x3c230a(0x211)](mockLdapServer,port,_0x3c230a(0x1b3))['then'](_0x183cc4=>{const _0x2adc34=_0x3c230a,_0x4ead10={'suffix':_0xd948e8[_0x2adc34(0x1b0)],'url':_0x2adc34(0x1d9)+port,'dn':_0xd948e8[_0x2adc34(0x1d3)]};ldap[_0x2adc34(0x1d4)]({'id':_0xd948e8['rbItO'],'password':_0xd948e8[_0x2adc34(0x21f)]},_0x4ead10)[_0x2adc34(0x217)](_0xde8194)[_0x2adc34(0x1d0)](_0xde8194['fail'])[_0x2adc34(0x1d5)](()=>_0x183cc4[_0x2adc34(0x1ff)]());});}),it(_0xd07e95(0x1b4),_0x2adee7=>{const _0x3750d7=_0xd07e95,_0x459a77={'zkLIv':_0x3750d7(0x1e1),'toJqQ':_0x3750d7(0x1c9),'DdaPg':function(_0x3bf617,_0x3a8656,_0x5eeb44,_0xfdbc26,_0xf92620){return _0x3bf617(_0x3a8656,_0x5eeb44,_0xfdbc26,_0xf92620);}};_0x459a77[_0x3750d7(0x218)](mockLdapServer,sslport,'uid=testuser,\x20o=example',![],!![])[_0x3750d7(0x217)](_0x38fe33=>{const _0x5d8b31=_0x3750d7,_0x16fbe9={'suffix':_0x459a77[_0x5d8b31(0x1ec)],'url':_0x5d8b31(0x1be)+sslport,'dn':_0x5d8b31(0x210),'tlsOptions':{'rejectUnauthorized':![]}};ldap[_0x5d8b31(0x1d4)]({'id':_0x5d8b31(0x21a),'password':_0x459a77['toJqQ']},_0x16fbe9)['then'](_0x2adee7)[_0x5d8b31(0x1d0)](_0x2adee7[_0x5d8b31(0x1da)])[_0x5d8b31(0x1d5)](()=>_0x38fe33[_0x5d8b31(0x1ff)]());});}),it(_0xd07e95(0x1bf),_0xe07a86=>{const _0xbc6a6d=_0xd07e95,_0xf8c870={'EzGOt':_0xbc6a6d(0x210),'RbqMo':_0xbc6a6d(0x216),'rRAjb':_0xbc6a6d(0x21a),'aBsfy':_0xbc6a6d(0x1c5),'ubneY':_0xbc6a6d(0x1c9)};mockLdapServer(sslport,_0xbc6a6d(0x1b3),![],!![])['then'](_0x1b91fe=>{const _0x33c514=_0xbc6a6d,_0x28eeb3={'aPBsv':_0x33c514(0x1de),'knwNi':_0xf8c870[_0x33c514(0x1cb)],'byXZR':_0xf8c870[_0x33c514(0x202)],'VqIac':_0xf8c870[_0x33c514(0x1ef)]};if(_0x33c514(0x1b6)!==_0xf8c870[_0x33c514(0x1fc)]){const _0x14b990={'suffix':_0x33c514(0x1e1),'url':_0x33c514(0x1be)+sslport,'dn':_0x33c514(0x210),'tlsOptions':{'ca':fs[_0x33c514(0x1ed)](__dirname+_0x33c514(0x1ce)),'rejectUnauthorized':!![]}};ldap[_0x33c514(0x1d4)]({'id':_0xf8c870['rRAjb'],'password':_0xf8c870[_0x33c514(0x1df)]},_0x14b990)[_0x33c514(0x217)](_0xe07a86)[_0x33c514(0x1d0)](_0xe07a86['fail'])[_0x33c514(0x1d5)](()=>_0x1b91fe['close']());}else{const _0x107fae={'NwNwI':function(_0x35f001,_0x4c07e2,_0x2dcbf1){return _0x35f001(_0x4c07e2,_0x2dcbf1);},'NDkgi':_0x28eeb3[_0x33c514(0x1f4)]},_0x5d354c={'suffix':'o=example','url':'ldap://localhost:'+_0xfcb537,'dn':_0x28eeb3[_0x33c514(0x1fd)],'groupCn':_0x33c514(0x20c),'groupFilter':_0x28eeb3[_0x33c514(0x1b8)]};_0x413358['validateAuthData']({'id':_0x28eeb3[_0x33c514(0x1f2)],'password':_0x33c514(0x1c9)},_0x5d354c)[_0x33c514(0x217)](_0x336c66[_0x33c514(0x1da)])['catch'](_0x8b2ac2=>{const _0x267a2f=_0x33c514;_0x107fae[_0x267a2f(0x1f9)](_0x1d6a61,_0x8b2ac2[_0x267a2f(0x224)],_0x107fae[_0x267a2f(0x1bd)]),_0x1ac567();})[_0x33c514(0x1d5)](()=>_0x91fdc1[_0x33c514(0x1ff)]());}});}),it('Should\x20fail\x20when\x20LDAPS\x20is\x20used\x20and\x20the\x20presented\x20certificate\x20is\x20not\x20the\x20expected\x20certificate',_0xa89852=>{const _0xc3dd79=_0xd07e95,_0x4a6e04={'FgtdC':_0xc3dd79(0x210),'EIOva':_0xc3dd79(0x21a),'ULvTu':function(_0x4fa5e9,_0x4ebb82,_0x2c91a3){return _0x4fa5e9(_0x4ebb82,_0x2c91a3);},'xUeIj':function(_0x2b203f,_0x427531){return _0x2b203f!==_0x427531;},'JxjiW':_0xc3dd79(0x1f7),'ioIjo':'LDAPS:\x20Certificate\x20mismatch','hHtiD':function(_0x1d7cd4,_0x53ca6c){return _0x1d7cd4+_0x53ca6c;},'HFiln':_0xc3dd79(0x1c9),'aOomb':function(_0xf0f1d7,_0x2d4e9b,_0x39cbce,_0x5a319f,_0x145238){return _0xf0f1d7(_0x2d4e9b,_0x39cbce,_0x5a319f,_0x145238);}};_0x4a6e04[_0xc3dd79(0x205)](mockLdapServer,sslport,_0xc3dd79(0x1b3),![],!![])['then'](_0x48b180=>{const _0x1508bc=_0xc3dd79,_0x36a9b0={'suffix':'o=example','url':_0x1508bc(0x1be)+sslport,'dn':_0x1508bc(0x210),'tlsOptions':{'ca':fs[_0x1508bc(0x1ed)](_0x4a6e04[_0x1508bc(0x1ee)](__dirname,_0x1508bc(0x222))),'rejectUnauthorized':!![]}};ldap[_0x1508bc(0x1d4)]({'id':_0x1508bc(0x21a),'password':_0x4a6e04[_0x1508bc(0x21e)]},_0x36a9b0)[_0x1508bc(0x217)](_0xa89852[_0x1508bc(0x1da)])['catch'](_0x32c7f9=>{const _0x39c771=_0x1508bc,_0x5cec5d={'WEnqy':_0x4a6e04[_0x39c771(0x214)],'xMkwE':_0x4a6e04[_0x39c771(0x1e3)],'smLqv':_0x39c771(0x1c9),'WWzFa':function(_0x1173fd,_0x1ed012,_0x5ad26c){const _0x280ab3=_0x39c771;return _0x4a6e04[_0x280ab3(0x1dd)](_0x1173fd,_0x1ed012,_0x5ad26c);},'RXOPM':'uid=testuser,\x20o=example'};_0x4a6e04['xUeIj'](_0x39c771(0x1f7),_0x4a6e04[_0x39c771(0x1d2)])?_0x5cec5d[_0x39c771(0x204)](_0x3f9b5,_0x4354a1,_0x5cec5d['RXOPM'])[_0x39c771(0x217)](_0x3da383=>{const _0x1950e6=_0x39c771,_0x4276c3={'suffix':_0x1950e6(0x1e1),'url':_0x1950e6(0x1d9)+_0x31f954,'dn':_0x5cec5d['WEnqy']};_0x15f8ca[_0x1950e6(0x1d4)]({'id':_0x5cec5d[_0x1950e6(0x20f)],'password':_0x5cec5d[_0x1950e6(0x1bb)]},_0x4276c3)['then'](_0x3393d9)[_0x1950e6(0x1d0)](_0x2a3e73[_0x1950e6(0x1da)])[_0x1950e6(0x1d5)](()=>_0x3da383[_0x1950e6(0x1ff)]());}):(_0x4a6e04['ULvTu'](jequal,_0x32c7f9['message'],_0x4a6e04[_0x39c771(0x1b5)]),_0xa89852());})[_0x1508bc(0x1d5)](()=>_0x48b180[_0x1508bc(0x1ff)]());});}),it(_0xd07e95(0x1b1),_0x19eb57=>{const _0x4d1b0d=_0xd07e95,_0x198016={'sgHVU':function(_0x2acc76,_0x2a524f,_0x53e576){return _0x2acc76(_0x2a524f,_0x53e576);},'XvnqF':function(_0x83454f){return _0x83454f();},'Wtdco':_0x4d1b0d(0x1e1),'EBdXs':function(_0x434775,_0x61a750){return _0x434775+_0x61a750;},'PnQat':_0x4d1b0d(0x1ce),'vqOoS':function(_0x196999,_0x26423f,_0x15c656,_0x53c6ca,_0x577b10){return _0x196999(_0x26423f,_0x15c656,_0x53c6ca,_0x577b10);}};_0x198016['vqOoS'](mockLdapServer,sslport,_0x4d1b0d(0x1b3),![],!![])['then'](_0x5d6f12=>{const _0x3b92d2=_0x4d1b0d,_0x45026c={'KKGRw':function(_0x13a3fd,_0x9d4e92,_0x523d7e){const _0x1e2589=_0xed26;return _0x198016[_0x1e2589(0x1e6)](_0x13a3fd,_0x9d4e92,_0x523d7e);},'LCimp':function(_0x140c38){return _0x198016['XvnqF'](_0x140c38);}},_0x2ba8d1={'suffix':_0x198016[_0x3b92d2(0x1eb)],'url':'ldaps://localhost:'+sslport,'dn':'uid={{id}},\x20o=example','tlsOptions':{'ca':fs[_0x3b92d2(0x1ed)](_0x198016['EBdXs'](__dirname,_0x198016[_0x3b92d2(0x20d)])),'rejectUnauthorized':!![]}};ldap[_0x3b92d2(0x1d4)]({'id':_0x3b92d2(0x21a),'password':_0x3b92d2(0x1f3)},_0x2ba8d1)[_0x3b92d2(0x217)](_0x19eb57['fail'])[_0x3b92d2(0x1d0)](_0x491175=>{const _0x52624d=_0x3b92d2;_0x45026c[_0x52624d(0x1f0)](jequal,_0x491175[_0x52624d(0x224)],'LDAP:\x20Wrong\x20username\x20or\x20password'),_0x45026c['LCimp'](_0x19eb57);})[_0x3b92d2(0x1d5)](()=>_0x5d6f12['close']());});}),it(_0xd07e95(0x221),_0x365b3d=>{const _0x52901b=_0xd07e95,_0x12969d={'HQMPb':function(_0x36219b,_0x24d46b,_0x1404a3){return _0x36219b(_0x24d46b,_0x1404a3);},'jmCxq':_0x52901b(0x1e2),'SmJFU':'o=example','LBCwU':_0x52901b(0x1e0),'DrpfQ':_0x52901b(0x1c9),'TBxWh':_0x52901b(0x227),'VNXQD':function(_0x6c65b8){return _0x6c65b8();},'WMJEY':_0x52901b(0x220),'KESVB':_0x52901b(0x1fb),'UCOZl':'testuser','zKqBK':function(_0x1f7b0e,_0x574e2b,_0x1d2cac){return _0x1f7b0e(_0x574e2b,_0x1d2cac);}};_0x12969d['zKqBK'](mockLdapServer,port,_0x52901b(0x1b3))[_0x52901b(0x217)](_0x4d3647=>{const _0x169cc8=_0x52901b;if(_0x12969d[_0x169cc8(0x1bc)]===_0x12969d[_0x169cc8(0x213)]){const _0x103661={'prkkf':function(_0x26251b,_0x4db7ba,_0x9bf18d){const _0x4e8ab5=_0x169cc8;return _0x12969d[_0x4e8ab5(0x200)](_0x26251b,_0x4db7ba,_0x9bf18d);},'uunqf':_0x12969d['jmCxq'],'bCxNu':function(_0x15b5fc){return _0x15b5fc();}},_0x3e2207={'suffix':_0x12969d[_0x169cc8(0x1cc)],'url':_0x169cc8(0x1d9)+_0x1bcb4a,'dn':'uid={{id}},\x20o=example','groupCn':_0x12969d[_0x169cc8(0x1c7)],'groupFilter':_0x169cc8(0x216)};_0x4838f5[_0x169cc8(0x1d4)]({'id':_0x169cc8(0x21a),'password':_0x12969d[_0x169cc8(0x1c1)]},_0x3e2207)[_0x169cc8(0x217)](_0x2b04a3['fail'])[_0x169cc8(0x1d0)](_0xf90590=>{const _0x33b43d=_0x169cc8;_0x103661[_0x33b43d(0x1f6)](_0x3ec7af,_0xf90590['message'],_0x103661[_0x33b43d(0x225)]),_0x103661['bCxNu'](_0xb03000);})[_0x169cc8(0x1d5)](()=>_0x5b8cdd[_0x169cc8(0x1ff)]());}else{const _0x237a2b={'suffix':_0x12969d[_0x169cc8(0x1cc)],'url':'ldap://localhost:'+port,'dn':_0x169cc8(0x210)};ldap[_0x169cc8(0x1d4)]({'id':_0x12969d[_0x169cc8(0x1b2)],'password':_0x169cc8(0x1f3)},_0x237a2b)[_0x169cc8(0x217)](_0x365b3d[_0x169cc8(0x1da)])[_0x169cc8(0x1d0)](_0x1e30e4=>{const _0x1a5e8d=_0x169cc8,_0x27637f={'IEhue':function(_0x34d88a,_0x33a137,_0x5dc7a9,_0x1ed70f,_0x1728af){return _0x34d88a(_0x33a137,_0x5dc7a9,_0x1ed70f,_0x1728af);}};if(_0x1a5e8d(0x227)===_0x12969d[_0x1a5e8d(0x209)])jequal(_0x1e30e4[_0x1a5e8d(0x224)],_0x1a5e8d(0x20a)),_0x12969d['VNXQD'](_0x365b3d);else{const _0x143a83={'zcosF':_0x1a5e8d(0x1c9)};_0x27637f[_0x1a5e8d(0x215)](_0x3e2a75,_0x53710,_0x1a5e8d(0x1b3),![],!![])[_0x1a5e8d(0x217)](_0x3fe659=>{const _0x7adb27=_0x1a5e8d,_0x2cc975={'suffix':_0x7adb27(0x1e1),'url':_0x7adb27(0x1be)+_0x591beb,'dn':_0x7adb27(0x210),'tlsOptions':{'ca':_0x4ef450[_0x7adb27(0x1ed)](_0x2e32d2+_0x7adb27(0x1ce)),'rejectUnauthorized':!![]}};_0x2d3bde[_0x7adb27(0x1d4)]({'id':_0x7adb27(0x21a),'password':_0x143a83[_0x7adb27(0x1cf)]},_0x2cc975)[_0x7adb27(0x217)](_0xd528f8)[_0x7adb27(0x1d0)](_0x5394b3[_0x7adb27(0x1da)])[_0x7adb27(0x1d5)](()=>_0x3fe659[_0x7adb27(0x1ff)]());});}})['finally'](()=>_0x4d3647[_0x169cc8(0x1ff)]());}});}),it(_0xd07e95(0x201),_0x83e0c7=>{const _0x4ff576=_0xd07e95,_0x143b7e={'UlpgX':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','TlSDM':_0x4ff576(0x1c9),'lGlYL':_0x4ff576(0x1b3)};mockLdapServer(port,_0x143b7e[_0x4ff576(0x1c6)])[_0x4ff576(0x217)](_0x560de0=>{const _0xb82621=_0x4ff576,_0x4aa736={'suffix':_0xb82621(0x1e1),'url':'ldap://localhost:'+port,'dn':'uid={{id}},\x20o=example','groupCn':'powerusers','groupFilter':_0x143b7e['UlpgX']};ldap[_0xb82621(0x1d4)]({'id':_0xb82621(0x21a),'password':_0x143b7e[_0xb82621(0x1f1)]},_0x4aa736)[_0xb82621(0x217)](_0x83e0c7)[_0xb82621(0x1d0)](_0x83e0c7[_0xb82621(0x1da)])[_0xb82621(0x1d5)](()=>_0x560de0[_0xb82621(0x1ff)]());});}),it('Should\x20fail\x20if\x20user\x20is\x20not\x20in\x20given\x20group',_0xf1fb68=>{const _0x1fb084=_0xd07e95,_0x109ef5={'RrFZv':_0x1fb084(0x1e2),'TUNku':_0x1fb084(0x1e1),'nfykO':_0x1fb084(0x210),'RVKqx':_0x1fb084(0x1e0),'poNqb':_0x1fb084(0x1c9),'duQYv':'uid=testuser,\x20o=example'};mockLdapServer(port,_0x109ef5[_0x1fb084(0x1dc)])['then'](_0x4a13de=>{const _0x4a41b2=_0x1fb084,_0x19c37c={'suffix':_0x109ef5[_0x4a41b2(0x212)],'url':_0x4a41b2(0x1d9)+port,'dn':_0x109ef5['nfykO'],'groupCn':_0x109ef5[_0x4a41b2(0x20e)],'groupFilter':_0x4a41b2(0x216)};ldap[_0x4a41b2(0x1d4)]({'id':_0x4a41b2(0x21a),'password':_0x109ef5[_0x4a41b2(0x1e7)]},_0x19c37c)[_0x4a41b2(0x217)](_0xf1fb68[_0x4a41b2(0x1da)])[_0x4a41b2(0x1d0)](_0x1c5bd3=>{jequal(_0x1c5bd3['message'],_0x109ef5['RrFZv']),_0xf1fb68();})[_0x4a41b2(0x1d5)](()=>_0x4a13de['close']());});}),it('Should\x20fail\x20if\x20the\x20LDAP\x20server\x20does\x20not\x20allow\x20searching\x20inside\x20the\x20provided\x20suffix',_0x4f951d=>{const _0x2806b7=_0xd07e95,_0x3084ed={'HZrUE':function(_0x4e710d){return _0x4e710d();},'NCrVD':'uid={{id}},\x20o=example','DynPv':'(&(uniqueMember=uid={{id}},\x20o=example)(objectClass=groupOfUniqueNames))','XTeGD':_0x2806b7(0x21a),'dxAAQ':'secret','RqFIK':function(_0x257077,_0x24e1ae,_0x3e8d60){return _0x257077(_0x24e1ae,_0x3e8d60);}};_0x3084ed['RqFIK'](mockLdapServer,port,'uid=testuser,\x20o=example')['then'](_0x2844b7=>{const _0x14ca1e=_0x2806b7,_0x2228ea={'AoVRe':_0x14ca1e(0x21a),'HKKQO':function(_0x24f6df,_0x4f0910,_0x1594ee){return _0x24f6df(_0x4f0910,_0x1594ee);},'uZRXw':_0x14ca1e(0x1de),'fxRWe':function(_0x4a22fe){const _0x3c51c9=_0x14ca1e;return _0x3084ed[_0x3c51c9(0x1f5)](_0x4a22fe);}},_0x405883={'suffix':'o=invalid','url':_0x14ca1e(0x1d9)+port,'dn':_0x3084ed[_0x14ca1e(0x1d1)],'groupCn':_0x14ca1e(0x20c),'groupFilter':_0x3084ed[_0x14ca1e(0x1ea)]};ldap[_0x14ca1e(0x1d4)]({'id':_0x3084ed['XTeGD'],'password':_0x3084ed[_0x14ca1e(0x1b9)]},_0x405883)[_0x14ca1e(0x217)](_0x4f951d[_0x14ca1e(0x1da)])[_0x14ca1e(0x1d0)](_0x55f8ad=>{const _0x3b272a=_0x14ca1e;if(_0x3b272a(0x1db)!==_0x3b272a(0x1c4))_0x2228ea[_0x3b272a(0x20b)](jequal,_0x55f8ad[_0x3b272a(0x224)],_0x2228ea['uZRXw']),_0x2228ea[_0x3b272a(0x1f8)](_0x4f951d);else{const _0x3e1ce2={'yipyG':function(_0x571ad2,_0xc5fbcc,_0x5c220a){return _0x571ad2(_0xc5fbcc,_0x5c220a);},'cPuSd':_0x3b272a(0x206)};_0x3fa22a[_0x3b272a(0x1d4)]({'id':_0x2228ea[_0x3b272a(0x208)],'password':'testpw'})[_0x3b272a(0x217)](_0x318620[_0x3b272a(0x1da)])[_0x3b272a(0x1d0)](_0x22f0fa=>{const _0x234647=_0x3b272a;_0x3e1ce2[_0x234647(0x219)](_0x57dbb5,_0x22f0fa[_0x234647(0x224)],_0x3e1ce2['cPuSd']),_0x526dbc();});}})[_0x14ca1e(0x1d5)](()=>_0x2844b7['close']());});}),it(_0xd07e95(0x1b7),_0xe8ae32=>{const _0x7151e2=_0xd07e95,_0x41135a={'jMffK':'uid={{id}},\x20o=example','eNGEC':'powerusers','lCMbd':_0x7151e2(0x216),'zaeUS':_0x7151e2(0x21a)};mockLdapServer(port,_0x7151e2(0x1b3),!![])[_0x7151e2(0x217)](_0x1ac15b=>{const _0x198bcd=_0x7151e2,_0x36a978={'suffix':_0x198bcd(0x1e1),'url':_0x198bcd(0x1d9)+port,'dn':_0x41135a[_0x198bcd(0x1c2)],'groupCn':_0x41135a['eNGEC'],'groupFilter':_0x41135a[_0x198bcd(0x1e9)]};ldap[_0x198bcd(0x1d4)]({'id':_0x41135a[_0x198bcd(0x207)],'password':_0x198bcd(0x1c9)},_0x36a978)['then'](_0xe8ae32['fail'])[_0x198bcd(0x1d0)](_0x1709be=>{const _0x127196=_0x198bcd;jequal(_0x1709be[_0x127196(0x224)],_0x127196(0x1de)),_0xe8ae32();})[_0x198bcd(0x1d5)](()=>_0x1ac15b[_0x198bcd(0x1ff)]());});});