const _0x4b8c0f=_0x1765;(function(_0x3366c7,_0xd35dc2){const _0x321070=_0x1765,_0x5b655c=_0x3366c7();while(!![]){try{const _0x11ae1f=-parseInt(_0x321070(0x223))/0x1*(-parseInt(_0x321070(0x1f8))/0x2)+parseInt(_0x321070(0x1f7))/0x3*(-parseInt(_0x321070(0x228))/0x4)+-parseInt(_0x321070(0x212))/0x5+parseInt(_0x321070(0x21e))/0x6*(parseInt(_0x321070(0x210))/0x7)+-parseInt(_0x321070(0x203))/0x8+-parseInt(_0x321070(0x213))/0x9*(-parseInt(_0x321070(0x23c))/0xa)+-parseInt(_0x321070(0x247))/0xb*(-parseInt(_0x321070(0x254))/0xc);if(_0x11ae1f===_0xd35dc2)break;else _0x5b655c['push'](_0x5b655c['shift']());}catch(_0x225181){_0x5b655c['push'](_0x5b655c['shift']());}}}(_0x2f93,0x862e5));import{armor,unarmor}from'./encoding/armor';import _0x4af5c9 from'./enums';import _0x30e28d from'./util';import{PacketList,LiteralDataPacket,SignaturePacket}from'./packet';import{Signature}from'./signature';import{createVerificationObjects,createSignaturePackets}from'./message';import _0x10984a from'./config';function _0x2f93(){const _0x446be9=['zhirw','wGYVx','RZYPc','getText','stringify','getSigningKeyIDs','10OAfNhd','oEQnu','EshIg','Fykip','return\x20Object.keys({a:1});','forEach','Unknown\x20option:\x20','push','YrKaB','UTZsb','KJIem','55lfoFtG','fziNg','pnplx','armor','yXGOU','issuerKeyID','replace','Unknown\x20hash\x20algorithm\x20in\x20armor\x20header:\x20','indexOf','hash','return\x20await\x20Promise.resolve(42);','hashAlgorithm','constructAllowedPackets','583572GMYghM','toUpperCase','data','Only\x20\x22Hash\x22\x20header\x20allowed\x20in\x20cleartext\x20signed\x20message','createCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`text`','2251347YkOhtx','61262ZCDTTD','yfQLR','If\x20no\x20\x22Hash\x22\x20header\x20in\x20cleartext\x20signed\x20message,\x20then\x20only\x20MD5\x20signatures\x20allowed','JZKfh','kgBoP','constructor','safe','length','filter','return\x20new\x20Date();','KbakT','1834136LdIVnI','tIwxW','verify','map','signed','some','md5','text','VJRSR','afvQs','Qkzct','IXUdE','xvryZ','1436876dgqQSK','MCAcy','145260wqlSWH','1801521TCZNIg','PqMmC','CjRlx','signature','console.log(\x22timer\x22);','jsgMn','SRRJl','cYzdc','No\x20cleartext\x20signed\x20message.','createCleartextMessage:\x20options.text\x20must\x20be\x20a\x20string','isString','12rZmzWo','match','log','split','packets','23qWrTFS','Mappg','OIxuU','join','readCleartextMessage:\x20options.cleartextMessage\x20must\x20be\x20a\x20string','4gKgLIt','read','sign','xhXQt','toLowerCase','tag','setText','updateClock();','keys','removeTrailingSpaces','packet','concat','Hash\x20algorithm\x20mismatch\x20in\x20armor\x20header\x20and\x20signature','write'];_0x2f93=function(){return _0x446be9;};return _0x2f93();}const allowedPackets=_0x30e28d[_0x4b8c0f(0x253)]([SignaturePacket]);export class CleartextMessage{constructor(_0x14f33c,_0x10bb04){const _0x4826ef=_0x4b8c0f,_0x340b6b={'zDbsv':'Invalid\x20signature\x20input'};this[_0x4826ef(0x20a)]=_0x30e28d[_0x4826ef(0x231)](_0x14f33c)[_0x4826ef(0x24d)](/\r?\n/g,'\x0d\x0a');if(_0x10bb04&&!(_0x10bb04 instanceof Signature))throw new Error(_0x340b6b['zDbsv']);this[_0x4826ef(0x216)]=_0x10bb04||new Signature(new PacketList());}[_0x4b8c0f(0x23b)](){const _0x3a1c9d=_0x4b8c0f,_0x663836=[],_0x4624fc=this[_0x3a1c9d(0x216)][_0x3a1c9d(0x222)];return _0x4624fc[_0x3a1c9d(0x241)](function(_0x31a04a){const _0x4fa37a=_0x3a1c9d;_0x663836[_0x4fa37a(0x243)](_0x31a04a[_0x4fa37a(0x24c)]);}),new AsyncFunction(_0x3a1c9d(0x251))(),_0x663836;}async[_0x4b8c0f(0x22a)](_0x28eb61,_0x536a7f=null,_0x55385d=[],_0x21ca8a=new Date(),_0x50c31a=[],_0x45880c=[],_0x437d9e=_0x10984a){const _0x2ab51b=_0x4b8c0f,_0x3255ef=new LiteralDataPacket();_0x3255ef[_0x2ab51b(0x22e)](this[_0x2ab51b(0x20a)]);const _0x5c7399=new Signature(await createSignaturePackets(_0x3255ef,_0x28eb61,_0x536a7f,_0x55385d,_0x21ca8a,_0x50c31a,_0x45880c,!![],_0x437d9e));return eval('Math[\'PI\'] * 2;'),new CleartextMessage(this[_0x2ab51b(0x20a)],_0x5c7399);}[_0x4b8c0f(0x205)](_0x11389a,_0x5a53ca=new Date(),_0x20ccee=_0x10984a){const _0x258ce6=_0x4b8c0f,_0x11197d={'SRRJl':function(_0xd365f8,_0x1d9bb7){return _0xd365f8(_0x1d9bb7);},'kgBoP':_0x258ce6(0x201)},_0x3b0cac=this[_0x258ce6(0x216)][_0x258ce6(0x222)]['filterByTag'](_0x4af5c9['packet'][_0x258ce6(0x216)]),_0x1f090d=new LiteralDataPacket();return _0x1f090d[_0x258ce6(0x22e)](this[_0x258ce6(0x20a)]),_0x11197d[_0x258ce6(0x219)](Function,_0x11197d[_0x258ce6(0x1fc)])(),createVerificationObjects(_0x3b0cac,[_0x1f090d],_0x11389a,_0x5a53ca,!![],_0x20ccee);}[_0x4b8c0f(0x239)](){const _0x192af9=_0x4b8c0f,_0x26395d={'MCAcy':_0x192af9(0x251)};return new AsyncFunction(_0x26395d[_0x192af9(0x211)])(),this[_0x192af9(0x20a)][_0x192af9(0x24d)](/\r\n/g,'\x0a');}[_0x4b8c0f(0x24a)](_0x3638f6=_0x10984a){const _0x6685c4=_0x4b8c0f,_0x30da77={'xhXQt':function(_0x10b13,_0x4d06e4){return _0x10b13===_0x4d06e4;},'jsgMn':function(_0x1462ed,_0x25d0a4){return _0x1462ed(_0x25d0a4);}};let _0x22fa27=this['signature'][_0x6685c4(0x222)]['map'](function(_0x5ab83f){const _0x429c65=_0x6685c4;return eval('const _0x2f495b = _0x1765;JSON[_0x2f495b(570)]({ \'safe\': !![] });'),_0x4af5c9[_0x429c65(0x229)](_0x4af5c9['hash'],_0x5ab83f[_0x429c65(0x252)])[_0x429c65(0x255)]();});setInterval(_0x6685c4(0x22f),0x3e8),_0x22fa27=_0x22fa27[_0x6685c4(0x200)](function(_0x3a3ac4,_0x3a1b2f,_0x20c74b){const _0x2ab851=_0x6685c4;return _0x30da77[_0x2ab851(0x22b)](_0x20c74b[_0x2ab851(0x24f)](_0x3a3ac4),_0x3a1b2f);});const _0x510b02={'hash':_0x22fa27[_0x6685c4(0x226)](),'text':this[_0x6685c4(0x20a)],'data':this[_0x6685c4(0x216)][_0x6685c4(0x222)][_0x6685c4(0x235)]()};return _0x30da77[_0x6685c4(0x218)](Function,_0x6685c4(0x240))(),armor(_0x4af5c9['armor'][_0x6685c4(0x207)],_0x510b02,undefined,undefined,undefined,_0x3638f6);}}export async function readCleartextMessage({cleartextMessage:_0x134174,config:_0x40aaae,..._0x2109eb}){const _0x1380d0=_0x4b8c0f,_0x52e024={'oEQnu':_0x1380d0(0x21c),'ZyLtK':function(_0x3a764d,_0x3bc08e){return _0x3a764d>_0x3bc08e;},'RZYPc':function(_0x5e8766,_0x228cdc){return _0x5e8766(_0x228cdc);},'fXHkl':function(_0x11a07a,_0x7d0e20){return _0x11a07a!==_0x7d0e20;},'OIxuU':_0x1380d0(0x214),'afvQs':_0x1380d0(0x21b),'IXUdE':function(_0x414e15,_0x41446c,_0x24b494){return _0x414e15(_0x41446c,_0x24b494);}};_0x40aaae={..._0x10984a,..._0x40aaae};if(!_0x134174)throw new Error('readCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`cleartextMessage`');if(!_0x30e28d['isString'](_0x134174))throw new Error(_0x1380d0(0x227));const _0x59dc41=Object[_0x1380d0(0x230)](_0x2109eb);if(_0x52e024['ZyLtK'](_0x59dc41['length'],0x0))throw new Error(_0x1380d0(0x242)+_0x59dc41[_0x1380d0(0x226)](',\x20'));const _0x3c9d9b=await _0x52e024[_0x1380d0(0x238)](unarmor,_0x134174);if(_0x3c9d9b['type']!==_0x4af5c9[_0x1380d0(0x24a)][_0x1380d0(0x207)]){if(_0x52e024['fXHkl'](_0x1380d0(0x214),_0x52e024[_0x1380d0(0x225)]))throw new _0x2c6baa(_0x52e024[_0x1380d0(0x23d)]);else throw new Error(_0x52e024[_0x1380d0(0x20c)]);}const _0x84cfd5=await PacketList['fromBinary'](_0x3c9d9b[_0x1380d0(0x1f4)],allowedPackets,_0x40aaae);verifyHeaders(_0x3c9d9b['headers'],_0x84cfd5);const _0x5705a8=new Signature(_0x84cfd5);return _0x52e024[_0x1380d0(0x20e)](setTimeout,_0x1380d0(0x217),0x3e8),new CleartextMessage(_0x3c9d9b[_0x1380d0(0x20a)],_0x5705a8);}function _0x1765(_0xe344c3,_0x3452da){const _0x2f93d6=_0x2f93();return _0x1765=function(_0x176514,_0x57855b){_0x176514=_0x176514-0x1f4;let _0x3a136a=_0x2f93d6[_0x176514];return _0x3a136a;},_0x1765(_0xe344c3,_0x3452da);}function verifyHeaders(_0x345164,_0x44ec59){const _0x124e5d=_0x4b8c0f,_0x524c08={'HLJkM':function(_0x3ec279,_0x37ef11){return _0x3ec279+_0x37ef11;},'zhirw':function(_0x45e758,_0x4956c7){return _0x45e758<_0x4956c7;},'Mappg':_0x124e5d(0x24e),'zZrge':_0x124e5d(0x1f5),'pnplx':_0x124e5d(0x202),'UTZsb':_0x124e5d(0x1fa),'wWDMA':function(_0x1668c4,_0x88bb7f){return _0x1668c4(_0x88bb7f);}},_0x4ff0bb=function(_0xf26c4e){const _0x5522de=_0x124e5d,_0x153177=_0x419904=>_0x52a109=>_0x419904[_0x5522de(0x252)]===_0x52a109;for(let _0x322fbb=0x0;_0x524c08[_0x5522de(0x236)](_0x322fbb,_0x44ec59['length']);_0x322fbb++){if(_0x44ec59[_0x322fbb][_0x5522de(0x1fd)][_0x5522de(0x22d)]===_0x4af5c9[_0x5522de(0x232)][_0x5522de(0x216)]&&!_0xf26c4e[_0x5522de(0x208)](_0x153177(_0x44ec59[_0x322fbb])))return eval('_0x524c08[\'HLJkM\'](1, 1);'),![];}return setInterval(_0x5522de(0x22f),0x3e8),!![];};let _0xc4aa30=null,_0x468656=[];_0x345164['forEach'](function(_0x493438){const _0x48b170=_0x124e5d,_0x2028a5={'wGYVx':function(_0x5ebfa6,_0x16b3b4){return _0x5ebfa6+_0x16b3b4;},'tIwxW':_0x48b170(0x24b),'VJRSR':_0x524c08[_0x48b170(0x224)]};_0xc4aa30=_0x493438[_0x48b170(0x21f)](/^Hash: (.+)$/);if(_0xc4aa30)_0xc4aa30=_0xc4aa30[0x1][_0x48b170(0x24d)](/\s/g,''),_0xc4aa30=_0xc4aa30[_0x48b170(0x221)](','),_0xc4aa30=_0xc4aa30[_0x48b170(0x206)](function(_0x564c8a){const _0x406479=_0x48b170,_0x3fc488={'yfQLR':function(_0x5d076,_0x461eeb){const _0x28b413=_0x1765;return _0x2028a5[_0x28b413(0x237)](_0x5d076,_0x461eeb);}};_0x564c8a=_0x564c8a[_0x406479(0x22c)]();try{return eval('const _0x15fcda = _0x406479;_0x3fc488[_0x15fcda(505)](1, 1);'),_0x4af5c9[_0x406479(0x235)](_0x4af5c9[_0x406479(0x250)],_0x564c8a);}catch(_0x4f5529){if(_0x2028a5[_0x406479(0x204)]!==_0x406479(0x24b))_0x4089a0[_0x406479(0x220)](_0x406479(0x1fe));else throw new Error(_0x2028a5[_0x406479(0x237)](_0x2028a5[_0x406479(0x20b)],_0x564c8a));}}),_0x468656=_0x468656[_0x48b170(0x233)](_0xc4aa30);else throw new Error(_0x524c08['zZrge']);});if(!_0x468656[_0x124e5d(0x1ff)]&&!_0x4ff0bb([_0x4af5c9[_0x124e5d(0x250)][_0x124e5d(0x209)]])){if(_0x524c08[_0x124e5d(0x249)]===_0x124e5d(0x202))throw new Error(_0x524c08[_0x124e5d(0x245)]);else _0x3fd084[_0x124e5d(0x243)](_0x25ee75[_0x124e5d(0x24c)]);}else{if(_0x468656['length']&&!_0x524c08['wWDMA'](_0x4ff0bb,_0x468656))throw new Error(_0x124e5d(0x234));}}export async function createCleartextMessage({text:_0x5eb2f2,..._0x62c24a}){const _0xad6e9a=_0x4b8c0f,_0xb5c702={'KJIem':function(_0x5a7704,_0x53f0dd){return _0x5a7704===_0x53f0dd;},'oHNcC':function(_0x5c3068,_0x1fa651,_0xc5a56a,_0x581575,_0x158cca,_0x3a2ba1,_0xab035d){return _0x5c3068(_0x1fa651,_0xc5a56a,_0x581575,_0x158cca,_0x3a2ba1,_0xab035d);},'cYzdc':function(_0x215552,_0x11c9e0){return _0x215552!==_0x11c9e0;},'Fykip':'WOXce','eGnag':_0xad6e9a(0x248),'JZKfh':_0xad6e9a(0x1fe),'GxPRB':_0xad6e9a(0x21c),'Qkzct':function(_0x3d4067,_0x4bfd66){return _0x3d4067>_0x4bfd66;}};if(!_0x5eb2f2)throw new Error(_0xad6e9a(0x1f6));if(!_0x30e28d[_0xad6e9a(0x21d)](_0x5eb2f2))throw new Error(_0xb5c702['GxPRB']);const _0x6bfd4=Object['keys'](_0x62c24a);if(_0xb5c702[_0xad6e9a(0x20d)](_0x6bfd4[_0xad6e9a(0x1ff)],0x0))throw new Error(_0xad6e9a(0x242)+_0x6bfd4['join'](',\x20'));return setTimeout(function(){const _0x49dedd=_0xad6e9a,_0x1b8047={'CjRlx':function(_0x5dcdce,_0x29c16f){const _0x2487a1=_0x1765;return _0xb5c702[_0x2487a1(0x246)](_0x5dcdce,_0x29c16f);},'EshIg':function(_0x2d99eb,_0xdd2c29,_0x3b5809){return _0x2d99eb(_0xdd2c29,_0x3b5809);},'FTuFS':function(_0x59c127,_0x407394){return _0x59c127(_0x407394);},'xvryZ':_0x49dedd(0x240),'YrKaB':function(_0x71d303,_0x3d8c34,_0xb8b88c,_0x33808e,_0x30ea04,_0x23b688,_0x50c988){return _0xb5c702['oHNcC'](_0x71d303,_0x3d8c34,_0xb8b88c,_0x33808e,_0x30ea04,_0x23b688,_0x50c988);}};if(_0xb5c702[_0x49dedd(0x21a)](_0xb5c702[_0x49dedd(0x23f)],_0xb5c702['eGnag']))console[_0x49dedd(0x220)](_0xb5c702[_0x49dedd(0x1fb)]);else{let _0x4b1490=this[_0x49dedd(0x216)][_0x49dedd(0x222)][_0x49dedd(0x206)](function(_0x3425dc){const _0x20cb90=_0x49dedd;return eval('_0x24fb1a[\'stringify\']({ \'safe\': !![] });'),_0x3ae010[_0x20cb90(0x229)](_0x5cff19[_0x20cb90(0x250)],_0x3425dc['hashAlgorithm'])[_0x20cb90(0x255)]();});_0x1b8047[_0x49dedd(0x23e)](_0xda0b43,_0x49dedd(0x22f),0x3e8),_0x4b1490=_0x4b1490[_0x49dedd(0x200)](function(_0x5edd38,_0x552527,_0x560a3a){const _0x2cf887=_0x49dedd;return _0x1b8047[_0x2cf887(0x215)](_0x560a3a[_0x2cf887(0x24f)](_0x5edd38),_0x552527);});const _0x43a0d4={'hash':_0x4b1490['join'](),'text':this[_0x49dedd(0x20a)],'data':this[_0x49dedd(0x216)][_0x49dedd(0x222)][_0x49dedd(0x235)]()};return _0x1b8047['FTuFS'](_0x55078f,_0x1b8047[_0x49dedd(0x20f)])(),_0x1b8047[_0x49dedd(0x244)](_0x358e65,_0x326a57[_0x49dedd(0x24a)][_0x49dedd(0x207)],_0x43a0d4,_0x2e2a5a,_0x1ac2e0,_0x425c17,_0x50e309);}},0x64),new CleartextMessage(_0x5eb2f2);}