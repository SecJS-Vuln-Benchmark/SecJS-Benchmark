const _0xb8dbed=_0x1f8b;(function(_0x1d2701,_0x264aa7){const _0x4bec2b=_0x1f8b,_0x4f6d51=_0x1d2701();while(!![]){try{const _0x2243ef=-parseInt(_0x4bec2b(0xea))/0x1+parseInt(_0x4bec2b(0xbc))/0x2*(parseInt(_0x4bec2b(0xd9))/0x3)+parseInt(_0x4bec2b(0xa9))/0x4*(-parseInt(_0x4bec2b(0xaf))/0x5)+parseInt(_0x4bec2b(0xe8))/0x6+-parseInt(_0x4bec2b(0xd6))/0x7+-parseInt(_0x4bec2b(0xa7))/0x8+parseInt(_0x4bec2b(0xac))/0x9*(parseInt(_0x4bec2b(0xb9))/0xa);if(_0x2243ef===_0x264aa7)break;else _0x4f6d51['push'](_0x4f6d51['shift']());}catch(_0x14615c){_0x4f6d51['push'](_0x4f6d51['shift']());}}}(_0xcde6,0x38d76));import{armor,unarmor}from'./encoding/armor';function _0xcde6(){const _0x436153=['text','Hash\x20algorithm\x20mismatch\x20in\x20armor\x20header\x20and\x20signature','2030664dYrcjq','read','1700116nydDWS','sign','isString','4723479KuzZlr','tag','zesuD','5pFbumk','Unknown\x20option:\x20','map','tyOQt','No\x20cleartext\x20signed\x20message.','vfmms','filter','signed','Invalid\x20signature\x20input','XPHVp','10PhKESW','length','toLowerCase','880130CIflDF','md5','dREdv','removeTrailingSpaces','Ruiza','bybDv','replace','issuerKeyID','push','Rgwln','join','type','concat','signature','constructor','Unknown\x20hash\x20algorithm\x20in\x20armor\x20header:\x20','eKfyU','filterByTag','keys','write','match','data','coHon','forEach','headers','armor','383677hqxOPH','eOgdY','VbWQx','3rkgccw','hash','getSigningKeyIDs','Only\x20\x22Hash\x22\x20header\x20allowed\x20in\x20cleartext\x20signed\x20message','createCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`text`','packet','rXfQF','setText','indexOf','hashAlgorithm','packets','toUpperCase','imDlv','split','getText','2143920pebDlJ','constructAllowedPackets','355721mlNCtE','lovVh','Emvlp'];_0xcde6=function(){return _0x436153;};return _0xcde6();}import _0x536a4e from'./enums';import _0x4345b6 from'./util';import{PacketList,LiteralDataPacket,SignaturePacket}from'./packet';import{Signature}from'./signature';import{createVerificationObjects,createSignaturePackets}from'./message';import _0x2d7265 from'./config';const allowedPackets=_0x4345b6[_0xb8dbed(0xe9)]([SignaturePacket]);export class CleartextMessage{constructor(_0x5140f6,_0x208af3){const _0x33507f=_0xb8dbed,_0x2e5f51={'eKfyU':function(_0x4fb71d,_0x178ade){return _0x4fb71d instanceof _0x178ade;},'zesuD':'Invalid\x20signature\x20input'};this['text']=_0x4345b6[_0x33507f(0xbf)](_0x5140f6)['replace'](/\r?\n/g,'\x0d\x0a');if(_0x208af3&&!_0x2e5f51[_0x33507f(0xcc)](_0x208af3,Signature))throw new Error(_0x2e5f51[_0x33507f(0xae)]);this['signature']=_0x208af3||new Signature(new PacketList());}[_0xb8dbed(0xdb)](){const _0x70d5c3=_0xb8dbed,_0x1b6a13=[],_0x25af8b=this[_0x70d5c3(0xc9)][_0x70d5c3(0xe3)];return _0x25af8b[_0x70d5c3(0xd3)](function(_0x3d8c3b){const _0x280c90=_0x70d5c3;_0x1b6a13[_0x280c90(0xc4)](_0x3d8c3b[_0x280c90(0xc3)]);}),_0x1b6a13;}async[_0xb8dbed(0xaa)](_0x592be1,_0xe14e48=null,_0x27e5bb=[],_0x235c7b=new Date(),_0x355c9f=[],_0x36c2c5=[],_0x144bfb=_0x2d7265){const _0x2915c4=_0xb8dbed,_0x55feb8={'rXfQF':function(_0x382ae9,_0x1bdb5c,_0x1b2244,_0x4ddf62,_0x4cfb0f,_0x3995af,_0xa1f816,_0x39800f,_0x3b079d,_0x42141d){return _0x382ae9(_0x1bdb5c,_0x1b2244,_0x4ddf62,_0x4cfb0f,_0x3995af,_0xa1f816,_0x39800f,_0x3b079d,_0x42141d);}},_0x2c7033=new LiteralDataPacket();_0x2c7033[_0x2915c4(0xe0)](this[_0x2915c4(0xed)]);const _0xa05962=new Signature(await _0x55feb8[_0x2915c4(0xdf)](createSignaturePackets,_0x2c7033,_0x592be1,_0xe14e48,_0x27e5bb,_0x235c7b,_0x355c9f,_0x36c2c5,!![],_0x144bfb));return new CleartextMessage(this[_0x2915c4(0xed)],_0xa05962);}['verify'](_0x5193a3,_0x4f1e0b=new Date(),_0x1cb3e3=_0x2d7265){const _0x4b850d=_0xb8dbed,_0x1172b7={'dREdv':function(_0x8df244,_0x576e6c,_0xf238b4,_0x296d5f,_0x2f3d8f,_0x35655,_0x1d4565){return _0x8df244(_0x576e6c,_0xf238b4,_0x296d5f,_0x2f3d8f,_0x35655,_0x1d4565);}},_0x243f2e=this['signature'][_0x4b850d(0xe3)][_0x4b850d(0xcd)](_0x536a4e['packet'][_0x4b850d(0xc9)]),_0x1c0716=new LiteralDataPacket();return _0x1c0716[_0x4b850d(0xe0)](this[_0x4b850d(0xed)]),_0x1172b7[_0x4b850d(0xbe)](createVerificationObjects,_0x243f2e,[_0x1c0716],_0x5193a3,_0x4f1e0b,!![],_0x1cb3e3);}[_0xb8dbed(0xe7)](){const _0x142740=_0xb8dbed;return this[_0x142740(0xed)][_0x142740(0xc2)](/\r\n/g,'\x0a');}['armor'](_0x25c997=_0x2d7265){const _0xcdb661=_0xb8dbed;let _0x42a6f4=this[_0xcdb661(0xc9)]['packets']['map'](function(_0x3da4f9){const _0x544d64=_0xcdb661;return _0x536a4e[_0x544d64(0xa8)](_0x536a4e[_0x544d64(0xda)],_0x3da4f9[_0x544d64(0xe2)])[_0x544d64(0xe4)]();});_0x42a6f4=_0x42a6f4[_0xcdb661(0xb5)](function(_0x2d770d,_0x4f1b2c,_0x51c5db){const _0x40b0dc=_0xcdb661;return _0x51c5db[_0x40b0dc(0xe1)](_0x2d770d)===_0x4f1b2c;});const _0x165a99={'hash':_0x42a6f4[_0xcdb661(0xc6)](),'text':this[_0xcdb661(0xed)],'data':this[_0xcdb661(0xc9)][_0xcdb661(0xe3)][_0xcdb661(0xcf)]()};return armor(_0x536a4e['armor'][_0xcdb661(0xb6)],_0x165a99,undefined,undefined,undefined,_0x25c997);}}function _0x1f8b(_0x32a884,_0x354be4){const _0xcde663=_0xcde6();return _0x1f8b=function(_0x1f8b29,_0x188ae4){_0x1f8b29=_0x1f8b29-0xa6;let _0x31c95b=_0xcde663[_0x1f8b29];return _0x31c95b;},_0x1f8b(_0x32a884,_0x354be4);}export async function readCleartextMessage({cleartextMessage:_0x287b20,config:_0x3bceed,..._0x17fa12}){const _0xc44a29=_0xb8dbed,_0x223868={'sNYEi':'readCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`cleartextMessage`','nElWQ':'readCleartextMessage:\x20options.cleartextMessage\x20must\x20be\x20a\x20string','Emvlp':function(_0x2babd3,_0x1f1741){return _0x2babd3!==_0x1f1741;},'Rgwln':function(_0x23acf6,_0x1ecfe8,_0x30b0b3){return _0x23acf6(_0x1ecfe8,_0x30b0b3);}};_0x3bceed={..._0x2d7265,..._0x3bceed};if(!_0x287b20)throw new Error(_0x223868['sNYEi']);if(!_0x4345b6[_0xc44a29(0xab)](_0x287b20))throw new Error(_0x223868['nElWQ']);const _0x7d1cb1=Object['keys'](_0x17fa12);if(_0x7d1cb1['length']>0x0)throw new Error('Unknown\x20option:\x20'+_0x7d1cb1['join'](',\x20'));const _0x325357=await unarmor(_0x287b20);if(_0x223868[_0xc44a29(0xec)](_0x325357[_0xc44a29(0xc7)],_0x536a4e[_0xc44a29(0xd5)][_0xc44a29(0xb6)]))throw new Error(_0xc44a29(0xb3));const _0x4724e0=await PacketList['fromBinary'](_0x325357[_0xc44a29(0xd1)],allowedPackets,_0x3bceed);_0x223868[_0xc44a29(0xc5)](verifyHeaders,_0x325357[_0xc44a29(0xd4)],_0x4724e0);const _0x2448b3=new Signature(_0x4724e0);return new CleartextMessage(_0x325357[_0xc44a29(0xed)],_0x2448b3);}function verifyHeaders(_0x323074,_0xec8026){const _0x4d956d=_0xb8dbed,_0x233171={'Sraie':function(_0x335ac3,_0xaec5c8){return _0x335ac3!==_0xaec5c8;},'vfmms':_0x4d956d(0xe5),'bybDv':function(_0x41c41d,_0x20eb39){return _0x41c41d===_0x20eb39;},'bJEYW':function(_0x1f176e,_0x1419a1){return _0x1f176e===_0x1419a1;},'esOSY':'qdBqr','coHon':'If\x20no\x20\x22Hash\x22\x20header\x20in\x20cleartext\x20signed\x20message,\x20then\x20only\x20MD5\x20signatures\x20allowed','VbWQx':function(_0x5cf5b0,_0x4b211a){return _0x5cf5b0(_0x4b211a);}},_0x2e7ca3=function(_0x20f14e){const _0x44a6a3=_0x4d956d;if(_0x233171['Sraie'](_0x44a6a3(0xd7),_0x233171[_0x44a6a3(0xb4)])){const _0x1c57fb=_0xe1f0eb=>_0x572723=>_0xe1f0eb['hashAlgorithm']===_0x572723;for(let _0xcf22b0=0x0;_0xcf22b0<_0xec8026[_0x44a6a3(0xba)];_0xcf22b0++){if(_0x233171[_0x44a6a3(0xc1)](_0xec8026[_0xcf22b0][_0x44a6a3(0xca)][_0x44a6a3(0xad)],_0x536a4e[_0x44a6a3(0xde)][_0x44a6a3(0xc9)])&&!_0x20f14e['some'](_0x1c57fb(_0xec8026[_0xcf22b0])))return _0x44a6a3(0xb2)===_0x44a6a3(0xb2)?![]:_0x2bddd1[_0x44a6a3(0xa8)](_0x4da65a[_0x44a6a3(0xda)],_0x1c7520['hashAlgorithm'])[_0x44a6a3(0xe4)]();}return!![];}else{let _0x181fc7=this[_0x44a6a3(0xc9)]['packets'][_0x44a6a3(0xb1)](function(_0x3860b0){const _0x52ff89=_0x44a6a3;return _0x4e08af[_0x52ff89(0xa8)](_0x12ccd4['hash'],_0x3860b0[_0x52ff89(0xe2)])['toUpperCase']();});_0x181fc7=_0x181fc7['filter'](function(_0x1e2035,_0xf6d9e1,_0x4739a4){const _0x77019f=_0x44a6a3;return _0x4739a4[_0x77019f(0xe1)](_0x1e2035)===_0xf6d9e1;});const _0x1158d4={'hash':_0x181fc7[_0x44a6a3(0xc6)](),'text':this[_0x44a6a3(0xed)],'data':this[_0x44a6a3(0xc9)]['packets'][_0x44a6a3(0xcf)]()};return _0x40f276(_0x33f417[_0x44a6a3(0xd5)][_0x44a6a3(0xb6)],_0x1158d4,_0x323a61,_0x4f2b7e,_0x54d4ff,_0x344668);}};let _0x93a813=null,_0xdd895c=[];_0x323074[_0x4d956d(0xd3)](function(_0x13ee1e){const _0x5b46fc=_0x4d956d,_0x4e9cdb={'KOCHC':function(_0x48000d,_0x236920){return _0x48000d instanceof _0x236920;},'ZUGxO':_0x5b46fc(0xb7),'NlWui':function(_0xa0d009,_0x206d79){return _0x233171['bJEYW'](_0xa0d009,_0x206d79);},'lovVh':_0x233171['esOSY']};_0x93a813=_0x13ee1e[_0x5b46fc(0xd0)](/Hash: (.+)/);if(_0x93a813)_0x93a813=_0x93a813[0x1][_0x5b46fc(0xc2)](/\s/g,''),_0x93a813=_0x93a813[_0x5b46fc(0xe6)](','),_0x93a813=_0x93a813[_0x5b46fc(0xb1)](function(_0x2459af){const _0x5e59be=_0x5b46fc,_0x3508bf={'Ruiza':function(_0xcac814,_0x217901){return _0x4e9cdb['KOCHC'](_0xcac814,_0x217901);},'XPHVp':_0x4e9cdb['ZUGxO']};if(_0x4e9cdb['NlWui'](_0x4e9cdb[_0x5e59be(0xeb)],'qdBqr')){_0x2459af=_0x2459af[_0x5e59be(0xbb)]();try{return _0x536a4e[_0x5e59be(0xcf)](_0x536a4e[_0x5e59be(0xda)],_0x2459af);}catch(_0xe9772){throw new Error(_0x5e59be(0xcb)+_0x2459af);}}else{this[_0x5e59be(0xed)]=_0x530937[_0x5e59be(0xbf)](_0x5ac3d7)[_0x5e59be(0xc2)](/\r?\n/g,'\x0d\x0a');if(_0x108a39&&!_0x3508bf[_0x5e59be(0xc0)](_0x1c94e1,_0x8575ed))throw new _0x2a3015(_0x3508bf[_0x5e59be(0xb8)]);this[_0x5e59be(0xc9)]=_0xd50a48||new _0x1d0237(new _0x10bf91());}}),_0xdd895c=_0xdd895c[_0x5b46fc(0xc8)](_0x93a813);else throw new Error(_0x5b46fc(0xdc));});if(!_0xdd895c['length']&&!_0x2e7ca3([_0x536a4e[_0x4d956d(0xda)][_0x4d956d(0xbd)]]))throw new Error(_0x233171[_0x4d956d(0xd2)]);else{if(_0xdd895c[_0x4d956d(0xba)]&&!_0x233171[_0x4d956d(0xd8)](_0x2e7ca3,_0xdd895c))throw new Error(_0x4d956d(0xa6));}}export async function createCleartextMessage({text:_0x4dd461,..._0x1e617a}){const _0x50707b=_0xb8dbed,_0x1a53c1={'WuYBx':_0x50707b(0xdd)};if(!_0x4dd461)throw new Error(_0x1a53c1['WuYBx']);if(!_0x4345b6[_0x50707b(0xab)](_0x4dd461))throw new Error('createCleartextMessage:\x20options.text\x20must\x20be\x20a\x20string');const _0x14e365=Object[_0x50707b(0xce)](_0x1e617a);if(_0x14e365[_0x50707b(0xba)]>0x0)throw new Error(_0x50707b(0xb0)+_0x14e365[_0x50707b(0xc6)](',\x20'));return new CleartextMessage(_0x4dd461);}