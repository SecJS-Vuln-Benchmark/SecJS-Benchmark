function _0x40a6(){const _0x3b5c2e=['aad','randomFillSync','xUuWZ','1725925hiBVls','header','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','GKuEF','3wHQNFo','A128CBC-HS256','encrypted_key','QWhUr','JOSE\x20Header\x20missing','encrypt','The\x20Fellowship\x20of\x20the\x20Ring','setKeyManagementParameters','plaintext','wEGUd','throwsAsync','IzMYv','foo','Flattened\x20JWE\x20must\x20be\x20an\x20object','bIUOw','#dist','JWE\x20Encrypted\x20Key\x20incorrect\x20type','JWE\x20Protected\x20Header\x20is\x20invalid','unprotected','context','additionalAuthenticatedData','slice','KzGww','dir','ERR_JWE_DECRYPTION_FAILED','JWE\x20Protected,\x20JWE\x20Unprotected\x20Header,\x20and\x20JWE\x20Per-Recipient\x20Unprotected\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','JWE\x20AAD\x20incorrect\x20type','set','pfmpI','1619520NPIoaX','missing\x20JWE\x20Algorithm\x20(alg)\x20in\x20JWE\x20Header','setProtectedHeader','8896264BrTANu','Vdqnh','encode','A128GCM','xYNPG','setAdditionalAuthenticatedData','7viAQVv','68VuTwVL','PBES2-HS256+A128KW','134618oPrgyl','aXpqD','ciphertext','ERR_JWE_INVALID','secret','xTHGZ','3151984JXBywg','srjgD','decryption\x20operation\x20failed','prototype','HPzKN','setSharedUnprotectedHeader','setUnprotectedHeader','Encountered\x20unexpected\x20JWE\x20Encrypted\x20Key','2339556SSAmAS','bind','117462SLupNh','JWE\x20Shared\x20Unprotected\x20Header\x20incorrect\x20type','9wvPwOM','JWE\x20Per-Recipient\x20Unprotected\x20Header\x20incorrect\x20type','JWE\x20Ciphertext\x20missing\x20or\x20incorrect\x20type','JWE\x20Protected\x20Header\x20incorrect\x20type','decrypt\x20PBES2\x20p2c\x20limit','before','bar','protected','zxFrx','mQFBr','JWE\x20Initialization\x20Vector\x20missing\x20or\x20incorrect\x20type','CbIaS','epnUq','UcxWx','tag'];_0x40a6=function(){return _0x3b5c2e;};return _0x40a6();}const _0x50b8fc=_0x983b;(function(_0x19af72,_0x314648){const _0x25d8b0=_0x983b,_0x466479=_0x19af72();while(!![]){try{const _0x4802e2=parseInt(_0x25d8b0(0x19a))/0x1*(parseInt(_0x25d8b0(0x1c3))/0x2)+parseInt(_0x25d8b0(0x1d3))/0x3*(-parseInt(_0x25d8b0(0x1c1))/0x4)+-parseInt(_0x25d8b0(0x1e7))/0x5+parseInt(_0x25d8b0(0x1d1))/0x6*(parseInt(_0x25d8b0(0x1c0))/0x7)+-parseInt(_0x25d8b0(0x1ba))/0x8*(-parseInt(_0x25d8b0(0x1d5))/0x9)+parseInt(_0x25d8b0(0x1b7))/0xa+-parseInt(_0x25d8b0(0x1c9))/0xb;if(_0x4802e2===_0x314648)break;else _0x466479['push'](_0x466479['shift']());}catch(_0x45ec84){_0x466479['push'](_0x466479['shift']());}}}(_0x40a6,0x8acab));function _0x983b(_0x2edf0f,_0x5e088d){const _0x40a696=_0x40a6();return _0x983b=function(_0x983b8c,_0x4663f5){_0x983b8c=_0x983b8c-0x197;let _0x3eea58=_0x40a696[_0x983b8c];return _0x3eea58;},_0x983b(_0x2edf0f,_0x5e088d);}import _0xd404e0 from'ava';import*as _0x26f60f from'crypto';const {FlattenedEncrypt,flattenedDecrypt}=await import(_0x50b8fc(0x1a9));_0xd404e0[_0x50b8fc(0x1da)](async _0x2bd8c2=>{const _0x4669a1=_0x50b8fc,_0x1cf031={'pfmpI':'Itâ€™s\x20a\x20dangerous\x20business,\x20Frodo,\x20going\x20out\x20your\x20door.','Vdqnh':_0x4669a1(0x1a0)},_0x4918f1=TextEncoder[_0x4669a1(0x1cc)][_0x4669a1(0x1bc)][_0x4669a1(0x1d2)](new TextEncoder());_0x2bd8c2[_0x4669a1(0x1ad)]['plaintext']=_0x4918f1(_0x1cf031[_0x4669a1(0x1b6)]),_0x2bd8c2[_0x4669a1(0x1ad)][_0x4669a1(0x1ae)]=_0x4918f1(_0x1cf031[_0x4669a1(0x1bb)]),_0x2bd8c2[_0x4669a1(0x1ad)]['initializationVector']=new Uint8Array(0xc),_0x2bd8c2[_0x4669a1(0x1ad)][_0x4669a1(0x1c7)]=new Uint8Array(0x10);}),_0xd404e0('JWE\x20format\x20validation',async _0x2dd3a5=>{const _0xd60ef=_0x50b8fc,_0x3fa923={'QWhUr':_0xd60ef(0x1a7),'mQFBr':_0xd60ef(0x1c6),'IzMYv':function(_0x42cd2e,_0x14aa66,_0x390f5c){return _0x42cd2e(_0x14aa66,_0x390f5c);},'xYNPG':function(_0x53fcf4,_0x10c738,_0x4c0d12){return _0x53fcf4(_0x10c738,_0x4c0d12);},'VLDwq':_0xd60ef(0x1d7),'aXpqD':'JWE\x20Authentication\x20Tag\x20missing\x20or\x20incorrect\x20type','GKuEF':function(_0x38884f,_0x3fc564,_0x16ae31){return _0x38884f(_0x3fc564,_0x16ae31);},'wEGUd':function(_0x1ea43a,_0x504000,_0x497740){return _0x1ea43a(_0x504000,_0x497740);},'CbIaS':_0xd60ef(0x1b4),'xTHGZ':_0xd60ef(0x1d4),'ZNgWk':function(_0x231969,_0x212ddb,_0x262fae){return _0x231969(_0x212ddb,_0x262fae);},'epnUq':_0xd60ef(0x1bd),'KzGww':_0xd60ef(0x1b8),'bIUOw':'missing\x20JWE\x20Encryption\x20Algorithm\x20(enc)\x20in\x20JWE\x20Header','bInjO':_0xd60ef(0x1a6),'zxFrx':_0xd60ef(0x1d0)},_0x5b722b=await new FlattenedEncrypt(_0x2dd3a5[_0xd60ef(0x1ad)]['plaintext'])['setProtectedHeader']({'bar':'baz'})[_0xd60ef(0x1cf)]({'foo':_0xd60ef(0x1db)})[_0xd60ef(0x1ce)]({'alg':_0xd60ef(0x1b1),'enc':_0xd60ef(0x1bd)})[_0xd60ef(0x1bf)](_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1ae)])[_0xd60ef(0x19f)](_0x2dd3a5['context'][_0xd60ef(0x1c7)]);{await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(null,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),{'message':_0x3fa923[_0xd60ef(0x19d)],'code':_0x3fa923['mQFBr']});}{const _0x2c8e0c={..._0x5b722b};delete _0x2c8e0c[_0xd60ef(0x1dc)],delete _0x2c8e0c[_0xd60ef(0x197)],delete _0x2c8e0c[_0xd60ef(0x1ac)],await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x1a5)](flattenedDecrypt,_0x2c8e0c,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),{'message':_0xd60ef(0x19e),'code':_0xd60ef(0x1c6)});}{const _0x4531de={..._0x5b722b};delete _0x4531de['iv'];const _0x19780a={'message':_0xd60ef(0x1df),'code':_0x3fa923[_0xd60ef(0x1de)]};await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x1be)](flattenedDecrypt,_0x4531de,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x19780a),_0x4531de['iv']=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x4531de,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x19780a);}{const _0x23e66f={..._0x5b722b};delete _0x23e66f[_0xd60ef(0x1c5)];const _0x10f07a={'message':_0x3fa923['VLDwq'],'code':'ERR_JWE_INVALID'};await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x1a5)](flattenedDecrypt,_0x23e66f,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),_0x10f07a),_0x23e66f[_0xd60ef(0x1c5)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x23e66f,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x10f07a);}{const _0x4fea73={..._0x5b722b};delete _0x4fea73[_0xd60ef(0x1e3)];const _0x43b199={'message':_0x3fa923[_0xd60ef(0x1c4)],'code':_0x3fa923['mQFBr']};await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x199)](flattenedDecrypt,_0x4fea73,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x43b199),_0x4fea73[_0xd60ef(0x1e3)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x4fea73,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x43b199);}{const _0x5100f2={..._0x5b722b};_0x5100f2[_0xd60ef(0x1dc)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x5100f2,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),{'message':_0xd60ef(0x1d8),'code':_0x3fa923[_0xd60ef(0x1de)]});}{const _0x4557ff={..._0x5b722b},_0x204ca3={'message':_0xd60ef(0x1ab),'code':_0xd60ef(0x1c6)};_0x4557ff[_0xd60ef(0x1dc)]='1'+_0x4557ff['protected'],await _0x2dd3a5['throwsAsync'](_0x3fa923['wEGUd'](flattenedDecrypt,_0x4557ff,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),_0x204ca3);}{const _0x517765={..._0x5b722b};_0x517765[_0xd60ef(0x19c)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x517765,_0x2dd3a5['context'][_0xd60ef(0x1c7)]),{'message':_0xd60ef(0x1aa),'code':_0x3fa923['mQFBr']});}{const _0x451712={..._0x5b722b};_0x451712[_0xd60ef(0x1e4)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x451712,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),{'message':_0x3fa923[_0xd60ef(0x1e0)],'code':_0x3fa923[_0xd60ef(0x1de)]});}{const _0x4cdd64={..._0x5b722b};_0x4cdd64[_0xd60ef(0x197)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x4cdd64,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),{'message':_0x3fa923[_0xd60ef(0x1c8)],'code':_0x3fa923['mQFBr']});}{const _0x254bd6={..._0x5b722b};_0x254bd6[_0xd60ef(0x1ac)]=null,await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x1a3)](flattenedDecrypt,_0x254bd6,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),{'message':_0xd60ef(0x1d6),'code':_0xd60ef(0x1c6)});}{const _0x10a02c={..._0x5b722b};_0x10a02c[_0xd60ef(0x1ac)]={'foo':_0xd60ef(0x1db)},await _0x2dd3a5['throwsAsync'](_0x3fa923['ZNgWk'](flattenedDecrypt,_0x10a02c,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),{'message':_0xd60ef(0x1b3),'code':_0xd60ef(0x1c6)});}{const _0x2cde3f={..._0x5b722b};_0x2cde3f['unprotected']={'enc':_0x3fa923[_0xd60ef(0x1e1)]},await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x2cde3f,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),{'message':_0x3fa923[_0xd60ef(0x1b0)],'code':_0x3fa923[_0xd60ef(0x1de)]});}{const _0x46d73f={..._0x5b722b};_0x46d73f[_0xd60ef(0x1ac)]={'alg':_0xd60ef(0x1b1)},await _0x2dd3a5[_0xd60ef(0x1a4)](_0x3fa923[_0xd60ef(0x199)](flattenedDecrypt,_0x46d73f,_0x2dd3a5[_0xd60ef(0x1ad)]['secret']),{'message':_0x3fa923[_0xd60ef(0x1a8)],'code':_0xd60ef(0x1c6)});}{const _0x3997cd={..._0x5b722b};_0x3997cd[_0xd60ef(0x19c)]=_0x3fa923['bInjO'],await _0x2dd3a5[_0xd60ef(0x1a4)](flattenedDecrypt(_0x3997cd,_0x2dd3a5[_0xd60ef(0x1ad)][_0xd60ef(0x1c7)]),{'message':_0x3fa923[_0xd60ef(0x1dd)],'code':_0x3fa923['mQFBr']});}}),_0xd404e0('AES\x20CBC\x20+\x20HMAC',async _0x579a30=>{const _0x5af74a=_0x50b8fc,_0x1c6790={'OXMsu':'dir','UcxWx':'A128CBC-HS256','pHOwy':_0x5af74a(0x1a6),'LSVlU':function(_0x202e08,_0x420cb3,_0x17a1ef){return _0x202e08(_0x420cb3,_0x17a1ef);},'HPzKN':_0x5af74a(0x1cb),'xUuWZ':function(_0x4c7dc5,_0x48a352,_0x23eac6){return _0x4c7dc5(_0x48a352,_0x23eac6);}},_0x636664=_0x26f60f[_0x5af74a(0x1e5)](new Uint8Array(0x20)),_0x1580db=await new FlattenedEncrypt(_0x579a30[_0x5af74a(0x1ad)][_0x5af74a(0x1a2)])[_0x5af74a(0x1b9)]({'alg':_0x1c6790['OXMsu'],'enc':_0x1c6790[_0x5af74a(0x1e2)]})['encrypt'](_0x636664);{const _0x56fbd1={..._0x1580db};_0x56fbd1[_0x5af74a(0x1e3)]=_0x1c6790['pHOwy'],await _0x579a30[_0x5af74a(0x1a4)](_0x1c6790['LSVlU'](flattenedDecrypt,_0x56fbd1,_0x636664),{'code':_0x5af74a(0x1b2),'message':_0x1c6790[_0x5af74a(0x1cd)]});}{const _0x4fb4ee={..._0x1580db};_0x4fb4ee['ciphertext']=_0x1c6790['pHOwy'],await _0x579a30[_0x5af74a(0x1a4)](_0x1c6790['LSVlU'](flattenedDecrypt,_0x4fb4ee,_0x636664),{'code':_0x5af74a(0x1b2),'message':_0x1c6790[_0x5af74a(0x1cd)]});}{const _0x2882fb=new Uint8Array(0x20);_0x2882fb[_0x5af74a(0x1b5)](_0x636664[_0x5af74a(0x1af)](0x0,0x10),0x10),_0x2882fb['set'](_0x636664[_0x5af74a(0x1af)](0x10),0x0),await _0x579a30['throwsAsync'](_0x1c6790[_0x5af74a(0x1e6)](flattenedDecrypt,_0x1580db,_0x2882fb),{'code':_0x5af74a(0x1b2),'message':'decryption\x20operation\x20failed'});}}),_0xd404e0(_0x50b8fc(0x1d9),async _0x7250e1=>{const _0x111053=_0x50b8fc,_0x5425a6={'srjgD':'ERR_JWE_INVALID'},_0x5411b5=await new FlattenedEncrypt(new Uint8Array(0x0))['setProtectedHeader']({'alg':_0x111053(0x1c2),'enc':_0x111053(0x19b)})[_0x111053(0x1a1)]({'p2c':0x801})['encrypt'](new Uint8Array(0x20));await _0x7250e1['throwsAsync'](flattenedDecrypt(_0x5411b5,new Uint8Array(0x20),{'maxPBES2Count':0x800}),{'message':_0x111053(0x198),'code':_0x5425a6[_0x111053(0x1ca)]});});