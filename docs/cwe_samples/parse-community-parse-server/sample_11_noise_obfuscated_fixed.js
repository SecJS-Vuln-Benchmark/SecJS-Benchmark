const _0x5f2c4c=_0x5dd1;function _0x5dd1(_0x43fac0,_0x4f2ba0){const _0x292af8=_0x292a();return _0x5dd1=function(_0x5dd1d6,_0x303d79){_0x5dd1d6=_0x5dd1d6-0x116;let _0x5a1910=_0x292af8[_0x5dd1d6];return _0x5a1910;},_0x5dd1(_0x43fac0,_0x4f2ba0);}(function(_0x21bce6,_0x4ca4aa){const _0x1e9165=_0x5dd1,_0x411a7e=_0x21bce6();while(!![]){try{const _0x158ddc=parseInt(_0x1e9165(0x14c))/0x1*(parseInt(_0x1e9165(0x123))/0x2)+-parseInt(_0x1e9165(0x13a))/0x3+-parseInt(_0x1e9165(0x11b))/0x4*(-parseInt(_0x1e9165(0x12b))/0x5)+-parseInt(_0x1e9165(0x15c))/0x6*(-parseInt(_0x1e9165(0x149))/0x7)+parseInt(_0x1e9165(0x13c))/0x8+parseInt(_0x1e9165(0x15f))/0x9+-parseInt(_0x1e9165(0x15d))/0xa;if(_0x158ddc===_0x4ca4aa)break;else _0x411a7e['push'](_0x411a7e['shift']());}catch(_0x17951f){_0x411a7e['push'](_0x411a7e['shift']());}}}(_0x292a,0xd18d7));import _0x3f24d7 from'ava';function _0x292a(){const _0x1e80b0=['2522784pXpozA','additionalAuthenticatedData','12455800qholxa','A128GCM','JWE\x20Authentication\x20Tag\x20missing\x20or\x20incorrect\x20type','DETEs','sIWrT','setUnprotectedHeader','PBES2-HS256+A128KW','JWE\x20Per-Recipient\x20Unprotected\x20Header\x20incorrect\x20type','CxmJY','aad','AES\x20CBC\x20+\x20HMAC','unprotected','aHGZQ','10451awlkqt','protected','Gyikr','31CLtYEg','foo','JWE\x20Protected\x20Header\x20incorrect\x20type','hvaOc','JWE\x20Ciphertext\x20missing\x20or\x20incorrect\x20type','JWE\x20AAD\x20incorrect\x20type','set','decompression\x20operation\x20failed','initializationVector','before','throwsAsync','ERR_JWE_DECRYPTION_FAILED','JOSE\x20Header\x20missing','ciphertext','header','decrypt\x20inflate\x20output\x20length\x20limit','3114oBvVor','28638820keVkNd','bIdjb','3890763gvJQVq','decrypt\x20PBES2\x20p2c\x20limit','rwxkZ','tag','JWE\x20Protected\x20Header\x20is\x20invalid','HXNsf','A128CBC-HS256','prototype','DEF','CzCvN','LqAaT','1617492UZUnpi','etuje','setProtectedHeader','dir','decryption\x20operation\x20failed','plaintext','Itâ€™s\x20a\x20dangerous\x20business,\x20Frodo,\x20going\x20out\x20your\x20door.','FiQuj','37798KCphDt','Leasb','bar','encode','context','ERR_JWE_DECOMPRESSION_FAILED','missing\x20JWE\x20Encryption\x20Algorithm\x20(enc)\x20in\x20JWE\x20Header','encrypt','15XXVpPJ','Encountered\x20unexpected\x20JWE\x20Encrypted\x20Key','ilVZz','myHVk','encrypted_key','Cbaay','bWfXS','ERR_JWE_INVALID','slice','setSharedUnprotectedHeader','baz','RkaIt','secret','missing\x20JWE\x20Algorithm\x20(alg)\x20in\x20JWE\x20Header','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds'];_0x292a=function(){return _0x1e80b0;};return _0x292a();}import*as _0x4a5fa6 from'crypto';import{promisify}from'node:util';import{inflateRaw as _0x4b7c57}from'node:zlib';const {FlattenedEncrypt,flattenedDecrypt}=await import('#dist');_0x3f24d7[_0x5f2c4c(0x155)](async _0x576fb8=>{const _0x5c1d78=_0x5f2c4c,_0x48d128={'aHGZQ':'The\x20Fellowship\x20of\x20the\x20Ring'},_0x343c6a=TextEncoder[_0x5c1d78(0x117)][_0x5c1d78(0x126)]['bind'](new TextEncoder());_0x576fb8[_0x5c1d78(0x127)]['plaintext']=_0x343c6a(_0x5c1d78(0x121)),_0x576fb8[_0x5c1d78(0x127)][_0x5c1d78(0x13b)]=_0x343c6a(_0x48d128[_0x5c1d78(0x148)]),_0x576fb8[_0x5c1d78(0x127)][_0x5c1d78(0x154)]=new Uint8Array(0xc),_0x576fb8[_0x5c1d78(0x127)][_0x5c1d78(0x137)]=new Uint8Array(0x10);}),_0x3f24d7('JWE\x20format\x20validation',async _0x59aad2=>{const _0x408526=_0x5f2c4c,_0x4b4def={'DETEs':_0x408526(0x135),'bWfXS':_0x408526(0x11e),'hvaOc':_0x408526(0x13d),'XcUhH':'Flattened\x20JWE\x20must\x20be\x20an\x20object','CzCvN':_0x408526(0x132),'Gyikr':_0x408526(0x158),'Cbaay':function(_0x602950,_0x4ba11e,_0x317162){return _0x602950(_0x4ba11e,_0x317162);},'FTzQF':function(_0x563691,_0x3fe450,_0xb02774){return _0x563691(_0x3fe450,_0xb02774);},'etuje':'JWE\x20Shared\x20Unprotected\x20Header\x20incorrect\x20type','LqAaT':_0x408526(0x129),'QGaXF':_0x408526(0x12c)},_0x37fe91=await new FlattenedEncrypt(_0x59aad2[_0x408526(0x127)][_0x408526(0x120)])[_0x408526(0x11d)]({'bar':_0x4b4def[_0x408526(0x13f)]})[_0x408526(0x141)]({'foo':_0x408526(0x125)})[_0x408526(0x134)]({'alg':_0x4b4def[_0x408526(0x131)],'enc':_0x4b4def[_0x408526(0x14f)]})['setAdditionalAuthenticatedData'](_0x59aad2[_0x408526(0x127)]['additionalAuthenticatedData'])['encrypt'](_0x59aad2[_0x408526(0x127)]['secret']);{await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(null,_0x59aad2['context'][_0x408526(0x137)]),{'message':_0x4b4def['XcUhH'],'code':_0x4b4def[_0x408526(0x119)]});}{const _0x1cbd8c={..._0x37fe91};delete _0x1cbd8c[_0x408526(0x14a)],delete _0x1cbd8c[_0x408526(0x15a)],delete _0x1cbd8c[_0x408526(0x147)],await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x1cbd8c,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x4b4def[_0x408526(0x14b)],'code':_0x408526(0x132)});}{const _0x4bf85d={..._0x37fe91};delete _0x4bf85d['iv'];const _0x3855c0={'message':'JWE\x20Initialization\x20Vector\x20missing\x20or\x20incorrect\x20type','code':_0x4b4def[_0x408526(0x119)]};await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x4bf85d,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),_0x3855c0),_0x4bf85d['iv']=null,await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x4bf85d,_0x59aad2['context']['secret']),_0x3855c0);}{const _0x2d5f28={..._0x37fe91};delete _0x2d5f28[_0x408526(0x159)];const _0x4faf54={'message':_0x408526(0x150),'code':_0x4b4def[_0x408526(0x119)]};await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x2d5f28,_0x59aad2['context'][_0x408526(0x137)]),_0x4faf54),_0x2d5f28['ciphertext']=null,await _0x59aad2[_0x408526(0x156)](_0x4b4def['Cbaay'](flattenedDecrypt,_0x2d5f28,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),_0x4faf54);}{const _0x30a192={..._0x37fe91};delete _0x30a192[_0x408526(0x162)];const _0x11ca00={'message':_0x408526(0x13e),'code':'ERR_JWE_INVALID'};await _0x59aad2[_0x408526(0x156)](_0x4b4def['FTzQF'](flattenedDecrypt,_0x30a192,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),_0x11ca00),_0x30a192[_0x408526(0x162)]=null,await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x30a192,_0x59aad2[_0x408526(0x127)]['secret']),_0x11ca00);}{const _0x27dda7={..._0x37fe91};_0x27dda7[_0x408526(0x14a)]=null,await _0x59aad2['throwsAsync'](flattenedDecrypt(_0x27dda7,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x408526(0x14e),'code':_0x4b4def[_0x408526(0x119)]});}{const _0x1a1269={..._0x37fe91},_0x27b525={'message':_0x408526(0x163),'code':_0x408526(0x132)};_0x1a1269[_0x408526(0x14a)]='1'+_0x1a1269[_0x408526(0x14a)],await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x1a1269,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),_0x27b525);}{const _0x28ef40={..._0x37fe91};_0x28ef40['encrypted_key']=null,await _0x59aad2[_0x408526(0x156)](_0x4b4def[_0x408526(0x130)](flattenedDecrypt,_0x28ef40,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':'JWE\x20Encrypted\x20Key\x20incorrect\x20type','code':_0x4b4def[_0x408526(0x119)]});}{const _0x99c7c4={..._0x37fe91};_0x99c7c4[_0x408526(0x145)]=null,await _0x59aad2['throwsAsync'](_0x4b4def[_0x408526(0x130)](flattenedDecrypt,_0x99c7c4,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x408526(0x151),'code':_0x408526(0x132)});}{const _0x123986={..._0x37fe91};_0x123986['header']=null,await _0x59aad2[_0x408526(0x156)](_0x4b4def['FTzQF'](flattenedDecrypt,_0x123986,_0x59aad2[_0x408526(0x127)]['secret']),{'message':_0x4b4def[_0x408526(0x11c)],'code':_0x4b4def[_0x408526(0x119)]});}{const _0x31f1ea={..._0x37fe91};_0x31f1ea[_0x408526(0x147)]=null,await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x31f1ea,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x408526(0x143),'code':_0x4b4def[_0x408526(0x119)]});}{const _0x4f0cf2={..._0x37fe91};_0x4f0cf2[_0x408526(0x147)]={'foo':_0x408526(0x125)},await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x4f0cf2,_0x59aad2['context'][_0x408526(0x137)]),{'message':'JWE\x20Protected,\x20JWE\x20Unprotected\x20Header,\x20and\x20JWE\x20Per-Recipient\x20Unprotected\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','code':_0x4b4def['CzCvN']});}{const _0x2b9d7a={..._0x37fe91};_0x2b9d7a[_0x408526(0x147)]={'enc':_0x408526(0x13d)},await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x2b9d7a,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x408526(0x138),'code':_0x4b4def[_0x408526(0x119)]});}{const _0x3d47e3={..._0x37fe91};_0x3d47e3[_0x408526(0x147)]={'alg':_0x408526(0x11e)},await _0x59aad2['throwsAsync'](flattenedDecrypt(_0x3d47e3,_0x59aad2['context'][_0x408526(0x137)]),{'message':_0x4b4def[_0x408526(0x11a)],'code':_0x4b4def[_0x408526(0x119)]});}{const _0x5cd8f8={..._0x37fe91};_0x5cd8f8[_0x408526(0x12f)]=_0x408526(0x14d),await _0x59aad2[_0x408526(0x156)](flattenedDecrypt(_0x5cd8f8,_0x59aad2[_0x408526(0x127)][_0x408526(0x137)]),{'message':_0x4b4def['QGaXF'],'code':_0x4b4def[_0x408526(0x119)]});}}),_0x3f24d7(_0x5f2c4c(0x146),async _0x3f2e03=>{const _0x54f2c7=_0x5f2c4c,_0x1a7c5a={'sIWrT':_0x54f2c7(0x14d),'Leasb':function(_0x56db27,_0x45be76,_0x2efa99){return _0x56db27(_0x45be76,_0x2efa99);},'ilVZz':_0x54f2c7(0x11f),'myHVk':'ERR_JWE_DECRYPTION_FAILED'},_0x247f6b=_0x4a5fa6['randomFillSync'](new Uint8Array(0x20)),_0x3beb23=await new FlattenedEncrypt(_0x3f2e03[_0x54f2c7(0x127)][_0x54f2c7(0x120)])[_0x54f2c7(0x11d)]({'alg':_0x54f2c7(0x11e),'enc':_0x54f2c7(0x116)})[_0x54f2c7(0x12a)](_0x247f6b);{const _0x3eb17e={..._0x3beb23};_0x3eb17e[_0x54f2c7(0x162)]=_0x1a7c5a[_0x54f2c7(0x140)],await _0x3f2e03['throwsAsync'](flattenedDecrypt(_0x3eb17e,_0x247f6b),{'code':_0x54f2c7(0x157),'message':'decryption\x20operation\x20failed'});}{const _0xd2c338={..._0x3beb23};_0xd2c338[_0x54f2c7(0x159)]=_0x1a7c5a['sIWrT'],await _0x3f2e03[_0x54f2c7(0x156)](_0x1a7c5a[_0x54f2c7(0x124)](flattenedDecrypt,_0xd2c338,_0x247f6b),{'code':_0x54f2c7(0x157),'message':_0x1a7c5a[_0x54f2c7(0x12d)]});}{const _0x25d171=new Uint8Array(0x20);_0x25d171[_0x54f2c7(0x152)](_0x247f6b[_0x54f2c7(0x133)](0x0,0x10),0x10),_0x25d171[_0x54f2c7(0x152)](_0x247f6b[_0x54f2c7(0x133)](0x10),0x0),await _0x3f2e03[_0x54f2c7(0x156)](flattenedDecrypt(_0x3beb23,_0x25d171),{'code':_0x1a7c5a[_0x54f2c7(0x12e)],'message':_0x1a7c5a[_0x54f2c7(0x12d)]});}}),_0x3f24d7(_0x5f2c4c(0x160),async _0x371251=>{const _0x19bad8=_0x5f2c4c,_0x33e390={'CxmJY':_0x19bad8(0x142),'TYtPh':_0x19bad8(0x132)},_0x430a70=await new FlattenedEncrypt(new Uint8Array(0x0))['setProtectedHeader']({'alg':_0x33e390[_0x19bad8(0x144)],'enc':_0x19bad8(0x116)})['setKeyManagementParameters']({'p2c':0x801})[_0x19bad8(0x12a)](new Uint8Array(0x20));await _0x371251[_0x19bad8(0x156)](flattenedDecrypt(_0x430a70,new Uint8Array(0x20),{'maxPBES2Count':0x800}),{'message':_0x19bad8(0x139),'code':_0x33e390['TYtPh']});}),_0x3f24d7(_0x5f2c4c(0x15b),async _0x34ed84=>{const _0x2ab6d4=_0x5f2c4c,_0x5c0fcc={'HXNsf':_0x2ab6d4(0x118),'rwxkZ':function(_0x4a88d0,_0x4c12de){return _0x4a88d0+_0x4c12de;},'bIdjb':_0x2ab6d4(0x116),'FiQuj':function(_0x1adc66,_0x1805c0,_0x57045d){return _0x1adc66(_0x1805c0,_0x57045d);},'RkaIt':_0x2ab6d4(0x153),'cfMPb':function(_0x38c8a7,_0x246548){return _0x38c8a7+_0x246548;}};{const _0x4b5698=await new FlattenedEncrypt(new Uint8Array(0x3d090))['setProtectedHeader']({'alg':_0x2ab6d4(0x11e),'enc':_0x2ab6d4(0x116),'zip':_0x5c0fcc[_0x2ab6d4(0x164)]})[_0x2ab6d4(0x12a)](new Uint8Array(0x20));await flattenedDecrypt(_0x4b5698,new Uint8Array(0x20));}{const _0x2377d1=await new FlattenedEncrypt(new Uint8Array(_0x5c0fcc[_0x2ab6d4(0x161)](0x3d090,0x1)))[_0x2ab6d4(0x11d)]({'alg':_0x2ab6d4(0x11e),'enc':_0x5c0fcc[_0x2ab6d4(0x15e)],'zip':_0x5c0fcc[_0x2ab6d4(0x164)]})['encrypt'](new Uint8Array(0x20));await _0x34ed84[_0x2ab6d4(0x156)](_0x5c0fcc[_0x2ab6d4(0x122)](flattenedDecrypt,_0x2377d1,new Uint8Array(0x20)),{'message':_0x5c0fcc[_0x2ab6d4(0x136)],'code':_0x2ab6d4(0x128)});}{const _0x3b5a39=await new FlattenedEncrypt(new Uint8Array(_0x5c0fcc['cfMPb'](0x3e8,0x1)))[_0x2ab6d4(0x11d)]({'alg':_0x2ab6d4(0x11e),'enc':_0x5c0fcc[_0x2ab6d4(0x15e)],'zip':'DEF'})[_0x2ab6d4(0x12a)](new Uint8Array(0x20)),_0x264d08=promisify(_0x4b7c57),_0x27d7a2=async _0x2c55ec=>_0x264d08(_0x2c55ec,{'maxOutputLength':0x3e8});await _0x34ed84[_0x2ab6d4(0x156)](flattenedDecrypt(_0x3b5a39,new Uint8Array(0x20),{'inflateRaw':_0x27d7a2}),{'code':'ERR_BUFFER_TOO_LARGE'});}});