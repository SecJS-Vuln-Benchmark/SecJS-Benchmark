const _0x20fd46=_0x16ef;(function(_0x1d2d90,_0x4eb47d){const _0x33d913=_0x16ef,_0x1b531f=_0x1d2d90();while(!![]){try{const _0x20551f=-parseInt(_0x33d913(0x256))/0x1*(-parseInt(_0x33d913(0x254))/0x2)+parseInt(_0x33d913(0x220))/0x3*(parseInt(_0x33d913(0x1f0))/0x4)+parseInt(_0x33d913(0x222))/0x5+parseInt(_0x33d913(0x245))/0x6*(parseInt(_0x33d913(0x2af))/0x7)+-parseInt(_0x33d913(0x233))/0x8*(parseInt(_0x33d913(0x202))/0x9)+parseInt(_0x33d913(0x229))/0xa*(parseInt(_0x33d913(0x26d))/0xb)+-parseInt(_0x33d913(0x212))/0xc;if(_0x20551f===_0x4eb47d)break;else _0x1b531f['push'](_0x1b531f['shift']());}catch(_0x490b1d){_0x1b531f['push'](_0x1b531f['shift']());}}}(_0x317d,0x5c1c9));import{isArrayStream,cancel as _0xa6f4be,readToEnd as _0x480365,fromAsync as _0x16867c,transformPair as _0x58fef8,getWriter as _0x4333b9,getReader as _0x380af4}from'@openpgp/web-stream-tools';import{armor,unarmor}from'./encoding/armor';import{Argon2OutOfMemoryError}from'./type/s2k';import _0x5ec7fb from'./config';import{generateSessionKey}from'./crypto';import _0x21986b from'./enums';import _0x188111 from'./util';import{Signature}from'./signature';import{getPreferredCipherSuite,createSignaturePacket}from'./key';import{PacketList,LiteralDataPacket,CompressedDataPacket,AEADEncryptedDataPacket,SymEncryptedIntegrityProtectedDataPacket,SymmetricallyEncryptedDataPacket,PublicKeyEncryptedSessionKeyPacket,SymEncryptedSessionKeyPacket,OnePassSignaturePacket,SignaturePacket}from'./packet';function _0x16ef(_0x3e01c1,_0x38cfb3){const _0x317d61=_0x317d();return _0x16ef=function(_0x16ef2d,_0x12affa){_0x16ef2d=_0x16ef2d-0x1cd;let _0x174ac6=_0x317d61[_0x16ef2d];return _0x174ac6;},_0x16ef(_0x3e01c1,_0x38cfb3);}const allowedMessagePackets=_0x188111[_0x20fd46(0x29f)]([LiteralDataPacket,CompressedDataPacket,AEADEncryptedDataPacket,SymEncryptedIntegrityProtectedDataPacket,SymmetricallyEncryptedDataPacket,PublicKeyEncryptedSessionKeyPacket,SymEncryptedSessionKeyPacket,OnePassSignaturePacket,SignaturePacket]),allowedSymSessionKeyPackets=_0x188111[_0x20fd46(0x29f)]([SymEncryptedSessionKeyPacket]),allowedDetachedSignaturePackets=_0x188111[_0x20fd46(0x29f)]([SignaturePacket]);export class Message{constructor(_0x507665){const _0x1ef29f=_0x20fd46;this[_0x1ef29f(0x1d4)]=_0x507665||new PacketList();}['getEncryptionKeyIDs'](){const _0x4ef219=_0x20fd46,_0x2cb86a=[],_0x20bb78=this[_0x4ef219(0x1d4)][_0x4ef219(0x292)](_0x21986b[_0x4ef219(0x29c)][_0x4ef219(0x23d)]);return _0x20bb78[_0x4ef219(0x1f7)](function(_0x54990d){const _0x3c9fce=_0x4ef219;_0x2cb86a[_0x3c9fce(0x1f5)](_0x54990d[_0x3c9fce(0x293)]);}),_0x2cb86a;}[_0x20fd46(0x1ec)](){const _0x4a365e=_0x20fd46,_0x4773c6={'ROWwS':function(_0x36fcfd,_0x2ec5b5){return _0x36fcfd>_0x2ec5b5;},'bJvNt':function(_0x1ebdb5,_0x408da0){return _0x1ebdb5!==_0x408da0;},'flafo':_0x4a365e(0x2b9)},_0x317ba2=this[_0x4a365e(0x24e)](),_0x279b22=_0x317ba2[_0x4a365e(0x1d4)][_0x4a365e(0x292)](_0x21986b[_0x4a365e(0x29c)][_0x4a365e(0x244)]);if(_0x4773c6['ROWwS'](_0x279b22[_0x4a365e(0x235)],0x0)){if(_0x4773c6['bJvNt'](_0x4773c6[_0x4a365e(0x22e)],_0x4773c6['flafo']))throw _0x36c839;else return _0x279b22[_0x4a365e(0x255)](_0x1ad7c1=>_0x1ad7c1[_0x4a365e(0x22a)]);}const _0x2483c6=_0x317ba2[_0x4a365e(0x1d4)][_0x4a365e(0x292)](_0x21986b['packet'][_0x4a365e(0x257)]);return _0x2483c6[_0x4a365e(0x255)](_0x3462e2=>_0x3462e2[_0x4a365e(0x22a)]);}async[_0x20fd46(0x24f)](_0x316e56,_0x436b1c,_0x1897cf,_0x1fbb2d=new Date(),_0x256456=_0x5ec7fb){const _0x3a2923=_0x20fd46,_0x2a824f={'wTauc':_0x3a2923(0x1d3),'XLues':_0x3a2923(0x270),'AInNo':_0x3a2923(0x1d1)},_0x5c0709=this[_0x3a2923(0x1d4)][_0x3a2923(0x292)](_0x21986b[_0x3a2923(0x29c)][_0x3a2923(0x25e)],_0x21986b['packet']['symEncryptedIntegrityProtectedData'],_0x21986b[_0x3a2923(0x29c)][_0x3a2923(0x1f8)]);if(_0x5c0709[_0x3a2923(0x235)]===0x0)throw new Error(_0x2a824f[_0x3a2923(0x1fd)]);const _0x5b5ad0=_0x5c0709[0x0],_0x226bba=_0x5b5ad0[_0x3a2923(0x236)],_0x3cc6bc=_0x1897cf||await this[_0x3a2923(0x23b)](_0x316e56,_0x436b1c,_0x226bba,_0x1fbb2d,_0x256456);let _0x3b0805=null;const _0x117e31=Promise[_0x3a2923(0x227)](_0x3cc6bc[_0x3a2923(0x255)](async({algorithm:_0x402a21,data:_0xd1100a})=>{const _0x38d71a=_0x3a2923;if(!_0x188111[_0x38d71a(0x213)](_0xd1100a)||!_0x5b5ad0[_0x38d71a(0x236)]&&!_0x188111[_0x38d71a(0x2ac)](_0x402a21))throw new Error(_0x38d71a(0x1e2));try{const _0x2ca9d3=_0x5b5ad0[_0x38d71a(0x236)]||_0x21986b[_0x38d71a(0x2ab)](_0x21986b[_0x38d71a(0x1f3)],_0x402a21);await _0x5b5ad0[_0x38d71a(0x24f)](_0x2ca9d3,_0xd1100a,_0x256456);}catch(_0x4ddce3){_0x188111[_0x38d71a(0x2aa)](_0x4ddce3),_0x3b0805=_0x4ddce3;}}));_0xa6f4be(_0x5b5ad0[_0x3a2923(0x2b1)]),_0x5b5ad0[_0x3a2923(0x2b1)]=null,await _0x117e31;if(!_0x5b5ad0[_0x3a2923(0x1d4)]||!_0x5b5ad0[_0x3a2923(0x1d4)]['length']){if(_0x3a2923(0x21c)!==_0x2a824f['AInNo'])throw _0x3b0805||new Error(_0x3a2923(0x274));else throw new _0x1e92a2(_0x2a824f[_0x3a2923(0x267)]);}const _0x10d875=new Message(_0x5b5ad0[_0x3a2923(0x1d4)]);return _0x5b5ad0[_0x3a2923(0x1d4)]=new PacketList(),_0x10d875;}async[_0x20fd46(0x23b)](_0x780b0d,_0x1b3737,_0x3d7b60,_0xb56cfa=new Date(),_0xc7b540=_0x5ec7fb){const _0x2ffa2d=_0x20fd46,_0x375d6b={'Rvzod':_0x2ffa2d(0x28a),'wyXTZ':_0x2ffa2d(0x2a6),'AekBB':function(_0x15d616,_0x558d09){return _0x15d616===_0x558d09;},'GqDcu':_0x2ffa2d(0x282),'aIymz':'Invalid\x20session\x20key\x20for\x20encryption.','WBQUo':function(_0x4ed1dd,_0x2e41fc){return _0x4ed1dd(_0x2e41fc);},'CEQVO':function(_0x1ea062,_0x4a854d){return _0x1ea062===_0x4a854d;},'fiqVh':_0x2ffa2d(0x20e),'gNeIv':_0x2ffa2d(0x2a3),'vjgIq':function(_0x3f9c5c,_0x52fad5){return _0x3f9c5c===_0x52fad5;},'EKzoL':'UiKwl','ljOMs':function(_0xc0acc0,_0x4cfbe7){return _0xc0acc0===_0x4cfbe7;},'GTtNC':_0x2ffa2d(0x209),'xhaqk':_0x2ffa2d(0x271),'RWjVE':function(_0x1d0217,_0x516b94){return _0x1d0217>_0x516b94;},'qGgAf':_0x2ffa2d(0x2b7),'Lbchp':_0x2ffa2d(0x2a2)};let _0x47b711=[],_0x282361;if(_0x1b3737){const _0x40fe1e=this[_0x2ffa2d(0x1d4)][_0x2ffa2d(0x292)](_0x21986b['packet'][_0x2ffa2d(0x1e5)]);if(_0x375d6b[_0x2ffa2d(0x240)](_0x40fe1e['length'],0x0))throw new Error(_0x2ffa2d(0x242));await Promise[_0x2ffa2d(0x227)](_0x1b3737[_0x2ffa2d(0x255)](async function(_0x4c1cc0,_0x59df62){const _0x51de19=_0x2ffa2d,_0x5cb7c0={'DhrTq':'Key\x20is\x20newer\x20than\x20the\x20signature','WbFCZ':_0x51de19(0x211)};let _0x3dbf5c;if(_0x59df62){if(_0x375d6b['Rvzod']===_0x375d6b[_0x51de19(0x265)])throw new _0x15f71e(_0x5cb7c0[_0x51de19(0x21b)]);else _0x3dbf5c=await PacketList[_0x51de19(0x27a)](_0x40fe1e['write'](),allowedSymSessionKeyPackets,_0xc7b540);}else{if(_0x375d6b['AekBB'](_0x375d6b[_0x51de19(0x2b6)],_0x375d6b[_0x51de19(0x2b6)]))_0x3dbf5c=_0x40fe1e;else return this[_0x51de19(0x1d4)][_0x51de19(0x2ab)]();}await Promise[_0x51de19(0x227)](_0x3dbf5c[_0x51de19(0x255)](async function(_0x54050b){const _0x11c4e0=_0x51de19;if(_0x11c4e0(0x28e)!=='SMRsN')try{await _0x54050b[_0x11c4e0(0x24f)](_0x4c1cc0),_0x47b711['push'](_0x54050b);}catch(_0x567b4e){_0x5cb7c0[_0x11c4e0(0x23f)]!==_0x5cb7c0['WbFCZ']?_0x1105d0[_0x11c4e0(0x288)](_0x533602,_0x985557[_0x11c4e0(0x2ab)](_0x370743[_0x11c4e0(0x216)],_0x5723ee)):(_0x188111[_0x11c4e0(0x2aa)](_0x567b4e),_0x567b4e instanceof Argon2OutOfMemoryError&&(_0x282361=_0x567b4e));}else return _0x4669a7[_0x11c4e0(0x232)]();}));}));}else{if(_0x780b0d){const _0x59f416=this[_0x2ffa2d(0x1d4)][_0x2ffa2d(0x292)](_0x21986b[_0x2ffa2d(0x29c)][_0x2ffa2d(0x23d)]);if(_0x375d6b[_0x2ffa2d(0x240)](_0x59f416[_0x2ffa2d(0x235)],0x0))throw new Error(_0x375d6b['GTtNC']);await Promise[_0x2ffa2d(0x227)](_0x59f416[_0x2ffa2d(0x255)](async function(_0x595bf5){const _0x5c041f=_0x2ffa2d,_0x3bf73f={'wqETQ':_0x5c041f(0x250),'EASXC':_0x5c041f(0x24c),'oCleM':function(_0xe6946,_0x31327a){const _0x2baa48=_0x5c041f;return _0x375d6b[_0x2baa48(0x28b)](_0xe6946,_0x31327a);},'lhLYh':'ybvcN'};if(_0x375d6b[_0x5c041f(0x231)]===_0x375d6b[_0x5c041f(0x231)])await Promise[_0x5c041f(0x227)](_0x780b0d[_0x5c041f(0x255)](async function(_0x2f9b82){const _0x19a25d=_0x5c041f,_0x1b5227={'sxyBr':_0x375d6b[_0x19a25d(0x253)],'EWEmd':function(_0x570a28,_0x2d1cd0){const _0xa52fb5=_0x19a25d;return _0x375d6b[_0xa52fb5(0x1f4)](_0x570a28,_0x2d1cd0);},'kYbPW':_0x19a25d(0x290)};if(_0x375d6b[_0x19a25d(0x1e1)](_0x375d6b['fiqVh'],_0x375d6b[_0x19a25d(0x22c)]))return[_0x3bf73f[_0x19a25d(0x206)],_0x3bf73f[_0x19a25d(0x246)]][_0x19a25d(0x201)](_0x2483f6[_0x19a25d(0x268)](_0x1fd107[_0x19a25d(0x257)],_0x2c2737[_0x19a25d(0x1ce)]));else{let _0x2a322e;try{_0x2a322e=(await _0x2f9b82[_0x19a25d(0x25d)](_0x595bf5[_0x19a25d(0x293)],null,undefined,_0xc7b540))[_0x19a25d(0x255)](_0x58f699=>_0x58f699[_0x19a25d(0x205)]);}catch(_0x21610c){if(_0x19a25d(0x28c)===_0x19a25d(0x28c)){_0x282361=_0x21610c;return;}else throw new _0x4488f0(_0x1b5227['sxyBr']);}let _0x4ae71b=[_0x21986b[_0x19a25d(0x1f3)][_0x19a25d(0x2a4)],_0x21986b[_0x19a25d(0x1f3)][_0x19a25d(0x1d9)],_0x21986b[_0x19a25d(0x1f3)]['tripledes'],_0x21986b['symmetric'][_0x19a25d(0x27f)]];try{const _0x501291=await _0x2f9b82[_0x19a25d(0x26b)](_0xb56cfa,undefined,_0xc7b540);_0x501291['preferredSymmetricAlgorithms']&&(_0x4ae71b=_0x4ae71b[_0x19a25d(0x29d)](_0x501291[_0x19a25d(0x1f2)]));}catch(_0x2622d7){}await Promise['all'](_0x2a322e[_0x19a25d(0x255)](async function(_0x3a4583){const _0x359356=_0x19a25d;if(!_0x3a4583[_0x359356(0x2b4)]())throw new Error(_0x359356(0x248));const _0x571c94=_0xc7b540['constantTimePKCS1Decryption']&&(_0x595bf5['publicKeyAlgorithm']===_0x21986b['publicKey']['rsaEncrypt']||_0x3bf73f[_0x359356(0x1fb)](_0x595bf5['publicKeyAlgorithm'],_0x21986b['publicKey'][_0x359356(0x218)])||_0x595bf5[_0x359356(0x1e0)]===_0x21986b[_0x359356(0x2b0)]['rsaSign']||_0x595bf5[_0x359356(0x1e0)]===_0x21986b[_0x359356(0x2b0)]['elgamal']);if(_0x571c94){if(_0x3bf73f[_0x359356(0x266)]===_0x3bf73f['lhLYh']){const _0x17c2e4=_0x595bf5['write']();await Promise['all']((_0x3d7b60?[_0x3d7b60]:Array[_0x359356(0x1e7)](_0xc7b540[_0x359356(0x29e)]))[_0x359356(0x255)](async _0x2c0b53=>{const _0x599312=_0x359356,_0x1e9eec=new PublicKeyEncryptedSessionKeyPacket();_0x1e9eec[_0x599312(0x268)](_0x17c2e4);const _0x172b03={'sessionKeyAlgorithm':_0x2c0b53,'sessionKey':_0x1b5227[_0x599312(0x28d)](generateSessionKey,_0x2c0b53)};try{await _0x1e9eec['decrypt'](_0x3a4583,_0x172b03),_0x47b711['push'](_0x1e9eec);}catch(_0x2e8a23){_0x188111[_0x599312(0x2aa)](_0x2e8a23),_0x282361=_0x2e8a23;}}));}else throw new _0x5a7c7a(_0x1b5227[_0x359356(0x1db)]);}else try{if(_0x359356(0x24d)!==_0x359356(0x24d))_0x504d63[_0x359356(0x1f5)](..._0x7c6fa2);else{await _0x595bf5[_0x359356(0x24f)](_0x3a4583);const _0x194fdf=_0x3d7b60||_0x595bf5[_0x359356(0x203)];if(_0x194fdf&&!_0x4ae71b['includes'](_0x21986b[_0x359356(0x2ab)](_0x21986b[_0x359356(0x1f3)],_0x194fdf)))throw new Error(_0x359356(0x21f));_0x47b711['push'](_0x595bf5);}}catch(_0x5b040e){_0x188111[_0x359356(0x2aa)](_0x5b040e),_0x282361=_0x5b040e;}}));}})),_0xa6f4be(_0x595bf5['encrypted']),_0x595bf5[_0x5c041f(0x2b1)]=null;else return new _0x2f7d0a(_0x587459[0x0]['packets']);}));}else throw new Error(_0x375d6b[_0x2ffa2d(0x283)]);}if(_0x375d6b[_0x2ffa2d(0x1ff)](_0x47b711[_0x2ffa2d(0x235)],0x0)){if(_0x47b711[_0x2ffa2d(0x235)]>0x1){if('Ppwjd'===_0x375d6b[_0x2ffa2d(0x294)]){const _0x19152d=[],_0x3aad6c=this[_0x2ffa2d(0x1d4)][_0x2ffa2d(0x292)](_0x4a9016[_0x2ffa2d(0x29c)]['publicKeyEncryptedSessionKey']);return _0x3aad6c['forEach'](function(_0x308466){const _0x59ad12=_0x2ffa2d;_0x19152d['push'](_0x308466[_0x59ad12(0x293)]);}),_0x19152d;}else{const _0x330cf7=new Set();_0x47b711=_0x47b711[_0x2ffa2d(0x20c)](_0x4f95f6=>{const _0x41256d=_0x2ffa2d,_0x5f05f9=_0x4f95f6['sessionKeyAlgorithm']+_0x188111['uint8ArrayToString'](_0x4f95f6[_0x41256d(0x22d)]);if(_0x330cf7['has'](_0x5f05f9))return![];return _0x330cf7['add'](_0x5f05f9),!![];});}}return _0x47b711[_0x2ffa2d(0x255)](_0x595ce1=>({'data':_0x595ce1['sessionKey'],'algorithm':_0x595ce1[_0x2ffa2d(0x203)]&&_0x21986b['read'](_0x21986b[_0x2ffa2d(0x1f3)],_0x595ce1['sessionKeyAlgorithm'])}));}throw _0x282361||new Error(_0x375d6b[_0x2ffa2d(0x27b)]);}['getLiteralData'](){const _0x1c76da=_0x20fd46,_0x16e3da=this[_0x1c76da(0x24e)](),_0x318ba0=_0x16e3da[_0x1c76da(0x1d4)][_0x1c76da(0x25b)](_0x21986b[_0x1c76da(0x29c)]['literalData']);return _0x318ba0&&_0x318ba0['getBytes']()||null;}[_0x20fd46(0x269)](){const _0x1deee0=_0x20fd46,_0x3daee3=this[_0x1deee0(0x24e)](),_0x5d18fe=_0x3daee3['packets'][_0x1deee0(0x25b)](_0x21986b['packet'][_0x1deee0(0x1ea)]);return _0x5d18fe&&_0x5d18fe['getFilename']()||null;}[_0x20fd46(0x232)](){const _0x5ae998=_0x20fd46,_0x5b4d4f=this[_0x5ae998(0x24e)](),_0x18eddc=_0x5b4d4f[_0x5ae998(0x1d4)][_0x5ae998(0x25b)](_0x21986b[_0x5ae998(0x29c)]['literalData']);if(_0x18eddc)return _0x18eddc[_0x5ae998(0x232)]();return null;}static async['generateSessionKey'](_0x46a36d=[],_0x515a75=new Date(),_0x74dfe7=[],_0x25002a=_0x5ec7fb){const _0x34de63=_0x20fd46,_0x31a0c0={'yoINP':function(_0x1ee285,_0x1ccd31){return _0x1ee285===_0x1ccd31;},'TyOjF':function(_0x440ba2,_0x5b32de){return _0x440ba2===_0x5b32de;},'JWVwR':_0x34de63(0x296)},{symmetricAlgo:_0x317c5e,aeadAlgo:_0x1822d9}=await getPreferredCipherSuite(_0x46a36d,_0x515a75,_0x74dfe7,_0x25002a),_0x532dbd=_0x21986b[_0x34de63(0x268)](_0x21986b[_0x34de63(0x1f3)],_0x317c5e),_0x482fbb=_0x1822d9?_0x21986b['read'](_0x21986b['aead'],_0x1822d9):undefined;await Promise[_0x34de63(0x227)](_0x46a36d['map'](_0x32c1b5=>_0x32c1b5[_0x34de63(0x280)]()[_0x34de63(0x226)](()=>null)[_0x34de63(0x2b2)](_0x38cf74=>{const _0x31860d=_0x34de63;if(_0x38cf74&&(_0x31a0c0['yoINP'](_0x38cf74[_0x31860d(0x205)][_0x31860d(0x299)],_0x21986b[_0x31860d(0x2b0)][_0x31860d(0x1e6)])||_0x31a0c0['TyOjF'](_0x38cf74[_0x31860d(0x205)][_0x31860d(0x299)],_0x21986b[_0x31860d(0x2b0)][_0x31860d(0x20a)]))&&!_0x482fbb&&!_0x188111['isAES'](_0x317c5e))throw new Error(_0x31a0c0[_0x31860d(0x2a9)]);})));const _0x33aa17=generateSessionKey(_0x317c5e);return{'data':_0x33aa17,'algorithm':_0x532dbd,'aeadAlgorithm':_0x482fbb};}async[_0x20fd46(0x2ad)](_0x3f8af4,_0x285abc,_0x5dbd9a,_0x31c3c6=![],_0x4b63f8=[],_0x25cb83=new Date(),_0x17c2b8=[],_0x39dd5c=_0x5ec7fb){const _0x29c60b=_0x20fd46,_0x5e9b37={'pHGPJ':_0x29c60b(0x1f1),'xtsIS':_0x29c60b(0x1e4)};if(_0x5dbd9a){if(!_0x188111['isUint8Array'](_0x5dbd9a['data'])||!_0x188111[_0x29c60b(0x2ac)](_0x5dbd9a['algorithm']))throw new Error(_0x5e9b37[_0x29c60b(0x219)]);}else{if(_0x3f8af4&&_0x3f8af4['length'])_0x5dbd9a=await Message[_0x29c60b(0x263)](_0x3f8af4,_0x25cb83,_0x17c2b8,_0x39dd5c);else{if(_0x285abc&&_0x285abc['length'])_0x5dbd9a=await Message[_0x29c60b(0x263)](undefined,undefined,undefined,_0x39dd5c);else throw new Error(_0x5e9b37['xtsIS']);}}const {data:_0x2d1d60,algorithm:_0x3040e3,aeadAlgorithm:_0x11aba9}=_0x5dbd9a,_0x48de2d=await Message[_0x29c60b(0x22f)](_0x2d1d60,_0x3040e3,_0x11aba9,_0x3f8af4,_0x285abc,_0x31c3c6,_0x4b63f8,_0x25cb83,_0x17c2b8,_0x39dd5c),_0x5782aa=SymEncryptedIntegrityProtectedDataPacket['fromObject']({'version':_0x11aba9?0x2:0x1,'aeadAlgorithm':_0x11aba9?_0x21986b['write'](_0x21986b[_0x29c60b(0x1de)],_0x11aba9):null});_0x5782aa[_0x29c60b(0x1d4)]=this[_0x29c60b(0x1d4)];const _0x5a8b70=_0x21986b[_0x29c60b(0x2ab)](_0x21986b[_0x29c60b(0x1f3)],_0x3040e3);return await _0x5782aa[_0x29c60b(0x2ad)](_0x5a8b70,_0x2d1d60,_0x39dd5c),_0x48de2d[_0x29c60b(0x1d4)][_0x29c60b(0x1f5)](_0x5782aa),_0x5782aa[_0x29c60b(0x1d4)]=new PacketList(),_0x48de2d;}static async['encryptSessionKey'](_0x2b6390,_0x447346,_0x384577,_0x2f34da,_0x1a398f,_0x45de3f=![],_0x3dacba=[],_0x360473=new Date(),_0x9d64b=[],_0x52a484=_0x5ec7fb){const _0x36daf7=_0x20fd46,_0x456742={'LEQms':function(_0x4ed8a4,_0x5821b1){return _0x4ed8a4===_0x5821b1;},'eWCAE':_0x36daf7(0x1e3),'lPAmj':_0x36daf7(0x287),'clxoW':_0x36daf7(0x1fe),'wFhwr':function(_0x4f89ad,_0x1bffe0){return _0x4f89ad!==_0x1bffe0;},'hLpAu':function(_0x119687,_0x2997bc,_0x2e08e9,_0x2a203f){return _0x119687(_0x2997bc,_0x2e08e9,_0x2a203f);}},_0x477206=new PacketList(),_0x20965=_0x21986b[_0x36daf7(0x2ab)](_0x21986b[_0x36daf7(0x1f3)],_0x447346),_0x1bbb85=_0x384577&&_0x21986b[_0x36daf7(0x2ab)](_0x21986b['aead'],_0x384577);if(_0x2f34da){const _0x4cce43=await Promise[_0x36daf7(0x227)](_0x2f34da['map'](async function(_0x1ea756,_0x33bcfe){const _0x1f1b48=_0x36daf7,_0x5b8d36=await _0x1ea756[_0x1f1b48(0x280)](_0x3dacba[_0x33bcfe],_0x360473,_0x9d64b,_0x52a484),_0x49c096=PublicKeyEncryptedSessionKeyPacket[_0x1f1b48(0x2b8)]({'version':_0x1bbb85?0x6:0x3,'encryptionKeyPacket':_0x5b8d36[_0x1f1b48(0x205)],'anonymousRecipient':_0x45de3f,'sessionKey':_0x2b6390,'sessionKeyAlgorithm':_0x20965});return await _0x49c096['encrypt'](_0x5b8d36['keyPacket']),delete _0x49c096['sessionKey'],_0x49c096;}));_0x477206[_0x36daf7(0x1f5)](..._0x4cce43);}if(_0x1a398f){const _0x219275=async function(_0x2604ad,_0x18a0d3){const _0x49fad7=_0x36daf7;try{return await _0x2604ad['decrypt'](_0x18a0d3),0x1;}catch(_0x2fdc34){return _0x456742[_0x49fad7(0x277)](_0x456742[_0x49fad7(0x1cf)],_0x456742[_0x49fad7(0x2a1)])?this:0x0;}},_0x4b6496=(_0x2b0532,_0x145cd9)=>_0x2b0532+_0x145cd9,_0x332489=async function(_0x416dbd,_0x165fb3,_0x32b975,_0x500c65){const _0x20087f=_0x36daf7,_0x5db88a=new SymEncryptedSessionKeyPacket(_0x52a484);_0x5db88a[_0x20087f(0x22d)]=_0x416dbd,_0x5db88a[_0x20087f(0x203)]=_0x165fb3;_0x32b975&&(_0x456742['clxoW']!==_0x20087f(0x273)?_0x5db88a[_0x20087f(0x241)]=_0x32b975:(_0x54aca7[_0x20087f(0x2aa)](_0xc79f09),_0x3e3dc6=_0x2cc3d8));await _0x5db88a[_0x20087f(0x2ad)](_0x500c65,_0x52a484);if(_0x52a484[_0x20087f(0x27c)]){if(_0x456742[_0x20087f(0x264)](_0x20087f(0x1ef),_0x20087f(0x260))){const _0x410149=await Promise[_0x20087f(0x227)](_0x1a398f[_0x20087f(0x255)](_0x46606a=>_0x219275(_0x5db88a,_0x46606a)));if(_0x456742[_0x20087f(0x264)](_0x410149['reduce'](_0x4b6496),0x1))return _0x456742[_0x20087f(0x262)](_0x332489,_0x416dbd,_0x165fb3,_0x500c65);}else _0x49f3b9[_0x20087f(0x23a)](_0x22c6f6);}return delete _0x5db88a[_0x20087f(0x22d)],_0x5db88a;},_0x144ea8=await Promise['all'](_0x1a398f[_0x36daf7(0x255)](_0x8bedde=>_0x332489(_0x2b6390,_0x20965,_0x1bbb85,_0x8bedde)));_0x477206[_0x36daf7(0x1f5)](..._0x144ea8);}return new Message(_0x477206);}async[_0x20fd46(0x1e8)](_0x27338b=[],_0x2036a8=[],_0x35e8e1=null,_0x2bdb9c=[],_0x48e1a6=new Date(),_0x3e193e=[],_0x7a115e=[],_0x168453=[],_0x4ab408=_0x5ec7fb){const _0x5ad4c0=_0x20fd46,_0x1e5290={'SaDPd':function(_0x2b792e,_0x3adc66,_0x719b11,_0x23cb5c,_0x3b8677,_0x34b68c,_0x222440,_0x26787c,_0x4f00ef,_0x56946c,_0x1a11ae,_0x2c1862){return _0x2b792e(_0x3adc66,_0x719b11,_0x23cb5c,_0x3b8677,_0x34b68c,_0x222440,_0x26787c,_0x4f00ef,_0x56946c,_0x1a11ae,_0x2c1862);}},_0x2139a6=new PacketList(),_0x2e15ab=this[_0x5ad4c0(0x1d4)][_0x5ad4c0(0x25b)](_0x21986b[_0x5ad4c0(0x29c)][_0x5ad4c0(0x1ea)]);if(!_0x2e15ab)throw new Error(_0x5ad4c0(0x1d0));const _0x257226=await _0x1e5290[_0x5ad4c0(0x243)](createSignaturePackets,_0x2e15ab,_0x27338b,_0x2036a8,_0x35e8e1,_0x2bdb9c,_0x48e1a6,_0x3e193e,_0x7a115e,_0x168453,![],_0x4ab408),_0x26f099=_0x257226[_0x5ad4c0(0x255)]((_0x1e8e22,_0x40df3b)=>OnePassSignaturePacket[_0x5ad4c0(0x21e)](_0x1e8e22,_0x40df3b===0x0))[_0x5ad4c0(0x1f6)]();return _0x2139a6[_0x5ad4c0(0x1f5)](..._0x26f099),_0x2139a6[_0x5ad4c0(0x1f5)](_0x2e15ab),_0x2139a6['push'](..._0x257226),new Message(_0x2139a6);}[_0x20fd46(0x1ed)](_0x20fe72,_0x266cfb=_0x5ec7fb){const _0x2dbac4=_0x20fd46,_0x1b9a28={'xtGCC':function(_0x4ed0c6,_0xfaaf2e){return _0x4ed0c6===_0xfaaf2e;}};if(_0x1b9a28['xtGCC'](_0x20fe72,_0x21986b[_0x2dbac4(0x2ae)][_0x2dbac4(0x20b)]))return this;const _0x4da59c=new CompressedDataPacket(_0x266cfb);_0x4da59c['algorithm']=_0x20fe72,_0x4da59c['packets']=this[_0x2dbac4(0x1d4)];const _0x5ab825=new PacketList();return _0x5ab825[_0x2dbac4(0x1f5)](_0x4da59c),new Message(_0x5ab825);}async[_0x20fd46(0x1da)](_0x2ee675=[],_0x4886a0=[],_0x1f5be6=null,_0x30bea6=[],_0x2782bd=[],_0x327c33=new Date(),_0xdd1c2a=[],_0x3f79ea=[],_0x400654=_0x5ec7fb){const _0x115615=_0x20fd46,_0x4c646d={'QkWOE':function(_0x5ea052,_0x158088,_0x2c2675,_0x1bf1a0,_0x34bfb3,_0x4e9b65,_0x3e84e0,_0x3972ff,_0x153e8b,_0x27f2eb,_0x526e3b,_0x3755d5){return _0x5ea052(_0x158088,_0x2c2675,_0x1bf1a0,_0x34bfb3,_0x4e9b65,_0x3e84e0,_0x3972ff,_0x153e8b,_0x27f2eb,_0x526e3b,_0x3755d5);}},_0x2e86ba=this[_0x115615(0x1d4)][_0x115615(0x25b)](_0x21986b[_0x115615(0x29c)][_0x115615(0x1ea)]);if(!_0x2e86ba)throw new Error(_0x115615(0x1d0));return new Signature(await _0x4c646d[_0x115615(0x279)](createSignaturePackets,_0x2e86ba,_0x2ee675,_0x4886a0,_0x1f5be6,_0x30bea6,_0x2782bd,_0x327c33,_0xdd1c2a,_0x3f79ea,!![],_0x400654));}async[_0x20fd46(0x200)](_0x127d8f,_0x10d78a=new Date(),_0x26ecae=_0x5ec7fb){const _0xb70b07=_0x20fd46,_0x4f3ac0={'yfGRi':function(_0x2a0ea0,_0x25cb6b){return _0x2a0ea0(_0x25cb6b);},'YhJBO':function(_0x9b901b,_0x17175d){return _0x9b901b(_0x17175d);},'CMyPk':function(_0x31862e,_0xa85af8){return _0x31862e(_0xa85af8);},'GQbsN':function(_0x372409,_0x5661b4){return _0x372409<_0x5661b4;},'Libkx':_0xb70b07(0x27e),'oLdXs':function(_0x2bcc76,_0x565001,_0xa55d0e){return _0x2bcc76(_0x565001,_0xa55d0e);},'boxJh':function(_0x27d7e1,_0x379682,_0x427cd6,_0x1aedd7,_0x3e9e4f,_0x5ce4fa,_0x1c34ce){return _0x27d7e1(_0x379682,_0x427cd6,_0x1aedd7,_0x3e9e4f,_0x5ce4fa,_0x1c34ce);},'UqZwL':function(_0x50a7ee,_0x3c0a9d,_0x14d1e5,_0x4fb993,_0x13357e,_0x37c663,_0x279e32){return _0x50a7ee(_0x3c0a9d,_0x14d1e5,_0x4fb993,_0x13357e,_0x37c663,_0x279e32);}},_0xea7642=this[_0xb70b07(0x24e)](),_0x25aec1=_0xea7642[_0xb70b07(0x1d4)]['filterByTag'](_0x21986b[_0xb70b07(0x29c)][_0xb70b07(0x1ea)]);if(_0x25aec1['length']!==0x1)throw new Error(_0x4f3ac0[_0xb70b07(0x284)]);let _0x2a6c3d=_0xea7642[_0xb70b07(0x1d4)];isArrayStream(_0x2a6c3d['stream'])&&(_0x2a6c3d=_0x2a6c3d[_0xb70b07(0x29d)](await _0x4f3ac0[_0xb70b07(0x251)](_0x480365,_0x2a6c3d[_0xb70b07(0x2a8)],_0x1bdcca=>_0x1bdcca||[])));const _0x19d0a0=_0x2a6c3d['filterByTag'](_0x21986b['packet'][_0xb70b07(0x244)])[_0xb70b07(0x1f6)](),_0x1bd90d=_0x2a6c3d[_0xb70b07(0x292)](_0x21986b[_0xb70b07(0x29c)][_0xb70b07(0x257)]);if(_0x19d0a0[_0xb70b07(0x235)]&&!_0x1bd90d[_0xb70b07(0x235)]&&_0x188111['isStream'](_0x2a6c3d[_0xb70b07(0x2a8)])&&!_0x4f3ac0['YhJBO'](isArrayStream,_0x2a6c3d[_0xb70b07(0x2a8)]))return await Promise[_0xb70b07(0x227)](_0x19d0a0['map'](async _0x87ac3a=>{const _0x50f38a=_0xb70b07;_0x87ac3a[_0x50f38a(0x20f)]=new Promise((_0x4a1fec,_0x547df1)=>{const _0x367100=_0x50f38a;_0x87ac3a[_0x367100(0x1e9)]=_0x4a1fec,_0x87ac3a[_0x367100(0x210)]=_0x547df1;}),_0x87ac3a[_0x50f38a(0x1eb)]=_0x4f3ac0[_0x50f38a(0x278)](_0x16867c,async()=>(await _0x87ac3a['correspondingSig'])[_0x50f38a(0x1eb)]),_0x87ac3a[_0x50f38a(0x281)]=_0x4f3ac0[_0x50f38a(0x228)](_0x480365,await _0x87ac3a[_0x50f38a(0x26a)](_0x87ac3a[_0x50f38a(0x1ce)],_0x25aec1[0x0],undefined,![])),_0x87ac3a[_0x50f38a(0x281)][_0x50f38a(0x226)](()=>{});})),_0x2a6c3d['stream']=_0x58fef8(_0x2a6c3d[_0xb70b07(0x2a8)],async(_0x1c938b,_0x4561ba)=>{const _0x48ac68=_0xb70b07,_0x1eedaf=_0x4f3ac0[_0x48ac68(0x272)](_0x380af4,_0x1c938b),_0x490d9f=_0x4333b9(_0x4561ba);try{for(let _0x5ccbd4=0x0;_0x4f3ac0[_0x48ac68(0x1fa)](_0x5ccbd4,_0x19d0a0['length']);_0x5ccbd4++){const {value:_0x4099d6}=await _0x1eedaf[_0x48ac68(0x268)]();_0x19d0a0[_0x5ccbd4][_0x48ac68(0x1e9)](_0x4099d6);}await _0x1eedaf[_0x48ac68(0x1f9)](),await _0x490d9f['ready'],await _0x490d9f[_0x48ac68(0x2a0)]();}catch(_0x125395){_0x19d0a0[_0x48ac68(0x1f7)](_0x2d49df=>{const _0x4cc0ab=_0x48ac68;_0x2d49df[_0x4cc0ab(0x210)](_0x125395);}),await _0x490d9f[_0x48ac68(0x295)](_0x125395);}}),_0x4f3ac0[_0xb70b07(0x24a)](createVerificationObjects,_0x19d0a0,_0x25aec1,_0x127d8f,_0x10d78a,![],_0x26ecae);return _0x4f3ac0[_0xb70b07(0x21d)](createVerificationObjects,_0x1bd90d,_0x25aec1,_0x127d8f,_0x10d78a,![],_0x26ecae);}[_0x20fd46(0x238)](_0x1071fd,_0x52d3f5,_0x49f872=new Date(),_0x12f3f3=_0x5ec7fb){const _0x9c91e9=_0x20fd46,_0x30f5fd={'LKeeU':function(_0x4c964a,_0x469e60,_0x80f3cf,_0x1f63be,_0x57ecd6,_0x509fd3,_0x2fb497){return _0x4c964a(_0x469e60,_0x80f3cf,_0x1f63be,_0x57ecd6,_0x509fd3,_0x2fb497);}},_0x104890=this[_0x9c91e9(0x24e)](),_0x23585b=_0x104890[_0x9c91e9(0x1d4)][_0x9c91e9(0x292)](_0x21986b[_0x9c91e9(0x29c)][_0x9c91e9(0x1ea)]);if(_0x23585b[_0x9c91e9(0x235)]!==0x1)throw new Error(_0x9c91e9(0x27e));const _0x33d94d=_0x1071fd[_0x9c91e9(0x1d4)][_0x9c91e9(0x292)](_0x21986b[_0x9c91e9(0x29c)][_0x9c91e9(0x257)]);return _0x30f5fd[_0x9c91e9(0x25a)](createVerificationObjects,_0x33d94d,_0x23585b,_0x52d3f5,_0x49f872,!![],_0x12f3f3);}['unwrapCompressed'](){const _0xdf3556=_0x20fd46,_0x2a73ea=this[_0xdf3556(0x1d4)][_0xdf3556(0x292)](_0x21986b[_0xdf3556(0x29c)]['compressedData']);if(_0x2a73ea[_0xdf3556(0x235)]){if(_0xdf3556(0x1ee)==='JqXnd')return new Message(_0x2a73ea[0x0][_0xdf3556(0x1d4)]);else throw new _0x4eb91e(_0xdf3556(0x224)+_0x2f9346[_0xdf3556(0x22a)][_0xdf3556(0x286)]());}return this;}async[_0x20fd46(0x207)](_0x3ca76e,_0x4665ef=_0x5ec7fb){const _0x4a91ba=_0x20fd46;await this[_0x4a91ba(0x1d4)][_0x4a91ba(0x268)](_0x188111[_0x4a91ba(0x213)](_0x3ca76e)?_0x3ca76e:(await unarmor(_0x3ca76e))['data'],allowedDetachedSignaturePackets,_0x4665ef);}[_0x20fd46(0x2ab)](){const _0x1e231b=_0x20fd46;return this[_0x1e231b(0x1d4)]['write']();}[_0x20fd46(0x26c)](_0x349264=_0x5ec7fb){const _0x3444f8=_0x20fd46,_0x3c60b4={'pgVGY':function(_0x20c37f,_0x52ef5c){return _0x20c37f===_0x52ef5c;}},_0x3e62ce=this[_0x3444f8(0x1d4)][this[_0x3444f8(0x1d4)][_0x3444f8(0x235)]-0x1],_0x548280=_0x3c60b4[_0x3444f8(0x28f)](_0x3e62ce[_0x3444f8(0x259)][_0x3444f8(0x23e)],SymEncryptedIntegrityProtectedDataPacket[_0x3444f8(0x23e)])?_0x3e62ce[_0x3444f8(0x1d8)]!==0x2:this['packets']['some'](_0x3dbfbb=>_0x3dbfbb[_0x3444f8(0x259)]['tag']===SignaturePacket['tag']&&_0x3dbfbb[_0x3444f8(0x1d8)]!==0x6);return armor(_0x21986b[_0x3444f8(0x26c)][_0x3444f8(0x261)],this[_0x3444f8(0x2ab)](),null,null,null,_0x548280,_0x349264);}}export async function createSignaturePackets(_0x4fe2d8,_0x1e4e16,_0x496609=[],_0x31a2a9=null,_0x3e424b=[],_0x504488=new Date(),_0x75ea8a=[],_0x7c1005=[],_0x461f71=[],_0x519f00=![],_0x597767=_0x5ec7fb){const _0x45398c=_0x20fd46,_0x328563={'yKoOc':function(_0x492e8f,_0x1441d8,_0x537dd2,_0x29c21e,_0x20571c,_0x7b96d3,_0xd7f877){return _0x492e8f(_0x1441d8,_0x537dd2,_0x29c21e,_0x20571c,_0x7b96d3,_0xd7f877);},'JUWCd':function(_0x109200,_0x12068a){return _0x109200===_0x12068a;},'WKMsM':_0x45398c(0x29b)},_0x3766f4=new PacketList(),_0x4646d8=_0x4fe2d8[_0x45398c(0x250)]===null?_0x21986b['signature']['binary']:_0x21986b[_0x45398c(0x257)][_0x45398c(0x250)];await Promise['all'](_0x1e4e16[_0x45398c(0x255)](async(_0x415bda,_0x72cba8)=>{const _0x53568f=_0x45398c,_0x3dfac7=_0x75ea8a[_0x72cba8];if(!_0x415bda[_0x53568f(0x276)]())throw new Error('Need\x20private\x20key\x20for\x20signing');const _0x25c5dd=await _0x415bda[_0x53568f(0x1d5)](_0x3e424b[_0x72cba8],_0x504488,_0x3dfac7,_0x597767);return createSignaturePacket(_0x4fe2d8,_0x496609[_0x53568f(0x235)]?_0x496609:[_0x415bda],_0x25c5dd[_0x53568f(0x205)],{'signatureType':_0x4646d8},_0x504488,_0x7c1005,_0x461f71,_0x519f00,_0x597767);}))[_0x45398c(0x2b2)](_0x34b5cd=>{const _0x51d61d=_0x45398c;if(_0x328563[_0x51d61d(0x285)](_0x328563[_0x51d61d(0x204)],'LSirp'))_0x3766f4['push'](..._0x34b5cd);else return _0x328563[_0x51d61d(0x252)](_0x108697,_0x1fa7f4,_0x799c6a,_0x5f2e87,_0x39c0d1,_0x4df43c,_0x2c2cfa);});if(_0x31a2a9){const _0x5bd4db=_0x31a2a9[_0x45398c(0x1d4)]['filterByTag'](_0x21986b[_0x45398c(0x29c)][_0x45398c(0x257)]);_0x3766f4['push'](..._0x5bd4db);}return _0x3766f4;}async function createVerificationObject(_0x3cd12f,_0x33842d,_0x3b281a,_0x4f9e88=new Date(),_0x2c3020=![],_0x5096a6=_0x5ec7fb){const _0x472830=_0x20fd46,_0x1c7578={'zwDCn':_0x472830(0x271),'gcZdA':_0x472830(0x25c),'cscMG':function(_0x748694,_0x19d023){return _0x748694>_0x19d023;},'KCMge':function(_0x4df7e3,_0x355e0f){return _0x4df7e3>_0x355e0f;}};let _0x357eb0,_0x1933a8;for(const _0x62e997 of _0x3b281a){const _0x1dd9c5=_0x62e997[_0x472830(0x234)](_0x3cd12f[_0x472830(0x22a)]);if(_0x1c7578[_0x472830(0x2a5)](_0x1dd9c5[_0x472830(0x235)],0x0)){_0x357eb0=_0x62e997,_0x1933a8=_0x1dd9c5[0x0];break;}}const _0x1d5507=_0x3cd12f instanceof OnePassSignaturePacket,_0x374fe0=_0x1d5507?_0x3cd12f['correspondingSig']:_0x3cd12f,_0x3f9765={'keyID':_0x3cd12f[_0x472830(0x22a)],'verified':((async()=>{const _0x4a1504=_0x472830;if(_0x1c7578[_0x4a1504(0x291)]===_0x4a1504(0x225))throw new _0x29778c(_0x1c7578['zwDCn']);else{if(!_0x1933a8)throw new Error('Could\x20not\x20find\x20signing\x20key\x20with\x20key\x20ID\x20'+_0x3cd12f[_0x4a1504(0x22a)][_0x4a1504(0x286)]());await _0x3cd12f['verify'](_0x1933a8['keyPacket'],_0x3cd12f[_0x4a1504(0x1ce)],_0x33842d[0x0],_0x4f9e88,_0x2c3020,_0x5096a6);const _0x255885=await _0x374fe0;if(_0x1c7578[_0x4a1504(0x27d)](_0x1933a8['getCreationTime'](),_0x255885[_0x4a1504(0x26e)]))throw new Error(_0x4a1504(0x214));try{await _0x357eb0[_0x4a1504(0x1d5)](_0x1933a8[_0x4a1504(0x221)](),_0x255885[_0x4a1504(0x26e)],undefined,_0x5096a6);}catch(_0x517829){if(_0x5096a6[_0x4a1504(0x26f)]&&_0x517829[_0x4a1504(0x261)][_0x4a1504(0x247)](/Signature creation time is in the future/))await _0x357eb0['getSigningKey'](_0x1933a8[_0x4a1504(0x221)](),_0x4f9e88,undefined,_0x5096a6);else throw _0x517829;}return!![];}})()),'signature':((async()=>{const _0x417cb4=await _0x374fe0,_0x1e496b=new PacketList();return _0x417cb4&&_0x1e496b['push'](_0x417cb4),new Signature(_0x1e496b);})())};return _0x3f9765[_0x472830(0x257)][_0x472830(0x226)](()=>{}),_0x3f9765[_0x472830(0x275)][_0x472830(0x226)](()=>{}),_0x3f9765;}export async function createVerificationObjects(_0xcee5bf,_0x404cb1,_0x3f9cee,_0x32ea59=new Date(),_0x386b3b=![],_0x7eecbc=_0x5ec7fb){const _0x3e0ebf=_0x20fd46,_0x201445={'JrOoM':_0x3e0ebf(0x209),'oCyGo':function(_0x67203b,_0x22ea12){return _0x67203b!==_0x22ea12;},'CYkSj':_0x3e0ebf(0x217),'zPipS':_0x3e0ebf(0x24c)};return Promise[_0x3e0ebf(0x227)](_0xcee5bf[_0x3e0ebf(0x20c)](function(_0x34efc3){const _0x5ab868=_0x3e0ebf,_0x1de561={'UnXhZ':_0x201445[_0x5ab868(0x1dd)]};if(_0x201445[_0x5ab868(0x22b)](_0x201445['CYkSj'],_0x201445[_0x5ab868(0x29a)]))throw new _0x4c039a(_0x1de561[_0x5ab868(0x2a7)]);else return['text',_0x201445[_0x5ab868(0x1cd)]][_0x5ab868(0x201)](_0x21986b['read'](_0x21986b[_0x5ab868(0x257)],_0x34efc3[_0x5ab868(0x1ce)]));})[_0x3e0ebf(0x255)](async function(_0x40f195){return createVerificationObject(_0x40f195,_0x404cb1,_0x3f9cee,_0x32ea59,_0x386b3b,_0x7eecbc);}));}export async function readMessage({armoredMessage:_0x10b9dd,binaryMessage:_0x36e8ab,config:_0xe16ddf,..._0xc6bf25}){const _0x17f6e8=_0x20fd46,_0x5866e9={'kHANe':function(_0x39d4ee,_0x351916){return _0x39d4ee||_0x351916;},'VfEFn':'readMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`armoredMessage`\x20or\x20`binaryMessage`','rHrtH':_0x17f6e8(0x290),'hDddf':_0x17f6e8(0x237),'tDpWs':_0x17f6e8(0x298)};_0xe16ddf={..._0x5ec7fb,..._0xe16ddf};let _0x4cf5ff=_0x5866e9['kHANe'](_0x10b9dd,_0x36e8ab);if(!_0x4cf5ff)throw new Error(_0x5866e9['VfEFn']);if(_0x10b9dd&&!_0x188111[_0x17f6e8(0x2ac)](_0x10b9dd)&&!_0x188111[_0x17f6e8(0x1d7)](_0x10b9dd))throw new Error(_0x5866e9[_0x17f6e8(0x289)]);if(_0x36e8ab&&!_0x188111[_0x17f6e8(0x213)](_0x36e8ab)&&!_0x188111[_0x17f6e8(0x1d7)](_0x36e8ab)){if(_0x5866e9[_0x17f6e8(0x230)]===_0x17f6e8(0x237))throw new Error(_0x17f6e8(0x1d6));else this['packets']=_0x20b190||new _0x3d5f2d();}const _0x505711=Object[_0x17f6e8(0x25f)](_0xc6bf25);if(_0x505711[_0x17f6e8(0x235)]>0x0)throw new Error(_0x17f6e8(0x258)+_0x505711[_0x17f6e8(0x215)](',\x20'));const _0x2b032e=_0x188111[_0x17f6e8(0x1d7)](_0x4cf5ff);if(_0x10b9dd){const {type:_0x7331c8,data:_0x468527}=await unarmor(_0x4cf5ff,_0xe16ddf);if(_0x7331c8!==_0x21986b['armor']['message'])throw new Error(_0x5866e9['tDpWs']);_0x4cf5ff=_0x468527;}const _0x4c4f5c=await PacketList[_0x17f6e8(0x27a)](_0x4cf5ff,allowedMessagePackets,_0xe16ddf),_0x12aec4=new Message(_0x4c4f5c);return _0x12aec4[_0x17f6e8(0x223)]=_0x2b032e,_0x12aec4;}export async function createMessage({text:_0x20ecd0,binary:_0x22bdce,filename:_0x1d1c4b,date:date=new Date(),format:format=_0x20ecd0!==undefined?'utf8':'binary',..._0x2733e8}){const _0x5e16cf=_0x20fd46,_0x25799f={'FdKwq':_0x5e16cf(0x248),'Rptnw':function(_0x55eee5,_0x53d752){return _0x55eee5===_0x53d752;},'mLYzn':_0x5e16cf(0x1fc),'oAZOg':_0x5e16cf(0x2b3),'hQAZz':function(_0x57c992,_0x1f2072){return _0x57c992!==_0x1f2072;},'QJYSU':function(_0xee8331,_0x3ccda1){return _0xee8331!==_0x3ccda1;}},_0x2b7091=_0x20ecd0!==undefined?_0x20ecd0:_0x22bdce;if(_0x25799f[_0x5e16cf(0x1dc)](_0x2b7091,undefined))throw new Error(_0x5e16cf(0x239));if(_0x20ecd0&&!_0x188111['isString'](_0x20ecd0)&&!_0x188111[_0x5e16cf(0x1d7)](_0x20ecd0)){if(_0x25799f['mLYzn']!==_0x25799f[_0x5e16cf(0x2b5)]){const _0x531c71=this['unwrapCompressed'](),_0x5970d5=_0x531c71[_0x5e16cf(0x1d4)][_0x5e16cf(0x25b)](_0x431ceb[_0x5e16cf(0x29c)]['literalData']);if(_0x5970d5)return _0x5970d5['getText']();return null;}else throw new Error(_0x5e16cf(0x1d2));}if(_0x22bdce&&!_0x188111['isUint8Array'](_0x22bdce)&&!_0x188111[_0x5e16cf(0x1d7)](_0x22bdce))throw new Error(_0x5e16cf(0x23c));const _0x2029d4=Object[_0x5e16cf(0x25f)](_0x2733e8);if(_0x2029d4[_0x5e16cf(0x235)]>0x0)throw new Error(_0x5e16cf(0x258)+_0x2029d4[_0x5e16cf(0x215)](',\x20'));const _0x187a08=_0x188111[_0x5e16cf(0x1d7)](_0x2b7091),_0x255192=new LiteralDataPacket(date);if(_0x20ecd0!==undefined){if(_0x25799f[_0x5e16cf(0x1dc)](_0x25799f[_0x5e16cf(0x297)],'qJHEj'))_0x255192[_0x5e16cf(0x208)](_0x2b7091,_0x21986b[_0x5e16cf(0x2ab)](_0x21986b[_0x5e16cf(0x216)],format));else throw new _0x4a91a5(_0x25799f[_0x5e16cf(0x21a)]);}else _0x255192[_0x5e16cf(0x288)](_0x2b7091,_0x21986b[_0x5e16cf(0x2ab)](_0x21986b[_0x5e16cf(0x216)],format));_0x25799f[_0x5e16cf(0x249)](_0x1d1c4b,undefined)&&(_0x25799f[_0x5e16cf(0x20d)](_0x5e16cf(0x24b),_0x5e16cf(0x1df))?_0x255192[_0x5e16cf(0x23a)](_0x1d1c4b):_0x5f0af4['correspondingSigReject'](_0x19ad50));const _0x2d960b=new PacketList();_0x2d960b[_0x5e16cf(0x1f5)](_0x255192);const _0x16b5fc=new Message(_0x2d960b);return _0x16b5fc[_0x5e16cf(0x223)]=_0x187a08,_0x16b5fc;}function _0x317d(){const _0xa6cc88=['setText','No\x20public\x20key\x20encrypted\x20session\x20key\x20packet\x20found.','x448','uncompressed','filter','QJYSU','GgXNj','correspondingSig','correspondingSigReject','GediP','13063656kOEFfs','isUint8Array','Key\x20is\x20newer\x20than\x20the\x20signature','join','literal','DNsyv','rsaEncryptSign','pHGPJ','FdKwq','DhrTq','NFpqC','UqZwL','fromSignaturePacket','A\x20non-preferred\x20symmetric\x20algorithm\x20was\x20used.','3RlZzXv','getKeyID','2801925bkPARS','fromStream','Could\x20not\x20find\x20signing\x20key\x20with\x20key\x20ID\x20','WkToj','catch','all','YhJBO','1930KTOIHB','issuerKeyID','oCyGo','gNeIv','sessionKey','flafo','encryptSessionKey','hDddf','EKzoL','getText','5736696ywaJcX','getKeys','length','cipherAlgorithm','QUpFw','verifyDetached','createMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`text`\x20or\x20`binary`','setFilename','decryptSessionKeys','createMessage:\x20options.binary\x20must\x20be\x20a\x20Uint8Array\x20or\x20stream','publicKeyEncryptedSessionKey','tag','WbFCZ','ljOMs','aeadAlgorithm','No\x20symmetrically\x20encrypted\x20session\x20key\x20packet\x20found.','SaDPd','onePassSignature','370470aeEOga','EASXC','match','Decryption\x20key\x20is\x20not\x20decrypted.','hQAZz','boxJh','nXxZh','binary','zHtJr','unwrapCompressed','decrypt','text','oLdXs','yKoOc','aIymz','29998ypKAlB','map','31HcQtyv','signature','Unknown\x20option:\x20','constructor','LKeeU','findPacket','lDMHm','getDecryptionKeys','symmetricallyEncryptedData','keys','udfSC','message','hLpAu','generateSessionKey','wFhwr','wyXTZ','lhLYh','wTauc','read','getFilename','hash','getPrimarySelfSignature','armor','14476SvJQAV','created','allowInsecureVerificationWithReformattedKeys','No\x20encrypted\x20data\x20found','No\x20key\x20or\x20password\x20specified.','CMyPk','klhwQ','Decryption\x20failed.','verified','isPrivate','LEQms','yfGRi','QkWOE','fromBinary','Lbchp','passwordCollisionCheck','cscMG','Can\x20only\x20verify\x20message\x20with\x20one\x20literal\x20data\x20packet.','cast5','getEncryptionKey','hashed','VfsWm','xhaqk','Libkx','JUWCd','toHex','xhyAy','setBytes','rHrtH','KyQfZ','vjgIq','cmuHn','EWEmd','naNGf','pgVGY','readMessage:\x20options.armoredMessage\x20must\x20be\x20a\x20string\x20or\x20stream','gcZdA','filterByTag','publicKeyID','qGgAf','abort','Could\x20not\x20generate\x20a\x20session\x20key\x20compatible\x20with\x20the\x20given\x20`encryptionKeys`:\x20X22519\x20and\x20X448\x20keys\x20can\x20only\x20be\x20used\x20to\x20encrypt\x20AES\x20session\x20keys;\x20change\x20`config.preferredSymmetricAlgorithm`\x20accordingly.','oAZOg','Armored\x20text\x20not\x20of\x20type\x20message','algorithm','CYkSj','LSirp','packet','concat','constantTimePKCS1DecryptionSupportedSymmetricAlgorithms','constructAllowedPackets','close','lPAmj','Session\x20key\x20decryption\x20failed.','YIfIH','aes256','KCMge','cNSgV','UnXhZ','stream','JWVwR','printDebugError','write','isString','encrypt','compression','21TKDHuZ','publicKey','encrypted','then','qJHEj','isDecrypted','mLYzn','GqDcu','iFEED','fromObject','fZmvv','zPipS','signatureType','eWCAE','No\x20literal\x20data\x20packet\x20to\x20sign.','RJlQC','createMessage:\x20options.text\x20must\x20be\x20a\x20string\x20or\x20stream','readMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`armoredMessage`\x20or\x20`binaryMessage`','packets','getSigningKey','readMessage:\x20options.binaryMessage\x20must\x20be\x20a\x20Uint8Array\x20or\x20stream','isStream','version','aes128','signDetached','kYbPW','Rptnw','JrOoM','aead','WzLOZ','publicKeyAlgorithm','CEQVO','Invalid\x20session\x20key\x20for\x20decryption.','dOZiS','No\x20keys,\x20passwords,\x20or\x20session\x20key\x20provided.','symEncryptedSessionKey','x25519','from','sign','correspondingSigResolve','literalData','signatureData','getSigningKeyIDs','compress','JqXnd','EVEFF','2873748xBlJSB','Invalid\x20session\x20key\x20for\x20encryption.','preferredSymmetricAlgorithms','symmetric','WBQUo','push','reverse','forEach','aeadEncryptedData','readToEnd','GQbsN','oCleM','MSfmY','XLues','sSIHU','RWjVE','verify','includes','9tyyqjg','sessionKeyAlgorithm','WKMsM','keyPacket','wqETQ','appendSignature'];_0x317d=function(){return _0xa6cc88;};return _0x317d();}