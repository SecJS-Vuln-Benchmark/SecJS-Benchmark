const _0x59d2e2=_0x4ceb;(function(_0xfa6917,_0x548b43){const _0x1ffa12=_0x4ceb,_0x3041ad=_0xfa6917();while(!![]){try{const _0x4a36e4=parseInt(_0x1ffa12(0x1a8))/0x1*(parseInt(_0x1ffa12(0x1be))/0x2)+-parseInt(_0x1ffa12(0x1a3))/0x3*(parseInt(_0x1ffa12(0x1a2))/0x4)+-parseInt(_0x1ffa12(0x288))/0x5+parseInt(_0x1ffa12(0x20a))/0x6+parseInt(_0x1ffa12(0x2d5))/0x7+-parseInt(_0x1ffa12(0x296))/0x8*(-parseInt(_0x1ffa12(0x1c4))/0x9)+-parseInt(_0x1ffa12(0x1d9))/0xa;if(_0x4a36e4===_0x548b43)break;else _0x3041ad['push'](_0x3041ad['shift']());}catch(_0x54e3a9){_0x3041ad['push'](_0x3041ad['shift']());}}}(_0x47ca,0x2d7a3));function _0x4ceb(_0x32c6dc,_0x1d9c89){const _0x47caf9=_0x47ca();return _0x4ceb=function(_0x4ceb15,_0xc06b3){_0x4ceb15=_0x4ceb15-0x19c;let _0x50de2c=_0x47caf9[_0x4ceb15];return _0x50de2c;},_0x4ceb(_0x32c6dc,_0x1d9c89);}const test=require(_0x59d2e2(0x1ef)),crypto=require(_0x59d2e2(0x1a0)),base64url=require('../../lib/help/base64url'),{JWKS,JWK:{generateSync},JWE,errors}=require(_0x59d2e2(0x28d));test(_0x59d2e2(0x1d2),_0xdf7acc=>{const _0x250213=_0x59d2e2,_0x14a7a8={'YQvvb':_0x250213(0x240),'GRldO':_0x250213(0x1ac),'fjjZz':'bar','FwubJ':_0x250213(0x286)};;[{},new Object(),![],null,Infinity,0x0,'',Buffer[_0x250213(0x241)](_0x250213(0x1ac))]['forEach'](_0x44385e=>{const _0x4a7b55=_0x250213,_0x1974d2={'UqVzm':_0x4a7b55(0x1ac)};_0xdf7acc['throws'](()=>{const _0x240713=_0x4a7b55;JWE[_0x240713(0x304)]({'header':{'alg':_0x14a7a8[_0x240713(0x1e8)]},'payload':_0x14a7a8[_0x240713(0x2c0)],'ciphertext':_0x14a7a8[_0x240713(0x20e)]},generateSync(_0x240713(0x29e)),{'keyManagementAlgorithms':_0x44385e});},{'instanceOf':TypeError,'message':_0x14a7a8['FwubJ']}),_0xdf7acc[_0x4a7b55(0x2ad)](()=>{const _0x38d084=_0x4a7b55;JWE[_0x38d084(0x304)]({'header':{'alg':_0x38d084(0x240)},'payload':_0x1974d2[_0x38d084(0x1c2)],'ciphertext':_0x38d084(0x211)},generateSync(_0x38d084(0x29e)),{'keyManagementAlgorithms':[_0x44385e]});},{'instanceOf':TypeError,'message':_0x14a7a8[_0x4a7b55(0x248)]});});}),test(_0x59d2e2(0x218),_0x516021=>{const _0x2e52f5=_0x59d2e2,_0x1d2f73={'AHBnv':'bar','YNlaH':function(_0x265961,_0x5c5cb6){return _0x265961(_0x5c5cb6);},'Ycwbq':'\x22contentEncryptionAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','sSeoU':_0x2e52f5(0x1ac)};;[{},new Object(),![],null,Infinity,0x0,'',Buffer['from'](_0x1d2f73[_0x2e52f5(0x1f3)])][_0x2e52f5(0x1b1)](_0x36dc24=>{const _0x2e78aa=_0x2e52f5,_0x4f64ba={'DOAES':_0x2e78aa(0x240),'Rnctb':function(_0x2af3a5,_0x198292){return _0x2af3a5(_0x198292);},'VpDPi':_0x2e78aa(0x29e)};_0x516021['throws'](()=>{const _0xd77972=_0x2e78aa;JWE[_0xd77972(0x304)]({'header':{'alg':_0xd77972(0x240)},'payload':_0xd77972(0x1ac),'ciphertext':_0x1d2f73['AHBnv']},_0x1d2f73[_0xd77972(0x1e0)](generateSync,_0xd77972(0x29e)),{'contentEncryptionAlgorithms':_0x36dc24});},{'instanceOf':TypeError,'message':_0x2e78aa(0x23f)}),_0x516021['throws'](()=>{const _0x364b8d=_0x2e78aa;JWE[_0x364b8d(0x304)]({'header':{'alg':_0x4f64ba[_0x364b8d(0x1e5)]},'payload':_0x364b8d(0x1ac),'ciphertext':_0x364b8d(0x211)},_0x4f64ba[_0x364b8d(0x301)](generateSync,_0x4f64ba[_0x364b8d(0x2a6)]),{'contentEncryptionAlgorithms':[_0x36dc24]});},{'instanceOf':TypeError,'message':_0x1d2f73[_0x2e78aa(0x1b7)]});});}),test(_0x59d2e2(0x227),_0x1c51c8=>{const _0x289c60=_0x59d2e2,_0x51dda1={'GNyqW':_0x289c60(0x223),'YmowP':_0x289c60(0x21a)};_0x1c51c8[_0x289c60(0x2ad)](()=>{const _0x377d63=_0x289c60;JWE[_0x377d63(0x304)]('',generateSync(_0x377d63(0x29e)));},{'instanceOf':errors[_0x289c60(0x1a1)],'code':_0x289c60(0x21a),'message':_0x51dda1[_0x289c60(0x270)]}),_0x1c51c8['throws'](()=>{JWE['decrypt']('...',generateSync('oct'));},{'instanceOf':errors[_0x289c60(0x1a1)],'code':_0x51dda1['YmowP'],'message':_0x289c60(0x223)}),_0x1c51c8[_0x289c60(0x2ad)](()=>{const _0x486615=_0x289c60;JWE[_0x486615(0x304)](_0x486615(0x1b9),generateSync(_0x486615(0x29e)));},{'instanceOf':errors[_0x289c60(0x1a1)],'code':_0x51dda1['YmowP'],'message':_0x289c60(0x223)});}),test(_0x59d2e2(0x268),_0x6aaaa6=>{const _0x29b02e=_0x59d2e2,_0x476d9f={'SwzSW':_0x29b02e(0x1ac)},_0x1f5e70=generateSync(_0x29b02e(0x29e),undefined,{'key_ops':[_0x29b02e(0x283)]});_0x6aaaa6[_0x29b02e(0x2ad)](()=>{const _0x359bd4=_0x29b02e;JWE[_0x359bd4(0x2fc)](_0x476d9f[_0x359bd4(0x282)],_0x1f5e70);},{'instanceOf':errors[_0x29b02e(0x1a1)],'code':_0x29b02e(0x21a),'message':_0x29b02e(0x1b2)});}),test(_0x59d2e2(0x21b),_0x29ede4=>{const _0x361dbb=_0x59d2e2,_0x1c7719={'viEJK':'foo','AgPXf':_0x361dbb(0x1f4),'YZNrd':_0x361dbb(0x29e),'xcVvm':function(_0x3c3e70,_0x431184){return _0x3c3e70 in _0x431184;},'ZrETg':'electron','BNcHL':function(_0x5d078b,_0x38d29f){return _0x5d078b(_0x38d29f);},'ivIBD':_0x361dbb(0x1e7),'EbyjQ':'RSA-OAEP','aaYCb':'ECDH-ES+A128KW','tPkrn':_0x361dbb(0x291)},_0x5289ca=new JWE[(_0x361dbb(0x1a6))](_0x1c7719[_0x361dbb(0x2af)]);_0x5289ca[_0x361dbb(0x1da)](generateSync(_0x1c7719[_0x361dbb(0x1f5)])),_0x5289ca[_0x361dbb(0x1da)](generateSync(_0x1c7719[_0x361dbb(0x24e)],0x100));!_0x1c7719[_0x361dbb(0x201)](_0x1c7719['ZrETg'],process['versions'])&&_0x5289ca[_0x361dbb(0x1da)](_0x1c7719[_0x361dbb(0x2d0)](generateSync,'EC'));const _0x63de98=_0x5289ca[_0x361dbb(0x2fc)](_0x1c7719[_0x361dbb(0x27b)]);_0x29ede4['is'](_0x63de98['unprotected'],undefined),_0x29ede4[_0x361dbb(0x2ee)](base64url['JSON']['decode'](_0x63de98['protected']),{'enc':'A128CBC-HS256'}),_0x29ede4[_0x361dbb(0x2ee)](_0x63de98['recipients'][0x0]['header'],{'alg':_0x1c7719[_0x361dbb(0x2c5)]});if(!(_0x361dbb(0x297)in process[_0x361dbb(0x2c3)])){_0x29ede4[_0x361dbb(0x2ee)](_0x63de98[_0x361dbb(0x2cb)][0x1][_0x361dbb(0x1d1)],{'alg':_0x361dbb(0x2d4)});const {epk:_0x3826ab,..._0x21f7a6}=_0x63de98[_0x361dbb(0x2cb)][0x2][_0x361dbb(0x1d1)];_0x29ede4[_0x361dbb(0x2ee)](_0x21f7a6,{'alg':_0x1c7719[_0x361dbb(0x267)]});}else{const {alg:_0x529356,..._0x5da9f1}=_0x63de98[_0x361dbb(0x2cb)][0x1][_0x361dbb(0x1d1)];_0x29ede4['is'](_0x529356,_0x361dbb(0x2e3)),_0x29ede4[_0x361dbb(0x260)]('iv'in _0x5da9f1),_0x29ede4['true'](_0x1c7719[_0x361dbb(0x201)](_0x1c7719[_0x361dbb(0x26d)],_0x5da9f1));}}),test('JWE\x20no\x20alg/enc\x20specified\x20(multi\x20recipient)\x20with\x20per-recipient\x20headers',_0x16a71f=>{const _0x163a99=_0x59d2e2,_0xd393c4={'BbFsa':'foo','nCQgk':function(_0x1279d4,_0x137653,_0xd88f07,_0x52acee){return _0x1279d4(_0x137653,_0xd88f07,_0x52acee);},'trtZR':_0x163a99(0x1f4),'fTbuq':_0x163a99(0x2d9),'cxoiD':function(_0x18c8ac,_0x91f0c0,_0x44455b,_0x4956b5){return _0x18c8ac(_0x91f0c0,_0x44455b,_0x4956b5);},'nOkHm':'kid_3','TpZei':function(_0x2fa4f3,_0x46672d){return _0x2fa4f3 in _0x46672d;},'wKdnM':'electron','rUQUs':function(_0x3e5c29,_0x59b5a8,_0x384bad,_0x46cbdf){return _0x3e5c29(_0x59b5a8,_0x384bad,_0x46cbdf);},'rsapC':_0x163a99(0x274),'GnJEQ':_0x163a99(0x1e7),'qQsjY':_0x163a99(0x279),'PHiQy':function(_0x575efc,_0x26bb25){return _0x575efc in _0x26bb25;},'gsbrv':_0x163a99(0x291)},_0x338edb=new JWE[(_0x163a99(0x1a6))](_0xd393c4[_0x163a99(0x246)]),_0x38b14c=_0xd393c4[_0x163a99(0x207)](generateSync,_0xd393c4[_0x163a99(0x2b0)],undefined,{'kid':_0xd393c4['fTbuq']});_0x338edb[_0x163a99(0x1da)](_0x38b14c,{'kid':_0x38b14c[_0x163a99(0x1b3)]});const _0x2356fd=_0xd393c4[_0x163a99(0x1c7)](generateSync,'oct',0x100,{'kid':_0xd393c4[_0x163a99(0x204)]});_0x338edb[_0x163a99(0x1da)](_0x2356fd,{'kid':_0x2356fd['kid']});if(!_0xd393c4[_0x163a99(0x2d6)](_0xd393c4['wKdnM'],process[_0x163a99(0x2c3)])){const _0x470f60=_0xd393c4['rUQUs'](generateSync,'EC',undefined,{'kid':_0xd393c4['rsapC']});_0x338edb[_0x163a99(0x1da)](_0x470f60,{'kid':_0x470f60[_0x163a99(0x1b3)]});}const _0x2e1781=_0x338edb[_0x163a99(0x2fc)](_0xd393c4[_0x163a99(0x2ef)]);_0x16a71f['is'](_0x2e1781[_0x163a99(0x1ec)],undefined),_0x16a71f[_0x163a99(0x2ee)](base64url[_0x163a99(0x1fc)][_0x163a99(0x1e4)](_0x2e1781['protected']),{'enc':_0xd393c4['qQsjY']}),_0x16a71f[_0x163a99(0x2ee)](_0x2e1781[_0x163a99(0x2cb)][0x0][_0x163a99(0x1d1)],{'alg':_0x163a99(0x278),'kid':'kid_1'});if(!_0xd393c4[_0x163a99(0x2fd)](_0xd393c4['wKdnM'],process[_0x163a99(0x2c3)])){_0x16a71f[_0x163a99(0x2ee)](_0x2e1781[_0x163a99(0x2cb)][0x1][_0x163a99(0x1d1)],{'alg':_0x163a99(0x2d4),'kid':'kid_3'});const {epk:_0x43a13f,..._0x3365ea}=_0x2e1781[_0x163a99(0x2cb)][0x2][_0x163a99(0x1d1)];_0x16a71f[_0x163a99(0x2ee)](_0x3365ea,{'alg':_0x163a99(0x2b7),'kid':_0xd393c4['rsapC']});}else{const {alg:_0x3290a,kid:_0x58fc1c,..._0x178219}=_0x2e1781[_0x163a99(0x2cb)][0x1][_0x163a99(0x1d1)];_0x16a71f['is'](_0x3290a,_0x163a99(0x2e3)),_0x16a71f['is'](_0x58fc1c,_0x163a99(0x216)),_0x16a71f[_0x163a99(0x260)](_0xd393c4[_0x163a99(0x2fd)]('iv',_0x178219)),_0x16a71f[_0x163a99(0x260)](_0xd393c4[_0x163a99(0x1e2)]in _0x178219);}}),test(_0x59d2e2(0x21c),_0x478e7e=>{const _0xa8176=_0x59d2e2,_0x4e0439={'JfHEk':_0xa8176(0x1ac),'UsHpD':function(_0x201b01,_0x3504f9){return _0x201b01(_0x3504f9);},'DDPoV':'flattened'},_0x48935a=new JWE[(_0xa8176(0x1a6))](_0x4e0439[_0xa8176(0x22f)]);_0x48935a['recipient'](_0x4e0439[_0xa8176(0x2aa)](generateSync,'RSA'));const _0xb08de1=_0x48935a[_0xa8176(0x2fc)](_0x4e0439[_0xa8176(0x253)]);_0x478e7e['is'](_0xb08de1[_0xa8176(0x1ec)],undefined),_0x478e7e['is'](_0xb08de1[_0xa8176(0x1d1)],undefined),_0x478e7e[_0xa8176(0x2ee)](base64url['JSON'][_0xa8176(0x1e4)](_0xb08de1['protected']),{'alg':'RSA-OAEP','enc':'A128CBC-HS256'});}),test('JWE\x20no\x20alg/enc\x20specified\x20(single\x20rsa),\x20with\x20protected\x20header',_0x21f462=>{const _0xfdac68=_0x59d2e2,_0x5f35a8={'EhQrj':function(_0x31f4e3,_0x1002d5,_0x580d47,_0x62820b){return _0x31f4e3(_0x1002d5,_0x580d47,_0x62820b);},'FGSwk':_0xfdac68(0x278),'KifVQ':_0xfdac68(0x279)},_0x53e237=_0x5f35a8[_0xfdac68(0x2df)](generateSync,_0xfdac68(0x1f4),undefined,{'kid':'jwk\x20key\x20id'}),_0x8762d4=new JWE[(_0xfdac68(0x1a6))](_0xfdac68(0x1ac),{'kid':_0x53e237[_0xfdac68(0x1b3)]});_0x8762d4['recipient'](_0x53e237);const _0x5a18b3=_0x8762d4[_0xfdac68(0x2fc)]('flattened');_0x21f462['is'](_0x5a18b3['unprotected'],undefined),_0x21f462['is'](_0x5a18b3[_0xfdac68(0x1d1)],undefined),_0x21f462[_0xfdac68(0x2ee)](base64url[_0xfdac68(0x1fc)][_0xfdac68(0x1e4)](_0x5a18b3[_0xfdac68(0x1ed)]),{'alg':_0x5f35a8['FGSwk'],'enc':_0x5f35a8['KifVQ'],'kid':_0xfdac68(0x275)});}),test(_0x59d2e2(0x2bf),_0x1cfc94=>{const _0x28d232=_0x59d2e2,_0x1e3bba={'pixSD':'RSA','kpCBb':'flattened','MSslC':_0x28d232(0x1d6)},_0x104a36=generateSync(_0x1e3bba[_0x28d232(0x1a7)]),_0xc8118f=new JWE[(_0x28d232(0x1a6))](_0x28d232(0x1ac),{'enc':'A256CBC-HS512'});_0xc8118f[_0x28d232(0x1da)](_0x104a36);const _0x42549f=_0xc8118f[_0x28d232(0x2fc)](_0x1e3bba[_0x28d232(0x236)]);_0x1cfc94['is'](_0x42549f[_0x28d232(0x1ec)],undefined),_0x1cfc94['is'](_0x42549f[_0x28d232(0x1d1)],undefined),_0x1cfc94[_0x28d232(0x2ee)](base64url[_0x28d232(0x1fc)][_0x28d232(0x1e4)](_0x42549f[_0x28d232(0x1ed)]),{'alg':_0x28d232(0x278),'enc':_0x1e3bba[_0x28d232(0x2cd)]});}),test(_0x59d2e2(0x277),_0x4b5365=>{const _0x2c8710=_0x59d2e2,_0x433c02={'RkkCC':_0x2c8710(0x1d6),'ESGCD':_0x2c8710(0x1c9),'Yyaor':'RSA-OAEP'},_0x225fa3=generateSync(_0x2c8710(0x1f4)),_0x72bb4e=new JWE[(_0x2c8710(0x1a6))](_0x2c8710(0x1ac),undefined,undefined,{'enc':_0x433c02[_0x2c8710(0x1ea)]});_0x72bb4e['recipient'](_0x225fa3);const _0x40a448=_0x72bb4e[_0x2c8710(0x2fc)](_0x433c02[_0x2c8710(0x2c7)]);_0x4b5365[_0x2c8710(0x2ee)](_0x40a448[_0x2c8710(0x1ec)],{'enc':_0x433c02[_0x2c8710(0x1ea)]}),_0x4b5365['is'](_0x40a448[_0x2c8710(0x1d1)],undefined),_0x4b5365['deepEqual'](base64url[_0x2c8710(0x1fc)][_0x2c8710(0x1e4)](_0x40a448['protected']),{'alg':_0x433c02[_0x2c8710(0x1e3)]});}),test(_0x59d2e2(0x255),_0x3e60dd=>{const _0x1e6a7f=_0x59d2e2,_0x472817={'ryqpN':_0x1e6a7f(0x21a),'nRNky':_0x1e6a7f(0x2d3),'KtNgl':_0x1e6a7f(0x29e),'EsiRC':_0x1e6a7f(0x1c9),'NEbKJ':function(_0x2c5ae6,_0x43c83a){return _0x2c5ae6 in _0x43c83a;},'OTXaV':_0x1e6a7f(0x297),'Nuypc':_0x1e6a7f(0x25e),'ejfir':_0x1e6a7f(0x279)},_0x39bcd5=new JWE[(_0x1e6a7f(0x1a6))](_0x1e6a7f(0x1ac));_0x39bcd5[_0x1e6a7f(0x1da)](generateSync(_0x472817[_0x1e6a7f(0x1dc)],0x80));const _0x200a84=_0x39bcd5[_0x1e6a7f(0x2fc)](_0x472817[_0x1e6a7f(0x1d4)]);_0x3e60dd['is'](_0x200a84[_0x1e6a7f(0x1ec)],undefined),_0x3e60dd['is'](_0x200a84[_0x1e6a7f(0x1d1)],undefined);if(!_0x472817[_0x1e6a7f(0x2c2)](_0x472817[_0x1e6a7f(0x210)],process[_0x1e6a7f(0x2c3)])){if('ZzOIj'===_0x472817[_0x1e6a7f(0x1a5)]){const _0x1102b1=new _0xaafd4d[(_0x1e6a7f(0x1a6))](_0x1e6a7f(0x1ac));_0x3e03e1[_0x1e6a7f(0x2ad)](()=>{const _0xecdac2=_0x1e6a7f;_0x1102b1[_0xecdac2(0x2fc)](_0xecdac2(0x2ac));},{'instanceOf':_0x3dbed4[_0x1e6a7f(0x1a1)],'code':_0x472817[_0x1e6a7f(0x266)],'message':_0x472817[_0x1e6a7f(0x2f9)]});}else _0x3e60dd['deepEqual'](base64url[_0x1e6a7f(0x1fc)][_0x1e6a7f(0x1e4)](_0x200a84[_0x1e6a7f(0x1ed)]),{'alg':_0x1e6a7f(0x23c),'enc':_0x472817[_0x1e6a7f(0x2b1)]});}else{const {iv:_0x32c2ac,tag:_0x2ec99a,..._0x42e4de}=base64url[_0x1e6a7f(0x1fc)][_0x1e6a7f(0x1e4)](_0x200a84['protected']);_0x3e60dd[_0x1e6a7f(0x2ee)](_0x42e4de,{'alg':_0x1e6a7f(0x215),'enc':_0x472817[_0x1e6a7f(0x2b1)]}),_0x3e60dd[_0x1e6a7f(0x24f)](_0x32c2ac),_0x3e60dd[_0x1e6a7f(0x24f)](_0x2ec99a);}}),test('JWE\x20no\x20alg/enc\x20specified\x20(single\x20ec)',_0x1bb1d2=>{const _0x991d6c=_0x59d2e2,_0x5c0f01={'lsflJ':'foo','AiIQi':function(_0x44f9cb,_0xd768de){return _0x44f9cb(_0xd768de);}},_0x5eee76=new JWE['Encrypt'](_0x5c0f01[_0x991d6c(0x1ab)]);_0x5eee76[_0x991d6c(0x1da)](_0x5c0f01[_0x991d6c(0x2c1)](generateSync,'EC'));const _0xae466=_0x5eee76[_0x991d6c(0x2fc)](_0x991d6c(0x1c9));_0x1bb1d2['is'](_0xae466['unprotected'],undefined),_0x1bb1d2['is'](_0xae466[_0x991d6c(0x1d1)],undefined);const {epk:_0x578b04,..._0x4814a9}=base64url[_0x991d6c(0x1fc)]['decode'](_0xae466['protected']);_0x1bb1d2[_0x991d6c(0x2ee)](_0x4814a9,{'alg':'ECDH-ES','enc':_0x991d6c(0x279)});}),test(_0x59d2e2(0x2e6),_0x41a83a=>{const _0x3a399d=_0x59d2e2,_0x16fb9e={'XAagx':_0x3a399d(0x1ac),'CPZmY':_0x3a399d(0x1f4),'hqYso':_0x3a399d(0x27a),'iioWy':_0x3a399d(0x1c9),'jyEyU':'A128CBC-HS256'},_0x2a0d73=new JWE[(_0x3a399d(0x1a6))](_0x16fb9e[_0x3a399d(0x2a4)]);_0x2a0d73[_0x3a399d(0x1da)](generateSync(_0x16fb9e[_0x3a399d(0x29b)],undefined,{'alg':_0x16fb9e['hqYso'],'use':_0x3a399d(0x1ad)}));const _0x2394ec=_0x2a0d73[_0x3a399d(0x2fc)](_0x16fb9e[_0x3a399d(0x276)]);_0x41a83a['is'](_0x2394ec[_0x3a399d(0x1ec)],undefined),_0x41a83a['is'](_0x2394ec[_0x3a399d(0x1d1)],undefined),_0x41a83a[_0x3a399d(0x2ee)](base64url[_0x3a399d(0x1fc)]['decode'](_0x2394ec[_0x3a399d(0x1ed)]),{'alg':_0x16fb9e[_0x3a399d(0x251)],'enc':_0x16fb9e[_0x3a399d(0x2f6)]});}),test(_0x59d2e2(0x258),_0x3630af=>{const _0x4ca167=_0x59d2e2,_0x37307b={'VGADj':_0x4ca167(0x306),'eyaTv':function(_0xeeada1,_0x3070bb,_0x79fb0f,_0x265e22){return _0xeeada1(_0x3070bb,_0x79fb0f,_0x265e22);}},_0x3aedce=_0x37307b[_0x4ca167(0x2ca)](generateSync,_0x4ca167(0x29e),undefined,{'alg':'A128CBC-HS256'}),_0x592a4c=JWE[_0x4ca167(0x2fc)]['flattened'](_0x4ca167(0x1ac),_0x3aedce,{'alg':'dir','enc':_0x3aedce[_0x4ca167(0x1d7)]});delete _0x592a4c['iv'],_0x3630af[_0x4ca167(0x2ad)](()=>{const _0x10918f=_0x4ca167;_0x10918f(0x22c)!==_0x37307b[_0x10918f(0x250)]?JWE[_0x10918f(0x304)](_0x592a4c,_0x3aedce):_0x42dc13[_0x10918f(0x2fc)](_0x10918f(0x1ac),_0x2e0b26,_0x3c9f0d);},{'instanceOf':errors[_0x4ca167(0x1a1)],'code':_0x4ca167(0x21a),'message':'JWE\x20malformed\x20or\x20invalid\x20serialization'});}),test(_0x59d2e2(0x2e4),_0x3b067f=>{const _0x2dd563=_0x59d2e2,_0x3a30ed={'JpgiJ':function(_0x44b2c6,_0x5bed30,_0x3404be,_0x58105b){return _0x44b2c6(_0x5bed30,_0x3404be,_0x58105b);},'uufDk':'oct','PsIzz':_0x2dd563(0x279),'cCiwS':_0x2dd563(0x25f),'opSyS':'invalid\x20iv'},_0x2ebfcc=_0x3a30ed[_0x2dd563(0x28f)](generateSync,_0x3a30ed['uufDk'],undefined,{'alg':_0x3a30ed[_0x2dd563(0x220)]}),_0x1085c6=JWE[_0x2dd563(0x2fc)][_0x2dd563(0x1c9)](_0x2dd563(0x1ac),_0x2ebfcc,{'alg':_0x3a30ed['cCiwS'],'enc':_0x2ebfcc[_0x2dd563(0x1d7)]});_0x1085c6['iv']=base64url[_0x2dd563(0x1dd)](base64url[_0x2dd563(0x208)](_0x1085c6['iv'])[_0x2dd563(0x2e9)](0x1)),_0x3b067f[_0x2dd563(0x2ad)](()=>{const _0x5c1bf4=_0x2dd563;JWE[_0x5c1bf4(0x304)](_0x1085c6,_0x2ebfcc);},{'instanceOf':errors[_0x2dd563(0x1a1)],'code':'ERR_JWE_INVALID','message':_0x3a30ed[_0x2dd563(0x289)]});}),test(_0x59d2e2(0x214),_0x59f17d=>{const _0x4956b0=_0x59d2e2,_0x306194={'cpqfe':_0x4956b0(0x29e),'rpLJS':_0x4956b0(0x1ac),'eJQfK':'dir'},_0x3f673f=generateSync(_0x306194['cpqfe'],undefined,{'alg':_0x4956b0(0x279)}),_0x1b7bc4=JWE[_0x4956b0(0x2fc)][_0x4956b0(0x1c9)](_0x306194[_0x4956b0(0x2be)],_0x3f673f,{'alg':_0x306194[_0x4956b0(0x1b6)],'enc':_0x3f673f[_0x4956b0(0x1d7)]});delete _0x1b7bc4[_0x4956b0(0x291)],_0x59f17d[_0x4956b0(0x2ad)](()=>{const _0x33f547=_0x4956b0;JWE[_0x33f547(0x304)](_0x1b7bc4,_0x3f673f);},{'instanceOf':errors[_0x4956b0(0x1a1)],'code':_0x4956b0(0x21a),'message':_0x4956b0(0x223)});}),test(_0x59d2e2(0x21e),_0x1cf90b=>{const _0x2010bc=_0x59d2e2,_0x54d16f={'FDyNG':_0x2010bc(0x25f),'NvwBD':_0x2010bc(0x21a)},_0x37a59b=generateSync(_0x2010bc(0x29e),undefined,{'alg':_0x2010bc(0x279)}),_0x43f113=JWE[_0x2010bc(0x2fc)][_0x2010bc(0x1c9)](_0x2010bc(0x1ac),_0x37a59b,{'alg':_0x54d16f[_0x2010bc(0x1f0)],'enc':_0x37a59b[_0x2010bc(0x1d7)]});_0x43f113[_0x2010bc(0x291)]=base64url['encode'](base64url[_0x2010bc(0x208)](_0x43f113[_0x2010bc(0x291)])[_0x2010bc(0x2e9)](0x1)),_0x1cf90b[_0x2010bc(0x2ad)](()=>{JWE['decrypt'](_0x43f113,_0x37a59b);},{'instanceOf':errors['JWEInvalid'],'code':_0x54d16f[_0x2010bc(0x21f)],'message':_0x2010bc(0x23d)});}),test(_0x59d2e2(0x1b4),_0x22c4fd=>{const _0x2c4af4=_0x59d2e2,_0x54db33={'ugLjC':function(_0x240e1d,_0x2658d5,_0x53b609,_0x3a125a){return _0x240e1d(_0x2658d5,_0x53b609,_0x3a125a);},'wQCcb':_0x2c4af4(0x29e),'zUemk':_0x2c4af4(0x25b),'jPkic':_0x2c4af4(0x25f),'iLXrD':_0x2c4af4(0x21a),'LscLf':_0x2c4af4(0x223)},_0x3fa388=_0x54db33['ugLjC'](generateSync,_0x54db33[_0x2c4af4(0x20d)],0x80,{'alg':_0x54db33[_0x2c4af4(0x2c9)]}),_0x519aa7=JWE[_0x2c4af4(0x2fc)][_0x2c4af4(0x1c9)]('foo',_0x3fa388,{'alg':_0x54db33[_0x2c4af4(0x1c6)],'enc':_0x3fa388[_0x2c4af4(0x1d7)]});delete _0x519aa7['iv'],_0x22c4fd[_0x2c4af4(0x2ad)](()=>{const _0x10c12e=_0x2c4af4;JWE[_0x10c12e(0x304)](_0x519aa7,_0x3fa388);},{'instanceOf':errors[_0x2c4af4(0x1a1)],'code':_0x54db33['iLXrD'],'message':_0x54db33['LscLf']});}),test(_0x59d2e2(0x1cc),_0x5a00b3=>{const _0x492e=_0x59d2e2,_0x98cbc0={'nXumB':_0x492e(0x29e),'tSTSG':_0x492e(0x21a),'aoCEg':'invalid\x20iv'},_0x1c24bb=generateSync(_0x98cbc0[_0x492e(0x222)],0x80,{'alg':_0x492e(0x25b)}),_0x4819c0=JWE[_0x492e(0x2fc)][_0x492e(0x1c9)](_0x492e(0x1ac),_0x1c24bb,{'alg':_0x492e(0x25f),'enc':_0x1c24bb[_0x492e(0x1d7)]});_0x4819c0['iv']=base64url[_0x492e(0x1dd)](base64url['decodeToBuffer'](_0x4819c0['iv'])[_0x492e(0x2e9)](0x1)),_0x5a00b3[_0x492e(0x2ad)](()=>{JWE['decrypt'](_0x4819c0,_0x1c24bb);},{'instanceOf':errors[_0x492e(0x1a1)],'code':_0x98cbc0[_0x492e(0x2a9)],'message':_0x98cbc0[_0x492e(0x2f0)]});}),test(_0x59d2e2(0x2f1),_0x42e0da=>{const _0x331b2f=_0x59d2e2,_0x2145f5={'iyMSH':_0x331b2f(0x303),'rHjfp':_0x331b2f(0x29e),'fiPMd':_0x331b2f(0x25b),'aaYGe':_0x331b2f(0x1ac),'HnvjS':_0x331b2f(0x21a),'vLFsL':_0x331b2f(0x223)},_0x2ee6bf=generateSync(_0x2145f5[_0x331b2f(0x2cf)],0x80,{'alg':_0x2145f5['fiPMd']}),_0x5bbc83=JWE['encrypt'][_0x331b2f(0x1c9)](_0x2145f5['aaYGe'],_0x2ee6bf,{'alg':_0x331b2f(0x25f),'enc':_0x2ee6bf[_0x331b2f(0x1d7)]});delete _0x5bbc83[_0x331b2f(0x291)],_0x42e0da['throws'](()=>{const _0x5c01df=_0x331b2f;if(_0x2145f5['iyMSH']!=='eKOzm')JWE[_0x5c01df(0x304)](_0x5bbc83,_0x2ee6bf);else{const _0x731b8=_0x1c029f('oct');_0x1fa162[_0x5c01df(0x2fc)](_0x13d226['from']('foo'),_0x731b8),_0x46de73['pass']();}},{'instanceOf':errors[_0x331b2f(0x1a1)],'code':_0x2145f5[_0x331b2f(0x203)],'message':_0x2145f5[_0x331b2f(0x2c4)]});}),test(_0x59d2e2(0x2a2),_0x1abe51=>{const _0xaf3de8=_0x59d2e2,_0x4a2f6d={'vEluP':_0xaf3de8(0x29e),'moIlq':_0xaf3de8(0x25b)},_0x3a982e=generateSync(_0x4a2f6d[_0xaf3de8(0x20c)],0x80,{'alg':_0x4a2f6d[_0xaf3de8(0x238)]}),_0x13b05d=JWE[_0xaf3de8(0x2fc)][_0xaf3de8(0x1c9)](_0xaf3de8(0x1ac),_0x3a982e,{'alg':'dir','enc':_0x3a982e[_0xaf3de8(0x1d7)]});_0x13b05d['tag']=base64url[_0xaf3de8(0x1dd)](base64url[_0xaf3de8(0x208)](_0x13b05d[_0xaf3de8(0x291)])['slice'](0x1)),_0x1abe51['throws'](()=>{const _0x169c19=_0xaf3de8;JWE[_0x169c19(0x304)](_0x13b05d,_0x3a982e);},{'instanceOf':errors['JWEInvalid'],'code':_0xaf3de8(0x21a),'message':_0xaf3de8(0x23d)});}),test(_0x59d2e2(0x2f3),_0x8fdd02=>{const _0x56f92c=_0x59d2e2,_0x5a1b85={'gAsDn':function(_0x1b6c18,_0x382400){return _0x1b6c18(_0x382400);},'cALGo':_0x56f92c(0x1ac)},_0x4a7f28=_0x5a1b85[_0x56f92c(0x1e1)](generateSync,'oct');JWE[_0x56f92c(0x2fc)](Buffer['from'](_0x5a1b85[_0x56f92c(0x2e1)]),_0x4a7f28),_0x8fdd02[_0x56f92c(0x2dc)]();}),test('JWE\x20encrypt\x20accepts\x20string',_0x5c7ec1=>{const _0x1b0f4e=_0x59d2e2,_0xfc17d2={'HsNwm':function(_0x3358c3,_0x16497f){return _0x3358c3(_0x16497f);},'ajLtI':_0x1b0f4e(0x29e)},_0xf26fa2=_0xfc17d2['HsNwm'](generateSync,_0xfc17d2[_0x1b0f4e(0x2fb)]);JWE[_0x1b0f4e(0x2fc)](_0x1b0f4e(0x1ac),_0xf26fa2),_0x5c7ec1[_0x1b0f4e(0x2dc)]();}),test(_0x59d2e2(0x2a1),_0xd951c4=>{const _0x17a916=_0x59d2e2,_0x15ae03={'dtUvz':_0x17a916(0x29e)},_0x1f1df8=generateSync(_0x15ae03[_0x17a916(0x1d5)]);[[],{},![],!![],undefined,null,Infinity,0x0]['forEach'](_0x39652d=>{const _0x1e692a=_0x17a916;_0xd951c4['throws'](()=>{JWE['encrypt'](_0x39652d,_0x1f1df8);},{'instanceOf':TypeError,'message':_0x1e692a(0x1fa)});});}),test(_0x59d2e2(0x2e7),_0xdf37b1=>{const _0x345eae=_0x59d2e2,_0x5696b1={'HPYVE':function(_0x26a2b5,_0x51f413){return _0x26a2b5(_0x51f413);},'WcfmT':'oct','jCHkP':'foo'},_0x2ec9a3=_0x5696b1[_0x345eae(0x1f1)](generateSync,_0x5696b1[_0x345eae(0x2c8)]);[[],![],!![],null,Infinity,0x0,Buffer[_0x345eae(0x241)](_0x5696b1[_0x345eae(0x302)])][_0x345eae(0x1b1)](_0x470dab=>{const _0x3d6ec6=_0x345eae;_0xdf37b1[_0x3d6ec6(0x2ad)](()=>{const _0x269b9a=_0x3d6ec6;JWE['encrypt'](_0x269b9a(0x1ac),_0x2ec9a3,_0x470dab);},{'instanceOf':TypeError,'message':_0x3d6ec6(0x19f)});});}),test('JWE\x20encrypt\x20unprotectedHeader\x20rejects\x20non\x20objects\x20if\x20provided',_0x11cb79=>{const _0x4a7c55=_0x59d2e2,_0x5c3cdd={'oiESv':_0x4a7c55(0x1ac)};;[[],![],!![],null,Infinity,0x0,Buffer[_0x4a7c55(0x241)](_0x5c3cdd[_0x4a7c55(0x2ab)])][_0x4a7c55(0x1b1)](_0x12590c=>{const _0x2db4a6=_0x4a7c55;_0x11cb79['throws'](()=>{const _0x41ec57=_0x4ceb;new JWE[(_0x41ec57(0x1a6))]('foo',undefined,undefined,_0x12590c);},{'instanceOf':TypeError,'message':_0x2db4a6(0x1cd)});});}),test(_0x59d2e2(0x1db),_0x3c7c59=>{const _0x5b9c55=_0x59d2e2,_0x3b83ea={'OlXre':_0x5b9c55(0x240),'HcdOH':_0x5b9c55(0x29e),'ebbWP':_0x5b9c55(0x211),'PwgIt':'\x22keyManagementAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','BlEXF':function(_0x4aa2aa,_0x3d92c3){return _0x4aa2aa!==_0x3d92c3;},'tbtEq':function(_0x217109,_0x55684e){return _0x217109(_0x55684e);},'bXVYx':_0x5b9c55(0x1ac)},_0x54061c=_0x3b83ea[_0x5b9c55(0x1ff)](generateSync,_0x3b83ea[_0x5b9c55(0x232)]),_0x1d729a=new JWE[(_0x5b9c55(0x1a6))](_0x5b9c55(0x1ac));[[],![],!![],null,Infinity,0x0,Buffer[_0x5b9c55(0x241)](_0x3b83ea[_0x5b9c55(0x2a0)])][_0x5b9c55(0x1b1)](_0x3fdbad=>{const _0xaa6d62=_0x5b9c55,_0x47db42={'AkkMi':_0x3b83ea[_0xaa6d62(0x206)],'LwpDf':'foo','EDDaN':_0x3b83ea[_0xaa6d62(0x232)],'vPMRi':_0x3b83ea[_0xaa6d62(0x1ba)],'iGxip':function(_0x2dc3e4,_0x43d2f0){return _0x2dc3e4(_0x43d2f0);},'msNUp':_0x3b83ea[_0xaa6d62(0x292)]};if(_0x3b83ea[_0xaa6d62(0x1ee)](_0xaa6d62(0x249),'uCFiq')){const _0x42f752={'iRPrd':_0xaa6d62(0x1ac),'JqAkg':_0x47db42[_0xaa6d62(0x265)],'gRIqe':function(_0x1c69b3,_0x4cb836){return _0x47db42['iGxip'](_0x1c69b3,_0x4cb836);}};_0xee9ec9['throws'](()=>{const _0x4fcf95=_0xaa6d62;_0x36b0e6[_0x4fcf95(0x304)]({'header':{'alg':'HS256'},'payload':_0x42f752[_0x4fcf95(0x2b8)],'ciphertext':_0x42f752[_0x4fcf95(0x1f2)]},_0x42f752[_0x4fcf95(0x252)](_0x212512,_0x4fcf95(0x29e)),{'keyManagementAlgorithms':_0x1db840});},{'instanceOf':_0x1123f0,'message':_0x47db42[_0xaa6d62(0x1c3)]}),_0x58b292[_0xaa6d62(0x2ad)](()=>{const _0x55272b=_0xaa6d62;_0x1d877f[_0x55272b(0x304)]({'header':{'alg':_0x47db42[_0x55272b(0x1e9)]},'payload':_0x47db42[_0x55272b(0x2eb)],'ciphertext':_0x55272b(0x211)},_0x566821(_0x47db42[_0x55272b(0x2f8)]),{'keyManagementAlgorithms':[_0x528633]});},{'instanceOf':_0x46b2d7,'message':_0xaa6d62(0x286)});}else _0x3c7c59['throws'](()=>{const _0x437cb1=_0xaa6d62;_0x1d729a[_0x437cb1(0x1da)](_0x54061c,_0x3fdbad);},{'instanceOf':TypeError,'message':_0xaa6d62(0x299)});});}),test('JWE\x20encrypt\x20aad\x20rejects\x20non\x20buffers\x20and\x20non\x20strings',_0x14bf32=>{const _0x36a6a1=_0x59d2e2,_0x5378e8={'guvgT':_0x36a6a1(0x1e6)};;[[],![],!![],null,Infinity,0x0][_0x36a6a1(0x1b1)](_0x5e3d7b=>{const _0x1f43ac=_0x36a6a1;_0x14bf32['throws'](()=>{const _0x54197a=_0x4ceb;new JWE['Encrypt'](_0x54197a(0x1ac),undefined,_0x5e3d7b);},{'instanceOf':TypeError,'message':_0x5378e8[_0x1f43ac(0x1f7)]});});}),test(_0x59d2e2(0x26c),_0x5d4353=>{const _0x4bf229=_0x59d2e2,_0x32cf58={'gFfRM':_0x4bf229(0x1ac),'RnxBt':_0x4bf229(0x2d3)},_0x115515=new JWE[(_0x4bf229(0x1a6))](_0x32cf58[_0x4bf229(0x293)]);_0x5d4353[_0x4bf229(0x2ad)](()=>{const _0x209d3c=_0x4bf229;_0x115515[_0x209d3c(0x2fc)](_0x209d3c(0x2ac));},{'instanceOf':errors[_0x4bf229(0x1a1)],'code':_0x4bf229(0x21a),'message':_0x32cf58['RnxBt']});}),test(_0x59d2e2(0x263),_0x50a72c=>{const _0x43e4ff=_0x59d2e2,_0xae3b06={'ZiILp':function(_0x451907,_0x5aac1a,_0x4fc598,_0x163004){return _0x451907(_0x5aac1a,_0x4fc598,_0x163004);},'mmeEu':_0x43e4ff(0x279),'XJkhL':_0x43e4ff(0x1ac),'PgGdE':_0x43e4ff(0x25f),'XYzlH':'ERR_JWE_INVALID','QZXYY':function(_0x4a9e13,_0x4c9022){return _0x4a9e13!==_0x4c9022;},'bUzRI':_0x43e4ff(0x2f4),'xhQkp':_0x43e4ff(0x205),'ySbqA':_0x43e4ff(0x294)};;[[],![],!![],null,Infinity,0x0,_0x43e4ff(0x1ac),''][_0x43e4ff(0x1b1)](_0x326372=>{const _0x21c28b=_0x43e4ff,_0x39b225={'uLBRg':function(_0x5d5639,_0x5935aa){const _0x558c5b=_0x4ceb;return _0xae3b06[_0x558c5b(0x29a)](_0x5d5639,_0x5935aa);},'bmSwv':_0xae3b06['bUzRI']};if(_0xae3b06[_0x21c28b(0x2b9)]===_0x21c28b(0x231)){const _0x3e4aff=_0xae3b06['ZiILp'](_0x57e316,'oct',_0x47a8a1,{'alg':_0xae3b06['mmeEu']}),_0x2cf1ea=_0x47a56a['encrypt']['flattened'](_0xae3b06[_0x21c28b(0x245)],_0x3e4aff,{'alg':_0xae3b06[_0x21c28b(0x25a)],'enc':_0x3e4aff[_0x21c28b(0x1d7)]});delete _0x2cf1ea['iv'],_0x19bc18[_0x21c28b(0x2ad)](()=>{const _0x383da9=_0x21c28b;_0x41b3bc[_0x383da9(0x304)](_0x2cf1ea,_0x3e4aff);},{'instanceOf':_0x356e01[_0x21c28b(0x1a1)],'code':_0xae3b06[_0x21c28b(0x290)],'message':_0x21c28b(0x223)});}else{const _0x262cb7=new JWE['Encrypt']('foo');_0x50a72c[_0x21c28b(0x2ad)](()=>{const _0x3a17ea=_0x21c28b;_0x39b225['uLBRg'](_0x39b225[_0x3a17ea(0x22a)],_0x3a17ea(0x233))?_0x262cb7[_0x3a17ea(0x2fc)](_0x326372):_0x2e3e7c['is'](_0x57da64['constructor'],_0x3500ed[_0x3a17ea(0x24a)]);},{'instanceOf':TypeError,'message':_0xae3b06[_0x21c28b(0x1ae)]});}});}),test('JWE\x20compact\x20does\x20not\x20support\x20multiple\x20recipients',_0x479990=>{const _0x553169=_0x59d2e2,_0x3a00bf={'mLMbe':function(_0x4e352b,_0x86ba78){return _0x4e352b(_0x86ba78);},'HaRbl':_0x553169(0x1ac),'hzqvG':'ERR_JWE_INVALID'},_0x379cc8=_0x3a00bf[_0x553169(0x262)](generateSync,_0x553169(0x29e)),_0x5c71e2=generateSync('EC'),_0x4f10b0=new JWE[(_0x553169(0x1a6))](_0x3a00bf[_0x553169(0x2ce)]);_0x4f10b0[_0x553169(0x1da)](_0x379cc8),_0x4f10b0[_0x553169(0x1da)](_0x5c71e2),_0x479990[_0x553169(0x2ad)](()=>{const _0x351a36=_0x553169;_0x4f10b0[_0x351a36(0x2fc)](_0x351a36(0x2ac));},{'instanceOf':errors[_0x553169(0x1a1)],'code':_0x3a00bf['hzqvG'],'message':'JWE\x20Compact\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients,\x20JWE\x20unprotected\x20headers\x20or\x20AAD'});}),test('JWE\x20compact\x20does\x20not\x20support\x20unprotected\x20header',_0x721fec=>{const _0x1b0419=_0x59d2e2,_0x5865ad={'Mzekc':_0x1b0419(0x1ac),'idhWX':function(_0x47329d,_0x20e7c9){return _0x47329d(_0x20e7c9);},'DrboR':_0x1b0419(0x29e),'jrQdf':'ERR_JWE_INVALID'},_0x5b7784=_0x5865ad['idhWX'](generateSync,_0x5865ad[_0x1b0419(0x27c)]);_0x721fec['throws'](()=>{const _0x2c243c=_0x1b0419;JWE[_0x2c243c(0x2fc)](_0x5865ad[_0x2c243c(0x22d)],_0x5b7784,undefined,undefined,{'foo':0x1});},{'instanceOf':errors['JWEInvalid'],'code':_0x5865ad[_0x1b0419(0x2ff)],'message':_0x1b0419(0x1cf)});}),test(_0x59d2e2(0x20b),_0x45d2b9=>{const _0x24891a=_0x59d2e2,_0x301fca={'KFfJG':function(_0x2b6c86,_0x3b9837){return _0x2b6c86(_0x3b9837);},'RUQys':_0x24891a(0x29e)},_0x41b254=_0x301fca[_0x24891a(0x280)](generateSync,_0x301fca[_0x24891a(0x2b6)]);_0x45d2b9[_0x24891a(0x2ad)](()=>{const _0x3cb2a9=_0x24891a;JWE[_0x3cb2a9(0x2fc)](_0x3cb2a9(0x1ac),_0x41b254,undefined,_0x3cb2a9(0x27f));},{'instanceOf':errors[_0x24891a(0x1a1)],'code':'ERR_JWE_INVALID','message':'JWE\x20Compact\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients,\x20JWE\x20unprotected\x20headers\x20or\x20AAD'});}),test(_0x59d2e2(0x1d3),_0x4b23cc=>{const _0x4efd56=_0x59d2e2,_0x15f3af={'wvRjk':_0x4efd56(0x1a4),'AlRqU':function(_0x3d1bbe,_0x47a5f3,_0x4bb274){return _0x3d1bbe(_0x47a5f3,_0x4bb274);},'bnNOl':_0x4efd56(0x254),'XZvbd':function(_0x58e0ef,_0x4b88d3){return _0x58e0ef(_0x4b88d3);},'vrNuQ':'oct','ylaqa':function(_0x1bccfd,_0x481a64){return _0x1bccfd(_0x481a64);},'WJhWQ':'foo'},_0x4fcfc2=_0x15f3af[_0x4efd56(0x264)](generateSync,_0x15f3af[_0x4efd56(0x225)]),_0x3013f3=_0x15f3af[_0x4efd56(0x287)](generateSync,'EC'),_0x5f181c=new JWE[(_0x4efd56(0x1a6))](_0x15f3af['WJhWQ']);_0x5f181c[_0x4efd56(0x1da)](_0x4fcfc2),_0x5f181c[_0x4efd56(0x1da)](_0x3013f3),_0x4b23cc[_0x4efd56(0x2ad)](()=>{const _0x2d33d0=_0x4efd56,_0x4d3bb3={'KRUoS':_0x15f3af[_0x2d33d0(0x1b8)],'zArYX':function(_0x301a4a,_0x19e454,_0x210608){const _0x307351=_0x2d33d0;return _0x15f3af[_0x307351(0x2e5)](_0x301a4a,_0x19e454,_0x210608);},'KiJwr':_0x2d33d0(0x23a)};_0x2d33d0(0x254)===_0x15f3af['bnNOl']?_0x5f181c[_0x2d33d0(0x2fc)]('flattened'):_0x4d3bb3[_0x2d33d0(0x22b)](_0x1f6c50,_0x4d3bb3['KiJwr'],_0x304584=>{const _0x216273=_0x2d33d0,_0x5b9a59=_0x4bd99c(_0x216273(0x29e),0x100),_0x6821de=_0x18151d[_0x216273(0x2fc)](_0x216273(0x1ac),_0x5b9a59,{'alg':_0x4d3bb3[_0x216273(0x2b5)]});_0x304584[_0x216273(0x2ad)](()=>{_0x570dbb['decrypt'](_0x6821de,_0x5b9a59,{'maxPBES2Count':0x3e8});},{'instanceOf':_0x427a22['JWEInvalid'],'message':_0x216273(0x269)});});},{'instanceOf':errors[_0x4efd56(0x1a1)],'code':_0x4efd56(0x21a),'message':_0x4efd56(0x200)});}),test(_0x59d2e2(0x2ec),_0x37ead6=>{const _0x2c32c7=_0x59d2e2,_0x46c77d={'bSVIX':'oct','sxEoi':function(_0x231062,_0x1c67b9){return _0x231062(_0x1c67b9);},'SbUBa':_0x2c32c7(0x279),'sCbKC':_0x2c32c7(0x25b)},_0x5120cf=generateSync(_0x46c77d[_0x2c32c7(0x271)]),_0x2ed5ca=_0x46c77d[_0x2c32c7(0x285)](generateSync,_0x2c32c7(0x1f4)),_0x329b0c=new JWE[(_0x2c32c7(0x1a6))](_0x2c32c7(0x1ac));_0x329b0c[_0x2c32c7(0x1da)](_0x5120cf,{'enc':_0x46c77d[_0x2c32c7(0x202)]}),_0x329b0c[_0x2c32c7(0x1da)](_0x2ed5ca,{'enc':_0x46c77d['sCbKC']}),_0x37ead6[_0x2c32c7(0x2ad)](()=>{const _0x3f4d4d=_0x2c32c7;_0x329b0c['encrypt'](_0x3f4d4d(0x1e7));},{'instanceOf':errors[_0x2c32c7(0x1a1)],'code':_0x2c32c7(0x21a),'message':_0x2c32c7(0x2e8)});}),test(_0x59d2e2(0x244),_0x7b5881=>{const _0x5e53c7=_0x59d2e2,_0x459599={'cTTUy':'A128CBC-HS256','LhvKd':_0x5e53c7(0x29e),'EpiYq':function(_0x388092,_0x5795ba){return _0x388092(_0x5795ba);},'ZBFFc':_0x5e53c7(0x1ac),'UhAqN':_0x5e53c7(0x25b),'BzjAu':_0x5e53c7(0x21a),'nonlJ':_0x5e53c7(0x2e8)},_0x400540=generateSync(_0x459599['LhvKd']),_0x2935d5=_0x459599['EpiYq'](generateSync,_0x5e53c7(0x1f4)),_0x368f0=new JWE[(_0x5e53c7(0x1a6))](_0x459599[_0x5e53c7(0x239)]);_0x368f0[_0x5e53c7(0x1da)](_0x400540,{'enc':_0x459599[_0x5e53c7(0x2b3)]}),_0x368f0[_0x5e53c7(0x1da)](_0x2935d5,{'enc':'A128GCM'});const _0x45d5a4=_0x368f0[_0x5e53c7(0x2fc)](_0x5e53c7(0x1e7));_0x7b5881[_0x5e53c7(0x2ad)](()=>{const _0x26365d=_0x5e53c7;_0x45d5a4['recipients'][0x0][_0x26365d(0x1d1)][_0x26365d(0x1ad)]=_0x459599[_0x26365d(0x212)],JWE[_0x26365d(0x304)](_0x45d5a4,_0x400540);},{'instanceOf':errors[_0x5e53c7(0x1a1)],'code':_0x459599[_0x5e53c7(0x2ba)],'message':_0x459599[_0x5e53c7(0x1d8)]});}),test(_0x59d2e2(0x226),_0x4e79ed=>{const _0x24ed17=_0x59d2e2,_0x2d8f40={'oxdel':function(_0x4d6456,_0x29707d){return _0x4d6456(_0x29707d);},'KmBSa':function(_0x2a8872,_0x5a7f27){return _0x2a8872(_0x5a7f27);},'zSkCZ':_0x24ed17(0x1ac),'PlGyC':_0x24ed17(0x25b),'tTxLp':_0x24ed17(0x308)},_0x5ac2af=_0x2d8f40['oxdel'](generateSync,_0x24ed17(0x29e)),_0x2633c5=_0x2d8f40[_0x24ed17(0x19d)](generateSync,_0x24ed17(0x1f4)),_0x4ef76c=new JWE['Encrypt'](_0x2d8f40[_0x24ed17(0x243)]);_0x4ef76c[_0x24ed17(0x1da)](_0x5ac2af,{'enc':'A128GCM'}),_0x4ef76c['recipient'](_0x2633c5,{'enc':_0x2d8f40[_0x24ed17(0x20f)]});const _0x2b9ff2=_0x4ef76c[_0x24ed17(0x2fc)](_0x24ed17(0x1e7));_0x4e79ed[_0x24ed17(0x2ad)](()=>{const _0x13d147=_0x24ed17;delete _0x2b9ff2['recipients'][0x0][_0x13d147(0x1d1)][_0x13d147(0x1ad)],delete _0x2b9ff2['recipients'][0x1][_0x13d147(0x1d1)][_0x13d147(0x1ad)],JWE['decrypt'](_0x2b9ff2,_0x5ac2af);},{'instanceOf':errors[_0x24ed17(0x1a1)],'code':'ERR_JWE_INVALID','message':_0x2d8f40[_0x24ed17(0x2ae)]});}),test(_0x59d2e2(0x213),_0x4c22a0=>{const _0x2e198a=_0x59d2e2,_0x4f0c6a={'aePBL':function(_0x8505a5,_0x493c08,_0x544595,_0x52f703){return _0x8505a5(_0x493c08,_0x544595,_0x52f703);},'aHFLq':'oct','whxHQ':_0x2e198a(0x279),'ISkmA':_0x2e198a(0x1ac),'CUxVk':_0x2e198a(0x247)},_0x30fdd4=_0x4f0c6a['aePBL'](generateSync,_0x4f0c6a[_0x2e198a(0x1f6)],undefined,{'alg':_0x4f0c6a['whxHQ'],'use':'enc'}),_0x485f98=generateSync(_0x2e198a(0x1f4)),_0x1a88d5=new JWE[(_0x2e198a(0x1a6))](_0x4f0c6a['ISkmA']);_0x1a88d5[_0x2e198a(0x1da)](_0x30fdd4,{'alg':'dir'}),_0x1a88d5[_0x2e198a(0x1da)](_0x485f98),_0x4c22a0[_0x2e198a(0x2ad)](()=>{const _0x146e25=_0x2e198a;_0x1a88d5['encrypt'](_0x146e25(0x1e7));},{'instanceOf':errors[_0x2e198a(0x1a1)],'code':_0x2e198a(0x21a),'message':_0x4f0c6a['CUxVk']});}),test(_0x59d2e2(0x219),_0x31b11a=>{const _0x28f1c=_0x59d2e2,_0x2c6701={'xSYYP':function(_0x24ce19,_0x2cec8e,_0x25dc32,_0x24afa7){return _0x24ce19(_0x2cec8e,_0x25dc32,_0x24afa7);},'YXmIp':_0x28f1c(0x24d),'iLmcQ':_0x28f1c(0x247)},_0x358ec9=_0x2c6701['xSYYP'](generateSync,'EC',undefined,{'alg':_0x2c6701['YXmIp'],'use':'enc'}),_0x34cc64=generateSync(_0x28f1c(0x1f4)),_0x4748c0=new JWE['Encrypt']('foo');_0x4748c0[_0x28f1c(0x1da)](_0x358ec9,{'alg':'ECDH-ES'}),_0x4748c0[_0x28f1c(0x1da)](_0x34cc64),_0x31b11a[_0x28f1c(0x2ad)](()=>{const _0x4a6922=_0x28f1c;_0x4748c0['encrypt'](_0x4a6922(0x1e7));},{'instanceOf':errors[_0x28f1c(0x1a1)],'code':'ERR_JWE_INVALID','message':_0x2c6701[_0x28f1c(0x2b2)]});}),test('JWE\x20prot,\x20unprot\x20and\x20per-recipient\x20headers\x20must\x20be\x20disjoint',_0x4e846d=>{const _0x306f0b=_0x59d2e2,_0x47feb3={'JQAOg':_0x306f0b(0x1cd),'OcJDx':'rPAKk','SLkcz':'foo','JtVGw':'flattened','rXYYd':_0x306f0b(0x29e),'BOPnY':'ERR_JWE_INVALID','Laaia':_0x306f0b(0x1b0)},_0x35391e=generateSync(_0x47feb3[_0x306f0b(0x2f5)]);_0x4e846d[_0x306f0b(0x2ad)](()=>{const _0x41583e=_0x306f0b;if(_0x47feb3[_0x41583e(0x2d2)]===_0x41583e(0x1aa)){const _0xd77a99={'nfAqa':_0x47feb3[_0x41583e(0x305)]};;[[],![],!![],null,_0x4182ea,0x0,_0x11829c[_0x41583e(0x241)]('foo')]['forEach'](_0x4ce077=>{const _0x18f620=_0x41583e;_0x4fee76[_0x18f620(0x2ad)](()=>{const _0x15b06e=_0x18f620;new _0x325af7[(_0x15b06e(0x1a6))](_0x15b06e(0x1ac),_0x3e1438,_0x1d6f9b,_0x4ce077);},{'instanceOf':_0x2bf845,'message':_0xd77a99[_0x18f620(0x228)]});});}else{const _0xd5dc1d=new JWE[(_0x41583e(0x1a6))](_0x47feb3[_0x41583e(0x1d0)],{'foo':0x1},undefined,{'foo':0x2});_0xd5dc1d['recipient'](_0x35391e),_0xd5dc1d[_0x41583e(0x2fc)](_0x41583e(0x1c9));}},{'instanceOf':errors[_0x306f0b(0x1a1)],'code':_0x47feb3[_0x306f0b(0x28a)],'message':_0x47feb3[_0x306f0b(0x221)]}),_0x4e846d[_0x306f0b(0x2ad)](()=>{const _0x55e1ba=_0x306f0b,_0x3c5d85=new JWE[(_0x55e1ba(0x1a6))]('foo',{'foo':0x1});_0x3c5d85[_0x55e1ba(0x1da)](_0x35391e,{'foo':0x2}),_0x3c5d85['encrypt'](_0x55e1ba(0x1c9));},{'instanceOf':errors[_0x306f0b(0x1a1)],'code':_0x47feb3[_0x306f0b(0x28a)],'message':_0x47feb3[_0x306f0b(0x221)]}),_0x4e846d['throws'](()=>{const _0x42cb46=_0x306f0b,_0x43fcc0=new JWE['Encrypt'](_0x47feb3['SLkcz'],undefined,undefined,{'foo':0x1});_0x43fcc0[_0x42cb46(0x1da)](_0x35391e,{'foo':0x2}),_0x43fcc0[_0x42cb46(0x2fc)](_0x47feb3['JtVGw']);},{'instanceOf':errors[_0x306f0b(0x1a1)],'code':_0x306f0b(0x21a),'message':_0x306f0b(0x1b0)});}),test(_0x59d2e2(0x1bc),_0x4b4bc2=>{const _0x55166f=_0x59d2e2,_0xe7b981={'iGHNZ':_0x55166f(0x26e),'gDnOP':_0x55166f(0x29e)},_0x300085=generateSync(_0xe7b981[_0x55166f(0x1b5)],0x80),_0x4c253f=JWE['encrypt'](_0x55166f(0x1ac),_0x300085,{'alg':_0x55166f(0x215)});JWE[_0x55166f(0x304)](_0x4c253f,_0x300085,{'keyManagementAlgorithms':['A128GCMKW',_0x55166f(0x26e)]}),_0x4b4bc2[_0x55166f(0x2ad)](()=>{const _0x372cce=_0x55166f;JWE['decrypt'](_0x4c253f,_0x300085,{'keyManagementAlgorithms':[_0xe7b981[_0x372cce(0x307)]]});},{'instanceOf':errors[_0x55166f(0x1eb)],'code':'ERR_JOSE_ALG_NOT_WHITELISTED','message':_0x55166f(0x230)});}),test(_0x59d2e2(0x234),_0x3af17d=>{const _0x568c20=_0x59d2e2,_0x2aefc7={'gjROX':function(_0x5220b9,_0x55079e){return _0x5220b9(_0x55079e);},'KPGXQ':function(_0xc05888,_0x3b5c8a,_0x20fd18){return _0xc05888(_0x3b5c8a,_0x20fd18);},'wtmkw':_0x568c20(0x1ac),'NuYDk':'A128GCMKW'},_0x138998=_0x2aefc7[_0x568c20(0x26b)](generateSync,'oct'),_0x37e9ed=_0x2aefc7[_0x568c20(0x22e)](generateSync,_0x568c20(0x29e),0x80),_0x3ac370=new JWKS[(_0x568c20(0x272))](_0x138998,_0x37e9ed),_0x5bdd27=JWE['encrypt'](_0x2aefc7[_0x568c20(0x2da)],_0x37e9ed,{'alg':_0x568c20(0x215)});JWE[_0x568c20(0x304)](_0x5bdd27,_0x3ac370,{'keyManagementAlgorithms':[_0x2aefc7[_0x568c20(0x1bd)],'A192GCMKW']}),_0x3af17d[_0x568c20(0x2ad)](()=>{const _0x54299d=_0x568c20;JWE[_0x54299d(0x304)](_0x5bdd27,_0x3ac370,{'keyManagementAlgorithms':[_0x54299d(0x26e)]});},{'instanceOf':errors['JOSEAlgNotWhitelisted'],'code':_0x568c20(0x2fe)});}),test(_0x59d2e2(0x235),_0x48c70b=>{const _0x3974b6=_0x59d2e2,_0x2f4b5c={'EGtaZ':_0x3974b6(0x29e),'aOfBq':_0x3974b6(0x1ac)},_0x4a5619=generateSync(_0x2f4b5c[_0x3974b6(0x257)]),_0x20901e=JWE[_0x3974b6(0x2fc)](_0x2f4b5c[_0x3974b6(0x1df)],_0x4a5619,{'alg':_0x3974b6(0x25f)});JWE[_0x3974b6(0x304)](_0x20901e,_0x4a5619,{'contentEncryptionAlgorithms':['A128CBC-HS256']}),_0x48c70b[_0x3974b6(0x2ad)](()=>{const _0x3b27a4=_0x3974b6;JWE[_0x3b27a4(0x304)](_0x20901e,_0x4a5619,{'contentEncryptionAlgorithms':['PBES2-HS384+A192KW']});},{'instanceOf':errors['JOSEAlgNotWhitelisted'],'code':'ERR_JOSE_ALG_NOT_WHITELISTED'});}),test('JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist\x20(multi-recipient)',_0x2ab8cd=>{const _0x5a8340=_0x59d2e2,_0xc26bb3={'Qouqb':_0x5a8340(0x278),'WDQsy':function(_0x22c0a5,_0x3b762b){return _0x22c0a5===_0x3b762b;},'cdtkL':_0x5a8340(0x19f),'xoSbs':function(_0x4f9085,_0x2bb527){return _0x4f9085(_0x2bb527);},'nuePx':function(_0x35564f,_0x5848b3){return _0x35564f===_0x5848b3;},'wwheg':_0x5a8340(0x25d),'GMTAZ':_0x5a8340(0x297),'pACZn':'A256GCMKW','dphrK':_0x5a8340(0x2d4),'UwsAt':function(_0x2fe3e6,_0xbe42dc){return _0x2fe3e6===_0xbe42dc;},'UZpoE':_0x5a8340(0x1ac),'RUxWe':'general','AoCRM':function(_0xd68d94,_0x315d77){return _0xd68d94 in _0x315d77;},'kVfVz':'ERR_JOSE_MULTIPLE_ERRORS'},_0x3b438e=_0xc26bb3[_0x5a8340(0x23e)](generateSync,'oct'),_0x44d8cb=generateSync('RSA'),_0x167edc=new JWE[(_0x5a8340(0x1a6))](_0xc26bb3[_0x5a8340(0x1ca)]);_0x167edc['recipient'](_0x3b438e),_0x167edc[_0x5a8340(0x1da)](_0x44d8cb);const _0x5e88d7=_0x167edc[_0x5a8340(0x2fc)](_0xc26bb3[_0x5a8340(0x259)]);JWE[_0x5a8340(0x304)](_0x5e88d7,_0x3b438e,{'keyManagementAlgorithms':[_0xc26bb3[_0x5a8340(0x2a5)](_0xc26bb3[_0x5a8340(0x300)],process[_0x5a8340(0x2c3)])?_0x5a8340(0x2e3):_0xc26bb3[_0x5a8340(0x1fd)]]}),JWE[_0x5a8340(0x304)](_0x5e88d7,_0x44d8cb,{'keyManagementAlgorithms':[_0x5a8340(0x278)]});let _0x3770d8;_0x3770d8=_0x2ab8cd[_0x5a8340(0x2ad)](()=>{const _0x360c6c=_0x5a8340;JWE[_0x360c6c(0x304)](_0x5e88d7,_0x3b438e,{'keyManagementAlgorithms':[_0xc26bb3[_0x360c6c(0x29f)]]});},{'instanceOf':errors['JOSEMultiError'],'code':_0xc26bb3['kVfVz']}),[..._0x3770d8][_0x5a8340(0x1b1)]((_0x271776,_0x431f71)=>{const _0x220353=_0x5a8340;_0xc26bb3[_0x220353(0x2a3)](_0x431f71,0x0)?_0x2ab8cd['is'](_0x271776[_0x220353(0x25c)],errors[_0x220353(0x1eb)]):_0x2ab8cd['is'](_0x271776[_0x220353(0x25c)],errors[_0x220353(0x24a)]);}),_0x3770d8=_0x2ab8cd[_0x5a8340(0x2ad)](()=>{const _0x2ef529=_0x5a8340,_0x22eef7={'GvnNA':_0xc26bb3[_0x2ef529(0x1f9)],'mLKMH':function(_0x5481af,_0x3135af){const _0x52dea3=_0x2ef529;return _0xc26bb3[_0x52dea3(0x23e)](_0x5481af,_0x3135af);},'Gxopl':_0x2ef529(0x1ac)};if(_0xc26bb3['nuePx'](_0xc26bb3[_0x2ef529(0x1cb)],'nrSyZ'))JWE[_0x2ef529(0x304)](_0x5e88d7,_0x44d8cb,{'keyManagementAlgorithms':[_0xc26bb3[_0x2ef529(0x300)]in process[_0x2ef529(0x2c3)]?_0xc26bb3[_0x2ef529(0x2bd)]:_0xc26bb3['dphrK']]});else{const _0x1a9fd8={'FUfUQ':_0x22eef7['GvnNA']},_0x5e38c3=_0x22eef7['mLKMH'](_0x4cb046,_0x2ef529(0x29e));[[],![],!![],null,_0x2ad30f,0x0,_0x5ccc1c[_0x2ef529(0x241)](_0x22eef7['Gxopl'])]['forEach'](_0x1d539a=>{const _0x4552fb=_0x2ef529;_0x16de97[_0x4552fb(0x2ad)](()=>{const _0x24e344=_0x4552fb;_0x4ba538[_0x24e344(0x2fc)]('foo',_0x5e38c3,_0x1d539a);},{'instanceOf':_0x5800cf,'message':_0x1a9fd8['FUfUQ']});});}},{'instanceOf':errors[_0x5a8340(0x1f8)],'code':_0x5a8340(0x237)}),[..._0x3770d8][_0x5a8340(0x1b1)]((_0x47fac4,_0x17ba0f)=>{const _0x280e68=_0x5a8340;_0xc26bb3[_0x280e68(0x1de)](_0x17ba0f,0x0)?_0x2ab8cd['is'](_0x47fac4['constructor'],errors[_0x280e68(0x24a)]):_0x2ab8cd['is'](_0x47fac4[_0x280e68(0x25c)],errors[_0x280e68(0x1eb)]);});}),test(_0x59d2e2(0x2f7),_0x185d73=>{const _0x318309=_0x59d2e2,_0x5460e1={'djPgM':_0x318309(0x2bb),'aLiSm':_0x318309(0x29e),'fsbEL':_0x318309(0x21a)},_0x43afc0=generateSync(_0x5460e1['aLiSm']);_0x185d73['throws'](()=>{const _0x1f77d2=_0x318309;JWE[_0x1f77d2(0x2fc)][_0x1f77d2(0x1c9)]('foo',_0x43afc0,undefined,undefined,{'zip':_0x5460e1[_0x1f77d2(0x229)]});},{'instanceOf':errors[_0x318309(0x1a1)],'code':_0x5460e1[_0x318309(0x2d7)],'message':_0x318309(0x24c)});}),test('JWE\x20\x22zip\x22\x20only\x20DEF\x20is\x20supported',_0x3278ac=>{const _0x1591d5=_0x59d2e2,_0x448b21={'tJKRo':function(_0x15606d,_0x118c6a,_0x16c768,_0x353457){return _0x15606d(_0x118c6a,_0x16c768,_0x353457);},'JXHiF':'oct','cGAoQ':_0x1591d5(0x1ad),'vjSJN':_0x1591d5(0x1ac),'kTahH':_0x1591d5(0x25f),'IkKLt':function(_0x41be3e,_0x4c2c35){return _0x41be3e===_0x4c2c35;},'pbMJb':_0x1591d5(0x309),'QzeDg':function(_0xc44074,_0x574b6a){return _0xc44074(_0x574b6a);},'mhoxp':'ERR_JOSE_NOT_SUPPORTED','ChGJm':_0x1591d5(0x1bb)},_0x286965=_0x448b21[_0x1591d5(0x261)](generateSync,_0x448b21['JXHiF']);_0x3278ac['throws'](()=>{const _0x22c393=_0x1591d5;if(_0x448b21[_0x22c393(0x281)]('kIHpu',_0x448b21[_0x22c393(0x242)])){const _0x451d08=_0x448b21[_0x22c393(0x1a9)](_0x29395e,_0x448b21[_0x22c393(0x28b)],_0x54e3b8,{'alg':_0x22c393(0x279),'use':_0x448b21['cGAoQ']}),_0x174443=_0x40f2d5(_0x22c393(0x1f4)),_0x5e9d23=new _0x2fb59f[(_0x22c393(0x1a6))](_0x448b21['vjSJN']);_0x5e9d23[_0x22c393(0x1da)](_0x451d08,{'alg':_0x448b21['kTahH']}),_0x5e9d23['recipient'](_0x174443),_0xd8c5d0[_0x22c393(0x2ad)](()=>{const _0x4f5607=_0x22c393;_0x5e9d23[_0x4f5607(0x2fc)]('general');},{'instanceOf':_0x32b250[_0x22c393(0x1a1)],'code':_0x22c393(0x21a),'message':_0x22c393(0x247)});}else JWE[_0x22c393(0x2fc)][_0x22c393(0x1c9)](_0x448b21['vjSJN'],_0x286965,{'zip':_0x22c393(0x27e)});},{'instanceOf':errors[_0x1591d5(0x2e2)],'code':_0x448b21[_0x1591d5(0x209)],'message':_0x448b21['ChGJm']});}),test(_0x59d2e2(0x1c1),_0x2deaea=>{const _0x5dc98a=_0x59d2e2,_0x18a383={'tNKPE':function(_0x251a6f,_0x5b9f90){return _0x251a6f(_0x5b9f90);},'skpUA':_0x5dc98a(0x1ac),'MSlMa':'DEF','HPdSZ':'\x22zip\x22\x20Header\x20Parameter\x20MUST\x20be\x20integrity\x20protected'},_0x25b781=_0x18a383[_0x5dc98a(0x2d1)](generateSync,_0x5dc98a(0x29e)),_0x4812b7=JWE['encrypt']['flattened'](_0x18a383[_0x5dc98a(0x1af)],_0x25b781,{'zip':_0x18a383[_0x5dc98a(0x23b)]}),_0x5a48d9=base64url[_0x5dc98a(0x1fc)]['decode'](_0x4812b7[_0x5dc98a(0x1ed)]);delete _0x5a48d9[_0x5dc98a(0x2ea)],_0x4812b7['protected']=base64url[_0x5dc98a(0x1fc)][_0x5dc98a(0x1dd)](_0x5a48d9),_0x4812b7[_0x5dc98a(0x1ec)]={'zip':_0x5dc98a(0x2bb)},_0x2deaea[_0x5dc98a(0x2ad)](()=>{const _0x170edb=_0x5dc98a;JWE[_0x170edb(0x304)](_0x4812b7,_0x25b781);},{'instanceOf':errors[_0x5dc98a(0x1a1)],'code':_0x5dc98a(0x21a),'message':_0x18a383[_0x5dc98a(0x24b)]});}),test(_0x59d2e2(0x29d),_0x49a78f=>{const _0x32d31a=_0x59d2e2,_0x353307={'rfXxS':function(_0x338c39,_0x59321d){return _0x338c39(_0x59321d);},'zivAg':'oct','npEFk':_0x32d31a(0x1ac),'DWmql':_0x32d31a(0x256)},_0x2119f0=_0x353307['rfXxS'](generateSync,_0x353307[_0x32d31a(0x2fa)]),_0x4d3006=JWE['encrypt'][_0x32d31a(0x1c9)](_0x353307[_0x32d31a(0x1fb)],_0x2119f0,{'zip':_0x32d31a(0x2bb)}),_0xf3ed0a=base64url[_0x32d31a(0x1fc)]['decode'](_0x4d3006[_0x32d31a(0x1ed)]);_0xf3ed0a['zip']=_0x32d31a(0x1ac),_0x4d3006[_0x32d31a(0x1ed)]=base64url[_0x32d31a(0x1fc)][_0x32d31a(0x1dd)](_0xf3ed0a),_0x49a78f[_0x32d31a(0x2ad)](()=>{const _0x51b45a=_0x32d31a;JWE[_0x51b45a(0x304)](_0x4d3006,_0x2119f0);},{'instanceOf':errors[_0x32d31a(0x2e2)],'code':_0x353307['DWmql'],'message':'only\x20\x22DEF\x22\x20compression\x20algorithm\x20is\x20supported'});}),test(_0x59d2e2(0x1c8),_0x18da44=>{const _0x522961=_0x59d2e2,_0x2ba705={'BSOJE':_0x522961(0x29e),'wQQSV':_0x522961(0x1ac)},_0x5bcf0c=generateSync(_0x2ba705[_0x522961(0x2bc)]),_0x49251b=new JWKS[(_0x522961(0x272))](generateSync(_0x522961(0x29e)),generateSync(_0x2ba705[_0x522961(0x2bc)])),_0xe8de0d=JWE[_0x522961(0x2fc)](_0x2ba705[_0x522961(0x2cc)],_0x5bcf0c);_0x18da44[_0x522961(0x2ad)](()=>{JWE['decrypt'](_0xe8de0d,_0x49251b);},{'instanceOf':errors['JWEDecryptionFailed'],'code':'ERR_JWE_DECRYPTION_FAILED'});}),test(_0x59d2e2(0x29c),_0xdac802=>{const _0x1bc4ca=_0x59d2e2,_0x5542f7={'HdKul':function(_0x3fc169,_0x1c555e){return _0x3fc169(_0x1c555e);},'FQzoE':_0x1bc4ca(0x29e),'wAIHY':'foo'},_0x28e7a4=_0x5542f7[_0x1bc4ca(0x1ce)](generateSync,_0x1bc4ca(0x29e)),_0x44e6d7=_0x5542f7[_0x1bc4ca(0x1ce)](generateSync,'oct'),_0x54258a=generateSync(_0x5542f7[_0x1bc4ca(0x2e0)]),_0x106689=new JWE[(_0x1bc4ca(0x1a6))](_0x5542f7[_0x1bc4ca(0x298)]);_0x106689[_0x1bc4ca(0x1da)](_0x28e7a4),_0x106689[_0x1bc4ca(0x1da)](_0x44e6d7);const _0x4f4a94=_0x106689['encrypt'](_0x1bc4ca(0x1e7));_0xdac802['throws'](()=>{const _0x33b463=_0x1bc4ca;JWE[_0x33b463(0x304)](_0x4f4a94,_0x54258a);},{'instanceOf':errors[_0x1bc4ca(0x1bf)],'code':_0x1bc4ca(0x2ed)});}),test('\x22sig\x22\x20key\x20is\x20not\x20usable\x20for\x20signing',_0x2b7b80=>{const _0x34934c=_0x59d2e2,_0x2abaf7={'pzIuK':_0x34934c(0x29e)},_0x40e3c8=generateSync(_0x2abaf7[_0x34934c(0x28e)],0x100,{'use':'sig'});_0x2b7b80[_0x34934c(0x2ad)](()=>{JWE['encrypt']('foo',_0x40e3c8);},{'instanceOf':TypeError,'message':_0x34934c(0x2dd)});}),test('\x22enc\x22\x20value\x20must\x20be\x20supported\x20error',_0x32e42a=>{const _0x1ee799=_0x59d2e2,_0x2a40df={'UpGSA':_0x1ee799(0x1ac)},_0x216363=generateSync(_0x1ee799(0x29e),0x100);_0x32e42a[_0x1ee799(0x2ad)](()=>{const _0xe33cb3=_0x1ee799;JWE[_0xe33cb3(0x2fc)](_0xe33cb3(0x1ac),_0x216363,{'alg':_0xe33cb3(0x25f),'enc':_0x2a40df[_0xe33cb3(0x21d)]});},{'instanceOf':errors[_0x1ee799(0x2e2)],'message':_0x1ee799(0x273)});}),test(_0x59d2e2(0x2f2),_0x221e9a=>{const _0x2c9af3=_0x59d2e2,_0x46aa08={'YHWcJ':_0x2c9af3(0x1ac)},_0x2c86f2=generateSync(_0x2c9af3(0x29e),0x100);_0x221e9a[_0x2c9af3(0x2ad)](()=>{const _0x1d4362=_0x2c9af3;JWE['encrypt'](_0x46aa08['YHWcJ'],_0x2c86f2,{'enc':_0x46aa08[_0x1d4362(0x217)]});},{'instanceOf':errors[_0x2c9af3(0x2e2)],'message':_0x2c9af3(0x273)});});!(_0x59d2e2(0x297)in process['versions'])&&test(_0x59d2e2(0x23a),_0x2a3554=>{const _0x24766f=_0x59d2e2,_0x283daa={'RTtyO':function(_0x100bd8,_0x42a6dd,_0xcb432e){return _0x100bd8(_0x42a6dd,_0xcb432e);},'Hhqtn':_0x24766f(0x29e),'AFrFG':_0x24766f(0x269)},_0x1a43c9=_0x283daa[_0x24766f(0x2b4)](generateSync,_0x283daa[_0x24766f(0x2de)],0x100),_0xe08818=JWE['encrypt']('foo',_0x1a43c9,{'alg':_0x24766f(0x1a4)});_0x2a3554[_0x24766f(0x2ad)](()=>{JWE['decrypt'](_0xe08818,_0x1a43c9,{'maxPBES2Count':0x3e8});},{'instanceOf':errors[_0x24766f(0x1a1)],'message':_0x283daa[_0x24766f(0x27d)]});});function _0x47ca(){const _0x316e4b=['cleartext\x20argument\x20must\x20be\x20a\x20Buffer\x20or\x20a\x20string','npEFk','JSON','dphrK','Zltnz','tbtEq','Flattened\x20JWE\x20JSON\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients','xcVvm','SbUBa','HnvjS','nOkHm','wPkbP','OlXre','nCQgk','decodeToBuffer','mhoxp','1935624rBZKEk','JWE\x20compact\x20does\x20not\x20support\x20aad','vEluP','wQCcb','fjjZz','PlGyC','OTXaV','bar','cTTUy','JWE\x20oct\x20dir\x20is\x20only\x20usable\x20with\x20a\x20single\x20recipient','aes_cbc_hmac_sha2\x20decrypt\x20tag\x20check\x20(missing)','A128GCMKW','kid_3','YHWcJ','contentEncryptionAlgorithms\x20option\x20be\x20an\x20array\x20of\x20strings','JWE\x20EC\x20ECDH-ES\x20is\x20only\x20usable\x20with\x20a\x20single\x20recipient','ERR_JWE_INVALID','JWE\x20no\x20alg/enc\x20specified\x20(multi\x20recipient)','JWE\x20no\x20alg/enc\x20specified\x20(single\x20rsa),\x20no\x20protected\x20header','UpGSA','aes_cbc_hmac_sha2\x20decrypt\x20tag\x20check\x20(invalid\x20length)','NvwBD','PsIzz','Laaia','nXumB','JWE\x20malformed\x20or\x20invalid\x20serialization','KQxPd','vrNuQ','JWE\x20must\x20have\x20a\x20Content\x20Encryption\x20algorithm\x20(decrypt)','compact\x20parts\x20length\x20check','nfAqa','djPgM','bmSwv','zArYX','DoEhj','Mzekc','KPGXQ','JfHEk','key\x20management\x20algorithm\x20not\x20whitelisted','BzqVJ','HcdOH','BnjhD','JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist\x20with\x20a\x20keystore','JWE\x20decrypt\x20contentEncryptionAlgorithms\x20whitelist','kpCBb','ERR_JOSE_MULTIPLE_ERRORS','moIlq','ZBFFc','decrypt\x20PBES2\x20p2c\x20limit','MSlMa','A128KW','invalid\x20tag','xoSbs','\x22contentEncryptionAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','HS256','from','pbMJb','zSkCZ','JWE\x20must\x20only\x20have\x20one\x20Content\x20Encryption\x20algorithm\x20(decrypt)','XJkhL','BbFsa','dir\x20and\x20ECDH-ES\x20alg\x20may\x20only\x20be\x20used\x20with\x20a\x20single\x20recipient','FwubJ','uCFiq','JWKKeySupport','HPdSZ','\x22zip\x22\x20Header\x20Parameter\x20MUST\x20be\x20integrity\x20protected','ECDH-ES','YZNrd','truthy','VGADj','hqYso','gRIqe','DDPoV','albgW','JWE\x20no\x20alg/enc\x20specified\x20(single\x20oct)','ERR_JOSE_NOT_SUPPORTED','EGtaZ','aes_cbc_hmac_sha2\x20decrypt\x20iv\x20check\x20(missing)','RUxWe','PgGdE','A128GCM','constructor','nrSyZ','qqEfQ','dir','true','QzeDg','mLMbe','JWE\x20valid\x20serialization\x20must\x20be\x20provided','XZvbd','vPMRi','ryqpN','aaYCb','JWE\x20no\x20alg\x20specified\x20but\x20cannot\x20resolve','JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds','fJIQc','gjROX','JWE\x20must\x20have\x20recipients','tPkrn','A192GCMKW','eaozA','GNyqW','bSVIX','KeyStore','unsupported\x20encrypt\x20alg:\x20foo','kid_2','jwk\x20key\x20id','iioWy','JWE\x20no\x20alg\x20specified\x20(single\x20rsa),\x20with\x20unprotected\x20header','RSA-OAEP','A128CBC-HS256','RSA1_5','ivIBD','DrboR','AFrFG','FOO','aad','KFfJG','IkKLt','SwzSW','sign','dodTs','sxEoi','\x22keyManagementAlgorithms\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','ylaqa','1073710sVLoEd','opSyS','BOPnY','JXHiF','randomBytes','../..','pzIuK','JpgiJ','XYzlH','tag','PwgIt','gFfRM','serialization\x20must\x20be\x20one\x20of\x20\x22compact\x22,\x20\x22flattened\x22,\x20\x22general\x22','ZGNZm','13512ZCQncq','electron','wAIHY','header\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided','QZXYY','CPZmY','JWE\x20general\x20fails\x20with\x20decryption\x20error','JWE\x20\x22zip\x22\x20only\x20DEF\x20is\x20supported\x20(decrypt)','oct','Qouqb','bXVYx','JWE\x20encrypt\x20rejects\x20other','aes_gcm\x20decrypt\x20tag\x20check\x20(invalid\x20length)','WDQsy','XAagx','AoCRM','VpDPi','notThrows','Compressed\x20JWE\x20output\x20length\x20limit','tSTSG','UsHpD','oiESv','compact','throws','tTxLp','viEJK','trtZR','ejfir','iLmcQ','UhAqN','RTtyO','KRUoS','RUQys','ECDH-ES+A128KW','iRPrd','xhQkp','BzjAu','DEF','BSOJE','pACZn','rpLJS','JWE\x20no\x20alg\x20specified\x20(single\x20rsa),\x20with\x20protected\x20header','GRldO','AiIQi','NEbKJ','versions','vLFsL','EbyjQ','iXPBw','ESGCD','WcfmT','zUemk','eyaTv','recipients','wQQSV','MSslC','HaRbl','rHjfp','BNcHL','tNKPE','OcJDx','missing\x20recipients','A256KW','2008447Svkzeu','TpZei','fsbEL','EKEND','kid_1','wtmkw','mycOa','pass','a\x20key\x20with\x20\x22use\x22:\x22sig\x22\x20is\x20not\x20usable\x20for\x20encryption','Hhqtn','EhQrj','FQzoE','cALGo','JOSENotSupported','A256GCMKW','aes_cbc_hmac_sha2\x20decrypt\x20iv\x20check\x20(invalid\x20length)','AlRqU','JWE\x20no\x20alg/enc\x20specified\x20(only\x20on\x20a\x20key)','JWE\x20encrypt\x20protectedHeader\x20rejects\x20non\x20objects\x20if\x20provided','there\x20must\x20only\x20be\x20one\x20Content\x20Encryption\x20algorithm','slice','zip','LwpDf','JWE\x20must\x20only\x20have\x20one\x20Content\x20Encryption\x20algorithm\x20(encrypt)','ERR_JWE_DECRYPTION_FAILED','deepEqual','GnJEQ','aoCEg','aes_gcm\x20decrypt\x20tag\x20check\x20(missing)','\x22enc\x22\x20value\x20must\x20be\x20supported\x20error\x20(when\x20no\x20alg\x20was\x20specified)','JWE\x20encrypt\x20accepts\x20buffer','TqIJP','rXYYd','jyEyU','JWE\x20\x22zip\x22\x20must\x20be\x20integrity\x20protected','EDDaN','nRNky','zivAg','ajLtI','encrypt','PHiQy','ERR_JOSE_ALG_NOT_WHITELISTED','jrQdf','GMTAZ','Rnctb','jCHkP','dqmGY','decrypt','JQAOg','Zcbjw','iGHNZ','missing\x20Content\x20Encryption\x20algorithm','lCcRy','FQhrD','KmBSa','bUyNm','protectedHeader\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided','crypto','JWEInvalid','212sYjAEZ','1227RlZlWn','PBES2-HS256+A128KW','Nuypc','Encrypt','pixSD','5NgdZAj','tJKRo','YKoTL','lsflJ','foo','enc','ySbqA','skpUA','JWE\x20Shared\x20Protected,\x20JWE\x20Shared\x20Unprotected\x20and\x20JWE\x20Per-Recipient\x20Header\x20Parameter\x20names\x20must\x20be\x20disjoint','forEach','could\x20not\x20resolve\x20a\x20usable\x20\x22alg\x22\x20for\x20a\x20recipient','kid','aes_gcm\x20decrypt\x20iv\x20check\x20(missing)','gDnOP','eJQfK','Ycwbq','wvRjk','.....','ebbWP','only\x20\x22DEF\x22\x20compression\x20algorithm\x20is\x20supported','JWE\x20decrypt\x20keyManagementAlgorithms\x20whitelist','NuYDk','113594mymhJh','JWEDecryptionFailed','Pwazu','JWE\x20\x22zip\x22\x20must\x20be\x20integrity\x20protected\x20(decrypt)','UqVzm','msNUp','18NXywSs','rdJFA','jPkic','cxoiD','JWE\x20keystore\x20match\x20multi\x20but\x20fails\x20with\x20decryption\x20error','flattened','UZpoE','wwheg','aes_gcm\x20decrypt\x20iv\x20check\x20(invalid\x20length)','unprotectedHeader\x20argument\x20must\x20be\x20a\x20plain\x20object\x20when\x20provided','HdKul','JWE\x20Compact\x20Serialization\x20doesn\x27t\x20support\x20multiple\x20recipients,\x20JWE\x20unprotected\x20headers\x20or\x20AAD','SLkcz','header','keyManagementAlgorithms\x20option\x20be\x20an\x20array\x20of\x20strings','JWE\x20flattened\x20does\x20not\x20support\x20multiple\x20recipients','EsiRC','dtUvz','A256CBC-HS512','alg','nonlJ','4741940xcrZkI','recipient','JWE\x20encrypt\x20per-recipient\x20header\x20rejects\x20non\x20objects\x20if\x20provided','KtNgl','encode','UwsAt','aOfBq','YNlaH','gAsDn','gsbrv','Yyaor','decode','DOAES','aad\x20argument\x20must\x20be\x20a\x20Buffer\x20or\x20a\x20string\x20when\x20provided','general','YQvvb','AkkMi','RkkCC','JOSEAlgNotWhitelisted','unprotected','protected','BlEXF','ava','FDyNG','HPYVE','JqAkg','sSeoU','RSA','AgPXf','aHFLq','guvgT','JOSEMultiError','cdtkL'];_0x47ca=function(){return _0x316e4b;};return _0x47ca();}test(_0x59d2e2(0x2a8),_0x551092=>{const _0x1317bf=_0x59d2e2,_0x365222={'dodTs':_0x1317bf(0x1f4),'iXPBw':_0x1317bf(0x1ac),'EKEND':_0x1317bf(0x278),'KQxPd':'oct','mycOa':function(_0x3d6386,_0x1e9f48){return _0x3d6386(_0x1e9f48);},'fJIQc':function(_0x23a155,_0x496bc5,_0x3e4994){return _0x23a155(_0x496bc5,_0x3e4994);},'FQhrD':'wJuJv','Pwazu':_0x1317bf(0x279),'eaozA':function(_0x2bb91f,_0x29b214){return _0x2bb91f+_0x29b214;},'ZGNZm':_0x1317bf(0x25f),'bUyNm':_0x1317bf(0x2bb)},_0x4c7a69=_0x365222[_0x1317bf(0x26a)](generateSync,_0x1317bf(0x29e),0x100);{if('wJuJv'===_0x365222[_0x1317bf(0x19c)]){const _0x3fa5da=JWE[_0x1317bf(0x2fc)](crypto['randomBytes'](0x3d090),_0x4c7a69,{'alg':_0x1317bf(0x25f),'enc':_0x365222['Pwazu'],'zip':'DEF'});_0x551092[_0x1317bf(0x2a7)](()=>{const _0x3826b7=_0x1317bf;JWE[_0x3826b7(0x304)](_0x3fa5da,_0x4c7a69);});}else{const _0x20c256=_0x21472a(_0x365222[_0x1317bf(0x284)]),_0xe951ce=new _0x17470a[(_0x1317bf(0x1a6))](_0x365222[_0x1317bf(0x2c6)],{'enc':_0x1317bf(0x1d6)});_0xe951ce[_0x1317bf(0x1da)](_0x20c256);const _0x2258df=_0xe951ce[_0x1317bf(0x2fc)](_0x1317bf(0x1c9));_0x2de956['is'](_0x2258df[_0x1317bf(0x1ec)],_0x5b10c4),_0x3fbedb['is'](_0x2258df[_0x1317bf(0x1d1)],_0x568f8d),_0x1deeb3[_0x1317bf(0x2ee)](_0x47740f['JSON'][_0x1317bf(0x1e4)](_0x2258df['protected']),{'alg':_0x365222[_0x1317bf(0x2d8)],'enc':_0x1317bf(0x1d6)});}}{const _0x3e7ed8=JWE['encrypt'](crypto[_0x1317bf(0x28c)](_0x365222[_0x1317bf(0x26f)](0x3d090,0x1)),_0x4c7a69,{'alg':_0x365222[_0x1317bf(0x295)],'enc':_0x365222[_0x1317bf(0x1c0)],'zip':_0x365222[_0x1317bf(0x19e)]});_0x551092['throws'](()=>{const _0x47ff83=_0x1317bf;if(_0x47ff83(0x1fe)!==_0x47ff83(0x1c5))JWE[_0x47ff83(0x304)](_0x3e7ed8,_0x4c7a69);else{const _0x5443b9=_0x5ba0bc(_0x365222[_0x47ff83(0x224)]),_0x1b2bbf=new _0x43cc78[(_0x47ff83(0x272))](_0x166d62(_0x365222[_0x47ff83(0x224)]),_0x365222[_0x47ff83(0x2db)](_0x5970fd,_0x365222[_0x47ff83(0x224)])),_0x1dbc78=_0x28bece[_0x47ff83(0x2fc)](_0x365222[_0x47ff83(0x2c6)],_0x5443b9);_0x1cda99[_0x47ff83(0x2ad)](()=>{const _0x25c0ad=_0x47ff83;_0x1e04ba[_0x25c0ad(0x304)](_0x1dbc78,_0x1b2bbf);},{'instanceOf':_0x1666f2[_0x47ff83(0x1bf)],'code':_0x47ff83(0x2ed)});}});}{const _0x147ab8=JWE[_0x1317bf(0x2fc)](crypto['randomBytes'](0x3e9),_0x4c7a69,{'alg':_0x1317bf(0x25f),'enc':_0x1317bf(0x279),'zip':_0x1317bf(0x2bb)});_0x551092[_0x1317bf(0x2ad)](()=>{JWE['decrypt'](_0x147ab8,_0x4c7a69,{'inflateRawSyncLimit':0x3e8});});}});