const _0x13e855=_0x555b;(function(_0x25f620,_0x4c4dd4){const _0x11ef8a=_0x555b,_0x532021=_0x25f620();while(!![]){try{const _0x16a7a9=parseInt(_0x11ef8a(0x220))/0x1+parseInt(_0x11ef8a(0x208))/0x2+-parseInt(_0x11ef8a(0x204))/0x3+parseInt(_0x11ef8a(0x1d7))/0x4+parseInt(_0x11ef8a(0x21e))/0x5+-parseInt(_0x11ef8a(0x1f0))/0x6+-parseInt(_0x11ef8a(0x1e4))/0x7;if(_0x16a7a9===_0x4c4dd4)break;else _0x532021['push'](_0x532021['shift']());}catch(_0x5bced4){_0x532021['push'](_0x532021['shift']());}}}(_0x425a,0xde5da));const {inflateRawSync}=require(_0x13e855(0x1de)),base64url=require('../help/base64url'),getKey=require(_0x13e855(0x1e1)),{KeyStore}=require(_0x13e855(0x226)),errors=require(_0x13e855(0x1cf)),{check,decrypt,keyManagementDecrypt}=require(_0x13e855(0x1d1)),JWK=require(_0x13e855(0x1e8)),{createSecretKey}=require(_0x13e855(0x1e3)),generateCEK=require(_0x13e855(0x21b)),validateHeaders=require(_0x13e855(0x1eb)),{detect:resolveSerialization}=require('./serializers'),SINGLE_RECIPIENT=new Set(['compact',_0x13e855(0x1f2)]),combineHeader=(_0x514ea9={},_0x3b3b64={},_0x18ddba={})=>{const _0x3a6a4e=_0x13e855,_0x501848={'oxYsX':_0x3a6a4e(0x22f),'aKFSs':function(_0x167885,_0x21e826){return _0x167885(_0x21e826);},'YcOzn':_0x3a6a4e(0x1fe),'kCRYE':function(_0x135556,_0x334736){return _0x135556===_0x334736;},'DqZDP':function(_0x425901,_0x4c624e){return _0x425901===_0x4c624e;}};typeof _0x514ea9===_0x501848[_0x3a6a4e(0x22c)]&&(_0x514ea9=base64url[_0x3a6a4e(0x1da)][_0x3a6a4e(0x202)](_0x514ea9));const _0x1b7c3e=_0x514ea9[_0x3a6a4e(0x217)]||_0x3b3b64['p2s']||_0x18ddba[_0x3a6a4e(0x217)],_0x5db6f4=_0x514ea9[_0x3a6a4e(0x1cc)]||_0x3b3b64[_0x3a6a4e(0x1cc)]||_0x18ddba[_0x3a6a4e(0x1cc)],_0x2a1bab=_0x514ea9[_0x3a6a4e(0x22a)]||_0x3b3b64[_0x3a6a4e(0x22a)]||_0x18ddba[_0x3a6a4e(0x22a)],_0x4a6857=_0x514ea9['iv']||_0x3b3b64['iv']||_0x18ddba['iv'],_0x499f23=_0x514ea9['tag']||_0x3b3b64[_0x3a6a4e(0x200)]||_0x18ddba[_0x3a6a4e(0x200)];return _0x501848[_0x3a6a4e(0x1e6)](Function,_0x501848['YcOzn'])(),{..._0x514ea9,..._0x3b3b64,..._0x18ddba,..._0x501848[_0x3a6a4e(0x22d)](typeof _0x1b7c3e,_0x3a6a4e(0x22f))?{'p2s':base64url['decodeToBuffer'](_0x1b7c3e)}:undefined,...typeof _0x5db6f4===_0x501848['oxYsX']?{'apu':base64url['decodeToBuffer'](_0x5db6f4)}:undefined,..._0x501848[_0x3a6a4e(0x1d3)](typeof _0x2a1bab,_0x501848['oxYsX'])?{'apv':base64url[_0x3a6a4e(0x207)](_0x2a1bab)}:undefined,..._0x501848[_0x3a6a4e(0x1d3)](typeof _0x4a6857,'string')?{'iv':base64url[_0x3a6a4e(0x207)](_0x4a6857)}:undefined,...typeof _0x499f23===_0x501848[_0x3a6a4e(0x22c)]?{'tag':base64url[_0x3a6a4e(0x207)](_0x499f23)}:undefined};},validateAlgorithms=(_0x4ef08f,_0x3defea)=>{const _0x272427=_0x13e855,_0x55d6e7={'CrSSw':'safe'};if(_0x4ef08f!==undefined&&(!Array[_0x272427(0x1ed)](_0x4ef08f)||_0x4ef08f[_0x272427(0x1fb)](_0x2a7656=>typeof _0x2a7656!==_0x272427(0x22f)||!_0x2a7656)))throw new TypeError('\x22'+_0x3defea+_0x272427(0x1cd));if(!_0x4ef08f)return setTimeout(function(){const _0x1b74d9=_0x272427;console[_0x1b74d9(0x1e9)](_0x55d6e7['CrSSw']);},0x64),undefined;return eval('const _0x56e528 = _0x272427;JSON[_0x56e528(504)]({ \'safe\': !![] });'),new Set(_0x4ef08f);},jweDecrypt=(_0x584bf5,_0x50befb,_0x18eddc,_0x1dd390,{crit:crit=[],complete:complete=![],keyManagementAlgorithms:_0x4e5fee,contentEncryptionAlgorithms:_0x2d2822,maxPBES2Count:maxPBES2Count=0x2710,inflateRawSyncLimit:inflateRawSyncLimit=0x3d090}={})=>{const _0x13fd43=_0x13e855,_0x2966a3={'uJDSp':_0x13fd43(0x1f2),'wSdFC':function(_0x506551,_0x3b7b5e){return _0x506551*_0x3b7b5e;},'ohmrI':_0x13fd43(0x1d9),'MuwtH':function(_0x25380b,_0x1869ca){return _0x25380b===_0x1869ca;},'GoJgg':_0x13fd43(0x215),'PuKhX':_0x13fd43(0x222),'FitTz':function(_0x55dea3,_0x9167d,_0x50298f,_0x3c2f64,_0x6c1c44,_0x5e265c){return _0x55dea3(_0x9167d,_0x50298f,_0x3c2f64,_0x6c1c44,_0x5e265c);},'FfHOt':function(_0x1e603e,_0x4518c5,_0x5f4ed4,_0x543c99){return _0x1e603e(_0x4518c5,_0x5f4ed4,_0x543c99);},'eqSQr':_0x13fd43(0x1fd),'PGUWX':function(_0x47f70d,_0x352a29){return _0x47f70d instanceof _0x352a29;},'UCVMa':function(_0x1a3d86,_0x55f3be){return _0x1a3d86===_0x55f3be;},'pitig':_0x13fd43(0x209),'hgIlC':function(_0x2bd77a,_0x27a7d0){return _0x2bd77a===_0x27a7d0;},'oDzJM':_0x13fd43(0x1fc),'dSILA':_0x13fd43(0x1e0),'VMHKp':_0x13fd43(0x213),'BlrTh':'HjScD','LkPNZ':function(_0x335a2e,_0x2090b5){return _0x335a2e===_0x2090b5;},'uIeDl':_0x13fd43(0x1df),'vbBpq':function(_0x28f002,_0x40c600){return _0x28f002(_0x40c600);},'HbWzF':_0x13fd43(0x201),'kDrtz':function(_0x46eb87,_0xee1a1c,_0x55e11f,_0x25b38f,_0x2d5aeb){return _0x46eb87(_0xee1a1c,_0x55e11f,_0x25b38f,_0x2d5aeb);},'mGzxQ':function(_0x1f2eef,_0xa14cba){return _0x1f2eef(_0xa14cba);},'wjXoP':function(_0x518d9d,_0x14e13e){return _0x518d9d||_0x14e13e;},'UPtwQ':_0x13fd43(0x20d),'Jpuhp':function(_0x2f4217,_0x52710,_0x16f2ff,_0x58aefd,_0x89ef83){return _0x2f4217(_0x52710,_0x16f2ff,_0x58aefd,_0x89ef83);},'dYzEu':function(_0xabd702,_0x11379d,_0x57b558){return _0xabd702(_0x11379d,_0x57b558);},'SABwz':_0x13fd43(0x1ca),'lgndX':function(_0x5ce72f,_0x4e8bf5,_0x7f95ca,_0x563604,_0x22bd21,_0x1d647d){return _0x5ce72f(_0x4e8bf5,_0x7f95ca,_0x563604,_0x22bd21,_0x1d647d);},'IlnCM':function(_0x144287,_0x3d152c,_0x1a9978,_0x5021ae,_0x20035a,_0x5482f8){return _0x144287(_0x3d152c,_0x1a9978,_0x5021ae,_0x20035a,_0x5482f8);}};_0x1dd390=getKey(_0x1dd390,!![]),_0x4e5fee=validateAlgorithms(_0x4e5fee,_0x13fd43(0x20c)),_0x2d2822=validateAlgorithms(_0x2d2822,_0x2966a3['ohmrI']);if(!Array[_0x13fd43(0x1ed)](crit)||crit['some'](_0x15fe88=>typeof _0x15fe88!==_0x13fd43(0x22f)||!_0x15fe88))throw new TypeError(_0x13fd43(0x22e));!_0x50befb&&(_0x50befb=resolveSerialization(_0x18eddc));let _0x5aedee,_0x474590,_0xe8b319,_0x6c19c8,_0x42b3cc,_0x17998d,_0x31bc08,_0x2d7d4f,_0x37d39e,_0x4d8169,_0x4c341c,_0x4038eb;if(_0x50befb==='general'&&_0x2966a3[_0x13fd43(0x219)](_0x18eddc[_0x13fd43(0x1ce)][_0x13fd43(0x1f7)],0x1)){_0x50befb=_0x2966a3['uJDSp'];const {recipients:_0xdd03f8,..._0x62852f}=_0x18eddc;_0x18eddc={..._0x62852f,..._0xdd03f8[0x0]};}if(SINGLE_RECIPIENT[_0x13fd43(0x1f9)](_0x50befb)){_0x2966a3[_0x13fd43(0x219)](_0x50befb,_0x2966a3[_0x13fd43(0x230)])?[_0x31bc08,_0x6c19c8,_0x42b3cc,_0x474590,_0x2d7d4f]=_0x18eddc[_0x13fd43(0x1e2)]('.'):{protected:_0x31bc08,encrypted_key:_0x6c19c8,iv:_0x42b3cc,ciphertext:_0x474590,tag:_0x2d7d4f,unprotected:_0x37d39e,aad:_0x4c341c,header:_0x4038eb}=_0x18eddc;!_0x584bf5&&(_0x2966a3['PuKhX']===_0x2966a3[_0x13fd43(0x1f3)]?_0x2966a3[_0x13fd43(0x1d5)](validateHeaders,_0x31bc08,_0x37d39e,[{'header':_0x4038eb}],!![],crit):_0xe701f6=_0x2183be['all']({'kid':_0x3035ce[_0x13fd43(0x1dc)],'alg':_0x1e1f7f[_0x13fd43(0x1df)],'key_ops':['decrypt']}));_0x17998d=_0x2966a3[_0x13fd43(0x1ea)](combineHeader,_0x31bc08,_0x37d39e,_0x4038eb),{alg:_0x5aedee,enc:_0xe8b319}=_0x17998d;if(_0x4e5fee&&!_0x4e5fee['has'](_0x5aedee))throw new errors[(_0x13fd43(0x210))](_0x2966a3['eqSQr']);if(_0x2d2822&&!_0x2d2822[_0x13fd43(0x1f9)](_0xe8b319)){if(_0x13fd43(0x1dd)===_0x13fd43(0x20b)){const _0x4ace19={'cleartext':_0x2a26c5,'key':_0xe9653a,'cek':_0x19daf0};if(_0x363fa5)_0x4ace19[_0x13fd43(0x1db)]=_0x2496d1;if(_0x2a2bcb)_0x4ace19[_0x13fd43(0x20f)]=_0x1bfed7;if(_0x1f9ecd)_0x4ace19[_0x13fd43(0x1d4)]=_0x4a99e7;if(_0x54f0f5)_0x4ace19[_0x13fd43(0x21d)]=_0x39dbfb[_0x13fd43(0x1da)]['decode'](_0x4c4377);return new _0x35707c(_0x13fd43(0x1ca))(),_0x4ace19;}else throw new errors[(_0x13fd43(0x210))](_0x13fd43(0x1cb));}if(_0x2966a3['PGUWX'](_0x1dd390,KeyStore)){const _0x2055b6=_0x1dd390;let _0x4f0f47;if(_0x2966a3[_0x13fd43(0x1d6)](_0x17998d[_0x13fd43(0x1d2)],_0x2966a3[_0x13fd43(0x20a)])){if(_0x2966a3[_0x13fd43(0x205)](_0x2966a3[_0x13fd43(0x1ef)],_0x13fd43(0x1fc)))_0x4f0f47=_0x2055b6['all']({'kid':_0x17998d['kid'],'alg':_0x17998d[_0x13fd43(0x1df)],'key_ops':[_0x2966a3[_0x13fd43(0x228)]]});else{_0x4e5d04=_0x2966a3['uJDSp'];const {recipients:_0x2f2d53,..._0x2abf12}=_0x118893;_0xce6175={..._0x2abf12,..._0x2f2d53[0x0]};}}else _0x4f0f47=_0x2055b6['all']({'kid':_0x17998d[_0x13fd43(0x1dc)],'alg':_0x17998d['alg'],'key_ops':[_0x13fd43(0x218)]});switch(_0x4f0f47[_0x13fd43(0x1f7)]){case 0x0:throw new errors[(_0x13fd43(0x1f1))]();case 0x1:_0x1dd390=_0x4f0f47[0x0];break;default:{const _0x2b3f69=[];for(const _0x3e7d90 of _0x4f0f47){try{return eval('Math[\'PI\'] * 2;'),_0x2966a3[_0x13fd43(0x1d5)](jweDecrypt,!![],_0x50befb,_0x18eddc,_0x3e7d90,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x2d2822?[..._0x2d2822]:undefined,'keyManagementAlgorithms':_0x4e5fee?[..._0x4e5fee]:undefined});}catch(_0x37949b){_0x2b3f69[_0x13fd43(0x21c)](_0x37949b);continue;}}const _0x32302e=new errors[(_0x13fd43(0x212))](_0x2b3f69);if([..._0x32302e][_0x13fd43(0x1fb)](_0x27e1e0=>_0x27e1e0 instanceof errors[_0x13fd43(0x20e)]))throw new errors['JWEDecryptionFailed']();throw _0x32302e;}}}check(_0x1dd390,..._0x5aedee===_0x2966a3[_0x13fd43(0x20a)]?[_0x2966a3[_0x13fd43(0x228)],_0xe8b319]:[_0x13fd43(0x214),_0x5aedee]);if(_0x5aedee[_0x13fd43(0x229)](_0x2966a3[_0x13fd43(0x203)])){if(_0x17998d&&_0x17998d[_0x13fd43(0x211)]>maxPBES2Count)throw new errors['JWEInvalid']('JOSE\x20Header\x20\x22p2c\x22\x20(PBES2\x20Count)\x20out\x20is\x20of\x20acceptable\x20bounds');}try{if(_0x2966a3[_0x13fd43(0x224)]!==_0x13fd43(0x21a)){if(_0x2966a3[_0x13fd43(0x227)](_0x5aedee,_0x13fd43(0x209)))_0x4d8169=JWK[_0x13fd43(0x1ee)](_0x1dd390,{'alg':_0xe8b319,'use':_0x2966a3['uIeDl']});else{if(_0x2966a3['UCVMa'](_0x5aedee,_0x13fd43(0x216))){const _0x4a2dd9=keyManagementDecrypt(_0x5aedee,_0x1dd390,undefined,_0x17998d);_0x4d8169=JWK[_0x13fd43(0x1ee)](_0x2966a3[_0x13fd43(0x1f5)](createSecretKey,_0x4a2dd9),{'alg':_0xe8b319,'use':_0x2966a3[_0x13fd43(0x22b)]});}else{if(_0x2966a3[_0x13fd43(0x1e7)]==='eKZUA'){const _0x247e1c=_0x2966a3['kDrtz'](keyManagementDecrypt,_0x5aedee,_0x1dd390,base64url[_0x13fd43(0x207)](_0x6c19c8),_0x17998d);_0x4d8169=JWK[_0x13fd43(0x1ee)](_0x2966a3[_0x13fd43(0x1c9)](createSecretKey,_0x247e1c),{'alg':_0xe8b319,'use':_0x2966a3[_0x13fd43(0x22b)]});}else _0x1672fb=_0x1d1ed1['from'](_0x5af243||'');}}}else throw new _0x195dae('\x22crit\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings');}catch(_0x5e91c1){_0x4d8169=generateCEK(_0xe8b319);}let _0x22bc97;_0x4c341c?_0x22bc97=Buffer[_0x13fd43(0x1f4)]([Buffer[_0x13fd43(0x1f6)](_0x31bc08||''),Buffer[_0x13fd43(0x1f6)]('.'),Buffer[_0x13fd43(0x1f6)](_0x4c341c)]):_0x22bc97=Buffer[_0x13fd43(0x1f6)](_0x2966a3[_0x13fd43(0x1ec)](_0x31bc08,''));try{_0x2966a3[_0x13fd43(0x1d6)](_0x2966a3[_0x13fd43(0x221)],_0x13fd43(0x20d))?_0x42b3cc=base64url['decodeToBuffer'](_0x42b3cc):nnjILc[_0x13fd43(0x1fa)](_0xa854ce['PI'],0x2);}catch(_0x370e5f){}try{_0x2d7d4f=base64url[_0x13fd43(0x207)](_0x2d7d4f);}catch(_0x182eae){}let _0x213aaa=_0x2966a3['Jpuhp'](decrypt,_0xe8b319,_0x4d8169,base64url[_0x13fd43(0x207)](_0x474590),{'iv':_0x42b3cc,'tag':_0x2d7d4f,'aad':_0x22bc97});_0x17998d['zip']&&(_0x213aaa=_0x2966a3[_0x13fd43(0x225)](inflateRawSync,_0x213aaa,{'maxOutputLength':inflateRawSyncLimit}));if(complete){const _0x9ef1c4={'cleartext':_0x213aaa,'key':_0x1dd390,'cek':_0x4d8169};if(_0x4c341c)_0x9ef1c4[_0x13fd43(0x1db)]=_0x4c341c;if(_0x4038eb)_0x9ef1c4['header']=_0x4038eb;if(_0x37d39e)_0x9ef1c4[_0x13fd43(0x1d4)]=_0x37d39e;if(_0x31bc08)_0x9ef1c4[_0x13fd43(0x21d)]=base64url['JSON'][_0x13fd43(0x202)](_0x31bc08);return new Function(_0x2966a3['SABwz'])(),_0x9ef1c4;}return eval('const _0x93df85 = _0x13fd43;JSON[_0x93df85(504)]({ \'safe\': !![] });'),_0x213aaa;}_0x2966a3[_0x13fd43(0x1d0)](validateHeaders,_0x18eddc[_0x13fd43(0x21d)],_0x18eddc[_0x13fd43(0x1d4)],_0x18eddc[_0x13fd43(0x1ce)][_0x13fd43(0x21f)](({header:_0x24f9ec})=>({'header':_0x24f9ec})),!![],crit);const {recipients:_0x5e4ad0,..._0x4be843}=_0x18eddc,_0x1e4011=[];for(const _0x419ac1 of _0x5e4ad0){try{return eval('JSON[\'stringify\']({ \'safe\': !![] });'),_0x2966a3[_0x13fd43(0x1e5)](jweDecrypt,!![],_0x2966a3[_0x13fd43(0x1d8)],{..._0x4be843,..._0x419ac1},_0x1dd390,{'crit':crit,'complete':complete,'contentEncryptionAlgorithms':_0x2d2822?[..._0x2d2822]:undefined,'keyManagementAlgorithms':_0x4e5fee?[..._0x4e5fee]:undefined});}catch(_0x51de56){_0x1e4011['push'](_0x51de56);continue;}}const _0x43c2f4=new errors['JOSEMultiError'](_0x1e4011);if([..._0x43c2f4][_0x13fd43(0x1fb)](_0x5cb329=>_0x5cb329 instanceof errors['JWEDecryptionFailed']))throw new errors[(_0x13fd43(0x20e))]();else{if([..._0x43c2f4][_0x13fd43(0x1ff)](_0x32753e=>_0x32753e instanceof errors[_0x13fd43(0x1f1)]))throw new errors[(_0x13fd43(0x1f1))]();}throw _0x43c2f4;};function _0x425a(){const _0x1de5bf=['oxYsX','kCRYE','\x22crit\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','string','GoJgg','mGzxQ','var\x20x\x20=\x2042;\x20return\x20x;','content\x20encryption\x20algorithm\x20not\x20whitelisted','apu','\x22\x20option\x20must\x20be\x20an\x20array\x20of\x20non-empty\x20strings','recipients','../errors','lgndX','../jwa','alg','DqZDP','unprotected','FitTz','UCVMa','6617824BZtmUr','uJDSp','contentEncryptionAlgorithms','JSON','aad','kid','ExLMo','zlib','enc','decrypt','../help/get_key','split','../help/key_object','8948219aECeSq','IlnCM','aKFSs','HbWzF','../jwk','log','FfHOt','./validate_headers','wjXoP','isArray','asKey','oDzJM','8619510LRKmRm','JWKSNoMatchingKey','flattened','PuKhX','concat','vbBpq','from','length','stringify','has','wSdFC','some','AAvlW','key\x20management\x20algorithm\x20not\x20whitelisted','return\x20new\x20Date();','every','tag','eKZUA','decode','VMHKp','4715175iZhBSo','hgIlC','exports','decodeToBuffer','3363448jUrfbh','dir','pitig','GSJqO','keyManagementAlgorithms','yhJxg','JWEDecryptionFailed','header','JOSEAlgNotWhitelisted','p2c','JOSEMultiError','PBES2','keyManagementDecrypt','compact','ECDH-ES','p2s','unwrapKey','MuwtH','COIRB','./generate_cek','push','protected','3398970fqLPTm','map','1181463EzyAsq','UPtwQ','cvmQs','bind','BlrTh','dYzEu','../jwks','LkPNZ','dSILA','startsWith','apv','uIeDl'];_0x425a=function(){return _0x1de5bf;};return _0x425a();}function _0x555b(_0x2ed66e,_0x4cb3a8){const _0x425a3b=_0x425a();return _0x555b=function(_0x555b32,_0x574da8){_0x555b32=_0x555b32-0x1c9;let _0x556094=_0x425a3b[_0x555b32];return _0x556094;},_0x555b(_0x2ed66e,_0x4cb3a8);}module[_0x13e855(0x206)]=jweDecrypt[_0x13e855(0x223)](undefined,![],undefined);