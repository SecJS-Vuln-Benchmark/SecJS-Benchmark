const _0x26d66a=_0x5a12;(function(_0x47b701,_0x20f2b2){const _0x541fed=_0x5a12,_0x3c69bf=_0x47b701();while(!![]){try{const _0x5594a8=parseInt(_0x541fed(0x80))/0x1+-parseInt(_0x541fed(0x7a))/0x2*(-parseInt(_0x541fed(0xba))/0x3)+-parseInt(_0x541fed(0x95))/0x4*(-parseInt(_0x541fed(0x7e))/0x5)+parseInt(_0x541fed(0xb0))/0x6+parseInt(_0x541fed(0x73))/0x7*(parseInt(_0x541fed(0x9d))/0x8)+-parseInt(_0x541fed(0x7f))/0x9*(parseInt(_0x541fed(0xb5))/0xa)+-parseInt(_0x541fed(0x83))/0xb;if(_0x5594a8===_0x20f2b2)break;else _0x3c69bf['push'](_0x3c69bf['shift']());}catch(_0x42b101){_0x3c69bf['push'](_0x3c69bf['shift']());}}}(_0x1a4b,0x2f397));import{armor,unarmor}from'./encoding/armor';import _0x4c1ae9 from'./enums';import _0x341136 from'./util';import{PacketList,LiteralDataPacket,SignaturePacket}from'./packet';import{Signature}from'./signature';function _0x5a12(_0x105d19,_0x4a6b89){const _0x1a4bdc=_0x1a4b();return _0x5a12=function(_0x5a1228,_0x13c21d){_0x5a1228=_0x5a1228-0x72;let _0x1475cc=_0x1a4bdc[_0x5a1228];return _0x1475cc;},_0x5a12(_0x105d19,_0x4a6b89);}import{createVerificationObjects,createSignaturePackets}from'./message';import _0x462faa from'./config';const allowedPackets=_0x341136['constructAllowedPackets']([SignaturePacket]);export class CleartextMessage{constructor(_0x1e57df,_0x5b95c0){const _0x1c9605=_0x5a12,_0xb4338e={'Rxiqq':function(_0x326b6c,_0x5bc3fe){return _0x326b6c instanceof _0x5bc3fe;}};this[_0x1c9605(0x89)]=_0x341136['removeTrailingSpaces'](_0x1e57df)[_0x1c9605(0xac)](/\r?\n/g,'\x0d\x0a');if(_0x5b95c0&&!_0xb4338e[_0x1c9605(0xbe)](_0x5b95c0,Signature))throw new Error(_0x1c9605(0xaa));this[_0x1c9605(0x79)]=_0x5b95c0||new Signature(new PacketList());}[_0x26d66a(0x7b)](){const _0x45cbdc=_0x26d66a,_0x4093ee=[],_0xc8b2bd=this['signature'][_0x45cbdc(0x86)];return _0xc8b2bd['forEach'](function(_0x2ff105){const _0x182548=_0x45cbdc;_0x4093ee[_0x182548(0x98)](_0x2ff105[_0x182548(0xa3)]);}),_0x4093ee;}async[_0x26d66a(0x8a)](_0x41edfd,_0x355e15=null,_0x4aae12=[],_0x3bb34b=new Date(),_0x374b54=[],_0x320a37=[],_0x36e06b=_0x462faa){const _0x44f924=_0x26d66a,_0x32ec65=new LiteralDataPacket();_0x32ec65[_0x44f924(0xa6)](this[_0x44f924(0x89)]);const _0x1b1e97=new Signature(await createSignaturePackets(_0x32ec65,_0x41edfd,_0x355e15,_0x4aae12,_0x3bb34b,_0x374b54,_0x320a37,!![],_0x36e06b));return new CleartextMessage(this['text'],_0x1b1e97);}[_0x26d66a(0x92)](_0x3eae01,_0x14b37f=new Date(),_0x1b65a=_0x462faa){const _0x4c225a=_0x26d66a,_0x22f83a=this[_0x4c225a(0x79)]['packets']['filterByTag'](_0x4c1ae9['packet'][_0x4c225a(0x79)]),_0x16a02a=new LiteralDataPacket();return _0x16a02a[_0x4c225a(0xa6)](this[_0x4c225a(0x89)]),createVerificationObjects(_0x22f83a,[_0x16a02a],_0x3eae01,_0x14b37f,!![],_0x1b65a);}[_0x26d66a(0x85)](){const _0x4eeccc=_0x26d66a;return this['text'][_0x4eeccc(0xac)](/\r\n/g,'\x0a');}[_0x26d66a(0xbc)](_0x1b6ceb=_0x462faa){const _0x5140d4=_0x26d66a,_0x475451={'CZdfU':_0x5140d4(0x9f),'YBUwD':'MuHmJ'};let _0x41bbce=this[_0x5140d4(0x79)]['packets']['map'](function(_0x344a94){const _0x23beba=_0x5140d4;if(_0x475451[_0x23beba(0x97)]===_0x475451[_0x23beba(0x88)])throw new _0x1993e1(_0x23beba(0x8f));else return _0x4c1ae9['read'](_0x4c1ae9[_0x23beba(0xb2)],_0x344a94[_0x23beba(0x87)])[_0x23beba(0x7d)]();});_0x41bbce=_0x41bbce[_0x5140d4(0xa5)](function(_0x5f354b,_0x145b3f,_0x2a46a0){const _0x2e7ff2=_0x5140d4;return _0x2a46a0[_0x2e7ff2(0xbd)](_0x5f354b)===_0x145b3f;});const _0x34d7ff={'hash':_0x41bbce[_0x5140d4(0xaf)](),'text':this['text'],'data':this['signature'][_0x5140d4(0x86)][_0x5140d4(0x8c)]()};return armor(_0x4c1ae9[_0x5140d4(0xbc)][_0x5140d4(0xb6)],_0x34d7ff,undefined,undefined,undefined,_0x1b6ceb);}}export async function readCleartextMessage({cleartextMessage:_0x3207ee,config:_0x163ab3,..._0x58a882}){const _0x5862ba=_0x26d66a,_0x38560c={'vqWLI':function(_0x521157,_0x25298c){return _0x521157(_0x25298c);},'lIccl':function(_0x379409,_0x2e8851){return _0x379409!==_0x2e8851;},'hTaCo':_0x5862ba(0x75)};_0x163ab3={..._0x462faa,..._0x163ab3};if(!_0x3207ee)throw new Error('readCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`cleartextMessage`');if(!_0x341136[_0x5862ba(0xa4)](_0x3207ee))throw new Error(_0x5862ba(0xb7));const _0x32ae10=Object[_0x5862ba(0xb4)](_0x58a882);if(_0x32ae10[_0x5862ba(0x9a)]>0x0)throw new Error(_0x5862ba(0x72)+_0x32ae10[_0x5862ba(0xaf)](',\x20'));const _0x243930=await _0x38560c[_0x5862ba(0x94)](unarmor,_0x3207ee);if(_0x38560c[_0x5862ba(0x81)](_0x243930['type'],_0x4c1ae9[_0x5862ba(0xbc)][_0x5862ba(0xb6)]))throw new Error(_0x38560c[_0x5862ba(0x76)]);const _0xd5fa78=await PacketList[_0x5862ba(0x9c)](_0x243930['data'],allowedPackets,_0x163ab3);verifyHeaders(_0x243930[_0x5862ba(0x8d)],_0xd5fa78);const _0xcd381c=new Signature(_0xd5fa78);return new CleartextMessage(_0x243930[_0x5862ba(0x89)],_0xcd381c);}function verifyHeaders(_0x32f60e,_0x1a3800){const _0x1b1fdc=_0x26d66a,_0x13c364={'OZsEL':function(_0x172e76,_0x3b2731){return _0x172e76<_0x3b2731;},'CIbSi':function(_0x3ddf0b,_0x253012){return _0x3ddf0b===_0x253012;},'cFcbi':function(_0x4bd594,_0x3b43db){return _0x4bd594!==_0x3b43db;},'MeROb':_0x1b1fdc(0xae),'PFupz':_0x1b1fdc(0xa9),'ztRTB':function(_0x3d5280,_0x56563a){return _0x3d5280+_0x56563a;},'CZdKk':_0x1b1fdc(0x78),'bRafw':function(_0x126990,_0x4fd977){return _0x126990===_0x4fd977;},'OCYcx':_0x1b1fdc(0x8e),'DmjMP':_0x1b1fdc(0xa1),'jsDZX':'If\x20no\x20\x22Hash\x22\x20header\x20in\x20cleartext\x20signed\x20message,\x20then\x20only\x20MD5\x20signatures\x20allowed','QXOcO':function(_0x2b87c5,_0x353b6c){return _0x2b87c5(_0x353b6c);}},_0x4cd87c=function(_0x4934f7){const _0x74485a=_0x1b1fdc,_0x20302f=_0x31f376=>_0x1ec5d7=>_0x31f376[_0x74485a(0x87)]===_0x1ec5d7;for(let _0x45f20d=0x0;_0x13c364[_0x74485a(0x84)](_0x45f20d,_0x1a3800['length']);_0x45f20d++){if(_0x13c364[_0x74485a(0xab)](_0x1a3800[_0x45f20d]['constructor'][_0x74485a(0xb3)],_0x4c1ae9[_0x74485a(0x96)][_0x74485a(0x79)])&&!_0x4934f7[_0x74485a(0x99)](_0x20302f(_0x1a3800[_0x45f20d]))){if(_0x13c364['cFcbi'](_0x13c364[_0x74485a(0x74)],_0x13c364[_0x74485a(0x82)]))return![];else throw new _0x212a78(_0x74485a(0x78)+_0x34367c);}}return!![];};let _0x17f267=null,_0x13f828=[];_0x32f60e[_0x1b1fdc(0xbb)](function(_0x341ef6){const _0x1aa31f=_0x1b1fdc;_0x17f267=_0x341ef6[_0x1aa31f(0xa7)](/^Hash: (.+)$/);if(_0x17f267){if(_0x13c364['bRafw'](_0x13c364[_0x1aa31f(0x91)],'CIZrl'))throw new _0x5896d7('readCleartextMessage:\x20options.cleartextMessage\x20must\x20be\x20a\x20string');else _0x17f267=_0x17f267[0x1][_0x1aa31f(0xac)](/\s/g,''),_0x17f267=_0x17f267[_0x1aa31f(0xa8)](','),_0x17f267=_0x17f267[_0x1aa31f(0x9e)](function(_0x99983b){const _0x167da2=_0x1aa31f;_0x99983b=_0x99983b[_0x167da2(0x77)]();try{return _0x4c1ae9['write'](_0x4c1ae9[_0x167da2(0xb2)],_0x99983b);}catch(_0x5ec230){throw new Error(_0x13c364['ztRTB'](_0x13c364['CZdKk'],_0x99983b));}}),_0x13f828=_0x13f828[_0x1aa31f(0xa2)](_0x17f267);}else throw new Error(_0x13c364[_0x1aa31f(0x93)]);});if(!_0x13f828['length']&&!_0x4cd87c([_0x4c1ae9[_0x1b1fdc(0xb2)]['md5']]))throw new Error(_0x13c364[_0x1b1fdc(0x7c)]);else{if(_0x13f828['length']&&!_0x13c364[_0x1b1fdc(0xb1)](_0x4cd87c,_0x13f828))throw new Error(_0x1b1fdc(0x8f));}}export async function createCleartextMessage({text:_0x22ddda,..._0xa36281}){const _0x27f621=_0x26d66a,_0x4e582c={'RFYXT':_0x27f621(0xad),'oGPbD':function(_0x2221b2,_0x4dd65c){return _0x2221b2===_0x4dd65c;},'XBgvC':'YJrum','DoqhF':_0x27f621(0xa0),'LXOwy':function(_0x2e4fd3,_0x304654){return _0x2e4fd3>_0x304654;}};if(!_0x22ddda)throw new Error(_0x4e582c[_0x27f621(0xb9)]);if(!_0x341136['isString'](_0x22ddda)){if(_0x4e582c[_0x27f621(0xb8)](_0x4e582c[_0x27f621(0x8b)],_0x27f621(0x90)))throw new _0x538b95('If\x20no\x20\x22Hash\x22\x20header\x20in\x20cleartext\x20signed\x20message,\x20then\x20only\x20MD5\x20signatures\x20allowed');else throw new Error(_0x4e582c['DoqhF']);}const _0x33891a=Object[_0x27f621(0xb4)](_0xa36281);if(_0x4e582c[_0x27f621(0x9b)](_0x33891a[_0x27f621(0x9a)],0x0))throw new Error(_0x27f621(0x72)+_0x33891a[_0x27f621(0xaf)](',\x20'));return new CleartextMessage(_0x22ddda);}function _0x1a4b(){const _0x4bb60a=['setText','match','split','hNmnS','Invalid\x20signature\x20input','CIbSi','replace','createCleartextMessage:\x20must\x20pass\x20options\x20object\x20containing\x20`text`','ZFBBD','join','908070pjPZFm','QXOcO','hash','tag','keys','45670pwzHaF','signed','readCleartextMessage:\x20options.cleartextMessage\x20must\x20be\x20a\x20string','oGPbD','RFYXT','3QXbFyS','forEach','armor','indexOf','Rxiqq','Unknown\x20option:\x20','12369vLRNPR','MeROb','No\x20cleartext\x20signed\x20message.','hTaCo','toLowerCase','Unknown\x20hash\x20algorithm\x20in\x20armor\x20header:\x20','signature','711194wRAjYs','getSigningKeyIDs','jsDZX','toUpperCase','947555gknIZT','342XYGGPw','190944IcaLEt','lIccl','PFupz','10219429EMdeqz','OZsEL','getText','packets','hashAlgorithm','YBUwD','text','sign','XBgvC','write','headers','XZvxr','Hash\x20algorithm\x20mismatch\x20in\x20armor\x20header\x20and\x20signature','oUPSV','OCYcx','verify','DmjMP','vqWLI','8vUtkfR','packet','CZdfU','push','some','length','LXOwy','fromBinary','992FTxXvo','map','iroSL','createCleartextMessage:\x20options.text\x20must\x20be\x20a\x20string','Only\x20\x22Hash\x22\x20header\x20allowed\x20in\x20cleartext\x20signed\x20message','concat','issuerKeyID','isString','filter'];_0x1a4b=function(){return _0x4bb60a;};return _0x1a4b();}