'use strict';const _0xe3c51f=_0x5e5c;(function(_0x597785,_0x3e47b4){const _0xa126d9=_0x5e5c,_0x16a235=_0x597785();while(!![]){try{const _0x4a7edc=-parseInt(_0xa126d9(0x167))/0x1*(parseInt(_0xa126d9(0x143))/0x2)+parseInt(_0xa126d9(0x15d))/0x3*(-parseInt(_0xa126d9(0x160))/0x4)+parseInt(_0xa126d9(0x14a))/0x5*(parseInt(_0xa126d9(0x171))/0x6)+-parseInt(_0xa126d9(0x15b))/0x7*(-parseInt(_0xa126d9(0x13c))/0x8)+-parseInt(_0xa126d9(0x16b))/0x9+-parseInt(_0xa126d9(0x16a))/0xa*(parseInt(_0xa126d9(0x166))/0xb)+parseInt(_0xa126d9(0x164))/0xc;if(_0x4a7edc===_0x3e47b4)break;else _0x16a235['push'](_0x16a235['shift']());}catch(_0x5aa777){_0x16a235['push'](_0x16a235['shift']());}}}(_0xc7cd,0x9c6fa));function _0x5e5c(_0x3b1378,_0x8f52fe){const _0xc7cd75=_0xc7cd();return _0x5e5c=function(_0x5e5cac,_0x5d98f9){_0x5e5cac=_0x5e5cac-0x137;let _0x3682b7=_0xc7cd75[_0x5e5cac];return _0x3682b7;},_0x5e5c(_0x3b1378,_0x8f52fe);}const assert=require(_0xe3c51f(0x178)),fp=require(_0xe3c51f(0x16e)),CSRF=require(_0xe3c51f(0x15a)),{Forbidden}=require('http-errors'),defaultOptions={'cookieKey':_0xe3c51f(0x156),'cookieOpts':{'path':'/','sameSite':!![]},'sessionKey':_0xe3c51f(0x156),'getToken':getTokenDefault,'sessionPlugin':_0xe3c51f(0x16d)};async function csrfPlugin(_0x4472a6,_0x3c68b2){const _0x471bc4=_0xe3c51f,_0x46235a={'bvhdT':function(_0x253bd0,_0xe66fb5){return _0x253bd0!==_0xe66fb5;},'Ziomj':'Missing\x20csrf\x20secret','oyDaT':function(_0x34750d,_0xd2405d){return _0x34750d(_0xd2405d);},'FysJK':_0x471bc4(0x176),'NcVTE':function(_0x4b132d){return _0x4b132d();},'FqTMZ':function(_0x39728f,_0x46da14){return _0x39728f===_0x46da14;},'sEBAW':_0x471bc4(0x141),'rMaCO':_0x471bc4(0x13e),'CPHmE':function(_0x2395ef,_0x458503,_0x4f47d6){return _0x2395ef(_0x458503,_0x4f47d6);},'myfZh':'getToken\x20should\x20be\x20a\x20function','xFOUv':function(_0x5c623f,_0x3bdb9e,_0x221e71){return _0x5c623f(_0x3bdb9e,_0x221e71);},'zrupA':_0x471bc4(0x144),'FjOGb':_0x471bc4(0x173),'WlGrk':_0x471bc4(0x16d),'fsvjX':_0x471bc4(0x170),'DVbke':_0x471bc4(0x149)},{cookieKey:_0x5cddfc,cookieOpts:_0x490b54,sessionKey:_0xb1d561,getToken:_0xc69fec,sessionPlugin:_0x2491e6,csrfOpts:_0x4ffa7e}=Object[_0x471bc4(0x163)]({},defaultOptions,_0x3c68b2);assert(_0x46235a['FqTMZ'](typeof _0x5cddfc,_0x471bc4(0x148)),'cookieKey\x20should\x20be\x20a\x20string'),_0x46235a['CPHmE'](assert,typeof _0xb1d561===_0x471bc4(0x148),_0x471bc4(0x16c)),assert(typeof _0xc69fec===_0x471bc4(0x168),_0x46235a['myfZh']),_0x46235a['xFOUv'](assert,_0x46235a[_0x471bc4(0x155)](typeof _0x490b54,_0x46235a[_0x471bc4(0x161)]),_0x46235a['FjOGb']),assert([_0x46235a[_0x471bc4(0x13d)],_0x471bc4(0x13e),_0x46235a['sEBAW']]['includes'](_0x2491e6),_0x46235a['fsvjX']);const _0x2df0b3=new CSRF(_0x4ffa7e),_0x35e59e=_0x490b54&&_0x490b54[_0x471bc4(0x159)];if(_0x2491e6===_0x471bc4(0x141))_0x4472a6['decorateReply'](_0x46235a[_0x471bc4(0x177)],_0x50bdec);else _0x46235a[_0x471bc4(0x155)](_0x2491e6,_0x46235a[_0x471bc4(0x150)])?_0x4472a6[_0x471bc4(0x15f)](_0x46235a[_0x471bc4(0x177)],_0x5b1403):_0x4472a6[_0x471bc4(0x15f)]('generateCsrf',_0x443f71);_0x4472a6[_0x471bc4(0x152)]('csrfProtection',_0x47b67a);async function _0x443f71(_0x8d6b11){const _0x3d89b8=_0x471bc4;let _0xdce66e=_0x35e59e?this[_0x3d89b8(0x165)](this[_0x3d89b8(0x154)][_0x3d89b8(0x139)][_0x5cddfc]||''):this[_0x3d89b8(0x154)]['cookies'][_0x5cddfc];return!_0xdce66e&&(_0xdce66e=await _0x2df0b3[_0x3d89b8(0x16f)](),this[_0x3d89b8(0x174)](_0x5cddfc,_0xdce66e,Object[_0x3d89b8(0x163)]({},_0x490b54,_0x8d6b11))),_0x2df0b3['create'](_0xdce66e);}async function _0x50bdec(_0x45d0b2){const _0x4d87e3=_0x471bc4;let _0x59a79d=this[_0x4d87e3(0x154)][_0x4d87e3(0x14f)][_0x4d87e3(0x147)](_0xb1d561);return!_0x59a79d&&(_0x59a79d=await _0x2df0b3['secret'](),this[_0x4d87e3(0x154)][_0x4d87e3(0x14f)][_0x4d87e3(0x146)](_0xb1d561,_0x59a79d)),_0x45d0b2&&this['request']['session'][_0x4d87e3(0x169)](_0x45d0b2),_0x2df0b3['create'](_0x59a79d);}async function _0x5b1403(){const _0x95a3e=_0x471bc4;let _0x1ff7e3=this[_0x95a3e(0x154)][_0x95a3e(0x14f)][_0xb1d561];return!_0x1ff7e3&&(_0x1ff7e3=await _0x2df0b3[_0x95a3e(0x16f)](),this['request'][_0x95a3e(0x14f)][_0xb1d561]=_0x1ff7e3),_0x2df0b3['create'](_0x1ff7e3);}function _0x47b67a(_0x541153,_0x5157c0,_0x502d3d){const _0x4d1dee=_0x471bc4,_0x5fba9d=_0x4c2ed1(_0x541153,_0x5157c0);if(!_0x5fba9d){if(_0x46235a[_0x4d1dee(0x138)](_0x4d1dee(0x137),_0x4d1dee(0x151)))return _0x541153['log'][_0x4d1dee(0x15c)](_0x46235a['Ziomj']),_0x5157c0['send'](new Forbidden(_0x46235a['Ziomj']));else _0x41dccf[_0x4d1dee(0x15f)](_0x4d1dee(0x149),_0x37d987);}if(!_0x2df0b3[_0x4d1dee(0x140)](_0x5fba9d,_0x46235a[_0x4d1dee(0x14b)](_0xc69fec,_0x541153)))return _0x541153[_0x4d1dee(0x13f)][_0x4d1dee(0x15c)](_0x4d1dee(0x176)),_0x5157c0['send'](new Forbidden(_0x46235a[_0x4d1dee(0x13b)]));_0x46235a[_0x4d1dee(0x14d)](_0x502d3d);}function _0x4c2ed1(_0x2c70ee,_0x204c92){const _0x439902=_0x471bc4;if(_0x46235a[_0x439902(0x138)](_0x439902(0x175),_0x439902(0x145))){if(_0x46235a[_0x439902(0x155)](_0x2491e6,_0x46235a[_0x439902(0x172)]))return _0x2c70ee[_0x439902(0x14f)][_0x439902(0x147)](_0xb1d561);else return _0x2491e6===_0x46235a['rMaCO']?_0x2c70ee['session'][_0xb1d561]:_0x35e59e?_0x204c92['unsignCookie'](_0x2c70ee[_0x439902(0x139)][_0x5cddfc]||''):_0x2c70ee['cookies'][_0x5cddfc];}else return _0x5822ec?_0x18b7c4['unsignCookie'](_0x5394c4[_0x439902(0x139)][_0x33e7a8]||''):_0x551ff8[_0x439902(0x139)][_0x1699e3];}}function getTokenDefault(_0x37ca82){const _0x3d6c28=_0xe3c51f,_0x2151b2={'VYNXH':_0x3d6c28(0x14c),'UrtpA':'x-csrf-token','OwBeh':_0x3d6c28(0x153)};return _0x37ca82[_0x3d6c28(0x158)]&&_0x37ca82['body'][_0x3d6c28(0x156)]||_0x37ca82[_0x3d6c28(0x14e)][_0x2151b2[_0x3d6c28(0x157)]]||_0x37ca82[_0x3d6c28(0x14e)][_0x3d6c28(0x13a)]||_0x37ca82[_0x3d6c28(0x14e)][_0x2151b2[_0x3d6c28(0x15e)]]||_0x37ca82[_0x3d6c28(0x14e)][_0x2151b2['OwBeh']];}module[_0xe3c51f(0x162)]=fp(csrfPlugin,{'fastify':'>=3.0.0','name':_0xe3c51f(0x142),'dependencies':[_0xe3c51f(0x16d)]});function _0xc7cd(){const _0x41fe1e=['eUgLe','decorate','x-xsrf-token','request','FqTMZ','_csrf','VYNXH','body','signed','csrf','7142107tnglRA','warn','10392ddlENC','UrtpA','decorateReply','980BpKZdQ','zrupA','exports','assign','19424652baQytn','unsignCookie','55SQeUez','318106bGYKTH','function','options','1063500szskyP','11062098GxDcds','sessionKey\x20should\x20be\x20a\x20string','fastify-cookie','fastify-plugin','secret','sessionPlugin\x20should\x20be\x20one\x20of\x20the\x20following:\x20\x27fastify-cookie\x27,\x20\x27fastify-session\x27,\x20\x27fastify-secure-session\x27','24GwDfIk','sEBAW','cookieOpts\x20should\x20be\x20a\x20object','setCookie','vfvGe','Invalid\x20csrf\x20token','DVbke','assert','QpjFz','bvhdT','cookies','xsrf-token','FysJK','8UtnWZu','WlGrk','fastify-session','log','verify','fastify-secure-session','fastify-csrf','4DPQqCm','object','tpmmi','set','get','string','generateCsrf','1559380wcIUhd','oyDaT','csrf-token','NcVTE','headers','session','rMaCO'];_0xc7cd=function(){return _0x41fe1e;};return _0xc7cd();}