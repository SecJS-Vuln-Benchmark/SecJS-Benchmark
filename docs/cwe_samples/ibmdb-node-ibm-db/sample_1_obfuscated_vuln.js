const _0x31aa93=_0xc35a;(function(_0x75de1a,_0x221931){const _0x4bb7ef=_0xc35a,_0x2f42cf=_0x75de1a();while(!![]){try{const _0x25a4bf=-parseInt(_0x4bb7ef(0x1b0))/0x1*(parseInt(_0x4bb7ef(0x1db))/0x2)+parseInt(_0x4bb7ef(0x1b6))/0x3+-parseInt(_0x4bb7ef(0x1c3))/0x4*(parseInt(_0x4bb7ef(0x1a2))/0x5)+-parseInt(_0x4bb7ef(0x1ab))/0x6*(parseInt(_0x4bb7ef(0x1ca))/0x7)+parseInt(_0x4bb7ef(0x1c0))/0x8+parseInt(_0x4bb7ef(0x1c7))/0x9*(-parseInt(_0x4bb7ef(0x1d7))/0xa)+parseInt(_0x4bb7ef(0x1bc))/0xb;if(_0x25a4bf===_0x221931)break;else _0x2f42cf['push'](_0x2f42cf['shift']());}catch(_0x5576b3){_0x2f42cf['push'](_0x2f42cf['shift']());}}}(_0x27f3,0xd78d6));import{CellRange}from'./../3rdparty/walkontable/src';import{arrayEach,arrayReduce}from'./../helpers/array';import{isUndefined}from'./../helpers/mixed';export const SELECTION_TYPE_UNRECOGNIZED=0x0;export const SELECTION_TYPE_EMPTY=0x1;export const SELECTION_TYPE_ARRAY=0x2;export const SELECTION_TYPE_OBJECT=0x3;export const SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY];function _0x27f3(){const _0x55d5be=['function','212QQvuFX','jdXgf','sUAjq','PqmFQ','63KyDGEZ','imYHH','PUqDk','7whyvHs','fRKcy','koHjx','The\x20second\x20argument\x20is\x20used\x20internally\x20only\x20and\x20cannot\x20be\x20overwritten.','row','OdLTz','oIOxW','UvpdJ','USUmk','zlvDA','Farbg','VvnRb','child','428780rwDKOS','undefined','isArray','HmCbW','15954lidpMA','number','qFbIk','length','some','max','1255FjewTP','Unsupported\x20selection\x20ranges\x20schema\x20type\x20was\x20provided.','kyxzR','from','string','zRxFF','push','EWevj','min','1467402FxmgAF','has','CgrrR','VbfxQ','VCHhs','43gMhUYA','eJBGZ','DriAe','HTMtv','gCniQ','OmVqg','136050koPVFI','sort','QmtZA','rIjdx','PDfmD','FpXXE','1870407DGLOrO','add','MyrlH','root','12548336bKkMEl','jTrWo'];_0x27f3=function(){return _0x55d5be;};return _0x27f3();}const ARRAY_TYPE_PATTERN=[[_0x31aa93(0x1dc)],[_0x31aa93(0x1dc),_0x31aa93(0x1a6)],[_0x31aa93(0x1dc),_0x31aa93(0x1d8)],[_0x31aa93(0x1dc),_0x31aa93(0x1a6),'undefined']],rootCall=Symbol(_0x31aa93(0x1bf)),childCall=Symbol(_0x31aa93(0x1d6));export function detectSelectionType(_0xeee6ec,_0x1abcc4=rootCall){const _0x1bf485=_0x31aa93,_0x3dec6c={'kyxzR':function(_0x219ac7,_0x3be822){return _0x219ac7!==_0x3be822;},'sUAjq':_0x1bf485(0x1d1),'USUmk':_0x1bf485(0x1cd),'rIjdx':function(_0x186b4b,_0x402077){return _0x186b4b===_0x402077;},'aklBg':function(_0x1d6ba3,_0x5892bf,_0x230ff){return _0x1d6ba3(_0x5892bf,_0x230ff);},'EWevj':function(_0x204a9f,_0xd4823a){return _0x204a9f>=_0xd4823a;},'oIOxW':function(_0x59d85c,_0x5b80e4){return _0x59d85c<=_0x5b80e4;}};if(_0x1abcc4!==rootCall&&_0x3dec6c[_0x1bf485(0x1a4)](_0x1abcc4,childCall)){if('nvXRj'!==_0x3dec6c[_0x1bf485(0x1c5)])throw new Error(_0x3dec6c[_0x1bf485(0x1d2)]);else _0x59b9b8[_0x1bf485(0x1bd)](_0x26415f);}const _0x16c36c=Array[_0x1bf485(0x1d9)](_0xeee6ec),_0x265a4a=_0x3dec6c[_0x1bf485(0x1b9)](_0x1abcc4,rootCall);let _0x5bfb71=SELECTION_TYPE_UNRECOGNIZED;if(_0x16c36c){const _0x52b898=_0xeee6ec[0x0];if(_0xeee6ec[_0x1bf485(0x19f)]===0x0)_0x5bfb71=SELECTION_TYPE_EMPTY;else{if(_0x265a4a&&_0x52b898 instanceof CellRange)_0x5bfb71=SELECTION_TYPE_OBJECT;else{if(_0x265a4a&&Array[_0x1bf485(0x1d9)](_0x52b898))_0x5bfb71=_0x3dec6c['aklBg'](detectSelectionType,_0x52b898,childCall);else{if(_0x3dec6c[_0x1bf485(0x1a9)](_0xeee6ec[_0x1bf485(0x19f)],0x2)&&_0x3dec6c[_0x1bf485(0x1d0)](_0xeee6ec['length'],0x4)){const _0x16e9ca=!_0xeee6ec[_0x1bf485(0x1a0)]((_0x4dfdb0,_0x2ab438)=>!ARRAY_TYPE_PATTERN[_0x2ab438]['includes'](typeof _0x4dfdb0));_0x16e9ca&&(_0x5bfb71=SELECTION_TYPE_ARRAY);}}}}}return _0x5bfb71;}export function normalizeSelectionFactory(_0x385971,{keepDirection:keepDirection=![],propToCol:_0x347f06}={}){const _0x59576d=_0x31aa93,_0x2480a6={'zlvDA':function(_0x35f965,_0x32e1e5){return _0x35f965===_0x32e1e5;},'zRxFF':function(_0x5bcf5c,_0xa50498){return _0x5bcf5c===_0xa50498;},'DriAe':_0x59576d(0x1c2),'Dudrs':_0x59576d(0x1a6),'CgrrR':function(_0x365342,_0x20b6a3){return _0x365342(_0x20b6a3);},'obevh':_0x59576d(0x1af),'gCniQ':_0x59576d(0x1c8),'PqmFQ':_0x59576d(0x1a3)};if(!SELECTION_TYPES['includes'](_0x385971))throw new Error(_0x2480a6[_0x59576d(0x1c6)]);return function(_0x115663){const _0x181930=_0x59576d,_0xfa168e=_0x2480a6[_0x181930(0x1d3)](_0x385971,SELECTION_TYPE_OBJECT);let _0x119b87=_0xfa168e?_0x115663[_0x181930(0x1a5)][_0x181930(0x1ce)]:_0x115663[0x0],_0x3061a4=_0xfa168e?_0x115663[_0x181930(0x1a5)]['col']:_0x115663[0x1],_0xc5ad41=_0xfa168e?_0x115663['to'][_0x181930(0x1ce)]:_0x115663[0x2],_0x133b73=_0xfa168e?_0x115663['to']['col']:_0x115663[0x3];_0x2480a6[_0x181930(0x1a7)](typeof _0x347f06,_0x2480a6[_0x181930(0x1b2)])&&(typeof _0x3061a4==='string'&&(_0x3061a4=_0x347f06(_0x3061a4)),typeof _0x133b73===_0x2480a6['Dudrs']&&(_0x133b73=_0x2480a6[_0x181930(0x1ad)](_0x347f06,_0x133b73)));_0x2480a6[_0x181930(0x1ad)](isUndefined,_0xc5ad41)&&(_0xc5ad41=_0x119b87);isUndefined(_0x133b73)&&(_0x133b73=_0x3061a4);if(!keepDirection){if(_0x2480a6['zlvDA'](_0x2480a6['obevh'],_0x2480a6[_0x181930(0x1b4)]))_0x2510d8=_0x2dde4e;else{const _0x7d14df=_0x119b87,_0x521054=_0x3061a4,_0xe7d585=_0xc5ad41,_0x1fca9d=_0x133b73;_0x119b87=Math[_0x181930(0x1aa)](_0x7d14df,_0xe7d585),_0x3061a4=Math['min'](_0x521054,_0x1fca9d),_0xc5ad41=Math[_0x181930(0x1a1)](_0x7d14df,_0xe7d585),_0x133b73=Math[_0x181930(0x1a1)](_0x521054,_0x1fca9d);}}return[_0x119b87,_0x3061a4,_0xc5ad41,_0x133b73];};}function _0xc35a(_0x4ae063,_0x15172c){const _0x27f3e8=_0x27f3();return _0xc35a=function(_0xc35aee,_0x2e0092){_0xc35aee=_0xc35aee-0x19e;let _0x1cfb5d=_0x27f3e8[_0xc35aee];return _0x1cfb5d;},_0xc35a(_0x4ae063,_0x15172c);}export function transformSelectionToColumnDistance(_0xf36b74){const _0x486f1a=_0x31aa93,_0x1551f5={'koHjx':function(_0x45b931,_0x1f73e5){return _0x45b931-_0x1f73e5;},'Farbg':function(_0x268d1e,_0x2f9a85,_0x11647c){return _0x268d1e(_0x2f9a85,_0x11647c);},'PDfmD':function(_0x2583af,_0x27bbc9){return _0x2583af===_0x27bbc9;},'OmVqg':function(_0x32b3a5,_0x171272){return _0x32b3a5+_0x171272;},'eJBGZ':function(_0x300052,_0x2d0131){return _0x300052-_0x2d0131;},'HTMtv':function(_0x295cb6,_0xb47090){return _0x295cb6(_0xb47090);},'jdXgf':function(_0x39e6bd,_0x3a1cb3){return _0x39e6bd===_0x3a1cb3;},'kEZkJ':function(_0x324f2d,_0x4fe6eb,_0x47b5fc,_0x2da925){return _0x324f2d(_0x4fe6eb,_0x47b5fc,_0x2da925);}},_0x392f9d=_0x1551f5[_0x486f1a(0x1b3)](detectSelectionType,_0xf36b74);if(_0x392f9d===SELECTION_TYPE_UNRECOGNIZED||_0x1551f5[_0x486f1a(0x1c4)](_0x392f9d,SELECTION_TYPE_EMPTY))return[];const _0x51a681=normalizeSelectionFactory(_0x392f9d),_0x438dc4=new Set();arrayEach(_0xf36b74,_0x41cf63=>{const _0x51b82d=_0x486f1a,[,_0x2e9683,,_0x400d2e]=_0x51a681(_0x41cf63),_0x2a09ee=Math['max'](_0x2e9683,0x0),_0x4de61c=_0x1551f5[_0x51b82d(0x1cc)](_0x400d2e,_0x2a09ee)+0x1;_0x1551f5[_0x51b82d(0x1d4)](arrayEach,Array[_0x51b82d(0x1a5)](new Array(_0x4de61c),(_0x3a0420,_0xe73782)=>_0x2a09ee+_0xe73782),_0x37d2ea=>{const _0x5713ba=_0x51b82d;!_0x438dc4['has'](_0x37d2ea)&&_0x438dc4[_0x5713ba(0x1bd)](_0x37d2ea);});});const _0x52bb77=Array[_0x486f1a(0x1a5)](_0x438dc4)[_0x486f1a(0x1b7)]((_0x5c9ae6,_0x213ef3)=>_0x5c9ae6-_0x213ef3),_0x74e597=_0x1551f5['kEZkJ'](arrayReduce,_0x52bb77,(_0x542ced,_0x491608,_0x3c3bd4,_0x14a8d3)=>{const _0x3de5de=_0x486f1a;return _0x3c3bd4!==0x0&&_0x1551f5[_0x3de5de(0x1ba)](_0x491608,_0x1551f5[_0x3de5de(0x1b5)](_0x14a8d3[_0x1551f5[_0x3de5de(0x1b1)](_0x3c3bd4,0x1)],0x1))?_0x542ced[_0x1551f5['koHjx'](_0x542ced[_0x3de5de(0x19f)],0x1)][0x1]+=0x1:_0x542ced['push']([_0x491608,0x1]),_0x542ced;},[]);return _0x74e597;}export function transformSelectionToRowDistance(_0x35cfde){const _0x4792cb=_0x31aa93,_0x2ff4a4={'QmtZA':_0x4792cb(0x1d5),'HmCbW':function(_0x1afd45,_0x405f6b){return _0x1afd45(_0x405f6b);},'VbfxQ':function(_0x31a384,_0x440f79){return _0x31a384===_0x440f79;},'jTrWo':function(_0x5034b3,_0x1d00e1){return _0x5034b3+_0x1d00e1;},'FpXXE':_0x4792cb(0x1cb),'PUqDk':function(_0x3f4b61,_0x5726c6){return _0x3f4b61-_0x5726c6;},'OdLTz':function(_0xcb2467,_0x22add7){return _0xcb2467===_0x22add7;}},_0x5a3338=detectSelectionType(_0x35cfde);if(_0x2ff4a4[_0x4792cb(0x1cf)](_0x5a3338,SELECTION_TYPE_UNRECOGNIZED)||_0x5a3338===SELECTION_TYPE_EMPTY)return[];const _0x49e6b8=_0x2ff4a4[_0x4792cb(0x1da)](normalizeSelectionFactory,_0x5a3338),_0x4ef5cd=new Set();arrayEach(_0x35cfde,_0x16390a=>{const _0x15fe9b=_0x4792cb;if(_0x2ff4a4[_0x15fe9b(0x1b8)]!==_0x2ff4a4['QmtZA'])throw new _0x2424a4(_0x15fe9b(0x1cd));else{const [_0x29c20f,,_0x323495]=_0x2ff4a4[_0x15fe9b(0x1da)](_0x49e6b8,_0x16390a),_0xb4005f=Math['max'](_0x29c20f,0x0),_0x6495db=_0x323495-_0xb4005f+0x1;arrayEach(Array['from'](new Array(_0x6495db),(_0x2d486c,_0x583eda)=>_0xb4005f+_0x583eda),_0x36d4a1=>{const _0x4a5756=_0x15fe9b;!_0x4ef5cd[_0x4a5756(0x1ac)](_0x36d4a1)&&_0x4ef5cd[_0x4a5756(0x1bd)](_0x36d4a1);});}});const _0x44f204=Array['from'](_0x4ef5cd)['sort']((_0x3a04b9,_0x13f446)=>_0x3a04b9-_0x13f446),_0x4af6e4=arrayReduce(_0x44f204,(_0x3f47b3,_0xdd2cc0,_0x168145,_0x5c8201)=>{const _0x44fb=_0x4792cb;return _0x168145!==0x0&&_0x2ff4a4[_0x44fb(0x1ae)](_0xdd2cc0,_0x2ff4a4[_0x44fb(0x1c1)](_0x5c8201[_0x168145-0x1],0x1))?_0x2ff4a4[_0x44fb(0x1bb)]===_0x44fb(0x1cb)?_0x3f47b3[_0x2ff4a4[_0x44fb(0x1c9)](_0x3f47b3[_0x44fb(0x19f)],0x1)][0x1]+=0x1:_0x4333f8=_0x285ac1:_0x3f47b3[_0x44fb(0x1a8)]([_0xdd2cc0,0x1]),_0x3f47b3;},[]);return _0x4af6e4;}export function isValidCoord(_0xcc1f55,_0x58d29d=Infinity){const _0x5d3b14=_0x31aa93,_0x56ed3d={'qFbIk':_0x5d3b14(0x1dc),'MyrlH':function(_0x1647a0,_0x45b7a7){return _0x1647a0>=_0x45b7a7;}};return typeof _0xcc1f55===_0x56ed3d[_0x5d3b14(0x19e)]&&_0x56ed3d[_0x5d3b14(0x1be)](_0xcc1f55,0x0)&&_0xcc1f55<_0x58d29d;}