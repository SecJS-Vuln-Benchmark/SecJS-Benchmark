(function(_0x32c97d,_0x268f4c){const _0xa9d580=_0x270e,_0x9354e6=_0x32c97d();while(!![]){try{const _0x261b92=-parseInt(_0xa9d580(0x6b))/0x1+parseInt(_0xa9d580(0x74))/0x2+parseInt(_0xa9d580(0x7a))/0x3*(-parseInt(_0xa9d580(0x72))/0x4)+-parseInt(_0xa9d580(0x78))/0x5+parseInt(_0xa9d580(0x76))/0x6*(parseInt(_0xa9d580(0x70))/0x7)+-parseInt(_0xa9d580(0x69))/0x8+-parseInt(_0xa9d580(0x71))/0x9*(-parseInt(_0xa9d580(0x79))/0xa);if(_0x261b92===_0x268f4c)break;else _0x9354e6['push'](_0x9354e6['shift']());}catch(_0x5ab1f5){_0x9354e6['push'](_0x9354e6['shift']());}}}(_0x55c4,0x69a17));function _0x55c4(){const _0x5dc730=['should\x20fail\x20to\x20encrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','should\x20fail\x20to\x20decrypt\x20if\x20a\x20secret\x20is\x20not\x20provided','JVTIa','QKBIX','5341600EcDiOy','rejects','854957ZdhtwZ','should\x20fail\x20to\x20decrypt\x20a\x20payload\x20with\x20the\x20incorrect\x20secret','rAKht','qKZgi','value','4102553upvDZC','285669MSZtGr','117556ysVIHR','MIPyD','437492LEOHBk','toThrowError','6QpaDSY','payload','3305470zKUkYO','580kGOxxQ','3xooDLw','toEqual'];_0x55c4=function(){return _0x5dc730;};return _0x55c4();}import{describe,expect,it}from'vitest';import{generateSecret}from'../test/utils';import{decrypt,encrypt}from'./cookies';function _0x270e(_0xd01d2b,_0x43b497){const _0x55c437=_0x55c4();return _0x270e=function(_0x270e8d,_0x1af11a){_0x270e8d=_0x270e8d-0x67;let _0x33d133=_0x55c437[_0x270e8d];return _0x33d133;},_0x270e(_0xd01d2b,_0x43b497);}describe('encrypt/decrypt',async()=>{const _0x286fc1=_0x270e,_0x5ed387={'qKZgi':_0x286fc1(0x6f),'uQIbB':function(_0x358df2,_0x4d98f6,_0x21c1ae){return _0x358df2(_0x4d98f6,_0x21c1ae);},'QKBIX':function(_0x2789be,_0x3b821f,_0x1edd70){return _0x2789be(_0x3b821f,_0x1edd70);},'rAKht':function(_0x59930e,_0x5779ba){return _0x59930e(_0x5779ba);},'MIPyD':function(_0x3f6f4f,_0xafe27b){return _0x3f6f4f(_0xafe27b);},'HnXNu':function(_0x216c7d,_0x4ca45a,_0x47ab0e){return _0x216c7d(_0x4ca45a,_0x47ab0e);},'JVTIa':'should\x20encrypt/decrypt\x20a\x20payload\x20with\x20the\x20correct\x20secret','obKtR':_0x286fc1(0x7d)},_0x1e5048=await _0x5ed387[_0x286fc1(0x73)](generateSecret,0x20),_0x4cb699=await generateSecret(0x20);_0x5ed387['HnXNu'](it,_0x5ed387[_0x286fc1(0x67)],async()=>{const _0x4cdff1=_0x286fc1,_0x1ed3a4={'key':_0x5ed387['qKZgi']},_0x168a2c=await _0x5ed387['uQIbB'](encrypt,_0x1ed3a4,_0x1e5048),_0x1cba06=await decrypt(_0x168a2c,_0x1e5048);expect(_0x1cba06[_0x4cdff1(0x77)])[_0x4cdff1(0x7b)](_0x1ed3a4);}),_0x5ed387['HnXNu'](it,_0x286fc1(0x6c),async()=>{const _0x5aab45=_0x286fc1,_0x4804cb={'key':'value'},_0x5a25c0=await _0x5ed387['QKBIX'](encrypt,_0x4804cb,_0x1e5048);await _0x5ed387[_0x5aab45(0x6d)](expect,()=>decrypt(_0x5a25c0,_0x4cb699))[_0x5aab45(0x6a)][_0x5aab45(0x75)]();}),it(_0x286fc1(0x7c),async()=>{const _0x4d5f99=_0x286fc1,_0x1fa8f7={'key':_0x5ed387[_0x4d5f99(0x6e)]};await _0x5ed387['rAKht'](expect,()=>encrypt(_0x1fa8f7,''))[_0x4d5f99(0x6a)][_0x4d5f99(0x75)]();}),_0x5ed387['HnXNu'](it,_0x5ed387['obKtR'],async()=>{const _0xeebac2=_0x286fc1,_0x47f1b1={'key':_0xeebac2(0x6f)},_0x4f0b3c=await _0x5ed387[_0xeebac2(0x68)](encrypt,_0x47f1b1,_0x1e5048);await expect(()=>decrypt(_0x4f0b3c,''))[_0xeebac2(0x6a)][_0xeebac2(0x75)]();});});