const _0x5ec04b=_0x1814;function _0x23c7(){const _0x11d1aa=['type','docker-compose','1761020ymkJDb','VQDKU','enum','DmlZe','27VSoGPf','standalone','Invalid\x20app\x20name.','fgqOP','appType','aGyCA','mxdgC','mutation','12acPajb','808509XmdkTh','2QRDsoV','session','literal','containerId','YykAi','lyzxr','min','Enyje','LegbL','swarm','XGBuB','organizationId','1591908NphBiE','2441848QoxdKc','query','stack','activeOrganizationId','162362KBvKvj','yaDtn','UNAUTHORIZED','IQIhS','object','7671783TboUHp','regex','serverId','wAjQn','string','9572480eaDbCU','IycuY','ICYLQ','qSupD','input','appName','optional','Invalid\x20container\x20id.','Acprp'];_0x23c7=function(){return _0x11d1aa;};return _0x23c7();}(function(_0x2f4e9f,_0x5be0ef){const _0x287551=_0x1814,_0x12d8ca=_0x2f4e9f();while(!![]){try{const _0x86dd88=parseInt(_0x287551(0x93))/0x1*(-parseInt(_0x287551(0x82))/0x2)+-parseInt(_0x287551(0x81))/0x3*(-parseInt(_0x287551(0x80))/0x4)+parseInt(_0x287551(0x9d))/0x5+-parseInt(_0x287551(0x8e))/0x6+-parseInt(_0x287551(0x98))/0x7+parseInt(_0x287551(0x8f))/0x8+parseInt(_0x287551(0xac))/0x9*(-parseInt(_0x287551(0xa8))/0xa);if(_0x86dd88===_0x5be0ef)break;else _0x12d8ca['push'](_0x12d8ca['shift']());}catch(_0x2b8fcd){_0x12d8ca['push'](_0x12d8ca['shift']());}}}(_0x23c7,0xee599));import{containerRestart,findServerById,getConfig,getContainers,getContainersByAppLabel,getContainersByAppNameMatch,getServiceContainersByAppName,getStackContainersByAppName}from'@dokploy/server';function _0x1814(_0x2e445c,_0x3f0312){const _0x23c74a=_0x23c7();return _0x1814=function(_0x181470,_0x184ae3){_0x181470=_0x181470-0x7d;let _0x4aecff=_0x23c74a[_0x181470];return _0x4aecff;},_0x1814(_0x2e445c,_0x3f0312);}import{z}from'zod';import{createTRPCRouter,protectedProcedure}from'../trpc';import{TRPCError}from'@trpc/server';export const containerIdRegex=/^[a-zA-Z0-9.\-_]+$/;export const dockerRouter=createTRPCRouter({'getContainers':protectedProcedure[_0x5ec04b(0xa1)](z[_0x5ec04b(0x97)]({'serverId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0xa3)]()}))['query'](async({input:_0x4e26d5,ctx:_0x42e958})=>{const _0x25ed56=_0x5ec04b,_0x4168ef={'lyzxr':_0x25ed56(0x95),'nsKbg':function(_0x1a6c17,_0x9f1d71){return _0x1a6c17(_0x9f1d71);},'mxdgC':function(_0x3e3441,_0x28acea){return _0x3e3441!==_0x28acea;},'ICYLQ':function(_0x3843db,_0x43f0bf){return _0x3843db===_0x43f0bf;},'VQDKU':'TJTOw'};if(_0x4e26d5['serverId']){const _0x456c4d=await _0x4168ef['nsKbg'](findServerById,_0x4e26d5[_0x25ed56(0x9a)]);if(_0x4168ef[_0x25ed56(0x7e)](_0x456c4d[_0x25ed56(0x8d)],_0x42e958[_0x25ed56(0x83)]?.[_0x25ed56(0x92)])){if(_0x4168ef[_0x25ed56(0x9f)](_0x4168ef[_0x25ed56(0xa9)],'lFdqp'))throw new _0x55fae6({'code':_0x4168ef[_0x25ed56(0x87)]});else throw new TRPCError({'code':_0x4168ef[_0x25ed56(0x87)]});}}return await getContainers(_0x4e26d5[_0x25ed56(0x9a)]);}),'restartContainer':protectedProcedure[_0x5ec04b(0xa1)](z[_0x5ec04b(0x97)]({'containerId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)['regex'](containerIdRegex,_0x5ec04b(0xa4))}))[_0x5ec04b(0x7f)](async({input:_0xdb28c3})=>{const _0x226c5c=_0x5ec04b,_0x576863={'fgqOP':function(_0x29fda5,_0xb0127d){return _0x29fda5(_0xb0127d);}};return await _0x576863[_0x226c5c(0xaf)](containerRestart,_0xdb28c3[_0x226c5c(0x85)]);}),'getConfig':protectedProcedure['input'](z['object']({'containerId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)['regex'](containerIdRegex,_0x5ec04b(0xa4)),'serverId':z[_0x5ec04b(0x9c)]()['optional']()}))[_0x5ec04b(0x90)](async({input:_0x27efc4,ctx:_0x3d1ba3})=>{const _0x524a82=_0x5ec04b,_0x3d395b={'Enyje':function(_0x2d39c2,_0x396511){return _0x2d39c2===_0x396511;},'IQIhS':'UNAUTHORIZED','wAjQn':function(_0x79bf46,_0x3a86cc,_0xa34b7b){return _0x79bf46(_0x3a86cc,_0xa34b7b);}};if(_0x27efc4[_0x524a82(0x9a)]){if(_0x3d395b[_0x524a82(0x89)]('mIDNl','LWThH'))throw new _0x9ee320({'code':'UNAUTHORIZED'});else{const _0x3f6101=await findServerById(_0x27efc4[_0x524a82(0x9a)]);if(_0x3f6101[_0x524a82(0x8d)]!==_0x3d1ba3[_0x524a82(0x83)]?.[_0x524a82(0x92)])throw new TRPCError({'code':_0x3d395b[_0x524a82(0x96)]});}}return await _0x3d395b[_0x524a82(0x9b)](getConfig,_0x27efc4['containerId'],_0x27efc4[_0x524a82(0x9a)]);}),'getContainersByAppNameMatch':protectedProcedure[_0x5ec04b(0xa1)](z[_0x5ec04b(0x97)]({'appType':z['union']([z[_0x5ec04b(0x84)](_0x5ec04b(0x91)),z['literal'](_0x5ec04b(0xa7))])[_0x5ec04b(0xa3)](),'appName':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)[_0x5ec04b(0x99)](containerIdRegex,_0x5ec04b(0xae)),'serverId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0xa3)]()}))['query'](async({input:_0x1bff65,ctx:_0x2e9310})=>{const _0x12ebf0=_0x5ec04b,_0x43bf90={'qSupD':function(_0x3f1420,_0x388b44){return _0x3f1420(_0x388b44);}};if(_0x1bff65[_0x12ebf0(0x9a)]){const _0x7957e1=await _0x43bf90[_0x12ebf0(0xa0)](findServerById,_0x1bff65[_0x12ebf0(0x9a)]);if(_0x7957e1[_0x12ebf0(0x8d)]!==_0x2e9310[_0x12ebf0(0x83)]?.[_0x12ebf0(0x92)])throw new TRPCError({'code':_0x12ebf0(0x95)});}return await getContainersByAppNameMatch(_0x1bff65['appName'],_0x1bff65[_0x12ebf0(0xb0)],_0x1bff65[_0x12ebf0(0x9a)]);}),'getContainersByAppLabel':protectedProcedure['input'](z[_0x5ec04b(0x97)]({'appName':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)[_0x5ec04b(0x99)](containerIdRegex,_0x5ec04b(0xae)),'serverId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0xa3)](),'type':z[_0x5ec04b(0xaa)]([_0x5ec04b(0xad),_0x5ec04b(0x8b)])}))[_0x5ec04b(0x90)](async({input:_0x23aa38,ctx:_0x54d436})=>{const _0x479761=_0x5ec04b,_0x1afecf={'yaDtn':'UNAUTHORIZED'};if(_0x23aa38[_0x479761(0x9a)]){const _0x5cea97=await findServerById(_0x23aa38[_0x479761(0x9a)]);if(_0x5cea97[_0x479761(0x8d)]!==_0x54d436[_0x479761(0x83)]?.[_0x479761(0x92)])throw new TRPCError({'code':_0x1afecf[_0x479761(0x94)]});}return await getContainersByAppLabel(_0x23aa38[_0x479761(0xa2)],_0x23aa38[_0x479761(0xa6)],_0x23aa38[_0x479761(0x9a)]);}),'getStackContainersByAppName':protectedProcedure[_0x5ec04b(0xa1)](z['object']({'appName':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)[_0x5ec04b(0x99)](containerIdRegex,_0x5ec04b(0xae)),'serverId':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0xa3)]()}))['query'](async({input:_0x288914,ctx:_0x1a9a51})=>{const _0xeea481=_0x5ec04b,_0x5d6e15={'YykAi':function(_0x1e3102,_0x2a3ed1){return _0x1e3102(_0x2a3ed1);},'LegbL':function(_0x1ac607,_0x1c2f27){return _0x1ac607!==_0x1c2f27;},'nXQem':'UNAUTHORIZED','Acprp':function(_0x16e305,_0x18484c,_0xea88de){return _0x16e305(_0x18484c,_0xea88de);}};if(_0x288914[_0xeea481(0x9a)]){const _0x2c213d=await _0x5d6e15[_0xeea481(0x86)](findServerById,_0x288914[_0xeea481(0x9a)]);if(_0x5d6e15[_0xeea481(0x8a)](_0x2c213d['organizationId'],_0x1a9a51['session']?.[_0xeea481(0x92)]))throw new TRPCError({'code':_0x5d6e15['nXQem']});}return await _0x5d6e15[_0xeea481(0xa5)](getStackContainersByAppName,_0x288914[_0xeea481(0xa2)],_0x288914[_0xeea481(0x9a)]);}),'getServiceContainersByAppName':protectedProcedure[_0x5ec04b(0xa1)](z[_0x5ec04b(0x97)]({'appName':z[_0x5ec04b(0x9c)]()[_0x5ec04b(0x88)](0x1)[_0x5ec04b(0x99)](containerIdRegex,_0x5ec04b(0xae)),'serverId':z['string']()[_0x5ec04b(0xa3)]()}))[_0x5ec04b(0x90)](async({input:_0x580fac,ctx:_0xa8fe1b})=>{const _0x44cffc=_0x5ec04b,_0xefdfc5={'XGBuB':function(_0x4e762b,_0x471c54){return _0x4e762b(_0x471c54);},'IycuY':function(_0x270d68,_0x1ee3ad){return _0x270d68!==_0x1ee3ad;},'DmlZe':'UNAUTHORIZED','aGyCA':function(_0x140160,_0x563d45,_0x4bd930){return _0x140160(_0x563d45,_0x4bd930);}};if(_0x580fac[_0x44cffc(0x9a)]){const _0x13e2be=await _0xefdfc5[_0x44cffc(0x8c)](findServerById,_0x580fac[_0x44cffc(0x9a)]);if(_0xefdfc5[_0x44cffc(0x9e)](_0x13e2be['organizationId'],_0xa8fe1b['session']?.[_0x44cffc(0x92)]))throw new TRPCError({'code':_0xefdfc5[_0x44cffc(0xab)]});}return await _0xefdfc5[_0x44cffc(0x7d)](getServiceContainersByAppName,_0x580fac[_0x44cffc(0xa2)],_0x580fac[_0x44cffc(0x9a)]);})});