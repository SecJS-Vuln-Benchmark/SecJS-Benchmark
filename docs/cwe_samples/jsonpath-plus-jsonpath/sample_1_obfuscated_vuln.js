const _0x5b7433=_0x59d3;(function(_0x408d2b,_0x2c863d){const _0x425557=_0x59d3,_0x3de5a9=_0x408d2b();while(!![]){try{const _0x4b3e09=-parseInt(_0x425557(0x13e))/0x1*(-parseInt(_0x425557(0x12a))/0x2)+-parseInt(_0x425557(0x137))/0x3*(parseInt(_0x425557(0x132))/0x4)+-parseInt(_0x425557(0x12e))/0x5*(-parseInt(_0x425557(0x12b))/0x6)+-parseInt(_0x425557(0x135))/0x7*(-parseInt(_0x425557(0x140))/0x8)+parseInt(_0x425557(0x136))/0x9+-parseInt(_0x425557(0x138))/0xa+parseInt(_0x425557(0x12c))/0xb;if(_0x4b3e09===_0x2c863d)break;else _0x3de5a9['push'](_0x3de5a9['shift']());}catch(_0x168d2b){_0x3de5a9['push'](_0x3de5a9['shift']());}}}(_0xc2ab,0xe97d2));import{getApplicationInfo,getNodeApplications,getNodeInfo,getSwarmNodes}from'@dokploy/server';function _0x59d3(_0x27e3ee,_0x2d577d){const _0xc2abb1=_0xc2ab();return _0x59d3=function(_0x59d358,_0x460b5){_0x59d358=_0x59d358-0x128;let _0x1119ec=_0xc2abb1[_0x59d358];return _0x1119ec;},_0x59d3(_0x27e3ee,_0x2d577d);}import{z}from'zod';import{createTRPCRouter,protectedProcedure}from'../trpc';import{TRPCError}from'@trpc/server';import{findServerById}from'@dokploy/server';import{containerIdRegex}from'./docker';function _0xc2ab(){const _0x32a58a=['min','3202752iUKwlS','516879Atxdci','106233EsuxHl','13774100KwwdFW','organizationId','input','regex','UNAUTHORIZED','string','2395BXAlrO','object','8MhEjKA','nodeId','query','1304akckve','4266hsmbtY','6306465rPqTeT','optional','3505THEiiL','session','serverId','activeOrganizationId','92IFjBWb','appName'];_0xc2ab=function(){return _0x32a58a;};return _0xc2ab();}export const swarmRouter=createTRPCRouter({'getNodes':protectedProcedure[_0x5b7433(0x13a)](z[_0x5b7433(0x13f)]({'serverId':z[_0x5b7433(0x13d)]()[_0x5b7433(0x12d)]()}))[_0x5b7433(0x129)](async({input:_0x5bc293,ctx:_0x44d308})=>{const _0x3abbf0=_0x5b7433,_0x2cfe3c={'uiKoU':function(_0x322a33,_0x2ff11d){return _0x322a33(_0x2ff11d);}};if(_0x5bc293['serverId']){const _0x19ba05=await _0x2cfe3c['uiKoU'](findServerById,_0x5bc293['serverId']);if(_0x19ba05[_0x3abbf0(0x139)]!==_0x44d308['session']?.[_0x3abbf0(0x131)])throw new TRPCError({'code':'UNAUTHORIZED'});}return await getSwarmNodes(_0x5bc293[_0x3abbf0(0x130)]);}),'getNodeInfo':protectedProcedure['input'](z['object']({'nodeId':z['string'](),'serverId':z[_0x5b7433(0x13d)]()[_0x5b7433(0x12d)]()}))['query'](async({input:_0xc7a7e1,ctx:_0x4868f1})=>{const _0x590a59=_0x5b7433;if(_0xc7a7e1[_0x590a59(0x130)]){const _0xbf1187=await findServerById(_0xc7a7e1[_0x590a59(0x130)]);if(_0xbf1187[_0x590a59(0x139)]!==_0x4868f1[_0x590a59(0x12f)]?.[_0x590a59(0x131)])throw new TRPCError({'code':_0x590a59(0x13c)});}return await getNodeInfo(_0xc7a7e1[_0x590a59(0x128)],_0xc7a7e1['serverId']);}),'getNodeApps':protectedProcedure[_0x5b7433(0x13a)](z['object']({'serverId':z['string']()[_0x5b7433(0x12d)]()}))[_0x5b7433(0x129)](async({input:_0x3f3f35,ctx:_0x5b3c3c})=>{const _0x2a2bee=_0x5b7433,_0x522c9f={'ietRM':function(_0x5b6305,_0x4ab302){return _0x5b6305(_0x4ab302);}};if(_0x3f3f35[_0x2a2bee(0x130)]){const _0x3c5c0e=await _0x522c9f['ietRM'](findServerById,_0x3f3f35['serverId']);if(_0x3c5c0e[_0x2a2bee(0x139)]!==_0x5b3c3c[_0x2a2bee(0x12f)]?.[_0x2a2bee(0x131)])throw new TRPCError({'code':'UNAUTHORIZED'});}return getNodeApplications(_0x3f3f35[_0x2a2bee(0x130)]);}),'getAppInfos':protectedProcedure[_0x5b7433(0x13a)](z[_0x5b7433(0x13f)]({'appName':z[_0x5b7433(0x13d)]()[_0x5b7433(0x134)](0x1)[_0x5b7433(0x13b)](containerIdRegex,'Invalid\x20app\x20name.'),'serverId':z[_0x5b7433(0x13d)]()['optional']()}))[_0x5b7433(0x129)](async({input:_0x3335be,ctx:_0x1ece2a})=>{const _0x2a0f32=_0x5b7433;if(_0x3335be[_0x2a0f32(0x130)]){const _0x2bebe1=await findServerById(_0x3335be[_0x2a0f32(0x130)]);if(_0x2bebe1[_0x2a0f32(0x139)]!==_0x1ece2a['session']?.[_0x2a0f32(0x131)])throw new TRPCError({'code':_0x2a0f32(0x13c)});}return await getApplicationInfo(_0x3335be[_0x2a0f32(0x133)],_0x3335be[_0x2a0f32(0x130)]);})});