'use strict';const _0x46fbc5=_0x1e62;function _0x1e62(_0x35e4c7,_0x4ebbdb){const _0x2e6116=_0x2e61();return _0x1e62=function(_0x1e629f,_0x411bcf){_0x1e629f=_0x1e629f-0x1c6;let _0xa100a6=_0x2e6116[_0x1e629f];return _0xa100a6;},_0x1e62(_0x35e4c7,_0x4ebbdb);}function _0x2e61(){const _0x4af3b8=['TrJYv','toBe','604ieCSnP','regExp','contentType','clearAllMocks','unique-uid','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','77364jCMhnx','UID\x20validator','8BZrNAs','wrongly\x5cformated||UID','479976tPuqtC','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','unchanged-unique-uid','nullable','properly.formated-uid','it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','RONOy','lnHKs','mockResolvedValueOnce','QKrAq','loOUo','NaQOf','605214uKrzWg','1735820HrPDvL','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','dnXSK','it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database','it\x20fails\x20to\x20validate\x20the\x20uid\x20if\x20it\x20does\x20not\x20fit\x20the\x20requried\x20format','toHaveBeenCalledWith','../validators','assertions','11VxcbgK','LyNgf','mockReset','other-uid','3015BsdJqm','5rkoPau','non-unique-uid','CLglc','attrUidUnique','uid','test-uid','209268JEHQMJ','validateYupSchema','3929uFZyZG','@strapi/utils','kSmte','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','HqMoe','test-model','toBeInstanceOf','56rhqvUW','GqgBC','unique'];_0x2e61=function(){return _0x4af3b8;};return _0x2e61();}(function(_0x22895e,_0x26bbc5){const _0x3fbe78=_0x1e62,_0x1def6c=_0x22895e();while(!![]){try{const _0x4753dd=parseInt(_0x3fbe78(0x1f7))/0x1*(parseInt(_0x3fbe78(0x1c6))/0x2)+-parseInt(_0x3fbe78(0x1ee))/0x3*(-parseInt(_0x3fbe78(0x1cb))/0x4)+parseInt(_0x3fbe78(0x1ef))/0x5*(parseInt(_0x3fbe78(0x1e1))/0x6)+parseInt(_0x3fbe78(0x1d5))/0x7*(-parseInt(_0x3fbe78(0x1d3))/0x8)+parseInt(_0x3fbe78(0x1d1))/0x9+-parseInt(_0x3fbe78(0x1e2))/0xa+parseInt(_0x3fbe78(0x1ea))/0xb*(-parseInt(_0x3fbe78(0x1f5))/0xc);if(_0x4753dd===_0x26bbc5)break;else _0x1def6c['push'](_0x1def6c['shift']());}catch(_0x43e757){_0x1def6c['push'](_0x1def6c['shift']());}}}(_0x2e61,0x1b41b));const strapiUtils=require('@strapi/utils'),{errors:{YupValidationError}}=require(_0x46fbc5(0x1f8)),validators=require(_0x46fbc5(0x1e8));describe(_0x46fbc5(0x1d2),()=>{const _0x2631da=_0x46fbc5,_0x41b8b3={'LyNgf':_0x2631da(0x1f2),'HqMoe':_0x2631da(0x1f0),'loOUo':function(_0x11dd87,_0x2c6972){return _0x11dd87(_0x2c6972);},'lnHKs':_0x2631da(0x1f3),'TrJYv':'unique-uid','NaQOf':_0x2631da(0x1d7),'RONOy':function(_0x510d5c,_0x3e0ad6){return _0x510d5c(_0x3e0ad6);},'QKrAq':_0x2631da(0x1e5),'GqgBC':function(_0x1d9cea,_0x50a81b,_0x437fc6){return _0x1d9cea(_0x50a81b,_0x437fc6);},'CLglc':_0x2631da(0x1e3),'dnXSK':'properly.formated-uid','zrrqu':function(_0x57b1ae,_0x5bd77a,_0x212a4b){return _0x57b1ae(_0x5bd77a,_0x212a4b);},'ITWhM':'it\x20validate\x20the\x20uid\x20if\x20it\x20fit\x20the\x20required\x20format','kSmte':_0x2631da(0x1cc)},_0x19b392=jest['fn']();global['strapi']={'db':{'query':jest['fn'](()=>({'findOne':_0x19b392}))}},afterEach(()=>{const _0x47f6fb=_0x2631da;jest[_0x47f6fb(0x1ce)](),_0x19b392[_0x47f6fb(0x1ec)]();});const _0x26a7a3={'kind':_0x2631da(0x1cd),'modelName':_0x2631da(0x1fc),'uid':_0x2631da(0x1f4),'privateAttributes':[],'options':{},'attributes':{'attrUidUnique':{'type':_0x41b8b3[_0x2631da(0x1dc)]}}};describe(_0x2631da(0x1c8),()=>{const _0x578956=_0x2631da;test(_0x41b8b3[_0x578956(0x1de)],async()=>{const _0x38631c=_0x578956;_0x19b392[_0x38631c(0x1dd)](null);const _0x5d602a=strapiUtils[_0x38631c(0x1f6)](validators[_0x38631c(0x1f3)]({'attr':{'type':_0x38631c(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x41b8b3[_0x38631c(0x1eb)],'value':_0x38631c(0x1f0)},'entity':null},{'isDraft':![]}));expect(await _0x5d602a(_0x41b8b3[_0x38631c(0x1fb)]))['toBe'](_0x41b8b3[_0x38631c(0x1fb)]);}),_0x41b8b3[_0x578956(0x1c7)](test,_0x41b8b3[_0x578956(0x1f1)],async()=>{const _0x5cde1d=_0x578956;_0x19b392['mockResolvedValueOnce'](null);const _0x1cc876=strapiUtils[_0x5cde1d(0x1f6)](validators[_0x5cde1d(0x1f3)]({'attr':{'type':_0x5cde1d(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':'attrUidUnique','value':null},'entity':null},{'isDraft':![]})[_0x5cde1d(0x1d8)]());await _0x41b8b3[_0x5cde1d(0x1df)](_0x1cc876,null),_0x41b8b3[_0x5cde1d(0x1df)](expect,_0x19b392)['not']['toHaveBeenCalled']();}),test('it\x20always\x20validates\x20the\x20unique\x20constraint\x20even\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique',async()=>{const _0x2cb301=_0x578956;_0x19b392[_0x2cb301(0x1dd)](null);const _0x5672fc=strapiUtils[_0x2cb301(0x1f6)](validators[_0x2cb301(0x1f3)]({'attr':{'type':_0x41b8b3['lnHKs']},'model':_0x26a7a3,'updatedAttribute':{'name':_0x41b8b3[_0x2cb301(0x1eb)],'value':_0x2cb301(0x1f0)},'entity':null},{'isDraft':![]}));expect(await _0x5672fc(_0x41b8b3[_0x2cb301(0x1fb)]))[_0x2cb301(0x1ca)](_0x41b8b3[_0x2cb301(0x1fb)]),_0x41b8b3[_0x2cb301(0x1df)](expect,_0x19b392)[_0x2cb301(0x1e7)]({'select':['id'],'where':{'attrUidUnique':_0x41b8b3[_0x2cb301(0x1fb)]}});}),test(_0x578956(0x1da),async()=>{const _0x4fc7df=_0x578956;expect[_0x4fc7df(0x1e9)](0x1),_0x19b392[_0x4fc7df(0x1dd)]({'attrUidUnique':_0x41b8b3[_0x4fc7df(0x1c9)]});const _0x120455=strapiUtils[_0x4fc7df(0x1f6)](validators[_0x4fc7df(0x1f3)]({'attr':{'type':_0x4fc7df(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x4fc7df(0x1f2),'value':_0x4fc7df(0x1cf)},'entity':null},{'isDraft':![]}));try{await _0x41b8b3[_0x4fc7df(0x1df)](_0x120455,_0x4fc7df(0x1cf));}catch(_0x16b70e){expect(_0x16b70e)[_0x4fc7df(0x1fd)](YupValidationError);}}),test(_0x578956(0x1d0),async()=>{const _0x412a54=_0x578956;_0x19b392['mockResolvedValueOnce']({'attrUidUnique':_0x41b8b3[_0x412a54(0x1e0)]});const _0x3e366d=strapiUtils[_0x412a54(0x1f6)](validators[_0x412a54(0x1f3)]({'attr':{'type':_0x412a54(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x41b8b3['LyNgf'],'value':_0x412a54(0x1d7)},'entity':{'id':0x1,'attrUidUnique':_0x412a54(0x1d7)}},{'isDraft':![]}));expect(await _0x3e366d(_0x41b8b3[_0x412a54(0x1e0)]))['toBe'](_0x412a54(0x1d7));}),test(_0x578956(0x1fa),async()=>{const _0x1c2c06=_0x578956;_0x19b392[_0x1c2c06(0x1dd)](null);const _0xd0df17=strapiUtils[_0x1c2c06(0x1f6)](validators[_0x1c2c06(0x1f3)]({'attr':{'type':_0x1c2c06(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x41b8b3[_0x1c2c06(0x1eb)],'value':_0x41b8b3['TrJYv']},'entity':null},{'isDraft':![]}));await _0xd0df17(_0x1c2c06(0x1cf)),_0x41b8b3[_0x1c2c06(0x1db)](expect,_0x19b392)[_0x1c2c06(0x1e7)]({'select':['id'],'where':{'attrUidUnique':_0x41b8b3[_0x1c2c06(0x1c9)]}});}),_0x41b8b3[_0x578956(0x1c7)](test,_0x578956(0x1d6),async()=>{const _0x4e2476=_0x578956;_0x19b392[_0x4e2476(0x1dd)](null);const _0x212134=strapiUtils[_0x4e2476(0x1f6)](validators[_0x4e2476(0x1f3)]({'attr':{'type':_0x4e2476(0x1f3),'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x4e2476(0x1f2),'value':_0x4e2476(0x1cf)},'entity':{'id':0x1,'attrUidUnique':_0x4e2476(0x1ed)}},{'isDraft':![]}));await _0x212134(_0x4e2476(0x1cf)),expect(_0x19b392)['toHaveBeenCalledWith']({'select':['id'],'where':{'$and':[{'attrUidUnique':_0x4e2476(0x1cf)},{'$not':{'id':0x1}}]}});});}),_0x41b8b3[_0x2631da(0x1c7)](describe,_0x41b8b3[_0x2631da(0x1f9)],()=>{const _0x41ee32=_0x2631da;_0x41b8b3['zrrqu'](test,_0x41ee32(0x1e6),async()=>{const _0x5cc8aa=_0x41ee32;expect[_0x5cc8aa(0x1e9)](0x1),_0x19b392[_0x5cc8aa(0x1dd)](null);const _0x8d7a0d=strapiUtils['validateYupSchema'](validators[_0x5cc8aa(0x1f3)]({'attr':{'type':'uid','unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x5cc8aa(0x1f2),'value':_0x41b8b3['HqMoe']},'entity':null},{'isDraft':![]}));try{await _0x41b8b3[_0x5cc8aa(0x1db)](_0x8d7a0d,_0x5cc8aa(0x1d4));}catch(_0x5303fb){_0x41b8b3[_0x5cc8aa(0x1df)](expect,_0x5303fb)[_0x5cc8aa(0x1fd)](YupValidationError);}}),test(_0x41b8b3['ITWhM'],async()=>{const _0xd7fe15=_0x41ee32;_0x19b392['mockResolvedValueOnce'](null);const _0x1389b1=strapiUtils['validateYupSchema'](validators[_0xd7fe15(0x1f3)]({'attr':{'type':_0x41b8b3[_0xd7fe15(0x1dc)],'unique':!![]},'model':_0x26a7a3,'updatedAttribute':{'name':_0x41b8b3[_0xd7fe15(0x1eb)],'value':_0x41b8b3[_0xd7fe15(0x1fb)]},'entity':null},{'isDraft':![]}));expect(await _0x1389b1(_0x41b8b3[_0xd7fe15(0x1e4)]))[_0xd7fe15(0x1ca)](_0xd7fe15(0x1d9));});});});