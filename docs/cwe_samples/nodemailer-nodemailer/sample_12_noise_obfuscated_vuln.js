'use strict';const _0x1f80dd=_0x40dd;function _0x40dd(_0x40a6fc,_0x2c448a){const _0x118cd6=_0x118c();return _0x40dd=function(_0x40ddd7,_0x3bf964){_0x40ddd7=_0x40ddd7-0x158;let _0xc7f9e7=_0x118cd6[_0x40ddd7];return _0xc7f9e7;},_0x40dd(_0x40a6fc,_0x2c448a);}(function(_0xe0f7ba,_0x1cdf9a){const _0x198dcc=_0x40dd,_0x254bb9=_0xe0f7ba();while(!![]){try{const _0x4c1c3d=parseInt(_0x198dcc(0x18a))/0x1*(-parseInt(_0x198dcc(0x180))/0x2)+-parseInt(_0x198dcc(0x168))/0x3+parseInt(_0x198dcc(0x199))/0x4+-parseInt(_0x198dcc(0x176))/0x5+parseInt(_0x198dcc(0x15b))/0x6+parseInt(_0x198dcc(0x165))/0x7*(parseInt(_0x198dcc(0x196))/0x8)+parseInt(_0x198dcc(0x18f))/0x9;if(_0x4c1c3d===_0x1cdf9a)break;else _0x254bb9['push'](_0x254bb9['shift']());}catch(_0x142659){_0x254bb9['push'](_0x254bb9['shift']());}}}(_0x118c,0xd5dce));function _0x118c(){const _0x3d3494=['yellow','readMessageHeader','3388041MfpetY','HEL','../lib/misc/message_header','connect','connected','node-opcua','Usage:\x20$0\x20--portServer\x20[num]\x20--port\x20[num]\x20\x20--hostname\x20<hostname>\x20-block','280yAUgsa','qZvBc','IrbsM','4232720mIOzqL','net','write','ERROR\x20:\x20','feed','block','hexDump','WbnCk','oINam','usage','PsjkH','4168284XhGujj','messageHeaderToString','MSG','chalk','end','decode','FJZcn','OPN','node-opcua-utils','\x20client\x20->\x20server\x20:\x20packet\x20length\x20','130683ofRJwP','KaBkQ','listen','4599996TorPgE','reason','red','msgType','dDgtp','localhost','Txglv','yargs','JrMNv','BinaryStream','\x20registering\x20OPCUA\x20server\x20on\x20port\x20','length','\x20reason:','hostname','1472350SNEZOl','full_message_body','add','\x20server\x20->\x20client\x20:\x20packet\x20length\x20','lqjYx','portServer','hPeXc','stringify','prototype','../lib/misc/analyzePacket','4AhBnBq','CLO','../lib/misc/message_builder','kwUYe','qCPqY','HGWrK','console.log(\x22timer\x22);','bold','MessageBuilder','\x20Error\x200x','39487DlSCHM','oXwgz','log'];_0x118c=function(){return _0x3d3494;};return _0x118c();}const net=require(_0x1f80dd(0x19a)),chalk=require(_0x1f80dd(0x15e)),argv=require(_0x1f80dd(0x16f))[_0x1f80dd(0x159)](_0x1f80dd(0x195))['argv'],opcua=require(_0x1f80dd(0x194)),hexDump=require(_0x1f80dd(0x163))[_0x1f80dd(0x19f)],MessageBuilder=require(_0x1f80dd(0x182))[_0x1f80dd(0x188)],BinaryStream=require('../lib/misc/binaryStream')[_0x1f80dd(0x171)],analyseExtensionObject=require(_0x1f80dd(0x17f))['analyseExtensionObject'],messageHeaderToString=require(_0x1f80dd(0x191))[_0x1f80dd(0x15c)],s=require('../lib/datamodel/structures'),remote_port=parseInt(argv['port'],0xa)||0x12e9,hostname=argv[_0x1f80dd(0x175)]||_0x1f80dd(0x16d),my_port=parseInt(argv[_0x1f80dd(0x17b)],0xa)||remote_port+0x1,TrafficAnalyser=function(_0x3e1b33){this['id']=_0x3e1b33;};TrafficAnalyser[_0x1f80dd(0x17e)][_0x1f80dd(0x178)]=function(_0x1952d1){const _0x3e04f6=_0x1f80dd,_0x1a1197={'IrbsM':function(_0x29d275,_0x571f30){return _0x29d275(_0x571f30);},'KaBkQ':function(_0x3b4a02,_0x35e68b){return _0x3b4a02+_0x35e68b;},'hPeXc':_0x3e04f6(0x174),'qCPqY':_0x3e04f6(0x190),'KypOe':'ACK','lqjYx':_0x3e04f6(0x170),'CaRYD':_0x3e04f6(0x162),'WbnCk':_0x3e04f6(0x15d),'PsjkH':function(_0x19bd46,_0x6f78bc){return _0x19bd46%_0x6f78bc;},'qZvBc':'ERR'},_0x7cd123=new BinaryStream(_0x1952d1);if(argv[_0x3e04f6(0x19e)]){console['log'](hexDump(_0x1952d1)),setTimeout(_0x3e04f6(0x186),0x3e8);return;}const _0x31c3b6=opcua[_0x3e04f6(0x18e)](_0x7cd123);if(_0x31c3b6['msgType']==='ERR'){const _0x38caef=new s['TCPErrorMessage']();_0x38caef[_0x3e04f6(0x160)](_0x7cd123),console['log'](_0x1a1197[_0x3e04f6(0x166)](_0x3e04f6(0x189)+_0x38caef['statusCode']['toString']()+_0x1a1197[_0x3e04f6(0x17c)],_0x38caef[_0x3e04f6(0x169)])),console[_0x3e04f6(0x18c)](hexDump(_0x1952d1));}const _0x172118=new MessageBuilder();_0x172118['on'](_0x3e04f6(0x177),function(_0x510485){const _0x4d3484=_0x3e04f6;console[_0x4d3484(0x18c)](_0x1a1197[_0x4d3484(0x198)](hexDump,_0x510485));try{analyseExtensionObject(_0x510485);}catch(_0x482c3b){console[_0x4d3484(0x18c)](chalk[_0x4d3484(0x16a)](_0x4d3484(0x19c)),_0x482c3b);}});switch(_0x31c3b6[_0x3e04f6(0x16b)]){case _0x1a1197[_0x3e04f6(0x184)]:case _0x1a1197['KypOe']:this['id']%0x2?_0x3e04f6(0x170)!==_0x1a1197[_0x3e04f6(0x17a)]?_0x4da6e3[_0x3e04f6(0x19b)](_0x5a4e04):console['log'](chalk[_0x3e04f6(0x16a)][_0x3e04f6(0x187)](JSON[_0x3e04f6(0x17d)](_0x31c3b6,null,''))):_0x3e04f6(0x158)!==_0x3e04f6(0x158)?_0x4cd2f6[_0x3e04f6(0x18c)](_0x5bee71[_0x3e04f6(0x16a)]['bold'](_0x610c0c(_0xcbc5b5))):console['log'](chalk['yellow'][_0x3e04f6(0x187)](JSON[_0x3e04f6(0x17d)](_0x31c3b6,null,'')));break;case _0x1a1197['CaRYD']:case _0x3e04f6(0x181):case _0x1a1197[_0x3e04f6(0x1a0)]:_0x1a1197[_0x3e04f6(0x15a)](this['id'],0x2)?console[_0x3e04f6(0x18c)](chalk['red']['bold'](_0x1a1197[_0x3e04f6(0x198)](messageHeaderToString,_0x1952d1))):console[_0x3e04f6(0x18c)](chalk[_0x3e04f6(0x18d)]['bold'](messageHeaderToString(_0x1952d1)));_0x172118[_0x3e04f6(0x19d)](_0x1952d1);break;case _0x1a1197[_0x3e04f6(0x197)]:console['log'](hexDump(_0x1952d1));break;default:break;}},require(_0x1f80dd(0x19a))['createServer'](function(_0x143d84){const _0x5d4b87=_0x1f80dd,_0x119748={'HGWrK':_0x5d4b87(0x179),'Txglv':function(_0x2ed0ae,_0x307f10){return _0x2ed0ae+_0x307f10;},'iHxwJ':_0x5d4b87(0x164),'oXwgz':'server\x20disconnected\x20(CLOSE)','kwUYe':_0x5d4b87(0x193),'FJZcn':'data','dDgtp':'end'};console['log'](_0x119748[_0x5d4b87(0x183)]);const _0x204301=new TrafficAnalyser(0x1),_0x4090c0=new TrafficAnalyser(0x2),_0x2c86d2=new net['Socket']();_0x2c86d2[_0x5d4b87(0x192)](remote_port,hostname),_0x2c86d2['on'](_0x119748[_0x5d4b87(0x161)],function(_0x1020c1){const _0x5e0cf6=_0x5d4b87;console[_0x5e0cf6(0x18c)](_0x119748[_0x5e0cf6(0x185)]+_0x1020c1[_0x5e0cf6(0x173)]),_0x4090c0[_0x5e0cf6(0x178)](_0x1020c1);try{_0x143d84['write'](_0x1020c1);}catch(_0x5731c1){}}),_0x143d84['on']('data',function(_0x558c3a){const _0x2f0358=_0x5d4b87;console['log'](_0x119748[_0x2f0358(0x16e)](_0x119748['iHxwJ'],_0x558c3a['length'])),_0x204301['add'](_0x558c3a),_0x2c86d2[_0x2f0358(0x19b)](_0x558c3a);}),_0x143d84['on']('close',function(){const _0x23f0a7=_0x5d4b87;console[_0x23f0a7(0x18c)](_0x119748[_0x23f0a7(0x18b)]),_0x2c86d2[_0x23f0a7(0x15f)]();}),_0x143d84['on'](_0x119748[_0x5d4b87(0x16c)],function(){console['log']('server\x20disconnected\x20(END)');});})[_0x1f80dd(0x167)](my_port),console[_0x1f80dd(0x18c)](_0x1f80dd(0x172)+my_port),console[_0x1f80dd(0x18c)]('\x20\x20+->\x20redirecting\x20conversation\x20to\x20server\x20port\x20'+remote_port);