const _0x26bfaf=_0x40e4;(function(_0x3e3755,_0x4de2cf){const _0x5c8bbb=_0x40e4,_0x5201f6=_0x3e3755();while(!![]){try{const _0xe7e450=parseInt(_0x5c8bbb(0x195))/0x1*(-parseInt(_0x5c8bbb(0x19b))/0x2)+parseInt(_0x5c8bbb(0x1cb))/0x3+-parseInt(_0x5c8bbb(0x159))/0x4*(-parseInt(_0x5c8bbb(0x169))/0x5)+-parseInt(_0x5c8bbb(0x1bc))/0x6*(parseInt(_0x5c8bbb(0x153))/0x7)+parseInt(_0x5c8bbb(0x1ad))/0x8+parseInt(_0x5c8bbb(0x17e))/0x9*(parseInt(_0x5c8bbb(0x1a7))/0xa)+-parseInt(_0x5c8bbb(0x1be))/0xb;if(_0xe7e450===_0x4de2cf)break;else _0x5201f6['push'](_0x5201f6['shift']());}catch(_0x19d9fc){_0x5201f6['push'](_0x5201f6['shift']());}}}(_0x5aa6,0x644d3));function _0x40e4(_0x13c82a,_0x852eb6){const _0x5aa6c6=_0x5aa6();return _0x40e4=function(_0x40e4e7,_0x582bf7){_0x40e4e7=_0x40e4e7-0x138;let _0xa689da=_0x5aa6c6[_0x40e4e7];return _0xa689da;},_0x40e4(_0x13c82a,_0x852eb6);}const should=require(_0x26bfaf(0x13d)),{StatusCodes}=require(_0x26bfaf(0x1c5)),{HelloMessage}=require('node-opcua-transport'),{OpenSecureChannelRequest,SecurityTokenRequestType,ReadRequest}=require(_0x26bfaf(0x145)),{hexDump}=require('node-opcua-crypto'),debugLog=require(_0x26bfaf(0x1dd))[_0x26bfaf(0x171)](__filename),{DirectTransport}=require(_0x26bfaf(0x18f)),{GetEndpointsResponse}=require(_0x26bfaf(0x18b)),fixtures=require('node-opcua-transport/dist/test-fixtures'),{BinaryStream}=require(_0x26bfaf(0x13a)),{ServerSecureChannelLayer,MessageSecurityMode,SecurityPolicy,MessageChunker}=require('..'),{pause}=require(_0x26bfaf(0x18e)),describe=require(_0x26bfaf(0x14a))[_0x26bfaf(0x15f)];describe(_0x26bfaf(0x1c6),function(){const _0x43785a=_0x26bfaf,_0x47462f={'nUxdz':_0x43785a(0x188),'IaCUN':_0x43785a(0x1e7),'xmwdo':_0x43785a(0x1c2),'oxNHI':function(_0x20d752,_0x4294a7){return _0x20d752!==_0x4294a7;},'IsUQg':'BpUqC','VbcHB':_0x43785a(0x1b5),'iaudW':_0x43785a(0x170),'vRKHf':_0x43785a(0x16f),'jKaUQ':_0x43785a(0x1ec),'qvXdn':_0x43785a(0x1b2),'yGEnC':'writing\x20fake_GetEndpointsRequest','jjgVH':function(_0x15733e,_0x5ab20a){return _0x15733e(_0x5ab20a);},'hwQSL':function(_0x1d03ac,_0x40cb40){return _0x1d03ac!==_0x40cb40;},'GiODF':_0x43785a(0x1a8),'oKAUF':function(_0x48ddd1,_0x42d2ea,_0xfda637){return _0x48ddd1(_0x42d2ea,_0xfda637);},'MbEXf':'HPtun','QriIe':_0x43785a(0x143),'izDCD':_0x43785a(0x1e1),'ywmKI':function(_0x3dfe46){return _0x3dfe46();},'WBfGE':function(_0x263bc4,_0x30917a,_0x5d4803){return _0x263bc4(_0x30917a,_0x5d4803);},'wXJXe':function(_0x4d9c01,_0x2dab66){return _0x4d9c01+_0x2dab66;},'YHxLp':_0x43785a(0x1b7),'KRcJa':function(_0x300570,_0x429945){return _0x300570*_0x429945;},'lkCNy':_0x43785a(0x16c),'IlmRW':_0x43785a(0x1b0),'etDVx':_0x43785a(0x172),'UTmkp':_0x43785a(0x1a9),'IooMU':_0x43785a(0x163),'Sqhpp':'OPN','sWFFO':function(_0x238e84){return _0x238e84();},'WqtwE':function(_0xe95ba8,_0x50d293,_0x5eaeed){return _0xe95ba8(_0x50d293,_0x5eaeed);},'kMLCl':_0x43785a(0x1e4),'ekGVT':function(_0x42da01,_0x5f3a8d,_0x557ccb){return _0x42da01(_0x5f3a8d,_0x557ccb);},'MTHez':function(_0x5ba12e,_0x46bdec){return _0x5ba12e(_0x46bdec);},'HRJil':_0x43785a(0x1cd),'yeoBO':'KK4\x20should\x20return\x20an\x20error\x20and\x20shutdown\x20if\x20first\x20message\x20is\x20not\x20OpenSecureChannelRequest\x20','ILhxX':function(_0x20d14e,_0x22c91c,_0x2c6acc){return _0x20d14e(_0x22c91c,_0x2c6acc);},'kmkIC':'KK5\x20should\x20handle\x20a\x20OpenSecureChannelRequest\x20and\x20pass\x20no\x20err\x20in\x20the\x20init\x20callback\x20','Aalbv':_0x43785a(0x161),'gyvBB':_0x43785a(0x152),'hAQYI':function(_0x49a637,_0x2e1ecc,_0x37b71e){return _0x49a637(_0x2e1ecc,_0x37b71e);},'piXoM':function(_0x292ec9,_0x335cac,_0x2cebeb){return _0x292ec9(_0x335cac,_0x2cebeb);},'QcOAO':_0x43785a(0x1a6),'AKvWy':_0x43785a(0x192)};this['timeout'](0x2710),_0x47462f[_0x43785a(0x17d)](it,_0x47462f['kMLCl'],()=>{const _0x3338c2=_0x43785a;if(_0x47462f['nUxdz']!==_0x47462f[_0x3338c2(0x19e)]){const {helloMessage1:_0xe7e08a,getEndpointsRequest1:_0x487625}=_0x33dc27;_0x361f80([_0xe7e08a,_0x487625],_0x385772);}else{let _0x5c41e=new ServerSecureChannelLayer({});_0x5c41e[_0x3338c2(0x140)](MessageSecurityMode['None'],SecurityPolicy[_0x3338c2(0x197)]),_0x5c41e[_0x3338c2(0x1a2)][_0x3338c2(0x13d)]['be'][_0x3338c2(0x162)](0x64),_0x5c41e[_0x3338c2(0x14f)]();}}),_0x47462f[_0x43785a(0x142)](it,_0x43785a(0x15c),function(_0xf11496){const _0x11ccc4=_0x43785a,_0x413040=new DirectTransport(),_0x294617=new ServerSecureChannelLayer({'timeout':0x32});_0x294617[_0x11ccc4(0x140)](MessageSecurityMode[_0x11ccc4(0x197)],SecurityPolicy[_0x11ccc4(0x197)]),_0x294617[_0x11ccc4(0x1a2)]=0x32,_0x294617[_0x11ccc4(0x17a)](_0x413040[_0x11ccc4(0x17b)],_0x522fb6=>{const _0xcf5078=_0x11ccc4;_0x522fb6['message'][_0xcf5078(0x13d)][_0xcf5078(0x1ab)](/Timeout/),_0x294617[_0xcf5078(0x14f)](),_0xf11496();}),_0x294617['on'](_0x47462f['IaCUN'],()=>{const _0x5b852f=_0x11ccc4;console['log'](_0x5b852f(0x1d2));});}),it(_0x43785a(0x173),function(_0x5db30f){const _0x315bd4=_0x43785a,_0x3d94e3={'qJQjl':_0x315bd4(0x178)},_0xb116a=new DirectTransport();let _0x2bb0dc=![];const _0x31f1a7=new ServerSecureChannelLayer({});_0x31f1a7[_0x315bd4(0x140)](MessageSecurityMode[_0x315bd4(0x197)],SecurityPolicy['None']),_0x31f1a7['timeout']=0x32,_0x31f1a7[_0x315bd4(0x17a)](_0xb116a[_0x315bd4(0x17b)],_0x320551=>{const _0x14c16b=_0x315bd4;_0x3d94e3['qJQjl']===_0x14c16b(0x160)?(_0x30324f[_0x14c16b(0x143)][_0x14c16b(0x13d)][_0x14c16b(0x1ab)](/Timeout/),_0x396bc3['dispose'](),_0x1e3c9e()):(_0x320551[_0x14c16b(0x143)][_0x14c16b(0x13d)][_0x14c16b(0x1ab)](/Timeout waiting for OpenChannelRequest/),_0x2bb0dc[_0x14c16b(0x13d)][_0x14c16b(0x198)](!![]),_0x31f1a7[_0x14c16b(0x14f)](),_0x5db30f());}),_0x31f1a7['on'](_0x315bd4(0x1e7),()=>{_0x2bb0dc=!![];});const {helloMessage1:_0x5eae63}=require(_0x47462f[_0x315bd4(0x16d)]);_0xb116a[_0x315bd4(0x1ac)][_0x315bd4(0x151)](_0x5eae63);}),_0x47462f[_0x43785a(0x164)](Function,_0x47462f[_0x43785a(0x13f)])(),it(_0x47462f[_0x43785a(0x1e3)],function(_0x35ee64){const _0xf40a7d=_0x43785a,_0x42ef27={'lOuUg':function(_0x409ee8,_0x5f2534){return _0x409ee8===_0x5f2534;},'EDezR':_0xf40a7d(0x1e8)},_0x5ca961=new DirectTransport();let _0x5568a6=![],_0x28a3be=new ServerSecureChannelLayer({});_0x28a3be[_0xf40a7d(0x140)](MessageSecurityMode['None'],SecurityPolicy[_0xf40a7d(0x197)]),_0x28a3be[_0xf40a7d(0x1a2)]=0x3e8,_0x28a3be[_0xf40a7d(0x17a)](_0x5ca961[_0xf40a7d(0x17b)],_0x3ebc12=>{const _0x458c14=_0xf40a7d;_0x3ebc12['message'][_0x458c14(0x13d)][_0x458c14(0x1ab)](/Expecting OpenSecureChannelRequest/),_0x28a3be['close'](()=>{const _0x1c780a=_0x458c14;_0x28a3be[_0x1c780a(0x14f)](),_0x28a3be=null,_0x5568a6[_0x1c780a(0x13d)]['equal'](!![]),_0x35ee64();});}),_0x28a3be['on']('abort',()=>{const _0x4a596f=_0xf40a7d,_0x2da991={'tMeOt':function(_0x2da5b7,_0x397f42){return _0x2da5b7(_0x397f42);}};_0x42ef27['lOuUg'](_0x4a596f(0x1e8),_0x42ef27['EDezR'])?_0x5568a6=!![]:(_0x33ffe8[_0x4a596f(0x1e5)][_0x4a596f(0x1ca)][_0x4a596f(0x1db)]['should'][_0x4a596f(0x150)](_0x4a596f(0x16f)),_0x2da991[_0x4a596f(0x144)](_0xfb67b,()=>{_0x3b2577['close'](()=>{_0x785256['dispose'](),_0x54f992();});}));});const {helloMessage1:_0x816a56}=fixtures;_0x5ca961[_0xf40a7d(0x1ac)][_0xf40a7d(0x151)](_0x816a56);const {getEndpointsRequest1:_0x5277f2}=fixtures;_0x5ca961[_0xf40a7d(0x1ac)][_0xf40a7d(0x151)](_0x5277f2);}),_0x47462f[_0x43785a(0x1ce)](it,_0x47462f[_0x43785a(0x175)],function(_0x19a756){const _0x204515=_0x43785a,_0x389fd4=new DirectTransport();let _0x3d3e9d=new ServerSecureChannelLayer({});_0x3d3e9d[_0x204515(0x140)](MessageSecurityMode['None'],SecurityPolicy[_0x204515(0x197)]),_0x3d3e9d[_0x204515(0x1a2)]=0x32,_0x3d3e9d['init'](_0x389fd4[_0x204515(0x17b)],_0x5701bd=>{const _0x19a7ba=_0x204515;should[_0x19a7ba(0x146)]['exist'](_0x5701bd),_0x3d3e9d[_0x19a7ba(0x138)](()=>{_0x3d3e9d['dispose'](),_0x19a756();});});const {helloMessage1:_0x3b9588}=fixtures;_0x389fd4[_0x204515(0x1ac)]['write'](_0x3b9588);const {openChannelRequest1:_0x505380}=fixtures;_0x389fd4[_0x204515(0x1ac)]['write'](_0x505380);}),_0x47462f[_0x43785a(0x17d)](it,_0x43785a(0x15e),function(_0x1e1273){const _0x83e289=_0x43785a,_0x26b4d3=new DirectTransport(),_0x146734=new ServerSecureChannelLayer({});_0x146734['setSecurity'](MessageSecurityMode[_0x83e289(0x197)],SecurityPolicy[_0x83e289(0x197)]),_0x146734[_0x83e289(0x1a2)]=0x32,_0x146734['channelId']=0x8,_0x146734[_0x83e289(0x17a)](_0x26b4d3['server'],_0x1c4ef2=>{const _0x179073=_0x83e289,_0x272fe5={'xSqRZ':function(_0x4700e8,_0x11eb9c){const _0x3022e3=_0x40e4;return _0x47462f[_0x3022e3(0x17f)](_0x4700e8,_0x11eb9c);},'EOMBF':'Dunhk'};_0x47462f[_0x179073(0x1df)]===_0x47462f[_0x179073(0x1d8)]?_0x3e51b2[_0x179073(0x138)](()=>{const _0x3ba93f=_0x179073;_0x4ac796[_0x3ba93f(0x14f)](),_0x29e42b();}):(should[_0x179073(0x146)]['exist'](_0x1c4ef2),setImmediate(()=>{const _0xcb269c=_0x179073;if(_0x272fe5[_0xcb269c(0x177)](_0xcb269c(0x13c),_0x272fe5[_0xcb269c(0x1bb)]))_0xfa8ed5&&(_0x11337c=_0x901b66(_0x579e51)),_0x19ee70['log'](_0xcb269c(0x158)+_0x28e741(_0x374688)),_0x4c1ed0['client'][_0xcb269c(0x151)](_0x166834);else{const {getEndpointsRequest1:_0x4a9548}=fixtures;_0x4a9548[_0xcb269c(0x141)](_0x146734[_0xcb269c(0x1b9)],0x8),_0x26b4d3[_0xcb269c(0x1ac)][_0xcb269c(0x151)](_0x4a9548);}}));}),_0x146734['on'](_0x83e289(0x143),_0x513850=>{const _0x349392=_0x83e289;_0x513850[_0x349392(0x1e5)][_0x349392(0x1ca)][_0x349392(0x1db)]['should'][_0x349392(0x150)](_0x349392(0x16f)),setImmediate(()=>{_0x146734['close'](()=>{const _0x4c72db=_0x40e4;_0x146734[_0x4c72db(0x14f)](),_0x1e1273();});});});const {helloMessage1:_0x50528b}=fixtures;_0x26b4d3[_0x83e289(0x1ac)][_0x83e289(0x151)](_0x50528b);const {openChannelRequest1:_0x5beee8}=fixtures;_0x26b4d3['client'][_0x83e289(0x151)](_0x5beee8);}),it(_0x47462f[_0x43785a(0x165)],async()=>{const _0x4e0079=_0x43785a,_0x6ccc5c={'lnHNa':_0x4e0079(0x1e7)},_0x43313c=new DirectTransport();let _0x3f2a27=new ServerSecureChannelLayer({});_0x3f2a27[_0x4e0079(0x140)](MessageSecurityMode[_0x4e0079(0x197)],SecurityPolicy[_0x4e0079(0x197)]),_0x3f2a27[_0x4e0079(0x1a2)]=0x32,_0x3f2a27[_0x4e0079(0x17a)](_0x43313c[_0x4e0079(0x17b)],_0x13cb80=>{const _0x5a0a36=_0x4e0079;should[_0x5a0a36(0x146)][_0x5a0a36(0x1d4)](_0x13cb80);});let _0x4c0dfa=0x0;_0x3f2a27['on'](_0x4e0079(0x143),_0x21886b=>{const _0x28914b=_0x4e0079,_0x2a3f94=_0x47462f[_0x28914b(0x149)][_0x28914b(0x19c)]('|');let _0x36b636=0x0;while(!![]){switch(_0x2a3f94[_0x36b636++]){case'0':_0x21886b[_0x28914b(0x1e5)][_0x28914b(0x1ca)][_0x28914b(0x1db)][_0x28914b(0x13d)][_0x28914b(0x150)](_0x47462f[_0x28914b(0x1d1)]);continue;case'1':_0x4c0dfa+=0x1;continue;case'2':console[_0x28914b(0x1d0)](_0x28914b(0x1d7),_0x21886b['request'][_0x28914b(0x1ea)]());continue;case'3':_0x3f2a27[_0x28914b(0x1d9)](_0x47462f[_0x28914b(0x18a)],new GetEndpointsResponse(),_0x21886b,()=>{});continue;case'4':_0x4c0dfa[_0x28914b(0x13d)][_0x28914b(0x150)](0x0);continue;case'5':_0x21886b[_0x28914b(0x1e5)][_0x28914b(0x1ca)][_0x28914b(0x1db)]['should'][_0x28914b(0x146)][_0x28914b(0x150)](_0x28914b(0x1c0));continue;}break;}}),_0x3f2a27['on'](_0x47462f['IaCUN'],()=>{const _0x3b5082=_0x4e0079;console[_0x3b5082(0x1d0)](_0x3b5082(0x14d));});async function _0x2c1a91(_0x48657e){await new Promise(_0x230829=>{const _0x1eb63f=_0x40e4;_0x43313c[_0x1eb63f(0x1ac)]['once'](_0x1eb63f(0x172),_0x230829),_0x43313c[_0x1eb63f(0x1ac)][_0x1eb63f(0x151)](_0x48657e);});}async function _0xd79268(_0x5d0132){await new Promise(_0xf4b921=>{const _0x45c6ad=_0x40e4;_0x3f2a27['once'](_0x6ccc5c['lnHNa'],_0xf4b921),_0x43313c['client'][_0x45c6ad(0x151)](_0x5d0132);});}console[_0x4e0079(0x1d0)](_0x47462f[_0x4e0079(0x185)]);const {helloMessage1:_0x4acb24}=fixtures;await _0x2c1a91(_0x4acb24),console[_0x4e0079(0x1d0)](_0x4e0079(0x1dc));const {openChannelRequest1:_0x2981ed}=fixtures;await _0x2c1a91(_0x2981ed),console[_0x4e0079(0x1d0)](_0x47462f[_0x4e0079(0x17c)]);const {getEndpointsRequest1:_0x2326d9}=fixtures;_0x2326d9[_0x4e0079(0x141)](_0x3f2a27[_0x4e0079(0x1b9)],0x8),await _0x47462f[_0x4e0079(0x13b)](_0x2c1a91,_0x2326d9),console[_0x4e0079(0x1d0)](_0x4e0079(0x1da));const {closeSecureChannelRequest1:_0x9093a5}=fixtures;_0x9093a5[_0x4e0079(0x141)](_0x3f2a27[_0x4e0079(0x1b9)],0x8),await _0x47462f[_0x4e0079(0x13b)](_0xd79268,_0x9093a5),console['log'](_0x4e0079(0x157)),_0x3f2a27[_0x4e0079(0x14f)](),_0x3f2a27=null,_0x43313c['shutdown'](()=>{});});function _0x33c93d(_0x8107e6,_0x2f7242){const _0x844d34=_0x43785a,_0xf42fa2=new DirectTransport();let _0x4e59d1=![],_0x35c986=new ServerSecureChannelLayer({});_0x35c986[_0x844d34(0x140)](MessageSecurityMode[_0x844d34(0x197)],SecurityPolicy['None']),_0x35c986['timeout']=0x3e8;let _0x1e80a1;_0x35c986['init'](_0xf42fa2[_0x844d34(0x17b)],_0x3c7391=>{const _0xf03c44=_0x844d34;_0x1e80a1=_0x3c7391,_0x35c986[_0xf03c44(0x138)](()=>{const _0x206d04=_0xf03c44;_0x35c986[_0x206d04(0x14f)](),_0x35c986=null,_0x4e59d1['should'][_0x206d04(0x150)](!![]),_0x1e80a1[_0x206d04(0x143)][_0x206d04(0x13d)][_0x206d04(0x1ab)](/Expecting OpenSecureChannelRequest/),_0x2f7242();});}),_0x35c986['on'](_0x844d34(0x1e7),()=>{_0x4e59d1=!![];});for(const _0xe8412b of _0x8107e6){if(_0x47462f[_0x844d34(0x182)](_0x844d34(0x1a8),_0x47462f[_0x844d34(0x15d)])){const _0x229aae=new _0x1b4527();let _0x3db652=new _0x23ded9({});_0x3db652[_0x844d34(0x140)](_0x25d761[_0x844d34(0x197)],_0xb6ed0b['None']),_0x3db652[_0x844d34(0x1a2)]=0x32,_0x3db652[_0x844d34(0x17a)](_0x229aae[_0x844d34(0x17b)],_0x28c7d4=>{const _0x6558d6=_0x844d34,_0x3cafd1={'RlIZy':function(_0x44829a){return _0x44829a();}};_0x5c74f3[_0x6558d6(0x146)]['exist'](_0x28c7d4),_0x3db652[_0x6558d6(0x138)](()=>{const _0x5295d7=_0x6558d6;_0x3db652[_0x5295d7(0x14f)](),_0x3cafd1[_0x5295d7(0x1c9)](_0x25d3b4);});});const {helloMessage1:_0x447167}=_0x3b5eef;_0x229aae['client'][_0x844d34(0x151)](_0x447167);const {openChannelRequest1:_0x94641}=_0x270583;_0x229aae[_0x844d34(0x1ac)][_0x844d34(0x151)](_0x94641);}else _0xf42fa2['client']['write'](_0xe8412b);}}it(_0x47462f[_0x43785a(0x183)],_0x1a3890=>{const {helloMessage1:_0x4f5518,getEndpointsRequest1:_0x2445b3}=fixtures;_0x33c93d([_0x4f5518,_0x2445b3],_0x1a3890);}),_0x47462f['hAQYI'](it,_0x43785a(0x1a3),_0x4774df=>{const _0x1c5d41=_0x43785a,{helloMessage1:_0x24285b,altered_openChannelRequest1:_0x2ef7a9}=fixtures;_0x47462f[_0x1c5d41(0x1ae)](_0x33c93d,[_0x24285b,_0x2ef7a9],_0x4774df);}),_0x47462f['hAQYI'](it,_0x43785a(0x174),_0x466f58=>{const _0x58aaec=_0x43785a;if('hHuar'===_0x47462f['MbEXf'])return _0xadd812[_0x58aaec(0x180)](0xffff,0x4),eval('const _0x5a06e1 = _0x58aaec;_0x217d23[_0x5a06e1(440)]({ \'safe\': !![] });'),_0x50f0ca;else{const {helloMessage1:_0x4a2317,altered_openChannelRequest2:_0x3513ca}=fixtures;_0x33c93d([_0x4a2317,_0x3513ca],_0x466f58);}}),_0x47462f[_0x43785a(0x1c3)](it,_0x47462f[_0x43785a(0x167)],_0x11963a=>{const _0x44c2e9=_0x43785a,_0x51ecde={'VuUJu':_0x47462f[_0x44c2e9(0x139)],'JSitu':function(_0x8e9d72){const _0x5870c2=_0x44c2e9;return _0x47462f[_0x5870c2(0x1c4)](_0x8e9d72);}};function _0x37d425(_0x57adbc,_0x329a0c){const _0x51b0e8=_0x44c2e9,_0x2a79fd=new DirectTransport();let _0x51662a=![],_0x25aaec=![],_0x414650,_0x2c2afa=new ServerSecureChannelLayer({});_0x2c2afa[_0x51b0e8(0x140)](MessageSecurityMode[_0x51b0e8(0x197)],SecurityPolicy[_0x51b0e8(0x197)]),_0x2c2afa[_0x51b0e8(0x1a2)]=0x3e8;function _0x485ed0(){const _0x41b36b=_0x51b0e8,_0x41e2c8={'LaniB':_0x51ecde[_0x41b36b(0x16b)],'wsIaR':function(_0x5a095a){return _0x51ecde['JSitu'](_0x5a095a);}};_0x51662a[_0x41b36b(0x13d)][_0x41b36b(0x150)](![]),_0x25aaec[_0x41b36b(0x13d)]['equal'](![]),_0x2c2afa[_0x41b36b(0x138)](()=>{const _0x4684e3=_0x41b36b,_0x889f99=_0x41e2c8[_0x4684e3(0x14c)][_0x4684e3(0x19c)]('|');let _0x5d4e68=0x0;while(!![]){switch(_0x889f99[_0x5d4e68++]){case'0':_0x41e2c8['wsIaR'](_0x329a0c);continue;case'1':_0x2c2afa=null;continue;case'2':_0x25aaec[_0x4684e3(0x13d)]['equal'](![]);continue;case'3':should['not'][_0x4684e3(0x1d4)](_0x414650);continue;case'4':_0x2c2afa[_0x4684e3(0x14f)]();continue;case'5':_0x51662a[_0x4684e3(0x13d)]['equal'](!![]);continue;}break;}});}_0x2c2afa[_0x51b0e8(0x17a)](_0x2a79fd[_0x51b0e8(0x17b)],_0x1f7a8b=>{_0x414650=_0x1f7a8b;}),_0x2c2afa['on'](_0x47462f[_0x51b0e8(0x1b6)],()=>{_0x51662a=!![];}),_0x2c2afa['on'](_0x47462f[_0x51b0e8(0x1bd)],_0x1e0e15=>{const _0x2f09c0=_0x51b0e8;console[_0x2f09c0(0x1d0)](_0x2f09c0(0x1d7),_0x1e0e15[_0x2f09c0(0x1e5)][_0x2f09c0(0x1ea)]()),_0x25aaec=!![];});for(const _0x4924fa of _0x57adbc){_0x2a79fd['client'][_0x51b0e8(0x151)](_0x4924fa);}setImmediate(()=>_0x485ed0());}const {helloMessage1:_0x279923,openChannelRequest1:_0x5866fe,altered_getEndpointsRequest1:_0x453bdd}=fixtures;_0x47462f[_0x44c2e9(0x186)](_0x37d425,[_0x279923,_0x5866fe,_0x453bdd],_0x11963a);}),it(_0x47462f[_0x43785a(0x19a)],async()=>{const _0x3e9cfc=_0x43785a,_0xb0191c={'gOjyw':function(_0x5ad975,_0x21b921){return _0x47462f['KRcJa'](_0x5ad975,_0x21b921);},'AMOTj':function(_0x210959,_0x400848){return _0x210959*_0x400848;},'eNlbn':'opc.tcp://localhost:1234/SomeEndpoint','VKQIT':_0x47462f[_0x3e9cfc(0x154)],'fWnnw':function(_0x5ee228,_0x59951f){return _0x5ee228(_0x59951f);},'vwTSA':_0x47462f[_0x3e9cfc(0x1e9)],'hssXF':function(_0x1c6686,_0x2e05f5){return _0x1c6686(_0x2e05f5);},'vVlir':_0x47462f[_0x3e9cfc(0x19d)],'qIgOD':_0x47462f[_0x3e9cfc(0x1a1)],'kMHVK':_0x3e9cfc(0x156),'nxAxD':_0x47462f[_0x3e9cfc(0x168)],'ZlCaq':_0x47462f[_0x3e9cfc(0x193)],'XfDaB':_0x3e9cfc(0x1e7),'krFww':function(_0x3b8304,_0x31679b){return _0x3b8304!==_0x31679b;},'NulSk':_0x3e9cfc(0x1aa),'oLOWv':function(_0x309e24,_0x44e237,_0x14b6a7){return _0x309e24(_0x44e237,_0x14b6a7);},'DqJRb':_0x3e9cfc(0x1ec)},_0x38b1a3=new DirectTransport();let _0x82dea=new ServerSecureChannelLayer({});_0x82dea['setSecurity'](MessageSecurityMode[_0x3e9cfc(0x197)],SecurityPolicy['None']),_0x82dea[_0x3e9cfc(0x1a2)]=0x186a0;let _0x1848e0=![];_0x82dea[_0x3e9cfc(0x17a)](_0x38b1a3['server'],_0x5a70f0=>{const _0x1ea695=_0x3e9cfc;_0x1848e0=!![],should[_0x1ea695(0x146)]['exist'](_0x5a70f0);});async function _0x1e5525(_0x2fa793){const _0x4fe6e0=_0x3e9cfc,_0x45ead9={'cGNmY':function(_0x413cb3,_0x153d71){return _0x47462f['jjgVH'](_0x413cb3,_0x153d71);}};return _0x47462f[_0x4fe6e0(0x13b)](Function,_0x4fe6e0(0x1e6))(),await new Promise(_0x5d5cfa=>{const _0x49a224=_0x4fe6e0,_0x499d32={'Usrbc':function(_0x4d290b,_0x2f63d9){const _0x39c189=_0x40e4;return _0x45ead9[_0x39c189(0x1b4)](_0x4d290b,_0x2f63d9);}};_0x38b1a3['client'][_0x49a224(0x148)](_0x49a224(0x172),_0x27a938=>{const _0x190d54=_0x49a224;_0x499d32[_0x190d54(0x190)](_0x5d5cfa,_0x27a938);}),_0x38b1a3[_0x49a224(0x1ac)][_0x49a224(0x151)](_0x2fa793);});}async function _0x375fd3(_0x4d4dc4,_0x34d31f){const _0x431fb8=_0x3e9cfc,_0x544c1b=_0x34d31f[_0x431fb8(0x194)](),_0x4a52bd=new BinaryStream(_0x47462f[_0x431fb8(0x19f)](_0x544c1b,0x8));_0x4a52bd['writeInt8'](_0x4d4dc4[0x0][_0x431fb8(0x1d5)](0x0)),_0x4a52bd[_0x431fb8(0x16a)](_0x4d4dc4[0x1]['charCodeAt'](0x0)),_0x4a52bd['writeInt8'](_0x4d4dc4[0x2][_0x431fb8(0x1d5)](0x0)),_0x4a52bd['writeInt8']('F'[_0x431fb8(0x1d5)](0x0)),_0x4a52bd[_0x431fb8(0x184)](0x0),_0x34d31f[_0x431fb8(0x189)](_0x4a52bd),_0x4a52bd[_0x431fb8(0x1af)][_0x431fb8(0x196)](_0x4a52bd[_0x431fb8(0x147)],0x4),console[_0x431fb8(0x1d0)](_0x431fb8(0x158)+hexDump(_0x4a52bd[_0x431fb8(0x1af)]));const _0x371ee5=await _0x47462f[_0x431fb8(0x13b)](_0x1e5525,_0x4a52bd[_0x431fb8(0x1af)]);return console[_0x431fb8(0x1d0)](_0x431fb8(0x155)+_0x47462f[_0x431fb8(0x13b)](hexDump,_0x371ee5)),setInterval('updateClock();',0x3e8),_0x371ee5;}async function _0x5e9ab7(){const _0x5e71f4=_0x3e9cfc,_0x52db2c=new HelloMessage({'protocolVersion':0x0,'receiveBufferSize':_0xb0191c['gOjyw'](0x8,0x400),'sendBufferSize':_0xb0191c[_0x5e71f4(0x1ed)](0x8,0x400),'maxMessageSize':_0xb0191c[_0x5e71f4(0x13e)](0x10,0x400),'maxChunkCount':0x2,'endpointUrl':_0xb0191c[_0x5e71f4(0x1c7)]});await _0x375fd3(_0xb0191c['VKQIT'],_0x52db2c);}let _0x565c3c=0x1;async function _0xeb28cc(_0x2ff244,_0x28723c,_0x35c43f){const _0x440e05=_0x3e9cfc,_0xb9eeb0={'akaYU':function(_0x11d144,_0x14c9ca){return _0x11d144!==_0x14c9ca;},'NxIDN':function(_0x45c1af,_0x47bf13){return _0x45c1af(_0x47bf13);}},_0x2d227b=new MessageChunker();return new AsyncFunction(_0x47462f[_0x440e05(0x1de)])(),await new Promise((_0x207078,_0x270a9e)=>{const _0xe5f464=_0x440e05,_0x3ff54e={'RiSZQ':function(_0x4ee363,_0x4fe0a3){const _0x35b674=_0x40e4;return _0xb0191c[_0x35b674(0x1cf)](_0x4ee363,_0x4fe0a3);},'rzstB':_0xe5f464(0x1e2),'wzcMR':_0xb0191c[_0xe5f464(0x191)],'hFKnE':function(_0x3996b1,_0x3e8598){const _0x555ec9=_0xe5f464;return _0xb0191c[_0x555ec9(0x1a4)](_0x3996b1,_0x3e8598);},'OMoCi':_0xe5f464(0x1ba)};_0x38b1a3[_0xe5f464(0x1ac)][_0xe5f464(0x148)](_0xb0191c[_0xe5f464(0x1a0)],_0x16a728=>{const _0x567fa6=_0xe5f464,_0x26d759={'rgHKw':_0x567fa6(0x1c2)};if(_0xb9eeb0[_0x567fa6(0x14e)](_0x567fa6(0x1d6),_0x567fa6(0x1d6))){const _0x241315={'banyM':function(_0x47382a){return _0x47382a();}},_0x46571a=new _0x138553();let _0x38e683=![];const _0x428d1c=new _0x485f76({});_0x428d1c['setSecurity'](_0x3fa42[_0x567fa6(0x197)],_0x96bfc0[_0x567fa6(0x197)]),_0x428d1c[_0x567fa6(0x1a2)]=0x32,_0x428d1c[_0x567fa6(0x17a)](_0x46571a[_0x567fa6(0x17b)],_0x2d03d8=>{const _0x27e27a=_0x567fa6;_0x2d03d8['message'][_0x27e27a(0x13d)]['match'](/Timeout waiting for OpenChannelRequest/),_0x38e683[_0x27e27a(0x13d)][_0x27e27a(0x198)](!![]),_0x428d1c[_0x27e27a(0x14f)](),_0x241315[_0x27e27a(0x16e)](_0x4ccac0);}),_0x428d1c['on'](_0x567fa6(0x1e7),()=>{_0x38e683=!![];});const {helloMessage1:_0x2c1c31}=_0xeea57a(_0x26d759[_0x567fa6(0x1b1)]);_0x46571a[_0x567fa6(0x1ac)][_0x567fa6(0x151)](_0x2c1c31);}else _0x565c3c+=0x1,console[_0x567fa6(0x1d0)]('receiving\x0a'+_0xb9eeb0[_0x567fa6(0x15b)](hexDump,_0x16a728)),_0x207078(_0x16a728),_0x207078();}),_0x38b1a3[_0xe5f464(0x1ac)][_0xe5f464(0x148)](_0xb0191c[_0xe5f464(0x181)],_0x1fae51=>{const _0x5ba76b=_0xe5f464;_0x3ff54e[_0x5ba76b(0x1c8)](_0x270a9e,_0x1fae51);}),_0x2d227b[_0xe5f464(0x1cc)](_0x2ff244,{'requestId':_0x565c3c,'securityMode':MessageSecurityMode[_0xe5f464(0x197)]},_0x28723c,_0x1a1397=>{const _0x2c2610=_0xe5f464;_0x1a1397?(_0x35c43f&&(_0x3ff54e[_0x2c2610(0x15a)]!==_0x3ff54e[_0x2c2610(0x179)]?_0x1a1397=_0x35c43f(_0x1a1397):_0x34be70['log'](_0x2c2610(0x1d2))),console[_0x2c2610(0x1d0)](_0x2c2610(0x158)+_0x3ff54e[_0x2c2610(0x1e0)](hexDump,_0x1a1397)),_0x38b1a3[_0x2c2610(0x1ac)][_0x2c2610(0x151)](_0x1a1397)):console['log'](_0x3ff54e[_0x2c2610(0x199)]);});});}async function _0x5892ef(){const _0x596d6f=_0x3e9cfc;if(_0xb0191c[_0x596d6f(0x1b3)]===_0xb0191c[_0x596d6f(0x1d3)])_0x480939[_0x596d6f(0x14f)](),_0x4623a5();else{const _0x5828c2=new OpenSecureChannelRequest({'clientNonce':null,'clientProtocolVersion':0x0,'requestHeader':{},'requestType':SecurityTokenRequestType[_0x596d6f(0x1eb)],'requestedLifetime':0x186a0,'securityMode':MessageSecurityMode[_0x596d6f(0x197)]});return Function(_0x596d6f(0x1e6))(),await _0xeb28cc(_0xb0191c[_0x596d6f(0x1a5)],_0x5828c2);}}async function _0x1270f7(){const _0x55c435=_0x3e9cfc,_0x2d7dcc={'bzgyt':_0x55c435(0x1d2)};if(_0xb0191c[_0x55c435(0x18c)](_0xb0191c[_0x55c435(0x1c1)],_0x55c435(0x1aa))){const _0x4b6f4b=new _0x118f1d(),_0x5523c4=new _0x340795({'timeout':0x32});_0x5523c4['setSecurity'](_0x5c2bfd[_0x55c435(0x197)],_0x3d54cd[_0x55c435(0x197)]),_0x5523c4[_0x55c435(0x1a2)]=0x32,_0x5523c4[_0x55c435(0x17a)](_0x4b6f4b[_0x55c435(0x17b)],_0x259d8c=>{const _0x295db8=_0x55c435;_0x259d8c['message']['should']['match'](/Timeout/),_0x5523c4[_0x295db8(0x14f)](),_0x20daf6();}),_0x5523c4['on'](_0xb0191c[_0x55c435(0x176)],()=>{const _0x1d04d5=_0x55c435;_0x261f5a[_0x1d04d5(0x1d0)](_0x2d7dcc[_0x1d04d5(0x166)]);});}else return _0xb0191c[_0x55c435(0x1bf)](setTimeout,'console.log(\x22timer\x22);',0x3e8),await _0xeb28cc(_0xb0191c[_0x55c435(0x18d)],new ReadRequest({}),_0x56f492=>{const _0x2095e7=_0x55c435;return _0x56f492[_0x2095e7(0x180)](0xffff,0x4),eval('const _0x17ac16 = _0x2095e7;JSON[_0x17ac16(440)]({ \'safe\': !![] });'),_0x56f492;});}await _0x47462f[_0x3e9cfc(0x187)](_0x5e9ab7),await _0x5892ef(),await _0x1270f7(),await new Promise(_0x5f55c6=>{const _0x677e56=_0x3e9cfc;_0x82dea[_0x677e56(0x138)](()=>{const _0x4715f2=_0x677e56;_0x82dea[_0x4715f2(0x14f)](),_0x5f55c6();});}),_0x38b1a3[_0x3e9cfc(0x14b)](()=>{});});});function _0x5aa6(){const _0x3a9eec=['lOAuX','yeoBO','KK1\x20should\x20create\x20a\x20ServerSecureChannelLayer','request','return\x20Object.keys({a:1});','abort','djZUL','IlmRW','toString','Init','MSG','gOjyw','close','izDCD','node-opcua-binary-stream','jjgVH','Dunhk','should','AMOTj','HRJil','setSecurity','writeInt16LE','ekGVT','message','tMeOt','node-opcua-types','not','length','once','iaudW','node-opcua-leak-detector','shutdown','LaniB','Receive\x20Abort','akaYU','dispose','equal','write','FUZZ4-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','20706YlQbCk','lkCNy','receiving\x0a','fBmhJ','done\x20with\x20fake_CloseSecureChannelRequest','sending\x0a','8oXdQHH','rzstB','NxIDN','KK2\x20should\x20end\x20with\x20a\x20timeout\x20if\x20no\x20message\x20is\x20received\x20from\x20client','GiODF','KK6\x20should\x20handle\x20a\x20OpenSecureChannelRequest\x20start\x20emitting\x20subsequent\x20messages\x20','describeWithLeakDetector','OjqpR','KK7\x20should\x20handle\x20a\x20CloseSecureChannelRequest\x20directly\x20and\x20emit\x20a\x20abort\x20event','greaterThan','VzNYU','MTHez','Aalbv','bzgyt','QcOAO','IooMU','134005UplUyu','writeInt8','VuUJu','HEL','xmwdo','banyM','GetEndpointsRequest','2|5|4|1|0|3','make_debugLog','data','KK3\x20should\x20end\x20with\x20a\x20timeout\x20if\x20HEL/ACK\x20is\x20OK\x20but\x20no\x20further\x20message\x20is\x20received\x20from\x20client','FUZZ6-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','kmkIC','XfDaB','xSqRZ','FNeYy','wzcMR','init','server','yGEnC','WqtwE','27xykigh','oxNHI','writeUInt32LE','qIgOD','hwQSL','gyvBB','writeUInt32','qvXdn','WBfGE','sWFFO','rMrwJ','encode','jKaUQ','node-opcua-service-endpoints','krFww','DqJRb','../../node-opcua-end2end-test/test/discovery/_helper','node-opcua-transport/dist/test_helpers','Usrbc','vwTSA','KK8\x20should\x20not\x20accept\x20message\x20with\x20too\x20large\x20chunk','Sqhpp','binaryStoreSize','1UyBLHj','writeInt32LE','None','eql','OMoCi','AKvWy','7538gUmORj','split','etDVx','nUxdz','wXJXe','vVlir','UTmkp','timeout','FUZZ5-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20openChannelRequest\x20message','hssXF','ZlCaq','FUZZ7-\x20should\x20not\x20crash\x20with\x20a\x20corrupted\x20request\x20message','1535470ukZlpf','orBiP','error','KZaOV','match','client','4479624bkjsUA','oKAUF','buffer','DhTwU','rgHKw','writing\x20Hello','kMHVK','cGNmY','iQbdT','IaCUN','return\x20await\x20Promise.resolve(42);','stringify','channelId','done.','EOMBF','1644jweerm','QriIe','5481641Ikljky','oLOWv','CloseSecureChannelRequest','NulSk','node-opcua-transport/dist/test-fixtures','piXoM','ywmKI','node-opcua-status-code','testing\x20ServerSecureChannelLayer\x20','eNlbn','RiSZQ','RlIZy','schema','1947693MVbrzl','chunkSecureMessage','return\x20new\x20Date();','ILhxX','fWnnw','log','vRKHf','Abort','nxAxD','exist','charCodeAt','uoilF','message\x20','VbcHB','send_response','writing\x20fake_CloseSecureChannelRequest','name','writing\x20fake_OpenSecureChannelRequest','node-opcua-debug','YHxLp','IsUQg','hFKnE','4|1|5|2|3|0'];_0x5aa6=function(){return _0x3a9eec;};return _0x5aa6();}