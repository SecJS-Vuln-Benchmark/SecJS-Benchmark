function _0x2a40(_0x31efec,_0x20ba55){const _0x2b57b5=_0x2b57();return _0x2a40=function(_0x2a4011,_0x2fd8d0){_0x2a4011=_0x2a4011-0x191;let _0x52afa0=_0x2b57b5[_0x2a4011];return _0x52afa0;},_0x2a40(_0x31efec,_0x20ba55);}function _0x2b57(){const _0x29a09d=['push','Vtbty','toLowerCase','xRcAp','dtxp','data','every','utils','config','WBProps','Decimal','field_','Date','column_name','WAZKa','toString','SheetNames','RRDpc','2413860RySjRM','ceil','array','getData','Currency','name','wLiXv','tables','OmxhW','TMzNQ','xmqDM','LongText','LXgPb','decode_range','parse_date_code','map','string','zIhOP','getTimezoneOffset','table','getTime','maxRowsToParse','3687264CXFfBX','ZFwye','mCNwX','split','uidt','join','project','\x27,\x27','64072pEedAa','date1904','filter','trim','6869496aqKGte','Workbook','250548oggmbU','MultiSelect','encode_cell','hOQmG','columns','slice','SingleSelect','some','xPlCd','startsWith','Number','SjOuG','findIndex','RsPwE','SSF','length','csv','SingleLineText','excelData','1288662KYpgdc','!ref','122776jcPlOG','PPOPQ','read','lPQLX','parse','tluSo','Sheets','replace','vZQWA','Checkbox','4ZOzfQt'];_0x2b57=function(){return _0x29a09d;};return _0x2b57();}const _0x561201=_0x2a40;(function(_0x16506d,_0x133d4f){const _0x3771e9=_0x2a40,_0x53efd0=_0x16506d();while(!![]){try{const _0x2ef044=-parseInt(_0x3771e9(0x1c9))/0x1+-parseInt(_0x3771e9(0x1e4))/0x2+parseInt(_0x3771e9(0x1e2))/0x3*(-parseInt(_0x3771e9(0x198))/0x4)+parseInt(_0x3771e9(0x1ab))/0x5+parseInt(_0x3771e9(0x1cf))/0x6+-parseInt(_0x3771e9(0x1c1))/0x7+parseInt(_0x3771e9(0x1cd))/0x8;if(_0x2ef044===_0x133d4f)break;else _0x53efd0['push'](_0x53efd0['shift']());}catch(_0x215667){_0x53efd0['push'](_0x53efd0['shift']());}}}(_0x2b57,0x4998b));import _0x37d045 from'xlsx';import{UITypes}from'~/components/project/spreadsheet/helpers/uiTypes';import _0x503b54 from'~/components/import/templateParsers/TemplateGenerator';import{getCheckboxValue,isCheckboxType}from'~/components/import/templateParsers/parserHelpers';const excelTypeToUidt={'d':UITypes['DateTime'],'b':UITypes[_0x561201(0x197)],'n':UITypes[_0x561201(0x1d9)],'s':UITypes[_0x561201(0x1e0)]};export default class ExcelTemplateAdapter extends _0x503b54{constructor(_0x2ab777,_0x363cfc,_0x44e8e4={}){const _0x1a333e=_0x561201;super(),this[_0x1a333e(0x1a1)]={'maxRowsToParse':0x1f4,..._0x44e8e4},this['name']=_0x2ab777,this[_0x1a333e(0x1e1)]=_0x363cfc,this[_0x1a333e(0x1c7)]={'title':this[_0x1a333e(0x1b0)],'tables':[]},this[_0x1a333e(0x19e)]={};}async['init'](){const _0xcffb6b=_0x561201,_0x33b312={'xmqDM':function(_0x4b5889,_0x3fe85f){return _0x4b5889===_0x3fe85f;}},_0x18f58f={'cellText':!![],'cellDates':!![]};_0x33b312[_0xcffb6b(0x1b5)](this[_0xcffb6b(0x1b0)][_0xcffb6b(0x1d4)](-0x3),'csv')?this['wb']=_0x37d045[_0xcffb6b(0x1e6)](new TextDecoder()['decode'](new Uint8Array(this[_0xcffb6b(0x1e1)])),{'type':_0xcffb6b(0x1bb),..._0x18f58f}):this['wb']=_0x37d045[_0xcffb6b(0x1e6)](new Uint8Array(this[_0xcffb6b(0x1e1)]),{'type':_0xcffb6b(0x1ad),..._0x18f58f});}[_0x561201(0x192)](){const _0x3f6f03=_0x561201,_0x3f2501={'Vtbty':_0x3f6f03(0x193),'xPlCd':function(_0x23a0f4,_0x3691b8){return _0x23a0f4!==_0x3691b8;},'WAZKa':function(_0x5cc5b0,_0x4da0ad){return _0x5cc5b0+_0x4da0ad;},'lPQLX':function(_0x24e6fb,_0x2c8409){return _0x24e6fb===_0x2c8409;},'mCNwX':function(_0x5de687,_0x4d1037){return _0x5de687 in _0x4d1037;},'NWqxP':'MIJpH','zIhOP':_0x3f6f03(0x1e3),'HRFWA':_0x3f6f03(0x1df),'Dqnuq':function(_0x5443d9,_0x198b1b){return _0x5443d9*_0x198b1b;},'vZQWA':function(_0x4510ba,_0x15b5d2){return _0x4510ba<_0x15b5d2;},'TMzNQ':function(_0x7993bf,_0x409272){return _0x7993bf+_0x409272;},'RRDpc':function(_0x24b573,_0x12f684){return _0x24b573===_0x12f684;},'vLTGy':function(_0x1a11a4,_0x58c7b0){return _0x1a11a4(_0x58c7b0);},'OmxhW':function(_0x4fac79,_0x3d9a76){return _0x4fac79<=_0x3d9a76;},'RsPwE':function(_0x3f4bab,_0x46e1b7){return _0x3f4bab/_0x46e1b7;},'kDQMP':_0x3f6f03(0x1c8),'rBOci':function(_0x3556e6,_0x3b7056){return _0x3556e6/_0x3b7056;},'PPOPQ':function(_0x1f9ff4,_0x52af55){return _0x1f9ff4===_0x52af55;},'wLiXv':function(_0x4106f5,_0x15cb8e){return _0x4106f5===_0x15cb8e;},'LXgPb':_0x3f6f03(0x1da),'tOjQK':function(_0x23ac41,_0x5d854a){return _0x23ac41+_0x5d854a;},'oIEXC':function(_0x556421,_0x402ee0){return _0x556421+_0x402ee0;}},_0x32ab0c={};for(let _0x170351=0x0;_0x170351<this['wb'][_0x3f6f03(0x1a9)][_0x3f6f03(0x1de)];_0x170351++){const _0xad1512={'id':0x0},_0x2829fd=this['wb'][_0x3f6f03(0x1a9)][_0x170351];let _0x25f2c6=(_0x2829fd||_0x3f6f03(0x1be))[_0x3f6f03(0x195)](/\W/g,'_')['trim']();while(_0x3f2501[_0x3f6f03(0x1c3)](_0x25f2c6,_0x32ab0c)){if(_0x3f2501[_0x3f6f03(0x1d7)](_0x3f2501['NWqxP'],_0x3f2501['NWqxP']))return this['project'];else _0x25f2c6=''+_0x25f2c6+ ++_0x32ab0c[_0x25f2c6];}_0x32ab0c[_0x25f2c6]=0x0;const _0x46c581={'table_name':_0x25f2c6,'ref_table_name':_0x25f2c6,'columns':[]};this[_0x3f6f03(0x19e)][_0x25f2c6]=[];const _0x1ad1b0=this['wb'][_0x3f6f03(0x194)][_0x2829fd],_0x45b34e=_0x37d045[_0x3f6f03(0x1a0)][_0x3f6f03(0x1b8)](_0x1ad1b0[_0x3f2501[_0x3f6f03(0x1bc)]]),_0x4a02e8=_0x37d045['utils']['sheet_to_json'](_0x1ad1b0,{'header':0x1,'blankrows':![],'cellDates':!![],'defval':null});if(this[_0x3f6f03(0x1b0)][_0x3f6f03(0x1d4)](-0x3)!==_0x3f2501['HRFWA']){const _0x3de6fe=new Date(0x76b,0xb,0x1e,0x0,0x0,0x0),_0x4a0406=_0x3de6fe[_0x3f6f03(0x1bf)]()+_0x3f2501['Dqnuq'](new Date()[_0x3f6f03(0x1bd)]()-_0x3de6fe[_0x3f6f03(0x1bd)](),0xea60),_0x10206e=0x18*0x3c*0x3c*0x3e8,_0x268009=_0x1c713c=>{const _0x14a653=_0x3f6f03;if(_0x3f2501[_0x14a653(0x19a)]===_0x14a653(0x193)){const _0x29f0f8=_0x37d045[_0x14a653(0x1dd)][_0x14a653(0x1b9)]((_0x1c713c[_0x14a653(0x1bf)]()-_0x4a0406)/_0x10206e,{'date1904':this['wb'][_0x14a653(0x1ce)][_0x14a653(0x1a2)][_0x14a653(0x1ca)]});return new Date(_0x29f0f8['y'],_0x29f0f8['m'],_0x29f0f8['d'],_0x29f0f8['H'],_0x29f0f8['M'],_0x29f0f8['S']);}else _0x32d0af[_0x480c11['columns'][_0x5de947][_0x14a653(0x1a6)]]=(_0x4a2d9e[_0x5762b9]||'')[_0x14a653(0x1a8)]()[_0x14a653(0x1cc)]()||null;};_0x4a02e8=_0x4a02e8[_0x3f6f03(0x1ba)](_0x54e0d8=>_0x54e0d8['map'](_0x4e5f5a=>{return _0x4e5f5a instanceof Date?_0x268009(_0x4e5f5a):_0x4e5f5a;}));}const _0x4af5c8=+_0x4a02e8[0x0]['every'](_0x3a7990=>_0x3a7990===null||typeof _0x3a7990===_0x3f6f03(0x1bb));for(let _0x503b20=0x0;_0x3f2501[_0x3f6f03(0x196)](_0x503b20,_0x4a02e8[0x0]['length']);_0x503b20++){let _0x335d67=(_0x4af5c8&&_0x4a02e8[0x0]&&_0x4a02e8[0x0][_0x503b20]&&_0x4a02e8[0x0][_0x503b20][_0x3f6f03(0x1a8)]()['trim']()||_0x3f6f03(0x1a4)+(_0x503b20+0x1))['replace'](/\W/g,'_')[_0x3f6f03(0x1cc)]();while(_0x335d67 in _0xad1512){_0x335d67=''+_0x335d67+ ++_0xad1512[_0x335d67];}_0xad1512[_0x335d67]=0x0;const _0x50d9f0={'column_name':_0x335d67,'ref_column_name':_0x335d67};_0x46c581['columns'][_0x3f6f03(0x199)](_0x50d9f0);const _0x7f83ed=_0x37d045[_0x3f6f03(0x1a0)]['encode_cell']({'c':_0x3f2501[_0x3f6f03(0x1b4)](_0x45b34e['s']['c'],_0x503b20),'r':_0x4af5c8}),_0x30bc9e=_0x1ad1b0[_0x7f83ed]||{};_0x50d9f0[_0x3f6f03(0x1c5)]=excelTypeToUidt[_0x30bc9e['t']]||UITypes['SingleLineText'];if(_0x50d9f0[_0x3f6f03(0x1c5)]===UITypes['SingleLineText']){if(_0x4a02e8[_0x3f6f03(0x1d6)](_0x41aa2d=>(_0x41aa2d[_0x503b20]||'')[_0x3f6f03(0x1a8)]()['match'](/[\r\n]/)||(_0x41aa2d[_0x503b20]||'')[_0x3f6f03(0x1a8)]()[_0x3f6f03(0x1de)]>0xff))_0x3f2501[_0x3f6f03(0x1aa)]('ZGICf','ZGICf')?_0x50d9f0[_0x3f6f03(0x1c5)]=UITypes[_0x3f6f03(0x1b6)]:_0xb513b3[_0x3f6f03(0x1c5)]=_0xd006ff[_0x3f6f03(0x1a3)];else{const _0xba78f2=_0x4a02e8[_0x3f6f03(0x1d4)](_0x4af5c8?0x1:0x0)[_0x3f6f03(0x1ba)](_0x11eda1=>_0x11eda1[_0x503b20])[_0x3f6f03(0x1cb)](_0x97599=>_0x97599!==null&&_0x97599!==undefined&&_0x97599[_0x3f6f03(0x1a8)]()[_0x3f6f03(0x1cc)]()!==''),_0x30b2da=_0x3f2501['vLTGy'](isCheckboxType,_0xba78f2);if(_0x3f2501[_0x3f6f03(0x191)](_0x30b2da['length'],0x1))_0x50d9f0['uidt']=UITypes[_0x3f6f03(0x197)];else{if(_0xba78f2[_0x3f6f03(0x1d6)](_0x3d2b7e=>_0x3d2b7e&&_0x3d2b7e[_0x3f6f03(0x1a8)]()['includes'](','))){let _0x1287c9=_0xba78f2['flatMap'](_0x37d07c=>_0x37d07c?_0x37d07c[_0x3f6f03(0x1a8)]()[_0x3f6f03(0x1cc)]()[_0x3f6f03(0x1c4)](/\s*,\s*/):[]);const _0x54b87e=_0x1287c9=_0x1287c9[_0x3f6f03(0x1cb)]((_0x9caf0a,_0x30e7fc,_0x5ae8a8)=>_0x30e7fc===_0x5ae8a8[_0x3f6f03(0x1db)](_0x50b8c4=>_0x9caf0a[_0x3f6f03(0x19b)]()===_0x50b8c4['toLowerCase']()));_0x1287c9[_0x3f6f03(0x1de)]>_0x54b87e[_0x3f6f03(0x1de)]&&_0x3f2501[_0x3f6f03(0x1b3)](_0x54b87e[_0x3f6f03(0x1de)],Math['ceil'](_0x3f2501[_0x3f6f03(0x1dc)](_0x1287c9['length'],0x2)))&&(_0x50d9f0[_0x3f6f03(0x1c5)]=UITypes[_0x3f6f03(0x1d0)],_0x50d9f0[_0x3f6f03(0x19d)]='\x27'+_0x54b87e[_0x3f6f03(0x1c6)](_0x3f2501['kDQMP'])+'\x27');}else{const _0x6cf7e5=_0xba78f2[_0x3f6f03(0x1ba)](_0x30e51d=>_0x30e51d[_0x3f6f03(0x1a8)]()['trim']())['filter']((_0x420d62,_0x8767f0,_0x199782)=>_0x8767f0===_0x199782[_0x3f6f03(0x1db)](_0x5adf26=>_0x420d62['toLowerCase']()===_0x5adf26[_0x3f6f03(0x19b)]()));_0xba78f2['length']>_0x6cf7e5[_0x3f6f03(0x1de)]&&_0x3f2501[_0x3f6f03(0x1b3)](_0x6cf7e5['length'],Math[_0x3f6f03(0x1ac)](_0x3f2501['rBOci'](_0xba78f2[_0x3f6f03(0x1de)],0x2)))&&(_0x50d9f0[_0x3f6f03(0x1c5)]=UITypes[_0x3f6f03(0x1d5)],_0x50d9f0[_0x3f6f03(0x19d)]='\x27'+_0x6cf7e5[_0x3f6f03(0x1c6)](_0x3f6f03(0x1c8))+'\x27');}}}}else{if(_0x3f2501['PPOPQ'](_0x50d9f0[_0x3f6f03(0x1c5)],UITypes[_0x3f6f03(0x1d9)]))_0x4a02e8[_0x3f6f03(0x1d4)](0x1,this[_0x3f6f03(0x1a1)][_0x3f6f03(0x1c0)])[_0x3f6f03(0x1d6)](_0x1bfd60=>{const _0x1d5bb8=_0x3f6f03;return _0x1bfd60&&_0x1bfd60[_0x503b20]&&_0x3f2501[_0x1d5bb8(0x1d7)](parseInt(+_0x1bfd60[_0x503b20]),+_0x1bfd60[_0x503b20]);})&&(_0x50d9f0[_0x3f6f03(0x1c5)]=UITypes['Decimal']),_0x4a02e8[_0x3f6f03(0x1d4)](0x1,this[_0x3f6f03(0x1a1)][_0x3f6f03(0x1c0)])['every']((_0x4de21e,_0x24deac)=>{const _0xedb3a3=_0x3f6f03,_0x40d7a1=_0x37d045[_0xedb3a3(0x1a0)]['encode_cell']({'c':_0x45b34e['s']['c']+_0x503b20,'r':_0x3f2501[_0xedb3a3(0x1a7)](_0x24deac,_0x4af5c8)}),_0x5c35a3=_0x1ad1b0[_0x40d7a1];return!_0x5c35a3||_0x5c35a3['w']&&_0x5c35a3['w'][_0xedb3a3(0x1d8)]('$');})&&(_0x3f2501[_0x3f6f03(0x1b1)](_0x3f6f03(0x1d2),_0x3f2501[_0x3f6f03(0x1b7)])?_0x1a609d[_0x3f6f03(0x1c5)]=_0x461e4c[_0x3f6f03(0x1a5)]:_0x50d9f0['uidt']=UITypes['Currency']);else _0x50d9f0[_0x3f6f03(0x1c5)]===UITypes['DateTime']&&(_0x3f6f03(0x1c2)===_0x3f6f03(0x1c2)?_0x4a02e8[_0x3f6f03(0x1d4)](0x1,this[_0x3f6f03(0x1a1)][_0x3f6f03(0x1c0)])[_0x3f6f03(0x19f)]((_0x44a8bc,_0x160b9b)=>{const _0x35c150=_0x3f6f03,_0x16eb33=_0x37d045[_0x35c150(0x1a0)][_0x35c150(0x1d1)]({'c':_0x45b34e['s']['c']+_0x503b20,'r':_0x3f2501[_0x35c150(0x1a7)](_0x160b9b,_0x4af5c8)}),_0x4ac0d4=_0x1ad1b0[_0x16eb33];return!_0x4ac0d4||_0x4ac0d4['w']&&_0x3f2501[_0x35c150(0x191)](_0x4ac0d4['w'][_0x35c150(0x1c4)]('\x20')[_0x35c150(0x1de)],0x1);})&&(_0x50d9f0['uidt']=UITypes[_0x3f6f03(0x1a5)]):(_0x1b801e['uidt']=_0x3e0f00[_0x3f6f03(0x1d5)],_0x23d79e['dtxp']='\x27'+_0x26f66f[_0x3f6f03(0x1c6)]('\x27,\x27')+'\x27'));}}let _0x263232=0x0;for(const _0x41c4bb of _0x4a02e8[_0x3f6f03(0x1d4)](0x1)){if(_0x3f6f03(0x19c)===_0x3f6f03(0x19c)){const _0x2a7c5a={};for(let _0x1b5be4=0x0;_0x1b5be4<_0x46c581['columns']['length'];_0x1b5be4++){if(_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1c5)]===UITypes['Checkbox'])_0x2a7c5a[_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1a6)]]=getCheckboxValue(_0x41c4bb[_0x1b5be4]);else{if(_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1c5)]===UITypes[_0x3f6f03(0x1af)]){const _0x89547=_0x37d045[_0x3f6f03(0x1a0)]['encode_cell']({'c':_0x3f2501['tOjQK'](_0x45b34e['s']['c'],_0x1b5be4),'r':_0x3f2501['oIEXC'](_0x263232,_0x4af5c8)}),_0x20de87=_0x1ad1b0[_0x89547];_0x2a7c5a[_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1a6)]]=_0x20de87&&_0x20de87['w']&&_0x20de87['w'][_0x3f6f03(0x195)](/[^\d.]+/g,'')||_0x41c4bb[_0x1b5be4];}else _0x46c581['columns'][_0x1b5be4][_0x3f6f03(0x1c5)]===UITypes[_0x3f6f03(0x1d5)]||_0x3f2501[_0x3f6f03(0x1e5)](_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1c5)],UITypes['MultiSelect'])?_0x2a7c5a[_0x46c581['columns'][_0x1b5be4][_0x3f6f03(0x1a6)]]=(_0x41c4bb[_0x1b5be4]||'')[_0x3f6f03(0x1a8)]()['trim']()||null:_0x2a7c5a[_0x46c581[_0x3f6f03(0x1d3)][_0x1b5be4][_0x3f6f03(0x1a6)]]=_0x41c4bb[_0x1b5be4];}}this[_0x3f6f03(0x19e)][_0x25f2c6][_0x3f6f03(0x199)](_0x2a7c5a),_0x263232++;}else _0x54633d[_0x3f6f03(0x1c5)]=_0x286fc2[_0x3f6f03(0x1b6)];}this['project'][_0x3f6f03(0x1b2)][_0x3f6f03(0x199)](_0x46c581);}}['getTemplate'](){return this['project'];}[_0x561201(0x1ae)](){const _0x161719=_0x561201;return this[_0x161719(0x19e)];}}