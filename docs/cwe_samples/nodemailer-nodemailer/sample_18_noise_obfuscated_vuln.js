function _0x286f(_0x175c53,_0x46913c){const _0x3fa2f7=_0x3fa2();return _0x286f=function(_0x286fc4,_0x576c7b){_0x286fc4=_0x286fc4-0x192;let _0x151974=_0x3fa2f7[_0x286fc4];return _0x151974;},_0x286f(_0x175c53,_0x46913c);}const _0x8825d6=_0x286f;(function(_0x7cfc65,_0x28151b){const _0x2858a7=_0x286f,_0x2240ef=_0x7cfc65();while(!![]){try{const _0x13bf78=-parseInt(_0x2858a7(0x1c0))/0x1*(-parseInt(_0x2858a7(0x1c6))/0x2)+parseInt(_0x2858a7(0x1ce))/0x3+parseInt(_0x2858a7(0x1a0))/0x4*(parseInt(_0x2858a7(0x19a))/0x5)+-parseInt(_0x2858a7(0x1d0))/0x6*(-parseInt(_0x2858a7(0x1bc))/0x7)+-parseInt(_0x2858a7(0x1a9))/0x8+-parseInt(_0x2858a7(0x1b0))/0x9*(-parseInt(_0x2858a7(0x1a1))/0xa)+-parseInt(_0x2858a7(0x1af))/0xb*(parseInt(_0x2858a7(0x1a3))/0xc);if(_0x13bf78===_0x28151b)break;else _0x2240ef['push'](_0x2240ef['shift']());}catch(_0x9107c2){_0x2240ef['push'](_0x2240ef['shift']());}}}(_0x3fa2,0xbfcf1));function _0x3fa2(){const _0x540a59=['CGAts','OQQDr','invalid_sequence_number','22NMMPKP','13955427pjwTpJ','mRkTr','ZOJav','corrupted_message_error','.log','drWUl','node-opcua-debug','feed','setSecurity','dBtwD','OeKZg','ETxxh','167839gLehRB','should','zeSEa','bXNva','217daDMyl','full_message_body','BJTLi','error','make_debugLog','sEnJT','12406VBUKZO','eql','MessageBuilder','InRrX','should\x20not\x20get\x20there','XwndX','invalid_message','LGHnT','615210HbFmmS','node-opcua-debug/nodeJS','162hhIves','random_packet','should\x20raise\x20a\x20error\x20event\x20if\x20a\x20HEL\x20or\x20ACK\x20packet\x20is\x20fed\x20instead\x20of\x20a\x20MSG\x20packet\x20','log','should\x20emit\x20a\x20\x27invalid_sequence_number\x27\x20event\x20if\x20a\x20message\x20does\x20not\x20have\x20a\x201-increased\x20sequence\x20number','jdiqA','JkTMq','message','should\x20raise\x20an\x20error\x20if\x20the\x20embedded\x20object\x20id\x20is\x20not\x20known','sytvf','node-opcua-transport/dist/test-fixtures','BDZbt','130lpQKxN','equal','Mysgg','uilIP','openChannelRequest1','OdOBU','4388iThXWa','10WzcmKi','Wfrsk','8937444egLxBg','writeUInt8','jvNiO','Basic256','IZpYh','Sign','12019216vxowKr','helloMessage1','zSPBA'];_0x3fa2=function(){return _0x540a59;};return _0x3fa2();}const should=require(_0x8825d6(0x1bd)),packets=require(_0x8825d6(0x198)),{redirectToFile}=require(_0x8825d6(0x1cf)),debugLog=require(_0x8825d6(0x1b6))[_0x8825d6(0x1c4)](__filename),{MessageBuilder}=require('..'),{SecurityPolicy,MessageSecurityMode}=require('..');describe(_0x8825d6(0x1c8),function(){const _0x5f26f5=_0x8825d6,_0x1fdeae={'dBtwD':function(_0x28e0a5){return _0x28e0a5();},'sEnJT':_0x5f26f5(0x1ae),'grpKQ':_0x5f26f5(0x194),'BJTLi':_0x5f26f5(0x1cc),'AbWKj':function(_0x57bcb7,_0x463b27,_0x4c7edf,_0x2bac07){return _0x57bcb7(_0x463b27,_0x4c7edf,_0x2bac07);},'mRkTr':function(_0x1b6919,_0x3c3446){return _0x1b6919+_0x3c3446;},'LGHnT':function(_0x1abe9b,_0x281af4){return _0x1abe9b+_0x281af4;},'zeSEa':'bad_object_id_error','OQQDr':function(_0x37f904,_0xc621ff,_0x533f3d,_0x544f8e,_0x40eb1c){return _0x37f904(_0xc621ff,_0x533f3d,_0x544f8e,_0x40eb1c);},'zSPBA':_0x5f26f5(0x1b3),'jdiqA':function(_0x397c20,_0xdba945){return _0x397c20(_0xdba945);},'jvNiO':_0x5f26f5(0x195),'DERNH':_0x5f26f5(0x1c3),'OeKZg':function(_0x2a626a){return _0x2a626a();},'LnNSD':function(_0x1e01f3){return _0x1e01f3();},'XwndX':function(_0x5c333f,_0x258933){return _0x5c333f===_0x258933;},'uilIP':function(_0x33e86a,_0xe7b478,_0x18b9e2){return _0x33e86a(_0xe7b478,_0x18b9e2);},'lRUNg':_0x5f26f5(0x1d2),'ZOJav':function(_0x40dc9e,_0x1ef180,_0x52de94){return _0x40dc9e(_0x1ef180,_0x52de94);},'BDZbt':_0x5f26f5(0x196),'IZpYh':'some\x20random\x20packet\x20-\x20encrypted\x20'};_0x1fdeae[_0x5f26f5(0x19d)](it,_0x1fdeae['lRUNg'],function(_0x148ee2){const _0x579500=_0x5f26f5,_0x72c47b=new MessageBuilder();let _0x5690c4=![],_0xe3f2a3=![];_0x72c47b['on'](_0x579500(0x195),_0xbf8d78=>{_0xe3f2a3=!![];})['on'](_0x579500(0x1c1),_0x32413b=>{_0x5690c4=!![];})['on'](_0x579500(0x1c3),_0xc43b48=>{const _0x15adf3=_0x579500;_0xc43b48[_0x15adf3(0x1bd)]['be']['instanceOf'](Error),_0xe3f2a3[_0x15adf3(0x1bd)]['equal'](![]),_0x5690c4[_0x15adf3(0x1bd)][_0x15adf3(0x19b)](!![]),_0x1fdeae[_0x15adf3(0x1b9)](_0x148ee2);}),_0x72c47b[_0x579500(0x1b7)](packets[_0x579500(0x1aa)]);});function _0xa6116e(_0x2aba0e,_0x3eca3d,_0x1e198b,_0xf4522d){const _0x5327d3=_0x5f26f5,_0x4222c5={'Mysgg':_0x5327d3(0x1c3),'NLJhd':_0x1fdeae[_0x5327d3(0x1c5)],'drWUl':_0x5327d3(0x1ca),'Wfrsk':_0x1fdeae['grpKQ'],'bXNva':'full_message_body','OdOBU':_0x1fdeae[_0x5327d3(0x1c2)]};_0x1fdeae['AbWKj'](redirectToFile,_0x1fdeae[_0x5327d3(0x1b1)](_0x1fdeae[_0x5327d3(0x1cd)]('MessageBuilder_',_0x2aba0e),_0x5327d3(0x1b4)),()=>{const _0x1f12c6=_0x5327d3,_0x3e67f6={'Pgvvn':function(_0x5b90d2){return _0x5b90d2();},'Vyuna':_0x4222c5[_0x1f12c6(0x1b5)]};if(_0x4222c5[_0x1f12c6(0x1a2)]!==_0x1f12c6(0x197)){const _0x3de8d1=new MessageBuilder();let _0x25589b=![],_0x2704e1=![];_0x3de8d1['on']('message',_0x254dbd=>{_0x2704e1=!![];})['on'](_0x4222c5[_0x1f12c6(0x1bf)],_0x539d37=>{_0x25589b=!![];})['on'](_0x4222c5[_0x1f12c6(0x19f)],_0x445ae8=>{const _0x5ba7c6=_0x1f12c6;_0x1e198b['should']['eql'](![]),_0x2704e1[_0x5ba7c6(0x1bd)][_0x5ba7c6(0x19b)](![]),_0x25589b['should']['equal'](!![]),_0xf4522d();})['on'](_0x4222c5[_0x1f12c6(0x19c)],_0x380da7=>{const _0x43bcf4=_0x1f12c6;_0x380da7[_0x43bcf4(0x1bd)]['be']['instanceOf'](Error),_0x1e198b[_0x43bcf4(0x1bd)][_0x43bcf4(0x1c7)](!![]),_0x3e67f6['Pgvvn'](_0xf4522d);}),_0x3de8d1[_0x1f12c6(0x1b7)](_0x3eca3d);}else{const _0x125707=new _0x1745f1({});_0x125707[_0x1f12c6(0x1b8)](_0x72af70[_0x1f12c6(0x1a8)],_0x2522f9[_0x1f12c6(0x1a6)]),_0x125707['on'](_0x1f12c6(0x195),_0x33c25d=>{})['on'](_0x4222c5[_0x1f12c6(0x19c)],_0x254da5=>{_0x31b4a6['log'](_0x254da5),_0x227f27();})['on'](_0x4222c5['NLJhd'],function(_0x4ea51d,_0x24d87d){_0x239d56(new _0x5794cc(_0x3e67f6['Vyuna']));}),_0x125707[_0x1f12c6(0x1b7)](_0xef1543[_0x1f12c6(0x1d1)]);}},function(){});}_0x1fdeae[_0x5f26f5(0x1b2)](it,_0x1fdeae[_0x5f26f5(0x199)],function(_0x15d79f){const _0xc602d=_0x5f26f5,_0x4b893f=Buffer['from'](packets[_0xc602d(0x19e)]);_0x4b893f[_0xc602d(0x1a4)](0xff,0x50),_0x4b893f[_0xc602d(0x1a4)](0xff,0x51),_0x4b893f['writeUInt8'](0xff,0x52),_0xa6116e(_0x1fdeae[_0xc602d(0x1be)],_0x4b893f,!![],_0x15d79f);}),_0x1fdeae[_0x5f26f5(0x1b2)](it,'should\x20raise\x20an\x20invalid_message\x20if\x20the\x20embedded\x20object\x20failed\x20to\x20be\x20decoded',function(_0x12e71b){const _0x5e4b65=_0x5f26f5,_0x9e95b4=Buffer['from'](packets['openChannelRequest1']);_0x9e95b4[_0x5e4b65(0x1a4)](0xa,0x65),_0x9e95b4[_0x5e4b65(0x1a4)](0xb,0x66),_0x9e95b4[_0x5e4b65(0x1a4)](0xff,0x67),_0x1fdeae[_0x5e4b65(0x1ad)](_0xa6116e,_0x1fdeae[_0x5e4b65(0x1ab)],_0x9e95b4,![],_0x12e71b);}),it(_0x5f26f5(0x192),function(_0x5afb5a){const _0x1c3db0=_0x5f26f5,_0x4bcc27=new MessageBuilder();_0x4bcc27['on'](_0x1fdeae['jvNiO'],_0x4afa41=>{})['on'](_0x1fdeae['DERNH'],_0x3a7c40=>{const _0x2924d2=_0x286f;console[_0x2924d2(0x1d3)](_0x3a7c40),_0x1fdeae[_0x2924d2(0x193)](_0x5afb5a,Error(_0x2924d2(0x1ca)));})['on'](_0x1c3db0(0x1ae),function(_0x53fc69,_0x9e2ce){_0x5afb5a();}),_0x4bcc27[_0x1c3db0(0x1b7)](packets[_0x1c3db0(0x19e)]),_0x4bcc27['feed'](packets[_0x1c3db0(0x19e)]);}),it(_0x1fdeae[_0x5f26f5(0x1a7)],_0x33047f=>{const _0x54d1f2=_0x5f26f5,_0x1a78e0={'ETxxh':function(_0x43513f){return _0x1fdeae['LnNSD'](_0x43513f);},'CGAts':function(_0x251471,_0x1ed59d){const _0xaacf8=_0x286f;return _0x1fdeae[_0xaacf8(0x193)](_0x251471,_0x1ed59d);},'ULwkg':_0x54d1f2(0x1ca)};if(_0x1fdeae[_0x54d1f2(0x1cb)](_0x54d1f2(0x1c9),_0x54d1f2(0x1c9))){const _0x545cdf=new MessageBuilder({});_0x545cdf[_0x54d1f2(0x1b8)](MessageSecurityMode[_0x54d1f2(0x1a8)],SecurityPolicy[_0x54d1f2(0x1a6)]),_0x545cdf['on'](_0x1fdeae[_0x54d1f2(0x1a5)],_0x412244=>{})['on'](_0x54d1f2(0x1c3),_0x569d33=>{const _0x595be0=_0x54d1f2;console[_0x595be0(0x1d3)](_0x569d33),_0x1a78e0[_0x595be0(0x1bb)](_0x33047f);})['on'](_0x1fdeae[_0x54d1f2(0x1c5)],function(_0x227e41,_0x389fc2){const _0x4b7f55=_0x54d1f2;_0x1a78e0[_0x4b7f55(0x1ac)](_0x33047f,new Error(_0x1a78e0['ULwkg']));}),_0x545cdf[_0x54d1f2(0x1b7)](packets[_0x54d1f2(0x1d1)]);}else _0x53792d[_0x54d1f2(0x1bd)]['be']['instanceOf'](_0x23cb13),_0x420687['should']['equal'](![]),_0x273535[_0x54d1f2(0x1bd)]['equal'](!![]),_0x1fdeae[_0x54d1f2(0x1ba)](_0x4cd7f8);});});