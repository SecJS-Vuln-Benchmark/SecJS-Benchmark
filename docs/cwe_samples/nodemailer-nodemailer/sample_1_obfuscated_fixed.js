const _0x5ba463=_0x4df2;(function(_0x36627d,_0x15828a){const _0x13d36d=_0x4df2,_0x20fc91=_0x36627d();while(!![]){try{const _0x51e901=-parseInt(_0x13d36d(0x169))/0x1+parseInt(_0x13d36d(0x134))/0x2+-parseInt(_0x13d36d(0x15f))/0x3+-parseInt(_0x13d36d(0x162))/0x4+parseInt(_0x13d36d(0x152))/0x5*(-parseInt(_0x13d36d(0x13f))/0x6)+-parseInt(_0x13d36d(0x150))/0x7+parseInt(_0x13d36d(0x16b))/0x8;if(_0x51e901===_0x15828a)break;else _0x20fc91['push'](_0x20fc91['shift']());}catch(_0x5ce11d){_0x20fc91['push'](_0x20fc91['shift']());}}}(_0x1c70,0xb9d66));import _0x1e5474 from'xlsx';function _0x4df2(_0x3e771d,_0x481a15){const _0x1c705d=_0x1c70();return _0x4df2=function(_0x4df240,_0x5ea071){_0x4df240=_0x4df240-0x114;let _0x1b2e9a=_0x1c705d[_0x4df240];return _0x1b2e9a;},_0x4df2(_0x3e771d,_0x481a15);}import{UITypes}from'~/components/project/spreadsheet/helpers/uiTypes';import _0x388842 from'~/components/import/templateParsers/TemplateGenerator';import{getCheckboxValue,isCheckboxType}from'~/components/import/templateParsers/parserHelpers';function _0x1c70(){const _0x23ab81=['push','includes','decode_range','toString','every','gCvKj','vqHse','join','MultiSelect','tables','getTime','split','iZhiK','maxRowsToParse','aVYuZ','SingleSelect','2161798jypmjn','FErdi','parse_date_code','GQGpj','array','eNBJi','excelData','Sheets','SheetNames','map','MkepV','18XZrVWD','data','column_name','filter','YOLJv','MlGUi','replace','xGOyx','SingleLineText','TNlul','parse','ZArQT','config','xApRO','SSF','toLowerCase','jipAf','2901521nIQdYO','YjSRe','944315ajGoPQ','\x27,\x27','jCJrk','getData','findIndex','uJEBT','Decimal','read','Number','JbOQI','init','mxnxZ','ExNpd','1733115vBmXJh','EcECA','match','701232LjUaSE','sheet_to_json','string','KaOIp','ceil','WBProps','emLnb','1445940RMzjnO','columns','22882688WzdrRq','utils','QnVOL','eigSi','ZcVUS','trim','flatMap','slice','some','khlFZ','name','project','getTimezoneOffset','uidt','dtxp','hDscu','length','csv','bNVCl','HLaWO','getTemplate','DateTime','FLVLl','encode_cell','Currency'];_0x1c70=function(){return _0x23ab81;};return _0x1c70();}const excelTypeToUidt={'d':UITypes[_0x5ba463(0x120)],'b':UITypes['Checkbox'],'n':UITypes['Number'],'s':UITypes[_0x5ba463(0x147)]};export default class ExcelTemplateAdapter extends _0x388842{constructor(_0x4807da,_0xa0b716,_0x2e1ea3={}){const _0x12a72b=_0x5ba463;super(),this[_0x12a72b(0x14b)]={'maxRowsToParse':0x1f4,..._0x2e1ea3},this[_0x12a72b(0x115)]=_0x4807da,this[_0x12a72b(0x13a)]=_0xa0b716,this[_0x12a72b(0x116)]={'title':this['name'],'tables':[]},this[_0x12a72b(0x140)]={};}async[_0x5ba463(0x15c)](){const _0x448eac=_0x5ba463;this['wb']=_0x1e5474[_0x448eac(0x159)](new Uint8Array(this[_0x448eac(0x13a)]),{'type':_0x448eac(0x138),'cellText':!![],'cellDates':!![]});}[_0x5ba463(0x149)](){const _0xca392=_0x5ba463,_0x2836f8={'JbOQI':function(_0x2c2b70,_0x1634b1){return _0x2c2b70-_0x1634b1;},'bNVCl':function(_0x3cf32e,_0x183117){return _0x3cf32e instanceof _0x183117;},'mxnxZ':function(_0x2dd788,_0x78b055){return _0x2dd788(_0x78b055);},'iZhiK':function(_0x545ac0,_0x3d0765){return _0x545ac0<=_0x3d0765;},'gUGuE':_0xca392(0x153),'FLVLl':function(_0x4c3658,_0x348cc2){return _0x4c3658+_0x348cc2;},'GQGpj':function(_0x508bf4,_0x257ebf){return _0x508bf4<_0x257ebf;},'khlFZ':function(_0x25964b,_0x193af8){return _0x25964b||_0x193af8;},'YjSRe':'table','HLaWO':function(_0x4ac876,_0x3f468e){return _0x4ac876 in _0x3f468e;},'TNlul':_0xca392(0x16f),'xApRO':'!ref','gCvKj':_0xca392(0x11c),'wvcTU':function(_0x550881,_0x173a26){return _0x550881+_0x173a26;},'KaOIp':function(_0x4adf6d,_0x5b147d){return _0x4adf6d*_0x5b147d;},'aVYuZ':function(_0x2230e4,_0x3888bd){return _0x2230e4*_0x3888bd;},'ExNpd':function(_0x500611,_0x88bbb1){return _0x500611===_0x88bbb1;},'eNBJi':function(_0x4fd27d,_0x344c25){return _0x4fd27d>_0x344c25;},'QnVOL':function(_0x1b348a,_0x146c1f){return _0x1b348a/_0x146c1f;},'jipAf':function(_0x1e03d3,_0x22ed19){return _0x1e03d3===_0x22ed19;},'vqHse':function(_0x53ed84,_0x3b57e0){return _0x53ed84>_0x3b57e0;},'YOLJv':_0xca392(0x11a),'MlGUi':function(_0x5d8483,_0x3818a0){return _0x5d8483===_0x3818a0;},'FErdi':function(_0x33d56d,_0xb85f83){return _0x33d56d(_0xb85f83);},'jCJrk':function(_0x312a99,_0x46f339){return _0x312a99===_0x46f339;}},_0x13ecf9={};for(let _0x15f097=0x0;_0x2836f8[_0xca392(0x137)](_0x15f097,this['wb']['SheetNames'][_0xca392(0x11b)]);_0x15f097++){const _0xaf7aad={'id':0x0},_0x290b14=this['wb'][_0xca392(0x13c)][_0x15f097];let _0x433869=_0x2836f8[_0xca392(0x114)](_0x290b14,_0x2836f8[_0xca392(0x151)])[_0xca392(0x145)](/\W/g,'_')['trim']();while(_0x2836f8[_0xca392(0x11e)](_0x433869,_0x13ecf9)){_0xca392(0x16f)===_0x2836f8[_0xca392(0x148)]?_0x433869=''+_0x433869+ ++_0x13ecf9[_0x433869]:_0x11c9bc[_0xca392(0x118)]=_0x15cf37['LongText'];}_0x13ecf9[_0x433869]=0x0;const _0xd78c2d={'table_name':_0x433869,'ref_table_name':_0x433869,'columns':[]};this[_0xca392(0x140)][_0x433869]=[];const _0x4045b6=this['wb'][_0xca392(0x13b)][_0x290b14],_0x48aabb=_0x1e5474[_0xca392(0x16c)][_0xca392(0x126)](_0x4045b6[_0x2836f8[_0xca392(0x14c)]]),_0x141199=_0x1e5474[_0xca392(0x16c)][_0xca392(0x163)](_0x4045b6,{'header':0x1,'blankrows':![],'cellDates':!![],'defval':null});if(this[_0xca392(0x115)][_0xca392(0x172)](-0x3)!==_0x2836f8[_0xca392(0x129)]){const _0x4b60ea=new Date(0x76b,0xb,0x1e,0x0,0x0,0x0),_0x3ccac6=_0x2836f8['wvcTU'](_0x4b60ea[_0xca392(0x12e)](),_0x2836f8[_0xca392(0x165)](new Date()[_0xca392(0x117)]()-_0x4b60ea[_0xca392(0x117)](),0xea60)),_0x41f324=_0x2836f8[_0xca392(0x165)](_0x2836f8[_0xca392(0x165)](_0x2836f8[_0xca392(0x132)](0x18,0x3c),0x3c),0x3e8),_0x4fbf24=_0x2f2c7a=>{const _0x2886b4=_0xca392,_0x2aef38=_0x1e5474[_0x2886b4(0x14d)][_0x2886b4(0x136)](_0x2836f8[_0x2886b4(0x15b)](_0x2f2c7a[_0x2886b4(0x12e)](),_0x3ccac6)/_0x41f324,{'date1904':this['wb']['Workbook'][_0x2886b4(0x167)]['date1904']});return new Date(_0x2aef38['y'],_0x2aef38['m'],_0x2aef38['d'],_0x2aef38['H'],_0x2aef38['M'],_0x2aef38['S']);};_0x141199=_0x141199[_0xca392(0x13d)](_0x5b7e2e=>_0x5b7e2e[_0xca392(0x13d)](_0x5623da=>{const _0x647e66=_0xca392;return _0x2836f8[_0x647e66(0x11d)](_0x5623da,Date)?_0x2836f8['mxnxZ'](_0x4fbf24,_0x5623da):_0x5623da;}));}const _0x5f397b=+_0x141199[0x0][_0xca392(0x128)](_0x370590=>_0x370590===null||typeof _0x370590===_0xca392(0x164));for(let _0x17a465=0x0;_0x2836f8[_0xca392(0x137)](_0x17a465,_0x141199[0x0]['length']);_0x17a465++){let _0x3c25c2=(_0x5f397b&&_0x141199[0x0]&&_0x141199[0x0][_0x17a465]&&_0x141199[0x0][_0x17a465][_0xca392(0x127)]()[_0xca392(0x170)]()||'field_'+(_0x17a465+0x1))['replace'](/\W/g,'_')[_0xca392(0x170)]();while(_0x3c25c2 in _0xaf7aad){_0x3c25c2=''+_0x3c25c2+ ++_0xaf7aad[_0x3c25c2];}_0xaf7aad[_0x3c25c2]=0x0;const _0xadfa64={'column_name':_0x3c25c2,'ref_column_name':_0x3c25c2};_0xd78c2d[_0xca392(0x16a)][_0xca392(0x124)](_0xadfa64);const _0x231d69=_0x1e5474[_0xca392(0x16c)][_0xca392(0x122)]({'c':_0x48aabb['s']['c']+_0x17a465,'r':_0x5f397b}),_0x1246f7=_0x4045b6[_0x231d69]||{};_0xadfa64['uidt']=excelTypeToUidt[_0x1246f7['t']]||UITypes[_0xca392(0x147)];if(_0xadfa64[_0xca392(0x118)]===UITypes[_0xca392(0x147)]){if(_0x141199[_0xca392(0x173)](_0x1c7397=>(_0x1c7397[_0x17a465]||'')[_0xca392(0x127)]()[_0xca392(0x161)](/[\r\n]/)||(_0x1c7397[_0x17a465]||'')[_0xca392(0x127)]()[_0xca392(0x11b)]>0xff))_0xadfa64[_0xca392(0x118)]=UITypes['LongText'];else{const _0x2ed67a=_0x141199[_0xca392(0x172)](_0x5f397b?0x1:0x0)[_0xca392(0x13d)](_0x5a976e=>_0x5a976e[_0x17a465])['filter'](_0x460246=>_0x460246!==null&&_0x460246!==undefined&&_0x460246[_0xca392(0x127)]()[_0xca392(0x170)]()!==''),_0x31b002=_0x2836f8[_0xca392(0x15d)](isCheckboxType,_0x2ed67a);if(_0x2836f8[_0xca392(0x15e)](_0x31b002[_0xca392(0x11b)],0x1))_0xadfa64[_0xca392(0x118)]=UITypes['Checkbox'];else{if(_0x2ed67a[_0xca392(0x173)](_0x31100f=>_0x31100f&&_0x31100f[_0xca392(0x127)]()[_0xca392(0x125)](','))){let _0x5d6533=_0x2ed67a[_0xca392(0x171)](_0xf50a85=>_0xf50a85?_0xf50a85[_0xca392(0x127)]()[_0xca392(0x170)]()[_0xca392(0x12f)](/\s*,\s*/):[]);const _0x5d7d4c=_0x5d6533=_0x5d6533[_0xca392(0x142)]((_0x3ec8b4,_0xa149d0,_0x4687e6)=>_0xa149d0===_0x4687e6[_0xca392(0x156)](_0xfd6fe6=>_0x3ec8b4[_0xca392(0x14e)]()===_0xfd6fe6[_0xca392(0x14e)]()));_0x2836f8[_0xca392(0x139)](_0x5d6533['length'],_0x5d7d4c[_0xca392(0x11b)])&&_0x5d7d4c[_0xca392(0x11b)]<=Math[_0xca392(0x166)](_0x2836f8[_0xca392(0x16d)](_0x5d6533[_0xca392(0x11b)],0x2))&&(_0xadfa64[_0xca392(0x118)]=UITypes[_0xca392(0x12c)],_0xadfa64['dtxp']='\x27'+_0x5d7d4c[_0xca392(0x12b)](_0xca392(0x153))+'\x27');}else{if(_0x2836f8[_0xca392(0x14f)](_0xca392(0x16e),_0xca392(0x146)))_0x3c5a00[_0xca392(0x118)]=_0x28143f[_0xca392(0x12c)],_0x4d135c[_0xca392(0x119)]='\x27'+_0x5cd4ad[_0xca392(0x12b)](_0xca392(0x153))+'\x27';else{const _0x20cc7e=_0x2ed67a[_0xca392(0x13d)](_0x3e4ee1=>_0x3e4ee1[_0xca392(0x127)]()[_0xca392(0x170)]())['filter']((_0x1230f8,_0x123e13,_0x1119be)=>_0x123e13===_0x1119be[_0xca392(0x156)](_0x3b8a3d=>_0x1230f8[_0xca392(0x14e)]()===_0x3b8a3d[_0xca392(0x14e)]()));_0x2836f8[_0xca392(0x12a)](_0x2ed67a[_0xca392(0x11b)],_0x20cc7e[_0xca392(0x11b)])&&_0x2836f8['iZhiK'](_0x20cc7e[_0xca392(0x11b)],Math[_0xca392(0x166)](_0x2ed67a[_0xca392(0x11b)]/0x2))&&(_0xadfa64[_0xca392(0x118)]=UITypes[_0xca392(0x133)],_0xadfa64['dtxp']='\x27'+_0x20cc7e['join'](_0xca392(0x153))+'\x27');}}}}}else{if(_0x2836f8[_0xca392(0x14f)](_0xadfa64[_0xca392(0x118)],UITypes[_0xca392(0x15a)]))_0x141199['slice'](0x1,this[_0xca392(0x14b)][_0xca392(0x131)])[_0xca392(0x173)](_0x327ccb=>{return _0x327ccb&&_0x327ccb[_0x17a465]&&_0x2836f8['mxnxZ'](parseInt,+_0x327ccb[_0x17a465])!==+_0x327ccb[_0x17a465];})&&(_0xadfa64['uidt']=UITypes[_0xca392(0x158)]),_0x141199[_0xca392(0x172)](0x1,this[_0xca392(0x14b)][_0xca392(0x131)])[_0xca392(0x128)]((_0x32ac37,_0x45aa9b)=>{const _0x2ed06b=_0xca392,_0x43339e={'zMHWI':function(_0x3b4d24,_0xc61a33){return _0x3b4d24>_0xc61a33;},'EcECA':function(_0x3855f0,_0x190fe1){const _0x216524=_0x4df2;return _0x2836f8[_0x216524(0x130)](_0x3855f0,_0x190fe1);},'MkepV':function(_0x3a9736,_0x377ee9){return _0x3a9736/_0x377ee9;},'emLnb':_0x2836f8['gUGuE']};if(_0x2ed06b(0x157)==='hDpvm'){const _0x4ee1e6=_0x482850[_0x2ed06b(0x13d)](_0x12468a=>_0x12468a[_0x2ed06b(0x127)]()[_0x2ed06b(0x170)]())[_0x2ed06b(0x142)]((_0x30b013,_0x1f5ea3,_0x537e17)=>_0x1f5ea3===_0x537e17[_0x2ed06b(0x156)](_0x1d7a8e=>_0x30b013[_0x2ed06b(0x14e)]()===_0x1d7a8e['toLowerCase']()));_0x43339e['zMHWI'](_0x3bec69[_0x2ed06b(0x11b)],_0x4ee1e6[_0x2ed06b(0x11b)])&&_0x43339e[_0x2ed06b(0x160)](_0x4ee1e6[_0x2ed06b(0x11b)],_0x1c7c20[_0x2ed06b(0x166)](_0x43339e[_0x2ed06b(0x13e)](_0x3f2276['length'],0x2)))&&(_0x1a0cdb['uidt']=_0x2007e1[_0x2ed06b(0x133)],_0x1d1a78[_0x2ed06b(0x119)]='\x27'+_0x4ee1e6[_0x2ed06b(0x12b)](_0x43339e[_0x2ed06b(0x168)])+'\x27');}else{const _0x54bfd8=_0x1e5474[_0x2ed06b(0x16c)][_0x2ed06b(0x122)]({'c':_0x48aabb['s']['c']+_0x17a465,'r':_0x45aa9b+_0x5f397b}),_0x525533=_0x4045b6[_0x54bfd8];return!_0x525533||_0x525533['w']&&_0x525533['w']['startsWith']('$');}})&&(_0xadfa64['uidt']=UITypes['Currency']);else _0xadfa64[_0xca392(0x118)]===UITypes[_0xca392(0x120)]&&(_0x141199['slice'](0x1,this[_0xca392(0x14b)][_0xca392(0x131)])['every']((_0x4ab86d,_0x4abe11)=>{const _0x4f5dd6=_0xca392,_0x1aae10=_0x1e5474['utils']['encode_cell']({'c':_0x48aabb['s']['c']+_0x17a465,'r':_0x2836f8[_0x4f5dd6(0x121)](_0x4abe11,_0x5f397b)}),_0x49c1a9=_0x4045b6[_0x1aae10];return!_0x49c1a9||_0x49c1a9['w']&&_0x49c1a9['w']['split']('\x20')[_0x4f5dd6(0x11b)]===0x1;})&&(_0xadfa64[_0xca392(0x118)]=UITypes['Date']));}}let _0x26dd08=0x0;for(const _0x5bb425 of _0x141199[_0xca392(0x172)](0x1)){const _0x4c5ae9={};for(let _0xa42578=0x0;_0xa42578<_0xd78c2d[_0xca392(0x16a)][_0xca392(0x11b)];_0xa42578++){if(_0xca392(0x14a)!==_0x2836f8[_0xca392(0x143)]){if(_0x2836f8[_0xca392(0x144)](_0xd78c2d[_0xca392(0x16a)][_0xa42578][_0xca392(0x118)],UITypes['Checkbox']))_0x4c5ae9[_0xd78c2d[_0xca392(0x16a)][_0xa42578][_0xca392(0x141)]]=_0x2836f8[_0xca392(0x135)](getCheckboxValue,_0x5bb425[_0xa42578]);else{if(_0xd78c2d[_0xca392(0x16a)][_0xa42578][_0xca392(0x118)]===UITypes[_0xca392(0x123)]){const _0x38e61c=_0x1e5474[_0xca392(0x16c)][_0xca392(0x122)]({'c':_0x2836f8[_0xca392(0x121)](_0x48aabb['s']['c'],_0xa42578),'r':_0x2836f8[_0xca392(0x121)](_0x26dd08,_0x5f397b)}),_0x159258=_0x4045b6[_0x38e61c];_0x4c5ae9[_0xd78c2d[_0xca392(0x16a)][_0xa42578][_0xca392(0x141)]]=_0x159258&&_0x159258['w']&&_0x159258['w'][_0xca392(0x145)](/[^\d.]+/g,'')||_0x5bb425[_0xa42578];}else _0x2836f8[_0xca392(0x154)](_0xd78c2d['columns'][_0xa42578][_0xca392(0x118)],UITypes[_0xca392(0x133)])||_0xd78c2d[_0xca392(0x16a)][_0xa42578][_0xca392(0x118)]===UITypes[_0xca392(0x12c)]?_0x4c5ae9[_0xd78c2d['columns'][_0xa42578][_0xca392(0x141)]]=(_0x5bb425[_0xa42578]||'')[_0xca392(0x127)]()[_0xca392(0x170)]()||null:_0x4c5ae9[_0xd78c2d[_0xca392(0x16a)][_0xa42578]['column_name']]=_0x5bb425[_0xa42578];}}else _0x20c789[_0x1b5487[_0xca392(0x16a)][_0x379cfb]['column_name']]=_0xb773c5(_0x359e04[_0x5e5d0f]);}this[_0xca392(0x140)][_0x433869]['push'](_0x4c5ae9),_0x26dd08++;}this['project'][_0xca392(0x12d)][_0xca392(0x124)](_0xd78c2d);}}[_0x5ba463(0x11f)](){const _0x11b34f=_0x5ba463;return this[_0x11b34f(0x116)];}[_0x5ba463(0x155)](){const _0x2a6664=_0x5ba463;return this[_0x2a6664(0x140)];}}