'use strict';function _0x4d02(_0x3f8f4a,_0x3934dd){const _0x4623f1=_0x4623();return _0x4d02=function(_0x4d028a,_0x42c385){_0x4d028a=_0x4d028a-0x64;let _0x46ff40=_0x4623f1[_0x4d028a];return _0x46ff40;},_0x4d02(_0x3f8f4a,_0x3934dd);}const _0x1b9f56=_0x4d02;function _0x4623(){const _0x13b93e=['pushResponse','cyan','aXvoo','zqrZn','OOJog','should','YpYTQ','UCVbW','9fMgIks','TEST','BadProtocolVersionUnsupported','OPigR','match','QxGFx','containEql','vTzTc','uihyN','gIZIE','DpymB','close\x20event\x20shall\x20have\x20err===null,\x20when\x20disconnection\x20is\x20initiated\x20by\x20the\x20client\x20itself','spy','timeout','Should\x20have\x20raised\x20a\x20timeout\x20error','Mzrvq','aKaqp','bgWhite','description','KUIuT','AmKPD','6972dHitUG','bold','ZYlpr','transport.connect\x20should\x20have\x20raised\x20a\x20connection\x20error','ACK','efYiU','JnMbc','lOGJy','alloc','gMGVJ','284blqwXr','IGTPh','oMQAB','equal','Should\x20have\x20raised\x20a\x20connection\x20error','shutdown','opc.tcp://localhost:XXXXX/SomeAddress','MniUO','htCPp','dBXIq','testing\x20ClientTCP_transport','initialize','1|0|3|4|2','jzKoR','ERR','connect','TWkmr','1xIrhqk','mUKbf','TCS1\x20should\x20create\x20and\x20connect\x20to\x20a\x20client\x20TCP','AIaeV','CnZQm','hppjO','vUKFJ','11532xLzgqz','smbPJ','close\x20event\x20shall\x20only\x20be\x20received\x20once','0|4|2|5|1|3','17485bmNTXj','yUrHo','node-opcua-assert','should\x20report\x20an\x20error\x20if\x20the\x20server\x20reports\x20a\x20protocol\x20version\x20mismatch','pafFr','chunk','DwEJl','OoJye','copy','\x0acounter\x20=\x20','TMgVn','node-opcua-utils','writeUInt16BE','rXzzQ','write','sdJWM','XrNfA','node-opcua-status-code','split','end','2|1|0|3|4','KaQIL','225phCtnL','yellow','chalk','\x20UNWANTED\x20PACKET','red','node-opcua-debug','CusmX','\x20err\x20=\x20','the\x20close\x20event\x20should\x20pass\x20a\x20valid\x20Error\x20object\x20because\x20disconnection\x20is\x20caused\x20by\x20external\x20event','RvRmk','125006bmALOS','iqMef','dbDLt','OtAkw','AGiyT','expecting\x20one\x20of\x20those\x20error\x20message.\x20got:\x20','callCount','unexpected\x20data\x20received','4754420NjqLPX','vVaAx','EDFNO','message','jSqrK','7175652gHWmIv','CikqF','VDRTr','should\x20returns\x20an\x20error\x20if\x20url\x20has\x20invalid\x20port','ErXby','yUgOj','MSG','fLUKt','LfDQV','ayepJ','fhpTP','16578HNJwSe','close','kqvzH','connection_break','\x20Aborting\x20server\x20','var\x20x\x20=\x2042;\x20return\x20x;','EDoYx','qulUo','wDpnw','ALVRm','XTGOW','eql','tUMnj','exist','6184QHmtwi','GQsAM','6524REYnjv','jbSIM','DMJQm','mSSqB','lessThan','LRTNf','ICRKJ','should\x20report\x20an\x20error\x20if\x20the\x20server\x20close\x20the\x20socket\x20unexpectedly','enNhv','MBuAY','length','slice','should\x20close\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20disconnect()\x20is\x20called','Timeout','WKPTN','rCRZL','removeAllListeners','headerSize','huhbd','cZbfG','GzmtZ','disconnect'];_0x4623=function(){return _0x13b93e;};return _0x4623();}(function(_0x33ab54,_0x27e6e8){const _0x46f1ae=_0x4d02,_0x5d8a02=_0x33ab54();while(!![]){try{const _0x1893bf=-parseInt(_0x46f1ae(0xb6))/0x1*(parseInt(_0x46f1ae(0xe1))/0x2)+-parseInt(_0x46f1ae(0x9b))/0x3*(-parseInt(_0x46f1ae(0xa5))/0x4)+-parseInt(_0x46f1ae(0xd7))/0x5*(parseInt(_0x46f1ae(0xf9))/0x6)+parseInt(_0x46f1ae(0x68))/0x7*(-parseInt(_0x46f1ae(0x66))/0x8)+-parseInt(_0x46f1ae(0x86))/0x9*(-parseInt(_0x46f1ae(0xe9))/0xa)+-parseInt(_0x46f1ae(0xee))/0xb+parseInt(_0x46f1ae(0xbd))/0xc*(parseInt(_0x46f1ae(0xc1))/0xd);if(_0x1893bf===_0x27e6e8)break;else _0x5d8a02['push'](_0x5d8a02['shift']());}catch(_0x57f000){_0x5d8a02['push'](_0x5d8a02['shift']());}}}(_0x4623,0x5b289));const should=require(_0x1b9f56(0x83)),chalk=require(_0x1b9f56(0xd9)),sinon=require('sinon'),{assert}=require(_0x1b9f56(0xc3)),{hexDump}=require(_0x1b9f56(0xdc)),{make_debugLog,make_errorLog}=require(_0x1b9f56(0xdc)),{StatusCodes,StatusCode}=require(_0x1b9f56(0xd2)),{compare_buffers}=require(_0x1b9f56(0xcc)),debugLog=make_debugLog(_0x1b9f56(0x87)),errorLog=make_errorLog(_0x1b9f56(0x87)),{FakeServer}=require('../dist/test_helpers'),port=0x162e,{AcknowledgeMessage,TCPErrorMessage,ClientTCP_transport,packTcpMessage}=require('..'),{MessageBuilderBase,writeTCPMessageHeader}=require('..');describe(_0x1b9f56(0xaf),function(){const _0x51cc8c=_0x1b9f56,_0x2e0dcf={'DwEJl':_0x51cc8c(0xfa),'EDFNO':_0x51cc8c(0xb4),'vUKFJ':_0x51cc8c(0xfc),'ErXby':function(_0x51b71f,_0x3183a6){return _0x51b71f(_0x3183a6);},'cZbfG':function(_0x3675f5,_0x4cbee8,_0x5461a4){return _0x3675f5(_0x4cbee8,_0x5461a4);},'LRTNf':'ACK','rCRZL':_0x51cc8c(0xbf),'yUgOj':_0x51cc8c(0x91),'jSqrK':'bwIKf','AXAuv':_0x51cc8c(0x94),'aXvoo':function(_0x4dd8dc,_0x43a9e9){return _0x4dd8dc===_0x43a9e9;},'uihyN':_0x51cc8c(0xb7),'OtAkw':function(_0x12b95e,_0x1ca16a){return _0x12b95e(_0x1ca16a);},'TMgVn':function(_0x177582,_0x40bcfc){return _0x177582 instanceof _0x40bcfc;},'fhpTP':'updateClock();','ICRKJ':function(_0x46f17a,_0x3d5168,_0x554ff9){return _0x46f17a(_0x3d5168,_0x554ff9);},'KaQIL':_0x51cc8c(0x100),'ixZIH':function(_0x233beb,_0x1da79b){return _0x233beb(_0x1da79b);},'IGTPh':function(_0x5c61c6,_0x4526f7){return _0x5c61c6(_0x4526f7);},'AIaeV':_0x51cc8c(0xa1),'UCVbW':function(_0x4eab22,_0x15b29a){return _0x4eab22(_0x15b29a);},'vTzTc':_0x51cc8c(0xda),'sdJWM':function(_0x3255d1,_0x28b51a){return _0x3255d1!==_0x28b51a;},'huhbd':_0x51cc8c(0xea),'WKPTN':'ZgvxP','rXzzQ':function(_0x3c5931){return _0x3c5931();},'GuVOd':_0x51cc8c(0x9e),'OoJye':function(_0x3b4bc0,_0x12546c){return _0x3b4bc0(_0x12546c);},'XTGOW':_0x51cc8c(0xf4),'MBuAY':function(_0x45eaef,_0x1ae1e9,_0xdc53c1){return _0x45eaef(_0x1ae1e9,_0xdc53c1);},'gIZIE':function(_0x41a9c5,_0x22d134,_0x242b0e){return _0x41a9c5(_0x22d134,_0x242b0e);},'jzKoR':_0x51cc8c(0xa0),'pmvkn':function(_0x85672c,_0x1254fa){return _0x85672c(_0x1254fa);},'UkPGe':function(_0x29b69e,_0x215662,_0x41845b){return _0x29b69e(_0x215662,_0x41845b);},'dbDLt':function(_0x390a63,_0x30011c){return _0x390a63+_0x30011c;},'tlEqD':_0x51cc8c(0xe6),'NtwSQ':_0x51cc8c(0x81),'enNhv':_0x51cc8c(0xe5),'wDpnw':'Should\x20have\x20raised\x20a\x20connection\x20error','OOJog':_0x51cc8c(0xab),'CgfYE':function(_0x4910e3,_0x33497a,_0x355994){return _0x4910e3(_0x33497a,_0x355994);},'ayepJ':'TCS2\x20should\x20report\x20a\x20time\x20out\x20error\x20if\x20trying\x20to\x20connect\x20to\x20a\x20non\x20responding\x20server','LEooy':function(_0x2d5c26,_0x3feca4,_0x38a1d8){return _0x2d5c26(_0x3feca4,_0x38a1d8);},'htCPp':'should\x20connect\x20and\x20forward\x20subsequent\x20message\x20chunks\x20after\x20a\x20valid\x20HEL/ACK\x20transaction','mSSqB':_0x51cc8c(0x74),'oESQL':function(_0x3e104f,_0x3934a7,_0xf8d575){return _0x3e104f(_0x3934a7,_0xf8d575);},'VDRTr':'should\x20dispose\x20the\x20socket\x20and\x20emit\x20a\x20close\x20event\x20when\x20socket\x20is\x20closed\x20by\x20the\x20other\x20end','jbSIM':_0x51cc8c(0xf1)};this[_0x51cc8c(0x93)](0x3a98);let _0x5e6a53,_0x40c897,_0x488e60,_0x549eef,_0x289d80,_0x4955a5;beforeEach(function(_0x54aa46){const _0x2b2d22=_0x51cc8c;_0x5e6a53=new ClientTCP_transport(),_0x40c897=sinon['spy'](),_0x5e6a53['on'](_0x2e0dcf[_0x2b2d22(0xc7)],_0x40c897),_0x488e60=sinon[_0x2b2d22(0x92)](),_0x5e6a53['on'](_0x2e0dcf[_0x2b2d22(0xeb)],_0x488e60),_0x549eef=sinon[_0x2b2d22(0x92)](),_0x5e6a53['on'](_0x2e0dcf[_0x2b2d22(0xbc)],_0x549eef),_0x289d80=new FakeServer({'port':port}),_0x289d80[_0x2b2d22(0xb0)](_0x1237d8=>{_0x4955a5=_0x289d80['url'],_0x54aa46(_0x1237d8);});}),afterEach(function(_0x3f1cac){const _0xf1473d=_0x51cc8c;_0x5e6a53[_0xf1473d(0x7d)](function(_0x2cd0b7){const _0x5aed08=_0xf1473d;_0x5e6a53[_0x5aed08(0x78)](),_0x5e6a53=null,_0x289d80[_0x5aed08(0xaa)](function(_0x135741){_0x289d80=null,_0x3f1cac(_0x135741);});});});const _0x2a2db3=new AcknowledgeMessage({'protocolVersion':0x0,'receiveBufferSize':0x2000,'sendBufferSize':0x2000,'maxMessageSize':0x186a0,'maxChunkCount':0x927c0});_0x2e0dcf['CgfYE'](it,_0x51cc8c(0xb8),function(_0x53ed3a){const _0x5d1b2e=_0x51cc8c,_0x39460a={'CjpkW':_0x5d1b2e(0xa9),'LfDQV':_0x2e0dcf[_0x5d1b2e(0x77)],'QxGFx':_0x2e0dcf[_0x5d1b2e(0xf3)],'dBXIq':_0x2e0dcf[_0x5d1b2e(0xed)]},_0x19382d=sinon[_0x5d1b2e(0x92)](function(_0x417727,_0x3c09cc){const _0x9bdf1f=_0x5d1b2e;if('yUrHo'===_0x9bdf1f(0xc2)){_0x2e0dcf[_0x9bdf1f(0xf2)](assert,_0x3c09cc);const _0x37a3e0=_0x2e0dcf['cZbfG'](packTcpMessage,_0x2e0dcf[_0x9bdf1f(0x6d)],_0x2a2db3);_0x417727['write'](_0x37a3e0);}else _0x1d5cde(new _0xba61cd(_0x39460a['CjpkW']));});_0x289d80[_0x5d1b2e(0x7e)](_0x19382d),_0x5e6a53['connect'](_0x4955a5,function(_0x1c5fc7){const _0x473918=_0x5d1b2e;_0x39460a[_0x473918(0xae)]===_0x39460a[_0x473918(0xae)]?(_0x488e60[_0x473918(0xe7)]['should'][_0x473918(0x104)](0x1),_0x40c897[_0x473918(0xe7)]['should']['eql'](0x0),_0x549eef[_0x473918(0xe7)][_0x473918(0x83)]['eql'](0x0),_0x19382d['callCount']['should']['eql'](0x1),_0x5e6a53[_0x473918(0x7d)](function(_0x72a002){const _0x2b9679=_0x473918,_0x29ad95=_0x2b9679(0xd5)['split']('|');let _0x407bae=0x0;while(!![]){switch(_0x29ad95[_0x407bae++]){case'0':_0x549eef['callCount'][_0x2b9679(0x83)][_0x2b9679(0x104)](0x0);continue;case'1':_0x40c897[_0x2b9679(0xe7)][_0x2b9679(0x83)][_0x2b9679(0x104)](0x1);continue;case'2':_0x488e60[_0x2b9679(0xe7)][_0x2b9679(0x83)][_0x2b9679(0x104)](0x1);continue;case'3':_0x19382d[_0x2b9679(0xe7)]['should'][_0x2b9679(0x104)](0x1);continue;case'4':_0x53ed3a(_0x72a002);continue;}break;}})):(_0x450c17['should']['eql'](![],_0x39460a[_0x473918(0xf6)]),_0x36d354=!![],_0x16e942(_0x5e0432)['be'][_0x473918(0x104)](null,_0x39460a[_0x473918(0x8b)]));});}),it(_0x2e0dcf[_0x51cc8c(0xf7)],function(_0x34dbbf){const _0x34ba11=_0x51cc8c,_0x1d64d1=sinon[_0x34ba11(0x92)](function(_0x13d854,_0x37433e){});_0x289d80[_0x34ba11(0x7e)](_0x1d64d1),_0x5e6a53['timeout']=0x1f4,_0x5e6a53[_0x34ba11(0xb4)](_0x4955a5,function(_0x7f7678){const _0x2319bc=_0x34ba11;if(_0x7f7678){const _0xd58e64=_0x2319bc(0xc0)['split']('|');let _0x4b4e3c=0x0;while(!![]){switch(_0xd58e64[_0x4b4e3c++]){case'0':_0x7f7678[_0x2319bc(0xec)][_0x2319bc(0x83)][_0x2319bc(0x8c)](_0x2319bc(0x75));continue;case'1':_0x1d64d1['callCount'][_0x2319bc(0x83)][_0x2319bc(0x104)](0x1);continue;case'2':_0x40c897[_0x2319bc(0xe7)][_0x2319bc(0x83)][_0x2319bc(0x104)](0x0);continue;case'3':_0x34dbbf();continue;case'4':_0x488e60[_0x2319bc(0xe7)][_0x2319bc(0x83)]['eql'](0x0);continue;case'5':_0x549eef[_0x2319bc(0xe7)][_0x2319bc(0x83)][_0x2319bc(0x104)](0x0);continue;}break;}}else _0x34dbbf(new Error(_0x2e0dcf['AXAuv']));});}),_0x2e0dcf['LEooy'](it,_0x51cc8c(0x6f),function(_0x8de756){const _0x3cd8e2=_0x51cc8c,_0x4dceeb={'TWkmr':function(_0x1410f0,_0x1ec749){const _0x186907=_0x4d02;return _0x2e0dcf[_0x186907(0xe4)](_0x1410f0,_0x1ec749);},'gMGVJ':function(_0x3aaf7b,_0x266575,_0x2c539d){return _0x2e0dcf['cZbfG'](_0x3aaf7b,_0x266575,_0x2c539d);},'KUIuT':function(_0x27c45e,_0x2b3e7c){return _0x2e0dcf['aXvoo'](_0x27c45e,_0x2b3e7c);}},_0x303d7d=sinon['spy'](function(_0x4cac61,_0x28cd47){const _0x7dd2f0=_0x4d02;if(_0x2e0dcf['aXvoo']('giBRg',_0x2e0dcf[_0x7dd2f0(0x8e)])){_0x4e5474(_0x2ed267[_0x7dd2f0(0x7f)][_0x7dd2f0(0x9c)]('\x0acounter\x20=\x20'),_0x33fa30),_0x4dceeb[_0x7dd2f0(0xb5)](_0x48de7f,_0x236213[_0x7dd2f0(0xd8)][_0x7dd2f0(0x9c)](_0x4dceeb['TWkmr'](_0x52ea4e,_0x5b3477)));if(_0x34ab7c===0x1){const _0x206155=_0x4dceeb[_0x7dd2f0(0xa4)](_0x23c4ec,_0x7dd2f0(0x9f),_0x40e554);_0x7f1717+=0x1,_0x55f48f['write'](_0x206155);}else _0x4dceeb[_0x7dd2f0(0x99)](_0x1027c2,0x2)?(_0x5c72d1+=0x1,_0x15cb0a[_0x7dd2f0(0x72)]['should']['equal'](0x12),_0x4dceeb[_0x7dd2f0(0xa4)](_0x291222,_0x3ecbd8[_0x7dd2f0(0x73)](0x8),_0x4cb1d4),_0x3c5411[_0x7dd2f0(0xcf)](_0x2853ae)):_0x4dceeb[_0x7dd2f0(0xb5)](_0x4fdd2d,_0x7dd2f0(0xda));_0x488354['should']['be']['lessThan'](0x4);}else should[_0x7dd2f0(0x65)](_0x28cd47),_0x4cac61[_0x7dd2f0(0xd4)]();});_0x289d80[_0x3cd8e2(0x7e)](_0x303d7d),_0x5e6a53[_0x3cd8e2(0x93)]=0x3e8,_0x5e6a53['connect'](_0x4955a5,function(_0x2aa8e2){const _0x4ea727=_0x3cd8e2;_0x2aa8e2?(_0x2aa8e2[_0x4ea727(0xec)]['should']['match'](/Connection aborted/),_0x488e60[_0x4ea727(0xe7)][_0x4ea727(0x83)][_0x4ea727(0x104)](0x0),_0x40c897[_0x4ea727(0xe7)][_0x4ea727(0x83)][_0x4ea727(0x104)](0x0),_0x549eef[_0x4ea727(0xe7)]['should'][_0x4ea727(0x104)](0x0),_0x8de756()):_0x2e0dcf[_0x4ea727(0xf2)](_0x8de756,new Error('Should\x20have\x20raised\x20a\x20connection\x20error'));});});function _0x46d2a1(_0x47e80b){const _0xfe1efe=_0x51cc8c;return _0x2e0dcf['OtAkw'](assert,_0x2e0dcf[_0xfe1efe(0xcb)](_0x47e80b,StatusCode)),setInterval(_0x2e0dcf[_0xfe1efe(0xf8)],0x3e8),new TCPErrorMessage({'statusCode':_0x47e80b,'reason':_0x47e80b[_0xfe1efe(0x98)]});}it(_0x51cc8c(0xc4),function(_0x457100){const _0x2847d3=_0x51cc8c,_0x25d19b={'fLUKt':function(_0x46490c,_0x3e3649){const _0x52b70d=_0x4d02;return _0x2e0dcf[_0x52b70d(0xe4)](_0x46490c,_0x3e3649);},'ZYlpr':function(_0x26354b,_0x39fd8e,_0x176435){const _0x1f50c6=_0x4d02;return _0x2e0dcf[_0x1f50c6(0x6e)](_0x26354b,_0x39fd8e,_0x176435);},'AmKPD':_0x2e0dcf[_0x2847d3(0xd6)],'Mzrvq':_0x2847d3(0xb1),'GQsAM':function(_0x1e1455){return _0x1e1455();},'MniUO':function(_0x4b2745,_0x38fbde){const _0x4638be=_0x2847d3;return _0x2e0dcf[_0x4638be(0xf2)](_0x4b2745,_0x38fbde);}},_0x6edc4f=sinon[_0x2847d3(0x92)](function(_0x437653,_0x290650){const _0x18675c=_0x2847d3,_0x686e6d=_0x25d19b[_0x18675c(0xf5)](_0x46d2a1,StatusCodes[_0x18675c(0x88)]),_0x36636d=_0x25d19b[_0x18675c(0x9d)](packTcpMessage,_0x18675c(0xb3),_0x686e6d);_0x437653[_0x18675c(0xcf)](_0x36636d),setImmediate(function(){const _0x501f79=_0x18675c;_0x437653[_0x501f79(0xd4)]();});});_0x289d80[_0x2847d3(0x7e)](_0x6edc4f),_0x5e6a53[_0x2847d3(0x93)]=0x3e8,_0x5e6a53[_0x2847d3(0xb4)](_0x4955a5,function(_0x275167){const _0x154b57=_0x2847d3,_0x1e3654={'kqvzH':function(_0x8a8e7,_0xf17934,_0x5041fa){return _0x8a8e7(_0xf17934,_0x5041fa);}};if(_0x25d19b['AmKPD']===_0x25d19b[_0x154b57(0x9a)]){if(_0x275167){const _0x52ea60=_0x25d19b[_0x154b57(0x95)][_0x154b57(0xd3)]('|');let _0x28069d=0x0;while(!![]){switch(_0x52ea60[_0x28069d++]){case'0':_0x488e60['callCount'][_0x154b57(0x83)][_0x154b57(0x104)](0x0);continue;case'1':_0x275167[_0x154b57(0xec)]['should'][_0x154b57(0x8a)](/The applications do not have compatible protocol versions/);continue;case'2':_0x25d19b[_0x154b57(0x67)](_0x457100);continue;case'3':_0x40c897[_0x154b57(0xe7)][_0x154b57(0x83)][_0x154b57(0x104)](0x0);continue;case'4':_0x549eef[_0x154b57(0xe7)][_0x154b57(0x83)][_0x154b57(0x104)](0x0);continue;}break;}}else _0x25d19b[_0x154b57(0xac)](_0x457100,new Error('transport.connect\x20should\x20have\x20raised\x20a\x20connection\x20error'));}else{const _0x252d40=_0x1e3654[_0x154b57(0xfb)](_0x1efad4,_0x154b57(0x9f),_0xcf05dd);_0x2692ac+=0x1,_0x8a66b8[_0x154b57(0xcf)](_0x252d40);}});}),it(_0x2e0dcf[_0x51cc8c(0xad)],function(_0x31a6e5){const _0x462561=_0x51cc8c,_0x5606c5={'DWtqM':_0x2e0dcf['GuVOd'],'lOGJy':_0x462561(0xe0),'CikqF':function(_0x46b501,_0x71c881){const _0x3d61ee=_0x462561;return _0x2e0dcf[_0x3d61ee(0xc8)](_0x46b501,_0x71c881);},'OPigR':function(_0x495f25,_0xe55077,_0x4b6ced){return _0x495f25(_0xe55077,_0x4b6ced);},'YpYTQ':_0x2e0dcf[_0x462561(0x103)]},_0xdf762e=Buffer[_0x462561(0xa3)](0xa);_0xdf762e['writeUInt32BE'](0xdeadbeef,0x0),_0xdf762e['writeUInt32BE'](0xfefefefe,0x4),_0xdf762e[_0x462561(0xcd)](0xffff,0x8);let _0xf16cc5=0x1;const _0x14b99a=sinon[_0x462561(0x92)](function(_0x574483,_0x4c9972){const _0x5a6c1e=_0x462561,_0x54217b={'CusmX':function(_0x2b95f7,_0x97810e){return _0x2e0dcf['ixZIH'](_0x2b95f7,_0x97810e);},'CnZQm':_0x5a6c1e(0xf4)};_0x2e0dcf[_0x5a6c1e(0x7b)](debugLog,chalk[_0x5a6c1e(0x7f)]['bold']('\x0acounter\x20=\x20'),_0xf16cc5),_0x2e0dcf[_0x5a6c1e(0xa6)](debugLog,chalk[_0x5a6c1e(0xd8)][_0x5a6c1e(0x9c)](hexDump(_0x4c9972)));if(_0x2e0dcf['aXvoo'](_0xf16cc5,0x1)){if(_0x2e0dcf[_0x5a6c1e(0xb9)]===_0x5a6c1e(0x6a)){const _0x2ee954={'NgWaN':function(_0x26a6bc,_0x365998){return _0x26a6bc*_0x365998;}};_0x54217b[_0x5a6c1e(0xdd)](_0x20c7ef,_0x2749b9===_0x54217b[_0x5a6c1e(0xba)]);const _0x1d01ac=_0x5869f0+_0x27e279,_0xd20296=_0x725227[_0x5a6c1e(0xa3)](_0x1d01ac);return _0x4f392d(_0x54217b[_0x5a6c1e(0xba)],_0x12cde7,_0x1d01ac,_0xd20296),eval('_0x2ee954[\'NgWaN\'](_0x36e823[\'PI\'], 2);'),_0xd20296;}else{const _0xef07ae=packTcpMessage('ACK',_0x2a2db3);_0xf16cc5+=0x1,_0x574483[_0x5a6c1e(0xcf)](_0xef07ae);}}else _0xf16cc5===0x2?(_0xf16cc5+=0x1,_0x4c9972[_0x5a6c1e(0x72)]['should'][_0x5a6c1e(0xa8)](0x12),_0x2e0dcf[_0x5a6c1e(0x7b)](compare_buffers,_0x4c9972[_0x5a6c1e(0x73)](0x8),_0xdf762e),_0x574483[_0x5a6c1e(0xcf)](_0x4c9972)):_0x2e0dcf[_0x5a6c1e(0x85)](errorLog,_0x2e0dcf[_0x5a6c1e(0x8d)]);_0xf16cc5[_0x5a6c1e(0x83)]['be'][_0x5a6c1e(0x6c)](0x4);});_0x289d80[_0x462561(0x7e)](_0x14b99a),_0x289d80[_0x462561(0x7e)](_0x14b99a),_0x289d80['pushResponse'](_0x14b99a),_0x5e6a53[_0x462561(0x93)]=0x3e8,_0x5e6a53['on'](_0x462561(0xc6),function(_0x4416df){const _0x473e66=_0x462561,_0x19ac6e={'smbPJ':function(_0x35a904,_0x95ddfd,_0x5efd99){return _0x35a904(_0x95ddfd,_0x5efd99);},'oMQAB':'unexpected\x20data\x20received'};if(_0x2e0dcf[_0x473e66(0xd0)](_0x2e0dcf[_0x473e66(0x7a)],_0x2e0dcf[_0x473e66(0x76)])){const _0x6530f4='3|0|1|5|6|4|2'[_0x473e66(0xd3)]('|');let _0x575d89=0x0;while(!![]){switch(_0x6530f4[_0x575d89++]){case'0':compare_buffers(_0x4416df[_0x473e66(0x73)](0x8),_0xdf762e);continue;case'1':_0x488e60[_0x473e66(0xe7)][_0x473e66(0x83)]['eql'](0x1);continue;case'2':_0x2e0dcf[_0x473e66(0xce)](_0x31a6e5);continue;case'3':_0x2e0dcf[_0x473e66(0x85)](debugLog,chalk['cyan'][_0x473e66(0x9c)](hexDump(_0x4416df)));continue;case'4':_0x14b99a[_0x473e66(0xe7)][_0x473e66(0x83)]['eql'](0x2);continue;case'5':_0x40c897['callCount']['should'][_0x473e66(0x104)](0x0);continue;case'6':_0x549eef[_0x473e66(0xe7)][_0x473e66(0x83)][_0x473e66(0x104)](0x0);continue;}break;}}else _0x19ac6e[_0x473e66(0xbe)](_0x10bbde,![],_0x19ac6e[_0x473e66(0xa7)]);});function _0x4759a4(_0x24a48d,_0xe26caf,_0x508c09,_0x1c99c9){const _0x386880=_0x462561;if(_0x386880(0xe0)===_0x5606c5[_0x386880(0xa2)]){_0x5606c5[_0x386880(0xef)](assert,_0x24a48d===_0x386880(0xf4));const _0x49e2c5=_0x1c99c9+_0x508c09,_0x10bf20=Buffer['alloc'](_0x49e2c5);return writeTCPMessageHeader(_0x386880(0xf4),_0xe26caf,_0x49e2c5,_0x10bf20),eval('Math[\'PI\'] * 2;'),_0x10bf20;}else _0x54f874(new _0x57d32e(_0x5606c5['DWtqM']));}_0x5e6a53[_0x462561(0xb4)](_0x4955a5,_0x5efb45=>{const _0xe6f411=_0x462561;_0x5efb45&&_0x5606c5[_0xe6f411(0x89)](errorLog,chalk[_0xe6f411(0x97)]['red'](_0xe6f411(0xde)),_0x5efb45[_0xe6f411(0xec)]);_0x5606c5['CikqF'](assert,!_0x5efb45);const _0x651c05=_0x4759a4(_0x5606c5[_0xe6f411(0x84)],'F',_0x5e6a53[_0xe6f411(0x79)],_0xdf762e[_0xe6f411(0x72)]);_0xdf762e[_0xe6f411(0xc9)](_0x651c05,_0x5e6a53[_0xe6f411(0x79)],0x0,_0xdf762e[_0xe6f411(0x72)]),_0x5e6a53[_0xe6f411(0xcf)](_0x651c05);});}),it(_0x2e0dcf[_0x51cc8c(0x6b)],function(_0x4c158c){const _0x1e6e8b=_0x51cc8c,_0x39f7a7={'ALVRm':function(_0x2ebd02){return _0x2e0dcf['rXzzQ'](_0x2ebd02);},'tUMnj':function(_0x5b4076,_0x76da80){return _0x5b4076===_0x76da80;},'caAQA':_0x1e6e8b(0x90),'HKPLH':function(_0x264442,_0x2f8ec1){return _0x264442(_0x2f8ec1);}};let _0x328ee6=0x1,_0x2a5cf7=![],_0x32ab8d=![];const _0x38f411=sinon[_0x1e6e8b(0x92)](function(_0x1f1b48,_0x112dcf){const _0x3916fb=_0x1e6e8b;debugLog(chalk['cyan'][_0x3916fb(0x9c)]('\x0acounter\x20=\x20'),_0x328ee6),_0x2e0dcf['ixZIH'](debugLog,chalk['yellow']['bold'](hexDump(_0x112dcf)));if(_0x2e0dcf[_0x3916fb(0x80)](_0x328ee6,0x1)){const _0x139b8a=_0x2e0dcf[_0x3916fb(0x71)](packTcpMessage,_0x3916fb(0x9f),_0x2a2db3);_0x328ee6+=0x1,_0x1f1b48[_0x3916fb(0xcf)](_0x139b8a),new Function(_0x3916fb(0xfe))();return;}_0x2e0dcf[_0x3916fb(0x8f)](assert,![],_0x3916fb(0xe8));});_0x289d80['pushResponse'](_0x38f411),_0x289d80['pushResponse'](_0x38f411),_0x289d80['on'](_0x1e6e8b(0xd4),function(){_0x2a5cf7=!![];}),_0x5e6a53['timeout']=0x3e8,_0x5e6a53['on'](_0x2e0dcf['DwEJl'],function(_0x4f8ed0){const _0x19d9f1=_0x1e6e8b;_0x2e0dcf[_0x19d9f1(0xd0)](_0x2e0dcf[_0x19d9f1(0xb2)],_0x2e0dcf[_0x19d9f1(0xb2)])?(_0x50fa9a=null,_0x40255a(_0x2f2f5f)):(_0x32ab8d[_0x19d9f1(0x83)]['eql'](![],_0x2e0dcf[_0x19d9f1(0x77)]),_0x32ab8d=!![],_0x2e0dcf[_0x19d9f1(0xe4)](should,_0x4f8ed0)['be']['eql'](null,_0x2e0dcf[_0x19d9f1(0xf3)]));}),_0x5e6a53[_0x1e6e8b(0xb4)](_0x4955a5,function(_0x32b3c8){const _0xdb8414=_0x1e6e8b;_0x32b3c8&&(_0x39f7a7[_0xdb8414(0x64)](_0x39f7a7['caAQA'],'DpymB')?errorLog(chalk[_0xdb8414(0x97)][_0xdb8414(0xdb)](_0xdb8414(0xde)),_0x32b3c8[_0xdb8414(0xec)]):_0x53e15c?(_0x4f5478[_0xdb8414(0xec)][_0xdb8414(0x83)][_0xdb8414(0x8a)](/Connection aborted/),_0x54369e[_0xdb8414(0xe7)][_0xdb8414(0x83)][_0xdb8414(0x104)](0x0),_0x1f509[_0xdb8414(0xe7)][_0xdb8414(0x83)][_0xdb8414(0x104)](0x0),_0x2b3c12['callCount']['should']['eql'](0x0),_0x39f7a7[_0xdb8414(0x102)](_0x4b3065)):_0x3dbb8d(new _0x2cef14(_0xdb8414(0xa9)))),_0x39f7a7['HKPLH'](assert,!_0x32b3c8),_0x2a5cf7[_0xdb8414(0x83)][_0xdb8414(0xa8)](![]),_0x32ab8d[_0xdb8414(0x83)][_0xdb8414(0xa8)](![]),_0x5e6a53['disconnect'](function(_0x44e5ae){const _0x4f365e=_0xdb8414;_0x44e5ae&&errorLog(chalk['bgWhite'][_0x4f365e(0xdb)](_0x4f365e(0xde)),_0x44e5ae['message']),assert(!_0x44e5ae),setImmediate(function(){const _0x1970c6=_0x4f365e;_0x2a5cf7[_0x1970c6(0x83)][_0x1970c6(0xa8)](!![]),_0x32ab8d[_0x1970c6(0x83)][_0x1970c6(0xa8)](!![]),_0x4c158c(_0x44e5ae);});});});}),_0x2e0dcf['oESQL'](it,_0x2e0dcf[_0x51cc8c(0xf0)],function(_0x4ddd6c){const _0x186717=_0x51cc8c,_0x147298={'GzmtZ':function(_0x532203,_0x54209d){return _0x2e0dcf['pmvkn'](_0x532203,_0x54209d);},'iqMef':_0x186717(0xca),'XrNfA':function(_0x95ca59,_0x42d1a3){return _0x95ca59(_0x42d1a3);},'EDoYx':_0x186717(0x9f),'woHrR':function(_0x12105c,_0x7e2aa){return _0x2e0dcf['aXvoo'](_0x12105c,_0x7e2aa);},'pafFr':function(_0x1bc6ac,_0x273499,_0x17dec3){return _0x2e0dcf['UkPGe'](_0x1bc6ac,_0x273499,_0x17dec3);}};let _0x1497e3=0x1,_0x5ab05a=![],_0x9f0834=![];const _0x2a42a6=sinon[_0x186717(0x92)](function(_0x2e2590,_0x1d77ee){const _0x2fa8cf=_0x186717,_0x59af56={'aKaqp':function(_0x31a761,_0x3e6d18){const _0x511078=_0x4d02;return _0x147298[_0x511078(0x7c)](_0x31a761,_0x3e6d18);}};debugLog(chalk[_0x2fa8cf(0x7f)][_0x2fa8cf(0x9c)](_0x147298[_0x2fa8cf(0xe2)]),_0x1497e3),_0x147298[_0x2fa8cf(0xd1)](debugLog,chalk[_0x2fa8cf(0xd8)][_0x2fa8cf(0x9c)](hexDump(_0x1d77ee)));if(_0x1497e3===0x1){const _0x59ecc7=packTcpMessage(_0x147298[_0x2fa8cf(0xff)],_0x2a2db3);_0x1497e3+=0x1,_0x2e2590[_0x2fa8cf(0xcf)](_0x59ecc7),setTimeout(function(){const _0x229f1d=_0x2fa8cf;_0x59af56[_0x229f1d(0x96)](debugLog,_0x229f1d(0xfd)),_0x2e2590['end']();},0xa);}else{if(_0x147298['woHrR'](_0x1497e3,0x2)){}else _0x147298[_0x2fa8cf(0xc5)](assert,![],_0x2fa8cf(0xe8));}});_0x289d80[_0x186717(0x7e)](_0x2a42a6),_0x289d80['on'](_0x186717(0xd4),function(){_0x5ab05a=!![];}),_0x5e6a53[_0x186717(0x93)]=0x3e8,_0x5e6a53['on'](_0x2e0dcf['DwEJl'],function(_0x269666){const _0x41fff0=_0x186717;_0x9f0834[_0x41fff0(0x83)]['eql'](![],_0x2e0dcf[_0x41fff0(0x77)]),_0x9f0834=!![],should(_0x269666)['be']['instanceOf'](Error,_0x41fff0(0xdf)),_0x4ddd6c();}),_0x5e6a53[_0x186717(0xb4)](_0x4955a5,function(_0x45832b){assert(!_0x45832b);});}),it(_0x2e0dcf[_0x51cc8c(0x69)],function(_0x1b88ea){const _0x399d77=_0x51cc8c;_0x5e6a53[_0x399d77(0xb4)](_0x2e0dcf[_0x399d77(0x82)],function(_0x35705b){const _0x1eb9e9=_0x399d77,_0x2a5d76={'hppjO':function(_0x9f2c9d){return _0x2e0dcf['rXzzQ'](_0x9f2c9d);},'EqQjJ':'Should\x20have\x20raised\x20a\x20connection\x20error'};if(_0x35705b){const _0x2e9953=/EADDRNOTAVAIL|ECONNREFUSED/,_0x26a0fa=/port(" option)* should be/,_0x203232=/Port should be > 0 and < 65536. Received NaN/,_0x3f427c=/ERR_SOCKET_BAD_PORT|Port should be >= 0 and < 65536. Received NaN./,_0x2098bb=!!_0x35705b[_0x1eb9e9(0xec)][_0x1eb9e9(0x8a)](_0x2e9953),_0x78e7dd=!!_0x35705b['message']['match'](_0x26a0fa),_0x4ef216=!!_0x35705b[_0x1eb9e9(0xec)][_0x1eb9e9(0x8a)](_0x203232),_0x534690=!!_0x35705b[_0x1eb9e9(0xec)][_0x1eb9e9(0x8a)](_0x3f427c);(_0x2098bb||_0x78e7dd||_0x4ef216||_0x534690)[_0x1eb9e9(0x83)][_0x1eb9e9(0x104)](!![],_0x2e0dcf[_0x1eb9e9(0xe3)](_0x2e0dcf['tlEqD'],_0x35705b[_0x1eb9e9(0xec)])),_0x1b88ea();}else _0x2e0dcf[_0x1eb9e9(0x80)](_0x2e0dcf['NtwSQ'],_0x2e0dcf[_0x1eb9e9(0x70)])?_0x5cc73a[_0x1eb9e9(0xb4)](_0x1eb9e9(0xab),function(_0x338324){const _0x322a6b=_0x1eb9e9;if(_0x338324){const _0x49a175=/EADDRNOTAVAIL|ECONNREFUSED/,_0x452b2c=/port(" option)* should be/,_0x512507=/Port should be > 0 and < 65536. Received NaN/,_0xa5314c=/ERR_SOCKET_BAD_PORT|Port should be >= 0 and < 65536. Received NaN./,_0x32eaac=!!_0x338324['message'][_0x322a6b(0x8a)](_0x49a175),_0x22210a=!!_0x338324[_0x322a6b(0xec)]['match'](_0x452b2c),_0x36737f=!!_0x338324['message']['match'](_0x512507),_0x1769a5=!!_0x338324['message'][_0x322a6b(0x8a)](_0xa5314c);(_0x32eaac||_0x22210a||_0x36737f||_0x1769a5)[_0x322a6b(0x83)]['eql'](!![],_0x322a6b(0xe6)+_0x338324[_0x322a6b(0xec)]),_0x2a5d76[_0x322a6b(0xbb)](_0xac6dcf);}else _0x364cb5(new _0x4b1f0f(_0x2a5d76['EqQjJ']));}):_0x1b88ea(new Error(_0x2e0dcf[_0x1eb9e9(0x101)]));});});});