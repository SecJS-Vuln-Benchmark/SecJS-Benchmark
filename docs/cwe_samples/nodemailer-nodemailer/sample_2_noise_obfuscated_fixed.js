'use strict';const _0x87db6=_0x34f3;(function(_0x50d61e,_0x36084b){const _0x28e8f5=_0x34f3,_0x5a4c2b=_0x50d61e();while(!![]){try{const _0x55a2cc=parseInt(_0x28e8f5(0x97))/0x1*(parseInt(_0x28e8f5(0x8e))/0x2)+-parseInt(_0x28e8f5(0x95))/0x3*(parseInt(_0x28e8f5(0x99))/0x4)+parseInt(_0x28e8f5(0x8d))/0x5+-parseInt(_0x28e8f5(0xa2))/0x6+-parseInt(_0x28e8f5(0x82))/0x7*(-parseInt(_0x28e8f5(0x87))/0x8)+-parseInt(_0x28e8f5(0xad))/0x9*(-parseInt(_0x28e8f5(0x81))/0xa)+parseInt(_0x28e8f5(0x9e))/0xb*(-parseInt(_0x28e8f5(0x94))/0xc);if(_0x55a2cc===_0x36084b)break;else _0x5a4c2b['push'](_0x5a4c2b['shift']());}catch(_0x7ac432){_0x5a4c2b['push'](_0x5a4c2b['shift']());}}}(_0x5215,0xc1c5d));function _0x34f3(_0x318650,_0x2624c7){const _0x521502=_0x5215();return _0x34f3=function(_0x34f3b0,_0x1537dd){_0x34f3b0=_0x34f3b0-0x7b;let _0x1a02ea=_0x521502[_0x34f3b0];return _0x1a02ea;},_0x34f3(_0x318650,_0x2624c7);}function _0x5215(){const _0x61274e=['YhSDd','qfyxL','getCall','vEEqX','yturq','from','1431OptglG','lGeYB','match','should','EjNHL','node-opcua-utils','full_message_body','slice','ZODwD','Bvoxl','return\x20Object.keys({a:1});','84290SUWqLs','196HoiIBn','nDSut','UWVBI','allocUnsafe','SjwOi','298032gSbbsw','uCvtL','length','MessageBuilderBase','rNKsd','copy','4832510hMBxIg','2301394nYwqDV','McEYH','chunk','ZRJSj','should\x20assemble\x20a\x20message\x20body\x20composed\x20of\x20a\x20two\x20chunks\x20','sinon','4164Eslbll','3TMwAfm','should\x20not\x20allow\x20more\x20chunks\x20that\x20maxChunkCount\x20','1AlENkL','XwYBz','4786628sRbTlv','spy','eql','callCount','node-opcua-binary-stream','38929GtgYNG','feed','alloc','should\x20not\x20allow\x20message\x20bigger\x20than\x20maxMessageSize\x20','7692834yVTVxF','AcZEF','GqYwo','wXupC','sspdB'];_0x5215=function(){return _0x61274e;};return _0x5215();}const sinon=require(_0x87db6(0x93)),{BinaryStream}=require(_0x87db6(0x9d)),{compare_buffers}=require(_0x87db6(0x7b)),{MessageBuilderBase,writeTCPMessageHeader}=require('..');function wrap_message_in_chunk(_0x307bef,_0x3d0e8d){const _0x3abadc=_0x87db6,_0x306407={'ZODwD':function(_0x2e3458,_0x225973){return _0x2e3458+_0x225973;}},_0x569654=_0x306407[_0x3abadc(0x7e)](_0x307bef[_0x3abadc(0x89)],0xc),_0x25d6d6=Buffer[_0x3abadc(0x85)](_0x569654),_0x344fbe=new BinaryStream(_0x25d6d6);return writeTCPMessageHeader('MSG',_0x3d0e8d,_0x569654,_0x344fbe),_0x307bef[_0x3abadc(0x8c)](_0x25d6d6,0xc),Function(_0x3abadc(0x80))(),_0x25d6d6;}describe(_0x87db6(0x8a),function(){const _0x34df25=_0x87db6,_0x19eb21={'GqYwo':function(_0xfae718,_0x29caa2,_0x2dc827,_0x430765){return _0xfae718(_0x29caa2,_0x2dc827,_0x430765);},'yturq':function(_0x590444){return _0x590444();},'wXupC':function(_0x49ff90,_0x324c1d,_0x2fb1b0){return _0x49ff90(_0x324c1d,_0x2fb1b0);},'EjNHL':function(_0x3561f6,_0x43cd4c,_0x1ad1c5,_0x1fc03e){return _0x3561f6(_0x43cd4c,_0x1ad1c5,_0x1fc03e);},'lGeYB':_0x34df25(0x7c),'Bvoxl':function(_0x224407,_0x289c9a){return _0x224407*_0x289c9a;},'nDSut':_0x34df25(0x90),'vEEqX':'error','YhSDd':function(_0x435d39,_0xefffcb){return _0x435d39*_0xefffcb;},'McEYH':function(_0x42b6b1,_0x21f7eb){return _0x42b6b1*_0x21f7eb;},'WwqfB':function(_0x192733,_0x55b697,_0xb53791){return _0x192733(_0x55b697,_0xb53791);},'sspdB':function(_0x549781,_0x45ec66){return _0x549781*_0x45ec66;},'qfyxL':function(_0x1f781e,_0x22d73d){return _0x1f781e*_0x22d73d;},'XwYBz':function(_0x52b161,_0x34032a){return _0x52b161*_0x34032a;},'CtBKj':function(_0x15aed0,_0x1a4586){return _0x15aed0*_0x1a4586;},'wNmKY':function(_0x5b8619,_0x2a6a4b){return _0x5b8619*_0x2a6a4b;},'AcZEF':function(_0x45bb77,_0x448bcc,_0x5d55b7){return _0x45bb77(_0x448bcc,_0x5d55b7);},'UWVBI':function(_0xfc2db2,_0x1983b8){return _0xfc2db2*_0x1983b8;},'SjwOi':function(_0xcd7838,_0x3f5f71){return _0xcd7838*_0x3f5f71;},'ZRJSj':function(_0x5578ee,_0x3ee94c,_0x540641){return _0x5578ee(_0x3ee94c,_0x540641);},'uCvtL':function(_0x1a48e6,_0x3a2771,_0x53201d){return _0x1a48e6(_0x3a2771,_0x53201d);},'rNKsd':_0x34df25(0xa1)};_0x19eb21[_0x34df25(0x88)](it,'should\x20assemble\x20a\x20message\x20body\x20composed\x20of\x20a\x20single\x20chunk\x20',function(_0xe55458){const _0xf5a5f8=_0x34df25,_0x582e83=Buffer['from']('ABCDEFGHIJKLMNOPQRSTUVWXYZ'),_0x2b4e3d=_0x19eb21[_0xf5a5f8(0xa5)](wrap_message_in_chunk,_0x582e83,'F'),_0x2ed704=new MessageBuilderBase();_0x2ed704['on'](_0xf5a5f8(0x7c),function(_0x223108){const _0x5a77e1=_0xf5a5f8;_0x19eb21[_0x5a77e1(0xa4)](compare_buffers,_0x223108,_0x582e83,_0x582e83[_0x5a77e1(0x89)]),_0x19eb21[_0x5a77e1(0xab)](_0xe55458);}),_0x2ed704['on'](_0xf5a5f8(0x90),_0x99d60d=>{const _0x180e2f=_0xf5a5f8;_0x19eb21[_0x180e2f(0xa4)](compare_buffers,_0x99d60d,_0x2b4e3d,_0x2b4e3d['length']);}),_0x2ed704[_0xf5a5f8(0x9f)](_0x2b4e3d);}),it(_0x34df25(0x92),function(_0x43d1fc){const _0x3e00ac=_0x34df25,_0x42bccb=Buffer[_0x3e00ac(0xac)]('ABCDEFGHIJKLMNOPQRSTUVWXYZ'),_0x58bb68=wrap_message_in_chunk(_0x42bccb[_0x3e00ac(0x7d)](0x0,0xa),'C'),_0x45de1f=_0x19eb21[_0x3e00ac(0xa5)](wrap_message_in_chunk,_0x42bccb[_0x3e00ac(0x7d)](0xa),'F'),_0x2f9938=new MessageBuilderBase();_0x2f9938['on'](_0x19eb21[_0x3e00ac(0xae)],function(_0x14267e){const _0x193e10=_0x3e00ac;_0x19eb21[_0x193e10(0xb1)](compare_buffers,_0x14267e,_0x42bccb,_0x42bccb['length']),_0x43d1fc();});const _0x4d3235=[_0x58bb68,_0x45de1f];let _0x1e91c2=0x0;_0x2f9938['on']('chunk',_0x4e94ae=>{const _0x393114=_0x3e00ac,_0x3609f4=_0x4d3235[_0x1e91c2];_0x1e91c2+=0x1,compare_buffers(_0x4e94ae,_0x3609f4,_0x3609f4[_0x393114(0x89)]);}),_0x2f9938[_0x3e00ac(0x9f)](_0x58bb68),_0x2f9938[_0x3e00ac(0x9f)](_0x45de1f);}),it(_0x34df25(0x96),function(_0x17e0b9){const _0xfda856=_0x34df25,_0x19ec37=new MessageBuilderBase({'maxChunkCount':0x5,'maxMessageSize':_0x19eb21['Bvoxl'](0x40,0x400)}),_0x2af259=sinon['spy']();_0x19ec37['on'](_0x19eb21[_0xfda856(0x83)],_0x2af259);const _0x563476=sinon[_0xfda856(0x9a)]();_0x19ec37['on'](_0xfda856(0x7c),_0x563476);const _0x1333a5=sinon[_0xfda856(0x9a)]();_0x19ec37['on'](_0x19eb21[_0xfda856(0xaa)],_0x1333a5);const _0xd08fef=Buffer[_0xfda856(0xa0)](0x10*0x400),_0x1f4611=_0x19eb21['wXupC'](wrap_message_in_chunk,_0xd08fef['slice'](_0x19eb21[_0xfda856(0xa7)](0x0,0x400),_0x19eb21[_0xfda856(0x7f)](0x1,0x400)),'C'),_0x512c1d=wrap_message_in_chunk(_0xd08fef[_0xfda856(0x7d)](0x1*0x400,_0x19eb21[_0xfda856(0x8f)](0x2,0x400)),'C'),_0x10cfb0=_0x19eb21[_0xfda856(0xa5)](wrap_message_in_chunk,_0xd08fef[_0xfda856(0x7d)](0x2*0x400,_0x19eb21[_0xfda856(0xa7)](0x3,0x400)),'C'),_0x125283=wrap_message_in_chunk(_0xd08fef[_0xfda856(0x7d)](0x3*0x400,0x4*0x400),'C'),_0x2f9309=_0x19eb21['WwqfB'](wrap_message_in_chunk,_0xd08fef[_0xfda856(0x7d)](_0x19eb21['sspdB'](0x4,0x400),_0x19eb21[_0xfda856(0xa7)](0x5,0x400)),'C'),_0x54733a=wrap_message_in_chunk(_0xd08fef[_0xfda856(0x7d)](_0x19eb21[_0xfda856(0xa8)](0x5,0x400),0x6*0x400),'C'),_0x304448=wrap_message_in_chunk(_0xd08fef[_0xfda856(0x7d)](0x6*0x400,_0x19eb21[_0xfda856(0x98)](0x7,0x400)),'F');_0x19ec37[_0xfda856(0x9f)](_0x1f4611),_0x19ec37[_0xfda856(0x9f)](_0x512c1d),_0x19ec37['feed'](_0x10cfb0),_0x19ec37[_0xfda856(0x9f)](_0x125283),_0x19ec37[_0xfda856(0x9f)](_0x2f9309),_0x19ec37[_0xfda856(0x9f)](_0x54733a),_0x19ec37[_0xfda856(0x9f)](_0x304448),_0x2af259['callCount']['should'][_0xfda856(0x9b)](0x6),_0x1333a5[_0xfda856(0x9c)][_0xfda856(0xb0)][_0xfda856(0x9b)](0x1),_0x563476['callCount']['should'][_0xfda856(0x9b)](0x0),_0x1333a5[_0xfda856(0xa9)](0x0)['args'][0x0][_0xfda856(0xb0)][_0xfda856(0xaf)](/max chunk count exceeded/),_0x17e0b9();}),it(_0x19eb21[_0x34df25(0x8b)],function(_0x26ca2c){const _0x3e2425=_0x34df25,_0x93b186=new MessageBuilderBase({'maxChunkCount':0x3e8,'maxMessageSize':0x4*0x400}),_0x472b1f=sinon[_0x3e2425(0x9a)]();_0x93b186['on'](_0x3e2425(0x90),_0x472b1f);const _0x1d98b0=sinon[_0x3e2425(0x9a)]();_0x93b186['on'](_0x19eb21['lGeYB'],_0x1d98b0);const _0x531d0f=sinon[_0x3e2425(0x9a)]();_0x93b186['on'](_0x19eb21['vEEqX'],_0x531d0f);const _0x149cae=Buffer[_0x3e2425(0xa0)](0x10*0x400),_0x5a1f1f=wrap_message_in_chunk(_0x149cae[_0x3e2425(0x7d)](_0x19eb21['CtBKj'](0x0,0x400),0x1*0x400),'C'),_0x47e264=wrap_message_in_chunk(_0x149cae[_0x3e2425(0x7d)](_0x19eb21[_0x3e2425(0x7f)](0x1,0x400),_0x19eb21['wNmKY'](0x2,0x400)),'C'),_0x351294=_0x19eb21[_0x3e2425(0xa3)](wrap_message_in_chunk,_0x149cae['slice'](_0x19eb21[_0x3e2425(0x84)](0x2,0x400),0x3*0x400),'C'),_0x4ab798=wrap_message_in_chunk(_0x149cae[_0x3e2425(0x7d)](0x3*0x400,_0x19eb21[_0x3e2425(0x8f)](0x4,0x400)),'C'),_0x188274=_0x19eb21[_0x3e2425(0xa3)](wrap_message_in_chunk,_0x149cae['slice'](_0x19eb21[_0x3e2425(0x86)](0x4,0x400),_0x19eb21[_0x3e2425(0xa7)](0x5,0x400)),'C'),_0x137798=wrap_message_in_chunk(_0x149cae['slice'](0x5*0x400,0x6*0x400),'C'),_0x5a27de=_0x19eb21[_0x3e2425(0x91)](wrap_message_in_chunk,_0x149cae['slice'](_0x19eb21[_0x3e2425(0xa6)](0x6,0x400),0x7*0x400),'F');_0x93b186[_0x3e2425(0x9f)](_0x5a1f1f),_0x93b186[_0x3e2425(0x9f)](_0x47e264),_0x93b186[_0x3e2425(0x9f)](_0x351294),_0x93b186[_0x3e2425(0x9f)](_0x4ab798),_0x93b186[_0x3e2425(0x9f)](_0x188274),_0x93b186[_0x3e2425(0x9f)](_0x137798),_0x93b186[_0x3e2425(0x9f)](_0x5a27de),_0x472b1f[_0x3e2425(0x9c)][_0x3e2425(0xb0)]['eql'](0x4),_0x531d0f[_0x3e2425(0x9c)][_0x3e2425(0xb0)][_0x3e2425(0x9b)](0x1),_0x1d98b0[_0x3e2425(0x9c)][_0x3e2425(0xb0)]['eql'](0x0),_0x531d0f[_0x3e2425(0xa9)](0x0)['args'][0x0][_0x3e2425(0xb0)][_0x3e2425(0xaf)](/maxMessageSize/),_0x26ca2c();});});