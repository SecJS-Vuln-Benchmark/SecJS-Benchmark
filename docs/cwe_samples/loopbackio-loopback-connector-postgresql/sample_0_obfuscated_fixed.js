'use strict';const _0x496d21=_0x4183;(function(_0x51793b,_0xf3b851){const _0x254cea=_0x4183,_0x1f027b=_0x51793b();while(!![]){try{const _0x2171ab=parseInt(_0x254cea(0x174))/0x1*(-parseInt(_0x254cea(0x127))/0x2)+-parseInt(_0x254cea(0x16b))/0x3*(parseInt(_0x254cea(0x125))/0x4)+parseInt(_0x254cea(0x15e))/0x5*(parseInt(_0x254cea(0x12b))/0x6)+parseInt(_0x254cea(0x14e))/0x7*(parseInt(_0x254cea(0x17c))/0x8)+parseInt(_0x254cea(0x173))/0x9+-parseInt(_0x254cea(0x177))/0xa*(-parseInt(_0x254cea(0x164))/0xb)+-parseInt(_0x254cea(0x11f))/0xc;if(_0x2171ab===_0xf3b851)break;else _0x1f027b['push'](_0x1f027b['shift']());}catch(_0x4cab49){_0x1f027b['push'](_0x1f027b['shift']());}}}(_0x3d8b,0xe414b));function _0x4183(_0x1322a5,_0x5b274a){const _0x3d8bf3=_0x3d8b();return _0x4183=function(_0x4183fa,_0x59f3f0){_0x4183fa=_0x4183fa-0x11f;let _0x238c54=_0x3d8bf3[_0x4183fa];return _0x238c54;},_0x4183(_0x1322a5,_0x5b274a);}const {describe,it}=require('node:test'),assert=require(_0x496d21(0x12d)),request=require('supertest'),context=require(_0x496d21(0x123)),Koa=require(_0x496d21(0x13f));function _0x3d8b(){const _0x221736=['/login','20UNHelq','ycHid','67766QvPpaF','uAsaj','should\x20default\x20to\x20alt','when\x20text\x20is\x20accepted','157902yEyQTI','should\x20redirect\x20to\x20the\x20given\x20url','node:assert/strict','http://google.com/ðŸ˜“','JAlUx','OiMxQ','should\x20overwrite\x20content-type','end','Redirecting\x20to\x20','cpDtY','CcwjG','&gt;','text/html;\x20charset=utf-8','tvXee','should\x20redirect\x20to\x20Referer','gjDob','http://google.com','get','<script>','CqoOn','../..','MptTW','PDbpa','aqmQG','http://google.com/','http://google.com/%F0%9F%98%93','http://google.com\x5c@apple.com','should\x20escape\x20the\x20url','TuCzu','DzfSk','jKiJF','ZXdhs','text/plain','should\x20default\x20redirect\x20to\x20/','dpkeN','217ofYQXz','should\x20not\x20change\x20the\x20status\x20code','iwJKl','vSmUy','Oidnq','&quot;','KlsRR','req','body','ZEIic','text/html','back','referer','when\x20content-type\x20was\x20present','MuMiF','/index.html','115zrCmBi','ieDgY','should\x20formatting\x20url\x20before\x20redirect','when\x20status\x20is\x20304','headers','ICwqS','11AAkUyV','eJiny','qrePK','use','callback','strictEqual','header','590241BCvuON','OJFgy','status','HTTP://google.com\x5c@apple.com','ZTSUW','type','location','oMPdO','10861506DwKEXN','47bzcmhh','osPOu','fSPIX','10327110NwYftx','response','content-type','should\x20auto\x20fix\x20not\x20encode\x20url','replace','362280abTcKA','TPbkT','with\x20\x22back\x22','tgmQO','accept','redirect','GIgZm','8858592CvUhsv','uDRxP','http://google.com/@apple.com','referrer','../../test-helpers/context'];_0x3d8b=function(){return _0x221736;};return _0x3d8b();}describe('ctx.redirect(url)',()=>{const _0x13dff1=_0x496d21,_0x42468b={'wFbpY':function(_0x33783b,_0x42706c){return _0x33783b(_0x42706c);},'GIgZm':function(_0x1fb6b3){return _0x1fb6b3();},'ICwqS':_0x13dff1(0x143),'oMPdO':function(_0x15d027){return _0x15d027();},'ZXdhs':_0x13dff1(0x13b),'PDbpa':_0x13dff1(0x14b),'aunEK':_0x13dff1(0x121),'DzfSk':_0x13dff1(0x16e),'fSPIX':function(_0x51fb77,_0x3ca807){return _0x51fb77(_0x3ca807);},'CqoOn':_0x13dff1(0x159),'jKiJF':_0x13dff1(0x15d),'iwJKl':function(_0x20691c,_0x22601e,_0x27b6ea){return _0x20691c(_0x22601e,_0x27b6ea);},'cpDtY':_0x13dff1(0x129),'TuCzu':_0x13dff1(0x158),'CcwjG':_0x13dff1(0x137),'qrePK':_0x13dff1(0x179),'osPOu':function(_0x1493d3,_0xe78937,_0x18a03b){return _0x1493d3(_0xe78937,_0x18a03b);},'tgmQO':'should\x20respond\x20with\x20html','MuMiF':_0x13dff1(0x146),'gjDob':function(_0x4da24b,_0x3512f5,_0x3e96ea){return _0x4da24b(_0x3512f5,_0x3e96ea);},'Oidnq':_0x13dff1(0x14f),'tvXee':'should\x20change\x20the\x20status\x20code','OJFgy':function(_0x621ccf,_0x13553c,_0xbb313c){return _0x621ccf(_0x13553c,_0xbb313c);},'aqmQG':function(_0x23da02,_0x33ea69,_0xa3814f){return _0x23da02(_0x33ea69,_0xa3814f);},'ieDgY':'when\x20html\x20is\x20accepted','NizSN':function(_0x3e527f,_0x224ae1,_0x9c1e4){return _0x3e527f(_0x224ae1,_0x9c1e4);},'dpkeN':'when\x20status\x20is\x20301'};it(_0x13dff1(0x12c),()=>{const _0x4b3aff=_0x13dff1,_0x547e70={'MlWpS':function(_0x28a945,_0x550d61){return _0x42468b['wFbpY'](_0x28a945,_0x550d61);},'vSmUy':_0x4b3aff(0x144)};if(_0x4b3aff(0x165)!=='eJiny'){if(_0x93d76b)return _0x547e70['MlWpS'](_0x591f2,_0x5ed328);_0x480eb9[_0x4b3aff(0x169)](_0x19d0f5[_0x4b3aff(0x16d)],0x12e),_0x567888[_0x4b3aff(0x169)](_0x294f61[_0x4b3aff(0x162)][_0x4b3aff(0x171)],_0x547e70[_0x4b3aff(0x151)]),_0x2fcfbe();}else{const _0x4456e9=_0x42468b[_0x4b3aff(0x182)](context);_0x4456e9[_0x4b3aff(0x181)](_0x4b3aff(0x13b)),assert[_0x4b3aff(0x169)](_0x4456e9[_0x4b3aff(0x178)][_0x4b3aff(0x16a)][_0x4b3aff(0x171)],_0x42468b[_0x4b3aff(0x163)]),assert[_0x4b3aff(0x169)](_0x4456e9['status'],0x12e);}}),_0x42468b[_0x13dff1(0x16c)](it,_0x13dff1(0x160),()=>{const _0x2ed8eb=_0x13dff1;if(_0x2ed8eb(0x16f)!=='ZTSUW'){const _0xb6ed0=_0x42468b[_0x2ed8eb(0x172)](_0x5fe33e),_0x2afd2b=_0x42468b[_0x2ed8eb(0x14a)];_0xb6ed0['header'][_0x2ed8eb(0x180)]=_0x42468b[_0x2ed8eb(0x141)],_0xb6ed0['redirect'](_0x2afd2b),_0x5cfab3[_0x2ed8eb(0x169)](_0xb6ed0[_0x2ed8eb(0x156)],_0x2ed8eb(0x133)+_0x2afd2b+'/.');}else{const _0x558e30=context();_0x558e30['redirect'](_0x2ed8eb(0x145)),assert[_0x2ed8eb(0x169)](_0x558e30[_0x2ed8eb(0x178)][_0x2ed8eb(0x16a)][_0x2ed8eb(0x171)],_0x42468b['aunEK']),assert[_0x2ed8eb(0x169)](_0x558e30['status'],0x12e);}}),_0x42468b[_0x13dff1(0x142)](it,'should\x20formatting\x20url\x20before\x20redirect',()=>{const _0x57dac3=_0x13dff1,_0xb88ab9=context();_0xb88ab9[_0x57dac3(0x181)](_0x42468b[_0x57dac3(0x148)]),assert[_0x57dac3(0x169)](_0xb88ab9[_0x57dac3(0x178)][_0x57dac3(0x16a)][_0x57dac3(0x171)],_0x57dac3(0x121)),assert[_0x57dac3(0x169)](_0xb88ab9[_0x57dac3(0x16d)],0x12e);}),it(_0x13dff1(0x17a),(_0x4573a0,_0x432ac1)=>{const _0x2ba937=_0x13dff1,_0x676e84={'CVVZV':_0x2ba937(0x144)},_0x5372c9=new Koa();_0x5372c9[_0x2ba937(0x167)](_0x1d2367=>{const _0x2232b4=_0x2ba937;_0x1d2367[_0x2232b4(0x181)](_0x2232b4(0x12e));}),_0x42468b[_0x2ba937(0x176)](request,_0x5372c9[_0x2ba937(0x168)]())[_0x2ba937(0x13c)]('/')[_0x2ba937(0x132)]((_0x40af80,_0x5f36d0)=>{const _0x8fa809=_0x2ba937;if(_0x40af80)return _0x432ac1(_0x40af80);assert[_0x8fa809(0x169)](_0x5f36d0[_0x8fa809(0x16d)],0x12e),assert[_0x8fa809(0x169)](_0x5f36d0['headers'][_0x8fa809(0x171)],_0x676e84['CVVZV']),_0x432ac1();});}),_0x42468b[_0x13dff1(0x16c)](describe,_0x13dff1(0x17e),()=>{const _0x531c48=_0x13dff1,_0x303612={'ycHid':function(_0x48f354){const _0x5d5323=_0x4183;return _0x42468b[_0x5d5323(0x182)](_0x48f354);}};_0x42468b[_0x531c48(0x150)](it,'should\x20redirect\x20to\x20Referrer',()=>{const _0x51d709=_0x531c48,_0x49aa5d=_0x303612['ycHid'](context);_0x49aa5d[_0x51d709(0x155)]['headers'][_0x51d709(0x122)]=_0x51d709(0x124),_0x49aa5d[_0x51d709(0x181)](_0x51d709(0x159)),assert['strictEqual'](_0x49aa5d['response'][_0x51d709(0x16a)]['location'],'/login');}),it(_0x531c48(0x139),()=>{const _0x19f9f6=_0x531c48,_0x50326d=_0x303612[_0x19f9f6(0x126)](context);_0x50326d['req'][_0x19f9f6(0x162)][_0x19f9f6(0x15a)]='/login',_0x50326d['redirect']('back'),assert[_0x19f9f6(0x169)](_0x50326d[_0x19f9f6(0x178)]['header']['location'],'/login');}),_0x42468b[_0x531c48(0x150)](it,_0x42468b[_0x531c48(0x134)],()=>{const _0x4c6d05=_0x531c48,_0x43ba85=_0x42468b[_0x4c6d05(0x172)](context);_0x43ba85[_0x4c6d05(0x181)](_0x42468b[_0x4c6d05(0x13e)],_0x42468b[_0x4c6d05(0x149)]),assert[_0x4c6d05(0x169)](_0x43ba85['response']['header'][_0x4c6d05(0x171)],_0x4c6d05(0x15d));}),it(_0x531c48(0x14c),()=>{const _0x1b0721=_0x531c48,_0x203dc7=context();_0x203dc7[_0x1b0721(0x181)](_0x42468b['CqoOn']),assert[_0x1b0721(0x169)](_0x203dc7[_0x1b0721(0x178)][_0x1b0721(0x16a)][_0x1b0721(0x171)],'/');});}),_0x42468b[_0x13dff1(0x13a)](describe,_0x42468b[_0x13dff1(0x15f)],()=>{const _0x4117c3=_0x13dff1,_0x34ccb8={'MptTW':function(_0x3dc7db,_0x19b828){const _0x2ff2ed=_0x4183;return _0x42468b[_0x2ff2ed(0x176)](_0x3dc7db,_0x19b828);},'uDRxP':_0x42468b[_0x4117c3(0x166)],'OiMxQ':_0x42468b[_0x4117c3(0x135)]};_0x42468b[_0x4117c3(0x175)](it,_0x42468b[_0x4117c3(0x17f)],()=>{const _0x16c5de=_0x4117c3,_0x25078e=_0x42468b[_0x16c5de(0x182)](context),_0x3d03e9=_0x16c5de(0x143);_0x25078e[_0x16c5de(0x16a)][_0x16c5de(0x180)]=_0x42468b[_0x16c5de(0x147)],_0x25078e['redirect'](_0x3d03e9),assert['strictEqual'](_0x25078e[_0x16c5de(0x178)][_0x16c5de(0x16a)][_0x16c5de(0x179)],_0x42468b[_0x16c5de(0x135)]),assert[_0x16c5de(0x169)](_0x25078e['body'],'Redirecting\x20to\x20'+_0x3d03e9+'.');}),it(_0x42468b[_0x4117c3(0x15c)],()=>{const _0xc545f2=_0x4117c3,_0x711e3f=context();let _0x19956f=_0xc545f2(0x13d);_0x711e3f[_0xc545f2(0x16a)][_0xc545f2(0x180)]=_0xc545f2(0x158),_0x711e3f[_0xc545f2(0x181)](_0x19956f),_0x19956f=_0x34ccb8[_0xc545f2(0x140)](escape,_0x19956f),assert['strictEqual'](_0x711e3f[_0xc545f2(0x178)][_0xc545f2(0x16a)][_0x34ccb8[_0xc545f2(0x120)]],_0x34ccb8[_0xc545f2(0x130)]),assert[_0xc545f2(0x169)](_0x711e3f['body'],_0xc545f2(0x133)+_0x19956f+'.');});}),describe(_0x13dff1(0x12a),()=>{const _0x491ef3=_0x13dff1;_0x42468b[_0x491ef3(0x13a)](it,'should\x20respond\x20with\x20text',()=>{const _0x3bb138=_0x491ef3,_0xb2eb3f=_0x42468b[_0x3bb138(0x182)](context),_0x42075b=_0x42468b[_0x3bb138(0x14a)];_0xb2eb3f['header'][_0x3bb138(0x180)]='text/plain',_0xb2eb3f[_0x3bb138(0x181)](_0x42075b),assert[_0x3bb138(0x169)](_0xb2eb3f[_0x3bb138(0x156)],'Redirecting\x20to\x20'+_0x42075b+'/.');});}),_0x42468b['NizSN'](describe,_0x42468b[_0x13dff1(0x14d)],()=>{const _0x5eb197=_0x13dff1,_0x259fd1={'JAlUx':function(_0x344964){return _0x344964();},'TPbkT':_0x42468b[_0x5eb197(0x14a)]};it(_0x42468b[_0x5eb197(0x152)],()=>{const _0x5393e2=_0x5eb197,_0x314ff2=_0x259fd1[_0x5393e2(0x12f)](context),_0x5b3e9b=_0x259fd1[_0x5393e2(0x17d)];_0x314ff2[_0x5393e2(0x16d)]=0x12d,_0x314ff2[_0x5393e2(0x16a)]['accept']=_0x5393e2(0x14b),_0x314ff2[_0x5393e2(0x181)](_0x5393e2(0x13b)),assert['strictEqual'](_0x314ff2['status'],0x12d),assert[_0x5393e2(0x169)](_0x314ff2[_0x5393e2(0x156)],_0x5393e2(0x133)+_0x5b3e9b+'/.');});}),describe(_0x13dff1(0x161),()=>{const _0xdc3d38=_0x13dff1,_0x4ac928={'KlsRR':function(_0x5c5bbb){return _0x5c5bbb();},'uAsaj':_0xdc3d38(0x13b)};it(_0x42468b[_0xdc3d38(0x138)],()=>{const _0x54390f=_0xdc3d38,_0x42ee2f=_0x4ac928[_0x54390f(0x154)](context),_0x32c887=_0x4ac928[_0x54390f(0x128)];_0x42ee2f[_0x54390f(0x16d)]=0x130,_0x42ee2f[_0x54390f(0x16a)][_0x54390f(0x180)]=_0x54390f(0x14b),_0x42ee2f['redirect'](_0x54390f(0x13b)),assert[_0x54390f(0x169)](_0x42ee2f[_0x54390f(0x16d)],0x12e),assert[_0x54390f(0x169)](_0x42ee2f[_0x54390f(0x156)],_0x54390f(0x133)+_0x32c887+'/.');});}),describe(_0x13dff1(0x15b),()=>{const _0x54a344=_0x13dff1;_0x42468b['gjDob'](it,_0x54a344(0x131),()=>{const _0x3a2627=_0x54a344,_0x4d91c6=context();_0x4d91c6['body']={};const _0x1cc12c=_0x3a2627(0x13b);_0x4d91c6[_0x3a2627(0x16a)]['accept']=_0x42468b[_0x3a2627(0x141)],_0x4d91c6[_0x3a2627(0x181)](_0x42468b['ZXdhs']),assert[_0x3a2627(0x169)](_0x4d91c6[_0x3a2627(0x16d)],0x12e),assert[_0x3a2627(0x169)](_0x4d91c6[_0x3a2627(0x156)],'Redirecting\x20to\x20'+_0x1cc12c+'/.'),assert['strictEqual'](_0x4d91c6[_0x3a2627(0x170)],_0x42468b[_0x3a2627(0x141)]);});});});function escape(_0x5523ac){const _0x1185b8=_0x496d21,_0x29d7af={'ZEIic':'&amp;','GiiSC':'&lt;'};return String(_0x5523ac)[_0x1185b8(0x17b)](/&/g,_0x29d7af[_0x1185b8(0x157)])['replace'](/"/g,_0x1185b8(0x153))[_0x1185b8(0x17b)](/</g,_0x29d7af['GiiSC'])[_0x1185b8(0x17b)](/>/g,_0x1185b8(0x136));}