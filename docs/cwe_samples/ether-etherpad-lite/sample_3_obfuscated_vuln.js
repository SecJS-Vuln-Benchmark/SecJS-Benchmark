const _0x14ef86=_0x23f5;function _0x8df7(){const _0x27a585=['1570ZIMyJy','composer','textContent','discourse-mermaid-theme-component','SdqtI','trim','jgHUA','EXeWq','7VgCIBb','innerText','Swzaq','insert_mermaid_sample','controller:composer','selectionStart','classList','GjZZI','mermaid_js','1136712cSDvGe','483281RMUULv','dark','append','value','\x0a```mermaid\x0a','6oEcLjq','PvtZU','NwPor','mermaid_sample','1900536mxReLv','spinner','```mermaid\x20height=','fGqEH','height','post_','parse','translations','createElement','text','forEach','276099TEqhEs','Ncudp','join','mermaid','render','match','applySurround','decorateChatMessage','0.11.1','--scheme-type','querySelector','.spinner','querySelectorAll','NrFRf','mermaid_','theme_uploads_local','getBoundingClientRect','style','code','selectionEnd','dataset','processed','Wxsbc','TviiL',',auto','decorateCookedElement','I18n','d-editor-input','2202444YiaQtX','roGdK','7710JDpwCG','mermaidAPI','add','codeHeight','calculatedHeight','initialize','AEjIx','FPQLj','RYZUD','getModel','getPropertyValue','bMXHl','GHOpX','ickaC','insertMermaidSample','11301730LdGenE','locale'];_0x8df7=function(){return _0x27a585;};return _0x8df7();}(function(_0x409fae,_0x2d99d7){const _0x192c42=_0x23f5,_0x14936a=_0x409fae();while(!![]){try{const _0x46cfff=-parseInt(_0x192c42(0x142))/0x1+-parseInt(_0x192c42(0x147))/0x2*(parseInt(_0x192c42(0x156))/0x3)+parseInt(_0x192c42(0x141))/0x4+-parseInt(_0x192c42(0x130))/0x5*(parseInt(_0x192c42(0x11f))/0x6)+parseInt(_0x192c42(0x138))/0x7*(parseInt(_0x192c42(0x14b))/0x8)+-parseInt(_0x192c42(0x11d))/0x9+parseInt(_0x192c42(0x12e))/0xa;if(_0x46cfff===_0x2d99d7)break;else _0x14936a['push'](_0x14936a['shift']());}catch(_0x1add11){_0x14936a['push'](_0x14936a['shift']());}}}(_0x8df7,0x3ba6c));import _0xcb34ef from'discourse/lib/load-script';import{apiInitializer}from'discourse/lib/api';function _0x23f5(_0x3b1124,_0xfb674){const _0x8df7e=_0x8df7();return _0x23f5=function(_0x23f550,_0xc50a14){_0x23f550=_0x23f550-0x117;let _0x3521a1=_0x8df7e[_0x23f550];return _0x3521a1;},_0x23f5(_0x3b1124,_0xfb674);}import _0x403f8f from'discourse-common/lib/debounce';async function applyMermaid(_0x5b1949,_0xfecf99=_0x14ef86(0x131)){const _0x49ea26=_0x14ef86,_0x3578e9={'GHOpX':function(_0x1b463f,_0x5bb436){return _0x1b463f!==_0x5bb436;},'AEjIx':function(_0x5f01f6,_0x200f1e){return _0x5f01f6+_0x200f1e;},'FPQLj':_0x49ea26(0x14d),'GjZZI':_0x49ea26(0x119),'ikjTv':'div','cVfsr':_0x49ea26(0x168),'EXeWq':function(_0x19c93f,_0x29bd09){return _0x19c93f!==_0x29bd09;},'bMXHl':_0x49ea26(0x12c),'mtRvw':'ypJms','RYZUD':function(_0x5471c6,_0x377b28,_0x489b36,_0x2abe7e,_0x5cb19e){return _0x5471c6(_0x377b28,_0x489b36,_0x2abe7e,_0x5cb19e);},'Ncudp':'dark'},_0x478954=_0x5b1949[_0x49ea26(0x162)]('pre[data-code-wrap=mermaid]');if(!_0x478954['length'])return;await _0xcb34ef(settings[_0x49ea26(0x165)][_0x49ea26(0x140)]),window[_0x49ea26(0x159)][_0x49ea26(0x124)]({'startOnLoad':![],'theme':getComputedStyle(document['body'])[_0x49ea26(0x129)](_0x49ea26(0x15f))[_0x49ea26(0x135)]()===_0x49ea26(0x143)?_0x3578e9[_0x49ea26(0x157)]:'default'}),_0x478954[_0x49ea26(0x155)](_0x461d68=>{const _0x608d09=_0x49ea26;if(_0x461d68[_0x608d09(0x16a)][_0x608d09(0x16b)])return;const _0x77fa88=document[_0x608d09(0x153)]('div');_0x77fa88['classList'][_0x608d09(0x121)](_0x608d09(0x14c)),_0x461d68[_0x608d09(0x16a)][_0x608d09(0x122)]&&_0x3578e9['GHOpX'](_0xfecf99,_0x608d09(0x131))&&(_0x461d68[_0x608d09(0x167)][_0x608d09(0x14f)]=_0x461d68[_0x608d09(0x16a)][_0x608d09(0x122)]+'px'),_0x461d68[_0x608d09(0x144)](_0x77fa88);}),_0x478954[_0x49ea26(0x155)]((_0xb5b2be,_0x5d612b)=>{const _0x1c67cd=_0x49ea26,_0x3f4d7c={'fGqEH':_0x3578e9['ikjTv']},_0xef2be6=_0xb5b2be[_0x1c67cd(0x160)](_0x3578e9['cVfsr']);if(!_0xef2be6){if(_0x1c67cd(0x149)!==_0x1c67cd(0x149)){if(_0x378247[_0x1c67cd(0x16a)]['processed'])return;const _0x52751e=_0x153dc3[_0x1c67cd(0x153)](_0x3f4d7c[_0x1c67cd(0x14e)]);_0x52751e[_0x1c67cd(0x13e)]['add'](_0x1c67cd(0x14c)),_0x39b3d2[_0x1c67cd(0x16a)][_0x1c67cd(0x122)]&&_0x7b8be3!==_0x1c67cd(0x131)&&(_0x17c57a[_0x1c67cd(0x167)][_0x1c67cd(0x14f)]=_0x67103[_0x1c67cd(0x16a)]['codeHeight']+'px'),_0x59e8b7['append'](_0x52751e);}else return;}try{if(_0x3578e9[_0x1c67cd(0x137)](_0x3578e9[_0x1c67cd(0x12a)],_0x1c67cd(0x12c))){let _0x26780e=_0x3f9a8a[_0x1c67cd(0x13d)],_0x2a725c=_0x6b1252['selectionEnd'];_0x2795f8[_0x1c67cd(0x145)]=_0x3ab833,_0x26780e&&(_0x5d5e02[_0x1c67cd(0x13d)]=_0x26780e,_0x553fe1[_0x1c67cd(0x169)]=_0x2a725c);}else window['mermaid'][_0x1c67cd(0x151)](_0xef2be6['textContent']||'')&&window['mermaid'][_0x1c67cd(0x120)][_0x1c67cd(0x15a)](_0x1c67cd(0x164)+_0x5d612b+'_'+_0xfecf99,_0xef2be6[_0x1c67cd(0x132)]||'',_0x187a85=>{_0xb5b2be['innerHTML']=_0x187a85;});}catch(_0x558e1f){_0xb5b2be[_0x1c67cd(0x139)]=_0x558e1f?.[_0x1c67cd(0x154)]||_0x558e1f;}finally{_0xb5b2be[_0x1c67cd(0x16a)][_0x1c67cd(0x16b)]=!![],_0xb5b2be['querySelector'](_0x1c67cd(0x161))?.['remove']();}_0xfecf99===_0x1c67cd(0x131)&&(_0x3578e9[_0x1c67cd(0x12b)]('ypJms',_0x3578e9['mtRvw'])?(_0x70e59a===_0x480f2c&&(_0x5a126c[_0x382019]=_0x3578e9[_0x1c67cd(0x125)](_0x3578e9[_0x1c67cd(0x126)],_0xdf6541)+_0x3578e9[_0x1c67cd(0x13f)]),_0x370103+=0x1):_0x3578e9[_0x1c67cd(0x127)](_0x403f8f,updateMarkdownHeight,_0xb5b2be,_0x5d612b,0x1f4));});}function updateMarkdownHeight(_0x20a058,_0x41aa29){const _0x15e5c7=_0x14ef86,_0x3a39e5={'jgHUA':function(_0x3ae92d,_0x1ac0bf){return _0x3ae92d(_0x1ac0bf);},'klRgn':function(_0x41502a,_0x1b92f0){return _0x41502a!==_0x1b92f0;},'roGdK':_0x15e5c7(0x11c),'Wxsbc':_0x15e5c7(0x134),'zyOit':_0x15e5c7(0x163),'cAlXy':function(_0x5e111a,_0x1e9ca2){return _0x5e111a+_0x1e9ca2;}};let _0x4efda8=_0x3a39e5[_0x15e5c7(0x136)](parseInt,_0x20a058[_0x15e5c7(0x166)]()[_0x15e5c7(0x14f)]),_0x13885=parseInt(_0x20a058[_0x15e5c7(0x16a)][_0x15e5c7(0x123)]);if(_0x4efda8===0x0)return;if(_0x3a39e5['klRgn'](_0x4efda8,_0x13885)){_0x20a058['dataset'][_0x15e5c7(0x123)]=_0x4efda8;let _0x4d2089=document['getElementsByClassName'](_0x3a39e5[_0x15e5c7(0x11e)])[0x0],_0x143fce=_0x4d2089['value']['split']('\x0a'),_0x44dec5=0x0;for(let _0xd7f228=0x0;_0xd7f228<_0x143fce['length'];_0xd7f228++){if(_0x3a39e5[_0x15e5c7(0x117)]!==_0x3a39e5['zyOit'])_0x143fce[_0xd7f228][_0x15e5c7(0x15b)](/```mermaid((\s*)|.*auto)$/)&&(_0x44dec5===_0x41aa29&&(_0x143fce[_0xd7f228]=_0x3a39e5['cAlXy'](_0x15e5c7(0x14d)+_0x4efda8,_0x15e5c7(0x119))),_0x44dec5+=0x1);else return;}let _0x7a0bbf=_0x143fce[_0x15e5c7(0x158)]('\x0a');if(_0x7a0bbf!==_0x4d2089[_0x15e5c7(0x145)]){let _0x4efccf=_0x4d2089[_0x15e5c7(0x13d)],_0x4ed3f8=_0x4d2089[_0x15e5c7(0x169)];_0x4d2089[_0x15e5c7(0x145)]=_0x7a0bbf,_0x4efccf&&(_0x4d2089[_0x15e5c7(0x13d)]=_0x4efccf,_0x4d2089[_0x15e5c7(0x169)]=_0x4ed3f8);}}}export default apiInitializer(_0x14ef86(0x15e),_0x1623ac=>{const _0x2c4ecd=_0x14ef86,_0x85bb3e={'PvtZU':function(_0xca8a14,_0x7a04c7){return _0xca8a14(_0x7a04c7);},'Swzaq':_0x2c4ecd(0x13b),'TviiL':_0x2c4ecd(0x146),'vQnVk':'\x0a```\x0a'};_0x1623ac['addToolbarPopupMenuOptionsCallback'](()=>{const _0x5d09e0=_0x2c4ecd;return{'action':_0x5d09e0(0x12d),'icon':'project-diagram','label':_0x85bb3e[_0x5d09e0(0x148)](themePrefix,_0x85bb3e[_0x5d09e0(0x13a)])};}),window[_0x2c4ecd(0x11b)][_0x2c4ecd(0x152)][window['I18n'][_0x2c4ecd(0x12f)]]['js'][_0x2c4ecd(0x131)]['mermaid_sample']='\x20\x20\x20\x20flowchart\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20A\x20-->\x20B',_0x1623ac['modifyClass'](_0x2c4ecd(0x13c),{'pluginId':_0x2c4ecd(0x133),'actions':{'insertMermaidSample'(){const _0x539e86=_0x2c4ecd;this['toolbarEvent'][_0x539e86(0x15c)](_0x85bb3e[_0x539e86(0x118)],_0x85bb3e['vQnVk'],_0x539e86(0x14a),{'multiline':![]});}}}),_0x1623ac[_0x2c4ecd(0x15d)]&&_0x1623ac[_0x2c4ecd(0x15d)](_0x195491=>{applyMermaid(_0x195491,'chat_message_'+_0x195491['id']);}),_0x1623ac[_0x2c4ecd(0x11a)](async(_0x35b076,_0x57dd1a)=>{const _0x9dec8c=_0x2c4ecd,_0x1803ab=_0x57dd1a?_0x9dec8c(0x150)+_0x57dd1a[_0x9dec8c(0x128)]()['id']:'composer';applyMermaid(_0x35b076,_0x1803ab);},{'id':_0x2c4ecd(0x133)});});