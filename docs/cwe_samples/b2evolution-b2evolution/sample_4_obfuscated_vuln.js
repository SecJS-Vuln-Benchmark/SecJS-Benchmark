function _0x51ec(){const _0x204a73=['should\x20error\x20when\x20legacy\x20samesite\x20fallback\x20is\x20off','tBNmU','jose','30AlrsOC','912462llMxvF','Bearer','base64','77QmUPtjPfzWtF2AnpK9RQ','session','removeInterceptor','oidc','restore','__new_access_token__','https://op.example.com','qztpv','XnOIR','6563526UKDAYq','iss','SPplN','UtDCO','match','edhvB','1304652bWezir','useFakeTimers','DHVze','fKLEP','vcdyY','from','TXqfX','__test_client_id__','EkIbF','IZRzh','dhsIw','/tokens','LLcHA','http://example.org','nonce','accessTokenExpired','ZdRkf','headers','eKasV','code\x20id_token','AcUpJ','SQfKc','setCookie','skipSilentLogin','LTWTq','YejnP','body','should\x20error\x20when\x20id_token\x20is\x20missing\x20issuer','https://example.org','request-promise-native','accessToken','VUVNL','grATS','openid\x20profile\x20email\x20read:reports\x20offline_access','should\x20error\x20when\x20id_token\x20can\x27t\x20be\x20parsed','org_id','__test_refresh_token__','nickname','MwNqu','req','calledWith','/refresh','RxejH','OuVFN','jLXcU','cZPcY','spy','__valid_state__','post','refreshToken','12hPzJJw','weVqy','RPoCm','cLhtD','padbP','skipSilentLogin=true','MIouV','iqSUJ','keys','Nixid','openid\x20profile\x20email','/oauth/token','should\x20expose\x20all\x20tokens\x20when\x20id_token\x20is\x20valid\x20and\x20response_type\x20is\x20\x27code\x20id_token\x27','WPrMt','should\x20expose\x20the\x20id\x20token\x20when\x20id_token\x20is\x20valid','sign','__invalid_token__','sinon','7aWwdCn','MDyya','idToken','465365jhoMgw','zxCNz','hGmOW','FZZPj','oRagN','appSession','tick','deepEqual','ZSwJu','JTCVr','stringify','__test_client_secret__','longeLiveToken=true&force=true&grant_type=refresh_token&refresh_token=__test_refresh_token__','getCookies','eEhUs','__test_nickname__','NFrKZ','isFalse','chai','jar','__invalid_state__','authOpts','should\x20use\x20legacy\x20samesite\x20fallback','uRBgZ','xafpI','message','EmXKU','GFbxu','xAaNq','refresh','psMqw','YTvRe','2lWNBHh','jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y','/user','exists','unPYx','id_token','24093OXbIdv','__test_sub__',';\x20Max-Age=3600;\x20Path=/;\x20HttpOnly;','ptqim','should\x20not\x20strip\x20claims\x20when\x20using\x20custom\x20claim\x20filtering','assert','should\x20error\x20when\x20state\x20doesn\x27t\x20match','HS256','should\x20error\x20when\x20nonce\x20is\x20missing\x20from\x20cookies','IgfoS','auth_org_123','should\x20error\x20when\x20the\x20state\x20is\x20missing','exp','grant_type=refresh_token&refresh_token=__test_refresh_token__','HgAKm','YTVFm','reply','jmYGH','idTokenClaims','get','FPiuX','router','KaPhT','qIvlr','SLBOu','lGSIy','should\x20use\x20basic\x20auth\x20on\x20token\x20endpoint\x20when\x20using\x20code\x20flow','checks.state\x20argument\x20is\x20missing','../lib/hooks/getLoginState','DkncG','../lib/transientHandler','/userinfo','/callback','NDMGi','/session','include','expires_in','Basic\x20','callback\x20response_mode:\x20form_post','json','equal','MdCtS','notExists','8537104FDKuJF','replace','./fixture/cert','4lIZyFe','iat','authorization','then','should\x20refresh\x20an\x20access\x20token\x20and\x20pass\x20tokenEndpointParams\x20and\x20refresh\x20argument\x20params\x20to\x20the\x20request','BMqBN','UEiHv','tYnia','access_token','__test_access_token__','find','code','MIJSv','should\x20error\x20when\x20id_token\x20has\x20invalid\x20alg','should\x20allow\x20thrown\x20error\x20to\x20fail\x20the\x20request','cookies','poaMo','mLXwA','__test_state__','./fixture/server','notOk','fetchUserInfo','GVFjY','__test_client_id__:__test_client_secret__','Zmyxi','http://localhost:3000','BZocH','23923933ILNIDv','isUndefined','ORrjd','__test_nonce__','the\x20new\x20access\x20token\x20should\x20be\x20persisted\x20in\x20the\x20session','secret','FxCCx','zbgwN','close','/user-info','https://api.example.com/','isAuthenticated','oJKBY','aud','location','should\x20error\x20when\x20the\x20body\x20is\x20empty','sub','vIfjE','should\x20fetch\x20userinfo','FgXrM','__new_refresh_token__'];_0x51ec=function(){return _0x204a73;};return _0x51ec();}const _0x36e2bd=_0x1257;function _0x1257(_0x580c7b,_0x239bed){const _0x51ecaf=_0x51ec();return _0x1257=function(_0x125775,_0x2a0bf0){_0x125775=_0x125775-0xa2;let _0x49f24e=_0x51ecaf[_0x125775];return _0x49f24e;},_0x1257(_0x580c7b,_0x239bed);}(function(_0x1c95d5,_0x248a0c){const _0x162e9a=_0x1257,_0x4385e7=_0x1c95d5();while(!![]){try{const _0x3a0fa9=-parseInt(_0x162e9a(0xc5))/0x1*(-parseInt(_0x162e9a(0x13e))/0x2)+-parseInt(_0x162e9a(0xd7))/0x3+-parseInt(_0x162e9a(0x172))/0x4*(-parseInt(_0x162e9a(0x11e))/0x5)+parseInt(_0x162e9a(0xd1))/0x6+-parseInt(_0x162e9a(0x11b))/0x7*(-parseInt(_0x162e9a(0x16f))/0x8)+parseInt(_0x162e9a(0x144))/0x9*(-parseInt(_0x162e9a(0xc4))/0xa)+-parseInt(_0x162e9a(0xac))/0xb*(parseInt(_0x162e9a(0x109))/0xc);if(_0x3a0fa9===_0x248a0c)break;else _0x4385e7['push'](_0x4385e7['shift']());}catch(_0x2c5113){_0x4385e7['push'](_0x4385e7['shift']());}}}(_0x51ec,0x85fa8));const assert=require(_0x36e2bd(0x130))['assert'],sinon=require(_0x36e2bd(0x11a)),jose=require(_0x36e2bd(0xc3)),request=require(_0x36e2bd(0xf4))['defaults']({'simple':![],'resolveWithFullResponse':!![]}),TransientCookieHandler=require(_0x36e2bd(0x162)),{encodeState}=require(_0x36e2bd(0x160)),{auth}=require('..'),{create:createServer}=require(_0x36e2bd(0xa4)),{makeIdToken}=require(_0x36e2bd(0x171)),clientID=_0x36e2bd(0xde),expectedDefaultState=encodeState({'returnTo':_0x36e2bd(0xf3)}),nock=require('nock'),baseUrl=_0x36e2bd(0xaa),defaultConfig={'secret':'__test_session_secret__','clientID':clientID,'baseURL':_0x36e2bd(0xe4),'issuerBaseURL':_0x36e2bd(0xce),'authRequired':![]};let server;const generateCookies=_0x5659bb=>({'auth_verification':JSON[_0x36e2bd(0x128)](_0x5659bb)}),setup=async _0x5291b4=>{const _0x1bc53a=_0x36e2bd,_0x50cfcb={'NDMGi':function(_0x183dc9,_0x3158a8){return _0x183dc9+_0x3158a8;},'qztpv':'__test_access_token__','LTWTq':_0x1bc53a(0xfb),'NeuuB':_0x1bc53a(0xc6),'xafpI':function(_0x4e1343,_0x4b0938){return _0x4e1343(_0x4b0938);},'zxCNz':function(_0x18d86d,_0xd7667e,_0x424268){return _0x18d86d(_0xd7667e,_0x424268);},'AvUTI':_0x1bc53a(0x140),'unPYx':_0x1bc53a(0xe2)},_0x712eae=Object['assign']({},defaultConfig,_0x5291b4[_0x1bc53a(0x133)]||{}),_0x1e1667=_0x5291b4[_0x1bc53a(0x159)]||_0x50cfcb[_0x1bc53a(0x136)](auth,_0x712eae),_0x14f92e=new TransientCookieHandler(_0x712eae),_0x3c54e9=_0x5291b4[_0x1bc53a(0x131)]||request[_0x1bc53a(0x131)]();server=await createServer(_0x1e1667);let _0x2dfa04,_0x4b6e5d;Object[_0x1bc53a(0x111)](_0x5291b4[_0x1bc53a(0x181)])['forEach'](function(_0x54782e){const _0x59a5f1=_0x1bc53a;let _0x4440c8;_0x14f92e['store'](_0x54782e,{},{'cookie'(_0x47eeae,..._0xd89d8){_0x47eeae===_0x54782e&&(_0x4440c8=_0xd89d8[0x0]);}},{'value':_0x5291b4[_0x59a5f1(0x181)][_0x54782e]}),_0x3c54e9[_0x59a5f1(0xed)](_0x54782e+'='+_0x4440c8+_0x59a5f1(0x146),_0x50cfcb[_0x59a5f1(0x165)](baseUrl,_0x59a5f1(0x164)));});const {interceptors:[_0x3be7c6]}=_0x50cfcb[_0x1bc53a(0x11f)](nock,_0x1bc53a(0xce),{'allowUnmocked':!![]})[_0x1bc53a(0x107)](_0x1bc53a(0x114))[_0x1bc53a(0x154)](0xc8,function(_0x404efe,_0x1ba0df){const _0x320487=_0x1bc53a;return _0x2dfa04=this[_0x320487(0xfe)][_0x320487(0xe8)],_0x4b6e5d=_0x1ba0df,{'access_token':_0x50cfcb[_0x320487(0xcf)],'refresh_token':_0x50cfcb[_0x320487(0xef)],'id_token':_0x5291b4[_0x320487(0xf1)][_0x320487(0x143)],'token_type':_0x50cfcb['NeuuB'],'expires_in':0x15180};}),_0x20d8a0=await request[_0x1bc53a(0x107)](_0x1bc53a(0x164),{'baseUrl':baseUrl,'jar':_0x3c54e9,'json':_0x5291b4[_0x1bc53a(0xf1)]}),_0x536c61=await request['get'](_0x50cfcb['AvUTI'],{'baseUrl':baseUrl,'jar':_0x3c54e9,'json':!![]})[_0x1bc53a(0x175)](_0x4d1c23=>_0x4d1c23['body']),_0x106e2f=await request[_0x1bc53a(0x157)](_0x50cfcb[_0x1bc53a(0x142)],{'baseUrl':baseUrl,'jar':_0x3c54e9,'json':!![]})['then'](_0x590f49=>_0x590f49[_0x1bc53a(0xf1)]);return nock[_0x1bc53a(0xca)](_0x3be7c6),{'baseUrl':baseUrl,'jar':_0x3c54e9,'response':_0x20d8a0,'currentUser':_0x536c61,'tokenReqHeader':_0x2dfa04,'tokenReqBody':_0x4b6e5d,'tokens':_0x106e2f};};describe(_0x36e2bd(0x16a),()=>{const _0x188e9b=_0x36e2bd,_0x1e21a4={'vIfjE':function(_0x208268,_0x56936e){return _0x208268!==_0x56936e;},'jLXcU':_0x188e9b(0x16d),'TunVn':function(_0x46ea92,_0x306fda){return _0x46ea92(_0x306fda);},'TXqfX':_0x188e9b(0xaf),'UEiHv':_0x188e9b(0xa3),'iqSUJ':function(_0x40b113,_0x251f23){return _0x40b113(_0x251f23);},'YejnP':_0x188e9b(0x15f),'qIvlr':_0x188e9b(0x132),'RxejH':_0x188e9b(0x119),'HgAKm':function(_0x319dbc,_0xb38751){return _0x319dbc(_0xb38751);},'zbgwN':function(_0x4bef33,_0xdfeabc){return _0x4bef33(_0xdfeabc);},'IZRzh':function(_0x149d1e){return _0x149d1e();},'kDQmw':function(_0x446cb0,_0x337a99){return _0x446cb0(_0x337a99);},'VUVNL':function(_0x4869fa){return _0x4869fa();},'pRwHd':'https://op.example.com/','UtDCO':_0x188e9b(0x145),'FPiuX':'77QmUPtjPfzWtF2AnpK9RQ','MIJSv':_0x188e9b(0xb6),'FZZPj':_0x188e9b(0xf8),'Nixid':function(_0x39f40e,_0x2210f6){return _0x39f40e(_0x2210f6);},'JTCVr':_0x188e9b(0xfb),'AMMHq':_0x188e9b(0x17b),'GVFjY':function(_0x3998bb,_0x5967e3){return _0x3998bb*_0x5967e3;},'BZocH':_0x188e9b(0x129),'eKasV':_0x188e9b(0x13f),'padbP':function(_0x41baef,_0x2a9ddf){return _0x41baef*_0x2a9ddf;},'bytDg':function(_0x287b26,_0x218dac){return _0x287b26*_0x218dac;},'jmYGH':_0x188e9b(0xe2),'YTvRe':function(_0x49f327,_0x32a6ec){return _0x49f327===_0x32a6ec;},'MDyya':_0x188e9b(0xdb),'MwNqu':function(_0x238870,_0x1420de){return _0x238870(_0x1420de);},'nZVRG':function(_0x382279,_0x3e2911){return _0x382279(_0x3e2911);},'EmXKU':'code\x20id_token','ZSwJu':function(_0xcdcaa8,_0x19527a){return _0xcdcaa8(_0x19527a);},'psMqw':function(_0x395f8b,_0x41a164,_0x2681ad){return _0x395f8b(_0x41a164,_0x2681ad);},'Zmyxi':'/oauth/token','GFbxu':_0x188e9b(0x151),'cZPcY':'__new_access_token__','dhsIw':_0x188e9b(0xc0),'XnOIR':_0x188e9b(0x123),'FgXrM':function(_0x256dfe,_0x1613a1){return _0x256dfe!==_0x1613a1;},'weVqy':function(_0x11a882,_0xe7ed50){return _0x11a882(_0xe7ed50);},'oJKBY':function(_0x3afa2d,_0xfe98ab,_0x34b7a2){return _0x3afa2d(_0xfe98ab,_0x34b7a2);},'OuVFN':_0x188e9b(0x100),'poaMo':function(_0x1f57c0,_0x55e424){return _0x1f57c0+_0x55e424;},'SQfKc':_0x188e9b(0x161),'SLBOu':_0x188e9b(0x113),'WPrMt':_0x188e9b(0xb5),'sqgXu':_0x188e9b(0xce),'eEhUs':_0x188e9b(0xa8),'EkIbF':_0x188e9b(0x10e),'tYnia':function(_0x228bc1,_0x5fdeaa){return _0x228bc1(_0x5fdeaa);},'BMqBN':function(_0x1f58fb,_0x468cb1){return _0x1f58fb(_0x468cb1);},'xAaNq':_0x188e9b(0xc2),'oRagN':'/userinfo','LDcxV':function(_0x9a5a05,_0x1bcf0f){return _0x9a5a05(_0x1bcf0f);},'gKcVL':'should\x20allow\x20modification\x20of\x20the\x20session','IgfoS':function(_0x3f39d8,_0x13a178,_0x4de292){return _0x3f39d8(_0x13a178,_0x4de292);},'RPoCm':_0x188e9b(0x14a),'YTVFm':function(_0x1f8d32,_0x125986,_0x583cee){return _0x1f8d32(_0x125986,_0x583cee);},'mLXwA':_0x188e9b(0x17f),'SPplN':_0x188e9b(0xf2),'PeLsr':function(_0x30beac,_0x957fab,_0x435659){return _0x30beac(_0x957fab,_0x435659);},'KmhNu':function(_0x3638a3,_0x151419,_0xc7c9e1){return _0x3638a3(_0x151419,_0xc7c9e1);},'JQMhj':_0x188e9b(0x115),'lndli':'should\x20refresh\x20an\x20access\x20token','hGmOW':function(_0x543f3d,_0x2763c0,_0xa31192){return _0x543f3d(_0x2763c0,_0xa31192);},'NFrKZ':'should\x20refresh\x20an\x20access\x20token\x20and\x20keep\x20original\x20refresh\x20token','ZdRkf':_0x188e9b(0x176),'lWkJp':function(_0x21592b,_0x1fcce1,_0x2fd87a){return _0x21592b(_0x1fcce1,_0x2fd87a);},'FxCCx':_0x188e9b(0x15e),'MIouV':'should\x20resume\x20silent\x20logins\x20when\x20user\x20successfully\x20logs\x20in','ptqim':'when\x20afterCallack\x20is\x20configured'};afterEach(()=>{const _0x5e020b=_0x188e9b;server&&(_0x1e21a4[_0x5e020b(0xbd)](_0x1e21a4[_0x5e020b(0x103)],_0x5e020b(0x16d))?_0x375cda[_0x5e020b(0xb4)]():server[_0x5e020b(0xb4)]());}),it(_0x188e9b(0xbb),async()=>{const _0x645bdd=_0x188e9b,{response:{statusCode:_0x1553f1,body:{err:_0x58ba33}}}=await setup({'cookies':_0x1e21a4['TunVn'](generateCookies,{'nonce':_0x1e21a4[_0x645bdd(0xdd)],'state':_0x1e21a4['UEiHv']}),'body':!![]});assert[_0x645bdd(0x16c)](_0x1553f1,0x190),assert[_0x645bdd(0x16c)](_0x58ba33[_0x645bdd(0x137)],'state\x20missing\x20from\x20the\x20response');}),_0x1e21a4[_0x188e9b(0x14d)](it,_0x188e9b(0x14f),async()=>{const _0x2ed7ae=_0x188e9b,{response:{statusCode:_0x54aa9b,body:{err:_0x5e1f92}}}=await _0x1e21a4['iqSUJ'](setup,{'cookies':{},'body':{'state':_0x2ed7ae(0xa3),'id_token':_0x2ed7ae(0x119)}});assert[_0x2ed7ae(0x16c)](_0x54aa9b,0x190),assert['equal'](_0x5e1f92['message'],_0x1e21a4[_0x2ed7ae(0xf0)]);}),it(_0x1e21a4[_0x188e9b(0x10b)],async()=>{const _0x470cef=_0x188e9b,{response:{statusCode:_0x46907c,body:{err:_0x3d1250}}}=await _0x1e21a4['TunVn'](setup,{'cookies':generateCookies({'nonce':'__test_nonce__','state':_0x470cef(0x106)}),'body':{'state':_0x1e21a4[_0x470cef(0x15b)]}});assert[_0x470cef(0x16c)](_0x46907c,0x190),assert[_0x470cef(0xd5)](_0x3d1250[_0x470cef(0x137)],/state mismatch/i);}),it(_0x188e9b(0xf9),async()=>{const _0x58a69b=_0x188e9b,{response:{statusCode:_0x28728f,body:{err:_0x1c556a}}}=await setup({'cookies':generateCookies({'nonce':_0x1e21a4['TXqfX'],'state':_0x58a69b(0xa3)}),'body':{'state':_0x58a69b(0xa3),'id_token':_0x1e21a4[_0x58a69b(0x101)]}});assert[_0x58a69b(0x16c)](_0x28728f,0x190),assert[_0x58a69b(0x16c)](_0x1c556a['message'],'failed\x20to\x20decode\x20JWT\x20(JWTMalformed:\x20JWTs\x20must\x20have\x20three\x20components)');}),_0x1e21a4[_0x188e9b(0x153)](it,_0x1e21a4[_0x188e9b(0xa2)],async()=>{const _0x3aa606=_0x188e9b,{response:{statusCode:_0x118eb9,body:{err:_0x21d7d7}}}=await _0x1e21a4[_0x3aa606(0x152)](setup,{'cookies':generateCookies({'nonce':_0x1e21a4[_0x3aa606(0xdd)],'state':_0x1e21a4[_0x3aa606(0x178)]}),'body':{'state':_0x1e21a4[_0x3aa606(0x178)],'id_token':jose['JWT'][_0x3aa606(0x118)]({'sub':_0x3aa606(0x145)},_0x3aa606(0xb1),{'algorithm':_0x3aa606(0x14b)})}});assert[_0x3aa606(0x16c)](_0x118eb9,0x190),assert['match'](_0x21d7d7[_0x3aa606(0x137)],/unexpected JWT alg received/i);}),it(_0x1e21a4[_0x188e9b(0xd3)],async()=>{const _0x7c7d1b=_0x188e9b,{response:{statusCode:_0x74b102,body:{err:_0x627612}}}=await setup({'cookies':_0x1e21a4[_0x7c7d1b(0xb3)](generateCookies,{'nonce':_0x1e21a4['TXqfX'],'state':_0x7c7d1b(0xa3)}),'body':{'state':_0x7c7d1b(0xa3),'id_token':makeIdToken({'iss':undefined})}});assert[_0x7c7d1b(0x16c)](_0x74b102,0x190),assert[_0x7c7d1b(0xd5)](_0x627612[_0x7c7d1b(0x137)],/missing required JWT property iss/i);}),it(_0x188e9b(0x14c),async()=>{const _0x545b29=_0x188e9b,{response:{statusCode:_0x1a4a7f,body:{err:_0x1ea6a0}}}=await setup({'cookies':_0x1e21a4[_0x545b29(0x110)](generateCookies,{'state':_0x545b29(0xa3)}),'body':{'state':_0x1e21a4[_0x545b29(0x178)],'id_token':makeIdToken()}});assert[_0x545b29(0x16c)](_0x1a4a7f,0x190),assert[_0x545b29(0xd5)](_0x1ea6a0[_0x545b29(0x137)],/nonce mismatch/i);}),_0x1e21a4['PeLsr'](it,_0x188e9b(0xc1),async()=>{const _0x525af9=_0x188e9b,{response:{statusCode:_0x106963,body:{err:_0x262ed3}}}=await setup({'authOpts':{'legacySameSiteCookie':![]},'cookies':{'_auth_verification':JSON[_0x525af9(0x128)]({'state':_0x1e21a4[_0x525af9(0x178)]})},'body':{'state':_0x1e21a4['UEiHv'],'id_token':'__invalid_token__'}});assert[_0x525af9(0x16c)](_0x106963,0x190),assert['equal'](_0x262ed3['message'],_0x1e21a4[_0x525af9(0xf0)]);}),it(_0x188e9b(0x134),async()=>{const _0x240546=_0x188e9b,{currentUser:_0x4659bd}=await setup({'authOpts':{'identityClaimFilter':[]},'cookies':{'_auth_verification':JSON['stringify']({'state':expectedDefaultState,'nonce':_0x1e21a4[_0x240546(0xdd)]})},'body':{'state':expectedDefaultState,'id_token':_0x1e21a4[_0x240546(0xe0)](makeIdToken)}});assert[_0x240546(0x141)](_0x4659bd);}),_0x1e21a4['KmhNu'](it,_0x188e9b(0x148),async()=>{const _0x12b5ff=_0x188e9b,{currentUser:_0x2808a7}=await setup({'authOpts':{'identityClaimFilter':[]},'cookies':_0x1e21a4['kDQmw'](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4[_0x12b5ff(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x1e21a4[_0x12b5ff(0xf6)](makeIdToken)}});assert[_0x12b5ff(0x16c)](_0x2808a7[_0x12b5ff(0xd2)],_0x1e21a4['pRwHd']),assert[_0x12b5ff(0x16c)](_0x2808a7[_0x12b5ff(0xb9)],clientID),assert[_0x12b5ff(0x16c)](_0x2808a7[_0x12b5ff(0xe5)],_0x1e21a4[_0x12b5ff(0xdd)]),assert[_0x12b5ff(0x141)](_0x2808a7[_0x12b5ff(0x173)]),assert['exists'](_0x2808a7[_0x12b5ff(0x150)]);}),it(_0x188e9b(0x117),async()=>{const _0x491e3e=_0x188e9b,_0x406d19=makeIdToken(),{response:{statusCode:_0x3f1945,headers:_0x2858e1},currentUser:_0x9af815,tokens:_0x18c0e8}=await _0x1e21a4[_0x491e3e(0x110)](setup,{'cookies':_0x1e21a4['zbgwN'](generateCookies,{'state':expectedDefaultState,'nonce':_0x491e3e(0xaf)}),'body':{'state':expectedDefaultState,'id_token':_0x406d19}});assert[_0x491e3e(0x16c)](_0x3f1945,0x12e),assert[_0x491e3e(0x16c)](_0x2858e1[_0x491e3e(0xba)],_0x491e3e(0xf3)),assert['ok'](_0x9af815),assert[_0x491e3e(0x16c)](_0x9af815[_0x491e3e(0xbc)],_0x491e3e(0x145)),assert[_0x491e3e(0x16c)](_0x9af815[_0x491e3e(0xfc)],_0x491e3e(0x12d)),assert[_0x491e3e(0x16e)](_0x9af815['iat']),assert[_0x491e3e(0x16e)](_0x9af815[_0x491e3e(0xd2)]),assert['notExists'](_0x9af815['aud']),assert['notExists'](_0x9af815['exp']),assert[_0x491e3e(0x16e)](_0x9af815[_0x491e3e(0xe5)]),assert[_0x491e3e(0x16c)](_0x18c0e8['isAuthenticated'],!![]),assert['equal'](_0x18c0e8[_0x491e3e(0x11d)],_0x406d19),assert['isUndefined'](_0x18c0e8['refreshToken']),assert[_0x491e3e(0xad)](_0x18c0e8[_0x491e3e(0xf5)]),assert[_0x491e3e(0x167)](_0x18c0e8[_0x491e3e(0x156)],{'sub':_0x1e21a4[_0x491e3e(0xd4)]});}),it(_0x1e21a4['JQMhj'],async()=>{const _0x383cc0=_0x188e9b,_0x1fd0d9=makeIdToken({'c_hash':_0x1e21a4[_0x383cc0(0x158)]}),{tokens:_0x4447b1}=await setup({'authOpts':{'clientSecret':'__test_client_secret__','authorizationParams':{'response_type':_0x383cc0(0xea),'audience':_0x1e21a4[_0x383cc0(0x17e)],'scope':_0x1e21a4['FZZPj']}},'cookies':_0x1e21a4[_0x383cc0(0x112)](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4[_0x383cc0(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x1fd0d9,'code':_0x383cc0(0x13f)}});assert['equal'](_0x4447b1[_0x383cc0(0xb7)],!![]),assert[_0x383cc0(0x16c)](_0x4447b1[_0x383cc0(0x11d)],_0x1fd0d9),assert[_0x383cc0(0x16c)](_0x4447b1[_0x383cc0(0x108)],_0x1e21a4[_0x383cc0(0x127)]),assert['include'](_0x4447b1[_0x383cc0(0xf5)],{'access_token':_0x1e21a4['AMMHq'],'token_type':_0x383cc0(0xc6)}),assert[_0x383cc0(0x167)](_0x4447b1[_0x383cc0(0x156)],{'sub':_0x1e21a4[_0x383cc0(0xd4)]});}),it('should\x20handle\x20access\x20token\x20expiry',async()=>{const _0x48253f=_0x188e9b,_0x3080c6=sinon[_0x48253f(0xd8)]({'toFake':['Date']}),_0x577aaf=makeIdToken({'c_hash':'77QmUPtjPfzWtF2AnpK9RQ'}),_0x8e7c1=_0x1e21a4[_0x48253f(0xa7)](0x3c,0x3c),_0x5d2d3b=_0x8e7c1*0x3e8,{tokens:_0x43f05e,jar:_0x33d9c5}=await _0x1e21a4['iqSUJ'](setup,{'authOpts':{'clientSecret':_0x1e21a4[_0x48253f(0xab)],'authorizationParams':{'response_type':_0x48253f(0x17d)}},'cookies':generateCookies({'state':expectedDefaultState,'nonce':'__test_nonce__'}),'body':{'state':expectedDefaultState,'id_token':_0x577aaf,'code':_0x1e21a4[_0x48253f(0xe9)]}});assert['equal'](_0x43f05e['accessToken'][_0x48253f(0x168)],_0x1e21a4['padbP'](0x18,_0x8e7c1)),_0x3080c6[_0x48253f(0x124)](_0x1e21a4['bytDg'](0x4,_0x5d2d3b));const _0x4611e4=await request[_0x48253f(0x157)](_0x1e21a4[_0x48253f(0x155)],{'baseUrl':baseUrl,'jar':_0x33d9c5,'json':!![]})['then'](_0x2a125f=>_0x2a125f[_0x48253f(0xf1)]);assert['equal'](_0x4611e4['accessToken'][_0x48253f(0x168)],0x14*_0x8e7c1),assert[_0x48253f(0x12f)](_0x4611e4[_0x48253f(0xe6)]),_0x3080c6['tick'](_0x1e21a4[_0x48253f(0x10d)](0x15,_0x5d2d3b));const _0x217ed4=await request[_0x48253f(0x157)](_0x1e21a4[_0x48253f(0x155)],{'baseUrl':baseUrl,'jar':_0x33d9c5,'json':!![]})['then'](_0x528c3d=>_0x528c3d[_0x48253f(0xf1)]);assert['isTrue'](_0x217ed4[_0x48253f(0xe6)]),_0x3080c6[_0x48253f(0xcc)]();}),_0x1e21a4['YTVFm'](it,_0x1e21a4['lndli'],async()=>{const _0x1315f4=_0x188e9b;if(_0x1e21a4[_0x1315f4(0x13d)](_0x1315f4(0xdb),_0x1e21a4[_0x1315f4(0x11c)])){const _0x33fb5e=_0x1e21a4[_0x1315f4(0xfd)](makeIdToken,{'c_hash':_0x1315f4(0xc8)}),_0x23e823={...defaultConfig,'clientSecret':_0x1315f4(0x129),'authorizationParams':{'response_type':_0x1315f4(0xea),'audience':_0x1e21a4[_0x1315f4(0x17e)],'scope':'openid\x20profile\x20email\x20read:reports\x20offline_access'}},_0x2b454a=auth(_0x23e823);_0x2b454a[_0x1315f4(0x157)](_0x1315f4(0x100),async(_0x3af7b3,_0x15c6ed)=>{const _0x3617f0=_0x1315f4,_0x573cc1=await _0x3af7b3[_0x3617f0(0xcb)][_0x3617f0(0xf5)][_0x3617f0(0x13b)]();_0x15c6ed[_0x3617f0(0x16b)]({'accessToken':_0x573cc1,'refreshToken':_0x3af7b3[_0x3617f0(0xcb)][_0x3617f0(0x108)]});});const {tokens:_0x11ef46,jar:_0x539d3f}=await _0x1e21a4['nZVRG'](setup,{'router':_0x2b454a,'authOpts':{'clientSecret':_0x1315f4(0x129),'authorizationParams':{'response_type':_0x1e21a4[_0x1315f4(0x138)],'audience':_0x1e21a4[_0x1315f4(0x17e)],'scope':_0x1315f4(0xf8)}},'cookies':_0x1e21a4['ZSwJu'](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4[_0x1315f4(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x33fb5e,'code':'jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y'}}),_0x260599=sinon[_0x1315f4(0x105)](()=>({'access_token':_0x1315f4(0xcd),'refresh_token':_0x1315f4(0xc0),'id_token':_0x11ef46['idToken'],'token_type':_0x1315f4(0xc6),'expires_in':0x15180})),{interceptors:[_0x5410cd]}=_0x1e21a4[_0x1315f4(0x13c)](nock,'https://op.example.com',{'allowUnmocked':!![]})[_0x1315f4(0x107)](_0x1e21a4[_0x1315f4(0xa9)])[_0x1315f4(0x154)](0xc8,_0x260599),_0x4c837e=await request[_0x1315f4(0x157)](_0x1315f4(0x100),{'baseUrl':baseUrl,'jar':_0x539d3f,'json':!![]})[_0x1315f4(0x175)](_0x51dfb4=>_0x51dfb4[_0x1315f4(0xf1)]);nock[_0x1315f4(0xca)](_0x5410cd),sinon[_0x1315f4(0x149)][_0x1315f4(0xff)](_0x260599,_0x1e21a4['Zmyxi'],_0x1e21a4[_0x1315f4(0x139)]),assert[_0x1315f4(0x16c)](_0x11ef46[_0x1315f4(0xf5)]['access_token'],_0x1315f4(0x17b)),assert['equal'](_0x11ef46[_0x1315f4(0x108)],_0x1e21a4['JTCVr']),assert[_0x1315f4(0x16c)](_0x4c837e[_0x1315f4(0xf5)][_0x1315f4(0x17a)],_0x1e21a4[_0x1315f4(0x104)]),assert[_0x1315f4(0x16c)](_0x4c837e[_0x1315f4(0x108)],_0x1e21a4[_0x1315f4(0xe1)]);const _0x5a7a0d=await request[_0x1315f4(0x157)](_0x1315f4(0xe2),{'baseUrl':baseUrl,'jar':_0x539d3f,'json':!![]})[_0x1315f4(0x175)](_0x17ebb2=>_0x17ebb2[_0x1315f4(0xf1)]);assert['equal'](_0x5a7a0d['accessToken'][_0x1315f4(0x17a)],_0x1e21a4['cZPcY'],_0x1315f4(0xb0));}else throw{'status':0x3e7};}),_0x1e21a4['hGmOW'](it,_0x1e21a4[_0x188e9b(0x12e)],async()=>{const _0x578e10=_0x188e9b,_0x38c66d=_0x1e21a4[_0x578e10(0x110)](makeIdToken,{'c_hash':_0x1e21a4[_0x578e10(0x158)]}),_0x2f7c31={...defaultConfig,'clientSecret':_0x578e10(0x129),'authorizationParams':{'response_type':_0x578e10(0xea),'audience':_0x578e10(0xb6),'scope':'openid\x20profile\x20email\x20read:reports\x20offline_access'}},_0x66c41b=_0x1e21a4[_0x578e10(0x112)](auth,_0x2f7c31);_0x66c41b['get'](_0x578e10(0x100),async(_0x148e63,_0x484d06)=>{const _0x46c152=_0x578e10,_0x2e24b3={'ORrjd':_0x1e21a4[_0x46c152(0xd0)]};if(_0x1e21a4[_0x46c152(0xbf)](_0x46c152(0xf7),_0x46c152(0xf7)))_0x471342[_0x46c152(0x16b)]({'session':_0x47adc8[_0x2e24b3[_0x46c152(0xae)]]});else{const _0x1aafcf=await _0x148e63['oidc'][_0x46c152(0xf5)]['refresh']();_0x484d06[_0x46c152(0x16b)]({'accessToken':_0x1aafcf,'refreshToken':_0x148e63[_0x46c152(0xcb)][_0x46c152(0x108)]});}});const {tokens:_0x4db814,jar:_0x97cf9}=await setup({'router':_0x66c41b,'authOpts':{'clientSecret':_0x1e21a4[_0x578e10(0xab)],'authorizationParams':{'response_type':_0x578e10(0xea),'audience':_0x1e21a4['MIJSv'],'scope':_0x1e21a4['FZZPj']}},'cookies':_0x1e21a4[_0x578e10(0x10a)](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4[_0x578e10(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x38c66d,'code':_0x1e21a4['eKasV']}}),_0x11cb0a=sinon[_0x578e10(0x105)](()=>({'access_token':_0x578e10(0xcd),'id_token':_0x4db814['id_token'],'token_type':'Bearer','expires_in':0x15180})),{interceptors:[_0x36a983]}=_0x1e21a4[_0x578e10(0xb8)](nock,_0x578e10(0xce),{'allowUnmocked':!![]})[_0x578e10(0x107)](_0x1e21a4[_0x578e10(0xa9)])[_0x578e10(0x154)](0xc8,_0x11cb0a),_0xd6be67=await request[_0x578e10(0x157)](_0x1e21a4[_0x578e10(0x102)],{'baseUrl':baseUrl,'jar':_0x97cf9,'json':!![]})[_0x578e10(0x175)](_0xf52eb4=>_0xf52eb4[_0x578e10(0xf1)]);nock[_0x578e10(0xca)](_0x36a983),sinon[_0x578e10(0x149)]['calledWith'](_0x11cb0a,_0x1e21a4[_0x578e10(0xa9)],_0x578e10(0x151)),assert[_0x578e10(0x16c)](_0x4db814[_0x578e10(0xf5)][_0x578e10(0x17a)],_0x578e10(0x17b)),assert[_0x578e10(0x16c)](_0x4db814[_0x578e10(0x108)],_0x1e21a4[_0x578e10(0x127)]),assert[_0x578e10(0x16c)](_0xd6be67['accessToken']['access_token'],_0x578e10(0xcd)),assert['equal'](_0xd6be67[_0x578e10(0x108)],_0x1e21a4['JTCVr']);}),it(_0x1e21a4[_0x188e9b(0xe7)],async()=>{const _0xec66cf=_0x188e9b,_0x2132a4={'BOHgy':function(_0x305b12,_0x4b7812){const _0xbc7550=_0x1257;return _0x1e21a4[_0xbc7550(0x182)](_0x305b12,_0x4b7812);}};if(_0xec66cf(0xda)!==_0x1e21a4[_0xec66cf(0xec)]){const _0x42c121=_0x1e21a4['Nixid'](makeIdToken,{'c_hash':_0x1e21a4[_0xec66cf(0x158)]}),_0x191cd7={...defaultConfig,'clientSecret':_0x1e21a4[_0xec66cf(0xab)],'authorizationParams':{'response_type':_0xec66cf(0xea),'audience':'https://api.example.com/','scope':'openid\x20profile\x20email\x20read:reports\x20offline_access'},'tokenEndpointParams':{'longeLiveToken':!![]}},_0x746dcb=auth(_0x191cd7);_0x746dcb[_0xec66cf(0x157)](_0x1e21a4[_0xec66cf(0x102)],async(_0x725523,_0x4f2306)=>{const _0x1ea4ae=_0xec66cf,_0x1aa1db=await _0x725523[_0x1ea4ae(0xcb)][_0x1ea4ae(0xf5)][_0x1ea4ae(0x13b)]({'tokenEndpointParams':{'force':!![]}});_0x4f2306[_0x1ea4ae(0x16b)]({'accessToken':_0x1aa1db,'refreshToken':_0x725523[_0x1ea4ae(0xcb)][_0x1ea4ae(0x108)]});});const {tokens:_0x54e578,jar:_0x230b64,tokenReqBody:_0x5e3dbc}=await _0x1e21a4[_0xec66cf(0x152)](setup,{'router':_0x746dcb,'authOpts':{'clientSecret':_0x1e21a4[_0xec66cf(0xab)],'authorizationParams':{'response_type':_0x1e21a4['EmXKU'],'audience':_0xec66cf(0xb6),'scope':_0x1e21a4[_0xec66cf(0x121)]}},'cookies':generateCookies({'state':expectedDefaultState,'nonce':_0x1e21a4[_0xec66cf(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x42c121,'code':_0x1e21a4[_0xec66cf(0xe9)]}}),_0x51349d=sinon['spy'](()=>({'access_token':_0xec66cf(0xcd),'refresh_token':'__new_refresh_token__','id_token':_0x54e578['idToken'],'token_type':_0xec66cf(0xc6),'expires_in':0x15180})),{interceptors:[_0x2cb2d0]}=nock(_0xec66cf(0xce),{'allowUnmocked':!![]})[_0xec66cf(0x107)](_0x1e21a4[_0xec66cf(0xa9)])[_0xec66cf(0x154)](0xc8,_0x51349d),_0xb59fa7=await request[_0xec66cf(0x157)](_0x1e21a4[_0xec66cf(0x102)],{'baseUrl':baseUrl,'jar':_0x230b64,'json':!![]})[_0xec66cf(0x175)](_0x1ea8b6=>_0x1ea8b6[_0xec66cf(0xf1)]);nock[_0xec66cf(0xca)](_0x2cb2d0),sinon[_0xec66cf(0x149)]['calledWith'](_0x51349d,_0x1e21a4[_0xec66cf(0xa9)],_0xec66cf(0x12a)),assert[_0xec66cf(0x16c)](_0x54e578[_0xec66cf(0xf5)][_0xec66cf(0x17a)],_0xec66cf(0x17b)),assert['equal'](_0x54e578['refreshToken'],_0x1e21a4[_0xec66cf(0x127)]),assert[_0xec66cf(0x16c)](_0xb59fa7[_0xec66cf(0xf5)][_0xec66cf(0x17a)],_0x1e21a4[_0xec66cf(0x104)]),assert['equal'](_0xb59fa7[_0xec66cf(0x108)],_0x1e21a4[_0xec66cf(0xe1)]),assert[_0xec66cf(0xd5)](_0x5e3dbc,/longeLiveToken=true/);const _0x30f1ba=await request[_0xec66cf(0x157)](_0x1e21a4[_0xec66cf(0x155)],{'baseUrl':baseUrl,'jar':_0x230b64,'json':!![]})[_0xec66cf(0x175)](_0x16dc69=>_0x16dc69[_0xec66cf(0xf1)]);assert[_0xec66cf(0x16c)](_0x30f1ba[_0xec66cf(0xf5)][_0xec66cf(0x17a)],_0x1e21a4[_0xec66cf(0x104)],_0xec66cf(0xb0));}else{let _0x5f665b;_0x50d366['store'](_0x1b164c,{},{'cookie'(_0x18bca8,..._0x19216e){_0x18bca8===_0x44db59&&(_0x5f665b=_0x19216e[0x0]);}},{'value':_0x17e79f[_0xec66cf(0x181)][_0x291232]}),_0x143ac6[_0xec66cf(0xed)](_0x1a9edd+'='+_0x5f665b+_0xec66cf(0x146),_0x2132a4['BOHgy'](_0x11a97f,_0xec66cf(0x164)));}}),_0x1e21a4['lWkJp'](it,_0x188e9b(0xbe),async()=>{const _0x2c60d6=_0x188e9b,_0x455d10=makeIdToken({'c_hash':_0x2c60d6(0xc8)}),_0x5e2c86={...defaultConfig,'clientSecret':_0x1e21a4[_0x2c60d6(0xab)],'authorizationParams':{'response_type':_0x1e21a4[_0x2c60d6(0x138)],'audience':_0x2c60d6(0xb6),'scope':_0x1e21a4['SLBOu']}},_0x5e6858=_0x1e21a4['zbgwN'](auth,_0x5e2c86);_0x5e6858['get'](_0x1e21a4[_0x2c60d6(0x116)],async(_0x385fbd,_0x5bff4c)=>{const _0x34ebac=_0x2c60d6;_0x5bff4c[_0x34ebac(0x16b)](await _0x385fbd[_0x34ebac(0xcb)][_0x34ebac(0xa6)]());});const {jar:_0x2be262}=await setup({'router':_0x5e6858,'authOpts':{'clientSecret':_0x2c60d6(0x129),'authorizationParams':{'response_type':_0x1e21a4[_0x2c60d6(0x138)],'audience':_0x2c60d6(0xb6),'scope':_0x1e21a4['FZZPj']}},'cookies':_0x1e21a4[_0x2c60d6(0x126)](generateCookies,{'state':expectedDefaultState,'nonce':'__test_nonce__'}),'body':{'state':expectedDefaultState,'id_token':_0x455d10,'code':_0x1e21a4[_0x2c60d6(0xe9)]}}),{interceptors:[_0x2c4fc6]}=_0x1e21a4[_0x2c60d6(0x13c)](nock,_0x1e21a4['sqgXu'],{'allowUnmocked':!![]})['get'](_0x2c60d6(0x163))[_0x2c60d6(0x154)](0xc8,()=>({'userInfo':!![],'sub':'__test_sub__'})),_0x412c2c=await request['get'](_0x1e21a4[_0x2c60d6(0x116)],{'baseUrl':baseUrl,'jar':_0x2be262,'json':!![]})[_0x2c60d6(0x175)](_0xfa514f=>_0xfa514f[_0x2c60d6(0xf1)]);nock[_0x2c60d6(0xca)](_0x2c4fc6),assert['deepEqual'](_0x412c2c,{'userInfo':!![],'sub':_0x1e21a4[_0x2c60d6(0xd4)]});}),_0x1e21a4[_0x188e9b(0x120)](it,_0x1e21a4[_0x188e9b(0xb2)],async()=>{const _0x5b7435=_0x188e9b,_0x476ea3=makeIdToken({'c_hash':_0x5b7435(0xc8)}),{tokenReqBody:_0x1802f,tokenReqHeader:_0x4c4ad7}=await _0x1e21a4[_0x5b7435(0xb3)](setup,{'authOpts':{'clientSecret':_0x1e21a4[_0x5b7435(0xab)],'authorizationParams':{'response_type':_0x5b7435(0xea),'audience':_0x1e21a4[_0x5b7435(0x17e)],'scope':_0x1e21a4[_0x5b7435(0x121)]}},'cookies':generateCookies({'state':expectedDefaultState,'nonce':_0x1e21a4[_0x5b7435(0xdd)]}),'body':{'state':expectedDefaultState,'id_token':_0x476ea3,'code':_0x5b7435(0x13f)}}),_0xb1cab3=Buffer[_0x5b7435(0xdc)](_0x4c4ad7[_0x5b7435(0x174)][_0x5b7435(0x170)](_0x5b7435(0x169),''),_0x5b7435(0xc7));assert[_0x5b7435(0x16c)](_0xb1cab3,_0x1e21a4[_0x5b7435(0x12c)]),assert[_0x5b7435(0xd5)](_0x1802f,/code=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y/);}),it(_0x1e21a4[_0x188e9b(0x10f)],async()=>{const _0x515bce=_0x188e9b,_0xfe5b9a=makeIdToken(),_0x5abf18=request['jar']();_0x5abf18[_0x515bce(0xed)](_0x1e21a4[_0x515bce(0xdf)],baseUrl),await _0x1e21a4[_0x515bce(0x179)](setup,{'cookies':_0x1e21a4[_0x515bce(0x177)](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4[_0x515bce(0xdd)],'skipSilentLogin':'1'}),'body':{'state':expectedDefaultState,'id_token':_0xfe5b9a},'jar':_0x5abf18});const _0x1d1b52=_0x5abf18[_0x515bce(0x12b)](baseUrl);assert[_0x515bce(0xa5)](_0x1d1b52[_0x515bce(0x17c)](({key:_0x1e2b71})=>_0x1e2b71===_0x515bce(0xee)));}),context(_0x1e21a4[_0x188e9b(0x147)],async()=>{const _0x34a9f0=_0x188e9b,_0x249275={'ihJHm':function(_0x4e5d79,_0x21144c){return _0x4e5d79(_0x21144c);},'LLcHA':_0x1e21a4[_0x34a9f0(0x158)],'PvhUU':_0x1e21a4[_0x34a9f0(0x17e)],'edhvB':function(_0x45bc07,_0xde439){return _0x45bc07(_0xde439);},'cLhtD':_0x34a9f0(0xaf),'KaPhT':_0x1e21a4[_0x34a9f0(0xe9)]};it(_0x1e21a4['gKcVL'],async()=>{const _0x3340cd=_0x34a9f0,_0x5edf81={'lGSIy':function(_0x486bb8,_0x4482ea){return _0x486bb8===_0x4482ea;},'TQehH':_0x1e21a4[_0x3340cd(0x13a)],'uRBgZ':_0x3340cd(0xeb)},_0x17880d=makeIdToken({'c_hash':'77QmUPtjPfzWtF2AnpK9RQ'}),_0x565947={...defaultConfig,'clientSecret':_0x1e21a4[_0x3340cd(0xab)],'authorizationParams':{'response_type':_0x3340cd(0xea),'audience':_0x3340cd(0xb6),'scope':_0x1e21a4[_0x3340cd(0x15c)]},'afterCallback':async(_0x4ec9e9,_0x49aa40,_0x5bbe17)=>{const _0x3e3f8f=_0x3340cd,_0x2244bc={'DHVze':function(_0x133731,_0x17580d){const _0x56d726=_0x1257;return _0x5edf81[_0x56d726(0x15d)](_0x133731,_0x17580d);}};if(_0x5edf81['lGSIy'](_0x5edf81['TQehH'],_0x5edf81[_0x3e3f8f(0x135)]))_0x2244bc[_0x3e3f8f(0xd9)](_0x4fd8d7,_0x46f2a2)&&(_0x392ace=_0x31eeaa[0x0]);else{const _0x123f34=await _0x4ec9e9[_0x3e3f8f(0xcb)][_0x3e3f8f(0xa6)]();return{..._0x5bbe17,..._0x123f34};}}},{interceptors:[_0x5ea657]}=_0x1e21a4['psMqw'](nock,_0x3340cd(0xce),{'allowUnmocked':!![]})[_0x3340cd(0x157)](_0x1e21a4[_0x3340cd(0x122)])['reply'](0xc8,()=>({'org_id':_0x3340cd(0x14e)})),_0x96c481=auth(_0x565947);_0x96c481['get'](_0x3340cd(0x166),async(_0x5e997b,_0x4eba77)=>{const _0x30c1f0=_0x3340cd;_0x4eba77[_0x30c1f0(0x16b)]({'session':_0x5e997b[_0x30c1f0(0x123)]});});const {jar:_0x893c37}=await _0x1e21a4['LDcxV'](setup,{'router':_0x96c481,'authOpts':{'clientSecret':_0x1e21a4[_0x3340cd(0xab)],'authorizationParams':{'response_type':_0x1e21a4['EmXKU'],'audience':_0x1e21a4[_0x3340cd(0x17e)],'scope':_0x3340cd(0x113)}},'cookies':_0x1e21a4[_0x3340cd(0x110)](generateCookies,{'state':expectedDefaultState,'nonce':_0x1e21a4['TXqfX']}),'body':{'state':expectedDefaultState,'id_token':_0x17880d,'code':_0x1e21a4[_0x3340cd(0xe9)]}});nock[_0x3340cd(0xca)](_0x5ea657);const _0x5e86be=await request[_0x3340cd(0x157)](_0x3340cd(0x166),{'baseUrl':baseUrl,'jar':_0x893c37,'json':!![]})[_0x3340cd(0x175)](_0x31e631=>_0x31e631[_0x3340cd(0xf1)]);assert[_0x3340cd(0x125)](_0x5e86be[_0x3340cd(0xc9)][_0x3340cd(0xfa)],'auth_org_123');}),_0x1e21a4['psMqw'](it,_0x34a9f0(0x180),async()=>{const _0x1ce637=_0x34a9f0,_0x3f1c1d=_0x249275['ihJHm'](makeIdToken,{'c_hash':_0x249275[_0x1ce637(0xe3)]}),_0x1bf2ba={...defaultConfig,'clientSecret':_0x1ce637(0x129),'authorizationParams':{'response_type':_0x1ce637(0xea),'audience':_0x249275['PvhUU'],'scope':_0x1ce637(0x113)},'afterCallback':async()=>{throw{'status':0x3e7};}},{response:{statusCode:_0x2cc302}}=await setup({'router':_0x249275[_0x1ce637(0xd6)](auth,_0x1bf2ba),'authOpts':_0x1bf2ba,'cookies':generateCookies({'state':expectedDefaultState,'nonce':_0x249275[_0x1ce637(0x10c)]}),'body':{'state':expectedDefaultState,'id_token':_0x3f1c1d,'code':_0x249275[_0x1ce637(0x15a)]}});assert[_0x1ce637(0x16c)](_0x2cc302,0x3e7);});});});