const _0x27ed49=_0x5805;function _0x1c5f(){const _0x573e56=['userinfo','code\x20id_token','refreshToken','idTokenClaims','attemptingSilentLogin','response_type\x20includes\x20code,\x20the\x20authorization\x20request\x20will\x20use\x20PKCE','store','claims','req','11Ttrwpi','returnTo','idpLogout','PrPlH','exports','routes','15208TGiQob','bind','callback','name','LKFXN','YrbTu','response_type\x20should\x20be\x20one\x20of\x20','../lib/hooks/getLoginState','errorOnRequiredAuth','replace','lbWJj','host','test','assert','number','call','1161lmvqGC','context','generateNonce','HhABP','fetchUserInfo','udHqo','end-user\x20already\x20logged\x20out,\x20redirecting\x20to\x20%s','redirect','getRedirectUri','GsFUo','scope\x20should\x20contain\x20\x22openid\x22','isAuthenticated','value','Custom\x20state\x20value\x20must\x20be\x20an\x20object.','code','refresh','accessToken','authorizationParams','GET','none','code_challenge','39438JvpXfz','2584020hwqqdr','BWuRl','AzdaW','parse','753296NJZSKO','EdSmQ','7mGOuGo','OxLqk','Ruqtb','expires_at','YPJHA','31883940RaNWRB','1607182eUPFnf','originalUrl','sameSite','hxDTe','req.oidc.login()\x20called\x20with\x20returnTo:\x20%s','Jjsnc','../middleware/attemptSilentLogin','9mgLRMM','oidc','1ObqmEe','authorizationUrl','logout','tokenEndpointParams','auth_verification','includes','XiYCT','dxeHT','./debug','access_token','id_token','code_verifier','url','XxYxH','generateCodeVerifier','1682110OlpXrK','silent','session','response_type','S256','max_age','idToken','config','assign','baseURL','logging\x20out\x20of\x20identity\x20provider,\x20redirecting\x20to\x20%s','calculateCodeChallenge','scope','form_post','once','rZtBN','stringify','user','expired','OIlaT','login','endSessionUrl','silentLogin','VHHTa','url-join','method','xtwoq','AZjhR','logoutParams','nonce','sbnGR','ojNAM','xhVJF','phKbJ','wETWE','refresh_token'];_0x1c5f=function(){return _0x573e56;};return _0x1c5f();}(function(_0x1f550c,_0x11f98c){const _0x2863e3=_0x5805,_0x2d83c4=_0x1f550c();while(!![]){try{const _0x20ec2a=-parseInt(_0x2863e3(0x202))/0x1*(parseInt(_0x2863e3(0x1f9))/0x2)+parseInt(_0x2863e3(0x200))/0x3*(-parseInt(_0x2863e3(0x1f1))/0x4)+-parseInt(_0x2863e3(0x1ed))/0x5+-parseInt(_0x2863e3(0x1ec))/0x6*(-parseInt(_0x2863e3(0x1f3))/0x7)+parseInt(_0x2863e3(0x244))/0x8*(-parseInt(_0x2863e3(0x1d7))/0x9)+parseInt(_0x2863e3(0x211))/0xa*(parseInt(_0x2863e3(0x23e))/0xb)+parseInt(_0x2863e3(0x1f8))/0xc;if(_0x20ec2a===_0x11f98c)break;else _0x2d83c4['push'](_0x2d83c4['shift']());}catch(_0x2508db){_0x2d83c4['push'](_0x2d83c4['shift']());}}}(_0x1c5f,0xab2ff));const cb=require('cb'),url=require(_0x27ed49(0x20e)),urlJoin=require(_0x27ed49(0x229)),{TokenSet}=require('openid-client'),clone=require('clone'),{strict:assert}=require(_0x27ed49(0x1d4)),debug=require(_0x27ed49(0x20a))(_0x27ed49(0x1d8)),{get:getClient}=require('./client'),{encodeState}=require(_0x27ed49(0x24b)),{cancelSilentLogin}=require(_0x27ed49(0x1ff)),weakRef=require('./weakCache');function isExpired(){const _0x1e9382=_0x27ed49;return tokenSet[_0x1e9382(0x1d6)](this)[_0x1e9382(0x223)]();}function _0x5805(_0x2782d3,_0x4b6f66){const _0x1c5f8b=_0x1c5f();return _0x5805=function(_0x580597,_0x4b9ab9){_0x580597=_0x580597-0x1d2;let _0x5a094a=_0x1c5f8b[_0x580597];return _0x5a094a;},_0x5805(_0x2782d3,_0x4b6f66);}async function refresh({tokenEndpointParams:_0x3a5819}={}){const _0x5dbd27=_0x27ed49,_0xd88871={'VHHTa':function(_0x402af8,_0x374512){return _0x402af8(_0x374512);},'YrbTu':function(_0x219d34,_0x526b39){return _0x219d34(_0x526b39);}};let {config:_0x5c34ba,req:_0x3236d6}=_0xd88871[_0x5dbd27(0x228)](weakRef,this);const _0x153658=await _0xd88871[_0x5dbd27(0x228)](getClient,_0x5c34ba),_0x2073aa=tokenSet[_0x5dbd27(0x1d6)](this);let _0x4e25cd;(_0x5c34ba[_0x5dbd27(0x205)]||_0x3a5819)&&(_0x4e25cd={'exchangeBody':{..._0x5c34ba[_0x5dbd27(0x205)],..._0x3a5819}});const _0x1c0e51=await _0x153658[_0x5dbd27(0x1e6)](_0x2073aa,_0x4e25cd),_0x2bd731=_0x3236d6[_0x5c34ba['session'][_0x5dbd27(0x247)]];Object[_0x5dbd27(0x219)](_0x2bd731,{'id_token':_0x1c0e51[_0x5dbd27(0x20c)],'access_token':_0x1c0e51[_0x5dbd27(0x20b)],'refresh_token':_0x1c0e51[_0x5dbd27(0x234)]||_0x2073aa['refresh_token'],'token_type':_0x1c0e51['token_type'],'expires_at':_0x1c0e51[_0x5dbd27(0x1f6)]});const _0x772845=_0xd88871[_0x5dbd27(0x249)](weakRef,_0x2bd731);return delete _0x772845['value'],this[_0x5dbd27(0x1e7)];}function tokenSet(){const _0x21d81a=_0x27ed49,_0x46f813={'nBZAu':function(_0x1017ba,_0x4d9011){return _0x1017ba in _0x4d9011;},'OxLqk':'id_token','udHqo':function(_0x30817c,_0xaa4211){return _0x30817c===_0xaa4211;},'dxeHT':_0x21d81a(0x1fe),'wETWE':function(_0x299666,_0x18f0d0){return _0x299666(_0x18f0d0);},'pQvLl':function(_0x447b56,_0x299d35){return _0x447b56 in _0x299d35;}},_0x2eac2a=weakRef(this),_0x4c9398=_0x2eac2a[_0x21d81a(0x23d)][_0x2eac2a['config'][_0x21d81a(0x213)][_0x21d81a(0x247)]];if(!_0x4c9398||!_0x46f813['nBZAu'](_0x46f813[_0x21d81a(0x1f4)],_0x4c9398)){if(_0x46f813[_0x21d81a(0x1dc)](_0x46f813[_0x21d81a(0x209)],_0x21d81a(0x231)))_0x15c013(new _0x461ef6(_0x21d81a(0x1e4)));else return undefined;}const _0x4fee66=_0x46f813[_0x21d81a(0x233)](weakRef,_0x4c9398);if(!_0x46f813['pQvLl'](_0x21d81a(0x1e3),_0x4fee66)){const {id_token:_0x12d245,access_token:_0xffd76,refresh_token:_0x24710f,token_type:_0x155253,expires_at:_0x17bad2}=_0x4c9398;_0x4fee66[_0x21d81a(0x1e3)]=new TokenSet({'id_token':_0x12d245,'access_token':_0xffd76,'refresh_token':_0x24710f,'token_type':_0x155253,'expires_at':_0x17bad2});}return _0x4fee66[_0x21d81a(0x1e3)];}class RequestContext{constructor(_0x4793ed,_0x3b6cd6,_0x4bc33d,_0x844323){const _0x6c629e=_0x27ed49,_0x491bb9={'PrPlH':function(_0x46ac2b,_0x45355c){return _0x46ac2b(_0x45355c);}};Object[_0x6c629e(0x219)](_0x491bb9[_0x6c629e(0x241)](weakRef,this),{'config':_0x4793ed,'req':_0x3b6cd6,'res':_0x4bc33d,'next':_0x844323});}[_0x27ed49(0x1e2)](){return!!this['idTokenClaims'];}get[_0x27ed49(0x217)](){const _0x206e93=_0x27ed49;try{return tokenSet[_0x206e93(0x1d6)](this)[_0x206e93(0x20c)];}catch(_0x25f47b){return undefined;}}get[_0x27ed49(0x237)](){const _0x2df11b=_0x27ed49;try{return tokenSet[_0x2df11b(0x1d6)](this)[_0x2df11b(0x234)];}catch(_0xb1623c){return undefined;}}get[_0x27ed49(0x1e7)](){const _0x3f944a=_0x27ed49,_0x634924={'OIlaT':function(_0x3cde53,_0x34c0cf){return _0x3cde53||_0x34c0cf;},'rZtBN':_0x3f944a(0x1e0)};try{const {access_token:_0x1d6945,token_type:_0x408496,expires_in:_0x286b09}=tokenSet[_0x3f944a(0x1d6)](this);if(_0x634924[_0x3f944a(0x224)](!_0x1d6945,!_0x408496)||typeof _0x286b09!==_0x3f944a(0x1d5)){if(_0x3f944a(0x1e0)===_0x634924[_0x3f944a(0x220)])return undefined;else try{return _0x5275f5(_0x56cde8[_0x3f944a(0x1d6)](this)[_0x3f944a(0x23c)]());}catch(_0x2e9713){return _0x2364f6;}}return{'access_token':_0x1d6945,'token_type':_0x408496,'expires_in':_0x286b09,'isExpired':isExpired[_0x3f944a(0x245)](this),'refresh':refresh[_0x3f944a(0x245)](this)};}catch(_0x445152){return undefined;}}get[_0x27ed49(0x238)](){const _0xbc1d19=_0x27ed49;try{return clone(tokenSet['call'](this)[_0xbc1d19(0x23c)]());}catch(_0x29d8a8){return undefined;}}get[_0x27ed49(0x222)](){const _0x134f99=_0x27ed49,_0x51ab0b={'BWuRl':function(_0x208cb0,_0x393b12){return _0x208cb0===_0x393b12;},'AzdaW':_0x134f99(0x1f7)};try{if(_0x51ab0b[_0x134f99(0x1ee)](_0x51ab0b[_0x134f99(0x1ef)],_0x134f99(0x22f)))return _0x28c185;else{const {config:{identityClaimFilter:_0x5a1ca9}}=weakRef(this),{idTokenClaims:_0x550391}=this,_0xd6686e=clone(_0x550391);return _0x5a1ca9['forEach'](_0x42df58=>{delete _0xd6686e[_0x42df58];}),_0xd6686e;}}catch(_0x28e26d){return undefined;}}async[_0x27ed49(0x1db)](){const _0x3d2a27=_0x27ed49,_0x555082={'hxDTe':function(_0x36b260,_0x4f6f2f){return _0x36b260(_0x4f6f2f);}},{config:_0x2052d3}=weakRef(this),_0x380b2c=await _0x555082[_0x3d2a27(0x1fc)](getClient,_0x2052d3);return _0x380b2c[_0x3d2a27(0x235)](tokenSet[_0x3d2a27(0x1d6)](this));}}class ResponseContext{constructor(_0x3c8e91,_0x37ec13,_0x564d3e,_0xac4304,_0x5906dd){const _0x43ef62={'rPWGW':function(_0x32dfe0,_0x4f335a){return _0x32dfe0(_0x4f335a);}};Object['assign'](_0x43ef62['rPWGW'](weakRef,this),{'config':_0x3c8e91,'req':_0x37ec13,'res':_0x564d3e,'next':_0xac4304,'transient':_0x5906dd});}get[_0x27ed49(0x24c)](){const _0x4a480c=_0x27ed49,_0x547b5e={'VBJTz':function(_0x54d1f7,_0x4fb6cd){return _0x54d1f7(_0x4fb6cd);}};return _0x547b5e['VBJTz'](weakRef,this)[_0x4a480c(0x218)][_0x4a480c(0x24c)];}[_0x27ed49(0x1df)](){const _0xfb33a7=_0x27ed49,_0x4d19a6={'Yhzls':function(_0x23479f,_0x4e733a){return _0x23479f(_0x4e733a);}},{config:_0x5df6ab}=_0x4d19a6['Yhzls'](weakRef,this);return urlJoin(_0x5df6ab['baseURL'],_0x5df6ab['routes'][_0xfb33a7(0x246)]);}[_0x27ed49(0x227)](_0x578b5b={}){const _0x2c2cce=_0x27ed49,_0x23a094={'HhABP':_0x2c2cce(0x1ea)};return this[_0x2c2cce(0x225)]({..._0x578b5b,'silent':!![],'authorizationParams':{..._0x578b5b[_0x2c2cce(0x1e8)],'prompt':_0x23a094[_0x2c2cce(0x1da)]}});}async['login'](_0x1ea352={}){const _0x1fe8ae=_0x27ed49,_0x15c40c={'lbWJj':function(_0xb65f9a,_0xaa0294){return _0xb65f9a(_0xaa0294);},'Ruqtb':_0x1fe8ae(0x1e9),'XxYxH':'req.oidc.login()\x20without\x20returnTo,\x20using:\x20%s','EdSmQ':_0x1fe8ae(0x1e4),'XiYCT':_0x1fe8ae(0x1e5),'xtwoq':function(_0x487acf,_0x5cd9da,_0x2b97bb){return _0x487acf(_0x5cd9da,_0x2b97bb);},'UVByw':_0x1fe8ae(0x1e1),'ojNAM':_0x1fe8ae(0x215),'LKFXN':_0x1fe8ae(0x21e),'AZjhR':function(_0x20db0a,_0x3965ce){return _0x20db0a(_0x3965ce);}};let {config:_0xbaa7bb,req:_0x46af02,res:_0x5638b7,next:_0xd580fd,transient:_0x3efe02}=weakRef(this);_0xd580fd=_0x15c40c[_0x1fe8ae(0x24e)](cb,_0xd580fd)['once']();const _0x1e48a3=await getClient(_0xbaa7bb);let _0x5d3251=_0xbaa7bb[_0x1fe8ae(0x21a)];if(_0x1ea352[_0x1fe8ae(0x23f)])_0x5d3251=_0x1ea352['returnTo'],debug(_0x1fe8ae(0x1fd),_0x5d3251);else _0x46af02[_0x1fe8ae(0x22a)]===_0x15c40c[_0x1fe8ae(0x1f5)]&&_0x46af02[_0x1fe8ae(0x1fa)]&&(_0x5d3251=_0x46af02[_0x1fe8ae(0x1fa)][_0x1fe8ae(0x24d)](/^\/+/,'/'),debug(_0x15c40c[_0x1fe8ae(0x20f)],_0x5d3251));_0x1ea352={'authorizationParams':{},'returnTo':_0x5d3251,..._0x1ea352},_0x1ea352[_0x1fe8ae(0x1e8)]={'redirect_uri':this[_0x1fe8ae(0x1df)](),..._0xbaa7bb[_0x1fe8ae(0x1e8)],..._0x1ea352[_0x1fe8ae(0x1e8)]};const _0x82e1e3=await _0xbaa7bb['getLoginState'](_0x46af02,_0x1ea352);typeof _0x82e1e3!=='object'&&_0xd580fd(new Error(_0x15c40c[_0x1fe8ae(0x1f2)]));_0x82e1e3[_0x1fe8ae(0x22e)]=_0x3efe02[_0x1fe8ae(0x1d9)]();_0x1ea352[_0x1fe8ae(0x212)]&&(_0x82e1e3[_0x1fe8ae(0x239)]=!![]);const _0x254ad0=_0x1ea352[_0x1fe8ae(0x1e8)][_0x1fe8ae(0x214)]['includes'](_0x1fe8ae(0x1e5));_0x254ad0&&(debug(_0x1fe8ae(0x23a)),_0x82e1e3[_0x1fe8ae(0x20d)]=_0x3efe02[_0x1fe8ae(0x210)]());try{const _0x3bc8f6=['id_token',_0x1fe8ae(0x236),_0x15c40c[_0x1fe8ae(0x208)]];assert(_0x3bc8f6[_0x1fe8ae(0x207)](_0x1ea352[_0x1fe8ae(0x1e8)][_0x1fe8ae(0x214)]),_0x1fe8ae(0x24a)+_0x3bc8f6['join'](',\x20')),_0x15c40c[_0x1fe8ae(0x22b)](assert,/\bopenid\b/[_0x1fe8ae(0x1d3)](_0x1ea352['authorizationParams'][_0x1fe8ae(0x21d)]),_0x15c40c['UVByw']);const _0x58e9a1={'nonce':_0x3efe02[_0x1fe8ae(0x1d9)](),'state':_0x15c40c['lbWJj'](encodeState,_0x82e1e3),..._0x1ea352[_0x1fe8ae(0x1e8)]['max_age']?{'max_age':_0x1ea352['authorizationParams'][_0x1fe8ae(0x216)]}:undefined},_0x119871={..._0x1ea352[_0x1fe8ae(0x1e8)],..._0x58e9a1};_0x254ad0&&(_0x58e9a1[_0x1fe8ae(0x20d)]=_0x3efe02[_0x1fe8ae(0x1d9)](),_0x119871['code_challenge_method']=_0x15c40c[_0x1fe8ae(0x230)],_0x119871[_0x1fe8ae(0x1eb)]=_0x3efe02[_0x1fe8ae(0x21c)](_0x58e9a1[_0x1fe8ae(0x20d)]));_0x3efe02[_0x1fe8ae(0x23b)](_0x1fe8ae(0x206),_0x46af02,_0x5638b7,{'sameSite':_0x1ea352['authorizationParams']['response_mode']===_0x15c40c[_0x1fe8ae(0x248)]?'None':_0xbaa7bb['transactionCookie'][_0x1fe8ae(0x1fb)],'value':JSON[_0x1fe8ae(0x221)](_0x58e9a1)});const _0x56b7d8=_0x1e48a3[_0x1fe8ae(0x203)](_0x119871);debug('redirecting\x20to\x20%s',_0x56b7d8),_0x5638b7[_0x1fe8ae(0x1de)](_0x56b7d8);}catch(_0x57f080){_0x15c40c[_0x1fe8ae(0x22c)](_0xd580fd,_0x57f080);}}async[_0x27ed49(0x204)](_0x80c6a8={}){const _0x49595d=_0x27ed49,_0x54432b={'phKbJ':function(_0x3c7db3,_0x149ed2,_0x49602b){return _0x3c7db3(_0x149ed2,_0x49602b);}};let {config:_0x2dd9a6,req:_0x5d8db3,res:_0x12d044,next:_0x18732c}=weakRef(this);_0x18732c=cb(_0x18732c)[_0x49595d(0x21f)]();const _0x10515e=await getClient(_0x2dd9a6);let _0x40bf04=_0x80c6a8['returnTo']||_0x2dd9a6[_0x49595d(0x243)]['postLogoutRedirect'];_0x54432b[_0x49595d(0x232)](debug,'req.oidc.logout()\x20with\x20return\x20url:\x20%s',_0x40bf04);url[_0x49595d(0x1f0)](_0x40bf04)[_0x49595d(0x1d2)]===null&&(_0x40bf04=urlJoin(_0x2dd9a6[_0x49595d(0x21a)],_0x40bf04));cancelSilentLogin(_0x5d8db3,_0x12d044);if(!_0x5d8db3[_0x49595d(0x201)][_0x49595d(0x1e2)]())return debug(_0x49595d(0x1dd),_0x40bf04),_0x12d044['redirect'](_0x40bf04);const {idToken:_0x4150aa}=_0x5d8db3[_0x49595d(0x201)];_0x5d8db3[_0x2dd9a6[_0x49595d(0x213)][_0x49595d(0x247)]]=undefined;if(!_0x2dd9a6[_0x49595d(0x240)])return debug('performing\x20a\x20local\x20only\x20logout,\x20redirecting\x20to\x20%s',_0x40bf04),_0x12d044[_0x49595d(0x1de)](_0x40bf04);try{_0x40bf04=_0x10515e[_0x49595d(0x226)]({..._0x2dd9a6[_0x49595d(0x22d)],..._0x80c6a8[_0x49595d(0x22d)],'post_logout_redirect_uri':_0x40bf04,'id_token_hint':_0x4150aa});}catch(_0x471d3){return _0x18732c(_0x471d3);}_0x54432b['phKbJ'](debug,_0x49595d(0x21b),_0x40bf04),_0x12d044[_0x49595d(0x1de)](_0x40bf04);}}module[_0x27ed49(0x242)]={'RequestContext':RequestContext,'ResponseContext':ResponseContext};