const _0x191ca6=_0x37a0;function _0x4597(){const _0x54ceac=['oFJKu','auth','method','latBQ','559075JGwojr','oidc','WeXYO','MRUjT','1604271TcjYhv','10077760WFPrLE','split','10OStVBY','28qfHXpf','bWamz','once','../lib/hooks/getLoginState','authentication\x20is\x20required\x20for\x20all\x20routes\x20this\x20middleware\x20is\x20applied\x20to','urlencoded','QhVLF','http-errors','session','exports','assign','adding\x20POST\x20%s\x20route','adding\x20GET\x20%s\x20route','TAmKN','attemptingSilentLogin','see\x20and\x20apply\x20`requiresAuth`\x20middlewares\x20to\x20your\x20protected\x20resources','bGggI','../lib/debug','nhRqW','DuxVC','afterCallback','auth_verification','openidState','qRiHI','6228981iLUejQ','1546544QMJEfd','bkFXH','mSZez','AmeDy','VpPsp','%s\x20%s\x20called','login','getOnce','sJWfF','get','attemptSilentLogin','redirect','XnoWp','routes','parse','TQSlY','Store','./requiresAuth','qngoN','callback','use','2766KngnEs','name','Router','TbAbq','post','uUApq','authRequired','1JFknPS','getRedirectUri','32499456JuaDLS','../lib/appSession','BdCSD','BadRequest','tokenEndpointParams','../lib/context','logout\x20handling\x20route\x20not\x20applied','baseURL','gYMko','gefWD','../lib/client','6167GGgQXJ','logout'];_0x4597=function(){return _0x54ceac;};return _0x4597();}(function(_0x464dd1,_0x468fab){const _0x1dc45f=_0x37a0,_0x2b704a=_0x464dd1();while(!![]){try{const _0x3c1267=parseInt(_0x1dc45f(0x1ad))/0x1*(parseInt(_0x1dc45f(0x191))/0x2)+parseInt(_0x1dc45f(0x1c4))/0x3+parseInt(_0x1dc45f(0x1c8))/0x4*(parseInt(_0x1dc45f(0x1c0))/0x5)+-parseInt(_0x1dc45f(0x1a6))/0x6*(parseInt(_0x1dc45f(0x1ba))/0x7)+parseInt(_0x1dc45f(0x1c5))/0x8+-parseInt(_0x1dc45f(0x190))/0x9*(-parseInt(_0x1dc45f(0x1c7))/0xa)+-parseInt(_0x1dc45f(0x1af))/0xb;if(_0x3c1267===_0x468fab)break;else _0x2b704a['push'](_0x2b704a['shift']());}catch(_0x58f74d){_0x2b704a['push'](_0x2b704a['shift']());}}}(_0x4597,0xa67c6));function _0x37a0(_0x26619c,_0x5614cb){const _0x459783=_0x4597();return _0x37a0=function(_0x37a087,_0x282f3e){_0x37a087=_0x37a087-0x18f;let _0x42360b=_0x459783[_0x37a087];return _0x42360b;},_0x37a0(_0x26619c,_0x5614cb);}const express=require('express'),cb=require('cb'),createError=require(_0x191ca6(0x1cf)),debug=require(_0x191ca6(0x1d9))(_0x191ca6(0x1bd)),{get:getConfig}=require('../lib/config'),{get:getClient}=require(_0x191ca6(0x1b9)),{requiresAuth}=require(_0x191ca6(0x1a2)),attemptSilentLogin=require('./attemptSilentLogin'),TransientCookieHandler=require('../lib/transientHandler'),{RequestContext,ResponseContext}=require(_0x191ca6(0x1b4)),appSession=require(_0x191ca6(0x1b0)),{decodeState}=require(_0x191ca6(0x1cb)),enforceLeadingSlash=_0x12800a=>{const _0x248539=_0x191ca6,_0x5c1193={'VpPsp':function(_0x52ffbe,_0x307845){return _0x52ffbe===_0x307845;},'LxqMV':function(_0x39521c,_0x46414c){return _0x39521c+_0x46414c;}};return _0x5c1193[_0x248539(0x195)](_0x12800a[_0x248539(0x1c6)]('')[0x0],'/')?_0x12800a:_0x5c1193['LxqMV']('/',_0x12800a);},auth=function(_0x308336){const _0x472127=_0x191ca6,_0x3f970e={'TbAbq':function(_0x369e29){return _0x369e29();},'TAmKN':function(_0x50a1a9,_0x3d5f8a){return _0x50a1a9(_0x3d5f8a);},'gefWD':'silent\x20login\x20will\x20be\x20attempted\x20on\x20end-user\x27s\x20initial\x20HTML\x20request','DuxVC':function(_0x23caf9){return _0x23caf9();},'QhVLF':function(_0x1b354b,_0x2801fd,_0x38cc1c){return _0x1b354b(_0x2801fd,_0x38cc1c);},'AmeDy':_0x472127(0x1d4),'sJWfF':_0x472127(0x1b1),'TvjVZ':function(_0x5a3947,_0x1332b4){return _0x5a3947(_0x1332b4);},'oFJKu':function(_0x3fc00d,_0x4d8c8d){return _0x3fc00d===_0x4d8c8d;},'bWamz':function(_0x16e053){return _0x16e053();},'XnoWp':function(_0x411890,_0x32e466){return _0x411890(_0x32e466);},'gYMko':'login\x20handling\x20route\x20not\x20applied','WeXYO':function(_0x5c0a6b,_0x40729e){return _0x5c0a6b!==_0x40729e;},'latBQ':_0x472127(0x1ab),'bGggI':_0x472127(0x1b5),'nhRqW':function(_0x297a27,_0x2c5618){return _0x297a27(_0x2c5618);},'MRUjT':_0x472127(0x1cc),'xLROC':function(_0xced14f){return _0xced14f();},'qKFEl':function(_0x489198,_0x260b23){return _0x489198(_0x260b23);},'qngoN':function(_0x182220){return _0x182220();}},_0x20742a=_0x3f970e[_0x472127(0x19d)](getConfig,_0x308336);_0x3f970e[_0x472127(0x1ce)](debug,'configuration\x20object\x20processed,\x20resulting\x20configuration:\x20%O',_0x20742a);const _0x3e6027=new express[(_0x472127(0x1a8))](),_0x2d4e44=new TransientCookieHandler(_0x20742a);_0x3e6027[_0x472127(0x1a5)](appSession(_0x20742a)),_0x3e6027[_0x472127(0x1a5)](async(_0x5870b6,_0x311390,_0x43657e)=>{const _0x2d7702=_0x472127;_0x5870b6['oidc']=new RequestContext(_0x20742a,_0x5870b6,_0x311390,_0x43657e),_0x311390['oidc']=new ResponseContext(_0x20742a,_0x5870b6,_0x311390,_0x43657e,_0x2d4e44),_0x3f970e[_0x2d7702(0x1a9)](_0x43657e);});if(_0x20742a[_0x472127(0x19e)][_0x472127(0x197)]){const _0x4dc5ec=enforceLeadingSlash(_0x20742a[_0x472127(0x19e)][_0x472127(0x197)]);debug(_0x3f970e[_0x472127(0x194)],_0x4dc5ec),_0x3e6027[_0x472127(0x19a)](_0x4dc5ec,express[_0x472127(0x1cd)]({'extended':![]}),(_0x271b65,_0x4c95ee)=>_0x4c95ee[_0x472127(0x1c1)][_0x472127(0x197)]({'returnTo':_0x20742a[_0x472127(0x1b6)]}));}else _0x3f970e['TvjVZ'](debug,_0x3f970e[_0x472127(0x1b7)]);if(_0x20742a[_0x472127(0x19e)][_0x472127(0x1bb)]){const _0x141e35=enforceLeadingSlash(_0x20742a['routes']['logout']);_0x3f970e[_0x472127(0x1ce)](debug,_0x3f970e[_0x472127(0x194)],_0x141e35),_0x3e6027['get'](_0x141e35,(_0x4beda3,_0xfbff4d)=>_0xfbff4d[_0x472127(0x1c1)][_0x472127(0x1bb)]());}else _0x3f970e[_0x472127(0x1c2)](_0x472127(0x1a0),_0x3f970e[_0x472127(0x1bf)])?_0x3f970e[_0x472127(0x19d)](debug,_0x3f970e[_0x472127(0x1d8)]):_0x1362ee(_0x235acc);{let _0x1552d4;const _0x10a328=_0x3f970e[_0x472127(0x19d)](enforceLeadingSlash,_0x20742a[_0x472127(0x19e)]['callback']),_0x2b386f=[(_0x2073ee,_0x1d6fa4,_0x52fce4)=>{const _0x38685a=_0x472127;debug(_0x38685a(0x196),_0x2073ee[_0x38685a(0x1be)],_0x10a328),_0x3f970e[_0x38685a(0x1a9)](_0x52fce4);},async(_0x7bf9bf,_0xe336cd,_0x7ceddf)=>{const _0x3ebc96=_0x472127,_0x5670ab={'mSZez':function(_0x5695bf,_0x2176de,_0x316056){return _0x3f970e['QhVLF'](_0x5695bf,_0x2176de,_0x316056);},'bkFXH':_0x3f970e[_0x3ebc96(0x194)]};_0x7ceddf=cb(_0x7ceddf)[_0x3ebc96(0x1ca)](),_0x1552d4=_0x1552d4||await getClient(_0x20742a)['catch'](_0x3106ab=>{_0x7ceddf(_0x3106ab);});if(!_0x1552d4){if(_0x3ebc96(0x1b1)!==_0x3f970e[_0x3ebc96(0x199)]){const _0x2eb275=_0x289220(_0x44df1b[_0x3ebc96(0x19e)][_0x3ebc96(0x197)]);_0x5670ab[_0x3ebc96(0x193)](_0x3d80ea,_0x5670ab[_0x3ebc96(0x192)],_0x2eb275),_0x5c94e7[_0x3ebc96(0x19a)](_0x2eb275,_0xdc149c[_0x3ebc96(0x1cd)]({'extended':![]}),(_0x166d85,_0x32c276)=>_0x32c276[_0x3ebc96(0x1c1)]['login']({'returnTo':_0x356960[_0x3ebc96(0x1b6)]}));}else return;}try{const _0x556b9a=_0xe336cd[_0x3ebc96(0x1c1)][_0x3ebc96(0x1ae)]();let _0x4b6121;try{const _0x1a005f=_0x1552d4['callbackParams'](_0x7bf9bf),_0x518b21=_0x2d4e44[_0x3ebc96(0x198)](_0x3ebc96(0x1dd),_0x7bf9bf,_0xe336cd),{max_age:_0x2ffa16,code_verifier:_0x1d2b8a,nonce:_0xa3eb1b,state:_0x5afecc}=_0x518b21?JSON[_0x3ebc96(0x19f)](_0x518b21):{};_0x7bf9bf['openidState']=_0x3f970e['TvjVZ'](decodeState,_0x5afecc);const _0x2cd186={'max_age':_0x2ffa16,'code_verifier':_0x1d2b8a,'nonce':_0xa3eb1b,'state':_0x5afecc};let _0x430e08;_0x20742a[_0x3ebc96(0x1b3)]&&(_0x430e08={'exchangeBody':_0x20742a[_0x3ebc96(0x1b3)]}),_0x4b6121=await _0x1552d4[_0x3ebc96(0x1a4)](_0x556b9a,_0x1a005f,_0x2cd186,_0x430e08);}catch(_0x222818){throw createError[_0x3ebc96(0x1b2)](_0x222818['message']);}_0x20742a[_0x3ebc96(0x1dc)]&&(_0x3f970e[_0x3ebc96(0x1bc)](_0x3ebc96(0x18f),_0x3ebc96(0x18f))?_0x4b6121=await _0x20742a['afterCallback'](_0x7bf9bf,_0xe336cd,Object[_0x3ebc96(0x1d2)]({},_0x4b6121),_0x7bf9bf[_0x3ebc96(0x1de)]):(_0x3f970e[_0x3ebc96(0x1d5)](_0x5466b6,_0x3f970e['gefWD']),_0x354325[_0x3ebc96(0x1a5)](_0x3f970e[_0x3ebc96(0x1db)](_0x5df0d0)))),Object[_0x3ebc96(0x1d2)](_0x7bf9bf[_0x20742a[_0x3ebc96(0x1d0)][_0x3ebc96(0x1a7)]],_0x4b6121),attemptSilentLogin['resumeSilentLogin'](_0x7bf9bf,_0xe336cd),_0x3f970e[_0x3ebc96(0x1c9)](_0x7ceddf);}catch(_0x1bff82){_0x7bf9bf['openidState']&&_0x7bf9bf['openidState'][_0x3ebc96(0x1d6)]?_0x7ceddf():_0x3f970e[_0x3ebc96(0x19d)](_0x7ceddf,_0x1bff82);}},(_0x518976,_0xb32680)=>_0xb32680[_0x472127(0x19c)](_0x518976[_0x472127(0x1de)]['returnTo']||_0x20742a['baseURL'])];_0x3f970e[_0x472127(0x1ce)](debug,_0x472127(0x1d4),_0x10a328),_0x3e6027[_0x472127(0x19a)](_0x10a328,..._0x2b386f),_0x3f970e[_0x472127(0x1ce)](debug,_0x472127(0x1d3),_0x10a328),_0x3e6027[_0x472127(0x1aa)](_0x10a328,express['urlencoded']({'extended':![]}),..._0x2b386f);}return _0x20742a[_0x472127(0x1ac)]?(_0x3f970e[_0x472127(0x1da)](debug,_0x3f970e[_0x472127(0x1c3)]),_0x3e6027[_0x472127(0x1a5)](_0x3f970e['xLROC'](requiresAuth))):debug('authentication\x20is\x20not\x20required\x20for\x20any\x20of\x20the\x20routes\x20this\x20middleware\x20is\x20applied\x20to\x20'+_0x472127(0x1d7)),_0x20742a[_0x472127(0x19b)]&&(_0x3f970e['qKFEl'](debug,_0x3f970e[_0x472127(0x1b8)]),_0x3e6027['use'](_0x3f970e[_0x472127(0x1a3)](attemptSilentLogin))),_0x3e6027;};auth[_0x191ca6(0x1a1)]=function(){},module[_0x191ca6(0x1d1)]=auth;