function _0x37cb(_0xe9722d,_0x1a811c){const _0xd42667=_0xd426();return _0x37cb=function(_0x37cbc6,_0x2cb22b){_0x37cbc6=_0x37cbc6-0x97;let _0x5cdb36=_0xd42667[_0x37cbc6];return _0x5cdb36;},_0x37cb(_0xe9722d,_0x1a811c);}const _0x12cc3b=_0x37cb;(function(_0x44104b,_0x4641e8){const _0x56cddd=_0x37cb,_0x4ea7a4=_0x44104b();while(!![]){try{const _0x1f8fb7=-parseInt(_0x56cddd(0x10a))/0x1+parseInt(_0x56cddd(0xa4))/0x2+-parseInt(_0x56cddd(0xa1))/0x3+parseInt(_0x56cddd(0x98))/0x4+parseInt(_0x56cddd(0xfe))/0x5*(parseInt(_0x56cddd(0xd6))/0x6)+-parseInt(_0x56cddd(0xcf))/0x7+parseInt(_0x56cddd(0xe9))/0x8;if(_0x1f8fb7===_0x4641e8)break;else _0x4ea7a4['push'](_0x4ea7a4['shift']());}catch(_0x3de2b2){_0x4ea7a4['push'](_0x4ea7a4['shift']());}}}(_0xd426,0xe865f));function _0xd426(){const _0x207952=['baz','1398615mZVdiS','moUKn','should\x20return\x20401\x20when\x20anonymous\x20user\x20visits\x20a\x20protected\x20route','95322zQgNnD','should\x20return\x20401\x20when\x20logged\x20in\x20user\x20doesn\x27t\x20have\x20the\x20claim','should\x20make\x20the\x20token\x20claims\x20available\x20to\x20custom\x20check','qux','foo','throws','YzDlS','TYrwQ','VdRED','req.oidc\x20is\x20not\x20found,\x20did\x20you\x20include\x20the\x20auth\x20middleware?','mLUwA','WaJZS','state','should\x20not\x20accept\x20claim\x20values\x20that\x20aren\x27t\x20a\x20string\x20or\x20array','./fixture/server','get','\x22claim\x22\x20must\x20be\x20a\x20string','ohqQA','should\x20ask\x20anonymous\x20user\x20to\x20login\x20when\x20visiting\x20a\x20protected\x20route','YMXxj','xqpOt','XjqGm','\x22expected\x22\x20must\x20be\x20a\x20string,\x20number,\x20boolean\x20or\x20null','DLGAi','message','FhBQE','ywgFL','parse','should\x20throw\x20when\x20claim\x20value\x20is\x20a\x20non\x20primitive','request-promise-native','LwoHn','mcirK','DvwbR','bar','http://localhost:3000','location','/session','should\x20not\x20allow\x20anonymous\x20users\x20to\x20check\x20custom\x20claims','yJsrU','ThVuO','returnTo','znfdq','tCCTk','5012413hVkLYz','Sbgev','KMfUr','should\x20return\x20401\x20when\x20checking\x20many\x20claims\x20with\x20anonymous\x20user','KDzIy','zJZlr','ThDBg','1208904kOjCJx','baz\x20bar','BfJlJ','TblcM','MDIRN','NPzEp','ljdpD','LZnkS','equal','__test_client_id__','KfueC','should\x20allow\x20logged\x20in\x20users\x20to\x20visit\x20a\x20protected\x20route','./..','aLmzD','sinon','Qlnrz','GHClG','bcgsK','DPhLh','825472iuinQl','MEgpq','egtsO','./fixture/cert','/protected','UFcWe','MfdPS','should\x20throw\x20when\x20claim\x20value\x20for\x20checking\x20many\x20claims\x20is\x20a\x20non\x20primitive','some_claim','should\x20return\x20401\x20when\x20logged\x20in\x20user\x20doesn\x27t\x20have\x20the\x20right\x20value\x20for\x20claim','should\x20return\x20401\x20when\x20checking\x20multiple\x20claims\x20and\x20the\x20user\x20doesn\x27t\x20have\x20the\x20claim','statusCode','should\x20throw\x20when\x20there\x27s\x20no\x20auth\x20middleware','NIVJz','thExT','from','PUyPI','ByAOK','should\x20accept\x20claim\x20values\x20as\x20a\x20space\x20separated\x20list','TeMum','xNRCr','30NjdAsS','VhOCG','should\x20throw\x20when\x20custom\x20claim\x20check\x20doesn\x27t\x20get\x20a\x20function','bar\x20baz','https://op.example.com','searchParams','\x22claimCheck\x22\x20expects\x20a\x20function','close','KgoHF','requiresAuth','jar','CEeAk','41618vMDOKL','Saxan','3264144uaAUJK','zdaMO','iJoOz','should\x20return\x20401\x20for\x20logged\x20with\x20some\x20of\x20the\x20requested\x20claims','wqrYY','vftMA','GUbfJ','defaults'];_0xd426=function(){return _0x207952;};return _0xd426();}const {assert}=require('chai'),sinon=require(_0x12cc3b(0xe4)),{create:createServer}=require(_0x12cc3b(0xb2)),{makeIdToken}=require(_0x12cc3b(0xec)),{auth,requiresAuth,claimEquals,claimIncludes,claimCheck}=require(_0x12cc3b(0xe2)),request=require(_0x12cc3b(0xc1))[_0x12cc3b(0x9f)]({'simple':![],'resolveWithFullResponse':!![],'followRedirect':![]}),baseUrl=_0x12cc3b(0xc6),defaultConfig={'secret':'__test_session_secret__','clientID':_0x12cc3b(0xdf),'baseURL':'http://example.org','issuerBaseURL':'https://op.example.com'},login=async _0x2aea88=>{const _0x27cfcf=_0x12cc3b,_0xa8180a={'zdaMO':_0x27cfcf(0xc8),'egtsO':function(_0x22042e,_0x47d973){return _0x22042e(_0x47d973);}},_0x439844=request[_0x27cfcf(0x108)]();return await request['post'](_0xa8180a[_0x27cfcf(0x99)],{'baseUrl':baseUrl,'jar':_0x439844,'json':{'id_token':_0xa8180a[_0x27cfcf(0xeb)](makeIdToken,_0x2aea88)}}),_0x439844;};describe(_0x12cc3b(0x107),()=>{const _0x41b02f=_0x12cc3b,_0xf15ba1={'Saxan':function(_0x1814bc,_0x4693af,_0x4456b4){return _0x1814bc(_0x4693af,_0x4456b4);},'WXCHi':function(_0x235ec9){return _0x235ec9();},'NPzEp':function(_0x24c291,_0x421fdf){return _0x24c291(_0x421fdf);},'XjqGm':function(_0x88cfb4,_0x4f943e){return _0x88cfb4(_0x4f943e);},'UFcWe':function(_0x2e99f1,_0x6ea9b7){return _0x2e99f1(_0x6ea9b7);},'moUKn':_0x41b02f(0xed),'yJsrU':function(_0x1857e9){return _0x1857e9();},'ThVuO':_0x41b02f(0xd0),'FhBQE':_0x41b02f(0xe6),'xNRCr':function(_0x59abc6,_0xd2b017,_0x31d34a){return _0x59abc6(_0xd2b017,_0x31d34a);},'twfOk':function(_0xd67b40){return _0xd67b40();},'xMekp':function(_0x11186f,_0x4f9cad){return _0x11186f(_0x4f9cad);},'ThDBg':function(_0x199f4f,_0x15f24f,_0x4ee5db){return _0x199f4f(_0x15f24f,_0x4ee5db);},'DPhLh':function(_0x3c7efd){return _0x3c7efd();},'KgoHF':_0x41b02f(0xc5),'WaJZS':function(_0x57255d,_0x37408e){return _0x57255d(_0x37408e);},'mcirK':function(_0x548332,_0x1a42cf,_0x38e2bf){return _0x548332(_0x1a42cf,_0x38e2bf);},'iJoOz':_0x41b02f(0xa8),'MDIRN':function(_0x1ae1b8,_0x3c572b){return _0x1ae1b8(_0x3c572b);},'TblcM':_0x41b02f(0xa0),'BfJlJ':_0x41b02f(0xb4),'Qlnrz':_0x41b02f(0xbe),'bcgsK':function(_0x2072a9,_0x4a0775,_0x334d5e){return _0x2072a9(_0x4a0775,_0x334d5e);},'thExT':function(_0x169ba1,_0x31cbfa,_0x5c70ee){return _0x169ba1(_0x31cbfa,_0x5c70ee);},'ByAOK':'\x22expected\x22\x20must\x20be\x20a\x20string,\x20number,\x20boolean\x20or\x20null','dmcXJ':_0x41b02f(0xfc),'znfdq':function(_0x4f7f4b,_0x3e94e2){return _0x4f7f4b(_0x3e94e2);},'wqrYY':function(_0x2ea55c,_0x1dab6e,_0x505abf,_0x2085cd){return _0x2ea55c(_0x1dab6e,_0x505abf,_0x2085cd);},'KfueC':function(_0x942a65,_0x315699){return _0x942a65(_0x315699);},'NIVJz':function(_0x50a6ca,_0x5076a0){return _0x50a6ca(_0x5076a0);},'XYpEk':function(_0x3193dc,_0x39608e,_0x5ce3d3,_0x1f119d,_0x4b4641){return _0x3193dc(_0x39608e,_0x5ce3d3,_0x1f119d,_0x4b4641);},'dEMwq':_0x41b02f(0xd7),'YzDlS':_0x41b02f(0x104),'CEeAk':'tCCTk','LZnkS':function(_0x1950da,_0x42794d){return _0x1950da(_0x42794d);},'DLGAi':_0x41b02f(0x101),'cLYSw':function(_0x124b6c,_0x2d0550){return _0x124b6c(_0x2d0550);},'mLUwA':function(_0x277191,_0x49d6f0,_0xbe63d0,_0x572920){return _0x277191(_0x49d6f0,_0xbe63d0,_0x572920);},'UtyGj':function(_0x20c6c2,_0x14f982){return _0x20c6c2(_0x14f982);},'KMfUr':function(_0x30d105,_0x249b10){return _0x30d105===_0x249b10;},'aLmzD':function(_0x17e436,_0x3f3094){return _0x17e436(_0x3f3094);},'MEgpq':function(_0x3dcc0e,_0x2b632b){return _0x3dcc0e(_0x2b632b);},'DvwbR':_0x41b02f(0xb6),'MfdPS':'should\x20401\x20for\x20anonymous\x20users\x20who\x20don\x27t\x20accept\x20html','ohqQA':function(_0x5ec7aa,_0x3188f6,_0x31900f){return _0x5ec7aa(_0x3188f6,_0x31900f);},'zJZlr':function(_0x78465c,_0x583658,_0x124cb7){return _0x78465c(_0x583658,_0x124cb7);},'fgGQu':'should\x20allow\x20logged\x20in\x20users\x20with\x20the\x20right\x20claim','VhOCG':function(_0x288670,_0x556322,_0x2d144d){return _0x288670(_0x556322,_0x2d144d);},'uALzA':_0x41b02f(0xc0),'xqpOt':function(_0x4ba451,_0xcfbd45,_0x195fa5){return _0x4ba451(_0xcfbd45,_0x195fa5);},'LwoHn':'should\x20allow\x20logged\x20in\x20users\x20with\x20all\x20of\x20the\x20requested\x20claims','WFwFS':_0x41b02f(0x9b),'YMXxj':_0x41b02f(0xfb),'PUyPI':function(_0x5020ad,_0x1fb1f3,_0x1a001a){return _0x5020ad(_0x1fb1f3,_0x1a001a);},'vftMA':function(_0x4aad2a,_0x3ca153,_0xa4a1ca){return _0x4aad2a(_0x3ca153,_0xa4a1ca);},'ljdpD':_0x41b02f(0x100),'CPtId':'should\x20not\x20allow\x20user\x20when\x20custom\x20claim\x20check\x20returns\x20falsey'};let _0x2c08cf;afterEach(async()=>{const _0x144b5b=_0x41b02f;_0x2c08cf&&(_0x144b5b(0xac)!==_0x144b5b(0xac)?_0x2ede3a&&_0x2953b5['close']():_0x2c08cf[_0x144b5b(0x105)]());}),_0xf15ba1[_0x41b02f(0xd5)](it,_0x41b02f(0xe1),async()=>{const _0x28c0e7=_0x41b02f;_0x2c08cf=await _0xf15ba1[_0x28c0e7(0x97)](createServer,auth({...defaultConfig,'authRequired':![]}),requiresAuth());const _0x47baee=await _0xf15ba1['WXCHi'](login),_0x20613a=await _0xf15ba1[_0x28c0e7(0xdb)](request,{'baseUrl':baseUrl,'jar':_0x47baee,'url':_0x28c0e7(0xed)});assert[_0x28c0e7(0xde)](_0x20613a[_0x28c0e7(0xf4)],0xc8);}),it(_0xf15ba1[_0x41b02f(0xc4)],async()=>{const _0x33f6c9=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1[_0x33f6c9(0xb9)](auth,{...defaultConfig,'authRequired':![]}),_0xf15ba1['WXCHi'](requiresAuth));const _0x371181=await _0xf15ba1[_0x33f6c9(0xee)](request,{'baseUrl':baseUrl,'url':'/protected'}),_0x464646=new URL(_0x371181['headers'][_0x33f6c9(0xc7)])[_0x33f6c9(0x103)][_0x33f6c9(0xb3)](_0x33f6c9(0xb0)),_0x2d9859=Buffer[_0x33f6c9(0xf8)](_0x464646,'base64'),_0x4c7fc2=JSON[_0x33f6c9(0xbf)](_0x2d9859);assert['equal'](_0x371181[_0x33f6c9(0xf4)],0x12e),assert['include'](_0x371181['headers'][_0x33f6c9(0xc7)],_0x33f6c9(0x102)),assert[_0x33f6c9(0xde)](_0x4c7fc2[_0x33f6c9(0xcc)],_0xf15ba1['moUKn']);}),it(_0xf15ba1[_0x41b02f(0xef)],async()=>{const _0x3341c1=_0x41b02f;_0x2c08cf=await createServer(auth({...defaultConfig,'authRequired':![]}),_0xf15ba1[_0x3341c1(0xca)](requiresAuth));const _0x26fe41=await request({'baseUrl':baseUrl,'url':_0xf15ba1[_0x3341c1(0xa2)],'json':!![]});assert['equal'](_0x26fe41[_0x3341c1(0xf4)],0x191);}),_0xf15ba1[_0x41b02f(0xb5)](it,_0x41b02f(0xa3),async()=>{const _0x118e3d=_0x41b02f;if(_0xf15ba1[_0x118e3d(0xcb)]!==_0xf15ba1[_0x118e3d(0xbd)]){_0x2c08cf=await _0xf15ba1[_0x118e3d(0xfd)](createServer,_0xf15ba1[_0x118e3d(0xb9)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1['twfOk'](requiresAuth));const _0x3a9621=await _0xf15ba1['xMekp'](request,{'baseUrl':baseUrl,'url':_0xf15ba1['moUKn']});assert[_0x118e3d(0xde)](_0x3a9621[_0x118e3d(0xf4)],0x191);}else _0x4331f3['throws'](()=>_0x4ba5ee('foo',{'bar':0x1}),_0xefacee,_0x118e3d(0xba));}),_0xf15ba1[_0x41b02f(0xe7)](it,_0x41b02f(0xf5),async()=>{const _0x1a8736=_0x41b02f;_0x2c08cf=await _0xf15ba1['ThDBg'](createServer,null,_0xf15ba1[_0x1a8736(0xe8)](requiresAuth));const {body:{err:_0x5c5df0}}=await _0xf15ba1[_0x1a8736(0xdb)](request,{'baseUrl':baseUrl,'url':_0xf15ba1[_0x1a8736(0xa2)],'json':!![]});assert[_0x1a8736(0xde)](_0x5c5df0[_0x1a8736(0xbc)],_0x1a8736(0xad));}),_0xf15ba1[_0x41b02f(0xd4)](it,_0xf15ba1['fgGQu'],async()=>{const _0x383814=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1['XjqGm'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x383814(0xd5)](claimEquals,_0x383814(0xa8),_0xf15ba1[_0x383814(0x106)]));const _0x2b7679=await login({'foo':_0x383814(0xc5)}),_0x52c9b0=await _0xf15ba1[_0x383814(0xaf)](request,{'baseUrl':baseUrl,'jar':_0x2b7679,'url':_0xf15ba1[_0x383814(0xa2)]});assert[_0x383814(0xde)](_0x52c9b0['statusCode'],0xc8);}),it(_0x41b02f(0xf2),async()=>{const _0xf30783=_0x41b02f;_0x2c08cf=await _0xf15ba1[_0xf30783(0xc3)](createServer,auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimEquals(_0xf15ba1[_0xf30783(0x9a)],_0xf15ba1[_0xf30783(0x106)]));const _0x21a783=await login({'foo':_0xf30783(0xa0)}),_0x29902e=await _0xf15ba1['MDIRN'](request,{'baseUrl':baseUrl,'jar':_0x21a783,'url':_0xf15ba1[_0xf30783(0xa2)]});assert['equal'](_0x29902e['statusCode'],0x191);}),_0xf15ba1[_0x41b02f(0xff)](it,_0x41b02f(0xa5),async()=>{const _0x16bbc3=_0x41b02f;_0x2c08cf=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimEquals(_0xf15ba1[_0x16bbc3(0xd9)],_0x16bbc3(0xc5)));const _0xda2afd=await login({'foo':_0x16bbc3(0xc5)}),_0x45ab80=await _0xf15ba1[_0x16bbc3(0xaf)](request,{'baseUrl':baseUrl,'jar':_0xda2afd,'url':_0xf15ba1[_0x16bbc3(0xa2)]});assert[_0x16bbc3(0xde)](_0x45ab80[_0x16bbc3(0xf4)],0x191);}),it('should\x20return\x20401\x20when\x20anonymous\x20user\x20doesn\x27t\x20have\x20the\x20right\x20claim',async()=>{const _0x13f438=_0x41b02f;if('ywgFL'===_0xf15ba1[_0x13f438(0xe5)]){_0x2c08cf=await _0xf15ba1[_0x13f438(0xe7)](createServer,_0xf15ba1['NPzEp'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x13f438(0xf7)](claimEquals,_0x13f438(0xa8),_0xf15ba1['KgoHF']));const _0x3db9dc=await request({'baseUrl':baseUrl,'url':_0xf15ba1[_0x13f438(0xa2)]});assert['equal'](_0x3db9dc[_0x13f438(0xf4)],0x191);}else _0x576820[_0x13f438(0xa9)](()=>_0x14ae1b(!![],_0x13f438(0xc5)),_0x486fd6,_0xf15ba1[_0x13f438(0xd8)]);}),it('should\x20throw\x20when\x20claim\x20is\x20not\x20a\x20string',()=>{const _0x31dc80=_0x41b02f;assert[_0x31dc80(0xa9)](()=>claimEquals(!![],_0x31dc80(0xc5)),TypeError,_0x31dc80(0xb4));}),it(_0xf15ba1['uALzA'],()=>{const _0x9ba179=_0x41b02f;assert[_0x9ba179(0xa9)](()=>claimEquals(_0x9ba179(0xa8),{'bar':0x1}),TypeError,_0xf15ba1[_0x9ba179(0xfa)]);}),_0xf15ba1[_0x41b02f(0xb8)](it,_0xf15ba1[_0x41b02f(0xc2)],async()=>{const _0x4a9f57=_0x41b02f;if(_0xf15ba1['dmcXJ']!==_0x4a9f57(0x9e)){_0x2c08cf=await createServer(_0xf15ba1[_0x4a9f57(0xcd)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x4a9f57(0x9c)](claimIncludes,'foo',_0x4a9f57(0xc5),_0x4a9f57(0xa0)));const _0x33f0a2=await _0xf15ba1[_0x4a9f57(0xe0)](login,{'foo':[_0xf15ba1[_0x4a9f57(0xd9)],_0xf15ba1[_0x4a9f57(0x106)]]}),_0x44a818=await request({'baseUrl':baseUrl,'jar':_0x33f0a2,'url':_0xf15ba1['moUKn']});assert[_0x4a9f57(0xde)](_0x44a818[_0x4a9f57(0xf4)],0xc8);}else _0x38d67d[_0x4a9f57(0xa9)](()=>_0x34a9d8(![],_0x4a9f57(0xc5)),_0x290825,'\x22claim\x22\x20must\x20be\x20a\x20string');}),it(_0xf15ba1['WFwFS'],async()=>{const _0x4ed68b=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1[_0x4ed68b(0xf6)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1['XYpEk'](claimIncludes,_0xf15ba1[_0x4ed68b(0x9a)],_0xf15ba1[_0x4ed68b(0x106)],'baz',_0x4ed68b(0xa7)));const _0x3ed845=await _0xf15ba1[_0x4ed68b(0xee)](login,{'foo':_0xf15ba1['dEMwq']}),_0x3ef803=await _0xf15ba1['UFcWe'](request,{'baseUrl':baseUrl,'jar':_0x3ed845,'url':_0x4ed68b(0xed)});assert[_0x4ed68b(0xde)](_0x3ef803[_0x4ed68b(0xf4)],0x191);}),it(_0xf15ba1[_0x41b02f(0xb7)],async()=>{const _0x13a3ac=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1[_0x13a3ac(0xda)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1['wqrYY'](claimIncludes,_0x13a3ac(0xa8),_0xf15ba1['KgoHF'],_0xf15ba1[_0x13a3ac(0xd9)]));const _0x2ca8b8=await login({'foo':_0x13a3ac(0xd7)}),_0xa85eec=await request({'baseUrl':baseUrl,'jar':_0x2ca8b8,'url':'/protected'});assert[_0x13a3ac(0xde)](_0xa85eec[_0x13a3ac(0xf4)],0xc8);}),_0xf15ba1[_0x41b02f(0xf9)](it,_0x41b02f(0xb1),async()=>{const _0x164093=_0x41b02f;_0x2c08cf=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x164093(0x9c)](claimIncludes,_0x164093(0xa8),'bar',_0xf15ba1[_0x164093(0xd9)]));const _0x1f6ff5=await login({'foo':{'bar':_0xf15ba1['TblcM']}}),_0x19c8ca=await request({'baseUrl':baseUrl,'jar':_0x1f6ff5,'url':_0x164093(0xed)});assert[_0x164093(0xde)](_0x19c8ca[_0x164093(0xf4)],0x191);}),it(_0x41b02f(0xf0),()=>{const _0x4d8412=_0x41b02f;assert[_0x4d8412(0xa9)](()=>claimIncludes(![],_0x4d8412(0xc5)),TypeError,_0xf15ba1[_0x4d8412(0xd8)]);}),it(_0x41b02f(0xf3),async()=>{const _0x27ae9e=_0x41b02f,_0x2e96c5={'TYrwQ':_0xf15ba1[_0x27ae9e(0xaa)]};if(_0xf15ba1[_0x27ae9e(0x109)]!==_0x27ae9e(0xce))_0x163d5d['throws'](()=>_0x5f3e6f(null),_0x58b702,_0x2e96c5[_0x27ae9e(0xab)]);else{_0x2c08cf=await createServer(_0xf15ba1[_0x27ae9e(0xdd)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimIncludes(_0xf15ba1[_0x27ae9e(0x9a)],'bar',_0x27ae9e(0xa0)));const _0x2a5157=await login({'bar':_0xf15ba1[_0x27ae9e(0xbb)]}),_0x1f3b4e=await _0xf15ba1['cLYSw'](request,{'baseUrl':baseUrl,'jar':_0x2a5157,'url':_0x27ae9e(0xed)});assert[_0x27ae9e(0xde)](_0x1f3b4e[_0x27ae9e(0xf4)],0x191);}}),_0xf15ba1[_0x41b02f(0xd4)](it,_0x41b02f(0xd2),async()=>{const _0x5c27e8=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1[_0x5c27e8(0xcd)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x5c27e8(0xae)](claimIncludes,_0xf15ba1[_0x5c27e8(0x9a)],_0xf15ba1[_0x5c27e8(0x106)],_0x5c27e8(0xa0)));const _0xc390db=await _0xf15ba1['UtyGj'](request,{'baseUrl':baseUrl,'url':_0xf15ba1['moUKn']});assert[_0x5c27e8(0xde)](_0xc390db[_0x5c27e8(0xf4)],0x191);}),_0xf15ba1['vftMA'](it,_0xf15ba1[_0x41b02f(0xdc)],async()=>{const _0x27d926=_0x41b02f;assert[_0x27d926(0xa9)](()=>claimCheck(null),TypeError,_0xf15ba1[_0x27d926(0xaa)]);}),it('should\x20allow\x20user\x20when\x20custom\x20claim\x20check\x20returns\x20truthy',async()=>{const _0x3898c0=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1['MDIRN'](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimCheck(()=>!![]));const _0x1d6d39=await _0xf15ba1[_0x3898c0(0xca)](login),_0x447fa4=await request({'baseUrl':baseUrl,'jar':_0x1d6d39,'url':_0x3898c0(0xed)});assert[_0x3898c0(0xde)](_0x447fa4[_0x3898c0(0xf4)],0xc8);}),it(_0xf15ba1['CPtId'],async()=>{const _0x26144f=_0x41b02f;if(_0xf15ba1[_0x26144f(0xd1)](_0x26144f(0xd3),'KDzIy')){_0x2c08cf=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1['cLYSw'](claimCheck,()=>![]));const _0x280de9=await login(),_0x402cda=await _0xf15ba1[_0x26144f(0xdb)](request,{'baseUrl':baseUrl,'jar':_0x280de9,'url':_0xf15ba1[_0x26144f(0xa2)]});assert['equal'](_0x402cda[_0x26144f(0xf4)],0x191);}else _0x233181[_0x26144f(0x105)]();}),_0xf15ba1[_0x41b02f(0x9d)](it,_0x41b02f(0xa6),async()=>{const _0x178cb3=_0x41b02f;_0x2c08cf=await createServer(_0xf15ba1[_0x178cb3(0xf6)](auth,{...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),claimCheck((_0x344ecc,_0x29855e)=>_0x29855e[_0x178cb3(0xa8)]===_0x178cb3(0xf1)));const _0x32ed00=await login({'foo':_0x178cb3(0xf1)}),_0x2dff50=await request({'baseUrl':baseUrl,'jar':_0x32ed00,'url':_0xf15ba1[_0x178cb3(0xa2)]});assert['equal'](_0x2dff50[_0x178cb3(0xf4)],0xc8);}),it(_0x41b02f(0xc9),async()=>{const _0x6df26=_0x41b02f,_0x35c66f=sinon['spy']();_0x2c08cf=await createServer(auth({...defaultConfig,'authRequired':![],'errorOnRequiredAuth':!![]}),_0xf15ba1[_0x6df26(0xe3)](claimCheck,_0x35c66f));const _0x26aaa7=await _0xf15ba1[_0x6df26(0xea)](request,{'baseUrl':baseUrl,'url':_0xf15ba1[_0x6df26(0xa2)]});assert[_0x6df26(0xde)](_0x26aaa7[_0x6df26(0xf4)],0x191),sinon['assert']['notCalled'](_0x35c66f);});});