const _0x1d4131=_0x203c;(function(_0x19550f,_0x1a7f96){const _0x3e2034=_0x203c,_0x11c584=_0x19550f();while(!![]){try{const _0x4735a3=parseInt(_0x3e2034(0x96))/0x1*(-parseInt(_0x3e2034(0xf5))/0x2)+parseInt(_0x3e2034(0x10f))/0x3+-parseInt(_0x3e2034(0xff))/0x4+-parseInt(_0x3e2034(0x95))/0x5+parseInt(_0x3e2034(0x9c))/0x6+parseInt(_0x3e2034(0x10d))/0x7+-parseInt(_0x3e2034(0xbd))/0x8;if(_0x4735a3===_0x1a7f96)break;else _0x11c584['push'](_0x11c584['shift']());}catch(_0x411329){_0x11c584['push'](_0x11c584['shift']());}}}(_0x260d,0xce1a5));const cb=require('cb'),url=require('url'),urlJoin=require(_0x1d4131(0xe8)),{TokenSet}=require(_0x1d4131(0x106)),clone=require(_0x1d4131(0x9b)),{strict:assert}=require(_0x1d4131(0xf6)),debug=require(_0x1d4131(0xf8))(_0x1d4131(0xc0)),{get:getClient}=require(_0x1d4131(0xb0)),{encodeState}=require(_0x1d4131(0xf7)),{cancelSilentLogin}=require(_0x1d4131(0xf4)),weakRef=require('./weakCache');function isExpired(){const _0xf7c7b5=_0x1d4131;return tokenSet[_0xf7c7b5(0xad)](this)[_0xf7c7b5(0xd3)]();}async function refresh({tokenEndpointParams:_0x207456}={}){const _0x205e66=_0x1d4131,_0x1604b4={'ALDMb':function(_0x5c1df6,_0x42e572){return _0x5c1df6(_0x42e572);},'UoMpO':function(_0x58c378,_0x4641ec){return _0x58c378===_0x4641ec;},'Sqrqy':_0x205e66(0x102),'JMVwA':function(_0x4d86ef,_0x1eea56){return _0x4d86ef(_0x1eea56);}};let {config:_0x35eb14,req:_0x295e41}=weakRef(this);const _0xc0b1e=await _0x1604b4[_0x205e66(0xf2)](getClient,_0x35eb14),_0x43c091=tokenSet[_0x205e66(0xad)](this);let _0x4cb2a3;(_0x35eb14[_0x205e66(0xd4)]||_0x207456)&&(_0x1604b4['UoMpO'](_0x1604b4[_0x205e66(0xa6)],_0x205e66(0x102))?_0x4cb2a3={'exchangeBody':{..._0x35eb14[_0x205e66(0xd4)],..._0x207456}}:_0x9bb7b7[_0x205e66(0xa4)]=!![]);const _0x477c1d=await _0xc0b1e[_0x205e66(0xed)](_0x43c091,_0x4cb2a3),_0xde0872=_0x295e41[_0x35eb14['session'][_0x205e66(0xfb)]];Object['assign'](_0xde0872,{'id_token':_0x477c1d['id_token'],'access_token':_0x477c1d[_0x205e66(0xa2)],'refresh_token':_0x477c1d[_0x205e66(0xe9)]||_0x43c091[_0x205e66(0xe9)],'token_type':_0x477c1d[_0x205e66(0xb4)],'expires_at':_0x477c1d[_0x205e66(0xc1)]});const _0x70dc1a=_0x1604b4[_0x205e66(0xe6)](weakRef,_0xde0872);return delete _0x70dc1a[_0x205e66(0xc6)],this['accessToken'];}function _0x260d(){const _0x5c5269=['expires_at','generateCodeVerifier','req.oidc.login()\x20without\x20returnTo,\x20using:\x20%s','code_verifier','login','value','TCkak','code_challenge','TeHAx','test','userinfo','KdRQN','WCgSA','join','logging\x20out\x20of\x20identity\x20provider,\x20redirecting\x20to\x20%s','isAuthenticated','GET','WzTBn','expired','tokenEndpointParams','response_type','errorOnRequiredAuth','refreshToken','redirecting\x20to\x20%s','DXmuE','baseURL','authorizationUrl','NcxML','sameSite','htWdD','generateNonce','config','none','QxGvB','logoutParams','code\x20id_token','idpLogout','JMVwA','code','url-join','refresh_token','S256','qYUcP','host','refresh','qconb','getRedirectUri','KTmlH','CpWtr','ALDMb','response_mode','../middleware/attemptSilentLogin','375626jESSom','assert','../lib/hooks/getLoginState','./debug','TbCtP','nonce','name','assign','hNofv','idToken','839808bUknfy','fetchUserInfo','forEach','aWxpa','session','req','max_age','openid-client','returnTo','once','number','RErMK','RvPLW','stringify','9407594YDJlpB','idTokenClaims','890718sqMarh','jyAjD','oidc','FErjs','1374625tAyfBH','1fFRFKw','originalUrl','jqFCw','MyvqL','RztDh','clone','871020hGJChe','SjRcZ','postLogoutRedirect','silent','Custom\x20state\x20value\x20must\x20be\x20an\x20object.','redirect','access_token','BxenI','attemptingSilentLogin','bWQrF','Sqrqy','end-user\x20already\x20logged\x20out,\x20redirecting\x20to\x20%s','OytLZ','endSessionUrl','callback','calculateCodeChallenge','id_token','call','req.oidc.login()\x20called\x20with\x20returnTo:\x20%s','logout','./client','authorizationParams','form_post','routes','token_type','transactionCookie','getLoginState','bind','includes','response_type\x20includes\x20code,\x20the\x20authorization\x20request\x20will\x20use\x20PKCE','object','XdQvM','pORdy','2153048LnwqcB','store','TWFXj','context'];_0x260d=function(){return _0x5c5269;};return _0x260d();}function tokenSet(){const _0xa08ae5=_0x1d4131,_0x26174a={'TWFXj':_0xa08ae5(0xac),'NcxML':_0xa08ae5(0xc6)},_0x49a427=weakRef(this),_0x3083b8=_0x49a427[_0xa08ae5(0x104)][_0x49a427[_0xa08ae5(0xe0)]['session'][_0xa08ae5(0xfb)]];if(!_0x3083b8||!(_0x26174a[_0xa08ae5(0xbf)]in _0x3083b8))return undefined;const _0x1be3e9=weakRef(_0x3083b8);if(!(_0x26174a[_0xa08ae5(0xdc)]in _0x1be3e9)){const {id_token:_0xcb87d8,access_token:_0x3785da,refresh_token:_0x4bab4e,token_type:_0x1813af,expires_at:_0x205fd3}=_0x3083b8;_0x1be3e9[_0xa08ae5(0xc6)]=new TokenSet({'id_token':_0xcb87d8,'access_token':_0x3785da,'refresh_token':_0x4bab4e,'token_type':_0x1813af,'expires_at':_0x205fd3});}return _0x1be3e9['value'];}class RequestContext{constructor(_0x67f865,_0x5ac9ed,_0x4b2301,_0x4da7d3){const _0x22dd3e=_0x1d4131;Object[_0x22dd3e(0xfc)](weakRef(this),{'config':_0x67f865,'req':_0x5ac9ed,'res':_0x4b2301,'next':_0x4da7d3});}[_0x1d4131(0xd0)](){const _0x1fcec6=_0x1d4131;return!!this[_0x1fcec6(0x10e)];}get[_0x1d4131(0xfe)](){const _0x3f6db3=_0x1d4131;try{return tokenSet[_0x3f6db3(0xad)](this)[_0x3f6db3(0xac)];}catch(_0x48a5eb){return undefined;}}get[_0x1d4131(0xd7)](){const _0x54b363=_0x1d4131;try{return tokenSet[_0x54b363(0xad)](this)[_0x54b363(0xe9)];}catch(_0x21ad03){return undefined;}}get['accessToken'](){const _0x56e728=_0x1d4131,_0x481af4={'VWpov':function(_0x4de5b8,_0x517d1a){return _0x4de5b8||_0x517d1a;},'CpWtr':_0x56e728(0x109),'SjRcZ':_0x56e728(0x94)};try{const {access_token:_0x1439cd,token_type:_0x36df8d,expires_in:_0xb6e15c}=tokenSet[_0x56e728(0xad)](this);if(_0x481af4['VWpov'](!_0x1439cd,!_0x36df8d)||typeof _0xb6e15c!==_0x481af4[_0x56e728(0xf1)])return undefined;return{'access_token':_0x1439cd,'token_type':_0x36df8d,'expires_in':_0xb6e15c,'isExpired':isExpired[_0x56e728(0xb7)](this),'refresh':refresh[_0x56e728(0xb7)](this)};}catch(_0x53ae59){return _0x56e728(0xd9)!==_0x481af4[_0x56e728(0x9d)]?undefined:_0xd5e887;}}get['idTokenClaims'](){const _0x4b9374=_0x1d4131;try{return clone(tokenSet[_0x4b9374(0xad)](this)['claims']());}catch(_0x2d7356){return undefined;}}get['user'](){const _0x1c9407=_0x1d4131,_0x15fec7={'TCkak':function(_0x714d7e,_0x327365){return _0x714d7e(_0x327365);}};try{const {config:{identityClaimFilter:_0x35e8d6}}=weakRef(this),{idTokenClaims:_0x2ff4b6}=this,_0x1dbf81=_0x15fec7[_0x1c9407(0xc7)](clone,_0x2ff4b6);return _0x35e8d6[_0x1c9407(0x101)](_0x580e3d=>{delete _0x1dbf81[_0x580e3d];}),_0x1dbf81;}catch(_0x5e9e61){return undefined;}}async[_0x1d4131(0x100)](){const _0x10c740=_0x1d4131,_0x14a9c2={'WCgSA':function(_0x1712e4,_0x4402f5){return _0x1712e4(_0x4402f5);}},{config:_0x1161ad}=_0x14a9c2[_0x10c740(0xcd)](weakRef,this),_0x15057d=await _0x14a9c2[_0x10c740(0xcd)](getClient,_0x1161ad);return _0x15057d[_0x10c740(0xcb)](tokenSet['call'](this));}}class ResponseContext{constructor(_0x45ad24,_0x5a4ed4,_0x3c6681,_0x4c0be1,_0x2e301a){const _0x2c6d22=_0x1d4131,_0x8d3fa={'Dgdyb':function(_0x145671,_0x4d371a){return _0x145671(_0x4d371a);}};Object[_0x2c6d22(0xfc)](_0x8d3fa['Dgdyb'](weakRef,this),{'config':_0x45ad24,'req':_0x5a4ed4,'res':_0x3c6681,'next':_0x4c0be1,'transient':_0x2e301a});}get[_0x1d4131(0xd6)](){const _0x18df0e=_0x1d4131;return weakRef(this)[_0x18df0e(0xe0)]['errorOnRequiredAuth'];}[_0x1d4131(0xef)](){const _0xb125c7=_0x1d4131,_0xf7202={'UZhWd':function(_0xf21d8e,_0x352302){return _0xf21d8e(_0x352302);}},{config:_0x2d4563}=_0xf7202['UZhWd'](weakRef,this);return urlJoin(_0x2d4563[_0xb125c7(0xda)],_0x2d4563[_0xb125c7(0xb3)][_0xb125c7(0xaa)]);}['silentLogin'](_0x47995a={}){const _0x29b7a6=_0x1d4131;return this[_0x29b7a6(0xc5)]({..._0x47995a,'silent':!![],'authorizationParams':{..._0x47995a[_0x29b7a6(0xb1)],'prompt':_0x29b7a6(0xe1)}});}async[_0x1d4131(0xc5)](_0x1d7a25={}){const _0x3c1175=_0x1d4131,_0x133320={'jyAjD':function(_0x477732,_0x34bb5b){return _0x477732(_0x34bb5b);},'KdRQN':_0x3c1175(0xc3),'MyvqL':function(_0x4742e1,_0x294243){return _0x4742e1(_0x294243);},'hNofv':function(_0x131cd7,_0x4b3015,_0x3c1582){return _0x131cd7(_0x4b3015,_0x3c1582);},'TeHAx':_0x3c1175(0xae),'YrIpY':function(_0x2ee2ab,_0x23e3f3){return _0x2ee2ab===_0x23e3f3;},'zhvPK':_0x3c1175(0xd1),'AQMba':function(_0xfa2e83,_0x46dc04){return _0xfa2e83!==_0x46dc04;},'OytLZ':_0x3c1175(0xa5),'jqFCw':'code','WzTBn':_0x3c1175(0xb9),'pORdy':function(_0x213f05,_0x269e8b){return _0x213f05!==_0x269e8b;},'BxenI':_0x3c1175(0xe4),'QxGvB':function(_0xb41e41,_0x3a08cc,_0x15ceda){return _0xb41e41(_0x3a08cc,_0x15ceda);},'qYUcP':'scope\x20should\x20contain\x20\x22openid\x22','htWdD':_0x3c1175(0xea),'RErMK':'auth_verification','qconb':function(_0x5b3233,_0x57aa95){return _0x5b3233===_0x57aa95;},'KTmlH':_0x3c1175(0xd8)};let {config:_0x6b28d0,req:_0x470f16,res:_0x4ebc3a,next:_0x48b6ea,transient:_0x3845f1}=_0x133320['jyAjD'](weakRef,this);_0x48b6ea=_0x133320[_0x3c1175(0x110)](cb,_0x48b6ea)['once']();const _0x1d2b8c=await _0x133320[_0x3c1175(0x99)](getClient,_0x6b28d0);let _0x47afe6=_0x6b28d0[_0x3c1175(0xda)];if(_0x1d7a25[_0x3c1175(0x107)])_0x47afe6=_0x1d7a25[_0x3c1175(0x107)],_0x133320[_0x3c1175(0xfd)](debug,_0x133320[_0x3c1175(0xc9)],_0x47afe6);else _0x133320['YrIpY'](_0x470f16['method'],_0x133320['zhvPK'])&&_0x470f16['originalUrl']&&(_0x47afe6=_0x470f16[_0x3c1175(0x97)],debug(_0x133320[_0x3c1175(0xcc)],_0x47afe6));_0x1d7a25={'authorizationParams':{},'returnTo':_0x47afe6,..._0x1d7a25},_0x1d7a25[_0x3c1175(0xb1)]={'redirect_uri':this[_0x3c1175(0xef)](),..._0x6b28d0['authorizationParams'],..._0x1d7a25[_0x3c1175(0xb1)]};const _0x1db5db=await _0x6b28d0[_0x3c1175(0xb6)](_0x470f16,_0x1d7a25);typeof _0x1db5db!==_0x3c1175(0xba)&&(_0x133320['AQMba'](_0x3c1175(0xa5),_0x133320[_0x3c1175(0xa8)])?_0x133320['jyAjD'](_0x20211d,_0x2ccab4):_0x133320[_0x3c1175(0x110)](_0x48b6ea,new Error(_0x3c1175(0xa0))));_0x1db5db[_0x3c1175(0xfa)]=_0x3845f1[_0x3c1175(0xdf)]();_0x1d7a25[_0x3c1175(0x9f)]&&(_0x1db5db['attemptingSilentLogin']=!![]);const _0x4128e6=_0x1d7a25[_0x3c1175(0xb1)][_0x3c1175(0xd5)][_0x3c1175(0xb8)](_0x133320[_0x3c1175(0x98)]);_0x4128e6&&(debug(_0x133320[_0x3c1175(0xd2)]),_0x1db5db['code_verifier']=_0x3845f1[_0x3c1175(0xc2)]());try{if(_0x133320[_0x3c1175(0xbc)]('RztDh',_0x3c1175(0x9a)))_0x4901eb=_0x181e01['originalUrl'],_0x83663b(_0x133320[_0x3c1175(0xcc)],_0x1a8b95);else{const _0x7d51e8=[_0x3c1175(0xac),_0x133320[_0x3c1175(0xa3)],_0x3c1175(0xe7)];_0x133320[_0x3c1175(0xe2)](assert,_0x7d51e8[_0x3c1175(0xb8)](_0x1d7a25['authorizationParams']['response_type']),'response_type\x20should\x20be\x20one\x20of\x20'+_0x7d51e8[_0x3c1175(0xce)](',\x20')),assert(/\bopenid\b/[_0x3c1175(0xca)](_0x1d7a25[_0x3c1175(0xb1)]['scope']),_0x133320[_0x3c1175(0xeb)]);const _0x442821={'nonce':_0x3845f1[_0x3c1175(0xdf)](),'state':encodeState(_0x1db5db),..._0x1d7a25[_0x3c1175(0xb1)]['max_age']?{'max_age':_0x1d7a25[_0x3c1175(0xb1)][_0x3c1175(0x105)]}:undefined},_0x5ca238={..._0x1d7a25['authorizationParams'],..._0x442821};_0x4128e6&&(_0x442821[_0x3c1175(0xc4)]=_0x3845f1[_0x3c1175(0xdf)](),_0x5ca238['code_challenge_method']=_0x133320[_0x3c1175(0xde)],_0x5ca238[_0x3c1175(0xc8)]=_0x3845f1[_0x3c1175(0xab)](_0x442821[_0x3c1175(0xc4)]));_0x3845f1[_0x3c1175(0xbe)](_0x133320[_0x3c1175(0x10a)],_0x470f16,_0x4ebc3a,{'sameSite':_0x133320[_0x3c1175(0xee)](_0x1d7a25['authorizationParams'][_0x3c1175(0xf3)],_0x3c1175(0xb2))?'None':_0x6b28d0[_0x3c1175(0xb5)][_0x3c1175(0xdd)],'value':JSON[_0x3c1175(0x10c)](_0x442821)});const _0x24a65b=_0x1d2b8c[_0x3c1175(0xdb)](_0x5ca238);debug(_0x133320[_0x3c1175(0xf0)],_0x24a65b),_0x4ebc3a[_0x3c1175(0xa1)](_0x24a65b);}}catch(_0x772543){_0x48b6ea(_0x772543);}}async[_0x1d4131(0xaf)](_0x26fd25={}){const _0x1caebc=_0x1d4131,_0x238776={'XdQvM':function(_0x28719a,_0x114d7f){return _0x28719a(_0x114d7f);},'RvPLW':function(_0x3bfd76,_0x5bc900){return _0x3bfd76(_0x5bc900);},'TbCtP':function(_0x1b2dd1,_0x267a2a,_0x107b3b){return _0x1b2dd1(_0x267a2a,_0x107b3b);}};let {config:_0x1460b3,req:_0x50d026,res:_0x342a2e,next:_0x4883f9}=weakRef(this);_0x4883f9=_0x238776[_0x1caebc(0xbb)](cb,_0x4883f9)[_0x1caebc(0x108)]();const _0x1968aa=await _0x238776[_0x1caebc(0x10b)](getClient,_0x1460b3);let _0x23b031=_0x26fd25[_0x1caebc(0x107)]||_0x1460b3[_0x1caebc(0xb3)][_0x1caebc(0x9e)];_0x238776[_0x1caebc(0xf9)](debug,'req.oidc.logout()\x20with\x20return\x20url:\x20%s',_0x23b031);url['parse'](_0x23b031)[_0x1caebc(0xec)]===null&&(_0x23b031=urlJoin(_0x1460b3[_0x1caebc(0xda)],_0x23b031));cancelSilentLogin(_0x50d026,_0x342a2e);if(!_0x50d026[_0x1caebc(0x111)][_0x1caebc(0xd0)]())return debug(_0x1caebc(0xa7),_0x23b031),_0x342a2e[_0x1caebc(0xa1)](_0x23b031);const {idToken:_0x5288ec}=_0x50d026[_0x1caebc(0x111)];_0x50d026[_0x1460b3[_0x1caebc(0x103)][_0x1caebc(0xfb)]]=undefined;if(!_0x1460b3[_0x1caebc(0xe5)])return debug('performing\x20a\x20local\x20only\x20logout,\x20redirecting\x20to\x20%s',_0x23b031),_0x342a2e['redirect'](_0x23b031);try{_0x23b031=_0x1968aa[_0x1caebc(0xa9)]({..._0x1460b3['logoutParams'],..._0x26fd25[_0x1caebc(0xe3)],'post_logout_redirect_uri':_0x23b031,'id_token_hint':_0x5288ec});}catch(_0x5eac77){return _0x4883f9(_0x5eac77);}_0x238776[_0x1caebc(0xf9)](debug,_0x1caebc(0xcf),_0x23b031),_0x342a2e['redirect'](_0x23b031);}}function _0x203c(_0x16280a,_0x3c5750){const _0x260da5=_0x260d();return _0x203c=function(_0x203c75,_0x525ba0){_0x203c75=_0x203c75-0x94;let _0x130f62=_0x260da5[_0x203c75];return _0x130f62;},_0x203c(_0x16280a,_0x3c5750);}module['exports']={'RequestContext':RequestContext,'ResponseContext':ResponseContext};