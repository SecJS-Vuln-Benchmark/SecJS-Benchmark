const _0x54a8a6=_0x38f8;(function(_0x17a721,_0x539b6b){const _0x43616f=_0x38f8,_0x57f513=_0x17a721();while(!![]){try{const _0xb50cff=parseInt(_0x43616f(0x1be))/0x1+-parseInt(_0x43616f(0x1f9))/0x2*(-parseInt(_0x43616f(0x294))/0x3)+-parseInt(_0x43616f(0x209))/0x4*(-parseInt(_0x43616f(0x20e))/0x5)+-parseInt(_0x43616f(0x289))/0x6*(parseInt(_0x43616f(0x210))/0x7)+-parseInt(_0x43616f(0x1ed))/0x8+parseInt(_0x43616f(0x240))/0x9+parseInt(_0x43616f(0x297))/0xa;if(_0xb50cff===_0x539b6b)break;else _0x57f513['push'](_0x57f513['shift']());}catch(_0x406974){_0x57f513['push'](_0x57f513['shift']());}}}(_0x2714,0x318d7));function _0x2714(){const _0x194adf=['wVBZR','amount','VNqPi','page','editDiscount','Menu\x20created\x20successfully.','customers','path','271371gEJdJL','JMPyu','newMenu','KteKy','vWClb','result','userPassword','FazjM','isAfter','session','$o.v.quantity','searchValue','decode','wOQHC','app','BFrVH','dUXUT','settings-discounts','/admin/dashboard','Update','LeYim','anEAB','/uploads','emailAddress','settings-menu','gPqhA','pages','safe','/admin/settings/discounts','html-entities','FGTgx','/admin/settings/update','XgUVE','Permalink\x20already\x20exists','LwMHU','lookup','Yjwea','VDPop','GJoHD','RYnTy','_id','findOneAndUpdate','isBefore','API\x20Key\x20generated','pTkXE','value','/admin/settings/discount/create','2496400jrvwdY','sortMenu','FVDHV','footerHtml','A\x20user\x20with\x20that\x20email\x20does\x20not\x20exist.','oXwrt','ghpnU','DBozS','checkDirectorySync','fopQP','fLKkz','apiKey','4lINxIF','CLTxf','STByC','Setup','productImage','Your\x20email\x20settings\x20are\x20working','cGZqd','VImKi','getMenu','2|1|0|3|4','Page\x20updated\x20successfully','colors','code','orderEmail','eOEwh','xHNFH','332MbHQyv','Cart\x20dashboard','WyMef','dJjKi','originalname','16015KUaeEq','Page\x20not\x20found','7PwHPjA','handlebars','updateMenu','MPmcc','Create','aiHBA','json','qauHs','isAdmin','$or','pageId','JZdaQ','isSGD','EfkbE','render','Discount\x20code\x20edit','sFBdX','file','yYGHp','User\x20account\x20inserted','getThemes','length','pipe','bcryptjs','Page\x20successfully\x20deleted','yHBjV','jokaF','AllHtmlEntities','showFooter','JwpmT','usersName','VAjNn','drVuz','JMbhu','toDate','Successfully\x20saved','getId','Failed\x20saving\x20menu\x20order','File\x20upload\x20error.\x20Please\x20try\x20again.','Permission\x20denied','single','insertOne','$o.v.productImage','Static\x20pages','Error\x20updating\x20page.\x20Please\x20try\x20again.','CMxWE','express','messageType','1112175LhFqwp','/admin/file/upload','undefined','EOPhv','File\x20type\x20not\x20allowed\x20or\x20too\x20large.\x20Please\x20try\x20again.','uploadFile','productId','/admin/searchall','settings-discount-new','xMUms','Failed\x20to\x20save.\x20Please\x20try\x20again','limit','XZXvk','DYWPD','JPVhb','dashboard','QIeLJ','/admin/settings/discount/edit/:id','fzvMX','insertedId','qXQxg','Error\x20creating\x20page.\x20Please\x20try\x20again.','Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.','toString','sort','/admin/settings','MsGaX','toArray','setup','products','return\x20Object.keys({a:1});','Test\x20email\x20sent','Failed\x20creating\x20menu.','menuId','Failed\x20to\x20insert\x20user:\x20','Setup\x20failed','wehVF','split','return\x20new\x20Date();','log','then','MRVVT','expressCart\x20test\x20email','/admin/settings/menu','oGGhU','img','ZaGOr','params','Login\x20successful','pageSlug','opaxY','getConfig','end','createWriteStream','../lib/schema','kepQN','pageContent','red','/admin/setup','YUtjK','updateConfig','productsSold','abALZ','ngBKZ','test','XhsjP','findOne','/admin/settings/menu/new','/admin/settings/menu/delete','nZpCH','eqDii','ordersAmount','hbXuy','1185726tCEjqp','JEBAe','Referer','needsSetup','/admin/login','sum','/admin/settings/page','SdSfP','sZPjQ','replace','uvopc','17259FpSCNG','/admin/settings/pages/new','xQQfR','403370oMiAHk','/admin/settings/menu/update','helpers','body','docId','/admin/logout','pmciS','Already\x20setup.','redirect','sendEmail','Failed\x20deleting\x20menu.','Error\x20deleting\x20discount\x20code.\x20Please\x20try\x20again.','Discount\x20code\x20successfully\x20deleted','join','uxROB','orders','multer','Router','stringify','triXY','/admin/settings/page/delete','orderMenu','IBhOg','Cart\x20menu','status','UeAdM','RZwkP','googleAnalytics','LHFku','/admin/login_action','Tdzcg','kLgSA','countDocuments','settings','settings-page','settings-discount-edit','geSfC','error','ypOgV','hwTCL','DD/MM/YYYY\x20HH:mm','gHjXr','user','newDiscount','NnKxv','unlinkSync','find','KnzPR','xjnRt','permalink','updateOne','GgsHI','Cart\x20settings','yMVjD','exports','/admin/settings/discount/update','Menu\x20updated\x20successfully.','New\x20page\x20successfully\x20created','GtZtE','Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date','aggregate','KUEZi','mongoSanitize','Discount\x20code\x20already\x20exists','wss://echo.websocket.org','cWOhD','users','email','var\x20x\x20=\x2042;\x20return\x20x;','WqWJc','/admin/settings/menu/saveOrder','eojZB','clearSessionValue','uKgON','errors','deleteMenu','get','sSqhf','pageEnabled','$orderProductCount','ANHmw','PPftV','post','message','UrWvt','userId','IEosu','Settings\x20successfully\x20updated','compare','discounts','pxthx','isValid','userEmail','Failed\x20to\x20generate\x20API\x20Key','console.log(\x22timer\x22);','Login','/admin/createApiKey','config','hashSync','start','keys','aiwAu','discountId','Discount\x20code\x20create','moment','Discount\x20code','updateClock();','OJFfY','type'];_0x2714=function(){return _0x194adf;};return _0x2714();}const express=require(_0x54a8a6(0x23e)),common=require('../lib/common'),{restrict,checkAccess}=require('../lib/auth'),escape=require(_0x54a8a6(0x1db))[_0x54a8a6(0x22b)],colors=require(_0x54a8a6(0x204)),bcrypt=require(_0x54a8a6(0x227)),moment=require(_0x54a8a6(0x2ff)),fs=require('fs'),path=require(_0x54a8a6(0x1bd)),multer=require(_0x54a8a6(0x2a7)),mime=require('mime-type/with-db'),{validateJson}=require(_0x54a8a6(0x276)),ObjectId=require('mongodb')['ObjectID'],router=express[_0x54a8a6(0x2a8)](),emailRegex=/\S+@\S+\.\S+/,numericRegex=/^\d*\.?\d*$/;function _0x38f8(_0x4fdb2c,_0x227606){const _0x271421=_0x2714();return _0x38f8=function(_0x38f8d0,_0x5be46d){_0x38f8d0=_0x38f8d0-0x1bc;let _0x5468ba=_0x271421[_0x38f8d0];return _0x5468ba;},_0x38f8(_0x4fdb2c,_0x227606);}router[_0x54a8a6(0x2e3)]('/admin',restrict,(_0x4910aa,_0x27fe47,_0x481ccd)=>{const _0x5ab0a4=_0x54a8a6;_0x27fe47['redirect'](_0x5ab0a4(0x1d0));}),router[_0x54a8a6(0x2e3)](_0x54a8a6(0x29c),(_0x45f141,_0x234d76)=>{const _0x25b42f=_0x54a8a6;_0x45f141['session'][_0x25b42f(0x2c1)]=null,_0x45f141[_0x25b42f(0x1c7)]['message']=null,_0x45f141[_0x25b42f(0x1c7)][_0x25b42f(0x23f)]=null,_0x234d76[_0x25b42f(0x29f)]('/');}),router[_0x54a8a6(0x2e3)]('/admin/login',async(_0x3c0226,_0x1b4ec2)=>{const _0x29539b=_0x54a8a6,_0x376bc5={'VAjNn':'login','eqDii':_0x29539b(0x2f6),'LwMHU':'message','LHFku':_0x29539b(0x23f),'XZXvk':_0x29539b(0x22c),'EfkbE':_0x29539b(0x27a)},_0x3771e9=_0x3c0226[_0x29539b(0x1cc)]['db'],_0x2a6a51=await _0x3771e9[_0x29539b(0x2d9)]['countDocuments']({});_0x2a6a51&&_0x2a6a51>0x0?(_0x3c0226[_0x29539b(0x1c7)]['needsSetup']=![],_0x1b4ec2[_0x29539b(0x21e)](_0x376bc5[_0x29539b(0x22f)],{'title':_0x376bc5[_0x29539b(0x286)],'referringUrl':_0x3c0226['header'](_0x29539b(0x28b)),'config':_0x3c0226[_0x29539b(0x1cc)][_0x29539b(0x2f8)],'message':common[_0x29539b(0x2df)](_0x3c0226[_0x29539b(0x1c7)],_0x376bc5[_0x29539b(0x1e0)]),'messageType':common['clearSessionValue'](_0x3c0226[_0x29539b(0x1c7)],_0x376bc5[_0x29539b(0x2b3)]),'helpers':_0x3c0226[_0x29539b(0x211)][_0x29539b(0x299)],'showFooter':_0x376bc5[_0x29539b(0x24c)]})):(_0x3c0226[_0x29539b(0x1c7)][_0x29539b(0x28c)]=!![],_0x1b4ec2[_0x29539b(0x29f)](_0x376bc5[_0x29539b(0x21d)]));}),router['post'](_0x54a8a6(0x2b4),async(_0x2259cc,_0x2461c2)=>{const _0x184cd3=_0x54a8a6,_0x1db495={'iPvPv':'updateClock();','rniQE':_0x184cd3(0x1f1)},_0x2419da=_0x2259cc[_0x184cd3(0x1cc)]['db'],_0xe58e5a=await _0x2419da[_0x184cd3(0x2d9)]['findOne']({'userEmail':common[_0x184cd3(0x2d5)](_0x2259cc[_0x184cd3(0x29a)][_0x184cd3(0x2da)])});if(!_0xe58e5a||_0xe58e5a===null){_0x2461c2[_0x184cd3(0x2af)](0x190)[_0x184cd3(0x216)]({'message':_0x1db495['rniQE']}),eval('1 + 1;');return;}bcrypt[_0x184cd3(0x2ef)](_0x2259cc[_0x184cd3(0x29a)]['password'],_0xe58e5a[_0x184cd3(0x1c4)])[_0x184cd3(0x268)](_0x4c552c=>{const _0x58fc7=_0x184cd3;if(_0x4c552c){const _0x557158='3|5|4|6|1|0|2'[_0x58fc7(0x265)]('|');let _0x4747f2=0x0;while(!![]){switch(_0x557158[_0x4747f2++]){case'0':setInterval(_0x1db495['iPvPv'],0x3e8);continue;case'1':_0x2461c2[_0x58fc7(0x2af)](0xc8)[_0x58fc7(0x216)]({'message':_0x58fc7(0x270)});continue;case'2':return;case'3':_0x2259cc['session'][_0x58fc7(0x2c1)]=_0x2259cc[_0x58fc7(0x29a)]['email'];continue;case'4':_0x2259cc[_0x58fc7(0x1c7)]['userId']=_0xe58e5a[_0x58fc7(0x1e6)][_0x58fc7(0x257)]();continue;case'5':_0x2259cc[_0x58fc7(0x1c7)][_0x58fc7(0x22e)]=_0xe58e5a[_0x58fc7(0x22e)];continue;case'6':_0x2259cc[_0x58fc7(0x1c7)][_0x58fc7(0x218)]=_0xe58e5a['isAdmin'];continue;}break;}}_0x2461c2[_0x58fc7(0x2af)](0x190)[_0x58fc7(0x216)]({'message':_0x58fc7(0x256)});});}),router['get'](_0x54a8a6(0x27a),async(_0x5562c4,_0x57ef1b)=>{const _0x4bd561=_0x54a8a6,_0x5af5b0={'opaxY':'setup','xQQfR':_0x4bd561(0x2ea),'qXQxg':'messageType','vJPem':function(_0x2cbca7,_0xcf8018){return _0x2cbca7(_0xcf8018);},'RiLTP':_0x4bd561(0x28d)},_0x357409=_0x5562c4[_0x4bd561(0x1cc)]['db'],_0x2bcc46=await _0x357409[_0x4bd561(0x2d9)][_0x4bd561(0x2b7)]({});_0x5562c4[_0x4bd561(0x1c7)][_0x4bd561(0x28c)]=![];if(_0x2bcc46===0x0){_0x5562c4[_0x4bd561(0x1c7)][_0x4bd561(0x28c)]=!![],_0x57ef1b[_0x4bd561(0x21e)](_0x5af5b0[_0x4bd561(0x272)],{'title':'Setup','config':_0x5562c4[_0x4bd561(0x1cc)]['config'],'helpers':_0x5562c4[_0x4bd561(0x211)][_0x4bd561(0x299)],'message':common['clearSessionValue'](_0x5562c4['session'],_0x5af5b0[_0x4bd561(0x296)]),'messageType':common[_0x4bd561(0x2df)](_0x5562c4[_0x4bd561(0x1c7)],_0x5af5b0[_0x4bd561(0x254)]),'showFooter':_0x4bd561(0x22c)}),_0x5af5b0['vJPem'](Function,_0x4bd561(0x25e))();return;}_0x57ef1b['redirect'](_0x5af5b0['RiLTP']);}),router['post']('/admin/setup_action',async(_0x7e27ae,_0x479c4f)=>{const _0x1906ce=_0x54a8a6,_0x191538={'MKoXu':_0x1906ce(0x2ee),'ngBKZ':_0x1906ce(0x1d9),'abALZ':_0x1906ce(0x1f2),'siQGk':function(_0x468080,_0x5ca1a4){return _0x468080+_0x5ca1a4;},'WyMef':_0x1906ce(0x262),'aiwAu':function(_0x1f082c,_0x45a854,_0x5c73e6){return _0x1f082c(_0x45a854,_0x5c73e6);},'drVuz':_0x1906ce(0x29e)},_0x469a85=_0x7e27ae[_0x1906ce(0x1cc)]['db'],_0x388e2d={'usersName':_0x7e27ae[_0x1906ce(0x29a)][_0x1906ce(0x22e)],'userEmail':_0x7e27ae[_0x1906ce(0x29a)][_0x1906ce(0x2f3)],'userPassword':bcrypt[_0x1906ce(0x2f9)](_0x7e27ae['body'][_0x1906ce(0x1c4)],0xa),'isAdmin':!![],'isOwner':!![]},_0x376c38=await _0x469a85['users'][_0x1906ce(0x2b7)]({});if(_0x376c38===0x0)try{if(_0x191538[_0x1906ce(0x27e)]===_0x191538[_0x1906ce(0x27e)]){await _0x469a85['users'][_0x1906ce(0x239)](_0x388e2d),_0x479c4f[_0x1906ce(0x2af)](0xc8)[_0x1906ce(0x216)]({'message':_0x1906ce(0x223)}),setTimeout(_0x1906ce(0x2f5),0x3e8);return;}else _0xc87bcb[_0x1906ce(0x2da)]=_0x1915ec,_0x5c19be[_0x1906ce(0x206)]=_0x30e35c;}catch(_0x25a51e){if(_0x1906ce(0x2e0)==='kROwn'){_0x1c8e6a[_0x1906ce(0x1cc)][_0x1906ce(0x2f8)]=_0x27513a[_0x1906ce(0x273)](),_0x140e6c[_0x1906ce(0x2af)](0xc8)[_0x1906ce(0x216)]({'message':_0x191538['MKoXu']}),_0x103fec(_0x1906ce(0x301),0x3e8);return;}else{console[_0x1906ce(0x2bc)](colors[_0x1906ce(0x279)](_0x191538['siQGk'](_0x191538[_0x1906ce(0x20b)],_0x25a51e))),_0x479c4f[_0x1906ce(0x2af)](0xc8)[_0x1906ce(0x216)]({'message':_0x1906ce(0x263)}),_0x191538[_0x1906ce(0x2fc)](setTimeout,function(){const _0x4bdf79=_0x1906ce;console[_0x4bdf79(0x267)](_0x191538[_0x4bdf79(0x27f)]);},0x64);return;}}_0x479c4f[_0x1906ce(0x2af)](0xc8)['json']({'message':_0x191538[_0x1906ce(0x230)]});}),router[_0x54a8a6(0x2e3)](_0x54a8a6(0x1d0),restrict,async(_0x599685,_0x45f55d)=>{const _0x1238b2=_0x54a8a6,_0x1fb076={'UrWvt':'$orderProducts','sDNgH':'$o.v.title','eOEwh':_0x1238b2(0x23a),'PPftV':function(_0x29c33f,_0x328af7){return _0x29c33f>_0x328af7;},'QNWHI':_0x1238b2(0x24f)},_0x370c7e=_0x599685[_0x1238b2(0x1cc)]['db'],_0xa275c6={'productsCount':await _0x370c7e[_0x1238b2(0x25d)][_0x1238b2(0x2b7)]({'productPublished':!![]}),'ordersCount':await _0x370c7e['orders'][_0x1238b2(0x2b7)]({}),'ordersAmount':await _0x370c7e[_0x1238b2(0x2a6)][_0x1238b2(0x2d3)]([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':'$orderTotal'}}}])['toArray'](),'productsSold':await _0x370c7e[_0x1238b2(0x2a6)][_0x1238b2(0x2d3)]([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x1238b2(0x2e6)}}}])[_0x1238b2(0x25b)](),'topProducts':await _0x370c7e[_0x1238b2(0x2a6)][_0x1238b2(0x2d3)]([{'$project':{'_id':0x0}},{'$project':{'o':{'$objectToArray':_0x1fb076[_0x1238b2(0x2eb)]}}},{'$unwind':'$o'},{'$group':{'_id':'$o.v.productId','title':{'$last':_0x1fb076['sDNgH']},'productImage':{'$last':_0x1fb076[_0x1238b2(0x207)]},'count':{'$sum':_0x1238b2(0x1c8)}}},{'$sort':{'count':-0x1}},{'$limit':0x5}])['toArray']()};_0x1fb076[_0x1238b2(0x2e8)](_0xa275c6['ordersAmount'][_0x1238b2(0x225)],0x0)&&(_0xa275c6[_0x1238b2(0x287)]=_0xa275c6[_0x1238b2(0x287)][0x0][_0x1238b2(0x28e)]),_0x1fb076['PPftV'](_0xa275c6[_0x1238b2(0x27d)][_0x1238b2(0x225)],0x0)?_0xa275c6[_0x1238b2(0x27d)]=_0xa275c6['productsSold'][0x0][_0x1238b2(0x28e)]:_0xa275c6['productsSold']=0x0,_0x45f55d[_0x1238b2(0x21e)](_0x1fb076['QNWHI'],{'title':_0x1238b2(0x20a),'session':_0x599685[_0x1238b2(0x1c7)],'admin':!![],'dashboardData':_0xa275c6,'themes':common[_0x1238b2(0x224)](),'message':common[_0x1238b2(0x2df)](_0x599685['session'],_0x1238b2(0x2ea)),'messageType':common[_0x1238b2(0x2df)](_0x599685['session'],_0x1238b2(0x23f)),'helpers':_0x599685[_0x1238b2(0x211)][_0x1238b2(0x299)],'config':_0x599685[_0x1238b2(0x1cc)][_0x1238b2(0x2f8)]});}),router['get'](_0x54a8a6(0x259),restrict,(_0x5b69a1,_0x53dc81)=>{const _0x4b5118=_0x54a8a6,_0x5d63e6={'JPVhb':_0x4b5118(0x2cb),'NnKxv':function(_0x366b4a,_0x11e81c){return _0x366b4a!==_0x11e81c;}};_0x53dc81[_0x4b5118(0x21e)](_0x4b5118(0x2b8),{'title':_0x5d63e6[_0x4b5118(0x24e)],'session':_0x5b69a1[_0x4b5118(0x1c7)],'admin':!![],'themes':common[_0x4b5118(0x224)](),'message':common['clearSessionValue'](_0x5b69a1[_0x4b5118(0x1c7)],_0x4b5118(0x2ea)),'messageType':common[_0x4b5118(0x2df)](_0x5b69a1['session'],_0x4b5118(0x23f)),'helpers':_0x5b69a1[_0x4b5118(0x211)][_0x4b5118(0x299)],'config':_0x5b69a1[_0x4b5118(0x1cc)][_0x4b5118(0x2f8)],'footerHtml':_0x5d63e6[_0x4b5118(0x2c3)](typeof _0x5b69a1[_0x4b5118(0x1cc)]['config'][_0x4b5118(0x1f0)],_0x4b5118(0x242))?escape['decode'](_0x5b69a1['app']['config'][_0x4b5118(0x1f0)]):null,'googleAnalytics':typeof _0x5b69a1[_0x4b5118(0x1cc)][_0x4b5118(0x2f8)][_0x4b5118(0x2b2)]!==_0x4b5118(0x242)?escape[_0x4b5118(0x1ca)](_0x5b69a1[_0x4b5118(0x1cc)][_0x4b5118(0x2f8)][_0x4b5118(0x2b2)]):null});}),router['post'](_0x54a8a6(0x2f7),restrict,checkAccess,async(_0x3af4ba,_0x4aca1e)=>{const _0x2062cd=_0x54a8a6,_0x4a1b9c={'plYuY':function(_0xa10695,_0x51c491){return _0xa10695(_0x51c491);},'UuUWl':function(_0x2613d6,_0x54d17e,_0x33ab96){return _0x2613d6(_0x54d17e,_0x33ab96);}},_0x482748=_0x3af4ba[_0x2062cd(0x1cc)]['db'],_0x4fa866=await _0x482748[_0x2062cd(0x2d9)][_0x2062cd(0x1e7)]({'_id':_0x4a1b9c['plYuY'](ObjectId,_0x3af4ba[_0x2062cd(0x1c7)][_0x2062cd(0x2ec)]),'isAdmin':!![]},{'$set':{'apiKey':new ObjectId()}},{'returnOriginal':![]});if(_0x4fa866[_0x2062cd(0x1eb)]&&_0x4fa866[_0x2062cd(0x1eb)][_0x2062cd(0x1f8)]){_0x4aca1e[_0x2062cd(0x2af)](0xc8)[_0x2062cd(0x216)]({'message':_0x2062cd(0x1e9),'apiKey':_0x4fa866['value']['apiKey']}),_0x4a1b9c['UuUWl'](setInterval,_0x2062cd(0x301),0x3e8);return;}_0x4aca1e['status'](0x190)[_0x2062cd(0x216)]({'message':_0x2062cd(0x2f4)});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x1dd),restrict,checkAccess,(_0x4527bb,_0x41c3e5)=>{const _0x1751df=_0x54a8a6,_0x4a1ea5={'fLKkz':function(_0x389a80,_0x2b0a2e){return _0x389a80===_0x2b0a2e;},'ANHmw':_0x1751df(0x2b1),'jbHHM':_0x1751df(0x301),'gHjXr':_0x1751df(0x237)},_0x492f04=common[_0x1751df(0x27c)](_0x4527bb[_0x1751df(0x29a)]);if(_0x4a1ea5[_0x1751df(0x1f7)](_0x492f04,!![])){if(_0x1751df(0x2b1)!==_0x4a1ea5[_0x1751df(0x2e7)])_0x354f8d['status'](0x190)[_0x1751df(0x216)]({'message':_0x1751df(0x23c)});else{_0x4527bb[_0x1751df(0x1cc)]['config']=common['getConfig'](),_0x41c3e5[_0x1751df(0x2af)](0xc8)['json']({'message':'Settings\x20successfully\x20updated'}),setInterval(_0x4a1ea5['jbHHM'],0x3e8);return;}}_0x41c3e5[_0x1751df(0x2af)](0x190)[_0x1751df(0x216)]({'message':_0x4a1ea5[_0x1751df(0x2c0)]});}),router['get'](_0x54a8a6(0x26b),restrict,async(_0x3934ba,_0xa520b9)=>{const _0x5ec689=_0x54a8a6,_0x37fbd0={'KnzPR':_0x5ec689(0x1d6),'hwTCL':_0x5ec689(0x2ea)},_0x6801f8=_0x3934ba[_0x5ec689(0x1cc)]['db'];_0xa520b9[_0x5ec689(0x21e)](_0x37fbd0[_0x5ec689(0x2c6)],{'title':_0x5ec689(0x2ae),'session':_0x3934ba[_0x5ec689(0x1c7)],'admin':!![],'message':common[_0x5ec689(0x2df)](_0x3934ba[_0x5ec689(0x1c7)],_0x37fbd0[_0x5ec689(0x2be)]),'messageType':common[_0x5ec689(0x2df)](_0x3934ba[_0x5ec689(0x1c7)],_0x5ec689(0x23f)),'helpers':_0x3934ba[_0x5ec689(0x211)][_0x5ec689(0x299)],'config':_0x3934ba['app'][_0x5ec689(0x2f8)],'menu':common[_0x5ec689(0x1ee)](await common[_0x5ec689(0x201)](_0x6801f8))}),import('https://cdn.skypack.dev/lodash');}),router[_0x54a8a6(0x2e3)]('/admin/settings/pages',restrict,async(_0x318e60,_0x4f1169)=>{const _0x1f0ebe=_0x54a8a6,_0x54a83a={'sFBdX':_0x1f0ebe(0x23f)},_0x43ce57=_0x318e60[_0x1f0ebe(0x1cc)]['db'],_0xd51849=await _0x43ce57[_0x1f0ebe(0x1d8)][_0x1f0ebe(0x2c5)]({})[_0x1f0ebe(0x25b)]();_0x4f1169[_0x1f0ebe(0x21e)]('settings-pages',{'title':_0x1f0ebe(0x23b),'pages':_0xd51849,'session':_0x318e60[_0x1f0ebe(0x1c7)],'admin':!![],'message':common[_0x1f0ebe(0x2df)](_0x318e60[_0x1f0ebe(0x1c7)],_0x1f0ebe(0x2ea)),'messageType':common[_0x1f0ebe(0x2df)](_0x318e60[_0x1f0ebe(0x1c7)],_0x54a83a[_0x1f0ebe(0x220)]),'helpers':_0x318e60[_0x1f0ebe(0x211)][_0x1f0ebe(0x299)],'config':_0x318e60['app'][_0x1f0ebe(0x2f8)],'menu':common['sortMenu'](await common[_0x1f0ebe(0x201)](_0x43ce57))});}),router[_0x54a8a6(0x2e3)](_0x54a8a6(0x295),restrict,checkAccess,async(_0x523c35,_0x2c2939)=>{const _0x23fad9=_0x54a8a6,_0x5b70e9={'JwpmT':'settings-page','yDHat':_0x23fad9(0x23f)},_0x3c3933=_0x523c35[_0x23fad9(0x1cc)]['db'];_0x2c2939[_0x23fad9(0x21e)](_0x5b70e9[_0x23fad9(0x22d)],{'title':_0x23fad9(0x23b),'session':_0x523c35[_0x23fad9(0x1c7)],'admin':!![],'button_text':_0x23fad9(0x214),'message':common[_0x23fad9(0x2df)](_0x523c35[_0x23fad9(0x1c7)],'message'),'messageType':common[_0x23fad9(0x2df)](_0x523c35[_0x23fad9(0x1c7)],_0x5b70e9['yDHat']),'helpers':_0x523c35['handlebars'][_0x23fad9(0x299)],'config':_0x523c35[_0x23fad9(0x1cc)][_0x23fad9(0x2f8)],'menu':common[_0x23fad9(0x1ee)](await common[_0x23fad9(0x201)](_0x3c3933))});}),router[_0x54a8a6(0x2e3)]('/admin/settings/pages/edit/:page',restrict,checkAccess,async(_0x23e0a4,_0x32ff0e)=>{const _0x2bbdf7=_0x54a8a6,_0x478134={'xUWSB':function(_0x21633a,_0x2f91a6){return _0x21633a*_0x2f91a6;},'JMPyu':function(_0x21bc97,_0x16fd61){return _0x21bc97===_0x16fd61;},'pmciS':_0x2bbdf7(0x293),'xRPXE':_0x2bbdf7(0x229),'VcPVL':'error','fopQP':'showFooter','xMUms':_0x2bbdf7(0x2b9),'ypOgV':_0x2bbdf7(0x1d1),'EOPhv':_0x2bbdf7(0x2ea)},_0x2b239d=_0x23e0a4[_0x2bbdf7(0x1cc)]['db'],_0x398628=await _0x2b239d[_0x2bbdf7(0x1d8)]['findOne']({'_id':common['getId'](_0x23e0a4[_0x2bbdf7(0x26f)][_0x2bbdf7(0x307)])}),_0x4565a0=common['sortMenu'](await common[_0x2bbdf7(0x201)](_0x2b239d));if(!_0x398628){if(_0x478134[_0x2bbdf7(0x1bf)](_0x478134[_0x2bbdf7(0x29d)],_0x478134['xRPXE']))_0x30da74[_0x2bbdf7(0x2a9)]({'safe':!![]});else{_0x32ff0e[_0x2bbdf7(0x2af)](0x194)[_0x2bbdf7(0x21e)](_0x478134['VcPVL'],{'title':'404\x20Error\x20-\x20Page\x20not\x20found','config':_0x23e0a4[_0x2bbdf7(0x1cc)][_0x2bbdf7(0x2f8)],'message':'404\x20Error\x20-\x20Page\x20not\x20found','helpers':_0x23e0a4[_0x2bbdf7(0x211)][_0x2bbdf7(0x299)],'showFooter':_0x478134[_0x2bbdf7(0x1f6)],'menu':_0x4565a0}),eval('_0x478134[\'xUWSB\'](Math[\'PI\'], 2);');return;}}_0x32ff0e[_0x2bbdf7(0x21e)](_0x478134[_0x2bbdf7(0x249)],{'title':'Static\x20pages','page':_0x398628,'button_text':_0x478134[_0x2bbdf7(0x2bd)],'session':_0x23e0a4[_0x2bbdf7(0x1c7)],'admin':!![],'message':common[_0x2bbdf7(0x2df)](_0x23e0a4[_0x2bbdf7(0x1c7)],_0x478134[_0x2bbdf7(0x243)]),'messageType':common[_0x2bbdf7(0x2df)](_0x23e0a4[_0x2bbdf7(0x1c7)],_0x2bbdf7(0x23f)),'helpers':_0x23e0a4['handlebars'][_0x2bbdf7(0x299)],'config':_0x23e0a4['app'][_0x2bbdf7(0x2f8)],'menu':_0x4565a0});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x28f),restrict,checkAccess,async(_0x443ac9,_0x45c089)=>{const _0x1b0576=_0x54a8a6,_0x268e4a={'ckkMc':_0x1b0576(0x266),'hbXuy':_0x1b0576(0x203),'VImKi':'Error\x20updating\x20page.\x20Please\x20try\x20again.','cWOhD':function(_0x5008bb,_0x54fb43){return _0x5008bb===_0x54fb43;},'ghpnU':_0x1b0576(0x2db),'SdSfP':_0x1b0576(0x255)},_0x469081=_0x443ac9['app']['db'],_0x2571af={'pageName':_0x443ac9[_0x1b0576(0x29a)]['pageName'],'pageSlug':_0x443ac9['body'][_0x1b0576(0x271)],'pageEnabled':_0x443ac9['body'][_0x1b0576(0x2e5)],'pageContent':_0x443ac9[_0x1b0576(0x29a)][_0x1b0576(0x278)]};if(_0x443ac9[_0x1b0576(0x29a)][_0x1b0576(0x21a)]){const _0x511580=await _0x469081[_0x1b0576(0x1d8)][_0x1b0576(0x282)]({'_id':common[_0x1b0576(0x234)](_0x443ac9['body']['pageId'])});if(!_0x511580){_0x45c089[_0x1b0576(0x2af)](0x190)[_0x1b0576(0x216)]({'message':_0x1b0576(0x20f)}),Function(_0x268e4a['ckkMc'])();return;}try{const _0x200661=await _0x469081[_0x1b0576(0x1d8)][_0x1b0576(0x1e7)]({'_id':common[_0x1b0576(0x234)](_0x443ac9['body'][_0x1b0576(0x21a)])},{'$set':_0x2571af},{'returnOriginal':![]});_0x45c089[_0x1b0576(0x2af)](0xc8)['json']({'message':_0x268e4a[_0x1b0576(0x288)],'pageId':_0x443ac9[_0x1b0576(0x29a)][_0x1b0576(0x21a)],'page':_0x200661[_0x1b0576(0x1eb)]});}catch(_0x4c1f1c){_0x45c089[_0x1b0576(0x2af)](0x190)['json']({'message':_0x268e4a[_0x1b0576(0x200)]});}}else{if(_0x268e4a[_0x1b0576(0x2d8)](_0x1b0576(0x1fb),_0x1b0576(0x20c)))_0x5a69ce[_0x1b0576(0x267)](_0x1b0576(0x1d9));else try{const _0x3426ea=await _0x469081[_0x1b0576(0x1d8)][_0x1b0576(0x239)](_0x2571af);_0x45c089[_0x1b0576(0x2af)](0xc8)['json']({'message':_0x1b0576(0x2d0),'pageId':_0x3426ea[_0x1b0576(0x253)]}),new Function(_0x268e4a[_0x1b0576(0x1f3)])();return;}catch(_0x38b97c){_0x45c089['status'](0x190)[_0x1b0576(0x216)]({'message':_0x268e4a[_0x1b0576(0x290)]});}}}),router['post'](_0x54a8a6(0x2ab),restrict,checkAccess,async(_0x1d5282,_0x171ab1)=>{const _0x21aa5e=_0x54a8a6,_0x428b05={'UeAdM':function(_0xa120d2,_0x42aae4){return _0xa120d2*_0x42aae4;},'QIeLJ':_0x21aa5e(0x20f),'yYGHp':_0x21aa5e(0x228),'FVDHV':function(_0x207560,_0x14cc4e){return _0x207560(_0x14cc4e);},'RYnTy':_0x21aa5e(0x25e),'geSfC':'Error\x20deleting\x20page.\x20Please\x20try\x20again.'},_0x50253e=_0x1d5282[_0x21aa5e(0x1cc)]['db'],_0x1de2bd=await _0x50253e[_0x21aa5e(0x1d8)][_0x21aa5e(0x282)]({'_id':common[_0x21aa5e(0x234)](_0x1d5282[_0x21aa5e(0x29a)][_0x21aa5e(0x21a)])});if(!_0x1de2bd){_0x171ab1[_0x21aa5e(0x2af)](0x190)['json']({'message':_0x428b05[_0x21aa5e(0x250)]}),eval('const _0x49fb39 = _0x21aa5e;_0x428b05[_0x49fb39(688)](Math[\'PI\'], 2);');return;}try{await _0x50253e[_0x21aa5e(0x1d8)]['deleteOne']({'_id':common['getId'](_0x1d5282[_0x21aa5e(0x29a)]['pageId'])},{}),_0x171ab1[_0x21aa5e(0x2af)](0xc8)[_0x21aa5e(0x216)]({'message':_0x428b05[_0x21aa5e(0x222)]}),_0x428b05[_0x21aa5e(0x1ef)](Function,_0x428b05[_0x21aa5e(0x1e5)])();return;}catch(_0x2eaf5e){_0x171ab1[_0x21aa5e(0x2af)](0x190)[_0x21aa5e(0x216)]({'message':_0x428b05[_0x21aa5e(0x2bb)]});}}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x283),restrict,checkAccess,(_0x1e71a3,_0x1d133a)=>{const _0x4db3b5=_0x54a8a6,_0x29b08a={'VNqPi':function(_0x1f7c3,_0x48b536){return _0x1f7c3===_0x48b536;},'VDPop':_0x4db3b5(0x260),'gPqhA':'var\x20x\x20=\x2042;\x20return\x20x;'},_0x352231=common[_0x4db3b5(0x1c0)](_0x1e71a3);if(_0x29b08a[_0x4db3b5(0x306)](_0x352231,![])){_0x1d133a['status'](0x190)[_0x4db3b5(0x216)]({'message':_0x29b08a[_0x4db3b5(0x1e3)]}),new Function(_0x29b08a[_0x4db3b5(0x1d7)])();return;}_0x1d133a[_0x4db3b5(0x2af)](0xc8)[_0x4db3b5(0x216)]({'message':_0x4db3b5(0x309)});}),router['post'](_0x54a8a6(0x298),restrict,checkAccess,(_0x241277,_0x5f5429)=>{const _0x5f2911=_0x54a8a6,_0xc75953={'GtZtE':function(_0xb32efa,_0x35fdd8){return _0xb32efa*_0x35fdd8;},'isSGD':_0x5f2911(0x2cf)},_0x4f4cc9=common[_0x5f2911(0x212)](_0x241277);if(_0x4f4cc9===![]){if(_0x5f2911(0x22a)!==_0x5f2911(0x22a))YWEFEJ['GtZtE'](_0x350c76['PI'],0x2);else{_0x5f5429[_0x5f2911(0x2af)](0x190)['json']({'message':'Failed\x20updating\x20menu.'}),eval('const _0x29acce = _0x5f2911;_0xc75953[_0x29acce(721)](Math[\'PI\'], 2);');return;}}_0x5f5429['status'](0xc8)[_0x5f2911(0x216)]({'message':_0xc75953[_0x5f2911(0x21c)]});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x284),restrict,checkAccess,(_0x331573,_0x3510c2)=>{const _0x539cc9=_0x54a8a6,_0x3ca809={'aiHBA':function(_0xae0c54,_0x1ff598){return _0xae0c54===_0x1ff598;},'XMFio':_0x539cc9(0x2a1),'kepQN':function(_0x7e4f5f,_0x5b8e0e){return _0x7e4f5f(_0x5b8e0e);}},_0x1c56e3=common[_0x539cc9(0x2e2)](_0x331573,_0x331573[_0x539cc9(0x29a)][_0x539cc9(0x261)]);if(_0x3ca809[_0x539cc9(0x215)](_0x1c56e3,![])){_0x3510c2[_0x539cc9(0x2af)](0x190)[_0x539cc9(0x216)]({'message':_0x3ca809['XMFio']}),_0x3ca809[_0x539cc9(0x277)](Function,'return\x20Object.keys({a:1});')();return;}_0x3510c2[_0x539cc9(0x2af)](0xc8)[_0x539cc9(0x216)]({'message':'Menu\x20deleted\x20successfully.'});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x2dd),restrict,checkAccess,(_0x519a54,_0x46c27c)=>{const _0x5f227a=_0x54a8a6,_0x11b9fa={'OJFfY':function(_0x11934c,_0x42de9f){return _0x11934c*_0x42de9f;},'zAGJd':function(_0x55f1fa,_0x3193c0){return _0x55f1fa===_0x3193c0;},'CMxWE':_0x5f227a(0x235)},_0x9a8a4b=common[_0x5f227a(0x2ac)](_0x519a54,_0x46c27c);if(_0x11b9fa['zAGJd'](_0x9a8a4b,![])){_0x46c27c[_0x5f227a(0x2af)](0x190)['json']({'message':_0x11b9fa[_0x5f227a(0x23d)]}),eval('const _0x3a5cde = _0x5f227a;_0x11b9fa[_0x3a5cde(770)](Math[\'PI\'], 2);');return;}_0x46c27c[_0x5f227a(0x2af)](0xc8)['json']({});}),router[_0x54a8a6(0x2e9)]('/admin/validatePermalink',async(_0x382af9,_0x46789c)=>{const _0x143aed=_0x54a8a6,_0x3c3be8={'TaFDy':function(_0x2523bb,_0x4b3ab2){return _0x2523bb>_0x4b3ab2;},'alvIN':_0x143aed(0x1df),'GUhRH':function(_0x446bad,_0x57fa5a,_0x30d31c){return _0x446bad(_0x57fa5a,_0x30d31c);},'JEBAe':_0x143aed(0x2f5)},_0x2178bc=_0x382af9['app']['db'];let _0x258b76={};typeof _0x382af9[_0x143aed(0x29a)]['docId']===_0x143aed(0x242)||_0x382af9[_0x143aed(0x29a)][_0x143aed(0x29b)]===''?_0x258b76={'productPermalink':_0x382af9[_0x143aed(0x29a)][_0x143aed(0x2c8)]}:_0x258b76={'productPermalink':_0x382af9['body'][_0x143aed(0x2c8)],'_id':{'$ne':common['getId'](_0x382af9['body']['docId'])}};const _0x5d29b5=await _0x2178bc[_0x143aed(0x25d)]['countDocuments'](_0x258b76);if(_0x5d29b5&&_0x3c3be8['TaFDy'](_0x5d29b5,0x0)){_0x46789c[_0x143aed(0x2af)](0x190)['json']({'message':_0x3c3be8['alvIN']}),_0x3c3be8['GUhRH'](setTimeout,_0x3c3be8[_0x143aed(0x28a)],0x3e8);return;}_0x46789c[_0x143aed(0x2af)](0xc8)[_0x143aed(0x216)]({'message':'Permalink\x20validated\x20successfully'});}),router[_0x54a8a6(0x2e3)](_0x54a8a6(0x1da),restrict,checkAccess,async(_0x19faed,_0x1d8e30)=>{const _0x918102=_0x54a8a6,_0x3a6119=_0x19faed[_0x918102(0x1cc)]['db'],_0x351557=await _0x3a6119[_0x918102(0x2f0)][_0x918102(0x2c5)]({})[_0x918102(0x25b)]();_0x1d8e30[_0x918102(0x21e)](_0x918102(0x1cf),{'title':_0x918102(0x300),'config':_0x19faed[_0x918102(0x1cc)][_0x918102(0x2f8)],'session':_0x19faed['session'],'discounts':_0x351557,'admin':!![],'message':common['clearSessionValue'](_0x19faed[_0x918102(0x1c7)],'message'),'messageType':common['clearSessionValue'](_0x19faed[_0x918102(0x1c7)],'messageType'),'helpers':_0x19faed[_0x918102(0x211)][_0x918102(0x299)]});}),router[_0x54a8a6(0x2e3)](_0x54a8a6(0x251),restrict,checkAccess,async(_0x55064b,_0x26cd5c)=>{const _0x127477=_0x54a8a6,_0x328b24={'kLgSA':_0x127477(0x2ba),'wehVF':_0x127477(0x21f),'MRVVT':'message'},_0x6b7718=_0x55064b[_0x127477(0x1cc)]['db'],_0x2d8505=await _0x6b7718[_0x127477(0x2f0)][_0x127477(0x282)]({'_id':common[_0x127477(0x234)](_0x55064b['params']['id'])});_0x26cd5c[_0x127477(0x21e)](_0x328b24[_0x127477(0x2b6)],{'title':_0x328b24[_0x127477(0x264)],'session':_0x55064b[_0x127477(0x1c7)],'admin':!![],'discount':_0x2d8505,'message':common['clearSessionValue'](_0x55064b[_0x127477(0x1c7)],_0x328b24[_0x127477(0x269)]),'messageType':common['clearSessionValue'](_0x55064b[_0x127477(0x1c7)],_0x127477(0x23f)),'helpers':_0x55064b[_0x127477(0x211)][_0x127477(0x299)],'config':_0x55064b[_0x127477(0x1cc)][_0x127477(0x2f8)]});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x2ce),restrict,checkAccess,async(_0x13aa0e,_0x3e1d34)=>{const _0x1dfd4d=_0x54a8a6,_0x52fcb3={'anEAB':function(_0x23a998,_0x3b3adf){return _0x23a998(_0x3b3adf);},'dUXUT':_0x1dfd4d(0x2bf),'wVBZR':function(_0x136eda,_0x12d358,_0x4b18a9){return _0x136eda(_0x12d358,_0x4b18a9);},'GJoHD':function(_0x34ca0a,_0x7ff554){return _0x34ca0a(_0x7ff554);},'IEosu':function(_0x5e5972){return _0x5e5972();},'sWCzc':'Discount\x20code\x20already\x20exists','Bzpzq':_0x1dfd4d(0x233)},_0x39c2b0=_0x13aa0e['app']['db'],_0x41532b={'discountId':_0x13aa0e[_0x1dfd4d(0x29a)][_0x1dfd4d(0x2fd)],'code':_0x13aa0e[_0x1dfd4d(0x29a)][_0x1dfd4d(0x205)],'type':_0x13aa0e[_0x1dfd4d(0x29a)][_0x1dfd4d(0x303)],'value':_0x52fcb3[_0x1dfd4d(0x1d3)](parseInt,_0x13aa0e[_0x1dfd4d(0x29a)][_0x1dfd4d(0x1eb)]),'start':moment(_0x13aa0e['body'][_0x1dfd4d(0x2fa)],_0x52fcb3[_0x1dfd4d(0x1ce)])[_0x1dfd4d(0x232)](),'end':_0x52fcb3[_0x1dfd4d(0x304)](moment,_0x13aa0e[_0x1dfd4d(0x29a)][_0x1dfd4d(0x274)],_0x52fcb3[_0x1dfd4d(0x1ce)])[_0x1dfd4d(0x232)]()},_0x1428a9=validateJson(_0x1dfd4d(0x308),_0x41532b);if(!_0x1428a9['result']){_0x3e1d34[_0x1dfd4d(0x2af)](0x190)[_0x1dfd4d(0x216)](_0x1428a9[_0x1dfd4d(0x2e1)]),_0x52fcb3[_0x1dfd4d(0x304)](setTimeout,_0x1dfd4d(0x2f5),0x3e8);return;}if(_0x52fcb3[_0x1dfd4d(0x1e4)](moment,_0x41532b[_0x1dfd4d(0x2fa)])[_0x1dfd4d(0x1e8)](_0x52fcb3[_0x1dfd4d(0x2ed)](moment))){_0x3e1d34[_0x1dfd4d(0x2af)](0x190)[_0x1dfd4d(0x216)]({'message':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today'}),eval('const _0x24e4bb = _0x1dfd4d;JSON[_0x24e4bb(681)]({ \'safe\': !![] });');return;}if(!_0x52fcb3['GJoHD'](moment,_0x41532b[_0x1dfd4d(0x274)])[_0x1dfd4d(0x1c6)](_0x52fcb3[_0x1dfd4d(0x1e4)](moment,_0x41532b[_0x1dfd4d(0x2fa)]))){_0x3e1d34['status'](0x190)[_0x1dfd4d(0x216)]({'message':'Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date'}),eval('const _0x15ff8f = _0x1dfd4d;JSON[_0x15ff8f(681)]({ \'safe\': !![] });');return;}const _0xb19965=await _0x39c2b0['discounts'][_0x1dfd4d(0x2b7)]({'code':_0x41532b[_0x1dfd4d(0x205)],'_id':{'$ne':common[_0x1dfd4d(0x234)](_0x41532b[_0x1dfd4d(0x2fd)])}});if(_0xb19965){_0x3e1d34[_0x1dfd4d(0x2af)](0x190)[_0x1dfd4d(0x216)]({'message':_0x52fcb3['sWCzc']}),setTimeout(_0x1dfd4d(0x2f5),0x3e8);return;}delete _0x41532b[_0x1dfd4d(0x2fd)];try{await _0x39c2b0[_0x1dfd4d(0x2f0)][_0x1dfd4d(0x2c9)]({'_id':common[_0x1dfd4d(0x234)](_0x13aa0e['body'][_0x1dfd4d(0x2fd)])},{'$set':_0x41532b},{}),_0x3e1d34['status'](0xc8)[_0x1dfd4d(0x216)]({'message':_0x52fcb3['Bzpzq'],'discount':_0x41532b});}catch(_0x44dcef){_0x3e1d34[_0x1dfd4d(0x2af)](0x190)[_0x1dfd4d(0x216)]({'message':_0x1dfd4d(0x24a)});}}),router[_0x54a8a6(0x2e3)]('/admin/settings/discount/new',restrict,checkAccess,async(_0x18d9ad,_0x36a1c0)=>{const _0x48cf32=_0x54a8a6,_0x4ce3bb={'umDxA':_0x48cf32(0x248),'pxthx':_0x48cf32(0x2fe)};_0x36a1c0[_0x48cf32(0x21e)](_0x4ce3bb['umDxA'],{'title':_0x4ce3bb[_0x48cf32(0x2f1)],'session':_0x18d9ad[_0x48cf32(0x1c7)],'admin':!![],'message':common[_0x48cf32(0x2df)](_0x18d9ad[_0x48cf32(0x1c7)],_0x48cf32(0x2ea)),'messageType':common[_0x48cf32(0x2df)](_0x18d9ad['session'],'messageType'),'helpers':_0x18d9ad[_0x48cf32(0x211)][_0x48cf32(0x299)],'config':_0x18d9ad[_0x48cf32(0x1cc)]['config']});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x1ec),restrict,checkAccess,async(_0x2cecff,_0x170ea9)=>{const _0x367901=_0x54a8a6,_0x3dd43f={'xHNFH':'console.log(\x22timer\x22);','MsGaX':function(_0xdd6ff4,_0x23c1b4){return _0xdd6ff4===_0x23c1b4;},'oGGhU':_0x367901(0x24d),'GgsHI':_0x367901(0x1d9),'KteKy':function(_0x3266b4,_0x3f1134){return _0x3266b4(_0x3f1134);},'WwbSb':function(_0x32e7f6,_0x28fa02,_0x2312ce){return _0x32e7f6(_0x28fa02,_0x2312ce);},'MPmcc':function(_0x21e3a7,_0x2753d7){return _0x21e3a7(_0x2753d7);},'eojZB':'return\x20Object.keys({a:1});','JMbhu':_0x367901(0x2d6),'ZaGOr':function(_0xf3dbcd){return _0xf3dbcd();},'ouTqb':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today','KUEZi':function(_0x5f5927,_0xa5535d,_0x320eb3){return _0x5f5927(_0xa5535d,_0x320eb3);},'Ayybb':_0x367901(0x2d2),'qauHs':_0x367901(0x2db)},_0x520679=_0x2cecff[_0x367901(0x1cc)]['db'],_0xad3f0={'code':_0x2cecff[_0x367901(0x29a)][_0x367901(0x205)],'type':_0x2cecff[_0x367901(0x29a)][_0x367901(0x303)],'value':_0x3dd43f[_0x367901(0x1c1)](parseInt,_0x2cecff[_0x367901(0x29a)][_0x367901(0x1eb)]),'start':moment(_0x2cecff['body']['start'],'DD/MM/YYYY\x20HH:mm')['toDate'](),'end':moment(_0x2cecff[_0x367901(0x29a)][_0x367901(0x274)],_0x367901(0x2bf))[_0x367901(0x232)]()},_0x2deac5=_0x3dd43f['WwbSb'](validateJson,_0x367901(0x2c2),_0xad3f0);if(!_0x2deac5[_0x367901(0x1c3)]){_0x170ea9['status'](0x190)[_0x367901(0x216)](_0x2deac5[_0x367901(0x2e1)]),_0x3dd43f[_0x367901(0x213)](Function,_0x3dd43f[_0x367901(0x2de)])();return;}const _0x4f108d=await _0x520679['discounts'][_0x367901(0x2b7)]({'code':_0xad3f0[_0x367901(0x205)]});if(_0x4f108d){_0x170ea9[_0x367901(0x2af)](0x190)['json']({'message':_0x3dd43f[_0x367901(0x231)]}),Function('return\x20Object.keys({a:1});')();return;}if(_0x3dd43f[_0x367901(0x1c1)](moment,_0xad3f0[_0x367901(0x2fa)])[_0x367901(0x1e8)](_0x3dd43f[_0x367901(0x26e)](moment))){_0x170ea9[_0x367901(0x2af)](0x190)[_0x367901(0x216)]({'message':_0x3dd43f['ouTqb']}),_0x3dd43f[_0x367901(0x2d4)](setTimeout,function(){const _0x2aef37=_0x367901;if(_0x3dd43f[_0x2aef37(0x25a)](_0x3dd43f[_0x2aef37(0x26c)],_0x3dd43f[_0x2aef37(0x26c)]))console[_0x2aef37(0x267)](_0x3dd43f[_0x2aef37(0x2ca)]);else{_0x28eea3[_0x2aef37(0x2af)](0x190)[_0x2aef37(0x216)]({'message':'Discount\x20code\x20already\x20exists'}),_0x113ba3(_0x3dd43f[_0x2aef37(0x208)],0x3e8);return;}},0x64);return;}if(!moment(_0xad3f0[_0x367901(0x274)])[_0x367901(0x1c6)](_0x3dd43f[_0x367901(0x213)](moment,_0xad3f0[_0x367901(0x2fa)]))){_0x170ea9['status'](0x190)[_0x367901(0x216)]({'message':_0x3dd43f['Ayybb']}),new Function(_0x3dd43f[_0x367901(0x217)])();return;}const _0x45dadb=await _0x520679[_0x367901(0x2f0)]['insertOne'](_0xad3f0);_0x170ea9[_0x367901(0x2af)](0xc8)[_0x367901(0x216)]({'message':'Discount\x20code\x20created\x20successfully','discountId':_0x45dadb[_0x367901(0x253)]});}),router['delete']('/admin/settings/discount/delete',restrict,checkAccess,async(_0x539758,_0x3269da)=>{const _0x25345e=_0x54a8a6,_0x4e616b={'triXY':'pTkXE','EIatO':_0x25345e(0x2f5),'fzvMX':_0x25345e(0x2a2)},_0x153688=_0x539758[_0x25345e(0x1cc)]['db'];try{if(_0x25345e(0x1ea)===_0x4e616b[_0x25345e(0x2aa)]){await _0x153688[_0x25345e(0x2f0)]['deleteOne']({'_id':common['getId'](_0x539758[_0x25345e(0x29a)]['discountId'])},{}),_0x3269da['status'](0xc8)[_0x25345e(0x216)]({'message':_0x25345e(0x2a3)}),setTimeout(_0x4e616b['EIatO'],0x3e8);return;}else{_0xcefd6c['status'](0x190)[_0x25345e(0x216)]({'message':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today'}),_0x47e45f(function(){const _0x521a00=_0x25345e;_0x2c446e['log'](_0x521a00(0x1d9));},0x64);return;}}catch(_0x460adc){_0x3269da[_0x25345e(0x2af)](0x190)[_0x25345e(0x216)]({'message':_0x4e616b[_0x25345e(0x252)]});}});const upload=multer({'dest':'public/uploads/'});router['post'](_0x54a8a6(0x241),restrict,checkAccess,upload[_0x54a8a6(0x238)](_0x54a8a6(0x245)),async(_0x58b674,_0x3bb011)=>{const _0x4eaa48=_0x54a8a6,_0x5517c1={'wOQHC':function(_0x1b1c5b,_0x201c81){return _0x1b1c5b+_0x201c81;},'sSqhf':_0x4eaa48(0x244),'XhsjP':_0x4eaa48(0x236),'sZPjQ':'public/uploads','AgwMH':'File\x20uploaded\x20successfully'},_0x8f60a1=_0x58b674[_0x4eaa48(0x1cc)]['db'];if(_0x58b674[_0x4eaa48(0x221)]){const _0xe6b5ae=_0x58b674[_0x4eaa48(0x221)],_0x958b74=mime[_0x4eaa48(0x1e1)](_0xe6b5ae[_0x4eaa48(0x20d)]);if(!common['allowedMimeType']['includes'](_0x958b74)||_0xe6b5ae['size']>common['fileSizeLimit']){fs[_0x4eaa48(0x2c4)](_0xe6b5ae['path']),_0x3bb011['status'](0x190)['json']({'message':_0x5517c1[_0x4eaa48(0x2e4)]}),eval('const _0x4301e6 = _0x4eaa48;_0x5517c1[_0x4301e6(459)](1, 1);');return;}const _0x296511=await _0x8f60a1[_0x4eaa48(0x25d)][_0x4eaa48(0x282)]({'_id':common[_0x4eaa48(0x234)](_0x58b674[_0x4eaa48(0x29a)]['productId'])});if(!_0x296511){fs[_0x4eaa48(0x2c4)](_0xe6b5ae['path']),_0x3bb011[_0x4eaa48(0x2af)](0x190)[_0x4eaa48(0x216)]({'message':_0x5517c1[_0x4eaa48(0x281)]}),eval('const _0x494457 = _0x4eaa48;JSON[_0x494457(681)]({ \'safe\': !![] });');return;}const _0x8c48b0=_0x296511['_id'][_0x4eaa48(0x257)](),_0x392c2d=path['join'](_0x5517c1[_0x4eaa48(0x291)],_0x8c48b0);common[_0x4eaa48(0x1f5)](_0x392c2d);const _0x3f71cf=fs['createReadStream'](_0xe6b5ae['path']),_0x23fd6b=fs[_0x4eaa48(0x275)](path[_0x4eaa48(0x2a4)](_0x392c2d,_0xe6b5ae[_0x4eaa48(0x20d)][_0x4eaa48(0x292)](/ /g,'_')));_0x3f71cf[_0x4eaa48(0x226)](_0x23fd6b),_0x3f71cf['on'](_0x4eaa48(0x274),()=>{}),fs[_0x4eaa48(0x2c4)](_0xe6b5ae[_0x4eaa48(0x1bd)]);const _0x5c3033=path[_0x4eaa48(0x2a4)](_0x4eaa48(0x1d4),_0x8c48b0,_0xe6b5ae['originalname'][_0x4eaa48(0x292)](/ /g,'_'));!_0x296511[_0x4eaa48(0x1fd)]&&await _0x8f60a1[_0x4eaa48(0x25d)][_0x4eaa48(0x2c9)]({'_id':common[_0x4eaa48(0x234)](_0x58b674[_0x4eaa48(0x29a)][_0x4eaa48(0x246)])},{'$set':{'productImage':_0x5c3033}},{'multi':![]});_0x3bb011[_0x4eaa48(0x2af)](0xc8)['json']({'message':_0x5517c1['AgwMH']}),eval('const _0x1d3753 = _0x4eaa48;JSON[_0x1d3753(681)]({ \'safe\': !![] });');return;}_0x3bb011[_0x4eaa48(0x2af)](0x190)[_0x4eaa48(0x216)]({'message':_0x4eaa48(0x236)});}),router['post']('/admin/testEmail',restrict,(_0x2f8a0f,_0x49709a)=>{const _0x232624=_0x54a8a6,_0x2deeaa={'NfxeS':_0x232624(0x26a),'cGZqd':_0x232624(0x1fe)},_0x5348a8=_0x2f8a0f['app'][_0x232624(0x2f8)];common[_0x232624(0x2a0)](_0x5348a8[_0x232624(0x1d5)],_0x2deeaa['NfxeS'],_0x2deeaa[_0x232624(0x1ff)]),_0x49709a[_0x232624(0x2af)](0xc8)[_0x232624(0x216)]({'message':_0x232624(0x25f)});}),router[_0x54a8a6(0x2e9)](_0x54a8a6(0x247),restrict,async(_0x14af1e,_0x5a2223,_0x1c1132)=>{const _0x5154ef=_0x54a8a6,_0x33829c={'BFrVH':_0x5154ef(0x1d9),'vWClb':_0x5154ef(0x1fc),'QxtOW':_0x5154ef(0x2ea),'Kpcfx':'showFooter','YUtjK':_0x5154ef(0x25e),'DBozS':'1|4|6|2|0|5|3','FazjM':'Login\x20successful','IBhOg':function(_0x532713,_0x2b396f,_0x4315c0){return _0x532713(_0x2b396f,_0x4315c0);},'CLTxf':_0x5154ef(0x301),'JZdaQ':function(_0x19a9ff,_0x50408d){return _0x19a9ff(_0x50408d);},'Yjwea':function(_0x365c14,_0x656ead,_0x28d91a){return _0x365c14(_0x656ead,_0x28d91a);},'xjnRt':function(_0x42f57a,_0x32a85a){return _0x42f57a!==_0x32a85a;},'uxROB':_0x5154ef(0x2dc),'yMVjD':_0x5154ef(0x26d),'XgUVE':function(_0x5bfa81,_0x172c88){return _0x5bfa81>_0x172c88;},'Tdzcg':'nZpCH','LeYim':_0x5154ef(0x2d7)},_0x512b2b=_0x14af1e[_0x5154ef(0x1cc)]['db'],_0x8ab60b=_0x14af1e[_0x5154ef(0x29a)][_0x5154ef(0x1c9)],_0x2ca67b=0x5;let _0x243d4b=[],_0x234e19=[],_0x4ce62a=[];const _0x20736f={},_0x33445a={},_0x2e5453={};if(ObjectId[_0x5154ef(0x2f2)](_0x14af1e['body'][_0x5154ef(0x1c9)])){const _0x2d6a91=_0x5154ef(0x202)[_0x5154ef(0x265)]('|');let _0x7d87b2=0x0;while(!![]){switch(_0x2d6a91[_0x7d87b2++]){case'0':_0x4ce62a=await _0x512b2b['products'][_0x5154ef(0x2c5)]({'_id':ObjectId(_0x8ab60b)})['limit'](_0x2ca67b)[_0x5154ef(0x258)]({'productAddedDate':0x1})[_0x5154ef(0x25b)]();continue;case'1':_0x234e19=await _0x512b2b['orders']['find']({'_id':ObjectId(_0x8ab60b)})[_0x5154ef(0x24b)](_0x2ca67b)[_0x5154ef(0x258)]({'orderDate':0x1})[_0x5154ef(0x25b)]();continue;case'2':_0x243d4b=await _0x512b2b[_0x5154ef(0x1bc)][_0x5154ef(0x2c5)]({'_id':_0x33829c[_0x5154ef(0x21b)](ObjectId,_0x8ab60b)})['limit'](_0x2ca67b)[_0x5154ef(0x258)]({'created':0x1})[_0x5154ef(0x25b)]();continue;case'3':_0x33829c[_0x5154ef(0x1e2)](setTimeout,function(){const _0x2500dc=_0x5154ef;console[_0x2500dc(0x267)](_0x33829c[_0x2500dc(0x1cd)]);},0x64);continue;case'4':return _0x5a2223[_0x5154ef(0x2af)](0xc8)[_0x5154ef(0x216)]({'customers':_0x243d4b,'orders':_0x234e19,'products':_0x4ce62a});}break;}}if(emailRegex[_0x5154ef(0x280)](_0x14af1e[_0x5154ef(0x29a)][_0x5154ef(0x1c9)]))_0x20736f[_0x5154ef(0x2da)]=_0x8ab60b,_0x33445a['orderEmail']=_0x8ab60b;else{if(numericRegex[_0x5154ef(0x280)](_0x14af1e[_0x5154ef(0x29a)][_0x5154ef(0x1c9)])){if(_0x33829c[_0x5154ef(0x2c7)](_0x5154ef(0x1dc),_0x33829c[_0x5154ef(0x2a5)]))_0x33445a[_0x5154ef(0x305)]=_0x14af1e[_0x5154ef(0x29a)][_0x5154ef(0x1c9)],_0x2e5453['productPrice']=_0x14af1e['body']['searchValue'];else{_0x3c6329[_0x5154ef(0x1c7)][_0x5154ef(0x28c)]=!![],_0x285735[_0x5154ef(0x21e)](_0x5154ef(0x25c),{'title':_0x33829c[_0x5154ef(0x1c2)],'config':_0x352e0f[_0x5154ef(0x1cc)][_0x5154ef(0x2f8)],'helpers':_0x401271[_0x5154ef(0x211)][_0x5154ef(0x299)],'message':_0x32ff42[_0x5154ef(0x2df)](_0x4ca986[_0x5154ef(0x1c7)],_0x33829c['QxtOW']),'messageType':_0x201db3[_0x5154ef(0x2df)](_0x18a603[_0x5154ef(0x1c7)],_0x5154ef(0x23f)),'showFooter':_0x33829c['Kpcfx']}),_0x26da7f(_0x33829c[_0x5154ef(0x27b)])();return;}}else _0x20736f['$or']=[{'firstName':{'$regex':new RegExp(_0x8ab60b,_0x33829c[_0x5154ef(0x2cc)])}},{'lastName':{'$regex':new RegExp(_0x8ab60b,'img')}}],_0x33445a[_0x5154ef(0x219)]=[{'orderFirstname':{'$regex':new RegExp(_0x8ab60b,_0x33829c['yMVjD'])}},{'orderLastname':{'$regex':new RegExp(_0x8ab60b,_0x33829c['yMVjD'])}}],_0x2e5453['$or']=[{'productTitle':{'$regex':new RegExp(_0x8ab60b,_0x5154ef(0x26d))}},{'productDescription':{'$regex':new RegExp(_0x8ab60b,_0x33829c[_0x5154ef(0x2cc)])}}];}if(_0x33829c['XgUVE'](Object[_0x5154ef(0x2fb)](_0x20736f)[_0x5154ef(0x225)],0x0)){if(_0x5154ef(0x285)!==_0x33829c[_0x5154ef(0x2b5)]){if(_0x34932d){const _0x3255a0=_0x33829c[_0x5154ef(0x1f4)][_0x5154ef(0x265)]('|');let _0xef189a=0x0;while(!![]){switch(_0x3255a0[_0xef189a++]){case'0':_0x15ed36[_0x5154ef(0x2af)](0xc8)[_0x5154ef(0x216)]({'message':_0x33829c[_0x5154ef(0x1c5)]});continue;case'1':_0x3ec6da[_0x5154ef(0x1c7)][_0x5154ef(0x2c1)]=_0x511fd9[_0x5154ef(0x29a)][_0x5154ef(0x2da)];continue;case'2':_0x49a3eb[_0x5154ef(0x1c7)][_0x5154ef(0x218)]=_0x81851f['isAdmin'];continue;case'3':return;case'4':_0x16ba31['session'][_0x5154ef(0x22e)]=_0x30fb51['usersName'];continue;case'5':_0x33829c[_0x5154ef(0x2ad)](_0xc4189b,_0x33829c[_0x5154ef(0x1fa)],0x3e8);continue;case'6':_0x383ed7[_0x5154ef(0x1c7)][_0x5154ef(0x2ec)]=_0x3cf1e8[_0x5154ef(0x1e6)]['toString']();continue;}break;}}_0x120f2c[_0x5154ef(0x2af)](0x190)[_0x5154ef(0x216)]({'message':'Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.'});}else _0x243d4b=await _0x512b2b[_0x5154ef(0x1bc)][_0x5154ef(0x2c5)](_0x20736f)[_0x5154ef(0x24b)](_0x2ca67b)[_0x5154ef(0x258)]({'created':0x1})['toArray']();}return Object[_0x5154ef(0x2fb)](_0x33445a)[_0x5154ef(0x225)]>0x0&&(_0x234e19=await _0x512b2b[_0x5154ef(0x2a6)][_0x5154ef(0x2c5)](_0x33445a)[_0x5154ef(0x24b)](_0x2ca67b)[_0x5154ef(0x258)]({'orderDate':0x1})[_0x5154ef(0x25b)]()),_0x33829c[_0x5154ef(0x1de)](Object[_0x5154ef(0x2fb)](_0x2e5453)[_0x5154ef(0x225)],0x0)&&(_0x4ce62a=await _0x512b2b[_0x5154ef(0x25d)][_0x5154ef(0x2c5)](_0x2e5453)[_0x5154ef(0x24b)](_0x2ca67b)[_0x5154ef(0x258)]({'productAddedDate':0x1})[_0x5154ef(0x25b)]()),WebSocket(_0x33829c[_0x5154ef(0x1d2)]),_0x5a2223[_0x5154ef(0x2af)](0xc8)[_0x5154ef(0x216)]({'customers':_0x243d4b,'orders':_0x234e19,'products':_0x4ce62a});}),module[_0x54a8a6(0x2cd)]=router;