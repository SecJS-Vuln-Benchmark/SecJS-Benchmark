const _0x570145=_0x148a;function _0x1079(){const _0x32fe43=['delete','dPorp','messageType','replace','isAfter','/admin/createApiKey','toArray','createWriteStream','searchValue','settings','../lib/schema','start','$or','vnbqI','/admin/settings/discount/edit/:id','email','MtOsl','stringify','oodtO','single','cTJOt','$orderProducts','vDcvD','newMenu','jNjoY','findOneAndUpdate','ijagH','File\x20upload\x20error.\x20Please\x20try\x20again.','XFScw','Hmmnr','error','Permalink\x20validated\x20successfully','PbRVZ','insertOne','Discount\x20code\x20edit','join','/admin/settings/menu/saveOrder','/admin/settings/pages','124467ecqOkh','cJHmt','params','ItwJM','Page\x20updated\x20successfully','oRWFY','sortMenu','MIlvB','img','undefined','settings-discount-edit','getId','decode','$o.v.productId','EHpwT','customers','Failed\x20deleting\x20menu.','zuLmp','eVCoP','expressCart\x20test\x20email','/admin/settings/discount/create','redirect','split','/admin/settings/pages/edit/:page','eScaU','/admin','getThemes','TgypW','value','1|0|2|4|3','404\x20Error\x20-\x20Page\x20not\x20found','PxPTK','thnqm','toString','Failed\x20creating\x20menu.','mUGXz','limit','gCLwt','updateClock();','sum','/uploads','spLxf','lHpDH','Page\x20not\x20found','VMDxw','amount','fetQa','helpers','/admin/settings/menu','deleteMenu','result','oDzMD','user','orderEmail','handlebars','Login\x20successful','eiHIZ','bjLsh','$o.v.productImage','114jfnqxQ','products','HTJYg','TNxSE','A\x20user\x20with\x20that\x20email\x20does\x20not\x20exist.','public/uploads','FTCwy','ordersAmount','docId','HbcpY','password','MIDSq','bwYgH','LNCkk','editDiscount','login','JAeHZ','settings-menu','return\x20Object.keys({a:1});','pageEnabled','body','status','nvzUA','zzJzV','_id','Referer','YNbaQ','lupum','findOne','/admin/searchall','916288uDEvsX','API\x20Key\x20generated','562bZazDf','pMqrH','qoJkJ','Cart\x20settings','pBXQN','/admin/csrf','/admin/login_action','unlinkSync','code','AMCPx','ERqGQ','PkRuS','Cart\x20dashboard','Settings\x20successfully\x20updated','Static\x20pages','app','pages','KLllX','/admin/settings/discounts','express','return\x20await\x20Promise.resolve(42);','/admin/login','Menu\x20updated\x20successfully.','Login','type','Failed\x20to\x20generate\x20API\x20Key','get','isBefore','yCESh','file','OPULO','log','menuId','settings-discount-new','session','New\x20page\x20successfully\x20created','9tpgpwu','discountId','header','end','/admin/setup_action','showFooter','Discount\x20code\x20created\x20successfully','orders','settings-pages','countDocuments','tHRSU','pipe','BMkqW','RMYzS','UvymG','env','hlPtE','40mjVpQg','json','pageId','getMenu','compare','../lib/auth','IlrKq','YEHtB','/admin/settings','leICg','/admin/setup','25675793djAATl','bjXAS','AhBDH','public/uploads/','VEZKa','sort','PyRib','updateMenu','deleteOne','lookup','HMaPt','size','uwvkz','mime-type/with-db','hPcxm','Error\x20creating\x20page.\x20Please\x20try\x20again.','rqxvL','csurf','needsSetup','post','/admin/settings/page/delete','test','Menu\x20created\x20successfully.','dPMRY','permalink','wiEqd','4803uwljJS','safe','MCXdY','ijazi','MrKPz','settings-discounts','allowedMimeType','Successfully\x20saved','NVfgm','Discount\x20code\x20create','pQnDS','reuzL','clearSessionValue','/admin/validatePermalink','4287104jvHULs','Already\x20setup.','SZRXI','userPassword','DD/MM/YYYY\x20HH:mm','User\x20account\x20inserted','bcryptjs','TFNLY','SJdSy','config','Failed\x20to\x20insert\x20user:\x20','Error\x20deleting\x20discount\x20code.\x20Please\x20try\x20again.','xcZBo','userEmail','dUNIp','NxCnY','Create','footerHtml','render','find','users','GJckf','html-entities','red','insertedId','toDate','$orderProductCount','CmBuA','../lib/common','multer','productsSold','iikWZ','nHsam','WBZZb','checkDirectorySync','settings-page','exports','/admin/file/upload','/admin/dashboard','xJxRZ','orderMenu','return\x20new\x20Date();','4999470fiITuZ','ObjectID','aiXIl','upOcI','/admin/settings/menu/update','pageSlug','Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today','csrfToken','keys','gYjsT','$orderTotal','TIpFl','aggregate','pageContent','bdaCk','/admin/testEmail','fLPoG','googleAnalytics','usersName','updateOne','VNIcw','Setup\x20failed','userId','Access\x20denied.\x20Check\x20password\x20and\x20try\x20again.','moment','emailAddress','message','IrqAW','OeqbA','Permalink\x20already\x20exists','/admin/settings/discount/update','apiKey','XCdSu','originalname','oCryo','/admin/settings/pages/new','productId','Failed\x20updating\x20menu.','Discount\x20code\x20successfully\x20deleted','DltdG','ThAiQ','QGNZi','length','lhlaX','Test\x20email\x20sent','hashSync','BBVFe','dTwuC','GoVZk','wgefT','getConfig','Page\x20successfully\x20deleted','errors','colors','/admin/settings/menu/new','Failed\x20saving\x20menu\x20order','llkaM','Failed\x20to\x20save.\x20Please\x20try\x20again','/admin/settings/discount/new','Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date','AHDoB','console.log(\x22timer\x22);','/admin/settings/page','/admin/settings/menu/delete','productPrice','11960FQZbhT','var\x20x\x20=\x2042;\x20return\x20x;','path','Cart\x20menu','discounts'];_0x1079=function(){return _0x32fe43;};return _0x1079();}(function(_0x465028,_0x4ad05a){const _0x16593a=_0x148a,_0x2f9226=_0x465028();while(!![]){try{const _0x58fa9c=-parseInt(_0x16593a(0x1f5))/0x1+parseInt(_0x16593a(0x1f7))/0x2*(parseInt(_0x16593a(0x251))/0x3)+-parseInt(_0x16593a(0x22c))/0x4*(parseInt(_0x16593a(0x171))/0x5)+-parseInt(_0x16593a(0x1d7))/0x6*(parseInt(_0x16593a(0x19c))/0x7)+parseInt(_0x16593a(0x25f))/0x8*(-parseInt(_0x16593a(0x21b))/0x9)+-parseInt(_0x16593a(0x289))/0xa+parseInt(_0x16593a(0x237))/0xb;if(_0x58fa9c===_0x4ad05a)break;else _0x2f9226['push'](_0x2f9226['shift']());}catch(_0x1e944){_0x2f9226['push'](_0x2f9226['shift']());}}}(_0x1079,0x72c92));const express=require(_0x570145(0x20a)),common=require(_0x570145(0x27b)),{restrict,checkAccess}=require(_0x570145(0x231)),escape=require(_0x570145(0x275))['AllHtmlEntities'],colors=require(_0x570145(0x2be)),bcrypt=require(_0x570145(0x265)),moment=require(_0x570145(0x2a1)),fs=require('fs'),path=require(_0x570145(0x173)),multer=require(_0x570145(0x27c)),mime=require(_0x570145(0x244)),csrf=require(_0x570145(0x248)),{validateJson}=require(_0x570145(0x180)),ObjectId=require('mongodb')[_0x570145(0x28a)],router=express['Router'](),csrfProtection=csrf({'cookie':!![]}),emailRegex=/\S+@\S+\.\S+/,numericRegex=/^\d*\.?\d*$/;function _0x148a(_0xb39d8b,_0x32f7d1){const _0x1079ad=_0x1079();return _0x148a=function(_0x148a0a,_0x365862){_0x148a0a=_0x148a0a-0x16a;let _0x1fceb5=_0x1079ad[_0x148a0a];return _0x1fceb5;},_0x148a(_0xb39d8b,_0x32f7d1);}router[_0x570145(0x211)](_0x570145(0x1b5),restrict,(_0x19d80f,_0x2d1b4b,_0x353dd9)=>{const _0x515785=_0x570145;_0x2d1b4b['redirect'](_0x515785(0x285));}),router[_0x570145(0x211)]('/admin/logout',(_0x28b0b7,_0x443b7d)=>{const _0x1f3694=_0x570145;_0x28b0b7[_0x1f3694(0x219)][_0x1f3694(0x1d0)]=null,_0x28b0b7[_0x1f3694(0x219)][_0x1f3694(0x2a3)]=null,_0x28b0b7['session'][_0x1f3694(0x178)]=null,_0x443b7d[_0x1f3694(0x1b1)]('/');});process[_0x570145(0x22a)]['NODE_ENV']==='test'&&router['get'](_0x570145(0x1fc),csrfProtection,(_0x232c6d,_0x45ddb0,_0x392b53)=>{const _0x5127e7=_0x570145;_0x45ddb0[_0x5127e7(0x22d)]({'csrf':_0x232c6d['csrfToken']()});});router['get'](_0x570145(0x20c),async(_0x180ea0,_0x45ffd4)=>{const _0x489269=_0x570145,_0xb99331={'yCESh':function(_0x1844ed,_0x4c705b){return _0x1844ed>_0x4c705b;},'OpogF':_0x489269(0x20e),'eiHIZ':_0x489269(0x1f0),'jNjoY':'message','gPnBf':'showFooter','cJHmt':_0x489269(0x236)},_0xf9aead=_0x180ea0['app']['db'],_0x855a77=await _0xf9aead[_0x489269(0x273)][_0x489269(0x224)]({});_0x855a77&&_0xb99331[_0x489269(0x213)](_0x855a77,0x0)?(_0x180ea0[_0x489269(0x219)][_0x489269(0x249)]=![],_0x45ffd4[_0x489269(0x271)](_0x489269(0x1e6),{'title':_0xb99331['OpogF'],'referringUrl':_0x180ea0[_0x489269(0x21d)](_0xb99331[_0x489269(0x1d4)]),'config':_0x180ea0['app']['config'],'message':common['clearSessionValue'](_0x180ea0[_0x489269(0x219)],_0xb99331[_0x489269(0x18e)]),'messageType':common[_0x489269(0x25d)](_0x180ea0[_0x489269(0x219)],_0x489269(0x178)),'helpers':_0x180ea0['handlebars'][_0x489269(0x1cb)],'showFooter':_0xb99331['gPnBf']})):(_0x180ea0[_0x489269(0x219)][_0x489269(0x249)]=!![],_0x45ffd4[_0x489269(0x1b1)](_0xb99331[_0x489269(0x19d)]));}),router[_0x570145(0x24a)](_0x570145(0x1fd),async(_0xbdf7e7,_0xcb519b)=>{const _0x39298a=_0x570145,_0x3b6dbc={'JKthm':_0x39298a(0x252),'GvSOx':_0x39298a(0x1d3),'pMqrH':_0x39298a(0x2a0),'eScaU':_0x39298a(0x1db),'GrXms':function(_0x9f5c67,_0x3ba757,_0x59c281){return _0x9f5c67(_0x3ba757,_0x59c281);}},_0x1f7637=_0xbdf7e7[_0x39298a(0x206)]['db'],_0x4eb479=await _0x1f7637[_0x39298a(0x273)]['findOne']({'userEmail':common['mongoSanitize'](_0xbdf7e7[_0x39298a(0x1eb)][_0x39298a(0x185)])});if(!_0x4eb479||_0x4eb479===null){_0xcb519b[_0x39298a(0x1ec)](0x190)[_0x39298a(0x22d)]({'message':_0x3b6dbc[_0x39298a(0x1b4)]}),_0x3b6dbc['GrXms'](setTimeout,function(){const _0x1b7c9a=_0x39298a;console[_0x1b7c9a(0x216)](_0x3b6dbc['JKthm']);},0x64);return;}bcrypt[_0x39298a(0x230)](_0xbdf7e7[_0x39298a(0x1eb)][_0x39298a(0x1e1)],_0x4eb479['userPassword'])['then'](_0x4ecb3a=>{const _0x1d2a90=_0x39298a;if(_0x4ecb3a){_0xbdf7e7[_0x1d2a90(0x219)]['user']=_0xbdf7e7[_0x1d2a90(0x1eb)]['email'],_0xbdf7e7[_0x1d2a90(0x219)][_0x1d2a90(0x29b)]=_0x4eb479[_0x1d2a90(0x29b)],_0xbdf7e7['session'][_0x1d2a90(0x29f)]=_0x4eb479[_0x1d2a90(0x1ef)]['toString'](),_0xbdf7e7[_0x1d2a90(0x219)]['isAdmin']=_0x4eb479['isAdmin'],_0xcb519b['status'](0xc8)[_0x1d2a90(0x22d)]({'message':_0x3b6dbc['GvSOx']}),Function('return\x20new\x20Date();')();return;}_0xcb519b[_0x1d2a90(0x1ec)](0x190)[_0x1d2a90(0x22d)]({'message':_0x3b6dbc[_0x1d2a90(0x1f8)]});});}),router[_0x570145(0x211)](_0x570145(0x236),async(_0x4f9ec8,_0xb7dcf4)=>{const _0x23a8a2=_0x570145,_0x4b961b={'nvzUA':'setup','RMYzS':'Setup','spLxf':function(_0x3655eb,_0x2140c6){return _0x3655eb(_0x2140c6);},'CmBuA':_0x23a8a2(0x1e9),'Hmmnr':_0x23a8a2(0x20c)},_0x56cfc5=_0x4f9ec8['app']['db'],_0x12cf5e=await _0x56cfc5[_0x23a8a2(0x273)]['countDocuments']({});_0x4f9ec8['session'][_0x23a8a2(0x249)]=![];if(_0x12cf5e===0x0){_0x4f9ec8['session'][_0x23a8a2(0x249)]=!![],_0xb7dcf4['render'](_0x4b961b[_0x23a8a2(0x1ed)],{'title':_0x4b961b[_0x23a8a2(0x228)],'config':_0x4f9ec8[_0x23a8a2(0x206)][_0x23a8a2(0x268)],'helpers':_0x4f9ec8[_0x23a8a2(0x1d2)]['helpers'],'message':common['clearSessionValue'](_0x4f9ec8[_0x23a8a2(0x219)],_0x23a8a2(0x2a3)),'messageType':common['clearSessionValue'](_0x4f9ec8[_0x23a8a2(0x219)],_0x23a8a2(0x178)),'showFooter':_0x23a8a2(0x220)}),_0x4b961b[_0x23a8a2(0x1c5)](Function,_0x4b961b[_0x23a8a2(0x27a)])();return;}_0xb7dcf4[_0x23a8a2(0x1b1)](_0x4b961b[_0x23a8a2(0x193)]);}),router['post'](_0x570145(0x21f),async(_0x210684,_0x10b0a0)=>{const _0x16dc12=_0x570145,_0x45f3d5={'HbcpY':function(_0x25dbe0,_0x424f89){return _0x25dbe0*_0x424f89;},'VMDxw':function(_0x4eb405,_0x1d2f13){return _0x4eb405===_0x1d2f13;},'tdHOd':_0x16dc12(0x264),'zuLmp':_0x16dc12(0x29e)},_0xe3fef0=_0x210684[_0x16dc12(0x206)]['db'],_0x5c19a8={'usersName':_0x210684[_0x16dc12(0x1eb)][_0x16dc12(0x29b)],'userEmail':_0x210684[_0x16dc12(0x1eb)][_0x16dc12(0x26c)],'userPassword':bcrypt[_0x16dc12(0x2b6)](_0x210684[_0x16dc12(0x1eb)][_0x16dc12(0x262)],0xa),'isAdmin':!![],'isOwner':!![]},_0x3788c9=await _0xe3fef0[_0x16dc12(0x273)][_0x16dc12(0x224)]({});if(_0x45f3d5[_0x16dc12(0x1c8)](_0x3788c9,0x0))try{await _0xe3fef0[_0x16dc12(0x273)]['insertOne'](_0x5c19a8),_0x10b0a0['status'](0xc8)[_0x16dc12(0x22d)]({'message':_0x45f3d5['tdHOd']}),new AsyncFunction(_0x16dc12(0x20b))();return;}catch(_0x3b7ff1){console[_0x16dc12(0x194)](colors[_0x16dc12(0x276)](_0x16dc12(0x269)+_0x3b7ff1)),_0x10b0a0[_0x16dc12(0x1ec)](0xc8)[_0x16dc12(0x22d)]({'message':_0x45f3d5[_0x16dc12(0x1ad)]}),eval('const _0x51937e = _0x16dc12;_0x45f3d5[_0x51937e(480)](Math[\'PI\'], 2);');return;}_0x10b0a0[_0x16dc12(0x1ec)](0xc8)[_0x16dc12(0x22d)]({'message':_0x16dc12(0x260)});}),router[_0x570145(0x211)]('/admin/dashboard',csrfProtection,restrict,async(_0x459eed,_0x541374)=>{const _0x54ee71=_0x570145,_0x257bae={'ThAiQ':_0x54ee71(0x2ae),'vDcvD':'Menu\x20updated\x20successfully.','dUNIp':_0x54ee71(0x279),'MGmJw':_0x54ee71(0x1a9),'bdaCk':'$o.v.title','xiJJh':function(_0x5b7499,_0x28109a){return _0x5b7499>_0x28109a;},'tHRSU':function(_0x251f82,_0x3c31ce){return _0x251f82!==_0x3c31ce;},'EHpwT':'pBXQN','PbRVZ':function(_0xe13eb5,_0x39062c){return _0xe13eb5>_0x39062c;},'zcKdP':'dashboard','fetQa':_0x54ee71(0x203),'OMrsT':_0x54ee71(0x178)},_0x5c9b41=_0x459eed['app']['db'],_0x176d55={'productsCount':await _0x5c9b41[_0x54ee71(0x1d8)][_0x54ee71(0x224)]({'productPublished':!![]}),'ordersCount':await _0x5c9b41[_0x54ee71(0x222)]['countDocuments']({}),'ordersAmount':await _0x5c9b41['orders']['aggregate']([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x54ee71(0x293)}}}])[_0x54ee71(0x17c)](),'productsSold':await _0x5c9b41['orders'][_0x54ee71(0x295)]([{'$match':{}},{'$group':{'_id':null,'sum':{'$sum':_0x257bae[_0x54ee71(0x26d)]}}}])[_0x54ee71(0x17c)](),'topProducts':await _0x5c9b41['orders'][_0x54ee71(0x295)]([{'$project':{'_id':0x0}},{'$project':{'o':{'$objectToArray':_0x54ee71(0x18b)}}},{'$unwind':'$o'},{'$group':{'_id':_0x257bae['MGmJw'],'title':{'$last':_0x257bae[_0x54ee71(0x297)]},'productImage':{'$last':_0x54ee71(0x1d6)},'count':{'$sum':'$o.v.quantity'}}},{'$sort':{'count':-0x1}},{'$limit':0x5}])[_0x54ee71(0x17c)]()};if(_0x257bae['xiJJh'](_0x176d55['ordersAmount'][_0x54ee71(0x2b3)],0x0)){if(_0x257bae[_0x54ee71(0x225)](_0x54ee71(0x1fb),_0x257bae[_0x54ee71(0x1aa)])){const _0x5339d2=_0x4e2219[_0x54ee71(0x23e)](_0xa00f01);if(_0x5339d2===![]){_0x2a1e73['status'](0x190)['json']({'message':_0x257bae[_0x54ee71(0x2b1)]}),new _0x48c251(_0x54ee71(0x172))();return;}_0x4ed6fa[_0x54ee71(0x1ec)](0xc8)['json']({'message':_0x257bae[_0x54ee71(0x18c)]});}else _0x176d55[_0x54ee71(0x1de)]=_0x176d55[_0x54ee71(0x1de)][0x0]['sum'];}_0x257bae[_0x54ee71(0x196)](_0x176d55[_0x54ee71(0x27d)][_0x54ee71(0x2b3)],0x0)?_0x176d55[_0x54ee71(0x27d)]=_0x176d55[_0x54ee71(0x27d)][0x0][_0x54ee71(0x1c3)]:_0x176d55[_0x54ee71(0x27d)]=0x0,_0x541374['render'](_0x257bae['zcKdP'],{'title':_0x257bae[_0x54ee71(0x1ca)],'session':_0x459eed['session'],'admin':!![],'dashboardData':_0x176d55,'themes':common[_0x54ee71(0x1b6)](),'message':common['clearSessionValue'](_0x459eed['session'],_0x54ee71(0x2a3)),'messageType':common[_0x54ee71(0x25d)](_0x459eed[_0x54ee71(0x219)],_0x257bae['OMrsT']),'helpers':_0x459eed[_0x54ee71(0x1d2)][_0x54ee71(0x1cb)],'config':_0x459eed[_0x54ee71(0x206)][_0x54ee71(0x268)],'csrfToken':_0x459eed[_0x54ee71(0x290)]()});}),router[_0x570145(0x211)](_0x570145(0x234),csrfProtection,restrict,(_0x59d0b5,_0x5f1802)=>{const _0x43fe75=_0x570145,_0x46869d={'cTJOt':_0x43fe75(0x17f),'XDQcK':_0x43fe75(0x1fa),'gCLwt':'messageType','VEZKa':function(_0x5a23a2,_0x26ddc6){return _0x5a23a2!==_0x26ddc6;}};_0x5f1802[_0x43fe75(0x271)](_0x46869d[_0x43fe75(0x18a)],{'title':_0x46869d['XDQcK'],'session':_0x59d0b5[_0x43fe75(0x219)],'admin':!![],'themes':common[_0x43fe75(0x1b6)](),'message':common[_0x43fe75(0x25d)](_0x59d0b5['session'],_0x43fe75(0x2a3)),'messageType':common[_0x43fe75(0x25d)](_0x59d0b5[_0x43fe75(0x219)],_0x46869d[_0x43fe75(0x1c1)]),'helpers':_0x59d0b5[_0x43fe75(0x1d2)][_0x43fe75(0x1cb)],'config':_0x59d0b5['app'][_0x43fe75(0x268)],'footerHtml':typeof _0x59d0b5[_0x43fe75(0x206)][_0x43fe75(0x268)][_0x43fe75(0x270)]!==_0x43fe75(0x1a5)?escape[_0x43fe75(0x1a8)](_0x59d0b5[_0x43fe75(0x206)]['config'][_0x43fe75(0x270)]):null,'googleAnalytics':_0x46869d[_0x43fe75(0x23b)](typeof _0x59d0b5[_0x43fe75(0x206)][_0x43fe75(0x268)][_0x43fe75(0x29a)],_0x43fe75(0x1a5))?escape[_0x43fe75(0x1a8)](_0x59d0b5[_0x43fe75(0x206)][_0x43fe75(0x268)][_0x43fe75(0x29a)]):null,'csrfToken':_0x59d0b5[_0x43fe75(0x290)]()});}),router[_0x570145(0x24a)](_0x570145(0x17b),restrict,checkAccess,async(_0x10a5ed,_0x5b8133)=>{const _0x44d219=_0x570145,_0x40fa9b={'fLPoG':function(_0xe8cb39,_0x12b6c2){return _0xe8cb39(_0x12b6c2);},'isPzx':'API\x20Key\x20generated','FTCwy':function(_0x5250c9,_0x5b0b2e,_0x2293f0){return _0x5250c9(_0x5b0b2e,_0x2293f0);},'QGNZi':'updateClock();','qoJkJ':_0x44d219(0x210)},_0x472bd2=_0x10a5ed[_0x44d219(0x206)]['db'],_0x286ad0=await _0x472bd2['users'][_0x44d219(0x18f)]({'_id':_0x40fa9b[_0x44d219(0x299)](ObjectId,_0x10a5ed[_0x44d219(0x219)][_0x44d219(0x29f)]),'isAdmin':!![]},{'$set':{'apiKey':new ObjectId()}},{'returnOriginal':![]});if(_0x286ad0['value']&&_0x286ad0[_0x44d219(0x1b8)][_0x44d219(0x2a8)]){_0x5b8133[_0x44d219(0x1ec)](0xc8)[_0x44d219(0x22d)]({'message':_0x40fa9b['isPzx'],'apiKey':_0x286ad0['value'][_0x44d219(0x2a8)]}),_0x40fa9b[_0x44d219(0x1dd)](setInterval,_0x40fa9b[_0x44d219(0x2b2)],0x3e8);return;}_0x5b8133[_0x44d219(0x1ec)](0x190)[_0x44d219(0x22d)]({'message':_0x40fa9b[_0x44d219(0x1f9)]});}),router[_0x570145(0x24a)]('/admin/settings/update',restrict,checkAccess,(_0x11cffe,_0xb22edb)=>{const _0x2b826c=_0x570145,_0x487a87={'vnbqI':_0x2b826c(0x204)},_0x3138d9=common['updateConfig'](_0x11cffe[_0x2b826c(0x1eb)]);if(_0x3138d9===!![]){_0x11cffe['app'][_0x2b826c(0x268)]=common[_0x2b826c(0x2bb)](),_0xb22edb['status'](0xc8)['json']({'message':_0x487a87[_0x2b826c(0x183)]}),eval('const _0x556f6f = _0x2b826c;JSON[_0x556f6f(391)]({ \'safe\': !![] });');return;}_0xb22edb[_0x2b826c(0x1ec)](0x190)[_0x2b826c(0x22d)]({'message':'Permission\x20denied'});}),router['get'](_0x570145(0x1cc),csrfProtection,restrict,async(_0x2384ec,_0x2d47c6)=>{const _0x408f9e=_0x570145,_0x3c4001={'YEHtB':function(_0x466d0e,_0x258829){return _0x466d0e(_0x258829);},'NxCnY':'/api/public/status'},_0x25ca6d=_0x2384ec['app']['db'];_0x2d47c6[_0x408f9e(0x271)](_0x408f9e(0x1e8),{'title':_0x408f9e(0x174),'session':_0x2384ec[_0x408f9e(0x219)],'admin':!![],'message':common[_0x408f9e(0x25d)](_0x2384ec['session'],_0x408f9e(0x2a3)),'messageType':common['clearSessionValue'](_0x2384ec[_0x408f9e(0x219)],_0x408f9e(0x178)),'helpers':_0x2384ec[_0x408f9e(0x1d2)][_0x408f9e(0x1cb)],'config':_0x2384ec['app'][_0x408f9e(0x268)],'menu':common['sortMenu'](await common[_0x408f9e(0x22f)](_0x25ca6d)),'csrfToken':_0x2384ec['csrfToken']()}),_0x3c4001[_0x408f9e(0x233)](fetch,_0x3c4001[_0x408f9e(0x26e)]);}),router[_0x570145(0x211)](_0x570145(0x19b),csrfProtection,restrict,async(_0x3721bf,_0x57828c)=>{const _0x267395=_0x570145,_0x58e779={'lhlaX':_0x267395(0x223),'dPorp':_0x267395(0x2a3)},_0x53b145=_0x3721bf[_0x267395(0x206)]['db'],_0x3c6518=await _0x53b145['pages'][_0x267395(0x272)]({})[_0x267395(0x17c)]();_0x57828c['render'](_0x58e779[_0x267395(0x2b4)],{'title':_0x267395(0x205),'pages':_0x3c6518,'session':_0x3721bf[_0x267395(0x219)],'admin':!![],'message':common[_0x267395(0x25d)](_0x3721bf['session'],_0x58e779[_0x267395(0x177)]),'messageType':common[_0x267395(0x25d)](_0x3721bf[_0x267395(0x219)],_0x267395(0x178)),'helpers':_0x3721bf[_0x267395(0x1d2)][_0x267395(0x1cb)],'config':_0x3721bf[_0x267395(0x206)][_0x267395(0x268)],'menu':common[_0x267395(0x1a2)](await common[_0x267395(0x22f)](_0x53b145)),'csrfToken':_0x3721bf[_0x267395(0x290)]()});}),router[_0x570145(0x211)](_0x570145(0x2ac),csrfProtection,restrict,checkAccess,async(_0x28a925,_0x25a730)=>{const _0x307d97=_0x570145,_0x4720e0={'hPcxm':_0x307d97(0x282),'lupum':_0x307d97(0x2a3)},_0x31c912=_0x28a925[_0x307d97(0x206)]['db'];_0x25a730[_0x307d97(0x271)](_0x4720e0[_0x307d97(0x245)],{'title':_0x307d97(0x205),'session':_0x28a925[_0x307d97(0x219)],'admin':!![],'button_text':_0x307d97(0x26f),'message':common[_0x307d97(0x25d)](_0x28a925[_0x307d97(0x219)],_0x4720e0[_0x307d97(0x1f2)]),'messageType':common['clearSessionValue'](_0x28a925[_0x307d97(0x219)],'messageType'),'helpers':_0x28a925['handlebars'][_0x307d97(0x1cb)],'config':_0x28a925[_0x307d97(0x206)][_0x307d97(0x268)],'menu':common['sortMenu'](await common[_0x307d97(0x22f)](_0x31c912)),'csrfToken':_0x28a925[_0x307d97(0x290)]()});}),router[_0x570145(0x211)](_0x570145(0x1b3),csrfProtection,restrict,checkAccess,async(_0x797e6f,_0x2db2e1)=>{const _0x4c3623=_0x570145,_0x44c1b4={'mUGXz':_0x4c3623(0x194),'tWMIx':_0x4c3623(0x1ba),'wiEqd':'settings-page','OPULO':_0x4c3623(0x205)},_0x904ac6=_0x797e6f[_0x4c3623(0x206)]['db'],_0x5ac91d=await _0x904ac6[_0x4c3623(0x207)][_0x4c3623(0x1f3)]({'_id':common[_0x4c3623(0x1a7)](_0x797e6f[_0x4c3623(0x19e)]['page'])}),_0x230d22=common[_0x4c3623(0x1a2)](await common[_0x4c3623(0x22f)](_0x904ac6));if(!_0x5ac91d){_0x2db2e1[_0x4c3623(0x1ec)](0x194)['render'](_0x44c1b4[_0x4c3623(0x1bf)],{'title':_0x44c1b4['tWMIx'],'config':_0x797e6f[_0x4c3623(0x206)][_0x4c3623(0x268)],'message':'404\x20Error\x20-\x20Page\x20not\x20found','helpers':_0x797e6f['handlebars'][_0x4c3623(0x1cb)],'showFooter':_0x4c3623(0x220),'menu':_0x230d22}),new Function(_0x4c3623(0x172))();return;}_0x2db2e1[_0x4c3623(0x271)](_0x44c1b4[_0x4c3623(0x250)],{'title':_0x44c1b4[_0x4c3623(0x215)],'page':_0x5ac91d,'button_text':'Update','session':_0x797e6f['session'],'admin':!![],'message':common[_0x4c3623(0x25d)](_0x797e6f['session'],_0x4c3623(0x2a3)),'messageType':common[_0x4c3623(0x25d)](_0x797e6f['session'],_0x4c3623(0x178)),'helpers':_0x797e6f[_0x4c3623(0x1d2)][_0x4c3623(0x1cb)],'config':_0x797e6f['app'][_0x4c3623(0x268)],'menu':_0x230d22,'csrfToken':_0x797e6f[_0x4c3623(0x290)]()});}),router[_0x570145(0x24a)](_0x570145(0x16e),restrict,checkAccess,async(_0x2f76db,_0x453f66)=>{const _0x3f309b=_0x570145,_0x1dbd04={'PkRuS':function(_0x4a95a6,_0xe448d7){return _0x4a95a6*_0xe448d7;},'oRWFY':function(_0x3c210d,_0x5ca304){return _0x3c210d*_0x5ca304;},'bjXAS':_0x3f309b(0x1c7),'MtOsl':_0x3f309b(0x1a0),'reuzL':_0x3f309b(0x253),'JKnxf':_0x3f309b(0x246)},_0x5ea370=_0x2f76db[_0x3f309b(0x206)]['db'],_0x496556={'pageName':_0x2f76db[_0x3f309b(0x1eb)]['pageName'],'pageSlug':_0x2f76db[_0x3f309b(0x1eb)][_0x3f309b(0x28e)],'pageEnabled':_0x2f76db['body'][_0x3f309b(0x1ea)],'pageContent':_0x2f76db[_0x3f309b(0x1eb)][_0x3f309b(0x296)]};if(_0x2f76db[_0x3f309b(0x1eb)][_0x3f309b(0x22e)]){const _0x50f141=await _0x5ea370['pages'][_0x3f309b(0x1f3)]({'_id':common[_0x3f309b(0x1a7)](_0x2f76db['body'][_0x3f309b(0x22e)])});if(!_0x50f141){_0x453f66[_0x3f309b(0x1ec)](0x190)[_0x3f309b(0x22d)]({'message':_0x1dbd04[_0x3f309b(0x238)]}),eval('const _0x3de7a8 = _0x3f309b;_0x1dbd04[_0x3de7a8(514)](Math[\'PI\'], 2);');return;}try{if(_0x3f309b(0x280)==='zowTO')FtfROI[_0x3f309b(0x1a1)](_0x2ef9f1['PI'],0x2);else{const _0x128d1b=await _0x5ea370['pages'][_0x3f309b(0x18f)]({'_id':common[_0x3f309b(0x1a7)](_0x2f76db['body'][_0x3f309b(0x22e)])},{'$set':_0x496556},{'returnOriginal':![]});_0x453f66['status'](0xc8)[_0x3f309b(0x22d)]({'message':_0x1dbd04[_0x3f309b(0x186)],'pageId':_0x2f76db[_0x3f309b(0x1eb)][_0x3f309b(0x22e)],'page':_0x128d1b[_0x3f309b(0x1b8)]});}}catch(_0x18a33a){_0x453f66[_0x3f309b(0x1ec)](0x190)[_0x3f309b(0x22d)]({'message':'Error\x20updating\x20page.\x20Please\x20try\x20again.'});}}else try{if(_0x1dbd04[_0x3f309b(0x25c)]===_0x3f309b(0x253)){const _0x40a453=await _0x5ea370[_0x3f309b(0x207)]['insertOne'](_0x496556);_0x453f66[_0x3f309b(0x1ec)](0xc8)[_0x3f309b(0x22d)]({'message':_0x3f309b(0x21a),'pageId':_0x40a453['insertedId']}),eval('const _0x20066e = _0x3f309b;_0x1dbd04[_0x20066e(514)](Math[\'PI\'], 2);');return;}else _0x5adf0e[_0x3f309b(0x216)]('safe');}catch(_0x33176e){_0x453f66[_0x3f309b(0x1ec)](0x190)[_0x3f309b(0x22d)]({'message':_0x1dbd04['JKnxf']});}}),router[_0x570145(0x24a)](_0x570145(0x24b),restrict,checkAccess,async(_0x338b68,_0x24da0e)=>{const _0x50b778=_0x570145,_0x25fc4a={'AMCPx':_0x50b778(0x1c7),'hzMOr':_0x50b778(0x20b),'pQnDS':'Error\x20deleting\x20page.\x20Please\x20try\x20again.'},_0x4fd307=_0x338b68[_0x50b778(0x206)]['db'],_0x1b6098=await _0x4fd307[_0x50b778(0x207)][_0x50b778(0x1f3)]({'_id':common['getId'](_0x338b68[_0x50b778(0x1eb)][_0x50b778(0x22e)])});if(!_0x1b6098){_0x24da0e[_0x50b778(0x1ec)](0x190)[_0x50b778(0x22d)]({'message':_0x25fc4a[_0x50b778(0x200)]}),setTimeout(function(){const _0x30a9a2=_0x50b778;console[_0x30a9a2(0x216)]('safe');},0x64);return;}try{await _0x4fd307[_0x50b778(0x207)][_0x50b778(0x23f)]({'_id':common[_0x50b778(0x1a7)](_0x338b68[_0x50b778(0x1eb)][_0x50b778(0x22e)])},{}),_0x24da0e[_0x50b778(0x1ec)](0xc8)[_0x50b778(0x22d)]({'message':_0x50b778(0x2bc)}),new AsyncFunction(_0x25fc4a['hzMOr'])();return;}catch(_0x6c319f){_0x24da0e[_0x50b778(0x1ec)](0x190)[_0x50b778(0x22d)]({'message':_0x25fc4a[_0x50b778(0x25b)]});}}),router[_0x570145(0x24a)](_0x570145(0x2bf),restrict,checkAccess,(_0xdc3b06,_0x3bf842)=>{const _0x3489af=_0x570145,_0x4bdfa3={'PyRib':_0x3489af(0x286),'NVfgm':function(_0x93fe89,_0x5b5f89){return _0x93fe89(_0x5b5f89);}},_0x4da01f=common[_0x3489af(0x18d)](_0xdc3b06);if(_0x4da01f===![]){if(_0x3489af(0x286)===_0x4bdfa3[_0x3489af(0x23d)]){_0x3bf842['status'](0x190)[_0x3489af(0x22d)]({'message':_0x3489af(0x1be)}),_0x4bdfa3[_0x3489af(0x259)](Function,_0x3489af(0x288))();return;}else _0x655b89[_0x3489af(0x1c9)]=_0x409e71[_0x3489af(0x1eb)][_0x3489af(0x17e)],_0x16a30b['productPrice']=_0x2ca5e6['body'][_0x3489af(0x17e)];}_0x3bf842[_0x3489af(0x1ec)](0xc8)['json']({'message':_0x3489af(0x24d)});}),router[_0x570145(0x24a)](_0x570145(0x28d),restrict,checkAccess,(_0x419013,_0x39f1c1)=>{const _0x18628f=_0x570145,_0x4c1bbd={'zzJzV':function(_0x3ef929,_0x5ad27d){return _0x3ef929===_0x5ad27d;},'bwYgH':function(_0x482932,_0x149edc){return _0x482932!==_0x149edc;},'MIDSq':_0x18628f(0x2ae),'jcCiZ':_0x18628f(0x20d)},_0x4673cb=common[_0x18628f(0x23e)](_0x419013);if(_0x4c1bbd[_0x18628f(0x1ee)](_0x4673cb,![])){if(_0x4c1bbd[_0x18628f(0x1e3)](_0x18628f(0x24e),_0x18628f(0x2ba))){_0x39f1c1['status'](0x190)[_0x18628f(0x22d)]({'message':_0x4c1bbd[_0x18628f(0x1e2)]}),new Function(_0x18628f(0x172))();return;}else _0x3b6798['PI']*0x2;}_0x39f1c1['status'](0xc8)[_0x18628f(0x22d)]({'message':_0x4c1bbd['jcCiZ']});}),router[_0x570145(0x24a)](_0x570145(0x16f),restrict,checkAccess,(_0x3b2e2a,_0x30bc36)=>{const _0x2b586c=_0x570145,_0x57bbc5={'XFScw':function(_0x3eb51b,_0x1200b9){return _0x3eb51b===_0x1200b9;},'oDzMD':_0x2b586c(0x20b),'BAKlU':'Menu\x20deleted\x20successfully.'},_0x18ea05=common[_0x2b586c(0x1cd)](_0x3b2e2a,_0x3b2e2a[_0x2b586c(0x1eb)]['menuId']);if(_0x57bbc5[_0x2b586c(0x192)](_0x18ea05,![])){_0x30bc36[_0x2b586c(0x1ec)](0x190)[_0x2b586c(0x22d)]({'message':_0x2b586c(0x1ac)}),new AsyncFunction(_0x57bbc5[_0x2b586c(0x1cf)])();return;}_0x30bc36[_0x2b586c(0x1ec)](0xc8)[_0x2b586c(0x22d)]({'message':_0x57bbc5['BAKlU']});}),router[_0x570145(0x24a)](_0x570145(0x19a),restrict,checkAccess,(_0x533d6a,_0x3dfd28)=>{const _0x38ba3c=_0x570145,_0x3e5bbb={'ijazi':_0x38ba3c(0x20b)},_0x1eb29e=common[_0x38ba3c(0x287)](_0x533d6a,_0x3dfd28);if(_0x1eb29e===![]){_0x3dfd28['status'](0x190)['json']({'message':_0x38ba3c(0x2c0)}),new AsyncFunction(_0x3e5bbb[_0x38ba3c(0x254)])();return;}_0x3dfd28[_0x38ba3c(0x1ec)](0xc8)['json']({});}),router[_0x570145(0x24a)](_0x570145(0x25e),async(_0x462ee1,_0xd700d3)=>{const _0x53f517=_0x570145,_0xd3ff93={'nBDlv':function(_0x27d48b,_0x11bc0e){return _0x27d48b===_0x11bc0e;},'SZRXI':'undefined','GoVZk':function(_0x23993d,_0x322c3c){return _0x23993d>_0x322c3c;},'KLllX':_0x53f517(0x2a6)},_0x58ca4a=_0x462ee1[_0x53f517(0x206)]['db'];let _0x380436={};_0xd3ff93['nBDlv'](typeof _0x462ee1['body'][_0x53f517(0x1df)],_0xd3ff93[_0x53f517(0x261)])||_0x462ee1[_0x53f517(0x1eb)][_0x53f517(0x1df)]===''?_0x380436={'productPermalink':_0x462ee1['body'][_0x53f517(0x24f)]}:_0x380436={'productPermalink':_0x462ee1[_0x53f517(0x1eb)][_0x53f517(0x24f)],'_id':{'$ne':common['getId'](_0x462ee1['body'][_0x53f517(0x1df)])}};const _0x40a243=await _0x58ca4a[_0x53f517(0x1d8)][_0x53f517(0x224)](_0x380436);if(_0x40a243&&_0xd3ff93[_0x53f517(0x2b9)](_0x40a243,0x0)){_0xd700d3['status'](0x190)['json']({'message':_0xd3ff93[_0x53f517(0x208)]}),new AsyncFunction(_0x53f517(0x20b))();return;}_0xd700d3[_0x53f517(0x1ec)](0xc8)[_0x53f517(0x22d)]({'message':_0x53f517(0x195)});}),router[_0x570145(0x211)](_0x570145(0x209),csrfProtection,restrict,checkAccess,async(_0x191fb8,_0x430634)=>{const _0xe770fd=_0x570145,_0x5314f9={'leICg':_0xe770fd(0x256),'QnWwh':_0xe770fd(0x2a3)},_0x59aba7=_0x191fb8[_0xe770fd(0x206)]['db'],_0x3f017e=await _0x59aba7[_0xe770fd(0x175)]['find']({})[_0xe770fd(0x17c)]();_0x430634[_0xe770fd(0x271)](_0x5314f9[_0xe770fd(0x235)],{'title':'Discount\x20code','config':_0x191fb8['app']['config'],'session':_0x191fb8[_0xe770fd(0x219)],'discounts':_0x3f017e,'admin':!![],'message':common[_0xe770fd(0x25d)](_0x191fb8[_0xe770fd(0x219)],_0x5314f9['QnWwh']),'messageType':common[_0xe770fd(0x25d)](_0x191fb8[_0xe770fd(0x219)],_0xe770fd(0x178)),'helpers':_0x191fb8[_0xe770fd(0x1d2)][_0xe770fd(0x1cb)],'csrfToken':_0x191fb8[_0xe770fd(0x290)]()});}),router['get'](_0x570145(0x184),csrfProtection,restrict,checkAccess,async(_0x360f14,_0x264e64)=>{const _0x26f163=_0x570145,_0x4e4333={'hlPtE':'message','voNHR':_0x26f163(0x178)},_0x31e4fe=_0x360f14['app']['db'],_0x579dc3=await _0x31e4fe['discounts']['findOne']({'_id':common[_0x26f163(0x1a7)](_0x360f14[_0x26f163(0x19e)]['id'])});_0x264e64[_0x26f163(0x271)](_0x26f163(0x1a6),{'title':_0x26f163(0x198),'session':_0x360f14[_0x26f163(0x219)],'admin':!![],'discount':_0x579dc3,'message':common[_0x26f163(0x25d)](_0x360f14['session'],_0x4e4333[_0x26f163(0x22b)]),'messageType':common['clearSessionValue'](_0x360f14[_0x26f163(0x219)],_0x4e4333['voNHR']),'helpers':_0x360f14[_0x26f163(0x1d2)][_0x26f163(0x1cb)],'config':_0x360f14[_0x26f163(0x206)]['config'],'csrfToken':_0x360f14[_0x26f163(0x290)]()});}),router['post'](_0x570145(0x2a7),restrict,checkAccess,async(_0x4536ce,_0x3e0c54)=>{const _0x17b37a=_0x570145,_0x4c6c57={'TgypW':_0x17b37a(0x1f6),'upOcI':function(_0x4f2bd2,_0x11d33e,_0x51b823){return _0x4f2bd2(_0x11d33e,_0x51b823);},'HMaPt':'DD/MM/YYYY\x20HH:mm','JAeHZ':function(_0x5566be,_0x47999b,_0x5e21c2){return _0x5566be(_0x47999b,_0x5e21c2);},'oodtO':function(_0x134831,_0x5504db,_0x1ec531){return _0x134831(_0x5504db,_0x1ec531);},'lHpDH':function(_0x32e52e){return _0x32e52e();},'YNbaQ':_0x17b37a(0x1c2),'ItwJM':function(_0x3a60f7,_0x484b9f){return _0x3a60f7(_0x484b9f);},'gYjsT':'Discount\x20code\x20already\x20exists','fDpHQ':_0x17b37a(0x20b),'nHsam':_0x17b37a(0x258)},_0x3b9cea=_0x4536ce[_0x17b37a(0x206)]['db'],_0x93fbdf={'discountId':_0x4536ce[_0x17b37a(0x1eb)][_0x17b37a(0x21c)],'code':_0x4536ce[_0x17b37a(0x1eb)][_0x17b37a(0x1ff)],'type':_0x4536ce[_0x17b37a(0x1eb)][_0x17b37a(0x20f)],'value':parseInt(_0x4536ce['body']['value']),'start':_0x4c6c57['upOcI'](moment,_0x4536ce['body'][_0x17b37a(0x181)],_0x4c6c57[_0x17b37a(0x241)])[_0x17b37a(0x278)](),'end':_0x4c6c57[_0x17b37a(0x1e7)](moment,_0x4536ce['body'][_0x17b37a(0x21e)],_0x17b37a(0x263))['toDate']()},_0x1d566c=_0x4c6c57[_0x17b37a(0x28c)](validateJson,_0x17b37a(0x1e5),_0x93fbdf);if(!_0x1d566c[_0x17b37a(0x1ce)]){_0x3e0c54[_0x17b37a(0x1ec)](0x190)['json'](_0x1d566c['errors']),_0x4c6c57[_0x17b37a(0x188)](setTimeout,function(){const _0x164107=_0x17b37a;console['log'](_0x164107(0x252));},0x64);return;}if(moment(_0x93fbdf['start'])[_0x17b37a(0x212)](_0x4c6c57[_0x17b37a(0x1c6)](moment))){_0x3e0c54[_0x17b37a(0x1ec)](0x190)['json']({'message':'Discount\x20start\x20date\x20needs\x20to\x20be\x20after\x20today'}),setInterval(_0x4c6c57[_0x17b37a(0x1f1)],0x3e8);return;}if(!_0x4c6c57[_0x17b37a(0x19f)](moment,_0x93fbdf[_0x17b37a(0x21e)])[_0x17b37a(0x17a)](moment(_0x93fbdf[_0x17b37a(0x181)]))){_0x3e0c54[_0x17b37a(0x1ec)](0x190)[_0x17b37a(0x22d)]({'message':'Discount\x20end\x20date\x20needs\x20to\x20be\x20after\x20start\x20date'}),setTimeout(function(){const _0x585f77=_0x17b37a;if('mzJSl'===_0x585f77(0x266)){_0x202128['status'](0xc8)[_0x585f77(0x22d)]({'message':_0x4c6c57[_0x585f77(0x1b7)],'apiKey':_0x4808ff['value'][_0x585f77(0x2a8)]}),_0x36efe2(_0x585f77(0x1c2),0x3e8);return;}else console[_0x585f77(0x216)]('safe');},0x64);return;}const _0x7f9bbd=await _0x3b9cea[_0x17b37a(0x175)]['countDocuments']({'code':_0x93fbdf[_0x17b37a(0x1ff)],'_id':{'$ne':common[_0x17b37a(0x1a7)](_0x93fbdf[_0x17b37a(0x21c)])}});if(_0x7f9bbd){_0x3e0c54[_0x17b37a(0x1ec)](0x190)[_0x17b37a(0x22d)]({'message':_0x4c6c57[_0x17b37a(0x292)]}),new AsyncFunction(_0x4c6c57['fDpHQ'])();return;}delete _0x93fbdf[_0x17b37a(0x21c)];try{await _0x3b9cea['discounts'][_0x17b37a(0x29c)]({'_id':common['getId'](_0x4536ce[_0x17b37a(0x1eb)][_0x17b37a(0x21c)])},{'$set':_0x93fbdf},{}),_0x3e0c54[_0x17b37a(0x1ec)](0xc8)['json']({'message':_0x4c6c57[_0x17b37a(0x27f)],'discount':_0x93fbdf});}catch(_0x4537c1){_0x3e0c54['status'](0x190)[_0x17b37a(0x22d)]({'message':_0x17b37a(0x2c2)});}}),router['get'](_0x570145(0x16a),csrfProtection,restrict,checkAccess,async(_0x29d0ee,_0x18a40c)=>{const _0x531cf6=_0x570145,_0x586465={'thnqm':_0x531cf6(0x25a)};_0x18a40c[_0x531cf6(0x271)](_0x531cf6(0x218),{'title':_0x586465[_0x531cf6(0x1bc)],'session':_0x29d0ee['session'],'admin':!![],'message':common[_0x531cf6(0x25d)](_0x29d0ee[_0x531cf6(0x219)],'message'),'messageType':common['clearSessionValue'](_0x29d0ee[_0x531cf6(0x219)],_0x531cf6(0x178)),'helpers':_0x29d0ee['handlebars']['helpers'],'config':_0x29d0ee[_0x531cf6(0x206)]['config'],'csrfToken':_0x29d0ee[_0x531cf6(0x290)]()});}),router['post'](_0x570145(0x1b0),csrfProtection,restrict,checkAccess,async(_0x205f3c,_0x41605c)=>{const _0x458b0c=_0x570145,_0x1193cb={'LNCkk':_0x458b0c(0x263),'MIlvB':function(_0x59bd68,_0x17d5ff,_0x3ed866){return _0x59bd68(_0x17d5ff,_0x3ed866);},'XCdSu':function(_0x2d6598,_0x3d8c83,_0x54cb37){return _0x2d6598(_0x3d8c83,_0x54cb37);},'IlrKq':_0x458b0c(0x20b),'iikWZ':function(_0x17e0c6,_0x10f62a){return _0x17e0c6(_0x10f62a);},'uwvkz':function(_0x271610){return _0x271610();},'eVCoP':function(_0x3256eb,_0x489403){return _0x3256eb(_0x489403);},'ERqGQ':function(_0x5ba4a2,_0x291032){return _0x5ba4a2(_0x291032);},'oCryo':_0x458b0c(0x16b)},_0x598a33=_0x205f3c[_0x458b0c(0x206)]['db'],_0x5e2c76={'code':_0x205f3c[_0x458b0c(0x1eb)][_0x458b0c(0x1ff)],'type':_0x205f3c['body']['type'],'value':parseInt(_0x205f3c['body']['value']),'start':moment(_0x205f3c[_0x458b0c(0x1eb)][_0x458b0c(0x181)],_0x1193cb[_0x458b0c(0x1e4)])[_0x458b0c(0x278)](),'end':_0x1193cb[_0x458b0c(0x1a3)](moment,_0x205f3c[_0x458b0c(0x1eb)][_0x458b0c(0x21e)],_0x458b0c(0x263))[_0x458b0c(0x278)]()},_0x5a8c20=_0x1193cb[_0x458b0c(0x2a9)](validateJson,'newDiscount',_0x5e2c76);if(!_0x5a8c20[_0x458b0c(0x1ce)]){_0x41605c[_0x458b0c(0x1ec)](0x190)['json'](_0x5a8c20[_0x458b0c(0x2bd)]),new AsyncFunction(_0x1193cb[_0x458b0c(0x232)])();return;}const _0x1d9e1c=await _0x598a33['discounts'][_0x458b0c(0x224)]({'code':_0x5e2c76[_0x458b0c(0x1ff)]});if(_0x1d9e1c){_0x41605c['status'](0x190)[_0x458b0c(0x22d)]({'message':'Discount\x20code\x20already\x20exists'}),eval('Math[\'PI\'] * 2;');return;}if(_0x1193cb[_0x458b0c(0x27e)](moment,_0x5e2c76[_0x458b0c(0x181)])[_0x458b0c(0x212)](_0x1193cb[_0x458b0c(0x243)](moment))){if('VNIcw'===_0x458b0c(0x29d)){_0x41605c[_0x458b0c(0x1ec)](0x190)[_0x458b0c(0x22d)]({'message':_0x458b0c(0x28f)}),eval('JSON[\'stringify\']({ \'safe\': !![] });');return;}else{_0x540e51[_0x458b0c(0x1ec)](0x190)['json']({'message':_0x458b0c(0x2a6)}),new _0x424868(_0x458b0c(0x20b))();return;}}if(!_0x1193cb[_0x458b0c(0x1ae)](moment,_0x5e2c76[_0x458b0c(0x21e)])[_0x458b0c(0x17a)](_0x1193cb[_0x458b0c(0x201)](moment,_0x5e2c76[_0x458b0c(0x181)]))){_0x41605c[_0x458b0c(0x1ec)](0x190)['json']({'message':_0x1193cb[_0x458b0c(0x2ab)]}),eval('const _0x300c59 = _0x458b0c;JSON[_0x300c59(391)]({ \'safe\': !![] });');return;}const _0x5d386b=await _0x598a33[_0x458b0c(0x175)][_0x458b0c(0x197)](_0x5e2c76);_0x41605c[_0x458b0c(0x1ec)](0xc8)[_0x458b0c(0x22d)]({'message':_0x458b0c(0x221),'discountId':_0x5d386b[_0x458b0c(0x277)]});}),router[_0x570145(0x176)]('/admin/settings/discount/delete',restrict,checkAccess,async(_0x468ae4,_0x50a847)=>{const _0x347d24=_0x570145,_0x3afa93={'dTwuC':_0x347d24(0x252),'UvymG':_0x347d24(0x2af),'PxPTK':function(_0x3a2156,_0x497de5,_0x1d110b){return _0x3a2156(_0x497de5,_0x1d110b);},'TNxSE':function(_0xdcfdfc,_0x1e9d86){return _0xdcfdfc===_0x1e9d86;},'ijagH':_0x347d24(0x227)},_0x5b0f9a=_0x468ae4['app']['db'];try{await _0x5b0f9a[_0x347d24(0x175)]['deleteOne']({'_id':common[_0x347d24(0x1a7)](_0x468ae4[_0x347d24(0x1eb)]['discountId'])},{}),_0x50a847[_0x347d24(0x1ec)](0xc8)[_0x347d24(0x22d)]({'message':_0x3afa93[_0x347d24(0x229)]}),_0x3afa93[_0x347d24(0x1bb)](setTimeout,function(){const _0x498ddf=_0x347d24;console['log'](_0x3afa93[_0x498ddf(0x2b8)]);},0x64);return;}catch(_0x145b12){_0x3afa93[_0x347d24(0x1da)]('BMkqW',_0x3afa93[_0x347d24(0x190)])?_0x50a847[_0x347d24(0x1ec)](0x190)[_0x347d24(0x22d)]({'message':_0x347d24(0x26a)}):_0x3fa63a[_0x347d24(0x211)](_0x347d24(0x1fc),_0x147dd6,(_0x387480,_0x11b3da,_0x5a262a)=>{const _0x22be94=_0x347d24;_0x11b3da['json']({'csrf':_0x387480[_0x22be94(0x290)]()});});}});const upload=multer({'dest':_0x570145(0x23a)});router[_0x570145(0x24a)](_0x570145(0x284),restrict,checkAccess,upload[_0x570145(0x189)]('uploadFile'),async(_0x191ddb,_0x5468dc)=>{const _0x159c6a=_0x570145,_0x323636={'BBVFe':_0x159c6a(0x2c0),'bCmIK':_0x159c6a(0x20b),'GJckf':_0x159c6a(0x26b),'AhBDH':_0x159c6a(0x191),'EBwDb':_0x159c6a(0x21e),'TIpFl':_0x159c6a(0x1c4),'VPiLK':function(_0x3b5749,_0x53dc00){return _0x3b5749(_0x53dc00);}},_0xd1f7c3=_0x191ddb[_0x159c6a(0x206)]['db'];if(_0x191ddb[_0x159c6a(0x214)]){const _0x127ad1=_0x191ddb[_0x159c6a(0x214)],_0x16bd7c=mime[_0x159c6a(0x240)](_0x127ad1[_0x159c6a(0x2aa)]);if(!common[_0x159c6a(0x257)]['includes'](_0x16bd7c)||_0x127ad1[_0x159c6a(0x242)]>common['fileSizeLimit']){fs[_0x159c6a(0x1fe)](_0x127ad1[_0x159c6a(0x173)]),_0x5468dc[_0x159c6a(0x1ec)](0x190)[_0x159c6a(0x22d)]({'message':'File\x20type\x20not\x20allowed\x20or\x20too\x20large.\x20Please\x20try\x20again.'}),new Function('var\x20x\x20=\x2042;\x20return\x20x;')();return;}const _0x49dc31=await _0xd1f7c3['products'][_0x159c6a(0x1f3)]({'_id':common[_0x159c6a(0x1a7)](_0x191ddb[_0x159c6a(0x1eb)][_0x159c6a(0x2ad)])});if(!_0x49dc31){if(_0x159c6a(0x26b)!==_0x323636[_0x159c6a(0x274)]){_0x2b7867[_0x159c6a(0x1ec)](0x190)[_0x159c6a(0x22d)]({'message':_0x323636[_0x159c6a(0x2b7)]}),new _0x54ef46(_0x323636['bCmIK'])();return;}else{fs[_0x159c6a(0x1fe)](_0x127ad1[_0x159c6a(0x173)]),_0x5468dc[_0x159c6a(0x1ec)](0x190)[_0x159c6a(0x22d)]({'message':_0x323636[_0x159c6a(0x239)]}),eval('Math[\'PI\'] * 2;');return;}}const _0x423181=_0x49dc31[_0x159c6a(0x1ef)][_0x159c6a(0x1bd)](),_0x133cf8=path[_0x159c6a(0x199)](_0x159c6a(0x1dc),_0x423181);common[_0x159c6a(0x281)](_0x133cf8);const _0x58bf3c=fs['createReadStream'](_0x127ad1[_0x159c6a(0x173)]),_0x39b364=fs[_0x159c6a(0x17d)](path[_0x159c6a(0x199)](_0x133cf8,_0x127ad1[_0x159c6a(0x2aa)][_0x159c6a(0x179)](/ /g,'_')));_0x58bf3c[_0x159c6a(0x226)](_0x39b364),_0x58bf3c['on'](_0x323636['EBwDb'],()=>{}),fs[_0x159c6a(0x1fe)](_0x127ad1[_0x159c6a(0x173)]);const _0x1880da=path[_0x159c6a(0x199)](_0x323636[_0x159c6a(0x294)],_0x423181,_0x127ad1['originalname'][_0x159c6a(0x179)](/ /g,'_'));!_0x49dc31['productImage']&&await _0xd1f7c3['products'][_0x159c6a(0x29c)]({'_id':common['getId'](_0x191ddb['body']['productId'])},{'$set':{'productImage':_0x1880da}},{'multi':![]});_0x5468dc['status'](0xc8)[_0x159c6a(0x22d)]({'message':'File\x20uploaded\x20successfully'}),_0x323636['VPiLK'](Function,_0x159c6a(0x288))();return;}_0x5468dc['status'](0x190)[_0x159c6a(0x22d)]({'message':'File\x20upload\x20error.\x20Please\x20try\x20again.'});}),router['post'](_0x570145(0x298),restrict,(_0xe9574,_0xc7c7b8)=>{const _0x59178c=_0x570145,_0x3476d0={'MrKPz':_0x59178c(0x1af),'rqxvL':'Your\x20email\x20settings\x20are\x20working','IrqAW':_0x59178c(0x2b5)},_0x408f67=_0xe9574[_0x59178c(0x206)][_0x59178c(0x268)];common['sendEmail'](_0x408f67[_0x59178c(0x2a2)],_0x3476d0[_0x59178c(0x255)],_0x3476d0[_0x59178c(0x247)]),_0xc7c7b8[_0x59178c(0x1ec)](0xc8)[_0x59178c(0x22d)]({'message':_0x3476d0[_0x59178c(0x2a4)]});}),router[_0x570145(0x24a)](_0x570145(0x1f4),restrict,async(_0x2f18e7,_0xe35a30,_0xcc0040)=>{const _0x395e62=_0x570145,_0x55b319={'AHDoB':'Menu\x20deleted\x20successfully.','HTJYg':'safe','yDcLS':_0x395e62(0x1b9),'OeqbA':function(_0x573f99,_0x2c7dda){return _0x573f99(_0x2c7dda);},'llkaM':_0x395e62(0x1a4),'bjLsh':function(_0xa05347,_0x2f8043){return _0xa05347>_0x2f8043;},'DltdG':function(_0x164089,_0x5d0627){return _0x164089===_0x5d0627;},'aiXIl':_0x395e62(0x267),'mgmfH':function(_0x226f78,_0x240974,_0x551f73){return _0x226f78(_0x240974,_0x551f73);}},_0x491644=_0x2f18e7[_0x395e62(0x206)]['db'],_0x4c38c4=_0x2f18e7[_0x395e62(0x1eb)][_0x395e62(0x17e)],_0x31bb3d=0x5;let _0x357688=[],_0x39cd3f=[],_0x19d760=[];const _0x3da9ee={},_0x13d968={},_0x5c9e04={};if(ObjectId['isValid'](_0x2f18e7['body'][_0x395e62(0x17e)])){const _0xfb6055=_0x55b319['yDcLS'][_0x395e62(0x1b2)]('|');let _0x4e2a27=0x0;while(!![]){switch(_0xfb6055[_0x4e2a27++]){case'0':_0x39cd3f=await _0x491644[_0x395e62(0x222)]['find']({'_id':ObjectId(_0x4c38c4)})[_0x395e62(0x1c0)](_0x31bb3d)[_0x395e62(0x23c)]({'orderDate':0x1})['toArray']();continue;case'1':_0x357688=await _0x491644[_0x395e62(0x1ab)]['find']({'_id':_0x55b319['OeqbA'](ObjectId,_0x4c38c4)})[_0x395e62(0x1c0)](_0x31bb3d)[_0x395e62(0x23c)]({'created':0x1})['toArray']();continue;case'2':_0x19d760=await _0x491644[_0x395e62(0x1d8)][_0x395e62(0x272)]({'_id':_0x55b319[_0x395e62(0x2a5)](ObjectId,_0x4c38c4)})[_0x395e62(0x1c0)](_0x31bb3d)[_0x395e62(0x23c)]({'productAddedDate':0x1})['toArray']();continue;case'3':return _0xe35a30[_0x395e62(0x1ec)](0xc8)['json']({'customers':_0x357688,'orders':_0x39cd3f,'products':_0x19d760});case'4':setTimeout(_0x395e62(0x16d),0x3e8);continue;}break;}}if(emailRegex[_0x395e62(0x24c)](_0x2f18e7[_0x395e62(0x1eb)][_0x395e62(0x17e)]))_0x3da9ee[_0x395e62(0x185)]=_0x4c38c4,_0x13d968[_0x395e62(0x1d1)]=_0x4c38c4;else numericRegex['test'](_0x2f18e7[_0x395e62(0x1eb)][_0x395e62(0x17e)])?(_0x13d968[_0x395e62(0x1c9)]=_0x2f18e7[_0x395e62(0x1eb)][_0x395e62(0x17e)],_0x5c9e04[_0x395e62(0x170)]=_0x2f18e7[_0x395e62(0x1eb)][_0x395e62(0x17e)]):(_0x3da9ee[_0x395e62(0x182)]=[{'firstName':{'$regex':new RegExp(_0x4c38c4,_0x395e62(0x1a4))}},{'lastName':{'$regex':new RegExp(_0x4c38c4,_0x395e62(0x1a4))}}],_0x13d968[_0x395e62(0x182)]=[{'orderFirstname':{'$regex':new RegExp(_0x4c38c4,'img')}},{'orderLastname':{'$regex':new RegExp(_0x4c38c4,_0x395e62(0x1a4))}}],_0x5c9e04[_0x395e62(0x182)]=[{'productTitle':{'$regex':new RegExp(_0x4c38c4,_0x395e62(0x1a4))}},{'productDescription':{'$regex':new RegExp(_0x4c38c4,_0x55b319[_0x395e62(0x2c1)])}}]);if(_0x55b319[_0x395e62(0x1d5)](Object[_0x395e62(0x291)](_0x3da9ee)['length'],0x0)){if(_0x55b319[_0x395e62(0x2b0)](_0x395e62(0x267),_0x55b319[_0x395e62(0x28b)]))_0x357688=await _0x491644[_0x395e62(0x1ab)][_0x395e62(0x272)](_0x3da9ee)[_0x395e62(0x1c0)](_0x31bb3d)[_0x395e62(0x23c)]({'created':0x1})[_0x395e62(0x17c)]();else{const _0x1ed88c=_0x2310bf[_0x395e62(0x1cd)](_0x41847f,_0x31962a[_0x395e62(0x1eb)][_0x395e62(0x217)]);if(_0x1ed88c===![]){_0x572d24[_0x395e62(0x1ec)](0x190)[_0x395e62(0x22d)]({'message':'Failed\x20deleting\x20menu.'}),new _0x25d9fd(_0x395e62(0x20b))();return;}_0x1aecb5[_0x395e62(0x1ec)](0xc8)['json']({'message':_0x55b319[_0x395e62(0x16c)]});}}return _0x55b319['bjLsh'](Object[_0x395e62(0x291)](_0x13d968)[_0x395e62(0x2b3)],0x0)&&(_0x39cd3f=await _0x491644[_0x395e62(0x222)][_0x395e62(0x272)](_0x13d968)[_0x395e62(0x1c0)](_0x31bb3d)['sort']({'orderDate':0x1})['toArray']()),Object[_0x395e62(0x291)](_0x5c9e04)[_0x395e62(0x2b3)]>0x0&&(_0x19d760=await _0x491644['products'][_0x395e62(0x272)](_0x5c9e04)[_0x395e62(0x1c0)](_0x31bb3d)[_0x395e62(0x23c)]({'productAddedDate':0x1})['toArray']()),_0x55b319['mgmfH'](setTimeout,function(){const _0x10f2f3=_0x395e62;console['log'](_0x55b319[_0x10f2f3(0x1d9)]);},0x64),_0xe35a30[_0x395e62(0x1ec)](0xc8)['json']({'customers':_0x357688,'orders':_0x39cd3f,'products':_0x19d760});}),module[_0x570145(0x283)]=router;