function _0x1bc4(_0x3fd6ed,_0x3cc7c4){const _0x535f8f=_0x535f();return _0x1bc4=function(_0x1bc4f2,_0x435ef2){_0x1bc4f2=_0x1bc4f2-0x149;let _0x90c19=_0x535f8f[_0x1bc4f2];return _0x90c19;},_0x1bc4(_0x3fd6ed,_0x3cc7c4);}const _0x8b5fe7=_0x1bc4;function _0x535f(){const _0x5ba74a=['TIUnx','should\x20not\x20return\x20references\x20if\x20the\x20document\x20is\x20not\x20validly\x20signed','nodeValue','92WQnFKq','785207pbxRNi','187737dwEOpv','NYohx','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','./test/static/feide_public.pem','getCertFromKeyInfo','QZlWA','SgEVc','ZjaIV','utf-8','equal','true','test\x20with\x20a\x20document\x20(using\x20FileKeyInfo)','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20found','2962269nSuXms','1524019JLuWZx','toString','ulgRF','IrtyY','adrJS','Document\x20tests','zphnH','henri.bergius@nemein.com','./test/static/valid_saml.xml','Validated\x20node\x20references\x20tests','assertIsNodeLike','Pokjy','loadSignature','SXQod','18805hhFBeU','PMiui','DOMParser','readFileSync','./test/static/invalid_signature\x20-\x20changed\x20content.xml','btJQT','2zGhgpf','//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','findSignatures','opyyj','stringify','null','79239qPzKQl','lHPqm','10XMJAOs','396bBCEhc','getValidatedNode','1086fCJzou','8DRDcAy','qSOQc','var\x20x\x20=\x2042;\x20return\x20x;','return\x20new\x20Date();','fmDNG','parseFromString','11733436RUcgrg','false','wuMnJ','test\x20with\x20a\x20document\x20(using\x20StringKeyInfo)','bnDdd','select1','dOLtH','checkSignature','should\x20return\x20`null`\x20if\x20the\x20selected\x20node\x20isn\x27t\x20validly\x20signed','faiaM','lHEWf','should\x20return\x20references\x20if\x20the\x20document\x20is\x20validly\x20signed','publicCert','BXejy','getReferences'];_0x535f=function(){return _0x5ba74a;};return _0x535f();}(function(_0x10bf7d,_0x1307cf){const _0x4d5120=_0x1bc4,_0x24330a=_0x10bf7d();while(!![]){try{const _0x691def=-parseInt(_0x4d5120(0x15a))/0x1*(-parseInt(_0x4d5120(0x17d))/0x2)+parseInt(_0x4d5120(0x183))/0x3*(parseInt(_0x4d5120(0x159))/0x4)+-parseInt(_0x4d5120(0x177))/0x5*(parseInt(_0x4d5120(0x188))/0x6)+-parseInt(_0x4d5120(0x169))/0x7*(parseInt(_0x4d5120(0x189))/0x8)+parseInt(_0x4d5120(0x168))/0x9*(parseInt(_0x4d5120(0x185))/0xa)+parseInt(_0x4d5120(0x15b))/0xb*(parseInt(_0x4d5120(0x186))/0xc)+-parseInt(_0x4d5120(0x18f))/0xd;if(_0x691def===_0x1307cf)break;else _0x24330a['push'](_0x24330a['shift']());}catch(_0x251958){_0x24330a['push'](_0x24330a['shift']());}}}(_0x535f,0x762bc));import{SignedXml}from'../src/index';import*as _0xa35f2f from'xpath';import*as _0x4480ff from'@xmldom/xmldom';import*as _0x2c6400 from'fs';import{expect}from'chai';import*as _0x4ef223 from'@xmldom/is-dom-node';describe(_0x8b5fe7(0x16e),function(){const _0x1f97d3=_0x8b5fe7,_0x4ff15e={'owVUW':_0x1f97d3(0x171),'QYMIk':_0x1f97d3(0x15d),'lHEWf':'./test/static/feide_public.pem','btJQT':function(_0x40dc88,_0x2d06da){return _0x40dc88!==_0x2d06da;},'ulgRF':'HasPQ','PMiui':'utf-8','ZjaIV':function(_0x4a05c2,_0x5203ad,_0x1d13b3){return _0x4a05c2(_0x5203ad,_0x1d13b3);}};_0x4ff15e[_0x1f97d3(0x162)](it,_0x1f97d3(0x166),function(){const _0x5f2afc=_0x1f97d3,_0x495ba4=_0x2c6400[_0x5f2afc(0x17a)](_0x4ff15e['owVUW'],'utf-8'),_0x53fbb0=new _0x4480ff[(_0x5f2afc(0x179))]()[_0x5f2afc(0x18e)](_0x495ba4),_0x10056a=_0xa35f2f['select1'](_0x4ff15e['QYMIk'],_0x53fbb0);_0x4ef223[_0x5f2afc(0x173)](_0x10056a);const _0x57f532=new SignedXml();_0x57f532[_0x5f2afc(0x153)]=_0x2c6400[_0x5f2afc(0x17a)](_0x4ff15e['lHEWf']),_0x57f532['loadSignature'](_0x10056a);const _0x1bf146=_0x57f532[_0x5f2afc(0x14e)](_0x495ba4);expect(_0x1bf146)['to']['be'][_0x5f2afc(0x165)];}),_0x4ff15e[_0x1f97d3(0x162)](it,_0x1f97d3(0x14a),function(){const _0x36daa1=_0x1f97d3,_0x511e05={'QZlWA':_0x36daa1(0x171),'TIUnx':_0x36daa1(0x163),'IrtyY':_0x36daa1(0x15e)};if(_0x4ff15e[_0x36daa1(0x17c)](_0x36daa1(0x161),_0x4ff15e[_0x36daa1(0x16b)])){const _0x56c252=_0x2c6400[_0x36daa1(0x17a)](_0x36daa1(0x171),_0x4ff15e[_0x36daa1(0x178)]),_0xee8379=new _0x4480ff[(_0x36daa1(0x179))]()[_0x36daa1(0x18e)](_0x56c252),_0x1a5fda=_0xa35f2f['select1'](_0x36daa1(0x15d),_0xee8379);_0x4ef223['assertIsNodeLike'](_0x1a5fda);const _0x365922=new SignedXml(),_0x1110e4=_0x2c6400[_0x36daa1(0x17a)](_0x4ff15e[_0x36daa1(0x151)]);_0x365922[_0x36daa1(0x153)]=_0x1110e4,_0x365922[_0x36daa1(0x175)](_0x1a5fda);const _0x124c98=_0x365922[_0x36daa1(0x14e)](_0x56c252);expect(_0x124c98)['to']['be'][_0x36daa1(0x165)];}else{const _0x4e567b=_0x4f00e4[_0x36daa1(0x17a)](_0x511e05[_0x36daa1(0x160)],_0x511e05[_0x36daa1(0x156)]),_0x199f34=new _0x2c5b64[(_0x36daa1(0x179))]()[_0x36daa1(0x18e)](_0x4e567b),_0x2ee943=_0x40f799[_0x36daa1(0x14c)](_0x36daa1(0x15d),_0x199f34);_0x4f39a2['assertIsNodeLike'](_0x2ee943);const _0x5429b7=new _0x4107db(),_0x533741=_0x404fb2[_0x36daa1(0x17a)](_0x511e05[_0x36daa1(0x16c)]);_0x5429b7[_0x36daa1(0x153)]=_0x533741,_0x5429b7[_0x36daa1(0x175)](_0x2ee943);const _0x2f7797=_0x5429b7[_0x36daa1(0x14e)](_0x4e567b);_0x15d2a5(_0x2f7797)['to']['be'][_0x36daa1(0x165)];}});}),describe(_0x8b5fe7(0x172),function(){const _0x43d1c8=_0x8b5fe7,_0x44aee5={'lHPqm':_0x43d1c8(0x171),'BXejy':_0x43d1c8(0x17b),'qSOQc':_0x43d1c8(0x163),'wuMnJ':function(_0x37bb2e,_0x4dea1c){return _0x37bb2e(_0x4dea1c);},'xOtEe':function(_0x41c6c2,_0x2d8025){return _0x41c6c2(_0x2d8025);},'fmDNG':_0x43d1c8(0x170),'QjZqS':function(_0x165ac0,_0x41ccbc){return _0x165ac0(_0x41ccbc);},'adrJS':'//*[local-name()=\x27Attribute\x27\x20and\x20@Name=\x27mail\x27]/*[local-name()=\x27AttributeValue\x27]/text()','dOLtH':_0x43d1c8(0x152),'Pokjy':_0x43d1c8(0x157),'zphnH':_0x43d1c8(0x18c),'faiaM':function(_0x53ef16,_0x1a4b76,_0x4ba242){return _0x53ef16(_0x1a4b76,_0x4ba242);},'SXQod':_0x43d1c8(0x167),'bnDdd':function(_0x1f455f,_0x538ec4,_0x58f1e6){return _0x1f455f(_0x538ec4,_0x58f1e6);},'opyyj':function(_0x5de4d1,_0x1577e3,_0x52f017){return _0x5de4d1(_0x1577e3,_0x52f017);},'NYohx':_0x43d1c8(0x14f)};eval('Math[\'PI\'] * 2;'),it(_0x44aee5[_0x43d1c8(0x14d)],function(){const _0x5e5b59=_0x43d1c8,_0x5beb61=_0x2c6400[_0x5e5b59(0x17a)](_0x44aee5['lHPqm'],_0x5e5b59(0x163)),_0x380adc=new _0x4480ff[(_0x5e5b59(0x179))]()[_0x5e5b59(0x18e)](_0x5beb61),_0x1cf048=new SignedXml();_0x1cf048[_0x5e5b59(0x15f)]=SignedXml[_0x5e5b59(0x15f)],_0x1cf048[_0x5e5b59(0x175)](_0x1cf048[_0x5e5b59(0x17f)](_0x380adc)[0x0]);const _0x7a4621=_0x1cf048[_0x5e5b59(0x14e)](_0x5beb61);expect(_0x7a4621)['to']['be'][_0x5e5b59(0x165)];const _0x242dc4=_0x1cf048[_0x5e5b59(0x155)]()[0x0],_0x3d41bf=_0x242dc4[_0x5e5b59(0x187)]();expect(_0x3d41bf?.[_0x5e5b59(0x16a)]())['to'][_0x5e5b59(0x164)](_0x380adc[_0x5e5b59(0x16a)]());}),eval('1 + 1;'),it(_0x44aee5[_0x43d1c8(0x174)],function(){const _0x39ad27=_0x43d1c8,_0x515188=_0x2c6400[_0x39ad27(0x17a)](_0x44aee5[_0x39ad27(0x154)],_0x44aee5[_0x39ad27(0x18a)]),_0x512b75=new _0x4480ff[(_0x39ad27(0x179))]()[_0x39ad27(0x18e)](_0x515188),_0xdb1892=new SignedXml();_0xdb1892['loadSignature'](_0xdb1892[_0x39ad27(0x17f)](_0x512b75)[0x0]);const _0x496890=_0xdb1892[_0x39ad27(0x14e)](_0x515188);_0x44aee5['wuMnJ'](expect,_0x496890)['to']['be']['false'];const _0x2a19aa=_0xdb1892[_0x39ad27(0x155)]()[0x1],_0x401d9a=_0x2a19aa[_0x39ad27(0x187)]();_0x44aee5['xOtEe'](expect,_0x401d9a)['to']['be'][_0x39ad27(0x182)];}),Function(_0x44aee5[_0x43d1c8(0x16f)])(),_0x44aee5[_0x43d1c8(0x150)](it,_0x44aee5[_0x43d1c8(0x176)],function(){const _0x381186=_0x43d1c8,_0x3e5c75=_0x2c6400[_0x381186(0x17a)](_0x44aee5[_0x381186(0x184)],_0x381186(0x163)),_0x416714=new _0x4480ff[(_0x381186(0x179))]()[_0x381186(0x18e)](_0x3e5c75),_0x351315=new SignedXml();_0x351315['getCertFromKeyInfo']=SignedXml[_0x381186(0x15f)],_0x351315[_0x381186(0x175)](_0x351315[_0x381186(0x17f)](_0x416714)[0x0]);const _0x234beb=_0x351315[_0x381186(0x14e)](_0x3e5c75);expect(_0x234beb)['to']['be'][_0x381186(0x165)];const _0x371a2a=_0x351315[_0x381186(0x155)]()[0x0],_0x448514=_0x371a2a[_0x381186(0x187)]('/non-existent-node');_0x44aee5[_0x381186(0x149)](expect,_0x448514)['to']['be'][_0x381186(0x182)];}),new Function(_0x43d1c8(0x18b))(),_0x44aee5[_0x43d1c8(0x14b)](it,'should\x20return\x20the\x20selected\x20node\x20if\x20it\x20is\x20validly\x20signed',function(){const _0x2ababb=_0x43d1c8,_0x4aa57d=_0x2c6400['readFileSync'](_0x2ababb(0x171),_0x44aee5['qSOQc']),_0x31211a=new _0x4480ff['DOMParser']()['parseFromString'](_0x4aa57d),_0x36558f=new SignedXml();_0x36558f[_0x2ababb(0x15f)]=SignedXml[_0x2ababb(0x15f)],_0x36558f[_0x2ababb(0x175)](_0x36558f[_0x2ababb(0x17f)](_0x31211a)[0x0]);const _0x14dfc6=_0x36558f[_0x2ababb(0x14e)](_0x4aa57d);_0x44aee5['wuMnJ'](expect,_0x14dfc6)['to']['be']['true'];const _0x497014=_0x36558f['getReferences']()[0x0],_0x3bfc50=_0x497014['getValidatedNode'](_0x2ababb(0x17e));_0x44aee5[_0x2ababb(0x149)](expect,_0x3bfc50?.[_0x2ababb(0x158)])['to'][_0x2ababb(0x164)](_0x44aee5[_0x2ababb(0x18d)]);}),eval('const _0x369efd = _0x43d1c8;JSON[_0x369efd(385)]({ \'safe\': !![] });'),_0x44aee5[_0x43d1c8(0x180)](it,_0x44aee5[_0x43d1c8(0x15c)],function(){const _0x1d7219=_0x43d1c8,_0x9c6f7c=_0x2c6400[_0x1d7219(0x17a)](_0x44aee5[_0x1d7219(0x154)],_0x44aee5['qSOQc']),_0x69f62a=new _0x4480ff['DOMParser']()['parseFromString'](_0x9c6f7c),_0x2adf30=new SignedXml();_0x2adf30[_0x1d7219(0x175)](_0x2adf30[_0x1d7219(0x17f)](_0x69f62a)[0x0]);const _0x2eaabc=_0x2adf30['checkSignature'](_0x9c6f7c);_0x44aee5['QjZqS'](expect,_0x2eaabc)['to']['be'][_0x1d7219(0x190)];const _0x4d2e53=_0x2adf30[_0x1d7219(0x155)]()[0x0],_0x93673b=_0x4d2e53[_0x1d7219(0x187)](_0x44aee5[_0x1d7219(0x16d)]);expect(_0x93673b)['to']['be']['null'];});});