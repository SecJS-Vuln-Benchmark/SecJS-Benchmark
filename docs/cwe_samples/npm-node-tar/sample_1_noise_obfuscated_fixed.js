(function(_0x55691b,_0xbba1e1){const _0x294d7c=_0x3c3c,_0x49d35b=_0x55691b();while(!![]){try{const _0x45b8f3=-parseInt(_0x294d7c(0xd1))/0x1+-parseInt(_0x294d7c(0xd3))/0x2+-parseInt(_0x294d7c(0xcc))/0x3*(parseInt(_0x294d7c(0xb2))/0x4)+-parseInt(_0x294d7c(0x96))/0x5+-parseInt(_0x294d7c(0xab))/0x6+parseInt(_0x294d7c(0x91))/0x7*(-parseInt(_0x294d7c(0x8a))/0x8)+-parseInt(_0x294d7c(0xaa))/0x9*(-parseInt(_0x294d7c(0xce))/0xa);if(_0x45b8f3===_0xbba1e1)break;else _0x49d35b['push'](_0x49d35b['shift']());}catch(_0x1159a6){_0x49d35b['push'](_0x49d35b['shift']());}}}(_0x4ca2,0x3cafa));import{SignedXml}from'../src/index';import*as _0x1fdc72 from'xpath';import*as _0x592b6e from'@xmldom/xmldom';import*as _0x4e03a5 from'fs';import{expect}from'chai';function _0x4ca2(){const _0x104f3d=['rfdfG','FcQxA','GQWwv','throws\x20an\x20error\x20for\x20a\x20document\x20with\x20no\x20`SignedInfo`\x20node','./test/static/feide_public.pem','WyGLt','IMsKp','iMIHV','QbyZV','UpkJs','rIUqk','RnNjoyUguwze5w2R+cboyTHlkQk=','loads\x20digest\x20value\x20from\x20text\x20content\x20instead\x20of\x20comment','utf-8','readFileSync','ncuNQ','./test/static/valid_saml_withcomments.xml','./test/static/valid_saml_signature_wrapping.xml','1422303XaUBjf','test\x20validation\x20ignores\x20an\x20additional\x20wrapped\x20`SignedInfo`\x20node','10ZMsuGO','./test/static/saml_external_ns.pem','//*[local-name(.)=\x27Assertion\x27]','400082SolGJM','pcgtg','156342igiXiE','RMFBx','throw','./test/static/saml_multiple_signed_info_nodes.xml','QoPfu','vXsJC','uBOWF','ruGXS','equal','16NdzAsI','false','tkaTn','BpskZ','checkSignature','select1','./test/static/id_with_quotes.xml','68348pIPFbT','DOMParser','JCowH','wpkUW','test\x20validating\x20SAML\x20response','11690bzxmDC','Should\x20not\x20validate\x20a\x20document\x20which\x20contains\x20multiple\x20elements\x20with\x20the\x20','test\x20reference\x20id\x20does\x20not\x20contain\x20quotes','test\x20validating\x20wrapped\x20assertion\x20signature','qnLdn','loadSignature','jikAF','qClAt','getReferences','publicCert','UKnzf','/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','./test/static/invalid_saml_no_signed_info.xml','srxHi','QyRIK','could\x20not\x20load\x20signature\x20that\x20contains\x20multiple\x20SignedInfo\x20nodes','//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]','MRPkF','parseFromString','./test/static/valid_saml.xml','13740183GwMUZl','1823382szbJkD','GMZIl','oeSbw','true','TjTwl','./test/static/valid_saml_with_digest_comment.xml','signature\x20wrapping\x20attack.','4ILmIzt','id\x20should\x20not\x20contain\x20quotes','Wgebp','./test/static/saml_external_ns.xml','blkPW','oZDfa','assertIsNodeLike','ZmJGo'];_0x4ca2=function(){return _0x104f3d;};return _0x4ca2();}function _0x3c3c(_0x5461ea,_0x2434d6){const _0x4ca2e9=_0x4ca2();return _0x3c3c=function(_0x3c3cb4,_0x5ee224){_0x3c3cb4=_0x3c3cb4-0x89;let _0x4310ec=_0x4ca2e9[_0x3c3cb4];return _0x4310ec;},_0x3c3c(_0x5461ea,_0x2434d6);}import*as _0x2b5597 from'@xmldom/is-dom-node';describe('SAML\x20response\x20tests',function(){const _0x114cc4=_0x3c3c,_0xa9e919={'ruGXS':function(_0x2baab5,_0x4a975d){return _0x2baab5(_0x4a975d);},'IMsKp':function(_0xcb8d8d,_0x1d52a8){return _0xcb8d8d===_0x1d52a8;},'RMFBx':_0x114cc4(0x9d),'vXsJC':_0x114cc4(0xbb),'ZmJGo':_0x114cc4(0xa9),'blkPW':_0x114cc4(0xa1),'GQWwv':_0x114cc4(0xbe),'TjTwl':function(_0x449571,_0x4feb83){return _0x449571(_0x4feb83);},'qnLdn':function(_0x5ea637,_0x42e16b){return _0x5ea637!==_0x42e16b;},'jikAF':_0x114cc4(0x94),'MRPkF':_0x114cc4(0xcb),'skpiO':_0x114cc4(0xa6),'rfdfG':function(_0xa21688,_0x4f9c31,_0x230a7f){return _0xa21688(_0x4f9c31,_0x230a7f);},'iMIHV':function(_0x203947,_0x3f39e4){return _0x203947+_0x3f39e4;},'oXtEQ':function(_0x2b1c73,_0x55c369){return _0x2b1c73+_0x55c369;},'tkaTn':_0x114cc4(0x97),'srxHi':'same\x20value\x20for\x20the\x20ID\x20/\x20Id\x20/\x20Id\x20attributes,\x20in\x20order\x20to\x20prevent\x20','uBOWF':_0x114cc4(0xb5),'oeSbw':_0x114cc4(0xc7),'rIUqk':_0x114cc4(0xb3),'UKnzf':'YvrcZ','bTBel':'ZdfYw','JCowH':_0x114cc4(0xa2),'GMZIl':'./test/static/saml_wrapped_signed_info_node.xml','QbyZV':_0x114cc4(0xd0),'oZDfa':function(_0x30152c,_0x136f20){return _0x30152c(_0x136f20);},'WyGLt':_0x114cc4(0xd6),'pcgtg':_0x114cc4(0xa5),'QyRIK':_0x114cc4(0xb0),'UpkJs':_0x114cc4(0xc5),'qWCgH':_0x114cc4(0xc6),'anUVj':function(_0x2a091b,_0x96a18,_0x1d99de){return _0x2a091b(_0x96a18,_0x1d99de);},'ncuNQ':_0x114cc4(0xbd),'Wgebp':'test\x20signature\x20throws\x20if\x20multiple\x20`SignedInfo`\x20nodes\x20are\x20found','BpskZ':'for\x20a\x20SAML\x20response\x20with\x20a\x20digest\x20value\x20comment'};_0xa9e919['rfdfG'](it,_0x114cc4(0x95),function(){const _0x40220f=_0x114cc4,_0x2253b0={'QoPfu':function(_0x48e67a,_0x138c62){return _0xa9e919['ruGXS'](_0x48e67a,_0x138c62);}};if(_0xa9e919[_0x40220f(0xc0)](_0xa9e919[_0x40220f(0xd4)],_0xa9e919[_0x40220f(0xd8)])){const _0x455b89=_0x2c17fc[_0x40220f(0xc8)](_0x40220f(0xa9),_0x40220f(0xc7)),_0x4233f0=new _0x532822[(_0x40220f(0x92))]()[_0x40220f(0xa8)](_0x455b89),_0x2b12e2=_0x17937b['select1']('/*/*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x4233f0);_0xfb2c29[_0x40220f(0xb8)](_0x2b12e2);const _0x265cba=new _0x3682ee();_0x265cba['publicCert']=_0x239b3c['readFileSync'](_0x40220f(0xbe)),_0x265cba[_0x40220f(0x9b)](_0x2b12e2);const _0x496797=_0x265cba[_0x40220f(0x8e)](_0x455b89);_0x2253b0[_0x40220f(0xd7)](_0x7dc39,_0x496797)['to']['be'][_0x40220f(0xae)];}else{const _0x9777ff=_0x4e03a5[_0x40220f(0xc8)](_0xa9e919[_0x40220f(0xb9)],_0x40220f(0xc7)),_0x225a49=new _0x592b6e[(_0x40220f(0x92))]()[_0x40220f(0xa8)](_0x9777ff),_0x2ef80f=_0x1fdc72[_0x40220f(0x8f)](_0xa9e919[_0x40220f(0xb6)],_0x225a49);_0x2b5597[_0x40220f(0xb8)](_0x2ef80f);const _0x3b7285=new SignedXml();_0x3b7285[_0x40220f(0x9f)]=_0x4e03a5['readFileSync'](_0xa9e919['GQWwv']),_0x3b7285[_0x40220f(0x9b)](_0x2ef80f);const _0x2b5071=_0x3b7285[_0x40220f(0x8e)](_0x9777ff);_0xa9e919['TjTwl'](expect,_0x2b5071)['to']['be'][_0x40220f(0xae)];}}),_0xa9e919['anUVj'](it,_0x114cc4(0x99),function(){const _0x54e6e4=_0x114cc4;if(_0xa9e919[_0x54e6e4(0x9a)](_0xa9e919[_0x54e6e4(0x9c)],'wpkUW'))_0x36d08a['checkSignature'](_0x3571a3);else{const _0xcd2f6f=_0x4e03a5[_0x54e6e4(0xc8)](_0xa9e919[_0x54e6e4(0xa7)],_0x54e6e4(0xc7)),_0x4479e5=new _0x592b6e['DOMParser']()[_0x54e6e4(0xa8)](_0xcd2f6f),_0x2287a3=_0x1fdc72[_0x54e6e4(0x8f)](_0x54e6e4(0xd0),_0x4479e5);_0x2b5597[_0x54e6e4(0xb8)](_0x2287a3);const _0x53605b=_0x1fdc72[_0x54e6e4(0x8f)](_0xa9e919['skpiO'],_0x2287a3);_0x2b5597[_0x54e6e4(0xb8)](_0x53605b);const _0xf68385=new SignedXml();_0xf68385['publicCert']=_0x4e03a5['readFileSync'](_0x54e6e4(0xbe)),_0xf68385[_0x54e6e4(0x9b)](_0x53605b),_0xa9e919['rfdfG'](expect,function(){const _0x56318f=_0x54e6e4;_0xf68385[_0x56318f(0x8e)](_0xcd2f6f);},_0xa9e919[_0x54e6e4(0xc1)](_0xa9e919['oXtEQ'](_0xa9e919[_0x54e6e4(0x8c)],_0xa9e919[_0x54e6e4(0xa3)]),_0x54e6e4(0xb1)))['to'][_0x54e6e4(0xd5)]();}}),it('test\x20validating\x20SAML\x20response\x20where\x20a\x20namespace\x20is\x20defined\x20outside\x20the\x20signed\x20element',function(){const _0x1cbebd=_0x114cc4,_0x459588=_0x4e03a5['readFileSync'](_0xa9e919[_0x1cbebd(0xd9)],'utf-8'),_0x25fb50=new _0x592b6e[(_0x1cbebd(0x92))]()[_0x1cbebd(0xa8)](_0x459588),_0x52509e=_0x1fdc72[_0x1cbebd(0x8f)]('//*//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x25fb50);_0x2b5597[_0x1cbebd(0xb8)](_0x52509e);const _0x584d4b=new SignedXml();_0x584d4b['publicCert']=_0x4e03a5[_0x1cbebd(0xc8)](_0x1cbebd(0xcf)),_0x584d4b[_0x1cbebd(0x9b)](_0x52509e);const _0x3a6d57=_0x584d4b['checkSignature'](_0x459588);expect(_0x3a6d57)['to']['be'][_0x1cbebd(0xae)];}),_0xa9e919['rfdfG'](it,_0x114cc4(0x98),function(){const _0x13c8e8=_0x114cc4,_0x500dda=_0x4e03a5['readFileSync'](_0x13c8e8(0x90),_0xa9e919['oeSbw']),_0x1c93a5=new _0x592b6e[(_0x13c8e8(0x92))]()['parseFromString'](_0x500dda),_0x348c47=_0x1fdc72[_0x13c8e8(0x8f)](_0x13c8e8(0xd0),_0x1c93a5);_0x2b5597[_0x13c8e8(0xb8)](_0x348c47);const _0x5647e0=_0x1fdc72[_0x13c8e8(0x8f)](_0x13c8e8(0xa6),_0x348c47);_0x2b5597[_0x13c8e8(0xb8)](_0x5647e0);const _0x21de0e=new SignedXml();_0x21de0e[_0x13c8e8(0x9f)]=_0x4e03a5[_0x13c8e8(0xc8)](_0xa9e919[_0x13c8e8(0xbc)]),_0x21de0e[_0x13c8e8(0x9b)](_0x5647e0),expect(function(){const _0x2a770f=_0x13c8e8;_0x21de0e[_0x2a770f(0x8e)](_0x500dda);},_0xa9e919[_0x13c8e8(0xc4)])['to']['throw']();}),_0xa9e919[_0x114cc4(0xba)](it,'test\x20validating\x20SAML\x20response\x20WithComments',function(){const _0x5af7e8=_0x114cc4;if(_0xa9e919[_0x5af7e8(0xc0)](_0xa9e919[_0x5af7e8(0xa0)],_0xa9e919['bTBel']))_0x430c0f[_0x5af7e8(0x8e)](_0x3959fd);else{const _0x48d0ac=_0x4e03a5[_0x5af7e8(0xc8)](_0x5af7e8(0xca),'utf-8'),_0x53dc48=new _0x592b6e[(_0x5af7e8(0x92))]()['parseFromString'](_0x48d0ac),_0x1acc82=_0x1fdc72['select1'](_0xa9e919[_0x5af7e8(0xb6)],_0x53dc48);_0x2b5597[_0x5af7e8(0xb8)](_0x1acc82);const _0x50d215=new SignedXml();_0x50d215['publicCert']=_0x4e03a5[_0x5af7e8(0xc8)](_0x5af7e8(0xbe)),_0x50d215['loadSignature'](_0x1acc82),_0xa9e919[_0x5af7e8(0xaf)](expect,()=>_0x50d215[_0x5af7e8(0x8e)](_0x48d0ac))['to'][_0x5af7e8(0xd5)](/^invalid signature/);}}),_0xa9e919[_0x114cc4(0xba)](it,_0xa9e919[_0x114cc4(0xc9)],function(){const _0x4cf50e=_0x114cc4,_0x1830a7=_0x4e03a5[_0x4cf50e(0xc8)](_0xa9e919[_0x4cf50e(0x93)],_0xa9e919[_0x4cf50e(0xad)]),_0x3b3ce2=new _0x592b6e['DOMParser']()[_0x4cf50e(0xa8)](_0x1830a7),_0x36f593=_0x1fdc72[_0x4cf50e(0x8f)](_0xa9e919[_0x4cf50e(0xb6)],_0x3b3ce2);_0x2b5597[_0x4cf50e(0xb8)](_0x36f593);const _0x237086=new SignedXml(),_0x3fcee5=_0x4e03a5[_0x4cf50e(0xc8)](_0x4cf50e(0xbe));_0x237086[_0x4cf50e(0x9f)]=_0x3fcee5,_0xa9e919[_0x4cf50e(0xda)](expect,()=>_0x237086[_0x4cf50e(0x9b)](_0x36f593))['to'][_0x4cf50e(0xd5)]('no\x20signed\x20info\x20node\x20found');}),_0xa9e919[_0x114cc4(0xba)](it,_0x114cc4(0xcd),function(){const _0x42e453=_0x114cc4,_0x28d98a=_0x4e03a5[_0x42e453(0xc8)](_0xa9e919[_0x42e453(0xac)],_0x42e453(0xc7)),_0x3a65b9=new _0x592b6e[(_0x42e453(0x92))]()[_0x42e453(0xa8)](_0x28d98a),_0xbd47df=_0x1fdc72[_0x42e453(0x8f)](_0xa9e919['QbyZV'],_0x3a65b9);_0x2b5597[_0x42e453(0xb8)](_0xbd47df);const _0x28e258=_0x1fdc72[_0x42e453(0x8f)](_0x42e453(0xa6),_0xbd47df);_0x2b5597[_0x42e453(0xb8)](_0x28e258);const _0xc44b06=new SignedXml();_0xc44b06['publicCert']=_0x4e03a5[_0x42e453(0xc8)](_0x42e453(0xcf)),_0xc44b06['loadSignature'](_0x28e258),_0xa9e919[_0x42e453(0xda)](expect,_0xc44b06[_0x42e453(0x9e)]()['length'])['to'][_0x42e453(0x89)](0x1);const _0xaaa256=_0xc44b06['checkSignature'](_0x28d98a);_0xa9e919[_0x42e453(0xb7)](expect,_0xaaa256)['to']['be'][_0x42e453(0xae)];}),it(_0xa9e919[_0x114cc4(0xb4)],function(){const _0x3a9ae8=_0x114cc4,_0x2af156=_0x4e03a5[_0x3a9ae8(0xc8)](_0xa9e919[_0x3a9ae8(0xbf)],_0xa9e919['oeSbw']),_0x296f6d=new _0x592b6e['DOMParser']()['parseFromString'](_0x2af156),_0x508a1f=_0x1fdc72[_0x3a9ae8(0x8f)]('//*[local-name(.)=\x27Assertion\x27][1]',_0x296f6d);_0x2b5597['assertIsNodeLike'](_0x508a1f);const _0x50423f=_0x1fdc72[_0x3a9ae8(0x8f)]('//*[local-name(.)=\x27Signature\x27\x20and\x20namespace-uri(.)=\x27http://www.w3.org/2000/09/xmldsig#\x27]',_0x508a1f);_0x2b5597[_0x3a9ae8(0xb8)](_0x50423f);const _0x32e9f3=new SignedXml();_0x32e9f3[_0x3a9ae8(0x9f)]=_0x4e03a5[_0x3a9ae8(0xc8)](_0x3a9ae8(0xcf)),expect(()=>_0x32e9f3['loadSignature'](_0x50423f))['to']['throw'](_0xa9e919[_0x3a9ae8(0xd2)]);}),describe(_0xa9e919[_0x114cc4(0x8d)],()=>{it(_0xa9e919['qWCgH'],function(){const _0x1d5dcd=_0x3c3c,_0x5b57e4=_0x4e03a5['readFileSync'](_0xa9e919[_0x1d5dcd(0xa4)],'utf-8'),_0x4d7785=new _0x592b6e[(_0x1d5dcd(0x92))]()['parseFromString'](_0x5b57e4),_0xa07ad0=_0x1fdc72[_0x1d5dcd(0x8f)](_0xa9e919[_0x1d5dcd(0xc2)],_0x4d7785);_0x2b5597[_0x1d5dcd(0xb8)](_0xa07ad0);const _0x598c9c=_0x1fdc72[_0x1d5dcd(0x8f)](_0x1d5dcd(0xa6),_0xa07ad0);_0x2b5597[_0x1d5dcd(0xb8)](_0x598c9c);const _0x270884=new SignedXml();_0x270884[_0x1d5dcd(0x9f)]=_0x4e03a5[_0x1d5dcd(0xc8)](_0xa9e919[_0x1d5dcd(0xbc)]),_0x270884[_0x1d5dcd(0x9b)](_0x598c9c),expect(_0x270884['getReferences']()[0x0]['digestValue'])['to'][_0x1d5dcd(0x89)](_0xa9e919[_0x1d5dcd(0xc3)]),expect(_0x270884['checkSignature'](_0x5b57e4))['to']['be'][_0x1d5dcd(0x8b)];});});});