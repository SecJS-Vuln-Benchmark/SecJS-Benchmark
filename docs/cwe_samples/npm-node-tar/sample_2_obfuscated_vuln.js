'use strict';const _0xae101a=_0x22b9;(function(_0xb51a4,_0x24f447){const _0x3b6707=_0x22b9,_0x2c28ff=_0xb51a4();while(!![]){try{const _0x5d29f0=-parseInt(_0x3b6707(0x11f))/0x1*(-parseInt(_0x3b6707(0x129))/0x2)+-parseInt(_0x3b6707(0xe5))/0x3+parseInt(_0x3b6707(0x114))/0x4*(parseInt(_0x3b6707(0x102))/0x5)+-parseInt(_0x3b6707(0xf1))/0x6+parseInt(_0x3b6707(0x112))/0x7*(-parseInt(_0x3b6707(0x125))/0x8)+parseInt(_0x3b6707(0x11b))/0x9*(parseInt(_0x3b6707(0x103))/0xa)+parseInt(_0x3b6707(0xe8))/0xb;if(_0x5d29f0===_0x24f447)break;else _0x2c28ff['push'](_0x2c28ff['shift']());}catch(_0x598300){_0x2c28ff['push'](_0x2c28ff['shift']());}}}(_0x582a,0xd2919));const argv=require(_0xae101a(0xff))[_0xae101a(0x118)](_0xae101a(0x120))['argv'],net=require('net'),opcua=require('node-opcua'),hexDump=require(_0xae101a(0xeb))['hexDump'],MessageBuilder=require(_0xae101a(0x12e))[_0xae101a(0x116)],BinaryStream=require('../lib/misc/binaryStream')[_0xae101a(0x119)],analyseExtensionObject=require('../lib/misc/analyzePacket')[_0xae101a(0xe7)],messageHeaderToString=require('../lib/misc/message_header')[_0xae101a(0x105)],s=require(_0xae101a(0x108)),chalk=require(_0xae101a(0x10e)),remote_port=parseInt(argv['port'],0xa)||0x12e9,hostname=argv[_0xae101a(0x11d)]||_0xae101a(0x12d),my_port=parseInt(argv[_0xae101a(0x101)],0xa)||remote_port+0x1,TrafficAnalyser=function(_0x1d66de){this['id']=_0x1d66de;};function _0x582a(){const _0x475e39=['JmBIv','length','chalk','add','red','JKsxm','9863MomXwo','connected','668eTHUNG','server\x20disconnected\x20(CLOSE)','MessageBuilder','ERR','usage','BinaryStream','bYnjb','36kqFXTw','connect','hostname','close','68528dGnbsx','Usage:\x20$0\x20--portServer\x20[num]\x20--port\x20[num]\x20\x20--hostname\x20<hostname>\x20-block','CuXSO','ERROR\x20:\x20','ITPPb','end','3696LCLfYg','wpFjf','\x20server\x20->\x20client\x20:\x20packet\x20length\x20','\x20reason:','40uEOLRH','mVrve','bghNL','createServer','localhost','../lib/misc/message_builder','toString','AleVs','log','4720365OYGpzX','NykgN','analyseExtensionObject','205271zbyzZg','moqSQ','block','node-opcua-utils','MSG','\x20Error\x200x','net','\x20\x20+->\x20redirecting\x20conversation\x20to\x20server\x20port\x20','stringify','752652hRvpCN','decode','write','mLdIp','msgType','KvTmU','Socket','HEL','full_message_body','reason','TCPErrorMessage','OPN','yellow','YywFy','yargs','prototype','portServer','9505pRFmcg','3764140XhweZs','statusCode','messageHeaderToString','\x20client\x20->\x20server\x20:\x20packet\x20length\x20','data','../lib/datamodel/structures','nRcRQ','server\x20disconnected\x20(END)','bold'];_0x582a=function(){return _0x475e39;};return _0x582a();}function _0x22b9(_0x40546f,_0x82a504){const _0x582ac9=_0x582a();return _0x22b9=function(_0x22b955,_0x1e33cf){_0x22b955=_0x22b955-0xe4;let _0x59e5eb=_0x582ac9[_0x22b955];return _0x59e5eb;},_0x22b9(_0x40546f,_0x82a504);}TrafficAnalyser[_0xae101a(0x100)]['add']=function(_0x58b9c5){const _0x52e938=_0xae101a,_0x420e69={'YywFy':function(_0x51b854,_0x5da6e5){return _0x51b854(_0x5da6e5);},'bghNL':function(_0x4d8361,_0x182071){return _0x4d8361(_0x182071);},'nRcRQ':function(_0x11c81d,_0x2cf4c9){return _0x11c81d===_0x2cf4c9;},'KISgb':_0x52e938(0x117),'DFHql':_0x52e938(0xf9),'moqSQ':_0x52e938(0xf8),'JmBIv':function(_0xe92cbb,_0x2f9590){return _0xe92cbb%_0x2f9590;},'mLdIp':'kiZrN','waBnQ':_0x52e938(0x11a),'wpFjf':_0x52e938(0xe6),'XZwsF':_0x52e938(0xfc),'ITPPb':_0x52e938(0xec),'JKsxm':function(_0xcd6f47,_0x367584){return _0xcd6f47(_0x367584);},'AleVs':function(_0x5e21c,_0x3b513d){return _0x5e21c(_0x3b513d);}},_0x37bbdb=new BinaryStream(_0x58b9c5);if(argv[_0x52e938(0xea)]){console[_0x52e938(0xe4)](_0x420e69['bghNL'](hexDump,_0x58b9c5));return;}const _0x3ddc42=opcua['readMessageHeader'](_0x37bbdb);if(_0x420e69[_0x52e938(0x109)](_0x3ddc42['msgType'],_0x420e69['KISgb'])){var _0x3c15f6=new s[(_0x52e938(0xfb))]();_0x3c15f6[_0x52e938(0xf2)](_0x37bbdb),console['log'](_0x52e938(0xed)+_0x3c15f6[_0x52e938(0x104)][_0x52e938(0x12f)]()+_0x52e938(0x128)+_0x3c15f6[_0x52e938(0xfa)]),console['log'](_0x420e69[_0x52e938(0x12b)](hexDump,_0x58b9c5));}const _0x590d09=new MessageBuilder();_0x590d09['on'](_0x420e69['DFHql'],function(_0x4726b8){const _0x179b80=_0x52e938;console['log'](hexDump(_0x4726b8));try{_0x420e69[_0x179b80(0xfe)](analyseExtensionObject,_0x4726b8);}catch(_0x45612e){console[_0x179b80(0xe4)](chalk[_0x179b80(0x110)](_0x179b80(0x122)),_0x45612e);}});switch(_0x3ddc42[_0x52e938(0xf5)]){case _0x420e69[_0x52e938(0xe9)]:case'ACK':if(_0x420e69[_0x52e938(0x10c)](this['id'],0x2))'kiZrN'!==_0x420e69[_0x52e938(0xf4)]?_0x34af1c(_0x17f4a0):console[_0x52e938(0xe4)](chalk[_0x52e938(0x110)][_0x52e938(0x10b)](JSON[_0x52e938(0xf0)](_0x3ddc42,null,'')));else{if(_0x420e69['waBnQ']===_0x420e69[_0x52e938(0x126)]){_0x5d5b59[_0x52e938(0xe4)](_0x52e938(0x127)+_0xe0104e['length']),_0x5a49f6[_0x52e938(0x10f)](_0x7b1259);try{_0x578b92[_0x52e938(0xf3)](_0x1a7c29);}catch(_0x3d1a9e){}}else console[_0x52e938(0xe4)](chalk[_0x52e938(0xfd)][_0x52e938(0x10b)](JSON['stringify'](_0x3ddc42,null,'')));}break;case _0x420e69['XZwsF']:case'CLO':case _0x420e69[_0x52e938(0x123)]:this['id']%0x2?console[_0x52e938(0xe4)](chalk['red']['bold'](_0x420e69['bghNL'](messageHeaderToString,_0x58b9c5))):console[_0x52e938(0xe4)](chalk[_0x52e938(0xfd)][_0x52e938(0x10b)](_0x420e69[_0x52e938(0x111)](messageHeaderToString,_0x58b9c5)));_0x590d09['feed'](_0x58b9c5);break;case _0x52e938(0x117):console[_0x52e938(0xe4)](_0x420e69[_0x52e938(0x130)](hexDump,_0x58b9c5));break;default:break;}},require(_0xae101a(0xee))[_0xae101a(0x12c)](function(_0x1f0dbe){const _0x4e6745=_0xae101a,_0x489608={'CuXSO':_0x4e6745(0x10a),'mVrve':_0x4e6745(0x113),'KvTmU':_0x4e6745(0x11e)};console[_0x4e6745(0xe4)](_0x489608[_0x4e6745(0x12a)]);const _0x4cbde6=new TrafficAnalyser(0x1),_0x29c377=new TrafficAnalyser(0x2),_0x1b6b4c=new net[(_0x4e6745(0xf7))]();_0x1b6b4c[_0x4e6745(0x11c)](remote_port,hostname),_0x1b6b4c['on'](_0x4e6745(0x107),function(_0x446766){const _0x1236b1=_0x4e6745;console[_0x1236b1(0xe4)](_0x1236b1(0x127)+_0x446766[_0x1236b1(0x10d)]),_0x29c377['add'](_0x446766);try{_0x1f0dbe[_0x1236b1(0xf3)](_0x446766);}catch(_0x13f290){}}),_0x1f0dbe['on'](_0x4e6745(0x107),function(_0x18ef2c){const _0x391d4c=_0x4e6745;console[_0x391d4c(0xe4)](_0x391d4c(0x106)+_0x18ef2c[_0x391d4c(0x10d)]),_0x4cbde6[_0x391d4c(0x10f)](_0x18ef2c),_0x1b6b4c['write'](_0x18ef2c);}),_0x1f0dbe['on'](_0x489608[_0x4e6745(0xf6)],function(){const _0x271dc1=_0x4e6745;console['log'](_0x271dc1(0x115)),_0x1b6b4c[_0x271dc1(0x124)]();}),_0x1f0dbe['on'](_0x4e6745(0x124),function(){const _0x5d37aa=_0x4e6745;console['log'](_0x489608[_0x5d37aa(0x121)]);});})['listen'](my_port),console['log']('\x20registering\x20OPCUA\x20server\x20on\x20port\x20'+my_port),console[_0xae101a(0xe4)](_0xae101a(0xef)+remote_port);