const _0x38d74d=_0x1abb;(function(_0x547094,_0x147e9d){const _0x12839e=_0x1abb,_0x2c646d=_0x547094();while(!![]){try{const _0x272c13=-parseInt(_0x12839e(0x160))/0x1*(parseInt(_0x12839e(0x175))/0x2)+-parseInt(_0x12839e(0x186))/0x3+parseInt(_0x12839e(0x162))/0x4*(-parseInt(_0x12839e(0x17b))/0x5)+-parseInt(_0x12839e(0x193))/0x6*(-parseInt(_0x12839e(0x189))/0x7)+parseInt(_0x12839e(0x14c))/0x8*(-parseInt(_0x12839e(0x17c))/0x9)+parseInt(_0x12839e(0x18b))/0xa*(parseInt(_0x12839e(0x18d))/0xb)+parseInt(_0x12839e(0x184))/0xc;if(_0x272c13===_0x147e9d)break;else _0x2c646d['push'](_0x2c646d['shift']());}catch(_0x7b3c24){_0x2c646d['push'](_0x2c646d['shift']());}}}(_0x22a3,0x757c6));const async=require(_0x38d74d(0x150)),should=require(_0x38d74d(0x18f)),chalk=require(_0x38d74d(0x18a)),{AttributeIds,VariableIds,OPCUAClient,resolveNodeId,ClientMonitoredItem,StatusCodes,TimestampsToReturn,MonitoringMode}=require(_0x38d74d(0x166)),{make_debugLog,make_errorLog,checkDebugFlag}=require('node-opcua-debug'),{perform_operation_on_subscription_async}=require('../../test_helpers/perform_operation_on_client_session');function _0x1abb(_0x137529,_0x337491){const _0x22a3cc=_0x22a3();return _0x1abb=function(_0x1abb21,_0x154df3){_0x1abb21=_0x1abb21-0x14c;let _0x275a2d=_0x22a3cc[_0x1abb21];return _0x275a2d;},_0x1abb(_0x137529,_0x337491);}function f(_0x926c55){const _0xdc03a6=_0x38d74d,_0xb3b4b4={'RGNZg':function(_0x2da3bf,_0x52e07b){return _0x2da3bf===_0x52e07b;},'ZMvSX':_0xdc03a6(0x194),'vBnaw':'**$1**'};return function(_0x22bb97){const _0x3b11b4=_0xdc03a6;if(_0xb3b4b4['RGNZg'](_0x3b11b4(0x15f),'VXeMV'))return console[_0x3b11b4(0x18c)](_0xb3b4b4['ZMvSX']+_0x926c55['name'][_0x3b11b4(0x170)](/_/g,'\x20')[_0x3b11b4(0x170)](/(given|when|then)/,chalk[_0x3b11b4(0x15a)](_0xb3b4b4[_0x3b11b4(0x17e)]))),_0x926c55(_0x22bb97);else _0x18eba6[_0x3b11b4(0x16e)](_0x96c15b[_0x3b11b4(0x183)][_0x3b11b4(0x183)]),_0x5cdd92(_0x3b11b4(0x15d),_0x49a3ce);};}const debugLog=make_debugLog('TEST'),errorLog=make_debugLog(_0x38d74d(0x16b)),doDebug=checkDebugFlag(_0x38d74d(0x16b));let sessionCounter=0x0;async function connectAndCreateSession(_0x4278b4){const _0x35e949=_0x38d74d,_0x127603={'vAEan':function(_0x22ea3f,_0x498d43){return _0x22ea3f+_0x498d43;},'STFaZ':'client'},_0x1311af=OPCUAClient[_0x35e949(0x17d)]({'name':_0x127603[_0x35e949(0x15b)](_0x127603[_0x35e949(0x179)],sessionCounter++)});await _0x1311af[_0x35e949(0x159)](_0x4278b4);const _0x318480=await _0x1311af[_0x35e949(0x182)]();return{'client':_0x1311af,'session':_0x318480};}async function closeSessionAndDisconnect({client:_0x4568f7,session:_0x14f566}){const _0x1f9048=_0x38d74d;await _0x14f566[_0x1f9048(0x180)](),await _0x4568f7['disconnect']();}const currentSessionCountNodeId=resolveNodeId(VariableIds[_0x38d74d(0x164)]),cumulatedSessionCountNodeId=resolveNodeId(VariableIds[_0x38d74d(0x187)]);function _0x22a3(){const _0x52937a=['10492644KbOVXs','uptEE','411528oHAyHx','Server_ServerDiagnostics_ServerDiagnosticsSummary_CumulatedSessionCount','eLGvU','598570LyZrXg','chalk','478750ZSZqPK','log','143cenYkq','endpointUrl','should','WPwZi','installMonitoredItem','mOsmC','6kxiwoB','\x20\x20\x20\x20\x20\x20\x20*\x20','8BOIkEh','EcmZo','Reporting','new\x20currentSessionCount=','async','all','Never\x20received\x20changedx\x20for\x20id','Both','eql','hAcCM','connecting','jVmIv','gWLTc','connect','green','vAEan','fKIQB','change\x20=','jjYOI','VXeMV','1CtRltO','CybhB','796548ByLxxq','Value','Server_ServerDiagnostics_ServerDiagnosticsSummary_CurrentSessionCount','disconnecting','node-opcua','yAGOo','PKObp','YWVVX','Testing\x20bug\x20#445\x20-\x20server.serverDiagnosticsSummary.currentSessionCount','TEST','vdmOD','toString','push','udkYF','replace','ujhNR','changed','GYYOF','uccbD','983452oDrPEb','IvgQK','name','pxQHm','STFaZ','exports','10iCZRaD','664866pwCugq','create','vBnaw','once','close','Jaiga','createSession','value'];_0x22a3=function(){return _0x52937a;};return _0x22a3();}async function installMonitoredItem(_0x5001d9,_0x1fdd49){const _0x25a8d9=_0x38d74d,_0x5822d3={'WPwZi':_0x25a8d9(0x15d),'IuIFk':function(_0x3bcfed,_0x59bbd3){return _0x3bcfed(_0x59bbd3);},'jjYOI':function(_0x57a422,_0x1606c5){return _0x57a422+_0x1606c5;},'iZVZG':function(_0x2358ef,_0x13df55){return _0x2358ef(_0x13df55);},'udkYF':function(_0x3fdbb4,_0x50331b,_0x3aba8d){return _0x3fdbb4(_0x50331b,_0x3aba8d);},'YWVVX':function(_0x1918a4,_0x3e4b04,_0x4b7c28){return _0x1918a4(_0x3e4b04,_0x4b7c28);},'ujhNR':_0x25a8d9(0x191),'EcmZo':_0x25a8d9(0x172)};_0x5822d3[_0x25a8d9(0x169)](debugLog,_0x5822d3[_0x25a8d9(0x171)],_0x1fdd49['toString']());const _0x18bb97=await _0x5001d9['monitor']({'nodeId':_0x1fdd49,'attributeId':AttributeIds[_0x25a8d9(0x163)]},{'samplingInterval':0x0,'discardOldest':!![],'queueSize':0xa},TimestampsToReturn[_0x25a8d9(0x153)],MonitoringMode[_0x25a8d9(0x14e)]),_0x222391=[];return _0x18bb97['on'](_0x5822d3[_0x25a8d9(0x14d)],function(_0x315ea7){const _0x593389=_0x25a8d9;_0x222391['push'](_0x315ea7['value'][_0x593389(0x183)]),debugLog(_0x5822d3[_0x593389(0x190)],_0x222391);}),await new Promise((_0x2b0c4f,_0x1926fb)=>{const _0x58ef01=_0x25a8d9,_0x28a5fb=_0x5822d3[_0x58ef01(0x16f)](setTimeout,()=>{const _0x1fa8f1=_0x58ef01;_0x5822d3['IuIFk'](_0x1926fb,new Error(_0x5822d3[_0x1fa8f1(0x15e)](_0x1fa8f1(0x152),_0x1fdd49['toString']())));},0x1388);_0x18bb97[_0x58ef01(0x17f)](_0x58ef01(0x172),function(_0x54c091){_0x5822d3['iZVZG'](clearTimeout,_0x28a5fb),_0x5822d3['iZVZG'](_0x2b0c4f,[_0x222391,_0x18bb97]);});});}async function installCurrentSessionCounter(_0x5ec99c){const _0x532125=_0x38d74d,_0x4f5657={'CybhB':function(_0x4c02a7,_0x198db3,_0x290008){return _0x4c02a7(_0x198db3,_0x290008);}};return await _0x4f5657[_0x532125(0x161)](installMonitoredItem,_0x5ec99c,currentSessionCountNodeId);}async function installCumulatedSessionCounter(_0x2b65f3){return await installMonitoredItem(_0x2b65f3,cumulatedSessionCountNodeId);}async function waitSessionCountChange(_0x121d23){const _0x56b5aa=_0x38d74d,_0x91362a={'yAGOo':function(_0x232563,_0x259aae){return _0x232563(_0x259aae);},'uccbD':'Never\x20received\x20','uptEE':function(_0x5a9d9d,_0x229339,_0x32ec10){return _0x5a9d9d(_0x229339,_0x32ec10);},'jVmIv':_0x56b5aa(0x14f)};return await new Promise((_0x5a92a5,_0x38d49a)=>{const _0x464716=_0x56b5aa,_0x54e8d4=setTimeout(()=>{const _0x13efc6=_0x1abb;_0x91362a[_0x13efc6(0x167)](_0x38d49a,new Error(_0x91362a[_0x13efc6(0x174)],_0x121d23['toString']()));},0x1388);_0x121d23[_0x464716(0x17f)](_0x464716(0x172),function(_0x19b378){const _0x36c616=_0x464716;_0x91362a['yAGOo'](clearTimeout,_0x54e8d4);const _0x1abcbd=_0x19b378[_0x36c616(0x183)][_0x36c616(0x183)];_0x91362a[_0x36c616(0x185)](debugLog,_0x91362a[_0x36c616(0x157)],_0x19b378[_0x36c616(0x16d)]()),_0x91362a[_0x36c616(0x167)](_0x5a92a5,_0x1abcbd);});});}module[_0x38d74d(0x17a)]=function(_0x23ec5c){const _0x72727d=_0x38d74d,_0x2e7e21={'mOsmC':function(_0x5319f4,_0x5aad00){return _0x5319f4(_0x5aad00);},'LYPAS':function(_0x118631,_0x5628bc){return _0x118631+_0x5628bc;},'fKIQB':function(_0x28c673,_0x1643db,_0x1d5ccc){return _0x28c673(_0x1643db,_0x1d5ccc);},'pxQHm':'test\x20that\x20current\x20SessionCount\x20increments\x20and\x20decrements\x20appropriately','Cpwmm':_0x72727d(0x16a)};describe(_0x2e7e21['Cpwmm'],function(){const _0x3a39e0=_0x72727d,_0x55afc3={'PKObp':function(_0x408ef4,_0x589be8){return _0x408ef4(_0x589be8);},'GYYOF':function(_0x31027d){return _0x31027d();},'Jaiga':function(_0x3ad0a5,_0x4beeae){const _0x57db1e=_0x1abb;return _0x2e7e21[_0x57db1e(0x192)](_0x3ad0a5,_0x4beeae);},'TqDxz':function(_0x2b4eec,_0x16e2e0){const _0x243fa1=_0x1abb;return _0x2e7e21[_0x243fa1(0x192)](_0x2b4eec,_0x16e2e0);},'eLGvU':function(_0x360aa2,_0x3c4a9a){return _0x2e7e21['LYPAS'](_0x360aa2,_0x3c4a9a);},'gWLTc':function(_0x452623,_0x2f65f4){return _0x452623+_0x2f65f4;},'WomhI':function(_0x4b9586,_0x45e640){return _0x4b9586-_0x45e640;}};_0x2e7e21[_0x3a39e0(0x15c)](it,_0x2e7e21[_0x3a39e0(0x178)],async()=>{const _0x488596=_0x3a39e0,_0x3c3571={'IvgQK':function(_0xd0a6e6,_0x59d043,_0x522925){return _0xd0a6e6(_0x59d043,_0x522925);},'hAcCM':_0x488596(0x156)},_0xc7fc98=_0x23ec5c[_0x488596(0x18e)],_0x132ff0=OPCUAClient['create']({});await perform_operation_on_subscription_async(_0x132ff0,_0xc7fc98,async function(_0x2273b0,_0x5ed40f){const _0x235c8d=_0x488596,_0x427c89={'vdmOD':function(_0x31cfb8,_0x471363){return _0x55afc3['PKObp'](_0x31cfb8,_0x471363);}},[_0x239f6b,_0x526bab]=await installCurrentSessionCounter(_0x5ed40f),[_0x1c4f7e]=await _0x55afc3[_0x235c8d(0x168)](installCumulatedSessionCounter,_0x5ed40f);let _0x19d4bb=(await _0x2273b0['read']({'nodeId':currentSessionCountNodeId,'attributeId':AttributeIds[_0x235c8d(0x163)]}))[_0x235c8d(0x183)][_0x235c8d(0x183)];async function _0x3ea32e(){const _0x1cccda=_0x235c8d;_0x3c3571[_0x1cccda(0x176)](debugLog,_0x3c3571[_0x1cccda(0x155)],_0x2273b0['name']);const _0x2ffb02=[waitSessionCountChange(_0x526bab),connectAndCreateSession(_0xc7fc98)];return await Promise[_0x1cccda(0x151)](_0x2ffb02);}async function _0x14c61c({client:_0x92e2e6,session:_0x38a32e}){const _0x93084f=_0x235c8d;debugLog(_0x93084f(0x165),_0x38a32e[_0x93084f(0x177)]);const _0xb8209e=[_0x427c89[_0x93084f(0x16c)](waitSessionCountChange,_0x526bab),closeSessionAndDisconnect({'client':_0x92e2e6,'session':_0x38a32e})];return await Promise['all'](_0xb8209e);}const [_0x1649c0,_0x283674]=await _0x3ea32e(),[_0x18391d,_0x8df031]=await _0x55afc3[_0x235c8d(0x173)](_0x3ea32e),[_0x34c7d7]=await _0x55afc3[_0x235c8d(0x181)](_0x14c61c,_0x283674),[_0x516bf3]=await _0x55afc3['TqDxz'](_0x14c61c,_0x8df031);_0x1649c0['should'][_0x235c8d(0x154)](_0x55afc3[_0x235c8d(0x188)](_0x19d4bb,0x1)),_0x18391d[_0x235c8d(0x18f)][_0x235c8d(0x154)](_0x19d4bb+0x2),_0x34c7d7[_0x235c8d(0x18f)][_0x235c8d(0x154)](_0x19d4bb+0x1),_0x516bf3[_0x235c8d(0x18f)]['eql'](_0x55afc3[_0x235c8d(0x158)](_0x19d4bb,0x0));const _0x23f2b6=_0x1c4f7e[0x0];_0x1c4f7e[_0x235c8d(0x18f)][_0x235c8d(0x154)]([_0x23f2b6,_0x55afc3[_0x235c8d(0x188)](_0x23f2b6,0x1),_0x55afc3['gWLTc'](_0x23f2b6,0x2)]);const _0x5ec75e=_0x55afc3['WomhI'](_0x19d4bb,0x1);_0x239f6b['should'][_0x235c8d(0x154)]([_0x55afc3[_0x235c8d(0x188)](_0x5ec75e,0x1),_0x5ec75e+0x2,_0x55afc3[_0x235c8d(0x188)](_0x5ec75e,0x3),_0x5ec75e+0x2,_0x5ec75e+0x1]);});});});};