'use strict';const _0x2af699=_0x4b91;function _0x4b91(_0xd9198c,_0x296f5c){const _0x3718bc=_0x3718();return _0x4b91=function(_0x4b91d9,_0xd292ae){_0x4b91d9=_0x4b91d9-0xc8;let _0x2a09fe=_0x3718bc[_0x4b91d9];return _0x2a09fe;},_0x4b91(_0xd9198c,_0x296f5c);}(function(_0x2764f7,_0x19ad60){const _0x1ad830=_0x4b91,_0x4858de=_0x2764f7();while(!![]){try{const _0x18d57c=-parseInt(_0x1ad830(0xcd))/0x1+parseInt(_0x1ad830(0xdf))/0x2*(-parseInt(_0x1ad830(0xf6))/0x3)+parseInt(_0x1ad830(0xe1))/0x4*(-parseInt(_0x1ad830(0xfa))/0x5)+-parseInt(_0x1ad830(0xd1))/0x6*(parseInt(_0x1ad830(0xca))/0x7)+parseInt(_0x1ad830(0x10b))/0x8+parseInt(_0x1ad830(0xd9))/0x9*(parseInt(_0x1ad830(0x105))/0xa)+parseInt(_0x1ad830(0xf9))/0xb*(parseInt(_0x1ad830(0xf0))/0xc);if(_0x18d57c===_0x19ad60)break;else _0x4858de['push'](_0x4858de['shift']());}catch(_0x3975bc){_0x4858de['push'](_0x4858de['shift']());}}}(_0x3718,0x406b4));function _0x3718(){const _0x5b1133=['WtIEF','AEhgI','21RTxPXe','toBeInstanceOf','it\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20data\x20has\x20not\x20changed\x20even\x20if\x20there\x20is\x20a\x20record\x20in\x20the\x20database\x20with\x20the\x20same\x20attribute\x20value','2879833XiBook','20AsmWkm','it\x20validate\x20the\x20uid\x20if\x20it\x20fit\x20the\x20required\x20format','strapi','ddyjL','wGXsj','properly.formated-uid','non-unique-uid','UID\x20validator','iELBd','toHaveBeenCalledWith','attrUidUnique','1013010guzcDP','pvKRb','wrongly\x5cformated||UID','hWcQn','JwYzs','tIQtN','666504RHdLzV','YYYTZ','unique-uid','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20but\x20not\x20the\x20same\x20id\x20for\x20the\x20checked\x20attribute\x20if\x20an\x20entity\x20is\x20passed','clearAllMocks','other-uid','7ShFjII','assertions','rwXbL','518435pKoazb','mockResolvedValueOnce','../validators','kZyPK','2737164UsyHLn','it\x20always\x20validates\x20the\x20unique\x20constraint\x20even\x20if\x20the\x20attribute\x20is\x20not\x20set\x20as\x20unique','ivGVQ','validateYupSchema','test-uid','QkClo','jfKRU','GAXwA','27CHCEki','mEmRm','toHaveBeenCalled','VHTYH','mockReset','ODkwu','90276UZeoah','@strapi/utils','141776CwwYrW','it\x20fails\x20the\x20validation\x20of\x20the\x20unique\x20constraint\x20if\x20the\x20database\x20contains\x20a\x20record\x20with\x20the\x20same\x20attribute\x20value','ftZUO','ergzx','OmBpI','toBe','regExp','it\x20does\x20not\x20validates\x20the\x20unique\x20constraint\x20if\x20the\x20attribute\x20value\x20is\x20`null`','uid','unchanged-unique-uid','test-model','contentType','MpdEO','XWokg','it\x20checks\x20the\x20database\x20for\x20records\x20with\x20the\x20same\x20value\x20for\x20the\x20checked\x20attribute','60eHPSYr','nullable','not','shsIY'];_0x3718=function(){return _0x5b1133;};return _0x3718();}const strapiUtils=require(_0x2af699(0xe0)),{errors:{YupValidationError}}=require(_0x2af699(0xe0)),validators=require(_0x2af699(0xcf));describe(_0x2af699(0x101),()=>{const _0x5a6def=_0x2af699,_0x20a6fc={'ivGVQ':'unique-uid','tIQtN':_0x5a6def(0xe9),'ddyjL':function(_0x3fbc6a,_0x265ae7){return _0x3fbc6a(_0x265ae7);},'pvKRb':function(_0x38cd96,_0x415cd9){return _0x38cd96(_0x415cd9);},'fPQAO':'non-unique-uid','WtIEF':function(_0x51e2ab,_0x387310,_0x4f7b06){return _0x51e2ab(_0x387310,_0x4f7b06);},'GAXwA':_0x5a6def(0xf8),'iELBd':_0x5a6def(0xef),'kZyPK':_0x5a6def(0x104),'rwXbL':function(_0x580daf,_0x5bca24){return _0x580daf(_0x5bca24);},'OmBpI':_0x5a6def(0xff),'wGXsj':'it\x20fails\x20to\x20validate\x20the\x20uid\x20if\x20it\x20does\x20not\x20fit\x20the\x20requried\x20format','JwYzs':function(_0x5ab010,_0x3631a7,_0x145bd1){return _0x5ab010(_0x3631a7,_0x145bd1);},'VHTYH':_0x5a6def(0xeb),'mEmRm':_0x5a6def(0xd5),'QAthY':'unique'},_0xc4a5bf=jest['fn']();global[_0x5a6def(0xfc)]={'db':{'query':jest['fn'](()=>({'findOne':_0xc4a5bf}))}},afterEach(()=>{const _0x471ece=_0x5a6def;jest[_0x471ece(0xc8)](),_0xc4a5bf[_0x471ece(0xdd)]();});const _0x29ebc3={'kind':_0x5a6def(0xec),'modelName':_0x20a6fc[_0x5a6def(0xdc)],'uid':_0x20a6fc[_0x5a6def(0xda)],'options':{},'attributes':{'attrUidUnique':{'type':_0x5a6def(0xe9)}}};describe(_0x20a6fc['QAthY'],()=>{const _0x440b62=_0x5a6def,_0x499ad0={'YYYTZ':_0x440b62(0xe9),'jfKRU':_0x20a6fc['fPQAO'],'QkClo':_0x440b62(0x104),'XWokg':function(_0x3d9924,_0x1aae9b){return _0x3d9924(_0x1aae9b);},'ergzx':_0x440b62(0xea),'shsIY':function(_0x3f526a,_0x54c4df){const _0x511776=_0x440b62;return _0x20a6fc[_0x511776(0x106)](_0x3f526a,_0x54c4df);},'ODkwu':function(_0x50b143,_0x30942e){return _0x50b143(_0x30942e);},'KOqrz':function(_0xf2d446,_0x589ac9){const _0xf34eba=_0x440b62;return _0x20a6fc[_0xf34eba(0xfd)](_0xf2d446,_0x589ac9);},'ftZUO':_0x20a6fc[_0x440b62(0xd3)]};_0x20a6fc['WtIEF'](test,'it\x20validates\x20the\x20unique\x20constraint\x20if\x20there\x20is\x20no\x20other\x20record\x20in\x20the\x20database',async()=>{const _0x306d18=_0x440b62;_0xc4a5bf['mockResolvedValueOnce'](null);const _0x2c3265=strapiUtils['validateYupSchema'](validators[_0x306d18(0xe9)]({'attr':{'type':_0x499ad0[_0x306d18(0x10c)],'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x306d18(0x104),'value':_0x499ad0[_0x306d18(0xd7)]},'entity':null},{'isDraft':![]}));expect(await _0x2c3265(_0x499ad0[_0x306d18(0xd7)]))[_0x306d18(0xe6)](_0x306d18(0x100));}),test(_0x440b62(0xe8),async()=>{const _0x104888=_0x440b62;_0xc4a5bf[_0x104888(0xce)](null);const _0x5dab5e=strapiUtils[_0x104888(0xd4)](validators[_0x104888(0xe9)]({'attr':{'type':_0x104888(0xe9),'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x499ad0[_0x104888(0xd6)],'value':null},'entity':null},{'isDraft':![]})[_0x104888(0xf1)]());await _0x5dab5e(null),expect(_0xc4a5bf)[_0x104888(0xf2)][_0x104888(0xdb)]();}),test(_0x440b62(0xd2),async()=>{const _0x5eb0b8=_0x440b62;_0xc4a5bf['mockResolvedValueOnce'](null);const _0xa89aec=strapiUtils['validateYupSchema'](validators['uid']({'attr':{'type':_0x5eb0b8(0xe9)},'model':_0x29ebc3,'updatedAttribute':{'name':_0x499ad0[_0x5eb0b8(0xd6)],'value':_0x499ad0[_0x5eb0b8(0xd7)]},'entity':null},{'isDraft':![]}));expect(await _0xa89aec(_0x5eb0b8(0x100)))['toBe'](_0x499ad0[_0x5eb0b8(0xd7)]),_0x499ad0[_0x5eb0b8(0xee)](expect,_0xc4a5bf)['toHaveBeenCalledWith']({'select':['id'],'where':{'attrUidUnique':_0x5eb0b8(0x100)}});}),test(_0x440b62(0xe2),async()=>{const _0x4d94fa=_0x440b62;expect[_0x4d94fa(0xcb)](0x1),_0xc4a5bf['mockResolvedValueOnce']({'attrUidUnique':_0x20a6fc[_0x4d94fa(0xd3)]});const _0x1925fa=strapiUtils[_0x4d94fa(0xd4)](validators['uid']({'attr':{'type':_0x20a6fc[_0x4d94fa(0x10a)],'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x4d94fa(0x104),'value':_0x4d94fa(0x10d)},'entity':null},{'isDraft':![]}));try{await _0x20a6fc['ddyjL'](_0x1925fa,_0x4d94fa(0x10d));}catch(_0x4c49df){_0x20a6fc[_0x4d94fa(0xfd)](expect,_0x4c49df)[_0x4d94fa(0xf7)](YupValidationError);}}),_0x20a6fc[_0x440b62(0xf4)](test,_0x20a6fc[_0x440b62(0xd8)],async()=>{const _0x16e1f3=_0x440b62;_0xc4a5bf[_0x16e1f3(0xce)]({'attrUidUnique':_0x16e1f3(0xea)});const _0xaf1f00=strapiUtils['validateYupSchema'](validators[_0x16e1f3(0xe9)]({'attr':{'type':_0x16e1f3(0xe9),'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x499ad0[_0x16e1f3(0xd6)],'value':_0x499ad0[_0x16e1f3(0xe4)]},'entity':{'id':0x1,'attrUidUnique':_0x16e1f3(0xea)}},{'isDraft':![]}));_0x499ad0[_0x16e1f3(0xf3)](expect,await _0x499ad0[_0x16e1f3(0xde)](_0xaf1f00,_0x499ad0[_0x16e1f3(0xe4)]))[_0x16e1f3(0xe6)](_0x499ad0[_0x16e1f3(0xe4)]);}),_0x20a6fc[_0x440b62(0xf4)](test,_0x20a6fc[_0x440b62(0x102)],async()=>{const _0x41b593=_0x440b62;_0xc4a5bf[_0x41b593(0xce)](null);const _0x13eb9f=strapiUtils[_0x41b593(0xd4)](validators[_0x41b593(0xe9)]({'attr':{'type':_0x20a6fc[_0x41b593(0x10a)],'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x41b593(0x104),'value':_0x20a6fc[_0x41b593(0xd3)]},'entity':null},{'isDraft':![]}));await _0x20a6fc[_0x41b593(0x106)](_0x13eb9f,_0x41b593(0x10d)),expect(_0xc4a5bf)[_0x41b593(0x103)]({'select':['id'],'where':{'attrUidUnique':_0x20a6fc['ivGVQ']}});}),test(_0x440b62(0x10e),async()=>{const _0x51aa6e=_0x440b62;_0xc4a5bf[_0x51aa6e(0xce)](null);const _0x49e1ad=strapiUtils[_0x51aa6e(0xd4)](validators[_0x51aa6e(0xe9)]({'attr':{'type':_0x51aa6e(0xe9),'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x499ad0[_0x51aa6e(0xd6)],'value':_0x51aa6e(0x10d)},'entity':{'id':0x1,'attrUidUnique':_0x51aa6e(0xc9)}},{'isDraft':![]}));await _0x499ad0['KOqrz'](_0x49e1ad,_0x499ad0[_0x51aa6e(0xe3)]),expect(_0xc4a5bf)[_0x51aa6e(0x103)]({'select':['id'],'where':{'$and':[{'attrUidUnique':_0x499ad0[_0x51aa6e(0xe3)]},{'$not':{'id':0x1}}]}});});}),_0x20a6fc[_0x5a6def(0xf4)](describe,_0x5a6def(0xe7),()=>{const _0x21fe2d=_0x5a6def,_0x529927={'AEhgI':_0x20a6fc[_0x21fe2d(0x10a)],'hWcQn':_0x20a6fc[_0x21fe2d(0xd0)],'HlisD':function(_0x21eaf9,_0x5870f7){return _0x20a6fc['pvKRb'](_0x21eaf9,_0x5870f7);},'MpdEO':_0x21fe2d(0x107)};_0x20a6fc['WtIEF'](test,_0x20a6fc[_0x21fe2d(0xfe)],async()=>{const _0x237763=_0x21fe2d;expect[_0x237763(0xcb)](0x1),_0xc4a5bf[_0x237763(0xce)](null);const _0x59e0bf=strapiUtils[_0x237763(0xd4)](validators[_0x237763(0xe9)]({'attr':{'type':_0x529927[_0x237763(0xf5)],'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x529927[_0x237763(0x108)],'value':_0x237763(0x100)},'entity':null},{'isDraft':![]}));try{await _0x529927['HlisD'](_0x59e0bf,_0x529927[_0x237763(0xed)]);}catch(_0x12edad){expect(_0x12edad)[_0x237763(0xf7)](YupValidationError);}}),_0x20a6fc[_0x21fe2d(0x109)](test,_0x21fe2d(0xfb),async()=>{const _0x52ee59=_0x21fe2d;_0xc4a5bf['mockResolvedValueOnce'](null);const _0x252c6d=strapiUtils['validateYupSchema'](validators['uid']({'attr':{'type':_0x52ee59(0xe9),'unique':!![]},'model':_0x29ebc3,'updatedAttribute':{'name':_0x20a6fc[_0x52ee59(0xd0)],'value':_0x20a6fc['fPQAO']},'entity':null},{'isDraft':![]}));_0x20a6fc[_0x52ee59(0x106)](expect,await _0x20a6fc[_0x52ee59(0xcc)](_0x252c6d,_0x52ee59(0xff)))['toBe'](_0x20a6fc[_0x52ee59(0xe5)]);});});});