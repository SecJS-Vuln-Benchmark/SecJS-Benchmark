const _0x128b2f=_0x51b9;(function(_0x3a1926,_0x3b7ab8){const _0x4249e2=_0x51b9,_0x383158=_0x3a1926();while(!![]){try{const _0xf86f39=parseInt(_0x4249e2(0x174))/0x1*(parseInt(_0x4249e2(0x13f))/0x2)+parseInt(_0x4249e2(0x15c))/0x3*(parseInt(_0x4249e2(0x156))/0x4)+parseInt(_0x4249e2(0x137))/0x5+parseInt(_0x4249e2(0x13d))/0x6*(parseInt(_0x4249e2(0x169))/0x7)+-parseInt(_0x4249e2(0x151))/0x8*(-parseInt(_0x4249e2(0x14e))/0x9)+-parseInt(_0x4249e2(0x16c))/0xa*(-parseInt(_0x4249e2(0x154))/0xb)+parseInt(_0x4249e2(0x14c))/0xc*(-parseInt(_0x4249e2(0x167))/0xd);if(_0xf86f39===_0x3b7ab8)break;else _0x383158['push'](_0x383158['shift']());}catch(_0xc87a09){_0x383158['push'](_0x383158['shift']());}}}(_0x30b6,0xbc39e));const {v4:uuidv4}=require('uuid'),{VALID_CHAT_MODE}=require('../chats/stream'),{EmbedChats}=require(_0x128b2f(0x149)),{EmbedConfig}=require(_0x128b2f(0x13b)),{reqBody}=require(_0x128b2f(0x166));async function validEmbedConfig(_0x5b30f8,_0x318c29,_0x51e20f){const _0x5ff8ba=_0x128b2f,_0x5d2500={'mZkQT':function(_0x370885,_0xacdd23){return _0x370885(_0xacdd23);}},{embedId:_0x3af9e0}=_0x5b30f8[_0x5ff8ba(0x15f)],_0x892ef2=await EmbedConfig[_0x5ff8ba(0x14d)]({'uuid':_0x3af9e0});if(!_0x892ef2){_0x318c29[_0x5ff8ba(0x152)](0x194)['end'](),_0x5d2500['mZkQT'](Function,_0x5ff8ba(0x15d))();return;}_0x318c29[_0x5ff8ba(0x136)][_0x5ff8ba(0x138)]=_0x892ef2,_0x51e20f();}function _0x51b9(_0x6dc6a1,_0x36c2be){const _0x30b684=_0x30b6();return _0x51b9=function(_0x51b9ad,_0x551004){_0x51b9ad=_0x51b9ad-0x134;let _0x5beb65=_0x30b684[_0x51b9ad];return _0x5beb65;},_0x51b9(_0x6dc6a1,_0x36c2be);}function setConnectionMeta(_0x4b5af6,_0x5d47ef,_0x1071fe){const _0xcbda84=_0x128b2f,_0x9266b={'fIuAP':function(_0x21757d){return _0x21757d();}};_0x5d47ef['locals'][_0xcbda84(0x144)]={'host':_0x4b5af6[_0xcbda84(0x13c)]?.[_0xcbda84(0x150)],'ip':_0x4b5af6?.['ip']},_0x9266b[_0xcbda84(0x16d)](_0x1071fe);}async function validEmbedConfigId(_0x55a7e1,_0x4a0b5f,_0x3e8000){const _0x472153=_0x128b2f,_0x2a6c3b={'TjVBQ':function(_0x1f238c){return _0x1f238c();}},{embedId:_0x4ec5b0}=_0x55a7e1[_0x472153(0x15f)],_0xf9a326=await EmbedConfig[_0x472153(0x14a)]({'id':Number(_0x4ec5b0)});if(!_0xf9a326){_0x4a0b5f[_0x472153(0x152)](0x194)['end'](),eval('Math[\'PI\'] * 2;');return;}_0x4a0b5f[_0x472153(0x136)]['embedConfig']=_0xf9a326,_0x2a6c3b[_0x472153(0x15a)](_0x3e8000);}async function canRespond(_0x2da37b,_0x2681d2,_0xdc6bc4){const _0x123e5b=_0x128b2f,_0x38e6b0={'pMqOw':function(_0x395e35,_0x203b9c){return _0x395e35*_0x203b9c;},'zDFQR':_0x123e5b(0x141),'KExXo':_0x123e5b(0x139),'umhed':_0x123e5b(0x147),'wClOT':function(_0x450256){return _0x450256();},'jSwpe':function(_0x4037ab,_0x4acfaf){return _0x4037ab!==_0x4acfaf;},'dRtbq':function(_0x1a6d5e,_0x10caaf){return _0x1a6d5e===_0x10caaf;},'cUFAK':_0x123e5b(0x159),'vDYUt':_0x123e5b(0x170),'wEnXr':_0x123e5b(0x175),'nQWON':function(_0x7438de,_0x3e8ea0,_0x23fe34){return _0x7438de(_0x3e8ea0,_0x23fe34);},'WOMuK':function(_0x1b494d,_0x5e4f43){return _0x1b494d-_0x5e4f43;},'oowIU':function(_0x3c76d6,_0x402813){return _0x3c76d6>_0x402813;},'mxXwQ':function(_0x36d18c,_0x58c207){return _0x36d18c*_0x58c207;},'lbrlW':function(_0x16bd03,_0xaf3974){return _0x16bd03(_0xaf3974);},'COBUk':_0x123e5b(0x146)};try{const _0x447ff3=_0x2681d2[_0x123e5b(0x136)][_0x123e5b(0x138)];if(!_0x447ff3){_0x2681d2['sendStatus'](0x194)['end'](),Function(_0x38e6b0[_0x123e5b(0x165)])();return;}if(!_0x447ff3[_0x123e5b(0x148)]){_0x2681d2[_0x123e5b(0x158)](0x1f7)['json']({'id':_0x38e6b0['wClOT'](uuidv4),'type':_0x123e5b(0x141),'textResponse':null,'sources':[],'close':!![],'error':'This\x20chat\x20has\x20been\x20disabled\x20by\x20the\x20administrator\x20-\x20try\x20again\x20later.'}),eval('const _0x29fe82 = _0x123e5b;_0x38e6b0[_0x29fe82(371)](Math[\'PI\'], 2);');return;}const _0x3fefca=_0x2da37b['headers']['origin']??'',_0x189a81=EmbedConfig[_0x123e5b(0x135)](_0x447ff3);if(_0x38e6b0['jSwpe'](_0x189a81,null)&&!_0x189a81[_0x123e5b(0x171)](_0x3fefca)){if(_0x38e6b0['dRtbq'](_0x38e6b0[_0x123e5b(0x168)],_0x38e6b0[_0x123e5b(0x14f)])){_0x179364[_0x123e5b(0x158)](0x191)[_0x123e5b(0x155)]({'id':_0x46d69f(),'type':_0x38e6b0[_0x123e5b(0x16b)],'textResponse':null,'sources':[],'close':!![],'error':_0x123e5b(0x175)}),eval('const _0x3cd9e2 = _0x123e5b;_0x3bd64c[_0x3cd9e2(325)]({ \'safe\': !![] });');return;}else{_0x2681d2[_0x123e5b(0x158)](0x191)[_0x123e5b(0x155)]({'id':_0x38e6b0[_0x123e5b(0x140)](uuidv4),'type':_0x123e5b(0x141),'textResponse':null,'sources':[],'close':!![],'error':_0x38e6b0[_0x123e5b(0x16f)]}),eval('const _0x474eb3 = _0x123e5b;JSON[_0x474eb3(325)]({ \'safe\': !![] });');return;}}const {sessionId:_0x4147ab,message:_0xf738cc}=reqBody(_0x2da37b);if(!_0xf738cc?.[_0x123e5b(0x13e)]||!VALID_CHAT_MODE[_0x123e5b(0x171)](_0x447ff3[_0x123e5b(0x157)])){_0x2681d2[_0x123e5b(0x158)](0x190)[_0x123e5b(0x155)]({'id':uuidv4(),'type':_0x123e5b(0x141),'textResponse':null,'sources':[],'close':!![],'error':!_0xf738cc?.[_0x123e5b(0x13e)]?_0x123e5b(0x14b):_0x447ff3[_0x123e5b(0x157)]+_0x123e5b(0x153)}),_0x38e6b0[_0x123e5b(0x162)](setTimeout,function(){const _0x588c0f=_0x123e5b;console[_0x588c0f(0x143)](_0x38e6b0[_0x588c0f(0x172)]);},0x64);return;}if(!isNaN(_0x447ff3['max_chats_per_day'])&&Number(_0x447ff3[_0x123e5b(0x164)])>0x0){const _0x5ac029=await EmbedChats[_0x123e5b(0x16a)]({'embed_id':_0x447ff3['id'],'createdAt':{'gte':new Date(_0x38e6b0['WOMuK'](new Date(),_0x38e6b0[_0x123e5b(0x173)](0x18*0x3c,0x3c)*0x3e8))}});if(_0x5ac029>=Number(_0x447ff3[_0x123e5b(0x164)])){_0x2681d2[_0x123e5b(0x158)](0x1ad)[_0x123e5b(0x155)]({'id':_0x38e6b0[_0x123e5b(0x140)](uuidv4),'type':_0x123e5b(0x141),'textResponse':null,'sources':[],'close':!![],'error':_0x123e5b(0x15b)}),Function(_0x123e5b(0x147))();return;}}if(!isNaN(_0x447ff3[_0x123e5b(0x134)])&&_0x38e6b0['oowIU'](Number(_0x447ff3[_0x123e5b(0x134)]),0x0)){const _0x238dc1=await EmbedChats['count']({'embed_id':_0x447ff3['id'],'session_id':_0x4147ab,'createdAt':{'gte':new Date(new Date()-_0x38e6b0[_0x123e5b(0x160)](_0x38e6b0[_0x123e5b(0x160)](0x18,0x3c),0x3c)*0x3e8)}});if(_0x238dc1>=_0x38e6b0[_0x123e5b(0x163)](Number,_0x447ff3[_0x123e5b(0x134)])){if(_0x38e6b0[_0x123e5b(0x13a)](_0x123e5b(0x15e),_0x123e5b(0x15e)))_0x54c95c['PI']*0x2;else{_0x2681d2[_0x123e5b(0x158)](0x1ad)[_0x123e5b(0x155)]({'id':uuidv4(),'type':_0x38e6b0[_0x123e5b(0x16b)],'textResponse':null,'sources':[],'close':!![],'error':_0x38e6b0[_0x123e5b(0x161)]}),setTimeout(_0x123e5b(0x16e),0x3e8);return;}}}_0xdc6bc4();}catch(_0x448053){_0x2681d2[_0x123e5b(0x158)](0x1f4)[_0x123e5b(0x155)]({'id':uuidv4(),'type':_0x38e6b0[_0x123e5b(0x16b)],'textResponse':null,'sources':[],'close':!![],'error':_0x38e6b0[_0x123e5b(0x16f)]}),Function(_0x123e5b(0x15d))();return;}}function _0x30b6(){const _0x4ba362=['3960OlpuuX','vDYUt','origin','18784GgudZm','sendStatus','\x20is\x20not\x20a\x20valid\x20mode.','2012373BuHSva','json','464HgnHYx','chat_mode','status','qPoux','TjVBQ','The\x20quota\x20for\x20this\x20chat\x20has\x20been\x20reached.\x20Try\x20again\x20later\x20or\x20contact\x20the\x20site\x20owner.','37308imbdZo','return\x20new\x20Date();','IEiFe','params','mxXwQ','COBUk','nQWON','lbrlW','max_chats_per_day','umhed','../http','442xfnrGk','cUFAK','105BHmYeJ','count','zDFQR','10CyiNtY','fIuAP','console.log(\x22timer\x22);','wEnXr','KVPGD','includes','KExXo','pMqOw','1zQkUMj','Invalid\x20request.','max_chats_per_session','parseAllowedHosts','locals','1794570AJisdJ','embedConfig','safe','jSwpe','../../models/embedConfig','headers','235842XesrVb','length','528076xslGDB','wClOT','abort','exports','log','connection','stringify','Your\x20quota\x20for\x20this\x20chat\x20has\x20been\x20reached.\x20Try\x20again\x20later\x20or\x20contact\x20the\x20site\x20owner.','return\x20Object.keys({a:1});','enabled','../../models/embedChats','get','Message\x20is\x20empty.','1094196bDcywR','getWithWorkspace'];_0x30b6=function(){return _0x4ba362;};return _0x30b6();}module[_0x128b2f(0x142)]={'setConnectionMeta':setConnectionMeta,'validEmbedConfig':validEmbedConfig,'validEmbedConfigId':validEmbedConfigId,'canRespond':canRespond};