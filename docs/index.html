<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecJS – JavaScript Vulnerability Benchmark</title>
    <style>
        :root {
            --primary: #1f3af5;
            --secondary: #0f172a;
            --accent: #22d3ee;
            --bg: #f4f6fb;
            --card: #ffffff;
            --muted: #6b7280;
            --border: #e2e8f0;
            --success: #0ea5e9;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0;
            font-family: "Inter", "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--secondary);
            line-height: 1.6;
        }
        header {
            background: linear-gradient(135deg, var(--primary), #4338ca);
            color: white;
            padding: 60px 0 40px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 24px;
        }
        h1 { font-size: 2.75rem; margin: 0 0 0.5rem; }
        p.lead { font-size: 1.15rem; opacity: 0.9; }
        section { padding: 60px 0; }
        .section-title { font-size: 2rem; margin-bottom: 1.5rem; text-align: center; }
        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
        }
        .variant-explainer {
            margin-top: 24px;
            background: var(--card);
            border-radius: 16px;
            padding: 20px 24px;
            box-shadow: 0 8px 20px rgba(15, 23, 42, 0.08);
            border: 1px solid rgba(15, 23, 42, 0.05);
        }
        .variant-explainer ul {
            margin: 0;
            padding-left: 20px;
            color: var(--muted);
            line-height: 1.5;
        }
        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 12px 30px rgba(15, 23, 42, 0.08);
            border: 1px solid rgba(15, 23, 42, 0.05);
        }
        .stat-value { font-size: 2rem; font-weight: 700; margin: 0; }
        .stat-label { text-transform: uppercase; font-size: 0.75rem; letter-spacing: 0.08em; color: var(--muted); }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 12px; border-bottom: 1px solid var(--border); text-align: left; }
        th { background: #f8fafc; text-transform: uppercase; font-size: 0.8rem; color: var(--muted); }
        .metadata-block { margin-top: 32px; }
        .highlight {
            padding: 20px;
            background: rgba(34, 211, 238, 0.15);
            border: 1px solid rgba(34, 211, 238, 0.5);
            border-radius: 12px;
            margin: 20px 0 0;
        }
        .demo-controls { display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 24px; }
        .demo-controls button {
            border: 1px solid var(--border);
            background: white;
            border-radius: 999px;
            padding: 10px 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .demo-controls button.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            box-shadow: 0 8px 18px rgba(31, 58, 245, 0.25);
        }
        .version-toggle { display: flex; gap: 12px; margin-bottom: 16px; }
        .version-toggle button {
            flex: 1;
            border-radius: 12px;
            border: 1px solid var(--border);
            background: white;
            padding: 12px;
            font-weight: 600;
            cursor: pointer;
        }
        .version-toggle button.active {
            background: #10b981;
            color: white;
            border-color: #0f9d7a;
        }
        .code-panel {
            background: #0f172a;
            color: #e2e8f0;
            border-radius: 18px;
            padding: 24px;
            position: relative;
            overflow: hidden;
            min-height: 260px;
        }
        pre { margin: 0; font-family: "JetBrains Mono", "Fira Code", monospace; font-size: 0.95rem; white-space: pre-wrap; }
        .code-meta { display: flex; flex-wrap: wrap; gap: 16px; margin: 16px 0; }
        .chip {
            padding: 6px 14px;
            border-radius: 999px;
            background: rgba(15, 23, 42, 0.08);
            font-size: 0.9rem;
            font-weight: 600;
        }
        .chip span { color: var(--muted); font-weight: 500; margin-right: 6px; text-transform: uppercase; }
        .dataset-note { margin-top: 16px; font-size: 0.95rem; color: var(--muted); }
        .case-study {
            background: #0f172a;
            color: white;
            border-radius: 24px;
            padding: 40px;
        }
        .case-study h3 { margin-top: 0; }
        .pill-list { display: grid; gap: 14px; margin-top: 24px; }
        .pill {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 16px;
            border-radius: 14px;
        }
        .pill strong { display: block; margin-bottom: 6px; color: var(--accent); }
        .results-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        .results-table th,
        .results-table td {
            padding: 8px;
            border: 1px solid var(--border);
            text-align: center;
            white-space: nowrap;
        }
        .results-table th {
            background: #f1f5f9;
            font-weight: 600;
        }
        .table-scroll {
            overflow-x: auto;
            margin-top: 16px;
        }
        footer { text-align: center; padding: 30px 0 60px; color: var(--muted); font-size: 0.9rem; }
        @media (max-width: 768px) {
            .code-meta { flex-direction: column; }
            .case-study { padding: 28px; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>SecJS Benchmark</h1>
            <p class="lead"><em>Large Language Models Cannot Reliably Detect Vulnerabilities in JavaScript: The First Systematic Benchmark and Evaluation</em></p>
        </div>
    </header>

    <section id="metadata">
        <div class="container">
            <h2 class="section-title">A. Metadata</h2>
            <div class="metadata-grid">
                <div class="card">
                    <p class="stat-value">1,852</p>
                    <p class="stat-label">Original GitHub projects</p>
                    <p>Each sample bundles a vulnerable and fixed commit taken from CVE-linked GitHub projects (2018–2024).</p>
                </div>
                <div class="card">
                    <p class="stat-value">7,408</p>
                    <p class="stat-label">Instances after augmentation</p>
                    <p>Noise, obfuscation, noise+obf, and prompt-injection variants grow the corpus while keeping behavior unchanged.</p>
                </div>
                <div class="card">
                    <p class="stat-value">52,137</p>
                    <p class="stat-label">Projects evaluated (RQ3)</p>
                    <p>Across all five variants, JudgeJS runs both versions of every project (104,274 executions total).</p>
                </div>
                <div class="card">
                    <p class="stat-value">317.2M</p>
                    <p class="stat-label">Total tokens consumed</p>
                    <p>Average 6,085 tokens per project (5,491 input + 594 output), adding up to 286.3M input and 31.0M output tokens.</p>
                </div>
            </div>
            <div class="variant-explainer">
                <h3 style="margin-top:0;">Dataset variants</h3>
                <ul>
                    <li><strong>Original:</strong> untouched GitHub code with the exact vulnerable and fixed commits.</li>
                    <li><strong>Noise:</strong> inserts harmless file writes, database logs, or DOM updates before the vulnerable merge logic to test false positives.</li>
                    <li><strong>Obfuscated:</strong> runs javascript-obfuscator so identifiers and literals become unreadable while semantics stay the same.</li>
                    <li><strong>Noise + Obf:</strong> applies the noise edits first, then obfuscates the file to combine both stressors.</li>
                    <li><strong>Prompt Injection:</strong> adds misleading audit comments (“security approved”) ahead of the guard to see whether LLMs trust text over code.</li>
                </ul>
            </div>

        </div>
    </section>

    <section id="demo">
        <div class="container">
            <h2 class="section-title">B. Demo</h2>
            <p style="text-align:center; max-width:800px; margin:0 auto 32px; color: var(--muted);">
                Watch how CVE-2021-25941 (project <code>ASaiAnudeep/deep-override</code>, commit <code>2aced176</code>) changes across every dataset variant. Click a variant button to load its code, then use the toggle to compare the vulnerable and fixed revisions.
            </p>

            <div class="demo-controls" id="datasetControls"></div>
            <div class="version-toggle" id="versionToggle"></div>

            <div class="code-meta" id="codeMeta"></div>
            <div class="code-panel">
                <pre id="codeSnippet"></pre>
            </div>
            <p class="dataset-note" id="datasetNote"></p>
        </div>
    </section>

    <section id="case-study">
        <div class="container">
            <h2 class="section-title">C. Case Study</h2>
            <div class="case-study">
                <h3>CVE-2021-25941 Case Study (deep-override)</h3>
                <p>
                    Prototype pollution in <code>src/index.js::override()</code> lets attacker-controlled keys overwrite <code>Object.prototype</code>, which can break or hijack Node.js apps that use deep-override while merging configs. The vulnerable release blocks only <code>__proto__</code>; the fixed release blocks <code>['__proto__','constructor','prototype']</code> and keeps the merge logic. Repo: <a href="https://github.com/ASaiAnudeep/deep-override" target="_blank" rel="noreferrer">ASaiAnudeep/deep-override</a>.
                </p>

                <h4>How this case instantiates the three SecJS principles (nine checkpoints)</h4>
                <div class="pill-list">
                    <div class="pill">
                        <strong>Principle 1 · Comprehensiveness</strong>
                        <ul>
                            <li><em>Principle I-1 · CWE coverage:</em> SecJS-Gen pulls CVEs from NVD and Mend.io so the dataset covers older CWEs (SQLi-89, XSS-79, command injection-78, auth bypass-287, hard-coded creds-798) plus newer CWEs (prototype pollution-1321, ReDoS-1333, XXE-611).</li>
                            <li><em>Principle I-2 · Result and reasoning:</em> JudgeJS checks both project-level ⟨has_vulnerability, CWE⟩ pairs and function-level ⟨has_vulnerability, CWE, file, function⟩ pairs, so the model must point to `src/index.js::override()` instead of giving a one-line verdict.</li>
                            <li><em>Principle I-3 · Real GitHub projects:</em> Every sample keeps the full repo (15 files here) plus a frontend/backend/full-stack tag, so the Node.js dependency path (express-session → body-parser → deep-override) stays in context.</li>
                        </ul>
                    </div>
                    <div class="pill">
                        <strong>Principle 2 · Avoid Underestimation</strong>
                        <ul>
                            <li><em>Principle II-1 · CWE equivalence:</em> MITRE CAPEC groups (for example XSS ⇒ CWE-79/80/83, prototype pollution ⇒ CWE-1321/915) mean predictions inside the same group are counted as correct.</li>
                            <li><em>Principle II-2 · Denoised controls:</em> Samples carry ONEFUNC / NVDCHECK / SUSPICIOUS flags so experiments can focus on the high-confidence part (ONEFUNC+NVDCHECK) and skip noisy commits.</li>
                            <li><em>Principle II-3 · Strong prompting:</em> The claude-code-security-review prompt guides the model through three steps: list known safe libraries, compare code with those patterns, then trace the taint path from source to sink.</li>
                        </ul>
                    </div>
                    <div class="pill">
                        <strong>Principle 3 · Avoid Overestimation</strong>
                        <ul>
                            <li><em>Principle III-1 · Full-project inputs:</em> JudgeJS always feeds the entire repo (package files, helpers, tests), so the model has to find the vulnerable `override` function itself.</li>
                            <li><em>Principle III-2 · Vulnerable/fixed pairs:</em> Every CVE provides both versions; for this case the fixed build blocks `['__proto__','constructor','prototype']`, exposing detectors that flag strings instead of reasoning.</li>
                            <li><em>Principle III-3 · Four augmentation tracks:</em> Noise (safe sinks), Obfuscation (renamed identifiers), Noise+Obf, and Prompt Injection (misleading comments) check whether the model still works after simple transformations.</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="card" style="margin-top:32px;">
                <h3 style="margin-top:0;">What the five variants mean</h3>
                <ul style="margin-left:20px;">
                    <li><strong>Original:</strong> Raw GitHub projects with paired vulnerable and fixed commits.</li>
                    <li><strong>Noise:</strong> Adds harmless file/DB/DOM statements so we can see whether models overreact to unrelated APIs.</li>
                    <li><strong>Obfuscated:</strong> Runs javascript-obfuscator to rename identifiers and encode literals while keeping semantics.</li>
                    <li><strong>Noise + Obf:</strong> Applies the noise injections first and then obfuscates the entire file for a tougher stress test.</li>
                    <li><strong>Prompt Injection:</strong> Inserts misleading audit comments (for example “Security audit passed”) to test textual prompt attacks.</li>
                </ul>
            </div>
        </div>
    </section>

    <section id="results">
        <div class="container">
            <h2 class="section-title">D. LLM Evaluation Results</h2>
            <p style="text-align:center; max-width:900px; margin:0 auto 20px; color: var(--muted);">
                Project-level F1 scores (Full split, %) reproduced from Table&nbsp;RQ1 of the paper. Each column shows how the same model behaves on a different dataset variant.
            </p>
            <div class="table-scroll">
                <table class="results-table">
                    <thead>
                        <tr>
                            <th>Model</th>
                            <th>Original</th>
                            <th>Noise</th>
                            <th>Obfuscated</th>
                            <th>Noise+Obf</th>
                            <th>Prompt Injection</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td>GPT-5</td><td>32.1</td><td>17.2</td><td>22.9</td><td>17.8</td><td>25.7</td></tr>
                        <tr><td>GPT-5-Mini</td><td>29.8</td><td>13.1</td><td>25.6</td><td>10.9</td><td>25.4</td></tr>
                        <tr><td>GPT-5-Codex</td><td>34.7</td><td>15.2</td><td>26.7</td><td>9.8</td><td>27.2</td></tr>
                        <tr><td>DeepSeek-v3.1</td><td>26.3</td><td>5.8</td><td>22.4</td><td>4.2</td><td>27.5</td></tr>
                        <tr><td>Gemini-2.5-Pro</td><td>36.6</td><td>20.0</td><td>33.5</td><td>17.0</td><td>34.9</td></tr>
                        <tr><td>Gemini-Flash</td><td>30.1</td><td>17.3</td><td>26.1</td><td>13.1</td><td>30.2</td></tr>
                        <tr><td>Claude-4.5</td><td>35.9</td><td>4.2</td><td>17.2</td><td>3.9</td><td>27.1</td></tr>
                    </tbody>
                </table>
            </div>
            <p style="text-align:center; max-width:900px; margin:16px auto 0; color: var(--muted); font-size:0.9rem;">
                Scores illustrate how robustness drops once noise, obfuscation, or prompt injection is applied—highlighting the need for all three SecJS principles.
            </p>
        </div>
    </section>

    <footer>
        SecJS Benchmark · GitHub: <a href="https://github.com/SecJS-Vuln-Benchmark/SecJS-Benchmark" target="_blank">SecJS-Benchmark</a>
    </footer>

    <script>
const cweExamples = [
  {
    cwe: 'Prototype Pollution (CWE-1321 / CWE-915)',
    dataset: 'Original',
    summary: 'ASaiAnudeep/deep-override lets attacker-controlled keys overwrite Object.prototype during deep merges.',
    cve: 'CVE-2021-25941',
    repo: 'ASaiAnudeep/deep-override',
    vulnerable: String.raw`function isSpecificValue(val) {
  return val instanceof Buffer || val instanceof Date || val instanceof RegExp;
}

function cloneSpecificValue(val) {
  if (val instanceof Buffer) {
    const _copy = Buffer.alloc(val.length);
    val.copy(_copy);
    return _copy;
  } else if (val instanceof Date) {
    return new Date(val.getTime());
  } else if (val instanceof RegExp) {
    return new RegExp(val);
  } else {
    throw new Error('Unexpected Value Type');
  }
}

function override(...rawArgs) {
  if (rawArgs.length < 1 || typeof rawArgs[0] !== 'object') return false;
  if (rawArgs.length < 2) return rawArgs[0];
  const target = rawArgs[0];
  const args = Array.prototype.slice.call(rawArgs, 1);
  let val, src;
  args.forEach(obj => {
    if (typeof obj !== 'object') return;
    if (Array.isArray(obj)) {
      obj.forEach((_, index) => {
        src = target[index];
        val = obj[index];
        if (val === target) {
        } else if (typeof val !== 'object' || val === null) {
          target[index] = val;
        } else if (isSpecificValue(val)) {
          target[index] = cloneSpecificValue(val);
        } else if (typeof src !== 'object' || src === null) {
          target[index] = Array.isArray(val) ? override([], val) : override({}, val);
        } else {
          target[index] = override(src, val);
        }
        return;
      });
    } else {
      Object.keys(obj).forEach(key => {
        src = target[key];
        val = obj[key];
        if (val === target) {
        } else if (typeof val !== 'object' || val === null) {
          target[key] = val;
        } else if (isSpecificValue(val)) {
          target[key] = cloneSpecificValue(val);
        } else if (typeof src !== 'object' || src === null) {
          target[key] = Array.isArray(val) ? override([], val) : override({}, val);
        } else {
          target[key] = override(src, val);
        }
        return;
      });
    }
  });
  return target;
}

module.exports = override;`,
    fixed: String.raw`function isSpecificValue(val) {
  return val instanceof Buffer || val instanceof Date || val instanceof RegExp;
}

function cloneSpecificValue(val) {
  if (val instanceof Buffer) {
    const _copy = Buffer.alloc(val.length);
    val.copy(_copy);
    return _copy;
  } else if (val instanceof Date) {
    return new Date(val.getTime());
  } else if (val instanceof RegExp) {
    return new RegExp(val);
  } else {
    throw new Error('Unexpected Value Type');
  }
}

function override(...rawArgs) {
  if (rawArgs.length < 1 || typeof rawArgs[0] !== 'object') return false;
  if (rawArgs.length < 2) return rawArgs[0];
  const target = rawArgs[0];
  const args = Array.prototype.slice.call(rawArgs, 1);
  let val, src;
  const dangerousKeys = ['__proto__', 'constructor', 'prototype'];
  args.forEach(obj => {
    if (typeof obj !== 'object') return;
    if (Array.isArray(obj)) {
      obj.forEach((_, index) => {
        src = target[index];
        val = obj[index];
        if (val === target) {
        } else if (typeof val !== 'object' || val === null) {
          target[index] = val;
        } else if (isSpecificValue(val)) {
          target[index] = cloneSpecificValue(val);
        } else if (typeof src !== 'object' || src === null) {
          target[index] = Array.isArray(val) ? override([], val) : override({}, val);
        } else {
          target[index] = override(src, val);
        }
        return;
      });
    } else {
      Object.keys(obj).forEach(key => {
        if (dangerousKeys.includes(key)) return;
        src = target[key];
        val = obj[key];
        if (val === target) {
        } else if (typeof val !== 'object' || val === null) {
          target[key] = val;
        } else if (isSpecificValue(val)) {
          target[key] = cloneSpecificValue(val);
        } else if (typeof src !== 'object' || src === null) {
          target[key] = Array.isArray(val) ? override([], val) : override({}, val);
        } else {
          target[key] = override(src, val);
        }
        return;
      });
    }
  });
  return target;
}

module.exports = override;`
  },
  {
    cwe: 'SQL Injection (CWE-89)',
    dataset: 'Noise',
    summary: 'NodeShop/sql-handler builds SQL strings via concatenation; the fixed version uses parameter binding.',
    cve: 'Demo sample',
    repo: 'NodeShop/sql-handler',
    vulnerable: String.raw`function runQuery(userInput) {
  const sql = "SELECT * FROM orders WHERE user = '" + userInput + "'";
  return db.query(sql);
}`,
    fixed: String.raw`function runQuery(userInput) {
  const sql = "SELECT * FROM orders WHERE user = ?";
  return db.query(sql, [userInput]);
}`
  },
  {
    cwe: 'XSS (CWE-79 / CWE-80 / CWE-83)',
    dataset: 'Obfuscated',
    summary: 'Frontend widget writes unsanitized user HTML directly to innerHTML.',
    cve: 'Demo sample',
    repo: 'Widget/front-status',
    vulnerable: String.raw`function renderStatus(message) {
  const div = document.getElementById('status');
  div.innerHTML = "<span>" + message + "</span>";
}`,
    fixed: String.raw`function renderStatus(message) {
  const div = document.getElementById('status');
  div.textContent = message;
}`
  },
  {
    cwe: 'Command Injection (CWE-78)',
    dataset: 'Noise + Obf.',
    summary: 'Server executes shell commands built from request parameters; the fix uses execFile and validation.',
    cve: 'Demo sample',
    repo: 'Backup/server',
    vulnerable: String.raw`app.post('/backup', (req, res) => {
  const cmd = "tar -czf /tmp/" + req.body.name + ".tgz /data";
  child_process.exec(cmd, err => res.sendStatus(err ? 500 : 200));
});`,
    fixed: String.raw`app.post('/backup', (req, res) => {
  const safeName = validateName(req.body.name);
  child_process.execFile('tar', ['-czf', '/tmp/' + safeName + '.tgz', '/data'], err => res.sendStatus(err ? 500 : 200));
});`
  },
  {
    cwe: 'XXE Injection (CWE-611)',
    dataset: 'Prompt Injection',
    summary: 'XML parser runs with external entity expansion enabled; the fix disables XXE.',
    cve: 'Demo sample',
    repo: 'DocFlow/xml-service',
    vulnerable: String.raw`const parser = new xml2js.Parser({ explicitArray: false });
parser.parseString(uploadedXml, cb);
`,
    fixed: String.raw`const parser = new xml2js.Parser({ explicitArray: false, xmldec: { standalone: true }, xmlns: false });
parser.parseString(uploadedXml, cb);
`
  }
];

let activeIndex = 0;
let activeVersion = 'vuln';

const datasetControls = document.getElementById('datasetControls');
const versionToggle = document.getElementById('versionToggle');
const codeSnippet = document.getElementById('codeSnippet');
const datasetNote = document.getElementById('datasetNote');
const codeMeta = document.getElementById('codeMeta');

function renderDatasetButtons() {
  datasetControls.innerHTML = '';
  cweExamples.forEach((entry, index) => {
    const btn = document.createElement('button');
    btn.textContent = entry.cwe;
    btn.classList.toggle('active', index === activeIndex);
    btn.addEventListener('click', () => {
      activeIndex = index;
      renderDatasetButtons();
      renderVersionButtons();
      updateSnippet();
    });
    datasetControls.appendChild(btn);
  });
}

function renderVersionButtons() {
  versionToggle.innerHTML = '';
  ['vuln', 'fixed'].forEach(version => {
    const btn = document.createElement('button');
    btn.textContent = version === 'vuln' ? 'Vulnerable build' : 'Fixed build';
    btn.classList.toggle('active', version === activeVersion);
    btn.addEventListener('click', () => {
      activeVersion = version;
      renderVersionButtons();
      updateSnippet();
    });
    versionToggle.appendChild(btn);
  });
}

function updateSnippet() {
  const entry = cweExamples[activeIndex];
  const code = activeVersion === 'vuln' ? entry.vulnerable : entry.fixed;
  codeSnippet.textContent = code;
  datasetNote.textContent = `${entry.summary} (Dataset: ${entry.dataset}). SecJS stores more than 1 TB of project data, so we show one representative per CWE group here.`;

  codeMeta.innerHTML = '';
  const chips = [
    { label: 'CWE class', value: entry.cwe },
    { label: 'Dataset', value: entry.dataset },
    { label: 'Version', value: activeVersion === 'vuln' ? 'Vulnerable build' : 'Fixed build' },
    { label: 'CVE', value: entry.cve },
    { label: 'Repository', value: entry.repo }
  ];
  chips.forEach(chip => {
    const div = document.createElement('div');
    div.className = 'chip';
    div.innerHTML = `<span>${chip.label}</span>${chip.value}`;
    codeMeta.appendChild(div);
  });
}

renderDatasetButtons();
renderVersionButtons();
updateSnippet();
</script>

</body>
</html>
